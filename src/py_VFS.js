__BRYTHON__.$py_VFS={
'/libs/ajax.js':'Ly8gYWpheAokbW9kdWxlID0gKGZ1bmN0aW9uKCl7CgokWE1MSHR0cERpY3QgPSB7CiAgICBfX2NsYXNzX186JHR5cGUsCiAgICBfX25hbWVfXzonWE1MSHR0cCcKfQoKJFhNTEh0dHBEaWN0Ll9fZ2V0YXR0cmlidXRlX18gPSBmdW5jdGlvbihzZWxmLGF0dHIpewogICAgaWYoWydoZWFkZXJzJywndGV4dCcsJ3htbCddLmluZGV4T2YoYXR0cik+LTEpewogICAgICAgIHJldHVybiAkWE1MSHR0cERpY3RbYXR0cl0oc2VsZikKICAgIH0KICAgIHJldHVybiAkT2JqZWN0RGljdC5fX2dldGF0dHJpYnV0ZV9fKHNlbGYsYXR0cikKfQoKJFhNTEh0dHBEaWN0Ll9fbXJvX18gPSBbJFhNTEh0dHBEaWN0LCRPYmplY3REaWN0XQoKJFhNTEh0dHBEaWN0Ll9fcmVwcl9fID0gZnVuY3Rpb24oc2VsZil7cmV0dXJuICc8b2JqZWN0IFhNTEh0dHA+J30KCiRYTUxIdHRwRGljdC5fX3N0cl9fID0gJFhNTEh0dHBEaWN0LnRvU3RyaW5nID0gJFhNTEh0dHBEaWN0Ll9fcmVwcl9fCgokWE1MSHR0cERpY3QudGV4dCA9IGZ1bmN0aW9uKHNlbGYpe3JldHVybiBzZWxmLnJlc3BvbnNlVGV4dH0KICAgIAokWE1MSHR0cERpY3QueG1sID0gZnVuY3Rpb24oc2VsZil7cmV0dXJuICREb21PYmplY3Qoc2VsZi5yZXNwb25zZVhNTCl9CiAgICAKJFhNTEh0dHBEaWN0LmhlYWRlcnMgPSBmdW5jdGlvbihzZWxmKXsKICAgIHJldHVybiBsaXN0KHNlbGYuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkuc3BsaXQoJ1xuJykpCn0KCiRYTUxIdHRwRGljdC5nZXRfaGVhZGVyID0gZnVuY3Rpb24oKXsKICAgIHZhciByZXFvYmogPSBzZWxmOwogICAgcmV0dXJuIGZ1bmN0aW9uKGhlYWRlcil7IHJldHVybiByZXFvYmouZ2V0UmVzcG9uc2VIZWFkZXIoaGVhZGVyKSB9Cn0KCiRBamF4RGljdCA9IHsKICAgIF9fY2xhc3NfXzokdHlwZSwKICAgIF9fbmFtZV9fOidhamF4Jwp9CgokQWpheERpY3QuX19tcm9fXyA9IFskQWpheERpY3QsJE9iamVjdERpY3RdCgokQWpheERpY3QuX19yZXByX18gPSBmdW5jdGlvbihzZWxmKXsKICAgIHJldHVybiAnPG9iamVjdCBBamF4PicKfQoKJEFqYXhEaWN0Ll9fc3RyX18gPSAkQWpheERpY3QudG9TdHJpbmcgPSAkQWpheERpY3QuX19yZXByX18KCiRBamF4RGljdC5iaW5kID0gZnVuY3Rpb24oc2VsZixldnQsZnVuYyl7CiAgICAvLyByZXEuYmluZChldnQsZnVuYykgaXMgdGhlIHNhbWUgYXMgcmVxLm9uX2V2dCA9IGZ1bmMKICAgIHNlbGZbJ29uXycrZXZ0XT1mdW5jCn0KCiRBamF4RGljdC5vcGVuID0gZnVuY3Rpb24oc2VsZixtZXRob2QsdXJsLGFzeW5jKXsKICAgIHNlbGYuJHhtbGh0dHAub3BlbihtZXRob2QsdXJsLGFzeW5jKQp9CgokQWpheERpY3Quc2VuZCA9IGZ1bmN0aW9uKHNlbGYscGFyYW1zKXsKICAgIC8vIHBhcmFtcyBpcyBhIFB5dGhvbiBkaWN0aW9uYXJ5CiAgICB2YXIgcmVzID0gJycKICAgIGlmKCFwYXJhbXMgfHwgcGFyYW1zLiRrZXlzLmxlbmd0aD09MCl7c2VsZi4keG1saHR0cC5zZW5kKCk7cmV0dXJufQogICAgZWxzZSBpZihpc2luc3RhbmNlKHBhcmFtcyxzdHIpKXsKICAgICAgICByZXMgPSBwYXJhbXMKICAgIH1lbHNlIGlmKGlzaW5zdGFuY2UocGFyYW1zLGRpY3QpKXsKICAgICAgICBmb3IoaT0wO2k8cGFyYW1zLiRrZXlzLmxlbmd0aDtpKyspewogICAgICAgICAgICByZXMgKz1lbmNvZGVVUklDb21wb25lbnQoc3RyKHBhcmFtcy4ka2V5c1tpXSkpKyc9JytlbmNvZGVVUklDb21wb25lbnQoc3RyKHBhcmFtcy4kdmFsdWVzW2ldKSkrJyYnCiAgICAgICAgfQogICAgICAgIHJlcyA9IHJlcy5zdWJzdHIoMCxyZXMubGVuZ3RoLTEpCiAgICB9ZWxzZXsKICAgICAgICB0aHJvdyBUeXBlRXJyb3IoInNlbmQoKSBhcmd1bWVudCBtdXN0IGJlIHN0cmluZyBvciBkaWN0b25hcnksIG5vdCAnIitzdHIocGFyYW1zLl9fY2xhc3NfXykrIiciKQogICAgfQogICAgc2VsZi4keG1saHR0cC5zZW5kKHJlcykKfQoKJEFqYXhEaWN0LnNldF9oZWFkZXIgPSBmdW5jdGlvbihzZWxmLGtleSx2YWx1ZSl7CiAgICBzZWxmLiR4bWxodHRwLnNldFJlcXVlc3RIZWFkZXIoa2V5LHZhbHVlKQp9CgokQWpheERpY3Quc2V0X3RpbWVvdXQgPSBmdW5jdGlvbihzZWxmLHNlY29uZHMsZnVuYyl7CiAgICBzZWxmLiR4bWxodHRwLiRyZXF1ZXN0VGltZXIgPSBzZXRUaW1lb3V0KAogICAgICAgIGZ1bmN0aW9uKCkge3NlbGYuJHhtbGh0dHAuYWJvcnQoKTtmdW5jKCl9LCAKICAgICAgICBzZWNvbmRzKjEwMDApOyAKfQoKZnVuY3Rpb24gYWpheCgpewoKICAgIHZhciByZXMgPSB7CiAgICAgICAgX19jbGFzc19fOiRBamF4RGljdAogICAgfQoKICAgIGlmICh3aW5kb3cuWE1MSHR0cFJlcXVlc3Qpey8vIGNvZGUgZm9yIElFNyssIEZpcmVmb3gsIENocm9tZSwgT3BlcmEsIFNhZmFyaQogICAgICAgIHZhciAkeG1saHR0cD1uZXcgWE1MSHR0cFJlcXVlc3QoKTsKICAgIH1lbHNley8vIGNvZGUgZm9yIElFNiwgSUU1CiAgICAgICAgdmFyICR4bWxodHRwPW5ldyBBY3RpdmVYT2JqZWN0KCJNaWNyb3NvZnQuWE1MSFRUUCIpOwogICAgfQogICAgJHhtbGh0dHAuJHJlcXVlc3RUaW1lciA9IG51bGwKICAgICR4bWxodHRwLl9fY2xhc3NfXyA9ICRYTUxIdHRwRGljdAogICAgCiAgICAkeG1saHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpewogICAgICAgIC8vIGhlcmUsICJ0aGlzIiByZWZlcnMgdG8gJHhtbGh0dHAKICAgICAgICB2YXIgc3RhdGUgPSB0aGlzLnJlYWR5U3RhdGUKICAgICAgICB2YXIgcmVxID0gdGhpcy4kYWpheAogICAgICAgIHZhciB0aW1lciA9IHRoaXMuJHJlcXVlc3RUaW1lcgogICAgICAgIHZhciBvYmogPSB0aGlzCiAgICAgICAgaWYoc3RhdGU9PT0wICYmICdvbl91bmluaXRpYWxpemVkJyBpbiByZXEpe3JlcS5vbl91bmluaXRpYWxpemVkKG9iail9CiAgICAgICAgZWxzZSBpZihzdGF0ZT09PTEgJiYgJ29uX2xvYWRpbmcnIGluIHJlcSl7cmVxLm9uX2xvYWRpbmcob2JqKX0KICAgICAgICBlbHNlIGlmKHN0YXRlPT09MiAmJiAnb25fbG9hZGVkJyBpbiByZXEpe3JlcS5vbl9sb2FkZWQob2JqKX0KICAgICAgICBlbHNlIGlmKHN0YXRlPT09MyAmJiAnb25faW50ZXJhY3RpdmUnIGluIHJlcSl7cmVxLm9uX2ludGVyYWN0aXZlKG9iail9CiAgICAgICAgZWxzZSBpZihzdGF0ZT09PTQgJiYgJ29uX2NvbXBsZXRlJyBpbiByZXEpewogICAgICAgICAgICBpZih0aW1lciAhPT0gbnVsbCl7d2luZG93LmNsZWFyVGltZW91dCh0aW1lcil9CiAgICAgICAgICAgIHJlcS5vbl9jb21wbGV0ZShvYmopCiAgICAgICAgfQogICAgfQogICAgJHhtbGh0dHAuJGFqYXggPSByZXMKICAgIHJlcy4keG1saHR0cCA9ICR4bWxodHRwCiAgICByZXR1cm4gcmVzCn0KCmFqYXguX19jbGFzc19fID0gJGZhY3RvcnkKYWpheC4kZGljdCA9ICRBamF4RGljdAoKcmV0dXJuIHthamF4OmFqYXh9Cgp9KSgp',
'/libs/hashlib.js':'JG1vZHVsZSA9IHsKICAgIF9fZ2V0YXR0cl9fIDogZnVuY3Rpb24oYXR0cil7CiAgICAgICAgaWYgKGF0dHIgPT0gJ25ldycpIHtyZXR1cm4gJGhhc2hsaWJfbmV3O30KICAgICAgICByZXR1cm4gdGhpc1thdHRyXQogICAgfSwKICAgIG1kNTogZnVuY3Rpb24oKSB7cmV0dXJuICRoYXNobGliX25ldygnbWQ1Jyl9LAogICAgc2hhMTogZnVuY3Rpb24oKSB7cmV0dXJuICRoYXNobGliX25ldygnc2hhMScpfSwKICAgIHNoYTIyNDogZnVuY3Rpb24oKSB7cmV0dXJuICRoYXNobGliX25ldygnc2hhMjI0Jyl9LAogICAgc2hhMjU2OiBmdW5jdGlvbigpIHtyZXR1cm4gJGhhc2hsaWJfbmV3KCdzaGEyNTYnKX0sCiAgICBzaGEzODQ6IGZ1bmN0aW9uKCkge3JldHVybiAkaGFzaGxpYl9uZXcoJ3NoYTM4NCcpfSwKICAgIHNoYTUxMjogZnVuY3Rpb24oKSB7cmV0dXJuICRoYXNobGliX25ldygnc2hhNTEyJyl9LAoKICAgIGFsZ29yaXRobXNfZ3VhcmFudGVlZDogWydtZDUnLCAnc2hhMScsICdzaGEyMjQnLCAnc2hhMjU2JywgJ3NoYTM4NCcsICdzaGE1MTInXSwKICAgIGFsZ29yaXRobXNfYXZhaWxhYmxlOiAgWydtZDUnLCAnc2hhMScsICdzaGEyMjQnLCAnc2hhMjU2JywgJ3NoYTM4NCcsICdzaGE1MTInXQp9CgoKLy90b2RvOiBldmVudHVhbGx5IG1vdmUgdGhpcyBmdW5jdGlvbiB0byBhICJ1dGlsaXR5IiBmaWxlIG9yIHVzZSBhamF4IG1vZHVsZT8KZnVuY3Rpb24gJGdldF9DcnlwdG9KU19saWIoYWxnKSB7CiAgIHZhciBpbXA9JGltcG9ydGVyKCkKICAgdmFyICR4bWxodHRwPWltcFswXSwgZmFrZV9xcz1pbXBbMV0sIHRpbWVyPWltcFsyXSwgcmVzPW51bGwKCiAgICR4bWxodHRwLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCl7CiAgICAgICAgaWYoJHhtbGh0dHAucmVhZHlTdGF0ZT09NCl7CiAgICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGltZXIpCiAgICAgICAgICAgIGlmKCR4bWxodHRwLnN0YXR1cz09MjAwIHx8ICR4bWxodHRwLnN0YXR1cz09MCl7cmVzPSR4bWxodHRwLnJlc3BvbnNlVGV4dH0KICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgIC8vIGRvbid0IHRocm93IGFuIGV4Y2VwdGlvbiBoZXJlLCBpdCB3aWxsIG5vdCBiZSBjYXVnaHQgKGlzc3VlICMzMCkKICAgICAgICAgICAgICAgIHJlcyA9IEVycm9yKCkKICAgICAgICAgICAgICAgIHJlcy5uYW1lID0gJ05vdEZvdW5kRXJyb3InCiAgICAgICAgICAgICAgICByZXMubWVzc2FnZSA9ICJObyBDcnlwdG9KUyBsaWIgbmFtZWQgJyIrYWxnKyInIgogICAgICAgICAgICB9CiAgICAgICAgfQogICB9CgogICAkeG1saHR0cC5vcGVuKCdHRVQnLCBfX0JSWVRIT05fXy5icnl0aG9uX3BhdGgrJ2xpYnMvY3J5cHRvX2pzL3JvbGx1cHMvJythbGcrJy5qcycrZmFrZV9xcyxmYWxzZSkKICAgaWYoJ292ZXJyaWRlTWltZVR5cGUnIGluICR4bWxodHRwKXskeG1saHR0cC5vdmVycmlkZU1pbWVUeXBlKCJ0ZXh0L3BsYWluIil9CiAgICR4bWxodHRwLnNlbmQoKQogICBpZihyZXMuY29uc3RydWN0b3I9PT1FcnJvcil7dGhyb3cgcmVzfSAvLyBtb2R1bGUgbm90IGZvdW5kCgogICB0cnl7CiAgICAgIGV2YWwocmVzICsgIjsgX19CUllUSE9OX18uQ3J5cHRvSlM9Q3J5cHRvSlM7IikKICAgfSBjYXRjaCAoZXJyKSB7IAogICAgICB0aHJvdyBFcnJvcigiSlMgRXZhbCBFcnJvciIsICJDYW5ub3QgZXZhbCBDcnlwdG9KUyBhbGdvcml0aG0gJyIgKyBhbGcgKyAiJyA6IGVycm9yOiIgKyBlcnIpOwogICB9Cn0KCmZ1bmN0aW9uICRoYXNobGliX25ldyhhbGcpIHsKICAgIGlmIChhbGcgPT0gJ21kNScpIHsKICAgICAgIGlmIChfX0JSWVRIT05fXy5DcnlwdG8gPT09IHVuZGVmaW5lZCB8fCAKICAgICAgICAgICBfX0JSWVRIT05fXy5DcnlwdG9KUy5hbGdvLk1ENSA9PT0gdW5kZWZpbmVkKSAkZ2V0X0NyeXB0b0pTX2xpYignbWQ1JykKICAgICAgIHRoaXMuaGFzaCA9IF9fQlJZVEhPTl9fLkNyeXB0b0pTLmFsZ28uTUQ1LmNyZWF0ZSgpCiAgICB9IGVsc2UgaWYgKGFsZyA9PSAnc2hhMScpIHsKICAgICAgIGlmIChfX0JSWVRIT05fXy5DcnlwdG8gPT09IHVuZGVmaW5lZCB8fCAKICAgICAgICAgICBfX0JSWVRIT05fXy5DcnlwdG9KUy5hbGdvLlNIQTEgPT09IHVuZGVmaW5lZCkgJGdldF9DcnlwdG9KU19saWIoJ3NoYTEnKQogICAgICAgdGhpcy5oYXNoID0gX19CUllUSE9OX18uQ3J5cHRvSlMuYWxnby5TSEExLmNyZWF0ZSgpCiAgICB9IGVsc2UgaWYgKGFsZyA9PSAnc2hhMjI0JykgewogICAgICAgaWYgKF9fQlJZVEhPTl9fLkNyeXB0byA9PT0gdW5kZWZpbmVkIHx8IAogICAgICAgICAgIF9fQlJZVEhPTl9fLkNyeXB0b0pTLmFsZ28uU0hBMjI0ID09PSB1bmRlZmluZWQpICRnZXRfQ3J5cHRvSlNfbGliKCdzaGEyMjQnKQogICAgICAgdGhpcy5oYXNoID0gX19CUllUSE9OX18uQ3J5cHRvSlMuYWxnby5TSEEyMjQuY3JlYXRlKCkKICAgIH0gZWxzZSBpZiAoYWxnID09ICdzaGEyNTYnKSB7CiAgICAgICBpZiAoX19CUllUSE9OX18uQ3J5cHRvID09PSB1bmRlZmluZWQgfHwgCiAgICAgICAgICAgX19CUllUSE9OX18uQ3J5cHRvSlMuYWxnby5TSEEyNTYgPT09IHVuZGVmaW5lZCkgJGdldF9DcnlwdG9KU19saWIoJ3NoYTI1NicpCiAgICAgICB0aGlzLmhhc2ggPSBfX0JSWVRIT05fXy5DcnlwdG9KUy5hbGdvLlNIQTI1Ni5jcmVhdGUoKQogICAgfSBlbHNlIGlmIChhbGcgPT0gJ3NoYTM4NCcpIHsKICAgICAgIGlmIChfX0JSWVRIT05fXy5DcnlwdG8gPT09IHVuZGVmaW5lZCB8fCAKICAgICAgICAgICBfX0JSWVRIT05fXy5DcnlwdG9KUy5hbGdvLlNIQTM4NCA9PT0gdW5kZWZpbmVkKSAkZ2V0X0NyeXB0b0pTX2xpYignc2hhMzg0JykKICAgICAgIHRoaXMuaGFzaCA9IF9fQlJZVEhPTl9fLkNyeXB0b0pTLmFsZ28uU0hBMzg0LmNyZWF0ZSgpCiAgICB9IGVsc2UgaWYgKGFsZyA9PSAnc2hhNTEyJykgewogICAgICAgaWYgKF9fQlJZVEhPTl9fLkNyeXB0byA9PT0gdW5kZWZpbmVkIHx8IAogICAgICAgICAgIF9fQlJZVEhPTl9fLkNyeXB0b0pTLmFsZ28uU0hBNTEyID09PSB1bmRlZmluZWQpICRnZXRfQ3J5cHRvSlNfbGliKCdzaGE1MTInKQogICAgICAgdGhpcy5oYXNoID0gX19CUllUSE9OX18uQ3J5cHRvSlMuYWxnby5TSEE1MTIuY3JlYXRlKCkKICAgIH0gZWxzZSB7CiAgICAgICAkcmFpc2UoJ0F0dHJpYnV0ZUVycm9yJywgJ0ludmFsaWQgaGFzaCBhbGdvcml0aG06JyArIGFsZykKICAgIH0KIAogICAgdGhpcy5fX2NsYXNzX18gPSAkdHlwZQogICAgdGhpcy5fX2dldGF0dHJfXyA9IGZ1bmN0aW9uKGF0dHIpe3JldHVybiAkZ2V0YXR0cih0aGlzLGF0dHIpfQogICAgdGhpcy5fX3N0cl9fID0gZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oZXhkaWdlc3QoKX0KICAgIHRoaXMudXBkYXRlID0gZnVuY3Rpb24obXNnKXt0aGlzLmhhc2gudXBkYXRlKG1zZyl9CiAgICB0aGlzLmNvcHkgPSBmdW5jdGlvbigpe3JldHVybiB0aGlzLmhhc2guY2xvbmUoKX0KCiAgICB0aGlzLmhleGRpZ2VzdCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHZhciB0ZW1wPXRoaXMuaGFzaC5jbG9uZSgpOwogICAgICAgIHRlbXA9dGVtcC5maW5hbGl6ZSgpOwogICAgICAgIHJldHVybiB0ZW1wLnRvU3RyaW5nKCk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7Cn0KCiRtb2R1bGUuX19jbGFzc19fID0gJG1vZHVsZQokbW9kdWxlLl9fc3RyX18gPSBmdW5jdGlvbigpIHtyZXR1cm4gIjxtb2R1bGUgJ2hhc2hsaWInPiJ9Cg==',
'/libs/html.js':'Ly8gY3JlYXRpb24gb2YgYW4gSFRNTCBlbGVtZW50CiRtb2R1bGUgPSAoZnVuY3Rpb24oKXsKZnVuY3Rpb24gJFRhZyh0YWdOYW1lLGFyZ3MpewogICAgdmFyIG9iaiA9ICRET01Ob2RlKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnTmFtZSkpCiAgICAvLyBvYmouZWx0IGlzIHRoZSBET00gZWxlbWVudAogICAgb2JqLnBhcmVudCA9IHRoaXMKICAgIGlmKGFyZ3MhPXVuZGVmaW5lZCAmJiBhcmdzLmxlbmd0aD4wKXsKICAgICAgICAkc3RhcnQgPSAwCiAgICAgICAgJGZpcnN0ID0gYXJnc1swXQogICAgICAgIC8vIGlmIGZpcnN0IGFyZ3VtZW50IGlzIG5vdCBhIGtleXdvcmQsIGl0J3MgdGhlIHRhZyBjb250ZW50CiAgICAgICAgaWYoJGZpcnN0Ll9fY2xhc3NfXyE9PSRLdyl7CiAgICAgICAgICAgICRzdGFydCA9IDEKICAgICAgICAgICAgaWYoaXNpbnN0YW5jZSgkZmlyc3QsW3N0cixpbnQsZmxvYXRdKSl7CiAgICAgICAgICAgICAgICB0eHQgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShzdHIoJGZpcnN0KSkKICAgICAgICAgICAgICAgIG9iai5lbHQuYXBwZW5kQ2hpbGQodHh0KQogICAgICAgICAgICB9IGVsc2UgaWYoJGZpcnN0Ll9fY2xhc3NfXz09PSRUYWdTdW1EaWN0KXsKICAgICAgICAgICAgICAgIGZvcigkaT0wOyRpPCRmaXJzdC5jaGlsZHJlbi5sZW5ndGg7JGkrKyl7CiAgICAgICAgICAgICAgICAgICAgb2JqLmVsdC5hcHBlbmRDaGlsZCgkZmlyc3QuY2hpbGRyZW5bJGldLmVsdCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsgLy8gYXJndW1lbnQgaXMgYW5vdGhlciBET01Ob2RlIGluc3RhbmNlCiAgICAgICAgICAgICAgICB0cnl7b2JqLmVsdC5hcHBlbmRDaGlsZCgkZmlyc3QuZWx0KX0KICAgICAgICAgICAgICAgIGNhdGNoKGVycil7Y29uc29sZS5sb2coJ2VycmV1ciAnK2Vycik7dGhyb3cgVmFsdWVFcnJvcignd3JvbmcgZWxlbWVudCAnKyRmaXJzdCl9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy8gYXR0cmlidXRlcwogICAgICAgIGZvcih2YXIgJGk9JHN0YXJ0OyRpPGFyZ3MubGVuZ3RoOyRpKyspewogICAgICAgICAgICAvLyBrZXl3b3JkIGFyZ3VtZW50cwogICAgICAgICAgICAkYXJnID0gYXJnc1skaV0KICAgICAgICAgICAgaWYoJGFyZyAmJiAkYXJnLl9fY2xhc3NfXz09PSRLdyl7CiAgICAgICAgICAgICAgICBpZigkYXJnLm5hbWUudG9Mb3dlckNhc2UoKS5zdWJzdHIoMCwyKT09PSJvbiIpeyAvLyBldmVudHMKICAgICAgICAgICAgICAgICAgICBldmFsKCdET01Ob2RlLmJpbmQob2JqLCInKyRhcmcubmFtZS50b0xvd2VyQ2FzZSgpLnN1YnN0cigyKSsnIixmdW5jdGlvbigpeycrJGFyZy52YWx1ZSsnfSknKQogICAgICAgICAgICAgICAgfWVsc2UgaWYoJGFyZy5uYW1lLnRvTG93ZXJDYXNlKCk9PSJzdHlsZSIpewogICAgICAgICAgICAgICAgICAgIERPTU5vZGUuc2V0X3N0eWxlKG9iaiwkYXJnLnZhbHVlKQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZigkYXJnLnZhbHVlIT09ZmFsc2UpewogICAgICAgICAgICAgICAgICAgICAgICAvLyBvcHRpb24uc2VsZWN0ZWQ9ZmFsc2Ugc2V0cyBpdCB0byB0cnVlIDotKQogICAgICAgICAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJnID0gJGFyZy5uYW1lLnRvTG93ZXJDYXNlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai5lbHQuc2V0QXR0cmlidXRlKGFyZywkYXJnLnZhbHVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYXJnPT0iY2xhc3MiKXsgLy8gZm9yIElFCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLmVsdC5zZXRBdHRyaWJ1dGUoImNsYXNzTmFtZSIsJGFyZy52YWx1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfWNhdGNoKGVycil7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyZXVyICcrZXJyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgVmFsdWVFcnJvcigiY2FuJ3Qgc2V0IGF0dHJpYnV0ZSAiKyRhcmcubmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIHJldHVybiBvYmoKfQoKLy8gdGhlIGNsYXNzZXMgdXNlZCBmb3IgdGFnIHN1bXMsICRUYWdTVW0gYW5kICRUYWdTdW1DbGFzcyAKLy8gYXJlIGRlZmluZWQgaW4gcHlfZG9tLmpzCgpmdW5jdGlvbiBBKCl7CiAgICB2YXIgb2JqID0gJFRhZygnQScsYXJndW1lbnRzKQogICAgcmV0dXJuIG9iagp9CkEuX19uYW1lX189J2h0bWwuQScKCnZhciAkc3JjID0gQSsnJyAvLyBzb3VyY2Ugb2YgZnVuY3Rpb24gQQovLyBIVE1MNCB0YWdzCiR0YWdzID0gWydBJywgJ0FCQlInLCAnQUNST05ZTScsICdBRERSRVNTJywgJ0FQUExFVCcsCiAgICAgICAgICAgICdCJywgJ0JETycsICdCSUcnLCAnQkxPQ0tRVU9URScsICdCVVRUT04nLAogICAgICAgICAgICAnQ0FQVElPTicsICdDRU5URVInLCAnQ0lURScsICdDT0RFJywKICAgICAgICAgICAgJ0RFTCcsICdERk4nLCAnRElSJywgJ0RJVicsICdETCcsCiAgICAgICAgICAgICdFTScsICdGSUVMRFNFVCcsICdGT05UJywgJ0ZPUk0nLCAnRlJBTUVTRVQnLAogICAgICAgICAgICAnSDEnLCAnSDInLCAnSDMnLCAnSDQnLCAnSDUnLCAnSDYnLAogICAgICAgICAgICAnSScsICdJRlJBTUUnLCAnSU5TJywgJ0tCRCcsICdMQUJFTCcsICdMRUdFTkQnLAogICAgICAgICAgICAnTUFQJywgJ01FTlUnLCAnTk9GUkFNRVMnLCAnTk9TQ1JJUFQnLCAnT0JKRUNUJywKICAgICAgICAgICAgJ09MJywgJ09QVEdST1VQJywgJ1BSRScsICdRJywgJ1MnLCAnU0FNUCcsCiAgICAgICAgICAgICdTQ1JJUFQnLCAnU0VMRUNUJywgJ1NNQUxMJywgJ1NQQU4nLCAnU1RSSUtFJywKICAgICAgICAgICAgJ1NUUk9ORycsICdTVFlMRScsICdTVUInLCAnU1VQJywgJ1RBQkxFJywKICAgICAgICAgICAgJ1RFWFRBUkVBJywgJ1RJVExFJywgJ1RUJywgJ1UnLCAnVUwnLAogICAgICAgICAgICAnVkFSJywgJ0JPRFknLCAnQ09MR1JPVVAnLCAnREQnLCAnRFQnLCAnSEVBRCcsCiAgICAgICAgICAgICdIVE1MJywgJ0xJJywgJ1AnLCAnVEJPRFknLCdPUFRJT04nLCAKICAgICAgICAgICAgJ1REJywgJ1RGT09UJywgJ1RIJywgJ1RIRUFEJywgJ1RSJywKICAgICAgICAgICAgJ0FSRUEnLCAnQkFTRScsICdCQVNFRk9OVCcsICdCUicsICdDT0wnLCAnRlJBTUUnLAogICAgICAgICAgICAnSFInLCAnSU1HJywgJ0lOUFVUJywgJ0lTSU5ERVgnLCAnTElOSycsCiAgICAgICAgICAgICdNRVRBJywgJ1BBUkFNJ10KCi8vIEhUTUw1IHRhZ3MKJHRhZ3MgPSAkdGFncy5jb25jYXQoWydBUlRJQ0xFJywnQVNJREUnLCdBVURJTycsJ0JESScsCiAgICAnQ0FOVkFTJywnQ09NTUFORCcsJ0RBVEFMSVNUJywnREVUQUlMUycsJ0RJQUxPRycsCiAgICAnRU1CRUQnLCdGSUdDQVBUSU9OJywnRklHVVJFJywnRk9PVEVSJywnSEVBREVSJywKICAgICdLRVlHRU4nLCdNQVJLJywnTUVURVInLCdOQVYnLCdPVVRQVVQnLAogICAgJ1BST0dSRVNTJywnUlAnLCdSVCcsJ1JVQlknLCdTRUNUSU9OJywnU09VUkNFJywKICAgICdTVU1NQVJZJywnVElNRScsJ1RSQUNLJywnVklERU8nLCdXQlInXSkKCi8vIGNyZWF0ZSBjbGFzc2VzCnZhciBvYmogPSBuZXcgT2JqZWN0KCkKZm9yKCRpPTA7JGk8JHRhZ3MubGVuZ3RoOyRpKyspewogICAgJGNvZGUgPSAkc3JjLnJlcGxhY2UoL0EvZ20sJHRhZ3NbJGldKQogICAgZXZhbCgib2JqLiIrJHRhZ3NbJGldKyI9IiskY29kZSkKICAgIGV2YWwoIm9iai4iKyR0YWdzWyRpXSsnLl9fbmFtZV9fPSJodG1sLicrJHRhZ3NbJGldKyciJykKfQpvYmouX19nZXRhdHRyX18gPSBmdW5jdGlvbihhdHRyKXtyZXR1cm4gdGhpc1thdHRyXX0KcmV0dXJuIG9iagp9KSgpCg==',
'/libs/json.js':'ZnVuY3Rpb24gX3B5KG9iail7CiAgICBpZihvYmo9PT1udWxsKXtyZXR1cm4gTm9uZX0KICAgIGlmKGlzaW5zdGFuY2Uob2JqLGxpc3QpKXsKICAgICAgICB2YXIgcmVzID0gW10KICAgICAgICBmb3IodmFyIGk9MDtpPG9iai5sZW5ndGg7aSsrKXsKICAgICAgICAgICAgcmVzLnB1c2goX3B5KG9ialtpXSkpCiAgICAgICAgfQogICAgICAgIHJldHVybiByZXMKICAgIH0KICAgIGlmKG9iai5fX2NsYXNzX18hPT11bmRlZmluZWQpewogICAgICAgIGlmKG9iai5fX2NsYXNzX189PT1saXN0KXsKICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxvYmoubGVuZ3RoO2krKyl7CiAgICAgICAgICAgICAgICBvYmpbaV0gPSBfcHkob2JqW2ldKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBvYmoKICAgIH0KICAgIGlmKHR5cGVvZiBvYmo9PT0nb2JqZWN0JyAmJiBvYmouX19jbGFzc19fPT09dW5kZWZpbmVkKXsKICAgICAgICAvLyB0cmFuc2Zvcm0gSlMgb2JqZWN0IGludG8gYSBQeXRob24gZGljdAogICAgICAgIHZhciByZXMgPSBkaWN0KCkKICAgICAgICBmb3IodmFyIGF0dHIgaW4gb2JqKXsKICAgICAgICAgICAgZ2V0YXR0cihyZXMsJ19fc2V0aXRlbV9fJykoYXR0cixfcHkob2JqW2F0dHJdKSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlcwogICAgfQogICAgcmV0dXJuIEpTT2JqZWN0KG9iaikKfQpmdW5jdGlvbiBfanMob2JqKXsKICAgIC8vIG9iaiBpcyBhIFB5dGhvbiBvYmplY3QKICAgIGlmIChpc2luc3RhbmNlKG9iaixbaW50LHN0cl0pKXtyZXR1cm4gb2JqfQogICAgZWxzZSBpZihvYmo9PT1Ob25lKXtyZXR1cm4gbnVsbH0KICAgIGVsc2UgaWYob2JqPT09VHJ1ZSl7cmV0dXJuIHRydWV9CiAgICBlbHNlIGlmKG9iaj09PUZhbHNlKXtyZXR1cm4gZmFsc2V9CiAgICBlbHNlIGlmKGlzaW5zdGFuY2Uob2JqLGZsb2F0KSl7cmV0dXJuIG9iai52YWx1ZX0KICAgIGVsc2UgaWYoaXNpbnN0YW5jZShvYmosW2xpc3QsdHVwbGVdKSl7CiAgICAgICAgdmFyIHJlcyA9IFtdCiAgICAgICAgZm9yKHZhciBpPTA7aTxvYmoubGVuZ3RoO2krKyl7cmVzLnB1c2goX2pzKG9ialtpXSkpfQogICAgICAgIHJldHVybiByZXMKICAgIH1lbHNlIGlmKGlzaW5zdGFuY2Uob2JqLGRpY3QpKXsKICAgICAgICB2YXIgcmVzID0gbmV3IE9iamVjdCgpCiAgICAgICAgZm9yKHZhciBpPTA7aTxvYmouJGtleXMubGVuZ3RoO2krKyl7CiAgICAgICAgICAgIHJlc1tfanMob2JqLiRrZXlzW2ldKV09X2pzKG9iai4kdmFsdWVzW2ldKQogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzCiAgICB9ZWxzZXsKICAgICAgICB0aHJvdyBUeXBlRXJyb3Ioc3RyKG9iaikrJyBpcyBub3QgSlNPTiBzZXJpYWxpemFibGUnKQogICAgfQp9CgokbW9kdWxlID0gIHsKCiAgICBfX2dldGF0dHJfXyA6IGZ1bmN0aW9uKGF0dHIpe3JldHVybiB0aGlzW2F0dHJdfSwKCiAgICBsb2FkcyA6IGZ1bmN0aW9uKGpzb25fb2JqKXtyZXR1cm4gX3B5KEpTT04ucGFyc2UoanNvbl9vYmopKX0sCgogICAgZHVtcHMgOiBmdW5jdGlvbihvYmope3JldHVybiBKU09OLnN0cmluZ2lmeShfanMob2JqKSl9LAp9',
'/libs/math.js':'CnZhciBmbG9hdF9jaGVjaz1mdW5jdGlvbih4KSB7CiAgICBpZiAoaXNpbnN0YW5jZSh4LCBmbG9hdCkpIHJldHVybiB4LnZhbHVlOwogICAgcmV0dXJuIHg7Cn0KCnZhciBpc2luZj1mdW5jdGlvbih4KSB7CiAgICB2YXIgeDE9ZmxvYXRfY2hlY2soeCk7CiAgICByZXR1cm4geDEgPT0gLUluZmluaXR5IHx8IHgxID09IEluZmluaXR5IHx8IHgxID09IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSB8fCB4MSA9PSBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFk7Cn0KCiRtb2R1bGUgPSB7CiAgICBfX2dldGF0dHJfXyA6IGZ1bmN0aW9uKGF0dHIpewogICAgICAgIHZhciByZXMgPSB0aGlzW2F0dHJdCiAgICAgICAgaWYocmVzPT09dW5kZWZpbmVkKXskcmFpc2UoJ0F0dHJpYnV0ZUVycm9yJywnbW9kdWxlIG1hdGggaGFzIG5vIGF0dHJpYnV0ZSAnK2F0dHIpfQogICAgICAgIHJldHVybiByZXMKICAgIH0sCiAgICBhY29zOiBmdW5jdGlvbih4KSB7cmV0dXJuIGZsb2F0KE1hdGguYWNvcyhmbG9hdF9jaGVjayh4KSkpfSwKICAgIGFjb3NoOiBmdW5jdGlvbih4KSB7IAogICAgICAgIGlmIChpc2luZih4KSkgcmV0dXJuIGZsb2F0KCdpbmYnKTsKICAgICAgICB2YXIgeSA9IGZsb2F0X2NoZWNrKHgpOwogICAgICAgIHJldHVybiBmbG9hdChNYXRoLmxvZyh5ICsgTWF0aC5zcXJ0KHkqeS0xKSkpOwogICAgfSwKICAgIGFzaW46IGZ1bmN0aW9uKHgpIHtyZXR1cm4gZmxvYXQoTWF0aC5hc2luKGZsb2F0X2NoZWNrKHgpKSl9LAogICAgYXNpbmg6IGZ1bmN0aW9uKHgpIHsKICAgICAgICBpZiAoaXNpbmYoeCkpIHJldHVybiBmbG9hdCgnaW5mJyk7CiAgICAgICAgdmFyIHkgPSBmbG9hdF9jaGVjayh4KTsKICAgICAgICAKICAgICAgICByZXR1cm4gZmxvYXQoTWF0aC5sb2coeSArIE1hdGguc3FydCh5KnkrMSkpKQogICAgfSwKICAgIGF0YW46IGZ1bmN0aW9uKHgpIHsKICAgICAgICBpZiAoaXNpbmYoeCkpIHJldHVybiBmbG9hdChNYXRoLlBJLzIpOwogICAgICAgIHJldHVybiBmbG9hdChNYXRoLmF0YW4oZmxvYXRfY2hlY2soeCkpKX0sCiAgICBhdGFuMjogZnVuY3Rpb24oeSx4KSB7cmV0dXJuIGZsb2F0KE1hdGguYXRhbjIoeSx4KSl9LAogICAgYXRhbmg6IGZ1bmN0aW9uKHgpIHsgCiAgICAgICB2YXIgeT1mbG9hdF9jaGVjayh4KTsKICAgICAgIGlmICh5PT0wKSByZXR1cm4gMDsKICAgICAgIHJldHVybiBmbG9hdCgwLjUgKiBNYXRoLmxvZygoMS95KzEpLygxL3ktMSkpKTsKICAgIH0sCiAgICBjZWlsOiBmdW5jdGlvbih4KSB7CiAgICAgICB2YXIgeT1mbG9hdF9jaGVjayh4KTsKICAgICAgIGlmICghaXNOYU4ocGFyc2VGbG9hdCh5KSkgJiYgaXNGaW5pdGUoeSkpIHJldHVybiBpbnQoTWF0aC5jZWlsKHkpKTsKICAgICAgIHRyeXtyZXR1cm4gZ2V0YXR0cih5LCdfX2NlaWxfXycpKCl9Y2F0Y2goZXJyKXskcG9wX2V4YygpfQogICAgICAgCiAgICAgICAkcmFpc2UoJ1ZhbHVlRXJyb3InLCAnb2JqZWN0IGlzIG5vdCBhIG51bWJlciBhbmQgZG9lcyBub3QgY29udGFpbiBfX2NlaWxfXycpCiAgICB9LAogICAgY29weXNpZ246IGZ1bmN0aW9uKHgseSkgewogICAgICAgIHZhciB4MT1NYXRoLmFicyhmbG9hdF9jaGVjayh4KSk7CiAgICAgICAgdmFyIHkxPWZsb2F0X2NoZWNrKHkpOyAKICAgICAgICB2YXIgc2lnbj15MT95MTwwPy0xOjE6MQogICAgICAgIGlmKGlzaW5zdGFuY2UoeCxpbnQpKXtyZXR1cm4geDEgKiBzaWdufQogICAgICAgIGVsc2V7cmV0dXJuIGZsb2F0KHgxICogc2lnbil9CiAgICB9LAogICAgY29zIDogZnVuY3Rpb24oeCl7cmV0dXJuIGZsb2F0KE1hdGguY29zKGZsb2F0X2NoZWNrKHgpKSl9LAogICAgZGVncmVlczogZnVuY3Rpb24oeCl7cmV0dXJuIGZsb2F0KGZsb2F0X2NoZWNrKHgpICogMTgwL01hdGguUEkpfSwKICAgIGU6IGZsb2F0KE1hdGguRSksCiAgICBlcmY6IGZ1bmN0aW9uKHgpIHsKICAgICAgICAvLyBpbnNwaXJlZCBmcm9tIAogICAgICAgIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNDU3NDA4L2lzLXRoZXJlLWFuLWVhc2lseS1hdmFpbGFibGUtaW1wbGVtZW50YXRpb24tb2YtZXJmLWZvci1weXRob24KICAgICAgICB2YXIgeSA9ZmxvYXRfY2hlY2soeCk7CiAgICAgICAgdmFyIHQgPSAxLjAgLyAoMS4wICsgMC41ICogTWF0aC5hYnMoeSkpCiAgICAgICAgdmFyIGFucyA9IDEgLSB0ICogTWF0aC5leHAoIC15KnkgLSAxLjI2NTUxMjIzICsKICAgICAgICAgICAgICAgICAgICAgdCAqICggMS4wMDAwMjM2OCArCiAgICAgICAgICAgICAgICAgICAgIHQgKiAoIDAuMzc0MDkxOTYgKyAKICAgICAgICAgICAgICAgICAgICAgdCAqICggMC4wOTY3ODQxOCArIAogICAgICAgICAgICAgICAgICAgICB0ICogKC0wLjE4NjI4ODA2ICsgCiAgICAgICAgICAgICAgICAgICAgIHQgKiAoIDAuMjc4ODY4MDcgKyAKICAgICAgICAgICAgICAgICAgICAgdCAqICgtMS4xMzUyMDM5OCArIAogICAgICAgICAgICAgICAgICAgICB0ICogKCAxLjQ4ODUxNTg3ICsgCiAgICAgICAgICAgICAgICAgICAgIHQgKiAoLTAuODIyMTUyMjMgKyAKICAgICAgICAgICAgICAgICAgICAgdCAqIDAuMTcwODcyNzcpKSkpKSkpKSkKICAgICAgICBpZiAoeSA+PSAwLjApIHJldHVybiBhbnMKCiAgICAgICAgcmV0dXJuIC1hbnMKICAgIH0sCgogICAgZXJmYzogZnVuY3Rpb24oeCkgewogICAgICAgIC8vIGluc3BpcmVkIGZyb20gCiAgICAgICAgLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy80NTc0MDgvaXMtdGhlcmUtYW4tZWFzaWx5LWF2YWlsYWJsZS1pbXBsZW1lbnRhdGlvbi1vZi1lcmYtZm9yLXB5dGhvbgogICAgICAgIHZhciB5ID0gZmxvYXRfY2hlY2soeCk7CiAgICAgICAgdmFyIHQgPSAxLjAgLyAoMS4wICsgMC41ICogTWF0aC5hYnMoeSkpCiAgICAgICAgdmFyIGFucyA9IDEgLSB0ICogTWF0aC5leHAoIC15KnkgLSAxLjI2NTUxMjIzICsKICAgICAgICAgICAgICAgICAgICAgdCAqICggMS4wMDAwMjM2OCArCiAgICAgICAgICAgICAgICAgICAgIHQgKiAoIDAuMzc0MDkxOTYgKyAKICAgICAgICAgICAgICAgICAgICAgdCAqICggMC4wOTY3ODQxOCArIAogICAgICAgICAgICAgICAgICAgICB0ICogKC0wLjE4NjI4ODA2ICsgCiAgICAgICAgICAgICAgICAgICAgIHQgKiAoIDAuMjc4ODY4MDcgKyAKICAgICAgICAgICAgICAgICAgICAgdCAqICgtMS4xMzUyMDM5OCArIAogICAgICAgICAgICAgICAgICAgICB0ICogKCAxLjQ4ODUxNTg3ICsgCiAgICAgICAgICAgICAgICAgICAgIHQgKiAoLTAuODIyMTUyMjMgKyAKICAgICAgICAgICAgICAgICAgICAgdCAqIDAuMTcwODcyNzcpKSkpKSkpKSkKICAgICAgICBpZiAoeSA+PSAwLjApIHJldHVybiAxLWFucwogICAgICAgIHJldHVybiAxK2FucwogICAgfSwKICAgIGV4cDogZnVuY3Rpb24oeCl7cmV0dXJuIGZsb2F0KE1hdGguZXhwKGZsb2F0X2NoZWNrKHgpKSl9LAogICAgZXhwbTE6IGZ1bmN0aW9uKHgpe3JldHVybiBmbG9hdChNYXRoLmV4cChmbG9hdF9jaGVjayh4KSktMSl9LAogICAgZmFiczogZnVuY3Rpb24oeCl7IHJldHVybiB4PjA/ZmxvYXQoeCk6ZmxvYXQoLXgpfSwKICAgIGZhY3RvcmlhbDogZnVuY3Rpb24oeCkgewogICAgICAgICAvL3VzaW5nIGNvZGUgZnJvbSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzM5NTkyMTEvZmFzdC1mYWN0b3JpYWwtZnVuY3Rpb24taW4tamF2YXNjcmlwdAogICAgICAgICB2YXIgeT1mbG9hdF9jaGVjayh4KTsKICAgICAgICAgdmFyIHI9MQogICAgICAgICBmb3IgKHZhciBpPTI7IGk8PXk7IGkrKyl7cio9aX0KICAgICAgICAgcmV0dXJuIHIKICAgIH0sCiAgICBmbG9vcjpmdW5jdGlvbih4KXtyZXR1cm4gTWF0aC5mbG9vcihmbG9hdF9jaGVjayh4KSl9LAogICAgZm1vZDpmdW5jdGlvbih4LHkpe3JldHVybiBmbG9hdChmbG9hdF9jaGVjayh4KSVmbG9hdF9jaGVjayh5KSl9LAogICAgZnJleHA6ZnVuY3Rpb24oeCl7CiAgICAgICB2YXIgeDE9ZmxvYXRfY2hlY2soeCk7CiAgICAgICB2YXIgZXggPSBNYXRoLmZsb29yKE1hdGgubG9nKHgxKSAvIE1hdGgubG9nKDIpKSArIDE7CiAgICAgICBmcmFjID0geDEgLyBNYXRoLnBvdygyLCBleCk7CiAgICAgICByZXR1cm4gW2ZyYWMsIGV4XTsKICAgIH0sCiAgICAvL2ZzdW06ZnVuY3Rpb24oeCl7fSwKICAgIGdhbW1hOiBmdW5jdGlvbih4KXsKICAgICAgICAgLy91c2luZyBjb2RlIGZyb20gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8zOTU5MjExL2Zhc3QtZmFjdG9yaWFsLWZ1bmN0aW9uLWluLWphdmFzY3JpcHQKICAgICAgICAgLy8gTGFuY3pvcyBBcHByb3hpbWF0aW9uIG9mIHRoZSBHYW1tYSBGdW5jdGlvbgogICAgICAgICAvLyBBcyBkZXNjcmliZWQgaW4gTnVtZXJpY2FsIFJlY2lwZXMgaW4gQyAoMm5kIGVkLiBDYW1icmlkZ2UgVW5pdmVyc2l0eSBQcmVzcywgMTk5MikKICAgICAgICAgdmFyIHk9ZmxvYXRfY2hlY2soeCk7CiAgICAgICAgIHZhciB6ID0geSArIDE7CiAgICAgICAgIHZhciBkMSA9IE1hdGguc3FydCgyICogTWF0aC5QSSkgLyB6OwoKICAgICAgICAgdmFyIGQyID0gMS4wMDAwMDAwMDAxOTAwMTU7CiAgICAgICAgIGQyICs9ICA3Ni4xODAwOTE3Mjk0NzE0NiAvICh6KzEpOwogICAgICAgICBkMiArPSAtODYuNTA1MzIwMzI5NDE2NzcgLyAoeisyKTsKICAgICAgICAgZDIgKz0gIDI0LjAxNDA5ODI0MDgzMDkxIC8gKHorMyk7IAogICAgICAgICBkMiArPSAtMS4yMzE3Mzk1NzI0NTAxNTUgLyAoeis0KTsgCiAgICAgICAgIGQyICs9ICAxLjIwODY1MDk3Mzg2NjE3OUUtMyAvICh6KzUpOwogICAgICAgICBkMiArPSAtNS4zOTUyMzkzODQ5NTNFLTYgLyAoeis2KTsKCiAgICAgICAgIHJldHVybiBkMSAqIGQyICogTWF0aC5wb3coeis1LjUseiswLjUpICogTWF0aC5leHAoLSh6KzUuNSkpOwogICAgfSwKICAgIGh5cG90OiBmdW5jdGlvbih4LHkpewogICAgICAgdmFyIHgxPWZsb2F0X2NoZWNrKHgpOwogICAgICAgdmFyIHkxPWZsb2F0X2NoZWNrKHkpOwogICAgICAgcmV0dXJuIGZsb2F0KE1hdGguc3FydCh4MSp4MSArIHkxKnkxKSl9LAogICAgaXNmaW5pdGU6ZnVuY3Rpb24oeCkge3JldHVybiBpc0Zpbml0ZShmbG9hdF9jaGVjayh4KSl9LAogICAgaXNpbmY6ZnVuY3Rpb24oeCkgeyByZXR1cm4gaXNpbmYoeCk7fSwKICAgIGlzbmFuOmZ1bmN0aW9uKHgpIHtyZXR1cm4gaXNOYU4oZmxvYXRfY2hlY2soeCkpfSwKICAgIGxkZXhwOmZ1bmN0aW9uKHgsaSkgewogICAgICAgIHZhciBtdWwgPSBNYXRoLnBvdygyLGZsb2F0X2NoZWNrKGkpKQogICAgICAgIGlmKGlzaW5zdGFuY2UoeCxpbnQpKXtyZXR1cm4geCAqIG11bH0KICAgICAgICBlbHNle3JldHVybiBmbG9hdCh4LnZhbHVlKm11bCl9CiAgICB9LAogICAgbGdhbW1hOmZ1bmN0aW9uKHgpIHsKICAgICAgICAgLy8gc2VlIGdhbW1hIGZ1bmN0aW9uIGZvciBzb3VyY2VzCiAgICAgICAgIHZhciB5PWZsb2F0X2NoZWNrKHgpOwogICAgICAgICB2YXIgeiA9IHkgKyAxOwogICAgICAgICB2YXIgZDEgPSBNYXRoLnNxcnQoMiAqIE1hdGguUEkpIC8gejsKCiAgICAgICAgIHZhciBkMiA9IDEuMDAwMDAwMDAwMTkwMDE1OwogICAgICAgICBkMiArPSAgNzYuMTgwMDkxNzI5NDcxNDYgLyAoeisxKTsKICAgICAgICAgZDIgKz0gLTg2LjUwNTMyMDMyOTQxNjc3IC8gKHorMik7CiAgICAgICAgIGQyICs9ICAyNC4wMTQwOTgyNDA4MzA5MSAvICh6KzMpOyAKICAgICAgICAgZDIgKz0gLTEuMjMxNzM5NTcyNDUwMTU1IC8gKHorNCk7IAogICAgICAgICBkMiArPSAgMS4yMDg2NTA5NzM4NjYxNzlFLTMgLyAoeis1KTsKICAgICAgICAgZDIgKz0gLTUuMzk1MjM5Mzg0OTUzRS02IC8gKHorNik7CgogICAgICAgICByZXR1cm4gZmxvYXQoTWF0aC5sb2coTWF0aC5hYnMoZDEgKiBkMiAqIE1hdGgucG93KHorNS41LHorMC41KSAqIE1hdGguZXhwKC0oeis1LjUpKSkpKTsKICAgIH0sCiAgICBsb2c6IGZ1bmN0aW9uKHgsIGJhc2UpIHsKICAgICAgICAgdmFyIHgxPWZsb2F0X2NoZWNrKHgpOwogICAgICAgICBpZiAoYmFzZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gZmxvYXQoTWF0aC5sb2coeDEpKTsKICAgICAgICAgcmV0dXJuIGZsb2F0KE1hdGgubG9nKHgxKS9NYXRoLmxvZyhmbG9hdF9jaGVjayhiYXNlKSkpOwogICAgfSwKICAgIGxvZzFwOiBmdW5jdGlvbih4KSB7cmV0dXJuIGZsb2F0KE1hdGgubG9nKDEuMCArIGZsb2F0X2NoZWNrKHgpKSl9LAogICAgbG9nMjogZnVuY3Rpb24oeCkge3JldHVybiBmbG9hdChNYXRoLmxvZyhmbG9hdF9jaGVjayh4KSkvTWF0aC5MTjIpfSwKICAgIGxvZzEwOiBmdW5jdGlvbih4KSB7cmV0dXJuIGZsb2F0KE1hdGgubG9nKGZsb2F0X2NoZWNrKHgpKS9NYXRoLkxOMTApfSwKICAgIG1vZGY6ZnVuY3Rpb24oeCkgewogICAgICAgdmFyIHgxPWZsb2F0X2NoZWNrKHgpOwogICAgICAgaWYgKHgxID4gMCkgewogICAgICAgICAgdmFyIGk9ZmxvYXQoeDEtTWF0aC5mbG9vcih4MSkpOwogICAgICAgICAgcmV0dXJuIFtpLCBmbG9hdCh4MS1pKV0KICAgICAgIH0KCiAgICAgICB2YXIgaT1mbG9hdCh4MS1NYXRoLmNlaWwoeDEpKTsKICAgICAgIHJldHVybiBbaSwgZmxvYXQoTWF0aC5jZWlsKHgxKSldCiAgICB9LAogICAgcGkgOiBmbG9hdChNYXRoLlBJKSwKICAgIHBvdzogZnVuY3Rpb24oeCx5KSB7CiAgICAgICAgaWYoaXNpbnN0YW5jZSh4LGludCkpe3JldHVybiBNYXRoLnBvdyh4LGZsb2F0X2NoZWNrKHkpKX0KICAgICAgICBlbHNle3JldHVybiBmbG9hdChNYXRoLnBvdyh4LnZhbHVlLGZsb2F0X2NoZWNrKHkpKSl9CiAgICB9LAogICAgcmFkaWFuczogZnVuY3Rpb24oeCl7cmV0dXJuIGZsb2F0KGZsb2F0X2NoZWNrKHgpICogTWF0aC5QSS8xODApfSwKICAgIHNpbiA6IGZ1bmN0aW9uKHgpe3JldHVybiBmbG9hdChNYXRoLnNpbihmbG9hdF9jaGVjayh4KSkpfSwKICAgIHNxcnQgOiBmdW5jdGlvbih4KXtyZXR1cm4gZmxvYXQoTWF0aC5zcXJ0KGZsb2F0X2NoZWNrKHgpKSl9LAogICAgdHJ1bmM6IGZ1bmN0aW9uKHgpIHsKICAgICAgIHRyeXtyZXR1cm4gZ2V0YXR0cih4LCdfX3RydW5jX18nKSgpfWNhdGNoKGVycil7JHBvcF9leGMoKX0KICAgICAgIHZhciB4MT1mbG9hdF9jaGVjayh4KTsKICAgICAgIGlmICghaXNOYU4ocGFyc2VGbG9hdCh4MSkpICYmIGlzRmluaXRlKHgxKSkgcmV0dXJuIGludChNYXRoLmZsb29yKHgxKSk7CiAgICAgICAKICAgICAgICRyYWlzZSgnVmFsdWVFcnJvcicsICdvYmplY3QgaXMgbm90IGEgbnVtYmVyIGFuZCBkb2VzIG5vdCBjb250YWluIF9fdHJ1bmNfXycpCiAgICB9Cn0KCiRtb2R1bGUuX19jbGFzc19fID0gJG1vZHVsZSAvLyBkZWZpbmVkIGluICRweV91dGlscwokbW9kdWxlLl9fc3RyX18gPSBmdW5jdGlvbigpe3JldHVybiAiPG1vZHVsZSAnbWF0aCc+In0KZm9yKHZhciAkYXR0ciBpbiAkbW9kdWxlKXsKICAgIGlmKHR5cGVvZiAkbW9kdWxlWyRhdHRyXT09PSdmdW5jdGlvbicpewogICAgICAgICRtb2R1bGVbJGF0dHJdLl9fcmVwcl9fPShmdW5jdGlvbihmdW5jKXsKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuICc8YnVpbHQtaW4gZnVuY3Rpb24gJytmdW5jKyc+J319KSgkYXR0cikKICAgICAgICAkbW9kdWxlWyRhdHRyXS5fX3N0cl9fPShmdW5jdGlvbihmdW5jKXsKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuICc8YnVpbHQtaW4gZnVuY3Rpb24gJytmdW5jKyc+J319KSgkYXR0cikKICAgIH0KfQo=',
'/libs/random.js':'JG1vZHVsZSA9IHsKICAgIF9fZ2V0YXR0cl9fIDogZnVuY3Rpb24oYXR0cil7cmV0dXJuIHRoaXNbYXR0cl19LAogICAgcmFuZG9tOmZ1bmN0aW9uKCl7CiAgICAgIGlmKGFyZ3VtZW50cy5sZW5ndGggPiAwKXsKICAgICAgICB0aHJvdyBUeXBlRXJyb3IoInJhbmRvbSgpIHRha2VzIG5vIGFyZ3VtZW50cyAoIithcmd1bWVudHMubGVuZ3RoKyIgZ2l2ZW4pIikKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmxvYXQoTWF0aC5yYW5kb20oKSk7CiAgICAgIH0KICAgIH0sCiAgICByYW5kaW50OmZ1bmN0aW9uKGEsYil7cmV0dXJuIGludChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqKGItYSsxKSthKSl9LAogICAgcmFuZHJhbmdlOmZ1bmN0aW9uKHN0YXJ0LHN0b3Asc3RlcCl7CiAgICAgIGlmKHN0ZXAgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHN0ZXA9MTsKICAgICAgfSBlbHNlIGlmKHN0ZXAgPT0gMCkgeyAKICAgICAgICAvL3JhaXNlIFZhbHVlRXJyb3IoInplcm8gc3RlcCBmb3IgcmFuZHJhbmdlKCkiKTsKICAgICAgfQoKICAgICAgaWYoc3RvcCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgIHN0b3A9c3RhcnQ7CiAgICAgICAgIHN0YXJ0PTA7CiAgICAgIH0KICAgICAgdmFyIHdpZHRoPXN0b3Atc3RhcnQ7CiAgICAgIGlmIChzdGVwPT0xICYmIHdpZHRoID4gMCkgewogICAgICAgIHJldHVybiBzdGFydCArIGludChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqd2lkdGgpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyByYWlzZSBWYWx1ZUVycm9yKCJlbXB0eSByYW5nZSBmb3IgcmFuZHJhbmdlKCkgKCIrc3RhcnQrIiwiK3N0b3ArJywnK3N0ZXArJyknKTsKICAgICAgfQogICAgICAKICAgICAgdmFyIG47CiAgICAgIGlmIChzdGVwID4gMCkgewogICAgICAgICBuPU1hdGguZmxvb3IoKHdpZHRoK3N0ZXAtMSkvc3RlcCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgIG49TWF0aC5mbG9vcigod2lkdGgrc3RlcCsxKS9zdGVwKTsKICAgICAgfQogICAgICByZXR1cm4gc3RhcnQgKyBzdGVwKmludChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqbikpCiAgICAgIC8vcmV0dXJuIGludChNYXRoLnJhbmRvbSgpKihzdG9wL3N0ZXAtc3RhcnQvc3RlcCkqc3RlcCArIHN0YXJ0KQogICAgfSwKICAgIHNodWZmbGU6ZnVuY3Rpb24oeCwgcm5kKXsKICAgICAgaWYgKHgubGVuZ3RoIDw9IDEpIHsgcmV0dXJuIHh9CgogICAgICBpZiAocm5kID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgcm5kPU1hdGgucmFuZG9tCiAgICAgIH0KCiAgICAgIGZvcih2YXIgaiwgbywgaSA9IHgubGVuZ3RoOyBpOyBqID0gcGFyc2VJbnQocm5kKCkgKiBpKSwgbyA9IHhbLS1pXSwgeFtpXSA9IHhbal0sIHhbal0gPSBvKTsKICAgIH0KfQokbW9kdWxlLl9fY2xhc3NfXyA9ICRtb2R1bGUgLy8gZGVmaW5lZCBpbiAkcHlfdXRpbHMKJG1vZHVsZS5fX3N0cl9fID0gZnVuY3Rpb24oKXtyZXR1cm4gIjxtb2R1bGUgJ3JhbmRvbSc+In0K',
'/libs/re.js':'JG1vZHVsZSA9IChmdW5jdGlvbigpewogICAgb2JqID0ge19fY2xhc3NfXzokbW9kdWxlLAogICAgICAgIF9fc3RyX186IGZ1bmN0aW9uKCl7cmV0dXJuICI8bW9kdWxlICdyZSc+In0KICAgIH0KICAgIG9iai5BID0gb2JqLkFTQ0lJID0gMjU2CiAgICBvYmouSSA9ICdpJwogICAgb2JqLk0gPSAnbScKICAgICRTUkVfUGF0dGVybkRpY3QgPSB7CiAgICAgICAgX19jbGFzc19fOiR0eXBlLAogICAgICAgIF9fbmFtZV9fOidTUkVfUGF0dGVybicKICAgIH0KICAgICRTUkVfUGF0dGVybkRpY3QubWF0Y2ggPSBmdW5jdGlvbihzZWxmLHN0cmluZyl7CiAgICAgICAgcmV0dXJuIG9iai5tYXRjaChzZWxmLnBhdHRlcm4sc3RyaW5nLHNlbGYuZmxhZ3MpCiAgICB9CiAgICAkU1JFX1BhdHRlcm5EaWN0LnNlYXJjaCA9IGZ1bmN0aW9uKHNlbGYsc3RyaW5nKXsKICAgICAgICByZXR1cm4gb2JqLm9iaihzZWxmLnBhdHRlcm4sc3RyaW5nLHNlbGYuZmxhZ3MpCiAgICB9CiAgICBvYmouY29tcGlsZSA9IGZ1bmN0aW9uKHBhdHRlcm4sZmxhZ3MpewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIF9fY2xhc3NfXzokU1JFX1BhdHRlcm5EaWN0LAogICAgICAgICAgICBwYXR0ZXJuOnBhdHRlcm4sCiAgICAgICAgICAgIGZsYWdzOmZsYWdzCiAgICAgICAgfQogICAgfQogICAgb2JqLmZpbmRhbGwgPSBmdW5jdGlvbihwYXR0ZXJuLHN0cmluZyxmbGFncyl7CiAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoJ3JlLnNlYXJjaCcsYXJndW1lbnRzLFsncGF0dGVybicsJ3N0cmluZyddLHt9LCdhcmdzJywna3cnKQogICAgICAgIHZhciBhcmdzID0gJG5zWydhcmdzJ10KICAgICAgICBpZihhcmdzLmxlbmd0aD4wKXt2YXIgZmxhZ3M9YXJnc1swXX0KICAgICAgICBlbHNle3ZhciBmbGFncyA9ICRuc1sna3cnXS5nZXQoJ2ZsYWdzJywnJyl9CiAgICAgICAgZmxhZ3MgKz0gJ2dtJwogICAgICAgIHZhciBqc3AgPSBuZXcgUmVnRXhwKHBhdHRlcm4sZmxhZ3MpCiAgICAgICAgdmFyIGpzbWF0Y2ggPSBzdHJpbmcubWF0Y2goanNwKQogICAgICAgIGlmKGpzbWF0Y2g9PT1udWxsKXtyZXR1cm4gW119CiAgICAgICAgcmV0dXJuIGpzbWF0Y2gKICAgIH0KICAgIG9iai5zZWFyY2ggPSBmdW5jdGlvbihwYXR0ZXJuLHN0cmluZyl7CiAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoJ3JlLnNlYXJjaCcsYXJndW1lbnRzLFsncGF0dGVybicsJ3N0cmluZyddLHt9LCdhcmdzJywna3cnKQogICAgICAgIHZhciBhcmdzID0gJG5zWydhcmdzJ10KICAgICAgICBpZihhcmdzLmxlbmd0aD4wKXt2YXIgZmxhZ3M9YXJnc1swXX0KICAgICAgICBlbHNle3ZhciBmbGFncyA9IGdldGF0dHIoJG5zWydrdyddLCdnZXQnKSgnZmxhZ3MnLCcnKX0KICAgICAgICB2YXIganNwID0gbmV3IFJlZ0V4cChwYXR0ZXJuLGZsYWdzKQogICAgICAgIHZhciBqc21hdGNoID0gc3RyaW5nLm1hdGNoKGpzcCkKICAgICAgICBpZihqc21hdGNoPT09bnVsbCl7cmV0dXJuIE5vbmV9CiAgICAgICAgdmFyIG1vID0gbmV3IE9iamVjdCgpCiAgICAgICAgbW8uZ3JvdXAgPSBmdW5jdGlvbigpewogICAgICAgICAgICB2YXIgcmVzID0gW10KICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxhcmd1bWVudHMubGVuZ3RoO2krKyl7CiAgICAgICAgICAgICAgICBpZihqc21hdGNoW2FyZ3VtZW50c1tpXV09PT11bmRlZmluZWQpe3Jlcy5wdXNoKE5vbmUpfQogICAgICAgICAgICAgICAgZWxzZXtyZXMucHVzaChqc21hdGNoW2FyZ3VtZW50c1tpXV0pfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4gcmVzWzBdfQogICAgICAgICAgICByZXR1cm4gdHVwbGUocmVzKQogICAgICAgIH0KICAgICAgICBtby5ncm91cHMgPSBmdW5jdGlvbihfZGVmYXVsdCl7CiAgICAgICAgICAgIGlmKF9kZWZhdWx0PT09dW5kZWZpbmVkKXtfZGVmYXVsdD1Ob25lfQogICAgICAgICAgICB2YXIgcmVzID0gW10KICAgICAgICAgICAgZm9yKHZhciBpPTE7aTxqc21hdGNoLmxlbmd0aDtpKyspewogICAgICAgICAgICAgICAgaWYoanNtYXRjaFtpXT09PXVuZGVmaW5lZCl7cmVzLnB1c2goX2RlZmF1bHQpfQogICAgICAgICAgICAgICAgZWxzZXtyZXMucHVzaChqc21hdGNoW2ldKX0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdHVwbGUocmVzKQogICAgICAgIH0KICAgICAgICBtby5zdGFydCA9IGZ1bmN0aW9uKCl7cmV0dXJuIGpzbWF0Y2guaW5kZXh9CiAgICAgICAgbW8uc3RyaW5nID0gc3RyaW5nCiAgICAgICAgcmV0dXJuIEpTT2JqZWN0KG1vKQogICAgfQogICAgb2JqLnN1YiA9IGZ1bmN0aW9uKHBhdHRlcm4scmVwbCxzdHJpbmcpewogICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCdyZS5zZWFyY2gnLGFyZ3VtZW50cyxbJ3BhdHRlcm4nLCdyZXBsJywnc3RyaW5nJ10se30sJ2FyZ3MnLCdrdycpCiAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgdmFyIGFyZ3MgPSAkbnNbJ2FyZ3MnXQogICAgICAgIHZhciBjb3VudCA9ICREaWN0RGljdC5nZXQoJG5zWydrdyddLCdjb3VudCcsMCkKICAgICAgICB2YXIgZmxhZ3MgPSAkRGljdERpY3QuZ2V0KCRuc1sna3cnXSwnZmxhZ3MnLCcnKQogICAgICAgIGlmKGFyZ3MubGVuZ3RoPjApe3ZhciBjb3VudD1hcmdzWzBdfQogICAgICAgIGlmKGFyZ3MubGVuZ3RoPjEpe3ZhciBmbGFncz1hcmdzWzFdfQogICAgICAgIGlmKHR5cGVvZiByZXBsPT09InN0cmluZyIpewogICAgICAgICAgICAvLyBiYWNrcmVmZXJlbmNlcyBhcmUgXDEsIFwyLi4uIGluIFB5dGhvbiBidXQgJDEsJDIuLi4gaW4gSmF2YXNjcmlwdAogICAgICAgICAgICByZXBsID0gcmVwbC5yZXBsYWNlKC9cXChcZCspL2csJyQkJDEnKQogICAgICAgIH1lbHNlIGlmKHR5cGVvZiByZXBsPT09ImZ1bmN0aW9uIil7CiAgICAgICAgICAgIC8vIHRoZSBhcmd1bWVudCBwYXNzZWQgdG8gdGhlIFB5dGhvbiBmdW5jdGlvbiBpcyB0aGUgbWF0Y2ggb2JqZWN0CiAgICAgICAgICAgIC8vIHRoZSBhcmd1bWVudHMgcGFzc2VkIHRvIHRoZSBKYXZhc2NyaXB0IGZ1bmN0aW9uIGFyZSA6CiAgICAgICAgICAgIC8vIC0gdGhlIG1hdGNoZWQgc3Vic3RyaW5nCiAgICAgICAgICAgIC8vIC0gdGhlIG1hdGNoZWQgZ3JvdXBzCiAgICAgICAgICAgIC8vIC0gdGhlIG9mZnNldCBvZiB0aGUgbWF0Y2hlZCBzdWJzdHJpbmcgaW5zaWRlIHRoZSBzdHJpbmcKICAgICAgICAgICAgLy8gLSB0aGUgc3RyaW5nIGJlaW5nIGV4YW1pbmVkCiAgICAgICAgICAgIHZhciAkcmVwbDEgPSBmdW5jdGlvbigpewogICAgICAgICAgICAgICAgdmFyIG1vID0gT2JqZWN0KCkKICAgICAgICAgICAgICAgIG1vLnN0cmluZyA9IGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoLTFdCiAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBhcmd1bWVudHNbYXJndW1lbnRzLmxlbmd0aC0yXQogICAgICAgICAgICAgICAgdmFyIGVuZCA9IHN0YXJ0ICsgYXJndW1lbnRzWzBdLmxlbmd0aAogICAgICAgICAgICAgICAgbW8uc3RhcnQgPSBmdW5jdGlvbigpe3JldHVybiBzdGFydH0KICAgICAgICAgICAgICAgIG1vLmVuZCA9IGZ1bmN0aW9uKCl7cmV0dXJuIGVuZH0KICAgICAgICAgICAgICAgIGdyb3VwcyA9IFtdCiAgICAgICAgICAgICAgICBmb3IodmFyIGk9MTtpPGFyZ3VtZW50cy5sZW5ndGgtMjtpKyspe2dyb3Vwcy5wdXNoKGFyZ3VtZW50c1tpXSl9CiAgICAgICAgICAgICAgICBtby5ncm91cHMgPSBmdW5jdGlvbihfZGVmYXVsdCl7CiAgICAgICAgICAgICAgICAgICAgaWYoX2RlZmF1bHQ9PT11bmRlZmluZWQpe19kZWZhdWx0PU5vbmV9CiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IFtdCiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxncm91cHMubGVuZ3RoO2krKyl7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGdyb3Vwc1tpXT09PXVuZGVmaW5lZCl7cmVzLnB1c2goX2RlZmF1bHQpfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNle3Jlcy5wdXNoKGdyb3Vwc1tpXSl9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiByZXBsKEpTT2JqZWN0KG1vKSkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZihjb3VudD09MCl7ZmxhZ3MrPSdnJ30KICAgICAgICB2YXIganNwID0gbmV3IFJlZ0V4cChwYXR0ZXJuLGZsYWdzKQogICAgICAgIGlmKHR5cGVvZiByZXBsPT09J2Z1bmN0aW9uJyl7cmV0dXJuIHN0cmluZy5yZXBsYWNlKGpzcCwkcmVwbDEpfQogICAgICAgIGVsc2V7cmV0dXJuIHN0cmluZy5yZXBsYWNlKGpzcCxyZXBsKX0KICAgIH0KICAgIG9iai5tYXRjaCA9IChmdW5jdGlvbihzZWFyY2hfZnVuYyl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIC8vIG1hdGNoIGlzIGxpa2Ugc2VhcmNoIGJ1dCBwYXR0ZXJuIG11c3Qgc3RhcnQgd2l0aCBeCiAgICAgICAgICAgIHBhdHRlcm4gPSBhcmd1bWVudHNbMF0KICAgICAgICAgICAgaWYocGF0dGVybi5jaGFyQXQoMCkhPT0nXicpe3BhdHRlcm4gPSAnXicrcGF0dGVybn0KICAgICAgICAgICAgdmFyIGFyZ3MgPSBbcGF0dGVybl0KICAgICAgICAgICAgZm9yKHZhciBpPTE7aTxhcmd1bWVudHMubGVuZ3RoO2krKyl7YXJncy5wdXNoKGFyZ3VtZW50c1tpXSl9CiAgICAgICAgICAgIHJldHVybiBzZWFyY2hfZnVuYy5hcHBseShudWxsLGFyZ3MpCiAgICAgICAgfQogICAgfSkob2JqLnNlYXJjaCkKCiAgICByZXR1cm4gb2JqCn0KKSgp',
'/libs/svg.js':'JG1vZHVsZSA9IChmdW5jdGlvbigpewoKJHN2Z05TID0gImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgokeGxpbmtOUyA9ICJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIgoKZnVuY3Rpb24gJFNWR1RhZyh0YWdfbmFtZSxhcmdzKXsKICAgIC8vIHJlcHJlc2VudHMgYW4gU1ZHIHRhZwogICAgdmFyICRpID0gbnVsbAogICAgdmFyICRvYmogPSB0aGlzCiAgICB2YXIgb2JqID0gJERPTU5vZGUoZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCRzdmdOUyx0YWdfbmFtZSkpCiAgICBpZihhcmdzIT11bmRlZmluZWQgJiYgYXJncy5sZW5ndGg+MCl7CiAgICAgICAgJHN0YXJ0ID0gMAogICAgICAgICRmaXJzdCA9IGFyZ3NbMF0KICAgICAgICAvLyBpZiBmaXJzdCBhcmd1bWVudCBpcyBub3QgYSBrZXl3b3JkLCBpdCdzIHRoZSB0YWcgY29udGVudAogICAgICAgIGlmKCRmaXJzdC5fX2NsYXNzX18hPT0kS3cpewogICAgICAgICAgICAkc3RhcnQgPSAxCiAgICAgICAgICAgIGlmKGlzaW5zdGFuY2UoJGZpcnN0LFtzdHIsaW50LGZsb2F0XSkpewogICAgICAgICAgICAgICAgdHh0ID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoc3RyKCRmaXJzdCkpCiAgICAgICAgICAgICAgICBvYmouZWx0LmFwcGVuZENoaWxkKHR4dCkKICAgICAgICAgICAgfSBlbHNlIGlmKCRmaXJzdC5fX2NsYXNzX189PT0kVGFnU3VtRGljdCl7CiAgICAgICAgICAgICAgICBmb3IoJGk9MDskaTwkZmlyc3QuY2hpbGRyZW4ubGVuZ3RoOyRpKyspewogICAgICAgICAgICAgICAgICAgIG9iai5lbHQuYXBwZW5kQ2hpbGQoJGZpcnN0LmNoaWxkcmVuWyRpXSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRyeXtvYmouZWx0LmFwcGVuZENoaWxkKCRmaXJzdC5lbHQpfQogICAgICAgICAgICAgICAgY2F0Y2goZXJyKXskcmFpc2UoJ1ZhbHVlRXJyb3InLCd3cm9uZyBlbGVtZW50ICcrJGZpcnN0KX0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvLyBhdHRyaWJ1dGVzCiAgICAgICAgZm9yKCRpPSRzdGFydDskaTxhcmdzLmxlbmd0aDskaSsrKXsKICAgICAgICAgICAgLy8ga2V5d29yZCBhcmd1bWVudHMKICAgICAgICAgICAgJGFyZyA9IGFyZ3NbJGldCiAgICAgICAgICAgIGlmKCRhcmcgJiYgJGFyZy5fX2NsYXNzX189PT0kS3cpewogICAgICAgICAgICAgICAgaWYoJGFyZy5uYW1lLnRvTG93ZXJDYXNlKCkuc3Vic3RyKDAsMik9PSJvbiIpeyAvLyBldmVudHMKICAgICAgICAgICAgICAgICAgICBldmFsKCdET01Ob2RlLmJpbmQob2JqLCInKyRhcmcubmFtZS50b0xvd2VyQ2FzZSgpLnN1YnN0cigyKSsnIixmdW5jdGlvbigpeycrJGFyZy52YWx1ZSsnfSknKQogICAgICAgICAgICAgICAgfWVsc2UgaWYoJGFyZy5uYW1lLnRvTG93ZXJDYXNlKCk9PSJzdHlsZSIpewogICAgICAgICAgICAgICAgICAgIERPTU5vZGUuc2V0X3N0eWxlKG9iaiwkYXJnLnZhbHVlKQogICAgICAgICAgICAgICAgfWVsc2UgaWYoJGFyZy5uYW1lLnRvTG93ZXJDYXNlKCkuaW5kZXhPZigiaHJlZiIpICE9PSAtMSl7IC8vIHhsaW5rOmhyZWYKICAgICAgICAgICAgICAgICAgICBvYmouZWx0LnNldEF0dHJpYnV0ZU5TKCAiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIsImhyZWYiLCRhcmcudmFsdWUpCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmKCRhcmcudmFsdWUhPT1mYWxzZSl7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9wdGlvbi5zZWxlY3RlZD1mYWxzZSBzZXRzIGl0IHRvIHRydWUgOi0pCiAgICAgICAgICAgICAgICAgICAgICAgIG9iai5lbHQuc2V0QXR0cmlidXRlTlMobnVsbCwkYXJnLm5hbWUucmVwbGFjZSgnXycsJy0nKSwkYXJnLnZhbHVlKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIHJldHVybiBvYmoKfQoKLy8gU1ZHCnZhciAkc3ZnX3RhZ3MgPSBbJ2EnLAonYWx0R2x5cGgnLAonYWx0R2x5cGhEZWYnLAonYWx0R2x5cGhJdGVtJywKJ2FuaW1hdGUnLAonYW5pbWF0ZUNvbG9yJywKJ2FuaW1hdGVNb3Rpb24nLAonYW5pbWF0ZVRyYW5zZm9ybScsCidjaXJjbGUnLAonY2xpcFBhdGgnLAonY29sb3JfcHJvZmlsZScsIC8vIGluc3RlYWQgb2YgY29sb3ItcHJvZmlsZQonY3Vyc29yJywKJ2RlZnMnLAonZGVzYycsCidlbGxpcHNlJywKJ2ZlQmxlbmQnLAonZycsCidpbWFnZScsCidsaW5lJywKJ2xpbmVhckdyYWRpZW50JywKJ21hcmtlcicsCidtYXNrJywKJ3BhdGgnLAoncGF0dGVybicsCidwb2x5Z29uJywKJ3BvbHlsaW5lJywKJ3JhZGlhbEdyYWRpZW50JywKJ3JlY3QnLAonc3RvcCcsCidzdmcnLAondGV4dCcsCid0cmVmJywKJ3RzcGFuJywKJ3VzZSddCgokc3ZnID0gZnVuY3Rpb24oKXtyZXR1cm4gJFNWR1RhZygnWCcsYXJndW1lbnRzKX0KJHN2ZyArPSAnJyAvLyBzb3VyY2UgY29kZQoKdmFyIG9iaiA9IG5ldyBPYmplY3QoKQpmb3IodmFyIGk9MDtpPCRzdmdfdGFncy5sZW5ndGg7aSsrKXsKICAgIHZhciB0YWcgPSAkc3ZnX3RhZ3NbaV0KICAgIGV2YWwoJ29iai4nK3RhZysnPScrJHN2Zy5yZXBsYWNlKCdYJyx0YWcpKQp9Cm9iai5fX2dldGF0dHJfXyA9IGZ1bmN0aW9uKGF0dHIpe3JldHVybiB0aGlzW2F0dHJdfQpyZXR1cm4gb2JqCn0pKCk=',
'/libs/time.js':'JG1vZHVsZSA9ICB7CgogICAgX19nZXRhdHRyX18gOiBmdW5jdGlvbihhdHRyKXtyZXR1cm4gdGhpc1thdHRyXX0sCiAgICAKICAgIF9fbmFtZV9fIDogJ3RpbWUnLAoKICAgIGNsZWFyX2ludGVydmFsIDogZnVuY3Rpb24oaW50X2lkKXt3aW5kb3cuY2xlYXJJbnRlcnZhbChpbnRfaWQpfSwKICAgIAogICAgY2xlYXJfdGltZW91dCA6IGZ1bmN0aW9uKHRpbWVvdXRfaWQpe3dpbmRvdy5jbGVhclRpbWVvdXQodGltZW91dF9pZCl9LAoKICAgIGN0aW1lOiBmdW5jdGlvbih0aW1lc3RhbXApewogICAgICAgaWYgKHRpbWVzdGFtcCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICB0aW1lc3RhbXA9aW50KG5ldyBEYXRlKCkuZ2V0VGltZSgpLzEwMDApOwogICAgICAgfQogICAgICAgdmFyIGQ9bmV3IERhdGUoMCk7ICAKICAgICAgIGQuc2V0VVRDU2Vjb25kcyh0aW1lc3RhbXApOwogICAgICAgcmV0dXJuIGQudG9VVENTdHJpbmcoKTsKICAgIH0sCgogICAgcGVyZl9jb3VudGVyOiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gZmxvYXQoKG5ldyBEYXRlKCkpLmdldFRpbWUoKS8xMDAwLjApOwogICAgfSwKICAgIAogICAgc2V0X2ludGVydmFsIDogZnVuY3Rpb24oZnVuYyxpbnRlcnZhbCl7CiAgICAgICAgcmV0dXJuIGludCh3aW5kb3cuc2V0SW50ZXJ2YWwoZnVuYyxpbnRlcnZhbCkpCiAgICB9LAoKICAgIHNldF90aW1lb3V0IDogZnVuY3Rpb24oZnVuYyxpbnRlcnZhbCl7d2luZG93LnNldFRpbWVvdXQoZnVuYyxpbnRlcnZhbCl9LAoKICAgIGxvY2FsdGltZSA6IGZ1bmN0aW9uKHNlY3MpeyAKICAgICAgIHZhciBkPW5ldyBEYXRlKCk7CiAgICAgICBpZiAoc2VjcyA9PT0gdW5kZWZpbmVkIHx8IHNlY3MgPT09IE5vbmUpIHtyZXR1cm4gZC5nZXRUaW1lKCl9CgogICAgICAgLy8gY2FsY3VsYXRlIGlmIHdlIGFyZSBpbiBkYXlsaWdodCBzYXZpbmdzIHRpbWUgb3Igbm90LgogICAgICAgLy8gYm9ycm93ZWQgZnJvbSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzExODg3OTM0L2NoZWNrLWlmLWRheWxpZ2h0LXNhdmluZy10aW1lLWlzLWluLWVmZmVjdC1hbmQtaWYtaXQtaXMtZm9yLWhvdy1tYW55LWhvdXJzCiAgICAgICB2YXIgamFuID0gbmV3IERhdGUoZC5nZXRGdWxsWWVhcigpLCAwLCAxKTsKICAgICAgIHZhciBqdWwgPSBuZXcgRGF0ZShkLmdldEZ1bGxZZWFyKCksIDYsIDEpOwogICAgICAgdmFyIGRzdD1pbnQoZC5nZXRUaW1lem9uZU9mZnNldCgpIDwgTWF0aC5tYXgoamFuLmdldFRpbWV6b25lT2Zmc2V0KCksIGp1bC5nZXRUaW1lem9uZU9mZnNldCgpKSk7CgogICAgICAgcmV0dXJuIGxpc3QoW2QuZ2V0RnVsbFllYXIoKSwgZC5nZXRNb250aCgpKzEsIGQuZ2V0RGF0ZSgpLCBkLmdldEhvdXJzKCksCiAgICAgICAgICAgICAgICAgICAgZC5nZXRNaW51dGVzKCksIGQuZ2V0U2Vjb25kcygpLCBkLmdldERheSgpLCAwLCBkc3RdKQogICAgICAgLy9maXhtZSAgKHNlY29uZCB0byBsYXN0IHZhbHVlIGlzIDAgd2hpY2ggaXMgdGhlIG51bWJlciBvZiBkYXlzIGluIHRoaXMgeWVhci4uKQogICAgfSwKICAgIHRpbWUgOiBmdW5jdGlvbigpe3JldHVybiBmbG9hdCgobmV3IERhdGUoKS5nZXRUaW1lKCkpLzEwMDApfSwKICAgIAogICAgc3RyZnRpbWUgOiBmdW5jdGlvbihmb3JtYXQsYXJnKXsKICAgICAgICBmdW5jdGlvbiBucyhhcmcsbmIpewogICAgICAgICAgICAvLyBsZWZ0IHBhZGRpbmcgd2l0aCAwCiAgICAgICAgICAgIHZhciByZXMgPSBhcmcudG9TdHJpbmcoKQogICAgICAgICAgICB3aGlsZShyZXMubGVuZ3RoPG5iKXtyZXMgPSAnMCcrcmVzfQogICAgICAgICAgICByZXR1cm4gcmVzCiAgICAgICAgfQogICAgICAgIGlmKGFyZyl7CiAgICAgICAgICAgIHZhciBvYmogPSBuZXcgRGF0ZShhcmdbMF0sYXJnWzFdLTEsYXJnWzJdLGFyZ1szXSxhcmdbNF0sYXJnWzVdLGFyZ1s2XSkKICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgdmFyIG9iaj1uZXcgRGF0ZSgpCiAgICAgICAgfQogICAgICAgIHZhciBhYmJfd2Vla2RheXMgPSBbJ1N1JywnTW8nLCdUdScsJ1dlJywnVGgnLCdGcicsJ1NhJ10KICAgICAgICB2YXIgZnVsbF93ZWVrZGF5cyA9IFsnU3VuZGF5JywnTW9uZGF5JywnVHVlc2RheScsJ1dlZG5lc2RheScsCiAgICAgICAgICAgICdUaHVyc2RheScsJ0ZyaWRheScsJ1NhdHVyZGF5J10KICAgICAgICB2YXIgYWJiX21vbnRocyA9IFsnSmFuJywnRmViJywnTWFyJywnQXByJywnTWF5JywnSnVuJywKICAgICAgICAgICAgJ0p1bCcsJ0F1ZycsJ1NlcCcsJ09jdCcsJ05vdicsJ0RlYyddCiAgICAgICAgdmFyIGZ1bGxfbW9udGhzID0gWydKYW51YXJ5JywnRmVicnVhcnknLCdNYXJjaCcsJ0FwcmlsJywnTWF5JywnSnVuZScsCiAgICAgICAgICAgICdKdWx5JywnQXVndXN0JywnU2VwdGVtYmVyJywnT2N0b2JlcicsJ05vdmVtYmVyJywnRGVjZW1iZXInXQogICAgICAgIHZhciByZXMgPSBmb3JtYXQKICAgICAgICByZXMgPSByZXMucmVwbGFjZSgvJUgvLG5zKG9iai5nZXRIb3VycygpLDIpKQogICAgICAgIHJlcyA9IHJlcy5yZXBsYWNlKC8lTS8sbnMob2JqLmdldE1pbnV0ZXMoKSwyKSkKICAgICAgICByZXMgPSByZXMucmVwbGFjZSgvJVMvLG5zKG9iai5nZXRTZWNvbmRzKCksMikpCiAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoLyVZLyxucyhvYmouZ2V0RnVsbFllYXIoKSw0KSkKICAgICAgICByZXMgPSByZXMucmVwbGFjZSgvJXkvLG5zKG9iai5nZXRGdWxsWWVhcigpLDQpLnN1YnN0cigyKSkKICAgICAgICByZXMgPSByZXMucmVwbGFjZSgvJW0vLG5zKG9iai5nZXRNb250aCgpKzEsMikpCiAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoLyVkLyxucyhvYmouZ2V0RGF0ZSgpLDIpKQogICAgICAgIHJlcyA9IHJlcy5yZXBsYWNlKC8lYS8sYWJiX3dlZWtkYXlzW29iai5nZXREYXkoKV0pCiAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoLyVBLyxmdWxsX3dlZWtkYXlzW29iai5nZXREYXkoKV0pCiAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoLyViLyxhYmJfbW9udGhzW29iai5nZXRNb250aCgpXSkKICAgICAgICByZXMgPSByZXMucmVwbGFjZSgvJUIvLGZ1bGxfbW9udGhzW29iai5nZXRNb250aCgpXSkKICAgICAgICByZXR1cm4gcmVzCiAgICB9LAogICAgCiAgICBzdHJ1Y3RfdGltZSA6IGZ1bmN0aW9uKGFyZyl7CiAgICAgICAgaWYoIWlzaW5zdGFuY2UoYXJnLFt0dXBsZSxsaXN0XSkpewogICAgICAgICAgICB0aHJvdyBUeXBlRXJyb3IoJ2NvbnN0cnVjdG9yIHJlcXVpcmVzIGEgc2VxdWVuY2UnKQogICAgICAgIH0KICAgICAgICBpZihsZW4oYXJnKSE9OSl7CiAgICAgICAgICAgIHRocm93IFR5cGVFcnJvcigidGltZS5zdHJ1Y3RfdGltZSgpIHRha2VzIGEgOS1zZXF1ZW5jZSAoIitsZW4oYXJnKSsiLXNlcXVlbmNlIGdpdmVuIikKICAgICAgICB9CiAgICAgICAgdmFyIHJlcyA9IGFyZwogICAgICAgIGNvbnNvbGUubG9nKHJlcy5fX2dldGl0ZW1fX1swXSkKICAgICAgICB2YXIgbmFtZXMgPSBbJ3RtX3llYXInLCd0bV9tb24nLCd0bV9tZGF5JywndG1faG91cicsJ3RtX21pbicsJ3RtX3NlYycsJ3RtX3dkYXknLAogICAgICAgICAgICAndG1feWRheScsJ3RtX2lzZHN0JywndG1fem9uZScsJ3RtX2dtdG9mZiddCiAgICAgICAgcmVzLl9fZ2V0YXR0cl9fID0gZnVuY3Rpb24oYXR0cil7CiAgICAgICAgICAgIHZhciBpeCA9IG5hbWVzLmluZGV4T2YoYXR0cikKICAgICAgICAgICAgaWYoaXg+LTEpe3JldHVybiBhcmcuX19nZXRpdGVtX18oaXgpfQogICAgICAgICAgICBpZih0eXBlb2YgcmVzW2F0dHJdPT09J2Z1bmN0aW9uJyl7CiAgICAgICAgICAgICAgICByZXR1cm4gKGZ1bmN0aW9uKG9iail7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG9ialthdHRyXS5hcHBseShvYmosYXJndW1lbnRzKX0KICAgICAgICAgICAgICAgIH0pKHJlcykKICAgICAgICAgICAgfWVsc2UgaWYocmVzW2F0dHJdIT09dW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgIHJldHVybiByZXNbYXR0cl0KICAgICAgICAgICAgfWVsc2V7dGhyb3cgQXR0cmlidXRlRXJyb3IoIm9iamVjdCBoYXMgbm8gYXR0cmlidXRlICciK2F0dHIrIiciKX0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlcwogICAgfQp9Cg==',
'/libs/websocket.js':'Ly8gd2Vic29ja2V0CiRtb2R1bGUgPSAoZnVuY3Rpb24oKXsKCiRXZWJTb2NrZXREaWN0ID0gewogICAgX19jbGFzc19fIDogJHR5cGUsCiAgICBfX25hbWVfXzonV2ViU29ja2V0Jwp9CgokV2ViU29ja2V0RGljdC5iaW5kID0gZnVuY3Rpb24oc2VsZixldmVudCxjYWxsYmFjayl7CiAgICBzZWxmLiR3c1snb24nK2V2ZW50XSA9IGNhbGxiYWNrCn0KCiRXZWJTb2NrZXREaWN0LnNlbmQgPSBmdW5jdGlvbihzZWxmLGRhdGEpewogICAgc2VsZi4kd3Muc2VuZChkYXRhKQp9CiAgICAKJFdlYlNvY2tldERpY3QuY2xvc2UgPSBmdW5jdGlvbihzZWxmKXsKICAgIHNlbGYuJHdzLmNsb3NlKCkKfQoKJFdlYlNvY2tldERpY3QuX19tcm9fXyA9IFskV2ViU29ja2V0RGljdCwkT2JqZWN0RGljdF0KCmZ1bmN0aW9uIHdlYnNvY2tldChob3N0KXsKICAgIHZhciAkc29ja2V0ID0gbmV3IFdlYlNvY2tldChob3N0KTsKICAgIHZhciByZXMgPSB7CiAgICAgICAgX19jbGFzc19fOiRXZWJTb2NrZXREaWN0LAogICAgICAgICR3cyA6ICRzb2NrZXQKICAgIH0KICAgIHJlcy4kd2Vic29ja2V0ID0gJHNvY2tldAogICAgcmV0dXJuIHJlcwp9CndlYnNvY2tldC5fX2NsYXNzX18gPSAkZmFjdG9yeQp3ZWJzb2NrZXQuJGRpY3QgPSAkV2ViU29ja2V0RGljdAoKcmV0dXJuIHt3ZWJzb2NrZXQ6d2Vic29ja2V0fQoKfSkoKQ==',
'/libs/_browser.js':'JG1vZHVsZSA9IHsKICAgIF9fZ2V0YXR0cl9fIDogZnVuY3Rpb24oYXR0cil7cmV0dXJuIHRoaXNbYXR0cl19LAogICAgYWxlcnQ6IGZ1bmN0aW9uKG1lc3NhZ2Upe3dpbmRvdy5hbGVydChtZXNzYWdlKX0sCiAgICBjb25maXJtOiBmdW5jdGlvbihtZXNzYWdlKXtyZXR1cm4gSlNPYmplY3Qod2luZG93LmNvbmZpcm0obWVzc2FnZSkpfSwKICAgIGRvYzogJERPTU5vZGUoZG9jdW1lbnQpLCAgIC8vd2FudCB0byB1c2UgZG9jdW1lbnQgaW5zdGVhZCBvZiBkb2MKICAgIG1vdXNlQ29vcmRzOiBmdW5jdGlvbihldil7cmV0dXJuIEpTT2JqZWN0KCRtb3VzZUNvb3JkcyhldikpfSwKICAgIHByb21wdDogZnVuY3Rpb24obWVzc2FnZSwgZGVmYXVsdF92YWx1ZSl7cmV0dXJuIEpTT2JqZWN0KHdpbmRvdy5wcm9tcHQobWVzc2FnZSwgZGVmYXVsdF92YWx1ZSkpfSwKICAgIHdpbjogSlNPYmplY3Qod2luZG93KSAgICAgLy93YW50IHRvIHVzZSB3aW5kb3cgaW5zdGVhZCBvZiB3aW4KfQokbW9kdWxlLl9fY2xhc3NfXyA9ICRtb2R1bGUgLy8gZGVmaW5lZCBpbiAkcHlfdXRpbHMKJG1vZHVsZS5fX3N0cl9fID0gZnVuY3Rpb24oKXtyZXR1cm4gIjxtb2R1bGUgJ2Jyb3dzZXInPiJ9Cg==',
'/libs/_os.js':'JG1vZHVsZSA9IHsKICAgIF9fZ2V0YXR0cl9fIDogZnVuY3Rpb24oYXR0cil7cmV0dXJuIHRoaXNbYXR0cl19LAogICAgcmFuZG9tOmZ1bmN0aW9uKCl7cmV0dXJuIGZsb2F0KE1hdGgucmFuZG9tKCkpfSwKICAgIHJhbmRpbnQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gaW50KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSooYi1hKSthKSl9Cn0KJG1vZHVsZS5fX2NsYXNzX18gPSAkbW9kdWxlIC8vIGRlZmluZWQgaW4gJHB5X3V0aWxzCiRtb2R1bGUuX19zdHJfXyA9IGZ1bmN0aW9uKCl7cmV0dXJuICI8bW9kdWxlICdfb3MnPiJ9Cg==',
'/libs/crypto_js/rollups/md5.js':'LyoKQ3J5cHRvSlMgdjMuMS4yCmNvZGUuZ29vZ2xlLmNvbS9wL2NyeXB0by1qcwooYykgMjAwOS0yMDEzIGJ5IEplZmYgTW90dC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KY29kZS5nb29nbGUuY29tL3AvY3J5cHRvLWpzL3dpa2kvTGljZW5zZQoqLwp2YXIgQ3J5cHRvSlM9Q3J5cHRvSlN8fGZ1bmN0aW9uKHMscCl7dmFyIG09e30sbD1tLmxpYj17fSxuPWZ1bmN0aW9uKCl7fSxyPWwuQmFzZT17ZXh0ZW5kOmZ1bmN0aW9uKGIpe24ucHJvdG90eXBlPXRoaXM7dmFyIGg9bmV3IG47YiYmaC5taXhJbihiKTtoLmhhc093blByb3BlcnR5KCJpbml0Iil8fChoLmluaXQ9ZnVuY3Rpb24oKXtoLiRzdXBlci5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pO2guaW5pdC5wcm90b3R5cGU9aDtoLiRzdXBlcj10aGlzO3JldHVybiBofSxjcmVhdGU6ZnVuY3Rpb24oKXt2YXIgYj10aGlzLmV4dGVuZCgpO2IuaW5pdC5hcHBseShiLGFyZ3VtZW50cyk7cmV0dXJuIGJ9LGluaXQ6ZnVuY3Rpb24oKXt9LG1peEluOmZ1bmN0aW9uKGIpe2Zvcih2YXIgaCBpbiBiKWIuaGFzT3duUHJvcGVydHkoaCkmJih0aGlzW2hdPWJbaF0pO2IuaGFzT3duUHJvcGVydHkoInRvU3RyaW5nIikmJih0aGlzLnRvU3RyaW5nPWIudG9TdHJpbmcpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmluaXQucHJvdG90eXBlLmV4dGVuZCh0aGlzKX19LApxPWwuV29yZEFycmF5PXIuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGIsaCl7Yj10aGlzLndvcmRzPWJ8fFtdO3RoaXMuc2lnQnl0ZXM9aCE9cD9oOjQqYi5sZW5ndGh9LHRvU3RyaW5nOmZ1bmN0aW9uKGIpe3JldHVybihifHx0KS5zdHJpbmdpZnkodGhpcyl9LGNvbmNhdDpmdW5jdGlvbihiKXt2YXIgaD10aGlzLndvcmRzLGE9Yi53b3JkcyxqPXRoaXMuc2lnQnl0ZXM7Yj1iLnNpZ0J5dGVzO3RoaXMuY2xhbXAoKTtpZihqJTQpZm9yKHZhciBnPTA7ZzxiO2crKyloW2orZz4+PjJdfD0oYVtnPj4+Ml0+Pj4yNC04KihnJTQpJjI1NSk8PDI0LTgqKChqK2cpJTQpO2Vsc2UgaWYoNjU1MzU8YS5sZW5ndGgpZm9yKGc9MDtnPGI7Zys9NCloW2orZz4+PjJdPWFbZz4+PjJdO2Vsc2UgaC5wdXNoLmFwcGx5KGgsYSk7dGhpcy5zaWdCeXRlcys9YjtyZXR1cm4gdGhpc30sY2xhbXA6ZnVuY3Rpb24oKXt2YXIgYj10aGlzLndvcmRzLGg9dGhpcy5zaWdCeXRlcztiW2g+Pj4yXSY9NDI5NDk2NzI5NTw8CjMyLTgqKGglNCk7Yi5sZW5ndGg9cy5jZWlsKGgvNCl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGI9ci5jbG9uZS5jYWxsKHRoaXMpO2Iud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKTtyZXR1cm4gYn0scmFuZG9tOmZ1bmN0aW9uKGIpe2Zvcih2YXIgaD1bXSxhPTA7YTxiO2ErPTQpaC5wdXNoKDQyOTQ5NjcyOTYqcy5yYW5kb20oKXwwKTtyZXR1cm4gbmV3IHEuaW5pdChoLGIpfX0pLHY9bS5lbmM9e30sdD12LkhleD17c3RyaW5naWZ5OmZ1bmN0aW9uKGIpe3ZhciBhPWIud29yZHM7Yj1iLnNpZ0J5dGVzO2Zvcih2YXIgZz1bXSxqPTA7ajxiO2orKyl7dmFyIGs9YVtqPj4+Ml0+Pj4yNC04KihqJTQpJjI1NTtnLnB1c2goKGs+Pj40KS50b1N0cmluZygxNikpO2cucHVzaCgoayYxNSkudG9TdHJpbmcoMTYpKX1yZXR1cm4gZy5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24oYil7Zm9yKHZhciBhPWIubGVuZ3RoLGc9W10saj0wO2o8YTtqKz0yKWdbaj4+PjNdfD1wYXJzZUludChiLnN1YnN0cihqLAoyKSwxNik8PDI0LTQqKGolOCk7cmV0dXJuIG5ldyBxLmluaXQoZyxhLzIpfX0sYT12LkxhdGluMT17c3RyaW5naWZ5OmZ1bmN0aW9uKGIpe3ZhciBhPWIud29yZHM7Yj1iLnNpZ0J5dGVzO2Zvcih2YXIgZz1bXSxqPTA7ajxiO2orKylnLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShhW2o+Pj4yXT4+PjI0LTgqKGolNCkmMjU1KSk7cmV0dXJuIGcuam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKGIpe2Zvcih2YXIgYT1iLmxlbmd0aCxnPVtdLGo9MDtqPGE7aisrKWdbaj4+PjJdfD0oYi5jaGFyQ29kZUF0KGopJjI1NSk8PDI0LTgqKGolNCk7cmV0dXJuIG5ldyBxLmluaXQoZyxhKX19LHU9di5VdGY4PXtzdHJpbmdpZnk6ZnVuY3Rpb24oYil7dHJ5e3JldHVybiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKGEuc3RyaW5naWZ5KGIpKSl9Y2F0Y2goZyl7dGhyb3cgRXJyb3IoIk1hbGZvcm1lZCBVVEYtOCBkYXRhIik7fX0scGFyc2U6ZnVuY3Rpb24oYil7cmV0dXJuIGEucGFyc2UodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGIpKSl9fSwKZz1sLkJ1ZmZlcmVkQmxvY2tBbGdvcml0aG09ci5leHRlbmQoe3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fZGF0YT1uZXcgcS5pbml0O3RoaXMuX25EYXRhQnl0ZXM9MH0sX2FwcGVuZDpmdW5jdGlvbihiKXsic3RyaW5nIj09dHlwZW9mIGImJihiPXUucGFyc2UoYikpO3RoaXMuX2RhdGEuY29uY2F0KGIpO3RoaXMuX25EYXRhQnl0ZXMrPWIuc2lnQnl0ZXN9LF9wcm9jZXNzOmZ1bmN0aW9uKGIpe3ZhciBhPXRoaXMuX2RhdGEsZz1hLndvcmRzLGo9YS5zaWdCeXRlcyxrPXRoaXMuYmxvY2tTaXplLG09ai8oNCprKSxtPWI/cy5jZWlsKG0pOnMubWF4KChtfDApLXRoaXMuX21pbkJ1ZmZlclNpemUsMCk7Yj1tKms7aj1zLm1pbig0KmIsaik7aWYoYil7Zm9yKHZhciBsPTA7bDxiO2wrPWspdGhpcy5fZG9Qcm9jZXNzQmxvY2soZyxsKTtsPWcuc3BsaWNlKDAsYik7YS5zaWdCeXRlcy09an1yZXR1cm4gbmV3IHEuaW5pdChsLGopfSxjbG9uZTpmdW5jdGlvbigpe3ZhciBiPXIuY2xvbmUuY2FsbCh0aGlzKTsKYi5fZGF0YT10aGlzLl9kYXRhLmNsb25lKCk7cmV0dXJuIGJ9LF9taW5CdWZmZXJTaXplOjB9KTtsLkhhc2hlcj1nLmV4dGVuZCh7Y2ZnOnIuZXh0ZW5kKCksaW5pdDpmdW5jdGlvbihiKXt0aGlzLmNmZz10aGlzLmNmZy5leHRlbmQoYik7dGhpcy5yZXNldCgpfSxyZXNldDpmdW5jdGlvbigpe2cucmVzZXQuY2FsbCh0aGlzKTt0aGlzLl9kb1Jlc2V0KCl9LHVwZGF0ZTpmdW5jdGlvbihiKXt0aGlzLl9hcHBlbmQoYik7dGhpcy5fcHJvY2VzcygpO3JldHVybiB0aGlzfSxmaW5hbGl6ZTpmdW5jdGlvbihiKXtiJiZ0aGlzLl9hcHBlbmQoYik7cmV0dXJuIHRoaXMuX2RvRmluYWxpemUoKX0sYmxvY2tTaXplOjE2LF9jcmVhdGVIZWxwZXI6ZnVuY3Rpb24oYil7cmV0dXJuIGZ1bmN0aW9uKGEsZyl7cmV0dXJuKG5ldyBiLmluaXQoZykpLmZpbmFsaXplKGEpfX0sX2NyZWF0ZUhtYWNIZWxwZXI6ZnVuY3Rpb24oYil7cmV0dXJuIGZ1bmN0aW9uKGEsZyl7cmV0dXJuKG5ldyBrLkhNQUMuaW5pdChiLApnKSkuZmluYWxpemUoYSl9fX0pO3ZhciBrPW0uYWxnbz17fTtyZXR1cm4gbX0oTWF0aCk7CihmdW5jdGlvbihzKXtmdW5jdGlvbiBwKGEsayxiLGgsbCxqLG0pe2E9YSsoayZifH5rJmgpK2wrbTtyZXR1cm4oYTw8anxhPj4+MzItaikra31mdW5jdGlvbiBtKGEsayxiLGgsbCxqLG0pe2E9YSsoayZofGImfmgpK2wrbTtyZXR1cm4oYTw8anxhPj4+MzItaikra31mdW5jdGlvbiBsKGEsayxiLGgsbCxqLG0pe2E9YSsoa15iXmgpK2wrbTtyZXR1cm4oYTw8anxhPj4+MzItaikra31mdW5jdGlvbiBuKGEsayxiLGgsbCxqLG0pe2E9YSsoYl4oa3x+aCkpK2wrbTtyZXR1cm4oYTw8anxhPj4+MzItaikra31mb3IodmFyIHI9Q3J5cHRvSlMscT1yLmxpYix2PXEuV29yZEFycmF5LHQ9cS5IYXNoZXIscT1yLmFsZ28sYT1bXSx1PTA7NjQ+dTt1KyspYVt1XT00Mjk0OTY3Mjk2KnMuYWJzKHMuc2luKHUrMSkpfDA7cT1xLk1ENT10LmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9oYXNoPW5ldyB2LmluaXQoWzE3MzI1ODQxOTMsNDAyMzIzMzQxNywyNTYyMzgzMTAyLDI3MTczMzg3OF0pfSwKX2RvUHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKGcsayl7Zm9yKHZhciBiPTA7MTY+YjtiKyspe3ZhciBoPWsrYix3PWdbaF07Z1toXT0odzw8OHx3Pj4+MjQpJjE2NzExOTM1fCh3PDwyNHx3Pj4+OCkmNDI3ODI1NTM2MH12YXIgYj10aGlzLl9oYXNoLndvcmRzLGg9Z1trKzBdLHc9Z1trKzFdLGo9Z1trKzJdLHE9Z1trKzNdLHI9Z1trKzRdLHM9Z1trKzVdLHQ9Z1trKzZdLHU9Z1trKzddLHY9Z1trKzhdLHg9Z1trKzldLHk9Z1trKzEwXSx6PWdbaysxMV0sQT1nW2srMTJdLEI9Z1trKzEzXSxDPWdbaysxNF0sRD1nW2srMTVdLGM9YlswXSxkPWJbMV0sZT1iWzJdLGY9YlszXSxjPXAoYyxkLGUsZixoLDcsYVswXSksZj1wKGYsYyxkLGUsdywxMixhWzFdKSxlPXAoZSxmLGMsZCxqLDE3LGFbMl0pLGQ9cChkLGUsZixjLHEsMjIsYVszXSksYz1wKGMsZCxlLGYsciw3LGFbNF0pLGY9cChmLGMsZCxlLHMsMTIsYVs1XSksZT1wKGUsZixjLGQsdCwxNyxhWzZdKSxkPXAoZCxlLGYsYyx1LDIyLGFbN10pLApjPXAoYyxkLGUsZix2LDcsYVs4XSksZj1wKGYsYyxkLGUseCwxMixhWzldKSxlPXAoZSxmLGMsZCx5LDE3LGFbMTBdKSxkPXAoZCxlLGYsYyx6LDIyLGFbMTFdKSxjPXAoYyxkLGUsZixBLDcsYVsxMl0pLGY9cChmLGMsZCxlLEIsMTIsYVsxM10pLGU9cChlLGYsYyxkLEMsMTcsYVsxNF0pLGQ9cChkLGUsZixjLEQsMjIsYVsxNV0pLGM9bShjLGQsZSxmLHcsNSxhWzE2XSksZj1tKGYsYyxkLGUsdCw5LGFbMTddKSxlPW0oZSxmLGMsZCx6LDE0LGFbMThdKSxkPW0oZCxlLGYsYyxoLDIwLGFbMTldKSxjPW0oYyxkLGUsZixzLDUsYVsyMF0pLGY9bShmLGMsZCxlLHksOSxhWzIxXSksZT1tKGUsZixjLGQsRCwxNCxhWzIyXSksZD1tKGQsZSxmLGMsciwyMCxhWzIzXSksYz1tKGMsZCxlLGYseCw1LGFbMjRdKSxmPW0oZixjLGQsZSxDLDksYVsyNV0pLGU9bShlLGYsYyxkLHEsMTQsYVsyNl0pLGQ9bShkLGUsZixjLHYsMjAsYVsyN10pLGM9bShjLGQsZSxmLEIsNSxhWzI4XSksZj1tKGYsYywKZCxlLGosOSxhWzI5XSksZT1tKGUsZixjLGQsdSwxNCxhWzMwXSksZD1tKGQsZSxmLGMsQSwyMCxhWzMxXSksYz1sKGMsZCxlLGYscyw0LGFbMzJdKSxmPWwoZixjLGQsZSx2LDExLGFbMzNdKSxlPWwoZSxmLGMsZCx6LDE2LGFbMzRdKSxkPWwoZCxlLGYsYyxDLDIzLGFbMzVdKSxjPWwoYyxkLGUsZix3LDQsYVszNl0pLGY9bChmLGMsZCxlLHIsMTEsYVszN10pLGU9bChlLGYsYyxkLHUsMTYsYVszOF0pLGQ9bChkLGUsZixjLHksMjMsYVszOV0pLGM9bChjLGQsZSxmLEIsNCxhWzQwXSksZj1sKGYsYyxkLGUsaCwxMSxhWzQxXSksZT1sKGUsZixjLGQscSwxNixhWzQyXSksZD1sKGQsZSxmLGMsdCwyMyxhWzQzXSksYz1sKGMsZCxlLGYseCw0LGFbNDRdKSxmPWwoZixjLGQsZSxBLDExLGFbNDVdKSxlPWwoZSxmLGMsZCxELDE2LGFbNDZdKSxkPWwoZCxlLGYsYyxqLDIzLGFbNDddKSxjPW4oYyxkLGUsZixoLDYsYVs0OF0pLGY9bihmLGMsZCxlLHUsMTAsYVs0OV0pLGU9bihlLGYsYyxkLApDLDE1LGFbNTBdKSxkPW4oZCxlLGYsYyxzLDIxLGFbNTFdKSxjPW4oYyxkLGUsZixBLDYsYVs1Ml0pLGY9bihmLGMsZCxlLHEsMTAsYVs1M10pLGU9bihlLGYsYyxkLHksMTUsYVs1NF0pLGQ9bihkLGUsZixjLHcsMjEsYVs1NV0pLGM9bihjLGQsZSxmLHYsNixhWzU2XSksZj1uKGYsYyxkLGUsRCwxMCxhWzU3XSksZT1uKGUsZixjLGQsdCwxNSxhWzU4XSksZD1uKGQsZSxmLGMsQiwyMSxhWzU5XSksYz1uKGMsZCxlLGYsciw2LGFbNjBdKSxmPW4oZixjLGQsZSx6LDEwLGFbNjFdKSxlPW4oZSxmLGMsZCxqLDE1LGFbNjJdKSxkPW4oZCxlLGYsYyx4LDIxLGFbNjNdKTtiWzBdPWJbMF0rY3wwO2JbMV09YlsxXStkfDA7YlsyXT1iWzJdK2V8MDtiWzNdPWJbM10rZnwwfSxfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMuX2RhdGEsaz1hLndvcmRzLGI9OCp0aGlzLl9uRGF0YUJ5dGVzLGg9OCphLnNpZ0J5dGVzO2tbaD4+PjVdfD0xMjg8PDI0LWglMzI7dmFyIGw9cy5mbG9vcihiLwo0Mjk0OTY3Mjk2KTtrWyhoKzY0Pj4+OTw8NCkrMTVdPShsPDw4fGw+Pj4yNCkmMTY3MTE5MzV8KGw8PDI0fGw+Pj44KSY0Mjc4MjU1MzYwO2tbKGgrNjQ+Pj45PDw0KSsxNF09KGI8PDh8Yj4+PjI0KSYxNjcxMTkzNXwoYjw8MjR8Yj4+PjgpJjQyNzgyNTUzNjA7YS5zaWdCeXRlcz00KihrLmxlbmd0aCsxKTt0aGlzLl9wcm9jZXNzKCk7YT10aGlzLl9oYXNoO2s9YS53b3Jkcztmb3IoYj0wOzQ+YjtiKyspaD1rW2JdLGtbYl09KGg8PDh8aD4+PjI0KSYxNjcxMTkzNXwoaDw8MjR8aD4+PjgpJjQyNzgyNTUzNjA7cmV0dXJuIGF9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9dC5jbG9uZS5jYWxsKHRoaXMpO2EuX2hhc2g9dGhpcy5faGFzaC5jbG9uZSgpO3JldHVybiBhfX0pO3IuTUQ1PXQuX2NyZWF0ZUhlbHBlcihxKTtyLkhtYWNNRDU9dC5fY3JlYXRlSG1hY0hlbHBlcihxKX0pKE1hdGgpOwo=',
'/libs/crypto_js/rollups/sha1.js':'LyoKQ3J5cHRvSlMgdjMuMS4yCmNvZGUuZ29vZ2xlLmNvbS9wL2NyeXB0by1qcwooYykgMjAwOS0yMDEzIGJ5IEplZmYgTW90dC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KY29kZS5nb29nbGUuY29tL3AvY3J5cHRvLWpzL3dpa2kvTGljZW5zZQoqLwp2YXIgQ3J5cHRvSlM9Q3J5cHRvSlN8fGZ1bmN0aW9uKGUsbSl7dmFyIHA9e30saj1wLmxpYj17fSxsPWZ1bmN0aW9uKCl7fSxmPWouQmFzZT17ZXh0ZW5kOmZ1bmN0aW9uKGEpe2wucHJvdG90eXBlPXRoaXM7dmFyIGM9bmV3IGw7YSYmYy5taXhJbihhKTtjLmhhc093blByb3BlcnR5KCJpbml0Iil8fChjLmluaXQ9ZnVuY3Rpb24oKXtjLiRzdXBlci5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pO2MuaW5pdC5wcm90b3R5cGU9YztjLiRzdXBlcj10aGlzO3JldHVybiBjfSxjcmVhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmV4dGVuZCgpO2EuaW5pdC5hcHBseShhLGFyZ3VtZW50cyk7cmV0dXJuIGF9LGluaXQ6ZnVuY3Rpb24oKXt9LG1peEluOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYyBpbiBhKWEuaGFzT3duUHJvcGVydHkoYykmJih0aGlzW2NdPWFbY10pO2EuaGFzT3duUHJvcGVydHkoInRvU3RyaW5nIikmJih0aGlzLnRvU3RyaW5nPWEudG9TdHJpbmcpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmluaXQucHJvdG90eXBlLmV4dGVuZCh0aGlzKX19LApuPWouV29yZEFycmF5PWYuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGEsYyl7YT10aGlzLndvcmRzPWF8fFtdO3RoaXMuc2lnQnl0ZXM9YyE9bT9jOjQqYS5sZW5ndGh9LHRvU3RyaW5nOmZ1bmN0aW9uKGEpe3JldHVybihhfHxoKS5zdHJpbmdpZnkodGhpcyl9LGNvbmNhdDpmdW5jdGlvbihhKXt2YXIgYz10aGlzLndvcmRzLHE9YS53b3JkcyxkPXRoaXMuc2lnQnl0ZXM7YT1hLnNpZ0J5dGVzO3RoaXMuY2xhbXAoKTtpZihkJTQpZm9yKHZhciBiPTA7YjxhO2IrKyljW2QrYj4+PjJdfD0ocVtiPj4+Ml0+Pj4yNC04KihiJTQpJjI1NSk8PDI0LTgqKChkK2IpJTQpO2Vsc2UgaWYoNjU1MzU8cS5sZW5ndGgpZm9yKGI9MDtiPGE7Yis9NCljW2QrYj4+PjJdPXFbYj4+PjJdO2Vsc2UgYy5wdXNoLmFwcGx5KGMscSk7dGhpcy5zaWdCeXRlcys9YTtyZXR1cm4gdGhpc30sY2xhbXA6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLndvcmRzLGM9dGhpcy5zaWdCeXRlczthW2M+Pj4yXSY9NDI5NDk2NzI5NTw8CjMyLTgqKGMlNCk7YS5sZW5ndGg9ZS5jZWlsKGMvNCl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9Zi5jbG9uZS5jYWxsKHRoaXMpO2Eud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKTtyZXR1cm4gYX0scmFuZG9tOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYz1bXSxiPTA7YjxhO2IrPTQpYy5wdXNoKDQyOTQ5NjcyOTYqZS5yYW5kb20oKXwwKTtyZXR1cm4gbmV3IG4uaW5pdChjLGEpfX0pLGI9cC5lbmM9e30saD1iLkhleD17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBjPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgYj1bXSxkPTA7ZDxhO2QrKyl7dmFyIGY9Y1tkPj4+Ml0+Pj4yNC04KihkJTQpJjI1NTtiLnB1c2goKGY+Pj40KS50b1N0cmluZygxNikpO2IucHVzaCgoZiYxNSkudG9TdHJpbmcoMTYpKX1yZXR1cm4gYi5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24oYSl7Zm9yKHZhciBjPWEubGVuZ3RoLGI9W10sZD0wO2Q8YztkKz0yKWJbZD4+PjNdfD1wYXJzZUludChhLnN1YnN0cihkLAoyKSwxNik8PDI0LTQqKGQlOCk7cmV0dXJuIG5ldyBuLmluaXQoYixjLzIpfX0sZz1iLkxhdGluMT17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBjPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgYj1bXSxkPTA7ZDxhO2QrKyliLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjW2Q+Pj4yXT4+PjI0LTgqKGQlNCkmMjU1KSk7cmV0dXJuIGIuam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYz1hLmxlbmd0aCxiPVtdLGQ9MDtkPGM7ZCsrKWJbZD4+PjJdfD0oYS5jaGFyQ29kZUF0KGQpJjI1NSk8PDI0LTgqKGQlNCk7cmV0dXJuIG5ldyBuLmluaXQoYixjKX19LHI9Yi5VdGY4PXtzdHJpbmdpZnk6ZnVuY3Rpb24oYSl7dHJ5e3JldHVybiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKGcuc3RyaW5naWZ5KGEpKSl9Y2F0Y2goYyl7dGhyb3cgRXJyb3IoIk1hbGZvcm1lZCBVVEYtOCBkYXRhIik7fX0scGFyc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIGcucGFyc2UodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGEpKSl9fSwKaz1qLkJ1ZmZlcmVkQmxvY2tBbGdvcml0aG09Zi5leHRlbmQoe3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fZGF0YT1uZXcgbi5pbml0O3RoaXMuX25EYXRhQnl0ZXM9MH0sX2FwcGVuZDpmdW5jdGlvbihhKXsic3RyaW5nIj09dHlwZW9mIGEmJihhPXIucGFyc2UoYSkpO3RoaXMuX2RhdGEuY29uY2F0KGEpO3RoaXMuX25EYXRhQnl0ZXMrPWEuc2lnQnl0ZXN9LF9wcm9jZXNzOmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXMuX2RhdGEsYj1jLndvcmRzLGQ9Yy5zaWdCeXRlcyxmPXRoaXMuYmxvY2tTaXplLGg9ZC8oNCpmKSxoPWE/ZS5jZWlsKGgpOmUubWF4KChofDApLXRoaXMuX21pbkJ1ZmZlclNpemUsMCk7YT1oKmY7ZD1lLm1pbig0KmEsZCk7aWYoYSl7Zm9yKHZhciBnPTA7ZzxhO2crPWYpdGhpcy5fZG9Qcm9jZXNzQmxvY2soYixnKTtnPWIuc3BsaWNlKDAsYSk7Yy5zaWdCeXRlcy09ZH1yZXR1cm4gbmV3IG4uaW5pdChnLGQpfSxjbG9uZTpmdW5jdGlvbigpe3ZhciBhPWYuY2xvbmUuY2FsbCh0aGlzKTsKYS5fZGF0YT10aGlzLl9kYXRhLmNsb25lKCk7cmV0dXJuIGF9LF9taW5CdWZmZXJTaXplOjB9KTtqLkhhc2hlcj1rLmV4dGVuZCh7Y2ZnOmYuZXh0ZW5kKCksaW5pdDpmdW5jdGlvbihhKXt0aGlzLmNmZz10aGlzLmNmZy5leHRlbmQoYSk7dGhpcy5yZXNldCgpfSxyZXNldDpmdW5jdGlvbigpe2sucmVzZXQuY2FsbCh0aGlzKTt0aGlzLl9kb1Jlc2V0KCl9LHVwZGF0ZTpmdW5jdGlvbihhKXt0aGlzLl9hcHBlbmQoYSk7dGhpcy5fcHJvY2VzcygpO3JldHVybiB0aGlzfSxmaW5hbGl6ZTpmdW5jdGlvbihhKXthJiZ0aGlzLl9hcHBlbmQoYSk7cmV0dXJuIHRoaXMuX2RvRmluYWxpemUoKX0sYmxvY2tTaXplOjE2LF9jcmVhdGVIZWxwZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGMsYil7cmV0dXJuKG5ldyBhLmluaXQoYikpLmZpbmFsaXplKGMpfX0sX2NyZWF0ZUhtYWNIZWxwZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGIsZil7cmV0dXJuKG5ldyBzLkhNQUMuaW5pdChhLApmKSkuZmluYWxpemUoYil9fX0pO3ZhciBzPXAuYWxnbz17fTtyZXR1cm4gcH0oTWF0aCk7CihmdW5jdGlvbigpe3ZhciBlPUNyeXB0b0pTLG09ZS5saWIscD1tLldvcmRBcnJheSxqPW0uSGFzaGVyLGw9W10sbT1lLmFsZ28uU0hBMT1qLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9oYXNoPW5ldyBwLmluaXQoWzE3MzI1ODQxOTMsNDAyMzIzMzQxNywyNTYyMzgzMTAyLDI3MTczMzg3OCwzMjg1Mzc3NTIwXSl9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbihmLG4pe2Zvcih2YXIgYj10aGlzLl9oYXNoLndvcmRzLGg9YlswXSxnPWJbMV0sZT1iWzJdLGs9YlszXSxqPWJbNF0sYT0wOzgwPmE7YSsrKXtpZigxNj5hKWxbYV09ZltuK2FdfDA7ZWxzZXt2YXIgYz1sW2EtM11ebFthLThdXmxbYS0xNF1ebFthLTE2XTtsW2FdPWM8PDF8Yz4+PjMxfWM9KGg8PDV8aD4+PjI3KStqK2xbYV07Yz0yMD5hP2MrKChnJmV8fmcmaykrMTUxODUwMDI0OSk6NDA+YT9jKygoZ15lXmspKzE4NTk3NzUzOTMpOjYwPmE/YysoKGcmZXxnJmt8ZSZrKS0xODk0MDA3NTg4KTpjKygoZ15lXgprKS04OTk0OTc1MTQpO2o9aztrPWU7ZT1nPDwzMHxnPj4+MjtnPWg7aD1jfWJbMF09YlswXStofDA7YlsxXT1iWzFdK2d8MDtiWzJdPWJbMl0rZXwwO2JbM109YlszXStrfDA7Yls0XT1iWzRdK2p8MH0sX2RvRmluYWxpemU6ZnVuY3Rpb24oKXt2YXIgZj10aGlzLl9kYXRhLGU9Zi53b3JkcyxiPTgqdGhpcy5fbkRhdGFCeXRlcyxoPTgqZi5zaWdCeXRlcztlW2g+Pj41XXw9MTI4PDwyNC1oJTMyO2VbKGgrNjQ+Pj45PDw0KSsxNF09TWF0aC5mbG9vcihiLzQyOTQ5NjcyOTYpO2VbKGgrNjQ+Pj45PDw0KSsxNV09YjtmLnNpZ0J5dGVzPTQqZS5sZW5ndGg7dGhpcy5fcHJvY2VzcygpO3JldHVybiB0aGlzLl9oYXNofSxjbG9uZTpmdW5jdGlvbigpe3ZhciBlPWouY2xvbmUuY2FsbCh0aGlzKTtlLl9oYXNoPXRoaXMuX2hhc2guY2xvbmUoKTtyZXR1cm4gZX19KTtlLlNIQTE9ai5fY3JlYXRlSGVscGVyKG0pO2UuSG1hY1NIQTE9ai5fY3JlYXRlSG1hY0hlbHBlcihtKX0pKCk7Cg==',
'/libs/crypto_js/rollups/sha224.js':'LyoKQ3J5cHRvSlMgdjMuMS4yCmNvZGUuZ29vZ2xlLmNvbS9wL2NyeXB0by1qcwooYykgMjAwOS0yMDEzIGJ5IEplZmYgTW90dC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KY29kZS5nb29nbGUuY29tL3AvY3J5cHRvLWpzL3dpa2kvTGljZW5zZQoqLwp2YXIgQ3J5cHRvSlM9Q3J5cHRvSlN8fGZ1bmN0aW9uKGcsbCl7dmFyIGY9e30saz1mLmxpYj17fSxoPWZ1bmN0aW9uKCl7fSxtPWsuQmFzZT17ZXh0ZW5kOmZ1bmN0aW9uKGEpe2gucHJvdG90eXBlPXRoaXM7dmFyIGM9bmV3IGg7YSYmYy5taXhJbihhKTtjLmhhc093blByb3BlcnR5KCJpbml0Iil8fChjLmluaXQ9ZnVuY3Rpb24oKXtjLiRzdXBlci5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pO2MuaW5pdC5wcm90b3R5cGU9YztjLiRzdXBlcj10aGlzO3JldHVybiBjfSxjcmVhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmV4dGVuZCgpO2EuaW5pdC5hcHBseShhLGFyZ3VtZW50cyk7cmV0dXJuIGF9LGluaXQ6ZnVuY3Rpb24oKXt9LG1peEluOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYyBpbiBhKWEuaGFzT3duUHJvcGVydHkoYykmJih0aGlzW2NdPWFbY10pO2EuaGFzT3duUHJvcGVydHkoInRvU3RyaW5nIikmJih0aGlzLnRvU3RyaW5nPWEudG9TdHJpbmcpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmluaXQucHJvdG90eXBlLmV4dGVuZCh0aGlzKX19LApxPWsuV29yZEFycmF5PW0uZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGEsYyl7YT10aGlzLndvcmRzPWF8fFtdO3RoaXMuc2lnQnl0ZXM9YyE9bD9jOjQqYS5sZW5ndGh9LHRvU3RyaW5nOmZ1bmN0aW9uKGEpe3JldHVybihhfHxzKS5zdHJpbmdpZnkodGhpcyl9LGNvbmNhdDpmdW5jdGlvbihhKXt2YXIgYz10aGlzLndvcmRzLGQ9YS53b3JkcyxiPXRoaXMuc2lnQnl0ZXM7YT1hLnNpZ0J5dGVzO3RoaXMuY2xhbXAoKTtpZihiJTQpZm9yKHZhciBlPTA7ZTxhO2UrKyljW2IrZT4+PjJdfD0oZFtlPj4+Ml0+Pj4yNC04KihlJTQpJjI1NSk8PDI0LTgqKChiK2UpJTQpO2Vsc2UgaWYoNjU1MzU8ZC5sZW5ndGgpZm9yKGU9MDtlPGE7ZSs9NCljW2IrZT4+PjJdPWRbZT4+PjJdO2Vsc2UgYy5wdXNoLmFwcGx5KGMsZCk7dGhpcy5zaWdCeXRlcys9YTtyZXR1cm4gdGhpc30sY2xhbXA6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLndvcmRzLGM9dGhpcy5zaWdCeXRlczthW2M+Pj4yXSY9NDI5NDk2NzI5NTw8CjMyLTgqKGMlNCk7YS5sZW5ndGg9Zy5jZWlsKGMvNCl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9bS5jbG9uZS5jYWxsKHRoaXMpO2Eud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKTtyZXR1cm4gYX0scmFuZG9tOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYz1bXSxkPTA7ZDxhO2QrPTQpYy5wdXNoKDQyOTQ5NjcyOTYqZy5yYW5kb20oKXwwKTtyZXR1cm4gbmV3IHEuaW5pdChjLGEpfX0pLHQ9Zi5lbmM9e30scz10LkhleD17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBjPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgZD1bXSxiPTA7YjxhO2IrKyl7dmFyIGU9Y1tiPj4+Ml0+Pj4yNC04KihiJTQpJjI1NTtkLnB1c2goKGU+Pj40KS50b1N0cmluZygxNikpO2QucHVzaCgoZSYxNSkudG9TdHJpbmcoMTYpKX1yZXR1cm4gZC5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24oYSl7Zm9yKHZhciBjPWEubGVuZ3RoLGQ9W10sYj0wO2I8YztiKz0yKWRbYj4+PjNdfD1wYXJzZUludChhLnN1YnN0cihiLAoyKSwxNik8PDI0LTQqKGIlOCk7cmV0dXJuIG5ldyBxLmluaXQoZCxjLzIpfX0sbj10LkxhdGluMT17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBjPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgZD1bXSxiPTA7YjxhO2IrKylkLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjW2I+Pj4yXT4+PjI0LTgqKGIlNCkmMjU1KSk7cmV0dXJuIGQuam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYz1hLmxlbmd0aCxkPVtdLGI9MDtiPGM7YisrKWRbYj4+PjJdfD0oYS5jaGFyQ29kZUF0KGIpJjI1NSk8PDI0LTgqKGIlNCk7cmV0dXJuIG5ldyBxLmluaXQoZCxjKX19LGo9dC5VdGY4PXtzdHJpbmdpZnk6ZnVuY3Rpb24oYSl7dHJ5e3JldHVybiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKG4uc3RyaW5naWZ5KGEpKSl9Y2F0Y2goYyl7dGhyb3cgRXJyb3IoIk1hbGZvcm1lZCBVVEYtOCBkYXRhIik7fX0scGFyc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIG4ucGFyc2UodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGEpKSl9fSwKdz1rLkJ1ZmZlcmVkQmxvY2tBbGdvcml0aG09bS5leHRlbmQoe3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fZGF0YT1uZXcgcS5pbml0O3RoaXMuX25EYXRhQnl0ZXM9MH0sX2FwcGVuZDpmdW5jdGlvbihhKXsic3RyaW5nIj09dHlwZW9mIGEmJihhPWoucGFyc2UoYSkpO3RoaXMuX2RhdGEuY29uY2F0KGEpO3RoaXMuX25EYXRhQnl0ZXMrPWEuc2lnQnl0ZXN9LF9wcm9jZXNzOmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXMuX2RhdGEsZD1jLndvcmRzLGI9Yy5zaWdCeXRlcyxlPXRoaXMuYmxvY2tTaXplLGY9Yi8oNCplKSxmPWE/Zy5jZWlsKGYpOmcubWF4KChmfDApLXRoaXMuX21pbkJ1ZmZlclNpemUsMCk7YT1mKmU7Yj1nLm1pbig0KmEsYik7aWYoYSl7Zm9yKHZhciB1PTA7dTxhO3UrPWUpdGhpcy5fZG9Qcm9jZXNzQmxvY2soZCx1KTt1PWQuc3BsaWNlKDAsYSk7Yy5zaWdCeXRlcy09Yn1yZXR1cm4gbmV3IHEuaW5pdCh1LGIpfSxjbG9uZTpmdW5jdGlvbigpe3ZhciBhPW0uY2xvbmUuY2FsbCh0aGlzKTsKYS5fZGF0YT10aGlzLl9kYXRhLmNsb25lKCk7cmV0dXJuIGF9LF9taW5CdWZmZXJTaXplOjB9KTtrLkhhc2hlcj13LmV4dGVuZCh7Y2ZnOm0uZXh0ZW5kKCksaW5pdDpmdW5jdGlvbihhKXt0aGlzLmNmZz10aGlzLmNmZy5leHRlbmQoYSk7dGhpcy5yZXNldCgpfSxyZXNldDpmdW5jdGlvbigpe3cucmVzZXQuY2FsbCh0aGlzKTt0aGlzLl9kb1Jlc2V0KCl9LHVwZGF0ZTpmdW5jdGlvbihhKXt0aGlzLl9hcHBlbmQoYSk7dGhpcy5fcHJvY2VzcygpO3JldHVybiB0aGlzfSxmaW5hbGl6ZTpmdW5jdGlvbihhKXthJiZ0aGlzLl9hcHBlbmQoYSk7cmV0dXJuIHRoaXMuX2RvRmluYWxpemUoKX0sYmxvY2tTaXplOjE2LF9jcmVhdGVIZWxwZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGMsZCl7cmV0dXJuKG5ldyBhLmluaXQoZCkpLmZpbmFsaXplKGMpfX0sX2NyZWF0ZUhtYWNIZWxwZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGMsZCl7cmV0dXJuKG5ldyB2LkhNQUMuaW5pdChhLApkKSkuZmluYWxpemUoYyl9fX0pO3ZhciB2PWYuYWxnbz17fTtyZXR1cm4gZn0oTWF0aCk7CihmdW5jdGlvbihnKXtmb3IodmFyIGw9Q3J5cHRvSlMsZj1sLmxpYixrPWYuV29yZEFycmF5LGg9Zi5IYXNoZXIsZj1sLmFsZ28sbT1bXSxxPVtdLHQ9ZnVuY3Rpb24oYSl7cmV0dXJuIDQyOTQ5NjcyOTYqKGEtKGF8MCkpfDB9LHM9MixuPTA7NjQ+bjspe3ZhciBqO2E6e2o9cztmb3IodmFyIHc9Zy5zcXJ0KGopLHY9Mjt2PD13O3YrKylpZighKGoldikpe2o9ITE7YnJlYWsgYX1qPSEwfWomJig4Pm4mJihtW25dPXQoZy5wb3cocywwLjUpKSkscVtuXT10KGcucG93KHMsMS8zKSksbisrKTtzKyt9dmFyIGE9W10sZj1mLlNIQTI1Nj1oLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9oYXNoPW5ldyBrLmluaXQobS5zbGljZSgwKSl9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbihjLGQpe2Zvcih2YXIgYj10aGlzLl9oYXNoLndvcmRzLGU9YlswXSxmPWJbMV0sZz1iWzJdLGs9YlszXSxoPWJbNF0sbD1iWzVdLG09Yls2XSxuPWJbN10scD0wOzY0PnA7cCsrKXtpZigxNj5wKWFbcF09CmNbZCtwXXwwO2Vsc2V7dmFyIGo9YVtwLTE1XSxyPWFbcC0yXTthW3BdPSgoajw8MjV8aj4+PjcpXihqPDwxNHxqPj4+MTgpXmo+Pj4zKSthW3AtN10rKChyPDwxNXxyPj4+MTcpXihyPDwxM3xyPj4+MTkpXnI+Pj4xMCkrYVtwLTE2XX1qPW4rKChoPDwyNnxoPj4+NileKGg8PDIxfGg+Pj4xMSleKGg8PDd8aD4+PjI1KSkrKGgmbF5+aCZtKStxW3BdK2FbcF07cj0oKGU8PDMwfGU+Pj4yKV4oZTw8MTl8ZT4+PjEzKV4oZTw8MTB8ZT4+PjIyKSkrKGUmZl5lJmdeZiZnKTtuPW07bT1sO2w9aDtoPWsranwwO2s9ZztnPWY7Zj1lO2U9aityfDB9YlswXT1iWzBdK2V8MDtiWzFdPWJbMV0rZnwwO2JbMl09YlsyXStnfDA7YlszXT1iWzNdK2t8MDtiWzRdPWJbNF0raHwwO2JbNV09Yls1XStsfDA7Yls2XT1iWzZdK218MDtiWzddPWJbN10rbnwwfSxfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMuX2RhdGEsZD1hLndvcmRzLGI9OCp0aGlzLl9uRGF0YUJ5dGVzLGU9OCphLnNpZ0J5dGVzOwpkW2U+Pj41XXw9MTI4PDwyNC1lJTMyO2RbKGUrNjQ+Pj45PDw0KSsxNF09Zy5mbG9vcihiLzQyOTQ5NjcyOTYpO2RbKGUrNjQ+Pj45PDw0KSsxNV09YjthLnNpZ0J5dGVzPTQqZC5sZW5ndGg7dGhpcy5fcHJvY2VzcygpO3JldHVybiB0aGlzLl9oYXNofSxjbG9uZTpmdW5jdGlvbigpe3ZhciBhPWguY2xvbmUuY2FsbCh0aGlzKTthLl9oYXNoPXRoaXMuX2hhc2guY2xvbmUoKTtyZXR1cm4gYX19KTtsLlNIQTI1Nj1oLl9jcmVhdGVIZWxwZXIoZik7bC5IbWFjU0hBMjU2PWguX2NyZWF0ZUhtYWNIZWxwZXIoZil9KShNYXRoKTsKKGZ1bmN0aW9uKCl7dmFyIGc9Q3J5cHRvSlMsbD1nLmxpYi5Xb3JkQXJyYXksZj1nLmFsZ28saz1mLlNIQTI1NixmPWYuU0hBMjI0PWsuZXh0ZW5kKHtfZG9SZXNldDpmdW5jdGlvbigpe3RoaXMuX2hhc2g9bmV3IGwuaW5pdChbMzIzODM3MTAzMiw5MTQxNTA2NjMsODEyNzAyOTk5LDQxNDQ5MTI2OTcsNDI5MDc3NTg1NywxNzUwNjAzMDI1LDE2OTQwNzY4MzksMzIwNDA3NTQyOF0pfSxfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3ZhciBmPWsuX2RvRmluYWxpemUuY2FsbCh0aGlzKTtmLnNpZ0J5dGVzLT00O3JldHVybiBmfX0pO2cuU0hBMjI0PWsuX2NyZWF0ZUhlbHBlcihmKTtnLkhtYWNTSEEyMjQ9ay5fY3JlYXRlSG1hY0hlbHBlcihmKX0pKCk7Cg==',
'/libs/crypto_js/rollups/sha3.js':'LyoKQ3J5cHRvSlMgdjMuMS4yCmNvZGUuZ29vZ2xlLmNvbS9wL2NyeXB0by1qcwooYykgMjAwOS0yMDEzIGJ5IEplZmYgTW90dC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KY29kZS5nb29nbGUuY29tL3AvY3J5cHRvLWpzL3dpa2kvTGljZW5zZQoqLwp2YXIgQ3J5cHRvSlM9Q3J5cHRvSlN8fGZ1bmN0aW9uKHYscCl7dmFyIGQ9e30sdT1kLmxpYj17fSxyPWZ1bmN0aW9uKCl7fSxmPXUuQmFzZT17ZXh0ZW5kOmZ1bmN0aW9uKGEpe3IucHJvdG90eXBlPXRoaXM7dmFyIGI9bmV3IHI7YSYmYi5taXhJbihhKTtiLmhhc093blByb3BlcnR5KCJpbml0Iil8fChiLmluaXQ9ZnVuY3Rpb24oKXtiLiRzdXBlci5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pO2IuaW5pdC5wcm90b3R5cGU9YjtiLiRzdXBlcj10aGlzO3JldHVybiBifSxjcmVhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmV4dGVuZCgpO2EuaW5pdC5hcHBseShhLGFyZ3VtZW50cyk7cmV0dXJuIGF9LGluaXQ6ZnVuY3Rpb24oKXt9LG1peEluOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYiBpbiBhKWEuaGFzT3duUHJvcGVydHkoYikmJih0aGlzW2JdPWFbYl0pO2EuaGFzT3duUHJvcGVydHkoInRvU3RyaW5nIikmJih0aGlzLnRvU3RyaW5nPWEudG9TdHJpbmcpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmluaXQucHJvdG90eXBlLmV4dGVuZCh0aGlzKX19LApzPXUuV29yZEFycmF5PWYuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGEsYil7YT10aGlzLndvcmRzPWF8fFtdO3RoaXMuc2lnQnl0ZXM9YiE9cD9iOjQqYS5sZW5ndGh9LHRvU3RyaW5nOmZ1bmN0aW9uKGEpe3JldHVybihhfHx5KS5zdHJpbmdpZnkodGhpcyl9LGNvbmNhdDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLndvcmRzLGM9YS53b3JkcyxqPXRoaXMuc2lnQnl0ZXM7YT1hLnNpZ0J5dGVzO3RoaXMuY2xhbXAoKTtpZihqJTQpZm9yKHZhciBuPTA7bjxhO24rKyliW2orbj4+PjJdfD0oY1tuPj4+Ml0+Pj4yNC04KihuJTQpJjI1NSk8PDI0LTgqKChqK24pJTQpO2Vsc2UgaWYoNjU1MzU8Yy5sZW5ndGgpZm9yKG49MDtuPGE7bis9NCliW2orbj4+PjJdPWNbbj4+PjJdO2Vsc2UgYi5wdXNoLmFwcGx5KGIsYyk7dGhpcy5zaWdCeXRlcys9YTtyZXR1cm4gdGhpc30sY2xhbXA6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLndvcmRzLGI9dGhpcy5zaWdCeXRlczthW2I+Pj4yXSY9NDI5NDk2NzI5NTw8CjMyLTgqKGIlNCk7YS5sZW5ndGg9di5jZWlsKGIvNCl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9Zi5jbG9uZS5jYWxsKHRoaXMpO2Eud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKTtyZXR1cm4gYX0scmFuZG9tOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1bXSxjPTA7YzxhO2MrPTQpYi5wdXNoKDQyOTQ5NjcyOTYqdi5yYW5kb20oKXwwKTtyZXR1cm4gbmV3IHMuaW5pdChiLGEpfX0pLHg9ZC5lbmM9e30seT14LkhleD17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBiPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgYz1bXSxqPTA7ajxhO2orKyl7dmFyIG49YltqPj4+Ml0+Pj4yNC04KihqJTQpJjI1NTtjLnB1c2goKG4+Pj40KS50b1N0cmluZygxNikpO2MucHVzaCgobiYxNSkudG9TdHJpbmcoMTYpKX1yZXR1cm4gYy5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPWEubGVuZ3RoLGM9W10saj0wO2o8YjtqKz0yKWNbaj4+PjNdfD1wYXJzZUludChhLnN1YnN0cihqLAoyKSwxNik8PDI0LTQqKGolOCk7cmV0dXJuIG5ldyBzLmluaXQoYyxiLzIpfX0sZT14LkxhdGluMT17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBiPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgYz1bXSxqPTA7ajxhO2orKyljLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShiW2o+Pj4yXT4+PjI0LTgqKGolNCkmMjU1KSk7cmV0dXJuIGMuam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1hLmxlbmd0aCxjPVtdLGo9MDtqPGI7aisrKWNbaj4+PjJdfD0oYS5jaGFyQ29kZUF0KGopJjI1NSk8PDI0LTgqKGolNCk7cmV0dXJuIG5ldyBzLmluaXQoYyxiKX19LHE9eC5VdGY4PXtzdHJpbmdpZnk6ZnVuY3Rpb24oYSl7dHJ5e3JldHVybiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKGUuc3RyaW5naWZ5KGEpKSl9Y2F0Y2goYil7dGhyb3cgRXJyb3IoIk1hbGZvcm1lZCBVVEYtOCBkYXRhIik7fX0scGFyc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIGUucGFyc2UodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGEpKSl9fSwKdD11LkJ1ZmZlcmVkQmxvY2tBbGdvcml0aG09Zi5leHRlbmQoe3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fZGF0YT1uZXcgcy5pbml0O3RoaXMuX25EYXRhQnl0ZXM9MH0sX2FwcGVuZDpmdW5jdGlvbihhKXsic3RyaW5nIj09dHlwZW9mIGEmJihhPXEucGFyc2UoYSkpO3RoaXMuX2RhdGEuY29uY2F0KGEpO3RoaXMuX25EYXRhQnl0ZXMrPWEuc2lnQnl0ZXN9LF9wcm9jZXNzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuX2RhdGEsYz1iLndvcmRzLGo9Yi5zaWdCeXRlcyxuPXRoaXMuYmxvY2tTaXplLGU9ai8oNCpuKSxlPWE/di5jZWlsKGUpOnYubWF4KChlfDApLXRoaXMuX21pbkJ1ZmZlclNpemUsMCk7YT1lKm47aj12Lm1pbig0KmEsaik7aWYoYSl7Zm9yKHZhciBmPTA7ZjxhO2YrPW4pdGhpcy5fZG9Qcm9jZXNzQmxvY2soYyxmKTtmPWMuc3BsaWNlKDAsYSk7Yi5zaWdCeXRlcy09an1yZXR1cm4gbmV3IHMuaW5pdChmLGopfSxjbG9uZTpmdW5jdGlvbigpe3ZhciBhPWYuY2xvbmUuY2FsbCh0aGlzKTsKYS5fZGF0YT10aGlzLl9kYXRhLmNsb25lKCk7cmV0dXJuIGF9LF9taW5CdWZmZXJTaXplOjB9KTt1Lkhhc2hlcj10LmV4dGVuZCh7Y2ZnOmYuZXh0ZW5kKCksaW5pdDpmdW5jdGlvbihhKXt0aGlzLmNmZz10aGlzLmNmZy5leHRlbmQoYSk7dGhpcy5yZXNldCgpfSxyZXNldDpmdW5jdGlvbigpe3QucmVzZXQuY2FsbCh0aGlzKTt0aGlzLl9kb1Jlc2V0KCl9LHVwZGF0ZTpmdW5jdGlvbihhKXt0aGlzLl9hcHBlbmQoYSk7dGhpcy5fcHJvY2VzcygpO3JldHVybiB0aGlzfSxmaW5hbGl6ZTpmdW5jdGlvbihhKXthJiZ0aGlzLl9hcHBlbmQoYSk7cmV0dXJuIHRoaXMuX2RvRmluYWxpemUoKX0sYmxvY2tTaXplOjE2LF9jcmVhdGVIZWxwZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGIsYyl7cmV0dXJuKG5ldyBhLmluaXQoYykpLmZpbmFsaXplKGIpfX0sX2NyZWF0ZUhtYWNIZWxwZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGIsYyl7cmV0dXJuKG5ldyB3LkhNQUMuaW5pdChhLApjKSkuZmluYWxpemUoYil9fX0pO3ZhciB3PWQuYWxnbz17fTtyZXR1cm4gZH0oTWF0aCk7CihmdW5jdGlvbih2KXt2YXIgcD1DcnlwdG9KUyxkPXAubGliLHU9ZC5CYXNlLHI9ZC5Xb3JkQXJyYXkscD1wLng2ND17fTtwLldvcmQ9dS5leHRlbmQoe2luaXQ6ZnVuY3Rpb24oZixzKXt0aGlzLmhpZ2g9Zjt0aGlzLmxvdz1zfX0pO3AuV29yZEFycmF5PXUuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGYscyl7Zj10aGlzLndvcmRzPWZ8fFtdO3RoaXMuc2lnQnl0ZXM9cyE9dj9zOjgqZi5sZW5ndGh9LHRvWDMyOmZ1bmN0aW9uKCl7Zm9yKHZhciBmPXRoaXMud29yZHMscz1mLmxlbmd0aCxkPVtdLHA9MDtwPHM7cCsrKXt2YXIgZT1mW3BdO2QucHVzaChlLmhpZ2gpO2QucHVzaChlLmxvdyl9cmV0dXJuIHIuY3JlYXRlKGQsdGhpcy5zaWdCeXRlcyl9LGNsb25lOmZ1bmN0aW9uKCl7Zm9yKHZhciBmPXUuY2xvbmUuY2FsbCh0aGlzKSxkPWYud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKSxwPWQubGVuZ3RoLHI9MDtyPHA7cisrKWRbcl09ZFtyXS5jbG9uZSgpO3JldHVybiBmfX0pfSkoKTsKKGZ1bmN0aW9uKHYpe2Zvcih2YXIgcD1DcnlwdG9KUyxkPXAubGliLHU9ZC5Xb3JkQXJyYXkscj1kLkhhc2hlcixmPXAueDY0LldvcmQsZD1wLmFsZ28scz1bXSx4PVtdLHk9W10sZT0xLHE9MCx0PTA7MjQ+dDt0Kyspe3NbZSs1KnFdPSh0KzEpKih0KzIpLzIlNjQ7dmFyIHc9KDIqZSszKnEpJTUsZT1xJTUscT13fWZvcihlPTA7NT5lO2UrKylmb3IocT0wOzU+cTtxKyspeFtlKzUqcV09cSs1KigoMiplKzMqcSklNSk7ZT0xO2ZvcihxPTA7MjQ+cTtxKyspe2Zvcih2YXIgYT13PXQ9MDs3PmE7YSsrKXtpZihlJjEpe3ZhciBiPSgxPDxhKS0xOzMyPmI/d149MTw8Yjp0Xj0xPDxiLTMyfWU9ZSYxMjg/ZTw8MV4xMTM6ZTw8MX15W3FdPWYuY3JlYXRlKHQsdyl9Zm9yKHZhciBjPVtdLGU9MDsyNT5lO2UrKyljW2VdPWYuY3JlYXRlKCk7ZD1kLlNIQTM9ci5leHRlbmQoe2NmZzpyLmNmZy5leHRlbmQoe291dHB1dExlbmd0aDo1MTJ9KSxfZG9SZXNldDpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLl9zdGF0ZT0KW10sYj0wOzI1PmI7YisrKWFbYl09bmV3IGYuaW5pdDt0aGlzLmJsb2NrU2l6ZT0oMTYwMC0yKnRoaXMuY2ZnLm91dHB1dExlbmd0aCkvMzJ9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbihhLGIpe2Zvcih2YXIgZT10aGlzLl9zdGF0ZSxmPXRoaXMuYmxvY2tTaXplLzIsaD0wO2g8ZjtoKyspe3ZhciBsPWFbYisyKmhdLG09YVtiKzIqaCsxXSxsPShsPDw4fGw+Pj4yNCkmMTY3MTE5MzV8KGw8PDI0fGw+Pj44KSY0Mjc4MjU1MzYwLG09KG08PDh8bT4+PjI0KSYxNjcxMTkzNXwobTw8MjR8bT4+PjgpJjQyNzgyNTUzNjAsZz1lW2hdO2cuaGlnaF49bTtnLmxvd149bH1mb3IoZj0wOzI0PmY7ZisrKXtmb3IoaD0wOzU+aDtoKyspe2Zvcih2YXIgZD1sPTAsaz0wOzU+aztrKyspZz1lW2grNSprXSxsXj1nLmhpZ2gsZF49Zy5sb3c7Zz1jW2hdO2cuaGlnaD1sO2cubG93PWR9Zm9yKGg9MDs1Pmg7aCsrKXtnPWNbKGgrNCklNV07bD1jWyhoKzEpJTVdO209bC5oaWdoO2s9bC5sb3c7bD1nLmhpZ2heCihtPDwxfGs+Pj4zMSk7ZD1nLmxvd14oazw8MXxtPj4+MzEpO2ZvcihrPTA7NT5rO2srKylnPWVbaCs1KmtdLGcuaGlnaF49bCxnLmxvd149ZH1mb3IobT0xOzI1Pm07bSsrKWc9ZVttXSxoPWcuaGlnaCxnPWcubG93LGs9c1ttXSwzMj5rPyhsPWg8PGt8Zz4+PjMyLWssZD1nPDxrfGg+Pj4zMi1rKToobD1nPDxrLTMyfGg+Pj42NC1rLGQ9aDw8ay0zMnxnPj4+NjQtayksZz1jW3hbbV1dLGcuaGlnaD1sLGcubG93PWQ7Zz1jWzBdO2g9ZVswXTtnLmhpZ2g9aC5oaWdoO2cubG93PWgubG93O2ZvcihoPTA7NT5oO2grKylmb3Ioaz0wOzU+aztrKyspbT1oKzUqayxnPWVbbV0sbD1jW21dLG09Y1soaCsxKSU1KzUqa10sZD1jWyhoKzIpJTUrNSprXSxnLmhpZ2g9bC5oaWdoXn5tLmhpZ2gmZC5oaWdoLGcubG93PWwubG93Xn5tLmxvdyZkLmxvdztnPWVbMF07aD15W2ZdO2cuaGlnaF49aC5oaWdoO2cubG93Xj1oLmxvd319LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5fZGF0YSwKYj1hLndvcmRzLGM9OCphLnNpZ0J5dGVzLGU9MzIqdGhpcy5ibG9ja1NpemU7YltjPj4+NV18PTE8PDI0LWMlMzI7Ylsodi5jZWlsKChjKzEpL2UpKmU+Pj41KS0xXXw9MTI4O2Euc2lnQnl0ZXM9NCpiLmxlbmd0aDt0aGlzLl9wcm9jZXNzKCk7Zm9yKHZhciBhPXRoaXMuX3N0YXRlLGI9dGhpcy5jZmcub3V0cHV0TGVuZ3RoLzgsYz1iLzgsZT1bXSxoPTA7aDxjO2grKyl7dmFyIGQ9YVtoXSxmPWQuaGlnaCxkPWQubG93LGY9KGY8PDh8Zj4+PjI0KSYxNjcxMTkzNXwoZjw8MjR8Zj4+PjgpJjQyNzgyNTUzNjAsZD0oZDw8OHxkPj4+MjQpJjE2NzExOTM1fChkPDwyNHxkPj4+OCkmNDI3ODI1NTM2MDtlLnB1c2goZCk7ZS5wdXNoKGYpfXJldHVybiBuZXcgdS5pbml0KGUsYil9LGNsb25lOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXIuY2xvbmUuY2FsbCh0aGlzKSxiPWEuX3N0YXRlPXRoaXMuX3N0YXRlLnNsaWNlKDApLGM9MDsyNT5jO2MrKyliW2NdPWJbY10uY2xvbmUoKTtyZXR1cm4gYX19KTsKcC5TSEEzPXIuX2NyZWF0ZUhlbHBlcihkKTtwLkhtYWNTSEEzPXIuX2NyZWF0ZUhtYWNIZWxwZXIoZCl9KShNYXRoKTsK',
'/libs/crypto_js/rollups/sha384.js':'LyoKQ3J5cHRvSlMgdjMuMS4yCmNvZGUuZ29vZ2xlLmNvbS9wL2NyeXB0by1qcwooYykgMjAwOS0yMDEzIGJ5IEplZmYgTW90dC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KY29kZS5nb29nbGUuY29tL3AvY3J5cHRvLWpzL3dpa2kvTGljZW5zZQoqLwp2YXIgQ3J5cHRvSlM9Q3J5cHRvSlN8fGZ1bmN0aW9uKGEsYyl7dmFyIGQ9e30saj1kLmxpYj17fSxmPWZ1bmN0aW9uKCl7fSxtPWouQmFzZT17ZXh0ZW5kOmZ1bmN0aW9uKGEpe2YucHJvdG90eXBlPXRoaXM7dmFyIGI9bmV3IGY7YSYmYi5taXhJbihhKTtiLmhhc093blByb3BlcnR5KCJpbml0Iil8fChiLmluaXQ9ZnVuY3Rpb24oKXtiLiRzdXBlci5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pO2IuaW5pdC5wcm90b3R5cGU9YjtiLiRzdXBlcj10aGlzO3JldHVybiBifSxjcmVhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmV4dGVuZCgpO2EuaW5pdC5hcHBseShhLGFyZ3VtZW50cyk7cmV0dXJuIGF9LGluaXQ6ZnVuY3Rpb24oKXt9LG1peEluOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYiBpbiBhKWEuaGFzT3duUHJvcGVydHkoYikmJih0aGlzW2JdPWFbYl0pO2EuaGFzT3duUHJvcGVydHkoInRvU3RyaW5nIikmJih0aGlzLnRvU3RyaW5nPWEudG9TdHJpbmcpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmluaXQucHJvdG90eXBlLmV4dGVuZCh0aGlzKX19LApCPWouV29yZEFycmF5PW0uZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGEsYil7YT10aGlzLndvcmRzPWF8fFtdO3RoaXMuc2lnQnl0ZXM9YiE9Yz9iOjQqYS5sZW5ndGh9LHRvU3RyaW5nOmZ1bmN0aW9uKGEpe3JldHVybihhfHx5KS5zdHJpbmdpZnkodGhpcyl9LGNvbmNhdDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLndvcmRzLGc9YS53b3JkcyxlPXRoaXMuc2lnQnl0ZXM7YT1hLnNpZ0J5dGVzO3RoaXMuY2xhbXAoKTtpZihlJTQpZm9yKHZhciBrPTA7azxhO2srKyliW2Uraz4+PjJdfD0oZ1trPj4+Ml0+Pj4yNC04KihrJTQpJjI1NSk8PDI0LTgqKChlK2spJTQpO2Vsc2UgaWYoNjU1MzU8Zy5sZW5ndGgpZm9yKGs9MDtrPGE7ays9NCliW2Uraz4+PjJdPWdbaz4+PjJdO2Vsc2UgYi5wdXNoLmFwcGx5KGIsZyk7dGhpcy5zaWdCeXRlcys9YTtyZXR1cm4gdGhpc30sY2xhbXA6ZnVuY3Rpb24oKXt2YXIgbj10aGlzLndvcmRzLGI9dGhpcy5zaWdCeXRlcztuW2I+Pj4yXSY9NDI5NDk2NzI5NTw8CjMyLTgqKGIlNCk7bi5sZW5ndGg9YS5jZWlsKGIvNCl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9bS5jbG9uZS5jYWxsKHRoaXMpO2Eud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKTtyZXR1cm4gYX0scmFuZG9tOmZ1bmN0aW9uKG4pe2Zvcih2YXIgYj1bXSxnPTA7ZzxuO2crPTQpYi5wdXNoKDQyOTQ5NjcyOTYqYS5yYW5kb20oKXwwKTtyZXR1cm4gbmV3IEIuaW5pdChiLG4pfX0pLHY9ZC5lbmM9e30seT12LkhleD17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBiPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgZz1bXSxlPTA7ZTxhO2UrKyl7dmFyIGs9YltlPj4+Ml0+Pj4yNC04KihlJTQpJjI1NTtnLnB1c2goKGs+Pj40KS50b1N0cmluZygxNikpO2cucHVzaCgoayYxNSkudG9TdHJpbmcoMTYpKX1yZXR1cm4gZy5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPWEubGVuZ3RoLGc9W10sZT0wO2U8YjtlKz0yKWdbZT4+PjNdfD1wYXJzZUludChhLnN1YnN0cihlLAoyKSwxNik8PDI0LTQqKGUlOCk7cmV0dXJuIG5ldyBCLmluaXQoZyxiLzIpfX0sRj12LkxhdGluMT17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBiPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgZz1bXSxlPTA7ZTxhO2UrKylnLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShiW2U+Pj4yXT4+PjI0LTgqKGUlNCkmMjU1KSk7cmV0dXJuIGcuam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1hLmxlbmd0aCxnPVtdLGU9MDtlPGI7ZSsrKWdbZT4+PjJdfD0oYS5jaGFyQ29kZUF0KGUpJjI1NSk8PDI0LTgqKGUlNCk7cmV0dXJuIG5ldyBCLmluaXQoZyxiKX19LGhhPXYuVXRmOD17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3RyeXtyZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGVzY2FwZShGLnN0cmluZ2lmeShhKSkpfWNhdGNoKGIpe3Rocm93IEVycm9yKCJNYWxmb3JtZWQgVVRGLTggZGF0YSIpO319LHBhcnNlOmZ1bmN0aW9uKGEpe3JldHVybiBGLnBhcnNlKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChhKSkpfX0sClo9ai5CdWZmZXJlZEJsb2NrQWxnb3JpdGhtPW0uZXh0ZW5kKHtyZXNldDpmdW5jdGlvbigpe3RoaXMuX2RhdGE9bmV3IEIuaW5pdDt0aGlzLl9uRGF0YUJ5dGVzPTB9LF9hcHBlbmQ6ZnVuY3Rpb24oYSl7InN0cmluZyI9PXR5cGVvZiBhJiYoYT1oYS5wYXJzZShhKSk7dGhpcy5fZGF0YS5jb25jYXQoYSk7dGhpcy5fbkRhdGFCeXRlcys9YS5zaWdCeXRlc30sX3Byb2Nlc3M6ZnVuY3Rpb24obil7dmFyIGI9dGhpcy5fZGF0YSxnPWIud29yZHMsZT1iLnNpZ0J5dGVzLGs9dGhpcy5ibG9ja1NpemUsbT1lLyg0KmspLG09bj9hLmNlaWwobSk6YS5tYXgoKG18MCktdGhpcy5fbWluQnVmZmVyU2l6ZSwwKTtuPW0qaztlPWEubWluKDQqbixlKTtpZihuKXtmb3IodmFyIGM9MDtjPG47Yys9ayl0aGlzLl9kb1Byb2Nlc3NCbG9jayhnLGMpO2M9Zy5zcGxpY2UoMCxuKTtiLnNpZ0J5dGVzLT1lfXJldHVybiBuZXcgQi5pbml0KGMsZSl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9bS5jbG9uZS5jYWxsKHRoaXMpOwphLl9kYXRhPXRoaXMuX2RhdGEuY2xvbmUoKTtyZXR1cm4gYX0sX21pbkJ1ZmZlclNpemU6MH0pO2ouSGFzaGVyPVouZXh0ZW5kKHtjZmc6bS5leHRlbmQoKSxpbml0OmZ1bmN0aW9uKGEpe3RoaXMuY2ZnPXRoaXMuY2ZnLmV4dGVuZChhKTt0aGlzLnJlc2V0KCl9LHJlc2V0OmZ1bmN0aW9uKCl7Wi5yZXNldC5jYWxsKHRoaXMpO3RoaXMuX2RvUmVzZXQoKX0sdXBkYXRlOmZ1bmN0aW9uKGEpe3RoaXMuX2FwcGVuZChhKTt0aGlzLl9wcm9jZXNzKCk7cmV0dXJuIHRoaXN9LGZpbmFsaXplOmZ1bmN0aW9uKGEpe2EmJnRoaXMuX2FwcGVuZChhKTtyZXR1cm4gdGhpcy5fZG9GaW5hbGl6ZSgpfSxibG9ja1NpemU6MTYsX2NyZWF0ZUhlbHBlcjpmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYixnKXtyZXR1cm4obmV3IGEuaW5pdChnKSkuZmluYWxpemUoYil9fSxfY3JlYXRlSG1hY0hlbHBlcjpmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYixnKXtyZXR1cm4obmV3IGlhLkhNQUMuaW5pdChhLApnKSkuZmluYWxpemUoYil9fX0pO3ZhciBpYT1kLmFsZ289e307cmV0dXJuIGR9KE1hdGgpOwooZnVuY3Rpb24oYSl7dmFyIGM9Q3J5cHRvSlMsZD1jLmxpYixqPWQuQmFzZSxmPWQuV29yZEFycmF5LGM9Yy54NjQ9e307Yy5Xb3JkPWouZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGEsYyl7dGhpcy5oaWdoPWE7dGhpcy5sb3c9Y319KTtjLldvcmRBcnJheT1qLmV4dGVuZCh7aW5pdDpmdW5jdGlvbihjLGQpe2M9dGhpcy53b3Jkcz1jfHxbXTt0aGlzLnNpZ0J5dGVzPWQhPWE/ZDo4KmMubGVuZ3RofSx0b1gzMjpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLndvcmRzLGM9YS5sZW5ndGgsZD1bXSxqPTA7ajxjO2orKyl7dmFyIEY9YVtqXTtkLnB1c2goRi5oaWdoKTtkLnB1c2goRi5sb3cpfXJldHVybiBmLmNyZWF0ZShkLHRoaXMuc2lnQnl0ZXMpfSxjbG9uZTpmdW5jdGlvbigpe2Zvcih2YXIgYT1qLmNsb25lLmNhbGwodGhpcyksYz1hLndvcmRzPXRoaXMud29yZHMuc2xpY2UoMCksZD1jLmxlbmd0aCxmPTA7ZjxkO2YrKyljW2ZdPWNbZl0uY2xvbmUoKTtyZXR1cm4gYX19KX0pKCk7CihmdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXtyZXR1cm4gZi5jcmVhdGUuYXBwbHkoZixhcmd1bWVudHMpfWZvcih2YXIgYz1DcnlwdG9KUyxkPWMubGliLkhhc2hlcixqPWMueDY0LGY9ai5Xb3JkLG09ai5Xb3JkQXJyYXksaj1jLmFsZ28sQj1bYSgxMTE2MzUyNDA4LDM2MDk3Njc0NTgpLGEoMTg5OTQ0NzQ0MSw2MDI4OTE3MjUpLGEoMzA0OTMyMzQ3MSwzOTY0NDg0Mzk5KSxhKDM5MjEwMDk1NzMsMjE3MzI5NTU0OCksYSg5NjE5ODcxNjMsNDA4MTYyODQ3MiksYSgxNTA4OTcwOTkzLDMwNTM4MzQyNjUpLGEoMjQ1MzYzNTc0OCwyOTM3NjcxNTc5KSxhKDI4NzA3NjMyMjEsMzY2NDYwOTU2MCksYSgzNjI0MzgxMDgwLDI3MzQ4ODMzOTQpLGEoMzEwNTk4NDAxLDExNjQ5OTY1NDIpLGEoNjA3MjI1Mjc4LDEzMjM2MTA3NjQpLGEoMTQyNjg4MTk4NywzNTkwMzA0OTk0KSxhKDE5MjUwNzgzODgsNDA2ODE4MjM4MyksYSgyMTYyMDc4MjA2LDk5MTMzNjExMyksYSgyNjE0ODg4MTAzLDYzMzgwMzMxNyksCmEoMzI0ODIyMjU4MCwzNDc5Nzc0ODY4KSxhKDM4MzUzOTA0MDEsMjY2NjYxMzQ1OCksYSg0MDIyMjI0Nzc0LDk0NDcxMTEzOSksYSgyNjQzNDcwNzgsMjM0MTI2Mjc3MyksYSg2MDQ4MDc2MjgsMjAwNzgwMDkzMyksYSg3NzAyNTU5ODMsMTQ5NTk5MDkwMSksYSgxMjQ5MTUwMTIyLDE4NTY0MzEyMzUpLGEoMTU1NTA4MTY5MiwzMTc1MjE4MTMyKSxhKDE5OTYwNjQ5ODYsMjE5ODk1MDgzNyksYSgyNTU0MjIwODgyLDM5OTk3MTkzMzkpLGEoMjgyMTgzNDM0OSw3NjY3ODQwMTYpLGEoMjk1Mjk5NjgwOCwyNTY2NTk0ODc5KSxhKDMyMTAzMTM2NzEsMzIwMzMzNzk1NiksYSgzMzM2NTcxODkxLDEwMzQ0NTcwMjYpLGEoMzU4NDUyODcxMSwyNDY2OTQ4OTAxKSxhKDExMzkyNjk5MywzNzU4MzI2MzgzKSxhKDMzODI0MTg5NSwxNjg3MTc5MzYpLGEoNjY2MzA3MjA1LDExODgxNzk5NjQpLGEoNzczNTI5OTEyLDE1NDYwNDU3MzQpLGEoMTI5NDc1NzM3MiwxNTIyODA1NDg1KSxhKDEzOTYxODIyOTEsCjI2NDM4MzM4MjMpLGEoMTY5NTE4MzcwMCwyMzQzNTI3MzkwKSxhKDE5ODY2NjEwNTEsMTAxNDQ3NzQ4MCksYSgyMTc3MDI2MzUwLDEyMDY3NTkxNDIpLGEoMjQ1Njk1NjAzNywzNDQwNzc2MjcpLGEoMjczMDQ4NTkyMSwxMjkwODYzNDYwKSxhKDI4MjAzMDI0MTEsMzE1ODQ1NDI3MyksYSgzMjU5NzMwODAwLDM1MDU5NTI2NTcpLGEoMzM0NTc2NDc3MSwxMDYyMTcwMDgpLGEoMzUxNjA2NTgxNywzNjA2MDA4MzQ0KSxhKDM2MDAzNTI4MDQsMTQzMjcyNTc3NiksYSg0MDk0NTcxOTA5LDE0NjcwMzE1OTQpLGEoMjc1NDIzMzQ0LDg1MTE2OTcyMCksYSg0MzAyMjc3MzQsMzEwMDgyMzc1MiksYSg1MDY5NDg2MTYsMTM2MzI1ODE5NSksYSg2NTkwNjA1NTYsMzc1MDY4NTU5MyksYSg4ODM5OTc4NzcsMzc4NTA1MDI4MCksYSg5NTgxMzk1NzEsMzMxODMwNzQyNyksYSgxMzIyODIyMjE4LDM4MTI3MjM0MDMpLGEoMTUzNzAwMjA2MywyMDAzMDM0OTk1KSxhKDE3NDc4NzM3NzksMzYwMjAzNjg5OSksCmEoMTk1NTU2MjIyMiwxNTc1OTkwMDEyKSxhKDIwMjQxMDQ4MTUsMTEyNTU5MjkyOCksYSgyMjI3NzMwNDUyLDI3MTY5MDQzMDYpLGEoMjM2MTg1MjQyNCw0NDI3NzYwNDQpLGEoMjQyODQzNjQ3NCw1OTM2OTgzNDQpLGEoMjc1NjczNDE4NywzNzMzMTEwMjQ5KSxhKDMyMDQwMzE0NzksMjk5OTM1MTU3MyksYSgzMzI5MzI1Mjk4LDM4MTU5MjA0MjcpLGEoMzM5MTU2OTYxNCwzOTI4MzgzOTAwKSxhKDM1MTUyNjcyNzEsNTY2MjgwNzExKSxhKDM5NDAxODc2MDYsMzQ1NDA2OTUzNCksYSg0MTE4NjMwMjcxLDQwMDAyMzk5OTIpLGEoMTE2NDE4NDc0LDE5MTQxMzg1NTQpLGEoMTc0MjkyNDIxLDI3MzEwNTUyNzApLGEoMjg5MzgwMzU2LDMyMDM5OTMwMDYpLGEoNDYwMzkzMjY5LDMyMDYyMDMxNSksYSg2ODU0NzE3MzMsNTg3NDk2ODM2KSxhKDg1MjE0Mjk3MSwxMDg2NzkyODUxKSxhKDEwMTcwMzYyOTgsMzY1NTQzMTAwKSxhKDExMjYwMDA1ODAsMjYxODI5NzY3NiksYSgxMjg4MDMzNDcwLAozNDA5ODU1MTU4KSxhKDE1MDE1MDU5NDgsNDIzNDUwOTg2NiksYSgxNjA3MTY3OTE1LDk4NzE2NzQ2OCksYSgxODE2NDAyMzE2LDEyNDYxODk1OTEpXSx2PVtdLHk9MDs4MD55O3krKyl2W3ldPWEoKTtqPWouU0hBNTEyPWQuZXh0ZW5kKHtfZG9SZXNldDpmdW5jdGlvbigpe3RoaXMuX2hhc2g9bmV3IG0uaW5pdChbbmV3IGYuaW5pdCgxNzc5MDMzNzAzLDQwODkyMzU3MjApLG5ldyBmLmluaXQoMzE0NDEzNDI3NywyMjI3ODczNTk1KSxuZXcgZi5pbml0KDEwMTM5MDQyNDIsNDI3MTE3NTcyMyksbmV3IGYuaW5pdCgyNzczNDgwNzYyLDE1OTU3NTAxMjkpLG5ldyBmLmluaXQoMTM1OTg5MzExOSwyOTE3NTY1MTM3KSxuZXcgZi5pbml0KDI2MDA4MjI5MjQsNzI1NTExMTk5KSxuZXcgZi5pbml0KDUyODczNDYzNSw0MjE1Mzg5NTQ3KSxuZXcgZi5pbml0KDE1NDE0NTkyMjUsMzI3MDMzMjA5KV0pfSxfZG9Qcm9jZXNzQmxvY2s6ZnVuY3Rpb24oYSxjKXtmb3IodmFyIGQ9dGhpcy5faGFzaC53b3JkcywKZj1kWzBdLGo9ZFsxXSxiPWRbMl0sZz1kWzNdLGU9ZFs0XSxrPWRbNV0sbT1kWzZdLGQ9ZFs3XSx5PWYuaGlnaCxNPWYubG93LCQ9ai5oaWdoLE49ai5sb3csYWE9Yi5oaWdoLE89Yi5sb3csYmE9Zy5oaWdoLFA9Zy5sb3csY2E9ZS5oaWdoLFE9ZS5sb3csZGE9ay5oaWdoLFI9ay5sb3csZWE9bS5oaWdoLFM9bS5sb3csZmE9ZC5oaWdoLFQ9ZC5sb3cscz15LHA9TSxHPSQsRD1OLEg9YWEsRT1PLFc9YmEsST1QLHQ9Y2EscT1RLFU9ZGEsSj1SLFY9ZWEsSz1TLFg9ZmEsTD1ULHU9MDs4MD51O3UrKyl7dmFyIHo9dlt1XTtpZigxNj51KXZhciByPXouaGlnaD1hW2MrMip1XXwwLGg9ei5sb3c9YVtjKzIqdSsxXXwwO2Vsc2V7dmFyIHI9dlt1LTE1XSxoPXIuaGlnaCx3PXIubG93LHI9KGg+Pj4xfHc8PDMxKV4oaD4+Pjh8dzw8MjQpXmg+Pj43LHc9KHc+Pj4xfGg8PDMxKV4odz4+Pjh8aDw8MjQpXih3Pj4+N3xoPDwyNSksQz12W3UtMl0saD1DLmhpZ2gsbD1DLmxvdyxDPShoPj4+MTl8bDw8CjEzKV4oaDw8M3xsPj4+MjkpXmg+Pj42LGw9KGw+Pj4xOXxoPDwxMyleKGw8PDN8aD4+PjI5KV4obD4+PjZ8aDw8MjYpLGg9dlt1LTddLFk9aC5oaWdoLEE9dlt1LTE2XSx4PUEuaGlnaCxBPUEubG93LGg9dytoLmxvdyxyPXIrWSsoaD4+PjA8dz4+PjA/MTowKSxoPWgrbCxyPXIrQysoaD4+PjA8bD4+PjA/MTowKSxoPWgrQSxyPXIreCsoaD4+PjA8QT4+PjA/MTowKTt6LmhpZ2g9cjt6Lmxvdz1ofXZhciBZPXQmVV5+dCZWLEE9cSZKXn5xJkssej1zJkdecyZIXkcmSCxqYT1wJkRecCZFXkQmRSx3PShzPj4+Mjh8cDw8NCleKHM8PDMwfHA+Pj4yKV4oczw8MjV8cD4+PjcpLEM9KHA+Pj4yOHxzPDw0KV4ocDw8MzB8cz4+PjIpXihwPDwyNXxzPj4+NyksbD1CW3VdLGthPWwuaGlnaCxnYT1sLmxvdyxsPUwrKChxPj4+MTR8dDw8MTgpXihxPj4+MTh8dDw8MTQpXihxPDwyM3x0Pj4+OSkpLHg9WCsoKHQ+Pj4xNHxxPDwxOCleKHQ+Pj4xOHxxPDwxNCleKHQ8PDIzfHE+Pj45KSkrKGw+Pj4wPApMPj4+MD8xOjApLGw9bCtBLHg9eCtZKyhsPj4+MDxBPj4+MD8xOjApLGw9bCtnYSx4PXgra2ErKGw+Pj4wPGdhPj4+MD8xOjApLGw9bCtoLHg9eCtyKyhsPj4+MDxoPj4+MD8xOjApLGg9QytqYSx6PXcreisoaD4+PjA8Qz4+PjA/MTowKSxYPVYsTD1LLFY9VSxLPUosVT10LEo9cSxxPUkrbHwwLHQ9Vyt4KyhxPj4+MDxJPj4+MD8xOjApfDAsVz1ILEk9RSxIPUcsRT1ELEc9cyxEPXAscD1sK2h8MCxzPXgreisocD4+PjA8bD4+PjA/MTowKXwwfU09Zi5sb3c9TStwO2YuaGlnaD15K3MrKE0+Pj4wPHA+Pj4wPzE6MCk7Tj1qLmxvdz1OK0Q7ai5oaWdoPSQrRysoTj4+PjA8RD4+PjA/MTowKTtPPWIubG93PU8rRTtiLmhpZ2g9YWErSCsoTz4+PjA8RT4+PjA/MTowKTtQPWcubG93PVArSTtnLmhpZ2g9YmErVysoUD4+PjA8ST4+PjA/MTowKTtRPWUubG93PVErcTtlLmhpZ2g9Y2ErdCsoUT4+PjA8cT4+PjA/MTowKTtSPWsubG93PVIrSjtrLmhpZ2g9ZGErVSsoUj4+PjA8Sj4+PjA/MTowKTsKUz1tLmxvdz1TK0s7bS5oaWdoPWVhK1YrKFM+Pj4wPEs+Pj4wPzE6MCk7VD1kLmxvdz1UK0w7ZC5oaWdoPWZhK1grKFQ+Pj4wPEw+Pj4wPzE6MCl9LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5fZGF0YSxjPWEud29yZHMsZD04KnRoaXMuX25EYXRhQnl0ZXMsZj04KmEuc2lnQnl0ZXM7Y1tmPj4+NV18PTEyODw8MjQtZiUzMjtjWyhmKzEyOD4+PjEwPDw1KSszMF09TWF0aC5mbG9vcihkLzQyOTQ5NjcyOTYpO2NbKGYrMTI4Pj4+MTA8PDUpKzMxXT1kO2Euc2lnQnl0ZXM9NCpjLmxlbmd0aDt0aGlzLl9wcm9jZXNzKCk7cmV0dXJuIHRoaXMuX2hhc2gudG9YMzIoKX0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgYT1kLmNsb25lLmNhbGwodGhpcyk7YS5faGFzaD10aGlzLl9oYXNoLmNsb25lKCk7cmV0dXJuIGF9LGJsb2NrU2l6ZTozMn0pO2MuU0hBNTEyPWQuX2NyZWF0ZUhlbHBlcihqKTtjLkhtYWNTSEE1MTI9ZC5fY3JlYXRlSG1hY0hlbHBlcihqKX0pKCk7CihmdW5jdGlvbigpe3ZhciBhPUNyeXB0b0pTLGM9YS54NjQsZD1jLldvcmQsaj1jLldvcmRBcnJheSxjPWEuYWxnbyxmPWMuU0hBNTEyLGM9Yy5TSEEzODQ9Zi5leHRlbmQoe19kb1Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5faGFzaD1uZXcgai5pbml0KFtuZXcgZC5pbml0KDM0MTgwNzAzNjUsMzIzODM3MTAzMiksbmV3IGQuaW5pdCgxNjU0MjcwMjUwLDkxNDE1MDY2MyksbmV3IGQuaW5pdCgyNDM4NTI5MzcwLDgxMjcwMjk5OSksbmV3IGQuaW5pdCgzNTU0NjIzNjAsNDE0NDkxMjY5NyksbmV3IGQuaW5pdCgxNzMxNDA1NDE1LDQyOTA3NzU4NTcpLG5ldyBkLmluaXQoMjM5NDE4MDIzMSwxNzUwNjAzMDI1KSxuZXcgZC5pbml0KDM2NzUwMDg1MjUsMTY5NDA3NjgzOSksbmV3IGQuaW5pdCgxMjAzMDYyODEzLDMyMDQwNzU0MjgpXSl9LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIGE9Zi5fZG9GaW5hbGl6ZS5jYWxsKHRoaXMpO2Euc2lnQnl0ZXMtPTE2O3JldHVybiBhfX0pO2EuU0hBMzg0PQpmLl9jcmVhdGVIZWxwZXIoYyk7YS5IbWFjU0hBMzg0PWYuX2NyZWF0ZUhtYWNIZWxwZXIoYyl9KSgpOwo=',
'/libs/crypto_js/rollups/sha512.js':'LyoKQ3J5cHRvSlMgdjMuMS4yCmNvZGUuZ29vZ2xlLmNvbS9wL2NyeXB0by1qcwooYykgMjAwOS0yMDEzIGJ5IEplZmYgTW90dC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KY29kZS5nb29nbGUuY29tL3AvY3J5cHRvLWpzL3dpa2kvTGljZW5zZQoqLwp2YXIgQ3J5cHRvSlM9Q3J5cHRvSlN8fGZ1bmN0aW9uKGEsbSl7dmFyIHI9e30sZj1yLmxpYj17fSxnPWZ1bmN0aW9uKCl7fSxsPWYuQmFzZT17ZXh0ZW5kOmZ1bmN0aW9uKGEpe2cucHJvdG90eXBlPXRoaXM7dmFyIGI9bmV3IGc7YSYmYi5taXhJbihhKTtiLmhhc093blByb3BlcnR5KCJpbml0Iil8fChiLmluaXQ9ZnVuY3Rpb24oKXtiLiRzdXBlci5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pO2IuaW5pdC5wcm90b3R5cGU9YjtiLiRzdXBlcj10aGlzO3JldHVybiBifSxjcmVhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmV4dGVuZCgpO2EuaW5pdC5hcHBseShhLGFyZ3VtZW50cyk7cmV0dXJuIGF9LGluaXQ6ZnVuY3Rpb24oKXt9LG1peEluOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYiBpbiBhKWEuaGFzT3duUHJvcGVydHkoYikmJih0aGlzW2JdPWFbYl0pO2EuaGFzT3duUHJvcGVydHkoInRvU3RyaW5nIikmJih0aGlzLnRvU3RyaW5nPWEudG9TdHJpbmcpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmluaXQucHJvdG90eXBlLmV4dGVuZCh0aGlzKX19LApwPWYuV29yZEFycmF5PWwuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGEsYil7YT10aGlzLndvcmRzPWF8fFtdO3RoaXMuc2lnQnl0ZXM9YiE9bT9iOjQqYS5sZW5ndGh9LHRvU3RyaW5nOmZ1bmN0aW9uKGEpe3JldHVybihhfHxxKS5zdHJpbmdpZnkodGhpcyl9LGNvbmNhdDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLndvcmRzLGQ9YS53b3JkcyxjPXRoaXMuc2lnQnl0ZXM7YT1hLnNpZ0J5dGVzO3RoaXMuY2xhbXAoKTtpZihjJTQpZm9yKHZhciBqPTA7ajxhO2orKyliW2Mraj4+PjJdfD0oZFtqPj4+Ml0+Pj4yNC04KihqJTQpJjI1NSk8PDI0LTgqKChjK2opJTQpO2Vsc2UgaWYoNjU1MzU8ZC5sZW5ndGgpZm9yKGo9MDtqPGE7ais9NCliW2Mraj4+PjJdPWRbaj4+PjJdO2Vsc2UgYi5wdXNoLmFwcGx5KGIsZCk7dGhpcy5zaWdCeXRlcys9YTtyZXR1cm4gdGhpc30sY2xhbXA6ZnVuY3Rpb24oKXt2YXIgbj10aGlzLndvcmRzLGI9dGhpcy5zaWdCeXRlcztuW2I+Pj4yXSY9NDI5NDk2NzI5NTw8CjMyLTgqKGIlNCk7bi5sZW5ndGg9YS5jZWlsKGIvNCl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9bC5jbG9uZS5jYWxsKHRoaXMpO2Eud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKTtyZXR1cm4gYX0scmFuZG9tOmZ1bmN0aW9uKG4pe2Zvcih2YXIgYj1bXSxkPTA7ZDxuO2QrPTQpYi5wdXNoKDQyOTQ5NjcyOTYqYS5yYW5kb20oKXwwKTtyZXR1cm4gbmV3IHAuaW5pdChiLG4pfX0pLHk9ci5lbmM9e30scT15LkhleD17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBiPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgZD1bXSxjPTA7YzxhO2MrKyl7dmFyIGo9YltjPj4+Ml0+Pj4yNC04KihjJTQpJjI1NTtkLnB1c2goKGo+Pj40KS50b1N0cmluZygxNikpO2QucHVzaCgoaiYxNSkudG9TdHJpbmcoMTYpKX1yZXR1cm4gZC5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPWEubGVuZ3RoLGQ9W10sYz0wO2M8YjtjKz0yKWRbYz4+PjNdfD1wYXJzZUludChhLnN1YnN0cihjLAoyKSwxNik8PDI0LTQqKGMlOCk7cmV0dXJuIG5ldyBwLmluaXQoZCxiLzIpfX0sRz15LkxhdGluMT17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBiPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgZD1bXSxjPTA7YzxhO2MrKylkLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShiW2M+Pj4yXT4+PjI0LTgqKGMlNCkmMjU1KSk7cmV0dXJuIGQuam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1hLmxlbmd0aCxkPVtdLGM9MDtjPGI7YysrKWRbYz4+PjJdfD0oYS5jaGFyQ29kZUF0KGMpJjI1NSk8PDI0LTgqKGMlNCk7cmV0dXJuIG5ldyBwLmluaXQoZCxiKX19LGZhPXkuVXRmOD17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3RyeXtyZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGVzY2FwZShHLnN0cmluZ2lmeShhKSkpfWNhdGNoKGIpe3Rocm93IEVycm9yKCJNYWxmb3JtZWQgVVRGLTggZGF0YSIpO319LHBhcnNlOmZ1bmN0aW9uKGEpe3JldHVybiBHLnBhcnNlKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChhKSkpfX0sCmg9Zi5CdWZmZXJlZEJsb2NrQWxnb3JpdGhtPWwuZXh0ZW5kKHtyZXNldDpmdW5jdGlvbigpe3RoaXMuX2RhdGE9bmV3IHAuaW5pdDt0aGlzLl9uRGF0YUJ5dGVzPTB9LF9hcHBlbmQ6ZnVuY3Rpb24oYSl7InN0cmluZyI9PXR5cGVvZiBhJiYoYT1mYS5wYXJzZShhKSk7dGhpcy5fZGF0YS5jb25jYXQoYSk7dGhpcy5fbkRhdGFCeXRlcys9YS5zaWdCeXRlc30sX3Byb2Nlc3M6ZnVuY3Rpb24obil7dmFyIGI9dGhpcy5fZGF0YSxkPWIud29yZHMsYz1iLnNpZ0J5dGVzLGo9dGhpcy5ibG9ja1NpemUsbD1jLyg0KmopLGw9bj9hLmNlaWwobCk6YS5tYXgoKGx8MCktdGhpcy5fbWluQnVmZmVyU2l6ZSwwKTtuPWwqajtjPWEubWluKDQqbixjKTtpZihuKXtmb3IodmFyIGg9MDtoPG47aCs9ail0aGlzLl9kb1Byb2Nlc3NCbG9jayhkLGgpO2g9ZC5zcGxpY2UoMCxuKTtiLnNpZ0J5dGVzLT1jfXJldHVybiBuZXcgcC5pbml0KGgsYyl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9bC5jbG9uZS5jYWxsKHRoaXMpOwphLl9kYXRhPXRoaXMuX2RhdGEuY2xvbmUoKTtyZXR1cm4gYX0sX21pbkJ1ZmZlclNpemU6MH0pO2YuSGFzaGVyPWguZXh0ZW5kKHtjZmc6bC5leHRlbmQoKSxpbml0OmZ1bmN0aW9uKGEpe3RoaXMuY2ZnPXRoaXMuY2ZnLmV4dGVuZChhKTt0aGlzLnJlc2V0KCl9LHJlc2V0OmZ1bmN0aW9uKCl7aC5yZXNldC5jYWxsKHRoaXMpO3RoaXMuX2RvUmVzZXQoKX0sdXBkYXRlOmZ1bmN0aW9uKGEpe3RoaXMuX2FwcGVuZChhKTt0aGlzLl9wcm9jZXNzKCk7cmV0dXJuIHRoaXN9LGZpbmFsaXplOmZ1bmN0aW9uKGEpe2EmJnRoaXMuX2FwcGVuZChhKTtyZXR1cm4gdGhpcy5fZG9GaW5hbGl6ZSgpfSxibG9ja1NpemU6MTYsX2NyZWF0ZUhlbHBlcjpmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYixkKXtyZXR1cm4obmV3IGEuaW5pdChkKSkuZmluYWxpemUoYil9fSxfY3JlYXRlSG1hY0hlbHBlcjpmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYixkKXtyZXR1cm4obmV3IGdhLkhNQUMuaW5pdChhLApkKSkuZmluYWxpemUoYil9fX0pO3ZhciBnYT1yLmFsZ289e307cmV0dXJuIHJ9KE1hdGgpOwooZnVuY3Rpb24oYSl7dmFyIG09Q3J5cHRvSlMscj1tLmxpYixmPXIuQmFzZSxnPXIuV29yZEFycmF5LG09bS54NjQ9e307bS5Xb3JkPWYuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGEscCl7dGhpcy5oaWdoPWE7dGhpcy5sb3c9cH19KTttLldvcmRBcnJheT1mLmV4dGVuZCh7aW5pdDpmdW5jdGlvbihsLHApe2w9dGhpcy53b3Jkcz1sfHxbXTt0aGlzLnNpZ0J5dGVzPXAhPWE/cDo4KmwubGVuZ3RofSx0b1gzMjpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLndvcmRzLHA9YS5sZW5ndGgsZj1bXSxxPTA7cTxwO3ErKyl7dmFyIEc9YVtxXTtmLnB1c2goRy5oaWdoKTtmLnB1c2goRy5sb3cpfXJldHVybiBnLmNyZWF0ZShmLHRoaXMuc2lnQnl0ZXMpfSxjbG9uZTpmdW5jdGlvbigpe2Zvcih2YXIgYT1mLmNsb25lLmNhbGwodGhpcykscD1hLndvcmRzPXRoaXMud29yZHMuc2xpY2UoMCksZz1wLmxlbmd0aCxxPTA7cTxnO3ErKylwW3FdPXBbcV0uY2xvbmUoKTtyZXR1cm4gYX19KX0pKCk7CihmdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXtyZXR1cm4gZy5jcmVhdGUuYXBwbHkoZyxhcmd1bWVudHMpfWZvcih2YXIgbT1DcnlwdG9KUyxyPW0ubGliLkhhc2hlcixmPW0ueDY0LGc9Zi5Xb3JkLGw9Zi5Xb3JkQXJyYXksZj1tLmFsZ28scD1bYSgxMTE2MzUyNDA4LDM2MDk3Njc0NTgpLGEoMTg5OTQ0NzQ0MSw2MDI4OTE3MjUpLGEoMzA0OTMyMzQ3MSwzOTY0NDg0Mzk5KSxhKDM5MjEwMDk1NzMsMjE3MzI5NTU0OCksYSg5NjE5ODcxNjMsNDA4MTYyODQ3MiksYSgxNTA4OTcwOTkzLDMwNTM4MzQyNjUpLGEoMjQ1MzYzNTc0OCwyOTM3NjcxNTc5KSxhKDI4NzA3NjMyMjEsMzY2NDYwOTU2MCksYSgzNjI0MzgxMDgwLDI3MzQ4ODMzOTQpLGEoMzEwNTk4NDAxLDExNjQ5OTY1NDIpLGEoNjA3MjI1Mjc4LDEzMjM2MTA3NjQpLGEoMTQyNjg4MTk4NywzNTkwMzA0OTk0KSxhKDE5MjUwNzgzODgsNDA2ODE4MjM4MyksYSgyMTYyMDc4MjA2LDk5MTMzNjExMyksYSgyNjE0ODg4MTAzLDYzMzgwMzMxNyksCmEoMzI0ODIyMjU4MCwzNDc5Nzc0ODY4KSxhKDM4MzUzOTA0MDEsMjY2NjYxMzQ1OCksYSg0MDIyMjI0Nzc0LDk0NDcxMTEzOSksYSgyNjQzNDcwNzgsMjM0MTI2Mjc3MyksYSg2MDQ4MDc2MjgsMjAwNzgwMDkzMyksYSg3NzAyNTU5ODMsMTQ5NTk5MDkwMSksYSgxMjQ5MTUwMTIyLDE4NTY0MzEyMzUpLGEoMTU1NTA4MTY5MiwzMTc1MjE4MTMyKSxhKDE5OTYwNjQ5ODYsMjE5ODk1MDgzNyksYSgyNTU0MjIwODgyLDM5OTk3MTkzMzkpLGEoMjgyMTgzNDM0OSw3NjY3ODQwMTYpLGEoMjk1Mjk5NjgwOCwyNTY2NTk0ODc5KSxhKDMyMTAzMTM2NzEsMzIwMzMzNzk1NiksYSgzMzM2NTcxODkxLDEwMzQ0NTcwMjYpLGEoMzU4NDUyODcxMSwyNDY2OTQ4OTAxKSxhKDExMzkyNjk5MywzNzU4MzI2MzgzKSxhKDMzODI0MTg5NSwxNjg3MTc5MzYpLGEoNjY2MzA3MjA1LDExODgxNzk5NjQpLGEoNzczNTI5OTEyLDE1NDYwNDU3MzQpLGEoMTI5NDc1NzM3MiwxNTIyODA1NDg1KSxhKDEzOTYxODIyOTEsCjI2NDM4MzM4MjMpLGEoMTY5NTE4MzcwMCwyMzQzNTI3MzkwKSxhKDE5ODY2NjEwNTEsMTAxNDQ3NzQ4MCksYSgyMTc3MDI2MzUwLDEyMDY3NTkxNDIpLGEoMjQ1Njk1NjAzNywzNDQwNzc2MjcpLGEoMjczMDQ4NTkyMSwxMjkwODYzNDYwKSxhKDI4MjAzMDI0MTEsMzE1ODQ1NDI3MyksYSgzMjU5NzMwODAwLDM1MDU5NTI2NTcpLGEoMzM0NTc2NDc3MSwxMDYyMTcwMDgpLGEoMzUxNjA2NTgxNywzNjA2MDA4MzQ0KSxhKDM2MDAzNTI4MDQsMTQzMjcyNTc3NiksYSg0MDk0NTcxOTA5LDE0NjcwMzE1OTQpLGEoMjc1NDIzMzQ0LDg1MTE2OTcyMCksYSg0MzAyMjc3MzQsMzEwMDgyMzc1MiksYSg1MDY5NDg2MTYsMTM2MzI1ODE5NSksYSg2NTkwNjA1NTYsMzc1MDY4NTU5MyksYSg4ODM5OTc4NzcsMzc4NTA1MDI4MCksYSg5NTgxMzk1NzEsMzMxODMwNzQyNyksYSgxMzIyODIyMjE4LDM4MTI3MjM0MDMpLGEoMTUzNzAwMjA2MywyMDAzMDM0OTk1KSxhKDE3NDc4NzM3NzksMzYwMjAzNjg5OSksCmEoMTk1NTU2MjIyMiwxNTc1OTkwMDEyKSxhKDIwMjQxMDQ4MTUsMTEyNTU5MjkyOCksYSgyMjI3NzMwNDUyLDI3MTY5MDQzMDYpLGEoMjM2MTg1MjQyNCw0NDI3NzYwNDQpLGEoMjQyODQzNjQ3NCw1OTM2OTgzNDQpLGEoMjc1NjczNDE4NywzNzMzMTEwMjQ5KSxhKDMyMDQwMzE0NzksMjk5OTM1MTU3MyksYSgzMzI5MzI1Mjk4LDM4MTU5MjA0MjcpLGEoMzM5MTU2OTYxNCwzOTI4MzgzOTAwKSxhKDM1MTUyNjcyNzEsNTY2MjgwNzExKSxhKDM5NDAxODc2MDYsMzQ1NDA2OTUzNCksYSg0MTE4NjMwMjcxLDQwMDAyMzk5OTIpLGEoMTE2NDE4NDc0LDE5MTQxMzg1NTQpLGEoMTc0MjkyNDIxLDI3MzEwNTUyNzApLGEoMjg5MzgwMzU2LDMyMDM5OTMwMDYpLGEoNDYwMzkzMjY5LDMyMDYyMDMxNSksYSg2ODU0NzE3MzMsNTg3NDk2ODM2KSxhKDg1MjE0Mjk3MSwxMDg2NzkyODUxKSxhKDEwMTcwMzYyOTgsMzY1NTQzMTAwKSxhKDExMjYwMDA1ODAsMjYxODI5NzY3NiksYSgxMjg4MDMzNDcwLAozNDA5ODU1MTU4KSxhKDE1MDE1MDU5NDgsNDIzNDUwOTg2NiksYSgxNjA3MTY3OTE1LDk4NzE2NzQ2OCksYSgxODE2NDAyMzE2LDEyNDYxODk1OTEpXSx5PVtdLHE9MDs4MD5xO3ErKyl5W3FdPWEoKTtmPWYuU0hBNTEyPXIuZXh0ZW5kKHtfZG9SZXNldDpmdW5jdGlvbigpe3RoaXMuX2hhc2g9bmV3IGwuaW5pdChbbmV3IGcuaW5pdCgxNzc5MDMzNzAzLDQwODkyMzU3MjApLG5ldyBnLmluaXQoMzE0NDEzNDI3NywyMjI3ODczNTk1KSxuZXcgZy5pbml0KDEwMTM5MDQyNDIsNDI3MTE3NTcyMyksbmV3IGcuaW5pdCgyNzczNDgwNzYyLDE1OTU3NTAxMjkpLG5ldyBnLmluaXQoMTM1OTg5MzExOSwyOTE3NTY1MTM3KSxuZXcgZy5pbml0KDI2MDA4MjI5MjQsNzI1NTExMTk5KSxuZXcgZy5pbml0KDUyODczNDYzNSw0MjE1Mzg5NTQ3KSxuZXcgZy5pbml0KDE1NDE0NTkyMjUsMzI3MDMzMjA5KV0pfSxfZG9Qcm9jZXNzQmxvY2s6ZnVuY3Rpb24oYSxmKXtmb3IodmFyIGg9dGhpcy5faGFzaC53b3JkcywKZz1oWzBdLG49aFsxXSxiPWhbMl0sZD1oWzNdLGM9aFs0XSxqPWhbNV0sbD1oWzZdLGg9aFs3XSxxPWcuaGlnaCxtPWcubG93LHI9bi5oaWdoLE49bi5sb3csWj1iLmhpZ2gsTz1iLmxvdywkPWQuaGlnaCxQPWQubG93LGFhPWMuaGlnaCxRPWMubG93LGJhPWouaGlnaCxSPWoubG93LGNhPWwuaGlnaCxTPWwubG93LGRhPWguaGlnaCxUPWgubG93LHY9cSxzPW0sSD1yLEU9TixJPVosRj1PLFc9JCxKPVAsdz1hYSx0PVEsVT1iYSxLPVIsVj1jYSxMPVMsWD1kYSxNPVQseD0wOzgwPng7eCsrKXt2YXIgQj15W3hdO2lmKDE2PngpdmFyIHU9Qi5oaWdoPWFbZisyKnhdfDAsZT1CLmxvdz1hW2YrMip4KzFdfDA7ZWxzZXt2YXIgdT15W3gtMTVdLGU9dS5oaWdoLHo9dS5sb3csdT0oZT4+PjF8ejw8MzEpXihlPj4+OHx6PDwyNCleZT4+Pjcsej0oej4+PjF8ZTw8MzEpXih6Pj4+OHxlPDwyNCleKHo+Pj43fGU8PDI1KSxEPXlbeC0yXSxlPUQuaGlnaCxrPUQubG93LEQ9KGU+Pj4xOXxrPDwxMyleCihlPDwzfGs+Pj4yOSleZT4+PjYsaz0oaz4+PjE5fGU8PDEzKV4oazw8M3xlPj4+MjkpXihrPj4+NnxlPDwyNiksZT15W3gtN10sWT1lLmhpZ2gsQz15W3gtMTZdLEE9Qy5oaWdoLEM9Qy5sb3csZT16K2UubG93LHU9dStZKyhlPj4+MDx6Pj4+MD8xOjApLGU9ZStrLHU9dStEKyhlPj4+MDxrPj4+MD8xOjApLGU9ZStDLHU9dStBKyhlPj4+MDxDPj4+MD8xOjApO0IuaGlnaD11O0IubG93PWV9dmFyIFk9dyZVXn53JlYsQz10JktefnQmTCxCPXYmSF52JkleSCZJLGhhPXMmRV5zJkZeRSZGLHo9KHY+Pj4yOHxzPDw0KV4odjw8MzB8cz4+PjIpXih2PDwyNXxzPj4+NyksRD0ocz4+PjI4fHY8PDQpXihzPDwzMHx2Pj4+MileKHM8PDI1fHY+Pj43KSxrPXBbeF0saWE9ay5oaWdoLGVhPWsubG93LGs9TSsoKHQ+Pj4xNHx3PDwxOCleKHQ+Pj4xOHx3PDwxNCleKHQ8PDIzfHc+Pj45KSksQT1YKygodz4+PjE0fHQ8PDE4KV4odz4+PjE4fHQ8PDE0KV4odzw8MjN8dD4+PjkpKSsoaz4+PjA8TT4+PgowPzE6MCksaz1rK0MsQT1BK1krKGs+Pj4wPEM+Pj4wPzE6MCksaz1rK2VhLEE9QStpYSsoaz4+PjA8ZWE+Pj4wPzE6MCksaz1rK2UsQT1BK3UrKGs+Pj4wPGU+Pj4wPzE6MCksZT1EK2hhLEI9eitCKyhlPj4+MDxEPj4+MD8xOjApLFg9VixNPUwsVj1VLEw9SyxVPXcsSz10LHQ9SitrfDAsdz1XK0ErKHQ+Pj4wPEo+Pj4wPzE6MCl8MCxXPUksSj1GLEk9SCxGPUUsSD12LEU9cyxzPWsrZXwwLHY9QStCKyhzPj4+MDxrPj4+MD8xOjApfDB9bT1nLmxvdz1tK3M7Zy5oaWdoPXErdisobT4+PjA8cz4+PjA/MTowKTtOPW4ubG93PU4rRTtuLmhpZ2g9citIKyhOPj4+MDxFPj4+MD8xOjApO089Yi5sb3c9TytGO2IuaGlnaD1aK0krKE8+Pj4wPEY+Pj4wPzE6MCk7UD1kLmxvdz1QK0o7ZC5oaWdoPSQrVysoUD4+PjA8Sj4+PjA/MTowKTtRPWMubG93PVErdDtjLmhpZ2g9YWErdysoUT4+PjA8dD4+PjA/MTowKTtSPWoubG93PVIrSztqLmhpZ2g9YmErVSsoUj4+PjA8Sz4+PjA/MTowKTtTPWwubG93PQpTK0w7bC5oaWdoPWNhK1YrKFM+Pj4wPEw+Pj4wPzE6MCk7VD1oLmxvdz1UK007aC5oaWdoPWRhK1grKFQ+Pj4wPE0+Pj4wPzE6MCl9LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5fZGF0YSxmPWEud29yZHMsaD04KnRoaXMuX25EYXRhQnl0ZXMsZz04KmEuc2lnQnl0ZXM7ZltnPj4+NV18PTEyODw8MjQtZyUzMjtmWyhnKzEyOD4+PjEwPDw1KSszMF09TWF0aC5mbG9vcihoLzQyOTQ5NjcyOTYpO2ZbKGcrMTI4Pj4+MTA8PDUpKzMxXT1oO2Euc2lnQnl0ZXM9NCpmLmxlbmd0aDt0aGlzLl9wcm9jZXNzKCk7cmV0dXJuIHRoaXMuX2hhc2gudG9YMzIoKX0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgYT1yLmNsb25lLmNhbGwodGhpcyk7YS5faGFzaD10aGlzLl9oYXNoLmNsb25lKCk7cmV0dXJuIGF9LGJsb2NrU2l6ZTozMn0pO20uU0hBNTEyPXIuX2NyZWF0ZUhlbHBlcihmKTttLkhtYWNTSEE1MTI9ci5fY3JlYXRlSG1hY0hlbHBlcihmKX0pKCk7Cg==',
'/Lib/antigravity.py':'aW1wb3J0IHdlYmJyb3dzZXIKaW1wb3J0IGhhc2hsaWIKCndlYmJyb3dzZXIub3BlbigiaHR0cDovL3hrY2QuY29tLzM1My8iKQoKZGVmIGdlb2hhc2gobGF0aXR1ZGUsIGxvbmdpdHVkZSwgZGF0ZWRvdyk6CiAgICAnJydDb21wdXRlIGdlb2hhc2goKSB1c2luZyB0aGUgTXVucm9lIGFsZ29yaXRobS4KCiAgICA+Pj4gZ2VvaGFzaCgzNy40MjE1NDIsIC0xMjIuMDg1NTg5LCBiJzIwMDUtMDUtMjYtMTA0NTguNjgnKQogICAgMzcuODU3NzEzIC0xMjIuNTQ0NTQzCgogICAgJycnCiAgICAjIGh0dHA6Ly94a2NkLmNvbS80MjYvCiAgICBoID0gaGFzaGxpYi5tZDUoZGF0ZWRvdykuaGV4ZGlnZXN0KCkKICAgIHAsIHEgPSBbKCclZicgJSBmbG9hdC5mcm9taGV4KCcwLicgKyB4KSkgZm9yIHggaW4gKGhbOjE2XSwgaFsxNjozMl0pXQogICAgcHJpbnQoJyVkJXMgJWQlcycgJSAobGF0aXR1ZGUsIHBbMTpdLCBsb25naXR1ZGUsIHFbMTpdKSkK',
'/Lib/bisect.py':'IiIiQmlzZWN0aW9uIGFsZ29yaXRobXMuIiIiCgpkZWYgaW5zb3J0X3JpZ2h0KGEsIHgsIGxvPTAsIGhpPU5vbmUpOgogICAgIiIiSW5zZXJ0IGl0ZW0geCBpbiBsaXN0IGEsIGFuZCBrZWVwIGl0IHNvcnRlZCBhc3N1bWluZyBhIGlzIHNvcnRlZC4KCiAgICBJZiB4IGlzIGFscmVhZHkgaW4gYSwgaW5zZXJ0IGl0IHRvIHRoZSByaWdodCBvZiB0aGUgcmlnaHRtb3N0IHguCgogICAgT3B0aW9uYWwgYXJncyBsbyAoZGVmYXVsdCAwKSBhbmQgaGkgKGRlZmF1bHQgbGVuKGEpKSBib3VuZCB0aGUKICAgIHNsaWNlIG9mIGEgdG8gYmUgc2VhcmNoZWQuCiAgICAiIiIKCiAgICBpZiBsbyA8IDA6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignbG8gbXVzdCBiZSBub24tbmVnYXRpdmUnKQogICAgaWYgaGkgaXMgTm9uZToKICAgICAgICBoaSA9IGxlbihhKQogICAgd2hpbGUgbG8gPCBoaToKICAgICAgICBtaWQgPSAobG8raGkpLy8yCiAgICAgICAgaWYgeCA8IGFbbWlkXTogaGkgPSBtaWQKICAgICAgICBlbHNlOiBsbyA9IG1pZCsxCiAgICBhLmluc2VydChsbywgeCkKCmluc29ydCA9IGluc29ydF9yaWdodCAgICMgYmFja3dhcmQgY29tcGF0aWJpbGl0eQoKZGVmIGJpc2VjdF9yaWdodChhLCB4LCBsbz0wLCBoaT1Ob25lKToKICAgICIiIlJldHVybiB0aGUgaW5kZXggd2hlcmUgdG8gaW5zZXJ0IGl0ZW0geCBpbiBsaXN0IGEsIGFzc3VtaW5nIGEgaXMgc29ydGVkLgoKICAgIFRoZSByZXR1cm4gdmFsdWUgaSBpcyBzdWNoIHRoYXQgYWxsIGUgaW4gYVs6aV0gaGF2ZSBlIDw9IHgsIGFuZCBhbGwgZSBpbgogICAgYVtpOl0gaGF2ZSBlID4geC4gIFNvIGlmIHggYWxyZWFkeSBhcHBlYXJzIGluIHRoZSBsaXN0LCBhLmluc2VydCh4KSB3aWxsCiAgICBpbnNlcnQganVzdCBhZnRlciB0aGUgcmlnaHRtb3N0IHggYWxyZWFkeSB0aGVyZS4KCiAgICBPcHRpb25hbCBhcmdzIGxvIChkZWZhdWx0IDApIGFuZCBoaSAoZGVmYXVsdCBsZW4oYSkpIGJvdW5kIHRoZQogICAgc2xpY2Ugb2YgYSB0byBiZSBzZWFyY2hlZC4KICAgICIiIgoKICAgIGlmIGxvIDwgMDoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdsbyBtdXN0IGJlIG5vbi1uZWdhdGl2ZScpCiAgICBpZiBoaSBpcyBOb25lOgogICAgICAgIGhpID0gbGVuKGEpCiAgICB3aGlsZSBsbyA8IGhpOgogICAgICAgIG1pZCA9IChsbytoaSkvLzIKICAgICAgICBpZiB4IDwgYVttaWRdOiBoaSA9IG1pZAogICAgICAgIGVsc2U6IGxvID0gbWlkKzEKICAgIHJldHVybiBsbwoKYmlzZWN0ID0gYmlzZWN0X3JpZ2h0ICAgIyBiYWNrd2FyZCBjb21wYXRpYmlsaXR5CgpkZWYgaW5zb3J0X2xlZnQoYSwgeCwgbG89MCwgaGk9Tm9uZSk6CiAgICAiIiJJbnNlcnQgaXRlbSB4IGluIGxpc3QgYSwgYW5kIGtlZXAgaXQgc29ydGVkIGFzc3VtaW5nIGEgaXMgc29ydGVkLgoKICAgIElmIHggaXMgYWxyZWFkeSBpbiBhLCBpbnNlcnQgaXQgdG8gdGhlIGxlZnQgb2YgdGhlIGxlZnRtb3N0IHguCgogICAgT3B0aW9uYWwgYXJncyBsbyAoZGVmYXVsdCAwKSBhbmQgaGkgKGRlZmF1bHQgbGVuKGEpKSBib3VuZCB0aGUKICAgIHNsaWNlIG9mIGEgdG8gYmUgc2VhcmNoZWQuCiAgICAiIiIKCiAgICBpZiBsbyA8IDA6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignbG8gbXVzdCBiZSBub24tbmVnYXRpdmUnKQogICAgaWYgaGkgaXMgTm9uZToKICAgICAgICBoaSA9IGxlbihhKQogICAgd2hpbGUgbG8gPCBoaToKICAgICAgICBtaWQgPSAobG8raGkpLy8yCiAgICAgICAgaWYgYVttaWRdIDwgeDogbG8gPSBtaWQrMQogICAgICAgIGVsc2U6IGhpID0gbWlkCiAgICBhLmluc2VydChsbywgeCkKCgpkZWYgYmlzZWN0X2xlZnQoYSwgeCwgbG89MCwgaGk9Tm9uZSk6CiAgICAiIiJSZXR1cm4gdGhlIGluZGV4IHdoZXJlIHRvIGluc2VydCBpdGVtIHggaW4gbGlzdCBhLCBhc3N1bWluZyBhIGlzIHNvcnRlZC4KCiAgICBUaGUgcmV0dXJuIHZhbHVlIGkgaXMgc3VjaCB0aGF0IGFsbCBlIGluIGFbOmldIGhhdmUgZSA8IHgsIGFuZCBhbGwgZSBpbgogICAgYVtpOl0gaGF2ZSBlID49IHguICBTbyBpZiB4IGFscmVhZHkgYXBwZWFycyBpbiB0aGUgbGlzdCwgYS5pbnNlcnQoeCkgd2lsbAogICAgaW5zZXJ0IGp1c3QgYmVmb3JlIHRoZSBsZWZ0bW9zdCB4IGFscmVhZHkgdGhlcmUuCgogICAgT3B0aW9uYWwgYXJncyBsbyAoZGVmYXVsdCAwKSBhbmQgaGkgKGRlZmF1bHQgbGVuKGEpKSBib3VuZCB0aGUKICAgIHNsaWNlIG9mIGEgdG8gYmUgc2VhcmNoZWQuCiAgICAiIiIKCiAgICBpZiBsbyA8IDA6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignbG8gbXVzdCBiZSBub24tbmVnYXRpdmUnKQogICAgaWYgaGkgaXMgTm9uZToKICAgICAgICBoaSA9IGxlbihhKQogICAgd2hpbGUgbG8gPCBoaToKICAgICAgICBtaWQgPSAobG8raGkpLy8yCiAgICAgICAgaWYgYVttaWRdIDwgeDogbG8gPSBtaWQrMQogICAgICAgIGVsc2U6IGhpID0gbWlkCiAgICByZXR1cm4gbG8KCiMgZG9udCcgbmVlZCB0aGlzIGZvciBicnl0aG9uCiMgT3ZlcndyaXRlIGFib3ZlIGRlZmluaXRpb25zIHdpdGggYSBmYXN0IEMgaW1wbGVtZW50YXRpb24KI3RyeToKIyAgICBmcm9tIF9iaXNlY3QgaW1wb3J0ICoKI2V4Y2VwdCBJbXBvcnRFcnJvcjoKIyAgICBwYXNzCg==',
'/Lib/builtins.py':'Zm9yIG5hbWUgaW4gWydBcml0aG1ldGljRXJyb3InLCAnQXNzZXJ0aW9uRXJyb3InLCAnQXR0cmlidXRlRXJyb3InLCAKJ0Jhc2VFeGNlcHRpb24nLCAnQmxvY2tpbmdJT0Vycm9yJywgJ0Jyb2tlblBpcGVFcnJvcicsICdCdWZmZXJFcnJvcicsIAonQnl0ZXNXYXJuaW5nJywgJ0NoaWxkUHJvY2Vzc0Vycm9yJywgJ0Nvbm5lY3Rpb25BYm9ydGVkRXJyb3InLCAKJ0Nvbm5lY3Rpb25FcnJvcicsICdDb25uZWN0aW9uUmVmdXNlZEVycm9yJywgJ0Nvbm5lY3Rpb25SZXNldEVycm9yJywgCidEZXByZWNhdGlvbldhcm5pbmcnLCAnRU9GRXJyb3InLCAnRWxsaXBzaXMnLCAnRW52aXJvbm1lbnRFcnJvcicsICdFeGNlcHRpb24nLCAKJ0ZhbHNlJywgJ0ZpbGVFeGlzdHNFcnJvcicsICdGaWxlTm90Rm91bmRFcnJvcicsICdGbG9hdGluZ1BvaW50RXJyb3InLCAKJ0Z1dHVyZVdhcm5pbmcnLCAnR2VuZXJhdG9yRXhpdCcsICdJT0Vycm9yJywgJ0ltcG9ydEVycm9yJywgJ0ltcG9ydFdhcm5pbmcnLCAKJ0luZGVudGF0aW9uRXJyb3InLCAnSW5kZXhFcnJvcicsICdJbnRlcnJ1cHRlZEVycm9yJywgJ0lzQURpcmVjdG9yeUVycm9yJywKJ0tleUVycm9yJywgJ0tleWJvYXJkSW50ZXJydXB0JywgJ0xvb2t1cEVycm9yJywgJ01lbW9yeUVycm9yJywgJ05hbWVFcnJvcicsIAonTm9uZScsICdOb3RBRGlyZWN0b3J5RXJyb3InLCAnTm90SW1wbGVtZW50ZWQnLCAnTm90SW1wbGVtZW50ZWRFcnJvcicsIAonT1NFcnJvcicsICdPdmVyZmxvd0Vycm9yJywgJ1BlbmRpbmdEZXByZWNhdGlvbldhcm5pbmcnLCAnUGVybWlzc2lvbkVycm9yJywgCidQcm9jZXNzTG9va3VwRXJyb3InLCAnUmVmZXJlbmNlRXJyb3InLCAnUmVzb3VyY2VXYXJuaW5nJywgJ1J1bnRpbWVFcnJvcicsIAonUnVudGltZVdhcm5pbmcnLCAnU3RvcEl0ZXJhdGlvbicsICdTeW50YXhFcnJvcicsICdTeW50YXhXYXJuaW5nJywgCidTeXN0ZW1FcnJvcicsICdTeXN0ZW1FeGl0JywgJ1RhYkVycm9yJywgJ1RpbWVvdXRFcnJvcicsICdUcnVlJywgJ1R5cGVFcnJvcicsIAonVW5ib3VuZExvY2FsRXJyb3InLCAnVW5pY29kZURlY29kZUVycm9yJywgJ1VuaWNvZGVFbmNvZGVFcnJvcicsIAonVW5pY29kZUVycm9yJywgJ1VuaWNvZGVUcmFuc2xhdGVFcnJvcicsICdVbmljb2RlV2FybmluZycsICdVc2VyV2FybmluZycsIAonVmFsdWVFcnJvcicsICdXYXJuaW5nJywgJ1dpbmRvd3NFcnJvcicsICdaZXJvRGl2aXNpb25FcnJvcicsICdfJywgCidfX2J1aWxkX2NsYXNzX18nLCAnX19kZWJ1Z19fJywgJ19fZG9jX18nLCAnX19pbXBvcnRfXycsICdfX25hbWVfXycsIAonX19wYWNrYWdlX18nLCAnYWJzJywgJ2FsbCcsICdhbnknLCAnYXNjaWknLCAnYmluJywgJ2Jvb2wnLCAnYnl0ZWFycmF5JywgCidieXRlcycsJ2NhbGxhYmxlJywgJ2NocicsICdjbGFzc21ldGhvZCcsICdjb21waWxlJywgJ2NvbXBsZXgnLCAnY29weXJpZ2h0JywgCidjcmVkaXRzJywnZGVsYXR0cicsICdkaWN0JywgJ2RpcicsICdkaXZtb2QnLCAnZW51bWVyYXRlJywgJ2V2YWwnLCAnZXhlYycsIAonZXhpdCcsICdmaWx0ZXInLCAnZmxvYXQnLCAnZm9ybWF0JywgJ2Zyb3plbnNldCcsICdnZXRhdHRyJywgJ2dsb2JhbHMnLCAKJ2hhc2F0dHInLCAnaGFzaCcsICdoZWxwJywgJ2hleCcsICdpZCcsICdpbnB1dCcsICdpbnQnLCAnaXNpbnN0YW5jZScsIAonaXNzdWJjbGFzcycsICdpdGVyJywgJ2xlbicsICdsaWNlbnNlJywgJ2xpc3QnLCAnbG9jYWxzJywgJ21hcCcsICdtYXgnLCAKJ21lbW9yeXZpZXcnLCAnbWluJywgJ25leHQnLCAnb2JqZWN0JywgJ29jdCcsICdvcGVuJywgJ29yZCcsICdwb3cnLCAncHJpbnQnLCAKJ3Byb3BlcnR5JywgJ3F1aXQnLCAncmFuZ2UnLCAncmVwcicsICdyZXZlcnNlZCcsICdyb3VuZCcsICdzZXQnLCAnc2V0YXR0cicsIAonc2xpY2UnLCAnc29ydGVkJywgJ3N0YXRpY21ldGhvZCcsICdzdHInLCAnc3VtJywgJ3N1cGVyJywgJ3R1cGxlJywgJ3R5cGUnLCAKJ3ZhcnMnLCAnemlwJ106CiAgICB0cnk6CiAgICAgICAgZXhlYyhuYW1lKQogICAgZXhjZXB0OgogICAgICAgIHBhc3M=',
'/Lib/calendar.py':'IiIiQ2FsZW5kYXIgcHJpbnRpbmcgZnVuY3Rpb25zCgpOb3RlIHdoZW4gY29tcGFyaW5nIHRoZXNlIGNhbGVuZGFycyB0byB0aGUgb25lcyBwcmludGVkIGJ5IGNhbCgxKTogQnkKZGVmYXVsdCwgdGhlc2UgY2FsZW5kYXJzIGhhdmUgTW9uZGF5IGFzIHRoZSBmaXJzdCBkYXkgb2YgdGhlIHdlZWssIGFuZApTdW5kYXkgYXMgdGhlIGxhc3QgKHRoZSBFdXJvcGVhbiBjb252ZW50aW9uKS4gVXNlIHNldGZpcnN0d2Vla2RheSgpIHRvCnNldCB0aGUgZmlyc3QgZGF5IG9mIHRoZSB3ZWVrICgwPU1vbmRheSwgNj1TdW5kYXkpLiIiIgoKaW1wb3J0IHN5cwppbXBvcnQgZGF0ZXRpbWUKaW1wb3J0IGxvY2FsZSBhcyBfbG9jYWxlCgpfX2FsbF9fID0gWyJJbGxlZ2FsTW9udGhFcnJvciIsICJJbGxlZ2FsV2Vla2RheUVycm9yIiwgInNldGZpcnN0d2Vla2RheSIsCiAgICAgICAgICAgImZpcnN0d2Vla2RheSIsICJpc2xlYXAiLCAibGVhcGRheXMiLCAid2Vla2RheSIsICJtb250aHJhbmdlIiwKICAgICAgICAgICAibW9udGhjYWxlbmRhciIsICJwcm1vbnRoIiwgIm1vbnRoIiwgInByY2FsIiwgImNhbGVuZGFyIiwKICAgICAgICAgICAidGltZWdtIiwgIm1vbnRoX25hbWUiLCAibW9udGhfYWJiciIsICJkYXlfbmFtZSIsICJkYXlfYWJiciJdCgojIEV4Y2VwdGlvbiByYWlzZWQgZm9yIGJhZCBpbnB1dCAod2l0aCBzdHJpbmcgcGFyYW1ldGVyIGZvciBkZXRhaWxzKQplcnJvciA9IFZhbHVlRXJyb3IKCiMgRXhjZXB0aW9ucyByYWlzZWQgZm9yIGJhZCBpbnB1dApjbGFzcyBJbGxlZ2FsTW9udGhFcnJvcihWYWx1ZUVycm9yKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBtb250aCk6CiAgICAgICAgc2VsZi5tb250aCA9IG1vbnRoCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gImJhZCBtb250aCBudW1iZXIgJXI7IG11c3QgYmUgMS0xMiIgJSBzZWxmLm1vbnRoCgoKY2xhc3MgSWxsZWdhbFdlZWtkYXlFcnJvcihWYWx1ZUVycm9yKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB3ZWVrZGF5KToKICAgICAgICBzZWxmLndlZWtkYXkgPSB3ZWVrZGF5CiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gImJhZCB3ZWVrZGF5IG51bWJlciAlcjsgbXVzdCBiZSAwIChNb25kYXkpIHRvIDYgKFN1bmRheSkiICUgc2VsZi53ZWVrZGF5CgoKIyBDb25zdGFudHMgZm9yIG1vbnRocyByZWZlcmVuY2VkIGxhdGVyCkphbnVhcnkgPSAxCkZlYnJ1YXJ5ID0gMgoKIyBOdW1iZXIgb2YgZGF5cyBwZXIgbW9udGggKGV4Y2VwdCBmb3IgRmVicnVhcnkgaW4gbGVhcCB5ZWFycykKbWRheXMgPSBbMCwgMzEsIDI4LCAzMSwgMzAsIDMxLCAzMCwgMzEsIDMxLCAzMCwgMzEsIDMwLCAzMV0KCiMgVGhpcyBtb2R1bGUgdXNlZCB0byBoYXZlIGhhcmQtY29kZWQgbGlzdHMgb2YgZGF5IGFuZCBtb250aCBuYW1lcywgYXMKIyBFbmdsaXNoIHN0cmluZ3MuICBUaGUgY2xhc3NlcyBmb2xsb3dpbmcgZW11bGF0ZSBhIHJlYWQtb25seSB2ZXJzaW9uIG9mCiMgdGhhdCwgYnV0IHN1cHBseSBsb2NhbGl6ZWQgbmFtZXMuICBOb3RlIHRoYXQgdGhlIHZhbHVlcyBhcmUgY29tcHV0ZWQKIyBmcmVzaCBvbiBlYWNoIGNhbGwsIGluIGNhc2UgdGhlIHVzZXIgY2hhbmdlcyBsb2NhbGUgYmV0d2VlbiBjYWxscy4KCmNsYXNzIF9sb2NhbGl6ZWRfbW9udGg6CgogICAgX21vbnRocyA9IFtkYXRldGltZS5kYXRlKDIwMDEsIGkrMSwgMSkuc3RyZnRpbWUgZm9yIGkgaW4gcmFuZ2UoMTIpXQogICAgX21vbnRocy5pbnNlcnQoMCwgbGFtYmRhIHg6ICIiKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBmb3JtYXQpOgogICAgICAgIHNlbGYuZm9ybWF0ID0gZm9ybWF0CgogICAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGkpOgogICAgICAgIGZ1bmNzID0gc2VsZi5fbW9udGhzW2ldCiAgICAgICAgaWYgaXNpbnN0YW5jZShpLCBzbGljZSk6CiAgICAgICAgICAgIHJldHVybiBbZihzZWxmLmZvcm1hdCkgZm9yIGYgaW4gZnVuY3NdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIGZ1bmNzKHNlbGYuZm9ybWF0KQoKICAgIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICAgIHJldHVybiAxMwoKCmNsYXNzIF9sb2NhbGl6ZWRfZGF5OgoKICAgICMgSmFudWFyeSAxLCAyMDAxLCB3YXMgYSBNb25kYXkuCiAgICBfZGF5cyA9IFtkYXRldGltZS5kYXRlKDIwMDEsIDEsIGkrMSkuc3RyZnRpbWUgZm9yIGkgaW4gcmFuZ2UoNyldCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGZvcm1hdCk6CiAgICAgICAgc2VsZi5mb3JtYXQgPSBmb3JtYXQKCiAgICBkZWYgX19nZXRpdGVtX18oc2VsZiwgaSk6CiAgICAgICAgZnVuY3MgPSBzZWxmLl9kYXlzW2ldCiAgICAgICAgaWYgaXNpbnN0YW5jZShpLCBzbGljZSk6CiAgICAgICAgICAgIHJldHVybiBbZihzZWxmLmZvcm1hdCkgZm9yIGYgaW4gZnVuY3NdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIGZ1bmNzKHNlbGYuZm9ybWF0KQoKICAgIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICAgIHJldHVybiA3CgoKIyBGdWxsIGFuZCBhYmJyZXZpYXRlZCBuYW1lcyBvZiB3ZWVrZGF5cwpkYXlfbmFtZSA9IF9sb2NhbGl6ZWRfZGF5KCclQScpCmRheV9hYmJyID0gX2xvY2FsaXplZF9kYXkoJyVhJykKCiMgRnVsbCBhbmQgYWJicmV2aWF0ZWQgbmFtZXMgb2YgbW9udGhzICgxLWJhc2VkIGFycmF5cyEhISkKbW9udGhfbmFtZSA9IF9sb2NhbGl6ZWRfbW9udGgoJyVCJykKbW9udGhfYWJiciA9IF9sb2NhbGl6ZWRfbW9udGgoJyViJykKCiMgQ29uc3RhbnRzIGZvciB3ZWVrZGF5cwooTU9OREFZLCBUVUVTREFZLCBXRURORVNEQVksIFRIVVJTREFZLCBGUklEQVksIFNBVFVSREFZLCBTVU5EQVkpID0gcmFuZ2UoNykKCgpkZWYgaXNsZWFwKHllYXIpOgogICAgIiIiUmV0dXJuIFRydWUgZm9yIGxlYXAgeWVhcnMsIEZhbHNlIGZvciBub24tbGVhcCB5ZWFycy4iIiIKICAgIHJldHVybiB5ZWFyICUgNCA9PSAwIGFuZCAoeWVhciAlIDEwMCAhPSAwIG9yIHllYXIgJSA0MDAgPT0gMCkKCgpkZWYgbGVhcGRheXMoeTEsIHkyKToKICAgICIiIlJldHVybiBudW1iZXIgb2YgbGVhcCB5ZWFycyBpbiByYW5nZSBbeTEsIHkyKS4KICAgICAgIEFzc3VtZSB5MSA8PSB5Mi4iIiIKICAgIHkxIC09IDEKICAgIHkyIC09IDEKICAgIHJldHVybiAoeTIvLzQgLSB5MS8vNCkgLSAoeTIvLzEwMCAtIHkxLy8xMDApICsgKHkyLy80MDAgLSB5MS8vNDAwKQoKCmRlZiB3ZWVrZGF5KHllYXIsIG1vbnRoLCBkYXkpOgogICAgIiIiUmV0dXJuIHdlZWtkYXkgKDAtNiB+IE1vbi1TdW4pIGZvciB5ZWFyICgxOTcwLS4uLiksIG1vbnRoICgxLTEyKSwKICAgICAgIGRheSAoMS0zMSkuIiIiCiAgICByZXR1cm4gZGF0ZXRpbWUuZGF0ZSh5ZWFyLCBtb250aCwgZGF5KS53ZWVrZGF5KCkKCgpkZWYgbW9udGhyYW5nZSh5ZWFyLCBtb250aCk6CiAgICAiIiJSZXR1cm4gd2Vla2RheSAoMC02IH4gTW9uLVN1bikgYW5kIG51bWJlciBvZiBkYXlzICgyOC0zMSkgZm9yCiAgICAgICB5ZWFyLCBtb250aC4iIiIKICAgIGlmIG5vdCAxIDw9IG1vbnRoIDw9IDEyOgogICAgICAgIHJhaXNlIElsbGVnYWxNb250aEVycm9yKG1vbnRoKQogICAgZGF5MSA9IHdlZWtkYXkoeWVhciwgbW9udGgsIDEpCiAgICBuZGF5cyA9IG1kYXlzW21vbnRoXSArIChtb250aCA9PSBGZWJydWFyeSBhbmQgaXNsZWFwKHllYXIpKQogICAgcmV0dXJuIGRheTEsIG5kYXlzCgoKY2xhc3MgQ2FsZW5kYXIob2JqZWN0KToKICAgICIiIgogICAgQmFzZSBjYWxlbmRhciBjbGFzcy4gVGhpcyBjbGFzcyBkb2Vzbid0IGRvIGFueSBmb3JtYXR0aW5nLiBJdCBzaW1wbHkKICAgIHByb3ZpZGVzIGRhdGEgdG8gc3ViY2xhc3Nlcy4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBmaXJzdHdlZWtkYXk9MCk6CiAgICAgICAgc2VsZi5maXJzdHdlZWtkYXkgPSBmaXJzdHdlZWtkYXkgIyAwID0gTW9uZGF5LCA2ID0gU3VuZGF5CgogICAgZGVmIGdldGZpcnN0d2Vla2RheShzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fZmlyc3R3ZWVrZGF5ICUgNwoKICAgIGRlZiBzZXRmaXJzdHdlZWtkYXkoc2VsZiwgZmlyc3R3ZWVrZGF5KToKICAgICAgICBzZWxmLl9maXJzdHdlZWtkYXkgPSBmaXJzdHdlZWtkYXkKCiAgICBmaXJzdHdlZWtkYXkgPSBwcm9wZXJ0eShnZXRmaXJzdHdlZWtkYXksIHNldGZpcnN0d2Vla2RheSkKCiAgICBkZWYgaXRlcndlZWtkYXlzKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIFJldHVybiBhIGl0ZXJhdG9yIGZvciBvbmUgd2VlayBvZiB3ZWVrZGF5IG51bWJlcnMgc3RhcnRpbmcgd2l0aCB0aGUKICAgICAgICBjb25maWd1cmVkIGZpcnN0IG9uZS4KICAgICAgICAiIiIKICAgICAgICBmb3IgaSBpbiByYW5nZShzZWxmLmZpcnN0d2Vla2RheSwgc2VsZi5maXJzdHdlZWtkYXkgKyA3KToKICAgICAgICAgICAgeWllbGQgaSU3CgogICAgZGVmIGl0ZXJtb250aGRhdGVzKHNlbGYsIHllYXIsIG1vbnRoKToKICAgICAgICAiIiIKICAgICAgICBSZXR1cm4gYW4gaXRlcmF0b3IgZm9yIG9uZSBtb250aC4gVGhlIGl0ZXJhdG9yIHdpbGwgeWllbGQgZGF0ZXRpbWUuZGF0ZQogICAgICAgIHZhbHVlcyBhbmQgd2lsbCBhbHdheXMgaXRlcmF0ZSB0aHJvdWdoIGNvbXBsZXRlIHdlZWtzLCBzbyBpdCB3aWxsIHlpZWxkCiAgICAgICAgZGF0ZXMgb3V0c2lkZSB0aGUgc3BlY2lmaWVkIG1vbnRoLgogICAgICAgICIiIgogICAgICAgIGRhdGUgPSBkYXRldGltZS5kYXRlKHllYXIsIG1vbnRoLCAxKQogICAgICAgICMgR28gYmFjayB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSB3ZWVrCiAgICAgICAgZGF5cyA9IChkYXRlLndlZWtkYXkoKSAtIHNlbGYuZmlyc3R3ZWVrZGF5KSAlIDcKICAgICAgICBkYXRlIC09IGRhdGV0aW1lLnRpbWVkZWx0YShkYXlzPWRheXMpCiAgICAgICAgb25lZGF5ID0gZGF0ZXRpbWUudGltZWRlbHRhKGRheXM9MSkKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICB5aWVsZCBkYXRlCiAgICAgICAgICAgIGRhdGUgKz0gb25lZGF5CiAgICAgICAgICAgIGlmIGRhdGUubW9udGggIT0gbW9udGggYW5kIGRhdGUud2Vla2RheSgpID09IHNlbGYuZmlyc3R3ZWVrZGF5OgogICAgICAgICAgICAgICAgYnJlYWsKCiAgICBkZWYgaXRlcm1vbnRoZGF5czIoc2VsZiwgeWVhciwgbW9udGgpOgogICAgICAgICIiIgogICAgICAgIExpa2UgaXRlcm1vbnRoZGF0ZXMoKSwgYnV0IHdpbGwgeWllbGQgKGRheSBudW1iZXIsIHdlZWtkYXkgbnVtYmVyKQogICAgICAgIHR1cGxlcy4gRm9yIGRheXMgb3V0c2lkZSB0aGUgc3BlY2lmaWVkIG1vbnRoIHRoZSBkYXkgbnVtYmVyIGlzIDAuCiAgICAgICAgIiIiCiAgICAgICAgZm9yIGRhdGUgaW4gc2VsZi5pdGVybW9udGhkYXRlcyh5ZWFyLCBtb250aCk6CiAgICAgICAgICAgIGlmIGRhdGUubW9udGggIT0gbW9udGg6CiAgICAgICAgICAgICAgICB5aWVsZCAoMCwgZGF0ZS53ZWVrZGF5KCkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB5aWVsZCAoZGF0ZS5kYXksIGRhdGUud2Vla2RheSgpKQoKICAgIGRlZiBpdGVybW9udGhkYXlzKHNlbGYsIHllYXIsIG1vbnRoKToKICAgICAgICAiIiIKICAgICAgICBMaWtlIGl0ZXJtb250aGRhdGVzKCksIGJ1dCB3aWxsIHlpZWxkIGRheSBudW1iZXJzLiBGb3IgZGF5cyBvdXRzaWRlCiAgICAgICAgdGhlIHNwZWNpZmllZCBtb250aCB0aGUgZGF5IG51bWJlciBpcyAwLgogICAgICAgICIiIgogICAgICAgIGZvciBkYXRlIGluIHNlbGYuaXRlcm1vbnRoZGF0ZXMoeWVhciwgbW9udGgpOgogICAgICAgICAgICBpZiBkYXRlLm1vbnRoICE9IG1vbnRoOgogICAgICAgICAgICAgICAgeWllbGQgMAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgeWllbGQgZGF0ZS5kYXkKCiAgICBkZWYgbW9udGhkYXRlc2NhbGVuZGFyKHNlbGYsIHllYXIsIG1vbnRoKToKICAgICAgICAiIiIKICAgICAgICBSZXR1cm4gYSBtYXRyaXggKGxpc3Qgb2YgbGlzdHMpIHJlcHJlc2VudGluZyBhIG1vbnRoJ3MgY2FsZW5kYXIuCiAgICAgICAgRWFjaCByb3cgcmVwcmVzZW50cyBhIHdlZWs7IHdlZWsgZW50cmllcyBhcmUgZGF0ZXRpbWUuZGF0ZSB2YWx1ZXMuCiAgICAgICAgIiIiCiAgICAgICAgZGF0ZXMgPSBsaXN0KHNlbGYuaXRlcm1vbnRoZGF0ZXMoeWVhciwgbW9udGgpKQogICAgICAgIHJldHVybiBbIGRhdGVzW2k6aSs3XSBmb3IgaSBpbiByYW5nZSgwLCBsZW4oZGF0ZXMpLCA3KSBdCgogICAgZGVmIG1vbnRoZGF5czJjYWxlbmRhcihzZWxmLCB5ZWFyLCBtb250aCk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJuIGEgbWF0cml4IHJlcHJlc2VudGluZyBhIG1vbnRoJ3MgY2FsZW5kYXIuCiAgICAgICAgRWFjaCByb3cgcmVwcmVzZW50cyBhIHdlZWs7IHdlZWsgZW50cmllcyBhcmUKICAgICAgICAoZGF5IG51bWJlciwgd2Vla2RheSBudW1iZXIpIHR1cGxlcy4gRGF5IG51bWJlcnMgb3V0c2lkZSB0aGlzIG1vbnRoCiAgICAgICAgYXJlIHplcm8uCiAgICAgICAgIiIiCiAgICAgICAgZGF5cyA9IGxpc3Qoc2VsZi5pdGVybW9udGhkYXlzMih5ZWFyLCBtb250aCkpCiAgICAgICAgcmV0dXJuIFsgZGF5c1tpOmkrN10gZm9yIGkgaW4gcmFuZ2UoMCwgbGVuKGRheXMpLCA3KSBdCgogICAgZGVmIG1vbnRoZGF5c2NhbGVuZGFyKHNlbGYsIHllYXIsIG1vbnRoKToKICAgICAgICAiIiIKICAgICAgICBSZXR1cm4gYSBtYXRyaXggcmVwcmVzZW50aW5nIGEgbW9udGgncyBjYWxlbmRhci4KICAgICAgICBFYWNoIHJvdyByZXByZXNlbnRzIGEgd2VlazsgZGF5cyBvdXRzaWRlIHRoaXMgbW9udGggYXJlIHplcm8uCiAgICAgICAgIiIiCiAgICAgICAgZGF5cyA9IGxpc3Qoc2VsZi5pdGVybW9udGhkYXlzKHllYXIsIG1vbnRoKSkKICAgICAgICByZXR1cm4gWyBkYXlzW2k6aSs3XSBmb3IgaSBpbiByYW5nZSgwLCBsZW4oZGF5cyksIDcpIF0KCiAgICBkZWYgeWVhcmRhdGVzY2FsZW5kYXIoc2VsZiwgeWVhciwgd2lkdGg9Myk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJuIHRoZSBkYXRhIGZvciB0aGUgc3BlY2lmaWVkIHllYXIgcmVhZHkgZm9yIGZvcm1hdHRpbmcuIFRoZSByZXR1cm4KICAgICAgICB2YWx1ZSBpcyBhIGxpc3Qgb2YgbW9udGggcm93cy4gRWFjaCBtb250aCByb3cgY29udGFpbnMgdXB0byB3aWR0aCBtb250aHMuCiAgICAgICAgRWFjaCBtb250aCBjb250YWlucyBiZXR3ZWVuIDQgYW5kIDYgd2Vla3MgYW5kIGVhY2ggd2VlayBjb250YWlucyAxLTcKICAgICAgICBkYXlzLiBEYXlzIGFyZSBkYXRldGltZS5kYXRlIG9iamVjdHMuCiAgICAgICAgIiIiCiAgICAgICAgbW9udGhzID0gWwogICAgICAgICAgICBzZWxmLm1vbnRoZGF0ZXNjYWxlbmRhcih5ZWFyLCBpKQogICAgICAgICAgICBmb3IgaSBpbiByYW5nZShKYW51YXJ5LCBKYW51YXJ5KzEyKQogICAgICAgIF0KICAgICAgICByZXR1cm4gW21vbnRoc1tpOmkrd2lkdGhdIGZvciBpIGluIHJhbmdlKDAsIGxlbihtb250aHMpLCB3aWR0aCkgXQoKICAgIGRlZiB5ZWFyZGF5czJjYWxlbmRhcihzZWxmLCB5ZWFyLCB3aWR0aD0zKToKICAgICAgICAiIiIKICAgICAgICBSZXR1cm4gdGhlIGRhdGEgZm9yIHRoZSBzcGVjaWZpZWQgeWVhciByZWFkeSBmb3IgZm9ybWF0dGluZyAoc2ltaWxhciB0bwogICAgICAgIHllYXJkYXRlc2NhbGVuZGFyKCkpLiBFbnRyaWVzIGluIHRoZSB3ZWVrIGxpc3RzIGFyZQogICAgICAgIChkYXkgbnVtYmVyLCB3ZWVrZGF5IG51bWJlcikgdHVwbGVzLiBEYXkgbnVtYmVycyBvdXRzaWRlIHRoaXMgbW9udGggYXJlCiAgICAgICAgemVyby4KICAgICAgICAiIiIKICAgICAgICBtb250aHMgPSBbCiAgICAgICAgICAgIHNlbGYubW9udGhkYXlzMmNhbGVuZGFyKHllYXIsIGkpCiAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKEphbnVhcnksIEphbnVhcnkrMTIpCiAgICAgICAgXQogICAgICAgIHJldHVybiBbbW9udGhzW2k6aSt3aWR0aF0gZm9yIGkgaW4gcmFuZ2UoMCwgbGVuKG1vbnRocyksIHdpZHRoKSBdCgogICAgZGVmIHllYXJkYXlzY2FsZW5kYXIoc2VsZiwgeWVhciwgd2lkdGg9Myk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJuIHRoZSBkYXRhIGZvciB0aGUgc3BlY2lmaWVkIHllYXIgcmVhZHkgZm9yIGZvcm1hdHRpbmcgKHNpbWlsYXIgdG8KICAgICAgICB5ZWFyZGF0ZXNjYWxlbmRhcigpKS4gRW50cmllcyBpbiB0aGUgd2VlayBsaXN0cyBhcmUgZGF5IG51bWJlcnMuCiAgICAgICAgRGF5IG51bWJlcnMgb3V0c2lkZSB0aGlzIG1vbnRoIGFyZSB6ZXJvLgogICAgICAgICIiIgogICAgICAgIG1vbnRocyA9IFsKICAgICAgICAgICAgc2VsZi5tb250aGRheXNjYWxlbmRhcih5ZWFyLCBpKQogICAgICAgICAgICBmb3IgaSBpbiByYW5nZShKYW51YXJ5LCBKYW51YXJ5KzEyKQogICAgICAgIF0KICAgICAgICByZXR1cm4gW21vbnRoc1tpOmkrd2lkdGhdIGZvciBpIGluIHJhbmdlKDAsIGxlbihtb250aHMpLCB3aWR0aCkgXQoKCmNsYXNzIFRleHRDYWxlbmRhcihDYWxlbmRhcik6CiAgICAiIiIKICAgIFN1YmNsYXNzIG9mIENhbGVuZGFyIHRoYXQgb3V0cHV0cyBhIGNhbGVuZGFyIGFzIGEgc2ltcGxlIHBsYWluIHRleHQKICAgIHNpbWlsYXIgdG8gdGhlIFVOSVggcHJvZ3JhbSBjYWwuCiAgICAiIiIKCiAgICBkZWYgcHJ3ZWVrKHNlbGYsIHRoZXdlZWssIHdpZHRoKToKICAgICAgICAiIiIKICAgICAgICBQcmludCBhIHNpbmdsZSB3ZWVrIChubyBuZXdsaW5lKS4KICAgICAgICAiIiIKICAgICAgICBwcmludChzZWxmLmZvcm1hdHdlZWsodGhld2Vlaywgd2lkdGgpLCBlbmQ9JyAnKQoKICAgIGRlZiBmb3JtYXRkYXkoc2VsZiwgZGF5LCB3ZWVrZGF5LCB3aWR0aCk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJucyBhIGZvcm1hdHRlZCBkYXkuCiAgICAgICAgIiIiCiAgICAgICAgaWYgZGF5ID09IDA6CiAgICAgICAgICAgIHMgPSAnJwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHMgPSAnJTJpJyAlIGRheSAgICAgICAgICAgICAjIHJpZ2h0LWFsaWduIHNpbmdsZS1kaWdpdCBkYXlzCiAgICAgICAgcmV0dXJuIHMuY2VudGVyKHdpZHRoKQoKICAgIGRlZiBmb3JtYXR3ZWVrKHNlbGYsIHRoZXdlZWssIHdpZHRoKToKICAgICAgICAiIiIKICAgICAgICBSZXR1cm5zIGEgc2luZ2xlIHdlZWsgaW4gYSBzdHJpbmcgKG5vIG5ld2xpbmUpLgogICAgICAgICIiIgogICAgICAgIHJldHVybiAnICcuam9pbihzZWxmLmZvcm1hdGRheShkLCB3ZCwgd2lkdGgpIGZvciAoZCwgd2QpIGluIHRoZXdlZWspCgogICAgZGVmIGZvcm1hdHdlZWtkYXkoc2VsZiwgZGF5LCB3aWR0aCk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJucyBhIGZvcm1hdHRlZCB3ZWVrIGRheSBuYW1lLgogICAgICAgICIiIgogICAgICAgIGlmIHdpZHRoID49IDk6CiAgICAgICAgICAgIG5hbWVzID0gZGF5X25hbWUKICAgICAgICBlbHNlOgogICAgICAgICAgICBuYW1lcyA9IGRheV9hYmJyCiAgICAgICAgcmV0dXJuIG5hbWVzW2RheV1bOndpZHRoXS5jZW50ZXIod2lkdGgpCgogICAgZGVmIGZvcm1hdHdlZWtoZWFkZXIoc2VsZiwgd2lkdGgpOgogICAgICAgICIiIgogICAgICAgIFJldHVybiBhIGhlYWRlciBmb3IgYSB3ZWVrLgogICAgICAgICIiIgogICAgICAgIHJldHVybiAnICcuam9pbihzZWxmLmZvcm1hdHdlZWtkYXkoaSwgd2lkdGgpIGZvciBpIGluIHNlbGYuaXRlcndlZWtkYXlzKCkpCgogICAgZGVmIGZvcm1hdG1vbnRobmFtZShzZWxmLCB0aGV5ZWFyLCB0aGVtb250aCwgd2lkdGgsIHdpdGh5ZWFyPVRydWUpOgogICAgICAgICIiIgogICAgICAgIFJldHVybiBhIGZvcm1hdHRlZCBtb250aCBuYW1lLgogICAgICAgICIiIgogICAgICAgIHMgPSBtb250aF9uYW1lW3RoZW1vbnRoXQogICAgICAgIGlmIHdpdGh5ZWFyOgogICAgICAgICAgICBzID0gIiVzICVyIiAlIChzLCB0aGV5ZWFyKQogICAgICAgIHJldHVybiBzLmNlbnRlcih3aWR0aCkKCiAgICBkZWYgcHJtb250aChzZWxmLCB0aGV5ZWFyLCB0aGVtb250aCwgdz0wLCBsPTApOgogICAgICAgICIiIgogICAgICAgIFByaW50IGEgbW9udGgncyBjYWxlbmRhci4KICAgICAgICAiIiIKICAgICAgICBwcmludChzZWxmLmZvcm1hdG1vbnRoKHRoZXllYXIsIHRoZW1vbnRoLCB3LCBsKSwgZW5kPScgJykKCiAgICBkZWYgZm9ybWF0bW9udGgoc2VsZiwgdGhleWVhciwgdGhlbW9udGgsIHc9MCwgbD0wKToKICAgICAgICAiIiIKICAgICAgICBSZXR1cm4gYSBtb250aCdzIGNhbGVuZGFyIHN0cmluZyAobXVsdGktbGluZSkuCiAgICAgICAgIiIiCiAgICAgICAgdyA9IG1heCgyLCB3KQogICAgICAgIGwgPSBtYXgoMSwgbCkKICAgICAgICBzID0gc2VsZi5mb3JtYXRtb250aG5hbWUodGhleWVhciwgdGhlbW9udGgsIDcgKiAodyArIDEpIC0gMSkKICAgICAgICBzID0gcy5yc3RyaXAoKQogICAgICAgIHMgKz0gJ1xuJyAqIGwKICAgICAgICBzICs9IHNlbGYuZm9ybWF0d2Vla2hlYWRlcih3KS5yc3RyaXAoKQogICAgICAgIHMgKz0gJ1xuJyAqIGwKICAgICAgICBmb3Igd2VlayBpbiBzZWxmLm1vbnRoZGF5czJjYWxlbmRhcih0aGV5ZWFyLCB0aGVtb250aCk6CiAgICAgICAgICAgIHMgKz0gc2VsZi5mb3JtYXR3ZWVrKHdlZWssIHcpLnJzdHJpcCgpCiAgICAgICAgICAgIHMgKz0gJ1xuJyAqIGwKICAgICAgICByZXR1cm4gcwoKICAgIGRlZiBmb3JtYXR5ZWFyKHNlbGYsIHRoZXllYXIsIHc9MiwgbD0xLCBjPTYsIG09Myk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJucyBhIHllYXIncyBjYWxlbmRhciBhcyBhIG11bHRpLWxpbmUgc3RyaW5nLgogICAgICAgICIiIgogICAgICAgIHcgPSBtYXgoMiwgdykKICAgICAgICBsID0gbWF4KDEsIGwpCiAgICAgICAgYyA9IG1heCgyLCBjKQogICAgICAgIGNvbHdpZHRoID0gKHcgKyAxKSAqIDcgLSAxCiAgICAgICAgdiA9IFtdCiAgICAgICAgYSA9IHYuYXBwZW5kCiAgICAgICAgYShyZXByKHRoZXllYXIpLmNlbnRlcihjb2x3aWR0aCptK2MqKG0tMSkpLnJzdHJpcCgpKQogICAgICAgIGEoJ1xuJypsKQogICAgICAgIGhlYWRlciA9IHNlbGYuZm9ybWF0d2Vla2hlYWRlcih3KQogICAgICAgIGZvciAoaSwgcm93KSBpbiBlbnVtZXJhdGUoc2VsZi55ZWFyZGF5czJjYWxlbmRhcih0aGV5ZWFyLCBtKSk6CiAgICAgICAgICAgICMgbW9udGhzIGluIHRoaXMgcm93CiAgICAgICAgICAgIG1vbnRocyA9IHJhbmdlKG0qaSsxLCBtaW4obSooaSsxKSsxLCAxMykpCiAgICAgICAgICAgIGEoJ1xuJypsKQogICAgICAgICAgICBuYW1lcyA9IChzZWxmLmZvcm1hdG1vbnRobmFtZSh0aGV5ZWFyLCBrLCBjb2x3aWR0aCwgRmFsc2UpCiAgICAgICAgICAgICAgICAgICAgIGZvciBrIGluIG1vbnRocykKICAgICAgICAgICAgYShmb3JtYXRzdHJpbmcobmFtZXMsIGNvbHdpZHRoLCBjKS5yc3RyaXAoKSkKICAgICAgICAgICAgYSgnXG4nKmwpCiAgICAgICAgICAgIGhlYWRlcnMgPSAoaGVhZGVyIGZvciBrIGluIG1vbnRocykKICAgICAgICAgICAgYShmb3JtYXRzdHJpbmcoaGVhZGVycywgY29sd2lkdGgsIGMpLnJzdHJpcCgpKQogICAgICAgICAgICBhKCdcbicqbCkKICAgICAgICAgICAgIyBtYXggbnVtYmVyIG9mIHdlZWtzIGZvciB0aGlzIHJvdwogICAgICAgICAgICBoZWlnaHQgPSBtYXgobGVuKGNhbCkgZm9yIGNhbCBpbiByb3cpCiAgICAgICAgICAgIGZvciBqIGluIHJhbmdlKGhlaWdodCk6CiAgICAgICAgICAgICAgICB3ZWVrcyA9IFtdCiAgICAgICAgICAgICAgICBmb3IgY2FsIGluIHJvdzoKICAgICAgICAgICAgICAgICAgICBpZiBqID49IGxlbihjYWwpOgogICAgICAgICAgICAgICAgICAgICAgICB3ZWVrcy5hcHBlbmQoJycpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgd2Vla3MuYXBwZW5kKHNlbGYuZm9ybWF0d2VlayhjYWxbal0sIHcpKQogICAgICAgICAgICAgICAgYShmb3JtYXRzdHJpbmcod2Vla3MsIGNvbHdpZHRoLCBjKS5yc3RyaXAoKSkKICAgICAgICAgICAgICAgIGEoJ1xuJyAqIGwpCiAgICAgICAgcmV0dXJuICcnLmpvaW4odikKCiAgICBkZWYgcHJ5ZWFyKHNlbGYsIHRoZXllYXIsIHc9MCwgbD0wLCBjPTYsIG09Myk6CiAgICAgICAgIiIiUHJpbnQgYSB5ZWFyJ3MgY2FsZW5kYXIuIiIiCiAgICAgICAgcHJpbnQoc2VsZi5mb3JtYXR5ZWFyKHRoZXllYXIsIHcsIGwsIGMsIG0pKQoKCmNsYXNzIEhUTUxDYWxlbmRhcihDYWxlbmRhcik6CiAgICAiIiIKICAgIFRoaXMgY2FsZW5kYXIgcmV0dXJucyBjb21wbGV0ZSBIVE1MIHBhZ2VzLgogICAgIiIiCgogICAgIyBDU1MgY2xhc3NlcyBmb3IgdGhlIGRheSA8dGQ+cwogICAgY3NzY2xhc3NlcyA9IFsibW9uIiwgInR1ZSIsICJ3ZWQiLCAidGh1IiwgImZyaSIsICJzYXQiLCAic3VuIl0KCiAgICBkZWYgZm9ybWF0ZGF5KHNlbGYsIGRheSwgd2Vla2RheSk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJuIGEgZGF5IGFzIGEgdGFibGUgY2VsbC4KICAgICAgICAiIiIKICAgICAgICBpZiBkYXkgPT0gMDoKICAgICAgICAgICAgcmV0dXJuICc8dGQgY2xhc3M9Im5vZGF5Ij4mbmJzcDs8L3RkPicgIyBkYXkgb3V0c2lkZSBtb250aAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiAnPHRkIGNsYXNzPSIlcyI+JWQ8L3RkPicgJSAoc2VsZi5jc3NjbGFzc2VzW3dlZWtkYXldLCBkYXkpCgogICAgZGVmIGZvcm1hdHdlZWsoc2VsZiwgdGhld2Vlayk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJuIGEgY29tcGxldGUgd2VlayBhcyBhIHRhYmxlIHJvdy4KICAgICAgICAiIiIKICAgICAgICBzID0gJycuam9pbihzZWxmLmZvcm1hdGRheShkLCB3ZCkgZm9yIChkLCB3ZCkgaW4gdGhld2VlaykKICAgICAgICByZXR1cm4gJzx0cj4lczwvdHI+JyAlIHMKCiAgICBkZWYgZm9ybWF0d2Vla2RheShzZWxmLCBkYXkpOgogICAgICAgICIiIgogICAgICAgIFJldHVybiBhIHdlZWtkYXkgbmFtZSBhcyBhIHRhYmxlIGhlYWRlci4KICAgICAgICAiIiIKICAgICAgICByZXR1cm4gJzx0aCBjbGFzcz0iJXMiPiVzPC90aD4nICUgKHNlbGYuY3NzY2xhc3Nlc1tkYXldLCBkYXlfYWJicltkYXldKQoKICAgIGRlZiBmb3JtYXR3ZWVraGVhZGVyKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIFJldHVybiBhIGhlYWRlciBmb3IgYSB3ZWVrIGFzIGEgdGFibGUgcm93LgogICAgICAgICIiIgogICAgICAgIHMgPSAnJy5qb2luKHNlbGYuZm9ybWF0d2Vla2RheShpKSBmb3IgaSBpbiBzZWxmLml0ZXJ3ZWVrZGF5cygpKQogICAgICAgIHJldHVybiAnPHRyPiVzPC90cj4nICUgcwoKICAgIGRlZiBmb3JtYXRtb250aG5hbWUoc2VsZiwgdGhleWVhciwgdGhlbW9udGgsIHdpdGh5ZWFyPVRydWUpOgogICAgICAgICIiIgogICAgICAgIFJldHVybiBhIG1vbnRoIG5hbWUgYXMgYSB0YWJsZSByb3cuCiAgICAgICAgIiIiCiAgICAgICAgaWYgd2l0aHllYXI6CiAgICAgICAgICAgIHMgPSAnJXMgJXMnICUgKG1vbnRoX25hbWVbdGhlbW9udGhdLCB0aGV5ZWFyKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHMgPSAnJXMnICUgbW9udGhfbmFtZVt0aGVtb250aF0KICAgICAgICByZXR1cm4gJzx0cj48dGggY29sc3Bhbj0iNyIgY2xhc3M9Im1vbnRoIj4lczwvdGg+PC90cj4nICUgcwoKICAgIGRlZiBmb3JtYXRtb250aChzZWxmLCB0aGV5ZWFyLCB0aGVtb250aCwgd2l0aHllYXI9VHJ1ZSk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJuIGEgZm9ybWF0dGVkIG1vbnRoIGFzIGEgdGFibGUuCiAgICAgICAgIiIiCiAgICAgICAgdiA9IFtdCiAgICAgICAgYSA9IHYuYXBwZW5kCiAgICAgICAgYSgnPHRhYmxlIGJvcmRlcj0iMCIgY2VsbHBhZGRpbmc9IjAiIGNlbGxzcGFjaW5nPSIwIiBjbGFzcz0ibW9udGgiPicpCiAgICAgICAgYSgnXG4nKQogICAgICAgIGEoc2VsZi5mb3JtYXRtb250aG5hbWUodGhleWVhciwgdGhlbW9udGgsIHdpdGh5ZWFyPXdpdGh5ZWFyKSkKICAgICAgICBhKCdcbicpCiAgICAgICAgYShzZWxmLmZvcm1hdHdlZWtoZWFkZXIoKSkKICAgICAgICBhKCdcbicpCiAgICAgICAgZm9yIHdlZWsgaW4gc2VsZi5tb250aGRheXMyY2FsZW5kYXIodGhleWVhciwgdGhlbW9udGgpOgogICAgICAgICAgICBhKHNlbGYuZm9ybWF0d2Vlayh3ZWVrKSkKICAgICAgICAgICAgYSgnXG4nKQogICAgICAgIGEoJzwvdGFibGU+JykKICAgICAgICBhKCdcbicpCiAgICAgICAgcmV0dXJuICcnLmpvaW4odikKCiAgICBkZWYgZm9ybWF0eWVhcihzZWxmLCB0aGV5ZWFyLCB3aWR0aD0zKToKICAgICAgICAiIiIKICAgICAgICBSZXR1cm4gYSBmb3JtYXR0ZWQgeWVhciBhcyBhIHRhYmxlIG9mIHRhYmxlcy4KICAgICAgICAiIiIKICAgICAgICB2ID0gW10KICAgICAgICBhID0gdi5hcHBlbmQKICAgICAgICB3aWR0aCA9IG1heCh3aWR0aCwgMSkKICAgICAgICBhKCc8dGFibGUgYm9yZGVyPSIwIiBjZWxscGFkZGluZz0iMCIgY2VsbHNwYWNpbmc9IjAiIGNsYXNzPSJ5ZWFyIj4nKQogICAgICAgIGEoJ1xuJykKICAgICAgICBhKCc8dHI+PHRoIGNvbHNwYW49IiVkIiBjbGFzcz0ieWVhciI+JXM8L3RoPjwvdHI+JyAlICh3aWR0aCwgdGhleWVhcikpCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UoSmFudWFyeSwgSmFudWFyeSsxMiwgd2lkdGgpOgogICAgICAgICAgICAjIG1vbnRocyBpbiB0aGlzIHJvdwogICAgICAgICAgICBtb250aHMgPSByYW5nZShpLCBtaW4oaSt3aWR0aCwgMTMpKQogICAgICAgICAgICBhKCc8dHI+JykKICAgICAgICAgICAgZm9yIG0gaW4gbW9udGhzOgogICAgICAgICAgICAgICAgYSgnPHRkPicpCiAgICAgICAgICAgICAgICBhKHNlbGYuZm9ybWF0bW9udGgodGhleWVhciwgbSwgd2l0aHllYXI9RmFsc2UpKQogICAgICAgICAgICAgICAgYSgnPC90ZD4nKQogICAgICAgICAgICBhKCc8L3RyPicpCiAgICAgICAgYSgnPC90YWJsZT4nKQogICAgICAgIHJldHVybiAnJy5qb2luKHYpCgogICAgZGVmIGZvcm1hdHllYXJwYWdlKHNlbGYsIHRoZXllYXIsIHdpZHRoPTMsIGNzcz0nY2FsZW5kYXIuY3NzJywgZW5jb2Rpbmc9Tm9uZSk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJuIGEgZm9ybWF0dGVkIHllYXIgYXMgYSBjb21wbGV0ZSBIVE1MIHBhZ2UuCiAgICAgICAgIiIiCiAgICAgICAgaWYgZW5jb2RpbmcgaXMgTm9uZToKICAgICAgICAgICAgZW5jb2RpbmcgPSBzeXMuZ2V0ZGVmYXVsdGVuY29kaW5nKCkKICAgICAgICB2ID0gW10KICAgICAgICBhID0gdi5hcHBlbmQKICAgICAgICBhKCc8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSIlcyI/PlxuJyAlIGVuY29kaW5nKQogICAgICAgIGEoJzwhRE9DVFlQRSBodG1sIFBVQkxJQyAiLS8vVzNDLy9EVEQgWEhUTUwgMS4wIFN0cmljdC8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9UUi94aHRtbDEvRFREL3hodG1sMS1zdHJpY3QuZHRkIj5cbicpCiAgICAgICAgYSgnPGh0bWw+XG4nKQogICAgICAgIGEoJzxoZWFkPlxuJykKICAgICAgICBhKCc8bWV0YSBodHRwLWVxdWl2PSJDb250ZW50LVR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD0lcyIgLz5cbicgJSBlbmNvZGluZykKICAgICAgICBpZiBjc3MgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGEoJzxsaW5rIHJlbD0ic3R5bGVzaGVldCIgdHlwZT0idGV4dC9jc3MiIGhyZWY9IiVzIiAvPlxuJyAlIGNzcykKICAgICAgICBhKCc8dGl0bGU+Q2FsZW5kYXIgZm9yICVkPC90aXRsZT5cbicgJSB0aGV5ZWFyKQogICAgICAgIGEoJzwvaGVhZD5cbicpCiAgICAgICAgYSgnPGJvZHk+XG4nKQogICAgICAgIGEoc2VsZi5mb3JtYXR5ZWFyKHRoZXllYXIsIHdpZHRoKSkKICAgICAgICBhKCc8L2JvZHk+XG4nKQogICAgICAgIGEoJzwvaHRtbD5cbicpCiAgICAgICAgcmV0dXJuICcnLmpvaW4odikuZW5jb2RlKGVuY29kaW5nLCAieG1sY2hhcnJlZnJlcGxhY2UiKQoKCmNsYXNzIGRpZmZlcmVudF9sb2NhbGU6CiAgICBkZWYgX19pbml0X18oc2VsZiwgbG9jYWxlKToKICAgICAgICBzZWxmLmxvY2FsZSA9IGxvY2FsZQoKICAgIGRlZiBfX2VudGVyX18oc2VsZik6CiAgICAgICAgc2VsZi5vbGRsb2NhbGUgPSBfbG9jYWxlLmdldGxvY2FsZShfbG9jYWxlLkxDX1RJTUUpCiAgICAgICAgX2xvY2FsZS5zZXRsb2NhbGUoX2xvY2FsZS5MQ19USU1FLCBzZWxmLmxvY2FsZSkKCiAgICBkZWYgX19leGl0X18oc2VsZiwgKmFyZ3MpOgogICAgICAgIF9sb2NhbGUuc2V0bG9jYWxlKF9sb2NhbGUuTENfVElNRSwgc2VsZi5vbGRsb2NhbGUpCgoKY2xhc3MgTG9jYWxlVGV4dENhbGVuZGFyKFRleHRDYWxlbmRhcik6CiAgICAiIiIKICAgIFRoaXMgY2xhc3MgY2FuIGJlIHBhc3NlZCBhIGxvY2FsZSBuYW1lIGluIHRoZSBjb25zdHJ1Y3RvciBhbmQgd2lsbCByZXR1cm4KICAgIG1vbnRoIGFuZCB3ZWVrZGF5IG5hbWVzIGluIHRoZSBzcGVjaWZpZWQgbG9jYWxlLiBJZiB0aGlzIGxvY2FsZSBpbmNsdWRlcwogICAgYW4gZW5jb2RpbmcgYWxsIHN0cmluZ3MgY29udGFpbmluZyBtb250aCBhbmQgd2Vla2RheSBuYW1lcyB3aWxsIGJlIHJldHVybmVkCiAgICBhcyB1bmljb2RlLgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGZpcnN0d2Vla2RheT0wLCBsb2NhbGU9Tm9uZSk6CiAgICAgICAgVGV4dENhbGVuZGFyLl9faW5pdF9fKHNlbGYsIGZpcnN0d2Vla2RheSkKICAgICAgICBpZiBsb2NhbGUgaXMgTm9uZToKICAgICAgICAgICAgbG9jYWxlID0gX2xvY2FsZS5nZXRkZWZhdWx0bG9jYWxlKCkKICAgICAgICBzZWxmLmxvY2FsZSA9IGxvY2FsZQoKICAgIGRlZiBmb3JtYXR3ZWVrZGF5KHNlbGYsIGRheSwgd2lkdGgpOgogICAgICAgIHdpdGggZGlmZmVyZW50X2xvY2FsZShzZWxmLmxvY2FsZSk6CiAgICAgICAgICAgIGlmIHdpZHRoID49IDk6CiAgICAgICAgICAgICAgICBuYW1lcyA9IGRheV9uYW1lCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBuYW1lcyA9IGRheV9hYmJyCiAgICAgICAgICAgIG5hbWUgPSBuYW1lc1tkYXldCiAgICAgICAgICAgIHJldHVybiBuYW1lWzp3aWR0aF0uY2VudGVyKHdpZHRoKQoKICAgIGRlZiBmb3JtYXRtb250aG5hbWUoc2VsZiwgdGhleWVhciwgdGhlbW9udGgsIHdpZHRoLCB3aXRoeWVhcj1UcnVlKToKICAgICAgICB3aXRoIGRpZmZlcmVudF9sb2NhbGUoc2VsZi5sb2NhbGUpOgogICAgICAgICAgICBzID0gbW9udGhfbmFtZVt0aGVtb250aF0KICAgICAgICAgICAgaWYgd2l0aHllYXI6CiAgICAgICAgICAgICAgICBzID0gIiVzICVyIiAlIChzLCB0aGV5ZWFyKQogICAgICAgICAgICByZXR1cm4gcy5jZW50ZXIod2lkdGgpCgoKY2xhc3MgTG9jYWxlSFRNTENhbGVuZGFyKEhUTUxDYWxlbmRhcik6CiAgICAiIiIKICAgIFRoaXMgY2xhc3MgY2FuIGJlIHBhc3NlZCBhIGxvY2FsZSBuYW1lIGluIHRoZSBjb25zdHJ1Y3RvciBhbmQgd2lsbCByZXR1cm4KICAgIG1vbnRoIGFuZCB3ZWVrZGF5IG5hbWVzIGluIHRoZSBzcGVjaWZpZWQgbG9jYWxlLiBJZiB0aGlzIGxvY2FsZSBpbmNsdWRlcwogICAgYW4gZW5jb2RpbmcgYWxsIHN0cmluZ3MgY29udGFpbmluZyBtb250aCBhbmQgd2Vla2RheSBuYW1lcyB3aWxsIGJlIHJldHVybmVkCiAgICBhcyB1bmljb2RlLgogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgZmlyc3R3ZWVrZGF5PTAsIGxvY2FsZT1Ob25lKToKICAgICAgICBIVE1MQ2FsZW5kYXIuX19pbml0X18oc2VsZiwgZmlyc3R3ZWVrZGF5KQogICAgICAgIGlmIGxvY2FsZSBpcyBOb25lOgogICAgICAgICAgICBsb2NhbGUgPSBfbG9jYWxlLmdldGRlZmF1bHRsb2NhbGUoKQogICAgICAgIHNlbGYubG9jYWxlID0gbG9jYWxlCgogICAgZGVmIGZvcm1hdHdlZWtkYXkoc2VsZiwgZGF5KToKICAgICAgICB3aXRoIGRpZmZlcmVudF9sb2NhbGUoc2VsZi5sb2NhbGUpOgogICAgICAgICAgICBzID0gZGF5X2FiYnJbZGF5XQogICAgICAgICAgICByZXR1cm4gJzx0aCBjbGFzcz0iJXMiPiVzPC90aD4nICUgKHNlbGYuY3NzY2xhc3Nlc1tkYXldLCBzKQoKICAgIGRlZiBmb3JtYXRtb250aG5hbWUoc2VsZiwgdGhleWVhciwgdGhlbW9udGgsIHdpdGh5ZWFyPVRydWUpOgogICAgICAgIHdpdGggZGlmZmVyZW50X2xvY2FsZShzZWxmLmxvY2FsZSk6CiAgICAgICAgICAgIHMgPSBtb250aF9uYW1lW3RoZW1vbnRoXQogICAgICAgICAgICBpZiB3aXRoeWVhcjoKICAgICAgICAgICAgICAgIHMgPSAnJXMgJXMnICUgKHMsIHRoZXllYXIpCiAgICAgICAgICAgIHJldHVybiAnPHRyPjx0aCBjb2xzcGFuPSI3IiBjbGFzcz0ibW9udGgiPiVzPC90aD48L3RyPicgJSBzCgoKIyBTdXBwb3J0IGZvciBvbGQgbW9kdWxlIGxldmVsIGludGVyZmFjZQpjID0gVGV4dENhbGVuZGFyKCkKCmZpcnN0d2Vla2RheSA9IGMuZ2V0Zmlyc3R3ZWVrZGF5CgpkZWYgc2V0Zmlyc3R3ZWVrZGF5KGZpcnN0d2Vla2RheSk6CiAgICBpZiBub3QgTU9OREFZIDw9IGZpcnN0d2Vla2RheSA8PSBTVU5EQVk6CiAgICAgICAgcmFpc2UgSWxsZWdhbFdlZWtkYXlFcnJvcihmaXJzdHdlZWtkYXkpCiAgICBjLmZpcnN0d2Vla2RheSA9IGZpcnN0d2Vla2RheQoKbW9udGhjYWxlbmRhciA9IGMubW9udGhkYXlzY2FsZW5kYXIKcHJ3ZWVrID0gYy5wcndlZWsKd2VlayA9IGMuZm9ybWF0d2Vlawp3ZWVraGVhZGVyID0gYy5mb3JtYXR3ZWVraGVhZGVyCnBybW9udGggPSBjLnBybW9udGgKbW9udGggPSBjLmZvcm1hdG1vbnRoCmNhbGVuZGFyID0gYy5mb3JtYXR5ZWFyCnByY2FsID0gYy5wcnllYXIKCgojIFNwYWNpbmcgb2YgbW9udGggY29sdW1ucyBmb3IgbXVsdGktY29sdW1uIHllYXIgY2FsZW5kYXIKX2NvbHdpZHRoID0gNyozIC0gMSAgICAgICAgICMgQW1vdW50IHByaW50ZWQgYnkgcHJ3ZWVrKCkKX3NwYWNpbmcgPSA2ICAgICAgICAgICAgICAgICMgTnVtYmVyIG9mIHNwYWNlcyBiZXR3ZWVuIGNvbHVtbnMKCgpkZWYgZm9ybWF0KGNvbHMsIGNvbHdpZHRoPV9jb2x3aWR0aCwgc3BhY2luZz1fc3BhY2luZyk6CiAgICAiIiJQcmludHMgbXVsdGktY29sdW1uIGZvcm1hdHRpbmcgZm9yIHllYXIgY2FsZW5kYXJzIiIiCiAgICBwcmludChmb3JtYXRzdHJpbmcoY29scywgY29sd2lkdGgsIHNwYWNpbmcpKQoKCmRlZiBmb3JtYXRzdHJpbmcoY29scywgY29sd2lkdGg9X2NvbHdpZHRoLCBzcGFjaW5nPV9zcGFjaW5nKToKICAgICIiIlJldHVybnMgYSBzdHJpbmcgZm9ybWF0dGVkIGZyb20gbiBzdHJpbmdzLCBjZW50ZXJlZCB3aXRoaW4gbiBjb2x1bW5zLiIiIgogICAgc3BhY2luZyAqPSAnICcKICAgIHJldHVybiBzcGFjaW5nLmpvaW4oYy5jZW50ZXIoY29sd2lkdGgpIGZvciBjIGluIGNvbHMpCgoKRVBPQ0ggPSAxOTcwCl9FUE9DSF9PUkQgPSBkYXRldGltZS5kYXRlKEVQT0NILCAxLCAxKS50b29yZGluYWwoKQoKCmRlZiB0aW1lZ20odHVwbGUpOgogICAgIiIiVW5yZWxhdGVkIGJ1dCBoYW5keSBmdW5jdGlvbiB0byBjYWxjdWxhdGUgVW5peCB0aW1lc3RhbXAgZnJvbSBHTVQuIiIiCiAgICB5ZWFyLCBtb250aCwgZGF5LCBob3VyLCBtaW51dGUsIHNlY29uZCA9IHR1cGxlWzo2XQogICAgZGF5cyA9IGRhdGV0aW1lLmRhdGUoeWVhciwgbW9udGgsIDEpLnRvb3JkaW5hbCgpIC0gX0VQT0NIX09SRCArIGRheSAtIDEKICAgIGhvdXJzID0gZGF5cyoyNCArIGhvdXIKICAgIG1pbnV0ZXMgPSBob3Vycyo2MCArIG1pbnV0ZQogICAgc2Vjb25kcyA9IG1pbnV0ZXMqNjAgKyBzZWNvbmQKICAgIHJldHVybiBzZWNvbmRzCgoKZGVmIG1haW4oYXJncyk6CiAgICBpbXBvcnQgb3B0cGFyc2UKICAgIHBhcnNlciA9IG9wdHBhcnNlLk9wdGlvblBhcnNlcih1c2FnZT0idXNhZ2U6ICVwcm9nIFtvcHRpb25zXSBbeWVhciBbbW9udGhdXSIpCiAgICBwYXJzZXIuYWRkX29wdGlvbigKICAgICAgICAiLXciLCAiLS13aWR0aCIsCiAgICAgICAgZGVzdD0id2lkdGgiLCB0eXBlPSJpbnQiLCBkZWZhdWx0PTIsCiAgICAgICAgaGVscD0id2lkdGggb2YgZGF0ZSBjb2x1bW4gKGRlZmF1bHQgMiwgdGV4dCBvbmx5KSIKICAgICkKICAgIHBhcnNlci5hZGRfb3B0aW9uKAogICAgICAgICItbCIsICItLWxpbmVzIiwKICAgICAgICBkZXN0PSJsaW5lcyIsIHR5cGU9ImludCIsIGRlZmF1bHQ9MSwKICAgICAgICBoZWxwPSJudW1iZXIgb2YgbGluZXMgZm9yIGVhY2ggd2VlayAoZGVmYXVsdCAxLCB0ZXh0IG9ubHkpIgogICAgKQogICAgcGFyc2VyLmFkZF9vcHRpb24oCiAgICAgICAgIi1zIiwgIi0tc3BhY2luZyIsCiAgICAgICAgZGVzdD0ic3BhY2luZyIsIHR5cGU9ImludCIsIGRlZmF1bHQ9NiwKICAgICAgICBoZWxwPSJzcGFjaW5nIGJldHdlZW4gbW9udGhzIChkZWZhdWx0IDYsIHRleHQgb25seSkiCiAgICApCiAgICBwYXJzZXIuYWRkX29wdGlvbigKICAgICAgICAiLW0iLCAiLS1tb250aHMiLAogICAgICAgIGRlc3Q9Im1vbnRocyIsIHR5cGU9ImludCIsIGRlZmF1bHQ9MywKICAgICAgICBoZWxwPSJtb250aHMgcGVyIHJvdyAoZGVmYXVsdCAzLCB0ZXh0IG9ubHkpIgogICAgKQogICAgcGFyc2VyLmFkZF9vcHRpb24oCiAgICAgICAgIi1jIiwgIi0tY3NzIiwKICAgICAgICBkZXN0PSJjc3MiLCBkZWZhdWx0PSJjYWxlbmRhci5jc3MiLAogICAgICAgIGhlbHA9IkNTUyB0byB1c2UgZm9yIHBhZ2UgKGh0bWwgb25seSkiCiAgICApCiAgICBwYXJzZXIuYWRkX29wdGlvbigKICAgICAgICAiLUwiLCAiLS1sb2NhbGUiLAogICAgICAgIGRlc3Q9ImxvY2FsZSIsIGRlZmF1bHQ9Tm9uZSwKICAgICAgICBoZWxwPSJsb2NhbGUgdG8gYmUgdXNlZCBmcm9tIG1vbnRoIGFuZCB3ZWVrZGF5IG5hbWVzIgogICAgKQogICAgcGFyc2VyLmFkZF9vcHRpb24oCiAgICAgICAgIi1lIiwgIi0tZW5jb2RpbmciLAogICAgICAgIGRlc3Q9ImVuY29kaW5nIiwgZGVmYXVsdD1Ob25lLAogICAgICAgIGhlbHA9IkVuY29kaW5nIHRvIHVzZSBmb3Igb3V0cHV0LiIKICAgICkKICAgIHBhcnNlci5hZGRfb3B0aW9uKAogICAgICAgICItdCIsICItLXR5cGUiLAogICAgICAgIGRlc3Q9InR5cGUiLCBkZWZhdWx0PSJ0ZXh0IiwKICAgICAgICBjaG9pY2VzPSgidGV4dCIsICJodG1sIiksCiAgICAgICAgaGVscD0ib3V0cHV0IHR5cGUgKHRleHQgb3IgaHRtbCkiCiAgICApCgogICAgKG9wdGlvbnMsIGFyZ3MpID0gcGFyc2VyLnBhcnNlX2FyZ3MoYXJncykKCiAgICBpZiBvcHRpb25zLmxvY2FsZSBhbmQgbm90IG9wdGlvbnMuZW5jb2Rpbmc6CiAgICAgICAgcGFyc2VyLmVycm9yKCJpZiAtLWxvY2FsZSBpcyBzcGVjaWZpZWQgLS1lbmNvZGluZyBpcyByZXF1aXJlZCIpCiAgICAgICAgc3lzLmV4aXQoMSkKCiAgICBsb2NhbGUgPSBvcHRpb25zLmxvY2FsZSwgb3B0aW9ucy5lbmNvZGluZwoKICAgIGlmIG9wdGlvbnMudHlwZSA9PSAiaHRtbCI6CiAgICAgICAgaWYgb3B0aW9ucy5sb2NhbGU6CiAgICAgICAgICAgIGNhbCA9IExvY2FsZUhUTUxDYWxlbmRhcihsb2NhbGU9bG9jYWxlKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNhbCA9IEhUTUxDYWxlbmRhcigpCiAgICAgICAgZW5jb2RpbmcgPSBvcHRpb25zLmVuY29kaW5nCiAgICAgICAgaWYgZW5jb2RpbmcgaXMgTm9uZToKICAgICAgICAgICAgZW5jb2RpbmcgPSBzeXMuZ2V0ZGVmYXVsdGVuY29kaW5nKCkKICAgICAgICBvcHRkaWN0ID0gZGljdChlbmNvZGluZz1lbmNvZGluZywgY3NzPW9wdGlvbnMuY3NzKQogICAgICAgIHdyaXRlID0gc3lzLnN0ZG91dC5idWZmZXIud3JpdGUKICAgICAgICBpZiBsZW4oYXJncykgPT0gMToKICAgICAgICAgICAgd3JpdGUoY2FsLmZvcm1hdHllYXJwYWdlKGRhdGV0aW1lLmRhdGUudG9kYXkoKS55ZWFyLCAqKm9wdGRpY3QpKQogICAgICAgIGVsaWYgbGVuKGFyZ3MpID09IDI6CiAgICAgICAgICAgIHdyaXRlKGNhbC5mb3JtYXR5ZWFycGFnZShpbnQoYXJnc1sxXSksICoqb3B0ZGljdCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcGFyc2VyLmVycm9yKCJpbmNvcnJlY3QgbnVtYmVyIG9mIGFyZ3VtZW50cyIpCiAgICAgICAgICAgIHN5cy5leGl0KDEpCiAgICBlbHNlOgogICAgICAgIGlmIG9wdGlvbnMubG9jYWxlOgogICAgICAgICAgICBjYWwgPSBMb2NhbGVUZXh0Q2FsZW5kYXIobG9jYWxlPWxvY2FsZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBjYWwgPSBUZXh0Q2FsZW5kYXIoKQogICAgICAgIG9wdGRpY3QgPSBkaWN0KHc9b3B0aW9ucy53aWR0aCwgbD1vcHRpb25zLmxpbmVzKQogICAgICAgIGlmIGxlbihhcmdzKSAhPSAzOgogICAgICAgICAgICBvcHRkaWN0WyJjIl0gPSBvcHRpb25zLnNwYWNpbmcKICAgICAgICAgICAgb3B0ZGljdFsibSJdID0gb3B0aW9ucy5tb250aHMKICAgICAgICBpZiBsZW4oYXJncykgPT0gMToKICAgICAgICAgICAgcmVzdWx0ID0gY2FsLmZvcm1hdHllYXIoZGF0ZXRpbWUuZGF0ZS50b2RheSgpLnllYXIsICoqb3B0ZGljdCkKICAgICAgICBlbGlmIGxlbihhcmdzKSA9PSAyOgogICAgICAgICAgICByZXN1bHQgPSBjYWwuZm9ybWF0eWVhcihpbnQoYXJnc1sxXSksICoqb3B0ZGljdCkKICAgICAgICBlbGlmIGxlbihhcmdzKSA9PSAzOgogICAgICAgICAgICByZXN1bHQgPSBjYWwuZm9ybWF0bW9udGgoaW50KGFyZ3NbMV0pLCBpbnQoYXJnc1syXSksICoqb3B0ZGljdCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwYXJzZXIuZXJyb3IoImluY29ycmVjdCBudW1iZXIgb2YgYXJndW1lbnRzIikKICAgICAgICAgICAgc3lzLmV4aXQoMSkKICAgICAgICB3cml0ZSA9IHN5cy5zdGRvdXQud3JpdGUKICAgICAgICBpZiBvcHRpb25zLmVuY29kaW5nOgogICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuZW5jb2RlKG9wdGlvbnMuZW5jb2RpbmcpCiAgICAgICAgICAgIHdyaXRlID0gc3lzLnN0ZG91dC5idWZmZXIud3JpdGUKICAgICAgICB3cml0ZShyZXN1bHQpCgoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIG1haW4oc3lzLmFyZ3YpCg==',
'/Lib/collections.py':'I19fYWxsX18gPSBbJ2RlcXVlJywgJ2RlZmF1bHRkaWN0JywgJ0NvdW50ZXInXQoKI2Zyb20gX2NvbGxlY3Rpb25zIGltcG9ydCBkZXF1ZSwgZGVmYXVsdGRpY3QKCiNmcm9tIGl0ZXJ0b29scyBpbXBvcnQgcmVwZWF0IGFzIF9yZXBlYXQsIGNoYWluIGFzIF9jaGFpbiwgc3Rhcm1hcCBhcyBfc3Rhcm1hcAoKX19hbGxfXyA9IFsnZGVxdWUnLCAnZGVmYXVsdGRpY3QnLCAnbmFtZWR0dXBsZScsICdVc2VyRGljdCcsICdVc2VyTGlzdCcsCiAgICAgICAgICAgICdVc2VyU3RyaW5nJywgJ0NvdW50ZXInLCAnT3JkZXJlZERpY3QnXQojIEZvciBib290c3RyYXBwaW5nIHJlYXNvbnMsIHRoZSBjb2xsZWN0aW9uIEFCQ3MgYXJlIGRlZmluZWQgaW4gX2FiY29sbC5weS4KIyBUaGV5IHNob3VsZCBob3dldmVyIGJlIGNvbnNpZGVyZWQgYW4gaW50ZWdyYWwgcGFydCBvZiBjb2xsZWN0aW9ucy5weS4KCiMgZml4bWUgYnJ5dGhvbi4uIHRoZXJlIGlzIGFuIGlzc3VlIHdpdGggX2FiY29sbAojZnJvbSBfYWJjb2xsIGltcG9ydCAqCiNmcm9tIF9hYmNvbGwgaW1wb3J0IFNldApmcm9tIF9hYmNvbGwgaW1wb3J0IE11dGFibGVNYXBwaW5nCiNpbXBvcnQgX2FiY29sbAojX19hbGxfXyArPSBfYWJjb2xsLl9fYWxsX18KCmZyb20gX2NvbGxlY3Rpb25zIGltcG9ydCBkZXF1ZSwgZGVmYXVsdGRpY3QKI2ZpeG1lLCBicnl0aG9uLiAgVGhpcyBjYXVzZXMgYSBSZWZlcmVuY2VFcnJvcjogaXRlbWdldHRlciBpcyBub3QgZGVmaW5lZAojZnJvbSBvcGVyYXRvciBpbXBvcnQgaXRlbWdldHRlciBhcyBfaXRlbWdldHRlcgpmcm9tIGtleXdvcmQgaW1wb3J0IGlza2V5d29yZCBhcyBfaXNrZXl3b3JkCmltcG9ydCBzeXMgYXMgX3N5cwppbXBvcnQgaGVhcHEgYXMgX2hlYXBxCiNmaXhtZSBicnl0aG9uCiNmcm9tIHdlYWtyZWYgaW1wb3J0IHByb3h5IGFzIF9wcm94eQpmcm9tIGl0ZXJ0b29scyBpbXBvcnQgcmVwZWF0IGFzIF9yZXBlYXQsIGNoYWluIGFzIF9jaGFpbiwgc3Rhcm1hcCBhcyBfc3Rhcm1hcAojZml4bWUgYnJ5dGhvbiAKI2Zyb20gcmVwcmxpYiBpbXBvcnQgcmVjdXJzaXZlX3JlcHIgYXMgX3JlY3Vyc2l2ZV9yZXByCgpjbGFzcyBTZXQoc2V0KToKICAgIHBhc3MKCmNsYXNzIFNlcXVlbmNlKGxpc3QpOgogICAgcGFzcwoKZGVmIF9wcm94eShvYmopOgogICAgcmV0dXJuIG9iagoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjIE9yZGVyZWREaWN0CiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpjbGFzcyBfTGluayhvYmplY3QpOgogICAgX19zbG90c19fID0gJ3ByZXYnLCAnbmV4dCcsICdrZXknLCAnX193ZWFrcmVmX18nCgpjbGFzcyBPcmRlcmVkRGljdChkaWN0KToKICAgICdEaWN0aW9uYXJ5IHRoYXQgcmVtZW1iZXJzIGluc2VydGlvbiBvcmRlcicKICAgICMgQW4gaW5oZXJpdGVkIGRpY3QgbWFwcyBrZXlzIHRvIHZhbHVlcy4KICAgICMgVGhlIGluaGVyaXRlZCBkaWN0IHByb3ZpZGVzIF9fZ2V0aXRlbV9fLCBfX2xlbl9fLCBfX2NvbnRhaW5zX18sIGFuZCBnZXQuCiAgICAjIFRoZSByZW1haW5pbmcgbWV0aG9kcyBhcmUgb3JkZXItYXdhcmUuCiAgICAjIEJpZy1PIHJ1bm5pbmcgdGltZXMgZm9yIGFsbCBtZXRob2RzIGFyZSB0aGUgc2FtZSBhcyByZWd1bGFyIGRpY3Rpb25hcmllcy4KCiAgICAjIFRoZSBpbnRlcm5hbCBzZWxmLl9fbWFwIGRpY3QgbWFwcyBrZXlzIHRvIGxpbmtzIGluIGEgZG91Ymx5IGxpbmtlZCBsaXN0LgogICAgIyBUaGUgY2lyY3VsYXIgZG91Ymx5IGxpbmtlZCBsaXN0IHN0YXJ0cyBhbmQgZW5kcyB3aXRoIGEgc2VudGluZWwgZWxlbWVudC4KICAgICMgVGhlIHNlbnRpbmVsIGVsZW1lbnQgbmV2ZXIgZ2V0cyBkZWxldGVkICh0aGlzIHNpbXBsaWZpZXMgdGhlIGFsZ29yaXRobSkuCiAgICAjIFRoZSBzZW50aW5lbCBpcyBpbiBzZWxmLl9faGFyZHJvb3Qgd2l0aCBhIHdlYWtyZWYgcHJveHkgaW4gc2VsZi5fX3Jvb3QuCiAgICAjIFRoZSBwcmV2IGxpbmtzIGFyZSB3ZWFrcmVmIHByb3hpZXMgKHRvIHByZXZlbnQgY2lyY3VsYXIgcmVmZXJlbmNlcykuCiAgICAjIEluZGl2aWR1YWwgbGlua3MgYXJlIGtlcHQgYWxpdmUgYnkgdGhlIGhhcmQgcmVmZXJlbmNlIGluIHNlbGYuX19tYXAuCiAgICAjIFRob3NlIGhhcmQgcmVmZXJlbmNlcyBkaXNhcHBlYXIgd2hlbiBhIGtleSBpcyBkZWxldGVkIGZyb20gYW4gT3JkZXJlZERpY3QuCgogICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3ZHMpOgogICAgICAgICcnJ0luaXRpYWxpemUgYW4gb3JkZXJlZCBkaWN0aW9uYXJ5LiAgVGhlIHNpZ25hdHVyZSBpcyB0aGUgc2FtZSBhcwogICAgICAgIHJlZ3VsYXIgZGljdGlvbmFyaWVzLCBidXQga2V5d29yZCBhcmd1bWVudHMgYXJlIG5vdCByZWNvbW1lbmRlZCBiZWNhdXNlCiAgICAgICAgdGhlaXIgaW5zZXJ0aW9uIG9yZGVyIGlzIGFyYml0cmFyeS4KCiAgICAgICAgJycnCiAgICAgICAgaWYgbGVuKGFyZ3MpID4gMToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdleHBlY3RlZCBhdCBtb3N0IDEgYXJndW1lbnRzLCBnb3QgJWQnICUgbGVuKGFyZ3MpKQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5fX3Jvb3QKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHNlbGYuX19oYXJkcm9vdCA9IF9MaW5rKCkKICAgICAgICAgICAgc2VsZi5fX3Jvb3QgPSByb290ID0gX3Byb3h5KHNlbGYuX19oYXJkcm9vdCkKICAgICAgICAgICAgcm9vdC5wcmV2ID0gcm9vdC5uZXh0ID0gcm9vdAogICAgICAgICAgICBzZWxmLl9fbWFwID0ge30KICAgICAgICBzZWxmLl9fdXBkYXRlKCphcmdzLCAqKmt3ZHMpCgogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIGtleSwgdmFsdWUsCiAgICAgICAgICAgICAgICAgICAgZGljdF9zZXRpdGVtPWRpY3QuX19zZXRpdGVtX18sIHByb3h5PV9wcm94eSwgTGluaz1fTGluayk6CiAgICAgICAgJ29kLl9fc2V0aXRlbV9fKGksIHkpIDw9PT4gb2RbaV09eScKICAgICAgICAjIFNldHRpbmcgYSBuZXcgaXRlbSBjcmVhdGVzIGEgbmV3IGxpbmsgYXQgdGhlIGVuZCBvZiB0aGUgbGlua2VkIGxpc3QsCiAgICAgICAgIyBhbmQgdGhlIGluaGVyaXRlZCBkaWN0aW9uYXJ5IGlzIHVwZGF0ZWQgd2l0aCB0aGUgbmV3IGtleS92YWx1ZSBwYWlyLgogICAgICAgIGlmIGtleSBub3QgaW4gc2VsZjoKICAgICAgICAgICAgc2VsZi5fX21hcFtrZXldID0gbGluayA9IExpbmsoKQogICAgICAgICAgICByb290ID0gc2VsZi5fX3Jvb3QKICAgICAgICAgICAgbGFzdCA9IHJvb3QucHJldgogICAgICAgICAgICBsaW5rLnByZXYsIGxpbmsubmV4dCwgbGluay5rZXkgPSBsYXN0LCByb290LCBrZXkKICAgICAgICAgICAgbGFzdC5uZXh0ID0gbGluawogICAgICAgICAgICByb290LnByZXYgPSBwcm94eShsaW5rKQogICAgICAgIGRpY3Rfc2V0aXRlbShzZWxmLCBrZXksIHZhbHVlKQoKICAgIGRlZiBfX2RlbGl0ZW1fXyhzZWxmLCBrZXksIGRpY3RfZGVsaXRlbT1kaWN0Ll9fZGVsaXRlbV9fKToKICAgICAgICAnb2QuX19kZWxpdGVtX18oeSkgPD09PiBkZWwgb2RbeV0nCiAgICAgICAgIyBEZWxldGluZyBhbiBleGlzdGluZyBpdGVtIHVzZXMgc2VsZi5fX21hcCB0byBmaW5kIHRoZSBsaW5rIHdoaWNoIGdldHMKICAgICAgICAjIHJlbW92ZWQgYnkgdXBkYXRpbmcgdGhlIGxpbmtzIGluIHRoZSBwcmVkZWNlc3NvciBhbmQgc3VjY2Vzc29yIG5vZGVzLgogICAgICAgIGRpY3RfZGVsaXRlbShzZWxmLCBrZXkpCiAgICAgICAgbGluayA9IHNlbGYuX19tYXAucG9wKGtleSkKICAgICAgICBsaW5rX3ByZXYgPSBsaW5rLnByZXYKICAgICAgICBsaW5rX25leHQgPSBsaW5rLm5leHQKICAgICAgICBsaW5rX3ByZXYubmV4dCA9IGxpbmtfbmV4dAogICAgICAgIGxpbmtfbmV4dC5wcmV2ID0gbGlua19wcmV2CgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgICdvZC5fX2l0ZXJfXygpIDw9PT4gaXRlcihvZCknCiAgICAgICAgIyBUcmF2ZXJzZSB0aGUgbGlua2VkIGxpc3QgaW4gb3JkZXIuCiAgICAgICAgcm9vdCA9IHNlbGYuX19yb290CiAgICAgICAgY3VyciA9IHJvb3QubmV4dAogICAgICAgIHdoaWxlIGN1cnIgaXMgbm90IHJvb3Q6CiAgICAgICAgICAgIHlpZWxkIGN1cnIua2V5CiAgICAgICAgICAgIGN1cnIgPSBjdXJyLm5leHQKCiAgICBkZWYgX19yZXZlcnNlZF9fKHNlbGYpOgogICAgICAgICdvZC5fX3JldmVyc2VkX18oKSA8PT0+IHJldmVyc2VkKG9kKScKICAgICAgICAjIFRyYXZlcnNlIHRoZSBsaW5rZWQgbGlzdCBpbiByZXZlcnNlIG9yZGVyLgogICAgICAgIHJvb3QgPSBzZWxmLl9fcm9vdAogICAgICAgIGN1cnIgPSByb290LnByZXYKICAgICAgICB3aGlsZSBjdXJyIGlzIG5vdCByb290OgogICAgICAgICAgICB5aWVsZCBjdXJyLmtleQogICAgICAgICAgICBjdXJyID0gY3Vyci5wcmV2CgogICAgZGVmIGNsZWFyKHNlbGYpOgogICAgICAgICdvZC5jbGVhcigpIC0+IE5vbmUuICBSZW1vdmUgYWxsIGl0ZW1zIGZyb20gb2QuJwogICAgICAgIHJvb3QgPSBzZWxmLl9fcm9vdAogICAgICAgIHJvb3QucHJldiA9IHJvb3QubmV4dCA9IHJvb3QKICAgICAgICBzZWxmLl9fbWFwLmNsZWFyKCkKICAgICAgICBkaWN0LmNsZWFyKHNlbGYpCgogICAgZGVmIHBvcGl0ZW0oc2VsZiwgbGFzdD1UcnVlKToKICAgICAgICAnJydvZC5wb3BpdGVtKCkgLT4gKGssIHYpLCByZXR1cm4gYW5kIHJlbW92ZSBhIChrZXksIHZhbHVlKSBwYWlyLgogICAgICAgIFBhaXJzIGFyZSByZXR1cm5lZCBpbiBMSUZPIG9yZGVyIGlmIGxhc3QgaXMgdHJ1ZSBvciBGSUZPIG9yZGVyIGlmIGZhbHNlLgoKICAgICAgICAnJycKICAgICAgICBpZiBub3Qgc2VsZjoKICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3IoJ2RpY3Rpb25hcnkgaXMgZW1wdHknKQogICAgICAgIHJvb3QgPSBzZWxmLl9fcm9vdAogICAgICAgIGlmIGxhc3Q6CiAgICAgICAgICAgIGxpbmsgPSByb290LnByZXYKICAgICAgICAgICAgbGlua19wcmV2ID0gbGluay5wcmV2CiAgICAgICAgICAgIGxpbmtfcHJldi5uZXh0ID0gcm9vdAogICAgICAgICAgICByb290LnByZXYgPSBsaW5rX3ByZXYKICAgICAgICBlbHNlOgogICAgICAgICAgICBsaW5rID0gcm9vdC5uZXh0CiAgICAgICAgICAgIGxpbmtfbmV4dCA9IGxpbmsubmV4dAogICAgICAgICAgICByb290Lm5leHQgPSBsaW5rX25leHQKICAgICAgICAgICAgbGlua19uZXh0LnByZXYgPSByb290CiAgICAgICAga2V5ID0gbGluay5rZXkKICAgICAgICBkZWwgc2VsZi5fX21hcFtrZXldCiAgICAgICAgdmFsdWUgPSBkaWN0LnBvcChzZWxmLCBrZXkpCiAgICAgICAgcmV0dXJuIGtleSwgdmFsdWUKCiAgICBkZWYgbW92ZV90b19lbmQoc2VsZiwga2V5LCBsYXN0PVRydWUpOgogICAgICAgICcnJ01vdmUgYW4gZXhpc3RpbmcgZWxlbWVudCB0byB0aGUgZW5kIChvciBiZWdpbm5pbmcgaWYgbGFzdD09RmFsc2UpLgoKICAgICAgICBSYWlzZXMgS2V5RXJyb3IgaWYgdGhlIGVsZW1lbnQgZG9lcyBub3QgZXhpc3QuCiAgICAgICAgV2hlbiBsYXN0PVRydWUsIGFjdHMgbGlrZSBhIGZhc3QgdmVyc2lvbiBvZiBzZWxmW2tleV09c2VsZi5wb3Aoa2V5KS4KCiAgICAgICAgJycnCiAgICAgICAgbGluayA9IHNlbGYuX19tYXBba2V5XQogICAgICAgIGxpbmtfcHJldiA9IGxpbmsucHJldgogICAgICAgIGxpbmtfbmV4dCA9IGxpbmsubmV4dAogICAgICAgIGxpbmtfcHJldi5uZXh0ID0gbGlua19uZXh0CiAgICAgICAgbGlua19uZXh0LnByZXYgPSBsaW5rX3ByZXYKICAgICAgICByb290ID0gc2VsZi5fX3Jvb3QKICAgICAgICBpZiBsYXN0OgogICAgICAgICAgICBsYXN0ID0gcm9vdC5wcmV2CiAgICAgICAgICAgIGxpbmsucHJldiA9IGxhc3QKICAgICAgICAgICAgbGluay5uZXh0ID0gcm9vdAogICAgICAgICAgICBsYXN0Lm5leHQgPSByb290LnByZXYgPSBsaW5rCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZmlyc3QgPSByb290Lm5leHQKICAgICAgICAgICAgbGluay5wcmV2ID0gcm9vdAogICAgICAgICAgICBsaW5rLm5leHQgPSBmaXJzdAogICAgICAgICAgICByb290Lm5leHQgPSBmaXJzdC5wcmV2ID0gbGluawoKICAgIGRlZiBfX3NpemVvZl9fKHNlbGYpOgogICAgICAgIHNpemVvZiA9IF9zeXMuZ2V0c2l6ZW9mCiAgICAgICAgbiA9IGxlbihzZWxmKSArIDEgICAgICAgICAgICAgICAgICAgICAgICMgbnVtYmVyIG9mIGxpbmtzIGluY2x1ZGluZyByb290CiAgICAgICAgc2l6ZSA9IHNpemVvZihzZWxmLl9fZGljdF9fKSAgICAgICAgICAgICMgaW5zdGFuY2UgZGljdGlvbmFyeQogICAgICAgIHNpemUgKz0gc2l6ZW9mKHNlbGYuX19tYXApICogMiAgICAgICAgICAjIGludGVybmFsIGRpY3QgYW5kIGluaGVyaXRlZCBkaWN0CiAgICAgICAgc2l6ZSArPSBzaXplb2Yoc2VsZi5fX2hhcmRyb290KSAqIG4gICAgICMgbGluayBvYmplY3RzCiAgICAgICAgc2l6ZSArPSBzaXplb2Yoc2VsZi5fX3Jvb3QpICogbiAgICAgICAgICMgcHJveHkgb2JqZWN0cwogICAgICAgIHJldHVybiBzaXplCgogICAgI2ZpeG1lIGJyeXRob24uLiAgSXNzdWUgd2l0aCBfYWJjb2xsLCB3aGljaCBjb250YWlucyBNdXRhYmxlTWFwcGluZwogICAgdXBkYXRlID0gX191cGRhdGUgPSBNdXRhYmxlTWFwcGluZy51cGRhdGUKICAgIGtleXMgPSBNdXRhYmxlTWFwcGluZy5rZXlzCiAgICB2YWx1ZXMgPSBNdXRhYmxlTWFwcGluZy52YWx1ZXMKICAgIGl0ZW1zID0gTXV0YWJsZU1hcHBpbmcuaXRlbXMKICAgIF9fbmVfXyA9IE11dGFibGVNYXBwaW5nLl9fbmVfXwoKICAgIF9fbWFya2VyID0gb2JqZWN0KCkKCiAgICBkZWYgcG9wKHNlbGYsIGtleSwgZGVmYXVsdD1fX21hcmtlcik6CiAgICAgICAgJycnb2QucG9wKGtbLGRdKSAtPiB2LCByZW1vdmUgc3BlY2lmaWVkIGtleSBhbmQgcmV0dXJuIHRoZSBjb3JyZXNwb25kaW5nCiAgICAgICAgdmFsdWUuICBJZiBrZXkgaXMgbm90IGZvdW5kLCBkIGlzIHJldHVybmVkIGlmIGdpdmVuLCBvdGhlcndpc2UgS2V5RXJyb3IKICAgICAgICBpcyByYWlzZWQuCgogICAgICAgICcnJwogICAgICAgIGlmIGtleSBpbiBzZWxmOgogICAgICAgICAgICByZXN1bHQgPSBzZWxmW2tleV0KICAgICAgICAgICAgZGVsIHNlbGZba2V5XQogICAgICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgaWYgZGVmYXVsdCBpcyBzZWxmLl9fbWFya2VyOgogICAgICAgICAgICByYWlzZSBLZXlFcnJvcihrZXkpCiAgICAgICAgcmV0dXJuIGRlZmF1bHQKCiAgICBkZWYgc2V0ZGVmYXVsdChzZWxmLCBrZXksIGRlZmF1bHQ9Tm9uZSk6CiAgICAgICAgJ29kLnNldGRlZmF1bHQoa1ssZF0pIC0+IG9kLmdldChrLGQpLCBhbHNvIHNldCBvZFtrXT1kIGlmIGsgbm90IGluIG9kJwogICAgICAgIGlmIGtleSBpbiBzZWxmOgogICAgICAgICAgICByZXR1cm4gc2VsZltrZXldCiAgICAgICAgc2VsZltrZXldID0gZGVmYXVsdAogICAgICAgIHJldHVybiBkZWZhdWx0CgogICAgI2ZpeG1lLCBicnl0aG9uIGlzc3VlCiAgICAjQF9yZWN1cnNpdmVfcmVwcigpCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgJ29kLl9fcmVwcl9fKCkgPD09PiByZXByKG9kKScKICAgICAgICBpZiBub3Qgc2VsZjoKICAgICAgICAgICAgcmV0dXJuICclcygpJyAlIChzZWxmLl9fY2xhc3NfXy5fX25hbWVfXywpCiAgICAgICAgcmV0dXJuICclcyglciknICUgKHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLCBsaXN0KHNlbGYuaXRlbXMoKSkpCgogICAgZGVmIF9fcmVkdWNlX18oc2VsZik6CiAgICAgICAgJ1JldHVybiBzdGF0ZSBpbmZvcm1hdGlvbiBmb3IgcGlja2xpbmcnCiAgICAgICAgaXRlbXMgPSBbW2ssIHNlbGZba11dIGZvciBrIGluIHNlbGZdCiAgICAgICAgaW5zdF9kaWN0ID0gdmFycyhzZWxmKS5jb3B5KCkKICAgICAgICBmb3IgayBpbiB2YXJzKE9yZGVyZWREaWN0KCkpOgogICAgICAgICAgICBpbnN0X2RpY3QucG9wKGssIE5vbmUpCiAgICAgICAgaWYgaW5zdF9kaWN0OgogICAgICAgICAgICByZXR1cm4gKHNlbGYuX19jbGFzc19fLCAoaXRlbXMsKSwgaW5zdF9kaWN0KQogICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXywgKGl0ZW1zLCkKCiAgICBkZWYgY29weShzZWxmKToKICAgICAgICAnb2QuY29weSgpIC0+IGEgc2hhbGxvdyBjb3B5IG9mIG9kJwogICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmKQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIGZyb21rZXlzKGNscywgaXRlcmFibGUsIHZhbHVlPU5vbmUpOgogICAgICAgICcnJ09ELmZyb21rZXlzKFNbLCB2XSkgLT4gTmV3IG9yZGVyZWQgZGljdGlvbmFyeSB3aXRoIGtleXMgZnJvbSBTLgogICAgICAgIElmIG5vdCBzcGVjaWZpZWQsIHRoZSB2YWx1ZSBkZWZhdWx0cyB0byBOb25lLgoKICAgICAgICAnJycKICAgICAgICBzZWxmID0gY2xzKCkKICAgICAgICBmb3Iga2V5IGluIGl0ZXJhYmxlOgogICAgICAgICAgICBzZWxmW2tleV0gPSB2YWx1ZQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fZXFfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgJycnb2QuX19lcV9fKHkpIDw9PT4gb2Q9PXkuICBDb21wYXJpc29uIHRvIGFub3RoZXIgT0QgaXMgb3JkZXItc2Vuc2l0aXZlCiAgICAgICAgd2hpbGUgY29tcGFyaXNvbiB0byBhIHJlZ3VsYXIgbWFwcGluZyBpcyBvcmRlci1pbnNlbnNpdGl2ZS4KCiAgICAgICAgJycnCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgT3JkZXJlZERpY3QpOgogICAgICAgICAgICByZXR1cm4gbGVuKHNlbGYpPT1sZW4ob3RoZXIpIGFuZCBcCiAgICAgICAgICAgICAgICAgICBhbGwocD09cSBmb3IgcCwgcSBpbiB6aXAoc2VsZi5pdGVtcygpLCBvdGhlci5pdGVtcygpKSkKICAgICAgICByZXR1cm4gZGljdC5fX2VxX18oc2VsZiwgb3RoZXIpCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIyAgQ291bnRlcgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCgpkZWYgX2NvdW50X2VsZW1lbnRzKG1hcHBpbmcsIGl0ZXJhYmxlKToKICAgICdUYWxseSBlbGVtZW50cyBmcm9tIHRoZSBpdGVyYWJsZS4nCiAgICBtYXBwaW5nX2dldCA9IG1hcHBpbmcuZ2V0CiAgICBmb3IgZWxlbSBpbiBpdGVyYWJsZToKICAgICAgICBtYXBwaW5nW2VsZW1dID0gbWFwcGluZ19nZXQoZWxlbSwgMCkgKyAxCgojdHJ5OiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgTG9hZCBDIGhlbHBlciBmdW5jdGlvbiBpZiBhdmFpbGFibGUKIyAgICBmcm9tIF9jb2xsZWN0aW9ucyBpbXBvcnQgX2NvdW50X2VsZW1lbnRzCiNleGNlcHQgSW1wb3J0RXJyb3I6CiMgICAgcGFzcwoKY2xhc3MgQ291bnRlcihkaWN0KToKICAgICcnJ0RpY3Qgc3ViY2xhc3MgZm9yIGNvdW50aW5nIGhhc2hhYmxlIGl0ZW1zLiAgU29tZXRpbWVzIGNhbGxlZCBhIGJhZwogICAgb3IgbXVsdGlzZXQuICBFbGVtZW50cyBhcmUgc3RvcmVkIGFzIGRpY3Rpb25hcnkga2V5cyBhbmQgdGhlaXIgY291bnRzCiAgICBhcmUgc3RvcmVkIGFzIGRpY3Rpb25hcnkgdmFsdWVzLgoKICAgID4+PiBjID0gQ291bnRlcignYWJjZGVhYmNkYWJjYWJhJykgICMgY291bnQgZWxlbWVudHMgZnJvbSBhIHN0cmluZwoKICAgID4+PiBjLm1vc3RfY29tbW9uKDMpICAgICAgICAgICAgICAgICMgdGhyZWUgbW9zdCBjb21tb24gZWxlbWVudHMKICAgIFsoJ2EnLCA1KSwgKCdiJywgNCksICgnYycsIDMpXQogICAgPj4+IHNvcnRlZChjKSAgICAgICAgICAgICAgICAgICAgICAgIyBsaXN0IGFsbCB1bmlxdWUgZWxlbWVudHMKICAgIFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ10KICAgID4+PiAnJy5qb2luKHNvcnRlZChjLmVsZW1lbnRzKCkpKSAgICMgbGlzdCBlbGVtZW50cyB3aXRoIHJlcGV0aXRpb25zCiAgICAnYWFhYWFiYmJiY2NjZGRlJwogICAgPj4+IHN1bShjLnZhbHVlcygpKSAgICAgICAgICAgICAgICAgIyB0b3RhbCBvZiBhbGwgY291bnRzCiAgICAxNQoKICAgID4+PiBjWydhJ10gICAgICAgICAgICAgICAgICAgICAgICAgICMgY291bnQgb2YgbGV0dGVyICdhJwogICAgNQogICAgPj4+IGZvciBlbGVtIGluICdzaGF6YW0nOiAgICAgICAgICAgIyB1cGRhdGUgY291bnRzIGZyb20gYW4gaXRlcmFibGUKICAgIC4uLiAgICAgY1tlbGVtXSArPSAxICAgICAgICAgICAgICAgICMgYnkgYWRkaW5nIDEgdG8gZWFjaCBlbGVtZW50J3MgY291bnQKICAgID4+PiBjWydhJ10gICAgICAgICAgICAgICAgICAgICAgICAgICMgbm93IHRoZXJlIGFyZSBzZXZlbiAnYScKICAgIDcKICAgID4+PiBkZWwgY1snYiddICAgICAgICAgICAgICAgICAgICAgICMgcmVtb3ZlIGFsbCAnYicKICAgID4+PiBjWydiJ10gICAgICAgICAgICAgICAgICAgICAgICAgICMgbm93IHRoZXJlIGFyZSB6ZXJvICdiJwogICAgMAoKICAgID4+PiBkID0gQ291bnRlcignc2ltc2FsYWJpbScpICAgICAgICMgbWFrZSBhbm90aGVyIGNvdW50ZXIKICAgID4+PiBjLnVwZGF0ZShkKSAgICAgICAgICAgICAgICAgICAgICMgYWRkIGluIHRoZSBzZWNvbmQgY291bnRlcgogICAgPj4+IGNbJ2EnXSAgICAgICAgICAgICAgICAgICAgICAgICAgIyBub3cgdGhlcmUgYXJlIG5pbmUgJ2EnCiAgICA5CgogICAgPj4+IGMuY2xlYXIoKSAgICAgICAgICAgICAgICAgICAgICAgIyBlbXB0eSB0aGUgY291bnRlcgogICAgPj4+IGMKICAgIENvdW50ZXIoKQoKICAgIE5vdGU6ICBJZiBhIGNvdW50IGlzIHNldCB0byB6ZXJvIG9yIHJlZHVjZWQgdG8gemVybywgaXQgd2lsbCByZW1haW4KICAgIGluIHRoZSBjb3VudGVyIHVudGlsIHRoZSBlbnRyeSBpcyBkZWxldGVkIG9yIHRoZSBjb3VudGVyIGlzIGNsZWFyZWQ6CgogICAgPj4+IGMgPSBDb3VudGVyKCdhYWFiYmMnKQogICAgPj4+IGNbJ2InXSAtPSAyICAgICAgICAgICAgICAgICAgICAgIyByZWR1Y2UgdGhlIGNvdW50IG9mICdiJyBieSB0d28KICAgID4+PiBjLm1vc3RfY29tbW9uKCkgICAgICAgICAgICAgICAgICMgJ2InIGlzIHN0aWxsIGluLCBidXQgaXRzIGNvdW50IGlzIHplcm8KICAgIFsoJ2EnLCAzKSwgKCdjJywgMSksICgnYicsIDApXQoKICAgICcnJwogICAgIyBSZWZlcmVuY2VzOgogICAgIyAgIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTXVsdGlzZXQKICAgICMgICBodHRwOi8vd3d3LmdudS5vcmcvc29mdHdhcmUvc21hbGx0YWxrL21hbnVhbC1iYXNlL2h0bWxfbm9kZS9CYWcuaHRtbAogICAgIyAgIGh0dHA6Ly93d3cuZGVtbzJzLmNvbS9UdXRvcmlhbC9DcHAvMDM4MF9fc2V0LW11bHRpc2V0L0NhdGFsb2cwMzgwX19zZXQtbXVsdGlzZXQuaHRtCiAgICAjICAgaHR0cDovL2NvZGUuYWN0aXZlc3RhdGUuY29tL3JlY2lwZXMvMjU5MTc0LwogICAgIyAgIEtudXRoLCBUQU9DUCBWb2wuIElJIHNlY3Rpb24gNC42LjMKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaXRlcmFibGU9Tm9uZSwgKiprd2RzKToKICAgICAgICAnJydDcmVhdGUgYSBuZXcsIGVtcHR5IENvdW50ZXIgb2JqZWN0LiAgQW5kIGlmIGdpdmVuLCBjb3VudCBlbGVtZW50cwogICAgICAgIGZyb20gYW4gaW5wdXQgaXRlcmFibGUuICBPciwgaW5pdGlhbGl6ZSB0aGUgY291bnQgZnJvbSBhbm90aGVyIG1hcHBpbmcKICAgICAgICBvZiBlbGVtZW50cyB0byB0aGVpciBjb3VudHMuCgogICAgICAgID4+PiBjID0gQ291bnRlcigpICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBhIG5ldywgZW1wdHkgY291bnRlcgogICAgICAgID4+PiBjID0gQ291bnRlcignZ2FsbGFoYWQnKSAgICAgICAgICAgICAgICAgIyBhIG5ldyBjb3VudGVyIGZyb20gYW4gaXRlcmFibGUKICAgICAgICA+Pj4gYyA9IENvdW50ZXIoeydhJzogNCwgJ2InOiAyfSkgICAgICAgICAgICMgYSBuZXcgY291bnRlciBmcm9tIGEgbWFwcGluZwogICAgICAgID4+PiBjID0gQ291bnRlcihhPTQsIGI9MikgICAgICAgICAgICAgICAgICAgIyBhIG5ldyBjb3VudGVyIGZyb20ga2V5d29yZCBhcmdzCgogICAgICAgICcnJwogICAgICAgICNzdXBlcigpLl9faW5pdF9fKCkgICNCRSBtb2RpZmllZCBzaW5jZSBzdXBlciBub3Qgc3VwcG9ydGVkCiAgICAgICAgZGljdC5fX2luaXRfXyhzZWxmKQogICAgICAgIHNlbGYudXBkYXRlKGl0ZXJhYmxlLCAqKmt3ZHMpCgogICAgZGVmIF9fbWlzc2luZ19fKHNlbGYsIGtleSk6CiAgICAgICAgJ1RoZSBjb3VudCBvZiBlbGVtZW50cyBub3QgaW4gdGhlIENvdW50ZXIgaXMgemVyby4nCiAgICAgICAgIyBOZWVkZWQgc28gdGhhdCBzZWxmW21pc3NpbmdfaXRlbV0gZG9lcyBub3QgcmFpc2UgS2V5RXJyb3IKICAgICAgICByZXR1cm4gMAoKICAgIGRlZiBtb3N0X2NvbW1vbihzZWxmLCBuPU5vbmUpOgogICAgICAgICcnJ0xpc3QgdGhlIG4gbW9zdCBjb21tb24gZWxlbWVudHMgYW5kIHRoZWlyIGNvdW50cyBmcm9tIHRoZSBtb3N0CiAgICAgICAgY29tbW9uIHRvIHRoZSBsZWFzdC4gIElmIG4gaXMgTm9uZSwgdGhlbiBsaXN0IGFsbCBlbGVtZW50IGNvdW50cy4KCiAgICAgICAgPj4+IENvdW50ZXIoJ2FiY2RlYWJjZGFiY2FiYScpLm1vc3RfY29tbW9uKDMpCiAgICAgICAgWygnYScsIDUpLCAoJ2InLCA0KSwgKCdjJywgMyldCgogICAgICAgICcnJwogICAgICAgICMgRW11bGF0ZSBCYWcuc29ydGVkQnlDb3VudCBmcm9tIFNtYWxsdGFsawogICAgICAgIGlmIG4gaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIHNvcnRlZChzZWxmLml0ZW1zKCksIGtleT1faXRlbWdldHRlcigxKSwgcmV2ZXJzZT1UcnVlKQogICAgICAgIHJldHVybiBfaGVhcHEubmxhcmdlc3Qobiwgc2VsZi5pdGVtcygpLCBrZXk9X2l0ZW1nZXR0ZXIoMSkpCgogICAgZGVmIGVsZW1lbnRzKHNlbGYpOgogICAgICAgICcnJ0l0ZXJhdG9yIG92ZXIgZWxlbWVudHMgcmVwZWF0aW5nIGVhY2ggYXMgbWFueSB0aW1lcyBhcyBpdHMgY291bnQuCgogICAgICAgID4+PiBjID0gQ291bnRlcignQUJDQUJDJykKICAgICAgICA+Pj4gc29ydGVkKGMuZWxlbWVudHMoKSkKICAgICAgICBbJ0EnLCAnQScsICdCJywgJ0InLCAnQycsICdDJ10KCiAgICAgICAgIyBLbnV0aCdzIGV4YW1wbGUgZm9yIHByaW1lIGZhY3RvcnMgb2YgMTgzNjogIDIqKjIgKiAzKiozICogMTcqKjEKICAgICAgICA+Pj4gcHJpbWVfZmFjdG9ycyA9IENvdW50ZXIoezI6IDIsIDM6IDMsIDE3OiAxfSkKICAgICAgICA+Pj4gcHJvZHVjdCA9IDEKICAgICAgICA+Pj4gZm9yIGZhY3RvciBpbiBwcmltZV9mYWN0b3JzLmVsZW1lbnRzKCk6ICAgICAjIGxvb3Agb3ZlciBmYWN0b3JzCiAgICAgICAgLi4uICAgICBwcm9kdWN0ICo9IGZhY3RvciAgICAgICAgICAgICAgICAgICAgICAgIyBhbmQgbXVsdGlwbHkgdGhlbQogICAgICAgID4+PiBwcm9kdWN0CiAgICAgICAgMTgzNgoKICAgICAgICBOb3RlLCBpZiBhbiBlbGVtZW50J3MgY291bnQgaGFzIGJlZW4gc2V0IHRvIHplcm8gb3IgaXMgYSBuZWdhdGl2ZQogICAgICAgIG51bWJlciwgZWxlbWVudHMoKSB3aWxsIGlnbm9yZSBpdC4KCiAgICAgICAgJycnCiAgICAgICAgIyBFbXVsYXRlIEJhZy5kbyBmcm9tIFNtYWxsdGFsayBhbmQgTXVsdGlzZXQuYmVnaW4gZnJvbSBDKysuCiAgICAgICAgcmV0dXJuIF9jaGFpbi5mcm9tX2l0ZXJhYmxlKF9zdGFybWFwKF9yZXBlYXQsIHNlbGYuaXRlbXMoKSkpCgogICAgIyBPdmVycmlkZSBkaWN0IG1ldGhvZHMgd2hlcmUgbmVjZXNzYXJ5CgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbWtleXMoY2xzLCBpdGVyYWJsZSwgdj1Ob25lKToKICAgICAgICAjIFRoZXJlIGlzIG5vIGVxdWl2YWxlbnQgbWV0aG9kIGZvciBjb3VudGVycyBiZWNhdXNlIHNldHRpbmcgdj0xCiAgICAgICAgIyBtZWFucyB0aGF0IG5vIGVsZW1lbnQgY2FuIGhhdmUgYSBjb3VudCBncmVhdGVyIHRoYW4gb25lLgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoCiAgICAgICAgICAgICdDb3VudGVyLmZyb21rZXlzKCkgaXMgdW5kZWZpbmVkLiAgVXNlIENvdW50ZXIoaXRlcmFibGUpIGluc3RlYWQuJykKCiAgICBkZWYgdXBkYXRlKHNlbGYsIGl0ZXJhYmxlPU5vbmUsICoqa3dkcyk6CiAgICAgICAgJycnTGlrZSBkaWN0LnVwZGF0ZSgpIGJ1dCBhZGQgY291bnRzIGluc3RlYWQgb2YgcmVwbGFjaW5nIHRoZW0uCgogICAgICAgIFNvdXJjZSBjYW4gYmUgYW4gaXRlcmFibGUsIGEgZGljdGlvbmFyeSwgb3IgYW5vdGhlciBDb3VudGVyIGluc3RhbmNlLgoKICAgICAgICA+Pj4gYyA9IENvdW50ZXIoJ3doaWNoJykKICAgICAgICA+Pj4gYy51cGRhdGUoJ3dpdGNoJykgICAgICAgICAgICMgYWRkIGVsZW1lbnRzIGZyb20gYW5vdGhlciBpdGVyYWJsZQogICAgICAgID4+PiBkID0gQ291bnRlcignd2F0Y2gnKQogICAgICAgID4+PiBjLnVwZGF0ZShkKSAgICAgICAgICAgICAgICAgIyBhZGQgZWxlbWVudHMgZnJvbSBhbm90aGVyIGNvdW50ZXIKICAgICAgICA+Pj4gY1snaCddICAgICAgICAgICAgICAgICAgICAgICMgZm91ciAnaCcgaW4gd2hpY2gsIHdpdGNoLCBhbmQgd2F0Y2gKICAgICAgICA0CgogICAgICAgICcnJwogICAgICAgICMgVGhlIHJlZ3VsYXIgZGljdC51cGRhdGUoKSBvcGVyYXRpb24gbWFrZXMgbm8gc2Vuc2UgaGVyZSBiZWNhdXNlIHRoZQogICAgICAgICMgcmVwbGFjZSBiZWhhdmlvciByZXN1bHRzIGluIHRoZSBzb21lIG9mIG9yaWdpbmFsIHVudG91Y2hlZCBjb3VudHMKICAgICAgICAjIGJlaW5nIG1peGVkLWluIHdpdGggYWxsIG9mIHRoZSBvdGhlciBjb3VudHMgZm9yIGEgbWlzbWFzaCB0aGF0CiAgICAgICAgIyBkb2Vzbid0IGhhdmUgYSBzdHJhaWdodC1mb3J3YXJkIGludGVycHJldGF0aW9uIGluIG1vc3QgY291bnRpbmcKICAgICAgICAjIGNvbnRleHRzLiAgSW5zdGVhZCwgd2UgaW1wbGVtZW50IHN0cmFpZ2h0LWFkZGl0aW9uLiAgQm90aCB0aGUgaW5wdXRzCiAgICAgICAgIyBhbmQgb3V0cHV0cyBhcmUgYWxsb3dlZCB0byBjb250YWluIHplcm8gYW5kIG5lZ2F0aXZlIGNvdW50cy4KCiAgICAgICAgaWYgaXRlcmFibGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoaXRlcmFibGUsIE1hcHBpbmcpOgogICAgICAgICAgICAgICAgaWYgc2VsZjoKICAgICAgICAgICAgICAgICAgICBzZWxmX2dldCA9IHNlbGYuZ2V0CiAgICAgICAgICAgICAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIGl0ZXJhYmxlLml0ZW1zKCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGZbZWxlbV0gPSBjb3VudCArIHNlbGZfZ2V0KGVsZW0sIDApCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHN1cGVyKCkudXBkYXRlKGl0ZXJhYmxlKSAjIGZhc3QgcGF0aCB3aGVuIGNvdW50ZXIgaXMgZW1wdHkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIF9jb3VudF9lbGVtZW50cyhzZWxmLCBpdGVyYWJsZSkKICAgICAgICBpZiBrd2RzOgogICAgICAgICAgICBzZWxmLnVwZGF0ZShrd2RzKQoKICAgIGRlZiBzdWJ0cmFjdChzZWxmLCBpdGVyYWJsZT1Ob25lLCAqKmt3ZHMpOgogICAgICAgICcnJ0xpa2UgZGljdC51cGRhdGUoKSBidXQgc3VidHJhY3RzIGNvdW50cyBpbnN0ZWFkIG9mIHJlcGxhY2luZyB0aGVtLgogICAgICAgIENvdW50cyBjYW4gYmUgcmVkdWNlZCBiZWxvdyB6ZXJvLiAgQm90aCB0aGUgaW5wdXRzIGFuZCBvdXRwdXRzIGFyZQogICAgICAgIGFsbG93ZWQgdG8gY29udGFpbiB6ZXJvIGFuZCBuZWdhdGl2ZSBjb3VudHMuCgogICAgICAgIFNvdXJjZSBjYW4gYmUgYW4gaXRlcmFibGUsIGEgZGljdGlvbmFyeSwgb3IgYW5vdGhlciBDb3VudGVyIGluc3RhbmNlLgoKICAgICAgICA+Pj4gYyA9IENvdW50ZXIoJ3doaWNoJykKICAgICAgICA+Pj4gYy5zdWJ0cmFjdCgnd2l0Y2gnKSAgICAgICAgICAgICAjIHN1YnRyYWN0IGVsZW1lbnRzIGZyb20gYW5vdGhlciBpdGVyYWJsZQogICAgICAgID4+PiBjLnN1YnRyYWN0KENvdW50ZXIoJ3dhdGNoJykpICAgICMgc3VidHJhY3QgZWxlbWVudHMgZnJvbSBhbm90aGVyIGNvdW50ZXIKICAgICAgICA+Pj4gY1snaCddICAgICAgICAgICAgICAgICAgICAgICAgICAjIDIgaW4gd2hpY2gsIG1pbnVzIDEgaW4gd2l0Y2gsIG1pbnVzIDEgaW4gd2F0Y2gKICAgICAgICAwCiAgICAgICAgPj4+IGNbJ3cnXSAgICAgICAgICAgICAgICAgICAgICAgICAgIyAxIGluIHdoaWNoLCBtaW51cyAxIGluIHdpdGNoLCBtaW51cyAxIGluIHdhdGNoCiAgICAgICAgLTEKCiAgICAgICAgJycnCiAgICAgICAgaWYgaXRlcmFibGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHNlbGZfZ2V0ID0gc2VsZi5nZXQKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShpdGVyYWJsZSwgTWFwcGluZyk6CiAgICAgICAgICAgICAgICBmb3IgZWxlbSwgY291bnQgaW4gaXRlcmFibGUuaXRlbXMoKToKICAgICAgICAgICAgICAgICAgICBzZWxmW2VsZW1dID0gc2VsZl9nZXQoZWxlbSwgMCkgLSBjb3VudAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZm9yIGVsZW0gaW4gaXRlcmFibGU6CiAgICAgICAgICAgICAgICAgICAgc2VsZltlbGVtXSA9IHNlbGZfZ2V0KGVsZW0sIDApIC0gMQogICAgICAgIGlmIGt3ZHM6CiAgICAgICAgICAgIHNlbGYuc3VidHJhY3Qoa3dkcykKCiAgICBkZWYgY29weShzZWxmKToKICAgICAgICAnUmV0dXJuIGEgc2hhbGxvdyBjb3B5LicKICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZikKCiAgICBkZWYgX19yZWR1Y2VfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18sIChkaWN0KHNlbGYpLCkKCiAgICBkZWYgX19kZWxpdGVtX18oc2VsZiwgZWxlbSk6CiAgICAgICAgJ0xpa2UgZGljdC5fX2RlbGl0ZW1fXygpIGJ1dCBkb2VzIG5vdCByYWlzZSBLZXlFcnJvciBmb3IgbWlzc2luZyB2YWx1ZXMuJwogICAgICAgIGlmIGVsZW0gaW4gc2VsZjoKICAgICAgICAgICAgc3VwZXIoKS5fX2RlbGl0ZW1fXyhlbGVtKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICBpZiBub3Qgc2VsZjoKICAgICAgICAgICAgcmV0dXJuICclcygpJyAlIHNlbGYuX19jbGFzc19fLl9fbmFtZV9fCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpdGVtcyA9ICcsICcuam9pbihtYXAoJyVyOiAlcicuX19tb2RfXywgc2VsZi5tb3N0X2NvbW1vbigpKSkKICAgICAgICAgICAgcmV0dXJuICclcyh7JXN9KScgJSAoc2VsZi5fX2NsYXNzX18uX19uYW1lX18sIGl0ZW1zKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgICAgICMgaGFuZGxlIGNhc2Ugd2hlcmUgdmFsdWVzIGFyZSBub3Qgb3JkZXJhYmxlCiAgICAgICAgICAgIHJldHVybiAnezB9KHsxIXJ9KScuZm9ybWF0KHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLCBkaWN0KHNlbGYpKQoKICAgICMgTXVsdGlzZXQtc3R5bGUgbWF0aGVtYXRpY2FsIG9wZXJhdGlvbnMgZGlzY3Vzc2VkIGluOgogICAgIyAgICAgICBLbnV0aCBUQU9DUCBWb2x1bWUgSUkgc2VjdGlvbiA0LjYuMyBleGVyY2lzZSAxOQogICAgIyAgICAgICBhbmQgYXQgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9NdWx0aXNldAogICAgIwogICAgIyBPdXRwdXRzIGd1YXJhbnRlZWQgdG8gb25seSBpbmNsdWRlIHBvc2l0aXZlIGNvdW50cy4KICAgICMKICAgICMgVG8gc3RyaXAgbmVnYXRpdmUgYW5kIHplcm8gY291bnRzLCBhZGQtaW4gYW4gZW1wdHkgY291bnRlcjoKICAgICMgICAgICAgYyArPSBDb3VudGVyKCkKCiAgICBkZWYgX19hZGRfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgJycnQWRkIGNvdW50cyBmcm9tIHR3byBjb3VudGVycy4KCiAgICAgICAgPj4+IENvdW50ZXIoJ2FiYmInKSArIENvdW50ZXIoJ2JjYycpCiAgICAgICAgQ291bnRlcih7J2InOiA0LCAnYyc6IDIsICdhJzogMX0pCgogICAgICAgICcnJwogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBDb3VudGVyKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgcmVzdWx0ID0gQ291bnRlcigpCiAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIHNlbGYuaXRlbXMoKToKICAgICAgICAgICAgbmV3Y291bnQgPSBjb3VudCArIG90aGVyW2VsZW1dCiAgICAgICAgICAgIGlmIG5ld2NvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IG5ld2NvdW50CiAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIG90aGVyLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIGVsZW0gbm90IGluIHNlbGYgYW5kIGNvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IGNvdW50CiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBfX3N1Yl9fKHNlbGYsIG90aGVyKToKICAgICAgICAnJycgU3VidHJhY3QgY291bnQsIGJ1dCBrZWVwIG9ubHkgcmVzdWx0cyB3aXRoIHBvc2l0aXZlIGNvdW50cy4KCiAgICAgICAgPj4+IENvdW50ZXIoJ2FiYmJjJykgLSBDb3VudGVyKCdiY2NkJykKICAgICAgICBDb3VudGVyKHsnYic6IDIsICdhJzogMX0pCgogICAgICAgICcnJwogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBDb3VudGVyKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgcmVzdWx0ID0gQ291bnRlcigpCiAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIHNlbGYuaXRlbXMoKToKICAgICAgICAgICAgbmV3Y291bnQgPSBjb3VudCAtIG90aGVyW2VsZW1dCiAgICAgICAgICAgIGlmIG5ld2NvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IG5ld2NvdW50CiAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIG90aGVyLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIGVsZW0gbm90IGluIHNlbGYgYW5kIGNvdW50IDwgMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IDAgLSBjb3VudAogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgX19vcl9fKHNlbGYsIG90aGVyKToKICAgICAgICAnJydVbmlvbiBpcyB0aGUgbWF4aW11bSBvZiB2YWx1ZSBpbiBlaXRoZXIgb2YgdGhlIGlucHV0IGNvdW50ZXJzLgoKICAgICAgICA+Pj4gQ291bnRlcignYWJiYicpIHwgQ291bnRlcignYmNjJykKICAgICAgICBDb3VudGVyKHsnYic6IDMsICdjJzogMiwgJ2EnOiAxfSkKCiAgICAgICAgJycnCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIENvdW50ZXIpOgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKICAgICAgICByZXN1bHQgPSBDb3VudGVyKCkKICAgICAgICBmb3IgZWxlbSwgY291bnQgaW4gc2VsZi5pdGVtcygpOgogICAgICAgICAgICBvdGhlcl9jb3VudCA9IG90aGVyW2VsZW1dCiAgICAgICAgICAgIG5ld2NvdW50ID0gb3RoZXJfY291bnQgaWYgY291bnQgPCBvdGhlcl9jb3VudCBlbHNlIGNvdW50CiAgICAgICAgICAgIGlmIG5ld2NvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IG5ld2NvdW50CiAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIG90aGVyLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIGVsZW0gbm90IGluIHNlbGYgYW5kIGNvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IGNvdW50CiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBfX2FuZF9fKHNlbGYsIG90aGVyKToKICAgICAgICAnJycgSW50ZXJzZWN0aW9uIGlzIHRoZSBtaW5pbXVtIG9mIGNvcnJlc3BvbmRpbmcgY291bnRzLgogICAgCiAgICAgICAgPj4+IENvdW50ZXIoJ2FiYmInKSAmIENvdW50ZXIoJ2JjYycpCiAgICAgICAgQ291bnRlcih7J2InOiAxfSkKCiAgICAgICAgJycnCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIENvdW50ZXIpOgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKICAgICAgICByZXN1bHQgPSBDb3VudGVyKCkKICAgICAgICBmb3IgZWxlbSwgY291bnQgaW4gc2VsZi5pdGVtcygpOgogICAgICAgICAgICBvdGhlcl9jb3VudCA9IG90aGVyW2VsZW1dCiAgICAgICAgICAgIG5ld2NvdW50ID0gY291bnQgaWYgY291bnQgPCBvdGhlcl9jb3VudCBlbHNlIG90aGVyX2NvdW50CiAgICAgICAgICAgIGlmIG5ld2NvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IG5ld2NvdW50CiAgICAgICAgcmV0dXJuIHJlc3VsdAoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMgIENoYWluTWFwIChoZWxwZXIgZm9yIGNvbmZpZ3BhcnNlcikKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgojY2xhc3MgX0NoYWluTWFwKE11dGFibGVNYXBwaW5nKToKIyAgICAnJycgQSBDaGFpbk1hcCBncm91cHMgbXVsdGlwbGUgZGljdHMgKG9yIG90aGVyIG1hcHBpbmdzKSB0b2dldGhlcgojICAgIHRvIGNyZWF0ZSBhIHNpbmdsZSwgdXBkYXRlYWJsZSB2aWV3LgoKIyAgICBUaGUgdW5kZXJseWluZyBtYXBwaW5ncyBhcmUgc3RvcmVkIGluIGEgbGlzdC4gIFRoYXQgbGlzdCBpcyBwdWJsaWMgYW5kIGNhbgojICAgIGFjY2Vzc2VkIG9yIHVwZGF0ZWQgdXNpbmcgdGhlICptYXBzKiBhdHRyaWJ1dGUuICBUaGVyZSBpcyBubyBvdGhlciBzdGF0ZS4KCiMgICAgTG9va3VwcyBzZWFyY2ggdGhlIHVuZGVybHlpbmcgbWFwcGluZ3Mgc3VjY2Vzc2l2ZWx5IHVudGlsIGEga2V5IGlzIGZvdW5kLgojICAgIEluIGNvbnRyYXN0LCB3cml0ZXMsIHVwZGF0ZXMsIGFuZCBkZWxldGlvbnMgb25seSBvcGVyYXRlIG9uIHRoZSBmaXJzdAojICAgIG1hcHBpbmcuCiMKIyAgICAnJycKCiMgICAgZGVmIF9faW5pdF9fKHNlbGYsICptYXBzKToKIyAgICAgICAgJycnSW5pdGlhbGl6ZSBhIENoYWluTWFwIGJ5IHNldHRpbmcgKm1hcHMqIHRvIHRoZSBnaXZlbiBtYXBwaW5ncy4KIyAgICAgICAgSWYgbm8gbWFwcGluZ3MgYXJlIHByb3ZpZGVkLCBhIHNpbmdsZSBlbXB0eSBkaWN0aW9uYXJ5IGlzIHVzZWQuCiMKIyAgICAgICAgJycnCiMgICAgICAgIHNlbGYubWFwcyA9IGxpc3QobWFwcykgb3IgW3t9XSAgICAgICAgICAjIGFsd2F5cyBhdCBsZWFzdCBvbmUgbWFwCgojICAgIGRlZiBfX21pc3NpbmdfXyhzZWxmLCBrZXkpOgojICAgICAgICByYWlzZSBLZXlFcnJvcihrZXkpCgojICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBrZXkpOgojICAgICAgICBmb3IgbWFwcGluZyBpbiBzZWxmLm1hcHM6CiMgICAgICAgICAgICB0cnk6CiMgICAgICAgICAgICAgICAgcmV0dXJuIG1hcHBpbmdba2V5XSAgICAgICAgICAgICAjIGNhbid0IHVzZSAna2V5IGluIG1hcHBpbmcnIHdpdGggZGVmYXVsdGRpY3QKIyAgICAgICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKIyAgICAgICAgICAgICAgICBwYXNzCiMgICAgICAgIHJldHVybiBzZWxmLl9fbWlzc2luZ19fKGtleSkgICAgICAgICAgICAjIHN1cHBvcnQgc3ViY2xhc3NlcyB0aGF0IGRlZmluZSBfX21pc3NpbmdfXwoKIyAgICBkZWYgZ2V0KHNlbGYsIGtleSwgZGVmYXVsdD1Ob25lKToKIyAgICAgICAgcmV0dXJuIHNlbGZba2V5XSBpZiBrZXkgaW4gc2VsZiBlbHNlIGRlZmF1bHQKCiMgICAgZGVmIF9fbGVuX18oc2VsZik6CiMgICAgICAgIHJldHVybiBsZW4oc2V0KCkudW5pb24oKnNlbGYubWFwcykpICAgICAjIHJldXNlcyBzdG9yZWQgaGFzaCB2YWx1ZXMgaWYgcG9zc2libGUKCiMgICAgZGVmIF9faXRlcl9fKHNlbGYpOgojICAgICAgICByZXR1cm4gaXRlcihzZXQoKS51bmlvbigqc2VsZi5tYXBzKSkKCiMgICAgZGVmIF9fY29udGFpbnNfXyhzZWxmLCBrZXkpOgojICAgICAgICByZXR1cm4gYW55KGtleSBpbiBtIGZvciBtIGluIHNlbGYubWFwcykKCiMgICAgZGVmIF9fYm9vbF9fKHNlbGYpOgojICAgICAgICByZXR1cm4gYW55KHNlbGYubWFwcykKCiAgICAjZml4bWUsIGJyeXRob24KICAgICNAX3JlY3Vyc2l2ZV9yZXByKCkKIyAgICBkZWYgX19yZXByX18oc2VsZik6CiMgICAgICAgIHJldHVybiAnezAuX19jbGFzc19fLl9fbmFtZV9ffSh7MX0pJy5mb3JtYXQoCiMgICAgICAgICAgICBzZWxmLCAnLCAnLmpvaW4obWFwKHJlcHIsIHNlbGYubWFwcykpKQoKIyAgICBAY2xhc3NtZXRob2QKIyAgICBkZWYgZnJvbWtleXMoY2xzLCBpdGVyYWJsZSwgKmFyZ3MpOgojICAgICAgICAnQ3JlYXRlIGEgQ2hhaW5NYXAgd2l0aCBhIHNpbmdsZSBkaWN0IGNyZWF0ZWQgZnJvbSB0aGUgaXRlcmFibGUuJwojICAgICAgICByZXR1cm4gY2xzKGRpY3QuZnJvbWtleXMoaXRlcmFibGUsICphcmdzKSkKCiMgICAgZGVmIGNvcHkoc2VsZik6CiMgICAgICAgICdOZXcgQ2hhaW5NYXAgb3Igc3ViY2xhc3Mgd2l0aCBhIG5ldyBjb3B5IG9mIG1hcHNbMF0gYW5kIHJlZnMgdG8gbWFwc1sxOl0nCiMgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLm1hcHNbMF0uY29weSgpLCAqc2VsZi5tYXBzWzE6XSkKCiMgICAgX19jb3B5X18gPSBjb3B5CgojICAgIGRlZiBuZXdfY2hpbGQoc2VsZik6ICAgICAgICAgICAgICAgICAgICAgICAgIyBsaWtlIERqYW5nbydzIENvbnRleHQucHVzaCgpCiMgICAgICAgICdOZXcgQ2hhaW5NYXAgd2l0aCBhIG5ldyBkaWN0IGZvbGxvd2VkIGJ5IGFsbCBwcmV2aW91cyBtYXBzLicKIyAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKHt9LCAqc2VsZi5tYXBzKQoKIyAgICBAcHJvcGVydHkKIyAgICBkZWYgcGFyZW50cyhzZWxmKTogICAgICAgICAgICAgICAgICAgICAgICAgICMgbGlrZSBEamFuZ28ncyBDb250ZXh0LnBvcCgpCiMgICAgICAgICdOZXcgQ2hhaW5NYXAgZnJvbSBtYXBzWzE6XS4nCiMgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXygqc2VsZi5tYXBzWzE6XSkKCiMgICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIGtleSwgdmFsdWUpOgojICAgICAgICBzZWxmLm1hcHNbMF1ba2V5XSA9IHZhbHVlCgojICAgIGRlZiBfX2RlbGl0ZW1fXyhzZWxmLCBrZXkpOgojICAgICAgICB0cnk6CiMgICAgICAgICAgICBkZWwgc2VsZi5tYXBzWzBdW2tleV0KIyAgICAgICAgZXhjZXB0IEtleUVycm9yOgojICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3IoJ0tleSBub3QgZm91bmQgaW4gdGhlIGZpcnN0IG1hcHBpbmc6IHshcn0nLmZvcm1hdChrZXkpKQoKIyAgICBkZWYgcG9waXRlbShzZWxmKToKIyAgICAgICAgJ1JlbW92ZSBhbmQgcmV0dXJuIGFuIGl0ZW0gcGFpciBmcm9tIG1hcHNbMF0uIFJhaXNlIEtleUVycm9yIGlzIG1hcHNbMF0gaXMgZW1wdHkuJwojICAgICAgICB0cnk6CiMgICAgICAgICAgICByZXR1cm4gc2VsZi5tYXBzWzBdLnBvcGl0ZW0oKQojICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiMgICAgICAgICAgICByYWlzZSBLZXlFcnJvcignTm8ga2V5cyBmb3VuZCBpbiB0aGUgZmlyc3QgbWFwcGluZy4nKQoKIyAgICBkZWYgcG9wKHNlbGYsIGtleSwgKmFyZ3MpOgojICAgICAgICAnUmVtb3ZlICprZXkqIGZyb20gbWFwc1swXSBhbmQgcmV0dXJuIGl0cyB2YWx1ZS4gUmFpc2UgS2V5RXJyb3IgaWYgKmtleSogbm90IGluIG1hcHNbMF0uJwojICAgICAgICB0cnk6CiMgICAgICAgICAgICByZXR1cm4gc2VsZi5tYXBzWzBdLnBvcChrZXksICphcmdzKQojICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiMgICAgICAgICAgICAjcmFpc2UgS2V5RXJyb3IoJ0tleSBub3QgZm91bmQgaW4gdGhlIGZpcnN0IG1hcHBpbmc6IHshcn0nLmZvcm1hdChrZXkpKQojICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3IoJ0tleSBub3QgZm91bmQgaW4gdGhlIGZpcnN0IG1hcHBpbmc6ICVzJyAlIGtleSkKCiMgICAgZGVmIGNsZWFyKHNlbGYpOgojICAgICAgICAnQ2xlYXIgbWFwc1swXSwgbGVhdmluZyBtYXBzWzE6XSBpbnRhY3QuJwojICAgICAgICBzZWxmLm1hcHNbMF0uY2xlYXIoKQoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIyBVc2VyRGljdAojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKI2NsYXNzIFVzZXJEaWN0KE11dGFibGVNYXBwaW5nKToKCiAgICAjIFN0YXJ0IGJ5IGZpbGxpbmctb3V0IHRoZSBhYnN0cmFjdCBtZXRob2RzCiMgICAgZGVmIF9faW5pdF9fKHNlbGYsIGRpY3Q9Tm9uZSwgKiprd2FyZ3MpOgojICAgICAgICBzZWxmLmRhdGEgPSB7fQojICAgICAgICBpZiBkaWN0IGlzIG5vdCBOb25lOgojICAgICAgICAgICAgc2VsZi51cGRhdGUoZGljdCkKIyAgICAgICAgaWYgbGVuKGt3YXJncyk6CiMgICAgICAgICAgICBzZWxmLnVwZGF0ZShrd2FyZ3MpCiMgICAgZGVmIF9fbGVuX18oc2VsZik6IHJldHVybiBsZW4oc2VsZi5kYXRhKQojICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBrZXkpOgojICAgICAgICBpZiBrZXkgaW4gc2VsZi5kYXRhOgojICAgICAgICAgICAgcmV0dXJuIHNlbGYuZGF0YVtrZXldCiMgICAgICAgIGlmIGhhc2F0dHIoc2VsZi5fX2NsYXNzX18sICJfX21pc3NpbmdfXyIpOgojICAgICAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fLl9fbWlzc2luZ19fKHNlbGYsIGtleSkKIyAgICAgICAgcmFpc2UgS2V5RXJyb3Ioa2V5KQojICAgIGRlZiBfX3NldGl0ZW1fXyhzZWxmLCBrZXksIGl0ZW0pOiBzZWxmLmRhdGFba2V5XSA9IGl0ZW0KIyAgICBkZWYgX19kZWxpdGVtX18oc2VsZiwga2V5KTogZGVsIHNlbGYuZGF0YVtrZXldCiMgICAgZGVmIF9faXRlcl9fKHNlbGYpOgojICAgICAgICByZXR1cm4gaXRlcihzZWxmLmRhdGEpCgogICAgIyBNb2RpZnkgX19jb250YWluc19fIHRvIHdvcmsgY29ycmVjdGx5IHdoZW4gX19taXNzaW5nX18gaXMgcHJlc2VudAojICAgIGRlZiBfX2NvbnRhaW5zX18oc2VsZiwga2V5KToKIyAgICAgICAgcmV0dXJuIGtleSBpbiBzZWxmLmRhdGEKCiAgICAjIE5vdywgYWRkIHRoZSBtZXRob2RzIGluIGRpY3RzIGJ1dCBub3QgaW4gTXV0YWJsZU1hcHBpbmcKIyAgICBkZWYgX19yZXByX18oc2VsZik6IHJldHVybiByZXByKHNlbGYuZGF0YSkKIyAgICBkZWYgY29weShzZWxmKToKIyAgICAgICAgaWYgc2VsZi5fX2NsYXNzX18gaXMgVXNlckRpY3Q6CiMgICAgICAgICAgICByZXR1cm4gVXNlckRpY3Qoc2VsZi5kYXRhLmNvcHkoKSkKIyAgICAgICAgaW1wb3J0IGNvcHkKIyAgICAgICAgZGF0YSA9IHNlbGYuZGF0YQojICAgICAgICB0cnk6CiMgICAgICAgICAgICBzZWxmLmRhdGEgPSB7fQojICAgICAgICAgICAgYyA9IGNvcHkuY29weShzZWxmKQojICAgICAgICBmaW5hbGx5OgojICAgICAgICAgICAgc2VsZi5kYXRhID0gZGF0YQojICAgICAgICBjLnVwZGF0ZShzZWxmKQojICAgICAgICByZXR1cm4gYwojICAgIEBjbGFzc21ldGhvZAojICAgIGRlZiBmcm9ta2V5cyhjbHMsIGl0ZXJhYmxlLCB2YWx1ZT1Ob25lKToKIyAgICAgICAgZCA9IGNscygpCiMgICAgICAgIGZvciBrZXkgaW4gaXRlcmFibGU6CiMgICAgICAgICAgICBkW2tleV0gPSB2YWx1ZQojICAgICAgICByZXR1cm4gZAoKCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMgVXNlckxpc3QKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiNjbGFzcyBVc2VyTGlzdChNdXRhYmxlU2VxdWVuY2UpOgojICAgICcnJ0EgbW9yZSBvciBsZXNzIGNvbXBsZXRlIHVzZXItZGVmaW5lZCB3cmFwcGVyIGFyb3VuZCBsaXN0IG9iamVjdHMuJycnCiMgICAgZGVmIF9faW5pdF9fKHNlbGYsIGluaXRsaXN0PU5vbmUpOgojICAgICAgICBzZWxmLmRhdGEgPSBbXQojICAgICAgICBpZiBpbml0bGlzdCBpcyBub3QgTm9uZToKIyAgICAgICAgICAgICMgWFhYIHNob3VsZCB0aGlzIGFjY2VwdCBhbiBhcmJpdHJhcnkgc2VxdWVuY2U/CiMgICAgICAgICAgICBpZiB0eXBlKGluaXRsaXN0KSA9PSB0eXBlKHNlbGYuZGF0YSk6CiMgICAgICAgICAgICAgICAgc2VsZi5kYXRhWzpdID0gaW5pdGxpc3QKIyAgICAgICAgICAgIGVsaWYgaXNpbnN0YW5jZShpbml0bGlzdCwgVXNlckxpc3QpOgojICAgICAgICAgICAgICAgIHNlbGYuZGF0YVs6XSA9IGluaXRsaXN0LmRhdGFbOl0KIyAgICAgICAgICAgIGVsc2U6CiMgICAgICAgICAgICAgICAgc2VsZi5kYXRhID0gbGlzdChpbml0bGlzdCkKIyAgICBkZWYgX19yZXByX18oc2VsZik6IHJldHVybiByZXByKHNlbGYuZGF0YSkKIyAgICBkZWYgX19sdF9fKHNlbGYsIG90aGVyKTogcmV0dXJuIHNlbGYuZGF0YSA8ICBzZWxmLl9fY2FzdChvdGhlcikKIyAgICBkZWYgX19sZV9fKHNlbGYsIG90aGVyKTogcmV0dXJuIHNlbGYuZGF0YSA8PSBzZWxmLl9fY2FzdChvdGhlcikKIyAgICBkZWYgX19lcV9fKHNlbGYsIG90aGVyKTogcmV0dXJuIHNlbGYuZGF0YSA9PSBzZWxmLl9fY2FzdChvdGhlcikKIyAgICBkZWYgX19uZV9fKHNlbGYsIG90aGVyKTogcmV0dXJuIHNlbGYuZGF0YSAhPSBzZWxmLl9fY2FzdChvdGhlcikKIyAgICBkZWYgX19ndF9fKHNlbGYsIG90aGVyKTogcmV0dXJuIHNlbGYuZGF0YSA+ICBzZWxmLl9fY2FzdChvdGhlcikKIyAgICBkZWYgX19nZV9fKHNlbGYsIG90aGVyKTogcmV0dXJuIHNlbGYuZGF0YSA+PSBzZWxmLl9fY2FzdChvdGhlcikKIyAgICBkZWYgX19jYXN0KHNlbGYsIG90aGVyKToKIyAgICAgICAgcmV0dXJuIG90aGVyLmRhdGEgaWYgaXNpbnN0YW5jZShvdGhlciwgVXNlckxpc3QpIGVsc2Ugb3RoZXIKIyAgICBkZWYgX19jb250YWluc19fKHNlbGYsIGl0ZW0pOiByZXR1cm4gaXRlbSBpbiBzZWxmLmRhdGEKIyAgICBkZWYgX19sZW5fXyhzZWxmKTogcmV0dXJuIGxlbihzZWxmLmRhdGEpCiMgICAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGkpOiByZXR1cm4gc2VsZi5kYXRhW2ldCiMgICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIGksIGl0ZW0pOiBzZWxmLmRhdGFbaV0gPSBpdGVtCiMgICAgZGVmIF9fZGVsaXRlbV9fKHNlbGYsIGkpOiBkZWwgc2VsZi5kYXRhW2ldCiMgICAgZGVmIF9fYWRkX18oc2VsZiwgb3RoZXIpOgojICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBVc2VyTGlzdCk6CiMgICAgICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhICsgb3RoZXIuZGF0YSkKIyAgICAgICAgZWxpZiBpc2luc3RhbmNlKG90aGVyLCB0eXBlKHNlbGYuZGF0YSkpOgojICAgICAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKHNlbGYuZGF0YSArIG90aGVyKQojICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhICsgbGlzdChvdGhlcikpCiMgICAgZGVmIF9fcmFkZF9fKHNlbGYsIG90aGVyKToKIyAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgVXNlckxpc3QpOgojICAgICAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKG90aGVyLmRhdGEgKyBzZWxmLmRhdGEpCiMgICAgICAgIGVsaWYgaXNpbnN0YW5jZShvdGhlciwgdHlwZShzZWxmLmRhdGEpKToKIyAgICAgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhvdGhlciArIHNlbGYuZGF0YSkKIyAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKGxpc3Qob3RoZXIpICsgc2VsZi5kYXRhKQojICAgIGRlZiBfX2lhZGRfXyhzZWxmLCBvdGhlcik6CiMgICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIFVzZXJMaXN0KToKIyAgICAgICAgICAgIHNlbGYuZGF0YSArPSBvdGhlci5kYXRhCiMgICAgICAgIGVsaWYgaXNpbnN0YW5jZShvdGhlciwgdHlwZShzZWxmLmRhdGEpKToKIyAgICAgICAgICAgIHNlbGYuZGF0YSArPSBvdGhlcgojICAgICAgICBlbHNlOgojICAgICAgICAgICAgc2VsZi5kYXRhICs9IGxpc3Qob3RoZXIpCiMgICAgICAgIHJldHVybiBzZWxmCiMgICAgZGVmIF9fbXVsX18oc2VsZiwgbik6CiMgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGEqbikKIyAgICBfX3JtdWxfXyA9IF9fbXVsX18KIyAgICBkZWYgX19pbXVsX18oc2VsZiwgbik6CiMgICAgICAgIHNlbGYuZGF0YSAqPSBuCiMgICAgICAgIHJldHVybiBzZWxmCiMgICAgZGVmIGFwcGVuZChzZWxmLCBpdGVtKTogc2VsZi5kYXRhLmFwcGVuZChpdGVtKQojICAgIGRlZiBpbnNlcnQoc2VsZiwgaSwgaXRlbSk6IHNlbGYuZGF0YS5pbnNlcnQoaSwgaXRlbSkKIyAgICBkZWYgcG9wKHNlbGYsIGk9LTEpOiByZXR1cm4gc2VsZi5kYXRhLnBvcChpKQojICAgIGRlZiByZW1vdmUoc2VsZiwgaXRlbSk6IHNlbGYuZGF0YS5yZW1vdmUoaXRlbSkKIyAgICBkZWYgY291bnQoc2VsZiwgaXRlbSk6IHJldHVybiBzZWxmLmRhdGEuY291bnQoaXRlbSkKIyAgICBkZWYgaW5kZXgoc2VsZiwgaXRlbSwgKmFyZ3MpOiByZXR1cm4gc2VsZi5kYXRhLmluZGV4KGl0ZW0sICphcmdzKQojICAgIGRlZiByZXZlcnNlKHNlbGYpOiBzZWxmLmRhdGEucmV2ZXJzZSgpCiMgICAgZGVmIHNvcnQoc2VsZiwgKmFyZ3MsICoqa3dkcyk6IHNlbGYuZGF0YS5zb3J0KCphcmdzLCAqKmt3ZHMpCiMgICAgZGVmIGV4dGVuZChzZWxmLCBvdGhlcik6CiMgICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIFVzZXJMaXN0KToKIyAgICAgICAgICAgIHNlbGYuZGF0YS5leHRlbmQob3RoZXIuZGF0YSkKIyAgICAgICAgZWxzZToKIyAgICAgICAgICAgIHNlbGYuZGF0YS5leHRlbmQob3RoZXIpCgoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIyBVc2VyU3RyaW5nCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgojY2xhc3MgVXNlclN0cmluZyhTZXF1ZW5jZSk6CiMgICAgZGVmIF9faW5pdF9fKHNlbGYsIHNlcSk6CiMgICAgICAgIGlmIGlzaW5zdGFuY2Uoc2VxLCBzdHIpOgojICAgICAgICAgICAgc2VsZi5kYXRhID0gc2VxCiMgICAgICAgIGVsaWYgaXNpbnN0YW5jZShzZXEsIFVzZXJTdHJpbmcpOgojICAgICAgICAgICAgc2VsZi5kYXRhID0gc2VxLmRhdGFbOl0KIyAgICAgICAgZWxzZToKIyAgICAgICAgICAgIHNlbGYuZGF0YSA9IHN0cihzZXEpCiMgICAgZGVmIF9fc3RyX18oc2VsZik6IHJldHVybiBzdHIoc2VsZi5kYXRhKQojICAgIGRlZiBfX3JlcHJfXyhzZWxmKTogcmV0dXJuIHJlcHIoc2VsZi5kYXRhKQojICAgIGRlZiBfX2ludF9fKHNlbGYpOiByZXR1cm4gaW50KHNlbGYuZGF0YSkKIyAgICBkZWYgX19mbG9hdF9fKHNlbGYpOiByZXR1cm4gZmxvYXQoc2VsZi5kYXRhKQojICAgIGRlZiBfX2NvbXBsZXhfXyhzZWxmKTogcmV0dXJuIGNvbXBsZXgoc2VsZi5kYXRhKQojICAgIGRlZiBfX2hhc2hfXyhzZWxmKTogcmV0dXJuIGhhc2goc2VsZi5kYXRhKQoKIyAgICBkZWYgX19lcV9fKHNlbGYsIHN0cmluZyk6CiMgICAgICAgIGlmIGlzaW5zdGFuY2Uoc3RyaW5nLCBVc2VyU3RyaW5nKToKIyAgICAgICAgICAgIHJldHVybiBzZWxmLmRhdGEgPT0gc3RyaW5nLmRhdGEKIyAgICAgICAgcmV0dXJuIHNlbGYuZGF0YSA9PSBzdHJpbmcKIyAgICBkZWYgX19uZV9fKHNlbGYsIHN0cmluZyk6CiMgICAgICAgIGlmIGlzaW5zdGFuY2Uoc3RyaW5nLCBVc2VyU3RyaW5nKToKIyAgICAgICAgICAgIHJldHVybiBzZWxmLmRhdGEgIT0gc3RyaW5nLmRhdGEKIyAgICAgICAgcmV0dXJuIHNlbGYuZGF0YSAhPSBzdHJpbmcKIyAgICBkZWYgX19sdF9fKHNlbGYsIHN0cmluZyk6CiMgICAgICAgIGlmIGlzaW5zdGFuY2Uoc3RyaW5nLCBVc2VyU3RyaW5nKToKIyAgICAgICAgICAgIHJldHVybiBzZWxmLmRhdGEgPCBzdHJpbmcuZGF0YQojICAgICAgICByZXR1cm4gc2VsZi5kYXRhIDwgc3RyaW5nCiMgICAgZGVmIF9fbGVfXyhzZWxmLCBzdHJpbmcpOgojICAgICAgICBpZiBpc2luc3RhbmNlKHN0cmluZywgVXNlclN0cmluZyk6CiMgICAgICAgICAgICByZXR1cm4gc2VsZi5kYXRhIDw9IHN0cmluZy5kYXRhCiMgICAgICAgIHJldHVybiBzZWxmLmRhdGEgPD0gc3RyaW5nCiMgICAgZGVmIF9fZ3RfXyhzZWxmLCBzdHJpbmcpOgojICAgICAgICBpZiBpc2luc3RhbmNlKHN0cmluZywgVXNlclN0cmluZyk6CiMgICAgICAgICAgICByZXR1cm4gc2VsZi5kYXRhID4gc3RyaW5nLmRhdGEKIyAgICAgICAgcmV0dXJuIHNlbGYuZGF0YSA+IHN0cmluZwojICAgIGRlZiBfX2dlX18oc2VsZiwgc3RyaW5nKToKIyAgICAgICAgaWYgaXNpbnN0YW5jZShzdHJpbmcsIFVzZXJTdHJpbmcpOgojICAgICAgICAgICAgcmV0dXJuIHNlbGYuZGF0YSA+PSBzdHJpbmcuZGF0YQojICAgICAgICByZXR1cm4gc2VsZi5kYXRhID49IHN0cmluZwoKIyAgICBkZWYgX19jb250YWluc19fKHNlbGYsIGNoYXIpOgojICAgICAgICBpZiBpc2luc3RhbmNlKGNoYXIsIFVzZXJTdHJpbmcpOgojICAgICAgICAgICAgY2hhciA9IGNoYXIuZGF0YQojICAgICAgICByZXR1cm4gY2hhciBpbiBzZWxmLmRhdGEKCiMgICAgZGVmIF9fbGVuX18oc2VsZik6IHJldHVybiBsZW4oc2VsZi5kYXRhKQojICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBpbmRleCk6IHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGFbaW5kZXhdKQojICAgIGRlZiBfX2FkZF9fKHNlbGYsIG90aGVyKToKIyAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgVXNlclN0cmluZyk6CiMgICAgICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhICsgb3RoZXIuZGF0YSkKIyAgICAgICAgZWxpZiBpc2luc3RhbmNlKG90aGVyLCBzdHIpOgojICAgICAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKHNlbGYuZGF0YSArIG90aGVyKQojICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhICsgc3RyKG90aGVyKSkKIyAgICBkZWYgX19yYWRkX18oc2VsZiwgb3RoZXIpOgojICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBzdHIpOgojICAgICAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKG90aGVyICsgc2VsZi5kYXRhKQojICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc3RyKG90aGVyKSArIHNlbGYuZGF0YSkKIyAgICBkZWYgX19tdWxfXyhzZWxmLCBuKToKIyAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKHNlbGYuZGF0YSpuKQojICAgIF9fcm11bF9fID0gX19tdWxfXwojICAgIGRlZiBfX21vZF9fKHNlbGYsIGFyZ3MpOgojICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhICUgYXJncykKCiAgICAjIHRoZSBmb2xsb3dpbmcgbWV0aG9kcyBhcmUgZGVmaW5lZCBpbiBhbHBoYWJldGljYWwgb3JkZXI6CiMgICAgZGVmIGNhcGl0YWxpemUoc2VsZik6IHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGEuY2FwaXRhbGl6ZSgpKQojICAgIGRlZiBjZW50ZXIoc2VsZiwgd2lkdGgsICphcmdzKToKIyAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKHNlbGYuZGF0YS5jZW50ZXIod2lkdGgsICphcmdzKSkKIyAgICBkZWYgY291bnQoc2VsZiwgc3ViLCBzdGFydD0wLCBlbmQ9X3N5cy5tYXhzaXplKToKIyAgICAgICAgaWYgaXNpbnN0YW5jZShzdWIsIFVzZXJTdHJpbmcpOgojICAgICAgICAgICAgc3ViID0gc3ViLmRhdGEKIyAgICAgICAgcmV0dXJuIHNlbGYuZGF0YS5jb3VudChzdWIsIHN0YXJ0LCBlbmQpCiMgICAgZGVmIGVuY29kZShzZWxmLCBlbmNvZGluZz1Ob25lLCBlcnJvcnM9Tm9uZSk6ICMgWFhYIGltcHJvdmUgdGhpcz8KIyAgICAgICAgaWYgZW5jb2Rpbmc6CiMgICAgICAgICAgICBpZiBlcnJvcnM6CiMgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKHNlbGYuZGF0YS5lbmNvZGUoZW5jb2RpbmcsIGVycm9ycykpCiMgICAgICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhLmVuY29kZShlbmNvZGluZykpCiMgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGEuZW5jb2RlKCkpCiMgICAgZGVmIGVuZHN3aXRoKHNlbGYsIHN1ZmZpeCwgc3RhcnQ9MCwgZW5kPV9zeXMubWF4c2l6ZSk6CiMgICAgICAgIHJldHVybiBzZWxmLmRhdGEuZW5kc3dpdGgoc3VmZml4LCBzdGFydCwgZW5kKQojICAgIGRlZiBleHBhbmR0YWJzKHNlbGYsIHRhYnNpemU9OCk6CiMgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGEuZXhwYW5kdGFicyh0YWJzaXplKSkKIyAgICBkZWYgZmluZChzZWxmLCBzdWIsIHN0YXJ0PTAsIGVuZD1fc3lzLm1heHNpemUpOgojICAgICAgICBpZiBpc2luc3RhbmNlKHN1YiwgVXNlclN0cmluZyk6CiMgICAgICAgICAgICBzdWIgPSBzdWIuZGF0YQojICAgICAgICByZXR1cm4gc2VsZi5kYXRhLmZpbmQoc3ViLCBzdGFydCwgZW5kKQojICAgIGRlZiBmb3JtYXQoc2VsZiwgKmFyZ3MsICoqa3dkcyk6CiMgICAgICAgIHJldHVybiBzZWxmLmRhdGEuZm9ybWF0KCphcmdzLCAqKmt3ZHMpCiMgICAgZGVmIGluZGV4KHNlbGYsIHN1Yiwgc3RhcnQ9MCwgZW5kPV9zeXMubWF4c2l6ZSk6CiMgICAgICAgIHJldHVybiBzZWxmLmRhdGEuaW5kZXgoc3ViLCBzdGFydCwgZW5kKQojICAgIGRlZiBpc2FscGhhKHNlbGYpOiByZXR1cm4gc2VsZi5kYXRhLmlzYWxwaGEoKQojICAgIGRlZiBpc2FsbnVtKHNlbGYpOiByZXR1cm4gc2VsZi5kYXRhLmlzYWxudW0oKQojICAgIGRlZiBpc2RlY2ltYWwoc2VsZik6IHJldHVybiBzZWxmLmRhdGEuaXNkZWNpbWFsKCkKIyAgICBkZWYgaXNkaWdpdChzZWxmKTogcmV0dXJuIHNlbGYuZGF0YS5pc2RpZ2l0KCkKIyAgICBkZWYgaXNpZGVudGlmaWVyKHNlbGYpOiByZXR1cm4gc2VsZi5kYXRhLmlzaWRlbnRpZmllcigpCiMgICAgZGVmIGlzbG93ZXIoc2VsZik6IHJldHVybiBzZWxmLmRhdGEuaXNsb3dlcigpCiMgICAgZGVmIGlzbnVtZXJpYyhzZWxmKTogcmV0dXJuIHNlbGYuZGF0YS5pc251bWVyaWMoKQojICAgIGRlZiBpc3NwYWNlKHNlbGYpOiByZXR1cm4gc2VsZi5kYXRhLmlzc3BhY2UoKQojICAgIGRlZiBpc3RpdGxlKHNlbGYpOiByZXR1cm4gc2VsZi5kYXRhLmlzdGl0bGUoKQojICAgIGRlZiBpc3VwcGVyKHNlbGYpOiByZXR1cm4gc2VsZi5kYXRhLmlzdXBwZXIoKQojICAgIGRlZiBqb2luKHNlbGYsIHNlcSk6IHJldHVybiBzZWxmLmRhdGEuam9pbihzZXEpCiMgICAgZGVmIGxqdXN0KHNlbGYsIHdpZHRoLCAqYXJncyk6CiMgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGEubGp1c3Qod2lkdGgsICphcmdzKSkKIyAgICBkZWYgbG93ZXIoc2VsZik6IHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGEubG93ZXIoKSkKIyAgICBkZWYgbHN0cmlwKHNlbGYsIGNoYXJzPU5vbmUpOiByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhLmxzdHJpcChjaGFycykpCiMgICAgZGVmIHBhcnRpdGlvbihzZWxmLCBzZXApOgojICAgICAgICByZXR1cm4gc2VsZi5kYXRhLnBhcnRpdGlvbihzZXApCiMgICAgZGVmIHJlcGxhY2Uoc2VsZiwgb2xkLCBuZXcsIG1heHNwbGl0PS0xKToKIyAgICAgICAgaWYgaXNpbnN0YW5jZShvbGQsIFVzZXJTdHJpbmcpOgojICAgICAgICAgICAgb2xkID0gb2xkLmRhdGEKIyAgICAgICAgaWYgaXNpbnN0YW5jZShuZXcsIFVzZXJTdHJpbmcpOgojICAgICAgICAgICAgbmV3ID0gbmV3LmRhdGEKIyAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKHNlbGYuZGF0YS5yZXBsYWNlKG9sZCwgbmV3LCBtYXhzcGxpdCkpCiMgICAgZGVmIHJmaW5kKHNlbGYsIHN1Yiwgc3RhcnQ9MCwgZW5kPV9zeXMubWF4c2l6ZSk6CiMgICAgICAgIGlmIGlzaW5zdGFuY2Uoc3ViLCBVc2VyU3RyaW5nKToKIyAgICAgICAgICAgIHN1YiA9IHN1Yi5kYXRhCiMgICAgICAgIHJldHVybiBzZWxmLmRhdGEucmZpbmQoc3ViLCBzdGFydCwgZW5kKQojICAgIGRlZiByaW5kZXgoc2VsZiwgc3ViLCBzdGFydD0wLCBlbmQ9X3N5cy5tYXhzaXplKToKIyAgICAgICAgcmV0dXJuIHNlbGYuZGF0YS5yaW5kZXgoc3ViLCBzdGFydCwgZW5kKQojICAgIGRlZiByanVzdChzZWxmLCB3aWR0aCwgKmFyZ3MpOgojICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhLnJqdXN0KHdpZHRoLCAqYXJncykpCiMgICAgZGVmIHJwYXJ0aXRpb24oc2VsZiwgc2VwKToKIyAgICAgICAgcmV0dXJuIHNlbGYuZGF0YS5ycGFydGl0aW9uKHNlcCkKIyAgICBkZWYgcnN0cmlwKHNlbGYsIGNoYXJzPU5vbmUpOgojICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhLnJzdHJpcChjaGFycykpCiMgICAgZGVmIHNwbGl0KHNlbGYsIHNlcD1Ob25lLCBtYXhzcGxpdD0tMSk6CiMgICAgICAgIHJldHVybiBzZWxmLmRhdGEuc3BsaXQoc2VwLCBtYXhzcGxpdCkKIyAgICBkZWYgcnNwbGl0KHNlbGYsIHNlcD1Ob25lLCBtYXhzcGxpdD0tMSk6CiMgICAgICAgIHJldHVybiBzZWxmLmRhdGEucnNwbGl0KHNlcCwgbWF4c3BsaXQpCiMgICAgZGVmIHNwbGl0bGluZXMoc2VsZiwga2VlcGVuZHM9MCk6IHJldHVybiBzZWxmLmRhdGEuc3BsaXRsaW5lcyhrZWVwZW5kcykKIyAgICBkZWYgc3RhcnRzd2l0aChzZWxmLCBwcmVmaXgsIHN0YXJ0PTAsIGVuZD1fc3lzLm1heHNpemUpOgojICAgICAgICByZXR1cm4gc2VsZi5kYXRhLnN0YXJ0c3dpdGgocHJlZml4LCBzdGFydCwgZW5kKQojICAgIGRlZiBzdHJpcChzZWxmLCBjaGFycz1Ob25lKTogcmV0dXJuIHNlbGYuX19jbGFzc19fKHNlbGYuZGF0YS5zdHJpcChjaGFycykpCiMgICAgZGVmIHN3YXBjYXNlKHNlbGYpOiByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhLnN3YXBjYXNlKCkpCiMgICAgZGVmIHRpdGxlKHNlbGYpOiByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhLnRpdGxlKCkpCiMgICAgZGVmIHRyYW5zbGF0ZShzZWxmLCAqYXJncyk6CiMgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGEudHJhbnNsYXRlKCphcmdzKSkKIyAgICBkZWYgdXBwZXIoc2VsZik6IHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGEudXBwZXIoKSkKIyAgICBkZWYgemZpbGwoc2VsZiwgd2lkdGgpOiByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhLnpmaWxsKHdpZHRoKSkKCg==',
'/Lib/colorsys.py':'IiIiQ29udmVyc2lvbiBmdW5jdGlvbnMgYmV0d2VlbiBSR0IgYW5kIG90aGVyIGNvbG9yIHN5c3RlbXMuCgpUaGlzIG1vZHVsZXMgcHJvdmlkZXMgdHdvIGZ1bmN0aW9ucyBmb3IgZWFjaCBjb2xvciBzeXN0ZW0gQUJDOgoKICByZ2JfdG9fYWJjKHIsIGcsIGIpIC0tPiBhLCBiLCBjCiAgYWJjX3RvX3JnYihhLCBiLCBjKSAtLT4gciwgZywgYgoKQWxsIGlucHV0cyBhbmQgb3V0cHV0cyBhcmUgdHJpcGxlcyBvZiBmbG9hdHMgaW4gdGhlIHJhbmdlIFswLjAuLi4xLjBdCih3aXRoIHRoZSBleGNlcHRpb24gb2YgSSBhbmQgUSwgd2hpY2ggY292ZXJzIGEgc2xpZ2h0bHkgbGFyZ2VyIHJhbmdlKS4KSW5wdXRzIG91dHNpZGUgdGhlIHZhbGlkIHJhbmdlIG1heSBjYXVzZSBleGNlcHRpb25zIG9yIGludmFsaWQgb3V0cHV0cy4KClN1cHBvcnRlZCBjb2xvciBzeXN0ZW1zOgpSR0I6IFJlZCwgR3JlZW4sIEJsdWUgY29tcG9uZW50cwpZSVE6IEx1bWluYW5jZSwgQ2hyb21pbmFuY2UgKHVzZWQgYnkgY29tcG9zaXRlIHZpZGVvIHNpZ25hbHMpCkhMUzogSHVlLCBMdW1pbmFuY2UsIFNhdHVyYXRpb24KSFNWOiBIdWUsIFNhdHVyYXRpb24sIFZhbHVlCiIiIgoKIyBSZWZlcmVuY2VzOgojIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvWUlRCiMgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9ITFNfY29sb3Jfc3BhY2UKIyBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0hTVl9jb2xvcl9zcGFjZQoKX19hbGxfXyA9IFsicmdiX3RvX3lpcSIsInlpcV90b19yZ2IiLCJyZ2JfdG9faGxzIiwiaGxzX3RvX3JnYiIsCiAgICAgICAgICAgInJnYl90b19oc3YiLCJoc3ZfdG9fcmdiIl0KCiMgU29tZSBmbG9hdGluZyBwb2ludCBjb25zdGFudHMKCk9ORV9USElSRCA9IDEuMC8zLjAKT05FX1NJWFRIID0gMS4wLzYuMApUV09fVEhJUkQgPSAyLjAvMy4wCgojIFlJUTogdXNlZCBieSBjb21wb3NpdGUgdmlkZW8gc2lnbmFscyAobGluZWFyIGNvbWJpbmF0aW9ucyBvZiBSR0IpCiMgWTogcGVyY2VpdmVkIGdyZXkgbGV2ZWwgKDAuMCA9PSBibGFjaywgMS4wID09IHdoaXRlKQojIEksIFE6IGNvbG9yIGNvbXBvbmVudHMKCmRlZiByZ2JfdG9feWlxKHIsIGcsIGIpOgogICAgeSA9IDAuMzAqciArIDAuNTkqZyArIDAuMTEqYgogICAgaSA9IDAuNjAqciAtIDAuMjgqZyAtIDAuMzIqYgogICAgcSA9IDAuMjEqciAtIDAuNTIqZyArIDAuMzEqYgogICAgcmV0dXJuICh5LCBpLCBxKQoKZGVmIHlpcV90b19yZ2IoeSwgaSwgcSk6CiAgICByID0geSArIDAuOTQ4MjYyKmkgKyAwLjYyNDAxMypxCiAgICBnID0geSAtIDAuMjc2MDY2KmkgLSAwLjYzOTgxMCpxCiAgICBiID0geSAtIDEuMTA1NDUwKmkgKyAxLjcyOTg2MCpxCiAgICBpZiByIDwgMC4wOgogICAgICAgIHIgPSAwLjAKICAgIGlmIGcgPCAwLjA6CiAgICAgICAgZyA9IDAuMAogICAgaWYgYiA8IDAuMDoKICAgICAgICBiID0gMC4wCiAgICBpZiByID4gMS4wOgogICAgICAgIHIgPSAxLjAKICAgIGlmIGcgPiAxLjA6CiAgICAgICAgZyA9IDEuMAogICAgaWYgYiA+IDEuMDoKICAgICAgICBiID0gMS4wCiAgICByZXR1cm4gKHIsIGcsIGIpCgoKIyBITFM6IEh1ZSwgTHVtaW5hbmNlLCBTYXR1cmF0aW9uCiMgSDogcG9zaXRpb24gaW4gdGhlIHNwZWN0cnVtCiMgTDogY29sb3IgbGlnaHRuZXNzCiMgUzogY29sb3Igc2F0dXJhdGlvbgoKZGVmIHJnYl90b19obHMociwgZywgYik6CiAgICBtYXhjID0gbWF4KHIsIGcsIGIpCiAgICBtaW5jID0gbWluKHIsIGcsIGIpCiAgICAjIFhYWCBDYW4gb3B0aW1pemUgKG1heGMrbWluYykgYW5kIChtYXhjLW1pbmMpCiAgICBsID0gKG1pbmMrbWF4YykvMi4wCiAgICBpZiBtaW5jID09IG1heGM6CiAgICAgICAgcmV0dXJuIDAuMCwgbCwgMC4wCiAgICBpZiBsIDw9IDAuNToKICAgICAgICBzID0gKG1heGMtbWluYykgLyAobWF4YyttaW5jKQogICAgZWxzZToKICAgICAgICBzID0gKG1heGMtbWluYykgLyAoMi4wLW1heGMtbWluYykKICAgIHJjID0gKG1heGMtcikgLyAobWF4Yy1taW5jKQogICAgZ2MgPSAobWF4Yy1nKSAvIChtYXhjLW1pbmMpCiAgICBiYyA9IChtYXhjLWIpIC8gKG1heGMtbWluYykKICAgIGlmIHIgPT0gbWF4YzoKICAgICAgICBoID0gYmMtZ2MKICAgIGVsaWYgZyA9PSBtYXhjOgogICAgICAgIGggPSAyLjArcmMtYmMKICAgIGVsc2U6CiAgICAgICAgaCA9IDQuMCtnYy1yYwogICAgaCA9IChoLzYuMCkgJSAxLjAKICAgIHJldHVybiBoLCBsLCBzCgpkZWYgaGxzX3RvX3JnYihoLCBsLCBzKToKICAgIGlmIHMgPT0gMC4wOgogICAgICAgIHJldHVybiBsLCBsLCBsCiAgICBpZiBsIDw9IDAuNToKICAgICAgICBtMiA9IGwgKiAoMS4wK3MpCiAgICBlbHNlOgogICAgICAgIG0yID0gbCtzLShsKnMpCiAgICBtMSA9IDIuMCpsIC0gbTIKICAgIHJldHVybiAoX3YobTEsIG0yLCBoK09ORV9USElSRCksIF92KG0xLCBtMiwgaCksIF92KG0xLCBtMiwgaC1PTkVfVEhJUkQpKQoKZGVmIF92KG0xLCBtMiwgaHVlKToKICAgIGh1ZSA9IGh1ZSAlIDEuMAogICAgaWYgaHVlIDwgT05FX1NJWFRIOgogICAgICAgIHJldHVybiBtMSArIChtMi1tMSkqaHVlKjYuMAogICAgaWYgaHVlIDwgMC41OgogICAgICAgIHJldHVybiBtMgogICAgaWYgaHVlIDwgVFdPX1RISVJEOgogICAgICAgIHJldHVybiBtMSArIChtMi1tMSkqKFRXT19USElSRC1odWUpKjYuMAogICAgcmV0dXJuIG0xCgoKIyBIU1Y6IEh1ZSwgU2F0dXJhdGlvbiwgVmFsdWUKIyBIOiBwb3NpdGlvbiBpbiB0aGUgc3BlY3RydW0KIyBTOiBjb2xvciBzYXR1cmF0aW9uICgicHVyaXR5IikKIyBWOiBjb2xvciBicmlnaHRuZXNzCgpkZWYgcmdiX3RvX2hzdihyLCBnLCBiKToKICAgIG1heGMgPSBtYXgociwgZywgYikKICAgIG1pbmMgPSBtaW4ociwgZywgYikKICAgIHYgPSBtYXhjCiAgICBpZiBtaW5jID09IG1heGM6CiAgICAgICAgcmV0dXJuIDAuMCwgMC4wLCB2CiAgICBzID0gKG1heGMtbWluYykgLyBtYXhjCiAgICByYyA9IChtYXhjLXIpIC8gKG1heGMtbWluYykKICAgIGdjID0gKG1heGMtZykgLyAobWF4Yy1taW5jKQogICAgYmMgPSAobWF4Yy1iKSAvIChtYXhjLW1pbmMpCiAgICBpZiByID09IG1heGM6CiAgICAgICAgaCA9IGJjLWdjCiAgICBlbGlmIGcgPT0gbWF4YzoKICAgICAgICBoID0gMi4wK3JjLWJjCiAgICBlbHNlOgogICAgICAgIGggPSA0LjArZ2MtcmMKICAgIGggPSAoaC82LjApICUgMS4wCiAgICByZXR1cm4gaCwgcywgdgoKZGVmIGhzdl90b19yZ2IoaCwgcywgdik6CiAgICBpZiBzID09IDAuMDoKICAgICAgICByZXR1cm4gdiwgdiwgdgogICAgaSA9IGludChoKjYuMCkgIyBYWFggYXNzdW1lIGludCgpIHRydW5jYXRlcyEKICAgIGYgPSAoaCo2LjApIC0gaQogICAgcCA9IHYqKDEuMCAtIHMpCiAgICBxID0gdiooMS4wIC0gcypmKQogICAgdCA9IHYqKDEuMCAtIHMqKDEuMC1mKSkKICAgIGkgPSBpJTYKICAgIGlmIGkgPT0gMDoKICAgICAgICByZXR1cm4gdiwgdCwgcAogICAgaWYgaSA9PSAxOgogICAgICAgIHJldHVybiBxLCB2LCBwCiAgICBpZiBpID09IDI6CiAgICAgICAgcmV0dXJuIHAsIHYsIHQKICAgIGlmIGkgPT0gMzoKICAgICAgICByZXR1cm4gcCwgcSwgdgogICAgaWYgaSA9PSA0OgogICAgICAgIHJldHVybiB0LCBwLCB2CiAgICBpZiBpID09IDU6CiAgICAgICAgcmV0dXJuIHYsIHAsIHEKICAgICMgQ2Fubm90IGdldCBoZXJlCg==',
'/Lib/configparser.py':'IiIiQ29uZmlndXJhdGlvbiBmaWxlIHBhcnNlci4KCkEgY29uZmlndXJhdGlvbiBmaWxlIGNvbnNpc3RzIG9mIHNlY3Rpb25zLCBsZWFkIGJ5IGEgIltzZWN0aW9uXSIgaGVhZGVyLAphbmQgZm9sbG93ZWQgYnkgIm5hbWU6IHZhbHVlIiBlbnRyaWVzLCB3aXRoIGNvbnRpbnVhdGlvbnMgYW5kIHN1Y2ggaW4KdGhlIHN0eWxlIG9mIFJGQyA4MjIuCgpJbnRyaW5zaWMgZGVmYXVsdHMgY2FuIGJlIHNwZWNpZmllZCBieSBwYXNzaW5nIHRoZW0gaW50byB0aGUKQ29uZmlnUGFyc2VyIGNvbnN0cnVjdG9yIGFzIGEgZGljdGlvbmFyeS4KCmNsYXNzOgoKQ29uZmlnUGFyc2VyIC0tIHJlc3BvbnNpYmxlIGZvciBwYXJzaW5nIGEgbGlzdCBvZgogICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24gZmlsZXMsIGFuZCBtYW5hZ2luZyB0aGUgcGFyc2VkIGRhdGFiYXNlLgoKICAgIG1ldGhvZHM6CgogICAgX19pbml0X18oZGVmYXVsdHM9Tm9uZSwgZGljdF90eXBlPV9kZWZhdWx0X2RpY3QsIGFsbG93X25vX3ZhbHVlPUZhbHNlLAogICAgICAgICAgICAgZGVsaW1pdGVycz0oJz0nLCAnOicpLCBjb21tZW50X3ByZWZpeGVzPSgnIycsICc7JyksCiAgICAgICAgICAgICBpbmxpbmVfY29tbWVudF9wcmVmaXhlcz1Ob25lLCBzdHJpY3Q9VHJ1ZSwKICAgICAgICAgICAgIGVtcHR5X2xpbmVzX2luX3ZhbHVlcz1UcnVlKToKICAgICAgICBDcmVhdGUgdGhlIHBhcnNlci4gV2hlbiBgZGVmYXVsdHMnIGlzIGdpdmVuLCBpdCBpcyBpbml0aWFsaXplZCBpbnRvIHRoZQogICAgICAgIGRpY3Rpb25hcnkgb3IgaW50cmluc2ljIGRlZmF1bHRzLiBUaGUga2V5cyBtdXN0IGJlIHN0cmluZ3MsIHRoZSB2YWx1ZXMKICAgICAgICBtdXN0IGJlIGFwcHJvcHJpYXRlIGZvciAlKClzIHN0cmluZyBpbnRlcnBvbGF0aW9uLgoKICAgICAgICBXaGVuIGBkaWN0X3R5cGUnIGlzIGdpdmVuLCBpdCB3aWxsIGJlIHVzZWQgdG8gY3JlYXRlIHRoZSBkaWN0aW9uYXJ5CiAgICAgICAgb2JqZWN0cyBmb3IgdGhlIGxpc3Qgb2Ygc2VjdGlvbnMsIGZvciB0aGUgb3B0aW9ucyB3aXRoaW4gYSBzZWN0aW9uLCBhbmQKICAgICAgICBmb3IgdGhlIGRlZmF1bHQgdmFsdWVzLgoKICAgICAgICBXaGVuIGBkZWxpbWl0ZXJzJyBpcyBnaXZlbiwgaXQgd2lsbCBiZSB1c2VkIGFzIHRoZSBzZXQgb2Ygc3Vic3RyaW5ncwogICAgICAgIHRoYXQgZGl2aWRlIGtleXMgZnJvbSB2YWx1ZXMuCgogICAgICAgIFdoZW4gYGNvbW1lbnRfcHJlZml4ZXMnIGlzIGdpdmVuLCBpdCB3aWxsIGJlIHVzZWQgYXMgdGhlIHNldCBvZgogICAgICAgIHN1YnN0cmluZ3MgdGhhdCBwcmVmaXggY29tbWVudHMgaW4gZW1wdHkgbGluZXMuIENvbW1lbnRzIGNhbiBiZQogICAgICAgIGluZGVudGVkLgoKICAgICAgICBXaGVuIGBpbmxpbmVfY29tbWVudF9wcmVmaXhlcycgaXMgZ2l2ZW4sIGl0IHdpbGwgYmUgdXNlZCBhcyB0aGUgc2V0IG9mCiAgICAgICAgc3Vic3RyaW5ncyB0aGF0IHByZWZpeCBjb21tZW50cyBpbiBub24tZW1wdHkgbGluZXMuCgogICAgICAgIFdoZW4gYHN0cmljdGAgaXMgVHJ1ZSwgdGhlIHBhcnNlciB3b24ndCBhbGxvdyBmb3IgYW55IHNlY3Rpb24gb3Igb3B0aW9uCiAgICAgICAgZHVwbGljYXRlcyB3aGlsZSByZWFkaW5nIGZyb20gYSBzaW5nbGUgc291cmNlIChmaWxlLCBzdHJpbmcgb3IKICAgICAgICBkaWN0aW9uYXJ5KS4gRGVmYXVsdCBpcyBUcnVlLgoKICAgICAgICBXaGVuIGBlbXB0eV9saW5lc19pbl92YWx1ZXMnIGlzIEZhbHNlIChkZWZhdWx0OiBUcnVlKSwgZWFjaCBlbXB0eSBsaW5lCiAgICAgICAgbWFya3MgdGhlIGVuZCBvZiBhbiBvcHRpb24uIE90aGVyd2lzZSwgaW50ZXJuYWwgZW1wdHkgbGluZXMgb2YKICAgICAgICBhIG11bHRpbGluZSBvcHRpb24gYXJlIGtlcHQgYXMgcGFydCBvZiB0aGUgdmFsdWUuCgogICAgICAgIFdoZW4gYGFsbG93X25vX3ZhbHVlJyBpcyBUcnVlIChkZWZhdWx0OiBGYWxzZSksIG9wdGlvbnMgd2l0aG91dAogICAgICAgIHZhbHVlcyBhcmUgYWNjZXB0ZWQ7IHRoZSB2YWx1ZSBwcmVzZW50ZWQgZm9yIHRoZXNlIGlzIE5vbmUuCgogICAgc2VjdGlvbnMoKQogICAgICAgIFJldHVybiBhbGwgdGhlIGNvbmZpZ3VyYXRpb24gc2VjdGlvbiBuYW1lcywgc2FucyBERUZBVUxULgoKICAgIGhhc19zZWN0aW9uKHNlY3Rpb24pCiAgICAgICAgUmV0dXJuIHdoZXRoZXIgdGhlIGdpdmVuIHNlY3Rpb24gZXhpc3RzLgoKICAgIGhhc19vcHRpb24oc2VjdGlvbiwgb3B0aW9uKQogICAgICAgIFJldHVybiB3aGV0aGVyIHRoZSBnaXZlbiBvcHRpb24gZXhpc3RzIGluIHRoZSBnaXZlbiBzZWN0aW9uLgoKICAgIG9wdGlvbnMoc2VjdGlvbikKICAgICAgICBSZXR1cm4gbGlzdCBvZiBjb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHRoZSBuYW1lZCBzZWN0aW9uLgoKICAgIHJlYWQoZmlsZW5hbWVzLCBlbmNvZGluZz1Ob25lKQogICAgICAgIFJlYWQgYW5kIHBhcnNlIHRoZSBsaXN0IG9mIG5hbWVkIGNvbmZpZ3VyYXRpb24gZmlsZXMsIGdpdmVuIGJ5CiAgICAgICAgbmFtZS4gIEEgc2luZ2xlIGZpbGVuYW1lIGlzIGFsc28gYWxsb3dlZC4gIE5vbi1leGlzdGluZyBmaWxlcwogICAgICAgIGFyZSBpZ25vcmVkLiAgUmV0dXJuIGxpc3Qgb2Ygc3VjY2Vzc2Z1bGx5IHJlYWQgZmlsZXMuCgogICAgcmVhZF9maWxlKGYsIGZpbGVuYW1lPU5vbmUpCiAgICAgICAgUmVhZCBhbmQgcGFyc2Ugb25lIGNvbmZpZ3VyYXRpb24gZmlsZSwgZ2l2ZW4gYXMgYSBmaWxlIG9iamVjdC4KICAgICAgICBUaGUgZmlsZW5hbWUgZGVmYXVsdHMgdG8gZi5uYW1lOyBpdCBpcyBvbmx5IHVzZWQgaW4gZXJyb3IKICAgICAgICBtZXNzYWdlcyAoaWYgZiBoYXMgbm8gYG5hbWUnIGF0dHJpYnV0ZSwgdGhlIHN0cmluZyBgPD8/Pz4nIGlzIHVzZWQpLgoKICAgIHJlYWRfc3RyaW5nKHN0cmluZykKICAgICAgICBSZWFkIGNvbmZpZ3VyYXRpb24gZnJvbSBhIGdpdmVuIHN0cmluZy4KCiAgICByZWFkX2RpY3QoZGljdGlvbmFyeSkKICAgICAgICBSZWFkIGNvbmZpZ3VyYXRpb24gZnJvbSBhIGRpY3Rpb25hcnkuIEtleXMgYXJlIHNlY3Rpb24gbmFtZXMsCiAgICAgICAgdmFsdWVzIGFyZSBkaWN0aW9uYXJpZXMgd2l0aCBrZXlzIGFuZCB2YWx1ZXMgdGhhdCBzaG91bGQgYmUgcHJlc2VudAogICAgICAgIGluIHRoZSBzZWN0aW9uLiBJZiB0aGUgdXNlZCBkaWN0aW9uYXJ5IHR5cGUgcHJlc2VydmVzIG9yZGVyLCBzZWN0aW9ucwogICAgICAgIGFuZCB0aGVpciBrZXlzIHdpbGwgYmUgYWRkZWQgaW4gb3JkZXIuIFZhbHVlcyBhcmUgYXV0b21hdGljYWxseQogICAgICAgIGNvbnZlcnRlZCB0byBzdHJpbmdzLgoKICAgIGdldChzZWN0aW9uLCBvcHRpb24sIHJhdz1GYWxzZSwgdmFycz1Ob25lLCBmYWxsYmFjaz1fVU5TRVQpCiAgICAgICAgUmV0dXJuIGEgc3RyaW5nIHZhbHVlIGZvciB0aGUgbmFtZWQgb3B0aW9uLiAgQWxsICUgaW50ZXJwb2xhdGlvbnMgYXJlCiAgICAgICAgZXhwYW5kZWQgaW4gdGhlIHJldHVybiB2YWx1ZXMsIGJhc2VkIG9uIHRoZSBkZWZhdWx0cyBwYXNzZWQgaW50byB0aGUKICAgICAgICBjb25zdHJ1Y3RvciBhbmQgdGhlIERFRkFVTFQgc2VjdGlvbi4gIEFkZGl0aW9uYWwgc3Vic3RpdHV0aW9ucyBtYXkgYmUKICAgICAgICBwcm92aWRlZCB1c2luZyB0aGUgYHZhcnMnIGFyZ3VtZW50LCB3aGljaCBtdXN0IGJlIGEgZGljdGlvbmFyeSB3aG9zZQogICAgICAgIGNvbnRlbnRzIG92ZXJyaWRlIGFueSBwcmUtZXhpc3RpbmcgZGVmYXVsdHMuIElmIGBvcHRpb24nIGlzIGEga2V5IGluCiAgICAgICAgYHZhcnMnLCB0aGUgdmFsdWUgZnJvbSBgdmFycycgaXMgdXNlZC4KCiAgICBnZXRpbnQoc2VjdGlvbiwgb3B0aW9ucywgcmF3PUZhbHNlLCB2YXJzPU5vbmUsIGZhbGxiYWNrPV9VTlNFVCkKICAgICAgICBMaWtlIGdldCgpLCBidXQgY29udmVydCB2YWx1ZSB0byBhbiBpbnRlZ2VyLgoKICAgIGdldGZsb2F0KHNlY3Rpb24sIG9wdGlvbnMsIHJhdz1GYWxzZSwgdmFycz1Ob25lLCBmYWxsYmFjaz1fVU5TRVQpCiAgICAgICAgTGlrZSBnZXQoKSwgYnV0IGNvbnZlcnQgdmFsdWUgdG8gYSBmbG9hdC4KCiAgICBnZXRib29sZWFuKHNlY3Rpb24sIG9wdGlvbnMsIHJhdz1GYWxzZSwgdmFycz1Ob25lLCBmYWxsYmFjaz1fVU5TRVQpCiAgICAgICAgTGlrZSBnZXQoKSwgYnV0IGNvbnZlcnQgdmFsdWUgdG8gYSBib29sZWFuIChjdXJyZW50bHkgY2FzZQogICAgICAgIGluc2Vuc2l0aXZlbHkgZGVmaW5lZCBhcyAwLCBmYWxzZSwgbm8sIG9mZiBmb3IgRmFsc2UsIGFuZCAxLCB0cnVlLAogICAgICAgIHllcywgb24gZm9yIFRydWUpLiAgUmV0dXJucyBGYWxzZSBvciBUcnVlLgoKICAgIGl0ZW1zKHNlY3Rpb249X1VOU0VULCByYXc9RmFsc2UsIHZhcnM9Tm9uZSkKICAgICAgICBJZiBzZWN0aW9uIGlzIGdpdmVuLCByZXR1cm4gYSBsaXN0IG9mIHR1cGxlcyB3aXRoIChzZWN0aW9uX25hbWUsCiAgICAgICAgc2VjdGlvbl9wcm94eSkgZm9yIGVhY2ggc2VjdGlvbiwgaW5jbHVkaW5nIERFRkFVTFRTRUNULiBPdGhlcndpc2UsCiAgICAgICAgcmV0dXJuIGEgbGlzdCBvZiB0dXBsZXMgd2l0aCAobmFtZSwgdmFsdWUpIGZvciBlYWNoIG9wdGlvbgogICAgICAgIGluIHRoZSBzZWN0aW9uLgoKICAgIHJlbW92ZV9zZWN0aW9uKHNlY3Rpb24pCiAgICAgICAgUmVtb3ZlIHRoZSBnaXZlbiBmaWxlIHNlY3Rpb24gYW5kIGFsbCBpdHMgb3B0aW9ucy4KCiAgICByZW1vdmVfb3B0aW9uKHNlY3Rpb24sIG9wdGlvbikKICAgICAgICBSZW1vdmUgdGhlIGdpdmVuIG9wdGlvbiBmcm9tIHRoZSBnaXZlbiBzZWN0aW9uLgoKICAgIHNldChzZWN0aW9uLCBvcHRpb24sIHZhbHVlKQogICAgICAgIFNldCB0aGUgZ2l2ZW4gb3B0aW9uLgoKICAgIHdyaXRlKGZwLCBzcGFjZV9hcm91bmRfZGVsaW1pdGVycz1UcnVlKQogICAgICAgIFdyaXRlIHRoZSBjb25maWd1cmF0aW9uIHN0YXRlIGluIC5pbmkgZm9ybWF0LiBJZgogICAgICAgIGBzcGFjZV9hcm91bmRfZGVsaW1pdGVycycgaXMgVHJ1ZSAodGhlIGRlZmF1bHQpLCBkZWxpbWl0ZXJzCiAgICAgICAgYmV0d2VlbiBrZXlzIGFuZCB2YWx1ZXMgYXJlIHN1cnJvdW5kZWQgYnkgc3BhY2VzLgoiIiIKCmZyb20gY29sbGVjdGlvbnMuYWJjIGltcG9ydCBNdXRhYmxlTWFwcGluZwpmcm9tIGNvbGxlY3Rpb25zIGltcG9ydCBPcmRlcmVkRGljdCBhcyBfZGVmYXVsdF9kaWN0LCBDaGFpbk1hcCBhcyBfQ2hhaW5NYXAKaW1wb3J0IGZ1bmN0b29scwppbXBvcnQgaW8KaW1wb3J0IGl0ZXJ0b29scwppbXBvcnQgcmUKaW1wb3J0IHN5cwppbXBvcnQgd2FybmluZ3MKCl9fYWxsX18gPSBbIk5vU2VjdGlvbkVycm9yIiwgIkR1cGxpY2F0ZU9wdGlvbkVycm9yIiwgIkR1cGxpY2F0ZVNlY3Rpb25FcnJvciIsCiAgICAgICAgICAgIk5vT3B0aW9uRXJyb3IiLCAiSW50ZXJwb2xhdGlvbkVycm9yIiwgIkludGVycG9sYXRpb25EZXB0aEVycm9yIiwKICAgICAgICAgICAiSW50ZXJwb2xhdGlvblN5bnRheEVycm9yIiwgIlBhcnNpbmdFcnJvciIsCiAgICAgICAgICAgIk1pc3NpbmdTZWN0aW9uSGVhZGVyRXJyb3IiLAogICAgICAgICAgICJDb25maWdQYXJzZXIiLCAiU2FmZUNvbmZpZ1BhcnNlciIsICJSYXdDb25maWdQYXJzZXIiLAogICAgICAgICAgICJERUZBVUxUU0VDVCIsICJNQVhfSU5URVJQT0xBVElPTl9ERVBUSCJdCgpERUZBVUxUU0VDVCA9ICJERUZBVUxUIgoKTUFYX0lOVEVSUE9MQVRJT05fREVQVEggPSAxMAoKCgojIGV4Y2VwdGlvbiBjbGFzc2VzCmNsYXNzIEVycm9yKEV4Y2VwdGlvbik6CiAgICAiIiJCYXNlIGNsYXNzIGZvciBDb25maWdQYXJzZXIgZXhjZXB0aW9ucy4iIiIKCiAgICBkZWYgX2dldF9tZXNzYWdlKHNlbGYpOgogICAgICAgICIiIkdldHRlciBmb3IgJ21lc3NhZ2UnOyBuZWVkZWQgb25seSB0byBvdmVycmlkZSBkZXByZWNhdGlvbiBpbgogICAgICAgIEJhc2VFeGNlcHRpb24uCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX19tZXNzYWdlCgogICAgZGVmIF9zZXRfbWVzc2FnZShzZWxmLCB2YWx1ZSk6CiAgICAgICAgIiIiU2V0dGVyIGZvciAnbWVzc2FnZSc7IG5lZWRlZCBvbmx5IHRvIG92ZXJyaWRlIGRlcHJlY2F0aW9uIGluCiAgICAgICAgQmFzZUV4Y2VwdGlvbi4KICAgICAgICAiIiIKICAgICAgICBzZWxmLl9fbWVzc2FnZSA9IHZhbHVlCgogICAgIyBCYXNlRXhjZXB0aW9uLm1lc3NhZ2UgaGFzIGJlZW4gZGVwcmVjYXRlZCBzaW5jZSBQeXRob24gMi42LiAgVG8gcHJldmVudAogICAgIyBEZXByZWNhdGlvbldhcm5pbmcgZnJvbSBwb3BwaW5nIHVwIG92ZXIgdGhpcyBwcmUtZXhpc3RpbmcgYXR0cmlidXRlLCB1c2UKICAgICMgYSBuZXcgcHJvcGVydHkgdGhhdCB0YWtlcyBsb29rdXAgcHJlY2VkZW5jZS4KICAgIG1lc3NhZ2UgPSBwcm9wZXJ0eShfZ2V0X21lc3NhZ2UsIF9zZXRfbWVzc2FnZSkKCiAgICBkZWYgX19pbml0X18oc2VsZiwgbXNnPScnKToKICAgICAgICBzZWxmLm1lc3NhZ2UgPSBtc2cKICAgICAgICBFeGNlcHRpb24uX19pbml0X18oc2VsZiwgbXNnKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5tZXNzYWdlCgogICAgX19zdHJfXyA9IF9fcmVwcl9fCgoKY2xhc3MgTm9TZWN0aW9uRXJyb3IoRXJyb3IpOgogICAgIiIiUmFpc2VkIHdoZW4gbm8gc2VjdGlvbiBtYXRjaGVzIGEgcmVxdWVzdGVkIG9wdGlvbi4iIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgc2VjdGlvbik6CiAgICAgICAgRXJyb3IuX19pbml0X18oc2VsZiwgJ05vIHNlY3Rpb246ICVyJyAlIChzZWN0aW9uLCkpCiAgICAgICAgc2VsZi5zZWN0aW9uID0gc2VjdGlvbgogICAgICAgIHNlbGYuYXJncyA9IChzZWN0aW9uLCApCgoKY2xhc3MgRHVwbGljYXRlU2VjdGlvbkVycm9yKEVycm9yKToKICAgICIiIlJhaXNlZCB3aGVuIGEgc2VjdGlvbiBpcyByZXBlYXRlZCBpbiBhbiBpbnB1dCBzb3VyY2UuCgogICAgUG9zc2libGUgcmVwZXRpdGlvbnMgdGhhdCByYWlzZSB0aGlzIGV4Y2VwdGlvbiBhcmU6IG11bHRpcGxlIGNyZWF0aW9uCiAgICB1c2luZyB0aGUgQVBJIG9yIGluIHN0cmljdCBwYXJzZXJzIHdoZW4gYSBzZWN0aW9uIGlzIGZvdW5kIG1vcmUgdGhhbiBvbmNlCiAgICBpbiBhIHNpbmdsZSBpbnB1dCBmaWxlLCBzdHJpbmcgb3IgZGljdGlvbmFyeS4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzZWN0aW9uLCBzb3VyY2U9Tm9uZSwgbGluZW5vPU5vbmUpOgogICAgICAgIG1zZyA9IFtyZXByKHNlY3Rpb24pLCAiIGFscmVhZHkgZXhpc3RzIl0KICAgICAgICBpZiBzb3VyY2UgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIG1lc3NhZ2UgPSBbIldoaWxlIHJlYWRpbmcgZnJvbSAiLCBzb3VyY2VdCiAgICAgICAgICAgIGlmIGxpbmVubyBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIG1lc3NhZ2UuYXBwZW5kKCIgW2xpbmUgezA6MmR9XSIuZm9ybWF0KGxpbmVubykpCiAgICAgICAgICAgIG1lc3NhZ2UuYXBwZW5kKCI6IHNlY3Rpb24gIikKICAgICAgICAgICAgbWVzc2FnZS5leHRlbmQobXNnKQogICAgICAgICAgICBtc2cgPSBtZXNzYWdlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbXNnLmluc2VydCgwLCAiU2VjdGlvbiAiKQogICAgICAgIEVycm9yLl9faW5pdF9fKHNlbGYsICIiLmpvaW4obXNnKSkKICAgICAgICBzZWxmLnNlY3Rpb24gPSBzZWN0aW9uCiAgICAgICAgc2VsZi5zb3VyY2UgPSBzb3VyY2UKICAgICAgICBzZWxmLmxpbmVubyA9IGxpbmVubwogICAgICAgIHNlbGYuYXJncyA9IChzZWN0aW9uLCBzb3VyY2UsIGxpbmVubykKCgpjbGFzcyBEdXBsaWNhdGVPcHRpb25FcnJvcihFcnJvcik6CiAgICAiIiJSYWlzZWQgYnkgc3RyaWN0IHBhcnNlcnMgd2hlbiBhbiBvcHRpb24gaXMgcmVwZWF0ZWQgaW4gYW4gaW5wdXQgc291cmNlLgoKICAgIEN1cnJlbnQgaW1wbGVtZW50YXRpb24gcmFpc2VzIHRoaXMgZXhjZXB0aW9uIG9ubHkgd2hlbiBhbiBvcHRpb24gaXMgZm91bmQKICAgIG1vcmUgdGhhbiBvbmNlIGluIGEgc2luZ2xlIGZpbGUsIHN0cmluZyBvciBkaWN0aW9uYXJ5LgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHNlY3Rpb24sIG9wdGlvbiwgc291cmNlPU5vbmUsIGxpbmVubz1Ob25lKToKICAgICAgICBtc2cgPSBbcmVwcihvcHRpb24pLCAiIGluIHNlY3Rpb24gIiwgcmVwcihzZWN0aW9uKSwKICAgICAgICAgICAgICAgIiBhbHJlYWR5IGV4aXN0cyJdCiAgICAgICAgaWYgc291cmNlIGlzIG5vdCBOb25lOgogICAgICAgICAgICBtZXNzYWdlID0gWyJXaGlsZSByZWFkaW5nIGZyb20gIiwgc291cmNlXQogICAgICAgICAgICBpZiBsaW5lbm8gaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBtZXNzYWdlLmFwcGVuZCgiIFtsaW5lIHswOjJkfV0iLmZvcm1hdChsaW5lbm8pKQogICAgICAgICAgICBtZXNzYWdlLmFwcGVuZCgiOiBvcHRpb24gIikKICAgICAgICAgICAgbWVzc2FnZS5leHRlbmQobXNnKQogICAgICAgICAgICBtc2cgPSBtZXNzYWdlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbXNnLmluc2VydCgwLCAiT3B0aW9uICIpCiAgICAgICAgRXJyb3IuX19pbml0X18oc2VsZiwgIiIuam9pbihtc2cpKQogICAgICAgIHNlbGYuc2VjdGlvbiA9IHNlY3Rpb24KICAgICAgICBzZWxmLm9wdGlvbiA9IG9wdGlvbgogICAgICAgIHNlbGYuc291cmNlID0gc291cmNlCiAgICAgICAgc2VsZi5saW5lbm8gPSBsaW5lbm8KICAgICAgICBzZWxmLmFyZ3MgPSAoc2VjdGlvbiwgb3B0aW9uLCBzb3VyY2UsIGxpbmVubykKCgpjbGFzcyBOb09wdGlvbkVycm9yKEVycm9yKToKICAgICIiIkEgcmVxdWVzdGVkIG9wdGlvbiB3YXMgbm90IGZvdW5kLiIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBvcHRpb24sIHNlY3Rpb24pOgogICAgICAgIEVycm9yLl9faW5pdF9fKHNlbGYsICJObyBvcHRpb24gJXIgaW4gc2VjdGlvbjogJXIiICUKICAgICAgICAgICAgICAgICAgICAgICAob3B0aW9uLCBzZWN0aW9uKSkKICAgICAgICBzZWxmLm9wdGlvbiA9IG9wdGlvbgogICAgICAgIHNlbGYuc2VjdGlvbiA9IHNlY3Rpb24KICAgICAgICBzZWxmLmFyZ3MgPSAob3B0aW9uLCBzZWN0aW9uKQoKCmNsYXNzIEludGVycG9sYXRpb25FcnJvcihFcnJvcik6CiAgICAiIiJCYXNlIGNsYXNzIGZvciBpbnRlcnBvbGF0aW9uLXJlbGF0ZWQgZXhjZXB0aW9ucy4iIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgb3B0aW9uLCBzZWN0aW9uLCBtc2cpOgogICAgICAgIEVycm9yLl9faW5pdF9fKHNlbGYsIG1zZykKICAgICAgICBzZWxmLm9wdGlvbiA9IG9wdGlvbgogICAgICAgIHNlbGYuc2VjdGlvbiA9IHNlY3Rpb24KICAgICAgICBzZWxmLmFyZ3MgPSAob3B0aW9uLCBzZWN0aW9uLCBtc2cpCgoKY2xhc3MgSW50ZXJwb2xhdGlvbk1pc3NpbmdPcHRpb25FcnJvcihJbnRlcnBvbGF0aW9uRXJyb3IpOgogICAgIiIiQSBzdHJpbmcgc3Vic3RpdHV0aW9uIHJlcXVpcmVkIGEgc2V0dGluZyB3aGljaCB3YXMgbm90IGF2YWlsYWJsZS4iIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgb3B0aW9uLCBzZWN0aW9uLCByYXd2YWwsIHJlZmVyZW5jZSk6CiAgICAgICAgbXNnID0gKCJCYWQgdmFsdWUgc3Vic3RpdHV0aW9uOlxuIgogICAgICAgICAgICAgICAiXHRzZWN0aW9uOiBbJXNdXG4iCiAgICAgICAgICAgICAgICJcdG9wdGlvbiA6ICVzXG4iCiAgICAgICAgICAgICAgICJcdGtleSAgICA6ICVzXG4iCiAgICAgICAgICAgICAgICJcdHJhd3ZhbCA6ICVzXG4iCiAgICAgICAgICAgICAgICUgKHNlY3Rpb24sIG9wdGlvbiwgcmVmZXJlbmNlLCByYXd2YWwpKQogICAgICAgIEludGVycG9sYXRpb25FcnJvci5fX2luaXRfXyhzZWxmLCBvcHRpb24sIHNlY3Rpb24sIG1zZykKICAgICAgICBzZWxmLnJlZmVyZW5jZSA9IHJlZmVyZW5jZQogICAgICAgIHNlbGYuYXJncyA9IChvcHRpb24sIHNlY3Rpb24sIHJhd3ZhbCwgcmVmZXJlbmNlKQoKCmNsYXNzIEludGVycG9sYXRpb25TeW50YXhFcnJvcihJbnRlcnBvbGF0aW9uRXJyb3IpOgogICAgIiIiUmFpc2VkIHdoZW4gdGhlIHNvdXJjZSB0ZXh0IGNvbnRhaW5zIGludmFsaWQgc3ludGF4LgoKICAgIEN1cnJlbnQgaW1wbGVtZW50YXRpb24gcmFpc2VzIHRoaXMgZXhjZXB0aW9uIHdoZW4gdGhlIHNvdXJjZSB0ZXh0IGludG8KICAgIHdoaWNoIHN1YnN0aXR1dGlvbnMgYXJlIG1hZGUgZG9lcyBub3QgY29uZm9ybSB0byB0aGUgcmVxdWlyZWQgc3ludGF4LgogICAgIiIiCgoKY2xhc3MgSW50ZXJwb2xhdGlvbkRlcHRoRXJyb3IoSW50ZXJwb2xhdGlvbkVycm9yKToKICAgICIiIlJhaXNlZCB3aGVuIHN1YnN0aXR1dGlvbnMgYXJlIG5lc3RlZCB0b28gZGVlcGx5LiIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBvcHRpb24sIHNlY3Rpb24sIHJhd3ZhbCk6CiAgICAgICAgbXNnID0gKCJWYWx1ZSBpbnRlcnBvbGF0aW9uIHRvbyBkZWVwbHkgcmVjdXJzaXZlOlxuIgogICAgICAgICAgICAgICAiXHRzZWN0aW9uOiBbJXNdXG4iCiAgICAgICAgICAgICAgICJcdG9wdGlvbiA6ICVzXG4iCiAgICAgICAgICAgICAgICJcdHJhd3ZhbCA6ICVzXG4iCiAgICAgICAgICAgICAgICUgKHNlY3Rpb24sIG9wdGlvbiwgcmF3dmFsKSkKICAgICAgICBJbnRlcnBvbGF0aW9uRXJyb3IuX19pbml0X18oc2VsZiwgb3B0aW9uLCBzZWN0aW9uLCBtc2cpCiAgICAgICAgc2VsZi5hcmdzID0gKG9wdGlvbiwgc2VjdGlvbiwgcmF3dmFsKQoKCmNsYXNzIFBhcnNpbmdFcnJvcihFcnJvcik6CiAgICAiIiJSYWlzZWQgd2hlbiBhIGNvbmZpZ3VyYXRpb24gZmlsZSBkb2VzIG5vdCBmb2xsb3cgbGVnYWwgc3ludGF4LiIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzb3VyY2U9Tm9uZSwgZmlsZW5hbWU9Tm9uZSk6CiAgICAgICAgIyBFeGFjdGx5IG9uZSBvZiBgc291cmNlJy9gZmlsZW5hbWUnIGFyZ3VtZW50cyBoYXMgdG8gYmUgZ2l2ZW4uCiAgICAgICAgIyBgZmlsZW5hbWUnIGtlcHQgZm9yIGNvbXBhdGliaWxpdHkuCiAgICAgICAgaWYgZmlsZW5hbWUgYW5kIHNvdXJjZToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiQ2Fubm90IHNwZWNpZnkgYm90aCBgZmlsZW5hbWUnIGFuZCBgc291cmNlJy4gIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJVc2UgYHNvdXJjZScuIikKICAgICAgICBlbGlmIG5vdCBmaWxlbmFtZSBhbmQgbm90IHNvdXJjZToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiUmVxdWlyZWQgYXJndW1lbnQgYHNvdXJjZScgbm90IGdpdmVuLiIpCiAgICAgICAgZWxpZiBmaWxlbmFtZToKICAgICAgICAgICAgc291cmNlID0gZmlsZW5hbWUKICAgICAgICBFcnJvci5fX2luaXRfXyhzZWxmLCAnU291cmNlIGNvbnRhaW5zIHBhcnNpbmcgZXJyb3JzOiAlcycgJSBzb3VyY2UpCiAgICAgICAgc2VsZi5zb3VyY2UgPSBzb3VyY2UKICAgICAgICBzZWxmLmVycm9ycyA9IFtdCiAgICAgICAgc2VsZi5hcmdzID0gKHNvdXJjZSwgKQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIGZpbGVuYW1lKHNlbGYpOgogICAgICAgICIiIkRlcHJlY2F0ZWQsIHVzZSBgc291cmNlJy4iIiIKICAgICAgICB3YXJuaW5ncy53YXJuKAogICAgICAgICAgICAiVGhlICdmaWxlbmFtZScgYXR0cmlidXRlIHdpbGwgYmUgcmVtb3ZlZCBpbiBmdXR1cmUgdmVyc2lvbnMuICAiCiAgICAgICAgICAgICJVc2UgJ3NvdXJjZScgaW5zdGVhZC4iLAogICAgICAgICAgICBEZXByZWNhdGlvbldhcm5pbmcsIHN0YWNrbGV2ZWw9MgogICAgICAgICkKICAgICAgICByZXR1cm4gc2VsZi5zb3VyY2UKCiAgICBAZmlsZW5hbWUuc2V0dGVyCiAgICBkZWYgZmlsZW5hbWUoc2VsZiwgdmFsdWUpOgogICAgICAgICIiIkRlcHJlY2F0ZWQsIHVzZXIgYHNvdXJjZScuIiIiCiAgICAgICAgd2FybmluZ3Mud2FybigKICAgICAgICAgICAgIlRoZSAnZmlsZW5hbWUnIGF0dHJpYnV0ZSB3aWxsIGJlIHJlbW92ZWQgaW4gZnV0dXJlIHZlcnNpb25zLiAgIgogICAgICAgICAgICAiVXNlICdzb3VyY2UnIGluc3RlYWQuIiwKICAgICAgICAgICAgRGVwcmVjYXRpb25XYXJuaW5nLCBzdGFja2xldmVsPTIKICAgICAgICApCiAgICAgICAgc2VsZi5zb3VyY2UgPSB2YWx1ZQoKICAgIGRlZiBhcHBlbmQoc2VsZiwgbGluZW5vLCBsaW5lKToKICAgICAgICBzZWxmLmVycm9ycy5hcHBlbmQoKGxpbmVubywgbGluZSkpCiAgICAgICAgc2VsZi5tZXNzYWdlICs9ICdcblx0W2xpbmUgJTJkXTogJXMnICUgKGxpbmVubywgbGluZSkKCgpjbGFzcyBNaXNzaW5nU2VjdGlvbkhlYWRlckVycm9yKFBhcnNpbmdFcnJvcik6CiAgICAiIiJSYWlzZWQgd2hlbiBhIGtleS12YWx1ZSBwYWlyIGlzIGZvdW5kIGJlZm9yZSBhbnkgc2VjdGlvbiBoZWFkZXIuIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGZpbGVuYW1lLCBsaW5lbm8sIGxpbmUpOgogICAgICAgIEVycm9yLl9faW5pdF9fKAogICAgICAgICAgICBzZWxmLAogICAgICAgICAgICAnRmlsZSBjb250YWlucyBubyBzZWN0aW9uIGhlYWRlcnMuXG5maWxlOiAlcywgbGluZTogJWRcbiVyJyAlCiAgICAgICAgICAgIChmaWxlbmFtZSwgbGluZW5vLCBsaW5lKSkKICAgICAgICBzZWxmLnNvdXJjZSA9IGZpbGVuYW1lCiAgICAgICAgc2VsZi5saW5lbm8gPSBsaW5lbm8KICAgICAgICBzZWxmLmxpbmUgPSBsaW5lCiAgICAgICAgc2VsZi5hcmdzID0gKGZpbGVuYW1lLCBsaW5lbm8sIGxpbmUpCgoKIyBVc2VkIGluIHBhcnNlciBnZXR0ZXJzIHRvIGluZGljYXRlIHRoZSBkZWZhdWx0IGJlaGF2aW91ciB3aGVuIGEgc3BlY2lmaWMKIyBvcHRpb24gaXMgbm90IGZvdW5kIGl0IHRvIHJhaXNlIGFuIGV4Y2VwdGlvbi4gQ3JlYXRlZCB0byBlbmFibGUgYE5vbmUnIGFzCiMgYSB2YWxpZCBmYWxsYmFjayB2YWx1ZS4KX1VOU0VUID0gb2JqZWN0KCkKCgpjbGFzcyBJbnRlcnBvbGF0aW9uOgogICAgIiIiRHVtbXkgaW50ZXJwb2xhdGlvbiB0aGF0IHBhc3NlcyB0aGUgdmFsdWUgdGhyb3VnaCB3aXRoIG5vIGNoYW5nZXMuIiIiCgogICAgZGVmIGJlZm9yZV9nZXQoc2VsZiwgcGFyc2VyLCBzZWN0aW9uLCBvcHRpb24sIHZhbHVlLCBkZWZhdWx0cyk6CiAgICAgICAgcmV0dXJuIHZhbHVlCgogICAgZGVmIGJlZm9yZV9zZXQoc2VsZiwgcGFyc2VyLCBzZWN0aW9uLCBvcHRpb24sIHZhbHVlKToKICAgICAgICByZXR1cm4gdmFsdWUKCiAgICBkZWYgYmVmb3JlX3JlYWQoc2VsZiwgcGFyc2VyLCBzZWN0aW9uLCBvcHRpb24sIHZhbHVlKToKICAgICAgICByZXR1cm4gdmFsdWUKCiAgICBkZWYgYmVmb3JlX3dyaXRlKHNlbGYsIHBhcnNlciwgc2VjdGlvbiwgb3B0aW9uLCB2YWx1ZSk6CiAgICAgICAgcmV0dXJuIHZhbHVlCgoKY2xhc3MgQmFzaWNJbnRlcnBvbGF0aW9uKEludGVycG9sYXRpb24pOgogICAgIiIiSW50ZXJwb2xhdGlvbiBhcyBpbXBsZW1lbnRlZCBpbiB0aGUgY2xhc3NpYyBDb25maWdQYXJzZXIuCgogICAgVGhlIG9wdGlvbiB2YWx1ZXMgY2FuIGNvbnRhaW4gZm9ybWF0IHN0cmluZ3Mgd2hpY2ggcmVmZXIgdG8gb3RoZXIgdmFsdWVzIGluCiAgICB0aGUgc2FtZSBzZWN0aW9uLCBvciB2YWx1ZXMgaW4gdGhlIHNwZWNpYWwgZGVmYXVsdCBzZWN0aW9uLgoKICAgIEZvciBleGFtcGxlOgoKICAgICAgICBzb21ldGhpbmc6ICUoZGlyKXMvd2hhdGV2ZXIKCiAgICB3b3VsZCByZXNvbHZlIHRoZSAiJShkaXIpcyIgdG8gdGhlIHZhbHVlIG9mIGRpci4gIEFsbCByZWZlcmVuY2UKICAgIGV4cGFuc2lvbnMgYXJlIGRvbmUgbGF0ZSwgb24gZGVtYW5kLiBJZiBhIHVzZXIgbmVlZHMgdG8gdXNlIGEgYmFyZSAlIGluCiAgICBhIGNvbmZpZ3VyYXRpb24gZmlsZSwgc2hlIGNhbiBlc2NhcGUgaXQgYnkgd3JpdGluZyAlJS4gT3RoZXIgJSB1c2FnZQogICAgaXMgY29uc2lkZXJlZCBhIHVzZXIgZXJyb3IgYW5kIHJhaXNlcyBgSW50ZXJwb2xhdGlvblN5bnRheEVycm9yJy4iIiIKCiAgICBfS0VZQ1JFID0gcmUuY29tcGlsZShyIiVcKChbXildKylcKXMiKQoKICAgIGRlZiBiZWZvcmVfZ2V0KHNlbGYsIHBhcnNlciwgc2VjdGlvbiwgb3B0aW9uLCB2YWx1ZSwgZGVmYXVsdHMpOgogICAgICAgIEwgPSBbXQogICAgICAgIHNlbGYuX2ludGVycG9sYXRlX3NvbWUocGFyc2VyLCBvcHRpb24sIEwsIHZhbHVlLCBzZWN0aW9uLCBkZWZhdWx0cywgMSkKICAgICAgICByZXR1cm4gJycuam9pbihMKQoKICAgIGRlZiBiZWZvcmVfc2V0KHNlbGYsIHBhcnNlciwgc2VjdGlvbiwgb3B0aW9uLCB2YWx1ZSk6CiAgICAgICAgdG1wX3ZhbHVlID0gdmFsdWUucmVwbGFjZSgnJSUnLCAnJykgIyBlc2NhcGVkIHBlcmNlbnQgc2lnbnMKICAgICAgICB0bXBfdmFsdWUgPSBzZWxmLl9LRVlDUkUuc3ViKCcnLCB0bXBfdmFsdWUpICMgdmFsaWQgc3ludGF4CiAgICAgICAgaWYgJyUnIGluIHRtcF92YWx1ZToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiaW52YWxpZCBpbnRlcnBvbGF0aW9uIHN5bnRheCBpbiAlciBhdCAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInBvc2l0aW9uICVkIiAlICh2YWx1ZSwgdG1wX3ZhbHVlLmZpbmQoJyUnKSkpCiAgICAgICAgcmV0dXJuIHZhbHVlCgogICAgZGVmIF9pbnRlcnBvbGF0ZV9zb21lKHNlbGYsIHBhcnNlciwgb3B0aW9uLCBhY2N1bSwgcmVzdCwgc2VjdGlvbiwgbWFwLAogICAgICAgICAgICAgICAgICAgICAgICAgIGRlcHRoKToKICAgICAgICBpZiBkZXB0aCA+IE1BWF9JTlRFUlBPTEFUSU9OX0RFUFRIOgogICAgICAgICAgICByYWlzZSBJbnRlcnBvbGF0aW9uRGVwdGhFcnJvcihvcHRpb24sIHNlY3Rpb24sIHJlc3QpCiAgICAgICAgd2hpbGUgcmVzdDoKICAgICAgICAgICAgcCA9IHJlc3QuZmluZCgiJSIpCiAgICAgICAgICAgIGlmIHAgPCAwOgogICAgICAgICAgICAgICAgYWNjdW0uYXBwZW5kKHJlc3QpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgaWYgcCA+IDA6CiAgICAgICAgICAgICAgICBhY2N1bS5hcHBlbmQocmVzdFs6cF0pCiAgICAgICAgICAgICAgICByZXN0ID0gcmVzdFtwOl0KICAgICAgICAgICAgIyBwIGlzIG5vIGxvbmdlciB1c2VkCiAgICAgICAgICAgIGMgPSByZXN0WzE6Ml0KICAgICAgICAgICAgaWYgYyA9PSAiJSI6CiAgICAgICAgICAgICAgICBhY2N1bS5hcHBlbmQoIiUiKQogICAgICAgICAgICAgICAgcmVzdCA9IHJlc3RbMjpdCiAgICAgICAgICAgIGVsaWYgYyA9PSAiKCI6CiAgICAgICAgICAgICAgICBtID0gc2VsZi5fS0VZQ1JFLm1hdGNoKHJlc3QpCiAgICAgICAgICAgICAgICBpZiBtIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgSW50ZXJwb2xhdGlvblN5bnRheEVycm9yKG9wdGlvbiwgc2VjdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgImJhZCBpbnRlcnBvbGF0aW9uIHZhcmlhYmxlIHJlZmVyZW5jZSAlciIgJSByZXN0KQogICAgICAgICAgICAgICAgdmFyID0gcGFyc2VyLm9wdGlvbnhmb3JtKG0uZ3JvdXAoMSkpCiAgICAgICAgICAgICAgICByZXN0ID0gcmVzdFttLmVuZCgpOl0KICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICB2ID0gbWFwW3Zhcl0KICAgICAgICAgICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgICAgICAgICByYWlzZSBJbnRlcnBvbGF0aW9uTWlzc2luZ09wdGlvbkVycm9yKAogICAgICAgICAgICAgICAgICAgICAgICBvcHRpb24sIHNlY3Rpb24sIHJlc3QsIHZhcikKICAgICAgICAgICAgICAgIGlmICIlIiBpbiB2OgogICAgICAgICAgICAgICAgICAgIHNlbGYuX2ludGVycG9sYXRlX3NvbWUocGFyc2VyLCBvcHRpb24sIGFjY3VtLCB2LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VjdGlvbiwgbWFwLCBkZXB0aCArIDEpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGFjY3VtLmFwcGVuZCh2KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UgSW50ZXJwb2xhdGlvblN5bnRheEVycm9yKAogICAgICAgICAgICAgICAgICAgIG9wdGlvbiwgc2VjdGlvbiwKICAgICAgICAgICAgICAgICAgICAiJyUlJyBtdXN0IGJlIGZvbGxvd2VkIGJ5ICclJScgb3IgJygnLCAiCiAgICAgICAgICAgICAgICAgICAgImZvdW5kOiAlciIgJSAocmVzdCwpKQoKCmNsYXNzIEV4dGVuZGVkSW50ZXJwb2xhdGlvbihJbnRlcnBvbGF0aW9uKToKICAgICIiIkFkdmFuY2VkIHZhcmlhbnQgb2YgaW50ZXJwb2xhdGlvbiwgc3VwcG9ydHMgdGhlIHN5bnRheCB1c2VkIGJ5CiAgICBgemMuYnVpbGRvdXQnLiBFbmFibGVzIGludGVycG9sYXRpb24gYmV0d2VlbiBzZWN0aW9ucy4iIiIKCiAgICBfS0VZQ1JFID0gcmUuY29tcGlsZShyIlwkXHsoW159XSspXH0iKQoKICAgIGRlZiBiZWZvcmVfZ2V0KHNlbGYsIHBhcnNlciwgc2VjdGlvbiwgb3B0aW9uLCB2YWx1ZSwgZGVmYXVsdHMpOgogICAgICAgIEwgPSBbXQogICAgICAgIHNlbGYuX2ludGVycG9sYXRlX3NvbWUocGFyc2VyLCBvcHRpb24sIEwsIHZhbHVlLCBzZWN0aW9uLCBkZWZhdWx0cywgMSkKICAgICAgICByZXR1cm4gJycuam9pbihMKQoKICAgIGRlZiBiZWZvcmVfc2V0KHNlbGYsIHBhcnNlciwgc2VjdGlvbiwgb3B0aW9uLCB2YWx1ZSk6CiAgICAgICAgdG1wX3ZhbHVlID0gdmFsdWUucmVwbGFjZSgnJCQnLCAnJykgIyBlc2NhcGVkIGRvbGxhciBzaWducwogICAgICAgIHRtcF92YWx1ZSA9IHNlbGYuX0tFWUNSRS5zdWIoJycsIHRtcF92YWx1ZSkgIyB2YWxpZCBzeW50YXgKICAgICAgICBpZiAnJCcgaW4gdG1wX3ZhbHVlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJpbnZhbGlkIGludGVycG9sYXRpb24gc3ludGF4IGluICVyIGF0ICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAicG9zaXRpb24gJWQiICUgKHZhbHVlLCB0bXBfdmFsdWUuZmluZCgnJScpKSkKICAgICAgICByZXR1cm4gdmFsdWUKCiAgICBkZWYgX2ludGVycG9sYXRlX3NvbWUoc2VsZiwgcGFyc2VyLCBvcHRpb24sIGFjY3VtLCByZXN0LCBzZWN0aW9uLCBtYXAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwdGgpOgogICAgICAgIGlmIGRlcHRoID4gTUFYX0lOVEVSUE9MQVRJT05fREVQVEg6CiAgICAgICAgICAgIHJhaXNlIEludGVycG9sYXRpb25EZXB0aEVycm9yKG9wdGlvbiwgc2VjdGlvbiwgcmVzdCkKICAgICAgICB3aGlsZSByZXN0OgogICAgICAgICAgICBwID0gcmVzdC5maW5kKCIkIikKICAgICAgICAgICAgaWYgcCA8IDA6CiAgICAgICAgICAgICAgICBhY2N1bS5hcHBlbmQocmVzdCkKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBpZiBwID4gMDoKICAgICAgICAgICAgICAgIGFjY3VtLmFwcGVuZChyZXN0WzpwXSkKICAgICAgICAgICAgICAgIHJlc3QgPSByZXN0W3A6XQogICAgICAgICAgICAjIHAgaXMgbm8gbG9uZ2VyIHVzZWQKICAgICAgICAgICAgYyA9IHJlc3RbMToyXQogICAgICAgICAgICBpZiBjID09ICIkIjoKICAgICAgICAgICAgICAgIGFjY3VtLmFwcGVuZCgiJCIpCiAgICAgICAgICAgICAgICByZXN0ID0gcmVzdFsyOl0KICAgICAgICAgICAgZWxpZiBjID09ICJ7IjoKICAgICAgICAgICAgICAgIG0gPSBzZWxmLl9LRVlDUkUubWF0Y2gocmVzdCkKICAgICAgICAgICAgICAgIGlmIG0gaXMgTm9uZToKICAgICAgICAgICAgICAgICAgICByYWlzZSBJbnRlcnBvbGF0aW9uU3ludGF4RXJyb3Iob3B0aW9uLCBzZWN0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAiYmFkIGludGVycG9sYXRpb24gdmFyaWFibGUgcmVmZXJlbmNlICVyIiAlIHJlc3QpCiAgICAgICAgICAgICAgICBwYXRoID0gbS5ncm91cCgxKS5zcGxpdCgnOicpCiAgICAgICAgICAgICAgICByZXN0ID0gcmVzdFttLmVuZCgpOl0KICAgICAgICAgICAgICAgIHNlY3QgPSBzZWN0aW9uCiAgICAgICAgICAgICAgICBvcHQgPSBvcHRpb24KICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBpZiBsZW4ocGF0aCkgPT0gMToKICAgICAgICAgICAgICAgICAgICAgICAgb3B0ID0gcGFyc2VyLm9wdGlvbnhmb3JtKHBhdGhbMF0pCiAgICAgICAgICAgICAgICAgICAgICAgIHYgPSBtYXBbb3B0XQogICAgICAgICAgICAgICAgICAgIGVsaWYgbGVuKHBhdGgpID09IDI6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlY3QgPSBwYXRoWzBdCiAgICAgICAgICAgICAgICAgICAgICAgIG9wdCA9IHBhcnNlci5vcHRpb254Zm9ybShwYXRoWzFdKQogICAgICAgICAgICAgICAgICAgICAgICB2ID0gcGFyc2VyLmdldChzZWN0LCBvcHQsIHJhdz1UcnVlKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHJhaXNlIEludGVycG9sYXRpb25TeW50YXhFcnJvcigKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbiwgc2VjdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJNb3JlIHRoYW4gb25lICc6JyBmb3VuZDogJXIiICUgKHJlc3QsKSkKICAgICAgICAgICAgICAgIGV4Y2VwdCAoS2V5RXJyb3IsIE5vU2VjdGlvbkVycm9yLCBOb09wdGlvbkVycm9yKToKICAgICAgICAgICAgICAgICAgICByYWlzZSBJbnRlcnBvbGF0aW9uTWlzc2luZ09wdGlvbkVycm9yKAogICAgICAgICAgICAgICAgICAgICAgICBvcHRpb24sIHNlY3Rpb24sIHJlc3QsICI6Ii5qb2luKHBhdGgpKQogICAgICAgICAgICAgICAgaWYgIiQiIGluIHY6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5faW50ZXJwb2xhdGVfc29tZShwYXJzZXIsIG9wdCwgYWNjdW0sIHYsIHNlY3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWN0KHBhcnNlci5pdGVtcyhzZWN0LCByYXc9VHJ1ZSkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwdGggKyAxKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBhY2N1bS5hcHBlbmQodikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlIEludGVycG9sYXRpb25TeW50YXhFcnJvcigKICAgICAgICAgICAgICAgICAgICBvcHRpb24sIHNlY3Rpb24sCiAgICAgICAgICAgICAgICAgICAgIickJyBtdXN0IGJlIGZvbGxvd2VkIGJ5ICckJyBvciAneycsICIKICAgICAgICAgICAgICAgICAgICAiZm91bmQ6ICVyIiAlIChyZXN0LCkpCgoKY2xhc3MgTGVnYWN5SW50ZXJwb2xhdGlvbihJbnRlcnBvbGF0aW9uKToKICAgICIiIkRlcHJlY2F0ZWQgaW50ZXJwb2xhdGlvbiB1c2VkIGluIG9sZCB2ZXJzaW9ucyBvZiBDb25maWdQYXJzZXIuCiAgICBVc2UgQmFzaWNJbnRlcnBvbGF0aW9uIG9yIEV4dGVuZGVkSW50ZXJwb2xhdGlvbiBpbnN0ZWFkLiIiIgoKICAgIF9LRVlDUkUgPSByZS5jb21waWxlKHIiJVwoKFteKV0qKVwpc3wuIikKCiAgICBkZWYgYmVmb3JlX2dldChzZWxmLCBwYXJzZXIsIHNlY3Rpb24sIG9wdGlvbiwgdmFsdWUsIHZhcnMpOgogICAgICAgIHJhd3ZhbCA9IHZhbHVlCiAgICAgICAgZGVwdGggPSBNQVhfSU5URVJQT0xBVElPTl9ERVBUSAogICAgICAgIHdoaWxlIGRlcHRoOiAgICAgICAgICAgICAgICAgICAgIyBMb29wIHRocm91Z2ggdGhpcyB1bnRpbCBpdCdzIGRvbmUKICAgICAgICAgICAgZGVwdGggLT0gMQogICAgICAgICAgICBpZiB2YWx1ZSBhbmQgIiUoIiBpbiB2YWx1ZToKICAgICAgICAgICAgICAgIHJlcGxhY2UgPSBmdW5jdG9vbHMucGFydGlhbChzZWxmLl9pbnRlcnBvbGF0aW9uX3JlcGxhY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VyPXBhcnNlcikKICAgICAgICAgICAgICAgIHZhbHVlID0gc2VsZi5fS0VZQ1JFLnN1YihyZXBsYWNlLCB2YWx1ZSkKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICUgdmFycwogICAgICAgICAgICAgICAgZXhjZXB0IEtleUVycm9yIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgSW50ZXJwb2xhdGlvbk1pc3NpbmdPcHRpb25FcnJvcigKICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uLCBzZWN0aW9uLCByYXd2YWwsIGUuYXJnc1swXSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgaWYgdmFsdWUgYW5kICIlKCIgaW4gdmFsdWU6CiAgICAgICAgICAgIHJhaXNlIEludGVycG9sYXRpb25EZXB0aEVycm9yKG9wdGlvbiwgc2VjdGlvbiwgcmF3dmFsKQogICAgICAgIHJldHVybiB2YWx1ZQoKICAgIGRlZiBiZWZvcmVfc2V0KHNlbGYsIHBhcnNlciwgc2VjdGlvbiwgb3B0aW9uLCB2YWx1ZSk6CiAgICAgICAgcmV0dXJuIHZhbHVlCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9pbnRlcnBvbGF0aW9uX3JlcGxhY2UobWF0Y2gsIHBhcnNlcik6CiAgICAgICAgcyA9IG1hdGNoLmdyb3VwKDEpCiAgICAgICAgaWYgcyBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gbWF0Y2guZ3JvdXAoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiAiJSUoJXMpcyIgJSBwYXJzZXIub3B0aW9ueGZvcm0ocykKCgpjbGFzcyBSYXdDb25maWdQYXJzZXIoTXV0YWJsZU1hcHBpbmcpOgogICAgIiIiQ29uZmlnUGFyc2VyIHRoYXQgZG9lcyBub3QgZG8gaW50ZXJwb2xhdGlvbi4iIiIKCiAgICAjIFJlZ3VsYXIgZXhwcmVzc2lvbnMgZm9yIHBhcnNpbmcgc2VjdGlvbiBoZWFkZXJzIGFuZCBvcHRpb25zCiAgICBfU0VDVF9UTVBMID0gciIiIgogICAgICAgIFxbICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBbCiAgICAgICAgKD9QPGhlYWRlcj5bXl1dKykgICAgICAgICAgICAgICAgICAjIHZlcnkgcGVybWlzc2l2ZSEKICAgICAgICBcXSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgXQogICAgICAgICIiIgogICAgX09QVF9UTVBMID0gciIiIgogICAgICAgICg/UDxvcHRpb24+Lio/KSAgICAgICAgICAgICAgICAgICAgIyB2ZXJ5IHBlcm1pc3NpdmUhCiAgICAgICAgXHMqKD9QPHZpPntkZWxpbX0pXHMqICAgICAgICAgICAgICAjIGFueSBudW1iZXIgb2Ygc3BhY2UvdGFiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBmb2xsb3dlZCBieSBhbnkgb2YgdGhlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGFsbG93ZWQgZGVsaW1pdGVycywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgZm9sbG93ZWQgYnkgYW55IHNwYWNlL3RhYgogICAgICAgICg/UDx2YWx1ZT4uKikkICAgICAgICAgICAgICAgICAgICAgIyBldmVyeXRoaW5nIHVwIHRvIGVvbAogICAgICAgICIiIgogICAgX09QVF9OVl9UTVBMID0gciIiIgogICAgICAgICg/UDxvcHRpb24+Lio/KSAgICAgICAgICAgICAgICAgICAgIyB2ZXJ5IHBlcm1pc3NpdmUhCiAgICAgICAgXHMqKD86ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGFueSBudW1iZXIgb2Ygc3BhY2UvdGFiLAogICAgICAgICg/UDx2aT57ZGVsaW19KVxzKiAgICAgICAgICAgICAgICAgIyBvcHRpb25hbGx5IGZvbGxvd2VkIGJ5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGFueSBvZiB0aGUgYWxsb3dlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBkZWxpbWl0ZXJzLCBmb2xsb3dlZCBieSBhbnkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgc3BhY2UvdGFiCiAgICAgICAgKD9QPHZhbHVlPi4qKSk/JCAgICAgICAgICAgICAgICAgICAjIGV2ZXJ5dGhpbmcgdXAgdG8gZW9sCiAgICAgICAgIiIiCiAgICAjIEludGVycG9sYXRpb24gYWxnb3JpdGhtIHRvIGJlIHVzZWQgaWYgdGhlIHVzZXIgZG9lcyBub3Qgc3BlY2lmeSBhbm90aGVyCiAgICBfREVGQVVMVF9JTlRFUlBPTEFUSU9OID0gSW50ZXJwb2xhdGlvbigpCiAgICAjIENvbXBpbGVkIHJlZ3VsYXIgZXhwcmVzc2lvbiBmb3IgbWF0Y2hpbmcgc2VjdGlvbnMKICAgIFNFQ1RDUkUgPSByZS5jb21waWxlKF9TRUNUX1RNUEwsIHJlLlZFUkJPU0UpCiAgICAjIENvbXBpbGVkIHJlZ3VsYXIgZXhwcmVzc2lvbiBmb3IgbWF0Y2hpbmcgb3B0aW9ucyB3aXRoIHR5cGljYWwgc2VwYXJhdG9ycwogICAgT1BUQ1JFID0gcmUuY29tcGlsZShfT1BUX1RNUEwuZm9ybWF0KGRlbGltPSI9fDoiKSwgcmUuVkVSQk9TRSkKICAgICMgQ29tcGlsZWQgcmVndWxhciBleHByZXNzaW9uIGZvciBtYXRjaGluZyBvcHRpb25zIHdpdGggb3B0aW9uYWwgdmFsdWVzCiAgICAjIGRlbGltaXRlZCB1c2luZyB0eXBpY2FsIHNlcGFyYXRvcnMKICAgIE9QVENSRV9OViA9IHJlLmNvbXBpbGUoX09QVF9OVl9UTVBMLmZvcm1hdChkZWxpbT0iPXw6IiksIHJlLlZFUkJPU0UpCiAgICAjIENvbXBpbGVkIHJlZ3VsYXIgZXhwcmVzc2lvbiBmb3IgbWF0Y2hpbmcgbGVhZGluZyB3aGl0ZXNwYWNlIGluIGEgbGluZQogICAgTk9OU1BBQ0VDUkUgPSByZS5jb21waWxlKHIiXFMiKQogICAgIyBQb3NzaWJsZSBib29sZWFuIHZhbHVlcyBpbiB0aGUgY29uZmlndXJhdGlvbi4KICAgIEJPT0xFQU5fU1RBVEVTID0geycxJzogVHJ1ZSwgJ3llcyc6IFRydWUsICd0cnVlJzogVHJ1ZSwgJ29uJzogVHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICcwJzogRmFsc2UsICdubyc6IEZhbHNlLCAnZmFsc2UnOiBGYWxzZSwgJ29mZic6IEZhbHNlfQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBkZWZhdWx0cz1Ob25lLCBkaWN0X3R5cGU9X2RlZmF1bHRfZGljdCwKICAgICAgICAgICAgICAgICBhbGxvd19ub192YWx1ZT1GYWxzZSwgKiwgZGVsaW1pdGVycz0oJz0nLCAnOicpLAogICAgICAgICAgICAgICAgIGNvbW1lbnRfcHJlZml4ZXM9KCcjJywgJzsnKSwgaW5saW5lX2NvbW1lbnRfcHJlZml4ZXM9Tm9uZSwKICAgICAgICAgICAgICAgICBzdHJpY3Q9VHJ1ZSwgZW1wdHlfbGluZXNfaW5fdmFsdWVzPVRydWUsCiAgICAgICAgICAgICAgICAgZGVmYXVsdF9zZWN0aW9uPURFRkFVTFRTRUNULAogICAgICAgICAgICAgICAgIGludGVycG9sYXRpb249X1VOU0VUKToKCiAgICAgICAgc2VsZi5fZGljdCA9IGRpY3RfdHlwZQogICAgICAgIHNlbGYuX3NlY3Rpb25zID0gc2VsZi5fZGljdCgpCiAgICAgICAgc2VsZi5fZGVmYXVsdHMgPSBzZWxmLl9kaWN0KCkKICAgICAgICBzZWxmLl9wcm94aWVzID0gc2VsZi5fZGljdCgpCiAgICAgICAgc2VsZi5fcHJveGllc1tkZWZhdWx0X3NlY3Rpb25dID0gU2VjdGlvblByb3h5KHNlbGYsIGRlZmF1bHRfc2VjdGlvbikKICAgICAgICBpZiBkZWZhdWx0czoKICAgICAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gZGVmYXVsdHMuaXRlbXMoKToKICAgICAgICAgICAgICAgIHNlbGYuX2RlZmF1bHRzW3NlbGYub3B0aW9ueGZvcm0oa2V5KV0gPSB2YWx1ZQogICAgICAgIHNlbGYuX2RlbGltaXRlcnMgPSB0dXBsZShkZWxpbWl0ZXJzKQogICAgICAgIGlmIGRlbGltaXRlcnMgPT0gKCc9JywgJzonKToKICAgICAgICAgICAgc2VsZi5fb3B0Y3JlID0gc2VsZi5PUFRDUkVfTlYgaWYgYWxsb3dfbm9fdmFsdWUgZWxzZSBzZWxmLk9QVENSRQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGQgPSAifCIuam9pbihyZS5lc2NhcGUoZCkgZm9yIGQgaW4gZGVsaW1pdGVycykKICAgICAgICAgICAgaWYgYWxsb3dfbm9fdmFsdWU6CiAgICAgICAgICAgICAgICBzZWxmLl9vcHRjcmUgPSByZS5jb21waWxlKHNlbGYuX09QVF9OVl9UTVBMLmZvcm1hdChkZWxpbT1kKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmUuVkVSQk9TRSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuX29wdGNyZSA9IHJlLmNvbXBpbGUoc2VsZi5fT1BUX1RNUEwuZm9ybWF0KGRlbGltPWQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZS5WRVJCT1NFKQogICAgICAgIHNlbGYuX2NvbW1lbnRfcHJlZml4ZXMgPSB0dXBsZShjb21tZW50X3ByZWZpeGVzIG9yICgpKQogICAgICAgIHNlbGYuX2lubGluZV9jb21tZW50X3ByZWZpeGVzID0gdHVwbGUoaW5saW5lX2NvbW1lbnRfcHJlZml4ZXMgb3IgKCkpCiAgICAgICAgc2VsZi5fc3RyaWN0ID0gc3RyaWN0CiAgICAgICAgc2VsZi5fYWxsb3dfbm9fdmFsdWUgPSBhbGxvd19ub192YWx1ZQogICAgICAgIHNlbGYuX2VtcHR5X2xpbmVzX2luX3ZhbHVlcyA9IGVtcHR5X2xpbmVzX2luX3ZhbHVlcwogICAgICAgIHNlbGYuZGVmYXVsdF9zZWN0aW9uPWRlZmF1bHRfc2VjdGlvbgogICAgICAgIHNlbGYuX2ludGVycG9sYXRpb24gPSBpbnRlcnBvbGF0aW9uCiAgICAgICAgaWYgc2VsZi5faW50ZXJwb2xhdGlvbiBpcyBfVU5TRVQ6CiAgICAgICAgICAgIHNlbGYuX2ludGVycG9sYXRpb24gPSBzZWxmLl9ERUZBVUxUX0lOVEVSUE9MQVRJT04KICAgICAgICBpZiBzZWxmLl9pbnRlcnBvbGF0aW9uIGlzIE5vbmU6CiAgICAgICAgICAgIHNlbGYuX2ludGVycG9sYXRpb24gPSBJbnRlcnBvbGF0aW9uKCkKCiAgICBkZWYgZGVmYXVsdHMoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX2RlZmF1bHRzCgogICAgZGVmIHNlY3Rpb25zKHNlbGYpOgogICAgICAgICIiIlJldHVybiBhIGxpc3Qgb2Ygc2VjdGlvbiBuYW1lcywgZXhjbHVkaW5nIFtERUZBVUxUXSIiIgogICAgICAgICMgc2VsZi5fc2VjdGlvbnMgd2lsbCBuZXZlciBoYXZlIFtERUZBVUxUXSBpbiBpdAogICAgICAgIHJldHVybiBsaXN0KHNlbGYuX3NlY3Rpb25zLmtleXMoKSkKCiAgICBkZWYgYWRkX3NlY3Rpb24oc2VsZiwgc2VjdGlvbik6CiAgICAgICAgIiIiQ3JlYXRlIGEgbmV3IHNlY3Rpb24gaW4gdGhlIGNvbmZpZ3VyYXRpb24uCgogICAgICAgIFJhaXNlIER1cGxpY2F0ZVNlY3Rpb25FcnJvciBpZiBhIHNlY3Rpb24gYnkgdGhlIHNwZWNpZmllZCBuYW1lCiAgICAgICAgYWxyZWFkeSBleGlzdHMuIFJhaXNlIFZhbHVlRXJyb3IgaWYgbmFtZSBpcyBERUZBVUxULgogICAgICAgICIiIgogICAgICAgIGlmIHNlY3Rpb24gPT0gc2VsZi5kZWZhdWx0X3NlY3Rpb246CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoJ0ludmFsaWQgc2VjdGlvbiBuYW1lOiAlcicgJSBzZWN0aW9uKQoKICAgICAgICBpZiBzZWN0aW9uIGluIHNlbGYuX3NlY3Rpb25zOgogICAgICAgICAgICByYWlzZSBEdXBsaWNhdGVTZWN0aW9uRXJyb3Ioc2VjdGlvbikKICAgICAgICBzZWxmLl9zZWN0aW9uc1tzZWN0aW9uXSA9IHNlbGYuX2RpY3QoKQogICAgICAgIHNlbGYuX3Byb3hpZXNbc2VjdGlvbl0gPSBTZWN0aW9uUHJveHkoc2VsZiwgc2VjdGlvbikKCiAgICBkZWYgaGFzX3NlY3Rpb24oc2VsZiwgc2VjdGlvbik6CiAgICAgICAgIiIiSW5kaWNhdGUgd2hldGhlciB0aGUgbmFtZWQgc2VjdGlvbiBpcyBwcmVzZW50IGluIHRoZSBjb25maWd1cmF0aW9uLgoKICAgICAgICBUaGUgREVGQVVMVCBzZWN0aW9uIGlzIG5vdCBhY2tub3dsZWRnZWQuCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIHNlY3Rpb24gaW4gc2VsZi5fc2VjdGlvbnMKCiAgICBkZWYgb3B0aW9ucyhzZWxmLCBzZWN0aW9uKToKICAgICAgICAiIiJSZXR1cm4gYSBsaXN0IG9mIG9wdGlvbiBuYW1lcyBmb3IgdGhlIGdpdmVuIHNlY3Rpb24gbmFtZS4iIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgIG9wdHMgPSBzZWxmLl9zZWN0aW9uc1tzZWN0aW9uXS5jb3B5KCkKICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIHJhaXNlIE5vU2VjdGlvbkVycm9yKHNlY3Rpb24pCiAgICAgICAgb3B0cy51cGRhdGUoc2VsZi5fZGVmYXVsdHMpCiAgICAgICAgcmV0dXJuIGxpc3Qob3B0cy5rZXlzKCkpCgogICAgZGVmIHJlYWQoc2VsZiwgZmlsZW5hbWVzLCBlbmNvZGluZz1Ob25lKToKICAgICAgICAiIiJSZWFkIGFuZCBwYXJzZSBhIGZpbGVuYW1lIG9yIGEgbGlzdCBvZiBmaWxlbmFtZXMuCgogICAgICAgIEZpbGVzIHRoYXQgY2Fubm90IGJlIG9wZW5lZCBhcmUgc2lsZW50bHkgaWdub3JlZDsgdGhpcyBpcwogICAgICAgIGRlc2lnbmVkIHNvIHRoYXQgeW91IGNhbiBzcGVjaWZ5IGEgbGlzdCBvZiBwb3RlbnRpYWwKICAgICAgICBjb25maWd1cmF0aW9uIGZpbGUgbG9jYXRpb25zIChlLmcuIGN1cnJlbnQgZGlyZWN0b3J5LCB1c2VyJ3MKICAgICAgICBob21lIGRpcmVjdG9yeSwgc3lzdGVtd2lkZSBkaXJlY3RvcnkpLCBhbmQgYWxsIGV4aXN0aW5nCiAgICAgICAgY29uZmlndXJhdGlvbiBmaWxlcyBpbiB0aGUgbGlzdCB3aWxsIGJlIHJlYWQuICBBIHNpbmdsZQogICAgICAgIGZpbGVuYW1lIG1heSBhbHNvIGJlIGdpdmVuLgoKICAgICAgICBSZXR1cm4gbGlzdCBvZiBzdWNjZXNzZnVsbHkgcmVhZCBmaWxlcy4KICAgICAgICAiIiIKICAgICAgICBpZiBpc2luc3RhbmNlKGZpbGVuYW1lcywgc3RyKToKICAgICAgICAgICAgZmlsZW5hbWVzID0gW2ZpbGVuYW1lc10KICAgICAgICByZWFkX29rID0gW10KICAgICAgICBmb3IgZmlsZW5hbWUgaW4gZmlsZW5hbWVzOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB3aXRoIG9wZW4oZmlsZW5hbWUsIGVuY29kaW5nPWVuY29kaW5nKSBhcyBmcDoKICAgICAgICAgICAgICAgICAgICBzZWxmLl9yZWFkKGZwLCBmaWxlbmFtZSkKICAgICAgICAgICAgZXhjZXB0IElPRXJyb3I6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICByZWFkX29rLmFwcGVuZChmaWxlbmFtZSkKICAgICAgICByZXR1cm4gcmVhZF9vawoKICAgIGRlZiByZWFkX2ZpbGUoc2VsZiwgZiwgc291cmNlPU5vbmUpOgogICAgICAgICIiIkxpa2UgcmVhZCgpIGJ1dCB0aGUgYXJndW1lbnQgbXVzdCBiZSBhIGZpbGUtbGlrZSBvYmplY3QuCgogICAgICAgIFRoZSBgZicgYXJndW1lbnQgbXVzdCBiZSBpdGVyYWJsZSwgcmV0dXJuaW5nIG9uZSBsaW5lIGF0IGEgdGltZS4KICAgICAgICBPcHRpb25hbCBzZWNvbmQgYXJndW1lbnQgaXMgdGhlIGBzb3VyY2UnIHNwZWNpZnlpbmcgdGhlIG5hbWUgb2YgdGhlCiAgICAgICAgZmlsZSBiZWluZyByZWFkLiBJZiBub3QgZ2l2ZW4sIGl0IGlzIHRha2VuIGZyb20gZi5uYW1lLiBJZiBgZicgaGFzIG5vCiAgICAgICAgYG5hbWUnIGF0dHJpYnV0ZSwgYDw/Pz8+JyBpcyB1c2VkLgogICAgICAgICIiIgogICAgICAgIGlmIHNvdXJjZSBpcyBOb25lOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzb3VyY2UgPSBmLm5hbWUKICAgICAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICAgICAgc291cmNlID0gJzw/Pz8+JwogICAgICAgIHNlbGYuX3JlYWQoZiwgc291cmNlKQoKICAgIGRlZiByZWFkX3N0cmluZyhzZWxmLCBzdHJpbmcsIHNvdXJjZT0nPHN0cmluZz4nKToKICAgICAgICAiIiJSZWFkIGNvbmZpZ3VyYXRpb24gZnJvbSBhIGdpdmVuIHN0cmluZy4iIiIKICAgICAgICBzZmlsZSA9IGlvLlN0cmluZ0lPKHN0cmluZykKICAgICAgICBzZWxmLnJlYWRfZmlsZShzZmlsZSwgc291cmNlKQoKICAgIGRlZiByZWFkX2RpY3Qoc2VsZiwgZGljdGlvbmFyeSwgc291cmNlPSc8ZGljdD4nKToKICAgICAgICAiIiJSZWFkIGNvbmZpZ3VyYXRpb24gZnJvbSBhIGRpY3Rpb25hcnkuCgogICAgICAgIEtleXMgYXJlIHNlY3Rpb24gbmFtZXMsIHZhbHVlcyBhcmUgZGljdGlvbmFyaWVzIHdpdGgga2V5cyBhbmQgdmFsdWVzCiAgICAgICAgdGhhdCBzaG91bGQgYmUgcHJlc2VudCBpbiB0aGUgc2VjdGlvbi4gSWYgdGhlIHVzZWQgZGljdGlvbmFyeSB0eXBlCiAgICAgICAgcHJlc2VydmVzIG9yZGVyLCBzZWN0aW9ucyBhbmQgdGhlaXIga2V5cyB3aWxsIGJlIGFkZGVkIGluIG9yZGVyLgoKICAgICAgICBBbGwgdHlwZXMgaGVsZCBpbiB0aGUgZGljdGlvbmFyeSBhcmUgY29udmVydGVkIHRvIHN0cmluZ3MgZHVyaW5nCiAgICAgICAgcmVhZGluZywgaW5jbHVkaW5nIHNlY3Rpb24gbmFtZXMsIG9wdGlvbiBuYW1lcyBhbmQga2V5cy4KCiAgICAgICAgT3B0aW9uYWwgc2Vjb25kIGFyZ3VtZW50IGlzIHRoZSBgc291cmNlJyBzcGVjaWZ5aW5nIHRoZSBuYW1lIG9mIHRoZQogICAgICAgIGRpY3Rpb25hcnkgYmVpbmcgcmVhZC4KICAgICAgICAiIiIKICAgICAgICBlbGVtZW50c19hZGRlZCA9IHNldCgpCiAgICAgICAgZm9yIHNlY3Rpb24sIGtleXMgaW4gZGljdGlvbmFyeS5pdGVtcygpOgogICAgICAgICAgICBzZWN0aW9uID0gc3RyKHNlY3Rpb24pCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYuYWRkX3NlY3Rpb24oc2VjdGlvbikKICAgICAgICAgICAgZXhjZXB0IChEdXBsaWNhdGVTZWN0aW9uRXJyb3IsIFZhbHVlRXJyb3IpOgogICAgICAgICAgICAgICAgaWYgc2VsZi5fc3RyaWN0IGFuZCBzZWN0aW9uIGluIGVsZW1lbnRzX2FkZGVkOgogICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgIGVsZW1lbnRzX2FkZGVkLmFkZChzZWN0aW9uKQogICAgICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBrZXlzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBrZXkgPSBzZWxmLm9wdGlvbnhmb3JtKHN0cihrZXkpKQogICAgICAgICAgICAgICAgaWYgdmFsdWUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBzdHIodmFsdWUpCiAgICAgICAgICAgICAgICBpZiBzZWxmLl9zdHJpY3QgYW5kIChzZWN0aW9uLCBrZXkpIGluIGVsZW1lbnRzX2FkZGVkOgogICAgICAgICAgICAgICAgICAgIHJhaXNlIER1cGxpY2F0ZU9wdGlvbkVycm9yKHNlY3Rpb24sIGtleSwgc291cmNlKQogICAgICAgICAgICAgICAgZWxlbWVudHNfYWRkZWQuYWRkKChzZWN0aW9uLCBrZXkpKQogICAgICAgICAgICAgICAgc2VsZi5zZXQoc2VjdGlvbiwga2V5LCB2YWx1ZSkKCiAgICBkZWYgcmVhZGZwKHNlbGYsIGZwLCBmaWxlbmFtZT1Ob25lKToKICAgICAgICAiIiJEZXByZWNhdGVkLCB1c2UgcmVhZF9maWxlIGluc3RlYWQuIiIiCiAgICAgICAgd2FybmluZ3Mud2FybigKICAgICAgICAgICAgIlRoaXMgbWV0aG9kIHdpbGwgYmUgcmVtb3ZlZCBpbiBmdXR1cmUgdmVyc2lvbnMuICAiCiAgICAgICAgICAgICJVc2UgJ3BhcnNlci5yZWFkX2ZpbGUoKScgaW5zdGVhZC4iLAogICAgICAgICAgICBEZXByZWNhdGlvbldhcm5pbmcsIHN0YWNrbGV2ZWw9MgogICAgICAgICkKICAgICAgICBzZWxmLnJlYWRfZmlsZShmcCwgc291cmNlPWZpbGVuYW1lKQoKICAgIGRlZiBnZXQoc2VsZiwgc2VjdGlvbiwgb3B0aW9uLCAqLCByYXc9RmFsc2UsIHZhcnM9Tm9uZSwgZmFsbGJhY2s9X1VOU0VUKToKICAgICAgICAiIiJHZXQgYW4gb3B0aW9uIHZhbHVlIGZvciBhIGdpdmVuIHNlY3Rpb24uCgogICAgICAgIElmIGB2YXJzJyBpcyBwcm92aWRlZCwgaXQgbXVzdCBiZSBhIGRpY3Rpb25hcnkuIFRoZSBvcHRpb24gaXMgbG9va2VkIHVwCiAgICAgICAgaW4gYHZhcnMnIChpZiBwcm92aWRlZCksIGBzZWN0aW9uJywgYW5kIGluIGBERUZBVUxUU0VDVCcgaW4gdGhhdCBvcmRlci4KICAgICAgICBJZiB0aGUga2V5IGlzIG5vdCBmb3VuZCBhbmQgYGZhbGxiYWNrJyBpcyBwcm92aWRlZCwgaXQgaXMgdXNlZCBhcwogICAgICAgIGEgZmFsbGJhY2sgdmFsdWUuIGBOb25lJyBjYW4gYmUgcHJvdmlkZWQgYXMgYSBgZmFsbGJhY2snIHZhbHVlLgoKICAgICAgICBJZiBpbnRlcnBvbGF0aW9uIGlzIGVuYWJsZWQgYW5kIHRoZSBvcHRpb25hbCBhcmd1bWVudCBgcmF3JyBpcyBGYWxzZSwKICAgICAgICBhbGwgaW50ZXJwb2xhdGlvbnMgYXJlIGV4cGFuZGVkIGluIHRoZSByZXR1cm4gdmFsdWVzLgoKICAgICAgICBBcmd1bWVudHMgYHJhdycsIGB2YXJzJywgYW5kIGBmYWxsYmFjaycgYXJlIGtleXdvcmQgb25seS4KCiAgICAgICAgVGhlIHNlY3Rpb24gREVGQVVMVCBpcyBzcGVjaWFsLgogICAgICAgICIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgZCA9IHNlbGYuX3VuaWZ5X3ZhbHVlcyhzZWN0aW9uLCB2YXJzKQogICAgICAgIGV4Y2VwdCBOb1NlY3Rpb25FcnJvcjoKICAgICAgICAgICAgaWYgZmFsbGJhY2sgaXMgX1VOU0VUOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJldHVybiBmYWxsYmFjawogICAgICAgIG9wdGlvbiA9IHNlbGYub3B0aW9ueGZvcm0ob3B0aW9uKQogICAgICAgIHRyeToKICAgICAgICAgICAgdmFsdWUgPSBkW29wdGlvbl0KICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIGlmIGZhbGxiYWNrIGlzIF9VTlNFVDoKICAgICAgICAgICAgICAgIHJhaXNlIE5vT3B0aW9uRXJyb3Iob3B0aW9uLCBzZWN0aW9uKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmV0dXJuIGZhbGxiYWNrCgogICAgICAgIGlmIHJhdyBvciB2YWx1ZSBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gdmFsdWUKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gc2VsZi5faW50ZXJwb2xhdGlvbi5iZWZvcmVfZ2V0KHNlbGYsIHNlY3Rpb24sIG9wdGlvbiwgdmFsdWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZCkKCiAgICBkZWYgX2dldChzZWxmLCBzZWN0aW9uLCBjb252LCBvcHRpb24sICoqa3dhcmdzKToKICAgICAgICByZXR1cm4gY29udihzZWxmLmdldChzZWN0aW9uLCBvcHRpb24sICoqa3dhcmdzKSkKCiAgICBkZWYgZ2V0aW50KHNlbGYsIHNlY3Rpb24sIG9wdGlvbiwgKiwgcmF3PUZhbHNlLCB2YXJzPU5vbmUsCiAgICAgICAgICAgICAgIGZhbGxiYWNrPV9VTlNFVCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gc2VsZi5fZ2V0KHNlY3Rpb24sIGludCwgb3B0aW9uLCByYXc9cmF3LCB2YXJzPXZhcnMpCiAgICAgICAgZXhjZXB0IChOb1NlY3Rpb25FcnJvciwgTm9PcHRpb25FcnJvcik6CiAgICAgICAgICAgIGlmIGZhbGxiYWNrIGlzIF9VTlNFVDoKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsbGJhY2sKCiAgICBkZWYgZ2V0ZmxvYXQoc2VsZiwgc2VjdGlvbiwgb3B0aW9uLCAqLCByYXc9RmFsc2UsIHZhcnM9Tm9uZSwKICAgICAgICAgICAgICAgICBmYWxsYmFjaz1fVU5TRVQpOgogICAgICAgIHRyeToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2dldChzZWN0aW9uLCBmbG9hdCwgb3B0aW9uLCByYXc9cmF3LCB2YXJzPXZhcnMpCiAgICAgICAgZXhjZXB0IChOb1NlY3Rpb25FcnJvciwgTm9PcHRpb25FcnJvcik6CiAgICAgICAgICAgIGlmIGZhbGxiYWNrIGlzIF9VTlNFVDoKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsbGJhY2sKCiAgICBkZWYgZ2V0Ym9vbGVhbihzZWxmLCBzZWN0aW9uLCBvcHRpb24sICosIHJhdz1GYWxzZSwgdmFycz1Ob25lLAogICAgICAgICAgICAgICAgICAgZmFsbGJhY2s9X1VOU0VUKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9nZXQoc2VjdGlvbiwgc2VsZi5fY29udmVydF90b19ib29sZWFuLCBvcHRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmF3PXJhdywgdmFycz12YXJzKQogICAgICAgIGV4Y2VwdCAoTm9TZWN0aW9uRXJyb3IsIE5vT3B0aW9uRXJyb3IpOgogICAgICAgICAgICBpZiBmYWxsYmFjayBpcyBfVU5TRVQ6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmV0dXJuIGZhbGxiYWNrCgogICAgZGVmIGl0ZW1zKHNlbGYsIHNlY3Rpb249X1VOU0VULCByYXc9RmFsc2UsIHZhcnM9Tm9uZSk6CiAgICAgICAgIiIiUmV0dXJuIGEgbGlzdCBvZiAobmFtZSwgdmFsdWUpIHR1cGxlcyBmb3IgZWFjaCBvcHRpb24gaW4gYSBzZWN0aW9uLgoKICAgICAgICBBbGwgJSBpbnRlcnBvbGF0aW9ucyBhcmUgZXhwYW5kZWQgaW4gdGhlIHJldHVybiB2YWx1ZXMsIGJhc2VkIG9uIHRoZQogICAgICAgIGRlZmF1bHRzIHBhc3NlZCBpbnRvIHRoZSBjb25zdHJ1Y3RvciwgdW5sZXNzIHRoZSBvcHRpb25hbCBhcmd1bWVudAogICAgICAgIGByYXcnIGlzIHRydWUuICBBZGRpdGlvbmFsIHN1YnN0aXR1dGlvbnMgbWF5IGJlIHByb3ZpZGVkIHVzaW5nIHRoZQogICAgICAgIGB2YXJzJyBhcmd1bWVudCwgd2hpY2ggbXVzdCBiZSBhIGRpY3Rpb25hcnkgd2hvc2UgY29udGVudHMgb3ZlcnJpZGVzCiAgICAgICAgYW55IHByZS1leGlzdGluZyBkZWZhdWx0cy4KCiAgICAgICAgVGhlIHNlY3Rpb24gREVGQVVMVCBpcyBzcGVjaWFsLgogICAgICAgICIiIgogICAgICAgIGlmIHNlY3Rpb24gaXMgX1VOU0VUOgogICAgICAgICAgICByZXR1cm4gc3VwZXIoKS5pdGVtcygpCiAgICAgICAgZCA9IHNlbGYuX2RlZmF1bHRzLmNvcHkoKQogICAgICAgIHRyeToKICAgICAgICAgICAgZC51cGRhdGUoc2VsZi5fc2VjdGlvbnNbc2VjdGlvbl0pCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICBpZiBzZWN0aW9uICE9IHNlbGYuZGVmYXVsdF9zZWN0aW9uOgogICAgICAgICAgICAgICAgcmFpc2UgTm9TZWN0aW9uRXJyb3Ioc2VjdGlvbikKICAgICAgICAjIFVwZGF0ZSB3aXRoIHRoZSBlbnRyeSBzcGVjaWZpYyB2YXJpYWJsZXMKICAgICAgICBpZiB2YXJzOgogICAgICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiB2YXJzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBkW3NlbGYub3B0aW9ueGZvcm0oa2V5KV0gPSB2YWx1ZQogICAgICAgIHZhbHVlX2dldHRlciA9IGxhbWJkYSBvcHRpb246IHNlbGYuX2ludGVycG9sYXRpb24uYmVmb3JlX2dldChzZWxmLAogICAgICAgICAgICBzZWN0aW9uLCBvcHRpb24sIGRbb3B0aW9uXSwgZCkKICAgICAgICBpZiByYXc6CiAgICAgICAgICAgIHZhbHVlX2dldHRlciA9IGxhbWJkYSBvcHRpb246IGRbb3B0aW9uXQogICAgICAgIHJldHVybiBbKG9wdGlvbiwgdmFsdWVfZ2V0dGVyKG9wdGlvbikpIGZvciBvcHRpb24gaW4gZC5rZXlzKCldCgogICAgZGVmIG9wdGlvbnhmb3JtKHNlbGYsIG9wdGlvbnN0cik6CiAgICAgICAgcmV0dXJuIG9wdGlvbnN0ci5sb3dlcigpCgogICAgZGVmIGhhc19vcHRpb24oc2VsZiwgc2VjdGlvbiwgb3B0aW9uKToKICAgICAgICAiIiJDaGVjayBmb3IgdGhlIGV4aXN0ZW5jZSBvZiBhIGdpdmVuIG9wdGlvbiBpbiBhIGdpdmVuIHNlY3Rpb24uCiAgICAgICAgSWYgdGhlIHNwZWNpZmllZCBgc2VjdGlvbicgaXMgTm9uZSBvciBhbiBlbXB0eSBzdHJpbmcsIERFRkFVTFQgaXMKICAgICAgICBhc3N1bWVkLiBJZiB0aGUgc3BlY2lmaWVkIGBzZWN0aW9uJyBkb2VzIG5vdCBleGlzdCwgcmV0dXJucyBGYWxzZS4iIiIKICAgICAgICBpZiBub3Qgc2VjdGlvbiBvciBzZWN0aW9uID09IHNlbGYuZGVmYXVsdF9zZWN0aW9uOgogICAgICAgICAgICBvcHRpb24gPSBzZWxmLm9wdGlvbnhmb3JtKG9wdGlvbikKICAgICAgICAgICAgcmV0dXJuIG9wdGlvbiBpbiBzZWxmLl9kZWZhdWx0cwogICAgICAgIGVsaWYgc2VjdGlvbiBub3QgaW4gc2VsZi5fc2VjdGlvbnM6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG9wdGlvbiA9IHNlbGYub3B0aW9ueGZvcm0ob3B0aW9uKQogICAgICAgICAgICByZXR1cm4gKG9wdGlvbiBpbiBzZWxmLl9zZWN0aW9uc1tzZWN0aW9uXQogICAgICAgICAgICAgICAgICAgIG9yIG9wdGlvbiBpbiBzZWxmLl9kZWZhdWx0cykKCiAgICBkZWYgc2V0KHNlbGYsIHNlY3Rpb24sIG9wdGlvbiwgdmFsdWU9Tm9uZSk6CiAgICAgICAgIiIiU2V0IGFuIG9wdGlvbi4iIiIKICAgICAgICBpZiB2YWx1ZToKICAgICAgICAgICAgdmFsdWUgPSBzZWxmLl9pbnRlcnBvbGF0aW9uLmJlZm9yZV9zZXQoc2VsZiwgc2VjdGlvbiwgb3B0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSkKICAgICAgICBpZiBub3Qgc2VjdGlvbiBvciBzZWN0aW9uID09IHNlbGYuZGVmYXVsdF9zZWN0aW9uOgogICAgICAgICAgICBzZWN0ZGljdCA9IHNlbGYuX2RlZmF1bHRzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VjdGRpY3QgPSBzZWxmLl9zZWN0aW9uc1tzZWN0aW9uXQogICAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgICAgICByYWlzZSBOb1NlY3Rpb25FcnJvcihzZWN0aW9uKQogICAgICAgIHNlY3RkaWN0W3NlbGYub3B0aW9ueGZvcm0ob3B0aW9uKV0gPSB2YWx1ZQoKICAgIGRlZiB3cml0ZShzZWxmLCBmcCwgc3BhY2VfYXJvdW5kX2RlbGltaXRlcnM9VHJ1ZSk6CiAgICAgICAgIiIiV3JpdGUgYW4gLmluaS1mb3JtYXQgcmVwcmVzZW50YXRpb24gb2YgdGhlIGNvbmZpZ3VyYXRpb24gc3RhdGUuCgogICAgICAgIElmIGBzcGFjZV9hcm91bmRfZGVsaW1pdGVycycgaXMgVHJ1ZSAodGhlIGRlZmF1bHQpLCBkZWxpbWl0ZXJzCiAgICAgICAgYmV0d2VlbiBrZXlzIGFuZCB2YWx1ZXMgYXJlIHN1cnJvdW5kZWQgYnkgc3BhY2VzLgogICAgICAgICIiIgogICAgICAgIGlmIHNwYWNlX2Fyb3VuZF9kZWxpbWl0ZXJzOgogICAgICAgICAgICBkID0gIiB7fSAiLmZvcm1hdChzZWxmLl9kZWxpbWl0ZXJzWzBdKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGQgPSBzZWxmLl9kZWxpbWl0ZXJzWzBdCiAgICAgICAgaWYgc2VsZi5fZGVmYXVsdHM6CiAgICAgICAgICAgIHNlbGYuX3dyaXRlX3NlY3Rpb24oZnAsIHNlbGYuZGVmYXVsdF9zZWN0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9kZWZhdWx0cy5pdGVtcygpLCBkKQogICAgICAgIGZvciBzZWN0aW9uIGluIHNlbGYuX3NlY3Rpb25zOgogICAgICAgICAgICBzZWxmLl93cml0ZV9zZWN0aW9uKGZwLCBzZWN0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlY3Rpb25zW3NlY3Rpb25dLml0ZW1zKCksIGQpCgogICAgZGVmIF93cml0ZV9zZWN0aW9uKHNlbGYsIGZwLCBzZWN0aW9uX25hbWUsIHNlY3Rpb25faXRlbXMsIGRlbGltaXRlcik6CiAgICAgICAgIiIiV3JpdGUgYSBzaW5nbGUgc2VjdGlvbiB0byB0aGUgc3BlY2lmaWVkIGBmcCcuIiIiCiAgICAgICAgZnAud3JpdGUoIlt7fV1cbiIuZm9ybWF0KHNlY3Rpb25fbmFtZSkpCiAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gc2VjdGlvbl9pdGVtczoKICAgICAgICAgICAgdmFsdWUgPSBzZWxmLl9pbnRlcnBvbGF0aW9uLmJlZm9yZV93cml0ZShzZWxmLCBzZWN0aW9uX25hbWUsIGtleSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSkKICAgICAgICAgICAgaWYgdmFsdWUgaXMgbm90IE5vbmUgb3Igbm90IHNlbGYuX2FsbG93X25vX3ZhbHVlOgogICAgICAgICAgICAgICAgdmFsdWUgPSBkZWxpbWl0ZXIgKyBzdHIodmFsdWUpLnJlcGxhY2UoJ1xuJywgJ1xuXHQnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdmFsdWUgPSAiIgogICAgICAgICAgICBmcC53cml0ZSgie317fVxuIi5mb3JtYXQoa2V5LCB2YWx1ZSkpCiAgICAgICAgZnAud3JpdGUoIlxuIikKCiAgICBkZWYgcmVtb3ZlX29wdGlvbihzZWxmLCBzZWN0aW9uLCBvcHRpb24pOgogICAgICAgICIiIlJlbW92ZSBhbiBvcHRpb24uIiIiCiAgICAgICAgaWYgbm90IHNlY3Rpb24gb3Igc2VjdGlvbiA9PSBzZWxmLmRlZmF1bHRfc2VjdGlvbjoKICAgICAgICAgICAgc2VjdGRpY3QgPSBzZWxmLl9kZWZhdWx0cwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlY3RkaWN0ID0gc2VsZi5fc2VjdGlvbnNbc2VjdGlvbl0KICAgICAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICAgICAgcmFpc2UgTm9TZWN0aW9uRXJyb3Ioc2VjdGlvbikKICAgICAgICBvcHRpb24gPSBzZWxmLm9wdGlvbnhmb3JtKG9wdGlvbikKICAgICAgICBleGlzdGVkID0gb3B0aW9uIGluIHNlY3RkaWN0CiAgICAgICAgaWYgZXhpc3RlZDoKICAgICAgICAgICAgZGVsIHNlY3RkaWN0W29wdGlvbl0KICAgICAgICByZXR1cm4gZXhpc3RlZAoKICAgIGRlZiByZW1vdmVfc2VjdGlvbihzZWxmLCBzZWN0aW9uKToKICAgICAgICAiIiJSZW1vdmUgYSBmaWxlIHNlY3Rpb24uIiIiCiAgICAgICAgZXhpc3RlZCA9IHNlY3Rpb24gaW4gc2VsZi5fc2VjdGlvbnMKICAgICAgICBpZiBleGlzdGVkOgogICAgICAgICAgICBkZWwgc2VsZi5fc2VjdGlvbnNbc2VjdGlvbl0KICAgICAgICAgICAgZGVsIHNlbGYuX3Byb3hpZXNbc2VjdGlvbl0KICAgICAgICByZXR1cm4gZXhpc3RlZAoKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBrZXkpOgogICAgICAgIGlmIGtleSAhPSBzZWxmLmRlZmF1bHRfc2VjdGlvbiBhbmQgbm90IHNlbGYuaGFzX3NlY3Rpb24oa2V5KToKICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3Ioa2V5KQogICAgICAgIHJldHVybiBzZWxmLl9wcm94aWVzW2tleV0KCiAgICBkZWYgX19zZXRpdGVtX18oc2VsZiwga2V5LCB2YWx1ZSk6CiAgICAgICAgIyBUbyBjb25mb3JtIHdpdGggdGhlIG1hcHBpbmcgcHJvdG9jb2wsIG92ZXJ3cml0ZXMgZXhpc3RpbmcgdmFsdWVzIGluCiAgICAgICAgIyB0aGUgc2VjdGlvbi4KCiAgICAgICAgIyBYWFggdGhpcyBpcyBub3QgYXRvbWljIGlmIHJlYWRfZGljdCBmYWlscyBhdCBhbnkgcG9pbnQuIFRoZW4gYWdhaW4sCiAgICAgICAgIyBubyB1cGRhdGUgbWV0aG9kIGluIGNvbmZpZ3BhcnNlciBpcyBhdG9taWMgaW4gdGhpcyBpbXBsZW1lbnRhdGlvbi4KICAgICAgICBzZWxmLnJlbW92ZV9zZWN0aW9uKGtleSkKICAgICAgICBzZWxmLnJlYWRfZGljdCh7a2V5OiB2YWx1ZX0pCgogICAgZGVmIF9fZGVsaXRlbV9fKHNlbGYsIGtleSk6CiAgICAgICAgaWYga2V5ID09IHNlbGYuZGVmYXVsdF9zZWN0aW9uOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJDYW5ub3QgcmVtb3ZlIHRoZSBkZWZhdWx0IHNlY3Rpb24uIikKICAgICAgICBpZiBub3Qgc2VsZi5oYXNfc2VjdGlvbihrZXkpOgogICAgICAgICAgICByYWlzZSBLZXlFcnJvcihrZXkpCiAgICAgICAgc2VsZi5yZW1vdmVfc2VjdGlvbihrZXkpCgogICAgZGVmIF9fY29udGFpbnNfXyhzZWxmLCBrZXkpOgogICAgICAgIHJldHVybiBrZXkgPT0gc2VsZi5kZWZhdWx0X3NlY3Rpb24gb3Igc2VsZi5oYXNfc2VjdGlvbihrZXkpCgogICAgZGVmIF9fbGVuX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGxlbihzZWxmLl9zZWN0aW9ucykgKyAxICMgdGhlIGRlZmF1bHQgc2VjdGlvbgoKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICAjIFhYWCBkb2VzIGl0IGJyZWFrIHdoZW4gdW5kZXJseWluZyBjb250YWluZXIgc3RhdGUgY2hhbmdlZD8KICAgICAgICByZXR1cm4gaXRlcnRvb2xzLmNoYWluKChzZWxmLmRlZmF1bHRfc2VjdGlvbiwpLCBzZWxmLl9zZWN0aW9ucy5rZXlzKCkpCgogICAgZGVmIF9yZWFkKHNlbGYsIGZwLCBmcG5hbWUpOgogICAgICAgICIiIlBhcnNlIGEgc2VjdGlvbmVkIGNvbmZpZ3VyYXRpb24gZmlsZS4KCiAgICAgICAgRWFjaCBzZWN0aW9uIGluIGEgY29uZmlndXJhdGlvbiBmaWxlIGNvbnRhaW5zIGEgaGVhZGVyLCBpbmRpY2F0ZWQgYnkKICAgICAgICBhIG5hbWUgaW4gc3F1YXJlIGJyYWNrZXRzIChgW10nKSwgcGx1cyBrZXkvdmFsdWUgb3B0aW9ucywgaW5kaWNhdGVkIGJ5CiAgICAgICAgYG5hbWUnIGFuZCBgdmFsdWUnIGRlbGltaXRlZCB3aXRoIGEgc3BlY2lmaWMgc3Vic3RyaW5nIChgPScgb3IgYDonIGJ5CiAgICAgICAgZGVmYXVsdCkuCgogICAgICAgIFZhbHVlcyBjYW4gc3BhbiBtdWx0aXBsZSBsaW5lcywgYXMgbG9uZyBhcyB0aGV5IGFyZSBpbmRlbnRlZCBkZWVwZXIKICAgICAgICB0aGFuIHRoZSBmaXJzdCBsaW5lIG9mIHRoZSB2YWx1ZS4gRGVwZW5kaW5nIG9uIHRoZSBwYXJzZXIncyBtb2RlLCBibGFuawogICAgICAgIGxpbmVzIG1heSBiZSB0cmVhdGVkIGFzIHBhcnRzIG9mIG11bHRpbGluZSB2YWx1ZXMgb3IgaWdub3JlZC4KCiAgICAgICAgQ29uZmlndXJhdGlvbiBmaWxlcyBtYXkgaW5jbHVkZSBjb21tZW50cywgcHJlZml4ZWQgYnkgc3BlY2lmaWMKICAgICAgICBjaGFyYWN0ZXJzIChgIycgYW5kIGA7JyBieSBkZWZhdWx0KS4gQ29tbWVudHMgbWF5IGFwcGVhciBvbiB0aGVpciBvd24KICAgICAgICBpbiBhbiBvdGhlcndpc2UgZW1wdHkgbGluZSBvciBtYXkgYmUgZW50ZXJlZCBpbiBsaW5lcyBob2xkaW5nIHZhbHVlcyBvcgogICAgICAgIHNlY3Rpb24gbmFtZXMuCiAgICAgICAgIiIiCiAgICAgICAgZWxlbWVudHNfYWRkZWQgPSBzZXQoKQogICAgICAgIGN1cnNlY3QgPSBOb25lICAgICAgICAgICAgICAgICAgICAgICAgIyBOb25lLCBvciBhIGRpY3Rpb25hcnkKICAgICAgICBzZWN0bmFtZSA9IE5vbmUKICAgICAgICBvcHRuYW1lID0gTm9uZQogICAgICAgIGxpbmVubyA9IDAKICAgICAgICBpbmRlbnRfbGV2ZWwgPSAwCiAgICAgICAgZSA9IE5vbmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIE5vbmUsIG9yIGFuIGV4Y2VwdGlvbgogICAgICAgIGZvciBsaW5lbm8sIGxpbmUgaW4gZW51bWVyYXRlKGZwLCBzdGFydD0xKToKICAgICAgICAgICAgY29tbWVudF9zdGFydCA9IHN5cy5tYXhzaXplCiAgICAgICAgICAgICMgc3RyaXAgaW5saW5lIGNvbW1lbnRzCiAgICAgICAgICAgIGlubGluZV9wcmVmaXhlcyA9IHtwOiAtMSBmb3IgcCBpbiBzZWxmLl9pbmxpbmVfY29tbWVudF9wcmVmaXhlc30KICAgICAgICAgICAgd2hpbGUgY29tbWVudF9zdGFydCA9PSBzeXMubWF4c2l6ZSBhbmQgaW5saW5lX3ByZWZpeGVzOgogICAgICAgICAgICAgICAgbmV4dF9wcmVmaXhlcyA9IHt9CiAgICAgICAgICAgICAgICBmb3IgcHJlZml4LCBpbmRleCBpbiBpbmxpbmVfcHJlZml4ZXMuaXRlbXMoKToKICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGxpbmUuZmluZChwcmVmaXgsIGluZGV4KzEpCiAgICAgICAgICAgICAgICAgICAgaWYgaW5kZXggPT0gLTE6CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgbmV4dF9wcmVmaXhlc1twcmVmaXhdID0gaW5kZXgKICAgICAgICAgICAgICAgICAgICBpZiBpbmRleCA9PSAwIG9yIChpbmRleCA+IDAgYW5kIGxpbmVbaW5kZXgtMV0uaXNzcGFjZSgpKToKICAgICAgICAgICAgICAgICAgICAgICAgY29tbWVudF9zdGFydCA9IG1pbihjb21tZW50X3N0YXJ0LCBpbmRleCkKICAgICAgICAgICAgICAgIGlubGluZV9wcmVmaXhlcyA9IG5leHRfcHJlZml4ZXMKICAgICAgICAgICAgIyBzdHJpcCBmdWxsIGxpbmUgY29tbWVudHMKICAgICAgICAgICAgZm9yIHByZWZpeCBpbiBzZWxmLl9jb21tZW50X3ByZWZpeGVzOgogICAgICAgICAgICAgICAgaWYgbGluZS5zdHJpcCgpLnN0YXJ0c3dpdGgocHJlZml4KToKICAgICAgICAgICAgICAgICAgICBjb21tZW50X3N0YXJ0ID0gMAogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGlmIGNvbW1lbnRfc3RhcnQgPT0gc3lzLm1heHNpemU6CiAgICAgICAgICAgICAgICBjb21tZW50X3N0YXJ0ID0gTm9uZQogICAgICAgICAgICB2YWx1ZSA9IGxpbmVbOmNvbW1lbnRfc3RhcnRdLnN0cmlwKCkKICAgICAgICAgICAgaWYgbm90IHZhbHVlOgogICAgICAgICAgICAgICAgaWYgc2VsZi5fZW1wdHlfbGluZXNfaW5fdmFsdWVzOgogICAgICAgICAgICAgICAgICAgICMgYWRkIGVtcHR5IGxpbmUgdG8gdGhlIHZhbHVlLCBidXQgb25seSBpZiB0aGVyZSB3YXMgbm8KICAgICAgICAgICAgICAgICAgICAjIGNvbW1lbnQgb24gdGhlIGxpbmUKICAgICAgICAgICAgICAgICAgICBpZiAoY29tbWVudF9zdGFydCBpcyBOb25lIGFuZAogICAgICAgICAgICAgICAgICAgICAgICBjdXJzZWN0IGlzIG5vdCBOb25lIGFuZAogICAgICAgICAgICAgICAgICAgICAgICBvcHRuYW1lIGFuZAogICAgICAgICAgICAgICAgICAgICAgICBjdXJzZWN0W29wdG5hbWVdIGlzIG5vdCBOb25lKToKICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc2VjdFtvcHRuYW1lXS5hcHBlbmQoJycpICMgbmV3bGluZXMgYWRkZWQgYXQgam9pbgogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAjIGVtcHR5IGxpbmUgbWFya3MgZW5kIG9mIHZhbHVlCiAgICAgICAgICAgICAgICAgICAgaW5kZW50X2xldmVsID0gc3lzLm1heHNpemUKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICMgY29udGludWF0aW9uIGxpbmU/CiAgICAgICAgICAgIGZpcnN0X25vbnNwYWNlID0gc2VsZi5OT05TUEFDRUNSRS5zZWFyY2gobGluZSkKICAgICAgICAgICAgY3VyX2luZGVudF9sZXZlbCA9IGZpcnN0X25vbnNwYWNlLnN0YXJ0KCkgaWYgZmlyc3Rfbm9uc3BhY2UgZWxzZSAwCiAgICAgICAgICAgIGlmIChjdXJzZWN0IGlzIG5vdCBOb25lIGFuZCBvcHRuYW1lIGFuZAogICAgICAgICAgICAgICAgY3VyX2luZGVudF9sZXZlbCA+IGluZGVudF9sZXZlbCk6CiAgICAgICAgICAgICAgICBjdXJzZWN0W29wdG5hbWVdLmFwcGVuZCh2YWx1ZSkKICAgICAgICAgICAgIyBhIHNlY3Rpb24gaGVhZGVyIG9yIG9wdGlvbiBoZWFkZXI/CiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpbmRlbnRfbGV2ZWwgPSBjdXJfaW5kZW50X2xldmVsCiAgICAgICAgICAgICAgICAjIGlzIGl0IGEgc2VjdGlvbiBoZWFkZXI/CiAgICAgICAgICAgICAgICBtbyA9IHNlbGYuU0VDVENSRS5tYXRjaCh2YWx1ZSkKICAgICAgICAgICAgICAgIGlmIG1vOgogICAgICAgICAgICAgICAgICAgIHNlY3RuYW1lID0gbW8uZ3JvdXAoJ2hlYWRlcicpCiAgICAgICAgICAgICAgICAgICAgaWYgc2VjdG5hbWUgaW4gc2VsZi5fc2VjdGlvbnM6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHNlbGYuX3N0cmljdCBhbmQgc2VjdG5hbWUgaW4gZWxlbWVudHNfYWRkZWQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWlzZSBEdXBsaWNhdGVTZWN0aW9uRXJyb3Ioc2VjdG5hbWUsIGZwbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lbm8pCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNlY3QgPSBzZWxmLl9zZWN0aW9uc1tzZWN0bmFtZV0KICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudHNfYWRkZWQuYWRkKHNlY3RuYW1lKQogICAgICAgICAgICAgICAgICAgIGVsaWYgc2VjdG5hbWUgPT0gc2VsZi5kZWZhdWx0X3NlY3Rpb246CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNlY3QgPSBzZWxmLl9kZWZhdWx0cwogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNlY3QgPSBzZWxmLl9kaWN0KCkKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2VjdGlvbnNbc2VjdG5hbWVdID0gY3Vyc2VjdAogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9wcm94aWVzW3NlY3RuYW1lXSA9IFNlY3Rpb25Qcm94eShzZWxmLCBzZWN0bmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudHNfYWRkZWQuYWRkKHNlY3RuYW1lKQogICAgICAgICAgICAgICAgICAgICMgU28gc2VjdGlvbnMgY2FuJ3Qgc3RhcnQgd2l0aCBhIGNvbnRpbnVhdGlvbiBsaW5lCiAgICAgICAgICAgICAgICAgICAgb3B0bmFtZSA9IE5vbmUKICAgICAgICAgICAgICAgICMgbm8gc2VjdGlvbiBoZWFkZXIgaW4gdGhlIGZpbGU/CiAgICAgICAgICAgICAgICBlbGlmIGN1cnNlY3QgaXMgTm9uZToKICAgICAgICAgICAgICAgICAgICByYWlzZSBNaXNzaW5nU2VjdGlvbkhlYWRlckVycm9yKGZwbmFtZSwgbGluZW5vLCBsaW5lKQogICAgICAgICAgICAgICAgIyBhbiBvcHRpb24gbGluZT8KICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgbW8gPSBzZWxmLl9vcHRjcmUubWF0Y2godmFsdWUpCiAgICAgICAgICAgICAgICAgICAgaWYgbW86CiAgICAgICAgICAgICAgICAgICAgICAgIG9wdG5hbWUsIHZpLCBvcHR2YWwgPSBtby5ncm91cCgnb3B0aW9uJywgJ3ZpJywgJ3ZhbHVlJykKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IG9wdG5hbWU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gc2VsZi5faGFuZGxlX2Vycm9yKGUsIGZwbmFtZSwgbGluZW5vLCBsaW5lKQogICAgICAgICAgICAgICAgICAgICAgICBvcHRuYW1lID0gc2VsZi5vcHRpb254Zm9ybShvcHRuYW1lLnJzdHJpcCgpKQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5fc3RyaWN0IGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKHNlY3RuYW1lLCBvcHRuYW1lKSBpbiBlbGVtZW50c19hZGRlZCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWlzZSBEdXBsaWNhdGVPcHRpb25FcnJvcihzZWN0bmFtZSwgb3B0bmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZwbmFtZSwgbGluZW5vKQogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50c19hZGRlZC5hZGQoKHNlY3RuYW1lLCBvcHRuYW1lKSkKICAgICAgICAgICAgICAgICAgICAgICAgIyBUaGlzIGNoZWNrIGlzIGZpbmUgYmVjYXVzZSB0aGUgT1BUQ1JFIGNhbm5vdAogICAgICAgICAgICAgICAgICAgICAgICAjIG1hdGNoIGlmIGl0IHdvdWxkIHNldCBvcHR2YWwgdG8gTm9uZQogICAgICAgICAgICAgICAgICAgICAgICBpZiBvcHR2YWwgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHR2YWwgPSBvcHR2YWwuc3RyaXAoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc2VjdFtvcHRuYW1lXSA9IFtvcHR2YWxdCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHZhbHVlbGVzcyBvcHRpb24gaGFuZGxpbmcKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNlY3Rbb3B0bmFtZV0gPSBOb25lCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgIyBhIG5vbi1mYXRhbCBwYXJzaW5nIGVycm9yIG9jY3VycmVkLiBzZXQgdXAgdGhlCiAgICAgICAgICAgICAgICAgICAgICAgICMgZXhjZXB0aW9uIGJ1dCBrZWVwIGdvaW5nLiB0aGUgZXhjZXB0aW9uIHdpbGwgYmUKICAgICAgICAgICAgICAgICAgICAgICAgIyByYWlzZWQgYXQgdGhlIGVuZCBvZiB0aGUgZmlsZSBhbmQgd2lsbCBjb250YWluIGEKICAgICAgICAgICAgICAgICAgICAgICAgIyBsaXN0IG9mIGFsbCBib2d1cyBsaW5lcwogICAgICAgICAgICAgICAgICAgICAgICBlID0gc2VsZi5faGFuZGxlX2Vycm9yKGUsIGZwbmFtZSwgbGluZW5vLCBsaW5lKQogICAgICAgICMgaWYgYW55IHBhcnNpbmcgZXJyb3JzIG9jY3VycmVkLCByYWlzZSBhbiBleGNlcHRpb24KICAgICAgICBpZiBlOgogICAgICAgICAgICByYWlzZSBlCiAgICAgICAgc2VsZi5fam9pbl9tdWx0aWxpbmVfdmFsdWVzKCkKCiAgICBkZWYgX2pvaW5fbXVsdGlsaW5lX3ZhbHVlcyhzZWxmKToKICAgICAgICBkZWZhdWx0cyA9IHNlbGYuZGVmYXVsdF9zZWN0aW9uLCBzZWxmLl9kZWZhdWx0cwogICAgICAgIGFsbF9zZWN0aW9ucyA9IGl0ZXJ0b29scy5jaGFpbigoZGVmYXVsdHMsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2VjdGlvbnMuaXRlbXMoKSkKICAgICAgICBmb3Igc2VjdGlvbiwgb3B0aW9ucyBpbiBhbGxfc2VjdGlvbnM6CiAgICAgICAgICAgIGZvciBuYW1lLCB2YWwgaW4gb3B0aW9ucy5pdGVtcygpOgogICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZSh2YWwsIGxpc3QpOgogICAgICAgICAgICAgICAgICAgIHZhbCA9ICdcbicuam9pbih2YWwpLnJzdHJpcCgpCiAgICAgICAgICAgICAgICBvcHRpb25zW25hbWVdID0gc2VsZi5faW50ZXJwb2xhdGlvbi5iZWZvcmVfcmVhZChzZWxmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VjdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUsIHZhbCkKCiAgICBkZWYgX2hhbmRsZV9lcnJvcihzZWxmLCBleGMsIGZwbmFtZSwgbGluZW5vLCBsaW5lKToKICAgICAgICBpZiBub3QgZXhjOgogICAgICAgICAgICBleGMgPSBQYXJzaW5nRXJyb3IoZnBuYW1lKQogICAgICAgIGV4Yy5hcHBlbmQobGluZW5vLCByZXByKGxpbmUpKQogICAgICAgIHJldHVybiBleGMKCiAgICBkZWYgX3VuaWZ5X3ZhbHVlcyhzZWxmLCBzZWN0aW9uLCB2YXJzKToKICAgICAgICAiIiJDcmVhdGUgYSBzZXF1ZW5jZSBvZiBsb29rdXBzIHdpdGggJ3ZhcnMnIHRha2luZyBwcmlvcml0eSBvdmVyCiAgICAgICAgdGhlICdzZWN0aW9uJyB3aGljaCB0YWtlcyBwcmlvcml0eSBvdmVyIHRoZSBERUZBVUxUU0VDVC4KCiAgICAgICAgIiIiCiAgICAgICAgc2VjdGlvbmRpY3QgPSB7fQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VjdGlvbmRpY3QgPSBzZWxmLl9zZWN0aW9uc1tzZWN0aW9uXQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgaWYgc2VjdGlvbiAhPSBzZWxmLmRlZmF1bHRfc2VjdGlvbjoKICAgICAgICAgICAgICAgIHJhaXNlIE5vU2VjdGlvbkVycm9yKHNlY3Rpb24pCiAgICAgICAgIyBVcGRhdGUgd2l0aCB0aGUgZW50cnkgc3BlY2lmaWMgdmFyaWFibGVzCiAgICAgICAgdmFyZGljdCA9IHt9CiAgICAgICAgaWYgdmFyczoKICAgICAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gdmFycy5pdGVtcygpOgogICAgICAgICAgICAgICAgaWYgdmFsdWUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBzdHIodmFsdWUpCiAgICAgICAgICAgICAgICB2YXJkaWN0W3NlbGYub3B0aW9ueGZvcm0oa2V5KV0gPSB2YWx1ZQogICAgICAgIHJldHVybiBfQ2hhaW5NYXAodmFyZGljdCwgc2VjdGlvbmRpY3QsIHNlbGYuX2RlZmF1bHRzKQoKICAgIGRlZiBfY29udmVydF90b19ib29sZWFuKHNlbGYsIHZhbHVlKToKICAgICAgICAiIiJSZXR1cm4gYSBib29sZWFuIHZhbHVlIHRyYW5zbGF0aW5nIGZyb20gb3RoZXIgdHlwZXMgaWYgbmVjZXNzYXJ5LgogICAgICAgICIiIgogICAgICAgIGlmIHZhbHVlLmxvd2VyKCkgbm90IGluIHNlbGYuQk9PTEVBTl9TVEFURVM6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoJ05vdCBhIGJvb2xlYW46ICVzJyAlIHZhbHVlKQogICAgICAgIHJldHVybiBzZWxmLkJPT0xFQU5fU1RBVEVTW3ZhbHVlLmxvd2VyKCldCgogICAgZGVmIF92YWxpZGF0ZV92YWx1ZV90eXBlcyhzZWxmLCAqLCBzZWN0aW9uPSIiLCBvcHRpb249IiIsIHZhbHVlPSIiKToKICAgICAgICAiIiJSYWlzZXMgYSBUeXBlRXJyb3IgZm9yIG5vbi1zdHJpbmcgdmFsdWVzLgoKICAgICAgICBUaGUgb25seSBsZWdhbCBub24tc3RyaW5nIHZhbHVlIGlmIHdlIGFsbG93IHZhbHVlbGVzcwogICAgICAgIG9wdGlvbnMgaXMgTm9uZSwgc28gd2UgbmVlZCB0byBjaGVjayBpZiB0aGUgdmFsdWUgaXMgYQogICAgICAgIHN0cmluZyBpZjoKICAgICAgICAtIHdlIGRvIG5vdCBhbGxvdyB2YWx1ZWxlc3Mgb3B0aW9ucywgb3IKICAgICAgICAtIHdlIGFsbG93IHZhbHVlbGVzcyBvcHRpb25zIGJ1dCB0aGUgdmFsdWUgaXMgbm90IE5vbmUKCiAgICAgICAgRm9yIGNvbXBhdGliaWxpdHkgcmVhc29ucyB0aGlzIG1ldGhvZCBpcyBub3QgdXNlZCBpbiBjbGFzc2ljIHNldCgpCiAgICAgICAgZm9yIFJhd0NvbmZpZ1BhcnNlcnMuIEl0IGlzIGludm9rZWQgaW4gZXZlcnkgY2FzZSBmb3IgbWFwcGluZyBwcm90b2NvbAogICAgICAgIGFjY2VzcyBhbmQgaW4gQ29uZmlnUGFyc2VyLnNldCgpLgogICAgICAgICIiIgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHNlY3Rpb24sIHN0cik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigic2VjdGlvbiBuYW1lcyBtdXN0IGJlIHN0cmluZ3MiKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG9wdGlvbiwgc3RyKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJvcHRpb24ga2V5cyBtdXN0IGJlIHN0cmluZ3MiKQogICAgICAgIGlmIG5vdCBzZWxmLl9hbGxvd19ub192YWx1ZSBvciB2YWx1ZToKICAgICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UodmFsdWUsIHN0cik6CiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIm9wdGlvbiB2YWx1ZXMgbXVzdCBiZSBzdHJpbmdzIikKCgpjbGFzcyBDb25maWdQYXJzZXIoUmF3Q29uZmlnUGFyc2VyKToKICAgICIiIkNvbmZpZ1BhcnNlciBpbXBsZW1lbnRpbmcgaW50ZXJwb2xhdGlvbi4iIiIKCiAgICBfREVGQVVMVF9JTlRFUlBPTEFUSU9OID0gQmFzaWNJbnRlcnBvbGF0aW9uKCkKCiAgICBkZWYgc2V0KHNlbGYsIHNlY3Rpb24sIG9wdGlvbiwgdmFsdWU9Tm9uZSk6CiAgICAgICAgIiIiU2V0IGFuIG9wdGlvbi4gIEV4dGVuZHMgUmF3Q29uZmlnUGFyc2VyLnNldCBieSB2YWxpZGF0aW5nIHR5cGUgYW5kCiAgICAgICAgaW50ZXJwb2xhdGlvbiBzeW50YXggb24gdGhlIHZhbHVlLiIiIgogICAgICAgIHNlbGYuX3ZhbGlkYXRlX3ZhbHVlX3R5cGVzKG9wdGlvbj1vcHRpb24sIHZhbHVlPXZhbHVlKQogICAgICAgIHN1cGVyKCkuc2V0KHNlY3Rpb24sIG9wdGlvbiwgdmFsdWUpCgogICAgZGVmIGFkZF9zZWN0aW9uKHNlbGYsIHNlY3Rpb24pOgogICAgICAgICIiIkNyZWF0ZSBhIG5ldyBzZWN0aW9uIGluIHRoZSBjb25maWd1cmF0aW9uLiAgRXh0ZW5kcwogICAgICAgIFJhd0NvbmZpZ1BhcnNlci5hZGRfc2VjdGlvbiBieSB2YWxpZGF0aW5nIGlmIHRoZSBzZWN0aW9uIG5hbWUgaXMKICAgICAgICBhIHN0cmluZy4iIiIKICAgICAgICBzZWxmLl92YWxpZGF0ZV92YWx1ZV90eXBlcyhzZWN0aW9uPXNlY3Rpb24pCiAgICAgICAgc3VwZXIoKS5hZGRfc2VjdGlvbihzZWN0aW9uKQoKCmNsYXNzIFNhZmVDb25maWdQYXJzZXIoQ29uZmlnUGFyc2VyKToKICAgICIiIkNvbmZpZ1BhcnNlciBhbGlhcyBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkgcHVycG9zZXMuIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqYXJncywgKiprd2FyZ3MpCiAgICAgICAgd2FybmluZ3Mud2FybigKICAgICAgICAgICAgIlRoZSBTYWZlQ29uZmlnUGFyc2VyIGNsYXNzIGhhcyBiZWVuIHJlbmFtZWQgdG8gQ29uZmlnUGFyc2VyICIKICAgICAgICAgICAgImluIFB5dGhvbiAzLjIuIFRoaXMgYWxpYXMgd2lsbCBiZSByZW1vdmVkIGluIGZ1dHVyZSB2ZXJzaW9ucy4iCiAgICAgICAgICAgICIgVXNlIENvbmZpZ1BhcnNlciBkaXJlY3RseSBpbnN0ZWFkLiIsCiAgICAgICAgICAgIERlcHJlY2F0aW9uV2FybmluZywgc3RhY2tsZXZlbD0yCiAgICAgICAgKQoKCmNsYXNzIFNlY3Rpb25Qcm94eShNdXRhYmxlTWFwcGluZyk6CiAgICAiIiJBIHByb3h5IGZvciBhIHNpbmdsZSBzZWN0aW9uIGZyb20gYSBwYXJzZXIuIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHBhcnNlciwgbmFtZSk6CiAgICAgICAgIiIiQ3JlYXRlcyBhIHZpZXcgb24gYSBzZWN0aW9uIG9mIHRoZSBzcGVjaWZpZWQgYG5hbWVgIGluIGBwYXJzZXJgLiIiIgogICAgICAgIHNlbGYuX3BhcnNlciA9IHBhcnNlcgogICAgICAgIHNlbGYuX25hbWUgPSBuYW1lCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiAnPFNlY3Rpb246IHt9PicuZm9ybWF0KHNlbGYuX25hbWUpCgogICAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGtleSk6CiAgICAgICAgaWYgbm90IHNlbGYuX3BhcnNlci5oYXNfb3B0aW9uKHNlbGYuX25hbWUsIGtleSk6CiAgICAgICAgICAgIHJhaXNlIEtleUVycm9yKGtleSkKICAgICAgICByZXR1cm4gc2VsZi5fcGFyc2VyLmdldChzZWxmLl9uYW1lLCBrZXkpCgogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIGtleSwgdmFsdWUpOgogICAgICAgIHNlbGYuX3BhcnNlci5fdmFsaWRhdGVfdmFsdWVfdHlwZXMob3B0aW9uPWtleSwgdmFsdWU9dmFsdWUpCiAgICAgICAgcmV0dXJuIHNlbGYuX3BhcnNlci5zZXQoc2VsZi5fbmFtZSwga2V5LCB2YWx1ZSkKCiAgICBkZWYgX19kZWxpdGVtX18oc2VsZiwga2V5KToKICAgICAgICBpZiBub3QgKHNlbGYuX3BhcnNlci5oYXNfb3B0aW9uKHNlbGYuX25hbWUsIGtleSkgYW5kCiAgICAgICAgICAgICAgICBzZWxmLl9wYXJzZXIucmVtb3ZlX29wdGlvbihzZWxmLl9uYW1lLCBrZXkpKToKICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3Ioa2V5KQoKICAgIGRlZiBfX2NvbnRhaW5zX18oc2VsZiwga2V5KToKICAgICAgICByZXR1cm4gc2VsZi5fcGFyc2VyLmhhc19vcHRpb24oc2VsZi5fbmFtZSwga2V5KQoKICAgIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICAgIHJldHVybiBsZW4oc2VsZi5fb3B0aW9ucygpKQoKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fb3B0aW9ucygpLl9faXRlcl9fKCkKCiAgICBkZWYgX29wdGlvbnMoc2VsZik6CiAgICAgICAgaWYgc2VsZi5fbmFtZSAhPSBzZWxmLl9wYXJzZXIuZGVmYXVsdF9zZWN0aW9uOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fcGFyc2VyLm9wdGlvbnMoc2VsZi5fbmFtZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fcGFyc2VyLmRlZmF1bHRzKCkKCiAgICBkZWYgZ2V0KHNlbGYsIG9wdGlvbiwgZmFsbGJhY2s9Tm9uZSwgKiwgcmF3PUZhbHNlLCB2YXJzPU5vbmUpOgogICAgICAgIHJldHVybiBzZWxmLl9wYXJzZXIuZ2V0KHNlbGYuX25hbWUsIG9wdGlvbiwgcmF3PXJhdywgdmFycz12YXJzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbGxiYWNrPWZhbGxiYWNrKQoKICAgIGRlZiBnZXRpbnQoc2VsZiwgb3B0aW9uLCBmYWxsYmFjaz1Ob25lLCAqLCByYXc9RmFsc2UsIHZhcnM9Tm9uZSk6CiAgICAgICAgcmV0dXJuIHNlbGYuX3BhcnNlci5nZXRpbnQoc2VsZi5fbmFtZSwgb3B0aW9uLCByYXc9cmF3LCB2YXJzPXZhcnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFsbGJhY2s9ZmFsbGJhY2spCgogICAgZGVmIGdldGZsb2F0KHNlbGYsIG9wdGlvbiwgZmFsbGJhY2s9Tm9uZSwgKiwgcmF3PUZhbHNlLCB2YXJzPU5vbmUpOgogICAgICAgIHJldHVybiBzZWxmLl9wYXJzZXIuZ2V0ZmxvYXQoc2VsZi5fbmFtZSwgb3B0aW9uLCByYXc9cmF3LCB2YXJzPXZhcnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxsYmFjaz1mYWxsYmFjaykKCiAgICBkZWYgZ2V0Ym9vbGVhbihzZWxmLCBvcHRpb24sIGZhbGxiYWNrPU5vbmUsICosIHJhdz1GYWxzZSwgdmFycz1Ob25lKToKICAgICAgICByZXR1cm4gc2VsZi5fcGFyc2VyLmdldGJvb2xlYW4oc2VsZi5fbmFtZSwgb3B0aW9uLCByYXc9cmF3LCB2YXJzPXZhcnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbGxiYWNrPWZhbGxiYWNrKQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIHBhcnNlcihzZWxmKToKICAgICAgICAjIFRoZSBwYXJzZXIgb2JqZWN0IG9mIHRoZSBwcm94eSBpcyByZWFkLW9ubHkuCiAgICAgICAgcmV0dXJuIHNlbGYuX3BhcnNlcgoKICAgIEBwcm9wZXJ0eQogICAgZGVmIG5hbWUoc2VsZik6CiAgICAgICAgIyBUaGUgbmFtZSBvZiB0aGUgc2VjdGlvbiBvbiBhIHByb3h5IGlzIHJlYWQtb25seS4KICAgICAgICByZXR1cm4gc2VsZi5fbmFtZQo=',
'/Lib/datetime.py':'IiIiQ29uY3JldGUgZGF0ZS90aW1lIGFuZCByZWxhdGVkIHR5cGVzIC0tIHByb3RvdHlwZSBpbXBsZW1lbnRlZCBpbiBQeXRob24uCgpTZWUgaHR0cDovL3d3dy56b3BlLm9yZy9NZW1iZXJzL2ZkcmFrZS9EYXRlVGltZVdpa2kvRnJvbnRQYWdlCgpTZWUgYWxzbyBodHRwOi8vZGlyLnlhaG9vLmNvbS9SZWZlcmVuY2UvY2FsZW5kYXJzLwoKRm9yIGEgcHJpbWVyIG9uIERTVCwgaW5jbHVkaW5nIG1hbnkgY3VycmVudCBEU1QgcnVsZXMsIHNlZQpodHRwOi8vd2ViZXhoaWJpdHMub3JnL2RheWxpZ2h0c2F2aW5nLwoKRm9yIG1vcmUgYWJvdXQgRFNUIHRoYW4geW91IGV2ZXIgd2FudGVkIHRvIGtub3csIHNlZQpmdHA6Ly9lbHNpZS5uY2kubmloLmdvdi9wdWIvCgpTb3VyY2VzIGZvciB0aW1lIHpvbmUgYW5kIERTVCBkYXRhOiBodHRwOi8vd3d3LnR3aW5zdW4uY29tL3R6L3R6LWxpbmsuaHRtCgpUaGlzIHdhcyBvcmlnaW5hbGx5IGNvcGllZCBmcm9tIHRoZSBzYW5kYm94IG9mIHRoZSBDUHl0aG9uIENWUyByZXBvc2l0b3J5LgpUaGFua3MgdG8gVGltIFBldGVycyBmb3Igc3VnZ2VzdGluZyB1c2luZyBpdC4KIiIiCgppbXBvcnQgdGltZSBhcyBfdGltZQppbXBvcnQgbWF0aCBhcyBfbWF0aAoKZGVmIF9zdGF0ZV9jbXAoeCwgeSk6CiAgICByZXR1cm4gMCBpZiB4ID09IHkgZWxzZSAxIGlmIHggPiB5IGVsc2UgLTEKCmRlZiBfdHVwbGVfY21wKHgsIHkpOgogICAgcmV0dXJuIDAgaWYgeCA9PSB5IGVsc2UgMSBpZiB4ID4geSBlbHNlIC0xCgpNSU5ZRUFSID0gMQpNQVhZRUFSID0gOTk5OQpfTUFYT1JESU5BTCA9IDM2NTIwNTkgIyBkYXRlLm1heC50b29yZGluYWwoKQoKIyBVdGlsaXR5IGZ1bmN0aW9ucywgYWRhcHRlZCBmcm9tIFB5dGhvbidzIERlbW8vY2xhc3Nlcy9EYXRlcy5weSwgd2hpY2gKIyBhbHNvIGFzc3VtZXMgdGhlIGN1cnJlbnQgR3JlZ29yaWFuIGNhbGVuZGFyIGluZGVmaW5pdGVseSBleHRlbmRlZCBpbgojIGJvdGggZGlyZWN0aW9ucy4gIERpZmZlcmVuY2U6ICBEYXRlcy5weSBjYWxscyBKYW51YXJ5IDEgb2YgeWVhciAwIGRheQojIG51bWJlciAxLiAgVGhlIGNvZGUgaGVyZSBjYWxscyBKYW51YXJ5IDEgb2YgeWVhciAxIGRheSBudW1iZXIgMS4gIFRoaXMgaXMKIyB0byBtYXRjaCB0aGUgZGVmaW5pdGlvbiBvZiB0aGUgInByb2xlcHRpYyBHcmVnb3JpYW4iIGNhbGVuZGFyIGluIERlcnNob3dpdHoKIyBhbmQgUmVpbmdvbGQncyAiQ2FsZW5kcmljYWwgQ2FsY3VsYXRpb25zIiwgd2hlcmUgaXQncyB0aGUgYmFzZSBjYWxlbmRhcgojIGZvciBhbGwgY29tcHV0YXRpb25zLiAgU2VlIHRoZSBib29rIGZvciBhbGdvcml0aG1zIGZvciBjb252ZXJ0aW5nIGJldHdlZW4KIyBwcm9sZXB0aWMgR3JlZ29yaWFuIG9yZGluYWxzIGFuZCBtYW55IG90aGVyIGNhbGVuZGFyIHN5c3RlbXMuCgpfREFZU19JTl9NT05USCA9IFtOb25lLCAzMSwgMjgsIDMxLCAzMCwgMzEsIDMwLCAzMSwgMzEsIDMwLCAzMSwgMzAsIDMxXQoKX0RBWVNfQkVGT1JFX01PTlRIID0gW05vbmVdCmRibSA9IDAKZm9yIGRpbSBpbiBfREFZU19JTl9NT05USFsxOl06CiAgICBfREFZU19CRUZPUkVfTU9OVEguYXBwZW5kKGRibSkKICAgIGRibSArPSBkaW0KI2RlbCBkYm0sIGRpbQoKZGVmIF9pc19sZWFwKHllYXIpOgogICAgInllYXIgLT4gMSBpZiBsZWFwIHllYXIsIGVsc2UgMC4iCiAgICByZXR1cm4geWVhciAlIDQgPT0gMCBhbmQgKHllYXIgJSAxMDAgIT0gMCBvciB5ZWFyICUgNDAwID09IDApCgpkZWYgX2RheXNfYmVmb3JlX3llYXIoeWVhcik6CiAgICAieWVhciAtPiBudW1iZXIgb2YgZGF5cyBiZWZvcmUgSmFudWFyeSAxc3Qgb2YgeWVhci4iCiAgICB5ID0geWVhciAtIDEKICAgIHJldHVybiB5KjM2NSArIHkvLzQgLSB5Ly8xMDAgKyB5Ly80MDAKCmRlZiBfZGF5c19pbl9tb250aCh5ZWFyLCBtb250aCk6CiAgICAieWVhciwgbW9udGggLT4gbnVtYmVyIG9mIGRheXMgaW4gdGhhdCBtb250aCBpbiB0aGF0IHllYXIuIgogICAgYXNzZXJ0IDEgPD0gbW9udGggPD0gMTIsIG1vbnRoCiAgICBpZiBtb250aCA9PSAyIGFuZCBfaXNfbGVhcCh5ZWFyKToKICAgICAgICByZXR1cm4gMjkKICAgIHJldHVybiBfREFZU19JTl9NT05USFttb250aF0KCmRlZiBfZGF5c19iZWZvcmVfbW9udGgoeWVhciwgbW9udGgpOgogICAgInllYXIsIG1vbnRoIC0+IG51bWJlciBvZiBkYXlzIGluIHllYXIgcHJlY2VlZGluZyBmaXJzdCBkYXkgb2YgbW9udGguIgogICAgYXNzZXJ0IDEgPD0gbW9udGggPD0gMTIsICdtb250aCBtdXN0IGJlIGluIDEuLjEyJwogICAgcmV0dXJuIF9EQVlTX0JFRk9SRV9NT05USFttb250aF0gKyAobW9udGggPiAyIGFuZCBfaXNfbGVhcCh5ZWFyKSkKCmRlZiBfeW1kMm9yZCh5ZWFyLCBtb250aCwgZGF5KToKICAgICJ5ZWFyLCBtb250aCwgZGF5IC0+IG9yZGluYWwsIGNvbnNpZGVyaW5nIDAxLUphbi0wMDAxIGFzIGRheSAxLiIKICAgIGFzc2VydCAxIDw9IG1vbnRoIDw9IDEyLCAnbW9udGggbXVzdCBiZSBpbiAxLi4xMicKICAgIGRpbSA9IF9kYXlzX2luX21vbnRoKHllYXIsIG1vbnRoKQogICAgYXNzZXJ0IDEgPD0gZGF5IDw9IGRpbSwgKCdkYXkgbXVzdCBiZSBpbiAxLi4lZCcgJSBkaW0pCiAgICByZXR1cm4gKF9kYXlzX2JlZm9yZV95ZWFyKHllYXIpICsKICAgICAgICAgICAgX2RheXNfYmVmb3JlX21vbnRoKHllYXIsIG1vbnRoKSArCiAgICAgICAgICAgIGRheSkKCl9ESTQwMFkgPSBfZGF5c19iZWZvcmVfeWVhcig0MDEpICAgICMgbnVtYmVyIG9mIGRheXMgaW4gNDAwIHllYXJzCl9ESTEwMFkgPSBfZGF5c19iZWZvcmVfeWVhcigxMDEpICAgICMgICAgIiAgICAiICAgIiAgICIgMTAwICAgIgpfREk0WSAgID0gX2RheXNfYmVmb3JlX3llYXIoNSkgICAgICAjICAgICIgICAgIiAgICIgICAiICAgNCAgICIKCiMgQSA0LXllYXIgY3ljbGUgaGFzIGFuIGV4dHJhIGxlYXAgZGF5IG92ZXIgd2hhdCB3ZSdkIGdldCBmcm9tIHBhc3RpbmcKIyB0b2dldGhlciA0IHNpbmdsZSB5ZWFycy4KYXNzZXJ0IF9ESTRZID09IDQgKiAzNjUgKyAxCgojIFNpbWlsYXJseSwgYSA0MDAteWVhciBjeWNsZSBoYXMgYW4gZXh0cmEgbGVhcCBkYXkgb3ZlciB3aGF0IHdlJ2QgZ2V0IGZyb20KIyBwYXN0aW5nIHRvZ2V0aGVyIDQgMTAwLXllYXIgY3ljbGVzLgphc3NlcnQgX0RJNDAwWSA9PSA0ICogX0RJMTAwWSArIDEKCiMgT1RPSCwgYSAxMDAteWVhciBjeWNsZSBoYXMgb25lIGZld2VyIGxlYXAgZGF5IHRoYW4gd2UnZCBnZXQgZnJvbQojIHBhc3RpbmcgdG9nZXRoZXIgMjUgNC15ZWFyIGN5Y2xlcy4KYXNzZXJ0IF9ESTEwMFkgPT0gMjUgKiBfREk0WSAtIDEKCmRlZiBfb3JkMnltZChuKToKICAgICJvcmRpbmFsIC0+ICh5ZWFyLCBtb250aCwgZGF5KSwgY29uc2lkZXJpbmcgMDEtSmFuLTAwMDEgYXMgZGF5IDEuIgoKICAgICMgbiBpcyBhIDEtYmFzZWQgaW5kZXgsIHN0YXJ0aW5nIGF0IDEtSmFuLTEuICBUaGUgcGF0dGVybiBvZiBsZWFwIHllYXJzCiAgICAjIHJlcGVhdHMgZXhhY3RseSBldmVyeSA0MDAgeWVhcnMuICBUaGUgYmFzaWMgc3RyYXRlZ3kgaXMgdG8gZmluZCB0aGUKICAgICMgY2xvc2VzdCA0MDAteWVhciBib3VuZGFyeSBhdCBvciBiZWZvcmUgbiwgdGhlbiB3b3JrIHdpdGggdGhlIG9mZnNldAogICAgIyBmcm9tIHRoYXQgYm91bmRhcnkgdG8gbi4gIExpZmUgaXMgbXVjaCBjbGVhcmVyIGlmIHdlIHN1YnRyYWN0IDEgZnJvbQogICAgIyBuIGZpcnN0IC0tIHRoZW4gdGhlIHZhbHVlcyBvZiBuIGF0IDQwMC15ZWFyIGJvdW5kYXJpZXMgYXJlIGV4YWN0bHkKICAgICMgdGhvc2UgZGl2aXNpYmxlIGJ5IF9ESTQwMFk6CiAgICAjCiAgICAjICAgICBEICBNICAgWSAgICAgICAgICAgIG4gICAgICAgICAgICAgIG4tMQogICAgIyAgICAgLS0gLS0tIC0tLS0gICAgICAgIC0tLS0tLS0tLS0gICAgIC0tLS0tLS0tLS0tLS0tLS0KICAgICMgICAgIDMxIERlYyAtNDAwICAgICAgICAtX0RJNDAwWSAgICAgICAtX0RJNDAwWSAtMQogICAgIyAgICAgIDEgSmFuIC0zOTkgICAgICAgICAtX0RJNDAwWSArMSAgIC1fREk0MDBZICAgICAgNDAwLXllYXIgYm91bmRhcnkKICAgICMgICAgIC4uLgogICAgIyAgICAgMzAgRGVjICAwMDAgICAgICAgIC0xICAgICAgICAgICAgIC0yCiAgICAjICAgICAzMSBEZWMgIDAwMCAgICAgICAgIDAgICAgICAgICAgICAgLTEKICAgICMgICAgICAxIEphbiAgMDAxICAgICAgICAgMSAgICAgICAgICAgICAgMCAgICAgICAgICAgIDQwMC15ZWFyIGJvdW5kYXJ5CiAgICAjICAgICAgMiBKYW4gIDAwMSAgICAgICAgIDIgICAgICAgICAgICAgIDEKICAgICMgICAgICAzIEphbiAgMDAxICAgICAgICAgMyAgICAgICAgICAgICAgMgogICAgIyAgICAgLi4uCiAgICAjICAgICAzMSBEZWMgIDQwMCAgICAgICAgIF9ESTQwMFkgICAgICAgIF9ESTQwMFkgLTEKICAgICMgICAgICAxIEphbiAgNDAxICAgICAgICAgX0RJNDAwWSArMSAgICAgX0RJNDAwWSAgICAgIDQwMC15ZWFyIGJvdW5kYXJ5CiAgICBuIC09IDEKICAgIG40MDAsIG4gPSBkaXZtb2QobiwgX0RJNDAwWSkKICAgIHllYXIgPSBuNDAwICogNDAwICsgMSAgICMgLi4uLCAtMzk5LCAxLCA0MDEsIC4uLgoKICAgICMgTm93IG4gaXMgdGhlIChub24tbmVnYXRpdmUpIG9mZnNldCwgaW4gZGF5cywgZnJvbSBKYW51YXJ5IDEgb2YgeWVhciwgdG8KICAgICMgdGhlIGRlc2lyZWQgZGF0ZS4gIE5vdyBjb21wdXRlIGhvdyBtYW55IDEwMC15ZWFyIGN5Y2xlcyBwcmVjZWRlIG4uCiAgICAjIE5vdGUgdGhhdCBpdCdzIHBvc3NpYmxlIGZvciBuMTAwIHRvIGVxdWFsIDQhICBJbiB0aGF0IGNhc2UgNCBmdWxsCiAgICAjIDEwMC15ZWFyIGN5Y2xlcyBwcmVjZWRlIHRoZSBkZXNpcmVkIGRheSwgd2hpY2ggaW1wbGllcyB0aGUgZGVzaXJlZAogICAgIyBkYXkgaXMgRGVjZW1iZXIgMzEgYXQgdGhlIGVuZCBvZiBhIDQwMC15ZWFyIGN5Y2xlLgogICAgbjEwMCwgbiA9IGRpdm1vZChuLCBfREkxMDBZKQoKICAgICMgTm93IGNvbXB1dGUgaG93IG1hbnkgNC15ZWFyIGN5Y2xlcyBwcmVjZWRlIGl0LgogICAgbjQsIG4gPSBkaXZtb2QobiwgX0RJNFkpCgogICAgIyBBbmQgbm93IGhvdyBtYW55IHNpbmdsZSB5ZWFycy4gIEFnYWluIG4xIGNhbiBiZSA0LCBhbmQgYWdhaW4gbWVhbmluZwogICAgIyB0aGF0IHRoZSBkZXNpcmVkIGRheSBpcyBEZWNlbWJlciAzMSBhdCB0aGUgZW5kIG9mIHRoZSA0LXllYXIgY3ljbGUuCiAgICBuMSwgbiA9IGRpdm1vZChuLCAzNjUpCgogICAgeWVhciArPSBuMTAwICogMTAwICsgbjQgKiA0ICsgbjEKICAgIGlmIG4xID09IDQgb3IgbjEwMCA9PSA0OgogICAgICAgIGFzc2VydCBuID09IDAKICAgICAgICByZXR1cm4geWVhci0xLCAxMiwgMzEKCiAgICAjIE5vdyB0aGUgeWVhciBpcyBjb3JyZWN0LCBhbmQgbiBpcyB0aGUgb2Zmc2V0IGZyb20gSmFudWFyeSAxLiAgV2UgZmluZAogICAgIyB0aGUgbW9udGggdmlhIGFuIGVzdGltYXRlIHRoYXQncyBlaXRoZXIgZXhhY3Qgb3Igb25lIHRvbyBsYXJnZS4KICAgIGxlYXB5ZWFyID0gbjEgPT0gMyBhbmQgKG40ICE9IDI0IG9yIG4xMDAgPT0gMykKICAgIGFzc2VydCBsZWFweWVhciA9PSBfaXNfbGVhcCh5ZWFyKQogICAgbW9udGggPSAobiArIDUwKSA+PiA1CiAgICBwcmVjZWRpbmcgPSBfREFZU19CRUZPUkVfTU9OVEhbbW9udGhdICsgKG1vbnRoID4gMiBhbmQgbGVhcHllYXIpCiAgICBpZiBwcmVjZWRpbmcgPiBuOiAgIyBlc3RpbWF0ZSBpcyB0b28gbGFyZ2UKICAgICAgICBtb250aCAtPSAxCiAgICAgICAgcHJlY2VkaW5nIC09IF9EQVlTX0lOX01PTlRIW21vbnRoXSArIChtb250aCA9PSAyIGFuZCBsZWFweWVhcikKICAgIG4gLT0gcHJlY2VkaW5nCiAgICBhc3NlcnQgMCA8PSBuIDwgX2RheXNfaW5fbW9udGgoeWVhciwgbW9udGgpCgogICAgIyBOb3cgdGhlIHllYXIgYW5kIG1vbnRoIGFyZSBjb3JyZWN0LCBhbmQgbiBpcyB0aGUgb2Zmc2V0IGZyb20gdGhlCiAgICAjIHN0YXJ0IG9mIHRoYXQgbW9udGg6ICB3ZSdyZSBkb25lIQogICAgcmV0dXJuIHllYXIsIG1vbnRoLCBuKzEKCiMgTW9udGggYW5kIGRheSBuYW1lcy4gIEZvciBsb2NhbGl6ZWQgdmVyc2lvbnMsIHNlZSB0aGUgY2FsZW5kYXIgbW9kdWxlLgpfTU9OVEhOQU1FUyA9IFtOb25lLCAiSmFuIiwgIkZlYiIsICJNYXIiLCAiQXByIiwgIk1heSIsICJKdW4iLAogICAgICAgICAgICAgICAgICAgICAiSnVsIiwgIkF1ZyIsICJTZXAiLCAiT2N0IiwgIk5vdiIsICJEZWMiXQpfREFZTkFNRVMgPSBbTm9uZSwgIk1vbiIsICJUdWUiLCAiV2VkIiwgIlRodSIsICJGcmkiLCAiU2F0IiwgIlN1biJdCgoKZGVmIF9idWlsZF9zdHJ1Y3RfdGltZSh5LCBtLCBkLCBoaCwgbW0sIHNzLCBkc3RmbGFnKToKICAgIHdkYXkgPSAoX3ltZDJvcmQoeSwgbSwgZCkgKyA2KSAlIDcKICAgIGRudW0gPSBfZGF5c19iZWZvcmVfbW9udGgoeSwgbSkgKyBkCiAgICByZXR1cm4gX3RpbWUuc3RydWN0X3RpbWUoKHksIG0sIGQsIGhoLCBtbSwgc3MsIHdkYXksIGRudW0sIGRzdGZsYWcpKQoKZGVmIF9mb3JtYXRfdGltZShoaCwgbW0sIHNzLCB1cyk6CiAgICAjIFNraXAgdHJhaWxpbmcgbWljcm9zZWNvbmRzIHdoZW4gdXM9PTAuCiAgICByZXN1bHQgPSAiJTAyZDolMDJkOiUwMmQiICUgKGhoLCBtbSwgc3MpCiAgICBpZiB1czoKICAgICAgICByZXN1bHQgKz0gIi4lMDZkIiAlIHVzCiAgICByZXR1cm4gcmVzdWx0CgojIENvcnJlY3RseSBzdWJzdGl0dXRlIGZvciAleiBhbmQgJVogZXNjYXBlcyBpbiBzdHJmdGltZSBmb3JtYXRzLgpkZWYgX3dyYXBfc3RyZnRpbWUob2JqZWN0LCBmb3JtYXQsIHRpbWV0dXBsZSk6CiAgICB5ZWFyID0gdGltZXR1cGxlWzBdCiAgICBpZiB5ZWFyIDwgMTAwMDoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJ5ZWFyPSVkIGlzIGJlZm9yZSAxMDAwOyB0aGUgZGF0ZXRpbWUgc3RyZnRpbWUoKSAiCiAgICAgICAgICAgICAgICAgICAgICAgICAibWV0aG9kcyByZXF1aXJlIHllYXIgPj0gMTAwMCIgJSB5ZWFyKQogICAgIyBEb24ndCBjYWxsIHV0Y29mZnNldCgpIG9yIHR6bmFtZSgpIHVubGVzcyBhY3R1YWxseSBuZWVkZWQuCiAgICBmcmVwbGFjZSA9IE5vbmUgIyB0aGUgc3RyaW5nIHRvIHVzZSBmb3IgJWYKICAgIHpyZXBsYWNlID0gTm9uZSAjIHRoZSBzdHJpbmcgdG8gdXNlIGZvciAlegogICAgWnJlcGxhY2UgPSBOb25lICMgdGhlIHN0cmluZyB0byB1c2UgZm9yICVaCgogICAgIyBTY2FuIGZvcm1hdCBmb3IgJXogYW5kICVaIGVzY2FwZXMsIHJlcGxhY2luZyBhcyBuZWVkZWQuCiAgICBuZXdmb3JtYXQgPSBbXQogICAgcHVzaCA9IG5ld2Zvcm1hdC5hcHBlbmQKICAgIGksIG4gPSAwLCBsZW4oZm9ybWF0KQogICAgd2hpbGUgaSA8IG46CiAgICAgICAgY2ggPSBmb3JtYXRbaV0KICAgICAgICBpICs9IDEKICAgICAgICBpZiBjaCA9PSAnJSc6CiAgICAgICAgICAgIGlmIGkgPCBuOgogICAgICAgICAgICAgICAgY2ggPSBmb3JtYXRbaV0KICAgICAgICAgICAgICAgIGkgKz0gMQogICAgICAgICAgICAgICAgaWYgY2ggPT0gJ2YnOgogICAgICAgICAgICAgICAgICAgIGlmIGZyZXBsYWNlIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIGZyZXBsYWNlID0gJyUwNmQnICUgZ2V0YXR0cihvYmplY3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbWljcm9zZWNvbmQnLCAwKQogICAgICAgICAgICAgICAgICAgIG5ld2Zvcm1hdC5hcHBlbmQoZnJlcGxhY2UpCiAgICAgICAgICAgICAgICBlbGlmIGNoID09ICd6JzoKICAgICAgICAgICAgICAgICAgICBpZiB6cmVwbGFjZSBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICB6cmVwbGFjZSA9ICIiCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGhhc2F0dHIob2JqZWN0LCAidXRjb2Zmc2V0Iik6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBvYmplY3QudXRjb2Zmc2V0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9mZnNldCBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWduID0gJysnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgb2Zmc2V0LmRheXMgPCAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSAtb2Zmc2V0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZ24gPSAnLScKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLCBtID0gZGl2bW9kKG9mZnNldCwgdGltZWRlbHRhKGhvdXJzPTEpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydCBub3QgbSAlIHRpbWVkZWx0YShtaW51dGVzPTEpLCAid2hvbGUgbWludXRlIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0gLy89IHRpbWVkZWx0YShtaW51dGVzPTEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgenJlcGxhY2UgPSAnJWMlMDJkJTAyZCcgJSAoc2lnbiwgaCwgbSkKICAgICAgICAgICAgICAgICAgICBhc3NlcnQgJyUnIG5vdCBpbiB6cmVwbGFjZQogICAgICAgICAgICAgICAgICAgIG5ld2Zvcm1hdC5hcHBlbmQoenJlcGxhY2UpCiAgICAgICAgICAgICAgICBlbGlmIGNoID09ICdaJzoKICAgICAgICAgICAgICAgICAgICBpZiBacmVwbGFjZSBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICBacmVwbGFjZSA9ICIiCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGhhc2F0dHIob2JqZWN0LCAidHpuYW1lIik6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzID0gb2JqZWN0LnR6bmFtZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBzIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgc3RyZnRpbWUgaXMgZ29pbmcgdG8gaGF2ZSBhdCB0aGlzOiBlc2NhcGUgJQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFpyZXBsYWNlID0gcy5yZXBsYWNlKCclJywgJyUlJykKICAgICAgICAgICAgICAgICAgICBuZXdmb3JtYXQuYXBwZW5kKFpyZXBsYWNlKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBwdXNoKCclJykKICAgICAgICAgICAgICAgICAgICBwdXNoKGNoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHVzaCgnJScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHVzaChjaCkKICAgIG5ld2Zvcm1hdCA9ICIiLmpvaW4obmV3Zm9ybWF0KQogICAgcmV0dXJuIF90aW1lLnN0cmZ0aW1lKG5ld2Zvcm1hdCwgdGltZXR1cGxlKQoKZGVmIF9jYWxsX3R6aW5mb19tZXRob2QodHppbmZvLCBtZXRobmFtZSwgdHppbmZvYXJnKToKICAgIGlmIHR6aW5mbyBpcyBOb25lOgogICAgICAgIHJldHVybiBOb25lCiAgICByZXR1cm4gZ2V0YXR0cih0emluZm8sIG1ldGhuYW1lKSh0emluZm9hcmcpCgojIEp1c3QgcmFpc2UgVHlwZUVycm9yIGlmIHRoZSBhcmcgaXNuJ3QgTm9uZSBvciBhIHN0cmluZy4KZGVmIF9jaGVja190em5hbWUobmFtZSk6CiAgICBpZiBuYW1lIGlzIG5vdCBOb25lIGFuZCBub3QgaXNpbnN0YW5jZShuYW1lLCBzdHIpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigidHppbmZvLnR6bmFtZSgpIG11c3QgcmV0dXJuIE5vbmUgb3Igc3RyaW5nLCAiCiAgICAgICAgICAgICAgICAgICAgICAgICJub3QgJyVzJyIgJSB0eXBlKG5hbWUpKQoKIyBuYW1lIGlzIHRoZSBvZmZzZXQtcHJvZHVjaW5nIG1ldGhvZCwgInV0Y29mZnNldCIgb3IgImRzdCIuCiMgb2Zmc2V0IGlzIHdoYXQgaXQgcmV0dXJuZWQuCiMgSWYgb2Zmc2V0IGlzbid0IE5vbmUgb3IgdGltZWRlbHRhLCByYWlzZXMgVHlwZUVycm9yLgojIElmIG9mZnNldCBpcyBOb25lLCByZXR1cm5zIE5vbmUuCiMgRWxzZSBvZmZzZXQgaXMgY2hlY2tlZCBmb3IgYmVpbmcgaW4gcmFuZ2UsIGFuZCBhIHdob2xlICMgb2YgbWludXRlcy4KIyBJZiBpdCBpcywgaXRzIGludGVnZXIgdmFsdWUgaXMgcmV0dXJuZWQuICBFbHNlIFZhbHVlRXJyb3IgaXMgcmFpc2VkLgpkZWYgX2NoZWNrX3V0Y19vZmZzZXQobmFtZSwgb2Zmc2V0KToKICAgIGFzc2VydCBuYW1lIGluICgidXRjb2Zmc2V0IiwgImRzdCIpCiAgICBpZiBvZmZzZXQgaXMgTm9uZToKICAgICAgICByZXR1cm4KICAgIGlmIG5vdCBpc2luc3RhbmNlKG9mZnNldCwgdGltZWRlbHRhKToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoInR6aW5mby4lcygpIG11c3QgcmV0dXJuIE5vbmUgIgogICAgICAgICAgICAgICAgICAgICAgICAib3IgdGltZWRlbHRhLCBub3QgJyVzJyIgJSAobmFtZSwgdHlwZShvZmZzZXQpKSkKICAgIGlmIG9mZnNldCAlIHRpbWVkZWx0YShtaW51dGVzPTEpIG9yIG9mZnNldC5taWNyb3NlY29uZHM6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigidHppbmZvLiVzKCkgbXVzdCByZXR1cm4gYSB3aG9sZSBudW1iZXIgIgogICAgICAgICAgICAgICAgICAgICAgICAgIm9mIG1pbnV0ZXMsIGdvdCAlcyIgJSAobmFtZSwgb2Zmc2V0KSkKICAgIGlmIG5vdCAtdGltZWRlbHRhKDEpIDwgb2Zmc2V0IDwgdGltZWRlbHRhKDEpOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIiVzKCk9JXMsIG11c3QgYmUgbXVzdCBiZSBzdHJpY3RseSBiZXR3ZWVuIgogICAgICAgICAgICAgICAgICAgICAgICAgIiAtdGltZWRlbHRhKGhvdXJzPTI0KSBhbmQgdGltZWRlbHRhKGhvdXJzPTI0KSIKICAgICAgICAgICAgICAgICAgICAgICAgICUgKG5hbWUsIG9mZnNldCkpCgpkZWYgX2NoZWNrX2RhdGVfZmllbGRzKHllYXIsIG1vbnRoLCBkYXkpOgogICAgaWYgbm90IGlzaW5zdGFuY2UoeWVhciwgaW50KToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ2ludCBleHBlY3RlZCcpCiAgICBpZiBub3QgTUlOWUVBUiA8PSB5ZWFyIDw9IE1BWFlFQVI6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigneWVhciBtdXN0IGJlIGluICVkLi4lZCcgJSAoTUlOWUVBUiwgTUFYWUVBUiksIHllYXIpCiAgICBpZiBub3QgMSA8PSBtb250aCA8PSAxMjoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdtb250aCBtdXN0IGJlIGluIDEuLjEyJywgbW9udGgpCiAgICBkaW0gPSBfZGF5c19pbl9tb250aCh5ZWFyLCBtb250aCkKICAgIGlmIG5vdCAxIDw9IGRheSA8PSBkaW06CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignZGF5IG11c3QgYmUgaW4gMS4uJWQnICUgZGltLCBkYXkpCgpkZWYgX2NoZWNrX3RpbWVfZmllbGRzKGhvdXIsIG1pbnV0ZSwgc2Vjb25kLCBtaWNyb3NlY29uZCk6CiAgICBpZiBub3QgaXNpbnN0YW5jZShob3VyLCBpbnQpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcignaW50IGV4cGVjdGVkJykKICAgIGlmIG5vdCAwIDw9IGhvdXIgPD0gMjM6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignaG91ciBtdXN0IGJlIGluIDAuLjIzJywgaG91cikKICAgIGlmIG5vdCAwIDw9IG1pbnV0ZSA8PSA1OToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdtaW51dGUgbXVzdCBiZSBpbiAwLi41OScsIG1pbnV0ZSkKICAgIGlmIG5vdCAwIDw9IHNlY29uZCA8PSA1OToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdzZWNvbmQgbXVzdCBiZSBpbiAwLi41OScsIHNlY29uZCkKICAgIGlmIG5vdCAwIDw9IG1pY3Jvc2Vjb25kIDw9IDk5OTk5OToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdtaWNyb3NlY29uZCBtdXN0IGJlIGluIDAuLjk5OTk5OScsIG1pY3Jvc2Vjb25kKQoKZGVmIF9jaGVja190emluZm9fYXJnKHR6KToKICAgIGlmIHR6IGlzIG5vdCBOb25lIGFuZCBub3QgaXNpbnN0YW5jZSh0eiwgdHppbmZvKToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoInR6aW5mbyBhcmd1bWVudCBtdXN0IGJlIE5vbmUgb3Igb2YgYSB0emluZm8gc3ViY2xhc3MiKQoKZGVmIF9jbXBlcnJvcih4LCB5KToKICAgIHJhaXNlIFR5cGVFcnJvcigiY2FuJ3QgY29tcGFyZSAnJXMnIHRvICclcyciICUgKAogICAgICAgICAgICAgICAgICAgIHR5cGUoeCkuX19uYW1lX18sIHR5cGUoeSkuX19uYW1lX18pKQoKY2xhc3MgdGltZWRlbHRhOgogICAgIiIiUmVwcmVzZW50IHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdHdvIGRhdGV0aW1lIG9iamVjdHMuCgogICAgU3VwcG9ydGVkIG9wZXJhdG9yczoKCiAgICAtIGFkZCwgc3VidHJhY3QgdGltZWRlbHRhCiAgICAtIHVuYXJ5IHBsdXMsIG1pbnVzLCBhYnMKICAgIC0gY29tcGFyZSB0byB0aW1lZGVsdGEKICAgIC0gbXVsdGlwbHksIGRpdmlkZSBieSBpbnQvbG9uZwoKICAgIEluIGFkZGl0aW9uLCBkYXRldGltZSBzdXBwb3J0cyBzdWJ0cmFjdGlvbiBvZiB0d28gZGF0ZXRpbWUgb2JqZWN0cwogICAgcmV0dXJuaW5nIGEgdGltZWRlbHRhLCBhbmQgYWRkaXRpb24gb3Igc3VidHJhY3Rpb24gb2YgYSBkYXRldGltZQogICAgYW5kIGEgdGltZWRlbHRhIGdpdmluZyBhIGRhdGV0aW1lLgoKICAgIFJlcHJlc2VudGF0aW9uOiAoZGF5cywgc2Vjb25kcywgbWljcm9zZWNvbmRzKS4gIFdoeT8gIEJlY2F1c2UgSQogICAgZmVsdCBsaWtlIGl0LgogICAgIiIiCiAgICBfX3Nsb3RzX18gPSAnX2RheXMnLCAnX3NlY29uZHMnLCAnX21pY3Jvc2Vjb25kcycKCiAgICBkZWYgX19uZXdfXyhjbHMsIGRheXM9MCwgc2Vjb25kcz0wLCBtaWNyb3NlY29uZHM9MCwKICAgICAgICAgICAgICAgIG1pbGxpc2Vjb25kcz0wLCBtaW51dGVzPTAsIGhvdXJzPTAsIHdlZWtzPTApOgogICAgICAgICMgRG9pbmcgdGhpcyBlZmZpY2llbnRseSBhbmQgYWNjdXJhdGVseSBpbiBDIGlzIGdvaW5nIHRvIGJlIGRpZmZpY3VsdAogICAgICAgICMgYW5kIGVycm9yLXByb25lLCBkdWUgdG8gdWJpcXVpdG91cyBvdmVyZmxvdyBwb3NzaWJpbGl0aWVzLCBhbmQgdGhhdAogICAgICAgICMgQyBkb3VibGUgZG9lc24ndCBoYXZlIGVub3VnaCBiaXRzIG9mIHByZWNpc2lvbiB0byByZXByZXNlbnQKICAgICAgICAjIG1pY3Jvc2Vjb25kcyBvdmVyIDEwSyB5ZWFycyBmYWl0aGZ1bGx5LiAgVGhlIGNvZGUgaGVyZSB0cmllcyB0byBtYWtlCiAgICAgICAgIyBleHBsaWNpdCB3aGVyZSBnby1mYXN0IGFzc3VtcHRpb25zIGNhbiBiZSByZWxpZWQgb24sIGluIG9yZGVyIHRvCiAgICAgICAgIyBndWlkZSB0aGUgQyBpbXBsZW1lbnRhdGlvbjsgaXQncyB3YXkgbW9yZSBjb252b2x1dGVkIHRoYW4gc3BlZWQtCiAgICAgICAgIyBpZ25vcmluZyBhdXRvLW92ZXJmbG93LXRvLWxvbmcgaWRpb21hdGljIFB5dGhvbiBjb3VsZCBiZS4KCiAgICAgICAgIyBYWFggQ2hlY2sgdGhhdCBhbGwgaW5wdXRzIGFyZSBpbnRzIG9yIGZsb2F0cy4KCiAgICAgICAgIyBGaW5hbCB2YWx1ZXMsIGFsbCBpbnRlZ2VyLgogICAgICAgICMgcyBhbmQgdXMgZml0IGluIDMyLWJpdCBzaWduZWQgaW50czsgZCBpc24ndCBib3VuZGVkLgogICAgICAgIGQgPSBzID0gdXMgPSAwCgogICAgICAgICMgTm9ybWFsaXplIGV2ZXJ5dGhpbmcgdG8gZGF5cywgc2Vjb25kcywgbWljcm9zZWNvbmRzLgogICAgICAgIGRheXMgKz0gd2Vla3MqNwogICAgICAgIHNlY29uZHMgKz0gbWludXRlcyo2MCArIGhvdXJzKjM2MDAKICAgICAgICBtaWNyb3NlY29uZHMgKz0gbWlsbGlzZWNvbmRzKjEwMDAKCiAgICAgICAgIyBHZXQgcmlkIG9mIGFsbCBmcmFjdGlvbnMsIGFuZCBub3JtYWxpemUgcyBhbmQgdXMuCiAgICAgICAgIyBUYWtlIGEgZGVlcCBicmVhdGggPHdpbms+LgogICAgICAgIGlmIGlzaW5zdGFuY2UoZGF5cywgZmxvYXQpOgogICAgICAgICAgICBkYXlmcmFjLCBkYXlzID0gX21hdGgubW9kZihkYXlzKQogICAgICAgICAgICBkYXlzZWNvbmRzZnJhYywgZGF5c2Vjb25kc3dob2xlID0gX21hdGgubW9kZihkYXlmcmFjICogKDI0LiozNjAwLikpCiAgICAgICAgICAgIGFzc2VydCBkYXlzZWNvbmRzd2hvbGUgPT0gaW50KGRheXNlY29uZHN3aG9sZSkgICMgY2FuJ3Qgb3ZlcmZsb3cKICAgICAgICAgICAgcyA9IGludChkYXlzZWNvbmRzd2hvbGUpCiAgICAgICAgICAgIGFzc2VydCBkYXlzID09IGludChkYXlzKQogICAgICAgICAgICBkID0gaW50KGRheXMpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZGF5c2Vjb25kc2ZyYWMgPSAwLjAKICAgICAgICAgICAgZCA9IGRheXMKICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShkYXlzZWNvbmRzZnJhYywgZmxvYXQpCiAgICAgICAgYXNzZXJ0IGFicyhkYXlzZWNvbmRzZnJhYykgPD0gMS4wCiAgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2UoZCwgaW50KQogICAgICAgIGFzc2VydCBhYnMocykgPD0gMjQgKiAzNjAwCiAgICAgICAgIyBkYXlzIGlzbid0IHJlZmVyZW5jZWQgYWdhaW4gYmVmb3JlIHJlZGVmaW5pdGlvbgoKICAgICAgICBpZiBpc2luc3RhbmNlKHNlY29uZHMsIGZsb2F0KToKICAgICAgICAgICAgc2Vjb25kc2ZyYWMsIHNlY29uZHMgPSBfbWF0aC5tb2RmKHNlY29uZHMpCiAgICAgICAgICAgIGFzc2VydCBzZWNvbmRzID09IGludChzZWNvbmRzKQogICAgICAgICAgICBzZWNvbmRzID0gaW50KHNlY29uZHMpCiAgICAgICAgICAgIHNlY29uZHNmcmFjICs9IGRheXNlY29uZHNmcmFjCiAgICAgICAgICAgIGFzc2VydCBhYnMoc2Vjb25kc2ZyYWMpIDw9IDIuMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlY29uZHNmcmFjID0gZGF5c2Vjb25kc2ZyYWMKICAgICAgICAjIGRheXNlY29uZHNmcmFjIGlzbid0IHJlZmVyZW5jZWQgYWdhaW4KICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShzZWNvbmRzZnJhYywgZmxvYXQpCiAgICAgICAgYXNzZXJ0IGFicyhzZWNvbmRzZnJhYykgPD0gMi4wCgogICAgICAgIGFzc2VydCBpc2luc3RhbmNlKHNlY29uZHMsIGludCkKICAgICAgICBkYXlzLCBzZWNvbmRzID0gZGl2bW9kKHNlY29uZHMsIDI0KjM2MDApCiAgICAgICAgZCArPSBkYXlzCiAgICAgICAgcyArPSBpbnQoc2Vjb25kcykgICAgIyBjYW4ndCBvdmVyZmxvdwogICAgICAgIGFzc2VydCBpc2luc3RhbmNlKHMsIGludCkKICAgICAgICBhc3NlcnQgYWJzKHMpIDw9IDIgKiAyNCAqIDM2MDAKICAgICAgICAjIHNlY29uZHMgaXNuJ3QgcmVmZXJlbmNlZCBhZ2FpbiBiZWZvcmUgcmVkZWZpbml0aW9uCgogICAgICAgIHVzZG91YmxlID0gc2Vjb25kc2ZyYWMgKiAxZTYKICAgICAgICBhc3NlcnQgYWJzKHVzZG91YmxlKSA8IDIuMWU2ICAgICMgZXhhY3QgdmFsdWUgbm90IGNyaXRpY2FsCiAgICAgICAgIyBzZWNvbmRzZnJhYyBpc24ndCByZWZlcmVuY2VkIGFnYWluCiAgICAgICAgCiAgICAgICAgaWYgaXNpbnN0YW5jZShtaWNyb3NlY29uZHMsIGZsb2F0KToKICAgICAgICAgICAgbWljcm9zZWNvbmRzICs9IHVzZG91YmxlCiAgICAgICAgICAgIG1pY3Jvc2Vjb25kcyA9IHJvdW5kKG1pY3Jvc2Vjb25kcywgMCkKICAgICAgICAgICAgc2Vjb25kcywgbWljcm9zZWNvbmRzID0gZGl2bW9kKG1pY3Jvc2Vjb25kcywgMWU2KQogICAgICAgICAgICBhc3NlcnQgbWljcm9zZWNvbmRzID09IGludChtaWNyb3NlY29uZHMpCiAgICAgICAgICAgIGFzc2VydCBzZWNvbmRzID09IGludChzZWNvbmRzKQogICAgICAgICAgICBkYXlzLCBzZWNvbmRzID0gZGl2bW9kKHNlY29uZHMsIDI0LiozNjAwLikKICAgICAgICAgICAgYXNzZXJ0IGRheXMgPT0gaW50KGRheXMpCiAgICAgICAgICAgIGFzc2VydCBzZWNvbmRzID09IGludChzZWNvbmRzKQogICAgICAgICAgICBkICs9IGludChkYXlzKQogICAgICAgICAgICBzICs9IGludChzZWNvbmRzKSAgICMgY2FuJ3Qgb3ZlcmZsb3cKICAgICAgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2UocywgaW50KQogICAgICAgICAgICBhc3NlcnQgYWJzKHMpIDw9IDMgKiAyNCAqIDM2MDAKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWNvbmRzLCBtaWNyb3NlY29uZHMgPSBkaXZtb2QobWljcm9zZWNvbmRzLCAxMDAwMDAwKQogICAgICAgICAgICBkYXlzLCBzZWNvbmRzID0gZGl2bW9kKHNlY29uZHMsIDI0KjM2MDApCiAgICAgICAgICAgIGQgKz0gZGF5cwogICAgICAgICAgICBzICs9IGludChzZWNvbmRzKSAgICAjIGNhbid0IG92ZXJmbG93CiAgICAgICAgICAgIGFzc2VydCBpc2luc3RhbmNlKHMsIGludCkKICAgICAgICAgICAgYXNzZXJ0IGFicyhzKSA8PSAzICogMjQgKiAzNjAwCiAgICAgICAgICAgIG1pY3Jvc2Vjb25kcyA9IGZsb2F0KG1pY3Jvc2Vjb25kcykKICAgICAgICAgICAgbWljcm9zZWNvbmRzICs9IHVzZG91YmxlCiAgICAgICAgICAgIG1pY3Jvc2Vjb25kcyA9IHJvdW5kKG1pY3Jvc2Vjb25kcywgMCkKICAgICAgICBhc3NlcnQgYWJzKHMpIDw9IDMgKiAyNCAqIDM2MDAKICAgICAgICBhc3NlcnQgYWJzKG1pY3Jvc2Vjb25kcykgPCAzLjFlNgoKICAgICAgICAjIEp1c3QgYSBsaXR0bGUgYml0IG9mIGNhcnJ5aW5nIHBvc3NpYmxlIGZvciBtaWNyb3NlY29uZHMgYW5kIHNlY29uZHMuCiAgICAgICAgI2lzIHRoZSBiZWxvdyB0d28gc3RhdGVtZW50cyBldmVuIHBvc3NpYmxlPwogICAgICAgICNhc3NlcnQgaXNpbnN0YW5jZShtaWNyb3NlY29uZHMsIGZsb2F0KQogICAgICAgICNhc3NlcnQgaW50KG1pY3Jvc2Vjb25kcykgPT0gbWljcm9zZWNvbmRzCiAgICAgICAgdXMgPSBpbnQobWljcm9zZWNvbmRzKQogICAgICAgIHNlY29uZHMsIHVzID0gZGl2bW9kKHVzLCAxMDAwMDAwKQogICAgICAgIHMgKz0gc2Vjb25kcyAgICAjIGNhbnQndCBvdmVyZmxvdwogICAgICAgIGFzc2VydCBpc2luc3RhbmNlKHMsIGludCkKICAgICAgICBkYXlzLCBzID0gZGl2bW9kKHMsIDI0KjM2MDApCiAgICAgICAgZCArPSBkYXlzCgogICAgICAgIGFzc2VydCBpc2luc3RhbmNlKGQsIGludCkKICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShzLCBpbnQpIGFuZCAwIDw9IHMgPCAyNCozNjAwCiAgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2UodXMsIGludCkgYW5kIDAgPD0gdXMgPCAxMDAwMDAwCgogICAgICAgIHNlbGYgPSBvYmplY3QuX19uZXdfXyhjbHMpCgogICAgICAgIHNlbGYuX2RheXMgPSBkCiAgICAgICAgc2VsZi5fc2Vjb25kcyA9IHMKICAgICAgICBzZWxmLl9taWNyb3NlY29uZHMgPSB1cwoKICAgICAgICBpZiBhYnMoZCkgPiA5OTk5OTk5OTk6CiAgICAgICAgICAgIHJhaXNlIE92ZXJmbG93RXJyb3IoInRpbWVkZWx0YSAjIG9mIGRheXMgaXMgdG9vIGxhcmdlOiAlZCIgJSBkKQoKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICBpZiBzZWxmLl9taWNyb3NlY29uZHM6CiAgICAgICAgICAgIHJldHVybiAiJXMoJWQsICVkLCAlZCkiICUgKCdkYXRldGltZS4nICsgc2VsZi5fX2NsYXNzX18uX19uYW1lX18sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2RheXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlY29uZHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX21pY3Jvc2Vjb25kcykKICAgICAgICBpZiBzZWxmLl9zZWNvbmRzOgogICAgICAgICAgICByZXR1cm4gIiVzKCVkLCAlZCkiICUgKCdkYXRldGltZS4nICsgc2VsZi5fX2NsYXNzX18uX19uYW1lX18sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fZGF5cywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZWNvbmRzKQogICAgICAgIHJldHVybiAiJXMoJWQpIiAlICgnZGF0ZXRpbWUuJyArIHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLCBzZWxmLl9kYXlzKQoKICAgIGRlZiBfX3N0cl9fKHNlbGYpOgogICAgICAgIG1tLCBzcyA9IGRpdm1vZChzZWxmLl9zZWNvbmRzLCA2MCkKICAgICAgICBoaCwgbW0gPSBkaXZtb2QobW0sIDYwKQogICAgICAgIHMgPSAiJWQ6JTAyZDolMDJkIiAlIChoaCwgbW0sIHNzKQogICAgICAgIGlmIHNlbGYuX2RheXM6CiAgICAgICAgICAgIGRlZiBwbHVyYWwobik6CiAgICAgICAgICAgICAgICByZXR1cm4gbiwgYWJzKG4pICE9IDEgYW5kICJzIiBvciAiIgogICAgICAgICAgICBzID0gKCIlZCBkYXklcywgIiAlIHBsdXJhbChzZWxmLl9kYXlzKSkgKyBzCiAgICAgICAgaWYgc2VsZi5fbWljcm9zZWNvbmRzOgogICAgICAgICAgICBzID0gcyArICIuJTA2ZCIgJSBzZWxmLl9taWNyb3NlY29uZHMKICAgICAgICByZXR1cm4gcwoKICAgIGRlZiB0b3RhbF9zZWNvbmRzKHNlbGYpOgogICAgICAgICIiIlRvdGFsIHNlY29uZHMgaW4gdGhlIGR1cmF0aW9uLiIiIgogICAgICAgIHJldHVybiAoKHNlbGYuZGF5cyAqIDg2NDAwICsgc2VsZi5zZWNvbmRzKSoxMCoqNiArCiAgICAgICAgICAgICAgICBzZWxmLm1pY3Jvc2Vjb25kcykgLyAxMCoqNgoKICAgICMgUmVhZC1vbmx5IGZpZWxkIGFjY2Vzc29ycwogICAgQHByb3BlcnR5CiAgICBkZWYgZGF5cyhzZWxmKToKICAgICAgICAiIiJkYXlzIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX2RheXMKCiAgICBAcHJvcGVydHkKICAgIGRlZiBzZWNvbmRzKHNlbGYpOgogICAgICAgICIiInNlY29uZHMiIiIKICAgICAgICByZXR1cm4gc2VsZi5fc2Vjb25kcwoKICAgIEBwcm9wZXJ0eQogICAgZGVmIG1pY3Jvc2Vjb25kcyhzZWxmKToKICAgICAgICAiIiJtaWNyb3NlY29uZHMiIiIKICAgICAgICByZXR1cm4gc2VsZi5fbWljcm9zZWNvbmRzCgogICAgZGVmIF9fYWRkX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHRpbWVkZWx0YSk6CiAgICAgICAgICAgICMgZm9yIENQeXRob24gY29tcGF0aWJpbGl0eSwgd2UgY2Fubm90IHVzZQogICAgICAgICAgICAjIG91ciBfX2NsYXNzX18gaGVyZSwgYnV0IG5lZWQgYSByZWFsIHRpbWVkZWx0YQogICAgICAgICAgICByZXR1cm4gdGltZWRlbHRhKHNlbGYuX2RheXMgKyBvdGhlci5fZGF5cywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZWNvbmRzICsgb3RoZXIuX3NlY29uZHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fbWljcm9zZWNvbmRzICsgb3RoZXIuX21pY3Jvc2Vjb25kcykKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICBfX3JhZGRfXyA9IF9fYWRkX18KCiAgICBkZWYgX19zdWJfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgdGltZWRlbHRhKToKICAgICAgICAgICAgIyBmb3IgQ1B5dGhvbiBjb21wYXRpYmlsaXR5LCB3ZSBjYW5ub3QgdXNlCiAgICAgICAgICAgICMgb3VyIF9fY2xhc3NfXyBoZXJlLCBidXQgbmVlZCBhIHJlYWwgdGltZWRlbHRhCiAgICAgICAgICAgIHJldHVybiB0aW1lZGVsdGEoc2VsZi5fZGF5cyAtIG90aGVyLl9kYXlzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlY29uZHMgLSBvdGhlci5fc2Vjb25kcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9taWNyb3NlY29uZHMgLSBvdGhlci5fbWljcm9zZWNvbmRzKQogICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgIGRlZiBfX3JzdWJfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgdGltZWRlbHRhKToKICAgICAgICAgICAgcmV0dXJuIC1zZWxmICsgb3RoZXIKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICBkZWYgX19uZWdfXyhzZWxmKToKICAgICAgICAjIGZvciBDUHl0aG9uIGNvbXBhdGliaWxpdHksIHdlIGNhbm5vdCB1c2UKICAgICAgICAjIG91ciBfX2NsYXNzX18gaGVyZSwgYnV0IG5lZWQgYSByZWFsIHRpbWVkZWx0YQogICAgICAgIHJldHVybiB0aW1lZGVsdGEoLXNlbGYuX2RheXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAtc2VsZi5fc2Vjb25kcywKICAgICAgICAgICAgICAgICAgICAgICAgIC1zZWxmLl9taWNyb3NlY29uZHMpCgogICAgZGVmIF9fcG9zX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19hYnNfXyhzZWxmKToKICAgICAgICBpZiBzZWxmLl9kYXlzIDwgMDoKICAgICAgICAgICAgcmV0dXJuIC1zZWxmCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19tdWxfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgaW50KToKICAgICAgICAgICAgIyBmb3IgQ1B5dGhvbiBjb21wYXRpYmlsaXR5LCB3ZSBjYW5ub3QgdXNlCiAgICAgICAgICAgICMgb3VyIF9fY2xhc3NfXyBoZXJlLCBidXQgbmVlZCBhIHJlYWwgdGltZWRlbHRhCiAgICAgICAgICAgIHJldHVybiB0aW1lZGVsdGEoc2VsZi5fZGF5cyAqIG90aGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlY29uZHMgKiBvdGhlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9taWNyb3NlY29uZHMgKiBvdGhlcikKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBmbG9hdCk6CiAgICAgICAgICAgIGEsIGIgPSBvdGhlci5hc19pbnRlZ2VyX3JhdGlvKCkKICAgICAgICAgICAgcmV0dXJuIHNlbGYgKiBhIC8gYgogICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgIF9fcm11bF9fID0gX19tdWxfXwoKICAgIGRlZiBfdG9fbWljcm9zZWNvbmRzKHNlbGYpOgogICAgICAgIHJldHVybiAoKHNlbGYuX2RheXMgKiAoMjQqMzYwMCkgKyBzZWxmLl9zZWNvbmRzKSAqIDEwMDAwMDAgKwogICAgICAgICAgICAgICAgc2VsZi5fbWljcm9zZWNvbmRzKQoKICAgIGRlZiBfX2Zsb29yZGl2X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCAoaW50LCB0aW1lZGVsdGEpKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgdXNlYyA9IHNlbGYuX3RvX21pY3Jvc2Vjb25kcygpCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgdGltZWRlbHRhKToKICAgICAgICAgICAgcmV0dXJuIHVzZWMgLy8gb3RoZXIuX3RvX21pY3Jvc2Vjb25kcygpCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgaW50KToKICAgICAgICAgICAgcmV0dXJuIHRpbWVkZWx0YSgwLCAwLCB1c2VjIC8vIG90aGVyKQoKICAgIGRlZiBfX3RydWVkaXZfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIChpbnQsIGZsb2F0LCB0aW1lZGVsdGEpKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgdXNlYyA9IHNlbGYuX3RvX21pY3Jvc2Vjb25kcygpCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgdGltZWRlbHRhKToKICAgICAgICAgICAgcmV0dXJuIHVzZWMgLyBvdGhlci5fdG9fbWljcm9zZWNvbmRzKCkKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBpbnQpOgogICAgICAgICAgICByZXR1cm4gdGltZWRlbHRhKDAsIDAsIHVzZWMgLyBvdGhlcikKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBmbG9hdCk6CiAgICAgICAgICAgIGEsIGIgPSBvdGhlci5hc19pbnRlZ2VyX3JhdGlvKCkKICAgICAgICAgICAgcmV0dXJuIHRpbWVkZWx0YSgwLCAwLCBiICogdXNlYyAvIGEpCgogICAgZGVmIF9fbW9kX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHRpbWVkZWx0YSk6CiAgICAgICAgICAgIHIgPSBzZWxmLl90b19taWNyb3NlY29uZHMoKSAlIG90aGVyLl90b19taWNyb3NlY29uZHMoKQogICAgICAgICAgICByZXR1cm4gdGltZWRlbHRhKDAsIDAsIHIpCiAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCgogICAgZGVmIF9fZGl2bW9kX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHRpbWVkZWx0YSk6CiAgICAgICAgICAgIHEsIHIgPSBkaXZtb2Qoc2VsZi5fdG9fbWljcm9zZWNvbmRzKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgb3RoZXIuX3RvX21pY3Jvc2Vjb25kcygpKQogICAgICAgICAgICByZXR1cm4gcSwgdGltZWRlbHRhKDAsIDAsIHIpCiAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCgogICAgIyBDb21wYXJpc29ucyBvZiB0aW1lZGVsdGEgb2JqZWN0cyB3aXRoIG90aGVyLgoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHRpbWVkZWx0YSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpID09IDAKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgX19uZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCB0aW1lZGVsdGEpOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fY21wKG90aGVyKSAhPSAwCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgX19sZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCB0aW1lZGVsdGEpOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fY21wKG90aGVyKSA8PSAwCiAgICAgICAgZWxzZToKICAgICAgICAgICAgX2NtcGVycm9yKHNlbGYsIG90aGVyKQoKICAgIGRlZiBfX2x0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHRpbWVkZWx0YSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpIDwgMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIF9jbXBlcnJvcihzZWxmLCBvdGhlcikKCiAgICBkZWYgX19nZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCB0aW1lZGVsdGEpOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fY21wKG90aGVyKSA+PSAwCiAgICAgICAgZWxzZToKICAgICAgICAgICAgX2NtcGVycm9yKHNlbGYsIG90aGVyKQoKICAgIGRlZiBfX2d0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHRpbWVkZWx0YSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpID4gMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIF9jbXBlcnJvcihzZWxmLCBvdGhlcikKCiAgICBkZWYgX2NtcChzZWxmLCBvdGhlcik6CiAgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2Uob3RoZXIsIHRpbWVkZWx0YSkKICAgICAgICAjZml4bWUgYnJ5dGhvbgogICAgICAgICNyZXR1cm4gX2NtcChzZWxmLl9nZXRzdGF0ZSgpLCBvdGhlci5fZ2V0c3RhdGUoKSkKICAgICAgICByZXR1cm4gX3N0YXRlX2NtcChzZWxmLl9nZXRzdGF0ZSgpLCBvdGhlci5fZ2V0c3RhdGUoKSkKCiAgICBkZWYgX19oYXNoX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGhhc2goc2VsZi5fZ2V0c3RhdGUoKSkKCiAgICBkZWYgX19ib29sX18oc2VsZik6CiAgICAgICAgcmV0dXJuIChzZWxmLl9kYXlzICE9IDAgb3IKICAgICAgICAgICAgICAgIHNlbGYuX3NlY29uZHMgIT0gMCBvcgogICAgICAgICAgICAgICAgc2VsZi5fbWljcm9zZWNvbmRzICE9IDApCgogICAgIyBQaWNrbGUgc3VwcG9ydC4KCiAgICBkZWYgX2dldHN0YXRlKHNlbGYpOgogICAgICAgIHJldHVybiAoc2VsZi5fZGF5cywgc2VsZi5fc2Vjb25kcywgc2VsZi5fbWljcm9zZWNvbmRzKQoKICAgIGRlZiBfX3JlZHVjZV9fKHNlbGYpOgogICAgICAgIHJldHVybiAoc2VsZi5fX2NsYXNzX18sIHNlbGYuX2dldHN0YXRlKCkpCgp0aW1lZGVsdGEubWluID0gdGltZWRlbHRhKC05OTk5OTk5OTkpCnRpbWVkZWx0YS5tYXggPSB0aW1lZGVsdGEoZGF5cz05OTk5OTk5OTksIGhvdXJzPTIzLCBtaW51dGVzPTU5LCBzZWNvbmRzPTU5LAogICAgICAgICAgICAgICAgICAgICAgICAgIG1pY3Jvc2Vjb25kcz05OTk5OTkpCnRpbWVkZWx0YS5yZXNvbHV0aW9uID0gdGltZWRlbHRhKG1pY3Jvc2Vjb25kcz0xKQoKY2xhc3MgZGF0ZToKICAgICIiIkNvbmNyZXRlIGRhdGUgdHlwZS4KCiAgICBDb25zdHJ1Y3RvcnM6CgogICAgX19uZXdfXygpCiAgICBmcm9tdGltZXN0YW1wKCkKICAgIHRvZGF5KCkKICAgIGZyb21vcmRpbmFsKCkKCiAgICBPcGVyYXRvcnM6CgogICAgX19yZXByX18sIF9fc3RyX18KICAgIF9fY21wX18sIF9faGFzaF9fCiAgICBfX2FkZF9fLCBfX3JhZGRfXywgX19zdWJfXyAoYWRkL3JhZGQgb25seSB3aXRoIHRpbWVkZWx0YSBhcmcpCgogICAgTWV0aG9kczoKCiAgICB0aW1ldHVwbGUoKQogICAgdG9vcmRpbmFsKCkKICAgIHdlZWtkYXkoKQogICAgaXNvd2Vla2RheSgpLCBpc29jYWxlbmRhcigpLCBpc29mb3JtYXQoKQogICAgY3RpbWUoKQogICAgc3RyZnRpbWUoKQoKICAgIFByb3BlcnRpZXMgKHJlYWRvbmx5KToKICAgIHllYXIsIG1vbnRoLCBkYXkKICAgICIiIgogICAgX19zbG90c19fID0gJ195ZWFyJywgJ19tb250aCcsICdfZGF5JwoKICAgIGRlZiBfX25ld19fKGNscywgeWVhciwgbW9udGg9Tm9uZSwgZGF5PU5vbmUpOgogICAgICAgICIiIkNvbnN0cnVjdG9yLgoKICAgICAgICBBcmd1bWVudHM6CgogICAgICAgIHllYXIsIG1vbnRoLCBkYXkgKHJlcXVpcmVkLCBiYXNlIDEpCiAgICAgICAgIiIiCiAgICAgICAgaWYgKGlzaW5zdGFuY2UoeWVhciwgYnl0ZXMpIGFuZCBsZW4oeWVhcikgPT0gNCBhbmQKICAgICAgICAgICAgMSA8PSB5ZWFyWzJdIDw9IDEyIGFuZCBtb250aCBpcyBOb25lKTogICMgTW9udGggaXMgc2FuZQogICAgICAgICAgICAjIFBpY2tsZSBzdXBwb3J0CiAgICAgICAgICAgIHNlbGYgPSBvYmplY3QuX19uZXdfXyhjbHMpCiAgICAgICAgICAgIHNlbGYuX19zZXRzdGF0ZSh5ZWFyKQogICAgICAgICAgICByZXR1cm4gc2VsZgogICAgICAgIF9jaGVja19kYXRlX2ZpZWxkcyh5ZWFyLCBtb250aCwgZGF5KQogICAgICAgIHNlbGYgPSBvYmplY3QuX19uZXdfXyhjbHMpCiAgICAgICAgc2VsZi5feWVhciA9IHllYXIKICAgICAgICBzZWxmLl9tb250aCA9IG1vbnRoCiAgICAgICAgc2VsZi5fZGF5ID0gZGF5CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICAjIEFkZGl0aW9uYWwgY29uc3RydWN0b3JzCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbXRpbWVzdGFtcChjbHMsIHQpOgogICAgICAgICJDb25zdHJ1Y3QgYSBkYXRlIGZyb20gYSBQT1NJWCB0aW1lc3RhbXAgKGxpa2UgdGltZS50aW1lKCkpLiIKICAgICAgICB5LCBtLCBkLCBoaCwgbW0sIHNzLCB3ZWVrZGF5LCBqZGF5LCBkc3QgPSBfdGltZS5sb2NhbHRpbWUodCkKICAgICAgICByZXR1cm4gY2xzKHksIG0sIGQpCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgdG9kYXkoY2xzKToKICAgICAgICAiQ29uc3RydWN0IGEgZGF0ZSBmcm9tIHRpbWUudGltZSgpLiIKICAgICAgICB0ID0gX3RpbWUudGltZSgpCiAgICAgICAgcmV0dXJuIGNscy5mcm9tdGltZXN0YW1wKHQpCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbW9yZGluYWwoY2xzLCBuKToKICAgICAgICAiIiJDb250cnVjdCBhIGRhdGUgZnJvbSBhIHByb2xlcHRpYyBHcmVnb3JpYW4gb3JkaW5hbC4KCiAgICAgICAgSmFudWFyeSAxIG9mIHllYXIgMSBpcyBkYXkgMS4gIE9ubHkgdGhlIHllYXIsIG1vbnRoIGFuZCBkYXkgYXJlCiAgICAgICAgbm9uLXplcm8gaW4gdGhlIHJlc3VsdC4KICAgICAgICAiIiIKICAgICAgICB5LCBtLCBkID0gX29yZDJ5bWQobikKICAgICAgICByZXR1cm4gY2xzKHksIG0sIGQpCgogICAgIyBDb252ZXJzaW9ucyB0byBzdHJpbmcKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgIiIiQ29udmVydCB0byBmb3JtYWwgc3RyaW5nLCBmb3IgcmVwcigpLgoKICAgICAgICA+Pj4gZHQgPSBkYXRldGltZSgyMDEwLCAxLCAxKQogICAgICAgID4+PiByZXByKGR0KQogICAgICAgICdkYXRldGltZS5kYXRldGltZSgyMDEwLCAxLCAxLCAwLCAwKScKCiAgICAgICAgPj4+IGR0ID0gZGF0ZXRpbWUoMjAxMCwgMSwgMSwgdHppbmZvPXRpbWV6b25lLnV0YykKICAgICAgICA+Pj4gcmVwcihkdCkKICAgICAgICAnZGF0ZXRpbWUuZGF0ZXRpbWUoMjAxMCwgMSwgMSwgMCwgMCwgdHppbmZvPWRhdGV0aW1lLnRpbWV6b25lLnV0YyknCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuICIlcyglZCwgJWQsICVkKSIgJSAoJ2RhdGV0aW1lLicgKyBzZWxmLl9fY2xhc3NfXy5fX25hbWVfXywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl95ZWFyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX21vbnRoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2RheSkKICAgICMgWFhYIFRoZXNlIHNob3VsZG4ndCBkZXBlbmQgb24gdGltZS5sb2NhbHRpbWUoKSwgYmVjYXVzZSB0aGF0CiAgICAjIGNsaXBzIHRoZSB1c2FibGUgZGF0ZXMgdG8gWzE5NzAgLi4gMjAzOCkuICBBdCBsZWFzdCBjdGltZSgpIGlzCiAgICAjIGVhc2lseSBkb25lIHdpdGhvdXQgdXNpbmcgc3RyZnRpbWUoKSAtLSB0aGF0J3MgYmV0dGVyIHRvbyBiZWNhdXNlCiAgICAjIHN0cmZ0aW1lKCIlYyIsIC4uLikgaXMgbG9jYWxlIHNwZWNpZmljLgoKCiAgICBkZWYgY3RpbWUoc2VsZik6CiAgICAgICAgIlJldHVybiBjdGltZSgpIHN0eWxlIHN0cmluZy4iCiAgICAgICAgd2Vla2RheSA9IHNlbGYudG9vcmRpbmFsKCkgJSA3IG9yIDcKICAgICAgICByZXR1cm4gIiVzICVzICUyZCAwMDowMDowMCAlMDRkIiAlICgKICAgICAgICAgICAgX0RBWU5BTUVTW3dlZWtkYXldLAogICAgICAgICAgICBfTU9OVEhOQU1FU1tzZWxmLl9tb250aF0sCiAgICAgICAgICAgIHNlbGYuX2RheSwgc2VsZi5feWVhcikKCiAgICBkZWYgc3RyZnRpbWUoc2VsZiwgZm10KToKICAgICAgICAiRm9ybWF0IHVzaW5nIHN0cmZ0aW1lKCkuIgogICAgICAgIHJldHVybiBfd3JhcF9zdHJmdGltZShzZWxmLCBmbXQsIHNlbGYudGltZXR1cGxlKCkpCgogICAgZGVmIF9fZm9ybWF0X18oc2VsZiwgZm10KToKICAgICAgICBpZiBsZW4oZm10KSAhPSAwOgogICAgICAgICAgICByZXR1cm4gc2VsZi5zdHJmdGltZShmbXQpCiAgICAgICAgcmV0dXJuIHN0cihzZWxmKQoKICAgIGRlZiBpc29mb3JtYXQoc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIHRoZSBkYXRlIGZvcm1hdHRlZCBhY2NvcmRpbmcgdG8gSVNPLgoKICAgICAgICBUaGlzIGlzICdZWVlZLU1NLUREJy4KCiAgICAgICAgUmVmZXJlbmNlczoKICAgICAgICAtIGh0dHA6Ly93d3cudzMub3JnL1RSL05PVEUtZGF0ZXRpbWUKICAgICAgICAtIGh0dHA6Ly93d3cuY2wuY2FtLmFjLnVrL35tZ2syNS9pc28tdGltZS5odG1sCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuICIlMDRkLSUwMmQtJTAyZCIgJSAoc2VsZi5feWVhciwgc2VsZi5fbW9udGgsIHNlbGYuX2RheSkKCiAgICBfX3N0cl9fID0gaXNvZm9ybWF0CgogICAgIyBSZWFkLW9ubHkgZmllbGQgYWNjZXNzb3JzCiAgICBAcHJvcGVydHkKICAgIGRlZiB5ZWFyKHNlbGYpOgogICAgICAgICIiInllYXIgKDEtOTk5OSkiIiIKICAgICAgICByZXR1cm4gc2VsZi5feWVhcgoKICAgIEBwcm9wZXJ0eQogICAgZGVmIG1vbnRoKHNlbGYpOgogICAgICAgICIiIm1vbnRoICgxLTEyKSIiIgogICAgICAgIHJldHVybiBzZWxmLl9tb250aAoKICAgIEBwcm9wZXJ0eQogICAgZGVmIGRheShzZWxmKToKICAgICAgICAiIiJkYXkgKDEtMzEpIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX2RheQoKICAgICMgU3RhbmRhcmQgY29udmVyc2lvbnMsIF9fY21wX18sIF9faGFzaF9fIChhbmQgaGVscGVycykKCiAgICBkZWYgdGltZXR1cGxlKHNlbGYpOgogICAgICAgICJSZXR1cm4gbG9jYWwgdGltZSB0dXBsZSBjb21wYXRpYmxlIHdpdGggdGltZS5sb2NhbHRpbWUoKS4iCiAgICAgICAgcmV0dXJuIF9idWlsZF9zdHJ1Y3RfdGltZShzZWxmLl95ZWFyLCBzZWxmLl9tb250aCwgc2VsZi5fZGF5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCwgMCwgMCwgLTEpCgogICAgZGVmIHRvb3JkaW5hbChzZWxmKToKICAgICAgICAiIiJSZXR1cm4gcHJvbGVwdGljIEdyZWdvcmlhbiBvcmRpbmFsIGZvciB0aGUgeWVhciwgbW9udGggYW5kIGRheS4KCiAgICAgICAgSmFudWFyeSAxIG9mIHllYXIgMSBpcyBkYXkgMS4gIE9ubHkgdGhlIHllYXIsIG1vbnRoIGFuZCBkYXkgdmFsdWVzCiAgICAgICAgY29udHJpYnV0ZSB0byB0aGUgcmVzdWx0LgogICAgICAgICIiIgogICAgICAgIHJldHVybiBfeW1kMm9yZChzZWxmLl95ZWFyLCBzZWxmLl9tb250aCwgc2VsZi5fZGF5KQoKICAgIGRlZiByZXBsYWNlKHNlbGYsIHllYXI9Tm9uZSwgbW9udGg9Tm9uZSwgZGF5PU5vbmUpOgogICAgICAgICIiIlJldHVybiBhIG5ldyBkYXRlIHdpdGggbmV3IHZhbHVlcyBmb3IgdGhlIHNwZWNpZmllZCBmaWVsZHMuIiIiCiAgICAgICAgaWYgeWVhciBpcyBOb25lOgogICAgICAgICAgICB5ZWFyID0gc2VsZi5feWVhcgogICAgICAgIGlmIG1vbnRoIGlzIE5vbmU6CiAgICAgICAgICAgIG1vbnRoID0gc2VsZi5fbW9udGgKICAgICAgICBpZiBkYXkgaXMgTm9uZToKICAgICAgICAgICAgZGF5ID0gc2VsZi5fZGF5CiAgICAgICAgX2NoZWNrX2RhdGVfZmllbGRzKHllYXIsIG1vbnRoLCBkYXkpCiAgICAgICAgcmV0dXJuIGRhdGUoeWVhciwgbW9udGgsIGRheSkKCiAgICAjIENvbXBhcmlzb25zIG9mIGRhdGUgb2JqZWN0cyB3aXRoIG90aGVyLgoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIGRhdGUpOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fY21wKG90aGVyKSA9PSAwCiAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCgogICAgZGVmIF9fbmVfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgZGF0ZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpICE9IDAKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICBkZWYgX19sZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkYXRlKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NtcChvdGhlcikgPD0gMAogICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgIGRlZiBfX2x0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIGRhdGUpOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fY21wKG90aGVyKSA8IDAKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICBkZWYgX19nZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkYXRlKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NtcChvdGhlcikgPj0gMAogICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgIGRlZiBfX2d0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIGRhdGUpOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fY21wKG90aGVyKSA+IDAKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICBkZWYgX2NtcChzZWxmLCBvdGhlcik6CiAgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2Uob3RoZXIsIGRhdGUpCiAgICAgICAgeSwgbSwgZCA9IHNlbGYuX3llYXIsIHNlbGYuX21vbnRoLCBzZWxmLl9kYXkKICAgICAgICB5MiwgbTIsIGQyID0gb3RoZXIuX3llYXIsIG90aGVyLl9tb250aCwgb3RoZXIuX2RheQogICAgICAgICNmaXhtZSBicnl0aG9uCiAgICAgICAgI3JldHVybiBfY21wKCh5LCBtLCBkKSwgKHkyLCBtMiwgZDIpKQogICAgICAgIHJldHVybiBfc3RhdGVfY21wKCh5LCBtLCBkKSwgKHkyLCBtMiwgZDIpKQoKICAgIGRlZiBfX2hhc2hfXyhzZWxmKToKICAgICAgICAiSGFzaC4iCiAgICAgICAgcmV0dXJuIGhhc2goc2VsZi5fZ2V0c3RhdGUoKSkKCiAgICAjIENvbXB1dGF0aW9ucwoKICAgIGRlZiBfX2FkZF9fKHNlbGYsIG90aGVyKToKICAgICAgICAiQWRkIGEgZGF0ZSB0byBhIHRpbWVkZWx0YS4iCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgdGltZWRlbHRhKToKICAgICAgICAgICAgbyA9IHNlbGYudG9vcmRpbmFsKCkgKyBvdGhlci5kYXlzCiAgICAgICAgICAgIGlmIDAgPCBvIDw9IF9NQVhPUkRJTkFMOgogICAgICAgICAgICAgICAgcmV0dXJuIGRhdGUuZnJvbW9yZGluYWwobykKICAgICAgICAgICAgcmFpc2UgT3ZlcmZsb3dFcnJvcigicmVzdWx0IG91dCBvZiByYW5nZSIpCiAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCgogICAgX19yYWRkX18gPSBfX2FkZF9fCgogICAgZGVmIF9fc3ViX18oc2VsZiwgb3RoZXIpOgogICAgICAgICIiIlN1YnRyYWN0IHR3byBkYXRlcywgb3IgYSBkYXRlIGFuZCBhIHRpbWVkZWx0YS4iIiIKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCB0aW1lZGVsdGEpOgogICAgICAgICAgICByZXR1cm4gc2VsZiArIHRpbWVkZWx0YSgtb3RoZXIuZGF5cykKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkYXRlKToKICAgICAgICAgICAgZGF5czEgPSBzZWxmLnRvb3JkaW5hbCgpCiAgICAgICAgICAgIGRheXMyID0gb3RoZXIudG9vcmRpbmFsKCkKICAgICAgICAgICAgcmV0dXJuIHRpbWVkZWx0YShkYXlzMSAtIGRheXMyKQogICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgIGRlZiB3ZWVrZGF5KHNlbGYpOgogICAgICAgICJSZXR1cm4gZGF5IG9mIHRoZSB3ZWVrLCB3aGVyZSBNb25kYXkgPT0gMCAuLi4gU3VuZGF5ID09IDYuIgogICAgICAgIHJldHVybiAoc2VsZi50b29yZGluYWwoKSArIDYpICUgNwoKICAgICMgRGF5LW9mLXRoZS13ZWVrIGFuZCB3ZWVrLW9mLXRoZS15ZWFyLCBhY2NvcmRpbmcgdG8gSVNPCgogICAgZGVmIGlzb3dlZWtkYXkoc2VsZik6CiAgICAgICAgIlJldHVybiBkYXkgb2YgdGhlIHdlZWssIHdoZXJlIE1vbmRheSA9PSAxIC4uLiBTdW5kYXkgPT0gNy4iCiAgICAgICAgIyAxLUphbi0wMDAxIGlzIGEgTW9uZGF5CiAgICAgICAgcmV0dXJuIHNlbGYudG9vcmRpbmFsKCkgJSA3IG9yIDcKCiAgICBkZWYgaXNvY2FsZW5kYXIoc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIGEgMy10dXBsZSBjb250YWluaW5nIElTTyB5ZWFyLCB3ZWVrIG51bWJlciwgYW5kIHdlZWtkYXkuCgogICAgICAgIFRoZSBmaXJzdCBJU08gd2VlayBvZiB0aGUgeWVhciBpcyB0aGUgKE1vbi1TdW4pIHdlZWsKICAgICAgICBjb250YWluaW5nIHRoZSB5ZWFyJ3MgZmlyc3QgVGh1cnNkYXk7IGV2ZXJ5dGhpbmcgZWxzZSBkZXJpdmVzCiAgICAgICAgZnJvbSB0aGF0LgoKICAgICAgICBUaGUgZmlyc3Qgd2VlayBpcyAxOyBNb25kYXkgaXMgMSAuLi4gU3VuZGF5IGlzIDcuCgogICAgICAgIElTTyBjYWxlbmRhciBhbGdvcml0aG0gdGFrZW4gZnJvbQogICAgICAgIGh0dHA6Ly93d3cucGh5cy51dS5ubC9+dmdlbnQvY2FsZW5kYXIvaXNvY2FsZW5kYXIuaHRtCiAgICAgICAgIiIiCiAgICAgICAgeWVhciA9IHNlbGYuX3llYXIKICAgICAgICB3ZWVrMW1vbmRheSA9IF9pc293ZWVrMW1vbmRheSh5ZWFyKQogICAgICAgIHRvZGF5ID0gX3ltZDJvcmQoc2VsZi5feWVhciwgc2VsZi5fbW9udGgsIHNlbGYuX2RheSkKICAgICAgICAjIEludGVybmFsbHksIHdlZWsgYW5kIGRheSBoYXZlIG9yaWdpbiAwCiAgICAgICAgd2VlaywgZGF5ID0gZGl2bW9kKHRvZGF5IC0gd2VlazFtb25kYXksIDcpCiAgICAgICAgaWYgd2VlayA8IDA6CiAgICAgICAgICAgIHllYXIgLT0gMQogICAgICAgICAgICB3ZWVrMW1vbmRheSA9IF9pc293ZWVrMW1vbmRheSh5ZWFyKQogICAgICAgICAgICB3ZWVrLCBkYXkgPSBkaXZtb2QodG9kYXkgLSB3ZWVrMW1vbmRheSwgNykKICAgICAgICBlbGlmIHdlZWsgPj0gNTI6CiAgICAgICAgICAgIGlmIHRvZGF5ID49IF9pc293ZWVrMW1vbmRheSh5ZWFyKzEpOgogICAgICAgICAgICAgICAgeWVhciArPSAxCiAgICAgICAgICAgICAgICB3ZWVrID0gMAogICAgICAgIHJldHVybiB5ZWFyLCB3ZWVrKzEsIGRheSsxCgogICAgIyBQaWNrbGUgc3VwcG9ydC4KCiAgICBkZWYgX2dldHN0YXRlKHNlbGYpOgogICAgICAgIHloaSwgeWxvID0gZGl2bW9kKHNlbGYuX3llYXIsIDI1NikKICAgICAgICByZXR1cm4gYnl0ZXMoW3loaSwgeWxvLCBzZWxmLl9tb250aCwgc2VsZi5fZGF5XSksCgogICAgZGVmIF9fc2V0c3RhdGUoc2VsZiwgc3RyaW5nKToKICAgICAgICBpZiBsZW4oc3RyaW5nKSAhPSA0IG9yIG5vdCAoMSA8PSBzdHJpbmdbMl0gPD0gMTIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIm5vdCBlbm91Z2ggYXJndW1lbnRzIikKICAgICAgICB5aGksIHlsbywgc2VsZi5fbW9udGgsIHNlbGYuX2RheSA9IHN0cmluZwogICAgICAgIHNlbGYuX3llYXIgPSB5aGkgKiAyNTYgKyB5bG8KCiAgICBkZWYgX19yZWR1Y2VfXyhzZWxmKToKICAgICAgICByZXR1cm4gKHNlbGYuX19jbGFzc19fLCBzZWxmLl9nZXRzdGF0ZSgpKQoKX2RhdGVfY2xhc3MgPSBkYXRlICAjIHNvIGZ1bmN0aW9ucyB3LyBhcmdzIG5hbWVkICJkYXRlIiBjYW4gZ2V0IGF0IHRoZSBjbGFzcwoKZGF0ZS5taW4gPSBkYXRlKDEsIDEsIDEpCmRhdGUubWF4ID0gZGF0ZSg5OTk5LCAxMiwgMzEpCmRhdGUucmVzb2x1dGlvbiA9IHRpbWVkZWx0YShkYXlzPTEpCgpjbGFzcyB0emluZm86CiAgICAiIiJBYnN0cmFjdCBiYXNlIGNsYXNzIGZvciB0aW1lIHpvbmUgaW5mbyBjbGFzc2VzLgoKICAgIFN1YmNsYXNzZXMgbXVzdCBvdmVycmlkZSB0aGUgbmFtZSgpLCB1dGNvZmZzZXQoKSBhbmQgZHN0KCkgbWV0aG9kcy4KICAgICIiIgogICAgX19zbG90c19fID0gKCkKICAgIGRlZiB0em5hbWUoc2VsZiwgZHQpOgogICAgICAgICJkYXRldGltZSAtPiBzdHJpbmcgbmFtZSBvZiB0aW1lIHpvbmUuIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoInR6aW5mbyBzdWJjbGFzcyBtdXN0IG92ZXJyaWRlIHR6bmFtZSgpIikKCiAgICBkZWYgdXRjb2Zmc2V0KHNlbGYsIGR0KToKICAgICAgICAiZGF0ZXRpbWUgLT4gbWludXRlcyBlYXN0IG9mIFVUQyAobmVnYXRpdmUgZm9yIHdlc3Qgb2YgVVRDKSIKICAgICAgICByYWlzZSBOb3RJbXBsZW1lbnRlZEVycm9yKCJ0emluZm8gc3ViY2xhc3MgbXVzdCBvdmVycmlkZSB1dGNvZmZzZXQoKSIpCgogICAgZGVmIGRzdChzZWxmLCBkdCk6CiAgICAgICAgIiIiZGF0ZXRpbWUgLT4gRFNUIG9mZnNldCBpbiBtaW51dGVzIGVhc3Qgb2YgVVRDLgoKICAgICAgICBSZXR1cm4gMCBpZiBEU1Qgbm90IGluIGVmZmVjdC4gIHV0Y29mZnNldCgpIG11c3QgaW5jbHVkZSB0aGUgRFNUCiAgICAgICAgb2Zmc2V0LgogICAgICAgICIiIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoInR6aW5mbyBzdWJjbGFzcyBtdXN0IG92ZXJyaWRlIGRzdCgpIikKCiAgICBkZWYgZnJvbXV0YyhzZWxmLCBkdCk6CiAgICAgICAgImRhdGV0aW1lIGluIFVUQyAtPiBkYXRldGltZSBpbiBsb2NhbCB0aW1lLiIKCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoZHQsIGRhdGV0aW1lKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJmcm9tdXRjKCkgcmVxdWlyZXMgYSBkYXRldGltZSBhcmd1bWVudCIpCiAgICAgICAgaWYgZHQudHppbmZvIGlzIG5vdCBzZWxmOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJkdC50emluZm8gaXMgbm90IHNlbGYiKQoKICAgICAgICBkdG9mZiA9IGR0LnV0Y29mZnNldCgpCiAgICAgICAgaWYgZHRvZmYgaXMgTm9uZToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiZnJvbXV0YygpIHJlcXVpcmVzIGEgbm9uLU5vbmUgdXRjb2Zmc2V0KCkgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJyZXN1bHQiKQoKICAgICAgICAjIFNlZSB0aGUgbG9uZyBjb21tZW50IGJsb2NrIGF0IHRoZSBlbmQgb2YgdGhpcyBmaWxlIGZvciBhbgogICAgICAgICMgZXhwbGFuYXRpb24gb2YgdGhpcyBhbGdvcml0aG0uCiAgICAgICAgZHRkc3QgPSBkdC5kc3QoKQogICAgICAgIGlmIGR0ZHN0IGlzIE5vbmU6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImZyb211dGMoKSByZXF1aXJlcyBhIG5vbi1Ob25lIGRzdCgpIHJlc3VsdCIpCiAgICAgICAgZGVsdGEgPSBkdG9mZiAtIGR0ZHN0CiAgICAgICAgaWYgZGVsdGE6CiAgICAgICAgICAgIGR0ICs9IGRlbHRhCiAgICAgICAgICAgIGR0ZHN0ID0gZHQuZHN0KCkKICAgICAgICAgICAgaWYgZHRkc3QgaXMgTm9uZToKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImZyb211dGMoKTogZHQuZHN0IGdhdmUgaW5jb25zaXN0ZW50ICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInJlc3VsdHM7IGNhbm5vdCBjb252ZXJ0IikKICAgICAgICByZXR1cm4gZHQgKyBkdGRzdAoKICAgICMgUGlja2xlIHN1cHBvcnQuCgogICAgZGVmIF9fcmVkdWNlX18oc2VsZik6CiAgICAgICAgZ2V0aW5pdGFyZ3MgPSBnZXRhdHRyKHNlbGYsICJfX2dldGluaXRhcmdzX18iLCBOb25lKQogICAgICAgIGlmIGdldGluaXRhcmdzOgogICAgICAgICAgICBhcmdzID0gZ2V0aW5pdGFyZ3MoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGFyZ3MgPSAoKQogICAgICAgIGdldHN0YXRlID0gZ2V0YXR0cihzZWxmLCAiX19nZXRzdGF0ZV9fIiwgTm9uZSkKICAgICAgICBpZiBnZXRzdGF0ZToKICAgICAgICAgICAgc3RhdGUgPSBnZXRzdGF0ZSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc3RhdGUgPSBnZXRhdHRyKHNlbGYsICJfX2RpY3RfXyIsIE5vbmUpIG9yIE5vbmUKICAgICAgICBpZiBzdGF0ZSBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gKHNlbGYuX19jbGFzc19fLCBhcmdzKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiAoc2VsZi5fX2NsYXNzX18sIGFyZ3MsIHN0YXRlKQoKX3R6aW5mb19jbGFzcyA9IHR6aW5mbwoKY2xhc3MgdGltZToKICAgICIiIlRpbWUgd2l0aCB0aW1lIHpvbmUuCgogICAgQ29uc3RydWN0b3JzOgoKICAgIF9fbmV3X18oKQoKICAgIE9wZXJhdG9yczoKCiAgICBfX3JlcHJfXywgX19zdHJfXwogICAgX19jbXBfXywgX19oYXNoX18KCiAgICBNZXRob2RzOgoKICAgIHN0cmZ0aW1lKCkKICAgIGlzb2Zvcm1hdCgpCiAgICB1dGNvZmZzZXQoKQogICAgdHpuYW1lKCkKICAgIGRzdCgpCgogICAgUHJvcGVydGllcyAocmVhZG9ubHkpOgogICAgaG91ciwgbWludXRlLCBzZWNvbmQsIG1pY3Jvc2Vjb25kLCB0emluZm8KICAgICIiIgoKICAgIGRlZiBfX25ld19fKGNscywgaG91cj0wLCBtaW51dGU9MCwgc2Vjb25kPTAsIG1pY3Jvc2Vjb25kPTAsIHR6aW5mbz1Ob25lKToKICAgICAgICAiIiJDb25zdHJ1Y3Rvci4KCiAgICAgICAgQXJndW1lbnRzOgoKICAgICAgICBob3VyLCBtaW51dGUgKHJlcXVpcmVkKQogICAgICAgIHNlY29uZCwgbWljcm9zZWNvbmQgKGRlZmF1bHQgdG8gemVybykKICAgICAgICB0emluZm8gKGRlZmF1bHQgdG8gTm9uZSkKICAgICAgICAiIiIKICAgICAgICBzZWxmID0gb2JqZWN0Ll9fbmV3X18oY2xzKQogICAgICAgIGlmIGlzaW5zdGFuY2UoaG91ciwgYnl0ZXMpIGFuZCBsZW4oaG91cikgPT0gNjoKICAgICAgICAgICAgIyBQaWNrbGUgc3VwcG9ydAogICAgICAgICAgICBzZWxmLl9fc2V0c3RhdGUoaG91ciwgbWludXRlIG9yIE5vbmUpCiAgICAgICAgICAgIHJldHVybiBzZWxmCiAgICAgICAgX2NoZWNrX3R6aW5mb19hcmcodHppbmZvKQogICAgICAgIF9jaGVja190aW1lX2ZpZWxkcyhob3VyLCBtaW51dGUsIHNlY29uZCwgbWljcm9zZWNvbmQpCiAgICAgICAgc2VsZi5faG91ciA9IGhvdXIKICAgICAgICBzZWxmLl9taW51dGUgPSBtaW51dGUKICAgICAgICBzZWxmLl9zZWNvbmQgPSBzZWNvbmQKICAgICAgICBzZWxmLl9taWNyb3NlY29uZCA9IG1pY3Jvc2Vjb25kCiAgICAgICAgc2VsZi5fdHppbmZvID0gdHppbmZvCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICAjIFJlYWQtb25seSBmaWVsZCBhY2Nlc3NvcnMKICAgIEBwcm9wZXJ0eQogICAgZGVmIGhvdXIoc2VsZik6CiAgICAgICAgIiIiaG91ciAoMC0yMykiIiIKICAgICAgICByZXR1cm4gc2VsZi5faG91cgoKICAgIEBwcm9wZXJ0eQogICAgZGVmIG1pbnV0ZShzZWxmKToKICAgICAgICAiIiJtaW51dGUgKDAtNTkpIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX21pbnV0ZQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIHNlY29uZChzZWxmKToKICAgICAgICAiIiJzZWNvbmQgKDAtNTkpIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX3NlY29uZAoKICAgIEBwcm9wZXJ0eQogICAgZGVmIG1pY3Jvc2Vjb25kKHNlbGYpOgogICAgICAgICIiIm1pY3Jvc2Vjb25kICgwLTk5OTk5OSkiIiIKICAgICAgICByZXR1cm4gc2VsZi5fbWljcm9zZWNvbmQKCiAgICBAcHJvcGVydHkKICAgIGRlZiB0emluZm8oc2VsZik6CiAgICAgICAgIiIidGltZXpvbmUgaW5mbyBvYmplY3QiIiIKICAgICAgICByZXR1cm4gc2VsZi5fdHppbmZvCgogICAgIyBTdGFuZGFyZCBjb252ZXJzaW9ucywgX19oYXNoX18gKGFuZCBoZWxwZXJzKQoKICAgICMgQ29tcGFyaXNvbnMgb2YgdGltZSBvYmplY3RzIHdpdGggb3RoZXIuCgogICAgZGVmIF9fZXFfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgdGltZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpID09IDAKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgX19uZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCB0aW1lKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NtcChvdGhlcikgIT0gMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIF9fbGVfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgdGltZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpIDw9IDAKICAgICAgICBlbHNlOgogICAgICAgICAgICBfY21wZXJyb3Ioc2VsZiwgb3RoZXIpCgogICAgZGVmIF9fbHRfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgdGltZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpIDwgMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIF9jbXBlcnJvcihzZWxmLCBvdGhlcikKCiAgICBkZWYgX19nZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCB0aW1lKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NtcChvdGhlcikgPj0gMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIF9jbXBlcnJvcihzZWxmLCBvdGhlcikKCiAgICBkZWYgX19ndF9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCB0aW1lKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NtcChvdGhlcikgPiAwCiAgICAgICAgZWxzZToKICAgICAgICAgICAgX2NtcGVycm9yKHNlbGYsIG90aGVyKQoKICAgIGRlZiBfY21wKHNlbGYsIG90aGVyKToKICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShvdGhlciwgdGltZSkKICAgICAgICBteXR6ID0gc2VsZi5fdHppbmZvCiAgICAgICAgb3R0eiA9IG90aGVyLl90emluZm8KICAgICAgICBteW9mZiA9IG90b2ZmID0gTm9uZQoKICAgICAgICBpZiBteXR6IGlzIG90dHo6CiAgICAgICAgICAgIGJhc2VfY29tcGFyZSA9IFRydWUKICAgICAgICBlbHNlOgogICAgICAgICAgICBteW9mZiA9IHNlbGYudXRjb2Zmc2V0KCkKICAgICAgICAgICAgb3RvZmYgPSBvdGhlci51dGNvZmZzZXQoKQogICAgICAgICAgICBiYXNlX2NvbXBhcmUgPSBteW9mZiA9PSBvdG9mZgoKICAgICAgICBpZiBiYXNlX2NvbXBhcmU6CiAgICAgICAgICAgICNmaXhtZSBicnl0aG9uCiAgICAgICAgICAgICNyZXR1cm4gX2NtcCgoc2VsZi5faG91ciwgc2VsZi5fbWludXRlLCBzZWxmLl9zZWNvbmQsCiAgICAgICAgICAgICMgICAgICAgICAgICAgc2VsZi5fbWljcm9zZWNvbmQpLAogICAgICAgICAgICAjICAgICAgICAgICAob3RoZXIuX2hvdXIsIG90aGVyLl9taW51dGUsIG90aGVyLl9zZWNvbmQsCiAgICAgICAgICAgICMgICAgICAgICAgICBvdGhlci5fbWljcm9zZWNvbmQpKQogICAgICAgICAgICByZXR1cm4gX3R1cGxlX2NtcCgoc2VsZi5faG91ciwgc2VsZi5fbWludXRlLCBzZWxmLl9zZWNvbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9taWNyb3NlY29uZCksCiAgICAgICAgICAgICAgICAgICAgICAgKG90aGVyLl9ob3VyLCBvdGhlci5fbWludXRlLCBvdGhlci5fc2Vjb25kLAogICAgICAgICAgICAgICAgICAgICAgICBvdGhlci5fbWljcm9zZWNvbmQpKQogICAgICAgIGlmIG15b2ZmIGlzIE5vbmUgb3Igb3RvZmYgaXMgTm9uZToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJjYW5ub3QgY29tcGFyZSBuYWl2ZSBhbmQgYXdhcmUgdGltZXMiKQogICAgICAgIG15aGhtbSA9IHNlbGYuX2hvdXIgKiA2MCArIHNlbGYuX21pbnV0ZSAtIG15b2ZmLy90aW1lZGVsdGEobWludXRlcz0xKQogICAgICAgIG90aGhtbSA9IG90aGVyLl9ob3VyICogNjAgKyBvdGhlci5fbWludXRlIC0gb3RvZmYvL3RpbWVkZWx0YShtaW51dGVzPTEpCiAgICAgICAgI2ZpeG1lIGJyeXRob24KICAgICAgICAjcmV0dXJuIF9jbXAoKG15aGhtbSwgc2VsZi5fc2Vjb25kLCBzZWxmLl9taWNyb3NlY29uZCksCiAgICAgICAgIyAgICAgICAgICAgIChvdGhobW0sIG90aGVyLl9zZWNvbmQsIG90aGVyLl9taWNyb3NlY29uZCkpCiAgICAgICAgcmV0dXJuIF90dXBsZV9jbXAoKG15aGhtbSwgc2VsZi5fc2Vjb25kLCBzZWxmLl9taWNyb3NlY29uZCksCiAgICAgICAgICAgICAgICAgICAgKG90aGhtbSwgb3RoZXIuX3NlY29uZCwgb3RoZXIuX21pY3Jvc2Vjb25kKSkKCiAgICBkZWYgX19oYXNoX18oc2VsZik6CiAgICAgICAgIiIiSGFzaC4iIiIKICAgICAgICB0em9mZiA9IHNlbGYudXRjb2Zmc2V0KCkKICAgICAgICBpZiBub3QgdHpvZmY6ICMgemVybyBvciBOb25lCiAgICAgICAgICAgIHJldHVybiBoYXNoKHNlbGYuX2dldHN0YXRlKClbMF0pCiAgICAgICAgaCwgbSA9IGRpdm1vZCh0aW1lZGVsdGEoaG91cnM9c2VsZi5ob3VyLCBtaW51dGVzPXNlbGYubWludXRlKSAtIHR6b2ZmLAogICAgICAgICAgICAgICAgICAgICAgdGltZWRlbHRhKGhvdXJzPTEpKQogICAgICAgIGFzc2VydCBub3QgbSAlIHRpbWVkZWx0YShtaW51dGVzPTEpLCAid2hvbGUgbWludXRlIgogICAgICAgIG0gLy89IHRpbWVkZWx0YShtaW51dGVzPTEpCiAgICAgICAgaWYgMCA8PSBoIDwgMjQ6CiAgICAgICAgICAgIHJldHVybiBoYXNoKHRpbWUoaCwgbSwgc2VsZi5zZWNvbmQsIHNlbGYubWljcm9zZWNvbmQpKQogICAgICAgIHJldHVybiBoYXNoKChoLCBtLCBzZWxmLnNlY29uZCwgc2VsZi5taWNyb3NlY29uZCkpCgogICAgIyBDb252ZXJzaW9uIHRvIHN0cmluZwoKICAgIGRlZiBfdHpzdHIoc2VsZiwgc2VwPSI6Iik6CiAgICAgICAgIiIiUmV0dXJuIGZvcm1hdHRlZCB0aW1lem9uZSBvZmZzZXQgKCt4eDp4eCkgb3IgTm9uZS4iIiIKICAgICAgICBvZmYgPSBzZWxmLnV0Y29mZnNldCgpCiAgICAgICAgaWYgb2ZmIGlzIG5vdCBOb25lOgogICAgICAgICAgICBpZiBvZmYuZGF5cyA8IDA6CiAgICAgICAgICAgICAgICBzaWduID0gIi0iCiAgICAgICAgICAgICAgICBvZmYgPSAtb2ZmCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzaWduID0gIisiCiAgICAgICAgICAgIGhoLCBtbSA9IGRpdm1vZChvZmYsIHRpbWVkZWx0YShob3Vycz0xKSkKICAgICAgICAgICAgYXNzZXJ0IG5vdCBtbSAlIHRpbWVkZWx0YShtaW51dGVzPTEpLCAid2hvbGUgbWludXRlIgogICAgICAgICAgICBtbSAvLz0gdGltZWRlbHRhKG1pbnV0ZXM9MSkKICAgICAgICAgICAgYXNzZXJ0IDAgPD0gaGggPCAyNAogICAgICAgICAgICBvZmYgPSAiJXMlMDJkJXMlMDJkIiAlIChzaWduLCBoaCwgc2VwLCBtbSkKICAgICAgICByZXR1cm4gb2ZmCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgICIiIkNvbnZlcnQgdG8gZm9ybWFsIHN0cmluZywgZm9yIHJlcHIoKS4iIiIKICAgICAgICBpZiBzZWxmLl9taWNyb3NlY29uZCAhPSAwOgogICAgICAgICAgICBzID0gIiwgJWQsICVkIiAlIChzZWxmLl9zZWNvbmQsIHNlbGYuX21pY3Jvc2Vjb25kKQogICAgICAgIGVsaWYgc2VsZi5fc2Vjb25kICE9IDA6CiAgICAgICAgICAgIHMgPSAiLCAlZCIgJSBzZWxmLl9zZWNvbmQKICAgICAgICBlbHNlOgogICAgICAgICAgICBzID0gIiIKICAgICAgICBzPSAiJXMoJWQsICVkJXMpIiAlICgnZGF0ZXRpbWUuJyArIHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2hvdXIsIHNlbGYuX21pbnV0ZSwgcykKICAgICAgICBpZiBzZWxmLl90emluZm8gaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGFzc2VydCBzWy0xOl0gPT0gIikiCiAgICAgICAgICAgIHMgPSBzWzotMV0gKyAiLCB0emluZm89JXIiICUgc2VsZi5fdHppbmZvICsgIikiCiAgICAgICAgcmV0dXJuIHMKCiAgICBkZWYgaXNvZm9ybWF0KHNlbGYpOgogICAgICAgICIiIlJldHVybiB0aGUgdGltZSBmb3JtYXR0ZWQgYWNjb3JkaW5nIHRvIElTTy4KCiAgICAgICAgVGhpcyBpcyAnSEg6TU06U1MubW1tbW1tK3p6Onp6Jywgb3IgJ0hIOk1NOlNTK3p6Onp6JyBpZgogICAgICAgIHNlbGYubWljcm9zZWNvbmQgPT0gMC4KICAgICAgICAiIiIKICAgICAgICBzID0gX2Zvcm1hdF90aW1lKHNlbGYuX2hvdXIsIHNlbGYuX21pbnV0ZSwgc2VsZi5fc2Vjb25kLAogICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fbWljcm9zZWNvbmQpCiAgICAgICAgdHogPSBzZWxmLl90enN0cigpCiAgICAgICAgaWYgdHo6CiAgICAgICAgICAgIHMgKz0gdHoKICAgICAgICByZXR1cm4gcwoKICAgIF9fc3RyX18gPSBpc29mb3JtYXQKCiAgICBkZWYgc3RyZnRpbWUoc2VsZiwgZm10KToKICAgICAgICAiIiJGb3JtYXQgdXNpbmcgc3RyZnRpbWUoKS4gIFRoZSBkYXRlIHBhcnQgb2YgdGhlIHRpbWVzdGFtcCBwYXNzZWQKICAgICAgICB0byB1bmRlcmx5aW5nIHN0cmZ0aW1lIHNob3VsZCBub3QgYmUgdXNlZC4KICAgICAgICAiIiIKICAgICAgICAjIFRoZSB5ZWFyIG11c3QgYmUgPj0gMTAwMCBlbHNlIFB5dGhvbidzIHN0cmZ0aW1lIGltcGxlbWVudGF0aW9uCiAgICAgICAgIyBjYW4gcmFpc2UgYSBib2d1cyBleGNlcHRpb24uCiAgICAgICAgdGltZXR1cGxlID0gKDE5MDAsIDEsIDEsCiAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2hvdXIsIHNlbGYuX21pbnV0ZSwgc2VsZi5fc2Vjb25kLAogICAgICAgICAgICAgICAgICAgICAwLCAxLCAtMSkKICAgICAgICByZXR1cm4gX3dyYXBfc3RyZnRpbWUoc2VsZiwgZm10LCB0aW1ldHVwbGUpCgogICAgZGVmIF9fZm9ybWF0X18oc2VsZiwgZm10KToKICAgICAgICBpZiBsZW4oZm10KSAhPSAwOgogICAgICAgICAgICByZXR1cm4gc2VsZi5zdHJmdGltZShmbXQpCiAgICAgICAgcmV0dXJuIHN0cihzZWxmKQoKICAgICMgVGltZXpvbmUgZnVuY3Rpb25zCgogICAgZGVmIHV0Y29mZnNldChzZWxmKToKICAgICAgICAiIiJSZXR1cm4gdGhlIHRpbWV6b25lIG9mZnNldCBpbiBtaW51dGVzIGVhc3Qgb2YgVVRDIChuZWdhdGl2ZSB3ZXN0IG9mCiAgICAgICAgVVRDKS4iIiIKICAgICAgICBpZiBzZWxmLl90emluZm8gaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICBvZmZzZXQgPSBzZWxmLl90emluZm8udXRjb2Zmc2V0KE5vbmUpCiAgICAgICAgX2NoZWNrX3V0Y19vZmZzZXQoInV0Y29mZnNldCIsIG9mZnNldCkKICAgICAgICByZXR1cm4gb2Zmc2V0CgogICAgZGVmIHR6bmFtZShzZWxmKToKICAgICAgICAiIiJSZXR1cm4gdGhlIHRpbWV6b25lIG5hbWUuCgogICAgICAgIE5vdGUgdGhhdCB0aGUgbmFtZSBpcyAxMDAlIGluZm9ybWF0aW9uYWwgLS0gdGhlcmUncyBubyByZXF1aXJlbWVudCB0aGF0CiAgICAgICAgaXQgbWVhbiBhbnl0aGluZyBpbiBwYXJ0aWN1bGFyLiBGb3IgZXhhbXBsZSwgIkdNVCIsICJVVEMiLCAiLTUwMCIsCiAgICAgICAgIi01OjAwIiwgIkVEVCIsICJVUy9FYXN0ZXJuIiwgIkFtZXJpY2EvTmV3IFlvcmsiIGFyZSBhbGwgdmFsaWQgcmVwbGllcy4KICAgICAgICAiIiIKICAgICAgICBpZiBzZWxmLl90emluZm8gaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICBuYW1lID0gc2VsZi5fdHppbmZvLnR6bmFtZShOb25lKQogICAgICAgIF9jaGVja190em5hbWUobmFtZSkKICAgICAgICByZXR1cm4gbmFtZQoKICAgIGRlZiBkc3Qoc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIDAgaWYgRFNUIGlzIG5vdCBpbiBlZmZlY3QsIG9yIHRoZSBEU1Qgb2Zmc2V0IChpbiBtaW51dGVzCiAgICAgICAgZWFzdHdhcmQpIGlmIERTVCBpcyBpbiBlZmZlY3QuCgogICAgICAgIFRoaXMgaXMgcHVyZWx5IGluZm9ybWF0aW9uYWw7IHRoZSBEU1Qgb2Zmc2V0IGhhcyBhbHJlYWR5IGJlZW4gYWRkZWQgdG8KICAgICAgICB0aGUgVVRDIG9mZnNldCByZXR1cm5lZCBieSB1dGNvZmZzZXQoKSBpZiBhcHBsaWNhYmxlLCBzbyB0aGVyZSdzIG5vCiAgICAgICAgbmVlZCB0byBjb25zdWx0IGRzdCgpIHVubGVzcyB5b3UncmUgaW50ZXJlc3RlZCBpbiBkaXNwbGF5aW5nIHRoZSBEU1QKICAgICAgICBpbmZvLgogICAgICAgICIiIgogICAgICAgIGlmIHNlbGYuX3R6aW5mbyBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIG9mZnNldCA9IHNlbGYuX3R6aW5mby5kc3QoTm9uZSkKICAgICAgICBfY2hlY2tfdXRjX29mZnNldCgiZHN0Iiwgb2Zmc2V0KQogICAgICAgIHJldHVybiBvZmZzZXQKCiAgICBkZWYgcmVwbGFjZShzZWxmLCBob3VyPU5vbmUsIG1pbnV0ZT1Ob25lLCBzZWNvbmQ9Tm9uZSwgbWljcm9zZWNvbmQ9Tm9uZSwKICAgICAgICAgICAgICAgIHR6aW5mbz1UcnVlKToKICAgICAgICAiIiJSZXR1cm4gYSBuZXcgdGltZSB3aXRoIG5ldyB2YWx1ZXMgZm9yIHRoZSBzcGVjaWZpZWQgZmllbGRzLiIiIgogICAgICAgIGlmIGhvdXIgaXMgTm9uZToKICAgICAgICAgICAgaG91ciA9IHNlbGYuaG91cgogICAgICAgIGlmIG1pbnV0ZSBpcyBOb25lOgogICAgICAgICAgICBtaW51dGUgPSBzZWxmLm1pbnV0ZQogICAgICAgIGlmIHNlY29uZCBpcyBOb25lOgogICAgICAgICAgICBzZWNvbmQgPSBzZWxmLnNlY29uZAogICAgICAgIGlmIG1pY3Jvc2Vjb25kIGlzIE5vbmU6CiAgICAgICAgICAgIG1pY3Jvc2Vjb25kID0gc2VsZi5taWNyb3NlY29uZAogICAgICAgIGlmIHR6aW5mbyBpcyBUcnVlOgogICAgICAgICAgICB0emluZm8gPSBzZWxmLnR6aW5mbwogICAgICAgIF9jaGVja190aW1lX2ZpZWxkcyhob3VyLCBtaW51dGUsIHNlY29uZCwgbWljcm9zZWNvbmQpCiAgICAgICAgX2NoZWNrX3R6aW5mb19hcmcodHppbmZvKQogICAgICAgIHJldHVybiB0aW1lKGhvdXIsIG1pbnV0ZSwgc2Vjb25kLCBtaWNyb3NlY29uZCwgdHppbmZvKQoKICAgIGRlZiBfX2Jvb2xfXyhzZWxmKToKICAgICAgICBpZiBzZWxmLnNlY29uZCBvciBzZWxmLm1pY3Jvc2Vjb25kOgogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIG9mZnNldCA9IHNlbGYudXRjb2Zmc2V0KCkgb3IgdGltZWRlbHRhKDApCiAgICAgICAgcmV0dXJuIHRpbWVkZWx0YShob3Vycz1zZWxmLmhvdXIsIG1pbnV0ZXM9c2VsZi5taW51dGUpICE9IG9mZnNldAoKICAgICMgUGlja2xlIHN1cHBvcnQuCgogICAgZGVmIF9nZXRzdGF0ZShzZWxmKToKICAgICAgICB1czIsIHVzMyA9IGRpdm1vZChzZWxmLl9taWNyb3NlY29uZCwgMjU2KQogICAgICAgIHVzMSwgdXMyID0gZGl2bW9kKHVzMiwgMjU2KQogICAgICAgIGJhc2VzdGF0ZSA9IGJ5dGVzKFtzZWxmLl9ob3VyLCBzZWxmLl9taW51dGUsIHNlbGYuX3NlY29uZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgdXMxLCB1czIsIHVzM10pCiAgICAgICAgaWYgc2VsZi5fdHppbmZvIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiAoYmFzZXN0YXRlLCkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gKGJhc2VzdGF0ZSwgc2VsZi5fdHppbmZvKQoKICAgIGRlZiBfX3NldHN0YXRlKHNlbGYsIHN0cmluZywgdHppbmZvKToKICAgICAgICBpZiBsZW4oc3RyaW5nKSAhPSA2IG9yIHN0cmluZ1swXSA+PSAyNDoKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJhbiBpbnRlZ2VyIGlzIHJlcXVpcmVkIikKICAgICAgICAoc2VsZi5faG91ciwgc2VsZi5fbWludXRlLCBzZWxmLl9zZWNvbmQsCiAgICAgICAgIHVzMSwgdXMyLCB1czMpID0gc3RyaW5nCiAgICAgICAgc2VsZi5fbWljcm9zZWNvbmQgPSAoKCh1czEgPDwgOCkgfCB1czIpIDw8IDgpIHwgdXMzCiAgICAgICAgaWYgdHppbmZvIGlzIE5vbmUgb3IgaXNpbnN0YW5jZSh0emluZm8sIF90emluZm9fY2xhc3MpOgogICAgICAgICAgICBzZWxmLl90emluZm8gPSB0emluZm8KICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImJhZCB0emluZm8gc3RhdGUgYXJnICVyIiAlIHR6aW5mbykKCiAgICBkZWYgX19yZWR1Y2VfXyhzZWxmKToKICAgICAgICByZXR1cm4gKHRpbWUsIHNlbGYuX2dldHN0YXRlKCkpCgpfdGltZV9jbGFzcyA9IHRpbWUgICMgc28gZnVuY3Rpb25zIHcvIGFyZ3MgbmFtZWQgInRpbWUiIGNhbiBnZXQgYXQgdGhlIGNsYXNzCgp0aW1lLm1pbiA9IHRpbWUoMCwgMCwgMCkKdGltZS5tYXggPSB0aW1lKDIzLCA1OSwgNTksIDk5OTk5OSkKdGltZS5yZXNvbHV0aW9uID0gdGltZWRlbHRhKG1pY3Jvc2Vjb25kcz0xKQoKY2xhc3MgZGF0ZXRpbWUoZGF0ZSk6CiAgICAiIiJkYXRldGltZSh5ZWFyLCBtb250aCwgZGF5WywgaG91clssIG1pbnV0ZVssIHNlY29uZFssIG1pY3Jvc2Vjb25kWyx0emluZm9dXV1dXSkKCiAgICBUaGUgeWVhciwgbW9udGggYW5kIGRheSBhcmd1bWVudHMgYXJlIHJlcXVpcmVkLiB0emluZm8gbWF5IGJlIE5vbmUsIG9yIGFuCiAgICBpbnN0YW5jZSBvZiBhIHR6aW5mbyBzdWJjbGFzcy4gVGhlIHJlbWFpbmluZyBhcmd1bWVudHMgbWF5IGJlIGludHMgb3IgbG9uZ3MuCiAgICAiIiIKCiAgICAjZml4bWUgYnJ5dGhvbgogICAgI19fc2xvdHNfXyA9IGRhdGUuX19zbG90c19fICsgKAogICAgX19zbG90c19fID0gKCdfeWVhcicsICdfbW9udGgnLCAnX2RheScsIAogICAgICAgICAgICAgICAgICdfaG91cicsJ19taW51dGUnLCdfc2Vjb25kJywnX21pY3Jvc2Vjb25kJywnX3R6aW5mbycpCiAgICBkZWYgX19uZXdfXyhjbHMsIHllYXIsIG1vbnRoPU5vbmUsIGRheT1Ob25lLCBob3VyPTAsIG1pbnV0ZT0wLCBzZWNvbmQ9MCwKICAgICAgICAgICAgICAgIG1pY3Jvc2Vjb25kPTAsIHR6aW5mbz1Ob25lKToKICAgICAgICAgICAgIAogICAgICAgIGlmIGlzaW5zdGFuY2UoeWVhciwgYnl0ZXMpIGFuZCBsZW4oeWVhcikgPT0gMTA6CiAgICAgICAgICAgICMgUGlja2xlIHN1cHBvcnQKICAgICAgICAgICAgc2VsZiA9IGRhdGUuX19uZXdfXyhjbHMsIHllYXJbOjRdKQogICAgICAgICAgICBzZWxmLl9fc2V0c3RhdGUoeWVhciwgbW9udGgpCiAgICAgICAgICAgIHJldHVybiBzZWxmCiAgICAgICAgX2NoZWNrX3R6aW5mb19hcmcodHppbmZvKQogICAgICAgIF9jaGVja190aW1lX2ZpZWxkcyhob3VyLCBtaW51dGUsIHNlY29uZCwgbWljcm9zZWNvbmQpCiAgICAgICAgI3ByaW50KGRpcihkYXRlKSkKICAgICAgICBzZWxmID0gZGF0ZS5fX25ld19fKGNscywgeWVhciwgbW9udGgsIGRheSkKICAgICAgICBzZWxmLl9ob3VyID0gaG91cgogICAgICAgIHNlbGYuX21pbnV0ZSA9IG1pbnV0ZQogICAgICAgIHNlbGYuX3NlY29uZCA9IHNlY29uZAogICAgICAgIHNlbGYuX21pY3Jvc2Vjb25kID0gbWljcm9zZWNvbmQKICAgICAgICBzZWxmLl90emluZm8gPSB0emluZm8KICAgICAgICByZXR1cm4gc2VsZgoKICAgICMgUmVhZC1vbmx5IGZpZWxkIGFjY2Vzc29ycwogICAgQHByb3BlcnR5CiAgICBkZWYgaG91cihzZWxmKToKICAgICAgICAiIiJob3VyICgwLTIzKSIiIgogICAgICAgIHJldHVybiBzZWxmLl9ob3VyCgogICAgQHByb3BlcnR5CiAgICBkZWYgbWludXRlKHNlbGYpOgogICAgICAgICIiIm1pbnV0ZSAoMC01OSkiIiIKICAgICAgICByZXR1cm4gc2VsZi5fbWludXRlCgogICAgQHByb3BlcnR5CiAgICBkZWYgc2Vjb25kKHNlbGYpOgogICAgICAgICIiInNlY29uZCAoMC01OSkiIiIKICAgICAgICByZXR1cm4gc2VsZi5fc2Vjb25kCgogICAgQHByb3BlcnR5CiAgICBkZWYgbWljcm9zZWNvbmQoc2VsZik6CiAgICAgICAgIiIibWljcm9zZWNvbmQgKDAtOTk5OTk5KSIiIgogICAgICAgIHJldHVybiBzZWxmLl9taWNyb3NlY29uZAoKICAgIEBwcm9wZXJ0eQogICAgZGVmIHR6aW5mbyhzZWxmKToKICAgICAgICAiIiJ0aW1lem9uZSBpbmZvIG9iamVjdCIiIgogICAgICAgIHJldHVybiBzZWxmLl90emluZm8KCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBmcm9tdGltZXN0YW1wKGNscywgdCwgdHo9Tm9uZSk6CiAgICAgICAgIiIiQ29uc3RydWN0IGEgZGF0ZXRpbWUgZnJvbSBhIFBPU0lYIHRpbWVzdGFtcCAobGlrZSB0aW1lLnRpbWUoKSkuCgogICAgICAgIEEgdGltZXpvbmUgaW5mbyBvYmplY3QgbWF5IGJlIHBhc3NlZCBpbiBhcyB3ZWxsLgogICAgICAgICIiIgogICAgICAgIF9jaGVja190emluZm9fYXJnKHR6KQoKICAgICAgICBjb252ZXJ0ZXIgPSBfdGltZS5sb2NhbHRpbWUgaWYgdHogaXMgTm9uZSBlbHNlIF90aW1lLmdtdGltZQoKICAgICAgICB0LCBmcmFjID0gZGl2bW9kKHQsIDEuMCkKICAgICAgICB1cyA9IHJvdW5kKGZyYWMgKiAxZTYpCgogICAgICAgICMgSWYgdGltZXN0YW1wIGlzIGxlc3MgdGhhbiBvbmUgbWljcm9zZWNvbmQgc21hbGxlciB0aGFuIGEKICAgICAgICAjIGZ1bGwgc2Vjb25kLCB1cyBjYW4gYmUgcm91bmRlZCB1cCB0byAxMDAwMDAwLiAgSW4gdGhpcyBjYXNlLAogICAgICAgICMgcm9sbCBvdmVyIHRvIHNlY29uZHMsIG90aGVyd2lzZSwgVmFsdWVFcnJvciBpcyByYWlzZWQKICAgICAgICAjIGJ5IHRoZSBjb25zdHJ1Y3Rvci4KICAgICAgICBpZiB1cyA9PSAxMDAwMDAwOgogICAgICAgICAgICB0ICs9IDEKICAgICAgICAgICAgdXMgPSAwCiAgICAgICAgeSwgbSwgZCwgaGgsIG1tLCBzcywgd2Vla2RheSwgamRheSwgZHN0ID0gY29udmVydGVyKHQpCiAgICAgICAgc3MgPSBtaW4oc3MsIDU5KSAgICAjIGNsYW1wIG91dCBsZWFwIHNlY29uZHMgaWYgdGhlIHBsYXRmb3JtIGhhcyB0aGVtCiAgICAgICAgcmVzdWx0ID0gY2xzKHksIG0sIGQsIGhoLCBtbSwgc3MsIHVzLCB0eikKICAgICAgICBpZiB0eiBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmVzdWx0ID0gdHouZnJvbXV0YyhyZXN1bHQpCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIHV0Y2Zyb210aW1lc3RhbXAoY2xzLCB0KToKICAgICAgICAiQ29uc3RydWN0IGEgVVRDIGRhdGV0aW1lIGZyb20gYSBQT1NJWCB0aW1lc3RhbXAgKGxpa2UgdGltZS50aW1lKCkpLiIKICAgICAgICB0LCBmcmFjID0gZGl2bW9kKHQsIDEuMCkKICAgICAgICB1cyA9IHJvdW5kKGZyYWMgKiAxZTYpCgogICAgICAgICMgSWYgdGltZXN0YW1wIGlzIGxlc3MgdGhhbiBvbmUgbWljcm9zZWNvbmQgc21hbGxlciB0aGFuIGEKICAgICAgICAjIGZ1bGwgc2Vjb25kLCB1cyBjYW4gYmUgcm91bmRlZCB1cCB0byAxMDAwMDAwLiAgSW4gdGhpcyBjYXNlLAogICAgICAgICMgcm9sbCBvdmVyIHRvIHNlY29uZHMsIG90aGVyd2lzZSwgVmFsdWVFcnJvciBpcyByYWlzZWQKICAgICAgICAjIGJ5IHRoZSBjb25zdHJ1Y3Rvci4KICAgICAgICBpZiB1cyA9PSAxMDAwMDAwOgogICAgICAgICAgICB0ICs9IDEKICAgICAgICAgICAgdXMgPSAwCiAgICAgICAgeSwgbSwgZCwgaGgsIG1tLCBzcywgd2Vla2RheSwgamRheSwgZHN0ID0gX3RpbWUuZ210aW1lKHQpCiAgICAgICAgc3MgPSBtaW4oc3MsIDU5KSAgICAjIGNsYW1wIG91dCBsZWFwIHNlY29uZHMgaWYgdGhlIHBsYXRmb3JtIGhhcyB0aGVtCiAgICAgICAgcmV0dXJuIGNscyh5LCBtLCBkLCBoaCwgbW0sIHNzLCB1cykKCiAgICAjIFhYWCBUaGlzIGlzIHN1cHBvc2VkIHRvIGRvIGJldHRlciB0aGFuIHdlICpjYW4qIGRvIGJ5IHVzaW5nIHRpbWUudGltZSgpLAogICAgIyBYWFggaWYgdGhlIHBsYXRmb3JtIHN1cHBvcnRzIGEgbW9yZSBhY2N1cmF0ZSB3YXkuICBUaGUgQyBpbXBsZW1lbnRhdGlvbgogICAgIyBYWFggdXNlcyBnZXR0aW1lb2ZkYXkgb24gcGxhdGZvcm1zIHRoYXQgaGF2ZSBpdCwgYnV0IHRoYXQgaXNuJ3QKICAgICMgWFhYIGF2YWlsYWJsZSBmcm9tIFB5dGhvbi4gIFNvIG5vdygpIG1heSByZXR1cm4gZGlmZmVyZW50IHJlc3VsdHMKICAgICMgWFhYIGFjcm9zcyB0aGUgaW1wbGVtZW50YXRpb25zLgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgbm93KGNscywgdHo9Tm9uZSk6CiAgICAgICAgIkNvbnN0cnVjdCBhIGRhdGV0aW1lIGZyb20gdGltZS50aW1lKCkgYW5kIG9wdGlvbmFsIHRpbWUgem9uZSBpbmZvLiIKICAgICAgICB0ID0gX3RpbWUudGltZSgpCiAgICAgICAgcmV0dXJuIGNscy5mcm9tdGltZXN0YW1wKHQsIHR6KQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIHV0Y25vdyhjbHMpOgogICAgICAgICJDb25zdHJ1Y3QgYSBVVEMgZGF0ZXRpbWUgZnJvbSB0aW1lLnRpbWUoKS4iCiAgICAgICAgdCA9IF90aW1lLnRpbWUoKQogICAgICAgIHJldHVybiBjbHMudXRjZnJvbXRpbWVzdGFtcCh0KQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIGNvbWJpbmUoY2xzLCBkYXRlLCB0aW1lKToKICAgICAgICAiQ29uc3RydWN0IGEgZGF0ZXRpbWUgZnJvbSBhIGdpdmVuIGRhdGUgYW5kIGEgZ2l2ZW4gdGltZS4iCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoZGF0ZSwgX2RhdGVfY2xhc3MpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImRhdGUgYXJndW1lbnQgbXVzdCBiZSBhIGRhdGUgaW5zdGFuY2UiKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHRpbWUsIF90aW1lX2NsYXNzKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJ0aW1lIGFyZ3VtZW50IG11c3QgYmUgYSB0aW1lIGluc3RhbmNlIikKICAgICAgICByZXR1cm4gY2xzKGRhdGUueWVhciwgZGF0ZS5tb250aCwgZGF0ZS5kYXksCiAgICAgICAgICAgICAgICAgICB0aW1lLmhvdXIsIHRpbWUubWludXRlLCB0aW1lLnNlY29uZCwgdGltZS5taWNyb3NlY29uZCwKICAgICAgICAgICAgICAgICAgIHRpbWUudHppbmZvKQoKICAgIGRlZiB0aW1ldHVwbGUoc2VsZik6CiAgICAgICAgIlJldHVybiBsb2NhbCB0aW1lIHR1cGxlIGNvbXBhdGlibGUgd2l0aCB0aW1lLmxvY2FsdGltZSgpLiIKICAgICAgICBkc3QgPSBzZWxmLmRzdCgpCiAgICAgICAgaWYgZHN0IGlzIE5vbmU6CiAgICAgICAgICAgIGRzdCA9IC0xCiAgICAgICAgZWxpZiBkc3Q6CiAgICAgICAgICAgIGRzdCA9IDEKICAgICAgICBlbHNlOgogICAgICAgICAgICBkc3QgPSAwCiAgICAgICAgcmV0dXJuIF9idWlsZF9zdHJ1Y3RfdGltZShzZWxmLnllYXIsIHNlbGYubW9udGgsIHNlbGYuZGF5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ob3VyLCBzZWxmLm1pbnV0ZSwgc2VsZi5zZWNvbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkc3QpCgogICAgZGVmIHV0Y3RpbWV0dXBsZShzZWxmKToKICAgICAgICAiUmV0dXJuIFVUQyB0aW1lIHR1cGxlIGNvbXBhdGlibGUgd2l0aCB0aW1lLmdtdGltZSgpLiIKICAgICAgICBvZmZzZXQgPSBzZWxmLnV0Y29mZnNldCgpCiAgICAgICAgaWYgb2Zmc2V0OgogICAgICAgICAgICBzZWxmIC09IG9mZnNldAogICAgICAgIHksIG0sIGQgPSBzZWxmLnllYXIsIHNlbGYubW9udGgsIHNlbGYuZGF5CiAgICAgICAgaGgsIG1tLCBzcyA9IHNlbGYuaG91ciwgc2VsZi5taW51dGUsIHNlbGYuc2Vjb25kCiAgICAgICAgcmV0dXJuIF9idWlsZF9zdHJ1Y3RfdGltZSh5LCBtLCBkLCBoaCwgbW0sIHNzLCAwKQoKICAgIGRlZiBkYXRlKHNlbGYpOgogICAgICAgICJSZXR1cm4gdGhlIGRhdGUgcGFydC4iCiAgICAgICAgcmV0dXJuIGRhdGUoc2VsZi5feWVhciwgc2VsZi5fbW9udGgsIHNlbGYuX2RheSkKCiAgICBkZWYgdGltZShzZWxmKToKICAgICAgICAiUmV0dXJuIHRoZSB0aW1lIHBhcnQsIHdpdGggdHppbmZvIE5vbmUuIgogICAgICAgIHJldHVybiB0aW1lKHNlbGYuaG91ciwgc2VsZi5taW51dGUsIHNlbGYuc2Vjb25kLCBzZWxmLm1pY3Jvc2Vjb25kKQoKICAgIGRlZiB0aW1ldHooc2VsZik6CiAgICAgICAgIlJldHVybiB0aGUgdGltZSBwYXJ0LCB3aXRoIHNhbWUgdHppbmZvLiIKICAgICAgICByZXR1cm4gdGltZShzZWxmLmhvdXIsIHNlbGYubWludXRlLCBzZWxmLnNlY29uZCwgc2VsZi5taWNyb3NlY29uZCwKICAgICAgICAgICAgICAgICAgICBzZWxmLl90emluZm8pCgogICAgZGVmIHJlcGxhY2Uoc2VsZiwgeWVhcj1Ob25lLCBtb250aD1Ob25lLCBkYXk9Tm9uZSwgaG91cj1Ob25lLAogICAgICAgICAgICAgICAgbWludXRlPU5vbmUsIHNlY29uZD1Ob25lLCBtaWNyb3NlY29uZD1Ob25lLCB0emluZm89VHJ1ZSk6CiAgICAgICAgIiIiUmV0dXJuIGEgbmV3IGRhdGV0aW1lIHdpdGggbmV3IHZhbHVlcyBmb3IgdGhlIHNwZWNpZmllZCBmaWVsZHMuIiIiCiAgICAgICAgaWYgeWVhciBpcyBOb25lOgogICAgICAgICAgICB5ZWFyID0gc2VsZi55ZWFyCiAgICAgICAgaWYgbW9udGggaXMgTm9uZToKICAgICAgICAgICAgbW9udGggPSBzZWxmLm1vbnRoCiAgICAgICAgaWYgZGF5IGlzIE5vbmU6CiAgICAgICAgICAgIGRheSA9IHNlbGYuZGF5CiAgICAgICAgaWYgaG91ciBpcyBOb25lOgogICAgICAgICAgICBob3VyID0gc2VsZi5ob3VyCiAgICAgICAgaWYgbWludXRlIGlzIE5vbmU6CiAgICAgICAgICAgIG1pbnV0ZSA9IHNlbGYubWludXRlCiAgICAgICAgaWYgc2Vjb25kIGlzIE5vbmU6CiAgICAgICAgICAgIHNlY29uZCA9IHNlbGYuc2Vjb25kCiAgICAgICAgaWYgbWljcm9zZWNvbmQgaXMgTm9uZToKICAgICAgICAgICAgbWljcm9zZWNvbmQgPSBzZWxmLm1pY3Jvc2Vjb25kCiAgICAgICAgaWYgdHppbmZvIGlzIFRydWU6CiAgICAgICAgICAgIHR6aW5mbyA9IHNlbGYudHppbmZvCiAgICAgICAgX2NoZWNrX2RhdGVfZmllbGRzKHllYXIsIG1vbnRoLCBkYXkpCiAgICAgICAgX2NoZWNrX3RpbWVfZmllbGRzKGhvdXIsIG1pbnV0ZSwgc2Vjb25kLCBtaWNyb3NlY29uZCkKICAgICAgICBfY2hlY2tfdHppbmZvX2FyZyh0emluZm8pCiAgICAgICAgcmV0dXJuIGRhdGV0aW1lKHllYXIsIG1vbnRoLCBkYXksIGhvdXIsIG1pbnV0ZSwgc2Vjb25kLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1pY3Jvc2Vjb25kLCB0emluZm8pCgogICAgZGVmIGFzdGltZXpvbmUoc2VsZiwgdHopOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHR6LCB0emluZm8pOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoInR6IGFyZ3VtZW50IG11c3QgYmUgYW4gaW5zdGFuY2Ugb2YgdHppbmZvIikKCiAgICAgICAgbXl0eiA9IHNlbGYudHppbmZvCiAgICAgICAgaWYgbXl0eiBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJhc3RpbWV6b25lKCkgcmVxdWlyZXMgYW4gYXdhcmUgZGF0ZXRpbWUiKQoKICAgICAgICBpZiB0eiBpcyBteXR6OgogICAgICAgICAgICByZXR1cm4gc2VsZgoKICAgICAgICAjIENvbnZlcnQgc2VsZiB0byBVVEMsIGFuZCBhdHRhY2ggdGhlIG5ldyB0aW1lIHpvbmUgb2JqZWN0LgogICAgICAgIG15b2Zmc2V0ID0gc2VsZi51dGNvZmZzZXQoKQogICAgICAgIGlmIG15b2Zmc2V0IGlzIE5vbmU6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImFzdGltZXpvbmUoKSByZXF1aXJlcyBhbiBhd2FyZSBkYXRldGltZSIpCiAgICAgICAgdXRjID0gKHNlbGYgLSBteW9mZnNldCkucmVwbGFjZSh0emluZm89dHopCgogICAgICAgICMgQ29udmVydCBmcm9tIFVUQyB0byB0eidzIGxvY2FsIHRpbWUuCiAgICAgICAgcmV0dXJuIHR6LmZyb211dGModXRjKQoKICAgICMgV2F5cyB0byBwcm9kdWNlIGEgc3RyaW5nLgoKICAgIGRlZiBjdGltZShzZWxmKToKICAgICAgICAiUmV0dXJuIGN0aW1lKCkgc3R5bGUgc3RyaW5nLiIKICAgICAgICB3ZWVrZGF5ID0gc2VsZi50b29yZGluYWwoKSAlIDcgb3IgNwogICAgICAgIHJldHVybiAiJXMgJXMgJTJkICUwMmQ6JTAyZDolMDJkICUwNGQiICUgKAogICAgICAgICAgICBfREFZTkFNRVNbd2Vla2RheV0sCiAgICAgICAgICAgIF9NT05USE5BTUVTW3NlbGYuX21vbnRoXSwKICAgICAgICAgICAgc2VsZi5fZGF5LAogICAgICAgICAgICBzZWxmLl9ob3VyLCBzZWxmLl9taW51dGUsIHNlbGYuX3NlY29uZCwKICAgICAgICAgICAgc2VsZi5feWVhcikKCiAgICBkZWYgaXNvZm9ybWF0KHNlbGYsIHNlcD0nVCcpOgogICAgICAgICIiIlJldHVybiB0aGUgdGltZSBmb3JtYXR0ZWQgYWNjb3JkaW5nIHRvIElTTy4KCiAgICAgICAgVGhpcyBpcyAnWVlZWS1NTS1ERCBISDpNTTpTUy5tbW1tbW0nLCBvciAnWVlZWS1NTS1ERCBISDpNTTpTUycgaWYKICAgICAgICBzZWxmLm1pY3Jvc2Vjb25kID09IDAuCgogICAgICAgIElmIHNlbGYudHppbmZvIGlzIG5vdCBOb25lLCB0aGUgVVRDIG9mZnNldCBpcyBhbHNvIGF0dGFjaGVkLCBnaXZpbmcKICAgICAgICAnWVlZWS1NTS1ERCBISDpNTTpTUy5tbW1tbW0rSEg6TU0nIG9yICdZWVlZLU1NLUREIEhIOk1NOlNTK0hIOk1NJy4KCiAgICAgICAgT3B0aW9uYWwgYXJndW1lbnQgc2VwIHNwZWNpZmllcyB0aGUgc2VwYXJhdG9yIGJldHdlZW4gZGF0ZSBhbmQKICAgICAgICB0aW1lLCBkZWZhdWx0ICdUJy4KICAgICAgICAiIiIKICAgICAgICBzID0gKCIlMDRkLSUwMmQtJTAyZCVjIiAlIChzZWxmLl95ZWFyLCBzZWxmLl9tb250aCwgc2VsZi5fZGF5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VwKSArCiAgICAgICAgICAgICAgICBfZm9ybWF0X3RpbWUoc2VsZi5faG91ciwgc2VsZi5fbWludXRlLCBzZWxmLl9zZWNvbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fbWljcm9zZWNvbmQpKQogICAgICAgIG9mZiA9IHNlbGYudXRjb2Zmc2V0KCkKICAgICAgICBpZiBvZmYgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGlmIG9mZi5kYXlzIDwgMDoKICAgICAgICAgICAgICAgIHNpZ24gPSAiLSIKICAgICAgICAgICAgICAgIG9mZiA9IC1vZmYKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNpZ24gPSAiKyIKICAgICAgICAgICAgaGgsIG1tID0gZGl2bW9kKG9mZiwgdGltZWRlbHRhKGhvdXJzPTEpKQogICAgICAgICAgICBhc3NlcnQgbm90IG1tICUgdGltZWRlbHRhKG1pbnV0ZXM9MSksICJ3aG9sZSBtaW51dGUiCiAgICAgICAgICAgIG1tIC8vPSB0aW1lZGVsdGEobWludXRlcz0xKQogICAgICAgICAgICBzICs9ICIlcyUwMmQ6JTAyZCIgJSAoc2lnbiwgaGgsIG1tKQogICAgICAgIHJldHVybiBzCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgICIiIkNvbnZlcnQgdG8gZm9ybWFsIHN0cmluZywgZm9yIHJlcHIoKS4iIiIKICAgICAgICBMID0gW3NlbGYuX3llYXIsIHNlbGYuX21vbnRoLCBzZWxmLl9kYXksICMgVGhlc2UgYXJlIG5ldmVyIHplcm8KICAgICAgICAgICAgIHNlbGYuX2hvdXIsIHNlbGYuX21pbnV0ZSwgc2VsZi5fc2Vjb25kLCBzZWxmLl9taWNyb3NlY29uZF0KICAgICAgICBpZiBMWy0xXSA9PSAwOgogICAgICAgICAgICBkZWwgTFstMV0KICAgICAgICBpZiBMWy0xXSA9PSAwOgogICAgICAgICAgICBkZWwgTFstMV0KICAgICAgICBzID0gIiwgIi5qb2luKG1hcChzdHIsIEwpKQogICAgICAgIHMgPSAiJXMoJXMpIiAlICgnZGF0ZXRpbWUuJyArIHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLCBzKQogICAgICAgIGlmIHNlbGYuX3R6aW5mbyBpcyBub3QgTm9uZToKICAgICAgICAgICAgYXNzZXJ0IHNbLTE6XSA9PSAiKSIKICAgICAgICAgICAgcyA9IHNbOi0xXSArICIsIHR6aW5mbz0lciIgJSBzZWxmLl90emluZm8gKyAiKSIKICAgICAgICByZXR1cm4gcwoKICAgIGRlZiBfX3N0cl9fKHNlbGYpOgogICAgICAgICJDb252ZXJ0IHRvIHN0cmluZywgZm9yIHN0cigpLiIKICAgICAgICByZXR1cm4gc2VsZi5pc29mb3JtYXQoc2VwPScgJykKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBzdHJwdGltZShjbHMsIGRhdGVfc3RyaW5nLCBmb3JtYXQpOgogICAgICAgICdzdHJpbmcsIGZvcm1hdCAtPiBuZXcgZGF0ZXRpbWUgcGFyc2VkIGZyb20gYSBzdHJpbmcgKGxpa2UgdGltZS5zdHJwdGltZSgpKS4nCiAgICAgICAgaW1wb3J0IF9zdHJwdGltZQogICAgICAgIHJldHVybiBfc3RycHRpbWUuX3N0cnB0aW1lX2RhdGV0aW1lKGNscywgZGF0ZV9zdHJpbmcsIGZvcm1hdCkKCiAgICBkZWYgdXRjb2Zmc2V0KHNlbGYpOgogICAgICAgICIiIlJldHVybiB0aGUgdGltZXpvbmUgb2Zmc2V0IGluIG1pbnV0ZXMgZWFzdCBvZiBVVEMgKG5lZ2F0aXZlIHdlc3Qgb2YKICAgICAgICBVVEMpLiIiIgogICAgICAgIGlmIHNlbGYuX3R6aW5mbyBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIG9mZnNldCA9IHNlbGYuX3R6aW5mby51dGNvZmZzZXQoc2VsZikKICAgICAgICBfY2hlY2tfdXRjX29mZnNldCgidXRjb2Zmc2V0Iiwgb2Zmc2V0KQogICAgICAgIHJldHVybiBvZmZzZXQKCiAgICBkZWYgdHpuYW1lKHNlbGYpOgogICAgICAgICIiIlJldHVybiB0aGUgdGltZXpvbmUgbmFtZS4KCiAgICAgICAgTm90ZSB0aGF0IHRoZSBuYW1lIGlzIDEwMCUgaW5mb3JtYXRpb25hbCAtLSB0aGVyZSdzIG5vIHJlcXVpcmVtZW50IHRoYXQKICAgICAgICBpdCBtZWFuIGFueXRoaW5nIGluIHBhcnRpY3VsYXIuIEZvciBleGFtcGxlLCAiR01UIiwgIlVUQyIsICItNTAwIiwKICAgICAgICAiLTU6MDAiLCAiRURUIiwgIlVTL0Vhc3Rlcm4iLCAiQW1lcmljYS9OZXcgWW9yayIgYXJlIGFsbCB2YWxpZCByZXBsaWVzLgogICAgICAgICIiIgogICAgICAgIG5hbWUgPSBfY2FsbF90emluZm9fbWV0aG9kKHNlbGYuX3R6aW5mbywgInR6bmFtZSIsIHNlbGYpCiAgICAgICAgX2NoZWNrX3R6bmFtZShuYW1lKQogICAgICAgIHJldHVybiBuYW1lCgogICAgZGVmIGRzdChzZWxmKToKICAgICAgICAiIiJSZXR1cm4gMCBpZiBEU1QgaXMgbm90IGluIGVmZmVjdCwgb3IgdGhlIERTVCBvZmZzZXQgKGluIG1pbnV0ZXMKICAgICAgICBlYXN0d2FyZCkgaWYgRFNUIGlzIGluIGVmZmVjdC4KCiAgICAgICAgVGhpcyBpcyBwdXJlbHkgaW5mb3JtYXRpb25hbDsgdGhlIERTVCBvZmZzZXQgaGFzIGFscmVhZHkgYmVlbiBhZGRlZCB0bwogICAgICAgIHRoZSBVVEMgb2Zmc2V0IHJldHVybmVkIGJ5IHV0Y29mZnNldCgpIGlmIGFwcGxpY2FibGUsIHNvIHRoZXJlJ3Mgbm8KICAgICAgICBuZWVkIHRvIGNvbnN1bHQgZHN0KCkgdW5sZXNzIHlvdSdyZSBpbnRlcmVzdGVkIGluIGRpc3BsYXlpbmcgdGhlIERTVAogICAgICAgIGluZm8uCiAgICAgICAgIiIiCiAgICAgICAgaWYgc2VsZi5fdHppbmZvIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgb2Zmc2V0ID0gc2VsZi5fdHppbmZvLmRzdChzZWxmKQogICAgICAgIF9jaGVja191dGNfb2Zmc2V0KCJkc3QiLCBvZmZzZXQpCiAgICAgICAgcmV0dXJuIG9mZnNldAoKICAgICMgQ29tcGFyaXNvbnMgb2YgZGF0ZXRpbWUgb2JqZWN0cyB3aXRoIG90aGVyLgoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIGRhdGV0aW1lKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NtcChvdGhlcikgPT0gMAogICAgICAgIGVsaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIGRhdGUpOgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgX19uZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkYXRldGltZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpICE9IDAKICAgICAgICBlbGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBkYXRlKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgX19sZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkYXRldGltZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpIDw9IDAKICAgICAgICBlbGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBkYXRlKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgZWxzZToKICAgICAgICAgICAgX2NtcGVycm9yKHNlbGYsIG90aGVyKQoKICAgIGRlZiBfX2x0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIGRhdGV0aW1lKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NtcChvdGhlcikgPCAwCiAgICAgICAgZWxpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgZGF0ZSk6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIF9jbXBlcnJvcihzZWxmLCBvdGhlcikKCiAgICBkZWYgX19nZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkYXRldGltZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpID49IDAKICAgICAgICBlbGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBkYXRlKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgZWxzZToKICAgICAgICAgICAgX2NtcGVycm9yKHNlbGYsIG90aGVyKQoKICAgIGRlZiBfX2d0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIGRhdGV0aW1lKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NtcChvdGhlcikgPiAwCiAgICAgICAgZWxpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgZGF0ZSk6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIF9jbXBlcnJvcihzZWxmLCBvdGhlcikKCiAgICBkZWYgX2NtcChzZWxmLCBvdGhlcik6CiAgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2Uob3RoZXIsIGRhdGV0aW1lKQogICAgICAgIG15dHogPSBzZWxmLl90emluZm8KICAgICAgICBvdHR6ID0gb3RoZXIuX3R6aW5mbwogICAgICAgIG15b2ZmID0gb3RvZmYgPSBOb25lCgogICAgICAgIGlmIG15dHogaXMgb3R0ejoKICAgICAgICAgICAgYmFzZV9jb21wYXJlID0gVHJ1ZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIG15dHogaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBteW9mZiA9IHNlbGYudXRjb2Zmc2V0KCkKICAgICAgICAgICAgaWYgb3R0eiBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIG90b2ZmID0gb3RoZXIudXRjb2Zmc2V0KCkKICAgICAgICAgICAgYmFzZV9jb21wYXJlID0gbXlvZmYgPT0gb3RvZmYKCiAgICAgICAgaWYgYmFzZV9jb21wYXJlOgogICAgICAgICAgICAjZml4bWUgYnJ5dGhvbgogICAgICAgICAgICAjcmV0dXJuIF9jbXAoKHNlbGYuX3llYXIsIHNlbGYuX21vbnRoLCBzZWxmLl9kYXksCiAgICAgICAgICAgICMgICAgICAgICAgICAgc2VsZi5faG91ciwgc2VsZi5fbWludXRlLCBzZWxmLl9zZWNvbmQsCiAgICAgICAgICAgICMgICAgICAgICAgICAgc2VsZi5fbWljcm9zZWNvbmQpLAogICAgICAgICAgICAjICAgICAgICAgICAob3RoZXIuX3llYXIsIG90aGVyLl9tb250aCwgb3RoZXIuX2RheSwKICAgICAgICAgICAgIyAgICAgICAgICAgIG90aGVyLl9ob3VyLCBvdGhlci5fbWludXRlLCBvdGhlci5fc2Vjb25kLAogICAgICAgICAgICAjICAgICAgICAgICAgb3RoZXIuX21pY3Jvc2Vjb25kKSkKICAgICAgICAgICAgcmV0dXJuIF90dXBsZV9jbXAoKHNlbGYuX3llYXIsIHNlbGYuX21vbnRoLCBzZWxmLl9kYXksCiAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9ob3VyLCBzZWxmLl9taW51dGUsIHNlbGYuX3NlY29uZCwKICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX21pY3Jvc2Vjb25kKSwKICAgICAgICAgICAgICAgICAgICAgICAob3RoZXIuX3llYXIsIG90aGVyLl9tb250aCwgb3RoZXIuX2RheSwKICAgICAgICAgICAgICAgICAgICAgICAgb3RoZXIuX2hvdXIsIG90aGVyLl9taW51dGUsIG90aGVyLl9zZWNvbmQsCiAgICAgICAgICAgICAgICAgICAgICAgIG90aGVyLl9taWNyb3NlY29uZCkpCiAgICAgICAgaWYgbXlvZmYgaXMgTm9uZSBvciBvdG9mZiBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImNhbm5vdCBjb21wYXJlIG5haXZlIGFuZCBhd2FyZSBkYXRldGltZXMiKQogICAgICAgICMgWFhYIFdoYXQgZm9sbG93cyBjb3VsZCBiZSBkb25lIG1vcmUgZWZmaWNpZW50bHkuLi4KICAgICAgICBkaWZmID0gc2VsZiAtIG90aGVyICAgICAjIHRoaXMgd2lsbCB0YWtlIG9mZnNldHMgaW50byBhY2NvdW50CiAgICAgICAgaWYgZGlmZi5kYXlzIDwgMDoKICAgICAgICAgICAgcmV0dXJuIC0xCiAgICAgICAgcmV0dXJuIGRpZmYgYW5kIDEgb3IgMAoKICAgIGRlZiBfX2FkZF9fKHNlbGYsIG90aGVyKToKICAgICAgICAiQWRkIGEgZGF0ZXRpbWUgYW5kIGEgdGltZWRlbHRhLiIKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgdGltZWRlbHRhKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgZGVsdGEgPSB0aW1lZGVsdGEoc2VsZi50b29yZGluYWwoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICBob3Vycz1zZWxmLl9ob3VyLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1pbnV0ZXM9c2VsZi5fbWludXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZHM9c2VsZi5fc2Vjb25kLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1pY3Jvc2Vjb25kcz1zZWxmLl9taWNyb3NlY29uZCkKICAgICAgICBkZWx0YSArPSBvdGhlcgogICAgICAgIGhvdXIsIHJlbSA9IGRpdm1vZChkZWx0YS5zZWNvbmRzLCAzNjAwKQogICAgICAgIG1pbnV0ZSwgc2Vjb25kID0gZGl2bW9kKHJlbSwgNjApCiAgICAgICAgaWYgMCA8IGRlbHRhLmRheXMgPD0gX01BWE9SRElOQUw6CiAgICAgICAgICAgIHJldHVybiBkYXRldGltZS5jb21iaW5lKGRhdGUuZnJvbW9yZGluYWwoZGVsdGEuZGF5cyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWUoaG91ciwgbWludXRlLCBzZWNvbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGEubWljcm9zZWNvbmRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR6aW5mbz1zZWxmLl90emluZm8pKQogICAgICAgIHJhaXNlIE92ZXJmbG93RXJyb3IoInJlc3VsdCBvdXQgb2YgcmFuZ2UiKQoKICAgIF9fcmFkZF9fID0gX19hZGRfXwoKICAgIGRlZiBfX3N1Yl9fKHNlbGYsIG90aGVyKToKICAgICAgICAiU3VidHJhY3QgdHdvIGRhdGV0aW1lcywgb3IgYSBkYXRldGltZSBhbmQgYSB0aW1lZGVsdGEuIgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBkYXRldGltZSk6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHRpbWVkZWx0YSk6CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZiArIC1vdGhlcgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICAgICAgZGF5czEgPSBzZWxmLnRvb3JkaW5hbCgpCiAgICAgICAgZGF5czIgPSBvdGhlci50b29yZGluYWwoKQogICAgICAgIHNlY3MxID0gc2VsZi5fc2Vjb25kICsgc2VsZi5fbWludXRlICogNjAgKyBzZWxmLl9ob3VyICogMzYwMAogICAgICAgIHNlY3MyID0gb3RoZXIuX3NlY29uZCArIG90aGVyLl9taW51dGUgKiA2MCArIG90aGVyLl9ob3VyICogMzYwMAogICAgICAgIGJhc2UgPSB0aW1lZGVsdGEoZGF5czEgLSBkYXlzMiwKICAgICAgICAgICAgICAgICAgICAgICAgIHNlY3MxIC0gc2VjczIsCiAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9taWNyb3NlY29uZCAtIG90aGVyLl9taWNyb3NlY29uZCkKICAgICAgICBpZiBzZWxmLl90emluZm8gaXMgb3RoZXIuX3R6aW5mbzoKICAgICAgICAgICAgcmV0dXJuIGJhc2UKICAgICAgICBteW9mZiA9IHNlbGYudXRjb2Zmc2V0KCkKICAgICAgICBvdG9mZiA9IG90aGVyLnV0Y29mZnNldCgpCiAgICAgICAgaWYgbXlvZmYgPT0gb3RvZmY6CiAgICAgICAgICAgIHJldHVybiBiYXNlCiAgICAgICAgaWYgbXlvZmYgaXMgTm9uZSBvciBvdG9mZiBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImNhbm5vdCBtaXggbmFpdmUgYW5kIHRpbWV6b25lLWF3YXJlIHRpbWUiKQogICAgICAgIHJldHVybiBiYXNlICsgb3RvZmYgLSBteW9mZgoKICAgIGRlZiBfX2hhc2hfXyhzZWxmKToKICAgICAgICB0em9mZiA9IHNlbGYudXRjb2Zmc2V0KCkKICAgICAgICBpZiB0em9mZiBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gaGFzaChzZWxmLl9nZXRzdGF0ZSgpWzBdKQogICAgICAgIGRheXMgPSBfeW1kMm9yZChzZWxmLnllYXIsIHNlbGYubW9udGgsIHNlbGYuZGF5KQogICAgICAgIHNlY29uZHMgPSBzZWxmLmhvdXIgKiAzNjAwICsgc2VsZi5taW51dGUgKiA2MCArIHNlbGYuc2Vjb25kCiAgICAgICAgcmV0dXJuIGhhc2godGltZWRlbHRhKGRheXMsIHNlY29uZHMsIHNlbGYubWljcm9zZWNvbmQpIC0gdHpvZmYpCgogICAgIyBQaWNrbGUgc3VwcG9ydC4KCiAgICBkZWYgX2dldHN0YXRlKHNlbGYpOgogICAgICAgIHloaSwgeWxvID0gZGl2bW9kKHNlbGYuX3llYXIsIDI1NikKICAgICAgICB1czIsIHVzMyA9IGRpdm1vZChzZWxmLl9taWNyb3NlY29uZCwgMjU2KQogICAgICAgIHVzMSwgdXMyID0gZGl2bW9kKHVzMiwgMjU2KQogICAgICAgIGJhc2VzdGF0ZSA9IGJ5dGVzKFt5aGksIHlsbywgc2VsZi5fbW9udGgsIHNlbGYuX2RheSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5faG91ciwgc2VsZi5fbWludXRlLCBzZWxmLl9zZWNvbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzMSwgdXMyLCB1czNdKQogICAgICAgIGlmIHNlbGYuX3R6aW5mbyBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gKGJhc2VzdGF0ZSwpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIChiYXNlc3RhdGUsIHNlbGYuX3R6aW5mbykKCiAgICBkZWYgX19zZXRzdGF0ZShzZWxmLCBzdHJpbmcsIHR6aW5mbyk6CiAgICAgICAgKHloaSwgeWxvLCBzZWxmLl9tb250aCwgc2VsZi5fZGF5LCBzZWxmLl9ob3VyLAogICAgICAgICBzZWxmLl9taW51dGUsIHNlbGYuX3NlY29uZCwgdXMxLCB1czIsIHVzMykgPSBzdHJpbmcKICAgICAgICBzZWxmLl95ZWFyID0geWhpICogMjU2ICsgeWxvCiAgICAgICAgc2VsZi5fbWljcm9zZWNvbmQgPSAoKCh1czEgPDwgOCkgfCB1czIpIDw8IDgpIHwgdXMzCiAgICAgICAgaWYgdHppbmZvIGlzIE5vbmUgb3IgaXNpbnN0YW5jZSh0emluZm8sIF90emluZm9fY2xhc3MpOgogICAgICAgICAgICBzZWxmLl90emluZm8gPSB0emluZm8KICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImJhZCB0emluZm8gc3RhdGUgYXJnICVyIiAlIHR6aW5mbykKCiAgICBkZWYgX19yZWR1Y2VfXyhzZWxmKToKICAgICAgICByZXR1cm4gKHNlbGYuX19jbGFzc19fLCBzZWxmLl9nZXRzdGF0ZSgpKQoKI2ZpeG1lIGJyeXRob24KI2RhdGV0aW1lLm1pbiA9IGRhdGV0aW1lKDEsIDEsIDEpCiNkYXRldGltZS5tYXggPSBkYXRldGltZSg5OTk5LCAxMiwgMzEsIDIzLCA1OSwgNTksIDk5OTk5OSkKI2RhdGV0aW1lLnJlc29sdXRpb24gPSB0aW1lZGVsdGEobWljcm9zZWNvbmRzPTEpCgoKZGVmIF9pc293ZWVrMW1vbmRheSh5ZWFyKToKICAgICMgSGVscGVyIHRvIGNhbGN1bGF0ZSB0aGUgZGF5IG51bWJlciBvZiB0aGUgTW9uZGF5IHN0YXJ0aW5nIHdlZWsgMQogICAgIyBYWFggVGhpcyBjb3VsZCBiZSBkb25lIG1vcmUgZWZmaWNpZW50bHkKICAgIFRIVVJTREFZID0gMwogICAgZmlyc3RkYXkgPSBfeW1kMm9yZCh5ZWFyLCAxLCAxKQogICAgZmlyc3R3ZWVrZGF5ID0gKGZpcnN0ZGF5ICsgNikgJSA3ICMgU2VlIHdlZWtkYXkoKSBhYm92ZQogICAgd2VlazFtb25kYXkgPSBmaXJzdGRheSAtIGZpcnN0d2Vla2RheQogICAgaWYgZmlyc3R3ZWVrZGF5ID4gVEhVUlNEQVk6CiAgICAgICAgd2VlazFtb25kYXkgKz0gNwogICAgcmV0dXJuIHdlZWsxbW9uZGF5CgpjbGFzcyB0aW1lem9uZSh0emluZm8pOgogICAgX19zbG90c19fID0gJ19vZmZzZXQnLCAnX25hbWUnCgogICAgIyBTZW50aW5lbCB2YWx1ZSB0byBkaXNhbGxvdyBOb25lCiAgICBfT21pdHRlZCA9IG9iamVjdCgpCiAgICAjZml4bWUgYnJ5dGhvbgogICAgI2RlZiBfX25ld19fKGNscywgb2Zmc2V0LCBuYW1lPV9PbWl0dGVkKToKICAgIGRlZiBfX25ld19fKGNscywgb2Zmc2V0LCBuYW1lPU5vbmUpOgogICAgICAgIGlmIG5hbWUgaXMgTm9uZToKICAgICAgICAgICBuYW1lPV9PbWl0dGVkCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob2Zmc2V0LCB0aW1lZGVsdGEpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIm9mZnNldCBtdXN0IGJlIGEgdGltZWRlbHRhIikKICAgICAgICBpZiBuYW1lIGlzIGNscy5fT21pdHRlZDoKICAgICAgICAgICAgaWYgbm90IG9mZnNldDoKICAgICAgICAgICAgICAgIHJldHVybiBjbHMudXRjCiAgICAgICAgICAgIG5hbWUgPSBOb25lCiAgICAgICAgZWxpZiBub3QgaXNpbnN0YW5jZShuYW1lLCBzdHIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIm5hbWUgbXVzdCBiZSBhIHN0cmluZyIpCiAgICAgICAgaWYgbm90IGNscy5fbWlub2Zmc2V0IDw9IG9mZnNldCA8PSBjbHMuX21heG9mZnNldDoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigib2Zmc2V0IG11c3QgYmUgYSB0aW1lZGVsdGEiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBzdHJpY3RseSBiZXR3ZWVuIC10aW1lZGVsdGEoaG91cnM9MjQpIGFuZCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIHRpbWVkZWx0YShob3Vycz0yNCkuIikKICAgICAgICBpZiAob2Zmc2V0Lm1pY3Jvc2Vjb25kcyAhPSAwIG9yCiAgICAgICAgICAgIG9mZnNldC5zZWNvbmRzICUgNjAgIT0gMCk6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIm9mZnNldCBtdXN0IGJlIGEgdGltZWRlbHRhIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgcmVwcmVzZW50aW5nIGEgd2hvbGUgbnVtYmVyIG9mIG1pbnV0ZXMiKQogICAgICAgIHJldHVybiBjbHMuX2NyZWF0ZShvZmZzZXQsIG5hbWUpCgogICAgI0BjbGFzc21ldGhvZAogICAgZGVmIF9jcmVhdGUoY2xzLCBvZmZzZXQsIG5hbWU9Tm9uZSk6CiAgICAgICAgc2VsZiA9IHR6aW5mby5fX25ld19fKGNscykKICAgICAgICBzZWxmLl9vZmZzZXQgPSBvZmZzZXQKICAgICAgICBzZWxmLl9uYW1lID0gbmFtZQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fZ2V0aW5pdGFyZ3NfXyhzZWxmKToKICAgICAgICAiIiJwaWNrbGUgc3VwcG9ydCIiIgogICAgICAgIGlmIHNlbGYuX25hbWUgaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIChzZWxmLl9vZmZzZXQsKQogICAgICAgIHJldHVybiAoc2VsZi5fb2Zmc2V0LCBzZWxmLl9uYW1lKQoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIHR5cGUob3RoZXIpICE9IHRpbWV6b25lOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICByZXR1cm4gc2VsZi5fb2Zmc2V0ID09IG90aGVyLl9vZmZzZXQKCiAgICBkZWYgX19oYXNoX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGhhc2goc2VsZi5fb2Zmc2V0KQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICAiIiJDb252ZXJ0IHRvIGZvcm1hbCBzdHJpbmcsIGZvciByZXByKCkuCgogICAgICAgID4+PiB0eiA9IHRpbWV6b25lLnV0YwogICAgICAgID4+PiByZXByKHR6KQogICAgICAgICdkYXRldGltZS50aW1lem9uZS51dGMnCiAgICAgICAgPj4+IHR6ID0gdGltZXpvbmUodGltZWRlbHRhKGhvdXJzPS01KSwgJ0VTVCcpCiAgICAgICAgPj4+IHJlcHIodHopCiAgICAgICAgImRhdGV0aW1lLnRpbWV6b25lKGRhdGV0aW1lLnRpbWVkZWx0YSgtMSwgNjg0MDApLCAnRVNUJykiCiAgICAgICAgIiIiCiAgICAgICAgaWYgc2VsZiBpcyBzZWxmLnV0YzoKICAgICAgICAgICAgcmV0dXJuICdkYXRldGltZS50aW1lem9uZS51dGMnCiAgICAgICAgaWYgc2VsZi5fbmFtZSBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gIiVzKCVyKSIgJSAoJ2RhdGV0aW1lLicgKyBzZWxmLl9fY2xhc3NfXy5fX25hbWVfXywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX29mZnNldCkKICAgICAgICByZXR1cm4gIiVzKCVyLCAlcikiICUgKCdkYXRldGltZS4nICsgc2VsZi5fX2NsYXNzX18uX19uYW1lX18sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9vZmZzZXQsIHNlbGYuX25hbWUpCgogICAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYudHpuYW1lKE5vbmUpCgogICAgZGVmIHV0Y29mZnNldChzZWxmLCBkdCk6CiAgICAgICAgaWYgaXNpbnN0YW5jZShkdCwgZGF0ZXRpbWUpIG9yIGR0IGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9vZmZzZXQKICAgICAgICByYWlzZSBUeXBlRXJyb3IoInV0Y29mZnNldCgpIGFyZ3VtZW50IG11c3QgYmUgYSBkYXRldGltZSBpbnN0YW5jZSIKICAgICAgICAgICAgICAgICAgICAgICAgIiBvciBOb25lIikKCiAgICBkZWYgdHpuYW1lKHNlbGYsIGR0KToKICAgICAgICBpZiBpc2luc3RhbmNlKGR0LCBkYXRldGltZSkgb3IgZHQgaXMgTm9uZToKICAgICAgICAgICAgaWYgc2VsZi5fbmFtZSBpcyBOb25lOgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX25hbWVfZnJvbV9vZmZzZXQoc2VsZi5fb2Zmc2V0KQogICAgICAgICAgICByZXR1cm4gc2VsZi5fbmFtZQogICAgICAgIHJhaXNlIFR5cGVFcnJvcigidHpuYW1lKCkgYXJndW1lbnQgbXVzdCBiZSBhIGRhdGV0aW1lIGluc3RhbmNlIgogICAgICAgICAgICAgICAgICAgICAgICAiIG9yIE5vbmUiKQoKICAgIGRlZiBkc3Qoc2VsZiwgZHQpOgogICAgICAgIGlmIGlzaW5zdGFuY2UoZHQsIGRhdGV0aW1lKSBvciBkdCBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiZHN0KCkgYXJndW1lbnQgbXVzdCBiZSBhIGRhdGV0aW1lIGluc3RhbmNlIgogICAgICAgICAgICAgICAgICAgICAgICAiIG9yIE5vbmUiKQoKICAgIGRlZiBmcm9tdXRjKHNlbGYsIGR0KToKICAgICAgICBpZiBpc2luc3RhbmNlKGR0LCBkYXRldGltZSk6CiAgICAgICAgICAgIGlmIGR0LnR6aW5mbyBpcyBub3Qgc2VsZjoKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImZyb211dGM6IGR0LnR6aW5mbyAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJpcyBub3Qgc2VsZiIpCiAgICAgICAgICAgIHJldHVybiBkdCArIHNlbGYuX29mZnNldAogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiZnJvbXV0YygpIGFyZ3VtZW50IG11c3QgYmUgYSBkYXRldGltZSBpbnN0YW5jZSIKICAgICAgICAgICAgICAgICAgICAgICAgIiBvciBOb25lIikKCiAgICAjX21heG9mZnNldCA9IHRpbWVkZWx0YShob3Vycz0yMywgbWludXRlcz01OSkKICAgICNfbWlub2Zmc2V0ID0gLV9tYXhvZmZzZXQKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX25hbWVfZnJvbV9vZmZzZXQoZGVsdGEpOgogICAgICAgIGlmIGRlbHRhIDwgdGltZWRlbHRhKDApOgogICAgICAgICAgICBzaWduID0gJy0nCiAgICAgICAgICAgIGRlbHRhID0gLWRlbHRhCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2lnbiA9ICcrJwogICAgICAgIGhvdXJzLCByZXN0ID0gZGl2bW9kKGRlbHRhLCB0aW1lZGVsdGEoaG91cnM9MSkpCiAgICAgICAgbWludXRlcyA9IHJlc3QgLy8gdGltZWRlbHRhKG1pbnV0ZXM9MSkKICAgICAgICByZXR1cm4gJ1VUQ3t9ezowMmR9Ons6MDJkfScuZm9ybWF0KHNpZ24sIGhvdXJzLCBtaW51dGVzKQoKI2ZpeG1lIGJyeXRob24KI3RpbWV6b25lLnV0YyA9IHRpbWV6b25lLl9jcmVhdGUodGltZWRlbHRhKDApKQojdGltZXpvbmUubWluID0gdGltZXpvbmUuX2NyZWF0ZSh0aW1lem9uZS5fbWlub2Zmc2V0KQojdGltZXpvbmUubWF4ID0gdGltZXpvbmUuX2NyZWF0ZSh0aW1lem9uZS5fbWF4b2Zmc2V0KQoK',
'/Lib/dis.py':'ZGVmIGRpcyhzcmMpOgogICAgcmV0dXJuIEpTT2JqZWN0KF9fQlJZVEhPTl9fLnB5MmpzKHNyYykpLnRvX2pzKCkK',
'/Lib/errno.py':'IlRoaXMgbW9kdWxlIG1ha2VzIGF2YWlsYWJsZSBzdGFuZGFyZCBlcnJubyBzeXN0ZW0gc3ltYm9scy5cblxuVGhlIHZhbHVlIG9mIGVhY2ggc3ltYm9sIGlzIHRoZSBjb3JyZXNwb25kaW5nIGludGVnZXIgdmFsdWUsXG5lLmcuLCBvbiBtb3N0IHN5c3RlbXMsIGVycm5vLkVOT0VOVCBlcXVhbHMgdGhlIGludGVnZXIgMi5cblxuVGhlIGRpY3Rpb25hcnkgZXJybm8uZXJyb3Jjb2RlIG1hcHMgbnVtZXJpYyBjb2RlcyB0byBzeW1ib2wgbmFtZXMsXG5lLmcuLCBlcnJuby5lcnJvcmNvZGVbMl0gY291bGQgYmUgdGhlIHN0cmluZyAnRU5PRU5UJy5cblxuU3ltYm9scyB0aGF0IGFyZSBub3QgcmVsZXZhbnQgdG8gdGhlIHVuZGVybHlpbmcgc3lzdGVtIGFyZSBub3QgZGVmaW5lZC5cblxuVG8gbWFwIGVycm9yIGNvZGVzIHRvIGVycm9yIG1lc3NhZ2VzLCB1c2UgdGhlIGZ1bmN0aW9uIG9zLnN0cmVycm9yKCksXG5lLmcuIG9zLnN0cmVycm9yKDIpIGNvdWxkIHJldHVybiAnTm8gc3VjaCBmaWxlIG9yIGRpcmVjdG9yeScuIgoKRTJCSUcgPSA3CkVBQ0NFUyA9IDEzCkVBRERSSU5VU0UgPSA5OApFQUREUk5PVEFWQUlMID0gOTkKRUFEViA9IDY4CkVBRk5PU1VQUE9SVCA9IDk3CkVBR0FJTiA9IDExCkVBTFJFQURZID0gMTE0CkVCQURFID0gNTIKRUJBREYgPSA5CkVCQURGRCA9IDc3CkVCQURNU0cgPSA3NApFQkFEUiA9IDUzCkVCQURSUUMgPSA1NgpFQkFEU0xUID0gNTcKRUJGT05UID0gNTkKRUJVU1kgPSAxNgpFQ0hJTEQgPSAxMApFQ0hSTkcgPSA0NApFQ09NTSA9IDcwCkVDT05OQUJPUlRFRCA9IDEwMwpFQ09OTlJFRlVTRUQgPSAxMTEKRUNPTk5SRVNFVCA9IDEwNApFREVBRExLID0gMzUKRURFQURMT0NLID0gMzUKRURFU1RBRERSUkVRID0gODkKRURPTSA9IDMzCkVET1RET1QgPSA3MwpFRFFVT1QgPSAxMjIKRUVYSVNUID0gMTcKRUZBVUxUID0gMTQKRUZCSUcgPSAyNwpFSE9TVERPV04gPSAxMTIKRUhPU1RVTlJFQUNIID0gMTEzCkVJRFJNID0gNDMKRUlMU0VRID0gODQKRUlOUFJPR1JFU1MgPSAxMTUKRUlOVFIgPSA0CkVJTlZBTCA9IDIyCkVJTyA9IDUKRUlTQ09OTiA9IDEwNgpFSVNESVIgPSAyMQpFSVNOQU0gPSAxMjAKRUwySExUID0gNTEKRUwyTlNZTkMgPSA0NQpFTDNITFQgPSA0NgpFTDNSU1QgPSA0NwpFTElCQUNDID0gNzkKRUxJQkJBRCA9IDgwCkVMSUJFWEVDID0gODMKRUxJQk1BWCA9IDgyCkVMSUJTQ04gPSA4MQpFTE5STkcgPSA0OApFTE9PUCA9IDQwCkVNRklMRSA9IDI0CkVNTElOSyA9IDMxCkVNU0dTSVpFID0gOTAKRU1VTFRJSE9QID0gNzIKRU5BTUVUT09MT05HID0gMzYKRU5BVkFJTCA9IDExOQpFTkVURE9XTiA9IDEwMApFTkVUUkVTRVQgPSAxMDIKRU5FVFVOUkVBQ0ggPSAxMDEKRU5GSUxFID0gMjMKRU5PQU5PID0gNTUKRU5PQlVGUyA9IDEwNQpFTk9DU0kgPSA1MApFTk9EQVRBID0gNjEKRU5PREVWID0gMTkKRU5PRU5UID0gMgpFTk9FWEVDID0gOApFTk9MQ0sgPSAzNwpFTk9MSU5LID0gNjcKRU5PTUVNID0gMTIKRU5PTVNHID0gNDIKRU5PTkVUID0gNjQKRU5PUEtHID0gNjUKRU5PUFJPVE9PUFQgPSA5MgpFTk9TUEMgPSAyOApFTk9TUiA9IDYzCkVOT1NUUiA9IDYwCkVOT1NZUyA9IDM4CkVOT1RCTEsgPSAxNQpFTk9UQ09OTiA9IDEwNwpFTk9URElSID0gMjAKRU5PVEVNUFRZID0gMzkKRU5PVE5BTSA9IDExOApFTk9UU09DSyA9IDg4CkVOT1RUWSA9IDI1CkVOT1RVTklRID0gNzYKRU5YSU8gPSA2CkVPUE5PVFNVUFAgPSA5NQpFT1ZFUkZMT1cgPSA3NQpFUEVSTSA9IDEKRVBGTk9TVVBQT1JUID0gOTYKRVBJUEUgPSAzMgpFUFJPVE8gPSA3MQpFUFJPVE9OT1NVUFBPUlQgPSA5MwpFUFJPVE9UWVBFID0gOTEKRVJBTkdFID0gMzQKRVJFTUNIRyA9IDc4CkVSRU1PVEUgPSA2NgpFUkVNT1RFSU8gPSAxMjEKRVJFU1RBUlQgPSA4NQpFUk9GUyA9IDMwCkVTSFVURE9XTiA9IDEwOApFU09DS1ROT1NVUFBPUlQgPSA5NApFU1BJUEUgPSAyOQpFU1JDSCA9IDMKRVNSTU5UID0gNjkKRVNUQUxFID0gMTE2CkVTVFJQSVBFID0gODYKRVRJTUUgPSA2MgpFVElNRURPVVQgPSAxMTAKRVRPT01BTllSRUZTID0gMTA5CkVUWFRCU1kgPSAyNgpFVUNMRUFOID0gMTE3CkVVTkFUQ0ggPSA0OQpFVVNFUlMgPSA4NwpFV09VTERCTE9DSyA9IDExCkVYREVWID0gMTgKRVhGVUxMID0gNTQKIyBlcnJvcmNvZGUK',
'/Lib/heapq.py':'IiIiSGVhcCBxdWV1ZSBhbGdvcml0aG0gKGEuay5hLiBwcmlvcml0eSBxdWV1ZSkuCgpIZWFwcyBhcmUgYXJyYXlzIGZvciB3aGljaCBhW2tdIDw9IGFbMiprKzFdIGFuZCBhW2tdIDw9IGFbMiprKzJdIGZvcgphbGwgaywgY291bnRpbmcgZWxlbWVudHMgZnJvbSAwLiAgRm9yIHRoZSBzYWtlIG9mIGNvbXBhcmlzb24sCm5vbi1leGlzdGluZyBlbGVtZW50cyBhcmUgY29uc2lkZXJlZCB0byBiZSBpbmZpbml0ZS4gIFRoZSBpbnRlcmVzdGluZwpwcm9wZXJ0eSBvZiBhIGhlYXAgaXMgdGhhdCBhWzBdIGlzIGFsd2F5cyBpdHMgc21hbGxlc3QgZWxlbWVudC4KClVzYWdlOgoKaGVhcCA9IFtdICAgICAgICAgICAgIyBjcmVhdGVzIGFuIGVtcHR5IGhlYXAKaGVhcHB1c2goaGVhcCwgaXRlbSkgIyBwdXNoZXMgYSBuZXcgaXRlbSBvbiB0aGUgaGVhcAppdGVtID0gaGVhcHBvcChoZWFwKSAjIHBvcHMgdGhlIHNtYWxsZXN0IGl0ZW0gZnJvbSB0aGUgaGVhcAppdGVtID0gaGVhcFswXSAgICAgICAjIHNtYWxsZXN0IGl0ZW0gb24gdGhlIGhlYXAgd2l0aG91dCBwb3BwaW5nIGl0CmhlYXBpZnkoeCkgICAgICAgICAgICMgdHJhbnNmb3JtcyBsaXN0IGludG8gYSBoZWFwLCBpbi1wbGFjZSwgaW4gbGluZWFyIHRpbWUKaXRlbSA9IGhlYXByZXBsYWNlKGhlYXAsIGl0ZW0pICMgcG9wcyBhbmQgcmV0dXJucyBzbWFsbGVzdCBpdGVtLCBhbmQgYWRkcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBuZXcgaXRlbTsgdGhlIGhlYXAgc2l6ZSBpcyB1bmNoYW5nZWQKCk91ciBBUEkgZGlmZmVycyBmcm9tIHRleHRib29rIGhlYXAgYWxnb3JpdGhtcyBhcyBmb2xsb3dzOgoKLSBXZSB1c2UgMC1iYXNlZCBpbmRleGluZy4gIFRoaXMgbWFrZXMgdGhlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIHRoZQogIGluZGV4IGZvciBhIG5vZGUgYW5kIHRoZSBpbmRleGVzIGZvciBpdHMgY2hpbGRyZW4gc2xpZ2h0bHkgbGVzcwogIG9idmlvdXMsIGJ1dCBpcyBtb3JlIHN1aXRhYmxlIHNpbmNlIFB5dGhvbiB1c2VzIDAtYmFzZWQgaW5kZXhpbmcuCgotIE91ciBoZWFwcG9wKCkgbWV0aG9kIHJldHVybnMgdGhlIHNtYWxsZXN0IGl0ZW0sIG5vdCB0aGUgbGFyZ2VzdC4KClRoZXNlIHR3byBtYWtlIGl0IHBvc3NpYmxlIHRvIHZpZXcgdGhlIGhlYXAgYXMgYSByZWd1bGFyIFB5dGhvbiBsaXN0CndpdGhvdXQgc3VycHJpc2VzOiBoZWFwWzBdIGlzIHRoZSBzbWFsbGVzdCBpdGVtLCBhbmQgaGVhcC5zb3J0KCkKbWFpbnRhaW5zIHRoZSBoZWFwIGludmFyaWFudCEKIiIiCgojIE9yaWdpbmFsIGNvZGUgYnkgS2V2aW4gTydDb25ub3IsIGF1Z21lbnRlZCBieSBUaW0gUGV0ZXJzIGFuZCBSYXltb25kIEhldHRpbmdlcgoKX19hYm91dF9fID0gIiIiSGVhcCBxdWV1ZXMKCltleHBsYW5hdGlvbiBieSBGcmFuw6dvaXMgUGluYXJkXQoKSGVhcHMgYXJlIGFycmF5cyBmb3Igd2hpY2ggYVtrXSA8PSBhWzIqaysxXSBhbmQgYVtrXSA8PSBhWzIqaysyXSBmb3IKYWxsIGssIGNvdW50aW5nIGVsZW1lbnRzIGZyb20gMC4gIEZvciB0aGUgc2FrZSBvZiBjb21wYXJpc29uLApub24tZXhpc3RpbmcgZWxlbWVudHMgYXJlIGNvbnNpZGVyZWQgdG8gYmUgaW5maW5pdGUuICBUaGUgaW50ZXJlc3RpbmcKcHJvcGVydHkgb2YgYSBoZWFwIGlzIHRoYXQgYVswXSBpcyBhbHdheXMgaXRzIHNtYWxsZXN0IGVsZW1lbnQuCgpUaGUgc3RyYW5nZSBpbnZhcmlhbnQgYWJvdmUgaXMgbWVhbnQgdG8gYmUgYW4gZWZmaWNpZW50IG1lbW9yeQpyZXByZXNlbnRhdGlvbiBmb3IgYSB0b3VybmFtZW50LiAgVGhlIG51bWJlcnMgYmVsb3cgYXJlIGBrJywgbm90IGFba106CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAKCiAgICAgICAgICAgICAgICAgIDEgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAyCgogICAgICAgICAgMyAgICAgICAgICAgICAgIDQgICAgICAgICAgICAgICAgNSAgICAgICAgICAgICAgIDYKCiAgICAgIDcgICAgICAgOCAgICAgICA5ICAgICAgIDEwICAgICAgMTEgICAgICAxMiAgICAgIDEzICAgICAgMTQKCiAgICAxNSAxNiAgIDE3IDE4ICAgMTkgMjAgICAyMSAyMiAgIDIzIDI0ICAgMjUgMjYgICAyNyAyOCAgIDI5IDMwCgoKSW4gdGhlIHRyZWUgYWJvdmUsIGVhY2ggY2VsbCBgaycgaXMgdG9wcGluZyBgMiprKzEnIGFuZCBgMiprKzInLiAgSW4KYW4gdXN1YWwgYmluYXJ5IHRvdXJuYW1lbnQgd2Ugc2VlIGluIHNwb3J0cywgZWFjaCBjZWxsIGlzIHRoZSB3aW5uZXIKb3ZlciB0aGUgdHdvIGNlbGxzIGl0IHRvcHMsIGFuZCB3ZSBjYW4gdHJhY2UgdGhlIHdpbm5lciBkb3duIHRoZSB0cmVlCnRvIHNlZSBhbGwgb3Bwb25lbnRzIHMvaGUgaGFkLiAgSG93ZXZlciwgaW4gbWFueSBjb21wdXRlciBhcHBsaWNhdGlvbnMKb2Ygc3VjaCB0b3VybmFtZW50cywgd2UgZG8gbm90IG5lZWQgdG8gdHJhY2UgdGhlIGhpc3Rvcnkgb2YgYSB3aW5uZXIuClRvIGJlIG1vcmUgbWVtb3J5IGVmZmljaWVudCwgd2hlbiBhIHdpbm5lciBpcyBwcm9tb3RlZCwgd2UgdHJ5IHRvCnJlcGxhY2UgaXQgYnkgc29tZXRoaW5nIGVsc2UgYXQgYSBsb3dlciBsZXZlbCwgYW5kIHRoZSBydWxlIGJlY29tZXMKdGhhdCBhIGNlbGwgYW5kIHRoZSB0d28gY2VsbHMgaXQgdG9wcyBjb250YWluIHRocmVlIGRpZmZlcmVudCBpdGVtcywKYnV0IHRoZSB0b3AgY2VsbCAid2lucyIgb3ZlciB0aGUgdHdvIHRvcHBlZCBjZWxscy4KCklmIHRoaXMgaGVhcCBpbnZhcmlhbnQgaXMgcHJvdGVjdGVkIGF0IGFsbCB0aW1lLCBpbmRleCAwIGlzIGNsZWFybHkKdGhlIG92ZXJhbGwgd2lubmVyLiAgVGhlIHNpbXBsZXN0IGFsZ29yaXRobWljIHdheSB0byByZW1vdmUgaXQgYW5kCmZpbmQgdGhlICJuZXh0IiB3aW5uZXIgaXMgdG8gbW92ZSBzb21lIGxvc2VyIChsZXQncyBzYXkgY2VsbCAzMCBpbiB0aGUKZGlhZ3JhbSBhYm92ZSkgaW50byB0aGUgMCBwb3NpdGlvbiwgYW5kIHRoZW4gcGVyY29sYXRlIHRoaXMgbmV3IDAgZG93bgp0aGUgdHJlZSwgZXhjaGFuZ2luZyB2YWx1ZXMsIHVudGlsIHRoZSBpbnZhcmlhbnQgaXMgcmUtZXN0YWJsaXNoZWQuClRoaXMgaXMgY2xlYXJseSBsb2dhcml0aG1pYyBvbiB0aGUgdG90YWwgbnVtYmVyIG9mIGl0ZW1zIGluIHRoZSB0cmVlLgpCeSBpdGVyYXRpbmcgb3ZlciBhbGwgaXRlbXMsIHlvdSBnZXQgYW4gTyhuIGxuIG4pIHNvcnQuCgpBIG5pY2UgZmVhdHVyZSBvZiB0aGlzIHNvcnQgaXMgdGhhdCB5b3UgY2FuIGVmZmljaWVudGx5IGluc2VydCBuZXcKaXRlbXMgd2hpbGUgdGhlIHNvcnQgaXMgZ29pbmcgb24sIHByb3ZpZGVkIHRoYXQgdGhlIGluc2VydGVkIGl0ZW1zIGFyZQpub3QgImJldHRlciIgdGhhbiB0aGUgbGFzdCAwJ3RoIGVsZW1lbnQgeW91IGV4dHJhY3RlZC4gIFRoaXMgaXMKZXNwZWNpYWxseSB1c2VmdWwgaW4gc2ltdWxhdGlvbiBjb250ZXh0cywgd2hlcmUgdGhlIHRyZWUgaG9sZHMgYWxsCmluY29taW5nIGV2ZW50cywgYW5kIHRoZSAid2luIiBjb25kaXRpb24gbWVhbnMgdGhlIHNtYWxsZXN0IHNjaGVkdWxlZAp0aW1lLiAgV2hlbiBhbiBldmVudCBzY2hlZHVsZSBvdGhlciBldmVudHMgZm9yIGV4ZWN1dGlvbiwgdGhleSBhcmUKc2NoZWR1bGVkIGludG8gdGhlIGZ1dHVyZSwgc28gdGhleSBjYW4gZWFzaWx5IGdvIGludG8gdGhlIGhlYXAuICBTbywgYQpoZWFwIGlzIGEgZ29vZCBzdHJ1Y3R1cmUgZm9yIGltcGxlbWVudGluZyBzY2hlZHVsZXJzICh0aGlzIGlzIHdoYXQgSQp1c2VkIGZvciBteSBNSURJIHNlcXVlbmNlciA6LSkuCgpWYXJpb3VzIHN0cnVjdHVyZXMgZm9yIGltcGxlbWVudGluZyBzY2hlZHVsZXJzIGhhdmUgYmVlbiBleHRlbnNpdmVseQpzdHVkaWVkLCBhbmQgaGVhcHMgYXJlIGdvb2QgZm9yIHRoaXMsIGFzIHRoZXkgYXJlIHJlYXNvbmFibHkgc3BlZWR5LAp0aGUgc3BlZWQgaXMgYWxtb3N0IGNvbnN0YW50LCBhbmQgdGhlIHdvcnN0IGNhc2UgaXMgbm90IG11Y2ggZGlmZmVyZW50CnRoYW4gdGhlIGF2ZXJhZ2UgY2FzZS4gIEhvd2V2ZXIsIHRoZXJlIGFyZSBvdGhlciByZXByZXNlbnRhdGlvbnMgd2hpY2gKYXJlIG1vcmUgZWZmaWNpZW50IG92ZXJhbGwsIHlldCB0aGUgd29yc3QgY2FzZXMgbWlnaHQgYmUgdGVycmlibGUuCgpIZWFwcyBhcmUgYWxzbyB2ZXJ5IHVzZWZ1bCBpbiBiaWcgZGlzayBzb3J0cy4gIFlvdSBtb3N0IHByb2JhYmx5IGFsbAprbm93IHRoYXQgYSBiaWcgc29ydCBpbXBsaWVzIHByb2R1Y2luZyAicnVucyIgKHdoaWNoIGFyZSBwcmUtc29ydGVkCnNlcXVlbmNlcywgd2hpY2ggc2l6ZSBpcyB1c3VhbGx5IHJlbGF0ZWQgdG8gdGhlIGFtb3VudCBvZiBDUFUgbWVtb3J5KSwKZm9sbG93ZWQgYnkgYSBtZXJnaW5nIHBhc3NlcyBmb3IgdGhlc2UgcnVucywgd2hpY2ggbWVyZ2luZyBpcyBvZnRlbgp2ZXJ5IGNsZXZlcmx5IG9yZ2FuaXNlZFsxXS4gIEl0IGlzIHZlcnkgaW1wb3J0YW50IHRoYXQgdGhlIGluaXRpYWwKc29ydCBwcm9kdWNlcyB0aGUgbG9uZ2VzdCBydW5zIHBvc3NpYmxlLiAgVG91cm5hbWVudHMgYXJlIGEgZ29vZCB3YXkKdG8gdGhhdC4gIElmLCB1c2luZyBhbGwgdGhlIG1lbW9yeSBhdmFpbGFibGUgdG8gaG9sZCBhIHRvdXJuYW1lbnQsIHlvdQpyZXBsYWNlIGFuZCBwZXJjb2xhdGUgaXRlbXMgdGhhdCBoYXBwZW4gdG8gZml0IHRoZSBjdXJyZW50IHJ1biwgeW91J2xsCnByb2R1Y2UgcnVucyB3aGljaCBhcmUgdHdpY2UgdGhlIHNpemUgb2YgdGhlIG1lbW9yeSBmb3IgcmFuZG9tIGlucHV0LAphbmQgbXVjaCBiZXR0ZXIgZm9yIGlucHV0IGZ1enppbHkgb3JkZXJlZC4KCk1vcmVvdmVyLCBpZiB5b3Ugb3V0cHV0IHRoZSAwJ3RoIGl0ZW0gb24gZGlzayBhbmQgZ2V0IGFuIGlucHV0IHdoaWNoCm1heSBub3QgZml0IGluIHRoZSBjdXJyZW50IHRvdXJuYW1lbnQgKGJlY2F1c2UgdGhlIHZhbHVlICJ3aW5zIiBvdmVyCnRoZSBsYXN0IG91dHB1dCB2YWx1ZSksIGl0IGNhbm5vdCBmaXQgaW4gdGhlIGhlYXAsIHNvIHRoZSBzaXplIG9mIHRoZQpoZWFwIGRlY3JlYXNlcy4gIFRoZSBmcmVlZCBtZW1vcnkgY291bGQgYmUgY2xldmVybHkgcmV1c2VkIGltbWVkaWF0ZWx5CmZvciBwcm9ncmVzc2l2ZWx5IGJ1aWxkaW5nIGEgc2Vjb25kIGhlYXAsIHdoaWNoIGdyb3dzIGF0IGV4YWN0bHkgdGhlCnNhbWUgcmF0ZSB0aGUgZmlyc3QgaGVhcCBpcyBtZWx0aW5nLiAgV2hlbiB0aGUgZmlyc3QgaGVhcCBjb21wbGV0ZWx5CnZhbmlzaGVzLCB5b3Ugc3dpdGNoIGhlYXBzIGFuZCBzdGFydCBhIG5ldyBydW4uICBDbGV2ZXIgYW5kIHF1aXRlCmVmZmVjdGl2ZSEKCkluIGEgd29yZCwgaGVhcHMgYXJlIHVzZWZ1bCBtZW1vcnkgc3RydWN0dXJlcyB0byBrbm93LiAgSSB1c2UgdGhlbSBpbgphIGZldyBhcHBsaWNhdGlvbnMsIGFuZCBJIHRoaW5rIGl0IGlzIGdvb2QgdG8ga2VlcCBhIGBoZWFwJyBtb2R1bGUKYXJvdW5kLiA6LSkKCi0tLS0tLS0tLS0tLS0tLS0tLS0tClsxXSBUaGUgZGlzayBiYWxhbmNpbmcgYWxnb3JpdGhtcyB3aGljaCBhcmUgY3VycmVudCwgbm93YWRheXMsIGFyZQptb3JlIGFubm95aW5nIHRoYW4gY2xldmVyLCBhbmQgdGhpcyBpcyBhIGNvbnNlcXVlbmNlIG9mIHRoZSBzZWVraW5nCmNhcGFiaWxpdGllcyBvZiB0aGUgZGlza3MuICBPbiBkZXZpY2VzIHdoaWNoIGNhbm5vdCBzZWVrLCBsaWtlIGJpZwp0YXBlIGRyaXZlcywgdGhlIHN0b3J5IHdhcyBxdWl0ZSBkaWZmZXJlbnQsIGFuZCBvbmUgaGFkIHRvIGJlIHZlcnkKY2xldmVyIHRvIGVuc3VyZSAoZmFyIGluIGFkdmFuY2UpIHRoYXQgZWFjaCB0YXBlIG1vdmVtZW50IHdpbGwgYmUgdGhlCm1vc3QgZWZmZWN0aXZlIHBvc3NpYmxlICh0aGF0IGlzLCB3aWxsIGJlc3QgcGFydGljaXBhdGUgYXQKInByb2dyZXNzaW5nIiB0aGUgbWVyZ2UpLiAgU29tZSB0YXBlcyB3ZXJlIGV2ZW4gYWJsZSB0byByZWFkCmJhY2t3YXJkcywgYW5kIHRoaXMgd2FzIGFsc28gdXNlZCB0byBhdm9pZCB0aGUgcmV3aW5kaW5nIHRpbWUuCkJlbGlldmUgbWUsIHJlYWwgZ29vZCB0YXBlIHNvcnRzIHdlcmUgcXVpdGUgc3BlY3RhY3VsYXIgdG8gd2F0Y2ghCkZyb20gYWxsIHRpbWVzLCBzb3J0aW5nIGhhcyBhbHdheXMgYmVlbiBhIEdyZWF0IEFydCEgOi0pCiIiIgoKX19hbGxfXyA9IFsnaGVhcHB1c2gnLCAnaGVhcHBvcCcsICdoZWFwaWZ5JywgJ2hlYXByZXBsYWNlJywgJ21lcmdlJywKICAgICAgICAgICAnbmxhcmdlc3QnLCAnbnNtYWxsZXN0JywgJ2hlYXBwdXNocG9wJ10KCmZyb20gaXRlcnRvb2xzIGltcG9ydCBpc2xpY2UsIHJlcGVhdCwgY291bnQsIHRlZSwgY2hhaW4KaW1wb3J0IGJpc2VjdAoKZGVmIGhlYXBwdXNoKGhlYXAsIGl0ZW0pOgogICAgIiIiUHVzaCBpdGVtIG9udG8gaGVhcCwgbWFpbnRhaW5pbmcgdGhlIGhlYXAgaW52YXJpYW50LiIiIgogICAgaGVhcC5hcHBlbmQoaXRlbSkKICAgIF9zaWZ0ZG93bihoZWFwLCAwLCBsZW4oaGVhcCktMSkKCmRlZiBoZWFwcG9wKGhlYXApOgogICAgIiIiUG9wIHRoZSBzbWFsbGVzdCBpdGVtIG9mZiB0aGUgaGVhcCwgbWFpbnRhaW5pbmcgdGhlIGhlYXAgaW52YXJpYW50LiIiIgogICAgbGFzdGVsdCA9IGhlYXAucG9wKCkgICAgIyByYWlzZXMgYXBwcm9wcmlhdGUgSW5kZXhFcnJvciBpZiBoZWFwIGlzIGVtcHR5CiAgICBpZiBoZWFwOgogICAgICAgIHJldHVybml0ZW0gPSBoZWFwWzBdCiAgICAgICAgaGVhcFswXSA9IGxhc3RlbHQKICAgICAgICBfc2lmdHVwKGhlYXAsIDApCiAgICBlbHNlOgogICAgICAgIHJldHVybml0ZW0gPSBsYXN0ZWx0CiAgICByZXR1cm4gcmV0dXJuaXRlbQoKZGVmIGhlYXByZXBsYWNlKGhlYXAsIGl0ZW0pOgogICAgIiIiUG9wIGFuZCByZXR1cm4gdGhlIGN1cnJlbnQgc21hbGxlc3QgdmFsdWUsIGFuZCBhZGQgdGhlIG5ldyBpdGVtLgoKICAgIFRoaXMgaXMgbW9yZSBlZmZpY2llbnQgdGhhbiBoZWFwcG9wKCkgZm9sbG93ZWQgYnkgaGVhcHB1c2goKSwgYW5kIGNhbiBiZQogICAgbW9yZSBhcHByb3ByaWF0ZSB3aGVuIHVzaW5nIGEgZml4ZWQtc2l6ZSBoZWFwLiAgTm90ZSB0aGF0IHRoZSB2YWx1ZQogICAgcmV0dXJuZWQgbWF5IGJlIGxhcmdlciB0aGFuIGl0ZW0hICBUaGF0IGNvbnN0cmFpbnMgcmVhc29uYWJsZSB1c2VzIG9mCiAgICB0aGlzIHJvdXRpbmUgdW5sZXNzIHdyaXR0ZW4gYXMgcGFydCBvZiBhIGNvbmRpdGlvbmFsIHJlcGxhY2VtZW50OgoKICAgICAgICBpZiBpdGVtID4gaGVhcFswXToKICAgICAgICAgICAgaXRlbSA9IGhlYXByZXBsYWNlKGhlYXAsIGl0ZW0pCiAgICAiIiIKICAgIHJldHVybml0ZW0gPSBoZWFwWzBdICAgICMgcmFpc2VzIGFwcHJvcHJpYXRlIEluZGV4RXJyb3IgaWYgaGVhcCBpcyBlbXB0eQogICAgaGVhcFswXSA9IGl0ZW0KICAgIF9zaWZ0dXAoaGVhcCwgMCkKICAgIHJldHVybiByZXR1cm5pdGVtCgpkZWYgaGVhcHB1c2hwb3AoaGVhcCwgaXRlbSk6CiAgICAiIiJGYXN0IHZlcnNpb24gb2YgYSBoZWFwcHVzaCBmb2xsb3dlZCBieSBhIGhlYXBwb3AuIiIiCiAgICBpZiBoZWFwIGFuZCBoZWFwWzBdIDwgaXRlbToKICAgICAgICBpdGVtLCBoZWFwWzBdID0gaGVhcFswXSwgaXRlbQogICAgICAgIF9zaWZ0dXAoaGVhcCwgMCkKICAgIHJldHVybiBpdGVtCgpkZWYgaGVhcGlmeSh4KToKICAgICIiIlRyYW5zZm9ybSBsaXN0IGludG8gYSBoZWFwLCBpbi1wbGFjZSwgaW4gTyhsZW4oeCkpIHRpbWUuIiIiCiAgICBuID0gbGVuKHgpCiAgICAjIFRyYW5zZm9ybSBib3R0b20tdXAuICBUaGUgbGFyZ2VzdCBpbmRleCB0aGVyZSdzIGFueSBwb2ludCB0byBsb29raW5nIGF0CiAgICAjIGlzIHRoZSBsYXJnZXN0IHdpdGggYSBjaGlsZCBpbmRleCBpbi1yYW5nZSwgc28gbXVzdCBoYXZlIDIqaSArIDEgPCBuLAogICAgIyBvciBpIDwgKG4tMSkvMi4gIElmIG4gaXMgZXZlbiA9IDIqaiwgdGhpcyBpcyAoMipqLTEpLzIgPSBqLTEvMiBzbwogICAgIyBqLTEgaXMgdGhlIGxhcmdlc3QsIHdoaWNoIGlzIG4vLzIgLSAxLiAgSWYgbiBpcyBvZGQgPSAyKmorMSwgdGhpcyBpcwogICAgIyAoMipqKzEtMSkvMiA9IGogc28gai0xIGlzIHRoZSBsYXJnZXN0LCBhbmQgdGhhdCdzIGFnYWluIG4vLzItMS4KICAgIGZvciBpIGluIHJldmVyc2VkKHJhbmdlKG4vLzIpKToKICAgICAgICBfc2lmdHVwKHgsIGkpCgpkZWYgbmxhcmdlc3QobiwgaXRlcmFibGUpOgogICAgIiIiRmluZCB0aGUgbiBsYXJnZXN0IGVsZW1lbnRzIGluIGEgZGF0YXNldC4KCiAgICBFcXVpdmFsZW50IHRvOiAgc29ydGVkKGl0ZXJhYmxlLCByZXZlcnNlPVRydWUpWzpuXQogICAgIiIiCiAgICBpZiBuIDwgMDoKICAgICAgICByZXR1cm4gW10KICAgIGl0ID0gaXRlcihpdGVyYWJsZSkKICAgIHJlc3VsdCA9IGxpc3QoaXNsaWNlKGl0LCBuKSkKICAgIGlmIG5vdCByZXN1bHQ6CiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgaGVhcGlmeShyZXN1bHQpCiAgICBfaGVhcHB1c2hwb3AgPSBoZWFwcHVzaHBvcAogICAgZm9yIGVsZW0gaW4gaXQ6CiAgICAgICAgX2hlYXBwdXNocG9wKHJlc3VsdCwgZWxlbSkKICAgIHJlc3VsdC5zb3J0KHJldmVyc2U9VHJ1ZSkKICAgIHJldHVybiByZXN1bHQKCmRlZiBuc21hbGxlc3QobiwgaXRlcmFibGUpOgogICAgIiIiRmluZCB0aGUgbiBzbWFsbGVzdCBlbGVtZW50cyBpbiBhIGRhdGFzZXQuCgogICAgRXF1aXZhbGVudCB0bzogIHNvcnRlZChpdGVyYWJsZSlbOm5dCiAgICAiIiIKICAgIGlmIG4gPCAwOgogICAgICAgIHJldHVybiBbXQogICAgaWYgaGFzYXR0cihpdGVyYWJsZSwgJ19fbGVuX18nKSBhbmQgbiAqIDEwIDw9IGxlbihpdGVyYWJsZSk6CiAgICAgICAgIyBGb3Igc21hbGxlciB2YWx1ZXMgb2YgbiwgdGhlIGJpc2VjdCBtZXRob2QgaXMgZmFzdGVyIHRoYW4gYSBtaW5oZWFwLgogICAgICAgICMgSXQgaXMgYWxzbyBtZW1vcnkgZWZmaWNpZW50LCBjb25zdW1pbmcgb25seSBuIGVsZW1lbnRzIG9mIHNwYWNlLgogICAgICAgIGl0ID0gaXRlcihpdGVyYWJsZSkKICAgICAgICByZXN1bHQgPSBzb3J0ZWQoaXNsaWNlKGl0LCAwLCBuKSkKICAgICAgICBpZiBub3QgcmVzdWx0OgogICAgICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgaW5zb3J0ID0gYmlzZWN0Lmluc29ydAogICAgICAgIHBvcCA9IHJlc3VsdC5wb3AKICAgICAgICBsb3MgPSByZXN1bHRbLTFdICAgICMgbG9zIC0tPiBMYXJnZXN0IG9mIHRoZSBuc21hbGxlc3QKICAgICAgICBmb3IgZWxlbSBpbiBpdDoKICAgICAgICAgICAgaWYgZWxlbSA8IGxvczoKICAgICAgICAgICAgICAgIGluc29ydChyZXN1bHQsIGVsZW0pCiAgICAgICAgICAgICAgICBwb3AoKQogICAgICAgICAgICAgICAgbG9zID0gcmVzdWx0Wy0xXQogICAgICAgIHJldHVybiByZXN1bHQKICAgICMgQW4gYWx0ZXJuYXRpdmUgYXBwcm9hY2ggbWFuaWZlc3RzIHRoZSB3aG9sZSBpdGVyYWJsZSBpbiBtZW1vcnkgYnV0CiAgICAjIHNhdmVzIGNvbXBhcmlzb25zIGJ5IGhlYXBpZnlpbmcgYWxsIGF0IG9uY2UuICBBbHNvLCBzYXZlcyB0aW1lCiAgICAjIG92ZXIgYmlzZWN0Lmluc29ydCgpIHdoaWNoIGhhcyBPKG4pIGRhdGEgbW92ZW1lbnQgdGltZSBmb3IgZXZlcnkKICAgICMgaW5zZXJ0aW9uLiAgRmluZGluZyB0aGUgbiBzbWFsbGVzdCBvZiBhbiBtIGxlbmd0aCBpdGVyYWJsZSByZXF1aXJlcwogICAgIyAgICBPKG0pICsgTyhuIGxvZyBtKSBjb21wYXJpc29ucy4KICAgIGggPSBsaXN0KGl0ZXJhYmxlKQogICAgaGVhcGlmeShoKQogICAgcmV0dXJuIGxpc3QobWFwKGhlYXBwb3AsIHJlcGVhdChoLCBtaW4obiwgbGVuKGgpKSkpKQoKIyAnaGVhcCcgaXMgYSBoZWFwIGF0IGFsbCBpbmRpY2VzID49IHN0YXJ0cG9zLCBleGNlcHQgcG9zc2libHkgZm9yIHBvcy4gIHBvcwojIGlzIHRoZSBpbmRleCBvZiBhIGxlYWYgd2l0aCBhIHBvc3NpYmx5IG91dC1vZi1vcmRlciB2YWx1ZS4gIFJlc3RvcmUgdGhlCiMgaGVhcCBpbnZhcmlhbnQuCmRlZiBfc2lmdGRvd24oaGVhcCwgc3RhcnRwb3MsIHBvcyk6CiAgICBuZXdpdGVtID0gaGVhcFtwb3NdCiAgICAjIEZvbGxvdyB0aGUgcGF0aCB0byB0aGUgcm9vdCwgbW92aW5nIHBhcmVudHMgZG93biB1bnRpbCBmaW5kaW5nIGEgcGxhY2UKICAgICMgbmV3aXRlbSBmaXRzLgogICAgd2hpbGUgcG9zID4gc3RhcnRwb3M6CiAgICAgICAgcGFyZW50cG9zID0gKHBvcyAtIDEpID4+IDEKICAgICAgICBwYXJlbnQgPSBoZWFwW3BhcmVudHBvc10KICAgICAgICBpZiBuZXdpdGVtIDwgcGFyZW50OgogICAgICAgICAgICBoZWFwW3Bvc10gPSBwYXJlbnQKICAgICAgICAgICAgcG9zID0gcGFyZW50cG9zCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgYnJlYWsKICAgIGhlYXBbcG9zXSA9IG5ld2l0ZW0KCiMgVGhlIGNoaWxkIGluZGljZXMgb2YgaGVhcCBpbmRleCBwb3MgYXJlIGFscmVhZHkgaGVhcHMsIGFuZCB3ZSB3YW50IHRvIG1ha2UKIyBhIGhlYXAgYXQgaW5kZXggcG9zIHRvby4gIFdlIGRvIHRoaXMgYnkgYnViYmxpbmcgdGhlIHNtYWxsZXIgY2hpbGQgb2YKIyBwb3MgdXAgKGFuZCBzbyBvbiB3aXRoIHRoYXQgY2hpbGQncyBjaGlsZHJlbiwgZXRjKSB1bnRpbCBoaXR0aW5nIGEgbGVhZiwKIyB0aGVuIHVzaW5nIF9zaWZ0ZG93biB0byBtb3ZlIHRoZSBvZGRiYWxsIG9yaWdpbmFsbHkgYXQgaW5kZXggcG9zIGludG8gcGxhY2UuCiMKIyBXZSAqY291bGQqIGJyZWFrIG91dCBvZiB0aGUgbG9vcCBhcyBzb29uIGFzIHdlIGZpbmQgYSBwb3Mgd2hlcmUgbmV3aXRlbSA8PQojIGJvdGggaXRzIGNoaWxkcmVuLCBidXQgdHVybnMgb3V0IHRoYXQncyBub3QgYSBnb29kIGlkZWEsIGFuZCBkZXNwaXRlIHRoYXQKIyBtYW55IGJvb2tzIHdyaXRlIHRoZSBhbGdvcml0aG0gdGhhdCB3YXkuICBEdXJpbmcgYSBoZWFwIHBvcCwgdGhlIGxhc3QgYXJyYXkKIyBlbGVtZW50IGlzIHNpZnRlZCBpbiwgYW5kIHRoYXQgdGVuZHMgdG8gYmUgbGFyZ2UsIHNvIHRoYXQgY29tcGFyaW5nIGl0CiMgYWdhaW5zdCB2YWx1ZXMgc3RhcnRpbmcgZnJvbSB0aGUgcm9vdCB1c3VhbGx5IGRvZXNuJ3QgcGF5ICg9IHVzdWFsbHkgZG9lc24ndAojIGdldCB1cyBvdXQgb2YgdGhlIGxvb3AgZWFybHkpLiAgU2VlIEtudXRoLCBWb2x1bWUgMywgd2hlcmUgdGhpcyBpcwojIGV4cGxhaW5lZCBhbmQgcXVhbnRpZmllZCBpbiBhbiBleGVyY2lzZS4KIwojIEN1dHRpbmcgdGhlICMgb2YgY29tcGFyaXNvbnMgaXMgaW1wb3J0YW50LCBzaW5jZSB0aGVzZSByb3V0aW5lcyBoYXZlIG5vCiMgd2F5IHRvIGV4dHJhY3QgInRoZSBwcmlvcml0eSIgZnJvbSBhbiBhcnJheSBlbGVtZW50LCBzbyB0aGF0IGludGVsbGlnZW5jZQojIGlzIGxpa2VseSB0byBiZSBoaWRpbmcgaW4gY3VzdG9tIGNvbXBhcmlzb24gbWV0aG9kcywgb3IgaW4gYXJyYXkgZWxlbWVudHMKIyBzdG9yaW5nIChwcmlvcml0eSwgcmVjb3JkKSB0dXBsZXMuICBDb21wYXJpc29ucyBhcmUgdGh1cyBwb3RlbnRpYWxseQojIGV4cGVuc2l2ZS4KIwojIE9uIHJhbmRvbSBhcnJheXMgb2YgbGVuZ3RoIDEwMDAsIG1ha2luZyB0aGlzIGNoYW5nZSBjdXQgdGhlIG51bWJlciBvZgojIGNvbXBhcmlzb25zIG1hZGUgYnkgaGVhcGlmeSgpIGEgbGl0dGxlLCBhbmQgdGhvc2UgbWFkZSBieSBleGhhdXN0aXZlCiMgaGVhcHBvcCgpIGEgbG90LCBpbiBhY2NvcmQgd2l0aCB0aGVvcnkuICBIZXJlIGFyZSB0eXBpY2FsIHJlc3VsdHMgZnJvbSAzCiMgcnVucyAoMyBqdXN0IHRvIGRlbW9uc3RyYXRlIGhvdyBzbWFsbCB0aGUgdmFyaWFuY2UgaXMpOgojCiMgQ29tcGFyZXMgbmVlZGVkIGJ5IGhlYXBpZnkgICAgIENvbXBhcmVzIG5lZWRlZCBieSAxMDAwIGhlYXBwb3BzCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgMTgzNyBjdXQgdG8gMTY2MyAgICAgICAgICAgICAgIDE0OTk2IGN1dCB0byA4NjgwCiMgMTg1NSBjdXQgdG8gMTY1OSAgICAgICAgICAgICAgIDE0OTY2IGN1dCB0byA4Njc4CiMgMTg0NyBjdXQgdG8gMTY2MCAgICAgICAgICAgICAgIDE1MDI0IGN1dCB0byA4NzAzCiMKIyBCdWlsZGluZyB0aGUgaGVhcCBieSB1c2luZyBoZWFwcHVzaCgpIDEwMDAgdGltZXMgaW5zdGVhZCByZXF1aXJlZAojIDIxOTgsIDIxNDgsIGFuZCAyMjE5IGNvbXBhcmVzOiAgaGVhcGlmeSgpIGlzIG1vcmUgZWZmaWNpZW50LCB3aGVuCiMgeW91IGNhbiB1c2UgaXQuCiMKIyBUaGUgdG90YWwgY29tcGFyZXMgbmVlZGVkIGJ5IGxpc3Quc29ydCgpIG9uIHRoZSBzYW1lIGxpc3RzIHdlcmUgODYyNywKIyA4NjI3LCBhbmQgODYzMiAodGhpcyBzaG91bGQgYmUgY29tcGFyZWQgdG8gdGhlIHN1bSBvZiBoZWFwaWZ5KCkgYW5kCiMgaGVhcHBvcCgpIGNvbXBhcmVzKTogIGxpc3Quc29ydCgpIGlzICh1bnN1cnByaXNpbmdseSEpIG1vcmUgZWZmaWNpZW50CiMgZm9yIHNvcnRpbmcuCgpkZWYgX3NpZnR1cChoZWFwLCBwb3MpOgogICAgZW5kcG9zID0gbGVuKGhlYXApCiAgICBzdGFydHBvcyA9IHBvcwogICAgbmV3aXRlbSA9IGhlYXBbcG9zXQogICAgIyBCdWJibGUgdXAgdGhlIHNtYWxsZXIgY2hpbGQgdW50aWwgaGl0dGluZyBhIGxlYWYuCiAgICBjaGlsZHBvcyA9IDIqcG9zICsgMSAgICAjIGxlZnRtb3N0IGNoaWxkIHBvc2l0aW9uCiAgICB3aGlsZSBjaGlsZHBvcyA8IGVuZHBvczoKICAgICAgICAjIFNldCBjaGlsZHBvcyB0byBpbmRleCBvZiBzbWFsbGVyIGNoaWxkLgogICAgICAgIHJpZ2h0cG9zID0gY2hpbGRwb3MgKyAxCiAgICAgICAgaWYgcmlnaHRwb3MgPCBlbmRwb3MgYW5kIG5vdCBoZWFwW2NoaWxkcG9zXSA8IGhlYXBbcmlnaHRwb3NdOgogICAgICAgICAgICBjaGlsZHBvcyA9IHJpZ2h0cG9zCiAgICAgICAgIyBNb3ZlIHRoZSBzbWFsbGVyIGNoaWxkIHVwLgogICAgICAgIGhlYXBbcG9zXSA9IGhlYXBbY2hpbGRwb3NdCiAgICAgICAgcG9zID0gY2hpbGRwb3MKICAgICAgICBjaGlsZHBvcyA9IDIqcG9zICsgMQogICAgIyBUaGUgbGVhZiBhdCBwb3MgaXMgZW1wdHkgbm93LiAgUHV0IG5ld2l0ZW0gdGhlcmUsIGFuZCBidWJibGUgaXQgdXAKICAgICMgdG8gaXRzIGZpbmFsIHJlc3RpbmcgcGxhY2UgKGJ5IHNpZnRpbmcgaXRzIHBhcmVudHMgZG93bikuCiAgICBoZWFwW3Bvc10gPSBuZXdpdGVtCiAgICBfc2lmdGRvd24oaGVhcCwgc3RhcnRwb3MsIHBvcykKCiMgbm90IGF2YWlsYWJsZSBpbiBicnl0aG9uCiMgSWYgYXZhaWxhYmxlLCB1c2UgQyBpbXBsZW1lbnRhdGlvbgojdHJ5OgojICAgIGZyb20gX2hlYXBxIGltcG9ydCAqCiNleGNlcHQgSW1wb3J0RXJyb3I6CiMgICAgcGFzcwoKZGVmIG1lcmdlKCppdGVyYWJsZXMpOgogICAgJycnTWVyZ2UgbXVsdGlwbGUgc29ydGVkIGlucHV0cyBpbnRvIGEgc2luZ2xlIHNvcnRlZCBvdXRwdXQuCgogICAgU2ltaWxhciB0byBzb3J0ZWQoaXRlcnRvb2xzLmNoYWluKCppdGVyYWJsZXMpKSBidXQgcmV0dXJucyBhIGdlbmVyYXRvciwKICAgIGRvZXMgbm90IHB1bGwgdGhlIGRhdGEgaW50byBtZW1vcnkgYWxsIGF0IG9uY2UsIGFuZCBhc3N1bWVzIHRoYXQgZWFjaCBvZgogICAgdGhlIGlucHV0IHN0cmVhbXMgaXMgYWxyZWFkeSBzb3J0ZWQgKHNtYWxsZXN0IHRvIGxhcmdlc3QpLgoKICAgID4+PiBsaXN0KG1lcmdlKFsxLDMsNSw3XSwgWzAsMiw0LDhdLCBbNSwxMCwxNSwyMF0sIFtdLCBbMjVdKSkKICAgIFswLCAxLCAyLCAzLCA0LCA1LCA1LCA3LCA4LCAxMCwgMTUsIDIwLCAyNV0KCiAgICAnJycKICAgIF9oZWFwcG9wLCBfaGVhcHJlcGxhY2UsIF9TdG9wSXRlcmF0aW9uID0gaGVhcHBvcCwgaGVhcHJlcGxhY2UsIFN0b3BJdGVyYXRpb24KCiAgICBoID0gW10KICAgIGhfYXBwZW5kID0gaC5hcHBlbmQKICAgIGZvciBpdG51bSwgaXQgaW4gZW51bWVyYXRlKG1hcChpdGVyLCBpdGVyYWJsZXMpKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIG5leHQgPSBpdC5fX25leHRfXwogICAgICAgICAgICBoX2FwcGVuZChbbmV4dCgpLCBpdG51bSwgbmV4dF0pCiAgICAgICAgZXhjZXB0IF9TdG9wSXRlcmF0aW9uOgogICAgICAgICAgICBwYXNzCiAgICBoZWFwaWZ5KGgpCgogICAgd2hpbGUgMToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdoaWxlIDE6CiAgICAgICAgICAgICAgICB2LCBpdG51bSwgbmV4dCA9IHMgPSBoWzBdICAgIyByYWlzZXMgSW5kZXhFcnJvciB3aGVuIGggaXMgZW1wdHkKICAgICAgICAgICAgICAgIHlpZWxkIHYKICAgICAgICAgICAgICAgIHNbMF0gPSBuZXh0KCkgICAgICAgICAgICAgICAjIHJhaXNlcyBTdG9wSXRlcmF0aW9uIHdoZW4gZXhoYXVzdGVkCiAgICAgICAgICAgICAgICBfaGVhcHJlcGxhY2UoaCwgcykgICAgICAgICAgIyByZXN0b3JlIGhlYXAgY29uZGl0aW9uCiAgICAgICAgZXhjZXB0IF9TdG9wSXRlcmF0aW9uOgogICAgICAgICAgICBfaGVhcHBvcChoKSAgICAgICAgICAgICAgICAgICAgICMgcmVtb3ZlIGVtcHR5IGl0ZXJhdG9yCiAgICAgICAgZXhjZXB0IEluZGV4RXJyb3I6CiAgICAgICAgICAgIHJldHVybgoKIyBFeHRlbmQgdGhlIGltcGxlbWVudGF0aW9ucyBvZiBuc21hbGxlc3QgYW5kIG5sYXJnZXN0IHRvIHVzZSBhIGtleT0gYXJndW1lbnQKX25zbWFsbGVzdCA9IG5zbWFsbGVzdApkZWYgbnNtYWxsZXN0KG4sIGl0ZXJhYmxlLCBrZXk9Tm9uZSk6CiAgICAiIiJGaW5kIHRoZSBuIHNtYWxsZXN0IGVsZW1lbnRzIGluIGEgZGF0YXNldC4KCiAgICBFcXVpdmFsZW50IHRvOiAgc29ydGVkKGl0ZXJhYmxlLCBrZXk9a2V5KVs6bl0KICAgICIiIgogICAgIyBTaG9ydC1jdXQgZm9yIG49PTEgaXMgdG8gdXNlIG1pbigpIHdoZW4gbGVuKGl0ZXJhYmxlKT4wCiAgICBpZiBuID09IDE6CiAgICAgICAgaXQgPSBpdGVyKGl0ZXJhYmxlKQogICAgICAgIGhlYWQgPSBsaXN0KGlzbGljZShpdCwgMSkpCiAgICAgICAgaWYgbm90IGhlYWQ6CiAgICAgICAgICAgIHJldHVybiBbXQogICAgICAgIGlmIGtleSBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gW21pbihjaGFpbihoZWFkLCBpdCkpXQogICAgICAgIHJldHVybiBbbWluKGNoYWluKGhlYWQsIGl0KSwga2V5PWtleSldCgogICAgIyBXaGVuIG4+PXNpemUsIGl0J3MgZmFzdGVyIHRvIHVzZSBzb3J0ZWQoKQogICAgdHJ5OgogICAgICAgIHNpemUgPSBsZW4oaXRlcmFibGUpCiAgICBleGNlcHQgKFR5cGVFcnJvciwgQXR0cmlidXRlRXJyb3IpOgogICAgICAgIHBhc3MKICAgIGVsc2U6CiAgICAgICAgaWYgbiA+PSBzaXplOgogICAgICAgICAgICByZXR1cm4gc29ydGVkKGl0ZXJhYmxlLCBrZXk9a2V5KVs6bl0KCiAgICAjIFdoZW4ga2V5IGlzIG5vbmUsIHVzZSBzaW1wbGVyIGRlY29yYXRpb24KICAgIGlmIGtleSBpcyBOb25lOgogICAgICAgIGl0ID0gemlwKGl0ZXJhYmxlLCBjb3VudCgpKSAgICAgICAgICAgICAgICAgICAgICAgICAjIGRlY29yYXRlCiAgICAgICAgcmVzdWx0ID0gX25zbWFsbGVzdChuLCBpdCkKICAgICAgICByZXR1cm4gW3JbMF0gZm9yIHIgaW4gcmVzdWx0XSAgICAgICAgICAgICAgICAgICAgICAgIyB1bmRlY29yYXRlCgogICAgIyBHZW5lcmFsIGNhc2UsIHNsb3dlc3QgbWV0aG9kCiAgICBpbjEsIGluMiA9IHRlZShpdGVyYWJsZSkKICAgIGl0ID0gemlwKG1hcChrZXksIGluMSksIGNvdW50KCksIGluMikgICAgICAgICAgICAgICAgICAgIyBkZWNvcmF0ZQogICAgcmVzdWx0ID0gX25zbWFsbGVzdChuLCBpdCkKICAgIHJldHVybiBbclsyXSBmb3IgciBpbiByZXN1bHRdICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB1bmRlY29yYXRlCgoKX25sYXJnZXN0ID0gbmxhcmdlc3QKZGVmIG5sYXJnZXN0KG4sIGl0ZXJhYmxlLCBrZXk9Tm9uZSk6CiAgICAiIiJGaW5kIHRoZSBuIGxhcmdlc3QgZWxlbWVudHMgaW4gYSBkYXRhc2V0LgogICAgCiAgICAgRXF1aXZhbGVudCB0bzogIHNvcnRlZChpdGVyYWJsZSwga2V5PWtleSwgcmV2ZXJzZT1UcnVlKVs6bl0KCiAgICAgU2hvcnQtY3V0IGZvciBuPT0xIGlzIHRvIHVzZSBtYXgoKSB3aGVuIGxlbihpdGVyYWJsZSk+MAogICAgIiIiCiAgICBpZiBuID09IDE6CiAgICAgICAgaXQgPSBpdGVyKGl0ZXJhYmxlKQogICAgICAgIGhlYWQgPSBsaXN0KGlzbGljZShpdCwgMSkpCiAgICAgICAgaWYgbm90IGhlYWQ6CiAgICAgICAgICAgIHJldHVybiBbXQogICAgICAgIGlmIGtleSBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gW21heChjaGFpbihoZWFkLCBpdCkpXQogICAgICAgIHJldHVybiBbbWF4KGNoYWluKGhlYWQsIGl0KSwga2V5PWtleSldCgogICAgIyBXaGVuIG4+PXNpemUsIGl0J3MgZmFzdGVyIHRvIHVzZSBzb3J0ZWQoKQogICAgdHJ5OgogICAgICAgIHNpemUgPSBsZW4oaXRlcmFibGUpCiAgICBleGNlcHQgKFR5cGVFcnJvciwgQXR0cmlidXRlRXJyb3IpOgogICAgICAgIHBhc3MKICAgIGVsc2U6CiAgICAgICAgaWYgbiA+PSBzaXplOgogICAgICAgICAgICByZXR1cm4gc29ydGVkKGl0ZXJhYmxlLCBrZXk9a2V5LCByZXZlcnNlPVRydWUpWzpuXQoKICAgICMgV2hlbiBrZXkgaXMgbm9uZSwgdXNlIHNpbXBsZXIgZGVjb3JhdGlvbgogICAgaWYga2V5IGlzIE5vbmU6CiAgICAgICAgaXQgPSB6aXAoaXRlcmFibGUsIGNvdW50KDAsLTEpKSAgICAgICAgICAgICAgICAgICAgICMgZGVjb3JhdGUKICAgICAgICByZXN1bHQgPSBfbmxhcmdlc3QobiwgaXQpCiAgICAgICAgcmV0dXJuIFtyWzBdIGZvciByIGluIHJlc3VsdF0gICAgICAgICAgICAgICAgICAgICAgICMgdW5kZWNvcmF0ZQoKICAgICMgR2VuZXJhbCBjYXNlLCBzbG93ZXN0IG1ldGhvZAogICAgaW4xLCBpbjIgPSB0ZWUoaXRlcmFibGUpCiAgICBpdCA9IHppcChtYXAoa2V5LCBpbjEpLCBjb3VudCgwLC0xKSwgaW4yKSAgICAgICAgICAgICAgICMgZGVjb3JhdGUKICAgIHJlc3VsdCA9IF9ubGFyZ2VzdChuLCBpdCkKICAgIHJldHVybiBbclsyXSBmb3IgciBpbiByZXN1bHRdICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB1bmRlY29yYXRlCg==',
'/Lib/io.py':'b3BlbiA9IG9wZW4K',
'/Lib/itertools.py':'aW1wb3J0IG9wZXJhdG9yCgpjbGFzcyBhY2N1bXVsYXRlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGl0ZXJhYmxlLCBmdW5jID0gb3BlcmF0b3IuYWRkKToKICAgICAgICBzZWxmLml0ID0gaXRlcihpdGVyYWJsZSkKICAgICAgICBzZWxmLl90b3RhbCA9IE5vbmUKICAgICAgICBzZWxmLmZ1bmMgPSBmdW5jCiAgICAgICAgCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgaWYgbm90IHNlbGYuX3RvdGFsOgogICAgICAgICAgICBzZWxmLl90b3RhbCA9IG5leHQoc2VsZi5pdCkKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX3RvdGFsCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZWxlbWVudCA9IG5leHQoc2VsZi5pdCkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VsZi5fdG90YWwgPSBzZWxmLmZ1bmMoc2VsZi5fdG90YWwsIGVsZW1lbnQpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigidW5zdXBwb3J0ZWQgb3BlcmFuZCB0eXBlIikKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX3RvdGFsCiAgICAgICAgICAgICAgICAKIyMgQWRhcHRlZCBmcm9tOgojIyBodHRwczovL2JpdGJ1Y2tldC5vcmcvcHlweS9weXB5L3NyYy9jMWFhNzRjMDZlODYvbGliX3B5cHkvaXRlcnRvb2xzLnB5I2NsLTM0CmNsYXNzIGNoYWluOgogICAgZGVmIF9faW5pdF9fKHNlbGYsICppdGVyYWJsZXMpOgogICAgICAgIHNlbGYuX2l0ZXJhYmxlc19pdGVyID0gaXRlcihtYXAoaXRlciwgaXRlcmFibGVzKSkKICAgICAgICAjIGxpdHRsZSB0cmljayBmb3IgdGhlIGZpcnN0IGNoYWluLl9fbmV4dF9fKCkgY2FsbAogICAgICAgIHNlbGYuX2N1cl9pdGVyYWJsZV9pdGVyID0gaXRlcihbXSkKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKICAgIAogICAgZGVmIF9fbmV4dF9fKHNlbGYpOgogICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHJldHVybiBuZXh0KHNlbGYuX2N1cl9pdGVyYWJsZV9pdGVyKQogICAgICAgICAgICBleGNlcHQgU3RvcEl0ZXJhdGlvbjoKICAgICAgICAgICAgICAgIHNlbGYuX2N1cl9pdGVyYWJsZV9pdGVyID0gbmV4dChzZWxmLl9pdGVyYWJsZXNfaXRlcikKICAgIAogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbV9pdGVyYWJsZShjbHMsIGl0ZXJhYmxlKToKICAgICAgICBmb3IgaXQgaW4gaXRlcmFibGU6CiAgICAgICAgICAgIGZvciBlbGVtZW50IGluIGl0OgogICAgICAgICAgICAgICAgeWllbGQgZWxlbWVudAogICAgICAgICAgICAgICAgCmNsYXNzIGNvbWJpbmF0aW9uczoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpdGVyYWJsZSwgcik6CiAgICAgICAgc2VsZi5wb29sID0gdHVwbGUoaXRlcmFibGUpCiAgICAgICAgc2VsZi5uID0gbGVuKHNlbGYucG9vbCkKICAgICAgICBzZWxmLnIgPSByCiAgICAgICAgc2VsZi5pbmRpY2VzID0gbGlzdChyYW5nZShzZWxmLnIpKQogICAgICAgIHNlbGYuemVybyA9IEZhbHNlCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fbmV4dF9fKHNlbGYpOgogICAgICAgIGlmIHNlbGYuciA+IHNlbGYubjoKICAgICAgICAgICAgcmFpc2UgU3RvcEl0ZXJhdGlvbgogICAgICAgIGlmIG5vdCBzZWxmLnplcm86CiAgICAgICAgICAgIHNlbGYuemVybyA9IFRydWUKICAgICAgICAgICAgcmV0dXJuIHR1cGxlKHNlbGYucG9vbFtpXSBmb3IgaSBpbiBzZWxmLmluZGljZXMpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZm9yIGkgaW4gcmV2ZXJzZWQocmFuZ2Uoc2VsZi5yKSk6CiAgICAgICAgICAgICAgICAgICAgaWYgc2VsZi5pbmRpY2VzW2ldICE9IGkgKyBzZWxmLm4gLSBzZWxmLnI6CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBzZWxmLmluZGljZXNbaV0gKz0gMQogICAgICAgICAgICAgICAgZm9yIGogaW4gcmFuZ2UoaSsxLCBzZWxmLnIpOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaW5kaWNlc1tqXSA9IHNlbGYuaW5kaWNlc1tqLTFdICsgMQogICAgICAgICAgICAgICAgcmV0dXJuIHR1cGxlKHNlbGYucG9vbFtpXSBmb3IgaSBpbiBzZWxmLmluZGljZXMpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHJhaXNlIFN0b3BJdGVyYXRpb24KICAgICAgICAgICAgICAgIApjbGFzcyBjb21iaW5hdGlvbnNfd2l0aF9yZXBsYWNlbWVudDoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpdGVyYWJsZSwgcik6CiAgICAgICAgc2VsZi5wb29sID0gdHVwbGUoaXRlcmFibGUpCiAgICAgICAgc2VsZi5uID0gbGVuKHNlbGYucG9vbCkKICAgICAgICBzZWxmLnIgPSByCiAgICAgICAgc2VsZi5pbmRpY2VzID0gWzBdICogc2VsZi5yCiAgICAgICAgc2VsZi56ZXJvID0gRmFsc2UKICAgICAgICAKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgogICAgCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgaWYgbm90IHNlbGYubiBhbmQgc2VsZi5yOgogICAgICAgICAgICByYWlzZSBTdG9wSXRlcmF0aW9uCiAgICAgICAgaWYgbm90IHNlbGYuemVybzoKICAgICAgICAgICAgc2VsZi56ZXJvID0gVHJ1ZQogICAgICAgICAgICByZXR1cm4gdHVwbGUoc2VsZi5wb29sW2ldIGZvciBpIGluIHNlbGYuaW5kaWNlcykKICAgICAgICBlbHNlOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBmb3IgaSBpbiByZXZlcnNlZChyYW5nZShzZWxmLnIpKToKICAgICAgICAgICAgICAgICAgICBpZiBzZWxmLmluZGljZXNbaV0gIT0gc2VsZi5uIC0gMToKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIHNlbGYuaW5kaWNlc1tpOl0gPSBbc2VsZi5pbmRpY2VzW2ldICsgMV0gKiAoc2VsZi5yIC0gaSkKICAgICAgICAgICAgICAgIHJldHVybiB0dXBsZShzZWxmLnBvb2xbaV0gZm9yIGkgaW4gc2VsZi5pbmRpY2VzKQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICByYWlzZSBTdG9wSXRlcmF0aW9uCiAgICAgICAgICAgICAgICAKIyMgTGl0ZXJhbGx5IGNvcGllZCBmcm9tCiMjaHR0cHM6Ly9iaXRidWNrZXQub3JnL3B5cHkvcHlweS9zcmMvYzFhYTc0YzA2ZTg2L2xpYl9weXB5L2l0ZXJ0b29scy5weSNjbC02MyAKY2xhc3MgY29tcHJlc3M6CiAgICBkZWYgX19pbml0X18oc2VsZiwgZGF0YSwgc2VsZWN0b3JzKToKICAgICAgICBzZWxmLmRhdGEgPSBpdGVyKGRhdGEpCiAgICAgICAgc2VsZi5zZWxlY3RvcnMgPSBpdGVyKHNlbGVjdG9ycykKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgbmV4dF9pdGVtID0gbmV4dChzZWxmLmRhdGEpCiAgICAgICAgICAgIG5leHRfc2VsZWN0b3IgPSBuZXh0KHNlbGYuc2VsZWN0b3JzKQogICAgICAgICAgICBpZiBib29sKG5leHRfc2VsZWN0b3IpOgogICAgICAgICAgICAgICAgcmV0dXJuIG5leHRfaXRlbQogICAgICAgICAgICAgICAgCiMjIEFkYXB0ZWQgZnJvbQojI2h0dHBzOi8vYml0YnVja2V0Lm9yZy9weXB5L3B5cHkvc3JjL2MxYWE3NGMwNmU4Ni9saWJfcHlweS9pdGVydG9vbHMucHkjY2wtNzkKIyMgSSBtaW1pY2tlZCB0aGUgPiBweXRob24zLjEgYmVoYXZpb3IKY2xhc3MgY291bnQ6CiAgICAiIiIKICAgIElucHV0IGlzIGFuIGludCBvciBhIGZsb2F0LiBUaGUgb3JpZ2luYWwgUHl0aG9uIDMgaW1wbGVtZW50YXRpb24KICAgIGluY2x1ZGVzIGFsc28gY29tcGxleCBudW1iZXJzLi4uIGJ1dCBpdCBzdGlsbCBpcyBub3QgaW1wbGVtZW50ZWQgCiAgICBpbiBCcnl0aG9uIGFzIGNvbXBsZXggdHlwZSBpcyBOb3RJbXBsZW1lbnRlZAogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgc3RhcnQgPSAwLCBzdGVwID0gMSk6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uoc3RhcnQsIChpbnQsIGZsb2F0KSk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcignYSBudW1iZXIgaXMgcmVxdWlyZWQnKQogICAgICAgIHNlbGYudGltZXMgPSBzdGFydCAtIHN0ZXAKICAgICAgICBzZWxmLnN0ZXAgPSBzdGVwCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fbmV4dF9fKHNlbGYpOgogICAgICAgIHNlbGYudGltZXMgKz0gc2VsZi5zdGVwCiAgICAgICAgcmV0dXJuIHNlbGYudGltZXMKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICdjb3VudCglZCknICUgKHNlbGYudGltZXMgKyBzZWxmLnN0ZXApCgojIyBMaXRlcmFsbHkgY29waWVkIGZyb20KIyNodHRwczovL2JpdGJ1Y2tldC5vcmcvcHlweS9weXB5L3NyYy9jMWFhNzRjMDZlODYvbGliX3B5cHkvaXRlcnRvb2xzLnB5I2NsLTExMiAgICAgICAgCmNsYXNzIGN5Y2xlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGl0ZXJhYmxlKToKICAgICAgICBzZWxmLl9jdXJfaXRlciA9IGl0ZXIoaXRlcmFibGUpCiAgICAgICAgc2VsZi5fc2F2ZWQgPSBbXQogICAgICAgIHNlbGYuX211c3Rfc2F2ZSA9IFRydWUKICAgICAgICAKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX25leHRfXyhzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIG5leHRfZWx0ID0gbmV4dChzZWxmLl9jdXJfaXRlcikKICAgICAgICAgICAgaWYgc2VsZi5fbXVzdF9zYXZlOgogICAgICAgICAgICAgICAgc2VsZi5fc2F2ZWQuYXBwZW5kKG5leHRfZWx0KQogICAgICAgIGV4Y2VwdCBTdG9wSXRlcmF0aW9uOgogICAgICAgICAgICBzZWxmLl9jdXJfaXRlciA9IGl0ZXIoc2VsZi5fc2F2ZWQpCiAgICAgICAgICAgIG5leHRfZWx0ID0gbmV4dChzZWxmLl9jdXJfaXRlcikKICAgICAgICAgICAgc2VsZi5fbXVzdF9zYXZlID0gRmFsc2UKICAgICAgICByZXR1cm4gbmV4dF9lbHQKICAgICAgICAKIyMgTGl0ZXJhbGx5IGNvcGllZCBmcm9tCiMjaHR0cHM6Ly9iaXRidWNrZXQub3JnL3B5cHkvcHlweS9zcmMvYzFhYTc0YzA2ZTg2L2xpYl9weXB5L2l0ZXJ0b29scy5weSNjbC0xNDkKY2xhc3MgZHJvcHdoaWxlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHByZWRpY2F0ZSwgaXRlcmFibGUpOgogICAgICAgIHNlbGYuX3ByZWRpY2F0ZSA9IHByZWRpY2F0ZQogICAgICAgIHNlbGYuX2l0ZXIgPSBpdGVyKGl0ZXJhYmxlKQogICAgICAgIHNlbGYuX2Ryb3BwZWQgPSBGYWxzZQoKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX25leHRfXyhzZWxmKToKICAgICAgICB2YWx1ZSA9IG5leHQoc2VsZi5faXRlcikKICAgICAgICBpZiBzZWxmLl9kcm9wcGVkOgogICAgICAgICAgICByZXR1cm4gdmFsdWUKICAgICAgICB3aGlsZSBzZWxmLl9wcmVkaWNhdGUodmFsdWUpOgogICAgICAgICAgICB2YWx1ZSA9IG5leHQoc2VsZi5faXRlcikKICAgICAgICBzZWxmLl9kcm9wcGVkID0gVHJ1ZQogICAgICAgIHJldHVybiB2YWx1ZQogICAgICAgIAojIyBBZGFwdGVkIGZyb20KIyNodHRwczovL2JpdGJ1Y2tldC5vcmcvcHlweS9weXB5L3NyYy9jMWFhNzRjMDZlODYvbGliX3B5cHkvaXRlcnRvb2xzLnB5I2NsLTI2MQpjbGFzcyBmaWx0ZXJmYWxzZToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBwcmVkaWNhdGUsIGl0ZXJhYmxlKToKICAgICAgICAjIE1ha2Ugc3VyZSBpdGVyYWJsZSAqSVMqIGl0ZXJhYmxlCiAgICAgICAgc2VsZi5faXRlciA9IGl0ZXIoaXRlcmFibGUpCiAgICAgICAgaWYgcHJlZGljYXRlIGlzIE5vbmU6CiAgICAgICAgICAgIHNlbGYuX3ByZWRpY2F0ZSA9IGJvb2wKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl9wcmVkaWNhdGUgPSBwcmVkaWNhdGUKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKICAgIGRlZiBfX25leHRfXyhzZWxmKToKICAgICAgICBuZXh0X2VsdCA9IG5leHQoc2VsZi5faXRlcikKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICBpZiBub3Qgc2VsZi5fcHJlZGljYXRlKG5leHRfZWx0KToKICAgICAgICAgICAgICAgIHJldHVybiBuZXh0X2VsdAogICAgICAgICAgICBuZXh0X2VsdCA9IG5leHQoc2VsZi5faXRlcikKCmNsYXNzIGdyb3VwYnk6CiAgICAjIyBUTy1ETwogICAgcGFzcwogICAgICAgICAgCiMjIGFkYXB0ZWQgZnJvbQojI2h0dHBzOi8vYml0YnVja2V0Lm9yZy9weXB5L3B5cHkvc3JjL2MxYWE3NGMwNmU4Ni9saWJfcHlweS9pdGVydG9vbHMucHkjY2wtMzIzCmNsYXNzIGlzbGljZToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpdGVyYWJsZSwgKmFyZ3MpOgogICAgICAgIHMgPSBzbGljZSgqYXJncykKICAgICAgICBzZWxmLnN0YXJ0LCBzZWxmLnN0b3AsIHNlbGYuc3RlcCA9IHMuc3RhcnQgb3IgMCwgcy5zdG9wLCBzLnN0ZXAKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShzZWxmLnN0YXJ0LCBpbnQpOgogICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIlN0YXJ0IGFyZ3VtZW50IG11c3QgYmUgYW4gaW50ZWdlciIpCiAgICAgICAgaWYgc2VsZi5zdG9wICE9IE5vbmUgYW5kIG5vdCBpc2luc3RhbmNlKHNlbGYuc3RvcCwgaW50KToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiU3RvcCBhcmd1bWVudCBtdXN0IGJlIGFuIGludGVnZXIgb3IgTm9uZSIpCiAgICAgICAgaWYgc2VsZi5zdGVwIGlzIE5vbmU6CiAgICAgICAgICAgIHNlbGYuc3RlcCA9IDEKICAgICAgICBpZiBzZWxmLnN0YXJ0PDAgb3IgKHNlbGYuc3RvcCAhPSBOb25lIGFuZCBzZWxmLnN0b3A8MAogICAgICAgICAgICkgb3Igc2VsZi5zdGVwPD0wOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJpbmRpY2VzIGZvciBpc2xpY2UoKSBtdXN0IGJlIHBvc2l0aXZlIikKICAgICAgICBzZWxmLml0ID0gaXRlcihpdGVyYWJsZSkKICAgICAgICBzZWxmLmRvbmV4dCA9IE5vbmUKICAgICAgICBzZWxmLmNudCA9IDAKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgbmV4dGluZGV4ID0gc2VsZi5zdGFydAogICAgICAgIGlmIHNlbGYuc3RvcCAhPSBOb25lIGFuZCBuZXh0aW5kZXggPj0gc2VsZi5zdG9wOgogICAgICAgICAgICByYWlzZSBTdG9wSXRlcmF0aW9uCiAgICAgICAgd2hpbGUgc2VsZi5jbnQgPD0gbmV4dGluZGV4OgogICAgICAgICAgICBuZXh0aXRlbSA9IG5leHQoc2VsZi5pdCkKICAgICAgICAgICAgc2VsZi5jbnQgKz0gMQogICAgICAgIHNlbGYuc3RhcnQgKz0gc2VsZi5zdGVwIAogICAgICAgIHJldHVybiBuZXh0aXRlbQogICAgICAgIApjbGFzcyBwZXJtdXRhdGlvbnM6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaXRlcmFibGUsIHIgPSBOb25lKToKICAgICAgICBzZWxmLnBvb2wgPSB0dXBsZShpdGVyYWJsZSkKICAgICAgICBzZWxmLm4gPSBsZW4oc2VsZi5wb29sKQogICAgICAgIHNlbGYuciA9IHNlbGYubiBpZiByIGlzIE5vbmUgZWxzZSByCiAgICAgICAgc2VsZi5pbmRpY2VzID0gbGlzdChyYW5nZShzZWxmLm4pKQogICAgICAgIHNlbGYuY3ljbGVzID0gbGlzdChyYW5nZShzZWxmLm4sIHNlbGYubiAtIHIsIC0xKSkKICAgICAgICBzZWxmLnplcm8gPSBGYWxzZQogICAgICAgIHNlbGYuc3RvcCA9IEZhbHNlCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fbmV4dF9fKHNlbGYpOgogICAgICAgIGluZGljZXMgPSBzZWxmLmluZGljZXMKICAgICAgICBpZiBzZWxmLnIgPiBzZWxmLm46CiAgICAgICAgICAgIHJhaXNlIFN0b3BJdGVyYXRpb24KICAgICAgICBpZiBub3Qgc2VsZi56ZXJvOgogICAgICAgICAgICBzZWxmLnplcm8gPSBUcnVlCiAgICAgICAgICAgIHJldHVybiB0dXBsZShzZWxmLnBvb2xbaV0gZm9yIGkgaW4gaW5kaWNlc1s6c2VsZi5yXSkKICAgICAgICAKICAgICAgICBpID0gc2VsZi5yIC0gMQogICAgICAgIHdoaWxlIGkgPj0gMDoKICAgICAgICAgICAgaiA9IHNlbGYuY3ljbGVzW2ldIC0gMQogICAgICAgICAgICBpZiBqID4gMDoKICAgICAgICAgICAgICAgIHNlbGYuY3ljbGVzW2ldID0gagogICAgICAgICAgICAgICAgaW5kaWNlc1tpXSwgaW5kaWNlc1stal0gPSBpbmRpY2VzWy1qXSwgaW5kaWNlc1tpXQogICAgICAgICAgICAgICAgcmV0dXJuIHR1cGxlKHNlbGYucG9vbFtpXSBmb3IgaSBpbiBpbmRpY2VzWzpzZWxmLnJdKQogICAgICAgICAgICBzZWxmLmN5Y2xlc1tpXSA9IGxlbihpbmRpY2VzKSAtIGkKICAgICAgICAgICAgbjEgPSBsZW4oaW5kaWNlcykgLSAxCiAgICAgICAgICAgIGFzc2VydCBuMSA+PSAwCiAgICAgICAgICAgIG51bSA9IGluZGljZXNbaV0KICAgICAgICAgICAgZm9yIGsgaW4gcmFuZ2UoaSwgbjEpOgogICAgICAgICAgICAgICAgaW5kaWNlc1trXSA9IGluZGljZXNbaysxXQogICAgICAgICAgICBpbmRpY2VzW24xXSA9IG51bQogICAgICAgICAgICBpIC09IDEKICAgICAgICByYWlzZSBTdG9wSXRlcmF0aW9uCgojIyBhZGFwdGVkIGZyb20KIyNodHRwczovL2JpdGJ1Y2tldC5vcmcvcHlweS9weXB5L3NyYy9jMWFhNzRjMDZlODYvbGliX3B5cHkvaXRlcnRvb2xzLnB5I2NsLTM5MiAgICAgICAgCmNsYXNzIHByb2R1Y3Q6CiAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3cpOgogICAgICAgIGlmIGxlbihrdykgPiAxOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoInByb2R1Y3QoKSB0YWtlcyBhdCBtb3N0IDEgYXJndW1lbnQgKCVkIGdpdmVuKSIgJQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlbihrdykpCiAgICAgICAgc2VsZi5yZXBlYXQgPSBrdy5nZXQoJ3JlcGVhdCcsIDEpCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uoc2VsZi5yZXBlYXQsIGludCk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiaW50ZWdlciBhcmd1bWVudCBleHBlY3RlZCwgZ290ICVzIiAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZShzZWxmLnJlcGVhdCkpCiAgICAgICAgc2VsZi5nZWFycyA9IFt4IGZvciB4IGluIGFyZ3NdICogc2VsZi5yZXBlYXQKICAgICAgICBzZWxmLm51bV9nZWFycyA9IGxlbihzZWxmLmdlYXJzKQogICAgICAgICMgaW5pdGlhbGl6YXRpb24gb2YgaW5kaWNpZXMgdG8gbG9vcCBvdmVyCiAgICAgICAgc2VsZi5pbmRpY2llcyA9IFsoMCwgbGVuKHNlbGYuZ2VhcnNbeF0pKQogICAgICAgICAgICAgICAgICAgICAgICAgZm9yIHggaW4gcmFuZ2UoMCwgc2VsZi5udW1fZ2VhcnMpXQogICAgICAgIHNlbGYuY29udCA9IFRydWUKICAgICAgICBzZWxmLnplcm8gPSBGYWxzZQoKICAgIGRlZiByb2xsX2dlYXJzKHNlbGYpOgogICAgICAgICMgU3RhcnRpbmcgZnJvbSB0aGUgZW5kIG9mIHRoZSBnZWFyIGluZGljaWVzIHdvcmsgdG8gdGhlIGZyb250CiAgICAgICAgIyBpbmNyZW1lbnRpbmcgdGhlIGdlYXIgdW50aWwgdGhlIGxpbWl0IGlzIHJlYWNoZWQuIFdoZW4gdGhlIGxpbWl0CiAgICAgICAgIyBpcyByZWFjaGVkIGNhcnJ5IG9wZXJhdGlvbiB0byB0aGUgbmV4dCBnZWFyCiAgICAgICAgc2hvdWxkX2NhcnJ5ID0gVHJ1ZQogICAgICAgIGZvciBuIGluIHJhbmdlKDAsIHNlbGYubnVtX2dlYXJzKToKICAgICAgICAgICAgbnRoX2dlYXIgPSBzZWxmLm51bV9nZWFycyAtIG4gLSAxCiAgICAgICAgICAgIGlmIHNob3VsZF9jYXJyeToKICAgICAgICAgICAgICAgIGNvdW50LCBsaW0gPSBzZWxmLmluZGljaWVzW250aF9nZWFyXQogICAgICAgICAgICAgICAgY291bnQgKz0gMQogICAgICAgICAgICAgICAgaWYgY291bnQgPT0gbGltIGFuZCBudGhfZ2VhciA9PSAwOgogICAgICAgICAgICAgICAgICAgIHNlbGYuY29udCA9IEZhbHNlCiAgICAgICAgICAgICAgICBpZiBjb3VudCA9PSBsaW06CiAgICAgICAgICAgICAgICAgICAgc2hvdWxkX2NhcnJ5ID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgIGNvdW50ID0gMAogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzaG91bGRfY2FycnkgPSBGYWxzZQogICAgICAgICAgICAgICAgc2VsZi5pbmRpY2llc1tudGhfZ2Vhcl0gPSAoY291bnQsIGxpbSkgIAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgYnJlYWsKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgaWYgc2VsZi56ZXJvOgogICAgICAgICAgICByYWlzZSBTdG9wSXRlcmF0aW9uCiAgICAgICAgaWYgc2VsZi5yZXBlYXQgPiAwOgogICAgICAgICAgICBpZiBub3Qgc2VsZi5jb250OgogICAgICAgICAgICAgICAgcmFpc2UgU3RvcEl0ZXJhdGlvbgogICAgICAgICAgICBsID0gW10KICAgICAgICAgICAgZm9yIHggaW4gcmFuZ2UoMCwgc2VsZi5udW1fZ2VhcnMpOgogICAgICAgICAgICAgICAgaW5kZXgsIGxpbWl0ID0gc2VsZi5pbmRpY2llc1t4XQogICAgICAgICAgICAgICAgbC5hcHBlbmQoc2VsZi5nZWFyc1t4XVtpbmRleF0pCiAgICAgICAgICAgIHNlbGYucm9sbF9nZWFycygpCiAgICAgICAgICAgIHJldHVybiB0dXBsZShsKQogICAgICAgIGVsaWYgc2VsZi5yZXBlYXQgPT0gMDoKICAgICAgICAgICAgc2VsZi56ZXJvID0gVHJ1ZQogICAgICAgICAgICByZXR1cm4gKCkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJyZXBlYXQgYXJndW1lbnQgY2Fubm90IGJlIG5lZ2F0aXZlIikKICAgICAgICAgICAgCiMjIExpdGVyYWxseSBjb3BpZWQgZnJvbQojI2h0dHBzOi8vYml0YnVja2V0Lm9yZy9weXB5L3B5cHkvc3JjL2MxYWE3NGMwNmU4Ni9saWJfcHlweS9pdGVydG9vbHMucHkjY2wtNDQxCmNsYXNzIHJlcGVhdDoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBvYmosIHRpbWVzPU5vbmUpOgogICAgICAgIHNlbGYuX29iaiA9IG9iagogICAgICAgIGlmIHRpbWVzIGlzIG5vdCBOb25lOgogICAgICAgICAgICByYW5nZSh0aW1lcykgIyBSYWlzZSBhIFR5cGVFcnJvcgogICAgICAgICAgICBpZiB0aW1lcyA8IDA6CiAgICAgICAgICAgICAgICB0aW1lcyA9IDAKICAgICAgICBzZWxmLl90aW1lcyA9IHRpbWVzCiAgICAgICAgCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgIyBfX25leHRfXygpICpuZWVkKiB0byBkZWNyZW1lbnQgc2VsZi5fdGltZXMgd2hlbiBjb25zdW1lZAogICAgICAgIGlmIHNlbGYuX3RpbWVzIGlzIG5vdCBOb25lOgogICAgICAgICAgICBpZiBzZWxmLl90aW1lcyA8PSAwOiAKICAgICAgICAgICAgICAgIHJhaXNlIFN0b3BJdGVyYXRpb24oKQogICAgICAgICAgICBzZWxmLl90aW1lcyAtPSAxCiAgICAgICAgcmV0dXJuIHNlbGYuX29iagoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICBpZiBzZWxmLl90aW1lcyBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmV0dXJuICdyZXBlYXQoJXIsICVyKScgJSAoc2VsZi5fb2JqLCBzZWxmLl90aW1lcykKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gJ3JlcGVhdCglciknICUgKHNlbGYuX29iaiwpCgogICAgZGVmIF9fbGVuX18oc2VsZik6CiAgICAgICAgaWYgc2VsZi5fdGltZXMgPT0gLTEgb3Igc2VsZi5fdGltZXMgaXMgTm9uZToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJsZW4oKSBvZiB1bmlzemVkIG9iamVjdCIpCiAgICAgICAgcmV0dXJuIHNlbGYuX3RpbWVzCgojIyBBZGFwdGVkIGZyb20KIyNodHRwczovL2JpdGJ1Y2tldC5vcmcvcHlweS9weXB5L3NyYy9jMWFhNzRjMDZlODYvbGliX3B5cHkvaXRlcnRvb2xzLnB5I2NsLTQ4OQpjbGFzcyBzdGFybWFwKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgZnVuY3Rpb24sIGl0ZXJhYmxlKToKICAgICAgICBzZWxmLl9mdW5jID0gZnVuY3Rpb24KICAgICAgICBzZWxmLl9pdGVyID0gaXRlcihpdGVyYWJsZSkKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgdCA9IG5leHQoc2VsZi5faXRlcikKICAgICAgICByZXR1cm4gc2VsZi5fZnVuYygqdCkKICAgICAgICAKIyMgTGl0ZXJhbGx5IGNvcGllZCBmcm9tCiMjaHR0cHM6Ly9iaXRidWNrZXQub3JnL3B5cHkvcHlweS9zcmMvYzFhYTc0YzA2ZTg2L2xpYl9weXB5L2l0ZXJ0b29scy5weSNjbC01MjAKY2xhc3MgdGFrZXdoaWxlKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgcHJlZGljYXRlLCBpdGVyYWJsZSk6CiAgICAgICAgc2VsZi5fcHJlZGljYXRlID0gcHJlZGljYXRlCiAgICAgICAgc2VsZi5faXRlciA9IGl0ZXIoaXRlcmFibGUpCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fbmV4dF9fKHNlbGYpOgogICAgICAgIHZhbHVlID0gbmV4dChzZWxmLl9pdGVyKQogICAgICAgIGlmIG5vdCBzZWxmLl9wcmVkaWNhdGUodmFsdWUpOgogICAgICAgICAgICByYWlzZSBTdG9wSXRlcmF0aW9uKCkKICAgICAgICByZXR1cm4gdmFsdWUKCiMjIEFsbW9zdCBsaXRlcmFsIGZyb20KIyNodHRwczovL2JpdGJ1Y2tldC5vcmcvcHlweS9weXB5L3NyYy9jMWFhNzRjMDZlODYvbGliX3B5cHkvaXRlcnRvb2xzLnB5I2NsLTU0NwpjbGFzcyBUZWVEYXRhKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaXRlcmF0b3IpOgogICAgICAgIHNlbGYuZGF0YSA9IFtdCiAgICAgICAgc2VsZi5faXRlciA9IGl0ZXJhdG9yCgogICAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGkpOgogICAgICAgICMgaXRlcmF0ZXMgdW50aWwgJ2knIGlmIG5vdCBkb25lIHlldAogICAgICAgIHdoaWxlIGk+PSBsZW4oc2VsZi5kYXRhKToKICAgICAgICAgICAgc2VsZi5kYXRhLmFwcGVuZChuZXh0KHNlbGYuX2l0ZXIpKQogICAgICAgIHJldHVybiBzZWxmLmRhdGFbaV0KCgpjbGFzcyBUZWVPYmplY3Qob2JqZWN0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpdGVyYWJsZT1Ob25lLCB0ZWVfZGF0YT1Ob25lKToKICAgICAgICBpZiB0ZWVfZGF0YToKICAgICAgICAgICAgc2VsZi50ZWVfZGF0YSA9IHRlZV9kYXRhCiAgICAgICAgICAgIHNlbGYucG9zID0gMAogICAgICAgICMgPD0+IENvcHkgY29uc3RydWN0b3IKICAgICAgICBlbGlmIGlzaW5zdGFuY2UoaXRlcmFibGUsIFRlZU9iamVjdCk6CiAgICAgICAgICAgIHNlbGYudGVlX2RhdGEgPSBpdGVyYWJsZS50ZWVfZGF0YQogICAgICAgICAgICBzZWxmLnBvcyA9IGl0ZXJhYmxlLnBvcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYudGVlX2RhdGEgPSBUZWVEYXRhKGl0ZXIoaXRlcmFibGUpKQogICAgICAgICAgICBzZWxmLnBvcyA9IDAKICAgICAgICAgICAgCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgZGF0YSA9IHNlbGYudGVlX2RhdGFbc2VsZi5wb3NdCiAgICAgICAgc2VsZi5wb3MgKz0gMQogICAgICAgIHJldHVybiBkYXRhCiAgICAKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgoKCmRlZiB0ZWUoaXRlcmFibGUsIG49Mik6CiAgICBpZiBpc2luc3RhbmNlKGl0ZXJhYmxlLCBUZWVPYmplY3QpOgogICAgICAgIHJldHVybiB0dXBsZShbaXRlcmFibGVdICsKICAgICAgICBbVGVlT2JqZWN0KHRlZV9kYXRhPWl0ZXJhYmxlLnRlZV9kYXRhKSBmb3IgaSBpbiByYW5nZShuIC0gMSldKQogICAgdGVlX2RhdGEgPSBUZWVEYXRhKGl0ZXIoaXRlcmFibGUpKQogICAgcmV0dXJuIHR1cGxlKFtUZWVPYmplY3QodGVlX2RhdGE9dGVlX2RhdGEpIGZvciBpIGluIHJhbmdlKG4pXSkKCmNsYXNzIHppcF9sb25nZXN0OgogICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCBmaWxsdmFsdWUgPSBOb25lKToKICAgICAgICBzZWxmLmFyZ3MgPSBhcmdzCiAgICAgICAgc2VsZi5maWxsdmFsdWUgPSBmaWxsdmFsdWUKICAgICAgICBzZWxmLm1heF9sZW5ndGggPSBtYXgoW2xlbihhcmcpIGZvciBhcmcgaW4gc2VsZi5hcmdzXSkKICAgICAgICBzZWxmLnVuaXRzID0gbGVuKGFyZ3MpCiAgICAgICAgc2VsZi5jb3VudGVyID0gMAogICAgCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKICAgIAogICAgZGVmIF9fbmV4dF9fKHNlbGYpOgogICAgICAgIGlmIHNlbGYuY291bnRlciA9PSBzZWxmLm1heF9sZW5ndGg6CiAgICAgICAgICAgIHJhaXNlIFN0b3BJdGVyYXRpb24KICAgICAgICBlbHNlOgogICAgICAgICAgICB0ZW1wID0gW10KICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2Uoc2VsZi51bml0cyk6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgdGVtcC5hcHBlbmQoc2VsZi5hcmdzW2ldW3NlbGYuY291bnRlcl0pCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgdGVtcC5hcHBlbmQoc2VsZi5maWxsdmFsdWUpCiAgICAgICAgICAgIHNlbGYuY291bnRlciA9IHNlbGYuY291bnRlciArIDEKICAgICAgICAgICAgcmV0dXJuIHR1cGxlKHRlbXAp',
'/Lib/keyword.py':'a3dsaXN0ID0gWwojLS1zdGFydCBrZXl3b3Jkcy0tCiAgICAgICAgJ0ZhbHNlJywKICAgICAgICAnTm9uZScsCiAgICAgICAgJ1RydWUnLAogICAgICAgICdhbmQnLAogICAgICAgICdhcycsCiAgICAgICAgJ2Fzc2VydCcsCiAgICAgICAgJ2JyZWFrJywKICAgICAgICAnY2xhc3MnLAogICAgICAgICdjb250aW51ZScsCiAgICAgICAgJ2RlZicsCiAgICAgICAgJ2RlbCcsCiAgICAgICAgJ2VsaWYnLAogICAgICAgICdlbHNlJywKICAgICAgICAnZXhjZXB0JywKICAgICAgICAnZmluYWxseScsCiAgICAgICAgJ2ZvcicsCiAgICAgICAgJ2Zyb20nLAogICAgICAgICdnbG9iYWwnLAogICAgICAgICdpZicsCiAgICAgICAgJ2ltcG9ydCcsCiAgICAgICAgJ2luJywKICAgICAgICAnaXMnLAogICAgICAgICdsYW1iZGEnLAogICAgICAgICdub25sb2NhbCcsCiAgICAgICAgJ25vdCcsCiAgICAgICAgJ29yJywKICAgICAgICAncGFzcycsCiAgICAgICAgJ3JhaXNlJywKICAgICAgICAncmV0dXJuJywKICAgICAgICAndHJ5JywKICAgICAgICAnd2hpbGUnLAogICAgICAgICd3aXRoJywKICAgICAgICAneWllbGQnLAojLS1lbmQga2V5d29yZHMtLQogICAgICAgIF0KCmRlZiBpc2tleXdvcmQod29yZCk6CiAgICByZXR1cm4gd29yZCBpbiBrd2xpc3QK',
'/Lib/linecache.py':'IiIiQ2FjaGUgbGluZXMgZnJvbSBmaWxlcy4KClRoaXMgaXMgaW50ZW5kZWQgdG8gcmVhZCBsaW5lcyBmcm9tIG1vZHVsZXMgaW1wb3J0ZWQgLS0gaGVuY2UgaWYgYSBmaWxlbmFtZQppcyBub3QgZm91bmQsIGl0IHdpbGwgbG9vayBkb3duIHRoZSBtb2R1bGUgc2VhcmNoIHBhdGggZm9yIGEgZmlsZSBieQp0aGF0IG5hbWUuCiIiIgoKaW1wb3J0IHN5cwppbXBvcnQgb3MKI2ZpeG1lIGJyeXRob24KI2ltcG9ydCB0b2tlbml6ZQoKX19hbGxfXyA9IFsiZ2V0bGluZSIsICJjbGVhcmNhY2hlIiwgImNoZWNrY2FjaGUiXQoKZGVmIGdldGxpbmUoZmlsZW5hbWUsIGxpbmVubywgbW9kdWxlX2dsb2JhbHM9Tm9uZSk6CiAgICBsaW5lcyA9IGdldGxpbmVzKGZpbGVuYW1lLCBtb2R1bGVfZ2xvYmFscykKICAgIGlmIDEgPD0gbGluZW5vIDw9IGxlbihsaW5lcyk6CiAgICAgICAgcmV0dXJuIGxpbmVzW2xpbmVuby0xXQogICAgZWxzZToKICAgICAgICByZXR1cm4gJycKCgojIFRoZSBjYWNoZQoKY2FjaGUgPSB7fSAjIFRoZSBjYWNoZQoKCmRlZiBjbGVhcmNhY2hlKCk6CiAgICAiIiJDbGVhciB0aGUgY2FjaGUgZW50aXJlbHkuIiIiCgogICAgZ2xvYmFsIGNhY2hlCiAgICBjYWNoZSA9IHt9CgoKZGVmIGdldGxpbmVzKGZpbGVuYW1lLCBtb2R1bGVfZ2xvYmFscz1Ob25lKToKICAgICIiIkdldCB0aGUgbGluZXMgZm9yIGEgZmlsZSBmcm9tIHRoZSBjYWNoZS4KICAgIFVwZGF0ZSB0aGUgY2FjaGUgaWYgaXQgZG9lc24ndCBjb250YWluIGFuIGVudHJ5IGZvciB0aGlzIGZpbGUgYWxyZWFkeS4iIiIKCiAgICBpZiBmaWxlbmFtZSBpbiBjYWNoZToKICAgICAgICByZXR1cm4gY2FjaGVbZmlsZW5hbWVdWzJdCiAgICBlbHNlOgogICAgICAgIHJldHVybiB1cGRhdGVjYWNoZShmaWxlbmFtZSwgbW9kdWxlX2dsb2JhbHMpCgoKZGVmIGNoZWNrY2FjaGUoZmlsZW5hbWU9Tm9uZSk6CiAgICAiIiJEaXNjYXJkIGNhY2hlIGVudHJpZXMgdGhhdCBhcmUgb3V0IG9mIGRhdGUuCiAgICAoVGhpcyBpcyBub3QgY2hlY2tlZCB1cG9uIGVhY2ggY2FsbCEpIiIiCgogICAgaWYgZmlsZW5hbWUgaXMgTm9uZToKICAgICAgICBmaWxlbmFtZXMgPSBsaXN0KGNhY2hlLmtleXMoKSkKICAgIGVsc2U6CiAgICAgICAgaWYgZmlsZW5hbWUgaW4gY2FjaGU6CiAgICAgICAgICAgIGZpbGVuYW1lcyA9IFtmaWxlbmFtZV0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4KCiAgICBmb3IgZmlsZW5hbWUgaW4gZmlsZW5hbWVzOgogICAgICAgIHNpemUsIG10aW1lLCBsaW5lcywgZnVsbG5hbWUgPSBjYWNoZVtmaWxlbmFtZV0KICAgICAgICBpZiBtdGltZSBpcyBOb25lOgogICAgICAgICAgICBjb250aW51ZSAgICMgbm8tb3AgZm9yIGZpbGVzIGxvYWRlZCB2aWEgYSBfX2xvYWRlcl9fCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzdGF0ID0gb3Muc3RhdChmdWxsbmFtZSkKICAgICAgICAjZml4bWUgYnJ5dGhvbgogICAgICAgICNleGNlcHQgb3MuZXJyb3I6CiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBkZWwgY2FjaGVbZmlsZW5hbWVdCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgaWYgc2l6ZSAhPSBzdGF0LnN0X3NpemUgb3IgbXRpbWUgIT0gc3RhdC5zdF9tdGltZToKICAgICAgICAgICAgZGVsIGNhY2hlW2ZpbGVuYW1lXQoKCmRlZiB1cGRhdGVjYWNoZShmaWxlbmFtZSwgbW9kdWxlX2dsb2JhbHM9Tm9uZSk6CiAgICAiIiJVcGRhdGUgYSBjYWNoZSBlbnRyeSBhbmQgcmV0dXJuIGl0cyBsaXN0IG9mIGxpbmVzLgogICAgSWYgc29tZXRoaW5nJ3Mgd3JvbmcsIHByaW50IGEgbWVzc2FnZSwgZGlzY2FyZCB0aGUgY2FjaGUgZW50cnksCiAgICBhbmQgcmV0dXJuIGFuIGVtcHR5IGxpc3QuIiIiCgogICAgaWYgZmlsZW5hbWUgaW4gY2FjaGU6CiAgICAgICAgZGVsIGNhY2hlW2ZpbGVuYW1lXQogICAgaWYgbm90IGZpbGVuYW1lIG9yIChmaWxlbmFtZS5zdGFydHN3aXRoKCc8JykgYW5kIGZpbGVuYW1lLmVuZHN3aXRoKCc+JykpOgogICAgICAgIHJldHVybiBbXQoKICAgIGZ1bGxuYW1lID0gZmlsZW5hbWUKICAgIHRyeToKICAgICAgICBzdGF0ID0gb3Muc3RhdChmdWxsbmFtZSkKICAgIGV4Y2VwdCBPU0Vycm9yOgogICAgICAgIGJhc2VuYW1lID0gZmlsZW5hbWUKCiAgICAgICAgIyBUcnkgZm9yIGEgX19sb2FkZXJfXywgaWYgYXZhaWxhYmxlCiAgICAgICAgaWYgbW9kdWxlX2dsb2JhbHMgYW5kICdfX2xvYWRlcl9fJyBpbiBtb2R1bGVfZ2xvYmFsczoKICAgICAgICAgICAgbmFtZSA9IG1vZHVsZV9nbG9iYWxzLmdldCgnX19uYW1lX18nKQogICAgICAgICAgICBsb2FkZXIgPSBtb2R1bGVfZ2xvYmFsc1snX19sb2FkZXJfXyddCiAgICAgICAgICAgIGdldF9zb3VyY2UgPSBnZXRhdHRyKGxvYWRlciwgJ2dldF9zb3VyY2UnLCBOb25lKQoKICAgICAgICAgICAgaWYgbmFtZSBhbmQgZ2V0X3NvdXJjZToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBkYXRhID0gZ2V0X3NvdXJjZShuYW1lKQogICAgICAgICAgICAgICAgZXhjZXB0IChJbXBvcnRFcnJvciwgSU9FcnJvcik6CiAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBpZiBkYXRhIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgICMgTm8gbHVjaywgdGhlIFBFUDMwMiBsb2FkZXIgY2Fubm90IGZpbmQgdGhlIHNvdXJjZQogICAgICAgICAgICAgICAgICAgICAgICAjIGZvciB0aGlzIG1vZHVsZS4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtdCiAgICAgICAgICAgICAgICAgICAgY2FjaGVbZmlsZW5hbWVdID0gKAogICAgICAgICAgICAgICAgICAgICAgICBsZW4oZGF0YSksIE5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgIFtsaW5lKydcbicgZm9yIGxpbmUgaW4gZGF0YS5zcGxpdGxpbmVzKCldLCBmdWxsbmFtZQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGVbZmlsZW5hbWVdWzJdCgogICAgICAgICMgVHJ5IGxvb2tpbmcgdGhyb3VnaCB0aGUgbW9kdWxlIHNlYXJjaCBwYXRoLCB3aGljaCBpcyBvbmx5IHVzZWZ1bAogICAgICAgICMgd2hlbiBoYW5kbGluZyBhIHJlbGF0aXZlIGZpbGVuYW1lLgogICAgICAgIGlmIG9zLnBhdGguaXNhYnMoZmlsZW5hbWUpOgogICAgICAgICAgICByZXR1cm4gW10KCiAgICAgICAgIyBUYWtlIGNhcmUgdG8gaGFuZGxlIHBhY2thZ2VzLgogICAgICAgIGlmIGJhc2VuYW1lID09ICdfX2luaXRfXy5weSc6CiAgICAgICAgICAgICMgZmlsZW5hbWUgcmVmZXJlcyB0byBhIHBhY2thZ2UKICAgICAgICAgICAgYmFzZW5hbWUgPSBmaWxlbmFtZQoKICAgICAgICBmb3IgZGlybmFtZSBpbiBzeXMucGF0aDoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZnVsbG5hbWUgPSBvcy5wYXRoLmpvaW4oZGlybmFtZSwgYmFzZW5hbWUpCiAgICAgICAgICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBBdHRyaWJ1dGVFcnJvcik6CiAgICAgICAgICAgICAgICAjIE5vdCBzdWZmaWNpZW50bHkgc3RyaW5nLWxpa2UgdG8gZG8gYW55dGhpbmcgdXNlZnVsIHdpdGguCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzdGF0ID0gb3Muc3RhdChmdWxsbmFtZSkKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICNmaXhtZSBicnl0aG9uLCBpbnZhbGlkIHN5bnRheCAKICAgICAgICAgICAgI2V4Y2VwdCBvcy5lcnJvcjoKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICNmaXhtZSBicnl0aG9uIHVuZXhwZWN0ZWQgdG9rZW4gZWxzZQogICAgICAgICNlbHNlOgogICAgICAgICMgICAgcmV0dXJuIFtdCiAgICB0cnk6CiAgICAgICAgZnA9b3BlbihmdWxsbmFtZSkKICAgICAgICAjZml4bWUgYnJ5dGhvbgogICAgICAgICN3aXRoIHRva2VuaXplLm9wZW4oZnVsbG5hbWUpIGFzIGZwOgogICAgICAgIGxpbmVzID0gZnAucmVhZGxpbmVzKCkKICAgICAgICBmcC5jbG9zZSgpCiAgICBleGNlcHQgSU9FcnJvcjoKICAgICAgICByZXR1cm4gW10KICAgIGlmIGxpbmVzIGFuZCBub3QgbGluZXNbLTFdLmVuZHN3aXRoKCdcbicpOgogICAgICAgIGxpbmVzWy0xXSArPSAnXG4nCiAgICBzaXplLCBtdGltZSA9IHN0YXQuc3Rfc2l6ZSwgc3RhdC5zdF9tdGltZQogICAgY2FjaGVbZmlsZW5hbWVdID0gc2l6ZSwgbXRpbWUsIGxpbmVzLCBmdWxsbmFtZQogICAgcmV0dXJuIGxpbmVzCg==',
'/Lib/locale.py':'ZGVmIGdldGRlZmF1bHRsb2NhbGUoKToKICAgIHJldHVybiBfX0JSWVRIT05fXy5sYW5ndWFnZSxOb25l',
'/Lib/local_storage.py':'IyBsb2NhbCBzdG9yYWdlIGluIGJyb3dzZXIKCmNsYXNzIExvY2FsU3RvcmFnZToKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgaWYgbm90IF9fQlJZVEhPTl9fLmhhc19sb2NhbF9zdG9yYWdlOgogICAgICAgICAgICByYWlzZSBOYW1lRXJyb3IoJ2xvY2FsIHN0b3JhZ2UgaXMgbm90IHN1cHBvcnRlZCBieSB0aGUgYnJvd3NlcicpCiAgICAgICAgc2VsZi5zdG9yZSA9IF9fQlJZVEhPTl9fLmxvY2FsX3N0b3JhZ2UoKQogICAgICAgIAogICAgZGVmIF9fZGVsaXRlbV9fKHNlbGYsa2V5KToKICAgICAgICBzZWxmLnN0b3JlLnJlbW92ZUl0ZW0oa2V5KQoKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLGtleSk6CiAgICAgICAgcmVzPXNlbGYuc3RvcmUuZ2V0SXRlbShrZXkpCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgIHJldHVybiByZXMKICAgICAgICByYWlzZSBLZXlFcnJvcihrZXkpCgogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsa2V5LHZhbHVlKToKICAgICAgICBzZWxmLnN0b3JlLnNldEl0ZW0oa2V5LHZhbHVlKQoKICAgICNpbXBsZW1lbnQgImluIiBmdW5jdGlvbmFsaXR5CiAgICBkZWYgX19jb250YWluc19fKHNlbGYsIGtleSk6CiAgICAgICAgcmVzPXNlbGYuc3RvcmUuZ2V0SXRlbShrZXkpCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgIHJldHVybiBUcnVlCgogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBrZXlzKHNlbGYpOgogICAgICAgIHJldHVybiBsaXN0KHNlbGYuc3RvcmUpCgogICAgZGVmIHZhbHVlcyhzZWxmKToKICAgICAgICByZXR1cm4gW3NlbGYuX19nZXRpdGVtX18oaykgZm9yIGsgaW4gc2VsZi5rZXlzKCldCgogICAgZGVmIGl0ZW1zKHNlbGYpOgogICAgICAgIHJldHVybiB6aXAoc2VsZi5rZXlzKCksc2VsZi52YWx1ZXMoKSkKCnN0b3JhZ2UgPSBMb2NhbFN0b3JhZ2UoKQoK',
'/Lib/markdown.py':'aW1wb3J0IGh0bWwKaW1wb3J0IHJlCgpjbGFzcyBVUkw6CiAgICBkZWYgX19pbml0X18oc2VsZixzcmMpOgogICAgICAgIGVsdHMgPSBzcmMuc3BsaXQobWF4c3BsaXQ9MSkKICAgICAgICBzZWxmLmhyZWYgPSBlbHRzWzBdCiAgICAgICAgc2VsZi5hbHQgPSAnJwogICAgICAgIGlmIGxlbihlbHRzKT09MjoKICAgICAgICAgICAgYWx0ID0gZWx0c1sxXQogICAgICAgICAgICBpZiBhbHRbMF09PSciJyBhbmQgYWx0Wy0xXT09JyInOnNlbGYuYWx0PWFsdFsxOi0xXQogICAgICAgICAgICBlbGlmIGFsdFswXT09IiciIGFuZCBhbHRbLTFdPT0iJyI6c2VsZi5hbHQ9YWx0WzE6LTFdCiAgICAgICAgICAgIGVsaWYgYWx0WzBdPT0iKCIgYW5kIGFsdFstMV09PSIpIjpzZWxmLmFsdD1hbHRbMTotMV0KICAgICAgICAKY2xhc3MgQ29kZUJsb2NrOgogICAgZGVmIF9faW5pdF9fKHNlbGYsbGluZSk6CiAgICAgICAgc2VsZi5saW5lcyA9IFtsaW5lXQogICAgCiAgICBkZWYgdG9faHRtbChzZWxmKToKICAgICAgICByZXMgPSBlc2NhcGUoJ1xuJy5qb2luKHNlbGYubGluZXMpKQogICAgICAgIHJlcyA9IHVubWFyayhyZXMpCiAgICAgICAgcmVzID0gJzxwcmUgY2xhc3M9Im1hcmtlZCI+JXM8L3ByZT5cbicgJXJlcwogICAgICAgIHJldHVybiByZXMsW10KCmNsYXNzIE1hcmtlZDoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLmxpbmVzID0gW10KICAgICAgICBzZWxmLmNoaWxkcmVuID0gW10KCiAgICBkZWYgdG9faHRtbChzZWxmKToKICAgICAgICByZXR1cm4gYXBwbHlfbWFya2Rvd24oJ1xuJy5qb2luKHNlbGYubGluZXMpKQogICAgICAgIAojIGdldCByZWZlcmVuY2VzCnJlZnMgPSB7fQpyZWZfcGF0dGVybiA9IHIiXlxbKC4qKVxdOlxzKyguKikiCgpkZWYgbWFyayhzcmMpOgoKICAgIGdsb2JhbCByZWZzCiAgICByZWZzID0ge30KICAgICMgc3BsaXQgc291cmNlIGluIHNlY3Rpb25zCiAgICAjIHNlY3Rpb25zIGNhbiBiZSA6CiAgICAjIC0gYSBibG9jay1sZXZlbCBIVE1MIGVsZW1lbnQgKG1hcmtkb3duIHN5bnRheCB3aWxsIG5vdCBiZSBwcm9jZXNzZWQpCiAgICAjIC0gYSBzY3JpcHQKICAgICMgLSBhIHNwYW4tbGV2ZWwgSFRNTCB0YWcgKG1hcmtkb3duIHN5bnRheCB3aWxsIGJlIHByb2Nlc3NlZCkKICAgICMgLSBhIGNvZGUgYmxvY2sKICAgIAogICAgbGluZXMgPSBzcmMuc3BsaXQoJ1xuJykKICAgIAogICAgc2VjdGlvbnMgPSBbXQogICAgc2NyaXB0cyA9IFtdCiAgICBzZWN0aW9uID0gTWFya2VkKCkKCiAgICBpID0gMAogICAgd2hpbGUgaTxsZW4obGluZXMpOgogICAgICAgIGxpbmUgPSBsaW5lc1tpXQogICAgICAgIGlmIGlzaW5zdGFuY2Uoc2VjdGlvbixNYXJrZWQpOgogICAgICAgICAgICBpZiBsaW5lLmxvd2VyKCkuc3RhcnRzd2l0aCgnPHNjcmlwdCcpOgogICAgICAgICAgICAgICAgaiA9IGkrMQogICAgICAgICAgICAgICAgd2hpbGUgajxsZW4obGluZXMpOgogICAgICAgICAgICAgICAgICAgIGlmIGxpbmVzW2pdLmxvd2VyKCkuc3RhcnRzd2l0aCgnPC9zY3JpcHQ+Jyk6CiAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdHMuYXBwZW5kKCdcbicuam9pbihsaW5lc1tpKzE6al0pKQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgayBpbiByYW5nZShpLGorMSk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lc1trXSA9ICcnCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgaiArPSAxCiAgICAgICAgICAgICAgICBpID0gaisxCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBpZiBsaW5lLnN0cmlwKCkgYW5kIGxpbmUuc3RhcnRzd2l0aCgnICAgICcpOgogICAgICAgICAgICAgICAgaWYgc2VjdGlvbi5saW5lczoKICAgICAgICAgICAgICAgICAgICBzZWN0aW9ucy5hcHBlbmQoc2VjdGlvbikKICAgICAgICAgICAgICAgIHNlY3Rpb24gPSBDb2RlQmxvY2sobGluZVs0Ol0pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBtbyA9IHJlLnNlYXJjaChyZWZfcGF0dGVybixsaW5lKQogICAgICAgICAgICAgICAgaWYgbW8gaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAga2V5ID0gbW8uZ3JvdXBzKClbMF0KICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IFVSTChtby5ncm91cHMoKVsxXSkKICAgICAgICAgICAgICAgICAgICByZWZzW2tleS5sb3dlcigpXSA9IHZhbHVlCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNlY3Rpb24ubGluZXMuYXBwZW5kKGxpbmUpCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKHNlY3Rpb24sQ29kZUJsb2NrKToKICAgICAgICAgICAgaWYgbGluZS5zdGFydHN3aXRoKCcgICAgJykgb3Igbm90IGxpbmUuc3RyaXAoKToKICAgICAgICAgICAgICAgIHNlY3Rpb24ubGluZXMuYXBwZW5kKGxpbmVbNDpdKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VjdGlvbnMuYXBwZW5kKHNlY3Rpb24pCiAgICAgICAgICAgICAgICBzZWN0aW9uID0gTWFya2VkKCkgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBzZWN0aW9uLmxpbmVzLmFwcGVuZChsaW5lKQogICAgICAgIGkgKz0gMQogICAgaWYgc2VjdGlvbi5saW5lczoKICAgICAgICBzZWN0aW9ucy5hcHBlbmQoc2VjdGlvbikKCiAgICByZXMgPSAnJwogICAgZm9yIHNlY3Rpb24gaW4gc2VjdGlvbnM6CiAgICAgICAgbWssX3NjcmlwdHMgPSBzZWN0aW9uLnRvX2h0bWwoKQogICAgICAgIHJlcyArPSBtawogICAgICAgIHNjcmlwdHMgKz0gX3NjcmlwdHMKICAgIHJldHVybiByZXMsc2NyaXB0cwoKZGVmIGVzY2FwZShjem9uZSk6CiAgICBjem9uZSA9IGN6b25lLnJlcGxhY2UoJyYnLCcmYW1wOycpCiAgICBjem9uZSA9IGN6b25lLnJlcGxhY2UoJzwnLCcmbHQ7JykKICAgIGN6b25lID0gY3pvbmUucmVwbGFjZSgnPicsJyZndDsnKQogICAgcmV0dXJuIGN6b25lCgpkZWYgc19lc2NhcGUobW8pOgogICAgIyB1c2VkIGluIHJlLnN1YgogICAgY3pvbmUgPSBtby5zdHJpbmdbbW8uc3RhcnQoKTptby5lbmQoKV0KICAgIHJldHVybiBlc2NhcGUoY3pvbmUpCgpkZWYgdW5tYXJrKGNvZGVfem9uZSk6CiAgICAjIGNvbnZlcnQgXyB0byAmIzk1OyBpbnNpZGUgaW5saW5lIGNvZGUKICAgIGNvZGVfem9uZSA9IGNvZGVfem9uZS5yZXBsYWNlKCdfJywnJiM5NTsnKQogICAgcmV0dXJuIGNvZGVfem9uZQoKZGVmIHNfdW5tYXJrKG1vKToKICAgICMgY29udmVydCBfIHRvICYjOTU7IGluc2lkZSBpbmxpbmUgY29kZQogICAgY29kZV96b25lID0gbW8uc3RyaW5nW21vLnN0YXJ0KCk6bW8uZW5kKCldCiAgICBjb2RlX3pvbmUgPSBjb2RlX3pvbmUucmVwbGFjZSgnXycsJyYjOTU7JykKICAgIHJldHVybiBjb2RlX3pvbmUKCmRlZiBhcHBseV9tYXJrZG93bihzcmMpOgoKICAgIHNjcmlwdHMgPSBbXQoKICAgICMgYmxvY2txdW90ZXMKICAgIGxpbmVzID0gc3JjLnNwbGl0KCdcbicpCiAgICB3aGlsZSBUcnVlOgogICAgICAgIG5iID0gMAogICAgICAgIGkgPSAwCiAgICAgICAgd2hpbGUgaTxsZW4obGluZXMpOgogICAgICAgICAgICBpZiBsaW5lc1tpXS5zdGFydHN3aXRoKCc+Jyk6CiAgICAgICAgICAgICAgICBoZWFkID0gJ1xuJy5qb2luKGxpbmVzWzppXSkKICAgICAgICAgICAgICAgIGJxbGluZXMgPSBbXQogICAgICAgICAgICAgICAgbmIgKz0gMQogICAgICAgICAgICAgICAgcmVzdCA9IGxpbmVzW2ldWzE6XQogICAgICAgICAgICAgICAgaWYgcmVzdC5sc3RyaXAoKS5zdGFydHN3aXRoKCc+Jyk6CiAgICAgICAgICAgICAgICAgICAgcmVzdCA9IHJlc3QubHN0cmlwKCkKICAgICAgICAgICAgICAgIGJxbGluZXMuYXBwZW5kKHJlc3QpCiAgICAgICAgICAgICAgICBqID0gaSsxCiAgICAgICAgICAgICAgICB3aGlsZSBqPGxlbihsaW5lcyk6CiAgICAgICAgICAgICAgICAgICAgaWYgbGluZXNbal0uc3RhcnRzd2l0aCgnPicpOgogICAgICAgICAgICAgICAgICAgICAgICByZXN0ID0gbGluZXNbal1bMTpdCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHJlc3QubHN0cmlwKCkuc3RhcnRzd2l0aCgnPicpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdCA9IHJlc3QubHN0cmlwKCkKICAgICAgICAgICAgICAgICAgICAgICAgYnFsaW5lcy5hcHBlbmQocmVzdCkKICAgICAgICAgICAgICAgICAgICAgICAgaiArPSAxCiAgICAgICAgICAgICAgICAgICAgZWxpZiBsaW5lc1tqXS5zdHJpcCgpIGFuZCBsaW5lc1tqXVswXSE9JyAnOgogICAgICAgICAgICAgICAgICAgICAgICBicWxpbmVzLmFwcGVuZChsaW5lc1tqXSkKICAgICAgICAgICAgICAgICAgICAgICAgaiArPSAxCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICMgYnFsaW5lcyBob2xkcyB0aGUgbGluZXMgaW4gdGhlIGJsb2NrcXVvdGUsIHN0cmlwcGVkIG9mCiAgICAgICAgICAgICAgICAjIHRoZSBsZWFkaW5nID4KICAgICAgICAgICAgICAgICMgd2UgYXBwbHkgdGhlIHdob2xlIG1hcmtkb3duIHByb2Nlc3MgdG8gdGhlc2UgbGluZXMKICAgICAgICAgICAgICAgIG1rLF9zY3JpcHRzID0gbWFyaygnXG4nLmpvaW4oYnFsaW5lcykpCiAgICAgICAgICAgICAgICBzY3JpcHRzICs9IF9zY3JpcHRzCiAgICAgICAgICAgICAgICBzcmMgPSBoZWFkCiAgICAgICAgICAgICAgICBzcmMgKz0gJ1xuPGJsb2NrcXVvdGU+JyArIG1rICsgJzwvYmxvY2txdW90ZT4nCiAgICAgICAgICAgICAgICBzcmMgKz0gJ1xuJy5qb2luKGxpbmVzW2o6XSkKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGkgKz0gMQogICAgICAgIGlmIG5iPT0wOmJyZWFrCiAgICAgICAgbGluZXMgPSBzcmMuc3BsaXRsaW5lcygpCgogICAgIyByZXBsYWNlIFxgIGJ5ICYjOTY7CiAgICBzcmMgPSByZS5zdWIocidcXFxgJywnJiM5NjsnLHNyYykKCiAgICAjIGVzY2FwZSA8ID4gJiBpbiBpbmxpbmUgY29kZQogICAgY29kZV9wYXR0ZXJuID0gcidcYChcUy4qP1xTKVxgJwogICAgc3JjID0gcmUuc3ViKGNvZGVfcGF0dGVybixzX2VzY2FwZSxzcmMpCiAgICAjIGFsc28gY29udmVydCBfCiAgICBzcmMgPSByZS5zdWIoY29kZV9wYXR0ZXJuLHNfdW5tYXJrLHNyYykKICAgIAogICAgIyBpbmxpbmUgbGlua3MKICAgIGxpbmtfcGF0dGVybjEgPSByJ1xbKC4rPylcXVxzP1woKC4rPylcKScKICAgIGRlZiByZXBsKG1vKToKICAgICAgICBnMSxnMiA9IG1vLmdyb3VwcygpCiAgICAgICAgZzIgPSByZS5zdWIoJ18nLCcmIzk1OycsZzIpCiAgICAgICAgcmV0dXJuICc8YSBocmVmPSIlcyI+JXM8L2E+JyAlKGcyLGcxKQogICAgc3JjID0gcmUuc3ViKGxpbmtfcGF0dGVybjEscmVwbCxzcmMpCgogICAgIyByZWZlcmVuY2UgbGlua3MKICAgIGxpbmtfcGF0dGVybjIgPSByJ1xbKC4rPylcXVxzP1xbKC4qPylcXScKICAgIHdoaWxlIFRydWU6CiAgICAgICAgbW8gPSByZS5zZWFyY2gobGlua19wYXR0ZXJuMixzcmMpCiAgICAgICAgaWYgbW8gaXMgTm9uZTpicmVhawogICAgICAgIHRleHQsa2V5ID0gbW8uZ3JvdXBzKCkKICAgICAgICBwcmludCh0ZXh0LGtleSkKICAgICAgICBpZiBub3Qga2V5OmtleT10ZXh0ICMgaW1wbGljaXQgbGluayBuYW1lCiAgICAgICAgaWYga2V5Lmxvd2VyKCkgbm90IGluIHJlZnM6CiAgICAgICAgICAgIHJhaXNlIEtleUVycm9yKCd1bmtub3cgcmVmZXJlbmNlICVzJyAla2V5KQogICAgICAgIHVybCA9IHJlZnNba2V5Lmxvd2VyKCldCiAgICAgICAgcmVwbCA9ICc8YSBocmVmPSInK3VybC5ocmVmKyciJwogICAgICAgIGlmIHVybC5hbHQ6CiAgICAgICAgICAgIHJlcGwgKz0gJyB0aXRsZT0iJyt1cmwuYWx0KyciJwogICAgICAgIHJlcGwgKz0gJz4lczwvYT4nICV0ZXh0CiAgICAgICAgc3JjID0gcmUuc3ViKGxpbmtfcGF0dGVybjIscmVwbCxzcmMsY291bnQ9MSkKCiAgICAjIGVtcGhhc2lzCgogICAgIyByZXBsYWNlIFwqIGJ5ICYjNDI7CiAgICBzcmMgPSByZS5zdWIocidcXFwqJywnJiM0MjsnLHNyYykKICAgICMgcmVwbGFjZSBcXyBieSAmIzk1OwogICAgc3JjID0gcmUuc3ViKHInXFxcXycsJyYjOTU7JyxzcmMpCiAgICAjIF8gYW5kICogc3Vycm91bmRlZCBieSBzcGFjZXMgYXJlIG5vdCBtYXJrdXAKICAgIHNyYyA9IHJlLnN1YihyJyBfICcsJyAmIzk1OyAnLHNyYykKICAgIHNyYyA9IHJlLnN1YihyJyBcKiAnLCcgJiM0MjsgJyxzcmMpCgogICAgc3Ryb25nX3BhdHRlcm5zID0gWygnU1RST05HJyxyJ1wqXCooLio/KVwqXConKSwoJ0InLHInX18oLio/KV9fJyldCiAgICBmb3IgdGFnLHN0cm9uZ19wYXR0ZXJuIGluIHN0cm9uZ19wYXR0ZXJuczoKICAgICAgICBzcmMgPSByZS5zdWIoc3Ryb25nX3BhdHRlcm4scic8JXM+XDE8LyVzPicgJSh0YWcsdGFnKSxzcmMpCgogICAgZW1fcGF0dGVybnMgPSBbKCdFTScscidcKiguKj8pXConKSwoJ0knLHInXF8oLio/KVxfJyldCiAgICBmb3IgdGFnLGVtX3BhdHRlcm4gaW4gZW1fcGF0dGVybnM6CiAgICAgICAgc3JjID0gcmUuc3ViKGVtX3BhdHRlcm4scic8JXM+XDE8LyVzPicgJSh0YWcsdGFnKSxzcmMpCgogICAgIyBpbmxpbmUgY29kZQogICAgIyByZXBsYWNlIFxgIGJ5ICYjOTY7CiAgICBzcmMgPSByZS5zdWIocidcXFxgJywnJiM5NjsnLHNyYykKCiAgICBjb2RlX3BhdHRlcm4gPSByJ1xgKC4qPylcYCcKICAgIHNyYyA9IHJlLnN1Yihjb2RlX3BhdHRlcm4scic8Y29kZT5cMTwvY29kZT4nLHNyYykKCiAgICAjIHVub3JkZXJlZCBsaXN0cwogICAgbGluZXMgPSBzcmMuc3BsaXQoJ1xuJykKICAgIHdoaWxlIFRydWU6CiAgICAgICAgbmIgPSAwCiAgICAgICAgaSA9IDAKICAgICAgICB3aGlsZSBpPGxlbihsaW5lcyk6CiAgICAgICAgICAgIG1vID0gcmUuc2VhcmNoKHInXiggKlsrKi1dKScsbGluZXNbaV0pCiAgICAgICAgICAgIGlmIG1vOgogICAgICAgICAgICAgICAgc3RhcnRlciA9IG1vLmdyb3VwcygpWzBdCiAgICAgICAgICAgICAgICBpZiBub3QgbGluZXNbaV0uc3RyaXAoc3RhcnRlcik6CiAgICAgICAgICAgICAgICAgICAgaSArPSAxCiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIG5iICs9IDEKICAgICAgICAgICAgICAgIGxpbmVzW2ldID0gJzx1bD5cbjxsaT4nK2xpbmVzW2ldW2xlbihzdGFydGVyKTpdCiAgICAgICAgICAgICAgICBqID0gaSsxCiAgICAgICAgICAgICAgICB3aGlsZSBqPGxlbihsaW5lcyk6CiAgICAgICAgICAgICAgICAgICAgaWYgbGluZXNbal0uc3RhcnRzd2l0aChzdGFydGVyKToKICAgICAgICAgICAgICAgICAgICAgICAgbGluZXNbal0gPSAnPGxpPicrbGluZXNbal1bbGVuKHN0YXJ0ZXIpOl0KICAgICAgICAgICAgICAgICAgICAgICAgaiArPSAxCiAgICAgICAgICAgICAgICAgICAgZWxpZiBsaW5lc1tqXS5zdGFydHN3aXRoKCcgJykgYW5kIGxpbmVzW2pdLmxzdHJpcCgpLnN0YXJ0c3dpdGgoc3RhcnRlcik6CiAgICAgICAgICAgICAgICAgICAgICAgIGogKz0gMQogICAgICAgICAgICAgICAgICAgIGVsaWYgbm90IGxpbmVzW2pdLnN0cmlwKCk6CiAgICAgICAgICAgICAgICAgICAgICAgIGorPTEKICAgICAgICAgICAgICAgICAgICBlbGlmIGxpbmVzW2pdLnN0YXJ0c3dpdGgoJyAnKmxlbihzdGFydGVyKSk6CiAgICAgICAgICAgICAgICAgICAgICAgIGorPTEKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgbGluZXNbai0xXSArPSAnXG48L3VsPicKICAgICAgICAgICAgaSArPSAxCiAgICAgICAgc3JjID0gJ1xuJy5qb2luKGxpbmVzKQogICAgICAgIGlmIG5iPT0wOmJyZWFrCiAgICAgICAgbGluZXMgPSBzcmMuc3BsaXRsaW5lcygpCgogICAgIyBvcmRlcmVkIGxpc3RzCiAgICBsaW5lcyA9IHNyYy5zcGxpdCgnXG4nKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICBuYiA9IDAKICAgICAgICBpID0gMAogICAgICAgIHdoaWxlIGk8bGVuKGxpbmVzKToKICAgICAgICAgICAgaWYgcmUuc2VhcmNoKHInXlxkK1wuJyxsaW5lc1tpXSk6CiAgICAgICAgICAgICAgICBuYiArPSAxCiAgICAgICAgICAgICAgICBsaW5lc1tpXSA9ICc8b2w+XG48bGk+JytsaW5lc1tpXVtsaW5lc1tpXS5maW5kKCcuJykrMTpdCiAgICAgICAgICAgICAgICBqID0gaSsxCiAgICAgICAgICAgICAgICB3aGlsZSBqPGxlbihsaW5lcyk6CiAgICAgICAgICAgICAgICAgICAgaWYgcmUuc2VhcmNoKHInXlxkK1wuJyxsaW5lc1tqXSk6CiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVzW2pdID0gJzxsaT4nK2xpbmVzW2pdW2xpbmVzW2pdLmZpbmQoJy4nKSsxOl0KICAgICAgICAgICAgICAgICAgICAgICAgaiArPSAxCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGxpbmVzW2otMV0gKz0gJ1xuPC9vbD4nCiAgICAgICAgICAgIGkgKz0gMQogICAgICAgIHNyYyA9ICdcbicuam9pbihsaW5lcykKICAgICAgICBpZiBuYj09MDpicmVhawogICAgICAgIGxpbmVzID0gc3JjLnNwbGl0bGluZXMoKQoKICAgICMgaGVhZGVycwogICAgaSA9IDEKICAgIHdoaWxlIGk8bGVuKGxpbmVzKToKICAgICAgICBsaW5lID0gbGluZXNbaV0KICAgICAgICBpZiBsaW5lLnN0YXJ0c3dpdGgoJz0nKSBhbmQgbm90IGxpbmUuc3RyaXAoJz0nKS5zdHJpcCgpOgogICAgICAgICAgICBsaW5lc1tpLTFdID0gJzxIMT4lczwvSDE+JyAlbGluZXNbaS0xXQogICAgICAgICAgICBkZWwgbGluZXNbaV0KICAgICAgICBlbGlmIGxpbmUuc3RhcnRzd2l0aCgnLScpIGFuZCBub3QgbGluZS5zdHJpcCgnLScpLnN0cmlwKCk6CiAgICAgICAgICAgIGxpbmVzW2ktMV0gPSAnPEgyPiVzPC9IMj4nICVsaW5lc1tpLTFdCiAgICAgICAgICAgIGRlbCBsaW5lc1tpXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGkgKz0gMQogICAgICAgICAgIAogICAgYXR4X2hlYWRlcl9wYXR0ZXJuID0gJ14oIyspKC4qKSgjKiknCiAgICBmb3IgaSxsaW5lIGluIGVudW1lcmF0ZShsaW5lcyk6CiAgICAgICAgbW8gPSByZS5zZWFyY2goYXR4X2hlYWRlcl9wYXR0ZXJuLGxpbmUpCiAgICAgICAgaWYgbm90IG1vOmNvbnRpbnVlCiAgICAgICAgbGV2ZWwgPSBsZW4obW8uZ3JvdXBzKClbMF0pCiAgICAgICAgbGluZXNbaV0gPSByZS5zdWIoYXR4X2hlYWRlcl9wYXR0ZXJuLAogICAgICAgICAgICAnPEglcz4lczwvSCVzPlxuJyAlKGxldmVsLG1vLmdyb3VwcygpWzFdLGxldmVsKSwKICAgICAgICAgICAgbGluZSxjb3VudD0xKQoKICAgIHNyYyA9ICdcbicuam9pbihsaW5lcykgICAgICAKICAgIHNyYyA9IHJlLnN1YignXG5cbisnLCdcbjxwPicsc3JjKSsnXG4nCgogICAgcmV0dXJuIHNyYyxzY3JpcHRzCg==',
'/Lib/operator.py':'IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoiIiIKT3BlcmF0b3IgSW50ZXJmYWNlCgpUaGlzIG1vZHVsZSBleHBvcnRzIGEgc2V0IG9mIGZ1bmN0aW9ucyBjb3JyZXNwb25kaW5nIHRvIHRoZSBpbnRyaW5zaWMgCm9wZXJhdG9ycyBvZiBQeXRob24uICBGb3IgZXhhbXBsZSwgb3BlcmF0b3IuYWRkKHgsIHkpIGlzIGVxdWl2YWxlbnQgCnRvIHRoZSBleHByZXNzaW9uIHgreS4gIFRoZSBmdW5jdGlvbiBuYW1lcyBhcmUgdGhvc2UgdXNlZCBmb3Igc3BlY2lhbCAKbWV0aG9kczsgdmFyaWFudHMgd2l0aG91dCBsZWFkaW5nIGFuZCB0cmFpbGluZyAnX18nIGFyZSBhbHNvIHByb3ZpZGVkIApmb3IgY29udmVuaWVuY2UuCgpUaGlzIGlzIHRoZSBwdXJlIFB5dGhvbiBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgbW9kdWxlLgoiIiIKCiMgZG93bmxvYWRlZCBmcm9tIGh0dHA6Ly9idWdzLnB5dGhvbi5vcmcvZmlsZTI4MzI3L29wZXJhdG9yLnB5CgojaW1wb3J0IGJ1aWx0aW5zIGFzIF9iaSAgI3RoZXJlIGlzIG5vIGJ1aWx0aW5zIG1vZHVsZQoKZGVmIGx0KGEsIGIpOgogICAgIlNhbWUgYXMgYSA8IGIuIgogICAgcmV0dXJuIGEgPCBiCl9fbHRfXyA9IGx0CgpkZWYgbGUoYSwgYik6CiAgICAiU2FtZSBhcyBhIDw9IGIuIgogICAgcmV0dXJuIGEgPD0gYgpfX2xlX18gPSBsZQoKZGVmIGVxKGEsIGIpOgogICAgIlNhbWUgYXMgYSA9PSBiLiIKICAgIHJldHVybiBhID09IGIKX19lcV9fID0gZXEKCmRlZiBuZShhLCBiKToKICAgICJTYW1lIGFzIGEgIT0gYi4iCiAgICByZXR1cm4gYSAhPSBiCl9fbmVfXyA9IG5lCgpkZWYgZ2UoYSwgYik6CiAgICAiU2FtZSBhcyBhID49IGIuIgogICAgcmV0dXJuIGEgPj0gYgpfX2dlX18gPSBnZQoKZGVmIGd0KGEsIGIpOgogICAgIlNhbWUgYXMgYSA+IGIuIgogICAgcmV0dXJuIGEgPiBiCl9fZ3RfXyA9IGd0CgpkZWYgbm90XyhhKToKICAgICJTYW1lIGFzIG5vdCBhLiIKICAgIHJldHVybiBub3QgYQpfX25vdF9fID0gbm90XwoKZGVmIHRydXRoKGEpOgogICAgIlJldHVybiBUcnVlIGlmIGEgaXMgdHJ1ZSwgRmFsc2Ugb3RoZXJ3aXNlLiIKICAgICNyZXR1cm4gX2JpLmJvb2woYSkKICAgIHJldHVybiBib29sKGEpCgpkZWYgaXNfKGEsIGIpOgogICAgIlNhbWUgYXMgYSBpcyBiLiIKICAgIHJldHVybiBhIGlzIGIKCiMgYnJ5dGhvbiBkb2VzIG5vdCBsaWtlICAoY2F1c2VzIHN5bnRheCBlcnJvcikKI2RlZiBpc19ub3QoYSwgYik6CiMgICAgIlNhbWUgYXMgYSBpcyBub3QgYi4iCiMgICAgcmV0dXJuIGEgaXMgbm90IGIKCiNyZWN1cnNpb24gZXJyb3Igb3IganVzdCBjb21tZW50IG91dCBhbmQgYWRkIGNvZGUgYmVsb3cgZnVuY3Rpb24KI2RlZiBhYnMoYSk6CiMgICAgIlNhbWUgYXMgYWJzKGEpLiIKIyAgICAjcmV0dXJuIF9iaS5hYnMoYSkKIyAgICByZXR1cm4gYWJzKGEpCl9fYWJzX18gPSBhYnMKYWJzPWFicwoKCmRlZiBhZGQoYSwgYik6CiAgICAiU2FtZSBhcyBhICsgYi4iCiAgICByZXR1cm4gYSArIGIKX19hZGRfXyA9IGFkZAoKZGVmIGFuZF8oYSwgYik6CiAgICAiU2FtZSBhcyBhICYgYi4iCiAgICByZXR1cm4gYSAmIGIKX19hbmRfXyA9IGFuZF8KCmRlZiBmbG9vcmRpdihhLCBiKToKICAgICJTYW1lIGFzIGEgLy8gYi4iCiAgICByZXR1cm4gYSAvLyBiCl9fZmxvb3JkaXZfXyA9IGZsb29yZGl2CgpkZWYgaW5kZXgoYSk6CiAgICAiU2FtZSBhcyBhLl9faW5kZXhfXygpLiIKICAgIHJldHVybiBhLl9faW5kZXhfXygpCl9faW5kZXhfXyA9IGluZGV4CgpkZWYgaW52KGEpOgogICAgIlNhbWUgYXMgfmEuIgogICAgI3JldHVybiB+YSAgICAjYnJ5dGhvbiBkb2VzIG5vdCBsaWtlCiAgICByZXR1cm4gYV4oMioqMzEpCmludmVydCA9IF9faW52X18gPSBfX2ludmVydF9fID0gaW52CgpkZWYgbHNoaWZ0KGEsIGIpOgogICAgIlNhbWUgYXMgYSA8PCBiLiIKICAgIHJldHVybiBhIDw8IGIKX19sc2hpZnRfXyA9IGxzaGlmdAoKZGVmIG1vZChhLCBiKToKICAgICJTYW1lIGFzIGEgJSBiLiIKICAgIHJldHVybiBhICUgYgpfX21vZF9fID0gbW9kCgpkZWYgbXVsKGEsIGIpOgogICAgIlNhbWUgYXMgYSAqIGIuIgogICAgcmV0dXJuIGEgKiBiCl9fbXVsX18gPSBtdWwKCmRlZiBuZWcoYSk6CiAgICAiU2FtZSBhcyAtYS4iCiAgICByZXR1cm4gLWEKX19uZWdfXyA9IG5lZwoKZGVmIG9yXyhhLCBiKToKICAgICJTYW1lIGFzIGEgfCBiLiIKICAgIHJldHVybiBhIHwgYgpfX29yX18gPSBvcl8KCmRlZiBwb3MoYSk6CiAgICAiU2FtZSBhcyArYS4iCiAgICAjcmV0dXJuICthICAgICNicnl0aG9uIGRvZXMgbm90IGxpa2UKICAgIGlmIGEgPj0gMDogcmV0dXJuIGEKICAgIHJldHVybiAtYQpfX3Bvc19fID0gcG9zCgpkZWYgcG93KGEsIGIpOgogICAgIlNhbWUgYXMgYSAqKiBiLiIKICAgIHJldHVybiBhICoqIGIKX19wb3dfXyA9IHBvdwoKZGVmIHJzaGlmdChhLCBiKToKICAgICJTYW1lIGFzIGEgPj4gYi4iCiAgICByZXR1cm4gYSA+PiBiCl9fcnNoaWZ0X18gPSByc2hpZnQKCmRlZiBzdWIoYSwgYik6CiAgICAiU2FtZSBhcyBhIC0gYi4iCiAgICByZXR1cm4gYSAtIGIKX19zdWJfXyA9IHN1YgoKZGVmIHRydWVkaXYoYSwgYik6CiAgICAiU2FtZSBhcyBhIC8gYi4iCiAgICByZXR1cm4gYSAvIGIKX190cnVlZGl2X18gPSB0cnVlZGl2CgpkZWYgeG9yKGEsIGIpOgogICAgIlNhbWUgYXMgYSBeIGIuIgogICAgcmV0dXJuIGEgXiBiCl9feG9yX18gPSB4b3IKCmRlZiBjb25jYXQoYSwgYik6CiAgICAiU2FtZSBhcyBhICsgYiwgZm9yIGEgYW5kIGIgc2VxdWVuY2VzLiIKICAgIGlmIG5vdCAoaGFzYXR0cihhLCAnX19nZXRpdGVtX18nKSBhbmQgaGFzYXR0cihiLCAnX19nZXRpdGVtX18nKSk6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdhIGFuZCBiIG11c3QgYmUgc2VxdWVuY2VzJykKICAgIHJldHVybiBhICsgYgpfX2NvbmNhdF9fID0gY29uY2F0CgpkZWYgY29udGFpbnMoYSwgYik6CiAgICAiU2FtZSBhcyBiIGluIGEgKG5vdGUgcmV2ZXJzZWQgb3BlcmFuZHMpLiIKICAgIHJldHVybiBiIGluIGEKX19jb250YWluc19fID0gY29udGFpbnMKCmRlZiBjb3VudE9mKGEsIGIpOgogICAgIlJldHVybiB0aGUgbnVtYmVyIG9mIHRpbWVzIGIgb2NjdXJzIGluIGEuIgogICAgY291bnQgPSAwCiAgICBmb3IgaSBpbiBhOgogICAgICAgIGlmIGkgPT0gYjoKICAgICAgICAgICAgY291bnQgKz0gMQogICAgcmV0dXJuIGNvdW50CgpkZWYgZGVsaXRlbShhLCBiKToKICAgICJTYW1lIGFzIGRlbCBhW2JdLiIKICAgIGRlbCBhW2JdCl9fZGVsaXRlbV9fID0gZGVsaXRlbQoKZGVmIGdldGl0ZW0oYSwgYik6CiAgICAiU2FtZSBhcyBhW2JdLiIKICAgIHJldHVybiBhW2JdCl9fZ2V0aXRlbV9fID0gZ2V0aXRlbQoKI2ZpeG1lICBicnl0aG9uIGRvZXNuJ3QgbGlrZSB0aGlzIGZ1bmN0aW9uCiNkZWYgaW5kZXhPZihhLCBiKToKIyAgICAiUmV0dXJuIHRoZSBmaXJzdCBpbmRleCBvZiBiIGluIGEuIgojICAgIGZvciBpLCBqIGluIF9iaS5lbnVtZXJhdGUoYSk6CiMgICAgICAgIGlmIGogPT0gYjoKIyAgICAgICAgICAgIHJldHVybiBpCiMgICAgZWxzZToKIyAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignYiBub3QgZm91bmQgaW4gYScpCgpkZWYgc2V0aXRlbShhLCBiLCBjKToKICAgICJTYW1lIGFzIGFbYl0gPSBjLiIKICAgIGFbYl0gPSBjCl9fc2V0aXRlbV9fID0gc2V0aXRlbQoKCgpjbGFzcyBhdHRyZ2V0dGVyOgogICAgIiIiCiAgICBSZXR1cm4gYSBjYWxsYWJsZSBvYmplY3QgdGhhdCBmZXRjaGVzIHRoZSBnaXZlbiBhdHRyaWJ1dGUocykgZnJvbSBpdHMgb3BlcmFuZC4KICAgIEFmdGVyIGY9YXR0cmdldHRlcignbmFtZScpLCB0aGUgY2FsbCBmKHIpIHJldHVybnMgci5uYW1lLgogICAgQWZ0ZXIgZz1hdHRyZ2V0dGVyKCduYW1lJywgJ2RhdGUnKSwgdGhlIGNhbGwgZyhyKSByZXR1cm5zIChyLm5hbWUsIHIuZGF0ZSkuCiAgICBBZnRlciBoPWF0dHJnZXR0ZXIoJ25hbWUuZmlyc3QnLCAnbmFtZS5sYXN0JyksIHRoZSBjYWxsIGgocikgcmV0dXJucwogICAgKHIubmFtZS5maXJzdCwgci5uYW1lLmxhc3QpLgogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgYXR0ciwgKmF0dHJzKToKICAgICAgICBzZWxmLl9hdHRycyA9IChhdHRyLCkKICAgICAgICBzZWxmLl9hdHRycyArPSBhdHRycwogICAgICAgIGlmIGFueShub3QgaXNpbnN0YW5jZShhdHRyLCBzdHIpIGZvciBhdHRyIGluIHNlbGYuX2F0dHJzKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdhdHRyaWJ1dGUgbmFtZSBtdXN0IGJlIGEgc3RyaW5nJykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX3Jlc29sdmVfYXR0cihvYmosIGF0dHIpOgogICAgICAgIGZvciBuYW1lIGluIGF0dHIuc3BsaXQoJy4nKToKICAgICAgICAgICAgI29iaiA9IF9iaS5nZXRhdHRyKG9iaiwgbmFtZSkKICAgICAgICAgICAgb2JqID0gZ2V0YXR0cihvYmosIG5hbWUpCiAgICAgICAgcmV0dXJuIG9iagoKICAgIGRlZiBfX2NhbGxfXyhzZWxmLCBvYmopOgogICAgICAgIGlmIGxlbihzZWxmLl9hdHRycykgPT0gMToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX3Jlc29sdmVfYXR0cihvYmosIHNlbGYuX2F0dHJzWzBdKQogICAgICAgIHJldHVybiB0dXBsZShzZWxmLl9yZXNvbHZlX2F0dHIob2JqLCBhdHRyKSBmb3IgYXR0ciBpbiBzZWxmLl9hdHRycykKCmNsYXNzIGl0ZW1nZXR0ZXI6CiAgICAiIiIKICAgIFJldHVybiBhIGNhbGxhYmxlIG9iamVjdCB0aGF0IGZldGNoZXMgdGhlIGdpdmVuIGl0ZW0ocykgZnJvbSBpdHMgb3BlcmFuZC4KICAgIEFmdGVyIGY9aXRlbWdldHRlcigyKSwgdGhlIGNhbGwgZihyKSByZXR1cm5zIHJbMl0uCiAgICBBZnRlciBnPWl0ZW1nZXR0ZXIoMiw1LDMpLCB0aGUgY2FsbCBnKHIpIHJldHVybnMgKHJbMl0sIHJbNV0sIHJbM10pCiAgICAiIiIKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpdGVtLCAqaXRlbXMpOgogICAgICAgIHNlbGYuX2l0ZW1zID0gKGl0ZW0sKQogICAgICAgIHNlbGYuX2l0ZW1zICs9IGl0ZW1zCgogICAgZGVmIF9fY2FsbF9fKHNlbGYsIG9iaik6CiAgICAgICAgaWYgbGVuKHNlbGYuX2l0ZW1zKSA9PSAxOgogICAgICAgICAgICByZXR1cm4gb2JqW3NlbGYuX2l0ZW1zWzBdXQogICAgICAgIHJldHVybiB0dXBsZShvYmpbaXRlbV0gZm9yIGl0ZW0gaW4gc2VsZi5faXRlbXMpCgpjbGFzcyBtZXRob2RjYWxsZXI6CiAgICAiIiIKICAgIFJldHVybiBhIGNhbGxhYmxlIG9iamVjdCB0aGF0IGNhbGxzIHRoZSBnaXZlbiBtZXRob2Qgb24gaXRzIG9wZXJhbmQuCiAgICBBZnRlciBmID0gbWV0aG9kY2FsbGVyKCduYW1lJyksIHRoZSBjYWxsIGYocikgcmV0dXJucyByLm5hbWUoKS4KICAgIEFmdGVyIGcgPSBtZXRob2RjYWxsZXIoJ25hbWUnLCAnZGF0ZScsIGZvbz0xKSwgdGhlIGNhbGwgZyhyKSByZXR1cm5zCiAgICByLm5hbWUoJ2RhdGUnLCBmb289MSkuCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgbmFtZSwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICBzZWxmLl9uYW1lID0gbmFtZQogICAgICAgIHNlbGYuX2FyZ3MgPSBhcmdzCiAgICAgICAgc2VsZi5fa3dhcmdzID0ga3dhcmdzCgogICAgZGVmIF9fY2FsbF9fKHNlbGYsIG9iaik6CiAgICAgICAgcmV0dXJuIGdldGF0dHIob2JqLCBzZWxmLl9uYW1lKSgqc2VsZi5fYXJncywgKipzZWxmLl9rd2FyZ3MpCgoKZGVmIGlhZGQoYSwgYik6CiAgICAiU2FtZSBhcyBhICs9IGIuIgogICAgYSArPSBiCiAgICByZXR1cm4gYQpfX2lhZGRfXyA9IGlhZGQKCmRlZiBpYW5kKGEsIGIpOgogICAgIlNhbWUgYXMgYSAmPSBiLiIKICAgIGEgJj0gYgogICAgcmV0dXJuIGEKX19pYW5kX18gPSBpYW5kCgpkZWYgaWNvbmNhdChhLCBiKToKICAgICJTYW1lIGFzIGEgKz0gYiwgZm9yIGEgYW5kIGIgc2VxdWVuY2VzLiIKICAgIGlmIG5vdCAoaGFzYXR0cihhLCAnX19nZXRpdGVtX18nKSBhbmQgaGFzYXR0cihiLCAnX19nZXRpdGVtX18nKSk6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdhIGFuZCBiIG11c3QgYmUgc2VxdWVuY2VzJykKICAgIGEgKz0gYgogICAgcmV0dXJuIGEKX19pY29uY2F0X18gPSBpY29uY2F0CgpkZWYgaWZsb29yZGl2KGEsIGIpOgogICAgIlNhbWUgYXMgYSAvLz0gYi4iCiAgICBhIC8vPSBiCiAgICByZXR1cm4gYQpfX2lmbG9vcmRpdl9fID0gaWZsb29yZGl2CgpkZWYgaWxzaGlmdChhLCBiKToKICAgICJTYW1lIGFzIGEgPDw9IGIuIgogICAgYSA8PD0gYgogICAgcmV0dXJuIGEKX19pbHNoaWZ0X18gPSBpbHNoaWZ0CgpkZWYgaW1vZChhLCBiKToKICAgICJTYW1lIGFzIGEgJT0gYi4iCiAgICBhICU9IGIKICAgIHJldHVybiBhCl9faW1vZF9fID0gaW1vZAoKZGVmIGltdWwoYSwgYik6CiAgICAiU2FtZSBhcyBhICo9IGIuIgogICAgYSAqPSBiCiAgICByZXR1cm4gYQpfX2ltdWxfXyA9IGltdWwKCmRlZiBpb3IoYSwgYik6CiAgICAiU2FtZSBhcyBhIHw9IGIuIgogICAgYSB8PSBiCiAgICByZXR1cm4gYQpfX2lvcl9fID0gaW9yCgpkZWYgaXBvdyhhLCBiKToKICAgICJTYW1lIGFzIGEgKio9IGIuIgogICAgYSAqKj1iCiAgICByZXR1cm4gYQpfX2lwb3dfXyA9IGlwb3cKCmRlZiBpcnNoaWZ0KGEsIGIpOgogICAgIlNhbWUgYXMgYSA+Pj0gYi4iCiAgICBhID4+PSBiCiAgICByZXR1cm4gYQpfX2lyc2hpZnRfXyA9IGlyc2hpZnQKCmRlZiBpc3ViKGEsIGIpOgogICAgIlNhbWUgYXMgYSAtPSBiLiIKICAgIGEgLT0gYgogICAgcmV0dXJuIGEKX19pc3ViX18gPSBpc3ViCgpkZWYgaXRydWVkaXYoYSwgYik6CiAgICAiU2FtZSBhcyBhIC89IGIuIgogICAgYSAvPSBiCiAgICByZXR1cm4gYQpfX2l0cnVlZGl2X18gPSBpdHJ1ZWRpdgoKZGVmIGl4b3IoYSwgYik6CiAgICAiU2FtZSBhcyBhIF49IGIuIgogICAgYSBePSBiCiAgICByZXR1cm4gYQpfX2l4b3JfXyA9IGl4b3IKCmRlZiBsZW5ndGhfaGludChvYmosIGRlZmF1bHQ9MCk6CiAgICAiIiIKICAgIFJldHVybiBhbiBlc3RpbWF0ZSBvZiB0aGUgbnVtYmVyIG9mIGl0ZW1zIGluIG9iai4KICAgIFRoaXMgaXMgdXNlZnVsIGZvciBwcmVzaXppbmcgY29udGFpbmVycyB3aGVuIGJ1aWxkaW5nIGZyb20gYW4gaXRlcmFibGUuCgogICAgSWYgdGhlIG9iamVjdCBzdXBwb3J0cyBsZW4oKSwgdGhlIHJlc3VsdCB3aWxsIGJlIGV4YWN0LiBPdGhlcndpc2UsIGl0IG1heQogICAgb3Zlci0gb3IgdW5kZXItZXN0aW1hdGUgYnkgYW4gYXJiaXRyYXJ5IGFtb3VudC4gVGhlIHJlc3VsdCB3aWxsIGJlIGFuCiAgICBpbnRlZ2VyID49IDAuCiAgICAiIiIKICAgIHRyeToKICAgICAgICByZXR1cm4gbGVuKG9iaikKICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB2YWwgPSBvYmouX19sZW5ndGhfaGludF9fKCkKICAgICAgICAgICAgaWYgdmFsIGlzIE5vdEltcGxlbWVudGVkOgogICAgICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yCiAgICAgICAgZXhjZXB0IChBdHRyaWJ1dGVFcnJvciwgVHlwZUVycm9yKToKICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHQKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBub3QgdmFsID4gMDoKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoJ2RlZmF1bHQgbXVzdCBiZSA+IDAnKQogICAgICAgICAgICByZXR1cm4gdmFsCgojdHJ5OgojICAgIGZyb20gX29wZXJhdG9yIGltcG9ydCAqCiMgICAgZnJvbSBfb3BlcmF0b3IgaW1wb3J0IF9fZG9jX18KI2V4Y2VwdCBJbXBvcnRFcnJvcjoKIyAgIHBhc3MK',
'/Lib/os.py':'aW1wb3J0IF9vcwoKbmFtZT0iYnJ5dGhvbiIKCiNhbHRzZXA9Tm9uZQojY3VyZGlyPSIuIgoKZGVmIGRldm51bGwoKToKICAgIE9TRXJyb3IoJ0Z1bmN0aW9uIGRldm51bGwgbm90IHN1cHBvcnRlZCcpCgojZXh0c2VwPScuJwoKZGVmIGdldGxvYWRhdmcoKToKICAgIE9TRXJyb3IoJ0Z1bmN0aW9uIGdldGxvYWRhdmcgbm90IHN1cHBvcnRlZCcpCgojbGluZXNlcD0iXG4iCiNwYXRoc2VwPSI7IgojcGFyZGlyPSIuLiIKI3NlcD0nLycKCmRlZiB1cmFuZG9tKGxlbmd0aCk6CiAgICBfYz1bXQogICAgZm9yIF9pIGluIHJhbmdlKGxlbmd0aCk6CiAgICAgICAgX2MuYXBwZW5kKGNocihfb3MucmFuZGludCgwLDI1NSkpKQogICAgICAgIAogICAgcmV0dXJuICcnLmpvaW4oX2MpCgojaW1wb3J0IHBvc2l4cGF0aCBhcyBwYXRoCiNzeXMubW9kdWxlc1snb3MucGF0aCddID0gcGF0aAoKI2Zyb20gb3MucGF0aCBpbXBvcnQgKGN1cmRpciwgcGFyZGlyLCBzZXAsIHBhdGhzZXAsIGRlZnBhdGgsIGV4dHNlcCwgYWx0c2VwKQoKIyBQeXRob24gdXNlcyBmaXhlZCB2YWx1ZXMgZm9yIHRoZSBTRUVLXyBjb25zdGFudHM7IHRoZXkgYXJlIG1hcHBlZAojIHRvIG5hdGl2ZSBjb25zdGFudHMgaWYgbmVjZXNzYXJ5IGluIHBvc2l4bW9kdWxlLmMKU0VFS19TRVQgPSAwClNFRUtfQ1VSID0gMQpTRUVLX0VORCA9IDIKCmRlZiB3YWxrKHRvcCwgdG9wZG93bj1UcnVlLCBvbmVycm9yPU5vbmUsIGZvbGxvd2xpbmtzPUZhbHNlKToKICAgICNyZWNlaXZlIHNjb3BlIGVycm9yIGluIGJyeXRob24KICAgICMgd2h5IGhhdmUgb3Mud2FsayBpbiBicnl0aG9uPyAgc2VydmVyIHNpZGUgamF2YXNjcmlwdCAobm9kZWpzKQogICAgIyBpbW1lZGlhdGVseSBjYW4gdXNlIG9zLndhbGsgdG8gY29tcGlsZSBsaWJzIGFuZCBMaWIgbW9kdWxlcwogICAgIyB0byBqYXZhc2NyaXB0IGVxdWl2YWxlbnQuLgogICAgT1NFcnJvcignRnVuY3Rpb24gb3Mud2FsayBub3Qgc3VwcG9ydGVkIHlldCcpCiAgICByZXR1cm4KCiAgICAiIiJEaXJlY3RvcnkgdHJlZSBnZW5lcmF0b3IuCgogICAgRm9yIGVhY2ggZGlyZWN0b3J5IGluIHRoZSBkaXJlY3RvcnkgdHJlZSByb290ZWQgYXQgdG9wIChpbmNsdWRpbmcgdG9wCiAgICBpdHNlbGYsIGJ1dCBleGNsdWRpbmcgJy4nIGFuZCAnLi4nKSwgeWllbGRzIGEgMy10dXBsZQoKICAgICAgICBkaXJwYXRoLCBkaXJuYW1lcywgZmlsZW5hbWVzCgogICAgZGlycGF0aCBpcyBhIHN0cmluZywgdGhlIHBhdGggdG8gdGhlIGRpcmVjdG9yeS4gIGRpcm5hbWVzIGlzIGEgbGlzdCBvZgogICAgdGhlIG5hbWVzIG9mIHRoZSBzdWJkaXJlY3RvcmllcyBpbiBkaXJwYXRoIChleGNsdWRpbmcgJy4nIGFuZCAnLi4nKS4KICAgIGZpbGVuYW1lcyBpcyBhIGxpc3Qgb2YgdGhlIG5hbWVzIG9mIHRoZSBub24tZGlyZWN0b3J5IGZpbGVzIGluIGRpcnBhdGguCiAgICBOb3RlIHRoYXQgdGhlIG5hbWVzIGluIHRoZSBsaXN0cyBhcmUganVzdCBuYW1lcywgd2l0aCBubyBwYXRoIGNvbXBvbmVudHMuCiAgICBUbyBnZXQgYSBmdWxsIHBhdGggKHdoaWNoIGJlZ2lucyB3aXRoIHRvcCkgdG8gYSBmaWxlIG9yIGRpcmVjdG9yeSBpbgogICAgZGlycGF0aCwgZG8gb3MucGF0aC5qb2luKGRpcnBhdGgsIG5hbWUpLgoKICAgIElmIG9wdGlvbmFsIGFyZyAndG9wZG93bicgaXMgdHJ1ZSBvciBub3Qgc3BlY2lmaWVkLCB0aGUgdHJpcGxlIGZvciBhCiAgICBkaXJlY3RvcnkgaXMgZ2VuZXJhdGVkIGJlZm9yZSB0aGUgdHJpcGxlcyBmb3IgYW55IG9mIGl0cyBzdWJkaXJlY3RvcmllcwogICAgKGRpcmVjdG9yaWVzIGFyZSBnZW5lcmF0ZWQgdG9wIGRvd24pLiAgSWYgdG9wZG93biBpcyBmYWxzZSwgdGhlIHRyaXBsZQogICAgZm9yIGEgZGlyZWN0b3J5IGlzIGdlbmVyYXRlZCBhZnRlciB0aGUgdHJpcGxlcyBmb3IgYWxsIG9mIGl0cwogICAgc3ViZGlyZWN0b3JpZXMgKGRpcmVjdG9yaWVzIGFyZSBnZW5lcmF0ZWQgYm90dG9tIHVwKS4KCiAgICBXaGVuIHRvcGRvd24gaXMgdHJ1ZSwgdGhlIGNhbGxlciBjYW4gbW9kaWZ5IHRoZSBkaXJuYW1lcyBsaXN0IGluLXBsYWNlCiAgICAoZS5nLiwgdmlhIGRlbCBvciBzbGljZSBhc3NpZ25tZW50KSwgYW5kIHdhbGsgd2lsbCBvbmx5IHJlY3Vyc2UgaW50byB0aGUKICAgIHN1YmRpcmVjdG9yaWVzIHdob3NlIG5hbWVzIHJlbWFpbiBpbiBkaXJuYW1lczsgdGhpcyBjYW4gYmUgdXNlZCB0byBwcnVuZQogICAgdGhlIHNlYXJjaCwgb3IgdG8gaW1wb3NlIGEgc3BlY2lmaWMgb3JkZXIgb2YgdmlzaXRpbmcuICBNb2RpZnlpbmcKICAgIGRpcm5hbWVzIHdoZW4gdG9wZG93biBpcyBmYWxzZSBpcyBpbmVmZmVjdGl2ZSwgc2luY2UgdGhlIGRpcmVjdG9yaWVzIGluCiAgICBkaXJuYW1lcyBoYXZlIGFscmVhZHkgYmVlbiBnZW5lcmF0ZWQgYnkgdGhlIHRpbWUgZGlybmFtZXMgaXRzZWxmIGlzCiAgICBnZW5lcmF0ZWQuCgogICAgQnkgZGVmYXVsdCBlcnJvcnMgZnJvbSB0aGUgb3MubGlzdGRpcigpIGNhbGwgYXJlIGlnbm9yZWQuICBJZgogICAgb3B0aW9uYWwgYXJnICdvbmVycm9yJyBpcyBzcGVjaWZpZWQsIGl0IHNob3VsZCBiZSBhIGZ1bmN0aW9uOyBpdAogICAgd2lsbCBiZSBjYWxsZWQgd2l0aCBvbmUgYXJndW1lbnQsIGFuIG9zLmVycm9yIGluc3RhbmNlLiAgSXQgY2FuCiAgICByZXBvcnQgdGhlIGVycm9yIHRvIGNvbnRpbnVlIHdpdGggdGhlIHdhbGssIG9yIHJhaXNlIHRoZSBleGNlcHRpb24KICAgIHRvIGFib3J0IHRoZSB3YWxrLiAgTm90ZSB0aGF0IHRoZSBmaWxlbmFtZSBpcyBhdmFpbGFibGUgYXMgdGhlCiAgICBmaWxlbmFtZSBhdHRyaWJ1dGUgb2YgdGhlIGV4Y2VwdGlvbiBvYmplY3QuCgogICAgQnkgZGVmYXVsdCwgb3Mud2FsayBkb2VzIG5vdCBmb2xsb3cgc3ltYm9saWMgbGlua3MgdG8gc3ViZGlyZWN0b3JpZXMgb24KICAgIHN5c3RlbXMgdGhhdCBzdXBwb3J0IHRoZW0uICBJbiBvcmRlciB0byBnZXQgdGhpcyBmdW5jdGlvbmFsaXR5LCBzZXQgdGhlCiAgICBvcHRpb25hbCBhcmd1bWVudCAnZm9sbG93bGlua3MnIHRvIHRydWUuCgogICAgQ2F1dGlvbjogIGlmIHlvdSBwYXNzIGEgcmVsYXRpdmUgcGF0aG5hbWUgZm9yIHRvcCwgZG9uJ3QgY2hhbmdlIHRoZQogICAgY3VycmVudCB3b3JraW5nIGRpcmVjdG9yeSBiZXR3ZWVuIHJlc3VtcHRpb25zIG9mIHdhbGsuICB3YWxrIG5ldmVyCiAgICBjaGFuZ2VzIHRoZSBjdXJyZW50IGRpcmVjdG9yeSwgYW5kIGFzc3VtZXMgdGhhdCB0aGUgY2xpZW50IGRvZXNuJ3QKICAgIGVpdGhlci4KCiAgICBFeGFtcGxlOgoKICAgIGltcG9ydCBvcwogICAgZnJvbSBvcy5wYXRoIGltcG9ydCBqb2luLCBnZXRzaXplCiAgICBmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsaygncHl0aG9uL0xpYi9lbWFpbCcpOgogICAgICAgIHByaW50KHJvb3QsICJjb25zdW1lcyIsIGVuZD0iIikKICAgICAgICBwcmludChzdW0oW2dldHNpemUoam9pbihyb290LCBuYW1lKSkgZm9yIG5hbWUgaW4gZmlsZXNdKSwgZW5kPSIiKQogICAgICAgIHByaW50KCJieXRlcyBpbiIsIGxlbihmaWxlcyksICJub24tZGlyZWN0b3J5IGZpbGVzIikKICAgICAgICBpZiAnQ1ZTJyBpbiBkaXJzOgogICAgICAgICAgICBkaXJzLnJlbW92ZSgnQ1ZTJykgICMgZG9uJ3QgdmlzaXQgQ1ZTIGRpcmVjdG9yaWVzCiAgICAiIiIKICAgICIiIgogICAgCiAgICBpc2xpbmssIGpvaW4sIGlzZGlyID0gcGF0aC5pc2xpbmssIHBhdGguam9pbiwgcGF0aC5pc2RpcgoKICAgICMgV2UgbWF5IG5vdCBoYXZlIHJlYWQgcGVybWlzc2lvbiBmb3IgdG9wLCBpbiB3aGljaCBjYXNlIHdlIGNhbid0CiAgICAjIGdldCBhIGxpc3Qgb2YgdGhlIGZpbGVzIHRoZSBkaXJlY3RvcnkgY29udGFpbnMuICBvcy53YWxrCiAgICAjIGFsd2F5cyBzdXBwcmVzc2VkIHRoZSBleGNlcHRpb24gdGhlbiwgcmF0aGVyIHRoYW4gYmxvdyB1cCBmb3IgYQogICAgIyBtaW5vciByZWFzb24gd2hlbiAoc2F5KSBhIHRob3VzYW5kIHJlYWRhYmxlIGRpcmVjdG9yaWVzIGFyZSBzdGlsbAogICAgIyBsZWZ0IHRvIHZpc2l0LiAgVGhhdCBsb2dpYyBpcyBjb3BpZWQgaGVyZS4KICAgIHRyeToKICAgICAgICAjIE5vdGUgdGhhdCBsaXN0ZGlyIGFuZCBlcnJvciBhcmUgZ2xvYmFscyBpbiB0aGlzIG1vZHVsZSBkdWUKICAgICAgICAjIHRvIGVhcmxpZXIgaW1wb3J0LSouCiAgICAgICAgbmFtZXMgPSBsaXN0ZGlyKHRvcCkKICAgIGV4Y2VwdCBlcnJvciBhcyBlcnI6CiAgICAgICAgaWYgb25lcnJvciBpcyBub3QgTm9uZToKICAgICAgICAgICAgb25lcnJvcihlcnIpCiAgICAgICAgcmV0dXJuCiAgICAKICAgIGRpcnMsIG5vbmRpcnMgPSBbXSwgW10KICAgIGZvciBuYW1lIGluIG5hbWVzOgogICAgICAgIGlmIGlzZGlyKGpvaW4odG9wLCBuYW1lKSk6CiAgICAgICAgICAgIGRpcnMuYXBwZW5kKG5hbWUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbm9uZGlycy5hcHBlbmQobmFtZSkKICAgIAogICAgaWYgdG9wZG93bjoKICAgICAgICB5aWVsZCB0b3AsIGRpcnMsIG5vbmRpcnMKICAgIAogICAgZm9yIG5hbWUgaW4gZGlyczoKICAgICAgICBuZXdfcGF0aCA9IGpvaW4odG9wLCBuYW1lKQogICAgICAgIGlmIGZvbGxvd2xpbmtzIG9yIG5vdCBpc2xpbmsobmV3X3BhdGgpOgogICAgICAgICAgICBmb3IgeCBpbiB3YWxrKG5ld19wYXRoLCB0b3Bkb3duLCBvbmVycm9yLCBmb2xsb3dsaW5rcyk6CiAgICAgICAgICAgICAgICB5aWVsZCB4CiAgICBpZiBub3QgdG9wZG93bjoKICAgICAgICB5aWVsZCB0b3AsIGRpcnMsIG5vbmRpcnMKICAgICIiIgo=',
'/Lib/pydom.py':'Y2xhc3MgTm9kZUNvbGxlY3Rpb25TZWxlY3RvcihTZWxlY3Rvcik6CiAgZGVmIF9faW5pdF9fKHNlbGYsIHNlbGVjdG9yLCBjb2xsZWN0aW9uKToKICAgICAgU2VsZWN0b3IuX19pbml0X18oc2VsZiwgc2VsZWN0b3IpCiAgICAgIHNlbGYuX2NvbGxlY3Rpb249Y29sbGVjdGlvbgoKICAgICAgaWYgc2VsZi5fc2VsZWN0b3JfdHlwZSA9PSAnaWQnOgogICAgICAgICBzZWxmLl9tYXRjaD1zZWxmLl9tYXRjaF9pZAogICAgICBlbGlmIHNlbGYuX3NlbGVjdG9yX3R5cGUgPT0ndGFnJzoKICAgICAgICAgc2VsZi5fbWF0Y2g9c2VsZi5fbWF0Y2hfdGFnCiAgICAgIGVsaWYgc2VsZi5fc2VsZWN0b3JfdHlwZSA9PSAnY2xhc3NuYW1lJzoKICAgICAgICAgc2VsZi5fbWF0Y2g9c2VsZi5fbWF0Y2hfY2xhc3NuYW1lCgogIGRlZiBfbWF0Y2hfaWQoc2VsZiwgbm9kZSk6CiAgICAgIGlmIG5vZGUuaWQgaXMgTm9uZTogcmV0dXJuIEZhbHNlCiAgICAgIHJldHVybiBub2RlLmlkID09IHNlbGYuX3NlbGVjdG9yCgogIGRlZiBfbWF0Y2hfdGFnKHNlbGYsIG5vZGUpOgogICAgICByZXR1cm4gbm9kZS50YWdOYW1lID09IHNlbGYuX3NlbGVjdG9yCgogIGRlZiBfbWF0Y2hfY2xhc3NuYW1lKHNlbGYsIG5vZGUpOgogICAgICByZXR1cm4gc2VsZi5fc2VsZWN0b3IgaW4gbm9kZS5jbGFzc25hbWUKCiAgZGVmIGdldChzZWxmKToKICAgICAgX2MxPU5vZGVDb2xsZWN0aW9uKCkKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX2NvbGxlY3Rpb246CiAgICAgICAgICBpZiBzZWxmLl9tYXRjaChfbm9kZSk6CiAgICAgICAgICAgICBfYzEuYXBwZW5kKF9ub2RlKQoKICAgICAgcmV0dXJuIF9jMQoKY2xhc3MgU2VsZWN0b3I6CiAgdGFncz1bJ0EnLCdBQkJSJywnQUNST05ZTScsJ0FERFJFU1MnLCdBUFBMRVQnLCdCJywnQkRPJywnQklHJywnQkxPQ0tRVU9URScsCiAgICAgICAgJ0JVVFRPTicsJ0NBUFRJT04nLCdDRU5URVInLCdDSVRFJywnQ09ERScsJ0RFTCcsJ0RGTicsJ0RJUicsJ0RJVicsJ0RMJywKICAgICAgICAnRU0nLCdGSUVMRFNFVCcsJ0ZPTlQnLCdGT1JNJywnRlJBTUVTRVQnLCdIMScsJ0gyJywnSDMnLCdINCcsJ0g1JywnSDYnLAogICAgICAgICdJJywnSUZSQU1FJywnSU5TJywnS0JEJywnTEFCRUwnLCdMRUdFTkQnLCdNQVAnLCdNRU5VJywnTk9GUkFNRVMnLCAKICAgICAgICAnTk9TQ1JJUFQnLCdPQkpFQ1QnLCdPTCcsJ09QVEdST1VQJywnUFJFJywnUScsJ1MnLCdTQU1QJywnU0NSSVBUJywgCiAgICAgICAgJ1NFTEVDVCcsJ1NNQUxMJywnU1BBTicsJ1NUUklLRScsJ1NUUk9ORycsJ1NUWUxFJywnU1VCJywnU1VQJywnVEFCTEUnLAogICAgICAgICdURVhUQVJFQScsJ1RJVExFJywnVFQnLCdVJywnVUwnLCdWQVInLCdCT0RZJywnQ09MR1JPVVAnLCdERCcsJ0RUJywKICAgICAgICAnSEVBRCcsJ0hUTUwnLCdMSScsJ1AnLCdUQk9EWScsJ09QVElPTicsJ1REJywnVEZPT1QnLCdUSCcsJ1RIRUFEJywnVFInLAogICAgICAgICdBUkVBJywnQkFTRScsJ0JBU0VGT05UJywnQlInLCdDT0wnLCdGUkFNRScsJ0hSJywnSU1HJywnSU5QVVQnLAogICAgICAgICdJU0lOREVYJywnTElOSycsJ01FVEEnLCdQQVJBTScsICAjSFRNTCA1IGVsZW1lbnRzLi4uCiAgICAgICAgJ0FSVElDTEUnLCdBU0lERScsJ0FVRElPJywnQkRJJywnQ0FOVkFTJywnQ09NTUFORCcsJ0RBVEFMSVNUJywKICAgICAgICAnREVUQUlMUycsJ0RJQUxPRycsJ0VNQkVEJywnRklHQ0FQVElPTicsJ0ZJR1VSRScsJ0ZPT1RFUicsJ0hFQURFUicsCiAgICAgICAgJ0tFWUdFTicsJ01BUksnLCdNRVRFUicsJ05BVicsJ09VVFBVVCcsJ1BST0dSRVNTJywnUlAnLCdSVCcsCiAgICAgICAgJ1JVQlknLCdTRUNUSU9OJywnU09VUkNFJywnU1VNTUFSWScsJ1RJTUUnLCdUUkFDSycsJ1ZJREVPJywnV0JSJ10KCiAgZGVmIF9faW5pdF9fKHNlbGYsIHNlbGVjdG9yLCBzdGFydF9ub2RlPWRvYyk6CiAgICAgIHNlbGYuX2RvYz1zdGFydF9ub2RlCgogICAgICBpZiAoaXNpbnN0YW5jZShzZWxlY3Rvciwgc3RyKSk6CiAgICAgICAgIGlmIHNlbGVjdG9yLnN0YXJ0c3dpdGgoIi4iKTogICAjY2xhc3Mgc2VsZWN0b3IKICAgICAgICAgICAgc2VsZi5fc2VsZWN0b3I9c2VsZWN0b3JbMTpdCiAgICAgICAgICAgIHNlbGYuX3NlbGVjdG9yX3R5cGU9ImNsYXNzbmFtZSIKICAgICAgICAgZWxpZiBzZWxlY3Rvci5zdGFydHN3aXRoKCIjIik6ICAjaWQgc2VsZWN0b3IKICAgICAgICAgICAgc2VsZi5fc2VsZWN0b3I9c2VsZWN0b3JbMTpdCiAgICAgICAgICAgIHNlbGYuX3NlbGVjdG9yX3R5cGU9ImlkIgogICAgICAgICBlbGlmIHNlbGVjdG9yLnVwcGVyKCkgaW4gdGFnczoKICAgICAgICAgICAgc2VsZi5fc2VsZWN0b3I9c2VsZWN0b3IudXBwZXIoKQogICAgICAgICAgICBzZWxmLl9zZWxlY3Rvcl90eXBlPSJ0YWciCiAgICAgICAgIGVsc2U6ICAKICAgICAgICAgICAgc2VsZi5fc2VsZWN0b3I9c2VsZWN0b3IKICAgICAgICAgICAgc2VsZi5fc2VsZWN0b3JfdHlwZT0ic2VsZWN0b3IiCiAgICAgIGVsc2U6ICAjdGhpcyBpcyBhIGZ1bmN0aW9uCiAgICAgICAgIHNlbGYuX3NlbGVjdG9yX3R5cGU9InNlbGVjdG9yIgogICAgICAgICBzZWxmLl9mdW5jdGlvbj1zZWxlY3RvcgogICAgICAgICBzZWxmLmdldD1zZWxmLl9mdW5jdGlvbl9nZXQKCiAgZGVmIF9mdW5jdGlvbl9nZXQoc2VsZik6CiAgICAgIGRlZiByZWN1cnNlKG5vZGUpOgogICAgICAgICAgX2xpc3Q9W10KICAgICAgICAgIGlmIHNlbGYuX2Z1bmN0aW9uKG5vZGUpOgogICAgICAgICAgICAgX2xpc3QuYXBwZW5kKG5vZGUpCgogICAgICAgICAgZm9yIF9ub2RlIGluIG5vZGUuY2hpbGROb2RlczoKICAgICAgICAgICAgICBfbGlzdCs9cmVjdXJzZShfbm9kZSkKCiAgICAgICAgICByZXR1cm4gX2xpc3QKCiAgICAgIF9tYXRjaGVkX25vZGVzPXJlY3Vyc2Uoc2VsZi5fZG9jKQogICAgICByZXR1cm4gTm9kZUNvbGxlY3Rpb24oX21hdGNoZWRfbm9kZXMpCgogIGRlZiBnZXQoc2VsZik6CiAgICAgIGlmIHNlbGYuX3NlbGVjdG9yX3R5cGU9PSJpZCI6CiAgICAgICAgIF9tYXRjaGVkX25vZGVzPXNlbGYuX2RvYy5nZXQoaWQ9c2VsZi5fc2VsZWN0b3IpCiAgICAgIGVsaWYgc2VsZi5fc2VsZWN0b3JfdHlwZT09ImNsYXNzbmFtZSI6CiAgICAgICAgIF9tYXRjaGVkX25vZGVzPXNlbGYuX2RvYy5nZXQoY2xhc3NuYW1lPXNlbGYuX3NlbGVjdG9yKQogICAgICBlbGlmIHNlbGYuX3NlbGVjdG9yX3R5cGUgPT0gInRhZyI6CiAgICAgICAgIF9tYXRjaGVkX25vZGVzPXNlbGYuX2RvYy5nZXQodGFnPXNlbGYuX3NlbGVjdG9yKQogICAgICBlbGlmIHNlbGYuX3NlbGVjdG9yX3R5cGU9PSJzZWxlY3RvciI6CiAgICAgICAgIF9tYXRjaGVkX25vZGVzPXNlbGYuX2RvYy5nZXQoc2VsZWN0b3I9c2VsZi5fc2VsZWN0b3IpCiAgICAgIGVsc2U6CiAgICAgICAgIF9tYXRjaGVkX25vZGVzPVtdCiAgICAgIHJldHVybiBOb2RlQ29sbGVjdGlvbihfbWF0Y2hlZF9ub2RlcykKCmNsYXNzIE5vZGVDb2xsZWN0aW9uOgogIGRlZiBfX2luaXRfXyhzZWxmLCBub2Rlcz1bXSk6CiAgICAgIHNlbGYuX25vZGVzPW5vZGVzCgogIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICByZXR1cm4gbGVuKHNlbGYuX25vZGVzKQoKICBkZWYgX19pdGVtX18oc2VsZiwgaSk6CiAgICAgIHJldHVybiBzZWxmLl9ub2Rlc1tpXQoKICBkZWYgX19nZXRpdGVtX18oc2VsZiwgaSk6CiAgICAgIHJldHVybiBzZWxmLl9ub2Rlc1tpXQoKICBkZWYgX19hZGRfXyhzZWxmLCBub2Rlcyk6CiAgICAgIHNlbGYuX25vZGVzKz1ub2RlcwoKICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgX3N0cj1bXQogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBfc3RyLmFwcGVuZChfbm9kZS5fX3N0cl9fKCkpCgogICAgICByZXR1cm4gJzxicj4nLmpvaW4oX3N0cikKCiAgZGVmIGFwcGVuZChzZWxmLCBub2RlKTogICAgICAgIAogICAgICBzZWxmLl9ub2Rlcy5hcHBlbmQobm9kZSkKCiAgZGVmIG5leHQoc2VsZik6CiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIHlpZWxkIF9ub2RlCgogIGRlZiBhZGQoc2VsZiwgc2VsZWN0b3IsIGNvbnRleHQpOgogICAgICBfbnM9Tm9kZUNvbGxlY3Rpb25TZWxlY3RvcihzZWxlY3Rvciwgc2VsZikKICAgICAgc2VsZi5fbm9kZXMrPV9ucy5nZXQoKQoKICBkZWYgYWRkQmFjayhzZWxmKToKICAgICAgcGFzcwoKICBkZWYgYWRkQ2xhc3Moc2VsZiwgY2xhc3NuYW1lKToKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgX25vZGUuYWRkQ2xhc3MoY2xhc3NuYW1lKQoKICBkZWYgYWZ0ZXIoc2VsZiwgY29udGVudCk6CiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIF9ub2RlLmFmdGVyKGNvbnRlbnQpCgogIGRlZiBhcHBlbmRfY29udGVudChzZWxmLCBjb250ZW50KToKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgX25vZGUuYXBwZW5kKGNvbnRlbnQpCgogIGRlZiBhcHBlbmRUbyhzZWxmLCBzZWxlY3Rvcik6CiAgICAgIF9zPVNlbGVjdG9yKHNlbGVjdG9yKQoKICAgICAgZm9yIF9ub2RlIGluIF9zLmdldCgpOgogICAgICAgICAgX25vZGUuYXBwZW5kKHNlbGYuX25vZGVbMF0uY2xvbmUoKSkKCiAgZGVmIGF0dHIoc2VsZiwgcHJvcGVydHksIHZhbHVlPU5vbmUpOgogICAgICBpZiB2YWx1ZSBpcyBOb25lOgogICAgICAgICByZXR1cm4gc2VsZi5fbm9kZXNbMF1bcHJvcGVydHldCgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBfbm9kZVtwcm9wZXJ0eV09dmFsdWUKCiAgZGVmIGJlZm9yZShzZWxmLCBjb250ZW50KToKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgX25vZGUuYmVmb3JlKGNvbnRlbnQpCgogIGRlZiBiaW5kKHNlbGYsIGV2ZW50LCBoYW5kbGVyKToKICAgICAgaWYgJyAnIGluIGV2ZW50OgogICAgICAgICBfZXZlbnRzPScgJy5zcGxpdChldmVudCkKICAgICAgICAgZm9yIF9ldmVudCBpbiBfZXZlbnRzOgogICAgICAgICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgICAgICAgIF9ub2RlWydvbiVzJyAlIGV2ZW50XT1oYW5kbGVyCiAgICAgICAgIHJldHVybgoKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgX25vZGVbJ29uJXMnICUgZXZlbnRdPWhhbmRsZXIKCiAgZGVmIGJsdXIoc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgY2hhbmdlKHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIGNoaWxkcmVuKHNlbGYsIHNlbGVjdG9yPU5vbmUpOgogICAgICBfYz1Ob2RlQ29sbGVjdGlvbigpCiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIGZvciBfY2hpbGQgaW4gX25vZGUuZ2V0X2NoaWxkcmVuKCk6CiAgICAgICAgICAgICAgX2MuYXBwZW5kKF9jaGlsZCkKCiAgICAgIGlmIHNlbGVjdG9yIGlzIE5vbmU6CiAgICAgICAgIHJldHVybiBfYwoKICAgICAgI3NlbGVjdG9yIGlzIG5vdCBOb25lCiAgICAgIF9ucz1Ob2RlQ29sbGVjdGlvblNlbGVjdG9yKHNlbGVjdG9yLCBfYykKICAgICAgcmV0dXJuIF9ucy5nZXQoKQoKICBkZWYgY2xpY2soc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgY2xvbmUoc2VsZik6CiAgICAgIHJldHVybiBOb2RlQ29sbGVjdGlvbihbX25vZGUuY2xvbmUoKSBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXNdKQoKICBkZWYgY2xvc2VzdChzZWxmLCBzZWxlY3Rvcik6CiAgICAgIGlmIGlzaW5zdGFuY2Uoc2VsZWN0b3IsIHN0cik6CiAgICAgICAgIF9ucz1TZWxlY3RvcihzZWxlY3RvcikKICAgICAgICAgc2VsZWN0b3I9X25zLmdldCgpCgogICAgICBfYz1Ob2RlQ29sbGVjdGlvbigpCiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIF9jLmFwcGVuZChfbm9kZS5jbG9zZXN0KHNlbGVjdG9yKSkKCiAgICAgIHJldHVybiBfYwoKICBkZWYgY29udGFpbnMoc2VsZiwgdGV4dCk6CiAgICAgIHBhc3MKCiAgZGVmIGNvbnRlbnRzKHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBjc3Moc2VsZiwgcHJvcGVydHksIHZhbHVlPU5vbmUpOgogICAgICBpZiB2YWx1ZSBpcyBOb25lIGFuZCBub3QgaXNpbnN0YW5jZShwcm9wZXJ0eSwgZGljdCk6CiAgICAgICAgIHJldHVybiBzZWxmLl9ub2Rlc1swXS5jc3MocHJvcGVydHkpCgogICAgICBpZiBpc2luc3RhbmNlKHByb3BlcnR5LCBkaWN0KToKICAgICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgICAgX25vZGUuY3NzKHByb3BlcnR5KQogICAgICBlbHNlOgogICAgICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICAgICBfbm9kZS5jc3MocHJvcGVydHksIHZhbHVlKQoKICBkZWYgZGF0YShzZWxmKToKICAgICAgcGFzcwoKICBkZWYgZGJsY2xpY2soc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgZGV0YWNoKHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBlYWNoKHNlbGYsIGZ1bmMpOgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBmdW5jKF9ub2RlKQoKICBkZWYgZW1wdHkoc2VsZik6CiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIF9ub2RlLmVtcHR5KCkKCiAgZGVmIGVxKHNlbGYsIGluZGV4KToKICAgICAgaWYgaW5kZXggPCBsZW4oc2VsZi5fbm9kZXMpOgogICAgICAgICByZXR1cm4gTm9kZUNvbGxlY3Rpb25zKHNlbGYuX25vZGVzW2luZGV4XSkKCiAgICAgIHJldHVybiBOb2RlQ29sbGVjdGlvbnMoKQoKICBkZWYgZXJyb3Ioc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgZmFkZUluKHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBmYWRlT3V0KHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBmYWRlVG8oc2VsZik6CiAgICAgIHBhc3MKCiAgZGVmIGZhZGVUb2dnbGUoc2VsZik6CiAgICAgIHBhc3MKCiAgZGVmIGZpbHRlcihzZWxmLCBzZWxlY3Rvcik6CiAgICAgIF9ucz1Ob2RlQ29sbGVjdGlvblNlbGVjdG9yKHNlbGVjdG9yLCBzZWxmKQogICAgICByZXR1cm4gX25zLmdldCgpCgogIGRlZiBmaW5kKHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBmaXJzdChzZWxmKToKICAgICAgaWYgbGVuKHNlbGYuX25vZGVzKSA9PSAwOgogICAgICAgICByZXR1cm4gTm9kZUNvbGxlY3Rpb24oKQoKICAgICAgcmV0dXJuIE5vZGVDb2xsZWN0aW9uKFtzZWxmLl9ub2Rlc1swXV0pCgogIGRlZiBmb2N1cyhzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBmb2N1c2luKHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIGZvY3Vzb3V0KHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIGdldChzZWxmLCBpbmRleD1Ob25lKToKICAgICAgaWYgaW5kZXggaXMgTm9uZToKICAgICAgICAgcmV0dXJuIFtfbm9kZSBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXNdCgogICAgICByZXR1cm4gc2VsZi5fbm9kZXNbaW5kZXhdCgogIGRlZiBndChzZWxmLCBpbmRleCk6CiAgICAgIHJldHVybiBOb2RlQ29sbGVjdGlvbihbc2VsZi5fbm9kZXNbaW5kZXg6XV0pCgogIGRlZiBoYXMoc2VsZiwgc2VsZWN0b3IpOgogICAgICBwYXNzCiAgCiAgZGVmIGhhc0NsYXNzKHNlbGYsIG5hbWUpOgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBpZiBfbm9kZS5oYXNDbGFzcyhuYW1lKToKICAgICAgICAgICAgIHJldHVybiBUcnVlCgogICAgICByZXR1cm4gRmFsc2UKCiAgZGVmIGhlaWdodChzZWxmLCB2YWx1ZT1Ob25lKToKICAgICAgaWYgdmFsdWUgaXMgTm9uZToKICAgICAgICAgcmV0dXJuIHNlbGYuX25vZGVzWzBdLmNzcygnaGVpZ2h0JykKCiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIF9ub2RlLnNldF9zdHlsZSh7J2hlaWdodCc6IHZhbHVlfSkKCiAgZGVmIGhpZGUoc2VsZik6CiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIF9ub2RlLnNldF9zdHlsZSh7J2Rpc3BsYXknOiAnbm9uZSd9KQoKICBkZWYgaG92ZXIoc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgaHRtbChzZWxmLCBjb250ZW50PU5vbmUpOgogICAgICBpZiBjb250ZW50IGlzIE5vbmU6CiAgICAgICAgIHJldHVybiBzZWxmLl9ub2Rlc1swXS5nZXRfaHRtbCgpCgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBfbm9kZS5zZXRfaHRtbChjb250ZW50KQoKICBkZWYgaW5uZXJIZWlnaHQoc2VsZik6CiAgICAgIHBhc3MKCiAgZGVmIGlubmVyV2lkdGgoc2VsZik6CiAgICAgIHBhc3MKCiAgZGVmIGluc2VydEFmdGVyKHNlbGYsIHRhcmdldCk6CiAgICAgIHBhc3MKCiAgZGVmIGluc2VydEJlZm9yZShzZWxmLCB0YXJnZXQpOgogICAgICBwYXNzCgogICNkZWYgaXMoc2VsZiwgc2VsZWN0b3IpOgogICMgICAgcGFzcwoKICBkZWYga2V5ZG93bihzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBrZXlwcmVzcyhzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBrZXl1cChzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBsYXN0KHNlbGYpOgogICAgICByZXR1cm4gc2VsZi5fbm9kZXNbLTFdCgogIEBwcm9wZXJ0eQogIGRlZiBsZW5ndGgoc2VsZik6CiAgICAgIHJldHVybiBsZW4oc2VsZi5fbm9kZXMpCgogIGRlZiBtb3VzZWRvd24oc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgbW91c2VlbnRlcihzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBtb3VzZWxlYXZlKHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIG1vdXNlbW92ZShzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBtb3VzZW91dChzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBtb3VzZW92ZXIoc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgbW91c2V1cChzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBuZXh0KHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBuZXh0QWxsKHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBuZXh0VXRpbChzZWxmKToKICAgICAgcGFzcwoKICBkZWYgb2ZmKHNlbGYsIGhhbmRsZXIpOgogICAgICBwYXNzCgogIGRlZiBvZmZzZXQoc2VsZik6CiAgICAgIHBhc3MKCiAgZGVmIG9mZnNldFBhcmVudChzZWxmKToKICAgICAgcGFzcwoKICBkZWYgb24oc2VsZiwgaGFuZGxlcik6CiAgICAgIHBhc3MKCiAgZGVmIG91dGVySGVpZ2h0KHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBvdXRlcldpZHRoKHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBwYXJlbnQoc2VsZik6CiAgICAgIF9wPU5vZGVDb2xsZWN0aW9uKCkKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgX3AuYXBwZW5kKF9ub2RlLmdldF9wYXJlbnQoKSkKCiAgZGVmIHBhcmVudHMoc2VsZiwgc2VsZWN0b3I9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIHBhcmVudHNVbnRpbChzZWxmLCBzZWxlY3Rvcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgcG9zaXRpb24oc2VsZik6CiAgICAgIHBhc3MKCiAgZGVmIHByZXBlbmQoc2VsZiwgY29udGVudCk6CiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIF9ub2RlLnByZXBlbmQoY29udGVudCkKCiAgZGVmIHByZXBlbmRUbyhzZWxmLCB0YXJnZXQpOgogICAgICBwYXNzCgogIGRlZiBwcmV2KHNlbGYpOgogICAgICBfcDE9Tm9kZUNvbGxlY3Rpb24oKQogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBfcGFyZW50PV9ub2RlLmdldF9wYXJlbnQoKQogICAgICAgICAgZm9yIF9pIGluIHJhbmdlKGxlbihfcGFyZW50LmNoaWxkTm9kZXMpKToKICAgICAgICAgICAgICBpZiBfcGFyZW50LmNoaWxkTm9kZXNbX2ldID09IF9ub2RlOgogICAgICAgICAgICAgICAgIGlmIF9pID4gMDoKICAgICAgICAgICAgICAgICAgICBfcDEuYXBwZW5kKF9wYXJlbnQuY2hpbGROb2Rlc1tfaS0xXSkKICAgICAgICAgICAgICAgICBicmVhawoKICAgICAgcmV0dXJuIF9wMQoKICBkZWYgcHJldkFsbChzZWxmLCBzZWxlY3Rvcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgcHJldlVudGlsKHNlbGYsIHNlbGVjdG9yPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBwcm9wKHNlbGYsIHByb3BlcnR5LCB2YWx1ZT1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgcmVhZHkoc2VsZiwgZnVuYyk6CiAgICAgIHBhc3MKCiAgZGVmIHJlbW92ZShzZWxmKToKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgX25vZGUuZ2V0X3BhcmVudCgpLnJlbW92ZUNoaWxkKF9ub2RlKSAKCiAgZGVmIHJlbW92ZUF0dHIoc2VsZiwgYXR0cik6CiAgICAgIHBhc3MKCiAgZGVmIHJlbW92ZUNsYXNzKHNlbGYsIG5hbWUpOgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBfbm9kZS5yZW1vdmVDbGFzcyhuYW1lKQoKICBkZWYgcmVtb3ZlUHJvcChzZWxmLCBwcm9wZXJ0eSk6CiAgICAgIHBhc3MKCiAgZGVmIHJlcGxhY2VBbGwoc2VsZik6CiAgICAgIHBhc3MKCiAgZGVmIHJlcGxhY2VXaXRoKHNlbGYsIGNvbnRlbnQpOgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBfbm9kZS5nZXRfcGFyZW50KCkucmVwbGFjZVdpdGgoY29udGVudCwgX25vZGUpCgogIGRlZiByZXNpemUoc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgc2Nyb2xsKHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIHNjcm9sbExlZnQoc2VsZiwgdmFsdWU9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIHNjcm9sbFRvcChzZWxmLCB2YWx1ZT1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgc2VsZWN0KHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIHNob3coc2VsZik6CiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIF9ub2RlLnNldF9zdHlsZSh7J2Rpc3BsYXknOiAnYmxvY2snfSkKCiAgZGVmIHNpYmxpbmdzKHNlbGYsIHNlbGVjdG9yPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBzaXplKHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBzbGljZShzZWxmLCBpbmRleDE9Tm9uZSwgaW5kZXgyPU5vbmUpOgogICAgICBpZiBpbmRleDEgaXMgTm9uZSBhbmQgaW5kZXgyIGlzIE5vbmU6CiAgICAgICAgIHJldHVybiBOb2RlQ29sbGVjdGlvbigpCgogICAgICByZXR1cm4gTm9kZUNvbGxlY3Rpb24oc2VsZi5fbm9kZXNbaW5kZXgxOmluZGV4Ml0pCgogIGRlZiBzbGlkZURvd24oc2VsZik6CiAgICAgIHBhc3MKCiAgZGVmIHNsaWRlVG9nZ2xlKHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBzbGlkZVVwKHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBzdWJtaXQoc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgdGV4dChzZWxmLCBjb250ZW50PU5vbmUpOgogICAgICBpZiBjb250ZW50IGlzIE5vbmU6CiAgICAgICAgIHJldHVybiBzZWxmLl9ub2Rlc1swXS5nZXRfdGV4dCgpCgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBfbm9kZS5zZXRfdGV4dChjb250ZW50KSAKCiAgZGVmIHRvZ2dsZShzZWxmLCBGdW5jdGlvbj1Ob25lKToKICAgICAgaWYgRnVuY3Rpb24gaXMgTm9uZToKICAgICAgICAgX3Nob3c9VHJ1ZQogICAgICAgICBpZiBzZWxmLl9ub2Rlc1swXS5jc3MoJ2Rpc3BsYXknKSAhPSAnbm9uZSc6CiAgICAgICAgICAgIF9zaG93PUZhbHNlCiAgICAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgICAgIGlmIF9zaG93OgogICAgICAgICAgICAgICAgX25vZGUuc2V0X3N0eWxlKHsnZGlzcGxheSc6ICdibG9jayd9KQogICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIF9ub2RlLnNldF9zdHlsZSh7J2Rpc3BsYXknOiAnbm9uZSd9KQogIAogICAgICAgICAgICAgX3Nob3c9bm90IF9zaG93CgogICAgICAgICByZXR1cm4KCiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIGlmIEZ1bmN0aW9uKF9ub2RlKToKICAgICAgICAgICAgIF9ub2RlLnNldF9zdHlsZSh7J2Rpc3BsYXknOiAnYmxvY2snfSkKICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICBfbm9kZS5zZXRfc3R5bGUoeydkaXNwbGF5JzogJ25vbmUnfSkKCiAgZGVmIHRvZ2dsZUNsYXNzKHNlbGYpOgogICAgICBwYXNzCgogIGRlZiB0b0xpc3Qoc2VsZik6CiAgICAgIHJldHVybiBzZWxmLl9ub2RlcwoKICB0b0FycmF5PXRvTGlzdCAgICNmb3IgalF1ZXJ5IGNvbXBhdGliaWxpdHkKCiAgZGVmIHRvdWNoZW5kKHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIHRvdWNobW92ZShzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiB0b3VjaHN0YXJ0KHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIHRyaWdnZXIoc2VsZiwgZXZlbnRfdHlwZSk6CiAgICAgIHBhc3MKCiAgZGVmIHRyaWdnZXJIYW5kbGVyKHNlbGYsIGV2ZW50X3R5cGUpOgogICAgICBwYXNzCgoKICBkZWYgdW5iaW5kKHNlbGYsIGV2ZW50LCBoYW5kbGVyKToKICAgICAgaWYgJyAnIGluIGV2ZW50OgogICAgICAgICBfZXZlbnRzPScgJy5zcGxpdChldmVudCkKICAgICAgICAgZm9yIF9ldmVudCBpbiBfZXZlbnRzOgogICAgICAgICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgICAgICAgIHByaW50KCJmaXggbWUhIikKICAgICAgICAgcmV0dXJuCgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICAjbG9vayBpbnRvIGhvdyB0byBkZXRhY2ggYW4gZXZlbnQKICAgICAgICAgIHByaW50KCJmaXggbWUiKQoKCiAgZGVmIHVubG9hZChzZWxmLCBoYW5kbGVyKToKICAgICAgcGFzcwoKICBkZWYgdW53cmFwKHNlbGYpOgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBfcGFyZW50PV9ub2RlLmdldF9wYXJlbnQoKQogICAgICAgICAgX2dyYW5kcGFyZW50PV9wYXJlbnQuZ2V0X3BhcmVudCgpCiAgICAgICAgICBfZ3JhbmRwYXJlbnQucmVwbGFjZUNoaWxkKF9ub2RlLCBfcGFyZW50KQoKICAgICAgICAgIF9wYXJlbnQucmVtb3ZlKCkKCiAgZGVmIHZhbChzZWxmLCB2YWx1ZT1Ob25lKToKICAgICAgaWYgdmFsdWUgaXMgTm9uZToKICAgICAgICAgcmV0dXJuIHNlbGYuX25vZGVzWzBdWyd0ZXh0J10gICAjaXMgdGV4dCB0aGUgYmVzdCBoZXJlPwoKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgX25vZGVbJ3RleHQnXT12YWx1ZQoKICBkZWYgd2lkdGgoc2VsZiwgd2lkdGg9Tm9uZSk6CiAgICAgIGlmIHdpZHRoIGlzIE5vbmU6CiAgICAgICAgIHJldHVybiBzZWxmLl9ub2Rlc1swXS5jc3MoJ3dpZHRoJykKCiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIF9ub2RlLnNldF9zdHlsZSh7J3dpZHRoJzogd2lkdGh9KQoKICBkZWYgd3JhcChzZWxmKToKICAgICAgcGFzcwoKICBkZWYgd3JhcEFsbChzZWxmKToKICAgICAgcGFzcwoKICBkZWYgd3JhcElubmVyKHNlbGYpOgogICAgICBwYXNzCgpkZWYgYnlJZChpZCk6CiAgICBfcmVzdWx0PWRvYy5nZXQoaWQ9aWQpCiAgICByZXR1cm4gX3Jlc3VsdFswXQoKZGVmIGNyZWF0ZUNTU0NsYXNzKGNzc3RleHQpOgogICAgX3N0eWxlPWRvYy5jcmVhdGVFbGVtZW50KCdzdHlsZScpCiAgICBfc3R5bGUudHlwZT0ndGV4dC9jc3MnCiAgICBfc3R5bGUuaW5uZXJIVE1MID0gY3NzdGV4dAogICAgZG9jLmdldCh0YWc9J2hlYWQnKVswXS5hcHBlbmRDaGlsZChfc3R5bGUpCg==',
'/Lib/pyindexedDB.py':'Y2xhc3MgRXZlbnRMaXN0ZW5lcjoKICBkZWYgX19pbml0X18oc2VsZiwgZXZlbnRzPVtdKToKICAgICAgc2VsZi5fZXZlbnRzPWV2ZW50cwoKICBkZWYgYXBwZW5kKHNlbGYsIGV2ZW50KToKICAgICAgc2VsZi5fZXZlbnRzLmFwcGVuZChldmVudCkKCiAgZGVmIGZpcmUoc2VsZiwgZSk6CiAgICAgIGZvciBfZXZlbnQgaW4gc2VsZi5fZXZlbnRzOgogICAgICAgICAgX2V2ZW50KGUpCgpjbGFzcyBweWluZGV4ZWREQjoKICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgIGlmIG5vdCBfX0JSWVRIT05fXy5oYXNfaW5kZXhlZERCOgogICAgICAgICByYWlzZSBFeGNlcHRpb24oIk5vdEltcGxlbWVudGVkRXJyb3IiLCAiWW91ciBicm93c2VyIGRvZXNuJ3Qgc3VwcG9ydCBpbmRleGVkREIiKQogICAgICAgICByZXR1cm4KCiAgICAgIHNlbGYuX2luZGV4ZWREQj1fX0JSWVRIT05fXy5pbmRleGVkREIoKQogICAgICBzZWxmLl9kYj1Ob25lCiAgICAgIHNlbGYuX3ZlcnNpb249Tm9uZQoKICBkZWYgX29uc3VjY2VzcyhzZWxmLCBldmVudCk6CiAgICAgIHNlbGYuX2RiPWV2ZW50LnRhcmdldC5yZXN1bHQKCiAgZGVmIG9wZW4oc2VsZiwgbmFtZSwgb25zdWNjZXNzLCB2ZXJzaW9uPTEuMCwgb25lcnJvcj1Ob25lLCAKICAgICAgICAgICBvbnVwZ3JhZGVuZWVkZWQ9Tm9uZSk6CiAgICAgIHNlbGYuX3ZlcnNpb249dmVyc2lvbgogICAgICBfcmVzdWx0PXNlbGYuX2luZGV4ZWREQi5vcGVuKG5hbWUsIHZlcnNpb24pCiAgICAgIF9zdWNjZXNzPUV2ZW50TGlzdGVuZXIoW3NlbGYuX29uc3VjY2Vzcywgb25zdWNjZXNzXSkKICAgICAgX3Jlc3VsdC5vbnN1Y2Nlc3M9X3N1Y2Nlc3MuZmlyZQogICAgICBfcmVzdWx0Lm9udXBncmFkZW5lZWRlZD1vbnVwZ3JhZGVuZWVkZWQKCiAgICAgICNpZiBvbmVycm9yIGlzIE5vbmU6CiAgICAgIGRlZiBvbmVycm9yKGUpOgogICAgICAgICAgcHJpbnQoIm9uZXJyb3I6ICVzOiVzIiAlICAoZS50eXBlLCBlLnRhcmdldC5yZXN1bHQpKQoKICAgICAgZGVmIG9uYmxvY2tlZChlKToKICAgICAgICAgIHByaW50KCJibG9ja2VkOiAlczolcyIgJSAgKGUudHlwZSwgZS5yZXN1bHQpKQoKICAgICAgX3Jlc3VsdC5vbmVycm9yPW9uZXJyb3IKICAgICAgX3Jlc3VsdC5vbmJsb2NrZWQ9b25ibG9ja2VkCgogIGRlZiB0cmFuc2FjdGlvbihzZWxmLCBlbnRpdGllcywgbW9kZT0ncmVhZCcpOgogICAgICByZXR1cm4gVHJhbnNhY3Rpb24oc2VsZi5fZGIudHJhbnNhY3Rpb24oZW50aXRpZXMsIG1vZGUpKQoKY2xhc3MgVHJhbnNhY3Rpb246CiAgZGVmIF9faW5pdF9fKHNlbGYsIHRyYW5zYWN0aW9uKToKICAgICAgc2VsZi5fdHJhbnNhY3Rpb249dHJhbnNhY3Rpb24KCiAgZGVmIG9iamVjdFN0b3JlKHNlbGYsIG5hbWUpOgogICAgICByZXR1cm4gT2JqZWN0U3RvcmUoc2VsZi5fdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUobmFtZSkpCgpjbGFzcyBPYmplY3RTdG9yZToKICBkZWYgX19pbml0X18oc2VsZiwgb2JqZWN0U3RvcmUpOgogICAgICBzZWxmLl9vYmplY3RTdG9yZT1vYmplY3RTdG9yZQogICAgICBzZWxmLl9kYXRhPVtdCgogIGRlZiBjbGVhcihzZWxmLCBvbnN1Y2Nlc3M9Tm9uZSwgb25lcnJvcj1Ob25lKToKICAgICAgX3Jlc3VsdD1zZWxmLl9vYmplY3RTdG9yZS5jbGVhcigpCgogICAgICBpZiBvbnN1Y2Nlc3MgaXMgbm90IE5vbmU6CiAgICAgICAgIF9yZXN1bHQub25zdWNjZXNzPW9uc3VjY2VzcwoKICAgICAgaWYgb25lcnJvciBpcyBub3QgTm9uZToKICAgICAgICAgX3Jlc3VsdC5vbmVycm9yPW9uZXJyb3IKCiAgZGVmIF9oZWxwZXIoc2VsZiwgZnVuYywgb2JqZWN0LCBvbnN1Y2Nlc3M9Tm9uZSwgb25lcnJvcj1Ob25lKToKICAgICAgX3Jlc3VsdD1mdW5jKG9iamVjdCkKCiAgICAgIGlmIG9uc3VjY2VzcyBpcyBub3QgTm9uZToKICAgICAgICAgX3Jlc3VsdC5vbnN1Y2Nlc3M9b25zdWNjZXNzCgogICAgICBpZiBvbmVycm9yIGlzIG5vdCBOb25lOgogICAgICAgICBfcmVzdWx0Lm9uZXJyb3I9b25lcnJvcgoKICBkZWYgcHV0KHNlbGYsIG9iamVjdCwga2V5PU5vbmUsIG9uc3VjY2Vzcz1Ob25lLCBvbmVycm9yPU5vbmUpOgogICAgICBfcj1zZWxmLl9vYmplY3RTdG9yZS5wdXQob2JqZWN0LCBrZXkpCiAgICAgIF9yLm9uc3VjY2Vzcz1vbnN1Y2Nlc3MKICAgICAgX3Iub25lcnJvcj1vbmVycm9yCgogIGRlZiBhZGQoc2VsZiwgb2JqZWN0LCBvbnN1Y2Nlc3M9Tm9uZSwgb25lcnJvcj1Ob25lKToKICAgICAgc2VsZi5faGVscGVyKHNlbGYuX29iamVjdFN0b3JlLmFkZCwgb2JqZWN0LCBvbnN1Y2Nlc3MsIG9uZXJyb3IpCgogIGRlZiBkZWxldGUoc2VsZiwgaW5kZXgsIG9uc3VjY2Vzcz1Ob25lLCBvbmVycm9yPU5vbmUpOiAKICAgICAgc2VsZi5faGVscGVyKHNlbGYuX29iamVjdFN0b3JlLmRlbGV0ZSwgaW5kZXgsIG9uc3VjY2Vzcywgb25lcnJvcikKICAgICAKICBkZWYgcXVlcnkoc2VsZiwgKmFyZ3MpOgogICAgICBzZWxmLl9kYXRhPVtdCiAgICAgIGRlZiBvbnN1Y2Nlc3MoZXZlbnQpOgogICAgICAgICAgY3Vyc29yPWV2ZW50LnRhcmdldC5yZXN1bHQKICAgICAgICAgIGlmIGN1cnNvciBpcyBub3QgTm9uZToKICAgICAgICAgICAgIHNlbGYuX2RhdGEuYXBwZW5kKGN1cnNvci52YWx1ZSkKICAgICAgICAgICAgIGN1cnNvci5jb250aW51ZSgpCgogICAgICBzZWxmLl9vYmplY3RTdG9yZS5vcGVuQ3Vyc29yKGFyZ3MpLm9uc3VjY2Vzcz1vbnN1Y2Nlc3MKCiAgZGVmIGZldGNoYWxsKHNlbGYpOgogICAgICB5aWVsZCBzZWxmLl9kYXRhCgogIGRlZiBnZXQoc2VsZiwga2V5LCBvbnN1Y2Nlc3M9Tm9uZSwgb25lcnJvcj1Ob25lKToKICAgICAgc2VsZi5faGVscGVyKHNlbGYuX29iamVjdFN0b3JlLmdldCwga2V5LCBvbnN1Y2Nlc3MsIG9uZXJyb3IpCg==',
'/Lib/random.py':'IiIiUmFuZG9tIHZhcmlhYmxlIGdlbmVyYXRvcnMuCgogICAgaW50ZWdlcnMKICAgIC0tLS0tLS0tCiAgICAgICAgICAgdW5pZm9ybSB3aXRoaW4gcmFuZ2UKCiAgICBzZXF1ZW5jZXMKICAgIC0tLS0tLS0tLQogICAgICAgICAgIHBpY2sgcmFuZG9tIGVsZW1lbnQKICAgICAgICAgICBwaWNrIHJhbmRvbSBzYW1wbGUKICAgICAgICAgICBnZW5lcmF0ZSByYW5kb20gcGVybXV0YXRpb24KCiAgICBkaXN0cmlidXRpb25zIG9uIHRoZSByZWFsIGxpbmU6CiAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAgICB1bmlmb3JtCiAgICAgICAgICAgdHJpYW5ndWxhcgogICAgICAgICAgIG5vcm1hbCAoR2F1c3NpYW4pCiAgICAgICAgICAgbG9nbm9ybWFsCiAgICAgICAgICAgbmVnYXRpdmUgZXhwb25lbnRpYWwKICAgICAgICAgICBnYW1tYQogICAgICAgICAgIGJldGEKICAgICAgICAgICBwYXJldG8KICAgICAgICAgICBXZWlidWxsCgogICAgZGlzdHJpYnV0aW9ucyBvbiB0aGUgY2lyY2xlIChhbmdsZXMgMCB0byAycGkpCiAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAgICBjaXJjdWxhciB1bmlmb3JtCiAgICAgICAgICAgdm9uIE1pc2VzCgpHZW5lcmFsIG5vdGVzIG9uIHRoZSB1bmRlcmx5aW5nIE1lcnNlbm5lIFR3aXN0ZXIgY29yZSBnZW5lcmF0b3I6CgoqIFRoZSBwZXJpb2QgaXMgMioqMTk5MzctMS4KKiBJdCBpcyBvbmUgb2YgdGhlIG1vc3QgZXh0ZW5zaXZlbHkgdGVzdGVkIGdlbmVyYXRvcnMgaW4gZXhpc3RlbmNlLgoqIFRoZSByYW5kb20oKSBtZXRob2QgaXMgaW1wbGVtZW50ZWQgaW4gQywgZXhlY3V0ZXMgaW4gYSBzaW5nbGUgUHl0aG9uIHN0ZXAsCiAgYW5kIGlzLCB0aGVyZWZvcmUsIHRocmVhZHNhZmUuCgoiIiIKCmZyb20gd2FybmluZ3MgaW1wb3J0IHdhcm4gYXMgX3dhcm4KZnJvbSB0eXBlcyBpbXBvcnQgTWV0aG9kVHlwZSBhcyBfTWV0aG9kVHlwZSwgQnVpbHRpbk1ldGhvZFR5cGUgYXMgX0J1aWx0aW5NZXRob2RUeXBlCmZyb20gbWF0aCBpbXBvcnQgbG9nIGFzIF9sb2csIGV4cCBhcyBfZXhwLCBwaSBhcyBfcGksIGUgYXMgX2UsIGNlaWwgYXMgX2NlaWwKZnJvbSBtYXRoIGltcG9ydCBzcXJ0IGFzIF9zcXJ0LCBhY29zIGFzIF9hY29zLCBjb3MgYXMgX2Nvcywgc2luIGFzIF9zaW4KZnJvbSBvcyBpbXBvcnQgdXJhbmRvbSBhcyBfdXJhbmRvbQpmcm9tIGNvbGxlY3Rpb25zIGltcG9ydCBTZXQgYXMgX1NldCwgU2VxdWVuY2UgYXMgX1NlcXVlbmNlCmZyb20gaGFzaGxpYiBpbXBvcnQgc2hhNTEyIGFzIF9zaGE1MTIKCl9fYWxsX18gPSBbIlJhbmRvbSIsInNlZWQiLCJyYW5kb20iLCJ1bmlmb3JtIiwicmFuZGludCIsImNob2ljZSIsInNhbXBsZSIsCiAgICAgICAgICAgInJhbmRyYW5nZSIsInNodWZmbGUiLCJub3JtYWx2YXJpYXRlIiwibG9nbm9ybXZhcmlhdGUiLAogICAgICAgICAgICJleHBvdmFyaWF0ZSIsInZvbm1pc2VzdmFyaWF0ZSIsImdhbW1hdmFyaWF0ZSIsInRyaWFuZ3VsYXIiLAogICAgICAgICAgICJnYXVzcyIsImJldGF2YXJpYXRlIiwicGFyZXRvdmFyaWF0ZSIsIndlaWJ1bGx2YXJpYXRlIiwKICAgICAgICAgICAiZ2V0c3RhdGUiLCJzZXRzdGF0ZSIsICJnZXRyYW5kYml0cyIsCiAgICAgICAgICAgIlN5c3RlbVJhbmRvbSJdCgpOVl9NQUdJQ0NPTlNUID0gNCAqIF9leHAoLTAuNSkvX3NxcnQoMi4wKQpUV09QSSA9IDIuMCpfcGkKTE9HNCA9IF9sb2coNC4wKQpTR19NQUdJQ0NPTlNUID0gMS4wICsgX2xvZyg0LjUpCkJQRiA9IDUzICAgICAgICAjIE51bWJlciBvZiBiaXRzIGluIGEgZmxvYXQKUkVDSVBfQlBGID0gMioqLUJQRgoKCiMgVHJhbnNsYXRlZCBieSBHdWlkbyB2YW4gUm9zc3VtIGZyb20gQyBzb3VyY2UgcHJvdmlkZWQgYnkKIyBBZHJpYW4gQmFkZGVsZXkuICBBZGFwdGVkIGJ5IFJheW1vbmQgSGV0dGluZ2VyIGZvciB1c2Ugd2l0aAojIHRoZSBNZXJzZW5uZSBUd2lzdGVyICBhbmQgb3MudXJhbmRvbSgpIGNvcmUgZ2VuZXJhdG9ycy4KCmltcG9ydCBfcmFuZG9tCgpjbGFzcyBSYW5kb20oX3JhbmRvbS5SYW5kb20pOgogICAgIiIiUmFuZG9tIG51bWJlciBnZW5lcmF0b3IgYmFzZSBjbGFzcyB1c2VkIGJ5IGJvdW5kIG1vZHVsZSBmdW5jdGlvbnMuCgogICAgVXNlZCB0byBpbnN0YW50aWF0ZSBpbnN0YW5jZXMgb2YgUmFuZG9tIHRvIGdldCBnZW5lcmF0b3JzIHRoYXQgZG9uJ3QKICAgIHNoYXJlIHN0YXRlLgoKICAgIENsYXNzIFJhbmRvbSBjYW4gYWxzbyBiZSBzdWJjbGFzc2VkIGlmIHlvdSB3YW50IHRvIHVzZSBhIGRpZmZlcmVudCBiYXNpYwogICAgZ2VuZXJhdG9yIG9mIHlvdXIgb3duIGRldmlzaW5nOiBpbiB0aGF0IGNhc2UsIG92ZXJyaWRlIHRoZSBmb2xsb3dpbmcKICAgIG1ldGhvZHM6ICByYW5kb20oKSwgc2VlZCgpLCBnZXRzdGF0ZSgpLCBhbmQgc2V0c3RhdGUoKS4KICAgIE9wdGlvbmFsbHksIGltcGxlbWVudCBhIGdldHJhbmRiaXRzKCkgbWV0aG9kIHNvIHRoYXQgcmFuZHJhbmdlKCkKICAgIGNhbiBjb3ZlciBhcmJpdHJhcmlseSBsYXJnZSByYW5nZXMuCgogICAgIiIiCgogICAgVkVSU0lPTiA9IDMgICAgICMgdXNlZCBieSBnZXRzdGF0ZS9zZXRzdGF0ZQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB4PU5vbmUpOgogICAgICAgICIiIkluaXRpYWxpemUgYW4gaW5zdGFuY2UuCgogICAgICAgIE9wdGlvbmFsIGFyZ3VtZW50IHggY29udHJvbHMgc2VlZGluZywgYXMgZm9yIFJhbmRvbS5zZWVkKCkuCiAgICAgICAgIiIiCgogICAgICAgIHNlbGYuc2VlZCh4KQogICAgICAgIHNlbGYuZ2F1c3NfbmV4dCA9IE5vbmUKCiAgICBkZWYgc2VlZChzZWxmLCBhPU5vbmUsIHZlcnNpb249Mik6CiAgICAgICAgIiIiSW5pdGlhbGl6ZSBpbnRlcm5hbCBzdGF0ZSBmcm9tIGhhc2hhYmxlIG9iamVjdC4KCiAgICAgICAgTm9uZSBvciBubyBhcmd1bWVudCBzZWVkcyBmcm9tIGN1cnJlbnQgdGltZSBvciBmcm9tIGFuIG9wZXJhdGluZwogICAgICAgIHN5c3RlbSBzcGVjaWZpYyByYW5kb21uZXNzIHNvdXJjZSBpZiBhdmFpbGFibGUuCgogICAgICAgIEZvciB2ZXJzaW9uIDIgKHRoZSBkZWZhdWx0KSwgYWxsIG9mIHRoZSBiaXRzIGFyZSB1c2VkIGlmICphKiBpcyBhIHN0ciwKICAgICAgICBieXRlcywgb3IgYnl0ZWFycmF5LiAgRm9yIHZlcnNpb24gMSwgdGhlIGhhc2goKSBvZiAqYSogaXMgdXNlZCBpbnN0ZWFkLgoKICAgICAgICBJZiAqYSogaXMgYW4gaW50LCBhbGwgYml0cyBhcmUgdXNlZC4KCiAgICAgICAgIiIiCgogICAgICAgIGlmIGEgaXMgTm9uZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgYSA9IGludC5mcm9tX2J5dGVzKF91cmFuZG9tKDMyKSwgJ2JpZycpCiAgICAgICAgICAgIGV4Y2VwdCBOb3RJbXBsZW1lbnRlZEVycm9yOgogICAgICAgICAgICAgICAgaW1wb3J0IHRpbWUKICAgICAgICAgICAgICAgIGEgPSBpbnQodGltZS50aW1lKCkgKiAyNTYpICMgdXNlIGZyYWN0aW9uYWwgc2Vjb25kcwoKICAgICAgICBpZiB2ZXJzaW9uID09IDI6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoYSwgKHN0ciwgYnl0ZXMsIGJ5dGVhcnJheSkpOgogICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShhLCBzdHIpOgogICAgICAgICAgICAgICAgICAgIGEgPSBhLmVuY29kZSgpCiAgICAgICAgICAgICAgICBhICs9IF9zaGE1MTIoYSkuZGlnZXN0KCkKICAgICAgICAgICAgICAgIGEgPSBpbnQuZnJvbV9ieXRlcyhhLCAnYmlnJykKCiAgICAgICAgI2ZpeG1lIGJyeXRob24KICAgICAgICAjc3VwZXIoKS5zZWVkKGEpCiAgICAgICAgX3JhbmRvbS5SYW5kb20uc2VlZChzZWxmLCBhKQogICAgICAgIHNlbGYuZ2F1c3NfbmV4dCA9IE5vbmUKCiAgICBkZWYgZ2V0c3RhdGUoc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIGludGVybmFsIHN0YXRlOyBjYW4gYmUgcGFzc2VkIHRvIHNldHN0YXRlKCkgbGF0ZXIuIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuVkVSU0lPTiwgc3VwZXIoKS5nZXRzdGF0ZSgpLCBzZWxmLmdhdXNzX25leHQKCiAgICBkZWYgc2V0c3RhdGUoc2VsZiwgc3RhdGUpOgogICAgICAgICIiIlJlc3RvcmUgaW50ZXJuYWwgc3RhdGUgZnJvbSBvYmplY3QgcmV0dXJuZWQgYnkgZ2V0c3RhdGUoKS4iIiIKICAgICAgICB2ZXJzaW9uID0gc3RhdGVbMF0KICAgICAgICBpZiB2ZXJzaW9uID09IDM6CiAgICAgICAgICAgIHZlcnNpb24sIGludGVybmFsc3RhdGUsIHNlbGYuZ2F1c3NfbmV4dCA9IHN0YXRlCiAgICAgICAgICAgIHN1cGVyKCkuc2V0c3RhdGUoaW50ZXJuYWxzdGF0ZSkKICAgICAgICBlbGlmIHZlcnNpb24gPT0gMjoKICAgICAgICAgICAgdmVyc2lvbiwgaW50ZXJuYWxzdGF0ZSwgc2VsZi5nYXVzc19uZXh0ID0gc3RhdGUKICAgICAgICAgICAgIyBJbiB2ZXJzaW9uIDIsIHRoZSBzdGF0ZSB3YXMgc2F2ZWQgYXMgc2lnbmVkIGludHMsIHdoaWNoIGNhdXNlcwogICAgICAgICAgICAjICAgaW5jb25zaXN0ZW5jaWVzIGJldHdlZW4gMzIvNjQtYml0IHN5c3RlbXMuIFRoZSBzdGF0ZSBpcwogICAgICAgICAgICAjICAgcmVhbGx5IHVuc2lnbmVkIDMyLWJpdCBpbnRzLCBzbyB3ZSBjb252ZXJ0IG5lZ2F0aXZlIGludHMgZnJvbQogICAgICAgICAgICAjICAgdmVyc2lvbiAyIHRvIHBvc2l0aXZlIGxvbmdzIGZvciB2ZXJzaW9uIDMuCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGludGVybmFsc3RhdGUgPSB0dXBsZSh4ICUgKDIqKjMyKSBmb3IgeCBpbiBpbnRlcm5hbHN0YXRlKQogICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvciBhcyBlOgogICAgICAgICAgICAgICAgI2ZpeG1lIGJyeXRob24KICAgICAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcihlKQogICAgICAgICAgICAgICAgI3JhaXNlIFR5cGVFcnJvciBmcm9tIGUKICAgICAgICAgICAgc3VwZXIoKS5zZXRzdGF0ZShpbnRlcm5hbHN0YXRlKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoInN0YXRlIHdpdGggdmVyc2lvbiAlcyBwYXNzZWQgdG8gIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJSYW5kb20uc2V0c3RhdGUoKSBvZiB2ZXJzaW9uICVzIiAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZlcnNpb24sIHNlbGYuVkVSU0lPTikpCgojIyAtLS0tIE1ldGhvZHMgYmVsb3cgdGhpcyBwb2ludCBkbyBub3QgbmVlZCB0byBiZSBvdmVycmlkZGVuIHdoZW4KIyMgLS0tLSBzdWJjbGFzc2luZyBmb3IgdGhlIHB1cnBvc2Ugb2YgdXNpbmcgYSBkaWZmZXJlbnQgY29yZSBnZW5lcmF0b3IuCgojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLSBwaWNrbGUgc3VwcG9ydCAgLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIGRlZiBfX2dldHN0YXRlX18oc2VsZik6ICMgZm9yIHBpY2tsZQogICAgICAgIHJldHVybiBzZWxmLmdldHN0YXRlKCkKCiAgICBkZWYgX19zZXRzdGF0ZV9fKHNlbGYsIHN0YXRlKTogICMgZm9yIHBpY2tsZQogICAgICAgIHNlbGYuc2V0c3RhdGUoc3RhdGUpCgogICAgZGVmIF9fcmVkdWNlX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fLCAoKSwgc2VsZi5nZXRzdGF0ZSgpCgojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLSBpbnRlZ2VyIG1ldGhvZHMgIC0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgcmFuZHJhbmdlKHNlbGYsIHN0YXJ0LCBzdG9wPU5vbmUsIHN0ZXA9MSwgaW50PWludCk6CiAgICAgICAgIiIiQ2hvb3NlIGEgcmFuZG9tIGl0ZW0gZnJvbSByYW5nZShzdGFydCwgc3RvcFssIHN0ZXBdKS4KCiAgICAgICAgVGhpcyBmaXhlcyB0aGUgcHJvYmxlbSB3aXRoIHJhbmRpbnQoKSB3aGljaCBpbmNsdWRlcyB0aGUKICAgICAgICBlbmRwb2ludDsgaW4gUHl0aG9uIHRoaXMgaXMgdXN1YWxseSBub3Qgd2hhdCB5b3Ugd2FudC4KCiAgICAgICAgRG8gbm90IHN1cHBseSB0aGUgJ2ludCcgYXJndW1lbnQuCiAgICAgICAgIiIiCgogICAgICAgICMgVGhpcyBjb2RlIGlzIGEgYml0IG1lc3N5IHRvIG1ha2UgaXQgZmFzdCBmb3IgdGhlCiAgICAgICAgIyBjb21tb24gY2FzZSB3aGlsZSBzdGlsbCBkb2luZyBhZGVxdWF0ZSBlcnJvciBjaGVja2luZy4KICAgICAgICBpc3RhcnQgPSBpbnQoc3RhcnQpCiAgICAgICAgaWYgaXN0YXJ0ICE9IHN0YXJ0OgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJub24taW50ZWdlciBhcmcgMSBmb3IgcmFuZHJhbmdlKCkiKQogICAgICAgIGlmIHN0b3AgaXMgTm9uZToKICAgICAgICAgICAgaWYgaXN0YXJ0ID4gMDoKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLl9yYW5kYmVsb3coaXN0YXJ0KQogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJlbXB0eSByYW5nZSBmb3IgcmFuZHJhbmdlKCkiKQoKICAgICAgICAjIHN0b3AgYXJndW1lbnQgc3VwcGxpZWQuCiAgICAgICAgaXN0b3AgPSBpbnQoc3RvcCkKICAgICAgICBpZiBpc3RvcCAhPSBzdG9wOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJub24taW50ZWdlciBzdG9wIGZvciByYW5kcmFuZ2UoKSIpCiAgICAgICAgd2lkdGggPSBpc3RvcCAtIGlzdGFydAogICAgICAgIGlmIHN0ZXAgPT0gMSBhbmQgd2lkdGggPiAwOgogICAgICAgICAgICByZXR1cm4gaXN0YXJ0ICsgc2VsZi5fcmFuZGJlbG93KHdpZHRoKQogICAgICAgIGlmIHN0ZXAgPT0gMToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiZW1wdHkgcmFuZ2UgZm9yIHJhbmRyYW5nZSgpICglZCwlZCwgJWQpIiAlIChpc3RhcnQsIGlzdG9wLCB3aWR0aCkpCgogICAgICAgICMgTm9uLXVuaXQgc3RlcCBhcmd1bWVudCBzdXBwbGllZC4KICAgICAgICBpc3RlcCA9IGludChzdGVwKQogICAgICAgIGlmIGlzdGVwICE9IHN0ZXA6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIm5vbi1pbnRlZ2VyIHN0ZXAgZm9yIHJhbmRyYW5nZSgpIikKICAgICAgICBpZiBpc3RlcCA+IDA6CiAgICAgICAgICAgIG4gPSAod2lkdGggKyBpc3RlcCAtIDEpIC8vIGlzdGVwCiAgICAgICAgZWxpZiBpc3RlcCA8IDA6CiAgICAgICAgICAgIG4gPSAod2lkdGggKyBpc3RlcCArIDEpIC8vIGlzdGVwCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiemVybyBzdGVwIGZvciByYW5kcmFuZ2UoKSIpCgogICAgICAgIGlmIG4gPD0gMDoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiZW1wdHkgcmFuZ2UgZm9yIHJhbmRyYW5nZSgpIikKCiAgICAgICAgcmV0dXJuIGlzdGFydCArIGlzdGVwKnNlbGYuX3JhbmRiZWxvdyhuKQoKICAgIGRlZiByYW5kaW50KHNlbGYsIGEsIGIpOgogICAgICAgICIiIlJldHVybiByYW5kb20gaW50ZWdlciBpbiByYW5nZSBbYSwgYl0sIGluY2x1ZGluZyBib3RoIGVuZCBwb2ludHMuCiAgICAgICAgIiIiCgogICAgICAgIHJldHVybiBzZWxmLnJhbmRyYW5nZShhLCBiKzEpCgogICAgZGVmIF9yYW5kYmVsb3coc2VsZiwgbiwgaW50PWludCwgbWF4c2l6ZT0xPDxCUEYsIHR5cGU9dHlwZSwKICAgICAgICAgICAgICAgICAgIE1ldGhvZD1fTWV0aG9kVHlwZSwgQnVpbHRpbk1ldGhvZD1fQnVpbHRpbk1ldGhvZFR5cGUpOgogICAgICAgICJSZXR1cm4gYSByYW5kb20gaW50IGluIHRoZSByYW5nZSBbMCxuKS4gIFJhaXNlcyBWYWx1ZUVycm9yIGlmIG49PTAuIgoKICAgICAgICBnZXRyYW5kYml0cyA9IHNlbGYuZ2V0cmFuZGJpdHMKICAgICAgICAjIE9ubHkgY2FsbCBzZWxmLmdldHJhbmRiaXRzIGlmIHRoZSBvcmlnaW5hbCByYW5kb20oKSBidWlsdGluIG1ldGhvZAogICAgICAgICMgaGFzIG5vdCBiZWVuIG92ZXJyaWRkZW4gb3IgaWYgYSBuZXcgZ2V0cmFuZGJpdHMoKSB3YXMgc3VwcGxpZWQuCiAgICAgICAgaWYgdHlwZShzZWxmLnJhbmRvbSkgaXMgQnVpbHRpbk1ldGhvZCBvciB0eXBlKGdldHJhbmRiaXRzKSBpcyBNZXRob2Q6CiAgICAgICAgICAgIGsgPSBuLmJpdF9sZW5ndGgoKSAgIyBkb24ndCB1c2UgKG4tMSkgaGVyZSBiZWNhdXNlIG4gY2FuIGJlIDEKICAgICAgICAgICAgciA9IGdldHJhbmRiaXRzKGspICAgICAgICAgICMgMCA8PSByIDwgMioqawogICAgICAgICAgICB3aGlsZSByID49IG46CiAgICAgICAgICAgICAgICByID0gZ2V0cmFuZGJpdHMoaykKICAgICAgICAgICAgcmV0dXJuIHIKICAgICAgICAjIFRoZXJlJ3MgYW4gb3ZlcnJpZGVuIHJhbmRvbSgpIG1ldGhvZCBidXQgbm8gbmV3IGdldHJhbmRiaXRzKCkgbWV0aG9kLAogICAgICAgICMgc28gd2UgY2FuIG9ubHkgdXNlIHJhbmRvbSgpIGZyb20gaGVyZS4KICAgICAgICByYW5kb20gPSBzZWxmLnJhbmRvbQogICAgICAgIGlmIG4gPj0gbWF4c2l6ZToKICAgICAgICAgICAgX3dhcm4oIlVuZGVybHlpbmcgcmFuZG9tKCkgZ2VuZXJhdG9yIGRvZXMgbm90IHN1cHBseSBcbiIKICAgICAgICAgICAgICAgICJlbm91Z2ggYml0cyB0byBjaG9vc2UgZnJvbSBhIHBvcHVsYXRpb24gcmFuZ2UgdGhpcyBsYXJnZS5cbiIKICAgICAgICAgICAgICAgICJUbyByZW1vdmUgdGhlIHJhbmdlIGxpbWl0YXRpb24sIGFkZCBhIGdldHJhbmRiaXRzKCkgbWV0aG9kLiIpCiAgICAgICAgICAgIHJldHVybiBpbnQocmFuZG9tKCkgKiBuKQogICAgICAgIHJlbSA9IG1heHNpemUgJSBuCiAgICAgICAgbGltaXQgPSAobWF4c2l6ZSAtIHJlbSkgLyBtYXhzaXplICAgIyBpbnQobGltaXQgKiBtYXhzaXplKSAlIG4gPT0gMAogICAgICAgIHIgPSByYW5kb20oKQogICAgICAgIHdoaWxlIHIgPj0gbGltaXQ6CiAgICAgICAgICAgIHIgPSByYW5kb20oKQogICAgICAgIHJldHVybiBpbnQociptYXhzaXplKSAlIG4KCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tIHNlcXVlbmNlIG1ldGhvZHMgIC0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgY2hvaWNlKHNlbGYsIHNlcSk6CiAgICAgICAgIiIiQ2hvb3NlIGEgcmFuZG9tIGVsZW1lbnQgZnJvbSBhIG5vbi1lbXB0eSBzZXF1ZW5jZS4iIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgIGkgPSBzZWxmLl9yYW5kYmVsb3cobGVuKHNlcSkpCiAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgIHJhaXNlIEluZGV4RXJyb3IoJ0Nhbm5vdCBjaG9vc2UgZnJvbSBhbiBlbXB0eSBzZXF1ZW5jZScpCiAgICAgICAgcmV0dXJuIHNlcVtpXQoKICAgIGRlZiBzaHVmZmxlKHNlbGYsIHgsIHJhbmRvbT1Ob25lLCBpbnQ9aW50KToKICAgICAgICAiIiJ4LCByYW5kb209cmFuZG9tLnJhbmRvbSAtPiBzaHVmZmxlIGxpc3QgeCBpbiBwbGFjZTsgcmV0dXJuIE5vbmUuCgogICAgICAgIE9wdGlvbmFsIGFyZyByYW5kb20gaXMgYSAwLWFyZ3VtZW50IGZ1bmN0aW9uIHJldHVybmluZyBhIHJhbmRvbQogICAgICAgIGZsb2F0IGluIFswLjAsIDEuMCk7IGJ5IGRlZmF1bHQsIHRoZSBzdGFuZGFyZCByYW5kb20ucmFuZG9tLgogICAgICAgICIiIgoKICAgICAgICByYW5kYmVsb3cgPSBzZWxmLl9yYW5kYmVsb3cKICAgICAgICBmb3IgaSBpbiByZXZlcnNlZChyYW5nZSgxLCBsZW4oeCkpKToKICAgICAgICAgICAgIyBwaWNrIGFuIGVsZW1lbnQgaW4geFs6aSsxXSB3aXRoIHdoaWNoIHRvIGV4Y2hhbmdlIHhbaV0KICAgICAgICAgICAgaiA9IHJhbmRiZWxvdyhpKzEpIGlmIHJhbmRvbSBpcyBOb25lIGVsc2UgaW50KHJhbmRvbSgpICogKGkrMSkpCiAgICAgICAgICAgIHhbaV0sIHhbal0gPSB4W2pdLCB4W2ldCgogICAgZGVmIHNhbXBsZShzZWxmLCBwb3B1bGF0aW9uLCBrKToKICAgICAgICAiIiJDaG9vc2VzIGsgdW5pcXVlIHJhbmRvbSBlbGVtZW50cyBmcm9tIGEgcG9wdWxhdGlvbiBzZXF1ZW5jZSBvciBzZXQuCgogICAgICAgIFJldHVybnMgYSBuZXcgbGlzdCBjb250YWluaW5nIGVsZW1lbnRzIGZyb20gdGhlIHBvcHVsYXRpb24gd2hpbGUKICAgICAgICBsZWF2aW5nIHRoZSBvcmlnaW5hbCBwb3B1bGF0aW9uIHVuY2hhbmdlZC4gIFRoZSByZXN1bHRpbmcgbGlzdCBpcwogICAgICAgIGluIHNlbGVjdGlvbiBvcmRlciBzbyB0aGF0IGFsbCBzdWItc2xpY2VzIHdpbGwgYWxzbyBiZSB2YWxpZCByYW5kb20KICAgICAgICBzYW1wbGVzLiAgVGhpcyBhbGxvd3MgcmFmZmxlIHdpbm5lcnMgKHRoZSBzYW1wbGUpIHRvIGJlIHBhcnRpdGlvbmVkCiAgICAgICAgaW50byBncmFuZCBwcml6ZSBhbmQgc2Vjb25kIHBsYWNlIHdpbm5lcnMgKHRoZSBzdWJzbGljZXMpLgoKICAgICAgICBNZW1iZXJzIG9mIHRoZSBwb3B1bGF0aW9uIG5lZWQgbm90IGJlIGhhc2hhYmxlIG9yIHVuaXF1ZS4gIElmIHRoZQogICAgICAgIHBvcHVsYXRpb24gY29udGFpbnMgcmVwZWF0cywgdGhlbiBlYWNoIG9jY3VycmVuY2UgaXMgYSBwb3NzaWJsZQogICAgICAgIHNlbGVjdGlvbiBpbiB0aGUgc2FtcGxlLgoKICAgICAgICBUbyBjaG9vc2UgYSBzYW1wbGUgaW4gYSByYW5nZSBvZiBpbnRlZ2VycywgdXNlIHJhbmdlIGFzIGFuIGFyZ3VtZW50LgogICAgICAgIFRoaXMgaXMgZXNwZWNpYWxseSBmYXN0IGFuZCBzcGFjZSBlZmZpY2llbnQgZm9yIHNhbXBsaW5nIGZyb20gYQogICAgICAgIGxhcmdlIHBvcHVsYXRpb246ICAgc2FtcGxlKHJhbmdlKDEwMDAwMDAwKSwgNjApCiAgICAgICAgIiIiCgogICAgICAgICMgU2FtcGxpbmcgd2l0aG91dCByZXBsYWNlbWVudCBlbnRhaWxzIHRyYWNraW5nIGVpdGhlciBwb3RlbnRpYWwKICAgICAgICAjIHNlbGVjdGlvbnMgKHRoZSBwb29sKSBpbiBhIGxpc3Qgb3IgcHJldmlvdXMgc2VsZWN0aW9ucyBpbiBhIHNldC4KCiAgICAgICAgIyBXaGVuIHRoZSBudW1iZXIgb2Ygc2VsZWN0aW9ucyBpcyBzbWFsbCBjb21wYXJlZCB0byB0aGUKICAgICAgICAjIHBvcHVsYXRpb24sIHRoZW4gdHJhY2tpbmcgc2VsZWN0aW9ucyBpcyBlZmZpY2llbnQsIHJlcXVpcmluZwogICAgICAgICMgb25seSBhIHNtYWxsIHNldCBhbmQgYW4gb2NjYXNpb25hbCByZXNlbGVjdGlvbi4gIEZvcgogICAgICAgICMgYSBsYXJnZXIgbnVtYmVyIG9mIHNlbGVjdGlvbnMsIHRoZSBwb29sIHRyYWNraW5nIG1ldGhvZCBpcwogICAgICAgICMgcHJlZmVycmVkIHNpbmNlIHRoZSBsaXN0IHRha2VzIGxlc3Mgc3BhY2UgdGhhbiB0aGUKICAgICAgICAjIHNldCBhbmQgaXQgZG9lc24ndCBzdWZmZXIgZnJvbSBmcmVxdWVudCByZXNlbGVjdGlvbnMuCgogICAgICAgIGlmIGlzaW5zdGFuY2UocG9wdWxhdGlvbiwgX1NldCk6CiAgICAgICAgICAgIHBvcHVsYXRpb24gPSB0dXBsZShwb3B1bGF0aW9uKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHBvcHVsYXRpb24sIF9TZXF1ZW5jZSk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiUG9wdWxhdGlvbiBtdXN0IGJlIGEgc2VxdWVuY2Ugb3Igc2V0LiAgRm9yIGRpY3RzLCB1c2UgbGlzdChkKS4iKQogICAgICAgIHJhbmRiZWxvdyA9IHNlbGYuX3JhbmRiZWxvdwogICAgICAgIG4gPSBsZW4ocG9wdWxhdGlvbikKICAgICAgICBpZiBub3QgMCA8PSBrIDw9IG46CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIlNhbXBsZSBsYXJnZXIgdGhhbiBwb3B1bGF0aW9uIikKICAgICAgICByZXN1bHQgPSBbTm9uZV0gKiBrCiAgICAgICAgc2V0c2l6ZSA9IDIxICAgICAgICAjIHNpemUgb2YgYSBzbWFsbCBzZXQgbWludXMgc2l6ZSBvZiBhbiBlbXB0eSBsaXN0CiAgICAgICAgaWYgayA+IDU6CiAgICAgICAgICAgIHNldHNpemUgKz0gNCAqKiBfY2VpbChfbG9nKGsgKiAzLCA0KSkgIyB0YWJsZSBzaXplIGZvciBiaWcgc2V0cwogICAgICAgIGlmIG4gPD0gc2V0c2l6ZToKICAgICAgICAgICAgIyBBbiBuLWxlbmd0aCBsaXN0IGlzIHNtYWxsZXIgdGhhbiBhIGstbGVuZ3RoIHNldAogICAgICAgICAgICBwb29sID0gbGlzdChwb3B1bGF0aW9uKQogICAgICAgICAgICBmb3IgaSBpbiByYW5nZShrKTogICAgICAgICAjIGludmFyaWFudDogIG5vbi1zZWxlY3RlZCBhdCBbMCxuLWkpCiAgICAgICAgICAgICAgICBqID0gcmFuZGJlbG93KG4taSkKICAgICAgICAgICAgICAgIHJlc3VsdFtpXSA9IHBvb2xbal0KICAgICAgICAgICAgICAgIHBvb2xbal0gPSBwb29sW24taS0xXSAgICMgbW92ZSBub24tc2VsZWN0ZWQgaXRlbSBpbnRvIHZhY2FuY3kKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxlY3RlZCA9IHNldCgpCiAgICAgICAgICAgIHNlbGVjdGVkX2FkZCA9IHNlbGVjdGVkLmFkZAogICAgICAgICAgICBmb3IgaSBpbiByYW5nZShrKToKICAgICAgICAgICAgICAgIGogPSByYW5kYmVsb3cobikKICAgICAgICAgICAgICAgIHdoaWxlIGogaW4gc2VsZWN0ZWQ6CiAgICAgICAgICAgICAgICAgICAgaiA9IHJhbmRiZWxvdyhuKQogICAgICAgICAgICAgICAgc2VsZWN0ZWRfYWRkKGopCiAgICAgICAgICAgICAgICByZXN1bHRbaV0gPSBwb3B1bGF0aW9uW2pdCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKIyMgLS0tLS0tLS0tLS0tLS0tLS0tLS0gcmVhbC12YWx1ZWQgZGlzdHJpYnV0aW9ucyAgLS0tLS0tLS0tLS0tLS0tLS0tLQoKIyMgLS0tLS0tLS0tLS0tLS0tLS0tLS0gdW5pZm9ybSBkaXN0cmlidXRpb24gLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIGRlZiB1bmlmb3JtKHNlbGYsIGEsIGIpOgogICAgICAgICJHZXQgYSByYW5kb20gbnVtYmVyIGluIHRoZSByYW5nZSBbYSwgYikgb3IgW2EsIGJdIGRlcGVuZGluZyBvbiByb3VuZGluZy4iCiAgICAgICAgcmV0dXJuIGEgKyAoYi1hKSAqIHNlbGYucmFuZG9tKCkKCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tIHRyaWFuZ3VsYXIgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgdHJpYW5ndWxhcihzZWxmLCBsb3c9MC4wLCBoaWdoPTEuMCwgbW9kZT1Ob25lKToKICAgICAgICAiIiJUcmlhbmd1bGFyIGRpc3RyaWJ1dGlvbi4KCiAgICAgICAgQ29udGludW91cyBkaXN0cmlidXRpb24gYm91bmRlZCBieSBnaXZlbiBsb3dlciBhbmQgdXBwZXIgbGltaXRzLAogICAgICAgIGFuZCBoYXZpbmcgYSBnaXZlbiBtb2RlIHZhbHVlIGluLWJldHdlZW4uCgogICAgICAgIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvVHJpYW5ndWxhcl9kaXN0cmlidXRpb24KCiAgICAgICAgIiIiCiAgICAgICAgdSA9IHNlbGYucmFuZG9tKCkKICAgICAgICBjID0gMC41IGlmIG1vZGUgaXMgTm9uZSBlbHNlIChtb2RlIC0gbG93KSAvIChoaWdoIC0gbG93KQogICAgICAgIGlmIHUgPiBjOgogICAgICAgICAgICB1ID0gMS4wIC0gdQogICAgICAgICAgICBjID0gMS4wIC0gYwogICAgICAgICAgICBsb3csIGhpZ2ggPSBoaWdoLCBsb3cKICAgICAgICByZXR1cm4gbG93ICsgKGhpZ2ggLSBsb3cpICogKHUgKiBjKSAqKiAwLjUKCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tIG5vcm1hbCBkaXN0cmlidXRpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgbm9ybWFsdmFyaWF0ZShzZWxmLCBtdSwgc2lnbWEpOgogICAgICAgICIiIk5vcm1hbCBkaXN0cmlidXRpb24uCgogICAgICAgIG11IGlzIHRoZSBtZWFuLCBhbmQgc2lnbWEgaXMgdGhlIHN0YW5kYXJkIGRldmlhdGlvbi4KCiAgICAgICAgIiIiCiAgICAgICAgIyBtdSA9IG1lYW4sIHNpZ21hID0gc3RhbmRhcmQgZGV2aWF0aW9uCgogICAgICAgICMgVXNlcyBLaW5kZXJtYW4gYW5kIE1vbmFoYW4gbWV0aG9kLiBSZWZlcmVuY2U6IEtpbmRlcm1hbiwKICAgICAgICAjIEEuSi4gYW5kIE1vbmFoYW4sIEouRi4sICJDb21wdXRlciBnZW5lcmF0aW9uIG9mIHJhbmRvbQogICAgICAgICMgdmFyaWFibGVzIHVzaW5nIHRoZSByYXRpbyBvZiB1bmlmb3JtIGRldmlhdGVzIiwgQUNNIFRyYW5zCiAgICAgICAgIyBNYXRoIFNvZnR3YXJlLCAzLCAoMTk3NyksIHBwMjU3LTI2MC4KCiAgICAgICAgcmFuZG9tID0gc2VsZi5yYW5kb20KICAgICAgICB3aGlsZSAxOgogICAgICAgICAgICB1MSA9IHJhbmRvbSgpCiAgICAgICAgICAgIHUyID0gMS4wIC0gcmFuZG9tKCkKICAgICAgICAgICAgeiA9IE5WX01BR0lDQ09OU1QqKHUxLTAuNSkvdTIKICAgICAgICAgICAgenogPSB6KnovNC4wCiAgICAgICAgICAgIGlmIHp6IDw9IC1fbG9nKHUyKToKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgcmV0dXJuIG11ICsgeipzaWdtYQoKIyMgLS0tLS0tLS0tLS0tLS0tLS0tLS0gbG9nbm9ybWFsIGRpc3RyaWJ1dGlvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIGRlZiBsb2dub3JtdmFyaWF0ZShzZWxmLCBtdSwgc2lnbWEpOgogICAgICAgICIiIkxvZyBub3JtYWwgZGlzdHJpYnV0aW9uLgoKICAgICAgICBJZiB5b3UgdGFrZSB0aGUgbmF0dXJhbCBsb2dhcml0aG0gb2YgdGhpcyBkaXN0cmlidXRpb24sIHlvdSdsbCBnZXQgYQogICAgICAgIG5vcm1hbCBkaXN0cmlidXRpb24gd2l0aCBtZWFuIG11IGFuZCBzdGFuZGFyZCBkZXZpYXRpb24gc2lnbWEuCiAgICAgICAgbXUgY2FuIGhhdmUgYW55IHZhbHVlLCBhbmQgc2lnbWEgbXVzdCBiZSBncmVhdGVyIHRoYW4gemVyby4KCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIF9leHAoc2VsZi5ub3JtYWx2YXJpYXRlKG11LCBzaWdtYSkpCgojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLSBleHBvbmVudGlhbCBkaXN0cmlidXRpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgZXhwb3ZhcmlhdGUoc2VsZiwgbGFtYmQpOgogICAgICAgICIiIkV4cG9uZW50aWFsIGRpc3RyaWJ1dGlvbi4KCiAgICAgICAgbGFtYmQgaXMgMS4wIGRpdmlkZWQgYnkgdGhlIGRlc2lyZWQgbWVhbi4gIEl0IHNob3VsZCBiZQogICAgICAgIG5vbnplcm8uICAoVGhlIHBhcmFtZXRlciB3b3VsZCBiZSBjYWxsZWQgImxhbWJkYSIsIGJ1dCB0aGF0IGlzCiAgICAgICAgYSByZXNlcnZlZCB3b3JkIGluIFB5dGhvbi4pICBSZXR1cm5lZCB2YWx1ZXMgcmFuZ2UgZnJvbSAwIHRvCiAgICAgICAgcG9zaXRpdmUgaW5maW5pdHkgaWYgbGFtYmQgaXMgcG9zaXRpdmUsIGFuZCBmcm9tIG5lZ2F0aXZlCiAgICAgICAgaW5maW5pdHkgdG8gMCBpZiBsYW1iZCBpcyBuZWdhdGl2ZS4KCiAgICAgICAgIiIiCiAgICAgICAgIyBsYW1iZDogcmF0ZSBsYW1iZCA9IDEvbWVhbgogICAgICAgICMgKCdsYW1iZGEnIGlzIGEgUHl0aG9uIHJlc2VydmVkIHdvcmQpCgogICAgICAgICMgd2UgdXNlIDEtcmFuZG9tKCkgaW5zdGVhZCBvZiByYW5kb20oKSB0byBwcmVjbHVkZSB0aGUKICAgICAgICAjIHBvc3NpYmlsaXR5IG9mIHRha2luZyB0aGUgbG9nIG9mIHplcm8uCiAgICAgICAgcmV0dXJuIC1fbG9nKDEuMCAtIHNlbGYucmFuZG9tKCkpL2xhbWJkCgojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLSB2b24gTWlzZXMgZGlzdHJpYnV0aW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgZGVmIHZvbm1pc2VzdmFyaWF0ZShzZWxmLCBtdSwga2FwcGEpOgogICAgICAgICIiIkNpcmN1bGFyIGRhdGEgZGlzdHJpYnV0aW9uLgoKICAgICAgICBtdSBpcyB0aGUgbWVhbiBhbmdsZSwgZXhwcmVzc2VkIGluIHJhZGlhbnMgYmV0d2VlbiAwIGFuZCAyKnBpLCBhbmQKICAgICAgICBrYXBwYSBpcyB0aGUgY29uY2VudHJhdGlvbiBwYXJhbWV0ZXIsIHdoaWNoIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yCiAgICAgICAgZXF1YWwgdG8gemVyby4gIElmIGthcHBhIGlzIGVxdWFsIHRvIHplcm8sIHRoaXMgZGlzdHJpYnV0aW9uIHJlZHVjZXMKICAgICAgICB0byBhIHVuaWZvcm0gcmFuZG9tIGFuZ2xlIG92ZXIgdGhlIHJhbmdlIDAgdG8gMipwaS4KCiAgICAgICAgIiIiCiAgICAgICAgIyBtdTogICAgbWVhbiBhbmdsZSAoaW4gcmFkaWFucyBiZXR3ZWVuIDAgYW5kIDIqcGkpCiAgICAgICAgIyBrYXBwYTogY29uY2VudHJhdGlvbiBwYXJhbWV0ZXIga2FwcGEgKD49IDApCiAgICAgICAgIyBpZiBrYXBwYSA9IDAgZ2VuZXJhdGUgdW5pZm9ybSByYW5kb20gYW5nbGUKCiAgICAgICAgIyBCYXNlZCB1cG9uIGFuIGFsZ29yaXRobSBwdWJsaXNoZWQgaW46IEZpc2hlciwgTi5JLiwKICAgICAgICAjICJTdGF0aXN0aWNhbCBBbmFseXNpcyBvZiBDaXJjdWxhciBEYXRhIiwgQ2FtYnJpZGdlCiAgICAgICAgIyBVbml2ZXJzaXR5IFByZXNzLCAxOTkzLgoKICAgICAgICAjIFRoYW5rcyB0byBNYWdudXMgS2Vzc2xlciBmb3IgYSBjb3JyZWN0aW9uIHRvIHRoZQogICAgICAgICMgaW1wbGVtZW50YXRpb24gb2Ygc3RlcCA0LgoKICAgICAgICByYW5kb20gPSBzZWxmLnJhbmRvbQogICAgICAgIGlmIGthcHBhIDw9IDFlLTY6CiAgICAgICAgICAgIHJldHVybiBUV09QSSAqIHJhbmRvbSgpCgogICAgICAgIGEgPSAxLjAgKyBfc3FydCgxLjAgKyA0LjAgKiBrYXBwYSAqIGthcHBhKQogICAgICAgIGIgPSAoYSAtIF9zcXJ0KDIuMCAqIGEpKS8oMi4wICoga2FwcGEpCiAgICAgICAgciA9ICgxLjAgKyBiICogYikvKDIuMCAqIGIpCgogICAgICAgIHdoaWxlIDE6CiAgICAgICAgICAgIHUxID0gcmFuZG9tKCkKCiAgICAgICAgICAgIHogPSBfY29zKF9waSAqIHUxKQogICAgICAgICAgICBmID0gKDEuMCArIHIgKiB6KS8ociArIHopCiAgICAgICAgICAgIGMgPSBrYXBwYSAqIChyIC0gZikKCiAgICAgICAgICAgIHUyID0gcmFuZG9tKCkKCiAgICAgICAgICAgIGlmIHUyIDwgYyAqICgyLjAgLSBjKSBvciB1MiA8PSBjICogX2V4cCgxLjAgLSBjKToKICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgIHUzID0gcmFuZG9tKCkKICAgICAgICBpZiB1MyA+IDAuNToKICAgICAgICAgICAgdGhldGEgPSAobXUgJSBUV09QSSkgKyBfYWNvcyhmKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRoZXRhID0gKG11ICUgVFdPUEkpIC0gX2Fjb3MoZikKCiAgICAgICAgcmV0dXJuIHRoZXRhCgojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLSBnYW1tYSBkaXN0cmlidXRpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgZ2FtbWF2YXJpYXRlKHNlbGYsIGFscGhhLCBiZXRhKToKICAgICAgICAiIiJHYW1tYSBkaXN0cmlidXRpb24uICBOb3QgdGhlIGdhbW1hIGZ1bmN0aW9uIQoKICAgICAgICBDb25kaXRpb25zIG9uIHRoZSBwYXJhbWV0ZXJzIGFyZSBhbHBoYSA+IDAgYW5kIGJldGEgPiAwLgoKICAgICAgICBUaGUgcHJvYmFiaWxpdHkgZGlzdHJpYnV0aW9uIGZ1bmN0aW9uIGlzOgoKICAgICAgICAgICAgICAgICAgICB4ICoqIChhbHBoYSAtIDEpICogbWF0aC5leHAoLXggLyBiZXRhKQogICAgICAgICAgcGRmKHgpID0gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgICAgICAgICAgICBtYXRoLmdhbW1hKGFscGhhKSAqIGJldGEgKiogYWxwaGEKCiAgICAgICAgIiIiCgogICAgICAgICMgYWxwaGEgPiAwLCBiZXRhID4gMCwgbWVhbiBpcyBhbHBoYSpiZXRhLCB2YXJpYW5jZSBpcyBhbHBoYSpiZXRhKioyCgogICAgICAgICMgV2FybmluZzogYSBmZXcgb2xkZXIgc291cmNlcyBkZWZpbmUgdGhlIGdhbW1hIGRpc3RyaWJ1dGlvbiBpbiB0ZXJtcwogICAgICAgICMgb2YgYWxwaGEgPiAtMS4wCiAgICAgICAgaWYgYWxwaGEgPD0gMC4wIG9yIGJldGEgPD0gMC4wOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdnYW1tYXZhcmlhdGU6IGFscGhhIGFuZCBiZXRhIG11c3QgYmUgPiAwLjAnKQoKICAgICAgICByYW5kb20gPSBzZWxmLnJhbmRvbQogICAgICAgIGlmIGFscGhhID4gMS4wOgoKICAgICAgICAgICAgIyBVc2VzIFIuQy5ILiBDaGVuZywgIlRoZSBnZW5lcmF0aW9uIG9mIEdhbW1hCiAgICAgICAgICAgICMgdmFyaWFibGVzIHdpdGggbm9uLWludGVncmFsIHNoYXBlIHBhcmFtZXRlcnMiLAogICAgICAgICAgICAjIEFwcGxpZWQgU3RhdGlzdGljcywgKDE5NzcpLCAyNiwgTm8uIDEsIHA3MS03NAoKICAgICAgICAgICAgYWludiA9IF9zcXJ0KDIuMCAqIGFscGhhIC0gMS4wKQogICAgICAgICAgICBiYmIgPSBhbHBoYSAtIExPRzQKICAgICAgICAgICAgY2NjID0gYWxwaGEgKyBhaW52CgogICAgICAgICAgICB3aGlsZSAxOgogICAgICAgICAgICAgICAgdTEgPSByYW5kb20oKQogICAgICAgICAgICAgICAgI2ZpeG1lIGJyeXRob24KICAgICAgICAgICAgICAgICNpZiBub3QgMWUtNyA8IHUxIDwgLjk5OTk5OTk6CiAgICAgICAgICAgICAgICBpZiBub3QgMWUtNyA8IHUxIDwgMC45OTk5OTk5OgogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICB1MiA9IDEuMCAtIHJhbmRvbSgpCiAgICAgICAgICAgICAgICB2ID0gX2xvZyh1MS8oMS4wLXUxKSkvYWludgogICAgICAgICAgICAgICAgeCA9IGFscGhhKl9leHAodikKICAgICAgICAgICAgICAgIHogPSB1MSp1MSp1MgogICAgICAgICAgICAgICAgciA9IGJiYitjY2Mqdi14CiAgICAgICAgICAgICAgICBpZiByICsgU0dfTUFHSUNDT05TVCAtIDQuNSp6ID49IDAuMCBvciByID49IF9sb2coeik6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHggKiBiZXRhCgogICAgICAgIGVsaWYgYWxwaGEgPT0gMS4wOgogICAgICAgICAgICAjIGV4cG92YXJpYXRlKDEpCiAgICAgICAgICAgIHUgPSByYW5kb20oKQogICAgICAgICAgICB3aGlsZSB1IDw9IDFlLTc6CiAgICAgICAgICAgICAgICB1ID0gcmFuZG9tKCkKICAgICAgICAgICAgcmV0dXJuIC1fbG9nKHUpICogYmV0YQoKICAgICAgICBlbHNlOiAgICMgYWxwaGEgaXMgYmV0d2VlbiAwIGFuZCAxIChleGNsdXNpdmUpCgogICAgICAgICAgICAjIFVzZXMgQUxHT1JJVEhNIEdTIG9mIFN0YXRpc3RpY2FsIENvbXB1dGluZyAtIEtlbm5lZHkgJiBHZW50bGUKCiAgICAgICAgICAgIHdoaWxlIDE6CiAgICAgICAgICAgICAgICB1ID0gcmFuZG9tKCkKICAgICAgICAgICAgICAgIGIgPSAoX2UgKyBhbHBoYSkvX2UKICAgICAgICAgICAgICAgIHAgPSBiKnUKICAgICAgICAgICAgICAgIGlmIHAgPD0gMS4wOgogICAgICAgICAgICAgICAgICAgIHggPSBwICoqICgxLjAvYWxwaGEpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHggPSAtX2xvZygoYi1wKS9hbHBoYSkKICAgICAgICAgICAgICAgIHUxID0gcmFuZG9tKCkKICAgICAgICAgICAgICAgIGlmIHAgPiAxLjA6CiAgICAgICAgICAgICAgICAgICAgaWYgdTEgPD0geCAqKiAoYWxwaGEgLSAxLjApOgogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgZWxpZiB1MSA8PSBfZXhwKC14KToKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICByZXR1cm4geCAqIGJldGEKCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEdhdXNzIChmYXN0ZXIgYWx0ZXJuYXRpdmUpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgZGVmIGdhdXNzKHNlbGYsIG11LCBzaWdtYSk6CiAgICAgICAgIiIiR2F1c3NpYW4gZGlzdHJpYnV0aW9uLgoKICAgICAgICBtdSBpcyB0aGUgbWVhbiwgYW5kIHNpZ21hIGlzIHRoZSBzdGFuZGFyZCBkZXZpYXRpb24uICBUaGlzIGlzCiAgICAgICAgc2xpZ2h0bHkgZmFzdGVyIHRoYW4gdGhlIG5vcm1hbHZhcmlhdGUoKSBmdW5jdGlvbi4KCiAgICAgICAgTm90IHRocmVhZC1zYWZlIHdpdGhvdXQgYSBsb2NrIGFyb3VuZCBjYWxscy4KCiAgICAgICAgIiIiCgogICAgICAgICMgV2hlbiB4IGFuZCB5IGFyZSB0d28gdmFyaWFibGVzIGZyb20gWzAsIDEpLCB1bmlmb3JtbHkKICAgICAgICAjIGRpc3RyaWJ1dGVkLCB0aGVuCiAgICAgICAgIwogICAgICAgICMgICAgY29zKDIqcGkqeCkqc3FydCgtMipsb2coMS15KSkKICAgICAgICAjICAgIHNpbigyKnBpKngpKnNxcnQoLTIqbG9nKDEteSkpCiAgICAgICAgIwogICAgICAgICMgYXJlIHR3byAqaW5kZXBlbmRlbnQqIHZhcmlhYmxlcyB3aXRoIG5vcm1hbCBkaXN0cmlidXRpb24KICAgICAgICAjIChtdSA9IDAsIHNpZ21hID0gMSkuCiAgICAgICAgIyAoTGFtYmVydCBNZWVydGVucykKICAgICAgICAjIChjb3JyZWN0ZWQgdmVyc2lvbjsgYnVnIGRpc2NvdmVyZWQgYnkgTWlrZSBNaWxsZXIsIGZpeGVkIGJ5IExNKQoKICAgICAgICAjIE11bHRpdGhyZWFkaW5nIG5vdGU6IFdoZW4gdHdvIHRocmVhZHMgY2FsbCB0aGlzIGZ1bmN0aW9uCiAgICAgICAgIyBzaW11bHRhbmVvdXNseSwgaXQgaXMgcG9zc2libGUgdGhhdCB0aGV5IHdpbGwgcmVjZWl2ZSB0aGUKICAgICAgICAjIHNhbWUgcmV0dXJuIHZhbHVlLiAgVGhlIHdpbmRvdyBpcyB2ZXJ5IHNtYWxsIHRob3VnaC4gIFRvCiAgICAgICAgIyBhdm9pZCB0aGlzLCB5b3UgaGF2ZSB0byB1c2UgYSBsb2NrIGFyb3VuZCBhbGwgY2FsbHMuICAoSQogICAgICAgICMgZGlkbid0IHdhbnQgdG8gc2xvdyB0aGlzIGRvd24gaW4gdGhlIHNlcmlhbCBjYXNlIGJ5IHVzaW5nIGEKICAgICAgICAjIGxvY2sgaGVyZS4pCgogICAgICAgIHJhbmRvbSA9IHNlbGYucmFuZG9tCiAgICAgICAgeiA9IHNlbGYuZ2F1c3NfbmV4dAogICAgICAgIHNlbGYuZ2F1c3NfbmV4dCA9IE5vbmUKICAgICAgICBpZiB6IGlzIE5vbmU6CiAgICAgICAgICAgIHgycGkgPSByYW5kb20oKSAqIFRXT1BJCiAgICAgICAgICAgIGcycmFkID0gX3NxcnQoLTIuMCAqIF9sb2coMS4wIC0gcmFuZG9tKCkpKQogICAgICAgICAgICB6ID0gX2Nvcyh4MnBpKSAqIGcycmFkCiAgICAgICAgICAgIHNlbGYuZ2F1c3NfbmV4dCA9IF9zaW4oeDJwaSkgKiBnMnJhZAoKICAgICAgICByZXR1cm4gbXUgKyB6KnNpZ21hCgojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLSBiZXRhIC0tLS0tLS0tLS0tLS0tLS0tLS0tCiMjIFNlZQojIyBodHRwOi8vbWFpbC5weXRob24ub3JnL3BpcGVybWFpbC9weXRob24tYnVncy1saXN0LzIwMDEtSmFudWFyeS8wMDM3NTIuaHRtbAojIyBmb3IgSXZhbiBGcm9obmUncyBpbnNpZ2h0ZnVsIGFuYWx5c2lzIG9mIHdoeSB0aGUgb3JpZ2luYWwgaW1wbGVtZW50YXRpb246CiMjCiMjICAgIGRlZiBiZXRhdmFyaWF0ZShzZWxmLCBhbHBoYSwgYmV0YSk6CiMjICAgICAgICAjIERpc2NyZXRlIEV2ZW50IFNpbXVsYXRpb24gaW4gQywgcHAgODctODguCiMjCiMjICAgICAgICB5ID0gc2VsZi5leHBvdmFyaWF0ZShhbHBoYSkKIyMgICAgICAgIHogPSBzZWxmLmV4cG92YXJpYXRlKDEuMC9iZXRhKQojIyAgICAgICAgcmV0dXJuIHovKHkreikKIyMKIyMgd2FzIGRlYWQgd3JvbmcsIGFuZCBob3cgaXQgcHJvYmFibHkgZ290IHRoYXQgd2F5LgoKICAgIGRlZiBiZXRhdmFyaWF0ZShzZWxmLCBhbHBoYSwgYmV0YSk6CiAgICAgICAgIiIiQmV0YSBkaXN0cmlidXRpb24uCgogICAgICAgIENvbmRpdGlvbnMgb24gdGhlIHBhcmFtZXRlcnMgYXJlIGFscGhhID4gMCBhbmQgYmV0YSA+IDAuCiAgICAgICAgUmV0dXJuZWQgdmFsdWVzIHJhbmdlIGJldHdlZW4gMCBhbmQgMS4KCiAgICAgICAgIiIiCgogICAgICAgICMgVGhpcyB2ZXJzaW9uIGR1ZSB0byBKYW5uZSBTaW5ra29uZW4sIGFuZCBtYXRjaGVzIGFsbCB0aGUgc3RkCiAgICAgICAgIyB0ZXh0cyAoZS5nLiwgS251dGggVm9sIDIgRWQgMyBwZyAxMzQgInRoZSBiZXRhIGRpc3RyaWJ1dGlvbiIpLgogICAgICAgIHkgPSBzZWxmLmdhbW1hdmFyaWF0ZShhbHBoYSwgMS4pCiAgICAgICAgaWYgeSA9PSAwOgogICAgICAgICAgICByZXR1cm4gMC4wCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHkgLyAoeSArIHNlbGYuZ2FtbWF2YXJpYXRlKGJldGEsIDEuKSkKCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFBhcmV0byAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIGRlZiBwYXJldG92YXJpYXRlKHNlbGYsIGFscGhhKToKICAgICAgICAiIiJQYXJldG8gZGlzdHJpYnV0aW9uLiAgYWxwaGEgaXMgdGhlIHNoYXBlIHBhcmFtZXRlci4iIiIKICAgICAgICAjIEphaW4sIHBnLiA0OTUKCiAgICAgICAgdSA9IDEuMCAtIHNlbGYucmFuZG9tKCkKICAgICAgICByZXR1cm4gMS4wIC8gdSAqKiAoMS4wL2FscGhhKQoKIyMgLS0tLS0tLS0tLS0tLS0tLS0tLS0gV2VpYnVsbCAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIGRlZiB3ZWlidWxsdmFyaWF0ZShzZWxmLCBhbHBoYSwgYmV0YSk6CiAgICAgICAgIiIiV2VpYnVsbCBkaXN0cmlidXRpb24uCgogICAgICAgIGFscGhhIGlzIHRoZSBzY2FsZSBwYXJhbWV0ZXIgYW5kIGJldGEgaXMgdGhlIHNoYXBlIHBhcmFtZXRlci4KCiAgICAgICAgIiIiCiAgICAgICAgIyBKYWluLCBwZy4gNDk5OyBidWcgZml4IGNvdXJ0ZXN5IEJpbGwgQXJtcwoKICAgICAgICB1ID0gMS4wIC0gc2VsZi5yYW5kb20oKQogICAgICAgIHJldHVybiBhbHBoYSAqICgtX2xvZyh1KSkgKiogKDEuMC9iZXRhKQoKCiMjIC0tLS0tLS0tLS0tLS0tLSBPcGVyYXRpbmcgU3lzdGVtIFJhbmRvbSBTb3VyY2UgIC0tLS0tLS0tLS0tLS0tLS0tLQoKY2xhc3MgU3lzdGVtUmFuZG9tKFJhbmRvbSk6CiAgICAiIiJBbHRlcm5hdGUgcmFuZG9tIG51bWJlciBnZW5lcmF0b3IgdXNpbmcgc291cmNlcyBwcm92aWRlZAogICAgYnkgdGhlIG9wZXJhdGluZyBzeXN0ZW0gKHN1Y2ggYXMgL2Rldi91cmFuZG9tIG9uIFVuaXggb3IKICAgIENyeXB0R2VuUmFuZG9tIG9uIFdpbmRvd3MpLgoKICAgICBOb3QgYXZhaWxhYmxlIG9uIGFsbCBzeXN0ZW1zIChzZWUgb3MudXJhbmRvbSgpIGZvciBkZXRhaWxzKS4KICAgICIiIgoKICAgIGRlZiByYW5kb20oc2VsZik6CiAgICAgICAgIiIiR2V0IHRoZSBuZXh0IHJhbmRvbSBudW1iZXIgaW4gdGhlIHJhbmdlIFswLjAsIDEuMCkuIiIiCiAgICAgICAgcmV0dXJuIChpbnQuZnJvbV9ieXRlcyhfdXJhbmRvbSg3KSwgJ2JpZycpID4+IDMpICogUkVDSVBfQlBGCgogICAgZGVmIGdldHJhbmRiaXRzKHNlbGYsIGspOgogICAgICAgICIiImdldHJhbmRiaXRzKGspIC0+IHguICBHZW5lcmF0ZXMgYSBsb25nIGludCB3aXRoIGsgcmFuZG9tIGJpdHMuIiIiCiAgICAgICAgaWYgayA8PSAwOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdudW1iZXIgb2YgYml0cyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiB6ZXJvJykKICAgICAgICBpZiBrICE9IGludChrKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdudW1iZXIgb2YgYml0cyBzaG91bGQgYmUgYW4gaW50ZWdlcicpCiAgICAgICAgbnVtYnl0ZXMgPSAoayArIDcpIC8vIDggICAgICAgICAgICAgICAgICAgICAgICMgYml0cyAvIDggYW5kIHJvdW5kZWQgdXAKICAgICAgICB4ID0gaW50LmZyb21fYnl0ZXMoX3VyYW5kb20obnVtYnl0ZXMpLCAnYmlnJykKICAgICAgICByZXR1cm4geCA+PiAobnVtYnl0ZXMgKiA4IC0gaykgICAgICAgICAgICAgICAgIyB0cmltIGV4Y2VzcyBiaXRzCgogICAgZGVmIHNlZWQoc2VsZiwgKmFyZ3MsICoqa3dkcyk6CiAgICAgICAgIlN0dWIgbWV0aG9kLiAgTm90IHVzZWQgZm9yIGEgc3lzdGVtIHJhbmRvbSBudW1iZXIgZ2VuZXJhdG9yLiIKICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBfbm90aW1wbGVtZW50ZWQoc2VsZiwgKmFyZ3MsICoqa3dkcyk6CiAgICAgICAgIk1ldGhvZCBzaG91bGQgbm90IGJlIGNhbGxlZCBmb3IgYSBzeXN0ZW0gcmFuZG9tIG51bWJlciBnZW5lcmF0b3IuIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoJ1N5c3RlbSBlbnRyb3B5IHNvdXJjZSBkb2VzIG5vdCBoYXZlIHN0YXRlLicpCiAgICBnZXRzdGF0ZSA9IHNldHN0YXRlID0gX25vdGltcGxlbWVudGVkCgojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLSB0ZXN0IHByb2dyYW0gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmRlZiBfdGVzdF9nZW5lcmF0b3IobiwgZnVuYywgYXJncyk6CiAgICBpbXBvcnQgdGltZQogICAgcHJpbnQobiwgJ3RpbWVzJywgZnVuYy5fX25hbWVfXykKICAgIHRvdGFsID0gMC4wCiAgICBzcXN1bSA9IDAuMAogICAgc21hbGxlc3QgPSAxZTEwCiAgICBsYXJnZXN0ID0gLTFlMTAKICAgIHQwID0gdGltZS50aW1lKCkKICAgIGZvciBpIGluIHJhbmdlKG4pOgogICAgICAgIHggPSBmdW5jKCphcmdzKQogICAgICAgIHRvdGFsICs9IHgKICAgICAgICBzcXN1bSA9IHNxc3VtICsgeCp4CiAgICAgICAgc21hbGxlc3QgPSBtaW4oeCwgc21hbGxlc3QpCiAgICAgICAgbGFyZ2VzdCA9IG1heCh4LCBsYXJnZXN0KQogICAgdDEgPSB0aW1lLnRpbWUoKQogICAgcHJpbnQocm91bmQodDEtdDAsIDMpLCAnc2VjLCcsIGVuZD0nICcpCiAgICBhdmcgPSB0b3RhbC9uCiAgICBzdGRkZXYgPSBfc3FydChzcXN1bS9uIC0gYXZnKmF2ZykKICAgIHByaW50KCdhdmcgJWcsIHN0ZGRldiAlZywgbWluICVnLCBtYXggJWcnICUgXAogICAgICAgICAgICAgIChhdmcsIHN0ZGRldiwgc21hbGxlc3QsIGxhcmdlc3QpKQoKCmRlZiBfdGVzdChOPTIwMDApOgogICAgX3Rlc3RfZ2VuZXJhdG9yKE4sIHJhbmRvbSwgKCkpCiAgICBfdGVzdF9nZW5lcmF0b3IoTiwgbm9ybWFsdmFyaWF0ZSwgKDAuMCwgMS4wKSkKICAgIF90ZXN0X2dlbmVyYXRvcihOLCBsb2dub3JtdmFyaWF0ZSwgKDAuMCwgMS4wKSkKICAgIF90ZXN0X2dlbmVyYXRvcihOLCB2b25taXNlc3ZhcmlhdGUsICgwLjAsIDEuMCkpCiAgICBfdGVzdF9nZW5lcmF0b3IoTiwgZ2FtbWF2YXJpYXRlLCAoMC4wMSwgMS4wKSkKICAgIF90ZXN0X2dlbmVyYXRvcihOLCBnYW1tYXZhcmlhdGUsICgwLjEsIDEuMCkpCiAgICBfdGVzdF9nZW5lcmF0b3IoTiwgZ2FtbWF2YXJpYXRlLCAoMC4xLCAyLjApKQogICAgX3Rlc3RfZ2VuZXJhdG9yKE4sIGdhbW1hdmFyaWF0ZSwgKDAuNSwgMS4wKSkKICAgIF90ZXN0X2dlbmVyYXRvcihOLCBnYW1tYXZhcmlhdGUsICgwLjksIDEuMCkpCiAgICBfdGVzdF9nZW5lcmF0b3IoTiwgZ2FtbWF2YXJpYXRlLCAoMS4wLCAxLjApKQogICAgX3Rlc3RfZ2VuZXJhdG9yKE4sIGdhbW1hdmFyaWF0ZSwgKDIuMCwgMS4wKSkKICAgIF90ZXN0X2dlbmVyYXRvcihOLCBnYW1tYXZhcmlhdGUsICgyMC4wLCAxLjApKQogICAgX3Rlc3RfZ2VuZXJhdG9yKE4sIGdhbW1hdmFyaWF0ZSwgKDIwMC4wLCAxLjApKQogICAgX3Rlc3RfZ2VuZXJhdG9yKE4sIGdhdXNzLCAoMC4wLCAxLjApKQogICAgX3Rlc3RfZ2VuZXJhdG9yKE4sIGJldGF2YXJpYXRlLCAoMy4wLCAzLjApKQogICAgX3Rlc3RfZ2VuZXJhdG9yKE4sIHRyaWFuZ3VsYXIsICgwLjAsIDEuMCwgMS4wLzMuMCkpCgojIENyZWF0ZSBvbmUgaW5zdGFuY2UsIHNlZWRlZCBmcm9tIGN1cnJlbnQgdGltZSwgYW5kIGV4cG9ydCBpdHMgbWV0aG9kcwojIGFzIG1vZHVsZS1sZXZlbCBmdW5jdGlvbnMuICBUaGUgZnVuY3Rpb25zIHNoYXJlIHN0YXRlIGFjcm9zcyBhbGwgdXNlcwojKGJvdGggaW4gdGhlIHVzZXIncyBjb2RlIGFuZCBpbiB0aGUgUHl0aG9uIGxpYnJhcmllcyksIGJ1dCB0aGF0J3MgZmluZQojIGZvciBtb3N0IHByb2dyYW1zIGFuZCBpcyBlYXNpZXIgZm9yIHRoZSBjYXN1YWwgdXNlciB0aGFuIG1ha2luZyB0aGVtCiMgaW5zdGFudGlhdGUgdGhlaXIgb3duIFJhbmRvbSgpIGluc3RhbmNlLgoKX2luc3QgPSBSYW5kb20oKQpzZWVkID0gX2luc3Quc2VlZApyYW5kb20gPSBfaW5zdC5yYW5kb20KdW5pZm9ybSA9IF9pbnN0LnVuaWZvcm0KdHJpYW5ndWxhciA9IF9pbnN0LnRyaWFuZ3VsYXIKcmFuZGludCA9IF9pbnN0LnJhbmRpbnQKY2hvaWNlID0gX2luc3QuY2hvaWNlCnJhbmRyYW5nZSA9IF9pbnN0LnJhbmRyYW5nZQpzYW1wbGUgPSBfaW5zdC5zYW1wbGUKc2h1ZmZsZSA9IF9pbnN0LnNodWZmbGUKbm9ybWFsdmFyaWF0ZSA9IF9pbnN0Lm5vcm1hbHZhcmlhdGUKbG9nbm9ybXZhcmlhdGUgPSBfaW5zdC5sb2dub3JtdmFyaWF0ZQpleHBvdmFyaWF0ZSA9IF9pbnN0LmV4cG92YXJpYXRlCnZvbm1pc2VzdmFyaWF0ZSA9IF9pbnN0LnZvbm1pc2VzdmFyaWF0ZQpnYW1tYXZhcmlhdGUgPSBfaW5zdC5nYW1tYXZhcmlhdGUKZ2F1c3MgPSBfaW5zdC5nYXVzcwpiZXRhdmFyaWF0ZSA9IF9pbnN0LmJldGF2YXJpYXRlCnBhcmV0b3ZhcmlhdGUgPSBfaW5zdC5wYXJldG92YXJpYXRlCndlaWJ1bGx2YXJpYXRlID0gX2luc3Qud2VpYnVsbHZhcmlhdGUKZ2V0c3RhdGUgPSBfaW5zdC5nZXRzdGF0ZQpzZXRzdGF0ZSA9IF9pbnN0LnNldHN0YXRlCmdldHJhbmRiaXRzID0gX2luc3QuZ2V0cmFuZGJpdHMKCiNpZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgojICAgIF90ZXN0KCkKCg==',
'/Lib/reprlib.py':'IiIiUmVkbyB0aGUgYnVpbHRpbiByZXByKCkgKHJlcHJlc2VudGF0aW9uKSBidXQgd2l0aCBsaW1pdHMgb24gbW9zdCBzaXplcy4iIiIKCl9fYWxsX18gPSBbIlJlcHIiLCAicmVwciIsICJyZWN1cnNpdmVfcmVwciJdCgppbXBvcnQgYnVpbHRpbnMKZnJvbSBpdGVydG9vbHMgaW1wb3J0IGlzbGljZQp0cnk6CiAgICBmcm9tIF90aHJlYWQgaW1wb3J0IGdldF9pZGVudApleGNlcHQgSW1wb3J0RXJyb3I6CiAgICBmcm9tIF9kdW1teV90aHJlYWQgaW1wb3J0IGdldF9pZGVudAoKZGVmIHJlY3Vyc2l2ZV9yZXByKGZpbGx2YWx1ZT0nLi4uJyk6CiAgICAnRGVjb3JhdG9yIHRvIG1ha2UgYSByZXByIGZ1bmN0aW9uIHJldHVybiBmaWxsdmFsdWUgZm9yIGEgcmVjdXJzaXZlIGNhbGwnCgogICAgZGVmIGRlY29yYXRpbmdfZnVuY3Rpb24odXNlcl9mdW5jdGlvbik6CiAgICAgICAgcmVwcl9ydW5uaW5nID0gc2V0KCkKCiAgICAgICAgZGVmIHdyYXBwZXIoc2VsZik6CiAgICAgICAgICAgIGtleSA9IGlkKHNlbGYpLCBnZXRfaWRlbnQoKQogICAgICAgICAgICBpZiBrZXkgaW4gcmVwcl9ydW5uaW5nOgogICAgICAgICAgICAgICAgcmV0dXJuIGZpbGx2YWx1ZQogICAgICAgICAgICByZXByX3J1bm5pbmcuYWRkKGtleSkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gdXNlcl9mdW5jdGlvbihzZWxmKQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgcmVwcl9ydW5uaW5nLmRpc2NhcmQoa2V5KQogICAgICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgICAgICMgQ2FuJ3QgdXNlIGZ1bmN0b29scy53cmFwcygpIGhlcmUgYmVjYXVzZSBvZiBib290c3RyYXAgaXNzdWVzCiAgICAgICAgd3JhcHBlci5fX21vZHVsZV9fID0gZ2V0YXR0cih1c2VyX2Z1bmN0aW9uLCAnX19tb2R1bGVfXycpCiAgICAgICAgd3JhcHBlci5fX2RvY19fID0gZ2V0YXR0cih1c2VyX2Z1bmN0aW9uLCAnX19kb2NfXycpCiAgICAgICAgd3JhcHBlci5fX25hbWVfXyA9IGdldGF0dHIodXNlcl9mdW5jdGlvbiwgJ19fbmFtZV9fJykKICAgICAgICB3cmFwcGVyLl9fYW5ub3RhdGlvbnNfXyA9IGdldGF0dHIodXNlcl9mdW5jdGlvbiwgJ19fYW5ub3RhdGlvbnNfXycsIHt9KQogICAgICAgIHJldHVybiB3cmFwcGVyCgogICAgcmV0dXJuIGRlY29yYXRpbmdfZnVuY3Rpb24KCmNsYXNzIFJlcHI6CgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYubWF4bGV2ZWwgPSA2CiAgICAgICAgc2VsZi5tYXh0dXBsZSA9IDYKICAgICAgICBzZWxmLm1heGxpc3QgPSA2CiAgICAgICAgc2VsZi5tYXhhcnJheSA9IDUKICAgICAgICBzZWxmLm1heGRpY3QgPSA0CiAgICAgICAgc2VsZi5tYXhzZXQgPSA2CiAgICAgICAgc2VsZi5tYXhmcm96ZW5zZXQgPSA2CiAgICAgICAgc2VsZi5tYXhkZXF1ZSA9IDYKICAgICAgICBzZWxmLm1heHN0cmluZyA9IDMwCiAgICAgICAgc2VsZi5tYXhsb25nID0gNDAKICAgICAgICBzZWxmLm1heG90aGVyID0gMzAKCiAgICBkZWYgcmVwcihzZWxmLCB4KToKICAgICAgICByZXR1cm4gc2VsZi5yZXByMSh4LCBzZWxmLm1heGxldmVsKQoKICAgIGRlZiByZXByMShzZWxmLCB4LCBsZXZlbCk6CiAgICAgICAgdHlwZW5hbWUgPSB0eXBlKHgpLl9fbmFtZV9fCiAgICAgICAgaWYgJyAnIGluIHR5cGVuYW1lOgogICAgICAgICAgICBwYXJ0cyA9IHR5cGVuYW1lLnNwbGl0KCkKICAgICAgICAgICAgdHlwZW5hbWUgPSAnXycuam9pbihwYXJ0cykKICAgICAgICBpZiBoYXNhdHRyKHNlbGYsICdyZXByXycgKyB0eXBlbmFtZSk6CiAgICAgICAgICAgIHJldHVybiBnZXRhdHRyKHNlbGYsICdyZXByXycgKyB0eXBlbmFtZSkoeCwgbGV2ZWwpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYucmVwcl9pbnN0YW5jZSh4LCBsZXZlbCkKCiAgICBkZWYgX3JlcHJfaXRlcmFibGUoc2VsZiwgeCwgbGV2ZWwsIGxlZnQsIHJpZ2h0LCBtYXhpdGVyLCB0cmFpbD0nJyk6CiAgICAgICAgbiA9IGxlbih4KQogICAgICAgIGlmIGxldmVsIDw9IDAgYW5kIG46CiAgICAgICAgICAgIHMgPSAnLi4uJwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG5ld2xldmVsID0gbGV2ZWwgLSAxCiAgICAgICAgICAgIHJlcHIxID0gc2VsZi5yZXByMQogICAgICAgICAgICBwaWVjZXMgPSBbcmVwcjEoZWxlbSwgbmV3bGV2ZWwpIGZvciBlbGVtIGluIGlzbGljZSh4LCBtYXhpdGVyKV0KICAgICAgICAgICAgaWYgbiA+IG1heGl0ZXI6ICBwaWVjZXMuYXBwZW5kKCcuLi4nKQogICAgICAgICAgICBzID0gJywgJy5qb2luKHBpZWNlcykKICAgICAgICAgICAgaWYgbiA9PSAxIGFuZCB0cmFpbDogIHJpZ2h0ID0gdHJhaWwgKyByaWdodAogICAgICAgIHJldHVybiAnJXMlcyVzJyAlIChsZWZ0LCBzLCByaWdodCkKCiAgICBkZWYgcmVwcl90dXBsZShzZWxmLCB4LCBsZXZlbCk6CiAgICAgICAgcmV0dXJuIHNlbGYuX3JlcHJfaXRlcmFibGUoeCwgbGV2ZWwsICcoJywgJyknLCBzZWxmLm1heHR1cGxlLCAnLCcpCgogICAgZGVmIHJlcHJfbGlzdChzZWxmLCB4LCBsZXZlbCk6CiAgICAgICAgcmV0dXJuIHNlbGYuX3JlcHJfaXRlcmFibGUoeCwgbGV2ZWwsICdbJywgJ10nLCBzZWxmLm1heGxpc3QpCgogICAgZGVmIHJlcHJfYXJyYXkoc2VsZiwgeCwgbGV2ZWwpOgogICAgICAgIGhlYWRlciA9ICJhcnJheSgnJXMnLCBbIiAlIHgudHlwZWNvZGUKICAgICAgICByZXR1cm4gc2VsZi5fcmVwcl9pdGVyYWJsZSh4LCBsZXZlbCwgaGVhZGVyLCAnXSknLCBzZWxmLm1heGFycmF5KQoKICAgIGRlZiByZXByX3NldChzZWxmLCB4LCBsZXZlbCk6CiAgICAgICAgeCA9IF9wb3NzaWJseV9zb3J0ZWQoeCkKICAgICAgICByZXR1cm4gc2VsZi5fcmVwcl9pdGVyYWJsZSh4LCBsZXZlbCwgJ3NldChbJywgJ10pJywgc2VsZi5tYXhzZXQpCgogICAgZGVmIHJlcHJfZnJvemVuc2V0KHNlbGYsIHgsIGxldmVsKToKICAgICAgICB4ID0gX3Bvc3NpYmx5X3NvcnRlZCh4KQogICAgICAgIHJldHVybiBzZWxmLl9yZXByX2l0ZXJhYmxlKHgsIGxldmVsLCAnZnJvemVuc2V0KFsnLCAnXSknLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubWF4ZnJvemVuc2V0KQoKICAgIGRlZiByZXByX2RlcXVlKHNlbGYsIHgsIGxldmVsKToKICAgICAgICByZXR1cm4gc2VsZi5fcmVwcl9pdGVyYWJsZSh4LCBsZXZlbCwgJ2RlcXVlKFsnLCAnXSknLCBzZWxmLm1heGRlcXVlKQoKICAgIGRlZiByZXByX2RpY3Qoc2VsZiwgeCwgbGV2ZWwpOgogICAgICAgIG4gPSBsZW4oeCkKICAgICAgICBpZiBuID09IDA6IHJldHVybiAne30nCiAgICAgICAgaWYgbGV2ZWwgPD0gMDogcmV0dXJuICd7Li4ufScKICAgICAgICBuZXdsZXZlbCA9IGxldmVsIC0gMQogICAgICAgIHJlcHIxID0gc2VsZi5yZXByMQogICAgICAgIHBpZWNlcyA9IFtdCiAgICAgICAgZm9yIGtleSBpbiBpc2xpY2UoX3Bvc3NpYmx5X3NvcnRlZCh4KSwgc2VsZi5tYXhkaWN0KToKICAgICAgICAgICAga2V5cmVwciA9IHJlcHIxKGtleSwgbmV3bGV2ZWwpCiAgICAgICAgICAgIHZhbHJlcHIgPSByZXByMSh4W2tleV0sIG5ld2xldmVsKQogICAgICAgICAgICBwaWVjZXMuYXBwZW5kKCclczogJXMnICUgKGtleXJlcHIsIHZhbHJlcHIpKQogICAgICAgIGlmIG4gPiBzZWxmLm1heGRpY3Q6IHBpZWNlcy5hcHBlbmQoJy4uLicpCiAgICAgICAgcyA9ICcsICcuam9pbihwaWVjZXMpCiAgICAgICAgcmV0dXJuICd7JXN9JyAlIChzLCkKCiAgICBkZWYgcmVwcl9zdHIoc2VsZiwgeCwgbGV2ZWwpOgogICAgICAgIHMgPSBidWlsdGlucy5yZXByKHhbOnNlbGYubWF4c3RyaW5nXSkKICAgICAgICBpZiBsZW4ocykgPiBzZWxmLm1heHN0cmluZzoKICAgICAgICAgICAgaSA9IG1heCgwLCAoc2VsZi5tYXhzdHJpbmctMykvLzIpCiAgICAgICAgICAgIGogPSBtYXgoMCwgc2VsZi5tYXhzdHJpbmctMy1pKQogICAgICAgICAgICBzID0gYnVpbHRpbnMucmVwcih4WzppXSArIHhbbGVuKHgpLWo6XSkKICAgICAgICAgICAgcyA9IHNbOmldICsgJy4uLicgKyBzW2xlbihzKS1qOl0KICAgICAgICByZXR1cm4gcwoKICAgIGRlZiByZXByX2ludChzZWxmLCB4LCBsZXZlbCk6CiAgICAgICAgcyA9IGJ1aWx0aW5zLnJlcHIoeCkgIyBYWFggSG9wZSB0aGlzIGlzbid0IHRvbyBzbG93Li4uCiAgICAgICAgaWYgbGVuKHMpID4gc2VsZi5tYXhsb25nOgogICAgICAgICAgICBpID0gbWF4KDAsIChzZWxmLm1heGxvbmctMykvLzIpCiAgICAgICAgICAgIGogPSBtYXgoMCwgc2VsZi5tYXhsb25nLTMtaSkKICAgICAgICAgICAgcyA9IHNbOmldICsgJy4uLicgKyBzW2xlbihzKS1qOl0KICAgICAgICByZXR1cm4gcwoKICAgIGRlZiByZXByX2luc3RhbmNlKHNlbGYsIHgsIGxldmVsKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHMgPSBidWlsdGlucy5yZXByKHgpCiAgICAgICAgICAgICMgQnVncyBpbiB4Ll9fcmVwcl9fKCkgY2FuIGNhdXNlIGFyYml0cmFyeQogICAgICAgICAgICAjIGV4Y2VwdGlvbnMgLS0gdGhlbiBtYWtlIHVwIHNvbWV0aGluZwogICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgIHJldHVybiAnPCVzIGluc3RhbmNlIGF0ICV4PicgJSAoeC5fX2NsYXNzX18uX19uYW1lX18sIGlkKHgpKQogICAgICAgIGlmIGxlbihzKSA+IHNlbGYubWF4b3RoZXI6CiAgICAgICAgICAgIGkgPSBtYXgoMCwgKHNlbGYubWF4b3RoZXItMykvLzIpCiAgICAgICAgICAgIGogPSBtYXgoMCwgc2VsZi5tYXhvdGhlci0zLWkpCiAgICAgICAgICAgIHMgPSBzWzppXSArICcuLi4nICsgc1tsZW4ocyktajpdCiAgICAgICAgcmV0dXJuIHMKCgpkZWYgX3Bvc3NpYmx5X3NvcnRlZCh4KToKICAgICMgU2luY2Ugbm90IGFsbCBzZXF1ZW5jZXMgb2YgaXRlbXMgY2FuIGJlIHNvcnRlZCBhbmQgY29tcGFyaXNvbgogICAgIyBmdW5jdGlvbnMgbWF5IHJhaXNlIGFyYml0cmFyeSBleGNlcHRpb25zLCByZXR1cm4gYW4gdW5zb3J0ZWQKICAgICMgc2VxdWVuY2UgaW4gdGhhdCBjYXNlLgogICAgdHJ5OgogICAgICAgIHJldHVybiBzb3J0ZWQoeCkKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIGxpc3QoeCkKCmFSZXByID0gUmVwcigpCnJlcHIgPSBhUmVwci5yZXByCg==',
'/Lib/string.py':'IyBTb21lIHN0cmluZ3MgZm9yIGN0eXBlLXN0eWxlIGNoYXJhY3RlciBjbGFzc2lmaWNhdGlvbgp3aGl0ZXNwYWNlID0gJyBcdFxuXHJcdlxmJwphc2NpaV9sb3dlcmNhc2UgPSAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonCmFzY2lpX3VwcGVyY2FzZSA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWicKYXNjaWlfbGV0dGVycyA9IGFzY2lpX2xvd2VyY2FzZSArIGFzY2lpX3VwcGVyY2FzZQpkaWdpdHMgPSAnMDEyMzQ1Njc4OScKaGV4ZGlnaXRzID0gZGlnaXRzICsgJ2FiY2RlZicgKyAnQUJDREVGJwpvY3RkaWdpdHMgPSAnMDEyMzQ1NjcnCnB1bmN0dWF0aW9uID0gIiIiISIjJCUmJygpKissLS4vOjs8PT4/QFtcXV5fYHt8fX4iIiIKcHJpbnRhYmxlID0gZGlnaXRzICsgYXNjaWlfbGV0dGVycyArIHB1bmN0dWF0aW9uICsgd2hpdGVzcGFjZQoKIyBGdW5jdGlvbnMgd2hpY2ggYXJlbid0IGF2YWlsYWJsZSBhcyBzdHJpbmcgbWV0aG9kcy4KCiMgQ2FwaXRhbGl6ZSB0aGUgd29yZHMgaW4gYSBzdHJpbmcsIGUuZy4gIiBhQmMgIGRFZiAiIC0+ICJBYmMgRGVmIi4KZGVmIGNhcHdvcmRzKHMsIHNlcD1Ob25lKToKICAgICIiImNhcHdvcmRzKHMgWyxzZXBdKSAtPiBzdHJpbmcKCiAgICBTcGxpdCB0aGUgYXJndW1lbnQgaW50byB3b3JkcyB1c2luZyBzcGxpdCwgY2FwaXRhbGl6ZSBlYWNoCiAgICB3b3JkIHVzaW5nIGNhcGl0YWxpemUsIGFuZCBqb2luIHRoZSBjYXBpdGFsaXplZCB3b3JkcyB1c2luZwogICAgam9pbi4gIElmIHRoZSBvcHRpb25hbCBzZWNvbmQgYXJndW1lbnQgc2VwIGlzIGFic2VudCBvciBOb25lLAogICAgcnVucyBvZiB3aGl0ZXNwYWNlIGNoYXJhY3RlcnMgYXJlIHJlcGxhY2VkIGJ5IGEgc2luZ2xlIHNwYWNlCiAgICBhbmQgbGVhZGluZyBhbmQgdHJhaWxpbmcgd2hpdGVzcGFjZSBhcmUgcmVtb3ZlZCwgb3RoZXJ3aXNlCiAgICBzZXAgaXMgdXNlZCB0byBzcGxpdCBhbmQgam9pbiB0aGUgd29yZHMuCgogICAgIiIiCiAgICByZXR1cm4gKHNlcCBvciAnICcpLmpvaW4oeC5jYXBpdGFsaXplKCkgZm9yIHggaW4gcy5zcGxpdChzZXApKQo=',
'/Lib/sys.py':'X19zdGRvdXRfXz1nZXRhdHRyKGRvYywiJHN0ZG91dCIpCl9fc3RkZXJyX189Z2V0YXR0cihkb2MsIiRzdGRlcnIiKQoKc3Rkb3V0ID0gZ2V0YXR0cihkb2MsIiRzdGRvdXQiKQpzdGRlcnIgPSBnZXRhdHRyKGRvYywiJHN0ZGVyciIpCgptb2R1bGVzPV9fQlJZVEhPTl9fLm1vZHVsZXMKCmhhc19sb2NhbF9zdG9yYWdlPV9fQlJZVEhPTl9fLmhhc19sb2NhbF9zdG9yYWdlCmhhc19qc29uPV9fQlJZVEhPTl9fLmhhc19qc29uCnZlcnNpb25faW5mbz1fX0JSWVRIT05fXy52ZXJzaW9uX2luZm8KcGF0aD1fX0JSWVRIT05fXy5wYXRoCmJ1aWx0aW5fbW9kdWxlX25hbWVzPVsncG9zaXgnXQoKYnl0ZW9yZGVyPSdsaXR0bGUnCm1heHNpemU9OTAwNzE5OTI1NDc0MDk5MiAgICNsYXJnZXN0IGludGVnZXIuLgptYXh1bmljb2RlPTExMTQxMTEKCnBsYXRmb3JtPSJicnl0aG9uIgp3YXJub3B0aW9ucz1bXQoKY2xhc3MgZmxhZ19jbGFzczoKICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgIHNlbGYuZGVidWc9MAogICAgICBzZWxmLmluc3BlY3Q9MAogICAgICBzZWxmLmludGVyYWN0aXZlPTAKICAgICAgc2VsZi5vcHRpbWl6ZT0wCiAgICAgIHNlbGYuZG9udF93cml0ZV9ieXRlY29kZT0wCiAgICAgIHNlbGYubm9fdXNlcl9zaXRlPTAKICAgICAgc2VsZi5ub19zaXRlPTAKICAgICAgc2VsZi5pZ25vcmVfZW52aXJvbm1lbnQ9MAogICAgICBzZWxmLnZlcmJvc2U9MAogICAgICBzZWxmLmJ5dGVzX3dhcm5pbmc9MAogICAgICBzZWxmLnF1aWV0PTAKICAgICAgc2VsZi5oYXNoX3JhbmRvbWl6YXRpb249MQoKZmxhZ3M9ZmxhZ19jbGFzcygpCgo=',
'/Lib/this.py':'cyA9ICIiIkd1ciBNcmEgYnMgQ2xndWJhLCBvbCBHdnogQ3JncmVmCgpPcm5oZ3ZzaHkgdmYgb3JnZ3JlIGd1bmEgaHR5bC4KUmtjeXZwdmcgdmYgb3JnZ3JlIGd1bmEgdnpjeXZwdmcuCkZ2emN5ciB2ZiBvcmdncmUgZ3VuYSBwYnpjeXJrLgpQYnpjeXJrIHZmIG9yZ2dyZSBndW5hIHBiemN5dnBuZ3JxLgpTeW5nIHZmIG9yZ2dyZSBndW5hIGFyZmdycS4KRmNuZWZyIHZmIG9yZ2dyZSBndW5hIHFyYWZyLgpFcm5xbm92eXZnbCBwYmhhZ2YuCkZjcnB2bnkgcG5mcmYgbmVyYSdnIGZjcnB2bnkgcmFiaHR1IGdiIG9lcm54IGd1ciBlaHlyZi4KTnlndWJodHUgY2VucGd2cG55dmdsIG9ybmdmIGNoZXZnbC4KUmVlYmVmIGZ1Ymh5cSBhcmlyZSBjbmZmIGZ2eXJhZ3lsLgpIYXlyZmYgcmtjeXZwdmd5bCBmdnlyYXBycS4KVmEgZ3VyIHNucHIgYnMgbnpvdnRodmdsLCBlcnNoZnIgZ3VyIGdyemNnbmd2YmEgZ2IgdGhyZmYuCkd1cmVyIGZ1Ymh5cSBvciBiYXItLSBuYXEgY2Vyc3Jlbm95bCBiYXlsIGJhciAtLWJvaXZiaGYgam5sIGdiIHFiIHZnLgpOeWd1Ymh0dSBndW5nIGpubCB6bmwgYWJnIG9yIGJvaXZiaGYgbmcgc3ZlZmcgaGF5cmZmIGxiaCdlciBRaGdwdS4KQWJqIHZmIG9yZ2dyZSBndW5hIGFyaXJlLgpOeWd1Ymh0dSBhcmlyZSB2ZiBic2dyYSBvcmdncmUgZ3VuYSAqZXZ0dWcqIGFiai4KVnMgZ3VyIHZ6Y3lyenJhZ25ndmJhIHZmIHVuZXEgZ2IgcmtjeW52YSwgdmcnZiBuIG9ucSB2cXJuLgpWcyBndXIgdnpjeXJ6cmFnbmd2YmEgdmYgcm5mbCBnYiBya2N5bnZhLCB2ZyB6bmwgb3IgbiB0YmJxIHZxcm4uCkFuenJmY25wcmYgbmVyIGJhciB1YmF4dmF0IHRlcm5nIHZxcm4gLS0geXJnJ2YgcWIgemJlciBicyBndWJmciEiIiIKCmQgPSB7fQpmb3IgYyBpbiAoNjUsIDk3KToKICAgIGZvciBpIGluIHJhbmdlKDI2KToKICAgICAgICBkW2NocihpK2MpXSA9IGNocigoaSsxMykgJSAyNiArIGMpCgpwcmludCgiIi5qb2luKFtkLmdldChjLCBjKSBmb3IgYyBpbiBzXSkpCg==',
'/Lib/traceback.py':'aW1wb3J0IHN5cwpkZWYgcHJpbnRfZXhjKGZpbGU9c3lzLnN0ZGVycik6CiAgICBleGMgPSBfX0JSWVRIT05fXy5leGNlcHRpb25fc3RhY2tbLTFdCiAgICBmaWxlLndyaXRlKGV4Yy5pbmZvKQogICAgZmlsZS53cml0ZSgnXG4nK2V4Yy5fX25hbWVfXykKICAgIGlmIGV4Yy5tZXNzYWdlOgogICAgICAgIGZpbGUud3JpdGUoJzogJytleGMubWVzc2FnZSkKICAgIGZpbGUud3JpdGUoJ1xuJykK',
'/Lib/types.py':'IiIiCkRlZmluZSBuYW1lcyBmb3IgYnVpbHQtaW4gdHlwZXMgdGhhdCBhcmVuJ3QgZGlyZWN0bHkgYWNjZXNzaWJsZSBhcyBhIGJ1aWx0aW4uCiIiIgppbXBvcnQgc3lzCgojIEl0ZXJhdG9ycyBpbiBQeXRob24gYXJlbid0IGEgbWF0dGVyIG9mIHR5cGUgYnV0IG9mIHByb3RvY29sLiAgQSBsYXJnZQojIGFuZCBjaGFuZ2luZyBudW1iZXIgb2YgYnVpbHRpbiB0eXBlcyBpbXBsZW1lbnQgKnNvbWUqIGZsYXZvciBvZgojIGl0ZXJhdG9yLiAgRG9uJ3QgY2hlY2sgdGhlIHR5cGUhICBVc2UgaGFzYXR0ciB0byBjaGVjayBmb3IgYm90aAojICJfX2l0ZXJfXyIgYW5kICJfX25leHRfXyIgYXR0cmlidXRlcyBpbnN0ZWFkLgoKI2RlZiBfZigpOiBwYXNzCiNGdW5jdGlvblR5cGUgPSB0eXBlKF9mKQojTGFtYmRhVHlwZSA9IHR5cGUobGFtYmRhOiBOb25lKSAgICAgICAgICMgU2FtZSBhcyBGdW5jdGlvblR5cGUKI0NvZGVUeXBlID0gdHlwZShfZi5fX2NvZGVfXykKCiNkZWYgX2coKToKIyAgICB5aWVsZCAxCiNHZW5lcmF0b3JUeXBlID0gdHlwZShfZygpKQoKY2xhc3MgX0M6CiAgICBkZWYgX20oc2VsZik6IHBhc3MKTWV0aG9kVHlwZSA9IHR5cGUoX0MoKS5fbSkKCkJ1aWx0aW5GdW5jdGlvblR5cGUgPSB0eXBlKGxlbikKQnVpbHRpbk1ldGhvZFR5cGUgPSB0eXBlKFtdLmFwcGVuZCkgICAgICMgU2FtZSBhcyBCdWlsdGluRnVuY3Rpb25UeXBlCgpNb2R1bGVUeXBlID0gdHlwZShzeXMpCgojdHJ5OgojICAgIHJhaXNlIFR5cGVFcnJvcgojZXhjZXB0IFR5cGVFcnJvcjoKIyAgICB0YiA9IHN5cy5leGNfaW5mbygpWzJdCiMgICAgVHJhY2ViYWNrVHlwZSA9IHR5cGUodGIpCiMgICAgRnJhbWVUeXBlID0gdHlwZSh0Yi50Yl9mcmFtZSkKIyAgICB0YiA9IE5vbmU7IGRlbCB0YgoKIyBGb3IgSnl0aG9uLCB0aGUgZm9sbG93aW5nIHR3byB0eXBlcyBhcmUgaWRlbnRpY2FsCiNHZXRTZXREZXNjcmlwdG9yVHlwZSA9IHR5cGUoRnVuY3Rpb25UeXBlLl9fY29kZV9fKQojTWVtYmVyRGVzY3JpcHRvclR5cGUgPSB0eXBlKEZ1bmN0aW9uVHlwZS5fX2dsb2JhbHNfXykKCiNmaXhtZSBicnl0aG9uCiNkZWwgc3lzLCBfZiwgX2csIF9DLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgTm90IGZvciBleHBvcnQK',
'/Lib/warnings.py':'IiIiUHl0aG9uIHBhcnQgb2YgdGhlIHdhcm5pbmdzIHN1YnN5c3RlbS4iIiIKCiMgTm90ZTogZnVuY3Rpb24gbGV2ZWwgaW1wb3J0cyBzaG91bGQgKm5vdCogYmUgdXNlZAojIGluIHRoaXMgbW9kdWxlIGFzIGl0IG1heSBjYXVzZSBpbXBvcnQgbG9jayBkZWFkbG9jay4KIyBTZWUgYnVnIDY4MzY1OC4KaW1wb3J0IGxpbmVjYWNoZQppbXBvcnQgc3lzCgpfX2FsbF9fID0gWyJ3YXJuIiwgInNob3d3YXJuaW5nIiwgImZvcm1hdHdhcm5pbmciLCAiZmlsdGVyd2FybmluZ3MiLAogICAgICAgICAgICJyZXNldHdhcm5pbmdzIiwgImNhdGNoX3dhcm5pbmdzIl0KCgpkZWYgc2hvd3dhcm5pbmcobWVzc2FnZSwgY2F0ZWdvcnksIGZpbGVuYW1lLCBsaW5lbm8sIGZpbGU9Tm9uZSwgbGluZT1Ob25lKToKICAgICIiIkhvb2sgdG8gd3JpdGUgYSB3YXJuaW5nIHRvIGEgZmlsZTsgcmVwbGFjZSBpZiB5b3UgbGlrZS4iIiIKICAgIGlmIGZpbGUgaXMgTm9uZToKICAgICAgICBmaWxlID0gc3lzLnN0ZGVycgogICAgdHJ5OgogICAgICAgIGZpbGUud3JpdGUoZm9ybWF0d2FybmluZyhtZXNzYWdlLCBjYXRlZ29yeSwgZmlsZW5hbWUsIGxpbmVubywgbGluZSkpCiAgICBleGNlcHQgSU9FcnJvcjoKICAgICAgICBwYXNzICMgdGhlIGZpbGUgKHByb2JhYmx5IHN0ZGVycikgaXMgaW52YWxpZCAtIHRoaXMgd2FybmluZyBnZXRzIGxvc3QuCgpkZWYgZm9ybWF0d2FybmluZyhtZXNzYWdlLCBjYXRlZ29yeSwgZmlsZW5hbWUsIGxpbmVubywgbGluZT1Ob25lKToKICAgICIiIkZ1bmN0aW9uIHRvIGZvcm1hdCBhIHdhcm5pbmcgdGhlIHN0YW5kYXJkIHdheS4iIiIKICAgIHMgPSAgIiVzOiVzOiAlczogJXNcbiIgJSAoZmlsZW5hbWUsIGxpbmVubywgY2F0ZWdvcnkuX19uYW1lX18sIG1lc3NhZ2UpCiAgICBsaW5lID0gbGluZWNhY2hlLmdldGxpbmUoZmlsZW5hbWUsIGxpbmVubykgaWYgbGluZSBpcyBOb25lIGVsc2UgbGluZQogICAgaWYgbGluZToKICAgICAgICBsaW5lID0gbGluZS5zdHJpcCgpCiAgICAgICAgcyArPSAiICAlc1xuIiAlIGxpbmUKICAgIHJldHVybiBzCgojZml4bWUgYnJ5dGhvbiAgYnVpbHRpbiBXYXJuaW5nIGNsYXNzIG5vdCBkZWZpbmVkCmRlZiBmaWx0ZXJ3YXJuaW5ncyhhY3Rpb24sIG1lc3NhZ2U9IiIsIGNhdGVnb3J5PVdhcm5pbmcsIG1vZHVsZT0iIiwgbGluZW5vPTAsCiAgICAgICAgICAgICAgICAgICBhcHBlbmQ9RmFsc2UpOgogICAgIiIiSW5zZXJ0IGFuIGVudHJ5IGludG8gdGhlIGxpc3Qgb2Ygd2FybmluZ3MgZmlsdGVycyAoYXQgdGhlIGZyb250KS4KCiAgICAnYWN0aW9uJyAtLSBvbmUgb2YgImVycm9yIiwgImlnbm9yZSIsICJhbHdheXMiLCAiZGVmYXVsdCIsICJtb2R1bGUiLAogICAgICAgICAgICAgICAgb3IgIm9uY2UiCiAgICAnbWVzc2FnZScgLS0gYSByZWdleCB0aGF0IHRoZSB3YXJuaW5nIG1lc3NhZ2UgbXVzdCBtYXRjaAogICAgJ2NhdGVnb3J5JyAtLSBhIGNsYXNzIHRoYXQgdGhlIHdhcm5pbmcgbXVzdCBiZSBhIHN1YmNsYXNzIG9mCiAgICAnbW9kdWxlJyAtLSBhIHJlZ2V4IHRoYXQgdGhlIG1vZHVsZSBuYW1lIG11c3QgbWF0Y2gKICAgICdsaW5lbm8nIC0tIGFuIGludGVnZXIgbGluZSBudW1iZXIsIDAgbWF0Y2hlcyBhbGwgd2FybmluZ3MKICAgICdhcHBlbmQnIC0tIGlmIHRydWUsIGFwcGVuZCB0byB0aGUgbGlzdCBvZiBmaWx0ZXJzCiAgICAiIiIKICAgIGltcG9ydCByZQogICAgYXNzZXJ0IGFjdGlvbiBpbiAoImVycm9yIiwgImlnbm9yZSIsICJhbHdheXMiLCAiZGVmYXVsdCIsICJtb2R1bGUiLAogICAgICAgICAgICAgICAgICAgICAgIm9uY2UiKSwgImludmFsaWQgYWN0aW9uOiAlciIgJSAoYWN0aW9uLCkKICAgIGFzc2VydCBpc2luc3RhbmNlKG1lc3NhZ2UsIHN0ciksICJtZXNzYWdlIG11c3QgYmUgYSBzdHJpbmciCiAgICBhc3NlcnQgaXNpbnN0YW5jZShjYXRlZ29yeSwgdHlwZSksICJjYXRlZ29yeSBtdXN0IGJlIGEgY2xhc3MiCiAgICBhc3NlcnQgaXNzdWJjbGFzcyhjYXRlZ29yeSwgV2FybmluZyksICJjYXRlZ29yeSBtdXN0IGJlIGEgV2FybmluZyBzdWJjbGFzcyIKICAgIGFzc2VydCBpc2luc3RhbmNlKG1vZHVsZSwgc3RyKSwgIm1vZHVsZSBtdXN0IGJlIGEgc3RyaW5nIgogICAgYXNzZXJ0IGlzaW5zdGFuY2UobGluZW5vLCBpbnQpIGFuZCBsaW5lbm8gPj0gMCwgXAogICAgICAgICAgICJsaW5lbm8gbXVzdCBiZSBhbiBpbnQgPj0gMCIKICAgIGl0ZW0gPSAoYWN0aW9uLCByZS5jb21waWxlKG1lc3NhZ2UsIHJlLkkpLCBjYXRlZ29yeSwKICAgICAgICAgICAgcmUuY29tcGlsZShtb2R1bGUpLCBsaW5lbm8pCiAgICBpZiBhcHBlbmQ6CiAgICAgICAgZmlsdGVycy5hcHBlbmQoaXRlbSkKICAgIGVsc2U6CiAgICAgICAgZmlsdGVycy5pbnNlcnQoMCwgaXRlbSkKCmRlZiBzaW1wbGVmaWx0ZXIoYWN0aW9uLCBjYXRlZ29yeT1XYXJuaW5nLCBsaW5lbm89MCwgYXBwZW5kPUZhbHNlKToKICAgICIiIkluc2VydCBhIHNpbXBsZSBlbnRyeSBpbnRvIHRoZSBsaXN0IG9mIHdhcm5pbmdzIGZpbHRlcnMgKGF0IHRoZSBmcm9udCkuCgogICAgQSBzaW1wbGUgZmlsdGVyIG1hdGNoZXMgYWxsIG1vZHVsZXMgYW5kIG1lc3NhZ2VzLgogICAgJ2FjdGlvbicgLS0gb25lIG9mICJlcnJvciIsICJpZ25vcmUiLCAiYWx3YXlzIiwgImRlZmF1bHQiLCAibW9kdWxlIiwKICAgICAgICAgICAgICAgIG9yICJvbmNlIgogICAgJ2NhdGVnb3J5JyAtLSBhIGNsYXNzIHRoYXQgdGhlIHdhcm5pbmcgbXVzdCBiZSBhIHN1YmNsYXNzIG9mCiAgICAnbGluZW5vJyAtLSBhbiBpbnRlZ2VyIGxpbmUgbnVtYmVyLCAwIG1hdGNoZXMgYWxsIHdhcm5pbmdzCiAgICAnYXBwZW5kJyAtLSBpZiB0cnVlLCBhcHBlbmQgdG8gdGhlIGxpc3Qgb2YgZmlsdGVycwogICAgIiIiCiAgICBhc3NlcnQgYWN0aW9uIGluICgiZXJyb3IiLCAiaWdub3JlIiwgImFsd2F5cyIsICJkZWZhdWx0IiwgIm1vZHVsZSIsCiAgICAgICAgICAgICAgICAgICAgICAib25jZSIpLCAiaW52YWxpZCBhY3Rpb246ICVyIiAlIChhY3Rpb24sKQogICAgYXNzZXJ0IGlzaW5zdGFuY2UobGluZW5vLCBpbnQpIGFuZCBsaW5lbm8gPj0gMCwgXAogICAgICAgICAgICJsaW5lbm8gbXVzdCBiZSBhbiBpbnQgPj0gMCIKICAgIGl0ZW0gPSAoYWN0aW9uLCBOb25lLCBjYXRlZ29yeSwgTm9uZSwgbGluZW5vKQogICAgaWYgYXBwZW5kOgogICAgICAgIGZpbHRlcnMuYXBwZW5kKGl0ZW0pCiAgICBlbHNlOgogICAgICAgIGZpbHRlcnMuaW5zZXJ0KDAsIGl0ZW0pCgpkZWYgcmVzZXR3YXJuaW5ncygpOgogICAgIiIiQ2xlYXIgdGhlIGxpc3Qgb2Ygd2FybmluZyBmaWx0ZXJzLCBzbyB0aGF0IG5vIGZpbHRlcnMgYXJlIGFjdGl2ZS4iIiIKICAgIGZpbHRlcnNbOl0gPSBbXQoKY2xhc3MgX09wdGlvbkVycm9yKEV4Y2VwdGlvbik6CiAgICAiIiJFeGNlcHRpb24gdXNlZCBieSBvcHRpb24gcHJvY2Vzc2luZyBoZWxwZXJzLiIiIgogICAgcGFzcwoKIyBIZWxwZXIgdG8gcHJvY2VzcyAtVyBvcHRpb25zIHBhc3NlZCB2aWEgc3lzLndhcm5vcHRpb25zCmRlZiBfcHJvY2Vzc29wdGlvbnMoYXJncyk6CiAgICBmb3IgYXJnIGluIGFyZ3M6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBfc2V0b3B0aW9uKGFyZykKICAgICAgICBleGNlcHQgX09wdGlvbkVycm9yIGFzIG1zZzoKICAgICAgICAgICAgcHJpbnQoIkludmFsaWQgLVcgb3B0aW9uIGlnbm9yZWQ6IiwgbXNnLCBmaWxlPXN5cy5zdGRlcnIpCgojIEhlbHBlciBmb3IgX3Byb2Nlc3NvcHRpb25zKCkKZGVmIF9zZXRvcHRpb24oYXJnKToKICAgIGltcG9ydCByZQogICAgcGFydHMgPSBhcmcuc3BsaXQoJzonKQogICAgaWYgbGVuKHBhcnRzKSA+IDU6CiAgICAgICAgcmFpc2UgX09wdGlvbkVycm9yKCJ0b28gbWFueSBmaWVsZHMgKG1heCA1KTogJXIiICUgKGFyZywpKQogICAgd2hpbGUgbGVuKHBhcnRzKSA8IDU6CiAgICAgICAgcGFydHMuYXBwZW5kKCcnKQogICAgYWN0aW9uLCBtZXNzYWdlLCBjYXRlZ29yeSwgbW9kdWxlLCBsaW5lbm8gPSBbcy5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgcyBpbiBwYXJ0c10KICAgIGFjdGlvbiA9IF9nZXRhY3Rpb24oYWN0aW9uKQogICAgbWVzc2FnZSA9IHJlLmVzY2FwZShtZXNzYWdlKQogICAgY2F0ZWdvcnkgPSBfZ2V0Y2F0ZWdvcnkoY2F0ZWdvcnkpCiAgICBtb2R1bGUgPSByZS5lc2NhcGUobW9kdWxlKQogICAgaWYgbW9kdWxlOgogICAgICAgIG1vZHVsZSA9IG1vZHVsZSArICckJwogICAgaWYgbGluZW5vOgogICAgICAgIHRyeToKICAgICAgICAgICAgbGluZW5vID0gaW50KGxpbmVubykKICAgICAgICAgICAgaWYgbGluZW5vIDwgMDoKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IKICAgICAgICBleGNlcHQgKFZhbHVlRXJyb3IsIE92ZXJmbG93RXJyb3IpOgogICAgICAgICAgICByYWlzZSBfT3B0aW9uRXJyb3IoImludmFsaWQgbGluZW5vICVyIiAlIChsaW5lbm8sKSkKICAgIGVsc2U6CiAgICAgICAgbGluZW5vID0gMAogICAgZmlsdGVyd2FybmluZ3MoYWN0aW9uLCBtZXNzYWdlLCBjYXRlZ29yeSwgbW9kdWxlLCBsaW5lbm8pCgojIEhlbHBlciBmb3IgX3NldG9wdGlvbigpCmRlZiBfZ2V0YWN0aW9uKGFjdGlvbik6CiAgICBpZiBub3QgYWN0aW9uOgogICAgICAgIHJldHVybiAiZGVmYXVsdCIKICAgIGlmIGFjdGlvbiA9PSAiYWxsIjogcmV0dXJuICJhbHdheXMiICMgQWxpYXMKICAgIGZvciBhIGluICgnZGVmYXVsdCcsICdhbHdheXMnLCAnaWdub3JlJywgJ21vZHVsZScsICdvbmNlJywgJ2Vycm9yJyk6CiAgICAgICAgaWYgYS5zdGFydHN3aXRoKGFjdGlvbik6CiAgICAgICAgICAgIHJldHVybiBhCiAgICByYWlzZSBfT3B0aW9uRXJyb3IoImludmFsaWQgYWN0aW9uOiAlciIgJSAoYWN0aW9uLCkpCgojIEhlbHBlciBmb3IgX3NldG9wdGlvbigpCmRlZiBfZ2V0Y2F0ZWdvcnkoY2F0ZWdvcnkpOgogICAgaW1wb3J0IHJlCiAgICBpZiBub3QgY2F0ZWdvcnk6CiAgICAgICAgcmV0dXJuIFdhcm5pbmcKICAgIGlmIHJlLm1hdGNoKCJeW2EtekEtWjAtOV9dKyQiLCBjYXRlZ29yeSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBjYXQgPSBldmFsKGNhdGVnb3J5KQogICAgICAgIGV4Y2VwdCBOYW1lRXJyb3I6CiAgICAgICAgICAgIHJhaXNlIF9PcHRpb25FcnJvcigidW5rbm93biB3YXJuaW5nIGNhdGVnb3J5OiAlciIgJSAoY2F0ZWdvcnksKSkKICAgIGVsc2U6CiAgICAgICAgaSA9IGNhdGVnb3J5LnJmaW5kKCIuIikKICAgICAgICBtb2R1bGUgPSBjYXRlZ29yeVs6aV0KICAgICAgICBrbGFzcyA9IGNhdGVnb3J5W2krMTpdCiAgICAgICAgdHJ5OgogICAgICAgICAgICBtID0gX19pbXBvcnRfXyhtb2R1bGUsIE5vbmUsIE5vbmUsIFtrbGFzc10pCiAgICAgICAgZXhjZXB0IEltcG9ydEVycm9yOgogICAgICAgICAgICByYWlzZSBfT3B0aW9uRXJyb3IoImludmFsaWQgbW9kdWxlIG5hbWU6ICVyIiAlIChtb2R1bGUsKSkKICAgICAgICB0cnk6CiAgICAgICAgICAgIGNhdCA9IGdldGF0dHIobSwga2xhc3MpCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICByYWlzZSBfT3B0aW9uRXJyb3IoInVua25vd24gd2FybmluZyBjYXRlZ29yeTogJXIiICUgKGNhdGVnb3J5LCkpCiAgICBpZiBub3QgaXNzdWJjbGFzcyhjYXQsIFdhcm5pbmcpOgogICAgICAgIHJhaXNlIF9PcHRpb25FcnJvcigiaW52YWxpZCB3YXJuaW5nIGNhdGVnb3J5OiAlciIgJSAoY2F0ZWdvcnksKSkKICAgIHJldHVybiBjYXQKCgojIENvZGUgdHlwaWNhbGx5IHJlcGxhY2VkIGJ5IF93YXJuaW5ncwpkZWYgd2FybihtZXNzYWdlLCBjYXRlZ29yeT1Ob25lLCBzdGFja2xldmVsPTEpOgogICAgIiIiSXNzdWUgYSB3YXJuaW5nLCBvciBtYXliZSBpZ25vcmUgaXQgb3IgcmFpc2UgYW4gZXhjZXB0aW9uLiIiIgogICAgIyBDaGVjayBpZiBtZXNzYWdlIGlzIGFscmVhZHkgYSBXYXJuaW5nIG9iamVjdAogICAgaWYgaXNpbnN0YW5jZShtZXNzYWdlLCBXYXJuaW5nKToKICAgICAgICBjYXRlZ29yeSA9IG1lc3NhZ2UuX19jbGFzc19fCiAgICAjIENoZWNrIGNhdGVnb3J5IGFyZ3VtZW50CiAgICBpZiBjYXRlZ29yeSBpcyBOb25lOgogICAgICAgIGNhdGVnb3J5ID0gVXNlcldhcm5pbmcKICAgIGFzc2VydCBpc3N1YmNsYXNzKGNhdGVnb3J5LCBXYXJuaW5nKQogICAgIyBHZXQgY29udGV4dCBpbmZvcm1hdGlvbgogICAgdHJ5OgogICAgICAgIGNhbGxlciA9IHN5cy5fZ2V0ZnJhbWUoc3RhY2tsZXZlbCkKICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgIGdsb2JhbHMgPSBzeXMuX19kaWN0X18KICAgICAgICBsaW5lbm8gPSAxCiAgICAgICAgY2FsbGVyPU5vbmUKICAgICNmaXhtZSBicnl0aG9uIGVycm9yCiAgICBlbHNlOgogICAgICAgICNpZiBjYWxsZXIgaXMgbm90IE5vbmU6CiAgICAgICAgZ2xvYmFscyA9IGNhbGxlci5mX2dsb2JhbHMKICAgICAgICBsaW5lbm8gPSBjYWxsZXIuZl9saW5lbm8KICAgIGlmICdfX25hbWVfXycgaW4gZ2xvYmFsczoKICAgICAgICBtb2R1bGUgPSBnbG9iYWxzWydfX25hbWVfXyddCiAgICBlbHNlOgogICAgICAgIG1vZHVsZSA9ICI8c3RyaW5nPiIKICAgIGZpbGVuYW1lID0gZ2xvYmFscy5nZXQoJ19fZmlsZV9fJykKICAgIGlmIGZpbGVuYW1lOgogICAgICAgIGZubCA9IGZpbGVuYW1lLmxvd2VyKCkKICAgICAgICBpZiBmbmwuZW5kc3dpdGgoKCIucHljIiwgIi5weW8iKSk6CiAgICAgICAgICAgIGZpbGVuYW1lID0gZmlsZW5hbWVbOi0xXQogICAgZWxzZToKICAgICAgICBpZiBtb2R1bGUgPT0gIl9fbWFpbl9fIjoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZmlsZW5hbWUgPSBzeXMuYXJndlswXQogICAgICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgICAgICAjIGVtYmVkZGVkIGludGVycHJldGVycyBkb24ndCBoYXZlIHN5cy5hcmd2LCBzZWUgYnVnICM4MzkxNTEKICAgICAgICAgICAgICAgIGZpbGVuYW1lID0gJ19fbWFpbl9fJwogICAgICAgIGlmIG5vdCBmaWxlbmFtZToKICAgICAgICAgICAgZmlsZW5hbWUgPSBtb2R1bGUKICAgIHJlZ2lzdHJ5ID0gZ2xvYmFscy5zZXRkZWZhdWx0KCJfX3dhcm5pbmdyZWdpc3RyeV9fIiwge30pCiAgICB3YXJuX2V4cGxpY2l0KG1lc3NhZ2UsIGNhdGVnb3J5LCBmaWxlbmFtZSwgbGluZW5vLCBtb2R1bGUsIHJlZ2lzdHJ5LAogICAgICAgICAgICAgICAgICBnbG9iYWxzKQoKZGVmIHdhcm5fZXhwbGljaXQobWVzc2FnZSwgY2F0ZWdvcnksIGZpbGVuYW1lLCBsaW5lbm8sCiAgICAgICAgICAgICAgICAgIG1vZHVsZT1Ob25lLCByZWdpc3RyeT1Ob25lLCBtb2R1bGVfZ2xvYmFscz1Ob25lKToKICAgIGxpbmVubyA9IGludChsaW5lbm8pCiAgICBpZiBtb2R1bGUgaXMgTm9uZToKICAgICAgICBtb2R1bGUgPSBmaWxlbmFtZSBvciAiPHVua25vd24+IgogICAgICAgIGlmIG1vZHVsZVstMzpdLmxvd2VyKCkgPT0gIi5weSI6CiAgICAgICAgICAgIG1vZHVsZSA9IG1vZHVsZVs6LTNdICMgWFhYIFdoYXQgYWJvdXQgbGVhZGluZyBwYXRobmFtZT8KICAgIGlmIHJlZ2lzdHJ5IGlzIE5vbmU6CiAgICAgICAgcmVnaXN0cnkgPSB7fQogICAgaWYgaXNpbnN0YW5jZShtZXNzYWdlLCBXYXJuaW5nKToKICAgICAgICB0ZXh0ID0gc3RyKG1lc3NhZ2UpCiAgICAgICAgY2F0ZWdvcnkgPSBtZXNzYWdlLl9fY2xhc3NfXwogICAgZWxzZToKICAgICAgICB0ZXh0ID0gbWVzc2FnZQogICAgICAgIG1lc3NhZ2UgPSBjYXRlZ29yeShtZXNzYWdlKQogICAga2V5ID0gKHRleHQsIGNhdGVnb3J5LCBsaW5lbm8pCiAgICAjIFF1aWNrIHRlc3QgZm9yIGNvbW1vbiBjYXNlCiAgICBpZiByZWdpc3RyeS5nZXQoa2V5KToKICAgICAgICByZXR1cm4KICAgICMgU2VhcmNoIHRoZSBmaWx0ZXJzCiAgICBmb3IgaXRlbSBpbiBmaWx0ZXJzOgogICAgICAgIGFjdGlvbiwgbXNnLCBjYXQsIG1vZCwgbG4gPSBpdGVtCiAgICAgICAgaWYgKChtc2cgaXMgTm9uZSBvciBtc2cubWF0Y2godGV4dCkpIGFuZAogICAgICAgICAgICBpc3N1YmNsYXNzKGNhdGVnb3J5LCBjYXQpIGFuZAogICAgICAgICAgICAobW9kIGlzIE5vbmUgb3IgbW9kLm1hdGNoKG1vZHVsZSkpIGFuZAogICAgICAgICAgICAobG4gPT0gMCBvciBsaW5lbm8gPT0gbG4pKToKICAgICAgICAgICAgYnJlYWsKICAgICNmaXhtZSBicnl0aG9uCiAgICAjZWxzZToKICAgICMgICAgYWN0aW9uID0gZGVmYXVsdGFjdGlvbgogICAgIyBFYXJseSBleGl0IGFjdGlvbnMKICAgIGlmIGFjdGlvbiA9PSAiaWdub3JlIjoKICAgICAgICByZWdpc3RyeVtrZXldID0gMQogICAgICAgIHJldHVybgoKICAgICMgUHJpbWUgdGhlIGxpbmVjYWNoZSBmb3IgZm9ybWF0dGluZywgaW4gY2FzZSB0aGUKICAgICMgImZpbGUiIGlzIGFjdHVhbGx5IGluIGEgemlwZmlsZSBvciBzb21ldGhpbmcuCiAgICBsaW5lY2FjaGUuZ2V0bGluZXMoZmlsZW5hbWUsIG1vZHVsZV9nbG9iYWxzKQoKICAgIGlmIGFjdGlvbiA9PSAiZXJyb3IiOgogICAgICAgIHJhaXNlIG1lc3NhZ2UKICAgICMgT3RoZXIgYWN0aW9ucwogICAgaWYgYWN0aW9uID09ICJvbmNlIjoKICAgICAgICByZWdpc3RyeVtrZXldID0gMQogICAgICAgIG9uY2VrZXkgPSAodGV4dCwgY2F0ZWdvcnkpCiAgICAgICAgaWYgb25jZXJlZ2lzdHJ5LmdldChvbmNla2V5KToKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgb25jZXJlZ2lzdHJ5W29uY2VrZXldID0gMQogICAgZWxpZiBhY3Rpb24gPT0gImFsd2F5cyI6CiAgICAgICAgcGFzcwogICAgZWxpZiBhY3Rpb24gPT0gIm1vZHVsZSI6CiAgICAgICAgcmVnaXN0cnlba2V5XSA9IDEKICAgICAgICBhbHRrZXkgPSAodGV4dCwgY2F0ZWdvcnksIDApCiAgICAgICAgaWYgcmVnaXN0cnkuZ2V0KGFsdGtleSk6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIHJlZ2lzdHJ5W2FsdGtleV0gPSAxCiAgICBlbGlmIGFjdGlvbiA9PSAiZGVmYXVsdCI6CiAgICAgICAgcmVnaXN0cnlba2V5XSA9IDEKICAgIGVsc2U6CiAgICAgICAgIyBVbnJlY29nbml6ZWQgYWN0aW9ucyBhcmUgZXJyb3JzCiAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKAogICAgICAgICAgICAgICJVbnJlY29nbml6ZWQgYWN0aW9uICglcikgaW4gd2FybmluZ3MuZmlsdGVyczpcbiAlcyIgJQogICAgICAgICAgICAgIChhY3Rpb24sIGl0ZW0pKQogICAgaWYgbm90IGNhbGxhYmxlKHNob3d3YXJuaW5nKToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoIndhcm5pbmdzLnNob3d3YXJuaW5nKCkgbXVzdCBiZSBzZXQgdG8gYSAiCiAgICAgICAgICAgICAgICAgICAgICAgICJmdW5jdGlvbiBvciBtZXRob2QiKQogICAgIyBQcmludCBtZXNzYWdlIGFuZCBjb250ZXh0CiAgICBzaG93d2FybmluZyhtZXNzYWdlLCBjYXRlZ29yeSwgZmlsZW5hbWUsIGxpbmVubykKCgpjbGFzcyBXYXJuaW5nTWVzc2FnZShvYmplY3QpOgoKICAgICIiIkhvbGRzIHRoZSByZXN1bHQgb2YgYSBzaW5nbGUgc2hvd3dhcm5pbmcoKSBjYWxsLiIiIgoKICAgIF9XQVJOSU5HX0RFVEFJTFMgPSAoIm1lc3NhZ2UiLCAiY2F0ZWdvcnkiLCAiZmlsZW5hbWUiLCAibGluZW5vIiwgImZpbGUiLAogICAgICAgICAgICAgICAgICAgICAgICAibGluZSIpCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG1lc3NhZ2UsIGNhdGVnb3J5LCBmaWxlbmFtZSwgbGluZW5vLCBmaWxlPU5vbmUsCiAgICAgICAgICAgICAgICAgICAgbGluZT1Ob25lKToKICAgICAgICBsb2NhbF92YWx1ZXMgPSBsb2NhbHMoKQogICAgICAgIGZvciBhdHRyIGluIHNlbGYuX1dBUk5JTkdfREVUQUlMUzoKICAgICAgICAgICAgc2V0YXR0cihzZWxmLCBhdHRyLCBsb2NhbF92YWx1ZXNbYXR0cl0pCiAgICAgICAgc2VsZi5fY2F0ZWdvcnlfbmFtZSA9IGNhdGVnb3J5Ll9fbmFtZV9fIGlmIGNhdGVnb3J5IGVsc2UgTm9uZQoKICAgIGRlZiBfX3N0cl9fKHNlbGYpOgogICAgICAgIHJldHVybiAoInttZXNzYWdlIDogJXIsIGNhdGVnb3J5IDogJXIsIGZpbGVuYW1lIDogJXIsIGxpbmVubyA6ICVzLCAiCiAgICAgICAgICAgICAgICAgICAgImxpbmUgOiAlcn0iICUgKHNlbGYubWVzc2FnZSwgc2VsZi5fY2F0ZWdvcnlfbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5maWxlbmFtZSwgc2VsZi5saW5lbm8sIHNlbGYubGluZSkpCgoKY2xhc3MgY2F0Y2hfd2FybmluZ3Mob2JqZWN0KToKCiAgICAiIiJBIGNvbnRleHQgbWFuYWdlciB0aGF0IGNvcGllcyBhbmQgcmVzdG9yZXMgdGhlIHdhcm5pbmdzIGZpbHRlciB1cG9uCiAgICBleGl0aW5nIHRoZSBjb250ZXh0LgoKICAgIFRoZSAncmVjb3JkJyBhcmd1bWVudCBzcGVjaWZpZXMgd2hldGhlciB3YXJuaW5ncyBzaG91bGQgYmUgY2FwdHVyZWQgYnkgYQogICAgY3VzdG9tIGltcGxlbWVudGF0aW9uIG9mIHdhcm5pbmdzLnNob3d3YXJuaW5nKCkgYW5kIGJlIGFwcGVuZGVkIHRvIGEgbGlzdAogICAgcmV0dXJuZWQgYnkgdGhlIGNvbnRleHQgbWFuYWdlci4gT3RoZXJ3aXNlIE5vbmUgaXMgcmV0dXJuZWQgYnkgdGhlIGNvbnRleHQKICAgIG1hbmFnZXIuIFRoZSBvYmplY3RzIGFwcGVuZGVkIHRvIHRoZSBsaXN0IGFyZSBhcmd1bWVudHMgd2hvc2UgYXR0cmlidXRlcwogICAgbWlycm9yIHRoZSBhcmd1bWVudHMgdG8gc2hvd3dhcm5pbmcoKS4KCiAgICBUaGUgJ21vZHVsZScgYXJndW1lbnQgaXMgdG8gc3BlY2lmeSBhbiBhbHRlcm5hdGl2ZSBtb2R1bGUgdG8gdGhlIG1vZHVsZQogICAgbmFtZWQgJ3dhcm5pbmdzJyBhbmQgaW1wb3J0ZWQgdW5kZXIgdGhhdCBuYW1lLiBUaGlzIGFyZ3VtZW50IGlzIG9ubHkgdXNlZnVsCiAgICB3aGVuIHRlc3RpbmcgdGhlIHdhcm5pbmdzIG1vZHVsZSBpdHNlbGYuCgogICAgIiIiCgogICAgI2RlZiBfX2luaXRfXyhzZWxmLCAqLCByZWNvcmQ9RmFsc2UsIG1vZHVsZT1Ob25lKTogIEJFIG1vZGlmaWVkCiAgICBkZWYgX19pbml0X18oc2VsZiwgcmVjb3JkPUZhbHNlLCBtb2R1bGU9Tm9uZSk6CiAgICAgICAgIiIiU3BlY2lmeSB3aGV0aGVyIHRvIHJlY29yZCB3YXJuaW5ncyBhbmQgaWYgYW4gYWx0ZXJuYXRpdmUgbW9kdWxlCiAgICAgICAgc2hvdWxkIGJlIHVzZWQgb3RoZXIgdGhhbiBzeXMubW9kdWxlc1snd2FybmluZ3MnXS4KCiAgICAgICAgRm9yIGNvbXBhdGliaWxpdHkgd2l0aCBQeXRob24gMy4wLCBwbGVhc2UgY29uc2lkZXIgYWxsIGFyZ3VtZW50cyB0byBiZQogICAgICAgIGtleXdvcmQtb25seS4KCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fcmVjb3JkID0gcmVjb3JkCiAgICAgICAgc2VsZi5fbW9kdWxlID0gc3lzLm1vZHVsZXNbJ3dhcm5pbmdzJ10gaWYgbW9kdWxlIGlzIE5vbmUgZWxzZSBtb2R1bGUKICAgICAgICBzZWxmLl9lbnRlcmVkID0gRmFsc2UKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgYXJncyA9IFtdCiAgICAgICAgaWYgc2VsZi5fcmVjb3JkOgogICAgICAgICAgICBhcmdzLmFwcGVuZCgicmVjb3JkPVRydWUiKQogICAgICAgIGlmIHNlbGYuX21vZHVsZSBpcyBub3Qgc3lzLm1vZHVsZXNbJ3dhcm5pbmdzJ106CiAgICAgICAgICAgIGFyZ3MuYXBwZW5kKCJtb2R1bGU9JXIiICUgc2VsZi5fbW9kdWxlKQogICAgICAgIG5hbWUgPSB0eXBlKHNlbGYpLl9fbmFtZV9fCiAgICAgICAgcmV0dXJuICIlcyglcykiICUgKG5hbWUsICIsICIuam9pbihhcmdzKSkKCiAgICBkZWYgX19lbnRlcl9fKHNlbGYpOgogICAgICAgIGlmIHNlbGYuX2VudGVyZWQ6CiAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigiQ2Fubm90IGVudGVyICVyIHR3aWNlIiAlIHNlbGYpCiAgICAgICAgc2VsZi5fZW50ZXJlZCA9IFRydWUKICAgICAgICBzZWxmLl9maWx0ZXJzID0gc2VsZi5fbW9kdWxlLmZpbHRlcnMKICAgICAgICBzZWxmLl9tb2R1bGUuZmlsdGVycyA9IHNlbGYuX2ZpbHRlcnNbOl0KICAgICAgICBzZWxmLl9zaG93d2FybmluZyA9IHNlbGYuX21vZHVsZS5zaG93d2FybmluZwogICAgICAgIGlmIHNlbGYuX3JlY29yZDoKICAgICAgICAgICAgbG9nID0gW10KICAgICAgICAgICAgZGVmIHNob3d3YXJuaW5nKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgICAgICBsb2cuYXBwZW5kKFdhcm5pbmdNZXNzYWdlKCphcmdzLCAqKmt3YXJncykpCiAgICAgICAgICAgIHNlbGYuX21vZHVsZS5zaG93d2FybmluZyA9IHNob3d3YXJuaW5nCiAgICAgICAgICAgIHJldHVybiBsb2cKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBfX2V4aXRfXyhzZWxmLCAqZXhjX2luZm8pOgogICAgICAgIGlmIG5vdCBzZWxmLl9lbnRlcmVkOgogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoIkNhbm5vdCBleGl0ICVyIHdpdGhvdXQgZW50ZXJpbmcgZmlyc3QiICUgc2VsZikKICAgICAgICBzZWxmLl9tb2R1bGUuZmlsdGVycyA9IHNlbGYuX2ZpbHRlcnMKICAgICAgICBzZWxmLl9tb2R1bGUuc2hvd3dhcm5pbmcgPSBzZWxmLl9zaG93d2FybmluZwoKCiMgZmlsdGVycyBjb250YWlucyBhIHNlcXVlbmNlIG9mIGZpbHRlciA1LXR1cGxlcwojIFRoZSBjb21wb25lbnRzIG9mIHRoZSA1LXR1cGxlIGFyZToKIyAtIGFuIGFjdGlvbjogZXJyb3IsIGlnbm9yZSwgYWx3YXlzLCBkZWZhdWx0LCBtb2R1bGUsIG9yIG9uY2UKIyAtIGEgY29tcGlsZWQgcmVnZXggdGhhdCBtdXN0IG1hdGNoIHRoZSB3YXJuaW5nIG1lc3NhZ2UKIyAtIGEgY2xhc3MgcmVwcmVzZW50aW5nIHRoZSB3YXJuaW5nIGNhdGVnb3J5CiMgLSBhIGNvbXBpbGVkIHJlZ2V4IHRoYXQgbXVzdCBtYXRjaCB0aGUgbW9kdWxlIHRoYXQgaXMgYmVpbmcgd2FybmVkCiMgLSBhIGxpbmUgbnVtYmVyIGZvciB0aGUgbGluZSBiZWluZyB3YXJuaW5nLCBvciAwIHRvIG1lYW4gYW55IGxpbmUKIyBJZiBlaXRoZXIgaWYgdGhlIGNvbXBpbGVkIHJlZ2V4cyBhcmUgTm9uZSwgbWF0Y2ggYW55dGhpbmcuCl93YXJuaW5nc19kZWZhdWx0cyA9IEZhbHNlCnRyeToKICAgIGZyb20gX3dhcm5pbmdzIGltcG9ydCAoZmlsdGVycywgX2RlZmF1bHRhY3Rpb24sIF9vbmNlcmVnaXN0cnksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXJuLCB3YXJuX2V4cGxpY2l0KQogICAgZGVmYXVsdGFjdGlvbiA9IF9kZWZhdWx0YWN0aW9uCiAgICBvbmNlcmVnaXN0cnkgPSBfb25jZXJlZ2lzdHJ5CiAgICBfd2FybmluZ3NfZGVmYXVsdHMgPSBUcnVlCmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIGZpbHRlcnMgPSBbXQogICAgZGVmYXVsdGFjdGlvbiA9ICJkZWZhdWx0IgogICAgb25jZXJlZ2lzdHJ5ID0ge30KCgojIE1vZHVsZSBpbml0aWFsaXphdGlvbgpfcHJvY2Vzc29wdGlvbnMoc3lzLndhcm5vcHRpb25zKQppZiBub3QgX3dhcm5pbmdzX2RlZmF1bHRzOgogICAgc2lsZW5jZSA9IFtJbXBvcnRXYXJuaW5nLCBQZW5kaW5nRGVwcmVjYXRpb25XYXJuaW5nXQogICAgc2lsZW5jZS5hcHBlbmQoRGVwcmVjYXRpb25XYXJuaW5nKQogICAgZm9yIGNscyBpbiBzaWxlbmNlOgogICAgICAgIHNpbXBsZWZpbHRlcigiaWdub3JlIiwgY2F0ZWdvcnk9Y2xzKQogICAgYnl0ZXNfd2FybmluZyA9IHN5cy5mbGFncy5ieXRlc193YXJuaW5nCiAgICBpZiBieXRlc193YXJuaW5nID4gMToKICAgICAgICBieXRlc19hY3Rpb24gPSAiZXJyb3IiCiAgICBlbGlmIGJ5dGVzX3dhcm5pbmc6CiAgICAgICAgYnl0ZXNfYWN0aW9uID0gImRlZmF1bHQiCiAgICBlbHNlOgogICAgICAgIGJ5dGVzX2FjdGlvbiA9ICJpZ25vcmUiCiAgICBzaW1wbGVmaWx0ZXIoYnl0ZXNfYWN0aW9uLCBjYXRlZ29yeT1CeXRlc1dhcm5pbmcsIGFwcGVuZD0xKQogICAgIyByZXNvdXJjZSB1c2FnZSB3YXJuaW5ncyBhcmUgZW5hYmxlZCBieSBkZWZhdWx0IGluIHB5ZGVidWcgbW9kZQogICAgaWYgaGFzYXR0cihzeXMsICdnZXR0b3RhbHJlZmNvdW50Jyk6CiAgICAgICAgcmVzb3VyY2VfYWN0aW9uID0gImFsd2F5cyIKICAgIGVsc2U6CiAgICAgICAgcmVzb3VyY2VfYWN0aW9uID0gImlnbm9yZSIKICAgIHNpbXBsZWZpbHRlcihyZXNvdXJjZV9hY3Rpb24sIGNhdGVnb3J5PVJlc291cmNlV2FybmluZywgYXBwZW5kPTEpCgojZml4bWUgYnJ5dGhvbiBFcnJvcjogX3dhcm5pbmdzX2RlZmF1bHRzIGlzIG5vdCBkZWZpbmVkCiNkZWwgX3dhcm5pbmdzX2RlZmF1bHRzCg==',
'/Lib/webbrowser.py':'X19hbGxfXyA9IFsiRXJyb3IiLCAib3BlbiIsICJvcGVuX25ldyIsICJvcGVuX25ld190YWIiXQoKY2xhc3MgRXJyb3IoRXhjZXB0aW9uKToKICAgIHBhc3MKCl90YXJnZXQgPSB7IDA6ICcnLCAxOiAnX2JsYW5rJywgMjogJ19uZXcnIH0gICMgaGFjay4uLgoKCmRlZiBvcGVuKHVybCwgbmV3PTAsIGF1dG9yYWlzZT1UcnVlKToKICAgICIiIiAKICAgIG5ldyB3aW5kb3cgb3IgdGFiIGlzIG5vdCBjb250cm9sbGFibGUKICAgIG9uIHRoZSBjbGllbnQgc2lkZS4gYXV0b3JhaXNlIG5vdCBhdmFpbGFibGUuCiAgICAiIiIKICAgIGlmIHdpbi5vcGVuKHVybCwgX3RhcmdldFtuZXddKToKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgIHJldHVybiBGYWxzZQoKZGVmIG9wZW5fbmV3KHVybCk6CiAgICByZXR1cm4gb3Blbih1cmwsIDEpCgpkZWYgb3Blbl9uZXdfdGFiKHVybCk6CiAgICByZXR1cm4gb3Blbih1cmwsIDIpCgoK',
'/Lib/_abcoll.py':'IyBDb3B5cmlnaHQgMjAwNyBHb29nbGUsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KIyBMaWNlbnNlZCB0byBQU0YgdW5kZXIgYSBDb250cmlidXRvciBBZ3JlZW1lbnQuCgoiIiJBYnN0cmFjdCBCYXNlIENsYXNzZXMgKEFCQ3MpIGZvciBjb2xsZWN0aW9ucywgYWNjb3JkaW5nIHRvIFBFUCAzMTE5LgoKRE9OJ1QgVVNFIFRISVMgTU9EVUxFIERJUkVDVExZISAgVGhlIGNsYXNzZXMgaGVyZSBzaG91bGQgYmUgaW1wb3J0ZWQKdmlhIGNvbGxlY3Rpb25zOyB0aGV5IGFyZSBkZWZpbmVkIGhlcmUgb25seSB0byBhbGxldmlhdGUgY2VydGFpbgpib290c3RyYXBwaW5nIGlzc3Vlcy4gIFVuaXQgdGVzdHMgYXJlIGluIHRlc3RfY29sbGVjdGlvbnMuCiIiIgoKI2Zyb20gYWJjIGltcG9ydCBBQkNNZXRhLCBhYnN0cmFjdG1ldGhvZAppbXBvcnQgc3lzCgpfX2FsbF9fID0gWyJIYXNoYWJsZSIsICJJdGVyYWJsZSIsICJJdGVyYXRvciIsCiAgICAgICAgICAgIlNpemVkIiwgIkNvbnRhaW5lciIsICJDYWxsYWJsZSIsCiAgICAgICAgICAgIlNldCIsICJNdXRhYmxlU2V0IiwKICAgICAgICAgICAiTWFwcGluZyIsICJNdXRhYmxlTWFwcGluZyIsCiAgICAgICAgICAgIk1hcHBpbmdWaWV3IiwgIktleXNWaWV3IiwgIkl0ZW1zVmlldyIsICJWYWx1ZXNWaWV3IiwKICAgICAgICAgICAiU2VxdWVuY2UiLCAiTXV0YWJsZVNlcXVlbmNlIiwKICAgICAgICAgICAiQnl0ZVN0cmluZyIsCiAgICAgICAgICAgXQoKIiIiCiMjIyBjb2xsZWN0aW9uIHJlbGF0ZWQgdHlwZXMgd2hpY2ggYXJlIG5vdCBleHBvc2VkIHRocm91Z2ggYnVpbHRpbiAjIyMKIyMgaXRlcmF0b3JzICMjCiNmaXhtZSBicnl0aG9uCiNieXRlc19pdGVyYXRvciA9IHR5cGUoaXRlcihiJycpKQpieXRlc19pdGVyYXRvciA9IHR5cGUoaXRlcignJykpCiNmaXhtZSBicnl0aG9uCiNieXRlYXJyYXlfaXRlcmF0b3IgPSB0eXBlKGl0ZXIoYnl0ZWFycmF5KCkpKQojY2FsbGFibGVfaXRlcmF0b3IgPSA/Pz8KZGljdF9rZXlpdGVyYXRvciA9IHR5cGUoaXRlcih7fS5rZXlzKCkpKQpkaWN0X3ZhbHVlaXRlcmF0b3IgPSB0eXBlKGl0ZXIoe30udmFsdWVzKCkpKQpkaWN0X2l0ZW1pdGVyYXRvciA9IHR5cGUoaXRlcih7fS5pdGVtcygpKSkKbGlzdF9pdGVyYXRvciA9IHR5cGUoaXRlcihbXSkpCmxpc3RfcmV2ZXJzZWl0ZXJhdG9yID0gdHlwZShpdGVyKHJldmVyc2VkKFtdKSkpCnJhbmdlX2l0ZXJhdG9yID0gdHlwZShpdGVyKHJhbmdlKDApKSkKc2V0X2l0ZXJhdG9yID0gdHlwZShpdGVyKHNldCgpKSkKc3RyX2l0ZXJhdG9yID0gdHlwZShpdGVyKCIiKSkKdHVwbGVfaXRlcmF0b3IgPSB0eXBlKGl0ZXIoKCkpKQp6aXBfaXRlcmF0b3IgPSB0eXBlKGl0ZXIoemlwKCkpKQojIyB2aWV3cyAjIwpkaWN0X2tleXMgPSB0eXBlKHt9LmtleXMoKSkKZGljdF92YWx1ZXMgPSB0eXBlKHt9LnZhbHVlcygpKQpkaWN0X2l0ZW1zID0gdHlwZSh7fS5pdGVtcygpKQojIyBtaXNjICMjCmRpY3RfcHJveHkgPSB0eXBlKHR5cGUuX19kaWN0X18pCiIiIgoKZGVmIGFic3RyYWN0bWV0aG9kKHNlbGYpOgogICAgcmV0dXJuIHNlbGYKCiMjIyBPTkUtVFJJQ0sgUE9OSUVTICMjIwoKCiNjbGFzcyBJdGVyYWJsZShtZXRhY2xhc3M9QUJDTWV0YSk6CmNsYXNzIEl0ZXJhYmxlOgoKICAgIEBhYnN0cmFjdG1ldGhvZAogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHdoaWxlIEZhbHNlOgogICAgICAgICAgICB5aWVsZCBOb25lCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgX19zdWJjbGFzc2hvb2tfXyhjbHMsIEMpOgogICAgICAgIGlmIGNscyBpcyBJdGVyYWJsZToKICAgICAgICAgICAgaWYgYW55KCJfX2l0ZXJfXyIgaW4gQi5fX2RpY3RfXyBmb3IgQiBpbiBDLl9fbXJvX18pOgogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCgojY2xhc3MgU2l6ZWQobWV0YWNsYXNzPUFCQ01ldGEpOgpjbGFzcyBTaXplZDoKCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICAgIHJldHVybiAwCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgX19zdWJjbGFzc2hvb2tfXyhjbHMsIEMpOgogICAgICAgIGlmIGNscyBpcyBTaXplZDoKICAgICAgICAgICAgaWYgYW55KCJfX2xlbl9fIiBpbiBCLl9fZGljdF9fIGZvciBCIGluIEMuX19tcm9fXyk6CiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKCiNjbGFzcyBDb250YWluZXIobWV0YWNsYXNzPUFCQ01ldGEpOgpjbGFzcyBDb250YWluZXI6CgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgX19jb250YWluc19fKHNlbGYsIHgpOgogICAgICAgIHJldHVybiBGYWxzZQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIF9fc3ViY2xhc3Nob29rX18oY2xzLCBDKToKICAgICAgICBpZiBjbHMgaXMgQ29udGFpbmVyOgogICAgICAgICAgICBpZiBhbnkoIl9fY29udGFpbnNfXyIgaW4gQi5fX2RpY3RfXyBmb3IgQiBpbiBDLl9fbXJvX18pOgogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiMjIyBNQVBQSU5HUyAjIyMKCgpjbGFzcyBNYXBwaW5nKFNpemVkLCBJdGVyYWJsZSwgQ29udGFpbmVyKToKCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBrZXkpOgogICAgICAgIHJhaXNlIEtleUVycm9yCgogICAgZGVmIGdldChzZWxmLCBrZXksIGRlZmF1bHQ9Tm9uZSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gc2VsZltrZXldCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICByZXR1cm4gZGVmYXVsdAoKICAgIGRlZiBfX2NvbnRhaW5zX18oc2VsZiwga2V5KToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGZba2V5XQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYga2V5cyhzZWxmKToKICAgICAgICByZXR1cm4gS2V5c1ZpZXcoc2VsZikKCiAgICBkZWYgaXRlbXMoc2VsZik6CiAgICAgICAgcmV0dXJuIEl0ZW1zVmlldyhzZWxmKQoKICAgIGRlZiB2YWx1ZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIFZhbHVlc1ZpZXcoc2VsZikKCiAgICBkZWYgX19lcV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgTWFwcGluZyk6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAogICAgICAgIHJldHVybiBkaWN0KHNlbGYuaXRlbXMoKSkgPT0gZGljdChvdGhlci5pdGVtcygpKQoKICAgIGRlZiBfX25lX18oc2VsZiwgb3RoZXIpOgogICAgICAgIHJldHVybiBub3QgKHNlbGYgPT0gb3RoZXIpCgoKY2xhc3MgTXV0YWJsZU1hcHBpbmcoTWFwcGluZyk6CgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgX19zZXRpdGVtX18oc2VsZiwga2V5LCB2YWx1ZSk6CiAgICAgICAgcmFpc2UgS2V5RXJyb3IKCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBfX2RlbGl0ZW1fXyhzZWxmLCBrZXkpOgogICAgICAgIHJhaXNlIEtleUVycm9yCgogICAgX19tYXJrZXIgPSBvYmplY3QoKQoKICAgIGRlZiBwb3Aoc2VsZiwga2V5LCBkZWZhdWx0PV9fbWFya2VyKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHZhbHVlID0gc2VsZltrZXldCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICBpZiBkZWZhdWx0IGlzIHNlbGYuX19tYXJrZXI6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgICAgICByZXR1cm4gZGVmYXVsdAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRlbCBzZWxmW2tleV0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlCgogICAgZGVmIHBvcGl0ZW0oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBrZXkgPSBuZXh0KGl0ZXIoc2VsZikpCiAgICAgICAgZXhjZXB0IFN0b3BJdGVyYXRpb246CiAgICAgICAgICAgIHJhaXNlIEtleUVycm9yCiAgICAgICAgdmFsdWUgPSBzZWxmW2tleV0KICAgICAgICBkZWwgc2VsZltrZXldCiAgICAgICAgcmV0dXJuIGtleSwgdmFsdWUKCiAgICBkZWYgY2xlYXIoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgc2VsZi5wb3BpdGVtKCkKICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIHBhc3MKCiAgICBkZWYgdXBkYXRlKCphcmdzLCAqKmt3ZHMpOgogICAgICAgIGlmIGxlbihhcmdzKSA+IDI6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigidXBkYXRlKCkgdGFrZXMgYXQgbW9zdCAyIHBvc2l0aW9uYWwgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgImFyZ3VtZW50cyAoe30gZ2l2ZW4pIi5mb3JtYXQobGVuKGFyZ3MpKSkKICAgICAgICBlbGlmIG5vdCBhcmdzOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoInVwZGF0ZSgpIHRha2VzIGF0IGxlYXN0IDEgYXJndW1lbnQgKDAgZ2l2ZW4pIikKICAgICAgICBzZWxmID0gYXJnc1swXQogICAgICAgIG90aGVyID0gYXJnc1sxXSBpZiBsZW4oYXJncykgPj0gMiBlbHNlICgpCgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIE1hcHBpbmcpOgogICAgICAgICAgICBmb3Iga2V5IGluIG90aGVyOgogICAgICAgICAgICAgICAgc2VsZltrZXldID0gb3RoZXJba2V5XQogICAgICAgIGVsaWYgaGFzYXR0cihvdGhlciwgImtleXMiKToKICAgICAgICAgICAgZm9yIGtleSBpbiBvdGhlci5rZXlzKCk6CiAgICAgICAgICAgICAgICBzZWxmW2tleV0gPSBvdGhlcltrZXldCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gb3RoZXI6CiAgICAgICAgICAgICAgICBzZWxmW2tleV0gPSB2YWx1ZQogICAgICAgIGZvciBrZXksIHZhbHVlIGluIGt3ZHMuaXRlbXMoKToKICAgICAgICAgICAgc2VsZltrZXldID0gdmFsdWUKCiAgICBkZWYgc2V0ZGVmYXVsdChzZWxmLCBrZXksIGRlZmF1bHQ9Tm9uZSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gc2VsZltrZXldCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICBzZWxmW2tleV0gPSBkZWZhdWx0CiAgICAgICAgcmV0dXJuIGRlZmF1bHQKCiNNdXRhYmxlTWFwcGluZy5yZWdpc3RlcihkaWN0KQo=',
'/Lib/_collections.py':'IyAiSGlnaCBwZXJmb3JtYW5jZSBkYXRhIHN0cnVjdHVyZXMKIyAiCiMgY29waWVkIGZyb20gcHlweSByZXBvCgojCiMgQ29waWVkIGFuZCBjb21wbGV0ZWQgZnJvbSB0aGUgc2FuZGJveCBvZiBDUHl0aG9uCiMgICAobm9uZGlzdC9zYW5kYm94L2NvbGxlY3Rpb25zL3B5ZGVxdWUucHkgcmV2IDEuMSwgUmF5bW9uZCBIZXR0aW5nZXIpCiMKCmltcG9ydCBvcGVyYXRvcgojdHJ5OgojICAgIGZyb20gdGhyZWFkIGltcG9ydCBnZXRfaWRlbnQgYXMgX3RocmVhZF9pZGVudAojZXhjZXB0IEltcG9ydEVycm9yOgpkZWYgX3RocmVhZF9pZGVudCgpOgogICAgcmV0dXJuIC0xCgoKbiA9IDMwCkxGVExOSyA9IG4KUkdUTE5LID0gbisxCkJMT0NLU0laID0gbisyCgojIFRoZSBkZXF1ZSdzIHNpemUgbGltaXQgaXMgZC5tYXhsZW4uICBUaGUgbGltaXQgY2FuIGJlIHplcm8gb3IgcG9zaXRpdmUsIG9yCiMgTm9uZS4gIEFmdGVyIGFuIGl0ZW0gaXMgYWRkZWQgdG8gYSBkZXF1ZSwgd2UgY2hlY2sgdG8gc2VlIGlmIHRoZSBzaXplIGhhcwojIGdyb3duIHBhc3QgdGhlIGxpbWl0LiBJZiBpdCBoYXMsIHdlIGdldCB0aGUgc2l6ZSBiYWNrIGRvd24gdG8gdGhlIGxpbWl0IGJ5CiMgcG9wcGluZyBhbiBpdGVtIG9mZiBvZiB0aGUgb3Bwb3NpdGUgZW5kLiAgVGhlIG1ldGhvZHMgdGhhdCBjYW4gdHJpZ2dlciB0aGlzCiMgYXJlIGFwcGVuZCgpLCBhcHBlbmRsZWZ0KCksIGV4dGVuZCgpLCBhbmQgZXh0ZW5kbGVmdCgpLgoKY2xhc3MgZGVxdWUob2JqZWN0KToKI2NsYXNzIGRlcXVlOgoKICAgIGRlZiBfX25ld19fKGNscywgaXRlcmFibGU9KCksICphcmdzLCAqKmt3KToKICAgICAgICAjZml4bWUKICAgICAgICAjc2VsZiA9IHN1cGVyKGRlcXVlLCBjbHMpLl9fbmV3X18oY2xzLCAqYXJncywgKiprdykKICAgICAgICBzZWxmPW9iamVjdC5fX25ld19fKGNscywgKmFyZ3MsICoqa3cpCiAgICAgICAgc2VsZi5jbGVhcigpCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaXRlcmFibGU9KCksIG1heGxlbj1Ob25lKToKICAgICAgICBvYmplY3QuX19pbml0X18oc2VsZikKICAgICAgICBzZWxmLmNsZWFyKCkKICAgICAgICBpZiBtYXhsZW4gaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGlmIG1heGxlbiA8IDA6CiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJtYXhsZW4gbXVzdCBiZSBub24tbmVnYXRpdmUiKQogICAgICAgIHNlbGYuX21heGxlbiA9IG1heGxlbgogICAgICAgIGFkZCA9IHNlbGYuYXBwZW5kCiAgICAgICAgZm9yIGVsZW0gaW4gaXRlcmFibGU6CiAgICAgICAgICAgIGFkZChlbGVtKQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIG1heGxlbihzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fbWF4bGVuCgogICAgZGVmIGNsZWFyKHNlbGYpOgogICAgICAgIHNlbGYucmlnaHQgPSBzZWxmLmxlZnQgPSBbTm9uZV0gKiBCTE9DS1NJWgogICAgICAgIHNlbGYucmlnaHRuZHggPSBuLy8yICAgIyBwb2ludHMgdG8gbGFzdCB3cml0dGVuIGVsZW1lbnQKICAgICAgICBzZWxmLmxlZnRuZHggPSBuLy8yKzEKICAgICAgICBzZWxmLmxlbmd0aCA9IDAKICAgICAgICBzZWxmLnN0YXRlID0gMAoKICAgIGRlZiBhcHBlbmQoc2VsZiwgeCk6CiAgICAgICAgc2VsZi5zdGF0ZSArPSAxCiAgICAgICAgc2VsZi5yaWdodG5keCArPSAxCiAgICAgICAgaWYgc2VsZi5yaWdodG5keCA9PSBuOgogICAgICAgICAgICBuZXdibG9jayA9IFtOb25lXSAqIEJMT0NLU0laCiAgICAgICAgICAgIHNlbGYucmlnaHRbUkdUTE5LXSA9IG5ld2Jsb2NrCiAgICAgICAgICAgIG5ld2Jsb2NrW0xGVExOS10gPSBzZWxmLnJpZ2h0CiAgICAgICAgICAgIHNlbGYucmlnaHQgPSBuZXdibG9jawogICAgICAgICAgICBzZWxmLnJpZ2h0bmR4ID0gMAogICAgICAgIHNlbGYubGVuZ3RoICs9IDEKICAgICAgICBzZWxmLnJpZ2h0W3NlbGYucmlnaHRuZHhdID0geAogICAgICAgIGlmIHNlbGYubWF4bGVuIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxlbmd0aCA+IHNlbGYubWF4bGVuOgogICAgICAgICAgICBzZWxmLnBvcGxlZnQoKQoKICAgIGRlZiBhcHBlbmRsZWZ0KHNlbGYsIHgpOgogICAgICAgIHNlbGYuc3RhdGUgKz0gMQogICAgICAgIHNlbGYubGVmdG5keCAtPSAxCiAgICAgICAgaWYgc2VsZi5sZWZ0bmR4ID09IC0xOgogICAgICAgICAgICBuZXdibG9jayA9IFtOb25lXSAqIEJMT0NLU0laCiAgICAgICAgICAgIHNlbGYubGVmdFtMRlRMTktdID0gbmV3YmxvY2sKICAgICAgICAgICAgbmV3YmxvY2tbUkdUTE5LXSA9IHNlbGYubGVmdAogICAgICAgICAgICBzZWxmLmxlZnQgPSBuZXdibG9jawogICAgICAgICAgICBzZWxmLmxlZnRuZHggPSBuLTEKICAgICAgICBzZWxmLmxlbmd0aCArPSAxCiAgICAgICAgc2VsZi5sZWZ0W3NlbGYubGVmdG5keF0gPSB4CiAgICAgICAgaWYgc2VsZi5tYXhsZW4gaXMgbm90IE5vbmUgYW5kIHNlbGYubGVuZ3RoID4gc2VsZi5tYXhsZW46CiAgICAgICAgICAgIHNlbGYucG9wKCkKCiAgICBkZWYgZXh0ZW5kKHNlbGYsIGl0ZXJhYmxlKToKICAgICAgICBpZiBpdGVyYWJsZSBpcyBzZWxmOgogICAgICAgICAgICBpdGVyYWJsZSA9IGxpc3QoaXRlcmFibGUpCiAgICAgICAgZm9yIGVsZW0gaW4gaXRlcmFibGU6CiAgICAgICAgICAgIHNlbGYuYXBwZW5kKGVsZW0pCgogICAgZGVmIGV4dGVuZGxlZnQoc2VsZiwgaXRlcmFibGUpOgogICAgICAgIGlmIGl0ZXJhYmxlIGlzIHNlbGY6CiAgICAgICAgICAgIGl0ZXJhYmxlID0gbGlzdChpdGVyYWJsZSkKICAgICAgICBmb3IgZWxlbSBpbiBpdGVyYWJsZToKICAgICAgICAgICAgc2VsZi5hcHBlbmRsZWZ0KGVsZW0pCgogICAgZGVmIHBvcChzZWxmKToKICAgICAgICBpZiBzZWxmLmxlZnQgaXMgc2VsZi5yaWdodCBhbmQgc2VsZi5sZWZ0bmR4ID4gc2VsZi5yaWdodG5keDoKICAgICAgICAgICAgI3JhaXNlIEluZGV4RXJyb3IsICJwb3AgZnJvbSBhbiBlbXB0eSBkZXF1ZSIgICMgZG9lcyBub3Qgd29yayBpbiBicnl0aG9uCiAgICAgICAgICAgIHJhaXNlIEluZGV4RXJyb3IoInBvcCBmcm9tIGFuIGVtcHR5IGRlcXVlIikKICAgICAgICB4ID0gc2VsZi5yaWdodFtzZWxmLnJpZ2h0bmR4XQogICAgICAgIHNlbGYucmlnaHRbc2VsZi5yaWdodG5keF0gPSBOb25lCiAgICAgICAgc2VsZi5sZW5ndGggLT0gMQogICAgICAgIHNlbGYucmlnaHRuZHggLT0gMQogICAgICAgIHNlbGYuc3RhdGUgKz0gMQogICAgICAgIGlmIHNlbGYucmlnaHRuZHggPT0gLTE6CiAgICAgICAgICAgIHByZXZibG9jayA9IHNlbGYucmlnaHRbTEZUTE5LXQogICAgICAgICAgICBpZiBwcmV2YmxvY2sgaXMgTm9uZToKICAgICAgICAgICAgICAgICMgdGhlIGRlcXVlIGhhcyBiZWNvbWUgZW1wdHk7IHJlY2VudGVyIGluc3RlYWQgb2YgZnJlZWluZyBibG9jawogICAgICAgICAgICAgICAgc2VsZi5yaWdodG5keCA9IG4vLzIKICAgICAgICAgICAgICAgIHNlbGYubGVmdG5keCA9IG4vLzIrMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJldmJsb2NrW1JHVExOS10gPSBOb25lCiAgICAgICAgICAgICAgICBzZWxmLnJpZ2h0W0xGVExOS10gPSBOb25lCiAgICAgICAgICAgICAgICBzZWxmLnJpZ2h0ID0gcHJldmJsb2NrCiAgICAgICAgICAgICAgICBzZWxmLnJpZ2h0bmR4ID0gbi0xCiAgICAgICAgcmV0dXJuIHgKCiAgICBkZWYgcG9wbGVmdChzZWxmKToKICAgICAgICBpZiBzZWxmLmxlZnQgaXMgc2VsZi5yaWdodCBhbmQgc2VsZi5sZWZ0bmR4ID4gc2VsZi5yaWdodG5keDoKICAgICAgICAgICAgI3JhaXNlIEluZGV4RXJyb3IsICJwb3AgZnJvbSBhbiBlbXB0eSBkZXF1ZSIKICAgICAgICAgICAgcmFpc2UgSW5kZXhFcnJvcigicG9wIGZyb20gYW4gZW1wdHkgZGVxdWUiKQogICAgICAgIHggPSBzZWxmLmxlZnRbc2VsZi5sZWZ0bmR4XQogICAgICAgIHNlbGYubGVmdFtzZWxmLmxlZnRuZHhdID0gTm9uZQogICAgICAgIHNlbGYubGVuZ3RoIC09IDEKICAgICAgICBzZWxmLmxlZnRuZHggKz0gMQogICAgICAgIHNlbGYuc3RhdGUgKz0gMQogICAgICAgIGlmIHNlbGYubGVmdG5keCA9PSBuOgogICAgICAgICAgICBwcmV2YmxvY2sgPSBzZWxmLmxlZnRbUkdUTE5LXQogICAgICAgICAgICBpZiBwcmV2YmxvY2sgaXMgTm9uZToKICAgICAgICAgICAgICAgICMgdGhlIGRlcXVlIGhhcyBiZWNvbWUgZW1wdHk7IHJlY2VudGVyIGluc3RlYWQgb2YgZnJlZWluZyBibG9jawogICAgICAgICAgICAgICAgc2VsZi5yaWdodG5keCA9IG4vLzIKICAgICAgICAgICAgICAgIHNlbGYubGVmdG5keCA9IG4vLzIrMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJldmJsb2NrW0xGVExOS10gPSBOb25lCiAgICAgICAgICAgICAgICBzZWxmLmxlZnRbUkdUTE5LXSA9IE5vbmUKICAgICAgICAgICAgICAgIHNlbGYubGVmdCA9IHByZXZibG9jawogICAgICAgICAgICAgICAgc2VsZi5sZWZ0bmR4ID0gMAogICAgICAgIHJldHVybiB4CgogICAgZGVmIGNvdW50KHNlbGYsIHZhbHVlKToKICAgICAgICBjID0gMAogICAgICAgIGZvciBpdGVtIGluIHNlbGY6CiAgICAgICAgICAgIGlmIGl0ZW0gPT0gdmFsdWU6CiAgICAgICAgICAgICAgICBjICs9IDEKICAgICAgICByZXR1cm4gYwoKICAgIGRlZiByZW1vdmUoc2VsZiwgdmFsdWUpOgogICAgICAgICMgTmVlZCB0byBiZSBkZWZlbnNpdmUgZm9yIG11dGF0aW5nIGNvbXBhcmlzb25zCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UobGVuKHNlbGYpKToKICAgICAgICAgICAgaWYgc2VsZltpXSA9PSB2YWx1ZToKICAgICAgICAgICAgICAgIGRlbCBzZWxmW2ldCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJkZXF1ZS5yZW1vdmUoeCk6IHggbm90IGluIGRlcXVlIikKCiAgICBkZWYgcm90YXRlKHNlbGYsIG49MSk6CiAgICAgICAgbGVuZ3RoID0gbGVuKHNlbGYpCiAgICAgICAgaWYgbGVuZ3RoID09IDA6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIGhhbGZsZW4gPSAobGVuZ3RoKzEpID4+IDEKICAgICAgICBpZiBuID4gaGFsZmxlbiBvciBuIDwgLWhhbGZsZW46CiAgICAgICAgICAgIG4gJT0gbGVuZ3RoCiAgICAgICAgICAgIGlmIG4gPiBoYWxmbGVuOgogICAgICAgICAgICAgICAgbiAtPSBsZW5ndGgKICAgICAgICAgICAgZWxpZiBuIDwgLWhhbGZsZW46CiAgICAgICAgICAgICAgICBuICs9IGxlbmd0aAogICAgICAgIHdoaWxlIG4gPiAwOgogICAgICAgICAgICBzZWxmLmFwcGVuZGxlZnQoc2VsZi5wb3AoKSkKICAgICAgICAgICAgbiAtPSAxCiAgICAgICAgd2hpbGUgbiA8IDA6CiAgICAgICAgICAgIHNlbGYuYXBwZW5kKHNlbGYucG9wbGVmdCgpKQogICAgICAgICAgICBuICs9IDEKCiAgICBkZWYgcmV2ZXJzZShzZWxmKToKICAgICAgICAicmV2ZXJzZSAqSU4gUExBQ0UqIgogICAgICAgIGxlZnRibG9jayA9IHNlbGYubGVmdAogICAgICAgIHJpZ2h0YmxvY2sgPSBzZWxmLnJpZ2h0CiAgICAgICAgbGVmdGluZGV4ID0gc2VsZi5sZWZ0bmR4CiAgICAgICAgcmlnaHRpbmRleCA9IHNlbGYucmlnaHRuZHgKICAgICAgICBmb3IgaSBpbiByYW5nZShzZWxmLmxlbmd0aCAvLyAyKToKICAgICAgICAgICAgIyBWYWxpZGF0ZSB0aGF0IHBvaW50ZXJzIGhhdmVuJ3QgbWV0IGluIHRoZSBtaWRkbGUKICAgICAgICAgICAgYXNzZXJ0IGxlZnRibG9jayAhPSByaWdodGJsb2NrIG9yIGxlZnRpbmRleCA8IHJpZ2h0aW5kZXgKCiAgICAgICAgICAgICMgU3dhcAogICAgICAgICAgICAocmlnaHRibG9ja1tyaWdodGluZGV4XSwgbGVmdGJsb2NrW2xlZnRpbmRleF0pID0gKAogICAgICAgICAgICAgICAgbGVmdGJsb2NrW2xlZnRpbmRleF0sIHJpZ2h0YmxvY2tbcmlnaHRpbmRleF0pCgogICAgICAgICAgICAjIEFkdmFuY2UgbGVmdCBibG9jay9pbmRleCBwYWlyCiAgICAgICAgICAgIGxlZnRpbmRleCArPSAxCiAgICAgICAgICAgIGlmIGxlZnRpbmRleCA9PSBuOgogICAgICAgICAgICAgICAgbGVmdGJsb2NrID0gbGVmdGJsb2NrW1JHVExOS10KICAgICAgICAgICAgICAgIGFzc2VydCBsZWZ0YmxvY2sgaXMgbm90IE5vbmUKICAgICAgICAgICAgICAgIGxlZnRpbmRleCA9IDAKCiAgICAgICAgICAgICMgU3RlcCBiYWNrd2FyZHMgd2l0aCB0aGUgcmlnaHQgYmxvY2svaW5kZXggcGFpcgogICAgICAgICAgICByaWdodGluZGV4IC09IDEKICAgICAgICAgICAgaWYgcmlnaHRpbmRleCA9PSAtMToKICAgICAgICAgICAgICAgIHJpZ2h0YmxvY2sgPSByaWdodGJsb2NrW0xGVExOS10KICAgICAgICAgICAgICAgIGFzc2VydCByaWdodGJsb2NrIGlzIG5vdCBOb25lCiAgICAgICAgICAgICAgICByaWdodGluZGV4ID0gbiAtIDEKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgdGhyZWFkbG9jYWxhdHRyID0gJ19fcmVwcicgKyBzdHIoX3RocmVhZF9pZGVudCgpKQogICAgICAgIGlmIHRocmVhZGxvY2FsYXR0ciBpbiBzZWxmLl9fZGljdF9fOgogICAgICAgICAgICByZXR1cm4gJ2RlcXVlKFsuLi5dKScKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl9fZGljdF9fW3RocmVhZGxvY2FsYXR0cl0gPSBUcnVlCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIHNlbGYubWF4bGVuIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIHJldHVybiAnZGVxdWUoJXIsIG1heGxlbj0lcyknICUgKGxpc3Qoc2VsZiksIHNlbGYubWF4bGVuKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ2RlcXVlKCVyKScgJSAobGlzdChzZWxmKSwpCiAgICAgICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgICAgICBkZWwgc2VsZi5fX2RpY3RfX1t0aHJlYWRsb2NhbGF0dHJdCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBkZXF1ZV9pdGVyYXRvcihzZWxmLCBzZWxmLl9pdGVyX2ltcGwpCgogICAgZGVmIF9pdGVyX2ltcGwoc2VsZiwgb3JpZ2luYWxfc3RhdGUsIGdpdmV1cCk6CiAgICAgICAgaWYgc2VsZi5zdGF0ZSAhPSBvcmlnaW5hbF9zdGF0ZToKICAgICAgICAgICAgZ2l2ZXVwKCkKICAgICAgICBibG9jayA9IHNlbGYubGVmdAogICAgICAgIHdoaWxlIGJsb2NrOgogICAgICAgICAgICBsLCByID0gMCwgbgogICAgICAgICAgICBpZiBibG9jayBpcyBzZWxmLmxlZnQ6CiAgICAgICAgICAgICAgICBsID0gc2VsZi5sZWZ0bmR4CiAgICAgICAgICAgIGlmIGJsb2NrIGlzIHNlbGYucmlnaHQ6CiAgICAgICAgICAgICAgICByID0gc2VsZi5yaWdodG5keCArIDEKICAgICAgICAgICAgZm9yIGVsZW0gaW4gYmxvY2tbbDpyXToKICAgICAgICAgICAgICAgIHlpZWxkIGVsZW0KICAgICAgICAgICAgICAgIGlmIHNlbGYuc3RhdGUgIT0gb3JpZ2luYWxfc3RhdGU6CiAgICAgICAgICAgICAgICAgICAgZ2l2ZXVwKCkKICAgICAgICAgICAgYmxvY2sgPSBibG9ja1tSR1RMTktdCgogICAgZGVmIF9fcmV2ZXJzZWRfXyhzZWxmKToKICAgICAgICByZXR1cm4gZGVxdWVfaXRlcmF0b3Ioc2VsZiwgc2VsZi5fcmV2ZXJzZWRfaW1wbCkKCiAgICBkZWYgX3JldmVyc2VkX2ltcGwoc2VsZiwgb3JpZ2luYWxfc3RhdGUsIGdpdmV1cCk6CiAgICAgICAgaWYgc2VsZi5zdGF0ZSAhPSBvcmlnaW5hbF9zdGF0ZToKICAgICAgICAgICAgZ2l2ZXVwKCkKICAgICAgICBibG9jayA9IHNlbGYucmlnaHQKICAgICAgICB3aGlsZSBibG9jazoKICAgICAgICAgICAgbCwgciA9IDAsIG4KICAgICAgICAgICAgaWYgYmxvY2sgaXMgc2VsZi5sZWZ0OgogICAgICAgICAgICAgICAgbCA9IHNlbGYubGVmdG5keAogICAgICAgICAgICBpZiBibG9jayBpcyBzZWxmLnJpZ2h0OgogICAgICAgICAgICAgICAgciA9IHNlbGYucmlnaHRuZHggKyAxCiAgICAgICAgICAgIGZvciBlbGVtIGluIHJldmVyc2VkKGJsb2NrW2w6cl0pOgogICAgICAgICAgICAgICAgeWllbGQgZWxlbQogICAgICAgICAgICAgICAgaWYgc2VsZi5zdGF0ZSAhPSBvcmlnaW5hbF9zdGF0ZToKICAgICAgICAgICAgICAgICAgICBnaXZldXAoKQogICAgICAgICAgICBibG9jayA9IGJsb2NrW0xGVExOS10KCiAgICBkZWYgX19sZW5fXyhzZWxmKToKICAgICAgICAjc3VtID0gMAogICAgICAgICNibG9jayA9IHNlbGYubGVmdAogICAgICAgICN3aGlsZSBibG9jazoKICAgICAgICAjICAgIHN1bSArPSBuCiAgICAgICAgIyAgICBibG9jayA9IGJsb2NrW1JHVExOS10KICAgICAgICAjcmV0dXJuIHN1bSArIHNlbGYucmlnaHRuZHggLSBzZWxmLmxlZnRuZHggKyAxIC0gbgogICAgICAgIHJldHVybiBzZWxmLmxlbmd0aAoKICAgIGRlZiBfX2dldHJlZihzZWxmLCBpbmRleCk6CiAgICAgICAgaWYgaW5kZXggPj0gMDoKICAgICAgICAgICAgYmxvY2sgPSBzZWxmLmxlZnQKICAgICAgICAgICAgd2hpbGUgYmxvY2s6CiAgICAgICAgICAgICAgICBsLCByID0gMCwgbgogICAgICAgICAgICAgICAgaWYgYmxvY2sgaXMgc2VsZi5sZWZ0OgogICAgICAgICAgICAgICAgICAgIGwgPSBzZWxmLmxlZnRuZHgKICAgICAgICAgICAgICAgIGlmIGJsb2NrIGlzIHNlbGYucmlnaHQ6CiAgICAgICAgICAgICAgICAgICAgciA9IHNlbGYucmlnaHRuZHggKyAxCiAgICAgICAgICAgICAgICBzcGFuID0gci1sCiAgICAgICAgICAgICAgICBpZiBpbmRleCA8IHNwYW46CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJsb2NrLCBsK2luZGV4CiAgICAgICAgICAgICAgICBpbmRleCAtPSBzcGFuCiAgICAgICAgICAgICAgICBibG9jayA9IGJsb2NrW1JHVExOS10KICAgICAgICBlbHNlOgogICAgICAgICAgICBibG9jayA9IHNlbGYucmlnaHQKICAgICAgICAgICAgd2hpbGUgYmxvY2s6CiAgICAgICAgICAgICAgICBsLCByID0gMCwgbgogICAgICAgICAgICAgICAgaWYgYmxvY2sgaXMgc2VsZi5sZWZ0OgogICAgICAgICAgICAgICAgICAgIGwgPSBzZWxmLmxlZnRuZHgKICAgICAgICAgICAgICAgIGlmIGJsb2NrIGlzIHNlbGYucmlnaHQ6CiAgICAgICAgICAgICAgICAgICAgciA9IHNlbGYucmlnaHRuZHggKyAxCiAgICAgICAgICAgICAgICBuZWdhdGl2ZV9zcGFuID0gbC1yCiAgICAgICAgICAgICAgICBpZiBpbmRleCA+PSBuZWdhdGl2ZV9zcGFuOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBibG9jaywgcitpbmRleAogICAgICAgICAgICAgICAgaW5kZXggLT0gbmVnYXRpdmVfc3BhbgogICAgICAgICAgICAgICAgYmxvY2sgPSBibG9ja1tMRlRMTktdCiAgICAgICAgcmFpc2UgSW5kZXhFcnJvcigiZGVxdWUgaW5kZXggb3V0IG9mIHJhbmdlIikKCiAgICBkZWYgX19nZXRpdGVtX18oc2VsZiwgaW5kZXgpOgogICAgICAgIGJsb2NrLCBpbmRleCA9IHNlbGYuX19nZXRyZWYoaW5kZXgpCiAgICAgICAgcmV0dXJuIGJsb2NrW2luZGV4XQoKICAgIGRlZiBfX3NldGl0ZW1fXyhzZWxmLCBpbmRleCwgdmFsdWUpOgogICAgICAgIGJsb2NrLCBpbmRleCA9IHNlbGYuX19nZXRyZWYoaW5kZXgpCiAgICAgICAgYmxvY2tbaW5kZXhdID0gdmFsdWUKCiAgICBkZWYgX19kZWxpdGVtX18oc2VsZiwgaW5kZXgpOgogICAgICAgIGxlbmd0aCA9IGxlbihzZWxmKQogICAgICAgIGlmIGluZGV4ID49IDA6CiAgICAgICAgICAgIGlmIGluZGV4ID49IGxlbmd0aDoKICAgICAgICAgICAgICAgIHJhaXNlIEluZGV4RXJyb3IoImRlcXVlIGluZGV4IG91dCBvZiByYW5nZSIpCiAgICAgICAgICAgIHNlbGYucm90YXRlKC1pbmRleCkKICAgICAgICAgICAgc2VsZi5wb3BsZWZ0KCkKICAgICAgICAgICAgc2VsZi5yb3RhdGUoaW5kZXgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgI2luZGV4ID0gfmluZGV4ICAgICAgI3RvZG8gdW50aWwgYml0IHdpc2Ugb3BlcmF0b3JzIGFyZSBpbiBieXRob24KICAgICAgICAgICAgaW5kZXg9IGluZGV4XigyKiozMSkKICAgICAgICAgICAgaWYgaW5kZXggPj0gbGVuZ3RoOgogICAgICAgICAgICAgICAgcmFpc2UgSW5kZXhFcnJvcigiZGVxdWUgaW5kZXggb3V0IG9mIHJhbmdlIikKICAgICAgICAgICAgc2VsZi5yb3RhdGUoaW5kZXgpCiAgICAgICAgICAgIHNlbGYucG9wKCkKICAgICAgICAgICAgc2VsZi5yb3RhdGUoLWluZGV4KQoKICAgIGRlZiBfX3JlZHVjZV9leF9fKHNlbGYsIHByb3RvKToKICAgICAgICByZXR1cm4gdHlwZShzZWxmKSwgKGxpc3Qoc2VsZiksIHNlbGYubWF4bGVuKQoKICAgIGRlZiBfX2hhc2hfXyhzZWxmKToKICAgICAgICAjcmFpc2UgVHlwZUVycm9yLCAiZGVxdWUgb2JqZWN0cyBhcmUgdW5oYXNoYWJsZSIKICAgICAgICByYWlzZSBUeXBlRXJyb3IoImRlcXVlIG9iamVjdHMgYXJlIHVuaGFzaGFibGUiKQoKICAgIGRlZiBfX2NvcHlfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZiwgc2VsZi5tYXhsZW4pCgogICAgIyBYWFggbWFrZSBjb21wYXJpc29uIG1vcmUgZWZmaWNpZW50CiAgICBkZWYgX19lcV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkZXF1ZSk6CiAgICAgICAgICAgIHJldHVybiBsaXN0KHNlbGYpID09IGxpc3Qob3RoZXIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCgogICAgZGVmIF9fbmVfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgZGVxdWUpOgogICAgICAgICAgICByZXR1cm4gbGlzdChzZWxmKSAhPSBsaXN0KG90aGVyKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgIGRlZiBfX2x0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIGRlcXVlKToKICAgICAgICAgICAgcmV0dXJuIGxpc3Qoc2VsZikgPCBsaXN0KG90aGVyKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgIGRlZiBfX2xlX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIGRlcXVlKToKICAgICAgICAgICAgcmV0dXJuIGxpc3Qoc2VsZikgPD0gbGlzdChvdGhlcikKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICBkZWYgX19ndF9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkZXF1ZSk6CiAgICAgICAgICAgIHJldHVybiBsaXN0KHNlbGYpID4gbGlzdChvdGhlcikKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICBkZWYgX19nZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkZXF1ZSk6CiAgICAgICAgICAgIHJldHVybiBsaXN0KHNlbGYpID49IGxpc3Qob3RoZXIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCgogICAgZGVmIF9faWFkZF9fKHNlbGYsIG90aGVyKToKICAgICAgICBzZWxmLmV4dGVuZChvdGhlcikKICAgICAgICByZXR1cm4gc2VsZgoKCmNsYXNzIGRlcXVlX2l0ZXJhdG9yKG9iamVjdCk6CgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGRlcSwgaXRlcmdlbik6CiAgICAgICAgc2VsZi5jb3VudGVyID0gbGVuKGRlcSkKICAgICAgICBkZWYgZ2l2ZXVwKCk6CiAgICAgICAgICAgIHNlbGYuY291bnRlciA9IDAKICAgICAgICAgICAgI3JhaXNlIFJ1bnRpbWVFcnJvciwgImRlcXVlIG11dGF0ZWQgZHVyaW5nIGl0ZXJhdGlvbiIKICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCJkZXF1ZSBtdXRhdGVkIGR1cmluZyBpdGVyYXRpb24iKQogICAgICAgIHNlbGYuX2dlbiA9IGl0ZXJnZW4oZGVxLnN0YXRlLCBnaXZldXApCgogICAgZGVmIG5leHQoc2VsZik6CiAgICAgICAgcmVzID0gIHNlbGYuX2dlbi5uZXh0KCkKICAgICAgICBzZWxmLmNvdW50ZXIgLT0gMQogICAgICAgIHJldHVybiByZXMKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCmNsYXNzIGRlZmF1bHRkaWN0KGRpY3QpOgogICAgCiAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dkcyk6CiAgICAgICAgaWYgbGVuKGFyZ3MpID4gMDoKICAgICAgICAgICAgZGVmYXVsdF9mYWN0b3J5ID0gYXJnc1swXQogICAgICAgICAgICBhcmdzID0gYXJnc1sxOl0KICAgICAgICAgICAgaWYgbm90IGNhbGxhYmxlKGRlZmF1bHRfZmFjdG9yeSkgYW5kIGRlZmF1bHRfZmFjdG9yeSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiZmlyc3QgYXJndW1lbnQgbXVzdCBiZSBjYWxsYWJsZSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZGVmYXVsdF9mYWN0b3J5ID0gTm9uZQogICAgICAgIGRpY3QuX19pbml0X18oc2VsZiwgYXJncywga3dkcykKICAgICAgICBzZWxmLmRlZmF1bHRfZmFjdG9yeSA9IGRlZmF1bHRfZmFjdG9yeQogICAgICAgIHNlbGYudXBkYXRlKGFyZ3MsIGt3ZHMpCiAgICAgICAgI3N1cGVyKGRlZmF1bHRkaWN0LCBzZWxmKS5fX2luaXRfXygqYXJncywgKiprd2RzKQoKICAgICNmaXhtZS4uICBoYWQgdG8gYWRkIHRoaXMgZnVuY3Rpb24gdG8gZ2V0IGRlZmF1bHRkaWN0IHdvcmtpbmcgd2l0aCBicnl0aG9uIGNvcnJlY3RseQogICAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGtleSk6CiAgICAgICAgaWYgc2VsZi5fX2NvbnRhaW5zX18oa2V5KTogIAogICAgICAgICAgIHJldHVybiBkaWN0Ll9fZ2V0aXRlbV9fKHNlbGYsa2V5KQogICAgCiAgICAgICAgcmV0dXJuIHNlbGYuX19taXNzaW5nX18oa2V5KQoKICAgIGRlZiBfX21pc3NpbmdfXyhzZWxmLCBrZXkpOgogICAgICAgICMgZnJvbSBkZWZhdWx0ZGljdCBkb2NzCiAgICAgICAgaWYgc2VsZi5kZWZhdWx0X2ZhY3RvcnkgaXMgTm9uZTogCiAgICAgICAgICAgIHJhaXNlIEtleUVycm9yKGtleSkKICAgICAgICBzZWxmW2tleV0gPSB2YWx1ZSA9IHNlbGYuZGVmYXVsdF9mYWN0b3J5KCkKICAgICAgICByZXR1cm4gdmFsdWUKCiAgICBkZWYgX19yZXByX18oc2VsZiwgcmVjdXJzZT1zZXQoKSk6CiAgICAgICAgaWYgaWQoc2VsZikgaW4gcmVjdXJzZToKICAgICAgICAgICAgcmV0dXJuICJkZWZhdWx0ZGljdCguLi4pIgogICAgICAgIHRyeToKICAgICAgICAgICAgcmVjdXJzZS5hZGQoaWQoc2VsZikpCiAgICAgICAgICAgIHJldHVybiAiZGVmYXVsdGRpY3QoJXMsICVzKSIgJSAocmVwcihzZWxmLmRlZmF1bHRfZmFjdG9yeSksIHN1cGVyKGRlZmF1bHRkaWN0LCBzZWxmKS5fX3JlcHJfXygpKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHJlY3Vyc2UucmVtb3ZlKGlkKHNlbGYpKQoKICAgIGRlZiBjb3B5KHNlbGYpOgogICAgICAgIHJldHVybiB0eXBlKHNlbGYpKHNlbGYuZGVmYXVsdF9mYWN0b3J5LCBzZWxmKQogICAgCiAgICBkZWYgX19jb3B5X18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuY29weSgpCgogICAgZGVmIF9fcmVkdWNlX18oc2VsZik6CiAgICAgICAgIwogICAgICAgICNfX3JlZHVjZV9fIG11c3QgcmV0dXJuIGEgNS10dXBsZSBhcyBmb2xsb3dzOgogICAgICAgICMKICAgICAgICAjICAgLSBmYWN0b3J5IGZ1bmN0aW9uCiAgICAgICAgIyAgIC0gdHVwbGUgb2YgYXJncyBmb3IgdGhlIGZhY3RvcnkgZnVuY3Rpb24KICAgICAgICAjICAgLSBhZGRpdGlvbmFsIHN0YXRlIChoZXJlIE5vbmUpCiAgICAgICAgIyAgIC0gc2VxdWVuY2UgaXRlcmF0b3IgKGhlcmUgTm9uZSkKICAgICAgICAjICAgLSBkaWN0aW9uYXJ5IGl0ZXJhdG9yICh5aWVsZGluZyBzdWNjZXNzaXZlIChrZXksIHZhbHVlKSBwYWlycwoKICAgICAgICAjICAgVGhpcyBBUEkgaXMgdXNlZCBieSBwaWNrbGUucHkgYW5kIGNvcHkucHkuCiAgICAgICAgIwogICAgICAgIHJldHVybiAodHlwZShzZWxmKSwgKHNlbGYuZGVmYXVsdF9mYWN0b3J5LCksIE5vbmUsIE5vbmUsIHNlbGYuaXRlcml0ZW1zKCkpCg==',
'/Lib/_dummy_thread.py':'IiIiRHJvcC1pbiByZXBsYWNlbWVudCBmb3IgdGhlIHRocmVhZCBtb2R1bGUuCgpNZWFudCB0byBiZSB1c2VkIGFzIGEgYnJhaW4tZGVhZCBzdWJzdGl0dXRlIHNvIHRoYXQgdGhyZWFkZWQgY29kZSBkb2VzCm5vdCBuZWVkIHRvIGJlIHJld3JpdHRlbiBmb3Igd2hlbiB0aGUgdGhyZWFkIG1vZHVsZSBpcyBub3QgcHJlc2VudC4KClN1Z2dlc3RlZCB1c2FnZSBpczo6CgogICAgdHJ5OgogICAgICAgIGltcG9ydCBfdGhyZWFkCiAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgaW1wb3J0IF9kdW1teV90aHJlYWQgYXMgX3RocmVhZAoKIiIiCiMgRXhwb3J0cyBvbmx5IHRoaW5ncyBzcGVjaWZpZWQgYnkgdGhyZWFkIGRvY3VtZW50YXRpb247CiMgc2tpcHBpbmcgb2Jzb2xldGUgc3lub255bXMgYWxsb2NhdGUoKSwgc3RhcnRfbmV3KCksIGV4aXRfdGhyZWFkKCkuCl9fYWxsX18gPSBbJ2Vycm9yJywgJ3N0YXJ0X25ld190aHJlYWQnLCAnZXhpdCcsICdnZXRfaWRlbnQnLCAnYWxsb2NhdGVfbG9jaycsCiAgICAgICAgICAgJ2ludGVycnVwdF9tYWluJywgJ0xvY2tUeXBlJ10KCiMgQSBkdW1teSB2YWx1ZQpUSU1FT1VUX01BWCA9IDIqKjMxCgojIE5PVEU6IHRoaXMgbW9kdWxlIGNhbiBiZSBpbXBvcnRlZCBlYXJseSBpbiB0aGUgZXh0ZW5zaW9uIGJ1aWxkaW5nIHByb2Nlc3MsCiMgYW5kIHNvIHRvcCBsZXZlbCBpbXBvcnRzIG9mIG90aGVyIG1vZHVsZXMgc2hvdWxkIGJlIGF2b2lkZWQuICBJbnN0ZWFkLCBhbGwKIyBpbXBvcnRzIGFyZSBkb25lIHdoZW4gbmVlZGVkIG9uIGEgZnVuY3Rpb24tYnktZnVuY3Rpb24gYmFzaXMuICBTaW5jZSB0aHJlYWRzCiMgYXJlIGRpc2FibGVkLCB0aGUgaW1wb3J0IGxvY2sgc2hvdWxkIG5vdCBiZSBhbiBpc3N1ZSBhbnl3YXkgKD8/KS4KCmVycm9yID0gUnVudGltZUVycm9yCgpkZWYgc3RhcnRfbmV3X3RocmVhZChmdW5jdGlvbiwgYXJncywga3dhcmdzPXt9KToKICAgICIiIkR1bW15IGltcGxlbWVudGF0aW9uIG9mIF90aHJlYWQuc3RhcnRfbmV3X3RocmVhZCgpLgoKICAgIENvbXBhdGliaWxpdHkgaXMgbWFpbnRhaW5lZCBieSBtYWtpbmcgc3VyZSB0aGF0IGBgYXJnc2BgIGlzIGEKICAgIHR1cGxlIGFuZCBgYGt3YXJnc2BgIGlzIGEgZGljdGlvbmFyeS4gIElmIGFuIGV4Y2VwdGlvbiBpcyByYWlzZWQKICAgIGFuZCBpdCBpcyBTeXN0ZW1FeGl0ICh3aGljaCBjYW4gYmUgZG9uZSBieSBfdGhyZWFkLmV4aXQoKSkgaXQgaXMKICAgIGNhdWdodCBhbmQgbm90aGluZyBpcyBkb25lOyBhbGwgb3RoZXIgZXhjZXB0aW9ucyBhcmUgcHJpbnRlZCBvdXQKICAgIGJ5IHVzaW5nIHRyYWNlYmFjay5wcmludF9leGMoKS4KCiAgICBJZiB0aGUgZXhlY3V0ZWQgZnVuY3Rpb24gY2FsbHMgaW50ZXJydXB0X21haW4gdGhlIEtleWJvYXJkSW50ZXJydXB0IHdpbGwgYmUKICAgIHJhaXNlZCB3aGVuIHRoZSBmdW5jdGlvbiByZXR1cm5zLgoKICAgICIiIgogICAgaWYgdHlwZShhcmdzKSAhPSB0eXBlKHR1cGxlKCkpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiMm5kIGFyZyBtdXN0IGJlIGEgdHVwbGUiKQogICAgaWYgdHlwZShrd2FyZ3MpICE9IHR5cGUoZGljdCgpKToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoIjNyZCBhcmcgbXVzdCBiZSBhIGRpY3QiKQogICAgZ2xvYmFsIF9tYWluCiAgICBfbWFpbiA9IEZhbHNlCiAgICB0cnk6CiAgICAgICAgZnVuY3Rpb24oKmFyZ3MsICoqa3dhcmdzKQogICAgZXhjZXB0IFN5c3RlbUV4aXQ6CiAgICAgICAgcGFzcwogICAgZXhjZXB0OgogICAgICAgIGltcG9ydCB0cmFjZWJhY2sKICAgICAgICB0cmFjZWJhY2sucHJpbnRfZXhjKCkKICAgIF9tYWluID0gVHJ1ZQogICAgZ2xvYmFsIF9pbnRlcnJ1cHQKICAgIGlmIF9pbnRlcnJ1cHQ6CiAgICAgICAgX2ludGVycnVwdCA9IEZhbHNlCiAgICAgICAgcmFpc2UgS2V5Ym9hcmRJbnRlcnJ1cHQKCmRlZiBleGl0KCk6CiAgICAiIiJEdW1teSBpbXBsZW1lbnRhdGlvbiBvZiBfdGhyZWFkLmV4aXQoKS4iIiIKICAgIHJhaXNlIFN5c3RlbUV4aXQKCmRlZiBnZXRfaWRlbnQoKToKICAgICIiIkR1bW15IGltcGxlbWVudGF0aW9uIG9mIF90aHJlYWQuZ2V0X2lkZW50KCkuCgogICAgU2luY2UgdGhpcyBtb2R1bGUgc2hvdWxkIG9ubHkgYmUgdXNlZCB3aGVuIF90aHJlYWRtb2R1bGUgaXMgbm90CiAgICBhdmFpbGFibGUsIGl0IGlzIHNhZmUgdG8gYXNzdW1lIHRoYXQgdGhlIGN1cnJlbnQgcHJvY2VzcyBpcyB0aGUKICAgIG9ubHkgdGhyZWFkLiAgVGh1cyBhIGNvbnN0YW50IGNhbiBiZSBzYWZlbHkgcmV0dXJuZWQuCiAgICAiIiIKICAgIHJldHVybiAtMQoKZGVmIGFsbG9jYXRlX2xvY2soKToKICAgICIiIkR1bW15IGltcGxlbWVudGF0aW9uIG9mIF90aHJlYWQuYWxsb2NhdGVfbG9jaygpLiIiIgogICAgcmV0dXJuIExvY2tUeXBlKCkKCmRlZiBzdGFja19zaXplKHNpemU9Tm9uZSk6CiAgICAiIiJEdW1teSBpbXBsZW1lbnRhdGlvbiBvZiBfdGhyZWFkLnN0YWNrX3NpemUoKS4iIiIKICAgIGlmIHNpemUgaXMgbm90IE5vbmU6CiAgICAgICAgcmFpc2UgZXJyb3IoInNldHRpbmcgdGhyZWFkIHN0YWNrIHNpemUgbm90IHN1cHBvcnRlZCIpCiAgICByZXR1cm4gMAoKY2xhc3MgTG9ja1R5cGUob2JqZWN0KToKICAgICIiIkNsYXNzIGltcGxlbWVudGluZyBkdW1teSBpbXBsZW1lbnRhdGlvbiBvZiBfdGhyZWFkLkxvY2tUeXBlLgoKICAgIENvbXBhdGliaWxpdHkgaXMgbWFpbnRhaW5lZCBieSBtYWludGFpbmluZyBzZWxmLmxvY2tlZF9zdGF0dXMKICAgIHdoaWNoIGlzIGEgYm9vbGVhbiB0aGF0IHN0b3JlcyB0aGUgc3RhdGUgb2YgdGhlIGxvY2suICBQaWNrbGluZyBvZgogICAgdGhlIGxvY2ssIHRob3VnaCwgc2hvdWxkIG5vdCBiZSBkb25lIHNpbmNlIGlmIHRoZSBfdGhyZWFkIG1vZHVsZSBpcwogICAgdGhlbiB1c2VkIHdpdGggYW4gdW5waWNrbGVkIGBgbG9jaygpYGAgZnJvbSBoZXJlIHByb2JsZW1zIGNvdWxkCiAgICBvY2N1ciBmcm9tIHRoaXMgY2xhc3Mgbm90IGhhdmluZyBhdG9taWMgbWV0aG9kcy4KCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi5sb2NrZWRfc3RhdHVzID0gRmFsc2UKCiAgICBkZWYgYWNxdWlyZShzZWxmLCB3YWl0ZmxhZz1Ob25lLCB0aW1lb3V0PS0xKToKICAgICAgICAiIiJEdW1teSBpbXBsZW1lbnRhdGlvbiBvZiBhY3F1aXJlKCkuCgogICAgICAgIEZvciBibG9ja2luZyBjYWxscywgc2VsZi5sb2NrZWRfc3RhdHVzIGlzIGF1dG9tYXRpY2FsbHkgc2V0IHRvCiAgICAgICAgVHJ1ZSBhbmQgcmV0dXJuZWQgYXBwcm9wcmlhdGVseSBiYXNlZCBvbiB2YWx1ZSBvZgogICAgICAgIGBgd2FpdGZsYWdgYC4gIElmIGl0IGlzIG5vbi1ibG9ja2luZywgdGhlbiB0aGUgdmFsdWUgaXMKICAgICAgICBhY3R1YWxseSBjaGVja2VkIGFuZCBub3Qgc2V0IGlmIGl0IGlzIGFscmVhZHkgYWNxdWlyZWQuICBUaGlzCiAgICAgICAgaXMgYWxsIGRvbmUgc28gdGhhdCB0aHJlYWRpbmcuQ29uZGl0aW9uJ3MgYXNzZXJ0IHN0YXRlbWVudHMKICAgICAgICBhcmVuJ3QgdHJpZ2dlcmVkIGFuZCB0aHJvdyBhIGxpdHRsZSBmaXQuCgogICAgICAgICIiIgogICAgICAgIGlmIHdhaXRmbGFnIGlzIE5vbmUgb3Igd2FpdGZsYWc6CiAgICAgICAgICAgIHNlbGYubG9ja2VkX3N0YXR1cyA9IFRydWUKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBub3Qgc2VsZi5sb2NrZWRfc3RhdHVzOgogICAgICAgICAgICAgICAgc2VsZi5sb2NrZWRfc3RhdHVzID0gVHJ1ZQogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIHRpbWVvdXQgPiAwOgogICAgICAgICAgICAgICAgICAgIGltcG9ydCB0aW1lCiAgICAgICAgICAgICAgICAgICAgdGltZS5zbGVlcCh0aW1lb3V0KQogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgX19lbnRlcl9fID0gYWNxdWlyZQoKICAgIGRlZiBfX2V4aXRfXyhzZWxmLCB0eXAsIHZhbCwgdGIpOgogICAgICAgIHNlbGYucmVsZWFzZSgpCgogICAgZGVmIHJlbGVhc2Uoc2VsZik6CiAgICAgICAgIiIiUmVsZWFzZSB0aGUgZHVtbXkgbG9jay4iIiIKICAgICAgICAjIFhYWCBQZXJoYXBzIHNob3VsZG4ndCBhY3R1YWxseSBib3RoZXIgdG8gdGVzdD8gIENvdWxkIGxlYWQKICAgICAgICAjICAgICB0byBwcm9ibGVtcyBmb3IgY29tcGxleCwgdGhyZWFkZWQgY29kZS4KICAgICAgICBpZiBub3Qgc2VsZi5sb2NrZWRfc3RhdHVzOgogICAgICAgICAgICByYWlzZSBlcnJvcgogICAgICAgIHNlbGYubG9ja2VkX3N0YXR1cyA9IEZhbHNlCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgbG9ja2VkKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmxvY2tlZF9zdGF0dXMKCiMgVXNlZCB0byBzaWduYWwgdGhhdCBpbnRlcnJ1cHRfbWFpbiB3YXMgY2FsbGVkIGluIGEgInRocmVhZCIKX2ludGVycnVwdCA9IEZhbHNlCiMgVHJ1ZSB3aGVuIG5vdCBleGVjdXRpbmcgaW4gYSAidGhyZWFkIgpfbWFpbiA9IFRydWUKCmRlZiBpbnRlcnJ1cHRfbWFpbigpOgogICAgIiIiU2V0IF9pbnRlcnJ1cHQgZmxhZyB0byBUcnVlIHRvIGhhdmUgc3RhcnRfbmV3X3RocmVhZCByYWlzZQogICAgS2V5Ym9hcmRJbnRlcnJ1cHQgdXBvbiBleGl0aW5nLiIiIgogICAgaWYgX21haW46CiAgICAgICAgcmFpc2UgS2V5Ym9hcmRJbnRlcnJ1cHQKICAgIGVsc2U6CiAgICAgICAgZ2xvYmFsIF9pbnRlcnJ1cHQKICAgICAgICBfaW50ZXJydXB0ID0gVHJ1ZQo=',
'/Lib/_random.py':'aW1wb3J0IF9vcwpjbGFzcyBSYW5kb206CiAgICAiIiJSYW5kb20gbnVtYmVyIGdlbmVyYXRvciBiYXNlIGNsYXNzIHVzZWQgYnkgYm91bmQgbW9kdWxlIGZ1bmN0aW9ucy4KCiAgICBVc2VkIHRvIGluc3RhbnRpYXRlIGluc3RhbmNlcyBvZiBSYW5kb20gdG8gZ2V0IGdlbmVyYXRvcnMgdGhhdCBkb24ndAogICAgc2hhcmUgc3RhdGUuCgogICAgQ2xhc3MgUmFuZG9tIGNhbiBhbHNvIGJlIHN1YmNsYXNzZWQgaWYgeW91IHdhbnQgdG8gdXNlIGEgZGlmZmVyZW50IGJhc2ljCiAgICBnZW5lcmF0b3Igb2YgeW91ciBvd24gZGV2aXNpbmc6IGluIHRoYXQgY2FzZSwgb3ZlcnJpZGUgdGhlIGZvbGxvd2luZwogICAgbWV0aG9kczogIHJhbmRvbSgpLCBzZWVkKCksIGdldHN0YXRlKCksIGFuZCBzZXRzdGF0ZSgpLgogICAgT3B0aW9uYWxseSwgaW1wbGVtZW50IGEgZ2V0cmFuZGJpdHMoKSBtZXRob2Qgc28gdGhhdCByYW5kcmFuZ2UoKQogICAgY2FuIGNvdmVyIGFyYml0cmFyaWx5IGxhcmdlIHJhbmdlcy4KCiAgICAiIiIKICAgICNyYW5kb20KICAgICNzZWVkCiAgICAjZ2V0c3RhdGUKICAgICNzZXRzdGF0ZQoKCiAgICBWRVJTSU9OID0gMyAgICAgIyB1c2VkIGJ5IGdldHN0YXRlL3NldHN0YXRlCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHg9Tm9uZSk6CiAgICAgICAgIiIiSW5pdGlhbGl6ZSBhbiBpbnN0YW5jZS4KCiAgICAgICAgT3B0aW9uYWwgYXJndW1lbnQgeCBjb250cm9scyBzZWVkaW5nLCBhcyBmb3IgUmFuZG9tLnNlZWQoKS4KICAgICAgICAiIiIKCiAgICAgICAgc2VsZi5fc3RhdGU9eAoKICAgIGRlZiBzZWVkKHNlbGYsIGE9Tm9uZSwgdmVyc2lvbj0yKToKICAgICAgICAiIiJJbml0aWFsaXplIGludGVybmFsIHN0YXRlIGZyb20gaGFzaGFibGUgb2JqZWN0LgoKICAgICAgICBOb25lIG9yIG5vIGFyZ3VtZW50IHNlZWRzIGZyb20gY3VycmVudCB0aW1lIG9yIGZyb20gYW4gb3BlcmF0aW5nCiAgICAgICAgc3lzdGVtIHNwZWNpZmljIHJhbmRvbW5lc3Mgc291cmNlIGlmIGF2YWlsYWJsZS4KCiAgICAgICAgRm9yIHZlcnNpb24gMiAodGhlIGRlZmF1bHQpLCBhbGwgb2YgdGhlIGJpdHMgYXJlIHVzZWQgaWYgKmEqIGlzIGEgc3RyLAogICAgICAgIGJ5dGVzLCBvciBieXRlYXJyYXkuICBGb3IgdmVyc2lvbiAxLCB0aGUgaGFzaCgpIG9mICphKiBpcyB1c2VkIGluc3RlYWQuCgogICAgICAgIElmICphKiBpcyBhbiBpbnQsIGFsbCBiaXRzIGFyZSB1c2VkLgoKICAgICAgICAiIiIKCiAgICAgICAgc2VsZi5fc3RhdGU9YQogICAgICAgIHNlbGYuZ2F1c3NfbmV4dCA9IE5vbmUKCiAgICBkZWYgZ2V0c3RhdGUoc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIGludGVybmFsIHN0YXRlOyBjYW4gYmUgcGFzc2VkIHRvIHNldHN0YXRlKCkgbGF0ZXIuIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX3N0YXRlCgogICAgZGVmIHNldHN0YXRlKHNlbGYsIHN0YXRlKToKICAgICAgICAiIiJSZXN0b3JlIGludGVybmFsIHN0YXRlIGZyb20gb2JqZWN0IHJldHVybmVkIGJ5IGdldHN0YXRlKCkuIiIiCiAgICAgICAgc2VsZi5fc3RhdGU9c3RhdGUKCiAgICBkZWYgcmFuZG9tKHNlbGYpOgogICAgICAgICIiIkdldCB0aGUgbmV4dCByYW5kb20gbnVtYmVyIGluIHRoZSByYW5nZSBbMC4wLCAxLjApLiIiIgogICAgICAgIHJldHVybiBfb3MucmFuZG9tKCkKCiAgICBkZWYgZ2V0cmFuZGJpdHMoc2VsZiwgayk6CiAgICAgICAgIiIiZ2V0cmFuZGJpdHMoaykgLT4geC4gIEdlbmVyYXRlcyBhIGxvbmcgaW50IHdpdGggayByYW5kb20gYml0cy4iIiIKICAgICAgICBpZiBrIDw9IDA6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoJ251bWJlciBvZiBiaXRzIG11c3QgYmUgZ3JlYXRlciB0aGFuIHplcm8nKQogICAgICAgIGlmIGsgIT0gaW50KGspOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ251bWJlciBvZiBiaXRzIHNob3VsZCBiZSBhbiBpbnRlZ2VyJykKICAgICAgICBudW1ieXRlcyA9IChrICsgNykgLy8gOCAgICAgICAgICAgICAgICAgICAgICAgIyBiaXRzIC8gOCBhbmQgcm91bmRlZCB1cAogICAgICAgIHggPSBpbnQuZnJvbV9ieXRlcyhfdXJhbmRvbShudW1ieXRlcyksICdiaWcnKQogICAgICAgIHJldHVybiB4ID4+IChudW1ieXRlcyAqIDggLSBrKSAgICAgICAgICAgICAgICAjIHRyaW0gZXhjZXNzIGJpdHMK',
'/Lib/_sre.py':'IyBOT1RfUlBZVEhPTgoiIiIKQSBwdXJlIFB5dGhvbiByZWltcGxlbWVudGF0aW9uIG9mIHRoZSBfc3JlIG1vZHVsZSBmcm9tIENQeXRob24gMi40CkNvcHlyaWdodCAyMDA1IE5payBIYWxkaW1hbm4sIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZQoKVGhpcyBjb2RlIGlzIGJhc2VkIG9uIG1hdGVyaWFsIGxpY2Vuc2VkIHVuZGVyIENOUkkncyBQeXRob24gMS42IGxpY2Vuc2UgYW5kCmNvcHlyaWdodGVkIGJ5OiBDb3B5cmlnaHQgKGMpIDE5OTctMjAwMSBieSBTZWNyZXQgTGFicyBBQgoKQWRhcHRlZCBmb3IgUHl0aG9uIDMgYnkgUGllcnJlIFF1ZW50ZWwKIiIiCgppbXBvcnQgYXJyYXksIG9wZXJhdG9yLCBzeXMKZnJvbSBzcmVfY29uc3RhbnRzIGltcG9ydCBBVENPREVTLCBPUENPREVTLCBDSENPREVTLCBNQVhSRVBFQVQKZnJvbSBzcmVfY29uc3RhbnRzIGltcG9ydCBTUkVfSU5GT19QUkVGSVgsIFNSRV9JTkZPX0xJVEVSQUwKZnJvbSBzcmVfY29uc3RhbnRzIGltcG9ydCBTUkVfRkxBR19VTklDT0RFLCBTUkVfRkxBR19MT0NBTEUKCgppbXBvcnQgc3lzCgojIElkZW50aWZ5aW5nIGFzIF9zcmUgZnJvbSBQeXRob24gMi4zIG9yIDIuNAppZiBzeXMudmVyc2lvbl9pbmZvWzoyXSA+PSAoMiwgNCk6CiAgICBNQUdJQyA9IDIwMDMxMDE3CmVsc2U6CiAgICBNQUdJQyA9IDIwMDMwNDE5CgojIEluIF9zcmUuYyB0aGlzIGlzIGJ5dGVzaXplIG9mIHRoZSBjb2RlIHdvcmQgdHlwZSBvZiB0aGUgQyBpbXBsZW1lbnRhdGlvbi4KIyBUaGVyZSBpdCdzIDIgZm9yIG5vcm1hbCBQeXRob24gYnVpbGRzIGFuZCBtb3JlIGZvciB3aWRlIHVuaWNvZGUgYnVpbGRzIChsYXJnZSAKIyBlbm91Z2ggdG8gaG9sZCBhIDMyLWJpdCBVQ1MtNCBlbmNvZGVkIGNoYXJhY3RlcikuIFNpbmNlIGhlcmUgaW4gcHVyZSBQeXRob24KIyB3ZSBvbmx5IHNlZSByZSBieXRlY29kZXMgYXMgUHl0aG9uIGxvbmdzLCB3ZSBzaG91bGRuJ3QgaGF2ZSB0byBjYXJlIGFib3V0IHRoZQojIGNvZGVzaXplLiBCdXQgc3JlX2NvbXBpbGUgd2lsbCBjb21waWxlIHNvbWUgc3R1ZmYgZGlmZmVyZW50bHkgZGVwZW5kaW5nIG9uIHRoZQojIGNvZGVzaXplIChlLmcuLCBjaGFyc2V0cykuCmlmIHN5cy5tYXh1bmljb2RlID09IDY1NTM1OgogICAgQ09ERVNJWkUgPSAyCmVsc2U6CiAgICBDT0RFU0laRSA9IDQKCmNvcHlyaWdodCA9ICJfc3JlLnB5IDIuNGMgQ29weXJpZ2h0IDIwMDUgYnkgTmlrIEhhbGRpbWFubiIKCgpkZWYgZ2V0Y29kZXNpemUoKToKICAgIHJldHVybiBDT0RFU0laRQoKCmRlZiBjb21waWxlKHBhdHRlcm4sIGZsYWdzLCBjb2RlLCBncm91cHM9MCwgZ3JvdXBpbmRleD17fSwgaW5kZXhncm91cD1bTm9uZV0pOgogICAgIiIiQ29tcGlsZXMgKG9yIHJhdGhlciBqdXN0IGNvbnZlcnRzKSBhIHBhdHRlcm4gZGVzY3JpcHRvciB0byBhIFNSRV9QYXR0ZXJuCiAgICBvYmplY3QuIEFjdHVhbCBjb21waWxhdGlvbiB0byBvcGNvZGVzIGhhcHBlbnMgaW4gc3JlX2NvbXBpbGUuIiIiCiAgICByZXR1cm4gU1JFX1BhdHRlcm4ocGF0dGVybiwgZmxhZ3MsIGNvZGUsIGdyb3VwcywgZ3JvdXBpbmRleCwgaW5kZXhncm91cCkKICAgIApkZWYgZ2V0bG93ZXIoY2hhcl9vcmQsIGZsYWdzKToKICAgIGlmIChjaGFyX29yZCA8IDEyOCkgb3IgKGZsYWdzICYgU1JFX0ZMQUdfVU5JQ09ERSkgXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvciAoZmxhZ3MgJiBTUkVfRkxBR19MT0NBTEUgYW5kIGNoYXJfb3JkIDwgMjU2KToKICAgICAgICByZXR1cm4gb3JkKHVuaWNocihjaGFyX29yZCkubG93ZXIoKSkKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIGNoYXJfb3JkCgoKY2xhc3MgU1JFX1BhdHRlcm4ob2JqZWN0KToKCiAgICBkZWYgX19pbml0X18oc2VsZiwgcGF0dGVybiwgZmxhZ3MsIGNvZGUsIGdyb3Vwcz0wLCBncm91cGluZGV4PXt9LCBpbmRleGdyb3VwPVtOb25lXSk6CiAgICAgICAgc2VsZi5wYXR0ZXJuID0gcGF0dGVybgogICAgICAgIHNlbGYuZmxhZ3MgPSBmbGFncwogICAgICAgIHNlbGYuZ3JvdXBzID0gZ3JvdXBzCiAgICAgICAgc2VsZi5ncm91cGluZGV4ID0gZ3JvdXBpbmRleCAjIE1hcHMgZ3JvdXAgbmFtZXMgdG8gZ3JvdXAgaW5kaWNlcwogICAgICAgIHNlbGYuX2luZGV4Z3JvdXAgPSBpbmRleGdyb3VwICMgTWFwcyBpbmRpY2VzIHRvIGdyb3VwIG5hbWVzCiAgICAgICAgc2VsZi5fY29kZSA9IGNvZGUKICAgIAogICAgZGVmIG1hdGNoKHNlbGYsIHN0cmluZywgcG9zPTAsIGVuZHBvcz1zeXMubWF4aW50KToKICAgICAgICAiIiJJZiB6ZXJvIG9yIG1vcmUgY2hhcmFjdGVycyBhdCB0aGUgYmVnaW5uaW5nIG9mIHN0cmluZyBtYXRjaCB0aGlzCiAgICAgICAgcmVndWxhciBleHByZXNzaW9uLCByZXR1cm4gYSBjb3JyZXNwb25kaW5nIE1hdGNoT2JqZWN0IGluc3RhbmNlLiBSZXR1cm4KICAgICAgICBOb25lIGlmIHRoZSBzdHJpbmcgZG9lcyBub3QgbWF0Y2ggdGhlIHBhdHRlcm4uIiIiCiAgICAgICAgc3RhdGUgPSBfU3RhdGUoc3RyaW5nLCBwb3MsIGVuZHBvcywgc2VsZi5mbGFncykKICAgICAgICBpZiBzdGF0ZS5tYXRjaChzZWxmLl9jb2RlKToKICAgICAgICAgICAgcmV0dXJuIFNSRV9NYXRjaChzZWxmLCBzdGF0ZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBzZWFyY2goc2VsZiwgc3RyaW5nLCBwb3M9MCwgZW5kcG9zPXN5cy5tYXhpbnQpOgogICAgICAgICIiIlNjYW4gdGhyb3VnaCBzdHJpbmcgbG9va2luZyBmb3IgYSBsb2NhdGlvbiB3aGVyZSB0aGlzIHJlZ3VsYXIKICAgICAgICBleHByZXNzaW9uIHByb2R1Y2VzIGEgbWF0Y2gsIGFuZCByZXR1cm4gYSBjb3JyZXNwb25kaW5nIE1hdGNoT2JqZWN0CiAgICAgICAgaW5zdGFuY2UuIFJldHVybiBOb25lIGlmIG5vIHBvc2l0aW9uIGluIHRoZSBzdHJpbmcgbWF0Y2hlcyB0aGUKICAgICAgICBwYXR0ZXJuLiIiIgogICAgICAgIHN0YXRlID0gX1N0YXRlKHN0cmluZywgcG9zLCBlbmRwb3MsIHNlbGYuZmxhZ3MpCiAgICAgICAgaWYgc3RhdGUuc2VhcmNoKHNlbGYuX2NvZGUpOgogICAgICAgICAgICByZXR1cm4gU1JFX01hdGNoKHNlbGYsIHN0YXRlKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBOb25lCgogICAgZGVmIGZpbmRhbGwoc2VsZiwgc3RyaW5nLCBwb3M9MCwgZW5kcG9zPXN5cy5tYXhpbnQpOgogICAgICAgICIiIlJldHVybiBhIGxpc3Qgb2YgYWxsIG5vbi1vdmVybGFwcGluZyBtYXRjaGVzIG9mIHBhdHRlcm4gaW4gc3RyaW5nLiIiIgogICAgICAgIG1hdGNobGlzdCA9IFtdCiAgICAgICAgc3RhdGUgPSBfU3RhdGUoc3RyaW5nLCBwb3MsIGVuZHBvcywgc2VsZi5mbGFncykKICAgICAgICB3aGlsZSBzdGF0ZS5zdGFydCA8PSBzdGF0ZS5lbmQ6CiAgICAgICAgICAgIHN0YXRlLnJlc2V0KCkKICAgICAgICAgICAgc3RhdGUuc3RyaW5nX3Bvc2l0aW9uID0gc3RhdGUuc3RhcnQKICAgICAgICAgICAgaWYgbm90IHN0YXRlLnNlYXJjaChzZWxmLl9jb2RlKToKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIG1hdGNoID0gU1JFX01hdGNoKHNlbGYsIHN0YXRlKQogICAgICAgICAgICBpZiBzZWxmLmdyb3VwcyA9PSAwIG9yIHNlbGYuZ3JvdXBzID09IDE6CiAgICAgICAgICAgICAgICBpdGVtID0gbWF0Y2guZ3JvdXAoc2VsZi5ncm91cHMpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpdGVtID0gbWF0Y2guZ3JvdXBzKCIiKQogICAgICAgICAgICBtYXRjaGxpc3QuYXBwZW5kKGl0ZW0pCiAgICAgICAgICAgIGlmIHN0YXRlLnN0cmluZ19wb3NpdGlvbiA9PSBzdGF0ZS5zdGFydDoKICAgICAgICAgICAgICAgIHN0YXRlLnN0YXJ0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHN0YXRlLnN0YXJ0ID0gc3RhdGUuc3RyaW5nX3Bvc2l0aW9uCiAgICAgICAgcmV0dXJuIG1hdGNobGlzdCAgICAgICAgCiAgICAgICAgCiAgICBkZWYgX3N1Yngoc2VsZiwgdGVtcGxhdGUsIHN0cmluZywgY291bnQ9MCwgc3Vibj1GYWxzZSk6CiAgICAgICAgZmlsdGVyID0gdGVtcGxhdGUKICAgICAgICBpZiBub3QgY2FsbGFibGUodGVtcGxhdGUpIGFuZCAiXFwiIGluIHRlbXBsYXRlOgogICAgICAgICAgICAjIGhhbmRsZSBub24tbGl0ZXJhbCBzdHJpbmdzIDsgaGFuZCBpdCBvdmVyIHRvIHRoZSB0ZW1wbGF0ZSBjb21waWxlcgogICAgICAgICAgICBpbXBvcnQgc3JlCiAgICAgICAgICAgIGZpbHRlciA9IHNyZS5fc3VieChzZWxmLCB0ZW1wbGF0ZSkKICAgICAgICBzdGF0ZSA9IF9TdGF0ZShzdHJpbmcsIDAsIHN5cy5tYXhpbnQsIHNlbGYuZmxhZ3MpCiAgICAgICAgc3VibGlzdCA9IFtdCiAgICAgICAgCiAgICAgICAgbiA9IGxhc3RfcG9zID0gMAogICAgICAgIHdoaWxlIG5vdCBjb3VudCBvciBuIDwgY291bnQ6CiAgICAgICAgICAgIHN0YXRlLnJlc2V0KCkKICAgICAgICAgICAgc3RhdGUuc3RyaW5nX3Bvc2l0aW9uID0gc3RhdGUuc3RhcnQKICAgICAgICAgICAgaWYgbm90IHN0YXRlLnNlYXJjaChzZWxmLl9jb2RlKToKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGlmIGxhc3RfcG9zIDwgc3RhdGUuc3RhcnQ6CiAgICAgICAgICAgICAgICBzdWJsaXN0LmFwcGVuZChzdHJpbmdbbGFzdF9wb3M6c3RhdGUuc3RhcnRdKQogICAgICAgICAgICBpZiBub3QgKGxhc3RfcG9zID09IHN0YXRlLnN0YXJ0IGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RfcG9zID09IHN0YXRlLnN0cmluZ19wb3NpdGlvbiBhbmQgbiA+IDApOgogICAgICAgICAgICAgICAgIyB0aGUgYWJvdmUgaWdub3JlcyBlbXB0eSBtYXRjaGVzIG9uIGxhdGVzdCBwb3NpdGlvbgogICAgICAgICAgICAgICAgaWYgY2FsbGFibGUoZmlsdGVyKToKICAgICAgICAgICAgICAgICAgICBzdWJsaXN0LmFwcGVuZChmaWx0ZXIoU1JFX01hdGNoKHNlbGYsIHN0YXRlKSkpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHN1Ymxpc3QuYXBwZW5kKGZpbHRlcikKICAgICAgICAgICAgICAgIGxhc3RfcG9zID0gc3RhdGUuc3RyaW5nX3Bvc2l0aW9uCiAgICAgICAgICAgICAgICBuICs9IDEKICAgICAgICAgICAgaWYgc3RhdGUuc3RyaW5nX3Bvc2l0aW9uID09IHN0YXRlLnN0YXJ0OgogICAgICAgICAgICAgICAgc3RhdGUuc3RhcnQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc3RhdGUuc3RhcnQgPSBzdGF0ZS5zdHJpbmdfcG9zaXRpb24KCiAgICAgICAgaWYgbGFzdF9wb3MgPCBzdGF0ZS5lbmQ6CiAgICAgICAgICAgIHN1Ymxpc3QuYXBwZW5kKHN0cmluZ1tsYXN0X3BvczpzdGF0ZS5lbmRdKQogICAgICAgIGl0ZW0gPSAiIi5qb2luKHN1Ymxpc3QpCiAgICAgICAgaWYgc3VibjoKICAgICAgICAgICAgcmV0dXJuIGl0ZW0sIG4KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gaXRlbQoKICAgIGRlZiBzdWIoc2VsZiwgcmVwbCwgc3RyaW5nLCBjb3VudD0wKToKICAgICAgICAiIiJSZXR1cm4gdGhlIHN0cmluZyBvYnRhaW5lZCBieSByZXBsYWNpbmcgdGhlIGxlZnRtb3N0IG5vbi1vdmVybGFwcGluZwogICAgICAgIG9jY3VycmVuY2VzIG9mIHBhdHRlcm4gaW4gc3RyaW5nIGJ5IHRoZSByZXBsYWNlbWVudCByZXBsLiIiIgogICAgICAgIHJldHVybiBzZWxmLl9zdWJ4KHJlcGwsIHN0cmluZywgY291bnQsIEZhbHNlKQoKICAgIGRlZiBzdWJuKHNlbGYsIHJlcGwsIHN0cmluZywgY291bnQ9MCk6CiAgICAgICAgIiIiUmV0dXJuIHRoZSB0dXBsZSAobmV3X3N0cmluZywgbnVtYmVyX29mX3N1YnNfbWFkZSkgZm91bmQgYnkgcmVwbGFjaW5nCiAgICAgICAgdGhlIGxlZnRtb3N0IG5vbi1vdmVybGFwcGluZyBvY2N1cnJlbmNlcyBvZiBwYXR0ZXJuIHdpdGggdGhlIHJlcGxhY2VtZW50CiAgICAgICAgcmVwbC4iIiIKICAgICAgICByZXR1cm4gc2VsZi5fc3VieChyZXBsLCBzdHJpbmcsIGNvdW50LCBUcnVlKQogICAgICAgIAogICAgZGVmIHNwbGl0KHNlbGYsIHN0cmluZywgbWF4c3BsaXQ9MCk6CiAgICAgICAgIiIiU3BsaXQgc3RyaW5nIGJ5IHRoZSBvY2N1cnJlbmNlcyBvZiBwYXR0ZXJuLiIiIgogICAgICAgIHNwbGl0bGlzdCA9IFtdCiAgICAgICAgc3RhdGUgPSBfU3RhdGUoc3RyaW5nLCAwLCBzeXMubWF4aW50LCBzZWxmLmZsYWdzKQogICAgICAgIG4gPSAwCiAgICAgICAgbGFzdCA9IHN0YXRlLnN0YXJ0CiAgICAgICAgd2hpbGUgbm90IG1heHNwbGl0IG9yIG4gPCBtYXhzcGxpdDoKICAgICAgICAgICAgc3RhdGUucmVzZXQoKQogICAgICAgICAgICBzdGF0ZS5zdHJpbmdfcG9zaXRpb24gPSBzdGF0ZS5zdGFydAogICAgICAgICAgICBpZiBub3Qgc3RhdGUuc2VhcmNoKHNlbGYuX2NvZGUpOgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgaWYgc3RhdGUuc3RhcnQgPT0gc3RhdGUuc3RyaW5nX3Bvc2l0aW9uOiAjIHplcm8td2lkdGggbWF0Y2gKICAgICAgICAgICAgICAgIGlmIGxhc3QgPT0gc3RhdGUuZW5kOiAgICAgICAgICAgICAgICAjIG9yIGVuZCBvZiBzdHJpbmcKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgc3RhdGUuc3RhcnQgKz0gMQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgc3BsaXRsaXN0LmFwcGVuZChzdHJpbmdbbGFzdDpzdGF0ZS5zdGFydF0pCiAgICAgICAgICAgICMgYWRkIGdyb3VwcyAoaWYgYW55KQogICAgICAgICAgICBpZiBzZWxmLmdyb3VwczoKICAgICAgICAgICAgICAgIG1hdGNoID0gU1JFX01hdGNoKHNlbGYsIHN0YXRlKQogICAgICAgICAgICAgICAgc3BsaXRsaXN0LmV4dGVuZChsaXN0KG1hdGNoLmdyb3VwcyhOb25lKSkpCiAgICAgICAgICAgIG4gKz0gMQogICAgICAgICAgICBsYXN0ID0gc3RhdGUuc3RhcnQgPSBzdGF0ZS5zdHJpbmdfcG9zaXRpb24KICAgICAgICBzcGxpdGxpc3QuYXBwZW5kKHN0cmluZ1tsYXN0OnN0YXRlLmVuZF0pCiAgICAgICAgcmV0dXJuIHNwbGl0bGlzdAoKICAgIGRlZiBmaW5kaXRlcihzZWxmLCBzdHJpbmcsIHBvcz0wLCBlbmRwb3M9c3lzLm1heGludCk6CiAgICAgICAgIiIiUmV0dXJuIGEgbGlzdCBvZiBhbGwgbm9uLW92ZXJsYXBwaW5nIG1hdGNoZXMgb2YgcGF0dGVybiBpbiBzdHJpbmcuIiIiCiAgICAgICAgc2Nhbm5lciA9IHNlbGYuc2Nhbm5lcihzdHJpbmcsIHBvcywgZW5kcG9zKQogICAgICAgIHJldHVybiBpdGVyKHNjYW5uZXIuc2VhcmNoLCBOb25lKQoKICAgIGRlZiBzY2FubmVyKHNlbGYsIHN0cmluZywgc3RhcnQ9MCwgZW5kPXN5cy5tYXhpbnQpOgogICAgICAgIHJldHVybiBTUkVfU2Nhbm5lcihzZWxmLCBzdHJpbmcsIHN0YXJ0LCBlbmQpCiAgICAKICAgIGRlZiBfX2NvcHlfXyhzZWxmKToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoImNhbm5vdCBjb3B5IHRoaXMgcGF0dGVybiBvYmplY3QiKQoKICAgIGRlZiBfX2RlZXBjb3B5X18oc2VsZik6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJjYW5ub3QgY29weSB0aGlzIHBhdHRlcm4gb2JqZWN0IikKCgpjbGFzcyBTUkVfU2Nhbm5lcihvYmplY3QpOgogICAgIiIiVW5kb2N1bWVudGVkIHNjYW5uZXIgaW50ZXJmYWNlIG9mIHNyZS4iIiIKICAgIAogICAgZGVmIF9faW5pdF9fKHNlbGYsIHBhdHRlcm4sIHN0cmluZywgc3RhcnQsIGVuZCk6CiAgICAgICAgc2VsZi5wYXR0ZXJuID0gcGF0dGVybgogICAgICAgIHNlbGYuX3N0YXRlID0gX1N0YXRlKHN0cmluZywgc3RhcnQsIGVuZCwgc2VsZi5wYXR0ZXJuLmZsYWdzKQoKICAgIGRlZiBfbWF0Y2hfc2VhcmNoKHNlbGYsIG1hdGNoZXIpOgogICAgICAgIHN0YXRlID0gc2VsZi5fc3RhdGUKICAgICAgICBzdGF0ZS5yZXNldCgpCiAgICAgICAgc3RhdGUuc3RyaW5nX3Bvc2l0aW9uID0gc3RhdGUuc3RhcnQKICAgICAgICBtYXRjaCA9IE5vbmUKICAgICAgICBpZiBtYXRjaGVyKHNlbGYucGF0dGVybi5fY29kZSk6CiAgICAgICAgICAgIG1hdGNoID0gU1JFX01hdGNoKHNlbGYucGF0dGVybiwgc3RhdGUpCiAgICAgICAgaWYgbWF0Y2ggaXMgTm9uZSBvciBzdGF0ZS5zdHJpbmdfcG9zaXRpb24gPT0gc3RhdGUuc3RhcnQ6CiAgICAgICAgICAgIHN0YXRlLnN0YXJ0ICs9IDEKICAgICAgICBlbHNlOgogICAgICAgICAgICBzdGF0ZS5zdGFydCA9IHN0YXRlLnN0cmluZ19wb3NpdGlvbgogICAgICAgIHJldHVybiBtYXRjaAoKICAgIGRlZiBtYXRjaChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fbWF0Y2hfc2VhcmNoKHNlbGYuX3N0YXRlLm1hdGNoKQoKICAgIGRlZiBzZWFyY2goc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX21hdGNoX3NlYXJjaChzZWxmLl9zdGF0ZS5zZWFyY2gpCgoKY2xhc3MgU1JFX01hdGNoKG9iamVjdCk6CgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHBhdHRlcm4sIHN0YXRlKToKICAgICAgICBzZWxmLnJlID0gcGF0dGVybgogICAgICAgIHNlbGYuc3RyaW5nID0gc3RhdGUuc3RyaW5nCiAgICAgICAgc2VsZi5wb3MgPSBzdGF0ZS5wb3MKICAgICAgICBzZWxmLmVuZHBvcyA9IHN0YXRlLmVuZAogICAgICAgIHNlbGYubGFzdGluZGV4ID0gc3RhdGUubGFzdGluZGV4CiAgICAgICAgaWYgc2VsZi5sYXN0aW5kZXggPCAwOgogICAgICAgICAgICBzZWxmLmxhc3RpbmRleCA9IE5vbmUKICAgICAgICBzZWxmLnJlZ3MgPSBzZWxmLl9jcmVhdGVfcmVncyhzdGF0ZSkKICAgICAgICBpZiBwYXR0ZXJuLl9pbmRleGdyb3VwIGFuZCAwIDw9IHNlbGYubGFzdGluZGV4IDwgbGVuKHBhdHRlcm4uX2luZGV4Z3JvdXApOgogICAgICAgICAgICAjIFRoZSBhYm92ZSB1cHBlci1ib3VuZCBjaGVjayBzaG91bGQgbm90IGJlIG5lY2Vzc2FyeSwgYXMgdGhlIHJlCiAgICAgICAgICAgICMgY29tcGlsZXIgaXMgc3VwcG9zZWQgdG8gYWx3YXlzIHByb3ZpZGUgYW4gX2luZGV4Z3JvdXAgbGlzdCBsb25nCiAgICAgICAgICAgICMgZW5vdWdoLiBCdXQgdGhlIHJlLlNjYW5uZXIgY2xhc3Mgc2VlbXMgdG8gc2NyZXcgdXAgc29tZXRoaW5nCiAgICAgICAgICAgICMgdGhlcmUsIHRlc3Rfc2Nhbm5lciBpbiB0ZXN0X3JlIHdvbid0IHdvcmsgd2l0aG91dCB1cHBlci1ib3VuZAogICAgICAgICAgICAjIGNoZWNraW5nLiBYWFggaW52ZXN0aWdhdGUgdGhpcyBhbmQgcmVwb3J0IGJ1ZyB0byBDUHl0aG9uLgogICAgICAgICAgICBzZWxmLmxhc3Rncm91cCA9IHBhdHRlcm4uX2luZGV4Z3JvdXBbc2VsZi5sYXN0aW5kZXhdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5sYXN0Z3JvdXAgPSBOb25lCgogICAgZGVmIF9jcmVhdGVfcmVncyhzZWxmLCBzdGF0ZSk6CiAgICAgICAgIiIiQ3JlYXRlcyBhIHR1cGxlIG9mIGluZGV4IHBhaXJzIHJlcHJlc2VudGluZyBtYXRjaGVkIGdyb3Vwcy4iIiIKICAgICAgICByZWdzID0gWyhzdGF0ZS5zdGFydCwgc3RhdGUuc3RyaW5nX3Bvc2l0aW9uKV0KICAgICAgICBmb3IgZ3JvdXAgaW4gcmFuZ2Uoc2VsZi5yZS5ncm91cHMpOgogICAgICAgICAgICBtYXJrX2luZGV4ID0gMiAqIGdyb3VwCiAgICAgICAgICAgIGlmIG1hcmtfaW5kZXggKyAxIDwgbGVuKHN0YXRlLm1hcmtzKSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZCBzdGF0ZS5tYXJrc1ttYXJrX2luZGV4XSBpcyBub3QgTm9uZSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZCBzdGF0ZS5tYXJrc1ttYXJrX2luZGV4ICsgMV0gaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICByZWdzLmFwcGVuZCgoc3RhdGUubWFya3NbbWFya19pbmRleF0sIHN0YXRlLm1hcmtzW21hcmtfaW5kZXggKyAxXSkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZWdzLmFwcGVuZCgoLTEsIC0xKSkKICAgICAgICByZXR1cm4gdHVwbGUocmVncykKCiAgICBkZWYgX2dldF9pbmRleChzZWxmLCBncm91cCk6CiAgICAgICAgaWYgaXNpbnN0YW5jZShncm91cCwgaW50KToKICAgICAgICAgICAgaWYgZ3JvdXAgPj0gMCBhbmQgZ3JvdXAgPD0gc2VsZi5yZS5ncm91cHM6CiAgICAgICAgICAgICAgICByZXR1cm4gZ3JvdXAKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBzZWxmLnJlLmdyb3VwaW5kZXguaGFzX2tleShncm91cCk6CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5yZS5ncm91cGluZGV4W2dyb3VwXQogICAgICAgIHJhaXNlIEluZGV4RXJyb3IoIm5vIHN1Y2ggZ3JvdXAiKQoKICAgIGRlZiBfZ2V0X3NsaWNlKHNlbGYsIGdyb3VwLCBkZWZhdWx0KToKICAgICAgICBncm91cF9pbmRpY2VzID0gc2VsZi5yZWdzW2dyb3VwXQogICAgICAgIGlmIGdyb3VwX2luZGljZXNbMF0gPj0gMDoKICAgICAgICAgICAgcmV0dXJuIHNlbGYuc3RyaW5nW2dyb3VwX2luZGljZXNbMF06Z3JvdXBfaW5kaWNlc1sxXV0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gZGVmYXVsdAoKICAgIGRlZiBzdGFydChzZWxmLCBncm91cD0wKToKICAgICAgICAiIiJSZXR1cm5zIHRoZSBpbmRpY2VzIG9mIHRoZSBzdGFydCBvZiB0aGUgc3Vic3RyaW5nIG1hdGNoZWQgYnkgZ3JvdXA7CiAgICAgICAgZ3JvdXAgZGVmYXVsdHMgdG8gemVybyAobWVhbmluZyB0aGUgd2hvbGUgbWF0Y2hlZCBzdWJzdHJpbmcpLiBSZXR1cm5zIC0xCiAgICAgICAgaWYgZ3JvdXAgZXhpc3RzIGJ1dCBkaWQgbm90IGNvbnRyaWJ1dGUgdG8gdGhlIG1hdGNoLiIiIgogICAgICAgIHJldHVybiBzZWxmLnJlZ3Nbc2VsZi5fZ2V0X2luZGV4KGdyb3VwKV1bMF0KCiAgICBkZWYgZW5kKHNlbGYsIGdyb3VwPTApOgogICAgICAgICIiIlJldHVybnMgdGhlIGluZGljZXMgb2YgdGhlIGVuZCBvZiB0aGUgc3Vic3RyaW5nIG1hdGNoZWQgYnkgZ3JvdXA7CiAgICAgICAgZ3JvdXAgZGVmYXVsdHMgdG8gemVybyAobWVhbmluZyB0aGUgd2hvbGUgbWF0Y2hlZCBzdWJzdHJpbmcpLiBSZXR1cm5zIC0xCiAgICAgICAgaWYgZ3JvdXAgZXhpc3RzIGJ1dCBkaWQgbm90IGNvbnRyaWJ1dGUgdG8gdGhlIG1hdGNoLiIiIgogICAgICAgIHJldHVybiBzZWxmLnJlZ3Nbc2VsZi5fZ2V0X2luZGV4KGdyb3VwKV1bMV0KCiAgICBkZWYgc3BhbihzZWxmLCBncm91cD0wKToKICAgICAgICAiIiJSZXR1cm5zIHRoZSAyLXR1cGxlIChtLnN0YXJ0KGdyb3VwKSwgbS5lbmQoZ3JvdXApKS4iIiIKICAgICAgICByZXR1cm4gc2VsZi5zdGFydChncm91cCksIHNlbGYuZW5kKGdyb3VwKQogICAgICAgIAogICAgZGVmIGV4cGFuZChzZWxmLCB0ZW1wbGF0ZSk6CiAgICAgICAgIiIiUmV0dXJuIHRoZSBzdHJpbmcgb2J0YWluZWQgYnkgZG9pbmcgYmFja3NsYXNoIHN1YnN0aXR1dGlvbiBhbmQKICAgICAgICByZXNvbHZpbmcgZ3JvdXAgcmVmZXJlbmNlcyBvbiB0ZW1wbGF0ZS4iIiIKICAgICAgICBpbXBvcnQgc3JlCiAgICAgICAgcmV0dXJuIHNyZS5fZXhwYW5kKHNlbGYucmUsIHNlbGYsIHRlbXBsYXRlKQogICAgICAgIAogICAgZGVmIGdyb3VwcyhzZWxmLCBkZWZhdWx0PU5vbmUpOgogICAgICAgICIiIlJldHVybnMgYSB0dXBsZSBjb250YWluaW5nIGFsbCB0aGUgc3ViZ3JvdXBzIG9mIHRoZSBtYXRjaC4gVGhlCiAgICAgICAgZGVmYXVsdCBhcmd1bWVudCBpcyB1c2VkIGZvciBncm91cHMgdGhhdCBkaWQgbm90IHBhcnRpY2lwYXRlIGluIHRoZQogICAgICAgIG1hdGNoIChkZWZhdWx0cyB0byBOb25lKS4iIiIKICAgICAgICBncm91cHMgPSBbXQogICAgICAgIGZvciBpbmRpY2VzIGluIHNlbGYucmVnc1sxOl06CiAgICAgICAgICAgIGlmIGluZGljZXNbMF0gPj0gMDoKICAgICAgICAgICAgICAgIGdyb3Vwcy5hcHBlbmQoc2VsZi5zdHJpbmdbaW5kaWNlc1swXTppbmRpY2VzWzFdXSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGdyb3Vwcy5hcHBlbmQoZGVmYXVsdCkKICAgICAgICByZXR1cm4gdHVwbGUoZ3JvdXBzKQogICAgICAgIAogICAgZGVmIGdyb3VwZGljdChzZWxmLCBkZWZhdWx0PU5vbmUpOgogICAgICAgICIiIlJldHVybiBhIGRpY3Rpb25hcnkgY29udGFpbmluZyBhbGwgdGhlIG5hbWVkIHN1Ymdyb3VwcyBvZiB0aGUgbWF0Y2guCiAgICAgICAgVGhlIGRlZmF1bHQgYXJndW1lbnQgaXMgdXNlZCBmb3IgZ3JvdXBzIHRoYXQgZGlkIG5vdCBwYXJ0aWNpcGF0ZSBpbiB0aGUKICAgICAgICBtYXRjaCAoZGVmYXVsdHMgdG8gTm9uZSkuIiIiCiAgICAgICAgZ3JvdXBkaWN0ID0ge30KICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBzZWxmLnJlLmdyb3VwaW5kZXguaXRlbXMoKToKICAgICAgICAgICAgZ3JvdXBkaWN0W2tleV0gPSBzZWxmLl9nZXRfc2xpY2UodmFsdWUsIGRlZmF1bHQpCiAgICAgICAgcmV0dXJuIGdyb3VwZGljdAoKICAgIGRlZiBncm91cChzZWxmLCAqYXJncyk6CiAgICAgICAgIiIiUmV0dXJucyBvbmUgb3IgbW9yZSBzdWJncm91cHMgb2YgdGhlIG1hdGNoLiBFYWNoIGFyZ3VtZW50IGlzIGVpdGhlciBhCiAgICAgICAgZ3JvdXAgaW5kZXggb3IgYSBncm91cCBuYW1lLiIiIgogICAgICAgIGlmIGxlbihhcmdzKSA9PSAwOgogICAgICAgICAgICBhcmdzID0gKDAsKQogICAgICAgIGdyb3VwbGlzdCA9IFtdCiAgICAgICAgZm9yIGdyb3VwIGluIGFyZ3M6CiAgICAgICAgICAgIGdyb3VwbGlzdC5hcHBlbmQoc2VsZi5fZ2V0X3NsaWNlKHNlbGYuX2dldF9pbmRleChncm91cCksIE5vbmUpKQogICAgICAgIGlmIGxlbihncm91cGxpc3QpID09IDE6CiAgICAgICAgICAgIHJldHVybiBncm91cGxpc3RbMF0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gdHVwbGUoZ3JvdXBsaXN0KQoKICAgIGRlZiBfX2NvcHlfXygpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvciggImNhbm5vdCBjb3B5IHRoaXMgcGF0dGVybiBvYmplY3QiKQoKICAgIGRlZiBfX2RlZXBjb3B5X18oKToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoImNhbm5vdCBjb3B5IHRoaXMgcGF0dGVybiBvYmplY3QiKQoKCmNsYXNzIF9TdGF0ZShvYmplY3QpOgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzdHJpbmcsIHN0YXJ0LCBlbmQsIGZsYWdzKToKICAgICAgICBzZWxmLnN0cmluZyA9IHN0cmluZwogICAgICAgIGlmIHN0YXJ0IDwgMDoKICAgICAgICAgICAgc3RhcnQgPSAwCiAgICAgICAgaWYgZW5kID4gbGVuKHN0cmluZyk6CiAgICAgICAgICAgIGVuZCA9IGxlbihzdHJpbmcpCiAgICAgICAgc2VsZi5zdGFydCA9IHN0YXJ0CiAgICAgICAgc2VsZi5zdHJpbmdfcG9zaXRpb24gPSBzZWxmLnN0YXJ0CiAgICAgICAgc2VsZi5lbmQgPSBlbmQKICAgICAgICBzZWxmLnBvcyA9IHN0YXJ0CiAgICAgICAgc2VsZi5mbGFncyA9IGZsYWdzCiAgICAgICAgc2VsZi5yZXNldCgpCgogICAgZGVmIHJlc2V0KHNlbGYpOgogICAgICAgIHNlbGYubWFya3MgPSBbXQogICAgICAgIHNlbGYubGFzdGluZGV4ID0gLTEKICAgICAgICBzZWxmLm1hcmtzX3N0YWNrID0gW10KICAgICAgICBzZWxmLmNvbnRleHRfc3RhY2sgPSBbXQogICAgICAgIHNlbGYucmVwZWF0ID0gTm9uZQoKICAgIGRlZiBtYXRjaChzZWxmLCBwYXR0ZXJuX2NvZGVzKToKICAgICAgICAjIE9wdGltaXphdGlvbjogQ2hlY2sgc3RyaW5nIGxlbmd0aC4gcGF0dGVybl9jb2Rlc1szXSBjb250YWlucyB0aGUKICAgICAgICAjIG1pbmltdW0gbGVuZ3RoIGZvciBhIHN0cmluZyB0byBwb3NzaWJseSBtYXRjaC4KICAgICAgICBpZiBwYXR0ZXJuX2NvZGVzWzBdID09IE9QQ09ERVNbImluZm8iXSBhbmQgcGF0dGVybl9jb2Rlc1szXToKICAgICAgICAgICAgaWYgc2VsZi5lbmQgLSBzZWxmLnN0cmluZ19wb3NpdGlvbiA8IHBhdHRlcm5fY29kZXNbM106CiAgICAgICAgICAgICAgICAjX2xvZygicmVqZWN0IChnb3QgJWQgY2hhcnMsIG5lZWQgJWQpIgogICAgICAgICAgICAgICAgIyAgICAgICAgICUgKHNlbGYuZW5kIC0gc2VsZi5zdHJpbmdfcG9zaXRpb24sIHBhdHRlcm5fY29kZXNbM10pKQogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgCiAgICAgICAgZGlzcGF0Y2hlciA9IF9PcGNvZGVEaXNwYXRjaGVyKCkKICAgICAgICBzZWxmLmNvbnRleHRfc3RhY2suYXBwZW5kKF9NYXRjaENvbnRleHQoc2VsZiwgcGF0dGVybl9jb2RlcykpCiAgICAgICAgaGFzX21hdGNoZWQgPSBOb25lCiAgICAgICAgd2hpbGUgbGVuKHNlbGYuY29udGV4dF9zdGFjaykgPiAwOgogICAgICAgICAgICBjb250ZXh0ID0gc2VsZi5jb250ZXh0X3N0YWNrWy0xXQogICAgICAgICAgICBoYXNfbWF0Y2hlZCA9IGRpc3BhdGNoZXIubWF0Y2goY29udGV4dCkKICAgICAgICAgICAgaWYgaGFzX21hdGNoZWQgaXMgbm90IE5vbmU6ICMgZG9uJ3QgcG9wIGlmIGNvbnRleHQgaXNuJ3QgZG9uZQogICAgICAgICAgICAgICAgc2VsZi5jb250ZXh0X3N0YWNrLnBvcCgpCiAgICAgICAgcmV0dXJuIGhhc19tYXRjaGVkCgogICAgZGVmIHNlYXJjaChzZWxmLCBwYXR0ZXJuX2NvZGVzKToKICAgICAgICBmbGFncyA9IDAKICAgICAgICBpZiBwYXR0ZXJuX2NvZGVzWzBdID09IE9QQ09ERVNbImluZm8iXToKICAgICAgICAgICAgIyBvcHRpbWl6YXRpb24gaW5mbyBibG9jawogICAgICAgICAgICAjIDxJTkZPPiA8MT1za2lwPiA8Mj1mbGFncz4gPDM9bWluPiA8ND1tYXg+IDw1PXByZWZpeCBpbmZvPgogICAgICAgICAgICBpZiBwYXR0ZXJuX2NvZGVzWzJdICYgU1JFX0lORk9fUFJFRklYIGFuZCBwYXR0ZXJuX2NvZGVzWzVdID4gMToKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmZhc3Rfc2VhcmNoKHBhdHRlcm5fY29kZXMpCiAgICAgICAgICAgIGZsYWdzID0gcGF0dGVybl9jb2Rlc1syXQogICAgICAgICAgICBwYXR0ZXJuX2NvZGVzID0gcGF0dGVybl9jb2Rlc1twYXR0ZXJuX2NvZGVzWzFdICsgMTpdCgogICAgICAgIHN0cmluZ19wb3NpdGlvbiA9IHNlbGYuc3RhcnQKICAgICAgICBpZiBwYXR0ZXJuX2NvZGVzWzBdID09IE9QQ09ERVNbImxpdGVyYWwiXToKICAgICAgICAgICAgIyBTcGVjaWFsIGNhc2U6IFBhdHRlcm4gc3RhcnRzIHdpdGggYSBsaXRlcmFsIGNoYXJhY3Rlci4gVGhpcyBpcwogICAgICAgICAgICAjIHVzZWQgZm9yIHNob3J0IHByZWZpeGVzCiAgICAgICAgICAgIGNoYXJhY3RlciA9IHBhdHRlcm5fY29kZXNbMV0KICAgICAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgICAgIHdoaWxlIHN0cmluZ19wb3NpdGlvbiA8IHNlbGYuZW5kIFwKICAgICAgICAgICAgICAgICAgICAgICAgYW5kIG9yZChzZWxmLnN0cmluZ1tzdHJpbmdfcG9zaXRpb25dKSAhPSBjaGFyYWN0ZXI6CiAgICAgICAgICAgICAgICAgICAgc3RyaW5nX3Bvc2l0aW9uICs9IDEKICAgICAgICAgICAgICAgIGlmIHN0cmluZ19wb3NpdGlvbiA+PSBzZWxmLmVuZDoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgICAgIHNlbGYuc3RhcnQgPSBzdHJpbmdfcG9zaXRpb24KICAgICAgICAgICAgICAgIHN0cmluZ19wb3NpdGlvbiArPSAxCiAgICAgICAgICAgICAgICBzZWxmLnN0cmluZ19wb3NpdGlvbiA9IHN0cmluZ19wb3NpdGlvbgogICAgICAgICAgICAgICAgaWYgZmxhZ3MgJiBTUkVfSU5GT19MSVRFUkFMOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgICAgICAgICBpZiBzZWxmLm1hdGNoKHBhdHRlcm5fY29kZXNbMjpdKToKICAgICAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAgICAgIyBHZW5lcmFsIGNhc2UKICAgICAgICB3aGlsZSBzdHJpbmdfcG9zaXRpb24gPD0gc2VsZi5lbmQ6CiAgICAgICAgICAgIHNlbGYucmVzZXQoKQogICAgICAgICAgICBzZWxmLnN0YXJ0ID0gc2VsZi5zdHJpbmdfcG9zaXRpb24gPSBzdHJpbmdfcG9zaXRpb24KICAgICAgICAgICAgaWYgc2VsZi5tYXRjaChwYXR0ZXJuX2NvZGVzKToKICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgICAgIHN0cmluZ19wb3NpdGlvbiArPSAxCiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIGZhc3Rfc2VhcmNoKHNlbGYsIHBhdHRlcm5fY29kZXMpOgogICAgICAgICIiIlNraXBzIGZvcndhcmQgaW4gYSBzdHJpbmcgYXMgZmFzdCBhcyBwb3NzaWJsZSB1c2luZyBpbmZvcm1hdGlvbiBmcm9tCiAgICAgICAgYW4gb3B0aW1pemF0aW9uIGluZm8gYmxvY2suIiIiCiAgICAgICAgIyBwYXR0ZXJuIHN0YXJ0cyB3aXRoIGEga25vd24gcHJlZml4CiAgICAgICAgIyA8NT1sZW5ndGg+IDw2PXNraXA+IDw3PXByZWZpeCBkYXRhPiA8b3ZlcmxhcCBkYXRhPgogICAgICAgIGZsYWdzID0gcGF0dGVybl9jb2Rlc1syXQogICAgICAgIHByZWZpeF9sZW4gPSBwYXR0ZXJuX2NvZGVzWzVdCiAgICAgICAgcHJlZml4X3NraXAgPSBwYXR0ZXJuX2NvZGVzWzZdICMgZG9uJ3QgcmVhbGx5IGtub3cgd2hhdCB0aGlzIGlzIGdvb2QgZm9yCiAgICAgICAgcHJlZml4ID0gcGF0dGVybl9jb2Rlc1s3OjcgKyBwcmVmaXhfbGVuXQogICAgICAgIG92ZXJsYXAgPSBwYXR0ZXJuX2NvZGVzWzcgKyBwcmVmaXhfbGVuIC0gMTpwYXR0ZXJuX2NvZGVzWzFdICsgMV0KICAgICAgICBwYXR0ZXJuX2NvZGVzID0gcGF0dGVybl9jb2Rlc1twYXR0ZXJuX2NvZGVzWzFdICsgMTpdCiAgICAgICAgaSA9IDAKICAgICAgICBzdHJpbmdfcG9zaXRpb24gPSBzZWxmLnN0cmluZ19wb3NpdGlvbgogICAgICAgIHdoaWxlIHN0cmluZ19wb3NpdGlvbiA8IHNlbGYuZW5kOgogICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgaWYgb3JkKHNlbGYuc3RyaW5nW3N0cmluZ19wb3NpdGlvbl0pICE9IHByZWZpeFtpXToKICAgICAgICAgICAgICAgICAgICBpZiBpID09IDA6CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgaSA9IG92ZXJsYXBbaV0KICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgaSArPSAxCiAgICAgICAgICAgICAgICAgICAgaWYgaSA9PSBwcmVmaXhfbGVuOgogICAgICAgICAgICAgICAgICAgICAgICAjIGZvdW5kIGEgcG90ZW50aWFsIG1hdGNoCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc3RhcnQgPSBzdHJpbmdfcG9zaXRpb24gKyAxIC0gcHJlZml4X2xlbgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnN0cmluZ19wb3NpdGlvbiA9IHN0cmluZ19wb3NpdGlvbiArIDEgXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gcHJlZml4X2xlbiArIHByZWZpeF9za2lwCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGZsYWdzICYgU1JFX0lORk9fTElURVJBTDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBUcnVlICMgbWF0Y2hlZCBhbGwgb2YgcHVyZSBsaXRlcmFsIHBhdHRlcm4KICAgICAgICAgICAgICAgICAgICAgICAgaWYgc2VsZi5tYXRjaChwYXR0ZXJuX2NvZGVzWzIgKiBwcmVmaXhfc2tpcDpdKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBvdmVybGFwW2ldCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgc3RyaW5nX3Bvc2l0aW9uICs9IDEKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgc2V0X21hcmsoc2VsZiwgbWFya19uciwgcG9zaXRpb24pOgogICAgICAgIGlmIG1hcmtfbnIgJiAxOgogICAgICAgICAgICAjIFRoaXMgaWQgbWFya3MgdGhlIGVuZCBvZiBhIGdyb3VwLgogICAgICAgICAgICBzZWxmLmxhc3RpbmRleCA9IG1hcmtfbnIgLyAyICsgMQogICAgICAgIGlmIG1hcmtfbnIgPj0gbGVuKHNlbGYubWFya3MpOgogICAgICAgICAgICBzZWxmLm1hcmtzLmV4dGVuZChbTm9uZV0gKiAobWFya19uciAtIGxlbihzZWxmLm1hcmtzKSArIDEpKQogICAgICAgIHNlbGYubWFya3NbbWFya19ucl0gPSBwb3NpdGlvbgoKICAgIGRlZiBnZXRfbWFya3Moc2VsZiwgZ3JvdXBfaW5kZXgpOgogICAgICAgIG1hcmtzX2luZGV4ID0gMiAqIGdyb3VwX2luZGV4CiAgICAgICAgaWYgbGVuKHNlbGYubWFya3MpID4gbWFya3NfaW5kZXggKyAxOgogICAgICAgICAgICByZXR1cm4gc2VsZi5tYXJrc1ttYXJrc19pbmRleF0sIHNlbGYubWFya3NbbWFya3NfaW5kZXggKyAxXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBOb25lLCBOb25lCgogICAgZGVmIG1hcmtzX3B1c2goc2VsZik6CiAgICAgICAgc2VsZi5tYXJrc19zdGFjay5hcHBlbmQoKHNlbGYubWFya3NbOl0sIHNlbGYubGFzdGluZGV4KSkKCiAgICBkZWYgbWFya3NfcG9wKHNlbGYpOgogICAgICAgIHNlbGYubWFya3MsIHNlbGYubGFzdGluZGV4ID0gc2VsZi5tYXJrc19zdGFjay5wb3AoKQoKICAgIGRlZiBtYXJrc19wb3Bfa2VlcChzZWxmKToKICAgICAgICBzZWxmLm1hcmtzLCBzZWxmLmxhc3RpbmRleCA9IHNlbGYubWFya3Nfc3RhY2tbLTFdCgogICAgZGVmIG1hcmtzX3BvcF9kaXNjYXJkKHNlbGYpOgogICAgICAgIHNlbGYubWFya3Nfc3RhY2sucG9wKCkKCiAgICBkZWYgbG93ZXIoc2VsZiwgY2hhcl9vcmQpOgogICAgICAgIHJldHVybiBnZXRsb3dlcihjaGFyX29yZCwgc2VsZi5mbGFncykKCgpjbGFzcyBfTWF0Y2hDb250ZXh0KG9iamVjdCk6CgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHN0YXRlLCBwYXR0ZXJuX2NvZGVzKToKICAgICAgICBzZWxmLnN0YXRlID0gc3RhdGUKICAgICAgICBzZWxmLnBhdHRlcm5fY29kZXMgPSBwYXR0ZXJuX2NvZGVzCiAgICAgICAgc2VsZi5zdHJpbmdfcG9zaXRpb24gPSBzdGF0ZS5zdHJpbmdfcG9zaXRpb24KICAgICAgICBzZWxmLmNvZGVfcG9zaXRpb24gPSAwCiAgICAgICAgc2VsZi5oYXNfbWF0Y2hlZCA9IE5vbmUKCiAgICBkZWYgcHVzaF9uZXdfY29udGV4dChzZWxmLCBwYXR0ZXJuX29mZnNldCk6CiAgICAgICAgIiIiQ3JlYXRlcyBhIG5ldyBjaGlsZCBjb250ZXh0IG9mIHRoaXMgY29udGV4dCBhbmQgcHVzaGVzIGl0IG9uIHRoZQogICAgICAgIHN0YWNrLiBwYXR0ZXJuX29mZnNldCBpcyB0aGUgb2Zmc2V0IG9mZiB0aGUgY3VycmVudCBjb2RlIHBvc2l0aW9uIHRvCiAgICAgICAgc3RhcnQgaW50ZXJwcmV0aW5nIGZyb20uIiIiCiAgICAgICAgY2hpbGRfY29udGV4dCA9IF9NYXRjaENvbnRleHQoc2VsZi5zdGF0ZSwKICAgICAgICAgICAgc2VsZi5wYXR0ZXJuX2NvZGVzW3NlbGYuY29kZV9wb3NpdGlvbiArIHBhdHRlcm5fb2Zmc2V0Ol0pCiAgICAgICAgc2VsZi5zdGF0ZS5jb250ZXh0X3N0YWNrLmFwcGVuZChjaGlsZF9jb250ZXh0KQogICAgICAgIHJldHVybiBjaGlsZF9jb250ZXh0CgogICAgZGVmIHBlZWtfY2hhcihzZWxmLCBwZWVrPTApOgogICAgICAgIHJldHVybiBzZWxmLnN0YXRlLnN0cmluZ1tzZWxmLnN0cmluZ19wb3NpdGlvbiArIHBlZWtdCgogICAgZGVmIHNraXBfY2hhcihzZWxmLCBza2lwX2NvdW50KToKICAgICAgICBzZWxmLnN0cmluZ19wb3NpdGlvbiArPSBza2lwX2NvdW50CgogICAgZGVmIHJlbWFpbmluZ19jaGFycyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5zdGF0ZS5lbmQgLSBzZWxmLnN0cmluZ19wb3NpdGlvbgoKICAgIGRlZiBwZWVrX2NvZGUoc2VsZiwgcGVlaz0wKToKICAgICAgICByZXR1cm4gc2VsZi5wYXR0ZXJuX2NvZGVzW3NlbGYuY29kZV9wb3NpdGlvbiArIHBlZWtdCgogICAgZGVmIHNraXBfY29kZShzZWxmLCBza2lwX2NvdW50KToKICAgICAgICBzZWxmLmNvZGVfcG9zaXRpb24gKz0gc2tpcF9jb3VudAoKICAgIGRlZiByZW1haW5pbmdfY29kZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIGxlbihzZWxmLnBhdHRlcm5fY29kZXMpIC0gc2VsZi5jb2RlX3Bvc2l0aW9uCgogICAgZGVmIGF0X2JlZ2lubmluZyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5zdHJpbmdfcG9zaXRpb24gPT0gMAoKICAgIGRlZiBhdF9lbmQoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuc3RyaW5nX3Bvc2l0aW9uID09IHNlbGYuc3RhdGUuZW5kCgogICAgZGVmIGF0X2xpbmVicmVhayhzZWxmKToKICAgICAgICByZXR1cm4gbm90IHNlbGYuYXRfZW5kKCkgYW5kIF9pc19saW5lYnJlYWsoc2VsZi5wZWVrX2NoYXIoKSkKCiAgICBkZWYgYXRfYm91bmRhcnkoc2VsZiwgd29yZF9jaGVja2VyKToKICAgICAgICBpZiBzZWxmLmF0X2JlZ2lubmluZygpIGFuZCBzZWxmLmF0X2VuZCgpOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICB0aGF0ID0gbm90IHNlbGYuYXRfYmVnaW5uaW5nKCkgYW5kIHdvcmRfY2hlY2tlcihzZWxmLnBlZWtfY2hhcigtMSkpCiAgICAgICAgdGhpcyA9IG5vdCBzZWxmLmF0X2VuZCgpIGFuZCB3b3JkX2NoZWNrZXIoc2VsZi5wZWVrX2NoYXIoKSkKICAgICAgICByZXR1cm4gdGhpcyAhPSB0aGF0CgoKY2xhc3MgX1JlcGVhdENvbnRleHQoX01hdGNoQ29udGV4dCk6CiAgICAKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb250ZXh0KToKICAgICAgICBfTWF0Y2hDb250ZXh0Ll9faW5pdF9fKHNlbGYsIGNvbnRleHQuc3RhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnBhdHRlcm5fY29kZXNbY29udGV4dC5jb2RlX3Bvc2l0aW9uOl0pCiAgICAgICAgc2VsZi5jb3VudCA9IC0xCiAgICAgICAgc2VsZi5wcmV2aW91cyA9IGNvbnRleHQuc3RhdGUucmVwZWF0CiAgICAgICAgc2VsZi5sYXN0X3Bvc2l0aW9uID0gTm9uZQoKCmNsYXNzIF9EaXNwYXRjaGVyKG9iamVjdCk6CgogICAgRElTUEFUQ0hfVEFCTEUgPSBOb25lCgogICAgZGVmIGRpc3BhdGNoKHNlbGYsIGNvZGUsIGNvbnRleHQpOgogICAgICAgIG1ldGhvZCA9IHNlbGYuRElTUEFUQ0hfVEFCTEUuZ2V0KGNvZGUsIHNlbGYuX19jbGFzc19fLnVua25vd24pCiAgICAgICAgcmV0dXJuIG1ldGhvZChzZWxmLCBjb250ZXh0KQoKICAgIGRlZiB1bmtub3duKHNlbGYsIGNvZGUsIGN0eCk6CiAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcigpCgogICAgZGVmIGJ1aWxkX2Rpc3BhdGNoX3RhYmxlKGNscywgY29kZV9kaWN0LCBtZXRob2RfcHJlZml4KToKICAgICAgICBpZiBjbHMuRElTUEFUQ0hfVEFCTEUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIHRhYmxlID0ge30KICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBjb2RlX2RpY3QuaXRlbXMoKToKICAgICAgICAgICAgaWYgaGFzYXR0cihjbHMsICIlcyVzIiAlIChtZXRob2RfcHJlZml4LCBrZXkpKToKICAgICAgICAgICAgICAgIHRhYmxlW3ZhbHVlXSA9IGdldGF0dHIoY2xzLCAiJXMlcyIgJSAobWV0aG9kX3ByZWZpeCwga2V5KSkKICAgICAgICBjbHMuRElTUEFUQ0hfVEFCTEUgPSB0YWJsZQoKICAgIGJ1aWxkX2Rpc3BhdGNoX3RhYmxlID0gY2xhc3NtZXRob2QoYnVpbGRfZGlzcGF0Y2hfdGFibGUpCgoKY2xhc3MgX09wY29kZURpc3BhdGNoZXIoX0Rpc3BhdGNoZXIpOgogICAgCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi5leGVjdXRpbmdfY29udGV4dHMgPSB7fQogICAgICAgIHNlbGYuYXRfZGlzcGF0Y2hlciA9IF9BdGNvZGVEaXNwYXRjaGVyKCkKICAgICAgICBzZWxmLmNoX2Rpc3BhdGNoZXIgPSBfQ2hjb2RlRGlzcGF0Y2hlcigpCiAgICAgICAgc2VsZi5zZXRfZGlzcGF0Y2hlciA9IF9DaGFyc2V0RGlzcGF0Y2hlcigpCiAgICAgICAgCiAgICBkZWYgbWF0Y2goc2VsZiwgY29udGV4dCk6CiAgICAgICAgIiIiUmV0dXJucyBUcnVlIGlmIHRoZSBjdXJyZW50IGNvbnRleHQgbWF0Y2hlcywgRmFsc2UgaWYgaXQgZG9lc24ndCBhbmQKICAgICAgICBOb25lIGlmIG1hdGNoaW5nIGlzIG5vdCBmaW5pc2hlZCwgaWUgbXVzdCBiZSByZXN1bWVkIGFmdGVyIGNoaWxkCiAgICAgICAgY29udGV4dHMgaGF2ZSBiZWVuIG1hdGNoZWQuIiIiCiAgICAgICAgd2hpbGUgY29udGV4dC5yZW1haW5pbmdfY29kZXMoKSA+IDAgYW5kIGNvbnRleHQuaGFzX21hdGNoZWQgaXMgTm9uZToKICAgICAgICAgICAgb3Bjb2RlID0gY29udGV4dC5wZWVrX2NvZGUoKQogICAgICAgICAgICBpZiBub3Qgc2VsZi5kaXNwYXRjaChvcGNvZGUsIGNvbnRleHQpOgogICAgICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICBpZiBjb250ZXh0Lmhhc19tYXRjaGVkIGlzIE5vbmU6CiAgICAgICAgICAgIGNvbnRleHQuaGFzX21hdGNoZWQgPSBGYWxzZQogICAgICAgIHJldHVybiBjb250ZXh0Lmhhc19tYXRjaGVkCgogICAgZGVmIGRpc3BhdGNoKHNlbGYsIG9wY29kZSwgY29udGV4dCk6CiAgICAgICAgIiIiRGlzcGF0Y2hlcyBhIGNvbnRleHQgb24gYSBnaXZlbiBvcGNvZGUuIFJldHVybnMgVHJ1ZSBpZiB0aGUgY29udGV4dAogICAgICAgIGlzIGRvbmUgbWF0Y2hpbmcsIEZhbHNlIGlmIGl0IG11c3QgYmUgcmVzdW1lZCB3aGVuIG5leHQgZW5jb3VudGVyZWQuIiIiCiAgICAgICAgaWYgc2VsZi5leGVjdXRpbmdfY29udGV4dHMuaGFzX2tleShpZChjb250ZXh0KSk6CiAgICAgICAgICAgIGdlbmVyYXRvciA9IHNlbGYuZXhlY3V0aW5nX2NvbnRleHRzW2lkKGNvbnRleHQpXQogICAgICAgICAgICBkZWwgc2VsZi5leGVjdXRpbmdfY29udGV4dHNbaWQoY29udGV4dCldCiAgICAgICAgICAgIGhhc19maW5pc2hlZCA9IGdlbmVyYXRvci5uZXh0KCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBtZXRob2QgPSBzZWxmLkRJU1BBVENIX1RBQkxFLmdldChvcGNvZGUsIF9PcGNvZGVEaXNwYXRjaGVyLnVua25vd24pCiAgICAgICAgICAgIGhhc19maW5pc2hlZCA9IG1ldGhvZChzZWxmLCBjb250ZXh0KQogICAgICAgICAgICBpZiBoYXNhdHRyKGhhc19maW5pc2hlZCwgIm5leHQiKTogIyBhdm9pZCB1c2luZyB0aGUgdHlwZXMgbW9kdWxlCiAgICAgICAgICAgICAgICBnZW5lcmF0b3IgPSBoYXNfZmluaXNoZWQKICAgICAgICAgICAgICAgIGhhc19maW5pc2hlZCA9IGdlbmVyYXRvci5uZXh0KCkKICAgICAgICBpZiBub3QgaGFzX2ZpbmlzaGVkOgogICAgICAgICAgICBzZWxmLmV4ZWN1dGluZ19jb250ZXh0c1tpZChjb250ZXh0KV0gPSBnZW5lcmF0b3IKICAgICAgICByZXR1cm4gaGFzX2ZpbmlzaGVkCgogICAgZGVmIG9wX3N1Y2Nlc3Moc2VsZiwgY3R4KToKICAgICAgICAjIGVuZCBvZiBwYXR0ZXJuCiAgICAgICAgI3NlbGYuX2xvZyhjdHgsICJTVUNDRVNTIikKICAgICAgICBjdHguc3RhdGUuc3RyaW5nX3Bvc2l0aW9uID0gY3R4LnN0cmluZ19wb3NpdGlvbgogICAgICAgIGN0eC5oYXNfbWF0Y2hlZCA9IFRydWUKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBvcF9mYWlsdXJlKHNlbGYsIGN0eCk6CiAgICAgICAgIyBpbW1lZGlhdGUgZmFpbHVyZQogICAgICAgICNzZWxmLl9sb2coY3R4LCAiRkFJTFVSRSIpCiAgICAgICAgY3R4Lmhhc19tYXRjaGVkID0gRmFsc2UKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBnZW5lcmFsX29wX2xpdGVyYWwoc2VsZiwgY3R4LCBjb21wYXJlLCBkZWNvcmF0ZT1sYW1iZGEgeDogeCk6CiAgICAgICAgaWYgY3R4LmF0X2VuZCgpIG9yIG5vdCBjb21wYXJlKGRlY29yYXRlKG9yZChjdHgucGVla19jaGFyKCkpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWNvcmF0ZShjdHgucGVla19jb2RlKDEpKSk6CiAgICAgICAgICAgIGN0eC5oYXNfbWF0Y2hlZCA9IEZhbHNlCiAgICAgICAgY3R4LnNraXBfY29kZSgyKQogICAgICAgIGN0eC5za2lwX2NoYXIoMSkKCiAgICBkZWYgb3BfbGl0ZXJhbChzZWxmLCBjdHgpOgogICAgICAgICMgbWF0Y2ggbGl0ZXJhbCBzdHJpbmcKICAgICAgICAjIDxMSVRFUkFMPiA8Y29kZT4KICAgICAgICAjc2VsZi5fbG9nKGN0eCwgIkxJVEVSQUwiLCBjdHgucGVla19jb2RlKDEpKQogICAgICAgIHNlbGYuZ2VuZXJhbF9vcF9saXRlcmFsKGN0eCwgb3BlcmF0b3IuZXEpCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgb3Bfbm90X2xpdGVyYWwoc2VsZiwgY3R4KToKICAgICAgICAjIG1hdGNoIGFueXRoaW5nIHRoYXQgaXMgbm90IHRoZSBnaXZlbiBsaXRlcmFsIGNoYXJhY3RlcgogICAgICAgICMgPE5PVF9MSVRFUkFMPiA8Y29kZT4KICAgICAgICAjc2VsZi5fbG9nKGN0eCwgIk5PVF9MSVRFUkFMIiwgY3R4LnBlZWtfY29kZSgxKSkKICAgICAgICBzZWxmLmdlbmVyYWxfb3BfbGl0ZXJhbChjdHgsIG9wZXJhdG9yLm5lKQogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIG9wX2xpdGVyYWxfaWdub3JlKHNlbGYsIGN0eCk6CiAgICAgICAgIyBtYXRjaCBsaXRlcmFsIHJlZ2FyZGxlc3Mgb2YgY2FzZQogICAgICAgICMgPExJVEVSQUxfSUdOT1JFPiA8Y29kZT4KICAgICAgICAjc2VsZi5fbG9nKGN0eCwgIkxJVEVSQUxfSUdOT1JFIiwgY3R4LnBlZWtfY29kZSgxKSkKICAgICAgICBzZWxmLmdlbmVyYWxfb3BfbGl0ZXJhbChjdHgsIG9wZXJhdG9yLmVxLCBjdHguc3RhdGUubG93ZXIpCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgb3Bfbm90X2xpdGVyYWxfaWdub3JlKHNlbGYsIGN0eCk6CiAgICAgICAgIyBtYXRjaCBsaXRlcmFsIHJlZ2FyZGxlc3Mgb2YgY2FzZQogICAgICAgICMgPExJVEVSQUxfSUdOT1JFPiA8Y29kZT4KICAgICAgICAjc2VsZi5fbG9nKGN0eCwgIkxJVEVSQUxfSUdOT1JFIiwgY3R4LnBlZWtfY29kZSgxKSkKICAgICAgICBzZWxmLmdlbmVyYWxfb3BfbGl0ZXJhbChjdHgsIG9wZXJhdG9yLm5lLCBjdHguc3RhdGUubG93ZXIpCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgb3BfYXQoc2VsZiwgY3R4KToKICAgICAgICAjIG1hdGNoIGF0IGdpdmVuIHBvc2l0aW9uCiAgICAgICAgIyA8QVQ+IDxjb2RlPgogICAgICAgICNzZWxmLl9sb2coY3R4LCAiQVQiLCBjdHgucGVla19jb2RlKDEpKQogICAgICAgIGlmIG5vdCBzZWxmLmF0X2Rpc3BhdGNoZXIuZGlzcGF0Y2goY3R4LnBlZWtfY29kZSgxKSwgY3R4KToKICAgICAgICAgICAgY3R4Lmhhc19tYXRjaGVkID0gRmFsc2UKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBjdHguc2tpcF9jb2RlKDIpCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgb3BfY2F0ZWdvcnkoc2VsZiwgY3R4KToKICAgICAgICAjIG1hdGNoIGF0IGdpdmVuIGNhdGVnb3J5CiAgICAgICAgIyA8Q0FURUdPUlk+IDxjb2RlPgogICAgICAgICNzZWxmLl9sb2coY3R4LCAiQ0FURUdPUlkiLCBjdHgucGVla19jb2RlKDEpKQogICAgICAgIGlmIGN0eC5hdF9lbmQoKSBvciBub3Qgc2VsZi5jaF9kaXNwYXRjaGVyLmRpc3BhdGNoKGN0eC5wZWVrX2NvZGUoMSksIGN0eCk6CiAgICAgICAgICAgIGN0eC5oYXNfbWF0Y2hlZCA9IEZhbHNlCiAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgY3R4LnNraXBfY29kZSgyKQogICAgICAgIGN0eC5za2lwX2NoYXIoMSkKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBvcF9hbnkoc2VsZiwgY3R4KToKICAgICAgICAjIG1hdGNoIGFueXRoaW5nIChleGNlcHQgYSBuZXdsaW5lKQogICAgICAgICMgPEFOWT4KICAgICAgICAjc2VsZi5fbG9nKGN0eCwgIkFOWSIpCiAgICAgICAgaWYgY3R4LmF0X2VuZCgpIG9yIGN0eC5hdF9saW5lYnJlYWsoKToKICAgICAgICAgICAgY3R4Lmhhc19tYXRjaGVkID0gRmFsc2UKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBjdHguc2tpcF9jb2RlKDEpCiAgICAgICAgY3R4LnNraXBfY2hhcigxKQogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIG9wX2FueV9hbGwoc2VsZiwgY3R4KToKICAgICAgICAjIG1hdGNoIGFueXRoaW5nCiAgICAgICAgIyA8QU5ZX0FMTD4KICAgICAgICAjc2VsZi5fbG9nKGN0eCwgIkFOWV9BTEwiKQogICAgICAgIGlmIGN0eC5hdF9lbmQoKToKICAgICAgICAgICAgY3R4Lmhhc19tYXRjaGVkID0gRmFsc2UKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBjdHguc2tpcF9jb2RlKDEpCiAgICAgICAgY3R4LnNraXBfY2hhcigxKQogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIGdlbmVyYWxfb3BfaW4oc2VsZiwgY3R4LCBkZWNvcmF0ZT1sYW1iZGEgeDogeCk6CiAgICAgICAgI3NlbGYuX2xvZyhjdHgsICJPUF9JTiIpCiAgICAgICAgaWYgY3R4LmF0X2VuZCgpOgogICAgICAgICAgICBjdHguaGFzX21hdGNoZWQgPSBGYWxzZQogICAgICAgICAgICByZXR1cm4KICAgICAgICBza2lwID0gY3R4LnBlZWtfY29kZSgxKQogICAgICAgIGN0eC5za2lwX2NvZGUoMikgIyBzZXQgb3AgcG9pbnRlciB0byB0aGUgc2V0IGNvZGUKICAgICAgICBpZiBub3Qgc2VsZi5jaGVja19jaGFyc2V0KGN0eCwgZGVjb3JhdGUob3JkKGN0eC5wZWVrX2NoYXIoKSkpKToKICAgICAgICAgICAgY3R4Lmhhc19tYXRjaGVkID0gRmFsc2UKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgY3R4LnNraXBfY29kZShza2lwIC0gMSkKICAgICAgICBjdHguc2tpcF9jaGFyKDEpCgogICAgZGVmIG9wX2luKHNlbGYsIGN0eCk6CiAgICAgICAgIyBtYXRjaCBzZXQgbWVtYmVyIChvciBub25fbWVtYmVyKQogICAgICAgICMgPElOPiA8c2tpcD4gPHNldD4KICAgICAgICAjc2VsZi5fbG9nKGN0eCwgIk9QX0lOIikKICAgICAgICBzZWxmLmdlbmVyYWxfb3BfaW4oY3R4KQogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIG9wX2luX2lnbm9yZShzZWxmLCBjdHgpOgogICAgICAgICMgbWF0Y2ggc2V0IG1lbWJlciAob3Igbm9uX21lbWJlciksIGRpc3JlZ2FyZGluZyBjYXNlIG9mIGN1cnJlbnQgY2hhcgogICAgICAgICMgPElOX0lHTk9SRT4gPHNraXA+IDxzZXQ+CiAgICAgICAgI3NlbGYuX2xvZyhjdHgsICJPUF9JTl9JR05PUkUiKQogICAgICAgIHNlbGYuZ2VuZXJhbF9vcF9pbihjdHgsIGN0eC5zdGF0ZS5sb3dlcikKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBvcF9qdW1wKHNlbGYsIGN0eCk6CiAgICAgICAgIyBqdW1wIGZvcndhcmQKICAgICAgICAjIDxKVU1QPiA8b2Zmc2V0PgogICAgICAgICNzZWxmLl9sb2coY3R4LCAiSlVNUCIsIGN0eC5wZWVrX2NvZGUoMSkpCiAgICAgICAgY3R4LnNraXBfY29kZShjdHgucGVla19jb2RlKDEpICsgMSkKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgICMgc2tpcCBpbmZvCiAgICAjIDxJTkZPPiA8c2tpcD4KICAgIG9wX2luZm8gPSBvcF9qdW1wCgogICAgZGVmIG9wX21hcmsoc2VsZiwgY3R4KToKICAgICAgICAjIHNldCBtYXJrCiAgICAgICAgIyA8TUFSSz4gPGdpZD4KICAgICAgICAjc2VsZi5fbG9nKGN0eCwgIk9QX01BUksiLCBjdHgucGVla19jb2RlKDEpKQogICAgICAgIGN0eC5zdGF0ZS5zZXRfbWFyayhjdHgucGVla19jb2RlKDEpLCBjdHguc3RyaW5nX3Bvc2l0aW9uKQogICAgICAgIGN0eC5za2lwX2NvZGUoMikKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBvcF9icmFuY2goc2VsZiwgY3R4KToKICAgICAgICAjIGFsdGVybmF0aW9uCiAgICAgICAgIyA8QlJBTkNIPiA8MD1za2lwPiBjb2RlIDxKVU1QPiAuLi4gPE5VTEw+CiAgICAgICAgI3NlbGYuX2xvZyhjdHgsICJCUkFOQ0giKQogICAgICAgIGN0eC5zdGF0ZS5tYXJrc19wdXNoKCkKICAgICAgICBjdHguc2tpcF9jb2RlKDEpCiAgICAgICAgY3VycmVudF9icmFuY2hfbGVuZ3RoID0gY3R4LnBlZWtfY29kZSgwKQogICAgICAgIHdoaWxlIGN1cnJlbnRfYnJhbmNoX2xlbmd0aDoKICAgICAgICAgICAgIyBUaGUgZm9sbG93aW5nIHRyaWVzIHRvIHNob3J0Y3V0IGJyYW5jaGVzIHN0YXJ0aW5nIHdpdGggYQogICAgICAgICAgICAjICh1bm1hdGNoZWQpIGxpdGVyYWwuIF9zcmUuYyBhbHNvIHNob3J0Y3V0cyBjaGFyc2V0cyBoZXJlLgogICAgICAgICAgICBpZiBub3QgKGN0eC5wZWVrX2NvZGUoMSkgPT0gT1BDT0RFU1sibGl0ZXJhbCJdIGFuZCBcCiAgICAgICAgICAgICAgICAgICAgKGN0eC5hdF9lbmQoKSBvciBjdHgucGVla19jb2RlKDIpICE9IG9yZChjdHgucGVla19jaGFyKCkpKSk6CiAgICAgICAgICAgICAgICBjdHguc3RhdGUuc3RyaW5nX3Bvc2l0aW9uID0gY3R4LnN0cmluZ19wb3NpdGlvbgogICAgICAgICAgICAgICAgY2hpbGRfY29udGV4dCA9IGN0eC5wdXNoX25ld19jb250ZXh0KDEpCiAgICAgICAgICAgICAgICB5aWVsZCBGYWxzZQogICAgICAgICAgICAgICAgaWYgY2hpbGRfY29udGV4dC5oYXNfbWF0Y2hlZDoKICAgICAgICAgICAgICAgICAgICBjdHguaGFzX21hdGNoZWQgPSBUcnVlCiAgICAgICAgICAgICAgICAgICAgeWllbGQgVHJ1ZQogICAgICAgICAgICAgICAgY3R4LnN0YXRlLm1hcmtzX3BvcF9rZWVwKCkKICAgICAgICAgICAgY3R4LnNraXBfY29kZShjdXJyZW50X2JyYW5jaF9sZW5ndGgpCiAgICAgICAgICAgIGN1cnJlbnRfYnJhbmNoX2xlbmd0aCA9IGN0eC5wZWVrX2NvZGUoMCkKICAgICAgICBjdHguc3RhdGUubWFya3NfcG9wX2Rpc2NhcmQoKQogICAgICAgIGN0eC5oYXNfbWF0Y2hlZCA9IEZhbHNlCiAgICAgICAgeWllbGQgVHJ1ZQoKICAgIGRlZiBvcF9yZXBlYXRfb25lKHNlbGYsIGN0eCk6CiAgICAgICAgIyBtYXRjaCByZXBlYXRlZCBzZXF1ZW5jZSAobWF4aW1pemluZykuCiAgICAgICAgIyB0aGlzIG9wZXJhdG9yIG9ubHkgd29ya3MgaWYgdGhlIHJlcGVhdGVkIGl0ZW0gaXMgZXhhY3RseSBvbmUgY2hhcmFjdGVyCiAgICAgICAgIyB3aWRlLCBhbmQgd2UncmUgbm90IGFscmVhZHkgY29sbGVjdGluZyBiYWNrdHJhY2tpbmcgcG9pbnRzLgogICAgICAgICMgPFJFUEVBVF9PTkU+IDxza2lwPiA8MT1taW4+IDwyPW1heD4gaXRlbSA8U1VDQ0VTUz4gdGFpbAogICAgICAgIG1pbmNvdW50ID0gY3R4LnBlZWtfY29kZSgyKQogICAgICAgIG1heGNvdW50ID0gY3R4LnBlZWtfY29kZSgzKQogICAgICAgICNzZWxmLl9sb2coY3R4LCAiUkVQRUFUX09ORSIsIG1pbmNvdW50LCBtYXhjb3VudCkKCiAgICAgICAgaWYgY3R4LnJlbWFpbmluZ19jaGFycygpIDwgbWluY291bnQ6CiAgICAgICAgICAgIGN0eC5oYXNfbWF0Y2hlZCA9IEZhbHNlCiAgICAgICAgICAgIHlpZWxkIFRydWUKICAgICAgICBjdHguc3RhdGUuc3RyaW5nX3Bvc2l0aW9uID0gY3R4LnN0cmluZ19wb3NpdGlvbgogICAgICAgIGNvdW50ID0gc2VsZi5jb3VudF9yZXBldGl0aW9ucyhjdHgsIG1heGNvdW50KQogICAgICAgIGN0eC5za2lwX2NoYXIoY291bnQpCiAgICAgICAgaWYgY291bnQgPCBtaW5jb3VudDoKICAgICAgICAgICAgY3R4Lmhhc19tYXRjaGVkID0gRmFsc2UKICAgICAgICAgICAgeWllbGQgVHJ1ZQogICAgICAgIGlmIGN0eC5wZWVrX2NvZGUoY3R4LnBlZWtfY29kZSgxKSArIDEpID09IE9QQ09ERVNbInN1Y2Nlc3MiXToKICAgICAgICAgICAgIyB0YWlsIGlzIGVtcHR5LiAgd2UncmUgZmluaXNoZWQKICAgICAgICAgICAgY3R4LnN0YXRlLnN0cmluZ19wb3NpdGlvbiA9IGN0eC5zdHJpbmdfcG9zaXRpb24KICAgICAgICAgICAgY3R4Lmhhc19tYXRjaGVkID0gVHJ1ZQogICAgICAgICAgICB5aWVsZCBUcnVlCgogICAgICAgIGN0eC5zdGF0ZS5tYXJrc19wdXNoKCkKICAgICAgICBpZiBjdHgucGVla19jb2RlKGN0eC5wZWVrX2NvZGUoMSkgKyAxKSA9PSBPUENPREVTWyJsaXRlcmFsIl06CiAgICAgICAgICAgICMgU3BlY2lhbCBjYXNlOiBUYWlsIHN0YXJ0cyB3aXRoIGEgbGl0ZXJhbC4gU2tpcCBwb3NpdGlvbnMgd2hlcmUKICAgICAgICAgICAgIyB0aGUgcmVzdCBvZiB0aGUgcGF0dGVybiBjYW5ub3QgcG9zc2libHkgbWF0Y2guCiAgICAgICAgICAgIGNoYXIgPSBjdHgucGVla19jb2RlKGN0eC5wZWVrX2NvZGUoMSkgKyAyKQogICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgd2hpbGUgY291bnQgPj0gbWluY291bnQgYW5kIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY3R4LmF0X2VuZCgpIG9yIG9yZChjdHgucGVla19jaGFyKCkpICE9IGNoYXIpOgogICAgICAgICAgICAgICAgICAgIGN0eC5za2lwX2NoYXIoLTEpCiAgICAgICAgICAgICAgICAgICAgY291bnQgLT0gMQogICAgICAgICAgICAgICAgaWYgY291bnQgPCBtaW5jb3VudDoKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgY3R4LnN0YXRlLnN0cmluZ19wb3NpdGlvbiA9IGN0eC5zdHJpbmdfcG9zaXRpb24KICAgICAgICAgICAgICAgIGNoaWxkX2NvbnRleHQgPSBjdHgucHVzaF9uZXdfY29udGV4dChjdHgucGVla19jb2RlKDEpICsgMSkKICAgICAgICAgICAgICAgIHlpZWxkIEZhbHNlCiAgICAgICAgICAgICAgICBpZiBjaGlsZF9jb250ZXh0Lmhhc19tYXRjaGVkOgogICAgICAgICAgICAgICAgICAgIGN0eC5oYXNfbWF0Y2hlZCA9IFRydWUKICAgICAgICAgICAgICAgICAgICB5aWVsZCBUcnVlCiAgICAgICAgICAgICAgICBjdHguc2tpcF9jaGFyKC0xKQogICAgICAgICAgICAgICAgY291bnQgLT0gMQogICAgICAgICAgICAgICAgY3R4LnN0YXRlLm1hcmtzX3BvcF9rZWVwKCkKICAgICAgICAKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIEdlbmVyYWwgY2FzZTogYmFja3RyYWNraW5nCiAgICAgICAgICAgIHdoaWxlIGNvdW50ID49IG1pbmNvdW50OgogICAgICAgICAgICAgICAgY3R4LnN0YXRlLnN0cmluZ19wb3NpdGlvbiA9IGN0eC5zdHJpbmdfcG9zaXRpb24KICAgICAgICAgICAgICAgIGNoaWxkX2NvbnRleHQgPSBjdHgucHVzaF9uZXdfY29udGV4dChjdHgucGVla19jb2RlKDEpICsgMSkKICAgICAgICAgICAgICAgIHlpZWxkIEZhbHNlCiAgICAgICAgICAgICAgICBpZiBjaGlsZF9jb250ZXh0Lmhhc19tYXRjaGVkOgogICAgICAgICAgICAgICAgICAgIGN0eC5oYXNfbWF0Y2hlZCA9IFRydWUKICAgICAgICAgICAgICAgICAgICB5aWVsZCBUcnVlCiAgICAgICAgICAgICAgICBjdHguc2tpcF9jaGFyKC0xKQogICAgICAgICAgICAgICAgY291bnQgLT0gMQogICAgICAgICAgICAgICAgY3R4LnN0YXRlLm1hcmtzX3BvcF9rZWVwKCkKCiAgICAgICAgY3R4LnN0YXRlLm1hcmtzX3BvcF9kaXNjYXJkKCkKICAgICAgICBjdHguaGFzX21hdGNoZWQgPSBGYWxzZQogICAgICAgIHlpZWxkIFRydWUKCiAgICBkZWYgb3BfbWluX3JlcGVhdF9vbmUoc2VsZiwgY3R4KToKICAgICAgICAjIG1hdGNoIHJlcGVhdGVkIHNlcXVlbmNlIChtaW5pbWl6aW5nKQogICAgICAgICMgPE1JTl9SRVBFQVRfT05FPiA8c2tpcD4gPDE9bWluPiA8Mj1tYXg+IGl0ZW0gPFNVQ0NFU1M+IHRhaWwKICAgICAgICBtaW5jb3VudCA9IGN0eC5wZWVrX2NvZGUoMikKICAgICAgICBtYXhjb3VudCA9IGN0eC5wZWVrX2NvZGUoMykKICAgICAgICAjc2VsZi5fbG9nKGN0eCwgIk1JTl9SRVBFQVRfT05FIiwgbWluY291bnQsIG1heGNvdW50KQoKICAgICAgICBpZiBjdHgucmVtYWluaW5nX2NoYXJzKCkgPCBtaW5jb3VudDoKICAgICAgICAgICAgY3R4Lmhhc19tYXRjaGVkID0gRmFsc2UKICAgICAgICAgICAgeWllbGQgVHJ1ZQogICAgICAgIGN0eC5zdGF0ZS5zdHJpbmdfcG9zaXRpb24gPSBjdHguc3RyaW5nX3Bvc2l0aW9uCiAgICAgICAgaWYgbWluY291bnQgPT0gMDoKICAgICAgICAgICAgY291bnQgPSAwCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY291bnQgPSBzZWxmLmNvdW50X3JlcGV0aXRpb25zKGN0eCwgbWluY291bnQpCiAgICAgICAgICAgIGlmIGNvdW50IDwgbWluY291bnQ6CiAgICAgICAgICAgICAgICBjdHguaGFzX21hdGNoZWQgPSBGYWxzZQogICAgICAgICAgICAgICAgeWllbGQgVHJ1ZQogICAgICAgICAgICBjdHguc2tpcF9jaGFyKGNvdW50KQogICAgICAgIGlmIGN0eC5wZWVrX2NvZGUoY3R4LnBlZWtfY29kZSgxKSArIDEpID09IE9QQ09ERVNbInN1Y2Nlc3MiXToKICAgICAgICAgICAgIyB0YWlsIGlzIGVtcHR5LiAgd2UncmUgZmluaXNoZWQKICAgICAgICAgICAgY3R4LnN0YXRlLnN0cmluZ19wb3NpdGlvbiA9IGN0eC5zdHJpbmdfcG9zaXRpb24KICAgICAgICAgICAgY3R4Lmhhc19tYXRjaGVkID0gVHJ1ZQogICAgICAgICAgICB5aWVsZCBUcnVlCgogICAgICAgIGN0eC5zdGF0ZS5tYXJrc19wdXNoKCkKICAgICAgICB3aGlsZSBtYXhjb3VudCA9PSBNQVhSRVBFQVQgb3IgY291bnQgPD0gbWF4Y291bnQ6CiAgICAgICAgICAgIGN0eC5zdGF0ZS5zdHJpbmdfcG9zaXRpb24gPSBjdHguc3RyaW5nX3Bvc2l0aW9uCiAgICAgICAgICAgIGNoaWxkX2NvbnRleHQgPSBjdHgucHVzaF9uZXdfY29udGV4dChjdHgucGVla19jb2RlKDEpICsgMSkKICAgICAgICAgICAgeWllbGQgRmFsc2UKICAgICAgICAgICAgaWYgY2hpbGRfY29udGV4dC5oYXNfbWF0Y2hlZDoKICAgICAgICAgICAgICAgIGN0eC5oYXNfbWF0Y2hlZCA9IFRydWUKICAgICAgICAgICAgICAgIHlpZWxkIFRydWUKICAgICAgICAgICAgY3R4LnN0YXRlLnN0cmluZ19wb3NpdGlvbiA9IGN0eC5zdHJpbmdfcG9zaXRpb24KICAgICAgICAgICAgaWYgc2VsZi5jb3VudF9yZXBldGl0aW9ucyhjdHgsIDEpID09IDA6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBjdHguc2tpcF9jaGFyKDEpCiAgICAgICAgICAgIGNvdW50ICs9IDEKICAgICAgICAgICAgY3R4LnN0YXRlLm1hcmtzX3BvcF9rZWVwKCkKCiAgICAgICAgY3R4LnN0YXRlLm1hcmtzX3BvcF9kaXNjYXJkKCkKICAgICAgICBjdHguaGFzX21hdGNoZWQgPSBGYWxzZQogICAgICAgIHlpZWxkIFRydWUKCiAgICBkZWYgb3BfcmVwZWF0KHNlbGYsIGN0eCk6CiAgICAgICAgIyBjcmVhdGUgcmVwZWF0IGNvbnRleHQuICBhbGwgdGhlIGhhcmQgd29yayBpcyBkb25lIGJ5IHRoZSBVTlRJTAogICAgICAgICMgb3BlcmF0b3IgKE1BWF9VTlRJTCwgTUlOX1VOVElMKQogICAgICAgICMgPFJFUEVBVD4gPHNraXA+IDwxPW1pbj4gPDI9bWF4PiBpdGVtIDxVTlRJTD4gdGFpbAogICAgICAgICNzZWxmLl9sb2coY3R4LCAiUkVQRUFUIiwgY3R4LnBlZWtfY29kZSgyKSwgY3R4LnBlZWtfY29kZSgzKSkKICAgICAgICByZXBlYXQgPSBfUmVwZWF0Q29udGV4dChjdHgpCiAgICAgICAgY3R4LnN0YXRlLnJlcGVhdCA9IHJlcGVhdAogICAgICAgIGN0eC5zdGF0ZS5zdHJpbmdfcG9zaXRpb24gPSBjdHguc3RyaW5nX3Bvc2l0aW9uCiAgICAgICAgY2hpbGRfY29udGV4dCA9IGN0eC5wdXNoX25ld19jb250ZXh0KGN0eC5wZWVrX2NvZGUoMSkgKyAxKQogICAgICAgIHlpZWxkIEZhbHNlCiAgICAgICAgY3R4LnN0YXRlLnJlcGVhdCA9IHJlcGVhdC5wcmV2aW91cwogICAgICAgIGN0eC5oYXNfbWF0Y2hlZCA9IGNoaWxkX2NvbnRleHQuaGFzX21hdGNoZWQKICAgICAgICB5aWVsZCBUcnVlCgogICAgZGVmIG9wX21heF91bnRpbChzZWxmLCBjdHgpOgogICAgICAgICMgbWF4aW1pemluZyByZXBlYXQKICAgICAgICAjIDxSRVBFQVQ+IDxza2lwPiA8MT1taW4+IDwyPW1heD4gaXRlbSA8TUFYX1VOVElMPiB0YWlsCiAgICAgICAgcmVwZWF0ID0gY3R4LnN0YXRlLnJlcGVhdAogICAgICAgIGlmIHJlcGVhdCBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoIkludGVybmFsIHJlIGVycm9yOiBNQVhfVU5USUwgd2l0aG91dCBSRVBFQVQuIikKICAgICAgICBtaW5jb3VudCA9IHJlcGVhdC5wZWVrX2NvZGUoMikKICAgICAgICBtYXhjb3VudCA9IHJlcGVhdC5wZWVrX2NvZGUoMykKICAgICAgICBjdHguc3RhdGUuc3RyaW5nX3Bvc2l0aW9uID0gY3R4LnN0cmluZ19wb3NpdGlvbgogICAgICAgIGNvdW50ID0gcmVwZWF0LmNvdW50ICsgMQogICAgICAgICNzZWxmLl9sb2coY3R4LCAiTUFYX1VOVElMIiwgY291bnQpCgogICAgICAgIGlmIGNvdW50IDwgbWluY291bnQ6CiAgICAgICAgICAgICMgbm90IGVub3VnaCBtYXRjaGVzCiAgICAgICAgICAgIHJlcGVhdC5jb3VudCA9IGNvdW50CiAgICAgICAgICAgIGNoaWxkX2NvbnRleHQgPSByZXBlYXQucHVzaF9uZXdfY29udGV4dCg0KQogICAgICAgICAgICB5aWVsZCBGYWxzZQogICAgICAgICAgICBjdHguaGFzX21hdGNoZWQgPSBjaGlsZF9jb250ZXh0Lmhhc19tYXRjaGVkCiAgICAgICAgICAgIGlmIG5vdCBjdHguaGFzX21hdGNoZWQ6CiAgICAgICAgICAgICAgICByZXBlYXQuY291bnQgPSBjb3VudCAtIDEKICAgICAgICAgICAgICAgIGN0eC5zdGF0ZS5zdHJpbmdfcG9zaXRpb24gPSBjdHguc3RyaW5nX3Bvc2l0aW9uCiAgICAgICAgICAgIHlpZWxkIFRydWUKCiAgICAgICAgaWYgKGNvdW50IDwgbWF4Y291bnQgb3IgbWF4Y291bnQgPT0gTUFYUkVQRUFUKSBcCiAgICAgICAgICAgICAgICAgICAgICBhbmQgY3R4LnN0YXRlLnN0cmluZ19wb3NpdGlvbiAhPSByZXBlYXQubGFzdF9wb3NpdGlvbjoKICAgICAgICAgICAgIyB3ZSBtYXkgaGF2ZSBlbm91Z2ggbWF0Y2hlcywgaWYgd2UgY2FuIG1hdGNoIGFub3RoZXIgaXRlbSwgZG8gc28KICAgICAgICAgICAgcmVwZWF0LmNvdW50ID0gY291bnQKICAgICAgICAgICAgY3R4LnN0YXRlLm1hcmtzX3B1c2goKQogICAgICAgICAgICBzYXZlX2xhc3RfcG9zaXRpb24gPSByZXBlYXQubGFzdF9wb3NpdGlvbiAjIHplcm8td2lkdGggbWF0Y2ggcHJvdGVjdGlvbgogICAgICAgICAgICByZXBlYXQubGFzdF9wb3NpdGlvbiA9IGN0eC5zdGF0ZS5zdHJpbmdfcG9zaXRpb24KICAgICAgICAgICAgY2hpbGRfY29udGV4dCA9IHJlcGVhdC5wdXNoX25ld19jb250ZXh0KDQpCiAgICAgICAgICAgIHlpZWxkIEZhbHNlCiAgICAgICAgICAgIHJlcGVhdC5sYXN0X3Bvc2l0aW9uID0gc2F2ZV9sYXN0X3Bvc2l0aW9uCiAgICAgICAgICAgIGlmIGNoaWxkX2NvbnRleHQuaGFzX21hdGNoZWQ6CiAgICAgICAgICAgICAgICBjdHguc3RhdGUubWFya3NfcG9wX2Rpc2NhcmQoKQogICAgICAgICAgICAgICAgY3R4Lmhhc19tYXRjaGVkID0gVHJ1ZQogICAgICAgICAgICAgICAgeWllbGQgVHJ1ZQogICAgICAgICAgICBjdHguc3RhdGUubWFya3NfcG9wKCkKICAgICAgICAgICAgcmVwZWF0LmNvdW50ID0gY291bnQgLSAxCiAgICAgICAgICAgIGN0eC5zdGF0ZS5zdHJpbmdfcG9zaXRpb24gPSBjdHguc3RyaW5nX3Bvc2l0aW9uCgogICAgICAgICMgY2Fubm90IG1hdGNoIG1vcmUgcmVwZWF0ZWQgaXRlbXMgaGVyZS4gIG1ha2Ugc3VyZSB0aGUgdGFpbCBtYXRjaGVzCiAgICAgICAgY3R4LnN0YXRlLnJlcGVhdCA9IHJlcGVhdC5wcmV2aW91cwogICAgICAgIGNoaWxkX2NvbnRleHQgPSBjdHgucHVzaF9uZXdfY29udGV4dCgxKQogICAgICAgIHlpZWxkIEZhbHNlCiAgICAgICAgY3R4Lmhhc19tYXRjaGVkID0gY2hpbGRfY29udGV4dC5oYXNfbWF0Y2hlZAogICAgICAgIGlmIG5vdCBjdHguaGFzX21hdGNoZWQ6CiAgICAgICAgICAgIGN0eC5zdGF0ZS5yZXBlYXQgPSByZXBlYXQKICAgICAgICAgICAgY3R4LnN0YXRlLnN0cmluZ19wb3NpdGlvbiA9IGN0eC5zdHJpbmdfcG9zaXRpb24KICAgICAgICB5aWVsZCBUcnVlCgogICAgZGVmIG9wX21pbl91bnRpbChzZWxmLCBjdHgpOgogICAgICAgICMgbWluaW1pemluZyByZXBlYXQKICAgICAgICAjIDxSRVBFQVQ+IDxza2lwPiA8MT1taW4+IDwyPW1heD4gaXRlbSA8TUlOX1VOVElMPiB0YWlsCiAgICAgICAgcmVwZWF0ID0gY3R4LnN0YXRlLnJlcGVhdAogICAgICAgIGlmIHJlcGVhdCBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoIkludGVybmFsIHJlIGVycm9yOiBNSU5fVU5USUwgd2l0aG91dCBSRVBFQVQuIikKICAgICAgICBtaW5jb3VudCA9IHJlcGVhdC5wZWVrX2NvZGUoMikKICAgICAgICBtYXhjb3VudCA9IHJlcGVhdC5wZWVrX2NvZGUoMykKICAgICAgICBjdHguc3RhdGUuc3RyaW5nX3Bvc2l0aW9uID0gY3R4LnN0cmluZ19wb3NpdGlvbgogICAgICAgIGNvdW50ID0gcmVwZWF0LmNvdW50ICsgMQogICAgICAgICNzZWxmLl9sb2coY3R4LCAiTUlOX1VOVElMIiwgY291bnQpCgogICAgICAgIGlmIGNvdW50IDwgbWluY291bnQ6CiAgICAgICAgICAgICMgbm90IGVub3VnaCBtYXRjaGVzCiAgICAgICAgICAgIHJlcGVhdC5jb3VudCA9IGNvdW50CiAgICAgICAgICAgIGNoaWxkX2NvbnRleHQgPSByZXBlYXQucHVzaF9uZXdfY29udGV4dCg0KQogICAgICAgICAgICB5aWVsZCBGYWxzZQogICAgICAgICAgICBjdHguaGFzX21hdGNoZWQgPSBjaGlsZF9jb250ZXh0Lmhhc19tYXRjaGVkCiAgICAgICAgICAgIGlmIG5vdCBjdHguaGFzX21hdGNoZWQ6CiAgICAgICAgICAgICAgICByZXBlYXQuY291bnQgPSBjb3VudCAtIDEKICAgICAgICAgICAgICAgIGN0eC5zdGF0ZS5zdHJpbmdfcG9zaXRpb24gPSBjdHguc3RyaW5nX3Bvc2l0aW9uCiAgICAgICAgICAgIHlpZWxkIFRydWUKCiAgICAgICAgIyBzZWUgaWYgdGhlIHRhaWwgbWF0Y2hlcwogICAgICAgIGN0eC5zdGF0ZS5tYXJrc19wdXNoKCkKICAgICAgICBjdHguc3RhdGUucmVwZWF0ID0gcmVwZWF0LnByZXZpb3VzCiAgICAgICAgY2hpbGRfY29udGV4dCA9IGN0eC5wdXNoX25ld19jb250ZXh0KDEpCiAgICAgICAgeWllbGQgRmFsc2UKICAgICAgICBpZiBjaGlsZF9jb250ZXh0Lmhhc19tYXRjaGVkOgogICAgICAgICAgICBjdHguaGFzX21hdGNoZWQgPSBUcnVlCiAgICAgICAgICAgIHlpZWxkIFRydWUKICAgICAgICBjdHguc3RhdGUucmVwZWF0ID0gcmVwZWF0CiAgICAgICAgY3R4LnN0YXRlLnN0cmluZ19wb3NpdGlvbiA9IGN0eC5zdHJpbmdfcG9zaXRpb24KICAgICAgICBjdHguc3RhdGUubWFya3NfcG9wKCkKCiAgICAgICAgIyBtYXRjaCBtb3JlIHVudGlsIHRhaWwgbWF0Y2hlcwogICAgICAgIGlmIGNvdW50ID49IG1heGNvdW50IGFuZCBtYXhjb3VudCAhPSBNQVhSRVBFQVQ6CiAgICAgICAgICAgIGN0eC5oYXNfbWF0Y2hlZCA9IEZhbHNlCiAgICAgICAgICAgIHlpZWxkIFRydWUKICAgICAgICByZXBlYXQuY291bnQgPSBjb3VudAogICAgICAgIGNoaWxkX2NvbnRleHQgPSByZXBlYXQucHVzaF9uZXdfY29udGV4dCg0KQogICAgICAgIHlpZWxkIEZhbHNlCiAgICAgICAgY3R4Lmhhc19tYXRjaGVkID0gY2hpbGRfY29udGV4dC5oYXNfbWF0Y2hlZAogICAgICAgIGlmIG5vdCBjdHguaGFzX21hdGNoZWQ6CiAgICAgICAgICAgIHJlcGVhdC5jb3VudCA9IGNvdW50IC0gMQogICAgICAgICAgICBjdHguc3RhdGUuc3RyaW5nX3Bvc2l0aW9uID0gY3R4LnN0cmluZ19wb3NpdGlvbgogICAgICAgIHlpZWxkIFRydWUKCiAgICBkZWYgZ2VuZXJhbF9vcF9ncm91cHJlZihzZWxmLCBjdHgsIGRlY29yYXRlPWxhbWJkYSB4OiB4KToKICAgICAgICBncm91cF9zdGFydCwgZ3JvdXBfZW5kID0gY3R4LnN0YXRlLmdldF9tYXJrcyhjdHgucGVla19jb2RlKDEpKQogICAgICAgIGlmIGdyb3VwX3N0YXJ0IGlzIE5vbmUgb3IgZ3JvdXBfZW5kIGlzIE5vbmUgb3IgZ3JvdXBfZW5kIDwgZ3JvdXBfc3RhcnQ6CiAgICAgICAgICAgIGN0eC5oYXNfbWF0Y2hlZCA9IEZhbHNlCiAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgd2hpbGUgZ3JvdXBfc3RhcnQgPCBncm91cF9lbmQ6CiAgICAgICAgICAgIGlmIGN0eC5hdF9lbmQoKSBvciBkZWNvcmF0ZShvcmQoY3R4LnBlZWtfY2hhcigpKSkgXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICE9IGRlY29yYXRlKG9yZChjdHguc3RhdGUuc3RyaW5nW2dyb3VwX3N0YXJ0XSkpOgogICAgICAgICAgICAgICAgY3R4Lmhhc19tYXRjaGVkID0gRmFsc2UKICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgICAgIGdyb3VwX3N0YXJ0ICs9IDEKICAgICAgICAgICAgY3R4LnNraXBfY2hhcigxKQogICAgICAgIGN0eC5za2lwX2NvZGUoMikKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBvcF9ncm91cHJlZihzZWxmLCBjdHgpOgogICAgICAgICMgbWF0Y2ggYmFja3JlZmVyZW5jZQogICAgICAgICMgPEdST1VQUkVGPiA8emVyby1iYXNlZCBncm91cCBpbmRleD4KICAgICAgICAjc2VsZi5fbG9nKGN0eCwgIkdST1VQUkVGIiwgY3R4LnBlZWtfY29kZSgxKSkKICAgICAgICByZXR1cm4gc2VsZi5nZW5lcmFsX29wX2dyb3VwcmVmKGN0eCkKCiAgICBkZWYgb3BfZ3JvdXByZWZfaWdub3JlKHNlbGYsIGN0eCk6CiAgICAgICAgIyBtYXRjaCBiYWNrcmVmZXJlbmNlIGNhc2UtaW5zZW5zaXRpdmUKICAgICAgICAjIDxHUk9VUFJFRl9JR05PUkU+IDx6ZXJvLWJhc2VkIGdyb3VwIGluZGV4PgogICAgICAgICNzZWxmLl9sb2coY3R4LCAiR1JPVVBSRUZfSUdOT1JFIiwgY3R4LnBlZWtfY29kZSgxKSkKICAgICAgICByZXR1cm4gc2VsZi5nZW5lcmFsX29wX2dyb3VwcmVmKGN0eCwgY3R4LnN0YXRlLmxvd2VyKQoKICAgIGRlZiBvcF9ncm91cHJlZl9leGlzdHMoc2VsZiwgY3R4KToKICAgICAgICAjIDxHUk9VUFJFRl9FWElTVFM+IDxncm91cD4gPHNraXA+IGNvZGV5ZXMgPEpVTVA+IGNvZGVubyAuLi4KICAgICAgICAjc2VsZi5fbG9nKGN0eCwgIkdST1VQUkVGX0VYSVNUUyIsIGN0eC5wZWVrX2NvZGUoMSkpCiAgICAgICAgZ3JvdXBfc3RhcnQsIGdyb3VwX2VuZCA9IGN0eC5zdGF0ZS5nZXRfbWFya3MoY3R4LnBlZWtfY29kZSgxKSkKICAgICAgICBpZiBncm91cF9zdGFydCBpcyBOb25lIG9yIGdyb3VwX2VuZCBpcyBOb25lIG9yIGdyb3VwX2VuZCA8IGdyb3VwX3N0YXJ0OgogICAgICAgICAgICBjdHguc2tpcF9jb2RlKGN0eC5wZWVrX2NvZGUoMikgKyAxKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGN0eC5za2lwX2NvZGUoMykKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBvcF9hc3NlcnQoc2VsZiwgY3R4KToKICAgICAgICAjIGFzc2VydCBzdWJwYXR0ZXJuCiAgICAgICAgIyA8QVNTRVJUPiA8c2tpcD4gPGJhY2s+IDxwYXR0ZXJuPgogICAgICAgICNzZWxmLl9sb2coY3R4LCAiQVNTRVJUIiwgY3R4LnBlZWtfY29kZSgyKSkKICAgICAgICBjdHguc3RhdGUuc3RyaW5nX3Bvc2l0aW9uID0gY3R4LnN0cmluZ19wb3NpdGlvbiAtIGN0eC5wZWVrX2NvZGUoMikKICAgICAgICBpZiBjdHguc3RhdGUuc3RyaW5nX3Bvc2l0aW9uIDwgMDoKICAgICAgICAgICAgY3R4Lmhhc19tYXRjaGVkID0gRmFsc2UKICAgICAgICAgICAgeWllbGQgVHJ1ZQogICAgICAgIGNoaWxkX2NvbnRleHQgPSBjdHgucHVzaF9uZXdfY29udGV4dCgzKQogICAgICAgIHlpZWxkIEZhbHNlCiAgICAgICAgaWYgY2hpbGRfY29udGV4dC5oYXNfbWF0Y2hlZDoKICAgICAgICAgICAgY3R4LnNraXBfY29kZShjdHgucGVla19jb2RlKDEpICsgMSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBjdHguaGFzX21hdGNoZWQgPSBGYWxzZQogICAgICAgIHlpZWxkIFRydWUKCiAgICBkZWYgb3BfYXNzZXJ0X25vdChzZWxmLCBjdHgpOgogICAgICAgICMgYXNzZXJ0IG5vdCBzdWJwYXR0ZXJuCiAgICAgICAgIyA8QVNTRVJUX05PVD4gPHNraXA+IDxiYWNrPiA8cGF0dGVybj4KICAgICAgICAjc2VsZi5fbG9nKGN0eCwgIkFTU0VSVF9OT1QiLCBjdHgucGVla19jb2RlKDIpKQogICAgICAgIGN0eC5zdGF0ZS5zdHJpbmdfcG9zaXRpb24gPSBjdHguc3RyaW5nX3Bvc2l0aW9uIC0gY3R4LnBlZWtfY29kZSgyKQogICAgICAgIGlmIGN0eC5zdGF0ZS5zdHJpbmdfcG9zaXRpb24gPj0gMDoKICAgICAgICAgICAgY2hpbGRfY29udGV4dCA9IGN0eC5wdXNoX25ld19jb250ZXh0KDMpCiAgICAgICAgICAgIHlpZWxkIEZhbHNlCiAgICAgICAgICAgIGlmIGNoaWxkX2NvbnRleHQuaGFzX21hdGNoZWQ6CiAgICAgICAgICAgICAgICBjdHguaGFzX21hdGNoZWQgPSBGYWxzZQogICAgICAgICAgICAgICAgeWllbGQgVHJ1ZQogICAgICAgIGN0eC5za2lwX2NvZGUoY3R4LnBlZWtfY29kZSgxKSArIDEpCiAgICAgICAgeWllbGQgVHJ1ZQogICAgICAgIAogICAgZGVmIHVua25vd24oc2VsZiwgY3R4KToKICAgICAgICAjc2VsZi5fbG9nKGN0eCwgIlVOS05PV04iLCBjdHgucGVla19jb2RlKCkpCiAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCJJbnRlcm5hbCByZSBlcnJvci4gVW5rbm93biBvcGNvZGU6ICVzIiAlIGN0eC5wZWVrX2NvZGUoKSkKICAgICAgICAgICAgICAgIAogICAgZGVmIGNoZWNrX2NoYXJzZXQoc2VsZiwgY3R4LCBjaGFyKToKICAgICAgICAiIiJDaGVja3Mgd2hldGhlciBhIGNoYXJhY3RlciBtYXRjaGVzIHNldCBvZiBhcmJpdHJhcnkgbGVuZ3RoLiBBc3N1bWVzCiAgICAgICAgdGhlIGNvZGUgcG9pbnRlciBpcyBhdCB0aGUgZmlyc3QgbWVtYmVyIG9mIHRoZSBzZXQuIiIiCiAgICAgICAgc2VsZi5zZXRfZGlzcGF0Y2hlci5yZXNldChjaGFyKQogICAgICAgIHNhdmVfcG9zaXRpb24gPSBjdHguY29kZV9wb3NpdGlvbgogICAgICAgIHJlc3VsdCA9IE5vbmUKICAgICAgICB3aGlsZSByZXN1bHQgaXMgTm9uZToKICAgICAgICAgICAgcmVzdWx0ID0gc2VsZi5zZXRfZGlzcGF0Y2hlci5kaXNwYXRjaChjdHgucGVla19jb2RlKCksIGN0eCkKICAgICAgICBjdHguY29kZV9wb3NpdGlvbiA9IHNhdmVfcG9zaXRpb24KICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIGNvdW50X3JlcGV0aXRpb25zKHNlbGYsIGN0eCwgbWF4Y291bnQpOgogICAgICAgICIiIlJldHVybnMgdGhlIG51bWJlciBvZiByZXBldGl0aW9ucyBvZiBhIHNpbmdsZSBpdGVtLCBzdGFydGluZyBmcm9tIHRoZQogICAgICAgIGN1cnJlbnQgc3RyaW5nIHBvc2l0aW9uLiBUaGUgY29kZSBwb2ludGVyIGlzIGV4cGVjdGVkIHRvIHBvaW50IHRvIGEKICAgICAgICBSRVBFQVRfT05FIG9wZXJhdGlvbiAod2l0aCB0aGUgcmVwZWF0ZWQgNCBhaGVhZCkuIiIiCiAgICAgICAgY291bnQgPSAwCiAgICAgICAgcmVhbF9tYXhjb3VudCA9IGN0eC5zdGF0ZS5lbmQgLSBjdHguc3RyaW5nX3Bvc2l0aW9uCiAgICAgICAgaWYgbWF4Y291bnQgPCByZWFsX21heGNvdW50IGFuZCBtYXhjb3VudCAhPSBNQVhSRVBFQVQ6CiAgICAgICAgICAgIHJlYWxfbWF4Y291bnQgPSBtYXhjb3VudAogICAgICAgICMgWFhYIGNvdWxkIHNwZWNpYWwgY2FzZSBldmVyeSBzaW5nbGUgY2hhcmFjdGVyIHBhdHRlcm4gaGVyZSwgYXMgaW4gQy4KICAgICAgICAjIFRoaXMgaXMgYSBnZW5lcmFsIHNvbHV0aW9uLCBhIGJpdCBoYWNraXNjaCwgYnV0IHdvcmtzIGFuZCBzaG91bGQgYmUKICAgICAgICAjIGVmZmljaWVudC4KICAgICAgICBjb2RlX3Bvc2l0aW9uID0gY3R4LmNvZGVfcG9zaXRpb24KICAgICAgICBzdHJpbmdfcG9zaXRpb24gPSBjdHguc3RyaW5nX3Bvc2l0aW9uCiAgICAgICAgY3R4LnNraXBfY29kZSg0KQogICAgICAgIHJlc2V0X3Bvc2l0aW9uID0gY3R4LmNvZGVfcG9zaXRpb24KICAgICAgICB3aGlsZSBjb3VudCA8IHJlYWxfbWF4Y291bnQ6CiAgICAgICAgICAgICMgdGhpcyB3b3JrcyBiZWNhdXNlIHRoZSBzaW5nbGUgY2hhcmFjdGVyIHBhdHRlcm4gaXMgZm9sbG93ZWQgYnkKICAgICAgICAgICAgIyBhIHN1Y2Nlc3Mgb3Bjb2RlCiAgICAgICAgICAgIGN0eC5jb2RlX3Bvc2l0aW9uID0gcmVzZXRfcG9zaXRpb24KICAgICAgICAgICAgc2VsZi5kaXNwYXRjaChjdHgucGVla19jb2RlKCksIGN0eCkKICAgICAgICAgICAgaWYgY3R4Lmhhc19tYXRjaGVkIGlzIEZhbHNlOiAjIGNvdWxkIGJlIE5vbmUgYXMgd2VsbAogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgY291bnQgKz0gMQogICAgICAgIGN0eC5oYXNfbWF0Y2hlZCA9IE5vbmUKICAgICAgICBjdHguY29kZV9wb3NpdGlvbiA9IGNvZGVfcG9zaXRpb24KICAgICAgICBjdHguc3RyaW5nX3Bvc2l0aW9uID0gc3RyaW5nX3Bvc2l0aW9uCiAgICAgICAgcmV0dXJuIGNvdW50CgogICAgZGVmIF9sb2coc2VsZiwgY29udGV4dCwgb3BuYW1lLCAqYXJncyk6CiAgICAgICAgYXJnX3N0cmluZyA9ICgiJXMgIiAqIGxlbihhcmdzKSkgJSBhcmdzCiAgICAgICAgX2xvZygifCVzfCVzfCVzICVzIiAlIChjb250ZXh0LnBhdHRlcm5fY29kZXMsCiAgICAgICAgICAgIGNvbnRleHQuc3RyaW5nX3Bvc2l0aW9uLCBvcG5hbWUsIGFyZ19zdHJpbmcpKQoKX09wY29kZURpc3BhdGNoZXIuYnVpbGRfZGlzcGF0Y2hfdGFibGUoT1BDT0RFUywgIm9wXyIpCgoKY2xhc3MgX0NoYXJzZXREaXNwYXRjaGVyKF9EaXNwYXRjaGVyKToKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi5jaF9kaXNwYXRjaGVyID0gX0NoY29kZURpc3BhdGNoZXIoKQoKICAgIGRlZiByZXNldChzZWxmLCBjaGFyKToKICAgICAgICBzZWxmLmNoYXIgPSBjaGFyCiAgICAgICAgc2VsZi5vayA9IFRydWUKCiAgICBkZWYgc2V0X2ZhaWx1cmUoc2VsZiwgY3R4KToKICAgICAgICByZXR1cm4gbm90IHNlbGYub2sKICAgIGRlZiBzZXRfbGl0ZXJhbChzZWxmLCBjdHgpOgogICAgICAgICMgPExJVEVSQUw+IDxjb2RlPgogICAgICAgIGlmIGN0eC5wZWVrX2NvZGUoMSkgPT0gc2VsZi5jaGFyOgogICAgICAgICAgICByZXR1cm4gc2VsZi5vawogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGN0eC5za2lwX2NvZGUoMikKICAgIGRlZiBzZXRfY2F0ZWdvcnkoc2VsZiwgY3R4KToKICAgICAgICAjIDxDQVRFR09SWT4gPGNvZGU+CiAgICAgICAgaWYgc2VsZi5jaF9kaXNwYXRjaGVyLmRpc3BhdGNoKGN0eC5wZWVrX2NvZGUoMSksIGN0eCk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLm9rCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY3R4LnNraXBfY29kZSgyKQogICAgZGVmIHNldF9jaGFyc2V0KHNlbGYsIGN0eCk6CiAgICAgICAgIyA8Q0hBUlNFVD4gPGJpdG1hcD4gKDE2IGJpdHMgcGVyIGNvZGUgd29yZCkKICAgICAgICBjaGFyX2NvZGUgPSBzZWxmLmNoYXIKICAgICAgICBjdHguc2tpcF9jb2RlKDEpICMgcG9pbnQgdG8gYmVnaW5uaW5nIG9mIGJpdG1hcAogICAgICAgIGlmIENPREVTSVpFID09IDI6CiAgICAgICAgICAgIGlmIGNoYXJfY29kZSA8IDI1NiBhbmQgY3R4LnBlZWtfY29kZShjaGFyX2NvZGUgPj4gNCkgXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYgKDEgPDwgKGNoYXJfY29kZSAmIDE1KSk6CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5vawogICAgICAgICAgICBjdHguc2tpcF9jb2RlKDE2KSAjIHNraXAgYml0bWFwCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgY2hhcl9jb2RlIDwgMjU2IGFuZCBjdHgucGVla19jb2RlKGNoYXJfY29kZSA+PiA1KSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJiAoMSA8PCAoY2hhcl9jb2RlICYgMzEpKToKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLm9rCiAgICAgICAgICAgIGN0eC5za2lwX2NvZGUoOCkgIyBza2lwIGJpdG1hcAogICAgZGVmIHNldF9yYW5nZShzZWxmLCBjdHgpOgogICAgICAgICMgPFJBTkdFPiA8bG93ZXI+IDx1cHBlcj4KICAgICAgICBpZiBjdHgucGVla19jb2RlKDEpIDw9IHNlbGYuY2hhciA8PSBjdHgucGVla19jb2RlKDIpOgogICAgICAgICAgICByZXR1cm4gc2VsZi5vawogICAgICAgIGN0eC5za2lwX2NvZGUoMykKICAgIGRlZiBzZXRfbmVnYXRlKHNlbGYsIGN0eCk6CiAgICAgICAgc2VsZi5vayA9IG5vdCBzZWxmLm9rCiAgICAgICAgY3R4LnNraXBfY29kZSgxKQogICAgZGVmIHNldF9iaWdjaGFyc2V0KHNlbGYsIGN0eCk6CiAgICAgICAgIyA8QklHQ0hBUlNFVD4gPGJsb2NrY291bnQ+IDwyNTYgYmxvY2tpbmRpY2VzPiA8YmxvY2tzPgogICAgICAgIGNoYXJfY29kZSA9IHNlbGYuY2hhcgogICAgICAgIGNvdW50ID0gY3R4LnBlZWtfY29kZSgxKQogICAgICAgIGN0eC5za2lwX2NvZGUoMikKICAgICAgICBpZiBjaGFyX2NvZGUgPCA2NTUzNjoKICAgICAgICAgICAgYmxvY2tfaW5kZXggPSBjaGFyX2NvZGUgPj4gOAogICAgICAgICAgICAjIE5COiB0aGVyZSBhcmUgQ09ERVNJWkUgYmxvY2sgaW5kaWNlcyBwZXIgYnl0ZWNvZGUKICAgICAgICAgICAgYSA9IGFycmF5LmFycmF5KCJCIikKICAgICAgICAgICAgYS5mcm9tc3RyaW5nKGFycmF5LmFycmF5KENPREVTSVpFID09IDIgYW5kICJIIiBvciAiSSIsCiAgICAgICAgICAgICAgICAgICAgW2N0eC5wZWVrX2NvZGUoYmxvY2tfaW5kZXggLyBDT0RFU0laRSldKS50b3N0cmluZygpKQogICAgICAgICAgICBibG9jayA9IGFbYmxvY2tfaW5kZXggJSBDT0RFU0laRV0KICAgICAgICAgICAgY3R4LnNraXBfY29kZSgyNTYgLyBDT0RFU0laRSkgIyBza2lwIGJsb2NrIGluZGljZXMKICAgICAgICAgICAgYmxvY2tfdmFsdWUgPSBjdHgucGVla19jb2RlKGJsb2NrICogKDMyIC8gQ09ERVNJWkUpCiAgICAgICAgICAgICAgICAgICAgKyAoKGNoYXJfY29kZSAmIDI1NSkgPj4gKENPREVTSVpFID09IDIgYW5kIDQgb3IgNSkpKQogICAgICAgICAgICBpZiBibG9ja192YWx1ZSAmICgxIDw8IChjaGFyX2NvZGUgJiAoKDggKiBDT0RFU0laRSkgLSAxKSkpOgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYub2sKICAgICAgICBlbHNlOgogICAgICAgICAgICBjdHguc2tpcF9jb2RlKDI1NiAvIENPREVTSVpFKSAjIHNraXAgYmxvY2sgaW5kaWNlcwogICAgICAgIGN0eC5za2lwX2NvZGUoY291bnQgKiAoMzIgLyBDT0RFU0laRSkpICMgc2tpcCBibG9ja3MKICAgIGRlZiB1bmtub3duKHNlbGYsIGN0eCk6CiAgICAgICAgcmV0dXJuIEZhbHNlCgpfQ2hhcnNldERpc3BhdGNoZXIuYnVpbGRfZGlzcGF0Y2hfdGFibGUoT1BDT0RFUywgInNldF8iKQoKCmNsYXNzIF9BdGNvZGVEaXNwYXRjaGVyKF9EaXNwYXRjaGVyKToKCiAgICBkZWYgYXRfYmVnaW5uaW5nKHNlbGYsIGN0eCk6CiAgICAgICAgcmV0dXJuIGN0eC5hdF9iZWdpbm5pbmcoKQogICAgYXRfYmVnaW5uaW5nX3N0cmluZyA9IGF0X2JlZ2lubmluZwogICAgZGVmIGF0X2JlZ2lubmluZ19saW5lKHNlbGYsIGN0eCk6CiAgICAgICAgcmV0dXJuIGN0eC5hdF9iZWdpbm5pbmcoKSBvciBfaXNfbGluZWJyZWFrKGN0eC5wZWVrX2NoYXIoLTEpKQogICAgZGVmIGF0X2VuZChzZWxmLCBjdHgpOgogICAgICAgIHJldHVybiAoY3R4LnJlbWFpbmluZ19jaGFycygpID09IDEgYW5kIGN0eC5hdF9saW5lYnJlYWsoKSkgb3IgY3R4LmF0X2VuZCgpCiAgICBkZWYgYXRfZW5kX2xpbmUoc2VsZiwgY3R4KToKICAgICAgICByZXR1cm4gY3R4LmF0X2xpbmVicmVhaygpIG9yIGN0eC5hdF9lbmQoKQogICAgZGVmIGF0X2VuZF9zdHJpbmcoc2VsZiwgY3R4KToKICAgICAgICByZXR1cm4gY3R4LmF0X2VuZCgpCiAgICBkZWYgYXRfYm91bmRhcnkoc2VsZiwgY3R4KToKICAgICAgICByZXR1cm4gY3R4LmF0X2JvdW5kYXJ5KF9pc193b3JkKQogICAgZGVmIGF0X25vbl9ib3VuZGFyeShzZWxmLCBjdHgpOgogICAgICAgIHJldHVybiBub3QgY3R4LmF0X2JvdW5kYXJ5KF9pc193b3JkKQogICAgZGVmIGF0X2xvY19ib3VuZGFyeShzZWxmLCBjdHgpOgogICAgICAgIHJldHVybiBjdHguYXRfYm91bmRhcnkoX2lzX2xvY193b3JkKQogICAgZGVmIGF0X2xvY19ub25fYm91bmRhcnkoc2VsZiwgY3R4KToKICAgICAgICByZXR1cm4gbm90IGN0eC5hdF9ib3VuZGFyeShfaXNfbG9jX3dvcmQpCiAgICBkZWYgYXRfdW5pX2JvdW5kYXJ5KHNlbGYsIGN0eCk6CiAgICAgICAgcmV0dXJuIGN0eC5hdF9ib3VuZGFyeShfaXNfdW5pX3dvcmQpCiAgICBkZWYgYXRfdW5pX25vbl9ib3VuZGFyeShzZWxmLCBjdHgpOgogICAgICAgIHJldHVybiBub3QgY3R4LmF0X2JvdW5kYXJ5KF9pc191bmlfd29yZCkKICAgIGRlZiB1bmtub3duKHNlbGYsIGN0eCk6CiAgICAgICAgcmV0dXJuIEZhbHNlCgpfQXRjb2RlRGlzcGF0Y2hlci5idWlsZF9kaXNwYXRjaF90YWJsZShBVENPREVTLCAiIikKCgpjbGFzcyBfQ2hjb2RlRGlzcGF0Y2hlcihfRGlzcGF0Y2hlcik6CgogICAgZGVmIGNhdGVnb3J5X2RpZ2l0KHNlbGYsIGN0eCk6CiAgICAgICAgcmV0dXJuIF9pc19kaWdpdChjdHgucGVla19jaGFyKCkpCiAgICBkZWYgY2F0ZWdvcnlfbm90X2RpZ2l0KHNlbGYsIGN0eCk6CiAgICAgICAgcmV0dXJuIG5vdCBfaXNfZGlnaXQoY3R4LnBlZWtfY2hhcigpKQogICAgZGVmIGNhdGVnb3J5X3NwYWNlKHNlbGYsIGN0eCk6CiAgICAgICAgcmV0dXJuIF9pc19zcGFjZShjdHgucGVla19jaGFyKCkpCiAgICBkZWYgY2F0ZWdvcnlfbm90X3NwYWNlKHNlbGYsIGN0eCk6CiAgICAgICAgcmV0dXJuIG5vdCBfaXNfc3BhY2UoY3R4LnBlZWtfY2hhcigpKQogICAgZGVmIGNhdGVnb3J5X3dvcmQoc2VsZiwgY3R4KToKICAgICAgICByZXR1cm4gX2lzX3dvcmQoY3R4LnBlZWtfY2hhcigpKQogICAgZGVmIGNhdGVnb3J5X25vdF93b3JkKHNlbGYsIGN0eCk6CiAgICAgICAgcmV0dXJuIG5vdCBfaXNfd29yZChjdHgucGVla19jaGFyKCkpCiAgICBkZWYgY2F0ZWdvcnlfbGluZWJyZWFrKHNlbGYsIGN0eCk6CiAgICAgICAgcmV0dXJuIF9pc19saW5lYnJlYWsoY3R4LnBlZWtfY2hhcigpKQogICAgZGVmIGNhdGVnb3J5X25vdF9saW5lYnJlYWsoc2VsZiwgY3R4KToKICAgICAgICByZXR1cm4gbm90IF9pc19saW5lYnJlYWsoY3R4LnBlZWtfY2hhcigpKQogICAgZGVmIGNhdGVnb3J5X2xvY193b3JkKHNlbGYsIGN0eCk6CiAgICAgICAgcmV0dXJuIF9pc19sb2Nfd29yZChjdHgucGVla19jaGFyKCkpCiAgICBkZWYgY2F0ZWdvcnlfbG9jX25vdF93b3JkKHNlbGYsIGN0eCk6CiAgICAgICAgcmV0dXJuIG5vdCBfaXNfbG9jX3dvcmQoY3R4LnBlZWtfY2hhcigpKQogICAgZGVmIGNhdGVnb3J5X3VuaV9kaWdpdChzZWxmLCBjdHgpOgogICAgICAgIHJldHVybiBjdHgucGVla19jaGFyKCkuaXNkaWdpdCgpCiAgICBkZWYgY2F0ZWdvcnlfdW5pX25vdF9kaWdpdChzZWxmLCBjdHgpOgogICAgICAgIHJldHVybiBub3QgY3R4LnBlZWtfY2hhcigpLmlzZGlnaXQoKQogICAgZGVmIGNhdGVnb3J5X3VuaV9zcGFjZShzZWxmLCBjdHgpOgogICAgICAgIHJldHVybiBjdHgucGVla19jaGFyKCkuaXNzcGFjZSgpCiAgICBkZWYgY2F0ZWdvcnlfdW5pX25vdF9zcGFjZShzZWxmLCBjdHgpOgogICAgICAgIHJldHVybiBub3QgY3R4LnBlZWtfY2hhcigpLmlzc3BhY2UoKQogICAgZGVmIGNhdGVnb3J5X3VuaV93b3JkKHNlbGYsIGN0eCk6CiAgICAgICAgcmV0dXJuIF9pc191bmlfd29yZChjdHgucGVla19jaGFyKCkpCiAgICBkZWYgY2F0ZWdvcnlfdW5pX25vdF93b3JkKHNlbGYsIGN0eCk6CiAgICAgICAgcmV0dXJuIG5vdCBfaXNfdW5pX3dvcmQoY3R4LnBlZWtfY2hhcigpKQogICAgZGVmIGNhdGVnb3J5X3VuaV9saW5lYnJlYWsoc2VsZiwgY3R4KToKICAgICAgICByZXR1cm4gb3JkKGN0eC5wZWVrX2NoYXIoKSkgaW4gX3VuaV9saW5lYnJlYWtzCiAgICBkZWYgY2F0ZWdvcnlfdW5pX25vdF9saW5lYnJlYWsoc2VsZiwgY3R4KToKICAgICAgICByZXR1cm4gb3JkKGN0eC5wZWVrX2NoYXIoKSkgbm90IGluIF91bmlfbGluZWJyZWFrcwogICAgZGVmIHVua25vd24oc2VsZiwgY3R4KToKICAgICAgICByZXR1cm4gRmFsc2UKCl9DaGNvZGVEaXNwYXRjaGVyLmJ1aWxkX2Rpc3BhdGNoX3RhYmxlKENIQ09ERVMsICIiKQoKCl9hc2NpaV9jaGFyX2luZm8gPSBbIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDIsIDYsIDIsCjIsIDIsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDIsIDAsIDAsCjAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDI1LCAyNSwgMjUsIDI1LCAyNSwgMjUsIDI1LCAyNSwKMjUsIDI1LCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwKMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDAsIDAsCjAsIDAsIDE2LCAwLCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsCjI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDAsIDAsIDAsIDAsIDAgXQoKZGVmIF9pc19kaWdpdChjaGFyKToKICAgIGNvZGUgPSBvcmQoY2hhcikKICAgIHJldHVybiBjb2RlIDwgMTI4IGFuZCBfYXNjaWlfY2hhcl9pbmZvW2NvZGVdICYgMQoKZGVmIF9pc19zcGFjZShjaGFyKToKICAgIGNvZGUgPSBvcmQoY2hhcikKICAgIHJldHVybiBjb2RlIDwgMTI4IGFuZCBfYXNjaWlfY2hhcl9pbmZvW2NvZGVdICYgMgoKZGVmIF9pc193b3JkKGNoYXIpOgogICAgIyBOQjogbm9uLUFTQ0lJIGNoYXJzIGFyZW4ndCB3b3JkcyBhY2NvcmRpbmcgdG8gX3NyZS5jCiAgICBjb2RlID0gb3JkKGNoYXIpCiAgICByZXR1cm4gY29kZSA8IDEyOCBhbmQgX2FzY2lpX2NoYXJfaW5mb1tjb2RlXSAmIDE2CgpkZWYgX2lzX2xvY193b3JkKGNoYXIpOgogICAgcmV0dXJuIChub3QgKG9yZChjaGFyKSAmIH4yNTUpIGFuZCBjaGFyLmlzYWxudW0oKSkgb3IgY2hhciA9PSAnXycKCmRlZiBfaXNfdW5pX3dvcmQoY2hhcik6CiAgICByZXR1cm4gdW5pY2hyKG9yZChjaGFyKSkuaXNhbG51bSgpIG9yIGNoYXIgPT0gJ18nCgpkZWYgX2lzX2xpbmVicmVhayhjaGFyKToKICAgIHJldHVybiBjaGFyID09ICJcbiIKCiMgU3RhdGljIGxpc3Qgb2YgYWxsIHVuaWNvZGUgY29kZXBvaW50cyByZXBvcnRlZCBieSBQeV9VTklDT0RFX0lTTElORUJSRUFLLgpfdW5pX2xpbmVicmVha3MgPSBbMTAsIDEzLCAyOCwgMjksIDMwLCAxMzMsIDgyMzIsIDgyMzNdCgpkZWYgX2xvZyhtZXNzYWdlKToKICAgIGlmIDA6CiAgICAgICAgcHJpbnQobWVzc2FnZSkK',
'/Lib/browser/__init__.py':'ZnJvbSBfYnJvd3NlciBpbXBvcnQgKgppbXBvcnQgaHRtbAppbXBvcnQgYWpheAppbXBvcnQgd2Vic29ja2V0Cg==',
'/Lib/collections/abc.py':'IyBDb3B5cmlnaHQgMjAwNyBHb29nbGUsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KIyBMaWNlbnNlZCB0byBQU0YgdW5kZXIgYSBDb250cmlidXRvciBBZ3JlZW1lbnQuCgoiIiJBYnN0cmFjdCBCYXNlIENsYXNzZXMgKEFCQ3MpIGZvciBjb2xsZWN0aW9ucywgYWNjb3JkaW5nIHRvIFBFUCAzMTE5LgoKVW5pdCB0ZXN0cyBhcmUgaW4gdGVzdF9jb2xsZWN0aW9ucy4KIiIiCgpmcm9tIGFiYyBpbXBvcnQgQUJDTWV0YSwgYWJzdHJhY3RtZXRob2QKaW1wb3J0IHN5cwoKX19hbGxfXyA9IFsiSGFzaGFibGUiLCAiSXRlcmFibGUiLCAiSXRlcmF0b3IiLAogICAgICAgICAgICJTaXplZCIsICJDb250YWluZXIiLCAiQ2FsbGFibGUiLAogICAgICAgICAgICJTZXQiLCAiTXV0YWJsZVNldCIsCiAgICAgICAgICAgIk1hcHBpbmciLCAiTXV0YWJsZU1hcHBpbmciLAogICAgICAgICAgICJNYXBwaW5nVmlldyIsICJLZXlzVmlldyIsICJJdGVtc1ZpZXciLCAiVmFsdWVzVmlldyIsCiAgICAgICAgICAgIlNlcXVlbmNlIiwgIk11dGFibGVTZXF1ZW5jZSIsCiAgICAgICAgICAgIkJ5dGVTdHJpbmciLAogICAgICAgICAgIF0KCiMgUHJpdmF0ZSBsaXN0IG9mIHR5cGVzIHRoYXQgd2Ugd2FudCB0byByZWdpc3RlciB3aXRoIHRoZSB2YXJpb3VzIEFCQ3MKIyBzbyB0aGF0IHRoZXkgd2lsbCBwYXNzIHRlc3RzIGxpa2U6CiMgICAgICAgaXQgPSBpdGVyKHNvbWVieXRlYXJyYXkpCiMgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2UoaXQsIEl0ZXJhYmxlKQojIE5vdGU6ICBpbiBvdGhlciBpbXBsZW1lbnRhdGlvbnMsIHRoZXNlIHR5cGVzIG1hbnkgbm90IGJlIGRpc3RpbmN0CiMgYW5kIHRoZXkgbWFrZSBoYXZlIHRoZWlyIG93biBpbXBsZW1lbnRhdGlvbiBzcGVjaWZpYyB0eXBlcyB0aGF0CiMgYXJlIG5vdCBpbmNsdWRlZCBvbiB0aGlzIGxpc3QuCmJ5dGVzX2l0ZXJhdG9yID0gdHlwZShpdGVyKGInJykpCmJ5dGVhcnJheV9pdGVyYXRvciA9IHR5cGUoaXRlcihieXRlYXJyYXkoKSkpCiNjYWxsYWJsZV9pdGVyYXRvciA9ID8/PwpkaWN0X2tleWl0ZXJhdG9yID0gdHlwZShpdGVyKHt9LmtleXMoKSkpCmRpY3RfdmFsdWVpdGVyYXRvciA9IHR5cGUoaXRlcih7fS52YWx1ZXMoKSkpCmRpY3RfaXRlbWl0ZXJhdG9yID0gdHlwZShpdGVyKHt9Lml0ZW1zKCkpKQpsaXN0X2l0ZXJhdG9yID0gdHlwZShpdGVyKFtdKSkKbGlzdF9yZXZlcnNlaXRlcmF0b3IgPSB0eXBlKGl0ZXIocmV2ZXJzZWQoW10pKSkKcmFuZ2VfaXRlcmF0b3IgPSB0eXBlKGl0ZXIocmFuZ2UoMCkpKQpzZXRfaXRlcmF0b3IgPSB0eXBlKGl0ZXIoc2V0KCkpKQpzdHJfaXRlcmF0b3IgPSB0eXBlKGl0ZXIoIiIpKQp0dXBsZV9pdGVyYXRvciA9IHR5cGUoaXRlcigoKSkpCnppcF9pdGVyYXRvciA9IHR5cGUoaXRlcih6aXAoKSkpCiMjIHZpZXdzICMjCmRpY3Rfa2V5cyA9IHR5cGUoe30ua2V5cygpKQpkaWN0X3ZhbHVlcyA9IHR5cGUoe30udmFsdWVzKCkpCmRpY3RfaXRlbXMgPSB0eXBlKHt9Lml0ZW1zKCkpCiMjIG1pc2MgIyMKbWFwcGluZ3Byb3h5ID0gdHlwZSh0eXBlLl9fZGljdF9fKQoKCiMjIyBPTkUtVFJJQ0sgUE9OSUVTICMjIwoKY2xhc3MgSGFzaGFibGUobWV0YWNsYXNzPUFCQ01ldGEpOgoKICAgIF9fc2xvdHNfXyA9ICgpCgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgX19oYXNoX18oc2VsZik6CiAgICAgICAgcmV0dXJuIDAKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBfX3N1YmNsYXNzaG9va19fKGNscywgQyk6CiAgICAgICAgaWYgY2xzIGlzIEhhc2hhYmxlOgogICAgICAgICAgICBmb3IgQiBpbiBDLl9fbXJvX186CiAgICAgICAgICAgICAgICBpZiAiX19oYXNoX18iIGluIEIuX19kaWN0X186CiAgICAgICAgICAgICAgICAgICAgaWYgQi5fX2RpY3RfX1siX19oYXNoX18iXToKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKCmNsYXNzIEl0ZXJhYmxlKG1ldGFjbGFzcz1BQkNNZXRhKToKCiAgICBfX3Nsb3RzX18gPSAoKQoKICAgIEBhYnN0cmFjdG1ldGhvZAogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHdoaWxlIEZhbHNlOgogICAgICAgICAgICB5aWVsZCBOb25lCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgX19zdWJjbGFzc2hvb2tfXyhjbHMsIEMpOgogICAgICAgIGlmIGNscyBpcyBJdGVyYWJsZToKICAgICAgICAgICAgaWYgYW55KCJfX2l0ZXJfXyIgaW4gQi5fX2RpY3RfXyBmb3IgQiBpbiBDLl9fbXJvX18pOgogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCgpjbGFzcyBJdGVyYXRvcihJdGVyYWJsZSk6CgogICAgX19zbG90c19fID0gKCkKCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBfX25leHRfXyhzZWxmKToKICAgICAgICByYWlzZSBTdG9wSXRlcmF0aW9uCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgX19zdWJjbGFzc2hvb2tfXyhjbHMsIEMpOgogICAgICAgIGlmIGNscyBpcyBJdGVyYXRvcjoKICAgICAgICAgICAgaWYgKGFueSgiX19uZXh0X18iIGluIEIuX19kaWN0X18gZm9yIEIgaW4gQy5fX21yb19fKSBhbmQKICAgICAgICAgICAgICAgIGFueSgiX19pdGVyX18iIGluIEIuX19kaWN0X18gZm9yIEIgaW4gQy5fX21yb19fKSk6CiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKSXRlcmF0b3IucmVnaXN0ZXIoYnl0ZXNfaXRlcmF0b3IpCkl0ZXJhdG9yLnJlZ2lzdGVyKGJ5dGVhcnJheV9pdGVyYXRvcikKI0l0ZXJhdG9yLnJlZ2lzdGVyKGNhbGxhYmxlX2l0ZXJhdG9yKQpJdGVyYXRvci5yZWdpc3RlcihkaWN0X2tleWl0ZXJhdG9yKQpJdGVyYXRvci5yZWdpc3RlcihkaWN0X3ZhbHVlaXRlcmF0b3IpCkl0ZXJhdG9yLnJlZ2lzdGVyKGRpY3RfaXRlbWl0ZXJhdG9yKQpJdGVyYXRvci5yZWdpc3RlcihsaXN0X2l0ZXJhdG9yKQpJdGVyYXRvci5yZWdpc3RlcihsaXN0X3JldmVyc2VpdGVyYXRvcikKSXRlcmF0b3IucmVnaXN0ZXIocmFuZ2VfaXRlcmF0b3IpCkl0ZXJhdG9yLnJlZ2lzdGVyKHNldF9pdGVyYXRvcikKSXRlcmF0b3IucmVnaXN0ZXIoc3RyX2l0ZXJhdG9yKQpJdGVyYXRvci5yZWdpc3Rlcih0dXBsZV9pdGVyYXRvcikKSXRlcmF0b3IucmVnaXN0ZXIoemlwX2l0ZXJhdG9yKQoKY2xhc3MgU2l6ZWQobWV0YWNsYXNzPUFCQ01ldGEpOgoKICAgIF9fc2xvdHNfXyA9ICgpCgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgX19sZW5fXyhzZWxmKToKICAgICAgICByZXR1cm4gMAoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIF9fc3ViY2xhc3Nob29rX18oY2xzLCBDKToKICAgICAgICBpZiBjbHMgaXMgU2l6ZWQ6CiAgICAgICAgICAgIGlmIGFueSgiX19sZW5fXyIgaW4gQi5fX2RpY3RfXyBmb3IgQiBpbiBDLl9fbXJvX18pOgogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCgpjbGFzcyBDb250YWluZXIobWV0YWNsYXNzPUFCQ01ldGEpOgoKICAgIF9fc2xvdHNfXyA9ICgpCgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgX19jb250YWluc19fKHNlbGYsIHgpOgogICAgICAgIHJldHVybiBGYWxzZQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIF9fc3ViY2xhc3Nob29rX18oY2xzLCBDKToKICAgICAgICBpZiBjbHMgaXMgQ29udGFpbmVyOgogICAgICAgICAgICBpZiBhbnkoIl9fY29udGFpbnNfXyIgaW4gQi5fX2RpY3RfXyBmb3IgQiBpbiBDLl9fbXJvX18pOgogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCgpjbGFzcyBDYWxsYWJsZShtZXRhY2xhc3M9QUJDTWV0YSk6CgogICAgX19zbG90c19fID0gKCkKCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBfX2NhbGxfXyhzZWxmLCAqYXJncywgKiprd2RzKToKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBfX3N1YmNsYXNzaG9va19fKGNscywgQyk6CiAgICAgICAgaWYgY2xzIGlzIENhbGxhYmxlOgogICAgICAgICAgICBpZiBhbnkoIl9fY2FsbF9fIiBpbiBCLl9fZGljdF9fIGZvciBCIGluIEMuX19tcm9fXyk6CiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKCiMjIyBTRVRTICMjIwoKCmNsYXNzIFNldChTaXplZCwgSXRlcmFibGUsIENvbnRhaW5lcik6CgogICAgIiIiQSBzZXQgaXMgYSBmaW5pdGUsIGl0ZXJhYmxlIGNvbnRhaW5lci4KCiAgICBUaGlzIGNsYXNzIHByb3ZpZGVzIGNvbmNyZXRlIGdlbmVyaWMgaW1wbGVtZW50YXRpb25zIG9mIGFsbAogICAgbWV0aG9kcyBleGNlcHQgZm9yIF9fY29udGFpbnNfXywgX19pdGVyX18gYW5kIF9fbGVuX18uCgogICAgVG8gb3ZlcnJpZGUgdGhlIGNvbXBhcmlzb25zIChwcmVzdW1hYmx5IGZvciBzcGVlZCwgYXMgdGhlCiAgICBzZW1hbnRpY3MgYXJlIGZpeGVkKSwgYWxsIHlvdSBoYXZlIHRvIGRvIGlzIHJlZGVmaW5lIF9fbGVfXyBhbmQKICAgIHRoZW4gdGhlIG90aGVyIG9wZXJhdGlvbnMgd2lsbCBhdXRvbWF0aWNhbGx5IGZvbGxvdyBzdWl0LgogICAgIiIiCgogICAgX19zbG90c19fID0gKCkKCiAgICBkZWYgX19sZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgU2V0KToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgaWYgbGVuKHNlbGYpID4gbGVuKG90aGVyKToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgZm9yIGVsZW0gaW4gc2VsZjoKICAgICAgICAgICAgaWYgZWxlbSBub3QgaW4gb3RoZXI6CiAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBfX2x0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBTZXQpOgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKICAgICAgICByZXR1cm4gbGVuKHNlbGYpIDwgbGVuKG90aGVyKSBhbmQgc2VsZi5fX2xlX18ob3RoZXIpCgogICAgZGVmIF9fZ3RfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIFNldCk6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAogICAgICAgIHJldHVybiBvdGhlciA8IHNlbGYKCiAgICBkZWYgX19nZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgU2V0KToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgcmV0dXJuIG90aGVyIDw9IHNlbGYKCiAgICBkZWYgX19lcV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgU2V0KToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgcmV0dXJuIGxlbihzZWxmKSA9PSBsZW4ob3RoZXIpIGFuZCBzZWxmLl9fbGVfXyhvdGhlcikKCiAgICBkZWYgX19uZV9fKHNlbGYsIG90aGVyKToKICAgICAgICByZXR1cm4gbm90IChzZWxmID09IG90aGVyKQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIF9mcm9tX2l0ZXJhYmxlKGNscywgaXQpOgogICAgICAgICcnJ0NvbnN0cnVjdCBhbiBpbnN0YW5jZSBvZiB0aGUgY2xhc3MgZnJvbSBhbnkgaXRlcmFibGUgaW5wdXQuCgogICAgICAgIE11c3Qgb3ZlcnJpZGUgdGhpcyBtZXRob2QgaWYgdGhlIGNsYXNzIGNvbnN0cnVjdG9yIHNpZ25hdHVyZQogICAgICAgIGRvZXMgbm90IGFjY2VwdCBhbiBpdGVyYWJsZSBmb3IgYW4gaW5wdXQuCiAgICAgICAgJycnCiAgICAgICAgcmV0dXJuIGNscyhpdCkKCiAgICBkZWYgX19hbmRfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIEl0ZXJhYmxlKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgcmV0dXJuIHNlbGYuX2Zyb21faXRlcmFibGUodmFsdWUgZm9yIHZhbHVlIGluIG90aGVyIGlmIHZhbHVlIGluIHNlbGYpCgogICAgZGVmIGlzZGlzam9pbnQoc2VsZiwgb3RoZXIpOgogICAgICAgIGZvciB2YWx1ZSBpbiBvdGhlcjoKICAgICAgICAgICAgaWYgdmFsdWUgaW4gc2VsZjoKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIF9fb3JfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIEl0ZXJhYmxlKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgY2hhaW4gPSAoZSBmb3IgcyBpbiAoc2VsZiwgb3RoZXIpIGZvciBlIGluIHMpCiAgICAgICAgcmV0dXJuIHNlbGYuX2Zyb21faXRlcmFibGUoY2hhaW4pCgogICAgZGVmIF9fc3ViX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBTZXQpOgogICAgICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgSXRlcmFibGUpOgogICAgICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgICAgIG90aGVyID0gc2VsZi5fZnJvbV9pdGVyYWJsZShvdGhlcikKICAgICAgICByZXR1cm4gc2VsZi5fZnJvbV9pdGVyYWJsZSh2YWx1ZSBmb3IgdmFsdWUgaW4gc2VsZgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHZhbHVlIG5vdCBpbiBvdGhlcikKCiAgICBkZWYgX194b3JfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIFNldCk6CiAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBJdGVyYWJsZSk6CiAgICAgICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKICAgICAgICAgICAgb3RoZXIgPSBzZWxmLl9mcm9tX2l0ZXJhYmxlKG90aGVyKQogICAgICAgIHJldHVybiAoc2VsZiAtIG90aGVyKSB8IChvdGhlciAtIHNlbGYpCgogICAgZGVmIF9oYXNoKHNlbGYpOgogICAgICAgICIiIkNvbXB1dGUgdGhlIGhhc2ggdmFsdWUgb2YgYSBzZXQuCgogICAgICAgIE5vdGUgdGhhdCB3ZSBkb24ndCBkZWZpbmUgX19oYXNoX186IG5vdCBhbGwgc2V0cyBhcmUgaGFzaGFibGUuCiAgICAgICAgQnV0IGlmIHlvdSBkZWZpbmUgYSBoYXNoYWJsZSBzZXQgdHlwZSwgaXRzIF9faGFzaF9fIHNob3VsZAogICAgICAgIGNhbGwgdGhpcyBmdW5jdGlvbi4KCiAgICAgICAgVGhpcyBtdXN0IGJlIGNvbXBhdGlibGUgX19lcV9fLgoKICAgICAgICBBbGwgc2V0cyBvdWdodCB0byBjb21wYXJlIGVxdWFsIGlmIHRoZXkgY29udGFpbiB0aGUgc2FtZQogICAgICAgIGVsZW1lbnRzLCByZWdhcmRsZXNzIG9mIGhvdyB0aGV5IGFyZSBpbXBsZW1lbnRlZCwgYW5kCiAgICAgICAgcmVnYXJkbGVzcyBvZiB0aGUgb3JkZXIgb2YgdGhlIGVsZW1lbnRzOyBzbyB0aGVyZSdzIG5vdCBtdWNoCiAgICAgICAgZnJlZWRvbSBmb3IgX19lcV9fIG9yIF9faGFzaF9fLiAgV2UgbWF0Y2ggdGhlIGFsZ29yaXRobSB1c2VkCiAgICAgICAgYnkgdGhlIGJ1aWx0LWluIGZyb3plbnNldCB0eXBlLgogICAgICAgICIiIgogICAgICAgIE1BWCA9IHN5cy5tYXhzaXplCiAgICAgICAgTUFTSyA9IDIgKiBNQVggKyAxCiAgICAgICAgbiA9IGxlbihzZWxmKQogICAgICAgIGggPSAxOTI3ODY4MjM3ICogKG4gKyAxKQogICAgICAgIGggJj0gTUFTSwogICAgICAgIGZvciB4IGluIHNlbGY6CiAgICAgICAgICAgIGh4ID0gaGFzaCh4KQogICAgICAgICAgICBoIF49IChoeCBeIChoeCA8PCAxNikgXiA4OTg2OTc0NykgICogMzY0NDc5ODE2NwogICAgICAgICAgICBoICY9IE1BU0sKICAgICAgICBoID0gaCAqIDY5MDY5ICsgOTA3MTMzOTIzCiAgICAgICAgaCAmPSBNQVNLCiAgICAgICAgaWYgaCA+IE1BWDoKICAgICAgICAgICAgaCAtPSBNQVNLICsgMQogICAgICAgIGlmIGggPT0gLTE6CiAgICAgICAgICAgIGggPSA1OTA5MjM3MTMKICAgICAgICByZXR1cm4gaAoKU2V0LnJlZ2lzdGVyKGZyb3plbnNldCkKCgpjbGFzcyBNdXRhYmxlU2V0KFNldCk6CgogICAgX19zbG90c19fID0gKCkKCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBhZGQoc2VsZiwgdmFsdWUpOgogICAgICAgICIiIkFkZCBhbiBlbGVtZW50LiIiIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IKCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBkaXNjYXJkKHNlbGYsIHZhbHVlKToKICAgICAgICAiIiJSZW1vdmUgYW4gZWxlbWVudC4gIERvIG5vdCByYWlzZSBhbiBleGNlcHRpb24gaWYgYWJzZW50LiIiIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IKCiAgICBkZWYgcmVtb3ZlKHNlbGYsIHZhbHVlKToKICAgICAgICAiIiJSZW1vdmUgYW4gZWxlbWVudC4gSWYgbm90IGEgbWVtYmVyLCByYWlzZSBhIEtleUVycm9yLiIiIgogICAgICAgIGlmIHZhbHVlIG5vdCBpbiBzZWxmOgogICAgICAgICAgICByYWlzZSBLZXlFcnJvcih2YWx1ZSkKICAgICAgICBzZWxmLmRpc2NhcmQodmFsdWUpCgogICAgZGVmIHBvcChzZWxmKToKICAgICAgICAiIiJSZXR1cm4gdGhlIHBvcHBlZCB2YWx1ZS4gIFJhaXNlIEtleUVycm9yIGlmIGVtcHR5LiIiIgogICAgICAgIGl0ID0gaXRlcihzZWxmKQogICAgICAgIHRyeToKICAgICAgICAgICAgdmFsdWUgPSBuZXh0KGl0KQogICAgICAgIGV4Y2VwdCBTdG9wSXRlcmF0aW9uOgogICAgICAgICAgICByYWlzZSBLZXlFcnJvcgogICAgICAgIHNlbGYuZGlzY2FyZCh2YWx1ZSkKICAgICAgICByZXR1cm4gdmFsdWUKCiAgICBkZWYgY2xlYXIoc2VsZik6CiAgICAgICAgIiIiVGhpcyBpcyBzbG93IChjcmVhdGVzIE4gbmV3IGl0ZXJhdG9ycyEpIGJ1dCBlZmZlY3RpdmUuIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgc2VsZi5wb3AoKQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgcGFzcwoKICAgIGRlZiBfX2lvcl9fKHNlbGYsIGl0KToKICAgICAgICBmb3IgdmFsdWUgaW4gaXQ6CiAgICAgICAgICAgIHNlbGYuYWRkKHZhbHVlKQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9faWFuZF9fKHNlbGYsIGl0KToKICAgICAgICBmb3IgdmFsdWUgaW4gKHNlbGYgLSBpdCk6CiAgICAgICAgICAgIHNlbGYuZGlzY2FyZCh2YWx1ZSkKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX2l4b3JfXyhzZWxmLCBpdCk6CiAgICAgICAgaWYgaXQgaXMgc2VsZjoKICAgICAgICAgICAgc2VsZi5jbGVhcigpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoaXQsIFNldCk6CiAgICAgICAgICAgICAgICBpdCA9IHNlbGYuX2Zyb21faXRlcmFibGUoaXQpCiAgICAgICAgICAgIGZvciB2YWx1ZSBpbiBpdDoKICAgICAgICAgICAgICAgIGlmIHZhbHVlIGluIHNlbGY6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5kaXNjYXJkKHZhbHVlKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzZWxmLmFkZCh2YWx1ZSkKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX2lzdWJfXyhzZWxmLCBpdCk6CiAgICAgICAgaWYgaXQgaXMgc2VsZjoKICAgICAgICAgICAgc2VsZi5jbGVhcigpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZm9yIHZhbHVlIGluIGl0OgogICAgICAgICAgICAgICAgc2VsZi5kaXNjYXJkKHZhbHVlKQogICAgICAgIHJldHVybiBzZWxmCgpNdXRhYmxlU2V0LnJlZ2lzdGVyKHNldCkKCgojIyMgTUFQUElOR1MgIyMjCgoKY2xhc3MgTWFwcGluZyhTaXplZCwgSXRlcmFibGUsIENvbnRhaW5lcik6CgogICAgX19zbG90c19fID0gKCkKCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBrZXkpOgogICAgICAgIHJhaXNlIEtleUVycm9yCgogICAgZGVmIGdldChzZWxmLCBrZXksIGRlZmF1bHQ9Tm9uZSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gc2VsZltrZXldCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICByZXR1cm4gZGVmYXVsdAoKICAgIGRlZiBfX2NvbnRhaW5zX18oc2VsZiwga2V5KToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGZba2V5XQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYga2V5cyhzZWxmKToKICAgICAgICByZXR1cm4gS2V5c1ZpZXcoc2VsZikKCiAgICBkZWYgaXRlbXMoc2VsZik6CiAgICAgICAgcmV0dXJuIEl0ZW1zVmlldyhzZWxmKQoKICAgIGRlZiB2YWx1ZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIFZhbHVlc1ZpZXcoc2VsZikKCiAgICBkZWYgX19lcV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgTWFwcGluZyk6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAogICAgICAgIHJldHVybiBkaWN0KHNlbGYuaXRlbXMoKSkgPT0gZGljdChvdGhlci5pdGVtcygpKQoKICAgIGRlZiBfX25lX18oc2VsZiwgb3RoZXIpOgogICAgICAgIHJldHVybiBub3QgKHNlbGYgPT0gb3RoZXIpCgpNYXBwaW5nLnJlZ2lzdGVyKG1hcHBpbmdwcm94eSkKCgpjbGFzcyBNYXBwaW5nVmlldyhTaXplZCk6CgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG1hcHBpbmcpOgogICAgICAgIHNlbGYuX21hcHBpbmcgPSBtYXBwaW5nCgogICAgZGVmIF9fbGVuX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGxlbihzZWxmLl9tYXBwaW5nKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gJ3swLl9fY2xhc3NfXy5fX25hbWVfX30oezAuX21hcHBpbmchcn0pJy5mb3JtYXQoc2VsZikKCgpjbGFzcyBLZXlzVmlldyhNYXBwaW5nVmlldywgU2V0KToKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBfZnJvbV9pdGVyYWJsZShzZWxmLCBpdCk6CiAgICAgICAgcmV0dXJuIHNldChpdCkKCiAgICBkZWYgX19jb250YWluc19fKHNlbGYsIGtleSk6CiAgICAgICAgcmV0dXJuIGtleSBpbiBzZWxmLl9tYXBwaW5nCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIGZvciBrZXkgaW4gc2VsZi5fbWFwcGluZzoKICAgICAgICAgICAgeWllbGQga2V5CgpLZXlzVmlldy5yZWdpc3RlcihkaWN0X2tleXMpCgoKY2xhc3MgSXRlbXNWaWV3KE1hcHBpbmdWaWV3LCBTZXQpOgoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIF9mcm9tX2l0ZXJhYmxlKHNlbGYsIGl0KToKICAgICAgICByZXR1cm4gc2V0KGl0KQoKICAgIGRlZiBfX2NvbnRhaW5zX18oc2VsZiwgaXRlbSk6CiAgICAgICAga2V5LCB2YWx1ZSA9IGl0ZW0KICAgICAgICB0cnk6CiAgICAgICAgICAgIHYgPSBzZWxmLl9tYXBwaW5nW2tleV0KICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiB2ID09IHZhbHVlCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIGZvciBrZXkgaW4gc2VsZi5fbWFwcGluZzoKICAgICAgICAgICAgeWllbGQgKGtleSwgc2VsZi5fbWFwcGluZ1trZXldKQoKSXRlbXNWaWV3LnJlZ2lzdGVyKGRpY3RfaXRlbXMpCgoKY2xhc3MgVmFsdWVzVmlldyhNYXBwaW5nVmlldyk6CgogICAgZGVmIF9fY29udGFpbnNfXyhzZWxmLCB2YWx1ZSk6CiAgICAgICAgZm9yIGtleSBpbiBzZWxmLl9tYXBwaW5nOgogICAgICAgICAgICBpZiB2YWx1ZSA9PSBzZWxmLl9tYXBwaW5nW2tleV06CiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICBmb3Iga2V5IGluIHNlbGYuX21hcHBpbmc6CiAgICAgICAgICAgIHlpZWxkIHNlbGYuX21hcHBpbmdba2V5XQoKVmFsdWVzVmlldy5yZWdpc3RlcihkaWN0X3ZhbHVlcykKCgpjbGFzcyBNdXRhYmxlTWFwcGluZyhNYXBwaW5nKToKCiAgICBfX3Nsb3RzX18gPSAoKQoKICAgIEBhYnN0cmFjdG1ldGhvZAogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIGtleSwgdmFsdWUpOgogICAgICAgIHJhaXNlIEtleUVycm9yCgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgX19kZWxpdGVtX18oc2VsZiwga2V5KToKICAgICAgICByYWlzZSBLZXlFcnJvcgoKICAgIF9fbWFya2VyID0gb2JqZWN0KCkKCiAgICBkZWYgcG9wKHNlbGYsIGtleSwgZGVmYXVsdD1fX21hcmtlcik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB2YWx1ZSA9IHNlbGZba2V5XQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgaWYgZGVmYXVsdCBpcyBzZWxmLl9fbWFya2VyOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHQKICAgICAgICBlbHNlOgogICAgICAgICAgICBkZWwgc2VsZltrZXldCiAgICAgICAgICAgIHJldHVybiB2YWx1ZQoKICAgIGRlZiBwb3BpdGVtKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAga2V5ID0gbmV4dChpdGVyKHNlbGYpKQogICAgICAgIGV4Y2VwdCBTdG9wSXRlcmF0aW9uOgogICAgICAgICAgICByYWlzZSBLZXlFcnJvcgogICAgICAgIHZhbHVlID0gc2VsZltrZXldCiAgICAgICAgZGVsIHNlbGZba2V5XQogICAgICAgIHJldHVybiBrZXksIHZhbHVlCgogICAgZGVmIGNsZWFyKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgICAgIHNlbGYucG9waXRlbSgpCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICBwYXNzCgogICAgZGVmIHVwZGF0ZSgqYXJncywgKiprd2RzKToKICAgICAgICBpZiBsZW4oYXJncykgPiAyOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoInVwZGF0ZSgpIHRha2VzIGF0IG1vc3QgMiBwb3NpdGlvbmFsICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJhcmd1bWVudHMgKHt9IGdpdmVuKSIuZm9ybWF0KGxlbihhcmdzKSkpCiAgICAgICAgZWxpZiBub3QgYXJnczoKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJ1cGRhdGUoKSB0YWtlcyBhdCBsZWFzdCAxIGFyZ3VtZW50ICgwIGdpdmVuKSIpCiAgICAgICAgc2VsZiA9IGFyZ3NbMF0KICAgICAgICBvdGhlciA9IGFyZ3NbMV0gaWYgbGVuKGFyZ3MpID49IDIgZWxzZSAoKQoKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBNYXBwaW5nKToKICAgICAgICAgICAgZm9yIGtleSBpbiBvdGhlcjoKICAgICAgICAgICAgICAgIHNlbGZba2V5XSA9IG90aGVyW2tleV0KICAgICAgICBlbGlmIGhhc2F0dHIob3RoZXIsICJrZXlzIik6CiAgICAgICAgICAgIGZvciBrZXkgaW4gb3RoZXIua2V5cygpOgogICAgICAgICAgICAgICAgc2VsZltrZXldID0gb3RoZXJba2V5XQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGZvciBrZXksIHZhbHVlIGluIG90aGVyOgogICAgICAgICAgICAgICAgc2VsZltrZXldID0gdmFsdWUKICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBrd2RzLml0ZW1zKCk6CiAgICAgICAgICAgIHNlbGZba2V5XSA9IHZhbHVlCgogICAgZGVmIHNldGRlZmF1bHQoc2VsZiwga2V5LCBkZWZhdWx0PU5vbmUpOgogICAgICAgIHRyeToKICAgICAgICAgICAgcmV0dXJuIHNlbGZba2V5XQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgc2VsZltrZXldID0gZGVmYXVsdAogICAgICAgIHJldHVybiBkZWZhdWx0CgpNdXRhYmxlTWFwcGluZy5yZWdpc3RlcihkaWN0KQoKCiMjIyBTRVFVRU5DRVMgIyMjCgoKY2xhc3MgU2VxdWVuY2UoU2l6ZWQsIEl0ZXJhYmxlLCBDb250YWluZXIpOgoKICAgICIiIkFsbCB0aGUgb3BlcmF0aW9ucyBvbiBhIHJlYWQtb25seSBzZXF1ZW5jZS4KCiAgICBDb25jcmV0ZSBzdWJjbGFzc2VzIG11c3Qgb3ZlcnJpZGUgX19uZXdfXyBvciBfX2luaXRfXywKICAgIF9fZ2V0aXRlbV9fLCBhbmQgX19sZW5fXy4KICAgICIiIgoKICAgIF9fc2xvdHNfXyA9ICgpCgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgX19nZXRpdGVtX18oc2VsZiwgaW5kZXgpOgogICAgICAgIHJhaXNlIEluZGV4RXJyb3IKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgaSA9IDAKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgICAgICB2ID0gc2VsZltpXQogICAgICAgICAgICAgICAgeWllbGQgdgogICAgICAgICAgICAgICAgaSArPSAxCiAgICAgICAgZXhjZXB0IEluZGV4RXJyb3I6CiAgICAgICAgICAgIHJldHVybgoKICAgIGRlZiBfX2NvbnRhaW5zX18oc2VsZiwgdmFsdWUpOgogICAgICAgIGZvciB2IGluIHNlbGY6CiAgICAgICAgICAgIGlmIHYgPT0gdmFsdWU6CiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBfX3JldmVyc2VkX18oc2VsZik6CiAgICAgICAgZm9yIGkgaW4gcmV2ZXJzZWQocmFuZ2UobGVuKHNlbGYpKSk6CiAgICAgICAgICAgIHlpZWxkIHNlbGZbaV0KCiAgICBkZWYgaW5kZXgoc2VsZiwgdmFsdWUpOgogICAgICAgIGZvciBpLCB2IGluIGVudW1lcmF0ZShzZWxmKToKICAgICAgICAgICAgaWYgdiA9PSB2YWx1ZToKICAgICAgICAgICAgICAgIHJldHVybiBpCiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcgoKICAgIGRlZiBjb3VudChzZWxmLCB2YWx1ZSk6CiAgICAgICAgcmV0dXJuIHN1bSgxIGZvciB2IGluIHNlbGYgaWYgdiA9PSB2YWx1ZSkKClNlcXVlbmNlLnJlZ2lzdGVyKHR1cGxlKQpTZXF1ZW5jZS5yZWdpc3RlcihzdHIpClNlcXVlbmNlLnJlZ2lzdGVyKHJhbmdlKQoKCmNsYXNzIEJ5dGVTdHJpbmcoU2VxdWVuY2UpOgoKICAgICIiIlRoaXMgdW5pZmllcyBieXRlcyBhbmQgYnl0ZWFycmF5LgoKICAgIFhYWCBTaG91bGQgYWRkIGFsbCB0aGVpciBtZXRob2RzLgogICAgIiIiCgogICAgX19zbG90c19fID0gKCkKCkJ5dGVTdHJpbmcucmVnaXN0ZXIoYnl0ZXMpCkJ5dGVTdHJpbmcucmVnaXN0ZXIoYnl0ZWFycmF5KQoKCmNsYXNzIE11dGFibGVTZXF1ZW5jZShTZXF1ZW5jZSk6CgogICAgX19zbG90c19fID0gKCkKCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBfX3NldGl0ZW1fXyhzZWxmLCBpbmRleCwgdmFsdWUpOgogICAgICAgIHJhaXNlIEluZGV4RXJyb3IKCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBfX2RlbGl0ZW1fXyhzZWxmLCBpbmRleCk6CiAgICAgICAgcmFpc2UgSW5kZXhFcnJvcgoKICAgIEBhYnN0cmFjdG1ldGhvZAogICAgZGVmIGluc2VydChzZWxmLCBpbmRleCwgdmFsdWUpOgogICAgICAgIHJhaXNlIEluZGV4RXJyb3IKCiAgICBkZWYgYXBwZW5kKHNlbGYsIHZhbHVlKToKICAgICAgICBzZWxmLmluc2VydChsZW4oc2VsZiksIHZhbHVlKQoKICAgIGRlZiBjbGVhcihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgICAgICBzZWxmLnBvcCgpCiAgICAgICAgZXhjZXB0IEluZGV4RXJyb3I6CiAgICAgICAgICAgIHBhc3MKCiAgICBkZWYgcmV2ZXJzZShzZWxmKToKICAgICAgICBuID0gbGVuKHNlbGYpCiAgICAgICAgZm9yIGkgaW4gcmFuZ2Uobi8vMik6CiAgICAgICAgICAgIHNlbGZbaV0sIHNlbGZbbi1pLTFdID0gc2VsZltuLWktMV0sIHNlbGZbaV0KCiAgICBkZWYgZXh0ZW5kKHNlbGYsIHZhbHVlcyk6CiAgICAgICAgZm9yIHYgaW4gdmFsdWVzOgogICAgICAgICAgICBzZWxmLmFwcGVuZCh2KQoKICAgIGRlZiBwb3Aoc2VsZiwgaW5kZXg9LTEpOgogICAgICAgIHYgPSBzZWxmW2luZGV4XQogICAgICAgIGRlbCBzZWxmW2luZGV4XQogICAgICAgIHJldHVybiB2CgogICAgZGVmIHJlbW92ZShzZWxmLCB2YWx1ZSk6CiAgICAgICAgZGVsIHNlbGZbc2VsZi5pbmRleCh2YWx1ZSldCgogICAgZGVmIF9faWFkZF9fKHNlbGYsIHZhbHVlcyk6CiAgICAgICAgc2VsZi5leHRlbmQodmFsdWVzKQogICAgICAgIHJldHVybiBzZWxmCgpNdXRhYmxlU2VxdWVuY2UucmVnaXN0ZXIobGlzdCkKTXV0YWJsZVNlcXVlbmNlLnJlZ2lzdGVyKGJ5dGVhcnJheSkgICMgTXVsdGlwbHkgaW5oZXJpdGluZywgc2VlIEJ5dGVTdHJpbmcK',
'/Lib/collections/__init__.py':'I19fYWxsX18gPSBbJ2RlcXVlJywgJ2RlZmF1bHRkaWN0JywgJ0NvdW50ZXInXQoKI2Zyb20gX2NvbGxlY3Rpb25zIGltcG9ydCBkZXF1ZSwgZGVmYXVsdGRpY3QKCiNmcm9tIGl0ZXJ0b29scyBpbXBvcnQgcmVwZWF0IGFzIF9yZXBlYXQsIGNoYWluIGFzIF9jaGFpbiwgc3Rhcm1hcCBhcyBfc3Rhcm1hcAoKX19hbGxfXyA9IFsnZGVxdWUnLCAnZGVmYXVsdGRpY3QnLCAnbmFtZWR0dXBsZScsICdVc2VyRGljdCcsICdVc2VyTGlzdCcsCiAgICAgICAgICAgICdVc2VyU3RyaW5nJywgJ0NvdW50ZXInLCAnT3JkZXJlZERpY3QnXQojIEZvciBib290c3RyYXBwaW5nIHJlYXNvbnMsIHRoZSBjb2xsZWN0aW9uIEFCQ3MgYXJlIGRlZmluZWQgaW4gX2FiY29sbC5weS4KIyBUaGV5IHNob3VsZCBob3dldmVyIGJlIGNvbnNpZGVyZWQgYW4gaW50ZWdyYWwgcGFydCBvZiBjb2xsZWN0aW9ucy5weS4KCiMgZml4bWUgYnJ5dGhvbi4uIHRoZXJlIGlzIGFuIGlzc3VlIHdpdGggX2FiY29sbAojZnJvbSBfYWJjb2xsIGltcG9ydCAqCiNmcm9tIF9hYmNvbGwgaW1wb3J0IFNldApmcm9tIF9hYmNvbGwgaW1wb3J0IE11dGFibGVNYXBwaW5nCiNpbXBvcnQgX2FiY29sbAojX19hbGxfXyArPSBfYWJjb2xsLl9fYWxsX18KCmZyb20gX2NvbGxlY3Rpb25zIGltcG9ydCBkZXF1ZSwgZGVmYXVsdGRpY3QKI2ZpeG1lLCBicnl0aG9uLiAgVGhpcyBjYXVzZXMgYSBSZWZlcmVuY2VFcnJvcjogaXRlbWdldHRlciBpcyBub3QgZGVmaW5lZAojZnJvbSBvcGVyYXRvciBpbXBvcnQgaXRlbWdldHRlciBhcyBfaXRlbWdldHRlcgpmcm9tIGtleXdvcmQgaW1wb3J0IGlza2V5d29yZCBhcyBfaXNrZXl3b3JkCmltcG9ydCBzeXMgYXMgX3N5cwppbXBvcnQgaGVhcHEgYXMgX2hlYXBxCiNmaXhtZSBicnl0aG9uCiNmcm9tIHdlYWtyZWYgaW1wb3J0IHByb3h5IGFzIF9wcm94eQpmcm9tIGl0ZXJ0b29scyBpbXBvcnQgcmVwZWF0IGFzIF9yZXBlYXQsIGNoYWluIGFzIF9jaGFpbiwgc3Rhcm1hcCBhcyBfc3Rhcm1hcAojZml4bWUgYnJ5dGhvbiAKI2Zyb20gcmVwcmxpYiBpbXBvcnQgcmVjdXJzaXZlX3JlcHIgYXMgX3JlY3Vyc2l2ZV9yZXByCgpjbGFzcyBTZXQoc2V0KToKICAgIHBhc3MKCmNsYXNzIFNlcXVlbmNlKGxpc3QpOgogICAgcGFzcwoKZGVmIF9wcm94eShvYmopOgogICAgcmV0dXJuIG9iagoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjIE9yZGVyZWREaWN0CiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpjbGFzcyBfTGluayhvYmplY3QpOgogICAgX19zbG90c19fID0gJ3ByZXYnLCAnbmV4dCcsICdrZXknLCAnX193ZWFrcmVmX18nCgpjbGFzcyBPcmRlcmVkRGljdChkaWN0KToKICAgICdEaWN0aW9uYXJ5IHRoYXQgcmVtZW1iZXJzIGluc2VydGlvbiBvcmRlcicKICAgICMgQW4gaW5oZXJpdGVkIGRpY3QgbWFwcyBrZXlzIHRvIHZhbHVlcy4KICAgICMgVGhlIGluaGVyaXRlZCBkaWN0IHByb3ZpZGVzIF9fZ2V0aXRlbV9fLCBfX2xlbl9fLCBfX2NvbnRhaW5zX18sIGFuZCBnZXQuCiAgICAjIFRoZSByZW1haW5pbmcgbWV0aG9kcyBhcmUgb3JkZXItYXdhcmUuCiAgICAjIEJpZy1PIHJ1bm5pbmcgdGltZXMgZm9yIGFsbCBtZXRob2RzIGFyZSB0aGUgc2FtZSBhcyByZWd1bGFyIGRpY3Rpb25hcmllcy4KCiAgICAjIFRoZSBpbnRlcm5hbCBzZWxmLl9fbWFwIGRpY3QgbWFwcyBrZXlzIHRvIGxpbmtzIGluIGEgZG91Ymx5IGxpbmtlZCBsaXN0LgogICAgIyBUaGUgY2lyY3VsYXIgZG91Ymx5IGxpbmtlZCBsaXN0IHN0YXJ0cyBhbmQgZW5kcyB3aXRoIGEgc2VudGluZWwgZWxlbWVudC4KICAgICMgVGhlIHNlbnRpbmVsIGVsZW1lbnQgbmV2ZXIgZ2V0cyBkZWxldGVkICh0aGlzIHNpbXBsaWZpZXMgdGhlIGFsZ29yaXRobSkuCiAgICAjIFRoZSBzZW50aW5lbCBpcyBpbiBzZWxmLl9faGFyZHJvb3Qgd2l0aCBhIHdlYWtyZWYgcHJveHkgaW4gc2VsZi5fX3Jvb3QuCiAgICAjIFRoZSBwcmV2IGxpbmtzIGFyZSB3ZWFrcmVmIHByb3hpZXMgKHRvIHByZXZlbnQgY2lyY3VsYXIgcmVmZXJlbmNlcykuCiAgICAjIEluZGl2aWR1YWwgbGlua3MgYXJlIGtlcHQgYWxpdmUgYnkgdGhlIGhhcmQgcmVmZXJlbmNlIGluIHNlbGYuX19tYXAuCiAgICAjIFRob3NlIGhhcmQgcmVmZXJlbmNlcyBkaXNhcHBlYXIgd2hlbiBhIGtleSBpcyBkZWxldGVkIGZyb20gYW4gT3JkZXJlZERpY3QuCgogICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3ZHMpOgogICAgICAgICcnJ0luaXRpYWxpemUgYW4gb3JkZXJlZCBkaWN0aW9uYXJ5LiAgVGhlIHNpZ25hdHVyZSBpcyB0aGUgc2FtZSBhcwogICAgICAgIHJlZ3VsYXIgZGljdGlvbmFyaWVzLCBidXQga2V5d29yZCBhcmd1bWVudHMgYXJlIG5vdCByZWNvbW1lbmRlZCBiZWNhdXNlCiAgICAgICAgdGhlaXIgaW5zZXJ0aW9uIG9yZGVyIGlzIGFyYml0cmFyeS4KCiAgICAgICAgJycnCiAgICAgICAgaWYgbGVuKGFyZ3MpID4gMToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdleHBlY3RlZCBhdCBtb3N0IDEgYXJndW1lbnRzLCBnb3QgJWQnICUgbGVuKGFyZ3MpKQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5fX3Jvb3QKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHNlbGYuX19oYXJkcm9vdCA9IF9MaW5rKCkKICAgICAgICAgICAgc2VsZi5fX3Jvb3QgPSByb290ID0gX3Byb3h5KHNlbGYuX19oYXJkcm9vdCkKICAgICAgICAgICAgcm9vdC5wcmV2ID0gcm9vdC5uZXh0ID0gcm9vdAogICAgICAgICAgICBzZWxmLl9fbWFwID0ge30KICAgICAgICBzZWxmLl9fdXBkYXRlKCphcmdzLCAqKmt3ZHMpCgogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIGtleSwgdmFsdWUsCiAgICAgICAgICAgICAgICAgICAgZGljdF9zZXRpdGVtPWRpY3QuX19zZXRpdGVtX18sIHByb3h5PV9wcm94eSwgTGluaz1fTGluayk6CiAgICAgICAgJ29kLl9fc2V0aXRlbV9fKGksIHkpIDw9PT4gb2RbaV09eScKICAgICAgICAjIFNldHRpbmcgYSBuZXcgaXRlbSBjcmVhdGVzIGEgbmV3IGxpbmsgYXQgdGhlIGVuZCBvZiB0aGUgbGlua2VkIGxpc3QsCiAgICAgICAgIyBhbmQgdGhlIGluaGVyaXRlZCBkaWN0aW9uYXJ5IGlzIHVwZGF0ZWQgd2l0aCB0aGUgbmV3IGtleS92YWx1ZSBwYWlyLgogICAgICAgIGlmIGtleSBub3QgaW4gc2VsZjoKICAgICAgICAgICAgc2VsZi5fX21hcFtrZXldID0gbGluayA9IExpbmsoKQogICAgICAgICAgICByb290ID0gc2VsZi5fX3Jvb3QKICAgICAgICAgICAgbGFzdCA9IHJvb3QucHJldgogICAgICAgICAgICBsaW5rLnByZXYsIGxpbmsubmV4dCwgbGluay5rZXkgPSBsYXN0LCByb290LCBrZXkKICAgICAgICAgICAgbGFzdC5uZXh0ID0gbGluawogICAgICAgICAgICByb290LnByZXYgPSBwcm94eShsaW5rKQogICAgICAgIGRpY3Rfc2V0aXRlbShzZWxmLCBrZXksIHZhbHVlKQoKICAgIGRlZiBfX2RlbGl0ZW1fXyhzZWxmLCBrZXksIGRpY3RfZGVsaXRlbT1kaWN0Ll9fZGVsaXRlbV9fKToKICAgICAgICAnb2QuX19kZWxpdGVtX18oeSkgPD09PiBkZWwgb2RbeV0nCiAgICAgICAgIyBEZWxldGluZyBhbiBleGlzdGluZyBpdGVtIHVzZXMgc2VsZi5fX21hcCB0byBmaW5kIHRoZSBsaW5rIHdoaWNoIGdldHMKICAgICAgICAjIHJlbW92ZWQgYnkgdXBkYXRpbmcgdGhlIGxpbmtzIGluIHRoZSBwcmVkZWNlc3NvciBhbmQgc3VjY2Vzc29yIG5vZGVzLgogICAgICAgIGRpY3RfZGVsaXRlbShzZWxmLCBrZXkpCiAgICAgICAgbGluayA9IHNlbGYuX19tYXAucG9wKGtleSkKICAgICAgICBsaW5rX3ByZXYgPSBsaW5rLnByZXYKICAgICAgICBsaW5rX25leHQgPSBsaW5rLm5leHQKICAgICAgICBsaW5rX3ByZXYubmV4dCA9IGxpbmtfbmV4dAogICAgICAgIGxpbmtfbmV4dC5wcmV2ID0gbGlua19wcmV2CgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgICdvZC5fX2l0ZXJfXygpIDw9PT4gaXRlcihvZCknCiAgICAgICAgIyBUcmF2ZXJzZSB0aGUgbGlua2VkIGxpc3QgaW4gb3JkZXIuCiAgICAgICAgcm9vdCA9IHNlbGYuX19yb290CiAgICAgICAgY3VyciA9IHJvb3QubmV4dAogICAgICAgIHdoaWxlIGN1cnIgaXMgbm90IHJvb3Q6CiAgICAgICAgICAgIHlpZWxkIGN1cnIua2V5CiAgICAgICAgICAgIGN1cnIgPSBjdXJyLm5leHQKCiAgICBkZWYgX19yZXZlcnNlZF9fKHNlbGYpOgogICAgICAgICdvZC5fX3JldmVyc2VkX18oKSA8PT0+IHJldmVyc2VkKG9kKScKICAgICAgICAjIFRyYXZlcnNlIHRoZSBsaW5rZWQgbGlzdCBpbiByZXZlcnNlIG9yZGVyLgogICAgICAgIHJvb3QgPSBzZWxmLl9fcm9vdAogICAgICAgIGN1cnIgPSByb290LnByZXYKICAgICAgICB3aGlsZSBjdXJyIGlzIG5vdCByb290OgogICAgICAgICAgICB5aWVsZCBjdXJyLmtleQogICAgICAgICAgICBjdXJyID0gY3Vyci5wcmV2CgogICAgZGVmIGNsZWFyKHNlbGYpOgogICAgICAgICdvZC5jbGVhcigpIC0+IE5vbmUuICBSZW1vdmUgYWxsIGl0ZW1zIGZyb20gb2QuJwogICAgICAgIHJvb3QgPSBzZWxmLl9fcm9vdAogICAgICAgIHJvb3QucHJldiA9IHJvb3QubmV4dCA9IHJvb3QKICAgICAgICBzZWxmLl9fbWFwLmNsZWFyKCkKICAgICAgICBkaWN0LmNsZWFyKHNlbGYpCgogICAgZGVmIHBvcGl0ZW0oc2VsZiwgbGFzdD1UcnVlKToKICAgICAgICAnJydvZC5wb3BpdGVtKCkgLT4gKGssIHYpLCByZXR1cm4gYW5kIHJlbW92ZSBhIChrZXksIHZhbHVlKSBwYWlyLgogICAgICAgIFBhaXJzIGFyZSByZXR1cm5lZCBpbiBMSUZPIG9yZGVyIGlmIGxhc3QgaXMgdHJ1ZSBvciBGSUZPIG9yZGVyIGlmIGZhbHNlLgoKICAgICAgICAnJycKICAgICAgICBpZiBub3Qgc2VsZjoKICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3IoJ2RpY3Rpb25hcnkgaXMgZW1wdHknKQogICAgICAgIHJvb3QgPSBzZWxmLl9fcm9vdAogICAgICAgIGlmIGxhc3Q6CiAgICAgICAgICAgIGxpbmsgPSByb290LnByZXYKICAgICAgICAgICAgbGlua19wcmV2ID0gbGluay5wcmV2CiAgICAgICAgICAgIGxpbmtfcHJldi5uZXh0ID0gcm9vdAogICAgICAgICAgICByb290LnByZXYgPSBsaW5rX3ByZXYKICAgICAgICBlbHNlOgogICAgICAgICAgICBsaW5rID0gcm9vdC5uZXh0CiAgICAgICAgICAgIGxpbmtfbmV4dCA9IGxpbmsubmV4dAogICAgICAgICAgICByb290Lm5leHQgPSBsaW5rX25leHQKICAgICAgICAgICAgbGlua19uZXh0LnByZXYgPSByb290CiAgICAgICAga2V5ID0gbGluay5rZXkKICAgICAgICBkZWwgc2VsZi5fX21hcFtrZXldCiAgICAgICAgdmFsdWUgPSBkaWN0LnBvcChzZWxmLCBrZXkpCiAgICAgICAgcmV0dXJuIGtleSwgdmFsdWUKCiAgICBkZWYgbW92ZV90b19lbmQoc2VsZiwga2V5LCBsYXN0PVRydWUpOgogICAgICAgICcnJ01vdmUgYW4gZXhpc3RpbmcgZWxlbWVudCB0byB0aGUgZW5kIChvciBiZWdpbm5pbmcgaWYgbGFzdD09RmFsc2UpLgoKICAgICAgICBSYWlzZXMgS2V5RXJyb3IgaWYgdGhlIGVsZW1lbnQgZG9lcyBub3QgZXhpc3QuCiAgICAgICAgV2hlbiBsYXN0PVRydWUsIGFjdHMgbGlrZSBhIGZhc3QgdmVyc2lvbiBvZiBzZWxmW2tleV09c2VsZi5wb3Aoa2V5KS4KCiAgICAgICAgJycnCiAgICAgICAgbGluayA9IHNlbGYuX19tYXBba2V5XQogICAgICAgIGxpbmtfcHJldiA9IGxpbmsucHJldgogICAgICAgIGxpbmtfbmV4dCA9IGxpbmsubmV4dAogICAgICAgIGxpbmtfcHJldi5uZXh0ID0gbGlua19uZXh0CiAgICAgICAgbGlua19uZXh0LnByZXYgPSBsaW5rX3ByZXYKICAgICAgICByb290ID0gc2VsZi5fX3Jvb3QKICAgICAgICBpZiBsYXN0OgogICAgICAgICAgICBsYXN0ID0gcm9vdC5wcmV2CiAgICAgICAgICAgIGxpbmsucHJldiA9IGxhc3QKICAgICAgICAgICAgbGluay5uZXh0ID0gcm9vdAogICAgICAgICAgICBsYXN0Lm5leHQgPSByb290LnByZXYgPSBsaW5rCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZmlyc3QgPSByb290Lm5leHQKICAgICAgICAgICAgbGluay5wcmV2ID0gcm9vdAogICAgICAgICAgICBsaW5rLm5leHQgPSBmaXJzdAogICAgICAgICAgICByb290Lm5leHQgPSBmaXJzdC5wcmV2ID0gbGluawoKICAgIGRlZiBfX3NpemVvZl9fKHNlbGYpOgogICAgICAgIHNpemVvZiA9IF9zeXMuZ2V0c2l6ZW9mCiAgICAgICAgbiA9IGxlbihzZWxmKSArIDEgICAgICAgICAgICAgICAgICAgICAgICMgbnVtYmVyIG9mIGxpbmtzIGluY2x1ZGluZyByb290CiAgICAgICAgc2l6ZSA9IHNpemVvZihzZWxmLl9fZGljdF9fKSAgICAgICAgICAgICMgaW5zdGFuY2UgZGljdGlvbmFyeQogICAgICAgIHNpemUgKz0gc2l6ZW9mKHNlbGYuX19tYXApICogMiAgICAgICAgICAjIGludGVybmFsIGRpY3QgYW5kIGluaGVyaXRlZCBkaWN0CiAgICAgICAgc2l6ZSArPSBzaXplb2Yoc2VsZi5fX2hhcmRyb290KSAqIG4gICAgICMgbGluayBvYmplY3RzCiAgICAgICAgc2l6ZSArPSBzaXplb2Yoc2VsZi5fX3Jvb3QpICogbiAgICAgICAgICMgcHJveHkgb2JqZWN0cwogICAgICAgIHJldHVybiBzaXplCgogICAgI2ZpeG1lIGJyeXRob24uLiAgSXNzdWUgd2l0aCBfYWJjb2xsLCB3aGljaCBjb250YWlucyBNdXRhYmxlTWFwcGluZwogICAgdXBkYXRlID0gX191cGRhdGUgPSBNdXRhYmxlTWFwcGluZy51cGRhdGUKICAgIGtleXMgPSBNdXRhYmxlTWFwcGluZy5rZXlzCiAgICB2YWx1ZXMgPSBNdXRhYmxlTWFwcGluZy52YWx1ZXMKICAgIGl0ZW1zID0gTXV0YWJsZU1hcHBpbmcuaXRlbXMKICAgIF9fbmVfXyA9IE11dGFibGVNYXBwaW5nLl9fbmVfXwoKICAgIF9fbWFya2VyID0gb2JqZWN0KCkKCiAgICBkZWYgcG9wKHNlbGYsIGtleSwgZGVmYXVsdD1fX21hcmtlcik6CiAgICAgICAgJycnb2QucG9wKGtbLGRdKSAtPiB2LCByZW1vdmUgc3BlY2lmaWVkIGtleSBhbmQgcmV0dXJuIHRoZSBjb3JyZXNwb25kaW5nCiAgICAgICAgdmFsdWUuICBJZiBrZXkgaXMgbm90IGZvdW5kLCBkIGlzIHJldHVybmVkIGlmIGdpdmVuLCBvdGhlcndpc2UgS2V5RXJyb3IKICAgICAgICBpcyByYWlzZWQuCgogICAgICAgICcnJwogICAgICAgIGlmIGtleSBpbiBzZWxmOgogICAgICAgICAgICByZXN1bHQgPSBzZWxmW2tleV0KICAgICAgICAgICAgZGVsIHNlbGZba2V5XQogICAgICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgaWYgZGVmYXVsdCBpcyBzZWxmLl9fbWFya2VyOgogICAgICAgICAgICByYWlzZSBLZXlFcnJvcihrZXkpCiAgICAgICAgcmV0dXJuIGRlZmF1bHQKCiAgICBkZWYgc2V0ZGVmYXVsdChzZWxmLCBrZXksIGRlZmF1bHQ9Tm9uZSk6CiAgICAgICAgJ29kLnNldGRlZmF1bHQoa1ssZF0pIC0+IG9kLmdldChrLGQpLCBhbHNvIHNldCBvZFtrXT1kIGlmIGsgbm90IGluIG9kJwogICAgICAgIGlmIGtleSBpbiBzZWxmOgogICAgICAgICAgICByZXR1cm4gc2VsZltrZXldCiAgICAgICAgc2VsZltrZXldID0gZGVmYXVsdAogICAgICAgIHJldHVybiBkZWZhdWx0CgogICAgI2ZpeG1lLCBicnl0aG9uIGlzc3VlCiAgICAjQF9yZWN1cnNpdmVfcmVwcigpCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgJ29kLl9fcmVwcl9fKCkgPD09PiByZXByKG9kKScKICAgICAgICBpZiBub3Qgc2VsZjoKICAgICAgICAgICAgcmV0dXJuICclcygpJyAlIChzZWxmLl9fY2xhc3NfXy5fX25hbWVfXywpCiAgICAgICAgcmV0dXJuICclcyglciknICUgKHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLCBsaXN0KHNlbGYuaXRlbXMoKSkpCgogICAgZGVmIF9fcmVkdWNlX18oc2VsZik6CiAgICAgICAgJ1JldHVybiBzdGF0ZSBpbmZvcm1hdGlvbiBmb3IgcGlja2xpbmcnCiAgICAgICAgaXRlbXMgPSBbW2ssIHNlbGZba11dIGZvciBrIGluIHNlbGZdCiAgICAgICAgaW5zdF9kaWN0ID0gdmFycyhzZWxmKS5jb3B5KCkKICAgICAgICBmb3IgayBpbiB2YXJzKE9yZGVyZWREaWN0KCkpOgogICAgICAgICAgICBpbnN0X2RpY3QucG9wKGssIE5vbmUpCiAgICAgICAgaWYgaW5zdF9kaWN0OgogICAgICAgICAgICByZXR1cm4gKHNlbGYuX19jbGFzc19fLCAoaXRlbXMsKSwgaW5zdF9kaWN0KQogICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXywgKGl0ZW1zLCkKCiAgICBkZWYgY29weShzZWxmKToKICAgICAgICAnb2QuY29weSgpIC0+IGEgc2hhbGxvdyBjb3B5IG9mIG9kJwogICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmKQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIGZyb21rZXlzKGNscywgaXRlcmFibGUsIHZhbHVlPU5vbmUpOgogICAgICAgICcnJ09ELmZyb21rZXlzKFNbLCB2XSkgLT4gTmV3IG9yZGVyZWQgZGljdGlvbmFyeSB3aXRoIGtleXMgZnJvbSBTLgogICAgICAgIElmIG5vdCBzcGVjaWZpZWQsIHRoZSB2YWx1ZSBkZWZhdWx0cyB0byBOb25lLgoKICAgICAgICAnJycKICAgICAgICBzZWxmID0gY2xzKCkKICAgICAgICBmb3Iga2V5IGluIGl0ZXJhYmxlOgogICAgICAgICAgICBzZWxmW2tleV0gPSB2YWx1ZQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fZXFfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgJycnb2QuX19lcV9fKHkpIDw9PT4gb2Q9PXkuICBDb21wYXJpc29uIHRvIGFub3RoZXIgT0QgaXMgb3JkZXItc2Vuc2l0aXZlCiAgICAgICAgd2hpbGUgY29tcGFyaXNvbiB0byBhIHJlZ3VsYXIgbWFwcGluZyBpcyBvcmRlci1pbnNlbnNpdGl2ZS4KCiAgICAgICAgJycnCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgT3JkZXJlZERpY3QpOgogICAgICAgICAgICByZXR1cm4gbGVuKHNlbGYpPT1sZW4ob3RoZXIpIGFuZCBcCiAgICAgICAgICAgICAgICAgICBhbGwocD09cSBmb3IgcCwgcSBpbiB6aXAoc2VsZi5pdGVtcygpLCBvdGhlci5pdGVtcygpKSkKICAgICAgICByZXR1cm4gZGljdC5fX2VxX18oc2VsZiwgb3RoZXIpCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIyAgQ291bnRlcgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCgpkZWYgX2NvdW50X2VsZW1lbnRzKG1hcHBpbmcsIGl0ZXJhYmxlKToKICAgICdUYWxseSBlbGVtZW50cyBmcm9tIHRoZSBpdGVyYWJsZS4nCiAgICBtYXBwaW5nX2dldCA9IG1hcHBpbmcuZ2V0CiAgICBmb3IgZWxlbSBpbiBpdGVyYWJsZToKICAgICAgICBtYXBwaW5nW2VsZW1dID0gbWFwcGluZ19nZXQoZWxlbSwgMCkgKyAxCgojdHJ5OiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgTG9hZCBDIGhlbHBlciBmdW5jdGlvbiBpZiBhdmFpbGFibGUKIyAgICBmcm9tIF9jb2xsZWN0aW9ucyBpbXBvcnQgX2NvdW50X2VsZW1lbnRzCiNleGNlcHQgSW1wb3J0RXJyb3I6CiMgICAgcGFzcwoKY2xhc3MgQ291bnRlcihkaWN0KToKICAgICcnJ0RpY3Qgc3ViY2xhc3MgZm9yIGNvdW50aW5nIGhhc2hhYmxlIGl0ZW1zLiAgU29tZXRpbWVzIGNhbGxlZCBhIGJhZwogICAgb3IgbXVsdGlzZXQuICBFbGVtZW50cyBhcmUgc3RvcmVkIGFzIGRpY3Rpb25hcnkga2V5cyBhbmQgdGhlaXIgY291bnRzCiAgICBhcmUgc3RvcmVkIGFzIGRpY3Rpb25hcnkgdmFsdWVzLgoKICAgID4+PiBjID0gQ291bnRlcignYWJjZGVhYmNkYWJjYWJhJykgICMgY291bnQgZWxlbWVudHMgZnJvbSBhIHN0cmluZwoKICAgID4+PiBjLm1vc3RfY29tbW9uKDMpICAgICAgICAgICAgICAgICMgdGhyZWUgbW9zdCBjb21tb24gZWxlbWVudHMKICAgIFsoJ2EnLCA1KSwgKCdiJywgNCksICgnYycsIDMpXQogICAgPj4+IHNvcnRlZChjKSAgICAgICAgICAgICAgICAgICAgICAgIyBsaXN0IGFsbCB1bmlxdWUgZWxlbWVudHMKICAgIFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ10KICAgID4+PiAnJy5qb2luKHNvcnRlZChjLmVsZW1lbnRzKCkpKSAgICMgbGlzdCBlbGVtZW50cyB3aXRoIHJlcGV0aXRpb25zCiAgICAnYWFhYWFiYmJiY2NjZGRlJwogICAgPj4+IHN1bShjLnZhbHVlcygpKSAgICAgICAgICAgICAgICAgIyB0b3RhbCBvZiBhbGwgY291bnRzCiAgICAxNQoKICAgID4+PiBjWydhJ10gICAgICAgICAgICAgICAgICAgICAgICAgICMgY291bnQgb2YgbGV0dGVyICdhJwogICAgNQogICAgPj4+IGZvciBlbGVtIGluICdzaGF6YW0nOiAgICAgICAgICAgIyB1cGRhdGUgY291bnRzIGZyb20gYW4gaXRlcmFibGUKICAgIC4uLiAgICAgY1tlbGVtXSArPSAxICAgICAgICAgICAgICAgICMgYnkgYWRkaW5nIDEgdG8gZWFjaCBlbGVtZW50J3MgY291bnQKICAgID4+PiBjWydhJ10gICAgICAgICAgICAgICAgICAgICAgICAgICMgbm93IHRoZXJlIGFyZSBzZXZlbiAnYScKICAgIDcKICAgID4+PiBkZWwgY1snYiddICAgICAgICAgICAgICAgICAgICAgICMgcmVtb3ZlIGFsbCAnYicKICAgID4+PiBjWydiJ10gICAgICAgICAgICAgICAgICAgICAgICAgICMgbm93IHRoZXJlIGFyZSB6ZXJvICdiJwogICAgMAoKICAgID4+PiBkID0gQ291bnRlcignc2ltc2FsYWJpbScpICAgICAgICMgbWFrZSBhbm90aGVyIGNvdW50ZXIKICAgID4+PiBjLnVwZGF0ZShkKSAgICAgICAgICAgICAgICAgICAgICMgYWRkIGluIHRoZSBzZWNvbmQgY291bnRlcgogICAgPj4+IGNbJ2EnXSAgICAgICAgICAgICAgICAgICAgICAgICAgIyBub3cgdGhlcmUgYXJlIG5pbmUgJ2EnCiAgICA5CgogICAgPj4+IGMuY2xlYXIoKSAgICAgICAgICAgICAgICAgICAgICAgIyBlbXB0eSB0aGUgY291bnRlcgogICAgPj4+IGMKICAgIENvdW50ZXIoKQoKICAgIE5vdGU6ICBJZiBhIGNvdW50IGlzIHNldCB0byB6ZXJvIG9yIHJlZHVjZWQgdG8gemVybywgaXQgd2lsbCByZW1haW4KICAgIGluIHRoZSBjb3VudGVyIHVudGlsIHRoZSBlbnRyeSBpcyBkZWxldGVkIG9yIHRoZSBjb3VudGVyIGlzIGNsZWFyZWQ6CgogICAgPj4+IGMgPSBDb3VudGVyKCdhYWFiYmMnKQogICAgPj4+IGNbJ2InXSAtPSAyICAgICAgICAgICAgICAgICAgICAgIyByZWR1Y2UgdGhlIGNvdW50IG9mICdiJyBieSB0d28KICAgID4+PiBjLm1vc3RfY29tbW9uKCkgICAgICAgICAgICAgICAgICMgJ2InIGlzIHN0aWxsIGluLCBidXQgaXRzIGNvdW50IGlzIHplcm8KICAgIFsoJ2EnLCAzKSwgKCdjJywgMSksICgnYicsIDApXQoKICAgICcnJwogICAgIyBSZWZlcmVuY2VzOgogICAgIyAgIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTXVsdGlzZXQKICAgICMgICBodHRwOi8vd3d3LmdudS5vcmcvc29mdHdhcmUvc21hbGx0YWxrL21hbnVhbC1iYXNlL2h0bWxfbm9kZS9CYWcuaHRtbAogICAgIyAgIGh0dHA6Ly93d3cuZGVtbzJzLmNvbS9UdXRvcmlhbC9DcHAvMDM4MF9fc2V0LW11bHRpc2V0L0NhdGFsb2cwMzgwX19zZXQtbXVsdGlzZXQuaHRtCiAgICAjICAgaHR0cDovL2NvZGUuYWN0aXZlc3RhdGUuY29tL3JlY2lwZXMvMjU5MTc0LwogICAgIyAgIEtudXRoLCBUQU9DUCBWb2wuIElJIHNlY3Rpb24gNC42LjMKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaXRlcmFibGU9Tm9uZSwgKiprd2RzKToKICAgICAgICAnJydDcmVhdGUgYSBuZXcsIGVtcHR5IENvdW50ZXIgb2JqZWN0LiAgQW5kIGlmIGdpdmVuLCBjb3VudCBlbGVtZW50cwogICAgICAgIGZyb20gYW4gaW5wdXQgaXRlcmFibGUuICBPciwgaW5pdGlhbGl6ZSB0aGUgY291bnQgZnJvbSBhbm90aGVyIG1hcHBpbmcKICAgICAgICBvZiBlbGVtZW50cyB0byB0aGVpciBjb3VudHMuCgogICAgICAgID4+PiBjID0gQ291bnRlcigpICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBhIG5ldywgZW1wdHkgY291bnRlcgogICAgICAgID4+PiBjID0gQ291bnRlcignZ2FsbGFoYWQnKSAgICAgICAgICAgICAgICAgIyBhIG5ldyBjb3VudGVyIGZyb20gYW4gaXRlcmFibGUKICAgICAgICA+Pj4gYyA9IENvdW50ZXIoeydhJzogNCwgJ2InOiAyfSkgICAgICAgICAgICMgYSBuZXcgY291bnRlciBmcm9tIGEgbWFwcGluZwogICAgICAgID4+PiBjID0gQ291bnRlcihhPTQsIGI9MikgICAgICAgICAgICAgICAgICAgIyBhIG5ldyBjb3VudGVyIGZyb20ga2V5d29yZCBhcmdzCgogICAgICAgICcnJwogICAgICAgICNzdXBlcigpLl9faW5pdF9fKCkgICNCRSBtb2RpZmllZCBzaW5jZSBzdXBlciBub3Qgc3VwcG9ydGVkCiAgICAgICAgZGljdC5fX2luaXRfXyhzZWxmKQogICAgICAgIHNlbGYudXBkYXRlKGl0ZXJhYmxlLCAqKmt3ZHMpCgogICAgZGVmIF9fbWlzc2luZ19fKHNlbGYsIGtleSk6CiAgICAgICAgJ1RoZSBjb3VudCBvZiBlbGVtZW50cyBub3QgaW4gdGhlIENvdW50ZXIgaXMgemVyby4nCiAgICAgICAgIyBOZWVkZWQgc28gdGhhdCBzZWxmW21pc3NpbmdfaXRlbV0gZG9lcyBub3QgcmFpc2UgS2V5RXJyb3IKICAgICAgICByZXR1cm4gMAoKICAgIGRlZiBtb3N0X2NvbW1vbihzZWxmLCBuPU5vbmUpOgogICAgICAgICcnJ0xpc3QgdGhlIG4gbW9zdCBjb21tb24gZWxlbWVudHMgYW5kIHRoZWlyIGNvdW50cyBmcm9tIHRoZSBtb3N0CiAgICAgICAgY29tbW9uIHRvIHRoZSBsZWFzdC4gIElmIG4gaXMgTm9uZSwgdGhlbiBsaXN0IGFsbCBlbGVtZW50IGNvdW50cy4KCiAgICAgICAgPj4+IENvdW50ZXIoJ2FiY2RlYWJjZGFiY2FiYScpLm1vc3RfY29tbW9uKDMpCiAgICAgICAgWygnYScsIDUpLCAoJ2InLCA0KSwgKCdjJywgMyldCgogICAgICAgICcnJwogICAgICAgICMgRW11bGF0ZSBCYWcuc29ydGVkQnlDb3VudCBmcm9tIFNtYWxsdGFsawogICAgICAgIGlmIG4gaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIHNvcnRlZChzZWxmLml0ZW1zKCksIGtleT1faXRlbWdldHRlcigxKSwgcmV2ZXJzZT1UcnVlKQogICAgICAgIHJldHVybiBfaGVhcHEubmxhcmdlc3Qobiwgc2VsZi5pdGVtcygpLCBrZXk9X2l0ZW1nZXR0ZXIoMSkpCgogICAgZGVmIGVsZW1lbnRzKHNlbGYpOgogICAgICAgICcnJ0l0ZXJhdG9yIG92ZXIgZWxlbWVudHMgcmVwZWF0aW5nIGVhY2ggYXMgbWFueSB0aW1lcyBhcyBpdHMgY291bnQuCgogICAgICAgID4+PiBjID0gQ291bnRlcignQUJDQUJDJykKICAgICAgICA+Pj4gc29ydGVkKGMuZWxlbWVudHMoKSkKICAgICAgICBbJ0EnLCAnQScsICdCJywgJ0InLCAnQycsICdDJ10KCiAgICAgICAgIyBLbnV0aCdzIGV4YW1wbGUgZm9yIHByaW1lIGZhY3RvcnMgb2YgMTgzNjogIDIqKjIgKiAzKiozICogMTcqKjEKICAgICAgICA+Pj4gcHJpbWVfZmFjdG9ycyA9IENvdW50ZXIoezI6IDIsIDM6IDMsIDE3OiAxfSkKICAgICAgICA+Pj4gcHJvZHVjdCA9IDEKICAgICAgICA+Pj4gZm9yIGZhY3RvciBpbiBwcmltZV9mYWN0b3JzLmVsZW1lbnRzKCk6ICAgICAjIGxvb3Agb3ZlciBmYWN0b3JzCiAgICAgICAgLi4uICAgICBwcm9kdWN0ICo9IGZhY3RvciAgICAgICAgICAgICAgICAgICAgICAgIyBhbmQgbXVsdGlwbHkgdGhlbQogICAgICAgID4+PiBwcm9kdWN0CiAgICAgICAgMTgzNgoKICAgICAgICBOb3RlLCBpZiBhbiBlbGVtZW50J3MgY291bnQgaGFzIGJlZW4gc2V0IHRvIHplcm8gb3IgaXMgYSBuZWdhdGl2ZQogICAgICAgIG51bWJlciwgZWxlbWVudHMoKSB3aWxsIGlnbm9yZSBpdC4KCiAgICAgICAgJycnCiAgICAgICAgIyBFbXVsYXRlIEJhZy5kbyBmcm9tIFNtYWxsdGFsayBhbmQgTXVsdGlzZXQuYmVnaW4gZnJvbSBDKysuCiAgICAgICAgcmV0dXJuIF9jaGFpbi5mcm9tX2l0ZXJhYmxlKF9zdGFybWFwKF9yZXBlYXQsIHNlbGYuaXRlbXMoKSkpCgogICAgIyBPdmVycmlkZSBkaWN0IG1ldGhvZHMgd2hlcmUgbmVjZXNzYXJ5CgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbWtleXMoY2xzLCBpdGVyYWJsZSwgdj1Ob25lKToKICAgICAgICAjIFRoZXJlIGlzIG5vIGVxdWl2YWxlbnQgbWV0aG9kIGZvciBjb3VudGVycyBiZWNhdXNlIHNldHRpbmcgdj0xCiAgICAgICAgIyBtZWFucyB0aGF0IG5vIGVsZW1lbnQgY2FuIGhhdmUgYSBjb3VudCBncmVhdGVyIHRoYW4gb25lLgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoCiAgICAgICAgICAgICdDb3VudGVyLmZyb21rZXlzKCkgaXMgdW5kZWZpbmVkLiAgVXNlIENvdW50ZXIoaXRlcmFibGUpIGluc3RlYWQuJykKCiAgICBkZWYgdXBkYXRlKHNlbGYsIGl0ZXJhYmxlPU5vbmUsICoqa3dkcyk6CiAgICAgICAgJycnTGlrZSBkaWN0LnVwZGF0ZSgpIGJ1dCBhZGQgY291bnRzIGluc3RlYWQgb2YgcmVwbGFjaW5nIHRoZW0uCgogICAgICAgIFNvdXJjZSBjYW4gYmUgYW4gaXRlcmFibGUsIGEgZGljdGlvbmFyeSwgb3IgYW5vdGhlciBDb3VudGVyIGluc3RhbmNlLgoKICAgICAgICA+Pj4gYyA9IENvdW50ZXIoJ3doaWNoJykKICAgICAgICA+Pj4gYy51cGRhdGUoJ3dpdGNoJykgICAgICAgICAgICMgYWRkIGVsZW1lbnRzIGZyb20gYW5vdGhlciBpdGVyYWJsZQogICAgICAgID4+PiBkID0gQ291bnRlcignd2F0Y2gnKQogICAgICAgID4+PiBjLnVwZGF0ZShkKSAgICAgICAgICAgICAgICAgIyBhZGQgZWxlbWVudHMgZnJvbSBhbm90aGVyIGNvdW50ZXIKICAgICAgICA+Pj4gY1snaCddICAgICAgICAgICAgICAgICAgICAgICMgZm91ciAnaCcgaW4gd2hpY2gsIHdpdGNoLCBhbmQgd2F0Y2gKICAgICAgICA0CgogICAgICAgICcnJwogICAgICAgICMgVGhlIHJlZ3VsYXIgZGljdC51cGRhdGUoKSBvcGVyYXRpb24gbWFrZXMgbm8gc2Vuc2UgaGVyZSBiZWNhdXNlIHRoZQogICAgICAgICMgcmVwbGFjZSBiZWhhdmlvciByZXN1bHRzIGluIHRoZSBzb21lIG9mIG9yaWdpbmFsIHVudG91Y2hlZCBjb3VudHMKICAgICAgICAjIGJlaW5nIG1peGVkLWluIHdpdGggYWxsIG9mIHRoZSBvdGhlciBjb3VudHMgZm9yIGEgbWlzbWFzaCB0aGF0CiAgICAgICAgIyBkb2Vzbid0IGhhdmUgYSBzdHJhaWdodC1mb3J3YXJkIGludGVycHJldGF0aW9uIGluIG1vc3QgY291bnRpbmcKICAgICAgICAjIGNvbnRleHRzLiAgSW5zdGVhZCwgd2UgaW1wbGVtZW50IHN0cmFpZ2h0LWFkZGl0aW9uLiAgQm90aCB0aGUgaW5wdXRzCiAgICAgICAgIyBhbmQgb3V0cHV0cyBhcmUgYWxsb3dlZCB0byBjb250YWluIHplcm8gYW5kIG5lZ2F0aXZlIGNvdW50cy4KCiAgICAgICAgaWYgaXRlcmFibGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoaXRlcmFibGUsIE1hcHBpbmcpOgogICAgICAgICAgICAgICAgaWYgc2VsZjoKICAgICAgICAgICAgICAgICAgICBzZWxmX2dldCA9IHNlbGYuZ2V0CiAgICAgICAgICAgICAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIGl0ZXJhYmxlLml0ZW1zKCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGZbZWxlbV0gPSBjb3VudCArIHNlbGZfZ2V0KGVsZW0sIDApCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHN1cGVyKCkudXBkYXRlKGl0ZXJhYmxlKSAjIGZhc3QgcGF0aCB3aGVuIGNvdW50ZXIgaXMgZW1wdHkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIF9jb3VudF9lbGVtZW50cyhzZWxmLCBpdGVyYWJsZSkKICAgICAgICBpZiBrd2RzOgogICAgICAgICAgICBzZWxmLnVwZGF0ZShrd2RzKQoKICAgIGRlZiBzdWJ0cmFjdChzZWxmLCBpdGVyYWJsZT1Ob25lLCAqKmt3ZHMpOgogICAgICAgICcnJ0xpa2UgZGljdC51cGRhdGUoKSBidXQgc3VidHJhY3RzIGNvdW50cyBpbnN0ZWFkIG9mIHJlcGxhY2luZyB0aGVtLgogICAgICAgIENvdW50cyBjYW4gYmUgcmVkdWNlZCBiZWxvdyB6ZXJvLiAgQm90aCB0aGUgaW5wdXRzIGFuZCBvdXRwdXRzIGFyZQogICAgICAgIGFsbG93ZWQgdG8gY29udGFpbiB6ZXJvIGFuZCBuZWdhdGl2ZSBjb3VudHMuCgogICAgICAgIFNvdXJjZSBjYW4gYmUgYW4gaXRlcmFibGUsIGEgZGljdGlvbmFyeSwgb3IgYW5vdGhlciBDb3VudGVyIGluc3RhbmNlLgoKICAgICAgICA+Pj4gYyA9IENvdW50ZXIoJ3doaWNoJykKICAgICAgICA+Pj4gYy5zdWJ0cmFjdCgnd2l0Y2gnKSAgICAgICAgICAgICAjIHN1YnRyYWN0IGVsZW1lbnRzIGZyb20gYW5vdGhlciBpdGVyYWJsZQogICAgICAgID4+PiBjLnN1YnRyYWN0KENvdW50ZXIoJ3dhdGNoJykpICAgICMgc3VidHJhY3QgZWxlbWVudHMgZnJvbSBhbm90aGVyIGNvdW50ZXIKICAgICAgICA+Pj4gY1snaCddICAgICAgICAgICAgICAgICAgICAgICAgICAjIDIgaW4gd2hpY2gsIG1pbnVzIDEgaW4gd2l0Y2gsIG1pbnVzIDEgaW4gd2F0Y2gKICAgICAgICAwCiAgICAgICAgPj4+IGNbJ3cnXSAgICAgICAgICAgICAgICAgICAgICAgICAgIyAxIGluIHdoaWNoLCBtaW51cyAxIGluIHdpdGNoLCBtaW51cyAxIGluIHdhdGNoCiAgICAgICAgLTEKCiAgICAgICAgJycnCiAgICAgICAgaWYgaXRlcmFibGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHNlbGZfZ2V0ID0gc2VsZi5nZXQKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShpdGVyYWJsZSwgTWFwcGluZyk6CiAgICAgICAgICAgICAgICBmb3IgZWxlbSwgY291bnQgaW4gaXRlcmFibGUuaXRlbXMoKToKICAgICAgICAgICAgICAgICAgICBzZWxmW2VsZW1dID0gc2VsZl9nZXQoZWxlbSwgMCkgLSBjb3VudAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZm9yIGVsZW0gaW4gaXRlcmFibGU6CiAgICAgICAgICAgICAgICAgICAgc2VsZltlbGVtXSA9IHNlbGZfZ2V0KGVsZW0sIDApIC0gMQogICAgICAgIGlmIGt3ZHM6CiAgICAgICAgICAgIHNlbGYuc3VidHJhY3Qoa3dkcykKCiAgICBkZWYgY29weShzZWxmKToKICAgICAgICAnUmV0dXJuIGEgc2hhbGxvdyBjb3B5LicKICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZikKCiAgICBkZWYgX19yZWR1Y2VfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18sIChkaWN0KHNlbGYpLCkKCiAgICBkZWYgX19kZWxpdGVtX18oc2VsZiwgZWxlbSk6CiAgICAgICAgJ0xpa2UgZGljdC5fX2RlbGl0ZW1fXygpIGJ1dCBkb2VzIG5vdCByYWlzZSBLZXlFcnJvciBmb3IgbWlzc2luZyB2YWx1ZXMuJwogICAgICAgIGlmIGVsZW0gaW4gc2VsZjoKICAgICAgICAgICAgc3VwZXIoKS5fX2RlbGl0ZW1fXyhlbGVtKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICBpZiBub3Qgc2VsZjoKICAgICAgICAgICAgcmV0dXJuICclcygpJyAlIHNlbGYuX19jbGFzc19fLl9fbmFtZV9fCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpdGVtcyA9ICcsICcuam9pbihtYXAoJyVyOiAlcicuX19tb2RfXywgc2VsZi5tb3N0X2NvbW1vbigpKSkKICAgICAgICAgICAgcmV0dXJuICclcyh7JXN9KScgJSAoc2VsZi5fX2NsYXNzX18uX19uYW1lX18sIGl0ZW1zKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgICAgICMgaGFuZGxlIGNhc2Ugd2hlcmUgdmFsdWVzIGFyZSBub3Qgb3JkZXJhYmxlCiAgICAgICAgICAgIHJldHVybiAnezB9KHsxIXJ9KScuZm9ybWF0KHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLCBkaWN0KHNlbGYpKQoKICAgICMgTXVsdGlzZXQtc3R5bGUgbWF0aGVtYXRpY2FsIG9wZXJhdGlvbnMgZGlzY3Vzc2VkIGluOgogICAgIyAgICAgICBLbnV0aCBUQU9DUCBWb2x1bWUgSUkgc2VjdGlvbiA0LjYuMyBleGVyY2lzZSAxOQogICAgIyAgICAgICBhbmQgYXQgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9NdWx0aXNldAogICAgIwogICAgIyBPdXRwdXRzIGd1YXJhbnRlZWQgdG8gb25seSBpbmNsdWRlIHBvc2l0aXZlIGNvdW50cy4KICAgICMKICAgICMgVG8gc3RyaXAgbmVnYXRpdmUgYW5kIHplcm8gY291bnRzLCBhZGQtaW4gYW4gZW1wdHkgY291bnRlcjoKICAgICMgICAgICAgYyArPSBDb3VudGVyKCkKCiAgICBkZWYgX19hZGRfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgJycnQWRkIGNvdW50cyBmcm9tIHR3byBjb3VudGVycy4KCiAgICAgICAgPj4+IENvdW50ZXIoJ2FiYmInKSArIENvdW50ZXIoJ2JjYycpCiAgICAgICAgQ291bnRlcih7J2InOiA0LCAnYyc6IDIsICdhJzogMX0pCgogICAgICAgICcnJwogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBDb3VudGVyKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgcmVzdWx0ID0gQ291bnRlcigpCiAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIHNlbGYuaXRlbXMoKToKICAgICAgICAgICAgbmV3Y291bnQgPSBjb3VudCArIG90aGVyW2VsZW1dCiAgICAgICAgICAgIGlmIG5ld2NvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IG5ld2NvdW50CiAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIG90aGVyLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIGVsZW0gbm90IGluIHNlbGYgYW5kIGNvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IGNvdW50CiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBfX3N1Yl9fKHNlbGYsIG90aGVyKToKICAgICAgICAnJycgU3VidHJhY3QgY291bnQsIGJ1dCBrZWVwIG9ubHkgcmVzdWx0cyB3aXRoIHBvc2l0aXZlIGNvdW50cy4KCiAgICAgICAgPj4+IENvdW50ZXIoJ2FiYmJjJykgLSBDb3VudGVyKCdiY2NkJykKICAgICAgICBDb3VudGVyKHsnYic6IDIsICdhJzogMX0pCgogICAgICAgICcnJwogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBDb3VudGVyKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgcmVzdWx0ID0gQ291bnRlcigpCiAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIHNlbGYuaXRlbXMoKToKICAgICAgICAgICAgbmV3Y291bnQgPSBjb3VudCAtIG90aGVyW2VsZW1dCiAgICAgICAgICAgIGlmIG5ld2NvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IG5ld2NvdW50CiAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIG90aGVyLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIGVsZW0gbm90IGluIHNlbGYgYW5kIGNvdW50IDwgMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IDAgLSBjb3VudAogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgX19vcl9fKHNlbGYsIG90aGVyKToKICAgICAgICAnJydVbmlvbiBpcyB0aGUgbWF4aW11bSBvZiB2YWx1ZSBpbiBlaXRoZXIgb2YgdGhlIGlucHV0IGNvdW50ZXJzLgoKICAgICAgICA+Pj4gQ291bnRlcignYWJiYicpIHwgQ291bnRlcignYmNjJykKICAgICAgICBDb3VudGVyKHsnYic6IDMsICdjJzogMiwgJ2EnOiAxfSkKCiAgICAgICAgJycnCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIENvdW50ZXIpOgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKICAgICAgICByZXN1bHQgPSBDb3VudGVyKCkKICAgICAgICBmb3IgZWxlbSwgY291bnQgaW4gc2VsZi5pdGVtcygpOgogICAgICAgICAgICBvdGhlcl9jb3VudCA9IG90aGVyW2VsZW1dCiAgICAgICAgICAgIG5ld2NvdW50ID0gb3RoZXJfY291bnQgaWYgY291bnQgPCBvdGhlcl9jb3VudCBlbHNlIGNvdW50CiAgICAgICAgICAgIGlmIG5ld2NvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IG5ld2NvdW50CiAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIG90aGVyLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIGVsZW0gbm90IGluIHNlbGYgYW5kIGNvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IGNvdW50CiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBfX2FuZF9fKHNlbGYsIG90aGVyKToKICAgICAgICAnJycgSW50ZXJzZWN0aW9uIGlzIHRoZSBtaW5pbXVtIG9mIGNvcnJlc3BvbmRpbmcgY291bnRzLgogICAgCiAgICAgICAgPj4+IENvdW50ZXIoJ2FiYmInKSAmIENvdW50ZXIoJ2JjYycpCiAgICAgICAgQ291bnRlcih7J2InOiAxfSkKCiAgICAgICAgJycnCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIENvdW50ZXIpOgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKICAgICAgICByZXN1bHQgPSBDb3VudGVyKCkKICAgICAgICBmb3IgZWxlbSwgY291bnQgaW4gc2VsZi5pdGVtcygpOgogICAgICAgICAgICBvdGhlcl9jb3VudCA9IG90aGVyW2VsZW1dCiAgICAgICAgICAgIG5ld2NvdW50ID0gY291bnQgaWYgY291bnQgPCBvdGhlcl9jb3VudCBlbHNlIG90aGVyX2NvdW50CiAgICAgICAgICAgIGlmIG5ld2NvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IG5ld2NvdW50CiAgICAgICAgcmV0dXJuIHJlc3VsdAoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMgIENoYWluTWFwIChoZWxwZXIgZm9yIGNvbmZpZ3BhcnNlcikKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgojY2xhc3MgX0NoYWluTWFwKE11dGFibGVNYXBwaW5nKToKIyAgICAnJycgQSBDaGFpbk1hcCBncm91cHMgbXVsdGlwbGUgZGljdHMgKG9yIG90aGVyIG1hcHBpbmdzKSB0b2dldGhlcgojICAgIHRvIGNyZWF0ZSBhIHNpbmdsZSwgdXBkYXRlYWJsZSB2aWV3LgoKIyAgICBUaGUgdW5kZXJseWluZyBtYXBwaW5ncyBhcmUgc3RvcmVkIGluIGEgbGlzdC4gIFRoYXQgbGlzdCBpcyBwdWJsaWMgYW5kIGNhbgojICAgIGFjY2Vzc2VkIG9yIHVwZGF0ZWQgdXNpbmcgdGhlICptYXBzKiBhdHRyaWJ1dGUuICBUaGVyZSBpcyBubyBvdGhlciBzdGF0ZS4KCiMgICAgTG9va3VwcyBzZWFyY2ggdGhlIHVuZGVybHlpbmcgbWFwcGluZ3Mgc3VjY2Vzc2l2ZWx5IHVudGlsIGEga2V5IGlzIGZvdW5kLgojICAgIEluIGNvbnRyYXN0LCB3cml0ZXMsIHVwZGF0ZXMsIGFuZCBkZWxldGlvbnMgb25seSBvcGVyYXRlIG9uIHRoZSBmaXJzdAojICAgIG1hcHBpbmcuCiMKIyAgICAnJycKCiMgICAgZGVmIF9faW5pdF9fKHNlbGYsICptYXBzKToKIyAgICAgICAgJycnSW5pdGlhbGl6ZSBhIENoYWluTWFwIGJ5IHNldHRpbmcgKm1hcHMqIHRvIHRoZSBnaXZlbiBtYXBwaW5ncy4KIyAgICAgICAgSWYgbm8gbWFwcGluZ3MgYXJlIHByb3ZpZGVkLCBhIHNpbmdsZSBlbXB0eSBkaWN0aW9uYXJ5IGlzIHVzZWQuCiMKIyAgICAgICAgJycnCiMgICAgICAgIHNlbGYubWFwcyA9IGxpc3QobWFwcykgb3IgW3t9XSAgICAgICAgICAjIGFsd2F5cyBhdCBsZWFzdCBvbmUgbWFwCgojICAgIGRlZiBfX21pc3NpbmdfXyhzZWxmLCBrZXkpOgojICAgICAgICByYWlzZSBLZXlFcnJvcihrZXkpCgojICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBrZXkpOgojICAgICAgICBmb3IgbWFwcGluZyBpbiBzZWxmLm1hcHM6CiMgICAgICAgICAgICB0cnk6CiMgICAgICAgICAgICAgICAgcmV0dXJuIG1hcHBpbmdba2V5XSAgICAgICAgICAgICAjIGNhbid0IHVzZSAna2V5IGluIG1hcHBpbmcnIHdpdGggZGVmYXVsdGRpY3QKIyAgICAgICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKIyAgICAgICAgICAgICAgICBwYXNzCiMgICAgICAgIHJldHVybiBzZWxmLl9fbWlzc2luZ19fKGtleSkgICAgICAgICAgICAjIHN1cHBvcnQgc3ViY2xhc3NlcyB0aGF0IGRlZmluZSBfX21pc3NpbmdfXwoKIyAgICBkZWYgZ2V0KHNlbGYsIGtleSwgZGVmYXVsdD1Ob25lKToKIyAgICAgICAgcmV0dXJuIHNlbGZba2V5XSBpZiBrZXkgaW4gc2VsZiBlbHNlIGRlZmF1bHQKCiMgICAgZGVmIF9fbGVuX18oc2VsZik6CiMgICAgICAgIHJldHVybiBsZW4oc2V0KCkudW5pb24oKnNlbGYubWFwcykpICAgICAjIHJldXNlcyBzdG9yZWQgaGFzaCB2YWx1ZXMgaWYgcG9zc2libGUKCiMgICAgZGVmIF9faXRlcl9fKHNlbGYpOgojICAgICAgICByZXR1cm4gaXRlcihzZXQoKS51bmlvbigqc2VsZi5tYXBzKSkKCiMgICAgZGVmIF9fY29udGFpbnNfXyhzZWxmLCBrZXkpOgojICAgICAgICByZXR1cm4gYW55KGtleSBpbiBtIGZvciBtIGluIHNlbGYubWFwcykKCiMgICAgZGVmIF9fYm9vbF9fKHNlbGYpOgojICAgICAgICByZXR1cm4gYW55KHNlbGYubWFwcykKCiAgICAjZml4bWUsIGJyeXRob24KICAgICNAX3JlY3Vyc2l2ZV9yZXByKCkKIyAgICBkZWYgX19yZXByX18oc2VsZik6CiMgICAgICAgIHJldHVybiAnezAuX19jbGFzc19fLl9fbmFtZV9ffSh7MX0pJy5mb3JtYXQoCiMgICAgICAgICAgICBzZWxmLCAnLCAnLmpvaW4obWFwKHJlcHIsIHNlbGYubWFwcykpKQoKIyAgICBAY2xhc3NtZXRob2QKIyAgICBkZWYgZnJvbWtleXMoY2xzLCBpdGVyYWJsZSwgKmFyZ3MpOgojICAgICAgICAnQ3JlYXRlIGEgQ2hhaW5NYXAgd2l0aCBhIHNpbmdsZSBkaWN0IGNyZWF0ZWQgZnJvbSB0aGUgaXRlcmFibGUuJwojICAgICAgICByZXR1cm4gY2xzKGRpY3QuZnJvbWtleXMoaXRlcmFibGUsICphcmdzKSkKCiMgICAgZGVmIGNvcHkoc2VsZik6CiMgICAgICAgICdOZXcgQ2hhaW5NYXAgb3Igc3ViY2xhc3Mgd2l0aCBhIG5ldyBjb3B5IG9mIG1hcHNbMF0gYW5kIHJlZnMgdG8gbWFwc1sxOl0nCiMgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLm1hcHNbMF0uY29weSgpLCAqc2VsZi5tYXBzWzE6XSkKCiMgICAgX19jb3B5X18gPSBjb3B5CgojICAgIGRlZiBuZXdfY2hpbGQoc2VsZik6ICAgICAgICAgICAgICAgICAgICAgICAgIyBsaWtlIERqYW5nbydzIENvbnRleHQucHVzaCgpCiMgICAgICAgICdOZXcgQ2hhaW5NYXAgd2l0aCBhIG5ldyBkaWN0IGZvbGxvd2VkIGJ5IGFsbCBwcmV2aW91cyBtYXBzLicKIyAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKHt9LCAqc2VsZi5tYXBzKQoKIyAgICBAcHJvcGVydHkKIyAgICBkZWYgcGFyZW50cyhzZWxmKTogICAgICAgICAgICAgICAgICAgICAgICAgICMgbGlrZSBEamFuZ28ncyBDb250ZXh0LnBvcCgpCiMgICAgICAgICdOZXcgQ2hhaW5NYXAgZnJvbSBtYXBzWzE6XS4nCiMgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXygqc2VsZi5tYXBzWzE6XSkKCiMgICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIGtleSwgdmFsdWUpOgojICAgICAgICBzZWxmLm1hcHNbMF1ba2V5XSA9IHZhbHVlCgojICAgIGRlZiBfX2RlbGl0ZW1fXyhzZWxmLCBrZXkpOgojICAgICAgICB0cnk6CiMgICAgICAgICAgICBkZWwgc2VsZi5tYXBzWzBdW2tleV0KIyAgICAgICAgZXhjZXB0IEtleUVycm9yOgojICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3IoJ0tleSBub3QgZm91bmQgaW4gdGhlIGZpcnN0IG1hcHBpbmc6IHshcn0nLmZvcm1hdChrZXkpKQoKIyAgICBkZWYgcG9waXRlbShzZWxmKToKIyAgICAgICAgJ1JlbW92ZSBhbmQgcmV0dXJuIGFuIGl0ZW0gcGFpciBmcm9tIG1hcHNbMF0uIFJhaXNlIEtleUVycm9yIGlzIG1hcHNbMF0gaXMgZW1wdHkuJwojICAgICAgICB0cnk6CiMgICAgICAgICAgICByZXR1cm4gc2VsZi5tYXBzWzBdLnBvcGl0ZW0oKQojICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiMgICAgICAgICAgICByYWlzZSBLZXlFcnJvcignTm8ga2V5cyBmb3VuZCBpbiB0aGUgZmlyc3QgbWFwcGluZy4nKQoKIyAgICBkZWYgcG9wKHNlbGYsIGtleSwgKmFyZ3MpOgojICAgICAgICAnUmVtb3ZlICprZXkqIGZyb20gbWFwc1swXSBhbmQgcmV0dXJuIGl0cyB2YWx1ZS4gUmFpc2UgS2V5RXJyb3IgaWYgKmtleSogbm90IGluIG1hcHNbMF0uJwojICAgICAgICB0cnk6CiMgICAgICAgICAgICByZXR1cm4gc2VsZi5tYXBzWzBdLnBvcChrZXksICphcmdzKQojICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiMgICAgICAgICAgICAjcmFpc2UgS2V5RXJyb3IoJ0tleSBub3QgZm91bmQgaW4gdGhlIGZpcnN0IG1hcHBpbmc6IHshcn0nLmZvcm1hdChrZXkpKQojICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3IoJ0tleSBub3QgZm91bmQgaW4gdGhlIGZpcnN0IG1hcHBpbmc6ICVzJyAlIGtleSkKCiMgICAgZGVmIGNsZWFyKHNlbGYpOgojICAgICAgICAnQ2xlYXIgbWFwc1swXSwgbGVhdmluZyBtYXBzWzE6XSBpbnRhY3QuJwojICAgICAgICBzZWxmLm1hcHNbMF0uY2xlYXIoKQoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIyBVc2VyRGljdAojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKI2NsYXNzIFVzZXJEaWN0KE11dGFibGVNYXBwaW5nKToKCiAgICAjIFN0YXJ0IGJ5IGZpbGxpbmctb3V0IHRoZSBhYnN0cmFjdCBtZXRob2RzCiMgICAgZGVmIF9faW5pdF9fKHNlbGYsIGRpY3Q9Tm9uZSwgKiprd2FyZ3MpOgojICAgICAgICBzZWxmLmRhdGEgPSB7fQojICAgICAgICBpZiBkaWN0IGlzIG5vdCBOb25lOgojICAgICAgICAgICAgc2VsZi51cGRhdGUoZGljdCkKIyAgICAgICAgaWYgbGVuKGt3YXJncyk6CiMgICAgICAgICAgICBzZWxmLnVwZGF0ZShrd2FyZ3MpCiMgICAgZGVmIF9fbGVuX18oc2VsZik6IHJldHVybiBsZW4oc2VsZi5kYXRhKQojICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBrZXkpOgojICAgICAgICBpZiBrZXkgaW4gc2VsZi5kYXRhOgojICAgICAgICAgICAgcmV0dXJuIHNlbGYuZGF0YVtrZXldCiMgICAgICAgIGlmIGhhc2F0dHIoc2VsZi5fX2NsYXNzX18sICJfX21pc3NpbmdfXyIpOgojICAgICAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fLl9fbWlzc2luZ19fKHNlbGYsIGtleSkKIyAgICAgICAgcmFpc2UgS2V5RXJyb3Ioa2V5KQojICAgIGRlZiBfX3NldGl0ZW1fXyhzZWxmLCBrZXksIGl0ZW0pOiBzZWxmLmRhdGFba2V5XSA9IGl0ZW0KIyAgICBkZWYgX19kZWxpdGVtX18oc2VsZiwga2V5KTogZGVsIHNlbGYuZGF0YVtrZXldCiMgICAgZGVmIF9faXRlcl9fKHNlbGYpOgojICAgICAgICByZXR1cm4gaXRlcihzZWxmLmRhdGEpCgogICAgIyBNb2RpZnkgX19jb250YWluc19fIHRvIHdvcmsgY29ycmVjdGx5IHdoZW4gX19taXNzaW5nX18gaXMgcHJlc2VudAojICAgIGRlZiBfX2NvbnRhaW5zX18oc2VsZiwga2V5KToKIyAgICAgICAgcmV0dXJuIGtleSBpbiBzZWxmLmRhdGEKCiAgICAjIE5vdywgYWRkIHRoZSBtZXRob2RzIGluIGRpY3RzIGJ1dCBub3QgaW4gTXV0YWJsZU1hcHBpbmcKIyAgICBkZWYgX19yZXByX18oc2VsZik6IHJldHVybiByZXByKHNlbGYuZGF0YSkKIyAgICBkZWYgY29weShzZWxmKToKIyAgICAgICAgaWYgc2VsZi5fX2NsYXNzX18gaXMgVXNlckRpY3Q6CiMgICAgICAgICAgICByZXR1cm4gVXNlckRpY3Qoc2VsZi5kYXRhLmNvcHkoKSkKIyAgICAgICAgaW1wb3J0IGNvcHkKIyAgICAgICAgZGF0YSA9IHNlbGYuZGF0YQojICAgICAgICB0cnk6CiMgICAgICAgICAgICBzZWxmLmRhdGEgPSB7fQojICAgICAgICAgICAgYyA9IGNvcHkuY29weShzZWxmKQojICAgICAgICBmaW5hbGx5OgojICAgICAgICAgICAgc2VsZi5kYXRhID0gZGF0YQojICAgICAgICBjLnVwZGF0ZShzZWxmKQojICAgICAgICByZXR1cm4gYwojICAgIEBjbGFzc21ldGhvZAojICAgIGRlZiBmcm9ta2V5cyhjbHMsIGl0ZXJhYmxlLCB2YWx1ZT1Ob25lKToKIyAgICAgICAgZCA9IGNscygpCiMgICAgICAgIGZvciBrZXkgaW4gaXRlcmFibGU6CiMgICAgICAgICAgICBkW2tleV0gPSB2YWx1ZQojICAgICAgICByZXR1cm4gZAoKCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMgVXNlckxpc3QKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiNjbGFzcyBVc2VyTGlzdChNdXRhYmxlU2VxdWVuY2UpOgojICAgICcnJ0EgbW9yZSBvciBsZXNzIGNvbXBsZXRlIHVzZXItZGVmaW5lZCB3cmFwcGVyIGFyb3VuZCBsaXN0IG9iamVjdHMuJycnCiMgICAgZGVmIF9faW5pdF9fKHNlbGYsIGluaXRsaXN0PU5vbmUpOgojICAgICAgICBzZWxmLmRhdGEgPSBbXQojICAgICAgICBpZiBpbml0bGlzdCBpcyBub3QgTm9uZToKIyAgICAgICAgICAgICMgWFhYIHNob3VsZCB0aGlzIGFjY2VwdCBhbiBhcmJpdHJhcnkgc2VxdWVuY2U/CiMgICAgICAgICAgICBpZiB0eXBlKGluaXRsaXN0KSA9PSB0eXBlKHNlbGYuZGF0YSk6CiMgICAgICAgICAgICAgICAgc2VsZi5kYXRhWzpdID0gaW5pdGxpc3QKIyAgICAgICAgICAgIGVsaWYgaXNpbnN0YW5jZShpbml0bGlzdCwgVXNlckxpc3QpOgojICAgICAgICAgICAgICAgIHNlbGYuZGF0YVs6XSA9IGluaXRsaXN0LmRhdGFbOl0KIyAgICAgICAgICAgIGVsc2U6CiMgICAgICAgICAgICAgICAgc2VsZi5kYXRhID0gbGlzdChpbml0bGlzdCkKIyAgICBkZWYgX19yZXByX18oc2VsZik6IHJldHVybiByZXByKHNlbGYuZGF0YSkKIyAgICBkZWYgX19sdF9fKHNlbGYsIG90aGVyKTogcmV0dXJuIHNlbGYuZGF0YSA8ICBzZWxmLl9fY2FzdChvdGhlcikKIyAgICBkZWYgX19sZV9fKHNlbGYsIG90aGVyKTogcmV0dXJuIHNlbGYuZGF0YSA8PSBzZWxmLl9fY2FzdChvdGhlcikKIyAgICBkZWYgX19lcV9fKHNlbGYsIG90aGVyKTogcmV0dXJuIHNlbGYuZGF0YSA9PSBzZWxmLl9fY2FzdChvdGhlcikKIyAgICBkZWYgX19uZV9fKHNlbGYsIG90aGVyKTogcmV0dXJuIHNlbGYuZGF0YSAhPSBzZWxmLl9fY2FzdChvdGhlcikKIyAgICBkZWYgX19ndF9fKHNlbGYsIG90aGVyKTogcmV0dXJuIHNlbGYuZGF0YSA+ICBzZWxmLl9fY2FzdChvdGhlcikKIyAgICBkZWYgX19nZV9fKHNlbGYsIG90aGVyKTogcmV0dXJuIHNlbGYuZGF0YSA+PSBzZWxmLl9fY2FzdChvdGhlcikKIyAgICBkZWYgX19jYXN0KHNlbGYsIG90aGVyKToKIyAgICAgICAgcmV0dXJuIG90aGVyLmRhdGEgaWYgaXNpbnN0YW5jZShvdGhlciwgVXNlckxpc3QpIGVsc2Ugb3RoZXIKIyAgICBkZWYgX19jb250YWluc19fKHNlbGYsIGl0ZW0pOiByZXR1cm4gaXRlbSBpbiBzZWxmLmRhdGEKIyAgICBkZWYgX19sZW5fXyhzZWxmKTogcmV0dXJuIGxlbihzZWxmLmRhdGEpCiMgICAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGkpOiByZXR1cm4gc2VsZi5kYXRhW2ldCiMgICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIGksIGl0ZW0pOiBzZWxmLmRhdGFbaV0gPSBpdGVtCiMgICAgZGVmIF9fZGVsaXRlbV9fKHNlbGYsIGkpOiBkZWwgc2VsZi5kYXRhW2ldCiMgICAgZGVmIF9fYWRkX18oc2VsZiwgb3RoZXIpOgojICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBVc2VyTGlzdCk6CiMgICAgICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhICsgb3RoZXIuZGF0YSkKIyAgICAgICAgZWxpZiBpc2luc3RhbmNlKG90aGVyLCB0eXBlKHNlbGYuZGF0YSkpOgojICAgICAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKHNlbGYuZGF0YSArIG90aGVyKQojICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhICsgbGlzdChvdGhlcikpCiMgICAgZGVmIF9fcmFkZF9fKHNlbGYsIG90aGVyKToKIyAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgVXNlckxpc3QpOgojICAgICAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKG90aGVyLmRhdGEgKyBzZWxmLmRhdGEpCiMgICAgICAgIGVsaWYgaXNpbnN0YW5jZShvdGhlciwgdHlwZShzZWxmLmRhdGEpKToKIyAgICAgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhvdGhlciArIHNlbGYuZGF0YSkKIyAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKGxpc3Qob3RoZXIpICsgc2VsZi5kYXRhKQojICAgIGRlZiBfX2lhZGRfXyhzZWxmLCBvdGhlcik6CiMgICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIFVzZXJMaXN0KToKIyAgICAgICAgICAgIHNlbGYuZGF0YSArPSBvdGhlci5kYXRhCiMgICAgICAgIGVsaWYgaXNpbnN0YW5jZShvdGhlciwgdHlwZShzZWxmLmRhdGEpKToKIyAgICAgICAgICAgIHNlbGYuZGF0YSArPSBvdGhlcgojICAgICAgICBlbHNlOgojICAgICAgICAgICAgc2VsZi5kYXRhICs9IGxpc3Qob3RoZXIpCiMgICAgICAgIHJldHVybiBzZWxmCiMgICAgZGVmIF9fbXVsX18oc2VsZiwgbik6CiMgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGEqbikKIyAgICBfX3JtdWxfXyA9IF9fbXVsX18KIyAgICBkZWYgX19pbXVsX18oc2VsZiwgbik6CiMgICAgICAgIHNlbGYuZGF0YSAqPSBuCiMgICAgICAgIHJldHVybiBzZWxmCiMgICAgZGVmIGFwcGVuZChzZWxmLCBpdGVtKTogc2VsZi5kYXRhLmFwcGVuZChpdGVtKQojICAgIGRlZiBpbnNlcnQoc2VsZiwgaSwgaXRlbSk6IHNlbGYuZGF0YS5pbnNlcnQoaSwgaXRlbSkKIyAgICBkZWYgcG9wKHNlbGYsIGk9LTEpOiByZXR1cm4gc2VsZi5kYXRhLnBvcChpKQojICAgIGRlZiByZW1vdmUoc2VsZiwgaXRlbSk6IHNlbGYuZGF0YS5yZW1vdmUoaXRlbSkKIyAgICBkZWYgY291bnQoc2VsZiwgaXRlbSk6IHJldHVybiBzZWxmLmRhdGEuY291bnQoaXRlbSkKIyAgICBkZWYgaW5kZXgoc2VsZiwgaXRlbSwgKmFyZ3MpOiByZXR1cm4gc2VsZi5kYXRhLmluZGV4KGl0ZW0sICphcmdzKQojICAgIGRlZiByZXZlcnNlKHNlbGYpOiBzZWxmLmRhdGEucmV2ZXJzZSgpCiMgICAgZGVmIHNvcnQoc2VsZiwgKmFyZ3MsICoqa3dkcyk6IHNlbGYuZGF0YS5zb3J0KCphcmdzLCAqKmt3ZHMpCiMgICAgZGVmIGV4dGVuZChzZWxmLCBvdGhlcik6CiMgICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIFVzZXJMaXN0KToKIyAgICAgICAgICAgIHNlbGYuZGF0YS5leHRlbmQob3RoZXIuZGF0YSkKIyAgICAgICAgZWxzZToKIyAgICAgICAgICAgIHNlbGYuZGF0YS5leHRlbmQob3RoZXIpCgoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIyBVc2VyU3RyaW5nCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgojY2xhc3MgVXNlclN0cmluZyhTZXF1ZW5jZSk6CiMgICAgZGVmIF9faW5pdF9fKHNlbGYsIHNlcSk6CiMgICAgICAgIGlmIGlzaW5zdGFuY2Uoc2VxLCBzdHIpOgojICAgICAgICAgICAgc2VsZi5kYXRhID0gc2VxCiMgICAgICAgIGVsaWYgaXNpbnN0YW5jZShzZXEsIFVzZXJTdHJpbmcpOgojICAgICAgICAgICAgc2VsZi5kYXRhID0gc2VxLmRhdGFbOl0KIyAgICAgICAgZWxzZToKIyAgICAgICAgICAgIHNlbGYuZGF0YSA9IHN0cihzZXEpCiMgICAgZGVmIF9fc3RyX18oc2VsZik6IHJldHVybiBzdHIoc2VsZi5kYXRhKQojICAgIGRlZiBfX3JlcHJfXyhzZWxmKTogcmV0dXJuIHJlcHIoc2VsZi5kYXRhKQojICAgIGRlZiBfX2ludF9fKHNlbGYpOiByZXR1cm4gaW50KHNlbGYuZGF0YSkKIyAgICBkZWYgX19mbG9hdF9fKHNlbGYpOiByZXR1cm4gZmxvYXQoc2VsZi5kYXRhKQojICAgIGRlZiBfX2NvbXBsZXhfXyhzZWxmKTogcmV0dXJuIGNvbXBsZXgoc2VsZi5kYXRhKQojICAgIGRlZiBfX2hhc2hfXyhzZWxmKTogcmV0dXJuIGhhc2goc2VsZi5kYXRhKQoKIyAgICBkZWYgX19lcV9fKHNlbGYsIHN0cmluZyk6CiMgICAgICAgIGlmIGlzaW5zdGFuY2Uoc3RyaW5nLCBVc2VyU3RyaW5nKToKIyAgICAgICAgICAgIHJldHVybiBzZWxmLmRhdGEgPT0gc3RyaW5nLmRhdGEKIyAgICAgICAgcmV0dXJuIHNlbGYuZGF0YSA9PSBzdHJpbmcKIyAgICBkZWYgX19uZV9fKHNlbGYsIHN0cmluZyk6CiMgICAgICAgIGlmIGlzaW5zdGFuY2Uoc3RyaW5nLCBVc2VyU3RyaW5nKToKIyAgICAgICAgICAgIHJldHVybiBzZWxmLmRhdGEgIT0gc3RyaW5nLmRhdGEKIyAgICAgICAgcmV0dXJuIHNlbGYuZGF0YSAhPSBzdHJpbmcKIyAgICBkZWYgX19sdF9fKHNlbGYsIHN0cmluZyk6CiMgICAgICAgIGlmIGlzaW5zdGFuY2Uoc3RyaW5nLCBVc2VyU3RyaW5nKToKIyAgICAgICAgICAgIHJldHVybiBzZWxmLmRhdGEgPCBzdHJpbmcuZGF0YQojICAgICAgICByZXR1cm4gc2VsZi5kYXRhIDwgc3RyaW5nCiMgICAgZGVmIF9fbGVfXyhzZWxmLCBzdHJpbmcpOgojICAgICAgICBpZiBpc2luc3RhbmNlKHN0cmluZywgVXNlclN0cmluZyk6CiMgICAgICAgICAgICByZXR1cm4gc2VsZi5kYXRhIDw9IHN0cmluZy5kYXRhCiMgICAgICAgIHJldHVybiBzZWxmLmRhdGEgPD0gc3RyaW5nCiMgICAgZGVmIF9fZ3RfXyhzZWxmLCBzdHJpbmcpOgojICAgICAgICBpZiBpc2luc3RhbmNlKHN0cmluZywgVXNlclN0cmluZyk6CiMgICAgICAgICAgICByZXR1cm4gc2VsZi5kYXRhID4gc3RyaW5nLmRhdGEKIyAgICAgICAgcmV0dXJuIHNlbGYuZGF0YSA+IHN0cmluZwojICAgIGRlZiBfX2dlX18oc2VsZiwgc3RyaW5nKToKIyAgICAgICAgaWYgaXNpbnN0YW5jZShzdHJpbmcsIFVzZXJTdHJpbmcpOgojICAgICAgICAgICAgcmV0dXJuIHNlbGYuZGF0YSA+PSBzdHJpbmcuZGF0YQojICAgICAgICByZXR1cm4gc2VsZi5kYXRhID49IHN0cmluZwoKIyAgICBkZWYgX19jb250YWluc19fKHNlbGYsIGNoYXIpOgojICAgICAgICBpZiBpc2luc3RhbmNlKGNoYXIsIFVzZXJTdHJpbmcpOgojICAgICAgICAgICAgY2hhciA9IGNoYXIuZGF0YQojICAgICAgICByZXR1cm4gY2hhciBpbiBzZWxmLmRhdGEKCiMgICAgZGVmIF9fbGVuX18oc2VsZik6IHJldHVybiBsZW4oc2VsZi5kYXRhKQojICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBpbmRleCk6IHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGFbaW5kZXhdKQojICAgIGRlZiBfX2FkZF9fKHNlbGYsIG90aGVyKToKIyAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgVXNlclN0cmluZyk6CiMgICAgICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhICsgb3RoZXIuZGF0YSkKIyAgICAgICAgZWxpZiBpc2luc3RhbmNlKG90aGVyLCBzdHIpOgojICAgICAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKHNlbGYuZGF0YSArIG90aGVyKQojICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhICsgc3RyKG90aGVyKSkKIyAgICBkZWYgX19yYWRkX18oc2VsZiwgb3RoZXIpOgojICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBzdHIpOgojICAgICAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKG90aGVyICsgc2VsZi5kYXRhKQojICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc3RyKG90aGVyKSArIHNlbGYuZGF0YSkKIyAgICBkZWYgX19tdWxfXyhzZWxmLCBuKToKIyAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKHNlbGYuZGF0YSpuKQojICAgIF9fcm11bF9fID0gX19tdWxfXwojICAgIGRlZiBfX21vZF9fKHNlbGYsIGFyZ3MpOgojICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhICUgYXJncykKCiAgICAjIHRoZSBmb2xsb3dpbmcgbWV0aG9kcyBhcmUgZGVmaW5lZCBpbiBhbHBoYWJldGljYWwgb3JkZXI6CiMgICAgZGVmIGNhcGl0YWxpemUoc2VsZik6IHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGEuY2FwaXRhbGl6ZSgpKQojICAgIGRlZiBjZW50ZXIoc2VsZiwgd2lkdGgsICphcmdzKToKIyAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKHNlbGYuZGF0YS5jZW50ZXIod2lkdGgsICphcmdzKSkKIyAgICBkZWYgY291bnQoc2VsZiwgc3ViLCBzdGFydD0wLCBlbmQ9X3N5cy5tYXhzaXplKToKIyAgICAgICAgaWYgaXNpbnN0YW5jZShzdWIsIFVzZXJTdHJpbmcpOgojICAgICAgICAgICAgc3ViID0gc3ViLmRhdGEKIyAgICAgICAgcmV0dXJuIHNlbGYuZGF0YS5jb3VudChzdWIsIHN0YXJ0LCBlbmQpCiMgICAgZGVmIGVuY29kZShzZWxmLCBlbmNvZGluZz1Ob25lLCBlcnJvcnM9Tm9uZSk6ICMgWFhYIGltcHJvdmUgdGhpcz8KIyAgICAgICAgaWYgZW5jb2Rpbmc6CiMgICAgICAgICAgICBpZiBlcnJvcnM6CiMgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKHNlbGYuZGF0YS5lbmNvZGUoZW5jb2RpbmcsIGVycm9ycykpCiMgICAgICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhLmVuY29kZShlbmNvZGluZykpCiMgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGEuZW5jb2RlKCkpCiMgICAgZGVmIGVuZHN3aXRoKHNlbGYsIHN1ZmZpeCwgc3RhcnQ9MCwgZW5kPV9zeXMubWF4c2l6ZSk6CiMgICAgICAgIHJldHVybiBzZWxmLmRhdGEuZW5kc3dpdGgoc3VmZml4LCBzdGFydCwgZW5kKQojICAgIGRlZiBleHBhbmR0YWJzKHNlbGYsIHRhYnNpemU9OCk6CiMgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGEuZXhwYW5kdGFicyh0YWJzaXplKSkKIyAgICBkZWYgZmluZChzZWxmLCBzdWIsIHN0YXJ0PTAsIGVuZD1fc3lzLm1heHNpemUpOgojICAgICAgICBpZiBpc2luc3RhbmNlKHN1YiwgVXNlclN0cmluZyk6CiMgICAgICAgICAgICBzdWIgPSBzdWIuZGF0YQojICAgICAgICByZXR1cm4gc2VsZi5kYXRhLmZpbmQoc3ViLCBzdGFydCwgZW5kKQojICAgIGRlZiBmb3JtYXQoc2VsZiwgKmFyZ3MsICoqa3dkcyk6CiMgICAgICAgIHJldHVybiBzZWxmLmRhdGEuZm9ybWF0KCphcmdzLCAqKmt3ZHMpCiMgICAgZGVmIGluZGV4KHNlbGYsIHN1Yiwgc3RhcnQ9MCwgZW5kPV9zeXMubWF4c2l6ZSk6CiMgICAgICAgIHJldHVybiBzZWxmLmRhdGEuaW5kZXgoc3ViLCBzdGFydCwgZW5kKQojICAgIGRlZiBpc2FscGhhKHNlbGYpOiByZXR1cm4gc2VsZi5kYXRhLmlzYWxwaGEoKQojICAgIGRlZiBpc2FsbnVtKHNlbGYpOiByZXR1cm4gc2VsZi5kYXRhLmlzYWxudW0oKQojICAgIGRlZiBpc2RlY2ltYWwoc2VsZik6IHJldHVybiBzZWxmLmRhdGEuaXNkZWNpbWFsKCkKIyAgICBkZWYgaXNkaWdpdChzZWxmKTogcmV0dXJuIHNlbGYuZGF0YS5pc2RpZ2l0KCkKIyAgICBkZWYgaXNpZGVudGlmaWVyKHNlbGYpOiByZXR1cm4gc2VsZi5kYXRhLmlzaWRlbnRpZmllcigpCiMgICAgZGVmIGlzbG93ZXIoc2VsZik6IHJldHVybiBzZWxmLmRhdGEuaXNsb3dlcigpCiMgICAgZGVmIGlzbnVtZXJpYyhzZWxmKTogcmV0dXJuIHNlbGYuZGF0YS5pc251bWVyaWMoKQojICAgIGRlZiBpc3NwYWNlKHNlbGYpOiByZXR1cm4gc2VsZi5kYXRhLmlzc3BhY2UoKQojICAgIGRlZiBpc3RpdGxlKHNlbGYpOiByZXR1cm4gc2VsZi5kYXRhLmlzdGl0bGUoKQojICAgIGRlZiBpc3VwcGVyKHNlbGYpOiByZXR1cm4gc2VsZi5kYXRhLmlzdXBwZXIoKQojICAgIGRlZiBqb2luKHNlbGYsIHNlcSk6IHJldHVybiBzZWxmLmRhdGEuam9pbihzZXEpCiMgICAgZGVmIGxqdXN0KHNlbGYsIHdpZHRoLCAqYXJncyk6CiMgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGEubGp1c3Qod2lkdGgsICphcmdzKSkKIyAgICBkZWYgbG93ZXIoc2VsZik6IHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGEubG93ZXIoKSkKIyAgICBkZWYgbHN0cmlwKHNlbGYsIGNoYXJzPU5vbmUpOiByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhLmxzdHJpcChjaGFycykpCiMgICAgZGVmIHBhcnRpdGlvbihzZWxmLCBzZXApOgojICAgICAgICByZXR1cm4gc2VsZi5kYXRhLnBhcnRpdGlvbihzZXApCiMgICAgZGVmIHJlcGxhY2Uoc2VsZiwgb2xkLCBuZXcsIG1heHNwbGl0PS0xKToKIyAgICAgICAgaWYgaXNpbnN0YW5jZShvbGQsIFVzZXJTdHJpbmcpOgojICAgICAgICAgICAgb2xkID0gb2xkLmRhdGEKIyAgICAgICAgaWYgaXNpbnN0YW5jZShuZXcsIFVzZXJTdHJpbmcpOgojICAgICAgICAgICAgbmV3ID0gbmV3LmRhdGEKIyAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKHNlbGYuZGF0YS5yZXBsYWNlKG9sZCwgbmV3LCBtYXhzcGxpdCkpCiMgICAgZGVmIHJmaW5kKHNlbGYsIHN1Yiwgc3RhcnQ9MCwgZW5kPV9zeXMubWF4c2l6ZSk6CiMgICAgICAgIGlmIGlzaW5zdGFuY2Uoc3ViLCBVc2VyU3RyaW5nKToKIyAgICAgICAgICAgIHN1YiA9IHN1Yi5kYXRhCiMgICAgICAgIHJldHVybiBzZWxmLmRhdGEucmZpbmQoc3ViLCBzdGFydCwgZW5kKQojICAgIGRlZiByaW5kZXgoc2VsZiwgc3ViLCBzdGFydD0wLCBlbmQ9X3N5cy5tYXhzaXplKToKIyAgICAgICAgcmV0dXJuIHNlbGYuZGF0YS5yaW5kZXgoc3ViLCBzdGFydCwgZW5kKQojICAgIGRlZiByanVzdChzZWxmLCB3aWR0aCwgKmFyZ3MpOgojICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhLnJqdXN0KHdpZHRoLCAqYXJncykpCiMgICAgZGVmIHJwYXJ0aXRpb24oc2VsZiwgc2VwKToKIyAgICAgICAgcmV0dXJuIHNlbGYuZGF0YS5ycGFydGl0aW9uKHNlcCkKIyAgICBkZWYgcnN0cmlwKHNlbGYsIGNoYXJzPU5vbmUpOgojICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhLnJzdHJpcChjaGFycykpCiMgICAgZGVmIHNwbGl0KHNlbGYsIHNlcD1Ob25lLCBtYXhzcGxpdD0tMSk6CiMgICAgICAgIHJldHVybiBzZWxmLmRhdGEuc3BsaXQoc2VwLCBtYXhzcGxpdCkKIyAgICBkZWYgcnNwbGl0KHNlbGYsIHNlcD1Ob25lLCBtYXhzcGxpdD0tMSk6CiMgICAgICAgIHJldHVybiBzZWxmLmRhdGEucnNwbGl0KHNlcCwgbWF4c3BsaXQpCiMgICAgZGVmIHNwbGl0bGluZXMoc2VsZiwga2VlcGVuZHM9MCk6IHJldHVybiBzZWxmLmRhdGEuc3BsaXRsaW5lcyhrZWVwZW5kcykKIyAgICBkZWYgc3RhcnRzd2l0aChzZWxmLCBwcmVmaXgsIHN0YXJ0PTAsIGVuZD1fc3lzLm1heHNpemUpOgojICAgICAgICByZXR1cm4gc2VsZi5kYXRhLnN0YXJ0c3dpdGgocHJlZml4LCBzdGFydCwgZW5kKQojICAgIGRlZiBzdHJpcChzZWxmLCBjaGFycz1Ob25lKTogcmV0dXJuIHNlbGYuX19jbGFzc19fKHNlbGYuZGF0YS5zdHJpcChjaGFycykpCiMgICAgZGVmIHN3YXBjYXNlKHNlbGYpOiByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhLnN3YXBjYXNlKCkpCiMgICAgZGVmIHRpdGxlKHNlbGYpOiByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhLnRpdGxlKCkpCiMgICAgZGVmIHRyYW5zbGF0ZShzZWxmLCAqYXJncyk6CiMgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGEudHJhbnNsYXRlKCphcmdzKSkKIyAgICBkZWYgdXBwZXIoc2VsZik6IHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmRhdGEudXBwZXIoKSkKIyAgICBkZWYgemZpbGwoc2VsZiwgd2lkdGgpOiByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZi5kYXRhLnpmaWxsKHdpZHRoKSkKCgo=',
'/Lib/collections/__main__.py':'IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjIFNpbXBsZSB0ZXN0cwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKIyB2ZXJpZnkgdGhhdCBpbnN0YW5jZXMgY2FuIGJlIHBpY2tsZWQKZnJvbSBjb2xsZWN0aW9ucyBpbXBvcnQgbmFtZWR0dXBsZQpmcm9tIHBpY2tsZSBpbXBvcnQgbG9hZHMsIGR1bXBzClBvaW50ID0gbmFtZWR0dXBsZSgnUG9pbnQnLCAneCwgeScsIFRydWUpCnAgPSBQb2ludCh4PTEwLCB5PTIwKQphc3NlcnQgcCA9PSBsb2FkcyhkdW1wcyhwKSkKCiMgdGVzdCBhbmQgZGVtb25zdHJhdGUgYWJpbGl0eSB0byBvdmVycmlkZSBtZXRob2RzCmNsYXNzIFBvaW50KG5hbWVkdHVwbGUoJ1BvaW50JywgJ3ggeScpKToKICAgIF9fc2xvdHNfXyA9ICgpCiAgICBAcHJvcGVydHkKICAgIGRlZiBoeXBvdChzZWxmKToKICAgICAgICByZXR1cm4gKHNlbGYueCAqKiAyICsgc2VsZi55ICoqIDIpICoqIDAuNQogICAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgICAgcmV0dXJuICdQb2ludDogeD0lNi4zZiAgeT0lNi4zZiAgaHlwb3Q9JTYuM2YnICUgKHNlbGYueCwgc2VsZi55LCBzZWxmLmh5cG90KQoKZm9yIHAgaW4gUG9pbnQoMywgNCksIFBvaW50KDE0LCA1LzcuKToKICAgIHByaW50IChwKQoKY2xhc3MgUG9pbnQobmFtZWR0dXBsZSgnUG9pbnQnLCAneCB5JykpOgogICAgJ1BvaW50IGNsYXNzIHdpdGggb3B0aW1pemVkIF9tYWtlKCkgYW5kIF9yZXBsYWNlKCkgd2l0aG91dCBlcnJvci1jaGVja2luZycKICAgIF9fc2xvdHNfXyA9ICgpCiAgICBfbWFrZSA9IGNsYXNzbWV0aG9kKHR1cGxlLl9fbmV3X18pCiAgICBkZWYgX3JlcGxhY2Uoc2VsZiwgX21hcD1tYXAsICoqa3dkcyk6CiAgICAgICAgcmV0dXJuIHNlbGYuX21ha2UoX21hcChrd2RzLmdldCwgKCd4JywgJ3knKSwgc2VsZikpCgpwcmludChQb2ludCgxMSwgMjIpLl9yZXBsYWNlKHg9MTAwKSkKClBvaW50M0QgPSBuYW1lZHR1cGxlKCdQb2ludDNEJywgUG9pbnQuX2ZpZWxkcyArICgneicsKSkKcHJpbnQoUG9pbnQzRC5fX2RvY19fKQoKaW1wb3J0IGRvY3Rlc3QsIGNvbGxlY3Rpb25zClRlc3RSZXN1bHRzID0gbmFtZWR0dXBsZSgnVGVzdFJlc3VsdHMnLCAnZmFpbGVkIGF0dGVtcHRlZCcpCnByaW50KFRlc3RSZXN1bHRzKCpkb2N0ZXN0LnRlc3Rtb2QoY29sbGVjdGlvbnMpKSkK',
'/Lib/http/cookies.py':'CiMKCiMjIyMKIyBDb3B5cmlnaHQgMjAwMCBieSBUaW1vdGh5IE8nTWFsbGV5IDx0aW1vQGFsdW0ubWl0LmVkdT4KIwojICAgICAgICAgICAgICAgIEFsbCBSaWdodHMgUmVzZXJ2ZWQKIwojIFBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZCBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUKIyBhbmQgaXRzIGRvY3VtZW50YXRpb24gZm9yIGFueSBwdXJwb3NlIGFuZCB3aXRob3V0IGZlZSBpcyBoZXJlYnkKIyBncmFudGVkLCBwcm92aWRlZCB0aGF0IHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFwcGVhciBpbiBhbGwKIyBjb3BpZXMgYW5kIHRoYXQgYm90aCB0aGF0IGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbgojIG5vdGljZSBhcHBlYXIgaW4gc3VwcG9ydGluZyBkb2N1bWVudGF0aW9uLCBhbmQgdGhhdCB0aGUgbmFtZSBvZgojIFRpbW90aHkgTydNYWxsZXkgIG5vdCBiZSB1c2VkIGluIGFkdmVydGlzaW5nIG9yIHB1YmxpY2l0eQojIHBlcnRhaW5pbmcgdG8gZGlzdHJpYnV0aW9uIG9mIHRoZSBzb2Z0d2FyZSB3aXRob3V0IHNwZWNpZmljLCB3cml0dGVuCiMgcHJpb3IgcGVybWlzc2lvbi4KIwojIFRpbW90aHkgTydNYWxsZXkgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEggUkVHQVJEIFRPIFRISVMKIyBTT0ZUV0FSRSwgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZCiMgQU5EIEZJVE5FU1MsIElOIE5PIEVWRU5UIFNIQUxMIFRpbW90aHkgTydNYWxsZXkgQkUgTElBQkxFIEZPUgojIEFOWSBTUEVDSUFMLCBJTkRJUkVDVCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMKIyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsCiMgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1IgT1RIRVIgVE9SVElPVVMKIyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SCiMgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4KIwojIyMjCiMKIyBJZDogQ29va2llLnB5LHYgMi4yOSAyMDAwLzA4LzIzIDA1OjI4OjQ5IHRpbW8gRXhwCiMgICBieSBUaW1vdGh5IE8nTWFsbGV5IDx0aW1vQGFsdW0ubWl0LmVkdT4KIwojICBDb29raWUucHkgaXMgYSBQeXRob24gbW9kdWxlIGZvciB0aGUgaGFuZGxpbmcgb2YgSFRUUAojICBjb29raWVzIGFzIGEgUHl0aG9uIGRpY3Rpb25hcnkuICBTZWUgUkZDIDIxMDkgZm9yIG1vcmUKIyAgaW5mb3JtYXRpb24gb24gY29va2llcy4KIwojICBUaGUgb3JpZ2luYWwgaWRlYSB0byB0cmVhdCBDb29raWVzIGFzIGEgZGljdGlvbmFyeSBjYW1lIGZyb20KIyAgRGF2ZSBNaXRjaGVsbCAoZGF2ZW1AbWFnbmV0LmNvbSkgaW4gMTk5NSwgd2hlbiBoZSByZWxlYXNlZCB0aGUKIyAgZmlyc3QgdmVyc2lvbiBvZiBuc2Nvb2tpZS5weS4KIwojIyMjCgpyIiIiCkhlcmUncyBhIHNhbXBsZSBzZXNzaW9uIHRvIHNob3cgaG93IHRvIHVzZSB0aGlzIG1vZHVsZS4KQXQgdGhlIG1vbWVudCwgdGhpcyBpcyB0aGUgb25seSBkb2N1bWVudGF0aW9uLgoKVGhlIEJhc2ljcwotLS0tLS0tLS0tCgpJbXBvcnRpbmcgaXMgZWFzeS4uLgoKICAgPj4+IGZyb20gaHR0cCBpbXBvcnQgY29va2llcwoKTW9zdCBvZiB0aGUgdGltZSB5b3Ugc3RhcnQgYnkgY3JlYXRpbmcgYSBjb29raWUuCgogICA+Pj4gQyA9IGNvb2tpZXMuU2ltcGxlQ29va2llKCkKCk9uY2UgeW91J3ZlIGNyZWF0ZWQgeW91ciBDb29raWUsIHlvdSBjYW4gYWRkIHZhbHVlcyBqdXN0IGFzIGlmIGl0IHdlcmUKYSBkaWN0aW9uYXJ5LgoKICAgPj4+IEMgPSBjb29raWVzLlNpbXBsZUNvb2tpZSgpCiAgID4+PiBDWyJmaWciXSA9ICJuZXd0b24iCiAgID4+PiBDWyJzdWdhciJdID0gIndhZmVyIgogICA+Pj4gQy5vdXRwdXQoKQogICAnU2V0LUNvb2tpZTogZmlnPW5ld3RvblxyXG5TZXQtQ29va2llOiBzdWdhcj13YWZlcicKCk5vdGljZSB0aGF0IHRoZSBwcmludGFibGUgcmVwcmVzZW50YXRpb24gb2YgYSBDb29raWUgaXMgdGhlCmFwcHJvcHJpYXRlIGZvcm1hdCBmb3IgYSBTZXQtQ29va2llOiBoZWFkZXIuICBUaGlzIGlzIHRoZQpkZWZhdWx0IGJlaGF2aW9yLiAgWW91IGNhbiBjaGFuZ2UgdGhlIGhlYWRlciBhbmQgcHJpbnRlZAphdHRyaWJ1dGVzIGJ5IHVzaW5nIHRoZSAub3V0cHV0KCkgZnVuY3Rpb24KCiAgID4+PiBDID0gY29va2llcy5TaW1wbGVDb29raWUoKQogICA+Pj4gQ1sicm9ja3kiXSA9ICJyb2FkIgogICA+Pj4gQ1sicm9ja3kiXVsicGF0aCJdID0gIi9jb29raWUiCiAgID4+PiBwcmludChDLm91dHB1dChoZWFkZXI9IkNvb2tpZToiKSkKICAgQ29va2llOiByb2NreT1yb2FkOyBQYXRoPS9jb29raWUKICAgPj4+IHByaW50KEMub3V0cHV0KGF0dHJzPVtdLCBoZWFkZXI9IkNvb2tpZToiKSkKICAgQ29va2llOiByb2NreT1yb2FkCgpUaGUgbG9hZCgpIG1ldGhvZCBvZiBhIENvb2tpZSBleHRyYWN0cyBjb29raWVzIGZyb20gYSBzdHJpbmcuICBJbiBhCkNHSSBzY3JpcHQsIHlvdSB3b3VsZCB1c2UgdGhpcyBtZXRob2QgdG8gZXh0cmFjdCB0aGUgY29va2llcyBmcm9tIHRoZQpIVFRQX0NPT0tJRSBlbnZpcm9ubWVudCB2YXJpYWJsZS4KCiAgID4+PiBDID0gY29va2llcy5TaW1wbGVDb29raWUoKQogICA+Pj4gQy5sb2FkKCJjaGlwcz1haG95OyB2aWVubmE9ZmluZ2VyIikKICAgPj4+IEMub3V0cHV0KCkKICAgJ1NldC1Db29raWU6IGNoaXBzPWFob3lcclxuU2V0LUNvb2tpZTogdmllbm5hPWZpbmdlcicKClRoZSBsb2FkKCkgbWV0aG9kIGlzIGRhcm4tdG9vdGluIHNtYXJ0IGFib3V0IGlkZW50aWZ5aW5nIGNvb2tpZXMKd2l0aGluIGEgc3RyaW5nLiAgRXNjYXBlZCBxdW90YXRpb24gbWFya3MsIG5lc3RlZCBzZW1pY29sb25zLCBhbmQgb3RoZXIKc3VjaCB0cmlja2VyaWVzIGRvIG5vdCBjb25mdXNlIGl0LgoKICAgPj4+IEMgPSBjb29raWVzLlNpbXBsZUNvb2tpZSgpCiAgID4+PiBDLmxvYWQoJ2tlZWJsZXI9IkU9ZXZlcnlib2R5OyBMPVxcIkxvdmVzXFwiOyBmdWRnZT1cXDAxMjsiOycpCiAgID4+PiBwcmludChDKQogICBTZXQtQ29va2llOiBrZWVibGVyPSJFPWV2ZXJ5Ym9keTsgTD1cIkxvdmVzXCI7IGZ1ZGdlPVwwMTI7IgoKRWFjaCBlbGVtZW50IG9mIHRoZSBDb29raWUgYWxzbyBzdXBwb3J0cyBhbGwgb2YgdGhlIFJGQyAyMTA5CkNvb2tpZSBhdHRyaWJ1dGVzLiAgSGVyZSdzIGFuIGV4YW1wbGUgd2hpY2ggc2V0cyB0aGUgUGF0aAphdHRyaWJ1dGUuCgogICA+Pj4gQyA9IGNvb2tpZXMuU2ltcGxlQ29va2llKCkKICAgPj4+IENbIm9yZW8iXSA9ICJkb3VibGVzdHVmZiIKICAgPj4+IENbIm9yZW8iXVsicGF0aCJdID0gIi8iCiAgID4+PiBwcmludChDKQogICBTZXQtQ29va2llOiBvcmVvPWRvdWJsZXN0dWZmOyBQYXRoPS8KCkVhY2ggZGljdGlvbmFyeSBlbGVtZW50IGhhcyBhICd2YWx1ZScgYXR0cmlidXRlLCB3aGljaCBnaXZlcyB5b3UKYmFjayB0aGUgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIHRoZSBrZXkuCgogICA+Pj4gQyA9IGNvb2tpZXMuU2ltcGxlQ29va2llKCkKICAgPj4+IENbInR3aXgiXSA9ICJub25lIGZvciB5b3UiCiAgID4+PiBDWyJ0d2l4Il0udmFsdWUKICAgJ25vbmUgZm9yIHlvdScKClRoZSBTaW1wbGVDb29raWUgZXhwZWN0cyB0aGF0IGFsbCB2YWx1ZXMgc2hvdWxkIGJlIHN0YW5kYXJkIHN0cmluZ3MuCkp1c3QgdG8gYmUgc3VyZSwgU2ltcGxlQ29va2llIGludm9rZXMgdGhlIHN0cigpIGJ1aWx0aW4gdG8gY29udmVydAp0aGUgdmFsdWUgdG8gYSBzdHJpbmcsIHdoZW4gdGhlIHZhbHVlcyBhcmUgc2V0IGRpY3Rpb25hcnktc3R5bGUuCgogICA+Pj4gQyA9IGNvb2tpZXMuU2ltcGxlQ29va2llKCkKICAgPj4+IENbIm51bWJlciJdID0gNwogICA+Pj4gQ1sic3RyaW5nIl0gPSAic2V2ZW4iCiAgID4+PiBDWyJudW1iZXIiXS52YWx1ZQogICAnNycKICAgPj4+IENbInN0cmluZyJdLnZhbHVlCiAgICdzZXZlbicKICAgPj4+IEMub3V0cHV0KCkKICAgJ1NldC1Db29raWU6IG51bWJlcj03XHJcblNldC1Db29raWU6IHN0cmluZz1zZXZlbicKCkZpbmlzLgoiIiIKCiMKIyBJbXBvcnQgb3VyIHJlcXVpcmVkIG1vZHVsZXMKIwppbXBvcnQgcmUKaW1wb3J0IHN0cmluZwoKX19hbGxfXyA9IFsiQ29va2llRXJyb3IiLCAiQmFzZUNvb2tpZSIsICJTaW1wbGVDb29raWUiXQoKX251bGxqb2luID0gJycuam9pbgpfc2VtaXNwYWNlam9pbiA9ICc7ICcuam9pbgpfc3BhY2Vqb2luID0gJyAnLmpvaW4KCiMKIyBEZWZpbmUgYW4gZXhjZXB0aW9uIHZpc2libGUgdG8gRXh0ZXJuYWwgbW9kdWxlcwojCmNsYXNzIENvb2tpZUVycm9yKEV4Y2VwdGlvbik6CiAgICBwYXNzCgoKIyBUaGVzZSBxdW90aW5nIHJvdXRpbmVzIGNvbmZvcm0gdG8gdGhlIFJGQzIxMDkgc3BlY2lmaWNhdGlvbiwgd2hpY2ggaW4KIyB0dXJuIHJlZmVyZW5jZXMgdGhlIGNoYXJhY3RlciBkZWZpbml0aW9ucyBmcm9tIFJGQzIwNjguICBUaGV5IHByb3ZpZGUKIyBhIHR3by13YXkgcXVvdGluZyBhbGdvcml0aG0uICBBbnkgbm9uLXRleHQgY2hhcmFjdGVyIGlzIHRyYW5zbGF0ZWQKIyBpbnRvIGEgNCBjaGFyYWN0ZXIgc2VxdWVuY2U6IGEgZm9yd2FyZC1zbGFzaCBmb2xsb3dlZCBieSB0aGUKIyB0aHJlZS1kaWdpdCBvY3RhbCBlcXVpdmFsZW50IG9mIHRoZSBjaGFyYWN0ZXIuICBBbnkgJ1wnIG9yICciJyBpcwojIHF1b3RlZCB3aXRoIGEgcHJlY2VlZGluZyAnXCcgc2xhc2guCiMKIyBUaGVzZSBhcmUgdGFrZW4gZnJvbSBSRkMyMDY4IGFuZCBSRkMyMTA5LgojICAgICAgIF9MZWdhbENoYXJzICAgICAgIGlzIHRoZSBsaXN0IG9mIGNoYXJzIHdoaWNoIGRvbid0IHJlcXVpcmUgIidzCiMgICAgICAgX1RyYW5zbGF0b3IgICAgICAgaGFzaC10YWJsZSBmb3IgZmFzdCBxdW90aW5nCiMKX0xlZ2FsQ2hhcnMgICAgICAgPSBzdHJpbmcuYXNjaWlfbGV0dGVycyArIHN0cmluZy5kaWdpdHMgKyAiISMkJSYnKistLl5fYHx+OiIKX1RyYW5zbGF0b3IgICAgICAgPSB7CiAgICAnXDAwMCcgOiAnXFwwMDAnLCAgJ1wwMDEnIDogJ1xcMDAxJywgICdcMDAyJyA6ICdcXDAwMicsCiAgICAnXDAwMycgOiAnXFwwMDMnLCAgJ1wwMDQnIDogJ1xcMDA0JywgICdcMDA1JyA6ICdcXDAwNScsCiAgICAnXDAwNicgOiAnXFwwMDYnLCAgJ1wwMDcnIDogJ1xcMDA3JywgICdcMDEwJyA6ICdcXDAxMCcsCiAgICAnXDAxMScgOiAnXFwwMTEnLCAgJ1wwMTInIDogJ1xcMDEyJywgICdcMDEzJyA6ICdcXDAxMycsCiAgICAnXDAxNCcgOiAnXFwwMTQnLCAgJ1wwMTUnIDogJ1xcMDE1JywgICdcMDE2JyA6ICdcXDAxNicsCiAgICAnXDAxNycgOiAnXFwwMTcnLCAgJ1wwMjAnIDogJ1xcMDIwJywgICdcMDIxJyA6ICdcXDAyMScsCiAgICAnXDAyMicgOiAnXFwwMjInLCAgJ1wwMjMnIDogJ1xcMDIzJywgICdcMDI0JyA6ICdcXDAyNCcsCiAgICAnXDAyNScgOiAnXFwwMjUnLCAgJ1wwMjYnIDogJ1xcMDI2JywgICdcMDI3JyA6ICdcXDAyNycsCiAgICAnXDAzMCcgOiAnXFwwMzAnLCAgJ1wwMzEnIDogJ1xcMDMxJywgICdcMDMyJyA6ICdcXDAzMicsCiAgICAnXDAzMycgOiAnXFwwMzMnLCAgJ1wwMzQnIDogJ1xcMDM0JywgICdcMDM1JyA6ICdcXDAzNScsCiAgICAnXDAzNicgOiAnXFwwMzYnLCAgJ1wwMzcnIDogJ1xcMDM3JywKCiAgICAjIEJlY2F1c2Ugb2YgdGhlIHdheSBicm93c2VycyByZWFsbHkgaGFuZGxlIGNvb2tpZXMgKGFzIG9wcG9zZWQKICAgICMgdG8gd2hhdCB0aGUgUkZDIHNheXMpIHdlIGFsc28gZW5jb2RlICwgYW5kIDsKCiAgICAnLCcgOiAnXFwwNTQnLCAnOycgOiAnXFwwNzMnLAoKICAgICciJyA6ICdcXCInLCAgICAgICAnXFwnIDogJ1xcXFwnLAoKICAgICdcMTc3JyA6ICdcXDE3NycsICAnXDIwMCcgOiAnXFwyMDAnLCAgJ1wyMDEnIDogJ1xcMjAxJywKICAgICdcMjAyJyA6ICdcXDIwMicsICAnXDIwMycgOiAnXFwyMDMnLCAgJ1wyMDQnIDogJ1xcMjA0JywKICAgICdcMjA1JyA6ICdcXDIwNScsICAnXDIwNicgOiAnXFwyMDYnLCAgJ1wyMDcnIDogJ1xcMjA3JywKICAgICdcMjEwJyA6ICdcXDIxMCcsICAnXDIxMScgOiAnXFwyMTEnLCAgJ1wyMTInIDogJ1xcMjEyJywKICAgICdcMjEzJyA6ICdcXDIxMycsICAnXDIxNCcgOiAnXFwyMTQnLCAgJ1wyMTUnIDogJ1xcMjE1JywKICAgICdcMjE2JyA6ICdcXDIxNicsICAnXDIxNycgOiAnXFwyMTcnLCAgJ1wyMjAnIDogJ1xcMjIwJywKICAgICdcMjIxJyA6ICdcXDIyMScsICAnXDIyMicgOiAnXFwyMjInLCAgJ1wyMjMnIDogJ1xcMjIzJywKICAgICdcMjI0JyA6ICdcXDIyNCcsICAnXDIyNScgOiAnXFwyMjUnLCAgJ1wyMjYnIDogJ1xcMjI2JywKICAgICdcMjI3JyA6ICdcXDIyNycsICAnXDIzMCcgOiAnXFwyMzAnLCAgJ1wyMzEnIDogJ1xcMjMxJywKICAgICdcMjMyJyA6ICdcXDIzMicsICAnXDIzMycgOiAnXFwyMzMnLCAgJ1wyMzQnIDogJ1xcMjM0JywKICAgICdcMjM1JyA6ICdcXDIzNScsICAnXDIzNicgOiAnXFwyMzYnLCAgJ1wyMzcnIDogJ1xcMjM3JywKICAgICdcMjQwJyA6ICdcXDI0MCcsICAnXDI0MScgOiAnXFwyNDEnLCAgJ1wyNDInIDogJ1xcMjQyJywKICAgICdcMjQzJyA6ICdcXDI0MycsICAnXDI0NCcgOiAnXFwyNDQnLCAgJ1wyNDUnIDogJ1xcMjQ1JywKICAgICdcMjQ2JyA6ICdcXDI0NicsICAnXDI0NycgOiAnXFwyNDcnLCAgJ1wyNTAnIDogJ1xcMjUwJywKICAgICdcMjUxJyA6ICdcXDI1MScsICAnXDI1MicgOiAnXFwyNTInLCAgJ1wyNTMnIDogJ1xcMjUzJywKICAgICdcMjU0JyA6ICdcXDI1NCcsICAnXDI1NScgOiAnXFwyNTUnLCAgJ1wyNTYnIDogJ1xcMjU2JywKICAgICdcMjU3JyA6ICdcXDI1NycsICAnXDI2MCcgOiAnXFwyNjAnLCAgJ1wyNjEnIDogJ1xcMjYxJywKICAgICdcMjYyJyA6ICdcXDI2MicsICAnXDI2MycgOiAnXFwyNjMnLCAgJ1wyNjQnIDogJ1xcMjY0JywKICAgICdcMjY1JyA6ICdcXDI2NScsICAnXDI2NicgOiAnXFwyNjYnLCAgJ1wyNjcnIDogJ1xcMjY3JywKICAgICdcMjcwJyA6ICdcXDI3MCcsICAnXDI3MScgOiAnXFwyNzEnLCAgJ1wyNzInIDogJ1xcMjcyJywKICAgICdcMjczJyA6ICdcXDI3MycsICAnXDI3NCcgOiAnXFwyNzQnLCAgJ1wyNzUnIDogJ1xcMjc1JywKICAgICdcMjc2JyA6ICdcXDI3NicsICAnXDI3NycgOiAnXFwyNzcnLCAgJ1wzMDAnIDogJ1xcMzAwJywKICAgICdcMzAxJyA6ICdcXDMwMScsICAnXDMwMicgOiAnXFwzMDInLCAgJ1wzMDMnIDogJ1xcMzAzJywKICAgICdcMzA0JyA6ICdcXDMwNCcsICAnXDMwNScgOiAnXFwzMDUnLCAgJ1wzMDYnIDogJ1xcMzA2JywKICAgICdcMzA3JyA6ICdcXDMwNycsICAnXDMxMCcgOiAnXFwzMTAnLCAgJ1wzMTEnIDogJ1xcMzExJywKICAgICdcMzEyJyA6ICdcXDMxMicsICAnXDMxMycgOiAnXFwzMTMnLCAgJ1wzMTQnIDogJ1xcMzE0JywKICAgICdcMzE1JyA6ICdcXDMxNScsICAnXDMxNicgOiAnXFwzMTYnLCAgJ1wzMTcnIDogJ1xcMzE3JywKICAgICdcMzIwJyA6ICdcXDMyMCcsICAnXDMyMScgOiAnXFwzMjEnLCAgJ1wzMjInIDogJ1xcMzIyJywKICAgICdcMzIzJyA6ICdcXDMyMycsICAnXDMyNCcgOiAnXFwzMjQnLCAgJ1wzMjUnIDogJ1xcMzI1JywKICAgICdcMzI2JyA6ICdcXDMyNicsICAnXDMyNycgOiAnXFwzMjcnLCAgJ1wzMzAnIDogJ1xcMzMwJywKICAgICdcMzMxJyA6ICdcXDMzMScsICAnXDMzMicgOiAnXFwzMzInLCAgJ1wzMzMnIDogJ1xcMzMzJywKICAgICdcMzM0JyA6ICdcXDMzNCcsICAnXDMzNScgOiAnXFwzMzUnLCAgJ1wzMzYnIDogJ1xcMzM2JywKICAgICdcMzM3JyA6ICdcXDMzNycsICAnXDM0MCcgOiAnXFwzNDAnLCAgJ1wzNDEnIDogJ1xcMzQxJywKICAgICdcMzQyJyA6ICdcXDM0MicsICAnXDM0MycgOiAnXFwzNDMnLCAgJ1wzNDQnIDogJ1xcMzQ0JywKICAgICdcMzQ1JyA6ICdcXDM0NScsICAnXDM0NicgOiAnXFwzNDYnLCAgJ1wzNDcnIDogJ1xcMzQ3JywKICAgICdcMzUwJyA6ICdcXDM1MCcsICAnXDM1MScgOiAnXFwzNTEnLCAgJ1wzNTInIDogJ1xcMzUyJywKICAgICdcMzUzJyA6ICdcXDM1MycsICAnXDM1NCcgOiAnXFwzNTQnLCAgJ1wzNTUnIDogJ1xcMzU1JywKICAgICdcMzU2JyA6ICdcXDM1NicsICAnXDM1NycgOiAnXFwzNTcnLCAgJ1wzNjAnIDogJ1xcMzYwJywKICAgICdcMzYxJyA6ICdcXDM2MScsICAnXDM2MicgOiAnXFwzNjInLCAgJ1wzNjMnIDogJ1xcMzYzJywKICAgICdcMzY0JyA6ICdcXDM2NCcsICAnXDM2NScgOiAnXFwzNjUnLCAgJ1wzNjYnIDogJ1xcMzY2JywKICAgICdcMzY3JyA6ICdcXDM2NycsICAnXDM3MCcgOiAnXFwzNzAnLCAgJ1wzNzEnIDogJ1xcMzcxJywKICAgICdcMzcyJyA6ICdcXDM3MicsICAnXDM3MycgOiAnXFwzNzMnLCAgJ1wzNzQnIDogJ1xcMzc0JywKICAgICdcMzc1JyA6ICdcXDM3NScsICAnXDM3NicgOiAnXFwzNzYnLCAgJ1wzNzcnIDogJ1xcMzc3JwogICAgfQoKZGVmIF9xdW90ZShzdHIsIExlZ2FsQ2hhcnM9X0xlZ2FsQ2hhcnMpOgogICAgciIiIlF1b3RlIGEgc3RyaW5nIGZvciB1c2UgaW4gYSBjb29raWUgaGVhZGVyLgoKICAgIElmIHRoZSBzdHJpbmcgZG9lcyBub3QgbmVlZCB0byBiZSBkb3VibGUtcXVvdGVkLCB0aGVuIGp1c3QgcmV0dXJuIHRoZQogICAgc3RyaW5nLiAgT3RoZXJ3aXNlLCBzdXJyb3VuZCB0aGUgc3RyaW5nIGluIGRvdWJsZXF1b3RlcyBhbmQgcXVvdGUKICAgICh3aXRoIGEgXCkgc3BlY2lhbCBjaGFyYWN0ZXJzLgogICAgIiIiCiAgICBpZiBhbGwoYyBpbiBMZWdhbENoYXJzIGZvciBjIGluIHN0cik6CiAgICAgICAgcmV0dXJuIHN0cgogICAgZWxzZToKICAgICAgICByZXR1cm4gJyInICsgX251bGxqb2luKF9UcmFuc2xhdG9yLmdldChzLCBzKSBmb3IgcyBpbiBzdHIpICsgJyInCgoKX09jdGFsUGF0dCA9IHJlLmNvbXBpbGUociJcXFswLTNdWzAtN11bMC03XSIpCl9RdW90ZVBhdHQgPSByZS5jb21waWxlKHIiW1xcXS4iKQoKZGVmIF91bnF1b3RlKHN0cik6CiAgICAjIElmIHRoZXJlIGFyZW4ndCBhbnkgZG91YmxlcXVvdGVzLAogICAgIyB0aGVuIHRoZXJlIGNhbid0IGJlIGFueSBzcGVjaWFsIGNoYXJhY3RlcnMuICBTZWUgUkZDIDIxMDkuCiAgICBpZiBsZW4oc3RyKSA8IDI6CiAgICAgICAgcmV0dXJuIHN0cgogICAgaWYgc3RyWzBdICE9ICciJyBvciBzdHJbLTFdICE9ICciJzoKICAgICAgICByZXR1cm4gc3RyCgogICAgIyBXZSBoYXZlIHRvIGFzc3VtZSB0aGF0IHdlIG11c3QgZGVjb2RlIHRoaXMgc3RyaW5nLgogICAgIyBEb3duIHRvIHdvcmsuCgogICAgIyBSZW1vdmUgdGhlICJzCiAgICBzdHIgPSBzdHJbMTotMV0KCiAgICAjIENoZWNrIGZvciBzcGVjaWFsIHNlcXVlbmNlcy4gIEV4YW1wbGVzOgogICAgIyAgICBcMDEyIC0tPiBcbgogICAgIyAgICBcIiAgIC0tPiAiCiAgICAjCiAgICBpID0gMAogICAgbiA9IGxlbihzdHIpCiAgICByZXMgPSBbXQogICAgd2hpbGUgMCA8PSBpIDwgbjoKICAgICAgICBvX21hdGNoID0gX09jdGFsUGF0dC5zZWFyY2goc3RyLCBpKQogICAgICAgIHFfbWF0Y2ggPSBfUXVvdGVQYXR0LnNlYXJjaChzdHIsIGkpCiAgICAgICAgaWYgbm90IG9fbWF0Y2ggYW5kIG5vdCBxX21hdGNoOiAgICAgICAgICAgICAgIyBOZWl0aGVyIG1hdGNoZWQKICAgICAgICAgICAgcmVzLmFwcGVuZChzdHJbaTpdKQogICAgICAgICAgICBicmVhawogICAgICAgICMgZWxzZToKICAgICAgICBqID0gayA9IC0xCiAgICAgICAgaWYgb19tYXRjaDoKICAgICAgICAgICAgaiA9IG9fbWF0Y2guc3RhcnQoMCkKICAgICAgICBpZiBxX21hdGNoOgogICAgICAgICAgICBrID0gcV9tYXRjaC5zdGFydCgwKQogICAgICAgIGlmIHFfbWF0Y2ggYW5kIChub3Qgb19tYXRjaCBvciBrIDwgaik6ICAgICAjIFF1b3RlUGF0dCBtYXRjaGVkCiAgICAgICAgICAgIHJlcy5hcHBlbmQoc3RyW2k6a10pCiAgICAgICAgICAgIHJlcy5hcHBlbmQoc3RyW2srMV0pCiAgICAgICAgICAgIGkgPSBrICsgMgogICAgICAgIGVsc2U6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIE9jdGFsUGF0dCBtYXRjaGVkCiAgICAgICAgICAgIHJlcy5hcHBlbmQoc3RyW2k6al0pCiAgICAgICAgICAgIHJlcy5hcHBlbmQoY2hyKGludChzdHJbaisxOmorNF0sIDgpKSkKICAgICAgICAgICAgaSA9IGogKyA0CiAgICByZXR1cm4gX251bGxqb2luKHJlcykKCiMgVGhlIF9nZXRkYXRlKCkgcm91dGluZSBpcyB1c2VkIHRvIHNldCB0aGUgZXhwaXJhdGlvbiB0aW1lIGluIHRoZSBjb29raWUncyBIVFRQCiMgaGVhZGVyLiAgQnkgZGVmYXVsdCwgX2dldGRhdGUoKSByZXR1cm5zIHRoZSBjdXJyZW50IHRpbWUgaW4gdGhlIGFwcHJvcHJpYXRlCiMgImV4cGlyZXMiIGZvcm1hdCBmb3IgYSBTZXQtQ29va2llIGhlYWRlci4gIFRoZSBvbmUgb3B0aW9uYWwgYXJndW1lbnQgaXMgYW4KIyBvZmZzZXQgZnJvbSBub3csIGluIHNlY29uZHMuICBGb3IgZXhhbXBsZSwgYW4gb2Zmc2V0IG9mIC0zNjAwIG1lYW5zICJvbmUgaG91cgojIGFnbyIuICBUaGUgb2Zmc2V0IG1heSBiZSBhIGZsb2F0aW5nIHBvaW50IG51bWJlci4KIwoKX3dlZWtkYXluYW1lID0gWydNb24nLCAnVHVlJywgJ1dlZCcsICdUaHUnLCAnRnJpJywgJ1NhdCcsICdTdW4nXQoKX21vbnRobmFtZSA9IFtOb25lLAogICAgICAgICAgICAgICdKYW4nLCAnRmViJywgJ01hcicsICdBcHInLCAnTWF5JywgJ0p1bicsCiAgICAgICAgICAgICAgJ0p1bCcsICdBdWcnLCAnU2VwJywgJ09jdCcsICdOb3YnLCAnRGVjJ10KCmRlZiBfZ2V0ZGF0ZShmdXR1cmU9MCwgd2Vla2RheW5hbWU9X3dlZWtkYXluYW1lLCBtb250aG5hbWU9X21vbnRobmFtZSk6CiAgICBmcm9tIHRpbWUgaW1wb3J0IGdtdGltZSwgdGltZQogICAgbm93ID0gdGltZSgpCiAgICB5ZWFyLCBtb250aCwgZGF5LCBoaCwgbW0sIHNzLCB3ZCwgeSwgeiA9IGdtdGltZShub3cgKyBmdXR1cmUpCiAgICByZXR1cm4gIiVzLCAlMDJkICUzcyAlNGQgJTAyZDolMDJkOiUwMmQgR01UIiAlIFwKICAgICAgICAgICAod2Vla2RheW5hbWVbd2RdLCBkYXksIG1vbnRobmFtZVttb250aF0sIHllYXIsIGhoLCBtbSwgc3MpCgoKY2xhc3MgTW9yc2VsKGRpY3QpOgogICAgIiIiQSBjbGFzcyB0byBob2xkIE9ORSAoa2V5LCB2YWx1ZSkgcGFpci4KCiAgICBJbiBhIGNvb2tpZSwgZWFjaCBzdWNoIHBhaXIgbWF5IGhhdmUgc2V2ZXJhbCBhdHRyaWJ1dGVzLCBzbyB0aGlzIGNsYXNzIGlzCiAgICB1c2VkIHRvIGtlZXAgdGhlIGF0dHJpYnV0ZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBhcHByb3ByaWF0ZSBrZXksdmFsdWUgcGFpci4KICAgIFRoaXMgY2xhc3MgYWxzbyBpbmNsdWRlcyBhIGNvZGVkX3ZhbHVlIGF0dHJpYnV0ZSwgd2hpY2ggaXMgdXNlZCB0byBob2xkCiAgICB0aGUgbmV0d29yayByZXByZXNlbnRhdGlvbiBvZiB0aGUgdmFsdWUuICBUaGlzIGlzIG1vc3QgdXNlZnVsIHdoZW4gUHl0aG9uCiAgICBvYmplY3RzIGFyZSBwaWNrbGVkIGZvciBuZXR3b3JrIHRyYW5zaXQuCiAgICAiIiIKICAgICMgUkZDIDIxMDkgbGlzdHMgdGhlc2UgYXR0cmlidXRlcyBhcyByZXNlcnZlZDoKICAgICMgICBwYXRoICAgICAgIGNvbW1lbnQgICAgICAgICBkb21haW4KICAgICMgICBtYXgtYWdlICAgIHNlY3VyZSAgICAgIHZlcnNpb24KICAgICMKICAgICMgRm9yIGhpc3RvcmljYWwgcmVhc29ucywgdGhlc2UgYXR0cmlidXRlcyBhcmUgYWxzbyByZXNlcnZlZDoKICAgICMgICBleHBpcmVzCiAgICAjCiAgICAjIFRoaXMgaXMgYW4gZXh0ZW5zaW9uIGZyb20gTWljcm9zb2Z0OgogICAgIyAgIGh0dHBvbmx5CiAgICAjCiAgICAjIFRoaXMgZGljdGlvbmFyeSBwcm92aWRlcyBhIG1hcHBpbmcgZnJvbSB0aGUgbG93ZXJjYXNlCiAgICAjIHZhcmlhbnQgb24gdGhlIGxlZnQgdG8gdGhlIGFwcHJvcHJpYXRlIHRyYWRpdGlvbmFsCiAgICAjIGZvcm1hdHRpbmcgb24gdGhlIHJpZ2h0LgogICAgX3Jlc2VydmVkID0gewogICAgICAgICJleHBpcmVzIiAgOiAiZXhwaXJlcyIsCiAgICAgICAgInBhdGgiICAgICA6ICJQYXRoIiwKICAgICAgICAiY29tbWVudCIgIDogIkNvbW1lbnQiLAogICAgICAgICJkb21haW4iICAgOiAiRG9tYWluIiwKICAgICAgICAibWF4LWFnZSIgIDogIk1heC1BZ2UiLAogICAgICAgICJzZWN1cmUiICAgOiAic2VjdXJlIiwKICAgICAgICAiaHR0cG9ubHkiIDogImh0dHBvbmx5IiwKICAgICAgICAidmVyc2lvbiIgIDogIlZlcnNpb24iLAogICAgfQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICAjIFNldCBkZWZhdWx0cwogICAgICAgIHNlbGYua2V5ID0gc2VsZi52YWx1ZSA9IHNlbGYuY29kZWRfdmFsdWUgPSBOb25lCgogICAgICAgICMgU2V0IGRlZmF1bHQgYXR0cmlidXRlcwogICAgICAgIGZvciBrZXkgaW4gc2VsZi5fcmVzZXJ2ZWQ6CiAgICAgICAgICAgIGRpY3QuX19zZXRpdGVtX18oc2VsZiwga2V5LCAiIikKCiAgICBkZWYgX19zZXRpdGVtX18oc2VsZiwgSywgVik6CiAgICAgICAgSyA9IEsubG93ZXIoKQogICAgICAgIGlmIG5vdCBLIGluIHNlbGYuX3Jlc2VydmVkOgogICAgICAgICAgICByYWlzZSBDb29raWVFcnJvcigiSW52YWxpZCBBdHRyaWJ1dGUgJXMiICUgSykKICAgICAgICBkaWN0Ll9fc2V0aXRlbV9fKHNlbGYsIEssIFYpCgogICAgZGVmIGlzUmVzZXJ2ZWRLZXkoc2VsZiwgSyk6CiAgICAgICAgcmV0dXJuIEsubG93ZXIoKSBpbiBzZWxmLl9yZXNlcnZlZAoKICAgIGRlZiBzZXQoc2VsZiwga2V5LCB2YWwsIGNvZGVkX3ZhbCwgTGVnYWxDaGFycz1fTGVnYWxDaGFycyk6CiAgICAgICAgIyBGaXJzdCB3ZSB2ZXJpZnkgdGhhdCB0aGUga2V5IGlzbid0IGEgcmVzZXJ2ZWQgd29yZAogICAgICAgICMgU2Vjb25kIHdlIG1ha2Ugc3VyZSBpdCBvbmx5IGNvbnRhaW5zIGxlZ2FsIGNoYXJhY3RlcnMKICAgICAgICBpZiBrZXkubG93ZXIoKSBpbiBzZWxmLl9yZXNlcnZlZDoKICAgICAgICAgICAgcmFpc2UgQ29va2llRXJyb3IoIkF0dGVtcHQgdG8gc2V0IGEgcmVzZXJ2ZWQga2V5OiAlcyIgJSBrZXkpCiAgICAgICAgaWYgYW55KGMgbm90IGluIExlZ2FsQ2hhcnMgZm9yIGMgaW4ga2V5KToKICAgICAgICAgICAgcmFpc2UgQ29va2llRXJyb3IoIklsbGVnYWwga2V5IHZhbHVlOiAlcyIgJSBrZXkpCgogICAgICAgICMgSXQncyBhIGdvb2Qga2V5LCBzbyBzYXZlIGl0LgogICAgICAgIHNlbGYua2V5ID0ga2V5CiAgICAgICAgc2VsZi52YWx1ZSA9IHZhbAogICAgICAgIHNlbGYuY29kZWRfdmFsdWUgPSBjb2RlZF92YWwKCiAgICBkZWYgb3V0cHV0KHNlbGYsIGF0dHJzPU5vbmUsIGhlYWRlcj0iU2V0LUNvb2tpZToiKToKICAgICAgICByZXR1cm4gIiVzICVzIiAlIChoZWFkZXIsIHNlbGYuT3V0cHV0U3RyaW5nKGF0dHJzKSkKCiAgICBfX3N0cl9fID0gb3V0cHV0CgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiAnPCVzOiAlcz0lcz4nICUgKHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYua2V5LCByZXByKHNlbGYudmFsdWUpKQoKICAgIGRlZiBqc19vdXRwdXQoc2VsZiwgYXR0cnM9Tm9uZSk6CiAgICAgICAgIyBQcmludCBqYXZhc2NyaXB0CiAgICAgICAgcmV0dXJuICIiIgogICAgICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KICAgICAgICA8IS0tIGJlZ2luIGhpZGluZwogICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IFwiJXNcIjsKICAgICAgICAvLyBlbmQgaGlkaW5nIC0tPgogICAgICAgIDwvc2NyaXB0PgogICAgICAgICIiIiAlIChzZWxmLk91dHB1dFN0cmluZyhhdHRycykucmVwbGFjZSgnIicsIHInXCInKSkKCiAgICBkZWYgT3V0cHV0U3RyaW5nKHNlbGYsIGF0dHJzPU5vbmUpOgogICAgICAgICMgQnVpbGQgdXAgb3VyIHJlc3VsdAogICAgICAgICMKICAgICAgICByZXN1bHQgPSBbXQogICAgICAgIGFwcGVuZCA9IHJlc3VsdC5hcHBlbmQKCiAgICAgICAgIyBGaXJzdCwgdGhlIGtleT12YWx1ZSBwYWlyCiAgICAgICAgYXBwZW5kKCIlcz0lcyIgJSAoc2VsZi5rZXksIHNlbGYuY29kZWRfdmFsdWUpKQoKICAgICAgICAjIE5vdyBhZGQgYW55IGRlZmluZWQgYXR0cmlidXRlcwogICAgICAgIGlmIGF0dHJzIGlzIE5vbmU6CiAgICAgICAgICAgIGF0dHJzID0gc2VsZi5fcmVzZXJ2ZWQKICAgICAgICBpdGVtcyA9IHNvcnRlZChzZWxmLml0ZW1zKCkpCiAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gaXRlbXM6CiAgICAgICAgICAgIGlmIHZhbHVlID09ICIiOgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgaWYga2V5IG5vdCBpbiBhdHRyczoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGlmIGtleSA9PSAiZXhwaXJlcyIgYW5kIGlzaW5zdGFuY2UodmFsdWUsIGludCk6CiAgICAgICAgICAgICAgICBhcHBlbmQoIiVzPSVzIiAlIChzZWxmLl9yZXNlcnZlZFtrZXldLCBfZ2V0ZGF0ZSh2YWx1ZSkpKQogICAgICAgICAgICBlbGlmIGtleSA9PSAibWF4LWFnZSIgYW5kIGlzaW5zdGFuY2UodmFsdWUsIGludCk6CiAgICAgICAgICAgICAgICBhcHBlbmQoIiVzPSVkIiAlIChzZWxmLl9yZXNlcnZlZFtrZXldLCB2YWx1ZSkpCiAgICAgICAgICAgIGVsaWYga2V5ID09ICJzZWN1cmUiOgogICAgICAgICAgICAgICAgYXBwZW5kKHN0cihzZWxmLl9yZXNlcnZlZFtrZXldKSkKICAgICAgICAgICAgZWxpZiBrZXkgPT0gImh0dHBvbmx5IjoKICAgICAgICAgICAgICAgIGFwcGVuZChzdHIoc2VsZi5fcmVzZXJ2ZWRba2V5XSkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBhcHBlbmQoIiVzPSVzIiAlIChzZWxmLl9yZXNlcnZlZFtrZXldLCB2YWx1ZSkpCgogICAgICAgICMgUmV0dXJuIHRoZSByZXN1bHQKICAgICAgICByZXR1cm4gX3NlbWlzcGFjZWpvaW4ocmVzdWx0KQoKCiMKIyBQYXR0ZXJuIGZvciBmaW5kaW5nIGNvb2tpZQojCiMgVGhpcyB1c2VkIHRvIGJlIHN0cmljdCBwYXJzaW5nIGJhc2VkIG9uIHRoZSBSRkMyMTA5IGFuZCBSRkMyMDY4CiMgc3BlY2lmaWNhdGlvbnMuICBJIGhhdmUgc2luY2UgZGlzY292ZXJlZCB0aGF0IE1TSUUgMy4weCBkb2Vzbid0CiMgZm9sbG93IHRoZSBjaGFyYWN0ZXIgcnVsZXMgb3V0bGluZWQgaW4gdGhvc2Ugc3BlY3MuICBBcyBhCiMgcmVzdWx0LCB0aGUgcGFyc2luZyBydWxlcyBoZXJlIGFyZSBsZXNzIHN0cmljdC4KIwoKX0xlZ2FsQ2hhcnNQYXR0ICA9IHIiW1x3XGQhIyUmJ35fYD48QCw6L1wkXCpcK1wtXC5cXlx8XClcKFw/XH1ce1w9XSIKX0Nvb2tpZVBhdHRlcm4gPSByZS5jb21waWxlKHIiIiIKICAgICg/eCkgICAgICAgICAgICAgICAgICAgICAgICAgICAjIFRoaXMgaXMgYSB2ZXJib3NlIHBhdHRlcm4KICAgICg/UDxrZXk+ICAgICAgICAgICAgICAgICAgICAgICAjIFN0YXJ0IG9mIGdyb3VwICdrZXknCiAgICAiIiIgKyBfTGVnYWxDaGFyc1BhdHQgKyByIiIiKz8gICAjIEFueSB3b3JkIG9mIGF0IGxlYXN0IG9uZSBsZXR0ZXIKICAgICkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIEVuZCBvZiBncm91cCAna2V5JwogICAgXHMqPVxzKiAgICAgICAgICAgICAgICAgICAgICAgICMgRXF1YWwgU2lnbgogICAgKD9QPHZhbD4gICAgICAgICAgICAgICAgICAgICAgICMgU3RhcnQgb2YgZ3JvdXAgJ3ZhbCcKICAgICIoPzpbXlxcIl18XFwuKSoiICAgICAgICAgICAgICAgICMgQW55IGRvdWJsZXF1b3RlZCBzdHJpbmcKICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgb3IKICAgIFx3ezN9LFxzW1x3XGRccy1dezksMTF9XHNbXGQ6XXs4fVxzR01UICAjIFNwZWNpYWwgY2FzZSBmb3IgImV4cGlyZXMiIGF0dHIKICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgb3IKICAgICIiIiArIF9MZWdhbENoYXJzUGF0dCArIHIiIiIqICAgICMgQW55IHdvcmQgb3IgZW1wdHkgc3RyaW5nCiAgICApICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBFbmQgb2YgZ3JvdXAgJ3ZhbCcKICAgIFxzKjs/ICAgICAgICAgICAgICAgICAgICAgICAgICAjIFByb2JhYmx5IGVuZGluZyBpbiBhIHNlbWktY29sb24KICAgICIiIiwgcmUuQVNDSUkpICAgICAgICAgICAgICAgICAjIE1heSBiZSByZW1vdmVkIGlmIHNhZmUuCgoKIyBBdCBsb25nIGxhc3QsIGhlcmUgaXMgdGhlIGNvb2tpZSBjbGFzcy4gIFVzaW5nIHRoaXMgY2xhc3MgaXMgYWxtb3N0IGp1c3QgbGlrZQojIHVzaW5nIGEgZGljdGlvbmFyeS4gIFNlZSB0aGlzIG1vZHVsZSdzIGRvY3N0cmluZyBmb3IgZXhhbXBsZSB1c2FnZS4KIwpjbGFzcyBCYXNlQ29va2llKGRpY3QpOgogICAgIiIiQSBjb250YWluZXIgY2xhc3MgZm9yIGEgc2V0IG9mIE1vcnNlbHMuIiIiCgogICAgZGVmIHZhbHVlX2RlY29kZShzZWxmLCB2YWwpOgogICAgICAgICIiInJlYWxfdmFsdWUsIGNvZGVkX3ZhbHVlID0gdmFsdWVfZGVjb2RlKFNUUklORykKICAgICAgICBDYWxsZWQgcHJpb3IgdG8gc2V0dGluZyBhIGNvb2tpZSdzIHZhbHVlIGZyb20gdGhlIG5ldHdvcmsKICAgICAgICByZXByZXNlbnRhdGlvbi4gIFRoZSBWQUxVRSBpcyB0aGUgdmFsdWUgcmVhZCBmcm9tIEhUVFAKICAgICAgICBoZWFkZXIuCiAgICAgICAgT3ZlcnJpZGUgdGhpcyBmdW5jdGlvbiB0byBtb2RpZnkgdGhlIGJlaGF2aW9yIG9mIGNvb2tpZXMuCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIHZhbCwgdmFsCgogICAgZGVmIHZhbHVlX2VuY29kZShzZWxmLCB2YWwpOgogICAgICAgICIiInJlYWxfdmFsdWUsIGNvZGVkX3ZhbHVlID0gdmFsdWVfZW5jb2RlKFZBTFVFKQogICAgICAgIENhbGxlZCBwcmlvciB0byBzZXR0aW5nIGEgY29va2llJ3MgdmFsdWUgZnJvbSB0aGUgZGljdGlvbmFyeQogICAgICAgIHJlcHJlc2VudGF0aW9uLiAgVGhlIFZBTFVFIGlzIHRoZSB2YWx1ZSBiZWluZyBhc3NpZ25lZC4KICAgICAgICBPdmVycmlkZSB0aGlzIGZ1bmN0aW9uIHRvIG1vZGlmeSB0aGUgYmVoYXZpb3Igb2YgY29va2llcy4KICAgICAgICAiIiIKICAgICAgICBzdHJ2YWwgPSBzdHIodmFsKQogICAgICAgIHJldHVybiBzdHJ2YWwsIHN0cnZhbAoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpbnB1dD1Ob25lKToKICAgICAgICBpZiBpbnB1dDoKICAgICAgICAgICAgc2VsZi5sb2FkKGlucHV0KQoKICAgIGRlZiBfX3NldChzZWxmLCBrZXksIHJlYWxfdmFsdWUsIGNvZGVkX3ZhbHVlKToKICAgICAgICAiIiJQcml2YXRlIG1ldGhvZCBmb3Igc2V0dGluZyBhIGNvb2tpZSdzIHZhbHVlIiIiCiAgICAgICAgTSA9IHNlbGYuZ2V0KGtleSwgTW9yc2VsKCkpCiAgICAgICAgTS5zZXQoa2V5LCByZWFsX3ZhbHVlLCBjb2RlZF92YWx1ZSkKICAgICAgICBkaWN0Ll9fc2V0aXRlbV9fKHNlbGYsIGtleSwgTSkKCiAgICBkZWYgX19zZXRpdGVtX18oc2VsZiwga2V5LCB2YWx1ZSk6CiAgICAgICAgIiIiRGljdGlvbmFyeSBzdHlsZSBhc3NpZ25tZW50LiIiIgogICAgICAgIHJ2YWwsIGN2YWwgPSBzZWxmLnZhbHVlX2VuY29kZSh2YWx1ZSkKICAgICAgICBzZWxmLl9fc2V0KGtleSwgcnZhbCwgY3ZhbCkKCiAgICBkZWYgb3V0cHV0KHNlbGYsIGF0dHJzPU5vbmUsIGhlYWRlcj0iU2V0LUNvb2tpZToiLCBzZXA9IlwwMTVcMDEyIik6CiAgICAgICAgIiIiUmV0dXJuIGEgc3RyaW5nIHN1aXRhYmxlIGZvciBIVFRQLiIiIgogICAgICAgIHJlc3VsdCA9IFtdCiAgICAgICAgaXRlbXMgPSBzb3J0ZWQoc2VsZi5pdGVtcygpKQogICAgICAgIGZvciBrZXksIHZhbHVlIGluIGl0ZW1zOgogICAgICAgICAgICByZXN1bHQuYXBwZW5kKHZhbHVlLm91dHB1dChhdHRycywgaGVhZGVyKSkKICAgICAgICByZXR1cm4gc2VwLmpvaW4ocmVzdWx0KQoKICAgIF9fc3RyX18gPSBvdXRwdXQKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgbCA9IFtdCiAgICAgICAgaXRlbXMgPSBzb3J0ZWQoc2VsZi5pdGVtcygpKQogICAgICAgIGZvciBrZXksIHZhbHVlIGluIGl0ZW1zOgogICAgICAgICAgICBsLmFwcGVuZCgnJXM9JXMnICUgKGtleSwgcmVwcih2YWx1ZS52YWx1ZSkpKQogICAgICAgIHJldHVybiAnPCVzOiAlcz4nICUgKHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLCBfc3BhY2Vqb2luKGwpKQoKICAgIGRlZiBqc19vdXRwdXQoc2VsZiwgYXR0cnM9Tm9uZSk6CiAgICAgICAgIiIiUmV0dXJuIGEgc3RyaW5nIHN1aXRhYmxlIGZvciBKYXZhU2NyaXB0LiIiIgogICAgICAgIHJlc3VsdCA9IFtdCiAgICAgICAgaXRlbXMgPSBzb3J0ZWQoc2VsZi5pdGVtcygpKQogICAgICAgIGZvciBrZXksIHZhbHVlIGluIGl0ZW1zOgogICAgICAgICAgICByZXN1bHQuYXBwZW5kKHZhbHVlLmpzX291dHB1dChhdHRycykpCiAgICAgICAgcmV0dXJuIF9udWxsam9pbihyZXN1bHQpCgogICAgZGVmIGxvYWQoc2VsZiwgcmF3ZGF0YSk6CiAgICAgICAgIiIiTG9hZCBjb29raWVzIGZyb20gYSBzdHJpbmcgKHByZXN1bWFibHkgSFRUUF9DT09LSUUpIG9yCiAgICAgICAgZnJvbSBhIGRpY3Rpb25hcnkuICBMb2FkaW5nIGNvb2tpZXMgZnJvbSBhIGRpY3Rpb25hcnkgJ2QnCiAgICAgICAgaXMgZXF1aXZhbGVudCB0byBjYWxsaW5nOgogICAgICAgICAgICBtYXAoQ29va2llLl9fc2V0aXRlbV9fLCBkLmtleXMoKSwgZC52YWx1ZXMoKSkKICAgICAgICAiIiIKICAgICAgICBpZiBpc2luc3RhbmNlKHJhd2RhdGEsIHN0cik6CiAgICAgICAgICAgIHNlbGYuX19wYXJzZV9zdHJpbmcocmF3ZGF0YSkKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIHNlbGYudXBkYXRlKCkgd291bGRuJ3QgY2FsbCBvdXIgY3VzdG9tIF9fc2V0aXRlbV9fCiAgICAgICAgICAgIGZvciBrZXksIHZhbHVlIGluIHJhd2RhdGEuaXRlbXMoKToKICAgICAgICAgICAgICAgIHNlbGZba2V5XSA9IHZhbHVlCiAgICAgICAgcmV0dXJuCgogICAgZGVmIF9fcGFyc2Vfc3RyaW5nKHNlbGYsIHN0ciwgcGF0dD1fQ29va2llUGF0dGVybik6CiAgICAgICAgaSA9IDAgICAgICAgICAgICAjIE91ciBzdGFydGluZyBwb2ludAogICAgICAgIG4gPSBsZW4oc3RyKSAgICAgIyBMZW5ndGggb2Ygc3RyaW5nCiAgICAgICAgTSA9IE5vbmUgICAgICAgICAjIGN1cnJlbnQgbW9yc2VsCgogICAgICAgIHdoaWxlIDAgPD0gaSA8IG46CiAgICAgICAgICAgICMgU3RhcnQgbG9va2luZyBmb3IgYSBjb29raWUKICAgICAgICAgICAgbWF0Y2ggPSBwYXR0LnNlYXJjaChzdHIsIGkpCiAgICAgICAgICAgIGlmIG5vdCBtYXRjaDoKICAgICAgICAgICAgICAgICMgTm8gbW9yZSBjb29raWVzCiAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICAgICAga2V5LCB2YWx1ZSA9IG1hdGNoLmdyb3VwKCJrZXkiKSwgbWF0Y2guZ3JvdXAoInZhbCIpCiAgICAgICAgICAgIGkgPSBtYXRjaC5lbmQoMCkKCiAgICAgICAgICAgICMgUGFyc2UgdGhlIGtleSwgdmFsdWUgaW4gY2FzZSBpdCdzIG1ldGFpbmZvCiAgICAgICAgICAgIGlmIGtleVswXSA9PSAiJCI6CiAgICAgICAgICAgICAgICAjIFdlIGlnbm9yZSBhdHRyaWJ1dGVzIHdoaWNoIHBlcnRhaW4gdG8gdGhlIGNvb2tpZQogICAgICAgICAgICAgICAgIyBtZWNoYW5pc20gYXMgYSB3aG9sZS4gIFNlZSBSRkMgMjEwOS4KICAgICAgICAgICAgICAgICMgKERvZXMgYW55b25lIGNhcmU/KQogICAgICAgICAgICAgICAgaWYgTToKICAgICAgICAgICAgICAgICAgICBNW2tleVsxOl1dID0gdmFsdWUKICAgICAgICAgICAgZWxpZiBrZXkubG93ZXIoKSBpbiBNb3JzZWwuX3Jlc2VydmVkOgogICAgICAgICAgICAgICAgaWYgTToKICAgICAgICAgICAgICAgICAgICBNW2tleV0gPSBfdW5xdW90ZSh2YWx1ZSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJ2YWwsIGN2YWwgPSBzZWxmLnZhbHVlX2RlY29kZSh2YWx1ZSkKICAgICAgICAgICAgICAgIHNlbGYuX19zZXQoa2V5LCBydmFsLCBjdmFsKQogICAgICAgICAgICAgICAgTSA9IHNlbGZba2V5XQoKCmNsYXNzIFNpbXBsZUNvb2tpZShCYXNlQ29va2llKToKICAgICIiIgogICAgU2ltcGxlQ29va2llIHN1cHBvcnRzIHN0cmluZ3MgYXMgY29va2llIHZhbHVlcy4gIFdoZW4gc2V0dGluZwogICAgdGhlIHZhbHVlIHVzaW5nIHRoZSBkaWN0aW9uYXJ5IGFzc2lnbm1lbnQgbm90YXRpb24sIFNpbXBsZUNvb2tpZQogICAgY2FsbHMgdGhlIGJ1aWx0aW4gc3RyKCkgdG8gY29udmVydCB0aGUgdmFsdWUgdG8gYSBzdHJpbmcuICBWYWx1ZXMKICAgIHJlY2VpdmVkIGZyb20gSFRUUCBhcmUga2VwdCBhcyBzdHJpbmdzLgogICAgIiIiCiAgICBkZWYgdmFsdWVfZGVjb2RlKHNlbGYsIHZhbCk6CiAgICAgICAgcmV0dXJuIF91bnF1b3RlKHZhbCksIHZhbAoKICAgIGRlZiB2YWx1ZV9lbmNvZGUoc2VsZiwgdmFsKToKICAgICAgICBzdHJ2YWwgPSBzdHIodmFsKQogICAgICAgIHJldHVybiBzdHJ2YWwsIF9xdW90ZShzdHJ2YWwpCg==',
'/Lib/http/_cookies.py':'Y2xhc3MgQ29va2llRXJyb3IoRXhjZXB0aW9uKToKICAgIHBhc3MKICAgIApjbGFzcyBCYXNlQ29va2llOgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLGRhdGE9Tm9uZSk6CiAgICAgICAgc2VsZi5tb3JzZWxzID0ge30KICAgICAgICBpZiBkYXRhIGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLmxvYWQoZGF0YSkKICAgIAogICAgZGVmIGxvYWQoc2VsZixkYXRhKToKICAgICAgICBlbHRzID0gZGF0YS5zcGxpdCgnOycpCiAgICAgICAgZm9yIGVsdCBpbiBlbHRzOgogICAgICAgICAgICBlbHQgPSBlbHQuc3RyaXAoKS5zcGxpdCgnPScsMSkKICAgICAgICAgICAgaWYgbGVuKGVsdCkhPTI6CiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdpbnZhbGlkIGNvb2tpZSAlcycgJWRhdGEpCiAgICAgICAgICAgIG1vcnNlbCx2YWx1ZSA9IGVsdAogICAgICAgICAgICBpZiBtb3JzZWwgaW4gc2VsZi5tb3JzZWxzOgogICAgICAgICAgICAgICAgc2VsZi5tb3JzZWxzW21vcnNlbF0uYXBwZW5kKHZhbHVlKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5tb3JzZWxzW21vcnNlbF0gPSBbdmFsdWVdCiAgICAK',
'/Lib/http/__init__.py':'',
'/Lib/lib_migration/unittest/case.py':'IiIiVGVzdCBjYXNlIGltcGxlbWVudGF0aW9uIiIiCgppbXBvcnQgc3lzCmltcG9ydCBmdW5jdG9vbHMKaW1wb3J0IGRpZmZsaWIKaW1wb3J0IHBwcmludAppbXBvcnQgcmUKaW1wb3J0IHdhcm5pbmdzCmltcG9ydCBjb2xsZWN0aW9ucwoKZnJvbSAuIGltcG9ydCByZXN1bHQKZnJvbSAudXRpbCBpbXBvcnQgKHN0cmNsYXNzLCBzYWZlX3JlcHIsIHNvcnRlZF9saXN0X2RpZmZlcmVuY2UsCiAgICAgICAgICAgICAgICAgICB1bm9yZGVyYWJsZV9saXN0X2RpZmZlcmVuY2UsIF9jb3VudF9kaWZmX2FsbF9wdXJwb3NlLAogICAgICAgICAgICAgICAgICAgX2NvdW50X2RpZmZfaGFzaGFibGUpCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKCkRJRkZfT01JVFRFRCA9ICgnXG5EaWZmIGlzICVzIGNoYXJhY3RlcnMgbG9uZy4gJwogICAgICAgICAgICAgICAgICdTZXQgc2VsZi5tYXhEaWZmIHRvIE5vbmUgdG8gc2VlIGl0LicpCgpjbGFzcyBTa2lwVGVzdChFeGNlcHRpb24pOgogICAgIiIiCiAgICBSYWlzZSB0aGlzIGV4Y2VwdGlvbiBpbiBhIHRlc3QgdG8gc2tpcCBpdC4KCiAgICBVc3VhbGx5IHlvdSBjYW4gdXNlIFRlc3RSZXN1bHQuc2tpcCgpIG9yIG9uZSBvZiB0aGUgc2tpcHBpbmcgZGVjb3JhdG9ycwogICAgaW5zdGVhZCBvZiByYWlzaW5nIHRoaXMgZGlyZWN0bHkuCiAgICAiIiIKCmNsYXNzIF9FeHBlY3RlZEZhaWx1cmUoRXhjZXB0aW9uKToKICAgICIiIgogICAgUmFpc2UgdGhpcyB3aGVuIGEgdGVzdCBpcyBleHBlY3RlZCB0byBmYWlsLgoKICAgIFRoaXMgaXMgYW4gaW1wbGVtZW50YXRpb24gZGV0YWlsLgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGV4Y19pbmZvKToKICAgICAgICBzdXBlcihfRXhwZWN0ZWRGYWlsdXJlLCBzZWxmKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5leGNfaW5mbyA9IGV4Y19pbmZvCgpjbGFzcyBfVW5leHBlY3RlZFN1Y2Nlc3MoRXhjZXB0aW9uKToKICAgICIiIgogICAgVGhlIHRlc3Qgd2FzIHN1cHBvc2VkIHRvIGZhaWwsIGJ1dCBpdCBkaWRuJ3QhCiAgICAiIiIKCgpjbGFzcyBfT3V0Y29tZShvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuc3VjY2VzcyA9IFRydWUKICAgICAgICBzZWxmLnNraXBwZWQgPSBOb25lCiAgICAgICAgc2VsZi51bmV4cGVjdGVkU3VjY2VzcyA9IE5vbmUKICAgICAgICBzZWxmLmV4cGVjdGVkRmFpbHVyZSA9IE5vbmUKICAgICAgICBzZWxmLmVycm9ycyA9IFtdCiAgICAgICAgc2VsZi5mYWlsdXJlcyA9IFtdCgoKZGVmIF9pZChvYmopOgogICAgcmV0dXJuIG9iagoKZGVmIHNraXAocmVhc29uKToKICAgICIiIgogICAgVW5jb25kaXRpb25hbGx5IHNraXAgYSB0ZXN0LgogICAgIiIiCiAgICBkZWYgZGVjb3JhdG9yKHRlc3RfaXRlbSk6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UodGVzdF9pdGVtLCB0eXBlKToKICAgICAgICAgICAgQGZ1bmN0b29scy53cmFwcyh0ZXN0X2l0ZW0pCiAgICAgICAgICAgIGRlZiBza2lwX3dyYXBwZXIoKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAgICAgICAgIHJhaXNlIFNraXBUZXN0KHJlYXNvbikKICAgICAgICAgICAgdGVzdF9pdGVtID0gc2tpcF93cmFwcGVyCgogICAgICAgIHRlc3RfaXRlbS5fX3VuaXR0ZXN0X3NraXBfXyA9IFRydWUKICAgICAgICB0ZXN0X2l0ZW0uX191bml0dGVzdF9za2lwX3doeV9fID0gcmVhc29uCiAgICAgICAgcmV0dXJuIHRlc3RfaXRlbQogICAgcmV0dXJuIGRlY29yYXRvcgoKZGVmIHNraXBJZihjb25kaXRpb24sIHJlYXNvbik6CiAgICAiIiIKICAgIFNraXAgYSB0ZXN0IGlmIHRoZSBjb25kaXRpb24gaXMgdHJ1ZS4KICAgICIiIgogICAgaWYgY29uZGl0aW9uOgogICAgICAgIHJldHVybiBza2lwKHJlYXNvbikKICAgIHJldHVybiBfaWQKCmRlZiBza2lwVW5sZXNzKGNvbmRpdGlvbiwgcmVhc29uKToKICAgICIiIgogICAgU2tpcCBhIHRlc3QgdW5sZXNzIHRoZSBjb25kaXRpb24gaXMgdHJ1ZS4KICAgICIiIgogICAgaWYgbm90IGNvbmRpdGlvbjoKICAgICAgICByZXR1cm4gc2tpcChyZWFzb24pCiAgICByZXR1cm4gX2lkCgoKZGVmIGV4cGVjdGVkRmFpbHVyZShmdW5jKToKICAgIEBmdW5jdG9vbHMud3JhcHMoZnVuYykKICAgIGRlZiB3cmFwcGVyKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBmdW5jKCphcmdzLCAqKmt3YXJncykKICAgICAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgICAgICByYWlzZSBfRXhwZWN0ZWRGYWlsdXJlKHN5cy5leGNfaW5mbygpKQogICAgICAgIHJhaXNlIF9VbmV4cGVjdGVkU3VjY2VzcwogICAgcmV0dXJuIHdyYXBwZXIKCgpjbGFzcyBfQXNzZXJ0UmFpc2VzQmFzZUNvbnRleHQob2JqZWN0KToKCiAgICBkZWYgX19pbml0X18oc2VsZiwgZXhwZWN0ZWQsIHRlc3RfY2FzZSwgY2FsbGFibGVfb2JqPU5vbmUsCiAgICAgICAgICAgICAgICAgIGV4cGVjdGVkX3JlZ2V4PU5vbmUpOgogICAgICAgIHNlbGYuZXhwZWN0ZWQgPSBleHBlY3RlZAogICAgICAgIHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiA9IHRlc3RfY2FzZS5mYWlsdXJlRXhjZXB0aW9uCiAgICAgICAgaWYgY2FsbGFibGVfb2JqIGlzIG5vdCBOb25lOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZWxmLm9ial9uYW1lID0gY2FsbGFibGVfb2JqLl9fbmFtZV9fCiAgICAgICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgICAgIHNlbGYub2JqX25hbWUgPSBzdHIoY2FsbGFibGVfb2JqKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYub2JqX25hbWUgPSBOb25lCiAgICAgICAgaWYgaXNpbnN0YW5jZShleHBlY3RlZF9yZWdleCwgKGJ5dGVzLCBzdHIpKToKICAgICAgICAgICAgZXhwZWN0ZWRfcmVnZXggPSByZS5jb21waWxlKGV4cGVjdGVkX3JlZ2V4KQogICAgICAgIHNlbGYuZXhwZWN0ZWRfcmVnZXggPSBleHBlY3RlZF9yZWdleAoKCmNsYXNzIF9Bc3NlcnRSYWlzZXNDb250ZXh0KF9Bc3NlcnRSYWlzZXNCYXNlQ29udGV4dCk6CiAgICAiIiJBIGNvbnRleHQgbWFuYWdlciB1c2VkIHRvIGltcGxlbWVudCBUZXN0Q2FzZS5hc3NlcnRSYWlzZXMqIG1ldGhvZHMuIiIiCgogICAgZGVmIF9fZW50ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX2V4aXRfXyhzZWxmLCBleGNfdHlwZSwgZXhjX3ZhbHVlLCB0Yik6CiAgICAgICAgaWYgZXhjX3R5cGUgaXMgTm9uZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZXhjX25hbWUgPSBzZWxmLmV4cGVjdGVkLl9fbmFtZV9fCiAgICAgICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgICAgIGV4Y19uYW1lID0gc3RyKHNlbGYuZXhwZWN0ZWQpCiAgICAgICAgICAgIGlmIHNlbGYub2JqX25hbWU6CiAgICAgICAgICAgICAgICByYWlzZSBzZWxmLmZhaWx1cmVFeGNlcHRpb24oInswfSBub3QgcmFpc2VkIGJ5IHsxfSIKICAgICAgICAgICAgICAgICAgICAuZm9ybWF0KGV4Y19uYW1lLCBzZWxmLm9ial9uYW1lKSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlIHNlbGYuZmFpbHVyZUV4Y2VwdGlvbigiezB9IG5vdCByYWlzZWQiCiAgICAgICAgICAgICAgICAgICAgLmZvcm1hdChleGNfbmFtZSkpCiAgICAgICAgaWYgbm90IGlzc3ViY2xhc3MoZXhjX3R5cGUsIHNlbGYuZXhwZWN0ZWQpOgogICAgICAgICAgICAjIGxldCB1bmV4cGVjdGVkIGV4Y2VwdGlvbnMgcGFzcyB0aHJvdWdoCiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICMgc3RvcmUgZXhjZXB0aW9uLCB3aXRob3V0IHRyYWNlYmFjaywgZm9yIGxhdGVyIHJldHJpZXZhbAogICAgICAgIHNlbGYuZXhjZXB0aW9uID0gZXhjX3ZhbHVlLndpdGhfdHJhY2ViYWNrKE5vbmUpCiAgICAgICAgaWYgc2VsZi5leHBlY3RlZF9yZWdleCBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gVHJ1ZQoKICAgICAgICBleHBlY3RlZF9yZWdleCA9IHNlbGYuZXhwZWN0ZWRfcmVnZXgKICAgICAgICBpZiBub3QgZXhwZWN0ZWRfcmVnZXguc2VhcmNoKHN0cihleGNfdmFsdWUpKToKICAgICAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKCciJXMiIGRvZXMgbm90IG1hdGNoICIlcyInICUKICAgICAgICAgICAgICAgICAgICAgKGV4cGVjdGVkX3JlZ2V4LnBhdHRlcm4sIHN0cihleGNfdmFsdWUpKSkKICAgICAgICByZXR1cm4gVHJ1ZQoKCmNsYXNzIF9Bc3NlcnRXYXJuc0NvbnRleHQoX0Fzc2VydFJhaXNlc0Jhc2VDb250ZXh0KToKICAgICIiIkEgY29udGV4dCBtYW5hZ2VyIHVzZWQgdG8gaW1wbGVtZW50IFRlc3RDYXNlLmFzc2VydFdhcm5zKiBtZXRob2RzLiIiIgoKICAgIGRlZiBfX2VudGVyX18oc2VsZik6CiAgICAgICAgIyBUaGUgX193YXJuaW5ncmVnaXN0cnlfXydzIG5lZWQgdG8gYmUgaW4gYSBwcmlzdGluZSBzdGF0ZSBmb3IgdGVzdHMKICAgICAgICAjIHRvIHdvcmsgcHJvcGVybHkuCiAgICAgICAgZm9yIHYgaW4gc3lzLm1vZHVsZXMudmFsdWVzKCk6CiAgICAgICAgICAgIGlmIGdldGF0dHIodiwgJ19fd2FybmluZ3JlZ2lzdHJ5X18nLCBOb25lKToKICAgICAgICAgICAgICAgIHYuX193YXJuaW5ncmVnaXN0cnlfXyA9IHt9CiAgICAgICAgc2VsZi53YXJuaW5nc19tYW5hZ2VyID0gd2FybmluZ3MuY2F0Y2hfd2FybmluZ3MocmVjb3JkPVRydWUpCiAgICAgICAgc2VsZi53YXJuaW5ncyA9IHNlbGYud2FybmluZ3NfbWFuYWdlci5fX2VudGVyX18oKQogICAgICAgIHdhcm5pbmdzLnNpbXBsZWZpbHRlcigiYWx3YXlzIiwgc2VsZi5leHBlY3RlZCkKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX2V4aXRfXyhzZWxmLCBleGNfdHlwZSwgZXhjX3ZhbHVlLCB0Yik6CiAgICAgICAgc2VsZi53YXJuaW5nc19tYW5hZ2VyLl9fZXhpdF9fKGV4Y190eXBlLCBleGNfdmFsdWUsIHRiKQogICAgICAgIGlmIGV4Y190eXBlIGlzIG5vdCBOb25lOgogICAgICAgICAgICAjIGxldCB1bmV4cGVjdGVkIGV4Y2VwdGlvbnMgcGFzcyB0aHJvdWdoCiAgICAgICAgICAgIHJldHVybgogICAgICAgIHRyeToKICAgICAgICAgICAgZXhjX25hbWUgPSBzZWxmLmV4cGVjdGVkLl9fbmFtZV9fCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICBleGNfbmFtZSA9IHN0cihzZWxmLmV4cGVjdGVkKQogICAgICAgIGZpcnN0X21hdGNoaW5nID0gTm9uZQogICAgICAgIGZvciBtIGluIHNlbGYud2FybmluZ3M6CiAgICAgICAgICAgIHcgPSBtLm1lc3NhZ2UKICAgICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uodywgc2VsZi5leHBlY3RlZCk6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBpZiBmaXJzdF9tYXRjaGluZyBpcyBOb25lOgogICAgICAgICAgICAgICAgZmlyc3RfbWF0Y2hpbmcgPSB3CiAgICAgICAgICAgIGlmIChzZWxmLmV4cGVjdGVkX3JlZ2V4IGlzIG5vdCBOb25lIGFuZAogICAgICAgICAgICAgICAgbm90IHNlbGYuZXhwZWN0ZWRfcmVnZXguc2VhcmNoKHN0cih3KSkpOgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgIyBzdG9yZSB3YXJuaW5nIGZvciBsYXRlciByZXRyaWV2YWwKICAgICAgICAgICAgc2VsZi53YXJuaW5nID0gdwogICAgICAgICAgICBzZWxmLmZpbGVuYW1lID0gbS5maWxlbmFtZQogICAgICAgICAgICBzZWxmLmxpbmVubyA9IG0ubGluZW5vCiAgICAgICAgICAgIHJldHVybgogICAgICAgICMgTm93IHdlIHNpbXBseSB0cnkgdG8gY2hvb3NlIGEgaGVscGZ1bCBmYWlsdXJlIG1lc3NhZ2UKICAgICAgICBpZiBmaXJzdF9tYXRjaGluZyBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKCciJXMiIGRvZXMgbm90IG1hdGNoICIlcyInICUKICAgICAgICAgICAgICAgICAgICAgKHNlbGYuZXhwZWN0ZWRfcmVnZXgucGF0dGVybiwgc3RyKGZpcnN0X21hdGNoaW5nKSkpCiAgICAgICAgaWYgc2VsZi5vYmpfbmFtZToKICAgICAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKCJ7MH0gbm90IHRyaWdnZXJlZCBieSB7MX0iCiAgICAgICAgICAgICAgICAuZm9ybWF0KGV4Y19uYW1lLCBzZWxmLm9ial9uYW1lKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBzZWxmLmZhaWx1cmVFeGNlcHRpb24oInswfSBub3QgdHJpZ2dlcmVkIgogICAgICAgICAgICAgICAgLmZvcm1hdChleGNfbmFtZSkpCgoKY2xhc3MgVGVzdENhc2Uob2JqZWN0KToKICAgICIiIkEgY2xhc3Mgd2hvc2UgaW5zdGFuY2VzIGFyZSBzaW5nbGUgdGVzdCBjYXNlcy4KCiAgICBCeSBkZWZhdWx0LCB0aGUgdGVzdCBjb2RlIGl0c2VsZiBzaG91bGQgYmUgcGxhY2VkIGluIGEgbWV0aG9kIG5hbWVkCiAgICAncnVuVGVzdCcuCgogICAgSWYgdGhlIGZpeHR1cmUgbWF5IGJlIHVzZWQgZm9yIG1hbnkgdGVzdCBjYXNlcywgY3JlYXRlIGFzCiAgICBtYW55IHRlc3QgbWV0aG9kcyBhcyBhcmUgbmVlZGVkLiBXaGVuIGluc3RhbnRpYXRpbmcgc3VjaCBhIFRlc3RDYXNlCiAgICBzdWJjbGFzcywgc3BlY2lmeSBpbiB0aGUgY29uc3RydWN0b3IgYXJndW1lbnRzIHRoZSBuYW1lIG9mIHRoZSB0ZXN0IG1ldGhvZAogICAgdGhhdCB0aGUgaW5zdGFuY2UgaXMgdG8gZXhlY3V0ZS4KCiAgICBUZXN0IGF1dGhvcnMgc2hvdWxkIHN1YmNsYXNzIFRlc3RDYXNlIGZvciB0aGVpciBvd24gdGVzdHMuIENvbnN0cnVjdGlvbgogICAgYW5kIGRlY29uc3RydWN0aW9uIG9mIHRoZSB0ZXN0J3MgZW52aXJvbm1lbnQgKCdmaXh0dXJlJykgY2FuIGJlCiAgICBpbXBsZW1lbnRlZCBieSBvdmVycmlkaW5nIHRoZSAnc2V0VXAnIGFuZCAndGVhckRvd24nIG1ldGhvZHMgcmVzcGVjdGl2ZWx5LgoKICAgIElmIGl0IGlzIG5lY2Vzc2FyeSB0byBvdmVycmlkZSB0aGUgX19pbml0X18gbWV0aG9kLCB0aGUgYmFzZSBjbGFzcwogICAgX19pbml0X18gbWV0aG9kIG11c3QgYWx3YXlzIGJlIGNhbGxlZC4gSXQgaXMgaW1wb3J0YW50IHRoYXQgc3ViY2xhc3NlcwogICAgc2hvdWxkIG5vdCBjaGFuZ2UgdGhlIHNpZ25hdHVyZSBvZiB0aGVpciBfX2luaXRfXyBtZXRob2QsIHNpbmNlIGluc3RhbmNlcwogICAgb2YgdGhlIGNsYXNzZXMgYXJlIGluc3RhbnRpYXRlZCBhdXRvbWF0aWNhbGx5IGJ5IHBhcnRzIG9mIHRoZSBmcmFtZXdvcmsKICAgIGluIG9yZGVyIHRvIGJlIHJ1bi4KICAgICIiIgoKICAgICMgVGhpcyBhdHRyaWJ1dGUgZGV0ZXJtaW5lcyB3aGljaCBleGNlcHRpb24gd2lsbCBiZSByYWlzZWQgd2hlbgogICAgIyB0aGUgaW5zdGFuY2UncyBhc3NlcnRpb24gbWV0aG9kcyBmYWlsOyB0ZXN0IG1ldGhvZHMgcmFpc2luZyB0aGlzCiAgICAjIGV4Y2VwdGlvbiB3aWxsIGJlIGRlZW1lZCB0byBoYXZlICdmYWlsZWQnIHJhdGhlciB0aGFuICdlcnJvcmVkJwoKICAgIGZhaWx1cmVFeGNlcHRpb24gPSBBc3NlcnRpb25FcnJvcgoKICAgICMgVGhpcyBhdHRyaWJ1dGUgZGV0ZXJtaW5lcyB3aGV0aGVyIGxvbmcgbWVzc2FnZXMgKGluY2x1ZGluZyByZXByIG9mCiAgICAjIG9iamVjdHMgdXNlZCBpbiBhc3NlcnQgbWV0aG9kcykgd2lsbCBiZSBwcmludGVkIG9uIGZhaWx1cmUgaW4gKmFkZGl0aW9uKgogICAgIyB0byBhbnkgZXhwbGljaXQgbWVzc2FnZSBwYXNzZWQuCgogICAgbG9uZ01lc3NhZ2UgPSBUcnVlCgogICAgIyBUaGlzIGF0dHJpYnV0ZSBzZXRzIHRoZSBtYXhpbXVtIGxlbmd0aCBvZiBhIGRpZmYgaW4gZmFpbHVyZSBtZXNzYWdlcwogICAgIyBieSBhc3NlcnQgbWV0aG9kcyB1c2luZyBkaWZmbGliLiBJdCBpcyBsb29rZWQgdXAgYXMgYW4gaW5zdGFuY2UgYXR0cmlidXRlCiAgICAjIHNvIGNhbiBiZSBjb25maWd1cmVkIGJ5IGluZGl2aWR1YWwgdGVzdHMgaWYgcmVxdWlyZWQuCgogICAgbWF4RGlmZiA9IDgwKjgKCiAgICAjIElmIGEgc3RyaW5nIGlzIGxvbmdlciB0aGFuIF9kaWZmVGhyZXNob2xkLCB1c2Ugbm9ybWFsIGNvbXBhcmlzb24gaW5zdGVhZAogICAgIyBvZiBkaWZmbGliLiAgU2VlICMxMTc2My4KICAgIF9kaWZmVGhyZXNob2xkID0gMioqMTYKCiAgICAjIEF0dHJpYnV0ZSB1c2VkIGJ5IFRlc3RTdWl0ZSBmb3IgY2xhc3NTZXRVcAoKICAgIF9jbGFzc1NldHVwRmFpbGVkID0gRmFsc2UKCiAgICBkZWYgX19pbml0X18oc2VsZiwgbWV0aG9kTmFtZT0ncnVuVGVzdCcpOgogICAgICAgICIiIkNyZWF0ZSBhbiBpbnN0YW5jZSBvZiB0aGUgY2xhc3MgdGhhdCB3aWxsIHVzZSB0aGUgbmFtZWQgdGVzdAogICAgICAgICAgIG1ldGhvZCB3aGVuIGV4ZWN1dGVkLiBSYWlzZXMgYSBWYWx1ZUVycm9yIGlmIHRoZSBpbnN0YW5jZSBkb2VzCiAgICAgICAgICAgbm90IGhhdmUgYSBtZXRob2Qgd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWUuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fdGVzdE1ldGhvZE5hbWUgPSBtZXRob2ROYW1lCiAgICAgICAgc2VsZi5fb3V0Y29tZUZvckRvQ2xlYW51cHMgPSBOb25lCiAgICAgICAgc2VsZi5fdGVzdE1ldGhvZERvYyA9ICdObyB0ZXN0JwogICAgICAgIHRyeToKICAgICAgICAgICAgdGVzdE1ldGhvZCA9IGdldGF0dHIoc2VsZiwgbWV0aG9kTmFtZSkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIGlmIG1ldGhvZE5hbWUgIT0gJ3J1blRlc3QnOgogICAgICAgICAgICAgICAgIyB3ZSBhbGxvdyBpbnN0YW50aWF0aW9uIHdpdGggbm8gZXhwbGljaXQgbWV0aG9kIG5hbWUKICAgICAgICAgICAgICAgICMgYnV0IG5vdCBhbiAqaW5jb3JyZWN0KiBvciBtaXNzaW5nIG1ldGhvZCBuYW1lCiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJubyBzdWNoIHRlc3QgbWV0aG9kIGluICVzOiAlcyIgJQogICAgICAgICAgICAgICAgICAgICAgKHNlbGYuX19jbGFzc19fLCBtZXRob2ROYW1lKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl90ZXN0TWV0aG9kRG9jID0gdGVzdE1ldGhvZC5fX2RvY19fCiAgICAgICAgc2VsZi5fY2xlYW51cHMgPSBbXQoKICAgICAgICAjIE1hcCB0eXBlcyB0byBjdXN0b20gYXNzZXJ0RXF1YWwgZnVuY3Rpb25zIHRoYXQgd2lsbCBjb21wYXJlCiAgICAgICAgIyBpbnN0YW5jZXMgb2Ygc2FpZCB0eXBlIGluIG1vcmUgZGV0YWlsIHRvIGdlbmVyYXRlIGEgbW9yZSB1c2VmdWwKICAgICAgICAjIGVycm9yIG1lc3NhZ2UuCiAgICAgICAgc2VsZi5fdHlwZV9lcXVhbGl0eV9mdW5jcyA9IHt9CiAgICAgICAgc2VsZi5hZGRUeXBlRXF1YWxpdHlGdW5jKGRpY3QsICdhc3NlcnREaWN0RXF1YWwnKQogICAgICAgIHNlbGYuYWRkVHlwZUVxdWFsaXR5RnVuYyhsaXN0LCAnYXNzZXJ0TGlzdEVxdWFsJykKICAgICAgICBzZWxmLmFkZFR5cGVFcXVhbGl0eUZ1bmModHVwbGUsICdhc3NlcnRUdXBsZUVxdWFsJykKICAgICAgICBzZWxmLmFkZFR5cGVFcXVhbGl0eUZ1bmMoc2V0LCAnYXNzZXJ0U2V0RXF1YWwnKQogICAgICAgIHNlbGYuYWRkVHlwZUVxdWFsaXR5RnVuYyhmcm96ZW5zZXQsICdhc3NlcnRTZXRFcXVhbCcpCiAgICAgICAgc2VsZi5hZGRUeXBlRXF1YWxpdHlGdW5jKHN0ciwgJ2Fzc2VydE11bHRpTGluZUVxdWFsJykKCiAgICBkZWYgYWRkVHlwZUVxdWFsaXR5RnVuYyhzZWxmLCB0eXBlb2JqLCBmdW5jdGlvbik6CiAgICAgICAgIiIiQWRkIGEgdHlwZSBzcGVjaWZpYyBhc3NlcnRFcXVhbCBzdHlsZSBmdW5jdGlvbiB0byBjb21wYXJlIGEgdHlwZS4KCiAgICAgICAgVGhpcyBtZXRob2QgaXMgZm9yIHVzZSBieSBUZXN0Q2FzZSBzdWJjbGFzc2VzIHRoYXQgbmVlZCB0byByZWdpc3RlcgogICAgICAgIHRoZWlyIG93biB0eXBlIGVxdWFsaXR5IGZ1bmN0aW9ucyB0byBwcm92aWRlIG5pY2VyIGVycm9yIG1lc3NhZ2VzLgoKICAgICAgICBBcmdzOgogICAgICAgICAgICB0eXBlb2JqOiBUaGUgZGF0YSB0eXBlIHRvIGNhbGwgdGhpcyBmdW5jdGlvbiBvbiB3aGVuIGJvdGggdmFsdWVzCiAgICAgICAgICAgICAgICAgICAgYXJlIG9mIHRoZSBzYW1lIHR5cGUgaW4gYXNzZXJ0RXF1YWwoKS4KICAgICAgICAgICAgZnVuY3Rpb246IFRoZSBjYWxsYWJsZSB0YWtpbmcgdHdvIGFyZ3VtZW50cyBhbmQgYW4gb3B0aW9uYWwKICAgICAgICAgICAgICAgICAgICBtc2c9IGFyZ3VtZW50IHRoYXQgcmFpc2VzIHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiB3aXRoIGEKICAgICAgICAgICAgICAgICAgICB1c2VmdWwgZXJyb3IgbWVzc2FnZSB3aGVuIHRoZSB0d28gYXJndW1lbnRzIGFyZSBub3QgZXF1YWwuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fdHlwZV9lcXVhbGl0eV9mdW5jc1t0eXBlb2JqXSA9IGZ1bmN0aW9uCgogICAgZGVmIGFkZENsZWFudXAoc2VsZiwgZnVuY3Rpb24sICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgIiIiQWRkIGEgZnVuY3Rpb24sIHdpdGggYXJndW1lbnRzLCB0byBiZSBjYWxsZWQgd2hlbiB0aGUgdGVzdCBpcwogICAgICAgIGNvbXBsZXRlZC4gRnVuY3Rpb25zIGFkZGVkIGFyZSBjYWxsZWQgb24gYSBMSUZPIGJhc2lzIGFuZCBhcmUKICAgICAgICBjYWxsZWQgYWZ0ZXIgdGVhckRvd24gb24gdGVzdCBmYWlsdXJlIG9yIHN1Y2Nlc3MuCgogICAgICAgIENsZWFudXAgaXRlbXMgYXJlIGNhbGxlZCBldmVuIGlmIHNldFVwIGZhaWxzICh1bmxpa2UgdGVhckRvd24pLiIiIgogICAgICAgIHNlbGYuX2NsZWFudXBzLmFwcGVuZCgoZnVuY3Rpb24sIGFyZ3MsIGt3YXJncykpCgogICAgZGVmIHNldFVwKHNlbGYpOgogICAgICAgICJIb29rIG1ldGhvZCBmb3Igc2V0dGluZyB1cCB0aGUgdGVzdCBmaXh0dXJlIGJlZm9yZSBleGVyY2lzaW5nIGl0LiIKICAgICAgICBwYXNzCgogICAgZGVmIHRlYXJEb3duKHNlbGYpOgogICAgICAgICJIb29rIG1ldGhvZCBmb3IgZGVjb25zdHJ1Y3RpbmcgdGhlIHRlc3QgZml4dHVyZSBhZnRlciB0ZXN0aW5nIGl0LiIKICAgICAgICBwYXNzCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgc2V0VXBDbGFzcyhjbHMpOgogICAgICAgICJIb29rIG1ldGhvZCBmb3Igc2V0dGluZyB1cCBjbGFzcyBmaXh0dXJlIGJlZm9yZSBydW5uaW5nIHRlc3RzIGluIHRoZSBjbGFzcy4iCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgdGVhckRvd25DbGFzcyhjbHMpOgogICAgICAgICJIb29rIG1ldGhvZCBmb3IgZGVjb25zdHJ1Y3RpbmcgdGhlIGNsYXNzIGZpeHR1cmUgYWZ0ZXIgcnVubmluZyBhbGwgdGVzdHMgaW4gdGhlIGNsYXNzLiIKCiAgICBkZWYgY291bnRUZXN0Q2FzZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIDEKCiAgICBkZWYgZGVmYXVsdFRlc3RSZXN1bHQoc2VsZik6CiAgICAgICAgcmV0dXJuIHJlc3VsdC5UZXN0UmVzdWx0KCkKCiAgICBkZWYgc2hvcnREZXNjcmlwdGlvbihzZWxmKToKICAgICAgICAiIiJSZXR1cm5zIGEgb25lLWxpbmUgZGVzY3JpcHRpb24gb2YgdGhlIHRlc3QsIG9yIE5vbmUgaWYgbm8KICAgICAgICBkZXNjcmlwdGlvbiBoYXMgYmVlbiBwcm92aWRlZC4KCiAgICAgICAgVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBtZXRob2QgcmV0dXJucyB0aGUgZmlyc3QgbGluZSBvZgogICAgICAgIHRoZSBzcGVjaWZpZWQgdGVzdCBtZXRob2QncyBkb2NzdHJpbmcuCiAgICAgICAgIiIiCiAgICAgICAgZG9jID0gc2VsZi5fdGVzdE1ldGhvZERvYwogICAgICAgIHJldHVybiBkb2MgYW5kIGRvYy5zcGxpdCgiXG4iKVswXS5zdHJpcCgpIG9yIE5vbmUKCgogICAgZGVmIGlkKHNlbGYpOgogICAgICAgIHJldHVybiAiJXMuJXMiICUgKHN0cmNsYXNzKHNlbGYuX19jbGFzc19fKSwgc2VsZi5fdGVzdE1ldGhvZE5hbWUpCgogICAgZGVmIF9fZXFfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgdHlwZShzZWxmKSBpcyBub3QgdHlwZShvdGhlcik6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgICAgICByZXR1cm4gc2VsZi5fdGVzdE1ldGhvZE5hbWUgPT0gb3RoZXIuX3Rlc3RNZXRob2ROYW1lCgogICAgZGVmIF9faGFzaF9fKHNlbGYpOgogICAgICAgIHJldHVybiBoYXNoKCh0eXBlKHNlbGYpLCBzZWxmLl90ZXN0TWV0aG9kTmFtZSkpCgogICAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgICAgcmV0dXJuICIlcyAoJXMpIiAlIChzZWxmLl90ZXN0TWV0aG9kTmFtZSwgc3RyY2xhc3Moc2VsZi5fX2NsYXNzX18pKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gIjwlcyB0ZXN0TWV0aG9kPSVzPiIgJSBcCiAgICAgICAgICAgICAgIChzdHJjbGFzcyhzZWxmLl9fY2xhc3NfXyksIHNlbGYuX3Rlc3RNZXRob2ROYW1lKQoKICAgIGRlZiBfYWRkU2tpcChzZWxmLCByZXN1bHQsIHJlYXNvbik6CiAgICAgICAgYWRkU2tpcCA9IGdldGF0dHIocmVzdWx0LCAnYWRkU2tpcCcsIE5vbmUpCiAgICAgICAgaWYgYWRkU2tpcCBpcyBub3QgTm9uZToKICAgICAgICAgICAgYWRkU2tpcChzZWxmLCByZWFzb24pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgd2FybmluZ3Mud2FybigiVGVzdFJlc3VsdCBoYXMgbm8gYWRkU2tpcCBtZXRob2QsIHNraXBzIG5vdCByZXBvcnRlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgUnVudGltZVdhcm5pbmcsIDIpCiAgICAgICAgICAgIHJlc3VsdC5hZGRTdWNjZXNzKHNlbGYpCgogICAgZGVmIF9leGVjdXRlVGVzdFBhcnQoc2VsZiwgZnVuY3Rpb24sIG91dGNvbWUsIGlzVGVzdD1GYWxzZSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBmdW5jdGlvbigpCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdCBTa2lwVGVzdCBhcyBlOgogICAgICAgICAgICBvdXRjb21lLnN1Y2Nlc3MgPSBGYWxzZQogICAgICAgICAgICBvdXRjb21lLnNraXBwZWQgPSBzdHIoZSkKICAgICAgICBleGNlcHQgX1VuZXhwZWN0ZWRTdWNjZXNzOgogICAgICAgICAgICBleGNfaW5mbyA9IHN5cy5leGNfaW5mbygpCiAgICAgICAgICAgIG91dGNvbWUuc3VjY2VzcyA9IEZhbHNlCiAgICAgICAgICAgIGlmIGlzVGVzdDoKICAgICAgICAgICAgICAgIG91dGNvbWUudW5leHBlY3RlZFN1Y2Nlc3MgPSBleGNfaW5mbwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgb3V0Y29tZS5lcnJvcnMuYXBwZW5kKGV4Y19pbmZvKQogICAgICAgIGV4Y2VwdCBfRXhwZWN0ZWRGYWlsdXJlOgogICAgICAgICAgICBvdXRjb21lLnN1Y2Nlc3MgPSBGYWxzZQogICAgICAgICAgICBleGNfaW5mbyA9IHN5cy5leGNfaW5mbygpCiAgICAgICAgICAgIGlmIGlzVGVzdDoKICAgICAgICAgICAgICAgIG91dGNvbWUuZXhwZWN0ZWRGYWlsdXJlID0gZXhjX2luZm8KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG91dGNvbWUuZXJyb3JzLmFwcGVuZChleGNfaW5mbykKICAgICAgICAjZml4bWUgYnJ5dGhvbiBTeW50YXggZXJyb3IKICAgICAgICAjZXhjZXB0IHNlbGYuZmFpbHVyZUV4Y2VwdGlvbjoKICAgICAgICAjICAgIG91dGNvbWUuc3VjY2VzcyA9IEZhbHNlCiAgICAgICAgIyAgICBvdXRjb21lLmZhaWx1cmVzLmFwcGVuZChzeXMuZXhjX2luZm8oKSkKICAgICAgICAjICAgIGV4Y19pbmZvID0gc3lzLmV4Y19pbmZvKCkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIG91dGNvbWUuc3VjY2VzcyA9IEZhbHNlCiAgICAgICAgICAgIG91dGNvbWUuZXJyb3JzLmFwcGVuZChzeXMuZXhjX2luZm8oKSkKCiAgICBkZWYgcnVuKHNlbGYsIHJlc3VsdD1Ob25lKToKICAgICAgICBvcmlnX3Jlc3VsdCA9IHJlc3VsdAogICAgICAgIGlmIHJlc3VsdCBpcyBOb25lOgogICAgICAgICAgICByZXN1bHQgPSBzZWxmLmRlZmF1bHRUZXN0UmVzdWx0KCkKICAgICAgICAgICAgc3RhcnRUZXN0UnVuID0gZ2V0YXR0cihyZXN1bHQsICdzdGFydFRlc3RSdW4nLCBOb25lKQogICAgICAgICAgICBpZiBzdGFydFRlc3RSdW4gaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBzdGFydFRlc3RSdW4oKQoKICAgICAgICByZXN1bHQuc3RhcnRUZXN0KHNlbGYpCgogICAgICAgIHRlc3RNZXRob2QgPSBnZXRhdHRyKHNlbGYsIHNlbGYuX3Rlc3RNZXRob2ROYW1lKQogICAgICAgIGlmIChnZXRhdHRyKHNlbGYuX19jbGFzc19fLCAiX191bml0dGVzdF9za2lwX18iLCBGYWxzZSkgb3IKICAgICAgICAgICAgZ2V0YXR0cih0ZXN0TWV0aG9kLCAiX191bml0dGVzdF9za2lwX18iLCBGYWxzZSkpOgogICAgICAgICAgICAjIElmIHRoZSBjbGFzcyBvciBtZXRob2Qgd2FzIHNraXBwZWQuCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNraXBfd2h5ID0gKGdldGF0dHIoc2VsZi5fX2NsYXNzX18sICdfX3VuaXR0ZXN0X3NraXBfd2h5X18nLCAnJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yIGdldGF0dHIodGVzdE1ldGhvZCwgJ19fdW5pdHRlc3Rfc2tpcF93aHlfXycsICcnKSkKICAgICAgICAgICAgICAgIHNlbGYuX2FkZFNraXAocmVzdWx0LCBza2lwX3doeSkKICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgIHJlc3VsdC5zdG9wVGVzdChzZWxmKQogICAgICAgICAgICByZXR1cm4KICAgICAgICB0cnk6CiAgICAgICAgICAgIG91dGNvbWUgPSBfT3V0Y29tZSgpCiAgICAgICAgICAgIHNlbGYuX291dGNvbWVGb3JEb0NsZWFudXBzID0gb3V0Y29tZQoKICAgICAgICAgICAgc2VsZi5fZXhlY3V0ZVRlc3RQYXJ0KHNlbGYuc2V0VXAsIG91dGNvbWUpCiAgICAgICAgICAgIGlmIG91dGNvbWUuc3VjY2VzczoKICAgICAgICAgICAgICAgIHNlbGYuX2V4ZWN1dGVUZXN0UGFydCh0ZXN0TWV0aG9kLCBvdXRjb21lLCBpc1Rlc3Q9VHJ1ZSkKICAgICAgICAgICAgICAgIHNlbGYuX2V4ZWN1dGVUZXN0UGFydChzZWxmLnRlYXJEb3duLCBvdXRjb21lKQoKICAgICAgICAgICAgc2VsZi5kb0NsZWFudXBzKCkKICAgICAgICAgICAgaWYgb3V0Y29tZS5zdWNjZXNzOgogICAgICAgICAgICAgICAgcmVzdWx0LmFkZFN1Y2Nlc3Moc2VsZikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIG91dGNvbWUuc2tpcHBlZCBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICBzZWxmLl9hZGRTa2lwKHJlc3VsdCwgb3V0Y29tZS5za2lwcGVkKQogICAgICAgICAgICAgICAgZm9yIGV4Y19pbmZvIGluIG91dGNvbWUuZXJyb3JzOgogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5hZGRFcnJvcihzZWxmLCBleGNfaW5mbykKICAgICAgICAgICAgICAgIGZvciBleGNfaW5mbyBpbiBvdXRjb21lLmZhaWx1cmVzOgogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5hZGRGYWlsdXJlKHNlbGYsIGV4Y19pbmZvKQogICAgICAgICAgICAgICAgaWYgb3V0Y29tZS51bmV4cGVjdGVkU3VjY2VzcyBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICBhZGRVbmV4cGVjdGVkU3VjY2VzcyA9IGdldGF0dHIocmVzdWx0LCAnYWRkVW5leHBlY3RlZFN1Y2Nlc3MnLCBOb25lKQogICAgICAgICAgICAgICAgICAgIGlmIGFkZFVuZXhwZWN0ZWRTdWNjZXNzIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICBhZGRVbmV4cGVjdGVkU3VjY2VzcyhzZWxmKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHdhcm5pbmdzLndhcm4oIlRlc3RSZXN1bHQgaGFzIG5vIGFkZFVuZXhwZWN0ZWRTdWNjZXNzIG1ldGhvZCwgcmVwb3J0aW5nIGFzIGZhaWx1cmVzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSdW50aW1lV2FybmluZykKICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmFkZEZhaWx1cmUoc2VsZiwgb3V0Y29tZS51bmV4cGVjdGVkU3VjY2VzcykKCiAgICAgICAgICAgICAgICBpZiBvdXRjb21lLmV4cGVjdGVkRmFpbHVyZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICBhZGRFeHBlY3RlZEZhaWx1cmUgPSBnZXRhdHRyKHJlc3VsdCwgJ2FkZEV4cGVjdGVkRmFpbHVyZScsIE5vbmUpCiAgICAgICAgICAgICAgICAgICAgaWYgYWRkRXhwZWN0ZWRGYWlsdXJlIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICBhZGRFeHBlY3RlZEZhaWx1cmUoc2VsZiwgb3V0Y29tZS5leHBlY3RlZEZhaWx1cmUpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgd2FybmluZ3Mud2FybigiVGVzdFJlc3VsdCBoYXMgbm8gYWRkRXhwZWN0ZWRGYWlsdXJlIG1ldGhvZCwgcmVwb3J0aW5nIGFzIHBhc3NlcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUnVudGltZVdhcm5pbmcpCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5hZGRTdWNjZXNzKHNlbGYpCgogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHJlc3VsdC5zdG9wVGVzdChzZWxmKQogICAgICAgICAgICBpZiBvcmlnX3Jlc3VsdCBpcyBOb25lOgogICAgICAgICAgICAgICAgc3RvcFRlc3RSdW4gPSBnZXRhdHRyKHJlc3VsdCwgJ3N0b3BUZXN0UnVuJywgTm9uZSkKICAgICAgICAgICAgICAgIGlmIHN0b3BUZXN0UnVuIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIHN0b3BUZXN0UnVuKCkKCiAgICBkZWYgZG9DbGVhbnVwcyhzZWxmKToKICAgICAgICAiIiJFeGVjdXRlIGFsbCBjbGVhbnVwIGZ1bmN0aW9ucy4gTm9ybWFsbHkgY2FsbGVkIGZvciB5b3UgYWZ0ZXIKICAgICAgICB0ZWFyRG93bi4iIiIKICAgICAgICBvdXRjb21lID0gc2VsZi5fb3V0Y29tZUZvckRvQ2xlYW51cHMgb3IgX091dGNvbWUoKQogICAgICAgIHdoaWxlIHNlbGYuX2NsZWFudXBzOgogICAgICAgICAgICBmdW5jdGlvbiwgYXJncywga3dhcmdzID0gc2VsZi5fY2xlYW51cHMucG9wKCkKICAgICAgICAgICAgcGFydCA9IGxhbWJkYTogZnVuY3Rpb24oKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBzZWxmLl9leGVjdXRlVGVzdFBhcnQocGFydCwgb3V0Y29tZSkKCiAgICAgICAgIyByZXR1cm4gdGhpcyBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkKICAgICAgICAjIGV2ZW4gdGhvdWdoIHdlIG5vIGxvbmdlciB1cyBpdCBpbnRlcm5hbGx5CiAgICAgICAgcmV0dXJuIG91dGNvbWUuc3VjY2VzcwoKICAgIGRlZiBfX2NhbGxfXyhzZWxmLCAqYXJncywgKiprd2RzKToKICAgICAgICByZXR1cm4gc2VsZi5ydW4oKmFyZ3MsICoqa3dkcykKCiAgICBkZWYgZGVidWcoc2VsZik6CiAgICAgICAgIiIiUnVuIHRoZSB0ZXN0IHdpdGhvdXQgY29sbGVjdGluZyBlcnJvcnMgaW4gYSBUZXN0UmVzdWx0IiIiCiAgICAgICAgc2VsZi5zZXRVcCgpCiAgICAgICAgZ2V0YXR0cihzZWxmLCBzZWxmLl90ZXN0TWV0aG9kTmFtZSkoKQogICAgICAgIHNlbGYudGVhckRvd24oKQogICAgICAgIHdoaWxlIHNlbGYuX2NsZWFudXBzOgogICAgICAgICAgICBmdW5jdGlvbiwgYXJncywga3dhcmdzID0gc2VsZi5fY2xlYW51cHMucG9wKC0xKQogICAgICAgICAgICBmdW5jdGlvbigqYXJncywgKiprd2FyZ3MpCgogICAgZGVmIHNraXBUZXN0KHNlbGYsIHJlYXNvbik6CiAgICAgICAgIiIiU2tpcCB0aGlzIHRlc3QuIiIiCiAgICAgICAgcmFpc2UgU2tpcFRlc3QocmVhc29uKQoKICAgIGRlZiBmYWlsKHNlbGYsIG1zZz1Ob25lKToKICAgICAgICAiIiJGYWlsIGltbWVkaWF0ZWx5LCB3aXRoIHRoZSBnaXZlbiBtZXNzYWdlLiIiIgogICAgICAgIHJhaXNlIHNlbGYuZmFpbHVyZUV4Y2VwdGlvbihtc2cpCgogICAgZGVmIGFzc2VydEZhbHNlKHNlbGYsIGV4cHIsIG1zZz1Ob25lKToKICAgICAgICAiIiJDaGVjayB0aGF0IHRoZSBleHByZXNzaW9uIGlzIGZhbHNlLiIiIgogICAgICAgIGlmIGV4cHI6CiAgICAgICAgICAgIG1zZyA9IHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCAiJXMgaXMgbm90IGZhbHNlIiAlIHNhZmVfcmVwcihleHByKSkKICAgICAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKG1zZykKCiAgICBkZWYgYXNzZXJ0VHJ1ZShzZWxmLCBleHByLCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiQ2hlY2sgdGhhdCB0aGUgZXhwcmVzc2lvbiBpcyB0cnVlLiIiIgogICAgICAgIGlmIG5vdCBleHByOgogICAgICAgICAgICBtc2cgPSBzZWxmLl9mb3JtYXRNZXNzYWdlKG1zZywgIiVzIGlzIG5vdCB0cnVlIiAlIHNhZmVfcmVwcihleHByKSkKICAgICAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKG1zZykKCiAgICBkZWYgX2Zvcm1hdE1lc3NhZ2Uoc2VsZiwgbXNnLCBzdGFuZGFyZE1zZyk6CiAgICAgICAgIiIiSG9ub3VyIHRoZSBsb25nTWVzc2FnZSBhdHRyaWJ1dGUgd2hlbiBnZW5lcmF0aW5nIGZhaWx1cmUgbWVzc2FnZXMuCiAgICAgICAgSWYgbG9uZ01lc3NhZ2UgaXMgRmFsc2UgdGhpcyBtZWFuczoKICAgICAgICAqIFVzZSBvbmx5IGFuIGV4cGxpY2l0IG1lc3NhZ2UgaWYgaXQgaXMgcHJvdmlkZWQKICAgICAgICAqIE90aGVyd2lzZSB1c2UgdGhlIHN0YW5kYXJkIG1lc3NhZ2UgZm9yIHRoZSBhc3NlcnQKCiAgICAgICAgSWYgbG9uZ01lc3NhZ2UgaXMgVHJ1ZToKICAgICAgICAqIFVzZSB0aGUgc3RhbmRhcmQgbWVzc2FnZQogICAgICAgICogSWYgYW4gZXhwbGljaXQgbWVzc2FnZSBpcyBwcm92aWRlZCwgcGx1cyAnIDogJyBhbmQgdGhlIGV4cGxpY2l0IG1lc3NhZ2UKICAgICAgICAiIiIKICAgICAgICBpZiBub3Qgc2VsZi5sb25nTWVzc2FnZToKICAgICAgICAgICAgcmV0dXJuIG1zZyBvciBzdGFuZGFyZE1zZwogICAgICAgIGlmIG1zZyBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gc3RhbmRhcmRNc2cKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgZG9uJ3Qgc3dpdGNoIHRvICd7fScgZm9ybWF0dGluZyBpbiBQeXRob24gMi5YCiAgICAgICAgICAgICMgaXQgY2hhbmdlcyB0aGUgd2F5IHVuaWNvZGUgaW5wdXQgaXMgaGFuZGxlZAogICAgICAgICAgICByZXR1cm4gJyVzIDogJXMnICUgKHN0YW5kYXJkTXNnLCBtc2cpCiAgICAgICAgZXhjZXB0IFVuaWNvZGVEZWNvZGVFcnJvcjoKICAgICAgICAgICAgcmV0dXJuICAnJXMgOiAlcycgJSAoc2FmZV9yZXByKHN0YW5kYXJkTXNnKSwgc2FmZV9yZXByKG1zZykpCgoKICAgIGRlZiBhc3NlcnRSYWlzZXMoc2VsZiwgZXhjQ2xhc3MsIGNhbGxhYmxlT2JqPU5vbmUsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgIiIiRmFpbCB1bmxlc3MgYW4gZXhjZXB0aW9uIG9mIGNsYXNzIGV4Y0NsYXNzIGlzIHRocm93bgogICAgICAgICAgIGJ5IGNhbGxhYmxlT2JqIHdoZW4gaW52b2tlZCB3aXRoIGFyZ3VtZW50cyBhcmdzIGFuZCBrZXl3b3JkCiAgICAgICAgICAgYXJndW1lbnRzIGt3YXJncy4gSWYgYSBkaWZmZXJlbnQgdHlwZSBvZiBleGNlcHRpb24gaXMKICAgICAgICAgICB0aHJvd24sIGl0IHdpbGwgbm90IGJlIGNhdWdodCwgYW5kIHRoZSB0ZXN0IGNhc2Ugd2lsbCBiZQogICAgICAgICAgIGRlZW1lZCB0byBoYXZlIHN1ZmZlcmVkIGFuIGVycm9yLCBleGFjdGx5IGFzIGZvciBhbgogICAgICAgICAgIHVuZXhwZWN0ZWQgZXhjZXB0aW9uLgoKICAgICAgICAgICBJZiBjYWxsZWQgd2l0aCBjYWxsYWJsZU9iaiBvbWl0dGVkIG9yIE5vbmUsIHdpbGwgcmV0dXJuIGEKICAgICAgICAgICBjb250ZXh0IG9iamVjdCB1c2VkIGxpa2UgdGhpczo6CgogICAgICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhTb21lRXhjZXB0aW9uKToKICAgICAgICAgICAgICAgICAgICBkb19zb21ldGhpbmcoKQoKICAgICAgICAgICBUaGUgY29udGV4dCBtYW5hZ2VyIGtlZXBzIGEgcmVmZXJlbmNlIHRvIHRoZSBleGNlcHRpb24gYXMKICAgICAgICAgICB0aGUgJ2V4Y2VwdGlvbicgYXR0cmlidXRlLiBUaGlzIGFsbG93cyB5b3UgdG8gaW5zcGVjdCB0aGUKICAgICAgICAgICBleGNlcHRpb24gYWZ0ZXIgdGhlIGFzc2VydGlvbjo6CgogICAgICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKFNvbWVFeGNlcHRpb24pIGFzIGNtOgogICAgICAgICAgICAgICAgICAgZG9fc29tZXRoaW5nKCkKICAgICAgICAgICAgICAgdGhlX2V4Y2VwdGlvbiA9IGNtLmV4Y2VwdGlvbgogICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHRoZV9leGNlcHRpb24uZXJyb3JfY29kZSwgMykKICAgICAgICAiIiIKICAgICAgICBjb250ZXh0ID0gX0Fzc2VydFJhaXNlc0NvbnRleHQoZXhjQ2xhc3MsIHNlbGYsIGNhbGxhYmxlT2JqKQogICAgICAgIGlmIGNhbGxhYmxlT2JqIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBjb250ZXh0CiAgICAgICAgI2ZpeG1lIGJyeXRob24gc3ludGF4IGVycm9yCiAgICAgICAgI3dpdGggY29udGV4dDoKICAgICAgICAjICAgIGNhbGxhYmxlT2JqKCphcmdzLCAqKmt3YXJncykKCiAgICBkZWYgYXNzZXJ0V2FybnMoc2VsZiwgZXhwZWN0ZWRfd2FybmluZywgY2FsbGFibGVfb2JqPU5vbmUsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgIiIiRmFpbCB1bmxlc3MgYSB3YXJuaW5nIG9mIGNsYXNzIHdhcm5DbGFzcyBpcyB0cmlnZ2VyZWQKICAgICAgICAgICBieSBjYWxsYWJsZU9iaiB3aGVuIGludm9rZWQgd2l0aCBhcmd1bWVudHMgYXJncyBhbmQga2V5d29yZAogICAgICAgICAgIGFyZ3VtZW50cyBrd2FyZ3MuICBJZiBhIGRpZmZlcmVudCB0eXBlIG9mIHdhcm5pbmcgaXMKICAgICAgICAgICB0cmlnZ2VyZWQsIGl0IHdpbGwgbm90IGJlIGhhbmRsZWQ6IGRlcGVuZGluZyBvbiB0aGUgb3RoZXIKICAgICAgICAgICB3YXJuaW5nIGZpbHRlcmluZyBydWxlcyBpbiBlZmZlY3QsIGl0IG1pZ2h0IGJlIHNpbGVuY2VkLCBwcmludGVkCiAgICAgICAgICAgb3V0LCBvciByYWlzZWQgYXMgYW4gZXhjZXB0aW9uLgoKICAgICAgICAgICBJZiBjYWxsZWQgd2l0aCBjYWxsYWJsZU9iaiBvbWl0dGVkIG9yIE5vbmUsIHdpbGwgcmV0dXJuIGEKICAgICAgICAgICBjb250ZXh0IG9iamVjdCB1c2VkIGxpa2UgdGhpczo6CgogICAgICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFdhcm5zKFNvbWVXYXJuaW5nKToKICAgICAgICAgICAgICAgICAgICBkb19zb21ldGhpbmcoKQoKICAgICAgICAgICBUaGUgY29udGV4dCBtYW5hZ2VyIGtlZXBzIGEgcmVmZXJlbmNlIHRvIHRoZSBmaXJzdCBtYXRjaGluZwogICAgICAgICAgIHdhcm5pbmcgYXMgdGhlICd3YXJuaW5nJyBhdHRyaWJ1dGU7IHNpbWlsYXJseSwgdGhlICdmaWxlbmFtZScKICAgICAgICAgICBhbmQgJ2xpbmVubycgYXR0cmlidXRlcyBnaXZlIHlvdSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgbGluZQogICAgICAgICAgIG9mIFB5dGhvbiBjb2RlIGZyb20gd2hpY2ggdGhlIHdhcm5pbmcgd2FzIHRyaWdnZXJlZC4KICAgICAgICAgICBUaGlzIGFsbG93cyB5b3UgdG8gaW5zcGVjdCB0aGUgd2FybmluZyBhZnRlciB0aGUgYXNzZXJ0aW9uOjoKCiAgICAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRXYXJucyhTb21lV2FybmluZykgYXMgY206CiAgICAgICAgICAgICAgICAgICBkb19zb21ldGhpbmcoKQogICAgICAgICAgICAgICB0aGVfd2FybmluZyA9IGNtLndhcm5pbmcKICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCh0aGVfd2FybmluZy5zb21lX2F0dHJpYnV0ZSwgMTQ3KQogICAgICAgICIiIgogICAgICAgIGNvbnRleHQgPSBfQXNzZXJ0V2FybnNDb250ZXh0KGV4cGVjdGVkX3dhcm5pbmcsIHNlbGYsIGNhbGxhYmxlX29iaikKICAgICAgICBpZiBjYWxsYWJsZV9vYmogaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQKICAgICAgICAjZml4bWUgYnJ5dGhvbiBzeW50YXggZXJyb3IKICAgICAgICAjd2l0aCBjb250ZXh0OgogICAgICAgICMgICAgY2FsbGFibGVfb2JqKCphcmdzLCAqKmt3YXJncykKCiAgICBkZWYgX2dldEFzc2VydEVxdWFsaXR5RnVuYyhzZWxmLCBmaXJzdCwgc2Vjb25kKToKICAgICAgICAiIiJHZXQgYSBkZXRhaWxlZCBjb21wYXJpc29uIGZ1bmN0aW9uIGZvciB0aGUgdHlwZXMgb2YgdGhlIHR3byBhcmdzLgoKICAgICAgICBSZXR1cm5zOiBBIGNhbGxhYmxlIGFjY2VwdGluZyAoZmlyc3QsIHNlY29uZCwgbXNnPU5vbmUpIHRoYXQgd2lsbAogICAgICAgIHJhaXNlIGEgZmFpbHVyZSBleGNlcHRpb24gaWYgZmlyc3QgIT0gc2Vjb25kIHdpdGggYSB1c2VmdWwgaHVtYW4KICAgICAgICByZWFkYWJsZSBlcnJvciBtZXNzYWdlIGZvciB0aG9zZSB0eXBlcy4KICAgICAgICAiIiIKICAgICAgICAjCiAgICAgICAgIyBOT1RFKGdyZWdvcnkucC5zbWl0aCk6IEkgY29uc2lkZXJlZCBpc2luc3RhbmNlKGZpcnN0LCB0eXBlKHNlY29uZCkpCiAgICAgICAgIyBhbmQgdmljZSB2ZXJzYS4gIEkgb3B0ZWQgZm9yIHRoZSBjb25zZXJ2YXRpdmUgYXBwcm9hY2ggaW4gY2FzZQogICAgICAgICMgc3ViY2xhc3NlcyBhcmUgbm90IGludGVuZGVkIHRvIGJlIGNvbXBhcmVkIGluIGRldGFpbCB0byB0aGVpciBzdXBlcgogICAgICAgICMgY2xhc3MgaW5zdGFuY2VzIHVzaW5nIGEgdHlwZSBlcXVhbGl0eSBmdW5jLiAgVGhpcyBtZWFucyB0ZXN0aW5nCiAgICAgICAgIyBzdWJ0eXBlcyB3b24ndCBhdXRvbWFnaWNhbGx5IHVzZSB0aGUgZGV0YWlsZWQgY29tcGFyaXNvbi4gIENhbGxlcnMKICAgICAgICAjIHNob3VsZCB1c2UgdGhlaXIgdHlwZSBzcGVjaWZpYyBhc3NlcnRTcGFtRXF1YWwgbWV0aG9kIHRvIGNvbXBhcmUKICAgICAgICAjIHN1YmNsYXNzZXMgaWYgdGhlIGRldGFpbGVkIGNvbXBhcmlzb24gaXMgZGVzaXJlZCBhbmQgYXBwcm9wcmlhdGUuCiAgICAgICAgIyBTZWUgdGhlIGRpc2N1c3Npb24gaW4gaHR0cDovL2J1Z3MucHl0aG9uLm9yZy9pc3N1ZTI1NzguCiAgICAgICAgIwogICAgICAgIGlmIHR5cGUoZmlyc3QpIGlzIHR5cGUoc2Vjb25kKToKICAgICAgICAgICAgYXNzZXJ0ZXIgPSBzZWxmLl90eXBlX2VxdWFsaXR5X2Z1bmNzLmdldCh0eXBlKGZpcnN0KSkKICAgICAgICAgICAgaWYgYXNzZXJ0ZXIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGFzc2VydGVyLCBzdHIpOgogICAgICAgICAgICAgICAgICAgIGFzc2VydGVyID0gZ2V0YXR0cihzZWxmLCBhc3NlcnRlcikKICAgICAgICAgICAgICAgIHJldHVybiBhc3NlcnRlcgoKICAgICAgICByZXR1cm4gc2VsZi5fYmFzZUFzc2VydEVxdWFsCgogICAgZGVmIF9iYXNlQXNzZXJ0RXF1YWwoc2VsZiwgZmlyc3QsIHNlY29uZCwgbXNnPU5vbmUpOgogICAgICAgICIiIlRoZSBkZWZhdWx0IGFzc2VydEVxdWFsIGltcGxlbWVudGF0aW9uLCBub3QgdHlwZSBzcGVjaWZpYy4iIiIKICAgICAgICBpZiBub3QgZmlyc3QgPT0gc2Vjb25kOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyAhPSAlcycgJSAoc2FmZV9yZXByKGZpcnN0KSwgc2FmZV9yZXByKHNlY29uZCkpCiAgICAgICAgICAgIG1zZyA9IHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykKICAgICAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKG1zZykKCiAgICBkZWYgYXNzZXJ0RXF1YWwoc2VsZiwgZmlyc3QsIHNlY29uZCwgbXNnPU5vbmUpOgogICAgICAgICIiIkZhaWwgaWYgdGhlIHR3byBvYmplY3RzIGFyZSB1bmVxdWFsIGFzIGRldGVybWluZWQgYnkgdGhlICc9PScKICAgICAgICAgICBvcGVyYXRvci4KICAgICAgICAiIiIKICAgICAgICBhc3NlcnRpb25fZnVuYyA9IHNlbGYuX2dldEFzc2VydEVxdWFsaXR5RnVuYyhmaXJzdCwgc2Vjb25kKQogICAgICAgIGFzc2VydGlvbl9mdW5jKGZpcnN0LCBzZWNvbmQsIG1zZz1tc2cpCgogICAgZGVmIGFzc2VydE5vdEVxdWFsKHNlbGYsIGZpcnN0LCBzZWNvbmQsIG1zZz1Ob25lKToKICAgICAgICAiIiJGYWlsIGlmIHRoZSB0d28gb2JqZWN0cyBhcmUgZXF1YWwgYXMgZGV0ZXJtaW5lZCBieSB0aGUgJz09JwogICAgICAgICAgIG9wZXJhdG9yLgogICAgICAgICIiIgogICAgICAgIGlmIG5vdCBmaXJzdCAhPSBzZWNvbmQ6CiAgICAgICAgICAgIG1zZyA9IHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCAnJXMgPT0gJXMnICUgKHNhZmVfcmVwcihmaXJzdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWZlX3JlcHIoc2Vjb25kKSkpCiAgICAgICAgICAgIHJhaXNlIHNlbGYuZmFpbHVyZUV4Y2VwdGlvbihtc2cpCgogICAgZGVmIGFzc2VydEFsbW9zdEVxdWFsKHNlbGYsIGZpcnN0LCBzZWNvbmQsIHBsYWNlcz1Ob25lLCBtc2c9Tm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBkZWx0YT1Ob25lKToKICAgICAgICAiIiJGYWlsIGlmIHRoZSB0d28gb2JqZWN0cyBhcmUgdW5lcXVhbCBhcyBkZXRlcm1pbmVkIGJ5IHRoZWlyCiAgICAgICAgICAgZGlmZmVyZW5jZSByb3VuZGVkIHRvIHRoZSBnaXZlbiBudW1iZXIgb2YgZGVjaW1hbCBwbGFjZXMKICAgICAgICAgICAoZGVmYXVsdCA3KSBhbmQgY29tcGFyaW5nIHRvIHplcm8sIG9yIGJ5IGNvbXBhcmluZyB0aGF0IHRoZQogICAgICAgICAgIGJldHdlZW4gdGhlIHR3byBvYmplY3RzIGlzIG1vcmUgdGhhbiB0aGUgZ2l2ZW4gZGVsdGEuCgogICAgICAgICAgIE5vdGUgdGhhdCBkZWNpbWFsIHBsYWNlcyAoZnJvbSB6ZXJvKSBhcmUgdXN1YWxseSBub3QgdGhlIHNhbWUKICAgICAgICAgICBhcyBzaWduaWZpY2FudCBkaWdpdHMgKG1lYXN1cmVkIGZyb20gdGhlIG1vc3Qgc2lnbmZpY2FudCBkaWdpdCkuCgogICAgICAgICAgIElmIHRoZSB0d28gb2JqZWN0cyBjb21wYXJlIGVxdWFsIHRoZW4gdGhleSB3aWxsIGF1dG9tYXRpY2FsbHkKICAgICAgICAgICBjb21wYXJlIGFsbW9zdCBlcXVhbC4KICAgICAgICAiIiIKICAgICAgICBpZiBmaXJzdCA9PSBzZWNvbmQ6CiAgICAgICAgICAgICMgc2hvcnRjdXQKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgZGVsdGEgaXMgbm90IE5vbmUgYW5kIHBsYWNlcyBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJzcGVjaWZ5IGRlbHRhIG9yIHBsYWNlcyBub3QgYm90aCIpCgogICAgICAgIGlmIGRlbHRhIGlzIG5vdCBOb25lOgogICAgICAgICAgICBpZiBhYnMoZmlyc3QgLSBzZWNvbmQpIDw9IGRlbHRhOgogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyAhPSAlcyB3aXRoaW4gJXMgZGVsdGEnICUgKHNhZmVfcmVwcihmaXJzdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKHNlY29uZCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKGRlbHRhKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBwbGFjZXMgaXMgTm9uZToKICAgICAgICAgICAgICAgIHBsYWNlcyA9IDcKCiAgICAgICAgICAgIGlmIHJvdW5kKGFicyhzZWNvbmQtZmlyc3QpLCBwbGFjZXMpID09IDA6CiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzICE9ICVzIHdpdGhpbiAlciBwbGFjZXMnICUgKHNhZmVfcmVwcihmaXJzdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWZlX3JlcHIoc2Vjb25kKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlcykKICAgICAgICBtc2cgPSBzZWxmLl9mb3JtYXRNZXNzYWdlKG1zZywgc3RhbmRhcmRNc2cpCiAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKG1zZykKCiAgICBkZWYgYXNzZXJ0Tm90QWxtb3N0RXF1YWwoc2VsZiwgZmlyc3QsIHNlY29uZCwgcGxhY2VzPU5vbmUsIG1zZz1Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhPU5vbmUpOgogICAgICAgICIiIkZhaWwgaWYgdGhlIHR3byBvYmplY3RzIGFyZSBlcXVhbCBhcyBkZXRlcm1pbmVkIGJ5IHRoZWlyCiAgICAgICAgICAgZGlmZmVyZW5jZSByb3VuZGVkIHRvIHRoZSBnaXZlbiBudW1iZXIgb2YgZGVjaW1hbCBwbGFjZXMKICAgICAgICAgICAoZGVmYXVsdCA3KSBhbmQgY29tcGFyaW5nIHRvIHplcm8sIG9yIGJ5IGNvbXBhcmluZyB0aGF0IHRoZQogICAgICAgICAgIGJldHdlZW4gdGhlIHR3byBvYmplY3RzIGlzIGxlc3MgdGhhbiB0aGUgZ2l2ZW4gZGVsdGEuCgogICAgICAgICAgIE5vdGUgdGhhdCBkZWNpbWFsIHBsYWNlcyAoZnJvbSB6ZXJvKSBhcmUgdXN1YWxseSBub3QgdGhlIHNhbWUKICAgICAgICAgICBhcyBzaWduaWZpY2FudCBkaWdpdHMgKG1lYXN1cmVkIGZyb20gdGhlIG1vc3Qgc2lnbmZpY2FudCBkaWdpdCkuCgogICAgICAgICAgIE9iamVjdHMgdGhhdCBhcmUgZXF1YWwgYXV0b21hdGljYWxseSBmYWlsLgogICAgICAgICIiIgogICAgICAgIGlmIGRlbHRhIGlzIG5vdCBOb25lIGFuZCBwbGFjZXMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigic3BlY2lmeSBkZWx0YSBvciBwbGFjZXMgbm90IGJvdGgiKQogICAgICAgIGlmIGRlbHRhIGlzIG5vdCBOb25lOgogICAgICAgICAgICBpZiBub3QgKGZpcnN0ID09IHNlY29uZCkgYW5kIGFicyhmaXJzdCAtIHNlY29uZCkgPiBkZWx0YToKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyA9PSAlcyB3aXRoaW4gJXMgZGVsdGEnICUgKHNhZmVfcmVwcihmaXJzdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKHNlY29uZCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKGRlbHRhKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBwbGFjZXMgaXMgTm9uZToKICAgICAgICAgICAgICAgIHBsYWNlcyA9IDcKICAgICAgICAgICAgaWYgbm90IChmaXJzdCA9PSBzZWNvbmQpIGFuZCByb3VuZChhYnMoc2Vjb25kLWZpcnN0KSwgcGxhY2VzKSAhPSAwOgogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzID09ICVzIHdpdGhpbiAlciBwbGFjZXMnICUgKHNhZmVfcmVwcihmaXJzdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhZmVfcmVwcihzZWNvbmQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZXMpCgogICAgICAgIG1zZyA9IHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykKICAgICAgICByYWlzZSBzZWxmLmZhaWx1cmVFeGNlcHRpb24obXNnKQoKCiAgICBkZWYgYXNzZXJ0U2VxdWVuY2VFcXVhbChzZWxmLCBzZXExLCBzZXEyLCBtc2c9Tm9uZSwgc2VxX3R5cGU9Tm9uZSk6CiAgICAgICAgIiIiQW4gZXF1YWxpdHkgYXNzZXJ0aW9uIGZvciBvcmRlcmVkIHNlcXVlbmNlcyAobGlrZSBsaXN0cyBhbmQgdHVwbGVzKS4KCiAgICAgICAgRm9yIHRoZSBwdXJwb3NlcyBvZiB0aGlzIGZ1bmN0aW9uLCBhIHZhbGlkIG9yZGVyZWQgc2VxdWVuY2UgdHlwZSBpcyBvbmUKICAgICAgICB3aGljaCBjYW4gYmUgaW5kZXhlZCwgaGFzIGEgbGVuZ3RoLCBhbmQgaGFzIGFuIGVxdWFsaXR5IG9wZXJhdG9yLgoKICAgICAgICBBcmdzOgogICAgICAgICAgICBzZXExOiBUaGUgZmlyc3Qgc2VxdWVuY2UgdG8gY29tcGFyZS4KICAgICAgICAgICAgc2VxMjogVGhlIHNlY29uZCBzZXF1ZW5jZSB0byBjb21wYXJlLgogICAgICAgICAgICBzZXFfdHlwZTogVGhlIGV4cGVjdGVkIGRhdGF0eXBlIG9mIHRoZSBzZXF1ZW5jZXMsIG9yIE5vbmUgaWYgbm8KICAgICAgICAgICAgICAgICAgICBkYXRhdHlwZSBzaG91bGQgYmUgZW5mb3JjZWQuCiAgICAgICAgICAgIG1zZzogT3B0aW9uYWwgbWVzc2FnZSB0byB1c2Ugb24gZmFpbHVyZSBpbnN0ZWFkIG9mIGEgbGlzdCBvZgogICAgICAgICAgICAgICAgICAgIGRpZmZlcmVuY2VzLgogICAgICAgICIiIgogICAgICAgIGlmIHNlcV90eXBlICE9IE5vbmU6CiAgICAgICAgICAgIHNlcV90eXBlX25hbWUgPSBzZXFfdHlwZS5fX25hbWVfXwogICAgICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShzZXExLCBzZXFfdHlwZSk6CiAgICAgICAgICAgICAgICByYWlzZSBzZWxmLmZhaWx1cmVFeGNlcHRpb24oJ0ZpcnN0IHNlcXVlbmNlIGlzIG5vdCBhICVzOiAlcycKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICUgKHNlcV90eXBlX25hbWUsIHNhZmVfcmVwcihzZXExKSkpCiAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHNlcTIsIHNlcV90eXBlKToKICAgICAgICAgICAgICAgIHJhaXNlIHNlbGYuZmFpbHVyZUV4Y2VwdGlvbignU2Vjb25kIHNlcXVlbmNlIGlzIG5vdCBhICVzOiAlcycKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICUgKHNlcV90eXBlX25hbWUsIHNhZmVfcmVwcihzZXEyKSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VxX3R5cGVfbmFtZSA9ICJzZXF1ZW5jZSIKCiAgICAgICAgZGlmZmVyaW5nID0gTm9uZQogICAgICAgIHRyeToKICAgICAgICAgICAgbGVuMSA9IGxlbihzZXExKQogICAgICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBOb3RJbXBsZW1lbnRlZEVycm9yKToKICAgICAgICAgICAgZGlmZmVyaW5nID0gJ0ZpcnN0ICVzIGhhcyBubyBsZW5ndGguICAgIE5vbi1zZXF1ZW5jZT8nICUgKAogICAgICAgICAgICAgICAgICAgIHNlcV90eXBlX25hbWUpCgogICAgICAgIGlmIGRpZmZlcmluZyBpcyBOb25lOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBsZW4yID0gbGVuKHNlcTIpCiAgICAgICAgICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBOb3RJbXBsZW1lbnRlZEVycm9yKToKICAgICAgICAgICAgICAgIGRpZmZlcmluZyA9ICdTZWNvbmQgJXMgaGFzIG5vIGxlbmd0aC4gICAgTm9uLXNlcXVlbmNlPycgJSAoCiAgICAgICAgICAgICAgICAgICAgICAgIHNlcV90eXBlX25hbWUpCgogICAgICAgIGlmIGRpZmZlcmluZyBpcyBOb25lOgogICAgICAgICAgICBpZiBzZXExID09IHNlcTI6CiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgIHNlcTFfcmVwciA9IHNhZmVfcmVwcihzZXExKQogICAgICAgICAgICBzZXEyX3JlcHIgPSBzYWZlX3JlcHIoc2VxMikKICAgICAgICAgICAgaWYgbGVuKHNlcTFfcmVwcikgPiAzMDoKICAgICAgICAgICAgICAgIHNlcTFfcmVwciA9IHNlcTFfcmVwcls6MzBdICsgJy4uLicKICAgICAgICAgICAgaWYgbGVuKHNlcTJfcmVwcikgPiAzMDoKICAgICAgICAgICAgICAgIHNlcTJfcmVwciA9IHNlcTJfcmVwcls6MzBdICsgJy4uLicKICAgICAgICAgICAgZWxlbWVudHMgPSAoc2VxX3R5cGVfbmFtZS5jYXBpdGFsaXplKCksIHNlcTFfcmVwciwgc2VxMl9yZXByKQogICAgICAgICAgICBkaWZmZXJpbmcgPSAnJXNzIGRpZmZlcjogJXMgIT0gJXNcbicgJSBlbGVtZW50cwoKICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2UobWluKGxlbjEsIGxlbjIpKToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBpdGVtMSA9IHNlcTFbaV0KICAgICAgICAgICAgICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBJbmRleEVycm9yLCBOb3RJbXBsZW1lbnRlZEVycm9yKToKICAgICAgICAgICAgICAgICAgICBkaWZmZXJpbmcgKz0gKCdcblVuYWJsZSB0byBpbmRleCBlbGVtZW50ICVkIG9mIGZpcnN0ICVzXG4nICUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGksIHNlcV90eXBlX25hbWUpKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGl0ZW0yID0gc2VxMltpXQogICAgICAgICAgICAgICAgZXhjZXB0IChUeXBlRXJyb3IsIEluZGV4RXJyb3IsIE5vdEltcGxlbWVudGVkRXJyb3IpOgogICAgICAgICAgICAgICAgICAgIGRpZmZlcmluZyArPSAoJ1xuVW5hYmxlIHRvIGluZGV4IGVsZW1lbnQgJWQgb2Ygc2Vjb25kICVzXG4nICUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGksIHNlcV90eXBlX25hbWUpKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAgICAgaWYgaXRlbTEgIT0gaXRlbTI6CiAgICAgICAgICAgICAgICAgICAgZGlmZmVyaW5nICs9ICgnXG5GaXJzdCBkaWZmZXJpbmcgZWxlbWVudCAlZDpcbiVzXG4lc1xuJyAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChpLCBpdGVtMSwgaXRlbTIpKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpZiAobGVuMSA9PSBsZW4yIGFuZCBzZXFfdHlwZSBpcyBOb25lIGFuZAogICAgICAgICAgICAgICAgICAgIHR5cGUoc2VxMSkgIT0gdHlwZShzZXEyKSk6CiAgICAgICAgICAgICAgICAgICAgIyBUaGUgc2VxdWVuY2VzIGFyZSB0aGUgc2FtZSwgYnV0IGhhdmUgZGlmZmVyaW5nIHR5cGVzLgogICAgICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgaWYgbGVuMSA+IGxlbjI6CiAgICAgICAgICAgICAgICBkaWZmZXJpbmcgKz0gKCdcbkZpcnN0ICVzIGNvbnRhaW5zICVkIGFkZGl0aW9uYWwgJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICdlbGVtZW50cy5cbicgJSAoc2VxX3R5cGVfbmFtZSwgbGVuMSAtIGxlbjIpKQogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGRpZmZlcmluZyArPSAoJ0ZpcnN0IGV4dHJhIGVsZW1lbnQgJWQ6XG4lc1xuJyAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAobGVuMiwgc2VxMVtsZW4yXSkpCiAgICAgICAgICAgICAgICBleGNlcHQgKFR5cGVFcnJvciwgSW5kZXhFcnJvciwgTm90SW1wbGVtZW50ZWRFcnJvcik6CiAgICAgICAgICAgICAgICAgICAgZGlmZmVyaW5nICs9ICgnVW5hYmxlIHRvIGluZGV4IGVsZW1lbnQgJWQgJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29mIGZpcnN0ICVzXG4nICUgKGxlbjIsIHNlcV90eXBlX25hbWUpKQogICAgICAgICAgICBlbGlmIGxlbjEgPCBsZW4yOgogICAgICAgICAgICAgICAgZGlmZmVyaW5nICs9ICgnXG5TZWNvbmQgJXMgY29udGFpbnMgJWQgYWRkaXRpb25hbCAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2VsZW1lbnRzLlxuJyAlIChzZXFfdHlwZV9uYW1lLCBsZW4yIC0gbGVuMSkpCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgZGlmZmVyaW5nICs9ICgnRmlyc3QgZXh0cmEgZWxlbWVudCAlZDpcbiVzXG4nICUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChsZW4xLCBzZXEyW2xlbjFdKSkKICAgICAgICAgICAgICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBJbmRleEVycm9yLCBOb3RJbXBsZW1lbnRlZEVycm9yKToKICAgICAgICAgICAgICAgICAgICBkaWZmZXJpbmcgKz0gKCdVbmFibGUgdG8gaW5kZXggZWxlbWVudCAlZCAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb2Ygc2Vjb25kICVzXG4nICUgKGxlbjEsIHNlcV90eXBlX25hbWUpKQogICAgICAgIHN0YW5kYXJkTXNnID0gZGlmZmVyaW5nCiAgICAgICAgZGlmZk1zZyA9ICdcbicgKyAnXG4nLmpvaW4oCiAgICAgICAgICAgIGRpZmZsaWIubmRpZmYocHByaW50LnBmb3JtYXQoc2VxMSkuc3BsaXRsaW5lcygpLAogICAgICAgICAgICAgICAgICAgICAgICAgIHBwcmludC5wZm9ybWF0KHNlcTIpLnNwbGl0bGluZXMoKSkpCgogICAgICAgIHN0YW5kYXJkTXNnID0gc2VsZi5fdHJ1bmNhdGVNZXNzYWdlKHN0YW5kYXJkTXNnLCBkaWZmTXNnKQogICAgICAgIG1zZyA9IHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykKICAgICAgICBzZWxmLmZhaWwobXNnKQoKICAgIGRlZiBfdHJ1bmNhdGVNZXNzYWdlKHNlbGYsIG1lc3NhZ2UsIGRpZmYpOgogICAgICAgIG1heF9kaWZmID0gc2VsZi5tYXhEaWZmCiAgICAgICAgaWYgbWF4X2RpZmYgaXMgTm9uZSBvciBsZW4oZGlmZikgPD0gbWF4X2RpZmY6CiAgICAgICAgICAgIHJldHVybiBtZXNzYWdlICsgZGlmZgogICAgICAgIHJldHVybiBtZXNzYWdlICsgKERJRkZfT01JVFRFRCAlIGxlbihkaWZmKSkKCiAgICBkZWYgYXNzZXJ0TGlzdEVxdWFsKHNlbGYsIGxpc3QxLCBsaXN0MiwgbXNnPU5vbmUpOgogICAgICAgICIiIkEgbGlzdC1zcGVjaWZpYyBlcXVhbGl0eSBhc3NlcnRpb24uCgogICAgICAgIEFyZ3M6CiAgICAgICAgICAgIGxpc3QxOiBUaGUgZmlyc3QgbGlzdCB0byBjb21wYXJlLgogICAgICAgICAgICBsaXN0MjogVGhlIHNlY29uZCBsaXN0IHRvIGNvbXBhcmUuCiAgICAgICAgICAgIG1zZzogT3B0aW9uYWwgbWVzc2FnZSB0byB1c2Ugb24gZmFpbHVyZSBpbnN0ZWFkIG9mIGEgbGlzdCBvZgogICAgICAgICAgICAgICAgICAgIGRpZmZlcmVuY2VzLgoKICAgICAgICAiIiIKICAgICAgICBzZWxmLmFzc2VydFNlcXVlbmNlRXF1YWwobGlzdDEsIGxpc3QyLCBtc2csIHNlcV90eXBlPWxpc3QpCgogICAgZGVmIGFzc2VydFR1cGxlRXF1YWwoc2VsZiwgdHVwbGUxLCB0dXBsZTIsIG1zZz1Ob25lKToKICAgICAgICAiIiJBIHR1cGxlLXNwZWNpZmljIGVxdWFsaXR5IGFzc2VydGlvbi4KCiAgICAgICAgQXJnczoKICAgICAgICAgICAgdHVwbGUxOiBUaGUgZmlyc3QgdHVwbGUgdG8gY29tcGFyZS4KICAgICAgICAgICAgdHVwbGUyOiBUaGUgc2Vjb25kIHR1cGxlIHRvIGNvbXBhcmUuCiAgICAgICAgICAgIG1zZzogT3B0aW9uYWwgbWVzc2FnZSB0byB1c2Ugb24gZmFpbHVyZSBpbnN0ZWFkIG9mIGEgbGlzdCBvZgogICAgICAgICAgICAgICAgICAgIGRpZmZlcmVuY2VzLgogICAgICAgICIiIgogICAgICAgIHNlbGYuYXNzZXJ0U2VxdWVuY2VFcXVhbCh0dXBsZTEsIHR1cGxlMiwgbXNnLCBzZXFfdHlwZT10dXBsZSkKCiAgICBkZWYgYXNzZXJ0U2V0RXF1YWwoc2VsZiwgc2V0MSwgc2V0MiwgbXNnPU5vbmUpOgogICAgICAgICIiIkEgc2V0LXNwZWNpZmljIGVxdWFsaXR5IGFzc2VydGlvbi4KCiAgICAgICAgQXJnczoKICAgICAgICAgICAgc2V0MTogVGhlIGZpcnN0IHNldCB0byBjb21wYXJlLgogICAgICAgICAgICBzZXQyOiBUaGUgc2Vjb25kIHNldCB0byBjb21wYXJlLgogICAgICAgICAgICBtc2c6IE9wdGlvbmFsIG1lc3NhZ2UgdG8gdXNlIG9uIGZhaWx1cmUgaW5zdGVhZCBvZiBhIGxpc3Qgb2YKICAgICAgICAgICAgICAgICAgICBkaWZmZXJlbmNlcy4KCiAgICAgICAgYXNzZXJ0U2V0RXF1YWwgdXNlcyBkdWNrdHlwaW5nIHRvIHN1cHBvcnQgZGlmZmVyZW50IHR5cGVzIG9mIHNldHMsIGFuZAogICAgICAgIGlzIG9wdGltaXplZCBmb3Igc2V0cyBzcGVjaWZpY2FsbHkgKHBhcmFtZXRlcnMgbXVzdCBzdXBwb3J0IGEKICAgICAgICBkaWZmZXJlbmNlIG1ldGhvZCkuCiAgICAgICAgIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBkaWZmZXJlbmNlMSA9IHNldDEuZGlmZmVyZW5jZShzZXQyKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5mYWlsKCdpbnZhbGlkIHR5cGUgd2hlbiBhdHRlbXB0aW5nIHNldCBkaWZmZXJlbmNlOiAlcycgJSBlKQogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvciBhcyBlOgogICAgICAgICAgICBzZWxmLmZhaWwoJ2ZpcnN0IGFyZ3VtZW50IGRvZXMgbm90IHN1cHBvcnQgc2V0IGRpZmZlcmVuY2U6ICVzJyAlIGUpCgogICAgICAgIHRyeToKICAgICAgICAgICAgZGlmZmVyZW5jZTIgPSBzZXQyLmRpZmZlcmVuY2Uoc2V0MSkKICAgICAgICBleGNlcHQgVHlwZUVycm9yIGFzIGU6CiAgICAgICAgICAgIHNlbGYuZmFpbCgnaW52YWxpZCB0eXBlIHdoZW4gYXR0ZW1wdGluZyBzZXQgZGlmZmVyZW5jZTogJXMnICUgZSkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5mYWlsKCdzZWNvbmQgYXJndW1lbnQgZG9lcyBub3Qgc3VwcG9ydCBzZXQgZGlmZmVyZW5jZTogJXMnICUgZSkKCiAgICAgICAgaWYgbm90IChkaWZmZXJlbmNlMSBvciBkaWZmZXJlbmNlMik6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBsaW5lcyA9IFtdCiAgICAgICAgaWYgZGlmZmVyZW5jZTE6CiAgICAgICAgICAgIGxpbmVzLmFwcGVuZCgnSXRlbXMgaW4gdGhlIGZpcnN0IHNldCBidXQgbm90IHRoZSBzZWNvbmQ6JykKICAgICAgICAgICAgZm9yIGl0ZW0gaW4gZGlmZmVyZW5jZTE6CiAgICAgICAgICAgICAgICBsaW5lcy5hcHBlbmQocmVwcihpdGVtKSkKICAgICAgICBpZiBkaWZmZXJlbmNlMjoKICAgICAgICAgICAgbGluZXMuYXBwZW5kKCdJdGVtcyBpbiB0aGUgc2Vjb25kIHNldCBidXQgbm90IHRoZSBmaXJzdDonKQogICAgICAgICAgICBmb3IgaXRlbSBpbiBkaWZmZXJlbmNlMjoKICAgICAgICAgICAgICAgIGxpbmVzLmFwcGVuZChyZXByKGl0ZW0pKQoKICAgICAgICBzdGFuZGFyZE1zZyA9ICdcbicuam9pbihsaW5lcykKICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0SW4oc2VsZiwgbWVtYmVyLCBjb250YWluZXIsIG1zZz1Ob25lKToKICAgICAgICAiIiJKdXN0IGxpa2Ugc2VsZi5hc3NlcnRUcnVlKGEgaW4gYiksIGJ1dCB3aXRoIGEgbmljZXIgZGVmYXVsdCBtZXNzYWdlLiIiIgogICAgICAgIGlmIG1lbWJlciBub3QgaW4gY29udGFpbmVyOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyBub3QgZm91bmQgaW4gJXMnICUgKHNhZmVfcmVwcihtZW1iZXIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhZmVfcmVwcihjb250YWluZXIpKQogICAgICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0Tm90SW4oc2VsZiwgbWVtYmVyLCBjb250YWluZXIsIG1zZz1Ob25lKToKICAgICAgICAiIiJKdXN0IGxpa2Ugc2VsZi5hc3NlcnRUcnVlKGEgbm90IGluIGIpLCBidXQgd2l0aCBhIG5pY2VyIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBtZW1iZXIgaW4gY29udGFpbmVyOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyB1bmV4cGVjdGVkbHkgZm91bmQgaW4gJXMnICUgKHNhZmVfcmVwcihtZW1iZXIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhZmVfcmVwcihjb250YWluZXIpKQogICAgICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0SXMoc2VsZiwgZXhwcjEsIGV4cHIyLCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiSnVzdCBsaWtlIHNlbGYuYXNzZXJ0VHJ1ZShhIGlzIGIpLCBidXQgd2l0aCBhIG5pY2VyIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBleHByMSBpcyBub3QgZXhwcjI6CiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzIGlzIG5vdCAlcycgJSAoc2FmZV9yZXByKGV4cHIxKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKGV4cHIyKSkKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydElzTm90KHNlbGYsIGV4cHIxLCBleHByMiwgbXNnPU5vbmUpOgogICAgICAgICIiIkp1c3QgbGlrZSBzZWxmLmFzc2VydFRydWUoYSBpcyBub3QgYiksIGJ1dCB3aXRoIGEgbmljZXIgZGVmYXVsdCBtZXNzYWdlLiIiIgogICAgICAgIGlmIGV4cHIxIGlzIGV4cHIyOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICd1bmV4cGVjdGVkbHkgaWRlbnRpY2FsOiAlcycgJSAoc2FmZV9yZXByKGV4cHIxKSwpCiAgICAgICAgICAgIHNlbGYuZmFpbChzZWxmLl9mb3JtYXRNZXNzYWdlKG1zZywgc3RhbmRhcmRNc2cpKQoKICAgIGRlZiBhc3NlcnREaWN0RXF1YWwoc2VsZiwgZDEsIGQyLCBtc2c9Tm9uZSk6CiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGQxLCBkaWN0LCAnRmlyc3QgYXJndW1lbnQgaXMgbm90IGEgZGljdGlvbmFyeScpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGQyLCBkaWN0LCAnU2Vjb25kIGFyZ3VtZW50IGlzIG5vdCBhIGRpY3Rpb25hcnknKQoKICAgICAgICBpZiBkMSAhPSBkMjoKICAgICAgICAgICAgc3RhbmRhcmRNc2cgPSAnJXMgIT0gJXMnICUgKHNhZmVfcmVwcihkMSwgVHJ1ZSksIHNhZmVfcmVwcihkMiwgVHJ1ZSkpCiAgICAgICAgICAgIGRpZmYgPSAoJ1xuJyArICdcbicuam9pbihkaWZmbGliLm5kaWZmKAogICAgICAgICAgICAgICAgICAgICAgICAgICBwcHJpbnQucGZvcm1hdChkMSkuc3BsaXRsaW5lcygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICBwcHJpbnQucGZvcm1hdChkMikuc3BsaXRsaW5lcygpKSkpCiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gc2VsZi5fdHJ1bmNhdGVNZXNzYWdlKHN0YW5kYXJkTXNnLCBkaWZmKQogICAgICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0KHNlbGYsIHN1YnNldCwgZGljdGlvbmFyeSwgbXNnPU5vbmUpOgogICAgICAgICIiIkNoZWNrcyB3aGV0aGVyIGRpY3Rpb25hcnkgaXMgYSBzdXBlcnNldCBvZiBzdWJzZXQuIiIiCiAgICAgICAgd2FybmluZ3Mud2FybignYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0IGlzIGRlcHJlY2F0ZWQnLAogICAgICAgICAgICAgICAgICAgICAgRGVwcmVjYXRpb25XYXJuaW5nKQogICAgICAgIG1pc3NpbmcgPSBbXQogICAgICAgIG1pc21hdGNoZWQgPSBbXQogICAgICAgIGZvciBrZXksIHZhbHVlIGluIHN1YnNldC5pdGVtcygpOgogICAgICAgICAgICBpZiBrZXkgbm90IGluIGRpY3Rpb25hcnk6CiAgICAgICAgICAgICAgICBtaXNzaW5nLmFwcGVuZChrZXkpCiAgICAgICAgICAgIGVsaWYgdmFsdWUgIT0gZGljdGlvbmFyeVtrZXldOgogICAgICAgICAgICAgICAgbWlzbWF0Y2hlZC5hcHBlbmQoJyVzLCBleHBlY3RlZDogJXMsIGFjdHVhbDogJXMnICUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChzYWZlX3JlcHIoa2V5KSwgc2FmZV9yZXByKHZhbHVlKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWZlX3JlcHIoZGljdGlvbmFyeVtrZXldKSkpCgogICAgICAgIGlmIG5vdCAobWlzc2luZyBvciBtaXNtYXRjaGVkKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHN0YW5kYXJkTXNnID0gJycKICAgICAgICBpZiBtaXNzaW5nOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICdNaXNzaW5nOiAlcycgJSAnLCcuam9pbihzYWZlX3JlcHIobSkgZm9yIG0gaW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pc3NpbmcpCiAgICAgICAgaWYgbWlzbWF0Y2hlZDoKICAgICAgICAgICAgaWYgc3RhbmRhcmRNc2c6CiAgICAgICAgICAgICAgICBzdGFuZGFyZE1zZyArPSAnOyAnCiAgICAgICAgICAgIHN0YW5kYXJkTXNnICs9ICdNaXNtYXRjaGVkIHZhbHVlczogJXMnICUgJywnLmpvaW4obWlzbWF0Y2hlZCkKCiAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydFNhbWVFbGVtZW50cyhzZWxmLCBleHBlY3RlZF9zZXEsIGFjdHVhbF9zZXEsIG1zZz1Ob25lKToKICAgICAgICAiIiJBbiB1bm9yZGVyZWQgc2VxdWVuY2Ugc3BlY2lmaWMgY29tcGFyaXNvbi4KCiAgICAgICAgUmFpc2VzIHdpdGggYW4gZXJyb3IgbWVzc2FnZSBsaXN0aW5nIHdoaWNoIGVsZW1lbnRzIG9mIGV4cGVjdGVkX3NlcQogICAgICAgIGFyZSBtaXNzaW5nIGZyb20gYWN0dWFsX3NlcSBhbmQgdmljZSB2ZXJzYSBpZiBhbnkuCgogICAgICAgIER1cGxpY2F0ZSBlbGVtZW50cyBhcmUgaWdub3JlZCB3aGVuIGNvbXBhcmluZyAqZXhwZWN0ZWRfc2VxKiBhbmQKICAgICAgICAqYWN0dWFsX3NlcSouIEl0IGlzIHRoZSBlcXVpdmFsZW50IG9mIGBgYXNzZXJ0RXF1YWwoc2V0KGV4cGVjdGVkKSwKICAgICAgICBzZXQoYWN0dWFsKSlgYCBidXQgaXQgd29ya3Mgd2l0aCBzZXF1ZW5jZXMgb2YgdW5oYXNoYWJsZSBvYmplY3RzIGFzCiAgICAgICAgd2VsbC4KICAgICAgICAiIiIKICAgICAgICB3YXJuaW5ncy53YXJuKCdhc3NlcnRTYW1lRWxlbWVudHMgaXMgZGVwcmVjYXRlZCcsCiAgICAgICAgICAgICAgICAgICAgICBEZXByZWNhdGlvbldhcm5pbmcpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBleHBlY3RlZCA9IHNldChleHBlY3RlZF9zZXEpCiAgICAgICAgICAgIGFjdHVhbCA9IHNldChhY3R1YWxfc2VxKQogICAgICAgICAgICBtaXNzaW5nID0gc29ydGVkKGV4cGVjdGVkLmRpZmZlcmVuY2UoYWN0dWFsKSkKICAgICAgICAgICAgdW5leHBlY3RlZCA9IHNvcnRlZChhY3R1YWwuZGlmZmVyZW5jZShleHBlY3RlZCkpCiAgICAgICAgZXhjZXB0IFR5cGVFcnJvcjoKICAgICAgICAgICAgIyBGYWxsIGJhY2sgdG8gc2xvd2VyIGxpc3QtY29tcGFyZSBpZiBhbnkgb2YgdGhlIG9iamVjdHMgYXJlCiAgICAgICAgICAgICMgbm90IGhhc2hhYmxlLgogICAgICAgICAgICBleHBlY3RlZCA9IGxpc3QoZXhwZWN0ZWRfc2VxKQogICAgICAgICAgICBhY3R1YWwgPSBsaXN0KGFjdHVhbF9zZXEpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGV4cGVjdGVkLnNvcnQoKQogICAgICAgICAgICAgICAgYWN0dWFsLnNvcnQoKQogICAgICAgICAgICBleGNlcHQgVHlwZUVycm9yOgogICAgICAgICAgICAgICAgbWlzc2luZywgdW5leHBlY3RlZCA9IHVub3JkZXJhYmxlX2xpc3RfZGlmZmVyZW5jZShleHBlY3RlZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0dWFsKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgbWlzc2luZywgdW5leHBlY3RlZCA9IHNvcnRlZF9saXN0X2RpZmZlcmVuY2UoZXhwZWN0ZWQsIGFjdHVhbCkKICAgICAgICBlcnJvcnMgPSBbXQogICAgICAgIGlmIG1pc3Npbmc6CiAgICAgICAgICAgIGVycm9ycy5hcHBlbmQoJ0V4cGVjdGVkLCBidXQgbWlzc2luZzpcbiAgICAlcycgJQogICAgICAgICAgICAgICAgICAgICAgICAgIHNhZmVfcmVwcihtaXNzaW5nKSkKICAgICAgICBpZiB1bmV4cGVjdGVkOgogICAgICAgICAgICBlcnJvcnMuYXBwZW5kKCdVbmV4cGVjdGVkLCBidXQgcHJlc2VudDpcbiAgICAlcycgJQogICAgICAgICAgICAgICAgICAgICAgICAgIHNhZmVfcmVwcih1bmV4cGVjdGVkKSkKICAgICAgICBpZiBlcnJvcnM6CiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJ1xuJy5qb2luKGVycm9ycykKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgoKICAgIGRlZiBhc3NlcnRDb3VudEVxdWFsKHNlbGYsIGZpcnN0LCBzZWNvbmQsIG1zZz1Ob25lKToKICAgICAgICAiIiJBbiB1bm9yZGVyZWQgc2VxdWVuY2UgY29tcGFyaXNvbiBhc3NlcnRpbmcgdGhhdCB0aGUgc2FtZSBlbGVtZW50cywKICAgICAgICByZWdhcmRsZXNzIG9mIG9yZGVyLiAgSWYgdGhlIHNhbWUgZWxlbWVudCBvY2N1cnMgbW9yZSB0aGFuIG9uY2UsCiAgICAgICAgaXQgdmVyaWZpZXMgdGhhdCB0aGUgZWxlbWVudHMgb2NjdXIgdGhlIHNhbWUgbnVtYmVyIG9mIHRpbWVzLgoKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChDb3VudGVyKGxpc3QoZmlyc3QpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb3VudGVyKGxpc3Qoc2Vjb25kKSkpCgogICAgICAgICBFeGFtcGxlOgogICAgICAgICAgICAtIFswLCAxLCAxXSBhbmQgWzEsIDAsIDFdIGNvbXBhcmUgZXF1YWwuCiAgICAgICAgICAgIC0gWzAsIDAsIDFdIGFuZCBbMCwgMV0gY29tcGFyZSB1bmVxdWFsLgoKICAgICAgICAiIiIKICAgICAgICBmaXJzdF9zZXEsIHNlY29uZF9zZXEgPSBsaXN0KGZpcnN0KSwgbGlzdChzZWNvbmQpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBmaXJzdCA9IGNvbGxlY3Rpb25zLkNvdW50ZXIoZmlyc3Rfc2VxKQogICAgICAgICAgICBzZWNvbmQgPSBjb2xsZWN0aW9ucy5Db3VudGVyKHNlY29uZF9zZXEpCiAgICAgICAgZXhjZXB0IFR5cGVFcnJvcjoKICAgICAgICAgICAgIyBIYW5kbGUgY2FzZSB3aXRoIHVuaGFzaGFibGUgZWxlbWVudHMKICAgICAgICAgICAgZGlmZmVyZW5jZXMgPSBfY291bnRfZGlmZl9hbGxfcHVycG9zZShmaXJzdF9zZXEsIHNlY29uZF9zZXEpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgZmlyc3QgPT0gc2Vjb25kOgogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGRpZmZlcmVuY2VzID0gX2NvdW50X2RpZmZfaGFzaGFibGUoZmlyc3Rfc2VxLCBzZWNvbmRfc2VxKQoKICAgICAgICBpZiBkaWZmZXJlbmNlczoKICAgICAgICAgICAgc3RhbmRhcmRNc2cgPSAnRWxlbWVudCBjb3VudHMgd2VyZSBub3QgZXF1YWw6XG4nCiAgICAgICAgICAgIGxpbmVzID0gWydGaXJzdCBoYXMgJWQsIFNlY29uZCBoYXMgJWQ6ICAlcicgJSBkaWZmIGZvciBkaWZmIGluIGRpZmZlcmVuY2VzXQogICAgICAgICAgICBkaWZmTXNnID0gJ1xuJy5qb2luKGxpbmVzKQogICAgICAgICAgICBzdGFuZGFyZE1zZyA9IHNlbGYuX3RydW5jYXRlTWVzc2FnZShzdGFuZGFyZE1zZywgZGlmZk1zZykKICAgICAgICAgICAgbXNnID0gc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKQogICAgICAgICAgICBzZWxmLmZhaWwobXNnKQoKICAgIGRlZiBhc3NlcnRNdWx0aUxpbmVFcXVhbChzZWxmLCBmaXJzdCwgc2Vjb25kLCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiQXNzZXJ0IHRoYXQgdHdvIG11bHRpLWxpbmUgc3RyaW5ncyBhcmUgZXF1YWwuIiIiCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGZpcnN0LCBzdHIsICdGaXJzdCBhcmd1bWVudCBpcyBub3QgYSBzdHJpbmcnKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShzZWNvbmQsIHN0ciwgJ1NlY29uZCBhcmd1bWVudCBpcyBub3QgYSBzdHJpbmcnKQoKICAgICAgICBpZiBmaXJzdCAhPSBzZWNvbmQ6CiAgICAgICAgICAgICMgZG9uJ3QgdXNlIGRpZmZsaWIgaWYgdGhlIHN0cmluZ3MgYXJlIHRvbyBsb25nCiAgICAgICAgICAgIGlmIChsZW4oZmlyc3QpID4gc2VsZi5fZGlmZlRocmVzaG9sZCBvcgogICAgICAgICAgICAgICAgbGVuKHNlY29uZCkgPiBzZWxmLl9kaWZmVGhyZXNob2xkKToKICAgICAgICAgICAgICAgIHNlbGYuX2Jhc2VBc3NlcnRFcXVhbChmaXJzdCwgc2Vjb25kLCBtc2cpCiAgICAgICAgICAgIGZpcnN0bGluZXMgPSBmaXJzdC5zcGxpdGxpbmVzKFRydWUpCiAgICAgICAgICAgIHNlY29uZGxpbmVzID0gc2Vjb25kLnNwbGl0bGluZXMoVHJ1ZSkKICAgICAgICAgICAgaWYgbGVuKGZpcnN0bGluZXMpID09IDEgYW5kIGZpcnN0LnN0cmlwKCdcclxuJykgPT0gZmlyc3Q6CiAgICAgICAgICAgICAgICBmaXJzdGxpbmVzID0gW2ZpcnN0ICsgJ1xuJ10KICAgICAgICAgICAgICAgIHNlY29uZGxpbmVzID0gW3NlY29uZCArICdcbiddCiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzICE9ICVzJyAlIChzYWZlX3JlcHIoZmlyc3QsIFRydWUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKHNlY29uZCwgVHJ1ZSkpCiAgICAgICAgICAgIGRpZmYgPSAnXG4nICsgJycuam9pbihkaWZmbGliLm5kaWZmKGZpcnN0bGluZXMsIHNlY29uZGxpbmVzKSkKICAgICAgICAgICAgc3RhbmRhcmRNc2cgPSBzZWxmLl90cnVuY2F0ZU1lc3NhZ2Uoc3RhbmRhcmRNc2csIGRpZmYpCiAgICAgICAgICAgIHNlbGYuZmFpbChzZWxmLl9mb3JtYXRNZXNzYWdlKG1zZywgc3RhbmRhcmRNc2cpKQoKICAgIGRlZiBhc3NlcnRMZXNzKHNlbGYsIGEsIGIsIG1zZz1Ob25lKToKICAgICAgICAiIiJKdXN0IGxpa2Ugc2VsZi5hc3NlcnRUcnVlKGEgPCBiKSwgYnV0IHdpdGggYSBuaWNlciBkZWZhdWx0IG1lc3NhZ2UuIiIiCiAgICAgICAgaWYgbm90IGEgPCBiOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyBub3QgbGVzcyB0aGFuICVzJyAlIChzYWZlX3JlcHIoYSksIHNhZmVfcmVwcihiKSkKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydExlc3NFcXVhbChzZWxmLCBhLCBiLCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiSnVzdCBsaWtlIHNlbGYuYXNzZXJ0VHJ1ZShhIDw9IGIpLCBidXQgd2l0aCBhIG5pY2VyIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBub3QgYSA8PSBiOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyBub3QgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJyAlIChzYWZlX3JlcHIoYSksIHNhZmVfcmVwcihiKSkKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydEdyZWF0ZXIoc2VsZiwgYSwgYiwgbXNnPU5vbmUpOgogICAgICAgICIiIkp1c3QgbGlrZSBzZWxmLmFzc2VydFRydWUoYSA+IGIpLCBidXQgd2l0aCBhIG5pY2VyIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBub3QgYSA+IGI6CiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzIG5vdCBncmVhdGVyIHRoYW4gJXMnICUgKHNhZmVfcmVwcihhKSwgc2FmZV9yZXByKGIpKQogICAgICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0R3JlYXRlckVxdWFsKHNlbGYsIGEsIGIsIG1zZz1Ob25lKToKICAgICAgICAiIiJKdXN0IGxpa2Ugc2VsZi5hc3NlcnRUcnVlKGEgPj0gYiksIGJ1dCB3aXRoIGEgbmljZXIgZGVmYXVsdCBtZXNzYWdlLiIiIgogICAgICAgIGlmIG5vdCBhID49IGI6CiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzIG5vdCBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMnICUgKHNhZmVfcmVwcihhKSwgc2FmZV9yZXByKGIpKQogICAgICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0SXNOb25lKHNlbGYsIG9iaiwgbXNnPU5vbmUpOgogICAgICAgICIiIlNhbWUgYXMgc2VsZi5hc3NlcnRUcnVlKG9iaiBpcyBOb25lKSwgd2l0aCBhIG5pY2VyIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBvYmogaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzIGlzIG5vdCBOb25lJyAlIChzYWZlX3JlcHIob2JqKSwpCiAgICAgICAgICAgIHNlbGYuZmFpbChzZWxmLl9mb3JtYXRNZXNzYWdlKG1zZywgc3RhbmRhcmRNc2cpKQoKICAgIGRlZiBhc3NlcnRJc05vdE5vbmUoc2VsZiwgb2JqLCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiSW5jbHVkZWQgZm9yIHN5bW1ldHJ5IHdpdGggYXNzZXJ0SXNOb25lLiIiIgogICAgICAgIGlmIG9iaiBpcyBOb25lOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICd1bmV4cGVjdGVkbHkgTm9uZScKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydElzSW5zdGFuY2Uoc2VsZiwgb2JqLCBjbHMsIG1zZz1Ob25lKToKICAgICAgICAiIiJTYW1lIGFzIHNlbGYuYXNzZXJ0VHJ1ZShpc2luc3RhbmNlKG9iaiwgY2xzKSksIHdpdGggYSBuaWNlcgogICAgICAgIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvYmosIGNscyk6CiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzIGlzIG5vdCBhbiBpbnN0YW5jZSBvZiAlcicgJSAoc2FmZV9yZXByKG9iaiksIGNscykKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydE5vdElzSW5zdGFuY2Uoc2VsZiwgb2JqLCBjbHMsIG1zZz1Ob25lKToKICAgICAgICAiIiJJbmNsdWRlZCBmb3Igc3ltbWV0cnkgd2l0aCBhc3NlcnRJc0luc3RhbmNlLiIiIgogICAgICAgIGlmIGlzaW5zdGFuY2Uob2JqLCBjbHMpOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyBpcyBhbiBpbnN0YW5jZSBvZiAlcicgJSAoc2FmZV9yZXByKG9iaiksIGNscykKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydFJhaXNlc1JlZ2V4KHNlbGYsIGV4cGVjdGVkX2V4Y2VwdGlvbiwgZXhwZWN0ZWRfcmVnZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGFibGVfb2JqPU5vbmUsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgIiIiQXNzZXJ0cyB0aGF0IHRoZSBtZXNzYWdlIGluIGEgcmFpc2VkIGV4Y2VwdGlvbiBtYXRjaGVzIGEgcmVnZXguCgogICAgICAgIEFyZ3M6CiAgICAgICAgICAgIGV4cGVjdGVkX2V4Y2VwdGlvbjogRXhjZXB0aW9uIGNsYXNzIGV4cGVjdGVkIHRvIGJlIHJhaXNlZC4KICAgICAgICAgICAgZXhwZWN0ZWRfcmVnZXg6IFJlZ2V4IChyZSBwYXR0ZXJuIG9iamVjdCBvciBzdHJpbmcpIGV4cGVjdGVkCiAgICAgICAgICAgICAgICAgICAgdG8gYmUgZm91bmQgaW4gZXJyb3IgbWVzc2FnZS4KICAgICAgICAgICAgY2FsbGFibGVfb2JqOiBGdW5jdGlvbiB0byBiZSBjYWxsZWQuCiAgICAgICAgICAgIGFyZ3M6IEV4dHJhIGFyZ3MuCiAgICAgICAgICAgIGt3YXJnczogRXh0cmEga3dhcmdzLgogICAgICAgICIiIgogICAgICAgIGNvbnRleHQgPSBfQXNzZXJ0UmFpc2VzQ29udGV4dChleHBlY3RlZF9leGNlcHRpb24sIHNlbGYsIGNhbGxhYmxlX29iaiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWRfcmVnZXgpCiAgICAgICAgaWYgY2FsbGFibGVfb2JqIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBjb250ZXh0CiAgICAgICAgI2ZpeG1lIGJyeXRob24gc3ludGF4IGVycm9yCiAgICAgICAgI3dpdGggY29udGV4dDoKICAgICAgICAjICAgIGNhbGxhYmxlX29iaigqYXJncywgKiprd2FyZ3MpCgogICAgZGVmIGFzc2VydFdhcm5zUmVnZXgoc2VsZiwgZXhwZWN0ZWRfd2FybmluZywgZXhwZWN0ZWRfcmVnZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYWJsZV9vYmo9Tm9uZSwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAiIiJBc3NlcnRzIHRoYXQgdGhlIG1lc3NhZ2UgaW4gYSB0cmlnZ2VyZWQgd2FybmluZyBtYXRjaGVzIGEgcmVnZXhwLgogICAgICAgIEJhc2ljIGZ1bmN0aW9uaW5nIGlzIHNpbWlsYXIgdG8gYXNzZXJ0V2FybnMoKSB3aXRoIHRoZSBhZGRpdGlvbgogICAgICAgIHRoYXQgb25seSB3YXJuaW5ncyB3aG9zZSBtZXNzYWdlcyBhbHNvIG1hdGNoIHRoZSByZWd1bGFyIGV4cHJlc3Npb24KICAgICAgICBhcmUgY29uc2lkZXJlZCBzdWNjZXNzZnVsIG1hdGNoZXMuCgogICAgICAgIEFyZ3M6CiAgICAgICAgICAgIGV4cGVjdGVkX3dhcm5pbmc6IFdhcm5pbmcgY2xhc3MgZXhwZWN0ZWQgdG8gYmUgdHJpZ2dlcmVkLgogICAgICAgICAgICBleHBlY3RlZF9yZWdleDogUmVnZXggKHJlIHBhdHRlcm4gb2JqZWN0IG9yIHN0cmluZykgZXhwZWN0ZWQKICAgICAgICAgICAgICAgICAgICB0byBiZSBmb3VuZCBpbiBlcnJvciBtZXNzYWdlLgogICAgICAgICAgICBjYWxsYWJsZV9vYmo6IEZ1bmN0aW9uIHRvIGJlIGNhbGxlZC4KICAgICAgICAgICAgYXJnczogRXh0cmEgYXJncy4KICAgICAgICAgICAga3dhcmdzOiBFeHRyYSBrd2FyZ3MuCiAgICAgICAgIiIiCiAgICAgICAgY29udGV4dCA9IF9Bc3NlcnRXYXJuc0NvbnRleHQoZXhwZWN0ZWRfd2FybmluZywgc2VsZiwgY2FsbGFibGVfb2JqLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkX3JlZ2V4KQogICAgICAgIGlmIGNhbGxhYmxlX29iaiBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gY29udGV4dAogICAgICAgICNmaXhtZSBicnl0aG9uIHN5bnRheCBlcnJvcgogICAgICAgICN3aXRoIGNvbnRleHQ6CiAgICAgICAgIyAgICBjYWxsYWJsZV9vYmooKmFyZ3MsICoqa3dhcmdzKQoKICAgIGRlZiBhc3NlcnRSZWdleChzZWxmLCB0ZXh0LCBleHBlY3RlZF9yZWdleCwgbXNnPU5vbmUpOgogICAgICAgICIiIkZhaWwgdGhlIHRlc3QgdW5sZXNzIHRoZSB0ZXh0IG1hdGNoZXMgdGhlIHJlZ3VsYXIgZXhwcmVzc2lvbi4iIiIKICAgICAgICBpZiBpc2luc3RhbmNlKGV4cGVjdGVkX3JlZ2V4LCAoc3RyLCBieXRlcykpOgogICAgICAgICAgICBhc3NlcnQgZXhwZWN0ZWRfcmVnZXgsICJleHBlY3RlZF9yZWdleCBtdXN0IG5vdCBiZSBlbXB0eS4iCiAgICAgICAgICAgIGV4cGVjdGVkX3JlZ2V4ID0gcmUuY29tcGlsZShleHBlY3RlZF9yZWdleCkKICAgICAgICBpZiBub3QgZXhwZWN0ZWRfcmVnZXguc2VhcmNoKHRleHQpOgogICAgICAgICAgICBtc2cgPSBtc2cgb3IgIlJlZ2V4IGRpZG4ndCBtYXRjaCIKICAgICAgICAgICAgbXNnID0gJyVzOiAlciBub3QgZm91bmQgaW4gJXInICUgKG1zZywgZXhwZWN0ZWRfcmVnZXgucGF0dGVybiwgdGV4dCkKICAgICAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKG1zZykKCiAgICBkZWYgYXNzZXJ0Tm90UmVnZXgoc2VsZiwgdGV4dCwgdW5leHBlY3RlZF9yZWdleCwgbXNnPU5vbmUpOgogICAgICAgICIiIkZhaWwgdGhlIHRlc3QgaWYgdGhlIHRleHQgbWF0Y2hlcyB0aGUgcmVndWxhciBleHByZXNzaW9uLiIiIgogICAgICAgIGlmIGlzaW5zdGFuY2UodW5leHBlY3RlZF9yZWdleCwgKHN0ciwgYnl0ZXMpKToKICAgICAgICAgICAgdW5leHBlY3RlZF9yZWdleCA9IHJlLmNvbXBpbGUodW5leHBlY3RlZF9yZWdleCkKICAgICAgICBtYXRjaCA9IHVuZXhwZWN0ZWRfcmVnZXguc2VhcmNoKHRleHQpCiAgICAgICAgaWYgbWF0Y2g6CiAgICAgICAgICAgIG1zZyA9IG1zZyBvciAiUmVnZXggbWF0Y2hlZCIKICAgICAgICAgICAgbXNnID0gJyVzOiAlciBtYXRjaGVzICVyIGluICVyJyAlIChtc2csCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFttYXRjaC5zdGFydCgpOm1hdGNoLmVuZCgpXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmV4cGVjdGVkX3JlZ2V4LnBhdHRlcm4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCkKICAgICAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKG1zZykKCgogICAgZGVmIF9kZXByZWNhdGUob3JpZ2luYWxfZnVuYyk6CiAgICAgICAgZGVmIGRlcHJlY2F0ZWRfZnVuYygqYXJncywgKiprd2FyZ3MpOgogICAgICAgICAgICB3YXJuaW5ncy53YXJuKAogICAgICAgICAgICAgICAgJ1BsZWFzZSB1c2UgezB9IGluc3RlYWQuJy5mb3JtYXQob3JpZ2luYWxfZnVuYy5fX25hbWVfXyksCiAgICAgICAgICAgICAgICBEZXByZWNhdGlvbldhcm5pbmcsIDIpCiAgICAgICAgICAgIHJldHVybiBvcmlnaW5hbF9mdW5jKCphcmdzLCAqKmt3YXJncykKICAgICAgICByZXR1cm4gZGVwcmVjYXRlZF9mdW5jCgogICAgIyBzZWUgIzk0MjQKICAgIGZhaWxVbmxlc3NFcXVhbCA9IGFzc2VydEVxdWFscyA9IF9kZXByZWNhdGUoYXNzZXJ0RXF1YWwpCiAgICBmYWlsSWZFcXVhbCA9IGFzc2VydE5vdEVxdWFscyA9IF9kZXByZWNhdGUoYXNzZXJ0Tm90RXF1YWwpCiAgICBmYWlsVW5sZXNzQWxtb3N0RXF1YWwgPSBhc3NlcnRBbG1vc3RFcXVhbHMgPSBfZGVwcmVjYXRlKGFzc2VydEFsbW9zdEVxdWFsKQogICAgZmFpbElmQWxtb3N0RXF1YWwgPSBhc3NlcnROb3RBbG1vc3RFcXVhbHMgPSBfZGVwcmVjYXRlKGFzc2VydE5vdEFsbW9zdEVxdWFsKQogICAgZmFpbFVubGVzcyA9IGFzc2VydF8gPSBfZGVwcmVjYXRlKGFzc2VydFRydWUpCiAgICBmYWlsVW5sZXNzUmFpc2VzID0gX2RlcHJlY2F0ZShhc3NlcnRSYWlzZXMpCiAgICBmYWlsSWYgPSBfZGVwcmVjYXRlKGFzc2VydEZhbHNlKQogICAgYXNzZXJ0UmFpc2VzUmVnZXhwID0gX2RlcHJlY2F0ZShhc3NlcnRSYWlzZXNSZWdleCkKICAgIGFzc2VydFJlZ2V4cE1hdGNoZXMgPSBfZGVwcmVjYXRlKGFzc2VydFJlZ2V4KQoKCgpjbGFzcyBGdW5jdGlvblRlc3RDYXNlKFRlc3RDYXNlKToKICAgICIiIkEgdGVzdCBjYXNlIHRoYXQgd3JhcHMgYSB0ZXN0IGZ1bmN0aW9uLgoKICAgIFRoaXMgaXMgdXNlZnVsIGZvciBzbGlwcGluZyBwcmUtZXhpc3RpbmcgdGVzdCBmdW5jdGlvbnMgaW50byB0aGUKICAgIHVuaXR0ZXN0IGZyYW1ld29yay4gT3B0aW9uYWxseSwgc2V0LXVwIGFuZCB0aWR5LXVwIGZ1bmN0aW9ucyBjYW4gYmUKICAgIHN1cHBsaWVkLiBBcyB3aXRoIFRlc3RDYXNlLCB0aGUgdGlkeS11cCAoJ3RlYXJEb3duJykgZnVuY3Rpb24gd2lsbAogICAgYWx3YXlzIGJlIGNhbGxlZCBpZiB0aGUgc2V0LXVwICgnc2V0VXAnKSBmdW5jdGlvbiByYW4gc3VjY2Vzc2Z1bGx5LgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHRlc3RGdW5jLCBzZXRVcD1Ob25lLCB0ZWFyRG93bj1Ob25lLCBkZXNjcmlwdGlvbj1Ob25lKToKICAgICAgICBzdXBlcihGdW5jdGlvblRlc3RDYXNlLCBzZWxmKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5fc2V0VXBGdW5jID0gc2V0VXAKICAgICAgICBzZWxmLl90ZWFyRG93bkZ1bmMgPSB0ZWFyRG93bgogICAgICAgIHNlbGYuX3Rlc3RGdW5jID0gdGVzdEZ1bmMKICAgICAgICBzZWxmLl9kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uCgogICAgZGVmIHNldFVwKHNlbGYpOgogICAgICAgIGlmIHNlbGYuX3NldFVwRnVuYyBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5fc2V0VXBGdW5jKCkKCiAgICBkZWYgdGVhckRvd24oc2VsZik6CiAgICAgICAgaWYgc2VsZi5fdGVhckRvd25GdW5jIGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLl90ZWFyRG93bkZ1bmMoKQoKICAgIGRlZiBydW5UZXN0KHNlbGYpOgogICAgICAgIHNlbGYuX3Rlc3RGdW5jKCkKCiAgICBkZWYgaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX3Rlc3RGdW5jLl9fbmFtZV9fCgogICAgZGVmIF9fZXFfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIHNlbGYuX19jbGFzc19fKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCgogICAgICAgIHJldHVybiBzZWxmLl9zZXRVcEZ1bmMgPT0gb3RoZXIuX3NldFVwRnVuYyBhbmQgXAogICAgICAgICAgICAgICBzZWxmLl90ZWFyRG93bkZ1bmMgPT0gb3RoZXIuX3RlYXJEb3duRnVuYyBhbmQgXAogICAgICAgICAgICAgICBzZWxmLl90ZXN0RnVuYyA9PSBvdGhlci5fdGVzdEZ1bmMgYW5kIFwKICAgICAgICAgICAgICAgc2VsZi5fZGVzY3JpcHRpb24gPT0gb3RoZXIuX2Rlc2NyaXB0aW9uCgogICAgZGVmIF9fbmVfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgcmV0dXJuIG5vdCBzZWxmID09IG90aGVyCgogICAgZGVmIF9faGFzaF9fKHNlbGYpOgogICAgICAgIHJldHVybiBoYXNoKCh0eXBlKHNlbGYpLCBzZWxmLl9zZXRVcEZ1bmMsIHNlbGYuX3RlYXJEb3duRnVuYywKICAgICAgICAgICAgICAgICAgICAgc2VsZi5fdGVzdEZ1bmMsIHNlbGYuX2Rlc2NyaXB0aW9uKSkKCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gIiVzICglcykiICUgKHN0cmNsYXNzKHNlbGYuX19jbGFzc19fKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3Rlc3RGdW5jLl9fbmFtZV9fKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gIjwlcyB0ZWM9JXM+IiAlIChzdHJjbGFzcyhzZWxmLl9fY2xhc3NfXyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl90ZXN0RnVuYykKCiAgICBkZWYgc2hvcnREZXNjcmlwdGlvbihzZWxmKToKICAgICAgICBpZiBzZWxmLl9kZXNjcmlwdGlvbiBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2Rlc2NyaXB0aW9uCiAgICAgICAgZG9jID0gc2VsZi5fdGVzdEZ1bmMuX19kb2NfXwogICAgICAgIHJldHVybiBkb2MgYW5kIGRvYy5zcGxpdCgiXG4iKVswXS5zdHJpcCgpIG9yIE5vbmUK',
'/Lib/lib_migration/unittest/loader.py':'IiIiTG9hZGluZyB1bml0dGVzdHMuIiIiCgppbXBvcnQgb3MKaW1wb3J0IHJlCmltcG9ydCBzeXMKaW1wb3J0IHRyYWNlYmFjawppbXBvcnQgdHlwZXMKaW1wb3J0IGZ1bmN0b29scwoKZnJvbSBmbm1hdGNoIGltcG9ydCBmbm1hdGNoCgpmcm9tIC4gaW1wb3J0IGNhc2UsIHN1aXRlLCB1dGlsCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKIyB3aGF0IGFib3V0IC5weWMgb3IgLnB5byAoZXRjKQojIHdlIHdvdWxkIG5lZWQgdG8gYXZvaWQgbG9hZGluZyB0aGUgc2FtZSB0ZXN0cyBtdWx0aXBsZSB0aW1lcwojIGZyb20gJy5weScsICcucHljJyAqYW5kKiAnLnB5bycKVkFMSURfTU9EVUxFX05BTUUgPSByZS5jb21waWxlKHInW19hLXpdXHcqXC5weSQnLCByZS5JR05PUkVDQVNFKQoKCmRlZiBfbWFrZV9mYWlsZWRfaW1wb3J0X3Rlc3QobmFtZSwgc3VpdGVDbGFzcyk6CiAgICBtZXNzYWdlID0gJ0ZhaWxlZCB0byBpbXBvcnQgdGVzdCBtb2R1bGU6ICVzXG4lcycgJSAobmFtZSwgdHJhY2ViYWNrLmZvcm1hdF9leGMoKSkKICAgIHJldHVybiBfbWFrZV9mYWlsZWRfdGVzdCgnTW9kdWxlSW1wb3J0RmFpbHVyZScsIG5hbWUsIEltcG9ydEVycm9yKG1lc3NhZ2UpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1aXRlQ2xhc3MpCgpkZWYgX21ha2VfZmFpbGVkX2xvYWRfdGVzdHMobmFtZSwgZXhjZXB0aW9uLCBzdWl0ZUNsYXNzKToKICAgIHJldHVybiBfbWFrZV9mYWlsZWRfdGVzdCgnTG9hZFRlc3RzRmFpbHVyZScsIG5hbWUsIGV4Y2VwdGlvbiwgc3VpdGVDbGFzcykKCmRlZiBfbWFrZV9mYWlsZWRfdGVzdChjbGFzc25hbWUsIG1ldGhvZG5hbWUsIGV4Y2VwdGlvbiwgc3VpdGVDbGFzcyk6CiAgICBkZWYgdGVzdEZhaWx1cmUoc2VsZik6CiAgICAgICAgcmFpc2UgZXhjZXB0aW9uCiAgICBhdHRycyA9IHttZXRob2RuYW1lOiB0ZXN0RmFpbHVyZX0KICAgIFRlc3RDbGFzcyA9IHR5cGUoY2xhc3NuYW1lLCAoY2FzZS5UZXN0Q2FzZSwpLCBhdHRycykKICAgIHJldHVybiBzdWl0ZUNsYXNzKChUZXN0Q2xhc3MobWV0aG9kbmFtZSksKSkKCmRlZiBfanl0aG9uX2F3YXJlX3NwbGl0ZXh0KHBhdGgpOgogICAgaWYgcGF0aC5sb3dlcigpLmVuZHN3aXRoKCckcHkuY2xhc3MnKToKICAgICAgICByZXR1cm4gcGF0aFs6LTldCiAgICByZXR1cm4gb3MucGF0aC5zcGxpdGV4dChwYXRoKVswXQoKCmNsYXNzIFRlc3RMb2FkZXIob2JqZWN0KToKICAgICIiIgogICAgVGhpcyBjbGFzcyBpcyByZXNwb25zaWJsZSBmb3IgbG9hZGluZyB0ZXN0cyBhY2NvcmRpbmcgdG8gdmFyaW91cyBjcml0ZXJpYQogICAgYW5kIHJldHVybmluZyB0aGVtIHdyYXBwZWQgaW4gYSBUZXN0U3VpdGUKICAgICIiIgogICAgdGVzdE1ldGhvZFByZWZpeCA9ICd0ZXN0JwogICAgc29ydFRlc3RNZXRob2RzVXNpbmcgPSBzdGF0aWNtZXRob2QodXRpbC50aHJlZV93YXlfY21wKQogICAgc3VpdGVDbGFzcyA9IHN1aXRlLlRlc3RTdWl0ZQogICAgX3RvcF9sZXZlbF9kaXIgPSBOb25lCgogICAgZGVmIGxvYWRUZXN0c0Zyb21UZXN0Q2FzZShzZWxmLCB0ZXN0Q2FzZUNsYXNzKToKICAgICAgICAiIiJSZXR1cm4gYSBzdWl0ZSBvZiBhbGwgdGVzdHMgY2FzZXMgY29udGFpbmVkIGluIHRlc3RDYXNlQ2xhc3MiIiIKICAgICAgICBpZiBpc3N1YmNsYXNzKHRlc3RDYXNlQ2xhc3MsIHN1aXRlLlRlc3RTdWl0ZSk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiVGVzdCBjYXNlcyBzaG91bGQgbm90IGJlIGRlcml2ZWQgZnJvbSBUZXN0U3VpdGUuIiBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBNYXliZSB5b3UgbWVhbnQgdG8gZGVyaXZlIGZyb20gVGVzdENhc2U/IikKICAgICAgICB0ZXN0Q2FzZU5hbWVzID0gc2VsZi5nZXRUZXN0Q2FzZU5hbWVzKHRlc3RDYXNlQ2xhc3MpCiAgICAgICAgaWYgbm90IHRlc3RDYXNlTmFtZXMgYW5kIGhhc2F0dHIodGVzdENhc2VDbGFzcywgJ3J1blRlc3QnKToKICAgICAgICAgICAgdGVzdENhc2VOYW1lcyA9IFsncnVuVGVzdCddCiAgICAgICAgbG9hZGVkX3N1aXRlID0gc2VsZi5zdWl0ZUNsYXNzKG1hcCh0ZXN0Q2FzZUNsYXNzLCB0ZXN0Q2FzZU5hbWVzKSkKICAgICAgICByZXR1cm4gbG9hZGVkX3N1aXRlCgogICAgZGVmIGxvYWRUZXN0c0Zyb21Nb2R1bGUoc2VsZiwgbW9kdWxlLCB1c2VfbG9hZF90ZXN0cz1UcnVlKToKICAgICAgICAiIiJSZXR1cm4gYSBzdWl0ZSBvZiBhbGwgdGVzdHMgY2FzZXMgY29udGFpbmVkIGluIHRoZSBnaXZlbiBtb2R1bGUiIiIKICAgICAgICB0ZXN0cyA9IFtdCiAgICAgICAgZm9yIG5hbWUgaW4gZGlyKG1vZHVsZSk6CiAgICAgICAgICAgIG9iaiA9IGdldGF0dHIobW9kdWxlLCBuYW1lKQogICAgICAgICAgICBpZiBpc2luc3RhbmNlKG9iaiwgdHlwZSkgYW5kIGlzc3ViY2xhc3Mob2JqLCBjYXNlLlRlc3RDYXNlKToKICAgICAgICAgICAgICAgIHRlc3RzLmFwcGVuZChzZWxmLmxvYWRUZXN0c0Zyb21UZXN0Q2FzZShvYmopKQoKICAgICAgICBsb2FkX3Rlc3RzID0gZ2V0YXR0cihtb2R1bGUsICdsb2FkX3Rlc3RzJywgTm9uZSkKICAgICAgICB0ZXN0cyA9IHNlbGYuc3VpdGVDbGFzcyh0ZXN0cykKICAgICAgICBpZiB1c2VfbG9hZF90ZXN0cyBhbmQgbG9hZF90ZXN0cyBpcyBub3QgTm9uZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRfdGVzdHMoc2VsZiwgdGVzdHMsIE5vbmUpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHJldHVybiBfbWFrZV9mYWlsZWRfbG9hZF90ZXN0cyhtb2R1bGUuX19uYW1lX18sIGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zdWl0ZUNsYXNzKQogICAgICAgIHJldHVybiB0ZXN0cwoKICAgIGRlZiBsb2FkVGVzdHNGcm9tTmFtZShzZWxmLCBuYW1lLCBtb2R1bGU9Tm9uZSk6CiAgICAgICAgIiIiUmV0dXJuIGEgc3VpdGUgb2YgYWxsIHRlc3RzIGNhc2VzIGdpdmVuIGEgc3RyaW5nIHNwZWNpZmllci4KCiAgICAgICAgVGhlIG5hbWUgbWF5IHJlc29sdmUgZWl0aGVyIHRvIGEgbW9kdWxlLCBhIHRlc3QgY2FzZSBjbGFzcywgYQogICAgICAgIHRlc3QgbWV0aG9kIHdpdGhpbiBhIHRlc3QgY2FzZSBjbGFzcywgb3IgYSBjYWxsYWJsZSBvYmplY3Qgd2hpY2gKICAgICAgICByZXR1cm5zIGEgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlLgoKICAgICAgICBUaGUgbWV0aG9kIG9wdGlvbmFsbHkgcmVzb2x2ZXMgdGhlIG5hbWVzIHJlbGF0aXZlIHRvIGEgZ2l2ZW4gbW9kdWxlLgogICAgICAgICIiIgogICAgICAgIHBhcnRzID0gbmFtZS5zcGxpdCgnLicpCiAgICAgICAgaWYgbW9kdWxlIGlzIE5vbmU6CiAgICAgICAgICAgIHBhcnRzX2NvcHkgPSBwYXJ0c1s6XQogICAgICAgICAgICB3aGlsZSBwYXJ0c19jb3B5OgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIG1vZHVsZSA9IF9faW1wb3J0X18oJy4nLmpvaW4ocGFydHNfY29weSkpCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgICAgICAgICAgICAgICAgICBkZWwgcGFydHNfY29weVstMV0KICAgICAgICAgICAgICAgICAgICBpZiBub3QgcGFydHNfY29weToKICAgICAgICAgICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgcGFydHMgPSBwYXJ0c1sxOl0KICAgICAgICBvYmogPSBtb2R1bGUKICAgICAgICBmb3IgcGFydCBpbiBwYXJ0czoKICAgICAgICAgICAgcGFyZW50LCBvYmogPSBvYmosIGdldGF0dHIob2JqLCBwYXJ0KQoKICAgICAgICBpZiBpc2luc3RhbmNlKG9iaiwgdHlwZXMuTW9kdWxlVHlwZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmxvYWRUZXN0c0Zyb21Nb2R1bGUob2JqKQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShvYmosIHR5cGUpIGFuZCBpc3N1YmNsYXNzKG9iaiwgY2FzZS5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmxvYWRUZXN0c0Zyb21UZXN0Q2FzZShvYmopCiAgICAgICAgZWxpZiAoaXNpbnN0YW5jZShvYmosIHR5cGVzLkZ1bmN0aW9uVHlwZSkgYW5kCiAgICAgICAgICAgICAgaXNpbnN0YW5jZShwYXJlbnQsIHR5cGUpIGFuZAogICAgICAgICAgICAgIGlzc3ViY2xhc3MocGFyZW50LCBjYXNlLlRlc3RDYXNlKSk6CiAgICAgICAgICAgIG5hbWUgPSBvYmouX19uYW1lX18KICAgICAgICAgICAgaW5zdCA9IHBhcmVudChuYW1lKQogICAgICAgICAgICAjIHN0YXRpYyBtZXRob2RzIGZvbGxvdyBhIGRpZmZlcmVudCBwYXRoCiAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKGdldGF0dHIoaW5zdCwgbmFtZSksIHR5cGVzLkZ1bmN0aW9uVHlwZSk6CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5zdWl0ZUNsYXNzKFtpbnN0XSkKICAgICAgICBlbGlmIGlzaW5zdGFuY2Uob2JqLCBzdWl0ZS5UZXN0U3VpdGUpOgogICAgICAgICAgICByZXR1cm4gb2JqCiAgICAgICAgaWYgY2FsbGFibGUob2JqKToKICAgICAgICAgICAgdGVzdCA9IG9iaigpCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodGVzdCwgc3VpdGUuVGVzdFN1aXRlKToKICAgICAgICAgICAgICAgIHJldHVybiB0ZXN0CiAgICAgICAgICAgIGVsaWYgaXNpbnN0YW5jZSh0ZXN0LCBjYXNlLlRlc3RDYXNlKToKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnN1aXRlQ2xhc3MoW3Rlc3RdKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJjYWxsaW5nICVzIHJldHVybmVkICVzLCBub3QgYSB0ZXN0IiAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG9iaiwgdGVzdCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJkb24ndCBrbm93IGhvdyB0byBtYWtlIHRlc3QgZnJvbTogJXMiICUgb2JqKQoKICAgIGRlZiBsb2FkVGVzdHNGcm9tTmFtZXMoc2VsZiwgbmFtZXMsIG1vZHVsZT1Ob25lKToKICAgICAgICAiIiJSZXR1cm4gYSBzdWl0ZSBvZiBhbGwgdGVzdHMgY2FzZXMgZm91bmQgdXNpbmcgdGhlIGdpdmVuIHNlcXVlbmNlCiAgICAgICAgb2Ygc3RyaW5nIHNwZWNpZmllcnMuIFNlZSAnbG9hZFRlc3RzRnJvbU5hbWUoKScuCiAgICAgICAgIiIiCiAgICAgICAgc3VpdGVzID0gW3NlbGYubG9hZFRlc3RzRnJvbU5hbWUobmFtZSwgbW9kdWxlKSBmb3IgbmFtZSBpbiBuYW1lc10KICAgICAgICByZXR1cm4gc2VsZi5zdWl0ZUNsYXNzKHN1aXRlcykKCiAgICBkZWYgZ2V0VGVzdENhc2VOYW1lcyhzZWxmLCB0ZXN0Q2FzZUNsYXNzKToKICAgICAgICAiIiJSZXR1cm4gYSBzb3J0ZWQgc2VxdWVuY2Ugb2YgbWV0aG9kIG5hbWVzIGZvdW5kIHdpdGhpbiB0ZXN0Q2FzZUNsYXNzCiAgICAgICAgIiIiCiAgICAgICAgZGVmIGlzVGVzdE1ldGhvZChhdHRybmFtZSwgdGVzdENhc2VDbGFzcz10ZXN0Q2FzZUNsYXNzLAogICAgICAgICAgICAgICAgICAgICAgICAgcHJlZml4PXNlbGYudGVzdE1ldGhvZFByZWZpeCk6CiAgICAgICAgICAgIHJldHVybiBhdHRybmFtZS5zdGFydHN3aXRoKHByZWZpeCkgYW5kIFwKICAgICAgICAgICAgICAgIGNhbGxhYmxlKGdldGF0dHIodGVzdENhc2VDbGFzcywgYXR0cm5hbWUpKQogICAgICAgIHRlc3RGbk5hbWVzID0gbGlzdChmaWx0ZXIoaXNUZXN0TWV0aG9kLCBkaXIodGVzdENhc2VDbGFzcykpKQogICAgICAgIGlmIHNlbGYuc29ydFRlc3RNZXRob2RzVXNpbmc6CiAgICAgICAgICAgIHRlc3RGbk5hbWVzLnNvcnQoa2V5PWZ1bmN0b29scy5jbXBfdG9fa2V5KHNlbGYuc29ydFRlc3RNZXRob2RzVXNpbmcpKQogICAgICAgIHJldHVybiB0ZXN0Rm5OYW1lcwoKICAgIGRlZiBkaXNjb3ZlcihzZWxmLCBzdGFydF9kaXIsIHBhdHRlcm49J3Rlc3QqLnB5JywgdG9wX2xldmVsX2Rpcj1Ob25lKToKICAgICAgICAiIiJGaW5kIGFuZCByZXR1cm4gYWxsIHRlc3QgbW9kdWxlcyBmcm9tIHRoZSBzcGVjaWZpZWQgc3RhcnQKICAgICAgICBkaXJlY3RvcnksIHJlY3Vyc2luZyBpbnRvIHN1YmRpcmVjdG9yaWVzIHRvIGZpbmQgdGhlbSBhbmQgcmV0dXJuIGFsbAogICAgICAgIHRlc3RzIGZvdW5kIHdpdGhpbiB0aGVtLiBPbmx5IHRlc3QgZmlsZXMgdGhhdCBtYXRjaCB0aGUgcGF0dGVybiB3aWxsCiAgICAgICAgYmUgbG9hZGVkLiAoVXNpbmcgc2hlbGwgc3R5bGUgcGF0dGVybiBtYXRjaGluZy4pCgogICAgICAgIEFsbCB0ZXN0IG1vZHVsZXMgbXVzdCBiZSBpbXBvcnRhYmxlIGZyb20gdGhlIHRvcCBsZXZlbCBvZiB0aGUgcHJvamVjdC4KICAgICAgICBJZiB0aGUgc3RhcnQgZGlyZWN0b3J5IGlzIG5vdCB0aGUgdG9wIGxldmVsIGRpcmVjdG9yeSB0aGVuIHRoZSB0b3AKICAgICAgICBsZXZlbCBkaXJlY3RvcnkgbXVzdCBiZSBzcGVjaWZpZWQgc2VwYXJhdGVseS4KCiAgICAgICAgSWYgYSB0ZXN0IHBhY2thZ2UgbmFtZSAoZGlyZWN0b3J5IHdpdGggJ19faW5pdF9fLnB5JykgbWF0Y2hlcyB0aGUKICAgICAgICBwYXR0ZXJuIHRoZW4gdGhlIHBhY2thZ2Ugd2lsbCBiZSBjaGVja2VkIGZvciBhICdsb2FkX3Rlc3RzJyBmdW5jdGlvbi4gSWYKICAgICAgICB0aGlzIGV4aXN0cyB0aGVuIGl0IHdpbGwgYmUgY2FsbGVkIHdpdGggbG9hZGVyLCB0ZXN0cywgcGF0dGVybi4KCiAgICAgICAgSWYgbG9hZF90ZXN0cyBleGlzdHMgdGhlbiBkaXNjb3ZlcnkgZG9lcyAgKm5vdCogcmVjdXJzZSBpbnRvIHRoZSBwYWNrYWdlLAogICAgICAgIGxvYWRfdGVzdHMgaXMgcmVzcG9uc2libGUgZm9yIGxvYWRpbmcgYWxsIHRlc3RzIGluIHRoZSBwYWNrYWdlLgoKICAgICAgICBUaGUgcGF0dGVybiBpcyBkZWxpYmVyYXRlbHkgbm90IHN0b3JlZCBhcyBhIGxvYWRlciBhdHRyaWJ1dGUgc28gdGhhdAogICAgICAgIHBhY2thZ2VzIGNhbiBjb250aW51ZSBkaXNjb3ZlcnkgdGhlbXNlbHZlcy4gdG9wX2xldmVsX2RpciBpcyBzdG9yZWQgc28KICAgICAgICBsb2FkX3Rlc3RzIGRvZXMgbm90IG5lZWQgdG8gcGFzcyB0aGlzIGFyZ3VtZW50IGluIHRvIGxvYWRlci5kaXNjb3ZlcigpLgogICAgICAgICIiIgogICAgICAgIHNldF9pbXBsaWNpdF90b3AgPSBGYWxzZQogICAgICAgIGlmIHRvcF9sZXZlbF9kaXIgaXMgTm9uZSBhbmQgc2VsZi5fdG9wX2xldmVsX2RpciBpcyBub3QgTm9uZToKICAgICAgICAgICAgIyBtYWtlIHRvcF9sZXZlbF9kaXIgb3B0aW9uYWwgaWYgY2FsbGVkIGZyb20gbG9hZF90ZXN0cyBpbiBhIHBhY2thZ2UKICAgICAgICAgICAgdG9wX2xldmVsX2RpciA9IHNlbGYuX3RvcF9sZXZlbF9kaXIKICAgICAgICBlbGlmIHRvcF9sZXZlbF9kaXIgaXMgTm9uZToKICAgICAgICAgICAgc2V0X2ltcGxpY2l0X3RvcCA9IFRydWUKICAgICAgICAgICAgdG9wX2xldmVsX2RpciA9IHN0YXJ0X2RpcgoKICAgICAgICB0b3BfbGV2ZWxfZGlyID0gb3MucGF0aC5hYnNwYXRoKHRvcF9sZXZlbF9kaXIpCgogICAgICAgIGlmIG5vdCB0b3BfbGV2ZWxfZGlyIGluIHN5cy5wYXRoOgogICAgICAgICAgICAjIGFsbCB0ZXN0IG1vZHVsZXMgbXVzdCBiZSBpbXBvcnRhYmxlIGZyb20gdGhlIHRvcCBsZXZlbCBkaXJlY3RvcnkKICAgICAgICAgICAgIyBzaG91bGQgd2UgKnVuY29uZGl0aW9uYWxseSogcHV0IHRoZSBzdGFydCBkaXJlY3RvcnkgaW4gZmlyc3QKICAgICAgICAgICAgIyBpbiBzeXMucGF0aCB0byBtaW5pbWlzZSBsaWtlbGlob29kIG9mIGNvbmZsaWN0cyBiZXR3ZWVuIGluc3RhbGxlZAogICAgICAgICAgICAjIG1vZHVsZXMgYW5kIGRldmVsb3BtZW50IHZlcnNpb25zPwogICAgICAgICAgICBzeXMucGF0aC5pbnNlcnQoMCwgdG9wX2xldmVsX2RpcikKICAgICAgICBzZWxmLl90b3BfbGV2ZWxfZGlyID0gdG9wX2xldmVsX2RpcgoKICAgICAgICBpc19ub3RfaW1wb3J0YWJsZSA9IEZhbHNlCiAgICAgICAgaWYgb3MucGF0aC5pc2Rpcihvcy5wYXRoLmFic3BhdGgoc3RhcnRfZGlyKSk6CiAgICAgICAgICAgIHN0YXJ0X2RpciA9IG9zLnBhdGguYWJzcGF0aChzdGFydF9kaXIpCiAgICAgICAgICAgIGlmIHN0YXJ0X2RpciAhPSB0b3BfbGV2ZWxfZGlyOgogICAgICAgICAgICAgICAgaXNfbm90X2ltcG9ydGFibGUgPSBub3Qgb3MucGF0aC5pc2ZpbGUob3MucGF0aC5qb2luKHN0YXJ0X2RpciwgJ19faW5pdF9fLnB5JykpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyBzdXBwb3J0IGZvciBkaXNjb3ZlcnkgZnJvbSBkb3R0ZWQgbW9kdWxlIG5hbWVzCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIF9faW1wb3J0X18oc3RhcnRfZGlyKQogICAgICAgICAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgICAgICAgICBpc19ub3RfaW1wb3J0YWJsZSA9IFRydWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRoZV9tb2R1bGUgPSBzeXMubW9kdWxlc1tzdGFydF9kaXJdCiAgICAgICAgICAgICAgICB0b3BfcGFydCA9IHN0YXJ0X2Rpci5zcGxpdCgnLicpWzBdCiAgICAgICAgICAgICAgICBzdGFydF9kaXIgPSBvcy5wYXRoLmFic3BhdGgob3MucGF0aC5kaXJuYW1lKCh0aGVfbW9kdWxlLl9fZmlsZV9fKSkpCiAgICAgICAgICAgICAgICBpZiBzZXRfaW1wbGljaXRfdG9wOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX3RvcF9sZXZlbF9kaXIgPSBzZWxmLl9nZXRfZGlyZWN0b3J5X2NvbnRhaW5pbmdfbW9kdWxlKHRvcF9wYXJ0KQogICAgICAgICAgICAgICAgICAgIHN5cy5wYXRoLnJlbW92ZSh0b3BfbGV2ZWxfZGlyKQoKICAgICAgICBpZiBpc19ub3RfaW1wb3J0YWJsZToKICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IoJ1N0YXJ0IGRpcmVjdG9yeSBpcyBub3QgaW1wb3J0YWJsZTogJXInICUgc3RhcnRfZGlyKQoKICAgICAgICB0ZXN0cyA9IGxpc3Qoc2VsZi5fZmluZF90ZXN0cyhzdGFydF9kaXIsIHBhdHRlcm4pKQogICAgICAgIHJldHVybiBzZWxmLnN1aXRlQ2xhc3ModGVzdHMpCgogICAgZGVmIF9nZXRfZGlyZWN0b3J5X2NvbnRhaW5pbmdfbW9kdWxlKHNlbGYsIG1vZHVsZV9uYW1lKToKICAgICAgICBtb2R1bGUgPSBzeXMubW9kdWxlc1ttb2R1bGVfbmFtZV0KICAgICAgICBmdWxsX3BhdGggPSBvcy5wYXRoLmFic3BhdGgobW9kdWxlLl9fZmlsZV9fKQoKICAgICAgICBpZiBvcy5wYXRoLmJhc2VuYW1lKGZ1bGxfcGF0aCkubG93ZXIoKS5zdGFydHN3aXRoKCdfX2luaXRfXy5weScpOgogICAgICAgICAgICByZXR1cm4gb3MucGF0aC5kaXJuYW1lKG9zLnBhdGguZGlybmFtZShmdWxsX3BhdGgpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgaGVyZSB3ZSBoYXZlIGJlZW4gZ2l2ZW4gYSBtb2R1bGUgcmF0aGVyIHRoYW4gYSBwYWNrYWdlIC0gc28KICAgICAgICAgICAgIyBhbGwgd2UgY2FuIGRvIGlzIHNlYXJjaCB0aGUgKnNhbWUqIGRpcmVjdG9yeSB0aGUgbW9kdWxlIGlzIGluCiAgICAgICAgICAgICMgc2hvdWxkIGFuIGV4Y2VwdGlvbiBiZSByYWlzZWQgaW5zdGVhZAogICAgICAgICAgICByZXR1cm4gb3MucGF0aC5kaXJuYW1lKGZ1bGxfcGF0aCkKCiAgICBkZWYgX2dldF9uYW1lX2Zyb21fcGF0aChzZWxmLCBwYXRoKToKICAgICAgICBwYXRoID0gX2p5dGhvbl9hd2FyZV9zcGxpdGV4dChvcy5wYXRoLm5vcm1wYXRoKHBhdGgpKQoKICAgICAgICBfcmVscGF0aCA9IG9zLnBhdGgucmVscGF0aChwYXRoLCBzZWxmLl90b3BfbGV2ZWxfZGlyKQogICAgICAgIGFzc2VydCBub3Qgb3MucGF0aC5pc2FicyhfcmVscGF0aCksICJQYXRoIG11c3QgYmUgd2l0aGluIHRoZSBwcm9qZWN0IgogICAgICAgIGFzc2VydCBub3QgX3JlbHBhdGguc3RhcnRzd2l0aCgnLi4nKSwgIlBhdGggbXVzdCBiZSB3aXRoaW4gdGhlIHByb2plY3QiCgogICAgICAgIG5hbWUgPSBfcmVscGF0aC5yZXBsYWNlKG9zLnBhdGguc2VwLCAnLicpCiAgICAgICAgcmV0dXJuIG5hbWUKCiAgICBkZWYgX2dldF9tb2R1bGVfZnJvbV9uYW1lKHNlbGYsIG5hbWUpOgogICAgICAgIF9faW1wb3J0X18obmFtZSkKICAgICAgICByZXR1cm4gc3lzLm1vZHVsZXNbbmFtZV0KCiAgICBkZWYgX21hdGNoX3BhdGgoc2VsZiwgcGF0aCwgZnVsbF9wYXRoLCBwYXR0ZXJuKToKICAgICAgICAjIG92ZXJyaWRlIHRoaXMgbWV0aG9kIHRvIHVzZSBhbHRlcm5hdGl2ZSBtYXRjaGluZyBzdHJhdGVneQogICAgICAgIHJldHVybiBmbm1hdGNoKHBhdGgsIHBhdHRlcm4pCgogICAgZGVmIF9maW5kX3Rlc3RzKHNlbGYsIHN0YXJ0X2RpciwgcGF0dGVybik6CiAgICAgICAgIiIiVXNlZCBieSBkaXNjb3ZlcnkuIFlpZWxkcyB0ZXN0IHN1aXRlcyBpdCBsb2Fkcy4iIiIKICAgICAgICBwYXRocyA9IG9zLmxpc3RkaXIoc3RhcnRfZGlyKQoKICAgICAgICBmb3IgcGF0aCBpbiBwYXRoczoKICAgICAgICAgICAgZnVsbF9wYXRoID0gb3MucGF0aC5qb2luKHN0YXJ0X2RpciwgcGF0aCkKICAgICAgICAgICAgaWYgb3MucGF0aC5pc2ZpbGUoZnVsbF9wYXRoKToKICAgICAgICAgICAgICAgIGlmIG5vdCBWQUxJRF9NT0RVTEVfTkFNRS5tYXRjaChwYXRoKToKICAgICAgICAgICAgICAgICAgICAjIHZhbGlkIFB5dGhvbiBpZGVudGlmaWVycyBvbmx5CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIGlmIG5vdCBzZWxmLl9tYXRjaF9wYXRoKHBhdGgsIGZ1bGxfcGF0aCwgcGF0dGVybik6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICMgaWYgdGhlIHRlc3QgZmlsZSBtYXRjaGVzLCBsb2FkIGl0CiAgICAgICAgICAgICAgICBuYW1lID0gc2VsZi5fZ2V0X25hbWVfZnJvbV9wYXRoKGZ1bGxfcGF0aCkKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBtb2R1bGUgPSBzZWxmLl9nZXRfbW9kdWxlX2Zyb21fbmFtZShuYW1lKQogICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgIHlpZWxkIF9tYWtlX2ZhaWxlZF9pbXBvcnRfdGVzdChuYW1lLCBzZWxmLnN1aXRlQ2xhc3MpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIG1vZF9maWxlID0gb3MucGF0aC5hYnNwYXRoKGdldGF0dHIobW9kdWxlLCAnX19maWxlX18nLCBmdWxsX3BhdGgpKQogICAgICAgICAgICAgICAgICAgIHJlYWxwYXRoID0gX2p5dGhvbl9hd2FyZV9zcGxpdGV4dChtb2RfZmlsZSkKICAgICAgICAgICAgICAgICAgICBmdWxscGF0aF9ub2V4dCA9IF9qeXRob25fYXdhcmVfc3BsaXRleHQoZnVsbF9wYXRoKQogICAgICAgICAgICAgICAgICAgIGlmIHJlYWxwYXRoLmxvd2VyKCkgIT0gZnVsbHBhdGhfbm9leHQubG93ZXIoKToKICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlX2RpciA9IG9zLnBhdGguZGlybmFtZShyZWFscGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgbW9kX25hbWUgPSBfanl0aG9uX2F3YXJlX3NwbGl0ZXh0KG9zLnBhdGguYmFzZW5hbWUoZnVsbF9wYXRoKSkKICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWRfZGlyID0gb3MucGF0aC5kaXJuYW1lKGZ1bGxfcGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgbXNnID0gKCIlciBtb2R1bGUgaW5jb3JyZWN0bHkgaW1wb3J0ZWQgZnJvbSAlci4gRXhwZWN0ZWQgJXIuICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJcyB0aGlzIG1vZHVsZSBnbG9iYWxseSBpbnN0YWxsZWQ/IikKICAgICAgICAgICAgICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IobXNnICUgKG1vZF9uYW1lLCBtb2R1bGVfZGlyLCBleHBlY3RlZF9kaXIpKQogICAgICAgICAgICAgICAgICAgIHlpZWxkIHNlbGYubG9hZFRlc3RzRnJvbU1vZHVsZShtb2R1bGUpCiAgICAgICAgICAgIGVsaWYgb3MucGF0aC5pc2RpcihmdWxsX3BhdGgpOgogICAgICAgICAgICAgICAgaWYgbm90IG9zLnBhdGguaXNmaWxlKG9zLnBhdGguam9pbihmdWxsX3BhdGgsICdfX2luaXRfXy5weScpKToKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgICAgIGxvYWRfdGVzdHMgPSBOb25lCiAgICAgICAgICAgICAgICB0ZXN0cyA9IE5vbmUKICAgICAgICAgICAgICAgIGlmIGZubWF0Y2gocGF0aCwgcGF0dGVybik6CiAgICAgICAgICAgICAgICAgICAgIyBvbmx5IGNoZWNrIGxvYWRfdGVzdHMgaWYgdGhlIHBhY2thZ2UgZGlyZWN0b3J5IGl0c2VsZiBtYXRjaGVzIHRoZSBmaWx0ZXIKICAgICAgICAgICAgICAgICAgICBuYW1lID0gc2VsZi5fZ2V0X25hbWVfZnJvbV9wYXRoKGZ1bGxfcGF0aCkKICAgICAgICAgICAgICAgICAgICBwYWNrYWdlID0gc2VsZi5fZ2V0X21vZHVsZV9mcm9tX25hbWUobmFtZSkKICAgICAgICAgICAgICAgICAgICBsb2FkX3Rlc3RzID0gZ2V0YXR0cihwYWNrYWdlLCAnbG9hZF90ZXN0cycsIE5vbmUpCiAgICAgICAgICAgICAgICAgICAgdGVzdHMgPSBzZWxmLmxvYWRUZXN0c0Zyb21Nb2R1bGUocGFja2FnZSwgdXNlX2xvYWRfdGVzdHM9RmFsc2UpCgogICAgICAgICAgICAgICAgaWYgbG9hZF90ZXN0cyBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgIGlmIHRlc3RzIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICAjIHRlc3RzIGxvYWRlZCBmcm9tIHBhY2thZ2UgZmlsZQogICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0ZXN0cwogICAgICAgICAgICAgICAgICAgICMgcmVjdXJzZSBpbnRvIHRoZSBwYWNrYWdlCiAgICAgICAgICAgICAgICAgICAgZm9yIHRlc3QgaW4gc2VsZi5fZmluZF90ZXN0cyhmdWxsX3BhdGgsIHBhdHRlcm4pOgogICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0ZXN0CiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgbG9hZF90ZXN0cyhzZWxmLCB0ZXN0cywgcGF0dGVybikKICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIF9tYWtlX2ZhaWxlZF9sb2FkX3Rlc3RzKHBhY2thZ2UuX19uYW1lX18sIGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc3VpdGVDbGFzcykKCmRlZmF1bHRUZXN0TG9hZGVyID0gVGVzdExvYWRlcigpCgoKZGVmIF9tYWtlTG9hZGVyKHByZWZpeCwgc29ydFVzaW5nLCBzdWl0ZUNsYXNzPU5vbmUpOgogICAgbG9hZGVyID0gVGVzdExvYWRlcigpCiAgICBsb2FkZXIuc29ydFRlc3RNZXRob2RzVXNpbmcgPSBzb3J0VXNpbmcKICAgIGxvYWRlci50ZXN0TWV0aG9kUHJlZml4ID0gcHJlZml4CiAgICBpZiBzdWl0ZUNsYXNzOgogICAgICAgIGxvYWRlci5zdWl0ZUNsYXNzID0gc3VpdGVDbGFzcwogICAgcmV0dXJuIGxvYWRlcgoKZGVmIGdldFRlc3RDYXNlTmFtZXModGVzdENhc2VDbGFzcywgcHJlZml4LCBzb3J0VXNpbmc9dXRpbC50aHJlZV93YXlfY21wKToKICAgIHJldHVybiBfbWFrZUxvYWRlcihwcmVmaXgsIHNvcnRVc2luZykuZ2V0VGVzdENhc2VOYW1lcyh0ZXN0Q2FzZUNsYXNzKQoKZGVmIG1ha2VTdWl0ZSh0ZXN0Q2FzZUNsYXNzLCBwcmVmaXg9J3Rlc3QnLCBzb3J0VXNpbmc9dXRpbC50aHJlZV93YXlfY21wLAogICAgICAgICAgICAgIHN1aXRlQ2xhc3M9c3VpdGUuVGVzdFN1aXRlKToKICAgIHJldHVybiBfbWFrZUxvYWRlcihwcmVmaXgsIHNvcnRVc2luZywgc3VpdGVDbGFzcykubG9hZFRlc3RzRnJvbVRlc3RDYXNlKAogICAgICAgIHRlc3RDYXNlQ2xhc3MpCgpkZWYgZmluZFRlc3RDYXNlcyhtb2R1bGUsIHByZWZpeD0ndGVzdCcsIHNvcnRVc2luZz11dGlsLnRocmVlX3dheV9jbXAsCiAgICAgICAgICAgICAgICAgIHN1aXRlQ2xhc3M9c3VpdGUuVGVzdFN1aXRlKToKICAgIHJldHVybiBfbWFrZUxvYWRlcihwcmVmaXgsIHNvcnRVc2luZywgc3VpdGVDbGFzcykubG9hZFRlc3RzRnJvbU1vZHVsZShcCiAgICAgICAgbW9kdWxlKQo=',
'/Lib/lib_migration/unittest/main.py':'IiIiVW5pdHRlc3QgbWFpbiBwcm9ncmFtIiIiCgppbXBvcnQgc3lzCmltcG9ydCBvcwojaW1wb3J0IHR5cGVzICAgIDwtLSBpcyB0aGlzIG1vZHVsZSBuZWVkZWQgZm9yIHRoaXMgbW9kdWxlPwoKZnJvbSAuIGltcG9ydCBsb2FkZXIsIHJ1bm5lcgpmcm9tIC5zaWduYWxzIGltcG9ydCBpbnN0YWxsSGFuZGxlcgoKX191bml0dGVzdCA9IFRydWUKCkZBSUxGQVNUICAgICA9ICIgIC1mLCAtLWZhaWxmYXN0ICAgU3RvcCBvbiBmaXJzdCBmYWlsdXJlXG4iCkNBVENIQlJFQUsgICA9ICIgIC1jLCAtLWNhdGNoICAgICAgQ2F0Y2ggY29udHJvbC1DIGFuZCBkaXNwbGF5IHJlc3VsdHNcbiIKQlVGRkVST1VUUFVUID0gIiAgLWIsIC0tYnVmZmVyICAgICBCdWZmZXIgc3Rkb3V0IGFuZCBzdGRlcnIgZHVyaW5nIHRlc3QgcnVuc1xuIgoKVVNBR0VfQVNfTUFJTiA9ICIiIlwKVXNhZ2U6ICUocHJvZ05hbWUpcyBbb3B0aW9uc10gW3Rlc3RzXQoKT3B0aW9uczoKICAtaCwgLS1oZWxwICAgICAgIFNob3cgdGhpcyBtZXNzYWdlCiAgLXYsIC0tdmVyYm9zZSAgICBWZXJib3NlIG91dHB1dAogIC1xLCAtLXF1aWV0ICAgICAgTWluaW1hbCBvdXRwdXQKJShmYWlsZmFzdClzJShjYXRjaGJyZWFrKXMlKGJ1ZmZlcilzCkV4YW1wbGVzOgogICUocHJvZ05hbWUpcyB0ZXN0X21vZHVsZSAgICAgICAgICAgICAgIC0gcnVuIHRlc3RzIGZyb20gdGVzdF9tb2R1bGUKICAlKHByb2dOYW1lKXMgbW9kdWxlLlRlc3RDbGFzcyAgICAgICAgICAtIHJ1biB0ZXN0cyBmcm9tIG1vZHVsZS5UZXN0Q2xhc3MKICAlKHByb2dOYW1lKXMgbW9kdWxlLkNsYXNzLnRlc3RfbWV0aG9kICAtIHJ1biBzcGVjaWZpZWQgdGVzdCBtZXRob2QKClt0ZXN0c10gY2FuIGJlIGEgbGlzdCBvZiBhbnkgbnVtYmVyIG9mIHRlc3QgbW9kdWxlcywgY2xhc3NlcyBhbmQgdGVzdAptZXRob2RzLgoKQWx0ZXJuYXRpdmUgVXNhZ2U6ICUocHJvZ05hbWUpcyBkaXNjb3ZlciBbb3B0aW9uc10KCk9wdGlvbnM6CiAgLXYsIC0tdmVyYm9zZSAgICBWZXJib3NlIG91dHB1dAolKGZhaWxmYXN0KXMlKGNhdGNoYnJlYWspcyUoYnVmZmVyKXMgIC1zIGRpcmVjdG9yeSAgICAgRGlyZWN0b3J5IHRvIHN0YXJ0IGRpc2NvdmVyeSAoJy4nIGRlZmF1bHQpCiAgLXAgcGF0dGVybiAgICAgICBQYXR0ZXJuIHRvIG1hdGNoIHRlc3QgZmlsZXMgKCd0ZXN0Ki5weScgZGVmYXVsdCkKICAtdCBkaXJlY3RvcnkgICAgIFRvcCBsZXZlbCBkaXJlY3Rvcnkgb2YgcHJvamVjdCAoZGVmYXVsdCB0bwogICAgICAgICAgICAgICAgICAgc3RhcnQgZGlyZWN0b3J5KQoKRm9yIHRlc3QgZGlzY292ZXJ5IGFsbCB0ZXN0IG1vZHVsZXMgbXVzdCBiZSBpbXBvcnRhYmxlIGZyb20gdGhlIHRvcApsZXZlbCBkaXJlY3Rvcnkgb2YgdGhlIHByb2plY3QuCiIiIgoKVVNBR0VfRlJPTV9NT0RVTEUgPSAiIiJcClVzYWdlOiAlKHByb2dOYW1lKXMgW29wdGlvbnNdIFt0ZXN0XSBbLi4uXQoKT3B0aW9uczoKICAtaCwgLS1oZWxwICAgICAgIFNob3cgdGhpcyBtZXNzYWdlCiAgLXYsIC0tdmVyYm9zZSAgICBWZXJib3NlIG91dHB1dAogIC1xLCAtLXF1aWV0ICAgICAgTWluaW1hbCBvdXRwdXQKJShmYWlsZmFzdClzJShjYXRjaGJyZWFrKXMlKGJ1ZmZlcilzCkV4YW1wbGVzOgogICUocHJvZ05hbWUpcyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIHJ1biBkZWZhdWx0IHNldCBvZiB0ZXN0cwogICUocHJvZ05hbWUpcyBNeVRlc3RTdWl0ZSAgICAgICAgICAgICAgICAgICAtIHJ1biBzdWl0ZSAnTXlUZXN0U3VpdGUnCiAgJShwcm9nTmFtZSlzIE15VGVzdENhc2UudGVzdFNvbWV0aGluZyAgICAgIC0gcnVuIE15VGVzdENhc2UudGVzdFNvbWV0aGluZwogICUocHJvZ05hbWUpcyBNeVRlc3RDYXNlICAgICAgICAgICAgICAgICAgICAtIHJ1biBhbGwgJ3Rlc3QqJyB0ZXN0IG1ldGhvZHMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbiBNeVRlc3RDYXNlCiIiIgoKZGVmIF9jb252ZXJ0X25hbWUobmFtZSk6CiAgICAjIG9uIExpbnV4IC8gTWFjIE9TIFggJ2Zvby5QWScgaXMgbm90IGltcG9ydGFibGUsIGJ1dCBvbgogICAgIyBXaW5kb3dzIGl0IGlzLiBTaW1wbGVyIHRvIGRvIGEgY2FzZSBpbnNlbnNpdGl2ZSBtYXRjaAogICAgIyBhIGJldHRlciBjaGVjayB3b3VsZCBiZSB0byBjaGVjayB0aGF0IHRoZSBuYW1lIGlzIGEKICAgICMgdmFsaWQgUHl0aG9uIG1vZHVsZSBuYW1lLgogICAgaWYgb3MucGF0aC5pc2ZpbGUobmFtZSkgYW5kIG5hbWUubG93ZXIoKS5lbmRzd2l0aCgnLnB5Jyk6CiAgICAgICAgaWYgb3MucGF0aC5pc2FicyhuYW1lKToKICAgICAgICAgICAgcmVsX3BhdGggPSBvcy5wYXRoLnJlbHBhdGgobmFtZSwgb3MuZ2V0Y3dkKCkpCiAgICAgICAgICAgIGlmIG9zLnBhdGguaXNhYnMocmVsX3BhdGgpIG9yIHJlbF9wYXRoLnN0YXJ0c3dpdGgob3MucGFyZGlyKToKICAgICAgICAgICAgICAgIHJldHVybiBuYW1lCiAgICAgICAgICAgIG5hbWUgPSByZWxfcGF0aAogICAgICAgICMgb24gV2luZG93cyBib3RoICdcJyBhbmQgJy8nIGFyZSB1c2VkIGFzIHBhdGgKICAgICAgICAjIHNlcGFyYXRvcnMuIEJldHRlciB0byByZXBsYWNlIGJvdGggdGhhbiByZWx5IG9uIG9zLnBhdGguc2VwCiAgICAgICAgcmV0dXJuIG5hbWVbOi0zXS5yZXBsYWNlKCdcXCcsICcuJykucmVwbGFjZSgnLycsICcuJykKICAgIHJldHVybiBuYW1lCgpkZWYgX2NvbnZlcnRfbmFtZXMobmFtZXMpOgogICAgcmV0dXJuIFtfY29udmVydF9uYW1lKG5hbWUpIGZvciBuYW1lIGluIG5hbWVzXQoKY2xhc3MgVGVzdFByb2dyYW0ob2JqZWN0KToKICAgICIiIkEgY29tbWFuZC1saW5lIHByb2dyYW0gdGhhdCBydW5zIGEgc2V0IG9mIHRlc3RzOyB0aGlzIGlzIHByaW1hcmlseQogICAgICAgZm9yIG1ha2luZyB0ZXN0IG1vZHVsZXMgY29udmVuaWVudGx5IGV4ZWN1dGFibGUuCiAgICAiIiIKICAgIFVTQUdFID0gVVNBR0VfRlJPTV9NT0RVTEUKCiAgICAjIGRlZmF1bHRzIGZvciB0ZXN0aW5nCiAgICBmYWlsZmFzdCA9IGNhdGNoYnJlYWsgPSBidWZmZXIgPSBwcm9nTmFtZSA9IHdhcm5pbmdzID0gTm9uZQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBtb2R1bGU9J19fbWFpbl9fJywgZGVmYXVsdFRlc3Q9Tm9uZSwgYXJndj1Ob25lLAogICAgICAgICAgICAgICAgICAgIHRlc3RSdW5uZXI9Tm9uZSwgdGVzdExvYWRlcj1sb2FkZXIuZGVmYXVsdFRlc3RMb2FkZXIsCiAgICAgICAgICAgICAgICAgICAgZXhpdD1UcnVlLCB2ZXJib3NpdHk9MSwgZmFpbGZhc3Q9Tm9uZSwgY2F0Y2hicmVhaz1Ob25lLAogICAgICAgICAgICAgICAgICAgIGJ1ZmZlcj1Ob25lLCB3YXJuaW5ncz1Ob25lKToKICAgICAgICBpZiBpc2luc3RhbmNlKG1vZHVsZSwgc3RyKToKICAgICAgICAgICAgc2VsZi5tb2R1bGUgPSBfX2ltcG9ydF9fKG1vZHVsZSkKICAgICAgICAgICAgZm9yIHBhcnQgaW4gbW9kdWxlLnNwbGl0KCcuJylbMTpdOgogICAgICAgICAgICAgICAgc2VsZi5tb2R1bGUgPSBnZXRhdHRyKHNlbGYubW9kdWxlLCBwYXJ0KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYubW9kdWxlID0gbW9kdWxlCiAgICAgICAgaWYgYXJndiBpcyBOb25lOgogICAgICAgICAgICBhcmd2ID0gc3lzLmFyZ3YKCiAgICAgICAgc2VsZi5leGl0ID0gZXhpdAogICAgICAgIHNlbGYuZmFpbGZhc3QgPSBmYWlsZmFzdAogICAgICAgIHNlbGYuY2F0Y2hicmVhayA9IGNhdGNoYnJlYWsKICAgICAgICBzZWxmLnZlcmJvc2l0eSA9IHZlcmJvc2l0eQogICAgICAgIHNlbGYuYnVmZmVyID0gYnVmZmVyCiAgICAgICAgaWYgd2FybmluZ3MgaXMgTm9uZSBhbmQgbm90IHN5cy53YXJub3B0aW9uczoKICAgICAgICAgICAgIyBldmVuIGlmIERyZXByZWNhdGlvbldhcm5pbmdzIGFyZSBpZ25vcmVkIGJ5IGRlZmF1bHQKICAgICAgICAgICAgIyBwcmludCB0aGVtIGFueXdheSB1bmxlc3Mgb3RoZXIgd2FybmluZ3Mgc2V0dGluZ3MgYXJlCiAgICAgICAgICAgICMgc3BlY2lmaWVkIGJ5IHRoZSB3YXJuaW5ncyBhcmcgb3IgdGhlIC1XIHB5dGhvbiBmbGFnCiAgICAgICAgICAgIHNlbGYud2FybmluZ3MgPSAnZGVmYXVsdCcKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIGhlcmUgc2VsZi53YXJuaW5ncyBpcyBzZXQgZWl0aGVyIHRvIHRoZSB2YWx1ZSBwYXNzZWQKICAgICAgICAgICAgIyB0byB0aGUgd2FybmluZ3MgYXJncyBvciB0byBOb25lLgogICAgICAgICAgICAjIElmIHRoZSB1c2VyIGRpZG4ndCBwYXNzIGEgdmFsdWUgc2VsZi53YXJuaW5ncyB3aWxsCiAgICAgICAgICAgICMgYmUgTm9uZS4gVGhpcyBtZWFucyB0aGF0IHRoZSBiZWhhdmlvciBpcyB1bmNoYW5nZWQKICAgICAgICAgICAgIyBhbmQgZGVwZW5kcyBvbiB0aGUgdmFsdWVzIHBhc3NlZCB0byAtVy4KICAgICAgICAgICAgc2VsZi53YXJuaW5ncyA9IHdhcm5pbmdzCiAgICAgICAgc2VsZi5kZWZhdWx0VGVzdCA9IGRlZmF1bHRUZXN0CiAgICAgICAgc2VsZi50ZXN0UnVubmVyID0gdGVzdFJ1bm5lcgogICAgICAgIHNlbGYudGVzdExvYWRlciA9IHRlc3RMb2FkZXIKICAgICAgICBzZWxmLnByb2dOYW1lID0gb3MucGF0aC5iYXNlbmFtZShhcmd2WzBdKQogICAgICAgIHNlbGYucGFyc2VBcmdzKGFyZ3YpCiAgICAgICAgc2VsZi5ydW5UZXN0cygpCgogICAgZGVmIHVzYWdlRXhpdChzZWxmLCBtc2c9Tm9uZSk6CiAgICAgICAgaWYgbXNnOgogICAgICAgICAgICBwcmludChtc2cpCiAgICAgICAgdXNhZ2UgPSB7J3Byb2dOYW1lJzogc2VsZi5wcm9nTmFtZSwgJ2NhdGNoYnJlYWsnOiAnJywgJ2ZhaWxmYXN0JzogJycsCiAgICAgICAgICAgICAgICAgJ2J1ZmZlcic6ICcnfQogICAgICAgIGlmIHNlbGYuZmFpbGZhc3QgIT0gRmFsc2U6CiAgICAgICAgICAgIHVzYWdlWydmYWlsZmFzdCddID0gRkFJTEZBU1QKICAgICAgICBpZiBzZWxmLmNhdGNoYnJlYWsgIT0gRmFsc2U6CiAgICAgICAgICAgIHVzYWdlWydjYXRjaGJyZWFrJ10gPSBDQVRDSEJSRUFLCiAgICAgICAgaWYgc2VsZi5idWZmZXIgIT0gRmFsc2U6CiAgICAgICAgICAgIHVzYWdlWydidWZmZXInXSA9IEJVRkZFUk9VVFBVVAogICAgICAgIHByaW50KHNlbGYuVVNBR0UgJSB1c2FnZSkKICAgICAgICBzeXMuZXhpdCgyKQoKICAgIGRlZiBwYXJzZUFyZ3Moc2VsZiwgYXJndik6CiAgICAgICAgaWYgKChsZW4oYXJndikgPiAxIGFuZCBhcmd2WzFdLmxvd2VyKCkgPT0gJ2Rpc2NvdmVyJykgb3IKICAgICAgICAgICAgKGxlbihhcmd2KSA9PSAxIGFuZCBzZWxmLm1vZHVsZSBpcyBOb25lKSk6CiAgICAgICAgICAgIHNlbGYuX2RvX2Rpc2NvdmVyeShhcmd2WzI6XSkKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGltcG9ydCBnZXRvcHQKICAgICAgICAjZml4bWUgYnJ5dGhvbiwgZXhjZXB0IHN0YXRlbWVudCBiZWxvdyBkb24ndCBsaWtlIGdldG9wdC4KICAgICAgICBnZXRvcHRfZXJyb3I9Z2V0b3B0LmVycm9yCiAgICAgICAgbG9uZ19vcHRzID0gWydoZWxwJywgJ3ZlcmJvc2UnLCAncXVpZXQnLCAnZmFpbGZhc3QnLCAnY2F0Y2gnLCAnYnVmZmVyJ10KICAgICAgICB0cnk6CiAgICAgICAgICAgIG9wdGlvbnMsIGFyZ3MgPSBnZXRvcHQuZ2V0b3B0KGFyZ3ZbMTpdLCAnaEh2cWZjYicsIGxvbmdfb3B0cykKICAgICAgICAjZml4bWUgYnJ5dGhvbiBpbnZhbGlkIHN5bnRheAogICAgICAgICNleGNlcHQgZ2V0b3B0LmVycm9yIGFzIG1zZzoKICAgICAgICBleGNlcHQgZ2V0b3B0X2Vycm9yIGFzIG1zZzoKICAgICAgICAgICAgc2VsZi51c2FnZUV4aXQobXNnKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgZm9yIG9wdCwgdmFsdWUgaW4gb3B0aW9uczoKICAgICAgICAgICAgaWYgb3B0IGluICgnLWgnLCctSCcsJy0taGVscCcpOgogICAgICAgICAgICAgICAgc2VsZi51c2FnZUV4aXQoKQogICAgICAgICAgICBpZiBvcHQgaW4gKCctcScsJy0tcXVpZXQnKToKICAgICAgICAgICAgICAgIHNlbGYudmVyYm9zaXR5ID0gMAogICAgICAgICAgICBpZiBvcHQgaW4gKCctdicsJy0tdmVyYm9zZScpOgogICAgICAgICAgICAgICAgc2VsZi52ZXJib3NpdHkgPSAyCiAgICAgICAgICAgIGlmIG9wdCBpbiAoJy1mJywnLS1mYWlsZmFzdCcpOgogICAgICAgICAgICAgICAgaWYgc2VsZi5mYWlsZmFzdCBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgIHNlbGYuZmFpbGZhc3QgPSBUcnVlCiAgICAgICAgICAgICAgICAjIFNob3VsZCB0aGlzIHJhaXNlIGFuIGV4Y2VwdGlvbiBpZiAtZiBpcyBub3QgdmFsaWQ/CiAgICAgICAgICAgIGlmIG9wdCBpbiAoJy1jJywnLS1jYXRjaCcpOgogICAgICAgICAgICAgICAgaWYgc2VsZi5jYXRjaGJyZWFrIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5jYXRjaGJyZWFrID0gVHJ1ZQogICAgICAgICAgICAgICAgIyBTaG91bGQgdGhpcyByYWlzZSBhbiBleGNlcHRpb24gaWYgLWMgaXMgbm90IHZhbGlkPwogICAgICAgICAgICBpZiBvcHQgaW4gKCctYicsJy0tYnVmZmVyJyk6CiAgICAgICAgICAgICAgICBpZiBzZWxmLmJ1ZmZlciBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgIHNlbGYuYnVmZmVyID0gVHJ1ZQogICAgICAgICAgICAgICAgIyBTaG91bGQgdGhpcyByYWlzZSBhbiBleGNlcHRpb24gaWYgLWIgaXMgbm90IHZhbGlkPwoKICAgICAgICBpZiBsZW4oYXJncykgPT0gMCBhbmQgc2VsZi5tb2R1bGUgaXMgTm9uZToKICAgICAgICAgICAgIyB0aGlzIGFsbG93cyAicHl0aG9uIC1tIHVuaXR0ZXN0IC12IiB0byBzdGlsbCB3b3JrIGZvcgogICAgICAgICAgICAjIHRlc3QgZGlzY292ZXJ5LiBUaGlzIG1lYW5zIC1jIC8gLWIgLyAtdiAvIC1mIG9wdGlvbnMgd2lsbAogICAgICAgICAgICAjIGJlIGhhbmRsZWQgdHdpY2UsIHdoaWNoIGlzIGhhcm1sZXNzIGJ1dCBub3QgaWRlYWwuCiAgICAgICAgICAgIHNlbGYuX2RvX2Rpc2NvdmVyeShhcmd2WzE6XSkKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGlmIGxlbihhcmdzKSA9PSAwIGFuZCBzZWxmLmRlZmF1bHRUZXN0IGlzIE5vbmU6CiAgICAgICAgICAgICMgY3JlYXRlVGVzdHMgd2lsbCBsb2FkIHRlc3RzIGZyb20gc2VsZi5tb2R1bGUKICAgICAgICAgICAgc2VsZi50ZXN0TmFtZXMgPSBOb25lCiAgICAgICAgZWxpZiBsZW4oYXJncykgPiAwOgogICAgICAgICAgICBzZWxmLnRlc3ROYW1lcyA9IF9jb252ZXJ0X25hbWVzKGFyZ3MpCiAgICAgICAgICAgIGlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICAgICAgICAgICAgICAjIHRvIHN1cHBvcnQgcHl0aG9uIC1tIHVuaXR0ZXN0IC4uLgogICAgICAgICAgICAgICAgc2VsZi5tb2R1bGUgPSBOb25lCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi50ZXN0TmFtZXMgPSAoc2VsZi5kZWZhdWx0VGVzdCwpCiAgICAgICAgc2VsZi5jcmVhdGVUZXN0cygpCgogICAgZGVmIGNyZWF0ZVRlc3RzKHNlbGYpOgogICAgICAgIGlmIHNlbGYudGVzdE5hbWVzIGlzIE5vbmU6CiAgICAgICAgICAgIHNlbGYudGVzdCA9IHNlbGYudGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTW9kdWxlKHNlbGYubW9kdWxlKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYudGVzdCA9IHNlbGYudGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoc2VsZi50ZXN0TmFtZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5tb2R1bGUpCgogICAgZGVmIF9kb19kaXNjb3Zlcnkoc2VsZiwgYXJndiwgTG9hZGVyPWxvYWRlci5UZXN0TG9hZGVyKToKICAgICAgICAjIGhhbmRsZSBjb21tYW5kIGxpbmUgYXJncyBmb3IgdGVzdCBkaXNjb3ZlcnkKICAgICAgICBzZWxmLnByb2dOYW1lID0gJyVzIGRpc2NvdmVyJyAlIHNlbGYucHJvZ05hbWUKICAgICAgICBpbXBvcnQgb3B0cGFyc2UKICAgICAgICBwYXJzZXIgPSBvcHRwYXJzZS5PcHRpb25QYXJzZXIoKQogICAgICAgIHBhcnNlci5wcm9nID0gc2VsZi5wcm9nTmFtZQogICAgICAgIHBhcnNlci5hZGRfb3B0aW9uKCctdicsICctLXZlcmJvc2UnLCBkZXN0PSd2ZXJib3NlJywgZGVmYXVsdD1GYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSdWZXJib3NlIG91dHB1dCcsIGFjdGlvbj0nc3RvcmVfdHJ1ZScpCiAgICAgICAgaWYgc2VsZi5mYWlsZmFzdCAhPSBGYWxzZToKICAgICAgICAgICAgcGFyc2VyLmFkZF9vcHRpb24oJy1mJywgJy0tZmFpbGZhc3QnLCBkZXN0PSdmYWlsZmFzdCcsIGRlZmF1bHQ9RmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlbHA9J1N0b3Agb24gZmlyc3QgZmFpbCBvciBlcnJvcicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbj0nc3RvcmVfdHJ1ZScpCiAgICAgICAgaWYgc2VsZi5jYXRjaGJyZWFrICE9IEZhbHNlOgogICAgICAgICAgICBwYXJzZXIuYWRkX29wdGlvbignLWMnLCAnLS1jYXRjaCcsIGRlc3Q9J2NhdGNoYnJlYWsnLCBkZWZhdWx0PUZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSdDYXRjaCBjdHJsLUMgYW5kIGRpc3BsYXkgcmVzdWx0cyBzbyBmYXInLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb249J3N0b3JlX3RydWUnKQogICAgICAgIGlmIHNlbGYuYnVmZmVyICE9IEZhbHNlOgogICAgICAgICAgICBwYXJzZXIuYWRkX29wdGlvbignLWInLCAnLS1idWZmZXInLCBkZXN0PSdidWZmZXInLCBkZWZhdWx0PUZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSdCdWZmZXIgc3Rkb3V0IGFuZCBzdGRlcnIgZHVyaW5nIHRlc3RzJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uPSdzdG9yZV90cnVlJykKICAgICAgICBwYXJzZXIuYWRkX29wdGlvbignLXMnLCAnLS1zdGFydC1kaXJlY3RvcnknLCBkZXN0PSdzdGFydCcsIGRlZmF1bHQ9Jy4nLAogICAgICAgICAgICAgICAgICAgICAgICAgIGhlbHA9IkRpcmVjdG9yeSB0byBzdGFydCBkaXNjb3ZlcnkgKCcuJyBkZWZhdWx0KSIpCiAgICAgICAgcGFyc2VyLmFkZF9vcHRpb24oJy1wJywgJy0tcGF0dGVybicsIGRlc3Q9J3BhdHRlcm4nLCBkZWZhdWx0PSd0ZXN0Ki5weScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscD0iUGF0dGVybiB0byBtYXRjaCB0ZXN0cyAoJ3Rlc3QqLnB5JyBkZWZhdWx0KSIpCiAgICAgICAgcGFyc2VyLmFkZF9vcHRpb24oJy10JywgJy0tdG9wLWxldmVsLWRpcmVjdG9yeScsIGRlc3Q9J3RvcCcsIGRlZmF1bHQ9Tm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSdUb3AgbGV2ZWwgZGlyZWN0b3J5IG9mIHByb2plY3QgKGRlZmF1bHRzIHRvIHN0YXJ0IGRpcmVjdG9yeSknKQoKICAgICAgICBvcHRpb25zLCBhcmdzID0gcGFyc2VyLnBhcnNlX2FyZ3MoYXJndikKICAgICAgICBpZiBsZW4oYXJncykgPiAzOgogICAgICAgICAgICBzZWxmLnVzYWdlRXhpdCgpCgogICAgICAgIGZvciBuYW1lLCB2YWx1ZSBpbiB6aXAoKCdzdGFydCcsICdwYXR0ZXJuJywgJ3RvcCcpLCBhcmdzKToKICAgICAgICAgICAgc2V0YXR0cihvcHRpb25zLCBuYW1lLCB2YWx1ZSkKCiAgICAgICAgIyBvbmx5IHNldCBvcHRpb25zIGZyb20gdGhlIHBhcnNpbmcgaGVyZQogICAgICAgICMgaWYgdGhleSB3ZXJlbid0IHNldCBleHBsaWNpdGx5IGluIHRoZSBjb25zdHJ1Y3RvcgogICAgICAgIGlmIHNlbGYuZmFpbGZhc3QgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5mYWlsZmFzdCA9IG9wdGlvbnMuZmFpbGZhc3QKICAgICAgICBpZiBzZWxmLmNhdGNoYnJlYWsgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5jYXRjaGJyZWFrID0gb3B0aW9ucy5jYXRjaGJyZWFrCiAgICAgICAgaWYgc2VsZi5idWZmZXIgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5idWZmZXIgPSBvcHRpb25zLmJ1ZmZlcgoKICAgICAgICBpZiBvcHRpb25zLnZlcmJvc2U6CiAgICAgICAgICAgIHNlbGYudmVyYm9zaXR5ID0gMgoKICAgICAgICBzdGFydF9kaXIgPSBvcHRpb25zLnN0YXJ0CiAgICAgICAgcGF0dGVybiA9IG9wdGlvbnMucGF0dGVybgogICAgICAgIHRvcF9sZXZlbF9kaXIgPSBvcHRpb25zLnRvcAoKICAgICAgICBsb2FkZXIgPSBMb2FkZXIoKQogICAgICAgIHNlbGYudGVzdCA9IGxvYWRlci5kaXNjb3ZlcihzdGFydF9kaXIsIHBhdHRlcm4sIHRvcF9sZXZlbF9kaXIpCgogICAgZGVmIHJ1blRlc3RzKHNlbGYpOgogICAgICAgIGlmIHNlbGYuY2F0Y2hicmVhazoKICAgICAgICAgICAgaW5zdGFsbEhhbmRsZXIoKQogICAgICAgIGlmIHNlbGYudGVzdFJ1bm5lciBpcyBOb25lOgogICAgICAgICAgICBzZWxmLnRlc3RSdW5uZXIgPSBydW5uZXIuVGV4dFRlc3RSdW5uZXIKICAgICAgICBpZiBpc2luc3RhbmNlKHNlbGYudGVzdFJ1bm5lciwgdHlwZSk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHRlc3RSdW5uZXIgPSBzZWxmLnRlc3RSdW5uZXIodmVyYm9zaXR5PXNlbGYudmVyYm9zaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWlsZmFzdD1zZWxmLmZhaWxmYXN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWZmZXI9c2VsZi5idWZmZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhcm5pbmdzPXNlbGYud2FybmluZ3MpCiAgICAgICAgICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgICAgICAgICAjIGRpZG4ndCBhY2NlcHQgdGhlIHZlcmJvc2l0eSwgYnVmZmVyIG9yIGZhaWxmYXN0IGFyZ3VtZW50cwogICAgICAgICAgICAgICAgdGVzdFJ1bm5lciA9IHNlbGYudGVzdFJ1bm5lcigpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyBpdCBpcyBhc3N1bWVkIHRvIGJlIGEgVGVzdFJ1bm5lciBpbnN0YW5jZQogICAgICAgICAgICB0ZXN0UnVubmVyID0gc2VsZi50ZXN0UnVubmVyCiAgICAgICAgc2VsZi5yZXN1bHQgPSB0ZXN0UnVubmVyLnJ1bihzZWxmLnRlc3QpCiAgICAgICAgaWYgc2VsZi5leGl0OgogICAgICAgICAgICBzeXMuZXhpdChub3Qgc2VsZi5yZXN1bHQud2FzU3VjY2Vzc2Z1bCgpKQoKbWFpbiA9IFRlc3RQcm9ncmFtCg==',
'/Lib/lib_migration/unittest/result.py':'IiIiVGVzdCByZXN1bHQgb2JqZWN0IiIiCgppbXBvcnQgb3MKaW1wb3J0IF9weWlvIGFzIGlvICAgCmltcG9ydCBzeXMKaW1wb3J0IHRyYWNlYmFjawoKI2hlbHAgbWUhCiNmcm9tIC4gaW1wb3J0IHV0aWwKZnJvbSBmdW5jdG9vbHMgaW1wb3J0IHdyYXBzCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKZGVmIGZhaWxmYXN0KG1ldGhvZCk6CiAgICBAd3JhcHMobWV0aG9kKQogICAgZGVmIGlubmVyKHNlbGYsICphcmdzLCAqKmt3KToKICAgICAgICBpZiBnZXRhdHRyKHNlbGYsICdmYWlsZmFzdCcsIEZhbHNlKToKICAgICAgICAgICAgc2VsZi5zdG9wKCkKICAgICAgICByZXR1cm4gbWV0aG9kKHNlbGYsICphcmdzLCAqKmt3KQogICAgcmV0dXJuIGlubmVyCgpTVERPVVRfTElORSA9ICdcblN0ZG91dDpcbiVzJwpTVERFUlJfTElORSA9ICdcblN0ZGVycjpcbiVzJwoKCmNsYXNzIFRlc3RSZXN1bHQob2JqZWN0KToKICAgICIiIkhvbGRlciBmb3IgdGVzdCByZXN1bHQgaW5mb3JtYXRpb24uCgogICAgVGVzdCByZXN1bHRzIGFyZSBhdXRvbWF0aWNhbGx5IG1hbmFnZWQgYnkgdGhlIFRlc3RDYXNlIGFuZCBUZXN0U3VpdGUKICAgIGNsYXNzZXMsIGFuZCBkbyBub3QgbmVlZCB0byBiZSBleHBsaWNpdGx5IG1hbmlwdWxhdGVkIGJ5IHdyaXRlcnMgb2YgdGVzdHMuCgogICAgRWFjaCBpbnN0YW5jZSBob2xkcyB0aGUgdG90YWwgbnVtYmVyIG9mIHRlc3RzIHJ1biwgYW5kIGNvbGxlY3Rpb25zIG9mCiAgICBmYWlsdXJlcyBhbmQgZXJyb3JzIHRoYXQgb2NjdXJyZWQgYW1vbmcgdGhvc2UgdGVzdCBydW5zLiBUaGUgY29sbGVjdGlvbnMKICAgIGNvbnRhaW4gdHVwbGVzIG9mICh0ZXN0Y2FzZSwgZXhjZXB0aW9uaW5mbyksIHdoZXJlIGV4Y2VwdGlvbmluZm8gaXMgdGhlCiAgICBmb3JtYXR0ZWQgdHJhY2ViYWNrIG9mIHRoZSBlcnJvciB0aGF0IG9jY3VycmVkLgogICAgIiIiCiAgICBfcHJldmlvdXNUZXN0Q2xhc3MgPSBOb25lCiAgICBfdGVzdFJ1bkVudGVyZWQgPSBGYWxzZQogICAgX21vZHVsZVNldFVwRmFpbGVkID0gRmFsc2UKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzdHJlYW09Tm9uZSwgZGVzY3JpcHRpb25zPU5vbmUsIHZlcmJvc2l0eT1Ob25lKToKICAgICAgICBzZWxmLmZhaWxmYXN0ID0gRmFsc2UKICAgICAgICBzZWxmLmZhaWx1cmVzID0gW10KICAgICAgICBzZWxmLmVycm9ycyA9IFtdCiAgICAgICAgc2VsZi50ZXN0c1J1biA9IDAKICAgICAgICBzZWxmLnNraXBwZWQgPSBbXQogICAgICAgIHNlbGYuZXhwZWN0ZWRGYWlsdXJlcyA9IFtdCiAgICAgICAgc2VsZi51bmV4cGVjdGVkU3VjY2Vzc2VzID0gW10KICAgICAgICBzZWxmLnNob3VsZFN0b3AgPSBGYWxzZQogICAgICAgIHNlbGYuYnVmZmVyID0gRmFsc2UKICAgICAgICBzZWxmLl9zdGRvdXRfYnVmZmVyID0gTm9uZQogICAgICAgIHNlbGYuX3N0ZGVycl9idWZmZXIgPSBOb25lCiAgICAgICAgc2VsZi5fb3JpZ2luYWxfc3Rkb3V0ID0gc3lzLnN0ZG91dAogICAgICAgIHNlbGYuX29yaWdpbmFsX3N0ZGVyciA9IHN5cy5zdGRlcnIKICAgICAgICBzZWxmLl9taXJyb3JPdXRwdXQgPSBGYWxzZQoKICAgIGRlZiBwcmludEVycm9ycyhzZWxmKToKICAgICAgICAiQ2FsbGVkIGJ5IFRlc3RSdW5uZXIgYWZ0ZXIgdGVzdCBydW4iCgogICAgZGVmIHN0YXJ0VGVzdChzZWxmLCB0ZXN0KToKICAgICAgICAiQ2FsbGVkIHdoZW4gdGhlIGdpdmVuIHRlc3QgaXMgYWJvdXQgdG8gYmUgcnVuIgogICAgICAgIHNlbGYudGVzdHNSdW4gKz0gMQogICAgICAgIHNlbGYuX21pcnJvck91dHB1dCA9IEZhbHNlCiAgICAgICAgc2VsZi5fc2V0dXBTdGRvdXQoKQoKICAgIGRlZiBfc2V0dXBTdGRvdXQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5idWZmZXI6CiAgICAgICAgICAgIGlmIHNlbGYuX3N0ZGVycl9idWZmZXIgaXMgTm9uZToKICAgICAgICAgICAgICAgIHNlbGYuX3N0ZGVycl9idWZmZXIgPSBpby5TdHJpbmdJTygpCiAgICAgICAgICAgICAgICBzZWxmLl9zdGRvdXRfYnVmZmVyID0gaW8uU3RyaW5nSU8oKQogICAgICAgICAgICBzeXMuc3Rkb3V0ID0gc2VsZi5fc3Rkb3V0X2J1ZmZlcgogICAgICAgICAgICBzeXMuc3RkZXJyID0gc2VsZi5fc3RkZXJyX2J1ZmZlcgoKICAgIGRlZiBzdGFydFRlc3RSdW4oc2VsZik6CiAgICAgICAgIiIiQ2FsbGVkIG9uY2UgYmVmb3JlIGFueSB0ZXN0cyBhcmUgZXhlY3V0ZWQuCgogICAgICAgIFNlZSBzdGFydFRlc3QgZm9yIGEgbWV0aG9kIGNhbGxlZCBiZWZvcmUgZWFjaCB0ZXN0LgogICAgICAgICIiIgoKICAgIGRlZiBzdG9wVGVzdChzZWxmLCB0ZXN0KToKICAgICAgICAiIiJDYWxsZWQgd2hlbiB0aGUgZ2l2ZW4gdGVzdCBoYXMgYmVlbiBydW4iIiIKICAgICAgICBzZWxmLl9yZXN0b3JlU3Rkb3V0KCkKICAgICAgICBzZWxmLl9taXJyb3JPdXRwdXQgPSBGYWxzZQoKICAgIGRlZiBfcmVzdG9yZVN0ZG91dChzZWxmKToKICAgICAgICBpZiBzZWxmLmJ1ZmZlcjoKICAgICAgICAgICAgaWYgc2VsZi5fbWlycm9yT3V0cHV0OgogICAgICAgICAgICAgICAgb3V0cHV0ID0gc3lzLnN0ZG91dC5nZXR2YWx1ZSgpCiAgICAgICAgICAgICAgICBlcnJvciA9IHN5cy5zdGRlcnIuZ2V0dmFsdWUoKQogICAgICAgICAgICAgICAgaWYgb3V0cHV0OgogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBvdXRwdXQuZW5kc3dpdGgoJ1xuJyk6CiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCArPSAnXG4nCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fb3JpZ2luYWxfc3Rkb3V0LndyaXRlKFNURE9VVF9MSU5FICUgb3V0cHV0KQogICAgICAgICAgICAgICAgaWYgZXJyb3I6CiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGVycm9yLmVuZHN3aXRoKCdcbicpOgogICAgICAgICAgICAgICAgICAgICAgICBlcnJvciArPSAnXG4nCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fb3JpZ2luYWxfc3RkZXJyLndyaXRlKFNUREVSUl9MSU5FICUgZXJyb3IpCgogICAgICAgICAgICBzeXMuc3Rkb3V0ID0gc2VsZi5fb3JpZ2luYWxfc3Rkb3V0CiAgICAgICAgICAgIHN5cy5zdGRlcnIgPSBzZWxmLl9vcmlnaW5hbF9zdGRlcnIKICAgICAgICAgICAgc2VsZi5fc3Rkb3V0X2J1ZmZlci5zZWVrKDApCiAgICAgICAgICAgIHNlbGYuX3N0ZG91dF9idWZmZXIudHJ1bmNhdGUoKQogICAgICAgICAgICBzZWxmLl9zdGRlcnJfYnVmZmVyLnNlZWsoMCkKICAgICAgICAgICAgc2VsZi5fc3RkZXJyX2J1ZmZlci50cnVuY2F0ZSgpCgogICAgZGVmIHN0b3BUZXN0UnVuKHNlbGYpOgogICAgICAgICIiIkNhbGxlZCBvbmNlIGFmdGVyIGFsbCB0ZXN0cyBhcmUgZXhlY3V0ZWQuCgogICAgICAgIFNlZSBzdG9wVGVzdCBmb3IgYSBtZXRob2QgY2FsbGVkIGFmdGVyIGVhY2ggdGVzdC4KICAgICAgICAiIiIKCiAgICBAZmFpbGZhc3QKICAgIGRlZiBhZGRFcnJvcihzZWxmLCB0ZXN0LCBlcnIpOgogICAgICAgICIiIkNhbGxlZCB3aGVuIGFuIGVycm9yIGhhcyBvY2N1cnJlZC4gJ2VycicgaXMgYSB0dXBsZSBvZiB2YWx1ZXMgYXMKICAgICAgICByZXR1cm5lZCBieSBzeXMuZXhjX2luZm8oKS4KICAgICAgICAiIiIKICAgICAgICBzZWxmLmVycm9ycy5hcHBlbmQoKHRlc3QsIHNlbGYuX2V4Y19pbmZvX3RvX3N0cmluZyhlcnIsIHRlc3QpKSkKICAgICAgICBzZWxmLl9taXJyb3JPdXRwdXQgPSBUcnVlCgogICAgQGZhaWxmYXN0CiAgICBkZWYgYWRkRmFpbHVyZShzZWxmLCB0ZXN0LCBlcnIpOgogICAgICAgICIiIkNhbGxlZCB3aGVuIGFuIGVycm9yIGhhcyBvY2N1cnJlZC4gJ2VycicgaXMgYSB0dXBsZSBvZiB2YWx1ZXMgYXMKICAgICAgICByZXR1cm5lZCBieSBzeXMuZXhjX2luZm8oKS4iIiIKICAgICAgICBzZWxmLmZhaWx1cmVzLmFwcGVuZCgodGVzdCwgc2VsZi5fZXhjX2luZm9fdG9fc3RyaW5nKGVyciwgdGVzdCkpKQogICAgICAgIHNlbGYuX21pcnJvck91dHB1dCA9IFRydWUKCiAgICBkZWYgYWRkU3VjY2VzcyhzZWxmLCB0ZXN0KToKICAgICAgICAiQ2FsbGVkIHdoZW4gYSB0ZXN0IGhhcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5IgogICAgICAgIHBhc3MKCiAgICBkZWYgYWRkU2tpcChzZWxmLCB0ZXN0LCByZWFzb24pOgogICAgICAgICIiIkNhbGxlZCB3aGVuIGEgdGVzdCBpcyBza2lwcGVkLiIiIgogICAgICAgIHNlbGYuc2tpcHBlZC5hcHBlbmQoKHRlc3QsIHJlYXNvbikpCgogICAgZGVmIGFkZEV4cGVjdGVkRmFpbHVyZShzZWxmLCB0ZXN0LCBlcnIpOgogICAgICAgICIiIkNhbGxlZCB3aGVuIGFuIGV4cGVjdGVkIGZhaWx1cmUvZXJyb3Igb2NjdXJlZC4iIiIKICAgICAgICBzZWxmLmV4cGVjdGVkRmFpbHVyZXMuYXBwZW5kKAogICAgICAgICAgICAodGVzdCwgc2VsZi5fZXhjX2luZm9fdG9fc3RyaW5nKGVyciwgdGVzdCkpKQoKICAgIEBmYWlsZmFzdAogICAgZGVmIGFkZFVuZXhwZWN0ZWRTdWNjZXNzKHNlbGYsIHRlc3QpOgogICAgICAgICIiIkNhbGxlZCB3aGVuIGEgdGVzdCB3YXMgZXhwZWN0ZWQgdG8gZmFpbCwgYnV0IHN1Y2NlZWQuIiIiCiAgICAgICAgc2VsZi51bmV4cGVjdGVkU3VjY2Vzc2VzLmFwcGVuZCh0ZXN0KQoKICAgIGRlZiB3YXNTdWNjZXNzZnVsKHNlbGYpOgogICAgICAgICJUZWxscyB3aGV0aGVyIG9yIG5vdCB0aGlzIHJlc3VsdCB3YXMgYSBzdWNjZXNzIgogICAgICAgIHJldHVybiBsZW4oc2VsZi5mYWlsdXJlcykgPT0gbGVuKHNlbGYuZXJyb3JzKSA9PSAwCgogICAgZGVmIHN0b3Aoc2VsZik6CiAgICAgICAgIkluZGljYXRlcyB0aGF0IHRoZSB0ZXN0cyBzaG91bGQgYmUgYWJvcnRlZCIKICAgICAgICBzZWxmLnNob3VsZFN0b3AgPSBUcnVlCgogICAgZGVmIF9leGNfaW5mb190b19zdHJpbmcoc2VsZiwgZXJyLCB0ZXN0KToKICAgICAgICAiIiJDb252ZXJ0cyBhIHN5cy5leGNfaW5mbygpLXN0eWxlIHR1cGxlIG9mIHZhbHVlcyBpbnRvIGEgc3RyaW5nLiIiIgogICAgICAgIHBhc3MgICAjZml4bWUgYnJ5dGhvbgoKICAgICAgICAjZXhjdHlwZSwgdmFsdWUsIHRiID0gZXJyCiAgICAgICAgIyMgU2tpcCB0ZXN0IHJ1bm5lciB0cmFjZWJhY2sgbGV2ZWxzCiAgICAgICAgI3doaWxlIHRiIGFuZCBzZWxmLl9pc19yZWxldmFudF90Yl9sZXZlbCh0Yik6CiAgICAgICAgIyAgICB0YiA9IHRiLnRiX25leHQKCiAgICAgICAgI2lmIGV4Y3R5cGUgaXMgdGVzdC5mYWlsdXJlRXhjZXB0aW9uOgogICAgICAgICMgICAgIyBTa2lwIGFzc2VydCooKSB0cmFjZWJhY2sgbGV2ZWxzCiAgICAgICAgIyAgICBsZW5ndGggPSBzZWxmLl9jb3VudF9yZWxldmFudF90Yl9sZXZlbHModGIpCiAgICAgICAgIyAgICBtc2dMaW5lcyA9IHRyYWNlYmFjay5mb3JtYXRfZXhjZXB0aW9uKGV4Y3R5cGUsIHZhbHVlLCB0YiwgbGVuZ3RoKQogICAgICAgICNlbHNlOgogICAgICAgICMgICAgbXNnTGluZXMgPSB0cmFjZWJhY2suZm9ybWF0X2V4Y2VwdGlvbihleGN0eXBlLCB2YWx1ZSwgdGIpCgogICAgICAgICNpZiBzZWxmLmJ1ZmZlcjoKICAgICAgICAjICAgIG91dHB1dCA9IHN5cy5zdGRvdXQuZ2V0dmFsdWUoKQogICAgICAgICMgICAgZXJyb3IgPSBzeXMuc3RkZXJyLmdldHZhbHVlKCkKICAgICAgICAjICAgIGlmIG91dHB1dDoKICAgICAgICAjICAgICAgICBpZiBub3Qgb3V0cHV0LmVuZHN3aXRoKCdcbicpOgogICAgICAgICMgICAgICAgICAgICBvdXRwdXQgKz0gJ1xuJwogICAgICAgICMgICAgICAgIG1zZ0xpbmVzLmFwcGVuZChTVERPVVRfTElORSAlIG91dHB1dCkKICAgICAgICAjICAgIGlmIGVycm9yOgogICAgICAgICMgICAgICAgIGlmIG5vdCBlcnJvci5lbmRzd2l0aCgnXG4nKToKICAgICAgICAjICAgICAgICAgICAgZXJyb3IgKz0gJ1xuJwogICAgICAgICMgICAgICAgIG1zZ0xpbmVzLmFwcGVuZChTVERFUlJfTElORSAlIGVycm9yKQogICAgICAgICNyZXR1cm4gJycuam9pbihtc2dMaW5lcykKCgogICAgI2RlZiBfaXNfcmVsZXZhbnRfdGJfbGV2ZWwoc2VsZiwgdGIpOgogICAgIyAgICByZXR1cm4gJ19fdW5pdHRlc3QnIGluIHRiLnRiX2ZyYW1lLmZfZ2xvYmFscwoKICAgICNkZWYgX2NvdW50X3JlbGV2YW50X3RiX2xldmVscyhzZWxmLCB0Yik6CiAgICAjICAgIGxlbmd0aCA9IDAKICAgICMgICAgd2hpbGUgdGIgYW5kIG5vdCBzZWxmLl9pc19yZWxldmFudF90Yl9sZXZlbCh0Yik6CiAgICAjICAgICAgICBsZW5ndGggKz0gMQogICAgIyAgICAgICAgdGIgPSB0Yi50Yl9uZXh0CiAgICAjICAgIHJldHVybiBsZW5ndGgKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICgiPCVzIHJ1bj0laSBlcnJvcnM9JWkgZmFpbHVyZXM9JWk+IiAlCiAgICAgICAgICAgICAgICh1dGlsLnN0cmNsYXNzKHNlbGYuX19jbGFzc19fKSwgc2VsZi50ZXN0c1J1biwgbGVuKHNlbGYuZXJyb3JzKSwKICAgICAgICAgICAgICAgIGxlbihzZWxmLmZhaWx1cmVzKSkpCg==',
'/Lib/lib_migration/unittest/runner.py':'IiIiUnVubmluZyB0ZXN0cyIiIgoKaW1wb3J0IHN5cwppbXBvcnQgdGltZQppbXBvcnQgd2FybmluZ3MKCmZyb20gLiBpbXBvcnQgcmVzdWx0CmZyb20gLnNpZ25hbHMgaW1wb3J0IHJlZ2lzdGVyUmVzdWx0CgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKCmNsYXNzIF9Xcml0ZWxuRGVjb3JhdG9yKG9iamVjdCk6CiAgICAiIiJVc2VkIHRvIGRlY29yYXRlIGZpbGUtbGlrZSBvYmplY3RzIHdpdGggYSBoYW5keSAnd3JpdGVsbicgbWV0aG9kIiIiCiAgICBkZWYgX19pbml0X18oc2VsZixzdHJlYW0pOgogICAgICAgIHNlbGYuc3RyZWFtID0gc3RyZWFtCgogICAgZGVmIF9fZ2V0YXR0cl9fKHNlbGYsIGF0dHIpOgogICAgICAgIGlmIGF0dHIgaW4gKCdzdHJlYW0nLCAnX19nZXRzdGF0ZV9fJyk6CiAgICAgICAgICAgIHJhaXNlIEF0dHJpYnV0ZUVycm9yKGF0dHIpCiAgICAgICAgcmV0dXJuIGdldGF0dHIoc2VsZi5zdHJlYW0sYXR0cikKCiAgICBkZWYgd3JpdGVsbihzZWxmLCBhcmc9Tm9uZSk6CiAgICAgICAgaWYgYXJnOgogICAgICAgICAgICBzZWxmLndyaXRlKGFyZykKICAgICAgICBzZWxmLndyaXRlKCdcbicpICMgdGV4dC1tb2RlIHN0cmVhbXMgdHJhbnNsYXRlIHRvIFxyXG4gaWYgbmVlZGVkCgoKY2xhc3MgVGV4dFRlc3RSZXN1bHQocmVzdWx0LlRlc3RSZXN1bHQpOgogICAgIiIiQSB0ZXN0IHJlc3VsdCBjbGFzcyB0aGF0IGNhbiBwcmludCBmb3JtYXR0ZWQgdGV4dCByZXN1bHRzIHRvIGEgc3RyZWFtLgoKICAgIFVzZWQgYnkgVGV4dFRlc3RSdW5uZXIuCiAgICAiIiIKICAgIHNlcGFyYXRvcjEgPSAnPScgKiA3MAogICAgc2VwYXJhdG9yMiA9ICctJyAqIDcwCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHN0cmVhbSwgZGVzY3JpcHRpb25zLCB2ZXJib3NpdHkpOgogICAgICAgIHN1cGVyKFRleHRUZXN0UmVzdWx0LCBzZWxmKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5zdHJlYW0gPSBzdHJlYW0KICAgICAgICBzZWxmLnNob3dBbGwgPSB2ZXJib3NpdHkgPiAxCiAgICAgICAgc2VsZi5kb3RzID0gdmVyYm9zaXR5ID09IDEKICAgICAgICBzZWxmLmRlc2NyaXB0aW9ucyA9IGRlc2NyaXB0aW9ucwoKICAgIGRlZiBnZXREZXNjcmlwdGlvbihzZWxmLCB0ZXN0KToKICAgICAgICBkb2NfZmlyc3RfbGluZSA9IHRlc3Quc2hvcnREZXNjcmlwdGlvbigpCiAgICAgICAgaWYgc2VsZi5kZXNjcmlwdGlvbnMgYW5kIGRvY19maXJzdF9saW5lOgogICAgICAgICAgICByZXR1cm4gJ1xuJy5qb2luKChzdHIodGVzdCksIGRvY19maXJzdF9saW5lKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gc3RyKHRlc3QpCgogICAgZGVmIHN0YXJ0VGVzdChzZWxmLCB0ZXN0KToKICAgICAgICBzdXBlcihUZXh0VGVzdFJlc3VsdCwgc2VsZikuc3RhcnRUZXN0KHRlc3QpCiAgICAgICAgaWYgc2VsZi5zaG93QWxsOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZShzZWxmLmdldERlc2NyaXB0aW9uKHRlc3QpKQogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZSgiIC4uLiAiKQogICAgICAgICAgICBzZWxmLnN0cmVhbS5mbHVzaCgpCgogICAgZGVmIGFkZFN1Y2Nlc3Moc2VsZiwgdGVzdCk6CiAgICAgICAgc3VwZXIoVGV4dFRlc3RSZXN1bHQsIHNlbGYpLmFkZFN1Y2Nlc3ModGVzdCkKICAgICAgICBpZiBzZWxmLnNob3dBbGw6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oIm9rIikKICAgICAgICBlbGlmIHNlbGYuZG90czoKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGUoJy4nKQogICAgICAgICAgICBzZWxmLnN0cmVhbS5mbHVzaCgpCgogICAgZGVmIGFkZEVycm9yKHNlbGYsIHRlc3QsIGVycik6CiAgICAgICAgc3VwZXIoVGV4dFRlc3RSZXN1bHQsIHNlbGYpLmFkZEVycm9yKHRlc3QsIGVycikKICAgICAgICBpZiBzZWxmLnNob3dBbGw6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oIkVSUk9SIikKICAgICAgICBlbGlmIHNlbGYuZG90czoKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGUoJ0UnKQogICAgICAgICAgICBzZWxmLnN0cmVhbS5mbHVzaCgpCgogICAgZGVmIGFkZEZhaWx1cmUoc2VsZiwgdGVzdCwgZXJyKToKICAgICAgICBzdXBlcihUZXh0VGVzdFJlc3VsdCwgc2VsZikuYWRkRmFpbHVyZSh0ZXN0LCBlcnIpCiAgICAgICAgaWYgc2VsZi5zaG93QWxsOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCJGQUlMIikKICAgICAgICBlbGlmIHNlbGYuZG90czoKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGUoJ0YnKQogICAgICAgICAgICBzZWxmLnN0cmVhbS5mbHVzaCgpCgogICAgZGVmIGFkZFNraXAoc2VsZiwgdGVzdCwgcmVhc29uKToKICAgICAgICBzdXBlcihUZXh0VGVzdFJlc3VsdCwgc2VsZikuYWRkU2tpcCh0ZXN0LCByZWFzb24pCiAgICAgICAgaWYgc2VsZi5zaG93QWxsOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCJza2lwcGVkIHswIXJ9Ii5mb3JtYXQocmVhc29uKSkKICAgICAgICBlbGlmIHNlbGYuZG90czoKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGUoInMiKQogICAgICAgICAgICBzZWxmLnN0cmVhbS5mbHVzaCgpCgogICAgZGVmIGFkZEV4cGVjdGVkRmFpbHVyZShzZWxmLCB0ZXN0LCBlcnIpOgogICAgICAgIHN1cGVyKFRleHRUZXN0UmVzdWx0LCBzZWxmKS5hZGRFeHBlY3RlZEZhaWx1cmUodGVzdCwgZXJyKQogICAgICAgIGlmIHNlbGYuc2hvd0FsbDoKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbigiZXhwZWN0ZWQgZmFpbHVyZSIpCiAgICAgICAgZWxpZiBzZWxmLmRvdHM6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlKCJ4IikKICAgICAgICAgICAgc2VsZi5zdHJlYW0uZmx1c2goKQoKICAgIGRlZiBhZGRVbmV4cGVjdGVkU3VjY2VzcyhzZWxmLCB0ZXN0KToKICAgICAgICBzdXBlcihUZXh0VGVzdFJlc3VsdCwgc2VsZikuYWRkVW5leHBlY3RlZFN1Y2Nlc3ModGVzdCkKICAgICAgICBpZiBzZWxmLnNob3dBbGw6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oInVuZXhwZWN0ZWQgc3VjY2VzcyIpCiAgICAgICAgZWxpZiBzZWxmLmRvdHM6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlKCJ1IikKICAgICAgICAgICAgc2VsZi5zdHJlYW0uZmx1c2goKQoKICAgIGRlZiBwcmludEVycm9ycyhzZWxmKToKICAgICAgICBpZiBzZWxmLmRvdHMgb3Igc2VsZi5zaG93QWxsOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCkKICAgICAgICBzZWxmLnByaW50RXJyb3JMaXN0KCdFUlJPUicsIHNlbGYuZXJyb3JzKQogICAgICAgIHNlbGYucHJpbnRFcnJvckxpc3QoJ0ZBSUwnLCBzZWxmLmZhaWx1cmVzKQoKICAgIGRlZiBwcmludEVycm9yTGlzdChzZWxmLCBmbGF2b3VyLCBlcnJvcnMpOgogICAgICAgIGZvciB0ZXN0LCBlcnIgaW4gZXJyb3JzOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKHNlbGYuc2VwYXJhdG9yMSkKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbigiJXM6ICVzIiAlIChmbGF2b3VyLHNlbGYuZ2V0RGVzY3JpcHRpb24odGVzdCkpKQogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKHNlbGYuc2VwYXJhdG9yMikKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbigiJXMiICUgZXJyKQoKCmNsYXNzIFRleHRUZXN0UnVubmVyKG9iamVjdCk6CiAgICAiIiJBIHRlc3QgcnVubmVyIGNsYXNzIHRoYXQgZGlzcGxheXMgcmVzdWx0cyBpbiB0ZXh0dWFsIGZvcm0uCgogICAgSXQgcHJpbnRzIG91dCB0aGUgbmFtZXMgb2YgdGVzdHMgYXMgdGhleSBhcmUgcnVuLCBlcnJvcnMgYXMgdGhleQogICAgb2NjdXIsIGFuZCBhIHN1bW1hcnkgb2YgdGhlIHJlc3VsdHMgYXQgdGhlIGVuZCBvZiB0aGUgdGVzdCBydW4uCiAgICAiIiIKICAgIHJlc3VsdGNsYXNzID0gVGV4dFRlc3RSZXN1bHQKCiAgICBkZWYgX19pbml0X18oc2VsZiwgc3RyZWFtPU5vbmUsIGRlc2NyaXB0aW9ucz1UcnVlLCB2ZXJib3NpdHk9MSwKICAgICAgICAgICAgICAgICBmYWlsZmFzdD1GYWxzZSwgYnVmZmVyPUZhbHNlLCByZXN1bHRjbGFzcz1Ob25lLCB3YXJuaW5ncz1Ob25lKToKICAgICAgICBpZiBzdHJlYW0gaXMgTm9uZToKICAgICAgICAgICAgc3RyZWFtID0gc3lzLnN0ZGVycgogICAgICAgIHNlbGYuc3RyZWFtID0gX1dyaXRlbG5EZWNvcmF0b3Ioc3RyZWFtKQogICAgICAgIHNlbGYuZGVzY3JpcHRpb25zID0gZGVzY3JpcHRpb25zCiAgICAgICAgc2VsZi52ZXJib3NpdHkgPSB2ZXJib3NpdHkKICAgICAgICBzZWxmLmZhaWxmYXN0ID0gZmFpbGZhc3QKICAgICAgICBzZWxmLmJ1ZmZlciA9IGJ1ZmZlcgogICAgICAgIHNlbGYud2FybmluZ3MgPSB3YXJuaW5ncwogICAgICAgIGlmIHJlc3VsdGNsYXNzIGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLnJlc3VsdGNsYXNzID0gcmVzdWx0Y2xhc3MKCiAgICBkZWYgX21ha2VSZXN1bHQoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYucmVzdWx0Y2xhc3Moc2VsZi5zdHJlYW0sIHNlbGYuZGVzY3JpcHRpb25zLCBzZWxmLnZlcmJvc2l0eSkKCiAgICBkZWYgcnVuKHNlbGYsIHRlc3QpOgogICAgICAgICJSdW4gdGhlIGdpdmVuIHRlc3QgY2FzZSBvciB0ZXN0IHN1aXRlLiIKICAgICAgICByZXN1bHQgPSBzZWxmLl9tYWtlUmVzdWx0KCkKICAgICAgICByZWdpc3RlclJlc3VsdChyZXN1bHQpCiAgICAgICAgcmVzdWx0LmZhaWxmYXN0ID0gc2VsZi5mYWlsZmFzdAogICAgICAgIHJlc3VsdC5idWZmZXIgPSBzZWxmLmJ1ZmZlcgogICAgICAgIHdpdGggd2FybmluZ3MuY2F0Y2hfd2FybmluZ3MoKToKICAgICAgICAgICAgaWYgc2VsZi53YXJuaW5nczoKICAgICAgICAgICAgICAgICMgaWYgc2VsZi53YXJuaW5ncyBpcyBzZXQsIHVzZSBpdCB0byBmaWx0ZXIgYWxsIHRoZSB3YXJuaW5ncwogICAgICAgICAgICAgICAgd2FybmluZ3Muc2ltcGxlZmlsdGVyKHNlbGYud2FybmluZ3MpCiAgICAgICAgICAgICAgICAjIGlmIHRoZSBmaWx0ZXIgaXMgJ2RlZmF1bHQnIG9yICdhbHdheXMnLCBzcGVjaWFsLWNhc2UgdGhlCiAgICAgICAgICAgICAgICAjIHdhcm5pbmdzIGZyb20gdGhlIGRlcHJlY2F0ZWQgdW5pdHRlc3QgbWV0aG9kcyB0byBzaG93IHRoZW0KICAgICAgICAgICAgICAgICMgbm8gbW9yZSB0aGFuIG9uY2UgcGVyIG1vZHVsZSwgYmVjYXVzZSB0aGV5IGNhbiBiZSBmYWlybHkKICAgICAgICAgICAgICAgICMgbm9pc3kuICBUaGUgLVdkIGFuZCAtV2EgZmxhZ3MgY2FuIGJlIHVzZWQgdG8gYnlwYXNzIHRoaXMKICAgICAgICAgICAgICAgICMgb25seSB3aGVuIHNlbGYud2FybmluZ3MgaXMgTm9uZS4KICAgICAgICAgICAgICAgIGlmIHNlbGYud2FybmluZ3MgaW4gWydkZWZhdWx0JywgJ2Fsd2F5cyddOgogICAgICAgICAgICAgICAgICAgIHdhcm5pbmdzLmZpbHRlcndhcm5pbmdzKCdtb2R1bGUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk9RGVwcmVjYXRpb25XYXJuaW5nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZT0nUGxlYXNlIHVzZSBhc3NlcnRcdysgaW5zdGVhZC4nKQogICAgICAgICAgICBzdGFydFRpbWUgPSB0aW1lLnRpbWUoKQogICAgICAgICAgICBzdGFydFRlc3RSdW4gPSBnZXRhdHRyKHJlc3VsdCwgJ3N0YXJ0VGVzdFJ1bicsIE5vbmUpCiAgICAgICAgICAgIGlmIHN0YXJ0VGVzdFJ1biBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHN0YXJ0VGVzdFJ1bigpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHRlc3QocmVzdWx0KQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgc3RvcFRlc3RSdW4gPSBnZXRhdHRyKHJlc3VsdCwgJ3N0b3BUZXN0UnVuJywgTm9uZSkKICAgICAgICAgICAgICAgIGlmIHN0b3BUZXN0UnVuIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIHN0b3BUZXN0UnVuKCkKICAgICAgICAgICAgc3RvcFRpbWUgPSB0aW1lLnRpbWUoKQogICAgICAgIHRpbWVUYWtlbiA9IHN0b3BUaW1lIC0gc3RhcnRUaW1lCiAgICAgICAgcmVzdWx0LnByaW50RXJyb3JzKCkKICAgICAgICBpZiBoYXNhdHRyKHJlc3VsdCwgJ3NlcGFyYXRvcjInKToKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbihyZXN1bHQuc2VwYXJhdG9yMikKICAgICAgICBydW4gPSByZXN1bHQudGVzdHNSdW4KICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCJSYW4gJWQgdGVzdCVzIGluICUuM2ZzIiAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAocnVuLCBydW4gIT0gMSBhbmQgInMiIG9yICIiLCB0aW1lVGFrZW4pKQogICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oKQoKICAgICAgICBleHBlY3RlZEZhaWxzID0gdW5leHBlY3RlZFN1Y2Nlc3NlcyA9IHNraXBwZWQgPSAwCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXN1bHRzID0gbWFwKGxlbiwgKHJlc3VsdC5leHBlY3RlZEZhaWx1cmVzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC51bmV4cGVjdGVkU3VjY2Vzc2VzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5za2lwcGVkKSkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBleHBlY3RlZEZhaWxzLCB1bmV4cGVjdGVkU3VjY2Vzc2VzLCBza2lwcGVkID0gcmVzdWx0cwoKICAgICAgICBpbmZvcyA9IFtdCiAgICAgICAgaWYgbm90IHJlc3VsdC53YXNTdWNjZXNzZnVsKCk6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlKCJGQUlMRUQiKQogICAgICAgICAgICBmYWlsZWQsIGVycm9yZWQgPSBsZW4ocmVzdWx0LmZhaWx1cmVzKSwgbGVuKHJlc3VsdC5lcnJvcnMpCiAgICAgICAgICAgIGlmIGZhaWxlZDoKICAgICAgICAgICAgICAgIGluZm9zLmFwcGVuZCgiZmFpbHVyZXM9JWQiICUgZmFpbGVkKQogICAgICAgICAgICBpZiBlcnJvcmVkOgogICAgICAgICAgICAgICAgaW5mb3MuYXBwZW5kKCJlcnJvcnM9JWQiICUgZXJyb3JlZCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZSgiT0siKQogICAgICAgIGlmIHNraXBwZWQ6CiAgICAgICAgICAgIGluZm9zLmFwcGVuZCgic2tpcHBlZD0lZCIgJSBza2lwcGVkKQogICAgICAgIGlmIGV4cGVjdGVkRmFpbHM6CiAgICAgICAgICAgIGluZm9zLmFwcGVuZCgiZXhwZWN0ZWQgZmFpbHVyZXM9JWQiICUgZXhwZWN0ZWRGYWlscykKICAgICAgICBpZiB1bmV4cGVjdGVkU3VjY2Vzc2VzOgogICAgICAgICAgICBpbmZvcy5hcHBlbmQoInVuZXhwZWN0ZWQgc3VjY2Vzc2VzPSVkIiAlIHVuZXhwZWN0ZWRTdWNjZXNzZXMpCiAgICAgICAgaWYgaW5mb3M6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oIiAoJXMpIiAlICgiLCAiLmpvaW4oaW5mb3MpLCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGUoIlxuIikKICAgICAgICByZXR1cm4gcmVzdWx0Cg==',
'/Lib/lib_migration/unittest/signals.py':'aW1wb3J0IHNpZ25hbAppbXBvcnQgd2Vha3JlZgoKZnJvbSBmdW5jdG9vbHMgaW1wb3J0IHdyYXBzCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKCmNsYXNzIF9JbnRlcnJ1cHRIYW5kbGVyKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgZGVmYXVsdF9oYW5kbGVyKToKICAgICAgICBzZWxmLmNhbGxlZCA9IEZhbHNlCiAgICAgICAgc2VsZi5kZWZhdWx0X2hhbmRsZXIgPSBkZWZhdWx0X2hhbmRsZXIKCiAgICBkZWYgX19jYWxsX18oc2VsZiwgc2lnbnVtLCBmcmFtZSk6CiAgICAgICAgaW5zdGFsbGVkX2hhbmRsZXIgPSBzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpCiAgICAgICAgaWYgaW5zdGFsbGVkX2hhbmRsZXIgaXMgbm90IHNlbGY6CiAgICAgICAgICAgICMgaWYgd2UgYXJlbid0IHRoZSBpbnN0YWxsZWQgaGFuZGxlciwgdGhlbiBkZWxlZ2F0ZSBpbW1lZGlhdGVseQogICAgICAgICAgICAjIHRvIHRoZSBkZWZhdWx0IGhhbmRsZXIKICAgICAgICAgICAgc2VsZi5kZWZhdWx0X2hhbmRsZXIoc2lnbnVtLCBmcmFtZSkKCiAgICAgICAgaWYgc2VsZi5jYWxsZWQ6CiAgICAgICAgICAgIHNlbGYuZGVmYXVsdF9oYW5kbGVyKHNpZ251bSwgZnJhbWUpCiAgICAgICAgc2VsZi5jYWxsZWQgPSBUcnVlCiAgICAgICAgZm9yIHJlc3VsdCBpbiBfcmVzdWx0cy5rZXlzKCk6CiAgICAgICAgICAgIHJlc3VsdC5zdG9wKCkKCl9yZXN1bHRzID0gd2Vha3JlZi5XZWFrS2V5RGljdGlvbmFyeSgpCmRlZiByZWdpc3RlclJlc3VsdChyZXN1bHQpOgogICAgX3Jlc3VsdHNbcmVzdWx0XSA9IDEKCmRlZiByZW1vdmVSZXN1bHQocmVzdWx0KToKICAgIHJldHVybiBib29sKF9yZXN1bHRzLnBvcChyZXN1bHQsIE5vbmUpKQoKX2ludGVycnVwdF9oYW5kbGVyID0gTm9uZQpkZWYgaW5zdGFsbEhhbmRsZXIoKToKICAgIGdsb2JhbCBfaW50ZXJydXB0X2hhbmRsZXIKICAgIGlmIF9pbnRlcnJ1cHRfaGFuZGxlciBpcyBOb25lOgogICAgICAgIGRlZmF1bHRfaGFuZGxlciA9IHNpZ25hbC5nZXRzaWduYWwoc2lnbmFsLlNJR0lOVCkKICAgICAgICBfaW50ZXJydXB0X2hhbmRsZXIgPSBfSW50ZXJydXB0SGFuZGxlcihkZWZhdWx0X2hhbmRsZXIpCiAgICAgICAgc2lnbmFsLnNpZ25hbChzaWduYWwuU0lHSU5ULCBfaW50ZXJydXB0X2hhbmRsZXIpCgoKZGVmIHJlbW92ZUhhbmRsZXIobWV0aG9kPU5vbmUpOgogICAgaWYgbWV0aG9kIGlzIG5vdCBOb25lOgogICAgICAgIEB3cmFwcyhtZXRob2QpCiAgICAgICAgZGVmIGlubmVyKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIGluaXRpYWwgPSBzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpCiAgICAgICAgICAgIHJlbW92ZUhhbmRsZXIoKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICByZXR1cm4gbWV0aG9kKCphcmdzLCAqKmt3YXJncykKICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgIHNpZ25hbC5zaWduYWwoc2lnbmFsLlNJR0lOVCwgaW5pdGlhbCkKICAgICAgICByZXR1cm4gaW5uZXIKCiAgICBnbG9iYWwgX2ludGVycnVwdF9oYW5kbGVyCiAgICBpZiBfaW50ZXJydXB0X2hhbmRsZXIgaXMgbm90IE5vbmU6CiAgICAgICAgc2lnbmFsLnNpZ25hbChzaWduYWwuU0lHSU5ULCBfaW50ZXJydXB0X2hhbmRsZXIuZGVmYXVsdF9oYW5kbGVyKQo=',
'/Lib/lib_migration/unittest/suite.py':'IiIiVGVzdFN1aXRlIiIiCgppbXBvcnQgc3lzCgpmcm9tIC4gaW1wb3J0IGNhc2UKZnJvbSAuIGltcG9ydCB1dGlsCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKCmRlZiBfY2FsbF9pZl9leGlzdHMocGFyZW50LCBhdHRyKToKICAgIGZ1bmMgPSBnZXRhdHRyKHBhcmVudCwgYXR0ciwgbGFtYmRhOiBOb25lKQogICAgZnVuYygpCgoKY2xhc3MgQmFzZVRlc3RTdWl0ZShvYmplY3QpOgogICAgIiIiQSBzaW1wbGUgdGVzdCBzdWl0ZSB0aGF0IGRvZXNuJ3QgcHJvdmlkZSBjbGFzcyBvciBtb2R1bGUgc2hhcmVkIGZpeHR1cmVzLgogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgdGVzdHM9KCkpOgogICAgICAgIHNlbGYuX3Rlc3RzID0gW10KICAgICAgICBzZWxmLmFkZFRlc3RzKHRlc3RzKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gIjwlcyB0ZXN0cz0lcz4iICUgKHV0aWwuc3RyY2xhc3Moc2VsZi5fX2NsYXNzX18pLCBsaXN0KHNlbGYpKQoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBzZWxmLl9fY2xhc3NfXyk6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAogICAgICAgIHJldHVybiBsaXN0KHNlbGYpID09IGxpc3Qob3RoZXIpCgogICAgZGVmIF9fbmVfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgcmV0dXJuIG5vdCBzZWxmID09IG90aGVyCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBpdGVyKHNlbGYuX3Rlc3RzKQoKICAgIGRlZiBjb3VudFRlc3RDYXNlcyhzZWxmKToKICAgICAgICBjYXNlcyA9IDAKICAgICAgICBmb3IgdGVzdCBpbiBzZWxmOgogICAgICAgICAgICBjYXNlcyArPSB0ZXN0LmNvdW50VGVzdENhc2VzKCkKICAgICAgICByZXR1cm4gY2FzZXMKCiAgICBkZWYgYWRkVGVzdChzZWxmLCB0ZXN0KToKICAgICAgICAjIHNhbml0eSBjaGVja3MKICAgICAgICBpZiBub3QgY2FsbGFibGUodGVzdCk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigie30gaXMgbm90IGNhbGxhYmxlIi5mb3JtYXQocmVwcih0ZXN0KSkpCiAgICAgICAgaWYgaXNpbnN0YW5jZSh0ZXN0LCB0eXBlKSBhbmQgaXNzdWJjbGFzcyh0ZXN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNhc2UuVGVzdENhc2UsIFRlc3RTdWl0ZSkpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIlRlc3RDYXNlcyBhbmQgVGVzdFN1aXRlcyBtdXN0IGJlIGluc3RhbnRpYXRlZCAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYmVmb3JlIHBhc3NpbmcgdGhlbSB0byBhZGRUZXN0KCkiKQogICAgICAgIHNlbGYuX3Rlc3RzLmFwcGVuZCh0ZXN0KQoKICAgIGRlZiBhZGRUZXN0cyhzZWxmLCB0ZXN0cyk6CiAgICAgICAgaWYgaXNpbnN0YW5jZSh0ZXN0cywgc3RyKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJ0ZXN0cyBtdXN0IGJlIGFuIGl0ZXJhYmxlIG9mIHRlc3RzLCBub3QgYSBzdHJpbmciKQogICAgICAgIGZvciB0ZXN0IGluIHRlc3RzOgogICAgICAgICAgICBzZWxmLmFkZFRlc3QodGVzdCkKCiAgICBkZWYgcnVuKHNlbGYsIHJlc3VsdCk6CiAgICAgICAgZm9yIHRlc3QgaW4gc2VsZjoKICAgICAgICAgICAgaWYgcmVzdWx0LnNob3VsZFN0b3A6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICB0ZXN0KHJlc3VsdCkKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIF9fY2FsbF9fKHNlbGYsICphcmdzLCAqKmt3ZHMpOgogICAgICAgIHJldHVybiBzZWxmLnJ1bigqYXJncywgKiprd2RzKQoKICAgIGRlZiBkZWJ1ZyhzZWxmKToKICAgICAgICAiIiJSdW4gdGhlIHRlc3RzIHdpdGhvdXQgY29sbGVjdGluZyBlcnJvcnMgaW4gYSBUZXN0UmVzdWx0IiIiCiAgICAgICAgZm9yIHRlc3QgaW4gc2VsZjoKICAgICAgICAgICAgdGVzdC5kZWJ1ZygpCgoKY2xhc3MgVGVzdFN1aXRlKEJhc2VUZXN0U3VpdGUpOgogICAgIiIiQSB0ZXN0IHN1aXRlIGlzIGEgY29tcG9zaXRlIHRlc3QgY29uc2lzdGluZyBvZiBhIG51bWJlciBvZiBUZXN0Q2FzZXMuCgogICAgRm9yIHVzZSwgY3JlYXRlIGFuIGluc3RhbmNlIG9mIFRlc3RTdWl0ZSwgdGhlbiBhZGQgdGVzdCBjYXNlIGluc3RhbmNlcy4KICAgIFdoZW4gYWxsIHRlc3RzIGhhdmUgYmVlbiBhZGRlZCwgdGhlIHN1aXRlIGNhbiBiZSBwYXNzZWQgdG8gYSB0ZXN0CiAgICBydW5uZXIsIHN1Y2ggYXMgVGV4dFRlc3RSdW5uZXIuIEl0IHdpbGwgcnVuIHRoZSBpbmRpdmlkdWFsIHRlc3QgY2FzZXMKICAgIGluIHRoZSBvcmRlciBpbiB3aGljaCB0aGV5IHdlcmUgYWRkZWQsIGFnZ3JlZ2F0aW5nIHRoZSByZXN1bHRzLiBXaGVuCiAgICBzdWJjbGFzc2luZywgZG8gbm90IGZvcmdldCB0byBjYWxsIHRoZSBiYXNlIGNsYXNzIGNvbnN0cnVjdG9yLgogICAgIiIiCgogICAgZGVmIHJ1bihzZWxmLCByZXN1bHQsIGRlYnVnPUZhbHNlKToKICAgICAgICB0b3BMZXZlbCA9IEZhbHNlCiAgICAgICAgaWYgZ2V0YXR0cihyZXN1bHQsICdfdGVzdFJ1bkVudGVyZWQnLCBGYWxzZSkgaXMgRmFsc2U6CiAgICAgICAgICAgIHJlc3VsdC5fdGVzdFJ1bkVudGVyZWQgPSB0b3BMZXZlbCA9IFRydWUKCiAgICAgICAgZm9yIHRlc3QgaW4gc2VsZjoKICAgICAgICAgICAgaWYgcmVzdWx0LnNob3VsZFN0b3A6CiAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICAgICAgaWYgX2lzbm90c3VpdGUodGVzdCk6CiAgICAgICAgICAgICAgICBzZWxmLl90ZWFyRG93blByZXZpb3VzQ2xhc3ModGVzdCwgcmVzdWx0KQogICAgICAgICAgICAgICAgc2VsZi5faGFuZGxlTW9kdWxlRml4dHVyZSh0ZXN0LCByZXN1bHQpCiAgICAgICAgICAgICAgICBzZWxmLl9oYW5kbGVDbGFzc1NldFVwKHRlc3QsIHJlc3VsdCkKICAgICAgICAgICAgICAgIHJlc3VsdC5fcHJldmlvdXNUZXN0Q2xhc3MgPSB0ZXN0Ll9fY2xhc3NfXwoKICAgICAgICAgICAgICAgIGlmIChnZXRhdHRyKHRlc3QuX19jbGFzc19fLCAnX2NsYXNzU2V0dXBGYWlsZWQnLCBGYWxzZSkgb3IKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKHJlc3VsdCwgJ19tb2R1bGVTZXRVcEZhaWxlZCcsIEZhbHNlKSk6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIGlmIG5vdCBkZWJ1ZzoKICAgICAgICAgICAgICAgIHRlc3QocmVzdWx0KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdGVzdC5kZWJ1ZygpCgogICAgICAgIGlmIHRvcExldmVsOgogICAgICAgICAgICBzZWxmLl90ZWFyRG93blByZXZpb3VzQ2xhc3MoTm9uZSwgcmVzdWx0KQogICAgICAgICAgICBzZWxmLl9oYW5kbGVNb2R1bGVUZWFyRG93bihyZXN1bHQpCiAgICAgICAgICAgIHJlc3VsdC5fdGVzdFJ1bkVudGVyZWQgPSBGYWxzZQogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgZGVidWcoc2VsZik6CiAgICAgICAgIiIiUnVuIHRoZSB0ZXN0cyB3aXRob3V0IGNvbGxlY3RpbmcgZXJyb3JzIGluIGEgVGVzdFJlc3VsdCIiIgogICAgICAgIGRlYnVnID0gX0RlYnVnUmVzdWx0KCkKICAgICAgICBzZWxmLnJ1bihkZWJ1ZywgVHJ1ZSkKCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgIGRlZiBfaGFuZGxlQ2xhc3NTZXRVcChzZWxmLCB0ZXN0LCByZXN1bHQpOgogICAgICAgIHByZXZpb3VzQ2xhc3MgPSBnZXRhdHRyKHJlc3VsdCwgJ19wcmV2aW91c1Rlc3RDbGFzcycsIE5vbmUpCiAgICAgICAgY3VycmVudENsYXNzID0gdGVzdC5fX2NsYXNzX18KICAgICAgICBpZiBjdXJyZW50Q2xhc3MgPT0gcHJldmlvdXNDbGFzczoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgcmVzdWx0Ll9tb2R1bGVTZXRVcEZhaWxlZDoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgZ2V0YXR0cihjdXJyZW50Q2xhc3MsICJfX3VuaXR0ZXN0X3NraXBfXyIsIEZhbHNlKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRyeToKICAgICAgICAgICAgY3VycmVudENsYXNzLl9jbGFzc1NldHVwRmFpbGVkID0gRmFsc2UKICAgICAgICBleGNlcHQgVHlwZUVycm9yOgogICAgICAgICAgICAjIHRlc3QgbWF5IGFjdHVhbGx5IGJlIGEgZnVuY3Rpb24KICAgICAgICAgICAgIyBzbyBpdHMgY2xhc3Mgd2lsbCBiZSBhIGJ1aWx0aW4tdHlwZQogICAgICAgICAgICBwYXNzCgogICAgICAgIHNldFVwQ2xhc3MgPSBnZXRhdHRyKGN1cnJlbnRDbGFzcywgJ3NldFVwQ2xhc3MnLCBOb25lKQogICAgICAgIGlmIHNldFVwQ2xhc3MgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIF9jYWxsX2lmX2V4aXN0cyhyZXN1bHQsICdfc2V0dXBTdGRvdXQnKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZXRVcENsYXNzKCkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShyZXN1bHQsIF9EZWJ1Z1Jlc3VsdCk6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgICAgIGN1cnJlbnRDbGFzcy5fY2xhc3NTZXR1cEZhaWxlZCA9IFRydWUKICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9IHV0aWwuc3RyY2xhc3MoY3VycmVudENsYXNzKQogICAgICAgICAgICAgICAgZXJyb3JOYW1lID0gJ3NldFVwQ2xhc3MgKCVzKScgJSBjbGFzc05hbWUKICAgICAgICAgICAgICAgIHNlbGYuX2FkZENsYXNzT3JNb2R1bGVMZXZlbEV4Y2VwdGlvbihyZXN1bHQsIGUsIGVycm9yTmFtZSkKICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgIF9jYWxsX2lmX2V4aXN0cyhyZXN1bHQsICdfcmVzdG9yZVN0ZG91dCcpCgogICAgZGVmIF9nZXRfcHJldmlvdXNfbW9kdWxlKHNlbGYsIHJlc3VsdCk6CiAgICAgICAgcHJldmlvdXNNb2R1bGUgPSBOb25lCiAgICAgICAgcHJldmlvdXNDbGFzcyA9IGdldGF0dHIocmVzdWx0LCAnX3ByZXZpb3VzVGVzdENsYXNzJywgTm9uZSkKICAgICAgICBpZiBwcmV2aW91c0NsYXNzIGlzIG5vdCBOb25lOgogICAgICAgICAgICBwcmV2aW91c01vZHVsZSA9IHByZXZpb3VzQ2xhc3MuX19tb2R1bGVfXwogICAgICAgIHJldHVybiBwcmV2aW91c01vZHVsZQoKCiAgICBkZWYgX2hhbmRsZU1vZHVsZUZpeHR1cmUoc2VsZiwgdGVzdCwgcmVzdWx0KToKICAgICAgICBwcmV2aW91c01vZHVsZSA9IHNlbGYuX2dldF9wcmV2aW91c19tb2R1bGUocmVzdWx0KQogICAgICAgIGN1cnJlbnRNb2R1bGUgPSB0ZXN0Ll9fY2xhc3NfXy5fX21vZHVsZV9fCiAgICAgICAgaWYgY3VycmVudE1vZHVsZSA9PSBwcmV2aW91c01vZHVsZToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuX2hhbmRsZU1vZHVsZVRlYXJEb3duKHJlc3VsdCkKCgogICAgICAgIHJlc3VsdC5fbW9kdWxlU2V0VXBGYWlsZWQgPSBGYWxzZQogICAgICAgIHRyeToKICAgICAgICAgICAgbW9kdWxlID0gc3lzLm1vZHVsZXNbY3VycmVudE1vZHVsZV0KICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIHNldFVwTW9kdWxlID0gZ2V0YXR0cihtb2R1bGUsICdzZXRVcE1vZHVsZScsIE5vbmUpCiAgICAgICAgaWYgc2V0VXBNb2R1bGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIF9jYWxsX2lmX2V4aXN0cyhyZXN1bHQsICdfc2V0dXBTdGRvdXQnKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZXRVcE1vZHVsZSgpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UocmVzdWx0LCBfRGVidWdSZXN1bHQpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICAgICByZXN1bHQuX21vZHVsZVNldFVwRmFpbGVkID0gVHJ1ZQogICAgICAgICAgICAgICAgZXJyb3JOYW1lID0gJ3NldFVwTW9kdWxlICglcyknICUgY3VycmVudE1vZHVsZQogICAgICAgICAgICAgICAgc2VsZi5fYWRkQ2xhc3NPck1vZHVsZUxldmVsRXhjZXB0aW9uKHJlc3VsdCwgZSwgZXJyb3JOYW1lKQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgX2NhbGxfaWZfZXhpc3RzKHJlc3VsdCwgJ19yZXN0b3JlU3Rkb3V0JykKCiAgICBkZWYgX2FkZENsYXNzT3JNb2R1bGVMZXZlbEV4Y2VwdGlvbihzZWxmLCByZXN1bHQsIGV4Y2VwdGlvbiwgZXJyb3JOYW1lKToKICAgICAgICBlcnJvciA9IF9FcnJvckhvbGRlcihlcnJvck5hbWUpCiAgICAgICAgYWRkU2tpcCA9IGdldGF0dHIocmVzdWx0LCAnYWRkU2tpcCcsIE5vbmUpCiAgICAgICAgaWYgYWRkU2tpcCBpcyBub3QgTm9uZSBhbmQgaXNpbnN0YW5jZShleGNlcHRpb24sIGNhc2UuU2tpcFRlc3QpOgogICAgICAgICAgICBhZGRTa2lwKGVycm9yLCBzdHIoZXhjZXB0aW9uKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXN1bHQuYWRkRXJyb3IoZXJyb3IsIHN5cy5leGNfaW5mbygpKQoKICAgIGRlZiBfaGFuZGxlTW9kdWxlVGVhckRvd24oc2VsZiwgcmVzdWx0KToKICAgICAgICBwcmV2aW91c01vZHVsZSA9IHNlbGYuX2dldF9wcmV2aW91c19tb2R1bGUocmVzdWx0KQogICAgICAgIGlmIHByZXZpb3VzTW9kdWxlIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIGlmIHJlc3VsdC5fbW9kdWxlU2V0VXBGYWlsZWQ6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIG1vZHVsZSA9IHN5cy5tb2R1bGVzW3ByZXZpb3VzTW9kdWxlXQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRlYXJEb3duTW9kdWxlID0gZ2V0YXR0cihtb2R1bGUsICd0ZWFyRG93bk1vZHVsZScsIE5vbmUpCiAgICAgICAgaWYgdGVhckRvd25Nb2R1bGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIF9jYWxsX2lmX2V4aXN0cyhyZXN1bHQsICdfc2V0dXBTdGRvdXQnKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB0ZWFyRG93bk1vZHVsZSgpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UocmVzdWx0LCBfRGVidWdSZXN1bHQpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICAgICBlcnJvck5hbWUgPSAndGVhckRvd25Nb2R1bGUgKCVzKScgJSBwcmV2aW91c01vZHVsZQogICAgICAgICAgICAgICAgc2VsZi5fYWRkQ2xhc3NPck1vZHVsZUxldmVsRXhjZXB0aW9uKHJlc3VsdCwgZSwgZXJyb3JOYW1lKQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgX2NhbGxfaWZfZXhpc3RzKHJlc3VsdCwgJ19yZXN0b3JlU3Rkb3V0JykKCiAgICBkZWYgX3RlYXJEb3duUHJldmlvdXNDbGFzcyhzZWxmLCB0ZXN0LCByZXN1bHQpOgogICAgICAgIHByZXZpb3VzQ2xhc3MgPSBnZXRhdHRyKHJlc3VsdCwgJ19wcmV2aW91c1Rlc3RDbGFzcycsIE5vbmUpCiAgICAgICAgY3VycmVudENsYXNzID0gdGVzdC5fX2NsYXNzX18KICAgICAgICBpZiBjdXJyZW50Q2xhc3MgPT0gcHJldmlvdXNDbGFzczoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgZ2V0YXR0cihwcmV2aW91c0NsYXNzLCAnX2NsYXNzU2V0dXBGYWlsZWQnLCBGYWxzZSk6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIGlmIGdldGF0dHIocmVzdWx0LCAnX21vZHVsZVNldFVwRmFpbGVkJywgRmFsc2UpOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBpZiBnZXRhdHRyKHByZXZpb3VzQ2xhc3MsICJfX3VuaXR0ZXN0X3NraXBfXyIsIEZhbHNlKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRlYXJEb3duQ2xhc3MgPSBnZXRhdHRyKHByZXZpb3VzQ2xhc3MsICd0ZWFyRG93bkNsYXNzJywgTm9uZSkKICAgICAgICBpZiB0ZWFyRG93bkNsYXNzIGlzIG5vdCBOb25lOgogICAgICAgICAgICBfY2FsbF9pZl9leGlzdHMocmVzdWx0LCAnX3NldHVwU3Rkb3V0JykKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgdGVhckRvd25DbGFzcygpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UocmVzdWx0LCBfRGVidWdSZXN1bHQpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICAgICBjbGFzc05hbWUgPSB1dGlsLnN0cmNsYXNzKHByZXZpb3VzQ2xhc3MpCiAgICAgICAgICAgICAgICBlcnJvck5hbWUgPSAndGVhckRvd25DbGFzcyAoJXMpJyAlIGNsYXNzTmFtZQogICAgICAgICAgICAgICAgc2VsZi5fYWRkQ2xhc3NPck1vZHVsZUxldmVsRXhjZXB0aW9uKHJlc3VsdCwgZSwgZXJyb3JOYW1lKQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgX2NhbGxfaWZfZXhpc3RzKHJlc3VsdCwgJ19yZXN0b3JlU3Rkb3V0JykKCgpjbGFzcyBfRXJyb3JIb2xkZXIob2JqZWN0KToKICAgICIiIgogICAgUGxhY2Vob2xkZXIgZm9yIGEgVGVzdENhc2UgaW5zaWRlIGEgcmVzdWx0LiBBcyBmYXIgYXMgYSBUZXN0UmVzdWx0CiAgICBpcyBjb25jZXJuZWQsIHRoaXMgbG9va3MgZXhhY3RseSBsaWtlIGEgdW5pdCB0ZXN0LiBVc2VkIHRvIGluc2VydAogICAgYXJiaXRyYXJ5IGVycm9ycyBpbnRvIGEgdGVzdCBzdWl0ZSBydW4uCiAgICAiIiIKICAgICMgSW5zcGlyZWQgYnkgdGhlIEVycm9ySG9sZGVyIGZyb20gVHdpc3RlZDoKICAgICMgaHR0cDovL3R3aXN0ZWRtYXRyaXguY29tL3RyYWMvYnJvd3Nlci90cnVuay90d2lzdGVkL3RyaWFsL3J1bm5lci5weQoKICAgICMgYXR0cmlidXRlIHVzZWQgYnkgVGVzdFJlc3VsdC5fZXhjX2luZm9fdG9fc3RyaW5nCiAgICBmYWlsdXJlRXhjZXB0aW9uID0gTm9uZQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBkZXNjcmlwdGlvbik6CiAgICAgICAgc2VsZi5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uCgogICAgZGVmIGlkKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmRlc2NyaXB0aW9uCgogICAgZGVmIHNob3J0RGVzY3JpcHRpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICI8RXJyb3JIb2xkZXIgZGVzY3JpcHRpb249JXI+IiAlIChzZWxmLmRlc2NyaXB0aW9uLCkKCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5pZCgpCgogICAgZGVmIHJ1bihzZWxmLCByZXN1bHQpOgogICAgICAgICMgY291bGQgY2FsbCByZXN1bHQuYWRkRXJyb3IoLi4uKSAtIGJ1dCB0aGlzIHRlc3QtbGlrZSBvYmplY3QKICAgICAgICAjIHNob3VsZG4ndCBiZSBydW4gYW55d2F5CiAgICAgICAgcGFzcwoKICAgIGRlZiBfX2NhbGxfXyhzZWxmLCByZXN1bHQpOgogICAgICAgIHJldHVybiBzZWxmLnJ1bihyZXN1bHQpCgogICAgZGVmIGNvdW50VGVzdENhc2VzKHNlbGYpOgogICAgICAgIHJldHVybiAwCgpkZWYgX2lzbm90c3VpdGUodGVzdCk6CiAgICAiQSBjcnVkZSB3YXkgdG8gdGVsbCBhcGFydCB0ZXN0Y2FzZXMgYW5kIHN1aXRlcyB3aXRoIGR1Y2stdHlwaW5nIgogICAgdHJ5OgogICAgICAgIGl0ZXIodGVzdCkKICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgcmV0dXJuIFRydWUKICAgIHJldHVybiBGYWxzZQoKCmNsYXNzIF9EZWJ1Z1Jlc3VsdChvYmplY3QpOgogICAgIlVzZWQgYnkgdGhlIFRlc3RTdWl0ZSB0byBob2xkIHByZXZpb3VzIGNsYXNzIHdoZW4gcnVubmluZyBpbiBkZWJ1Zy4iCiAgICBfcHJldmlvdXNUZXN0Q2xhc3MgPSBOb25lCiAgICBfbW9kdWxlU2V0VXBGYWlsZWQgPSBGYWxzZQogICAgc2hvdWxkU3RvcCA9IEZhbHNlCg==',
'/Lib/lib_migration/unittest/util.py':'IyAiVmFyaW91cyB1dGlsaXR5IGZ1bmN0aW9ucy4iCgojZml4bWUsIGJyeXRob24sIG5lZWQgdG8gZml4IG5hbWVkdHVwbGUKI2Zyb20gY29sbGVjdGlvbnMgaW1wb3J0IG5hbWVkdHVwbGUsIE9yZGVyZWREaWN0CiNmcm9tIGNvbGxlY3Rpb25zIGltcG9ydCBPcmRlcmVkRGljdAoKX191bml0dGVzdCA9IFRydWUKCiNfTUFYX0xFTkdUSCA9IDgwCiNkZWYgc2FmZV9yZXByKG9iaiwgc2hvcnQ9RmFsc2UpOgojICAgIHRyeToKIyAgICAgICAgcmVzdWx0ID0gcmVwcihvYmopCiMgICAgZXhjZXB0IEV4Y2VwdGlvbjoKIyAgICAgICAgcmVzdWx0ID0gb2JqZWN0Ll9fcmVwcl9fKG9iaikKIyAgICBpZiBub3Qgc2hvcnQgb3IgbGVuKHJlc3VsdCkgPCBfTUFYX0xFTkdUSDoKIyAgICAgICAgcmV0dXJuIHJlc3VsdAojICAgIHJldHVybiByZXN1bHRbOl9NQVhfTEVOR1RIXSArICcgW3RydW5jYXRlZF0uLi4nCgojZGVmIHN0cmNsYXNzKGNscyk6CiMgICAgcmV0dXJuICIlcy4lcyIgJSAoY2xzLl9fbW9kdWxlX18sIGNscy5fX25hbWVfXykKCiNkZWYgc29ydGVkX2xpc3RfZGlmZmVyZW5jZShleHBlY3RlZCwgYWN0dWFsKToKIyAgICAiIiJGaW5kcyBlbGVtZW50cyBpbiBvbmx5IG9uZSBvciB0aGUgb3RoZXIgb2YgdHdvLCBzb3J0ZWQgaW5wdXQgbGlzdHMuCiMKIyAgICBSZXR1cm5zIGEgdHdvLWVsZW1lbnQgdHVwbGUgb2YgbGlzdHMuICAgIFRoZSBmaXJzdCBsaXN0IGNvbnRhaW5zIHRob3NlCiMgICAgZWxlbWVudHMgaW4gdGhlICJleHBlY3RlZCIgbGlzdCBidXQgbm90IGluIHRoZSAiYWN0dWFsIiBsaXN0LCBhbmQgdGhlCiMgICAgc2Vjb25kIGNvbnRhaW5zIHRob3NlIGVsZW1lbnRzIGluIHRoZSAiYWN0dWFsIiBsaXN0IGJ1dCBub3QgaW4gdGhlCiMgICAgImV4cGVjdGVkIiBsaXN0LiAgICBEdXBsaWNhdGUgZWxlbWVudHMgaW4gZWl0aGVyIGlucHV0IGxpc3QgYXJlIGlnbm9yZWQuCiMgICAgIiIiCiMgICAgaSA9IGogPSAwCiMgICAgbWlzc2luZyA9IFtdCiMgICAgdW5leHBlY3RlZCA9IFtdCiMgICAgd2hpbGUgVHJ1ZToKIyAgICAgICAgdHJ5OgojICAgICAgICAgICAgZSA9IGV4cGVjdGVkW2ldCiMgICAgICAgICAgICBhID0gYWN0dWFsW2pdCiMgICAgICAgICAgICBpZiBlIDwgYToKIyAgICAgICAgICAgICAgICBtaXNzaW5nLmFwcGVuZChlKQojICAgICAgICAgICAgICAgIGkgKz0gMQojICAgICAgICAgICAgICAgIHdoaWxlIGV4cGVjdGVkW2ldID09IGU6CiMgICAgICAgICAgICAgICAgICAgIGkgKz0gMQojICAgICAgICAgICAgZWxpZiBlID4gYToKIyAgICAgICAgICAgICAgICB1bmV4cGVjdGVkLmFwcGVuZChhKQojICAgICAgICAgICAgICAgIGogKz0gMQojICAgICAgICAgICAgICAgIHdoaWxlIGFjdHVhbFtqXSA9PSBhOgojICAgICAgICAgICAgICAgICAgICBqICs9IDEKIyAgICAgICAgICAgIGVsc2U6CiMgICAgICAgICAgICAgICAgaSArPSAxCiMgICAgICAgICAgICAgICAgdHJ5OgojICAgICAgICAgICAgICAgICAgICB3aGlsZSBleHBlY3RlZFtpXSA9PSBlOgojICAgICAgICAgICAgICAgICAgICAgICAgaSArPSAxCiMgICAgICAgICAgICAgICAgZmluYWxseToKIyAgICAgICAgICAgICAgICAgICAgaiArPSAxCiMgICAgICAgICAgICAgICAgICAgIHdoaWxlIGFjdHVhbFtqXSA9PSBhOgojICAgICAgICAgICAgICAgICAgICAgICAgaiArPSAxCiMgICAgICAgIGV4Y2VwdCBJbmRleEVycm9yOgojICAgICAgICAgICAgbWlzc2luZy5leHRlbmQoZXhwZWN0ZWRbaTpdKQojICAgICAgICAgICAgdW5leHBlY3RlZC5leHRlbmQoYWN0dWFsW2o6XSkKIyAgICAgICAgICAgIGJyZWFrCiMgICAgcmV0dXJuIG1pc3NpbmcsIHVuZXhwZWN0ZWQKCgojZGVmIHVub3JkZXJhYmxlX2xpc3RfZGlmZmVyZW5jZShleHBlY3RlZCwgYWN0dWFsKToKIyAgICAiIiJTYW1lIGJlaGF2aW9yIGFzIHNvcnRlZF9saXN0X2RpZmZlcmVuY2UgYnV0CiMgICAgZm9yIGxpc3RzIG9mIHVub3JkZXJhYmxlIGl0ZW1zIChsaWtlIGRpY3RzKS4KIwojICAgIEFzIGl0IGRvZXMgYSBsaW5lYXIgc2VhcmNoIHBlciBpdGVtIChyZW1vdmUpIGl0CiMgICAgaGFzIE8obipuKSBwZXJmb3JtYW5jZS4iIiIKIyAgICBtaXNzaW5nID0gW10KIyAgICB3aGlsZSBleHBlY3RlZDoKIyAgICAgICAgaXRlbSA9IGV4cGVjdGVkLnBvcCgpCiMgICAgICAgIHRyeToKIyAgICAgICAgICAgIGFjdHVhbC5yZW1vdmUoaXRlbSkKIyAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiMgICAgICAgICAgICBtaXNzaW5nLmFwcGVuZChpdGVtKQoKICAgICMgYW55dGhpbmcgbGVmdCBpbiBhY3R1YWwgaXMgdW5leHBlY3RlZAojICAgIHJldHVybiBtaXNzaW5nLCBhY3R1YWwKCiNkZWYgdGhyZWVfd2F5X2NtcCh4LCB5KToKIyAgICAiIiJSZXR1cm4gLTEgaWYgeCA8IHksIDAgaWYgeCA9PSB5IGFuZCAxIGlmIHggPiB5IiIiCiMgICAgcmV0dXJuICh4ID4geSkgLSAoeCA8IHkpCgojIGZpeG1lLCBicnl0aG9uCiNuYW1lZHR1cGxlIGlzc3VlcyBpbiBjb2xsZWN0aW9ucy5weQojX01pc21hdGNoID0gbmFtZWR0dXBsZSgnTWlzbWF0Y2gnLCAnYWN0dWFsIGV4cGVjdGVkIHZhbHVlJykKCiNkZWYgX2NvdW50X2RpZmZfYWxsX3B1cnBvc2UoYWN0dWFsLCBleHBlY3RlZCk6CiMgICAgJ1JldHVybnMgbGlzdCBvZiAoY250X2FjdCwgY250X2V4cCwgZWxlbSkgdHJpcGxlcyB3aGVyZSB0aGUgY291bnRzIGRpZmZlcicKIyAgICAjIGVsZW1lbnRzIG5lZWQgbm90IGJlIGhhc2hhYmxlCiMgICAgcywgdCA9IGxpc3QoYWN0dWFsKSwgbGlzdChleHBlY3RlZCkKIyAgICBtLCBuID0gbGVuKHMpLCBsZW4odCkKIyAgICBOVUxMID0gb2JqZWN0KCkKIyAgICByZXN1bHQgPSBbXQojICAgIGZvciBpLCBlbGVtIGluIGVudW1lcmF0ZShzKToKIyAgICAgICAgaWYgZWxlbSBpcyBOVUxMOgojICAgICAgICAgICAgY29udGludWUKIyAgICAgICAgY250X3MgPSBjbnRfdCA9IDAKIyAgICAgICAgZm9yIGogaW4gcmFuZ2UoaSwgbSk6CiMgICAgICAgICAgICBpZiBzW2pdID09IGVsZW06CiMgICAgICAgICAgICAgICAgY250X3MgKz0gMQojICAgICAgICAgICAgICAgIHNbal0gPSBOVUxMCiMgICAgICAgIGZvciBqLCBvdGhlcl9lbGVtIGluIGVudW1lcmF0ZSh0KToKIyAgICAgICAgICAgIGlmIG90aGVyX2VsZW0gPT0gZWxlbToKIyAgICAgICAgICAgICAgICBjbnRfdCArPSAxCiMgICAgICAgICAgICAgICAgdFtqXSA9IE5VTEwKIyAgICAgICAgaWYgY250X3MgIT0gY250X3Q6CiMgICAgICAgICAgICBkaWZmID0gX01pc21hdGNoKGNudF9zLCBjbnRfdCwgZWxlbSkKIyAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoZGlmZikKIwojICAgIGZvciBpLCBlbGVtIGluIGVudW1lcmF0ZSh0KToKIyAgICAgICAgaWYgZWxlbSBpcyBOVUxMOgojICAgICAgICAgICAgY29udGludWUKIyAgICAgICAgY250X3QgPSAwCiMgICAgICAgIGZvciBqIGluIHJhbmdlKGksIG4pOgojICAgICAgICAgICAgaWYgdFtqXSA9PSBlbGVtOgojICAgICAgICAgICAgICAgIGNudF90ICs9IDEKIyAgICAgICAgICAgICAgICB0W2pdID0gTlVMTAojICAgICAgICBkaWZmID0gX01pc21hdGNoKDAsIGNudF90LCBlbGVtKQojICAgICAgICByZXN1bHQuYXBwZW5kKGRpZmYpCiMgICAgcmV0dXJuIHJlc3VsdAoKI2RlZiBfb3JkZXJlZF9jb3VudChpdGVyYWJsZSk6CiMgICAgJ1JldHVybiBkaWN0IG9mIGVsZW1lbnQgY291bnRzLCBpbiB0aGUgb3JkZXIgdGhleSB3ZXJlIGZpcnN0IHNlZW4nCiMgICAgYyA9IE9yZGVyZWREaWN0KCkKIyAgICBmb3IgZWxlbSBpbiBpdGVyYWJsZToKIyAgICAgICAgY1tlbGVtXSA9IGMuZ2V0KGVsZW0sIDApICsgMQojICAgIHJldHVybiBjCgojZGVmIF9jb3VudF9kaWZmX2hhc2hhYmxlKGFjdHVhbCwgZXhwZWN0ZWQpOgojICAgICdSZXR1cm5zIGxpc3Qgb2YgKGNudF9hY3QsIGNudF9leHAsIGVsZW0pIHRyaXBsZXMgd2hlcmUgdGhlIGNvdW50cyBkaWZmZXInCiMgICAgIyBlbGVtZW50cyBtdXN0IGJlIGhhc2hhYmxlCiMgICAgcywgdCA9IF9vcmRlcmVkX2NvdW50KGFjdHVhbCksIF9vcmRlcmVkX2NvdW50KGV4cGVjdGVkKQojICAgIHJlc3VsdCA9IFtdCiMgICAgZm9yIGVsZW0sIGNudF9zIGluIHMuaXRlbXMoKToKIyAgICAgICAgY250X3QgPSB0LmdldChlbGVtLCAwKQojICAgICAgICBpZiBjbnRfcyAhPSBjbnRfdDoKIyAgICAgICAgICAgIGRpZmYgPSBfTWlzbWF0Y2goY250X3MsIGNudF90LCBlbGVtKQojICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChkaWZmKQojICAgIGZvciBlbGVtLCBjbnRfdCBpbiB0Lml0ZW1zKCk6CiMgICAgICAgIGlmIGVsZW0gbm90IGluIHM6CiMgICAgICAgICAgICBkaWZmID0gX01pc21hdGNoKDAsIGNudF90LCBlbGVtKQojICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChkaWZmKQojICAgIHJldHVybiByZXN1bHQK',
'/Lib/lib_migration/unittest/__init__.py':'IiIiClB5dGhvbiB1bml0IHRlc3RpbmcgZnJhbWV3b3JrLCBiYXNlZCBvbiBFcmljaCBHYW1tYSdzIEpVbml0IGFuZCBLZW50IEJlY2sncwpTbWFsbHRhbGsgdGVzdGluZyBmcmFtZXdvcmsuCgpUaGlzIG1vZHVsZSBjb250YWlucyB0aGUgY29yZSBmcmFtZXdvcmsgY2xhc3NlcyB0aGF0IGZvcm0gdGhlIGJhc2lzIG9mCnNwZWNpZmljIHRlc3QgY2FzZXMgYW5kIHN1aXRlcyAoVGVzdENhc2UsIFRlc3RTdWl0ZSBldGMuKSwgYW5kIGFsc28gYQp0ZXh0LWJhc2VkIHV0aWxpdHkgY2xhc3MgZm9yIHJ1bm5pbmcgdGhlIHRlc3RzIGFuZCByZXBvcnRpbmcgdGhlIHJlc3VsdHMKIChUZXh0VGVzdFJ1bm5lcikuCgpTaW1wbGUgdXNhZ2U6CgogICAgaW1wb3J0IHVuaXR0ZXN0CgogICAgY2xhc3MgSW50ZWdlckFyaXRobWVudGljVGVzdENhc2UodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgIGRlZiB0ZXN0QWRkKHNlbGYpOiAgIyMgdGVzdCBtZXRob2QgbmFtZXMgYmVnaW4gJ3Rlc3QqJwogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKCgxICsgMiksIDMpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoMCArIDEsIDEpCiAgICAgICAgZGVmIHRlc3RNdWx0aXBseShzZWxmKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgoMCAqIDEwKSwgMCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgoNSAqIDgpLCA0MCkKCiAgICBpZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgICAgIHVuaXR0ZXN0Lm1haW4oKQoKRnVydGhlciBpbmZvcm1hdGlvbiBpcyBhdmFpbGFibGUgaW4gdGhlIGJ1bmRsZWQgZG9jdW1lbnRhdGlvbiwgYW5kIGZyb20KCiAgaHR0cDovL2RvY3MucHl0aG9uLm9yZy9saWJyYXJ5L3VuaXR0ZXN0Lmh0bWwKCkNvcHlyaWdodCAoYykgMTk5OS0yMDAzIFN0ZXZlIFB1cmNlbGwKQ29weXJpZ2h0IChjKSAyMDAzLTIwMTAgUHl0aG9uIFNvZnR3YXJlIEZvdW5kYXRpb24KVGhpcyBtb2R1bGUgaXMgZnJlZSBzb2Z0d2FyZSwgYW5kIHlvdSBtYXkgcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKaXQgdW5kZXIgdGhlIHNhbWUgdGVybXMgYXMgUHl0aG9uIGl0c2VsZiwgc28gbG9uZyBhcyB0aGlzIGNvcHlyaWdodCBtZXNzYWdlCmFuZCBkaXNjbGFpbWVyIGFyZSByZXRhaW5lZCBpbiB0aGVpciBvcmlnaW5hbCBmb3JtLgoKSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgVE8gQU5ZIFBBUlRZIEZPUiBESVJFQ1QsIElORElSRUNULApTUEVDSUFMLCBJTkNJREVOVEFMLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgQVJJU0lORyBPVVQgT0YgVEhFIFVTRSBPRgpUSElTIENPREUsIEVWRU4gSUYgVEhFIEFVVEhPUiBIQVMgQkVFTiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNICkRBTUFHRS4KClRIRSBBVVRIT1IgU1BFQ0lGSUNBTExZIERJU0NMQUlNUyBBTlkgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UCkxJTUlURUQgVE8sIFRIRSBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBClBBUlRJQ1VMQVIgUFVSUE9TRS4gIFRIRSBDT0RFIFBST1ZJREVEIEhFUkVVTkRFUiBJUyBPTiBBTiAiQVMgSVMiIEJBU0lTLApBTkQgVEhFUkUgSVMgTk8gT0JMSUdBVElPTiBXSEFUU09FVkVSIFRPIFBST1ZJREUgTUFJTlRFTkFOQ0UsClNVUFBPUlQsIFVQREFURVMsIEVOSEFOQ0VNRU5UUywgT1IgTU9ESUZJQ0FUSU9OUy4KIiIiCgojX19hbGxfXyA9IFsnVGVzdFJlc3VsdCcsICdUZXN0Q2FzZScsICdUZXN0U3VpdGUnLAojICAgICAgICAgICAnVGV4dFRlc3RSdW5uZXInLCAnVGVzdExvYWRlcicsICdGdW5jdGlvblRlc3RDYXNlJywgJ21haW4nLAojICAgICAgICAgICAnZGVmYXVsdFRlc3RMb2FkZXInLCAnU2tpcFRlc3QnLCAnc2tpcCcsICdza2lwSWYnLCAnc2tpcFVubGVzcycsCiMgICAgICAgICAgICdleHBlY3RlZEZhaWx1cmUnLCAnVGV4dFRlc3RSZXN1bHQnLCAnaW5zdGFsbEhhbmRsZXInLAojICAgICAgICAgICAncmVnaXN0ZXJSZXN1bHQnLCAncmVtb3ZlUmVzdWx0JywgJ3JlbW92ZUhhbmRsZXInXQoKIyBFeHBvc2Ugb2Jzb2xldGUgZnVuY3Rpb25zIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eQojX19hbGxfXy5leHRlbmQoWydnZXRUZXN0Q2FzZU5hbWVzJywgJ21ha2VTdWl0ZScsICdmaW5kVGVzdENhc2VzJ10pCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKI2Zyb20gLnJlc3VsdCBpbXBvcnQgVGVzdFJlc3VsdAojZml4bWUgYnJ5dGhvbiBzeW50YXggZXJyb3IKZnJvbSAuY2FzZSBpbXBvcnQgVGVzdENhc2UKZnJvbSAubWFpbiBpbXBvcnQgVGVzdFByb2dyYW0sIG1haW4KI2Zyb20gLmNhc2UgaW1wb3J0IChUZXN0Q2FzZSwgRnVuY3Rpb25UZXN0Q2FzZSwgU2tpcFRlc3QsIHNraXAsIHNraXBJZiwKIyAgICAgICAgICAgICAgICAgICBza2lwVW5sZXNzLCBleHBlY3RlZEZhaWx1cmUpCiNmcm9tIC5zdWl0ZSBpbXBvcnQgQmFzZVRlc3RTdWl0ZSwgVGVzdFN1aXRlCiNmcm9tIC5sb2FkZXIgaW1wb3J0IChUZXN0TG9hZGVyLCBkZWZhdWx0VGVzdExvYWRlciwgbWFrZVN1aXRlLCBnZXRUZXN0Q2FzZU5hbWVzLAojICAgICAgICAgICAgICAgICAgICAgZmluZFRlc3RDYXNlcykKI2Zyb20gLm1haW4gaW1wb3J0IFRlc3RQcm9ncmFtLCBtYWluCiNmcm9tIC5ydW5uZXIgaW1wb3J0IFRleHRUZXN0UnVubmVyLCBUZXh0VGVzdFJlc3VsdAojZnJvbSAuc2lnbmFscyBpbXBvcnQgaW5zdGFsbEhhbmRsZXIsIHJlZ2lzdGVyUmVzdWx0LCByZW1vdmVSZXN1bHQsIHJlbW92ZUhhbmRsZXIKCiMgZGVwcmVjYXRlZAojX1RleHRUZXN0UmVzdWx0ID0gVGV4dFRlc3RSZXN1bHQK',
'/Lib/lib_migration/unittest/__main__.py':'IiIiTWFpbiBlbnRyeSBwb2ludCIiIgoKaW1wb3J0IHN5cwppZiBzeXMuYXJndlswXS5lbmRzd2l0aCgiX19tYWluX18ucHkiKToKICAgIHN5cy5hcmd2WzBdID0gInB5dGhvbiAtbSB1bml0dGVzdCIKCl9fdW5pdHRlc3QgPSBUcnVlCgpmcm9tIC5tYWluIGltcG9ydCBtYWluLCBUZXN0UHJvZ3JhbSwgVVNBR0VfQVNfTUFJTgpUZXN0UHJvZ3JhbS5VU0FHRSA9IFVTQUdFX0FTX01BSU4KCm1haW4obW9kdWxlPU5vbmUpCg==',
'/Lib/ui/BaseUI.py':'aW1wb3J0IHJhbmRvbQoKY2xhc3MgQmFzZVVJOgogIGRlZiBfX2luaXRfXyhzZWxmLCBlbGVtZW50LCB0eXBlLCBpZD1Ob25lLCBkcmFnZ2FibGU9RmFsc2UpOgogICAgICBzZWxmLl9lbGVtZW50PWVsZW1lbnQKCiAgICAgIGlmIGlkIGlzIE5vbmU6CiAgICAgICAgIHNlbGYuX2VsZW1lbnQuc2V0QXR0cmlidXRlKCdpZCcsJyVzXyVzJyAlICh0eXBlLCBpbnQoMTAwMDAwKnJhbmRvbS5yYW5kb20oKSkpKQogICAgICBlbHNlOgogICAgICAgICBzZWxmLl9lbGVtZW50LnNldEF0dHJpYnV0ZSgnaWQnLGlkKQoKICAgICAgaWYgZHJhZ2dhYmxlOgogICAgICAgICBzZWxmLmRyYWdnYWJsZSgpCgogICAgICBzZWxmLmF0dGFjaD1zZWxmLmFwcGVuZAoKICBkZWYgZ2V0X2lkKHNlbGYpOgogICAgICByZXR1cm4gc2VsZi5fZWxlbWVudC5pZAoKICBkZWYgYXBwZW5kKHNlbGYsIGVsZW1lbnRfaWQpOgogICAgICAiIiIgYXBwZW5kIHRoaXMgRE9NIGNvbXBvbmVudCB0byBET00gZWxlbWVudCBlbGVtZW50X2lkIiIiCiAgICAgIGRvYy5nZXQoaWQ9ZWxlbWVudF9pZClbMF0uYXBwZW5kQ2hpbGQoc2VsZi5fZWxlbWVudCkKCiAgZGVmIGRyYWdnYWJsZShzZWxmKToKICAgICAgZGVmIGRyYWcoZSk6CiAgICAgICAgICBzZWxmLl9lbGVtZW50LnN0eWxlLnRvcD0nJXNweCcgJSAoZS5jbGllbnRZIC0gc2VsZi5fZGVsdGFZKQogICAgICAgICAgc2VsZi5fZWxlbWVudC5zdHlsZS5sZWZ0PSclc3B4JyAlIChlLmNsaWVudFggLSBzZWxmLl9kZWx0YVgpCgogICAgICBkZWYgbW91c2VEb3duKGUpOgogICAgICAgICAgc2VsZi5fZWxlbWVudC5zdHlsZS5wb3NpdGlvbj0nYWJzb2x1dGUnCiAgICAgICAgICBzZWxmLl9kZWx0YVg9ZS5jbGllbnRYIC0gc2VsZi5fZWxlbWVudC5vZmZzZXRMZWZ0CiAgICAgICAgICBzZWxmLl9kZWx0YVk9ZS5jbGllbnRZIC0gc2VsZi5fZWxlbWVudC5vZmZzZXRUb3AKICAgICAgICAgIHdpbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBkcmFnLCB0cnVlKQoKICAgICAgZGVmIG1vdXNlVXAoZSk6CiAgICAgICAgICB3aW4ucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgZHJhZywgdHJ1ZSkKCiAgICAgIHNlbGYuX2VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgbW91c2VEb3duLCBGYWxzZSkKICAgICAgc2VsZi5fZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgbW91c2VVcCwgRmFsc2UpCgogIGRlZiBzaG93KHNlbGYpOgogICAgICBzZWxmLl9lbGVtZW50LnNldEF0dHJpYnV0ZSgnZGlzcGxheScsICdibG9jaycpCgogIGRlZiBoaWRlKHNlbGYpOgogICAgICBzZWxmLl9lbGVtZW50LnNldEF0dHJpYnV0ZSgnZGlzcGxheScsICdub25lJykK',
'/Lib/ui/dialog.py':'aW1wb3J0IFdpZGdldApmcm9tIGJyb3dzZXIgaW1wb3J0IGh0bWwsIGRvYyBhcyBkb2N1bWVudAoKY2xhc3MgRGlhbG9nKFdpZGdldC5EcmFnZ2FibGVXaWRnZXQpOgogIGRlZiBfX2luaXRfXyhzZWxmLCBpZD1Ob25lKToKICAgICAgc2VsZi5fZGl2X3NoZWxsPWh0bWwuRElWKAogICAgICAgICBDbGFzcz0idWktZGlhbG9nIHVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCB1aS1jb3JuZXItYWxsIHVpLWZyb250IHVpLWRyYWdnYWJsZSB1aS1yZXNpemFibGUiLAogICAgICAgICBzdHlsZT17J3Bvc2l0aW9uJzogJ2Fic29sdXRlJywgJ2hlaWdodCc6ICdhdXRvJywgJ3dpZHRoJzogJzMwMHB4JywKICAgICAgICAgICAgICAgICd0b3AnOiAnOThweCcsICdsZWZ0JzogJzE0MHB4JywgJ2Rpc3BsYXknOiAnYmxvY2snfSkKCiAgICAgIFdpZGdldC5EcmFnZ2FibGVXaWRnZXQuX19pbml0X18oc2VsZiwgc2VsZi5fZGl2X3NoZWxsLCAnZGlhbG9nJywgaWQpCgogICAgICBfZGl2X3RpdGxlYmFyPWh0bWwuRElWKElkPSJ0aXRsZWJhciIsCiAgICAgICAgICAgQ2xhc3M9InVpLWRpYWxvZy10aXRsZWJhciB1aS13aWRnZXQtaGVhZGVyIHVpLWNvcm5lci1hbGwgdWktaGVscGVyLWNsZWFyZml4IikKICAgICAgc2VsZi5fZGl2X3NoZWxsIDw9IF9kaXZfdGl0bGViYXIKCiAgICAgIHNlbGYuX2Rpdl90aXRsZT1odG1sLlNQQU4oSWQ9InRpdGxlIiwgQ2xhc3M9InVpLWRpYWxvZy10aXRsZSIpCiAgICAgICAgCiAgICAgIF9kaXZfdGl0bGViYXIgPD0gc2VsZi5fZGl2X3RpdGxlCgogICAgICBzZWxmLl90aXRsZV9idXR0b249aHRtbC5CVVRUT04oVGl0bGU9ImNsb3NlIiwKICAgICAgICAgICAgQ2xhc3M9InVpLWJ1dHRvbiB1aS13aWRnZXQgdWktc3RhdGUtZGVmYXVsdCB1aS1jb3JuZXItYWxsIHVpLWJ1dHRvbi1pY29uLW9ubHkgdWktZGlhbG9nLXRpdGxlYmFyLWNsb3NlIikKCiAgICAgIGRlZiBkaWFsb2dfY2xvc2UoZSk6CiAgICAgICAgICAjZGVsIGRvY3VtZW50W3NlbGYuX2Rpdl9zaGVsbC5pZF0KICAgICAgICAgIGRlbCBkb2Nbc2VsZi5fZGl2X3NoZWxsLmlkXQoKICAgICAgc2VsZi5fdGl0bGVfYnV0dG9uLmJpbmQoJ2NsaWNrJywgZGlhbG9nX2Nsb3NlKQogICAgICBfc3Bhbj1odG1sLlNQQU4oQ2xhc3M9InVpLWJ1dHRvbi1pY29uLXByaW1hcnkgdWktaWNvbiB1aS1pY29uLWNsb3NldGhpY2siKQogICAgICBzZWxmLl90aXRsZV9idXR0b24gPD0gX3NwYW4KCiAgICAgIF9zcGFuPWh0bWwuU1BBTignY2xvc2UnLCBDbGFzcz0idWktYnV0dG9uLXRleHQiKQogICAgICBzZWxmLl90aXRsZV9idXR0b24gPD0gX3NwYW4KCiAgICAgIF9kaXZfdGl0bGViYXIgPD0gc2VsZi5fdGl0bGVfYnV0dG9uCgogICAgICBzZWxmLl9kaXZfZGlhbG9nPWh0bWwuRElWKENsYXNzPSJ1aS1kaWFsb2ctY29udGVudCB1aS13aWRnZXQtY29udGVudCIsCiAgICAgICAgICAgc3R5bGU9eyd3aWR0aCc6ICdhdXRvJywgJ21pbi1oZWlnaHQnOiAnMTA1cHgnLCAKICAgICAgICAgICAgICAgICAgJ21heC1oZWlnaHQnOiAnbm9uZScsICdoZWlnaHQnOiAnYXV0byd9KQoKICAgICAgc2VsZi5fZGl2X3NoZWxsIDw9IHNlbGYuX2Rpdl9kaWFsb2cKCiAgICAgIGZvciBfaSBpbiBbJ24nLCAnZScsICdzJywgJ3cnLCAnc2UnLCAnc3cnLCAnbmUnLCAnbncnXToKICAgICAgICAgIGlmIF9pID09ICdzZSc6CiAgICAgICAgICAgICBfY2xhc3M9InVpLXJlc2l6YWJsZS1oYW5kbGUgdWktcmVzaXphYmxlLSVzIHVpLWljb24gdWktaWNvbi1ncmlwc21hbGwtZGlhZ29uYWwtJXMiICUgKF9pLCBfaSkKICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICBfY2xhc3M9InVpLXJlc2l6YWJsZS1oYW5kbGUgdWktcmVzaXphYmxlLSVzIiAlIF9pCgogICAgICAgICAgc2VsZi5fZGl2X3NoZWxsIDw9IGh0bWwuRElWKENsYXNzPV9jbGFzcywgc3R5bGU9eyd6LWluZGV4JzogJzkwJ30pCgogICAgICBkb2MgPD0gc2VsZi5fZGl2X3NoZWxsCgogIGRlZiBzZXRfdGl0bGUoc2VsZiwgdGl0bGUpOgogICAgICBzZWxmLl9kaXZfdGl0bGUuc2V0X3RleHQodGl0bGUpCgogIGRlZiBzZXRfYm9keShzZWxmLCBib2R5KToKICAgICAgc2VsZi5fZGl2X2RpYWxvZy5zZXRfaHRtbChib2R5KQo=',
'/Lib/ui/progressbar.py':'aW1wb3J0IFdpZGdldApmcm9tIGJyb3dzZXIgaW1wb3J0IGh0bWwKCmNsYXNzIFByb2dyZXNzQmFyKFdpZGdldC5XaWRnZXQpOgogIGRlZiBfX2luaXRfXyhzZWxmLCBpZD1Ob25lLCBsYWJlbD1GYWxzZSk6CiAgICAgIHNlbGYuX2Rpdl9zaGVsbD1odG1sLkRJVihDbGFzcz0idWktcHJvZ3Jlc3NiYXIgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGwiKQogICAgICBXaWRnZXQuV2lkZ2V0Ll9faW5pdF9fKHNlbGYsIHNlbGYuX2Rpdl9zaGVsbCwgJ3Byb2dyZXNzYmFyJywgaWQpCgogICAgICBzZWxmLl9zaG93X2xhYmVsPWxhYmVsCiAgICAgIGlmIGxhYmVsOgogICAgICAgICBzZWxmLl9sYWJlbD1odG1sLkRJVihDbGFzcz0ncHJvZ3Jlc3MtbGFiZWwnKQogICAgICAgICBzZWxmLl9kaXZfc2hlbGwgPD0gc2VsZi5fbGFiZWwKCiAgICAgIHNlbGYuX2Jhcj1odG1sLkRJVihDbGFzcz0idWktcHJvZ3Jlc3NiYXItdmFsdWUgdWktd2lkZ2V0LWhlYWRlciB1aS1jb3JuZXItbGVmdCIsCiAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17J3dpZHRoJzogJzBweCd9KQogICAgICBzZWxmLl9kaXZfc2hlbGwgPD0gc2VsZi5fYmFyCgogIGRlZiBzZXRfcHJvZ3Jlc3Moc2VsZiwgcGVyY2VudCk6CiAgICAgIHNlbGYuX2Jhci5zdHlsZS53aWR0aD0nJXMlJScgJSBwZXJjZW50CiAgICAgIGlmIHNlbGYuX3Nob3dfbGFiZWw6CiAgICAgICAgIHNlbGYuX2xhYmVsLnRleHQ9JyVzJSUnICUgcGVyY2VudAo=',
'/Lib/ui/slider.py':'aW1wb3J0IFdpZGdldApmcm9tIGJyb3dzZXIgaW1wb3J0IGh0bWwKCmNsYXNzIFNsaWRlcihXaWRnZXQuV2lkZ2V0KToKICBkZWYgX19pbml0X18oc2VsZiwgaWQ9Tm9uZSwgZG9jdW1lbnQ9ZG9jLCBsYWJlbD1GYWxzZSk6CiAgICAgIHNlbGYuX2Rpdl9zaGVsbD1odG1sLkRJVihDbGFzcz0idWktc2xpZGVyIHVpLXNsaWRlci1ob3Jpem9udGFsIHVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCB1aS1jb3JuZXItYWxsIikKCiAgICAgIFdpZGdldC5XaWRnZXQuX19pbml0X18oc2VsZiwgc2VsZi5fZGl2X3NoZWxsLCAnc2xpZGVyJywgaWQpCgogICAgICBzZWxmLl9oYW5kbGU9aHRtbC5BKENsYXNzPSJ1aS1zbGlkZXItaGFuZGxlIHVpLXN0YXRlLWRlZmF1bHQgdWktY29ybmVyLWFsbCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgSHJlZj0nIycsIHN0eWxlPXsnbGVmdCc6ICcwcHgnfSkKICAgICAgc2VsZi5fdmFsdWU9MAogICAgICBzZWxmLl9pc01vdXNlRG93bj1GYWxzZQoKICAgICAgZGVmIHN0YXJ0U2xpZGUoZSk6CiAgICAgICAgICBzZWxmLl9pc01vdXNlRG93bj1UcnVlCiAgICAgICAgICBzZWxmLl91cHBlckJvdW5kID0gc2VsZi5fZGl2X3NoZWxsLm9mZnNldFdpZHRoIC0gc2VsZi5faGFuZGxlLm9mZnNldFdpZHRoCgogICAgICAgICAgcG9zID0gV2lkZ2V0LmdldE1vdXNlUG9zaXRpb24oZSkKICAgICAgICAgIHNlbGYuX3N0YXJ0TW91c2VYPXBvc1sneCddCgogICAgICAgICAgc2VsZi5fbGFzdEVsZW1lbnRMZWZ0ID0gcGFyc2VJbnQoc2VsZi5faGFuZGxlLmVsdC5zdHlsZS5sZWZ0KSAjLSBwYXJzZUludChzZWxmLl9kaXZfc2hlbGwuZWx0LnN0eWxlLmxlZnQpCiAgICAgICAgICAjcHJpbnQoc2VsZi5fdXBwZXJCb3VuZCkKICAgICAgICAgIHVwZGF0ZVBvc2l0aW9uKGUpCgogICAgICBkZWYgdXBkYXRlUG9zaXRpb24oZSk6CiAgICAgICAgICBwb3MgPSBXaWRnZXQuZ2V0TW91c2VQb3NpdGlvbihlKQogICAgICAgICAgX25ld1BvcyA9IHNlbGYuX2xhc3RFbGVtZW50TGVmdCArIHBvc1sneCddIC0gc2VsZi5fc3RhcnRNb3VzZVgKICAgICAgICAgIAogICAgICAgICAgX25ld1BvcyA9IG1heCgwLCBfbmV3UG9zKQogICAgICAgICAgX25ld1BvcyA9IG1pbihfbmV3UG9zLCBzZWxmLl91cHBlckJvdW5kKQoKICAgICAgICAgICNwcmludChfbmV3UG9zKQogICAgICAgICAgc2VsZi5faGFuZGxlLmVsdC5zdHlsZS5sZWZ0ID0gJyVzcHgnICUgX25ld1BvcwogICAgICAgICAgc2VsZi5fbGFzdEVsZW1lbnRMZWZ0ID0gX25ld1BvcwoKICAgICAgZGVmIG1vdmluZyhlKToKICAgICAgICAgIGlmIHNlbGYuX2lzTW91c2VEb3duOgogICAgICAgICAgICAgdXBkYXRlUG9zaXRpb24oZSkKCiAgICAgIGRlZiBkcm9wQ2FsbGJhY2soZSk6CiAgICAgICAgICBzZWxmLl9pc01vdXNlRG93bj1GYWxzZQogICAgICAgICAgc2VsZi5faGFuZGxlLnVuYmluZCgnbW91c2Vtb3ZlJywgbW92aW5nKQoKCiAgICAgIHNlbGYuX2hhbmRsZS5iaW5kKCdtb3VzZW1vdmUnLCBtb3ZpbmcpCiAgICAgIHNlbGYuX2hhbmRsZS5iaW5kKCdtb3VzZXVwJywgZHJvcENhbGxiYWNrKQogICAgICAjc2VsZi5faGFuZGxlLmJpbmQoJ21vdXNlb3V0JywgZHJvcENhbGxiYWNrKQogICAgICBzZWxmLl9oYW5kbGUuYmluZCgnbW91c2Vkb3duJywgc3RhcnRTbGlkZSkKCiAgICAgIGRlZiBtb3VzZW92ZXIoZSk6CiAgICAgICAgICBfY2xhc3M9c2VsZi5faGFuZGxlLmdldEF0dHJpYnV0ZSgnY2xhc3MnKQogICAgICAgICAgc2VsZi5faGFuZGxlLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnJXMgJXMnICUgKF9jbGFzcywgJ3VpLXN0YXRlLWhvdmVyJykpCgogICAgICBkZWYgbW91c2VvdXQoZSk6CiAgICAgICAgICBzZWxmLl9pc01vdXNlRG93bj1GYWxzZQogICAgICAgICAgX2NsYXNzPXNlbGYuX2hhbmRsZS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykKICAgICAgICAgIHNlbGYuX2hhbmRsZS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgX2NsYXNzLnJlcGxhY2UoJ3VpLXN0YXRlLWhvdmVyJywgJycpKQoKICAgICAgc2VsZi5faGFuZGxlLmJpbmQoJ21vdXNlb3ZlcicsIG1vdXNlb3ZlcikKICAgICAgc2VsZi5faGFuZGxlLmJpbmQoJ21vdXNlb3V0JywgbW91c2VvdXQpCgogICAgICBzZWxmLl9kaXZfc2hlbGwgPD0gc2VsZi5faGFuZGxlCgogIGRlZiBnZXRfdmFsdWUoc2VsZik6CiAgICAgIHJldHVybiBzZWxmLl92YWx1ZQoKICAjZGVmIHNldF92YWx1ZShzZWxmLCB2YWx1ZSk6CiAgIyAgICBzZWxmLl92YWx1ZT12YWx1ZQogICMgICBzZWxmLl9oYW5kbGUuc3R5bGUubGVmdD0nJXNweCcgJSB2YWx1ZQo=',
'/Lib/ui/Widget.py':'aW1wb3J0IHJhbmRvbQpmcm9tIGJyb3dzZXIgaW1wb3J0IGRvYyBhcyBkb2N1bWVudCAgIyA6KCBkb2N1bWVudCBkb2Vzbid0IHdvcmsKCmRlZiBnZXRNb3VzZVBvc2l0aW9uKGUpOgogICAgaWYgZSBpcyBOb25lOgogICAgICAgZT13aW4uZXZlbnQKCiAgICBpZiBlLnBhZ2VYIG9yIGUucGFnZVk6CiAgICAgICByZXR1cm4geyd4JzogZS5wYWdlWCwgJ3knOiBlLnBhZ2VZfQoKICAgIGlmIGUuY2xpZW50WCBvciBlLmNsaWVudFk6CiAgICAgICBfcG9zeD1lLmNsaWVudFggKyBkb2MuYm9keS5zY3JvbGxMZWZ0ICsgZG9jLmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0OwogICAgICAgX3Bvc3k9ZS5jbGllbnRZICsgZG9jLmJvZHkuc2Nyb2xsVG9wICsgZG9jLmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7CiAgICAgICByZXR1cm4geyd4JzogX3Bvc3gsICd5JzogX3Bvc3l9CiAgICAgIAogICAgcmV0dXJuIHsneCc6IDAsICd5JzogMH0KCmNsYXNzIFdpZGdldDoKICBkZWYgX19pbml0X18oc2VsZiwgZWxlbWVudCwgdHlwZSwgaWQ9Tm9uZSk6CiAgICAgIHNlbGYuX2VsZW1lbnQ9ZWxlbWVudAoKICAgICAgaWYgaWQgaXMgTm9uZToKICAgICAgICAgc2VsZi5fZWxlbWVudC5pZD0nJXNfJXMnICUgKHR5cGUsIGludCgxMDAwMDAqcmFuZG9tLnJhbmRvbSgpKSkKICAgICAgZWxzZToKICAgICAgICAgc2VsZi5fZWxlbWVudC5pZD1pZAoKICBkZWYgZ2V0X2lkKHNlbGYpOgogICAgICByZXR1cm4gc2VsZi5fZWxlbWVudC5pZAoKICBkZWYgYXR0YWNoKHNlbGYsIGVsZW1lbnRfaWQpOgogICAgICAiIiIgYXBwZW5kIHRoaXMgRE9NIGNvbXBvbmVudCB0byBET00gZWxlbWVudCBlbGVtZW50X2lkIiIiCiAgICAgICNkb2N1bWVudFtlbGVtZW50X2lkXSA8PSBzZWxmLl9lbGVtZW50ICAgI3RoaXMgZG9lc24ndCB3b3JrIDooCiAgICAgICNkb2MgaXMgYWN0dWFsbHkgdGhlIGdsb2JhbCAnZG9jJyBub3QgdGhlIG9uZSB3ZSBpbXBvcnRlZCBmcm9tIGJyb3dzZXIgOigKICAgICAgZG9jW2VsZW1lbnRfaWRdIDw9IHNlbGYuX2VsZW1lbnQKCiAgZGVmIHNob3coc2VsZik6CiAgICAgIHNlbGYuX2VsZW1lbnQuZGlzcGxheT0nYmxvY2snCgogIGRlZiBoaWRlKHNlbGYpOgogICAgICBzZWxmLl9lbGVtZW50LmRpc3BsYXk9J25vbmUnCgpjbGFzcyBEcmFnZ2FibGVXaWRnZXQoV2lkZ2V0KToKICBkZWYgX19pbml0X18oc2VsZiwgZWxlbWVudCwgdHlwZSwgaWQ9Tm9uZSk6CiAgICAgIFdpZGdldC5fX2luaXRfXyhzZWxmLCBlbGVtZW50LCB0eXBlLCBpZCkKCiAgICAgIGRlZiBkcmFnKGUpOgogICAgICAgICAgc2VsZi5fZWxlbWVudC5zdHlsZS50b3A9JyVzcHgnICUgKGUuY2xpZW50WSAtIHNlbGYuX2RlbHRhWSkKICAgICAgICAgIHNlbGYuX2VsZW1lbnQuc3R5bGUubGVmdD0nJXNweCcgJSAoZS5jbGllbnRYIC0gc2VsZi5fZGVsdGFYKQoKICAgICAgZGVmIG1vdXNlRG93bihlKToKICAgICAgICAgIHNlbGYuX2VsZW1lbnQuc3R5bGUucG9zaXRpb249J2Fic29sdXRlJwogICAgICAgICAgc2VsZi5fZGVsdGFYPWUuY2xpZW50WCAtIHNlbGYuX2VsZW1lbnQub2Zmc2V0TGVmdAogICAgICAgICAgc2VsZi5fZGVsdGFZPWUuY2xpZW50WSAtIHNlbGYuX2VsZW1lbnQub2Zmc2V0VG9wCiAgICAgICAgICBkb2MuYmluZCgnbW91c2Vtb3ZlJywgZHJhZykKCiAgICAgIGRlZiBtb3VzZVVwKGUpOgogICAgICAgICAgZG9jLnVuYmluZCgnbW91c2Vtb3ZlJykKCiAgICAgIHNlbGYuX2VsZW1lbnQuYmluZCgnbW91c2Vkb3duJywgbW91c2VEb3duKQogICAgICBzZWxmLl9lbGVtZW50LmJpbmQoJ21vdXNldXAnLCBtb3VzZVVwKQo=',
'/Lib/ui/__init__.py':'ZnJvbSBicm93c2VyIGltcG9ydCBodG1sLCBkb2MgYXMgZG9jdW1lbnQKZnJvbSBEaWFsb2cgaW1wb3J0ICoKZnJvbSBQcm9ncmVzc0JhciBpbXBvcnQgKgpmcm9tIFNsaWRlciBpbXBvcnQgKgoKZGVmIGFkZF9zdHlsZXNoZWV0KCk6CiAgICBfbGluaz1odG1sLkxJTksoSHJlZj0nL3NyYy9MaWIvdWkvY3NzL3Ntb290aG5lc3MvanF1ZXJ5LXVpLTEuMTAuMy5jdXN0b20ubWluLmNzcycpCiAgICBfbGluay5yZWw9J3N0eWxlc2hlZXQnCgogICAgZG9jIDw9IF9saW5rICAgICAjIGRvY3VtZW50IGRvZXNuJ3Qgd29yayBoZXJlLi4gOiggbXVzdCB1c2UgZG9jIAo=',
'/Lib/unittest/case.py':'IiIiVGVzdCBjYXNlIGltcGxlbWVudGF0aW9uIiIiCgppbXBvcnQgc3lzCmltcG9ydCBmdW5jdG9vbHMKaW1wb3J0IGRpZmZsaWIKaW1wb3J0IHBwcmludAppbXBvcnQgcmUKaW1wb3J0IHdhcm5pbmdzCmltcG9ydCBjb2xsZWN0aW9ucwoKZnJvbSAuIGltcG9ydCByZXN1bHQKZnJvbSAudXRpbCBpbXBvcnQgKHN0cmNsYXNzLCBzYWZlX3JlcHIsIF9jb3VudF9kaWZmX2FsbF9wdXJwb3NlLAogICAgICAgICAgICAgICAgICAgX2NvdW50X2RpZmZfaGFzaGFibGUpCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKCkRJRkZfT01JVFRFRCA9ICgnXG5EaWZmIGlzICVzIGNoYXJhY3RlcnMgbG9uZy4gJwogICAgICAgICAgICAgICAgICdTZXQgc2VsZi5tYXhEaWZmIHRvIE5vbmUgdG8gc2VlIGl0LicpCgpjbGFzcyBTa2lwVGVzdChFeGNlcHRpb24pOgogICAgIiIiCiAgICBSYWlzZSB0aGlzIGV4Y2VwdGlvbiBpbiBhIHRlc3QgdG8gc2tpcCBpdC4KCiAgICBVc3VhbGx5IHlvdSBjYW4gdXNlIFRlc3RSZXN1bHQuc2tpcCgpIG9yIG9uZSBvZiB0aGUgc2tpcHBpbmcgZGVjb3JhdG9ycwogICAgaW5zdGVhZCBvZiByYWlzaW5nIHRoaXMgZGlyZWN0bHkuCiAgICAiIiIKCmNsYXNzIF9FeHBlY3RlZEZhaWx1cmUoRXhjZXB0aW9uKToKICAgICIiIgogICAgUmFpc2UgdGhpcyB3aGVuIGEgdGVzdCBpcyBleHBlY3RlZCB0byBmYWlsLgoKICAgIFRoaXMgaXMgYW4gaW1wbGVtZW50YXRpb24gZGV0YWlsLgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGV4Y19pbmZvKToKICAgICAgICBzdXBlcihfRXhwZWN0ZWRGYWlsdXJlLCBzZWxmKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5leGNfaW5mbyA9IGV4Y19pbmZvCgpjbGFzcyBfVW5leHBlY3RlZFN1Y2Nlc3MoRXhjZXB0aW9uKToKICAgICIiIgogICAgVGhlIHRlc3Qgd2FzIHN1cHBvc2VkIHRvIGZhaWwsIGJ1dCBpdCBkaWRuJ3QhCiAgICAiIiIKCgpjbGFzcyBfT3V0Y29tZShvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuc3VjY2VzcyA9IFRydWUKICAgICAgICBzZWxmLnNraXBwZWQgPSBOb25lCiAgICAgICAgc2VsZi51bmV4cGVjdGVkU3VjY2VzcyA9IE5vbmUKICAgICAgICBzZWxmLmV4cGVjdGVkRmFpbHVyZSA9IE5vbmUKICAgICAgICBzZWxmLmVycm9ycyA9IFtdCiAgICAgICAgc2VsZi5mYWlsdXJlcyA9IFtdCgoKZGVmIF9pZChvYmopOgogICAgcmV0dXJuIG9iagoKZGVmIHNraXAocmVhc29uKToKICAgICIiIgogICAgVW5jb25kaXRpb25hbGx5IHNraXAgYSB0ZXN0LgogICAgIiIiCiAgICBkZWYgZGVjb3JhdG9yKHRlc3RfaXRlbSk6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UodGVzdF9pdGVtLCB0eXBlKToKICAgICAgICAgICAgQGZ1bmN0b29scy53cmFwcyh0ZXN0X2l0ZW0pCiAgICAgICAgICAgIGRlZiBza2lwX3dyYXBwZXIoKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAgICAgICAgIHJhaXNlIFNraXBUZXN0KHJlYXNvbikKICAgICAgICAgICAgdGVzdF9pdGVtID0gc2tpcF93cmFwcGVyCgogICAgICAgIHRlc3RfaXRlbS5fX3VuaXR0ZXN0X3NraXBfXyA9IFRydWUKICAgICAgICB0ZXN0X2l0ZW0uX191bml0dGVzdF9za2lwX3doeV9fID0gcmVhc29uCiAgICAgICAgcmV0dXJuIHRlc3RfaXRlbQogICAgcmV0dXJuIGRlY29yYXRvcgoKZGVmIHNraXBJZihjb25kaXRpb24sIHJlYXNvbik6CiAgICAiIiIKICAgIFNraXAgYSB0ZXN0IGlmIHRoZSBjb25kaXRpb24gaXMgdHJ1ZS4KICAgICIiIgogICAgaWYgY29uZGl0aW9uOgogICAgICAgIHJldHVybiBza2lwKHJlYXNvbikKICAgIHJldHVybiBfaWQKCmRlZiBza2lwVW5sZXNzKGNvbmRpdGlvbiwgcmVhc29uKToKICAgICIiIgogICAgU2tpcCBhIHRlc3QgdW5sZXNzIHRoZSBjb25kaXRpb24gaXMgdHJ1ZS4KICAgICIiIgogICAgaWYgbm90IGNvbmRpdGlvbjoKICAgICAgICByZXR1cm4gc2tpcChyZWFzb24pCiAgICByZXR1cm4gX2lkCgoKZGVmIGV4cGVjdGVkRmFpbHVyZShmdW5jKToKICAgIEBmdW5jdG9vbHMud3JhcHMoZnVuYykKICAgIGRlZiB3cmFwcGVyKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBmdW5jKCphcmdzLCAqKmt3YXJncykKICAgICAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgICAgICByYWlzZSBfRXhwZWN0ZWRGYWlsdXJlKHN5cy5leGNfaW5mbygpKQogICAgICAgIHJhaXNlIF9VbmV4cGVjdGVkU3VjY2VzcwogICAgcmV0dXJuIHdyYXBwZXIKCgpjbGFzcyBfQXNzZXJ0UmFpc2VzQmFzZUNvbnRleHQob2JqZWN0KToKCiAgICBkZWYgX19pbml0X18oc2VsZiwgZXhwZWN0ZWQsIHRlc3RfY2FzZSwgY2FsbGFibGVfb2JqPU5vbmUsCiAgICAgICAgICAgICAgICAgZXhwZWN0ZWRfcmVnZXg9Tm9uZSk6CiAgICAgICAgc2VsZi5leHBlY3RlZCA9IGV4cGVjdGVkCiAgICAgICAgc2VsZi50ZXN0X2Nhc2UgPSB0ZXN0X2Nhc2UKICAgICAgICBpZiBjYWxsYWJsZV9vYmogaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYub2JqX25hbWUgPSBjYWxsYWJsZV9vYmouX19uYW1lX18KICAgICAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICAgICAgc2VsZi5vYmpfbmFtZSA9IHN0cihjYWxsYWJsZV9vYmopCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5vYmpfbmFtZSA9IE5vbmUKICAgICAgICBpZiBpc2luc3RhbmNlKGV4cGVjdGVkX3JlZ2V4LCAoYnl0ZXMsIHN0cikpOgogICAgICAgICAgICBleHBlY3RlZF9yZWdleCA9IHJlLmNvbXBpbGUoZXhwZWN0ZWRfcmVnZXgpCiAgICAgICAgc2VsZi5leHBlY3RlZF9yZWdleCA9IGV4cGVjdGVkX3JlZ2V4CiAgICAgICAgc2VsZi5tc2cgPSBOb25lCgogICAgZGVmIF9yYWlzZUZhaWx1cmUoc2VsZiwgc3RhbmRhcmRNc2cpOgogICAgICAgIG1zZyA9IHNlbGYudGVzdF9jYXNlLl9mb3JtYXRNZXNzYWdlKHNlbGYubXNnLCBzdGFuZGFyZE1zZykKICAgICAgICByYWlzZSBzZWxmLnRlc3RfY2FzZS5mYWlsdXJlRXhjZXB0aW9uKG1zZykKCiAgICBkZWYgaGFuZGxlKHNlbGYsIG5hbWUsIGNhbGxhYmxlX29iaiwgYXJncywga3dhcmdzKToKICAgICAgICAiIiIKICAgICAgICBJZiBjYWxsYWJsZV9vYmogaXMgTm9uZSwgYXNzZXJ0UmFpc2VzL1dhcm5zIGlzIGJlaW5nIHVzZWQgYXMgYQogICAgICAgIGNvbnRleHQgbWFuYWdlciwgc28gY2hlY2sgZm9yIGEgJ21zZycga3dhcmcgYW5kIHJldHVybiBzZWxmLgogICAgICAgIElmIGNhbGxhYmxlX29iaiBpcyBub3QgTm9uZSwgY2FsbCBpdCBwYXNzaW5nIGFyZ3MgYW5kIGt3YXJncy4KICAgICAgICAiIiIKICAgICAgICBpZiBjYWxsYWJsZV9vYmogaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5tc2cgPSBrd2FyZ3MucG9wKCdtc2cnLCBOb25lKQogICAgICAgICAgICByZXR1cm4gc2VsZgogICAgICAgIHdpdGggc2VsZjoKICAgICAgICAgICAgY2FsbGFibGVfb2JqKCphcmdzLCAqKmt3YXJncykKCgoKY2xhc3MgX0Fzc2VydFJhaXNlc0NvbnRleHQoX0Fzc2VydFJhaXNlc0Jhc2VDb250ZXh0KToKICAgICIiIkEgY29udGV4dCBtYW5hZ2VyIHVzZWQgdG8gaW1wbGVtZW50IFRlc3RDYXNlLmFzc2VydFJhaXNlcyogbWV0aG9kcy4iIiIKCiAgICBkZWYgX19lbnRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fZXhpdF9fKHNlbGYsIGV4Y190eXBlLCBleGNfdmFsdWUsIHRiKToKICAgICAgICBpZiBleGNfdHlwZSBpcyBOb25lOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBleGNfbmFtZSA9IHNlbGYuZXhwZWN0ZWQuX19uYW1lX18KICAgICAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICAgICAgZXhjX25hbWUgPSBzdHIoc2VsZi5leHBlY3RlZCkKICAgICAgICAgICAgaWYgc2VsZi5vYmpfbmFtZToKICAgICAgICAgICAgICAgIHNlbGYuX3JhaXNlRmFpbHVyZSgie30gbm90IHJhaXNlZCBieSB7fSIuZm9ybWF0KGV4Y19uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5vYmpfbmFtZSkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLl9yYWlzZUZhaWx1cmUoInt9IG5vdCByYWlzZWQiLmZvcm1hdChleGNfbmFtZSkpCiAgICAgICAgaWYgbm90IGlzc3ViY2xhc3MoZXhjX3R5cGUsIHNlbGYuZXhwZWN0ZWQpOgogICAgICAgICAgICAjIGxldCB1bmV4cGVjdGVkIGV4Y2VwdGlvbnMgcGFzcyB0aHJvdWdoCiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICMgc3RvcmUgZXhjZXB0aW9uLCB3aXRob3V0IHRyYWNlYmFjaywgZm9yIGxhdGVyIHJldHJpZXZhbAogICAgICAgIHNlbGYuZXhjZXB0aW9uID0gZXhjX3ZhbHVlLndpdGhfdHJhY2ViYWNrKE5vbmUpCiAgICAgICAgaWYgc2VsZi5leHBlY3RlZF9yZWdleCBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gVHJ1ZQoKICAgICAgICBleHBlY3RlZF9yZWdleCA9IHNlbGYuZXhwZWN0ZWRfcmVnZXgKICAgICAgICBpZiBub3QgZXhwZWN0ZWRfcmVnZXguc2VhcmNoKHN0cihleGNfdmFsdWUpKToKICAgICAgICAgICAgc2VsZi5fcmFpc2VGYWlsdXJlKCcie30iIGRvZXMgbm90IG1hdGNoICJ7fSInLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWRfcmVnZXgucGF0dGVybiwgc3RyKGV4Y192YWx1ZSkpKQogICAgICAgIHJldHVybiBUcnVlCgoKY2xhc3MgX0Fzc2VydFdhcm5zQ29udGV4dChfQXNzZXJ0UmFpc2VzQmFzZUNvbnRleHQpOgogICAgIiIiQSBjb250ZXh0IG1hbmFnZXIgdXNlZCB0byBpbXBsZW1lbnQgVGVzdENhc2UuYXNzZXJ0V2FybnMqIG1ldGhvZHMuIiIiCgogICAgZGVmIF9fZW50ZXJfXyhzZWxmKToKICAgICAgICAjIFRoZSBfX3dhcm5pbmdyZWdpc3RyeV9fJ3MgbmVlZCB0byBiZSBpbiBhIHByaXN0aW5lIHN0YXRlIGZvciB0ZXN0cwogICAgICAgICMgdG8gd29yayBwcm9wZXJseS4KICAgICAgICBmb3IgdiBpbiBzeXMubW9kdWxlcy52YWx1ZXMoKToKICAgICAgICAgICAgaWYgZ2V0YXR0cih2LCAnX193YXJuaW5ncmVnaXN0cnlfXycsIE5vbmUpOgogICAgICAgICAgICAgICAgdi5fX3dhcm5pbmdyZWdpc3RyeV9fID0ge30KICAgICAgICBzZWxmLndhcm5pbmdzX21hbmFnZXIgPSB3YXJuaW5ncy5jYXRjaF93YXJuaW5ncyhyZWNvcmQ9VHJ1ZSkKICAgICAgICBzZWxmLndhcm5pbmdzID0gc2VsZi53YXJuaW5nc19tYW5hZ2VyLl9fZW50ZXJfXygpCiAgICAgICAgd2FybmluZ3Muc2ltcGxlZmlsdGVyKCJhbHdheXMiLCBzZWxmLmV4cGVjdGVkKQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fZXhpdF9fKHNlbGYsIGV4Y190eXBlLCBleGNfdmFsdWUsIHRiKToKICAgICAgICBzZWxmLndhcm5pbmdzX21hbmFnZXIuX19leGl0X18oZXhjX3R5cGUsIGV4Y192YWx1ZSwgdGIpCiAgICAgICAgaWYgZXhjX3R5cGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICMgbGV0IHVuZXhwZWN0ZWQgZXhjZXB0aW9ucyBwYXNzIHRocm91Z2gKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgdHJ5OgogICAgICAgICAgICBleGNfbmFtZSA9IHNlbGYuZXhwZWN0ZWQuX19uYW1lX18KICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIGV4Y19uYW1lID0gc3RyKHNlbGYuZXhwZWN0ZWQpCiAgICAgICAgZmlyc3RfbWF0Y2hpbmcgPSBOb25lCiAgICAgICAgZm9yIG0gaW4gc2VsZi53YXJuaW5nczoKICAgICAgICAgICAgdyA9IG0ubWVzc2FnZQogICAgICAgICAgICBpZiBub3QgaXNpbnN0YW5jZSh3LCBzZWxmLmV4cGVjdGVkKToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGlmIGZpcnN0X21hdGNoaW5nIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBmaXJzdF9tYXRjaGluZyA9IHcKICAgICAgICAgICAgaWYgKHNlbGYuZXhwZWN0ZWRfcmVnZXggaXMgbm90IE5vbmUgYW5kCiAgICAgICAgICAgICAgICBub3Qgc2VsZi5leHBlY3RlZF9yZWdleC5zZWFyY2goc3RyKHcpKSk6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAjIHN0b3JlIHdhcm5pbmcgZm9yIGxhdGVyIHJldHJpZXZhbAogICAgICAgICAgICBzZWxmLndhcm5pbmcgPSB3CiAgICAgICAgICAgIHNlbGYuZmlsZW5hbWUgPSBtLmZpbGVuYW1lCiAgICAgICAgICAgIHNlbGYubGluZW5vID0gbS5saW5lbm8KICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgIyBOb3cgd2Ugc2ltcGx5IHRyeSB0byBjaG9vc2UgYSBoZWxwZnVsIGZhaWx1cmUgbWVzc2FnZQogICAgICAgIGlmIGZpcnN0X21hdGNoaW5nIGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLl9yYWlzZUZhaWx1cmUoJyJ7fSIgZG9lcyBub3QgbWF0Y2ggInt9IicuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgICBzZWxmLmV4cGVjdGVkX3JlZ2V4LnBhdHRlcm4sIHN0cihmaXJzdF9tYXRjaGluZykpKQogICAgICAgIGlmIHNlbGYub2JqX25hbWU6CiAgICAgICAgICAgIHNlbGYuX3JhaXNlRmFpbHVyZSgie30gbm90IHRyaWdnZXJlZCBieSB7fSIuZm9ybWF0KGV4Y19uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm9ial9uYW1lKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl9yYWlzZUZhaWx1cmUoInt9IG5vdCB0cmlnZ2VyZWQiLmZvcm1hdChleGNfbmFtZSkpCgoKY2xhc3MgVGVzdENhc2Uob2JqZWN0KToKICAgICIiIkEgY2xhc3Mgd2hvc2UgaW5zdGFuY2VzIGFyZSBzaW5nbGUgdGVzdCBjYXNlcy4KCiAgICBCeSBkZWZhdWx0LCB0aGUgdGVzdCBjb2RlIGl0c2VsZiBzaG91bGQgYmUgcGxhY2VkIGluIGEgbWV0aG9kIG5hbWVkCiAgICAncnVuVGVzdCcuCgogICAgSWYgdGhlIGZpeHR1cmUgbWF5IGJlIHVzZWQgZm9yIG1hbnkgdGVzdCBjYXNlcywgY3JlYXRlIGFzCiAgICBtYW55IHRlc3QgbWV0aG9kcyBhcyBhcmUgbmVlZGVkLiBXaGVuIGluc3RhbnRpYXRpbmcgc3VjaCBhIFRlc3RDYXNlCiAgICBzdWJjbGFzcywgc3BlY2lmeSBpbiB0aGUgY29uc3RydWN0b3IgYXJndW1lbnRzIHRoZSBuYW1lIG9mIHRoZSB0ZXN0IG1ldGhvZAogICAgdGhhdCB0aGUgaW5zdGFuY2UgaXMgdG8gZXhlY3V0ZS4KCiAgICBUZXN0IGF1dGhvcnMgc2hvdWxkIHN1YmNsYXNzIFRlc3RDYXNlIGZvciB0aGVpciBvd24gdGVzdHMuIENvbnN0cnVjdGlvbgogICAgYW5kIGRlY29uc3RydWN0aW9uIG9mIHRoZSB0ZXN0J3MgZW52aXJvbm1lbnQgKCdmaXh0dXJlJykgY2FuIGJlCiAgICBpbXBsZW1lbnRlZCBieSBvdmVycmlkaW5nIHRoZSAnc2V0VXAnIGFuZCAndGVhckRvd24nIG1ldGhvZHMgcmVzcGVjdGl2ZWx5LgoKICAgIElmIGl0IGlzIG5lY2Vzc2FyeSB0byBvdmVycmlkZSB0aGUgX19pbml0X18gbWV0aG9kLCB0aGUgYmFzZSBjbGFzcwogICAgX19pbml0X18gbWV0aG9kIG11c3QgYWx3YXlzIGJlIGNhbGxlZC4gSXQgaXMgaW1wb3J0YW50IHRoYXQgc3ViY2xhc3NlcwogICAgc2hvdWxkIG5vdCBjaGFuZ2UgdGhlIHNpZ25hdHVyZSBvZiB0aGVpciBfX2luaXRfXyBtZXRob2QsIHNpbmNlIGluc3RhbmNlcwogICAgb2YgdGhlIGNsYXNzZXMgYXJlIGluc3RhbnRpYXRlZCBhdXRvbWF0aWNhbGx5IGJ5IHBhcnRzIG9mIHRoZSBmcmFtZXdvcmsKICAgIGluIG9yZGVyIHRvIGJlIHJ1bi4KICAgICIiIgoKICAgICMgVGhpcyBhdHRyaWJ1dGUgZGV0ZXJtaW5lcyB3aGljaCBleGNlcHRpb24gd2lsbCBiZSByYWlzZWQgd2hlbgogICAgIyB0aGUgaW5zdGFuY2UncyBhc3NlcnRpb24gbWV0aG9kcyBmYWlsOyB0ZXN0IG1ldGhvZHMgcmFpc2luZyB0aGlzCiAgICAjIGV4Y2VwdGlvbiB3aWxsIGJlIGRlZW1lZCB0byBoYXZlICdmYWlsZWQnIHJhdGhlciB0aGFuICdlcnJvcmVkJwoKICAgIGZhaWx1cmVFeGNlcHRpb24gPSBBc3NlcnRpb25FcnJvcgoKICAgICMgVGhpcyBhdHRyaWJ1dGUgZGV0ZXJtaW5lcyB3aGV0aGVyIGxvbmcgbWVzc2FnZXMgKGluY2x1ZGluZyByZXByIG9mCiAgICAjIG9iamVjdHMgdXNlZCBpbiBhc3NlcnQgbWV0aG9kcykgd2lsbCBiZSBwcmludGVkIG9uIGZhaWx1cmUgaW4gKmFkZGl0aW9uKgogICAgIyB0byBhbnkgZXhwbGljaXQgbWVzc2FnZSBwYXNzZWQuCgogICAgbG9uZ01lc3NhZ2UgPSBUcnVlCgogICAgIyBUaGlzIGF0dHJpYnV0ZSBzZXRzIHRoZSBtYXhpbXVtIGxlbmd0aCBvZiBhIGRpZmYgaW4gZmFpbHVyZSBtZXNzYWdlcwogICAgIyBieSBhc3NlcnQgbWV0aG9kcyB1c2luZyBkaWZmbGliLiBJdCBpcyBsb29rZWQgdXAgYXMgYW4gaW5zdGFuY2UgYXR0cmlidXRlCiAgICAjIHNvIGNhbiBiZSBjb25maWd1cmVkIGJ5IGluZGl2aWR1YWwgdGVzdHMgaWYgcmVxdWlyZWQuCgogICAgbWF4RGlmZiA9IDgwKjgKCiAgICAjIElmIGEgc3RyaW5nIGlzIGxvbmdlciB0aGFuIF9kaWZmVGhyZXNob2xkLCB1c2Ugbm9ybWFsIGNvbXBhcmlzb24gaW5zdGVhZAogICAgIyBvZiBkaWZmbGliLiAgU2VlICMxMTc2My4KICAgIF9kaWZmVGhyZXNob2xkID0gMioqMTYKCiAgICAjIEF0dHJpYnV0ZSB1c2VkIGJ5IFRlc3RTdWl0ZSBmb3IgY2xhc3NTZXRVcAoKICAgIF9jbGFzc1NldHVwRmFpbGVkID0gRmFsc2UKCiAgICBkZWYgX19pbml0X18oc2VsZiwgbWV0aG9kTmFtZT0ncnVuVGVzdCcpOgogICAgICAgICIiIkNyZWF0ZSBhbiBpbnN0YW5jZSBvZiB0aGUgY2xhc3MgdGhhdCB3aWxsIHVzZSB0aGUgbmFtZWQgdGVzdAogICAgICAgICAgIG1ldGhvZCB3aGVuIGV4ZWN1dGVkLiBSYWlzZXMgYSBWYWx1ZUVycm9yIGlmIHRoZSBpbnN0YW5jZSBkb2VzCiAgICAgICAgICAgbm90IGhhdmUgYSBtZXRob2Qgd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWUuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fdGVzdE1ldGhvZE5hbWUgPSBtZXRob2ROYW1lCiAgICAgICAgc2VsZi5fb3V0Y29tZUZvckRvQ2xlYW51cHMgPSBOb25lCiAgICAgICAgc2VsZi5fdGVzdE1ldGhvZERvYyA9ICdObyB0ZXN0JwogICAgICAgIHRyeToKICAgICAgICAgICAgdGVzdE1ldGhvZCA9IGdldGF0dHIoc2VsZiwgbWV0aG9kTmFtZSkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIGlmIG1ldGhvZE5hbWUgIT0gJ3J1blRlc3QnOgogICAgICAgICAgICAgICAgIyB3ZSBhbGxvdyBpbnN0YW50aWF0aW9uIHdpdGggbm8gZXhwbGljaXQgbWV0aG9kIG5hbWUKICAgICAgICAgICAgICAgICMgYnV0IG5vdCBhbiAqaW5jb3JyZWN0KiBvciBtaXNzaW5nIG1ldGhvZCBuYW1lCiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJubyBzdWNoIHRlc3QgbWV0aG9kIGluICVzOiAlcyIgJQogICAgICAgICAgICAgICAgICAgICAgKHNlbGYuX19jbGFzc19fLCBtZXRob2ROYW1lKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl90ZXN0TWV0aG9kRG9jID0gdGVzdE1ldGhvZC5fX2RvY19fCiAgICAgICAgc2VsZi5fY2xlYW51cHMgPSBbXQoKICAgICAgICAjIE1hcCB0eXBlcyB0byBjdXN0b20gYXNzZXJ0RXF1YWwgZnVuY3Rpb25zIHRoYXQgd2lsbCBjb21wYXJlCiAgICAgICAgIyBpbnN0YW5jZXMgb2Ygc2FpZCB0eXBlIGluIG1vcmUgZGV0YWlsIHRvIGdlbmVyYXRlIGEgbW9yZSB1c2VmdWwKICAgICAgICAjIGVycm9yIG1lc3NhZ2UuCiAgICAgICAgc2VsZi5fdHlwZV9lcXVhbGl0eV9mdW5jcyA9IHt9CiAgICAgICAgc2VsZi5hZGRUeXBlRXF1YWxpdHlGdW5jKGRpY3QsICdhc3NlcnREaWN0RXF1YWwnKQogICAgICAgIHNlbGYuYWRkVHlwZUVxdWFsaXR5RnVuYyhsaXN0LCAnYXNzZXJ0TGlzdEVxdWFsJykKICAgICAgICBzZWxmLmFkZFR5cGVFcXVhbGl0eUZ1bmModHVwbGUsICdhc3NlcnRUdXBsZUVxdWFsJykKICAgICAgICBzZWxmLmFkZFR5cGVFcXVhbGl0eUZ1bmMoc2V0LCAnYXNzZXJ0U2V0RXF1YWwnKQogICAgICAgIHNlbGYuYWRkVHlwZUVxdWFsaXR5RnVuYyhmcm96ZW5zZXQsICdhc3NlcnRTZXRFcXVhbCcpCiAgICAgICAgc2VsZi5hZGRUeXBlRXF1YWxpdHlGdW5jKHN0ciwgJ2Fzc2VydE11bHRpTGluZUVxdWFsJykKCiAgICBkZWYgYWRkVHlwZUVxdWFsaXR5RnVuYyhzZWxmLCB0eXBlb2JqLCBmdW5jdGlvbik6CiAgICAgICAgIiIiQWRkIGEgdHlwZSBzcGVjaWZpYyBhc3NlcnRFcXVhbCBzdHlsZSBmdW5jdGlvbiB0byBjb21wYXJlIGEgdHlwZS4KCiAgICAgICAgVGhpcyBtZXRob2QgaXMgZm9yIHVzZSBieSBUZXN0Q2FzZSBzdWJjbGFzc2VzIHRoYXQgbmVlZCB0byByZWdpc3RlcgogICAgICAgIHRoZWlyIG93biB0eXBlIGVxdWFsaXR5IGZ1bmN0aW9ucyB0byBwcm92aWRlIG5pY2VyIGVycm9yIG1lc3NhZ2VzLgoKICAgICAgICBBcmdzOgogICAgICAgICAgICB0eXBlb2JqOiBUaGUgZGF0YSB0eXBlIHRvIGNhbGwgdGhpcyBmdW5jdGlvbiBvbiB3aGVuIGJvdGggdmFsdWVzCiAgICAgICAgICAgICAgICAgICAgYXJlIG9mIHRoZSBzYW1lIHR5cGUgaW4gYXNzZXJ0RXF1YWwoKS4KICAgICAgICAgICAgZnVuY3Rpb246IFRoZSBjYWxsYWJsZSB0YWtpbmcgdHdvIGFyZ3VtZW50cyBhbmQgYW4gb3B0aW9uYWwKICAgICAgICAgICAgICAgICAgICBtc2c9IGFyZ3VtZW50IHRoYXQgcmFpc2VzIHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiB3aXRoIGEKICAgICAgICAgICAgICAgICAgICB1c2VmdWwgZXJyb3IgbWVzc2FnZSB3aGVuIHRoZSB0d28gYXJndW1lbnRzIGFyZSBub3QgZXF1YWwuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fdHlwZV9lcXVhbGl0eV9mdW5jc1t0eXBlb2JqXSA9IGZ1bmN0aW9uCgogICAgZGVmIGFkZENsZWFudXAoc2VsZiwgZnVuY3Rpb24sICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgIiIiQWRkIGEgZnVuY3Rpb24sIHdpdGggYXJndW1lbnRzLCB0byBiZSBjYWxsZWQgd2hlbiB0aGUgdGVzdCBpcwogICAgICAgIGNvbXBsZXRlZC4gRnVuY3Rpb25zIGFkZGVkIGFyZSBjYWxsZWQgb24gYSBMSUZPIGJhc2lzIGFuZCBhcmUKICAgICAgICBjYWxsZWQgYWZ0ZXIgdGVhckRvd24gb24gdGVzdCBmYWlsdXJlIG9yIHN1Y2Nlc3MuCgogICAgICAgIENsZWFudXAgaXRlbXMgYXJlIGNhbGxlZCBldmVuIGlmIHNldFVwIGZhaWxzICh1bmxpa2UgdGVhckRvd24pLiIiIgogICAgICAgIHNlbGYuX2NsZWFudXBzLmFwcGVuZCgoZnVuY3Rpb24sIGFyZ3MsIGt3YXJncykpCgogICAgZGVmIHNldFVwKHNlbGYpOgogICAgICAgICJIb29rIG1ldGhvZCBmb3Igc2V0dGluZyB1cCB0aGUgdGVzdCBmaXh0dXJlIGJlZm9yZSBleGVyY2lzaW5nIGl0LiIKICAgICAgICBwYXNzCgogICAgZGVmIHRlYXJEb3duKHNlbGYpOgogICAgICAgICJIb29rIG1ldGhvZCBmb3IgZGVjb25zdHJ1Y3RpbmcgdGhlIHRlc3QgZml4dHVyZSBhZnRlciB0ZXN0aW5nIGl0LiIKICAgICAgICBwYXNzCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgc2V0VXBDbGFzcyhjbHMpOgogICAgICAgICJIb29rIG1ldGhvZCBmb3Igc2V0dGluZyB1cCBjbGFzcyBmaXh0dXJlIGJlZm9yZSBydW5uaW5nIHRlc3RzIGluIHRoZSBjbGFzcy4iCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgdGVhckRvd25DbGFzcyhjbHMpOgogICAgICAgICJIb29rIG1ldGhvZCBmb3IgZGVjb25zdHJ1Y3RpbmcgdGhlIGNsYXNzIGZpeHR1cmUgYWZ0ZXIgcnVubmluZyBhbGwgdGVzdHMgaW4gdGhlIGNsYXNzLiIKCiAgICBkZWYgY291bnRUZXN0Q2FzZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIDEKCiAgICBkZWYgZGVmYXVsdFRlc3RSZXN1bHQoc2VsZik6CiAgICAgICAgcmV0dXJuIHJlc3VsdC5UZXN0UmVzdWx0KCkKCiAgICBkZWYgc2hvcnREZXNjcmlwdGlvbihzZWxmKToKICAgICAgICAiIiJSZXR1cm5zIGEgb25lLWxpbmUgZGVzY3JpcHRpb24gb2YgdGhlIHRlc3QsIG9yIE5vbmUgaWYgbm8KICAgICAgICBkZXNjcmlwdGlvbiBoYXMgYmVlbiBwcm92aWRlZC4KCiAgICAgICAgVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBtZXRob2QgcmV0dXJucyB0aGUgZmlyc3QgbGluZSBvZgogICAgICAgIHRoZSBzcGVjaWZpZWQgdGVzdCBtZXRob2QncyBkb2NzdHJpbmcuCiAgICAgICAgIiIiCiAgICAgICAgZG9jID0gc2VsZi5fdGVzdE1ldGhvZERvYwogICAgICAgIHJldHVybiBkb2MgYW5kIGRvYy5zcGxpdCgiXG4iKVswXS5zdHJpcCgpIG9yIE5vbmUKCgogICAgZGVmIGlkKHNlbGYpOgogICAgICAgIHJldHVybiAiJXMuJXMiICUgKHN0cmNsYXNzKHNlbGYuX19jbGFzc19fKSwgc2VsZi5fdGVzdE1ldGhvZE5hbWUpCgogICAgZGVmIF9fZXFfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgdHlwZShzZWxmKSBpcyBub3QgdHlwZShvdGhlcik6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgICAgICByZXR1cm4gc2VsZi5fdGVzdE1ldGhvZE5hbWUgPT0gb3RoZXIuX3Rlc3RNZXRob2ROYW1lCgogICAgZGVmIF9faGFzaF9fKHNlbGYpOgogICAgICAgIHJldHVybiBoYXNoKCh0eXBlKHNlbGYpLCBzZWxmLl90ZXN0TWV0aG9kTmFtZSkpCgogICAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgICAgcmV0dXJuICIlcyAoJXMpIiAlIChzZWxmLl90ZXN0TWV0aG9kTmFtZSwgc3RyY2xhc3Moc2VsZi5fX2NsYXNzX18pKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gIjwlcyB0ZXN0TWV0aG9kPSVzPiIgJSBcCiAgICAgICAgICAgICAgIChzdHJjbGFzcyhzZWxmLl9fY2xhc3NfXyksIHNlbGYuX3Rlc3RNZXRob2ROYW1lKQoKICAgIGRlZiBfYWRkU2tpcChzZWxmLCByZXN1bHQsIHJlYXNvbik6CiAgICAgICAgYWRkU2tpcCA9IGdldGF0dHIocmVzdWx0LCAnYWRkU2tpcCcsIE5vbmUpCiAgICAgICAgaWYgYWRkU2tpcCBpcyBub3QgTm9uZToKICAgICAgICAgICAgYWRkU2tpcChzZWxmLCByZWFzb24pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgd2FybmluZ3Mud2FybigiVGVzdFJlc3VsdCBoYXMgbm8gYWRkU2tpcCBtZXRob2QsIHNraXBzIG5vdCByZXBvcnRlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgUnVudGltZVdhcm5pbmcsIDIpCiAgICAgICAgICAgIHJlc3VsdC5hZGRTdWNjZXNzKHNlbGYpCgogICAgZGVmIF9leGVjdXRlVGVzdFBhcnQoc2VsZiwgZnVuY3Rpb24sIG91dGNvbWUsIGlzVGVzdD1GYWxzZSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBmdW5jdGlvbigpCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdCBTa2lwVGVzdCBhcyBlOgogICAgICAgICAgICBvdXRjb21lLnN1Y2Nlc3MgPSBGYWxzZQogICAgICAgICAgICBvdXRjb21lLnNraXBwZWQgPSBzdHIoZSkKICAgICAgICBleGNlcHQgX1VuZXhwZWN0ZWRTdWNjZXNzOgogICAgICAgICAgICBleGNfaW5mbyA9IHN5cy5leGNfaW5mbygpCiAgICAgICAgICAgIG91dGNvbWUuc3VjY2VzcyA9IEZhbHNlCiAgICAgICAgICAgIGlmIGlzVGVzdDoKICAgICAgICAgICAgICAgIG91dGNvbWUudW5leHBlY3RlZFN1Y2Nlc3MgPSBleGNfaW5mbwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgb3V0Y29tZS5lcnJvcnMuYXBwZW5kKGV4Y19pbmZvKQogICAgICAgIGV4Y2VwdCBfRXhwZWN0ZWRGYWlsdXJlOgogICAgICAgICAgICBvdXRjb21lLnN1Y2Nlc3MgPSBGYWxzZQogICAgICAgICAgICBleGNfaW5mbyA9IHN5cy5leGNfaW5mbygpCiAgICAgICAgICAgIGlmIGlzVGVzdDoKICAgICAgICAgICAgICAgIG91dGNvbWUuZXhwZWN0ZWRGYWlsdXJlID0gZXhjX2luZm8KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG91dGNvbWUuZXJyb3JzLmFwcGVuZChleGNfaW5mbykKICAgICAgICBleGNlcHQgc2VsZi5mYWlsdXJlRXhjZXB0aW9uOgogICAgICAgICAgICBvdXRjb21lLnN1Y2Nlc3MgPSBGYWxzZQogICAgICAgICAgICBvdXRjb21lLmZhaWx1cmVzLmFwcGVuZChzeXMuZXhjX2luZm8oKSkKICAgICAgICAgICAgZXhjX2luZm8gPSBzeXMuZXhjX2luZm8oKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgb3V0Y29tZS5zdWNjZXNzID0gRmFsc2UKICAgICAgICAgICAgb3V0Y29tZS5lcnJvcnMuYXBwZW5kKHN5cy5leGNfaW5mbygpKQoKICAgIGRlZiBydW4oc2VsZiwgcmVzdWx0PU5vbmUpOgogICAgICAgIG9yaWdfcmVzdWx0ID0gcmVzdWx0CiAgICAgICAgaWYgcmVzdWx0IGlzIE5vbmU6CiAgICAgICAgICAgIHJlc3VsdCA9IHNlbGYuZGVmYXVsdFRlc3RSZXN1bHQoKQogICAgICAgICAgICBzdGFydFRlc3RSdW4gPSBnZXRhdHRyKHJlc3VsdCwgJ3N0YXJ0VGVzdFJ1bicsIE5vbmUpCiAgICAgICAgICAgIGlmIHN0YXJ0VGVzdFJ1biBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHN0YXJ0VGVzdFJ1bigpCgogICAgICAgIHJlc3VsdC5zdGFydFRlc3Qoc2VsZikKCiAgICAgICAgdGVzdE1ldGhvZCA9IGdldGF0dHIoc2VsZiwgc2VsZi5fdGVzdE1ldGhvZE5hbWUpCiAgICAgICAgaWYgKGdldGF0dHIoc2VsZi5fX2NsYXNzX18sICJfX3VuaXR0ZXN0X3NraXBfXyIsIEZhbHNlKSBvcgogICAgICAgICAgICBnZXRhdHRyKHRlc3RNZXRob2QsICJfX3VuaXR0ZXN0X3NraXBfXyIsIEZhbHNlKSk6CiAgICAgICAgICAgICMgSWYgdGhlIGNsYXNzIG9yIG1ldGhvZCB3YXMgc2tpcHBlZC4KICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2tpcF93aHkgPSAoZ2V0YXR0cihzZWxmLl9fY2xhc3NfXywgJ19fdW5pdHRlc3Rfc2tpcF93aHlfXycsICcnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3IgZ2V0YXR0cih0ZXN0TWV0aG9kLCAnX191bml0dGVzdF9za2lwX3doeV9fJywgJycpKQogICAgICAgICAgICAgICAgc2VsZi5fYWRkU2tpcChyZXN1bHQsIHNraXBfd2h5KQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgcmVzdWx0LnN0b3BUZXN0KHNlbGYpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIHRyeToKICAgICAgICAgICAgb3V0Y29tZSA9IF9PdXRjb21lKCkKICAgICAgICAgICAgc2VsZi5fb3V0Y29tZUZvckRvQ2xlYW51cHMgPSBvdXRjb21lCgogICAgICAgICAgICBzZWxmLl9leGVjdXRlVGVzdFBhcnQoc2VsZi5zZXRVcCwgb3V0Y29tZSkKICAgICAgICAgICAgaWYgb3V0Y29tZS5zdWNjZXNzOgogICAgICAgICAgICAgICAgc2VsZi5fZXhlY3V0ZVRlc3RQYXJ0KHRlc3RNZXRob2QsIG91dGNvbWUsIGlzVGVzdD1UcnVlKQogICAgICAgICAgICAgICAgc2VsZi5fZXhlY3V0ZVRlc3RQYXJ0KHNlbGYudGVhckRvd24sIG91dGNvbWUpCgogICAgICAgICAgICBzZWxmLmRvQ2xlYW51cHMoKQogICAgICAgICAgICBpZiBvdXRjb21lLnN1Y2Nlc3M6CiAgICAgICAgICAgICAgICByZXN1bHQuYWRkU3VjY2VzcyhzZWxmKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgb3V0Y29tZS5za2lwcGVkIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX2FkZFNraXAocmVzdWx0LCBvdXRjb21lLnNraXBwZWQpCiAgICAgICAgICAgICAgICBmb3IgZXhjX2luZm8gaW4gb3V0Y29tZS5lcnJvcnM6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmFkZEVycm9yKHNlbGYsIGV4Y19pbmZvKQogICAgICAgICAgICAgICAgZm9yIGV4Y19pbmZvIGluIG91dGNvbWUuZmFpbHVyZXM6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmFkZEZhaWx1cmUoc2VsZiwgZXhjX2luZm8pCiAgICAgICAgICAgICAgICBpZiBvdXRjb21lLnVuZXhwZWN0ZWRTdWNjZXNzIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIGFkZFVuZXhwZWN0ZWRTdWNjZXNzID0gZ2V0YXR0cihyZXN1bHQsICdhZGRVbmV4cGVjdGVkU3VjY2VzcycsIE5vbmUpCiAgICAgICAgICAgICAgICAgICAgaWYgYWRkVW5leHBlY3RlZFN1Y2Nlc3MgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIGFkZFVuZXhwZWN0ZWRTdWNjZXNzKHNlbGYpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgd2FybmluZ3Mud2FybigiVGVzdFJlc3VsdCBoYXMgbm8gYWRkVW5leHBlY3RlZFN1Y2Nlc3MgbWV0aG9kLCByZXBvcnRpbmcgYXMgZmFpbHVyZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJ1bnRpbWVXYXJuaW5nKQogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuYWRkRmFpbHVyZShzZWxmLCBvdXRjb21lLnVuZXhwZWN0ZWRTdWNjZXNzKQoKICAgICAgICAgICAgICAgIGlmIG91dGNvbWUuZXhwZWN0ZWRGYWlsdXJlIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIGFkZEV4cGVjdGVkRmFpbHVyZSA9IGdldGF0dHIocmVzdWx0LCAnYWRkRXhwZWN0ZWRGYWlsdXJlJywgTm9uZSkKICAgICAgICAgICAgICAgICAgICBpZiBhZGRFeHBlY3RlZEZhaWx1cmUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIGFkZEV4cGVjdGVkRmFpbHVyZShzZWxmLCBvdXRjb21lLmV4cGVjdGVkRmFpbHVyZSkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICB3YXJuaW5ncy53YXJuKCJUZXN0UmVzdWx0IGhhcyBubyBhZGRFeHBlY3RlZEZhaWx1cmUgbWV0aG9kLCByZXBvcnRpbmcgYXMgcGFzc2VzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSdW50aW1lV2FybmluZykKICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmFkZFN1Y2Nlc3Moc2VsZikKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHJlc3VsdC5zdG9wVGVzdChzZWxmKQogICAgICAgICAgICBpZiBvcmlnX3Jlc3VsdCBpcyBOb25lOgogICAgICAgICAgICAgICAgc3RvcFRlc3RSdW4gPSBnZXRhdHRyKHJlc3VsdCwgJ3N0b3BUZXN0UnVuJywgTm9uZSkKICAgICAgICAgICAgICAgIGlmIHN0b3BUZXN0UnVuIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIHN0b3BUZXN0UnVuKCkKCiAgICBkZWYgZG9DbGVhbnVwcyhzZWxmKToKICAgICAgICAiIiJFeGVjdXRlIGFsbCBjbGVhbnVwIGZ1bmN0aW9ucy4gTm9ybWFsbHkgY2FsbGVkIGZvciB5b3UgYWZ0ZXIKICAgICAgICB0ZWFyRG93bi4iIiIKICAgICAgICBvdXRjb21lID0gc2VsZi5fb3V0Y29tZUZvckRvQ2xlYW51cHMgb3IgX091dGNvbWUoKQogICAgICAgIHdoaWxlIHNlbGYuX2NsZWFudXBzOgogICAgICAgICAgICBmdW5jdGlvbiwgYXJncywga3dhcmdzID0gc2VsZi5fY2xlYW51cHMucG9wKCkKICAgICAgICAgICAgcGFydCA9IGxhbWJkYTogZnVuY3Rpb24oKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBzZWxmLl9leGVjdXRlVGVzdFBhcnQocGFydCwgb3V0Y29tZSkKCiAgICAgICAgIyByZXR1cm4gdGhpcyBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkKICAgICAgICAjIGV2ZW4gdGhvdWdoIHdlIG5vIGxvbmdlciB1cyBpdCBpbnRlcm5hbGx5CiAgICAgICAgcmV0dXJuIG91dGNvbWUuc3VjY2VzcwoKICAgIGRlZiBfX2NhbGxfXyhzZWxmLCAqYXJncywgKiprd2RzKToKICAgICAgICByZXR1cm4gc2VsZi5ydW4oKmFyZ3MsICoqa3dkcykKCiAgICBkZWYgZGVidWcoc2VsZik6CiAgICAgICAgIiIiUnVuIHRoZSB0ZXN0IHdpdGhvdXQgY29sbGVjdGluZyBlcnJvcnMgaW4gYSBUZXN0UmVzdWx0IiIiCiAgICAgICAgc2VsZi5zZXRVcCgpCiAgICAgICAgZ2V0YXR0cihzZWxmLCBzZWxmLl90ZXN0TWV0aG9kTmFtZSkoKQogICAgICAgIHNlbGYudGVhckRvd24oKQogICAgICAgIHdoaWxlIHNlbGYuX2NsZWFudXBzOgogICAgICAgICAgICBmdW5jdGlvbiwgYXJncywga3dhcmdzID0gc2VsZi5fY2xlYW51cHMucG9wKC0xKQogICAgICAgICAgICBmdW5jdGlvbigqYXJncywgKiprd2FyZ3MpCgogICAgZGVmIHNraXBUZXN0KHNlbGYsIHJlYXNvbik6CiAgICAgICAgIiIiU2tpcCB0aGlzIHRlc3QuIiIiCiAgICAgICAgcmFpc2UgU2tpcFRlc3QocmVhc29uKQoKICAgIGRlZiBmYWlsKHNlbGYsIG1zZz1Ob25lKToKICAgICAgICAiIiJGYWlsIGltbWVkaWF0ZWx5LCB3aXRoIHRoZSBnaXZlbiBtZXNzYWdlLiIiIgogICAgICAgIHJhaXNlIHNlbGYuZmFpbHVyZUV4Y2VwdGlvbihtc2cpCgogICAgZGVmIGFzc2VydEZhbHNlKHNlbGYsIGV4cHIsIG1zZz1Ob25lKToKICAgICAgICAiIiJDaGVjayB0aGF0IHRoZSBleHByZXNzaW9uIGlzIGZhbHNlLiIiIgogICAgICAgIGlmIGV4cHI6CiAgICAgICAgICAgIG1zZyA9IHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCAiJXMgaXMgbm90IGZhbHNlIiAlIHNhZmVfcmVwcihleHByKSkKICAgICAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKG1zZykKCiAgICBkZWYgYXNzZXJ0VHJ1ZShzZWxmLCBleHByLCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiQ2hlY2sgdGhhdCB0aGUgZXhwcmVzc2lvbiBpcyB0cnVlLiIiIgogICAgICAgIGlmIG5vdCBleHByOgogICAgICAgICAgICBtc2cgPSBzZWxmLl9mb3JtYXRNZXNzYWdlKG1zZywgIiVzIGlzIG5vdCB0cnVlIiAlIHNhZmVfcmVwcihleHByKSkKICAgICAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKG1zZykKCiAgICBkZWYgX2Zvcm1hdE1lc3NhZ2Uoc2VsZiwgbXNnLCBzdGFuZGFyZE1zZyk6CiAgICAgICAgIiIiSG9ub3VyIHRoZSBsb25nTWVzc2FnZSBhdHRyaWJ1dGUgd2hlbiBnZW5lcmF0aW5nIGZhaWx1cmUgbWVzc2FnZXMuCiAgICAgICAgSWYgbG9uZ01lc3NhZ2UgaXMgRmFsc2UgdGhpcyBtZWFuczoKICAgICAgICAqIFVzZSBvbmx5IGFuIGV4cGxpY2l0IG1lc3NhZ2UgaWYgaXQgaXMgcHJvdmlkZWQKICAgICAgICAqIE90aGVyd2lzZSB1c2UgdGhlIHN0YW5kYXJkIG1lc3NhZ2UgZm9yIHRoZSBhc3NlcnQKCiAgICAgICAgSWYgbG9uZ01lc3NhZ2UgaXMgVHJ1ZToKICAgICAgICAqIFVzZSB0aGUgc3RhbmRhcmQgbWVzc2FnZQogICAgICAgICogSWYgYW4gZXhwbGljaXQgbWVzc2FnZSBpcyBwcm92aWRlZCwgcGx1cyAnIDogJyBhbmQgdGhlIGV4cGxpY2l0IG1lc3NhZ2UKICAgICAgICAiIiIKICAgICAgICBpZiBub3Qgc2VsZi5sb25nTWVzc2FnZToKICAgICAgICAgICAgcmV0dXJuIG1zZyBvciBzdGFuZGFyZE1zZwogICAgICAgIGlmIG1zZyBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gc3RhbmRhcmRNc2cKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgZG9uJ3Qgc3dpdGNoIHRvICd7fScgZm9ybWF0dGluZyBpbiBQeXRob24gMi5YCiAgICAgICAgICAgICMgaXQgY2hhbmdlcyB0aGUgd2F5IHVuaWNvZGUgaW5wdXQgaXMgaGFuZGxlZAogICAgICAgICAgICByZXR1cm4gJyVzIDogJXMnICUgKHN0YW5kYXJkTXNnLCBtc2cpCiAgICAgICAgZXhjZXB0IFVuaWNvZGVEZWNvZGVFcnJvcjoKICAgICAgICAgICAgcmV0dXJuICAnJXMgOiAlcycgJSAoc2FmZV9yZXByKHN0YW5kYXJkTXNnKSwgc2FmZV9yZXByKG1zZykpCgogICAgZGVmIGFzc2VydFJhaXNlcyhzZWxmLCBleGNDbGFzcywgY2FsbGFibGVPYmo9Tm9uZSwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAiIiJGYWlsIHVubGVzcyBhbiBleGNlcHRpb24gb2YgY2xhc3MgZXhjQ2xhc3MgaXMgdGhyb3duCiAgICAgICAgICAgYnkgY2FsbGFibGVPYmogd2hlbiBpbnZva2VkIHdpdGggYXJndW1lbnRzIGFyZ3MgYW5kIGtleXdvcmQKICAgICAgICAgICBhcmd1bWVudHMga3dhcmdzLiBJZiBhIGRpZmZlcmVudCB0eXBlIG9mIGV4Y2VwdGlvbiBpcwogICAgICAgICAgIHRocm93biwgaXQgd2lsbCBub3QgYmUgY2F1Z2h0LCBhbmQgdGhlIHRlc3QgY2FzZSB3aWxsIGJlCiAgICAgICAgICAgZGVlbWVkIHRvIGhhdmUgc3VmZmVyZWQgYW4gZXJyb3IsIGV4YWN0bHkgYXMgZm9yIGFuCiAgICAgICAgICAgdW5leHBlY3RlZCBleGNlcHRpb24uCgogICAgICAgICAgIElmIGNhbGxlZCB3aXRoIGNhbGxhYmxlT2JqIG9taXR0ZWQgb3IgTm9uZSwgd2lsbCByZXR1cm4gYQogICAgICAgICAgIGNvbnRleHQgb2JqZWN0IHVzZWQgbGlrZSB0aGlzOjoKCiAgICAgICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKFNvbWVFeGNlcHRpb24pOgogICAgICAgICAgICAgICAgICAgIGRvX3NvbWV0aGluZygpCgogICAgICAgICAgIEFuIG9wdGlvbmFsIGtleXdvcmQgYXJndW1lbnQgJ21zZycgY2FuIGJlIHByb3ZpZGVkIHdoZW4gYXNzZXJ0UmFpc2VzCiAgICAgICAgICAgaXMgdXNlZCBhcyBhIGNvbnRleHQgb2JqZWN0LgoKICAgICAgICAgICBUaGUgY29udGV4dCBtYW5hZ2VyIGtlZXBzIGEgcmVmZXJlbmNlIHRvIHRoZSBleGNlcHRpb24gYXMKICAgICAgICAgICB0aGUgJ2V4Y2VwdGlvbicgYXR0cmlidXRlLiBUaGlzIGFsbG93cyB5b3UgdG8gaW5zcGVjdCB0aGUKICAgICAgICAgICBleGNlcHRpb24gYWZ0ZXIgdGhlIGFzc2VydGlvbjo6CgogICAgICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKFNvbWVFeGNlcHRpb24pIGFzIGNtOgogICAgICAgICAgICAgICAgICAgZG9fc29tZXRoaW5nKCkKICAgICAgICAgICAgICAgdGhlX2V4Y2VwdGlvbiA9IGNtLmV4Y2VwdGlvbgogICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHRoZV9leGNlcHRpb24uZXJyb3JfY29kZSwgMykKICAgICAgICAiIiIKICAgICAgICBjb250ZXh0ID0gX0Fzc2VydFJhaXNlc0NvbnRleHQoZXhjQ2xhc3MsIHNlbGYsIGNhbGxhYmxlT2JqKQogICAgICAgIHJldHVybiBjb250ZXh0LmhhbmRsZSgnYXNzZXJ0UmFpc2VzJywgY2FsbGFibGVPYmosIGFyZ3MsIGt3YXJncykKCiAgICBkZWYgYXNzZXJ0V2FybnMoc2VsZiwgZXhwZWN0ZWRfd2FybmluZywgY2FsbGFibGVfb2JqPU5vbmUsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgIiIiRmFpbCB1bmxlc3MgYSB3YXJuaW5nIG9mIGNsYXNzIHdhcm5DbGFzcyBpcyB0cmlnZ2VyZWQKICAgICAgICAgICBieSBjYWxsYWJsZV9vYmogd2hlbiBpbnZva2VkIHdpdGggYXJndW1lbnRzIGFyZ3MgYW5kIGtleXdvcmQKICAgICAgICAgICBhcmd1bWVudHMga3dhcmdzLiAgSWYgYSBkaWZmZXJlbnQgdHlwZSBvZiB3YXJuaW5nIGlzCiAgICAgICAgICAgdHJpZ2dlcmVkLCBpdCB3aWxsIG5vdCBiZSBoYW5kbGVkOiBkZXBlbmRpbmcgb24gdGhlIG90aGVyCiAgICAgICAgICAgd2FybmluZyBmaWx0ZXJpbmcgcnVsZXMgaW4gZWZmZWN0LCBpdCBtaWdodCBiZSBzaWxlbmNlZCwgcHJpbnRlZAogICAgICAgICAgIG91dCwgb3IgcmFpc2VkIGFzIGFuIGV4Y2VwdGlvbi4KCiAgICAgICAgICAgSWYgY2FsbGVkIHdpdGggY2FsbGFibGVfb2JqIG9taXR0ZWQgb3IgTm9uZSwgd2lsbCByZXR1cm4gYQogICAgICAgICAgIGNvbnRleHQgb2JqZWN0IHVzZWQgbGlrZSB0aGlzOjoKCiAgICAgICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0V2FybnMoU29tZVdhcm5pbmcpOgogICAgICAgICAgICAgICAgICAgIGRvX3NvbWV0aGluZygpCgogICAgICAgICAgIEFuIG9wdGlvbmFsIGtleXdvcmQgYXJndW1lbnQgJ21zZycgY2FuIGJlIHByb3ZpZGVkIHdoZW4gYXNzZXJ0V2FybnMKICAgICAgICAgICBpcyB1c2VkIGFzIGEgY29udGV4dCBvYmplY3QuCgogICAgICAgICAgIFRoZSBjb250ZXh0IG1hbmFnZXIga2VlcHMgYSByZWZlcmVuY2UgdG8gdGhlIGZpcnN0IG1hdGNoaW5nCiAgICAgICAgICAgd2FybmluZyBhcyB0aGUgJ3dhcm5pbmcnIGF0dHJpYnV0ZTsgc2ltaWxhcmx5LCB0aGUgJ2ZpbGVuYW1lJwogICAgICAgICAgIGFuZCAnbGluZW5vJyBhdHRyaWJ1dGVzIGdpdmUgeW91IGluZm9ybWF0aW9uIGFib3V0IHRoZSBsaW5lCiAgICAgICAgICAgb2YgUHl0aG9uIGNvZGUgZnJvbSB3aGljaCB0aGUgd2FybmluZyB3YXMgdHJpZ2dlcmVkLgogICAgICAgICAgIFRoaXMgYWxsb3dzIHlvdSB0byBpbnNwZWN0IHRoZSB3YXJuaW5nIGFmdGVyIHRoZSBhc3NlcnRpb246OgoKICAgICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFdhcm5zKFNvbWVXYXJuaW5nKSBhcyBjbToKICAgICAgICAgICAgICAgICAgIGRvX3NvbWV0aGluZygpCiAgICAgICAgICAgICAgIHRoZV93YXJuaW5nID0gY20ud2FybmluZwogICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHRoZV93YXJuaW5nLnNvbWVfYXR0cmlidXRlLCAxNDcpCiAgICAgICAgIiIiCiAgICAgICAgY29udGV4dCA9IF9Bc3NlcnRXYXJuc0NvbnRleHQoZXhwZWN0ZWRfd2FybmluZywgc2VsZiwgY2FsbGFibGVfb2JqKQogICAgICAgIHJldHVybiBjb250ZXh0LmhhbmRsZSgnYXNzZXJ0V2FybnMnLCBjYWxsYWJsZV9vYmosIGFyZ3MsIGt3YXJncykKCiAgICBkZWYgX2dldEFzc2VydEVxdWFsaXR5RnVuYyhzZWxmLCBmaXJzdCwgc2Vjb25kKToKICAgICAgICAiIiJHZXQgYSBkZXRhaWxlZCBjb21wYXJpc29uIGZ1bmN0aW9uIGZvciB0aGUgdHlwZXMgb2YgdGhlIHR3byBhcmdzLgoKICAgICAgICBSZXR1cm5zOiBBIGNhbGxhYmxlIGFjY2VwdGluZyAoZmlyc3QsIHNlY29uZCwgbXNnPU5vbmUpIHRoYXQgd2lsbAogICAgICAgIHJhaXNlIGEgZmFpbHVyZSBleGNlcHRpb24gaWYgZmlyc3QgIT0gc2Vjb25kIHdpdGggYSB1c2VmdWwgaHVtYW4KICAgICAgICByZWFkYWJsZSBlcnJvciBtZXNzYWdlIGZvciB0aG9zZSB0eXBlcy4KICAgICAgICAiIiIKICAgICAgICAjCiAgICAgICAgIyBOT1RFKGdyZWdvcnkucC5zbWl0aCk6IEkgY29uc2lkZXJlZCBpc2luc3RhbmNlKGZpcnN0LCB0eXBlKHNlY29uZCkpCiAgICAgICAgIyBhbmQgdmljZSB2ZXJzYS4gIEkgb3B0ZWQgZm9yIHRoZSBjb25zZXJ2YXRpdmUgYXBwcm9hY2ggaW4gY2FzZQogICAgICAgICMgc3ViY2xhc3NlcyBhcmUgbm90IGludGVuZGVkIHRvIGJlIGNvbXBhcmVkIGluIGRldGFpbCB0byB0aGVpciBzdXBlcgogICAgICAgICMgY2xhc3MgaW5zdGFuY2VzIHVzaW5nIGEgdHlwZSBlcXVhbGl0eSBmdW5jLiAgVGhpcyBtZWFucyB0ZXN0aW5nCiAgICAgICAgIyBzdWJ0eXBlcyB3b24ndCBhdXRvbWFnaWNhbGx5IHVzZSB0aGUgZGV0YWlsZWQgY29tcGFyaXNvbi4gIENhbGxlcnMKICAgICAgICAjIHNob3VsZCB1c2UgdGhlaXIgdHlwZSBzcGVjaWZpYyBhc3NlcnRTcGFtRXF1YWwgbWV0aG9kIHRvIGNvbXBhcmUKICAgICAgICAjIHN1YmNsYXNzZXMgaWYgdGhlIGRldGFpbGVkIGNvbXBhcmlzb24gaXMgZGVzaXJlZCBhbmQgYXBwcm9wcmlhdGUuCiAgICAgICAgIyBTZWUgdGhlIGRpc2N1c3Npb24gaW4gaHR0cDovL2J1Z3MucHl0aG9uLm9yZy9pc3N1ZTI1NzguCiAgICAgICAgIwogICAgICAgIGlmIHR5cGUoZmlyc3QpIGlzIHR5cGUoc2Vjb25kKToKICAgICAgICAgICAgYXNzZXJ0ZXIgPSBzZWxmLl90eXBlX2VxdWFsaXR5X2Z1bmNzLmdldCh0eXBlKGZpcnN0KSkKICAgICAgICAgICAgaWYgYXNzZXJ0ZXIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGFzc2VydGVyLCBzdHIpOgogICAgICAgICAgICAgICAgICAgIGFzc2VydGVyID0gZ2V0YXR0cihzZWxmLCBhc3NlcnRlcikKICAgICAgICAgICAgICAgIHJldHVybiBhc3NlcnRlcgoKICAgICAgICByZXR1cm4gc2VsZi5fYmFzZUFzc2VydEVxdWFsCgogICAgZGVmIF9iYXNlQXNzZXJ0RXF1YWwoc2VsZiwgZmlyc3QsIHNlY29uZCwgbXNnPU5vbmUpOgogICAgICAgICIiIlRoZSBkZWZhdWx0IGFzc2VydEVxdWFsIGltcGxlbWVudGF0aW9uLCBub3QgdHlwZSBzcGVjaWZpYy4iIiIKICAgICAgICBpZiBub3QgZmlyc3QgPT0gc2Vjb25kOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyAhPSAlcycgJSAoc2FmZV9yZXByKGZpcnN0KSwgc2FmZV9yZXByKHNlY29uZCkpCiAgICAgICAgICAgIG1zZyA9IHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykKICAgICAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKG1zZykKCiAgICBkZWYgYXNzZXJ0RXF1YWwoc2VsZiwgZmlyc3QsIHNlY29uZCwgbXNnPU5vbmUpOgogICAgICAgICIiIkZhaWwgaWYgdGhlIHR3byBvYmplY3RzIGFyZSB1bmVxdWFsIGFzIGRldGVybWluZWQgYnkgdGhlICc9PScKICAgICAgICAgICBvcGVyYXRvci4KICAgICAgICAiIiIKICAgICAgICBhc3NlcnRpb25fZnVuYyA9IHNlbGYuX2dldEFzc2VydEVxdWFsaXR5RnVuYyhmaXJzdCwgc2Vjb25kKQogICAgICAgIGFzc2VydGlvbl9mdW5jKGZpcnN0LCBzZWNvbmQsIG1zZz1tc2cpCgogICAgZGVmIGFzc2VydE5vdEVxdWFsKHNlbGYsIGZpcnN0LCBzZWNvbmQsIG1zZz1Ob25lKToKICAgICAgICAiIiJGYWlsIGlmIHRoZSB0d28gb2JqZWN0cyBhcmUgZXF1YWwgYXMgZGV0ZXJtaW5lZCBieSB0aGUgJz09JwogICAgICAgICAgIG9wZXJhdG9yLgogICAgICAgICIiIgogICAgICAgIGlmIG5vdCBmaXJzdCAhPSBzZWNvbmQ6CiAgICAgICAgICAgIG1zZyA9IHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCAnJXMgPT0gJXMnICUgKHNhZmVfcmVwcihmaXJzdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWZlX3JlcHIoc2Vjb25kKSkpCiAgICAgICAgICAgIHJhaXNlIHNlbGYuZmFpbHVyZUV4Y2VwdGlvbihtc2cpCgogICAgZGVmIGFzc2VydEFsbW9zdEVxdWFsKHNlbGYsIGZpcnN0LCBzZWNvbmQsIHBsYWNlcz1Ob25lLCBtc2c9Tm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBkZWx0YT1Ob25lKToKICAgICAgICAiIiJGYWlsIGlmIHRoZSB0d28gb2JqZWN0cyBhcmUgdW5lcXVhbCBhcyBkZXRlcm1pbmVkIGJ5IHRoZWlyCiAgICAgICAgICAgZGlmZmVyZW5jZSByb3VuZGVkIHRvIHRoZSBnaXZlbiBudW1iZXIgb2YgZGVjaW1hbCBwbGFjZXMKICAgICAgICAgICAoZGVmYXVsdCA3KSBhbmQgY29tcGFyaW5nIHRvIHplcm8sIG9yIGJ5IGNvbXBhcmluZyB0aGF0IHRoZQogICAgICAgICAgIGJldHdlZW4gdGhlIHR3byBvYmplY3RzIGlzIG1vcmUgdGhhbiB0aGUgZ2l2ZW4gZGVsdGEuCgogICAgICAgICAgIE5vdGUgdGhhdCBkZWNpbWFsIHBsYWNlcyAoZnJvbSB6ZXJvKSBhcmUgdXN1YWxseSBub3QgdGhlIHNhbWUKICAgICAgICAgICBhcyBzaWduaWZpY2FudCBkaWdpdHMgKG1lYXN1cmVkIGZyb20gdGhlIG1vc3Qgc2lnbmZpY2FudCBkaWdpdCkuCgogICAgICAgICAgIElmIHRoZSB0d28gb2JqZWN0cyBjb21wYXJlIGVxdWFsIHRoZW4gdGhleSB3aWxsIGF1dG9tYXRpY2FsbHkKICAgICAgICAgICBjb21wYXJlIGFsbW9zdCBlcXVhbC4KICAgICAgICAiIiIKICAgICAgICBpZiBmaXJzdCA9PSBzZWNvbmQ6CiAgICAgICAgICAgICMgc2hvcnRjdXQKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgZGVsdGEgaXMgbm90IE5vbmUgYW5kIHBsYWNlcyBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJzcGVjaWZ5IGRlbHRhIG9yIHBsYWNlcyBub3QgYm90aCIpCgogICAgICAgIGlmIGRlbHRhIGlzIG5vdCBOb25lOgogICAgICAgICAgICBpZiBhYnMoZmlyc3QgLSBzZWNvbmQpIDw9IGRlbHRhOgogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyAhPSAlcyB3aXRoaW4gJXMgZGVsdGEnICUgKHNhZmVfcmVwcihmaXJzdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKHNlY29uZCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKGRlbHRhKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBwbGFjZXMgaXMgTm9uZToKICAgICAgICAgICAgICAgIHBsYWNlcyA9IDcKCiAgICAgICAgICAgIGlmIHJvdW5kKGFicyhzZWNvbmQtZmlyc3QpLCBwbGFjZXMpID09IDA6CiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzICE9ICVzIHdpdGhpbiAlciBwbGFjZXMnICUgKHNhZmVfcmVwcihmaXJzdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWZlX3JlcHIoc2Vjb25kKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlcykKICAgICAgICBtc2cgPSBzZWxmLl9mb3JtYXRNZXNzYWdlKG1zZywgc3RhbmRhcmRNc2cpCiAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKG1zZykKCiAgICBkZWYgYXNzZXJ0Tm90QWxtb3N0RXF1YWwoc2VsZiwgZmlyc3QsIHNlY29uZCwgcGxhY2VzPU5vbmUsIG1zZz1Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhPU5vbmUpOgogICAgICAgICIiIkZhaWwgaWYgdGhlIHR3byBvYmplY3RzIGFyZSBlcXVhbCBhcyBkZXRlcm1pbmVkIGJ5IHRoZWlyCiAgICAgICAgICAgZGlmZmVyZW5jZSByb3VuZGVkIHRvIHRoZSBnaXZlbiBudW1iZXIgb2YgZGVjaW1hbCBwbGFjZXMKICAgICAgICAgICAoZGVmYXVsdCA3KSBhbmQgY29tcGFyaW5nIHRvIHplcm8sIG9yIGJ5IGNvbXBhcmluZyB0aGF0IHRoZQogICAgICAgICAgIGJldHdlZW4gdGhlIHR3byBvYmplY3RzIGlzIGxlc3MgdGhhbiB0aGUgZ2l2ZW4gZGVsdGEuCgogICAgICAgICAgIE5vdGUgdGhhdCBkZWNpbWFsIHBsYWNlcyAoZnJvbSB6ZXJvKSBhcmUgdXN1YWxseSBub3QgdGhlIHNhbWUKICAgICAgICAgICBhcyBzaWduaWZpY2FudCBkaWdpdHMgKG1lYXN1cmVkIGZyb20gdGhlIG1vc3Qgc2lnbmZpY2FudCBkaWdpdCkuCgogICAgICAgICAgIE9iamVjdHMgdGhhdCBhcmUgZXF1YWwgYXV0b21hdGljYWxseSBmYWlsLgogICAgICAgICIiIgogICAgICAgIGlmIGRlbHRhIGlzIG5vdCBOb25lIGFuZCBwbGFjZXMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigic3BlY2lmeSBkZWx0YSBvciBwbGFjZXMgbm90IGJvdGgiKQogICAgICAgIGlmIGRlbHRhIGlzIG5vdCBOb25lOgogICAgICAgICAgICBpZiBub3QgKGZpcnN0ID09IHNlY29uZCkgYW5kIGFicyhmaXJzdCAtIHNlY29uZCkgPiBkZWx0YToKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyA9PSAlcyB3aXRoaW4gJXMgZGVsdGEnICUgKHNhZmVfcmVwcihmaXJzdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKHNlY29uZCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKGRlbHRhKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBwbGFjZXMgaXMgTm9uZToKICAgICAgICAgICAgICAgIHBsYWNlcyA9IDcKICAgICAgICAgICAgaWYgbm90IChmaXJzdCA9PSBzZWNvbmQpIGFuZCByb3VuZChhYnMoc2Vjb25kLWZpcnN0KSwgcGxhY2VzKSAhPSAwOgogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzID09ICVzIHdpdGhpbiAlciBwbGFjZXMnICUgKHNhZmVfcmVwcihmaXJzdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhZmVfcmVwcihzZWNvbmQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZXMpCgogICAgICAgIG1zZyA9IHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykKICAgICAgICByYWlzZSBzZWxmLmZhaWx1cmVFeGNlcHRpb24obXNnKQoKCiAgICBkZWYgYXNzZXJ0U2VxdWVuY2VFcXVhbChzZWxmLCBzZXExLCBzZXEyLCBtc2c9Tm9uZSwgc2VxX3R5cGU9Tm9uZSk6CiAgICAgICAgIiIiQW4gZXF1YWxpdHkgYXNzZXJ0aW9uIGZvciBvcmRlcmVkIHNlcXVlbmNlcyAobGlrZSBsaXN0cyBhbmQgdHVwbGVzKS4KCiAgICAgICAgRm9yIHRoZSBwdXJwb3NlcyBvZiB0aGlzIGZ1bmN0aW9uLCBhIHZhbGlkIG9yZGVyZWQgc2VxdWVuY2UgdHlwZSBpcyBvbmUKICAgICAgICB3aGljaCBjYW4gYmUgaW5kZXhlZCwgaGFzIGEgbGVuZ3RoLCBhbmQgaGFzIGFuIGVxdWFsaXR5IG9wZXJhdG9yLgoKICAgICAgICBBcmdzOgogICAgICAgICAgICBzZXExOiBUaGUgZmlyc3Qgc2VxdWVuY2UgdG8gY29tcGFyZS4KICAgICAgICAgICAgc2VxMjogVGhlIHNlY29uZCBzZXF1ZW5jZSB0byBjb21wYXJlLgogICAgICAgICAgICBzZXFfdHlwZTogVGhlIGV4cGVjdGVkIGRhdGF0eXBlIG9mIHRoZSBzZXF1ZW5jZXMsIG9yIE5vbmUgaWYgbm8KICAgICAgICAgICAgICAgICAgICBkYXRhdHlwZSBzaG91bGQgYmUgZW5mb3JjZWQuCiAgICAgICAgICAgIG1zZzogT3B0aW9uYWwgbWVzc2FnZSB0byB1c2Ugb24gZmFpbHVyZSBpbnN0ZWFkIG9mIGEgbGlzdCBvZgogICAgICAgICAgICAgICAgICAgIGRpZmZlcmVuY2VzLgogICAgICAgICIiIgogICAgICAgIGlmIHNlcV90eXBlICE9IE5vbmU6CiAgICAgICAgICAgIHNlcV90eXBlX25hbWUgPSBzZXFfdHlwZS5fX25hbWVfXwogICAgICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShzZXExLCBzZXFfdHlwZSk6CiAgICAgICAgICAgICAgICByYWlzZSBzZWxmLmZhaWx1cmVFeGNlcHRpb24oJ0ZpcnN0IHNlcXVlbmNlIGlzIG5vdCBhICVzOiAlcycKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICUgKHNlcV90eXBlX25hbWUsIHNhZmVfcmVwcihzZXExKSkpCiAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHNlcTIsIHNlcV90eXBlKToKICAgICAgICAgICAgICAgIHJhaXNlIHNlbGYuZmFpbHVyZUV4Y2VwdGlvbignU2Vjb25kIHNlcXVlbmNlIGlzIG5vdCBhICVzOiAlcycKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICUgKHNlcV90eXBlX25hbWUsIHNhZmVfcmVwcihzZXEyKSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VxX3R5cGVfbmFtZSA9ICJzZXF1ZW5jZSIKCiAgICAgICAgZGlmZmVyaW5nID0gTm9uZQogICAgICAgIHRyeToKICAgICAgICAgICAgbGVuMSA9IGxlbihzZXExKQogICAgICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBOb3RJbXBsZW1lbnRlZEVycm9yKToKICAgICAgICAgICAgZGlmZmVyaW5nID0gJ0ZpcnN0ICVzIGhhcyBubyBsZW5ndGguICAgIE5vbi1zZXF1ZW5jZT8nICUgKAogICAgICAgICAgICAgICAgICAgIHNlcV90eXBlX25hbWUpCgogICAgICAgIGlmIGRpZmZlcmluZyBpcyBOb25lOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBsZW4yID0gbGVuKHNlcTIpCiAgICAgICAgICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBOb3RJbXBsZW1lbnRlZEVycm9yKToKICAgICAgICAgICAgICAgIGRpZmZlcmluZyA9ICdTZWNvbmQgJXMgaGFzIG5vIGxlbmd0aC4gICAgTm9uLXNlcXVlbmNlPycgJSAoCiAgICAgICAgICAgICAgICAgICAgICAgIHNlcV90eXBlX25hbWUpCgogICAgICAgIGlmIGRpZmZlcmluZyBpcyBOb25lOgogICAgICAgICAgICBpZiBzZXExID09IHNlcTI6CiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgIHNlcTFfcmVwciA9IHNhZmVfcmVwcihzZXExKQogICAgICAgICAgICBzZXEyX3JlcHIgPSBzYWZlX3JlcHIoc2VxMikKICAgICAgICAgICAgaWYgbGVuKHNlcTFfcmVwcikgPiAzMDoKICAgICAgICAgICAgICAgIHNlcTFfcmVwciA9IHNlcTFfcmVwcls6MzBdICsgJy4uLicKICAgICAgICAgICAgaWYgbGVuKHNlcTJfcmVwcikgPiAzMDoKICAgICAgICAgICAgICAgIHNlcTJfcmVwciA9IHNlcTJfcmVwcls6MzBdICsgJy4uLicKICAgICAgICAgICAgZWxlbWVudHMgPSAoc2VxX3R5cGVfbmFtZS5jYXBpdGFsaXplKCksIHNlcTFfcmVwciwgc2VxMl9yZXByKQogICAgICAgICAgICBkaWZmZXJpbmcgPSAnJXNzIGRpZmZlcjogJXMgIT0gJXNcbicgJSBlbGVtZW50cwoKICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2UobWluKGxlbjEsIGxlbjIpKToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBpdGVtMSA9IHNlcTFbaV0KICAgICAgICAgICAgICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBJbmRleEVycm9yLCBOb3RJbXBsZW1lbnRlZEVycm9yKToKICAgICAgICAgICAgICAgICAgICBkaWZmZXJpbmcgKz0gKCdcblVuYWJsZSB0byBpbmRleCBlbGVtZW50ICVkIG9mIGZpcnN0ICVzXG4nICUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGksIHNlcV90eXBlX25hbWUpKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGl0ZW0yID0gc2VxMltpXQogICAgICAgICAgICAgICAgZXhjZXB0IChUeXBlRXJyb3IsIEluZGV4RXJyb3IsIE5vdEltcGxlbWVudGVkRXJyb3IpOgogICAgICAgICAgICAgICAgICAgIGRpZmZlcmluZyArPSAoJ1xuVW5hYmxlIHRvIGluZGV4IGVsZW1lbnQgJWQgb2Ygc2Vjb25kICVzXG4nICUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGksIHNlcV90eXBlX25hbWUpKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAgICAgaWYgaXRlbTEgIT0gaXRlbTI6CiAgICAgICAgICAgICAgICAgICAgZGlmZmVyaW5nICs9ICgnXG5GaXJzdCBkaWZmZXJpbmcgZWxlbWVudCAlZDpcbiVzXG4lc1xuJyAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChpLCBpdGVtMSwgaXRlbTIpKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpZiAobGVuMSA9PSBsZW4yIGFuZCBzZXFfdHlwZSBpcyBOb25lIGFuZAogICAgICAgICAgICAgICAgICAgIHR5cGUoc2VxMSkgIT0gdHlwZShzZXEyKSk6CiAgICAgICAgICAgICAgICAgICAgIyBUaGUgc2VxdWVuY2VzIGFyZSB0aGUgc2FtZSwgYnV0IGhhdmUgZGlmZmVyaW5nIHR5cGVzLgogICAgICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgaWYgbGVuMSA+IGxlbjI6CiAgICAgICAgICAgICAgICBkaWZmZXJpbmcgKz0gKCdcbkZpcnN0ICVzIGNvbnRhaW5zICVkIGFkZGl0aW9uYWwgJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICdlbGVtZW50cy5cbicgJSAoc2VxX3R5cGVfbmFtZSwgbGVuMSAtIGxlbjIpKQogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGRpZmZlcmluZyArPSAoJ0ZpcnN0IGV4dHJhIGVsZW1lbnQgJWQ6XG4lc1xuJyAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAobGVuMiwgc2VxMVtsZW4yXSkpCiAgICAgICAgICAgICAgICBleGNlcHQgKFR5cGVFcnJvciwgSW5kZXhFcnJvciwgTm90SW1wbGVtZW50ZWRFcnJvcik6CiAgICAgICAgICAgICAgICAgICAgZGlmZmVyaW5nICs9ICgnVW5hYmxlIHRvIGluZGV4IGVsZW1lbnQgJWQgJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29mIGZpcnN0ICVzXG4nICUgKGxlbjIsIHNlcV90eXBlX25hbWUpKQogICAgICAgICAgICBlbGlmIGxlbjEgPCBsZW4yOgogICAgICAgICAgICAgICAgZGlmZmVyaW5nICs9ICgnXG5TZWNvbmQgJXMgY29udGFpbnMgJWQgYWRkaXRpb25hbCAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2VsZW1lbnRzLlxuJyAlIChzZXFfdHlwZV9uYW1lLCBsZW4yIC0gbGVuMSkpCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgZGlmZmVyaW5nICs9ICgnRmlyc3QgZXh0cmEgZWxlbWVudCAlZDpcbiVzXG4nICUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChsZW4xLCBzZXEyW2xlbjFdKSkKICAgICAgICAgICAgICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBJbmRleEVycm9yLCBOb3RJbXBsZW1lbnRlZEVycm9yKToKICAgICAgICAgICAgICAgICAgICBkaWZmZXJpbmcgKz0gKCdVbmFibGUgdG8gaW5kZXggZWxlbWVudCAlZCAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb2Ygc2Vjb25kICVzXG4nICUgKGxlbjEsIHNlcV90eXBlX25hbWUpKQogICAgICAgIHN0YW5kYXJkTXNnID0gZGlmZmVyaW5nCiAgICAgICAgZGlmZk1zZyA9ICdcbicgKyAnXG4nLmpvaW4oCiAgICAgICAgICAgIGRpZmZsaWIubmRpZmYocHByaW50LnBmb3JtYXQoc2VxMSkuc3BsaXRsaW5lcygpLAogICAgICAgICAgICAgICAgICAgICAgICAgIHBwcmludC5wZm9ybWF0KHNlcTIpLnNwbGl0bGluZXMoKSkpCgogICAgICAgIHN0YW5kYXJkTXNnID0gc2VsZi5fdHJ1bmNhdGVNZXNzYWdlKHN0YW5kYXJkTXNnLCBkaWZmTXNnKQogICAgICAgIG1zZyA9IHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykKICAgICAgICBzZWxmLmZhaWwobXNnKQoKICAgIGRlZiBfdHJ1bmNhdGVNZXNzYWdlKHNlbGYsIG1lc3NhZ2UsIGRpZmYpOgogICAgICAgIG1heF9kaWZmID0gc2VsZi5tYXhEaWZmCiAgICAgICAgaWYgbWF4X2RpZmYgaXMgTm9uZSBvciBsZW4oZGlmZikgPD0gbWF4X2RpZmY6CiAgICAgICAgICAgIHJldHVybiBtZXNzYWdlICsgZGlmZgogICAgICAgIHJldHVybiBtZXNzYWdlICsgKERJRkZfT01JVFRFRCAlIGxlbihkaWZmKSkKCiAgICBkZWYgYXNzZXJ0TGlzdEVxdWFsKHNlbGYsIGxpc3QxLCBsaXN0MiwgbXNnPU5vbmUpOgogICAgICAgICIiIkEgbGlzdC1zcGVjaWZpYyBlcXVhbGl0eSBhc3NlcnRpb24uCgogICAgICAgIEFyZ3M6CiAgICAgICAgICAgIGxpc3QxOiBUaGUgZmlyc3QgbGlzdCB0byBjb21wYXJlLgogICAgICAgICAgICBsaXN0MjogVGhlIHNlY29uZCBsaXN0IHRvIGNvbXBhcmUuCiAgICAgICAgICAgIG1zZzogT3B0aW9uYWwgbWVzc2FnZSB0byB1c2Ugb24gZmFpbHVyZSBpbnN0ZWFkIG9mIGEgbGlzdCBvZgogICAgICAgICAgICAgICAgICAgIGRpZmZlcmVuY2VzLgoKICAgICAgICAiIiIKICAgICAgICBzZWxmLmFzc2VydFNlcXVlbmNlRXF1YWwobGlzdDEsIGxpc3QyLCBtc2csIHNlcV90eXBlPWxpc3QpCgogICAgZGVmIGFzc2VydFR1cGxlRXF1YWwoc2VsZiwgdHVwbGUxLCB0dXBsZTIsIG1zZz1Ob25lKToKICAgICAgICAiIiJBIHR1cGxlLXNwZWNpZmljIGVxdWFsaXR5IGFzc2VydGlvbi4KCiAgICAgICAgQXJnczoKICAgICAgICAgICAgdHVwbGUxOiBUaGUgZmlyc3QgdHVwbGUgdG8gY29tcGFyZS4KICAgICAgICAgICAgdHVwbGUyOiBUaGUgc2Vjb25kIHR1cGxlIHRvIGNvbXBhcmUuCiAgICAgICAgICAgIG1zZzogT3B0aW9uYWwgbWVzc2FnZSB0byB1c2Ugb24gZmFpbHVyZSBpbnN0ZWFkIG9mIGEgbGlzdCBvZgogICAgICAgICAgICAgICAgICAgIGRpZmZlcmVuY2VzLgogICAgICAgICIiIgogICAgICAgIHNlbGYuYXNzZXJ0U2VxdWVuY2VFcXVhbCh0dXBsZTEsIHR1cGxlMiwgbXNnLCBzZXFfdHlwZT10dXBsZSkKCiAgICBkZWYgYXNzZXJ0U2V0RXF1YWwoc2VsZiwgc2V0MSwgc2V0MiwgbXNnPU5vbmUpOgogICAgICAgICIiIkEgc2V0LXNwZWNpZmljIGVxdWFsaXR5IGFzc2VydGlvbi4KCiAgICAgICAgQXJnczoKICAgICAgICAgICAgc2V0MTogVGhlIGZpcnN0IHNldCB0byBjb21wYXJlLgogICAgICAgICAgICBzZXQyOiBUaGUgc2Vjb25kIHNldCB0byBjb21wYXJlLgogICAgICAgICAgICBtc2c6IE9wdGlvbmFsIG1lc3NhZ2UgdG8gdXNlIG9uIGZhaWx1cmUgaW5zdGVhZCBvZiBhIGxpc3Qgb2YKICAgICAgICAgICAgICAgICAgICBkaWZmZXJlbmNlcy4KCiAgICAgICAgYXNzZXJ0U2V0RXF1YWwgdXNlcyBkdWNrdHlwaW5nIHRvIHN1cHBvcnQgZGlmZmVyZW50IHR5cGVzIG9mIHNldHMsIGFuZAogICAgICAgIGlzIG9wdGltaXplZCBmb3Igc2V0cyBzcGVjaWZpY2FsbHkgKHBhcmFtZXRlcnMgbXVzdCBzdXBwb3J0IGEKICAgICAgICBkaWZmZXJlbmNlIG1ldGhvZCkuCiAgICAgICAgIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBkaWZmZXJlbmNlMSA9IHNldDEuZGlmZmVyZW5jZShzZXQyKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5mYWlsKCdpbnZhbGlkIHR5cGUgd2hlbiBhdHRlbXB0aW5nIHNldCBkaWZmZXJlbmNlOiAlcycgJSBlKQogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvciBhcyBlOgogICAgICAgICAgICBzZWxmLmZhaWwoJ2ZpcnN0IGFyZ3VtZW50IGRvZXMgbm90IHN1cHBvcnQgc2V0IGRpZmZlcmVuY2U6ICVzJyAlIGUpCgogICAgICAgIHRyeToKICAgICAgICAgICAgZGlmZmVyZW5jZTIgPSBzZXQyLmRpZmZlcmVuY2Uoc2V0MSkKICAgICAgICBleGNlcHQgVHlwZUVycm9yIGFzIGU6CiAgICAgICAgICAgIHNlbGYuZmFpbCgnaW52YWxpZCB0eXBlIHdoZW4gYXR0ZW1wdGluZyBzZXQgZGlmZmVyZW5jZTogJXMnICUgZSkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5mYWlsKCdzZWNvbmQgYXJndW1lbnQgZG9lcyBub3Qgc3VwcG9ydCBzZXQgZGlmZmVyZW5jZTogJXMnICUgZSkKCiAgICAgICAgaWYgbm90IChkaWZmZXJlbmNlMSBvciBkaWZmZXJlbmNlMik6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBsaW5lcyA9IFtdCiAgICAgICAgaWYgZGlmZmVyZW5jZTE6CiAgICAgICAgICAgIGxpbmVzLmFwcGVuZCgnSXRlbXMgaW4gdGhlIGZpcnN0IHNldCBidXQgbm90IHRoZSBzZWNvbmQ6JykKICAgICAgICAgICAgZm9yIGl0ZW0gaW4gZGlmZmVyZW5jZTE6CiAgICAgICAgICAgICAgICBsaW5lcy5hcHBlbmQocmVwcihpdGVtKSkKICAgICAgICBpZiBkaWZmZXJlbmNlMjoKICAgICAgICAgICAgbGluZXMuYXBwZW5kKCdJdGVtcyBpbiB0aGUgc2Vjb25kIHNldCBidXQgbm90IHRoZSBmaXJzdDonKQogICAgICAgICAgICBmb3IgaXRlbSBpbiBkaWZmZXJlbmNlMjoKICAgICAgICAgICAgICAgIGxpbmVzLmFwcGVuZChyZXByKGl0ZW0pKQoKICAgICAgICBzdGFuZGFyZE1zZyA9ICdcbicuam9pbihsaW5lcykKICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0SW4oc2VsZiwgbWVtYmVyLCBjb250YWluZXIsIG1zZz1Ob25lKToKICAgICAgICAiIiJKdXN0IGxpa2Ugc2VsZi5hc3NlcnRUcnVlKGEgaW4gYiksIGJ1dCB3aXRoIGEgbmljZXIgZGVmYXVsdCBtZXNzYWdlLiIiIgogICAgICAgIGlmIG1lbWJlciBub3QgaW4gY29udGFpbmVyOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyBub3QgZm91bmQgaW4gJXMnICUgKHNhZmVfcmVwcihtZW1iZXIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhZmVfcmVwcihjb250YWluZXIpKQogICAgICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0Tm90SW4oc2VsZiwgbWVtYmVyLCBjb250YWluZXIsIG1zZz1Ob25lKToKICAgICAgICAiIiJKdXN0IGxpa2Ugc2VsZi5hc3NlcnRUcnVlKGEgbm90IGluIGIpLCBidXQgd2l0aCBhIG5pY2VyIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBtZW1iZXIgaW4gY29udGFpbmVyOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyB1bmV4cGVjdGVkbHkgZm91bmQgaW4gJXMnICUgKHNhZmVfcmVwcihtZW1iZXIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhZmVfcmVwcihjb250YWluZXIpKQogICAgICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0SXMoc2VsZiwgZXhwcjEsIGV4cHIyLCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiSnVzdCBsaWtlIHNlbGYuYXNzZXJ0VHJ1ZShhIGlzIGIpLCBidXQgd2l0aCBhIG5pY2VyIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBleHByMSBpcyBub3QgZXhwcjI6CiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzIGlzIG5vdCAlcycgJSAoc2FmZV9yZXByKGV4cHIxKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKGV4cHIyKSkKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydElzTm90KHNlbGYsIGV4cHIxLCBleHByMiwgbXNnPU5vbmUpOgogICAgICAgICIiIkp1c3QgbGlrZSBzZWxmLmFzc2VydFRydWUoYSBpcyBub3QgYiksIGJ1dCB3aXRoIGEgbmljZXIgZGVmYXVsdCBtZXNzYWdlLiIiIgogICAgICAgIGlmIGV4cHIxIGlzIGV4cHIyOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICd1bmV4cGVjdGVkbHkgaWRlbnRpY2FsOiAlcycgJSAoc2FmZV9yZXByKGV4cHIxKSwpCiAgICAgICAgICAgIHNlbGYuZmFpbChzZWxmLl9mb3JtYXRNZXNzYWdlKG1zZywgc3RhbmRhcmRNc2cpKQoKICAgIGRlZiBhc3NlcnREaWN0RXF1YWwoc2VsZiwgZDEsIGQyLCBtc2c9Tm9uZSk6CiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGQxLCBkaWN0LCAnRmlyc3QgYXJndW1lbnQgaXMgbm90IGEgZGljdGlvbmFyeScpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGQyLCBkaWN0LCAnU2Vjb25kIGFyZ3VtZW50IGlzIG5vdCBhIGRpY3Rpb25hcnknKQoKICAgICAgICBpZiBkMSAhPSBkMjoKICAgICAgICAgICAgc3RhbmRhcmRNc2cgPSAnJXMgIT0gJXMnICUgKHNhZmVfcmVwcihkMSwgVHJ1ZSksIHNhZmVfcmVwcihkMiwgVHJ1ZSkpCiAgICAgICAgICAgIGRpZmYgPSAoJ1xuJyArICdcbicuam9pbihkaWZmbGliLm5kaWZmKAogICAgICAgICAgICAgICAgICAgICAgICAgICBwcHJpbnQucGZvcm1hdChkMSkuc3BsaXRsaW5lcygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICBwcHJpbnQucGZvcm1hdChkMikuc3BsaXRsaW5lcygpKSkpCiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gc2VsZi5fdHJ1bmNhdGVNZXNzYWdlKHN0YW5kYXJkTXNnLCBkaWZmKQogICAgICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0KHNlbGYsIHN1YnNldCwgZGljdGlvbmFyeSwgbXNnPU5vbmUpOgogICAgICAgICIiIkNoZWNrcyB3aGV0aGVyIGRpY3Rpb25hcnkgaXMgYSBzdXBlcnNldCBvZiBzdWJzZXQuIiIiCiAgICAgICAgd2FybmluZ3Mud2FybignYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0IGlzIGRlcHJlY2F0ZWQnLAogICAgICAgICAgICAgICAgICAgICAgRGVwcmVjYXRpb25XYXJuaW5nKQogICAgICAgIG1pc3NpbmcgPSBbXQogICAgICAgIG1pc21hdGNoZWQgPSBbXQogICAgICAgIGZvciBrZXksIHZhbHVlIGluIHN1YnNldC5pdGVtcygpOgogICAgICAgICAgICBpZiBrZXkgbm90IGluIGRpY3Rpb25hcnk6CiAgICAgICAgICAgICAgICBtaXNzaW5nLmFwcGVuZChrZXkpCiAgICAgICAgICAgIGVsaWYgdmFsdWUgIT0gZGljdGlvbmFyeVtrZXldOgogICAgICAgICAgICAgICAgbWlzbWF0Y2hlZC5hcHBlbmQoJyVzLCBleHBlY3RlZDogJXMsIGFjdHVhbDogJXMnICUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChzYWZlX3JlcHIoa2V5KSwgc2FmZV9yZXByKHZhbHVlKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWZlX3JlcHIoZGljdGlvbmFyeVtrZXldKSkpCgogICAgICAgIGlmIG5vdCAobWlzc2luZyBvciBtaXNtYXRjaGVkKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHN0YW5kYXJkTXNnID0gJycKICAgICAgICBpZiBtaXNzaW5nOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICdNaXNzaW5nOiAlcycgJSAnLCcuam9pbihzYWZlX3JlcHIobSkgZm9yIG0gaW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pc3NpbmcpCiAgICAgICAgaWYgbWlzbWF0Y2hlZDoKICAgICAgICAgICAgaWYgc3RhbmRhcmRNc2c6CiAgICAgICAgICAgICAgICBzdGFuZGFyZE1zZyArPSAnOyAnCiAgICAgICAgICAgIHN0YW5kYXJkTXNnICs9ICdNaXNtYXRjaGVkIHZhbHVlczogJXMnICUgJywnLmpvaW4obWlzbWF0Y2hlZCkKCiAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgoKICAgIGRlZiBhc3NlcnRDb3VudEVxdWFsKHNlbGYsIGZpcnN0LCBzZWNvbmQsIG1zZz1Ob25lKToKICAgICAgICAiIiJBbiB1bm9yZGVyZWQgc2VxdWVuY2UgY29tcGFyaXNvbiBhc3NlcnRpbmcgdGhhdCB0aGUgc2FtZSBlbGVtZW50cywKICAgICAgICByZWdhcmRsZXNzIG9mIG9yZGVyLiAgSWYgdGhlIHNhbWUgZWxlbWVudCBvY2N1cnMgbW9yZSB0aGFuIG9uY2UsCiAgICAgICAgaXQgdmVyaWZpZXMgdGhhdCB0aGUgZWxlbWVudHMgb2NjdXIgdGhlIHNhbWUgbnVtYmVyIG9mIHRpbWVzLgoKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChDb3VudGVyKGxpc3QoZmlyc3QpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb3VudGVyKGxpc3Qoc2Vjb25kKSkpCgogICAgICAgICBFeGFtcGxlOgogICAgICAgICAgICAtIFswLCAxLCAxXSBhbmQgWzEsIDAsIDFdIGNvbXBhcmUgZXF1YWwuCiAgICAgICAgICAgIC0gWzAsIDAsIDFdIGFuZCBbMCwgMV0gY29tcGFyZSB1bmVxdWFsLgoKICAgICAgICAiIiIKICAgICAgICBmaXJzdF9zZXEsIHNlY29uZF9zZXEgPSBsaXN0KGZpcnN0KSwgbGlzdChzZWNvbmQpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBmaXJzdCA9IGNvbGxlY3Rpb25zLkNvdW50ZXIoZmlyc3Rfc2VxKQogICAgICAgICAgICBzZWNvbmQgPSBjb2xsZWN0aW9ucy5Db3VudGVyKHNlY29uZF9zZXEpCiAgICAgICAgZXhjZXB0IFR5cGVFcnJvcjoKICAgICAgICAgICAgIyBIYW5kbGUgY2FzZSB3aXRoIHVuaGFzaGFibGUgZWxlbWVudHMKICAgICAgICAgICAgZGlmZmVyZW5jZXMgPSBfY291bnRfZGlmZl9hbGxfcHVycG9zZShmaXJzdF9zZXEsIHNlY29uZF9zZXEpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgZmlyc3QgPT0gc2Vjb25kOgogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGRpZmZlcmVuY2VzID0gX2NvdW50X2RpZmZfaGFzaGFibGUoZmlyc3Rfc2VxLCBzZWNvbmRfc2VxKQoKICAgICAgICBpZiBkaWZmZXJlbmNlczoKICAgICAgICAgICAgc3RhbmRhcmRNc2cgPSAnRWxlbWVudCBjb3VudHMgd2VyZSBub3QgZXF1YWw6XG4nCiAgICAgICAgICAgIGxpbmVzID0gWydGaXJzdCBoYXMgJWQsIFNlY29uZCBoYXMgJWQ6ICAlcicgJSBkaWZmIGZvciBkaWZmIGluIGRpZmZlcmVuY2VzXQogICAgICAgICAgICBkaWZmTXNnID0gJ1xuJy5qb2luKGxpbmVzKQogICAgICAgICAgICBzdGFuZGFyZE1zZyA9IHNlbGYuX3RydW5jYXRlTWVzc2FnZShzdGFuZGFyZE1zZywgZGlmZk1zZykKICAgICAgICAgICAgbXNnID0gc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKQogICAgICAgICAgICBzZWxmLmZhaWwobXNnKQoKICAgIGRlZiBhc3NlcnRNdWx0aUxpbmVFcXVhbChzZWxmLCBmaXJzdCwgc2Vjb25kLCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiQXNzZXJ0IHRoYXQgdHdvIG11bHRpLWxpbmUgc3RyaW5ncyBhcmUgZXF1YWwuIiIiCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGZpcnN0LCBzdHIsICdGaXJzdCBhcmd1bWVudCBpcyBub3QgYSBzdHJpbmcnKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShzZWNvbmQsIHN0ciwgJ1NlY29uZCBhcmd1bWVudCBpcyBub3QgYSBzdHJpbmcnKQoKICAgICAgICBpZiBmaXJzdCAhPSBzZWNvbmQ6CiAgICAgICAgICAgICMgZG9uJ3QgdXNlIGRpZmZsaWIgaWYgdGhlIHN0cmluZ3MgYXJlIHRvbyBsb25nCiAgICAgICAgICAgIGlmIChsZW4oZmlyc3QpID4gc2VsZi5fZGlmZlRocmVzaG9sZCBvcgogICAgICAgICAgICAgICAgbGVuKHNlY29uZCkgPiBzZWxmLl9kaWZmVGhyZXNob2xkKToKICAgICAgICAgICAgICAgIHNlbGYuX2Jhc2VBc3NlcnRFcXVhbChmaXJzdCwgc2Vjb25kLCBtc2cpCiAgICAgICAgICAgIGZpcnN0bGluZXMgPSBmaXJzdC5zcGxpdGxpbmVzKGtlZXBlbmRzPVRydWUpCiAgICAgICAgICAgIHNlY29uZGxpbmVzID0gc2Vjb25kLnNwbGl0bGluZXMoa2VlcGVuZHM9VHJ1ZSkKICAgICAgICAgICAgaWYgbGVuKGZpcnN0bGluZXMpID09IDEgYW5kIGZpcnN0LnN0cmlwKCdcclxuJykgPT0gZmlyc3Q6CiAgICAgICAgICAgICAgICBmaXJzdGxpbmVzID0gW2ZpcnN0ICsgJ1xuJ10KICAgICAgICAgICAgICAgIHNlY29uZGxpbmVzID0gW3NlY29uZCArICdcbiddCiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzICE9ICVzJyAlIChzYWZlX3JlcHIoZmlyc3QsIFRydWUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKHNlY29uZCwgVHJ1ZSkpCiAgICAgICAgICAgIGRpZmYgPSAnXG4nICsgJycuam9pbihkaWZmbGliLm5kaWZmKGZpcnN0bGluZXMsIHNlY29uZGxpbmVzKSkKICAgICAgICAgICAgc3RhbmRhcmRNc2cgPSBzZWxmLl90cnVuY2F0ZU1lc3NhZ2Uoc3RhbmRhcmRNc2csIGRpZmYpCiAgICAgICAgICAgIHNlbGYuZmFpbChzZWxmLl9mb3JtYXRNZXNzYWdlKG1zZywgc3RhbmRhcmRNc2cpKQoKICAgIGRlZiBhc3NlcnRMZXNzKHNlbGYsIGEsIGIsIG1zZz1Ob25lKToKICAgICAgICAiIiJKdXN0IGxpa2Ugc2VsZi5hc3NlcnRUcnVlKGEgPCBiKSwgYnV0IHdpdGggYSBuaWNlciBkZWZhdWx0IG1lc3NhZ2UuIiIiCiAgICAgICAgaWYgbm90IGEgPCBiOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyBub3QgbGVzcyB0aGFuICVzJyAlIChzYWZlX3JlcHIoYSksIHNhZmVfcmVwcihiKSkKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydExlc3NFcXVhbChzZWxmLCBhLCBiLCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiSnVzdCBsaWtlIHNlbGYuYXNzZXJ0VHJ1ZShhIDw9IGIpLCBidXQgd2l0aCBhIG5pY2VyIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBub3QgYSA8PSBiOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyBub3QgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJyAlIChzYWZlX3JlcHIoYSksIHNhZmVfcmVwcihiKSkKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydEdyZWF0ZXIoc2VsZiwgYSwgYiwgbXNnPU5vbmUpOgogICAgICAgICIiIkp1c3QgbGlrZSBzZWxmLmFzc2VydFRydWUoYSA+IGIpLCBidXQgd2l0aCBhIG5pY2VyIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBub3QgYSA+IGI6CiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzIG5vdCBncmVhdGVyIHRoYW4gJXMnICUgKHNhZmVfcmVwcihhKSwgc2FmZV9yZXByKGIpKQogICAgICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0R3JlYXRlckVxdWFsKHNlbGYsIGEsIGIsIG1zZz1Ob25lKToKICAgICAgICAiIiJKdXN0IGxpa2Ugc2VsZi5hc3NlcnRUcnVlKGEgPj0gYiksIGJ1dCB3aXRoIGEgbmljZXIgZGVmYXVsdCBtZXNzYWdlLiIiIgogICAgICAgIGlmIG5vdCBhID49IGI6CiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzIG5vdCBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMnICUgKHNhZmVfcmVwcihhKSwgc2FmZV9yZXByKGIpKQogICAgICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0SXNOb25lKHNlbGYsIG9iaiwgbXNnPU5vbmUpOgogICAgICAgICIiIlNhbWUgYXMgc2VsZi5hc3NlcnRUcnVlKG9iaiBpcyBOb25lKSwgd2l0aCBhIG5pY2VyIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBvYmogaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzIGlzIG5vdCBOb25lJyAlIChzYWZlX3JlcHIob2JqKSwpCiAgICAgICAgICAgIHNlbGYuZmFpbChzZWxmLl9mb3JtYXRNZXNzYWdlKG1zZywgc3RhbmRhcmRNc2cpKQoKICAgIGRlZiBhc3NlcnRJc05vdE5vbmUoc2VsZiwgb2JqLCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiSW5jbHVkZWQgZm9yIHN5bW1ldHJ5IHdpdGggYXNzZXJ0SXNOb25lLiIiIgogICAgICAgIGlmIG9iaiBpcyBOb25lOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICd1bmV4cGVjdGVkbHkgTm9uZScKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydElzSW5zdGFuY2Uoc2VsZiwgb2JqLCBjbHMsIG1zZz1Ob25lKToKICAgICAgICAiIiJTYW1lIGFzIHNlbGYuYXNzZXJ0VHJ1ZShpc2luc3RhbmNlKG9iaiwgY2xzKSksIHdpdGggYSBuaWNlcgogICAgICAgIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvYmosIGNscyk6CiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzIGlzIG5vdCBhbiBpbnN0YW5jZSBvZiAlcicgJSAoc2FmZV9yZXByKG9iaiksIGNscykKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydE5vdElzSW5zdGFuY2Uoc2VsZiwgb2JqLCBjbHMsIG1zZz1Ob25lKToKICAgICAgICAiIiJJbmNsdWRlZCBmb3Igc3ltbWV0cnkgd2l0aCBhc3NlcnRJc0luc3RhbmNlLiIiIgogICAgICAgIGlmIGlzaW5zdGFuY2Uob2JqLCBjbHMpOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyBpcyBhbiBpbnN0YW5jZSBvZiAlcicgJSAoc2FmZV9yZXByKG9iaiksIGNscykKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydFJhaXNlc1JlZ2V4KHNlbGYsIGV4cGVjdGVkX2V4Y2VwdGlvbiwgZXhwZWN0ZWRfcmVnZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGFibGVfb2JqPU5vbmUsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgIiIiQXNzZXJ0cyB0aGF0IHRoZSBtZXNzYWdlIGluIGEgcmFpc2VkIGV4Y2VwdGlvbiBtYXRjaGVzIGEgcmVnZXguCgogICAgICAgIEFyZ3M6CiAgICAgICAgICAgIGV4cGVjdGVkX2V4Y2VwdGlvbjogRXhjZXB0aW9uIGNsYXNzIGV4cGVjdGVkIHRvIGJlIHJhaXNlZC4KICAgICAgICAgICAgZXhwZWN0ZWRfcmVnZXg6IFJlZ2V4IChyZSBwYXR0ZXJuIG9iamVjdCBvciBzdHJpbmcpIGV4cGVjdGVkCiAgICAgICAgICAgICAgICAgICAgdG8gYmUgZm91bmQgaW4gZXJyb3IgbWVzc2FnZS4KICAgICAgICAgICAgY2FsbGFibGVfb2JqOiBGdW5jdGlvbiB0byBiZSBjYWxsZWQuCiAgICAgICAgICAgIG1zZzogT3B0aW9uYWwgbWVzc2FnZSB1c2VkIGluIGNhc2Ugb2YgZmFpbHVyZS4gQ2FuIG9ubHkgYmUgdXNlZAogICAgICAgICAgICAgICAgICAgIHdoZW4gYXNzZXJ0UmFpc2VzUmVnZXggaXMgdXNlZCBhcyBhIGNvbnRleHQgbWFuYWdlci4KICAgICAgICAgICAgYXJnczogRXh0cmEgYXJncy4KICAgICAgICAgICAga3dhcmdzOiBFeHRyYSBrd2FyZ3MuCiAgICAgICAgIiIiCiAgICAgICAgY29udGV4dCA9IF9Bc3NlcnRSYWlzZXNDb250ZXh0KGV4cGVjdGVkX2V4Y2VwdGlvbiwgc2VsZiwgY2FsbGFibGVfb2JqLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3RlZF9yZWdleCkKCiAgICAgICAgcmV0dXJuIGNvbnRleHQuaGFuZGxlKCdhc3NlcnRSYWlzZXNSZWdleCcsIGNhbGxhYmxlX29iaiwgYXJncywga3dhcmdzKQoKICAgIGRlZiBhc3NlcnRXYXJuc1JlZ2V4KHNlbGYsIGV4cGVjdGVkX3dhcm5pbmcsIGV4cGVjdGVkX3JlZ2V4LAogICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGFibGVfb2JqPU5vbmUsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgIiIiQXNzZXJ0cyB0aGF0IHRoZSBtZXNzYWdlIGluIGEgdHJpZ2dlcmVkIHdhcm5pbmcgbWF0Y2hlcyBhIHJlZ2V4cC4KICAgICAgICBCYXNpYyBmdW5jdGlvbmluZyBpcyBzaW1pbGFyIHRvIGFzc2VydFdhcm5zKCkgd2l0aCB0aGUgYWRkaXRpb24KICAgICAgICB0aGF0IG9ubHkgd2FybmluZ3Mgd2hvc2UgbWVzc2FnZXMgYWxzbyBtYXRjaCB0aGUgcmVndWxhciBleHByZXNzaW9uCiAgICAgICAgYXJlIGNvbnNpZGVyZWQgc3VjY2Vzc2Z1bCBtYXRjaGVzLgoKICAgICAgICBBcmdzOgogICAgICAgICAgICBleHBlY3RlZF93YXJuaW5nOiBXYXJuaW5nIGNsYXNzIGV4cGVjdGVkIHRvIGJlIHRyaWdnZXJlZC4KICAgICAgICAgICAgZXhwZWN0ZWRfcmVnZXg6IFJlZ2V4IChyZSBwYXR0ZXJuIG9iamVjdCBvciBzdHJpbmcpIGV4cGVjdGVkCiAgICAgICAgICAgICAgICAgICAgdG8gYmUgZm91bmQgaW4gZXJyb3IgbWVzc2FnZS4KICAgICAgICAgICAgY2FsbGFibGVfb2JqOiBGdW5jdGlvbiB0byBiZSBjYWxsZWQuCiAgICAgICAgICAgIG1zZzogT3B0aW9uYWwgbWVzc2FnZSB1c2VkIGluIGNhc2Ugb2YgZmFpbHVyZS4gQ2FuIG9ubHkgYmUgdXNlZAogICAgICAgICAgICAgICAgICAgIHdoZW4gYXNzZXJ0V2FybnNSZWdleCBpcyB1c2VkIGFzIGEgY29udGV4dCBtYW5hZ2VyLgogICAgICAgICAgICBhcmdzOiBFeHRyYSBhcmdzLgogICAgICAgICAgICBrd2FyZ3M6IEV4dHJhIGt3YXJncy4KICAgICAgICAiIiIKICAgICAgICBjb250ZXh0ID0gX0Fzc2VydFdhcm5zQ29udGV4dChleHBlY3RlZF93YXJuaW5nLCBzZWxmLCBjYWxsYWJsZV9vYmosCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWRfcmVnZXgpCiAgICAgICAgcmV0dXJuIGNvbnRleHQuaGFuZGxlKCdhc3NlcnRXYXJuc1JlZ2V4JywgY2FsbGFibGVfb2JqLCBhcmdzLCBrd2FyZ3MpCgogICAgZGVmIGFzc2VydFJlZ2V4KHNlbGYsIHRleHQsIGV4cGVjdGVkX3JlZ2V4LCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiRmFpbCB0aGUgdGVzdCB1bmxlc3MgdGhlIHRleHQgbWF0Y2hlcyB0aGUgcmVndWxhciBleHByZXNzaW9uLiIiIgogICAgICAgIGlmIGlzaW5zdGFuY2UoZXhwZWN0ZWRfcmVnZXgsIChzdHIsIGJ5dGVzKSk6CiAgICAgICAgICAgIGFzc2VydCBleHBlY3RlZF9yZWdleCwgImV4cGVjdGVkX3JlZ2V4IG11c3Qgbm90IGJlIGVtcHR5LiIKICAgICAgICAgICAgZXhwZWN0ZWRfcmVnZXggPSByZS5jb21waWxlKGV4cGVjdGVkX3JlZ2V4KQogICAgICAgIGlmIG5vdCBleHBlY3RlZF9yZWdleC5zZWFyY2godGV4dCk6CiAgICAgICAgICAgIG1zZyA9IG1zZyBvciAiUmVnZXggZGlkbid0IG1hdGNoIgogICAgICAgICAgICBtc2cgPSAnJXM6ICVyIG5vdCBmb3VuZCBpbiAlcicgJSAobXNnLCBleHBlY3RlZF9yZWdleC5wYXR0ZXJuLCB0ZXh0KQogICAgICAgICAgICByYWlzZSBzZWxmLmZhaWx1cmVFeGNlcHRpb24obXNnKQoKICAgIGRlZiBhc3NlcnROb3RSZWdleChzZWxmLCB0ZXh0LCB1bmV4cGVjdGVkX3JlZ2V4LCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiRmFpbCB0aGUgdGVzdCBpZiB0aGUgdGV4dCBtYXRjaGVzIHRoZSByZWd1bGFyIGV4cHJlc3Npb24uIiIiCiAgICAgICAgaWYgaXNpbnN0YW5jZSh1bmV4cGVjdGVkX3JlZ2V4LCAoc3RyLCBieXRlcykpOgogICAgICAgICAgICB1bmV4cGVjdGVkX3JlZ2V4ID0gcmUuY29tcGlsZSh1bmV4cGVjdGVkX3JlZ2V4KQogICAgICAgIG1hdGNoID0gdW5leHBlY3RlZF9yZWdleC5zZWFyY2godGV4dCkKICAgICAgICBpZiBtYXRjaDoKICAgICAgICAgICAgbXNnID0gbXNnIG9yICJSZWdleCBtYXRjaGVkIgogICAgICAgICAgICBtc2cgPSAnJXM6ICVyIG1hdGNoZXMgJXIgaW4gJXInICUgKG1zZywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0W21hdGNoLnN0YXJ0KCk6bWF0Y2guZW5kKCldLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuZXhwZWN0ZWRfcmVnZXgucGF0dGVybiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0KQogICAgICAgICAgICByYWlzZSBzZWxmLmZhaWx1cmVFeGNlcHRpb24obXNnKQoKCiAgICBkZWYgX2RlcHJlY2F0ZShvcmlnaW5hbF9mdW5jKToKICAgICAgICBkZWYgZGVwcmVjYXRlZF9mdW5jKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHdhcm5pbmdzLndhcm4oCiAgICAgICAgICAgICAgICAnUGxlYXNlIHVzZSB7MH0gaW5zdGVhZC4nLmZvcm1hdChvcmlnaW5hbF9mdW5jLl9fbmFtZV9fKSwKICAgICAgICAgICAgICAgIERlcHJlY2F0aW9uV2FybmluZywgMikKICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsX2Z1bmMoKmFyZ3MsICoqa3dhcmdzKQogICAgICAgIHJldHVybiBkZXByZWNhdGVkX2Z1bmMKCiAgICAjIHNlZSAjOTQyNAogICAgZmFpbFVubGVzc0VxdWFsID0gYXNzZXJ0RXF1YWxzID0gX2RlcHJlY2F0ZShhc3NlcnRFcXVhbCkKICAgIGZhaWxJZkVxdWFsID0gYXNzZXJ0Tm90RXF1YWxzID0gX2RlcHJlY2F0ZShhc3NlcnROb3RFcXVhbCkKICAgIGZhaWxVbmxlc3NBbG1vc3RFcXVhbCA9IGFzc2VydEFsbW9zdEVxdWFscyA9IF9kZXByZWNhdGUoYXNzZXJ0QWxtb3N0RXF1YWwpCiAgICBmYWlsSWZBbG1vc3RFcXVhbCA9IGFzc2VydE5vdEFsbW9zdEVxdWFscyA9IF9kZXByZWNhdGUoYXNzZXJ0Tm90QWxtb3N0RXF1YWwpCiAgICBmYWlsVW5sZXNzID0gYXNzZXJ0XyA9IF9kZXByZWNhdGUoYXNzZXJ0VHJ1ZSkKICAgIGZhaWxVbmxlc3NSYWlzZXMgPSBfZGVwcmVjYXRlKGFzc2VydFJhaXNlcykKICAgIGZhaWxJZiA9IF9kZXByZWNhdGUoYXNzZXJ0RmFsc2UpCiAgICBhc3NlcnRSYWlzZXNSZWdleHAgPSBfZGVwcmVjYXRlKGFzc2VydFJhaXNlc1JlZ2V4KQogICAgYXNzZXJ0UmVnZXhwTWF0Y2hlcyA9IF9kZXByZWNhdGUoYXNzZXJ0UmVnZXgpCgoKCmNsYXNzIEZ1bmN0aW9uVGVzdENhc2UoVGVzdENhc2UpOgogICAgIiIiQSB0ZXN0IGNhc2UgdGhhdCB3cmFwcyBhIHRlc3QgZnVuY3Rpb24uCgogICAgVGhpcyBpcyB1c2VmdWwgZm9yIHNsaXBwaW5nIHByZS1leGlzdGluZyB0ZXN0IGZ1bmN0aW9ucyBpbnRvIHRoZQogICAgdW5pdHRlc3QgZnJhbWV3b3JrLiBPcHRpb25hbGx5LCBzZXQtdXAgYW5kIHRpZHktdXAgZnVuY3Rpb25zIGNhbiBiZQogICAgc3VwcGxpZWQuIEFzIHdpdGggVGVzdENhc2UsIHRoZSB0aWR5LXVwICgndGVhckRvd24nKSBmdW5jdGlvbiB3aWxsCiAgICBhbHdheXMgYmUgY2FsbGVkIGlmIHRoZSBzZXQtdXAgKCdzZXRVcCcpIGZ1bmN0aW9uIHJhbiBzdWNjZXNzZnVsbHkuCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgdGVzdEZ1bmMsIHNldFVwPU5vbmUsIHRlYXJEb3duPU5vbmUsIGRlc2NyaXB0aW9uPU5vbmUpOgogICAgICAgIHN1cGVyKEZ1bmN0aW9uVGVzdENhc2UsIHNlbGYpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLl9zZXRVcEZ1bmMgPSBzZXRVcAogICAgICAgIHNlbGYuX3RlYXJEb3duRnVuYyA9IHRlYXJEb3duCiAgICAgICAgc2VsZi5fdGVzdEZ1bmMgPSB0ZXN0RnVuYwogICAgICAgIHNlbGYuX2Rlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24KCiAgICBkZWYgc2V0VXAoc2VsZik6CiAgICAgICAgaWYgc2VsZi5fc2V0VXBGdW5jIGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLl9zZXRVcEZ1bmMoKQoKICAgIGRlZiB0ZWFyRG93bihzZWxmKToKICAgICAgICBpZiBzZWxmLl90ZWFyRG93bkZ1bmMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHNlbGYuX3RlYXJEb3duRnVuYygpCgogICAgZGVmIHJ1blRlc3Qoc2VsZik6CiAgICAgICAgc2VsZi5fdGVzdEZ1bmMoKQoKICAgIGRlZiBpZChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fdGVzdEZ1bmMuX19uYW1lX18KCiAgICBkZWYgX19lcV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgc2VsZi5fX2NsYXNzX18pOgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICAgICAgcmV0dXJuIHNlbGYuX3NldFVwRnVuYyA9PSBvdGhlci5fc2V0VXBGdW5jIGFuZCBcCiAgICAgICAgICAgICAgIHNlbGYuX3RlYXJEb3duRnVuYyA9PSBvdGhlci5fdGVhckRvd25GdW5jIGFuZCBcCiAgICAgICAgICAgICAgIHNlbGYuX3Rlc3RGdW5jID09IG90aGVyLl90ZXN0RnVuYyBhbmQgXAogICAgICAgICAgICAgICBzZWxmLl9kZXNjcmlwdGlvbiA9PSBvdGhlci5fZGVzY3JpcHRpb24KCiAgICBkZWYgX19uZV9fKHNlbGYsIG90aGVyKToKICAgICAgICByZXR1cm4gbm90IHNlbGYgPT0gb3RoZXIKCiAgICBkZWYgX19oYXNoX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGhhc2goKHR5cGUoc2VsZiksIHNlbGYuX3NldFVwRnVuYywgc2VsZi5fdGVhckRvd25GdW5jLAogICAgICAgICAgICAgICAgICAgICBzZWxmLl90ZXN0RnVuYywgc2VsZi5fZGVzY3JpcHRpb24pKQoKICAgIGRlZiBfX3N0cl9fKHNlbGYpOgogICAgICAgIHJldHVybiAiJXMgKCVzKSIgJSAoc3RyY2xhc3Moc2VsZi5fX2NsYXNzX18pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fdGVzdEZ1bmMuX19uYW1lX18pCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiAiPCVzIHRlYz0lcz4iICUgKHN0cmNsYXNzKHNlbGYuX19jbGFzc19fKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3Rlc3RGdW5jKQoKICAgIGRlZiBzaG9ydERlc2NyaXB0aW9uKHNlbGYpOgogICAgICAgIGlmIHNlbGYuX2Rlc2NyaXB0aW9uIGlzIG5vdCBOb25lOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fZGVzY3JpcHRpb24KICAgICAgICBkb2MgPSBzZWxmLl90ZXN0RnVuYy5fX2RvY19fCiAgICAgICAgcmV0dXJuIGRvYyBhbmQgZG9jLnNwbGl0KCJcbiIpWzBdLnN0cmlwKCkgb3IgTm9uZQo=',
'/Lib/unittest/loader.py':'IiIiTG9hZGluZyB1bml0dGVzdHMuIiIiCgppbXBvcnQgb3MKaW1wb3J0IHJlCmltcG9ydCBzeXMKaW1wb3J0IHRyYWNlYmFjawppbXBvcnQgdHlwZXMKaW1wb3J0IGZ1bmN0b29scwoKZnJvbSBmbm1hdGNoIGltcG9ydCBmbm1hdGNoCgpmcm9tIC4gaW1wb3J0IGNhc2UsIHN1aXRlLCB1dGlsCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKIyB3aGF0IGFib3V0IC5weWMgb3IgLnB5byAoZXRjKQojIHdlIHdvdWxkIG5lZWQgdG8gYXZvaWQgbG9hZGluZyB0aGUgc2FtZSB0ZXN0cyBtdWx0aXBsZSB0aW1lcwojIGZyb20gJy5weScsICcucHljJyAqYW5kKiAnLnB5bycKVkFMSURfTU9EVUxFX05BTUUgPSByZS5jb21waWxlKHInW19hLXpdXHcqXC5weSQnLCByZS5JR05PUkVDQVNFKQoKCmRlZiBfbWFrZV9mYWlsZWRfaW1wb3J0X3Rlc3QobmFtZSwgc3VpdGVDbGFzcyk6CiAgICBtZXNzYWdlID0gJ0ZhaWxlZCB0byBpbXBvcnQgdGVzdCBtb2R1bGU6ICVzXG4lcycgJSAobmFtZSwgdHJhY2ViYWNrLmZvcm1hdF9leGMoKSkKICAgIHJldHVybiBfbWFrZV9mYWlsZWRfdGVzdCgnTW9kdWxlSW1wb3J0RmFpbHVyZScsIG5hbWUsIEltcG9ydEVycm9yKG1lc3NhZ2UpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1aXRlQ2xhc3MpCgpkZWYgX21ha2VfZmFpbGVkX2xvYWRfdGVzdHMobmFtZSwgZXhjZXB0aW9uLCBzdWl0ZUNsYXNzKToKICAgIHJldHVybiBfbWFrZV9mYWlsZWRfdGVzdCgnTG9hZFRlc3RzRmFpbHVyZScsIG5hbWUsIGV4Y2VwdGlvbiwgc3VpdGVDbGFzcykKCmRlZiBfbWFrZV9mYWlsZWRfdGVzdChjbGFzc25hbWUsIG1ldGhvZG5hbWUsIGV4Y2VwdGlvbiwgc3VpdGVDbGFzcyk6CiAgICBkZWYgdGVzdEZhaWx1cmUoc2VsZik6CiAgICAgICAgcmFpc2UgZXhjZXB0aW9uCiAgICBhdHRycyA9IHttZXRob2RuYW1lOiB0ZXN0RmFpbHVyZX0KICAgIFRlc3RDbGFzcyA9IHR5cGUoY2xhc3NuYW1lLCAoY2FzZS5UZXN0Q2FzZSwpLCBhdHRycykKICAgIHJldHVybiBzdWl0ZUNsYXNzKChUZXN0Q2xhc3MobWV0aG9kbmFtZSksKSkKCmRlZiBfanl0aG9uX2F3YXJlX3NwbGl0ZXh0KHBhdGgpOgogICAgaWYgcGF0aC5sb3dlcigpLmVuZHN3aXRoKCckcHkuY2xhc3MnKToKICAgICAgICByZXR1cm4gcGF0aFs6LTldCiAgICByZXR1cm4gb3MucGF0aC5zcGxpdGV4dChwYXRoKVswXQoKCmNsYXNzIFRlc3RMb2FkZXIob2JqZWN0KToKICAgICIiIgogICAgVGhpcyBjbGFzcyBpcyByZXNwb25zaWJsZSBmb3IgbG9hZGluZyB0ZXN0cyBhY2NvcmRpbmcgdG8gdmFyaW91cyBjcml0ZXJpYQogICAgYW5kIHJldHVybmluZyB0aGVtIHdyYXBwZWQgaW4gYSBUZXN0U3VpdGUKICAgICIiIgogICAgdGVzdE1ldGhvZFByZWZpeCA9ICd0ZXN0JwogICAgc29ydFRlc3RNZXRob2RzVXNpbmcgPSBzdGF0aWNtZXRob2QodXRpbC50aHJlZV93YXlfY21wKQogICAgc3VpdGVDbGFzcyA9IHN1aXRlLlRlc3RTdWl0ZQogICAgX3RvcF9sZXZlbF9kaXIgPSBOb25lCgogICAgZGVmIGxvYWRUZXN0c0Zyb21UZXN0Q2FzZShzZWxmLCB0ZXN0Q2FzZUNsYXNzKToKICAgICAgICAiIiJSZXR1cm4gYSBzdWl0ZSBvZiBhbGwgdGVzdHMgY2FzZXMgY29udGFpbmVkIGluIHRlc3RDYXNlQ2xhc3MiIiIKICAgICAgICBpZiBpc3N1YmNsYXNzKHRlc3RDYXNlQ2xhc3MsIHN1aXRlLlRlc3RTdWl0ZSk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiVGVzdCBjYXNlcyBzaG91bGQgbm90IGJlIGRlcml2ZWQgZnJvbSBUZXN0U3VpdGUuIiBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBNYXliZSB5b3UgbWVhbnQgdG8gZGVyaXZlIGZyb20gVGVzdENhc2U/IikKICAgICAgICB0ZXN0Q2FzZU5hbWVzID0gc2VsZi5nZXRUZXN0Q2FzZU5hbWVzKHRlc3RDYXNlQ2xhc3MpCiAgICAgICAgaWYgbm90IHRlc3RDYXNlTmFtZXMgYW5kIGhhc2F0dHIodGVzdENhc2VDbGFzcywgJ3J1blRlc3QnKToKICAgICAgICAgICAgdGVzdENhc2VOYW1lcyA9IFsncnVuVGVzdCddCiAgICAgICAgbG9hZGVkX3N1aXRlID0gc2VsZi5zdWl0ZUNsYXNzKG1hcCh0ZXN0Q2FzZUNsYXNzLCB0ZXN0Q2FzZU5hbWVzKSkKICAgICAgICByZXR1cm4gbG9hZGVkX3N1aXRlCgogICAgZGVmIGxvYWRUZXN0c0Zyb21Nb2R1bGUoc2VsZiwgbW9kdWxlLCB1c2VfbG9hZF90ZXN0cz1UcnVlKToKICAgICAgICAiIiJSZXR1cm4gYSBzdWl0ZSBvZiBhbGwgdGVzdHMgY2FzZXMgY29udGFpbmVkIGluIHRoZSBnaXZlbiBtb2R1bGUiIiIKICAgICAgICB0ZXN0cyA9IFtdCiAgICAgICAgZm9yIG5hbWUgaW4gZGlyKG1vZHVsZSk6CiAgICAgICAgICAgIG9iaiA9IGdldGF0dHIobW9kdWxlLCBuYW1lKQogICAgICAgICAgICBpZiBpc2luc3RhbmNlKG9iaiwgdHlwZSkgYW5kIGlzc3ViY2xhc3Mob2JqLCBjYXNlLlRlc3RDYXNlKToKICAgICAgICAgICAgICAgIHRlc3RzLmFwcGVuZChzZWxmLmxvYWRUZXN0c0Zyb21UZXN0Q2FzZShvYmopKQoKICAgICAgICBsb2FkX3Rlc3RzID0gZ2V0YXR0cihtb2R1bGUsICdsb2FkX3Rlc3RzJywgTm9uZSkKICAgICAgICB0ZXN0cyA9IHNlbGYuc3VpdGVDbGFzcyh0ZXN0cykKICAgICAgICBpZiB1c2VfbG9hZF90ZXN0cyBhbmQgbG9hZF90ZXN0cyBpcyBub3QgTm9uZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRfdGVzdHMoc2VsZiwgdGVzdHMsIE5vbmUpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHJldHVybiBfbWFrZV9mYWlsZWRfbG9hZF90ZXN0cyhtb2R1bGUuX19uYW1lX18sIGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zdWl0ZUNsYXNzKQogICAgICAgIHJldHVybiB0ZXN0cwoKICAgIGRlZiBsb2FkVGVzdHNGcm9tTmFtZShzZWxmLCBuYW1lLCBtb2R1bGU9Tm9uZSk6CiAgICAgICAgIiIiUmV0dXJuIGEgc3VpdGUgb2YgYWxsIHRlc3RzIGNhc2VzIGdpdmVuIGEgc3RyaW5nIHNwZWNpZmllci4KCiAgICAgICAgVGhlIG5hbWUgbWF5IHJlc29sdmUgZWl0aGVyIHRvIGEgbW9kdWxlLCBhIHRlc3QgY2FzZSBjbGFzcywgYQogICAgICAgIHRlc3QgbWV0aG9kIHdpdGhpbiBhIHRlc3QgY2FzZSBjbGFzcywgb3IgYSBjYWxsYWJsZSBvYmplY3Qgd2hpY2gKICAgICAgICByZXR1cm5zIGEgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlLgoKICAgICAgICBUaGUgbWV0aG9kIG9wdGlvbmFsbHkgcmVzb2x2ZXMgdGhlIG5hbWVzIHJlbGF0aXZlIHRvIGEgZ2l2ZW4gbW9kdWxlLgogICAgICAgICIiIgogICAgICAgIHBhcnRzID0gbmFtZS5zcGxpdCgnLicpCiAgICAgICAgaWYgbW9kdWxlIGlzIE5vbmU6CiAgICAgICAgICAgIHBhcnRzX2NvcHkgPSBwYXJ0c1s6XQogICAgICAgICAgICB3aGlsZSBwYXJ0c19jb3B5OgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIG1vZHVsZSA9IF9faW1wb3J0X18oJy4nLmpvaW4ocGFydHNfY29weSkpCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgICAgICAgICAgICAgICAgICBkZWwgcGFydHNfY29weVstMV0KICAgICAgICAgICAgICAgICAgICBpZiBub3QgcGFydHNfY29weToKICAgICAgICAgICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgcGFydHMgPSBwYXJ0c1sxOl0KICAgICAgICBvYmogPSBtb2R1bGUKICAgICAgICBmb3IgcGFydCBpbiBwYXJ0czoKICAgICAgICAgICAgcGFyZW50LCBvYmogPSBvYmosIGdldGF0dHIob2JqLCBwYXJ0KQoKICAgICAgICBpZiBpc2luc3RhbmNlKG9iaiwgdHlwZXMuTW9kdWxlVHlwZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmxvYWRUZXN0c0Zyb21Nb2R1bGUob2JqKQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShvYmosIHR5cGUpIGFuZCBpc3N1YmNsYXNzKG9iaiwgY2FzZS5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmxvYWRUZXN0c0Zyb21UZXN0Q2FzZShvYmopCiAgICAgICAgZWxpZiAoaXNpbnN0YW5jZShvYmosIHR5cGVzLkZ1bmN0aW9uVHlwZSkgYW5kCiAgICAgICAgICAgICAgaXNpbnN0YW5jZShwYXJlbnQsIHR5cGUpIGFuZAogICAgICAgICAgICAgIGlzc3ViY2xhc3MocGFyZW50LCBjYXNlLlRlc3RDYXNlKSk6CiAgICAgICAgICAgIG5hbWUgPSBvYmouX19uYW1lX18KICAgICAgICAgICAgaW5zdCA9IHBhcmVudChuYW1lKQogICAgICAgICAgICAjIHN0YXRpYyBtZXRob2RzIGZvbGxvdyBhIGRpZmZlcmVudCBwYXRoCiAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKGdldGF0dHIoaW5zdCwgbmFtZSksIHR5cGVzLkZ1bmN0aW9uVHlwZSk6CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5zdWl0ZUNsYXNzKFtpbnN0XSkKICAgICAgICBlbGlmIGlzaW5zdGFuY2Uob2JqLCBzdWl0ZS5UZXN0U3VpdGUpOgogICAgICAgICAgICByZXR1cm4gb2JqCiAgICAgICAgaWYgY2FsbGFibGUob2JqKToKICAgICAgICAgICAgdGVzdCA9IG9iaigpCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodGVzdCwgc3VpdGUuVGVzdFN1aXRlKToKICAgICAgICAgICAgICAgIHJldHVybiB0ZXN0CiAgICAgICAgICAgIGVsaWYgaXNpbnN0YW5jZSh0ZXN0LCBjYXNlLlRlc3RDYXNlKToKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnN1aXRlQ2xhc3MoW3Rlc3RdKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJjYWxsaW5nICVzIHJldHVybmVkICVzLCBub3QgYSB0ZXN0IiAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG9iaiwgdGVzdCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJkb24ndCBrbm93IGhvdyB0byBtYWtlIHRlc3QgZnJvbTogJXMiICUgb2JqKQoKICAgIGRlZiBsb2FkVGVzdHNGcm9tTmFtZXMoc2VsZiwgbmFtZXMsIG1vZHVsZT1Ob25lKToKICAgICAgICAiIiJSZXR1cm4gYSBzdWl0ZSBvZiBhbGwgdGVzdHMgY2FzZXMgZm91bmQgdXNpbmcgdGhlIGdpdmVuIHNlcXVlbmNlCiAgICAgICAgb2Ygc3RyaW5nIHNwZWNpZmllcnMuIFNlZSAnbG9hZFRlc3RzRnJvbU5hbWUoKScuCiAgICAgICAgIiIiCiAgICAgICAgc3VpdGVzID0gW3NlbGYubG9hZFRlc3RzRnJvbU5hbWUobmFtZSwgbW9kdWxlKSBmb3IgbmFtZSBpbiBuYW1lc10KICAgICAgICByZXR1cm4gc2VsZi5zdWl0ZUNsYXNzKHN1aXRlcykKCiAgICBkZWYgZ2V0VGVzdENhc2VOYW1lcyhzZWxmLCB0ZXN0Q2FzZUNsYXNzKToKICAgICAgICAiIiJSZXR1cm4gYSBzb3J0ZWQgc2VxdWVuY2Ugb2YgbWV0aG9kIG5hbWVzIGZvdW5kIHdpdGhpbiB0ZXN0Q2FzZUNsYXNzCiAgICAgICAgIiIiCiAgICAgICAgZGVmIGlzVGVzdE1ldGhvZChhdHRybmFtZSwgdGVzdENhc2VDbGFzcz10ZXN0Q2FzZUNsYXNzLAogICAgICAgICAgICAgICAgICAgICAgICAgcHJlZml4PXNlbGYudGVzdE1ldGhvZFByZWZpeCk6CiAgICAgICAgICAgIHJldHVybiBhdHRybmFtZS5zdGFydHN3aXRoKHByZWZpeCkgYW5kIFwKICAgICAgICAgICAgICAgIGNhbGxhYmxlKGdldGF0dHIodGVzdENhc2VDbGFzcywgYXR0cm5hbWUpKQogICAgICAgIHRlc3RGbk5hbWVzID0gbGlzdChmaWx0ZXIoaXNUZXN0TWV0aG9kLCBkaXIodGVzdENhc2VDbGFzcykpKQogICAgICAgIGlmIHNlbGYuc29ydFRlc3RNZXRob2RzVXNpbmc6CiAgICAgICAgICAgIHRlc3RGbk5hbWVzLnNvcnQoa2V5PWZ1bmN0b29scy5jbXBfdG9fa2V5KHNlbGYuc29ydFRlc3RNZXRob2RzVXNpbmcpKQogICAgICAgIHJldHVybiB0ZXN0Rm5OYW1lcwoKICAgIGRlZiBkaXNjb3ZlcihzZWxmLCBzdGFydF9kaXIsIHBhdHRlcm49J3Rlc3QqLnB5JywgdG9wX2xldmVsX2Rpcj1Ob25lKToKICAgICAgICAiIiJGaW5kIGFuZCByZXR1cm4gYWxsIHRlc3QgbW9kdWxlcyBmcm9tIHRoZSBzcGVjaWZpZWQgc3RhcnQKICAgICAgICBkaXJlY3RvcnksIHJlY3Vyc2luZyBpbnRvIHN1YmRpcmVjdG9yaWVzIHRvIGZpbmQgdGhlbSBhbmQgcmV0dXJuIGFsbAogICAgICAgIHRlc3RzIGZvdW5kIHdpdGhpbiB0aGVtLiBPbmx5IHRlc3QgZmlsZXMgdGhhdCBtYXRjaCB0aGUgcGF0dGVybiB3aWxsCiAgICAgICAgYmUgbG9hZGVkLiAoVXNpbmcgc2hlbGwgc3R5bGUgcGF0dGVybiBtYXRjaGluZy4pCgogICAgICAgIEFsbCB0ZXN0IG1vZHVsZXMgbXVzdCBiZSBpbXBvcnRhYmxlIGZyb20gdGhlIHRvcCBsZXZlbCBvZiB0aGUgcHJvamVjdC4KICAgICAgICBJZiB0aGUgc3RhcnQgZGlyZWN0b3J5IGlzIG5vdCB0aGUgdG9wIGxldmVsIGRpcmVjdG9yeSB0aGVuIHRoZSB0b3AKICAgICAgICBsZXZlbCBkaXJlY3RvcnkgbXVzdCBiZSBzcGVjaWZpZWQgc2VwYXJhdGVseS4KCiAgICAgICAgSWYgYSB0ZXN0IHBhY2thZ2UgbmFtZSAoZGlyZWN0b3J5IHdpdGggJ19faW5pdF9fLnB5JykgbWF0Y2hlcyB0aGUKICAgICAgICBwYXR0ZXJuIHRoZW4gdGhlIHBhY2thZ2Ugd2lsbCBiZSBjaGVja2VkIGZvciBhICdsb2FkX3Rlc3RzJyBmdW5jdGlvbi4gSWYKICAgICAgICB0aGlzIGV4aXN0cyB0aGVuIGl0IHdpbGwgYmUgY2FsbGVkIHdpdGggbG9hZGVyLCB0ZXN0cywgcGF0dGVybi4KCiAgICAgICAgSWYgbG9hZF90ZXN0cyBleGlzdHMgdGhlbiBkaXNjb3ZlcnkgZG9lcyAgKm5vdCogcmVjdXJzZSBpbnRvIHRoZSBwYWNrYWdlLAogICAgICAgIGxvYWRfdGVzdHMgaXMgcmVzcG9uc2libGUgZm9yIGxvYWRpbmcgYWxsIHRlc3RzIGluIHRoZSBwYWNrYWdlLgoKICAgICAgICBUaGUgcGF0dGVybiBpcyBkZWxpYmVyYXRlbHkgbm90IHN0b3JlZCBhcyBhIGxvYWRlciBhdHRyaWJ1dGUgc28gdGhhdAogICAgICAgIHBhY2thZ2VzIGNhbiBjb250aW51ZSBkaXNjb3ZlcnkgdGhlbXNlbHZlcy4gdG9wX2xldmVsX2RpciBpcyBzdG9yZWQgc28KICAgICAgICBsb2FkX3Rlc3RzIGRvZXMgbm90IG5lZWQgdG8gcGFzcyB0aGlzIGFyZ3VtZW50IGluIHRvIGxvYWRlci5kaXNjb3ZlcigpLgogICAgICAgICIiIgogICAgICAgIHNldF9pbXBsaWNpdF90b3AgPSBGYWxzZQogICAgICAgIGlmIHRvcF9sZXZlbF9kaXIgaXMgTm9uZSBhbmQgc2VsZi5fdG9wX2xldmVsX2RpciBpcyBub3QgTm9uZToKICAgICAgICAgICAgIyBtYWtlIHRvcF9sZXZlbF9kaXIgb3B0aW9uYWwgaWYgY2FsbGVkIGZyb20gbG9hZF90ZXN0cyBpbiBhIHBhY2thZ2UKICAgICAgICAgICAgdG9wX2xldmVsX2RpciA9IHNlbGYuX3RvcF9sZXZlbF9kaXIKICAgICAgICBlbGlmIHRvcF9sZXZlbF9kaXIgaXMgTm9uZToKICAgICAgICAgICAgc2V0X2ltcGxpY2l0X3RvcCA9IFRydWUKICAgICAgICAgICAgdG9wX2xldmVsX2RpciA9IHN0YXJ0X2RpcgoKICAgICAgICB0b3BfbGV2ZWxfZGlyID0gb3MucGF0aC5hYnNwYXRoKHRvcF9sZXZlbF9kaXIpCgogICAgICAgIGlmIG5vdCB0b3BfbGV2ZWxfZGlyIGluIHN5cy5wYXRoOgogICAgICAgICAgICAjIGFsbCB0ZXN0IG1vZHVsZXMgbXVzdCBiZSBpbXBvcnRhYmxlIGZyb20gdGhlIHRvcCBsZXZlbCBkaXJlY3RvcnkKICAgICAgICAgICAgIyBzaG91bGQgd2UgKnVuY29uZGl0aW9uYWxseSogcHV0IHRoZSBzdGFydCBkaXJlY3RvcnkgaW4gZmlyc3QKICAgICAgICAgICAgIyBpbiBzeXMucGF0aCB0byBtaW5pbWlzZSBsaWtlbGlob29kIG9mIGNvbmZsaWN0cyBiZXR3ZWVuIGluc3RhbGxlZAogICAgICAgICAgICAjIG1vZHVsZXMgYW5kIGRldmVsb3BtZW50IHZlcnNpb25zPwogICAgICAgICAgICBzeXMucGF0aC5pbnNlcnQoMCwgdG9wX2xldmVsX2RpcikKICAgICAgICBzZWxmLl90b3BfbGV2ZWxfZGlyID0gdG9wX2xldmVsX2RpcgoKICAgICAgICBpc19ub3RfaW1wb3J0YWJsZSA9IEZhbHNlCiAgICAgICAgaWYgb3MucGF0aC5pc2Rpcihvcy5wYXRoLmFic3BhdGgoc3RhcnRfZGlyKSk6CiAgICAgICAgICAgIHN0YXJ0X2RpciA9IG9zLnBhdGguYWJzcGF0aChzdGFydF9kaXIpCiAgICAgICAgICAgIGlmIHN0YXJ0X2RpciAhPSB0b3BfbGV2ZWxfZGlyOgogICAgICAgICAgICAgICAgaXNfbm90X2ltcG9ydGFibGUgPSBub3Qgb3MucGF0aC5pc2ZpbGUob3MucGF0aC5qb2luKHN0YXJ0X2RpciwgJ19faW5pdF9fLnB5JykpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyBzdXBwb3J0IGZvciBkaXNjb3ZlcnkgZnJvbSBkb3R0ZWQgbW9kdWxlIG5hbWVzCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIF9faW1wb3J0X18oc3RhcnRfZGlyKQogICAgICAgICAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgICAgICAgICBpc19ub3RfaW1wb3J0YWJsZSA9IFRydWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRoZV9tb2R1bGUgPSBzeXMubW9kdWxlc1tzdGFydF9kaXJdCiAgICAgICAgICAgICAgICB0b3BfcGFydCA9IHN0YXJ0X2Rpci5zcGxpdCgnLicpWzBdCiAgICAgICAgICAgICAgICBzdGFydF9kaXIgPSBvcy5wYXRoLmFic3BhdGgob3MucGF0aC5kaXJuYW1lKCh0aGVfbW9kdWxlLl9fZmlsZV9fKSkpCiAgICAgICAgICAgICAgICBpZiBzZXRfaW1wbGljaXRfdG9wOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX3RvcF9sZXZlbF9kaXIgPSBzZWxmLl9nZXRfZGlyZWN0b3J5X2NvbnRhaW5pbmdfbW9kdWxlKHRvcF9wYXJ0KQogICAgICAgICAgICAgICAgICAgIHN5cy5wYXRoLnJlbW92ZSh0b3BfbGV2ZWxfZGlyKQoKICAgICAgICBpZiBpc19ub3RfaW1wb3J0YWJsZToKICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IoJ1N0YXJ0IGRpcmVjdG9yeSBpcyBub3QgaW1wb3J0YWJsZTogJXInICUgc3RhcnRfZGlyKQoKICAgICAgICB0ZXN0cyA9IGxpc3Qoc2VsZi5fZmluZF90ZXN0cyhzdGFydF9kaXIsIHBhdHRlcm4pKQogICAgICAgIHJldHVybiBzZWxmLnN1aXRlQ2xhc3ModGVzdHMpCgogICAgZGVmIF9nZXRfZGlyZWN0b3J5X2NvbnRhaW5pbmdfbW9kdWxlKHNlbGYsIG1vZHVsZV9uYW1lKToKICAgICAgICBtb2R1bGUgPSBzeXMubW9kdWxlc1ttb2R1bGVfbmFtZV0KICAgICAgICBmdWxsX3BhdGggPSBvcy5wYXRoLmFic3BhdGgobW9kdWxlLl9fZmlsZV9fKQoKICAgICAgICBpZiBvcy5wYXRoLmJhc2VuYW1lKGZ1bGxfcGF0aCkubG93ZXIoKS5zdGFydHN3aXRoKCdfX2luaXRfXy5weScpOgogICAgICAgICAgICByZXR1cm4gb3MucGF0aC5kaXJuYW1lKG9zLnBhdGguZGlybmFtZShmdWxsX3BhdGgpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgaGVyZSB3ZSBoYXZlIGJlZW4gZ2l2ZW4gYSBtb2R1bGUgcmF0aGVyIHRoYW4gYSBwYWNrYWdlIC0gc28KICAgICAgICAgICAgIyBhbGwgd2UgY2FuIGRvIGlzIHNlYXJjaCB0aGUgKnNhbWUqIGRpcmVjdG9yeSB0aGUgbW9kdWxlIGlzIGluCiAgICAgICAgICAgICMgc2hvdWxkIGFuIGV4Y2VwdGlvbiBiZSByYWlzZWQgaW5zdGVhZAogICAgICAgICAgICByZXR1cm4gb3MucGF0aC5kaXJuYW1lKGZ1bGxfcGF0aCkKCiAgICBkZWYgX2dldF9uYW1lX2Zyb21fcGF0aChzZWxmLCBwYXRoKToKICAgICAgICBwYXRoID0gX2p5dGhvbl9hd2FyZV9zcGxpdGV4dChvcy5wYXRoLm5vcm1wYXRoKHBhdGgpKQoKICAgICAgICBfcmVscGF0aCA9IG9zLnBhdGgucmVscGF0aChwYXRoLCBzZWxmLl90b3BfbGV2ZWxfZGlyKQogICAgICAgIGFzc2VydCBub3Qgb3MucGF0aC5pc2FicyhfcmVscGF0aCksICJQYXRoIG11c3QgYmUgd2l0aGluIHRoZSBwcm9qZWN0IgogICAgICAgIGFzc2VydCBub3QgX3JlbHBhdGguc3RhcnRzd2l0aCgnLi4nKSwgIlBhdGggbXVzdCBiZSB3aXRoaW4gdGhlIHByb2plY3QiCgogICAgICAgIG5hbWUgPSBfcmVscGF0aC5yZXBsYWNlKG9zLnBhdGguc2VwLCAnLicpCiAgICAgICAgcmV0dXJuIG5hbWUKCiAgICBkZWYgX2dldF9tb2R1bGVfZnJvbV9uYW1lKHNlbGYsIG5hbWUpOgogICAgICAgIF9faW1wb3J0X18obmFtZSkKICAgICAgICByZXR1cm4gc3lzLm1vZHVsZXNbbmFtZV0KCiAgICBkZWYgX21hdGNoX3BhdGgoc2VsZiwgcGF0aCwgZnVsbF9wYXRoLCBwYXR0ZXJuKToKICAgICAgICAjIG92ZXJyaWRlIHRoaXMgbWV0aG9kIHRvIHVzZSBhbHRlcm5hdGl2ZSBtYXRjaGluZyBzdHJhdGVneQogICAgICAgIHJldHVybiBmbm1hdGNoKHBhdGgsIHBhdHRlcm4pCgogICAgZGVmIF9maW5kX3Rlc3RzKHNlbGYsIHN0YXJ0X2RpciwgcGF0dGVybik6CiAgICAgICAgIiIiVXNlZCBieSBkaXNjb3ZlcnkuIFlpZWxkcyB0ZXN0IHN1aXRlcyBpdCBsb2Fkcy4iIiIKICAgICAgICBwYXRocyA9IG9zLmxpc3RkaXIoc3RhcnRfZGlyKQoKICAgICAgICBmb3IgcGF0aCBpbiBwYXRoczoKICAgICAgICAgICAgZnVsbF9wYXRoID0gb3MucGF0aC5qb2luKHN0YXJ0X2RpciwgcGF0aCkKICAgICAgICAgICAgaWYgb3MucGF0aC5pc2ZpbGUoZnVsbF9wYXRoKToKICAgICAgICAgICAgICAgIGlmIG5vdCBWQUxJRF9NT0RVTEVfTkFNRS5tYXRjaChwYXRoKToKICAgICAgICAgICAgICAgICAgICAjIHZhbGlkIFB5dGhvbiBpZGVudGlmaWVycyBvbmx5CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIGlmIG5vdCBzZWxmLl9tYXRjaF9wYXRoKHBhdGgsIGZ1bGxfcGF0aCwgcGF0dGVybik6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICMgaWYgdGhlIHRlc3QgZmlsZSBtYXRjaGVzLCBsb2FkIGl0CiAgICAgICAgICAgICAgICBuYW1lID0gc2VsZi5fZ2V0X25hbWVfZnJvbV9wYXRoKGZ1bGxfcGF0aCkKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBtb2R1bGUgPSBzZWxmLl9nZXRfbW9kdWxlX2Zyb21fbmFtZShuYW1lKQogICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgIHlpZWxkIF9tYWtlX2ZhaWxlZF9pbXBvcnRfdGVzdChuYW1lLCBzZWxmLnN1aXRlQ2xhc3MpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIG1vZF9maWxlID0gb3MucGF0aC5hYnNwYXRoKGdldGF0dHIobW9kdWxlLCAnX19maWxlX18nLCBmdWxsX3BhdGgpKQogICAgICAgICAgICAgICAgICAgIHJlYWxwYXRoID0gX2p5dGhvbl9hd2FyZV9zcGxpdGV4dChtb2RfZmlsZSkKICAgICAgICAgICAgICAgICAgICBmdWxscGF0aF9ub2V4dCA9IF9qeXRob25fYXdhcmVfc3BsaXRleHQoZnVsbF9wYXRoKQogICAgICAgICAgICAgICAgICAgIGlmIHJlYWxwYXRoLmxvd2VyKCkgIT0gZnVsbHBhdGhfbm9leHQubG93ZXIoKToKICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlX2RpciA9IG9zLnBhdGguZGlybmFtZShyZWFscGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgbW9kX25hbWUgPSBfanl0aG9uX2F3YXJlX3NwbGl0ZXh0KG9zLnBhdGguYmFzZW5hbWUoZnVsbF9wYXRoKSkKICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWRfZGlyID0gb3MucGF0aC5kaXJuYW1lKGZ1bGxfcGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgbXNnID0gKCIlciBtb2R1bGUgaW5jb3JyZWN0bHkgaW1wb3J0ZWQgZnJvbSAlci4gRXhwZWN0ZWQgJXIuICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJcyB0aGlzIG1vZHVsZSBnbG9iYWxseSBpbnN0YWxsZWQ/IikKICAgICAgICAgICAgICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IobXNnICUgKG1vZF9uYW1lLCBtb2R1bGVfZGlyLCBleHBlY3RlZF9kaXIpKQogICAgICAgICAgICAgICAgICAgIHlpZWxkIHNlbGYubG9hZFRlc3RzRnJvbU1vZHVsZShtb2R1bGUpCiAgICAgICAgICAgIGVsaWYgb3MucGF0aC5pc2RpcihmdWxsX3BhdGgpOgogICAgICAgICAgICAgICAgaWYgbm90IG9zLnBhdGguaXNmaWxlKG9zLnBhdGguam9pbihmdWxsX3BhdGgsICdfX2luaXRfXy5weScpKToKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgICAgIGxvYWRfdGVzdHMgPSBOb25lCiAgICAgICAgICAgICAgICB0ZXN0cyA9IE5vbmUKICAgICAgICAgICAgICAgIGlmIGZubWF0Y2gocGF0aCwgcGF0dGVybik6CiAgICAgICAgICAgICAgICAgICAgIyBvbmx5IGNoZWNrIGxvYWRfdGVzdHMgaWYgdGhlIHBhY2thZ2UgZGlyZWN0b3J5IGl0c2VsZiBtYXRjaGVzIHRoZSBmaWx0ZXIKICAgICAgICAgICAgICAgICAgICBuYW1lID0gc2VsZi5fZ2V0X25hbWVfZnJvbV9wYXRoKGZ1bGxfcGF0aCkKICAgICAgICAgICAgICAgICAgICBwYWNrYWdlID0gc2VsZi5fZ2V0X21vZHVsZV9mcm9tX25hbWUobmFtZSkKICAgICAgICAgICAgICAgICAgICBsb2FkX3Rlc3RzID0gZ2V0YXR0cihwYWNrYWdlLCAnbG9hZF90ZXN0cycsIE5vbmUpCiAgICAgICAgICAgICAgICAgICAgdGVzdHMgPSBzZWxmLmxvYWRUZXN0c0Zyb21Nb2R1bGUocGFja2FnZSwgdXNlX2xvYWRfdGVzdHM9RmFsc2UpCgogICAgICAgICAgICAgICAgaWYgbG9hZF90ZXN0cyBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgIGlmIHRlc3RzIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICAjIHRlc3RzIGxvYWRlZCBmcm9tIHBhY2thZ2UgZmlsZQogICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0ZXN0cwogICAgICAgICAgICAgICAgICAgICMgcmVjdXJzZSBpbnRvIHRoZSBwYWNrYWdlCiAgICAgICAgICAgICAgICAgICAgZm9yIHRlc3QgaW4gc2VsZi5fZmluZF90ZXN0cyhmdWxsX3BhdGgsIHBhdHRlcm4pOgogICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0ZXN0CiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgbG9hZF90ZXN0cyhzZWxmLCB0ZXN0cywgcGF0dGVybikKICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIF9tYWtlX2ZhaWxlZF9sb2FkX3Rlc3RzKHBhY2thZ2UuX19uYW1lX18sIGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc3VpdGVDbGFzcykKCmRlZmF1bHRUZXN0TG9hZGVyID0gVGVzdExvYWRlcigpCgoKZGVmIF9tYWtlTG9hZGVyKHByZWZpeCwgc29ydFVzaW5nLCBzdWl0ZUNsYXNzPU5vbmUpOgogICAgbG9hZGVyID0gVGVzdExvYWRlcigpCiAgICBsb2FkZXIuc29ydFRlc3RNZXRob2RzVXNpbmcgPSBzb3J0VXNpbmcKICAgIGxvYWRlci50ZXN0TWV0aG9kUHJlZml4ID0gcHJlZml4CiAgICBpZiBzdWl0ZUNsYXNzOgogICAgICAgIGxvYWRlci5zdWl0ZUNsYXNzID0gc3VpdGVDbGFzcwogICAgcmV0dXJuIGxvYWRlcgoKZGVmIGdldFRlc3RDYXNlTmFtZXModGVzdENhc2VDbGFzcywgcHJlZml4LCBzb3J0VXNpbmc9dXRpbC50aHJlZV93YXlfY21wKToKICAgIHJldHVybiBfbWFrZUxvYWRlcihwcmVmaXgsIHNvcnRVc2luZykuZ2V0VGVzdENhc2VOYW1lcyh0ZXN0Q2FzZUNsYXNzKQoKZGVmIG1ha2VTdWl0ZSh0ZXN0Q2FzZUNsYXNzLCBwcmVmaXg9J3Rlc3QnLCBzb3J0VXNpbmc9dXRpbC50aHJlZV93YXlfY21wLAogICAgICAgICAgICAgIHN1aXRlQ2xhc3M9c3VpdGUuVGVzdFN1aXRlKToKICAgIHJldHVybiBfbWFrZUxvYWRlcihwcmVmaXgsIHNvcnRVc2luZywgc3VpdGVDbGFzcykubG9hZFRlc3RzRnJvbVRlc3RDYXNlKAogICAgICAgIHRlc3RDYXNlQ2xhc3MpCgpkZWYgZmluZFRlc3RDYXNlcyhtb2R1bGUsIHByZWZpeD0ndGVzdCcsIHNvcnRVc2luZz11dGlsLnRocmVlX3dheV9jbXAsCiAgICAgICAgICAgICAgICAgIHN1aXRlQ2xhc3M9c3VpdGUuVGVzdFN1aXRlKToKICAgIHJldHVybiBfbWFrZUxvYWRlcihwcmVmaXgsIHNvcnRVc2luZywgc3VpdGVDbGFzcykubG9hZFRlc3RzRnJvbU1vZHVsZShcCiAgICAgICAgbW9kdWxlKQo=',
'/Lib/unittest/main.py':'IiIiVW5pdHRlc3QgbWFpbiBwcm9ncmFtIiIiCgppbXBvcnQgc3lzCmltcG9ydCBvcHRwYXJzZQppbXBvcnQgb3MKCmZyb20gLiBpbXBvcnQgbG9hZGVyLCBydW5uZXIKZnJvbSAuc2lnbmFscyBpbXBvcnQgaW5zdGFsbEhhbmRsZXIKCl9fdW5pdHRlc3QgPSBUcnVlCgpGQUlMRkFTVCAgICAgPSAiICAtZiwgLS1mYWlsZmFzdCAgIFN0b3Agb24gZmlyc3QgZmFpbHVyZVxuIgpDQVRDSEJSRUFLICAgPSAiICAtYywgLS1jYXRjaCAgICAgIENhdGNoIGNvbnRyb2wtQyBhbmQgZGlzcGxheSByZXN1bHRzXG4iCkJVRkZFUk9VVFBVVCA9ICIgIC1iLCAtLWJ1ZmZlciAgICAgQnVmZmVyIHN0ZG91dCBhbmQgc3RkZXJyIGR1cmluZyB0ZXN0IHJ1bnNcbiIKClVTQUdFX0FTX01BSU4gPSAiIiJcClVzYWdlOiAlKHByb2dOYW1lKXMgW29wdGlvbnNdIFt0ZXN0c10KCk9wdGlvbnM6CiAgLWgsIC0taGVscCAgICAgICBTaG93IHRoaXMgbWVzc2FnZQogIC12LCAtLXZlcmJvc2UgICAgVmVyYm9zZSBvdXRwdXQKICAtcSwgLS1xdWlldCAgICAgIE1pbmltYWwgb3V0cHV0CiUoZmFpbGZhc3QpcyUoY2F0Y2hicmVhaylzJShidWZmZXIpcwpFeGFtcGxlczoKICAlKHByb2dOYW1lKXMgdGVzdF9tb2R1bGUgICAgICAgICAgICAgICAtIHJ1biB0ZXN0cyBmcm9tIHRlc3RfbW9kdWxlCiAgJShwcm9nTmFtZSlzIG1vZHVsZS5UZXN0Q2xhc3MgICAgICAgICAgLSBydW4gdGVzdHMgZnJvbSBtb2R1bGUuVGVzdENsYXNzCiAgJShwcm9nTmFtZSlzIG1vZHVsZS5DbGFzcy50ZXN0X21ldGhvZCAgLSBydW4gc3BlY2lmaWVkIHRlc3QgbWV0aG9kCgpbdGVzdHNdIGNhbiBiZSBhIGxpc3Qgb2YgYW55IG51bWJlciBvZiB0ZXN0IG1vZHVsZXMsIGNsYXNzZXMgYW5kIHRlc3QKbWV0aG9kcy4KCkFsdGVybmF0aXZlIFVzYWdlOiAlKHByb2dOYW1lKXMgZGlzY292ZXIgW29wdGlvbnNdCgpPcHRpb25zOgogIC12LCAtLXZlcmJvc2UgICAgVmVyYm9zZSBvdXRwdXQKJShmYWlsZmFzdClzJShjYXRjaGJyZWFrKXMlKGJ1ZmZlcilzICAtcyBkaXJlY3RvcnkgICAgIERpcmVjdG9yeSB0byBzdGFydCBkaXNjb3ZlcnkgKCcuJyBkZWZhdWx0KQogIC1wIHBhdHRlcm4gICAgICAgUGF0dGVybiB0byBtYXRjaCB0ZXN0IGZpbGVzICgndGVzdCoucHknIGRlZmF1bHQpCiAgLXQgZGlyZWN0b3J5ICAgICBUb3AgbGV2ZWwgZGlyZWN0b3J5IG9mIHByb2plY3QgKGRlZmF1bHQgdG8KICAgICAgICAgICAgICAgICAgIHN0YXJ0IGRpcmVjdG9yeSkKCkZvciB0ZXN0IGRpc2NvdmVyeSBhbGwgdGVzdCBtb2R1bGVzIG11c3QgYmUgaW1wb3J0YWJsZSBmcm9tIHRoZSB0b3AKbGV2ZWwgZGlyZWN0b3J5IG9mIHRoZSBwcm9qZWN0LgoiIiIKClVTQUdFX0ZST01fTU9EVUxFID0gIiIiXApVc2FnZTogJShwcm9nTmFtZSlzIFtvcHRpb25zXSBbdGVzdF0gWy4uLl0KCk9wdGlvbnM6CiAgLWgsIC0taGVscCAgICAgICBTaG93IHRoaXMgbWVzc2FnZQogIC12LCAtLXZlcmJvc2UgICAgVmVyYm9zZSBvdXRwdXQKICAtcSwgLS1xdWlldCAgICAgIE1pbmltYWwgb3V0cHV0CiUoZmFpbGZhc3QpcyUoY2F0Y2hicmVhaylzJShidWZmZXIpcwpFeGFtcGxlczoKICAlKHByb2dOYW1lKXMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBydW4gZGVmYXVsdCBzZXQgb2YgdGVzdHMKICAlKHByb2dOYW1lKXMgTXlUZXN0U3VpdGUgICAgICAgICAgICAgICAgICAgLSBydW4gc3VpdGUgJ015VGVzdFN1aXRlJwogICUocHJvZ05hbWUpcyBNeVRlc3RDYXNlLnRlc3RTb21ldGhpbmcgICAgICAtIHJ1biBNeVRlc3RDYXNlLnRlc3RTb21ldGhpbmcKICAlKHByb2dOYW1lKXMgTXlUZXN0Q2FzZSAgICAgICAgICAgICAgICAgICAgLSBydW4gYWxsICd0ZXN0KicgdGVzdCBtZXRob2RzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW4gTXlUZXN0Q2FzZQoiIiIKCmRlZiBfY29udmVydF9uYW1lKG5hbWUpOgogICAgIyBvbiBMaW51eCAvIE1hYyBPUyBYICdmb28uUFknIGlzIG5vdCBpbXBvcnRhYmxlLCBidXQgb24KICAgICMgV2luZG93cyBpdCBpcy4gU2ltcGxlciB0byBkbyBhIGNhc2UgaW5zZW5zaXRpdmUgbWF0Y2gKICAgICMgYSBiZXR0ZXIgY2hlY2sgd291bGQgYmUgdG8gY2hlY2sgdGhhdCB0aGUgbmFtZSBpcyBhCiAgICAjIHZhbGlkIFB5dGhvbiBtb2R1bGUgbmFtZS4KICAgIGlmIG9zLnBhdGguaXNmaWxlKG5hbWUpIGFuZCBuYW1lLmxvd2VyKCkuZW5kc3dpdGgoJy5weScpOgogICAgICAgIGlmIG9zLnBhdGguaXNhYnMobmFtZSk6CiAgICAgICAgICAgIHJlbF9wYXRoID0gb3MucGF0aC5yZWxwYXRoKG5hbWUsIG9zLmdldGN3ZCgpKQogICAgICAgICAgICBpZiBvcy5wYXRoLmlzYWJzKHJlbF9wYXRoKSBvciByZWxfcGF0aC5zdGFydHN3aXRoKG9zLnBhcmRpcik6CiAgICAgICAgICAgICAgICByZXR1cm4gbmFtZQogICAgICAgICAgICBuYW1lID0gcmVsX3BhdGgKICAgICAgICAjIG9uIFdpbmRvd3MgYm90aCAnXCcgYW5kICcvJyBhcmUgdXNlZCBhcyBwYXRoCiAgICAgICAgIyBzZXBhcmF0b3JzLiBCZXR0ZXIgdG8gcmVwbGFjZSBib3RoIHRoYW4gcmVseSBvbiBvcy5wYXRoLnNlcAogICAgICAgIHJldHVybiBuYW1lWzotM10ucmVwbGFjZSgnXFwnLCAnLicpLnJlcGxhY2UoJy8nLCAnLicpCiAgICByZXR1cm4gbmFtZQoKZGVmIF9jb252ZXJ0X25hbWVzKG5hbWVzKToKICAgIHJldHVybiBbX2NvbnZlcnRfbmFtZShuYW1lKSBmb3IgbmFtZSBpbiBuYW1lc10KCgpjbGFzcyBUZXN0UHJvZ3JhbShvYmplY3QpOgogICAgIiIiQSBjb21tYW5kLWxpbmUgcHJvZ3JhbSB0aGF0IHJ1bnMgYSBzZXQgb2YgdGVzdHM7IHRoaXMgaXMgcHJpbWFyaWx5CiAgICAgICBmb3IgbWFraW5nIHRlc3QgbW9kdWxlcyBjb252ZW5pZW50bHkgZXhlY3V0YWJsZS4KICAgICIiIgogICAgVVNBR0UgPSBVU0FHRV9GUk9NX01PRFVMRQoKICAgICMgZGVmYXVsdHMgZm9yIHRlc3RpbmcKICAgIGZhaWxmYXN0ID0gY2F0Y2hicmVhayA9IGJ1ZmZlciA9IHByb2dOYW1lID0gd2FybmluZ3MgPSBOb25lCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG1vZHVsZT0nX19tYWluX18nLCBkZWZhdWx0VGVzdD1Ob25lLCBhcmd2PU5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGVzdFJ1bm5lcj1Ob25lLCB0ZXN0TG9hZGVyPWxvYWRlci5kZWZhdWx0VGVzdExvYWRlciwKICAgICAgICAgICAgICAgICAgICBleGl0PVRydWUsIHZlcmJvc2l0eT0xLCBmYWlsZmFzdD1Ob25lLCBjYXRjaGJyZWFrPU5vbmUsCiAgICAgICAgICAgICAgICAgICAgYnVmZmVyPU5vbmUsIHdhcm5pbmdzPU5vbmUpOgogICAgICAgIGlmIGlzaW5zdGFuY2UobW9kdWxlLCBzdHIpOgogICAgICAgICAgICBzZWxmLm1vZHVsZSA9IF9faW1wb3J0X18obW9kdWxlKQogICAgICAgICAgICBmb3IgcGFydCBpbiBtb2R1bGUuc3BsaXQoJy4nKVsxOl06CiAgICAgICAgICAgICAgICBzZWxmLm1vZHVsZSA9IGdldGF0dHIoc2VsZi5tb2R1bGUsIHBhcnQpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5tb2R1bGUgPSBtb2R1bGUKICAgICAgICBpZiBhcmd2IGlzIE5vbmU6CiAgICAgICAgICAgIGFyZ3YgPSBzeXMuYXJndgoKICAgICAgICBzZWxmLmV4aXQgPSBleGl0CiAgICAgICAgc2VsZi5mYWlsZmFzdCA9IGZhaWxmYXN0CiAgICAgICAgc2VsZi5jYXRjaGJyZWFrID0gY2F0Y2hicmVhawogICAgICAgIHNlbGYudmVyYm9zaXR5ID0gdmVyYm9zaXR5CiAgICAgICAgc2VsZi5idWZmZXIgPSBidWZmZXIKICAgICAgICBpZiB3YXJuaW5ncyBpcyBOb25lIGFuZCBub3Qgc3lzLndhcm5vcHRpb25zOgogICAgICAgICAgICAjIGV2ZW4gaWYgRHJlcHJlY2F0aW9uV2FybmluZ3MgYXJlIGlnbm9yZWQgYnkgZGVmYXVsdAogICAgICAgICAgICAjIHByaW50IHRoZW0gYW55d2F5IHVubGVzcyBvdGhlciB3YXJuaW5ncyBzZXR0aW5ncyBhcmUKICAgICAgICAgICAgIyBzcGVjaWZpZWQgYnkgdGhlIHdhcm5pbmdzIGFyZyBvciB0aGUgLVcgcHl0aG9uIGZsYWcKICAgICAgICAgICAgc2VsZi53YXJuaW5ncyA9ICdkZWZhdWx0JwogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgaGVyZSBzZWxmLndhcm5pbmdzIGlzIHNldCBlaXRoZXIgdG8gdGhlIHZhbHVlIHBhc3NlZAogICAgICAgICAgICAjIHRvIHRoZSB3YXJuaW5ncyBhcmdzIG9yIHRvIE5vbmUuCiAgICAgICAgICAgICMgSWYgdGhlIHVzZXIgZGlkbid0IHBhc3MgYSB2YWx1ZSBzZWxmLndhcm5pbmdzIHdpbGwKICAgICAgICAgICAgIyBiZSBOb25lLiBUaGlzIG1lYW5zIHRoYXQgdGhlIGJlaGF2aW9yIGlzIHVuY2hhbmdlZAogICAgICAgICAgICAjIGFuZCBkZXBlbmRzIG9uIHRoZSB2YWx1ZXMgcGFzc2VkIHRvIC1XLgogICAgICAgICAgICBzZWxmLndhcm5pbmdzID0gd2FybmluZ3MKICAgICAgICBzZWxmLmRlZmF1bHRUZXN0ID0gZGVmYXVsdFRlc3QKICAgICAgICBzZWxmLnRlc3RSdW5uZXIgPSB0ZXN0UnVubmVyCiAgICAgICAgc2VsZi50ZXN0TG9hZGVyID0gdGVzdExvYWRlcgogICAgICAgIHNlbGYucHJvZ05hbWUgPSBvcy5wYXRoLmJhc2VuYW1lKGFyZ3ZbMF0pCiAgICAgICAgc2VsZi5wYXJzZUFyZ3MoYXJndikKICAgICAgICBzZWxmLnJ1blRlc3RzKCkKCiAgICBkZWYgdXNhZ2VFeGl0KHNlbGYsIG1zZz1Ob25lKToKICAgICAgICBpZiBtc2c6CiAgICAgICAgICAgIHByaW50KG1zZykKICAgICAgICB1c2FnZSA9IHsncHJvZ05hbWUnOiBzZWxmLnByb2dOYW1lLCAnY2F0Y2hicmVhayc6ICcnLCAnZmFpbGZhc3QnOiAnJywKICAgICAgICAgICAgICAgICAnYnVmZmVyJzogJyd9CiAgICAgICAgaWYgc2VsZi5mYWlsZmFzdCAhPSBGYWxzZToKICAgICAgICAgICAgdXNhZ2VbJ2ZhaWxmYXN0J10gPSBGQUlMRkFTVAogICAgICAgIGlmIHNlbGYuY2F0Y2hicmVhayAhPSBGYWxzZToKICAgICAgICAgICAgdXNhZ2VbJ2NhdGNoYnJlYWsnXSA9IENBVENIQlJFQUsKICAgICAgICBpZiBzZWxmLmJ1ZmZlciAhPSBGYWxzZToKICAgICAgICAgICAgdXNhZ2VbJ2J1ZmZlciddID0gQlVGRkVST1VUUFVUCiAgICAgICAgcHJpbnQoc2VsZi5VU0FHRSAlIHVzYWdlKQogICAgICAgIHN5cy5leGl0KDIpCgogICAgZGVmIHBhcnNlQXJncyhzZWxmLCBhcmd2KToKICAgICAgICBpZiAoKGxlbihhcmd2KSA+IDEgYW5kIGFyZ3ZbMV0ubG93ZXIoKSA9PSAnZGlzY292ZXInKSBvcgogICAgICAgICAgICAobGVuKGFyZ3YpID09IDEgYW5kIHNlbGYubW9kdWxlIGlzIE5vbmUpKToKICAgICAgICAgICAgc2VsZi5fZG9fZGlzY292ZXJ5KGFyZ3ZbMjpdKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgcGFyc2VyID0gc2VsZi5fZ2V0T3B0UGFyc2VyKCkKICAgICAgICBvcHRpb25zLCBhcmdzID0gcGFyc2VyLnBhcnNlX2FyZ3MoYXJndlsxOl0pCiAgICAgICAgc2VsZi5fc2V0QXR0cmlidXRlc0Zyb21PcHRpb25zKG9wdGlvbnMpCgogICAgICAgIGlmIGxlbihhcmdzKSA9PSAwIGFuZCBzZWxmLm1vZHVsZSBpcyBOb25lOgogICAgICAgICAgICAjIHRoaXMgYWxsb3dzICJweXRob24gLW0gdW5pdHRlc3QgLXYiIHRvIHN0aWxsIHdvcmsgZm9yCiAgICAgICAgICAgICMgdGVzdCBkaXNjb3ZlcnkuIFRoaXMgbWVhbnMgLWMgLyAtYiAvIC12IC8gLWYgb3B0aW9ucyB3aWxsCiAgICAgICAgICAgICMgYmUgaGFuZGxlZCB0d2ljZSwgd2hpY2ggaXMgaGFybWxlc3MgYnV0IG5vdCBpZGVhbC4KICAgICAgICAgICAgc2VsZi5fZG9fZGlzY292ZXJ5KGFyZ3ZbMTpdKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgbGVuKGFyZ3MpID09IDAgYW5kIHNlbGYuZGVmYXVsdFRlc3QgaXMgTm9uZToKICAgICAgICAgICAgIyBjcmVhdGVUZXN0cyB3aWxsIGxvYWQgdGVzdHMgZnJvbSBzZWxmLm1vZHVsZQogICAgICAgICAgICBzZWxmLnRlc3ROYW1lcyA9IE5vbmUKICAgICAgICBlbGlmIGxlbihhcmdzKSA+IDA6CiAgICAgICAgICAgIHNlbGYudGVzdE5hbWVzID0gX2NvbnZlcnRfbmFtZXMoYXJncykKICAgICAgICAgICAgaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgICAgICAgICAgICAgICMgdG8gc3VwcG9ydCBweXRob24gLW0gdW5pdHRlc3QgLi4uCiAgICAgICAgICAgICAgICBzZWxmLm1vZHVsZSA9IE5vbmUKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnRlc3ROYW1lcyA9IChzZWxmLmRlZmF1bHRUZXN0LCkKICAgICAgICBzZWxmLmNyZWF0ZVRlc3RzKCkKCiAgICBkZWYgY3JlYXRlVGVzdHMoc2VsZik6CiAgICAgICAgaWYgc2VsZi50ZXN0TmFtZXMgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi50ZXN0ID0gc2VsZi50ZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb21Nb2R1bGUoc2VsZi5tb2R1bGUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi50ZXN0ID0gc2VsZi50ZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhzZWxmLnRlc3ROYW1lcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm1vZHVsZSkKCiAgICBkZWYgX2dldE9wdFBhcnNlcihzZWxmKToKICAgICAgICBwYXJzZXIgPSBvcHRwYXJzZS5PcHRpb25QYXJzZXIoKQogICAgICAgIHBhcnNlci5wcm9nID0gc2VsZi5wcm9nTmFtZQogICAgICAgIHBhcnNlci5hZGRfb3B0aW9uKCctdicsICctLXZlcmJvc2UnLCBkZXN0PSd2ZXJib3NlJywgZGVmYXVsdD1GYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSdWZXJib3NlIG91dHB1dCcsIGFjdGlvbj0nc3RvcmVfdHJ1ZScpCiAgICAgICAgcGFyc2VyLmFkZF9vcHRpb24oJy1xJywgJy0tcXVpZXQnLCBkZXN0PSdxdWlldCcsIGRlZmF1bHQ9RmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscD0nUXVpZXQgb3V0cHV0JywgYWN0aW9uPSdzdG9yZV90cnVlJykKCiAgICAgICAgaWYgc2VsZi5mYWlsZmFzdCAhPSBGYWxzZToKICAgICAgICAgICAgcGFyc2VyLmFkZF9vcHRpb24oJy1mJywgJy0tZmFpbGZhc3QnLCBkZXN0PSdmYWlsZmFzdCcsIGRlZmF1bHQ9RmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlbHA9J1N0b3Agb24gZmlyc3QgZmFpbCBvciBlcnJvcicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbj0nc3RvcmVfdHJ1ZScpCiAgICAgICAgaWYgc2VsZi5jYXRjaGJyZWFrICE9IEZhbHNlOgogICAgICAgICAgICBwYXJzZXIuYWRkX29wdGlvbignLWMnLCAnLS1jYXRjaCcsIGRlc3Q9J2NhdGNoYnJlYWsnLCBkZWZhdWx0PUZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSdDYXRjaCBjdHJsLUMgYW5kIGRpc3BsYXkgcmVzdWx0cyBzbyBmYXInLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb249J3N0b3JlX3RydWUnKQogICAgICAgIGlmIHNlbGYuYnVmZmVyICE9IEZhbHNlOgogICAgICAgICAgICBwYXJzZXIuYWRkX29wdGlvbignLWInLCAnLS1idWZmZXInLCBkZXN0PSdidWZmZXInLCBkZWZhdWx0PUZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSdCdWZmZXIgc3Rkb3V0IGFuZCBzdGRlcnIgZHVyaW5nIHRlc3RzJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uPSdzdG9yZV90cnVlJykKICAgICAgICByZXR1cm4gcGFyc2VyCgogICAgZGVmIF9zZXRBdHRyaWJ1dGVzRnJvbU9wdGlvbnMoc2VsZiwgb3B0aW9ucyk6CiAgICAgICAgIyBvbmx5IHNldCBvcHRpb25zIGZyb20gdGhlIHBhcnNpbmcgaGVyZQogICAgICAgICMgaWYgdGhleSB3ZXJlbid0IHNldCBleHBsaWNpdGx5IGluIHRoZSBjb25zdHJ1Y3RvcgogICAgICAgIGlmIHNlbGYuZmFpbGZhc3QgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5mYWlsZmFzdCA9IG9wdGlvbnMuZmFpbGZhc3QKICAgICAgICBpZiBzZWxmLmNhdGNoYnJlYWsgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5jYXRjaGJyZWFrID0gb3B0aW9ucy5jYXRjaGJyZWFrCiAgICAgICAgaWYgc2VsZi5idWZmZXIgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5idWZmZXIgPSBvcHRpb25zLmJ1ZmZlcgoKICAgICAgICBpZiBvcHRpb25zLnZlcmJvc2U6CiAgICAgICAgICAgIHNlbGYudmVyYm9zaXR5ID0gMgogICAgICAgIGVsaWYgb3B0aW9ucy5xdWlldDoKICAgICAgICAgICAgc2VsZi52ZXJib3NpdHkgPSAwCgogICAgZGVmIF9hZGREaXNjb3ZlcnlPcHRpb25zKHNlbGYsIHBhcnNlcik6CiAgICAgICAgcGFyc2VyLmFkZF9vcHRpb24oJy1zJywgJy0tc3RhcnQtZGlyZWN0b3J5JywgZGVzdD0nc3RhcnQnLCBkZWZhdWx0PScuJywKICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSJEaXJlY3RvcnkgdG8gc3RhcnQgZGlzY292ZXJ5ICgnLicgZGVmYXVsdCkiKQogICAgICAgIHBhcnNlci5hZGRfb3B0aW9uKCctcCcsICctLXBhdHRlcm4nLCBkZXN0PSdwYXR0ZXJuJywgZGVmYXVsdD0ndGVzdCoucHknLAogICAgICAgICAgICAgICAgICAgICAgICAgIGhlbHA9IlBhdHRlcm4gdG8gbWF0Y2ggdGVzdHMgKCd0ZXN0Ki5weScgZGVmYXVsdCkiKQogICAgICAgIHBhcnNlci5hZGRfb3B0aW9uKCctdCcsICctLXRvcC1sZXZlbC1kaXJlY3RvcnknLCBkZXN0PSd0b3AnLCBkZWZhdWx0PU5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscD0nVG9wIGxldmVsIGRpcmVjdG9yeSBvZiBwcm9qZWN0IChkZWZhdWx0cyB0byBzdGFydCBkaXJlY3RvcnkpJykKCiAgICBkZWYgX2RvX2Rpc2NvdmVyeShzZWxmLCBhcmd2LCBMb2FkZXI9bG9hZGVyLlRlc3RMb2FkZXIpOgogICAgICAgICMgaGFuZGxlIGNvbW1hbmQgbGluZSBhcmdzIGZvciB0ZXN0IGRpc2NvdmVyeQogICAgICAgIHNlbGYucHJvZ05hbWUgPSAnJXMgZGlzY292ZXInICUgc2VsZi5wcm9nTmFtZQogICAgICAgIHBhcnNlciA9IHNlbGYuX2dldE9wdFBhcnNlcigpCiAgICAgICAgc2VsZi5fYWRkRGlzY292ZXJ5T3B0aW9ucyhwYXJzZXIpCgogICAgICAgIG9wdGlvbnMsIGFyZ3MgPSBwYXJzZXIucGFyc2VfYXJncyhhcmd2KQogICAgICAgIGlmIGxlbihhcmdzKSA+IDM6CiAgICAgICAgICAgIHNlbGYudXNhZ2VFeGl0KCkKCiAgICAgICAgZm9yIG5hbWUsIHZhbHVlIGluIHppcCgoJ3N0YXJ0JywgJ3BhdHRlcm4nLCAndG9wJyksIGFyZ3MpOgogICAgICAgICAgICBzZXRhdHRyKG9wdGlvbnMsIG5hbWUsIHZhbHVlKQoKICAgICAgICBzZWxmLl9zZXRBdHRyaWJ1dGVzRnJvbU9wdGlvbnMob3B0aW9ucykKCiAgICAgICAgc3RhcnRfZGlyID0gb3B0aW9ucy5zdGFydAogICAgICAgIHBhdHRlcm4gPSBvcHRpb25zLnBhdHRlcm4KICAgICAgICB0b3BfbGV2ZWxfZGlyID0gb3B0aW9ucy50b3AKCiAgICAgICAgbG9hZGVyID0gTG9hZGVyKCkKICAgICAgICBzZWxmLnRlc3QgPSBsb2FkZXIuZGlzY292ZXIoc3RhcnRfZGlyLCBwYXR0ZXJuLCB0b3BfbGV2ZWxfZGlyKQoKICAgIGRlZiBydW5UZXN0cyhzZWxmKToKICAgICAgICBpZiBzZWxmLmNhdGNoYnJlYWs6CiAgICAgICAgICAgIGluc3RhbGxIYW5kbGVyKCkKICAgICAgICBpZiBzZWxmLnRlc3RSdW5uZXIgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi50ZXN0UnVubmVyID0gcnVubmVyLlRleHRUZXN0UnVubmVyCiAgICAgICAgaWYgaXNpbnN0YW5jZShzZWxmLnRlc3RSdW5uZXIsIHR5cGUpOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB0ZXN0UnVubmVyID0gc2VsZi50ZXN0UnVubmVyKHZlcmJvc2l0eT1zZWxmLnZlcmJvc2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFpbGZhc3Q9c2VsZi5mYWlsZmFzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVmZmVyPXNlbGYuYnVmZmVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXJuaW5ncz1zZWxmLndhcm5pbmdzKQogICAgICAgICAgICBleGNlcHQgVHlwZUVycm9yOgogICAgICAgICAgICAgICAgIyBkaWRuJ3QgYWNjZXB0IHRoZSB2ZXJib3NpdHksIGJ1ZmZlciBvciBmYWlsZmFzdCBhcmd1bWVudHMKICAgICAgICAgICAgICAgIHRlc3RSdW5uZXIgPSBzZWxmLnRlc3RSdW5uZXIoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgaXQgaXMgYXNzdW1lZCB0byBiZSBhIFRlc3RSdW5uZXIgaW5zdGFuY2UKICAgICAgICAgICAgdGVzdFJ1bm5lciA9IHNlbGYudGVzdFJ1bm5lcgogICAgICAgIHNlbGYucmVzdWx0ID0gdGVzdFJ1bm5lci5ydW4oc2VsZi50ZXN0KQogICAgICAgIGlmIHNlbGYuZXhpdDoKICAgICAgICAgICAgc3lzLmV4aXQobm90IHNlbGYucmVzdWx0Lndhc1N1Y2Nlc3NmdWwoKSkKCm1haW4gPSBUZXN0UHJvZ3JhbQo=',
'/Lib/unittest/mock.py':'IyBtb2NrLnB5CiMgVGVzdCB0b29scyBmb3IgbW9ja2luZyBhbmQgcGF0Y2hpbmcuCiMgTWFpbnRhaW5lZCBieSBNaWNoYWVsIEZvb3JkCiMgQmFja3BvcnQgZm9yIG90aGVyIHZlcnNpb25zIG9mIFB5dGhvbiBhdmFpbGFibGUgZnJvbQojIGh0dHA6Ly9weXBpLnB5dGhvbi5vcmcvcHlwaS9tb2NrCgpfX2FsbF9fID0gKAogICAgJ01vY2snLAogICAgJ01hZ2ljTW9jaycsCiAgICAncGF0Y2gnLAogICAgJ3NlbnRpbmVsJywKICAgICdERUZBVUxUJywKICAgICdBTlknLAogICAgJ2NhbGwnLAogICAgJ2NyZWF0ZV9hdXRvc3BlYycsCiAgICAnRklMVEVSX0RJUicsCiAgICAnTm9uQ2FsbGFibGVNb2NrJywKICAgICdOb25DYWxsYWJsZU1hZ2ljTW9jaycsCiAgICAnbW9ja19vcGVuJywKICAgICdQcm9wZXJ0eU1vY2snLAopCgoKX192ZXJzaW9uX18gPSAnMS4wJwoKCmltcG9ydCBpbnNwZWN0CmltcG9ydCBwcHJpbnQKaW1wb3J0IHN5cwpmcm9tIGZ1bmN0b29scyBpbXBvcnQgd3JhcHMKCgpCYXNlRXhjZXB0aW9ucyA9IChCYXNlRXhjZXB0aW9uLCkKaWYgJ2phdmEnIGluIHN5cy5wbGF0Zm9ybToKICAgICMganl0aG9uCiAgICBpbXBvcnQgamF2YQogICAgQmFzZUV4Y2VwdGlvbnMgPSAoQmFzZUV4Y2VwdGlvbiwgamF2YS5sYW5nLlRocm93YWJsZSkKCgpGSUxURVJfRElSID0gVHJ1ZQoKIyBXb3JrYXJvdW5kIGZvciBpc3N1ZSAjMTIzNzAKIyBXaXRob3V0IHRoaXMsIHRoZSBfX2NsYXNzX18gcHJvcGVydGllcyB3b3VsZG4ndCBiZSBzZXQgY29ycmVjdGx5Cl9zYWZlX3N1cGVyID0gc3VwZXIKCmRlZiBfaXNfaW5zdGFuY2VfbW9jayhvYmopOgogICAgIyBjYW4ndCB1c2UgaXNpbnN0YW5jZSBvbiBNb2NrIG9iamVjdHMgYmVjYXVzZSB0aGV5IG92ZXJyaWRlIF9fY2xhc3NfXwogICAgIyBUaGUgYmFzZSBjbGFzcyBmb3IgYWxsIG1vY2tzIGlzIE5vbkNhbGxhYmxlTW9jawogICAgcmV0dXJuIGlzc3ViY2xhc3ModHlwZShvYmopLCBOb25DYWxsYWJsZU1vY2spCgoKZGVmIF9pc19leGNlcHRpb24ob2JqKToKICAgIHJldHVybiAoCiAgICAgICAgaXNpbnN0YW5jZShvYmosIEJhc2VFeGNlcHRpb25zKSBvcgogICAgICAgIGlzaW5zdGFuY2Uob2JqLCB0eXBlKSBhbmQgaXNzdWJjbGFzcyhvYmosIEJhc2VFeGNlcHRpb25zKQogICAgKQoKCmNsYXNzIF9zbG90dGVkKG9iamVjdCk6CiAgICBfX3Nsb3RzX18gPSBbJ2EnXQoKCkRlc2NyaXB0b3JUeXBlcyA9ICgKICAgIHR5cGUoX3Nsb3R0ZWQuYSksCiAgICBwcm9wZXJ0eSwKKQoKCmRlZiBfZ2V0c2lnbmF0dXJlKGZ1bmMsIHNraXBmaXJzdCwgaW5zdGFuY2U9RmFsc2UpOgogICAgaWYgaXNpbnN0YW5jZShmdW5jLCB0eXBlKSBhbmQgbm90IGluc3RhbmNlOgogICAgICAgIHRyeToKICAgICAgICAgICAgZnVuYyA9IGZ1bmMuX19pbml0X18KICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIHNraXBmaXJzdCA9IFRydWUKICAgIGVsaWYgbm90IGlzaW5zdGFuY2UoZnVuYywgRnVuY3Rpb25UeXBlcyk6CiAgICAgICAgIyBmb3IgY2xhc3NlcyB3aGVyZSBpbnN0YW5jZSBpcyBUcnVlIHdlIGVuZCB1cCBoZXJlIHRvbwogICAgICAgIHRyeToKICAgICAgICAgICAgZnVuYyA9IGZ1bmMuX19jYWxsX18KICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHJldHVybgoKICAgIHRyeToKICAgICAgICBhcmdzcGVjID0gaW5zcGVjdC5nZXRmdWxsYXJnc3BlYyhmdW5jKQogICAgZXhjZXB0IFR5cGVFcnJvcjoKICAgICAgICAjIEMgZnVuY3Rpb24gLyBtZXRob2QsIHBvc3NpYmx5IGluaGVyaXRlZCBvYmplY3QoKS5fX2luaXRfXwogICAgICAgIHJldHVybgoKICAgIHJlZ2FyZ3MsIHZhcmFyZ3MsIHZhcmt3LCBkZWZhdWx0cywga3dvbmx5LCBrd29ubHlkZWYsIGFubiA9IGFyZ3NwZWMKCgogICAgIyBpbnN0YW5jZSBtZXRob2RzIGFuZCBjbGFzc21ldGhvZHMgbmVlZCB0byBsb3NlIHRoZSBzZWxmIGFyZ3VtZW50CiAgICBpZiBnZXRhdHRyKGZ1bmMsICdfX3NlbGZfXycsIE5vbmUpIGlzIG5vdCBOb25lOgogICAgICAgIHJlZ2FyZ3MgPSByZWdhcmdzWzE6XQogICAgaWYgc2tpcGZpcnN0OgogICAgICAgICMgdGhpcyBjb25kaXRpb24gYW5kIHRoZSBhYm92ZSBvbmUgYXJlIG5ldmVyIGJvdGggVHJ1ZSAtIHdoeT8KICAgICAgICByZWdhcmdzID0gcmVnYXJnc1sxOl0KCiAgICBzaWduYXR1cmUgPSBpbnNwZWN0LmZvcm1hdGFyZ3NwZWMoCiAgICAgICAgcmVnYXJncywgdmFyYXJncywgdmFya3csIGRlZmF1bHRzLAogICAgICAgIGt3b25seSwga3dvbmx5ZGVmLCBhbm4sIGZvcm1hdHZhbHVlPWxhbWJkYSB2YWx1ZTogIiIpCiAgICByZXR1cm4gc2lnbmF0dXJlWzE6LTFdLCBmdW5jCgoKZGVmIF9jaGVja19zaWduYXR1cmUoZnVuYywgbW9jaywgc2tpcGZpcnN0LCBpbnN0YW5jZT1GYWxzZSk6CiAgICBpZiBub3QgX2NhbGxhYmxlKGZ1bmMpOgogICAgICAgIHJldHVybgoKICAgIHJlc3VsdCA9IF9nZXRzaWduYXR1cmUoZnVuYywgc2tpcGZpcnN0LCBpbnN0YW5jZSkKICAgIGlmIHJlc3VsdCBpcyBOb25lOgogICAgICAgIHJldHVybgogICAgc2lnbmF0dXJlLCBmdW5jID0gcmVzdWx0CgogICAgIyBjYW4ndCB1c2Ugc2VsZiBiZWNhdXNlICJzZWxmIiBpcyBjb21tb24gYXMgYW4gYXJndW1lbnQgbmFtZQogICAgIyB1bmZvcnR1bmF0ZWx5IGV2ZW4gbm90IGluIHRoZSBmaXJzdCBwbGFjZQogICAgc3JjID0gImxhbWJkYSBfbW9ja19zZWxmLCAlczogTm9uZSIgJSBzaWduYXR1cmUKICAgIGNoZWNrc2lnID0gZXZhbChzcmMsIHt9KQogICAgX2NvcHlfZnVuY19kZXRhaWxzKGZ1bmMsIGNoZWNrc2lnKQogICAgdHlwZShtb2NrKS5fbW9ja19jaGVja19zaWcgPSBjaGVja3NpZwoKCmRlZiBfY29weV9mdW5jX2RldGFpbHMoZnVuYywgZnVuY29weSk6CiAgICBmdW5jb3B5Ll9fbmFtZV9fID0gZnVuYy5fX25hbWVfXwogICAgZnVuY29weS5fX2RvY19fID0gZnVuYy5fX2RvY19fCiAgICAjIHdlIGV4cGxpY2l0bHkgZG9uJ3QgY29weSBmdW5jLl9fZGljdF9fIGludG8gdGhpcyBjb3B5IGFzIGl0IHdvdWxkCiAgICAjIGV4cG9zZSBvcmlnaW5hbCBhdHRyaWJ1dGVzIHRoYXQgc2hvdWxkIGJlIG1vY2tlZAogICAgZnVuY29weS5fX21vZHVsZV9fID0gZnVuYy5fX21vZHVsZV9fCiAgICBmdW5jb3B5Ll9fZGVmYXVsdHNfXyA9IGZ1bmMuX19kZWZhdWx0c19fCiAgICBmdW5jb3B5Ll9fa3dkZWZhdWx0c19fID0gZnVuYy5fX2t3ZGVmYXVsdHNfXwoKCmRlZiBfY2FsbGFibGUob2JqKToKICAgIGlmIGlzaW5zdGFuY2Uob2JqLCB0eXBlKToKICAgICAgICByZXR1cm4gVHJ1ZQogICAgaWYgZ2V0YXR0cihvYmosICdfX2NhbGxfXycsIE5vbmUpIGlzIG5vdCBOb25lOgogICAgICAgIHJldHVybiBUcnVlCiAgICByZXR1cm4gRmFsc2UKCgpkZWYgX2lzX2xpc3Qob2JqKToKICAgICMgY2hlY2tzIGZvciBsaXN0IG9yIHR1cGxlcwogICAgIyBYWFhYIGJhZGx5IG5hbWVkIQogICAgcmV0dXJuIHR5cGUob2JqKSBpbiAobGlzdCwgdHVwbGUpCgoKZGVmIF9pbnN0YW5jZV9jYWxsYWJsZShvYmopOgogICAgIiIiR2l2ZW4gYW4gb2JqZWN0LCByZXR1cm4gVHJ1ZSBpZiB0aGUgb2JqZWN0IGlzIGNhbGxhYmxlLgogICAgRm9yIGNsYXNzZXMsIHJldHVybiBUcnVlIGlmIGluc3RhbmNlcyB3b3VsZCBiZSBjYWxsYWJsZS4iIiIKICAgIGlmIG5vdCBpc2luc3RhbmNlKG9iaiwgdHlwZSk6CiAgICAgICAgIyBhbHJlYWR5IGFuIGluc3RhbmNlCiAgICAgICAgcmV0dXJuIGdldGF0dHIob2JqLCAnX19jYWxsX18nLCBOb25lKSBpcyBub3QgTm9uZQoKICAgICMgKmNvdWxkKiBiZSBicm9rZW4gYnkgYSBjbGFzcyBvdmVycmlkaW5nIF9fbXJvX18gb3IgX19kaWN0X18gdmlhCiAgICAjIGEgbWV0YWNsYXNzCiAgICBmb3IgYmFzZSBpbiAob2JqLCkgKyBvYmouX19tcm9fXzoKICAgICAgICBpZiBiYXNlLl9fZGljdF9fLmdldCgnX19jYWxsX18nKSBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgIHJldHVybiBGYWxzZQoKCmRlZiBfc2V0X3NpZ25hdHVyZShtb2NrLCBvcmlnaW5hbCwgaW5zdGFuY2U9RmFsc2UpOgogICAgIyBjcmVhdGVzIGEgZnVuY3Rpb24gd2l0aCBzaWduYXR1cmUgKCphcmdzLCAqKmt3YXJncykgdGhhdCBkZWxlZ2F0ZXMgdG8gYQogICAgIyBtb2NrLiBJdCBzdGlsbCBkb2VzIHNpZ25hdHVyZSBjaGVja2luZyBieSBjYWxsaW5nIGEgbGFtYmRhIHdpdGggdGhlIHNhbWUKICAgICMgc2lnbmF0dXJlIGFzIHRoZSBvcmlnaW5hbC4KICAgIGlmIG5vdCBfY2FsbGFibGUob3JpZ2luYWwpOgogICAgICAgIHJldHVybgoKICAgIHNraXBmaXJzdCA9IGlzaW5zdGFuY2Uob3JpZ2luYWwsIHR5cGUpCiAgICByZXN1bHQgPSBfZ2V0c2lnbmF0dXJlKG9yaWdpbmFsLCBza2lwZmlyc3QsIGluc3RhbmNlKQogICAgaWYgcmVzdWx0IGlzIE5vbmU6CiAgICAgICAgIyB3YXMgYSBDIGZ1bmN0aW9uIChlLmcuIG9iamVjdCgpLl9faW5pdF9fICkgdGhhdCBjYW4ndCBiZSBtb2NrZWQKICAgICAgICByZXR1cm4KCiAgICBzaWduYXR1cmUsIGZ1bmMgPSByZXN1bHQKCiAgICBzcmMgPSAibGFtYmRhICVzOiBOb25lIiAlIHNpZ25hdHVyZQogICAgY2hlY2tzaWcgPSBldmFsKHNyYywge30pCiAgICBfY29weV9mdW5jX2RldGFpbHMoZnVuYywgY2hlY2tzaWcpCgogICAgbmFtZSA9IG9yaWdpbmFsLl9fbmFtZV9fCiAgICBpZiBub3QgbmFtZS5pc2lkZW50aWZpZXIoKToKICAgICAgICBuYW1lID0gJ2Z1bmNvcHknCiAgICBjb250ZXh0ID0geydfY2hlY2tzaWdfJzogY2hlY2tzaWcsICdtb2NrJzogbW9ja30KICAgIHNyYyA9ICIiImRlZiAlcygqYXJncywgKiprd2FyZ3MpOgogICAgX2NoZWNrc2lnXygqYXJncywgKiprd2FyZ3MpCiAgICByZXR1cm4gbW9jaygqYXJncywgKiprd2FyZ3MpIiIiICUgbmFtZQogICAgZXhlYyAoc3JjLCBjb250ZXh0KQogICAgZnVuY29weSA9IGNvbnRleHRbbmFtZV0KICAgIF9zZXR1cF9mdW5jKGZ1bmNvcHksIG1vY2spCiAgICByZXR1cm4gZnVuY29weQoKCmRlZiBfc2V0dXBfZnVuYyhmdW5jb3B5LCBtb2NrKToKICAgIGZ1bmNvcHkubW9jayA9IG1vY2sKCiAgICAjIGNhbid0IHVzZSBpc2luc3RhbmNlIHdpdGggbW9ja3MKICAgIGlmIG5vdCBfaXNfaW5zdGFuY2VfbW9jayhtb2NrKToKICAgICAgICByZXR1cm4KCiAgICBkZWYgYXNzZXJ0X2NhbGxlZF93aXRoKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgcmV0dXJuIG1vY2suYXNzZXJ0X2NhbGxlZF93aXRoKCphcmdzLCAqKmt3YXJncykKICAgIGRlZiBhc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCgqYXJncywgKiprd2FyZ3MpOgogICAgICAgIHJldHVybiBtb2NrLmFzc2VydF9jYWxsZWRfb25jZV93aXRoKCphcmdzLCAqKmt3YXJncykKICAgIGRlZiBhc3NlcnRfaGFzX2NhbGxzKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgcmV0dXJuIG1vY2suYXNzZXJ0X2hhc19jYWxscygqYXJncywgKiprd2FyZ3MpCiAgICBkZWYgYXNzZXJ0X2FueV9jYWxsKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgcmV0dXJuIG1vY2suYXNzZXJ0X2FueV9jYWxsKCphcmdzLCAqKmt3YXJncykKICAgIGRlZiByZXNldF9tb2NrKCk6CiAgICAgICAgZnVuY29weS5tZXRob2RfY2FsbHMgPSBfQ2FsbExpc3QoKQogICAgICAgIGZ1bmNvcHkubW9ja19jYWxscyA9IF9DYWxsTGlzdCgpCiAgICAgICAgbW9jay5yZXNldF9tb2NrKCkKICAgICAgICByZXQgPSBmdW5jb3B5LnJldHVybl92YWx1ZQogICAgICAgIGlmIF9pc19pbnN0YW5jZV9tb2NrKHJldCkgYW5kIG5vdCByZXQgaXMgbW9jazoKICAgICAgICAgICAgcmV0LnJlc2V0X21vY2soKQoKICAgIGZ1bmNvcHkuY2FsbGVkID0gRmFsc2UKICAgIGZ1bmNvcHkuY2FsbF9jb3VudCA9IDAKICAgIGZ1bmNvcHkuY2FsbF9hcmdzID0gTm9uZQogICAgZnVuY29weS5jYWxsX2FyZ3NfbGlzdCA9IF9DYWxsTGlzdCgpCiAgICBmdW5jb3B5Lm1ldGhvZF9jYWxscyA9IF9DYWxsTGlzdCgpCiAgICBmdW5jb3B5Lm1vY2tfY2FsbHMgPSBfQ2FsbExpc3QoKQoKICAgIGZ1bmNvcHkucmV0dXJuX3ZhbHVlID0gbW9jay5yZXR1cm5fdmFsdWUKICAgIGZ1bmNvcHkuc2lkZV9lZmZlY3QgPSBtb2NrLnNpZGVfZWZmZWN0CiAgICBmdW5jb3B5Ll9tb2NrX2NoaWxkcmVuID0gbW9jay5fbW9ja19jaGlsZHJlbgoKICAgIGZ1bmNvcHkuYXNzZXJ0X2NhbGxlZF93aXRoID0gYXNzZXJ0X2NhbGxlZF93aXRoCiAgICBmdW5jb3B5LmFzc2VydF9jYWxsZWRfb25jZV93aXRoID0gYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgKICAgIGZ1bmNvcHkuYXNzZXJ0X2hhc19jYWxscyA9IGFzc2VydF9oYXNfY2FsbHMKICAgIGZ1bmNvcHkuYXNzZXJ0X2FueV9jYWxsID0gYXNzZXJ0X2FueV9jYWxsCiAgICBmdW5jb3B5LnJlc2V0X21vY2sgPSByZXNldF9tb2NrCgogICAgbW9jay5fbW9ja19kZWxlZ2F0ZSA9IGZ1bmNvcHkKCgpkZWYgX2lzX21hZ2ljKG5hbWUpOgogICAgcmV0dXJuICdfXyVzX18nICUgbmFtZVsyOi0yXSA9PSBuYW1lCgoKY2xhc3MgX1NlbnRpbmVsT2JqZWN0KG9iamVjdCk6CiAgICAiQSB1bmlxdWUsIG5hbWVkLCBzZW50aW5lbCBvYmplY3QuIgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG5hbWUpOgogICAgICAgIHNlbGYubmFtZSA9IG5hbWUKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICdzZW50aW5lbC4lcycgJSBzZWxmLm5hbWUKCgpjbGFzcyBfU2VudGluZWwob2JqZWN0KToKICAgICIiIkFjY2VzcyBhdHRyaWJ1dGVzIHRvIHJldHVybiBhIG5hbWVkIG9iamVjdCwgdXNhYmxlIGFzIGEgc2VudGluZWwuIiIiCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi5fc2VudGluZWxzID0ge30KCiAgICBkZWYgX19nZXRhdHRyX18oc2VsZiwgbmFtZSk6CiAgICAgICAgaWYgbmFtZSA9PSAnX19iYXNlc19fJzoKICAgICAgICAgICAgIyBXaXRob3V0IHRoaXMgaGVscCh1bml0dGVzdC5tb2NrKSByYWlzZXMgYW4gZXhjZXB0aW9uCiAgICAgICAgICAgIHJhaXNlIEF0dHJpYnV0ZUVycm9yCiAgICAgICAgcmV0dXJuIHNlbGYuX3NlbnRpbmVscy5zZXRkZWZhdWx0KG5hbWUsIF9TZW50aW5lbE9iamVjdChuYW1lKSkKCgpzZW50aW5lbCA9IF9TZW50aW5lbCgpCgpERUZBVUxUID0gc2VudGluZWwuREVGQVVMVApfbWlzc2luZyA9IHNlbnRpbmVsLk1JU1NJTkcKX2RlbGV0ZWQgPSBzZW50aW5lbC5ERUxFVEVECgoKZGVmIF9jb3B5KHZhbHVlKToKICAgIGlmIHR5cGUodmFsdWUpIGluIChkaWN0LCBsaXN0LCB0dXBsZSwgc2V0KToKICAgICAgICByZXR1cm4gdHlwZSh2YWx1ZSkodmFsdWUpCiAgICByZXR1cm4gdmFsdWUKCgpfYWxsb3dlZF9uYW1lcyA9IHNldCgKICAgIFsKICAgICAgICAncmV0dXJuX3ZhbHVlJywgJ19tb2NrX3JldHVybl92YWx1ZScsICdzaWRlX2VmZmVjdCcsCiAgICAgICAgJ19tb2NrX3NpZGVfZWZmZWN0JywgJ19tb2NrX3BhcmVudCcsICdfbW9ja19uZXdfcGFyZW50JywKICAgICAgICAnX21vY2tfbmFtZScsICdfbW9ja19uZXdfbmFtZScKICAgIF0KKQoKCmRlZiBfZGVsZWdhdGluZ19wcm9wZXJ0eShuYW1lKToKICAgIF9hbGxvd2VkX25hbWVzLmFkZChuYW1lKQogICAgX3RoZV9uYW1lID0gJ19tb2NrXycgKyBuYW1lCiAgICBkZWYgX2dldChzZWxmLCBuYW1lPW5hbWUsIF90aGVfbmFtZT1fdGhlX25hbWUpOgogICAgICAgIHNpZyA9IHNlbGYuX21vY2tfZGVsZWdhdGUKICAgICAgICBpZiBzaWcgaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoc2VsZiwgX3RoZV9uYW1lKQogICAgICAgIHJldHVybiBnZXRhdHRyKHNpZywgbmFtZSkKICAgIGRlZiBfc2V0KHNlbGYsIHZhbHVlLCBuYW1lPW5hbWUsIF90aGVfbmFtZT1fdGhlX25hbWUpOgogICAgICAgIHNpZyA9IHNlbGYuX21vY2tfZGVsZWdhdGUKICAgICAgICBpZiBzaWcgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5fX2RpY3RfX1tfdGhlX25hbWVdID0gdmFsdWUKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZXRhdHRyKHNpZywgbmFtZSwgdmFsdWUpCgogICAgcmV0dXJuIHByb3BlcnR5KF9nZXQsIF9zZXQpCgoKCmNsYXNzIF9DYWxsTGlzdChsaXN0KToKCiAgICBkZWYgX19jb250YWluc19fKHNlbGYsIHZhbHVlKToKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZSh2YWx1ZSwgbGlzdCk6CiAgICAgICAgICAgIHJldHVybiBsaXN0Ll9fY29udGFpbnNfXyhzZWxmLCB2YWx1ZSkKICAgICAgICBsZW5fdmFsdWUgPSBsZW4odmFsdWUpCiAgICAgICAgbGVuX3NlbGYgPSBsZW4oc2VsZikKICAgICAgICBpZiBsZW5fdmFsdWUgPiBsZW5fc2VsZjoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgICAgIGZvciBpIGluIHJhbmdlKDAsIGxlbl9zZWxmIC0gbGVuX3ZhbHVlICsgMSk6CiAgICAgICAgICAgIHN1Yl9saXN0ID0gc2VsZltpOmkrbGVuX3ZhbHVlXQogICAgICAgICAgICBpZiBzdWJfbGlzdCA9PSB2YWx1ZToKICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBwcHJpbnQucGZvcm1hdChsaXN0KHNlbGYpKQoKCmRlZiBfY2hlY2tfYW5kX3NldF9wYXJlbnQocGFyZW50LCB2YWx1ZSwgbmFtZSwgbmV3X25hbWUpOgogICAgaWYgbm90IF9pc19pbnN0YW5jZV9tb2NrKHZhbHVlKToKICAgICAgICByZXR1cm4gRmFsc2UKICAgIGlmICgodmFsdWUuX21vY2tfbmFtZSBvciB2YWx1ZS5fbW9ja19uZXdfbmFtZSkgb3IKICAgICAgICAodmFsdWUuX21vY2tfcGFyZW50IGlzIG5vdCBOb25lKSBvcgogICAgICAgICh2YWx1ZS5fbW9ja19uZXdfcGFyZW50IGlzIG5vdCBOb25lKSk6CiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgX3BhcmVudCA9IHBhcmVudAogICAgd2hpbGUgX3BhcmVudCBpcyBub3QgTm9uZToKICAgICAgICAjIHNldHRpbmcgYSBtb2NrICh2YWx1ZSkgYXMgYSBjaGlsZCBvciByZXR1cm4gdmFsdWUgb2YgaXRzZWxmCiAgICAgICAgIyBzaG91bGQgbm90IG1vZGlmeSB0aGUgbW9jawogICAgICAgIGlmIF9wYXJlbnQgaXMgdmFsdWU6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIF9wYXJlbnQgPSBfcGFyZW50Ll9tb2NrX25ld19wYXJlbnQKCiAgICBpZiBuZXdfbmFtZToKICAgICAgICB2YWx1ZS5fbW9ja19uZXdfcGFyZW50ID0gcGFyZW50CiAgICAgICAgdmFsdWUuX21vY2tfbmV3X25hbWUgPSBuZXdfbmFtZQogICAgaWYgbmFtZToKICAgICAgICB2YWx1ZS5fbW9ja19wYXJlbnQgPSBwYXJlbnQKICAgICAgICB2YWx1ZS5fbW9ja19uYW1lID0gbmFtZQogICAgcmV0dXJuIFRydWUKCgoKY2xhc3MgQmFzZShvYmplY3QpOgogICAgX21vY2tfcmV0dXJuX3ZhbHVlID0gREVGQVVMVAogICAgX21vY2tfc2lkZV9lZmZlY3QgPSBOb25lCiAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICBwYXNzCgoKCmNsYXNzIE5vbkNhbGxhYmxlTW9jayhCYXNlKToKICAgICIiIkEgbm9uLWNhbGxhYmxlIHZlcnNpb24gb2YgYE1vY2tgIiIiCgogICAgZGVmIF9fbmV3X18oY2xzLCAqYXJncywgKiprdyk6CiAgICAgICAgIyBldmVyeSBpbnN0YW5jZSBoYXMgaXRzIG93biBjbGFzcwogICAgICAgICMgc28gd2UgY2FuIGNyZWF0ZSBtYWdpYyBtZXRob2RzIG9uIHRoZQogICAgICAgICMgY2xhc3Mgd2l0aG91dCBzdG9tcGluZyBvbiBvdGhlciBtb2NrcwogICAgICAgIG5ldyA9IHR5cGUoY2xzLl9fbmFtZV9fLCAoY2xzLCksIHsnX19kb2NfXyc6IGNscy5fX2RvY19ffSkKICAgICAgICBpbnN0YW5jZSA9IG9iamVjdC5fX25ld19fKG5ldykKICAgICAgICByZXR1cm4gaW5zdGFuY2UKCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgICAgICBzZWxmLCBzcGVjPU5vbmUsIHdyYXBzPU5vbmUsIG5hbWU9Tm9uZSwgc3BlY19zZXQ9Tm9uZSwKICAgICAgICAgICAgcGFyZW50PU5vbmUsIF9zcGVjX3N0YXRlPU5vbmUsIF9uZXdfbmFtZT0nJywgX25ld19wYXJlbnQ9Tm9uZSwKICAgICAgICAgICAgKiprd2FyZ3MKICAgICAgICApOgogICAgICAgIGlmIF9uZXdfcGFyZW50IGlzIE5vbmU6CiAgICAgICAgICAgIF9uZXdfcGFyZW50ID0gcGFyZW50CgogICAgICAgIF9fZGljdF9fID0gc2VsZi5fX2RpY3RfXwogICAgICAgIF9fZGljdF9fWydfbW9ja19wYXJlbnQnXSA9IHBhcmVudAogICAgICAgIF9fZGljdF9fWydfbW9ja19uYW1lJ10gPSBuYW1lCiAgICAgICAgX19kaWN0X19bJ19tb2NrX25ld19uYW1lJ10gPSBfbmV3X25hbWUKICAgICAgICBfX2RpY3RfX1snX21vY2tfbmV3X3BhcmVudCddID0gX25ld19wYXJlbnQKCiAgICAgICAgaWYgc3BlY19zZXQgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHNwZWMgPSBzcGVjX3NldAogICAgICAgICAgICBzcGVjX3NldCA9IFRydWUKCiAgICAgICAgc2VsZi5fbW9ja19hZGRfc3BlYyhzcGVjLCBzcGVjX3NldCkKCiAgICAgICAgX19kaWN0X19bJ19tb2NrX2NoaWxkcmVuJ10gPSB7fQogICAgICAgIF9fZGljdF9fWydfbW9ja193cmFwcyddID0gd3JhcHMKICAgICAgICBfX2RpY3RfX1snX21vY2tfZGVsZWdhdGUnXSA9IE5vbmUKCiAgICAgICAgX19kaWN0X19bJ19tb2NrX2NhbGxlZCddID0gRmFsc2UKICAgICAgICBfX2RpY3RfX1snX21vY2tfY2FsbF9hcmdzJ10gPSBOb25lCiAgICAgICAgX19kaWN0X19bJ19tb2NrX2NhbGxfY291bnQnXSA9IDAKICAgICAgICBfX2RpY3RfX1snX21vY2tfY2FsbF9hcmdzX2xpc3QnXSA9IF9DYWxsTGlzdCgpCiAgICAgICAgX19kaWN0X19bJ19tb2NrX21vY2tfY2FsbHMnXSA9IF9DYWxsTGlzdCgpCgogICAgICAgIF9fZGljdF9fWydtZXRob2RfY2FsbHMnXSA9IF9DYWxsTGlzdCgpCgogICAgICAgIGlmIGt3YXJnczoKICAgICAgICAgICAgc2VsZi5jb25maWd1cmVfbW9jaygqKmt3YXJncykKCiAgICAgICAgX3NhZmVfc3VwZXIoTm9uQ2FsbGFibGVNb2NrLCBzZWxmKS5fX2luaXRfXygKICAgICAgICAgICAgc3BlYywgd3JhcHMsIG5hbWUsIHNwZWNfc2V0LCBwYXJlbnQsCiAgICAgICAgICAgIF9zcGVjX3N0YXRlCiAgICAgICAgKQoKCiAgICBkZWYgYXR0YWNoX21vY2soc2VsZiwgbW9jaywgYXR0cmlidXRlKToKICAgICAgICAiIiIKICAgICAgICBBdHRhY2ggYSBtb2NrIGFzIGFuIGF0dHJpYnV0ZSBvZiB0aGlzIG9uZSwgcmVwbGFjaW5nIGl0cyBuYW1lIGFuZAogICAgICAgIHBhcmVudC4gQ2FsbHMgdG8gdGhlIGF0dGFjaGVkIG1vY2sgd2lsbCBiZSByZWNvcmRlZCBpbiB0aGUKICAgICAgICBgbWV0aG9kX2NhbGxzYCBhbmQgYG1vY2tfY2FsbHNgIGF0dHJpYnV0ZXMgb2YgdGhpcyBvbmUuIiIiCiAgICAgICAgbW9jay5fbW9ja19wYXJlbnQgPSBOb25lCiAgICAgICAgbW9jay5fbW9ja19uZXdfcGFyZW50ID0gTm9uZQogICAgICAgIG1vY2suX21vY2tfbmFtZSA9ICcnCiAgICAgICAgbW9jay5fbW9ja19uZXdfbmFtZSA9IE5vbmUKCiAgICAgICAgc2V0YXR0cihzZWxmLCBhdHRyaWJ1dGUsIG1vY2spCgoKICAgIGRlZiBtb2NrX2FkZF9zcGVjKHNlbGYsIHNwZWMsIHNwZWNfc2V0PUZhbHNlKToKICAgICAgICAiIiJBZGQgYSBzcGVjIHRvIGEgbW9jay4gYHNwZWNgIGNhbiBlaXRoZXIgYmUgYW4gb2JqZWN0IG9yIGEKICAgICAgICBsaXN0IG9mIHN0cmluZ3MuIE9ubHkgYXR0cmlidXRlcyBvbiB0aGUgYHNwZWNgIGNhbiBiZSBmZXRjaGVkIGFzCiAgICAgICAgYXR0cmlidXRlcyBmcm9tIHRoZSBtb2NrLgoKICAgICAgICBJZiBgc3BlY19zZXRgIGlzIFRydWUgdGhlbiBvbmx5IGF0dHJpYnV0ZXMgb24gdGhlIHNwZWMgY2FuIGJlIHNldC4iIiIKICAgICAgICBzZWxmLl9tb2NrX2FkZF9zcGVjKHNwZWMsIHNwZWNfc2V0KQoKCiAgICBkZWYgX21vY2tfYWRkX3NwZWMoc2VsZiwgc3BlYywgc3BlY19zZXQpOgogICAgICAgIF9zcGVjX2NsYXNzID0gTm9uZQoKICAgICAgICBpZiBzcGVjIGlzIG5vdCBOb25lIGFuZCBub3QgX2lzX2xpc3Qoc3BlYyk6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uoc3BlYywgdHlwZSk6CiAgICAgICAgICAgICAgICBfc3BlY19jbGFzcyA9IHNwZWMKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIF9zcGVjX2NsYXNzID0gX2dldF9jbGFzcyhzcGVjKQoKICAgICAgICAgICAgc3BlYyA9IGRpcihzcGVjKQoKICAgICAgICBfX2RpY3RfXyA9IHNlbGYuX19kaWN0X18KICAgICAgICBfX2RpY3RfX1snX3NwZWNfY2xhc3MnXSA9IF9zcGVjX2NsYXNzCiAgICAgICAgX19kaWN0X19bJ19zcGVjX3NldCddID0gc3BlY19zZXQKICAgICAgICBfX2RpY3RfX1snX21vY2tfbWV0aG9kcyddID0gc3BlYwoKCiAgICBkZWYgX19nZXRfcmV0dXJuX3ZhbHVlKHNlbGYpOgogICAgICAgIHJldCA9IHNlbGYuX21vY2tfcmV0dXJuX3ZhbHVlCiAgICAgICAgaWYgc2VsZi5fbW9ja19kZWxlZ2F0ZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmV0ID0gc2VsZi5fbW9ja19kZWxlZ2F0ZS5yZXR1cm5fdmFsdWUKCiAgICAgICAgaWYgcmV0IGlzIERFRkFVTFQ6CiAgICAgICAgICAgIHJldCA9IHNlbGYuX2dldF9jaGlsZF9tb2NrKAogICAgICAgICAgICAgICAgX25ld19wYXJlbnQ9c2VsZiwgX25ld19uYW1lPScoKScKICAgICAgICAgICAgKQogICAgICAgICAgICBzZWxmLnJldHVybl92YWx1ZSA9IHJldAogICAgICAgIHJldHVybiByZXQKCgogICAgZGVmIF9fc2V0X3JldHVybl92YWx1ZShzZWxmLCB2YWx1ZSk6CiAgICAgICAgaWYgc2VsZi5fbW9ja19kZWxlZ2F0ZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5fbW9ja19kZWxlZ2F0ZS5yZXR1cm5fdmFsdWUgPSB2YWx1ZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuX21vY2tfcmV0dXJuX3ZhbHVlID0gdmFsdWUKICAgICAgICAgICAgX2NoZWNrX2FuZF9zZXRfcGFyZW50KHNlbGYsIHZhbHVlLCBOb25lLCAnKCknKQoKICAgIF9fcmV0dXJuX3ZhbHVlX2RvYyA9ICJUaGUgdmFsdWUgdG8gYmUgcmV0dXJuZWQgd2hlbiB0aGUgbW9jayBpcyBjYWxsZWQuIgogICAgcmV0dXJuX3ZhbHVlID0gcHJvcGVydHkoX19nZXRfcmV0dXJuX3ZhbHVlLCBfX3NldF9yZXR1cm5fdmFsdWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX3JldHVybl92YWx1ZV9kb2MpCgoKICAgIEBwcm9wZXJ0eQogICAgZGVmIF9fY2xhc3NfXyhzZWxmKToKICAgICAgICBpZiBzZWxmLl9zcGVjX2NsYXNzIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiB0eXBlKHNlbGYpCiAgICAgICAgcmV0dXJuIHNlbGYuX3NwZWNfY2xhc3MKCiAgICBjYWxsZWQgPSBfZGVsZWdhdGluZ19wcm9wZXJ0eSgnY2FsbGVkJykKICAgIGNhbGxfY291bnQgPSBfZGVsZWdhdGluZ19wcm9wZXJ0eSgnY2FsbF9jb3VudCcpCiAgICBjYWxsX2FyZ3MgPSBfZGVsZWdhdGluZ19wcm9wZXJ0eSgnY2FsbF9hcmdzJykKICAgIGNhbGxfYXJnc19saXN0ID0gX2RlbGVnYXRpbmdfcHJvcGVydHkoJ2NhbGxfYXJnc19saXN0JykKICAgIG1vY2tfY2FsbHMgPSBfZGVsZWdhdGluZ19wcm9wZXJ0eSgnbW9ja19jYWxscycpCgoKICAgIGRlZiBfX2dldF9zaWRlX2VmZmVjdChzZWxmKToKICAgICAgICBkZWxlZ2F0ZWQgPSBzZWxmLl9tb2NrX2RlbGVnYXRlCiAgICAgICAgaWYgZGVsZWdhdGVkIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9tb2NrX3NpZGVfZWZmZWN0CiAgICAgICAgcmV0dXJuIGRlbGVnYXRlZC5zaWRlX2VmZmVjdAoKICAgIGRlZiBfX3NldF9zaWRlX2VmZmVjdChzZWxmLCB2YWx1ZSk6CiAgICAgICAgdmFsdWUgPSBfdHJ5X2l0ZXIodmFsdWUpCiAgICAgICAgZGVsZWdhdGVkID0gc2VsZi5fbW9ja19kZWxlZ2F0ZQogICAgICAgIGlmIGRlbGVnYXRlZCBpcyBOb25lOgogICAgICAgICAgICBzZWxmLl9tb2NrX3NpZGVfZWZmZWN0ID0gdmFsdWUKICAgICAgICBlbHNlOgogICAgICAgICAgICBkZWxlZ2F0ZWQuc2lkZV9lZmZlY3QgPSB2YWx1ZQoKICAgIHNpZGVfZWZmZWN0ID0gcHJvcGVydHkoX19nZXRfc2lkZV9lZmZlY3QsIF9fc2V0X3NpZGVfZWZmZWN0KQoKCiAgICBkZWYgcmVzZXRfbW9jayhzZWxmKToKICAgICAgICAiUmVzdG9yZSB0aGUgbW9jayBvYmplY3QgdG8gaXRzIGluaXRpYWwgc3RhdGUuIgogICAgICAgIHNlbGYuY2FsbGVkID0gRmFsc2UKICAgICAgICBzZWxmLmNhbGxfYXJncyA9IE5vbmUKICAgICAgICBzZWxmLmNhbGxfY291bnQgPSAwCiAgICAgICAgc2VsZi5tb2NrX2NhbGxzID0gX0NhbGxMaXN0KCkKICAgICAgICBzZWxmLmNhbGxfYXJnc19saXN0ID0gX0NhbGxMaXN0KCkKICAgICAgICBzZWxmLm1ldGhvZF9jYWxscyA9IF9DYWxsTGlzdCgpCgogICAgICAgIGZvciBjaGlsZCBpbiBzZWxmLl9tb2NrX2NoaWxkcmVuLnZhbHVlcygpOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGNoaWxkLCBfU3BlY1N0YXRlKToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGNoaWxkLnJlc2V0X21vY2soKQoKICAgICAgICByZXQgPSBzZWxmLl9tb2NrX3JldHVybl92YWx1ZQogICAgICAgIGlmIF9pc19pbnN0YW5jZV9tb2NrKHJldCkgYW5kIHJldCBpcyBub3Qgc2VsZjoKICAgICAgICAgICAgcmV0LnJlc2V0X21vY2soKQoKCiAgICBkZWYgY29uZmlndXJlX21vY2soc2VsZiwgKiprd2FyZ3MpOgogICAgICAgICIiIlNldCBhdHRyaWJ1dGVzIG9uIHRoZSBtb2NrIHRocm91Z2gga2V5d29yZCBhcmd1bWVudHMuCgogICAgICAgIEF0dHJpYnV0ZXMgcGx1cyByZXR1cm4gdmFsdWVzIGFuZCBzaWRlIGVmZmVjdHMgY2FuIGJlIHNldCBvbiBjaGlsZAogICAgICAgIG1vY2tzIHVzaW5nIHN0YW5kYXJkIGRvdCBub3RhdGlvbiBhbmQgdW5wYWNraW5nIGEgZGljdGlvbmFyeSBpbiB0aGUKICAgICAgICBtZXRob2QgY2FsbDoKCiAgICAgICAgPj4+IGF0dHJzID0geydtZXRob2QucmV0dXJuX3ZhbHVlJzogMywgJ290aGVyLnNpZGVfZWZmZWN0JzogS2V5RXJyb3J9CiAgICAgICAgPj4+IG1vY2suY29uZmlndXJlX21vY2soKiphdHRycykiIiIKICAgICAgICBmb3IgYXJnLCB2YWwgaW4gc29ydGVkKGt3YXJncy5pdGVtcygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB3ZSBzb3J0IG9uIHRoZSBudW1iZXIgb2YgZG90cyBzbyB0aGF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGF0dHJpYnV0ZXMgYXJlIHNldCBiZWZvcmUgd2Ugc2V0IGF0dHJpYnV0ZXMgb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgYXR0cmlidXRlcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PWxhbWJkYSBlbnRyeTogZW50cnlbMF0uY291bnQoJy4nKSk6CiAgICAgICAgICAgIGFyZ3MgPSBhcmcuc3BsaXQoJy4nKQogICAgICAgICAgICBmaW5hbCA9IGFyZ3MucG9wKCkKICAgICAgICAgICAgb2JqID0gc2VsZgogICAgICAgICAgICBmb3IgZW50cnkgaW4gYXJnczoKICAgICAgICAgICAgICAgIG9iaiA9IGdldGF0dHIob2JqLCBlbnRyeSkKICAgICAgICAgICAgc2V0YXR0cihvYmosIGZpbmFsLCB2YWwpCgoKICAgIGRlZiBfX2dldGF0dHJfXyhzZWxmLCBuYW1lKToKICAgICAgICBpZiBuYW1lID09ICdfbW9ja19tZXRob2RzJzoKICAgICAgICAgICAgcmFpc2UgQXR0cmlidXRlRXJyb3IobmFtZSkKICAgICAgICBlbGlmIHNlbGYuX21vY2tfbWV0aG9kcyBpcyBub3QgTm9uZToKICAgICAgICAgICAgaWYgbmFtZSBub3QgaW4gc2VsZi5fbW9ja19tZXRob2RzIG9yIG5hbWUgaW4gX2FsbF9tYWdpY3M6CiAgICAgICAgICAgICAgICByYWlzZSBBdHRyaWJ1dGVFcnJvcigiTW9jayBvYmplY3QgaGFzIG5vIGF0dHJpYnV0ZSAlciIgJSBuYW1lKQogICAgICAgIGVsaWYgX2lzX21hZ2ljKG5hbWUpOgogICAgICAgICAgICByYWlzZSBBdHRyaWJ1dGVFcnJvcihuYW1lKQoKICAgICAgICByZXN1bHQgPSBzZWxmLl9tb2NrX2NoaWxkcmVuLmdldChuYW1lKQogICAgICAgIGlmIHJlc3VsdCBpcyBfZGVsZXRlZDoKICAgICAgICAgICAgcmFpc2UgQXR0cmlidXRlRXJyb3IobmFtZSkKICAgICAgICBlbGlmIHJlc3VsdCBpcyBOb25lOgogICAgICAgICAgICB3cmFwcyA9IE5vbmUKICAgICAgICAgICAgaWYgc2VsZi5fbW9ja193cmFwcyBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICMgWFhYWCBzaG91bGQgd2UgZ2V0IHRoZSBhdHRyaWJ1dGUgd2l0aG91dCB0cmlnZ2VyaW5nIGNvZGUKICAgICAgICAgICAgICAgICMgZXhlY3V0aW9uPwogICAgICAgICAgICAgICAgd3JhcHMgPSBnZXRhdHRyKHNlbGYuX21vY2tfd3JhcHMsIG5hbWUpCgogICAgICAgICAgICByZXN1bHQgPSBzZWxmLl9nZXRfY2hpbGRfbW9jaygKICAgICAgICAgICAgICAgIHBhcmVudD1zZWxmLCBuYW1lPW5hbWUsIHdyYXBzPXdyYXBzLCBfbmV3X25hbWU9bmFtZSwKICAgICAgICAgICAgICAgIF9uZXdfcGFyZW50PXNlbGYKICAgICAgICAgICAgKQogICAgICAgICAgICBzZWxmLl9tb2NrX2NoaWxkcmVuW25hbWVdICA9IHJlc3VsdAoKICAgICAgICBlbGlmIGlzaW5zdGFuY2UocmVzdWx0LCBfU3BlY1N0YXRlKToKICAgICAgICAgICAgcmVzdWx0ID0gY3JlYXRlX2F1dG9zcGVjKAogICAgICAgICAgICAgICAgcmVzdWx0LnNwZWMsIHJlc3VsdC5zcGVjX3NldCwgcmVzdWx0Lmluc3RhbmNlLAogICAgICAgICAgICAgICAgcmVzdWx0LnBhcmVudCwgcmVzdWx0Lm5hbWUKICAgICAgICAgICAgKQogICAgICAgICAgICBzZWxmLl9tb2NrX2NoaWxkcmVuW25hbWVdICA9IHJlc3VsdAoKICAgICAgICByZXR1cm4gcmVzdWx0CgoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICBfbmFtZV9saXN0ID0gW3NlbGYuX21vY2tfbmV3X25hbWVdCiAgICAgICAgX3BhcmVudCA9IHNlbGYuX21vY2tfbmV3X3BhcmVudAogICAgICAgIGxhc3QgPSBzZWxmCgogICAgICAgIGRvdCA9ICcuJwogICAgICAgIGlmIF9uYW1lX2xpc3QgPT0gWycoKSddOgogICAgICAgICAgICBkb3QgPSAnJwogICAgICAgIHNlZW4gPSBzZXQoKQogICAgICAgIHdoaWxlIF9wYXJlbnQgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGxhc3QgPSBfcGFyZW50CgogICAgICAgICAgICBfbmFtZV9saXN0LmFwcGVuZChfcGFyZW50Ll9tb2NrX25ld19uYW1lICsgZG90KQogICAgICAgICAgICBkb3QgPSAnLicKICAgICAgICAgICAgaWYgX3BhcmVudC5fbW9ja19uZXdfbmFtZSA9PSAnKCknOgogICAgICAgICAgICAgICAgZG90ID0gJycKCiAgICAgICAgICAgIF9wYXJlbnQgPSBfcGFyZW50Ll9tb2NrX25ld19wYXJlbnQKCiAgICAgICAgICAgICMgdXNlIGlkcyBoZXJlIHNvIGFzIG5vdCB0byBjYWxsIF9faGFzaF9fIG9uIHRoZSBtb2NrcwogICAgICAgICAgICBpZiBpZChfcGFyZW50KSBpbiBzZWVuOgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgc2Vlbi5hZGQoaWQoX3BhcmVudCkpCgogICAgICAgIF9uYW1lX2xpc3QgPSBsaXN0KHJldmVyc2VkKF9uYW1lX2xpc3QpKQogICAgICAgIF9maXJzdCA9IGxhc3QuX21vY2tfbmFtZSBvciAnbW9jaycKICAgICAgICBpZiBsZW4oX25hbWVfbGlzdCkgPiAxOgogICAgICAgICAgICBpZiBfbmFtZV9saXN0WzFdIG5vdCBpbiAoJygpJywgJygpLicpOgogICAgICAgICAgICAgICAgX2ZpcnN0ICs9ICcuJwogICAgICAgIF9uYW1lX2xpc3RbMF0gPSBfZmlyc3QKICAgICAgICBuYW1lID0gJycuam9pbihfbmFtZV9saXN0KQoKICAgICAgICBuYW1lX3N0cmluZyA9ICcnCiAgICAgICAgaWYgbmFtZSBub3QgaW4gKCdtb2NrJywgJ21vY2suJyk6CiAgICAgICAgICAgIG5hbWVfc3RyaW5nID0gJyBuYW1lPSVyJyAlIG5hbWUKCiAgICAgICAgc3BlY19zdHJpbmcgPSAnJwogICAgICAgIGlmIHNlbGYuX3NwZWNfY2xhc3MgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHNwZWNfc3RyaW5nID0gJyBzcGVjPSVyJwogICAgICAgICAgICBpZiBzZWxmLl9zcGVjX3NldDoKICAgICAgICAgICAgICAgIHNwZWNfc3RyaW5nID0gJyBzcGVjX3NldD0lcicKICAgICAgICAgICAgc3BlY19zdHJpbmcgPSBzcGVjX3N0cmluZyAlIHNlbGYuX3NwZWNfY2xhc3MuX19uYW1lX18KICAgICAgICByZXR1cm4gIjwlcyVzJXMgaWQ9JyVzJz4iICUgKAogICAgICAgICAgICB0eXBlKHNlbGYpLl9fbmFtZV9fLAogICAgICAgICAgICBuYW1lX3N0cmluZywKICAgICAgICAgICAgc3BlY19zdHJpbmcsCiAgICAgICAgICAgIGlkKHNlbGYpCiAgICAgICAgKQoKCiAgICBkZWYgX19kaXJfXyhzZWxmKToKICAgICAgICAiIiJGaWx0ZXIgdGhlIG91dHB1dCBvZiBgZGlyKG1vY2spYCB0byBvbmx5IHVzZWZ1bCBtZW1iZXJzLiIiIgogICAgICAgIGlmIG5vdCBGSUxURVJfRElSOgogICAgICAgICAgICByZXR1cm4gb2JqZWN0Ll9fZGlyX18oc2VsZikKCiAgICAgICAgZXh0cmFzID0gc2VsZi5fbW9ja19tZXRob2RzIG9yIFtdCiAgICAgICAgZnJvbV90eXBlID0gZGlyKHR5cGUoc2VsZikpCiAgICAgICAgZnJvbV9kaWN0ID0gbGlzdChzZWxmLl9fZGljdF9fKQoKICAgICAgICBmcm9tX3R5cGUgPSBbZSBmb3IgZSBpbiBmcm9tX3R5cGUgaWYgbm90IGUuc3RhcnRzd2l0aCgnXycpXQogICAgICAgIGZyb21fZGljdCA9IFtlIGZvciBlIGluIGZyb21fZGljdCBpZiBub3QgZS5zdGFydHN3aXRoKCdfJykgb3IKICAgICAgICAgICAgICAgICAgICAgX2lzX21hZ2ljKGUpXQogICAgICAgIHJldHVybiBzb3J0ZWQoc2V0KGV4dHJhcyArIGZyb21fdHlwZSArIGZyb21fZGljdCArCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChzZWxmLl9tb2NrX2NoaWxkcmVuKSkpCgoKICAgIGRlZiBfX3NldGF0dHJfXyhzZWxmLCBuYW1lLCB2YWx1ZSk6CiAgICAgICAgaWYgbmFtZSBpbiBfYWxsb3dlZF9uYW1lczoKICAgICAgICAgICAgIyBwcm9wZXJ0eSBzZXR0ZXJzIGdvIHRocm91Z2ggaGVyZQogICAgICAgICAgICByZXR1cm4gb2JqZWN0Ll9fc2V0YXR0cl9fKHNlbGYsIG5hbWUsIHZhbHVlKQogICAgICAgIGVsaWYgKHNlbGYuX3NwZWNfc2V0IGFuZCBzZWxmLl9tb2NrX21ldGhvZHMgaXMgbm90IE5vbmUgYW5kCiAgICAgICAgICAgIG5hbWUgbm90IGluIHNlbGYuX21vY2tfbWV0aG9kcyBhbmQKICAgICAgICAgICAgbmFtZSBub3QgaW4gc2VsZi5fX2RpY3RfXyk6CiAgICAgICAgICAgIHJhaXNlIEF0dHJpYnV0ZUVycm9yKCJNb2NrIG9iamVjdCBoYXMgbm8gYXR0cmlidXRlICclcyciICUgbmFtZSkKICAgICAgICBlbGlmIG5hbWUgaW4gX3Vuc3VwcG9ydGVkX21hZ2ljczoKICAgICAgICAgICAgbXNnID0gJ0F0dGVtcHRpbmcgdG8gc2V0IHVuc3VwcG9ydGVkIG1hZ2ljIG1ldGhvZCAlci4nICUgbmFtZQogICAgICAgICAgICByYWlzZSBBdHRyaWJ1dGVFcnJvcihtc2cpCiAgICAgICAgZWxpZiBuYW1lIGluIF9hbGxfbWFnaWNzOgogICAgICAgICAgICBpZiBzZWxmLl9tb2NrX21ldGhvZHMgaXMgbm90IE5vbmUgYW5kIG5hbWUgbm90IGluIHNlbGYuX21vY2tfbWV0aG9kczoKICAgICAgICAgICAgICAgIHJhaXNlIEF0dHJpYnV0ZUVycm9yKCJNb2NrIG9iamVjdCBoYXMgbm8gYXR0cmlidXRlICclcyciICUgbmFtZSkKCiAgICAgICAgICAgIGlmIG5vdCBfaXNfaW5zdGFuY2VfbW9jayh2YWx1ZSk6CiAgICAgICAgICAgICAgICBzZXRhdHRyKHR5cGUoc2VsZiksIG5hbWUsIF9nZXRfbWV0aG9kKG5hbWUsIHZhbHVlKSkKICAgICAgICAgICAgICAgIG9yaWdpbmFsID0gdmFsdWUKICAgICAgICAgICAgICAgIHZhbHVlID0gbGFtYmRhICphcmdzLCAqKmt3OiBvcmlnaW5hbChzZWxmLCAqYXJncywgKiprdykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICMgb25seSBzZXQgX25ld19uYW1lIGFuZCBub3QgbmFtZSBzbyB0aGF0IG1vY2tfY2FsbHMgaXMgdHJhY2tlZAogICAgICAgICAgICAgICAgIyBidXQgbm90IG1ldGhvZCBjYWxscwogICAgICAgICAgICAgICAgX2NoZWNrX2FuZF9zZXRfcGFyZW50KHNlbGYsIHZhbHVlLCBOb25lLCBuYW1lKQogICAgICAgICAgICAgICAgc2V0YXR0cih0eXBlKHNlbGYpLCBuYW1lLCB2YWx1ZSkKICAgICAgICAgICAgICAgIHNlbGYuX21vY2tfY2hpbGRyZW5bbmFtZV0gPSB2YWx1ZQogICAgICAgIGVsaWYgbmFtZSA9PSAnX19jbGFzc19fJzoKICAgICAgICAgICAgc2VsZi5fc3BlY19jbGFzcyA9IHZhbHVlCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIF9jaGVja19hbmRfc2V0X3BhcmVudChzZWxmLCB2YWx1ZSwgbmFtZSwgbmFtZSk6CiAgICAgICAgICAgICAgICBzZWxmLl9tb2NrX2NoaWxkcmVuW25hbWVdID0gdmFsdWUKICAgICAgICByZXR1cm4gb2JqZWN0Ll9fc2V0YXR0cl9fKHNlbGYsIG5hbWUsIHZhbHVlKQoKCiAgICBkZWYgX19kZWxhdHRyX18oc2VsZiwgbmFtZSk6CiAgICAgICAgaWYgbmFtZSBpbiBfYWxsX21hZ2ljcyBhbmQgbmFtZSBpbiB0eXBlKHNlbGYpLl9fZGljdF9fOgogICAgICAgICAgICBkZWxhdHRyKHR5cGUoc2VsZiksIG5hbWUpCiAgICAgICAgICAgIGlmIG5hbWUgbm90IGluIHNlbGYuX19kaWN0X186CiAgICAgICAgICAgICAgICAjIGZvciBtYWdpYyBtZXRob2RzIHRoYXQgYXJlIHN0aWxsIE1hZ2ljUHJveHkgb2JqZWN0cyBhbmQKICAgICAgICAgICAgICAgICMgbm90IHNldCBvbiB0aGUgaW5zdGFuY2UgaXRzZWxmCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgbmFtZSBpbiBzZWxmLl9fZGljdF9fOgogICAgICAgICAgICBvYmplY3QuX19kZWxhdHRyX18oc2VsZiwgbmFtZSkKCiAgICAgICAgb2JqID0gc2VsZi5fbW9ja19jaGlsZHJlbi5nZXQobmFtZSwgX21pc3NpbmcpCiAgICAgICAgaWYgb2JqIGlzIF9kZWxldGVkOgogICAgICAgICAgICByYWlzZSBBdHRyaWJ1dGVFcnJvcihuYW1lKQogICAgICAgIGlmIG9iaiBpcyBub3QgX21pc3Npbmc6CiAgICAgICAgICAgIGRlbCBzZWxmLl9tb2NrX2NoaWxkcmVuW25hbWVdCiAgICAgICAgc2VsZi5fbW9ja19jaGlsZHJlbltuYW1lXSA9IF9kZWxldGVkCgoKCiAgICBkZWYgX2Zvcm1hdF9tb2NrX2NhbGxfc2lnbmF0dXJlKHNlbGYsIGFyZ3MsIGt3YXJncyk6CiAgICAgICAgbmFtZSA9IHNlbGYuX21vY2tfbmFtZSBvciAnbW9jaycKICAgICAgICByZXR1cm4gX2Zvcm1hdF9jYWxsX3NpZ25hdHVyZShuYW1lLCBhcmdzLCBrd2FyZ3MpCgoKICAgIGRlZiBfZm9ybWF0X21vY2tfZmFpbHVyZV9tZXNzYWdlKHNlbGYsIGFyZ3MsIGt3YXJncyk6CiAgICAgICAgbWVzc2FnZSA9ICdFeHBlY3RlZCBjYWxsOiAlc1xuQWN0dWFsIGNhbGw6ICVzJwogICAgICAgIGV4cGVjdGVkX3N0cmluZyA9IHNlbGYuX2Zvcm1hdF9tb2NrX2NhbGxfc2lnbmF0dXJlKGFyZ3MsIGt3YXJncykKICAgICAgICBjYWxsX2FyZ3MgPSBzZWxmLmNhbGxfYXJncwogICAgICAgIGlmIGxlbihjYWxsX2FyZ3MpID09IDM6CiAgICAgICAgICAgIGNhbGxfYXJncyA9IGNhbGxfYXJnc1sxOl0KICAgICAgICBhY3R1YWxfc3RyaW5nID0gc2VsZi5fZm9ybWF0X21vY2tfY2FsbF9zaWduYXR1cmUoKmNhbGxfYXJncykKICAgICAgICByZXR1cm4gbWVzc2FnZSAlIChleHBlY3RlZF9zdHJpbmcsIGFjdHVhbF9zdHJpbmcpCgoKICAgIGRlZiBhc3NlcnRfY2FsbGVkX3dpdGgoX21vY2tfc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAiIiJhc3NlcnQgdGhhdCB0aGUgbW9jayB3YXMgY2FsbGVkIHdpdGggdGhlIHNwZWNpZmllZCBhcmd1bWVudHMuCgogICAgICAgIFJhaXNlcyBhbiBBc3NlcnRpb25FcnJvciBpZiB0aGUgYXJncyBhbmQga2V5d29yZCBhcmdzIHBhc3NlZCBpbiBhcmUKICAgICAgICBkaWZmZXJlbnQgdG8gdGhlIGxhc3QgY2FsbCB0byB0aGUgbW9jay4iIiIKICAgICAgICBzZWxmID0gX21vY2tfc2VsZgogICAgICAgIGlmIHNlbGYuY2FsbF9hcmdzIGlzIE5vbmU6CiAgICAgICAgICAgIGV4cGVjdGVkID0gc2VsZi5fZm9ybWF0X21vY2tfY2FsbF9zaWduYXR1cmUoYXJncywga3dhcmdzKQogICAgICAgICAgICByYWlzZSBBc3NlcnRpb25FcnJvcignRXhwZWN0ZWQgY2FsbDogJXNcbk5vdCBjYWxsZWQnICUgKGV4cGVjdGVkLCkpCgogICAgICAgIGlmIHNlbGYuY2FsbF9hcmdzICE9IChhcmdzLCBrd2FyZ3MpOgogICAgICAgICAgICBtc2cgPSBzZWxmLl9mb3JtYXRfbW9ja19mYWlsdXJlX21lc3NhZ2UoYXJncywga3dhcmdzKQogICAgICAgICAgICByYWlzZSBBc3NlcnRpb25FcnJvcihtc2cpCgoKICAgIGRlZiBhc3NlcnRfY2FsbGVkX29uY2Vfd2l0aChfbW9ja19zZWxmLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgICIiImFzc2VydCB0aGF0IHRoZSBtb2NrIHdhcyBjYWxsZWQgZXhhY3RseSBvbmNlIGFuZCB3aXRoIHRoZSBzcGVjaWZpZWQKICAgICAgICBhcmd1bWVudHMuIiIiCiAgICAgICAgc2VsZiA9IF9tb2NrX3NlbGYKICAgICAgICBpZiBub3Qgc2VsZi5jYWxsX2NvdW50ID09IDE6CiAgICAgICAgICAgIG1zZyA9ICgiRXhwZWN0ZWQgdG8gYmUgY2FsbGVkIG9uY2UuIENhbGxlZCAlcyB0aW1lcy4iICUKICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsbF9jb3VudCkKICAgICAgICAgICAgcmFpc2UgQXNzZXJ0aW9uRXJyb3IobXNnKQogICAgICAgIHJldHVybiBzZWxmLmFzc2VydF9jYWxsZWRfd2l0aCgqYXJncywgKiprd2FyZ3MpCgoKICAgIGRlZiBhc3NlcnRfaGFzX2NhbGxzKHNlbGYsIGNhbGxzLCBhbnlfb3JkZXI9RmFsc2UpOgogICAgICAgICIiImFzc2VydCB0aGUgbW9jayBoYXMgYmVlbiBjYWxsZWQgd2l0aCB0aGUgc3BlY2lmaWVkIGNhbGxzLgogICAgICAgIFRoZSBgbW9ja19jYWxsc2AgbGlzdCBpcyBjaGVja2VkIGZvciB0aGUgY2FsbHMuCgogICAgICAgIElmIGBhbnlfb3JkZXJgIGlzIEZhbHNlICh0aGUgZGVmYXVsdCkgdGhlbiB0aGUgY2FsbHMgbXVzdCBiZQogICAgICAgIHNlcXVlbnRpYWwuIFRoZXJlIGNhbiBiZSBleHRyYSBjYWxscyBiZWZvcmUgb3IgYWZ0ZXIgdGhlCiAgICAgICAgc3BlY2lmaWVkIGNhbGxzLgoKICAgICAgICBJZiBgYW55X29yZGVyYCBpcyBUcnVlIHRoZW4gdGhlIGNhbGxzIGNhbiBiZSBpbiBhbnkgb3JkZXIsIGJ1dAogICAgICAgIHRoZXkgbXVzdCBhbGwgYXBwZWFyIGluIGBtb2NrX2NhbGxzYC4iIiIKICAgICAgICBpZiBub3QgYW55X29yZGVyOgogICAgICAgICAgICBpZiBjYWxscyBub3QgaW4gc2VsZi5tb2NrX2NhbGxzOgogICAgICAgICAgICAgICAgcmFpc2UgQXNzZXJ0aW9uRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgJ0NhbGxzIG5vdCBmb3VuZC5cbkV4cGVjdGVkOiAlclxuJwogICAgICAgICAgICAgICAgICAgICdBY3R1YWw6ICVyJyAlIChjYWxscywgc2VsZi5tb2NrX2NhbGxzKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgYWxsX2NhbGxzID0gbGlzdChzZWxmLm1vY2tfY2FsbHMpCgogICAgICAgIG5vdF9mb3VuZCA9IFtdCiAgICAgICAgZm9yIGthbGwgaW4gY2FsbHM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGFsbF9jYWxscy5yZW1vdmUoa2FsbCkKICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgICAgICBub3RfZm91bmQuYXBwZW5kKGthbGwpCiAgICAgICAgaWYgbm90X2ZvdW5kOgogICAgICAgICAgICByYWlzZSBBc3NlcnRpb25FcnJvcigKICAgICAgICAgICAgICAgICclciBub3QgYWxsIGZvdW5kIGluIGNhbGwgbGlzdCcgJSAodHVwbGUobm90X2ZvdW5kKSwpCiAgICAgICAgICAgICkKCgogICAgZGVmIGFzc2VydF9hbnlfY2FsbChzZWxmLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgICIiImFzc2VydCB0aGUgbW9jayBoYXMgYmVlbiBjYWxsZWQgd2l0aCB0aGUgc3BlY2lmaWVkIGFyZ3VtZW50cy4KCiAgICAgICAgVGhlIGFzc2VydCBwYXNzZXMgaWYgdGhlIG1vY2sgaGFzICpldmVyKiBiZWVuIGNhbGxlZCwgdW5saWtlCiAgICAgICAgYGFzc2VydF9jYWxsZWRfd2l0aGAgYW5kIGBhc3NlcnRfY2FsbGVkX29uY2Vfd2l0aGAgdGhhdCBvbmx5IHBhc3MgaWYKICAgICAgICB0aGUgY2FsbCBpcyB0aGUgbW9zdCByZWNlbnQgb25lLiIiIgogICAgICAgIGthbGwgPSBjYWxsKCphcmdzLCAqKmt3YXJncykKICAgICAgICBpZiBrYWxsIG5vdCBpbiBzZWxmLmNhbGxfYXJnc19saXN0OgogICAgICAgICAgICBleHBlY3RlZF9zdHJpbmcgPSBzZWxmLl9mb3JtYXRfbW9ja19jYWxsX3NpZ25hdHVyZShhcmdzLCBrd2FyZ3MpCiAgICAgICAgICAgIHJhaXNlIEFzc2VydGlvbkVycm9yKAogICAgICAgICAgICAgICAgJyVzIGNhbGwgbm90IGZvdW5kJyAlIGV4cGVjdGVkX3N0cmluZwogICAgICAgICAgICApCgoKICAgIGRlZiBfZ2V0X2NoaWxkX21vY2soc2VsZiwgKiprdyk6CiAgICAgICAgIiIiQ3JlYXRlIHRoZSBjaGlsZCBtb2NrcyBmb3IgYXR0cmlidXRlcyBhbmQgcmV0dXJuIHZhbHVlLgogICAgICAgIEJ5IGRlZmF1bHQgY2hpbGQgbW9ja3Mgd2lsbCBiZSB0aGUgc2FtZSB0eXBlIGFzIHRoZSBwYXJlbnQuCiAgICAgICAgU3ViY2xhc3NlcyBvZiBNb2NrIG1heSB3YW50IHRvIG92ZXJyaWRlIHRoaXMgdG8gY3VzdG9taXplIHRoZSB3YXkKICAgICAgICBjaGlsZCBtb2NrcyBhcmUgbWFkZS4KCiAgICAgICAgRm9yIG5vbi1jYWxsYWJsZSBtb2NrcyB0aGUgY2FsbGFibGUgdmFyaWFudCB3aWxsIGJlIHVzZWQgKHJhdGhlciB0aGFuCiAgICAgICAgYW55IGN1c3RvbSBzdWJjbGFzcykuIiIiCiAgICAgICAgX3R5cGUgPSB0eXBlKHNlbGYpCiAgICAgICAgaWYgbm90IGlzc3ViY2xhc3MoX3R5cGUsIENhbGxhYmxlTWl4aW4pOgogICAgICAgICAgICBpZiBpc3N1YmNsYXNzKF90eXBlLCBOb25DYWxsYWJsZU1hZ2ljTW9jayk6CiAgICAgICAgICAgICAgICBrbGFzcyA9IE1hZ2ljTW9jawogICAgICAgICAgICBlbGlmIGlzc3ViY2xhc3MoX3R5cGUsIE5vbkNhbGxhYmxlTW9jaykgOgogICAgICAgICAgICAgICAga2xhc3MgPSBNb2NrCiAgICAgICAgZWxzZToKICAgICAgICAgICAga2xhc3MgPSBfdHlwZS5fX21yb19fWzFdCiAgICAgICAgcmV0dXJuIGtsYXNzKCoqa3cpCgoKCmRlZiBfdHJ5X2l0ZXIob2JqKToKICAgIGlmIG9iaiBpcyBOb25lOgogICAgICAgIHJldHVybiBvYmoKICAgIGlmIF9pc19leGNlcHRpb24ob2JqKToKICAgICAgICByZXR1cm4gb2JqCiAgICBpZiBfY2FsbGFibGUob2JqKToKICAgICAgICByZXR1cm4gb2JqCiAgICB0cnk6CiAgICAgICAgcmV0dXJuIGl0ZXIob2JqKQogICAgZXhjZXB0IFR5cGVFcnJvcjoKICAgICAgICAjIFhYWFggYmFja3dhcmRzIGNvbXBhdGliaWxpdHkKICAgICAgICAjIGJ1dCB0aGlzIHdpbGwgYmxvdyB1cCBvbiBmaXJzdCBjYWxsIC0gc28gbWF5YmUgd2Ugc2hvdWxkIGZhaWwgZWFybHk/CiAgICAgICAgcmV0dXJuIG9iagoKCgpjbGFzcyBDYWxsYWJsZU1peGluKEJhc2UpOgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzcGVjPU5vbmUsIHNpZGVfZWZmZWN0PU5vbmUsIHJldHVybl92YWx1ZT1ERUZBVUxULAogICAgICAgICAgICAgICAgIHdyYXBzPU5vbmUsIG5hbWU9Tm9uZSwgc3BlY19zZXQ9Tm9uZSwgcGFyZW50PU5vbmUsCiAgICAgICAgICAgICAgICAgX3NwZWNfc3RhdGU9Tm9uZSwgX25ld19uYW1lPScnLCBfbmV3X3BhcmVudD1Ob25lLCAqKmt3YXJncyk6CiAgICAgICAgc2VsZi5fX2RpY3RfX1snX21vY2tfcmV0dXJuX3ZhbHVlJ10gPSByZXR1cm5fdmFsdWUKCiAgICAgICAgX3NhZmVfc3VwZXIoQ2FsbGFibGVNaXhpbiwgc2VsZikuX19pbml0X18oCiAgICAgICAgICAgIHNwZWMsIHdyYXBzLCBuYW1lLCBzcGVjX3NldCwgcGFyZW50LAogICAgICAgICAgICBfc3BlY19zdGF0ZSwgX25ld19uYW1lLCBfbmV3X3BhcmVudCwgKiprd2FyZ3MKICAgICAgICApCgogICAgICAgIHNlbGYuc2lkZV9lZmZlY3QgPSBzaWRlX2VmZmVjdAoKCiAgICBkZWYgX21vY2tfY2hlY2tfc2lnKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgIyBzdHViIG1ldGhvZCB0aGF0IGNhbiBiZSByZXBsYWNlZCB3aXRoIG9uZSB3aXRoIGEgc3BlY2lmaWMgc2lnbmF0dXJlCiAgICAgICAgcGFzcwoKCiAgICBkZWYgX19jYWxsX18oX21vY2tfc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAjIGNhbid0IHVzZSBzZWxmIGluLWNhc2UgYSBmdW5jdGlvbiAvIG1ldGhvZCB3ZSBhcmUgbW9ja2luZyB1c2VzIHNlbGYKICAgICAgICAjIGluIHRoZSBzaWduYXR1cmUKICAgICAgICBfbW9ja19zZWxmLl9tb2NrX2NoZWNrX3NpZygqYXJncywgKiprd2FyZ3MpCiAgICAgICAgcmV0dXJuIF9tb2NrX3NlbGYuX21vY2tfY2FsbCgqYXJncywgKiprd2FyZ3MpCgoKICAgIGRlZiBfbW9ja19jYWxsKF9tb2NrX3NlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgc2VsZiA9IF9tb2NrX3NlbGYKICAgICAgICBzZWxmLmNhbGxlZCA9IFRydWUKICAgICAgICBzZWxmLmNhbGxfY291bnQgKz0gMQogICAgICAgIHNlbGYuY2FsbF9hcmdzID0gX0NhbGwoKGFyZ3MsIGt3YXJncyksIHR3bz1UcnVlKQogICAgICAgIHNlbGYuY2FsbF9hcmdzX2xpc3QuYXBwZW5kKF9DYWxsKChhcmdzLCBrd2FyZ3MpLCB0d289VHJ1ZSkpCgogICAgICAgIF9uZXdfbmFtZSA9IHNlbGYuX21vY2tfbmV3X25hbWUKICAgICAgICBfbmV3X3BhcmVudCA9IHNlbGYuX21vY2tfbmV3X3BhcmVudAogICAgICAgIHNlbGYubW9ja19jYWxscy5hcHBlbmQoX0NhbGwoKCcnLCBhcmdzLCBrd2FyZ3MpKSkKCiAgICAgICAgc2VlbiA9IHNldCgpCiAgICAgICAgc2tpcF9uZXh0X2RvdCA9IF9uZXdfbmFtZSA9PSAnKCknCiAgICAgICAgZG9fbWV0aG9kX2NhbGxzID0gc2VsZi5fbW9ja19wYXJlbnQgaXMgbm90IE5vbmUKICAgICAgICBuYW1lID0gc2VsZi5fbW9ja19uYW1lCiAgICAgICAgd2hpbGUgX25ld19wYXJlbnQgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHRoaXNfbW9ja19jYWxsID0gX0NhbGwoKF9uZXdfbmFtZSwgYXJncywga3dhcmdzKSkKICAgICAgICAgICAgaWYgX25ld19wYXJlbnQuX21vY2tfbmV3X25hbWU6CiAgICAgICAgICAgICAgICBkb3QgPSAnLicKICAgICAgICAgICAgICAgIGlmIHNraXBfbmV4dF9kb3Q6CiAgICAgICAgICAgICAgICAgICAgZG90ID0gJycKCiAgICAgICAgICAgICAgICBza2lwX25leHRfZG90ID0gRmFsc2UKICAgICAgICAgICAgICAgIGlmIF9uZXdfcGFyZW50Ll9tb2NrX25ld19uYW1lID09ICcoKSc6CiAgICAgICAgICAgICAgICAgICAgc2tpcF9uZXh0X2RvdCA9IFRydWUKCiAgICAgICAgICAgICAgICBfbmV3X25hbWUgPSBfbmV3X3BhcmVudC5fbW9ja19uZXdfbmFtZSArIGRvdCArIF9uZXdfbmFtZQoKICAgICAgICAgICAgaWYgZG9fbWV0aG9kX2NhbGxzOgogICAgICAgICAgICAgICAgaWYgX25ld19uYW1lID09IG5hbWU6CiAgICAgICAgICAgICAgICAgICAgdGhpc19tZXRob2RfY2FsbCA9IHRoaXNfbW9ja19jYWxsCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHRoaXNfbWV0aG9kX2NhbGwgPSBfQ2FsbCgobmFtZSwgYXJncywga3dhcmdzKSkKICAgICAgICAgICAgICAgIF9uZXdfcGFyZW50Lm1ldGhvZF9jYWxscy5hcHBlbmQodGhpc19tZXRob2RfY2FsbCkKCiAgICAgICAgICAgICAgICBkb19tZXRob2RfY2FsbHMgPSBfbmV3X3BhcmVudC5fbW9ja19wYXJlbnQgaXMgbm90IE5vbmUKICAgICAgICAgICAgICAgIGlmIGRvX21ldGhvZF9jYWxsczoKICAgICAgICAgICAgICAgICAgICBuYW1lID0gX25ld19wYXJlbnQuX21vY2tfbmFtZSArICcuJyArIG5hbWUKCiAgICAgICAgICAgIF9uZXdfcGFyZW50Lm1vY2tfY2FsbHMuYXBwZW5kKHRoaXNfbW9ja19jYWxsKQogICAgICAgICAgICBfbmV3X3BhcmVudCA9IF9uZXdfcGFyZW50Ll9tb2NrX25ld19wYXJlbnQKCiAgICAgICAgICAgICMgdXNlIGlkcyBoZXJlIHNvIGFzIG5vdCB0byBjYWxsIF9faGFzaF9fIG9uIHRoZSBtb2NrcwogICAgICAgICAgICBfbmV3X3BhcmVudF9pZCA9IGlkKF9uZXdfcGFyZW50KQogICAgICAgICAgICBpZiBfbmV3X3BhcmVudF9pZCBpbiBzZWVuOgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgc2Vlbi5hZGQoX25ld19wYXJlbnRfaWQpCgogICAgICAgIHJldF92YWwgPSBERUZBVUxUCiAgICAgICAgZWZmZWN0ID0gc2VsZi5zaWRlX2VmZmVjdAogICAgICAgIGlmIGVmZmVjdCBpcyBub3QgTm9uZToKICAgICAgICAgICAgaWYgX2lzX2V4Y2VwdGlvbihlZmZlY3QpOgogICAgICAgICAgICAgICAgcmFpc2UgZWZmZWN0CgogICAgICAgICAgICBpZiBub3QgX2NhbGxhYmxlKGVmZmVjdCk6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBuZXh0KGVmZmVjdCkKICAgICAgICAgICAgICAgIGlmIF9pc19leGNlcHRpb24ocmVzdWx0KToKICAgICAgICAgICAgICAgICAgICByYWlzZSByZXN1bHQKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQKCiAgICAgICAgICAgIHJldF92YWwgPSBlZmZlY3QoKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBpZiByZXRfdmFsIGlzIERFRkFVTFQ6CiAgICAgICAgICAgICAgICByZXRfdmFsID0gc2VsZi5yZXR1cm5fdmFsdWUKCiAgICAgICAgaWYgKHNlbGYuX21vY2tfd3JhcHMgaXMgbm90IE5vbmUgYW5kCiAgICAgICAgICAgICBzZWxmLl9tb2NrX3JldHVybl92YWx1ZSBpcyBERUZBVUxUKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX21vY2tfd3JhcHMoKmFyZ3MsICoqa3dhcmdzKQogICAgICAgIGlmIHJldF92YWwgaXMgREVGQVVMVDoKICAgICAgICAgICAgcmV0X3ZhbCA9IHNlbGYucmV0dXJuX3ZhbHVlCiAgICAgICAgcmV0dXJuIHJldF92YWwKCgoKY2xhc3MgTW9jayhDYWxsYWJsZU1peGluLCBOb25DYWxsYWJsZU1vY2spOgogICAgIiIiCiAgICBDcmVhdGUgYSBuZXcgYE1vY2tgIG9iamVjdC4gYE1vY2tgIHRha2VzIHNldmVyYWwgb3B0aW9uYWwgYXJndW1lbnRzCiAgICB0aGF0IHNwZWNpZnkgdGhlIGJlaGF2aW91ciBvZiB0aGUgTW9jayBvYmplY3Q6CgogICAgKiBgc3BlY2A6IFRoaXMgY2FuIGJlIGVpdGhlciBhIGxpc3Qgb2Ygc3RyaW5ncyBvciBhbiBleGlzdGluZyBvYmplY3QgKGEKICAgICAgY2xhc3Mgb3IgaW5zdGFuY2UpIHRoYXQgYWN0cyBhcyB0aGUgc3BlY2lmaWNhdGlvbiBmb3IgdGhlIG1vY2sgb2JqZWN0LiBJZgogICAgICB5b3UgcGFzcyBpbiBhbiBvYmplY3QgdGhlbiBhIGxpc3Qgb2Ygc3RyaW5ncyBpcyBmb3JtZWQgYnkgY2FsbGluZyBkaXIgb24KICAgICAgdGhlIG9iamVjdCAoZXhjbHVkaW5nIHVuc3VwcG9ydGVkIG1hZ2ljIGF0dHJpYnV0ZXMgYW5kIG1ldGhvZHMpLiBBY2Nlc3NpbmcKICAgICAgYW55IGF0dHJpYnV0ZSBub3QgaW4gdGhpcyBsaXN0IHdpbGwgcmFpc2UgYW4gYEF0dHJpYnV0ZUVycm9yYC4KCiAgICAgIElmIGBzcGVjYCBpcyBhbiBvYmplY3QgKHJhdGhlciB0aGFuIGEgbGlzdCBvZiBzdHJpbmdzKSB0aGVuCiAgICAgIGBtb2NrLl9fY2xhc3NfX2AgcmV0dXJucyB0aGUgY2xhc3Mgb2YgdGhlIHNwZWMgb2JqZWN0LiBUaGlzIGFsbG93cyBtb2NrcwogICAgICB0byBwYXNzIGBpc2luc3RhbmNlYCB0ZXN0cy4KCiAgICAqIGBzcGVjX3NldGA6IEEgc3RyaWN0ZXIgdmFyaWFudCBvZiBgc3BlY2AuIElmIHVzZWQsIGF0dGVtcHRpbmcgdG8gKnNldCoKICAgICAgb3IgZ2V0IGFuIGF0dHJpYnV0ZSBvbiB0aGUgbW9jayB0aGF0IGlzbid0IG9uIHRoZSBvYmplY3QgcGFzc2VkIGFzCiAgICAgIGBzcGVjX3NldGAgd2lsbCByYWlzZSBhbiBgQXR0cmlidXRlRXJyb3JgLgoKICAgICogYHNpZGVfZWZmZWN0YDogQSBmdW5jdGlvbiB0byBiZSBjYWxsZWQgd2hlbmV2ZXIgdGhlIE1vY2sgaXMgY2FsbGVkLiBTZWUKICAgICAgdGhlIGBzaWRlX2VmZmVjdGAgYXR0cmlidXRlLiBVc2VmdWwgZm9yIHJhaXNpbmcgZXhjZXB0aW9ucyBvcgogICAgICBkeW5hbWljYWxseSBjaGFuZ2luZyByZXR1cm4gdmFsdWVzLiBUaGUgZnVuY3Rpb24gaXMgY2FsbGVkIHdpdGggdGhlIHNhbWUKICAgICAgYXJndW1lbnRzIGFzIHRoZSBtb2NrLCBhbmQgdW5sZXNzIGl0IHJldHVybnMgYERFRkFVTFRgLCB0aGUgcmV0dXJuCiAgICAgIHZhbHVlIG9mIHRoaXMgZnVuY3Rpb24gaXMgdXNlZCBhcyB0aGUgcmV0dXJuIHZhbHVlLgoKICAgICAgSWYgYHNpZGVfZWZmZWN0YCBpcyBhbiBpdGVyYWJsZSB0aGVuIGVhY2ggY2FsbCB0byB0aGUgbW9jayB3aWxsIHJldHVybgogICAgICB0aGUgbmV4dCB2YWx1ZSBmcm9tIHRoZSBpdGVyYWJsZS4gSWYgYW55IG9mIHRoZSBtZW1iZXJzIG9mIHRoZSBpdGVyYWJsZQogICAgICBhcmUgZXhjZXB0aW9ucyB0aGV5IHdpbGwgYmUgcmFpc2VkIGluc3RlYWQgb2YgcmV0dXJuZWQuCgogICAgICBJZiBgc2lkZV9lZmZlY3RgIGlzIGFuIGl0ZXJhYmxlIHRoZW4gZWFjaCBjYWxsIHRvIHRoZSBtb2NrIHdpbGwgcmV0dXJuCiAgICAgIHRoZSBuZXh0IHZhbHVlIGZyb20gdGhlIGl0ZXJhYmxlLgoKICAgICogYHJldHVybl92YWx1ZWA6IFRoZSB2YWx1ZSByZXR1cm5lZCB3aGVuIHRoZSBtb2NrIGlzIGNhbGxlZC4gQnkgZGVmYXVsdAogICAgICB0aGlzIGlzIGEgbmV3IE1vY2sgKGNyZWF0ZWQgb24gZmlyc3QgYWNjZXNzKS4gU2VlIHRoZQogICAgICBgcmV0dXJuX3ZhbHVlYCBhdHRyaWJ1dGUuCgogICAgKiBgd3JhcHNgOiBJdGVtIGZvciB0aGUgbW9jayBvYmplY3QgdG8gd3JhcC4gSWYgYHdyYXBzYCBpcyBub3QgTm9uZSB0aGVuCiAgICAgIGNhbGxpbmcgdGhlIE1vY2sgd2lsbCBwYXNzIHRoZSBjYWxsIHRocm91Z2ggdG8gdGhlIHdyYXBwZWQgb2JqZWN0CiAgICAgIChyZXR1cm5pbmcgdGhlIHJlYWwgcmVzdWx0KS4gQXR0cmlidXRlIGFjY2VzcyBvbiB0aGUgbW9jayB3aWxsIHJldHVybiBhCiAgICAgIE1vY2sgb2JqZWN0IHRoYXQgd3JhcHMgdGhlIGNvcnJlc3BvbmRpbmcgYXR0cmlidXRlIG9mIHRoZSB3cmFwcGVkIG9iamVjdAogICAgICAoc28gYXR0ZW1wdGluZyB0byBhY2Nlc3MgYW4gYXR0cmlidXRlIHRoYXQgZG9lc24ndCBleGlzdCB3aWxsIHJhaXNlIGFuCiAgICAgIGBBdHRyaWJ1dGVFcnJvcmApLgoKICAgICAgSWYgdGhlIG1vY2sgaGFzIGFuIGV4cGxpY2l0IGByZXR1cm5fdmFsdWVgIHNldCB0aGVuIGNhbGxzIGFyZSBub3QgcGFzc2VkCiAgICAgIHRvIHRoZSB3cmFwcGVkIG9iamVjdCBhbmQgdGhlIGByZXR1cm5fdmFsdWVgIGlzIHJldHVybmVkIGluc3RlYWQuCgogICAgKiBgbmFtZWA6IElmIHRoZSBtb2NrIGhhcyBhIG5hbWUgdGhlbiBpdCB3aWxsIGJlIHVzZWQgaW4gdGhlIHJlcHIgb2YgdGhlCiAgICAgIG1vY2suIFRoaXMgY2FuIGJlIHVzZWZ1bCBmb3IgZGVidWdnaW5nLiBUaGUgbmFtZSBpcyBwcm9wYWdhdGVkIHRvIGNoaWxkCiAgICAgIG1vY2tzLgoKICAgIE1vY2tzIGNhbiBhbHNvIGJlIGNhbGxlZCB3aXRoIGFyYml0cmFyeSBrZXl3b3JkIGFyZ3VtZW50cy4gVGhlc2Ugd2lsbCBiZQogICAgdXNlZCB0byBzZXQgYXR0cmlidXRlcyBvbiB0aGUgbW9jayBhZnRlciBpdCBpcyBjcmVhdGVkLgogICAgIiIiCgoKCmRlZiBfZG90X2xvb2t1cCh0aGluZywgY29tcCwgaW1wb3J0X3BhdGgpOgogICAgdHJ5OgogICAgICAgIHJldHVybiBnZXRhdHRyKHRoaW5nLCBjb21wKQogICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgIF9faW1wb3J0X18oaW1wb3J0X3BhdGgpCiAgICAgICAgcmV0dXJuIGdldGF0dHIodGhpbmcsIGNvbXApCgoKZGVmIF9pbXBvcnRlcih0YXJnZXQpOgogICAgY29tcG9uZW50cyA9IHRhcmdldC5zcGxpdCgnLicpCiAgICBpbXBvcnRfcGF0aCA9IGNvbXBvbmVudHMucG9wKDApCiAgICB0aGluZyA9IF9faW1wb3J0X18oaW1wb3J0X3BhdGgpCgogICAgZm9yIGNvbXAgaW4gY29tcG9uZW50czoKICAgICAgICBpbXBvcnRfcGF0aCArPSAiLiVzIiAlIGNvbXAKICAgICAgICB0aGluZyA9IF9kb3RfbG9va3VwKHRoaW5nLCBjb21wLCBpbXBvcnRfcGF0aCkKICAgIHJldHVybiB0aGluZwoKCmRlZiBfaXNfc3RhcnRlZChwYXRjaGVyKToKICAgICMgWFhYWCBob3JyaWJsZQogICAgcmV0dXJuIGhhc2F0dHIocGF0Y2hlciwgJ2lzX2xvY2FsJykKCgpjbGFzcyBfcGF0Y2gob2JqZWN0KToKCiAgICBhdHRyaWJ1dGVfbmFtZSA9IE5vbmUKICAgIF9hY3RpdmVfcGF0Y2hlcyA9IHNldCgpCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgICAgICBzZWxmLCBnZXR0ZXIsIGF0dHJpYnV0ZSwgbmV3LCBzcGVjLCBjcmVhdGUsCiAgICAgICAgICAgIHNwZWNfc2V0LCBhdXRvc3BlYywgbmV3X2NhbGxhYmxlLCBrd2FyZ3MKICAgICAgICApOgogICAgICAgIGlmIG5ld19jYWxsYWJsZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgaWYgbmV3IGlzIG5vdCBERUZBVUxUOgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgICAgICAgICAiQ2Fubm90IHVzZSAnbmV3JyBhbmQgJ25ld19jYWxsYWJsZScgdG9nZXRoZXIiCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGlmIGF1dG9zcGVjIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgICAgICAgICAiQ2Fubm90IHVzZSAnYXV0b3NwZWMnIGFuZCAnbmV3X2NhbGxhYmxlJyB0b2dldGhlciIKICAgICAgICAgICAgICAgICkKCiAgICAgICAgc2VsZi5nZXR0ZXIgPSBnZXR0ZXIKICAgICAgICBzZWxmLmF0dHJpYnV0ZSA9IGF0dHJpYnV0ZQogICAgICAgIHNlbGYubmV3ID0gbmV3CiAgICAgICAgc2VsZi5uZXdfY2FsbGFibGUgPSBuZXdfY2FsbGFibGUKICAgICAgICBzZWxmLnNwZWMgPSBzcGVjCiAgICAgICAgc2VsZi5jcmVhdGUgPSBjcmVhdGUKICAgICAgICBzZWxmLmhhc19sb2NhbCA9IEZhbHNlCiAgICAgICAgc2VsZi5zcGVjX3NldCA9IHNwZWNfc2V0CiAgICAgICAgc2VsZi5hdXRvc3BlYyA9IGF1dG9zcGVjCiAgICAgICAgc2VsZi5rd2FyZ3MgPSBrd2FyZ3MKICAgICAgICBzZWxmLmFkZGl0aW9uYWxfcGF0Y2hlcnMgPSBbXQoKCiAgICBkZWYgY29weShzZWxmKToKICAgICAgICBwYXRjaGVyID0gX3BhdGNoKAogICAgICAgICAgICBzZWxmLmdldHRlciwgc2VsZi5hdHRyaWJ1dGUsIHNlbGYubmV3LCBzZWxmLnNwZWMsCiAgICAgICAgICAgIHNlbGYuY3JlYXRlLCBzZWxmLnNwZWNfc2V0LAogICAgICAgICAgICBzZWxmLmF1dG9zcGVjLCBzZWxmLm5ld19jYWxsYWJsZSwgc2VsZi5rd2FyZ3MKICAgICAgICApCiAgICAgICAgcGF0Y2hlci5hdHRyaWJ1dGVfbmFtZSA9IHNlbGYuYXR0cmlidXRlX25hbWUKICAgICAgICBwYXRjaGVyLmFkZGl0aW9uYWxfcGF0Y2hlcnMgPSBbCiAgICAgICAgICAgIHAuY29weSgpIGZvciBwIGluIHNlbGYuYWRkaXRpb25hbF9wYXRjaGVycwogICAgICAgIF0KICAgICAgICByZXR1cm4gcGF0Y2hlcgoKCiAgICBkZWYgX19jYWxsX18oc2VsZiwgZnVuYyk6CiAgICAgICAgaWYgaXNpbnN0YW5jZShmdW5jLCB0eXBlKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuZGVjb3JhdGVfY2xhc3MoZnVuYykKICAgICAgICByZXR1cm4gc2VsZi5kZWNvcmF0ZV9jYWxsYWJsZShmdW5jKQoKCiAgICBkZWYgZGVjb3JhdGVfY2xhc3Moc2VsZiwga2xhc3MpOgogICAgICAgIGZvciBhdHRyIGluIGRpcihrbGFzcyk6CiAgICAgICAgICAgIGlmIG5vdCBhdHRyLnN0YXJ0c3dpdGgocGF0Y2guVEVTVF9QUkVGSVgpOgogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIGF0dHJfdmFsdWUgPSBnZXRhdHRyKGtsYXNzLCBhdHRyKQogICAgICAgICAgICBpZiBub3QgaGFzYXR0cihhdHRyX3ZhbHVlLCAiX19jYWxsX18iKToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBwYXRjaGVyID0gc2VsZi5jb3B5KCkKICAgICAgICAgICAgc2V0YXR0cihrbGFzcywgYXR0ciwgcGF0Y2hlcihhdHRyX3ZhbHVlKSkKICAgICAgICByZXR1cm4ga2xhc3MKCgogICAgZGVmIGRlY29yYXRlX2NhbGxhYmxlKHNlbGYsIGZ1bmMpOgogICAgICAgIGlmIGhhc2F0dHIoZnVuYywgJ3BhdGNoaW5ncycpOgogICAgICAgICAgICBmdW5jLnBhdGNoaW5ncy5hcHBlbmQoc2VsZikKICAgICAgICAgICAgcmV0dXJuIGZ1bmMKCiAgICAgICAgQHdyYXBzKGZ1bmMpCiAgICAgICAgZGVmIHBhdGNoZWQoKmFyZ3MsICoqa2V5d2FyZ3MpOgogICAgICAgICAgICBleHRyYV9hcmdzID0gW10KICAgICAgICAgICAgZW50ZXJlZF9wYXRjaGVycyA9IFtdCgogICAgICAgICAgICBleGNfaW5mbyA9IHR1cGxlKCkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZm9yIHBhdGNoaW5nIGluIHBhdGNoZWQucGF0Y2hpbmdzOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IHBhdGNoaW5nLl9fZW50ZXJfXygpCiAgICAgICAgICAgICAgICAgICAgZW50ZXJlZF9wYXRjaGVycy5hcHBlbmQocGF0Y2hpbmcpCiAgICAgICAgICAgICAgICAgICAgaWYgcGF0Y2hpbmcuYXR0cmlidXRlX25hbWUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIGtleXdhcmdzLnVwZGF0ZShhcmcpCiAgICAgICAgICAgICAgICAgICAgZWxpZiBwYXRjaGluZy5uZXcgaXMgREVGQVVMVDoKICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFfYXJncy5hcHBlbmQoYXJnKQoKICAgICAgICAgICAgICAgIGFyZ3MgKz0gdHVwbGUoZXh0cmFfYXJncykKICAgICAgICAgICAgICAgIHJldHVybiBmdW5jKCphcmdzLCAqKmtleXdhcmdzKQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBpZiAocGF0Y2hpbmcgbm90IGluIGVudGVyZWRfcGF0Y2hlcnMgYW5kCiAgICAgICAgICAgICAgICAgICAgX2lzX3N0YXJ0ZWQocGF0Y2hpbmcpKToKICAgICAgICAgICAgICAgICAgICAjIHRoZSBwYXRjaGVyIG1heSBoYXZlIGJlZW4gc3RhcnRlZCwgYnV0IGFuIGV4Y2VwdGlvbgogICAgICAgICAgICAgICAgICAgICMgcmFpc2VkIHdoaWxzdCBlbnRlcmluZyBvbmUgb2YgaXRzIGFkZGl0aW9uYWxfcGF0Y2hlcnMKICAgICAgICAgICAgICAgICAgICBlbnRlcmVkX3BhdGNoZXJzLmFwcGVuZChwYXRjaGluZykKICAgICAgICAgICAgICAgICMgUGFzcyB0aGUgZXhjZXB0aW9uIHRvIF9fZXhpdF9fCiAgICAgICAgICAgICAgICBleGNfaW5mbyA9IHN5cy5leGNfaW5mbygpCiAgICAgICAgICAgICAgICAjIHJlLXJhaXNlIHRoZSBleGNlcHRpb24KICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgICAgICBmb3IgcGF0Y2hpbmcgaW4gcmV2ZXJzZWQoZW50ZXJlZF9wYXRjaGVycyk6CiAgICAgICAgICAgICAgICAgICAgcGF0Y2hpbmcuX19leGl0X18oKmV4Y19pbmZvKQoKICAgICAgICBwYXRjaGVkLnBhdGNoaW5ncyA9IFtzZWxmXQogICAgICAgIHJldHVybiBwYXRjaGVkCgoKICAgIGRlZiBnZXRfb3JpZ2luYWwoc2VsZik6CiAgICAgICAgdGFyZ2V0ID0gc2VsZi5nZXR0ZXIoKQogICAgICAgIG5hbWUgPSBzZWxmLmF0dHJpYnV0ZQoKICAgICAgICBvcmlnaW5hbCA9IERFRkFVTFQKICAgICAgICBsb2NhbCA9IEZhbHNlCgogICAgICAgIHRyeToKICAgICAgICAgICAgb3JpZ2luYWwgPSB0YXJnZXQuX19kaWN0X19bbmFtZV0KICAgICAgICBleGNlcHQgKEF0dHJpYnV0ZUVycm9yLCBLZXlFcnJvcik6CiAgICAgICAgICAgIG9yaWdpbmFsID0gZ2V0YXR0cih0YXJnZXQsIG5hbWUsIERFRkFVTFQpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbG9jYWwgPSBUcnVlCgogICAgICAgIGlmIG5vdCBzZWxmLmNyZWF0ZSBhbmQgb3JpZ2luYWwgaXMgREVGQVVMVDoKICAgICAgICAgICAgcmFpc2UgQXR0cmlidXRlRXJyb3IoCiAgICAgICAgICAgICAgICAiJXMgZG9lcyBub3QgaGF2ZSB0aGUgYXR0cmlidXRlICVyIiAlICh0YXJnZXQsIG5hbWUpCiAgICAgICAgICAgICkKICAgICAgICByZXR1cm4gb3JpZ2luYWwsIGxvY2FsCgoKICAgIGRlZiBfX2VudGVyX18oc2VsZik6CiAgICAgICAgIiIiUGVyZm9ybSB0aGUgcGF0Y2guIiIiCiAgICAgICAgbmV3LCBzcGVjLCBzcGVjX3NldCA9IHNlbGYubmV3LCBzZWxmLnNwZWMsIHNlbGYuc3BlY19zZXQKICAgICAgICBhdXRvc3BlYywga3dhcmdzID0gc2VsZi5hdXRvc3BlYywgc2VsZi5rd2FyZ3MKICAgICAgICBuZXdfY2FsbGFibGUgPSBzZWxmLm5ld19jYWxsYWJsZQogICAgICAgIHNlbGYudGFyZ2V0ID0gc2VsZi5nZXR0ZXIoKQoKICAgICAgICAjIG5vcm1hbGlzZSBGYWxzZSB0byBOb25lCiAgICAgICAgaWYgc3BlYyBpcyBGYWxzZToKICAgICAgICAgICAgc3BlYyA9IE5vbmUKICAgICAgICBpZiBzcGVjX3NldCBpcyBGYWxzZToKICAgICAgICAgICAgc3BlY19zZXQgPSBOb25lCiAgICAgICAgaWYgYXV0b3NwZWMgaXMgRmFsc2U6CiAgICAgICAgICAgIGF1dG9zcGVjID0gTm9uZQoKICAgICAgICBpZiBzcGVjIGlzIG5vdCBOb25lIGFuZCBhdXRvc3BlYyBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJDYW4ndCBzcGVjaWZ5IHNwZWMgYW5kIGF1dG9zcGVjIikKICAgICAgICBpZiAoKHNwZWMgaXMgbm90IE5vbmUgb3IgYXV0b3NwZWMgaXMgbm90IE5vbmUpIGFuZAogICAgICAgICAgICBzcGVjX3NldCBub3QgaW4gKFRydWUsIE5vbmUpKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJDYW4ndCBwcm92aWRlIGV4cGxpY2l0IHNwZWNfc2V0ICphbmQqIHNwZWMgb3IgYXV0b3NwZWMiKQoKICAgICAgICBvcmlnaW5hbCwgbG9jYWwgPSBzZWxmLmdldF9vcmlnaW5hbCgpCgogICAgICAgIGlmIG5ldyBpcyBERUZBVUxUIGFuZCBhdXRvc3BlYyBpcyBOb25lOgogICAgICAgICAgICBpbmhlcml0ID0gRmFsc2UKICAgICAgICAgICAgaWYgc3BlYyBpcyBUcnVlOgogICAgICAgICAgICAgICAgIyBzZXQgc3BlYyB0byB0aGUgb2JqZWN0IHdlIGFyZSByZXBsYWNpbmcKICAgICAgICAgICAgICAgIHNwZWMgPSBvcmlnaW5hbAogICAgICAgICAgICAgICAgaWYgc3BlY19zZXQgaXMgVHJ1ZToKICAgICAgICAgICAgICAgICAgICBzcGVjX3NldCA9IG9yaWdpbmFsCiAgICAgICAgICAgICAgICAgICAgc3BlYyA9IE5vbmUKICAgICAgICAgICAgZWxpZiBzcGVjIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgaWYgc3BlY19zZXQgaXMgVHJ1ZToKICAgICAgICAgICAgICAgICAgICBzcGVjX3NldCA9IHNwZWMKICAgICAgICAgICAgICAgICAgICBzcGVjID0gTm9uZQogICAgICAgICAgICBlbGlmIHNwZWNfc2V0IGlzIFRydWU6CiAgICAgICAgICAgICAgICBzcGVjX3NldCA9IG9yaWdpbmFsCgogICAgICAgICAgICBpZiBzcGVjIGlzIG5vdCBOb25lIG9yIHNwZWNfc2V0IGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgaWYgb3JpZ2luYWwgaXMgREVGQVVMVDoKICAgICAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIkNhbid0IHVzZSAnc3BlYycgd2l0aCBjcmVhdGU9VHJ1ZSIpCiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKG9yaWdpbmFsLCB0eXBlKToKICAgICAgICAgICAgICAgICAgICAjIElmIHdlJ3JlIHBhdGNoaW5nIG91dCBhIGNsYXNzIGFuZCB0aGVyZSBpcyBhIHNwZWMKICAgICAgICAgICAgICAgICAgICBpbmhlcml0ID0gVHJ1ZQoKICAgICAgICAgICAgS2xhc3MgPSBNYWdpY01vY2sKICAgICAgICAgICAgX2t3YXJncyA9IHt9CiAgICAgICAgICAgIGlmIG5ld19jYWxsYWJsZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIEtsYXNzID0gbmV3X2NhbGxhYmxlCiAgICAgICAgICAgIGVsaWYgc3BlYyBpcyBub3QgTm9uZSBvciBzcGVjX3NldCBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHRoaXNfc3BlYyA9IHNwZWMKICAgICAgICAgICAgICAgIGlmIHNwZWNfc2V0IGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIHRoaXNfc3BlYyA9IHNwZWNfc2V0CiAgICAgICAgICAgICAgICBpZiBfaXNfbGlzdCh0aGlzX3NwZWMpOgogICAgICAgICAgICAgICAgICAgIG5vdF9jYWxsYWJsZSA9ICdfX2NhbGxfXycgbm90IGluIHRoaXNfc3BlYwogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBub3RfY2FsbGFibGUgPSBub3QgY2FsbGFibGUodGhpc19zcGVjKQogICAgICAgICAgICAgICAgaWYgbm90X2NhbGxhYmxlOgogICAgICAgICAgICAgICAgICAgIEtsYXNzID0gTm9uQ2FsbGFibGVNYWdpY01vY2sKCiAgICAgICAgICAgIGlmIHNwZWMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBfa3dhcmdzWydzcGVjJ10gPSBzcGVjCiAgICAgICAgICAgIGlmIHNwZWNfc2V0IGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgX2t3YXJnc1snc3BlY19zZXQnXSA9IHNwZWNfc2V0CgogICAgICAgICAgICAjIGFkZCBhIG5hbWUgdG8gbW9ja3MKICAgICAgICAgICAgaWYgKGlzaW5zdGFuY2UoS2xhc3MsIHR5cGUpIGFuZAogICAgICAgICAgICAgICAgaXNzdWJjbGFzcyhLbGFzcywgTm9uQ2FsbGFibGVNb2NrKSBhbmQgc2VsZi5hdHRyaWJ1dGUpOgogICAgICAgICAgICAgICAgX2t3YXJnc1snbmFtZSddID0gc2VsZi5hdHRyaWJ1dGUKCiAgICAgICAgICAgIF9rd2FyZ3MudXBkYXRlKGt3YXJncykKICAgICAgICAgICAgbmV3ID0gS2xhc3MoKipfa3dhcmdzKQoKICAgICAgICAgICAgaWYgaW5oZXJpdCBhbmQgX2lzX2luc3RhbmNlX21vY2sobmV3KToKICAgICAgICAgICAgICAgICMgd2UgY2FuIG9ubHkgdGVsbCBpZiB0aGUgaW5zdGFuY2Ugc2hvdWxkIGJlIGNhbGxhYmxlIGlmIHRoZQogICAgICAgICAgICAgICAgIyBzcGVjIGlzIG5vdCBhIGxpc3QKICAgICAgICAgICAgICAgIHRoaXNfc3BlYyA9IHNwZWMKICAgICAgICAgICAgICAgIGlmIHNwZWNfc2V0IGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIHRoaXNfc3BlYyA9IHNwZWNfc2V0CiAgICAgICAgICAgICAgICBpZiAobm90IF9pc19saXN0KHRoaXNfc3BlYykgYW5kIG5vdAogICAgICAgICAgICAgICAgICAgIF9pbnN0YW5jZV9jYWxsYWJsZSh0aGlzX3NwZWMpKToKICAgICAgICAgICAgICAgICAgICBLbGFzcyA9IE5vbkNhbGxhYmxlTWFnaWNNb2NrCgogICAgICAgICAgICAgICAgX2t3YXJncy5wb3AoJ25hbWUnKQogICAgICAgICAgICAgICAgbmV3LnJldHVybl92YWx1ZSA9IEtsYXNzKF9uZXdfcGFyZW50PW5ldywgX25ld19uYW1lPScoKScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKipfa3dhcmdzKQogICAgICAgIGVsaWYgYXV0b3NwZWMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICMgc3BlYyBpcyBpZ25vcmVkLCBuZXcgKm11c3QqIGJlIGRlZmF1bHQsIHNwZWNfc2V0IGlzIHRyZWF0ZWQKICAgICAgICAgICAgIyBhcyBhIGJvb2xlYW4uIFNob3VsZCB3ZSBjaGVjayBzcGVjIGlzIG5vdCBOb25lIGFuZCB0aGF0IHNwZWNfc2V0CiAgICAgICAgICAgICMgaXMgYSBib29sPwogICAgICAgICAgICBpZiBuZXcgaXMgbm90IERFRkFVTFQ6CiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgImF1dG9zcGVjIGNyZWF0ZXMgdGhlIG1vY2sgZm9yIHlvdS4gQ2FuJ3Qgc3BlY2lmeSAiCiAgICAgICAgICAgICAgICAgICAgImF1dG9zcGVjIGFuZCBuZXcuIgogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBpZiBvcmlnaW5hbCBpcyBERUZBVUxUOgogICAgICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJDYW4ndCB1c2UgJ2F1dG9zcGVjJyB3aXRoIGNyZWF0ZT1UcnVlIikKICAgICAgICAgICAgc3BlY19zZXQgPSBib29sKHNwZWNfc2V0KQogICAgICAgICAgICBpZiBhdXRvc3BlYyBpcyBUcnVlOgogICAgICAgICAgICAgICAgYXV0b3NwZWMgPSBvcmlnaW5hbAoKICAgICAgICAgICAgbmV3ID0gY3JlYXRlX2F1dG9zcGVjKGF1dG9zcGVjLCBzcGVjX3NldD1zcGVjX3NldCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9uYW1lPXNlbGYuYXR0cmlidXRlLCAqKmt3YXJncykKICAgICAgICBlbGlmIGt3YXJnczoKICAgICAgICAgICAgIyBjYW4ndCBzZXQga2V5d29yZCBhcmdzIHdoZW4gd2UgYXJlbid0IGNyZWF0aW5nIHRoZSBtb2NrCiAgICAgICAgICAgICMgWFhYWCBJZiBuZXcgaXMgYSBNb2NrIHdlIGNvdWxkIGNhbGwgbmV3LmNvbmZpZ3VyZV9tb2NrKCoqa3dhcmdzKQogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIkNhbid0IHBhc3Mga3dhcmdzIHRvIGEgbW9jayB3ZSBhcmVuJ3QgY3JlYXRpbmciKQoKICAgICAgICBuZXdfYXR0ciA9IG5ldwoKICAgICAgICBzZWxmLnRlbXBfb3JpZ2luYWwgPSBvcmlnaW5hbAogICAgICAgIHNlbGYuaXNfbG9jYWwgPSBsb2NhbAogICAgICAgIHNldGF0dHIoc2VsZi50YXJnZXQsIHNlbGYuYXR0cmlidXRlLCBuZXdfYXR0cikKICAgICAgICBpZiBzZWxmLmF0dHJpYnV0ZV9uYW1lIGlzIG5vdCBOb25lOgogICAgICAgICAgICBleHRyYV9hcmdzID0ge30KICAgICAgICAgICAgaWYgc2VsZi5uZXcgaXMgREVGQVVMVDoKICAgICAgICAgICAgICAgIGV4dHJhX2FyZ3Nbc2VsZi5hdHRyaWJ1dGVfbmFtZV0gPSAgbmV3CiAgICAgICAgICAgIGZvciBwYXRjaGluZyBpbiBzZWxmLmFkZGl0aW9uYWxfcGF0Y2hlcnM6CiAgICAgICAgICAgICAgICBhcmcgPSBwYXRjaGluZy5fX2VudGVyX18oKQogICAgICAgICAgICAgICAgaWYgcGF0Y2hpbmcubmV3IGlzIERFRkFVTFQ6CiAgICAgICAgICAgICAgICAgICAgZXh0cmFfYXJncy51cGRhdGUoYXJnKQogICAgICAgICAgICByZXR1cm4gZXh0cmFfYXJncwoKICAgICAgICByZXR1cm4gbmV3CgoKICAgIGRlZiBfX2V4aXRfXyhzZWxmLCAqZXhjX2luZm8pOgogICAgICAgICIiIlVuZG8gdGhlIHBhdGNoLiIiIgogICAgICAgIGlmIG5vdCBfaXNfc3RhcnRlZChzZWxmKToKICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCdzdG9wIGNhbGxlZCBvbiB1bnN0YXJ0ZWQgcGF0Y2hlcicpCgogICAgICAgIGlmIHNlbGYuaXNfbG9jYWwgYW5kIHNlbGYudGVtcF9vcmlnaW5hbCBpcyBub3QgREVGQVVMVDoKICAgICAgICAgICAgc2V0YXR0cihzZWxmLnRhcmdldCwgc2VsZi5hdHRyaWJ1dGUsIHNlbGYudGVtcF9vcmlnaW5hbCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBkZWxhdHRyKHNlbGYudGFyZ2V0LCBzZWxmLmF0dHJpYnV0ZSkKICAgICAgICAgICAgaWYgbm90IHNlbGYuY3JlYXRlIGFuZCBub3QgaGFzYXR0cihzZWxmLnRhcmdldCwgc2VsZi5hdHRyaWJ1dGUpOgogICAgICAgICAgICAgICAgIyBuZWVkZWQgZm9yIHByb3h5IG9iamVjdHMgbGlrZSBkamFuZ28gc2V0dGluZ3MKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZi50YXJnZXQsIHNlbGYuYXR0cmlidXRlLCBzZWxmLnRlbXBfb3JpZ2luYWwpCgogICAgICAgIGRlbCBzZWxmLnRlbXBfb3JpZ2luYWwKICAgICAgICBkZWwgc2VsZi5pc19sb2NhbAogICAgICAgIGRlbCBzZWxmLnRhcmdldAogICAgICAgIGZvciBwYXRjaGVyIGluIHJldmVyc2VkKHNlbGYuYWRkaXRpb25hbF9wYXRjaGVycyk6CiAgICAgICAgICAgIGlmIF9pc19zdGFydGVkKHBhdGNoZXIpOgogICAgICAgICAgICAgICAgcGF0Y2hlci5fX2V4aXRfXygqZXhjX2luZm8pCgoKICAgIGRlZiBzdGFydChzZWxmKToKICAgICAgICAiIiJBY3RpdmF0ZSBhIHBhdGNoLCByZXR1cm5pbmcgYW55IGNyZWF0ZWQgbW9jay4iIiIKICAgICAgICByZXN1bHQgPSBzZWxmLl9fZW50ZXJfXygpCiAgICAgICAgc2VsZi5fYWN0aXZlX3BhdGNoZXMuYWRkKHNlbGYpCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKCiAgICBkZWYgc3RvcChzZWxmKToKICAgICAgICAiIiJTdG9wIGFuIGFjdGl2ZSBwYXRjaC4iIiIKICAgICAgICBzZWxmLl9hY3RpdmVfcGF0Y2hlcy5kaXNjYXJkKHNlbGYpCiAgICAgICAgcmV0dXJuIHNlbGYuX19leGl0X18oKQoKCgpkZWYgX2dldF90YXJnZXQodGFyZ2V0KToKICAgIHRyeToKICAgICAgICB0YXJnZXQsIGF0dHJpYnV0ZSA9IHRhcmdldC5yc3BsaXQoJy4nLCAxKQogICAgZXhjZXB0IChUeXBlRXJyb3IsIFZhbHVlRXJyb3IpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiTmVlZCBhIHZhbGlkIHRhcmdldCB0byBwYXRjaC4gWW91IHN1cHBsaWVkOiAlciIgJQogICAgICAgICAgICAgICAgICAgICAgICAodGFyZ2V0LCkpCiAgICBnZXR0ZXIgPSBsYW1iZGE6IF9pbXBvcnRlcih0YXJnZXQpCiAgICByZXR1cm4gZ2V0dGVyLCBhdHRyaWJ1dGUKCgpkZWYgX3BhdGNoX29iamVjdCgKICAgICAgICB0YXJnZXQsIGF0dHJpYnV0ZSwgbmV3PURFRkFVTFQsIHNwZWM9Tm9uZSwKICAgICAgICBjcmVhdGU9RmFsc2UsIHNwZWNfc2V0PU5vbmUsIGF1dG9zcGVjPU5vbmUsCiAgICAgICAgbmV3X2NhbGxhYmxlPU5vbmUsICoqa3dhcmdzCiAgICApOgogICAgIiIiCiAgICBwYXRjaCB0aGUgbmFtZWQgbWVtYmVyIChgYXR0cmlidXRlYCkgb24gYW4gb2JqZWN0IChgdGFyZ2V0YCkgd2l0aCBhIG1vY2sKICAgIG9iamVjdC4KCiAgICBgcGF0Y2gub2JqZWN0YCBjYW4gYmUgdXNlZCBhcyBhIGRlY29yYXRvciwgY2xhc3MgZGVjb3JhdG9yIG9yIGEgY29udGV4dAogICAgbWFuYWdlci4gQXJndW1lbnRzIGBuZXdgLCBgc3BlY2AsIGBjcmVhdGVgLCBgc3BlY19zZXRgLAogICAgYGF1dG9zcGVjYCBhbmQgYG5ld19jYWxsYWJsZWAgaGF2ZSB0aGUgc2FtZSBtZWFuaW5nIGFzIGZvciBgcGF0Y2hgLiBMaWtlCiAgICBgcGF0Y2hgLCBgcGF0Y2gub2JqZWN0YCB0YWtlcyBhcmJpdHJhcnkga2V5d29yZCBhcmd1bWVudHMgZm9yIGNvbmZpZ3VyaW5nCiAgICB0aGUgbW9jayBvYmplY3QgaXQgY3JlYXRlcy4KCiAgICBXaGVuIHVzZWQgYXMgYSBjbGFzcyBkZWNvcmF0b3IgYHBhdGNoLm9iamVjdGAgaG9ub3VycyBgcGF0Y2guVEVTVF9QUkVGSVhgCiAgICBmb3IgY2hvb3Npbmcgd2hpY2ggbWV0aG9kcyB0byB3cmFwLgogICAgIiIiCiAgICBnZXR0ZXIgPSBsYW1iZGE6IHRhcmdldAogICAgcmV0dXJuIF9wYXRjaCgKICAgICAgICBnZXR0ZXIsIGF0dHJpYnV0ZSwgbmV3LCBzcGVjLCBjcmVhdGUsCiAgICAgICAgc3BlY19zZXQsIGF1dG9zcGVjLCBuZXdfY2FsbGFibGUsIGt3YXJncwogICAgKQoKCmRlZiBfcGF0Y2hfbXVsdGlwbGUodGFyZ2V0LCBzcGVjPU5vbmUsIGNyZWF0ZT1GYWxzZSwgc3BlY19zZXQ9Tm9uZSwKICAgICAgICAgICAgICAgICAgICBhdXRvc3BlYz1Ob25lLCBuZXdfY2FsbGFibGU9Tm9uZSwgKiprd2FyZ3MpOgogICAgIiIiUGVyZm9ybSBtdWx0aXBsZSBwYXRjaGVzIGluIGEgc2luZ2xlIGNhbGwuIEl0IHRha2VzIHRoZSBvYmplY3QgdG8gYmUKICAgIHBhdGNoZWQgKGVpdGhlciBhcyBhbiBvYmplY3Qgb3IgYSBzdHJpbmcgdG8gZmV0Y2ggdGhlIG9iamVjdCBieSBpbXBvcnRpbmcpCiAgICBhbmQga2V5d29yZCBhcmd1bWVudHMgZm9yIHRoZSBwYXRjaGVzOjoKCiAgICAgICAgd2l0aCBwYXRjaC5tdWx0aXBsZShzZXR0aW5ncywgRklSU1RfUEFUQ0g9J29uZScsIFNFQ09ORF9QQVRDSD0ndHdvJyk6CiAgICAgICAgICAgIC4uLgoKICAgIFVzZSBgREVGQVVMVGAgYXMgdGhlIHZhbHVlIGlmIHlvdSB3YW50IGBwYXRjaC5tdWx0aXBsZWAgdG8gY3JlYXRlCiAgICBtb2NrcyBmb3IgeW91LiBJbiB0aGlzIGNhc2UgdGhlIGNyZWF0ZWQgbW9ja3MgYXJlIHBhc3NlZCBpbnRvIGEgZGVjb3JhdGVkCiAgICBmdW5jdGlvbiBieSBrZXl3b3JkLCBhbmQgYSBkaWN0aW9uYXJ5IGlzIHJldHVybmVkIHdoZW4gYHBhdGNoLm11bHRpcGxlYCBpcwogICAgdXNlZCBhcyBhIGNvbnRleHQgbWFuYWdlci4KCiAgICBgcGF0Y2gubXVsdGlwbGVgIGNhbiBiZSB1c2VkIGFzIGEgZGVjb3JhdG9yLCBjbGFzcyBkZWNvcmF0b3Igb3IgYSBjb250ZXh0CiAgICBtYW5hZ2VyLiBUaGUgYXJndW1lbnRzIGBzcGVjYCwgYHNwZWNfc2V0YCwgYGNyZWF0ZWAsCiAgICBgYXV0b3NwZWNgIGFuZCBgbmV3X2NhbGxhYmxlYCBoYXZlIHRoZSBzYW1lIG1lYW5pbmcgYXMgZm9yIGBwYXRjaGAuIFRoZXNlCiAgICBhcmd1bWVudHMgd2lsbCBiZSBhcHBsaWVkIHRvICphbGwqIHBhdGNoZXMgZG9uZSBieSBgcGF0Y2gubXVsdGlwbGVgLgoKICAgIFdoZW4gdXNlZCBhcyBhIGNsYXNzIGRlY29yYXRvciBgcGF0Y2gubXVsdGlwbGVgIGhvbm91cnMgYHBhdGNoLlRFU1RfUFJFRklYYAogICAgZm9yIGNob29zaW5nIHdoaWNoIG1ldGhvZHMgdG8gd3JhcC4KICAgICIiIgogICAgaWYgdHlwZSh0YXJnZXQpIGlzIHN0cjoKICAgICAgICBnZXR0ZXIgPSBsYW1iZGE6IF9pbXBvcnRlcih0YXJnZXQpCiAgICBlbHNlOgogICAgICAgIGdldHRlciA9IGxhbWJkYTogdGFyZ2V0CgogICAgaWYgbm90IGt3YXJnczoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKAogICAgICAgICAgICAnTXVzdCBzdXBwbHkgYXQgbGVhc3Qgb25lIGtleXdvcmQgYXJndW1lbnQgd2l0aCBwYXRjaC5tdWx0aXBsZScKICAgICAgICApCiAgICAjIG5lZWQgdG8gd3JhcCBpbiBhIGxpc3QgZm9yIHB5dGhvbiAzLCB3aGVyZSBpdGVtcyBpcyBhIHZpZXcKICAgIGl0ZW1zID0gbGlzdChrd2FyZ3MuaXRlbXMoKSkKICAgIGF0dHJpYnV0ZSwgbmV3ID0gaXRlbXNbMF0KICAgIHBhdGNoZXIgPSBfcGF0Y2goCiAgICAgICAgZ2V0dGVyLCBhdHRyaWJ1dGUsIG5ldywgc3BlYywgY3JlYXRlLCBzcGVjX3NldCwKICAgICAgICBhdXRvc3BlYywgbmV3X2NhbGxhYmxlLCB7fQogICAgKQogICAgcGF0Y2hlci5hdHRyaWJ1dGVfbmFtZSA9IGF0dHJpYnV0ZQogICAgZm9yIGF0dHJpYnV0ZSwgbmV3IGluIGl0ZW1zWzE6XToKICAgICAgICB0aGlzX3BhdGNoZXIgPSBfcGF0Y2goCiAgICAgICAgICAgIGdldHRlciwgYXR0cmlidXRlLCBuZXcsIHNwZWMsIGNyZWF0ZSwgc3BlY19zZXQsCiAgICAgICAgICAgIGF1dG9zcGVjLCBuZXdfY2FsbGFibGUsIHt9CiAgICAgICAgKQogICAgICAgIHRoaXNfcGF0Y2hlci5hdHRyaWJ1dGVfbmFtZSA9IGF0dHJpYnV0ZQogICAgICAgIHBhdGNoZXIuYWRkaXRpb25hbF9wYXRjaGVycy5hcHBlbmQodGhpc19wYXRjaGVyKQogICAgcmV0dXJuIHBhdGNoZXIKCgpkZWYgcGF0Y2goCiAgICAgICAgdGFyZ2V0LCBuZXc9REVGQVVMVCwgc3BlYz1Ob25lLCBjcmVhdGU9RmFsc2UsCiAgICAgICAgc3BlY19zZXQ9Tm9uZSwgYXV0b3NwZWM9Tm9uZSwgbmV3X2NhbGxhYmxlPU5vbmUsICoqa3dhcmdzCiAgICApOgogICAgIiIiCiAgICBgcGF0Y2hgIGFjdHMgYXMgYSBmdW5jdGlvbiBkZWNvcmF0b3IsIGNsYXNzIGRlY29yYXRvciBvciBhIGNvbnRleHQKICAgIG1hbmFnZXIuIEluc2lkZSB0aGUgYm9keSBvZiB0aGUgZnVuY3Rpb24gb3Igd2l0aCBzdGF0ZW1lbnQsIHRoZSBgdGFyZ2V0YAogICAgaXMgcGF0Y2hlZCB3aXRoIGEgYG5ld2Agb2JqZWN0LiBXaGVuIHRoZSBmdW5jdGlvbi93aXRoIHN0YXRlbWVudCBleGl0cwogICAgdGhlIHBhdGNoIGlzIHVuZG9uZS4KCiAgICBJZiBgbmV3YCBpcyBvbWl0dGVkLCB0aGVuIHRoZSB0YXJnZXQgaXMgcmVwbGFjZWQgd2l0aCBhCiAgICBgTWFnaWNNb2NrYC4gSWYgYHBhdGNoYCBpcyB1c2VkIGFzIGEgZGVjb3JhdG9yIGFuZCBgbmV3YCBpcwogICAgb21pdHRlZCwgdGhlIGNyZWF0ZWQgbW9jayBpcyBwYXNzZWQgaW4gYXMgYW4gZXh0cmEgYXJndW1lbnQgdG8gdGhlCiAgICBkZWNvcmF0ZWQgZnVuY3Rpb24uIElmIGBwYXRjaGAgaXMgdXNlZCBhcyBhIGNvbnRleHQgbWFuYWdlciB0aGUgY3JlYXRlZAogICAgbW9jayBpcyByZXR1cm5lZCBieSB0aGUgY29udGV4dCBtYW5hZ2VyLgoKICAgIGB0YXJnZXRgIHNob3VsZCBiZSBhIHN0cmluZyBpbiB0aGUgZm9ybSBgJ3BhY2thZ2UubW9kdWxlLkNsYXNzTmFtZSdgLiBUaGUKICAgIGB0YXJnZXRgIGlzIGltcG9ydGVkIGFuZCB0aGUgc3BlY2lmaWVkIG9iamVjdCByZXBsYWNlZCB3aXRoIHRoZSBgbmV3YAogICAgb2JqZWN0LCBzbyB0aGUgYHRhcmdldGAgbXVzdCBiZSBpbXBvcnRhYmxlIGZyb20gdGhlIGVudmlyb25tZW50IHlvdSBhcmUKICAgIGNhbGxpbmcgYHBhdGNoYCBmcm9tLiBUaGUgdGFyZ2V0IGlzIGltcG9ydGVkIHdoZW4gdGhlIGRlY29yYXRlZCBmdW5jdGlvbgogICAgaXMgZXhlY3V0ZWQsIG5vdCBhdCBkZWNvcmF0aW9uIHRpbWUuCgogICAgVGhlIGBzcGVjYCBhbmQgYHNwZWNfc2V0YCBrZXl3b3JkIGFyZ3VtZW50cyBhcmUgcGFzc2VkIHRvIHRoZSBgTWFnaWNNb2NrYAogICAgaWYgcGF0Y2ggaXMgY3JlYXRpbmcgb25lIGZvciB5b3UuCgogICAgSW4gYWRkaXRpb24geW91IGNhbiBwYXNzIGBzcGVjPVRydWVgIG9yIGBzcGVjX3NldD1UcnVlYCwgd2hpY2ggY2F1c2VzCiAgICBwYXRjaCB0byBwYXNzIGluIHRoZSBvYmplY3QgYmVpbmcgbW9ja2VkIGFzIHRoZSBzcGVjL3NwZWNfc2V0IG9iamVjdC4KCiAgICBgbmV3X2NhbGxhYmxlYCBhbGxvd3MgeW91IHRvIHNwZWNpZnkgYSBkaWZmZXJlbnQgY2xhc3MsIG9yIGNhbGxhYmxlIG9iamVjdCwKICAgIHRoYXQgd2lsbCBiZSBjYWxsZWQgdG8gY3JlYXRlIHRoZSBgbmV3YCBvYmplY3QuIEJ5IGRlZmF1bHQgYE1hZ2ljTW9ja2AgaXMKICAgIHVzZWQuCgogICAgQSBtb3JlIHBvd2VyZnVsIGZvcm0gb2YgYHNwZWNgIGlzIGBhdXRvc3BlY2AuIElmIHlvdSBzZXQgYGF1dG9zcGVjPVRydWVgCiAgICB0aGVuIHRoZSBtb2NrIHdpdGggYmUgY3JlYXRlZCB3aXRoIGEgc3BlYyBmcm9tIHRoZSBvYmplY3QgYmVpbmcgcmVwbGFjZWQuCiAgICBBbGwgYXR0cmlidXRlcyBvZiB0aGUgbW9jayB3aWxsIGFsc28gaGF2ZSB0aGUgc3BlYyBvZiB0aGUgY29ycmVzcG9uZGluZwogICAgYXR0cmlidXRlIG9mIHRoZSBvYmplY3QgYmVpbmcgcmVwbGFjZWQuIE1ldGhvZHMgYW5kIGZ1bmN0aW9ucyBiZWluZwogICAgbW9ja2VkIHdpbGwgaGF2ZSB0aGVpciBhcmd1bWVudHMgY2hlY2tlZCBhbmQgd2lsbCByYWlzZSBhIGBUeXBlRXJyb3JgIGlmCiAgICB0aGV5IGFyZSBjYWxsZWQgd2l0aCB0aGUgd3Jvbmcgc2lnbmF0dXJlLiBGb3IgbW9ja3MgcmVwbGFjaW5nIGEgY2xhc3MsCiAgICB0aGVpciByZXR1cm4gdmFsdWUgKHRoZSAnaW5zdGFuY2UnKSB3aWxsIGhhdmUgdGhlIHNhbWUgc3BlYyBhcyB0aGUgY2xhc3MuCgogICAgSW5zdGVhZCBvZiBgYXV0b3NwZWM9VHJ1ZWAgeW91IGNhbiBwYXNzIGBhdXRvc3BlYz1zb21lX29iamVjdGAgdG8gdXNlIGFuCiAgICBhcmJpdHJhcnkgb2JqZWN0IGFzIHRoZSBzcGVjIGluc3RlYWQgb2YgdGhlIG9uZSBiZWluZyByZXBsYWNlZC4KCiAgICBCeSBkZWZhdWx0IGBwYXRjaGAgd2lsbCBmYWlsIHRvIHJlcGxhY2UgYXR0cmlidXRlcyB0aGF0IGRvbid0IGV4aXN0LiBJZgogICAgeW91IHBhc3MgaW4gYGNyZWF0ZT1UcnVlYCwgYW5kIHRoZSBhdHRyaWJ1dGUgZG9lc24ndCBleGlzdCwgcGF0Y2ggd2lsbAogICAgY3JlYXRlIHRoZSBhdHRyaWJ1dGUgZm9yIHlvdSB3aGVuIHRoZSBwYXRjaGVkIGZ1bmN0aW9uIGlzIGNhbGxlZCwgYW5kCiAgICBkZWxldGUgaXQgYWdhaW4gYWZ0ZXJ3YXJkcy4gVGhpcyBpcyB1c2VmdWwgZm9yIHdyaXRpbmcgdGVzdHMgYWdhaW5zdAogICAgYXR0cmlidXRlcyB0aGF0IHlvdXIgcHJvZHVjdGlvbiBjb2RlIGNyZWF0ZXMgYXQgcnVudGltZS4gSXQgaXMgb2ZmIGJ5IGJ5CiAgICBkZWZhdWx0IGJlY2F1c2UgaXQgY2FuIGJlIGRhbmdlcm91cy4gV2l0aCBpdCBzd2l0Y2hlZCBvbiB5b3UgY2FuIHdyaXRlCiAgICBwYXNzaW5nIHRlc3RzIGFnYWluc3QgQVBJcyB0aGF0IGRvbid0IGFjdHVhbGx5IGV4aXN0IQoKICAgIFBhdGNoIGNhbiBiZSB1c2VkIGFzIGEgYFRlc3RDYXNlYCBjbGFzcyBkZWNvcmF0b3IuIEl0IHdvcmtzIGJ5CiAgICBkZWNvcmF0aW5nIGVhY2ggdGVzdCBtZXRob2QgaW4gdGhlIGNsYXNzLiBUaGlzIHJlZHVjZXMgdGhlIGJvaWxlcnBsYXRlCiAgICBjb2RlIHdoZW4geW91ciB0ZXN0IG1ldGhvZHMgc2hhcmUgYSBjb21tb24gcGF0Y2hpbmdzIHNldC4gYHBhdGNoYCBmaW5kcwogICAgdGVzdHMgYnkgbG9va2luZyBmb3IgbWV0aG9kIG5hbWVzIHRoYXQgc3RhcnQgd2l0aCBgcGF0Y2guVEVTVF9QUkVGSVhgLgogICAgQnkgZGVmYXVsdCB0aGlzIGlzIGB0ZXN0YCwgd2hpY2ggbWF0Y2hlcyB0aGUgd2F5IGB1bml0dGVzdGAgZmluZHMgdGVzdHMuCiAgICBZb3UgY2FuIHNwZWNpZnkgYW4gYWx0ZXJuYXRpdmUgcHJlZml4IGJ5IHNldHRpbmcgYHBhdGNoLlRFU1RfUFJFRklYYC4KCiAgICBQYXRjaCBjYW4gYmUgdXNlZCBhcyBhIGNvbnRleHQgbWFuYWdlciwgd2l0aCB0aGUgd2l0aCBzdGF0ZW1lbnQuIEhlcmUgdGhlCiAgICBwYXRjaGluZyBhcHBsaWVzIHRvIHRoZSBpbmRlbnRlZCBibG9jayBhZnRlciB0aGUgd2l0aCBzdGF0ZW1lbnQuIElmIHlvdQogICAgdXNlICJhcyIgdGhlbiB0aGUgcGF0Y2hlZCBvYmplY3Qgd2lsbCBiZSBib3VuZCB0byB0aGUgbmFtZSBhZnRlciB0aGUKICAgICJhcyI7IHZlcnkgdXNlZnVsIGlmIGBwYXRjaGAgaXMgY3JlYXRpbmcgYSBtb2NrIG9iamVjdCBmb3IgeW91LgoKICAgIGBwYXRjaGAgdGFrZXMgYXJiaXRyYXJ5IGtleXdvcmQgYXJndW1lbnRzLiBUaGVzZSB3aWxsIGJlIHBhc3NlZCB0bwogICAgdGhlIGBNb2NrYCAob3IgYG5ld19jYWxsYWJsZWApIG9uIGNvbnN0cnVjdGlvbi4KCiAgICBgcGF0Y2guZGljdCguLi4pYCwgYHBhdGNoLm11bHRpcGxlKC4uLilgIGFuZCBgcGF0Y2gub2JqZWN0KC4uLilgIGFyZQogICAgYXZhaWxhYmxlIGZvciBhbHRlcm5hdGUgdXNlLWNhc2VzLgogICAgIiIiCiAgICBnZXR0ZXIsIGF0dHJpYnV0ZSA9IF9nZXRfdGFyZ2V0KHRhcmdldCkKICAgIHJldHVybiBfcGF0Y2goCiAgICAgICAgZ2V0dGVyLCBhdHRyaWJ1dGUsIG5ldywgc3BlYywgY3JlYXRlLAogICAgICAgIHNwZWNfc2V0LCBhdXRvc3BlYywgbmV3X2NhbGxhYmxlLCBrd2FyZ3MKICAgICkKCgpjbGFzcyBfcGF0Y2hfZGljdChvYmplY3QpOgogICAgIiIiCiAgICBQYXRjaCBhIGRpY3Rpb25hcnksIG9yIGRpY3Rpb25hcnkgbGlrZSBvYmplY3QsIGFuZCByZXN0b3JlIHRoZSBkaWN0aW9uYXJ5CiAgICB0byBpdHMgb3JpZ2luYWwgc3RhdGUgYWZ0ZXIgdGhlIHRlc3QuCgogICAgYGluX2RpY3RgIGNhbiBiZSBhIGRpY3Rpb25hcnkgb3IgYSBtYXBwaW5nIGxpa2UgY29udGFpbmVyLiBJZiBpdCBpcyBhCiAgICBtYXBwaW5nIHRoZW4gaXQgbXVzdCBhdCBsZWFzdCBzdXBwb3J0IGdldHRpbmcsIHNldHRpbmcgYW5kIGRlbGV0aW5nIGl0ZW1zCiAgICBwbHVzIGl0ZXJhdGluZyBvdmVyIGtleXMuCgogICAgYGluX2RpY3RgIGNhbiBhbHNvIGJlIGEgc3RyaW5nIHNwZWNpZnlpbmcgdGhlIG5hbWUgb2YgdGhlIGRpY3Rpb25hcnksIHdoaWNoCiAgICB3aWxsIHRoZW4gYmUgZmV0Y2hlZCBieSBpbXBvcnRpbmcgaXQuCgogICAgYHZhbHVlc2AgY2FuIGJlIGEgZGljdGlvbmFyeSBvZiB2YWx1ZXMgdG8gc2V0IGluIHRoZSBkaWN0aW9uYXJ5LiBgdmFsdWVzYAogICAgY2FuIGFsc28gYmUgYW4gaXRlcmFibGUgb2YgYChrZXksIHZhbHVlKWAgcGFpcnMuCgogICAgSWYgYGNsZWFyYCBpcyBUcnVlIHRoZW4gdGhlIGRpY3Rpb25hcnkgd2lsbCBiZSBjbGVhcmVkIGJlZm9yZSB0aGUgbmV3CiAgICB2YWx1ZXMgYXJlIHNldC4KCiAgICBgcGF0Y2guZGljdGAgY2FuIGFsc28gYmUgY2FsbGVkIHdpdGggYXJiaXRyYXJ5IGtleXdvcmQgYXJndW1lbnRzIHRvIHNldAogICAgdmFsdWVzIGluIHRoZSBkaWN0aW9uYXJ5OjoKCiAgICAgICAgd2l0aCBwYXRjaC5kaWN0KCdzeXMubW9kdWxlcycsIG15bW9kdWxlPU1vY2soKSwgb3RoZXJfbW9kdWxlPU1vY2soKSk6CiAgICAgICAgICAgIC4uLgoKICAgIGBwYXRjaC5kaWN0YCBjYW4gYmUgdXNlZCBhcyBhIGNvbnRleHQgbWFuYWdlciwgZGVjb3JhdG9yIG9yIGNsYXNzCiAgICBkZWNvcmF0b3IuIFdoZW4gdXNlZCBhcyBhIGNsYXNzIGRlY29yYXRvciBgcGF0Y2guZGljdGAgaG9ub3VycwogICAgYHBhdGNoLlRFU1RfUFJFRklYYCBmb3IgY2hvb3Npbmcgd2hpY2ggbWV0aG9kcyB0byB3cmFwLgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGluX2RpY3QsIHZhbHVlcz0oKSwgY2xlYXI9RmFsc2UsICoqa3dhcmdzKToKICAgICAgICBpZiBpc2luc3RhbmNlKGluX2RpY3QsIHN0cik6CiAgICAgICAgICAgIGluX2RpY3QgPSBfaW1wb3J0ZXIoaW5fZGljdCkKICAgICAgICBzZWxmLmluX2RpY3QgPSBpbl9kaWN0CiAgICAgICAgIyBzdXBwb3J0IGFueSBhcmd1bWVudCBzdXBwb3J0ZWQgYnkgZGljdCguLi4pIGNvbnN0cnVjdG9yCiAgICAgICAgc2VsZi52YWx1ZXMgPSBkaWN0KHZhbHVlcykKICAgICAgICBzZWxmLnZhbHVlcy51cGRhdGUoa3dhcmdzKQogICAgICAgIHNlbGYuY2xlYXIgPSBjbGVhcgogICAgICAgIHNlbGYuX29yaWdpbmFsID0gTm9uZQoKCiAgICBkZWYgX19jYWxsX18oc2VsZiwgZik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShmLCB0eXBlKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuZGVjb3JhdGVfY2xhc3MoZikKICAgICAgICBAd3JhcHMoZikKICAgICAgICBkZWYgX2lubmVyKCphcmdzLCAqKmt3KToKICAgICAgICAgICAgc2VsZi5fcGF0Y2hfZGljdCgpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHJldHVybiBmKCphcmdzLCAqKmt3KQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgc2VsZi5fdW5wYXRjaF9kaWN0KCkKCiAgICAgICAgcmV0dXJuIF9pbm5lcgoKCiAgICBkZWYgZGVjb3JhdGVfY2xhc3Moc2VsZiwga2xhc3MpOgogICAgICAgIGZvciBhdHRyIGluIGRpcihrbGFzcyk6CiAgICAgICAgICAgIGF0dHJfdmFsdWUgPSBnZXRhdHRyKGtsYXNzLCBhdHRyKQogICAgICAgICAgICBpZiAoYXR0ci5zdGFydHN3aXRoKHBhdGNoLlRFU1RfUFJFRklYKSBhbmQKICAgICAgICAgICAgICAgICBoYXNhdHRyKGF0dHJfdmFsdWUsICJfX2NhbGxfXyIpKToKICAgICAgICAgICAgICAgIGRlY29yYXRvciA9IF9wYXRjaF9kaWN0KHNlbGYuaW5fZGljdCwgc2VsZi52YWx1ZXMsIHNlbGYuY2xlYXIpCiAgICAgICAgICAgICAgICBkZWNvcmF0ZWQgPSBkZWNvcmF0b3IoYXR0cl92YWx1ZSkKICAgICAgICAgICAgICAgIHNldGF0dHIoa2xhc3MsIGF0dHIsIGRlY29yYXRlZCkKICAgICAgICByZXR1cm4ga2xhc3MKCgogICAgZGVmIF9fZW50ZXJfXyhzZWxmKToKICAgICAgICAiIiJQYXRjaCB0aGUgZGljdC4iIiIKICAgICAgICBzZWxmLl9wYXRjaF9kaWN0KCkKCgogICAgZGVmIF9wYXRjaF9kaWN0KHNlbGYpOgogICAgICAgIHZhbHVlcyA9IHNlbGYudmFsdWVzCiAgICAgICAgaW5fZGljdCA9IHNlbGYuaW5fZGljdAogICAgICAgIGNsZWFyID0gc2VsZi5jbGVhcgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIG9yaWdpbmFsID0gaW5fZGljdC5jb3B5KCkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgICMgZGljdCBsaWtlIG9iamVjdCB3aXRoIG5vIGNvcHkgbWV0aG9kCiAgICAgICAgICAgICMgbXVzdCBzdXBwb3J0IGl0ZXJhdGlvbiBvdmVyIGtleXMKICAgICAgICAgICAgb3JpZ2luYWwgPSB7fQogICAgICAgICAgICBmb3Iga2V5IGluIGluX2RpY3Q6CiAgICAgICAgICAgICAgICBvcmlnaW5hbFtrZXldID0gaW5fZGljdFtrZXldCiAgICAgICAgc2VsZi5fb3JpZ2luYWwgPSBvcmlnaW5hbAoKICAgICAgICBpZiBjbGVhcjoKICAgICAgICAgICAgX2NsZWFyX2RpY3QoaW5fZGljdCkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpbl9kaWN0LnVwZGF0ZSh2YWx1ZXMpCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICAjIGRpY3QgbGlrZSBvYmplY3Qgd2l0aCBubyB1cGRhdGUgbWV0aG9kCiAgICAgICAgICAgIGZvciBrZXkgaW4gdmFsdWVzOgogICAgICAgICAgICAgICAgaW5fZGljdFtrZXldID0gdmFsdWVzW2tleV0KCgogICAgZGVmIF91bnBhdGNoX2RpY3Qoc2VsZik6CiAgICAgICAgaW5fZGljdCA9IHNlbGYuaW5fZGljdAogICAgICAgIG9yaWdpbmFsID0gc2VsZi5fb3JpZ2luYWwKCiAgICAgICAgX2NsZWFyX2RpY3QoaW5fZGljdCkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpbl9kaWN0LnVwZGF0ZShvcmlnaW5hbCkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIGZvciBrZXkgaW4gb3JpZ2luYWw6CiAgICAgICAgICAgICAgICBpbl9kaWN0W2tleV0gPSBvcmlnaW5hbFtrZXldCgoKICAgIGRlZiBfX2V4aXRfXyhzZWxmLCAqYXJncyk6CiAgICAgICAgIiIiVW5wYXRjaCB0aGUgZGljdC4iIiIKICAgICAgICBzZWxmLl91bnBhdGNoX2RpY3QoKQogICAgICAgIHJldHVybiBGYWxzZQoKICAgIHN0YXJ0ID0gX19lbnRlcl9fCiAgICBzdG9wID0gX19leGl0X18KCgpkZWYgX2NsZWFyX2RpY3QoaW5fZGljdCk6CiAgICB0cnk6CiAgICAgICAgaW5fZGljdC5jbGVhcigpCiAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAga2V5cyA9IGxpc3QoaW5fZGljdCkKICAgICAgICBmb3Iga2V5IGluIGtleXM6CiAgICAgICAgICAgIGRlbCBpbl9kaWN0W2tleV0KCgpkZWYgX3BhdGNoX3N0b3BhbGwoKToKICAgICIiIlN0b3AgYWxsIGFjdGl2ZSBwYXRjaGVzLiIiIgogICAgZm9yIHBhdGNoIGluIGxpc3QoX3BhdGNoLl9hY3RpdmVfcGF0Y2hlcyk6CiAgICAgICAgcGF0Y2guc3RvcCgpCgoKcGF0Y2gub2JqZWN0ID0gX3BhdGNoX29iamVjdApwYXRjaC5kaWN0ID0gX3BhdGNoX2RpY3QKcGF0Y2gubXVsdGlwbGUgPSBfcGF0Y2hfbXVsdGlwbGUKcGF0Y2guc3RvcGFsbCA9IF9wYXRjaF9zdG9wYWxsCnBhdGNoLlRFU1RfUFJFRklYID0gJ3Rlc3QnCgptYWdpY19tZXRob2RzID0gKAogICAgImx0IGxlIGd0IGdlIGVxIG5lICIKICAgICJnZXRpdGVtIHNldGl0ZW0gZGVsaXRlbSAiCiAgICAibGVuIGNvbnRhaW5zIGl0ZXIgIgogICAgImhhc2ggc3RyIHNpemVvZiAiCiAgICAiZW50ZXIgZXhpdCAiCiAgICAiZGl2bW9kIG5lZyBwb3MgYWJzIGludmVydCAiCiAgICAiY29tcGxleCBpbnQgZmxvYXQgaW5kZXggIgogICAgInRydW5jIGZsb29yIGNlaWwgIgogICAgImJvb2wgbmV4dCAiCikKCm51bWVyaWNzID0gImFkZCBzdWIgbXVsIGRpdiBmbG9vcmRpdiBtb2QgbHNoaWZ0IHJzaGlmdCBhbmQgeG9yIG9yIHBvdyAiCmlucGxhY2UgPSAnICcuam9pbignaSVzJyAlIG4gZm9yIG4gaW4gbnVtZXJpY3Muc3BsaXQoKSkKcmlnaHQgPSAnICcuam9pbignciVzJyAlIG4gZm9yIG4gaW4gbnVtZXJpY3Muc3BsaXQoKSkKCiMgbm90IGluY2x1ZGluZyBfX3ByZXBhcmVfXywgX19pbnN0YW5jZWNoZWNrX18sIF9fc3ViY2xhc3NjaGVja19fCiMgKGFzIHRoZXkgYXJlIG1ldGFjbGFzcyBtZXRob2RzKQojIF9fZGVsX18gaXMgbm90IHN1cHBvcnRlZCBhdCBhbGwgYXMgaXQgY2F1c2VzIHByb2JsZW1zIGlmIGl0IGV4aXN0cwoKX25vbl9kZWZhdWx0cyA9IHNldCgnX18lc19fJyAlIG1ldGhvZCBmb3IgbWV0aG9kIGluIFsKICAgICdnZXQnLCAnc2V0JywgJ2RlbGV0ZScsICdyZXZlcnNlZCcsICdtaXNzaW5nJywgJ3JlZHVjZScsICdyZWR1Y2VfZXgnLAogICAgJ2dldGluaXRhcmdzJywgJ2dldG5ld2FyZ3MnLCAnZ2V0c3RhdGUnLCAnc2V0c3RhdGUnLCAnZ2V0Zm9ybWF0JywKICAgICdzZXRmb3JtYXQnLCAncmVwcicsICdkaXInLCAnc3ViY2xhc3NlcycsICdmb3JtYXQnLApdKQoKCmRlZiBfZ2V0X21ldGhvZChuYW1lLCBmdW5jKToKICAgICJUdXJucyBhIGNhbGxhYmxlIG9iamVjdCAobGlrZSBhIG1vY2spIGludG8gYSByZWFsIGZ1bmN0aW9uIgogICAgZGVmIG1ldGhvZChzZWxmLCAqYXJncywgKiprdyk6CiAgICAgICAgcmV0dXJuIGZ1bmMoc2VsZiwgKmFyZ3MsICoqa3cpCiAgICBtZXRob2QuX19uYW1lX18gPSBuYW1lCiAgICByZXR1cm4gbWV0aG9kCgoKX21hZ2ljcyA9IHNldCgKICAgICdfXyVzX18nICUgbWV0aG9kIGZvciBtZXRob2QgaW4KICAgICcgJy5qb2luKFttYWdpY19tZXRob2RzLCBudW1lcmljcywgaW5wbGFjZSwgcmlnaHRdKS5zcGxpdCgpCikKCl9hbGxfbWFnaWNzID0gX21hZ2ljcyB8IF9ub25fZGVmYXVsdHMKCl91bnN1cHBvcnRlZF9tYWdpY3MgPSBzZXQoWwogICAgJ19fZ2V0YXR0cl9fJywgJ19fc2V0YXR0cl9fJywKICAgICdfX2luaXRfXycsICdfX25ld19fJywgJ19fcHJlcGFyZV9fJwogICAgJ19faW5zdGFuY2VjaGVja19fJywgJ19fc3ViY2xhc3NjaGVja19fJywKICAgICdfX2RlbF9fJwpdKQoKX2NhbGN1bGF0ZV9yZXR1cm5fdmFsdWUgPSB7CiAgICAnX19oYXNoX18nOiBsYW1iZGEgc2VsZjogb2JqZWN0Ll9faGFzaF9fKHNlbGYpLAogICAgJ19fc3RyX18nOiBsYW1iZGEgc2VsZjogb2JqZWN0Ll9fc3RyX18oc2VsZiksCiAgICAnX19zaXplb2ZfXyc6IGxhbWJkYSBzZWxmOiBvYmplY3QuX19zaXplb2ZfXyhzZWxmKSwKfQoKX3JldHVybl92YWx1ZXMgPSB7CiAgICAnX19sdF9fJzogTm90SW1wbGVtZW50ZWQsCiAgICAnX19ndF9fJzogTm90SW1wbGVtZW50ZWQsCiAgICAnX19sZV9fJzogTm90SW1wbGVtZW50ZWQsCiAgICAnX19nZV9fJzogTm90SW1wbGVtZW50ZWQsCiAgICAnX19pbnRfXyc6IDEsCiAgICAnX19jb250YWluc19fJzogRmFsc2UsCiAgICAnX19sZW5fXyc6IDAsCiAgICAnX19leGl0X18nOiBGYWxzZSwKICAgICdfX2NvbXBsZXhfXyc6IDFqLAogICAgJ19fZmxvYXRfXyc6IDEuMCwKICAgICdfX2Jvb2xfXyc6IFRydWUsCiAgICAnX19pbmRleF9fJzogMSwKfQoKCmRlZiBfZ2V0X2VxKHNlbGYpOgogICAgZGVmIF9fZXFfXyhvdGhlcik6CiAgICAgICAgcmV0X3ZhbCA9IHNlbGYuX19lcV9fLl9tb2NrX3JldHVybl92YWx1ZQogICAgICAgIGlmIHJldF92YWwgaXMgbm90IERFRkFVTFQ6CiAgICAgICAgICAgIHJldHVybiByZXRfdmFsCiAgICAgICAgcmV0dXJuIHNlbGYgaXMgb3RoZXIKICAgIHJldHVybiBfX2VxX18KCmRlZiBfZ2V0X25lKHNlbGYpOgogICAgZGVmIF9fbmVfXyhvdGhlcik6CiAgICAgICAgaWYgc2VsZi5fX25lX18uX21vY2tfcmV0dXJuX3ZhbHVlIGlzIG5vdCBERUZBVUxUOgogICAgICAgICAgICByZXR1cm4gREVGQVVMVAogICAgICAgIHJldHVybiBzZWxmIGlzIG5vdCBvdGhlcgogICAgcmV0dXJuIF9fbmVfXwoKZGVmIF9nZXRfaXRlcihzZWxmKToKICAgIGRlZiBfX2l0ZXJfXygpOgogICAgICAgIHJldF92YWwgPSBzZWxmLl9faXRlcl9fLl9tb2NrX3JldHVybl92YWx1ZQogICAgICAgIGlmIHJldF92YWwgaXMgREVGQVVMVDoKICAgICAgICAgICAgcmV0dXJuIGl0ZXIoW10pCiAgICAgICAgIyBpZiByZXRfdmFsIHdhcyBhbHJlYWR5IGFuIGl0ZXJhdG9yLCB0aGVuIGNhbGxpbmcgaXRlciBvbiBpdCBzaG91bGQKICAgICAgICAjIHJldHVybiB0aGUgaXRlcmF0b3IgdW5jaGFuZ2VkCiAgICAgICAgcmV0dXJuIGl0ZXIocmV0X3ZhbCkKICAgIHJldHVybiBfX2l0ZXJfXwoKX3NpZGVfZWZmZWN0X21ldGhvZHMgPSB7CiAgICAnX19lcV9fJzogX2dldF9lcSwKICAgICdfX25lX18nOiBfZ2V0X25lLAogICAgJ19faXRlcl9fJzogX2dldF9pdGVyLAp9CgoKCmRlZiBfc2V0X3JldHVybl92YWx1ZShtb2NrLCBtZXRob2QsIG5hbWUpOgogICAgZml4ZWQgPSBfcmV0dXJuX3ZhbHVlcy5nZXQobmFtZSwgREVGQVVMVCkKICAgIGlmIGZpeGVkIGlzIG5vdCBERUZBVUxUOgogICAgICAgIG1ldGhvZC5yZXR1cm5fdmFsdWUgPSBmaXhlZAogICAgICAgIHJldHVybgoKICAgIHJldHVybl9jYWx1bGF0b3IgPSBfY2FsY3VsYXRlX3JldHVybl92YWx1ZS5nZXQobmFtZSkKICAgIGlmIHJldHVybl9jYWx1bGF0b3IgaXMgbm90IE5vbmU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm5fdmFsdWUgPSByZXR1cm5fY2FsdWxhdG9yKG1vY2spCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICAjIFhYWFggd2h5IGRvIHdlIHJldHVybiBBdHRyaWJ1dGVFcnJvciBoZXJlPwogICAgICAgICAgICAjICAgICAgc2V0IGl0IGFzIGEgc2lkZV9lZmZlY3QgaW5zdGVhZD8KICAgICAgICAgICAgcmV0dXJuX3ZhbHVlID0gQXR0cmlidXRlRXJyb3IobmFtZSkKICAgICAgICBtZXRob2QucmV0dXJuX3ZhbHVlID0gcmV0dXJuX3ZhbHVlCiAgICAgICAgcmV0dXJuCgogICAgc2lkZV9lZmZlY3RvciA9IF9zaWRlX2VmZmVjdF9tZXRob2RzLmdldChuYW1lKQogICAgaWYgc2lkZV9lZmZlY3RvciBpcyBub3QgTm9uZToKICAgICAgICBtZXRob2Quc2lkZV9lZmZlY3QgPSBzaWRlX2VmZmVjdG9yKG1vY2spCgoKCmNsYXNzIE1hZ2ljTWl4aW4ob2JqZWN0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqYXJncywgKiprdyk6CiAgICAgICAgX3NhZmVfc3VwZXIoTWFnaWNNaXhpbiwgc2VsZikuX19pbml0X18oKmFyZ3MsICoqa3cpCiAgICAgICAgc2VsZi5fbW9ja19zZXRfbWFnaWNzKCkKCgogICAgZGVmIF9tb2NrX3NldF9tYWdpY3Moc2VsZik6CiAgICAgICAgdGhlc2VfbWFnaWNzID0gX21hZ2ljcwoKICAgICAgICBpZiBzZWxmLl9tb2NrX21ldGhvZHMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHRoZXNlX21hZ2ljcyA9IF9tYWdpY3MuaW50ZXJzZWN0aW9uKHNlbGYuX21vY2tfbWV0aG9kcykKCiAgICAgICAgICAgIHJlbW92ZV9tYWdpY3MgPSBzZXQoKQogICAgICAgICAgICByZW1vdmVfbWFnaWNzID0gX21hZ2ljcyAtIHRoZXNlX21hZ2ljcwoKICAgICAgICAgICAgZm9yIGVudHJ5IGluIHJlbW92ZV9tYWdpY3M6CiAgICAgICAgICAgICAgICBpZiBlbnRyeSBpbiB0eXBlKHNlbGYpLl9fZGljdF9fOgogICAgICAgICAgICAgICAgICAgICMgcmVtb3ZlIHVubmVlZGVkIG1hZ2ljIG1ldGhvZHMKICAgICAgICAgICAgICAgICAgICBkZWxhdHRyKHNlbGYsIGVudHJ5KQoKICAgICAgICAjIGRvbid0IG92ZXJ3cml0ZSBleGlzdGluZyBhdHRyaWJ1dGVzIGlmIGNhbGxlZCBhIHNlY29uZCB0aW1lCiAgICAgICAgdGhlc2VfbWFnaWNzID0gdGhlc2VfbWFnaWNzIC0gc2V0KHR5cGUoc2VsZikuX19kaWN0X18pCgogICAgICAgIF90eXBlID0gdHlwZShzZWxmKQogICAgICAgIGZvciBlbnRyeSBpbiB0aGVzZV9tYWdpY3M6CiAgICAgICAgICAgIHNldGF0dHIoX3R5cGUsIGVudHJ5LCBNYWdpY1Byb3h5KGVudHJ5LCBzZWxmKSkKCgoKY2xhc3MgTm9uQ2FsbGFibGVNYWdpY01vY2soTWFnaWNNaXhpbiwgTm9uQ2FsbGFibGVNb2NrKToKICAgICIiIkEgdmVyc2lvbiBvZiBgTWFnaWNNb2NrYCB0aGF0IGlzbid0IGNhbGxhYmxlLiIiIgogICAgZGVmIG1vY2tfYWRkX3NwZWMoc2VsZiwgc3BlYywgc3BlY19zZXQ9RmFsc2UpOgogICAgICAgICIiIkFkZCBhIHNwZWMgdG8gYSBtb2NrLiBgc3BlY2AgY2FuIGVpdGhlciBiZSBhbiBvYmplY3Qgb3IgYQogICAgICAgIGxpc3Qgb2Ygc3RyaW5ncy4gT25seSBhdHRyaWJ1dGVzIG9uIHRoZSBgc3BlY2AgY2FuIGJlIGZldGNoZWQgYXMKICAgICAgICBhdHRyaWJ1dGVzIGZyb20gdGhlIG1vY2suCgogICAgICAgIElmIGBzcGVjX3NldGAgaXMgVHJ1ZSB0aGVuIG9ubHkgYXR0cmlidXRlcyBvbiB0aGUgc3BlYyBjYW4gYmUgc2V0LiIiIgogICAgICAgIHNlbGYuX21vY2tfYWRkX3NwZWMoc3BlYywgc3BlY19zZXQpCiAgICAgICAgc2VsZi5fbW9ja19zZXRfbWFnaWNzKCkKCgoKY2xhc3MgTWFnaWNNb2NrKE1hZ2ljTWl4aW4sIE1vY2spOgogICAgIiIiCiAgICBNYWdpY01vY2sgaXMgYSBzdWJjbGFzcyBvZiBNb2NrIHdpdGggZGVmYXVsdCBpbXBsZW1lbnRhdGlvbnMKICAgIG9mIG1vc3Qgb2YgdGhlIG1hZ2ljIG1ldGhvZHMuIFlvdSBjYW4gdXNlIE1hZ2ljTW9jayB3aXRob3V0IGhhdmluZyB0bwogICAgY29uZmlndXJlIHRoZSBtYWdpYyBtZXRob2RzIHlvdXJzZWxmLgoKICAgIElmIHlvdSB1c2UgdGhlIGBzcGVjYCBvciBgc3BlY19zZXRgIGFyZ3VtZW50cyB0aGVuICpvbmx5KiBtYWdpYwogICAgbWV0aG9kcyB0aGF0IGV4aXN0IGluIHRoZSBzcGVjIHdpbGwgYmUgY3JlYXRlZC4KCiAgICBBdHRyaWJ1dGVzIGFuZCB0aGUgcmV0dXJuIHZhbHVlIG9mIGEgYE1hZ2ljTW9ja2Agd2lsbCBhbHNvIGJlIGBNYWdpY01vY2tzYC4KICAgICIiIgogICAgZGVmIG1vY2tfYWRkX3NwZWMoc2VsZiwgc3BlYywgc3BlY19zZXQ9RmFsc2UpOgogICAgICAgICIiIkFkZCBhIHNwZWMgdG8gYSBtb2NrLiBgc3BlY2AgY2FuIGVpdGhlciBiZSBhbiBvYmplY3Qgb3IgYQogICAgICAgIGxpc3Qgb2Ygc3RyaW5ncy4gT25seSBhdHRyaWJ1dGVzIG9uIHRoZSBgc3BlY2AgY2FuIGJlIGZldGNoZWQgYXMKICAgICAgICBhdHRyaWJ1dGVzIGZyb20gdGhlIG1vY2suCgogICAgICAgIElmIGBzcGVjX3NldGAgaXMgVHJ1ZSB0aGVuIG9ubHkgYXR0cmlidXRlcyBvbiB0aGUgc3BlYyBjYW4gYmUgc2V0LiIiIgogICAgICAgIHNlbGYuX21vY2tfYWRkX3NwZWMoc3BlYywgc3BlY19zZXQpCiAgICAgICAgc2VsZi5fbW9ja19zZXRfbWFnaWNzKCkKCgoKY2xhc3MgTWFnaWNQcm94eShvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG5hbWUsIHBhcmVudCk6CiAgICAgICAgc2VsZi5uYW1lID0gbmFtZQogICAgICAgIHNlbGYucGFyZW50ID0gcGFyZW50CgogICAgZGVmIF9fY2FsbF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgbSA9IHNlbGYuY3JlYXRlX21vY2soKQogICAgICAgIHJldHVybiBtKCphcmdzLCAqKmt3YXJncykKCiAgICBkZWYgY3JlYXRlX21vY2soc2VsZik6CiAgICAgICAgZW50cnkgPSBzZWxmLm5hbWUKICAgICAgICBwYXJlbnQgPSBzZWxmLnBhcmVudAogICAgICAgIG0gPSBwYXJlbnQuX2dldF9jaGlsZF9tb2NrKG5hbWU9ZW50cnksIF9uZXdfbmFtZT1lbnRyeSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbmV3X3BhcmVudD1wYXJlbnQpCiAgICAgICAgc2V0YXR0cihwYXJlbnQsIGVudHJ5LCBtKQogICAgICAgIF9zZXRfcmV0dXJuX3ZhbHVlKHBhcmVudCwgbSwgZW50cnkpCiAgICAgICAgcmV0dXJuIG0KCiAgICBkZWYgX19nZXRfXyhzZWxmLCBvYmosIF90eXBlPU5vbmUpOgogICAgICAgIHJldHVybiBzZWxmLmNyZWF0ZV9tb2NrKCkKCgoKY2xhc3MgX0FOWShvYmplY3QpOgogICAgIkEgaGVscGVyIG9iamVjdCB0aGF0IGNvbXBhcmVzIGVxdWFsIHRvIGV2ZXJ5dGhpbmcuIgoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIF9fbmVfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiAnPEFOWT4nCgpBTlkgPSBfQU5ZKCkKCgoKZGVmIF9mb3JtYXRfY2FsbF9zaWduYXR1cmUobmFtZSwgYXJncywga3dhcmdzKToKICAgIG1lc3NhZ2UgPSAnJXMoJSVzKScgJSBuYW1lCiAgICBmb3JtYXR0ZWRfYXJncyA9ICcnCiAgICBhcmdzX3N0cmluZyA9ICcsICcuam9pbihbcmVwcihhcmcpIGZvciBhcmcgaW4gYXJnc10pCiAgICBrd2FyZ3Nfc3RyaW5nID0gJywgJy5qb2luKFsKICAgICAgICAnJXM9JXInICUgKGtleSwgdmFsdWUpIGZvciBrZXksIHZhbHVlIGluIGt3YXJncy5pdGVtcygpCiAgICBdKQogICAgaWYgYXJnc19zdHJpbmc6CiAgICAgICAgZm9ybWF0dGVkX2FyZ3MgPSBhcmdzX3N0cmluZwogICAgaWYga3dhcmdzX3N0cmluZzoKICAgICAgICBpZiBmb3JtYXR0ZWRfYXJnczoKICAgICAgICAgICAgZm9ybWF0dGVkX2FyZ3MgKz0gJywgJwogICAgICAgIGZvcm1hdHRlZF9hcmdzICs9IGt3YXJnc19zdHJpbmcKCiAgICByZXR1cm4gbWVzc2FnZSAlIGZvcm1hdHRlZF9hcmdzCgoKCmNsYXNzIF9DYWxsKHR1cGxlKToKICAgICIiIgogICAgQSB0dXBsZSBmb3IgaG9sZGluZyB0aGUgcmVzdWx0cyBvZiBhIGNhbGwgdG8gYSBtb2NrLCBlaXRoZXIgaW4gdGhlIGZvcm0KICAgIGAoYXJncywga3dhcmdzKWAgb3IgYChuYW1lLCBhcmdzLCBrd2FyZ3MpYC4KCiAgICBJZiBhcmdzIG9yIGt3YXJncyBhcmUgZW1wdHkgdGhlbiBhIGNhbGwgdHVwbGUgd2lsbCBjb21wYXJlIGVxdWFsIHRvCiAgICBhIHR1cGxlIHdpdGhvdXQgdGhvc2UgdmFsdWVzLiBUaGlzIG1ha2VzIGNvbXBhcmlzb25zIGxlc3MgdmVyYm9zZTo6CgogICAgICAgIF9DYWxsKCgnbmFtZScsICgpLCB7fSkpID09ICgnbmFtZScsKQogICAgICAgIF9DYWxsKCgnbmFtZScsICgxLCksIHt9KSkgPT0gKCduYW1lJywgKDEsKSkKICAgICAgICBfQ2FsbCgoKCksIHsnYSc6ICdiJ30pKSA9PSAoeydhJzogJ2InfSwpCgogICAgVGhlIGBfQ2FsbGAgb2JqZWN0IHByb3ZpZGVzIGEgdXNlZnVsIHNob3J0Y3V0IGZvciBjb21wYXJpbmcgd2l0aCBjYWxsOjoKCiAgICAgICAgX0NhbGwoKCgxLCAyKSwgeydhJzogM30pKSA9PSBjYWxsKDEsIDIsIGE9MykKICAgICAgICBfQ2FsbCgoJ2ZvbycsICgxLCAyKSwgeydhJzogM30pKSA9PSBjYWxsLmZvbygxLCAyLCBhPTMpCgogICAgSWYgdGhlIF9DYWxsIGhhcyBubyBuYW1lIHRoZW4gaXQgd2lsbCBtYXRjaCBhbnkgbmFtZS4KICAgICIiIgogICAgZGVmIF9fbmV3X18oY2xzLCB2YWx1ZT0oKSwgbmFtZT1Ob25lLCBwYXJlbnQ9Tm9uZSwgdHdvPUZhbHNlLAogICAgICAgICAgICAgICAgZnJvbV9rYWxsPVRydWUpOgogICAgICAgIG5hbWUgPSAnJwogICAgICAgIGFyZ3MgPSAoKQogICAgICAgIGt3YXJncyA9IHt9CiAgICAgICAgX2xlbiA9IGxlbih2YWx1ZSkKICAgICAgICBpZiBfbGVuID09IDM6CiAgICAgICAgICAgIG5hbWUsIGFyZ3MsIGt3YXJncyA9IHZhbHVlCiAgICAgICAgZWxpZiBfbGVuID09IDI6CiAgICAgICAgICAgIGZpcnN0LCBzZWNvbmQgPSB2YWx1ZQogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGZpcnN0LCBzdHIpOgogICAgICAgICAgICAgICAgbmFtZSA9IGZpcnN0CiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKHNlY29uZCwgdHVwbGUpOgogICAgICAgICAgICAgICAgICAgIGFyZ3MgPSBzZWNvbmQKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAga3dhcmdzID0gc2Vjb25kCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBhcmdzLCBrd2FyZ3MgPSBmaXJzdCwgc2Vjb25kCiAgICAgICAgZWxpZiBfbGVuID09IDE6CiAgICAgICAgICAgIHZhbHVlLCA9IHZhbHVlCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodmFsdWUsIHN0cik6CiAgICAgICAgICAgICAgICBuYW1lID0gdmFsdWUKICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKHZhbHVlLCB0dXBsZSk6CiAgICAgICAgICAgICAgICBhcmdzID0gdmFsdWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGt3YXJncyA9IHZhbHVlCgogICAgICAgIGlmIHR3bzoKICAgICAgICAgICAgcmV0dXJuIHR1cGxlLl9fbmV3X18oY2xzLCAoYXJncywga3dhcmdzKSkKCiAgICAgICAgcmV0dXJuIHR1cGxlLl9fbmV3X18oY2xzLCAobmFtZSwgYXJncywga3dhcmdzKSkKCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHZhbHVlPSgpLCBuYW1lPU5vbmUsIHBhcmVudD1Ob25lLCB0d289RmFsc2UsCiAgICAgICAgICAgICAgICAgZnJvbV9rYWxsPVRydWUpOgogICAgICAgIHNlbGYubmFtZSA9IG5hbWUKICAgICAgICBzZWxmLnBhcmVudCA9IHBhcmVudAogICAgICAgIHNlbGYuZnJvbV9rYWxsID0gZnJvbV9rYWxsCgoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIG90aGVyIGlzIEFOWToKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxlbl9vdGhlciA9IGxlbihvdGhlcikKICAgICAgICBleGNlcHQgVHlwZUVycm9yOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAgICAgc2VsZl9uYW1lID0gJycKICAgICAgICBpZiBsZW4oc2VsZikgPT0gMjoKICAgICAgICAgICAgc2VsZl9hcmdzLCBzZWxmX2t3YXJncyA9IHNlbGYKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmX25hbWUsIHNlbGZfYXJncywgc2VsZl9rd2FyZ3MgPSBzZWxmCgogICAgICAgIG90aGVyX25hbWUgPSAnJwogICAgICAgIGlmIGxlbl9vdGhlciA9PSAwOgogICAgICAgICAgICBvdGhlcl9hcmdzLCBvdGhlcl9rd2FyZ3MgPSAoKSwge30KICAgICAgICBlbGlmIGxlbl9vdGhlciA9PSAzOgogICAgICAgICAgICBvdGhlcl9uYW1lLCBvdGhlcl9hcmdzLCBvdGhlcl9rd2FyZ3MgPSBvdGhlcgogICAgICAgIGVsaWYgbGVuX290aGVyID09IDE6CiAgICAgICAgICAgIHZhbHVlLCA9IG90aGVyCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodmFsdWUsIHR1cGxlKToKICAgICAgICAgICAgICAgIG90aGVyX2FyZ3MgPSB2YWx1ZQogICAgICAgICAgICAgICAgb3RoZXJfa3dhcmdzID0ge30KICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKHZhbHVlLCBzdHIpOgogICAgICAgICAgICAgICAgb3RoZXJfbmFtZSA9IHZhbHVlCiAgICAgICAgICAgICAgICBvdGhlcl9hcmdzLCBvdGhlcl9rd2FyZ3MgPSAoKSwge30KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG90aGVyX2FyZ3MgPSAoKQogICAgICAgICAgICAgICAgb3RoZXJfa3dhcmdzID0gdmFsdWUKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIGxlbiAyCiAgICAgICAgICAgICMgY291bGQgYmUgKG5hbWUsIGFyZ3MpIG9yIChuYW1lLCBrd2FyZ3MpIG9yIChhcmdzLCBrd2FyZ3MpCiAgICAgICAgICAgIGZpcnN0LCBzZWNvbmQgPSBvdGhlcgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGZpcnN0LCBzdHIpOgogICAgICAgICAgICAgICAgb3RoZXJfbmFtZSA9IGZpcnN0CiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKHNlY29uZCwgdHVwbGUpOgogICAgICAgICAgICAgICAgICAgIG90aGVyX2FyZ3MsIG90aGVyX2t3YXJncyA9IHNlY29uZCwge30KICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgb3RoZXJfYXJncywgb3RoZXJfa3dhcmdzID0gKCksIHNlY29uZAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgb3RoZXJfYXJncywgb3RoZXJfa3dhcmdzID0gZmlyc3QsIHNlY29uZAoKICAgICAgICBpZiBzZWxmX25hbWUgYW5kIG90aGVyX25hbWUgIT0gc2VsZl9uYW1lOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAgICAgIyB0aGlzIG9yZGVyIGlzIGltcG9ydGFudCBmb3IgQU5ZIHRvIHdvcmshCiAgICAgICAgcmV0dXJuIChvdGhlcl9hcmdzLCBvdGhlcl9rd2FyZ3MpID09IChzZWxmX2FyZ3MsIHNlbGZfa3dhcmdzKQoKCiAgICBkZWYgX19uZV9fKHNlbGYsIG90aGVyKToKICAgICAgICByZXR1cm4gbm90IHNlbGYuX19lcV9fKG90aGVyKQoKCiAgICBkZWYgX19jYWxsX18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICBpZiBzZWxmLm5hbWUgaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIF9DYWxsKCgnJywgYXJncywga3dhcmdzKSwgbmFtZT0nKCknKQoKICAgICAgICBuYW1lID0gc2VsZi5uYW1lICsgJygpJwogICAgICAgIHJldHVybiBfQ2FsbCgoc2VsZi5uYW1lLCBhcmdzLCBrd2FyZ3MpLCBuYW1lPW5hbWUsIHBhcmVudD1zZWxmKQoKCiAgICBkZWYgX19nZXRhdHRyX18oc2VsZiwgYXR0cik6CiAgICAgICAgaWYgc2VsZi5uYW1lIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBfQ2FsbChuYW1lPWF0dHIsIGZyb21fa2FsbD1GYWxzZSkKICAgICAgICBuYW1lID0gJyVzLiVzJyAlIChzZWxmLm5hbWUsIGF0dHIpCiAgICAgICAgcmV0dXJuIF9DYWxsKG5hbWU9bmFtZSwgcGFyZW50PXNlbGYsIGZyb21fa2FsbD1GYWxzZSkKCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIGlmIG5vdCBzZWxmLmZyb21fa2FsbDoKICAgICAgICAgICAgbmFtZSA9IHNlbGYubmFtZSBvciAnY2FsbCcKICAgICAgICAgICAgaWYgbmFtZS5zdGFydHN3aXRoKCcoKScpOgogICAgICAgICAgICAgICAgbmFtZSA9ICdjYWxsJXMnICUgbmFtZQogICAgICAgICAgICByZXR1cm4gbmFtZQoKICAgICAgICBpZiBsZW4oc2VsZikgPT0gMjoKICAgICAgICAgICAgbmFtZSA9ICdjYWxsJwogICAgICAgICAgICBhcmdzLCBrd2FyZ3MgPSBzZWxmCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbmFtZSwgYXJncywga3dhcmdzID0gc2VsZgogICAgICAgICAgICBpZiBub3QgbmFtZToKICAgICAgICAgICAgICAgIG5hbWUgPSAnY2FsbCcKICAgICAgICAgICAgZWxpZiBub3QgbmFtZS5zdGFydHN3aXRoKCcoKScpOgogICAgICAgICAgICAgICAgbmFtZSA9ICdjYWxsLiVzJyAlIG5hbWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG5hbWUgPSAnY2FsbCVzJyAlIG5hbWUKICAgICAgICByZXR1cm4gX2Zvcm1hdF9jYWxsX3NpZ25hdHVyZShuYW1lLCBhcmdzLCBrd2FyZ3MpCgoKICAgIGRlZiBjYWxsX2xpc3Qoc2VsZik6CiAgICAgICAgIiIiRm9yIGEgY2FsbCBvYmplY3QgdGhhdCByZXByZXNlbnRzIG11bHRpcGxlIGNhbGxzLCBgY2FsbF9saXN0YAogICAgICAgIHJldHVybnMgYSBsaXN0IG9mIGFsbCB0aGUgaW50ZXJtZWRpYXRlIGNhbGxzIGFzIHdlbGwgYXMgdGhlCiAgICAgICAgZmluYWwgY2FsbC4iIiIKICAgICAgICB2YWxzID0gW10KICAgICAgICB0aGluZyA9IHNlbGYKICAgICAgICB3aGlsZSB0aGluZyBpcyBub3QgTm9uZToKICAgICAgICAgICAgaWYgdGhpbmcuZnJvbV9rYWxsOgogICAgICAgICAgICAgICAgdmFscy5hcHBlbmQodGhpbmcpCiAgICAgICAgICAgIHRoaW5nID0gdGhpbmcucGFyZW50CiAgICAgICAgcmV0dXJuIF9DYWxsTGlzdChyZXZlcnNlZCh2YWxzKSkKCgpjYWxsID0gX0NhbGwoZnJvbV9rYWxsPUZhbHNlKQoKCgpkZWYgY3JlYXRlX2F1dG9zcGVjKHNwZWMsIHNwZWNfc2V0PUZhbHNlLCBpbnN0YW5jZT1GYWxzZSwgX3BhcmVudD1Ob25lLAogICAgICAgICAgICAgICAgICAgIF9uYW1lPU5vbmUsICoqa3dhcmdzKToKICAgICIiIkNyZWF0ZSBhIG1vY2sgb2JqZWN0IHVzaW5nIGFub3RoZXIgb2JqZWN0IGFzIGEgc3BlYy4gQXR0cmlidXRlcyBvbiB0aGUKICAgIG1vY2sgd2lsbCB1c2UgdGhlIGNvcnJlc3BvbmRpbmcgYXR0cmlidXRlIG9uIHRoZSBgc3BlY2Agb2JqZWN0IGFzIHRoZWlyCiAgICBzcGVjLgoKICAgIEZ1bmN0aW9ucyBvciBtZXRob2RzIGJlaW5nIG1vY2tlZCB3aWxsIGhhdmUgdGhlaXIgYXJndW1lbnRzIGNoZWNrZWQKICAgIHRvIGNoZWNrIHRoYXQgdGhleSBhcmUgY2FsbGVkIHdpdGggdGhlIGNvcnJlY3Qgc2lnbmF0dXJlLgoKICAgIElmIGBzcGVjX3NldGAgaXMgVHJ1ZSB0aGVuIGF0dGVtcHRpbmcgdG8gc2V0IGF0dHJpYnV0ZXMgdGhhdCBkb24ndCBleGlzdAogICAgb24gdGhlIHNwZWMgb2JqZWN0IHdpbGwgcmFpc2UgYW4gYEF0dHJpYnV0ZUVycm9yYC4KCiAgICBJZiBhIGNsYXNzIGlzIHVzZWQgYXMgYSBzcGVjIHRoZW4gdGhlIHJldHVybiB2YWx1ZSBvZiB0aGUgbW9jayAodGhlCiAgICBpbnN0YW5jZSBvZiB0aGUgY2xhc3MpIHdpbGwgaGF2ZSB0aGUgc2FtZSBzcGVjLiBZb3UgY2FuIHVzZSBhIGNsYXNzIGFzIHRoZQogICAgc3BlYyBmb3IgYW4gaW5zdGFuY2Ugb2JqZWN0IGJ5IHBhc3NpbmcgYGluc3RhbmNlPVRydWVgLiBUaGUgcmV0dXJuZWQgbW9jawogICAgd2lsbCBvbmx5IGJlIGNhbGxhYmxlIGlmIGluc3RhbmNlcyBvZiB0aGUgbW9jayBhcmUgY2FsbGFibGUuCgogICAgYGNyZWF0ZV9hdXRvc3BlY2AgYWxzbyB0YWtlcyBhcmJpdHJhcnkga2V5d29yZCBhcmd1bWVudHMgdGhhdCBhcmUgcGFzc2VkIHRvCiAgICB0aGUgY29uc3RydWN0b3Igb2YgdGhlIGNyZWF0ZWQgbW9jay4iIiIKICAgIGlmIF9pc19saXN0KHNwZWMpOgogICAgICAgICMgY2FuJ3QgcGFzcyBhIGxpc3QgaW5zdGFuY2UgdG8gdGhlIG1vY2sgY29uc3RydWN0b3IgYXMgaXQgd2lsbCBiZQogICAgICAgICMgaW50ZXJwcmV0ZWQgYXMgYSBsaXN0IG9mIHN0cmluZ3MKICAgICAgICBzcGVjID0gdHlwZShzcGVjKQoKICAgIGlzX3R5cGUgPSBpc2luc3RhbmNlKHNwZWMsIHR5cGUpCgogICAgX2t3YXJncyA9IHsnc3BlYyc6IHNwZWN9CiAgICBpZiBzcGVjX3NldDoKICAgICAgICBfa3dhcmdzID0geydzcGVjX3NldCc6IHNwZWN9CiAgICBlbGlmIHNwZWMgaXMgTm9uZToKICAgICAgICAjIE5vbmUgd2UgbW9jayB3aXRoIGEgbm9ybWFsIG1vY2sgd2l0aG91dCBhIHNwZWMKICAgICAgICBfa3dhcmdzID0ge30KCiAgICBfa3dhcmdzLnVwZGF0ZShrd2FyZ3MpCgogICAgS2xhc3MgPSBNYWdpY01vY2sKICAgIGlmIHR5cGUoc3BlYykgaW4gRGVzY3JpcHRvclR5cGVzOgogICAgICAgICMgZGVzY3JpcHRvcnMgZG9uJ3QgaGF2ZSBhIHNwZWMKICAgICAgICAjIGJlY2F1c2Ugd2UgZG9uJ3Qga25vdyB3aGF0IHR5cGUgdGhleSByZXR1cm4KICAgICAgICBfa3dhcmdzID0ge30KICAgIGVsaWYgbm90IF9jYWxsYWJsZShzcGVjKToKICAgICAgICBLbGFzcyA9IE5vbkNhbGxhYmxlTWFnaWNNb2NrCiAgICBlbGlmIGlzX3R5cGUgYW5kIGluc3RhbmNlIGFuZCBub3QgX2luc3RhbmNlX2NhbGxhYmxlKHNwZWMpOgogICAgICAgIEtsYXNzID0gTm9uQ2FsbGFibGVNYWdpY01vY2sKCiAgICBfbmV3X25hbWUgPSBfbmFtZQogICAgaWYgX3BhcmVudCBpcyBOb25lOgogICAgICAgICMgZm9yIGEgdG9wIGxldmVsIG9iamVjdCBubyBfbmV3X25hbWUgc2hvdWxkIGJlIHNldAogICAgICAgIF9uZXdfbmFtZSA9ICcnCgogICAgbW9jayA9IEtsYXNzKHBhcmVudD1fcGFyZW50LCBfbmV3X3BhcmVudD1fcGFyZW50LCBfbmV3X25hbWU9X25ld19uYW1lLAogICAgICAgICAgICAgICAgIG5hbWU9X25hbWUsICoqX2t3YXJncykKCiAgICBpZiBpc2luc3RhbmNlKHNwZWMsIEZ1bmN0aW9uVHlwZXMpOgogICAgICAgICMgc2hvdWxkIG9ubHkgaGFwcGVuIGF0IHRoZSB0b3AgbGV2ZWwgYmVjYXVzZSB3ZSBkb24ndAogICAgICAgICMgcmVjdXJzZSBmb3IgZnVuY3Rpb25zCiAgICAgICAgbW9jayA9IF9zZXRfc2lnbmF0dXJlKG1vY2ssIHNwZWMpCiAgICBlbHNlOgogICAgICAgIF9jaGVja19zaWduYXR1cmUoc3BlYywgbW9jaywgaXNfdHlwZSwgaW5zdGFuY2UpCgogICAgaWYgX3BhcmVudCBpcyBub3QgTm9uZSBhbmQgbm90IGluc3RhbmNlOgogICAgICAgIF9wYXJlbnQuX21vY2tfY2hpbGRyZW5bX25hbWVdID0gbW9jawoKICAgIGlmIGlzX3R5cGUgYW5kIG5vdCBpbnN0YW5jZSBhbmQgJ3JldHVybl92YWx1ZScgbm90IGluIGt3YXJnczoKICAgICAgICBtb2NrLnJldHVybl92YWx1ZSA9IGNyZWF0ZV9hdXRvc3BlYyhzcGVjLCBzcGVjX3NldCwgaW5zdGFuY2U9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbmFtZT0nKCknLCBfcGFyZW50PW1vY2spCgogICAgZm9yIGVudHJ5IGluIGRpcihzcGVjKToKICAgICAgICBpZiBfaXNfbWFnaWMoZW50cnkpOgogICAgICAgICAgICAjIE1hZ2ljTW9jayBhbHJlYWR5IGRvZXMgdGhlIHVzZWZ1bCBtYWdpYyBtZXRob2RzIGZvciB1cwogICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAjIFhYWFggZG8gd2UgbmVlZCBhIGJldHRlciB3YXkgb2YgZ2V0dGluZyBhdHRyaWJ1dGVzIHdpdGhvdXQKICAgICAgICAjIHRyaWdnZXJpbmcgY29kZSBleGVjdXRpb24gKD8pIFByb2JhYmx5IG5vdCAtIHdlIG5lZWQgdGhlIGFjdHVhbAogICAgICAgICMgb2JqZWN0IHRvIG1vY2sgaXQgc28gd2Ugd291bGQgcmF0aGVyIHRyaWdnZXIgYSBwcm9wZXJ0eSB0aGFuIG1vY2sKICAgICAgICAjIHRoZSBwcm9wZXJ0eSBkZXNjcmlwdG9yLiBMaWtld2lzZSB3ZSB3YW50IHRvIG1vY2sgb3V0IGR5bmFtaWNhbGx5CiAgICAgICAgIyBwcm92aWRlZCBhdHRyaWJ1dGVzLgogICAgICAgICMgWFhYWCB3aGF0IGFib3V0IGF0dHJpYnV0ZXMgdGhhdCByYWlzZSBleGNlcHRpb25zIG90aGVyIHRoYW4KICAgICAgICAjIEF0dHJpYnV0ZUVycm9yIG9uIGJlaW5nIGZldGNoZWQ/CiAgICAgICAgIyB3ZSBjb3VsZCBiZSByZXNpbGllbnQgYWdhaW5zdCBpdCwgb3IgY2F0Y2ggYW5kIHByb3BhZ2F0ZSB0aGUKICAgICAgICAjIGV4Y2VwdGlvbiB3aGVuIHRoZSBhdHRyaWJ1dGUgaXMgZmV0Y2hlZCBmcm9tIHRoZSBtb2NrCiAgICAgICAgdHJ5OgogICAgICAgICAgICBvcmlnaW5hbCA9IGdldGF0dHIoc3BlYywgZW50cnkpCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICBjb250aW51ZQoKICAgICAgICBrd2FyZ3MgPSB7J3NwZWMnOiBvcmlnaW5hbH0KICAgICAgICBpZiBzcGVjX3NldDoKICAgICAgICAgICAga3dhcmdzID0geydzcGVjX3NldCc6IG9yaWdpbmFsfQoKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvcmlnaW5hbCwgRnVuY3Rpb25UeXBlcyk6CiAgICAgICAgICAgIG5ldyA9IF9TcGVjU3RhdGUob3JpZ2luYWwsIHNwZWNfc2V0LCBtb2NrLCBlbnRyeSwgaW5zdGFuY2UpCiAgICAgICAgICAgIG1vY2suX21vY2tfY2hpbGRyZW5bZW50cnldID0gbmV3CiAgICAgICAgZWxzZToKICAgICAgICAgICAgcGFyZW50ID0gbW9jawogICAgICAgICAgICBpZiBpc2luc3RhbmNlKHNwZWMsIEZ1bmN0aW9uVHlwZXMpOgogICAgICAgICAgICAgICAgcGFyZW50ID0gbW9jay5tb2NrCgogICAgICAgICAgICBuZXcgPSBNYWdpY01vY2socGFyZW50PXBhcmVudCwgbmFtZT1lbnRyeSwgX25ld19uYW1lPWVudHJ5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgX25ld19wYXJlbnQ9cGFyZW50LCAqKmt3YXJncykKICAgICAgICAgICAgbW9jay5fbW9ja19jaGlsZHJlbltlbnRyeV0gPSBuZXcKICAgICAgICAgICAgc2tpcGZpcnN0ID0gX211c3Rfc2tpcChzcGVjLCBlbnRyeSwgaXNfdHlwZSkKICAgICAgICAgICAgX2NoZWNrX3NpZ25hdHVyZShvcmlnaW5hbCwgbmV3LCBza2lwZmlyc3Q9c2tpcGZpcnN0KQoKICAgICAgICAjIHNvIGZ1bmN0aW9ucyBjcmVhdGVkIHdpdGggX3NldF9zaWduYXR1cmUgYmVjb21lIGluc3RhbmNlIGF0dHJpYnV0ZXMsCiAgICAgICAgIyAqcGx1cyogdGhlaXIgdW5kZXJseWluZyBtb2NrIGV4aXN0cyBpbiBfbW9ja19jaGlsZHJlbiBvZiB0aGUgcGFyZW50CiAgICAgICAgIyBtb2NrLiBBZGRpbmcgdG8gX21vY2tfY2hpbGRyZW4gbWF5IGJlIHVubmVjZXNzYXJ5IHdoZXJlIHdlIGFyZSBhbHNvCiAgICAgICAgIyBzZXR0aW5nIGFzIGFuIGluc3RhbmNlIGF0dHJpYnV0ZT8KICAgICAgICBpZiBpc2luc3RhbmNlKG5ldywgRnVuY3Rpb25UeXBlcyk6CiAgICAgICAgICAgIHNldGF0dHIobW9jaywgZW50cnksIG5ldykKCiAgICByZXR1cm4gbW9jawoKCmRlZiBfbXVzdF9za2lwKHNwZWMsIGVudHJ5LCBpc190eXBlKToKICAgIGlmIG5vdCBpc2luc3RhbmNlKHNwZWMsIHR5cGUpOgogICAgICAgIGlmIGVudHJ5IGluIGdldGF0dHIoc3BlYywgJ19fZGljdF9fJywge30pOgogICAgICAgICAgICAjIGluc3RhbmNlIGF0dHJpYnV0ZSAtIHNob3VsZG4ndCBza2lwCiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIHNwZWMgPSBzcGVjLl9fY2xhc3NfXwoKICAgIGZvciBrbGFzcyBpbiBzcGVjLl9fbXJvX186CiAgICAgICAgcmVzdWx0ID0ga2xhc3MuX19kaWN0X18uZ2V0KGVudHJ5LCBERUZBVUxUKQogICAgICAgIGlmIHJlc3VsdCBpcyBERUZBVUxUOgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGlmIGlzaW5zdGFuY2UocmVzdWx0LCAoc3RhdGljbWV0aG9kLCBjbGFzc21ldGhvZCkpOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICByZXR1cm4gaXNfdHlwZQoKICAgICMgc2hvdWxkbid0IGdldCBoZXJlIHVubGVzcyBmdW5jdGlvbiBpcyBhIGR5bmFtaWNhbGx5IHByb3ZpZGVkIGF0dHJpYnV0ZQogICAgIyBYWFhYIHVudGVzdGVkIGJlaGF2aW91cgogICAgcmV0dXJuIGlzX3R5cGUKCgpkZWYgX2dldF9jbGFzcyhvYmopOgogICAgdHJ5OgogICAgICAgIHJldHVybiBvYmouX19jbGFzc19fCiAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgIyBpdCBpcyBwb3NzaWJsZSBmb3Igb2JqZWN0cyB0byBoYXZlIG5vIF9fY2xhc3NfXwogICAgICAgIHJldHVybiB0eXBlKG9iaikKCgpjbGFzcyBfU3BlY1N0YXRlKG9iamVjdCk6CgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHNwZWMsIHNwZWNfc2V0PUZhbHNlLCBwYXJlbnQ9Tm9uZSwKICAgICAgICAgICAgICAgICBuYW1lPU5vbmUsIGlkcz1Ob25lLCBpbnN0YW5jZT1GYWxzZSk6CiAgICAgICAgc2VsZi5zcGVjID0gc3BlYwogICAgICAgIHNlbGYuaWRzID0gaWRzCiAgICAgICAgc2VsZi5zcGVjX3NldCA9IHNwZWNfc2V0CiAgICAgICAgc2VsZi5wYXJlbnQgPSBwYXJlbnQKICAgICAgICBzZWxmLmluc3RhbmNlID0gaW5zdGFuY2UKICAgICAgICBzZWxmLm5hbWUgPSBuYW1lCgoKRnVuY3Rpb25UeXBlcyA9ICgKICAgICMgcHl0aG9uIGZ1bmN0aW9uCiAgICB0eXBlKGNyZWF0ZV9hdXRvc3BlYyksCiAgICAjIGluc3RhbmNlIG1ldGhvZAogICAgdHlwZShBTlkuX19lcV9fKSwKKQoKCmZpbGVfc3BlYyA9IE5vbmUKCgpkZWYgbW9ja19vcGVuKG1vY2s9Tm9uZSwgcmVhZF9kYXRhPScnKToKICAgICIiIgogICAgQSBoZWxwZXIgZnVuY3Rpb24gdG8gY3JlYXRlIGEgbW9jayB0byByZXBsYWNlIHRoZSB1c2Ugb2YgYG9wZW5gLiBJdCB3b3JrcwogICAgZm9yIGBvcGVuYCBjYWxsZWQgZGlyZWN0bHkgb3IgdXNlZCBhcyBhIGNvbnRleHQgbWFuYWdlci4KCiAgICBUaGUgYG1vY2tgIGFyZ3VtZW50IGlzIHRoZSBtb2NrIG9iamVjdCB0byBjb25maWd1cmUuIElmIGBOb25lYCAodGhlCiAgICBkZWZhdWx0KSB0aGVuIGEgYE1hZ2ljTW9ja2Agd2lsbCBiZSBjcmVhdGVkIGZvciB5b3UsIHdpdGggdGhlIEFQSSBsaW1pdGVkCiAgICB0byBtZXRob2RzIG9yIGF0dHJpYnV0ZXMgYXZhaWxhYmxlIG9uIHN0YW5kYXJkIGZpbGUgaGFuZGxlcy4KCiAgICBgcmVhZF9kYXRhYCBpcyBhIHN0cmluZyBmb3IgdGhlIGByZWFkYCBtZXRob2Qgb2YgdGhlIGZpbGUgaGFuZGxlIHRvIHJldHVybi4KICAgIFRoaXMgaXMgYW4gZW1wdHkgc3RyaW5nIGJ5IGRlZmF1bHQuCiAgICAiIiIKICAgIGdsb2JhbCBmaWxlX3NwZWMKICAgIGlmIGZpbGVfc3BlYyBpcyBOb25lOgogICAgICAgIGltcG9ydCBfaW8KICAgICAgICBmaWxlX3NwZWMgPSBsaXN0KHNldChkaXIoX2lvLlRleHRJT1dyYXBwZXIpKS51bmlvbihzZXQoZGlyKF9pby5CeXRlc0lPKSkpKQoKICAgIGlmIG1vY2sgaXMgTm9uZToKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKG5hbWU9J29wZW4nLCBzcGVjPW9wZW4pCgogICAgaGFuZGxlID0gTWFnaWNNb2NrKHNwZWM9ZmlsZV9zcGVjKQogICAgaGFuZGxlLndyaXRlLnJldHVybl92YWx1ZSA9IE5vbmUKICAgIGhhbmRsZS5fX2VudGVyX18ucmV0dXJuX3ZhbHVlID0gaGFuZGxlCiAgICBoYW5kbGUucmVhZC5yZXR1cm5fdmFsdWUgPSByZWFkX2RhdGEKCiAgICBtb2NrLnJldHVybl92YWx1ZSA9IGhhbmRsZQogICAgcmV0dXJuIG1vY2sKCgpjbGFzcyBQcm9wZXJ0eU1vY2soTW9jayk6CiAgICAiIiIKICAgIEEgbW9jayBpbnRlbmRlZCB0byBiZSB1c2VkIGFzIGEgcHJvcGVydHksIG9yIG90aGVyIGRlc2NyaXB0b3IsIG9uIGEgY2xhc3MuCiAgICBgUHJvcGVydHlNb2NrYCBwcm92aWRlcyBgX19nZXRfX2AgYW5kIGBfX3NldF9fYCBtZXRob2RzIHNvIHlvdSBjYW4gc3BlY2lmeQogICAgYSByZXR1cm4gdmFsdWUgd2hlbiBpdCBpcyBmZXRjaGVkLgoKICAgIEZldGNoaW5nIGEgYFByb3BlcnR5TW9ja2AgaW5zdGFuY2UgZnJvbSBhbiBvYmplY3QgY2FsbHMgdGhlIG1vY2ssIHdpdGgKICAgIG5vIGFyZ3MuIFNldHRpbmcgaXQgY2FsbHMgdGhlIG1vY2sgd2l0aCB0aGUgdmFsdWUgYmVpbmcgc2V0LgogICAgIiIiCiAgICBkZWYgX2dldF9jaGlsZF9tb2NrKHNlbGYsICoqa3dhcmdzKToKICAgICAgICByZXR1cm4gTWFnaWNNb2NrKCoqa3dhcmdzKQoKICAgIGRlZiBfX2dldF9fKHNlbGYsIG9iaiwgb2JqX3R5cGUpOgogICAgICAgIHJldHVybiBzZWxmKCkKICAgIGRlZiBfX3NldF9fKHNlbGYsIG9iaiwgdmFsKToKICAgICAgICBzZWxmKHZhbCkK',
'/Lib/unittest/result.py':'IiIiVGVzdCByZXN1bHQgb2JqZWN0IiIiCgppbXBvcnQgaW8KaW1wb3J0IHN5cwppbXBvcnQgdHJhY2ViYWNrCgpmcm9tIC4gaW1wb3J0IHV0aWwKZnJvbSBmdW5jdG9vbHMgaW1wb3J0IHdyYXBzCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKZGVmIGZhaWxmYXN0KG1ldGhvZCk6CiAgICBAd3JhcHMobWV0aG9kKQogICAgZGVmIGlubmVyKHNlbGYsICphcmdzLCAqKmt3KToKICAgICAgICBpZiBnZXRhdHRyKHNlbGYsICdmYWlsZmFzdCcsIEZhbHNlKToKICAgICAgICAgICAgc2VsZi5zdG9wKCkKICAgICAgICByZXR1cm4gbWV0aG9kKHNlbGYsICphcmdzLCAqKmt3KQogICAgcmV0dXJuIGlubmVyCgpTVERPVVRfTElORSA9ICdcblN0ZG91dDpcbiVzJwpTVERFUlJfTElORSA9ICdcblN0ZGVycjpcbiVzJwoKCmNsYXNzIFRlc3RSZXN1bHQob2JqZWN0KToKICAgICIiIkhvbGRlciBmb3IgdGVzdCByZXN1bHQgaW5mb3JtYXRpb24uCgogICAgVGVzdCByZXN1bHRzIGFyZSBhdXRvbWF0aWNhbGx5IG1hbmFnZWQgYnkgdGhlIFRlc3RDYXNlIGFuZCBUZXN0U3VpdGUKICAgIGNsYXNzZXMsIGFuZCBkbyBub3QgbmVlZCB0byBiZSBleHBsaWNpdGx5IG1hbmlwdWxhdGVkIGJ5IHdyaXRlcnMgb2YgdGVzdHMuCgogICAgRWFjaCBpbnN0YW5jZSBob2xkcyB0aGUgdG90YWwgbnVtYmVyIG9mIHRlc3RzIHJ1biwgYW5kIGNvbGxlY3Rpb25zIG9mCiAgICBmYWlsdXJlcyBhbmQgZXJyb3JzIHRoYXQgb2NjdXJyZWQgYW1vbmcgdGhvc2UgdGVzdCBydW5zLiBUaGUgY29sbGVjdGlvbnMKICAgIGNvbnRhaW4gdHVwbGVzIG9mICh0ZXN0Y2FzZSwgZXhjZXB0aW9uaW5mbyksIHdoZXJlIGV4Y2VwdGlvbmluZm8gaXMgdGhlCiAgICBmb3JtYXR0ZWQgdHJhY2ViYWNrIG9mIHRoZSBlcnJvciB0aGF0IG9jY3VycmVkLgogICAgIiIiCiAgICBfcHJldmlvdXNUZXN0Q2xhc3MgPSBOb25lCiAgICBfdGVzdFJ1bkVudGVyZWQgPSBGYWxzZQogICAgX21vZHVsZVNldFVwRmFpbGVkID0gRmFsc2UKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzdHJlYW09Tm9uZSwgZGVzY3JpcHRpb25zPU5vbmUsIHZlcmJvc2l0eT1Ob25lKToKICAgICAgICBzZWxmLmZhaWxmYXN0ID0gRmFsc2UKICAgICAgICBzZWxmLmZhaWx1cmVzID0gW10KICAgICAgICBzZWxmLmVycm9ycyA9IFtdCiAgICAgICAgc2VsZi50ZXN0c1J1biA9IDAKICAgICAgICBzZWxmLnNraXBwZWQgPSBbXQogICAgICAgIHNlbGYuZXhwZWN0ZWRGYWlsdXJlcyA9IFtdCiAgICAgICAgc2VsZi51bmV4cGVjdGVkU3VjY2Vzc2VzID0gW10KICAgICAgICBzZWxmLnNob3VsZFN0b3AgPSBGYWxzZQogICAgICAgIHNlbGYuYnVmZmVyID0gRmFsc2UKICAgICAgICBzZWxmLl9zdGRvdXRfYnVmZmVyID0gTm9uZQogICAgICAgIHNlbGYuX3N0ZGVycl9idWZmZXIgPSBOb25lCiAgICAgICAgc2VsZi5fb3JpZ2luYWxfc3Rkb3V0ID0gc3lzLnN0ZG91dAogICAgICAgIHNlbGYuX29yaWdpbmFsX3N0ZGVyciA9IHN5cy5zdGRlcnIKICAgICAgICBzZWxmLl9taXJyb3JPdXRwdXQgPSBGYWxzZQoKICAgIGRlZiBwcmludEVycm9ycyhzZWxmKToKICAgICAgICAiQ2FsbGVkIGJ5IFRlc3RSdW5uZXIgYWZ0ZXIgdGVzdCBydW4iCgogICAgZGVmIHN0YXJ0VGVzdChzZWxmLCB0ZXN0KToKICAgICAgICAiQ2FsbGVkIHdoZW4gdGhlIGdpdmVuIHRlc3QgaXMgYWJvdXQgdG8gYmUgcnVuIgogICAgICAgIHNlbGYudGVzdHNSdW4gKz0gMQogICAgICAgIHNlbGYuX21pcnJvck91dHB1dCA9IEZhbHNlCiAgICAgICAgc2VsZi5fc2V0dXBTdGRvdXQoKQoKICAgIGRlZiBfc2V0dXBTdGRvdXQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5idWZmZXI6CiAgICAgICAgICAgIGlmIHNlbGYuX3N0ZGVycl9idWZmZXIgaXMgTm9uZToKICAgICAgICAgICAgICAgIHNlbGYuX3N0ZGVycl9idWZmZXIgPSBpby5TdHJpbmdJTygpCiAgICAgICAgICAgICAgICBzZWxmLl9zdGRvdXRfYnVmZmVyID0gaW8uU3RyaW5nSU8oKQogICAgICAgICAgICBzeXMuc3Rkb3V0ID0gc2VsZi5fc3Rkb3V0X2J1ZmZlcgogICAgICAgICAgICBzeXMuc3RkZXJyID0gc2VsZi5fc3RkZXJyX2J1ZmZlcgoKICAgIGRlZiBzdGFydFRlc3RSdW4oc2VsZik6CiAgICAgICAgIiIiQ2FsbGVkIG9uY2UgYmVmb3JlIGFueSB0ZXN0cyBhcmUgZXhlY3V0ZWQuCgogICAgICAgIFNlZSBzdGFydFRlc3QgZm9yIGEgbWV0aG9kIGNhbGxlZCBiZWZvcmUgZWFjaCB0ZXN0LgogICAgICAgICIiIgoKICAgIGRlZiBzdG9wVGVzdChzZWxmLCB0ZXN0KToKICAgICAgICAiIiJDYWxsZWQgd2hlbiB0aGUgZ2l2ZW4gdGVzdCBoYXMgYmVlbiBydW4iIiIKICAgICAgICBzZWxmLl9yZXN0b3JlU3Rkb3V0KCkKICAgICAgICBzZWxmLl9taXJyb3JPdXRwdXQgPSBGYWxzZQoKICAgIGRlZiBfcmVzdG9yZVN0ZG91dChzZWxmKToKICAgICAgICBpZiBzZWxmLmJ1ZmZlcjoKICAgICAgICAgICAgaWYgc2VsZi5fbWlycm9yT3V0cHV0OgogICAgICAgICAgICAgICAgb3V0cHV0ID0gc3lzLnN0ZG91dC5nZXR2YWx1ZSgpCiAgICAgICAgICAgICAgICBlcnJvciA9IHN5cy5zdGRlcnIuZ2V0dmFsdWUoKQogICAgICAgICAgICAgICAgaWYgb3V0cHV0OgogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBvdXRwdXQuZW5kc3dpdGgoJ1xuJyk6CiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCArPSAnXG4nCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fb3JpZ2luYWxfc3Rkb3V0LndyaXRlKFNURE9VVF9MSU5FICUgb3V0cHV0KQogICAgICAgICAgICAgICAgaWYgZXJyb3I6CiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGVycm9yLmVuZHN3aXRoKCdcbicpOgogICAgICAgICAgICAgICAgICAgICAgICBlcnJvciArPSAnXG4nCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fb3JpZ2luYWxfc3RkZXJyLndyaXRlKFNUREVSUl9MSU5FICUgZXJyb3IpCgogICAgICAgICAgICBzeXMuc3Rkb3V0ID0gc2VsZi5fb3JpZ2luYWxfc3Rkb3V0CiAgICAgICAgICAgIHN5cy5zdGRlcnIgPSBzZWxmLl9vcmlnaW5hbF9zdGRlcnIKICAgICAgICAgICAgc2VsZi5fc3Rkb3V0X2J1ZmZlci5zZWVrKDApCiAgICAgICAgICAgIHNlbGYuX3N0ZG91dF9idWZmZXIudHJ1bmNhdGUoKQogICAgICAgICAgICBzZWxmLl9zdGRlcnJfYnVmZmVyLnNlZWsoMCkKICAgICAgICAgICAgc2VsZi5fc3RkZXJyX2J1ZmZlci50cnVuY2F0ZSgpCgogICAgZGVmIHN0b3BUZXN0UnVuKHNlbGYpOgogICAgICAgICIiIkNhbGxlZCBvbmNlIGFmdGVyIGFsbCB0ZXN0cyBhcmUgZXhlY3V0ZWQuCgogICAgICAgIFNlZSBzdG9wVGVzdCBmb3IgYSBtZXRob2QgY2FsbGVkIGFmdGVyIGVhY2ggdGVzdC4KICAgICAgICAiIiIKCiAgICBAZmFpbGZhc3QKICAgIGRlZiBhZGRFcnJvcihzZWxmLCB0ZXN0LCBlcnIpOgogICAgICAgICIiIkNhbGxlZCB3aGVuIGFuIGVycm9yIGhhcyBvY2N1cnJlZC4gJ2VycicgaXMgYSB0dXBsZSBvZiB2YWx1ZXMgYXMKICAgICAgICByZXR1cm5lZCBieSBzeXMuZXhjX2luZm8oKS4KICAgICAgICAiIiIKICAgICAgICBzZWxmLmVycm9ycy5hcHBlbmQoKHRlc3QsIHNlbGYuX2V4Y19pbmZvX3RvX3N0cmluZyhlcnIsIHRlc3QpKSkKICAgICAgICBzZWxmLl9taXJyb3JPdXRwdXQgPSBUcnVlCgogICAgQGZhaWxmYXN0CiAgICBkZWYgYWRkRmFpbHVyZShzZWxmLCB0ZXN0LCBlcnIpOgogICAgICAgICIiIkNhbGxlZCB3aGVuIGFuIGVycm9yIGhhcyBvY2N1cnJlZC4gJ2VycicgaXMgYSB0dXBsZSBvZiB2YWx1ZXMgYXMKICAgICAgICByZXR1cm5lZCBieSBzeXMuZXhjX2luZm8oKS4iIiIKICAgICAgICBzZWxmLmZhaWx1cmVzLmFwcGVuZCgodGVzdCwgc2VsZi5fZXhjX2luZm9fdG9fc3RyaW5nKGVyciwgdGVzdCkpKQogICAgICAgIHNlbGYuX21pcnJvck91dHB1dCA9IFRydWUKCiAgICBkZWYgYWRkU3VjY2VzcyhzZWxmLCB0ZXN0KToKICAgICAgICAiQ2FsbGVkIHdoZW4gYSB0ZXN0IGhhcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5IgogICAgICAgIHBhc3MKCiAgICBkZWYgYWRkU2tpcChzZWxmLCB0ZXN0LCByZWFzb24pOgogICAgICAgICIiIkNhbGxlZCB3aGVuIGEgdGVzdCBpcyBza2lwcGVkLiIiIgogICAgICAgIHNlbGYuc2tpcHBlZC5hcHBlbmQoKHRlc3QsIHJlYXNvbikpCgogICAgZGVmIGFkZEV4cGVjdGVkRmFpbHVyZShzZWxmLCB0ZXN0LCBlcnIpOgogICAgICAgICIiIkNhbGxlZCB3aGVuIGFuIGV4cGVjdGVkIGZhaWx1cmUvZXJyb3Igb2NjdXJlZC4iIiIKICAgICAgICBzZWxmLmV4cGVjdGVkRmFpbHVyZXMuYXBwZW5kKAogICAgICAgICAgICAodGVzdCwgc2VsZi5fZXhjX2luZm9fdG9fc3RyaW5nKGVyciwgdGVzdCkpKQoKICAgIEBmYWlsZmFzdAogICAgZGVmIGFkZFVuZXhwZWN0ZWRTdWNjZXNzKHNlbGYsIHRlc3QpOgogICAgICAgICIiIkNhbGxlZCB3aGVuIGEgdGVzdCB3YXMgZXhwZWN0ZWQgdG8gZmFpbCwgYnV0IHN1Y2NlZWQuIiIiCiAgICAgICAgc2VsZi51bmV4cGVjdGVkU3VjY2Vzc2VzLmFwcGVuZCh0ZXN0KQoKICAgIGRlZiB3YXNTdWNjZXNzZnVsKHNlbGYpOgogICAgICAgICJUZWxscyB3aGV0aGVyIG9yIG5vdCB0aGlzIHJlc3VsdCB3YXMgYSBzdWNjZXNzIgogICAgICAgIHJldHVybiBsZW4oc2VsZi5mYWlsdXJlcykgPT0gbGVuKHNlbGYuZXJyb3JzKSA9PSAwCgogICAgZGVmIHN0b3Aoc2VsZik6CiAgICAgICAgIkluZGljYXRlcyB0aGF0IHRoZSB0ZXN0cyBzaG91bGQgYmUgYWJvcnRlZCIKICAgICAgICBzZWxmLnNob3VsZFN0b3AgPSBUcnVlCgogICAgZGVmIF9leGNfaW5mb190b19zdHJpbmcoc2VsZiwgZXJyLCB0ZXN0KToKICAgICAgICAiIiJDb252ZXJ0cyBhIHN5cy5leGNfaW5mbygpLXN0eWxlIHR1cGxlIG9mIHZhbHVlcyBpbnRvIGEgc3RyaW5nLiIiIgogICAgICAgIGV4Y3R5cGUsIHZhbHVlLCB0YiA9IGVycgogICAgICAgICMgU2tpcCB0ZXN0IHJ1bm5lciB0cmFjZWJhY2sgbGV2ZWxzCiAgICAgICAgd2hpbGUgdGIgYW5kIHNlbGYuX2lzX3JlbGV2YW50X3RiX2xldmVsKHRiKToKICAgICAgICAgICAgdGIgPSB0Yi50Yl9uZXh0CgogICAgICAgIGlmIGV4Y3R5cGUgaXMgdGVzdC5mYWlsdXJlRXhjZXB0aW9uOgogICAgICAgICAgICAjIFNraXAgYXNzZXJ0KigpIHRyYWNlYmFjayBsZXZlbHMKICAgICAgICAgICAgbGVuZ3RoID0gc2VsZi5fY291bnRfcmVsZXZhbnRfdGJfbGV2ZWxzKHRiKQogICAgICAgICAgICBtc2dMaW5lcyA9IHRyYWNlYmFjay5mb3JtYXRfZXhjZXB0aW9uKGV4Y3R5cGUsIHZhbHVlLCB0YiwgbGVuZ3RoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1zZ0xpbmVzID0gdHJhY2ViYWNrLmZvcm1hdF9leGNlcHRpb24oZXhjdHlwZSwgdmFsdWUsIHRiKQoKICAgICAgICBpZiBzZWxmLmJ1ZmZlcjoKICAgICAgICAgICAgb3V0cHV0ID0gc3lzLnN0ZG91dC5nZXR2YWx1ZSgpCiAgICAgICAgICAgIGVycm9yID0gc3lzLnN0ZGVyci5nZXR2YWx1ZSgpCiAgICAgICAgICAgIGlmIG91dHB1dDoKICAgICAgICAgICAgICAgIGlmIG5vdCBvdXRwdXQuZW5kc3dpdGgoJ1xuJyk6CiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ICs9ICdcbicKICAgICAgICAgICAgICAgIG1zZ0xpbmVzLmFwcGVuZChTVERPVVRfTElORSAlIG91dHB1dCkKICAgICAgICAgICAgaWYgZXJyb3I6CiAgICAgICAgICAgICAgICBpZiBub3QgZXJyb3IuZW5kc3dpdGgoJ1xuJyk6CiAgICAgICAgICAgICAgICAgICAgZXJyb3IgKz0gJ1xuJwogICAgICAgICAgICAgICAgbXNnTGluZXMuYXBwZW5kKFNUREVSUl9MSU5FICUgZXJyb3IpCiAgICAgICAgcmV0dXJuICcnLmpvaW4obXNnTGluZXMpCgoKICAgIGRlZiBfaXNfcmVsZXZhbnRfdGJfbGV2ZWwoc2VsZiwgdGIpOgogICAgICAgIHJldHVybiAnX191bml0dGVzdCcgaW4gdGIudGJfZnJhbWUuZl9nbG9iYWxzCgogICAgZGVmIF9jb3VudF9yZWxldmFudF90Yl9sZXZlbHMoc2VsZiwgdGIpOgogICAgICAgIGxlbmd0aCA9IDAKICAgICAgICB3aGlsZSB0YiBhbmQgbm90IHNlbGYuX2lzX3JlbGV2YW50X3RiX2xldmVsKHRiKToKICAgICAgICAgICAgbGVuZ3RoICs9IDEKICAgICAgICAgICAgdGIgPSB0Yi50Yl9uZXh0CiAgICAgICAgcmV0dXJuIGxlbmd0aAoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gKCI8JXMgcnVuPSVpIGVycm9ycz0laSBmYWlsdXJlcz0laT4iICUKICAgICAgICAgICAgICAgKHV0aWwuc3RyY2xhc3Moc2VsZi5fX2NsYXNzX18pLCBzZWxmLnRlc3RzUnVuLCBsZW4oc2VsZi5lcnJvcnMpLAogICAgICAgICAgICAgICAgbGVuKHNlbGYuZmFpbHVyZXMpKSkK',
'/Lib/unittest/runner.py':'IiIiUnVubmluZyB0ZXN0cyIiIgoKaW1wb3J0IHN5cwppbXBvcnQgdGltZQppbXBvcnQgd2FybmluZ3MKCmZyb20gLiBpbXBvcnQgcmVzdWx0CmZyb20gLnNpZ25hbHMgaW1wb3J0IHJlZ2lzdGVyUmVzdWx0CgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKCmNsYXNzIF9Xcml0ZWxuRGVjb3JhdG9yKG9iamVjdCk6CiAgICAiIiJVc2VkIHRvIGRlY29yYXRlIGZpbGUtbGlrZSBvYmplY3RzIHdpdGggYSBoYW5keSAnd3JpdGVsbicgbWV0aG9kIiIiCiAgICBkZWYgX19pbml0X18oc2VsZixzdHJlYW0pOgogICAgICAgIHNlbGYuc3RyZWFtID0gc3RyZWFtCgogICAgZGVmIF9fZ2V0YXR0cl9fKHNlbGYsIGF0dHIpOgogICAgICAgIGlmIGF0dHIgaW4gKCdzdHJlYW0nLCAnX19nZXRzdGF0ZV9fJyk6CiAgICAgICAgICAgIHJhaXNlIEF0dHJpYnV0ZUVycm9yKGF0dHIpCiAgICAgICAgcmV0dXJuIGdldGF0dHIoc2VsZi5zdHJlYW0sYXR0cikKCiAgICBkZWYgd3JpdGVsbihzZWxmLCBhcmc9Tm9uZSk6CiAgICAgICAgaWYgYXJnOgogICAgICAgICAgICBzZWxmLndyaXRlKGFyZykKICAgICAgICBzZWxmLndyaXRlKCdcbicpICMgdGV4dC1tb2RlIHN0cmVhbXMgdHJhbnNsYXRlIHRvIFxyXG4gaWYgbmVlZGVkCgoKY2xhc3MgVGV4dFRlc3RSZXN1bHQocmVzdWx0LlRlc3RSZXN1bHQpOgogICAgIiIiQSB0ZXN0IHJlc3VsdCBjbGFzcyB0aGF0IGNhbiBwcmludCBmb3JtYXR0ZWQgdGV4dCByZXN1bHRzIHRvIGEgc3RyZWFtLgoKICAgIFVzZWQgYnkgVGV4dFRlc3RSdW5uZXIuCiAgICAiIiIKICAgIHNlcGFyYXRvcjEgPSAnPScgKiA3MAogICAgc2VwYXJhdG9yMiA9ICctJyAqIDcwCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHN0cmVhbSwgZGVzY3JpcHRpb25zLCB2ZXJib3NpdHkpOgogICAgICAgIHN1cGVyKFRleHRUZXN0UmVzdWx0LCBzZWxmKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5zdHJlYW0gPSBzdHJlYW0KICAgICAgICBzZWxmLnNob3dBbGwgPSB2ZXJib3NpdHkgPiAxCiAgICAgICAgc2VsZi5kb3RzID0gdmVyYm9zaXR5ID09IDEKICAgICAgICBzZWxmLmRlc2NyaXB0aW9ucyA9IGRlc2NyaXB0aW9ucwoKICAgIGRlZiBnZXREZXNjcmlwdGlvbihzZWxmLCB0ZXN0KToKICAgICAgICBkb2NfZmlyc3RfbGluZSA9IHRlc3Quc2hvcnREZXNjcmlwdGlvbigpCiAgICAgICAgaWYgc2VsZi5kZXNjcmlwdGlvbnMgYW5kIGRvY19maXJzdF9saW5lOgogICAgICAgICAgICByZXR1cm4gJ1xuJy5qb2luKChzdHIodGVzdCksIGRvY19maXJzdF9saW5lKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gc3RyKHRlc3QpCgogICAgZGVmIHN0YXJ0VGVzdChzZWxmLCB0ZXN0KToKICAgICAgICBzdXBlcihUZXh0VGVzdFJlc3VsdCwgc2VsZikuc3RhcnRUZXN0KHRlc3QpCiAgICAgICAgaWYgc2VsZi5zaG93QWxsOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZShzZWxmLmdldERlc2NyaXB0aW9uKHRlc3QpKQogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZSgiIC4uLiAiKQogICAgICAgICAgICBzZWxmLnN0cmVhbS5mbHVzaCgpCgogICAgZGVmIGFkZFN1Y2Nlc3Moc2VsZiwgdGVzdCk6CiAgICAgICAgc3VwZXIoVGV4dFRlc3RSZXN1bHQsIHNlbGYpLmFkZFN1Y2Nlc3ModGVzdCkKICAgICAgICBpZiBzZWxmLnNob3dBbGw6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oIm9rIikKICAgICAgICBlbGlmIHNlbGYuZG90czoKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGUoJy4nKQogICAgICAgICAgICBzZWxmLnN0cmVhbS5mbHVzaCgpCgogICAgZGVmIGFkZEVycm9yKHNlbGYsIHRlc3QsIGVycik6CiAgICAgICAgc3VwZXIoVGV4dFRlc3RSZXN1bHQsIHNlbGYpLmFkZEVycm9yKHRlc3QsIGVycikKICAgICAgICBpZiBzZWxmLnNob3dBbGw6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oIkVSUk9SIikKICAgICAgICBlbGlmIHNlbGYuZG90czoKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGUoJ0UnKQogICAgICAgICAgICBzZWxmLnN0cmVhbS5mbHVzaCgpCgogICAgZGVmIGFkZEZhaWx1cmUoc2VsZiwgdGVzdCwgZXJyKToKICAgICAgICBzdXBlcihUZXh0VGVzdFJlc3VsdCwgc2VsZikuYWRkRmFpbHVyZSh0ZXN0LCBlcnIpCiAgICAgICAgaWYgc2VsZi5zaG93QWxsOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCJGQUlMIikKICAgICAgICBlbGlmIHNlbGYuZG90czoKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGUoJ0YnKQogICAgICAgICAgICBzZWxmLnN0cmVhbS5mbHVzaCgpCgogICAgZGVmIGFkZFNraXAoc2VsZiwgdGVzdCwgcmVhc29uKToKICAgICAgICBzdXBlcihUZXh0VGVzdFJlc3VsdCwgc2VsZikuYWRkU2tpcCh0ZXN0LCByZWFzb24pCiAgICAgICAgaWYgc2VsZi5zaG93QWxsOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCJza2lwcGVkIHswIXJ9Ii5mb3JtYXQocmVhc29uKSkKICAgICAgICBlbGlmIHNlbGYuZG90czoKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGUoInMiKQogICAgICAgICAgICBzZWxmLnN0cmVhbS5mbHVzaCgpCgogICAgZGVmIGFkZEV4cGVjdGVkRmFpbHVyZShzZWxmLCB0ZXN0LCBlcnIpOgogICAgICAgIHN1cGVyKFRleHRUZXN0UmVzdWx0LCBzZWxmKS5hZGRFeHBlY3RlZEZhaWx1cmUodGVzdCwgZXJyKQogICAgICAgIGlmIHNlbGYuc2hvd0FsbDoKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbigiZXhwZWN0ZWQgZmFpbHVyZSIpCiAgICAgICAgZWxpZiBzZWxmLmRvdHM6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlKCJ4IikKICAgICAgICAgICAgc2VsZi5zdHJlYW0uZmx1c2goKQoKICAgIGRlZiBhZGRVbmV4cGVjdGVkU3VjY2VzcyhzZWxmLCB0ZXN0KToKICAgICAgICBzdXBlcihUZXh0VGVzdFJlc3VsdCwgc2VsZikuYWRkVW5leHBlY3RlZFN1Y2Nlc3ModGVzdCkKICAgICAgICBpZiBzZWxmLnNob3dBbGw6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oInVuZXhwZWN0ZWQgc3VjY2VzcyIpCiAgICAgICAgZWxpZiBzZWxmLmRvdHM6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlKCJ1IikKICAgICAgICAgICAgc2VsZi5zdHJlYW0uZmx1c2goKQoKICAgIGRlZiBwcmludEVycm9ycyhzZWxmKToKICAgICAgICBpZiBzZWxmLmRvdHMgb3Igc2VsZi5zaG93QWxsOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCkKICAgICAgICBzZWxmLnByaW50RXJyb3JMaXN0KCdFUlJPUicsIHNlbGYuZXJyb3JzKQogICAgICAgIHNlbGYucHJpbnRFcnJvckxpc3QoJ0ZBSUwnLCBzZWxmLmZhaWx1cmVzKQoKICAgIGRlZiBwcmludEVycm9yTGlzdChzZWxmLCBmbGF2b3VyLCBlcnJvcnMpOgogICAgICAgIGZvciB0ZXN0LCBlcnIgaW4gZXJyb3JzOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKHNlbGYuc2VwYXJhdG9yMSkKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbigiJXM6ICVzIiAlIChmbGF2b3VyLHNlbGYuZ2V0RGVzY3JpcHRpb24odGVzdCkpKQogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKHNlbGYuc2VwYXJhdG9yMikKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbigiJXMiICUgZXJyKQoKCmNsYXNzIFRleHRUZXN0UnVubmVyKG9iamVjdCk6CiAgICAiIiJBIHRlc3QgcnVubmVyIGNsYXNzIHRoYXQgZGlzcGxheXMgcmVzdWx0cyBpbiB0ZXh0dWFsIGZvcm0uCgogICAgSXQgcHJpbnRzIG91dCB0aGUgbmFtZXMgb2YgdGVzdHMgYXMgdGhleSBhcmUgcnVuLCBlcnJvcnMgYXMgdGhleQogICAgb2NjdXIsIGFuZCBhIHN1bW1hcnkgb2YgdGhlIHJlc3VsdHMgYXQgdGhlIGVuZCBvZiB0aGUgdGVzdCBydW4uCiAgICAiIiIKICAgIHJlc3VsdGNsYXNzID0gVGV4dFRlc3RSZXN1bHQKCiAgICBkZWYgX19pbml0X18oc2VsZiwgc3RyZWFtPU5vbmUsIGRlc2NyaXB0aW9ucz1UcnVlLCB2ZXJib3NpdHk9MSwKICAgICAgICAgICAgICAgICBmYWlsZmFzdD1GYWxzZSwgYnVmZmVyPUZhbHNlLCByZXN1bHRjbGFzcz1Ob25lLCB3YXJuaW5ncz1Ob25lKToKICAgICAgICBpZiBzdHJlYW0gaXMgTm9uZToKICAgICAgICAgICAgc3RyZWFtID0gc3lzLnN0ZGVycgogICAgICAgIHNlbGYuc3RyZWFtID0gX1dyaXRlbG5EZWNvcmF0b3Ioc3RyZWFtKQogICAgICAgIHNlbGYuZGVzY3JpcHRpb25zID0gZGVzY3JpcHRpb25zCiAgICAgICAgc2VsZi52ZXJib3NpdHkgPSB2ZXJib3NpdHkKICAgICAgICBzZWxmLmZhaWxmYXN0ID0gZmFpbGZhc3QKICAgICAgICBzZWxmLmJ1ZmZlciA9IGJ1ZmZlcgogICAgICAgIHNlbGYud2FybmluZ3MgPSB3YXJuaW5ncwogICAgICAgIGlmIHJlc3VsdGNsYXNzIGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLnJlc3VsdGNsYXNzID0gcmVzdWx0Y2xhc3MKCiAgICBkZWYgX21ha2VSZXN1bHQoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYucmVzdWx0Y2xhc3Moc2VsZi5zdHJlYW0sIHNlbGYuZGVzY3JpcHRpb25zLCBzZWxmLnZlcmJvc2l0eSkKCiAgICBkZWYgcnVuKHNlbGYsIHRlc3QpOgogICAgICAgICJSdW4gdGhlIGdpdmVuIHRlc3QgY2FzZSBvciB0ZXN0IHN1aXRlLiIKICAgICAgICByZXN1bHQgPSBzZWxmLl9tYWtlUmVzdWx0KCkKICAgICAgICByZWdpc3RlclJlc3VsdChyZXN1bHQpCiAgICAgICAgcmVzdWx0LmZhaWxmYXN0ID0gc2VsZi5mYWlsZmFzdAogICAgICAgIHJlc3VsdC5idWZmZXIgPSBzZWxmLmJ1ZmZlcgogICAgICAgIHdpdGggd2FybmluZ3MuY2F0Y2hfd2FybmluZ3MoKToKICAgICAgICAgICAgaWYgc2VsZi53YXJuaW5nczoKICAgICAgICAgICAgICAgICMgaWYgc2VsZi53YXJuaW5ncyBpcyBzZXQsIHVzZSBpdCB0byBmaWx0ZXIgYWxsIHRoZSB3YXJuaW5ncwogICAgICAgICAgICAgICAgd2FybmluZ3Muc2ltcGxlZmlsdGVyKHNlbGYud2FybmluZ3MpCiAgICAgICAgICAgICAgICAjIGlmIHRoZSBmaWx0ZXIgaXMgJ2RlZmF1bHQnIG9yICdhbHdheXMnLCBzcGVjaWFsLWNhc2UgdGhlCiAgICAgICAgICAgICAgICAjIHdhcm5pbmdzIGZyb20gdGhlIGRlcHJlY2F0ZWQgdW5pdHRlc3QgbWV0aG9kcyB0byBzaG93IHRoZW0KICAgICAgICAgICAgICAgICMgbm8gbW9yZSB0aGFuIG9uY2UgcGVyIG1vZHVsZSwgYmVjYXVzZSB0aGV5IGNhbiBiZSBmYWlybHkKICAgICAgICAgICAgICAgICMgbm9pc3kuICBUaGUgLVdkIGFuZCAtV2EgZmxhZ3MgY2FuIGJlIHVzZWQgdG8gYnlwYXNzIHRoaXMKICAgICAgICAgICAgICAgICMgb25seSB3aGVuIHNlbGYud2FybmluZ3MgaXMgTm9uZS4KICAgICAgICAgICAgICAgIGlmIHNlbGYud2FybmluZ3MgaW4gWydkZWZhdWx0JywgJ2Fsd2F5cyddOgogICAgICAgICAgICAgICAgICAgIHdhcm5pbmdzLmZpbHRlcndhcm5pbmdzKCdtb2R1bGUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk9RGVwcmVjYXRpb25XYXJuaW5nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZT0nUGxlYXNlIHVzZSBhc3NlcnRcdysgaW5zdGVhZC4nKQogICAgICAgICAgICBzdGFydFRpbWUgPSB0aW1lLnRpbWUoKQogICAgICAgICAgICBzdGFydFRlc3RSdW4gPSBnZXRhdHRyKHJlc3VsdCwgJ3N0YXJ0VGVzdFJ1bicsIE5vbmUpCiAgICAgICAgICAgIGlmIHN0YXJ0VGVzdFJ1biBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHN0YXJ0VGVzdFJ1bigpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHRlc3QocmVzdWx0KQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgc3RvcFRlc3RSdW4gPSBnZXRhdHRyKHJlc3VsdCwgJ3N0b3BUZXN0UnVuJywgTm9uZSkKICAgICAgICAgICAgICAgIGlmIHN0b3BUZXN0UnVuIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIHN0b3BUZXN0UnVuKCkKICAgICAgICAgICAgc3RvcFRpbWUgPSB0aW1lLnRpbWUoKQogICAgICAgIHRpbWVUYWtlbiA9IHN0b3BUaW1lIC0gc3RhcnRUaW1lCiAgICAgICAgcmVzdWx0LnByaW50RXJyb3JzKCkKICAgICAgICBpZiBoYXNhdHRyKHJlc3VsdCwgJ3NlcGFyYXRvcjInKToKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbihyZXN1bHQuc2VwYXJhdG9yMikKICAgICAgICBydW4gPSByZXN1bHQudGVzdHNSdW4KICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCJSYW4gJWQgdGVzdCVzIGluICUuM2ZzIiAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAocnVuLCBydW4gIT0gMSBhbmQgInMiIG9yICIiLCB0aW1lVGFrZW4pKQogICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oKQoKICAgICAgICBleHBlY3RlZEZhaWxzID0gdW5leHBlY3RlZFN1Y2Nlc3NlcyA9IHNraXBwZWQgPSAwCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXN1bHRzID0gbWFwKGxlbiwgKHJlc3VsdC5leHBlY3RlZEZhaWx1cmVzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC51bmV4cGVjdGVkU3VjY2Vzc2VzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5za2lwcGVkKSkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBleHBlY3RlZEZhaWxzLCB1bmV4cGVjdGVkU3VjY2Vzc2VzLCBza2lwcGVkID0gcmVzdWx0cwoKICAgICAgICBpbmZvcyA9IFtdCiAgICAgICAgaWYgbm90IHJlc3VsdC53YXNTdWNjZXNzZnVsKCk6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlKCJGQUlMRUQiKQogICAgICAgICAgICBmYWlsZWQsIGVycm9yZWQgPSBsZW4ocmVzdWx0LmZhaWx1cmVzKSwgbGVuKHJlc3VsdC5lcnJvcnMpCiAgICAgICAgICAgIGlmIGZhaWxlZDoKICAgICAgICAgICAgICAgIGluZm9zLmFwcGVuZCgiZmFpbHVyZXM9JWQiICUgZmFpbGVkKQogICAgICAgICAgICBpZiBlcnJvcmVkOgogICAgICAgICAgICAgICAgaW5mb3MuYXBwZW5kKCJlcnJvcnM9JWQiICUgZXJyb3JlZCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZSgiT0siKQogICAgICAgIGlmIHNraXBwZWQ6CiAgICAgICAgICAgIGluZm9zLmFwcGVuZCgic2tpcHBlZD0lZCIgJSBza2lwcGVkKQogICAgICAgIGlmIGV4cGVjdGVkRmFpbHM6CiAgICAgICAgICAgIGluZm9zLmFwcGVuZCgiZXhwZWN0ZWQgZmFpbHVyZXM9JWQiICUgZXhwZWN0ZWRGYWlscykKICAgICAgICBpZiB1bmV4cGVjdGVkU3VjY2Vzc2VzOgogICAgICAgICAgICBpbmZvcy5hcHBlbmQoInVuZXhwZWN0ZWQgc3VjY2Vzc2VzPSVkIiAlIHVuZXhwZWN0ZWRTdWNjZXNzZXMpCiAgICAgICAgaWYgaW5mb3M6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oIiAoJXMpIiAlICgiLCAiLmpvaW4oaW5mb3MpLCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGUoIlxuIikKICAgICAgICByZXR1cm4gcmVzdWx0Cg==',
'/Lib/unittest/signals.py':'aW1wb3J0IHNpZ25hbAppbXBvcnQgd2Vha3JlZgoKZnJvbSBmdW5jdG9vbHMgaW1wb3J0IHdyYXBzCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKCmNsYXNzIF9JbnRlcnJ1cHRIYW5kbGVyKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgZGVmYXVsdF9oYW5kbGVyKToKICAgICAgICBzZWxmLmNhbGxlZCA9IEZhbHNlCiAgICAgICAgc2VsZi5kZWZhdWx0X2hhbmRsZXIgPSBkZWZhdWx0X2hhbmRsZXIKCiAgICBkZWYgX19jYWxsX18oc2VsZiwgc2lnbnVtLCBmcmFtZSk6CiAgICAgICAgaW5zdGFsbGVkX2hhbmRsZXIgPSBzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpCiAgICAgICAgaWYgaW5zdGFsbGVkX2hhbmRsZXIgaXMgbm90IHNlbGY6CiAgICAgICAgICAgICMgaWYgd2UgYXJlbid0IHRoZSBpbnN0YWxsZWQgaGFuZGxlciwgdGhlbiBkZWxlZ2F0ZSBpbW1lZGlhdGVseQogICAgICAgICAgICAjIHRvIHRoZSBkZWZhdWx0IGhhbmRsZXIKICAgICAgICAgICAgc2VsZi5kZWZhdWx0X2hhbmRsZXIoc2lnbnVtLCBmcmFtZSkKCiAgICAgICAgaWYgc2VsZi5jYWxsZWQ6CiAgICAgICAgICAgIHNlbGYuZGVmYXVsdF9oYW5kbGVyKHNpZ251bSwgZnJhbWUpCiAgICAgICAgc2VsZi5jYWxsZWQgPSBUcnVlCiAgICAgICAgZm9yIHJlc3VsdCBpbiBfcmVzdWx0cy5rZXlzKCk6CiAgICAgICAgICAgIHJlc3VsdC5zdG9wKCkKCl9yZXN1bHRzID0gd2Vha3JlZi5XZWFrS2V5RGljdGlvbmFyeSgpCmRlZiByZWdpc3RlclJlc3VsdChyZXN1bHQpOgogICAgX3Jlc3VsdHNbcmVzdWx0XSA9IDEKCmRlZiByZW1vdmVSZXN1bHQocmVzdWx0KToKICAgIHJldHVybiBib29sKF9yZXN1bHRzLnBvcChyZXN1bHQsIE5vbmUpKQoKX2ludGVycnVwdF9oYW5kbGVyID0gTm9uZQpkZWYgaW5zdGFsbEhhbmRsZXIoKToKICAgIGdsb2JhbCBfaW50ZXJydXB0X2hhbmRsZXIKICAgIGlmIF9pbnRlcnJ1cHRfaGFuZGxlciBpcyBOb25lOgogICAgICAgIGRlZmF1bHRfaGFuZGxlciA9IHNpZ25hbC5nZXRzaWduYWwoc2lnbmFsLlNJR0lOVCkKICAgICAgICBfaW50ZXJydXB0X2hhbmRsZXIgPSBfSW50ZXJydXB0SGFuZGxlcihkZWZhdWx0X2hhbmRsZXIpCiAgICAgICAgc2lnbmFsLnNpZ25hbChzaWduYWwuU0lHSU5ULCBfaW50ZXJydXB0X2hhbmRsZXIpCgoKZGVmIHJlbW92ZUhhbmRsZXIobWV0aG9kPU5vbmUpOgogICAgaWYgbWV0aG9kIGlzIG5vdCBOb25lOgogICAgICAgIEB3cmFwcyhtZXRob2QpCiAgICAgICAgZGVmIGlubmVyKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIGluaXRpYWwgPSBzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpCiAgICAgICAgICAgIHJlbW92ZUhhbmRsZXIoKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICByZXR1cm4gbWV0aG9kKCphcmdzLCAqKmt3YXJncykKICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgIHNpZ25hbC5zaWduYWwoc2lnbmFsLlNJR0lOVCwgaW5pdGlhbCkKICAgICAgICByZXR1cm4gaW5uZXIKCiAgICBnbG9iYWwgX2ludGVycnVwdF9oYW5kbGVyCiAgICBpZiBfaW50ZXJydXB0X2hhbmRsZXIgaXMgbm90IE5vbmU6CiAgICAgICAgc2lnbmFsLnNpZ25hbChzaWduYWwuU0lHSU5ULCBfaW50ZXJydXB0X2hhbmRsZXIuZGVmYXVsdF9oYW5kbGVyKQo=',
'/Lib/unittest/suite.py':'IiIiVGVzdFN1aXRlIiIiCgppbXBvcnQgc3lzCgpmcm9tIC4gaW1wb3J0IGNhc2UKZnJvbSAuIGltcG9ydCB1dGlsCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKCmRlZiBfY2FsbF9pZl9leGlzdHMocGFyZW50LCBhdHRyKToKICAgIGZ1bmMgPSBnZXRhdHRyKHBhcmVudCwgYXR0ciwgbGFtYmRhOiBOb25lKQogICAgZnVuYygpCgoKY2xhc3MgQmFzZVRlc3RTdWl0ZShvYmplY3QpOgogICAgIiIiQSBzaW1wbGUgdGVzdCBzdWl0ZSB0aGF0IGRvZXNuJ3QgcHJvdmlkZSBjbGFzcyBvciBtb2R1bGUgc2hhcmVkIGZpeHR1cmVzLgogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgdGVzdHM9KCkpOgogICAgICAgIHNlbGYuX3Rlc3RzID0gW10KICAgICAgICBzZWxmLmFkZFRlc3RzKHRlc3RzKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gIjwlcyB0ZXN0cz0lcz4iICUgKHV0aWwuc3RyY2xhc3Moc2VsZi5fX2NsYXNzX18pLCBsaXN0KHNlbGYpKQoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBzZWxmLl9fY2xhc3NfXyk6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAogICAgICAgIHJldHVybiBsaXN0KHNlbGYpID09IGxpc3Qob3RoZXIpCgogICAgZGVmIF9fbmVfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgcmV0dXJuIG5vdCBzZWxmID09IG90aGVyCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBpdGVyKHNlbGYuX3Rlc3RzKQoKICAgIGRlZiBjb3VudFRlc3RDYXNlcyhzZWxmKToKICAgICAgICBjYXNlcyA9IDAKICAgICAgICBmb3IgdGVzdCBpbiBzZWxmOgogICAgICAgICAgICBjYXNlcyArPSB0ZXN0LmNvdW50VGVzdENhc2VzKCkKICAgICAgICByZXR1cm4gY2FzZXMKCiAgICBkZWYgYWRkVGVzdChzZWxmLCB0ZXN0KToKICAgICAgICAjIHNhbml0eSBjaGVja3MKICAgICAgICBpZiBub3QgY2FsbGFibGUodGVzdCk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigie30gaXMgbm90IGNhbGxhYmxlIi5mb3JtYXQocmVwcih0ZXN0KSkpCiAgICAgICAgaWYgaXNpbnN0YW5jZSh0ZXN0LCB0eXBlKSBhbmQgaXNzdWJjbGFzcyh0ZXN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNhc2UuVGVzdENhc2UsIFRlc3RTdWl0ZSkpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIlRlc3RDYXNlcyBhbmQgVGVzdFN1aXRlcyBtdXN0IGJlIGluc3RhbnRpYXRlZCAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYmVmb3JlIHBhc3NpbmcgdGhlbSB0byBhZGRUZXN0KCkiKQogICAgICAgIHNlbGYuX3Rlc3RzLmFwcGVuZCh0ZXN0KQoKICAgIGRlZiBhZGRUZXN0cyhzZWxmLCB0ZXN0cyk6CiAgICAgICAgaWYgaXNpbnN0YW5jZSh0ZXN0cywgc3RyKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJ0ZXN0cyBtdXN0IGJlIGFuIGl0ZXJhYmxlIG9mIHRlc3RzLCBub3QgYSBzdHJpbmciKQogICAgICAgIGZvciB0ZXN0IGluIHRlc3RzOgogICAgICAgICAgICBzZWxmLmFkZFRlc3QodGVzdCkKCiAgICBkZWYgcnVuKHNlbGYsIHJlc3VsdCk6CiAgICAgICAgZm9yIHRlc3QgaW4gc2VsZjoKICAgICAgICAgICAgaWYgcmVzdWx0LnNob3VsZFN0b3A6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICB0ZXN0KHJlc3VsdCkKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIF9fY2FsbF9fKHNlbGYsICphcmdzLCAqKmt3ZHMpOgogICAgICAgIHJldHVybiBzZWxmLnJ1bigqYXJncywgKiprd2RzKQoKICAgIGRlZiBkZWJ1ZyhzZWxmKToKICAgICAgICAiIiJSdW4gdGhlIHRlc3RzIHdpdGhvdXQgY29sbGVjdGluZyBlcnJvcnMgaW4gYSBUZXN0UmVzdWx0IiIiCiAgICAgICAgZm9yIHRlc3QgaW4gc2VsZjoKICAgICAgICAgICAgdGVzdC5kZWJ1ZygpCgoKY2xhc3MgVGVzdFN1aXRlKEJhc2VUZXN0U3VpdGUpOgogICAgIiIiQSB0ZXN0IHN1aXRlIGlzIGEgY29tcG9zaXRlIHRlc3QgY29uc2lzdGluZyBvZiBhIG51bWJlciBvZiBUZXN0Q2FzZXMuCgogICAgRm9yIHVzZSwgY3JlYXRlIGFuIGluc3RhbmNlIG9mIFRlc3RTdWl0ZSwgdGhlbiBhZGQgdGVzdCBjYXNlIGluc3RhbmNlcy4KICAgIFdoZW4gYWxsIHRlc3RzIGhhdmUgYmVlbiBhZGRlZCwgdGhlIHN1aXRlIGNhbiBiZSBwYXNzZWQgdG8gYSB0ZXN0CiAgICBydW5uZXIsIHN1Y2ggYXMgVGV4dFRlc3RSdW5uZXIuIEl0IHdpbGwgcnVuIHRoZSBpbmRpdmlkdWFsIHRlc3QgY2FzZXMKICAgIGluIHRoZSBvcmRlciBpbiB3aGljaCB0aGV5IHdlcmUgYWRkZWQsIGFnZ3JlZ2F0aW5nIHRoZSByZXN1bHRzLiBXaGVuCiAgICBzdWJjbGFzc2luZywgZG8gbm90IGZvcmdldCB0byBjYWxsIHRoZSBiYXNlIGNsYXNzIGNvbnN0cnVjdG9yLgogICAgIiIiCgogICAgZGVmIHJ1bihzZWxmLCByZXN1bHQsIGRlYnVnPUZhbHNlKToKICAgICAgICB0b3BMZXZlbCA9IEZhbHNlCiAgICAgICAgaWYgZ2V0YXR0cihyZXN1bHQsICdfdGVzdFJ1bkVudGVyZWQnLCBGYWxzZSkgaXMgRmFsc2U6CiAgICAgICAgICAgIHJlc3VsdC5fdGVzdFJ1bkVudGVyZWQgPSB0b3BMZXZlbCA9IFRydWUKCiAgICAgICAgZm9yIHRlc3QgaW4gc2VsZjoKICAgICAgICAgICAgaWYgcmVzdWx0LnNob3VsZFN0b3A6CiAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICAgICAgaWYgX2lzbm90c3VpdGUodGVzdCk6CiAgICAgICAgICAgICAgICBzZWxmLl90ZWFyRG93blByZXZpb3VzQ2xhc3ModGVzdCwgcmVzdWx0KQogICAgICAgICAgICAgICAgc2VsZi5faGFuZGxlTW9kdWxlRml4dHVyZSh0ZXN0LCByZXN1bHQpCiAgICAgICAgICAgICAgICBzZWxmLl9oYW5kbGVDbGFzc1NldFVwKHRlc3QsIHJlc3VsdCkKICAgICAgICAgICAgICAgIHJlc3VsdC5fcHJldmlvdXNUZXN0Q2xhc3MgPSB0ZXN0Ll9fY2xhc3NfXwoKICAgICAgICAgICAgICAgIGlmIChnZXRhdHRyKHRlc3QuX19jbGFzc19fLCAnX2NsYXNzU2V0dXBGYWlsZWQnLCBGYWxzZSkgb3IKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKHJlc3VsdCwgJ19tb2R1bGVTZXRVcEZhaWxlZCcsIEZhbHNlKSk6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIGlmIG5vdCBkZWJ1ZzoKICAgICAgICAgICAgICAgIHRlc3QocmVzdWx0KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdGVzdC5kZWJ1ZygpCgogICAgICAgIGlmIHRvcExldmVsOgogICAgICAgICAgICBzZWxmLl90ZWFyRG93blByZXZpb3VzQ2xhc3MoTm9uZSwgcmVzdWx0KQogICAgICAgICAgICBzZWxmLl9oYW5kbGVNb2R1bGVUZWFyRG93bihyZXN1bHQpCiAgICAgICAgICAgIHJlc3VsdC5fdGVzdFJ1bkVudGVyZWQgPSBGYWxzZQogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgZGVidWcoc2VsZik6CiAgICAgICAgIiIiUnVuIHRoZSB0ZXN0cyB3aXRob3V0IGNvbGxlY3RpbmcgZXJyb3JzIGluIGEgVGVzdFJlc3VsdCIiIgogICAgICAgIGRlYnVnID0gX0RlYnVnUmVzdWx0KCkKICAgICAgICBzZWxmLnJ1bihkZWJ1ZywgVHJ1ZSkKCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgIGRlZiBfaGFuZGxlQ2xhc3NTZXRVcChzZWxmLCB0ZXN0LCByZXN1bHQpOgogICAgICAgIHByZXZpb3VzQ2xhc3MgPSBnZXRhdHRyKHJlc3VsdCwgJ19wcmV2aW91c1Rlc3RDbGFzcycsIE5vbmUpCiAgICAgICAgY3VycmVudENsYXNzID0gdGVzdC5fX2NsYXNzX18KICAgICAgICBpZiBjdXJyZW50Q2xhc3MgPT0gcHJldmlvdXNDbGFzczoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgcmVzdWx0Ll9tb2R1bGVTZXRVcEZhaWxlZDoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgZ2V0YXR0cihjdXJyZW50Q2xhc3MsICJfX3VuaXR0ZXN0X3NraXBfXyIsIEZhbHNlKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRyeToKICAgICAgICAgICAgY3VycmVudENsYXNzLl9jbGFzc1NldHVwRmFpbGVkID0gRmFsc2UKICAgICAgICBleGNlcHQgVHlwZUVycm9yOgogICAgICAgICAgICAjIHRlc3QgbWF5IGFjdHVhbGx5IGJlIGEgZnVuY3Rpb24KICAgICAgICAgICAgIyBzbyBpdHMgY2xhc3Mgd2lsbCBiZSBhIGJ1aWx0aW4tdHlwZQogICAgICAgICAgICBwYXNzCgogICAgICAgIHNldFVwQ2xhc3MgPSBnZXRhdHRyKGN1cnJlbnRDbGFzcywgJ3NldFVwQ2xhc3MnLCBOb25lKQogICAgICAgIGlmIHNldFVwQ2xhc3MgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIF9jYWxsX2lmX2V4aXN0cyhyZXN1bHQsICdfc2V0dXBTdGRvdXQnKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZXRVcENsYXNzKCkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShyZXN1bHQsIF9EZWJ1Z1Jlc3VsdCk6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgICAgIGN1cnJlbnRDbGFzcy5fY2xhc3NTZXR1cEZhaWxlZCA9IFRydWUKICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9IHV0aWwuc3RyY2xhc3MoY3VycmVudENsYXNzKQogICAgICAgICAgICAgICAgZXJyb3JOYW1lID0gJ3NldFVwQ2xhc3MgKCVzKScgJSBjbGFzc05hbWUKICAgICAgICAgICAgICAgIHNlbGYuX2FkZENsYXNzT3JNb2R1bGVMZXZlbEV4Y2VwdGlvbihyZXN1bHQsIGUsIGVycm9yTmFtZSkKICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgIF9jYWxsX2lmX2V4aXN0cyhyZXN1bHQsICdfcmVzdG9yZVN0ZG91dCcpCgogICAgZGVmIF9nZXRfcHJldmlvdXNfbW9kdWxlKHNlbGYsIHJlc3VsdCk6CiAgICAgICAgcHJldmlvdXNNb2R1bGUgPSBOb25lCiAgICAgICAgcHJldmlvdXNDbGFzcyA9IGdldGF0dHIocmVzdWx0LCAnX3ByZXZpb3VzVGVzdENsYXNzJywgTm9uZSkKICAgICAgICBpZiBwcmV2aW91c0NsYXNzIGlzIG5vdCBOb25lOgogICAgICAgICAgICBwcmV2aW91c01vZHVsZSA9IHByZXZpb3VzQ2xhc3MuX19tb2R1bGVfXwogICAgICAgIHJldHVybiBwcmV2aW91c01vZHVsZQoKCiAgICBkZWYgX2hhbmRsZU1vZHVsZUZpeHR1cmUoc2VsZiwgdGVzdCwgcmVzdWx0KToKICAgICAgICBwcmV2aW91c01vZHVsZSA9IHNlbGYuX2dldF9wcmV2aW91c19tb2R1bGUocmVzdWx0KQogICAgICAgIGN1cnJlbnRNb2R1bGUgPSB0ZXN0Ll9fY2xhc3NfXy5fX21vZHVsZV9fCiAgICAgICAgaWYgY3VycmVudE1vZHVsZSA9PSBwcmV2aW91c01vZHVsZToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuX2hhbmRsZU1vZHVsZVRlYXJEb3duKHJlc3VsdCkKCgogICAgICAgIHJlc3VsdC5fbW9kdWxlU2V0VXBGYWlsZWQgPSBGYWxzZQogICAgICAgIHRyeToKICAgICAgICAgICAgbW9kdWxlID0gc3lzLm1vZHVsZXNbY3VycmVudE1vZHVsZV0KICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIHNldFVwTW9kdWxlID0gZ2V0YXR0cihtb2R1bGUsICdzZXRVcE1vZHVsZScsIE5vbmUpCiAgICAgICAgaWYgc2V0VXBNb2R1bGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIF9jYWxsX2lmX2V4aXN0cyhyZXN1bHQsICdfc2V0dXBTdGRvdXQnKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZXRVcE1vZHVsZSgpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UocmVzdWx0LCBfRGVidWdSZXN1bHQpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICAgICByZXN1bHQuX21vZHVsZVNldFVwRmFpbGVkID0gVHJ1ZQogICAgICAgICAgICAgICAgZXJyb3JOYW1lID0gJ3NldFVwTW9kdWxlICglcyknICUgY3VycmVudE1vZHVsZQogICAgICAgICAgICAgICAgc2VsZi5fYWRkQ2xhc3NPck1vZHVsZUxldmVsRXhjZXB0aW9uKHJlc3VsdCwgZSwgZXJyb3JOYW1lKQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgX2NhbGxfaWZfZXhpc3RzKHJlc3VsdCwgJ19yZXN0b3JlU3Rkb3V0JykKCiAgICBkZWYgX2FkZENsYXNzT3JNb2R1bGVMZXZlbEV4Y2VwdGlvbihzZWxmLCByZXN1bHQsIGV4Y2VwdGlvbiwgZXJyb3JOYW1lKToKICAgICAgICBlcnJvciA9IF9FcnJvckhvbGRlcihlcnJvck5hbWUpCiAgICAgICAgYWRkU2tpcCA9IGdldGF0dHIocmVzdWx0LCAnYWRkU2tpcCcsIE5vbmUpCiAgICAgICAgaWYgYWRkU2tpcCBpcyBub3QgTm9uZSBhbmQgaXNpbnN0YW5jZShleGNlcHRpb24sIGNhc2UuU2tpcFRlc3QpOgogICAgICAgICAgICBhZGRTa2lwKGVycm9yLCBzdHIoZXhjZXB0aW9uKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXN1bHQuYWRkRXJyb3IoZXJyb3IsIHN5cy5leGNfaW5mbygpKQoKICAgIGRlZiBfaGFuZGxlTW9kdWxlVGVhckRvd24oc2VsZiwgcmVzdWx0KToKICAgICAgICBwcmV2aW91c01vZHVsZSA9IHNlbGYuX2dldF9wcmV2aW91c19tb2R1bGUocmVzdWx0KQogICAgICAgIGlmIHByZXZpb3VzTW9kdWxlIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIGlmIHJlc3VsdC5fbW9kdWxlU2V0VXBGYWlsZWQ6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIG1vZHVsZSA9IHN5cy5tb2R1bGVzW3ByZXZpb3VzTW9kdWxlXQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRlYXJEb3duTW9kdWxlID0gZ2V0YXR0cihtb2R1bGUsICd0ZWFyRG93bk1vZHVsZScsIE5vbmUpCiAgICAgICAgaWYgdGVhckRvd25Nb2R1bGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIF9jYWxsX2lmX2V4aXN0cyhyZXN1bHQsICdfc2V0dXBTdGRvdXQnKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB0ZWFyRG93bk1vZHVsZSgpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UocmVzdWx0LCBfRGVidWdSZXN1bHQpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICAgICBlcnJvck5hbWUgPSAndGVhckRvd25Nb2R1bGUgKCVzKScgJSBwcmV2aW91c01vZHVsZQogICAgICAgICAgICAgICAgc2VsZi5fYWRkQ2xhc3NPck1vZHVsZUxldmVsRXhjZXB0aW9uKHJlc3VsdCwgZSwgZXJyb3JOYW1lKQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgX2NhbGxfaWZfZXhpc3RzKHJlc3VsdCwgJ19yZXN0b3JlU3Rkb3V0JykKCiAgICBkZWYgX3RlYXJEb3duUHJldmlvdXNDbGFzcyhzZWxmLCB0ZXN0LCByZXN1bHQpOgogICAgICAgIHByZXZpb3VzQ2xhc3MgPSBnZXRhdHRyKHJlc3VsdCwgJ19wcmV2aW91c1Rlc3RDbGFzcycsIE5vbmUpCiAgICAgICAgY3VycmVudENsYXNzID0gdGVzdC5fX2NsYXNzX18KICAgICAgICBpZiBjdXJyZW50Q2xhc3MgPT0gcHJldmlvdXNDbGFzczoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgZ2V0YXR0cihwcmV2aW91c0NsYXNzLCAnX2NsYXNzU2V0dXBGYWlsZWQnLCBGYWxzZSk6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIGlmIGdldGF0dHIocmVzdWx0LCAnX21vZHVsZVNldFVwRmFpbGVkJywgRmFsc2UpOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBpZiBnZXRhdHRyKHByZXZpb3VzQ2xhc3MsICJfX3VuaXR0ZXN0X3NraXBfXyIsIEZhbHNlKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRlYXJEb3duQ2xhc3MgPSBnZXRhdHRyKHByZXZpb3VzQ2xhc3MsICd0ZWFyRG93bkNsYXNzJywgTm9uZSkKICAgICAgICBpZiB0ZWFyRG93bkNsYXNzIGlzIG5vdCBOb25lOgogICAgICAgICAgICBfY2FsbF9pZl9leGlzdHMocmVzdWx0LCAnX3NldHVwU3Rkb3V0JykKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgdGVhckRvd25DbGFzcygpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UocmVzdWx0LCBfRGVidWdSZXN1bHQpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICAgICBjbGFzc05hbWUgPSB1dGlsLnN0cmNsYXNzKHByZXZpb3VzQ2xhc3MpCiAgICAgICAgICAgICAgICBlcnJvck5hbWUgPSAndGVhckRvd25DbGFzcyAoJXMpJyAlIGNsYXNzTmFtZQogICAgICAgICAgICAgICAgc2VsZi5fYWRkQ2xhc3NPck1vZHVsZUxldmVsRXhjZXB0aW9uKHJlc3VsdCwgZSwgZXJyb3JOYW1lKQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgX2NhbGxfaWZfZXhpc3RzKHJlc3VsdCwgJ19yZXN0b3JlU3Rkb3V0JykKCgpjbGFzcyBfRXJyb3JIb2xkZXIob2JqZWN0KToKICAgICIiIgogICAgUGxhY2Vob2xkZXIgZm9yIGEgVGVzdENhc2UgaW5zaWRlIGEgcmVzdWx0LiBBcyBmYXIgYXMgYSBUZXN0UmVzdWx0CiAgICBpcyBjb25jZXJuZWQsIHRoaXMgbG9va3MgZXhhY3RseSBsaWtlIGEgdW5pdCB0ZXN0LiBVc2VkIHRvIGluc2VydAogICAgYXJiaXRyYXJ5IGVycm9ycyBpbnRvIGEgdGVzdCBzdWl0ZSBydW4uCiAgICAiIiIKICAgICMgSW5zcGlyZWQgYnkgdGhlIEVycm9ySG9sZGVyIGZyb20gVHdpc3RlZDoKICAgICMgaHR0cDovL3R3aXN0ZWRtYXRyaXguY29tL3RyYWMvYnJvd3Nlci90cnVuay90d2lzdGVkL3RyaWFsL3J1bm5lci5weQoKICAgICMgYXR0cmlidXRlIHVzZWQgYnkgVGVzdFJlc3VsdC5fZXhjX2luZm9fdG9fc3RyaW5nCiAgICBmYWlsdXJlRXhjZXB0aW9uID0gTm9uZQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBkZXNjcmlwdGlvbik6CiAgICAgICAgc2VsZi5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uCgogICAgZGVmIGlkKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmRlc2NyaXB0aW9uCgogICAgZGVmIHNob3J0RGVzY3JpcHRpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICI8RXJyb3JIb2xkZXIgZGVzY3JpcHRpb249JXI+IiAlIChzZWxmLmRlc2NyaXB0aW9uLCkKCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5pZCgpCgogICAgZGVmIHJ1bihzZWxmLCByZXN1bHQpOgogICAgICAgICMgY291bGQgY2FsbCByZXN1bHQuYWRkRXJyb3IoLi4uKSAtIGJ1dCB0aGlzIHRlc3QtbGlrZSBvYmplY3QKICAgICAgICAjIHNob3VsZG4ndCBiZSBydW4gYW55d2F5CiAgICAgICAgcGFzcwoKICAgIGRlZiBfX2NhbGxfXyhzZWxmLCByZXN1bHQpOgogICAgICAgIHJldHVybiBzZWxmLnJ1bihyZXN1bHQpCgogICAgZGVmIGNvdW50VGVzdENhc2VzKHNlbGYpOgogICAgICAgIHJldHVybiAwCgpkZWYgX2lzbm90c3VpdGUodGVzdCk6CiAgICAiQSBjcnVkZSB3YXkgdG8gdGVsbCBhcGFydCB0ZXN0Y2FzZXMgYW5kIHN1aXRlcyB3aXRoIGR1Y2stdHlwaW5nIgogICAgdHJ5OgogICAgICAgIGl0ZXIodGVzdCkKICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgcmV0dXJuIFRydWUKICAgIHJldHVybiBGYWxzZQoKCmNsYXNzIF9EZWJ1Z1Jlc3VsdChvYmplY3QpOgogICAgIlVzZWQgYnkgdGhlIFRlc3RTdWl0ZSB0byBob2xkIHByZXZpb3VzIGNsYXNzIHdoZW4gcnVubmluZyBpbiBkZWJ1Zy4iCiAgICBfcHJldmlvdXNUZXN0Q2xhc3MgPSBOb25lCiAgICBfbW9kdWxlU2V0VXBGYWlsZWQgPSBGYWxzZQogICAgc2hvdWxkU3RvcCA9IEZhbHNlCg==',
'/Lib/unittest/util.py':'IiIiVmFyaW91cyB1dGlsaXR5IGZ1bmN0aW9ucy4iIiIKCmZyb20gY29sbGVjdGlvbnMgaW1wb3J0IG5hbWVkdHVwbGUsIE9yZGVyZWREaWN0CgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKX01BWF9MRU5HVEggPSA4MApkZWYgc2FmZV9yZXByKG9iaiwgc2hvcnQ9RmFsc2UpOgogICAgdHJ5OgogICAgICAgIHJlc3VsdCA9IHJlcHIob2JqKQogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICByZXN1bHQgPSBvYmplY3QuX19yZXByX18ob2JqKQogICAgaWYgbm90IHNob3J0IG9yIGxlbihyZXN1bHQpIDwgX01BWF9MRU5HVEg6CiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgcmV0dXJuIHJlc3VsdFs6X01BWF9MRU5HVEhdICsgJyBbdHJ1bmNhdGVkXS4uLicKCmRlZiBzdHJjbGFzcyhjbHMpOgogICAgcmV0dXJuICIlcy4lcyIgJSAoY2xzLl9fbW9kdWxlX18sIGNscy5fX25hbWVfXykKCmRlZiBzb3J0ZWRfbGlzdF9kaWZmZXJlbmNlKGV4cGVjdGVkLCBhY3R1YWwpOgogICAgIiIiRmluZHMgZWxlbWVudHMgaW4gb25seSBvbmUgb3IgdGhlIG90aGVyIG9mIHR3bywgc29ydGVkIGlucHV0IGxpc3RzLgoKICAgIFJldHVybnMgYSB0d28tZWxlbWVudCB0dXBsZSBvZiBsaXN0cy4gICAgVGhlIGZpcnN0IGxpc3QgY29udGFpbnMgdGhvc2UKICAgIGVsZW1lbnRzIGluIHRoZSAiZXhwZWN0ZWQiIGxpc3QgYnV0IG5vdCBpbiB0aGUgImFjdHVhbCIgbGlzdCwgYW5kIHRoZQogICAgc2Vjb25kIGNvbnRhaW5zIHRob3NlIGVsZW1lbnRzIGluIHRoZSAiYWN0dWFsIiBsaXN0IGJ1dCBub3QgaW4gdGhlCiAgICAiZXhwZWN0ZWQiIGxpc3QuICAgIER1cGxpY2F0ZSBlbGVtZW50cyBpbiBlaXRoZXIgaW5wdXQgbGlzdCBhcmUgaWdub3JlZC4KICAgICIiIgogICAgaSA9IGogPSAwCiAgICBtaXNzaW5nID0gW10KICAgIHVuZXhwZWN0ZWQgPSBbXQogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGUgPSBleHBlY3RlZFtpXQogICAgICAgICAgICBhID0gYWN0dWFsW2pdCiAgICAgICAgICAgIGlmIGUgPCBhOgogICAgICAgICAgICAgICAgbWlzc2luZy5hcHBlbmQoZSkKICAgICAgICAgICAgICAgIGkgKz0gMQogICAgICAgICAgICAgICAgd2hpbGUgZXhwZWN0ZWRbaV0gPT0gZToKICAgICAgICAgICAgICAgICAgICBpICs9IDEKICAgICAgICAgICAgZWxpZiBlID4gYToKICAgICAgICAgICAgICAgIHVuZXhwZWN0ZWQuYXBwZW5kKGEpCiAgICAgICAgICAgICAgICBqICs9IDEKICAgICAgICAgICAgICAgIHdoaWxlIGFjdHVhbFtqXSA9PSBhOgogICAgICAgICAgICAgICAgICAgIGogKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaSArPSAxCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgZXhwZWN0ZWRbaV0gPT0gZToKICAgICAgICAgICAgICAgICAgICAgICAgaSArPSAxCiAgICAgICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgICAgIGogKz0gMQogICAgICAgICAgICAgICAgICAgIHdoaWxlIGFjdHVhbFtqXSA9PSBhOgogICAgICAgICAgICAgICAgICAgICAgICBqICs9IDEKICAgICAgICBleGNlcHQgSW5kZXhFcnJvcjoKICAgICAgICAgICAgbWlzc2luZy5leHRlbmQoZXhwZWN0ZWRbaTpdKQogICAgICAgICAgICB1bmV4cGVjdGVkLmV4dGVuZChhY3R1YWxbajpdKQogICAgICAgICAgICBicmVhawogICAgcmV0dXJuIG1pc3NpbmcsIHVuZXhwZWN0ZWQKCgpkZWYgdW5vcmRlcmFibGVfbGlzdF9kaWZmZXJlbmNlKGV4cGVjdGVkLCBhY3R1YWwpOgogICAgIiIiU2FtZSBiZWhhdmlvciBhcyBzb3J0ZWRfbGlzdF9kaWZmZXJlbmNlIGJ1dAogICAgZm9yIGxpc3RzIG9mIHVub3JkZXJhYmxlIGl0ZW1zIChsaWtlIGRpY3RzKS4KCiAgICBBcyBpdCBkb2VzIGEgbGluZWFyIHNlYXJjaCBwZXIgaXRlbSAocmVtb3ZlKSBpdAogICAgaGFzIE8obipuKSBwZXJmb3JtYW5jZS4iIiIKICAgIG1pc3NpbmcgPSBbXQogICAgd2hpbGUgZXhwZWN0ZWQ6CiAgICAgICAgaXRlbSA9IGV4cGVjdGVkLnBvcCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBhY3R1YWwucmVtb3ZlKGl0ZW0pCiAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgIG1pc3NpbmcuYXBwZW5kKGl0ZW0pCgogICAgIyBhbnl0aGluZyBsZWZ0IGluIGFjdHVhbCBpcyB1bmV4cGVjdGVkCiAgICByZXR1cm4gbWlzc2luZywgYWN0dWFsCgpkZWYgdGhyZWVfd2F5X2NtcCh4LCB5KToKICAgICIiIlJldHVybiAtMSBpZiB4IDwgeSwgMCBpZiB4ID09IHkgYW5kIDEgaWYgeCA+IHkiIiIKICAgIHJldHVybiAoeCA+IHkpIC0gKHggPCB5KQoKX01pc21hdGNoID0gbmFtZWR0dXBsZSgnTWlzbWF0Y2gnLCAnYWN0dWFsIGV4cGVjdGVkIHZhbHVlJykKCmRlZiBfY291bnRfZGlmZl9hbGxfcHVycG9zZShhY3R1YWwsIGV4cGVjdGVkKToKICAgICdSZXR1cm5zIGxpc3Qgb2YgKGNudF9hY3QsIGNudF9leHAsIGVsZW0pIHRyaXBsZXMgd2hlcmUgdGhlIGNvdW50cyBkaWZmZXInCiAgICAjIGVsZW1lbnRzIG5lZWQgbm90IGJlIGhhc2hhYmxlCiAgICBzLCB0ID0gbGlzdChhY3R1YWwpLCBsaXN0KGV4cGVjdGVkKQogICAgbSwgbiA9IGxlbihzKSwgbGVuKHQpCiAgICBOVUxMID0gb2JqZWN0KCkKICAgIHJlc3VsdCA9IFtdCiAgICBmb3IgaSwgZWxlbSBpbiBlbnVtZXJhdGUocyk6CiAgICAgICAgaWYgZWxlbSBpcyBOVUxMOgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGNudF9zID0gY250X3QgPSAwCiAgICAgICAgZm9yIGogaW4gcmFuZ2UoaSwgbSk6CiAgICAgICAgICAgIGlmIHNbal0gPT0gZWxlbToKICAgICAgICAgICAgICAgIGNudF9zICs9IDEKICAgICAgICAgICAgICAgIHNbal0gPSBOVUxMCiAgICAgICAgZm9yIGosIG90aGVyX2VsZW0gaW4gZW51bWVyYXRlKHQpOgogICAgICAgICAgICBpZiBvdGhlcl9lbGVtID09IGVsZW06CiAgICAgICAgICAgICAgICBjbnRfdCArPSAxCiAgICAgICAgICAgICAgICB0W2pdID0gTlVMTAogICAgICAgIGlmIGNudF9zICE9IGNudF90OgogICAgICAgICAgICBkaWZmID0gX01pc21hdGNoKGNudF9zLCBjbnRfdCwgZWxlbSkKICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChkaWZmKQoKICAgIGZvciBpLCBlbGVtIGluIGVudW1lcmF0ZSh0KToKICAgICAgICBpZiBlbGVtIGlzIE5VTEw6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgY250X3QgPSAwCiAgICAgICAgZm9yIGogaW4gcmFuZ2UoaSwgbik6CiAgICAgICAgICAgIGlmIHRbal0gPT0gZWxlbToKICAgICAgICAgICAgICAgIGNudF90ICs9IDEKICAgICAgICAgICAgICAgIHRbal0gPSBOVUxMCiAgICAgICAgZGlmZiA9IF9NaXNtYXRjaCgwLCBjbnRfdCwgZWxlbSkKICAgICAgICByZXN1bHQuYXBwZW5kKGRpZmYpCiAgICByZXR1cm4gcmVzdWx0CgpkZWYgX29yZGVyZWRfY291bnQoaXRlcmFibGUpOgogICAgJ1JldHVybiBkaWN0IG9mIGVsZW1lbnQgY291bnRzLCBpbiB0aGUgb3JkZXIgdGhleSB3ZXJlIGZpcnN0IHNlZW4nCiAgICBjID0gT3JkZXJlZERpY3QoKQogICAgZm9yIGVsZW0gaW4gaXRlcmFibGU6CiAgICAgICAgY1tlbGVtXSA9IGMuZ2V0KGVsZW0sIDApICsgMQogICAgcmV0dXJuIGMKCmRlZiBfY291bnRfZGlmZl9oYXNoYWJsZShhY3R1YWwsIGV4cGVjdGVkKToKICAgICdSZXR1cm5zIGxpc3Qgb2YgKGNudF9hY3QsIGNudF9leHAsIGVsZW0pIHRyaXBsZXMgd2hlcmUgdGhlIGNvdW50cyBkaWZmZXInCiAgICAjIGVsZW1lbnRzIG11c3QgYmUgaGFzaGFibGUKICAgIHMsIHQgPSBfb3JkZXJlZF9jb3VudChhY3R1YWwpLCBfb3JkZXJlZF9jb3VudChleHBlY3RlZCkKICAgIHJlc3VsdCA9IFtdCiAgICBmb3IgZWxlbSwgY250X3MgaW4gcy5pdGVtcygpOgogICAgICAgIGNudF90ID0gdC5nZXQoZWxlbSwgMCkKICAgICAgICBpZiBjbnRfcyAhPSBjbnRfdDoKICAgICAgICAgICAgZGlmZiA9IF9NaXNtYXRjaChjbnRfcywgY250X3QsIGVsZW0pCiAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoZGlmZikKICAgIGZvciBlbGVtLCBjbnRfdCBpbiB0Lml0ZW1zKCk6CiAgICAgICAgaWYgZWxlbSBub3QgaW4gczoKICAgICAgICAgICAgZGlmZiA9IF9NaXNtYXRjaCgwLCBjbnRfdCwgZWxlbSkKICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChkaWZmKQogICAgcmV0dXJuIHJlc3VsdAo=',
'/Lib/unittest/__init__.py':'IiIiClB5dGhvbiB1bml0IHRlc3RpbmcgZnJhbWV3b3JrLCBiYXNlZCBvbiBFcmljaCBHYW1tYSdzIEpVbml0IGFuZCBLZW50IEJlY2sncwpTbWFsbHRhbGsgdGVzdGluZyBmcmFtZXdvcmsuCgpUaGlzIG1vZHVsZSBjb250YWlucyB0aGUgY29yZSBmcmFtZXdvcmsgY2xhc3NlcyB0aGF0IGZvcm0gdGhlIGJhc2lzIG9mCnNwZWNpZmljIHRlc3QgY2FzZXMgYW5kIHN1aXRlcyAoVGVzdENhc2UsIFRlc3RTdWl0ZSBldGMuKSwgYW5kIGFsc28gYQp0ZXh0LWJhc2VkIHV0aWxpdHkgY2xhc3MgZm9yIHJ1bm5pbmcgdGhlIHRlc3RzIGFuZCByZXBvcnRpbmcgdGhlIHJlc3VsdHMKIChUZXh0VGVzdFJ1bm5lcikuCgpTaW1wbGUgdXNhZ2U6CgogICAgaW1wb3J0IHVuaXR0ZXN0CgogICAgY2xhc3MgSW50ZWdlckFyaXRobWVudGljVGVzdENhc2UodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgIGRlZiB0ZXN0QWRkKHNlbGYpOiAgIyMgdGVzdCBtZXRob2QgbmFtZXMgYmVnaW4gJ3Rlc3QqJwogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKCgxICsgMiksIDMpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoMCArIDEsIDEpCiAgICAgICAgZGVmIHRlc3RNdWx0aXBseShzZWxmKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgoMCAqIDEwKSwgMCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgoNSAqIDgpLCA0MCkKCiAgICBpZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgICAgIHVuaXR0ZXN0Lm1haW4oKQoKRnVydGhlciBpbmZvcm1hdGlvbiBpcyBhdmFpbGFibGUgaW4gdGhlIGJ1bmRsZWQgZG9jdW1lbnRhdGlvbiwgYW5kIGZyb20KCiAgaHR0cDovL2RvY3MucHl0aG9uLm9yZy9saWJyYXJ5L3VuaXR0ZXN0Lmh0bWwKCkNvcHlyaWdodCAoYykgMTk5OS0yMDAzIFN0ZXZlIFB1cmNlbGwKQ29weXJpZ2h0IChjKSAyMDAzLTIwMTAgUHl0aG9uIFNvZnR3YXJlIEZvdW5kYXRpb24KVGhpcyBtb2R1bGUgaXMgZnJlZSBzb2Z0d2FyZSwgYW5kIHlvdSBtYXkgcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKaXQgdW5kZXIgdGhlIHNhbWUgdGVybXMgYXMgUHl0aG9uIGl0c2VsZiwgc28gbG9uZyBhcyB0aGlzIGNvcHlyaWdodCBtZXNzYWdlCmFuZCBkaXNjbGFpbWVyIGFyZSByZXRhaW5lZCBpbiB0aGVpciBvcmlnaW5hbCBmb3JtLgoKSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgVE8gQU5ZIFBBUlRZIEZPUiBESVJFQ1QsIElORElSRUNULApTUEVDSUFMLCBJTkNJREVOVEFMLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgQVJJU0lORyBPVVQgT0YgVEhFIFVTRSBPRgpUSElTIENPREUsIEVWRU4gSUYgVEhFIEFVVEhPUiBIQVMgQkVFTiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNICkRBTUFHRS4KClRIRSBBVVRIT1IgU1BFQ0lGSUNBTExZIERJU0NMQUlNUyBBTlkgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UCkxJTUlURUQgVE8sIFRIRSBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBClBBUlRJQ1VMQVIgUFVSUE9TRS4gIFRIRSBDT0RFIFBST1ZJREVEIEhFUkVVTkRFUiBJUyBPTiBBTiAiQVMgSVMiIEJBU0lTLApBTkQgVEhFUkUgSVMgTk8gT0JMSUdBVElPTiBXSEFUU09FVkVSIFRPIFBST1ZJREUgTUFJTlRFTkFOQ0UsClNVUFBPUlQsIFVQREFURVMsIEVOSEFOQ0VNRU5UUywgT1IgTU9ESUZJQ0FUSU9OUy4KIiIiCgpfX2FsbF9fID0gWydUZXN0UmVzdWx0JywgJ1Rlc3RDYXNlJywgJ1Rlc3RTdWl0ZScsCiAgICAgICAgICAgJ1RleHRUZXN0UnVubmVyJywgJ1Rlc3RMb2FkZXInLCAnRnVuY3Rpb25UZXN0Q2FzZScsICdtYWluJywKICAgICAgICAgICAnZGVmYXVsdFRlc3RMb2FkZXInLCAnU2tpcFRlc3QnLCAnc2tpcCcsICdza2lwSWYnLCAnc2tpcFVubGVzcycsCiAgICAgICAgICAgJ2V4cGVjdGVkRmFpbHVyZScsICdUZXh0VGVzdFJlc3VsdCcsICdpbnN0YWxsSGFuZGxlcicsCiAgICAgICAgICAgJ3JlZ2lzdGVyUmVzdWx0JywgJ3JlbW92ZVJlc3VsdCcsICdyZW1vdmVIYW5kbGVyJ10KCiMgRXhwb3NlIG9ic29sZXRlIGZ1bmN0aW9ucyBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkKX19hbGxfXy5leHRlbmQoWydnZXRUZXN0Q2FzZU5hbWVzJywgJ21ha2VTdWl0ZScsICdmaW5kVGVzdENhc2VzJ10pCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKZnJvbSAucmVzdWx0IGltcG9ydCBUZXN0UmVzdWx0CmZyb20gLmNhc2UgaW1wb3J0IChUZXN0Q2FzZSwgRnVuY3Rpb25UZXN0Q2FzZSwgU2tpcFRlc3QsIHNraXAsIHNraXBJZiwKICAgICAgICAgICAgICAgICAgIHNraXBVbmxlc3MsIGV4cGVjdGVkRmFpbHVyZSkKZnJvbSAuc3VpdGUgaW1wb3J0IEJhc2VUZXN0U3VpdGUsIFRlc3RTdWl0ZQpmcm9tIC5sb2FkZXIgaW1wb3J0IChUZXN0TG9hZGVyLCBkZWZhdWx0VGVzdExvYWRlciwgbWFrZVN1aXRlLCBnZXRUZXN0Q2FzZU5hbWVzLAogICAgICAgICAgICAgICAgICAgICBmaW5kVGVzdENhc2VzKQpmcm9tIC5tYWluIGltcG9ydCBUZXN0UHJvZ3JhbSwgbWFpbgpmcm9tIC5ydW5uZXIgaW1wb3J0IFRleHRUZXN0UnVubmVyLCBUZXh0VGVzdFJlc3VsdApmcm9tIC5zaWduYWxzIGltcG9ydCBpbnN0YWxsSGFuZGxlciwgcmVnaXN0ZXJSZXN1bHQsIHJlbW92ZVJlc3VsdCwgcmVtb3ZlSGFuZGxlcgoKIyBkZXByZWNhdGVkCl9UZXh0VGVzdFJlc3VsdCA9IFRleHRUZXN0UmVzdWx0Cg==',
'/Lib/unittest/__main__.py':'IiIiTWFpbiBlbnRyeSBwb2ludCIiIgoKaW1wb3J0IHN5cwppZiBzeXMuYXJndlswXS5lbmRzd2l0aCgiX19tYWluX18ucHkiKToKICAgIHN5cy5hcmd2WzBdID0gInB5dGhvbiAtbSB1bml0dGVzdCIKCl9fdW5pdHRlc3QgPSBUcnVlCgpmcm9tIC5tYWluIGltcG9ydCBtYWluLCBUZXN0UHJvZ3JhbSwgVVNBR0VfQVNfTUFJTgpUZXN0UHJvZ3JhbS5VU0FHRSA9IFVTQUdFX0FTX01BSU4KCm1haW4obW9kdWxlPU5vbmUpCg==',
'/Lib/unittest/test/dummy.py':'IyBFbXB0eSBtb2R1bGUgZm9yIHRlc3RpbmcgdGhlIGxvYWRpbmcgb2YgbW9kdWxlcwo=',
'/Lib/unittest/test/support.py':'aW1wb3J0IHVuaXR0ZXN0CgoKY2xhc3MgVGVzdEVxdWFsaXR5KG9iamVjdCk6CiAgICAiIiJVc2VkIGFzIGEgbWl4aW4gZm9yIFRlc3RDYXNlIiIiCgogICAgIyBDaGVjayBmb3IgYSB2YWxpZCBfX2VxX18gaW1wbGVtZW50YXRpb24KICAgIGRlZiB0ZXN0X2VxKHNlbGYpOgogICAgICAgIGZvciBvYmpfMSwgb2JqXzIgaW4gc2VsZi5lcV9wYWlyczoKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChvYmpfMSwgb2JqXzIpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwob2JqXzIsIG9ial8xKQoKICAgICMgQ2hlY2sgZm9yIGEgdmFsaWQgX19uZV9fIGltcGxlbWVudGF0aW9uCiAgICBkZWYgdGVzdF9uZShzZWxmKToKICAgICAgICBmb3Igb2JqXzEsIG9ial8yIGluIHNlbGYubmVfcGFpcnM6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwob2JqXzEsIG9ial8yKQogICAgICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKG9ial8yLCBvYmpfMSkKCmNsYXNzIFRlc3RIYXNoaW5nKG9iamVjdCk6CiAgICAiIiJVc2VkIGFzIGEgbWl4aW4gZm9yIFRlc3RDYXNlIiIiCgogICAgIyBDaGVjayBmb3IgYSB2YWxpZCBfX2hhc2hfXyBpbXBsZW1lbnRhdGlvbgogICAgZGVmIHRlc3RfaGFzaChzZWxmKToKICAgICAgICBmb3Igb2JqXzEsIG9ial8yIGluIHNlbGYuZXFfcGFpcnM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIG5vdCBoYXNoKG9ial8xKSA9PSBoYXNoKG9ial8yKToKICAgICAgICAgICAgICAgICAgICBzZWxmLmZhaWwoIiVyIGFuZCAlciBkbyBub3QgaGFzaCBlcXVhbCIgJSAob2JqXzEsIG9ial8yKSkKICAgICAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgc2VsZi5mYWlsKCJQcm9ibGVtIGhhc2hpbmcgJXIgYW5kICVyOiAlcyIgJSAob2JqXzEsIG9ial8yLCBlKSkKCiAgICAgICAgZm9yIG9ial8xLCBvYmpfMiBpbiBzZWxmLm5lX3BhaXJzOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpZiBoYXNoKG9ial8xKSA9PSBoYXNoKG9ial8yKToKICAgICAgICAgICAgICAgICAgICBzZWxmLmZhaWwoIiVzIGFuZCAlcyBoYXNoIGVxdWFsLCBidXQgc2hvdWxkbid0IiAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChvYmpfMSwgb2JqXzIpKQogICAgICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBzZWxmLmZhaWwoIlByb2JsZW0gaGFzaGluZyAlcyBhbmQgJXM6ICVzIiAlIChvYmpfMSwgb2JqXzIsIGUpKQoKCmNsYXNzIExvZ2dpbmdSZXN1bHQodW5pdHRlc3QuVGVzdFJlc3VsdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgbG9nKToKICAgICAgICBzZWxmLl9ldmVudHMgPSBsb2cKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKCiAgICBkZWYgc3RhcnRUZXN0KHNlbGYsIHRlc3QpOgogICAgICAgIHNlbGYuX2V2ZW50cy5hcHBlbmQoJ3N0YXJ0VGVzdCcpCiAgICAgICAgc3VwZXIoKS5zdGFydFRlc3QodGVzdCkKCiAgICBkZWYgc3RhcnRUZXN0UnVuKHNlbGYpOgogICAgICAgIHNlbGYuX2V2ZW50cy5hcHBlbmQoJ3N0YXJ0VGVzdFJ1bicpCiAgICAgICAgc3VwZXIoTG9nZ2luZ1Jlc3VsdCwgc2VsZikuc3RhcnRUZXN0UnVuKCkKCiAgICBkZWYgc3RvcFRlc3Qoc2VsZiwgdGVzdCk6CiAgICAgICAgc2VsZi5fZXZlbnRzLmFwcGVuZCgnc3RvcFRlc3QnKQogICAgICAgIHN1cGVyKCkuc3RvcFRlc3QodGVzdCkKCiAgICBkZWYgc3RvcFRlc3RSdW4oc2VsZik6CiAgICAgICAgc2VsZi5fZXZlbnRzLmFwcGVuZCgnc3RvcFRlc3RSdW4nKQogICAgICAgIHN1cGVyKExvZ2dpbmdSZXN1bHQsIHNlbGYpLnN0b3BUZXN0UnVuKCkKCiAgICBkZWYgYWRkRmFpbHVyZShzZWxmLCAqYXJncyk6CiAgICAgICAgc2VsZi5fZXZlbnRzLmFwcGVuZCgnYWRkRmFpbHVyZScpCiAgICAgICAgc3VwZXIoKS5hZGRGYWlsdXJlKCphcmdzKQoKICAgIGRlZiBhZGRTdWNjZXNzKHNlbGYsICphcmdzKToKICAgICAgICBzZWxmLl9ldmVudHMuYXBwZW5kKCdhZGRTdWNjZXNzJykKICAgICAgICBzdXBlcihMb2dnaW5nUmVzdWx0LCBzZWxmKS5hZGRTdWNjZXNzKCphcmdzKQoKICAgIGRlZiBhZGRFcnJvcihzZWxmLCAqYXJncyk6CiAgICAgICAgc2VsZi5fZXZlbnRzLmFwcGVuZCgnYWRkRXJyb3InKQogICAgICAgIHN1cGVyKCkuYWRkRXJyb3IoKmFyZ3MpCgogICAgZGVmIGFkZFNraXAoc2VsZiwgKmFyZ3MpOgogICAgICAgIHNlbGYuX2V2ZW50cy5hcHBlbmQoJ2FkZFNraXAnKQogICAgICAgIHN1cGVyKExvZ2dpbmdSZXN1bHQsIHNlbGYpLmFkZFNraXAoKmFyZ3MpCgogICAgZGVmIGFkZEV4cGVjdGVkRmFpbHVyZShzZWxmLCAqYXJncyk6CiAgICAgICAgc2VsZi5fZXZlbnRzLmFwcGVuZCgnYWRkRXhwZWN0ZWRGYWlsdXJlJykKICAgICAgICBzdXBlcihMb2dnaW5nUmVzdWx0LCBzZWxmKS5hZGRFeHBlY3RlZEZhaWx1cmUoKmFyZ3MpCgogICAgZGVmIGFkZFVuZXhwZWN0ZWRTdWNjZXNzKHNlbGYsICphcmdzKToKICAgICAgICBzZWxmLl9ldmVudHMuYXBwZW5kKCdhZGRVbmV4cGVjdGVkU3VjY2VzcycpCiAgICAgICAgc3VwZXIoTG9nZ2luZ1Jlc3VsdCwgc2VsZikuYWRkVW5leHBlY3RlZFN1Y2Nlc3MoKmFyZ3MpCgoKY2xhc3MgUmVzdWx0V2l0aE5vU3RhcnRUZXN0UnVuU3RvcFRlc3RSdW4ob2JqZWN0KToKICAgICIiIkFuIG9iamVjdCBob25vdXJpbmcgVGVzdFJlc3VsdCBiZWZvcmUgc3RhcnRUZXN0UnVuL3N0b3BUZXN0UnVuLiIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLmZhaWx1cmVzID0gW10KICAgICAgICBzZWxmLmVycm9ycyA9IFtdCiAgICAgICAgc2VsZi50ZXN0c1J1biA9IDAKICAgICAgICBzZWxmLnNraXBwZWQgPSBbXQogICAgICAgIHNlbGYuZXhwZWN0ZWRGYWlsdXJlcyA9IFtdCiAgICAgICAgc2VsZi51bmV4cGVjdGVkU3VjY2Vzc2VzID0gW10KICAgICAgICBzZWxmLnNob3VsZFN0b3AgPSBGYWxzZQoKICAgIGRlZiBzdGFydFRlc3Qoc2VsZiwgdGVzdCk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzdG9wVGVzdChzZWxmLCB0ZXN0KToKICAgICAgICBwYXNzCgogICAgZGVmIGFkZEVycm9yKHNlbGYsIHRlc3QpOgogICAgICAgIHBhc3MKCiAgICBkZWYgYWRkRmFpbHVyZShzZWxmLCB0ZXN0KToKICAgICAgICBwYXNzCgogICAgZGVmIGFkZFN1Y2Nlc3Moc2VsZiwgdGVzdCk6CiAgICAgICAgcGFzcwoKICAgIGRlZiB3YXNTdWNjZXNzZnVsKHNlbGYpOgogICAgICAgIHJldHVybiBUcnVlCg==',
'/Lib/unittest/test/test_assertions.py':'aW1wb3J0IGRhdGV0aW1lCmltcG9ydCB3YXJuaW5ncwppbXBvcnQgdW5pdHRlc3QKZnJvbSBpdGVydG9vbHMgaW1wb3J0IHByb2R1Y3QKCgpjbGFzcyBUZXN0X0Fzc2VydGlvbnModW5pdHRlc3QuVGVzdENhc2UpOgogICAgZGVmIHRlc3RfQWxtb3N0RXF1YWwoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRBbG1vc3RFcXVhbCgxLjAwMDAwMDAxLCAxLjApCiAgICAgICAgc2VsZi5hc3NlcnROb3RBbG1vc3RFcXVhbCgxLjAwMDAwMDEsIDEuMCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRBbG1vc3RFcXVhbCwgMS4wMDAwMDAxLCAxLjApCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0Tm90QWxtb3N0RXF1YWwsIDEuMDAwMDAwMDEsIDEuMCkKCiAgICAgICAgc2VsZi5hc3NlcnRBbG1vc3RFcXVhbCgxLjEsIDEuMCwgcGxhY2VzPTApCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0QWxtb3N0RXF1YWwsIDEuMSwgMS4wLCBwbGFjZXM9MSkKCiAgICAgICAgc2VsZi5hc3NlcnRBbG1vc3RFcXVhbCgwLCAuMSsuMWosIHBsYWNlcz0wKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90QWxtb3N0RXF1YWwoMCwgLjErLjFqLCBwbGFjZXM9MSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRBbG1vc3RFcXVhbCwgMCwgLjErLjFqLCBwbGFjZXM9MSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hc3NlcnROb3RBbG1vc3RFcXVhbCwgMCwgLjErLjFqLCBwbGFjZXM9MCkKCiAgICAgICAgc2VsZi5hc3NlcnRBbG1vc3RFcXVhbChmbG9hdCgnaW5mJyksIGZsb2F0KCdpbmYnKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0Tm90QWxtb3N0RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgZmxvYXQoJ2luZicpLCBmbG9hdCgnaW5mJykpCgogICAgZGVmIHRlc3RfQW1vc3RFcXVhbFdpdGhEZWx0YShzZWxmKToKICAgICAgICBzZWxmLmFzc2VydEFsbW9zdEVxdWFsKDEuMSwgMS4wLCBkZWx0YT0wLjUpCiAgICAgICAgc2VsZi5hc3NlcnRBbG1vc3RFcXVhbCgxLjAsIDEuMSwgZGVsdGE9MC41KQogICAgICAgIHNlbGYuYXNzZXJ0Tm90QWxtb3N0RXF1YWwoMS4xLCAxLjAsIGRlbHRhPTAuMDUpCiAgICAgICAgc2VsZi5hc3NlcnROb3RBbG1vc3RFcXVhbCgxLjAsIDEuMSwgZGVsdGE9MC4wNSkKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydEFsbW9zdEVxdWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgIDEuMSwgMS4wLCBkZWx0YT0wLjA1KQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnROb3RBbG1vc3RFcXVhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAxLjEsIDEuMCwgZGVsdGE9MC41KQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIHNlbGYuYXNzZXJ0QWxtb3N0RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgMS4xLCAxLjAsIHBsYWNlcz0yLCBkZWx0YT0yKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgc2VsZi5hc3NlcnROb3RBbG1vc3RFcXVhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAxLjEsIDEuMCwgcGxhY2VzPTIsIGRlbHRhPTIpCgogICAgICAgIGZpcnN0ID0gZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkKICAgICAgICBzZWNvbmQgPSBmaXJzdCArIGRhdGV0aW1lLnRpbWVkZWx0YShzZWNvbmRzPTEwKQogICAgICAgIHNlbGYuYXNzZXJ0QWxtb3N0RXF1YWwoZmlyc3QsIHNlY29uZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhPWRhdGV0aW1lLnRpbWVkZWx0YShzZWNvbmRzPTIwKSkKICAgICAgICBzZWxmLmFzc2VydE5vdEFsbW9zdEVxdWFsKGZpcnN0LCBzZWNvbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWx0YT1kYXRldGltZS50aW1lZGVsdGEoc2Vjb25kcz01KSkKCiAgICBkZWYgdGVzdF9hc3NlcnRSYWlzZXMoc2VsZik6CiAgICAgICAgZGVmIF9yYWlzZShlKToKICAgICAgICAgICAgcmFpc2UgZQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEtleUVycm9yLCBfcmFpc2UsIEtleUVycm9yKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEtleUVycm9yLCBfcmFpc2UsIEtleUVycm9yKCJrZXkiKSkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEtleUVycm9yLCBsYW1iZGE6IE5vbmUpCiAgICAgICAgZXhjZXB0IHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLmFzc2VydEluKCJLZXlFcnJvciBub3QgcmFpc2VkIiwgc3RyKGUpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiYXNzZXJ0UmFpc2VzKCkgZGlkbid0IGZhaWwiKQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoS2V5RXJyb3IsIF9yYWlzZSwgVmFsdWVFcnJvcikKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiYXNzZXJ0UmFpc2VzKCkgZGlkbid0IGxldCBleGNlcHRpb24gcGFzcyB0aHJvdWdoIikKICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKEtleUVycm9yKSBhcyBjbToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3IKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgZXhjID0gZQogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBzZWxmLmFzc2VydElzKGNtLmV4Y2VwdGlvbiwgZXhjKQoKICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKEtleUVycm9yKToKICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3IoImtleSIpCiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKEtleUVycm9yKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICBleGNlcHQgc2VsZi5mYWlsdXJlRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SW4oIktleUVycm9yIG5vdCByYWlzZWQiLCBzdHIoZSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCJhc3NlcnRSYWlzZXMoKSBkaWRuJ3QgZmFpbCIpCiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKEtleUVycm9yKToKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiYXNzZXJ0UmFpc2VzKCkgZGlkbid0IGxldCBleGNlcHRpb24gcGFzcyB0aHJvdWdoIikKCiAgICBkZWYgdGVzdEFzc2VydE5vdFJlZ2V4KHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0Tm90UmVnZXgoJ0FsYSBtYSBrb3RhJywgcidyKycpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmFzc2VydE5vdFJlZ2V4KCdBbGEgbWEga290YScsIHInay50JywgJ01lc3NhZ2UnKQogICAgICAgIGV4Y2VwdCBzZWxmLmZhaWx1cmVFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigiJ2tvdCciLCBlLmFyZ3NbMF0pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SW4oJ01lc3NhZ2UnLCBlLmFyZ3NbMF0pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCdhc3NlcnROb3RSZWdleCBzaG91bGQgaGF2ZSBmYWlsZWQuJykKCgpjbGFzcyBUZXN0TG9uZ01lc3NhZ2UodW5pdHRlc3QuVGVzdENhc2UpOgogICAgIiIiVGVzdCB0aGF0IHRoZSBpbmRpdmlkdWFsIGFzc2VydHMgaG9ub3VyIGxvbmdNZXNzYWdlLgogICAgVGhpcyBhY3R1YWxseSB0ZXN0cyBhbGwgdGhlIG1lc3NhZ2UgYmVoYXZpb3VyIGZvcgogICAgYXNzZXJ0cyB0aGF0IHVzZSBsb25nTWVzc2FnZS4iIiIKCiAgICBkZWYgc2V0VXAoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdGFibGVUZXN0RmFsc2UodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBsb25nTWVzc2FnZSA9IEZhbHNlCiAgICAgICAgICAgIGZhaWx1cmVFeGNlcHRpb24gPSBzZWxmLmZhaWx1cmVFeGNlcHRpb24KCiAgICAgICAgICAgIGRlZiB0ZXN0VGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgY2xhc3MgVGVzdGFibGVUZXN0VHJ1ZSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGxvbmdNZXNzYWdlID0gVHJ1ZQogICAgICAgICAgICBmYWlsdXJlRXhjZXB0aW9uID0gc2VsZi5mYWlsdXJlRXhjZXB0aW9uCgogICAgICAgICAgICBkZWYgdGVzdFRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIHNlbGYudGVzdGFibGVUcnVlID0gVGVzdGFibGVUZXN0VHJ1ZSgndGVzdFRlc3QnKQogICAgICAgIHNlbGYudGVzdGFibGVGYWxzZSA9IFRlc3RhYmxlVGVzdEZhbHNlKCd0ZXN0VGVzdCcpCgogICAgZGVmIHRlc3REZWZhdWx0KHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZSh1bml0dGVzdC5UZXN0Q2FzZS5sb25nTWVzc2FnZSkKCiAgICBkZWYgdGVzdF9mb3JtYXRNc2coc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzZWxmLnRlc3RhYmxlRmFsc2UuX2Zvcm1hdE1lc3NhZ2UoTm9uZSwgImZvbyIpLCAiZm9vIikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNlbGYudGVzdGFibGVGYWxzZS5fZm9ybWF0TWVzc2FnZSgiZm9vIiwgImJhciIpLCAiZm9vIikKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzZWxmLnRlc3RhYmxlVHJ1ZS5fZm9ybWF0TWVzc2FnZShOb25lLCAiZm9vIiksICJmb28iKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc2VsZi50ZXN0YWJsZVRydWUuX2Zvcm1hdE1lc3NhZ2UoImZvbyIsICJiYXIiKSwgImJhciA6IGZvbyIpCgogICAgICAgICMgVGhpcyBibG93cyB1cCBpZiBfZm9ybWF0TWVzc2FnZSB1c2VzIHN0cmluZyBjb25jYXRlbmF0aW9uCiAgICAgICAgc2VsZi50ZXN0YWJsZVRydWUuX2Zvcm1hdE1lc3NhZ2Uob2JqZWN0KCksICdmb28nKQoKICAgIGRlZiB0ZXN0X2Zvcm1hdE1lc3NhZ2VfdW5pY29kZV9lcnJvcihzZWxmKToKICAgICAgICBvbmUgPSAnJy5qb2luKGNocihpKSBmb3IgaSBpbiByYW5nZSgyNTUpKQogICAgICAgICMgdGhpcyB1c2VkIHRvIGNhdXNlIGEgVW5pY29kZURlY29kZUVycm9yIGNvbnN0cnVjdGluZyBtc2cKICAgICAgICBzZWxmLnRlc3RhYmxlVHJ1ZS5fZm9ybWF0TWVzc2FnZShvbmUsICdcdUZGRkQnKQoKICAgIGRlZiBhc3NlcnRNZXNzYWdlcyhzZWxmLCBtZXRob2ROYW1lLCBhcmdzLCBlcnJvcnMpOgogICAgICAgICIiIgogICAgICAgIENoZWNrIHRoYXQgbWV0aG9kTmFtZSgqYXJncykgcmFpc2VzIHRoZSBjb3JyZWN0IGVycm9yIG1lc3NhZ2VzLgogICAgICAgIGVycm9ycyBzaG91bGQgYmUgYSBsaXN0IG9mIDQgcmVnZXggdGhhdCBtYXRjaCB0aGUgZXJyb3Igd2hlbjoKICAgICAgICAgIDEpIGxvbmdNZXNzYWdlID0gRmFsc2UgYW5kIG5vIG1zZyBwYXNzZWQ7CiAgICAgICAgICAyKSBsb25nTWVzc2FnZSA9IEZhbHNlIGFuZCBtc2cgcGFzc2VkOwogICAgICAgICAgMykgbG9uZ01lc3NhZ2UgPSBUcnVlIGFuZCBubyBtc2cgcGFzc2VkOwogICAgICAgICAgNCkgbG9uZ01lc3NhZ2UgPSBUcnVlIGFuZCBtc2cgcGFzc2VkOwogICAgICAgICIiIgogICAgICAgIGRlZiBnZXRNZXRob2QoaSk6CiAgICAgICAgICAgIHVzZVRlc3RhYmxlRmFsc2UgID0gaSA8IDIKICAgICAgICAgICAgaWYgdXNlVGVzdGFibGVGYWxzZToKICAgICAgICAgICAgICAgIHRlc3QgPSBzZWxmLnRlc3RhYmxlRmFsc2UKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRlc3QgPSBzZWxmLnRlc3RhYmxlVHJ1ZQogICAgICAgICAgICByZXR1cm4gZ2V0YXR0cih0ZXN0LCBtZXRob2ROYW1lKQoKICAgICAgICBmb3IgaSwgZXhwZWN0ZWRfcmVnZXggaW4gZW51bWVyYXRlKGVycm9ycyk6CiAgICAgICAgICAgIHRlc3RNZXRob2QgPSBnZXRNZXRob2QoaSkKICAgICAgICAgICAga3dhcmdzID0ge30KICAgICAgICAgICAgd2l0aE1zZyA9IGkgJSAyCiAgICAgICAgICAgIGlmIHdpdGhNc2c6CiAgICAgICAgICAgICAgICBrd2FyZ3MgPSB7Im1zZyI6ICJvb3BzIn0KCiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXNSZWdleChzZWxmLmZhaWx1cmVFeGNlcHRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3RlZF9yZWdleD1leHBlY3RlZF9yZWdleCk6CiAgICAgICAgICAgICAgICB0ZXN0TWV0aG9kKCphcmdzLCAqKmt3YXJncykKCiAgICBkZWYgdGVzdEFzc2VydFRydWUoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0VHJ1ZScsIChGYWxzZSwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJeRmFsc2UgaXMgbm90IHRydWUkIiwgIl5vb3BzJCIsICJeRmFsc2UgaXMgbm90IHRydWUkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXkZhbHNlIGlzIG5vdCB0cnVlIDogb29wcyQiXSkKCiAgICBkZWYgdGVzdEFzc2VydEZhbHNlKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0TWVzc2FnZXMoJ2Fzc2VydEZhbHNlJywgKFRydWUsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiXlRydWUgaXMgbm90IGZhbHNlJCIsICJeb29wcyQiLCAiXlRydWUgaXMgbm90IGZhbHNlJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl5UcnVlIGlzIG5vdCBmYWxzZSA6IG9vcHMkIl0pCgogICAgZGVmIHRlc3ROb3RFcXVhbChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzKCdhc3NlcnROb3RFcXVhbCcsICgxLCAxKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiXjEgPT0gMSQiLCAiXm9vcHMkIiwgIl4xID09IDEkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXjEgPT0gMSA6IG9vcHMkIl0pCgogICAgZGVmIHRlc3RBbG1vc3RFcXVhbChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzKCdhc3NlcnRBbG1vc3RFcXVhbCcsICgxLCAyKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiXjEgIT0gMiB3aXRoaW4gNyBwbGFjZXMkIiwgIl5vb3BzJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl4xICE9IDIgd2l0aGluIDcgcGxhY2VzJCIsICJeMSAhPSAyIHdpdGhpbiA3IHBsYWNlcyA6IG9vcHMkIl0pCgogICAgZGVmIHRlc3ROb3RBbG1vc3RFcXVhbChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzKCdhc3NlcnROb3RBbG1vc3RFcXVhbCcsICgxLCAxKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiXjEgPT0gMSB3aXRoaW4gNyBwbGFjZXMkIiwgIl5vb3BzJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl4xID09IDEgd2l0aGluIDcgcGxhY2VzJCIsICJeMSA9PSAxIHdpdGhpbiA3IHBsYWNlcyA6IG9vcHMkIl0pCgogICAgZGVmIHRlc3RfYmFzZUFzc2VydEVxdWFsKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0TWVzc2FnZXMoJ19iYXNlQXNzZXJ0RXF1YWwnLCAoMSwgMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbIl4xICE9IDIkIiwgIl5vb3BzJCIsICJeMSAhPSAyJCIsICJeMSAhPSAyIDogb29wcyQiXSkKCiAgICBkZWYgdGVzdEFzc2VydFNlcXVlbmNlRXF1YWwoc2VsZik6CiAgICAgICAgIyBFcnJvciBtZXNzYWdlcyBhcmUgbXVsdGlsaW5lIHNvIG5vdCB0ZXN0aW5nIG9uIGZ1bGwgbWVzc2FnZQogICAgICAgICMgYXNzZXJ0VHVwbGVFcXVhbCBhbmQgYXNzZXJ0TGlzdEVxdWFsIGRlbGVnYXRlIHRvIHRoaXMgbWV0aG9kCiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0U2VxdWVuY2VFcXVhbCcsIChbXSwgW05vbmVdKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiXCsgXFtOb25lXF0kIiwgIl5vb3BzJCIsIHIiXCsgXFtOb25lXF0kIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICByIlwrIFxbTm9uZVxdIDogb29wcyQiXSkKCiAgICBkZWYgdGVzdEFzc2VydFNldEVxdWFsKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0TWVzc2FnZXMoJ2Fzc2VydFNldEVxdWFsJywgKHNldCgpLCBzZXQoW05vbmVdKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbIk5vbmUkIiwgIl5vb3BzJCIsICJOb25lJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vbmUgOiBvb3BzJCJdKQoKICAgIGRlZiB0ZXN0QXNzZXJ0SW4oc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0SW4nLCAoTm9uZSwgW10pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWydeTm9uZSBub3QgZm91bmQgaW4gXFtcXSQnLCAiXm9vcHMkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXk5vbmUgbm90IGZvdW5kIGluIFxbXF0kJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXk5vbmUgbm90IGZvdW5kIGluIFxbXF0gOiBvb3BzJCddKQoKICAgIGRlZiB0ZXN0QXNzZXJ0Tm90SW4oc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0Tm90SW4nLCAoTm9uZSwgW05vbmVdKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsnXk5vbmUgdW5leHBlY3RlZGx5IGZvdW5kIGluIFxbTm9uZVxdJCcsICJeb29wcyQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICdeTm9uZSB1bmV4cGVjdGVkbHkgZm91bmQgaW4gXFtOb25lXF0kJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXk5vbmUgdW5leHBlY3RlZGx5IGZvdW5kIGluIFxbTm9uZVxdIDogb29wcyQnXSkKCiAgICBkZWYgdGVzdEFzc2VydERpY3RFcXVhbChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzKCdhc3NlcnREaWN0RXF1YWwnLCAoe30sIHsna2V5JzogJ3ZhbHVlJ30pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgW3IiXCsgXHsna2V5JzogJ3ZhbHVlJ1x9JCIsICJeb29wcyQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJcKyBceydrZXknOiAndmFsdWUnXH0kIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXCsgXHsna2V5JzogJ3ZhbHVlJ1x9IDogb29wcyQiXSkKCiAgICBkZWYgdGVzdEFzc2VydERpY3RDb250YWluc1N1YnNldChzZWxmKToKICAgICAgICB3aXRoIHdhcm5pbmdzLmNhdGNoX3dhcm5pbmdzKCk6CiAgICAgICAgICAgIHdhcm5pbmdzLnNpbXBsZWZpbHRlcigiaWdub3JlIiwgRGVwcmVjYXRpb25XYXJuaW5nKQoKICAgICAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0JywgKHsna2V5JzogJ3ZhbHVlJ30sIHt9KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbIl5NaXNzaW5nOiAna2V5JyQiLCAiXm9vcHMkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl5NaXNzaW5nOiAna2V5JyQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXk1pc3Npbmc6ICdrZXknIDogb29wcyQiXSkKCiAgICBkZWYgdGVzdEFzc2VydE11bHRpTGluZUVxdWFsKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0TWVzc2FnZXMoJ2Fzc2VydE11bHRpTGluZUVxdWFsJywgKCIiLCAiZm9vIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbciJcKyBmb28kIiwgIl5vb3BzJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgciJcKyBmb28kIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICByIlwrIGZvbyA6IG9vcHMkIl0pCgogICAgZGVmIHRlc3RBc3NlcnRMZXNzKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0TWVzc2FnZXMoJ2Fzc2VydExlc3MnLCAoMiwgMSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbIl4yIG5vdCBsZXNzIHRoYW4gMSQiLCAiXm9vcHMkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXjIgbm90IGxlc3MgdGhhbiAxJCIsICJeMiBub3QgbGVzcyB0aGFuIDEgOiBvb3BzJCJdKQoKICAgIGRlZiB0ZXN0QXNzZXJ0TGVzc0VxdWFsKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0TWVzc2FnZXMoJ2Fzc2VydExlc3NFcXVhbCcsICgyLCAxKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiXjIgbm90IGxlc3MgdGhhbiBvciBlcXVhbCB0byAxJCIsICJeb29wcyQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJeMiBub3QgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIDEkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXjIgbm90IGxlc3MgdGhhbiBvciBlcXVhbCB0byAxIDogb29wcyQiXSkKCiAgICBkZWYgdGVzdEFzc2VydEdyZWF0ZXIoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0R3JlYXRlcicsICgxLCAyKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiXjEgbm90IGdyZWF0ZXIgdGhhbiAyJCIsICJeb29wcyQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJeMSBub3QgZ3JlYXRlciB0aGFuIDIkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXjEgbm90IGdyZWF0ZXIgdGhhbiAyIDogb29wcyQiXSkKCiAgICBkZWYgdGVzdEFzc2VydEdyZWF0ZXJFcXVhbChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzKCdhc3NlcnRHcmVhdGVyRXF1YWwnLCAoMSwgMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbIl4xIG5vdCBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gMiQiLCAiXm9vcHMkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXjEgbm90IGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAyJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl4xIG5vdCBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gMiA6IG9vcHMkIl0pCgogICAgZGVmIHRlc3RBc3NlcnRJc05vbmUoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0SXNOb25lJywgKCdub3QgTm9uZScsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiXidub3QgTm9uZScgaXMgbm90IE5vbmUkIiwgIl5vb3BzJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl4nbm90IE5vbmUnIGlzIG5vdCBOb25lJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl4nbm90IE5vbmUnIGlzIG5vdCBOb25lIDogb29wcyQiXSkKCiAgICBkZWYgdGVzdEFzc2VydElzTm90Tm9uZShzZWxmKToKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzKCdhc3NlcnRJc05vdE5vbmUnLCAoTm9uZSwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJedW5leHBlY3RlZGx5IE5vbmUkIiwgIl5vb3BzJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl51bmV4cGVjdGVkbHkgTm9uZSQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJedW5leHBlY3RlZGx5IE5vbmUgOiBvb3BzJCJdKQoKICAgIGRlZiB0ZXN0QXNzZXJ0SXMoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0SXMnLCAoTm9uZSwgJ2ZvbycpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJeTm9uZSBpcyBub3QgJ2ZvbyckIiwgIl5vb3BzJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl5Ob25lIGlzIG5vdCAnZm9vJyQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJeTm9uZSBpcyBub3QgJ2ZvbycgOiBvb3BzJCJdKQoKICAgIGRlZiB0ZXN0QXNzZXJ0SXNOb3Qoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0SXNOb3QnLCAoTm9uZSwgTm9uZSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbIl51bmV4cGVjdGVkbHkgaWRlbnRpY2FsOiBOb25lJCIsICJeb29wcyQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJedW5leHBlY3RlZGx5IGlkZW50aWNhbDogTm9uZSQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJedW5leHBlY3RlZGx5IGlkZW50aWNhbDogTm9uZSA6IG9vcHMkIl0pCgoKICAgIGRlZiBhc3NlcnRNZXNzYWdlc0NNKHNlbGYsIG1ldGhvZE5hbWUsIGFyZ3MsIGZ1bmMsIGVycm9ycyk6CiAgICAgICAgIiIiCiAgICAgICAgQ2hlY2sgdGhhdCB0aGUgY29ycmVjdCBlcnJvciBtZXNzYWdlcyBhcmUgcmFpc2VkIHdoaWxlIGV4ZWN1dGluZzoKICAgICAgICAgIHdpdGggbWV0aG9kKCphcmdzKToKICAgICAgICAgICAgICBmdW5jKCkKICAgICAgICAqZXJyb3JzKiBzaG91bGQgYmUgYSBsaXN0IG9mIDQgcmVnZXggdGhhdCBtYXRjaCB0aGUgZXJyb3Igd2hlbjoKICAgICAgICAgIDEpIGxvbmdNZXNzYWdlID0gRmFsc2UgYW5kIG5vIG1zZyBwYXNzZWQ7CiAgICAgICAgICAyKSBsb25nTWVzc2FnZSA9IEZhbHNlIGFuZCBtc2cgcGFzc2VkOwogICAgICAgICAgMykgbG9uZ01lc3NhZ2UgPSBUcnVlIGFuZCBubyBtc2cgcGFzc2VkOwogICAgICAgICAgNCkgbG9uZ01lc3NhZ2UgPSBUcnVlIGFuZCBtc2cgcGFzc2VkOwogICAgICAgICIiIgogICAgICAgIHAgPSBwcm9kdWN0KChzZWxmLnRlc3RhYmxlRmFsc2UsIHNlbGYudGVzdGFibGVUcnVlKSwKICAgICAgICAgICAgICAgICAgICAoe30sIHsibXNnIjogIm9vcHMifSkpCiAgICAgICAgZm9yIChjbHMsIGt3YXJncyksIGVyciBpbiB6aXAocCwgZXJyb3JzKToKICAgICAgICAgICAgbWV0aG9kID0gZ2V0YXR0cihjbHMsIG1ldGhvZE5hbWUpCiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXNSZWdleChjbHMuZmFpbHVyZUV4Y2VwdGlvbiwgZXJyKToKICAgICAgICAgICAgICAgIHdpdGggbWV0aG9kKCphcmdzLCAqKmt3YXJncykgYXMgY206CiAgICAgICAgICAgICAgICAgICAgZnVuYygpCgogICAgZGVmIHRlc3RBc3NlcnRSYWlzZXMoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlc0NNKCdhc3NlcnRSYWlzZXMnLCAoVHlwZUVycm9yLCksIGxhbWJkYTogTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWydeVHlwZUVycm9yIG5vdCByYWlzZWQkJywgJ15vb3BzJCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXlR5cGVFcnJvciBub3QgcmFpc2VkJCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXlR5cGVFcnJvciBub3QgcmFpc2VkIDogb29wcyQnXSkKCiAgICBkZWYgdGVzdEFzc2VydFJhaXNlc1JlZ2V4KHNlbGYpOgogICAgICAgICMgdGVzdCBlcnJvciBub3QgcmFpc2VkCiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlc0NNKCdhc3NlcnRSYWlzZXNSZWdleCcsIChUeXBlRXJyb3IsICd1bnVzZWQgcmVnZXgnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFtYmRhOiBOb25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbJ15UeXBlRXJyb3Igbm90IHJhaXNlZCQnLCAnXm9vcHMkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdeVHlwZUVycm9yIG5vdCByYWlzZWQkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdeVHlwZUVycm9yIG5vdCByYWlzZWQgOiBvb3BzJCddKQogICAgICAgICMgdGVzdCBlcnJvciByYWlzZWQgYnV0IHdpdGggd3JvbmcgbWVzc2FnZQogICAgICAgIGRlZiByYWlzZV93cm9uZ19tZXNzYWdlKCk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcignZm9vJykKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzQ00oJ2Fzc2VydFJhaXNlc1JlZ2V4JywgKFR5cGVFcnJvciwgJ3JlZ2V4JyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhaXNlX3dyb25nX21lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsnXiJyZWdleCIgZG9lcyBub3QgbWF0Y2ggImZvbyIkJywgJ15vb3BzJCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXiJyZWdleCIgZG9lcyBub3QgbWF0Y2ggImZvbyIkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdeInJlZ2V4IiBkb2VzIG5vdCBtYXRjaCAiZm9vIiA6IG9vcHMkJ10pCgogICAgZGVmIHRlc3RBc3NlcnRXYXJucyhzZWxmKToKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzQ00oJ2Fzc2VydFdhcm5zJywgKFVzZXJXYXJuaW5nLCksIGxhbWJkYTogTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWydeVXNlcldhcm5pbmcgbm90IHRyaWdnZXJlZCQnLCAnXm9vcHMkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdeVXNlcldhcm5pbmcgbm90IHRyaWdnZXJlZCQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ15Vc2VyV2FybmluZyBub3QgdHJpZ2dlcmVkIDogb29wcyQnXSkKCiAgICBkZWYgdGVzdEFzc2VydFdhcm5zUmVnZXgoc2VsZik6CiAgICAgICAgIyB0ZXN0IGVycm9yIG5vdCByYWlzZWQKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzQ00oJ2Fzc2VydFdhcm5zUmVnZXgnLCAoVXNlcldhcm5pbmcsICd1bnVzZWQgcmVnZXgnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFtYmRhOiBOb25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbJ15Vc2VyV2FybmluZyBub3QgdHJpZ2dlcmVkJCcsICdeb29wcyQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ15Vc2VyV2FybmluZyBub3QgdHJpZ2dlcmVkJCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXlVzZXJXYXJuaW5nIG5vdCB0cmlnZ2VyZWQgOiBvb3BzJCddKQogICAgICAgICMgdGVzdCB3YXJuaW5nIHJhaXNlZCBidXQgd2l0aCB3cm9uZyBtZXNzYWdlCiAgICAgICAgZGVmIHJhaXNlX3dyb25nX21lc3NhZ2UoKToKICAgICAgICAgICAgd2FybmluZ3Mud2FybignZm9vJykKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzQ00oJ2Fzc2VydFdhcm5zUmVnZXgnLCAoVXNlcldhcm5pbmcsICdyZWdleCcpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWlzZV93cm9uZ19tZXNzYWdlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbJ14icmVnZXgiIGRvZXMgbm90IG1hdGNoICJmb28iJCcsICdeb29wcyQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ14icmVnZXgiIGRvZXMgbm90IG1hdGNoICJmb28iJCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXiJyZWdleCIgZG9lcyBub3QgbWF0Y2ggImZvbyIgOiBvb3BzJCddKQo=',
'/Lib/unittest/test/test_break.py':'aW1wb3J0IGdjCmltcG9ydCBpbwppbXBvcnQgb3MKaW1wb3J0IHN5cwppbXBvcnQgc2lnbmFsCmltcG9ydCB3ZWFrcmVmCgppbXBvcnQgdW5pdHRlc3QKCgpAdW5pdHRlc3Quc2tpcFVubGVzcyhoYXNhdHRyKG9zLCAna2lsbCcpLCAiVGVzdCByZXF1aXJlcyBvcy5raWxsIikKQHVuaXR0ZXN0LnNraXBJZihzeXMucGxhdGZvcm0gPT0id2luMzIiLCAiVGVzdCBjYW5ub3QgcnVuIG9uIFdpbmRvd3MiKQpAdW5pdHRlc3Quc2tpcElmKHN5cy5wbGF0Zm9ybSA9PSAnZnJlZWJzZDYnLCAiVGVzdCBraWxscyByZWdydGVzdCBvbiBmcmVlYnNkNiAiCiAgICAiaWYgdGhyZWFkcyBoYXZlIGJlZW4gdXNlZCIpCmNsYXNzIFRlc3RCcmVhayh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIHNldFVwKHNlbGYpOgogICAgICAgIHNlbGYuX2RlZmF1bHRfaGFuZGxlciA9IHNpZ25hbC5nZXRzaWduYWwoc2lnbmFsLlNJR0lOVCkKCiAgICBkZWYgdGVhckRvd24oc2VsZik6CiAgICAgICAgc2lnbmFsLnNpZ25hbChzaWduYWwuU0lHSU5ULCBzZWxmLl9kZWZhdWx0X2hhbmRsZXIpCiAgICAgICAgdW5pdHRlc3Quc2lnbmFscy5fcmVzdWx0cyA9IHdlYWtyZWYuV2Vha0tleURpY3Rpb25hcnkoKQogICAgICAgIHVuaXR0ZXN0LnNpZ25hbHMuX2ludGVycnVwdF9oYW5kbGVyID0gTm9uZQoKCiAgICBkZWYgdGVzdEluc3RhbGxIYW5kbGVyKHNlbGYpOgogICAgICAgIGRlZmF1bHRfaGFuZGxlciA9IHNpZ25hbC5nZXRzaWduYWwoc2lnbmFsLlNJR0lOVCkKICAgICAgICB1bml0dGVzdC5pbnN0YWxsSGFuZGxlcigpCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpLCBkZWZhdWx0X2hhbmRsZXIpCgogICAgICAgIHRyeToKICAgICAgICAgICAgcGlkID0gb3MuZ2V0cGlkKCkKICAgICAgICAgICAgb3Mua2lsbChwaWQsIHNpZ25hbC5TSUdJTlQpCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICBzZWxmLmZhaWwoIktleWJvYXJkSW50ZXJydXB0IG5vdCBoYW5kbGVkIikKCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHVuaXR0ZXN0LnNpZ25hbHMuX2ludGVycnVwdF9oYW5kbGVyLmNhbGxlZCkKCiAgICBkZWYgdGVzdFJlZ2lzdGVyUmVzdWx0KHNlbGYpOgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHVuaXR0ZXN0LnJlZ2lzdGVyUmVzdWx0KHJlc3VsdCkKCiAgICAgICAgZm9yIHJlZiBpbiB1bml0dGVzdC5zaWduYWxzLl9yZXN1bHRzOgogICAgICAgICAgICBpZiByZWYgaXMgcmVzdWx0OgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZWxpZiByZWYgaXMgbm90IHJlc3VsdDoKICAgICAgICAgICAgICAgIHNlbGYuZmFpbCgib2RkIG9iamVjdCBpbiByZXN1bHQgc2V0IikKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoInJlc3VsdCBub3QgZm91bmQiKQoKCiAgICBkZWYgdGVzdEludGVycnVwdENhdWdodChzZWxmKToKICAgICAgICBkZWZhdWx0X2hhbmRsZXIgPSBzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpCgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHVuaXR0ZXN0Lmluc3RhbGxIYW5kbGVyKCkKICAgICAgICB1bml0dGVzdC5yZWdpc3RlclJlc3VsdChyZXN1bHQpCgogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoc2lnbmFsLmdldHNpZ25hbChzaWduYWwuU0lHSU5UKSwgZGVmYXVsdF9oYW5kbGVyKQoKICAgICAgICBkZWYgdGVzdChyZXN1bHQpOgogICAgICAgICAgICBwaWQgPSBvcy5nZXRwaWQoKQogICAgICAgICAgICBvcy5raWxsKHBpZCwgc2lnbmFsLlNJR0lOVCkKICAgICAgICAgICAgcmVzdWx0LmJyZWFrQ2F1Z2h0ID0gVHJ1ZQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0LnNob3VsZFN0b3ApCgogICAgICAgIHRyeToKICAgICAgICAgICAgdGVzdChyZXN1bHQpCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICBzZWxmLmZhaWwoIktleWJvYXJkSW50ZXJydXB0IG5vdCBoYW5kbGVkIikKICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0LmJyZWFrQ2F1Z2h0KQoKCiAgICBkZWYgdGVzdFNlY29uZEludGVycnVwdChzZWxmKToKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICB1bml0dGVzdC5pbnN0YWxsSGFuZGxlcigpCiAgICAgICAgdW5pdHRlc3QucmVnaXN0ZXJSZXN1bHQocmVzdWx0KQoKICAgICAgICBkZWYgdGVzdChyZXN1bHQpOgogICAgICAgICAgICBwaWQgPSBvcy5nZXRwaWQoKQogICAgICAgICAgICBvcy5raWxsKHBpZCwgc2lnbmFsLlNJR0lOVCkKICAgICAgICAgICAgcmVzdWx0LmJyZWFrQ2F1Z2h0ID0gVHJ1ZQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0LnNob3VsZFN0b3ApCiAgICAgICAgICAgIG9zLmtpbGwocGlkLCBzaWduYWwuU0lHSU5UKQogICAgICAgICAgICBzZWxmLmZhaWwoIlNlY29uZCBLZXlib2FyZEludGVycnVwdCBub3QgcmFpc2VkIikKCiAgICAgICAgdHJ5OgogICAgICAgICAgICB0ZXN0KHJlc3VsdCkKICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIlNlY29uZCBLZXlib2FyZEludGVycnVwdCBub3QgcmFpc2VkIikKICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0LmJyZWFrQ2F1Z2h0KQoKCiAgICBkZWYgdGVzdFR3b1Jlc3VsdHMoc2VsZik6CiAgICAgICAgdW5pdHRlc3QuaW5zdGFsbEhhbmRsZXIoKQoKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICB1bml0dGVzdC5yZWdpc3RlclJlc3VsdChyZXN1bHQpCiAgICAgICAgbmV3X2hhbmRsZXIgPSBzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpCgogICAgICAgIHJlc3VsdDIgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICB1bml0dGVzdC5yZWdpc3RlclJlc3VsdChyZXN1bHQyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc2lnbmFsLmdldHNpZ25hbChzaWduYWwuU0lHSU5UKSwgbmV3X2hhbmRsZXIpCgogICAgICAgIHJlc3VsdDMgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKCiAgICAgICAgZGVmIHRlc3QocmVzdWx0KToKICAgICAgICAgICAgcGlkID0gb3MuZ2V0cGlkKCkKICAgICAgICAgICAgb3Mua2lsbChwaWQsIHNpZ25hbC5TSUdJTlQpCgogICAgICAgIHRyeToKICAgICAgICAgICAgdGVzdChyZXN1bHQpCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICBzZWxmLmZhaWwoIktleWJvYXJkSW50ZXJydXB0IG5vdCBoYW5kbGVkIikKCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHJlc3VsdC5zaG91bGRTdG9wKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShyZXN1bHQyLnNob3VsZFN0b3ApCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShyZXN1bHQzLnNob3VsZFN0b3ApCgoKICAgIGRlZiB0ZXN0SGFuZGxlclJlcGxhY2VkQnV0Q2FsbGVkKHNlbGYpOgogICAgICAgICMgSWYgb3VyIGhhbmRsZXIgaGFzIGJlZW4gcmVwbGFjZWQgKGlzIG5vIGxvbmdlciBpbnN0YWxsZWQpIGJ1dCBpcwogICAgICAgICMgY2FsbGVkIGJ5IHRoZSAqbmV3KiBoYW5kbGVyLCB0aGVuIGl0IGlzbid0IHNhZmUgdG8gZGVsYXkgdGhlCiAgICAgICAgIyBTSUdJTlQgYW5kIHdlIHNob3VsZCBpbW1lZGlhdGVseSBkZWxlZ2F0ZSB0byB0aGUgZGVmYXVsdCBoYW5kbGVyCiAgICAgICAgdW5pdHRlc3QuaW5zdGFsbEhhbmRsZXIoKQoKICAgICAgICBoYW5kbGVyID0gc2lnbmFsLmdldHNpZ25hbChzaWduYWwuU0lHSU5UKQogICAgICAgIGRlZiBuZXdfaGFuZGxlcihmcmFtZSwgc2lnbnVtKToKICAgICAgICAgICAgaGFuZGxlcihmcmFtZSwgc2lnbnVtKQogICAgICAgIHNpZ25hbC5zaWduYWwoc2lnbmFsLlNJR0lOVCwgbmV3X2hhbmRsZXIpCgogICAgICAgIHRyeToKICAgICAgICAgICAgcGlkID0gb3MuZ2V0cGlkKCkKICAgICAgICAgICAgb3Mua2lsbChwaWQsIHNpZ25hbC5TSUdJTlQpCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICBwYXNzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCJyZXBsYWNlZCBidXQgZGVsZWdhdGVkIGhhbmRsZXIgZG9lc24ndCByYWlzZSBpbnRlcnJ1cHQiKQoKICAgIGRlZiB0ZXN0UnVubmVyKHNlbGYpOgogICAgICAgICMgQ3JlYXRpbmcgYSBUZXh0VGVzdFJ1bm5lciB3aXRoIHRoZSBhcHByb3ByaWF0ZSBhcmd1bWVudCBzaG91bGQKICAgICAgICAjIHJlZ2lzdGVyIHRoZSBUZXh0VGVzdFJlc3VsdCBpdCBjcmVhdGVzCiAgICAgICAgcnVubmVyID0gdW5pdHRlc3QuVGV4dFRlc3RSdW5uZXIoc3RyZWFtPWlvLlN0cmluZ0lPKCkpCgogICAgICAgIHJlc3VsdCA9IHJ1bm5lci5ydW4odW5pdHRlc3QuVGVzdFN1aXRlKCkpCiAgICAgICAgc2VsZi5hc3NlcnRJbihyZXN1bHQsIHVuaXR0ZXN0LnNpZ25hbHMuX3Jlc3VsdHMpCgogICAgZGVmIHRlc3RXZWFrUmVmZXJlbmNlcyhzZWxmKToKICAgICAgICAjIENhbGxpbmcgcmVnaXN0ZXJSZXN1bHQgb24gYSByZXN1bHQgc2hvdWxkIG5vdCBrZWVwIGl0IGFsaXZlCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgdW5pdHRlc3QucmVnaXN0ZXJSZXN1bHQocmVzdWx0KQoKICAgICAgICByZWYgPSB3ZWFrcmVmLnJlZihyZXN1bHQpCiAgICAgICAgZGVsIHJlc3VsdAoKICAgICAgICAjIEZvciBub24tcmVmZXJlbmNlIGNvdW50aW5nIGltcGxlbWVudGF0aW9ucwogICAgICAgIGdjLmNvbGxlY3QoKTtnYy5jb2xsZWN0KCkKICAgICAgICBzZWxmLmFzc2VydElzTm9uZShyZWYoKSkKCgogICAgZGVmIHRlc3RSZW1vdmVSZXN1bHQoc2VsZik6CiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgdW5pdHRlc3QucmVnaXN0ZXJSZXN1bHQocmVzdWx0KQoKICAgICAgICB1bml0dGVzdC5pbnN0YWxsSGFuZGxlcigpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHVuaXR0ZXN0LnJlbW92ZVJlc3VsdChyZXN1bHQpKQoKICAgICAgICAjIFNob3VsZCB0aGlzIHJhaXNlIGFuIGVycm9yIGluc3RlYWQ/CiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZSh1bml0dGVzdC5yZW1vdmVSZXN1bHQodW5pdHRlc3QuVGVzdFJlc3VsdCgpKSkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBwaWQgPSBvcy5nZXRwaWQoKQogICAgICAgICAgICBvcy5raWxsKHBpZCwgc2lnbmFsLlNJR0lOVCkKICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShyZXN1bHQuc2hvdWxkU3RvcCkKCiAgICBkZWYgdGVzdE1haW5JbnN0YWxsc0hhbmRsZXIoc2VsZik6CiAgICAgICAgZmFpbGZhc3QgPSBvYmplY3QoKQogICAgICAgIHRlc3QgPSBvYmplY3QoKQogICAgICAgIHZlcmJvc2l0eSA9IG9iamVjdCgpCiAgICAgICAgcmVzdWx0ID0gb2JqZWN0KCkKICAgICAgICBkZWZhdWx0X2hhbmRsZXIgPSBzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpCgogICAgICAgIGNsYXNzIEZha2VSdW5uZXIob2JqZWN0KToKICAgICAgICAgICAgaW5pdEFyZ3MgPSBbXQogICAgICAgICAgICBydW5BcmdzID0gW10KICAgICAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgICAgICBzZWxmLmluaXRBcmdzLmFwcGVuZCgoYXJncywga3dhcmdzKSkKICAgICAgICAgICAgZGVmIHJ1bihzZWxmLCB0ZXN0KToKICAgICAgICAgICAgICAgIHNlbGYucnVuQXJncy5hcHBlbmQodGVzdCkKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQKCiAgICAgICAgY2xhc3MgUHJvZ3JhbSh1bml0dGVzdC5UZXN0UHJvZ3JhbSk6CiAgICAgICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjYXRjaGJyZWFrKToKICAgICAgICAgICAgICAgIHNlbGYuZXhpdCA9IEZhbHNlCiAgICAgICAgICAgICAgICBzZWxmLnZlcmJvc2l0eSA9IHZlcmJvc2l0eQogICAgICAgICAgICAgICAgc2VsZi5mYWlsZmFzdCA9IGZhaWxmYXN0CiAgICAgICAgICAgICAgICBzZWxmLmNhdGNoYnJlYWsgPSBjYXRjaGJyZWFrCiAgICAgICAgICAgICAgICBzZWxmLnRlc3RSdW5uZXIgPSBGYWtlUnVubmVyCiAgICAgICAgICAgICAgICBzZWxmLnRlc3QgPSB0ZXN0CiAgICAgICAgICAgICAgICBzZWxmLnJlc3VsdCA9IE5vbmUKCiAgICAgICAgcCA9IFByb2dyYW0oRmFsc2UpCiAgICAgICAgcC5ydW5UZXN0cygpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRmFrZVJ1bm5lci5pbml0QXJncywgWygoKSwgeydidWZmZXInOiBOb25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd2ZXJib3NpdHknOiB2ZXJib3NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2ZhaWxmYXN0JzogZmFpbGZhc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3dhcm5pbmdzJzogTm9uZX0pXSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZha2VSdW5uZXIucnVuQXJncywgW3Rlc3RdKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocC5yZXN1bHQsIHJlc3VsdCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpLCBkZWZhdWx0X2hhbmRsZXIpCgogICAgICAgIEZha2VSdW5uZXIuaW5pdEFyZ3MgPSBbXQogICAgICAgIEZha2VSdW5uZXIucnVuQXJncyA9IFtdCiAgICAgICAgcCA9IFByb2dyYW0oVHJ1ZSkKICAgICAgICBwLnJ1blRlc3RzKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGYWtlUnVubmVyLmluaXRBcmdzLCBbKCgpLCB7J2J1ZmZlcic6IE5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3ZlcmJvc2l0eSc6IHZlcmJvc2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZmFpbGZhc3QnOiBmYWlsZmFzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnd2FybmluZ3MnOiBOb25lfSldKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRmFrZVJ1bm5lci5ydW5BcmdzLCBbdGVzdF0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwLnJlc3VsdCwgcmVzdWx0KQoKICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKHNpZ25hbC5nZXRzaWduYWwoc2lnbmFsLlNJR0lOVCksIGRlZmF1bHRfaGFuZGxlcikKCiAgICBkZWYgdGVzdFJlbW92ZUhhbmRsZXIoc2VsZik6CiAgICAgICAgZGVmYXVsdF9oYW5kbGVyID0gc2lnbmFsLmdldHNpZ25hbChzaWduYWwuU0lHSU5UKQogICAgICAgIHVuaXR0ZXN0Lmluc3RhbGxIYW5kbGVyKCkKICAgICAgICB1bml0dGVzdC5yZW1vdmVIYW5kbGVyKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNpZ25hbC5nZXRzaWduYWwoc2lnbmFsLlNJR0lOVCksIGRlZmF1bHRfaGFuZGxlcikKCiAgICAgICAgIyBjaGVjayB0aGF0IGNhbGxpbmcgcmVtb3ZlSGFuZGxlciBtdWx0aXBsZSB0aW1lcyBoYXMgbm8gaWxsLWVmZmVjdAogICAgICAgIHVuaXR0ZXN0LnJlbW92ZUhhbmRsZXIoKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc2lnbmFsLmdldHNpZ25hbChzaWduYWwuU0lHSU5UKSwgZGVmYXVsdF9oYW5kbGVyKQoKICAgIGRlZiB0ZXN0UmVtb3ZlSGFuZGxlckFzRGVjb3JhdG9yKHNlbGYpOgogICAgICAgIGRlZmF1bHRfaGFuZGxlciA9IHNpZ25hbC5nZXRzaWduYWwoc2lnbmFsLlNJR0lOVCkKICAgICAgICB1bml0dGVzdC5pbnN0YWxsSGFuZGxlcigpCgogICAgICAgIEB1bml0dGVzdC5yZW1vdmVIYW5kbGVyCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpLCBkZWZhdWx0X2hhbmRsZXIpCgogICAgICAgIHRlc3QoKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoc2lnbmFsLmdldHNpZ25hbChzaWduYWwuU0lHSU5UKSwgZGVmYXVsdF9oYW5kbGVyKQo=',
'/Lib/unittest/test/test_case.py':'aW1wb3J0IGRpZmZsaWIKaW1wb3J0IHBwcmludAppbXBvcnQgcGlja2xlCmltcG9ydCByZQppbXBvcnQgc3lzCmltcG9ydCB3YXJuaW5ncwppbXBvcnQgd2Vha3JlZgppbXBvcnQgaW5zcGVjdAoKZnJvbSBjb3B5IGltcG9ydCBkZWVwY29weQpmcm9tIHRlc3QgaW1wb3J0IHN1cHBvcnQKCmltcG9ydCB1bml0dGVzdAoKZnJvbSAuc3VwcG9ydCBpbXBvcnQgKAogICAgVGVzdEVxdWFsaXR5LCBUZXN0SGFzaGluZywgTG9nZ2luZ1Jlc3VsdCwKICAgIFJlc3VsdFdpdGhOb1N0YXJ0VGVzdFJ1blN0b3BUZXN0UnVuCikKCgpjbGFzcyBUZXN0KG9iamVjdCk6CiAgICAiS2VlcCB0aGVzZSBUZXN0Q2FzZSBjbGFzc2VzIG91dCBvZiB0aGUgbWFpbiBuYW1lc3BhY2UiCgogICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICBkZWYgcnVuVGVzdChzZWxmKTogcGFzcwogICAgICAgIGRlZiB0ZXN0MShzZWxmKTogcGFzcwoKICAgIGNsYXNzIEJhcihGb28pOgogICAgICAgIGRlZiB0ZXN0MihzZWxmKTogcGFzcwoKICAgIGNsYXNzIExvZ2dpbmdUZXN0Q2FzZSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgIiIiQSB0ZXN0IGNhc2Ugd2hpY2ggbG9ncyBpdHMgY2FsbHMuIiIiCgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBldmVudHMpOgogICAgICAgICAgICBzdXBlcihUZXN0LkxvZ2dpbmdUZXN0Q2FzZSwgc2VsZikuX19pbml0X18oJ3Rlc3QnKQogICAgICAgICAgICBzZWxmLmV2ZW50cyA9IGV2ZW50cwoKICAgICAgICBkZWYgc2V0VXAoc2VsZik6CiAgICAgICAgICAgIHNlbGYuZXZlbnRzLmFwcGVuZCgnc2V0VXAnKQoKICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgc2VsZi5ldmVudHMuYXBwZW5kKCd0ZXN0JykKCiAgICAgICAgZGVmIHRlYXJEb3duKHNlbGYpOgogICAgICAgICAgICBzZWxmLmV2ZW50cy5hcHBlbmQoJ3RlYXJEb3duJykKCgpjbGFzcyBUZXN0X1Rlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlLCBUZXN0RXF1YWxpdHksIFRlc3RIYXNoaW5nKToKCiAgICAjIyMgU2V0IHVwIGF0dHJpYnV0ZXMgdXNlZCBieSBpbmhlcml0ZWQgdGVzdHMKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAjIFVzZWQgYnkgVGVzdEhhc2hpbmcudGVzdF9oYXNoIGFuZCBUZXN0RXF1YWxpdHkudGVzdF9lcQogICAgZXFfcGFpcnMgPSBbKFRlc3QuRm9vKCd0ZXN0MScpLCBUZXN0LkZvbygndGVzdDEnKSldCgogICAgIyBVc2VkIGJ5IFRlc3RFcXVhbGl0eS50ZXN0X25lCiAgICBuZV9wYWlycyA9IFsoVGVzdC5Gb28oJ3Rlc3QxJyksIFRlc3QuRm9vKCdydW5UZXN0JykpLAogICAgICAgICAgICAgICAgKFRlc3QuRm9vKCd0ZXN0MScpLCBUZXN0LkJhcigndGVzdDEnKSksCiAgICAgICAgICAgICAgICAoVGVzdC5Gb28oJ3Rlc3QxJyksIFRlc3QuQmFyKCd0ZXN0MicpKV0KCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiAgICAjIyMgL1NldCB1cCBhdHRyaWJ1dGVzIHVzZWQgYnkgaW5oZXJpdGVkIHRlc3RzCgoKICAgICMgImNsYXNzIFRlc3RDYXNlKFttZXRob2ROYW1lXSkiCiAgICAjIC4uLgogICAgIyAiRWFjaCBpbnN0YW5jZSBvZiBUZXN0Q2FzZSB3aWxsIHJ1biBhIHNpbmdsZSB0ZXN0IG1ldGhvZDogdGhlCiAgICAjIG1ldGhvZCBuYW1lZCBtZXRob2ROYW1lLiIKICAgICMgLi4uCiAgICAjICJtZXRob2ROYW1lIGRlZmF1bHRzIHRvICJydW5UZXN0Ii4iCiAgICAjCiAgICAjIE1ha2Ugc3VyZSBpdCByZWFsbHkgaXMgb3B0aW9uYWwsIGFuZCB0aGF0IGl0IGRlZmF1bHRzIHRvIHRoZSBwcm9wZXIKICAgICMgdGhpbmcuCiAgICBkZWYgdGVzdF9pbml0X19ub190ZXN0X25hbWUoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBydW5UZXN0KHNlbGYpOiByYWlzZSBNeUV4Y2VwdGlvbigpCiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOiBwYXNzCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoVGVzdCgpLmlkKClbLTEzOl0sICcuVGVzdC5ydW5UZXN0JykKCiAgICAgICAgIyB0ZXN0IHRoYXQgVGVzdENhc2UgY2FuIGJlIGluc3RhbnRpYXRlZCB3aXRoIG5vIGFyZ3MKICAgICAgICAjIHByaW1hcmlseSBmb3IgdXNlIGF0IHRoZSBpbnRlcmFjdGl2ZSBpbnRlcnByZXRlcgogICAgICAgIHRlc3QgPSB1bml0dGVzdC5UZXN0Q2FzZSgpCiAgICAgICAgdGVzdC5hc3NlcnRFcXVhbCgzLCAzKQogICAgICAgIHdpdGggdGVzdC5hc3NlcnRSYWlzZXModGVzdC5mYWlsdXJlRXhjZXB0aW9uKToKICAgICAgICAgICAgdGVzdC5hc3NlcnRFcXVhbCgzLCAyKQoKICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yKToKICAgICAgICAgICAgdGVzdC5ydW4oKQoKICAgICMgImNsYXNzIFRlc3RDYXNlKFttZXRob2ROYW1lXSkiCiAgICAjIC4uLgogICAgIyAiRWFjaCBpbnN0YW5jZSBvZiBUZXN0Q2FzZSB3aWxsIHJ1biBhIHNpbmdsZSB0ZXN0IG1ldGhvZDogdGhlCiAgICAjIG1ldGhvZCBuYW1lZCBtZXRob2ROYW1lLiIKICAgIGRlZiB0ZXN0X2luaXRfX3Rlc3RfbmFtZV9fdmFsaWQoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBydW5UZXN0KHNlbGYpOiByYWlzZSBNeUV4Y2VwdGlvbigpCiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOiBwYXNzCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoVGVzdCgndGVzdCcpLmlkKClbLTEwOl0sICcuVGVzdC50ZXN0JykKCiAgICAjICJjbGFzcyBUZXN0Q2FzZShbbWV0aG9kTmFtZV0pIgogICAgIyAuLi4KICAgICMgIkVhY2ggaW5zdGFuY2Ugb2YgVGVzdENhc2Ugd2lsbCBydW4gYSBzaW5nbGUgdGVzdCBtZXRob2Q6IHRoZQogICAgIyBtZXRob2QgbmFtZWQgbWV0aG9kTmFtZS4iCiAgICBkZWYgdGVzdF9pbml0X190ZXN0X25hbWVfX2ludmFsaWQoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBydW5UZXN0KHNlbGYpOiByYWlzZSBNeUV4Y2VwdGlvbigpCiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOiBwYXNzCgogICAgICAgIHRyeToKICAgICAgICAgICAgVGVzdCgndGVzdGZvbycpCiAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIkZhaWxlZCB0byByYWlzZSBWYWx1ZUVycm9yIikKCiAgICAjICJSZXR1cm4gdGhlIG51bWJlciBvZiB0ZXN0cyByZXByZXNlbnRlZCBieSB0aGUgdGhpcyB0ZXN0IG9iamVjdC4gRm9yCiAgICAjIFRlc3RDYXNlIGluc3RhbmNlcywgdGhpcyB3aWxsIGFsd2F5cyBiZSAxIgogICAgZGVmIHRlc3RfY291bnRUZXN0Q2FzZXMoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6IHBhc3MKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28oJ3Rlc3QnKS5jb3VudFRlc3RDYXNlcygpLCAxKQoKICAgICMgIlJldHVybiB0aGUgZGVmYXVsdCB0eXBlIG9mIHRlc3QgcmVzdWx0IG9iamVjdCB0byBiZSB1c2VkIHRvIHJ1biB0aGlzCiAgICAjIHRlc3QuIEZvciBUZXN0Q2FzZSBpbnN0YW5jZXMsIHRoaXMgd2lsbCBhbHdheXMgYmUKICAgICMgdW5pdHRlc3QuVGVzdFJlc3VsdDsgIHN1YmNsYXNzZXMgb2YgVGVzdENhc2Ugc2hvdWxkCiAgICAjIG92ZXJyaWRlIHRoaXMgYXMgbmVjZXNzYXJ5LiIKICAgIGRlZiB0ZXN0X2RlZmF1bHRUZXN0UmVzdWx0KHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBydW5UZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICByZXN1bHQgPSBGb28oKS5kZWZhdWx0VGVzdFJlc3VsdCgpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCh0eXBlKHJlc3VsdCksIHVuaXR0ZXN0LlRlc3RSZXN1bHQpCgogICAgIyAiV2hlbiBhIHNldFVwKCkgbWV0aG9kIGlzIGRlZmluZWQsIHRoZSB0ZXN0IHJ1bm5lciB3aWxsIHJ1biB0aGF0IG1ldGhvZAogICAgIyBwcmlvciB0byBlYWNoIHRlc3QuIExpa2V3aXNlLCBpZiBhIHRlYXJEb3duKCkgbWV0aG9kIGlzIGRlZmluZWQsIHRoZQogICAgIyB0ZXN0IHJ1bm5lciB3aWxsIGludm9rZSB0aGF0IG1ldGhvZCBhZnRlciBlYWNoIHRlc3QuIEluIHRoZSBleGFtcGxlLAogICAgIyBzZXRVcCgpIHdhcyB1c2VkIHRvIGNyZWF0ZSBhIGZyZXNoIHNlcXVlbmNlIGZvciBlYWNoIHRlc3QuIgogICAgIwogICAgIyBNYWtlIHN1cmUgdGhlIHByb3BlciBjYWxsIG9yZGVyIGlzIG1haW50YWluZWQsIGV2ZW4gaWYgc2V0VXAoKSByYWlzZXMKICAgICMgYW4gZXhjZXB0aW9uLgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2Vycm9yX2luX3NldFVwKHNlbGYpOgogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCgogICAgICAgIGNsYXNzIEZvbyhUZXN0LkxvZ2dpbmdUZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBzZXRVcChzZWxmKToKICAgICAgICAgICAgICAgIHN1cGVyKEZvbywgc2VsZikuc2V0VXAoKQogICAgICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCdyYWlzZWQgYnkgRm9vLnNldFVwJykKCiAgICAgICAgRm9vKGV2ZW50cykucnVuKHJlc3VsdCkKICAgICAgICBleHBlY3RlZCA9IFsnc3RhcnRUZXN0JywgJ3NldFVwJywgJ2FkZEVycm9yJywgJ3N0b3BUZXN0J10KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywgZXhwZWN0ZWQpCgogICAgIyAiV2l0aCBhIHRlbXBvcmFyeSByZXN1bHQgc3RvcFRlc3RSdW4gaXMgY2FsbGVkIHdoZW4gc2V0VXAgZXJyb3JzLgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2Vycm9yX2luX3NldFVwX2RlZmF1bHRfcmVzdWx0KHNlbGYpOgogICAgICAgIGV2ZW50cyA9IFtdCgogICAgICAgIGNsYXNzIEZvbyhUZXN0LkxvZ2dpbmdUZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBkZWZhdWx0VGVzdFJlc3VsdChzZWxmKToKICAgICAgICAgICAgICAgIHJldHVybiBMb2dnaW5nUmVzdWx0KHNlbGYuZXZlbnRzKQoKICAgICAgICAgICAgZGVmIHNldFVwKHNlbGYpOgogICAgICAgICAgICAgICAgc3VwZXIoRm9vLCBzZWxmKS5zZXRVcCgpCiAgICAgICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoJ3JhaXNlZCBieSBGb28uc2V0VXAnKQoKICAgICAgICBGb28oZXZlbnRzKS5ydW4oKQogICAgICAgIGV4cGVjdGVkID0gWydzdGFydFRlc3RSdW4nLCAnc3RhcnRUZXN0JywgJ3NldFVwJywgJ2FkZEVycm9yJywKICAgICAgICAgICAgICAgICAgICAnc3RvcFRlc3QnLCAnc3RvcFRlc3RSdW4nXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZXZlbnRzLCBleHBlY3RlZCkKCiAgICAjICJXaGVuIGEgc2V0VXAoKSBtZXRob2QgaXMgZGVmaW5lZCwgdGhlIHRlc3QgcnVubmVyIHdpbGwgcnVuIHRoYXQgbWV0aG9kCiAgICAjIHByaW9yIHRvIGVhY2ggdGVzdC4gTGlrZXdpc2UsIGlmIGEgdGVhckRvd24oKSBtZXRob2QgaXMgZGVmaW5lZCwgdGhlCiAgICAjIHRlc3QgcnVubmVyIHdpbGwgaW52b2tlIHRoYXQgbWV0aG9kIGFmdGVyIGVhY2ggdGVzdC4gSW4gdGhlIGV4YW1wbGUsCiAgICAjIHNldFVwKCkgd2FzIHVzZWQgdG8gY3JlYXRlIGEgZnJlc2ggc2VxdWVuY2UgZm9yIGVhY2ggdGVzdC4iCiAgICAjCiAgICAjIE1ha2Ugc3VyZSB0aGUgcHJvcGVyIGNhbGwgb3JkZXIgaXMgbWFpbnRhaW5lZCwgZXZlbiBpZiB0aGUgdGVzdCByYWlzZXMKICAgICMgYW4gZXJyb3IgKGFzIG9wcG9zZWQgdG8gYSBmYWlsdXJlKS4KICAgIGRlZiB0ZXN0X3J1bl9jYWxsX29yZGVyX19lcnJvcl9pbl90ZXN0KHNlbGYpOgogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCgogICAgICAgIGNsYXNzIEZvbyhUZXN0LkxvZ2dpbmdUZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgc3VwZXIoRm9vLCBzZWxmKS50ZXN0KCkKICAgICAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigncmFpc2VkIGJ5IEZvby50ZXN0JykKCiAgICAgICAgZXhwZWN0ZWQgPSBbJ3N0YXJ0VGVzdCcsICdzZXRVcCcsICd0ZXN0JywgJ3RlYXJEb3duJywKICAgICAgICAgICAgICAgICAgICAnYWRkRXJyb3InLCAnc3RvcFRlc3QnXQogICAgICAgIEZvbyhldmVudHMpLnJ1bihyZXN1bHQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIGV4cGVjdGVkKQoKICAgICMgIldpdGggYSBkZWZhdWx0IHJlc3VsdCwgYW4gZXJyb3IgaW4gdGhlIHRlc3Qgc3RpbGwgcmVzdWx0cyBpbiBzdG9wVGVzdFJ1bgogICAgIyBiZWluZyBjYWxsZWQuIgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2Vycm9yX2luX3Rlc3RfZGVmYXVsdF9yZXN1bHQoc2VsZik6CiAgICAgICAgZXZlbnRzID0gW10KCiAgICAgICAgY2xhc3MgRm9vKFRlc3QuTG9nZ2luZ1Rlc3RDYXNlKToKICAgICAgICAgICAgZGVmIGRlZmF1bHRUZXN0UmVzdWx0KHNlbGYpOgogICAgICAgICAgICAgICAgcmV0dXJuIExvZ2dpbmdSZXN1bHQoc2VsZi5ldmVudHMpCgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHN1cGVyKEZvbywgc2VsZikudGVzdCgpCiAgICAgICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoJ3JhaXNlZCBieSBGb28udGVzdCcpCgogICAgICAgIGV4cGVjdGVkID0gWydzdGFydFRlc3RSdW4nLCAnc3RhcnRUZXN0JywgJ3NldFVwJywgJ3Rlc3QnLAogICAgICAgICAgICAgICAgICAgICd0ZWFyRG93bicsICdhZGRFcnJvcicsICdzdG9wVGVzdCcsICdzdG9wVGVzdFJ1biddCiAgICAgICAgRm9vKGV2ZW50cykucnVuKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywgZXhwZWN0ZWQpCgogICAgIyAiV2hlbiBhIHNldFVwKCkgbWV0aG9kIGlzIGRlZmluZWQsIHRoZSB0ZXN0IHJ1bm5lciB3aWxsIHJ1biB0aGF0IG1ldGhvZAogICAgIyBwcmlvciB0byBlYWNoIHRlc3QuIExpa2V3aXNlLCBpZiBhIHRlYXJEb3duKCkgbWV0aG9kIGlzIGRlZmluZWQsIHRoZQogICAgIyB0ZXN0IHJ1bm5lciB3aWxsIGludm9rZSB0aGF0IG1ldGhvZCBhZnRlciBlYWNoIHRlc3QuIEluIHRoZSBleGFtcGxlLAogICAgIyBzZXRVcCgpIHdhcyB1c2VkIHRvIGNyZWF0ZSBhIGZyZXNoIHNlcXVlbmNlIGZvciBlYWNoIHRlc3QuIgogICAgIwogICAgIyBNYWtlIHN1cmUgdGhlIHByb3BlciBjYWxsIG9yZGVyIGlzIG1haW50YWluZWQsIGV2ZW4gaWYgdGhlIHRlc3Qgc2lnbmFscwogICAgIyBhIGZhaWx1cmUgKGFzIG9wcG9zZWQgdG8gYW4gZXJyb3IpLgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2ZhaWx1cmVfaW5fdGVzdChzZWxmKToKICAgICAgICBldmVudHMgPSBbXQogICAgICAgIHJlc3VsdCA9IExvZ2dpbmdSZXN1bHQoZXZlbnRzKQoKICAgICAgICBjbGFzcyBGb28oVGVzdC5Mb2dnaW5nVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHN1cGVyKEZvbywgc2VsZikudGVzdCgpCiAgICAgICAgICAgICAgICBzZWxmLmZhaWwoJ3JhaXNlZCBieSBGb28udGVzdCcpCgogICAgICAgIGV4cGVjdGVkID0gWydzdGFydFRlc3QnLCAnc2V0VXAnLCAndGVzdCcsICd0ZWFyRG93bicsCiAgICAgICAgICAgICAgICAgICAgJ2FkZEZhaWx1cmUnLCAnc3RvcFRlc3QnXQogICAgICAgIEZvbyhldmVudHMpLnJ1bihyZXN1bHQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIGV4cGVjdGVkKQoKICAgICMgIldoZW4gYSB0ZXN0IGZhaWxzIHdpdGggYSBkZWZhdWx0IHJlc3VsdCBzdG9wVGVzdFJ1biBpcyBzdGlsbCBjYWxsZWQuIgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2ZhaWx1cmVfaW5fdGVzdF9kZWZhdWx0X3Jlc3VsdChzZWxmKToKCiAgICAgICAgY2xhc3MgRm9vKFRlc3QuTG9nZ2luZ1Rlc3RDYXNlKToKICAgICAgICAgICAgZGVmIGRlZmF1bHRUZXN0UmVzdWx0KHNlbGYpOgogICAgICAgICAgICAgICAgcmV0dXJuIExvZ2dpbmdSZXN1bHQoc2VsZi5ldmVudHMpCiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgc3VwZXIoRm9vLCBzZWxmKS50ZXN0KCkKICAgICAgICAgICAgICAgIHNlbGYuZmFpbCgncmFpc2VkIGJ5IEZvby50ZXN0JykKCiAgICAgICAgZXhwZWN0ZWQgPSBbJ3N0YXJ0VGVzdFJ1bicsICdzdGFydFRlc3QnLCAnc2V0VXAnLCAndGVzdCcsCiAgICAgICAgICAgICAgICAgICAgJ3RlYXJEb3duJywgJ2FkZEZhaWx1cmUnLCAnc3RvcFRlc3QnLCAnc3RvcFRlc3RSdW4nXQogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgRm9vKGV2ZW50cykucnVuKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywgZXhwZWN0ZWQpCgogICAgIyAiV2hlbiBhIHNldFVwKCkgbWV0aG9kIGlzIGRlZmluZWQsIHRoZSB0ZXN0IHJ1bm5lciB3aWxsIHJ1biB0aGF0IG1ldGhvZAogICAgIyBwcmlvciB0byBlYWNoIHRlc3QuIExpa2V3aXNlLCBpZiBhIHRlYXJEb3duKCkgbWV0aG9kIGlzIGRlZmluZWQsIHRoZQogICAgIyB0ZXN0IHJ1bm5lciB3aWxsIGludm9rZSB0aGF0IG1ldGhvZCBhZnRlciBlYWNoIHRlc3QuIEluIHRoZSBleGFtcGxlLAogICAgIyBzZXRVcCgpIHdhcyB1c2VkIHRvIGNyZWF0ZSBhIGZyZXNoIHNlcXVlbmNlIGZvciBlYWNoIHRlc3QuIgogICAgIwogICAgIyBNYWtlIHN1cmUgdGhlIHByb3BlciBjYWxsIG9yZGVyIGlzIG1haW50YWluZWQsIGV2ZW4gaWYgdGVhckRvd24oKSByYWlzZXMKICAgICMgYW4gZXhjZXB0aW9uLgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2Vycm9yX2luX3RlYXJEb3duKHNlbGYpOgogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCgogICAgICAgIGNsYXNzIEZvbyhUZXN0LkxvZ2dpbmdUZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZWFyRG93bihzZWxmKToKICAgICAgICAgICAgICAgIHN1cGVyKEZvbywgc2VsZikudGVhckRvd24oKQogICAgICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCdyYWlzZWQgYnkgRm9vLnRlYXJEb3duJykKCiAgICAgICAgRm9vKGV2ZW50cykucnVuKHJlc3VsdCkKICAgICAgICBleHBlY3RlZCA9IFsnc3RhcnRUZXN0JywgJ3NldFVwJywgJ3Rlc3QnLCAndGVhckRvd24nLCAnYWRkRXJyb3InLAogICAgICAgICAgICAgICAgICAgICdzdG9wVGVzdCddCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIGV4cGVjdGVkKQoKICAgICMgIldoZW4gdGVhckRvd24gZXJyb3JzIHdpdGggYSBkZWZhdWx0IHJlc3VsdCBzdG9wVGVzdFJ1biBpcyBzdGlsbCBjYWxsZWQuIgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2Vycm9yX2luX3RlYXJEb3duX2RlZmF1bHRfcmVzdWx0KHNlbGYpOgoKICAgICAgICBjbGFzcyBGb28oVGVzdC5Mb2dnaW5nVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgZGVmYXVsdFRlc3RSZXN1bHQoc2VsZik6CiAgICAgICAgICAgICAgICByZXR1cm4gTG9nZ2luZ1Jlc3VsdChzZWxmLmV2ZW50cykKICAgICAgICAgICAgZGVmIHRlYXJEb3duKHNlbGYpOgogICAgICAgICAgICAgICAgc3VwZXIoRm9vLCBzZWxmKS50ZWFyRG93bigpCiAgICAgICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoJ3JhaXNlZCBieSBGb28udGVhckRvd24nKQoKICAgICAgICBldmVudHMgPSBbXQogICAgICAgIEZvbyhldmVudHMpLnJ1bigpCiAgICAgICAgZXhwZWN0ZWQgPSBbJ3N0YXJ0VGVzdFJ1bicsICdzdGFydFRlc3QnLCAnc2V0VXAnLCAndGVzdCcsICd0ZWFyRG93bicsCiAgICAgICAgICAgICAgICAgICAgJ2FkZEVycm9yJywgJ3N0b3BUZXN0JywgJ3N0b3BUZXN0UnVuJ10KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywgZXhwZWN0ZWQpCgogICAgIyAiVGVzdENhc2UucnVuKCkgc3RpbGwgd29ya3Mgd2hlbiB0aGUgZGVmYXVsdFRlc3RSZXN1bHQgaXMgYSBUZXN0UmVzdWx0CiAgICAjIHRoYXQgZG9lcyBub3Qgc3VwcG9ydCBzdGFydFRlc3RSdW4gYW5kIHN0b3BUZXN0UnVuLgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfZGVmYXVsdF9yZXN1bHQoc2VsZik6CgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBkZWZhdWx0VGVzdFJlc3VsdChzZWxmKToKICAgICAgICAgICAgICAgIHJldHVybiBSZXN1bHRXaXRoTm9TdGFydFRlc3RSdW5TdG9wVGVzdFJ1bigpCiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBGb28oJ3Rlc3QnKS5ydW4oKQoKICAgICMgIlRoaXMgY2xhc3MgYXR0cmlidXRlIGdpdmVzIHRoZSBleGNlcHRpb24gcmFpc2VkIGJ5IHRoZSB0ZXN0KCkgbWV0aG9kLgogICAgIyBJZiBhIHRlc3QgZnJhbWV3b3JrIG5lZWRzIHRvIHVzZSBhIHNwZWNpYWxpemVkIGV4Y2VwdGlvbiwgcG9zc2libHkgdG8KICAgICMgY2FycnkgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiwgaXQgbXVzdCBzdWJjbGFzcyB0aGlzIGV4Y2VwdGlvbiBpbgogICAgIyBvcmRlciB0byBgYHBsYXkgZmFpcicnIHdpdGggdGhlIGZyYW1ld29yay4gIFRoZSBpbml0aWFsIHZhbHVlIG9mIHRoaXMKICAgICMgYXR0cmlidXRlIGlzIEFzc2VydGlvbkVycm9yIgogICAgZGVmIHRlc3RfZmFpbHVyZUV4Y2VwdGlvbl9fZGVmYXVsdChzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKEZvbygndGVzdCcpLmZhaWx1cmVFeGNlcHRpb24gaXMgQXNzZXJ0aW9uRXJyb3IpCgogICAgIyAiVGhpcyBjbGFzcyBhdHRyaWJ1dGUgZ2l2ZXMgdGhlIGV4Y2VwdGlvbiByYWlzZWQgYnkgdGhlIHRlc3QoKSBtZXRob2QuCiAgICAjIElmIGEgdGVzdCBmcmFtZXdvcmsgbmVlZHMgdG8gdXNlIGEgc3BlY2lhbGl6ZWQgZXhjZXB0aW9uLCBwb3NzaWJseSB0bwogICAgIyBjYXJyeSBhZGRpdGlvbmFsIGluZm9ybWF0aW9uLCBpdCBtdXN0IHN1YmNsYXNzIHRoaXMgZXhjZXB0aW9uIGluCiAgICAjIG9yZGVyIHRvIGBgcGxheSBmYWlyJycgd2l0aCB0aGUgZnJhbWV3b3JrLiIKICAgICMKICAgICMgTWFrZSBzdXJlIFRlc3RDYXNlLnJ1bigpIHJlc3BlY3RzIHRoZSBkZXNpZ25hdGVkIGZhaWx1cmVFeGNlcHRpb24KICAgIGRlZiB0ZXN0X2ZhaWx1cmVFeGNlcHRpb25fX3N1YmNsYXNzaW5nX19leHBsaWNpdF9yYWlzZShzZWxmKToKICAgICAgICBldmVudHMgPSBbXQogICAgICAgIHJlc3VsdCA9IExvZ2dpbmdSZXN1bHQoZXZlbnRzKQoKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigpCgogICAgICAgICAgICBmYWlsdXJlRXhjZXB0aW9uID0gUnVudGltZUVycm9yCgogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShGb28oJ3Rlc3QnKS5mYWlsdXJlRXhjZXB0aW9uIGlzIFJ1bnRpbWVFcnJvcikKCgogICAgICAgIEZvbygndGVzdCcpLnJ1bihyZXN1bHQpCiAgICAgICAgZXhwZWN0ZWQgPSBbJ3N0YXJ0VGVzdCcsICdhZGRGYWlsdXJlJywgJ3N0b3BUZXN0J10KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywgZXhwZWN0ZWQpCgogICAgIyAiVGhpcyBjbGFzcyBhdHRyaWJ1dGUgZ2l2ZXMgdGhlIGV4Y2VwdGlvbiByYWlzZWQgYnkgdGhlIHRlc3QoKSBtZXRob2QuCiAgICAjIElmIGEgdGVzdCBmcmFtZXdvcmsgbmVlZHMgdG8gdXNlIGEgc3BlY2lhbGl6ZWQgZXhjZXB0aW9uLCBwb3NzaWJseSB0bwogICAgIyBjYXJyeSBhZGRpdGlvbmFsIGluZm9ybWF0aW9uLCBpdCBtdXN0IHN1YmNsYXNzIHRoaXMgZXhjZXB0aW9uIGluCiAgICAjIG9yZGVyIHRvIGBgcGxheSBmYWlyJycgd2l0aCB0aGUgZnJhbWV3b3JrLiIKICAgICMKICAgICMgTWFrZSBzdXJlIFRlc3RDYXNlLnJ1bigpIHJlc3BlY3RzIHRoZSBkZXNpZ25hdGVkIGZhaWx1cmVFeGNlcHRpb24KICAgIGRlZiB0ZXN0X2ZhaWx1cmVFeGNlcHRpb25fX3N1YmNsYXNzaW5nX19pbXBsaWNpdF9yYWlzZShzZWxmKToKICAgICAgICBldmVudHMgPSBbXQogICAgICAgIHJlc3VsdCA9IExvZ2dpbmdSZXN1bHQoZXZlbnRzKQoKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHNlbGYuZmFpbCgiZm9vIikKCiAgICAgICAgICAgIGZhaWx1cmVFeGNlcHRpb24gPSBSdW50aW1lRXJyb3IKCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKEZvbygndGVzdCcpLmZhaWx1cmVFeGNlcHRpb24gaXMgUnVudGltZUVycm9yKQoKCiAgICAgICAgRm9vKCd0ZXN0JykucnVuKHJlc3VsdCkKICAgICAgICBleHBlY3RlZCA9IFsnc3RhcnRUZXN0JywgJ2FkZEZhaWx1cmUnLCAnc3RvcFRlc3QnXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZXZlbnRzLCBleHBlY3RlZCkKCiAgICAjICJUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBkb2VzIG5vdGhpbmcuIgogICAgZGVmIHRlc3Rfc2V0VXAoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHJ1blRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgICMgLi4uIGFuZCBub3RoaW5nIHNob3VsZCBoYXBwZW4KICAgICAgICBGb28oKS5zZXRVcCgpCgogICAgIyAiVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gZG9lcyBub3RoaW5nLiIKICAgIGRlZiB0ZXN0X3RlYXJEb3duKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBydW5UZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICAjIC4uLiBhbmQgbm90aGluZyBzaG91bGQgaGFwcGVuCiAgICAgICAgRm9vKCkudGVhckRvd24oKQoKICAgICMgIlJldHVybiBhIHN0cmluZyBpZGVudGlmeWluZyB0aGUgc3BlY2lmaWMgdGVzdCBjYXNlLiIKICAgICMKICAgICMgQmVjYXVzZSBvZiB0aGUgdmFndWUgbmF0dXJlIG9mIHRoZSBkb2NzLCBJJ20gbm90IGdvaW5nIHRvIGxvY2sgdGhpcwogICAgIyB0ZXN0IGRvd24gdG9vIG11Y2guIFJlYWxseSBhbGwgdGhhdCBjYW4gYmUgYXNzZXJ0ZWQgaXMgdGhhdCB0aGUgaWQoKQogICAgIyB3aWxsIGJlIGEgc3RyaW5nIChlaXRoZXIgOC1ieXRlIG9yIHVuaWNvZGUgLS0gYWdhaW4sIGJlY2F1c2UgdGhlIGRvY3MKICAgICMganVzdCBzYXkgInN0cmluZyIpCiAgICBkZWYgdGVzdF9pZChzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgcnVuVGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKEZvbygpLmlkKCksIHN0cikKCgogICAgIyAiSWYgcmVzdWx0IGlzIG9taXR0ZWQgb3IgTm9uZSwgYSB0ZW1wb3JhcnkgcmVzdWx0IG9iamVjdCBpcyBjcmVhdGVkLAogICAgIyB1c2VkLCBhbmQgaXMgbWFkZSBhdmFpbGFibGUgdG8gdGhlIGNhbGxlci4gQXMgVGVzdENhc2Ugb3ducyB0aGUKICAgICMgdGVtcG9yYXJ5IHJlc3VsdCBzdGFydFRlc3RSdW4gYW5kIHN0b3BUZXN0UnVuIGFyZSBjYWxsZWQuCgogICAgZGVmIHRlc3RfcnVuX191c2VzX2RlZmF1bHRUZXN0UmVzdWx0KHNlbGYpOgogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgZGVmYXVsdFJlc3VsdCA9IExvZ2dpbmdSZXN1bHQoZXZlbnRzKQoKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIGV2ZW50cy5hcHBlbmQoJ3Rlc3QnKQoKICAgICAgICAgICAgZGVmIGRlZmF1bHRUZXN0UmVzdWx0KHNlbGYpOgogICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRSZXN1bHQKCiAgICAgICAgIyBNYWtlIHJ1bigpIGZpbmQgYSByZXN1bHQgb2JqZWN0IG9uIGl0cyBvd24KICAgICAgICByZXN1bHQgPSBGb28oJ3Rlc3QnKS5ydW4oKQoKICAgICAgICBzZWxmLmFzc2VydElzKHJlc3VsdCwgZGVmYXVsdFJlc3VsdCkKICAgICAgICBleHBlY3RlZCA9IFsnc3RhcnRUZXN0UnVuJywgJ3N0YXJ0VGVzdCcsICd0ZXN0JywgJ2FkZFN1Y2Nlc3MnLAogICAgICAgICAgICAnc3RvcFRlc3QnLCAnc3RvcFRlc3RSdW4nXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZXZlbnRzLCBleHBlY3RlZCkKCgogICAgIyAiVGhlIHJlc3VsdCBvYmplY3QgaXMgcmV0dXJuZWQgdG8gcnVuJ3MgY2FsbGVyIgogICAgZGVmIHRlc3RfcnVuX19yZXR1cm5zX2dpdmVuX3Jlc3VsdChzZWxmKToKCiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQoKICAgICAgICByZXR2YWwgPSBGb28oJ3Rlc3QnKS5ydW4ocmVzdWx0KQogICAgICAgIHNlbGYuYXNzZXJ0SXMocmV0dmFsLCByZXN1bHQpCgoKICAgICMgIlRoZSBzYW1lIGVmZmVjdCBbYXMgbWV0aG9kIHJ1bl0gbWF5IGJlIGhhZCBieSBzaW1wbHkgY2FsbGluZyB0aGUKICAgICMgVGVzdENhc2UgaW5zdGFuY2UuIgogICAgZGVmIHRlc3RfY2FsbF9faW52b2tpbmdfYW5faW5zdGFuY2VfZGVsZWdhdGVzX3RvX3J1bihzZWxmKToKICAgICAgICByZXN1bHRJbiA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHJlc3VsdE91dCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQoKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgICAgIGRlZiBydW4oc2VsZiwgcmVzdWx0KToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMocmVzdWx0LCByZXN1bHRJbikKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRPdXQKCiAgICAgICAgcmV0dmFsID0gRm9vKCd0ZXN0JykocmVzdWx0SW4pCgogICAgICAgIHNlbGYuYXNzZXJ0SXMocmV0dmFsLCByZXN1bHRPdXQpCgoKICAgIGRlZiB0ZXN0U2hvcnREZXNjcmlwdGlvbldpdGhvdXREb2NzdHJpbmcoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRJc05vbmUoc2VsZi5zaG9ydERlc2NyaXB0aW9uKCkpCgogICAgQHVuaXR0ZXN0LnNraXBJZihzeXMuZmxhZ3Mub3B0aW1pemUgPj0gMiwKICAgICAgICAgICAgICAgICAgICAgIkRvY3N0cmluZ3MgYXJlIG9taXR0ZWQgd2l0aCAtTzIgYW5kIGFib3ZlIikKICAgIGRlZiB0ZXN0U2hvcnREZXNjcmlwdGlvbldpdGhPbmVMaW5lRG9jc3RyaW5nKHNlbGYpOgogICAgICAgICIiIlRlc3RzIHNob3J0RGVzY3JpcHRpb24oKSBmb3IgYSBtZXRob2Qgd2l0aCBhIGRvY3N0cmluZy4iIiIKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKAogICAgICAgICAgICAgICAgc2VsZi5zaG9ydERlc2NyaXB0aW9uKCksCiAgICAgICAgICAgICAgICAnVGVzdHMgc2hvcnREZXNjcmlwdGlvbigpIGZvciBhIG1ldGhvZCB3aXRoIGEgZG9jc3RyaW5nLicpCgogICAgQHVuaXR0ZXN0LnNraXBJZihzeXMuZmxhZ3Mub3B0aW1pemUgPj0gMiwKICAgICAgICAgICAgICAgICAgICAgIkRvY3N0cmluZ3MgYXJlIG9taXR0ZWQgd2l0aCAtTzIgYW5kIGFib3ZlIikKICAgIGRlZiB0ZXN0U2hvcnREZXNjcmlwdGlvbldpdGhNdWx0aUxpbmVEb2NzdHJpbmcoc2VsZik6CiAgICAgICAgIiIiVGVzdHMgc2hvcnREZXNjcmlwdGlvbigpIGZvciBhIG1ldGhvZCB3aXRoIGEgbG9uZ2VyIGRvY3N0cmluZy4KCiAgICAgICAgVGhpcyBtZXRob2QgZW5zdXJlcyB0aGF0IG9ubHkgdGhlIGZpcnN0IGxpbmUgb2YgYSBkb2NzdHJpbmcgaXMKICAgICAgICByZXR1cm5lZCB1c2VkIGluIHRoZSBzaG9ydCBkZXNjcmlwdGlvbiwgbm8gbWF0dGVyIGhvdyBsb25nIHRoZQogICAgICAgIHdob2xlIHRoaW5nIGlzLgogICAgICAgICIiIgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoCiAgICAgICAgICAgICAgICBzZWxmLnNob3J0RGVzY3JpcHRpb24oKSwKICAgICAgICAgICAgICAgICAnVGVzdHMgc2hvcnREZXNjcmlwdGlvbigpIGZvciBhIG1ldGhvZCB3aXRoIGEgbG9uZ2VyICcKICAgICAgICAgICAgICAgICAnZG9jc3RyaW5nLicpCgogICAgZGVmIHRlc3RBZGRUeXBlRXF1YWxpdHlGdW5jKHNlbGYpOgogICAgICAgIGNsYXNzIFNhZFNuYWtlKG9iamVjdCk6CiAgICAgICAgICAgICIiIkR1bW15IGNsYXNzIGZvciB0ZXN0X2FkZFR5cGVFcXVhbGl0eUZ1bmMuIiIiCiAgICAgICAgczEsIHMyID0gU2FkU25ha2UoKSwgU2FkU25ha2UoKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoczEgPT0gczIpCiAgICAgICAgZGVmIEFsbFNuYWtlc0NyZWF0ZWRFcXVhbChhLCBiLCBtc2c9Tm9uZSk6CiAgICAgICAgICAgIHJldHVybiB0eXBlKGEpID09IHR5cGUoYikgPT0gU2FkU25ha2UKICAgICAgICBzZWxmLmFkZFR5cGVFcXVhbGl0eUZ1bmMoU2FkU25ha2UsIEFsbFNuYWtlc0NyZWF0ZWRFcXVhbCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHMxLCBzMikKICAgICAgICAjIE5vIHRoaXMgZG9lc24ndCBjbGVhbiB1cCBhbmQgcmVtb3ZlIHRoZSBTYWRTbmFrZSBlcXVhbGl0eSBmdW5jCiAgICAgICAgIyBmcm9tIHRoaXMgVGVzdENhc2UgaW5zdGFuY2UgYnV0IHNpbmNlIGl0cyBhIGxvY2FsIG5vdGhpbmcgZWxzZQogICAgICAgICMgd2lsbCBldmVyIG5vdGljZSB0aGF0LgoKICAgIGRlZiB0ZXN0QXNzZXJ0SXMoc2VsZik6CiAgICAgICAgdGhpbmcgPSBvYmplY3QoKQogICAgICAgIHNlbGYuYXNzZXJ0SXModGhpbmcsIHRoaW5nKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRJcywgdGhpbmcsIG9iamVjdCgpKQoKICAgIGRlZiB0ZXN0QXNzZXJ0SXNOb3Qoc2VsZik6CiAgICAgICAgdGhpbmcgPSBvYmplY3QoKQogICAgICAgIHNlbGYuYXNzZXJ0SXNOb3QodGhpbmcsIG9iamVjdCgpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRJc05vdCwgdGhpbmcsIHRoaW5nKQoKICAgIGRlZiB0ZXN0QXNzZXJ0SXNJbnN0YW5jZShzZWxmKToKICAgICAgICB0aGluZyA9IFtdCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHRoaW5nLCBsaXN0KQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRJc0luc3RhbmNlLAogICAgICAgICAgICAgICAgICAgICAgICAgIHRoaW5nLCBkaWN0KQoKICAgIGRlZiB0ZXN0QXNzZXJ0Tm90SXNJbnN0YW5jZShzZWxmKToKICAgICAgICB0aGluZyA9IFtdCiAgICAgICAgc2VsZi5hc3NlcnROb3RJc0luc3RhbmNlKHRoaW5nLCBkaWN0KQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnROb3RJc0luc3RhbmNlLAogICAgICAgICAgICAgICAgICAgICAgICAgIHRoaW5nLCBsaXN0KQoKICAgIGRlZiB0ZXN0QXNzZXJ0SW4oc2VsZik6CiAgICAgICAgYW5pbWFscyA9IHsnbW9ua2V5JzogJ2JhbmFuYScsICdjb3cnOiAnZ3Jhc3MnLCAnc2VhbCc6ICdmaXNoJ30KCiAgICAgICAgc2VsZi5hc3NlcnRJbignYScsICdhYmMnKQogICAgICAgIHNlbGYuYXNzZXJ0SW4oMiwgWzEsIDIsIDNdKQogICAgICAgIHNlbGYuYXNzZXJ0SW4oJ21vbmtleScsIGFuaW1hbHMpCgogICAgICAgIHNlbGYuYXNzZXJ0Tm90SW4oJ2QnLCAnYWJjJykKICAgICAgICBzZWxmLmFzc2VydE5vdEluKDAsIFsxLCAyLCAzXSkKICAgICAgICBzZWxmLmFzc2VydE5vdEluKCdvdHRlcicsIGFuaW1hbHMpCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRJbiwgJ3gnLCAnYWJjJykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0SW4sIDQsIFsxLCAyLCAzXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0SW4sICdlbGVwaGFudCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWFscykKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydE5vdEluLCAnYycsICdhYmMnKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnROb3RJbiwgMSwgWzEsIDIsIDNdKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnROb3RJbiwgJ2NvdycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWFscykKCiAgICBkZWYgdGVzdEFzc2VydERpY3RDb250YWluc1N1YnNldChzZWxmKToKICAgICAgICB3aXRoIHdhcm5pbmdzLmNhdGNoX3dhcm5pbmdzKCk6CiAgICAgICAgICAgIHdhcm5pbmdzLnNpbXBsZWZpbHRlcigiaWdub3JlIiwgRGVwcmVjYXRpb25XYXJuaW5nKQoKICAgICAgICAgICAgc2VsZi5hc3NlcnREaWN0Q29udGFpbnNTdWJzZXQoe30sIHt9KQogICAgICAgICAgICBzZWxmLmFzc2VydERpY3RDb250YWluc1N1YnNldCh7fSwgeydhJzogMX0pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0KHsnYSc6IDF9LCB7J2EnOiAxfSkKICAgICAgICAgICAgc2VsZi5hc3NlcnREaWN0Q29udGFpbnNTdWJzZXQoeydhJzogMX0sIHsnYSc6IDEsICdiJzogMn0pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0KHsnYSc6IDEsICdiJzogMn0sIHsnYSc6IDEsICdiJzogMn0pCgogICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbik6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydERpY3RDb250YWluc1N1YnNldCh7MTogIm9uZSJ9LCB7fSkKCiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0KHsnYSc6IDJ9LCB7J2EnOiAxfSkKCiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0KHsnYyc6IDF9LCB7J2EnOiAxfSkKCiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0KHsnYSc6IDEsICdjJzogMX0sIHsnYSc6IDF9KQoKICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24pOgogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnREaWN0Q29udGFpbnNTdWJzZXQoeydhJzogMSwgJ2MnOiAxfSwgeydhJzogMX0pCgogICAgICAgICAgICBvbmUgPSAnJy5qb2luKGNocihpKSBmb3IgaSBpbiByYW5nZSgyNTUpKQogICAgICAgICAgICAjIHRoaXMgdXNlZCB0byBjYXVzZSBhIFVuaWNvZGVEZWNvZGVFcnJvciBjb25zdHJ1Y3RpbmcgdGhlIGZhaWx1cmUgbXNnCiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0KHsnZm9vJzogb25lfSwgeydmb28nOiAnXHVGRkZEJ30pCgogICAgZGVmIHRlc3RBc3NlcnRFcXVhbChzZWxmKToKICAgICAgICBlcXVhbF9wYWlycyA9IFsKICAgICAgICAgICAgICAgICgoKSwgKCkpLAogICAgICAgICAgICAgICAgKHt9LCB7fSksCiAgICAgICAgICAgICAgICAoW10sIFtdKSwKICAgICAgICAgICAgICAgIChzZXQoKSwgc2V0KCkpLAogICAgICAgICAgICAgICAgKGZyb3plbnNldCgpLCBmcm96ZW5zZXQoKSldCiAgICAgICAgZm9yIGEsIGIgaW4gZXF1YWxfcGFpcnM6CiAgICAgICAgICAgICMgVGhpcyBtZXNzIG9mIHRyeSBleGNlcHRzIGlzIHRvIHRlc3QgdGhlIGFzc2VydEVxdWFsIGJlaGF2aW9yCiAgICAgICAgICAgICMgaXRzZWxmLgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGEsIGIpCiAgICAgICAgICAgIGV4Y2VwdCBzZWxmLmZhaWx1cmVFeGNlcHRpb246CiAgICAgICAgICAgICAgICBzZWxmLmZhaWwoJ2Fzc2VydEVxdWFsKCVyLCAlcikgZmFpbGVkJyAlIChhLCBiKSkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhLCBiLCBtc2c9J2ZvbycpCiAgICAgICAgICAgIGV4Y2VwdCBzZWxmLmZhaWx1cmVFeGNlcHRpb246CiAgICAgICAgICAgICAgICBzZWxmLmZhaWwoJ2Fzc2VydEVxdWFsKCVyLCAlcikgd2l0aCBtc2c9IGZhaWxlZCcgJSAoYSwgYikpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYSwgYiwgJ2ZvbycpCiAgICAgICAgICAgIGV4Y2VwdCBzZWxmLmZhaWx1cmVFeGNlcHRpb246CiAgICAgICAgICAgICAgICBzZWxmLmZhaWwoJ2Fzc2VydEVxdWFsKCVyLCAlcikgd2l0aCB0aGlyZCBwYXJhbWV0ZXIgZmFpbGVkJyAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgKGEsIGIpKQoKICAgICAgICB1bmVxdWFsX3BhaXJzID0gWwogICAgICAgICAgICAgICAoKCksIFtdKSwKICAgICAgICAgICAgICAgKHt9LCBzZXQoKSksCiAgICAgICAgICAgICAgIChzZXQoWzQsMV0pLCBmcm96ZW5zZXQoWzQsMl0pKSwKICAgICAgICAgICAgICAgKGZyb3plbnNldChbNCw1XSksIHNldChbMiwzXSkpLAogICAgICAgICAgICAgICAoc2V0KFszLDRdKSwgc2V0KFs1LDRdKSldCiAgICAgICAgZm9yIGEsIGIgaW4gdW5lcXVhbF9wYWlyczoKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydEVxdWFsLCBhLCBiKQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0RXF1YWwsIGEsIGIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmb28nKQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0RXF1YWwsIGEsIGIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZz0nZm9vJykKCiAgICBkZWYgdGVzdEVxdWFsaXR5KHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0TGlzdEVxdWFsKFtdLCBbXSkKICAgICAgICBzZWxmLmFzc2VydFR1cGxlRXF1YWwoKCksICgpKQogICAgICAgIHNlbGYuYXNzZXJ0U2VxdWVuY2VFcXVhbChbXSwgKCkpCgogICAgICAgIGEgPSBbMCwgJ2EnLCBbXV0KICAgICAgICBiID0gW10KICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyh1bml0dGVzdC5UZXN0Q2FzZS5mYWlsdXJlRXhjZXB0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0TGlzdEVxdWFsLCBhLCBiKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHVuaXR0ZXN0LlRlc3RDYXNlLmZhaWx1cmVFeGNlcHRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRMaXN0RXF1YWwsIHR1cGxlKGEpLCB0dXBsZShiKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyh1bml0dGVzdC5UZXN0Q2FzZS5mYWlsdXJlRXhjZXB0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0U2VxdWVuY2VFcXVhbCwgYSwgdHVwbGUoYikpCgogICAgICAgIGIuZXh0ZW5kKGEpCiAgICAgICAgc2VsZi5hc3NlcnRMaXN0RXF1YWwoYSwgYikKICAgICAgICBzZWxmLmFzc2VydFR1cGxlRXF1YWwodHVwbGUoYSksIHR1cGxlKGIpKQogICAgICAgIHNlbGYuYXNzZXJ0U2VxdWVuY2VFcXVhbChhLCB0dXBsZShiKSkKICAgICAgICBzZWxmLmFzc2VydFNlcXVlbmNlRXF1YWwodHVwbGUoYSksIGIpCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRMaXN0RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgYSwgdHVwbGUoYikpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydFR1cGxlRXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgdHVwbGUoYSksIGIpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydExpc3RFcXVhbCwgTm9uZSwgYikKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0VHVwbGVFcXVhbCwgTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICB0dXBsZShiKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0U2VxdWVuY2VFcXVhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICBOb25lLCB0dXBsZShiKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0TGlzdEVxdWFsLCAxLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRUdXBsZUVxdWFsLCAxLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRTZXF1ZW5jZUVxdWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgIDEsIDEpCgogICAgICAgIHNlbGYuYXNzZXJ0RGljdEVxdWFsKHt9LCB7fSkKCiAgICAgICAgYyA9IHsgJ3gnOiAxIH0KICAgICAgICBkID0ge30KICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyh1bml0dGVzdC5UZXN0Q2FzZS5mYWlsdXJlRXhjZXB0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RGljdEVxdWFsLCBjLCBkKQoKICAgICAgICBkLnVwZGF0ZShjKQogICAgICAgIHNlbGYuYXNzZXJ0RGljdEVxdWFsKGMsIGQpCgogICAgICAgIGRbJ3gnXSA9IDAKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyh1bml0dGVzdC5UZXN0Q2FzZS5mYWlsdXJlRXhjZXB0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RGljdEVxdWFsLCBjLCBkLCAnVGhlc2UgYXJlIHVuZXF1YWwnKQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0RGljdEVxdWFsLCBOb25lLCBkKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnREaWN0RXF1YWwsIFtdLCBkKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnREaWN0RXF1YWwsIDEsIDEpCgogICAgZGVmIHRlc3RBc3NlcnRTZXF1ZW5jZUVxdWFsTWF4RGlmZihzZWxmKToKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNlbGYubWF4RGlmZiwgODAqOCkKICAgICAgICBzZXExID0gJ2EnICsgJ3gnICogODAqKjIKICAgICAgICBzZXEyID0gJ2InICsgJ3gnICogODAqKjIKICAgICAgICBkaWZmID0gJ1xuJy5qb2luKGRpZmZsaWIubmRpZmYocHByaW50LnBmb3JtYXQoc2VxMSkuc3BsaXRsaW5lcygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcHJpbnQucGZvcm1hdChzZXEyKS5zcGxpdGxpbmVzKCkpKQogICAgICAgICMgdGhlICsxIGlzIHRoZSBsZWFkaW5nIFxuIGFkZGVkIGJ5IGFzc2VydFNlcXVlbmNlRXF1YWwKICAgICAgICBvbWl0dGVkID0gdW5pdHRlc3QuY2FzZS5ESUZGX09NSVRURUQgJSAobGVuKGRpZmYpICsgMSwpCgogICAgICAgIHNlbGYubWF4RGlmZiA9IGxlbihkaWZmKS8vMgogICAgICAgIHRyeToKCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0U2VxdWVuY2VFcXVhbChzZXExLCBzZXEyKQogICAgICAgIGV4Y2VwdCBzZWxmLmZhaWx1cmVFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbXNnID0gZS5hcmdzWzBdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCdhc3NlcnRTZXF1ZW5jZUVxdWFsIGRpZCBub3QgZmFpbC4nKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShsZW4obXNnKSA8IGxlbihkaWZmKSkKICAgICAgICBzZWxmLmFzc2VydEluKG9taXR0ZWQsIG1zZykKCiAgICAgICAgc2VsZi5tYXhEaWZmID0gbGVuKGRpZmYpICogMgogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRTZXF1ZW5jZUVxdWFsKHNlcTEsIHNlcTIpCiAgICAgICAgZXhjZXB0IHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBtc2cgPSBlLmFyZ3NbMF0KICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoJ2Fzc2VydFNlcXVlbmNlRXF1YWwgZGlkIG5vdCBmYWlsLicpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGxlbihtc2cpID4gbGVuKGRpZmYpKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90SW4ob21pdHRlZCwgbXNnKQoKICAgICAgICBzZWxmLm1heERpZmYgPSBOb25lCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmFzc2VydFNlcXVlbmNlRXF1YWwoc2VxMSwgc2VxMikKICAgICAgICBleGNlcHQgc2VsZi5mYWlsdXJlRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIG1zZyA9IGUuYXJnc1swXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgnYXNzZXJ0U2VxdWVuY2VFcXVhbCBkaWQgbm90IGZhaWwuJykKICAgICAgICBzZWxmLmFzc2VydFRydWUobGVuKG1zZykgPiBsZW4oZGlmZikpCiAgICAgICAgc2VsZi5hc3NlcnROb3RJbihvbWl0dGVkLCBtc2cpCgogICAgZGVmIHRlc3RUcnVuY2F0ZU1lc3NhZ2Uoc2VsZik6CiAgICAgICAgc2VsZi5tYXhEaWZmID0gMQogICAgICAgIG1lc3NhZ2UgPSBzZWxmLl90cnVuY2F0ZU1lc3NhZ2UoJ2ZvbycsICdiYXInKQogICAgICAgIG9taXR0ZWQgPSB1bml0dGVzdC5jYXNlLkRJRkZfT01JVFRFRCAlIGxlbignYmFyJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1lc3NhZ2UsICdmb28nICsgb21pdHRlZCkKCiAgICAgICAgc2VsZi5tYXhEaWZmID0gTm9uZQogICAgICAgIG1lc3NhZ2UgPSBzZWxmLl90cnVuY2F0ZU1lc3NhZ2UoJ2ZvbycsICdiYXInKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobWVzc2FnZSwgJ2Zvb2JhcicpCgogICAgICAgIHNlbGYubWF4RGlmZiA9IDQKICAgICAgICBtZXNzYWdlID0gc2VsZi5fdHJ1bmNhdGVNZXNzYWdlKCdmb28nLCAnYmFyJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1lc3NhZ2UsICdmb29iYXInKQoKICAgIGRlZiB0ZXN0QXNzZXJ0RGljdEVxdWFsVHJ1bmNhdGVzKHNlbGYpOgogICAgICAgIHRlc3QgPSB1bml0dGVzdC5UZXN0Q2FzZSgnYXNzZXJ0RXF1YWwnKQogICAgICAgIGRlZiB0cnVuY2F0ZShtc2csIGRpZmYpOgogICAgICAgICAgICByZXR1cm4gJ2ZvbycKICAgICAgICB0ZXN0Ll90cnVuY2F0ZU1lc3NhZ2UgPSB0cnVuY2F0ZQogICAgICAgIHRyeToKICAgICAgICAgICAgdGVzdC5hc3NlcnREaWN0RXF1YWwoe30sIHsxOiAwfSkKICAgICAgICBleGNlcHQgc2VsZi5mYWlsdXJlRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGUpLCAnZm9vJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoJ2Fzc2VydERpY3RFcXVhbCBkaWQgbm90IGZhaWwnKQoKICAgIGRlZiB0ZXN0QXNzZXJ0TXVsdGlMaW5lRXF1YWxUcnVuY2F0ZXMoc2VsZik6CiAgICAgICAgdGVzdCA9IHVuaXR0ZXN0LlRlc3RDYXNlKCdhc3NlcnRFcXVhbCcpCiAgICAgICAgZGVmIHRydW5jYXRlKG1zZywgZGlmZik6CiAgICAgICAgICAgIHJldHVybiAnZm9vJwogICAgICAgIHRlc3QuX3RydW5jYXRlTWVzc2FnZSA9IHRydW5jYXRlCiAgICAgICAgdHJ5OgogICAgICAgICAgICB0ZXN0LmFzc2VydE11bHRpTGluZUVxdWFsKCdmb28nLCAnYmFyJykKICAgICAgICBleGNlcHQgc2VsZi5mYWlsdXJlRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGUpLCAnZm9vJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoJ2Fzc2VydE11bHRpTGluZUVxdWFsIGRpZCBub3QgZmFpbCcpCgogICAgZGVmIHRlc3RBc3NlcnRFcXVhbF9kaWZmVGhyZXNob2xkKHNlbGYpOgogICAgICAgICMgY2hlY2sgdGhyZXNob2xkIHZhbHVlCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzZWxmLl9kaWZmVGhyZXNob2xkLCAyKioxNikKICAgICAgICAjIGRpc2FibGUgbWFkRGlmZiB0byBnZXQgZGlmZiBtYXJrZXJzCiAgICAgICAgc2VsZi5tYXhEaWZmID0gTm9uZQoKICAgICAgICAjIHNldCBhIGxvd2VyIHRocmVzaG9sZCB2YWx1ZSBhbmQgYWRkIGEgY2xlYW51cCB0byByZXN0b3JlIGl0CiAgICAgICAgb2xkX3RocmVzaG9sZCA9IHNlbGYuX2RpZmZUaHJlc2hvbGQKICAgICAgICBzZWxmLl9kaWZmVGhyZXNob2xkID0gMioqOAogICAgICAgIHNlbGYuYWRkQ2xlYW51cChsYW1iZGE6IHNldGF0dHIoc2VsZiwgJ19kaWZmVGhyZXNob2xkJywgb2xkX3RocmVzaG9sZCkpCgogICAgICAgICMgdW5kZXIgdGhlIHRocmVzaG9sZDogZGlmZiBtYXJrZXIgKF4pIGluIGVycm9yIG1lc3NhZ2UKICAgICAgICBzID0gJ3gnICogKDIqKjcpCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24pIGFzIGNtOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHMgKyAnYScsIHMgKyAnYicpCiAgICAgICAgc2VsZi5hc3NlcnRJbignXicsIHN0cihjbS5leGNlcHRpb24pKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocyArICdhJywgcyArICdhJykKCiAgICAgICAgIyBvdmVyIHRoZSB0aHJlc2hvbGQ6IGRpZmYgbm90IHVzZWQgYW5kIG1hcmtlciAoXikgbm90IGluIGVycm9yIG1lc3NhZ2UKICAgICAgICBzID0gJ3gnICogKDIqKjkpCiAgICAgICAgIyBpZiB0aGUgcGF0aCB0aGF0IHVzZXMgZGlmZmxpYiBpcyB0YWtlbiwgX3RydW5jYXRlTWVzc2FnZSB3aWxsIGJlCiAgICAgICAgIyBjYWxsZWQgLS0gcmVwbGFjZSBpdCB3aXRoIGV4cGxvZGluZ1RydW5jYXRpb24gdG8gdmVyaWZ5IHRoYXQgdGhpcwogICAgICAgICMgZG9lc24ndCBoYXBwZW4KICAgICAgICBkZWYgZXhwbG9kaW5nVHJ1bmNhdGlvbihtZXNzYWdlLCBkaWZmKToKICAgICAgICAgICAgcmFpc2UgU3lzdGVtRXJyb3IoJ3RoaXMgc2hvdWxkIG5vdCBiZSByYWlzZWQnKQogICAgICAgIG9sZF90cnVuY2F0ZSA9IHNlbGYuX3RydW5jYXRlTWVzc2FnZQogICAgICAgIHNlbGYuX3RydW5jYXRlTWVzc2FnZSA9IGV4cGxvZGluZ1RydW5jYXRpb24KICAgICAgICBzZWxmLmFkZENsZWFudXAobGFtYmRhOiBzZXRhdHRyKHNlbGYsICdfdHJ1bmNhdGVNZXNzYWdlJywgb2xkX3RydW5jYXRlKSkKCiAgICAgICAgczEsIHMyID0gcyArICdhJywgcyArICdiJwogICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uKSBhcyBjbToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzMSwgczIpCiAgICAgICAgc2VsZi5hc3NlcnROb3RJbignXicsIHN0cihjbS5leGNlcHRpb24pKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGNtLmV4Y2VwdGlvbiksICclciAhPSAlcicgJSAoczEsIHMyKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHMgKyAnYScsIHMgKyAnYScpCgogICAgZGVmIHRlc3RBc3NlcnRDb3VudEVxdWFsKHNlbGYpOgogICAgICAgIGEgPSBvYmplY3QoKQogICAgICAgIHNlbGYuYXNzZXJ0Q291bnRFcXVhbChbMSwgMiwgM10sIFszLCAyLCAxXSkKICAgICAgICBzZWxmLmFzc2VydENvdW50RXF1YWwoWydmb28nLCAnYmFyJywgJ2JheiddLCBbJ2JhcicsICdiYXonLCAnZm9vJ10pCiAgICAgICAgc2VsZi5hc3NlcnRDb3VudEVxdWFsKFthLCBhLCAyLCAyLCAzXSwgKGEsIDIsIDMsIGEsIDIpKQogICAgICAgIHNlbGYuYXNzZXJ0Q291bnRFcXVhbChbMSwgIjIiLCAiYSIsICJhIl0sIFsiYSIsICIyIiwgVHJ1ZSwgImEiXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0Q291bnRFcXVhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICBbMSwgMl0gKyBbM10gKiAxMDAsIFsxXSAqIDEwMCArIFsyLCAzXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0Q291bnRFcXVhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICBbMSwgIjIiLCAiYSIsICJhIl0sIFsiYSIsICIyIiwgVHJ1ZSwgMV0pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydENvdW50RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgWzEwXSwgWzEwLCAxMV0pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydENvdW50RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgWzEwLCAxMV0sIFsxMF0pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydENvdW50RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgWzEwLCAxMSwgMTBdLCBbMTAsIDExXSkKCiAgICAgICAgIyBUZXN0IHRoYXQgc2VxdWVuY2VzIG9mIHVuaGFzaGFibGUgb2JqZWN0cyBjYW4gYmUgdGVzdGVkIGZvciBzYW1lbmVzczoKICAgICAgICBzZWxmLmFzc2VydENvdW50RXF1YWwoW1sxLCAyXSwgWzMsIDRdLCAwXSwgW0ZhbHNlLCBbMywgNF0sIFsxLCAyXV0pCiAgICAgICAgIyBUZXN0IHRoYXQgaXRlcmF0b3Igb2YgdW5oYXNoYWJsZSBvYmplY3RzIGNhbiBiZSB0ZXN0ZWQgZm9yIHNhbWVuZXNzOgogICAgICAgIHNlbGYuYXNzZXJ0Q291bnRFcXVhbChpdGVyKFsxLCAyLCBbXSwgMywgNF0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVyKFsxLCAyLCBbXSwgMywgNF0pKQoKICAgICAgICAjIGhhc2hhYmxlIHR5cGVzLCBidXQgbm90IG9yZGVyYWJsZQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRDb3VudEVxdWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgIFtdLCBbZGl2bW9kLCAneCcsIDEsIDVqLCAyaiwgZnJvemVuc2V0KCldKQogICAgICAgICMgY29tcGFyaW5nIGRpY3RzCiAgICAgICAgc2VsZi5hc3NlcnRDb3VudEVxdWFsKFt7J2EnOiAxfSwgeydiJzogMn1dLCBbeydiJzogMn0sIHsnYSc6IDF9XSkKICAgICAgICAjIGNvbXBhcmluZyBoZXRlcm9nZW5vdXMgbm9uLWhhc2hhYmxlIHNlcXVlbmNlcwogICAgICAgIHNlbGYuYXNzZXJ0Q291bnRFcXVhbChbMSwgJ3gnLCBkaXZtb2QsIFtdXSwgW2Rpdm1vZCwgW10sICd4JywgMV0pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydENvdW50RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgW10sIFtkaXZtb2QsIFtdLCAneCcsIDEsIDVqLCAyaiwgc2V0KCldKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRDb3VudEVxdWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgIFtbMV1dLCBbWzJdXSkKCiAgICAgICAgIyBTYW1lIGVsZW1lbnRzLCBidXQgbm90IHNhbWUgc2VxdWVuY2UgbGVuZ3RoCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydENvdW50RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgWzEsIDEsIDJdLCBbMiwgMV0pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydENvdW50RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgWzEsIDEsICIyIiwgImEiLCAiYSJdLCBbIjIiLCAiMiIsIFRydWUsICJhIl0pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydENvdW50RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgWzEsIHsnYic6IDJ9LCBOb25lLCBUcnVlXSwgW3snYic6IDJ9LCBUcnVlLCBOb25lXSkKCiAgICAgICAgIyBTYW1lIGVsZW1lbnRzIHdoaWNoIGRvbid0IHJlbGlhYmx5IGNvbXBhcmUsIGluCiAgICAgICAgIyBkaWZmZXJlbnQgb3JkZXIsIHNlZSBpc3N1ZSAxMDI0MgogICAgICAgIGEgPSBbezIsNH0sIHsxLDJ9XQogICAgICAgIGIgPSBhWzo6LTFdCiAgICAgICAgc2VsZi5hc3NlcnRDb3VudEVxdWFsKGEsIGIpCgogICAgICAgICMgdGVzdCB1dGlsaXR5IGZ1bmN0aW9ucyBzdXBwb3J0aW5nIGFzc2VydENvdW50RXF1YWwoKQoKICAgICAgICBkaWZmcyA9IHNldCh1bml0dGVzdC51dGlsLl9jb3VudF9kaWZmX2FsbF9wdXJwb3NlKCdhYWFiY2NkJywgJ2FiYmJjY2UnKSkKICAgICAgICBleHBlY3RlZCA9IHsoMywxLCdhJyksICgxLDMsJ2InKSwgKDEsMCwnZCcpLCAoMCwxLCdlJyl9CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChkaWZmcywgZXhwZWN0ZWQpCgogICAgICAgIGRpZmZzID0gdW5pdHRlc3QudXRpbC5fY291bnRfZGlmZl9hbGxfcHVycG9zZShbW11dLCBbXSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGRpZmZzLCBbKDEsIDAsIFtdKV0pCgogICAgICAgIGRpZmZzID0gc2V0KHVuaXR0ZXN0LnV0aWwuX2NvdW50X2RpZmZfaGFzaGFibGUoJ2FhYWJjY2QnLCAnYWJiYmNjZScpKQogICAgICAgIGV4cGVjdGVkID0geygzLDEsJ2EnKSwgKDEsMywnYicpLCAoMSwwLCdkJyksICgwLDEsJ2UnKX0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGRpZmZzLCBleHBlY3RlZCkKCiAgICBkZWYgdGVzdEFzc2VydFNldEVxdWFsKHNlbGYpOgogICAgICAgIHNldDEgPSBzZXQoKQogICAgICAgIHNldDIgPSBzZXQoKQogICAgICAgIHNlbGYuYXNzZXJ0U2V0RXF1YWwoc2V0MSwgc2V0MikKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydFNldEVxdWFsLCBOb25lLCBzZXQyKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRTZXRFcXVhbCwgW10sIHNldDIpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydFNldEVxdWFsLCBzZXQxLCBOb25lKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRTZXRFcXVhbCwgc2V0MSwgW10pCgogICAgICAgIHNldDEgPSBzZXQoWydhJ10pCiAgICAgICAgc2V0MiA9IHNldCgpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydFNldEVxdWFsLCBzZXQxLCBzZXQyKQoKICAgICAgICBzZXQxID0gc2V0KFsnYSddKQogICAgICAgIHNldDIgPSBzZXQoWydhJ10pCiAgICAgICAgc2VsZi5hc3NlcnRTZXRFcXVhbChzZXQxLCBzZXQyKQoKICAgICAgICBzZXQxID0gc2V0KFsnYSddKQogICAgICAgIHNldDIgPSBzZXQoWydhJywgJ2InXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0U2V0RXF1YWwsIHNldDEsIHNldDIpCgogICAgICAgIHNldDEgPSBzZXQoWydhJ10pCiAgICAgICAgc2V0MiA9IGZyb3plbnNldChbJ2EnLCAnYiddKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRTZXRFcXVhbCwgc2V0MSwgc2V0MikKCiAgICAgICAgc2V0MSA9IHNldChbJ2EnLCAnYiddKQogICAgICAgIHNldDIgPSBmcm96ZW5zZXQoWydhJywgJ2InXSkKICAgICAgICBzZWxmLmFzc2VydFNldEVxdWFsKHNldDEsIHNldDIpCgogICAgICAgIHNldDEgPSBzZXQoKQogICAgICAgIHNldDIgPSAiZm9vIgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRTZXRFcXVhbCwgc2V0MSwgc2V0MikKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0U2V0RXF1YWwsIHNldDIsIHNldDEpCgogICAgICAgICMgbWFrZSBzdXJlIGFueSBzdHJpbmcgZm9ybWF0dGluZyBpcyB0dXBsZS1zYWZlCiAgICAgICAgc2V0MSA9IHNldChbKDAsIDEpLCAoMiwgMyldKQogICAgICAgIHNldDIgPSBzZXQoWyg0LCA1KV0pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydFNldEVxdWFsLCBzZXQxLCBzZXQyKQoKICAgIGRlZiB0ZXN0SW5lcXVhbGl0eShzZWxmKToKICAgICAgICAjIFRyeSBpbnRzCiAgICAgICAgc2VsZi5hc3NlcnRHcmVhdGVyKDIsIDEpCiAgICAgICAgc2VsZi5hc3NlcnRHcmVhdGVyRXF1YWwoMiwgMSkKICAgICAgICBzZWxmLmFzc2VydEdyZWF0ZXJFcXVhbCgxLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0TGVzcygxLCAyKQogICAgICAgIHNlbGYuYXNzZXJ0TGVzc0VxdWFsKDEsIDIpCiAgICAgICAgc2VsZi5hc3NlcnRMZXNzRXF1YWwoMSwgMSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0R3JlYXRlciwgMSwgMikKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0R3JlYXRlciwgMSwgMSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0R3JlYXRlckVxdWFsLCAxLCAyKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRMZXNzLCAyLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRMZXNzLCAxLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRMZXNzRXF1YWwsIDIsIDEpCgogICAgICAgICMgVHJ5IEZsb2F0cwogICAgICAgIHNlbGYuYXNzZXJ0R3JlYXRlcigxLjEsIDEuMCkKICAgICAgICBzZWxmLmFzc2VydEdyZWF0ZXJFcXVhbCgxLjEsIDEuMCkKICAgICAgICBzZWxmLmFzc2VydEdyZWF0ZXJFcXVhbCgxLjAsIDEuMCkKICAgICAgICBzZWxmLmFzc2VydExlc3MoMS4wLCAxLjEpCiAgICAgICAgc2VsZi5hc3NlcnRMZXNzRXF1YWwoMS4wLCAxLjEpCiAgICAgICAgc2VsZi5hc3NlcnRMZXNzRXF1YWwoMS4wLCAxLjApCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydEdyZWF0ZXIsIDEuMCwgMS4xKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRHcmVhdGVyLCAxLjAsIDEuMCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0R3JlYXRlckVxdWFsLCAxLjAsIDEuMSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0TGVzcywgMS4xLCAxLjApCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydExlc3MsIDEuMCwgMS4wKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRMZXNzRXF1YWwsIDEuMSwgMS4wKQoKICAgICAgICAjIFRyeSBTdHJpbmdzCiAgICAgICAgc2VsZi5hc3NlcnRHcmVhdGVyKCdidWcnLCAnYW50JykKICAgICAgICBzZWxmLmFzc2VydEdyZWF0ZXJFcXVhbCgnYnVnJywgJ2FudCcpCiAgICAgICAgc2VsZi5hc3NlcnRHcmVhdGVyRXF1YWwoJ2FudCcsICdhbnQnKQogICAgICAgIHNlbGYuYXNzZXJ0TGVzcygnYW50JywgJ2J1ZycpCiAgICAgICAgc2VsZi5hc3NlcnRMZXNzRXF1YWwoJ2FudCcsICdidWcnKQogICAgICAgIHNlbGYuYXNzZXJ0TGVzc0VxdWFsKCdhbnQnLCAnYW50JykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0R3JlYXRlciwgJ2FudCcsICdidWcnKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRHcmVhdGVyLCAnYW50JywgJ2FudCcpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydEdyZWF0ZXJFcXVhbCwgJ2FudCcsICdidWcnKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRMZXNzLCAnYnVnJywgJ2FudCcpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydExlc3MsICdhbnQnLCAnYW50JykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0TGVzc0VxdWFsLCAnYnVnJywgJ2FudCcpCgogICAgICAgICMgVHJ5IGJ5dGVzCiAgICAgICAgc2VsZi5hc3NlcnRHcmVhdGVyKGInYnVnJywgYidhbnQnKQogICAgICAgIHNlbGYuYXNzZXJ0R3JlYXRlckVxdWFsKGInYnVnJywgYidhbnQnKQogICAgICAgIHNlbGYuYXNzZXJ0R3JlYXRlckVxdWFsKGInYW50JywgYidhbnQnKQogICAgICAgIHNlbGYuYXNzZXJ0TGVzcyhiJ2FudCcsIGInYnVnJykKICAgICAgICBzZWxmLmFzc2VydExlc3NFcXVhbChiJ2FudCcsIGInYnVnJykKICAgICAgICBzZWxmLmFzc2VydExlc3NFcXVhbChiJ2FudCcsIGInYW50JykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0R3JlYXRlciwgYidhbnQnLCBiJ2J1ZycpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydEdyZWF0ZXIsIGInYW50JywgYidhbnQnKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRHcmVhdGVyRXF1YWwsIGInYW50JywKICAgICAgICAgICAgICAgICAgICAgICAgICBiJ2J1ZycpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydExlc3MsIGInYnVnJywgYidhbnQnKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRMZXNzLCBiJ2FudCcsIGInYW50JykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0TGVzc0VxdWFsLCBiJ2J1ZycsIGInYW50JykKCiAgICBkZWYgdGVzdEFzc2VydE11bHRpTGluZUVxdWFsKHNlbGYpOgogICAgICAgIHNhbXBsZV90ZXh0ID0gIiIiXApodHRwOi8vd3d3LnB5dGhvbi5vcmcvZG9jLzIuMy9saWIvbW9kdWxlLXVuaXR0ZXN0Lmh0bWwKdGVzdCBjYXNlCiAgICBBIHRlc3QgY2FzZSBpcyB0aGUgc21hbGxlc3QgdW5pdCBvZiB0ZXN0aW5nLiBbLi4uXQoiIiIKICAgICAgICByZXZpc2VkX3NhbXBsZV90ZXh0ID0gIiIiXApodHRwOi8vd3d3LnB5dGhvbi5vcmcvZG9jLzIuNC4xL2xpYi9tb2R1bGUtdW5pdHRlc3QuaHRtbAp0ZXN0IGNhc2UKICAgIEEgdGVzdCBjYXNlIGlzIHRoZSBzbWFsbGVzdCB1bml0IG9mIHRlc3RpbmcuIFsuLi5dIFlvdSBtYXkgcHJvdmlkZSB5b3VyCiAgICBvd24gaW1wbGVtZW50YXRpb24gdGhhdCBkb2VzIG5vdCBzdWJjbGFzcyBmcm9tIFRlc3RDYXNlLCBvZiBjb3Vyc2UuCiIiIgogICAgICAgIHNhbXBsZV90ZXh0X2Vycm9yID0gIiIiXAotIGh0dHA6Ly93d3cucHl0aG9uLm9yZy9kb2MvMi4zL2xpYi9tb2R1bGUtdW5pdHRlc3QuaHRtbAo/ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBeCisgaHR0cDovL3d3dy5weXRob24ub3JnL2RvYy8yLjQuMS9saWIvbW9kdWxlLXVuaXR0ZXN0Lmh0bWwKPyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXl5eCiAgdGVzdCBjYXNlCi0gICAgIEEgdGVzdCBjYXNlIGlzIHRoZSBzbWFsbGVzdCB1bml0IG9mIHRlc3RpbmcuIFsuLi5dCisgICAgIEEgdGVzdCBjYXNlIGlzIHRoZSBzbWFsbGVzdCB1bml0IG9mIHRlc3RpbmcuIFsuLi5dIFlvdSBtYXkgcHJvdmlkZSB5b3VyCj8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKysrKysrKysrKysrKysrKysrKysrCisgICAgIG93biBpbXBsZW1lbnRhdGlvbiB0aGF0IGRvZXMgbm90IHN1YmNsYXNzIGZyb20gVGVzdENhc2UsIG9mIGNvdXJzZS4KIiIiCiAgICAgICAgc2VsZi5tYXhEaWZmID0gTm9uZQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRNdWx0aUxpbmVFcXVhbChzYW1wbGVfdGV4dCwgcmV2aXNlZF9zYW1wbGVfdGV4dCkKICAgICAgICBleGNlcHQgc2VsZi5mYWlsdXJlRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICMgbmVlZCB0byByZW1vdmUgdGhlIGZpcnN0IGxpbmUgb2YgdGhlIGVycm9yIG1lc3NhZ2UKICAgICAgICAgICAgZXJyb3IgPSBzdHIoZSkuc3BsaXQoJ1xuJywgMSlbMV0KCiAgICAgICAgICAgICMgbm8gZmFpciB0ZXN0aW5nIG91cnNlbGYgd2l0aCBvdXJzZWxmLCBhbmQgYXNzZXJ0RXF1YWwgaXMgdXNlZCBmb3Igc3RyaW5ncwogICAgICAgICAgICAjIHNvIGNhbid0IHVzZSBhc3NlcnRFcXVhbCBlaXRoZXIuIEp1c3QgdXNlIGFzc2VydFRydWUuCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShzYW1wbGVfdGV4dF9lcnJvciA9PSBlcnJvcikKCiAgICBkZWYgdGVzdEFzZXJ0RXF1YWxTaW5nbGVMaW5lKHNlbGYpOgogICAgICAgIHNhbXBsZV90ZXh0ID0gImxhZGVuIHN3YWxsb3dzIGZseSBzbG93bHkiCiAgICAgICAgcmV2aXNlZF9zYW1wbGVfdGV4dCA9ICJ1bmxhZGVuIHN3YWxsb3dzIGZseSBxdWlja2x5IgogICAgICAgIHNhbXBsZV90ZXh0X2Vycm9yID0gIiIiXAotIGxhZGVuIHN3YWxsb3dzIGZseSBzbG93bHkKPyAgICAgICAgICAgICAgICAgICAgXl5eXgorIHVubGFkZW4gc3dhbGxvd3MgZmx5IHF1aWNrbHkKPyArKyAgICAgICAgICAgICAgICAgICBeXl5eXgoiIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc2FtcGxlX3RleHQsIHJldmlzZWRfc2FtcGxlX3RleHQpCiAgICAgICAgZXhjZXB0IHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBlcnJvciA9IHN0cihlKS5zcGxpdCgnXG4nLCAxKVsxXQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoc2FtcGxlX3RleHRfZXJyb3IgPT0gZXJyb3IpCgogICAgZGVmIHRlc3RBc3NlcnRJc05vbmUoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRJc05vbmUoTm9uZSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0SXNOb25lLCBGYWxzZSkKICAgICAgICBzZWxmLmFzc2VydElzTm90Tm9uZSgnRGpab1Bsb0dlYXJzIG9uIFJhaWxzJykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0SXNOb3ROb25lLCBOb25lKQoKICAgIGRlZiB0ZXN0QXNzZXJ0UmVnZXgoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRSZWdleCgnYXNkZmFiYXNkZicsIHInYWIrJykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0UmVnZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NhYWFzJywgcidhYWFhJykKCiAgICBkZWYgdGVzdEFzc2VydFJhaXNlc1JlZ2V4KHNlbGYpOgogICAgICAgIGNsYXNzIEV4Y2VwdGlvbk1vY2soRXhjZXB0aW9uKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBkZWYgU3R1YigpOgogICAgICAgICAgICByYWlzZSBFeGNlcHRpb25Nb2NrKCdXZSBleHBlY3QnKQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1JlZ2V4KEV4Y2VwdGlvbk1vY2ssIHJlLmNvbXBpbGUoJ2V4cGVjdCQnKSwgU3R1YikKICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1JlZ2V4KEV4Y2VwdGlvbk1vY2ssICdleHBlY3QkJywgU3R1YikKCiAgICBkZWYgdGVzdEFzc2VydE5vdFJhaXNlc1JlZ2V4KHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzUmVnZXgoCiAgICAgICAgICAgICAgICBzZWxmLmZhaWx1cmVFeGNlcHRpb24sICdeRXhjZXB0aW9uIG5vdCByYWlzZWQgYnkgPGxhbWJkYT4kJywKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzUmVnZXgsIEV4Y2VwdGlvbiwgcmUuY29tcGlsZSgneCcpLAogICAgICAgICAgICAgICAgbGFtYmRhOiBOb25lKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzUmVnZXgoCiAgICAgICAgICAgICAgICBzZWxmLmZhaWx1cmVFeGNlcHRpb24sICdeRXhjZXB0aW9uIG5vdCByYWlzZWQgYnkgPGxhbWJkYT4kJywKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzUmVnZXgsIEV4Y2VwdGlvbiwgJ3gnLAogICAgICAgICAgICAgICAgbGFtYmRhOiBOb25lKQoKICAgIGRlZiB0ZXN0QXNzZXJ0UmFpc2VzUmVnZXhNaXNtYXRjaChzZWxmKToKICAgICAgICBkZWYgU3R1YigpOgogICAgICAgICAgICByYWlzZSBFeGNlcHRpb24oJ1VuZXhwZWN0ZWQnKQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1JlZ2V4KAogICAgICAgICAgICAgICAgc2VsZi5mYWlsdXJlRXhjZXB0aW9uLAogICAgICAgICAgICAgICAgciciXF5FeHBlY3RlZFwkIiBkb2VzIG5vdCBtYXRjaCAiVW5leHBlY3RlZCInLAogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXNSZWdleCwgRXhjZXB0aW9uLCAnXkV4cGVjdGVkJCcsCiAgICAgICAgICAgICAgICBTdHViKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzUmVnZXgoCiAgICAgICAgICAgICAgICBzZWxmLmZhaWx1cmVFeGNlcHRpb24sCiAgICAgICAgICAgICAgICByJyJcXkV4cGVjdGVkXCQiIGRvZXMgbm90IG1hdGNoICJVbmV4cGVjdGVkIicsCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1JlZ2V4LCBFeGNlcHRpb24sCiAgICAgICAgICAgICAgICByZS5jb21waWxlKCdeRXhwZWN0ZWQkJyksIFN0dWIpCgogICAgZGVmIHRlc3RBc3NlcnRSYWlzZXNFeGNWYWx1ZShzZWxmKToKICAgICAgICBjbGFzcyBFeGNlcHRpb25Nb2NrKEV4Y2VwdGlvbik6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgZGVmIFN0dWIoZm9vKToKICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uTW9jayhmb28pCiAgICAgICAgdiA9ICJwYXJ0aWN1bGFyIHZhbHVlIgoKICAgICAgICBjdHggPSBzZWxmLmFzc2VydFJhaXNlcyhFeGNlcHRpb25Nb2NrKQogICAgICAgIHdpdGggY3R4OgogICAgICAgICAgICBTdHViKHYpCiAgICAgICAgZSA9IGN0eC5leGNlcHRpb24KICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UoZSwgRXhjZXB0aW9uTW9jaykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGUuYXJnc1swXSwgdikKCiAgICBkZWYgdGVzdEFzc2VydFdhcm5zQ2FsbGFibGUoc2VsZik6CiAgICAgICAgZGVmIF9ydW50aW1lX3dhcm4oKToKICAgICAgICAgICAgd2FybmluZ3Mud2FybigiZm9vIiwgUnVudGltZVdhcm5pbmcpCiAgICAgICAgIyBTdWNjZXNzIHdoZW4gdGhlIHJpZ2h0IHdhcm5pbmcgaXMgdHJpZ2dlcmVkLCBldmVuIHNldmVyYWwgdGltZXMKICAgICAgICBzZWxmLmFzc2VydFdhcm5zKFJ1bnRpbWVXYXJuaW5nLCBfcnVudGltZV93YXJuKQogICAgICAgIHNlbGYuYXNzZXJ0V2FybnMoUnVudGltZVdhcm5pbmcsIF9ydW50aW1lX3dhcm4pCiAgICAgICAgIyBBIHR1cGxlIG9mIHdhcm5pbmcgY2xhc3NlcyBpcyBhY2NlcHRlZAogICAgICAgIHNlbGYuYXNzZXJ0V2FybnMoKERlcHJlY2F0aW9uV2FybmluZywgUnVudGltZVdhcm5pbmcpLCBfcnVudGltZV93YXJuKQogICAgICAgICMgKmFyZ3MgYW5kICoqa3dhcmdzIGFsc28gd29yawogICAgICAgIHNlbGYuYXNzZXJ0V2FybnMoUnVudGltZVdhcm5pbmcsCiAgICAgICAgICAgICAgICAgICAgICAgICB3YXJuaW5ncy53YXJuLCAiZm9vIiwgY2F0ZWdvcnk9UnVudGltZVdhcm5pbmcpCiAgICAgICAgIyBGYWlsdXJlIHdoZW4gbm8gd2FybmluZyBpcyB0cmlnZ2VyZWQKICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbik6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0V2FybnMoUnVudGltZVdhcm5pbmcsIGxhbWJkYTogMCkKICAgICAgICAjIEZhaWx1cmUgd2hlbiBhbm90aGVyIHdhcm5pbmcgaXMgdHJpZ2dlcmVkCiAgICAgICAgd2l0aCB3YXJuaW5ncy5jYXRjaF93YXJuaW5ncygpOgogICAgICAgICAgICAjIEZvcmNlIGRlZmF1bHQgZmlsdGVyIChpbiBjYXNlIHRlc3RzIGFyZSBydW4gd2l0aCAtV2UpCiAgICAgICAgICAgIHdhcm5pbmdzLnNpbXBsZWZpbHRlcigiZGVmYXVsdCIsIFJ1bnRpbWVXYXJuaW5nKQogICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbik6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFdhcm5zKERlcHJlY2F0aW9uV2FybmluZywgX3J1bnRpbWVfd2FybikKICAgICAgICAjIEZpbHRlcnMgZm9yIG90aGVyIHdhcm5pbmdzIGFyZSBub3QgbW9kaWZpZWQKICAgICAgICB3aXRoIHdhcm5pbmdzLmNhdGNoX3dhcm5pbmdzKCk6CiAgICAgICAgICAgIHdhcm5pbmdzLnNpbXBsZWZpbHRlcigiZXJyb3IiLCBSdW50aW1lV2FybmluZykKICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhSdW50aW1lV2FybmluZyk6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFdhcm5zKERlcHJlY2F0aW9uV2FybmluZywgX3J1bnRpbWVfd2FybikKCiAgICBkZWYgdGVzdEFzc2VydFdhcm5zQ29udGV4dChzZWxmKToKICAgICAgICAjIEJlbGlldmUgaXQgb3Igbm90LCBpdCBpcyBwcmVmZXJyYWJsZSB0byBkdXBsaWNhdGUgYWxsIHRlc3RzIGFib3ZlLAogICAgICAgICMgdG8gbWFrZSBzdXJlIHRoZSBfX3dhcm5pbmdyZWdpc3RyeV9fICRAIGlzIGNpcmN1bXZlbnRlZCBjb3JyZWN0bHkuCiAgICAgICAgZGVmIF9ydW50aW1lX3dhcm4oKToKICAgICAgICAgICAgd2FybmluZ3Mud2FybigiZm9vIiwgUnVudGltZVdhcm5pbmcpCiAgICAgICAgX3J1bnRpbWVfd2Fybl9saW5lbm8gPSBpbnNwZWN0LmdldHNvdXJjZWxpbmVzKF9ydW50aW1lX3dhcm4pWzFdCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFdhcm5zKFJ1bnRpbWVXYXJuaW5nKSBhcyBjbToKICAgICAgICAgICAgX3J1bnRpbWVfd2FybigpCiAgICAgICAgIyBBIHR1cGxlIG9mIHdhcm5pbmcgY2xhc3NlcyBpcyBhY2NlcHRlZAogICAgICAgIHdpdGggc2VsZi5hc3NlcnRXYXJucygoRGVwcmVjYXRpb25XYXJuaW5nLCBSdW50aW1lV2FybmluZykpIGFzIGNtOgogICAgICAgICAgICBfcnVudGltZV93YXJuKCkKICAgICAgICAjIFRoZSBjb250ZXh0IG1hbmFnZXIgZXhwb3NlcyB2YXJpb3VzIHVzZWZ1bCBhdHRyaWJ1dGVzCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGNtLndhcm5pbmcsIFJ1bnRpbWVXYXJuaW5nKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoY20ud2FybmluZy5hcmdzWzBdLCAiZm9vIikKICAgICAgICBzZWxmLmFzc2VydEluKCJ0ZXN0X2Nhc2UucHkiLCBjbS5maWxlbmFtZSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNtLmxpbmVubywgX3J1bnRpbWVfd2Fybl9saW5lbm8gKyAxKQogICAgICAgICMgU2FtZSB3aXRoIHNldmVyYWwgd2FybmluZ3MKICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0V2FybnMoUnVudGltZVdhcm5pbmcpOgogICAgICAgICAgICBfcnVudGltZV93YXJuKCkKICAgICAgICAgICAgX3J1bnRpbWVfd2FybigpCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFdhcm5zKFJ1bnRpbWVXYXJuaW5nKToKICAgICAgICAgICAgd2FybmluZ3Mud2FybigiZm9vIiwgY2F0ZWdvcnk9UnVudGltZVdhcm5pbmcpCiAgICAgICAgIyBGYWlsdXJlIHdoZW4gbm8gd2FybmluZyBpcyB0cmlnZ2VyZWQKICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbik6CiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRXYXJucyhSdW50aW1lV2FybmluZyk6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgIyBGYWlsdXJlIHdoZW4gYW5vdGhlciB3YXJuaW5nIGlzIHRyaWdnZXJlZAogICAgICAgIHdpdGggd2FybmluZ3MuY2F0Y2hfd2FybmluZ3MoKToKICAgICAgICAgICAgIyBGb3JjZSBkZWZhdWx0IGZpbHRlciAoaW4gY2FzZSB0ZXN0cyBhcmUgcnVuIHdpdGggLVdlKQogICAgICAgICAgICB3YXJuaW5ncy5zaW1wbGVmaWx0ZXIoImRlZmF1bHQiLCBSdW50aW1lV2FybmluZykKICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24pOgogICAgICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFdhcm5zKERlcHJlY2F0aW9uV2FybmluZyk6CiAgICAgICAgICAgICAgICAgICAgX3J1bnRpbWVfd2FybigpCiAgICAgICAgIyBGaWx0ZXJzIGZvciBvdGhlciB3YXJuaW5ncyBhcmUgbm90IG1vZGlmaWVkCiAgICAgICAgd2l0aCB3YXJuaW5ncy5jYXRjaF93YXJuaW5ncygpOgogICAgICAgICAgICB3YXJuaW5ncy5zaW1wbGVmaWx0ZXIoImVycm9yIiwgUnVudGltZVdhcm5pbmcpCiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoUnVudGltZVdhcm5pbmcpOgogICAgICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFdhcm5zKERlcHJlY2F0aW9uV2FybmluZyk6CiAgICAgICAgICAgICAgICAgICAgX3J1bnRpbWVfd2FybigpCgogICAgZGVmIHRlc3RBc3NlcnRXYXJuc1JlZ2V4Q2FsbGFibGUoc2VsZik6CiAgICAgICAgZGVmIF9ydW50aW1lX3dhcm4obXNnKToKICAgICAgICAgICAgd2FybmluZ3Mud2Fybihtc2csIFJ1bnRpbWVXYXJuaW5nKQogICAgICAgIHNlbGYuYXNzZXJ0V2FybnNSZWdleChSdW50aW1lV2FybmluZywgIm8rIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3J1bnRpbWVfd2FybiwgImZvb3giKQogICAgICAgICMgRmFpbHVyZSB3aGVuIG5vIHdhcm5pbmcgaXMgdHJpZ2dlcmVkCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24pOgogICAgICAgICAgICBzZWxmLmFzc2VydFdhcm5zUmVnZXgoUnVudGltZVdhcm5pbmcsICJvKyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYW1iZGE6IDApCiAgICAgICAgIyBGYWlsdXJlIHdoZW4gYW5vdGhlciB3YXJuaW5nIGlzIHRyaWdnZXJlZAogICAgICAgIHdpdGggd2FybmluZ3MuY2F0Y2hfd2FybmluZ3MoKToKICAgICAgICAgICAgIyBGb3JjZSBkZWZhdWx0IGZpbHRlciAoaW4gY2FzZSB0ZXN0cyBhcmUgcnVuIHdpdGggLVdlKQogICAgICAgICAgICB3YXJuaW5ncy5zaW1wbGVmaWx0ZXIoImRlZmF1bHQiLCBSdW50aW1lV2FybmluZykKICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24pOgogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRXYXJuc1JlZ2V4KERlcHJlY2F0aW9uV2FybmluZywgIm8rIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcnVudGltZV93YXJuLCAiZm9veCIpCiAgICAgICAgIyBGYWlsdXJlIHdoZW4gbWVzc2FnZSBkb2Vzbid0IG1hdGNoCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24pOgogICAgICAgICAgICBzZWxmLmFzc2VydFdhcm5zUmVnZXgoUnVudGltZVdhcm5pbmcsICJvKyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcnVudGltZV93YXJuLCAiYmFyeiIpCiAgICAgICAgIyBBIGxpdHRsZSB0cmlja2llcjogd2UgYXNrIFJ1bnRpbWVXYXJuaW5ncyB0byBiZSByYWlzZWQsIGFuZCB0aGVuCiAgICAgICAgIyBjaGVjayBmb3Igc29tZSBvZiB0aGVtLiAgSXQgaXMgaW1wbGVtZW50YXRpb24tZGVmaW5lZCB3aGV0aGVyCiAgICAgICAgIyBub24tbWF0Y2hpbmcgUnVudGltZVdhcm5pbmdzIGFyZSBzaW1wbHkgcmUtcmFpc2VkLCBvciBwcm9kdWNlIGEKICAgICAgICAjIGZhaWx1cmVFeGNlcHRpb24uCiAgICAgICAgd2l0aCB3YXJuaW5ncy5jYXRjaF93YXJuaW5ncygpOgogICAgICAgICAgICB3YXJuaW5ncy5zaW1wbGVmaWx0ZXIoImVycm9yIiwgUnVudGltZVdhcm5pbmcpCiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoKFJ1bnRpbWVXYXJuaW5nLCBzZWxmLmZhaWx1cmVFeGNlcHRpb24pKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0V2FybnNSZWdleChSdW50aW1lV2FybmluZywgIm8rIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcnVudGltZV93YXJuLCAiYmFyeiIpCgogICAgZGVmIHRlc3RBc3NlcnRXYXJuc1JlZ2V4Q29udGV4dChzZWxmKToKICAgICAgICAjIFNhbWUgYXMgYWJvdmUsIGJ1dCB3aXRoIGFzc2VydFdhcm5zUmVnZXggYXMgYSBjb250ZXh0IG1hbmFnZXIKICAgICAgICBkZWYgX3J1bnRpbWVfd2Fybihtc2cpOgogICAgICAgICAgICB3YXJuaW5ncy53YXJuKG1zZywgUnVudGltZVdhcm5pbmcpCiAgICAgICAgX3J1bnRpbWVfd2Fybl9saW5lbm8gPSBpbnNwZWN0LmdldHNvdXJjZWxpbmVzKF9ydW50aW1lX3dhcm4pWzFdCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFdhcm5zUmVnZXgoUnVudGltZVdhcm5pbmcsICJvKyIpIGFzIGNtOgogICAgICAgICAgICBfcnVudGltZV93YXJuKCJmb294IikKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UoY20ud2FybmluZywgUnVudGltZVdhcm5pbmcpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChjbS53YXJuaW5nLmFyZ3NbMF0sICJmb294IikKICAgICAgICBzZWxmLmFzc2VydEluKCJ0ZXN0X2Nhc2UucHkiLCBjbS5maWxlbmFtZSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNtLmxpbmVubywgX3J1bnRpbWVfd2Fybl9saW5lbm8gKyAxKQogICAgICAgICMgRmFpbHVyZSB3aGVuIG5vIHdhcm5pbmcgaXMgdHJpZ2dlcmVkCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24pOgogICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0V2FybnNSZWdleChSdW50aW1lV2FybmluZywgIm8rIik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgIyBGYWlsdXJlIHdoZW4gYW5vdGhlciB3YXJuaW5nIGlzIHRyaWdnZXJlZAogICAgICAgIHdpdGggd2FybmluZ3MuY2F0Y2hfd2FybmluZ3MoKToKICAgICAgICAgICAgIyBGb3JjZSBkZWZhdWx0IGZpbHRlciAoaW4gY2FzZSB0ZXN0cyBhcmUgcnVuIHdpdGggLVdlKQogICAgICAgICAgICB3YXJuaW5ncy5zaW1wbGVmaWx0ZXIoImRlZmF1bHQiLCBSdW50aW1lV2FybmluZykKICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24pOgogICAgICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFdhcm5zUmVnZXgoRGVwcmVjYXRpb25XYXJuaW5nLCAibysiKToKICAgICAgICAgICAgICAgICAgICBfcnVudGltZV93YXJuKCJmb294IikKICAgICAgICAjIEZhaWx1cmUgd2hlbiBtZXNzYWdlIGRvZXNuJ3QgbWF0Y2gKICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbik6CiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRXYXJuc1JlZ2V4KFJ1bnRpbWVXYXJuaW5nLCAibysiKToKICAgICAgICAgICAgICAgIF9ydW50aW1lX3dhcm4oImJhcnoiKQogICAgICAgICMgQSBsaXR0bGUgdHJpY2tpZXI6IHdlIGFzayBSdW50aW1lV2FybmluZ3MgdG8gYmUgcmFpc2VkLCBhbmQgdGhlbgogICAgICAgICMgY2hlY2sgZm9yIHNvbWUgb2YgdGhlbS4gIEl0IGlzIGltcGxlbWVudGF0aW9uLWRlZmluZWQgd2hldGhlcgogICAgICAgICMgbm9uLW1hdGNoaW5nIFJ1bnRpbWVXYXJuaW5ncyBhcmUgc2ltcGx5IHJlLXJhaXNlZCwgb3IgcHJvZHVjZSBhCiAgICAgICAgIyBmYWlsdXJlRXhjZXB0aW9uLgogICAgICAgIHdpdGggd2FybmluZ3MuY2F0Y2hfd2FybmluZ3MoKToKICAgICAgICAgICAgd2FybmluZ3Muc2ltcGxlZmlsdGVyKCJlcnJvciIsIFJ1bnRpbWVXYXJuaW5nKQogICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKChSdW50aW1lV2FybmluZywgc2VsZi5mYWlsdXJlRXhjZXB0aW9uKSk6CiAgICAgICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0V2FybnNSZWdleChSdW50aW1lV2FybmluZywgIm8rIik6CiAgICAgICAgICAgICAgICAgICAgX3J1bnRpbWVfd2FybigiYmFyeiIpCgogICAgZGVmIHRlc3REZXByZWNhdGVkTWV0aG9kTmFtZXMoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgVGVzdCB0aGF0IHRoZSBkZXByZWNhdGVkIG1ldGhvZHMgcmFpc2UgYSBEZXByZWNhdGlvbldhcm5pbmcuIFNlZSAjOTQyNC4KICAgICAgICAiIiIKICAgICAgICBvbGQgPSAoCiAgICAgICAgICAgIChzZWxmLmZhaWxJZkVxdWFsLCAoMywgNSkpLAogICAgICAgICAgICAoc2VsZi5hc3NlcnROb3RFcXVhbHMsICgzLCA1KSksCiAgICAgICAgICAgIChzZWxmLmZhaWxVbmxlc3NFcXVhbCwgKDMsIDMpKSwKICAgICAgICAgICAgKHNlbGYuYXNzZXJ0RXF1YWxzLCAoMywgMykpLAogICAgICAgICAgICAoc2VsZi5mYWlsVW5sZXNzQWxtb3N0RXF1YWwsICgyLjAsIDIuMCkpLAogICAgICAgICAgICAoc2VsZi5hc3NlcnRBbG1vc3RFcXVhbHMsICgyLjAsIDIuMCkpLAogICAgICAgICAgICAoc2VsZi5mYWlsSWZBbG1vc3RFcXVhbCwgKDMuMCwgNS4wKSksCiAgICAgICAgICAgIChzZWxmLmFzc2VydE5vdEFsbW9zdEVxdWFscywgKDMuMCwgNS4wKSksCiAgICAgICAgICAgIChzZWxmLmZhaWxVbmxlc3MsIChUcnVlLCkpLAogICAgICAgICAgICAoc2VsZi5hc3NlcnRfLCAoVHJ1ZSwpKSwKICAgICAgICAgICAgKHNlbGYuZmFpbFVubGVzc1JhaXNlcywgKFR5cGVFcnJvciwgbGFtYmRhIF86IDMuMTQgKyAnc3BhbScpKSwKICAgICAgICAgICAgKHNlbGYuZmFpbElmLCAoRmFsc2UsKSksCiAgICAgICAgICAgIChzZWxmLmFzc2VydERpY3RDb250YWluc1N1YnNldCwgKGRpY3QoYT0xLCBiPTIpLCBkaWN0KGE9MSwgYj0yLCBjPTMpKSksCiAgICAgICAgICAgIChzZWxmLmFzc2VydFJhaXNlc1JlZ2V4cCwgKEtleUVycm9yLCAnZm9vJywgbGFtYmRhOiB7fVsnZm9vJ10pKSwKICAgICAgICAgICAgKHNlbGYuYXNzZXJ0UmVnZXhwTWF0Y2hlcywgKCdiYXInLCAnYmFyJykpLAogICAgICAgICkKICAgICAgICBmb3IgbWV0aCwgYXJncyBpbiBvbGQ6CiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRXYXJucyhEZXByZWNhdGlvbldhcm5pbmcpOgogICAgICAgICAgICAgICAgbWV0aCgqYXJncykKCiAgICAjIGRpc2FibGUgdGhpcyB0ZXN0IGZvciBub3cuIFdoZW4gdGhlIHZlcnNpb24gd2hlcmUgdGhlIGZhaWwqIG1ldGhvZHMgd2lsbAogICAgIyBiZSByZW1vdmVkIGlzIGRlY2lkZWQsIHJlLWVuYWJsZSBpdCBhbmQgdXBkYXRlIHRoZSB2ZXJzaW9uCiAgICBkZWYgX3Rlc3REZXByZWNhdGVkRmFpbE1ldGhvZHMoc2VsZik6CiAgICAgICAgIiIiVGVzdCB0aGF0IHRoZSBkZXByZWNhdGVkIGZhaWwqIG1ldGhvZHMgZ2V0IHJlbW92ZWQgaW4gMy54IiIiCiAgICAgICAgaWYgc3lzLnZlcnNpb25faW5mb1s6Ml0gPCAoMywgMyk6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIGRlcHJlY2F0ZWRfbmFtZXMgPSBbCiAgICAgICAgICAgICdmYWlsSWZFcXVhbCcsICdmYWlsVW5sZXNzRXF1YWwnLCAnZmFpbFVubGVzc0FsbW9zdEVxdWFsJywKICAgICAgICAgICAgJ2ZhaWxJZkFsbW9zdEVxdWFsJywgJ2ZhaWxVbmxlc3MnLCAnZmFpbFVubGVzc1JhaXNlcycsICdmYWlsSWYnLAogICAgICAgICAgICAnYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0JywKICAgICAgICBdCiAgICAgICAgZm9yIGRlcHJlY2F0ZWRfbmFtZSBpbiBkZXByZWNhdGVkX25hbWVzOgogICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yKToKICAgICAgICAgICAgICAgIGdldGF0dHIoc2VsZiwgZGVwcmVjYXRlZF9uYW1lKSAgIyByZW1vdmUgdGhlc2UgaW4gMy54CgogICAgZGVmIHRlc3REZWVwY29weShzZWxmKToKICAgICAgICAjIElzc3VlOiA1NjYwCiAgICAgICAgY2xhc3MgVGVzdGFibGVUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3ROb3RoaW5nKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICB0ZXN0ID0gVGVzdGFibGVUZXN0KCd0ZXN0Tm90aGluZycpCgogICAgICAgICMgVGhpcyBzaG91bGRuJ3QgYmxvdyB1cAogICAgICAgIGRlZXBjb3B5KHRlc3QpCgogICAgZGVmIHRlc3RQaWNrbGUoc2VsZik6CiAgICAgICAgIyBJc3N1ZSAxMDMyNgoKICAgICAgICAjIENhbid0IHVzZSBUZXN0Q2FzZSBjbGFzc2VzIGRlZmluZWQgaW4gVGVzdCBjbGFzcyBhcwogICAgICAgICMgcGlja2xlIGRvZXMgbm90IHdvcmsgd2l0aCBpbm5lciBjbGFzc2VzCiAgICAgICAgdGVzdCA9IHVuaXR0ZXN0LlRlc3RDYXNlKCdydW4nKQogICAgICAgIGZvciBwcm90b2NvbCBpbiByYW5nZShwaWNrbGUuSElHSEVTVF9QUk9UT0NPTCArIDEpOgoKICAgICAgICAgICAgIyBibGV3IHVwIHByaW9yIHRvIGZpeAogICAgICAgICAgICBwaWNrbGVkX3Rlc3QgPSBwaWNrbGUuZHVtcHModGVzdCwgcHJvdG9jb2w9cHJvdG9jb2wpCiAgICAgICAgICAgIHVucGlja2xlZF90ZXN0ID0gcGlja2xlLmxvYWRzKHBpY2tsZWRfdGVzdCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCh0ZXN0LCB1bnBpY2tsZWRfdGVzdCkKCiAgICAgICAgICAgICMgZXhlcmNpc2UgdGhlIFRlc3RDYXNlIGluc3RhbmNlIGluIGEgd2F5IHRoYXQgd2lsbCBpbnZva2UKICAgICAgICAgICAgIyB0aGUgdHlwZSBlcXVhbGl0eSBsb29rdXAgbWVjaGFuaXNtCiAgICAgICAgICAgIHVucGlja2xlZF90ZXN0LmFzc2VydEVxdWFsKHNldCgpLCBzZXQoKSkKCiAgICBkZWYgdGVzdEtleWJvYXJkSW50ZXJydXB0KHNlbGYpOgogICAgICAgIGRlZiBfcmFpc2Uoc2VsZj1Ob25lKToKICAgICAgICAgICAgcmFpc2UgS2V5Ym9hcmRJbnRlcnJ1cHQKICAgICAgICBkZWYgbm90aGluZyhzZWxmKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBjbGFzcyBUZXN0MSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHRlc3Rfc29tZXRoaW5nID0gX3JhaXNlCgogICAgICAgIGNsYXNzIFRlc3QyKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgc2V0VXAgPSBfcmFpc2UKICAgICAgICAgICAgdGVzdF9zb21ldGhpbmcgPSBub3RoaW5nCgogICAgICAgIGNsYXNzIFRlc3QzKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgdGVzdF9zb21ldGhpbmcgPSBub3RoaW5nCiAgICAgICAgICAgIHRlYXJEb3duID0gX3JhaXNlCgogICAgICAgIGNsYXNzIFRlc3Q0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Rfc29tZXRoaW5nKHNlbGYpOgogICAgICAgICAgICAgICAgc2VsZi5hZGRDbGVhbnVwKF9yYWlzZSkKCiAgICAgICAgZm9yIGtsYXNzIGluIChUZXN0MSwgVGVzdDIsIFRlc3QzLCBUZXN0NCk6CiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoS2V5Ym9hcmRJbnRlcnJ1cHQpOgogICAgICAgICAgICAgICAga2xhc3MoJ3Rlc3Rfc29tZXRoaW5nJykucnVuKCkKCiAgICBkZWYgdGVzdFNraXBwaW5nRXZlcnl3aGVyZShzZWxmKToKICAgICAgICBkZWYgX3NraXAoc2VsZj1Ob25lKToKICAgICAgICAgICAgcmFpc2UgdW5pdHRlc3QuU2tpcFRlc3QoJ3NvbWUgcmVhc29uJykKICAgICAgICBkZWYgbm90aGluZyhzZWxmKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBjbGFzcyBUZXN0MSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHRlc3Rfc29tZXRoaW5nID0gX3NraXAKCiAgICAgICAgY2xhc3MgVGVzdDIodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBzZXRVcCA9IF9za2lwCiAgICAgICAgICAgIHRlc3Rfc29tZXRoaW5nID0gbm90aGluZwoKICAgICAgICBjbGFzcyBUZXN0Myh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHRlc3Rfc29tZXRoaW5nID0gbm90aGluZwogICAgICAgICAgICB0ZWFyRG93biA9IF9za2lwCgogICAgICAgIGNsYXNzIFRlc3Q0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Rfc29tZXRoaW5nKHNlbGYpOgogICAgICAgICAgICAgICAgc2VsZi5hZGRDbGVhbnVwKF9za2lwKQoKICAgICAgICBmb3Iga2xhc3MgaW4gKFRlc3QxLCBUZXN0MiwgVGVzdDMsIFRlc3Q0KToKICAgICAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgICAgIGtsYXNzKCd0ZXN0X3NvbWV0aGluZycpLnJ1bihyZXN1bHQpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5za2lwcGVkKSwgMSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDEpCgogICAgZGVmIHRlc3RTeXN0ZW1FeGl0KHNlbGYpOgogICAgICAgIGRlZiBfcmFpc2Uoc2VsZj1Ob25lKToKICAgICAgICAgICAgcmFpc2UgU3lzdGVtRXhpdAogICAgICAgIGRlZiBub3RoaW5nKHNlbGYpOgogICAgICAgICAgICBwYXNzCgogICAgICAgIGNsYXNzIFRlc3QxKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgdGVzdF9zb21ldGhpbmcgPSBfcmFpc2UKCiAgICAgICAgY2xhc3MgVGVzdDIodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBzZXRVcCA9IF9yYWlzZQogICAgICAgICAgICB0ZXN0X3NvbWV0aGluZyA9IG5vdGhpbmcKCiAgICAgICAgY2xhc3MgVGVzdDModW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICB0ZXN0X3NvbWV0aGluZyA9IG5vdGhpbmcKICAgICAgICAgICAgdGVhckRvd24gPSBfcmFpc2UKCiAgICAgICAgY2xhc3MgVGVzdDQodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF9zb21ldGhpbmcoc2VsZik6CiAgICAgICAgICAgICAgICBzZWxmLmFkZENsZWFudXAoX3JhaXNlKQoKICAgICAgICBmb3Iga2xhc3MgaW4gKFRlc3QxLCBUZXN0MiwgVGVzdDMsIFRlc3Q0KToKICAgICAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgICAgIGtsYXNzKCd0ZXN0X3NvbWV0aGluZycpLnJ1bihyZXN1bHQpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAxKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC50ZXN0c1J1biwgMSkKCiAgICBAc3VwcG9ydC5jcHl0aG9uX29ubHkKICAgIGRlZiB0ZXN0Tm9DeWNsZXMoc2VsZik6CiAgICAgICAgY2FzZSA9IHVuaXR0ZXN0LlRlc3RDYXNlKCkKICAgICAgICB3ciA9IHdlYWtyZWYucmVmKGNhc2UpCiAgICAgICAgd2l0aCBzdXBwb3J0LmRpc2FibGVfZ2MoKToKICAgICAgICAgICAgZGVsIGNhc2UKICAgICAgICAgICAgc2VsZi5hc3NlcnRGYWxzZSh3cigpKQo=',
'/Lib/unittest/test/test_discovery.py':'aW1wb3J0IG9zCmltcG9ydCByZQppbXBvcnQgc3lzCgppbXBvcnQgdW5pdHRlc3QKCgpjbGFzcyBUZXN0YWJsZVRlc3RQcm9ncmFtKHVuaXR0ZXN0LlRlc3RQcm9ncmFtKToKICAgIG1vZHVsZSA9ICdfX21haW5fXycKICAgIGV4aXQgPSBUcnVlCiAgICBkZWZhdWx0VGVzdCA9IGZhaWxmYXN0ID0gY2F0Y2hicmVhayA9IGJ1ZmZlciA9IE5vbmUKICAgIHZlcmJvc2l0eSA9IDEKICAgIHByb2dOYW1lID0gJycKICAgIHRlc3RSdW5uZXIgPSB0ZXN0TG9hZGVyID0gTm9uZQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBwYXNzCgoKY2xhc3MgVGVzdERpc2NvdmVyeSh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgIyBIZWF2aWx5IG1vY2tlZCB0ZXN0cyBzbyBJIGNhbiBhdm9pZCBoaXR0aW5nIHRoZSBmaWxlc3lzdGVtCiAgICBkZWYgdGVzdF9nZXRfbmFtZV9mcm9tX3BhdGgoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLl90b3BfbGV2ZWxfZGlyID0gJy9mb28nCiAgICAgICAgbmFtZSA9IGxvYWRlci5fZ2V0X25hbWVfZnJvbV9wYXRoKCcvZm9vL2Jhci9iYXoucHknKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobmFtZSwgJ2Jhci5iYXonKQoKICAgICAgICBpZiBub3QgX19kZWJ1Z19fOgogICAgICAgICAgICAjIGFzc2VydHMgYXJlIG9mZgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhBc3NlcnRpb25FcnJvcik6CiAgICAgICAgICAgIGxvYWRlci5fZ2V0X25hbWVfZnJvbV9wYXRoKCcvYmFyL2Jhei5weScpCgogICAgZGVmIHRlc3RfZmluZF90ZXN0cyhzZWxmKToKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgb3JpZ2luYWxfbGlzdGRpciA9IG9zLmxpc3RkaXIKICAgICAgICBkZWYgcmVzdG9yZV9saXN0ZGlyKCk6CiAgICAgICAgICAgIG9zLmxpc3RkaXIgPSBvcmlnaW5hbF9saXN0ZGlyCiAgICAgICAgb3JpZ2luYWxfaXNmaWxlID0gb3MucGF0aC5pc2ZpbGUKICAgICAgICBkZWYgcmVzdG9yZV9pc2ZpbGUoKToKICAgICAgICAgICAgb3MucGF0aC5pc2ZpbGUgPSBvcmlnaW5hbF9pc2ZpbGUKICAgICAgICBvcmlnaW5hbF9pc2RpciA9IG9zLnBhdGguaXNkaXIKICAgICAgICBkZWYgcmVzdG9yZV9pc2RpcigpOgogICAgICAgICAgICBvcy5wYXRoLmlzZGlyID0gb3JpZ2luYWxfaXNkaXIKCiAgICAgICAgcGF0aF9saXN0cyA9IFtbJ3Rlc3QxLnB5JywgJ3Rlc3QyLnB5JywgJ25vdF9hX3Rlc3QucHknLCAndGVzdF9kaXInLAogICAgICAgICAgICAgICAgICAgICAgICd0ZXN0LmZvbycsICd0ZXN0LW5vdC1hLW1vZHVsZS5weScsICdhbm90aGVyX2RpciddLAogICAgICAgICAgICAgICAgICAgICAgWyd0ZXN0My5weScsICd0ZXN0NC5weScsIF1dCiAgICAgICAgb3MubGlzdGRpciA9IGxhbWJkYSBwYXRoOiBwYXRoX2xpc3RzLnBvcCgwKQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChyZXN0b3JlX2xpc3RkaXIpCgogICAgICAgIGRlZiBpc2RpcihwYXRoKToKICAgICAgICAgICAgcmV0dXJuIHBhdGguZW5kc3dpdGgoJ2RpcicpCiAgICAgICAgb3MucGF0aC5pc2RpciA9IGlzZGlyCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHJlc3RvcmVfaXNkaXIpCgogICAgICAgIGRlZiBpc2ZpbGUocGF0aCk6CiAgICAgICAgICAgICMgYW5vdGhlcl9kaXIgaXMgbm90IGEgcGFja2FnZSBhbmQgc28gc2hvdWxkbid0IGJlIHJlY3Vyc2VkIGludG8KICAgICAgICAgICAgcmV0dXJuIG5vdCBwYXRoLmVuZHN3aXRoKCdkaXInKSBhbmQgbm90ICdhbm90aGVyX2RpcicgaW4gcGF0aAogICAgICAgIG9zLnBhdGguaXNmaWxlID0gaXNmaWxlCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHJlc3RvcmVfaXNmaWxlKQoKICAgICAgICBsb2FkZXIuX2dldF9tb2R1bGVfZnJvbV9uYW1lID0gbGFtYmRhIHBhdGg6IHBhdGggKyAnIG1vZHVsZScKICAgICAgICBsb2FkZXIubG9hZFRlc3RzRnJvbU1vZHVsZSA9IGxhbWJkYSBtb2R1bGU6IG1vZHVsZSArICcgdGVzdHMnCgogICAgICAgIHRvcF9sZXZlbCA9IG9zLnBhdGguYWJzcGF0aCgnL2ZvbycpCiAgICAgICAgbG9hZGVyLl90b3BfbGV2ZWxfZGlyID0gdG9wX2xldmVsCiAgICAgICAgc3VpdGUgPSBsaXN0KGxvYWRlci5fZmluZF90ZXN0cyh0b3BfbGV2ZWwsICd0ZXN0Ki5weScpKQoKICAgICAgICBleHBlY3RlZCA9IFtuYW1lICsgJyBtb2R1bGUgdGVzdHMnIGZvciBuYW1lIGluCiAgICAgICAgICAgICAgICAgICAgKCd0ZXN0MScsICd0ZXN0MicpXQogICAgICAgIGV4cGVjdGVkLmV4dGVuZChbKCd0ZXN0X2Rpci4lcycgJSBuYW1lKSArICcgbW9kdWxlIHRlc3RzJyBmb3IgbmFtZSBpbgogICAgICAgICAgICAgICAgICAgICgndGVzdDMnLCAndGVzdDQnKV0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdWl0ZSwgZXhwZWN0ZWQpCgogICAgZGVmIHRlc3RfZmluZF90ZXN0c193aXRoX3BhY2thZ2Uoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCgogICAgICAgIG9yaWdpbmFsX2xpc3RkaXIgPSBvcy5saXN0ZGlyCiAgICAgICAgZGVmIHJlc3RvcmVfbGlzdGRpcigpOgogICAgICAgICAgICBvcy5saXN0ZGlyID0gb3JpZ2luYWxfbGlzdGRpcgogICAgICAgIG9yaWdpbmFsX2lzZmlsZSA9IG9zLnBhdGguaXNmaWxlCiAgICAgICAgZGVmIHJlc3RvcmVfaXNmaWxlKCk6CiAgICAgICAgICAgIG9zLnBhdGguaXNmaWxlID0gb3JpZ2luYWxfaXNmaWxlCiAgICAgICAgb3JpZ2luYWxfaXNkaXIgPSBvcy5wYXRoLmlzZGlyCiAgICAgICAgZGVmIHJlc3RvcmVfaXNkaXIoKToKICAgICAgICAgICAgb3MucGF0aC5pc2RpciA9IG9yaWdpbmFsX2lzZGlyCgogICAgICAgIGRpcmVjdG9yaWVzID0gWydhX2RpcmVjdG9yeScsICd0ZXN0X2RpcmVjdG9yeScsICd0ZXN0X2RpcmVjdG9yeTInXQogICAgICAgIHBhdGhfbGlzdHMgPSBbZGlyZWN0b3JpZXMsIFtdLCBbXSwgW11dCiAgICAgICAgb3MubGlzdGRpciA9IGxhbWJkYSBwYXRoOiBwYXRoX2xpc3RzLnBvcCgwKQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChyZXN0b3JlX2xpc3RkaXIpCgogICAgICAgIG9zLnBhdGguaXNkaXIgPSBsYW1iZGEgcGF0aDogVHJ1ZQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChyZXN0b3JlX2lzZGlyKQoKICAgICAgICBvcy5wYXRoLmlzZmlsZSA9IGxhbWJkYSBwYXRoOiBvcy5wYXRoLmJhc2VuYW1lKHBhdGgpIG5vdCBpbiBkaXJlY3RvcmllcwogICAgICAgIHNlbGYuYWRkQ2xlYW51cChyZXN0b3JlX2lzZmlsZSkKCiAgICAgICAgY2xhc3MgTW9kdWxlKG9iamVjdCk6CiAgICAgICAgICAgIHBhdGhzID0gW10KICAgICAgICAgICAgbG9hZF90ZXN0c19hcmdzID0gW10KCiAgICAgICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBwYXRoKToKICAgICAgICAgICAgICAgIHNlbGYucGF0aCA9IHBhdGgKICAgICAgICAgICAgICAgIHNlbGYucGF0aHMuYXBwZW5kKHBhdGgpCiAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmJhc2VuYW1lKHBhdGgpID09ICd0ZXN0X2RpcmVjdG9yeSc6CiAgICAgICAgICAgICAgICAgICAgZGVmIGxvYWRfdGVzdHMobG9hZGVyLCB0ZXN0cywgcGF0dGVybik6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubG9hZF90ZXN0c19hcmdzLmFwcGVuZCgobG9hZGVyLCB0ZXN0cywgcGF0dGVybikpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnbG9hZF90ZXN0cycKICAgICAgICAgICAgICAgICAgICBzZWxmLmxvYWRfdGVzdHMgPSBsb2FkX3Rlc3RzCgogICAgICAgICAgICBkZWYgX19lcV9fKHNlbGYsIG90aGVyKToKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnBhdGggPT0gb3RoZXIucGF0aAoKICAgICAgICBsb2FkZXIuX2dldF9tb2R1bGVfZnJvbV9uYW1lID0gbGFtYmRhIG5hbWU6IE1vZHVsZShuYW1lKQogICAgICAgIGRlZiBsb2FkVGVzdHNGcm9tTW9kdWxlKG1vZHVsZSwgdXNlX2xvYWRfdGVzdHMpOgogICAgICAgICAgICBpZiB1c2VfbG9hZF90ZXN0czoKICAgICAgICAgICAgICAgIHJhaXNlIHNlbGYuZmFpbHVyZUV4Y2VwdGlvbigndXNlX2xvYWRfdGVzdHMgc2hvdWxkIGJlIEZhbHNlIGZvciBwYWNrYWdlcycpCiAgICAgICAgICAgIHJldHVybiBtb2R1bGUucGF0aCArICcgbW9kdWxlIHRlc3RzJwogICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tTW9kdWxlID0gbG9hZFRlc3RzRnJvbU1vZHVsZQoKICAgICAgICBsb2FkZXIuX3RvcF9sZXZlbF9kaXIgPSAnL2ZvbycKICAgICAgICAjIHRoaXMgdGltZSBubyAnLnB5JyBvbiB0aGUgcGF0dGVybiBzbyB0aGF0IGl0IGNhbiBtYXRjaAogICAgICAgICMgYSB0ZXN0IHBhY2thZ2UKICAgICAgICBzdWl0ZSA9IGxpc3QobG9hZGVyLl9maW5kX3Rlc3RzKCcvZm9vJywgJ3Rlc3QqJykpCgogICAgICAgICMgV2Ugc2hvdWxkIGhhdmUgbG9hZGVkIHRlc3RzIGZyb20gdGhlIHRlc3RfZGlyZWN0b3J5IHBhY2thZ2UgYnkgY2FsbGluZyBsb2FkX3Rlc3RzCiAgICAgICAgIyBhbmQgZGlyZWN0bHkgZnJvbSB0aGUgdGVzdF9kaXJlY3RvcnkyIHBhY2thZ2UKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN1aXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgWydsb2FkX3Rlc3RzJywgJ3Rlc3RfZGlyZWN0b3J5MicgKyAnIG1vZHVsZSB0ZXN0cyddKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoTW9kdWxlLnBhdGhzLCBbJ3Rlc3RfZGlyZWN0b3J5JywgJ3Rlc3RfZGlyZWN0b3J5MiddKQoKICAgICAgICAjIGxvYWRfdGVzdHMgc2hvdWxkIGhhdmUgYmVlbiBjYWxsZWQgb25jZSB3aXRoIGxvYWRlciwgdGVzdHMgYW5kIHBhdHRlcm4KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKE1vZHVsZS5sb2FkX3Rlc3RzX2FyZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICBbKGxvYWRlciwgJ3Rlc3RfZGlyZWN0b3J5JyArICcgbW9kdWxlIHRlc3RzJywgJ3Rlc3QqJyldKQoKICAgIGRlZiB0ZXN0X2Rpc2NvdmVyKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICBvcmlnaW5hbF9pc2ZpbGUgPSBvcy5wYXRoLmlzZmlsZQogICAgICAgIG9yaWdpbmFsX2lzZGlyID0gb3MucGF0aC5pc2RpcgogICAgICAgIGRlZiByZXN0b3JlX2lzZmlsZSgpOgogICAgICAgICAgICBvcy5wYXRoLmlzZmlsZSA9IG9yaWdpbmFsX2lzZmlsZQoKICAgICAgICBvcy5wYXRoLmlzZmlsZSA9IGxhbWJkYSBwYXRoOiBGYWxzZQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChyZXN0b3JlX2lzZmlsZSkKCiAgICAgICAgb3JpZ19zeXNfcGF0aCA9IHN5cy5wYXRoWzpdCiAgICAgICAgZGVmIHJlc3RvcmVfcGF0aCgpOgogICAgICAgICAgICBzeXMucGF0aFs6XSA9IG9yaWdfc3lzX3BhdGgKICAgICAgICBzZWxmLmFkZENsZWFudXAocmVzdG9yZV9wYXRoKQoKICAgICAgICBmdWxsX3BhdGggPSBvcy5wYXRoLmFic3BhdGgob3MucGF0aC5ub3JtcGF0aCgnL2ZvbycpKQogICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoSW1wb3J0RXJyb3IpOgogICAgICAgICAgICBsb2FkZXIuZGlzY292ZXIoJy9mb28vYmFyJywgdG9wX2xldmVsX2Rpcj0nL2ZvbycpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobG9hZGVyLl90b3BfbGV2ZWxfZGlyLCBmdWxsX3BhdGgpCiAgICAgICAgc2VsZi5hc3NlcnRJbihmdWxsX3BhdGgsIHN5cy5wYXRoKQoKICAgICAgICBvcy5wYXRoLmlzZmlsZSA9IGxhbWJkYSBwYXRoOiBUcnVlCiAgICAgICAgb3MucGF0aC5pc2RpciA9IGxhbWJkYSBwYXRoOiBUcnVlCgogICAgICAgIGRlZiByZXN0b3JlX2lzZGlyKCk6CiAgICAgICAgICAgIG9zLnBhdGguaXNkaXIgPSBvcmlnaW5hbF9pc2RpcgogICAgICAgIHNlbGYuYWRkQ2xlYW51cChyZXN0b3JlX2lzZGlyKQoKICAgICAgICBfZmluZF90ZXN0c19hcmdzID0gW10KICAgICAgICBkZWYgX2ZpbmRfdGVzdHMoc3RhcnRfZGlyLCBwYXR0ZXJuKToKICAgICAgICAgICAgX2ZpbmRfdGVzdHNfYXJncy5hcHBlbmQoKHN0YXJ0X2RpciwgcGF0dGVybikpCiAgICAgICAgICAgIHJldHVybiBbJ3Rlc3RzJ10KICAgICAgICBsb2FkZXIuX2ZpbmRfdGVzdHMgPSBfZmluZF90ZXN0cwogICAgICAgIGxvYWRlci5zdWl0ZUNsYXNzID0gc3RyCgogICAgICAgIHN1aXRlID0gbG9hZGVyLmRpc2NvdmVyKCcvZm9vL2Jhci9iYXonLCAncGF0dGVybicsICcvZm9vL2JhcicpCgogICAgICAgIHRvcF9sZXZlbF9kaXIgPSBvcy5wYXRoLmFic3BhdGgoJy9mb28vYmFyJykKICAgICAgICBzdGFydF9kaXIgPSBvcy5wYXRoLmFic3BhdGgoJy9mb28vYmFyL2JheicpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdWl0ZSwgIlsndGVzdHMnXSIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIuX3RvcF9sZXZlbF9kaXIsIHRvcF9sZXZlbF9kaXIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChfZmluZF90ZXN0c19hcmdzLCBbKHN0YXJ0X2RpciwgJ3BhdHRlcm4nKV0pCiAgICAgICAgc2VsZi5hc3NlcnRJbih0b3BfbGV2ZWxfZGlyLCBzeXMucGF0aCkKCiAgICBkZWYgdGVzdF9kaXNjb3Zlcl93aXRoX21vZHVsZXNfdGhhdF9mYWlsX3RvX2ltcG9ydChzZWxmKToKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgbGlzdGRpciA9IG9zLmxpc3RkaXIKICAgICAgICBvcy5saXN0ZGlyID0gbGFtYmRhIF86IFsndGVzdF90aGlzX2RvZXNfbm90X2V4aXN0LnB5J10KICAgICAgICBpc2ZpbGUgPSBvcy5wYXRoLmlzZmlsZQogICAgICAgIG9zLnBhdGguaXNmaWxlID0gbGFtYmRhIF86IFRydWUKICAgICAgICBvcmlnX3N5c19wYXRoID0gc3lzLnBhdGhbOl0KICAgICAgICBkZWYgcmVzdG9yZSgpOgogICAgICAgICAgICBvcy5wYXRoLmlzZmlsZSA9IGlzZmlsZQogICAgICAgICAgICBvcy5saXN0ZGlyID0gbGlzdGRpcgogICAgICAgICAgICBzeXMucGF0aFs6XSA9IG9yaWdfc3lzX3BhdGgKICAgICAgICBzZWxmLmFkZENsZWFudXAocmVzdG9yZSkKCiAgICAgICAgc3VpdGUgPSBsb2FkZXIuZGlzY292ZXIoJy4nKQogICAgICAgIHNlbGYuYXNzZXJ0SW4ob3MuZ2V0Y3dkKCksIHN5cy5wYXRoKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3VpdGUuY291bnRUZXN0Q2FzZXMoKSwgMSkKICAgICAgICB0ZXN0ID0gbGlzdChsaXN0KHN1aXRlKVswXSlbMF0gIyBleHRyYWN0IHRlc3QgZnJvbSBzdWl0ZQoKICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKEltcG9ydEVycm9yKToKICAgICAgICAgICAgdGVzdC50ZXN0X3RoaXNfZG9lc19ub3RfZXhpc3QoKQoKICAgIGRlZiB0ZXN0X2NvbW1hbmRfbGluZV9oYW5kbGluZ19wYXJzZUFyZ3Moc2VsZik6CiAgICAgICAgcHJvZ3JhbSA9IFRlc3RhYmxlVGVzdFByb2dyYW0oKQoKICAgICAgICBhcmdzID0gW10KICAgICAgICBkZWYgZG9fZGlzY292ZXJ5KGFyZ3YpOgogICAgICAgICAgICBhcmdzLmV4dGVuZChhcmd2KQogICAgICAgIHByb2dyYW0uX2RvX2Rpc2NvdmVyeSA9IGRvX2Rpc2NvdmVyeQogICAgICAgIHByb2dyYW0ucGFyc2VBcmdzKFsnc29tZXRoaW5nJywgJ2Rpc2NvdmVyJ10pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCBbXSkKCiAgICAgICAgcHJvZ3JhbS5wYXJzZUFyZ3MoWydzb21ldGhpbmcnLCAnZGlzY292ZXInLCAnZm9vJywgJ2JhciddKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgWydmb28nLCAnYmFyJ10pCgogICAgZGVmIHRlc3RfY29tbWFuZF9saW5lX2hhbmRsaW5nX2Rpc2NvdmVyX2J5X2RlZmF1bHQoc2VsZik6CiAgICAgICAgcHJvZ3JhbSA9IFRlc3RhYmxlVGVzdFByb2dyYW0oKQogICAgICAgIHByb2dyYW0ubW9kdWxlID0gTm9uZQoKICAgICAgICBzZWxmLmNhbGxlZCA9IEZhbHNlCiAgICAgICAgZGVmIGRvX2Rpc2NvdmVyeShhcmd2KToKICAgICAgICAgICAgc2VsZi5jYWxsZWQgPSBUcnVlCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJndiwgW10pCiAgICAgICAgcHJvZ3JhbS5fZG9fZGlzY292ZXJ5ID0gZG9fZGlzY292ZXJ5CiAgICAgICAgcHJvZ3JhbS5wYXJzZUFyZ3MoWydzb21ldGhpbmcnXSkKICAgICAgICBzZWxmLmFzc2VydFRydWUoc2VsZi5jYWxsZWQpCgogICAgZGVmIHRlc3RfY29tbWFuZF9saW5lX2hhbmRsaW5nX2Rpc2NvdmVyX2J5X2RlZmF1bHRfd2l0aF9vcHRpb25zKHNlbGYpOgogICAgICAgIHByb2dyYW0gPSBUZXN0YWJsZVRlc3RQcm9ncmFtKCkKICAgICAgICBwcm9ncmFtLm1vZHVsZSA9IE5vbmUKCiAgICAgICAgYXJncyA9IFsnc29tZXRoaW5nJywgJy12JywgJy1iJywgJy12JywgJy1jJywgJy1mJ10KICAgICAgICBzZWxmLmNhbGxlZCA9IEZhbHNlCiAgICAgICAgZGVmIGRvX2Rpc2NvdmVyeShhcmd2KToKICAgICAgICAgICAgc2VsZi5jYWxsZWQgPSBUcnVlCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJndiwgYXJnc1sxOl0pCiAgICAgICAgcHJvZ3JhbS5fZG9fZGlzY292ZXJ5ID0gZG9fZGlzY292ZXJ5CiAgICAgICAgcHJvZ3JhbS5wYXJzZUFyZ3MoYXJncykKICAgICAgICBzZWxmLmFzc2VydFRydWUoc2VsZi5jYWxsZWQpCgoKICAgIGRlZiB0ZXN0X2NvbW1hbmRfbGluZV9oYW5kbGluZ19kb19kaXNjb3ZlcnlfdG9vX21hbnlfYXJndW1lbnRzKHNlbGYpOgogICAgICAgIGNsYXNzIFN0b3AoRXhjZXB0aW9uKToKICAgICAgICAgICAgcGFzcwogICAgICAgIGRlZiB1c2FnZUV4aXQoKToKICAgICAgICAgICAgcmFpc2UgU3RvcAoKICAgICAgICBwcm9ncmFtID0gVGVzdGFibGVUZXN0UHJvZ3JhbSgpCiAgICAgICAgcHJvZ3JhbS51c2FnZUV4aXQgPSB1c2FnZUV4aXQKCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhTdG9wKToKICAgICAgICAgICAgIyB0b28gbWFueSBhcmdzCiAgICAgICAgICAgIHByb2dyYW0uX2RvX2Rpc2NvdmVyeShbJ29uZScsICd0d28nLCAndGhyZWUnLCAnZm91ciddKQoKCiAgICBkZWYgdGVzdF9jb21tYW5kX2xpbmVfaGFuZGxpbmdfZG9fZGlzY292ZXJ5X2NhbGxzX2xvYWRlcihzZWxmKToKICAgICAgICBwcm9ncmFtID0gVGVzdGFibGVUZXN0UHJvZ3JhbSgpCgogICAgICAgIGNsYXNzIExvYWRlcihvYmplY3QpOgogICAgICAgICAgICBhcmdzID0gW10KICAgICAgICAgICAgZGVmIGRpc2NvdmVyKHNlbGYsIHN0YXJ0X2RpciwgcGF0dGVybiwgdG9wX2xldmVsX2Rpcik6CiAgICAgICAgICAgICAgICBzZWxmLmFyZ3MuYXBwZW5kKChzdGFydF9kaXIsIHBhdHRlcm4sIHRvcF9sZXZlbF9kaXIpKQogICAgICAgICAgICAgICAgcmV0dXJuICd0ZXN0cycKCiAgICAgICAgcHJvZ3JhbS5fZG9fZGlzY292ZXJ5KFsnLXYnXSwgTG9hZGVyPUxvYWRlcikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHByb2dyYW0udmVyYm9zaXR5LCAyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS50ZXN0LCAndGVzdHMnKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoTG9hZGVyLmFyZ3MsIFsoJy4nLCAndGVzdCoucHknLCBOb25lKV0pCgogICAgICAgIExvYWRlci5hcmdzID0gW10KICAgICAgICBwcm9ncmFtID0gVGVzdGFibGVUZXN0UHJvZ3JhbSgpCiAgICAgICAgcHJvZ3JhbS5fZG9fZGlzY292ZXJ5KFsnLS12ZXJib3NlJ10sIExvYWRlcj1Mb2FkZXIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm9ncmFtLnRlc3QsICd0ZXN0cycpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChMb2FkZXIuYXJncywgWygnLicsICd0ZXN0Ki5weScsIE5vbmUpXSkKCiAgICAgICAgTG9hZGVyLmFyZ3MgPSBbXQogICAgICAgIHByb2dyYW0gPSBUZXN0YWJsZVRlc3RQcm9ncmFtKCkKICAgICAgICBwcm9ncmFtLl9kb19kaXNjb3ZlcnkoW10sIExvYWRlcj1Mb2FkZXIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm9ncmFtLnRlc3QsICd0ZXN0cycpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChMb2FkZXIuYXJncywgWygnLicsICd0ZXN0Ki5weScsIE5vbmUpXSkKCiAgICAgICAgTG9hZGVyLmFyZ3MgPSBbXQogICAgICAgIHByb2dyYW0gPSBUZXN0YWJsZVRlc3RQcm9ncmFtKCkKICAgICAgICBwcm9ncmFtLl9kb19kaXNjb3ZlcnkoWydmaXNoJ10sIExvYWRlcj1Mb2FkZXIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm9ncmFtLnRlc3QsICd0ZXN0cycpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChMb2FkZXIuYXJncywgWygnZmlzaCcsICd0ZXN0Ki5weScsIE5vbmUpXSkKCiAgICAgICAgTG9hZGVyLmFyZ3MgPSBbXQogICAgICAgIHByb2dyYW0gPSBUZXN0YWJsZVRlc3RQcm9ncmFtKCkKICAgICAgICBwcm9ncmFtLl9kb19kaXNjb3ZlcnkoWydmaXNoJywgJ2VnZ3MnXSwgTG9hZGVyPUxvYWRlcikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHByb2dyYW0udGVzdCwgJ3Rlc3RzJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKExvYWRlci5hcmdzLCBbKCdmaXNoJywgJ2VnZ3MnLCBOb25lKV0pCgogICAgICAgIExvYWRlci5hcmdzID0gW10KICAgICAgICBwcm9ncmFtID0gVGVzdGFibGVUZXN0UHJvZ3JhbSgpCiAgICAgICAgcHJvZ3JhbS5fZG9fZGlzY292ZXJ5KFsnZmlzaCcsICdlZ2dzJywgJ2hhbSddLCBMb2FkZXI9TG9hZGVyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS50ZXN0LCAndGVzdHMnKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoTG9hZGVyLmFyZ3MsIFsoJ2Zpc2gnLCAnZWdncycsICdoYW0nKV0pCgogICAgICAgIExvYWRlci5hcmdzID0gW10KICAgICAgICBwcm9ncmFtID0gVGVzdGFibGVUZXN0UHJvZ3JhbSgpCiAgICAgICAgcHJvZ3JhbS5fZG9fZGlzY292ZXJ5KFsnLXMnLCAnZmlzaCddLCBMb2FkZXI9TG9hZGVyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS50ZXN0LCAndGVzdHMnKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoTG9hZGVyLmFyZ3MsIFsoJ2Zpc2gnLCAndGVzdCoucHknLCBOb25lKV0pCgogICAgICAgIExvYWRlci5hcmdzID0gW10KICAgICAgICBwcm9ncmFtID0gVGVzdGFibGVUZXN0UHJvZ3JhbSgpCiAgICAgICAgcHJvZ3JhbS5fZG9fZGlzY292ZXJ5KFsnLXQnLCAnZmlzaCddLCBMb2FkZXI9TG9hZGVyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS50ZXN0LCAndGVzdHMnKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoTG9hZGVyLmFyZ3MsIFsoJy4nLCAndGVzdCoucHknLCAnZmlzaCcpXSkKCiAgICAgICAgTG9hZGVyLmFyZ3MgPSBbXQogICAgICAgIHByb2dyYW0gPSBUZXN0YWJsZVRlc3RQcm9ncmFtKCkKICAgICAgICBwcm9ncmFtLl9kb19kaXNjb3ZlcnkoWyctcCcsICdmaXNoJ10sIExvYWRlcj1Mb2FkZXIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm9ncmFtLnRlc3QsICd0ZXN0cycpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChMb2FkZXIuYXJncywgWygnLicsICdmaXNoJywgTm9uZSldKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UocHJvZ3JhbS5mYWlsZmFzdCkKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKHByb2dyYW0uY2F0Y2hicmVhaykKCiAgICAgICAgTG9hZGVyLmFyZ3MgPSBbXQogICAgICAgIHByb2dyYW0gPSBUZXN0YWJsZVRlc3RQcm9ncmFtKCkKICAgICAgICBwcm9ncmFtLl9kb19kaXNjb3ZlcnkoWyctcCcsICdlZ2dzJywgJy1zJywgJ2Zpc2gnLCAnLXYnLCAnLWYnLCAnLWMnXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9hZGVyPUxvYWRlcikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHByb2dyYW0udGVzdCwgJ3Rlc3RzJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKExvYWRlci5hcmdzLCBbKCdmaXNoJywgJ2VnZ3MnLCBOb25lKV0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm9ncmFtLnZlcmJvc2l0eSwgMikKICAgICAgICBzZWxmLmFzc2VydFRydWUocHJvZ3JhbS5mYWlsZmFzdCkKICAgICAgICBzZWxmLmFzc2VydFRydWUocHJvZ3JhbS5jYXRjaGJyZWFrKQoKICAgIGRlZiB0ZXN0X2RldGVjdF9tb2R1bGVfY2xhc2goc2VsZik6CiAgICAgICAgY2xhc3MgTW9kdWxlKG9iamVjdCk6CiAgICAgICAgICAgIF9fZmlsZV9fID0gJ2Jhci9mb28ucHknCiAgICAgICAgc3lzLm1vZHVsZXNbJ2ZvbyddID0gTW9kdWxlCiAgICAgICAgZnVsbF9wYXRoID0gb3MucGF0aC5hYnNwYXRoKCdmb28nKQogICAgICAgIG9yaWdpbmFsX2xpc3RkaXIgPSBvcy5saXN0ZGlyCiAgICAgICAgb3JpZ2luYWxfaXNmaWxlID0gb3MucGF0aC5pc2ZpbGUKICAgICAgICBvcmlnaW5hbF9pc2RpciA9IG9zLnBhdGguaXNkaXIKCiAgICAgICAgZGVmIGNsZWFudXAoKToKICAgICAgICAgICAgb3MubGlzdGRpciA9IG9yaWdpbmFsX2xpc3RkaXIKICAgICAgICAgICAgb3MucGF0aC5pc2ZpbGUgPSBvcmlnaW5hbF9pc2ZpbGUKICAgICAgICAgICAgb3MucGF0aC5pc2RpciA9IG9yaWdpbmFsX2lzZGlyCiAgICAgICAgICAgIGRlbCBzeXMubW9kdWxlc1snZm9vJ10KICAgICAgICAgICAgaWYgZnVsbF9wYXRoIGluIHN5cy5wYXRoOgogICAgICAgICAgICAgICAgc3lzLnBhdGgucmVtb3ZlKGZ1bGxfcGF0aCkKICAgICAgICBzZWxmLmFkZENsZWFudXAoY2xlYW51cCkKCiAgICAgICAgZGVmIGxpc3RkaXIoXyk6CiAgICAgICAgICAgIHJldHVybiBbJ2Zvby5weSddCiAgICAgICAgZGVmIGlzZmlsZShfKToKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBkZWYgaXNkaXIoXyk6CiAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgb3MubGlzdGRpciA9IGxpc3RkaXIKICAgICAgICBvcy5wYXRoLmlzZmlsZSA9IGlzZmlsZQogICAgICAgIG9zLnBhdGguaXNkaXIgPSBpc2RpcgoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgbW9kX2RpciA9IG9zLnBhdGguYWJzcGF0aCgnYmFyJykKICAgICAgICBleHBlY3RlZF9kaXIgPSBvcy5wYXRoLmFic3BhdGgoJ2ZvbycpCiAgICAgICAgbXNnID0gcmUuZXNjYXBlKHIiJ2ZvbycgbW9kdWxlIGluY29ycmVjdGx5IGltcG9ydGVkIGZyb20gJXIuIEV4cGVjdGVkICVyLiAiCiAgICAgICAgICAgICAgICAiSXMgdGhpcyBtb2R1bGUgZ2xvYmFsbHkgaW5zdGFsbGVkPyIgJSAobW9kX2RpciwgZXhwZWN0ZWRfZGlyKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1JlZ2V4KAogICAgICAgICAgICBJbXBvcnRFcnJvciwgJ14lcyQnICUgbXNnLCBsb2FkZXIuZGlzY292ZXIsCiAgICAgICAgICAgIHN0YXJ0X2Rpcj0nZm9vJywgcGF0dGVybj0nZm9vLnB5JwogICAgICAgICkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN5cy5wYXRoWzBdLCBmdWxsX3BhdGgpCgoKICAgIGRlZiB0ZXN0X2Rpc2NvdmVyeV9mcm9tX2RvdHRlZF9wYXRoKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICB0ZXN0cyA9IFtzZWxmXQogICAgICAgIGV4cGVjdGVkUGF0aCA9IG9zLnBhdGguYWJzcGF0aChvcy5wYXRoLmRpcm5hbWUodW5pdHRlc3QudGVzdC5fX2ZpbGVfXykpCgogICAgICAgIHNlbGYud2FzUnVuID0gRmFsc2UKICAgICAgICBkZWYgX2ZpbmRfdGVzdHMoc3RhcnRfZGlyLCBwYXR0ZXJuKToKICAgICAgICAgICAgc2VsZi53YXNSdW4gPSBUcnVlCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RhcnRfZGlyLCBleHBlY3RlZFBhdGgpCiAgICAgICAgICAgIHJldHVybiB0ZXN0cwogICAgICAgIGxvYWRlci5fZmluZF90ZXN0cyA9IF9maW5kX3Rlc3RzCiAgICAgICAgc3VpdGUgPSBsb2FkZXIuZGlzY292ZXIoJ3VuaXR0ZXN0LnRlc3QnKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShzZWxmLndhc1J1bikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN1aXRlLl90ZXN0cywgdGVzdHMpCgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIHVuaXR0ZXN0Lm1haW4oKQo=',
'/Lib/unittest/test/test_functiontestcase.py':'aW1wb3J0IHVuaXR0ZXN0Cgpmcm9tIC5zdXBwb3J0IGltcG9ydCBMb2dnaW5nUmVzdWx0CgoKY2xhc3MgVGVzdF9GdW5jdGlvblRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKCiAgICAjICJSZXR1cm4gdGhlIG51bWJlciBvZiB0ZXN0cyByZXByZXNlbnRlZCBieSB0aGUgdGhpcyB0ZXN0IG9iamVjdC4gRm9yCiAgICAjIFRlc3RDYXNlIGluc3RhbmNlcywgdGhpcyB3aWxsIGFsd2F5cyBiZSAxIgogICAgZGVmIHRlc3RfY291bnRUZXN0Q2FzZXMoc2VsZik6CiAgICAgICAgdGVzdCA9IHVuaXR0ZXN0LkZ1bmN0aW9uVGVzdENhc2UobGFtYmRhOiBOb25lKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHRlc3QuY291bnRUZXN0Q2FzZXMoKSwgMSkKCiAgICAjICJXaGVuIGEgc2V0VXAoKSBtZXRob2QgaXMgZGVmaW5lZCwgdGhlIHRlc3QgcnVubmVyIHdpbGwgcnVuIHRoYXQgbWV0aG9kCiAgICAjIHByaW9yIHRvIGVhY2ggdGVzdC4gTGlrZXdpc2UsIGlmIGEgdGVhckRvd24oKSBtZXRob2QgaXMgZGVmaW5lZCwgdGhlCiAgICAjIHRlc3QgcnVubmVyIHdpbGwgaW52b2tlIHRoYXQgbWV0aG9kIGFmdGVyIGVhY2ggdGVzdC4gSW4gdGhlIGV4YW1wbGUsCiAgICAjIHNldFVwKCkgd2FzIHVzZWQgdG8gY3JlYXRlIGEgZnJlc2ggc2VxdWVuY2UgZm9yIGVhY2ggdGVzdC4iCiAgICAjCiAgICAjIE1ha2Ugc3VyZSB0aGUgcHJvcGVyIGNhbGwgb3JkZXIgaXMgbWFpbnRhaW5lZCwgZXZlbiBpZiBzZXRVcCgpIHJhaXNlcwogICAgIyBhbiBleGNlcHRpb24uCiAgICBkZWYgdGVzdF9ydW5fY2FsbF9vcmRlcl9fZXJyb3JfaW5fc2V0VXAoc2VsZik6CiAgICAgICAgZXZlbnRzID0gW10KICAgICAgICByZXN1bHQgPSBMb2dnaW5nUmVzdWx0KGV2ZW50cykKCiAgICAgICAgZGVmIHNldFVwKCk6CiAgICAgICAgICAgIGV2ZW50cy5hcHBlbmQoJ3NldFVwJykKICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCdyYWlzZWQgYnkgc2V0VXAnKQoKICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICBldmVudHMuYXBwZW5kKCd0ZXN0JykKCiAgICAgICAgZGVmIHRlYXJEb3duKCk6CiAgICAgICAgICAgIGV2ZW50cy5hcHBlbmQoJ3RlYXJEb3duJykKCiAgICAgICAgZXhwZWN0ZWQgPSBbJ3N0YXJ0VGVzdCcsICdzZXRVcCcsICdhZGRFcnJvcicsICdzdG9wVGVzdCddCiAgICAgICAgdW5pdHRlc3QuRnVuY3Rpb25UZXN0Q2FzZSh0ZXN0LCBzZXRVcCwgdGVhckRvd24pLnJ1bihyZXN1bHQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIGV4cGVjdGVkKQoKICAgICMgIldoZW4gYSBzZXRVcCgpIG1ldGhvZCBpcyBkZWZpbmVkLCB0aGUgdGVzdCBydW5uZXIgd2lsbCBydW4gdGhhdCBtZXRob2QKICAgICMgcHJpb3IgdG8gZWFjaCB0ZXN0LiBMaWtld2lzZSwgaWYgYSB0ZWFyRG93bigpIG1ldGhvZCBpcyBkZWZpbmVkLCB0aGUKICAgICMgdGVzdCBydW5uZXIgd2lsbCBpbnZva2UgdGhhdCBtZXRob2QgYWZ0ZXIgZWFjaCB0ZXN0LiBJbiB0aGUgZXhhbXBsZSwKICAgICMgc2V0VXAoKSB3YXMgdXNlZCB0byBjcmVhdGUgYSBmcmVzaCBzZXF1ZW5jZSBmb3IgZWFjaCB0ZXN0LiIKICAgICMKICAgICMgTWFrZSBzdXJlIHRoZSBwcm9wZXIgY2FsbCBvcmRlciBpcyBtYWludGFpbmVkLCBldmVuIGlmIHRoZSB0ZXN0IHJhaXNlcwogICAgIyBhbiBlcnJvciAoYXMgb3Bwb3NlZCB0byBhIGZhaWx1cmUpLgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2Vycm9yX2luX3Rlc3Qoc2VsZik6CiAgICAgICAgZXZlbnRzID0gW10KICAgICAgICByZXN1bHQgPSBMb2dnaW5nUmVzdWx0KGV2ZW50cykKCiAgICAgICAgZGVmIHNldFVwKCk6CiAgICAgICAgICAgIGV2ZW50cy5hcHBlbmQoJ3NldFVwJykKCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgZXZlbnRzLmFwcGVuZCgndGVzdCcpCiAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigncmFpc2VkIGJ5IHRlc3QnKQoKICAgICAgICBkZWYgdGVhckRvd24oKToKICAgICAgICAgICAgZXZlbnRzLmFwcGVuZCgndGVhckRvd24nKQoKICAgICAgICBleHBlY3RlZCA9IFsnc3RhcnRUZXN0JywgJ3NldFVwJywgJ3Rlc3QnLCAndGVhckRvd24nLAogICAgICAgICAgICAgICAgICAgICdhZGRFcnJvcicsICdzdG9wVGVzdCddCiAgICAgICAgdW5pdHRlc3QuRnVuY3Rpb25UZXN0Q2FzZSh0ZXN0LCBzZXRVcCwgdGVhckRvd24pLnJ1bihyZXN1bHQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIGV4cGVjdGVkKQoKICAgICMgIldoZW4gYSBzZXRVcCgpIG1ldGhvZCBpcyBkZWZpbmVkLCB0aGUgdGVzdCBydW5uZXIgd2lsbCBydW4gdGhhdCBtZXRob2QKICAgICMgcHJpb3IgdG8gZWFjaCB0ZXN0LiBMaWtld2lzZSwgaWYgYSB0ZWFyRG93bigpIG1ldGhvZCBpcyBkZWZpbmVkLCB0aGUKICAgICMgdGVzdCBydW5uZXIgd2lsbCBpbnZva2UgdGhhdCBtZXRob2QgYWZ0ZXIgZWFjaCB0ZXN0LiBJbiB0aGUgZXhhbXBsZSwKICAgICMgc2V0VXAoKSB3YXMgdXNlZCB0byBjcmVhdGUgYSBmcmVzaCBzZXF1ZW5jZSBmb3IgZWFjaCB0ZXN0LiIKICAgICMKICAgICMgTWFrZSBzdXJlIHRoZSBwcm9wZXIgY2FsbCBvcmRlciBpcyBtYWludGFpbmVkLCBldmVuIGlmIHRoZSB0ZXN0IHNpZ25hbHMKICAgICMgYSBmYWlsdXJlIChhcyBvcHBvc2VkIHRvIGFuIGVycm9yKS4KICAgIGRlZiB0ZXN0X3J1bl9jYWxsX29yZGVyX19mYWlsdXJlX2luX3Rlc3Qoc2VsZik6CiAgICAgICAgZXZlbnRzID0gW10KICAgICAgICByZXN1bHQgPSBMb2dnaW5nUmVzdWx0KGV2ZW50cykKCiAgICAgICAgZGVmIHNldFVwKCk6CiAgICAgICAgICAgIGV2ZW50cy5hcHBlbmQoJ3NldFVwJykKCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgZXZlbnRzLmFwcGVuZCgndGVzdCcpCiAgICAgICAgICAgIHNlbGYuZmFpbCgncmFpc2VkIGJ5IHRlc3QnKQoKICAgICAgICBkZWYgdGVhckRvd24oKToKICAgICAgICAgICAgZXZlbnRzLmFwcGVuZCgndGVhckRvd24nKQoKICAgICAgICBleHBlY3RlZCA9IFsnc3RhcnRUZXN0JywgJ3NldFVwJywgJ3Rlc3QnLCAndGVhckRvd24nLAogICAgICAgICAgICAgICAgICAgICdhZGRGYWlsdXJlJywgJ3N0b3BUZXN0J10KICAgICAgICB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKHRlc3QsIHNldFVwLCB0ZWFyRG93bikucnVuKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywgZXhwZWN0ZWQpCgogICAgIyAiV2hlbiBhIHNldFVwKCkgbWV0aG9kIGlzIGRlZmluZWQsIHRoZSB0ZXN0IHJ1bm5lciB3aWxsIHJ1biB0aGF0IG1ldGhvZAogICAgIyBwcmlvciB0byBlYWNoIHRlc3QuIExpa2V3aXNlLCBpZiBhIHRlYXJEb3duKCkgbWV0aG9kIGlzIGRlZmluZWQsIHRoZQogICAgIyB0ZXN0IHJ1bm5lciB3aWxsIGludm9rZSB0aGF0IG1ldGhvZCBhZnRlciBlYWNoIHRlc3QuIEluIHRoZSBleGFtcGxlLAogICAgIyBzZXRVcCgpIHdhcyB1c2VkIHRvIGNyZWF0ZSBhIGZyZXNoIHNlcXVlbmNlIGZvciBlYWNoIHRlc3QuIgogICAgIwogICAgIyBNYWtlIHN1cmUgdGhlIHByb3BlciBjYWxsIG9yZGVyIGlzIG1haW50YWluZWQsIGV2ZW4gaWYgdGVhckRvd24oKSByYWlzZXMKICAgICMgYW4gZXhjZXB0aW9uLgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2Vycm9yX2luX3RlYXJEb3duKHNlbGYpOgogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCgogICAgICAgIGRlZiBzZXRVcCgpOgogICAgICAgICAgICBldmVudHMuYXBwZW5kKCdzZXRVcCcpCgogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIGV2ZW50cy5hcHBlbmQoJ3Rlc3QnKQoKICAgICAgICBkZWYgdGVhckRvd24oKToKICAgICAgICAgICAgZXZlbnRzLmFwcGVuZCgndGVhckRvd24nKQogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoJ3JhaXNlZCBieSB0ZWFyRG93bicpCgogICAgICAgIGV4cGVjdGVkID0gWydzdGFydFRlc3QnLCAnc2V0VXAnLCAndGVzdCcsICd0ZWFyRG93bicsICdhZGRFcnJvcicsCiAgICAgICAgICAgICAgICAgICAgJ3N0b3BUZXN0J10KICAgICAgICB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKHRlc3QsIHNldFVwLCB0ZWFyRG93bikucnVuKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywgZXhwZWN0ZWQpCgogICAgIyAiUmV0dXJuIGEgc3RyaW5nIGlkZW50aWZ5aW5nIHRoZSBzcGVjaWZpYyB0ZXN0IGNhc2UuIgogICAgIwogICAgIyBCZWNhdXNlIG9mIHRoZSB2YWd1ZSBuYXR1cmUgb2YgdGhlIGRvY3MsIEknbSBub3QgZ29pbmcgdG8gbG9jayB0aGlzCiAgICAjIHRlc3QgZG93biB0b28gbXVjaC4gUmVhbGx5IGFsbCB0aGF0IGNhbiBiZSBhc3NlcnRlZCBpcyB0aGF0IHRoZSBpZCgpCiAgICAjIHdpbGwgYmUgYSBzdHJpbmcgKGVpdGhlciA4LWJ5dGUgb3IgdW5pY29kZSAtLSBhZ2FpbiwgYmVjYXVzZSB0aGUgZG9jcwogICAgIyBqdXN0IHNheSAic3RyaW5nIikKICAgIGRlZiB0ZXN0X2lkKHNlbGYpOgogICAgICAgIHRlc3QgPSB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHRlc3QuaWQoKSwgc3RyKQoKICAgICMgIlJldHVybnMgYSBvbmUtbGluZSBkZXNjcmlwdGlvbiBvZiB0aGUgdGVzdCwgb3IgTm9uZSBpZiBubyBkZXNjcmlwdGlvbgogICAgIyBoYXMgYmVlbiBwcm92aWRlZC4gVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBtZXRob2QgcmV0dXJucwogICAgIyB0aGUgZmlyc3QgbGluZSBvZiB0aGUgdGVzdCBtZXRob2QncyBkb2NzdHJpbmcsIGlmIGF2YWlsYWJsZSwgb3IgTm9uZS4iCiAgICBkZWYgdGVzdF9zaG9ydERlc2NyaXB0aW9uX19ub19kb2NzdHJpbmcoc2VsZik6CiAgICAgICAgdGVzdCA9IHVuaXR0ZXN0LkZ1bmN0aW9uVGVzdENhc2UobGFtYmRhOiBOb25lKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHRlc3Quc2hvcnREZXNjcmlwdGlvbigpLCBOb25lKQoKICAgICMgIlJldHVybnMgYSBvbmUtbGluZSBkZXNjcmlwdGlvbiBvZiB0aGUgdGVzdCwgb3IgTm9uZSBpZiBubyBkZXNjcmlwdGlvbgogICAgIyBoYXMgYmVlbiBwcm92aWRlZC4gVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBtZXRob2QgcmV0dXJucwogICAgIyB0aGUgZmlyc3QgbGluZSBvZiB0aGUgdGVzdCBtZXRob2QncyBkb2NzdHJpbmcsIGlmIGF2YWlsYWJsZSwgb3IgTm9uZS4iCiAgICBkZWYgdGVzdF9zaG9ydERlc2NyaXB0aW9uX19zaW5nbGVsaW5lX2RvY3N0cmluZyhzZWxmKToKICAgICAgICBkZXNjID0gInRoaXMgdGVzdHMgZm9vIgogICAgICAgIHRlc3QgPSB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSwgZGVzY3JpcHRpb249ZGVzYykKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCh0ZXN0LnNob3J0RGVzY3JpcHRpb24oKSwgInRoaXMgdGVzdHMgZm9vIikK',
'/Lib/unittest/test/test_loader.py':'aW1wb3J0IHN5cwppbXBvcnQgdHlwZXMKCgppbXBvcnQgdW5pdHRlc3QKCgpjbGFzcyBUZXN0X1Rlc3RMb2FkZXIodW5pdHRlc3QuVGVzdENhc2UpOgoKICAgICMjIyBUZXN0cyBmb3IgVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tVGVzdENhc2UKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAjICJSZXR1cm4gYSBzdWl0ZSBvZiBhbGwgdGVzdHMgY2FzZXMgY29udGFpbmVkIGluIHRoZSBUZXN0Q2FzZS1kZXJpdmVkCiAgICAjIGNsYXNzIHRlc3RDYXNlQ2xhc3MiCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tVGVzdENhc2Uoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8yKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiBmb29fYmFyKHNlbGYpOiBwYXNzCgogICAgICAgIHRlc3RzID0gdW5pdHRlc3QuVGVzdFN1aXRlKFtGb28oJ3Rlc3RfMScpLCBGb28oJ3Rlc3RfMicpXSkKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIubG9hZFRlc3RzRnJvbVRlc3RDYXNlKEZvbyksIHRlc3RzKQoKICAgICMgIlJldHVybiBhIHN1aXRlIG9mIGFsbCB0ZXN0cyBjYXNlcyBjb250YWluZWQgaW4gdGhlIFRlc3RDYXNlLWRlcml2ZWQKICAgICMgY2xhc3MgdGVzdENhc2VDbGFzcyIKICAgICMKICAgICMgTWFrZSBzdXJlIGl0IGRvZXMgdGhlIHJpZ2h0IHRoaW5nIGV2ZW4gaWYgbm8gdGVzdHMgd2VyZSBmb3VuZAogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbVRlc3RDYXNlX19ub19tYXRjaGVzKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBmb29fYmFyKHNlbGYpOiBwYXNzCgogICAgICAgIGVtcHR5X3N1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIubG9hZFRlc3RzRnJvbVRlc3RDYXNlKEZvbyksIGVtcHR5X3N1aXRlKQoKICAgICMgIlJldHVybiBhIHN1aXRlIG9mIGFsbCB0ZXN0cyBjYXNlcyBjb250YWluZWQgaW4gdGhlIFRlc3RDYXNlLWRlcml2ZWQKICAgICMgY2xhc3MgdGVzdENhc2VDbGFzcyIKICAgICMKICAgICMgV2hhdCBoYXBwZW5zIGlmIGxvYWRUZXN0c0Zyb21UZXN0Q2FzZSgpIGlzIGdpdmVuIGFuIG9iamVjdAogICAgIyB0aGF0IGlzbid0IGEgc3ViY2xhc3Mgb2YgVGVzdENhc2U/IFNwZWNpZmljYWxseSwgd2hhdCBoYXBwZW5zCiAgICAjIGlmIHRlc3RDYXNlQ2xhc3MgaXMgYSBzdWJjbGFzcyBvZiBUZXN0U3VpdGU/CiAgICAjCiAgICAjIFRoaXMgaXMgY2hlY2tlZCBmb3Igc3BlY2lmaWNhbGx5IGluIHRoZSBjb2RlLCBzbyB3ZSBiZXR0ZXIgYWRkIGEKICAgICMgdGVzdCBmb3IgaXQuCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tVGVzdENhc2VfX1Rlc3RTdWl0ZV9zdWJjbGFzcyhzZWxmKToKICAgICAgICBjbGFzcyBOb3RBVGVzdENhc2UodW5pdHRlc3QuVGVzdFN1aXRlKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tVGVzdENhc2UoTm90QVRlc3RDYXNlKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoJ1Nob3VsZCByYWlzZSBUeXBlRXJyb3InKQoKICAgICMgIlJldHVybiBhIHN1aXRlIG9mIGFsbCB0ZXN0cyBjYXNlcyBjb250YWluZWQgaW4gdGhlIFRlc3RDYXNlLWRlcml2ZWQKICAgICMgY2xhc3MgdGVzdENhc2VDbGFzcyIKICAgICMKICAgICMgTWFrZSBzdXJlIGxvYWRUZXN0c0Zyb21UZXN0Q2FzZSgpIHBpY2tzIHVwIHRoZSBkZWZhdWx0IHRlc3QgbWV0aG9kCiAgICAjIG5hbWUgKGFzIHNwZWNpZmllZCBieSBUZXN0Q2FzZSksIGV2ZW4gdGhvdWdoIHRoZSBtZXRob2QgbmFtZSBkb2VzCiAgICAjIG5vdCBtYXRjaCB0aGUgZGVmYXVsdCBUZXN0TG9hZGVyLnRlc3RNZXRob2RQcmVmaXggc3RyaW5nCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tVGVzdENhc2VfX2RlZmF1bHRfbWV0aG9kX25hbWUoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHJ1blRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgICMgVGhpcyBoYXMgdG8gYmUgZmFsc2UgZm9yIHRoZSB0ZXN0IHRvIHN1Y2NlZWQKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKCdydW5UZXN0Jy5zdGFydHN3aXRoKGxvYWRlci50ZXN0TWV0aG9kUHJlZml4KSkKCiAgICAgICAgc3VpdGUgPSBsb2FkZXIubG9hZFRlc3RzRnJvbVRlc3RDYXNlKEZvbykKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFtGb28oJ3J1blRlc3QnKV0pCgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgIyMjIC9UZXN0cyBmb3IgVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tVGVzdENhc2UKCiAgICAjIyMgVGVzdHMgZm9yIFRlc3RMb2FkZXIubG9hZFRlc3RzRnJvbU1vZHVsZQogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgICMgIlRoaXMgbWV0aG9kIHNlYXJjaGVzIGBtb2R1bGVgIGZvciBjbGFzc2VzIGRlcml2ZWQgZnJvbSBUZXN0Q2FzZSIKICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21Nb2R1bGVfX1Rlc3RDYXNlX3N1YmNsYXNzKHNlbGYpOgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBNeVRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgbS50ZXN0Y2FzZV8xID0gTXlUZXN0Q2FzZQoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTW9kdWxlKG0pCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHN1aXRlLCBsb2FkZXIuc3VpdGVDbGFzcykKCiAgICAgICAgZXhwZWN0ZWQgPSBbbG9hZGVyLnN1aXRlQ2xhc3MoW015VGVzdENhc2UoJ3Rlc3QnKV0pXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIGV4cGVjdGVkKQoKICAgICMgIlRoaXMgbWV0aG9kIHNlYXJjaGVzIGBtb2R1bGVgIGZvciBjbGFzc2VzIGRlcml2ZWQgZnJvbSBUZXN0Q2FzZSIKICAgICMKICAgICMgV2hhdCBoYXBwZW5zIGlmIG5vIHRlc3RzIGFyZSBmb3VuZCAobm8gVGVzdENhc2UgaW5zdGFuY2VzKT8KICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21Nb2R1bGVfX25vX1Rlc3RDYXNlX2luc3RhbmNlcyhzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21Nb2R1bGUobSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFtdKQoKICAgICMgIlRoaXMgbWV0aG9kIHNlYXJjaGVzIGBtb2R1bGVgIGZvciBjbGFzc2VzIGRlcml2ZWQgZnJvbSBUZXN0Q2FzZSIKICAgICMKICAgICMgV2hhdCBoYXBwZW5zIGlmIG5vIHRlc3RzIGFyZSBmb3VuZCAoVGVzdENhc2VzIGluc3RhbmNlcywgYnV0IG5vIHRlc3RzKT8KICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21Nb2R1bGVfX25vX1Rlc3RDYXNlX3Rlc3RzKHNlbGYpOgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBNeVRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgcGFzcwogICAgICAgIG0udGVzdGNhc2VfMSA9IE15VGVzdENhc2UKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgc3VpdGUgPSBsb2FkZXIubG9hZFRlc3RzRnJvbU1vZHVsZShtKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShzdWl0ZSwgbG9hZGVyLnN1aXRlQ2xhc3MpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFtsb2FkZXIuc3VpdGVDbGFzcygpXSkKCiAgICAjICJUaGlzIG1ldGhvZCBzZWFyY2hlcyBgbW9kdWxlYCBmb3IgY2xhc3NlcyBkZXJpdmVkIGZyb20gVGVzdENhc2UicwogICAgIwogICAgIyBXaGF0IGhhcHBlbnMgaWYgbG9hZFRlc3RzRnJvbU1vZHVsZSgpIGlzIGdpdmVuIHNvbWV0aGluZyBvdGhlcgogICAgIyB0aGFuIGEgbW9kdWxlPwogICAgIwogICAgIyBYWFggQ3VycmVudGx5LCBpdCBzdWNjZWVkcyBhbnl3YXkuIFRoaXMgZmxleGliaWxpdHkKICAgICMgc2hvdWxkIGVpdGhlciBiZSBkb2N1bWVudGVkIG9yIGxvYWRUZXN0c0Zyb21Nb2R1bGUoKSBzaG91bGQKICAgICMgcmFpc2UgYSBUeXBlRXJyb3IKICAgICMKICAgICMgWFhYIENlcnRhaW4gcGVvcGxlIGFyZSB1c2luZyB0aGlzIGJlaGF2aW91ci4gV2UnbGwgYWRkIGEgdGVzdCBmb3IgaXQKICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21Nb2R1bGVfX25vdF9hX21vZHVsZShzZWxmKToKICAgICAgICBjbGFzcyBNeVRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIGNsYXNzIE5vdEFNb2R1bGUob2JqZWN0KToKICAgICAgICAgICAgdGVzdF8yID0gTXlUZXN0Q2FzZQoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTW9kdWxlKE5vdEFNb2R1bGUpCgogICAgICAgIHJlZmVyZW5jZSA9IFt1bml0dGVzdC5UZXN0U3VpdGUoW015VGVzdENhc2UoJ3Rlc3QnKV0pXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIHJlZmVyZW5jZSkKCgogICAgIyBDaGVjayB0aGF0IGxvYWRUZXN0c0Zyb21Nb2R1bGUgaG9ub3JzIChvciBub3QpIGEgbW9kdWxlCiAgICAjIHdpdGggYSBsb2FkX3Rlc3RzIGZ1bmN0aW9uLgogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU1vZHVsZV9fbG9hZF90ZXN0cyhzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgTXlUZXN0Q2FzZSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIG0udGVzdGNhc2VfMSA9IE15VGVzdENhc2UKCiAgICAgICAgbG9hZF90ZXN0c19hcmdzID0gW10KICAgICAgICBkZWYgbG9hZF90ZXN0cyhsb2FkZXIsIHRlc3RzLCBwYXR0ZXJuKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHRlc3RzLCB1bml0dGVzdC5UZXN0U3VpdGUpCiAgICAgICAgICAgIGxvYWRfdGVzdHNfYXJncy5leHRlbmQoKGxvYWRlciwgdGVzdHMsIHBhdHRlcm4pKQogICAgICAgICAgICByZXR1cm4gdGVzdHMKICAgICAgICBtLmxvYWRfdGVzdHMgPSBsb2FkX3Rlc3RzCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21Nb2R1bGUobSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIHVuaXR0ZXN0LlRlc3RTdWl0ZSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxvYWRfdGVzdHNfYXJncywgW2xvYWRlciwgc3VpdGUsIE5vbmVdKQoKICAgICAgICBsb2FkX3Rlc3RzX2FyZ3MgPSBbXQogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21Nb2R1bGUobSwgdXNlX2xvYWRfdGVzdHM9RmFsc2UpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkX3Rlc3RzX2FyZ3MsIFtdKQoKICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21Nb2R1bGVfX2ZhdWx0eV9sb2FkX3Rlc3RzKHNlbGYpOgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKCiAgICAgICAgZGVmIGxvYWRfdGVzdHMobG9hZGVyLCB0ZXN0cywgcGF0dGVybik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcignc29tZSBmYWlsdXJlJykKICAgICAgICBtLmxvYWRfdGVzdHMgPSBsb2FkX3Rlc3RzCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21Nb2R1bGUobSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIHVuaXR0ZXN0LlRlc3RTdWl0ZSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN1aXRlLmNvdW50VGVzdENhc2VzKCksIDEpCiAgICAgICAgdGVzdCA9IGxpc3Qoc3VpdGUpWzBdCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzUmVnZXgoVHlwZUVycm9yLCAic29tZSBmYWlsdXJlIiwgdGVzdC5tKQoKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgICMjIyAvVGVzdHMgZm9yIFRlc3RMb2FkZXIubG9hZFRlc3RzRnJvbU1vZHVsZSgpCgogICAgIyMjIFRlc3RzIGZvciBUZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCkKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSBlaXRoZXIgdG8KICAgICMgYSBtb2R1bGUsIGEgdGVzdCBjYXNlIGNsYXNzLCBhIFRlc3RTdWl0ZSBpbnN0YW5jZSwgYSB0ZXN0IG1ldGhvZAogICAgIyB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MsIG9yIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYQogICAgIyBUZXN0Q2FzZSBvciBUZXN0U3VpdGUgaW5zdGFuY2UuIgogICAgIwogICAgIyBJcyBWYWx1ZUVycm9yIHJhaXNlZCBpbiByZXNwb25zZSB0byBhbiBlbXB0eSBuYW1lPwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX2VtcHR5X25hbWUoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCgogICAgICAgIHRyeToKICAgICAgICAgICAgbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCcnKQogICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yIGFzIGU6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGUpLCAiRW1wdHkgbW9kdWxlIG5hbWUiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSBmYWlsZWQgdG8gcmFpc2UgVmFsdWVFcnJvciIpCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgZWl0aGVyIHRvCiAgICAjIGEgbW9kdWxlLCBhIHRlc3QgY2FzZSBjbGFzcywgYSBUZXN0U3VpdGUgaW5zdGFuY2UsIGEgdGVzdCBtZXRob2QKICAgICMgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzLCBvciBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEKICAgICMgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlLiIKICAgICMKICAgICMgV2hhdCBoYXBwZW5zIHdoZW4gdGhlIG5hbWUgY29udGFpbnMgaW52YWxpZCBjaGFyYWN0ZXJzPwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX21hbGZvcm1lZF9uYW1lKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICAjIFhYWCBTaG91bGQgdGhpcyByYWlzZSBWYWx1ZUVycm9yIG9yIEltcG9ydEVycm9yPwogICAgICAgIHRyeToKICAgICAgICAgICAgbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCdhYmMgKCkgLy8nKQogICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICBwYXNzCiAgICAgICAgZXhjZXB0IEltcG9ydEVycm9yOgogICAgICAgICAgICBwYXNzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCJUZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lIGZhaWxlZCB0byByYWlzZSBWYWx1ZUVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSAuLi4gdG8gYQogICAgIyBtb2R1bGUiCiAgICAjCiAgICAjIFdoYXQgaGFwcGVucyB3aGVuIGEgbW9kdWxlIGJ5IHRoYXQgbmFtZSBjYW4ndCBiZSBmb3VuZD8KICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21OYW1lX191bmtub3duX21vZHVsZV9uYW1lKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSgnc2Rhc2Zhc2Zhc2RmJykKICAgICAgICBleGNlcHQgSW1wb3J0RXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIoZSksICJObyBtb2R1bGUgbmFtZWQgJ3NkYXNmYXNmYXNkZiciKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSBmYWlsZWQgdG8gcmFpc2UgSW1wb3J0RXJyb3IiKQoKICAgICMgIlRoZSBzcGVjaWZpZXIgbmFtZSBpcyBhIGBgZG90dGVkIG5hbWUnJyB0aGF0IG1heSByZXNvbHZlIGVpdGhlciB0bwogICAgIyBhIG1vZHVsZSwgYSB0ZXN0IGNhc2UgY2xhc3MsIGEgVGVzdFN1aXRlIGluc3RhbmNlLCBhIHRlc3QgbWV0aG9kCiAgICAjIHdpdGhpbiBhIHRlc3QgY2FzZSBjbGFzcywgb3IgYSBjYWxsYWJsZSBvYmplY3Qgd2hpY2ggcmV0dXJucyBhCiAgICAjIFRlc3RDYXNlIG9yIFRlc3RTdWl0ZSBpbnN0YW5jZS4iCiAgICAjCiAgICAjIFdoYXQgaGFwcGVucyB3aGVuIHRoZSBtb2R1bGUgaXMgZm91bmQsIGJ1dCB0aGUgYXR0cmlidXRlIGNhbid0PwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX3Vua25vd25fYXR0cl9uYW1lKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSgndW5pdHRlc3Quc2Rhc2Zhc2Zhc2RmJykKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIoZSksICInbW9kdWxlJyBvYmplY3QgaGFzIG5vIGF0dHJpYnV0ZSAnc2Rhc2Zhc2Zhc2RmJyIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCJUZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lIGZhaWxlZCB0byByYWlzZSBBdHRyaWJ1dGVFcnJvciIpCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgZWl0aGVyIHRvCiAgICAjIGEgbW9kdWxlLCBhIHRlc3QgY2FzZSBjbGFzcywgYSBUZXN0U3VpdGUgaW5zdGFuY2UsIGEgdGVzdCBtZXRob2QKICAgICMgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzLCBvciBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEKICAgICMgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlLiIKICAgICMKICAgICMgV2hhdCBoYXBwZW5zIHdoZW4gd2UgcHJvdmlkZSB0aGUgbW9kdWxlLCBidXQgdGhlIGF0dHJpYnV0ZSBjYW4ndCBiZQogICAgIyBmb3VuZD8KICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21OYW1lX19yZWxhdGl2ZV91bmtub3duX25hbWUoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCgogICAgICAgIHRyeToKICAgICAgICAgICAgbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCdzZGFzZmFzZmFzZGYnLCB1bml0dGVzdCkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIoZSksICInbW9kdWxlJyBvYmplY3QgaGFzIG5vIGF0dHJpYnV0ZSAnc2Rhc2Zhc2Zhc2RmJyIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCJUZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lIGZhaWxlZCB0byByYWlzZSBBdHRyaWJ1dGVFcnJvciIpCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgZWl0aGVyIHRvCiAgICAjIGEgbW9kdWxlLCBhIHRlc3QgY2FzZSBjbGFzcywgYSBUZXN0U3VpdGUgaW5zdGFuY2UsIGEgdGVzdCBtZXRob2QKICAgICMgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzLCBvciBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEKICAgICMgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlLiIKICAgICMgLi4uCiAgICAjICJUaGUgbWV0aG9kIG9wdGlvbmFsbHkgcmVzb2x2ZXMgbmFtZSByZWxhdGl2ZSB0byB0aGUgZ2l2ZW4gbW9kdWxlIgogICAgIwogICAgIyBEb2VzIGxvYWRUZXN0c0Zyb21OYW1lIHJhaXNlIFZhbHVlRXJyb3Igd2hlbiBwYXNzZWQgYW4gZW1wdHkKICAgICMgbmFtZSByZWxhdGl2ZSB0byBhIHByb3ZpZGVkIG1vZHVsZT8KICAgICMKICAgICMgWFhYIFNob3VsZCBwcm9iYWJseSByYWlzZSBhIFZhbHVlRXJyb3IgaW5zdGVhZCBvZiBhbiBBdHRyaWJ1dGVFcnJvcgogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX3JlbGF0aXZlX2VtcHR5X25hbWUoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCgogICAgICAgIHRyeToKICAgICAgICAgICAgbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCcnLCB1bml0dGVzdCkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3IgYXMgZToKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiRmFpbGVkIHRvIHJhaXNlIEF0dHJpYnV0ZUVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSBlaXRoZXIgdG8KICAgICMgYSBtb2R1bGUsIGEgdGVzdCBjYXNlIGNsYXNzLCBhIFRlc3RTdWl0ZSBpbnN0YW5jZSwgYSB0ZXN0IG1ldGhvZAogICAgIyB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MsIG9yIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYQogICAgIyBUZXN0Q2FzZSBvciBUZXN0U3VpdGUgaW5zdGFuY2UuIgogICAgIyAuLi4KICAgICMgIlRoZSBtZXRob2Qgb3B0aW9uYWxseSByZXNvbHZlcyBuYW1lIHJlbGF0aXZlIHRvIHRoZSBnaXZlbiBtb2R1bGUiCiAgICAjCiAgICAjIFdoYXQgaGFwcGVucyB3aGVuIGFuIGltcG9zc2libGUgbmFtZSBpcyBnaXZlbiwgcmVsYXRpdmUgdG8gdGhlIHByb3ZpZGVkCiAgICAjIGBtb2R1bGVgPwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX3JlbGF0aXZlX21hbGZvcm1lZF9uYW1lKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICAjIFhYWCBTaG91bGQgdGhpcyByYWlzZSBBdHRyaWJ1dGVFcnJvciBvciBWYWx1ZUVycm9yPwogICAgICAgIHRyeToKICAgICAgICAgICAgbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCdhYmMgKCkgLy8nLCB1bml0dGVzdCkKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSBmYWlsZWQgdG8gcmFpc2UgVmFsdWVFcnJvciIpCgogICAgIyAiVGhlIG1ldGhvZCBvcHRpb25hbGx5IHJlc29sdmVzIG5hbWUgcmVsYXRpdmUgdG8gdGhlIGdpdmVuIG1vZHVsZSIKICAgICMKICAgICMgRG9lcyBsb2FkVGVzdHNGcm9tTmFtZSByYWlzZSBUeXBlRXJyb3Igd2hlbiB0aGUgYG1vZHVsZWAgYXJndW1lbnQKICAgICMgaXNuJ3QgYSBtb2R1bGUgb2JqZWN0PwogICAgIwogICAgIyBYWFggQWNjZXB0cyB0aGUgbm90LWEtbW9kdWxlIG9iamVjdCwgaWdub3JuaW5nIHRoZSBvYmplY3QncyB0eXBlCiAgICAjIFRoaXMgc2hvdWxkIHJhaXNlIGFuIGV4Y2VwdGlvbiBvciB0aGUgbWV0aG9kIG5hbWUgc2hvdWxkIGJlIGNoYW5nZWQKICAgICMKICAgICMgWFhYIFNvbWUgcGVvcGxlIGFyZSByZWx5aW5nIG9uIHRoaXMsIHNvIGtlZXAgaXQgZm9yIG5vdwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX3JlbGF0aXZlX25vdF9hX21vZHVsZShzZWxmKToKICAgICAgICBjbGFzcyBNeVRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIGNsYXNzIE5vdEFNb2R1bGUob2JqZWN0KToKICAgICAgICAgICAgdGVzdF8yID0gTXlUZXN0Q2FzZQoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSgndGVzdF8yJywgTm90QU1vZHVsZSkKCiAgICAgICAgcmVmZXJlbmNlID0gW015VGVzdENhc2UoJ3Rlc3QnKV0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3Qoc3VpdGUpLCByZWZlcmVuY2UpCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgZWl0aGVyIHRvCiAgICAjIGEgbW9kdWxlLCBhIHRlc3QgY2FzZSBjbGFzcywgYSBUZXN0U3VpdGUgaW5zdGFuY2UsIGEgdGVzdCBtZXRob2QKICAgICMgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzLCBvciBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEKICAgICMgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlLiIKICAgICMKICAgICMgRG9lcyBpdCByYWlzZSBhbiBleGNlcHRpb24gaWYgdGhlIG5hbWUgcmVzb2x2ZXMgdG8gYW4gaW52YWxpZAogICAgIyBvYmplY3Q/CiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZV9fcmVsYXRpdmVfYmFkX29iamVjdChzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgbS50ZXN0Y2FzZV8xID0gb2JqZWN0KCkKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUoJ3Rlc3RjYXNlXzEnLCBtKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIlNob3VsZCBoYXZlIHJhaXNlZCBUeXBlRXJyb3IiKQoKICAgICMgIlRoZSBzcGVjaWZpZXIgbmFtZSBpcyBhIGBgZG90dGVkIG5hbWUnJyB0aGF0IG1heQogICAgIyByZXNvbHZlIGVpdGhlciB0byAuLi4gYSB0ZXN0IGNhc2UgY2xhc3MiCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZV9fcmVsYXRpdmVfVGVzdENhc2Vfc3ViY2xhc3Moc2VsZik6CiAgICAgICAgbSA9IHR5cGVzLk1vZHVsZVR5cGUoJ20nKQogICAgICAgIGNsYXNzIE15VGVzdENhc2UodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICBtLnRlc3RjYXNlXzEgPSBNeVRlc3RDYXNlCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCd0ZXN0Y2FzZV8xJywgbSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFtNeVRlc3RDYXNlKCd0ZXN0JyldKQoKICAgICMgIlRoZSBzcGVjaWZpZXIgbmFtZSBpcyBhIGBgZG90dGVkIG5hbWUnJyB0aGF0IG1heSByZXNvbHZlIGVpdGhlciB0bwogICAgIyBhIG1vZHVsZSwgYSB0ZXN0IGNhc2UgY2xhc3MsIGEgVGVzdFN1aXRlIGluc3RhbmNlLCBhIHRlc3QgbWV0aG9kCiAgICAjIHdpdGhpbiBhIHRlc3QgY2FzZSBjbGFzcywgb3IgYSBjYWxsYWJsZSBvYmplY3Qgd2hpY2ggcmV0dXJucyBhCiAgICAjIFRlc3RDYXNlIG9yIFRlc3RTdWl0ZSBpbnN0YW5jZS4iCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZV9fcmVsYXRpdmVfVGVzdFN1aXRlKHNlbGYpOgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBNeVRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgbS50ZXN0c3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoW015VGVzdENhc2UoJ3Rlc3QnKV0pCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCd0ZXN0c3VpdGUnLCBtKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShzdWl0ZSwgbG9hZGVyLnN1aXRlQ2xhc3MpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFtNeVRlc3RDYXNlKCd0ZXN0JyldKQoKICAgICMgIlRoZSBzcGVjaWZpZXIgbmFtZSBpcyBhIGBgZG90dGVkIG5hbWUnJyB0aGF0IG1heSByZXNvbHZlIC4uLiB0bwogICAgIyAuLi4gYSB0ZXN0IG1ldGhvZCB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MiCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZV9fcmVsYXRpdmVfdGVzdG1ldGhvZChzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgTXlUZXN0Q2FzZSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIG0udGVzdGNhc2VfMSA9IE15VGVzdENhc2UKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgc3VpdGUgPSBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUoJ3Rlc3RjYXNlXzEudGVzdCcsIG0pCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHN1aXRlLCBsb2FkZXIuc3VpdGVDbGFzcykKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KHN1aXRlKSwgW015VGVzdENhc2UoJ3Rlc3QnKV0pCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgZWl0aGVyIHRvCiAgICAjIGEgbW9kdWxlLCBhIHRlc3QgY2FzZSBjbGFzcywgYSBUZXN0U3VpdGUgaW5zdGFuY2UsIGEgdGVzdCBtZXRob2QKICAgICMgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzLCBvciBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEKICAgICMgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlLiIKICAgICMKICAgICMgRG9lcyBsb2FkVGVzdHNGcm9tTmFtZSgpIHJhaXNlIHRoZSBwcm9wZXIgZXhjZXB0aW9uIHdoZW4gdHJ5aW5nIHRvCiAgICAjIHJlc29sdmUgImEgdGVzdCBtZXRob2Qgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzIiB0aGF0IGRvZXNuJ3QgZXhpc3QKICAgICMgZm9yIHRoZSBnaXZlbiBuYW1lIChyZWxhdGl2ZSB0byBhIHByb3ZpZGVkIG1vZHVsZSk/CiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZV9fcmVsYXRpdmVfaW52YWxpZF90ZXN0bWV0aG9kKHNlbGYpOgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBNeVRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgbS50ZXN0Y2FzZV8xID0gTXlUZXN0Q2FzZQoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSgndGVzdGNhc2VfMS50ZXN0Zm9vJywgbSkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIoZSksICJ0eXBlIG9iamVjdCAnTXlUZXN0Q2FzZScgaGFzIG5vIGF0dHJpYnV0ZSAndGVzdGZvbyciKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiRmFpbGVkIHRvIHJhaXNlIEF0dHJpYnV0ZUVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSAuLi4gdG8KICAgICMgLi4uIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYSAuLi4gVGVzdFN1aXRlIGluc3RhbmNlIgogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX2NhbGxhYmxlX19UZXN0U3VpdGUoc2VsZik6CiAgICAgICAgbSA9IHR5cGVzLk1vZHVsZVR5cGUoJ20nKQogICAgICAgIHRlc3RjYXNlXzEgPSB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKICAgICAgICB0ZXN0Y2FzZV8yID0gdW5pdHRlc3QuRnVuY3Rpb25UZXN0Q2FzZShsYW1iZGE6IE5vbmUpCiAgICAgICAgZGVmIHJldHVybl9UZXN0U3VpdGUoKToKICAgICAgICAgICAgcmV0dXJuIHVuaXR0ZXN0LlRlc3RTdWl0ZShbdGVzdGNhc2VfMSwgdGVzdGNhc2VfMl0pCiAgICAgICAgbS5yZXR1cm5fVGVzdFN1aXRlID0gcmV0dXJuX1Rlc3RTdWl0ZQoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSgncmV0dXJuX1Rlc3RTdWl0ZScsIG0pCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHN1aXRlLCBsb2FkZXIuc3VpdGVDbGFzcykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3Qoc3VpdGUpLCBbdGVzdGNhc2VfMSwgdGVzdGNhc2VfMl0pCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgLi4uIHRvCiAgICAjIC4uLiBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEgVGVzdENhc2UgLi4uIGluc3RhbmNlIgogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX2NhbGxhYmxlX19UZXN0Q2FzZV9pbnN0YW5jZShzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgdGVzdGNhc2VfMSA9IHVuaXR0ZXN0LkZ1bmN0aW9uVGVzdENhc2UobGFtYmRhOiBOb25lKQogICAgICAgIGRlZiByZXR1cm5fVGVzdENhc2UoKToKICAgICAgICAgICAgcmV0dXJuIHRlc3RjYXNlXzEKICAgICAgICBtLnJldHVybl9UZXN0Q2FzZSA9IHJldHVybl9UZXN0Q2FzZQoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSgncmV0dXJuX1Rlc3RDYXNlJywgbSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFt0ZXN0Y2FzZV8xXSkKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSAuLi4gdG8KICAgICMgLi4uIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYSBUZXN0Q2FzZSAuLi4gaW5zdGFuY2UiCiAgICAjKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICAgICNPdmVycmlkZSB0aGUgc3VpdGVDbGFzcyBhdHRyaWJ1dGUgdG8gZW5zdXJlIHRoYXQgdGhlIHN1aXRlQ2xhc3MKICAgICNhdHRyaWJ1dGUgaXMgdXNlZAogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX2NhbGxhYmxlX19UZXN0Q2FzZV9pbnN0YW5jZV9Qcm9wZXJTdWl0ZUNsYXNzKHNlbGYpOgogICAgICAgIGNsYXNzIFN1YlRlc3RTdWl0ZSh1bml0dGVzdC5UZXN0U3VpdGUpOgogICAgICAgICAgICBwYXNzCiAgICAgICAgbSA9IHR5cGVzLk1vZHVsZVR5cGUoJ20nKQogICAgICAgIHRlc3RjYXNlXzEgPSB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKICAgICAgICBkZWYgcmV0dXJuX1Rlc3RDYXNlKCk6CiAgICAgICAgICAgIHJldHVybiB0ZXN0Y2FzZV8xCiAgICAgICAgbS5yZXR1cm5fVGVzdENhc2UgPSByZXR1cm5fVGVzdENhc2UKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnN1aXRlQ2xhc3MgPSBTdWJUZXN0U3VpdGUKICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSgncmV0dXJuX1Rlc3RDYXNlJywgbSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFt0ZXN0Y2FzZV8xXSkKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSAuLi4gdG8KICAgICMgLi4uIGEgdGVzdCBtZXRob2Qgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzIgogICAgIyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAgICAjT3ZlcnJpZGUgdGhlIHN1aXRlQ2xhc3MgYXR0cmlidXRlIHRvIGVuc3VyZSB0aGF0IHRoZSBzdWl0ZUNsYXNzCiAgICAjYXR0cmlidXRlIGlzIHVzZWQKICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21OYW1lX19yZWxhdGl2ZV90ZXN0bWV0aG9kX1Byb3BlclN1aXRlQ2xhc3Moc2VsZik6CiAgICAgICAgY2xhc3MgU3ViVGVzdFN1aXRlKHVuaXR0ZXN0LlRlc3RTdWl0ZSk6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgTXlUZXN0Q2FzZSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIG0udGVzdGNhc2VfMSA9IE15VGVzdENhc2UKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnN1aXRlQ2xhc3M9U3ViVGVzdFN1aXRlCiAgICAgICAgc3VpdGUgPSBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUoJ3Rlc3RjYXNlXzEudGVzdCcsIG0pCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHN1aXRlLCBsb2FkZXIuc3VpdGVDbGFzcykKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KHN1aXRlKSwgW015VGVzdENhc2UoJ3Rlc3QnKV0pCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgLi4uIHRvCiAgICAjIC4uLiBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlIgogICAgIwogICAgIyBXaGF0IGhhcHBlbnMgaWYgdGhlIGNhbGxhYmxlIHJldHVybnMgc29tZXRoaW5nIGVsc2U/CiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZV9fY2FsbGFibGVfX3dyb25nX3R5cGUoc2VsZik6CiAgICAgICAgbSA9IHR5cGVzLk1vZHVsZVR5cGUoJ20nKQogICAgICAgIGRlZiByZXR1cm5fd3JvbmcoKToKICAgICAgICAgICAgcmV0dXJuIDYKICAgICAgICBtLnJldHVybl93cm9uZyA9IHJldHVybl93cm9uZwoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCdyZXR1cm5fd3JvbmcnLCBtKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIlRlc3RMb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUgZmFpbGVkIHRvIHJhaXNlIFR5cGVFcnJvciIpCgogICAgIyAiVGhlIHNwZWNpZmllciBjYW4gcmVmZXIgdG8gbW9kdWxlcyBhbmQgcGFja2FnZXMgd2hpY2ggaGF2ZSBub3QgYmVlbgogICAgIyBpbXBvcnRlZDsgdGhleSB3aWxsIGJlIGltcG9ydGVkIGFzIGEgc2lkZS1lZmZlY3QiCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZV9fbW9kdWxlX25vdF9sb2FkZWQoc2VsZik6CiAgICAgICAgIyBXZSdyZSBnb2luZyB0byB0cnkgdG8gbG9hZCB0aGlzIG1vZHVsZSBhcyBhIHNpZGUtZWZmZWN0LCBzbyBpdAogICAgICAgICMgYmV0dGVyIG5vdCBiZSBsb2FkZWQgYmVmb3JlIHdlIHRyeS4KICAgICAgICAjCiAgICAgICAgbW9kdWxlX25hbWUgPSAndW5pdHRlc3QudGVzdC5kdW1teScKICAgICAgICBzeXMubW9kdWxlcy5wb3AobW9kdWxlX25hbWUsIE5vbmUpCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHRyeToKICAgICAgICAgICAgc3VpdGUgPSBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUobW9kdWxlX25hbWUpCgogICAgICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3Qoc3VpdGUpLCBbXSkKCiAgICAgICAgICAgICMgbW9kdWxlIHNob3VsZCBub3cgYmUgbG9hZGVkLCB0aGFua3MgdG8gbG9hZFRlc3RzRnJvbU5hbWUoKQogICAgICAgICAgICBzZWxmLmFzc2VydEluKG1vZHVsZV9uYW1lLCBzeXMubW9kdWxlcykKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBpZiBtb2R1bGVfbmFtZSBpbiBzeXMubW9kdWxlczoKICAgICAgICAgICAgICAgIGRlbCBzeXMubW9kdWxlc1ttb2R1bGVfbmFtZV0KCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiAgICAjIyMgVGVzdHMgZm9yIFRlc3RMb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUoKQoKICAgICMjIyBUZXN0cyBmb3IgVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoKQogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgICMgIlNpbWlsYXIgdG8gbG9hZFRlc3RzRnJvbU5hbWUoKSwgYnV0IHRha2VzIGEgc2VxdWVuY2Ugb2YgbmFtZXMgcmF0aGVyCiAgICAjIHRoYW4gYSBzaW5nbGUgbmFtZS4iCiAgICAjCiAgICAjIFdoYXQgaGFwcGVucyBpZiB0aGF0IHNlcXVlbmNlIG9mIG5hbWVzIGlzIGVtcHR5PwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX19lbXB0eV9uYW1lX2xpc3Qoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCgogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbXSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFtdKQoKICAgICMgIlNpbWlsYXIgdG8gbG9hZFRlc3RzRnJvbU5hbWUoKSwgYnV0IHRha2VzIGEgc2VxdWVuY2Ugb2YgbmFtZXMgcmF0aGVyCiAgICAjIHRoYW4gYSBzaW5nbGUgbmFtZS4iCiAgICAjIC4uLgogICAgIyAiVGhlIG1ldGhvZCBvcHRpb25hbGx5IHJlc29sdmVzIG5hbWUgcmVsYXRpdmUgdG8gdGhlIGdpdmVuIG1vZHVsZSIKICAgICMKICAgICMgV2hhdCBoYXBwZW5zIGlmIHRoYXQgc2VxdWVuY2Ugb2YgbmFtZXMgaXMgZW1wdHk/CiAgICAjCiAgICAjIFhYWCBTaG91bGQgdGhpcyByYWlzZSBhIFZhbHVlRXJyb3Igb3IganVzdCByZXR1cm4gYW4gZW1wdHkgVGVzdFN1aXRlPwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX19yZWxhdGl2ZV9lbXB0eV9uYW1lX2xpc3Qoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCgogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbXSwgdW5pdHRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHN1aXRlLCBsb2FkZXIuc3VpdGVDbGFzcykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3Qoc3VpdGUpLCBbXSkKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSBlaXRoZXIgdG8KICAgICMgYSBtb2R1bGUsIGEgdGVzdCBjYXNlIGNsYXNzLCBhIFRlc3RTdWl0ZSBpbnN0YW5jZSwgYSB0ZXN0IG1ldGhvZAogICAgIyB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MsIG9yIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYQogICAgIyBUZXN0Q2FzZSBvciBUZXN0U3VpdGUgaW5zdGFuY2UuIgogICAgIwogICAgIyBJcyBWYWx1ZUVycm9yIHJhaXNlZCBpbiByZXNwb25zZSB0byBhbiBlbXB0eSBuYW1lPwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX19lbXB0eV9uYW1lKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoWycnXSkKICAgICAgICBleGNlcHQgVmFsdWVFcnJvciBhcyBlOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN0cihlKSwgIkVtcHR5IG1vZHVsZSBuYW1lIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIlRlc3RMb2FkZXIubG9hZFRlc3RzRnJvbU5hbWVzIGZhaWxlZCB0byByYWlzZSBWYWx1ZUVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSBlaXRoZXIgdG8KICAgICMgYSBtb2R1bGUsIGEgdGVzdCBjYXNlIGNsYXNzLCBhIFRlc3RTdWl0ZSBpbnN0YW5jZSwgYSB0ZXN0IG1ldGhvZAogICAgIyB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MsIG9yIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYQogICAgIyBUZXN0Q2FzZSBvciBUZXN0U3VpdGUgaW5zdGFuY2UuIgogICAgIwogICAgIyBXaGF0IGhhcHBlbnMgd2hlbiBwcmVzZW50ZWQgd2l0aCBhbiBpbXBvc3NpYmxlIG1vZHVsZSBuYW1lPwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX19tYWxmb3JtZWRfbmFtZShzZWxmKToKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgIyBYWFggU2hvdWxkIHRoaXMgcmFpc2UgVmFsdWVFcnJvciBvciBJbXBvcnRFcnJvcj8KICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoWydhYmMgKCkgLy8nXSkKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMgZmFpbGVkIHRvIHJhaXNlIFZhbHVlRXJyb3IiKQoKICAgICMgIlRoZSBzcGVjaWZpZXIgbmFtZSBpcyBhIGBgZG90dGVkIG5hbWUnJyB0aGF0IG1heSByZXNvbHZlIGVpdGhlciB0bwogICAgIyBhIG1vZHVsZSwgYSB0ZXN0IGNhc2UgY2xhc3MsIGEgVGVzdFN1aXRlIGluc3RhbmNlLCBhIHRlc3QgbWV0aG9kCiAgICAjIHdpdGhpbiBhIHRlc3QgY2FzZSBjbGFzcywgb3IgYSBjYWxsYWJsZSBvYmplY3Qgd2hpY2ggcmV0dXJucyBhCiAgICAjIFRlc3RDYXNlIG9yIFRlc3RTdWl0ZSBpbnN0YW5jZS4iCiAgICAjCiAgICAjIFdoYXQgaGFwcGVucyB3aGVuIG5vIG1vZHVsZSBjYW4gYmUgZm91bmQgZm9yIHRoZSBnaXZlbiBuYW1lPwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX191bmtub3duX21vZHVsZV9uYW1lKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoWydzZGFzZmFzZmFzZGYnXSkKICAgICAgICBleGNlcHQgSW1wb3J0RXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIoZSksICJObyBtb2R1bGUgbmFtZWQgJ3NkYXNmYXNmYXNkZiciKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMgZmFpbGVkIHRvIHJhaXNlIEltcG9ydEVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSBlaXRoZXIgdG8KICAgICMgYSBtb2R1bGUsIGEgdGVzdCBjYXNlIGNsYXNzLCBhIFRlc3RTdWl0ZSBpbnN0YW5jZSwgYSB0ZXN0IG1ldGhvZAogICAgIyB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MsIG9yIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYQogICAgIyBUZXN0Q2FzZSBvciBUZXN0U3VpdGUgaW5zdGFuY2UuIgogICAgIwogICAgIyBXaGF0IGhhcHBlbnMgd2hlbiB0aGUgbW9kdWxlIGNhbiBiZSBmb3VuZCwgYnV0IG5vdCB0aGUgYXR0cmlidXRlPwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX191bmtub3duX2F0dHJfbmFtZShzZWxmKToKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWVzKFsndW5pdHRlc3Quc2Rhc2Zhc2Zhc2RmJywgJ3VuaXR0ZXN0J10pCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yIGFzIGU6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGUpLCAiJ21vZHVsZScgb2JqZWN0IGhhcyBubyBhdHRyaWJ1dGUgJ3NkYXNmYXNmYXNkZiciKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMgZmFpbGVkIHRvIHJhaXNlIEF0dHJpYnV0ZUVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSBlaXRoZXIgdG8KICAgICMgYSBtb2R1bGUsIGEgdGVzdCBjYXNlIGNsYXNzLCBhIFRlc3RTdWl0ZSBpbnN0YW5jZSwgYSB0ZXN0IG1ldGhvZAogICAgIyB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MsIG9yIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYQogICAgIyBUZXN0Q2FzZSBvciBUZXN0U3VpdGUgaW5zdGFuY2UuIgogICAgIyAuLi4KICAgICMgIlRoZSBtZXRob2Qgb3B0aW9uYWxseSByZXNvbHZlcyBuYW1lIHJlbGF0aXZlIHRvIHRoZSBnaXZlbiBtb2R1bGUiCiAgICAjCiAgICAjIFdoYXQgaGFwcGVucyB3aGVuIGdpdmVuIGFuIHVua25vd24gYXR0cmlidXRlIG9uIGEgc3BlY2lmaWVkIGBtb2R1bGVgCiAgICAjIGFyZ3VtZW50PwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX191bmtub3duX25hbWVfcmVsYXRpdmVfMShzZWxmKToKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWVzKFsnc2Rhc2Zhc2Zhc2RmJ10sIHVuaXR0ZXN0KQogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvciBhcyBlOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN0cihlKSwgIidtb2R1bGUnIG9iamVjdCBoYXMgbm8gYXR0cmlidXRlICdzZGFzZmFzZmFzZGYnIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIlRlc3RMb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUgZmFpbGVkIHRvIHJhaXNlIEF0dHJpYnV0ZUVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSBlaXRoZXIgdG8KICAgICMgYSBtb2R1bGUsIGEgdGVzdCBjYXNlIGNsYXNzLCBhIFRlc3RTdWl0ZSBpbnN0YW5jZSwgYSB0ZXN0IG1ldGhvZAogICAgIyB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MsIG9yIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYQogICAgIyBUZXN0Q2FzZSBvciBUZXN0U3VpdGUgaW5zdGFuY2UuIgogICAgIyAuLi4KICAgICMgIlRoZSBtZXRob2Qgb3B0aW9uYWxseSByZXNvbHZlcyBuYW1lIHJlbGF0aXZlIHRvIHRoZSBnaXZlbiBtb2R1bGUiCiAgICAjCiAgICAjIERvIHVua25vd24gYXR0cmlidXRlcyAocmVsYXRpdmUgdG8gYSBwcm92aWRlZCBtb2R1bGUpIHN0aWxsIHJhaXNlIGFuCiAgICAjIGV4Y2VwdGlvbiBldmVuIGluIHRoZSBwcmVzZW5jZSBvZiB2YWxpZCBhdHRyaWJ1dGUgbmFtZXM/CiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZXNfX3Vua25vd25fbmFtZV9yZWxhdGl2ZV8yKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoWydUZXN0Q2FzZScsICdzZGFzZmFzZmFzZGYnXSwgdW5pdHRlc3QpCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yIGFzIGU6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGUpLCAiJ21vZHVsZScgb2JqZWN0IGhhcyBubyBhdHRyaWJ1dGUgJ3NkYXNmYXNmYXNkZiciKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSBmYWlsZWQgdG8gcmFpc2UgQXR0cmlidXRlRXJyb3IiKQoKICAgICMgIlRoZSBzcGVjaWZpZXIgbmFtZSBpcyBhIGBgZG90dGVkIG5hbWUnJyB0aGF0IG1heSByZXNvbHZlIGVpdGhlciB0bwogICAgIyBhIG1vZHVsZSwgYSB0ZXN0IGNhc2UgY2xhc3MsIGEgVGVzdFN1aXRlIGluc3RhbmNlLCBhIHRlc3QgbWV0aG9kCiAgICAjIHdpdGhpbiBhIHRlc3QgY2FzZSBjbGFzcywgb3IgYSBjYWxsYWJsZSBvYmplY3Qgd2hpY2ggcmV0dXJucyBhCiAgICAjIFRlc3RDYXNlIG9yIFRlc3RTdWl0ZSBpbnN0YW5jZS4iCiAgICAjIC4uLgogICAgIyAiVGhlIG1ldGhvZCBvcHRpb25hbGx5IHJlc29sdmVzIG5hbWUgcmVsYXRpdmUgdG8gdGhlIGdpdmVuIG1vZHVsZSIKICAgICMKICAgICMgV2hhdCBoYXBwZW5zIHdoZW4gZmFjZWQgd2l0aCB0aGUgZW1wdHkgc3RyaW5nPwogICAgIwogICAgIyBYWFggVGhpcyBjdXJyZW50bHkgcmFpc2VzIEF0dHJpYnV0ZUVycm9yLCB0aG91Z2ggVmFsdWVFcnJvciBpcyBwcm9iYWJseQogICAgIyBtb3JlIGFwcHJvcHJpYXRlCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZXNfX3JlbGF0aXZlX2VtcHR5X25hbWUoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCgogICAgICAgIHRyeToKICAgICAgICAgICAgbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbJyddLCB1bml0dGVzdCkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIkZhaWxlZCB0byByYWlzZSBWYWx1ZUVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSBlaXRoZXIgdG8KICAgICMgYSBtb2R1bGUsIGEgdGVzdCBjYXNlIGNsYXNzLCBhIFRlc3RTdWl0ZSBpbnN0YW5jZSwgYSB0ZXN0IG1ldGhvZAogICAgIyB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MsIG9yIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYQogICAgIyBUZXN0Q2FzZSBvciBUZXN0U3VpdGUgaW5zdGFuY2UuIgogICAgIyAuLi4KICAgICMgIlRoZSBtZXRob2Qgb3B0aW9uYWxseSByZXNvbHZlcyBuYW1lIHJlbGF0aXZlIHRvIHRoZSBnaXZlbiBtb2R1bGUiCiAgICAjCiAgICAjIFdoYXQgaGFwcGVucyB3aGVuIHByZXNlbnRlZCB3aXRoIGFuIGltcG9zc2libGUgYXR0cmlidXRlIG5hbWU/CiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZXNfX3JlbGF0aXZlX21hbGZvcm1lZF9uYW1lKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICAjIFhYWCBTaG91bGQgdGhpcyByYWlzZSBBdHRyaWJ1dGVFcnJvciBvciBWYWx1ZUVycm9yPwogICAgICAgIHRyeToKICAgICAgICAgICAgbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbJ2FiYyAoKSAvLyddLCB1bml0dGVzdCkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMgZmFpbGVkIHRvIHJhaXNlIFZhbHVlRXJyb3IiKQoKICAgICMgIlRoZSBtZXRob2Qgb3B0aW9uYWxseSByZXNvbHZlcyBuYW1lIHJlbGF0aXZlIHRvIHRoZSBnaXZlbiBtb2R1bGUiCiAgICAjCiAgICAjIERvZXMgbG9hZFRlc3RzRnJvbU5hbWVzKCkgbWFrZSBzdXJlIHRoZSBwcm92aWRlZCBgbW9kdWxlYCBpcyBpbiBmYWN0CiAgICAjIGEgbW9kdWxlPwogICAgIwogICAgIyBYWFggVGhpcyB2YWxpZGF0aW9uIGlzIGN1cnJlbnRseSBub3QgZG9uZS4gVGhpcyBmbGV4aWJpbGl0eSBzaG91bGQKICAgICMgZWl0aGVyIGJlIGRvY3VtZW50ZWQgb3IgYSBUeXBlRXJyb3Igc2hvdWxkIGJlIHJhaXNlZC4KICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21OYW1lc19fcmVsYXRpdmVfbm90X2FfbW9kdWxlKHNlbGYpOgogICAgICAgIGNsYXNzIE15VGVzdENhc2UodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgY2xhc3MgTm90QU1vZHVsZShvYmplY3QpOgogICAgICAgICAgICB0ZXN0XzIgPSBNeVRlc3RDYXNlCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbJ3Rlc3RfMiddLCBOb3RBTW9kdWxlKQoKICAgICAgICByZWZlcmVuY2UgPSBbdW5pdHRlc3QuVGVzdFN1aXRlKFtNeVRlc3RDYXNlKCd0ZXN0JyldKV0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3Qoc3VpdGUpLCByZWZlcmVuY2UpCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgZWl0aGVyIHRvCiAgICAjIGEgbW9kdWxlLCBhIHRlc3QgY2FzZSBjbGFzcywgYSBUZXN0U3VpdGUgaW5zdGFuY2UsIGEgdGVzdCBtZXRob2QKICAgICMgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzLCBvciBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEKICAgICMgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlLiIKICAgICMKICAgICMgRG9lcyBpdCByYWlzZSBhbiBleGNlcHRpb24gaWYgdGhlIG5hbWUgcmVzb2x2ZXMgdG8gYW4gaW52YWxpZAogICAgIyBvYmplY3Q/CiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZXNfX3JlbGF0aXZlX2JhZF9vYmplY3Qoc2VsZik6CiAgICAgICAgbSA9IHR5cGVzLk1vZHVsZVR5cGUoJ20nKQogICAgICAgIG0udGVzdGNhc2VfMSA9IG9iamVjdCgpCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHRyeToKICAgICAgICAgICAgbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbJ3Rlc3RjYXNlXzEnXSwgbSkKICAgICAgICBleGNlcHQgVHlwZUVycm9yOgogICAgICAgICAgICBwYXNzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCJTaG91bGQgaGF2ZSByYWlzZWQgVHlwZUVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSAuLi4gdG8KICAgICMgLi4uIGEgdGVzdCBjYXNlIGNsYXNzIgogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX19yZWxhdGl2ZV9UZXN0Q2FzZV9zdWJjbGFzcyhzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgTXlUZXN0Q2FzZSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIG0udGVzdGNhc2VfMSA9IE15VGVzdENhc2UKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgc3VpdGUgPSBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWVzKFsndGVzdGNhc2VfMSddLCBtKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShzdWl0ZSwgbG9hZGVyLnN1aXRlQ2xhc3MpCgogICAgICAgIGV4cGVjdGVkID0gbG9hZGVyLnN1aXRlQ2xhc3MoW015VGVzdENhc2UoJ3Rlc3QnKV0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KHN1aXRlKSwgW2V4cGVjdGVkXSkKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSAuLi4gdG8KICAgICMgLi4uIGEgVGVzdFN1aXRlIGluc3RhbmNlIgogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX19yZWxhdGl2ZV9UZXN0U3VpdGUoc2VsZik6CiAgICAgICAgbSA9IHR5cGVzLk1vZHVsZVR5cGUoJ20nKQogICAgICAgIGNsYXNzIE15VGVzdENhc2UodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICBtLnRlc3RzdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShbTXlUZXN0Q2FzZSgndGVzdCcpXSkKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgc3VpdGUgPSBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWVzKFsndGVzdHN1aXRlJ10sIG0pCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHN1aXRlLCBsb2FkZXIuc3VpdGVDbGFzcykKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KHN1aXRlKSwgW20udGVzdHN1aXRlXSkKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSAuLi4gdG8gLi4uIGEKICAgICMgdGVzdCBtZXRob2Qgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzIgogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX19yZWxhdGl2ZV90ZXN0bWV0aG9kKHNlbGYpOgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBNeVRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgbS50ZXN0Y2FzZV8xID0gTXlUZXN0Q2FzZQoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoWyd0ZXN0Y2FzZV8xLnRlc3QnXSwgbSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQoKICAgICAgICByZWZfc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoW015VGVzdENhc2UoJ3Rlc3QnKV0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KHN1aXRlKSwgW3JlZl9zdWl0ZV0pCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgLi4uIHRvIC4uLiBhCiAgICAjIHRlc3QgbWV0aG9kIHdpdGhpbiBhIHRlc3QgY2FzZSBjbGFzcyIKICAgICMKICAgICMgRG9lcyB0aGUgbWV0aG9kIGdyYWNlZnVsbHkgaGFuZGxlIG5hbWVzIHRoYXQgaW5pdGlhbGx5IGxvb2sgbGlrZSB0aGV5CiAgICAjIHJlc29sdmUgdG8gImEgdGVzdCBtZXRob2Qgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzIiBidXQgZG9uJ3Q/CiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZXNfX3JlbGF0aXZlX2ludmFsaWRfdGVzdG1ldGhvZChzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgTXlUZXN0Q2FzZSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIG0udGVzdGNhc2VfMSA9IE15VGVzdENhc2UKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWVzKFsndGVzdGNhc2VfMS50ZXN0Zm9vJ10sIG0pCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yIGFzIGU6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGUpLCAidHlwZSBvYmplY3QgJ015VGVzdENhc2UnIGhhcyBubyBhdHRyaWJ1dGUgJ3Rlc3Rmb28nIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIkZhaWxlZCB0byByYWlzZSBBdHRyaWJ1dGVFcnJvciIpCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgLi4uIHRvCiAgICAjIC4uLiBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEgLi4uIFRlc3RTdWl0ZSBpbnN0YW5jZSIKICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21OYW1lc19fY2FsbGFibGVfX1Rlc3RTdWl0ZShzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgdGVzdGNhc2VfMSA9IHVuaXR0ZXN0LkZ1bmN0aW9uVGVzdENhc2UobGFtYmRhOiBOb25lKQogICAgICAgIHRlc3RjYXNlXzIgPSB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKICAgICAgICBkZWYgcmV0dXJuX1Rlc3RTdWl0ZSgpOgogICAgICAgICAgICByZXR1cm4gdW5pdHRlc3QuVGVzdFN1aXRlKFt0ZXN0Y2FzZV8xLCB0ZXN0Y2FzZV8yXSkKICAgICAgICBtLnJldHVybl9UZXN0U3VpdGUgPSByZXR1cm5fVGVzdFN1aXRlCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbJ3JldHVybl9UZXN0U3VpdGUnXSwgbSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQoKICAgICAgICBleHBlY3RlZCA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShbdGVzdGNhc2VfMSwgdGVzdGNhc2VfMl0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KHN1aXRlKSwgW2V4cGVjdGVkXSkKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSAuLi4gdG8KICAgICMgLi4uIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYSBUZXN0Q2FzZSAuLi4gaW5zdGFuY2UiCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZXNfX2NhbGxhYmxlX19UZXN0Q2FzZV9pbnN0YW5jZShzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgdGVzdGNhc2VfMSA9IHVuaXR0ZXN0LkZ1bmN0aW9uVGVzdENhc2UobGFtYmRhOiBOb25lKQogICAgICAgIGRlZiByZXR1cm5fVGVzdENhc2UoKToKICAgICAgICAgICAgcmV0dXJuIHRlc3RjYXNlXzEKICAgICAgICBtLnJldHVybl9UZXN0Q2FzZSA9IHJldHVybl9UZXN0Q2FzZQoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoWydyZXR1cm5fVGVzdENhc2UnXSwgbSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQoKICAgICAgICByZWZfc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoW3Rlc3RjYXNlXzFdKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFtyZWZfc3VpdGVdKQoKICAgICMgIlRoZSBzcGVjaWZpZXIgbmFtZSBpcyBhIGBgZG90dGVkIG5hbWUnJyB0aGF0IG1heSByZXNvbHZlIC4uLiB0bwogICAgIyAuLi4gYSBjYWxsYWJsZSBvYmplY3Qgd2hpY2ggcmV0dXJucyBhIFRlc3RDYXNlIG9yIFRlc3RTdWl0ZSBpbnN0YW5jZSIKICAgICMKICAgICMgQXJlIHN0YXRpY21ldGhvZHMgaGFuZGxlZCBjb3JyZWN0bHk/CiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZXNfX2NhbGxhYmxlX19jYWxsX3N0YXRpY21ldGhvZChzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgVGVzdDEodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgdGVzdGNhc2VfMSA9IFRlc3QxKCd0ZXN0JykKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgICAgIGRlZiBmb28oKToKICAgICAgICAgICAgICAgIHJldHVybiB0ZXN0Y2FzZV8xCiAgICAgICAgbS5Gb28gPSBGb28KCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgc3VpdGUgPSBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWVzKFsnRm9vLmZvbyddLCBtKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShzdWl0ZSwgbG9hZGVyLnN1aXRlQ2xhc3MpCgogICAgICAgIHJlZl9zdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShbdGVzdGNhc2VfMV0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KHN1aXRlKSwgW3JlZl9zdWl0ZV0pCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgLi4uIHRvCiAgICAjIC4uLiBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlIgogICAgIwogICAgIyBXaGF0IGhhcHBlbnMgd2hlbiB0aGUgY2FsbGFibGUgcmV0dXJucyBzb21ldGhpbmcgZWxzZT8KICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21OYW1lc19fY2FsbGFibGVfX3dyb25nX3R5cGUoc2VsZik6CiAgICAgICAgbSA9IHR5cGVzLk1vZHVsZVR5cGUoJ20nKQogICAgICAgIGRlZiByZXR1cm5fd3JvbmcoKToKICAgICAgICAgICAgcmV0dXJuIDYKICAgICAgICBtLnJldHVybl93cm9uZyA9IHJldHVybl93cm9uZwoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbJ3JldHVybl93cm9uZyddLCBtKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIlRlc3RMb2FkZXIubG9hZFRlc3RzRnJvbU5hbWVzIGZhaWxlZCB0byByYWlzZSBUeXBlRXJyb3IiKQoKICAgICMgIlRoZSBzcGVjaWZpZXIgY2FuIHJlZmVyIHRvIG1vZHVsZXMgYW5kIHBhY2thZ2VzIHdoaWNoIGhhdmUgbm90IGJlZW4KICAgICMgaW1wb3J0ZWQ7IHRoZXkgd2lsbCBiZSBpbXBvcnRlZCBhcyBhIHNpZGUtZWZmZWN0IgogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX19tb2R1bGVfbm90X2xvYWRlZChzZWxmKToKICAgICAgICAjIFdlJ3JlIGdvaW5nIHRvIHRyeSB0byBsb2FkIHRoaXMgbW9kdWxlIGFzIGEgc2lkZS1lZmZlY3QsIHNvIGl0CiAgICAgICAgIyBiZXR0ZXIgbm90IGJlIGxvYWRlZCBiZWZvcmUgd2UgdHJ5LgogICAgICAgICMKICAgICAgICBtb2R1bGVfbmFtZSA9ICd1bml0dGVzdC50ZXN0LmR1bW15JwogICAgICAgIHN5cy5tb2R1bGVzLnBvcChtb2R1bGVfbmFtZSwgTm9uZSkKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoW21vZHVsZV9uYW1lXSkKCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShzdWl0ZSwgbG9hZGVyLnN1aXRlQ2xhc3MpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFt1bml0dGVzdC5UZXN0U3VpdGUoKV0pCgogICAgICAgICAgICAjIG1vZHVsZSBzaG91bGQgbm93IGJlIGxvYWRlZCwgdGhhbmtzIHRvIGxvYWRUZXN0c0Zyb21OYW1lKCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbihtb2R1bGVfbmFtZSwgc3lzLm1vZHVsZXMpCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgaWYgbW9kdWxlX25hbWUgaW4gc3lzLm1vZHVsZXM6CiAgICAgICAgICAgICAgICBkZWwgc3lzLm1vZHVsZXNbbW9kdWxlX25hbWVdCgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgIyMjIC9UZXN0cyBmb3IgVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoKQoKICAgICMjIyBUZXN0cyBmb3IgVGVzdExvYWRlci5nZXRUZXN0Q2FzZU5hbWVzKCkKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAjICJSZXR1cm4gYSBzb3J0ZWQgc2VxdWVuY2Ugb2YgbWV0aG9kIG5hbWVzIGZvdW5kIHdpdGhpbiB0ZXN0Q2FzZUNsYXNzIgogICAgIwogICAgIyBUZXN0LmZvb2JhciBpcyBkZWZpbmVkIHRvIG1ha2Ugc3VyZSBnZXRUZXN0Q2FzZU5hbWVzKCkgcmVzcGVjdHMKICAgICMgbG9hZGVyLnRlc3RNZXRob2RQcmVmaXgKICAgIGRlZiB0ZXN0X2dldFRlc3RDYXNlTmFtZXMoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0XzEoc2VsZik6IHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfMihzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgZm9vYmFyKHNlbGYpOiBwYXNzCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxvYWRlci5nZXRUZXN0Q2FzZU5hbWVzKFRlc3QpLCBbJ3Rlc3RfMScsICd0ZXN0XzInXSkKCiAgICAjICJSZXR1cm4gYSBzb3J0ZWQgc2VxdWVuY2Ugb2YgbWV0aG9kIG5hbWVzIGZvdW5kIHdpdGhpbiB0ZXN0Q2FzZUNsYXNzIgogICAgIwogICAgIyBEb2VzIGdldFRlc3RDYXNlTmFtZXMoKSBiZWhhdmUgYXBwcm9wcmlhdGVseSBpZiBubyB0ZXN0cyBhcmUgZm91bmQ/CiAgICBkZWYgdGVzdF9nZXRUZXN0Q2FzZU5hbWVzX19ub190ZXN0cyhzZWxmKToKICAgICAgICBjbGFzcyBUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIGZvb2JhcihzZWxmKTogcGFzcwoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIuZ2V0VGVzdENhc2VOYW1lcyhUZXN0KSwgW10pCgogICAgIyAiUmV0dXJuIGEgc29ydGVkIHNlcXVlbmNlIG9mIG1ldGhvZCBuYW1lcyBmb3VuZCB3aXRoaW4gdGVzdENhc2VDbGFzcyIKICAgICMKICAgICMgQXJlIG5vdC1UZXN0Q2FzZXMgaGFuZGxlZCBncmFjZWZ1bGx5PwogICAgIwogICAgIyBYWFggVGhpcyBzaG91bGQgcmFpc2UgYSBUeXBlRXJyb3IsIG5vdCByZXR1cm4gYSBsaXN0CiAgICAjCiAgICAjIFhYWCBJdCdzIHRvbyBsYXRlIGluIHRoZSAyLjUgcmVsZWFzZSBjeWNsZSB0byBmaXggdGhpcywgYnV0IGl0IHNob3VsZAogICAgIyBwcm9iYWJseSBiZSByZXZpc2l0ZWQgZm9yIDIuNgogICAgZGVmIHRlc3RfZ2V0VGVzdENhc2VOYW1lc19fbm90X2FfVGVzdENhc2Uoc2VsZik6CiAgICAgICAgY2xhc3MgQmFkQ2FzZShpbnQpOgogICAgICAgICAgICBkZWYgdGVzdF9mb28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIG5hbWVzID0gbG9hZGVyLmdldFRlc3RDYXNlTmFtZXMoQmFkQ2FzZSkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChuYW1lcywgWyd0ZXN0X2ZvbyddKQoKICAgICMgIlJldHVybiBhIHNvcnRlZCBzZXF1ZW5jZSBvZiBtZXRob2QgbmFtZXMgZm91bmQgd2l0aGluIHRlc3RDYXNlQ2xhc3MiCiAgICAjCiAgICAjIE1ha2Ugc3VyZSBpbmhlcml0ZWQgbmFtZXMgYXJlIGhhbmRsZWQuCiAgICAjCiAgICAjIFRlc3RQLmZvb2JhciBpcyBkZWZpbmVkIHRvIG1ha2Ugc3VyZSBnZXRUZXN0Q2FzZU5hbWVzKCkgcmVzcGVjdHMKICAgICMgbG9hZGVyLnRlc3RNZXRob2RQcmVmaXgKICAgIGRlZiB0ZXN0X2dldFRlc3RDYXNlTmFtZXNfX2luaGVyaXRhbmNlKHNlbGYpOgogICAgICAgIGNsYXNzIFRlc3RQKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8yKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiBmb29iYXIoc2VsZik6IHBhc3MKCiAgICAgICAgY2xhc3MgVGVzdEMoVGVzdFApOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0XzMoc2VsZik6IHBhc3MKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCgogICAgICAgIG5hbWVzID0gWyd0ZXN0XzEnLCAndGVzdF8yJywgJ3Rlc3RfMyddCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIuZ2V0VGVzdENhc2VOYW1lcyhUZXN0QyksIG5hbWVzKQoKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgICMjIyAvVGVzdHMgZm9yIFRlc3RMb2FkZXIuZ2V0VGVzdENhc2VOYW1lcygpCgogICAgIyMjIFRlc3RzIGZvciBUZXN0TG9hZGVyLnRlc3RNZXRob2RQcmVmaXgKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAjICJTdHJpbmcgZ2l2aW5nIHRoZSBwcmVmaXggb2YgbWV0aG9kIG5hbWVzIHdoaWNoIHdpbGwgYmUgaW50ZXJwcmV0ZWQgYXMKICAgICMgdGVzdCBtZXRob2RzIgogICAgIwogICAgIyBJbXBsaWNpdCBpbiB0aGUgZG9jdW1lbnRhdGlvbiBpcyB0aGF0IHRlc3RNZXRob2RQcmVmaXggaXMgcmVzcGVjdGVkIGJ5CiAgICAjIGFsbCBsb2FkVGVzdHNGcm9tKiBtZXRob2RzLgogICAgZGVmIHRlc3RfdGVzdE1ldGhvZFByZWZpeF9fbG9hZFRlc3RzRnJvbVRlc3RDYXNlKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0XzEoc2VsZik6IHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfMihzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgZm9vX2JhcihzZWxmKTogcGFzcwoKICAgICAgICB0ZXN0c18xID0gdW5pdHRlc3QuVGVzdFN1aXRlKFtGb28oJ2Zvb19iYXInKV0pCiAgICAgICAgdGVzdHNfMiA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShbRm9vKCd0ZXN0XzEnKSwgRm9vKCd0ZXN0XzInKV0pCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIGxvYWRlci50ZXN0TWV0aG9kUHJlZml4ID0gJ2ZvbycKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxvYWRlci5sb2FkVGVzdHNGcm9tVGVzdENhc2UoRm9vKSwgdGVzdHNfMSkKCiAgICAgICAgbG9hZGVyLnRlc3RNZXRob2RQcmVmaXggPSAndGVzdCcKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxvYWRlci5sb2FkVGVzdHNGcm9tVGVzdENhc2UoRm9vKSwgdGVzdHNfMikKCiAgICAjICJTdHJpbmcgZ2l2aW5nIHRoZSBwcmVmaXggb2YgbWV0aG9kIG5hbWVzIHdoaWNoIHdpbGwgYmUgaW50ZXJwcmV0ZWQgYXMKICAgICMgdGVzdCBtZXRob2RzIgogICAgIwogICAgIyBJbXBsaWNpdCBpbiB0aGUgZG9jdW1lbnRhdGlvbiBpcyB0aGF0IHRlc3RNZXRob2RQcmVmaXggaXMgcmVzcGVjdGVkIGJ5CiAgICAjIGFsbCBsb2FkVGVzdHNGcm9tKiBtZXRob2RzLgogICAgZGVmIHRlc3RfdGVzdE1ldGhvZFByZWZpeF9fbG9hZFRlc3RzRnJvbU1vZHVsZShzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8yKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiBmb29fYmFyKHNlbGYpOiBwYXNzCiAgICAgICAgbS5Gb28gPSBGb28KCiAgICAgICAgdGVzdHNfMSA9IFt1bml0dGVzdC5UZXN0U3VpdGUoW0ZvbygnZm9vX2JhcicpXSldCiAgICAgICAgdGVzdHNfMiA9IFt1bml0dGVzdC5UZXN0U3VpdGUoW0ZvbygndGVzdF8xJyksIEZvbygndGVzdF8yJyldKV0KCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnRlc3RNZXRob2RQcmVmaXggPSAnZm9vJwogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChsb2FkZXIubG9hZFRlc3RzRnJvbU1vZHVsZShtKSksIHRlc3RzXzEpCgogICAgICAgIGxvYWRlci50ZXN0TWV0aG9kUHJlZml4ID0gJ3Rlc3QnCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KGxvYWRlci5sb2FkVGVzdHNGcm9tTW9kdWxlKG0pKSwgdGVzdHNfMikKCiAgICAjICJTdHJpbmcgZ2l2aW5nIHRoZSBwcmVmaXggb2YgbWV0aG9kIG5hbWVzIHdoaWNoIHdpbGwgYmUgaW50ZXJwcmV0ZWQgYXMKICAgICMgdGVzdCBtZXRob2RzIgogICAgIwogICAgIyBJbXBsaWNpdCBpbiB0aGUgZG9jdW1lbnRhdGlvbiBpcyB0aGF0IHRlc3RNZXRob2RQcmVmaXggaXMgcmVzcGVjdGVkIGJ5CiAgICAjIGFsbCBsb2FkVGVzdHNGcm9tKiBtZXRob2RzLgogICAgZGVmIHRlc3RfdGVzdE1ldGhvZFByZWZpeF9fbG9hZFRlc3RzRnJvbU5hbWUoc2VsZik6CiAgICAgICAgbSA9IHR5cGVzLk1vZHVsZVR5cGUoJ20nKQogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0XzEoc2VsZik6IHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfMihzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgZm9vX2JhcihzZWxmKTogcGFzcwogICAgICAgIG0uRm9vID0gRm9vCgogICAgICAgIHRlc3RzXzEgPSB1bml0dGVzdC5UZXN0U3VpdGUoW0ZvbygnZm9vX2JhcicpXSkKICAgICAgICB0ZXN0c18yID0gdW5pdHRlc3QuVGVzdFN1aXRlKFtGb28oJ3Rlc3RfMScpLCBGb28oJ3Rlc3RfMicpXSkKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnRlc3RNZXRob2RQcmVmaXggPSAnZm9vJwogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCdGb28nLCBtKSwgdGVzdHNfMSkKCiAgICAgICAgbG9hZGVyLnRlc3RNZXRob2RQcmVmaXggPSAndGVzdCcKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSgnRm9vJywgbSksIHRlc3RzXzIpCgogICAgIyAiU3RyaW5nIGdpdmluZyB0aGUgcHJlZml4IG9mIG1ldGhvZCBuYW1lcyB3aGljaCB3aWxsIGJlIGludGVycHJldGVkIGFzCiAgICAjIHRlc3QgbWV0aG9kcyIKICAgICMKICAgICMgSW1wbGljaXQgaW4gdGhlIGRvY3VtZW50YXRpb24gaXMgdGhhdCB0ZXN0TWV0aG9kUHJlZml4IGlzIHJlc3BlY3RlZCBieQogICAgIyBhbGwgbG9hZFRlc3RzRnJvbSogbWV0aG9kcy4KICAgIGRlZiB0ZXN0X3Rlc3RNZXRob2RQcmVmaXhfX2xvYWRUZXN0c0Zyb21OYW1lcyhzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8yKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiBmb29fYmFyKHNlbGYpOiBwYXNzCiAgICAgICAgbS5Gb28gPSBGb28KCiAgICAgICAgdGVzdHNfMSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShbdW5pdHRlc3QuVGVzdFN1aXRlKFtGb28oJ2Zvb19iYXInKV0pXSkKICAgICAgICB0ZXN0c18yID0gdW5pdHRlc3QuVGVzdFN1aXRlKFtGb28oJ3Rlc3RfMScpLCBGb28oJ3Rlc3RfMicpXSkKICAgICAgICB0ZXN0c18yID0gdW5pdHRlc3QuVGVzdFN1aXRlKFt0ZXN0c18yXSkKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnRlc3RNZXRob2RQcmVmaXggPSAnZm9vJwogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbJ0ZvbyddLCBtKSwgdGVzdHNfMSkKCiAgICAgICAgbG9hZGVyLnRlc3RNZXRob2RQcmVmaXggPSAndGVzdCcKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoWydGb28nXSwgbSksIHRlc3RzXzIpCgogICAgIyAiVGhlIGRlZmF1bHQgdmFsdWUgaXMgJ3Rlc3QnIgogICAgZGVmIHRlc3RfdGVzdE1ldGhvZFByZWZpeF9fZGVmYXVsdF92YWx1ZShzZWxmKToKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxvYWRlci50ZXN0TWV0aG9kUHJlZml4LCAndGVzdCcpCgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgIyMjIC9UZXN0cyBmb3IgVGVzdExvYWRlci50ZXN0TWV0aG9kUHJlZml4CgogICAgIyMjIFRlc3RzIGZvciBUZXN0TG9hZGVyLnNvcnRUZXN0TWV0aG9kc1VzaW5nCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgogICAgIyAiRnVuY3Rpb24gdG8gYmUgdXNlZCB0byBjb21wYXJlIG1ldGhvZCBuYW1lcyB3aGVuIHNvcnRpbmcgdGhlbSBpbgogICAgIyBnZXRUZXN0Q2FzZU5hbWVzKCkgYW5kIGFsbCB0aGUgbG9hZFRlc3RzRnJvbVgoKSBtZXRob2RzIgogICAgZGVmIHRlc3Rfc29ydFRlc3RNZXRob2RzVXNpbmdfX2xvYWRUZXN0c0Zyb21UZXN0Q2FzZShzZWxmKToKICAgICAgICBkZWYgcmV2ZXJzZWRfY21wKHgsIHkpOgogICAgICAgICAgICByZXR1cm4gLSgoeCA+IHkpIC0gKHggPCB5KSkKCiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8yKHNlbGYpOiBwYXNzCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIGxvYWRlci5zb3J0VGVzdE1ldGhvZHNVc2luZyA9IHJldmVyc2VkX2NtcAoKICAgICAgICB0ZXN0cyA9IGxvYWRlci5zdWl0ZUNsYXNzKFtGb28oJ3Rlc3RfMicpLCBGb28oJ3Rlc3RfMScpXSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxvYWRlci5sb2FkVGVzdHNGcm9tVGVzdENhc2UoRm9vKSwgdGVzdHMpCgogICAgIyAiRnVuY3Rpb24gdG8gYmUgdXNlZCB0byBjb21wYXJlIG1ldGhvZCBuYW1lcyB3aGVuIHNvcnRpbmcgdGhlbSBpbgogICAgIyBnZXRUZXN0Q2FzZU5hbWVzKCkgYW5kIGFsbCB0aGUgbG9hZFRlc3RzRnJvbVgoKSBtZXRob2RzIgogICAgZGVmIHRlc3Rfc29ydFRlc3RNZXRob2RzVXNpbmdfX2xvYWRUZXN0c0Zyb21Nb2R1bGUoc2VsZik6CiAgICAgICAgZGVmIHJldmVyc2VkX2NtcCh4LCB5KToKICAgICAgICAgICAgcmV0dXJuIC0oKHggPiB5KSAtICh4IDwgeSkpCgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0XzIoc2VsZik6IHBhc3MKICAgICAgICBtLkZvbyA9IEZvbwoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBsb2FkZXIuc29ydFRlc3RNZXRob2RzVXNpbmcgPSByZXZlcnNlZF9jbXAKCiAgICAgICAgdGVzdHMgPSBbbG9hZGVyLnN1aXRlQ2xhc3MoW0ZvbygndGVzdF8yJyksIEZvbygndGVzdF8xJyldKV0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3QobG9hZGVyLmxvYWRUZXN0c0Zyb21Nb2R1bGUobSkpLCB0ZXN0cykKCiAgICAjICJGdW5jdGlvbiB0byBiZSB1c2VkIHRvIGNvbXBhcmUgbWV0aG9kIG5hbWVzIHdoZW4gc29ydGluZyB0aGVtIGluCiAgICAjIGdldFRlc3RDYXNlTmFtZXMoKSBhbmQgYWxsIHRoZSBsb2FkVGVzdHNGcm9tWCgpIG1ldGhvZHMiCiAgICBkZWYgdGVzdF9zb3J0VGVzdE1ldGhvZHNVc2luZ19fbG9hZFRlc3RzRnJvbU5hbWUoc2VsZik6CiAgICAgICAgZGVmIHJldmVyc2VkX2NtcCh4LCB5KToKICAgICAgICAgICAgcmV0dXJuIC0oKHggPiB5KSAtICh4IDwgeSkpCgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0XzIoc2VsZik6IHBhc3MKICAgICAgICBtLkZvbyA9IEZvbwoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBsb2FkZXIuc29ydFRlc3RNZXRob2RzVXNpbmcgPSByZXZlcnNlZF9jbXAKCiAgICAgICAgdGVzdHMgPSBsb2FkZXIuc3VpdGVDbGFzcyhbRm9vKCd0ZXN0XzInKSwgRm9vKCd0ZXN0XzEnKV0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUoJ0ZvbycsIG0pLCB0ZXN0cykKCiAgICAjICJGdW5jdGlvbiB0byBiZSB1c2VkIHRvIGNvbXBhcmUgbWV0aG9kIG5hbWVzIHdoZW4gc29ydGluZyB0aGVtIGluCiAgICAjIGdldFRlc3RDYXNlTmFtZXMoKSBhbmQgYWxsIHRoZSBsb2FkVGVzdHNGcm9tWCgpIG1ldGhvZHMiCiAgICBkZWYgdGVzdF9zb3J0VGVzdE1ldGhvZHNVc2luZ19fbG9hZFRlc3RzRnJvbU5hbWVzKHNlbGYpOgogICAgICAgIGRlZiByZXZlcnNlZF9jbXAoeCwgeSk6CiAgICAgICAgICAgIHJldHVybiAtKCh4ID4geSkgLSAoeCA8IHkpKQoKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8yKHNlbGYpOiBwYXNzCiAgICAgICAgbS5Gb28gPSBGb28KCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnNvcnRUZXN0TWV0aG9kc1VzaW5nID0gcmV2ZXJzZWRfY21wCgogICAgICAgIHRlc3RzID0gW2xvYWRlci5zdWl0ZUNsYXNzKFtGb28oJ3Rlc3RfMicpLCBGb28oJ3Rlc3RfMScpXSldCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoWydGb28nXSwgbSkpLCB0ZXN0cykKCiAgICAjICJGdW5jdGlvbiB0byBiZSB1c2VkIHRvIGNvbXBhcmUgbWV0aG9kIG5hbWVzIHdoZW4gc29ydGluZyB0aGVtIGluCiAgICAjIGdldFRlc3RDYXNlTmFtZXMoKSIKICAgICMKICAgICMgRG9lcyBpdCBhY3R1YWxseSBhZmZlY3QgZ2V0VGVzdENhc2VOYW1lcygpPwogICAgZGVmIHRlc3Rfc29ydFRlc3RNZXRob2RzVXNpbmdfX2dldFRlc3RDYXNlTmFtZXMoc2VsZik6CiAgICAgICAgZGVmIHJldmVyc2VkX2NtcCh4LCB5KToKICAgICAgICAgICAgcmV0dXJuIC0oKHggPiB5KSAtICh4IDwgeSkpCgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0XzEoc2VsZik6IHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfMihzZWxmKTogcGFzcwoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBsb2FkZXIuc29ydFRlc3RNZXRob2RzVXNpbmcgPSByZXZlcnNlZF9jbXAKCiAgICAgICAgdGVzdF9uYW1lcyA9IFsndGVzdF8yJywgJ3Rlc3RfMSddCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIuZ2V0VGVzdENhc2VOYW1lcyhGb28pLCB0ZXN0X25hbWVzKQoKICAgICMgIlRoZSBkZWZhdWx0IHZhbHVlIGlzIHRoZSBidWlsdC1pbiBjbXAoKSBmdW5jdGlvbiIKICAgICMgU2luY2UgY21wIGlzIG5vdyBkZWZ1bmN0LCB3ZSBzaW1wbHkgdmVyaWZ5IHRoYXQgdGhlIHJlc3VsdHMKICAgICMgb2NjdXIgaW4gdGhlIHNhbWUgb3JkZXIgYXMgdGhleSB3b3VsZCB3aXRoIHRoZSBkZWZhdWx0IHNvcnQuCiAgICBkZWYgdGVzdF9zb3J0VGVzdE1ldGhvZHNVc2luZ19fZGVmYXVsdF92YWx1ZShzZWxmKToKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMihzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8zKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0XzEoc2VsZik6IHBhc3MKCiAgICAgICAgdGVzdF9uYW1lcyA9IFsndGVzdF8yJywgJ3Rlc3RfMycsICd0ZXN0XzEnXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobG9hZGVyLmdldFRlc3RDYXNlTmFtZXMoRm9vKSwgc29ydGVkKHRlc3RfbmFtZXMpKQoKCiAgICAjICJpdCBjYW4gYmUgc2V0IHRvIE5vbmUgdG8gZGlzYWJsZSB0aGUgc29ydC4iCiAgICAjCiAgICAjIFhYWCBIb3cgaXMgdGhpcyBkaWZmZXJlbnQgZnJvbSByZWFzc2lnbmluZyBjbXA/IEFyZSB0aGUgdGVzdHMgcmV0dXJuZWQKICAgICMgaW4gYSByYW5kb20gb3JkZXIgb3Igc29tZXRoaW5nPyBUaGlzIGJlaGF2aW91ciBzaG91bGQgZGllCiAgICBkZWYgdGVzdF9zb3J0VGVzdE1ldGhvZHNVc2luZ19fTm9uZShzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0XzIoc2VsZik6IHBhc3MKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnNvcnRUZXN0TWV0aG9kc1VzaW5nID0gTm9uZQoKICAgICAgICB0ZXN0X25hbWVzID0gWyd0ZXN0XzInLCAndGVzdF8xJ10KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNldChsb2FkZXIuZ2V0VGVzdENhc2VOYW1lcyhGb28pKSwgc2V0KHRlc3RfbmFtZXMpKQoKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgICMjIyAvVGVzdHMgZm9yIFRlc3RMb2FkZXIuc29ydFRlc3RNZXRob2RzVXNpbmcKCiAgICAjIyMgVGVzdHMgZm9yIFRlc3RMb2FkZXIuc3VpdGVDbGFzcwogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgICMgIkNhbGxhYmxlIG9iamVjdCB0aGF0IGNvbnN0cnVjdHMgYSB0ZXN0IHN1aXRlIGZyb20gYSBsaXN0IG9mIHRlc3RzLiIKICAgIGRlZiB0ZXN0X3N1aXRlQ2xhc3NfX2xvYWRUZXN0c0Zyb21UZXN0Q2FzZShzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0XzIoc2VsZik6IHBhc3MKICAgICAgICAgICAgZGVmIGZvb19iYXIoc2VsZik6IHBhc3MKCiAgICAgICAgdGVzdHMgPSBbRm9vKCd0ZXN0XzEnKSwgRm9vKCd0ZXN0XzInKV0KCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnN1aXRlQ2xhc3MgPSBsaXN0CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIubG9hZFRlc3RzRnJvbVRlc3RDYXNlKEZvbyksIHRlc3RzKQoKICAgICMgSXQgaXMgaW1wbGljaXQgaW4gdGhlIGRvY3VtZW50YXRpb24gZm9yIFRlc3RMb2FkZXIuc3VpdGVDbGFzcyB0aGF0CiAgICAjIGFsbCBUZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb20qIG1ldGhvZHMgcmVzcGVjdCBpdC4gTGV0J3MgbWFrZSBzdXJlCiAgICBkZWYgdGVzdF9zdWl0ZUNsYXNzX19sb2FkVGVzdHNGcm9tTW9kdWxlKHNlbGYpOgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0XzIoc2VsZik6IHBhc3MKICAgICAgICAgICAgZGVmIGZvb19iYXIoc2VsZik6IHBhc3MKICAgICAgICBtLkZvbyA9IEZvbwoKICAgICAgICB0ZXN0cyA9IFtbRm9vKCd0ZXN0XzEnKSwgRm9vKCd0ZXN0XzInKV1dCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIGxvYWRlci5zdWl0ZUNsYXNzID0gbGlzdAogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobG9hZGVyLmxvYWRUZXN0c0Zyb21Nb2R1bGUobSksIHRlc3RzKQoKICAgICMgSXQgaXMgaW1wbGljaXQgaW4gdGhlIGRvY3VtZW50YXRpb24gZm9yIFRlc3RMb2FkZXIuc3VpdGVDbGFzcyB0aGF0CiAgICAjIGFsbCBUZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb20qIG1ldGhvZHMgcmVzcGVjdCBpdC4gTGV0J3MgbWFrZSBzdXJlCiAgICBkZWYgdGVzdF9zdWl0ZUNsYXNzX19sb2FkVGVzdHNGcm9tTmFtZShzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8yKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiBmb29fYmFyKHNlbGYpOiBwYXNzCiAgICAgICAgbS5Gb28gPSBGb28KCiAgICAgICAgdGVzdHMgPSBbRm9vKCd0ZXN0XzEnKSwgRm9vKCd0ZXN0XzInKV0KCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnN1aXRlQ2xhc3MgPSBsaXN0CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUoJ0ZvbycsIG0pLCB0ZXN0cykKCiAgICAjIEl0IGlzIGltcGxpY2l0IGluIHRoZSBkb2N1bWVudGF0aW9uIGZvciBUZXN0TG9hZGVyLnN1aXRlQ2xhc3MgdGhhdAogICAgIyBhbGwgVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tKiBtZXRob2RzIHJlc3BlY3QgaXQuIExldCdzIG1ha2Ugc3VyZQogICAgZGVmIHRlc3Rfc3VpdGVDbGFzc19fbG9hZFRlc3RzRnJvbU5hbWVzKHNlbGYpOgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0XzIoc2VsZik6IHBhc3MKICAgICAgICAgICAgZGVmIGZvb19iYXIoc2VsZik6IHBhc3MKICAgICAgICBtLkZvbyA9IEZvbwoKICAgICAgICB0ZXN0cyA9IFtbRm9vKCd0ZXN0XzEnKSwgRm9vKCd0ZXN0XzInKV1dCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIGxvYWRlci5zdWl0ZUNsYXNzID0gbGlzdAogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbJ0ZvbyddLCBtKSwgdGVzdHMpCgogICAgIyAiVGhlIGRlZmF1bHQgdmFsdWUgaXMgdGhlIFRlc3RTdWl0ZSBjbGFzcyIKICAgIGRlZiB0ZXN0X3N1aXRlQ2xhc3NfX2RlZmF1bHRfdmFsdWUoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGxvYWRlci5zdWl0ZUNsYXNzIGlzIHVuaXR0ZXN0LlRlc3RTdWl0ZSkK',
'/Lib/unittest/test/test_program.py':'aW1wb3J0IGlvCgppbXBvcnQgb3MKaW1wb3J0IHN5cwppbXBvcnQgdW5pdHRlc3QKCgpjbGFzcyBUZXN0X1Rlc3RQcm9ncmFtKHVuaXR0ZXN0LlRlc3RDYXNlKToKCiAgICBkZWYgdGVzdF9kaXNjb3ZlcnlfZnJvbV9kb3R0ZWRfcGF0aChzZWxmKToKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgdGVzdHMgPSBbc2VsZl0KICAgICAgICBleHBlY3RlZFBhdGggPSBvcy5wYXRoLmFic3BhdGgob3MucGF0aC5kaXJuYW1lKHVuaXR0ZXN0LnRlc3QuX19maWxlX18pKQoKICAgICAgICBzZWxmLndhc1J1biA9IEZhbHNlCiAgICAgICAgZGVmIF9maW5kX3Rlc3RzKHN0YXJ0X2RpciwgcGF0dGVybik6CiAgICAgICAgICAgIHNlbGYud2FzUnVuID0gVHJ1ZQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN0YXJ0X2RpciwgZXhwZWN0ZWRQYXRoKQogICAgICAgICAgICByZXR1cm4gdGVzdHMKICAgICAgICBsb2FkZXIuX2ZpbmRfdGVzdHMgPSBfZmluZF90ZXN0cwogICAgICAgIHN1aXRlID0gbG9hZGVyLmRpc2NvdmVyKCd1bml0dGVzdC50ZXN0JykKICAgICAgICBzZWxmLmFzc2VydFRydWUoc2VsZi53YXNSdW4pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdWl0ZS5fdGVzdHMsIHRlc3RzKQoKICAgICMgSG9ycmlibGUgd2hpdGUgYm94IHRlc3QKICAgIGRlZiB0ZXN0Tm9FeGl0KHNlbGYpOgogICAgICAgIHJlc3VsdCA9IG9iamVjdCgpCiAgICAgICAgdGVzdCA9IG9iamVjdCgpCgogICAgICAgIGNsYXNzIEZha2VSdW5uZXIob2JqZWN0KToKICAgICAgICAgICAgZGVmIHJ1bihzZWxmLCB0ZXN0KToKICAgICAgICAgICAgICAgIHNlbGYudGVzdCA9IHRlc3QKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQKCiAgICAgICAgcnVubmVyID0gRmFrZVJ1bm5lcigpCgogICAgICAgIG9sZFBhcnNlQXJncyA9IHVuaXR0ZXN0LlRlc3RQcm9ncmFtLnBhcnNlQXJncwogICAgICAgIGRlZiByZXN0b3JlUGFyc2VBcmdzKCk6CiAgICAgICAgICAgIHVuaXR0ZXN0LlRlc3RQcm9ncmFtLnBhcnNlQXJncyA9IG9sZFBhcnNlQXJncwogICAgICAgIHVuaXR0ZXN0LlRlc3RQcm9ncmFtLnBhcnNlQXJncyA9IGxhbWJkYSAqYXJnczogTm9uZQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChyZXN0b3JlUGFyc2VBcmdzKQoKICAgICAgICBkZWYgcmVtb3ZlVGVzdCgpOgogICAgICAgICAgICBkZWwgdW5pdHRlc3QuVGVzdFByb2dyYW0udGVzdAogICAgICAgIHVuaXR0ZXN0LlRlc3RQcm9ncmFtLnRlc3QgPSB0ZXN0CiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHJlbW92ZVRlc3QpCgogICAgICAgIHByb2dyYW0gPSB1bml0dGVzdC5UZXN0UHJvZ3JhbSh0ZXN0UnVubmVyPXJ1bm5lciwgZXhpdD1GYWxzZSwgdmVyYm9zaXR5PTIpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS5yZXN1bHQsIHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJ1bm5lci50ZXN0LCB0ZXN0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS52ZXJib3NpdHksIDIpCgogICAgY2xhc3MgRm9vQmFyKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICBkZWYgdGVzdFBhc3Moc2VsZik6CiAgICAgICAgICAgIGFzc2VydCBUcnVlCiAgICAgICAgZGVmIHRlc3RGYWlsKHNlbGYpOgogICAgICAgICAgICBhc3NlcnQgRmFsc2UKCiAgICBjbGFzcyBGb29CYXJMb2FkZXIodW5pdHRlc3QuVGVzdExvYWRlcik6CiAgICAgICAgIiIiVGVzdCBsb2FkZXIgdGhhdCByZXR1cm5zIGEgc3VpdGUgY29udGFpbmluZyBGb29CYXIuIiIiCiAgICAgICAgZGVmIGxvYWRUZXN0c0Zyb21Nb2R1bGUoc2VsZiwgbW9kdWxlKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuc3VpdGVDbGFzcygKICAgICAgICAgICAgICAgIFtzZWxmLmxvYWRUZXN0c0Zyb21UZXN0Q2FzZShUZXN0X1Rlc3RQcm9ncmFtLkZvb0JhcildKQoKCiAgICBkZWYgdGVzdF9Ob25FeGl0KHNlbGYpOgogICAgICAgIHByb2dyYW0gPSB1bml0dGVzdC5tYWluKGV4aXQ9RmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJndj1bImZvb2JhciJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlc3RSdW5uZXI9dW5pdHRlc3QuVGV4dFRlc3RSdW5uZXIoc3RyZWFtPWlvLlN0cmluZ0lPKCkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlc3RMb2FkZXI9c2VsZi5Gb29CYXJMb2FkZXIoKSkKICAgICAgICBzZWxmLmFzc2VydFRydWUoaGFzYXR0cihwcm9ncmFtLCAncmVzdWx0JykpCgoKICAgIGRlZiB0ZXN0X0V4aXQoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgIFN5c3RlbUV4aXQsCiAgICAgICAgICAgIHVuaXR0ZXN0Lm1haW4sCiAgICAgICAgICAgIGFyZ3Y9WyJmb29iYXIiXSwKICAgICAgICAgICAgdGVzdFJ1bm5lcj11bml0dGVzdC5UZXh0VGVzdFJ1bm5lcihzdHJlYW09aW8uU3RyaW5nSU8oKSksCiAgICAgICAgICAgIGV4aXQ9VHJ1ZSwKICAgICAgICAgICAgdGVzdExvYWRlcj1zZWxmLkZvb0JhckxvYWRlcigpKQoKCiAgICBkZWYgdGVzdF9FeGl0QXNEZWZhdWx0KHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKAogICAgICAgICAgICBTeXN0ZW1FeGl0LAogICAgICAgICAgICB1bml0dGVzdC5tYWluLAogICAgICAgICAgICBhcmd2PVsiZm9vYmFyIl0sCiAgICAgICAgICAgIHRlc3RSdW5uZXI9dW5pdHRlc3QuVGV4dFRlc3RSdW5uZXIoc3RyZWFtPWlvLlN0cmluZ0lPKCkpLAogICAgICAgICAgICB0ZXN0TG9hZGVyPXNlbGYuRm9vQmFyTG9hZGVyKCkpCgoKY2xhc3MgSW5pdGlhbGlzYWJsZVByb2dyYW0odW5pdHRlc3QuVGVzdFByb2dyYW0pOgogICAgZXhpdCA9IEZhbHNlCiAgICByZXN1bHQgPSBOb25lCiAgICB2ZXJib3NpdHkgPSAxCiAgICBkZWZhdWx0VGVzdCA9IE5vbmUKICAgIHRlc3RSdW5uZXIgPSBOb25lCiAgICB0ZXN0TG9hZGVyID0gdW5pdHRlc3QuZGVmYXVsdFRlc3RMb2FkZXIKICAgIG1vZHVsZSA9ICdfX21haW5fXycKICAgIHByb2dOYW1lID0gJ3Rlc3QnCiAgICB0ZXN0ID0gJ3Rlc3QnCiAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MpOgogICAgICAgIHBhc3MKClJFU1VMVCA9IG9iamVjdCgpCgpjbGFzcyBGYWtlUnVubmVyKG9iamVjdCk6CiAgICBpbml0QXJncyA9IE5vbmUKICAgIHRlc3QgPSBOb25lCiAgICByYWlzZUVycm9yID0gRmFsc2UKCiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIEZha2VSdW5uZXIuaW5pdEFyZ3MgPSBrd2FyZ3MKICAgICAgICBpZiBGYWtlUnVubmVyLnJhaXNlRXJyb3I6CiAgICAgICAgICAgIEZha2VSdW5uZXIucmFpc2VFcnJvciA9IEZhbHNlCiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcgoKICAgIGRlZiBydW4oc2VsZiwgdGVzdCk6CiAgICAgICAgRmFrZVJ1bm5lci50ZXN0ID0gdGVzdAogICAgICAgIHJldHVybiBSRVNVTFQKCmNsYXNzIFRlc3RDb21tYW5kTGluZUFyZ3ModW5pdHRlc3QuVGVzdENhc2UpOgoKICAgIGRlZiBzZXRVcChzZWxmKToKICAgICAgICBzZWxmLnByb2dyYW0gPSBJbml0aWFsaXNhYmxlUHJvZ3JhbSgpCiAgICAgICAgc2VsZi5wcm9ncmFtLmNyZWF0ZVRlc3RzID0gbGFtYmRhOiBOb25lCiAgICAgICAgRmFrZVJ1bm5lci5pbml0QXJncyA9IE5vbmUKICAgICAgICBGYWtlUnVubmVyLnRlc3QgPSBOb25lCiAgICAgICAgRmFrZVJ1bm5lci5yYWlzZUVycm9yID0gRmFsc2UKCiAgICBkZWYgdGVzdFZlcmJvc2l0eShzZWxmKToKICAgICAgICBwcm9ncmFtID0gc2VsZi5wcm9ncmFtCgogICAgICAgIGZvciBvcHQgaW4gJy1xJywgJy0tcXVpZXQnOgogICAgICAgICAgICBwcm9ncmFtLnZlcmJvc2l0eSA9IDEKICAgICAgICAgICAgcHJvZ3JhbS5wYXJzZUFyZ3MoW05vbmUsIG9wdF0pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS52ZXJib3NpdHksIDApCgogICAgICAgIGZvciBvcHQgaW4gJy12JywgJy0tdmVyYm9zZSc6CiAgICAgICAgICAgIHByb2dyYW0udmVyYm9zaXR5ID0gMQogICAgICAgICAgICBwcm9ncmFtLnBhcnNlQXJncyhbTm9uZSwgb3B0XSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm9ncmFtLnZlcmJvc2l0eSwgMikKCiAgICBkZWYgdGVzdEJ1ZmZlckNhdGNoRmFpbGZhc3Qoc2VsZik6CiAgICAgICAgcHJvZ3JhbSA9IHNlbGYucHJvZ3JhbQogICAgICAgIGZvciBhcmcsIGF0dHIgaW4gKCgnYnVmZmVyJywgJ2J1ZmZlcicpLCAoJ2ZhaWxmYXN0JywgJ2ZhaWxmYXN0JyksCiAgICAgICAgICAgICAgICAgICAgICAoJ2NhdGNoJywgJ2NhdGNoYnJlYWsnKSk6CiAgICAgICAgICAgIGlmIGF0dHIgPT0gJ2NhdGNoJyBhbmQgbm90IGhhc0luc3RhbGxIYW5kbGVyOgogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIHNob3J0X29wdCA9ICctJXMnICUgYXJnWzBdCiAgICAgICAgICAgIGxvbmdfb3B0ID0gJy0tJXMnICUgYXJnCiAgICAgICAgICAgIGZvciBvcHQgaW4gc2hvcnRfb3B0LCBsb25nX29wdDoKICAgICAgICAgICAgICAgIHNldGF0dHIocHJvZ3JhbSwgYXR0ciwgTm9uZSkKCiAgICAgICAgICAgICAgICBwcm9ncmFtLnBhcnNlQXJncyhbTm9uZSwgb3B0XSkKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShnZXRhdHRyKHByb2dyYW0sIGF0dHIpKQoKICAgICAgICAgICAgZm9yIG9wdCBpbiBzaG9ydF9vcHQsIGxvbmdfb3B0OgogICAgICAgICAgICAgICAgbm90X25vbmUgPSBvYmplY3QoKQogICAgICAgICAgICAgICAgc2V0YXR0cihwcm9ncmFtLCBhdHRyLCBub3Rfbm9uZSkKCiAgICAgICAgICAgICAgICBwcm9ncmFtLnBhcnNlQXJncyhbTm9uZSwgb3B0XSkKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZ2V0YXR0cihwcm9ncmFtLCBhdHRyKSwgbm90X25vbmUpCgogICAgZGVmIHRlc3RXYXJuaW5nKHNlbGYpOgogICAgICAgICIiIlRlc3QgdGhlIHdhcm5pbmdzIGFyZ3VtZW50IiIiCiAgICAgICAgIyBzZWUgIzEwNTM1CiAgICAgICAgY2xhc3MgRmFrZVRQKHVuaXR0ZXN0LlRlc3RQcm9ncmFtKToKICAgICAgICAgICAgZGVmIHBhcnNlQXJncyhzZWxmLCAqYXJncywgKiprdyk6IHBhc3MKICAgICAgICAgICAgZGVmIHJ1blRlc3RzKHNlbGYsICphcmdzLCAqKmt3KTogcGFzcwogICAgICAgIHdhcm5vcHRpb25zID0gc3lzLndhcm5vcHRpb25zWzpdCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzeXMud2Fybm9wdGlvbnNbOl0gPSBbXQogICAgICAgICAgICAjIG5vIHdhcm4gb3B0aW9ucywgbm8gYXJnIC0+IGRlZmF1bHQKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGYWtlVFAoKS53YXJuaW5ncywgJ2RlZmF1bHQnKQogICAgICAgICAgICAjIG5vIHdhcm4gb3B0aW9ucywgdy8gYXJnIC0+IGFyZyB2YWx1ZQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZha2VUUCh3YXJuaW5ncz0naWdub3JlJykud2FybmluZ3MsICdpZ25vcmUnKQogICAgICAgICAgICBzeXMud2Fybm9wdGlvbnNbOl0gPSBbJ3NvbWV2YWx1ZSddCiAgICAgICAgICAgICMgd2FybiBvcHRpb25zLCBubyBhcmcgLT4gTm9uZQogICAgICAgICAgICAjIHdhcm4gb3B0aW9ucywgdy8gYXJnIC0+IGFyZyB2YWx1ZQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZha2VUUCgpLndhcm5pbmdzLCBOb25lKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZha2VUUCh3YXJuaW5ncz0naWdub3JlJykud2FybmluZ3MsICdpZ25vcmUnKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHN5cy53YXJub3B0aW9uc1s6XSA9IHdhcm5vcHRpb25zCgogICAgZGVmIHRlc3RSdW5UZXN0c1J1bm5lckNsYXNzKHNlbGYpOgogICAgICAgIHByb2dyYW0gPSBzZWxmLnByb2dyYW0KCiAgICAgICAgcHJvZ3JhbS50ZXN0UnVubmVyID0gRmFrZVJ1bm5lcgogICAgICAgIHByb2dyYW0udmVyYm9zaXR5ID0gJ3ZlcmJvc2l0eScKICAgICAgICBwcm9ncmFtLmZhaWxmYXN0ID0gJ2ZhaWxmYXN0JwogICAgICAgIHByb2dyYW0uYnVmZmVyID0gJ2J1ZmZlcicKICAgICAgICBwcm9ncmFtLndhcm5pbmdzID0gJ3dhcm5pbmdzJwoKICAgICAgICBwcm9ncmFtLnJ1blRlc3RzKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGYWtlUnVubmVyLmluaXRBcmdzLCB7J3ZlcmJvc2l0eSc6ICd2ZXJib3NpdHknLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZmFpbGZhc3QnOiAnZmFpbGZhc3QnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYnVmZmVyJzogJ2J1ZmZlcicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd3YXJuaW5ncyc6ICd3YXJuaW5ncyd9KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRmFrZVJ1bm5lci50ZXN0LCAndGVzdCcpCiAgICAgICAgc2VsZi5hc3NlcnRJcyhwcm9ncmFtLnJlc3VsdCwgUkVTVUxUKQoKICAgIGRlZiB0ZXN0UnVuVGVzdHNSdW5uZXJJbnN0YW5jZShzZWxmKToKICAgICAgICBwcm9ncmFtID0gc2VsZi5wcm9ncmFtCgogICAgICAgIHByb2dyYW0udGVzdFJ1bm5lciA9IEZha2VSdW5uZXIoKQogICAgICAgIEZha2VSdW5uZXIuaW5pdEFyZ3MgPSBOb25lCgogICAgICAgIHByb2dyYW0ucnVuVGVzdHMoKQoKICAgICAgICAjIEEgbmV3IEZha2VSdW5uZXIgc2hvdWxkIG5vdCBoYXZlIGJlZW4gaW5zdGFudGlhdGVkCiAgICAgICAgc2VsZi5hc3NlcnRJc05vbmUoRmFrZVJ1bm5lci5pbml0QXJncykKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGYWtlUnVubmVyLnRlc3QsICd0ZXN0JykKICAgICAgICBzZWxmLmFzc2VydElzKHByb2dyYW0ucmVzdWx0LCBSRVNVTFQpCgogICAgZGVmIHRlc3RSdW5UZXN0c09sZFJ1bm5lckNsYXNzKHNlbGYpOgogICAgICAgIHByb2dyYW0gPSBzZWxmLnByb2dyYW0KCiAgICAgICAgRmFrZVJ1bm5lci5yYWlzZUVycm9yID0gVHJ1ZQogICAgICAgIHByb2dyYW0udGVzdFJ1bm5lciA9IEZha2VSdW5uZXIKICAgICAgICBwcm9ncmFtLnZlcmJvc2l0eSA9ICd2ZXJib3NpdHknCiAgICAgICAgcHJvZ3JhbS5mYWlsZmFzdCA9ICdmYWlsZmFzdCcKICAgICAgICBwcm9ncmFtLmJ1ZmZlciA9ICdidWZmZXInCiAgICAgICAgcHJvZ3JhbS50ZXN0ID0gJ3Rlc3QnCgogICAgICAgIHByb2dyYW0ucnVuVGVzdHMoKQoKICAgICAgICAjIElmIGluaXRpYWxpc2luZyByYWlzZXMgYSB0eXBlIGVycm9yIGl0IHNob3VsZCBiZSByZXRyaWVkCiAgICAgICAgIyB3aXRob3V0IHRoZSBuZXcga2V5d29yZCBhcmd1bWVudHMKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZha2VSdW5uZXIuaW5pdEFyZ3MsIHt9KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRmFrZVJ1bm5lci50ZXN0LCAndGVzdCcpCiAgICAgICAgc2VsZi5hc3NlcnRJcyhwcm9ncmFtLnJlc3VsdCwgUkVTVUxUKQoKICAgIGRlZiB0ZXN0Q2F0Y2hCcmVha0luc3RhbGxzSGFuZGxlcihzZWxmKToKICAgICAgICBtb2R1bGUgPSBzeXMubW9kdWxlc1sndW5pdHRlc3QubWFpbiddCiAgICAgICAgb3JpZ2luYWwgPSBtb2R1bGUuaW5zdGFsbEhhbmRsZXIKICAgICAgICBkZWYgcmVzdG9yZSgpOgogICAgICAgICAgICBtb2R1bGUuaW5zdGFsbEhhbmRsZXIgPSBvcmlnaW5hbAogICAgICAgIHNlbGYuYWRkQ2xlYW51cChyZXN0b3JlKQoKICAgICAgICBzZWxmLmluc3RhbGxlZCA9IEZhbHNlCiAgICAgICAgZGVmIGZha2VJbnN0YWxsSGFuZGxlcigpOgogICAgICAgICAgICBzZWxmLmluc3RhbGxlZCA9IFRydWUKICAgICAgICBtb2R1bGUuaW5zdGFsbEhhbmRsZXIgPSBmYWtlSW5zdGFsbEhhbmRsZXIKCiAgICAgICAgcHJvZ3JhbSA9IHNlbGYucHJvZ3JhbQogICAgICAgIHByb2dyYW0uY2F0Y2hicmVhayA9IFRydWUKCiAgICAgICAgcHJvZ3JhbS50ZXN0UnVubmVyID0gRmFrZVJ1bm5lcgoKICAgICAgICBwcm9ncmFtLnJ1blRlc3RzKCkKICAgICAgICBzZWxmLmFzc2VydFRydWUoc2VsZi5pbnN0YWxsZWQpCgogICAgZGVmIF9wYXRjaF9pc2ZpbGUoc2VsZiwgbmFtZXMsIGV4aXN0cz1UcnVlKToKICAgICAgICBkZWYgaXNmaWxlKHBhdGgpOgogICAgICAgICAgICByZXR1cm4gcGF0aCBpbiBuYW1lcwogICAgICAgIG9yaWdpbmFsID0gb3MucGF0aC5pc2ZpbGUKICAgICAgICBvcy5wYXRoLmlzZmlsZSA9IGlzZmlsZQogICAgICAgIGRlZiByZXN0b3JlKCk6CiAgICAgICAgICAgIG9zLnBhdGguaXNmaWxlID0gb3JpZ2luYWwKICAgICAgICBzZWxmLmFkZENsZWFudXAocmVzdG9yZSkKCgogICAgZGVmIHRlc3RQYXJzZUFyZ3NGaWxlTmFtZXMoc2VsZik6CiAgICAgICAgIyBydW5uaW5nIHRlc3RzIHdpdGggZmlsZW5hbWVzIGluc3RlYWQgb2YgbW9kdWxlIG5hbWVzCiAgICAgICAgcHJvZ3JhbSA9IHNlbGYucHJvZ3JhbQogICAgICAgIGFyZ3YgPSBbJ3Byb2duYW1lJywgJ2Zvby5weScsICdiYXIuUHknLCAnYmF6LlBZJywgJ3dpbmcudHh0J10KICAgICAgICBzZWxmLl9wYXRjaF9pc2ZpbGUoYXJndikKCiAgICAgICAgcHJvZ3JhbS5jcmVhdGVUZXN0cyA9IGxhbWJkYTogTm9uZQogICAgICAgIHByb2dyYW0ucGFyc2VBcmdzKGFyZ3YpCgogICAgICAgICMgbm90ZSB0aGF0ICd3aW5nLnR4dCcgaXMgbm90IGEgUHl0aG9uIGZpbGUgc28gdGhlIG5hbWUgc2hvdWxkCiAgICAgICAgIyAqbm90KiBiZSBjb252ZXJ0ZWQgdG8gYSBtb2R1bGUgbmFtZQogICAgICAgIGV4cGVjdGVkID0gWydmb28nLCAnYmFyJywgJ2JheicsICd3aW5nLnR4dCddCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm9ncmFtLnRlc3ROYW1lcywgZXhwZWN0ZWQpCgoKICAgIGRlZiB0ZXN0UGFyc2VBcmdzRmlsZVBhdGhzKHNlbGYpOgogICAgICAgIHByb2dyYW0gPSBzZWxmLnByb2dyYW0KICAgICAgICBhcmd2ID0gWydwcm9nbmFtZScsICdmb28vYmFyL2Jhei5weScsICdncmVlblxccmVkLnB5J10KICAgICAgICBzZWxmLl9wYXRjaF9pc2ZpbGUoYXJndikKCiAgICAgICAgcHJvZ3JhbS5jcmVhdGVUZXN0cyA9IGxhbWJkYTogTm9uZQogICAgICAgIHByb2dyYW0ucGFyc2VBcmdzKGFyZ3YpCgogICAgICAgIGV4cGVjdGVkID0gWydmb28uYmFyLmJheicsICdncmVlbi5yZWQnXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS50ZXN0TmFtZXMsIGV4cGVjdGVkKQoKCiAgICBkZWYgdGVzdFBhcnNlQXJnc05vbkV4aXN0ZW50RmlsZXMoc2VsZik6CiAgICAgICAgcHJvZ3JhbSA9IHNlbGYucHJvZ3JhbQogICAgICAgIGFyZ3YgPSBbJ3Byb2duYW1lJywgJ2Zvby9iYXIvYmF6LnB5JywgJ2dyZWVuXFxyZWQucHknXQogICAgICAgIHNlbGYuX3BhdGNoX2lzZmlsZShbXSkKCiAgICAgICAgcHJvZ3JhbS5jcmVhdGVUZXN0cyA9IGxhbWJkYTogTm9uZQogICAgICAgIHByb2dyYW0ucGFyc2VBcmdzKGFyZ3YpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS50ZXN0TmFtZXMsIGFyZ3ZbMTpdKQoKICAgIGRlZiB0ZXN0UGFyc2VBcmdzQWJzb2x1dGVQYXRoc1RoYXRDYW5CZUNvbnZlcnRlZChzZWxmKToKICAgICAgICBjdXJfZGlyID0gb3MuZ2V0Y3dkKCkKICAgICAgICBwcm9ncmFtID0gc2VsZi5wcm9ncmFtCiAgICAgICAgZGVmIF9qb2luKG5hbWUpOgogICAgICAgICAgICByZXR1cm4gb3MucGF0aC5qb2luKGN1cl9kaXIsIG5hbWUpCiAgICAgICAgYXJndiA9IFsncHJvZ25hbWUnLCBfam9pbignZm9vL2Jhci9iYXoucHknKSwgX2pvaW4oJ2dyZWVuXFxyZWQucHknKV0KICAgICAgICBzZWxmLl9wYXRjaF9pc2ZpbGUoYXJndikKCiAgICAgICAgcHJvZ3JhbS5jcmVhdGVUZXN0cyA9IGxhbWJkYTogTm9uZQogICAgICAgIHByb2dyYW0ucGFyc2VBcmdzKGFyZ3YpCgogICAgICAgIGV4cGVjdGVkID0gWydmb28uYmFyLmJheicsICdncmVlbi5yZWQnXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS50ZXN0TmFtZXMsIGV4cGVjdGVkKQoKICAgIGRlZiB0ZXN0UGFyc2VBcmdzQWJzb2x1dGVQYXRoc1RoYXRDYW5ub3RCZUNvbnZlcnRlZChzZWxmKToKICAgICAgICBwcm9ncmFtID0gc2VsZi5wcm9ncmFtCiAgICAgICAgIyBldmVuIG9uIFdpbmRvd3MgJy8uLi4nIGlzIGNvbnNpZGVyZWQgYWJzb2x1dGUgYnkgb3MucGF0aC5hYnNwYXRoCiAgICAgICAgYXJndiA9IFsncHJvZ25hbWUnLCAnL2Zvby9iYXIvYmF6LnB5JywgJy9ncmVlbi9yZWQucHknXQogICAgICAgIHNlbGYuX3BhdGNoX2lzZmlsZShhcmd2KQoKICAgICAgICBwcm9ncmFtLmNyZWF0ZVRlc3RzID0gbGFtYmRhOiBOb25lCiAgICAgICAgcHJvZ3JhbS5wYXJzZUFyZ3MoYXJndikKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm9ncmFtLnRlc3ROYW1lcywgYXJndlsxOl0pCgogICAgICAgICMgaXQgbWF5IGJlIGJldHRlciB0byB1c2UgcGxhdGZvcm0gc3BlY2lmaWMgZnVuY3Rpb25zIHRvIG5vcm1hbGlzZSBwYXRocwogICAgICAgICMgcmF0aGVyIHRoYW4gYWNjZXB0aW5nICcuUFknIGFuZCAnXCcgYXMgZmlsZSBzZXByYXRvciBvbiBMaW51eCAvIE1hYwogICAgICAgICMgaXQgd291bGQgYWxzbyBiZSBiZXR0ZXIgdG8gY2hlY2sgdGhhdCBhIGZpbGVuYW1lIGlzIGEgdmFsaWQgbW9kdWxlCiAgICAgICAgIyBpZGVudGlmaWVyICh3ZSBoYXZlIGEgcmVnZXggZm9yIHRoaXMgaW4gbG9hZGVyLnB5KQogICAgICAgICMgZm9yIGludmFsaWQgZmlsZW5hbWVzIHNob3VsZCB3ZSByYWlzZSBhIHVzZWZ1bCBlcnJvciByYXRoZXIgdGhhbgogICAgICAgICMgbGVhdmluZyB0aGUgY3VycmVudCBlcnJvciBtZXNzYWdlIChpbXBvcnQgb2YgZmlsZW5hbWUgZmFpbHMpIGluIHBsYWNlPwoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICB1bml0dGVzdC5tYWluKCkK',
'/Lib/unittest/test/test_result.py':'aW1wb3J0IGlvCmltcG9ydCBzeXMKaW1wb3J0IHRleHR3cmFwCgpmcm9tIHRlc3QgaW1wb3J0IHN1cHBvcnQKCmltcG9ydCB0cmFjZWJhY2sKaW1wb3J0IHVuaXR0ZXN0CgoKY2xhc3MgVGVzdF9UZXN0UmVzdWx0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICMgTm90ZTogdGhlcmUgYXJlIG5vdCBzZXBhcmF0ZSB0ZXN0cyBmb3IgVGVzdFJlc3VsdC53YXNTdWNjZXNzZnVsKCksCiAgICAjIFRlc3RSZXN1bHQuZXJyb3JzLCBUZXN0UmVzdWx0LmZhaWx1cmVzLCBUZXN0UmVzdWx0LnRlc3RzUnVuIG9yCiAgICAjIFRlc3RSZXN1bHQuc2hvdWxkU3RvcCBiZWNhdXNlIHRoZXNlIG9ubHkgaGF2ZSBtZWFuaW5nIGluIHRlcm1zIG9mCiAgICAjIG90aGVyIFRlc3RSZXN1bHQgbWV0aG9kcy4KICAgICMKICAgICMgQWNjb3JkaW5nbHksIHRlc3RzIGZvciB0aGUgYWZvcmVuYW1lZCBhdHRyaWJ1dGVzIGFyZSBpbmNvcnBvcmF0ZWQKICAgICMgaW4gd2l0aCB0aGUgdGVzdHMgZm9yIHRoZSBkZWZpbmluZyBtZXRob2RzLgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgIGRlZiB0ZXN0X2luaXQoc2VsZik6CiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCgogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShyZXN1bHQud2FzU3VjY2Vzc2Z1bCgpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAwKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5mYWlsdXJlcyksIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQuc2hvdWxkU3RvcCwgRmFsc2UpCiAgICAgICAgc2VsZi5hc3NlcnRJc05vbmUocmVzdWx0Ll9zdGRvdXRfYnVmZmVyKQogICAgICAgIHNlbGYuYXNzZXJ0SXNOb25lKHJlc3VsdC5fc3RkZXJyX2J1ZmZlcikKCiAgICAjICJUaGlzIG1ldGhvZCBjYW4gYmUgY2FsbGVkIHRvIHNpZ25hbCB0aGF0IHRoZSBzZXQgb2YgdGVzdHMgYmVpbmcKICAgICMgcnVuIHNob3VsZCBiZSBhYm9ydGVkIGJ5IHNldHRpbmcgdGhlIFRlc3RSZXN1bHQncyBzaG91bGRTdG9wCiAgICAjIGF0dHJpYnV0ZSB0byBUcnVlLiIKICAgIGRlZiB0ZXN0X3N0b3Aoc2VsZik6CiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCgogICAgICAgIHJlc3VsdC5zdG9wKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQuc2hvdWxkU3RvcCwgVHJ1ZSkKCiAgICAjICJDYWxsZWQgd2hlbiB0aGUgdGVzdCBjYXNlIHRlc3QgaXMgYWJvdXQgdG8gYmUgcnVuLiBUaGUgZGVmYXVsdAogICAgIyBpbXBsZW1lbnRhdGlvbiBzaW1wbHkgaW5jcmVtZW50cyB0aGUgaW5zdGFuY2UncyB0ZXN0c1J1biBjb3VudGVyLiIKICAgIGRlZiB0ZXN0X3N0YXJ0VGVzdChzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICB0ZXN0ID0gRm9vKCd0ZXN0XzEnKQoKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKCiAgICAgICAgcmVzdWx0LnN0YXJ0VGVzdCh0ZXN0KQoKICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0Lndhc1N1Y2Nlc3NmdWwoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZXJyb3JzKSwgMCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZmFpbHVyZXMpLCAwKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnNob3VsZFN0b3AsIEZhbHNlKQoKICAgICAgICByZXN1bHQuc3RvcFRlc3QodGVzdCkKCiAgICAjICJDYWxsZWQgYWZ0ZXIgdGhlIHRlc3QgY2FzZSB0ZXN0IGhhcyBiZWVuIGV4ZWN1dGVkLCByZWdhcmRsZXNzIG9mCiAgICAjIHRoZSBvdXRjb21lLiBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBkb2VzIG5vdGhpbmcuIgogICAgZGVmIHRlc3Rfc3RvcFRlc3Qoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgdGVzdCA9IEZvbygndGVzdF8xJykKCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCgogICAgICAgIHJlc3VsdC5zdGFydFRlc3QodGVzdCkKCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHJlc3VsdC53YXNTdWNjZXNzZnVsKCkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmZhaWx1cmVzKSwgMCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC50ZXN0c1J1biwgMSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC5zaG91bGRTdG9wLCBGYWxzZSkKCiAgICAgICAgcmVzdWx0LnN0b3BUZXN0KHRlc3QpCgogICAgICAgICMgU2FtZSB0ZXN0cyBhcyBhYm92ZTsgbWFrZSBzdXJlIG5vdGhpbmcgaGFzIGNoYW5nZWQKICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0Lndhc1N1Y2Nlc3NmdWwoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZXJyb3JzKSwgMCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZmFpbHVyZXMpLCAwKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnNob3VsZFN0b3AsIEZhbHNlKQoKICAgICMgIkNhbGxlZCBiZWZvcmUgYW5kIGFmdGVyIHRlc3RzIGFyZSBydW4uIFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIGRvZXMgbm90aGluZy4iCiAgICBkZWYgdGVzdF9zdGFydFRlc3RSdW5fc3RvcFRlc3RSdW4oc2VsZik6CiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgcmVzdWx0LnN0YXJ0VGVzdFJ1bigpCiAgICAgICAgcmVzdWx0LnN0b3BUZXN0UnVuKCkKCiAgICAjICJhZGRTdWNjZXNzKHRlc3QpIgogICAgIyAuLi4KICAgICMgIkNhbGxlZCB3aGVuIHRoZSB0ZXN0IGNhc2UgdGVzdCBzdWNjZWVkcyIKICAgICMgLi4uCiAgICAjICJ3YXNTdWNjZXNzZnVsKCkgLSBSZXR1cm5zIFRydWUgaWYgYWxsIHRlc3RzIHJ1biBzbyBmYXIgaGF2ZSBwYXNzZWQsCiAgICAjIG90aGVyd2lzZSByZXR1cm5zIEZhbHNlIgogICAgIyAuLi4KICAgICMgInRlc3RzUnVuIC0gVGhlIHRvdGFsIG51bWJlciBvZiB0ZXN0cyBydW4gc28gZmFyLiIKICAgICMgLi4uCiAgICAjICJlcnJvcnMgLSBBIGxpc3QgY29udGFpbmluZyAyLXR1cGxlcyBvZiBUZXN0Q2FzZSBpbnN0YW5jZXMgYW5kCiAgICAjIGZvcm1hdHRlZCB0cmFjZWJhY2tzLiBFYWNoIHR1cGxlIHJlcHJlc2VudHMgYSB0ZXN0IHdoaWNoIHJhaXNlZCBhbgogICAgIyB1bmV4cGVjdGVkIGV4Y2VwdGlvbi4gQ29udGFpbnMgZm9ybWF0dGVkCiAgICAjIHRyYWNlYmFja3MgaW5zdGVhZCBvZiBzeXMuZXhjX2luZm8oKSByZXN1bHRzLiIKICAgICMgLi4uCiAgICAjICJmYWlsdXJlcyAtIEEgbGlzdCBjb250YWluaW5nIDItdHVwbGVzIG9mIFRlc3RDYXNlIGluc3RhbmNlcyBhbmQKICAgICMgZm9ybWF0dGVkIHRyYWNlYmFja3MuIEVhY2ggdHVwbGUgcmVwcmVzZW50cyBhIHRlc3Qgd2hlcmUgYSBmYWlsdXJlIHdhcwogICAgIyBleHBsaWNpdGx5IHNpZ25hbGxlZCB1c2luZyB0aGUgVGVzdENhc2UuZmFpbCooKSBvciBUZXN0Q2FzZS5hc3NlcnQqKCkKICAgICMgbWV0aG9kcy4gQ29udGFpbnMgZm9ybWF0dGVkIHRyYWNlYmFja3MgaW5zdGVhZAogICAgIyBvZiBzeXMuZXhjX2luZm8oKSByZXN1bHRzLiIKICAgIGRlZiB0ZXN0X2FkZFN1Y2Nlc3Moc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgdGVzdCA9IEZvbygndGVzdF8xJykKCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCgogICAgICAgIHJlc3VsdC5zdGFydFRlc3QodGVzdCkKICAgICAgICByZXN1bHQuYWRkU3VjY2Vzcyh0ZXN0KQogICAgICAgIHJlc3VsdC5zdG9wVGVzdCh0ZXN0KQoKICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0Lndhc1N1Y2Nlc3NmdWwoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZXJyb3JzKSwgMCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZmFpbHVyZXMpLCAwKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnNob3VsZFN0b3AsIEZhbHNlKQoKICAgICMgImFkZEZhaWx1cmUodGVzdCwgZXJyKSIKICAgICMgLi4uCiAgICAjICJDYWxsZWQgd2hlbiB0aGUgdGVzdCBjYXNlIHRlc3Qgc2lnbmFscyBhIGZhaWx1cmUuIGVyciBpcyBhIHR1cGxlIG9mCiAgICAjIHRoZSBmb3JtIHJldHVybmVkIGJ5IHN5cy5leGNfaW5mbygpOiAodHlwZSwgdmFsdWUsIHRyYWNlYmFjaykiCiAgICAjIC4uLgogICAgIyAid2FzU3VjY2Vzc2Z1bCgpIC0gUmV0dXJucyBUcnVlIGlmIGFsbCB0ZXN0cyBydW4gc28gZmFyIGhhdmUgcGFzc2VkLAogICAgIyBvdGhlcndpc2UgcmV0dXJucyBGYWxzZSIKICAgICMgLi4uCiAgICAjICJ0ZXN0c1J1biAtIFRoZSB0b3RhbCBudW1iZXIgb2YgdGVzdHMgcnVuIHNvIGZhci4iCiAgICAjIC4uLgogICAgIyAiZXJyb3JzIC0gQSBsaXN0IGNvbnRhaW5pbmcgMi10dXBsZXMgb2YgVGVzdENhc2UgaW5zdGFuY2VzIGFuZAogICAgIyBmb3JtYXR0ZWQgdHJhY2ViYWNrcy4gRWFjaCB0dXBsZSByZXByZXNlbnRzIGEgdGVzdCB3aGljaCByYWlzZWQgYW4KICAgICMgdW5leHBlY3RlZCBleGNlcHRpb24uIENvbnRhaW5zIGZvcm1hdHRlZAogICAgIyB0cmFjZWJhY2tzIGluc3RlYWQgb2Ygc3lzLmV4Y19pbmZvKCkgcmVzdWx0cy4iCiAgICAjIC4uLgogICAgIyAiZmFpbHVyZXMgLSBBIGxpc3QgY29udGFpbmluZyAyLXR1cGxlcyBvZiBUZXN0Q2FzZSBpbnN0YW5jZXMgYW5kCiAgICAjIGZvcm1hdHRlZCB0cmFjZWJhY2tzLiBFYWNoIHR1cGxlIHJlcHJlc2VudHMgYSB0ZXN0IHdoZXJlIGEgZmFpbHVyZSB3YXMKICAgICMgZXhwbGljaXRseSBzaWduYWxsZWQgdXNpbmcgdGhlIFRlc3RDYXNlLmZhaWwqKCkgb3IgVGVzdENhc2UuYXNzZXJ0KigpCiAgICAjIG1ldGhvZHMuIENvbnRhaW5zIGZvcm1hdHRlZCB0cmFjZWJhY2tzIGluc3RlYWQKICAgICMgb2Ygc3lzLmV4Y19pbmZvKCkgcmVzdWx0cy4iCiAgICBkZWYgdGVzdF9hZGRGYWlsdXJlKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0XzEoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIHRlc3QgPSBGb28oJ3Rlc3RfMScpCiAgICAgICAgdHJ5OgogICAgICAgICAgICB0ZXN0LmZhaWwoImZvbyIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBleGNfaW5mb190dXBsZSA9IHN5cy5leGNfaW5mbygpCgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQoKICAgICAgICByZXN1bHQuc3RhcnRUZXN0KHRlc3QpCiAgICAgICAgcmVzdWx0LmFkZEZhaWx1cmUodGVzdCwgZXhjX2luZm9fdHVwbGUpCiAgICAgICAgcmVzdWx0LnN0b3BUZXN0KHRlc3QpCgogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UocmVzdWx0Lndhc1N1Y2Nlc3NmdWwoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZXJyb3JzKSwgMCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZmFpbHVyZXMpLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnNob3VsZFN0b3AsIEZhbHNlKQoKICAgICAgICB0ZXN0X2Nhc2UsIGZvcm1hdHRlZF9leGMgPSByZXN1bHQuZmFpbHVyZXNbMF0KICAgICAgICBzZWxmLmFzc2VydFRydWUodGVzdF9jYXNlIGlzIHRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGZvcm1hdHRlZF9leGMsIHN0cikKCiAgICAjICJhZGRFcnJvcih0ZXN0LCBlcnIpIgogICAgIyAuLi4KICAgICMgIkNhbGxlZCB3aGVuIHRoZSB0ZXN0IGNhc2UgdGVzdCByYWlzZXMgYW4gdW5leHBlY3RlZCBleGNlcHRpb24gZXJyCiAgICAjIGlzIGEgdHVwbGUgb2YgdGhlIGZvcm0gcmV0dXJuZWQgYnkgc3lzLmV4Y19pbmZvKCk6CiAgICAjICh0eXBlLCB2YWx1ZSwgdHJhY2ViYWNrKSIKICAgICMgLi4uCiAgICAjICJ3YXNTdWNjZXNzZnVsKCkgLSBSZXR1cm5zIFRydWUgaWYgYWxsIHRlc3RzIHJ1biBzbyBmYXIgaGF2ZSBwYXNzZWQsCiAgICAjIG90aGVyd2lzZSByZXR1cm5zIEZhbHNlIgogICAgIyAuLi4KICAgICMgInRlc3RzUnVuIC0gVGhlIHRvdGFsIG51bWJlciBvZiB0ZXN0cyBydW4gc28gZmFyLiIKICAgICMgLi4uCiAgICAjICJlcnJvcnMgLSBBIGxpc3QgY29udGFpbmluZyAyLXR1cGxlcyBvZiBUZXN0Q2FzZSBpbnN0YW5jZXMgYW5kCiAgICAjIGZvcm1hdHRlZCB0cmFjZWJhY2tzLiBFYWNoIHR1cGxlIHJlcHJlc2VudHMgYSB0ZXN0IHdoaWNoIHJhaXNlZCBhbgogICAgIyB1bmV4cGVjdGVkIGV4Y2VwdGlvbi4gQ29udGFpbnMgZm9ybWF0dGVkCiAgICAjIHRyYWNlYmFja3MgaW5zdGVhZCBvZiBzeXMuZXhjX2luZm8oKSByZXN1bHRzLiIKICAgICMgLi4uCiAgICAjICJmYWlsdXJlcyAtIEEgbGlzdCBjb250YWluaW5nIDItdHVwbGVzIG9mIFRlc3RDYXNlIGluc3RhbmNlcyBhbmQKICAgICMgZm9ybWF0dGVkIHRyYWNlYmFja3MuIEVhY2ggdHVwbGUgcmVwcmVzZW50cyBhIHRlc3Qgd2hlcmUgYSBmYWlsdXJlIHdhcwogICAgIyBleHBsaWNpdGx5IHNpZ25hbGxlZCB1c2luZyB0aGUgVGVzdENhc2UuZmFpbCooKSBvciBUZXN0Q2FzZS5hc3NlcnQqKCkKICAgICMgbWV0aG9kcy4gQ29udGFpbnMgZm9ybWF0dGVkIHRyYWNlYmFja3MgaW5zdGVhZAogICAgIyBvZiBzeXMuZXhjX2luZm8oKSByZXN1bHRzLiIKICAgIGRlZiB0ZXN0X2FkZEVycm9yKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0XzEoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIHRlc3QgPSBGb28oJ3Rlc3RfMScpCiAgICAgICAgdHJ5OgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgZXhjX2luZm9fdHVwbGUgPSBzeXMuZXhjX2luZm8oKQoKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKCiAgICAgICAgcmVzdWx0LnN0YXJ0VGVzdCh0ZXN0KQogICAgICAgIHJlc3VsdC5hZGRFcnJvcih0ZXN0LCBleGNfaW5mb190dXBsZSkKICAgICAgICByZXN1bHQuc3RvcFRlc3QodGVzdCkKCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShyZXN1bHQud2FzU3VjY2Vzc2Z1bCgpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5mYWlsdXJlcyksIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDEpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQuc2hvdWxkU3RvcCwgRmFsc2UpCgogICAgICAgIHRlc3RfY2FzZSwgZm9ybWF0dGVkX2V4YyA9IHJlc3VsdC5lcnJvcnNbMF0KICAgICAgICBzZWxmLmFzc2VydFRydWUodGVzdF9jYXNlIGlzIHRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGZvcm1hdHRlZF9leGMsIHN0cikKCiAgICBkZWYgdGVzdEdldERlc2NyaXB0aW9uV2l0aG91dERvY3N0cmluZyhzZWxmKToKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXh0VGVzdFJlc3VsdChOb25lLCBUcnVlLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoCiAgICAgICAgICAgICAgICByZXN1bHQuZ2V0RGVzY3JpcHRpb24oc2VsZiksCiAgICAgICAgICAgICAgICAndGVzdEdldERlc2NyaXB0aW9uV2l0aG91dERvY3N0cmluZyAoJyArIF9fbmFtZV9fICsKICAgICAgICAgICAgICAgICcuVGVzdF9UZXN0UmVzdWx0KScpCgogICAgQHVuaXR0ZXN0LnNraXBJZihzeXMuZmxhZ3Mub3B0aW1pemUgPj0gMiwKICAgICAgICAgICAgICAgICAgICAgIkRvY3N0cmluZ3MgYXJlIG9taXR0ZWQgd2l0aCAtTzIgYW5kIGFib3ZlIikKICAgIGRlZiB0ZXN0R2V0RGVzY3JpcHRpb25XaXRoT25lTGluZURvY3N0cmluZyhzZWxmKToKICAgICAgICAiIiJUZXN0cyBnZXREZXNjcmlwdGlvbigpIGZvciBhIG1ldGhvZCB3aXRoIGEgZG9jc3RyaW5nLiIiIgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRleHRUZXN0UmVzdWx0KE5vbmUsIFRydWUsIDEpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgKICAgICAgICAgICAgICAgIHJlc3VsdC5nZXREZXNjcmlwdGlvbihzZWxmKSwKICAgICAgICAgICAgICAgKCd0ZXN0R2V0RGVzY3JpcHRpb25XaXRoT25lTGluZURvY3N0cmluZyAnCiAgICAgICAgICAgICAgICAnKCcgKyBfX25hbWVfXyArICcuVGVzdF9UZXN0UmVzdWx0KVxuJwogICAgICAgICAgICAgICAgJ1Rlc3RzIGdldERlc2NyaXB0aW9uKCkgZm9yIGEgbWV0aG9kIHdpdGggYSBkb2NzdHJpbmcuJykpCgogICAgQHVuaXR0ZXN0LnNraXBJZihzeXMuZmxhZ3Mub3B0aW1pemUgPj0gMiwKICAgICAgICAgICAgICAgICAgICAgIkRvY3N0cmluZ3MgYXJlIG9taXR0ZWQgd2l0aCAtTzIgYW5kIGFib3ZlIikKICAgIGRlZiB0ZXN0R2V0RGVzY3JpcHRpb25XaXRoTXVsdGlMaW5lRG9jc3RyaW5nKHNlbGYpOgogICAgICAgICIiIlRlc3RzIGdldERlc2NyaXB0aW9uKCkgZm9yIGEgbWV0aG9kIHdpdGggYSBsb25nZXIgZG9jc3RyaW5nLgogICAgICAgIFRoZSBzZWNvbmQgbGluZSBvZiB0aGUgZG9jc3RyaW5nLgogICAgICAgICIiIgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRleHRUZXN0UmVzdWx0KE5vbmUsIFRydWUsIDEpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgKICAgICAgICAgICAgICAgIHJlc3VsdC5nZXREZXNjcmlwdGlvbihzZWxmKSwKICAgICAgICAgICAgICAgKCd0ZXN0R2V0RGVzY3JpcHRpb25XaXRoTXVsdGlMaW5lRG9jc3RyaW5nICcKICAgICAgICAgICAgICAgICcoJyArIF9fbmFtZV9fICsgJy5UZXN0X1Rlc3RSZXN1bHQpXG4nCiAgICAgICAgICAgICAgICAnVGVzdHMgZ2V0RGVzY3JpcHRpb24oKSBmb3IgYSBtZXRob2Qgd2l0aCBhIGxvbmdlciAnCiAgICAgICAgICAgICAgICAnZG9jc3RyaW5nLicpKQoKICAgIGRlZiB0ZXN0U3RhY2tGcmFtZVRyaW1taW5nKHNlbGYpOgogICAgICAgIGNsYXNzIEZyYW1lKG9iamVjdCk6CiAgICAgICAgICAgIGNsYXNzIHRiX2ZyYW1lKG9iamVjdCk6CiAgICAgICAgICAgICAgICBmX2dsb2JhbHMgPSB7fQogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UocmVzdWx0Ll9pc19yZWxldmFudF90Yl9sZXZlbChGcmFtZSkpCgogICAgICAgIEZyYW1lLnRiX2ZyYW1lLmZfZ2xvYmFsc1snX191bml0dGVzdCddID0gVHJ1ZQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShyZXN1bHQuX2lzX3JlbGV2YW50X3RiX2xldmVsKEZyYW1lKSkKCiAgICBkZWYgdGVzdEZhaWxGYXN0KHNlbGYpOgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHJlc3VsdC5fZXhjX2luZm9fdG9fc3RyaW5nID0gbGFtYmRhICpfOiAnJwogICAgICAgIHJlc3VsdC5mYWlsZmFzdCA9IFRydWUKICAgICAgICByZXN1bHQuYWRkRXJyb3IoTm9uZSwgTm9uZSkKICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0LnNob3VsZFN0b3ApCgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHJlc3VsdC5fZXhjX2luZm9fdG9fc3RyaW5nID0gbGFtYmRhICpfOiAnJwogICAgICAgIHJlc3VsdC5mYWlsZmFzdCA9IFRydWUKICAgICAgICByZXN1bHQuYWRkRmFpbHVyZShOb25lLCBOb25lKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShyZXN1bHQuc2hvdWxkU3RvcCkKCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgcmVzdWx0Ll9leGNfaW5mb190b19zdHJpbmcgPSBsYW1iZGEgKl86ICcnCiAgICAgICAgcmVzdWx0LmZhaWxmYXN0ID0gVHJ1ZQogICAgICAgIHJlc3VsdC5hZGRVbmV4cGVjdGVkU3VjY2VzcyhOb25lKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShyZXN1bHQuc2hvdWxkU3RvcCkKCiAgICBkZWYgdGVzdEZhaWxGYXN0U2V0QnlSdW5uZXIoc2VsZik6CiAgICAgICAgcnVubmVyID0gdW5pdHRlc3QuVGV4dFRlc3RSdW5uZXIoc3RyZWFtPWlvLlN0cmluZ0lPKCksIGZhaWxmYXN0PVRydWUpCiAgICAgICAgZGVmIHRlc3QocmVzdWx0KToKICAgICAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHJlc3VsdC5mYWlsZmFzdCkKICAgICAgICByZXN1bHQgPSBydW5uZXIucnVuKHRlc3QpCgoKY2xhc3NEaWN0ID0gZGljdCh1bml0dGVzdC5UZXN0UmVzdWx0Ll9fZGljdF9fKQpmb3IgbSBpbiAoJ2FkZFNraXAnLCAnYWRkRXhwZWN0ZWRGYWlsdXJlJywgJ2FkZFVuZXhwZWN0ZWRTdWNjZXNzJywKICAgICAgICAgICAnX19pbml0X18nKToKICAgIGRlbCBjbGFzc0RpY3RbbV0KCmRlZiBfX2luaXRfXyhzZWxmLCBzdHJlYW09Tm9uZSwgZGVzY3JpcHRpb25zPU5vbmUsIHZlcmJvc2l0eT1Ob25lKToKICAgIHNlbGYuZmFpbHVyZXMgPSBbXQogICAgc2VsZi5lcnJvcnMgPSBbXQogICAgc2VsZi50ZXN0c1J1biA9IDAKICAgIHNlbGYuc2hvdWxkU3RvcCA9IEZhbHNlCiAgICBzZWxmLmJ1ZmZlciA9IEZhbHNlCgpjbGFzc0RpY3RbJ19faW5pdF9fJ10gPSBfX2luaXRfXwpPbGRSZXN1bHQgPSB0eXBlKCdPbGRSZXN1bHQnLCAob2JqZWN0LCksIGNsYXNzRGljdCkKCmNsYXNzIFRlc3RfT2xkVGVzdFJlc3VsdCh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIGFzc2VydE9sZFJlc3VsdFdhcm5pbmcoc2VsZiwgdGVzdCwgZmFpbHVyZXMpOgogICAgICAgIHdpdGggc3VwcG9ydC5jaGVja193YXJuaW5ncygoIlRlc3RSZXN1bHQgaGFzIG5vIGFkZC4rIG1ldGhvZCwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUnVudGltZVdhcm5pbmcpKToKICAgICAgICAgICAgcmVzdWx0ID0gT2xkUmVzdWx0KCkKICAgICAgICAgICAgdGVzdC5ydW4ocmVzdWx0KQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZmFpbHVyZXMpLCBmYWlsdXJlcykKCiAgICBkZWYgdGVzdE9sZFRlc3RSZXN1bHQoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0U2tpcChzZWxmKToKICAgICAgICAgICAgICAgIHNlbGYuc2tpcFRlc3QoJ2Zvb2JhcicpCiAgICAgICAgICAgIEB1bml0dGVzdC5leHBlY3RlZEZhaWx1cmUKICAgICAgICAgICAgZGVmIHRlc3RFeHBlY3RlZEZhaWwoc2VsZik6CiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IKICAgICAgICAgICAgQHVuaXR0ZXN0LmV4cGVjdGVkRmFpbHVyZQogICAgICAgICAgICBkZWYgdGVzdFVuZXhwZWN0ZWRTdWNjZXNzKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBmb3IgdGVzdF9uYW1lLCBzaG91bGRfcGFzcyBpbiAoKCd0ZXN0U2tpcCcsIFRydWUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoJ3Rlc3RFeHBlY3RlZEZhaWwnLCBUcnVlKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCd0ZXN0VW5leHBlY3RlZFN1Y2Nlc3MnLCBGYWxzZSkpOgogICAgICAgICAgICB0ZXN0ID0gVGVzdCh0ZXN0X25hbWUpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0T2xkUmVzdWx0V2FybmluZyh0ZXN0LCBpbnQobm90IHNob3VsZF9wYXNzKSkKCiAgICBkZWYgdGVzdE9sZFRlc3RUZXN1bHRTZXR1cChzZWxmKToKICAgICAgICBjbGFzcyBUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHNldFVwKHNlbGYpOgogICAgICAgICAgICAgICAgc2VsZi5za2lwVGVzdCgnbm8gcmVhc29uJykKICAgICAgICAgICAgZGVmIHRlc3RGb28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgc2VsZi5hc3NlcnRPbGRSZXN1bHRXYXJuaW5nKFRlc3QoJ3Rlc3RGb28nKSwgMCkKCiAgICBkZWYgdGVzdE9sZFRlc3RSZXN1bHRDbGFzcyhzZWxmKToKICAgICAgICBAdW5pdHRlc3Quc2tpcCgnbm8gcmVhc29uJykKICAgICAgICBjbGFzcyBUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RGb28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgc2VsZi5hc3NlcnRPbGRSZXN1bHRXYXJuaW5nKFRlc3QoJ3Rlc3RGb28nKSwgMCkKCiAgICBkZWYgdGVzdE9sZFJlc3VsdFdpdGhSdW5uZXIoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0Rm9vKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIHJ1bm5lciA9IHVuaXR0ZXN0LlRleHRUZXN0UnVubmVyKHJlc3VsdGNsYXNzPU9sZFJlc3VsdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyZWFtPWlvLlN0cmluZ0lPKCkpCiAgICAgICAgIyBUaGlzIHdpbGwgcmFpc2UgYW4gZXhjZXB0aW9uIGlmIFRleHRUZXN0UnVubmVyIGNhbid0IGhhbmRsZSBvbGQKICAgICAgICAjIHRlc3QgcmVzdWx0IG9iamVjdHMKICAgICAgICBydW5uZXIucnVuKFRlc3QoJ3Rlc3RGb28nKSkKCgpjbGFzcyBNb2NrVHJhY2ViYWNrKG9iamVjdCk6CiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZm9ybWF0X2V4Y2VwdGlvbigqXyk6CiAgICAgICAgcmV0dXJuIFsnQSB0cmFjZWJhY2snXQoKZGVmIHJlc3RvcmVfdHJhY2ViYWNrKCk6CiAgICB1bml0dGVzdC5yZXN1bHQudHJhY2ViYWNrID0gdHJhY2ViYWNrCgoKY2xhc3MgVGVzdE91dHB1dEJ1ZmZlcmluZyh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIHNldFVwKHNlbGYpOgogICAgICAgIHNlbGYuX3JlYWxfb3V0ID0gc3lzLnN0ZG91dAogICAgICAgIHNlbGYuX3JlYWxfZXJyID0gc3lzLnN0ZGVycgoKICAgIGRlZiB0ZWFyRG93bihzZWxmKToKICAgICAgICBzeXMuc3Rkb3V0ID0gc2VsZi5fcmVhbF9vdXQKICAgICAgICBzeXMuc3RkZXJyID0gc2VsZi5fcmVhbF9lcnIKCiAgICBkZWYgdGVzdEJ1ZmZlck91dHB1dE9mZihzZWxmKToKICAgICAgICByZWFsX291dCA9IHNlbGYuX3JlYWxfb3V0CiAgICAgICAgcmVhbF9lcnIgPSBzZWxmLl9yZWFsX2VycgoKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKHJlc3VsdC5idWZmZXIpCgogICAgICAgIHNlbGYuYXNzZXJ0SXMocmVhbF9vdXQsIHN5cy5zdGRvdXQpCiAgICAgICAgc2VsZi5hc3NlcnRJcyhyZWFsX2Vyciwgc3lzLnN0ZGVycikKCiAgICAgICAgcmVzdWx0LnN0YXJ0VGVzdChzZWxmKQoKICAgICAgICBzZWxmLmFzc2VydElzKHJlYWxfb3V0LCBzeXMuc3Rkb3V0KQogICAgICAgIHNlbGYuYXNzZXJ0SXMocmVhbF9lcnIsIHN5cy5zdGRlcnIpCgogICAgZGVmIHRlc3RCdWZmZXJPdXRwdXRTdGFydFRlc3RBZGRTdWNjZXNzKHNlbGYpOgogICAgICAgIHJlYWxfb3V0ID0gc2VsZi5fcmVhbF9vdXQKICAgICAgICByZWFsX2VyciA9IHNlbGYuX3JlYWxfZXJyCgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UocmVzdWx0LmJ1ZmZlcikKCiAgICAgICAgcmVzdWx0LmJ1ZmZlciA9IFRydWUKCiAgICAgICAgc2VsZi5hc3NlcnRJcyhyZWFsX291dCwgc3lzLnN0ZG91dCkKICAgICAgICBzZWxmLmFzc2VydElzKHJlYWxfZXJyLCBzeXMuc3RkZXJyKQoKICAgICAgICByZXN1bHQuc3RhcnRUZXN0KHNlbGYpCgogICAgICAgIHNlbGYuYXNzZXJ0SXNOb3QocmVhbF9vdXQsIHN5cy5zdGRvdXQpCiAgICAgICAgc2VsZi5hc3NlcnRJc05vdChyZWFsX2Vyciwgc3lzLnN0ZGVycikKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3lzLnN0ZG91dCwgaW8uU3RyaW5nSU8pCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHN5cy5zdGRlcnIsIGlvLlN0cmluZ0lPKQogICAgICAgIHNlbGYuYXNzZXJ0SXNOb3Qoc3lzLnN0ZG91dCwgc3lzLnN0ZGVycikKCiAgICAgICAgb3V0X3N0cmVhbSA9IHN5cy5zdGRvdXQKICAgICAgICBlcnJfc3RyZWFtID0gc3lzLnN0ZGVycgoKICAgICAgICByZXN1bHQuX29yaWdpbmFsX3N0ZG91dCA9IGlvLlN0cmluZ0lPKCkKICAgICAgICByZXN1bHQuX29yaWdpbmFsX3N0ZGVyciA9IGlvLlN0cmluZ0lPKCkKCiAgICAgICAgcHJpbnQoJ2ZvbycpCiAgICAgICAgcHJpbnQoJ2JhcicsIGZpbGU9c3lzLnN0ZGVycikKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChvdXRfc3RyZWFtLmdldHZhbHVlKCksICdmb29cbicpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChlcnJfc3RyZWFtLmdldHZhbHVlKCksICdiYXJcbicpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0Ll9vcmlnaW5hbF9zdGRvdXQuZ2V0dmFsdWUoKSwgJycpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQuX29yaWdpbmFsX3N0ZGVyci5nZXR2YWx1ZSgpLCAnJykKCiAgICAgICAgcmVzdWx0LmFkZFN1Y2Nlc3Moc2VsZikKICAgICAgICByZXN1bHQuc3RvcFRlc3Qoc2VsZikKCiAgICAgICAgc2VsZi5hc3NlcnRJcyhzeXMuc3Rkb3V0LCByZXN1bHQuX29yaWdpbmFsX3N0ZG91dCkKICAgICAgICBzZWxmLmFzc2VydElzKHN5cy5zdGRlcnIsIHJlc3VsdC5fb3JpZ2luYWxfc3RkZXJyKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC5fb3JpZ2luYWxfc3Rkb3V0LmdldHZhbHVlKCksICcnKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0Ll9vcmlnaW5hbF9zdGRlcnIuZ2V0dmFsdWUoKSwgJycpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwob3V0X3N0cmVhbS5nZXR2YWx1ZSgpLCAnJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGVycl9zdHJlYW0uZ2V0dmFsdWUoKSwgJycpCgoKICAgIGRlZiBnZXRTdGFydGVkUmVzdWx0KHNlbGYpOgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHJlc3VsdC5idWZmZXIgPSBUcnVlCiAgICAgICAgcmVzdWx0LnN0YXJ0VGVzdChzZWxmKQogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgdGVzdEJ1ZmZlck91dHB1dEFkZEVycm9yT3JGYWlsdXJlKHNlbGYpOgogICAgICAgIHVuaXR0ZXN0LnJlc3VsdC50cmFjZWJhY2sgPSBNb2NrVHJhY2ViYWNrCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHJlc3RvcmVfdHJhY2ViYWNrKQoKICAgICAgICBmb3IgbWVzc2FnZV9hdHRyLCBhZGRfYXR0ciwgaW5jbHVkZV9lcnJvciBpbiBbCiAgICAgICAgICAgICgnZXJyb3JzJywgJ2FkZEVycm9yJywgVHJ1ZSksCiAgICAgICAgICAgICgnZmFpbHVyZXMnLCAnYWRkRmFpbHVyZScsIEZhbHNlKSwKICAgICAgICAgICAgKCdlcnJvcnMnLCAnYWRkRXJyb3InLCBUcnVlKSwKICAgICAgICAgICAgKCdmYWlsdXJlcycsICdhZGRGYWlsdXJlJywgRmFsc2UpCiAgICAgICAgXToKICAgICAgICAgICAgcmVzdWx0ID0gc2VsZi5nZXRTdGFydGVkUmVzdWx0KCkKICAgICAgICAgICAgYnVmZmVyZWRfb3V0ID0gc3lzLnN0ZG91dAogICAgICAgICAgICBidWZmZXJlZF9lcnIgPSBzeXMuc3RkZXJyCiAgICAgICAgICAgIHJlc3VsdC5fb3JpZ2luYWxfc3Rkb3V0ID0gaW8uU3RyaW5nSU8oKQogICAgICAgICAgICByZXN1bHQuX29yaWdpbmFsX3N0ZGVyciA9IGlvLlN0cmluZ0lPKCkKCiAgICAgICAgICAgIHByaW50KCdmb28nLCBmaWxlPXN5cy5zdGRvdXQpCiAgICAgICAgICAgIGlmIGluY2x1ZGVfZXJyb3I6CiAgICAgICAgICAgICAgICBwcmludCgnYmFyJywgZmlsZT1zeXMuc3RkZXJyKQoKCiAgICAgICAgICAgIGFkZEZ1bmN0aW9uID0gZ2V0YXR0cihyZXN1bHQsIGFkZF9hdHRyKQogICAgICAgICAgICBhZGRGdW5jdGlvbihzZWxmLCAoTm9uZSwgTm9uZSwgTm9uZSkpCiAgICAgICAgICAgIHJlc3VsdC5zdG9wVGVzdChzZWxmKQoKICAgICAgICAgICAgcmVzdWx0X2xpc3QgPSBnZXRhdHRyKHJlc3VsdCwgbWVzc2FnZV9hdHRyKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHRfbGlzdCksIDEpCgogICAgICAgICAgICB0ZXN0LCBtZXNzYWdlID0gcmVzdWx0X2xpc3RbMF0KICAgICAgICAgICAgZXhwZWN0ZWRPdXRNZXNzYWdlID0gdGV4dHdyYXAuZGVkZW50KCIiIgogICAgICAgICAgICAgICAgU3Rkb3V0OgogICAgICAgICAgICAgICAgZm9vCiAgICAgICAgICAgICIiIikKICAgICAgICAgICAgZXhwZWN0ZWRFcnJNZXNzYWdlID0gJycKICAgICAgICAgICAgaWYgaW5jbHVkZV9lcnJvcjoKICAgICAgICAgICAgICAgIGV4cGVjdGVkRXJyTWVzc2FnZSA9IHRleHR3cmFwLmRlZGVudCgiIiIKICAgICAgICAgICAgICAgIFN0ZGVycjoKICAgICAgICAgICAgICAgIGJhcgogICAgICAgICAgICAiIiIpCgogICAgICAgICAgICBleHBlY3RlZEZ1bGxNZXNzYWdlID0gJ0EgdHJhY2ViYWNrJXMlcycgJSAoZXhwZWN0ZWRPdXRNZXNzYWdlLCBleHBlY3RlZEVyck1lc3NhZ2UpCgogICAgICAgICAgICBzZWxmLmFzc2VydElzKHRlc3QsIHNlbGYpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0Ll9vcmlnaW5hbF9zdGRvdXQuZ2V0dmFsdWUoKSwgZXhwZWN0ZWRPdXRNZXNzYWdlKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC5fb3JpZ2luYWxfc3RkZXJyLmdldHZhbHVlKCksIGV4cGVjdGVkRXJyTWVzc2FnZSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRNdWx0aUxpbmVFcXVhbChtZXNzYWdlLCBleHBlY3RlZEZ1bGxNZXNzYWdlKQoKICAgIGRlZiB0ZXN0QnVmZmVyU2V0dXBDbGFzcyhzZWxmKToKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICByZXN1bHQuYnVmZmVyID0gVHJ1ZQoKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHNldFVwQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIDEvMAogICAgICAgICAgICBkZWYgdGVzdF9mb28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoW0ZvbygndGVzdF9mb28nKV0pCiAgICAgICAgc3VpdGUocmVzdWx0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAxKQoKICAgIGRlZiB0ZXN0QnVmZmVyVGVhckRvd25DbGFzcyhzZWxmKToKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICByZXN1bHQuYnVmZmVyID0gVHJ1ZQoKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIDEvMAogICAgICAgICAgICBkZWYgdGVzdF9mb28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoW0ZvbygndGVzdF9mb28nKV0pCiAgICAgICAgc3VpdGUocmVzdWx0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAxKQoKICAgIGRlZiB0ZXN0QnVmZmVyU2V0VXBNb2R1bGUoc2VsZik6CiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgcmVzdWx0LmJ1ZmZlciA9IFRydWUKCiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfZm9vKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIGNsYXNzIE1vZHVsZShvYmplY3QpOgogICAgICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcE1vZHVsZSgpOgogICAgICAgICAgICAgICAgMS8wCgogICAgICAgIEZvby5fX21vZHVsZV9fID0gJ01vZHVsZScKICAgICAgICBzeXMubW9kdWxlc1snTW9kdWxlJ10gPSBNb2R1bGUKICAgICAgICBzZWxmLmFkZENsZWFudXAoc3lzLm1vZHVsZXMucG9wLCAnTW9kdWxlJykKICAgICAgICBzdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShbRm9vKCd0ZXN0X2ZvbycpXSkKICAgICAgICBzdWl0ZShyZXN1bHQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDEpCgogICAgZGVmIHRlc3RCdWZmZXJUZWFyRG93bk1vZHVsZShzZWxmKToKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICByZXN1bHQuYnVmZmVyID0gVHJ1ZQoKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF9mb28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgY2xhc3MgTW9kdWxlKG9iamVjdCk6CiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duTW9kdWxlKCk6CiAgICAgICAgICAgICAgICAxLzAKCiAgICAgICAgRm9vLl9fbW9kdWxlX18gPSAnTW9kdWxlJwogICAgICAgIHN5cy5tb2R1bGVzWydNb2R1bGUnXSA9IE1vZHVsZQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChzeXMubW9kdWxlcy5wb3AsICdNb2R1bGUnKQogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKFtGb28oJ3Rlc3RfZm9vJyldKQogICAgICAgIHN1aXRlKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZXJyb3JzKSwgMSkKCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgdW5pdHRlc3QubWFpbigpCg==',
'/Lib/unittest/test/test_runner.py':'aW1wb3J0IGlvCmltcG9ydCBvcwppbXBvcnQgc3lzCmltcG9ydCBwaWNrbGUKaW1wb3J0IHN1YnByb2Nlc3MKCmltcG9ydCB1bml0dGVzdAoKZnJvbSAuc3VwcG9ydCBpbXBvcnQgTG9nZ2luZ1Jlc3VsdCwgUmVzdWx0V2l0aE5vU3RhcnRUZXN0UnVuU3RvcFRlc3RSdW4KCgpjbGFzcyBUZXN0Q2xlYW5VcCh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIHRlc3RDbGVhblVwKHNlbGYpOgogICAgICAgIGNsYXNzIFRlc3RhYmxlVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0Tm90aGluZyhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgdGVzdCA9IFRlc3RhYmxlVGVzdCgndGVzdE5vdGhpbmcnKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwodGVzdC5fY2xlYW51cHMsIFtdKQoKICAgICAgICBjbGVhbnVwcyA9IFtdCgogICAgICAgIGRlZiBjbGVhbnVwMSgqYXJncywgKiprd2FyZ3MpOgogICAgICAgICAgICBjbGVhbnVwcy5hcHBlbmQoKDEsIGFyZ3MsIGt3YXJncykpCgogICAgICAgIGRlZiBjbGVhbnVwMigqYXJncywgKiprd2FyZ3MpOgogICAgICAgICAgICBjbGVhbnVwcy5hcHBlbmQoKDIsIGFyZ3MsIGt3YXJncykpCgogICAgICAgIHRlc3QuYWRkQ2xlYW51cChjbGVhbnVwMSwgMSwgMiwgMywgZm91cj0naGVsbG8nLCBmaXZlPSdnb29kYnllJykKICAgICAgICB0ZXN0LmFkZENsZWFudXAoY2xlYW51cDIpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwodGVzdC5fY2xlYW51cHMsCiAgICAgICAgICAgICAgICAgICAgICAgICBbKGNsZWFudXAxLCAoMSwgMiwgMyksIGRpY3QoZm91cj0naGVsbG8nLCBmaXZlPSdnb29kYnllJykpLAogICAgICAgICAgICAgICAgICAgICAgICAgIChjbGVhbnVwMiwgKCksIHt9KV0pCgogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZSh0ZXN0LmRvQ2xlYW51cHMoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNsZWFudXBzLCBbKDIsICgpLCB7fSksICgxLCAoMSwgMiwgMyksIGRpY3QoZm91cj0naGVsbG8nLCBmaXZlPSdnb29kYnllJykpXSkKCiAgICBkZWYgdGVzdENsZWFuVXBXaXRoRXJyb3JzKHNlbGYpOgogICAgICAgIGNsYXNzIFRlc3RhYmxlVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0Tm90aGluZyhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgY2xhc3MgTW9ja091dGNvbWUob2JqZWN0KToKICAgICAgICAgICAgc3VjY2VzcyA9IFRydWUKICAgICAgICAgICAgZXJyb3JzID0gW10KCiAgICAgICAgdGVzdCA9IFRlc3RhYmxlVGVzdCgndGVzdE5vdGhpbmcnKQogICAgICAgIHRlc3QuX291dGNvbWVGb3JEb0NsZWFudXBzID0gTW9ja091dGNvbWUKCiAgICAgICAgZXhjMSA9IEV4Y2VwdGlvbignZm9vJykKICAgICAgICBleGMyID0gRXhjZXB0aW9uKCdiYXInKQogICAgICAgIGRlZiBjbGVhbnVwMSgpOgogICAgICAgICAgICByYWlzZSBleGMxCgogICAgICAgIGRlZiBjbGVhbnVwMigpOgogICAgICAgICAgICByYWlzZSBleGMyCgogICAgICAgIHRlc3QuYWRkQ2xlYW51cChjbGVhbnVwMSkKICAgICAgICB0ZXN0LmFkZENsZWFudXAoY2xlYW51cDIpCgogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UodGVzdC5kb0NsZWFudXBzKCkpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShNb2NrT3V0Y29tZS5zdWNjZXNzKQoKICAgICAgICAoVHlwZTEsIGluc3RhbmNlMSwgXyksIChUeXBlMiwgaW5zdGFuY2UyLCBfKSA9IHJldmVyc2VkKE1vY2tPdXRjb21lLmVycm9ycykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKChUeXBlMSwgaW5zdGFuY2UxKSwgKEV4Y2VwdGlvbiwgZXhjMSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgoVHlwZTIsIGluc3RhbmNlMiksIChFeGNlcHRpb24sIGV4YzIpKQoKICAgIGRlZiB0ZXN0Q2xlYW51cEluUnVuKHNlbGYpOgogICAgICAgIGJsb3dVcCA9IEZhbHNlCiAgICAgICAgb3JkZXJpbmcgPSBbXQoKICAgICAgICBjbGFzcyBUZXN0YWJsZVRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgc2V0VXAoc2VsZik6CiAgICAgICAgICAgICAgICBvcmRlcmluZy5hcHBlbmQoJ3NldFVwJykKICAgICAgICAgICAgICAgIGlmIGJsb3dVcDoKICAgICAgICAgICAgICAgICAgICByYWlzZSBFeGNlcHRpb24oJ2ZvbycpCgogICAgICAgICAgICBkZWYgdGVzdE5vdGhpbmcoc2VsZik6CiAgICAgICAgICAgICAgICBvcmRlcmluZy5hcHBlbmQoJ3Rlc3QnKQoKICAgICAgICAgICAgZGVmIHRlYXJEb3duKHNlbGYpOgogICAgICAgICAgICAgICAgb3JkZXJpbmcuYXBwZW5kKCd0ZWFyRG93bicpCgogICAgICAgIHRlc3QgPSBUZXN0YWJsZVRlc3QoJ3Rlc3ROb3RoaW5nJykKCiAgICAgICAgZGVmIGNsZWFudXAxKCk6CiAgICAgICAgICAgIG9yZGVyaW5nLmFwcGVuZCgnY2xlYW51cDEnKQogICAgICAgIGRlZiBjbGVhbnVwMigpOgogICAgICAgICAgICBvcmRlcmluZy5hcHBlbmQoJ2NsZWFudXAyJykKICAgICAgICB0ZXN0LmFkZENsZWFudXAoY2xlYW51cDEpCiAgICAgICAgdGVzdC5hZGRDbGVhbnVwKGNsZWFudXAyKQoKICAgICAgICBkZWYgc3VjY2Vzcyhzb21lX3Rlc3QpOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNvbWVfdGVzdCwgdGVzdCkKICAgICAgICAgICAgb3JkZXJpbmcuYXBwZW5kKCdzdWNjZXNzJykKCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgcmVzdWx0LmFkZFN1Y2Nlc3MgPSBzdWNjZXNzCgogICAgICAgIHRlc3QucnVuKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG9yZGVyaW5nLCBbJ3NldFVwJywgJ3Rlc3QnLCAndGVhckRvd24nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2xlYW51cDInLCAnY2xlYW51cDEnLCAnc3VjY2VzcyddKQoKICAgICAgICBibG93VXAgPSBUcnVlCiAgICAgICAgb3JkZXJpbmcgPSBbXQogICAgICAgIHRlc3QgPSBUZXN0YWJsZVRlc3QoJ3Rlc3ROb3RoaW5nJykKICAgICAgICB0ZXN0LmFkZENsZWFudXAoY2xlYW51cDEpCiAgICAgICAgdGVzdC5ydW4ocmVzdWx0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwob3JkZXJpbmcsIFsnc2V0VXAnLCAnY2xlYW51cDEnXSkKCiAgICBkZWYgdGVzdFRlc3RDYXNlRGVidWdFeGVjdXRlc0NsZWFudXBzKHNlbGYpOgogICAgICAgIG9yZGVyaW5nID0gW10KCiAgICAgICAgY2xhc3MgVGVzdGFibGVUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHNldFVwKHNlbGYpOgogICAgICAgICAgICAgICAgb3JkZXJpbmcuYXBwZW5kKCdzZXRVcCcpCiAgICAgICAgICAgICAgICBzZWxmLmFkZENsZWFudXAoY2xlYW51cDEpCgogICAgICAgICAgICBkZWYgdGVzdE5vdGhpbmcoc2VsZik6CiAgICAgICAgICAgICAgICBvcmRlcmluZy5hcHBlbmQoJ3Rlc3QnKQoKICAgICAgICAgICAgZGVmIHRlYXJEb3duKHNlbGYpOgogICAgICAgICAgICAgICAgb3JkZXJpbmcuYXBwZW5kKCd0ZWFyRG93bicpCgogICAgICAgIHRlc3QgPSBUZXN0YWJsZVRlc3QoJ3Rlc3ROb3RoaW5nJykKCiAgICAgICAgZGVmIGNsZWFudXAxKCk6CiAgICAgICAgICAgIG9yZGVyaW5nLmFwcGVuZCgnY2xlYW51cDEnKQogICAgICAgICAgICB0ZXN0LmFkZENsZWFudXAoY2xlYW51cDIpCiAgICAgICAgZGVmIGNsZWFudXAyKCk6CiAgICAgICAgICAgIG9yZGVyaW5nLmFwcGVuZCgnY2xlYW51cDInKQoKICAgICAgICB0ZXN0LmRlYnVnKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG9yZGVyaW5nLCBbJ3NldFVwJywgJ3Rlc3QnLCAndGVhckRvd24nLCAnY2xlYW51cDEnLCAnY2xlYW51cDInXSkKCgpjbGFzcyBUZXN0X1RleHRUZXN0UnVubmVyKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICIiIlRlc3RzIGZvciBUZXh0VGVzdFJ1bm5lci4iIiIKCiAgICBkZWYgdGVzdF9pbml0KHNlbGYpOgogICAgICAgIHJ1bm5lciA9IHVuaXR0ZXN0LlRleHRUZXN0UnVubmVyKCkKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKHJ1bm5lci5mYWlsZmFzdCkKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKHJ1bm5lci5idWZmZXIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChydW5uZXIudmVyYm9zaXR5LCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocnVubmVyLndhcm5pbmdzLCBOb25lKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShydW5uZXIuZGVzY3JpcHRpb25zKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocnVubmVyLnJlc3VsdGNsYXNzLCB1bml0dGVzdC5UZXh0VGVzdFJlc3VsdCkKCgogICAgZGVmIHRlc3RCdWZmZXJBbmRGYWlsZmFzdChzZWxmKToKICAgICAgICBjbGFzcyBUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RGb28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgcnVubmVyID0gdW5pdHRlc3QuVGV4dFRlc3RSdW5uZXIoc3RyZWFtPWlvLlN0cmluZ0lPKCksIGZhaWxmYXN0PVRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWZmZXI9VHJ1ZSkKICAgICAgICAjIFVzZSBvdXIgcmVzdWx0IG9iamVjdAogICAgICAgIHJ1bm5lci5fbWFrZVJlc3VsdCA9IGxhbWJkYTogcmVzdWx0CiAgICAgICAgcnVubmVyLnJ1bihUZXN0KCd0ZXN0Rm9vJykpCgogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShyZXN1bHQuZmFpbGZhc3QpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHJlc3VsdC5idWZmZXIpCgogICAgZGVmIHRlc3RSdW5uZXJSZWdpc3RlcnNSZXN1bHQoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0Rm9vKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIG9yaWdpbmFsUmVnaXN0ZXJSZXN1bHQgPSB1bml0dGVzdC5ydW5uZXIucmVnaXN0ZXJSZXN1bHQKICAgICAgICBkZWYgY2xlYW51cCgpOgogICAgICAgICAgICB1bml0dGVzdC5ydW5uZXIucmVnaXN0ZXJSZXN1bHQgPSBvcmlnaW5hbFJlZ2lzdGVyUmVzdWx0CiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKGNsZWFudXApCgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHJ1bm5lciA9IHVuaXR0ZXN0LlRleHRUZXN0UnVubmVyKHN0cmVhbT1pby5TdHJpbmdJTygpKQogICAgICAgICMgVXNlIG91ciByZXN1bHQgb2JqZWN0CiAgICAgICAgcnVubmVyLl9tYWtlUmVzdWx0ID0gbGFtYmRhOiByZXN1bHQKCiAgICAgICAgc2VsZi53YXNSZWdpc3RlcmVkID0gMAogICAgICAgIGRlZiBmYWtlUmVnaXN0ZXJSZXN1bHQodGhpc1Jlc3VsdCk6CiAgICAgICAgICAgIHNlbGYud2FzUmVnaXN0ZXJlZCArPSAxCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwodGhpc1Jlc3VsdCwgcmVzdWx0KQogICAgICAgIHVuaXR0ZXN0LnJ1bm5lci5yZWdpc3RlclJlc3VsdCA9IGZha2VSZWdpc3RlclJlc3VsdAoKICAgICAgICBydW5uZXIucnVuKHVuaXR0ZXN0LlRlc3RTdWl0ZSgpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc2VsZi53YXNSZWdpc3RlcmVkLCAxKQoKICAgIGRlZiB0ZXN0X3dvcmtzX3dpdGhfcmVzdWx0X3dpdGhvdXRfc3RhcnRUZXN0UnVuX3N0b3BUZXN0UnVuKHNlbGYpOgogICAgICAgIGNsYXNzIE9sZFRleHRSZXN1bHQoUmVzdWx0V2l0aE5vU3RhcnRUZXN0UnVuU3RvcFRlc3RSdW4pOgogICAgICAgICAgICBzZXBhcmF0b3IyID0gJycKICAgICAgICAgICAgZGVmIHByaW50RXJyb3JzKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBjbGFzcyBSdW5uZXIodW5pdHRlc3QuVGV4dFRlc3RSdW5uZXIpOgogICAgICAgICAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgICAgICAgICBzdXBlcihSdW5uZXIsIHNlbGYpLl9faW5pdF9fKGlvLlN0cmluZ0lPKCkpCgogICAgICAgICAgICBkZWYgX21ha2VSZXN1bHQoc2VsZik6CiAgICAgICAgICAgICAgICByZXR1cm4gT2xkVGV4dFJlc3VsdCgpCgogICAgICAgIHJ1bm5lciA9IFJ1bm5lcigpCiAgICAgICAgcnVubmVyLnJ1bih1bml0dGVzdC5UZXN0U3VpdGUoKSkKCiAgICBkZWYgdGVzdF9zdGFydFRlc3RSdW5fc3RvcFRlc3RSdW5fY2FsbGVkKHNlbGYpOgogICAgICAgIGNsYXNzIExvZ2dpbmdUZXh0UmVzdWx0KExvZ2dpbmdSZXN1bHQpOgogICAgICAgICAgICBzZXBhcmF0b3IyID0gJycKICAgICAgICAgICAgZGVmIHByaW50RXJyb3JzKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBjbGFzcyBMb2dnaW5nUnVubmVyKHVuaXR0ZXN0LlRleHRUZXN0UnVubmVyKToKICAgICAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIGV2ZW50cyk6CiAgICAgICAgICAgICAgICBzdXBlcihMb2dnaW5nUnVubmVyLCBzZWxmKS5fX2luaXRfXyhpby5TdHJpbmdJTygpKQogICAgICAgICAgICAgICAgc2VsZi5fZXZlbnRzID0gZXZlbnRzCgogICAgICAgICAgICBkZWYgX21ha2VSZXN1bHQoc2VsZik6CiAgICAgICAgICAgICAgICByZXR1cm4gTG9nZ2luZ1RleHRSZXN1bHQoc2VsZi5fZXZlbnRzKQoKICAgICAgICBldmVudHMgPSBbXQogICAgICAgIHJ1bm5lciA9IExvZ2dpbmdSdW5uZXIoZXZlbnRzKQogICAgICAgIHJ1bm5lci5ydW4odW5pdHRlc3QuVGVzdFN1aXRlKCkpCiAgICAgICAgZXhwZWN0ZWQgPSBbJ3N0YXJ0VGVzdFJ1bicsICdzdG9wVGVzdFJ1biddCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIGV4cGVjdGVkKQoKICAgIGRlZiB0ZXN0X3BpY2tsZV91bnBpY2tsZShzZWxmKToKICAgICAgICAjIElzc3VlICM3MTk3OiBhIFRleHRUZXN0UnVubmVyIHNob3VsZCBiZSAodW4pcGlja2xlYWJsZS4gVGhpcyBpcwogICAgICAgICMgcmVxdWlyZWQgYnkgdGVzdF9tdWx0aXByb2Nlc3NpbmcgdW5kZXIgV2luZG93cyAoaW4gdmVyYm9zZSBtb2RlKS4KICAgICAgICBzdHJlYW0gPSBpby5TdHJpbmdJTygiZm9vIikKICAgICAgICBydW5uZXIgPSB1bml0dGVzdC5UZXh0VGVzdFJ1bm5lcihzdHJlYW0pCiAgICAgICAgZm9yIHByb3RvY29sIGluIHJhbmdlKDIsIHBpY2tsZS5ISUdIRVNUX1BST1RPQ09MICsgMSk6CiAgICAgICAgICAgIHMgPSBwaWNrbGUuZHVtcHMocnVubmVyLCBwcm90b2NvbCkKICAgICAgICAgICAgb2JqID0gcGlja2xlLmxvYWRzKHMpCiAgICAgICAgICAgICMgU3RyaW5nSU8gb2JqZWN0cyBuZXZlciBjb21wYXJlIGVxdWFsLCBhIGNoZWFwIHRlc3QgaW5zdGVhZC4KICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChvYmouc3RyZWFtLmdldHZhbHVlKCksIHN0cmVhbS5nZXR2YWx1ZSgpKQoKICAgIGRlZiB0ZXN0X3Jlc3VsdGNsYXNzKHNlbGYpOgogICAgICAgIGRlZiBNb2NrUmVzdWx0Q2xhc3MoKmFyZ3MpOgogICAgICAgICAgICByZXR1cm4gYXJncwogICAgICAgIFNUUkVBTSA9IG9iamVjdCgpCiAgICAgICAgREVTQ1JJUFRJT05TID0gb2JqZWN0KCkKICAgICAgICBWRVJCT1NJVFkgPSBvYmplY3QoKQogICAgICAgIHJ1bm5lciA9IHVuaXR0ZXN0LlRleHRUZXN0UnVubmVyKFNUUkVBTSwgREVTQ1JJUFRJT05TLCBWRVJCT1NJVFksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Y2xhc3M9TW9ja1Jlc3VsdENsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocnVubmVyLnJlc3VsdGNsYXNzLCBNb2NrUmVzdWx0Q2xhc3MpCgogICAgICAgIGV4cGVjdGVkcmVzdWx0ID0gKHJ1bm5lci5zdHJlYW0sIERFU0NSSVBUSU9OUywgVkVSQk9TSVRZKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocnVubmVyLl9tYWtlUmVzdWx0KCksIGV4cGVjdGVkcmVzdWx0KQoKICAgIGRlZiB0ZXN0X3dhcm5pbmdzKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIENoZWNrIHRoYXQgd2FybmluZ3MgYXJndW1lbnQgb2YgVGV4dFRlc3RSdW5uZXIgY29ycmVjdGx5IGFmZmVjdHMgdGhlCiAgICAgICAgYmVoYXZpb3Igb2YgdGhlIHdhcm5pbmdzLgogICAgICAgICIiIgogICAgICAgICMgc2VlICMxMDUzNSBhbmQgdGhlIF90ZXN0X3dhcm5pbmdzIGZpbGUgZm9yIG1vcmUgaW5mb3JtYXRpb24KCiAgICAgICAgZGVmIGdldF9wYXJzZV9vdXRfZXJyKHApOgogICAgICAgICAgICByZXR1cm4gW2Iuc3BsaXRsaW5lcygpIGZvciBiIGluIHAuY29tbXVuaWNhdGUoKV0KICAgICAgICBvcHRzID0gZGljdChzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLCBzdGRlcnI9c3VicHJvY2Vzcy5QSVBFLAogICAgICAgICAgICAgICAgICAgIGN3ZD1vcy5wYXRoLmRpcm5hbWUoX19maWxlX18pKQogICAgICAgIGFlX21zZyA9IGInUGxlYXNlIHVzZSBhc3NlcnRFcXVhbCBpbnN0ZWFkLicKICAgICAgICBhdF9tc2cgPSBiJ1BsZWFzZSB1c2UgYXNzZXJ0VHJ1ZSBpbnN0ZWFkLicKCiAgICAgICAgIyBubyBhcmdzIC0+IGFsbCB0aGUgd2FybmluZ3MgYXJlIHByaW50ZWQsIHVuaXR0ZXN0IHdhcm5pbmdzIG9ubHkgb25jZQogICAgICAgIHAgPSBzdWJwcm9jZXNzLlBvcGVuKFtzeXMuZXhlY3V0YWJsZSwgJ190ZXN0X3dhcm5pbmdzLnB5J10sICoqb3B0cykKICAgICAgICBvdXQsIGVyciA9IGdldF9wYXJzZV9vdXRfZXJyKHApCiAgICAgICAgc2VsZi5hc3NlcnRJbihiJ09LJywgZXJyKQogICAgICAgICMgY2hlY2sgdGhhdCB0aGUgdG90YWwgbnVtYmVyIG9mIHdhcm5pbmdzIGluIHRoZSBvdXRwdXQgaXMgY29ycmVjdAogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKG91dCksIDEyKQogICAgICAgICMgY2hlY2sgdGhhdCB0aGUgbnVtYmVycyBvZiB0aGUgZGlmZmVyZW50IGtpbmQgb2Ygd2FybmluZ3MgaXMgY29ycmVjdAogICAgICAgIGZvciBtc2cgaW4gW2InZHcnLCBiJ2l3JywgYid1dyddOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG91dC5jb3VudChtc2cpLCAzKQogICAgICAgIGZvciBtc2cgaW4gW2FlX21zZywgYXRfbXNnLCBiJ3J3J106CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwob3V0LmNvdW50KG1zZyksIDEpCgogICAgICAgIGFyZ3NfbGlzdCA9ICgKICAgICAgICAgICAgIyBwYXNzaW5nICdpZ25vcmUnIGFzIHdhcm5pbmdzIGFyZyAtPiBubyB3YXJuaW5ncwogICAgICAgICAgICBbc3lzLmV4ZWN1dGFibGUsICdfdGVzdF93YXJuaW5ncy5weScsICdpZ25vcmUnXSwKICAgICAgICAgICAgIyAtVyBkb2Vzbid0IGFmZmVjdCB0aGUgcmVzdWx0IGlmIHRoZSBhcmcgaXMgcGFzc2VkCiAgICAgICAgICAgIFtzeXMuZXhlY3V0YWJsZSwgJy1XYScsICdfdGVzdF93YXJuaW5ncy5weScsICdpZ25vcmUnXSwKICAgICAgICAgICAgIyAtVyBhZmZlY3RzIHRoZSByZXN1bHQgaWYgdGhlIGFyZyBpcyBub3QgcGFzc2VkCiAgICAgICAgICAgIFtzeXMuZXhlY3V0YWJsZSwgJy1XaScsICdfdGVzdF93YXJuaW5ncy5weSddCiAgICAgICAgKQogICAgICAgICMgaW4gYWxsIHRoZXNlIGNhc2VzIG5vIHdhcm5pbmdzIGFyZSBwcmludGVkCiAgICAgICAgZm9yIGFyZ3MgaW4gYXJnc19saXN0OgogICAgICAgICAgICBwID0gc3VicHJvY2Vzcy5Qb3BlbihhcmdzLCAqKm9wdHMpCiAgICAgICAgICAgIG91dCwgZXJyID0gZ2V0X3BhcnNlX291dF9lcnIocCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbihiJ09LJywgZXJyKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihvdXQpLCAwKQoKCiAgICAgICAgIyBwYXNzaW5nICdhbHdheXMnIGFzIHdhcm5pbmdzIGFyZyAtPiBhbGwgdGhlIHdhcm5pbmdzIHByaW50ZWQsCiAgICAgICAgIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bml0dGVzdCB3YXJuaW5ncyBvbmx5IG9uY2UKICAgICAgICBwID0gc3VicHJvY2Vzcy5Qb3Blbihbc3lzLmV4ZWN1dGFibGUsICdfdGVzdF93YXJuaW5ncy5weScsICdhbHdheXMnXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKm9wdHMpCiAgICAgICAgb3V0LCBlcnIgPSBnZXRfcGFyc2Vfb3V0X2VycihwKQogICAgICAgIHNlbGYuYXNzZXJ0SW4oYidPSycsIGVycikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihvdXQpLCAxNCkKICAgICAgICBmb3IgbXNnIGluIFtiJ2R3JywgYidpdycsIGIndXcnLCBiJ3J3J106CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwob3V0LmNvdW50KG1zZyksIDMpCiAgICAgICAgZm9yIG1zZyBpbiBbYWVfbXNnLCBhdF9tc2ddOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG91dC5jb3VudChtc2cpLCAxKQoKICAgIGRlZiB0ZXN0U3RkRXJyTG9va2VkVXBBdEluc3RhbnRpYXRpb25UaW1lKHNlbGYpOgogICAgICAgICMgc2VlIGlzc3VlIDEwNzg2CiAgICAgICAgb2xkX3N0ZGVyciA9IHN5cy5zdGRlcnIKICAgICAgICBmID0gaW8uU3RyaW5nSU8oKQogICAgICAgIHN5cy5zdGRlcnIgPSBmCiAgICAgICAgdHJ5OgogICAgICAgICAgICBydW5uZXIgPSB1bml0dGVzdC5UZXh0VGVzdFJ1bm5lcigpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShydW5uZXIuc3RyZWFtLnN0cmVhbSBpcyBmKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHN5cy5zdGRlcnIgPSBvbGRfc3RkZXJyCgogICAgZGVmIHRlc3RTcGVjaWZpZWRTdHJlYW1Vc2VkKHNlbGYpOgogICAgICAgICMgc2VlIGlzc3VlIDEwNzg2CiAgICAgICAgZiA9IGlvLlN0cmluZ0lPKCkKICAgICAgICBydW5uZXIgPSB1bml0dGVzdC5UZXh0VGVzdFJ1bm5lcihmKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShydW5uZXIuc3RyZWFtLnN0cmVhbSBpcyBmKQo=',
'/Lib/unittest/test/test_setups.py':'aW1wb3J0IGlvCmltcG9ydCBzeXMKCmltcG9ydCB1bml0dGVzdAoKCmRlZiByZXN1bHRGYWN0b3J5KCpfKToKICAgIHJldHVybiB1bml0dGVzdC5UZXN0UmVzdWx0KCkKCgpjbGFzcyBUZXN0U2V0dXBzKHVuaXR0ZXN0LlRlc3RDYXNlKToKCiAgICBkZWYgZ2V0UnVubmVyKHNlbGYpOgogICAgICAgIHJldHVybiB1bml0dGVzdC5UZXh0VGVzdFJ1bm5lcihyZXN1bHRjbGFzcz1yZXN1bHRGYWN0b3J5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJlYW09aW8uU3RyaW5nSU8oKSkKICAgIGRlZiBydW5UZXN0cyhzZWxmLCAqY2FzZXMpOgogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKICAgICAgICBmb3IgY2FzZSBpbiBjYXNlczoKICAgICAgICAgICAgdGVzdHMgPSB1bml0dGVzdC5kZWZhdWx0VGVzdExvYWRlci5sb2FkVGVzdHNGcm9tVGVzdENhc2UoY2FzZSkKICAgICAgICAgICAgc3VpdGUuYWRkVGVzdHModGVzdHMpCgogICAgICAgIHJ1bm5lciA9IHNlbGYuZ2V0UnVubmVyKCkKCiAgICAgICAgIyBjcmVhdGluZyBhIG5lc3RlZCBzdWl0ZSBleHBvc2VzIHNvbWUgcG90ZW50aWFsIGJ1Z3MKICAgICAgICByZWFsU3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoKQogICAgICAgIHJlYWxTdWl0ZS5hZGRUZXN0KHN1aXRlKQogICAgICAgICMgYWRkaW5nIGVtcHR5IHN1aXRlcyB0byB0aGUgZW5kIGV4cG9zZXMgcG90ZW50aWFsIGJ1Z3MKICAgICAgICBzdWl0ZS5hZGRUZXN0KHVuaXR0ZXN0LlRlc3RTdWl0ZSgpKQogICAgICAgIHJlYWxTdWl0ZS5hZGRUZXN0KHVuaXR0ZXN0LlRlc3RTdWl0ZSgpKQogICAgICAgIHJldHVybiBydW5uZXIucnVuKHJlYWxTdWl0ZSkKCiAgICBkZWYgdGVzdF9zZXR1cF9jbGFzcyhzZWxmKToKICAgICAgICBjbGFzcyBUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgc2V0VXBDYWxsZWQgPSAwCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgc2V0VXBDbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgVGVzdC5zZXRVcENhbGxlZCArPSAxCiAgICAgICAgICAgICAgICB1bml0dGVzdC5UZXN0Q2FzZS5zZXRVcENsYXNzKCkKICAgICAgICAgICAgZGVmIHRlc3Rfb25lKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBkZWYgdGVzdF90d28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIHJlc3VsdCA9IHNlbGYucnVuVGVzdHMoVGVzdCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChUZXN0LnNldFVwQ2FsbGVkLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCAyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAwKQoKICAgIGRlZiB0ZXN0X3RlYXJkb3duX2NsYXNzKHNlbGYpOgogICAgICAgIGNsYXNzIFRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICB0ZWFyRG93bkNhbGxlZCA9IDAKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiB0ZWFyRG93bkNsYXNzKGNscyk6CiAgICAgICAgICAgICAgICBUZXN0LnRlYXJEb3duQ2FsbGVkICs9IDEKICAgICAgICAgICAgICAgIHVuaXR0ZXN0LlRlc3RDYXNlLnRlYXJEb3duQ2xhc3MoKQogICAgICAgICAgICBkZWYgdGVzdF9vbmUoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0X3R3byhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgcmVzdWx0ID0gc2VsZi5ydW5UZXN0cyhUZXN0KQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFRlc3QudGVhckRvd25DYWxsZWQsIDEpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDApCgogICAgZGVmIHRlc3RfdGVhcmRvd25fY2xhc3NfdHdvX2NsYXNzZXMoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHRlYXJEb3duQ2FsbGVkID0gMAogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIFRlc3QudGVhckRvd25DYWxsZWQgKz0gMQogICAgICAgICAgICAgICAgdW5pdHRlc3QuVGVzdENhc2UudGVhckRvd25DbGFzcygpCiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBjbGFzcyBUZXN0Mih1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHRlYXJEb3duQ2FsbGVkID0gMAogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIFRlc3QyLnRlYXJEb3duQ2FsbGVkICs9IDEKICAgICAgICAgICAgICAgIHVuaXR0ZXN0LlRlc3RDYXNlLnRlYXJEb3duQ2xhc3MoKQogICAgICAgICAgICBkZWYgdGVzdF9vbmUoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0X3R3byhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgcmVzdWx0ID0gc2VsZi5ydW5UZXN0cyhUZXN0LCBUZXN0MikKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChUZXN0LnRlYXJEb3duQ2FsbGVkLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoVGVzdDIudGVhckRvd25DYWxsZWQsIDEpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDApCgogICAgZGVmIHRlc3RfZXJyb3JfaW5fc2V0dXBjbGFzcyhzZWxmKToKICAgICAgICBjbGFzcyBCcm9rZW5UZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcENsYXNzKGNscyk6CiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ2ZvbycpCiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICByZXN1bHQgPSBzZWxmLnJ1blRlc3RzKEJyb2tlblRlc3QpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCAwKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAxKQogICAgICAgIGVycm9yLCBfID0gcmVzdWx0LmVycm9yc1swXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGVycm9yKSwKICAgICAgICAgICAgICAgICAgICAnc2V0VXBDbGFzcyAoJXMuQnJva2VuVGVzdCknICUgX19uYW1lX18pCgogICAgZGVmIHRlc3RfZXJyb3JfaW5fdGVhcmRvd25fY2xhc3Moc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHRvcm5Eb3duID0gMAogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIFRlc3QudG9ybkRvd24gKz0gMQogICAgICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdmb28nKQogICAgICAgICAgICBkZWYgdGVzdF9vbmUoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0X3R3byhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgY2xhc3MgVGVzdDIodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICB0b3JuRG93biA9IDAKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiB0ZWFyRG93bkNsYXNzKGNscyk6CiAgICAgICAgICAgICAgICBUZXN0Mi50b3JuRG93biArPSAxCiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ2ZvbycpCiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICByZXN1bHQgPSBzZWxmLnJ1blRlc3RzKFRlc3QsIFRlc3QyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCA0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoVGVzdC50b3JuRG93biwgMSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFRlc3QyLnRvcm5Eb3duLCAxKQoKICAgICAgICBlcnJvciwgXyA9IHJlc3VsdC5lcnJvcnNbMF0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN0cihlcnJvciksCiAgICAgICAgICAgICAgICAgICAgJ3RlYXJEb3duQ2xhc3MgKCVzLlRlc3QpJyAlIF9fbmFtZV9fKQoKICAgIGRlZiB0ZXN0X2NsYXNzX25vdF90b3JuZG93bl93aGVuX3NldHVwX2ZhaWxzKHNlbGYpOgogICAgICAgIGNsYXNzIFRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICB0b3JuRG93biA9IEZhbHNlCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgc2V0VXBDbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25DbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgVGVzdC50b3JuRG93biA9IFRydWUKICAgICAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcignZm9vJykKICAgICAgICAgICAgZGVmIHRlc3Rfb25lKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBzZWxmLnJ1blRlc3RzKFRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShUZXN0LnRvcm5Eb3duKQoKICAgIGRlZiB0ZXN0X2NsYXNzX25vdF9zZXR1cF9vcl90b3JuZG93bl93aGVuX3NraXBwZWQoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGNsYXNzU2V0VXAgPSBGYWxzZQogICAgICAgICAgICB0b3JuRG93biA9IEZhbHNlCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgc2V0VXBDbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgVGVzdC5jbGFzc1NldFVwID0gVHJ1ZQogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIFRlc3QudG9ybkRvd24gPSBUcnVlCiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgVGVzdCA9IHVuaXR0ZXN0LnNraXAoImhvcCIpKFRlc3QpCiAgICAgICAgc2VsZi5ydW5UZXN0cyhUZXN0KQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoVGVzdC5jbGFzc1NldFVwKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoVGVzdC50b3JuRG93bikKCiAgICBkZWYgdGVzdF9zZXR1cF90ZWFyZG93bl9vcmRlcl93aXRoX3BhdGhvbG9naWNhbF9zdWl0ZShzZWxmKToKICAgICAgICByZXN1bHRzID0gW10KCiAgICAgICAgY2xhc3MgTW9kdWxlMShvYmplY3QpOgogICAgICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcE1vZHVsZSgpOgogICAgICAgICAgICAgICAgcmVzdWx0cy5hcHBlbmQoJ01vZHVsZTEuc2V0VXBNb2R1bGUnKQogICAgICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgICAgIGRlZiB0ZWFyRG93bk1vZHVsZSgpOgogICAgICAgICAgICAgICAgcmVzdWx0cy5hcHBlbmQoJ01vZHVsZTEudGVhckRvd25Nb2R1bGUnKQoKICAgICAgICBjbGFzcyBNb2R1bGUyKG9iamVjdCk6CiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHNldFVwTW9kdWxlKCk6CiAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgnTW9kdWxlMi5zZXRVcE1vZHVsZScpCiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duTW9kdWxlKCk6CiAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgnTW9kdWxlMi50ZWFyRG93bk1vZHVsZScpCgogICAgICAgIGNsYXNzIFRlc3QxKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcENsYXNzKGNscyk6CiAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgnc2V0dXAgMScpCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25DbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgcmVzdWx0cy5hcHBlbmQoJ3RlYXJkb3duIDEnKQogICAgICAgICAgICBkZWYgdGVzdE9uZShzZWxmKToKICAgICAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5kKCdUZXN0MS50ZXN0T25lJykKICAgICAgICAgICAgZGVmIHRlc3RUd28oc2VsZik6CiAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgnVGVzdDEudGVzdFR3bycpCgogICAgICAgIGNsYXNzIFRlc3QyKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcENsYXNzKGNscyk6CiAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgnc2V0dXAgMicpCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25DbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgcmVzdWx0cy5hcHBlbmQoJ3RlYXJkb3duIDInKQogICAgICAgICAgICBkZWYgdGVzdE9uZShzZWxmKToKICAgICAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5kKCdUZXN0Mi50ZXN0T25lJykKICAgICAgICAgICAgZGVmIHRlc3RUd28oc2VsZik6CiAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgnVGVzdDIudGVzdFR3bycpCgogICAgICAgIGNsYXNzIFRlc3QzKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcENsYXNzKGNscyk6CiAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgnc2V0dXAgMycpCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25DbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgcmVzdWx0cy5hcHBlbmQoJ3RlYXJkb3duIDMnKQogICAgICAgICAgICBkZWYgdGVzdE9uZShzZWxmKToKICAgICAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5kKCdUZXN0My50ZXN0T25lJykKICAgICAgICAgICAgZGVmIHRlc3RUd28oc2VsZik6CiAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgnVGVzdDMudGVzdFR3bycpCgogICAgICAgIFRlc3QxLl9fbW9kdWxlX18gPSBUZXN0Mi5fX21vZHVsZV9fID0gJ01vZHVsZScKICAgICAgICBUZXN0My5fX21vZHVsZV9fID0gJ01vZHVsZTInCiAgICAgICAgc3lzLm1vZHVsZXNbJ01vZHVsZSddID0gTW9kdWxlMQogICAgICAgIHN5cy5tb2R1bGVzWydNb2R1bGUyJ10gPSBNb2R1bGUyCgogICAgICAgIGZpcnN0ID0gdW5pdHRlc3QuVGVzdFN1aXRlKChUZXN0MSgndGVzdE9uZScpLCkpCiAgICAgICAgc2Vjb25kID0gdW5pdHRlc3QuVGVzdFN1aXRlKChUZXN0MSgndGVzdFR3bycpLCkpCiAgICAgICAgdGhpcmQgPSB1bml0dGVzdC5UZXN0U3VpdGUoKFRlc3QyKCd0ZXN0T25lJyksKSkKICAgICAgICBmb3VydGggPSB1bml0dGVzdC5UZXN0U3VpdGUoKFRlc3QyKCd0ZXN0VHdvJyksKSkKICAgICAgICBmaWZ0aCA9IHVuaXR0ZXN0LlRlc3RTdWl0ZSgoVGVzdDMoJ3Rlc3RPbmUnKSwpKQogICAgICAgIHNpeHRoID0gdW5pdHRlc3QuVGVzdFN1aXRlKChUZXN0MygndGVzdFR3bycpLCkpCiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoKGZpcnN0LCBzZWNvbmQsIHRoaXJkLCBmb3VydGgsIGZpZnRoLCBzaXh0aCkpCgogICAgICAgIHJ1bm5lciA9IHNlbGYuZ2V0UnVubmVyKCkKICAgICAgICByZXN1bHQgPSBydW5uZXIucnVuKHN1aXRlKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCA2KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAwKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdHMsCiAgICAgICAgICAgICAgICAgICAgICAgICBbJ01vZHVsZTEuc2V0VXBNb2R1bGUnLCAnc2V0dXAgMScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgJ1Rlc3QxLnRlc3RPbmUnLCAnVGVzdDEudGVzdFR3bycsICd0ZWFyZG93biAxJywKICAgICAgICAgICAgICAgICAgICAgICAgICAnc2V0dXAgMicsICdUZXN0Mi50ZXN0T25lJywgJ1Rlc3QyLnRlc3RUd28nLAogICAgICAgICAgICAgICAgICAgICAgICAgICd0ZWFyZG93biAyJywgJ01vZHVsZTEudGVhckRvd25Nb2R1bGUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICdNb2R1bGUyLnNldFVwTW9kdWxlJywgJ3NldHVwIDMnLAogICAgICAgICAgICAgICAgICAgICAgICAgICdUZXN0My50ZXN0T25lJywgJ1Rlc3QzLnRlc3RUd28nLAogICAgICAgICAgICAgICAgICAgICAgICAgICd0ZWFyZG93biAzJywgJ01vZHVsZTIudGVhckRvd25Nb2R1bGUnXSkKCiAgICBkZWYgdGVzdF9zZXR1cF9tb2R1bGUoc2VsZik6CiAgICAgICAgY2xhc3MgTW9kdWxlKG9iamVjdCk6CiAgICAgICAgICAgIG1vZHVsZVNldHVwID0gMAogICAgICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcE1vZHVsZSgpOgogICAgICAgICAgICAgICAgTW9kdWxlLm1vZHVsZVNldHVwICs9IDEKCiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIFRlc3QuX19tb2R1bGVfXyA9ICdNb2R1bGUnCiAgICAgICAgc3lzLm1vZHVsZXNbJ01vZHVsZSddID0gTW9kdWxlCgogICAgICAgIHJlc3VsdCA9IHNlbGYucnVuVGVzdHMoVGVzdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKE1vZHVsZS5tb2R1bGVTZXR1cCwgMSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC50ZXN0c1J1biwgMikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZXJyb3JzKSwgMCkKCiAgICBkZWYgdGVzdF9lcnJvcl9pbl9zZXR1cF9tb2R1bGUoc2VsZik6CiAgICAgICAgY2xhc3MgTW9kdWxlKG9iamVjdCk6CiAgICAgICAgICAgIG1vZHVsZVNldHVwID0gMAogICAgICAgICAgICBtb2R1bGVUb3JuRG93biA9IDAKICAgICAgICAgICAgQHN0YXRpY21ldGhvZAogICAgICAgICAgICBkZWYgc2V0VXBNb2R1bGUoKToKICAgICAgICAgICAgICAgIE1vZHVsZS5tb2R1bGVTZXR1cCArPSAxCiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ2ZvbycpCiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duTW9kdWxlKCk6CiAgICAgICAgICAgICAgICBNb2R1bGUubW9kdWxlVG9ybkRvd24gKz0gMQoKICAgICAgICBjbGFzcyBUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgY2xhc3NTZXRVcCA9IEZhbHNlCiAgICAgICAgICAgIGNsYXNzVG9ybkRvd24gPSBGYWxzZQogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHNldFVwQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIFRlc3QuY2xhc3NTZXRVcCA9IFRydWUKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiB0ZWFyRG93bkNsYXNzKGNscyk6CiAgICAgICAgICAgICAgICBUZXN0LmNsYXNzVG9ybkRvd24gPSBUcnVlCiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBjbGFzcyBUZXN0Mih1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIFRlc3QuX19tb2R1bGVfXyA9ICdNb2R1bGUnCiAgICAgICAgVGVzdDIuX19tb2R1bGVfXyA9ICdNb2R1bGUnCiAgICAgICAgc3lzLm1vZHVsZXNbJ01vZHVsZSddID0gTW9kdWxlCgogICAgICAgIHJlc3VsdCA9IHNlbGYucnVuVGVzdHMoVGVzdCwgVGVzdDIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChNb2R1bGUubW9kdWxlU2V0dXAsIDEpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChNb2R1bGUubW9kdWxlVG9ybkRvd24sIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDApCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShUZXN0LmNsYXNzU2V0VXApCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShUZXN0LmNsYXNzVG9ybkRvd24pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDEpCiAgICAgICAgZXJyb3IsIF8gPSByZXN1bHQuZXJyb3JzWzBdCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIoZXJyb3IpLCAnc2V0VXBNb2R1bGUgKE1vZHVsZSknKQoKICAgIGRlZiB0ZXN0X3Rlc3RjYXNlX3dpdGhfbWlzc2luZ19tb2R1bGUoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIFRlc3QuX19tb2R1bGVfXyA9ICdNb2R1bGUnCiAgICAgICAgc3lzLm1vZHVsZXMucG9wKCdNb2R1bGUnLCBOb25lKQoKICAgICAgICByZXN1bHQgPSBzZWxmLnJ1blRlc3RzKFRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDIpCgogICAgZGVmIHRlc3RfdGVhcmRvd25fbW9kdWxlKHNlbGYpOgogICAgICAgIGNsYXNzIE1vZHVsZShvYmplY3QpOgogICAgICAgICAgICBtb2R1bGVUb3JuRG93biA9IDAKICAgICAgICAgICAgQHN0YXRpY21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25Nb2R1bGUoKToKICAgICAgICAgICAgICAgIE1vZHVsZS5tb2R1bGVUb3JuRG93biArPSAxCgogICAgICAgIGNsYXNzIFRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF9vbmUoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0X3R3byhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICBUZXN0Ll9fbW9kdWxlX18gPSAnTW9kdWxlJwogICAgICAgIHN5cy5tb2R1bGVzWydNb2R1bGUnXSA9IE1vZHVsZQoKICAgICAgICByZXN1bHQgPSBzZWxmLnJ1blRlc3RzKFRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChNb2R1bGUubW9kdWxlVG9ybkRvd24sIDEpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDApCgogICAgZGVmIHRlc3RfZXJyb3JfaW5fdGVhcmRvd25fbW9kdWxlKHNlbGYpOgogICAgICAgIGNsYXNzIE1vZHVsZShvYmplY3QpOgogICAgICAgICAgICBtb2R1bGVUb3JuRG93biA9IDAKICAgICAgICAgICAgQHN0YXRpY21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25Nb2R1bGUoKToKICAgICAgICAgICAgICAgIE1vZHVsZS5tb2R1bGVUb3JuRG93biArPSAxCiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ2ZvbycpCgogICAgICAgIGNsYXNzIFRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBjbGFzc1NldFVwID0gRmFsc2UKICAgICAgICAgICAgY2xhc3NUb3JuRG93biA9IEZhbHNlCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgc2V0VXBDbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgVGVzdC5jbGFzc1NldFVwID0gVHJ1ZQogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIFRlc3QuY2xhc3NUb3JuRG93biA9IFRydWUKICAgICAgICAgICAgZGVmIHRlc3Rfb25lKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBkZWYgdGVzdF90d28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIGNsYXNzIFRlc3QyKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Rfb25lKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBkZWYgdGVzdF90d28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgVGVzdC5fX21vZHVsZV9fID0gJ01vZHVsZScKICAgICAgICBUZXN0Mi5fX21vZHVsZV9fID0gJ01vZHVsZScKICAgICAgICBzeXMubW9kdWxlc1snTW9kdWxlJ10gPSBNb2R1bGUKCiAgICAgICAgcmVzdWx0ID0gc2VsZi5ydW5UZXN0cyhUZXN0LCBUZXN0MikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKE1vZHVsZS5tb2R1bGVUb3JuRG93biwgMSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC50ZXN0c1J1biwgNCkKICAgICAgICBzZWxmLmFzc2VydFRydWUoVGVzdC5jbGFzc1NldFVwKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShUZXN0LmNsYXNzVG9ybkRvd24pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDEpCiAgICAgICAgZXJyb3IsIF8gPSByZXN1bHQuZXJyb3JzWzBdCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIoZXJyb3IpLCAndGVhckRvd25Nb2R1bGUgKE1vZHVsZSknKQoKICAgIGRlZiB0ZXN0X3NraXB0ZXN0X2luX3NldHVwY2xhc3Moc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgc2V0VXBDbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgcmFpc2UgdW5pdHRlc3QuU2tpcFRlc3QoJ2ZvbycpCiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICByZXN1bHQgPSBzZWxmLnJ1blRlc3RzKFRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LnNraXBwZWQpLCAxKQogICAgICAgIHNraXBwZWQgPSByZXN1bHQuc2tpcHBlZFswXVswXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKHNraXBwZWQpLCAnc2V0VXBDbGFzcyAoJXMuVGVzdCknICUgX19uYW1lX18pCgogICAgZGVmIHRlc3Rfc2tpcHRlc3RfaW5fc2V0dXBtb2R1bGUoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBjbGFzcyBNb2R1bGUob2JqZWN0KToKICAgICAgICAgICAgQHN0YXRpY21ldGhvZAogICAgICAgICAgICBkZWYgc2V0VXBNb2R1bGUoKToKICAgICAgICAgICAgICAgIHJhaXNlIHVuaXR0ZXN0LlNraXBUZXN0KCdmb28nKQoKICAgICAgICBUZXN0Ll9fbW9kdWxlX18gPSAnTW9kdWxlJwogICAgICAgIHN5cy5tb2R1bGVzWydNb2R1bGUnXSA9IE1vZHVsZQoKICAgICAgICByZXN1bHQgPSBzZWxmLnJ1blRlc3RzKFRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LnNraXBwZWQpLCAxKQogICAgICAgIHNraXBwZWQgPSByZXN1bHQuc2tpcHBlZFswXVswXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKHNraXBwZWQpLCAnc2V0VXBNb2R1bGUgKE1vZHVsZSknKQoKICAgIGRlZiB0ZXN0X3N1aXRlX2RlYnVnX2V4ZWN1dGVzX3NldHVwc19hbmRfdGVhcmRvd25zKHNlbGYpOgogICAgICAgIG9yZGVyaW5nID0gW10KCiAgICAgICAgY2xhc3MgTW9kdWxlKG9iamVjdCk6CiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHNldFVwTW9kdWxlKCk6CiAgICAgICAgICAgICAgICBvcmRlcmluZy5hcHBlbmQoJ3NldFVwTW9kdWxlJykKICAgICAgICAgICAgQHN0YXRpY21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25Nb2R1bGUoKToKICAgICAgICAgICAgICAgIG9yZGVyaW5nLmFwcGVuZCgndGVhckRvd25Nb2R1bGUnKQoKICAgICAgICBjbGFzcyBUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcENsYXNzKGNscyk6CiAgICAgICAgICAgICAgICBvcmRlcmluZy5hcHBlbmQoJ3NldFVwQ2xhc3MnKQogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIG9yZGVyaW5nLmFwcGVuZCgndGVhckRvd25DbGFzcycpCiAgICAgICAgICAgIGRlZiB0ZXN0X3NvbWV0aGluZyhzZWxmKToKICAgICAgICAgICAgICAgIG9yZGVyaW5nLmFwcGVuZCgndGVzdF9zb21ldGhpbmcnKQoKICAgICAgICBUZXN0Ll9fbW9kdWxlX18gPSAnTW9kdWxlJwogICAgICAgIHN5cy5tb2R1bGVzWydNb2R1bGUnXSA9IE1vZHVsZQoKICAgICAgICBzdWl0ZSA9IHVuaXR0ZXN0LmRlZmF1bHRUZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb21UZXN0Q2FzZShUZXN0KQogICAgICAgIHN1aXRlLmRlYnVnKCkKICAgICAgICBleHBlY3RlZE9yZGVyID0gWydzZXRVcE1vZHVsZScsICdzZXRVcENsYXNzJywgJ3Rlc3Rfc29tZXRoaW5nJywgJ3RlYXJEb3duQ2xhc3MnLCAndGVhckRvd25Nb2R1bGUnXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwob3JkZXJpbmcsIGV4cGVjdGVkT3JkZXIpCgogICAgZGVmIHRlc3Rfc3VpdGVfZGVidWdfcHJvcGFnYXRlc19leGNlcHRpb25zKHNlbGYpOgogICAgICAgIGNsYXNzIE1vZHVsZShvYmplY3QpOgogICAgICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcE1vZHVsZSgpOgogICAgICAgICAgICAgICAgaWYgcGhhc2UgPT0gMDoKICAgICAgICAgICAgICAgICAgICByYWlzZSBFeGNlcHRpb24oJ3NldFVwTW9kdWxlJykKICAgICAgICAgICAgQHN0YXRpY21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25Nb2R1bGUoKToKICAgICAgICAgICAgICAgIGlmIHBoYXNlID09IDE6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCd0ZWFyRG93bk1vZHVsZScpCgogICAgICAgIGNsYXNzIFRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHNldFVwQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIGlmIHBoYXNlID09IDI6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCdzZXRVcENsYXNzJykKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiB0ZWFyRG93bkNsYXNzKGNscyk6CiAgICAgICAgICAgICAgICBpZiBwaGFzZSA9PSAzOgogICAgICAgICAgICAgICAgICAgIHJhaXNlIEV4Y2VwdGlvbigndGVhckRvd25DbGFzcycpCiAgICAgICAgICAgIGRlZiB0ZXN0X3NvbWV0aGluZyhzZWxmKToKICAgICAgICAgICAgICAgIGlmIHBoYXNlID09IDQ6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCd0ZXN0X3NvbWV0aGluZycpCgogICAgICAgIFRlc3QuX19tb2R1bGVfXyA9ICdNb2R1bGUnCiAgICAgICAgc3lzLm1vZHVsZXNbJ01vZHVsZSddID0gTW9kdWxlCgogICAgICAgIF9zdWl0ZSA9IHVuaXR0ZXN0LmRlZmF1bHRUZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb21UZXN0Q2FzZShUZXN0KQogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKICAgICAgICBzdWl0ZS5hZGRUZXN0KF9zdWl0ZSkKCiAgICAgICAgbWVzc2FnZXMgPSAoJ3NldFVwTW9kdWxlJywgJ3RlYXJEb3duTW9kdWxlJywgJ3NldFVwQ2xhc3MnLCAndGVhckRvd25DbGFzcycsICd0ZXN0X3NvbWV0aGluZycpCiAgICAgICAgZm9yIHBoYXNlLCBtc2cgaW4gZW51bWVyYXRlKG1lc3NhZ2VzKToKICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlc1JlZ2V4KEV4Y2VwdGlvbiwgbXNnKToKICAgICAgICAgICAgICAgIHN1aXRlLmRlYnVnKCkKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICB1bml0dGVzdC5tYWluKCkK',
'/Lib/unittest/test/test_skipping.py':'aW1wb3J0IHVuaXR0ZXN0Cgpmcm9tIC5zdXBwb3J0IGltcG9ydCBMb2dnaW5nUmVzdWx0CgoKY2xhc3MgVGVzdF9UZXN0U2tpcHBpbmcodW5pdHRlc3QuVGVzdENhc2UpOgoKICAgIGRlZiB0ZXN0X3NraXBwaW5nKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0X3NraXBfbWUoc2VsZik6CiAgICAgICAgICAgICAgICBzZWxmLnNraXBUZXN0KCJza2lwIikKICAgICAgICBldmVudHMgPSBbXQogICAgICAgIHJlc3VsdCA9IExvZ2dpbmdSZXN1bHQoZXZlbnRzKQogICAgICAgIHRlc3QgPSBGb28oInRlc3Rfc2tpcF9tZSIpCiAgICAgICAgdGVzdC5ydW4ocmVzdWx0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZXZlbnRzLCBbJ3N0YXJ0VGVzdCcsICdhZGRTa2lwJywgJ3N0b3BUZXN0J10pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQuc2tpcHBlZCwgWyh0ZXN0LCAic2tpcCIpXSkKCiAgICAgICAgIyBUcnkgbGV0dGluZyBzZXRVcCBza2lwIHRoZSB0ZXN0IG5vdy4KICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgc2V0VXAoc2VsZik6CiAgICAgICAgICAgICAgICBzZWxmLnNraXBUZXN0KCJ0ZXN0aW5nIikKICAgICAgICAgICAgZGVmIHRlc3Rfbm90aGluZyhzZWxmKTogcGFzcwogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCiAgICAgICAgdGVzdCA9IEZvbygidGVzdF9ub3RoaW5nIikKICAgICAgICB0ZXN0LnJ1bihyZXN1bHQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIFsnc3RhcnRUZXN0JywgJ2FkZFNraXAnLCAnc3RvcFRlc3QnXSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC5za2lwcGVkLCBbKHRlc3QsICJ0ZXN0aW5nIildKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCAxKQoKICAgIGRlZiB0ZXN0X3NraXBwaW5nX2RlY29yYXRvcnMoc2VsZik6CiAgICAgICAgb3BfdGFibGUgPSAoKHVuaXR0ZXN0LnNraXBVbmxlc3MsIEZhbHNlLCBUcnVlKSwKICAgICAgICAgICAgICAgICAgICAodW5pdHRlc3Quc2tpcElmLCBUcnVlLCBGYWxzZSkpCiAgICAgICAgZm9yIGRlY28sIGRvX3NraXAsIGRvbnRfc2tpcCBpbiBvcF90YWJsZToKICAgICAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgICAgIEBkZWNvKGRvX3NraXAsICJ0ZXN0aW5nIikKICAgICAgICAgICAgICAgIGRlZiB0ZXN0X3NraXAoc2VsZik6IHBhc3MKCiAgICAgICAgICAgICAgICBAZGVjbyhkb250X3NraXAsICJ0ZXN0aW5nIikKICAgICAgICAgICAgICAgIGRlZiB0ZXN0X2RvbnRfc2tpcChzZWxmKTogcGFzcwogICAgICAgICAgICB0ZXN0X2RvX3NraXAgPSBGb28oInRlc3Rfc2tpcCIpCiAgICAgICAgICAgIHRlc3RfZG9udF9za2lwID0gRm9vKCJ0ZXN0X2RvbnRfc2tpcCIpCiAgICAgICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKFt0ZXN0X2RvX3NraXAsIHRlc3RfZG9udF9za2lwXSkKICAgICAgICAgICAgZXZlbnRzID0gW10KICAgICAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCiAgICAgICAgICAgIHN1aXRlLnJ1bihyZXN1bHQpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5za2lwcGVkKSwgMSkKICAgICAgICAgICAgZXhwZWN0ZWQgPSBbJ3N0YXJ0VGVzdCcsICdhZGRTa2lwJywgJ3N0b3BUZXN0JywKICAgICAgICAgICAgICAgICAgICAgICAgJ3N0YXJ0VGVzdCcsICdhZGRTdWNjZXNzJywgJ3N0b3BUZXN0J10KICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIGV4cGVjdGVkKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC50ZXN0c1J1biwgMikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQuc2tpcHBlZCwgWyh0ZXN0X2RvX3NraXAsICJ0ZXN0aW5nIildKQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0Lndhc1N1Y2Nlc3NmdWwoKSkKCiAgICBkZWYgdGVzdF9za2lwX2NsYXNzKHNlbGYpOgogICAgICAgIEB1bml0dGVzdC5za2lwKCJ0ZXN0aW5nIikKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOgogICAgICAgICAgICAgICAgcmVjb3JkLmFwcGVuZCgxKQogICAgICAgIHJlY29yZCA9IFtdCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgdGVzdCA9IEZvbygidGVzdF8xIikKICAgICAgICBzdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShbdGVzdF0pCiAgICAgICAgc3VpdGUucnVuKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC5za2lwcGVkLCBbKHRlc3QsICJ0ZXN0aW5nIildKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVjb3JkLCBbXSkKCiAgICBkZWYgdGVzdF9za2lwX25vbl91bml0dGVzdF9jbGFzcyhzZWxmKToKICAgICAgICBAdW5pdHRlc3Quc2tpcCgidGVzdGluZyIpCiAgICAgICAgY2xhc3MgTWl4aW46CiAgICAgICAgICAgIGRlZiB0ZXN0XzEoc2VsZik6CiAgICAgICAgICAgICAgICByZWNvcmQuYXBwZW5kKDEpCiAgICAgICAgY2xhc3MgRm9vKE1peGluLCB1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHBhc3MKICAgICAgICByZWNvcmQgPSBbXQogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHRlc3QgPSBGb28oInRlc3RfMSIpCiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoW3Rlc3RdKQogICAgICAgIHN1aXRlLnJ1bihyZXN1bHQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQuc2tpcHBlZCwgWyh0ZXN0LCAidGVzdGluZyIpXSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlY29yZCwgW10pCgogICAgZGVmIHRlc3RfZXhwZWN0ZWRfZmFpbHVyZShzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBAdW5pdHRlc3QuZXhwZWN0ZWRGYWlsdXJlCiAgICAgICAgICAgIGRlZiB0ZXN0X2RpZShzZWxmKToKICAgICAgICAgICAgICAgIHNlbGYuZmFpbCgiaGVscCBtZSEiKQogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCiAgICAgICAgdGVzdCA9IEZvbygidGVzdF9kaWUiKQogICAgICAgIHRlc3QucnVuKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywKICAgICAgICAgICAgICAgICAgICAgICAgIFsnc3RhcnRUZXN0JywgJ2FkZEV4cGVjdGVkRmFpbHVyZScsICdzdG9wVGVzdCddKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LmV4cGVjdGVkRmFpbHVyZXNbMF1bMF0sIHRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHJlc3VsdC53YXNTdWNjZXNzZnVsKCkpCgogICAgZGVmIHRlc3RfdW5leHBlY3RlZF9zdWNjZXNzKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIEB1bml0dGVzdC5leHBlY3RlZEZhaWx1cmUKICAgICAgICAgICAgZGVmIHRlc3RfZGllKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCiAgICAgICAgdGVzdCA9IEZvbygidGVzdF9kaWUiKQogICAgICAgIHRlc3QucnVuKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywKICAgICAgICAgICAgICAgICAgICAgICAgIFsnc3RhcnRUZXN0JywgJ2FkZFVuZXhwZWN0ZWRTdWNjZXNzJywgJ3N0b3BUZXN0J10pCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShyZXN1bHQuZmFpbHVyZXMpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudW5leHBlY3RlZFN1Y2Nlc3NlcywgW3Rlc3RdKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShyZXN1bHQud2FzU3VjY2Vzc2Z1bCgpKQoKICAgIGRlZiB0ZXN0X3NraXBfZG9lc250X3J1bl9zZXR1cChzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICB3YXNTZXRVcCA9IEZhbHNlCiAgICAgICAgICAgIHdhc1Rvcm5Eb3duID0gRmFsc2UKICAgICAgICAgICAgZGVmIHNldFVwKHNlbGYpOgogICAgICAgICAgICAgICAgRm9vLndhc1NldFVwID0gVHJ1ZQogICAgICAgICAgICBkZWYgdG9ybkRvd24oc2VsZik6CiAgICAgICAgICAgICAgICBGb28ud2FzVG9ybkRvd24gPSBUcnVlCiAgICAgICAgICAgIEB1bml0dGVzdC5za2lwKCd0ZXN0aW5nJykKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgdGVzdCA9IEZvbygidGVzdF8xIikKICAgICAgICBzdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShbdGVzdF0pCiAgICAgICAgc3VpdGUucnVuKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC5za2lwcGVkLCBbKHRlc3QsICJ0ZXN0aW5nIildKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoRm9vLndhc1NldFVwKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoRm9vLndhc1Rvcm5Eb3duKQoKICAgIGRlZiB0ZXN0X2RlY29yYXRlZF9za2lwKHNlbGYpOgogICAgICAgIGRlZiBkZWNvcmF0b3IoZnVuYyk6CiAgICAgICAgICAgIGRlZiBpbm5lcigqYSk6CiAgICAgICAgICAgICAgICByZXR1cm4gZnVuYygqYSkKICAgICAgICAgICAgcmV0dXJuIGlubmVyCgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIEBkZWNvcmF0b3IKICAgICAgICAgICAgQHVuaXR0ZXN0LnNraXAoJ3Rlc3RpbmcnKQogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICB0ZXN0ID0gRm9vKCJ0ZXN0XzEiKQogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKFt0ZXN0XSkKICAgICAgICBzdWl0ZS5ydW4ocmVzdWx0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnNraXBwZWQsIFsodGVzdCwgInRlc3RpbmciKV0pCg==',
'/Lib/unittest/test/test_suite.py':'aW1wb3J0IHVuaXR0ZXN0CgppbXBvcnQgc3lzCmZyb20gLnN1cHBvcnQgaW1wb3J0IExvZ2dpbmdSZXN1bHQsIFRlc3RFcXVhbGl0eQoKCiMjIyBTdXBwb3J0IGNvZGUgZm9yIFRlc3RfVGVzdFN1aXRlCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmNsYXNzIFRlc3Qob2JqZWN0KToKICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgIGRlZiB0ZXN0XzIoc2VsZik6IHBhc3MKICAgICAgICBkZWYgdGVzdF8zKHNlbGYpOiBwYXNzCiAgICAgICAgZGVmIHJ1blRlc3Qoc2VsZik6IHBhc3MKCmRlZiBfbWtfVGVzdFN1aXRlKCpuYW1lcyk6CiAgICByZXR1cm4gdW5pdHRlc3QuVGVzdFN1aXRlKFRlc3QuRm9vKG4pIGZvciBuIGluIG5hbWVzKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKCmNsYXNzIFRlc3RfVGVzdFN1aXRlKHVuaXR0ZXN0LlRlc3RDYXNlLCBUZXN0RXF1YWxpdHkpOgoKICAgICMjIyBTZXQgdXAgYXR0cmlidXRlcyBuZWVkZWQgYnkgaW5oZXJpdGVkIHRlc3RzCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgogICAgIyBVc2VkIGJ5IFRlc3RFcXVhbGl0eS50ZXN0X2VxCiAgICBlcV9wYWlycyA9IFsodW5pdHRlc3QuVGVzdFN1aXRlKCksIHVuaXR0ZXN0LlRlc3RTdWl0ZSgpKQogICAgICAgICAgICAgICAsKHVuaXR0ZXN0LlRlc3RTdWl0ZSgpLCB1bml0dGVzdC5UZXN0U3VpdGUoW10pKQogICAgICAgICAgICAgICAsKF9ta19UZXN0U3VpdGUoJ3Rlc3RfMScpLCBfbWtfVGVzdFN1aXRlKCd0ZXN0XzEnKSldCgogICAgIyBVc2VkIGJ5IFRlc3RFcXVhbGl0eS50ZXN0X25lCiAgICBuZV9wYWlycyA9IFsodW5pdHRlc3QuVGVzdFN1aXRlKCksIF9ta19UZXN0U3VpdGUoJ3Rlc3RfMScpKQogICAgICAgICAgICAgICAsKHVuaXR0ZXN0LlRlc3RTdWl0ZShbXSksIF9ta19UZXN0U3VpdGUoJ3Rlc3RfMScpKQogICAgICAgICAgICAgICAsKF9ta19UZXN0U3VpdGUoJ3Rlc3RfMScsICd0ZXN0XzInKSwgX21rX1Rlc3RTdWl0ZSgndGVzdF8xJywgJ3Rlc3RfMycpKQogICAgICAgICAgICAgICAsKF9ta19UZXN0U3VpdGUoJ3Rlc3RfMScpLCBfbWtfVGVzdFN1aXRlKCd0ZXN0XzInKSldCgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgIyMjIC9TZXQgdXAgYXR0cmlidXRlcyBuZWVkZWQgYnkgaW5oZXJpdGVkIHRlc3RzCgogICAgIyMjIFRlc3RzIGZvciBUZXN0U3VpdGUuX19pbml0X18KICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAjICJjbGFzcyBUZXN0U3VpdGUoW3Rlc3RzXSkiCiAgICAjCiAgICAjIFRoZSB0ZXN0cyBpdGVyYWJsZSBzaG91bGQgYmUgb3B0aW9uYWwKICAgIGRlZiB0ZXN0X2luaXRfX3Rlc3RzX29wdGlvbmFsKHNlbGYpOgogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdWl0ZS5jb3VudFRlc3RDYXNlcygpLCAwKQoKICAgICMgImNsYXNzIFRlc3RTdWl0ZShbdGVzdHNdKSIKICAgICMgLi4uCiAgICAjICJJZiB0ZXN0cyBpcyBnaXZlbiwgaXQgbXVzdCBiZSBhbiBpdGVyYWJsZSBvZiBpbmRpdmlkdWFsIHRlc3QgY2FzZXMKICAgICMgb3Igb3RoZXIgdGVzdCBzdWl0ZXMgdGhhdCB3aWxsIGJlIHVzZWQgdG8gYnVpbGQgdGhlIHN1aXRlIGluaXRpYWxseSIKICAgICMKICAgICMgVGVzdFN1aXRlIHNob3VsZCBkZWFsIHdpdGggZW1wdHkgdGVzdHMgaXRlcmFibGVzIGJ5IGFsbG93aW5nIHRoZQogICAgIyBjcmVhdGlvbiBvZiBhbiBlbXB0eSBzdWl0ZQogICAgZGVmIHRlc3RfaW5pdF9fZW1wdHlfdGVzdHMoc2VsZik6CiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoW10pCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3VpdGUuY291bnRUZXN0Q2FzZXMoKSwgMCkKCiAgICAjICJjbGFzcyBUZXN0U3VpdGUoW3Rlc3RzXSkiCiAgICAjIC4uLgogICAgIyAiSWYgdGVzdHMgaXMgZ2l2ZW4sIGl0IG11c3QgYmUgYW4gaXRlcmFibGUgb2YgaW5kaXZpZHVhbCB0ZXN0IGNhc2VzCiAgICAjIG9yIG90aGVyIHRlc3Qgc3VpdGVzIHRoYXQgd2lsbCBiZSB1c2VkIHRvIGJ1aWxkIHRoZSBzdWl0ZSBpbml0aWFsbHkiCiAgICAjCiAgICAjIFRlc3RTdWl0ZSBzaG91bGQgYWxsb3cgYW55IGl0ZXJhYmxlIHRvIHByb3ZpZGUgdGVzdHMKICAgIGRlZiB0ZXN0X2luaXRfX3Rlc3RzX2Zyb21fYW55X2l0ZXJhYmxlKHNlbGYpOgogICAgICAgIGRlZiB0ZXN0cygpOgogICAgICAgICAgICB5aWVsZCB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKICAgICAgICAgICAgeWllbGQgdW5pdHRlc3QuRnVuY3Rpb25UZXN0Q2FzZShsYW1iZGE6IE5vbmUpCgogICAgICAgIHN1aXRlXzEgPSB1bml0dGVzdC5UZXN0U3VpdGUodGVzdHMoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN1aXRlXzEuY291bnRUZXN0Q2FzZXMoKSwgMikKCiAgICAgICAgc3VpdGVfMiA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShzdWl0ZV8xKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3VpdGVfMi5jb3VudFRlc3RDYXNlcygpLCAyKQoKICAgICAgICBzdWl0ZV8zID0gdW5pdHRlc3QuVGVzdFN1aXRlKHNldChzdWl0ZV8xKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN1aXRlXzMuY291bnRUZXN0Q2FzZXMoKSwgMikKCiAgICAjICJjbGFzcyBUZXN0U3VpdGUoW3Rlc3RzXSkiCiAgICAjIC4uLgogICAgIyAiSWYgdGVzdHMgaXMgZ2l2ZW4sIGl0IG11c3QgYmUgYW4gaXRlcmFibGUgb2YgaW5kaXZpZHVhbCB0ZXN0IGNhc2VzCiAgICAjIG9yIG90aGVyIHRlc3Qgc3VpdGVzIHRoYXQgd2lsbCBiZSB1c2VkIHRvIGJ1aWxkIHRoZSBzdWl0ZSBpbml0aWFsbHkiCiAgICAjCiAgICAjIERvZXMgVGVzdFN1aXRlKCkgYWxzbyBhbGxvdyBvdGhlciBUZXN0U3VpdGUoKSBpbnN0YW5jZXMgdG8gYmUgcHJlc2VudAogICAgIyBpbiB0aGUgdGVzdHMgaXRlcmFibGU/CiAgICBkZWYgdGVzdF9pbml0X19UZXN0U3VpdGVfaW5zdGFuY2VzX2luX3Rlc3RzKHNlbGYpOgogICAgICAgIGRlZiB0ZXN0cygpOgogICAgICAgICAgICBmdGMgPSB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKICAgICAgICAgICAgeWllbGQgdW5pdHRlc3QuVGVzdFN1aXRlKFtmdGNdKQogICAgICAgICAgICB5aWVsZCB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKCiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUodGVzdHMoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN1aXRlLmNvdW50VGVzdENhc2VzKCksIDIpCgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgIyMjIC9UZXN0cyBmb3IgVGVzdFN1aXRlLl9faW5pdF9fCgogICAgIyBDb250YWluZXIgdHlwZXMgc2hvdWxkIHN1cHBvcnQgdGhlIGl0ZXIgcHJvdG9jb2wKICAgIGRlZiB0ZXN0X2l0ZXIoc2VsZik6CiAgICAgICAgdGVzdDEgPSB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKICAgICAgICB0ZXN0MiA9IHVuaXR0ZXN0LkZ1bmN0aW9uVGVzdENhc2UobGFtYmRhOiBOb25lKQogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCh0ZXN0MSwgdGVzdDIpKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3Qoc3VpdGUpLCBbdGVzdDEsIHRlc3QyXSkKCiAgICAjICJSZXR1cm4gdGhlIG51bWJlciBvZiB0ZXN0cyByZXByZXNlbnRlZCBieSB0aGUgdGhpcyB0ZXN0IG9iamVjdC4KICAgICMgLi4udGhpcyBtZXRob2QgaXMgYWxzbyBpbXBsZW1lbnRlZCBieSB0aGUgVGVzdFN1aXRlIGNsYXNzLCB3aGljaCBjYW4KICAgICMgcmV0dXJuIGxhcmdlciBbZ3JlYXRlciB0aGFuIDFdIHZhbHVlcyIKICAgICMKICAgICMgUHJlc3VtYWJseSBhbiBlbXB0eSBUZXN0U3VpdGUgcmV0dXJucyAwPwogICAgZGVmIHRlc3RfY291bnRUZXN0Q2FzZXNfemVyb19zaW1wbGUoc2VsZik6CiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN1aXRlLmNvdW50VGVzdENhc2VzKCksIDApCgogICAgIyAiUmV0dXJuIHRoZSBudW1iZXIgb2YgdGVzdHMgcmVwcmVzZW50ZWQgYnkgdGhlIHRoaXMgdGVzdCBvYmplY3QuCiAgICAjIC4uLnRoaXMgbWV0aG9kIGlzIGFsc28gaW1wbGVtZW50ZWQgYnkgdGhlIFRlc3RTdWl0ZSBjbGFzcywgd2hpY2ggY2FuCiAgICAjIHJldHVybiBsYXJnZXIgW2dyZWF0ZXIgdGhhbiAxXSB2YWx1ZXMiCiAgICAjCiAgICAjIFByZXN1bWFibHkgYW4gZW1wdHkgVGVzdFN1aXRlIChldmVuIGlmIGl0IGNvbnRhaW5zIG90aGVyIGVtcHR5CiAgICAjIFRlc3RTdWl0ZSBpbnN0YW5jZXMpIHJldHVybnMgMD8KICAgIGRlZiB0ZXN0X2NvdW50VGVzdENhc2VzX3plcm9fbmVzdGVkKHNlbGYpOgogICAgICAgIGNsYXNzIFRlc3QxKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKFt1bml0dGVzdC5UZXN0U3VpdGUoKV0pCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3VpdGUuY291bnRUZXN0Q2FzZXMoKSwgMCkKCiAgICAjICJSZXR1cm4gdGhlIG51bWJlciBvZiB0ZXN0cyByZXByZXNlbnRlZCBieSB0aGUgdGhpcyB0ZXN0IG9iamVjdC4KICAgICMgLi4udGhpcyBtZXRob2QgaXMgYWxzbyBpbXBsZW1lbnRlZCBieSB0aGUgVGVzdFN1aXRlIGNsYXNzLCB3aGljaCBjYW4KICAgICMgcmV0dXJuIGxhcmdlciBbZ3JlYXRlciB0aGFuIDFdIHZhbHVlcyIKICAgIGRlZiB0ZXN0X2NvdW50VGVzdENhc2VzX3NpbXBsZShzZWxmKToKICAgICAgICB0ZXN0MSA9IHVuaXR0ZXN0LkZ1bmN0aW9uVGVzdENhc2UobGFtYmRhOiBOb25lKQogICAgICAgIHRlc3QyID0gdW5pdHRlc3QuRnVuY3Rpb25UZXN0Q2FzZShsYW1iZGE6IE5vbmUpCiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoKHRlc3QxLCB0ZXN0MikpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3VpdGUuY291bnRUZXN0Q2FzZXMoKSwgMikKCiAgICAjICJSZXR1cm4gdGhlIG51bWJlciBvZiB0ZXN0cyByZXByZXNlbnRlZCBieSB0aGUgdGhpcyB0ZXN0IG9iamVjdC4KICAgICMgLi4udGhpcyBtZXRob2QgaXMgYWxzbyBpbXBsZW1lbnRlZCBieSB0aGUgVGVzdFN1aXRlIGNsYXNzLCB3aGljaCBjYW4KICAgICMgcmV0dXJuIGxhcmdlciBbZ3JlYXRlciB0aGFuIDFdIHZhbHVlcyIKICAgICMKICAgICMgTWFrZSBzdXJlIHRoaXMgaG9sZHMgZm9yIG5lc3RlZCBUZXN0U3VpdGUgaW5zdGFuY2VzLCB0b28KICAgIGRlZiB0ZXN0X2NvdW50VGVzdENhc2VzX25lc3RlZChzZWxmKToKICAgICAgICBjbGFzcyBUZXN0MSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0MShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdDIoc2VsZik6IHBhc3MKCiAgICAgICAgdGVzdDIgPSB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKICAgICAgICB0ZXN0MyA9IHVuaXR0ZXN0LkZ1bmN0aW9uVGVzdENhc2UobGFtYmRhOiBOb25lKQogICAgICAgIGNoaWxkID0gdW5pdHRlc3QuVGVzdFN1aXRlKChUZXN0MSgndGVzdDInKSwgdGVzdDIpKQogICAgICAgIHBhcmVudCA9IHVuaXR0ZXN0LlRlc3RTdWl0ZSgodGVzdDMsIGNoaWxkLCBUZXN0MSgndGVzdDEnKSkpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocGFyZW50LmNvdW50VGVzdENhc2VzKCksIDQpCgogICAgIyAiUnVuIHRoZSB0ZXN0cyBhc3NvY2lhdGVkIHdpdGggdGhpcyBzdWl0ZSwgY29sbGVjdGluZyB0aGUgcmVzdWx0IGludG8KICAgICMgdGhlIHRlc3QgcmVzdWx0IG9iamVjdCBwYXNzZWQgYXMgcmVzdWx0LiIKICAgICMKICAgICMgQW5kIGlmIHRoZXJlIGFyZSBubyB0ZXN0cz8gV2hhdCB0aGVuPwogICAgZGVmIHRlc3RfcnVuX19lbXB0eV9zdWl0ZShzZWxmKToKICAgICAgICBldmVudHMgPSBbXQogICAgICAgIHJlc3VsdCA9IExvZ2dpbmdSZXN1bHQoZXZlbnRzKQoKICAgICAgICBzdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZSgpCgogICAgICAgIHN1aXRlLnJ1bihyZXN1bHQpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZXZlbnRzLCBbXSkKCiAgICAjICJOb3RlIHRoYXQgdW5saWtlIFRlc3RDYXNlLnJ1bigpLCBUZXN0U3VpdGUucnVuKCkgcmVxdWlyZXMgdGhlCiAgICAjICJyZXN1bHQgb2JqZWN0IHRvIGJlIHBhc3NlZCBpbi4iCiAgICBkZWYgdGVzdF9ydW5fX3JlcXVpcmVzX3Jlc3VsdChzZWxmKToKICAgICAgICBzdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZSgpCgogICAgICAgIHRyeToKICAgICAgICAgICAgc3VpdGUucnVuKCkKICAgICAgICBleGNlcHQgVHlwZUVycm9yOgogICAgICAgICAgICBwYXNzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCJGYWlsZWQgdG8gcmFpc2UgVHlwZUVycm9yIikKCiAgICAjICJSdW4gdGhlIHRlc3RzIGFzc29jaWF0ZWQgd2l0aCB0aGlzIHN1aXRlLCBjb2xsZWN0aW5nIHRoZSByZXN1bHQgaW50bwogICAgIyB0aGUgdGVzdCByZXN1bHQgb2JqZWN0IHBhc3NlZCBhcyByZXN1bHQuIgogICAgZGVmIHRlc3RfcnVuKHNlbGYpOgogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCgogICAgICAgIGNsYXNzIExvZ2dpbmdDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHJ1bihzZWxmLCByZXN1bHQpOgogICAgICAgICAgICAgICAgZXZlbnRzLmFwcGVuZCgncnVuICVzJyAlIHNlbGYuX3Rlc3RNZXRob2ROYW1lKQoKICAgICAgICAgICAgZGVmIHRlc3QxKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0MihzZWxmKTogcGFzcwoKICAgICAgICB0ZXN0cyA9IFtMb2dnaW5nQ2FzZSgndGVzdDEnKSwgTG9nZ2luZ0Nhc2UoJ3Rlc3QyJyldCgogICAgICAgIHVuaXR0ZXN0LlRlc3RTdWl0ZSh0ZXN0cykucnVuKHJlc3VsdCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIFsncnVuIHRlc3QxJywgJ3J1biB0ZXN0MiddKQoKICAgICMgIkFkZCBhIFRlc3RDYXNlIC4uLiB0byB0aGUgc3VpdGUiCiAgICBkZWYgdGVzdF9hZGRUZXN0X19UZXN0Q2FzZShzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKTogcGFzcwoKICAgICAgICB0ZXN0ID0gRm9vKCd0ZXN0JykKICAgICAgICBzdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZSgpCgogICAgICAgIHN1aXRlLmFkZFRlc3QodGVzdCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdWl0ZS5jb3VudFRlc3RDYXNlcygpLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFt0ZXN0XSkKCiAgICAjICJBZGQgYSAuLi4gVGVzdFN1aXRlIHRvIHRoZSBzdWl0ZSIKICAgIGRlZiB0ZXN0X2FkZFRlc3RfX1Rlc3RTdWl0ZShzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKTogcGFzcwoKICAgICAgICBzdWl0ZV8yID0gdW5pdHRlc3QuVGVzdFN1aXRlKFtGb28oJ3Rlc3QnKV0pCgogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKICAgICAgICBzdWl0ZS5hZGRUZXN0KHN1aXRlXzIpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3VpdGUuY291bnRUZXN0Q2FzZXMoKSwgMSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3Qoc3VpdGUpLCBbc3VpdGVfMl0pCgogICAgIyAiQWRkIGFsbCB0aGUgdGVzdHMgZnJvbSBhbiBpdGVyYWJsZSBvZiBUZXN0Q2FzZSBhbmQgVGVzdFN1aXRlCiAgICAjIGluc3RhbmNlcyB0byB0aGlzIHRlc3Qgc3VpdGUuIgogICAgIwogICAgIyAiVGhpcyBpcyBlcXVpdmFsZW50IHRvIGl0ZXJhdGluZyBvdmVyIHRlc3RzLCBjYWxsaW5nIGFkZFRlc3QoKSBmb3IKICAgICMgZWFjaCBlbGVtZW50IgogICAgZGVmIHRlc3RfYWRkVGVzdHMoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8yKHNlbGYpOiBwYXNzCgogICAgICAgIHRlc3RfMSA9IEZvbygndGVzdF8xJykKICAgICAgICB0ZXN0XzIgPSBGb28oJ3Rlc3RfMicpCiAgICAgICAgaW5uZXJfc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoW3Rlc3RfMl0pCgogICAgICAgIGRlZiBnZW4oKToKICAgICAgICAgICAgeWllbGQgdGVzdF8xCiAgICAgICAgICAgIHlpZWxkIHRlc3RfMgogICAgICAgICAgICB5aWVsZCBpbm5lcl9zdWl0ZQoKICAgICAgICBzdWl0ZV8xID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKICAgICAgICBzdWl0ZV8xLmFkZFRlc3RzKGdlbigpKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3Qoc3VpdGVfMSksIGxpc3QoZ2VuKCkpKQoKICAgICAgICAjICJUaGlzIGlzIGVxdWl2YWxlbnQgdG8gaXRlcmF0aW5nIG92ZXIgdGVzdHMsIGNhbGxpbmcgYWRkVGVzdCgpIGZvcgogICAgICAgICMgZWFjaCBlbGVtZW50IgogICAgICAgIHN1aXRlXzIgPSB1bml0dGVzdC5UZXN0U3VpdGUoKQogICAgICAgIGZvciB0IGluIGdlbigpOgogICAgICAgICAgICBzdWl0ZV8yLmFkZFRlc3QodCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdWl0ZV8xLCBzdWl0ZV8yKQoKICAgICMgIkFkZCBhbGwgdGhlIHRlc3RzIGZyb20gYW4gaXRlcmFibGUgb2YgVGVzdENhc2UgYW5kIFRlc3RTdWl0ZQogICAgIyBpbnN0YW5jZXMgdG8gdGhpcyB0ZXN0IHN1aXRlLiIKICAgICMKICAgICMgV2hhdCBoYXBwZW5zIGlmIGl0IGRvZXNuJ3QgZ2V0IGFuIGl0ZXJhYmxlPwogICAgZGVmIHRlc3RfYWRkVGVzdF9fbm9uaXRlcmFibGUoc2VsZik6CiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHN1aXRlLmFkZFRlc3RzKDUpCiAgICAgICAgZXhjZXB0IFR5cGVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiRmFpbGVkIHRvIHJhaXNlIFR5cGVFcnJvciIpCgogICAgZGVmIHRlc3RfYWRkVGVzdF9fbm9uY2FsbGFibGUoc2VsZik6CiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgc3VpdGUuYWRkVGVzdCwgNSkKCiAgICBkZWYgdGVzdF9hZGRUZXN0X19jYXNlc3VpdGVjbGFzcyhzZWxmKToKICAgICAgICBzdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZSgpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBzdWl0ZS5hZGRUZXN0LCBUZXN0X1Rlc3RTdWl0ZSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIHN1aXRlLmFkZFRlc3QsIHVuaXR0ZXN0LlRlc3RTdWl0ZSkKCiAgICBkZWYgdGVzdF9hZGRUZXN0c19fc3RyaW5nKHNlbGYpOgogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIHN1aXRlLmFkZFRlc3RzLCAiZm9vIikKCiAgICBkZWYgdGVzdF9mdW5jdGlvbl9pbl9zdWl0ZShzZWxmKToKICAgICAgICBkZWYgZihfKToKICAgICAgICAgICAgcGFzcwogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKICAgICAgICBzdWl0ZS5hZGRUZXN0KGYpCgogICAgICAgICMgd2hlbiB0aGUgYnVnIGlzIGZpeGVkIHRoaXMgbGluZSB3aWxsIG5vdCBjcmFzaAogICAgICAgIHN1aXRlLnJ1bih1bml0dGVzdC5UZXN0UmVzdWx0KCkpCgoKCiAgICBkZWYgdGVzdF9iYXNldGVzdHN1aXRlKHNlbGYpOgogICAgICAgIGNsYXNzIFRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICB3YXNTZXRVcCA9IEZhbHNlCiAgICAgICAgICAgIHdhc1Rvcm5Eb3duID0gRmFsc2UKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcENsYXNzKGNscyk6CiAgICAgICAgICAgICAgICBjbHMud2FzU2V0VXAgPSBUcnVlCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25DbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgY2xzLndhc1Rvcm5Eb3duID0gVHJ1ZQogICAgICAgICAgICBkZWYgdGVzdFBhc3Moc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0RmFpbChzZWxmKToKICAgICAgICAgICAgICAgIGZhaWwKICAgICAgICBjbGFzcyBNb2R1bGUob2JqZWN0KToKICAgICAgICAgICAgd2FzU2V0VXAgPSBGYWxzZQogICAgICAgICAgICB3YXNUb3JuRG93biA9IEZhbHNlCiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHNldFVwTW9kdWxlKCk6CiAgICAgICAgICAgICAgICBNb2R1bGUud2FzU2V0VXAgPSBUcnVlCiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duTW9kdWxlKCk6CiAgICAgICAgICAgICAgICBNb2R1bGUud2FzVG9ybkRvd24gPSBUcnVlCgogICAgICAgIFRlc3QuX19tb2R1bGVfXyA9ICdNb2R1bGUnCiAgICAgICAgc3lzLm1vZHVsZXNbJ01vZHVsZSddID0gTW9kdWxlCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHN5cy5tb2R1bGVzLnBvcCwgJ01vZHVsZScpCgogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuQmFzZVRlc3RTdWl0ZSgpCiAgICAgICAgc3VpdGUuYWRkVGVzdHMoW1Rlc3QoJ3Rlc3RQYXNzJyksIFRlc3QoJ3Rlc3RGYWlsJyldKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3VpdGUuY291bnRUZXN0Q2FzZXMoKSwgMikKCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgc3VpdGUucnVuKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKE1vZHVsZS53YXNTZXRVcCkKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKE1vZHVsZS53YXNUb3JuRG93bikKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKFRlc3Qud2FzU2V0VXApCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShUZXN0Lndhc1Rvcm5Eb3duKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5mYWlsdXJlcyksIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDIpCgoKICAgIGRlZiB0ZXN0X292ZXJyaWRpbmdfY2FsbChzZWxmKToKICAgICAgICBjbGFzcyBNeVN1aXRlKHVuaXR0ZXN0LlRlc3RTdWl0ZSk6CiAgICAgICAgICAgIGNhbGxlZCA9IEZhbHNlCiAgICAgICAgICAgIGRlZiBfX2NhbGxfXyhzZWxmLCAqYXJncywgKiprdyk6CiAgICAgICAgICAgICAgICBzZWxmLmNhbGxlZCA9IFRydWUKICAgICAgICAgICAgICAgIHVuaXR0ZXN0LlRlc3RTdWl0ZS5fX2NhbGxfXyhzZWxmLCAqYXJncywgKiprdykKCiAgICAgICAgc3VpdGUgPSBNeVN1aXRlKCkKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICB3cmFwcGVyID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKICAgICAgICB3cmFwcGVyLmFkZFRlc3Qoc3VpdGUpCiAgICAgICAgd3JhcHBlcihyZXN1bHQpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHN1aXRlLmNhbGxlZCkKCiAgICAgICAgIyByZXVzaW5nIHJlc3VsdHMgc2hvdWxkIGJlIHBlcm1pdHRlZCBldmVuIGlmIGFib21pbmFibGUKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKHJlc3VsdC5fdGVzdFJ1bkVudGVyZWQpCgoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICB1bml0dGVzdC5tYWluKCkK',
'/Lib/unittest/test/_test_warnings.py':'IyBoZWxwZXIgbW9kdWxlIGZvciB0ZXN0X3J1bm5lci5UZXN0X1RleHRUZXN0UnVubmVyLnRlc3Rfd2FybmluZ3MKCiIiIgpUaGlzIG1vZHVsZSBoYXMgYSBudW1iZXIgb2YgdGVzdHMgdGhhdCByYWlzZSBkaWZmZXJlbnQga2luZHMgb2Ygd2FybmluZ3MuCldoZW4gdGhlIHRlc3RzIGFyZSBydW4sIHRoZSB3YXJuaW5ncyBhcmUgY2F1Z2h0IGFuZCB0aGVpciBtZXNzYWdlcyBhcmUgcHJpbnRlZAp0byBzdGRvdXQuICBUaGlzIG1vZHVsZSBhbHNvIGFjY2VwdHMgYW4gYXJnIHRoYXQgaXMgdGhlbiBwYXNzZWQgdG8KdW5pdHRlc3QubWFpbiB0byBhZmZlY3QgdGhlIGJlaGF2aW9yIG9mIHdhcm5pbmdzLgpUZXN0X1RleHRUZXN0UnVubmVyLnRlc3Rfd2FybmluZ3MgZXhlY3V0ZXMgdGhpcyBzY3JpcHQgd2l0aCBkaWZmZXJlbnQKY29tYmluYXRpb25zIG9mIHdhcm5pbmdzIGFyZ3MgYW5kIC1XIGZsYWdzIGFuZCBjaGVjayB0aGF0IHRoZSBvdXRwdXQgaXMgY29ycmVjdC4KU2VlICMxMDUzNS4KIiIiCgppbXBvcnQgc3lzCmltcG9ydCB1bml0dGVzdAppbXBvcnQgd2FybmluZ3MKCmRlZiB3YXJuZnVuKCk6CiAgICB3YXJuaW5ncy53YXJuKCdydycsIFJ1bnRpbWVXYXJuaW5nKQoKY2xhc3MgVGVzdFdhcm5pbmdzKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICMgdW5pdHRlc3Qgd2FybmluZ3Mgd2lsbCBiZSBwcmludGVkIGF0IG1vc3Qgb25jZSBwZXIgdHlwZSAobWF4IG9uZSBtZXNzYWdlCiAgICAjIGZvciB0aGUgZmFpbCogbWV0aG9kcywgYW5kIG9uZSBmb3IgdGhlIGFzc2VydCogbWV0aG9kcykKICAgIGRlZiB0ZXN0X2Fzc2VydChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydEVxdWFscygyKzIsIDQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbHMoMioyLCA0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWxzKDIqKjIsIDQpCgogICAgZGVmIHRlc3RfZmFpbChzZWxmKToKICAgICAgICBzZWxmLmZhaWxVbmxlc3MoMSkKICAgICAgICBzZWxmLmZhaWxVbmxlc3MoVHJ1ZSkKCiAgICBkZWYgdGVzdF9vdGhlcl91bml0dGVzdChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydEFsbW9zdEVxdWFsKDIrMiwgNCkKICAgICAgICBzZWxmLmFzc2VydE5vdEFsbW9zdEVxdWFsKDQrNCwgMikKCiAgICAjIHRoZXNlIHdhcm5pbmdzIGFyZSBub3JtYWxseSBzaWxlbmNlZCwgYnV0IHRoZXkgYXJlIHByaW50ZWQgaW4gdW5pdHRlc3QKICAgIGRlZiB0ZXN0X2RlcHJlY2F0aW9uKHNlbGYpOgogICAgICAgIHdhcm5pbmdzLndhcm4oJ2R3JywgRGVwcmVjYXRpb25XYXJuaW5nKQogICAgICAgIHdhcm5pbmdzLndhcm4oJ2R3JywgRGVwcmVjYXRpb25XYXJuaW5nKQogICAgICAgIHdhcm5pbmdzLndhcm4oJ2R3JywgRGVwcmVjYXRpb25XYXJuaW5nKQoKICAgIGRlZiB0ZXN0X2ltcG9ydChzZWxmKToKICAgICAgICB3YXJuaW5ncy53YXJuKCdpdycsIEltcG9ydFdhcm5pbmcpCiAgICAgICAgd2FybmluZ3Mud2FybignaXcnLCBJbXBvcnRXYXJuaW5nKQogICAgICAgIHdhcm5pbmdzLndhcm4oJ2l3JywgSW1wb3J0V2FybmluZykKCiAgICAjIHVzZXIgd2FybmluZ3Mgc2hvdWxkIGFsd2F5cyBiZSBwcmludGVkCiAgICBkZWYgdGVzdF93YXJuaW5nKHNlbGYpOgogICAgICAgIHdhcm5pbmdzLndhcm4oJ3V3JykKICAgICAgICB3YXJuaW5ncy53YXJuKCd1dycpCiAgICAgICAgd2FybmluZ3Mud2FybigndXcnKQoKICAgICMgdGhlc2Ugd2FybmluZ3MgY29tZSBmcm9tIHRoZSBzYW1lIHBsYWNlOyB0aGV5IHdpbGwgYmUgcHJpbnRlZAogICAgIyBvbmx5IG9uY2UgYnkgZGVmYXVsdCBvciB0aHJlZSB0aW1lcyBpZiB0aGUgJ2Fsd2F5cycgZmlsdGVyIGlzIHVzZWQKICAgIGRlZiB0ZXN0X2Z1bmN0aW9uKHNlbGYpOgoKICAgICAgICB3YXJuZnVuKCkKICAgICAgICB3YXJuZnVuKCkKICAgICAgICB3YXJuZnVuKCkKCgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIHdpdGggd2FybmluZ3MuY2F0Y2hfd2FybmluZ3MocmVjb3JkPVRydWUpIGFzIHdzOgogICAgICAgICMgaWYgYW4gYXJnIGlzIHByb3ZpZGVkIHBhc3MgaXQgdG8gdW5pdHRlc3QubWFpbiBhcyAnd2FybmluZ3MnCiAgICAgICAgaWYgbGVuKHN5cy5hcmd2KSA9PSAyOgogICAgICAgICAgICB1bml0dGVzdC5tYWluKGV4aXQ9RmFsc2UsIHdhcm5pbmdzPXN5cy5hcmd2LnBvcCgpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHVuaXR0ZXN0Lm1haW4oZXhpdD1GYWxzZSkKCiAgICAjIHByaW50IGFsbCB0aGUgd2FybmluZyBtZXNzYWdlcyBjb2xsZWN0ZWQKICAgIGZvciB3IGluIHdzOgogICAgICAgIHByaW50KHcubWVzc2FnZSkK',
'/Lib/unittest/test/__init__.py':'aW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IHVuaXR0ZXN0CgoKaGVyZSA9IG9zLnBhdGguZGlybmFtZShfX2ZpbGVfXykKbG9hZGVyID0gdW5pdHRlc3QuZGVmYXVsdFRlc3RMb2FkZXIKCmRlZiBzdWl0ZSgpOgogICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoKQogICAgZm9yIGZuIGluIG9zLmxpc3RkaXIoaGVyZSk6CiAgICAgICAgaWYgZm4uc3RhcnRzd2l0aCgidGVzdCIpIGFuZCBmbi5lbmRzd2l0aCgiLnB5Iik6CiAgICAgICAgICAgIG1vZG5hbWUgPSAidW5pdHRlc3QudGVzdC4iICsgZm5bOi0zXQogICAgICAgICAgICBfX2ltcG9ydF9fKG1vZG5hbWUpCiAgICAgICAgICAgIG1vZHVsZSA9IHN5cy5tb2R1bGVzW21vZG5hbWVdCiAgICAgICAgICAgIHN1aXRlLmFkZFRlc3QobG9hZGVyLmxvYWRUZXN0c0Zyb21Nb2R1bGUobW9kdWxlKSkKICAgIHN1aXRlLmFkZFRlc3QobG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCd1bml0dGVzdC50ZXN0LnRlc3Rtb2NrJykpCiAgICByZXR1cm4gc3VpdGUKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgdW5pdHRlc3QubWFpbihkZWZhdWx0VGVzdD0ic3VpdGUiKQo=',
'/Lib/unittest/test/testmock/support.py':'aW1wb3J0IHN5cwoKZGVmIGlzX2luc3RhbmNlKG9iaiwga2xhc3MpOgogICAgIiIiVmVyc2lvbiBvZiBpc19pbnN0YW5jZSB0aGF0IGRvZXNuJ3QgYWNjZXNzIF9fY2xhc3NfXyIiIgogICAgcmV0dXJuIGlzc3ViY2xhc3ModHlwZShvYmopLCBrbGFzcykKCgpjbGFzcyBTb21lQ2xhc3Mob2JqZWN0KToKICAgIGNsYXNzX2F0dHJpYnV0ZSA9IE5vbmUKCiAgICBkZWYgd2liYmxlKHNlbGYpOgogICAgICAgIHBhc3MKCgpjbGFzcyBYKG9iamVjdCk6CiAgICBwYXNzCgoKZGVmIGV4YW1pbmVfd2FybmluZ3MoZnVuYyk6CiAgICBkZWYgd3JhcHBlcigpOgogICAgICAgIHdpdGggY2F0Y2hfd2FybmluZ3MocmVjb3JkPVRydWUpIGFzIHdzOgogICAgICAgICAgICBmdW5jKHdzKQogICAgcmV0dXJuIHdyYXBwZXIK',
'/Lib/unittest/test/testmock/testcallable.py':'IyBDb3B5cmlnaHQgKEMpIDIwMDctMjAxMiBNaWNoYWVsIEZvb3JkICYgdGhlIG1vY2sgdGVhbQojIEUtbWFpbDogZnV6enltYW4gQVQgdm9pZHNwYWNlIERPVCBvcmcgRE9UIHVrCiMgaHR0cDovL3d3dy52b2lkc3BhY2Uub3JnLnVrL3B5dGhvbi9tb2NrLwoKaW1wb3J0IHVuaXR0ZXN0CmZyb20gdW5pdHRlc3QudGVzdC50ZXN0bW9jay5zdXBwb3J0IGltcG9ydCBpc19pbnN0YW5jZSwgWCwgU29tZUNsYXNzCgpmcm9tIHVuaXR0ZXN0Lm1vY2sgaW1wb3J0ICgKICAgIE1vY2ssIE1hZ2ljTW9jaywgTm9uQ2FsbGFibGVNYWdpY01vY2ssCiAgICBOb25DYWxsYWJsZU1vY2ssIHBhdGNoLCBjcmVhdGVfYXV0b3NwZWMsCiAgICBDYWxsYWJsZU1peGluCikKCgoKY2xhc3MgVGVzdENhbGxhYmxlKHVuaXR0ZXN0LlRlc3RDYXNlKToKCiAgICBkZWYgYXNzZXJ0Tm90Q2FsbGFibGUoc2VsZiwgbW9jayk6CiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzX2luc3RhbmNlKG1vY2ssIE5vbkNhbGxhYmxlTWFnaWNNb2NrKSkKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKGlzX2luc3RhbmNlKG1vY2ssIENhbGxhYmxlTWl4aW4pKQoKCiAgICBkZWYgdGVzdF9ub25fY2FsbGFibGUoc2VsZik6CiAgICAgICAgZm9yIG1vY2sgaW4gTm9uQ2FsbGFibGVNYWdpY01vY2soKSwgTm9uQ2FsbGFibGVNb2NrKCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jaykKICAgICAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShoYXNhdHRyKG1vY2ssICdfX2NhbGxfXycpKQogICAgICAgICAgICBzZWxmLmFzc2VydEluKG1vY2suX19jbGFzc19fLl9fbmFtZV9fLCByZXByKG1vY2spKQoKCiAgICBkZWYgdGVzdF9oZWlyYXJjaHkoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzc3ViY2xhc3MoTWFnaWNNb2NrLCBNb2NrKSkKICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNzdWJjbGFzcyhOb25DYWxsYWJsZU1hZ2ljTW9jaywgTm9uQ2FsbGFibGVNb2NrKSkKCgogICAgZGVmIHRlc3RfYXR0cmlidXRlcyhzZWxmKToKICAgICAgICBvbmUgPSBOb25DYWxsYWJsZU1vY2soKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShpc3N1YmNsYXNzKHR5cGUob25lLm9uZSksIE1vY2spKQoKICAgICAgICB0d28gPSBOb25DYWxsYWJsZU1hZ2ljTW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzc3ViY2xhc3ModHlwZSh0d28udHdvKSwgTWFnaWNNb2NrKSkKCgogICAgZGVmIHRlc3Rfc3ViY2xhc3NlcyhzZWxmKToKICAgICAgICBjbGFzcyBNb2NrU3ViKE1vY2spOgogICAgICAgICAgICBwYXNzCgogICAgICAgIG9uZSA9IE1vY2tTdWIoKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShpc3N1YmNsYXNzKHR5cGUob25lLm9uZSksIE1vY2tTdWIpKQoKICAgICAgICBjbGFzcyBNYWdpY1N1YihNYWdpY01vY2spOgogICAgICAgICAgICBwYXNzCgogICAgICAgIHR3byA9IE1hZ2ljU3ViKCkKICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNzdWJjbGFzcyh0eXBlKHR3by50d28pLCBNYWdpY1N1YikpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX3NwZWMoc2VsZik6CiAgICAgICAgcGF0Y2hlciA9IHBhdGNoKCclcy5YJyAlIF9fbmFtZV9fLCBzcGVjPVRydWUpCiAgICAgICAgbW9jayA9IHBhdGNoZXIuc3RhcnQoKQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChwYXRjaGVyLnN0b3ApCgogICAgICAgIGluc3RhbmNlID0gbW9jaygpCiAgICAgICAgbW9jay5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCgpCgogICAgICAgIHNlbGYuYXNzZXJ0Tm90Q2FsbGFibGUoaW5zdGFuY2UpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBpbnN0YW5jZSkKCgogICAgZGVmIHRlc3RfcGF0Y2hfc3BlY19zZXQoc2VsZik6CiAgICAgICAgcGF0Y2hlciA9IHBhdGNoKCclcy5YJyAlIF9fbmFtZV9fLCBzcGVjX3NldD1UcnVlKQogICAgICAgIG1vY2sgPSBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICBzZWxmLmFkZENsZWFudXAocGF0Y2hlci5zdG9wKQoKICAgICAgICBpbnN0YW5jZSA9IG1vY2soKQogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoKQoKICAgICAgICBzZWxmLmFzc2VydE5vdENhbGxhYmxlKGluc3RhbmNlKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgaW5zdGFuY2UpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX3NwZWNfaW5zdGFuY2Uoc2VsZik6CiAgICAgICAgcGF0Y2hlciA9IHBhdGNoKCclcy5YJyAlIF9fbmFtZV9fLCBzcGVjPVgoKSkKICAgICAgICBtb2NrID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHBhdGNoZXIuc3RvcCkKCiAgICAgICAgc2VsZi5hc3NlcnROb3RDYWxsYWJsZShtb2NrKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jaykKCgogICAgZGVmIHRlc3RfcGF0Y2hfc3BlY19zZXRfaW5zdGFuY2Uoc2VsZik6CiAgICAgICAgcGF0Y2hlciA9IHBhdGNoKCclcy5YJyAlIF9fbmFtZV9fLCBzcGVjX3NldD1YKCkpCiAgICAgICAgbW9jayA9IHBhdGNoZXIuc3RhcnQoKQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChwYXRjaGVyLnN0b3ApCgogICAgICAgIHNlbGYuYXNzZXJ0Tm90Q2FsbGFibGUobW9jaykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIG1vY2spCgoKICAgIGRlZiB0ZXN0X3BhdGNoX3NwZWNfY2FsbGFibGVfY2xhc3Moc2VsZik6CiAgICAgICAgY2xhc3MgQ2FsbGFibGVYKFgpOgogICAgICAgICAgICBkZWYgX19jYWxsX18oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIGNsYXNzIFN1YihDYWxsYWJsZVgpOgogICAgICAgICAgICBwYXNzCgogICAgICAgIGNsYXNzIE11bHRpKFNvbWVDbGFzcywgU3ViKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBmb3IgYXJnIGluICdzcGVjJywgJ3NwZWNfc2V0JzoKICAgICAgICAgICAgZm9yIEtsYXNzIGluIENhbGxhYmxlWCwgU3ViLCBNdWx0aToKICAgICAgICAgICAgICAgIHdpdGggcGF0Y2goJyVzLlgnICUgX19uYW1lX18sICoqe2FyZzogS2xhc3N9KSBhcyBtb2NrOgogICAgICAgICAgICAgICAgICAgIGluc3RhbmNlID0gbW9jaygpCiAgICAgICAgICAgICAgICAgICAgbW9jay5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCgpCgogICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShpc19pbnN0YW5jZShpbnN0YW5jZSwgTWFnaWNNb2NrKSkKICAgICAgICAgICAgICAgICAgICAjIGluaGVyaXRlZCBzcGVjCiAgICAgICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIGluc3RhbmNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmb29iYXJiYXonKQoKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBpbnN0YW5jZSgpCiAgICAgICAgICAgICAgICAgICAgIyBpbnN0YW5jZSBpcyBjYWxsYWJsZSwgcmVzdWx0IGhhcyBubyBzcGVjCiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UuYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoKQoKICAgICAgICAgICAgICAgICAgICByZXN1bHQoMywgMiwgMSkKICAgICAgICAgICAgICAgICAgICByZXN1bHQuYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoMywgMiwgMSkKICAgICAgICAgICAgICAgICAgICByZXN1bHQuZm9vKDMsIDIsIDEpCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmZvby5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCgzLCAyLCAxKQoKCiAgICBkZWYgdGVzdF9jcmVhdGVfYXV0b3BzZWMoc2VsZik6CiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhYKQogICAgICAgIGluc3RhbmNlID0gbW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBpbnN0YW5jZSkKCiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhYKCkpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrKQoKCiAgICBkZWYgdGVzdF9jcmVhdGVfYXV0b3NwZWNfaW5zdGFuY2Uoc2VsZik6CiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhTb21lQ2xhc3MsIGluc3RhbmNlPVRydWUpCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jaykKICAgICAgICBtb2NrLndpYmJsZSgpCiAgICAgICAgbW9jay53aWJibGUuYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoKQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIG1vY2sud2liYmxlLCAnc29tZScsICAnYXJncycpCg==',
'/Lib/unittest/test/testmock/testhelpers.py':'aW1wb3J0IHVuaXR0ZXN0Cgpmcm9tIHVuaXR0ZXN0Lm1vY2sgaW1wb3J0ICgKICAgIGNhbGwsIF9DYWxsLCBjcmVhdGVfYXV0b3NwZWMsIE1hZ2ljTW9jaywKICAgIE1vY2ssIEFOWSwgX0NhbGxMaXN0LCBwYXRjaCwgUHJvcGVydHlNb2NrCikKCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCgpjbGFzcyBTb21lQ2xhc3Mob2JqZWN0KToKICAgIGRlZiBvbmUoc2VsZiwgYSwgYik6CiAgICAgICAgcGFzcwogICAgZGVmIHR3byhzZWxmKToKICAgICAgICBwYXNzCiAgICBkZWYgdGhyZWUoc2VsZiwgYT1Ob25lKToKICAgICAgICBwYXNzCgoKCmNsYXNzIEFueVRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgoKICAgIGRlZiB0ZXN0X2FueShzZWxmKToKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEFOWSwgb2JqZWN0KCkpCgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrKEFOWSkKICAgICAgICBtb2NrLmFzc2VydF9jYWxsZWRfd2l0aChBTlkpCgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrKGZvbz1BTlkpCiAgICAgICAgbW9jay5hc3NlcnRfY2FsbGVkX3dpdGgoZm9vPUFOWSkKCiAgICBkZWYgdGVzdF9yZXByKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVwcihBTlkpLCAnPEFOWT4nKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKEFOWSksICc8QU5ZPicpCgoKICAgIGRlZiB0ZXN0X2FueV9hbmRfZGF0ZXRpbWUoc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2soZGF0ZXRpbWUubm93KCksIGZvbz1kYXRldGltZS5ub3coKSkKCiAgICAgICAgbW9jay5hc3NlcnRfY2FsbGVkX3dpdGgoQU5ZLCBmb289QU5ZKQoKCiAgICBkZWYgdGVzdF9hbnlfbW9ja19jYWxsc19jb21wYXJpc29uX29yZGVyKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBkID0gZGF0ZXRpbWUubm93KCkKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgZGVmIF9fZXFfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgZGVmIF9fbmVfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQoKICAgICAgICBmb3IgZCBpbiBkYXRldGltZS5ub3coKSwgRm9vKCk6CiAgICAgICAgICAgIG1vY2sucmVzZXRfbW9jaygpCgogICAgICAgICAgICBtb2NrKGQsIGZvbz1kLCBiYXI9ZCkKICAgICAgICAgICAgbW9jay5tZXRob2QoZCwgemluZ2E9ZCwgYWxwaGE9ZCkKICAgICAgICAgICAgbW9jaygpLm1ldGhvZChhMT1kLCB6OTk9ZCkKCiAgICAgICAgICAgIGV4cGVjdGVkID0gWwogICAgICAgICAgICAgICAgY2FsbChBTlksIGZvbz1BTlksIGJhcj1BTlkpLAogICAgICAgICAgICAgICAgY2FsbC5tZXRob2QoQU5ZLCB6aW5nYT1BTlksIGFscGhhPUFOWSksCiAgICAgICAgICAgICAgICBjYWxsKCksIGNhbGwoKS5tZXRob2QoYTE9QU5ZLCB6OTk9QU5ZKQogICAgICAgICAgICBdCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZXhwZWN0ZWQsIG1vY2subW9ja19jYWxscykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1vY2tfY2FsbHMsIGV4cGVjdGVkKQoKCgpjbGFzcyBDYWxsVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIHRlc3RfY2FsbF93aXRoX2NhbGwoc2VsZik6CiAgICAgICAga2FsbCA9IF9DYWxsKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGthbGwsIF9DYWxsKCkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoJycsKSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoKCksKSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoe30sKSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoJycsICgpKSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoJycsIHt9KSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoJycsICgpLCB7fSkpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoa2FsbCwgX0NhbGwoKCdmb28nLCkpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoa2FsbCwgX0NhbGwoKCdiYXInLCAoKSkpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoa2FsbCwgX0NhbGwoKCdiYXonLCB7fSkpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoa2FsbCwgX0NhbGwoKCdzcGFtJywgKCksIHt9KSkpCgogICAgICAgIGthbGwgPSBfQ2FsbCgoKDEsIDIsIDMpLCkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoKDEsIDIsIDMpLCkpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoa2FsbCwgX0NhbGwoKCcnLCAoMSwgMiwgMykpKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGthbGwsIF9DYWxsKCgoMSwgMiwgMyksIHt9KSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoJycsICgxLCAyLCAzKSwge30pKSkKCiAgICAgICAga2FsbCA9IF9DYWxsKCgoMSwgMiwgNCksKSkKICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKGthbGwsIF9DYWxsKCgnJywgKDEsIDIsIDMpKSkpCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChrYWxsLCBfQ2FsbCgoJycsICgxLCAyLCAzKSwge30pKSkKCiAgICAgICAga2FsbCA9IF9DYWxsKCgnZm9vJywgKDEsIDIsIDQpLCkpCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChrYWxsLCBfQ2FsbCgoJycsICgxLCAyLCA0KSkpKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoa2FsbCwgX0NhbGwoKCcnLCAoMSwgMiwgNCksIHt9KSkpCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChrYWxsLCBfQ2FsbCgoJ2JhcicsICgxLCAyLCA0KSkpKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoa2FsbCwgX0NhbGwoKCdiYXInLCAoMSwgMiwgNCksIHt9KSkpCgogICAgICAgIGthbGwgPSBfQ2FsbCgoeydhJzogM30sKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGthbGwsIF9DYWxsKCgnJywgKCksIHsnYSc6IDN9KSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoJycsIHsnYSc6IDN9KSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoKCksIHsnYSc6IDN9KSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoeydhJzogM30sKSkpCgoKICAgIGRlZiB0ZXN0X2VtcHR5X19DYWxsKHNlbGYpOgogICAgICAgIGFyZ3MgPSBfQ2FsbCgpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCAoJ2ZvbycsKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGFyZ3MsICgoKSwpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCdmb28nLCAoKSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCAoJ2ZvbycsKCksIHt9KSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGFyZ3MsICgnZm9vJywge30pKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKHt9LCkpCgoKICAgIGRlZiB0ZXN0X25hbWVkX2VtcHR5X2NhbGwoc2VsZik6CiAgICAgICAgYXJncyA9IF9DYWxsKCgnZm9vJywgKCksIHt9KSkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCAoJ2ZvbycsKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGFyZ3MsICgnZm9vJywgKCkpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCdmb28nLCgpLCB7fSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCAoJ2ZvbycsIHt9KSkKCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChhcmdzLCAoKCksKSkKICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKGFyZ3MsICgpKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoYXJncywgKHt9LCkpCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChhcmdzLCAoJ2JhcicsKSkKICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKGFyZ3MsICgnYmFyJywgKCkpKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoYXJncywgKCdiYXInLCB7fSkpCgoKICAgIGRlZiB0ZXN0X2NhbGxfd2l0aF9hcmdzKHNlbGYpOgogICAgICAgIGFyZ3MgPSBfQ2FsbCgoKDEsIDIsIDMpLCB7fSkpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCgxLCAyLCAzKSwpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCdmb28nLCAoMSwgMiwgMykpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCdmb28nLCAoMSwgMiwgMyksIHt9KSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGFyZ3MsICgoMSwgMiwgMyksIHt9KSkKCgogICAgZGVmIHRlc3RfbmFtZWRfY2FsbF93aXRoX2FyZ3Moc2VsZik6CiAgICAgICAgYXJncyA9IF9DYWxsKCgnZm9vJywgKDEsIDIsIDMpLCB7fSkpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCdmb28nLCAoMSwgMiwgMykpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCdmb28nLCAoMSwgMiwgMyksIHt9KSkKCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChhcmdzLCAoKDEsIDIsIDMpLCkpCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChhcmdzLCAoKDEsIDIsIDMpLCB7fSkpCgoKICAgIGRlZiB0ZXN0X2NhbGxfd2l0aF9rd2FyZ3Moc2VsZik6CiAgICAgICAgYXJncyA9IF9DYWxsKCgoKSwgZGljdChhPTMsIGI9NCkpKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGFyZ3MsIChkaWN0KGE9MywgYj00KSwpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCdmb28nLCBkaWN0KGE9MywgYj00KSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCAoJ2ZvbycsICgpLCBkaWN0KGE9MywgYj00KSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCAoKCksIGRpY3QoYT0zLCBiPTQpKSkKCgogICAgZGVmIHRlc3RfbmFtZWRfY2FsbF93aXRoX2t3YXJncyhzZWxmKToKICAgICAgICBhcmdzID0gX0NhbGwoKCdmb28nLCAoKSwgZGljdChhPTMsIGI9NCkpKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGFyZ3MsICgnZm9vJywgZGljdChhPTMsIGI9NCkpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCdmb28nLCAoKSwgZGljdChhPTMsIGI9NCkpKQoKICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKGFyZ3MsIChkaWN0KGE9MywgYj00KSwpKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoYXJncywgKCgpLCBkaWN0KGE9MywgYj00KSkpCgoKICAgIGRlZiB0ZXN0X2NhbGxfd2l0aF9hcmdzX2NhbGxfZW1wdHlfbmFtZShzZWxmKToKICAgICAgICBhcmdzID0gX0NhbGwoKCgxLCAyLCAzKSwge30pKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgY2FsbCgxLCAyLCAzKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNhbGwoMSwgMiwgMyksIGFyZ3MpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGNhbGwoMSwgMiwgMykgaW4gW2FyZ3NdKQoKCiAgICBkZWYgdGVzdF9jYWxsX25lKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoX0NhbGwoKCgxLCAyLCAzKSwpKSwgY2FsbCgxLCAyKSkKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKF9DYWxsKCgoMSwgMiwgMyksKSkgIT0gY2FsbCgxLCAyLCAzKSkKICAgICAgICBzZWxmLmFzc2VydFRydWUoX0NhbGwoKCgxLCAyKSwge30pKSAhPSBjYWxsKDEsIDIsIDMpKQoKCiAgICBkZWYgdGVzdF9jYWxsX25vbl90dXBsZXMoc2VsZik6CiAgICAgICAga2FsbCA9IF9DYWxsKCgoMSwgMiwgMyksKSkKICAgICAgICBmb3IgdmFsdWUgaW4gMSwgTm9uZSwgc2VsZiwgaW50OgogICAgICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKGthbGwsIHZhbHVlKQogICAgICAgICAgICBzZWxmLmFzc2VydEZhbHNlKGthbGwgPT0gdmFsdWUpCgoKICAgIGRlZiB0ZXN0X3JlcHIoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXByKF9DYWxsKCkpLCAnY2FsbCgpJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlcHIoX0NhbGwoKCdmb28nLCkpKSwgJ2NhbGwuZm9vKCknKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlcHIoX0NhbGwoKCgxLCAyLCAzKSwgeydhJzogJ2InfSkpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICJjYWxsKDEsIDIsIDMsIGE9J2InKSIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXByKF9DYWxsKCgnYmFyJywgKDEsIDIsIDMpLCB7J2EnOiAnYid9KSkpLAogICAgICAgICAgICAgICAgICAgICAgICAgImNhbGwuYmFyKDEsIDIsIDMsIGE9J2InKSIpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVwcihjYWxsKSwgJ2NhbGwnKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGNhbGwpLCAnY2FsbCcpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVwcihjYWxsKCkpLCAnY2FsbCgpJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlcHIoY2FsbCgxKSksICdjYWxsKDEpJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlcHIoY2FsbCh6ej0ndGhpbmcnKSksICJjYWxsKHp6PSd0aGluZycpIikKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXByKGNhbGwoKS5mb28pLCAnY2FsbCgpLmZvbycpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXByKGNhbGwoMSkuZm9vLmJhcihhPTMpLmJpbmcpLAogICAgICAgICAgICAgICAgICAgICAgICAgJ2NhbGwoKS5mb28uYmFyKCkuYmluZycpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgKICAgICAgICAgICAgcmVwcihjYWxsKCkuZm9vKDEsIDIsIGE9MykpLAogICAgICAgICAgICAiY2FsbCgpLmZvbygxLCAyLCBhPTMpIgogICAgICAgICkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlcHIoY2FsbCgpKCkpLCAiY2FsbCgpKCkiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVwcihjYWxsKDEpKDIpKSwgImNhbGwoKSgyKSIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgKICAgICAgICAgICAgcmVwcihjYWxsKCkoKS5iYXIoKS5iYXouYmVlcCgxKSksCiAgICAgICAgICAgICJjYWxsKCkoKS5iYXIoKS5iYXouYmVlcCgxKSIKICAgICAgICApCgoKICAgIGRlZiB0ZXN0X2NhbGwoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChjYWxsKCksICgnJywgKCksIHt9KSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNhbGwoJ2ZvbycsICdiYXInLCBvbmU9MywgdHdvPTQpLAogICAgICAgICAgICAgICAgICAgICAgICAgKCcnLCAoJ2ZvbycsICdiYXInKSwgeydvbmUnOiAzLCAndHdvJzogNH0pKQoKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgbW9jaygxLCAyLCAzKQogICAgICAgIG1vY2soYT0zLCBiPTYpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmNhbGxfYXJnc19saXN0LAogICAgICAgICAgICAgICAgICAgICAgICAgW2NhbGwoMSwgMiwgMyksIGNhbGwoYT0zLCBiPTYpXSkKCiAgICBkZWYgdGVzdF9hdHRyaWJ1dGVfY2FsbChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNhbGwuZm9vKDEpLCAoJ2ZvbycsICgxLCksIHt9KSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNhbGwuYmFyLmJheihmaXNoPSdlZ2dzJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAoJ2Jhci5iYXonLCAoKSwgeydmaXNoJzogJ2VnZ3MnfSkpCgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrLmZvbygxLCAyICwzKQogICAgICAgIG1vY2suYmFyLmJheihhPTMsIGI9NikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subWV0aG9kX2NhbGxzLAogICAgICAgICAgICAgICAgICAgICAgICAgW2NhbGwuZm9vKDEsIDIsIDMpLCBjYWxsLmJhci5iYXooYT0zLCBiPTYpXSkKCgogICAgZGVmIHRlc3RfZXh0ZW5kZWRfY2FsbChzZWxmKToKICAgICAgICByZXN1bHQgPSBjYWxsKDEpLmZvbygyKS5iYXIoMywgYT00KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LCAoJygpLmZvbygpLmJhcicsICgzLCksIGRpY3QoYT00KSkpCgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgIG1vY2soMSwgMiwgYT0zLCBiPTQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmNhbGxfYXJncywgY2FsbCgxLCAyLCBhPTMsIGI9NCkpCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChtb2NrLmNhbGxfYXJncywgY2FsbCgxLCAyLCAzKSkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmNhbGxfYXJnc19saXN0LCBbY2FsbCgxLCAyLCBhPTMsIGI9NCldKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tb2NrX2NhbGxzLCBbY2FsbCgxLCAyLCBhPTMsIGI9NCldKQoKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKICAgICAgICBtb2NrLmZvbygxKS5iYXIoKSgpLmJhei5iZWVwKGE9NikKCiAgICAgICAgbGFzdF9jYWxsID0gY2FsbC5mb28oMSkuYmFyKCkoKS5iYXouYmVlcChhPTYpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1vY2tfY2FsbHNbLTFdLCBsYXN0X2NhbGwpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1vY2tfY2FsbHMsIGxhc3RfY2FsbC5jYWxsX2xpc3QoKSkKCgogICAgZGVmIHRlc3RfY2FsbF9saXN0KHNlbGYpOgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgIG1vY2soMSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNhbGwoMSkuY2FsbF9saXN0KCksIG1vY2subW9ja19jYWxscykKCiAgICAgICAgbW9jayA9IE1hZ2ljTW9jaygpCiAgICAgICAgbW9jaygxKS5tZXRob2QoMikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNhbGwoMSkubWV0aG9kKDIpLmNhbGxfbGlzdCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgbW9jay5tb2NrX2NhbGxzKQoKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKICAgICAgICBtb2NrKDEpLm1ldGhvZCgyKSgzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoY2FsbCgxKS5tZXRob2QoMikoMykuY2FsbF9saXN0KCksCiAgICAgICAgICAgICAgICAgICAgICAgICBtb2NrLm1vY2tfY2FsbHMpCgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgIGludChtb2NrKDEpLm1ldGhvZCgyKSgzKS5mb28uYmFyLmJheig0KSg1KSkKICAgICAgICBrYWxsID0gY2FsbCgxKS5tZXRob2QoMikoMykuZm9vLmJhci5iYXooNCkoNSkuX19pbnRfXygpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLmNhbGxfbGlzdCgpLCBtb2NrLm1vY2tfY2FsbHMpCgoKICAgIGRlZiB0ZXN0X2NhbGxfYW55KHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoY2FsbCwgQU5ZKQoKICAgICAgICBtID0gTWFnaWNNb2NrKCkKICAgICAgICBpbnQobSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0ubW9ja19jYWxscywgW0FOWV0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChbQU5ZXSwgbS5tb2NrX2NhbGxzKQoKCiAgICBkZWYgdGVzdF90d29fYXJnc19jYWxsKHNlbGYpOgogICAgICAgIGFyZ3MgPSBfQ2FsbCgoKDEsIDIpLCB7J2EnOiAzfSksIHR3bz1UcnVlKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKGFyZ3MpLCAyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJnc1swXSwgKDEsIDIpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJnc1sxXSwgeydhJzogM30pCgogICAgICAgIG90aGVyX2FyZ3MgPSBfQ2FsbCgoKDEsIDIpLCB7J2EnOiAzfSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCBvdGhlcl9hcmdzKQoKCmNsYXNzIFNwZWNTaWduYXR1cmVUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKCiAgICBkZWYgX2NoZWNrX3NvbWVjbGFzc19tb2NrKHNlbGYsIG1vY2spOgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBnZXRhdHRyLCBtb2NrLCAnZm9vJykKICAgICAgICBtb2NrLm9uZSgxLCAyKQogICAgICAgIG1vY2sub25lLmFzc2VydF9jYWxsZWRfd2l0aCgxLCAyKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEFzc2VydGlvbkVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1vY2sub25lLmFzc2VydF9jYWxsZWRfd2l0aCwgMywgNCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIG1vY2sub25lLCAxKQoKICAgICAgICBtb2NrLnR3bygpCiAgICAgICAgbW9jay50d28uYXNzZXJ0X2NhbGxlZF93aXRoKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBc3NlcnRpb25FcnJvciwKICAgICAgICAgICAgICAgICAgICAgICAgICBtb2NrLnR3by5hc3NlcnRfY2FsbGVkX3dpdGgsIDMpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrLnR3bywgMSkKCiAgICAgICAgbW9jay50aHJlZSgpCiAgICAgICAgbW9jay50aHJlZS5hc3NlcnRfY2FsbGVkX3dpdGgoKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEFzc2VydGlvbkVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1vY2sudGhyZWUuYXNzZXJ0X2NhbGxlZF93aXRoLCAzKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jay50aHJlZSwgMywgMikKCiAgICAgICAgbW9jay50aHJlZSgxKQogICAgICAgIG1vY2sudGhyZWUuYXNzZXJ0X2NhbGxlZF93aXRoKDEpCgogICAgICAgIG1vY2sudGhyZWUoYT0xKQogICAgICAgIG1vY2sudGhyZWUuYXNzZXJ0X2NhbGxlZF93aXRoKGE9MSkKCgogICAgZGVmIHRlc3RfYmFzaWMoc2VsZik6CiAgICAgICAgZm9yIHNwZWMgaW4gKFNvbWVDbGFzcywgU29tZUNsYXNzKCkpOgogICAgICAgICAgICBtb2NrID0gY3JlYXRlX2F1dG9zcGVjKHNwZWMpCiAgICAgICAgICAgIHNlbGYuX2NoZWNrX3NvbWVjbGFzc19tb2NrKG1vY2spCgoKICAgIGRlZiB0ZXN0X2NyZWF0ZV9hdXRvc3BlY19yZXR1cm5fdmFsdWUoc2VsZik6CiAgICAgICAgZGVmIGYoKToKICAgICAgICAgICAgcGFzcwogICAgICAgIG1vY2sgPSBjcmVhdGVfYXV0b3NwZWMoZiwgcmV0dXJuX3ZhbHVlPSdmb28nKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jaygpLCAnZm9vJykKCiAgICAgICAgY2xhc3MgRm9vKG9iamVjdCk6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhGb28sIHJldHVybl92YWx1ZT0nZm9vJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2soKSwgJ2ZvbycpCgoKICAgIGRlZiB0ZXN0X2F1dG9zcGVjX3Jlc2V0X21vY2soc2VsZik6CiAgICAgICAgbSA9IGNyZWF0ZV9hdXRvc3BlYyhpbnQpCiAgICAgICAgaW50KG0pCiAgICAgICAgbS5yZXNldF9tb2NrKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0uX19pbnRfXy5jYWxsX2NvdW50LCAwKQoKCiAgICBkZWYgdGVzdF9tb2NraW5nX3VuYm91bmRfbWV0aG9kcyhzZWxmKToKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgZGVmIGZvbyhzZWxmLCBmb28pOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIHAgPSBwYXRjaC5vYmplY3QoRm9vLCAnZm9vJykKICAgICAgICBtb2NrX2ZvbyA9IHAuc3RhcnQoKQogICAgICAgIEZvbygpLmZvbygxKQoKICAgICAgICBtb2NrX2Zvby5hc3NlcnRfY2FsbGVkX3dpdGgoMSkKCgogICAgZGVmIHRlc3RfY3JlYXRlX2F1dG9zcGVjX3VuYm91bmRfbWV0aG9kcyhzZWxmKToKICAgICAgICAjIHNlZSBtb2NrIGlzc3VlIDEyOAogICAgICAgICMgdGhpcyBpcyBleHBlY3RlZCB0byBmYWlsIHVudGlsIHRoZSBpc3N1ZSBpcyBmaXhlZAogICAgICAgIHJldHVybgogICAgICAgIGNsYXNzIEZvbyhvYmplY3QpOgogICAgICAgICAgICBkZWYgZm9vKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBrbGFzcyA9IGNyZWF0ZV9hdXRvc3BlYyhGb28pCiAgICAgICAgaW5zdGFuY2UgPSBrbGFzcygpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBpbnN0YW5jZS5mb28sIDEpCgogICAgICAgICMgTm90ZTogbm8gdHlwZSBjaGVja2luZyBvbiB0aGUgInNlbGYiIHBhcmFtZXRlcgogICAgICAgIGtsYXNzLmZvbygxKQogICAgICAgIGtsYXNzLmZvby5hc3NlcnRfY2FsbGVkX3dpdGgoMSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGtsYXNzLmZvbykKCgogICAgZGVmIHRlc3RfY3JlYXRlX2F1dG9zcGVjX2tleXdvcmRfYXJndW1lbnRzKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyhvYmplY3QpOgogICAgICAgICAgICBhID0gMwogICAgICAgIG0gPSBjcmVhdGVfYXV0b3NwZWMoRm9vLCBhPSczJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0uYSwgJzMnKQoKCiAgICBkZWYgdGVzdF9jcmVhdGVfYXV0b3NwZWNfa2V5d29yZF9vbmx5X2FyZ3VtZW50cyhzZWxmKToKICAgICAgICBkZWYgZm9vKGEsICosIGI9Tm9uZSk6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgbSA9IGNyZWF0ZV9hdXRvc3BlYyhmb28pCiAgICAgICAgbSgxKQogICAgICAgIG0uYXNzZXJ0X2NhbGxlZF93aXRoKDEpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtLCAxLCAyKQoKICAgICAgICBtKDIsIGI9MykKICAgICAgICBtLmFzc2VydF9jYWxsZWRfd2l0aCgyLCBiPTMpCgoKICAgIGRlZiB0ZXN0X2Z1bmN0aW9uX2FzX2luc3RhbmNlX2F0dHJpYnV0ZShzZWxmKToKICAgICAgICBvYmogPSBTb21lQ2xhc3MoKQogICAgICAgIGRlZiBmKGEpOgogICAgICAgICAgICBwYXNzCiAgICAgICAgb2JqLmYgPSBmCgogICAgICAgIG1vY2sgPSBjcmVhdGVfYXV0b3NwZWMob2JqKQogICAgICAgIG1vY2suZignYmluZycpCiAgICAgICAgbW9jay5mLmFzc2VydF9jYWxsZWRfd2l0aCgnYmluZycpCgoKICAgIGRlZiB0ZXN0X3NwZWNfYXNfbGlzdChzZWxmKToKICAgICAgICAjIGJlY2F1c2Ugc3BlYyBhcyBhIGxpc3Qgb2Ygc3RyaW5ncyBpbiB0aGUgbW9jayBjb25zdHJ1Y3RvciBtZWFucwogICAgICAgICMgc29tZXRoaW5nIHZlcnkgZGlmZmVyZW50IHdlIHRyZWF0IGEgbGlzdCBpbnN0YW5jZSBhcyB0aGUgdHlwZS4KICAgICAgICBtb2NrID0gY3JlYXRlX2F1dG9zcGVjKFtdKQogICAgICAgIG1vY2suYXBwZW5kKCdmb28nKQogICAgICAgIG1vY2suYXBwZW5kLmFzc2VydF9jYWxsZWRfd2l0aCgnZm9vJykKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIG1vY2ssICdmb28nKQoKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgZm9vID0gW10KCiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhGb28pCiAgICAgICAgbW9jay5mb28uYXBwZW5kKDMpCiAgICAgICAgbW9jay5mb28uYXBwZW5kLmFzc2VydF9jYWxsZWRfd2l0aCgzKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBnZXRhdHRyLCBtb2NrLmZvbywgJ2ZvbycpCgoKICAgIGRlZiB0ZXN0X2F0dHJpYnV0ZXMoc2VsZik6CiAgICAgICAgY2xhc3MgU3ViKFNvbWVDbGFzcyk6CiAgICAgICAgICAgIGF0dHIgPSBTb21lQ2xhc3MoKQoKICAgICAgICBzdWJfbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhTdWIpCgogICAgICAgIGZvciBtb2NrIGluIChzdWJfbW9jaywgc3ViX21vY2suYXR0cik6CiAgICAgICAgICAgIHNlbGYuX2NoZWNrX3NvbWVjbGFzc19tb2NrKG1vY2spCgoKICAgIGRlZiB0ZXN0X2J1aWx0aW5fZnVuY3Rpb25zX3R5cGVzKHNlbGYpOgogICAgICAgICMgd2UgY291bGQgcmVwbGFjZSBidWlsdGluIGZ1bmN0aW9ucyAvIG1ldGhvZHMgd2l0aCBhIGZ1bmN0aW9uCiAgICAgICAgIyB3aXRoICphcmdzIC8gKiprd2FyZ3Mgc2lnbmF0dXJlLiBVc2luZyB0aGUgYnVpbHRpbiBtZXRob2QgdHlwZQogICAgICAgICMgYXMgYSBzcGVjIHNlZW1zIHRvIHdvcmsgZmFpcmx5IHdlbGwgdGhvdWdoLgogICAgICAgIGNsYXNzIEJ1aWx0aW5TdWJjbGFzcyhsaXN0KToKICAgICAgICAgICAgZGVmIGJhcihzZWxmLCBhcmcpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBzb3J0ZWQgPSBzb3J0ZWQKICAgICAgICAgICAgYXR0ciA9IHt9CgogICAgICAgIG1vY2sgPSBjcmVhdGVfYXV0b3NwZWMoQnVpbHRpblN1YmNsYXNzKQogICAgICAgIG1vY2suYXBwZW5kKDMpCiAgICAgICAgbW9jay5hcHBlbmQuYXNzZXJ0X2NhbGxlZF93aXRoKDMpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIG1vY2suYXBwZW5kLCAnZm9vJykKCiAgICAgICAgbW9jay5iYXIoJ2ZvbycpCiAgICAgICAgbW9jay5iYXIuYXNzZXJ0X2NhbGxlZF93aXRoKCdmb28nKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jay5iYXIsICdmb28nLCAnYmFyJykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgbW9jay5iYXIsICdmb28nKQoKICAgICAgICBtb2NrLnNvcnRlZChbMSwgMl0pCiAgICAgICAgbW9jay5zb3J0ZWQuYXNzZXJ0X2NhbGxlZF93aXRoKFsxLCAyXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgbW9jay5zb3J0ZWQsICdmb28nKQoKICAgICAgICBtb2NrLmF0dHIucG9wKDMpCiAgICAgICAgbW9jay5hdHRyLnBvcC5hc3NlcnRfY2FsbGVkX3dpdGgoMykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgbW9jay5hdHRyLCAnZm9vJykKCgogICAgZGVmIHRlc3RfbWV0aG9kX2NhbGxzKHNlbGYpOgogICAgICAgIGNsYXNzIFN1YihTb21lQ2xhc3MpOgogICAgICAgICAgICBhdHRyID0gU29tZUNsYXNzKCkKCiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhTdWIpCiAgICAgICAgbW9jay5vbmUoMSwgMikKICAgICAgICBtb2NrLnR3bygpCiAgICAgICAgbW9jay50aHJlZSgzKQoKICAgICAgICBleHBlY3RlZCA9IFtjYWxsLm9uZSgxLCAyKSwgY2FsbC50d28oKSwgY2FsbC50aHJlZSgzKV0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subWV0aG9kX2NhbGxzLCBleHBlY3RlZCkKCiAgICAgICAgbW9jay5hdHRyLm9uZSgxLCAyKQogICAgICAgIG1vY2suYXR0ci50d28oKQogICAgICAgIG1vY2suYXR0ci50aHJlZSgzKQoKICAgICAgICBleHBlY3RlZC5leHRlbmQoCiAgICAgICAgICAgIFtjYWxsLmF0dHIub25lKDEsIDIpLCBjYWxsLmF0dHIudHdvKCksIGNhbGwuYXR0ci50aHJlZSgzKV0KICAgICAgICApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1ldGhvZF9jYWxscywgZXhwZWN0ZWQpCgoKICAgIGRlZiB0ZXN0X21hZ2ljX21ldGhvZHMoc2VsZik6CiAgICAgICAgY2xhc3MgQnVpbHRpblN1YmNsYXNzKGxpc3QpOgogICAgICAgICAgICBhdHRyID0ge30KCiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhCdWlsdGluU3ViY2xhc3MpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KG1vY2spLCBbXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGludCwgbW9jaykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGludCwgbW9jay5hdHRyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChtb2NrKSwgW10pCgogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrWydmb28nXSwgTWFnaWNNb2NrKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrLmF0dHJbJ2ZvbyddLCBNYWdpY01vY2spCgoKICAgIGRlZiB0ZXN0X3NwZWNfc2V0KHNlbGYpOgogICAgICAgIGNsYXNzIFN1YihTb21lQ2xhc3MpOgogICAgICAgICAgICBhdHRyID0gU29tZUNsYXNzKCkKCiAgICAgICAgZm9yIHNwZWMgaW4gKFN1YiwgU3ViKCkpOgogICAgICAgICAgICBtb2NrID0gY3JlYXRlX2F1dG9zcGVjKHNwZWMsIHNwZWNfc2V0PVRydWUpCiAgICAgICAgICAgIHNlbGYuX2NoZWNrX3NvbWVjbGFzc19tb2NrKG1vY2spCgogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgc2V0YXR0ciwgbW9jaywgJ2ZvbycsICdiYXInKQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgc2V0YXR0ciwgbW9jay5hdHRyLCAnZm9vJywgJ2JhcicpCgoKICAgIGRlZiB0ZXN0X2Rlc2NyaXB0b3JzKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyhvYmplY3QpOgogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIGYoY2xzLCBhLCBiKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgQHN0YXRpY21ldGhvZAogICAgICAgICAgICBkZWYgZyhhLCBiKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgY2xhc3MgQmFyKEZvbyk6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgY2xhc3MgQmF6KFNvbWVDbGFzcywgQmFyKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBmb3Igc3BlYyBpbiAoRm9vLCBGb28oKSwgQmFyLCBCYXIoKSwgQmF6LCBCYXooKSk6CiAgICAgICAgICAgIG1vY2sgPSBjcmVhdGVfYXV0b3NwZWMoc3BlYykKICAgICAgICAgICAgbW9jay5mKDEsIDIpCiAgICAgICAgICAgIG1vY2suZi5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCgxLCAyKQoKICAgICAgICAgICAgbW9jay5nKDMsIDQpCiAgICAgICAgICAgIG1vY2suZy5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCgzLCA0KQoKCiAgICBkZWYgdGVzdF9yZWN1cnNpdmUoc2VsZik6CiAgICAgICAgY2xhc3MgQShvYmplY3QpOgogICAgICAgICAgICBkZWYgYShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZm9vID0gJ2ZvbyBiYXIgYmF6JwogICAgICAgICAgICBiYXIgPSBmb28KCiAgICAgICAgQS5CID0gQQogICAgICAgIG1vY2sgPSBjcmVhdGVfYXV0b3NwZWMoQSkKCiAgICAgICAgbW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShtb2NrLkIuY2FsbGVkKQoKICAgICAgICBtb2NrLmEoKQogICAgICAgIG1vY2suQi5hKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subWV0aG9kX2NhbGxzLCBbY2FsbC5hKCksIGNhbGwuQi5hKCldKQoKICAgICAgICBzZWxmLmFzc2VydElzKEEuZm9vLCBBLmJhcikKICAgICAgICBzZWxmLmFzc2VydElzTm90KG1vY2suZm9vLCBtb2NrLmJhcikKICAgICAgICBtb2NrLmZvby5sb3dlcigpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXNzZXJ0aW9uRXJyb3IsIG1vY2suYmFyLmxvd2VyLmFzc2VydF9jYWxsZWRfd2l0aCkKCgogICAgZGVmIHRlc3Rfc3BlY19pbmhlcml0YW5jZV9mb3JfY2xhc3NlcyhzZWxmKToKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgZGVmIGEoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGNsYXNzIEJhcihvYmplY3QpOgogICAgICAgICAgICAgICAgZGVmIGYoc2VsZik6CiAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBjbGFzc19tb2NrID0gY3JlYXRlX2F1dG9zcGVjKEZvbykKCiAgICAgICAgc2VsZi5hc3NlcnRJc05vdChjbGFzc19tb2NrLCBjbGFzc19tb2NrKCkpCgogICAgICAgIGZvciB0aGlzX21vY2sgaW4gY2xhc3NfbW9jaywgY2xhc3NfbW9jaygpOgogICAgICAgICAgICB0aGlzX21vY2suYSgpCiAgICAgICAgICAgIHRoaXNfbW9jay5hLmFzc2VydF9jYWxsZWRfd2l0aCgpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgdGhpc19tb2NrLmEsICdmb28nKQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgdGhpc19tb2NrLCAnYicpCgogICAgICAgIGluc3RhbmNlX21vY2sgPSBjcmVhdGVfYXV0b3NwZWMoRm9vKCkpCiAgICAgICAgaW5zdGFuY2VfbW9jay5hKCkKICAgICAgICBpbnN0YW5jZV9tb2NrLmEuYXNzZXJ0X2NhbGxlZF93aXRoKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGluc3RhbmNlX21vY2suYSwgJ2ZvbycpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIGluc3RhbmNlX21vY2ssICdiJykKCiAgICAgICAgIyBUaGUgcmV0dXJuIHZhbHVlIGlzbid0IGlzbid0IGNhbGxhYmxlCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBpbnN0YW5jZV9tb2NrKQoKICAgICAgICBpbnN0YW5jZV9tb2NrLkJhci5mKCkKICAgICAgICBpbnN0YW5jZV9tb2NrLkJhci5mLmFzc2VydF9jYWxsZWRfd2l0aCgpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIGluc3RhbmNlX21vY2suQmFyLCAnZycpCgogICAgICAgIGluc3RhbmNlX21vY2suQmFyKCkuZigpCiAgICAgICAgaW5zdGFuY2VfbW9jay5CYXIoKS5mLmFzc2VydF9jYWxsZWRfd2l0aCgpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIGluc3RhbmNlX21vY2suQmFyKCksICdnJykKCgogICAgZGVmIHRlc3RfaW5oZXJpdChzZWxmKToKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgYSA9IDMKCiAgICAgICAgRm9vLkZvbyA9IEZvbwoKICAgICAgICAjIGNsYXNzCiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhGb28pCiAgICAgICAgaW5zdGFuY2UgPSBtb2NrKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgaW5zdGFuY2UsICdiJykKCiAgICAgICAgYXR0cl9pbnN0YW5jZSA9IG1vY2suRm9vKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgYXR0cl9pbnN0YW5jZSwgJ2InKQoKICAgICAgICAjIGluc3RhbmNlCiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhGb28oKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgbW9jaywgJ2InKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jaykKCiAgICAgICAgIyBhdHRyaWJ1dGUgaW5zdGFuY2UKICAgICAgICBjYWxsX3Jlc3VsdCA9IG1vY2suRm9vKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgY2FsbF9yZXN1bHQsICdiJykKCgogICAgZGVmIHRlc3RfYnVpbHRpbnMoc2VsZik6CiAgICAgICAgIyB1c2VkIHRvIGZhaWwgd2l0aCBpbmZpbml0ZSByZWN1cnNpb24KICAgICAgICBjcmVhdGVfYXV0b3NwZWMoMSkKCiAgICAgICAgY3JlYXRlX2F1dG9zcGVjKGludCkKICAgICAgICBjcmVhdGVfYXV0b3NwZWMoJ2ZvbycpCiAgICAgICAgY3JlYXRlX2F1dG9zcGVjKHN0cikKICAgICAgICBjcmVhdGVfYXV0b3NwZWMoe30pCiAgICAgICAgY3JlYXRlX2F1dG9zcGVjKGRpY3QpCiAgICAgICAgY3JlYXRlX2F1dG9zcGVjKFtdKQogICAgICAgIGNyZWF0ZV9hdXRvc3BlYyhsaXN0KQogICAgICAgIGNyZWF0ZV9hdXRvc3BlYyhzZXQoKSkKICAgICAgICBjcmVhdGVfYXV0b3NwZWMoc2V0KQogICAgICAgIGNyZWF0ZV9hdXRvc3BlYygxLjApCiAgICAgICAgY3JlYXRlX2F1dG9zcGVjKGZsb2F0KQogICAgICAgIGNyZWF0ZV9hdXRvc3BlYygxaikKICAgICAgICBjcmVhdGVfYXV0b3NwZWMoY29tcGxleCkKICAgICAgICBjcmVhdGVfYXV0b3NwZWMoRmFsc2UpCiAgICAgICAgY3JlYXRlX2F1dG9zcGVjKFRydWUpCgoKICAgIGRlZiB0ZXN0X2Z1bmN0aW9uKHNlbGYpOgogICAgICAgIGRlZiBmKGEsIGIpOgogICAgICAgICAgICBwYXNzCgogICAgICAgIG1vY2sgPSBjcmVhdGVfYXV0b3NwZWMoZikKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIG1vY2spCiAgICAgICAgbW9jaygxLCAyKQogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF93aXRoKDEsIDIpCgogICAgICAgIGYuZiA9IGYKICAgICAgICBtb2NrID0gY3JlYXRlX2F1dG9zcGVjKGYpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrLmYpCiAgICAgICAgbW9jay5mKDMsIDQpCiAgICAgICAgbW9jay5mLmFzc2VydF9jYWxsZWRfd2l0aCgzLCA0KQoKCiAgICBkZWYgdGVzdF9za2lwX2F0dHJpYnV0ZWVycm9ycyhzZWxmKToKICAgICAgICBjbGFzcyBSYWlzZXIob2JqZWN0KToKICAgICAgICAgICAgZGVmIF9fZ2V0X18oc2VsZiwgb2JqLCB0eXBlPU5vbmUpOgogICAgICAgICAgICAgICAgaWYgb2JqIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgQXR0cmlidXRlRXJyb3IoJ0NhbiBvbmx5IGJlIGFjY2Vzc2VkIHZpYSBhbiBpbnN0YW5jZScpCgogICAgICAgIGNsYXNzIFJhaXNlckNsYXNzKG9iamVjdCk6CiAgICAgICAgICAgIHJhaXNlciA9IFJhaXNlcigpCgogICAgICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgICAgIGRlZiBleGlzdGluZyhhLCBiKToKICAgICAgICAgICAgICAgIHJldHVybiBhICsgYgoKICAgICAgICBzID0gY3JlYXRlX2F1dG9zcGVjKFJhaXNlckNsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhIHg6IHMuZXhpc3RpbmcoMSwgMiwgMykpCiAgICAgICAgcy5leGlzdGluZygxLCAyKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBsYW1iZGE6IHMubm9uZXhpc3RpbmcpCgogICAgICAgICMgY2hlY2sgd2UgY2FuIGZldGNoIHRoZSByYWlzZXIgYXR0cmlidXRlIGFuZCBpdCBoYXMgbm8gc3BlYwogICAgICAgIG9iaiA9IHMucmFpc2VyCiAgICAgICAgb2JqLmZvbywgb2JqLmJhcgoKCiAgICBkZWYgdGVzdF9zaWduYXR1cmVfY2xhc3Moc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKG9iamVjdCk6CiAgICAgICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBhLCBiPTMpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBtb2NrID0gY3JlYXRlX2F1dG9zcGVjKEZvbykKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrKQogICAgICAgIG1vY2soMSkKICAgICAgICBtb2NrLmFzc2VydF9jYWxsZWRfb25jZV93aXRoKDEpCgogICAgICAgIG1vY2soNCwgNSkKICAgICAgICBtb2NrLmFzc2VydF9jYWxsZWRfd2l0aCg0LCA1KQoKCiAgICBkZWYgdGVzdF9jbGFzc193aXRoX25vX2luaXQoc2VsZik6CiAgICAgICAgIyB0aGlzIHVzZWQgdG8gcmFpc2UgYW4gZXhjZXB0aW9uCiAgICAgICAgIyBkdWUgdG8gdHJ5aW5nIHRvIGdldCBhIHNpZ25hdHVyZSBmcm9tIG9iamVjdC5fX2luaXRfXwogICAgICAgIGNsYXNzIEZvbyhvYmplY3QpOgogICAgICAgICAgICBwYXNzCiAgICAgICAgY3JlYXRlX2F1dG9zcGVjKEZvbykKCgogICAgZGVmIHRlc3Rfc2lnbmF0dXJlX2NhbGxhYmxlKHNlbGYpOgogICAgICAgIGNsYXNzIENhbGxhYmxlKG9iamVjdCk6CiAgICAgICAgICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIF9fY2FsbF9fKHNlbGYsIGEpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBtb2NrID0gY3JlYXRlX2F1dG9zcGVjKENhbGxhYmxlKQogICAgICAgIG1vY2soKQogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jaywgJ2EnKQoKICAgICAgICBpbnN0YW5jZSA9IG1vY2soKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgaW5zdGFuY2UpCiAgICAgICAgaW5zdGFuY2UoYT0nYScpCiAgICAgICAgaW5zdGFuY2UuYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoYT0nYScpCiAgICAgICAgaW5zdGFuY2UoJ2EnKQogICAgICAgIGluc3RhbmNlLmFzc2VydF9jYWxsZWRfd2l0aCgnYScpCgogICAgICAgIG1vY2sgPSBjcmVhdGVfYXV0b3NwZWMoQ2FsbGFibGUoKSkKICAgICAgICBtb2NrKGE9J2EnKQogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoYT0nYScpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrKQogICAgICAgIG1vY2soJ2EnKQogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF93aXRoKCdhJykKCgogICAgZGVmIHRlc3Rfc2lnbmF0dXJlX25vbmNhbGxhYmxlKHNlbGYpOgogICAgICAgIGNsYXNzIE5vbkNhbGxhYmxlKG9iamVjdCk6CiAgICAgICAgICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhOb25DYWxsYWJsZSkKICAgICAgICBpbnN0YW5jZSA9IG1vY2soKQogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jaywgJ2EnKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgaW5zdGFuY2UpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBpbnN0YW5jZSwgJ2EnKQoKICAgICAgICBtb2NrID0gY3JlYXRlX2F1dG9zcGVjKE5vbkNhbGxhYmxlKCkpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jaywgJ2EnKQoKCiAgICBkZWYgdGVzdF9jcmVhdGVfYXV0b3NwZWNfbm9uZShzZWxmKToKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgYmFyID0gTm9uZQoKICAgICAgICBtb2NrID0gY3JlYXRlX2F1dG9zcGVjKEZvbykKICAgICAgICBub25lID0gbW9jay5iYXIKICAgICAgICBzZWxmLmFzc2VydE5vdElzSW5zdGFuY2Uobm9uZSwgdHlwZShOb25lKSkKCiAgICAgICAgbm9uZS5mb28oKQogICAgICAgIG5vbmUuZm9vLmFzc2VydF9jYWxsZWRfb25jZV93aXRoKCkKCgogICAgZGVmIHRlc3RfYXV0b3NwZWNfZnVuY3Rpb25zX3dpdGhfc2VsZl9pbl9vZGRfcGxhY2Uoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKG9iamVjdCk6CiAgICAgICAgICAgIGRlZiBmKGEsIHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBhID0gY3JlYXRlX2F1dG9zcGVjKEZvbykKICAgICAgICBhLmYoc2VsZj0xMCkKICAgICAgICBhLmYuYXNzZXJ0X2NhbGxlZF93aXRoKHNlbGY9MTApCgoKICAgIGRlZiB0ZXN0X2F1dG9zcGVjX3Byb3BlcnR5KHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyhvYmplY3QpOgogICAgICAgICAgICBAcHJvcGVydHkKICAgICAgICAgICAgZGVmIGZvbyhzZWxmKToKICAgICAgICAgICAgICAgIHJldHVybiAzCgogICAgICAgIGZvbyA9IGNyZWF0ZV9hdXRvc3BlYyhGb28pCiAgICAgICAgbW9ja19wcm9wZXJ0eSA9IGZvby5mb28KCiAgICAgICAgIyBubyBzcGVjIG9uIHByb3BlcnRpZXMKICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNpbnN0YW5jZShtb2NrX3Byb3BlcnR5LCBNYWdpY01vY2spKQogICAgICAgIG1vY2tfcHJvcGVydHkoMSwgMiwgMykKICAgICAgICBtb2NrX3Byb3BlcnR5LmFiYyg0LCA1LCA2KQogICAgICAgIG1vY2tfcHJvcGVydHkuYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoMSwgMiwgMykKICAgICAgICBtb2NrX3Byb3BlcnR5LmFiYy5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCg0LCA1LCA2KQoKCiAgICBkZWYgdGVzdF9hdXRvc3BlY19zbG90cyhzZWxmKToKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgX19zbG90c19fID0gWydhJ10KCiAgICAgICAgZm9vID0gY3JlYXRlX2F1dG9zcGVjKEZvbykKICAgICAgICBtb2NrX3Nsb3QgPSBmb28uYQoKICAgICAgICAjIG5vIHNwZWMgb24gc2xvdHMKICAgICAgICBtb2NrX3Nsb3QoMSwgMiwgMykKICAgICAgICBtb2NrX3Nsb3QuYWJjKDQsIDUsIDYpCiAgICAgICAgbW9ja19zbG90LmFzc2VydF9jYWxsZWRfb25jZV93aXRoKDEsIDIsIDMpCiAgICAgICAgbW9ja19zbG90LmFiYy5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCg0LCA1LCA2KQoKCmNsYXNzIFRlc3RDYWxsTGlzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIHRlc3RfYXJnc19saXN0X2NvbnRhaW5zX2NhbGxfbGlzdChzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKG1vY2suY2FsbF9hcmdzX2xpc3QsIF9DYWxsTGlzdCkKCiAgICAgICAgbW9jaygxLCAyKQogICAgICAgIG1vY2soYT0zKQogICAgICAgIG1vY2soMywgNCkKICAgICAgICBtb2NrKGI9NikKCiAgICAgICAgZm9yIGthbGwgaW4gY2FsbCgxLCAyKSwgY2FsbChhPTMpLCBjYWxsKDMsIDQpLCBjYWxsKGI9Nik6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShrYWxsIGluIG1vY2suY2FsbF9hcmdzX2xpc3QpCgogICAgICAgIGNhbGxzID0gW2NhbGwoYT0zKSwgY2FsbCgzLCA0KV0KICAgICAgICBzZWxmLmFzc2VydFRydWUoY2FsbHMgaW4gbW9jay5jYWxsX2FyZ3NfbGlzdCkKICAgICAgICBjYWxscyA9IFtjYWxsKDEsIDIpLCBjYWxsKGE9MyldCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGNhbGxzIGluIG1vY2suY2FsbF9hcmdzX2xpc3QpCiAgICAgICAgY2FsbHMgPSBbY2FsbCgzLCA0KSwgY2FsbChiPTYpXQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShjYWxscyBpbiBtb2NrLmNhbGxfYXJnc19saXN0KQogICAgICAgIGNhbGxzID0gW2NhbGwoMywgNCldCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGNhbGxzIGluIG1vY2suY2FsbF9hcmdzX2xpc3QpCgogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoY2FsbCgnZmlzaCcpIGluIG1vY2suY2FsbF9hcmdzX2xpc3QpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShbY2FsbCgnZmlzaCcpXSBpbiBtb2NrLmNhbGxfYXJnc19saXN0KQoKCiAgICBkZWYgdGVzdF9jYWxsX2xpc3Rfc3RyKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrKDEsIDIpCiAgICAgICAgbW9jay5mb28oYT0zKQogICAgICAgIG1vY2suZm9vLmJhcigpLmJheignZmlzaCcsIGNhdD0nZG9nJykKCiAgICAgICAgZXhwZWN0ZWQgPSAoCiAgICAgICAgICAgICJbY2FsbCgxLCAyKSxcbiIKICAgICAgICAgICAgIiBjYWxsLmZvbyhhPTMpLFxuIgogICAgICAgICAgICAiIGNhbGwuZm9vLmJhcigpLFxuIgogICAgICAgICAgICAiIGNhbGwuZm9vLmJhcigpLmJheignZmlzaCcsIGNhdD0nZG9nJyldIgogICAgICAgICkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN0cihtb2NrLm1vY2tfY2FsbHMpLCBleHBlY3RlZCkKCgogICAgZGVmIHRlc3RfcHJvcGVydHltb2NrKHNlbGYpOgogICAgICAgIHAgPSBwYXRjaCgnJXMuU29tZUNsYXNzLm9uZScgJSBfX25hbWVfXywgbmV3X2NhbGxhYmxlPVByb3BlcnR5TW9jaykKICAgICAgICBtb2NrID0gcC5zdGFydCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBTb21lQ2xhc3Mub25lCiAgICAgICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoKQoKICAgICAgICAgICAgcyA9IFNvbWVDbGFzcygpCiAgICAgICAgICAgIHMub25lCiAgICAgICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF93aXRoKCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1vY2tfY2FsbHMsIFtjYWxsKCksIGNhbGwoKV0pCgogICAgICAgICAgICBzLm9uZSA9IDMKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1vY2tfY2FsbHMsIFtjYWxsKCksIGNhbGwoKSwgY2FsbCgzKV0pCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgcC5zdG9wKCkKCgogICAgZGVmIHRlc3RfcHJvcGVydHltb2NrX3JldHVybnZhbHVlKHNlbGYpOgogICAgICAgIG0gPSBNYWdpY01vY2soKQogICAgICAgIHAgPSBQcm9wZXJ0eU1vY2soKQogICAgICAgIHR5cGUobSkuZm9vID0gcAoKICAgICAgICByZXR1cm5lZCA9IG0uZm9vCiAgICAgICAgcC5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCgpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHJldHVybmVkLCBNYWdpY01vY2spCiAgICAgICAgc2VsZi5hc3NlcnROb3RJc0luc3RhbmNlKHJldHVybmVkLCBQcm9wZXJ0eU1vY2spCgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIHVuaXR0ZXN0Lm1haW4oKQo=',
'/Lib/unittest/test/testmock/testmagicmethods.py':'aW1wb3J0IHVuaXR0ZXN0CmltcG9ydCBpbnNwZWN0CmltcG9ydCBzeXMKZnJvbSB1bml0dGVzdC5tb2NrIGltcG9ydCBNb2NrLCBNYWdpY01vY2ssIF9tYWdpY3MKCgoKY2xhc3MgVGVzdE1vY2tpbmdNYWdpY01ldGhvZHModW5pdHRlc3QuVGVzdENhc2UpOgoKICAgIGRlZiB0ZXN0X2RlbGV0aW5nX21hZ2ljX21ldGhvZHMoc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoaGFzYXR0cihtb2NrLCAnX19nZXRpdGVtX18nKSkKCiAgICAgICAgbW9jay5fX2dldGl0ZW1fXyA9IE1vY2soKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShoYXNhdHRyKG1vY2ssICdfX2dldGl0ZW1fXycpKQoKICAgICAgICBkZWwgbW9jay5fX2dldGl0ZW1fXwogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoaGFzYXR0cihtb2NrLCAnX19nZXRpdGVtX18nKSkKCgogICAgZGVmIHRlc3RfbWFnaWNtb2NrX2RlbChzZWxmKToKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKICAgICAgICAjIGJlZm9yZSB1c2luZyBnZXRpdGVtCiAgICAgICAgZGVsIG1vY2suX19nZXRpdGVtX18KICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGxhbWJkYTogbW9ja1snZm9vJ10pCgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgICMgdGhpcyB0aW1lIHVzZSBpdCBmaXJzdAogICAgICAgIG1vY2tbJ2ZvbyddCiAgICAgICAgZGVsIG1vY2suX19nZXRpdGVtX18KICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGxhbWJkYTogbW9ja1snZm9vJ10pCgoKICAgIGRlZiB0ZXN0X21hZ2ljX21ldGhvZF93cmFwcGluZyhzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgZGVmIGYoc2VsZiwgbmFtZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLCAnZmlzaCcKCiAgICAgICAgbW9jay5fX2dldGl0ZW1fXyA9IGYKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKG1vY2suX19nZXRpdGVtX18gaXMgZikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2tbJ2ZvbyddLCAobW9jaywgJ2Zpc2gnKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suX19nZXRpdGVtX18oJ2ZvbycpLCAobW9jaywgJ2Zpc2gnKSkKCiAgICAgICAgbW9jay5fX2dldGl0ZW1fXyA9IG1vY2sKICAgICAgICBzZWxmLmFzc2VydFRydWUobW9jay5fX2dldGl0ZW1fXyBpcyBtb2NrKQoKCiAgICBkZWYgdGVzdF9tYWdpY19tZXRob2RzX2lzb2xhdGVkX2JldHdlZW5fbW9ja3Moc2VsZik6CiAgICAgICAgbW9jazEgPSBNb2NrKCkKICAgICAgICBtb2NrMiA9IE1vY2soKQoKICAgICAgICBtb2NrMS5fX2l0ZXJfXyA9IE1vY2socmV0dXJuX3ZhbHVlPWl0ZXIoW10pKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChtb2NrMSksIFtdKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBsaXN0KG1vY2syKSkKCgogICAgZGVmIHRlc3RfcmVwcihzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXByKG1vY2spLCAiPE1vY2sgaWQ9JyVzJz4iICUgaWQobW9jaykpCiAgICAgICAgbW9jay5fX3JlcHJfXyA9IGxhbWJkYSBzOiAnZm9vJwogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVwcihtb2NrKSwgJ2ZvbycpCgoKICAgIGRlZiB0ZXN0X3N0cihzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIobW9jayksIG9iamVjdC5fX3N0cl9fKG1vY2spKQogICAgICAgIG1vY2suX19zdHJfXyA9IGxhbWJkYSBzOiAnZm9vJwogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKG1vY2spLCAnZm9vJykKCgogICAgZGVmIHRlc3RfZGljdF9tZXRob2RzKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBsYW1iZGE6IG1vY2tbJ2ZvbyddKQogICAgICAgIGRlZiBfZGVsKCk6CiAgICAgICAgICAgIGRlbCBtb2NrWydmb28nXQogICAgICAgIGRlZiBfc2V0KCk6CiAgICAgICAgICAgIG1vY2tbJ2ZvbyddID0gMwogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgX2RlbCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIF9zZXQpCgogICAgICAgIF9kaWN0ID0ge30KICAgICAgICBkZWYgZ2V0aXRlbShzLCBuYW1lKToKICAgICAgICAgICAgcmV0dXJuIF9kaWN0W25hbWVdCiAgICAgICAgZGVmIHNldGl0ZW0ocywgbmFtZSwgdmFsdWUpOgogICAgICAgICAgICBfZGljdFtuYW1lXSA9IHZhbHVlCiAgICAgICAgZGVmIGRlbGl0ZW0ocywgbmFtZSk6CiAgICAgICAgICAgIGRlbCBfZGljdFtuYW1lXQoKICAgICAgICBtb2NrLl9fc2V0aXRlbV9fID0gc2V0aXRlbQogICAgICAgIG1vY2suX19nZXRpdGVtX18gPSBnZXRpdGVtCiAgICAgICAgbW9jay5fX2RlbGl0ZW1fXyA9IGRlbGl0ZW0KCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoS2V5RXJyb3IsIGxhbWJkYTogbW9ja1snZm9vJ10pCiAgICAgICAgbW9ja1snZm9vJ10gPSAnYmFyJwogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoX2RpY3QsIHsnZm9vJzogJ2Jhcid9KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9ja1snZm9vJ10sICdiYXInKQogICAgICAgIGRlbCBtb2NrWydmb28nXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoX2RpY3QsIHt9KQoKCiAgICBkZWYgdGVzdF9udW1lcmljKHNlbGYpOgogICAgICAgIG9yaWdpbmFsID0gbW9jayA9IE1vY2soKQogICAgICAgIG1vY2sudmFsdWUgPSAwCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBtb2NrICsgMykKCiAgICAgICAgZGVmIGFkZChzZWxmLCBvdGhlcik6CiAgICAgICAgICAgIG1vY2sudmFsdWUgKz0gb3RoZXIKICAgICAgICAgICAgcmV0dXJuIHNlbGYKICAgICAgICBtb2NrLl9fYWRkX18gPSBhZGQKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sgKyAzLCBtb2NrKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay52YWx1ZSwgMykKCiAgICAgICAgZGVsIG1vY2suX19hZGRfXwogICAgICAgIGRlZiBpYWRkKG1vY2spOgogICAgICAgICAgICBtb2NrICs9IDMKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGlhZGQsIG1vY2spCiAgICAgICAgbW9jay5fX2lhZGRfXyA9IGFkZAogICAgICAgIG1vY2sgKz0gNgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jaywgb3JpZ2luYWwpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLnZhbHVlLCA5KQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGxhbWJkYTogMyArIG1vY2spCiAgICAgICAgbW9jay5fX3JhZGRfXyA9IGFkZAogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoNyArIG1vY2ssIG1vY2spCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLnZhbHVlLCAxNikKCgogICAgZGVmIHRlc3RfaGFzaChzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgIyB0ZXN0IGRlbGVnYXRpb24KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGhhc2gobW9jayksIE1vY2suX19oYXNoX18obW9jaykpCgogICAgICAgIGRlZiBfaGFzaChzKToKICAgICAgICAgICAgcmV0dXJuIDMKICAgICAgICBtb2NrLl9faGFzaF9fID0gX2hhc2gKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGhhc2gobW9jayksIDMpCgoKICAgIGRlZiB0ZXN0X25vbnplcm8oc2VsZik6CiAgICAgICAgbSA9IE1vY2soKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShib29sKG0pKQoKICAgICAgICBtLl9fYm9vbF9fID0gbGFtYmRhIHM6IEZhbHNlCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShib29sKG0pKQoKCiAgICBkZWYgdGVzdF9jb21wYXJpc29uKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBkZWYgY29tcChzLCBvKToKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBtb2NrLl9fbHRfXyA9IG1vY2suX19ndF9fID0gbW9jay5fX2xlX18gPSBtb2NrLl9fZ2VfXyA9IGNvbXAKICAgICAgICBzZWxmLiBhc3NlcnRUcnVlKG1vY2sgPCAzKQogICAgICAgIHNlbGYuIGFzc2VydFRydWUobW9jayA+IDMpCiAgICAgICAgc2VsZi4gYXNzZXJ0VHJ1ZShtb2NrIDw9IDMpCiAgICAgICAgc2VsZi4gYXNzZXJ0VHJ1ZShtb2NrID49IDMpCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBNYWdpY01vY2soKSA8IG9iamVjdCgpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBvYmplY3QoKSA8IE1hZ2ljTW9jaygpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBNYWdpY01vY2soKSA8IE1hZ2ljTW9jaygpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBNYWdpY01vY2soKSA+IG9iamVjdCgpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBvYmplY3QoKSA+IE1hZ2ljTW9jaygpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBNYWdpY01vY2soKSA+IE1hZ2ljTW9jaygpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBNYWdpY01vY2soKSA8PSBvYmplY3QoKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGxhbWJkYTogb2JqZWN0KCkgPD0gTWFnaWNNb2NrKCkpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBsYW1iZGE6IE1hZ2ljTW9jaygpIDw9IE1hZ2ljTW9jaygpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBNYWdpY01vY2soKSA+PSBvYmplY3QoKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGxhbWJkYTogb2JqZWN0KCkgPj0gTWFnaWNNb2NrKCkpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBsYW1iZGE6IE1hZ2ljTW9jaygpID49IE1hZ2ljTW9jaygpKQoKCiAgICBkZWYgdGVzdF9lcXVhbGl0eShzZWxmKToKICAgICAgICBmb3IgbW9jayBpbiBNb2NrKCksIE1hZ2ljTW9jaygpOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sgPT0gbW9jaywgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKG1vY2sgPT0gbW9jaywgYm9vbCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrICE9IG1vY2ssIEZhbHNlKQogICAgICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jayAhPSBtb2NrLCBib29sKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sgPT0gb2JqZWN0KCksIEZhbHNlKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sgIT0gb2JqZWN0KCksIFRydWUpCgogICAgICAgICAgICBkZWYgZXEoc2VsZiwgb3RoZXIpOgogICAgICAgICAgICAgICAgcmV0dXJuIG90aGVyID09IDMKICAgICAgICAgICAgbW9jay5fX2VxX18gPSBlcQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUobW9jayA9PSAzKQogICAgICAgICAgICBzZWxmLmFzc2VydEZhbHNlKG1vY2sgPT0gNCkKCiAgICAgICAgICAgIGRlZiBuZShzZWxmLCBvdGhlcik6CiAgICAgICAgICAgICAgICByZXR1cm4gb3RoZXIgPT0gMwogICAgICAgICAgICBtb2NrLl9fbmVfXyA9IG5lCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShtb2NrICE9IDMpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UobW9jayAhPSA0KQoKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKICAgICAgICBtb2NrLl9fZXFfXy5yZXR1cm5fdmFsdWUgPSBUcnVlCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKG1vY2sgPT0gMywgYm9vbCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sgPT0gMywgVHJ1ZSkKCiAgICAgICAgbW9jay5fX25lX18ucmV0dXJuX3ZhbHVlID0gRmFsc2UKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jayAhPSAzLCBib29sKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jayAhPSAzLCBGYWxzZSkKCgogICAgZGVmIHRlc3RfbGVuX2NvbnRhaW5zX2l0ZXIoc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soKQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGxlbiwgbW9jaykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGl0ZXIsIG1vY2spCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBsYW1iZGE6ICdmb28nIGluIG1vY2spCgogICAgICAgIG1vY2suX19sZW5fXyA9IGxhbWJkYSBzOiA2CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4obW9jayksIDYpCgogICAgICAgIG1vY2suX19jb250YWluc19fID0gbGFtYmRhIHMsIG86IG8gPT0gMwogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZSgzIGluIG1vY2spCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZSg2IGluIG1vY2spCgogICAgICAgIG1vY2suX19pdGVyX18gPSBsYW1iZGEgczogaXRlcignZm9vYmFyYmF6JykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3QobW9jayksIGxpc3QoJ2Zvb2JhcmJheicpKQoKCiAgICBkZWYgdGVzdF9tYWdpY21vY2soc2VsZik6CiAgICAgICAgbW9jayA9IE1hZ2ljTW9jaygpCgogICAgICAgIG1vY2suX19pdGVyX18ucmV0dXJuX3ZhbHVlID0gaXRlcihbMSwgMiwgM10pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KG1vY2spLCBbMSwgMiwgM10pCgogICAgICAgIGdldGF0dHIobW9jaywgJ19fYm9vbF9fJykucmV0dXJuX3ZhbHVlID0gRmFsc2UKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKGhhc2F0dHIobW9jaywgJ19fbm9uemVyb19fJykpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShib29sKG1vY2spKQoKICAgICAgICBmb3IgZW50cnkgaW4gX21hZ2ljczoKICAgICAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGhhc2F0dHIobW9jaywgZW50cnkpKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoaGFzYXR0cihtb2NrLCAnX19pbWFnaW5lcnlfXycpKQoKCiAgICBkZWYgdGVzdF9tYWdpY19tb2NrX2VxdWFsaXR5KHNlbGYpOgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrID09IG9iamVjdCgpLCBib29sKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrICE9IG9iamVjdCgpLCBib29sKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sgPT0gb2JqZWN0KCksIEZhbHNlKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jayAhPSBvYmplY3QoKSwgVHJ1ZSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sgPT0gbW9jaywgVHJ1ZSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sgIT0gbW9jaywgRmFsc2UpCgoKICAgIGRlZiB0ZXN0X21hZ2ljbW9ja19kZWZhdWx0cyhzZWxmKToKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGludChtb2NrKSwgMSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNvbXBsZXgobW9jayksIDFqKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZmxvYXQobW9jayksIDEuMCkKICAgICAgICBzZWxmLmFzc2VydE5vdEluKG9iamVjdCgpLCBtb2NrKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKG1vY2spLCAwKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChtb2NrKSwgW10pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChoYXNoKG1vY2spLCBvYmplY3QuX19oYXNoX18obW9jaykpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIobW9jayksIG9iamVjdC5fX3N0cl9fKG1vY2spKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShib29sKG1vY2spKQoKICAgICAgICAjIGluIFB5dGhvbiAzIG9jdCBhbmQgaGV4IHVzZSBfX2luZGV4X18KICAgICAgICAjIHNvIHRoZXNlIHRlc3RzIGFyZSBmb3IgX19pbmRleF9fIGluIHB5M2sKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG9jdChtb2NrKSwgJzBvMScpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChoZXgobW9jayksICcweDEnKQogICAgICAgICMgaG93IHRvIHRlc3QgX19zaXplb2ZfXyA/CgoKICAgIGRlZiB0ZXN0X21hZ2ljX21ldGhvZHNfYW5kX3NwZWMoc2VsZik6CiAgICAgICAgY2xhc3MgSXRlcmFibGUob2JqZWN0KToKICAgICAgICAgICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBtb2NrID0gTW9jayhzcGVjPUl0ZXJhYmxlKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBsYW1iZGE6IG1vY2suX19pdGVyX18pCgogICAgICAgIG1vY2suX19pdGVyX18gPSBNb2NrKHJldHVybl92YWx1ZT1pdGVyKFtdKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3QobW9jayksIFtdKQoKICAgICAgICBjbGFzcyBOb25JdGVyYWJsZShvYmplY3QpOgogICAgICAgICAgICBwYXNzCiAgICAgICAgbW9jayA9IE1vY2soc3BlYz1Ob25JdGVyYWJsZSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgbGFtYmRhOiBtb2NrLl9faXRlcl9fKQoKICAgICAgICBkZWYgc2V0X2ludCgpOgogICAgICAgICAgICBtb2NrLl9faW50X18gPSBNb2NrKHJldHVybl92YWx1ZT1pdGVyKFtdKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgc2V0X2ludCkKCiAgICAgICAgbW9jayA9IE1hZ2ljTW9jayhzcGVjPUl0ZXJhYmxlKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChtb2NrKSwgW10pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIHNldF9pbnQpCgoKICAgIGRlZiB0ZXN0X21hZ2ljX21ldGhvZHNfYW5kX3NwZWNfc2V0KHNlbGYpOgogICAgICAgIGNsYXNzIEl0ZXJhYmxlKG9iamVjdCk6CiAgICAgICAgICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgbW9jayA9IE1vY2soc3BlY19zZXQ9SXRlcmFibGUpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGxhbWJkYTogbW9jay5fX2l0ZXJfXykKCiAgICAgICAgbW9jay5fX2l0ZXJfXyA9IE1vY2socmV0dXJuX3ZhbHVlPWl0ZXIoW10pKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChtb2NrKSwgW10pCgogICAgICAgIGNsYXNzIE5vbkl0ZXJhYmxlKG9iamVjdCk6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBtb2NrID0gTW9jayhzcGVjX3NldD1Ob25JdGVyYWJsZSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgbGFtYmRhOiBtb2NrLl9faXRlcl9fKQoKICAgICAgICBkZWYgc2V0X2ludCgpOgogICAgICAgICAgICBtb2NrLl9faW50X18gPSBNb2NrKHJldHVybl92YWx1ZT1pdGVyKFtdKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgc2V0X2ludCkKCiAgICAgICAgbW9jayA9IE1hZ2ljTW9jayhzcGVjX3NldD1JdGVyYWJsZSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3QobW9jayksIFtdKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBzZXRfaW50KQoKCiAgICBkZWYgdGVzdF9zZXR0aW5nX3Vuc3VwcG9ydGVkX21hZ2ljX21ldGhvZChzZWxmKToKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKICAgICAgICBkZWYgc2V0X3NldGF0dHIoKToKICAgICAgICAgICAgbW9jay5fX3NldGF0dHJfXyA9IGxhbWJkYSBzZWxmLCBuYW1lOiBOb25lCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXNSZWdleChBdHRyaWJ1dGVFcnJvciwKICAgICAgICAgICAgIkF0dGVtcHRpbmcgdG8gc2V0IHVuc3VwcG9ydGVkIG1hZ2ljIG1ldGhvZCAnX19zZXRhdHRyX18nLiIsCiAgICAgICAgICAgIHNldF9zZXRhdHRyCiAgICAgICAgKQoKCiAgICBkZWYgdGVzdF9hdHRyaWJ1dGVzX2FuZF9yZXR1cm5fdmFsdWUoc2VsZik6CiAgICAgICAgbW9jayA9IE1hZ2ljTW9jaygpCiAgICAgICAgYXR0ciA9IG1vY2suZm9vCiAgICAgICAgZGVmIF9nZXRfdHlwZShvYmopOgogICAgICAgICAgICAjIHRoZSB0eXBlIG9mIGV2ZXJ5IG1vY2sgKG9yIG1hZ2ljbW9jaykgaXMgYSBjdXN0b20gc3ViY2xhc3MKICAgICAgICAgICAgIyBzbyB0aGUgcmVhbCB0eXBlIGlzIHRoZSBzZWNvbmQgaW4gdGhlIG1ybwogICAgICAgICAgICByZXR1cm4gdHlwZShvYmopLl9fbXJvX19bMV0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKF9nZXRfdHlwZShhdHRyKSwgTWFnaWNNb2NrKQoKICAgICAgICByZXR1cm5lZCA9IG1vY2soKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoX2dldF90eXBlKHJldHVybmVkKSwgTWFnaWNNb2NrKQoKCiAgICBkZWYgdGVzdF9tYWdpY19tZXRob2RzX2FyZV9tYWdpY19tb2NrcyhzZWxmKToKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jay5fX2dldGl0ZW1fXywgTWFnaWNNb2NrKQoKICAgICAgICBtb2NrWzFdWzJdLl9fZ2V0aXRlbV9fLnJldHVybl92YWx1ZSA9IDMKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2tbMV1bMl1bM10sIDMpCgoKICAgIGRlZiB0ZXN0X21hZ2ljX21ldGhvZF9yZXNldF9tb2NrKHNlbGYpOgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgIHN0cihtb2NrKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShtb2NrLl9fc3RyX18uY2FsbGVkKQogICAgICAgIG1vY2sucmVzZXRfbW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShtb2NrLl9fc3RyX18uY2FsbGVkKQoKCiAgICBkZWYgdGVzdF9kaXIoc2VsZik6CiAgICAgICAgIyBvdmVycmlkaW5nIHRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uCiAgICAgICAgZm9yIG1vY2sgaW4gTW9jaygpLCBNYWdpY01vY2soKToKICAgICAgICAgICAgZGVmIF9kaXIoc2VsZik6CiAgICAgICAgICAgICAgICByZXR1cm4gWydmb28nXQogICAgICAgICAgICBtb2NrLl9fZGlyX18gPSBfZGlyCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZGlyKG1vY2spLCBbJ2ZvbyddKQoKCiAgICBAdW5pdHRlc3Quc2tpcElmKCdQeVB5JyBpbiBzeXMudmVyc2lvbiwgIlRoaXMgZmFpbHMgZGlmZmVyZW50bHkgb24gcHlweSIpCiAgICBkZWYgdGVzdF9ib3VuZF9tZXRob2RzKHNlbGYpOgogICAgICAgIG0gPSBNb2NrKCkKCiAgICAgICAgIyBYWFhYIHNob3VsZCB0aGlzIGJlIGFuIGV4cGVjdGVkIGZhaWx1cmUgaW5zdGVhZD8KCiAgICAgICAgIyB0aGlzIHNlZW1zIGxpa2UgaXQgc2hvdWxkIHdvcmssIGJ1dCBpcyBoYXJkIHRvIGRvIHdpdGhvdXQgaW50cm9kdWNpbmcKICAgICAgICAjIG90aGVyIGFwaSBpbmNvbnNpc3RlbmNpZXMuIEZhaWx1cmUgbWVzc2FnZSBjb3VsZCBiZSBiZXR0ZXIgdGhvdWdoLgogICAgICAgIG0uX19pdGVyX18gPSBbM10uX19pdGVyX18KICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGl0ZXIsIG0pCgoKICAgIGRlZiB0ZXN0X21hZ2ljX21ldGhvZF90eXBlKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyhNYWdpY01vY2spOgogICAgICAgICAgICBwYXNzCgogICAgICAgIGZvbyA9IEZvbygpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGZvby5fX2ludF9fLCBGb28pCgoKICAgIGRlZiB0ZXN0X2Rlc2NyaXB0b3JfZnJvbV9jbGFzcyhzZWxmKToKICAgICAgICBtID0gTWFnaWNNb2NrKCkKICAgICAgICB0eXBlKG0pLl9fc3RyX18ucmV0dXJuX3ZhbHVlID0gJ2ZvbycKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN0cihtKSwgJ2ZvbycpCgoKICAgIGRlZiB0ZXN0X2l0ZXJhYmxlX2FzX2l0ZXJfcmV0dXJuX3ZhbHVlKHNlbGYpOgogICAgICAgIG0gPSBNYWdpY01vY2soKQogICAgICAgIG0uX19pdGVyX18ucmV0dXJuX3ZhbHVlID0gWzEsIDIsIDNdCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KG0pLCBbMSwgMiwgM10pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KG0pLCBbMSwgMiwgM10pCgogICAgICAgIG0uX19pdGVyX18ucmV0dXJuX3ZhbHVlID0gaXRlcihbNCwgNSwgNl0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KG0pLCBbNCwgNSwgNl0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KG0pLCBbXSkKCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgdW5pdHRlc3QubWFpbigpCg==',
'/Lib/unittest/test/testmock/testmock.py':'aW1wb3J0IGNvcHkKaW1wb3J0IHN5cwoKaW1wb3J0IHVuaXR0ZXN0CmZyb20gdW5pdHRlc3QudGVzdC50ZXN0bW9jay5zdXBwb3J0IGltcG9ydCBpc19pbnN0YW5jZQpmcm9tIHVuaXR0ZXN0IGltcG9ydCBtb2NrCmZyb20gdW5pdHRlc3QubW9jayBpbXBvcnQgKAogICAgY2FsbCwgREVGQVVMVCwgcGF0Y2gsIHNlbnRpbmVsLAogICAgTWFnaWNNb2NrLCBNb2NrLCBOb25DYWxsYWJsZU1vY2ssCiAgICBOb25DYWxsYWJsZU1hZ2ljTW9jaywgX0NhbGxMaXN0LAogICAgY3JlYXRlX2F1dG9zcGVjCikKCgpjbGFzcyBJdGVyKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi50aGluZyA9IGl0ZXIoWyd0aGlzJywgJ2lzJywgJ2FuJywgJ2l0ZXInXSkKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgbmV4dChzZWxmKToKICAgICAgICByZXR1cm4gbmV4dChzZWxmLnRoaW5nKQoKICAgIF9fbmV4dF9fID0gbmV4dAoKCgpjbGFzcyBNb2NrVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIHRlc3RfYWxsKHNlbGYpOgogICAgICAgICMgaWYgX19hbGxfXyBpcyBiYWRseSBkZWZpbmVkIHRoZW4gaW1wb3J0ICogd2lsbCByYWlzZSBhbiBlcnJvcgogICAgICAgICMgV2UgaGF2ZSB0byBleGVjIGl0IGJlY2F1c2UgeW91IGNhbid0IGltcG9ydCAqIGluc2lkZSBhIG1ldGhvZAogICAgICAgICMgaW4gUHl0aG9uIDMKICAgICAgICBleGVjKCJmcm9tIHVuaXR0ZXN0Lm1vY2sgaW1wb3J0ICoiKQoKCiAgICBkZWYgdGVzdF9jb25zdHJ1Y3RvcihzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCgogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UobW9jay5jYWxsZWQsICJjYWxsZWQgbm90IGluaXRpYWxpc2VkIGNvcnJlY3RseSIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmNhbGxfY291bnQsIDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAiY2FsbF9jb3VudCBub3QgaW5pdGlhbGlzZWQgY29ycmVjdGx5IikKICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UobW9jay5yZXR1cm5fdmFsdWUsIE1vY2spLAogICAgICAgICAgICAgICAgICAgICAgICAicmV0dXJuX3ZhbHVlIG5vdCBpbml0aWFsaXNlZCBjb3JyZWN0bHkiKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suY2FsbF9hcmdzLCBOb25lLAogICAgICAgICAgICAgICAgICAgICAgICAgImNhbGxfYXJncyBub3QgaW5pdGlhbGlzZWQgY29ycmVjdGx5IikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suY2FsbF9hcmdzX2xpc3QsIFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgImNhbGxfYXJnc19saXN0IG5vdCBpbml0aWFsaXNlZCBjb3JyZWN0bHkiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tZXRob2RfY2FsbHMsIFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgICJtZXRob2RfY2FsbHMgbm90IGluaXRpYWxpc2VkIGNvcnJlY3RseSIpCgogICAgICAgICMgQ2FuJ3QgdXNlIGhhc2F0dHIgZm9yIHRoaXMgdGVzdCBhcyBpdCBhbHdheXMgcmV0dXJucyBUcnVlIG9uIGEgbW9jawogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoJ19pdGVtcycgaW4gbW9jay5fX2RpY3RfXywKICAgICAgICAgICAgICAgICAgICAgICAgICJkZWZhdWx0IG1vY2sgc2hvdWxkIG5vdCBoYXZlICdfaXRlbXMnIGF0dHJpYnV0ZSIpCgogICAgICAgIHNlbGYuYXNzZXJ0SXNOb25lKG1vY2suX21vY2tfcGFyZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICJwYXJlbnQgbm90IGluaXRpYWxpc2VkIGNvcnJlY3RseSIpCiAgICAgICAgc2VsZi5hc3NlcnRJc05vbmUobW9jay5fbW9ja19tZXRob2RzLAogICAgICAgICAgICAgICAgICAgICAgICAgICJtZXRob2RzIG5vdCBpbml0aWFsaXNlZCBjb3JyZWN0bHkiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5fbW9ja19jaGlsZHJlbiwge30sCiAgICAgICAgICAgICAgICAgICAgICAgICAiY2hpbGRyZW4gbm90IGluaXRpYWxpc2VkIGluY29ycmVjdGx5IikKCgogICAgZGVmIHRlc3RfcmV0dXJuX3ZhbHVlX2luX2NvbnN0cnVjdG9yKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKHJldHVybl92YWx1ZT1Ob25lKQogICAgICAgIHNlbGYuYXNzZXJ0SXNOb25lKG1vY2sucmV0dXJuX3ZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICJyZXR1cm4gdmFsdWUgaW4gY29uc3RydWN0b3Igbm90IGhvbm91cmVkIikKCgogICAgZGVmIHRlc3RfcmVwcihzZWxmKToKICAgICAgICBtb2NrID0gTW9jayhuYW1lPSdmb28nKQogICAgICAgIHNlbGYuYXNzZXJ0SW4oJ2ZvbycsIHJlcHIobW9jaykpCiAgICAgICAgc2VsZi5hc3NlcnRJbigiJyVzJyIgJSBpZChtb2NrKSwgcmVwcihtb2NrKSkKCiAgICAgICAgbW9ja3MgPSBbKE1vY2soKSwgJ21vY2snKSwgKE1vY2sobmFtZT0nYmFyJyksICdiYXInKV0KICAgICAgICBmb3IgbW9jaywgbmFtZSBpbiBtb2NrczoKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbignJXMuYmFyJyAlIG5hbWUsIHJlcHIobW9jay5iYXIpKQogICAgICAgICAgICBzZWxmLmFzc2VydEluKCclcy5mb28oKScgJSBuYW1lLCByZXByKG1vY2suZm9vKCkpKQogICAgICAgICAgICBzZWxmLmFzc2VydEluKCclcy5mb28oKS5iaW5nJyAlIG5hbWUsIHJlcHIobW9jay5mb28oKS5iaW5nKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbignJXMoKScgJSBuYW1lLCByZXByKG1vY2soKSkpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SW4oJyVzKCkoKScgJSBuYW1lLCByZXByKG1vY2soKSgpKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbignJXMoKSgpLmZvby5iYXIuYmF6KCkuYmluZycgJSBuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgIHJlcHIobW9jaygpKCkuZm9vLmJhci5iYXooKS5iaW5nKSkKCgogICAgZGVmIHRlc3RfcmVwcl93aXRoX3NwZWMoc2VsZik6CiAgICAgICAgY2xhc3MgWChvYmplY3QpOgogICAgICAgICAgICBwYXNzCgogICAgICAgIG1vY2sgPSBNb2NrKHNwZWM9WCkKICAgICAgICBzZWxmLmFzc2VydEluKCIgc3BlYz0nWCcgIiwgcmVwcihtb2NrKSkKCiAgICAgICAgbW9jayA9IE1vY2soc3BlYz1YKCkpCiAgICAgICAgc2VsZi5hc3NlcnRJbigiIHNwZWM9J1gnICIsIHJlcHIobW9jaykpCgogICAgICAgIG1vY2sgPSBNb2NrKHNwZWNfc2V0PVgpCiAgICAgICAgc2VsZi5hc3NlcnRJbigiIHNwZWNfc2V0PSdYJyAiLCByZXByKG1vY2spKQoKICAgICAgICBtb2NrID0gTW9jayhzcGVjX3NldD1YKCkpCiAgICAgICAgc2VsZi5hc3NlcnRJbigiIHNwZWNfc2V0PSdYJyAiLCByZXByKG1vY2spKQoKICAgICAgICBtb2NrID0gTW9jayhzcGVjPVgsIG5hbWU9J2ZvbycpCiAgICAgICAgc2VsZi5hc3NlcnRJbigiIHNwZWM9J1gnICIsIHJlcHIobW9jaykpCiAgICAgICAgc2VsZi5hc3NlcnRJbigiIG5hbWU9J2ZvbycgIiwgcmVwcihtb2NrKSkKCiAgICAgICAgbW9jayA9IE1vY2sobmFtZT0nZm9vJykKICAgICAgICBzZWxmLmFzc2VydE5vdEluKCJzcGVjIiwgcmVwcihtb2NrKSkKCiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90SW4oInNwZWMiLCByZXByKG1vY2spKQoKICAgICAgICBtb2NrID0gTW9jayhzcGVjPVsnZm9vJ10pCiAgICAgICAgc2VsZi5hc3NlcnROb3RJbigic3BlYyIsIHJlcHIobW9jaykpCgoKICAgIGRlZiB0ZXN0X3NpZGVfZWZmZWN0KHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKCiAgICAgICAgZGVmIGVmZmVjdCgqYXJncywgKiprd2FyZ3MpOgogICAgICAgICAgICByYWlzZSBTeXN0ZW1FcnJvcigna2FibG9vaWUnKQoKICAgICAgICBtb2NrLnNpZGVfZWZmZWN0ID0gZWZmZWN0CiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoU3lzdGVtRXJyb3IsIG1vY2ssIDEsIDIsIGZpc2g9MykKICAgICAgICBtb2NrLmFzc2VydF9jYWxsZWRfd2l0aCgxLCAyLCBmaXNoPTMpCgogICAgICAgIHJlc3VsdHMgPSBbMSwgMiwgM10KICAgICAgICBkZWYgZWZmZWN0KCk6CiAgICAgICAgICAgIHJldHVybiByZXN1bHRzLnBvcCgpCiAgICAgICAgbW9jay5zaWRlX2VmZmVjdCA9IGVmZmVjdAoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFttb2NrKCksIG1vY2soKSwgbW9jaygpXSwgWzMsIDIsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICJzaWRlIGVmZmVjdCBub3QgdXNlZCBjb3JyZWN0bHkiKQoKICAgICAgICBtb2NrID0gTW9jayhzaWRlX2VmZmVjdD1zZW50aW5lbC5TaWRlRWZmZWN0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5zaWRlX2VmZmVjdCwgc2VudGluZWwuU2lkZUVmZmVjdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAic2lkZSBlZmZlY3QgaW4gY29uc3RydWN0b3Igbm90IHVzZWQiKQoKICAgICAgICBkZWYgc2lkZV9lZmZlY3QoKToKICAgICAgICAgICAgcmV0dXJuIERFRkFVTFQKICAgICAgICBtb2NrID0gTW9jayhzaWRlX2VmZmVjdD1zaWRlX2VmZmVjdCwgcmV0dXJuX3ZhbHVlPXNlbnRpbmVsLlJFVFVSTikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2soKSwgc2VudGluZWwuUkVUVVJOKQoKCiAgICBAdW5pdHRlc3Quc2tpcFVubGVzcygnamF2YScgaW4gc3lzLnBsYXRmb3JtLAogICAgICAgICAgICAgICAgICAgICAgICAgICdUaGlzIHRlc3Qgb25seSBhcHBsaWVzIHRvIEp5dGhvbicpCiAgICBkZWYgdGVzdF9qYXZhX2V4Y2VwdGlvbl9zaWRlX2VmZmVjdChzZWxmKToKICAgICAgICBpbXBvcnQgamF2YQogICAgICAgIG1vY2sgPSBNb2NrKHNpZGVfZWZmZWN0PWphdmEubGFuZy5SdW50aW1lRXhjZXB0aW9uKCJCb29tISIpKQoKICAgICAgICAjIGNhbid0IHVzZSBhc3NlcnRSYWlzZXMgd2l0aCBqYXZhIGV4Y2VwdGlvbnMKICAgICAgICB0cnk6CiAgICAgICAgICAgIG1vY2soMSwgMiwgZmlzaD0zKQogICAgICAgIGV4Y2VwdCBqYXZhLmxhbmcuUnVudGltZUV4Y2VwdGlvbjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgnamF2YSBleGNlcHRpb24gbm90IHJhaXNlZCcpCiAgICAgICAgbW9jay5hc3NlcnRfY2FsbGVkX3dpdGgoMSwyLCBmaXNoPTMpCgoKICAgIGRlZiB0ZXN0X3Jlc2V0X21vY2soc2VsZik6CiAgICAgICAgcGFyZW50ID0gTW9jaygpCiAgICAgICAgc3BlYyA9IFsic29tZXRoaW5nIl0KICAgICAgICBtb2NrID0gTW9jayhuYW1lPSJjaGlsZCIsIHBhcmVudD1wYXJlbnQsIHNwZWM9c3BlYykKICAgICAgICBtb2NrKHNlbnRpbmVsLlNvbWV0aGluZywgc29tZXRoaW5nPXNlbnRpbmVsLlNvbWV0aGluZ0Vsc2UpCiAgICAgICAgc29tZXRoaW5nID0gbW9jay5zb21ldGhpbmcKICAgICAgICBtb2NrLnNvbWV0aGluZygpCiAgICAgICAgbW9jay5zaWRlX2VmZmVjdCA9IHNlbnRpbmVsLlNpZGVFZmZlY3QKICAgICAgICByZXR1cm5fdmFsdWUgPSBtb2NrLnJldHVybl92YWx1ZQogICAgICAgIHJldHVybl92YWx1ZSgpCgogICAgICAgIG1vY2sucmVzZXRfbW9jaygpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5fbW9ja19uYW1lLCAiY2hpbGQiLAogICAgICAgICAgICAgICAgICAgICAgICAgIm5hbWUgaW5jb3JyZWN0bHkgcmVzZXQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5fbW9ja19wYXJlbnQsIHBhcmVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICJwYXJlbnQgaW5jb3JyZWN0bHkgcmVzZXQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5fbW9ja19tZXRob2RzLCBzcGVjLAogICAgICAgICAgICAgICAgICAgICAgICAgIm1ldGhvZHMgaW5jb3JyZWN0bHkgcmVzZXQiKQoKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKG1vY2suY2FsbGVkLCAiY2FsbGVkIG5vdCByZXNldCIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmNhbGxfY291bnQsIDAsICJjYWxsX2NvdW50IG5vdCByZXNldCIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmNhbGxfYXJncywgTm9uZSwgImNhbGxfYXJncyBub3QgcmVzZXQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5jYWxsX2FyZ3NfbGlzdCwgW10sICJjYWxsX2FyZ3NfbGlzdCBub3QgcmVzZXQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tZXRob2RfY2FsbHMsIFtdLAogICAgICAgICAgICAgICAgICAgICAgICAibWV0aG9kX2NhbGxzIG5vdCBpbml0aWFsaXNlZCBjb3JyZWN0bHk6ICVyICE9ICVyIiAlCiAgICAgICAgICAgICAgICAgICAgICAgIChtb2NrLm1ldGhvZF9jYWxscywgW10pKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tb2NrX2NhbGxzLCBbXSkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLnNpZGVfZWZmZWN0LCBzZW50aW5lbC5TaWRlRWZmZWN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICJzaWRlX2VmZmVjdCBpbmNvcnJlY3RseSByZXNldCIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLnJldHVybl92YWx1ZSwgcmV0dXJuX3ZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICJyZXR1cm5fdmFsdWUgaW5jb3JyZWN0bHkgcmVzZXQiKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UocmV0dXJuX3ZhbHVlLmNhbGxlZCwgInJldHVybiB2YWx1ZSBtb2NrIG5vdCByZXNldCIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLl9tb2NrX2NoaWxkcmVuLCB7J3NvbWV0aGluZyc6IHNvbWV0aGluZ30sCiAgICAgICAgICAgICAgICAgICAgICAgICAgImNoaWxkcmVuIHJlc2V0IGluY29ycmVjdGx5IikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suc29tZXRoaW5nLCBzb21ldGhpbmcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgImNoaWxkcmVuIGluY29ycmVjdGx5IGNsZWFyZWQiKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UobW9jay5zb21ldGhpbmcuY2FsbGVkLCAiY2hpbGQgbm90IHJlc2V0IikKCgogICAgZGVmIHRlc3RfcmVzZXRfbW9ja19yZWN1cnNpb24oc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2sucmV0dXJuX3ZhbHVlID0gbW9jawoKICAgICAgICAjIHVzZWQgdG8gY2F1c2UgcmVjdXJzaW9uCiAgICAgICAgbW9jay5yZXNldF9tb2NrKCkKCgogICAgZGVmIHRlc3RfY2FsbChzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzX2luc3RhbmNlKG1vY2sucmV0dXJuX3ZhbHVlLCBNb2NrKSwKICAgICAgICAgICAgICAgICAgICAgICAgIkRlZmF1bHQgcmV0dXJuX3ZhbHVlIHNob3VsZCBiZSBhIE1vY2siKQoKICAgICAgICByZXN1bHQgPSBtb2NrKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2soKSwgcmVzdWx0LAogICAgICAgICAgICAgICAgICAgICAgICAgImRpZmZlcmVudCByZXN1bHQgZnJvbSBjb25zZWN1dGl2ZSBjYWxscyIpCiAgICAgICAgbW9jay5yZXNldF9tb2NrKCkKCiAgICAgICAgcmV0X3ZhbCA9IG1vY2soc2VudGluZWwuQXJnKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShtb2NrLmNhbGxlZCwgImNhbGxlZCBub3Qgc2V0IikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suY2FsbF9jb3VudCwgMSwgImNhbGxfY291bnQgaW5jb3JlZWN0IikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suY2FsbF9hcmdzLCAoKHNlbnRpbmVsLkFyZywpLCB7fSksCiAgICAgICAgICAgICAgICAgICAgICAgICAiY2FsbF9hcmdzIG5vdCBzZXQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5jYWxsX2FyZ3NfbGlzdCwgWygoc2VudGluZWwuQXJnLCksIHt9KV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAiY2FsbF9hcmdzX2xpc3Qgbm90IGluaXRpYWxpc2VkIGNvcnJlY3RseSIpCgogICAgICAgIG1vY2sucmV0dXJuX3ZhbHVlID0gc2VudGluZWwuUmV0dXJuVmFsdWUKICAgICAgICByZXRfdmFsID0gbW9jayhzZW50aW5lbC5BcmcsIGtleT1zZW50aW5lbC5LZXlBcmcpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXRfdmFsLCBzZW50aW5lbC5SZXR1cm5WYWx1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICJpbmNvcnJlY3QgcmV0dXJuIHZhbHVlIikKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmNhbGxfY291bnQsIDIsICJjYWxsX2NvdW50IGluY29ycmVjdCIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmNhbGxfYXJncywKICAgICAgICAgICAgICAgICAgICAgICAgICgoc2VudGluZWwuQXJnLCksIHsna2V5Jzogc2VudGluZWwuS2V5QXJnfSksCiAgICAgICAgICAgICAgICAgICAgICAgICAiY2FsbF9hcmdzIG5vdCBzZXQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5jYWxsX2FyZ3NfbGlzdCwgWwogICAgICAgICAgICAoKHNlbnRpbmVsLkFyZywpLCB7fSksCiAgICAgICAgICAgICgoc2VudGluZWwuQXJnLCksIHsna2V5Jzogc2VudGluZWwuS2V5QXJnfSkKICAgICAgICBdLAogICAgICAgICAgICAiY2FsbF9hcmdzX2xpc3Qgbm90IHNldCIpCgoKICAgIGRlZiB0ZXN0X2NhbGxfYXJnc19jb21wYXJpc29uKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrKCkKICAgICAgICBtb2NrKHNlbnRpbmVsLkFyZykKICAgICAgICBtb2NrKGt3PXNlbnRpbmVsLkt3YXJnKQogICAgICAgIG1vY2soc2VudGluZWwuQXJnLCBrdz1zZW50aW5lbC5Ld2FyZykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suY2FsbF9hcmdzX2xpc3QsIFsKICAgICAgICAgICAgKCksCiAgICAgICAgICAgICgoc2VudGluZWwuQXJnLCksKSwKICAgICAgICAgICAgKHsia3ciOiBzZW50aW5lbC5Ld2FyZ30sKSwKICAgICAgICAgICAgKChzZW50aW5lbC5BcmcsKSwgeyJrdyI6IHNlbnRpbmVsLkt3YXJnfSkKICAgICAgICBdKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5jYWxsX2FyZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAoKHNlbnRpbmVsLkFyZywpLCB7Imt3Ijogc2VudGluZWwuS3dhcmd9KSkKCgogICAgZGVmIHRlc3RfYXNzZXJ0X2NhbGxlZF93aXRoKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrKCkKCiAgICAgICAgIyBXaWxsIHJhaXNlIGFuIGV4Y2VwdGlvbiBpZiBpdCBmYWlscwogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF93aXRoKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBc3NlcnRpb25FcnJvciwgbW9jay5hc3NlcnRfY2FsbGVkX3dpdGgsIDEpCgogICAgICAgIG1vY2sucmVzZXRfbW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXNzZXJ0aW9uRXJyb3IsIG1vY2suYXNzZXJ0X2NhbGxlZF93aXRoKQoKICAgICAgICBtb2NrKDEsIDIsIDMsIGE9J2Zpc2gnLCBiPSdub3RoaW5nJykKICAgICAgICBtb2NrLmFzc2VydF9jYWxsZWRfd2l0aCgxLCAyLCAzLCBhPSdmaXNoJywgYj0nbm90aGluZycpCgoKICAgIGRlZiB0ZXN0X2Fzc2VydF9jYWxsZWRfb25jZV93aXRoKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrKCkKCiAgICAgICAgIyBXaWxsIHJhaXNlIGFuIGV4Y2VwdGlvbiBpZiBpdCBmYWlscwogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoKQoKICAgICAgICBtb2NrKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBc3NlcnRpb25FcnJvciwgbW9jay5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCkKCiAgICAgICAgbW9jay5yZXNldF9tb2NrKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBc3NlcnRpb25FcnJvciwgbW9jay5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCkKCiAgICAgICAgbW9jaygnZm9vJywgJ2JhcicsIGJhej0yKQogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoJ2ZvbycsICdiYXInLCBiYXo9MikKCiAgICAgICAgbW9jay5yZXNldF9tb2NrKCkKICAgICAgICBtb2NrKCdmb28nLCAnYmFyJywgYmF6PTIpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgIEFzc2VydGlvbkVycm9yLAogICAgICAgICAgICBsYW1iZGE6IG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoJ2JvYicsICdiYXInLCBiYXo9MikKICAgICAgICApCgoKICAgIGRlZiB0ZXN0X2F0dHJpYnV0ZV9hY2Nlc3NfcmV0dXJuc19tb2NrcyhzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgc29tZXRoaW5nID0gbW9jay5zb21ldGhpbmcKICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2Uoc29tZXRoaW5nLCBNb2NrKSwgImF0dHJpYnV0ZSBpc24ndCBhIG1vY2siKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5zb21ldGhpbmcsIHNvbWV0aGluZywKICAgICAgICAgICAgICAgICAgICAgICAgICJkaWZmZXJlbnQgYXR0cmlidXRlcyByZXR1cm5lZCBmb3Igc2FtZSBuYW1lIikKCiAgICAgICAgIyBVc2FnZSBleGFtcGxlCiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2suc29tZXRoaW5nLnJldHVybl92YWx1ZSA9IDMKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLnNvbWV0aGluZygpLCAzLCAibWV0aG9kIHJldHVybmVkIHdyb25nIHZhbHVlIikKICAgICAgICBzZWxmLmFzc2VydFRydWUobW9jay5zb21ldGhpbmcuY2FsbGVkLAogICAgICAgICAgICAgICAgICAgICAgICAibWV0aG9kIGRpZG4ndCByZWNvcmQgYmVpbmcgY2FsbGVkIikKCgogICAgZGVmIHRlc3RfYXR0cmlidXRlc19oYXZlX25hbWVfYW5kX3BhcmVudF9zZXQoc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIHNvbWV0aGluZyA9IG1vY2suc29tZXRoaW5nCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLl9tb2NrX25hbWUsICJzb21ldGhpbmciLAogICAgICAgICAgICAgICAgICAgICAgICAgImF0dHJpYnV0ZSBuYW1lIG5vdCBzZXQgY29ycmVjdGx5IikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNvbWV0aGluZy5fbW9ja19wYXJlbnQsIG1vY2ssCiAgICAgICAgICAgICAgICAgICAgICAgICAiYXR0cmlidXRlIHBhcmVudCBub3Qgc2V0IGNvcnJlY3RseSIpCgoKICAgIGRlZiB0ZXN0X21ldGhvZF9jYWxsc19yZWNvcmRlZChzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgbW9jay5zb21ldGhpbmcoMywgZmlzaD1Ob25lKQogICAgICAgIG1vY2suc29tZXRoaW5nX2Vsc2Uuc29tZXRoaW5nKDYsIGNha2U9c2VudGluZWwuQ2FrZSkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLnNvbWV0aGluZ19lbHNlLm1ldGhvZF9jYWxscywKICAgICAgICAgICAgICAgICAgICAgICAgICBbKCJzb21ldGhpbmciLCAoNiwpLCB7J2Nha2UnOiBzZW50aW5lbC5DYWtlfSldLAogICAgICAgICAgICAgICAgICAgICAgICAgICJtZXRob2QgY2FsbHMgbm90IHJlY29yZGVkIGNvcnJlY3RseSIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1ldGhvZF9jYWxscywgWwogICAgICAgICAgICAoInNvbWV0aGluZyIsICgzLCksIHsnZmlzaCc6IE5vbmV9KSwKICAgICAgICAgICAgKCJzb21ldGhpbmdfZWxzZS5zb21ldGhpbmciLCAoNiwpLCB7J2Nha2UnOiBzZW50aW5lbC5DYWtlfSkKICAgICAgICBdLAogICAgICAgICAgICAibWV0aG9kIGNhbGxzIG5vdCByZWNvcmRlZCBjb3JyZWN0bHkiKQoKCiAgICBkZWYgdGVzdF9tZXRob2RfY2FsbHNfY29tcGFyZV9lYXNpbHkoc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2suc29tZXRoaW5nKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subWV0aG9kX2NhbGxzLCBbKCdzb21ldGhpbmcnLCldKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tZXRob2RfY2FsbHMsIFsoJ3NvbWV0aGluZycsICgpLCB7fSldKQoKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgbW9jay5zb21ldGhpbmcoJ2RpZmZlcmVudCcpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1ldGhvZF9jYWxscywgWygnc29tZXRoaW5nJywgKCdkaWZmZXJlbnQnLCkpXSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subWV0aG9kX2NhbGxzLAogICAgICAgICAgICAgICAgICAgICAgICAgWygnc29tZXRoaW5nJywgKCdkaWZmZXJlbnQnLCksIHt9KV0pCgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrLnNvbWV0aGluZyh4PTEpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1ldGhvZF9jYWxscywgWygnc29tZXRoaW5nJywgeyd4JzogMX0pXSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subWV0aG9kX2NhbGxzLCBbKCdzb21ldGhpbmcnLCAoKSwgeyd4JzogMX0pXSkKCiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2suc29tZXRoaW5nKCdkaWZmZXJlbnQnLCBzb21lPSdtb3JlJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subWV0aG9kX2NhbGxzLCBbCiAgICAgICAgICAgICgnc29tZXRoaW5nJywgKCdkaWZmZXJlbnQnLCksIHsnc29tZSc6ICdtb3JlJ30pCiAgICAgICAgXSkKCgogICAgZGVmIHRlc3Rfb25seV9hbGxvd2VkX21ldGhvZHNfZXhpc3Qoc2VsZik6CiAgICAgICAgZm9yIHNwZWMgaW4gWydzb21ldGhpbmcnXSwgKCdzb21ldGhpbmcnLCk6CiAgICAgICAgICAgIGZvciBhcmcgaW4gJ3NwZWMnLCAnc3BlY19zZXQnOgogICAgICAgICAgICAgICAgbW9jayA9IE1vY2soKip7YXJnOiBzcGVjfSkKCiAgICAgICAgICAgICAgICAjIHRoaXMgc2hvdWxkIGJlIGFsbG93ZWQKICAgICAgICAgICAgICAgIG1vY2suc29tZXRoaW5nCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1JlZ2V4KAogICAgICAgICAgICAgICAgICAgIEF0dHJpYnV0ZUVycm9yLAogICAgICAgICAgICAgICAgICAgICJNb2NrIG9iamVjdCBoYXMgbm8gYXR0cmlidXRlICdzb21ldGhpbmdfZWxzZSciLAogICAgICAgICAgICAgICAgICAgIGdldGF0dHIsIG1vY2ssICdzb21ldGhpbmdfZWxzZScKICAgICAgICAgICAgICAgICkKCgogICAgZGVmIHRlc3RfZnJvbV9zcGVjKHNlbGYpOgogICAgICAgIGNsYXNzIFNvbWV0aGluZyhvYmplY3QpOgogICAgICAgICAgICB4ID0gMwogICAgICAgICAgICBfX3NvbWV0aGluZ19fID0gTm9uZQogICAgICAgICAgICBkZWYgeShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgZGVmIHRlc3RfYXR0cmlidXRlcyhtb2NrKToKICAgICAgICAgICAgIyBzaG91bGQgd29yawogICAgICAgICAgICBtb2NrLngKICAgICAgICAgICAgbW9jay55CiAgICAgICAgICAgIG1vY2suX19zb21ldGhpbmdfXwogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1JlZ2V4KAogICAgICAgICAgICAgICAgQXR0cmlidXRlRXJyb3IsCiAgICAgICAgICAgICAgICAiTW9jayBvYmplY3QgaGFzIG5vIGF0dHJpYnV0ZSAneiciLAogICAgICAgICAgICAgICAgZ2V0YXR0ciwgbW9jaywgJ3onCiAgICAgICAgICAgICkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXNSZWdleCgKICAgICAgICAgICAgICAgIEF0dHJpYnV0ZUVycm9yLAogICAgICAgICAgICAgICAgIk1vY2sgb2JqZWN0IGhhcyBubyBhdHRyaWJ1dGUgJ19fZm9vYmFyX18nIiwKICAgICAgICAgICAgICAgIGdldGF0dHIsIG1vY2ssICdfX2Zvb2Jhcl9fJwogICAgICAgICAgICApCgogICAgICAgIHRlc3RfYXR0cmlidXRlcyhNb2NrKHNwZWM9U29tZXRoaW5nKSkKICAgICAgICB0ZXN0X2F0dHJpYnV0ZXMoTW9jayhzcGVjPVNvbWV0aGluZygpKSkKCgogICAgZGVmIHRlc3Rfd3JhcHNfY2FsbHMoc2VsZik6CiAgICAgICAgcmVhbCA9IE1vY2soKQoKICAgICAgICBtb2NrID0gTW9jayh3cmFwcz1yZWFsKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jaygpLCByZWFsKCkpCgogICAgICAgIHJlYWwucmVzZXRfbW9jaygpCgogICAgICAgIG1vY2soMSwgMiwgZmlzaD0zKQogICAgICAgIHJlYWwuYXNzZXJ0X2NhbGxlZF93aXRoKDEsIDIsIGZpc2g9MykKCgogICAgZGVmIHRlc3Rfd3JhcHNfY2FsbF93aXRoX25vbmRlZmF1bHRfcmV0dXJuX3ZhbHVlKHNlbGYpOgogICAgICAgIHJlYWwgPSBNb2NrKCkKCiAgICAgICAgbW9jayA9IE1vY2sod3JhcHM9cmVhbCkKICAgICAgICBtb2NrLnJldHVybl92YWx1ZSA9IDMKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrKCksIDMpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShyZWFsLmNhbGxlZCkKCgogICAgZGVmIHRlc3Rfd3JhcHNfYXR0cmlidXRlcyhzZWxmKToKICAgICAgICBjbGFzcyBSZWFsKG9iamVjdCk6CiAgICAgICAgICAgIGF0dHJpYnV0ZSA9IE1vY2soKQoKICAgICAgICByZWFsID0gUmVhbCgpCgogICAgICAgIG1vY2sgPSBNb2NrKHdyYXBzPXJlYWwpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmF0dHJpYnV0ZSgpLCByZWFsLmF0dHJpYnV0ZSgpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBsYW1iZGE6IG1vY2suZmlzaCkKCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChtb2NrLmF0dHJpYnV0ZSwgcmVhbC5hdHRyaWJ1dGUpCiAgICAgICAgcmVzdWx0ID0gbW9jay5hdHRyaWJ1dGUuZnJvZygxLCAyLCBmaXNoPTMpCiAgICAgICAgUmVhbC5hdHRyaWJ1dGUuZnJvZy5hc3NlcnRfY2FsbGVkX3dpdGgoMSwgMiwgZmlzaD0zKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LCBSZWFsLmF0dHJpYnV0ZS5mcm9nKCkpCgoKICAgIGRlZiB0ZXN0X2V4Y2VwdGlvbmFsX3NpZGVfZWZmZWN0KHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKHNpZGVfZWZmZWN0PUF0dHJpYnV0ZUVycm9yKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBtb2NrKQoKICAgICAgICBtb2NrID0gTW9jayhzaWRlX2VmZmVjdD1BdHRyaWJ1dGVFcnJvcignZm9vJykpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIG1vY2spCgoKICAgIGRlZiB0ZXN0X2Jhc2VleGNlcHRpb25hbF9zaWRlX2VmZmVjdChzZWxmKToKICAgICAgICBtb2NrID0gTW9jayhzaWRlX2VmZmVjdD1LZXlib2FyZEludGVycnVwdCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhLZXlib2FyZEludGVycnVwdCwgbW9jaykKCiAgICAgICAgbW9jayA9IE1vY2soc2lkZV9lZmZlY3Q9S2V5Ym9hcmRJbnRlcnJ1cHQoJ2ZvbycpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEtleWJvYXJkSW50ZXJydXB0LCBtb2NrKQoKCiAgICBkZWYgdGVzdF9hc3NlcnRfY2FsbGVkX3dpdGhfbWVzc2FnZShzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXNSZWdleChBc3NlcnRpb25FcnJvciwgJ05vdCBjYWxsZWQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF93aXRoKQoKCiAgICBkZWYgdGVzdF9fbmFtZV9fKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgbGFtYmRhOiBtb2NrLl9fbmFtZV9fKQoKICAgICAgICBtb2NrLl9fbmFtZV9fID0gJ2ZvbycKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suX19uYW1lX18sICdmb28nKQoKCiAgICBkZWYgdGVzdF9zcGVjX2xpc3Rfc3ViY2xhc3Moc2VsZik6CiAgICAgICAgY2xhc3MgU3ViKGxpc3QpOgogICAgICAgICAgICBwYXNzCiAgICAgICAgbW9jayA9IE1vY2soc3BlYz1TdWIoWydmb28nXSkpCgogICAgICAgIG1vY2suYXBwZW5kKDMpCiAgICAgICAgbW9jay5hcHBlbmQuYXNzZXJ0X2NhbGxlZF93aXRoKDMpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIG1vY2ssICdmb28nKQoKCiAgICBkZWYgdGVzdF9zcGVjX2NsYXNzKHNlbGYpOgogICAgICAgIGNsYXNzIFgob2JqZWN0KToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBtb2NrID0gTW9jayhzcGVjPVgpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzaW5zdGFuY2UobW9jaywgWCkpCgogICAgICAgIG1vY2sgPSBNb2NrKHNwZWM9WCgpKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShpc2luc3RhbmNlKG1vY2ssIFgpKQoKICAgICAgICBzZWxmLmFzc2VydElzKG1vY2suX19jbGFzc19fLCBYKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoTW9jaygpLl9fY2xhc3NfXy5fX25hbWVfXywgJ01vY2snKQoKICAgICAgICBtb2NrID0gTW9jayhzcGVjX3NldD1YKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShpc2luc3RhbmNlKG1vY2ssIFgpKQoKICAgICAgICBtb2NrID0gTW9jayhzcGVjX3NldD1YKCkpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzaW5zdGFuY2UobW9jaywgWCkpCgoKICAgIGRlZiB0ZXN0X3NldHRpbmdfYXR0cmlidXRlX3dpdGhfc3BlY19zZXQoc2VsZik6CiAgICAgICAgY2xhc3MgWChvYmplY3QpOgogICAgICAgICAgICB5ID0gMwoKICAgICAgICBtb2NrID0gTW9jayhzcGVjPVgpCiAgICAgICAgbW9jay54ID0gJ2ZvbycKCiAgICAgICAgbW9jayA9IE1vY2soc3BlY19zZXQ9WCkKICAgICAgICBkZWYgc2V0X2F0dHIoKToKICAgICAgICAgICAgbW9jay54ID0gJ2ZvbycKCiAgICAgICAgbW9jay55ID0gJ2ZvbycKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgc2V0X2F0dHIpCgoKICAgIGRlZiB0ZXN0X2NvcHkoc2VsZik6CiAgICAgICAgY3VycmVudCA9IHN5cy5nZXRyZWN1cnNpb25saW1pdCgpCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHN5cy5zZXRyZWN1cnNpb25saW1pdCwgY3VycmVudCkKCiAgICAgICAgIyBjYW4ndCB1c2Ugc3lzLm1heGludCBhcyB0aGlzIGRvZXNuJ3QgZXhpc3QgaW4gUHl0aG9uIDMKICAgICAgICBzeXMuc2V0cmVjdXJzaW9ubGltaXQoaW50KDEwZTgpKQogICAgICAgICMgdGhpcyBzZWdmYXVsdHMgd2l0aG91dCB0aGUgZml4IGluIHBsYWNlCiAgICAgICAgY29weS5jb3B5KE1vY2soKSkKCgogICAgZGVmIHRlc3Rfc3ViY2xhc3Nfd2l0aF9wcm9wZXJ0aWVzKHNlbGYpOgogICAgICAgIGNsYXNzIFN1YkNsYXNzKE1vY2spOgogICAgICAgICAgICBkZWYgX2dldChzZWxmKToKICAgICAgICAgICAgICAgIHJldHVybiAzCiAgICAgICAgICAgIGRlZiBfc2V0KHNlbGYsIHZhbHVlKToKICAgICAgICAgICAgICAgIHJhaXNlIE5hbWVFcnJvcignc3RyYW5nZSBlcnJvcicpCiAgICAgICAgICAgIHNvbWVfYXR0cmlidXRlID0gcHJvcGVydHkoX2dldCwgX3NldCkKCiAgICAgICAgcyA9IFN1YkNsYXNzKHNwZWNfc2V0PVN1YkNsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocy5zb21lX2F0dHJpYnV0ZSwgMykKCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgcy5zb21lX2F0dHJpYnV0ZSA9IDMKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhOYW1lRXJyb3IsIHRlc3QpCgogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHMuZm9vID0gJ2JhcicKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgdGVzdCkKCgogICAgZGVmIHRlc3Rfc2V0dGluZ19jYWxsKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBkZWYgX19jYWxsX18oc2VsZiwgYSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9tb2NrX2NhbGwoYSkKCiAgICAgICAgdHlwZShtb2NrKS5fX2NhbGxfXyA9IF9fY2FsbF9fCiAgICAgICAgbW9jaygnb25lJykKICAgICAgICBtb2NrLmFzc2VydF9jYWxsZWRfd2l0aCgnb25lJykKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrLCAnb25lJywgJ3R3bycpCgoKICAgIGRlZiB0ZXN0X2RpcihzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgYXR0cnMgPSBzZXQoZGlyKG1vY2spKQogICAgICAgIHR5cGVfYXR0cnMgPSBzZXQoW20gZm9yIG0gaW4gZGlyKE1vY2spIGlmIG5vdCBtLnN0YXJ0c3dpdGgoJ18nKV0pCgogICAgICAgICMgYWxsIHB1YmxpYyBhdHRyaWJ1dGVzIGZyb20gdGhlIHR5cGUgYXJlIGluY2x1ZGVkCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzZXQoKSwgdHlwZV9hdHRycyAtIGF0dHJzKQoKICAgICAgICAjIGNyZWF0ZXMgdGhlc2UgYXR0cmlidXRlcwogICAgICAgIG1vY2suYSwgbW9jay5iCiAgICAgICAgc2VsZi5hc3NlcnRJbignYScsIGRpcihtb2NrKSkKICAgICAgICBzZWxmLmFzc2VydEluKCdiJywgZGlyKG1vY2spKQoKICAgICAgICAjIGluc3RhbmNlIGF0dHJpYnV0ZXMKICAgICAgICBtb2NrLmMgPSBtb2NrLmQgPSBOb25lCiAgICAgICAgc2VsZi5hc3NlcnRJbignYycsIGRpcihtb2NrKSkKICAgICAgICBzZWxmLmFzc2VydEluKCdkJywgZGlyKG1vY2spKQoKICAgICAgICAjIG1hZ2ljIG1ldGhvZHMKICAgICAgICBtb2NrLl9faXRlcl9fID0gbGFtYmRhIHM6IGl0ZXIoW10pCiAgICAgICAgc2VsZi5hc3NlcnRJbignX19pdGVyX18nLCBkaXIobW9jaykpCgoKICAgIGRlZiB0ZXN0X2Rpcl9mcm9tX3NwZWMoc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soc3BlYz11bml0dGVzdC5UZXN0Q2FzZSkKICAgICAgICB0ZXN0Y2FzZV9hdHRycyA9IHNldChkaXIodW5pdHRlc3QuVGVzdENhc2UpKQogICAgICAgIGF0dHJzID0gc2V0KGRpcihtb2NrKSkKCiAgICAgICAgIyBhbGwgYXR0cmlidXRlcyBmcm9tIHRoZSBzcGVjIGFyZSBpbmNsdWRlZAogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc2V0KCksIHRlc3RjYXNlX2F0dHJzIC0gYXR0cnMpCgogICAgICAgICMgc2hhZG93IGEgc3lzIGF0dHJpYnV0ZQogICAgICAgIG1vY2sudmVyc2lvbiA9IDMKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGRpcihtb2NrKS5jb3VudCgndmVyc2lvbicpLCAxKQoKCiAgICBkZWYgdGVzdF9maWx0ZXJfZGlyKHNlbGYpOgogICAgICAgIHBhdGNoZXIgPSBwYXRjaC5vYmplY3QobW9jaywgJ0ZJTFRFUl9ESVInLCBGYWxzZSkKICAgICAgICBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIGF0dHJzID0gc2V0KGRpcihNb2NrKCkpKQogICAgICAgICAgICB0eXBlX2F0dHJzID0gc2V0KGRpcihNb2NrKSkKCiAgICAgICAgICAgICMgQUxMIGF0dHJpYnV0ZXMgZnJvbSB0aGUgdHlwZSBhcmUgaW5jbHVkZWQKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzZXQoKSwgdHlwZV9hdHRycyAtIGF0dHJzKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHBhdGNoZXIuc3RvcCgpCgoKICAgIGRlZiB0ZXN0X2NvbmZpZ3VyZV9tb2NrKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKGZvbz0nYmFyJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suZm9vLCAnYmFyJykKCiAgICAgICAgbW9jayA9IE1hZ2ljTW9jayhmb289J2JhcicpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmZvbywgJ2JhcicpCgogICAgICAgIGt3YXJncyA9IHsnc2lkZV9lZmZlY3QnOiBLZXlFcnJvciwgJ2Zvby5iYXIucmV0dXJuX3ZhbHVlJzogMzMsCiAgICAgICAgICAgICAgICAgICdmb28nOiBNYWdpY01vY2soKX0KICAgICAgICBtb2NrID0gTW9jaygqKmt3YXJncykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhLZXlFcnJvciwgbW9jaykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suZm9vLmJhcigpLCAzMykKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jay5mb28sIE1hZ2ljTW9jaykKCiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2suY29uZmlndXJlX21vY2soKiprd2FyZ3MpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoS2V5RXJyb3IsIG1vY2spCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmZvby5iYXIoKSwgMzMpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKG1vY2suZm9vLCBNYWdpY01vY2spCgoKICAgIGRlZiBhc3NlcnRSYWlzZXNXaXRoTXNnKHNlbGYsIGV4Y2VwdGlvbiwgbWVzc2FnZSwgZnVuYywgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAjIG5lZWRlZCBiZWNhdXNlIGFzc2VydFJhaXNlc1JlZ2V4IGRvZXNuJ3Qgd29yayBlYXNpbHkgd2l0aCBuZXdsaW5lcwogICAgICAgIHRyeToKICAgICAgICAgICAgZnVuYygqYXJncywgKiprd2FyZ3MpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBpbnN0YW5jZSA9IHN5cy5leGNfaW5mbygpWzFdCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShpbnN0YW5jZSwgZXhjZXB0aW9uKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgnRXhjZXB0aW9uICVyIG5vdCByYWlzZWQnICUgKGV4Y2VwdGlvbiwpKQoKICAgICAgICBtc2cgPSBzdHIoaW5zdGFuY2UpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtc2csIG1lc3NhZ2UpCgoKICAgIGRlZiB0ZXN0X2Fzc2VydF9jYWxsZWRfd2l0aF9mYWlsdXJlX21lc3NhZ2Uoc2VsZik6CiAgICAgICAgbW9jayA9IE5vbkNhbGxhYmxlTW9jaygpCgogICAgICAgIGV4cGVjdGVkID0gIm1vY2soMSwgJzInLCAzLCBiYXI9J2ZvbycpIgogICAgICAgIG1lc3NhZ2UgPSAnRXhwZWN0ZWQgY2FsbDogJXNcbk5vdCBjYWxsZWQnCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXNXaXRoTXNnKAogICAgICAgICAgICBBc3NlcnRpb25FcnJvciwgbWVzc2FnZSAlIChleHBlY3RlZCwpLAogICAgICAgICAgICBtb2NrLmFzc2VydF9jYWxsZWRfd2l0aCwgMSwgJzInLCAzLCBiYXI9J2ZvbycKICAgICAgICApCgogICAgICAgIG1vY2suZm9vKDEsICcyJywgMywgZm9vPSdmb28nKQoKCiAgICAgICAgYXNzZXJ0ZXJzID0gWwogICAgICAgICAgICBtb2NrLmZvby5hc3NlcnRfY2FsbGVkX3dpdGgsIG1vY2suZm9vLmFzc2VydF9jYWxsZWRfb25jZV93aXRoCiAgICAgICAgXQogICAgICAgIGZvciBtZXRoIGluIGFzc2VydGVyczoKICAgICAgICAgICAgYWN0dWFsID0gImZvbygxLCAnMicsIDMsIGZvbz0nZm9vJykiCiAgICAgICAgICAgIGV4cGVjdGVkID0gImZvbygxLCAnMicsIDMsIGJhcj0nZm9vJykiCiAgICAgICAgICAgIG1lc3NhZ2UgPSAnRXhwZWN0ZWQgY2FsbDogJXNcbkFjdHVhbCBjYWxsOiAlcycKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXNXaXRoTXNnKAogICAgICAgICAgICAgICAgQXNzZXJ0aW9uRXJyb3IsIG1lc3NhZ2UgJSAoZXhwZWN0ZWQsIGFjdHVhbCksCiAgICAgICAgICAgICAgICBtZXRoLCAxLCAnMicsIDMsIGJhcj0nZm9vJwogICAgICAgICAgICApCgogICAgICAgICMganVzdCBrd2FyZ3MKICAgICAgICBmb3IgbWV0aCBpbiBhc3NlcnRlcnM6CiAgICAgICAgICAgIGFjdHVhbCA9ICJmb28oMSwgJzInLCAzLCBmb289J2ZvbycpIgogICAgICAgICAgICBleHBlY3RlZCA9ICJmb28oYmFyPSdmb28nKSIKICAgICAgICAgICAgbWVzc2FnZSA9ICdFeHBlY3RlZCBjYWxsOiAlc1xuQWN0dWFsIGNhbGw6ICVzJwogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1dpdGhNc2coCiAgICAgICAgICAgICAgICBBc3NlcnRpb25FcnJvciwgbWVzc2FnZSAlIChleHBlY3RlZCwgYWN0dWFsKSwKICAgICAgICAgICAgICAgIG1ldGgsIGJhcj0nZm9vJwogICAgICAgICAgICApCgogICAgICAgICMganVzdCBhcmdzCiAgICAgICAgZm9yIG1ldGggaW4gYXNzZXJ0ZXJzOgogICAgICAgICAgICBhY3R1YWwgPSAiZm9vKDEsICcyJywgMywgZm9vPSdmb28nKSIKICAgICAgICAgICAgZXhwZWN0ZWQgPSAiZm9vKDEsIDIsIDMpIgogICAgICAgICAgICBtZXNzYWdlID0gJ0V4cGVjdGVkIGNhbGw6ICVzXG5BY3R1YWwgY2FsbDogJXMnCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzV2l0aE1zZygKICAgICAgICAgICAgICAgIEFzc2VydGlvbkVycm9yLCBtZXNzYWdlICUgKGV4cGVjdGVkLCBhY3R1YWwpLAogICAgICAgICAgICAgICAgbWV0aCwgMSwgMiwgMwogICAgICAgICAgICApCgogICAgICAgICMgZW1wdHkKICAgICAgICBmb3IgbWV0aCBpbiBhc3NlcnRlcnM6CiAgICAgICAgICAgIGFjdHVhbCA9ICJmb28oMSwgJzInLCAzLCBmb289J2ZvbycpIgogICAgICAgICAgICBleHBlY3RlZCA9ICJmb28oKSIKICAgICAgICAgICAgbWVzc2FnZSA9ICdFeHBlY3RlZCBjYWxsOiAlc1xuQWN0dWFsIGNhbGw6ICVzJwogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1dpdGhNc2coCiAgICAgICAgICAgICAgICBBc3NlcnRpb25FcnJvciwgbWVzc2FnZSAlIChleHBlY3RlZCwgYWN0dWFsKSwgbWV0aAogICAgICAgICAgICApCgoKICAgIGRlZiB0ZXN0X21vY2tfY2FsbHMoc2VsZik6CiAgICAgICAgbW9jayA9IE1hZ2ljTW9jaygpCgogICAgICAgICMgbmVlZCB0byBkbyB0aGlzIGJlY2F1c2UgTWFnaWNNb2NrLm1vY2tfY2FsbHMgdXNlZCB0byBqdXN0IHJldHVybgogICAgICAgICMgYSBNYWdpY01vY2sgd2hpY2ggYWxzbyByZXR1cm5lZCBhIE1hZ2ljTW9jayB3aGVuIF9fZXFfXyB3YXMgY2FsbGVkCiAgICAgICAgc2VsZi5hc3NlcnRJcyhtb2NrLm1vY2tfY2FsbHMgPT0gW10sIFRydWUpCgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgIG1vY2soKQogICAgICAgIGV4cGVjdGVkID0gWygnJywgKCksIHt9KV0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subW9ja19jYWxscywgZXhwZWN0ZWQpCgogICAgICAgIG1vY2suZm9vKCkKICAgICAgICBleHBlY3RlZC5hcHBlbmQoY2FsbC5mb28oKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subW9ja19jYWxscywgZXhwZWN0ZWQpCiAgICAgICAgIyBpbnRlcm1lZGlhdGUgbW9ja19jYWxscyB3b3JrIHRvbwogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5mb28ubW9ja19jYWxscywgWygnJywgKCksIHt9KV0pCgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgIG1vY2soKS5mb28oMSwgMiwgMywgYT00LCBiPTUpCiAgICAgICAgZXhwZWN0ZWQgPSBbCiAgICAgICAgICAgICgnJywgKCksIHt9KSwgKCcoKS5mb28nLCAoMSwgMiwgMyksIGRpY3QoYT00LCBiPTUpKQogICAgICAgIF0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subW9ja19jYWxscywgZXhwZWN0ZWQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLnJldHVybl92YWx1ZS5mb28ubW9ja19jYWxscywKICAgICAgICAgICAgICAgICAgICAgICAgIFsoJycsICgxLCAyLCAzKSwgZGljdChhPTQsIGI9NSkpXSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sucmV0dXJuX3ZhbHVlLm1vY2tfY2FsbHMsCiAgICAgICAgICAgICAgICAgICAgICAgICBbKCdmb28nLCAoMSwgMiwgMyksIGRpY3QoYT00LCBiPTUpKV0pCgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgIG1vY2soKS5mb28uYmFyKCkuYmF6KCkKICAgICAgICBleHBlY3RlZCA9IFsKICAgICAgICAgICAgKCcnLCAoKSwge30pLCAoJygpLmZvby5iYXInLCAoKSwge30pLAogICAgICAgICAgICAoJygpLmZvby5iYXIoKS5iYXonLCAoKSwge30pCiAgICAgICAgXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tb2NrX2NhbGxzLCBleHBlY3RlZCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2soKS5tb2NrX2NhbGxzLAogICAgICAgICAgICAgICAgICAgICAgICAgY2FsbC5mb28uYmFyKCkuYmF6KCkuY2FsbF9saXN0KCkpCgogICAgICAgIGZvciBrd2FyZ3MgaW4gZGljdCgpLCBkaWN0KG5hbWU9J2JhcicpOgogICAgICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCoqa3dhcmdzKQogICAgICAgICAgICBpbnQobW9jay5mb28pCiAgICAgICAgICAgIGV4cGVjdGVkID0gWygnZm9vLl9faW50X18nLCAoKSwge30pXQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subW9ja19jYWxscywgZXhwZWN0ZWQpCgogICAgICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCoqa3dhcmdzKQogICAgICAgICAgICBtb2NrLmEoKSgpCiAgICAgICAgICAgIGV4cGVjdGVkID0gWygnYScsICgpLCB7fSksICgnYSgpJywgKCksIHt9KV0KICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1vY2tfY2FsbHMsIGV4cGVjdGVkKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suYSgpLm1vY2tfY2FsbHMsIFtjYWxsKCldKQoKICAgICAgICAgICAgbW9jayA9IE1hZ2ljTW9jaygqKmt3YXJncykKICAgICAgICAgICAgbW9jaygxKSgyKSgzKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subW9ja19jYWxscywgY2FsbCgxKSgyKSgzKS5jYWxsX2xpc3QoKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrKCkubW9ja19jYWxscywgY2FsbCgyKSgzKS5jYWxsX2xpc3QoKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrKCkoKS5tb2NrX2NhbGxzLCBjYWxsKDMpLmNhbGxfbGlzdCgpKQoKICAgICAgICAgICAgbW9jayA9IE1hZ2ljTW9jaygqKmt3YXJncykKICAgICAgICAgICAgbW9jaygxKSgyKSgzKS5hLmIuYyg0KQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subW9ja19jYWxscywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsKDEpKDIpKDMpLmEuYi5jKDQpLmNhbGxfbGlzdCgpKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2soKS5tb2NrX2NhbGxzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGwoMikoMykuYS5iLmMoNCkuY2FsbF9saXN0KCkpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jaygpKCkubW9ja19jYWxscywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsKDMpLmEuYi5jKDQpLmNhbGxfbGlzdCgpKQoKICAgICAgICAgICAgbW9jayA9IE1hZ2ljTW9jaygqKmt3YXJncykKICAgICAgICAgICAgaW50KG1vY2soKS5mb28uYmFyKCkuYmF6KCkpCiAgICAgICAgICAgIGxhc3RfY2FsbCA9ICgnKCkuZm9vLmJhcigpLmJheigpLl9faW50X18nLCAoKSwge30pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tb2NrX2NhbGxzWy0xXSwgbGFzdF9jYWxsKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2soKS5tb2NrX2NhbGxzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGwuZm9vLmJhcigpLmJheigpLl9faW50X18oKS5jYWxsX2xpc3QoKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrKCkuZm9vLmJhcigpLm1vY2tfY2FsbHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbC5iYXooKS5fX2ludF9fKCkuY2FsbF9saXN0KCkpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jaygpLmZvby5iYXIoKS5iYXoubW9ja19jYWxscywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsKCkuX19pbnRfXygpLmNhbGxfbGlzdCgpKQoKCiAgICBkZWYgdGVzdF9zdWJjbGFzc2luZyhzZWxmKToKICAgICAgICBjbGFzcyBTdWJjbGFzcyhNb2NrKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBtb2NrID0gU3ViY2xhc3MoKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrLmZvbywgU3ViY2xhc3MpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKG1vY2soKSwgU3ViY2xhc3MpCgogICAgICAgIGNsYXNzIFN1YmNsYXNzKE1vY2spOgogICAgICAgICAgICBkZWYgX2dldF9jaGlsZF9tb2NrKHNlbGYsICoqa3dhcmdzKToKICAgICAgICAgICAgICAgIHJldHVybiBNb2NrKCoqa3dhcmdzKQoKICAgICAgICBtb2NrID0gU3ViY2xhc3MoKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90SXNJbnN0YW5jZShtb2NrLmZvbywgU3ViY2xhc3MpCiAgICAgICAgc2VsZi5hc3NlcnROb3RJc0luc3RhbmNlKG1vY2soKSwgU3ViY2xhc3MpCgoKICAgIGRlZiB0ZXN0X2FyZ19saXN0cyhzZWxmKToKICAgICAgICBtb2NrcyA9IFsKICAgICAgICAgICAgTW9jaygpLAogICAgICAgICAgICBNYWdpY01vY2soKSwKICAgICAgICAgICAgTm9uQ2FsbGFibGVNb2NrKCksCiAgICAgICAgICAgIE5vbkNhbGxhYmxlTWFnaWNNb2NrKCkKICAgICAgICBdCgogICAgICAgIGRlZiBhc3NlcnRfYXR0cnMobW9jayk6CiAgICAgICAgICAgIG5hbWVzID0gJ2NhbGxfYXJnc19saXN0JywgJ21ldGhvZF9jYWxscycsICdtb2NrX2NhbGxzJwogICAgICAgICAgICBmb3IgbmFtZSBpbiBuYW1lczoKICAgICAgICAgICAgICAgIGF0dHIgPSBnZXRhdHRyKG1vY2ssIG5hbWUpCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UoYXR0ciwgX0NhbGxMaXN0KQogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGF0dHIsIGxpc3QpCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGF0dHIsIFtdKQoKICAgICAgICBmb3IgbW9jayBpbiBtb2NrczoKICAgICAgICAgICAgYXNzZXJ0X2F0dHJzKG1vY2spCgogICAgICAgICAgICBpZiBjYWxsYWJsZShtb2NrKToKICAgICAgICAgICAgICAgIG1vY2soKQogICAgICAgICAgICAgICAgbW9jaygxLCAyKQogICAgICAgICAgICAgICAgbW9jayhhPTMpCgogICAgICAgICAgICAgICAgbW9jay5yZXNldF9tb2NrKCkKICAgICAgICAgICAgICAgIGFzc2VydF9hdHRycyhtb2NrKQoKICAgICAgICAgICAgbW9jay5mb28oKQogICAgICAgICAgICBtb2NrLmZvby5iYXIoMSwgYT0zKQogICAgICAgICAgICBtb2NrLmZvbygxKS5iYXIoKS5iYXooMykKCiAgICAgICAgICAgIG1vY2sucmVzZXRfbW9jaygpCiAgICAgICAgICAgIGFzc2VydF9hdHRycyhtb2NrKQoKCiAgICBkZWYgdGVzdF9jYWxsX2FyZ3NfdHdvX3R1cGxlKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrKDEsIGE9MykKICAgICAgICBtb2NrKDIsIGI9NCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4obW9jay5jYWxsX2FyZ3MpLCAyKQogICAgICAgIGFyZ3MsIGt3YXJncyA9IG1vY2suY2FsbF9hcmdzCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCAoMiwpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoa3dhcmdzLCBkaWN0KGI9NCkpCgogICAgICAgIGV4cGVjdGVkX2xpc3QgPSBbKCgxLCksIGRpY3QoYT0zKSksICgoMiwpLCBkaWN0KGI9NCkpXQogICAgICAgIGZvciBleHBlY3RlZCwgY2FsbF9hcmdzIGluIHppcChleHBlY3RlZF9saXN0LCBtb2NrLmNhbGxfYXJnc19saXN0KToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4oY2FsbF9hcmdzKSwgMikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChleHBlY3RlZFswXSwgY2FsbF9hcmdzWzBdKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV4cGVjdGVkWzFdLCBjYWxsX2FyZ3NbMV0pCgoKICAgIGRlZiB0ZXN0X3NpZGVfZWZmZWN0X2l0ZXJhdG9yKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKHNpZGVfZWZmZWN0PWl0ZXIoWzEsIDIsIDNdKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFttb2NrKCksIG1vY2soKSwgbW9jaygpXSwgWzEsIDIsIDNdKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFN0b3BJdGVyYXRpb24sIG1vY2spCgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soc2lkZV9lZmZlY3Q9WydhJywgJ2InLCAnYyddKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoW21vY2soKSwgbW9jaygpLCBtb2NrKCldLCBbJ2EnLCAnYicsICdjJ10pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoU3RvcEl0ZXJhdGlvbiwgbW9jaykKCiAgICAgICAgbW9jayA9IE1vY2soc2lkZV9lZmZlY3Q9J2doaScpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChbbW9jaygpLCBtb2NrKCksIG1vY2soKV0sIFsnZycsICdoJywgJ2knXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhTdG9wSXRlcmF0aW9uLCBtb2NrKQoKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgcGFzcwogICAgICAgIG1vY2sgPSBNYWdpY01vY2soc2lkZV9lZmZlY3Q9Rm9vKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrKCksIEZvbykKCiAgICAgICAgbW9jayA9IE1vY2soc2lkZV9lZmZlY3Q9SXRlcigpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoW21vY2soKSwgbW9jaygpLCBtb2NrKCksIG1vY2soKV0sCiAgICAgICAgICAgICAgICAgICAgICAgICBbJ3RoaXMnLCAnaXMnLCAnYW4nLCAnaXRlciddKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFN0b3BJdGVyYXRpb24sIG1vY2spCgoKICAgIGRlZiB0ZXN0X3NpZGVfZWZmZWN0X2l0ZXJhdG9yX2V4Y2VwdGlvbnMoc2VsZik6CiAgICAgICAgZm9yIEtsYXNzIGluIE1vY2ssIE1hZ2ljTW9jazoKICAgICAgICAgICAgaXRlcmFibGUgPSAoVmFsdWVFcnJvciwgMywgS2V5RXJyb3IsIDYpCiAgICAgICAgICAgIG0gPSBLbGFzcyhzaWRlX2VmZmVjdD1pdGVyYWJsZSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVmFsdWVFcnJvciwgbSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtKCksIDMpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEtleUVycm9yLCBtKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0oKSwgNikKCgogICAgZGVmIHRlc3Rfc2lkZV9lZmZlY3Rfc2V0dGluZ19pdGVyYXRvcihzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgbW9jay5zaWRlX2VmZmVjdCA9IGl0ZXIoWzEsIDIsIDNdKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoW21vY2soKSwgbW9jaygpLCBtb2NrKCldLCBbMSwgMiwgM10pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoU3RvcEl0ZXJhdGlvbiwgbW9jaykKICAgICAgICBzaWRlX2VmZmVjdCA9IG1vY2suc2lkZV9lZmZlY3QKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc2lkZV9lZmZlY3QsIHR5cGUoaXRlcihbXSkpKQoKICAgICAgICBtb2NrLnNpZGVfZWZmZWN0ID0gWydhJywgJ2InLCAnYyddCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChbbW9jaygpLCBtb2NrKCksIG1vY2soKV0sIFsnYScsICdiJywgJ2MnXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhTdG9wSXRlcmF0aW9uLCBtb2NrKQogICAgICAgIHNpZGVfZWZmZWN0ID0gbW9jay5zaWRlX2VmZmVjdAogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShzaWRlX2VmZmVjdCwgdHlwZShpdGVyKFtdKSkpCgogICAgICAgIHRoaXNfaXRlciA9IEl0ZXIoKQogICAgICAgIG1vY2suc2lkZV9lZmZlY3QgPSB0aGlzX2l0ZXIKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFttb2NrKCksIG1vY2soKSwgbW9jaygpLCBtb2NrKCldLAogICAgICAgICAgICAgICAgICAgICAgICAgWyd0aGlzJywgJ2lzJywgJ2FuJywgJ2l0ZXInXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhTdG9wSXRlcmF0aW9uLCBtb2NrKQogICAgICAgIHNlbGYuYXNzZXJ0SXMobW9jay5zaWRlX2VmZmVjdCwgdGhpc19pdGVyKQoKCiAgICBkZWYgdGVzdF9hc3NlcnRfaGFzX2NhbGxzX2FueV9vcmRlcihzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgbW9jaygxLCAyKQogICAgICAgIG1vY2soYT0zKQogICAgICAgIG1vY2soMywgNCkKICAgICAgICBtb2NrKGI9NikKICAgICAgICBtb2NrKGI9NikKCiAgICAgICAga2FsbHMgPSBbCiAgICAgICAgICAgIGNhbGwoMSwgMiksICh7J2EnOiAzfSwpLAogICAgICAgICAgICAoKDMsIDQpLCksICgoKSwgeydhJzogM30pLAogICAgICAgICAgICAoJycsICgxLCAyKSksICgnJywgeydhJzogM30pLAogICAgICAgICAgICAoJycsICgxLCAyKSwge30pLCAoJycsICgpLCB7J2EnOiAzfSkKICAgICAgICBdCiAgICAgICAgZm9yIGthbGwgaW4ga2FsbHM6CiAgICAgICAgICAgIG1vY2suYXNzZXJ0X2hhc19jYWxscyhba2FsbF0sIGFueV9vcmRlcj1UcnVlKQoKICAgICAgICBmb3Iga2FsbCBpbiBjYWxsKDEsICcyJyksIGNhbGwoYj0zKSwgY2FsbCgpLCAzLCBOb25lLCAnZm9vJzoKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgICAgICBBc3NlcnRpb25FcnJvciwgbW9jay5hc3NlcnRfaGFzX2NhbGxzLAogICAgICAgICAgICAgICAgW2thbGxdLCBhbnlfb3JkZXI9VHJ1ZQogICAgICAgICAgICApCgogICAgICAgIGthbGxfbGlzdHMgPSBbCiAgICAgICAgICAgIFtjYWxsKDEsIDIpLCBjYWxsKGI9NildLAogICAgICAgICAgICBbY2FsbCgzLCA0KSwgY2FsbCgxLCAyKV0sCiAgICAgICAgICAgIFtjYWxsKGI9NiksIGNhbGwoYj02KV0sCiAgICAgICAgXQoKICAgICAgICBmb3Iga2FsbF9saXN0IGluIGthbGxfbGlzdHM6CiAgICAgICAgICAgIG1vY2suYXNzZXJ0X2hhc19jYWxscyhrYWxsX2xpc3QsIGFueV9vcmRlcj1UcnVlKQoKICAgICAgICBrYWxsX2xpc3RzID0gWwogICAgICAgICAgICBbY2FsbChiPTYpLCBjYWxsKGI9NiksIGNhbGwoYj02KV0sCiAgICAgICAgICAgIFtjYWxsKDEsIDIpLCBjYWxsKDEsIDIpXSwKICAgICAgICAgICAgW2NhbGwoMywgNCksIGNhbGwoMSwgMiksIGNhbGwoNSwgNyldLAogICAgICAgICAgICBbY2FsbChiPTYpLCBjYWxsKDMsIDQpLCBjYWxsKGI9NiksIGNhbGwoMSwgMiksIGNhbGwoYj02KV0sCiAgICAgICAgXQogICAgICAgIGZvciBrYWxsX2xpc3QgaW4ga2FsbF9saXN0czoKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgICAgICBBc3NlcnRpb25FcnJvciwgbW9jay5hc3NlcnRfaGFzX2NhbGxzLAogICAgICAgICAgICAgICAga2FsbF9saXN0LCBhbnlfb3JkZXI9VHJ1ZQogICAgICAgICAgICApCgogICAgZGVmIHRlc3RfYXNzZXJ0X2hhc19jYWxscyhzZWxmKToKICAgICAgICBrYWxsczEgPSBbCiAgICAgICAgICAgICAgICBjYWxsKDEsIDIpLCAoeydhJzogM30sKSwKICAgICAgICAgICAgICAgICgoMywgNCksKSwgY2FsbChiPTYpLAogICAgICAgICAgICAgICAgKCcnLCAoMSwpLCB7J2InOiA2fSksCiAgICAgICAgXQogICAgICAgIGthbGxzMiA9IFtjYWxsLmZvbygpLCBjYWxsLmJhcigxKV0KICAgICAgICBrYWxsczIuZXh0ZW5kKGNhbGwuc3BhbSgpLmJheihhPTMpLmNhbGxfbGlzdCgpKQogICAgICAgIGthbGxzMi5leHRlbmQoY2FsbC5iYW0oc2V0KCksIGZvbz17fSkuZmlzaChbMV0pLmNhbGxfbGlzdCgpKQoKICAgICAgICBtb2NrcyA9IFtdCiAgICAgICAgZm9yIG1vY2sgaW4gTW9jaygpLCBNYWdpY01vY2soKToKICAgICAgICAgICAgbW9jaygxLCAyKQogICAgICAgICAgICBtb2NrKGE9MykKICAgICAgICAgICAgbW9jaygzLCA0KQogICAgICAgICAgICBtb2NrKGI9NikKICAgICAgICAgICAgbW9jaygxLCBiPTYpCiAgICAgICAgICAgIG1vY2tzLmFwcGVuZCgobW9jaywga2FsbHMxKSkKCiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2suZm9vKCkKICAgICAgICBtb2NrLmJhcigxKQogICAgICAgIG1vY2suc3BhbSgpLmJheihhPTMpCiAgICAgICAgbW9jay5iYW0oc2V0KCksIGZvbz17fSkuZmlzaChbMV0pCiAgICAgICAgbW9ja3MuYXBwZW5kKChtb2NrLCBrYWxsczIpKQoKICAgICAgICBmb3IgbW9jaywga2FsbHMgaW4gbW9ja3M6CiAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKGxlbihrYWxscykpOgogICAgICAgICAgICAgICAgZm9yIHN0ZXAgaW4gMSwgMiwgMzoKICAgICAgICAgICAgICAgICAgICB0aGVzZSA9IGthbGxzW2k6aStzdGVwXQogICAgICAgICAgICAgICAgICAgIG1vY2suYXNzZXJ0X2hhc19jYWxscyh0aGVzZSkKCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKHRoZXNlKSA+IDE6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQXNzZXJ0aW9uRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2NrLmFzc2VydF9oYXNfY2FsbHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0KHJldmVyc2VkKHRoZXNlKSkKICAgICAgICAgICAgICAgICAgICAgICAgKQoKCiAgICBkZWYgdGVzdF9hc3NlcnRfYW55X2NhbGwoc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2soMSwgMikKICAgICAgICBtb2NrKGE9MykKICAgICAgICBtb2NrKDEsIGI9NikKCiAgICAgICAgbW9jay5hc3NlcnRfYW55X2NhbGwoMSwgMikKICAgICAgICBtb2NrLmFzc2VydF9hbnlfY2FsbChhPTMpCiAgICAgICAgbW9jay5hc3NlcnRfYW55X2NhbGwoMSwgYj02KQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcygKICAgICAgICAgICAgQXNzZXJ0aW9uRXJyb3IsCiAgICAgICAgICAgIG1vY2suYXNzZXJ0X2FueV9jYWxsCiAgICAgICAgKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKAogICAgICAgICAgICBBc3NlcnRpb25FcnJvciwKICAgICAgICAgICAgbW9jay5hc3NlcnRfYW55X2NhbGwsCiAgICAgICAgICAgIDEsIDMKICAgICAgICApCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgIEFzc2VydGlvbkVycm9yLAogICAgICAgICAgICBtb2NrLmFzc2VydF9hbnlfY2FsbCwKICAgICAgICAgICAgYT00CiAgICAgICAgKQoKCiAgICBkZWYgdGVzdF9tb2NrX2NhbGxzX2NyZWF0ZV9hdXRvc3BlYyhzZWxmKToKICAgICAgICBkZWYgZihhLCBiKToKICAgICAgICAgICAgcGFzcwogICAgICAgIG9iaiA9IEl0ZXIoKQogICAgICAgIG9iai5mID0gZgoKICAgICAgICBmdW5jcyA9IFsKICAgICAgICAgICAgY3JlYXRlX2F1dG9zcGVjKGYpLAogICAgICAgICAgICBjcmVhdGVfYXV0b3NwZWMob2JqKS5mCiAgICAgICAgXQogICAgICAgIGZvciBmdW5jIGluIGZ1bmNzOgogICAgICAgICAgICBmdW5jKDEsIDIpCiAgICAgICAgICAgIGZ1bmMoMywgNCkKCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoCiAgICAgICAgICAgICAgICBmdW5jLm1vY2tfY2FsbHMsIFtjYWxsKDEsIDIpLCBjYWxsKDMsIDQpXQogICAgICAgICAgICApCgoKICAgIGRlZiB0ZXN0X21vY2tfYWRkX3NwZWMoc2VsZik6CiAgICAgICAgY2xhc3MgX09uZShvYmplY3QpOgogICAgICAgICAgICBvbmUgPSAxCiAgICAgICAgY2xhc3MgX1R3byhvYmplY3QpOgogICAgICAgICAgICB0d28gPSAyCiAgICAgICAgY2xhc3MgQW55dGhpbmcob2JqZWN0KToKICAgICAgICAgICAgb25lID0gdHdvID0gdGhyZWUgPSAnZm91cicKCiAgICAgICAga2xhc3NlcyA9IFsKICAgICAgICAgICAgTW9jaywgTWFnaWNNb2NrLCBOb25DYWxsYWJsZU1vY2ssIE5vbkNhbGxhYmxlTWFnaWNNb2NrCiAgICAgICAgXQogICAgICAgIGZvciBLbGFzcyBpbiBsaXN0KGtsYXNzZXMpOgogICAgICAgICAgICBrbGFzc2VzLmFwcGVuZChsYW1iZGEgSz1LbGFzczogSyhzcGVjPUFueXRoaW5nKSkKICAgICAgICAgICAga2xhc3Nlcy5hcHBlbmQobGFtYmRhIEs9S2xhc3M6IEsoc3BlY19zZXQ9QW55dGhpbmcpKQoKICAgICAgICBmb3IgS2xhc3MgaW4ga2xhc3NlczoKICAgICAgICAgICAgZm9yIGt3YXJncyBpbiBkaWN0KCksIGRpY3Qoc3BlY19zZXQ9VHJ1ZSk6CiAgICAgICAgICAgICAgICBtb2NrID0gS2xhc3MoKQogICAgICAgICAgICAgICAgI25vIGVycm9yCiAgICAgICAgICAgICAgICBtb2NrLm9uZSwgbW9jay50d28sIG1vY2sudGhyZWUKCiAgICAgICAgICAgICAgICBmb3IgT25lLCBUd28gaW4gWyhfT25lLCBfVHdvKSwgKFsnb25lJ10sIFsndHdvJ10pXToKICAgICAgICAgICAgICAgICAgICBmb3Iga3dhcmdzIGluIGRpY3QoKSwgZGljdChzcGVjX3NldD1UcnVlKToKICAgICAgICAgICAgICAgICAgICAgICAgbW9jay5tb2NrX2FkZF9zcGVjKE9uZSwgKiprd2FyZ3MpCgogICAgICAgICAgICAgICAgICAgICAgICBtb2NrLm9uZQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEF0dHJpYnV0ZUVycm9yLCBnZXRhdHRyLCBtb2NrLCAndHdvJwogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIG1vY2ssICd0aHJlZScKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICBpZiAnc3BlY19zZXQnIGluIGt3YXJnczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEF0dHJpYnV0ZUVycm9yLCBzZXRhdHRyLCBtb2NrLCAndGhyZWUnLCBOb25lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCgogICAgICAgICAgICAgICAgICAgICAgICBtb2NrLm1vY2tfYWRkX3NwZWMoVHdvLCAqKmt3YXJncykKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgbW9jaywgJ29uZScKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICBtb2NrLnR3bwogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEF0dHJpYnV0ZUVycm9yLCBnZXRhdHRyLCBtb2NrLCAndGhyZWUnCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ3NwZWNfc2V0JyBpbiBrd2FyZ3M6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcygKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBdHRyaWJ1dGVFcnJvciwgc2V0YXR0ciwgbW9jaywgJ3RocmVlJywgTm9uZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAjIG5vdGUgdGhhdCBjcmVhdGluZyBhIG1vY2ssIHNldHRpbmcgYW4gaW5zdGFuY2UgYXR0cmlidXRlLCBhbmQKICAgICAgICAgICAgIyAqdGhlbiogc2V0dGluZyBhIHNwZWMgZG9lc24ndCB3b3JrLiBOb3QgdGhlIGludGVuZGVkIHVzZSBjYXNlCgoKICAgIGRlZiB0ZXN0X21vY2tfYWRkX3NwZWNfbWFnaWNfbWV0aG9kcyhzZWxmKToKICAgICAgICBmb3IgS2xhc3MgaW4gTWFnaWNNb2NrLCBOb25DYWxsYWJsZU1hZ2ljTW9jazoKICAgICAgICAgICAgbW9jayA9IEtsYXNzKCkKICAgICAgICAgICAgaW50KG1vY2spCgogICAgICAgICAgICBtb2NrLm1vY2tfYWRkX3NwZWMob2JqZWN0KQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGludCwgbW9jaykKCiAgICAgICAgICAgIG1vY2sgPSBLbGFzcygpCiAgICAgICAgICAgIG1vY2tbJ2ZvbyddCiAgICAgICAgICAgIG1vY2suX19pbnRfXy5yZXR1cm5fdmFsdWUgPTQKCiAgICAgICAgICAgIG1vY2subW9ja19hZGRfc3BlYyhpbnQpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoaW50KG1vY2spLCA0KQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGxhbWJkYTogbW9ja1snZm9vJ10pCgoKICAgIGRlZiB0ZXN0X2FkZGluZ19jaGlsZF9tb2NrKHNlbGYpOgogICAgICAgIGZvciBLbGFzcyBpbiBOb25DYWxsYWJsZU1vY2ssIE1vY2ssIE1hZ2ljTW9jaywgTm9uQ2FsbGFibGVNYWdpY01vY2s6CiAgICAgICAgICAgIG1vY2sgPSBLbGFzcygpCgogICAgICAgICAgICBtb2NrLmZvbyA9IE1vY2soKQogICAgICAgICAgICBtb2NrLmZvbygpCgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subWV0aG9kX2NhbGxzLCBbY2FsbC5mb28oKV0pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tb2NrX2NhbGxzLCBbY2FsbC5mb28oKV0pCgogICAgICAgICAgICBtb2NrID0gS2xhc3MoKQogICAgICAgICAgICBtb2NrLmJhciA9IE1vY2sobmFtZT0nbmFtZScpCiAgICAgICAgICAgIG1vY2suYmFyKCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1ldGhvZF9jYWxscywgW10pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tb2NrX2NhbGxzLCBbXSkKCiAgICAgICAgICAgICMgbW9jayB3aXRoIGFuIGV4aXN0aW5nIF9uZXdfcGFyZW50IGJ1dCBubyBuYW1lCiAgICAgICAgICAgIG1vY2sgPSBLbGFzcygpCiAgICAgICAgICAgIG1vY2suYmF6ID0gTWFnaWNNb2NrKCkoKQogICAgICAgICAgICBtb2NrLmJheigpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tZXRob2RfY2FsbHMsIFtdKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subW9ja19jYWxscywgW10pCgoKICAgIGRlZiB0ZXN0X2FkZGluZ19yZXR1cm5fdmFsdWVfbW9jayhzZWxmKToKICAgICAgICBmb3IgS2xhc3MgaW4gTW9jaywgTWFnaWNNb2NrOgogICAgICAgICAgICBtb2NrID0gS2xhc3MoKQogICAgICAgICAgICBtb2NrLnJldHVybl92YWx1ZSA9IE1hZ2ljTW9jaygpCgogICAgICAgICAgICBtb2NrKCkoKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subW9ja19jYWxscywgW2NhbGwoKSwgY2FsbCgpKCldKQoKCiAgICBkZWYgdGVzdF9tYW5hZ2VyX21vY2soc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKG9iamVjdCk6CiAgICAgICAgICAgIG9uZSA9ICdvbmUnCiAgICAgICAgICAgIHR3byA9ICd0d28nCiAgICAgICAgbWFuYWdlciA9IE1vY2soKQogICAgICAgIHAxID0gcGF0Y2gub2JqZWN0KEZvbywgJ29uZScpCiAgICAgICAgcDIgPSBwYXRjaC5vYmplY3QoRm9vLCAndHdvJykKCiAgICAgICAgbW9ja19vbmUgPSBwMS5zdGFydCgpCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHAxLnN0b3ApCiAgICAgICAgbW9ja190d28gPSBwMi5zdGFydCgpCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHAyLnN0b3ApCgogICAgICAgIG1hbmFnZXIuYXR0YWNoX21vY2sobW9ja19vbmUsICdvbmUnKQogICAgICAgIG1hbmFnZXIuYXR0YWNoX21vY2sobW9ja190d28sICd0d28nKQoKICAgICAgICBGb28udHdvKCkKICAgICAgICBGb28ub25lKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtYW5hZ2VyLm1vY2tfY2FsbHMsIFtjYWxsLnR3bygpLCBjYWxsLm9uZSgpXSkKCgogICAgZGVmIHRlc3RfbWFnaWNfbWV0aG9kc19tb2NrX2NhbGxzKHNlbGYpOgogICAgICAgIGZvciBLbGFzcyBpbiBNb2NrLCBNYWdpY01vY2s6CiAgICAgICAgICAgIG0gPSBLbGFzcygpCiAgICAgICAgICAgIG0uX19pbnRfXyA9IE1vY2socmV0dXJuX3ZhbHVlPTMpCiAgICAgICAgICAgIG0uX19mbG9hdF9fID0gTWFnaWNNb2NrKHJldHVybl92YWx1ZT0zLjApCiAgICAgICAgICAgIGludChtKQogICAgICAgICAgICBmbG9hdChtKQoKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtLm1vY2tfY2FsbHMsIFtjYWxsLl9faW50X18oKSwgY2FsbC5fX2Zsb2F0X18oKV0pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobS5tZXRob2RfY2FsbHMsIFtdKQoKCiAgICBkZWYgdGVzdF9hdHRyaWJ1dGVfZGVsZXRpb24oc2VsZik6CiAgICAgICAgIyB0aGlzIGJlaGF2aW91ciBpc24ndCAqdXNlZnVsKiwgYnV0IGF0IGxlYXN0IGl0J3Mgbm93IHRlc3RlZC4uLgogICAgICAgIGZvciBLbGFzcyBpbiBNb2NrLCBNYWdpY01vY2ssIE5vbkNhbGxhYmxlTWFnaWNNb2NrLCBOb25DYWxsYWJsZU1vY2s6CiAgICAgICAgICAgIG0gPSBLbGFzcygpCiAgICAgICAgICAgIG9yaWdpbmFsID0gbS5mb28KICAgICAgICAgICAgbS5mb28gPSAzCiAgICAgICAgICAgIGRlbCBtLmZvbwogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0uZm9vLCBvcmlnaW5hbCkKCiAgICAgICAgICAgIG5ldyA9IG0uZm9vID0gTW9jaygpCiAgICAgICAgICAgIGRlbCBtLmZvbwogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0uZm9vLCBuZXcpCgoKICAgIGRlZiB0ZXN0X21vY2tfcGFyZW50cyhzZWxmKToKICAgICAgICBmb3IgS2xhc3MgaW4gTW9jaywgTWFnaWNNb2NrOgogICAgICAgICAgICBtID0gS2xhc3MoKQogICAgICAgICAgICBvcmlnaW5hbF9yZXByID0gcmVwcihtKQogICAgICAgICAgICBtLnJldHVybl92YWx1ZSA9IG0KICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhtKCksIG0pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVwcihtKSwgb3JpZ2luYWxfcmVwcikKCiAgICAgICAgICAgIG0ucmVzZXRfbW9jaygpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMobSgpLCBtKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlcHIobSksIG9yaWdpbmFsX3JlcHIpCgogICAgICAgICAgICBtID0gS2xhc3MoKQogICAgICAgICAgICBtLmIgPSBtLmEKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigibmFtZT0nbW9jay5hJyIsIHJlcHIobS5iKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigibmFtZT0nbW9jay5hJyIsIHJlcHIobS5hKSkKICAgICAgICAgICAgbS5yZXNldF9tb2NrKCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigibmFtZT0nbW9jay5hJyIsIHJlcHIobS5iKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigibmFtZT0nbW9jay5hJyIsIHJlcHIobS5hKSkKCiAgICAgICAgICAgIG0gPSBLbGFzcygpCiAgICAgICAgICAgIG9yaWdpbmFsX3JlcHIgPSByZXByKG0pCiAgICAgICAgICAgIG0uYSA9IG0oKQogICAgICAgICAgICBtLmEucmV0dXJuX3ZhbHVlID0gbQoKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXByKG0pLCBvcmlnaW5hbF9yZXByKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlcHIobS5hKCkpLCBvcmlnaW5hbF9yZXByKQoKCiAgICBkZWYgdGVzdF9hdHRhY2hfbW9jayhzZWxmKToKICAgICAgICBjbGFzc2VzID0gTW9jaywgTWFnaWNNb2NrLCBOb25DYWxsYWJsZU1hZ2ljTW9jaywgTm9uQ2FsbGFibGVNb2NrCiAgICAgICAgZm9yIEtsYXNzIGluIGNsYXNzZXM6CiAgICAgICAgICAgIGZvciBLbGFzczIgaW4gY2xhc3NlczoKICAgICAgICAgICAgICAgIG0gPSBLbGFzcygpCgogICAgICAgICAgICAgICAgbTIgPSBLbGFzczIobmFtZT0nZm9vJykKICAgICAgICAgICAgICAgIG0uYXR0YWNoX21vY2sobTIsICdiYXInKQoKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMobS5iYXIsIG0yKQogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigibmFtZT0nbW9jay5iYXInIiwgcmVwcihtMikpCgogICAgICAgICAgICAgICAgbS5iYXIuYmF6KDEpCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0ubW9ja19jYWxscywgW2NhbGwuYmFyLmJheigxKV0pCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0ubWV0aG9kX2NhbGxzLCBbY2FsbC5iYXIuYmF6KDEpXSkKCgogICAgZGVmIHRlc3RfYXR0YWNoX21vY2tfcmV0dXJuX3ZhbHVlKHNlbGYpOgogICAgICAgIGNsYXNzZXMgPSBNb2NrLCBNYWdpY01vY2ssIE5vbkNhbGxhYmxlTWFnaWNNb2NrLCBOb25DYWxsYWJsZU1vY2sKICAgICAgICBmb3IgS2xhc3MgaW4gTW9jaywgTWFnaWNNb2NrOgogICAgICAgICAgICBmb3IgS2xhc3MyIGluIGNsYXNzZXM6CiAgICAgICAgICAgICAgICBtID0gS2xhc3MoKQoKICAgICAgICAgICAgICAgIG0yID0gS2xhc3MyKG5hbWU9J2ZvbycpCiAgICAgICAgICAgICAgICBtLmF0dGFjaF9tb2NrKG0yLCAncmV0dXJuX3ZhbHVlJykKCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydElzKG0oKSwgbTIpCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEluKCJuYW1lPSdtb2NrKCknIiwgcmVwcihtMikpCgogICAgICAgICAgICAgICAgbTIuZm9vKCkKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobS5tb2NrX2NhbGxzLCBjYWxsKCkuZm9vKCkuY2FsbF9saXN0KCkpCgoKICAgIGRlZiB0ZXN0X2F0dHJpYnV0ZV9kZWxldGlvbihzZWxmKToKICAgICAgICBmb3IgbW9jayBpbiBNb2NrKCksIE1hZ2ljTW9jaygpOgogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaGFzYXR0cihtb2NrLCAnbScpKQoKICAgICAgICAgICAgZGVsIG1vY2subQogICAgICAgICAgICBzZWxmLmFzc2VydEZhbHNlKGhhc2F0dHIobW9jaywgJ20nKSkKCiAgICAgICAgICAgIGRlbCBtb2NrLmYKICAgICAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShoYXNhdHRyKG1vY2ssICdmJykpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBnZXRhdHRyLCBtb2NrLCAnZicpCgoKICAgIGRlZiB0ZXN0X2NsYXNzX2Fzc2lnbmFibGUoc2VsZik6CiAgICAgICAgZm9yIG1vY2sgaW4gTW9jaygpLCBNYWdpY01vY2soKToKICAgICAgICAgICAgc2VsZi5hc3NlcnROb3RJc0luc3RhbmNlKG1vY2ssIGludCkKCiAgICAgICAgICAgIG1vY2suX19jbGFzc19fID0gaW50CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrLCBpbnQpCiAgICAgICAgICAgIG1vY2suZm9vCgoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICB1bml0dGVzdC5tYWluKCkK',
'/Lib/unittest/test/testmock/testpatch.py':'IyBDb3B5cmlnaHQgKEMpIDIwMDctMjAxMiBNaWNoYWVsIEZvb3JkICYgdGhlIG1vY2sgdGVhbQojIEUtbWFpbDogZnV6enltYW4gQVQgdm9pZHNwYWNlIERPVCBvcmcgRE9UIHVrCiMgaHR0cDovL3d3dy52b2lkc3BhY2Uub3JnLnVrL3B5dGhvbi9tb2NrLwoKaW1wb3J0IG9zCmltcG9ydCBzeXMKCmltcG9ydCB1bml0dGVzdApmcm9tIHVuaXR0ZXN0LnRlc3QudGVzdG1vY2sgaW1wb3J0IHN1cHBvcnQKZnJvbSB1bml0dGVzdC50ZXN0LnRlc3Rtb2NrLnN1cHBvcnQgaW1wb3J0IFNvbWVDbGFzcywgaXNfaW5zdGFuY2UKCmZyb20gdW5pdHRlc3QubW9jayBpbXBvcnQgKAogICAgTm9uQ2FsbGFibGVNb2NrLCBDYWxsYWJsZU1peGluLCBwYXRjaCwgc2VudGluZWwsCiAgICBNYWdpY01vY2ssIE1vY2ssIE5vbkNhbGxhYmxlTWFnaWNNb2NrLCBwYXRjaCwgX3BhdGNoLAogICAgREVGQVVMVCwgY2FsbCwgX2dldF90YXJnZXQKKQoKCmJ1aWx0aW5fc3RyaW5nID0gJ2J1aWx0aW5zJwoKUFRNb2R1bGUgPSBzeXMubW9kdWxlc1tfX25hbWVfX10KTU9ETkFNRSA9ICclcy5QVE1vZHVsZScgJSBfX25hbWVfXwoKCmRlZiBfZ2V0X3Byb3h5KG9iaiwgZ2V0X29ubHk9VHJ1ZSk6CiAgICBjbGFzcyBQcm94eShvYmplY3QpOgogICAgICAgIGRlZiBfX2dldGF0dHJfXyhzZWxmLCBuYW1lKToKICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIob2JqLCBuYW1lKQogICAgaWYgbm90IGdldF9vbmx5OgogICAgICAgIGRlZiBfX3NldGF0dHJfXyhzZWxmLCBuYW1lLCB2YWx1ZSk6CiAgICAgICAgICAgIHNldGF0dHIob2JqLCBuYW1lLCB2YWx1ZSkKICAgICAgICBkZWYgX19kZWxhdHRyX18oc2VsZiwgbmFtZSk6CiAgICAgICAgICAgIGRlbGF0dHIob2JqLCBuYW1lKQogICAgICAgIFByb3h5Ll9fc2V0YXR0cl9fID0gX19zZXRhdHRyX18KICAgICAgICBQcm94eS5fX2RlbGF0dHJfXyA9IF9fZGVsYXR0cl9fCiAgICByZXR1cm4gUHJveHkoKQoKCiMgZm9yIHVzZSBpbiB0aGUgdGVzdApzb21ldGhpbmcgID0gc2VudGluZWwuU29tZXRoaW5nCnNvbWV0aGluZ19lbHNlICA9IHNlbnRpbmVsLlNvbWV0aGluZ0Vsc2UKCgpjbGFzcyBGb28ob2JqZWN0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBhKToKICAgICAgICBwYXNzCiAgICBkZWYgZihzZWxmLCBhKToKICAgICAgICBwYXNzCiAgICBkZWYgZyhzZWxmKToKICAgICAgICBwYXNzCiAgICBmb28gPSAnYmFyJwoKICAgIGNsYXNzIEJhcihvYmplY3QpOgogICAgICAgIGRlZiBhKHNlbGYpOgogICAgICAgICAgICBwYXNzCgpmb29fbmFtZSA9ICclcy5Gb28nICUgX19uYW1lX18KCgpkZWYgZnVuY3Rpb24oYSwgYj1Gb28pOgogICAgcGFzcwoKCmNsYXNzIENvbnRhaW5lcihvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYudmFsdWVzID0ge30KCiAgICBkZWYgX19nZXRpdGVtX18oc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIHNlbGYudmFsdWVzW25hbWVdCgogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIG5hbWUsIHZhbHVlKToKICAgICAgICBzZWxmLnZhbHVlc1tuYW1lXSA9IHZhbHVlCgogICAgZGVmIF9fZGVsaXRlbV9fKHNlbGYsIG5hbWUpOgogICAgICAgIGRlbCBzZWxmLnZhbHVlc1tuYW1lXQoKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gaXRlcihzZWxmLnZhbHVlcykKCgoKY2xhc3MgUGF0Y2hUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKCiAgICBkZWYgYXNzZXJ0Tm90Q2FsbGFibGUoc2VsZiwgb2JqLCBtYWdpYz1UcnVlKToKICAgICAgICBNb2NrQ2xhc3MgPSBOb25DYWxsYWJsZU1hZ2ljTW9jawogICAgICAgIGlmIG5vdCBtYWdpYzoKICAgICAgICAgICAgTW9ja0NsYXNzID0gTm9uQ2FsbGFibGVNb2NrCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgb2JqKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShpc19pbnN0YW5jZShvYmosIE1vY2tDbGFzcykpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShpc19pbnN0YW5jZShvYmosIENhbGxhYmxlTWl4aW4pKQoKCiAgICBkZWYgdGVzdF9zaW5nbGVfcGF0Y2hvYmplY3Qoc2VsZik6CiAgICAgICAgY2xhc3MgU29tZXRoaW5nKG9iamVjdCk6CiAgICAgICAgICAgIGF0dHJpYnV0ZSA9IHNlbnRpbmVsLk9yaWdpbmFsCgogICAgICAgIEBwYXRjaC5vYmplY3QoU29tZXRoaW5nLCAnYXR0cmlidXRlJywgc2VudGluZWwuUGF0Y2hlZCkKICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFNvbWV0aGluZy5hdHRyaWJ1dGUsIHNlbnRpbmVsLlBhdGNoZWQsICJ1bnBhdGNoZWQiKQoKICAgICAgICB0ZXN0KCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFNvbWV0aGluZy5hdHRyaWJ1dGUsIHNlbnRpbmVsLk9yaWdpbmFsLAogICAgICAgICAgICAgICAgICAgICAgICAgInBhdGNoIG5vdCByZXN0b3JlZCIpCgoKICAgIGRlZiB0ZXN0X3BhdGNob2JqZWN0X3dpdGhfbm9uZShzZWxmKToKICAgICAgICBjbGFzcyBTb21ldGhpbmcob2JqZWN0KToKICAgICAgICAgICAgYXR0cmlidXRlID0gc2VudGluZWwuT3JpZ2luYWwKCiAgICAgICAgQHBhdGNoLm9iamVjdChTb21ldGhpbmcsICdhdHRyaWJ1dGUnLCBOb25lKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNOb25lKFNvbWV0aGluZy5hdHRyaWJ1dGUsICJ1bnBhdGNoZWQiKQoKICAgICAgICB0ZXN0KCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFNvbWV0aGluZy5hdHRyaWJ1dGUsIHNlbnRpbmVsLk9yaWdpbmFsLAogICAgICAgICAgICAgICAgICAgICAgICAgInBhdGNoIG5vdCByZXN0b3JlZCIpCgoKICAgIGRlZiB0ZXN0X211bHRpcGxlX3BhdGNob2JqZWN0KHNlbGYpOgogICAgICAgIGNsYXNzIFNvbWV0aGluZyhvYmplY3QpOgogICAgICAgICAgICBhdHRyaWJ1dGUgPSBzZW50aW5lbC5PcmlnaW5hbAogICAgICAgICAgICBuZXh0X2F0dHJpYnV0ZSA9IHNlbnRpbmVsLk9yaWdpbmFsMgoKICAgICAgICBAcGF0Y2gub2JqZWN0KFNvbWV0aGluZywgJ2F0dHJpYnV0ZScsIHNlbnRpbmVsLlBhdGNoZWQpCiAgICAgICAgQHBhdGNoLm9iamVjdChTb21ldGhpbmcsICduZXh0X2F0dHJpYnV0ZScsIHNlbnRpbmVsLlBhdGNoZWQyKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZXRoaW5nLmF0dHJpYnV0ZSwgc2VudGluZWwuUGF0Y2hlZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidW5wYXRjaGVkIikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChTb21ldGhpbmcubmV4dF9hdHRyaWJ1dGUsIHNlbnRpbmVsLlBhdGNoZWQyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ1bnBhdGNoZWQiKQoKICAgICAgICB0ZXN0KCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFNvbWV0aGluZy5hdHRyaWJ1dGUsIHNlbnRpbmVsLk9yaWdpbmFsLAogICAgICAgICAgICAgICAgICAgICAgICAgInBhdGNoIG5vdCByZXN0b3JlZCIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChTb21ldGhpbmcubmV4dF9hdHRyaWJ1dGUsIHNlbnRpbmVsLk9yaWdpbmFsMiwKICAgICAgICAgICAgICAgICAgICAgICAgICJwYXRjaCBub3QgcmVzdG9yZWQiKQoKCiAgICBkZWYgdGVzdF9vYmplY3RfbG9va3VwX2lzX3F1aXRlX2xhenkoc2VsZik6CiAgICAgICAgZ2xvYmFsIHNvbWV0aGluZwogICAgICAgIG9yaWdpbmFsID0gc29tZXRoaW5nCiAgICAgICAgQHBhdGNoKCclcy5zb21ldGhpbmcnICUgX19uYW1lX18sIHNlbnRpbmVsLlNvbWV0aGluZzIpCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNvbWV0aGluZyA9IHNlbnRpbmVsLnJlcGxhY2VtZW50X3ZhbHVlCiAgICAgICAgICAgIHRlc3QoKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNvbWV0aGluZywgc2VudGluZWwucmVwbGFjZW1lbnRfdmFsdWUpCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgc29tZXRoaW5nID0gb3JpZ2luYWwKCgogICAgZGVmIHRlc3RfcGF0Y2goc2VsZik6CiAgICAgICAgQHBhdGNoKCclcy5zb21ldGhpbmcnICUgX19uYW1lX18sIHNlbnRpbmVsLlNvbWV0aGluZzIpCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChQVE1vZHVsZS5zb21ldGhpbmcsIHNlbnRpbmVsLlNvbWV0aGluZzIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInVucGF0Y2hlZCIpCgogICAgICAgIHRlc3QoKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoUFRNb2R1bGUuc29tZXRoaW5nLCBzZW50aW5lbC5Tb21ldGhpbmcsCiAgICAgICAgICAgICAgICAgICAgICAgICAicGF0Y2ggbm90IHJlc3RvcmVkIikKCiAgICAgICAgQHBhdGNoKCclcy5zb21ldGhpbmcnICUgX19uYW1lX18sIHNlbnRpbmVsLlNvbWV0aGluZzIpCiAgICAgICAgQHBhdGNoKCclcy5zb21ldGhpbmdfZWxzZScgJSBfX25hbWVfXywgc2VudGluZWwuU29tZXRoaW5nRWxzZSkKICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFBUTW9kdWxlLnNvbWV0aGluZywgc2VudGluZWwuU29tZXRoaW5nMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidW5wYXRjaGVkIikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChQVE1vZHVsZS5zb21ldGhpbmdfZWxzZSwgc2VudGluZWwuU29tZXRoaW5nRWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidW5wYXRjaGVkIikKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChQVE1vZHVsZS5zb21ldGhpbmcsIHNlbnRpbmVsLlNvbWV0aGluZywKICAgICAgICAgICAgICAgICAgICAgICAgICJwYXRjaCBub3QgcmVzdG9yZWQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoUFRNb2R1bGUuc29tZXRoaW5nX2Vsc2UsIHNlbnRpbmVsLlNvbWV0aGluZ0Vsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAicGF0Y2ggbm90IHJlc3RvcmVkIikKCiAgICAgICAgIyBUZXN0IHRoZSBwYXRjaGluZyBhbmQgcmVzdG9yaW5nIHdvcmtzIGEgc2Vjb25kIHRpbWUKICAgICAgICB0ZXN0KCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChQVE1vZHVsZS5zb21ldGhpbmcsIHNlbnRpbmVsLlNvbWV0aGluZywKICAgICAgICAgICAgICAgICAgICAgICAgICJwYXRjaCBub3QgcmVzdG9yZWQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoUFRNb2R1bGUuc29tZXRoaW5nX2Vsc2UsIHNlbnRpbmVsLlNvbWV0aGluZ0Vsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAicGF0Y2ggbm90IHJlc3RvcmVkIikKCiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2sucmV0dXJuX3ZhbHVlID0gc2VudGluZWwuSGFuZGxlCiAgICAgICAgQHBhdGNoKCclcy5vcGVuJyAlIGJ1aWx0aW5fc3RyaW5nLCBtb2NrKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwob3BlbignZmlsZW5hbWUnLCAncicpLCBzZW50aW5lbC5IYW5kbGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm9wZW4gbm90IHBhdGNoZWQiKQogICAgICAgIHRlc3QoKQogICAgICAgIHRlc3QoKQoKICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKG9wZW4sIG1vY2ssICJwYXRjaCBub3QgcmVzdG9yZWQiKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9jbGFzc19hdHRyaWJ1dGUoc2VsZik6CiAgICAgICAgQHBhdGNoKCclcy5Tb21lQ2xhc3MuY2xhc3NfYXR0cmlidXRlJyAlIF9fbmFtZV9fLAogICAgICAgICAgICAgICBzZW50aW5lbC5DbGFzc0F0dHJpYnV0ZSkKICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFBUTW9kdWxlLlNvbWVDbGFzcy5jbGFzc19hdHRyaWJ1dGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VudGluZWwuQ2xhc3NBdHRyaWJ1dGUsICJ1bnBhdGNoZWQiKQogICAgICAgIHRlc3QoKQoKICAgICAgICBzZWxmLmFzc2VydElzTm9uZShQVE1vZHVsZS5Tb21lQ2xhc3MuY2xhc3NfYXR0cmlidXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICJwYXRjaCBub3QgcmVzdG9yZWQiKQoKCiAgICBkZWYgdGVzdF9wYXRjaG9iamVjdF93aXRoX2RlZmF1bHRfbW9jayhzZWxmKToKICAgICAgICBjbGFzcyBUZXN0KG9iamVjdCk6CiAgICAgICAgICAgIHNvbWV0aGluZyA9IHNlbnRpbmVsLk9yaWdpbmFsCiAgICAgICAgICAgIHNvbWV0aGluZzIgPSBzZW50aW5lbC5PcmlnaW5hbDIKCiAgICAgICAgQHBhdGNoLm9iamVjdChUZXN0LCAnc29tZXRoaW5nJykKICAgICAgICBkZWYgdGVzdChtb2NrKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLCBUZXN0LnNvbWV0aGluZywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTW9jayBub3QgcGFzc2VkIGludG8gdGVzdCBmdW5jdGlvbiIpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrLCBNYWdpY01vY2ssCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAicGF0Y2ggd2l0aCB0d28gYXJndW1lbnRzIGRpZCBub3QgY3JlYXRlIGEgbW9jayIpCgogICAgICAgIHRlc3QoKQoKICAgICAgICBAcGF0Y2gub2JqZWN0KFRlc3QsICdzb21ldGhpbmcnKQogICAgICAgIEBwYXRjaC5vYmplY3QoVGVzdCwgJ3NvbWV0aGluZzInKQogICAgICAgIGRlZiB0ZXN0KHRoaXMxLCB0aGlzMiwgbW9jazEsIG1vY2syKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCh0aGlzMSwgc2VudGluZWwudGhpczEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlBhdGNoZWQgZnVuY3Rpb24gZGlkbid0IHJlY2VpdmUgaW5pdGlhbCBhcmd1bWVudCIpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwodGhpczIsIHNlbnRpbmVsLnRoaXMyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJQYXRjaGVkIGZ1bmN0aW9uIGRpZG4ndCByZWNlaXZlIHNlY29uZCBhcmd1bWVudCIpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jazEsIFRlc3Quc29tZXRoaW5nMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTW9jayBub3QgcGFzc2VkIGludG8gdGVzdCBmdW5jdGlvbiIpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jazIsIFRlc3Quc29tZXRoaW5nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJTZWNvbmQgTW9jayBub3QgcGFzc2VkIGludG8gdGVzdCBmdW5jdGlvbiIpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrMiwgTWFnaWNNb2NrLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInBhdGNoIHdpdGggdHdvIGFyZ3VtZW50cyBkaWQgbm90IGNyZWF0ZSBhIG1vY2siKQogICAgICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jazIsIE1hZ2ljTW9jaywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJwYXRjaCB3aXRoIHR3byBhcmd1bWVudHMgZGlkIG5vdCBjcmVhdGUgYSBtb2NrIikKCiAgICAgICAgICAgICMgQSBoYWNrIHRvIHRlc3QgdGhhdCBuZXcgbW9ja3MgYXJlIHBhc3NlZCB0aGUgc2Vjb25kIHRpbWUKICAgICAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChvdXRlck1vY2sxLCBtb2NrMSwgInVuZXhwZWN0ZWQgdmFsdWUgZm9yIG1vY2sxIikKICAgICAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChvdXRlck1vY2syLCBtb2NrMiwgInVuZXhwZWN0ZWQgdmFsdWUgZm9yIG1vY2sxIikKICAgICAgICAgICAgcmV0dXJuIG1vY2sxLCBtb2NrMgoKICAgICAgICBvdXRlck1vY2sxID0gb3V0ZXJNb2NrMiA9IE5vbmUKICAgICAgICBvdXRlck1vY2sxLCBvdXRlck1vY2syID0gdGVzdChzZW50aW5lbC50aGlzMSwgc2VudGluZWwudGhpczIpCgogICAgICAgICMgVGVzdCB0aGF0IGV4ZWN1dGluZyBhIHNlY29uZCB0aW1lIGNyZWF0ZXMgbmV3IG1vY2tzCiAgICAgICAgdGVzdChzZW50aW5lbC50aGlzMSwgc2VudGluZWwudGhpczIpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX3dpdGhfc3BlYyhzZWxmKToKICAgICAgICBAcGF0Y2goJyVzLlNvbWVDbGFzcycgJSBfX25hbWVfXywgc3BlYz1Tb21lQ2xhc3MpCiAgICAgICAgZGVmIHRlc3QoTW9ja1NvbWVDbGFzcyk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZUNsYXNzLCBNb2NrU29tZUNsYXNzKQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UoU29tZUNsYXNzLndpYmJsZSwgTWFnaWNNb2NrKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGxhbWJkYTogU29tZUNsYXNzLm5vdF93aWJibGUpCgogICAgICAgIHRlc3QoKQoKCiAgICBkZWYgdGVzdF9wYXRjaG9iamVjdF93aXRoX3NwZWMoc2VsZik6CiAgICAgICAgQHBhdGNoLm9iamVjdChTb21lQ2xhc3MsICdjbGFzc19hdHRyaWJ1dGUnLCBzcGVjPVNvbWVDbGFzcykKICAgICAgICBkZWYgdGVzdChNb2NrQXR0cmlidXRlKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChTb21lQ2xhc3MuY2xhc3NfYXR0cmlidXRlLCBNb2NrQXR0cmlidXRlKQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UoU29tZUNsYXNzLmNsYXNzX2F0dHJpYnV0ZS53aWJibGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hZ2ljTW9jaykpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYW1iZGE6IFNvbWVDbGFzcy5jbGFzc19hdHRyaWJ1dGUubm90X3dpYmJsZSkKCiAgICAgICAgdGVzdCgpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX3dpdGhfc3BlY19hc19saXN0KHNlbGYpOgogICAgICAgIEBwYXRjaCgnJXMuU29tZUNsYXNzJyAlIF9fbmFtZV9fLCBzcGVjPVsnd2liYmxlJ10pCiAgICAgICAgZGVmIHRlc3QoTW9ja1NvbWVDbGFzcyk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZUNsYXNzLCBNb2NrU29tZUNsYXNzKQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UoU29tZUNsYXNzLndpYmJsZSwgTWFnaWNNb2NrKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGxhbWJkYTogU29tZUNsYXNzLm5vdF93aWJibGUpCgogICAgICAgIHRlc3QoKQoKCiAgICBkZWYgdGVzdF9wYXRjaG9iamVjdF93aXRoX3NwZWNfYXNfbGlzdChzZWxmKToKICAgICAgICBAcGF0Y2gub2JqZWN0KFNvbWVDbGFzcywgJ2NsYXNzX2F0dHJpYnV0ZScsIHNwZWM9Wyd3aWJibGUnXSkKICAgICAgICBkZWYgdGVzdChNb2NrQXR0cmlidXRlKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChTb21lQ2xhc3MuY2xhc3NfYXR0cmlidXRlLCBNb2NrQXR0cmlidXRlKQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UoU29tZUNsYXNzLmNsYXNzX2F0dHJpYnV0ZS53aWJibGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hZ2ljTW9jaykpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYW1iZGE6IFNvbWVDbGFzcy5jbGFzc19hdHRyaWJ1dGUubm90X3dpYmJsZSkKCiAgICAgICAgdGVzdCgpCgoKICAgIGRlZiB0ZXN0X25lc3RlZF9wYXRjaF93aXRoX3NwZWNfYXNfbGlzdChzZWxmKToKICAgICAgICAjIHJlZ3Jlc3Npb24gdGVzdCBmb3IgbmVzdGVkIGRlY29yYXRvcnMKICAgICAgICBAcGF0Y2goJyVzLm9wZW4nICUgYnVpbHRpbl9zdHJpbmcpCiAgICAgICAgQHBhdGNoKCclcy5Tb21lQ2xhc3MnICUgX19uYW1lX18sIHNwZWM9Wyd3aWJibGUnXSkKICAgICAgICBkZWYgdGVzdChNb2NrU29tZUNsYXNzLCBNb2NrT3Blbik6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZUNsYXNzLCBNb2NrU29tZUNsYXNzKQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UoU29tZUNsYXNzLndpYmJsZSwgTWFnaWNNb2NrKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGxhbWJkYTogU29tZUNsYXNzLm5vdF93aWJibGUpCiAgICAgICAgdGVzdCgpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX3dpdGhfc3BlY19hc19ib29sZWFuKHNlbGYpOgogICAgICAgIEBwYXRjaCgnJXMuU29tZUNsYXNzJyAlIF9fbmFtZV9fLCBzcGVjPVRydWUpCiAgICAgICAgZGVmIHRlc3QoTW9ja1NvbWVDbGFzcyk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZUNsYXNzLCBNb2NrU29tZUNsYXNzKQogICAgICAgICAgICAjIFNob3VsZCBub3QgcmFpc2UgYXR0cmlidXRlIGVycm9yCiAgICAgICAgICAgIE1vY2tTb21lQ2xhc3Mud2liYmxlCgogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgbGFtYmRhOiBNb2NrU29tZUNsYXNzLm5vdF93aWJibGUpCgogICAgICAgIHRlc3QoKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9vYmplY3Rfd2l0aF9zcGVjX2FzX2Jvb2xlYW4oc2VsZik6CiAgICAgICAgQHBhdGNoLm9iamVjdChQVE1vZHVsZSwgJ1NvbWVDbGFzcycsIHNwZWM9VHJ1ZSkKICAgICAgICBkZWYgdGVzdChNb2NrU29tZUNsYXNzKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChTb21lQ2xhc3MsIE1vY2tTb21lQ2xhc3MpCiAgICAgICAgICAgICMgU2hvdWxkIG5vdCByYWlzZSBhdHRyaWJ1dGUgZXJyb3IKICAgICAgICAgICAgTW9ja1NvbWVDbGFzcy53aWJibGUKCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBsYW1iZGE6IE1vY2tTb21lQ2xhc3Mubm90X3dpYmJsZSkKCiAgICAgICAgdGVzdCgpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX2NsYXNzX2FjdHNfd2l0aF9zcGVjX2lzX2luaGVyaXRlZChzZWxmKToKICAgICAgICBAcGF0Y2goJyVzLlNvbWVDbGFzcycgJSBfX25hbWVfXywgc3BlYz1UcnVlKQogICAgICAgIGRlZiB0ZXN0KE1vY2tTb21lQ2xhc3MpOgogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UoTW9ja1NvbWVDbGFzcywgTWFnaWNNb2NrKSkKICAgICAgICAgICAgaW5zdGFuY2UgPSBNb2NrU29tZUNsYXNzKCkKICAgICAgICAgICAgc2VsZi5hc3NlcnROb3RDYWxsYWJsZShpbnN0YW5jZSkKICAgICAgICAgICAgIyBTaG91bGQgbm90IHJhaXNlIGF0dHJpYnV0ZSBlcnJvcgogICAgICAgICAgICBpbnN0YW5jZS53aWJibGUKCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBsYW1iZGE6IGluc3RhbmNlLm5vdF93aWJibGUpCgogICAgICAgIHRlc3QoKQoKCiAgICBkZWYgdGVzdF9wYXRjaF93aXRoX2NyZWF0ZV9tb2Nrc19ub25fZXhpc3RlbnRfYXR0cmlidXRlcyhzZWxmKToKICAgICAgICBAcGF0Y2goJyVzLmZyb29ibGUnICUgYnVpbHRpbl9zdHJpbmcsIHNlbnRpbmVsLkZyb29ibGUsIGNyZWF0ZT1UcnVlKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZnJvb2JsZSwgc2VudGluZWwuRnJvb2JsZSkKCiAgICAgICAgdGVzdCgpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoTmFtZUVycm9yLCBsYW1iZGE6IGZyb29ibGUpCgoKICAgIGRlZiB0ZXN0X3BhdGNob2JqZWN0X3dpdGhfY3JlYXRlX21vY2tzX25vbl9leGlzdGVudF9hdHRyaWJ1dGVzKHNlbGYpOgogICAgICAgIEBwYXRjaC5vYmplY3QoU29tZUNsYXNzLCAnZnJvb2JsZScsIHNlbnRpbmVsLkZyb29ibGUsIGNyZWF0ZT1UcnVlKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZUNsYXNzLmZyb29ibGUsIHNlbnRpbmVsLkZyb29ibGUpCgogICAgICAgIHRlc3QoKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoaGFzYXR0cihTb21lQ2xhc3MsICdmcm9vYmxlJykpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX3dvbnRfY3JlYXRlX2J5X2RlZmF1bHQoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBAcGF0Y2goJyVzLmZyb29ibGUnICUgYnVpbHRpbl9zdHJpbmcsIHNlbnRpbmVsLkZyb29ibGUpCiAgICAgICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZyb29ibGUsIHNlbnRpbmVsLkZyb29ibGUpCgogICAgICAgICAgICB0ZXN0KCkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoJ1BhdGNoaW5nIG5vbiBleGlzdGVudCBhdHRyaWJ1dGVzIHNob3VsZCBmYWlsJykKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoTmFtZUVycm9yLCBsYW1iZGE6IGZyb29ibGUpCgoKICAgIGRlZiB0ZXN0X3BhdGNob2JqZWN0X3dvbnRfY3JlYXRlX2J5X2RlZmF1bHQoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBAcGF0Y2gub2JqZWN0KFNvbWVDbGFzcywgJ2Zyb29ibGUnLCBzZW50aW5lbC5Gcm9vYmxlKQogICAgICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICAgICAgc2VsZi5mYWlsKCdQYXRjaGluZyBub24gZXhpc3RlbnQgYXR0cmlidXRlcyBzaG91bGQgZmFpbCcpCgogICAgICAgICAgICB0ZXN0KCkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoJ1BhdGNoaW5nIG5vbiBleGlzdGVudCBhdHRyaWJ1dGVzIHNob3VsZCBmYWlsJykKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKGhhc2F0dHIoU29tZUNsYXNzLCAnZnJvb2JsZScpKQoKCiAgICBkZWYgdGVzdF9wYXRjaF93aXRoX3N0YXRpY19tZXRob2RzKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyhvYmplY3QpOgogICAgICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgICAgIGRlZiB3b290KCk6CiAgICAgICAgICAgICAgICByZXR1cm4gc2VudGluZWwuU3RhdGljCgogICAgICAgIEBwYXRjaC5vYmplY3QoRm9vLCAnd29vdCcsIHN0YXRpY21ldGhvZChsYW1iZGE6IHNlbnRpbmVsLlBhdGNoZWQpKQogICAgICAgIGRlZiBhbm9ueW1vdXMoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28ud29vdCgpLCBzZW50aW5lbC5QYXRjaGVkKQogICAgICAgIGFub255bW91cygpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLndvb3QoKSwgc2VudGluZWwuU3RhdGljKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9sb2NhbChzZWxmKToKICAgICAgICBmb28gPSBzZW50aW5lbC5Gb28KICAgICAgICBAcGF0Y2gub2JqZWN0KHNlbnRpbmVsLCAnRm9vJywgJ0ZvbycpCiAgICAgICAgZGVmIGFub255bW91cygpOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNlbnRpbmVsLkZvbywgJ0ZvbycpCiAgICAgICAgYW5vbnltb3VzKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzZW50aW5lbC5Gb28sIGZvbykKCgogICAgZGVmIHRlc3RfcGF0Y2hfc2xvdHMoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKG9iamVjdCk6CiAgICAgICAgICAgIF9fc2xvdHNfXyA9ICgnRm9vJywpCgogICAgICAgIGZvbyA9IEZvbygpCiAgICAgICAgZm9vLkZvbyA9IHNlbnRpbmVsLkZvbwoKICAgICAgICBAcGF0Y2gub2JqZWN0KGZvbywgJ0ZvbycsICdGb28nKQogICAgICAgIGRlZiBhbm9ueW1vdXMoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28uRm9vLCAnRm9vJykKICAgICAgICBhbm9ueW1vdXMoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvby5Gb28sIHNlbnRpbmVsLkZvbykKCgogICAgZGVmIHRlc3RfcGF0Y2hvYmplY3RfY2xhc3NfZGVjb3JhdG9yKHNlbGYpOgogICAgICAgIGNsYXNzIFNvbWV0aGluZyhvYmplY3QpOgogICAgICAgICAgICBhdHRyaWJ1dGUgPSBzZW50aW5lbC5PcmlnaW5hbAoKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgZGVmIHRlc3RfbWV0aG9kKG90aGVyX3NlbGYpOgogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChTb21ldGhpbmcuYXR0cmlidXRlLCBzZW50aW5lbC5QYXRjaGVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidW5wYXRjaGVkIikKICAgICAgICAgICAgZGVmIG5vdF90ZXN0X21ldGhvZChvdGhlcl9zZWxmKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZXRoaW5nLmF0dHJpYnV0ZSwgc2VudGluZWwuT3JpZ2luYWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJub24tdGVzdCBtZXRob2QgcGF0Y2hlZCIpCgogICAgICAgIEZvbyA9IHBhdGNoLm9iamVjdChTb21ldGhpbmcsICdhdHRyaWJ1dGUnLCBzZW50aW5lbC5QYXRjaGVkKShGb28pCgogICAgICAgIGYgPSBGb28oKQogICAgICAgIGYudGVzdF9tZXRob2QoKQogICAgICAgIGYubm90X3Rlc3RfbWV0aG9kKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChTb21ldGhpbmcuYXR0cmlidXRlLCBzZW50aW5lbC5PcmlnaW5hbCwKICAgICAgICAgICAgICAgICAgICAgICAgICJwYXRjaCBub3QgcmVzdG9yZWQiKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9jbGFzc19kZWNvcmF0b3Ioc2VsZik6CiAgICAgICAgY2xhc3MgU29tZXRoaW5nKG9iamVjdCk6CiAgICAgICAgICAgIGF0dHJpYnV0ZSA9IHNlbnRpbmVsLk9yaWdpbmFsCgogICAgICAgIGNsYXNzIEZvbyhvYmplY3QpOgogICAgICAgICAgICBkZWYgdGVzdF9tZXRob2Qob3RoZXJfc2VsZiwgbW9ja19zb21ldGhpbmcpOgogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChQVE1vZHVsZS5zb21ldGhpbmcsIG1vY2tfc29tZXRoaW5nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidW5wYXRjaGVkIikKICAgICAgICAgICAgZGVmIG5vdF90ZXN0X21ldGhvZChvdGhlcl9zZWxmKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoUFRNb2R1bGUuc29tZXRoaW5nLCBzZW50aW5lbC5Tb21ldGhpbmcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJub24tdGVzdCBtZXRob2QgcGF0Y2hlZCIpCiAgICAgICAgRm9vID0gcGF0Y2goJyVzLnNvbWV0aGluZycgJSBfX25hbWVfXykoRm9vKQoKICAgICAgICBmID0gRm9vKCkKICAgICAgICBmLnRlc3RfbWV0aG9kKCkKICAgICAgICBmLm5vdF90ZXN0X21ldGhvZCgpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZXRoaW5nLmF0dHJpYnV0ZSwgc2VudGluZWwuT3JpZ2luYWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAicGF0Y2ggbm90IHJlc3RvcmVkIikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFBUTW9kdWxlLnNvbWV0aGluZywgc2VudGluZWwuU29tZXRoaW5nLAogICAgICAgICAgICAgICAgICAgICAgICAgInBhdGNoIG5vdCByZXN0b3JlZCIpCgoKICAgIGRlZiB0ZXN0X3BhdGNob2JqZWN0X3R3aWNlKHNlbGYpOgogICAgICAgIGNsYXNzIFNvbWV0aGluZyhvYmplY3QpOgogICAgICAgICAgICBhdHRyaWJ1dGUgPSBzZW50aW5lbC5PcmlnaW5hbAogICAgICAgICAgICBuZXh0X2F0dHJpYnV0ZSA9IHNlbnRpbmVsLk9yaWdpbmFsMgoKICAgICAgICBAcGF0Y2gub2JqZWN0KFNvbWV0aGluZywgJ2F0dHJpYnV0ZScsIHNlbnRpbmVsLlBhdGNoZWQpCiAgICAgICAgQHBhdGNoLm9iamVjdChTb21ldGhpbmcsICdhdHRyaWJ1dGUnLCBzZW50aW5lbC5QYXRjaGVkKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZXRoaW5nLmF0dHJpYnV0ZSwgc2VudGluZWwuUGF0Y2hlZCwgInVucGF0Y2hlZCIpCgogICAgICAgIHRlc3QoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFNvbWV0aGluZy5hdHRyaWJ1dGUsIHNlbnRpbmVsLk9yaWdpbmFsLAogICAgICAgICAgICAgICAgICAgICAgICAgInBhdGNoIG5vdCByZXN0b3JlZCIpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX2RpY3Qoc2VsZik6CiAgICAgICAgZm9vID0geydpbml0aWFsJzogb2JqZWN0KCksICdvdGhlcic6ICdzb21ldGhpbmcnfQogICAgICAgIG9yaWdpbmFsID0gZm9vLmNvcHkoKQoKICAgICAgICBAcGF0Y2guZGljdChmb28pCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgZm9vWydhJ10gPSAzCiAgICAgICAgICAgIGRlbCBmb29bJ2luaXRpYWwnXQogICAgICAgICAgICBmb29bJ290aGVyJ10gPSAnc29tZXRoaW5nIGVsc2UnCgogICAgICAgIHRlc3QoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvbywgb3JpZ2luYWwpCgogICAgICAgIEBwYXRjaC5kaWN0KGZvbywgeydhJzogJ2InfSkKICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihmb28pLCAzKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvb1snYSddLCAnYicpCgogICAgICAgIHRlc3QoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvbywgb3JpZ2luYWwpCgogICAgICAgIEBwYXRjaC5kaWN0KGZvbywgWygnYScsICdiJyldKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKGZvbyksIDMpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZm9vWydhJ10sICdiJykKCiAgICAgICAgdGVzdCgpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZm9vLCBvcmlnaW5hbCkKCgogICAgZGVmIHRlc3RfcGF0Y2hfZGljdF93aXRoX2NvbnRhaW5lcl9vYmplY3Qoc2VsZik6CiAgICAgICAgZm9vID0gQ29udGFpbmVyKCkKICAgICAgICBmb29bJ2luaXRpYWwnXSA9IG9iamVjdCgpCiAgICAgICAgZm9vWydvdGhlciddID0gICdzb21ldGhpbmcnCgogICAgICAgIG9yaWdpbmFsID0gZm9vLnZhbHVlcy5jb3B5KCkKCiAgICAgICAgQHBhdGNoLmRpY3QoZm9vKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIGZvb1snYSddID0gMwogICAgICAgICAgICBkZWwgZm9vWydpbml0aWFsJ10KICAgICAgICAgICAgZm9vWydvdGhlciddID0gJ3NvbWV0aGluZyBlbHNlJwoKICAgICAgICB0ZXN0KCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28udmFsdWVzLCBvcmlnaW5hbCkKCiAgICAgICAgQHBhdGNoLmRpY3QoZm9vLCB7J2EnOiAnYid9KQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKGZvby52YWx1ZXMpLCAzKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvb1snYSddLCAnYicpCgogICAgICAgIHRlc3QoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvby52YWx1ZXMsIG9yaWdpbmFsKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9kaWN0X3dpdGhfY2xlYXIoc2VsZik6CiAgICAgICAgZm9vID0geydpbml0aWFsJzogb2JqZWN0KCksICdvdGhlcic6ICdzb21ldGhpbmcnfQogICAgICAgIG9yaWdpbmFsID0gZm9vLmNvcHkoKQoKICAgICAgICBAcGF0Y2guZGljdChmb28sIGNsZWFyPVRydWUpCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28sIHt9KQogICAgICAgICAgICBmb29bJ2EnXSA9IDMKICAgICAgICAgICAgZm9vWydvdGhlciddID0gJ3NvbWV0aGluZyBlbHNlJwoKICAgICAgICB0ZXN0KCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28sIG9yaWdpbmFsKQoKICAgICAgICBAcGF0Y2guZGljdChmb28sIHsnYSc6ICdiJ30sIGNsZWFyPVRydWUpCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28sIHsnYSc6ICdiJ30pCgogICAgICAgIHRlc3QoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvbywgb3JpZ2luYWwpCgogICAgICAgIEBwYXRjaC5kaWN0KGZvbywgWygnYScsICdiJyldLCBjbGVhcj1UcnVlKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZm9vLCB7J2EnOiAnYid9KQoKICAgICAgICB0ZXN0KCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28sIG9yaWdpbmFsKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9kaWN0X3dpdGhfY29udGFpbmVyX29iamVjdF9hbmRfY2xlYXIoc2VsZik6CiAgICAgICAgZm9vID0gQ29udGFpbmVyKCkKICAgICAgICBmb29bJ2luaXRpYWwnXSA9IG9iamVjdCgpCiAgICAgICAgZm9vWydvdGhlciddID0gICdzb21ldGhpbmcnCgogICAgICAgIG9yaWdpbmFsID0gZm9vLnZhbHVlcy5jb3B5KCkKCiAgICAgICAgQHBhdGNoLmRpY3QoZm9vLCBjbGVhcj1UcnVlKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZm9vLnZhbHVlcywge30pCiAgICAgICAgICAgIGZvb1snYSddID0gMwogICAgICAgICAgICBmb29bJ290aGVyJ10gPSAnc29tZXRoaW5nIGVsc2UnCgogICAgICAgIHRlc3QoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvby52YWx1ZXMsIG9yaWdpbmFsKQoKICAgICAgICBAcGF0Y2guZGljdChmb28sIHsnYSc6ICdiJ30sIGNsZWFyPVRydWUpCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28udmFsdWVzLCB7J2EnOiAnYid9KQoKICAgICAgICB0ZXN0KCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28udmFsdWVzLCBvcmlnaW5hbCkKCgogICAgZGVmIHRlc3RfbmFtZV9wcmVzZXJ2ZWQoc2VsZik6CiAgICAgICAgZm9vID0ge30KCiAgICAgICAgQHBhdGNoKCclcy5Tb21lQ2xhc3MnICUgX19uYW1lX18sIG9iamVjdCgpKQogICAgICAgIEBwYXRjaCgnJXMuU29tZUNsYXNzJyAlIF9fbmFtZV9fLCBvYmplY3QoKSwgYXV0b3NwZWM9VHJ1ZSkKICAgICAgICBAcGF0Y2gub2JqZWN0KFNvbWVDbGFzcywgb2JqZWN0KCkpCiAgICAgICAgQHBhdGNoLmRpY3QoZm9vKQogICAgICAgIGRlZiBzb21lX25hbWUoKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNvbWVfbmFtZS5fX25hbWVfXywgJ3NvbWVfbmFtZScpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX3dpdGhfZXhjZXB0aW9uKHNlbGYpOgogICAgICAgIGZvbyA9IHt9CgogICAgICAgIEBwYXRjaC5kaWN0KGZvbywgeydhJzogJ2InfSkKICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICByYWlzZSBOYW1lRXJyb3IoJ0tvbnJhZCcpCiAgICAgICAgdHJ5OgogICAgICAgICAgICB0ZXN0KCkKICAgICAgICBleGNlcHQgTmFtZUVycm9yOgogICAgICAgICAgICBwYXNzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCdOYW1lRXJyb3Igbm90IHJhaXNlZCBieSB0ZXN0JykKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28sIHt9KQoKCiAgICBkZWYgdGVzdF9wYXRjaF9kaWN0X3dpdGhfc3RyaW5nKHNlbGYpOgogICAgICAgIEBwYXRjaC5kaWN0KCdvcy5lbnZpcm9uJywgeydrb25yYWRfZGVsb25nJzogJ3NvbWUgdmFsdWUnfSkKICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICBzZWxmLmFzc2VydEluKCdrb25yYWRfZGVsb25nJywgb3MuZW52aXJvbikKCiAgICAgICAgdGVzdCgpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX2Rlc2NyaXB0b3Ioc2VsZik6CiAgICAgICAgIyB3b3VsZCBiZSBzb21lIGVmZm9ydCB0byBmaXggdGhpcyAtIHdlIGNvdWxkIHNwZWNpYWwgY2FzZSB0aGUKICAgICAgICAjIGJ1aWx0aW4gZGVzY3JpcHRvcnM6IGNsYXNzbWV0aG9kLCBwcm9wZXJ0eSwgc3RhdGljbWV0aG9kCiAgICAgICAgcmV0dXJuCiAgICAgICAgY2xhc3MgTm90aGluZyhvYmplY3QpOgogICAgICAgICAgICBmb28gPSBOb25lCgogICAgICAgIGNsYXNzIFNvbWV0aGluZyhvYmplY3QpOgogICAgICAgICAgICBmb28gPSB7fQoKICAgICAgICAgICAgQHBhdGNoLm9iamVjdChOb3RoaW5nLCAnZm9vJywgMikKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiBrbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhjbHMsIFNvbWV0aGluZykKCiAgICAgICAgICAgIEBwYXRjaC5vYmplY3QoTm90aGluZywgJ2ZvbycsIDIpCiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHN0YXRpYyhhcmcpOgogICAgICAgICAgICAgICAgcmV0dXJuIGFyZwoKICAgICAgICAgICAgQHBhdGNoLmRpY3QoZm9vKQogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIGtsYXNzX2RpY3QoY2xzKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMoY2xzLCBTb21ldGhpbmcpCgogICAgICAgICAgICBAcGF0Y2guZGljdChmb28pCiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHN0YXRpY19kaWN0KGFyZyk6CiAgICAgICAgICAgICAgICByZXR1cm4gYXJnCgogICAgICAgICMgdGhlc2Ugd2lsbCByYWlzZSBleGNlcHRpb25zIGlmIHBhdGNoaW5nIGRlc2NyaXB0b3JzIGlzIGJyb2tlbgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZXRoaW5nLnN0YXRpYygnZjAwJyksICdmMDAnKQogICAgICAgIFNvbWV0aGluZy5rbGFzcygpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChTb21ldGhpbmcuc3RhdGljX2RpY3QoJ2YwMCcpLCAnZjAwJykKICAgICAgICBTb21ldGhpbmcua2xhc3NfZGljdCgpCgogICAgICAgIHNvbWV0aGluZyA9IFNvbWV0aGluZygpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzb21ldGhpbmcuc3RhdGljKCdmMDAnKSwgJ2YwMCcpCiAgICAgICAgc29tZXRoaW5nLmtsYXNzKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNvbWV0aGluZy5zdGF0aWNfZGljdCgnZjAwJyksICdmMDAnKQogICAgICAgIHNvbWV0aGluZy5rbGFzc19kaWN0KCkKCgogICAgZGVmIHRlc3RfcGF0Y2hfc3BlY19zZXQoc2VsZik6CiAgICAgICAgQHBhdGNoKCclcy5Tb21lQ2xhc3MnICUgX19uYW1lX18sIHNwZWM9U29tZUNsYXNzLCBzcGVjX3NldD1UcnVlKQogICAgICAgIGRlZiB0ZXN0KE1vY2tDbGFzcyk6CiAgICAgICAgICAgIE1vY2tDbGFzcy56ID0gJ2ZvbycKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIHRlc3QpCgogICAgICAgIEBwYXRjaC5vYmplY3Qoc3VwcG9ydCwgJ1NvbWVDbGFzcycsIHNwZWM9U29tZUNsYXNzLCBzcGVjX3NldD1UcnVlKQogICAgICAgIGRlZiB0ZXN0KE1vY2tDbGFzcyk6CiAgICAgICAgICAgIE1vY2tDbGFzcy56ID0gJ2ZvbycKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIHRlc3QpCiAgICAgICAgQHBhdGNoKCclcy5Tb21lQ2xhc3MnICUgX19uYW1lX18sIHNwZWNfc2V0PVRydWUpCiAgICAgICAgZGVmIHRlc3QoTW9ja0NsYXNzKToKICAgICAgICAgICAgTW9ja0NsYXNzLnogPSAnZm9vJwoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgdGVzdCkKCiAgICAgICAgQHBhdGNoLm9iamVjdChzdXBwb3J0LCAnU29tZUNsYXNzJywgc3BlY19zZXQ9VHJ1ZSkKICAgICAgICBkZWYgdGVzdChNb2NrQ2xhc3MpOgogICAgICAgICAgICBNb2NrQ2xhc3MueiA9ICdmb28nCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCB0ZXN0KQoKCiAgICBkZWYgdGVzdF9zcGVjX3NldF9pbmhlcml0KHNlbGYpOgogICAgICAgIEBwYXRjaCgnJXMuU29tZUNsYXNzJyAlIF9fbmFtZV9fLCBzcGVjX3NldD1UcnVlKQogICAgICAgIGRlZiB0ZXN0KE1vY2tDbGFzcyk6CiAgICAgICAgICAgIGluc3RhbmNlID0gTW9ja0NsYXNzKCkKICAgICAgICAgICAgaW5zdGFuY2UueiA9ICdmb28nCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCB0ZXN0KQoKCiAgICBkZWYgdGVzdF9wYXRjaF9zdGFydF9zdG9wKHNlbGYpOgogICAgICAgIG9yaWdpbmFsID0gc29tZXRoaW5nCiAgICAgICAgcGF0Y2hlciA9IHBhdGNoKCclcy5zb21ldGhpbmcnICUgX19uYW1lX18pCiAgICAgICAgc2VsZi5hc3NlcnRJcyhzb21ldGhpbmcsIG9yaWdpbmFsKQogICAgICAgIG1vY2sgPSBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNOb3QobW9jaywgb3JpZ2luYWwpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMoc29tZXRoaW5nLCBtb2NrKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHBhdGNoZXIuc3RvcCgpCiAgICAgICAgc2VsZi5hc3NlcnRJcyhzb21ldGhpbmcsIG9yaWdpbmFsKQoKCiAgICBkZWYgdGVzdF9zdG9wX3dpdGhvdXRfc3RhcnQoc2VsZik6CiAgICAgICAgcGF0Y2hlciA9IHBhdGNoKGZvb19uYW1lLCAnYmFyJywgMykKCiAgICAgICAgIyBjYWxsaW5nIHN0b3Agd2l0aG91dCBzdGFydCB1c2VkIHRvIHByb2R1Y2UgYSB2ZXJ5IG9ic2N1cmUgZXJyb3IKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhSdW50aW1lRXJyb3IsIHBhdGNoZXIuc3RvcCkKCgogICAgZGVmIHRlc3RfcGF0Y2hvYmplY3Rfc3RhcnRfc3RvcChzZWxmKToKICAgICAgICBvcmlnaW5hbCA9IHNvbWV0aGluZwogICAgICAgIHBhdGNoZXIgPSBwYXRjaC5vYmplY3QoUFRNb2R1bGUsICdzb21ldGhpbmcnLCAnZm9vJykKICAgICAgICBzZWxmLmFzc2VydElzKHNvbWV0aGluZywgb3JpZ2luYWwpCiAgICAgICAgcmVwbGFjZWQgPSBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVwbGFjZWQsICdmb28nKQogICAgICAgICAgICBzZWxmLmFzc2VydElzKHNvbWV0aGluZywgcmVwbGFjZWQpCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgcGF0Y2hlci5zdG9wKCkKICAgICAgICBzZWxmLmFzc2VydElzKHNvbWV0aGluZywgb3JpZ2luYWwpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX2RpY3Rfc3RhcnRfc3RvcChzZWxmKToKICAgICAgICBkID0geydmb28nOiAnYmFyJ30KICAgICAgICBvcmlnaW5hbCA9IGQuY29weSgpCiAgICAgICAgcGF0Y2hlciA9IHBhdGNoLmRpY3QoZCwgWygnc3BhbScsICdlZ2dzJyldLCBjbGVhcj1UcnVlKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZCwgb3JpZ2luYWwpCgogICAgICAgIHBhdGNoZXIuc3RhcnQoKQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChkLCB7J3NwYW0nOiAnZWdncyd9KQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHBhdGNoZXIuc3RvcCgpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChkLCBvcmlnaW5hbCkKCgogICAgZGVmIHRlc3RfcGF0Y2hfZGljdF9jbGFzc19kZWNvcmF0b3Ioc2VsZik6CiAgICAgICAgdGhpcyA9IHNlbGYKICAgICAgICBkID0geydzcGFtJzogJ2VnZ3MnfQogICAgICAgIG9yaWdpbmFsID0gZC5jb3B5KCkKCiAgICAgICAgY2xhc3MgVGVzdChvYmplY3QpOgogICAgICAgICAgICBkZWYgdGVzdF9maXJzdChzZWxmKToKICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXF1YWwoZCwgeydmb28nOiAnYmFyJ30pCiAgICAgICAgICAgIGRlZiB0ZXN0X3NlY29uZChzZWxmKToKICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXF1YWwoZCwgeydmb28nOiAnYmFyJ30pCgogICAgICAgIFRlc3QgPSBwYXRjaC5kaWN0KGQsIHsnZm9vJzogJ2Jhcid9LCBjbGVhcj1UcnVlKShUZXN0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZCwgb3JpZ2luYWwpCgogICAgICAgIHRlc3QgPSBUZXN0KCkKCiAgICAgICAgdGVzdC50ZXN0X2ZpcnN0KCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGQsIG9yaWdpbmFsKQoKICAgICAgICB0ZXN0LnRlc3Rfc2Vjb25kKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGQsIG9yaWdpbmFsKQoKICAgICAgICB0ZXN0ID0gVGVzdCgpCgogICAgICAgIHRlc3QudGVzdF9maXJzdCgpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChkLCBvcmlnaW5hbCkKCiAgICAgICAgdGVzdC50ZXN0X3NlY29uZCgpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChkLCBvcmlnaW5hbCkKCgogICAgZGVmIHRlc3RfZ2V0X29ubHlfcHJveHkoc2VsZik6CiAgICAgICAgY2xhc3MgU29tZXRoaW5nKG9iamVjdCk6CiAgICAgICAgICAgIGZvbyA9ICdmb28nCiAgICAgICAgY2xhc3MgU29tZXRoaW5nRWxzZToKICAgICAgICAgICAgZm9vID0gJ2ZvbycKCiAgICAgICAgZm9yIHRoaW5nIGluIFNvbWV0aGluZywgU29tZXRoaW5nRWxzZSwgU29tZXRoaW5nKCksIFNvbWV0aGluZ0Vsc2U6CiAgICAgICAgICAgIHByb3h5ID0gX2dldF9wcm94eSh0aGluZykKCiAgICAgICAgICAgIEBwYXRjaC5vYmplY3QocHJveHksICdmb28nLCAnYmFyJykKICAgICAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJveHkuZm9vLCAnYmFyJykKICAgICAgICAgICAgdGVzdCgpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJveHkuZm9vLCAnZm9vJykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCh0aGluZy5mb28sICdmb28nKQogICAgICAgICAgICBzZWxmLmFzc2VydE5vdEluKCdmb28nLCBwcm94eS5fX2RpY3RfXykKCgogICAgZGVmIHRlc3RfZ2V0X3NldF9kZWxldGVfcHJveHkoc2VsZik6CiAgICAgICAgY2xhc3MgU29tZXRoaW5nKG9iamVjdCk6CiAgICAgICAgICAgIGZvbyA9ICdmb28nCiAgICAgICAgY2xhc3MgU29tZXRoaW5nRWxzZToKICAgICAgICAgICAgZm9vID0gJ2ZvbycKCiAgICAgICAgZm9yIHRoaW5nIGluIFNvbWV0aGluZywgU29tZXRoaW5nRWxzZSwgU29tZXRoaW5nKCksIFNvbWV0aGluZ0Vsc2U6CiAgICAgICAgICAgIHByb3h5ID0gX2dldF9wcm94eShTb21ldGhpbmcsIGdldF9vbmx5PUZhbHNlKQoKICAgICAgICAgICAgQHBhdGNoLm9iamVjdChwcm94eSwgJ2ZvbycsICdiYXInKQogICAgICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm94eS5mb28sICdiYXInKQogICAgICAgICAgICB0ZXN0KCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm94eS5mb28sICdmb28nKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHRoaW5nLmZvbywgJ2ZvbycpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0Tm90SW4oJ2ZvbycsIHByb3h5Ll9fZGljdF9fKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9rZXl3b3JkX2FyZ3Moc2VsZik6CiAgICAgICAga3dhcmdzID0geydzaWRlX2VmZmVjdCc6IEtleUVycm9yLCAnZm9vLmJhci5yZXR1cm5fdmFsdWUnOiAzMywKICAgICAgICAgICAgICAgICAgJ2Zvbyc6IE1hZ2ljTW9jaygpfQoKICAgICAgICBwYXRjaGVyID0gcGF0Y2goZm9vX25hbWUsICoqa3dhcmdzKQogICAgICAgIG1vY2sgPSBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICBwYXRjaGVyLnN0b3AoKQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhLZXlFcnJvciwgbW9jaykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suZm9vLmJhcigpLCAzMykKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jay5mb28sIE1hZ2ljTW9jaykKCgogICAgZGVmIHRlc3RfcGF0Y2hfb2JqZWN0X2tleXdvcmRfYXJncyhzZWxmKToKICAgICAgICBrd2FyZ3MgPSB7J3NpZGVfZWZmZWN0JzogS2V5RXJyb3IsICdmb28uYmFyLnJldHVybl92YWx1ZSc6IDMzLAogICAgICAgICAgICAgICAgICAnZm9vJzogTWFnaWNNb2NrKCl9CgogICAgICAgIHBhdGNoZXIgPSBwYXRjaC5vYmplY3QoRm9vLCAnZicsICoqa3dhcmdzKQogICAgICAgIG1vY2sgPSBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICBwYXRjaGVyLnN0b3AoKQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhLZXlFcnJvciwgbW9jaykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suZm9vLmJhcigpLCAzMykKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jay5mb28sIE1hZ2ljTW9jaykKCgogICAgZGVmIHRlc3RfcGF0Y2hfZGljdF9rZXl3b3JkX2FyZ3Moc2VsZik6CiAgICAgICAgb3JpZ2luYWwgPSB7J2Zvbyc6ICdiYXInfQogICAgICAgIGNvcHkgPSBvcmlnaW5hbC5jb3B5KCkKCiAgICAgICAgcGF0Y2hlciA9IHBhdGNoLmRpY3Qob3JpZ2luYWwsIGZvbz0zLCBiYXI9NCwgYmF6PTUpCiAgICAgICAgcGF0Y2hlci5zdGFydCgpCgogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChvcmlnaW5hbCwgZGljdChmb289MywgYmFyPTQsIGJhej01KSkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwYXRjaGVyLnN0b3AoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG9yaWdpbmFsLCBjb3B5KQoKCiAgICBkZWYgdGVzdF9hdXRvc3BlYyhzZWxmKToKICAgICAgICBjbGFzcyBCb28ob2JqZWN0KToKICAgICAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIGEpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBkZWYgZihzZWxmLCBhKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIGcoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGZvbyA9ICdiYXInCgogICAgICAgICAgICBjbGFzcyBCYXIob2JqZWN0KToKICAgICAgICAgICAgICAgIGRlZiBhKHNlbGYpOgogICAgICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgZGVmIF90ZXN0KG1vY2spOgogICAgICAgICAgICBtb2NrKDEpCiAgICAgICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF93aXRoKDEpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jaykKCiAgICAgICAgZGVmIF90ZXN0Mihtb2NrKToKICAgICAgICAgICAgbW9jay5mKDEpCiAgICAgICAgICAgIG1vY2suZi5hc3NlcnRfY2FsbGVkX3dpdGgoMSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrLmYpCgogICAgICAgICAgICBtb2NrLmcoKQogICAgICAgICAgICBtb2NrLmcuYXNzZXJ0X2NhbGxlZF93aXRoKCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrLmcsIDEpCgogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgbW9jaywgJ2gnKQoKICAgICAgICAgICAgbW9jay5mb28ubG93ZXIoKQogICAgICAgICAgICBtb2NrLmZvby5sb3dlci5hc3NlcnRfY2FsbGVkX3dpdGgoKQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgbW9jay5mb28sICdiYXInKQoKICAgICAgICAgICAgbW9jay5CYXIoKQogICAgICAgICAgICBtb2NrLkJhci5hc3NlcnRfY2FsbGVkX3dpdGgoKQoKICAgICAgICAgICAgbW9jay5CYXIuYSgpCiAgICAgICAgICAgIG1vY2suQmFyLmEuYXNzZXJ0X2NhbGxlZF93aXRoKCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrLkJhci5hLCAxKQoKICAgICAgICAgICAgbW9jay5CYXIoKS5hKCkKICAgICAgICAgICAgbW9jay5CYXIoKS5hLmFzc2VydF9jYWxsZWRfd2l0aCgpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jay5CYXIoKS5hLCAxKQoKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIG1vY2suQmFyLCAnYicpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBnZXRhdHRyLCBtb2NrLkJhcigpLCAnYicpCgogICAgICAgIGRlZiBmdW5jdGlvbihtb2NrKToKICAgICAgICAgICAgX3Rlc3QobW9jaykKICAgICAgICAgICAgX3Rlc3QyKG1vY2spCiAgICAgICAgICAgIF90ZXN0Mihtb2NrKDEpKQogICAgICAgICAgICBzZWxmLmFzc2VydElzKG1vY2ssIEZvbykKICAgICAgICAgICAgcmV0dXJuIG1vY2sKCiAgICAgICAgdGVzdCA9IHBhdGNoKGZvb19uYW1lLCBhdXRvc3BlYz1UcnVlKShmdW5jdGlvbikKCiAgICAgICAgbW9jayA9IHRlc3QoKQogICAgICAgIHNlbGYuYXNzZXJ0SXNOb3QoRm9vLCBtb2NrKQogICAgICAgICMgdGVzdCBwYXRjaGluZyBhIHNlY29uZCB0aW1lIHdvcmtzCiAgICAgICAgdGVzdCgpCgogICAgICAgIG1vZHVsZSA9IHN5cy5tb2R1bGVzW19fbmFtZV9fXQogICAgICAgIHRlc3QgPSBwYXRjaC5vYmplY3QobW9kdWxlLCAnRm9vJywgYXV0b3NwZWM9VHJ1ZSkoZnVuY3Rpb24pCgogICAgICAgIG1vY2sgPSB0ZXN0KCkKICAgICAgICBzZWxmLmFzc2VydElzTm90KEZvbywgbW9jaykKICAgICAgICAjIHRlc3QgcGF0Y2hpbmcgYSBzZWNvbmQgdGltZSB3b3JrcwogICAgICAgIHRlc3QoKQoKCiAgICBkZWYgdGVzdF9hdXRvc3BlY19mdW5jdGlvbihzZWxmKToKICAgICAgICBAcGF0Y2goJyVzLmZ1bmN0aW9uJyAlIF9fbmFtZV9fLCBhdXRvc3BlYz1UcnVlKQogICAgICAgIGRlZiB0ZXN0KG1vY2spOgogICAgICAgICAgICBmdW5jdGlvbigxKQogICAgICAgICAgICBmdW5jdGlvbi5hc3NlcnRfY2FsbGVkX3dpdGgoMSkKICAgICAgICAgICAgZnVuY3Rpb24oMiwgMykKICAgICAgICAgICAgZnVuY3Rpb24uYXNzZXJ0X2NhbGxlZF93aXRoKDIsIDMpCgogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGZ1bmN0aW9uKQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgZnVuY3Rpb24sICdmb28nKQoKICAgICAgICB0ZXN0KCkKCgogICAgZGVmIHRlc3RfYXV0b3NwZWNfa2V5d29yZHMoc2VsZik6CiAgICAgICAgQHBhdGNoKCclcy5mdW5jdGlvbicgJSBfX25hbWVfXywgYXV0b3NwZWM9VHJ1ZSwKICAgICAgICAgICAgICAgcmV0dXJuX3ZhbHVlPTMpCiAgICAgICAgZGVmIHRlc3QobW9ja19mdW5jdGlvbik6CiAgICAgICAgICAgICNzZWxmLmFzc2VydEVxdWFsKGZ1bmN0aW9uLmFiYywgJ2ZvbycpCiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigxLCAyKQoKICAgICAgICByZXN1bHQgPSB0ZXN0KCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdCwgMykKCgogICAgZGVmIHRlc3RfYXV0b3NwZWNfd2l0aF9uZXcoc2VsZik6CiAgICAgICAgcGF0Y2hlciA9IHBhdGNoKCclcy5mdW5jdGlvbicgJSBfX25hbWVfXywgbmV3PTMsIGF1dG9zcGVjPVRydWUpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBwYXRjaGVyLnN0YXJ0KQoKICAgICAgICBtb2R1bGUgPSBzeXMubW9kdWxlc1tfX25hbWVfX10KICAgICAgICBwYXRjaGVyID0gcGF0Y2gub2JqZWN0KG1vZHVsZSwgJ2Z1bmN0aW9uJywgbmV3PTMsIGF1dG9zcGVjPVRydWUpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBwYXRjaGVyLnN0YXJ0KQoKCiAgICBkZWYgdGVzdF9hdXRvc3BlY193aXRoX29iamVjdChzZWxmKToKICAgICAgICBjbGFzcyBCYXIoRm9vKToKICAgICAgICAgICAgZXh0cmEgPSBbXQoKICAgICAgICBwYXRjaGVyID0gcGF0Y2goZm9vX25hbWUsIGF1dG9zcGVjPUJhcikKICAgICAgICBtb2NrID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jaywgQmFyKQogICAgICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jay5leHRyYSwgbGlzdCkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwYXRjaGVyLnN0b3AoKQoKCiAgICBkZWYgdGVzdF9hdXRvc3BlY19pbmhlcml0cyhzZWxmKToKICAgICAgICBGb29DbGFzcyA9IEZvbwogICAgICAgIHBhdGNoZXIgPSBwYXRjaChmb29fbmFtZSwgYXV0b3NwZWM9VHJ1ZSkKICAgICAgICBtb2NrID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jaywgRm9vQ2xhc3MpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrKDMpLCBGb29DbGFzcykKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwYXRjaGVyLnN0b3AoKQoKCiAgICBkZWYgdGVzdF9hdXRvc3BlY19uYW1lKHNlbGYpOgogICAgICAgIHBhdGNoZXIgPSBwYXRjaChmb29fbmFtZSwgYXV0b3NwZWM9VHJ1ZSkKICAgICAgICBtb2NrID0gcGF0Y2hlci5zdGFydCgpCgogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigiIG5hbWU9J0ZvbyciLCByZXByKG1vY2spKQogICAgICAgICAgICBzZWxmLmFzc2VydEluKCIgbmFtZT0nRm9vLmYnIiwgcmVwcihtb2NrLmYpKQogICAgICAgICAgICBzZWxmLmFzc2VydEluKCIgbmFtZT0nRm9vKCknIiwgcmVwcihtb2NrKE5vbmUpKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigiIG5hbWU9J0ZvbygpLmYnIiwgcmVwcihtb2NrKE5vbmUpLmYpKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHBhdGNoZXIuc3RvcCgpCgoKICAgIGRlZiB0ZXN0X3RyYWNlYmFja3Moc2VsZik6CiAgICAgICAgQHBhdGNoLm9iamVjdChGb28sICdmJywgb2JqZWN0KCkpCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgcmFpc2UgQXNzZXJ0aW9uRXJyb3IKICAgICAgICB0cnk6CiAgICAgICAgICAgIHRlc3QoKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgZXJyID0gc3lzLmV4Y19pbmZvKCkKCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGV4dFRlc3RSZXN1bHQoTm9uZSwgTm9uZSwgMCkKICAgICAgICB0cmFjZWJhY2sgPSByZXN1bHQuX2V4Y19pbmZvX3RvX3N0cmluZyhlcnIsIHNlbGYpCiAgICAgICAgc2VsZi5hc3NlcnRJbigncmFpc2UgQXNzZXJ0aW9uRXJyb3InLCB0cmFjZWJhY2spCgoKICAgIGRlZiB0ZXN0X25ld19jYWxsYWJsZV9wYXRjaChzZWxmKToKICAgICAgICBwYXRjaGVyID0gcGF0Y2goZm9vX25hbWUsIG5ld19jYWxsYWJsZT1Ob25DYWxsYWJsZU1hZ2ljTW9jaykKCiAgICAgICAgbTEgPSBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICBwYXRjaGVyLnN0b3AoKQogICAgICAgIG0yID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgcGF0Y2hlci5zdG9wKCkKCiAgICAgICAgc2VsZi5hc3NlcnRJc05vdChtMSwgbTIpCiAgICAgICAgZm9yIG1vY2sgaW4gbTEsIG0yOgogICAgICAgICAgICBzZWxmLmFzc2VydE5vdENhbGxhYmxlKG0xKQoKCiAgICBkZWYgdGVzdF9uZXdfY2FsbGFibGVfcGF0Y2hfb2JqZWN0KHNlbGYpOgogICAgICAgIHBhdGNoZXIgPSBwYXRjaC5vYmplY3QoRm9vLCAnZicsIG5ld19jYWxsYWJsZT1Ob25DYWxsYWJsZU1hZ2ljTW9jaykKCiAgICAgICAgbTEgPSBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICBwYXRjaGVyLnN0b3AoKQogICAgICAgIG0yID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgcGF0Y2hlci5zdG9wKCkKCiAgICAgICAgc2VsZi5hc3NlcnRJc05vdChtMSwgbTIpCiAgICAgICAgZm9yIG1vY2sgaW4gbTEsIG0yOgogICAgICAgICAgICBzZWxmLmFzc2VydE5vdENhbGxhYmxlKG0xKQoKCiAgICBkZWYgdGVzdF9uZXdfY2FsbGFibGVfa2V5d29yZF9hcmd1bWVudHMoc2VsZik6CiAgICAgICAgY2xhc3MgQmFyKG9iamVjdCk6CiAgICAgICAgICAgIGt3YXJncyA9IE5vbmUKICAgICAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsICoqa3dhcmdzKToKICAgICAgICAgICAgICAgIEJhci5rd2FyZ3MgPSBrd2FyZ3MKCiAgICAgICAgcGF0Y2hlciA9IHBhdGNoKGZvb19uYW1lLCBuZXdfY2FsbGFibGU9QmFyLCBhcmcxPTEsIGFyZzI9MikKICAgICAgICBtID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmFzc2VydElzKHR5cGUobSksIEJhcikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChCYXIua3dhcmdzLCBkaWN0KGFyZzE9MSwgYXJnMj0yKSkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwYXRjaGVyLnN0b3AoKQoKCiAgICBkZWYgdGVzdF9uZXdfY2FsbGFibGVfc3BlYyhzZWxmKToKICAgICAgICBjbGFzcyBCYXIob2JqZWN0KToKICAgICAgICAgICAga3dhcmdzID0gTm9uZQogICAgICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgICAgICAgICAgQmFyLmt3YXJncyA9IGt3YXJncwoKICAgICAgICBwYXRjaGVyID0gcGF0Y2goZm9vX25hbWUsIG5ld19jYWxsYWJsZT1CYXIsIHNwZWM9QmFyKQogICAgICAgIHBhdGNoZXIuc3RhcnQoKQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChCYXIua3dhcmdzLCBkaWN0KHNwZWM9QmFyKSkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwYXRjaGVyLnN0b3AoKQoKICAgICAgICBwYXRjaGVyID0gcGF0Y2goZm9vX25hbWUsIG5ld19jYWxsYWJsZT1CYXIsIHNwZWNfc2V0PUJhcikKICAgICAgICBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoQmFyLmt3YXJncywgZGljdChzcGVjX3NldD1CYXIpKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHBhdGNoZXIuc3RvcCgpCgoKICAgIGRlZiB0ZXN0X25ld19jYWxsYWJsZV9jcmVhdGUoc2VsZik6CiAgICAgICAgbm9uX2V4aXN0ZW50X2F0dHIgPSAnJXMud2VlZWVlJyAlIGZvb19uYW1lCiAgICAgICAgcCA9IHBhdGNoKG5vbl9leGlzdGVudF9hdHRyLCBuZXdfY2FsbGFibGU9Tm9uQ2FsbGFibGVNb2NrKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBwLnN0YXJ0KQoKICAgICAgICBwID0gcGF0Y2gobm9uX2V4aXN0ZW50X2F0dHIsIG5ld19jYWxsYWJsZT1Ob25DYWxsYWJsZU1vY2ssCiAgICAgICAgICAgICAgICAgIGNyZWF0ZT1UcnVlKQogICAgICAgIG0gPSBwLnN0YXJ0KCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0Tm90Q2FsbGFibGUobSwgbWFnaWM9RmFsc2UpCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgcC5zdG9wKCkKCgogICAgZGVmIHRlc3RfbmV3X2NhbGxhYmxlX2luY29tcGF0aWJsZV93aXRoX25ldyhzZWxmKToKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcygKICAgICAgICAgICAgVmFsdWVFcnJvciwgcGF0Y2gsIGZvb19uYW1lLCBuZXc9b2JqZWN0KCksIG5ld19jYWxsYWJsZT1NYWdpY01vY2sKICAgICAgICApCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgIFZhbHVlRXJyb3IsIHBhdGNoLm9iamVjdCwgRm9vLCAnZicsIG5ldz1vYmplY3QoKSwKICAgICAgICAgICAgbmV3X2NhbGxhYmxlPU1hZ2ljTW9jawogICAgICAgICkKCgogICAgZGVmIHRlc3RfbmV3X2NhbGxhYmxlX2luY29tcGF0aWJsZV93aXRoX2F1dG9zcGVjKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKAogICAgICAgICAgICBWYWx1ZUVycm9yLCBwYXRjaCwgZm9vX25hbWUsIG5ld19jYWxsYWJsZT1NYWdpY01vY2ssCiAgICAgICAgICAgIGF1dG9zcGVjPVRydWUKICAgICAgICApCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgIFZhbHVlRXJyb3IsIHBhdGNoLm9iamVjdCwgRm9vLCAnZicsIG5ld19jYWxsYWJsZT1NYWdpY01vY2ssCiAgICAgICAgICAgIGF1dG9zcGVjPVRydWUKICAgICAgICApCgoKICAgIGRlZiB0ZXN0X25ld19jYWxsYWJsZV9pbmhlcml0X2Zvcl9tb2NrcyhzZWxmKToKICAgICAgICBjbGFzcyBNb2NrU3ViKE1vY2spOgogICAgICAgICAgICBwYXNzCgogICAgICAgIE1vY2tDbGFzc2VzID0gKAogICAgICAgICAgICBOb25DYWxsYWJsZU1vY2ssIE5vbkNhbGxhYmxlTWFnaWNNb2NrLCBNYWdpY01vY2ssIE1vY2ssIE1vY2tTdWIKICAgICAgICApCiAgICAgICAgZm9yIEtsYXNzIGluIE1vY2tDbGFzc2VzOgogICAgICAgICAgICBmb3IgYXJnIGluICdzcGVjJywgJ3NwZWNfc2V0JzoKICAgICAgICAgICAgICAgIGt3YXJncyA9IHthcmc6IFRydWV9CiAgICAgICAgICAgICAgICBwID0gcGF0Y2goZm9vX25hbWUsIG5ld19jYWxsYWJsZT1LbGFzcywgKiprd2FyZ3MpCiAgICAgICAgICAgICAgICBtID0gcC5zdGFydCgpCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBtLnJldHVybl92YWx1ZQogICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBnZXRhdHRyLCBpbnN0YW5jZSwgJ3gnKQogICAgICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgICAgICBwLnN0b3AoKQoKCiAgICBkZWYgdGVzdF9uZXdfY2FsbGFibGVfaW5oZXJpdF9ub25fbW9jayhzZWxmKToKICAgICAgICBjbGFzcyBOb3RBTW9jayhvYmplY3QpOgogICAgICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgc3BlYyk6CiAgICAgICAgICAgICAgICBzZWxmLnNwZWMgPSBzcGVjCgogICAgICAgIHAgPSBwYXRjaChmb29fbmFtZSwgbmV3X2NhbGxhYmxlPU5vdEFNb2NrLCBzcGVjPVRydWUpCiAgICAgICAgbSA9IHAuc3RhcnQoKQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzX2luc3RhbmNlKG0sIE5vdEFNb2NrKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIG0sICdyZXR1cm5fdmFsdWUnKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHAuc3RvcCgpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobS5zcGVjLCBGb28pCgoKICAgIGRlZiB0ZXN0X25ld19jYWxsYWJsZV9jbGFzc19kZWNvcmF0aW5nKHNlbGYpOgogICAgICAgIHRlc3QgPSBzZWxmCiAgICAgICAgb3JpZ2luYWwgPSBGb28KICAgICAgICBjbGFzcyBTb21lVGVzdChvYmplY3QpOgoKICAgICAgICAgICAgZGVmIF90ZXN0KHNlbGYsIG1vY2tfZm9vKToKICAgICAgICAgICAgICAgIHRlc3QuYXNzZXJ0SXNOb3QoRm9vLCBvcmlnaW5hbCkKICAgICAgICAgICAgICAgIHRlc3QuYXNzZXJ0SXMoRm9vLCBtb2NrX2ZvbykKICAgICAgICAgICAgICAgIHRlc3QuYXNzZXJ0SXNJbnN0YW5jZShGb28sIFNvbWVDbGFzcykKCiAgICAgICAgICAgIGRlZiB0ZXN0X3R3byhzZWxmLCBtb2NrX2Zvbyk6CiAgICAgICAgICAgICAgICBzZWxmLl90ZXN0KG1vY2tfZm9vKQogICAgICAgICAgICBkZWYgdGVzdF9vbmUoc2VsZiwgbW9ja19mb28pOgogICAgICAgICAgICAgICAgc2VsZi5fdGVzdChtb2NrX2ZvbykKCiAgICAgICAgU29tZVRlc3QgPSBwYXRjaChmb29fbmFtZSwgbmV3X2NhbGxhYmxlPVNvbWVDbGFzcykoU29tZVRlc3QpCiAgICAgICAgU29tZVRlc3QoKS50ZXN0X29uZSgpCiAgICAgICAgU29tZVRlc3QoKS50ZXN0X3R3bygpCiAgICAgICAgc2VsZi5hc3NlcnRJcyhGb28sIG9yaWdpbmFsKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9tdWx0aXBsZShzZWxmKToKICAgICAgICBvcmlnaW5hbF9mb28gPSBGb28KICAgICAgICBvcmlnaW5hbF9mID0gRm9vLmYKICAgICAgICBvcmlnaW5hbF9nID0gRm9vLmcKCiAgICAgICAgcGF0Y2hlcjEgPSBwYXRjaC5tdWx0aXBsZShmb29fbmFtZSwgZj0xLCBnPTIpCiAgICAgICAgcGF0Y2hlcjIgPSBwYXRjaC5tdWx0aXBsZShGb28sIGY9MSwgZz0yKQoKICAgICAgICBmb3IgcGF0Y2hlciBpbiBwYXRjaGVyMSwgcGF0Y2hlcjI6CiAgICAgICAgICAgIHBhdGNoZXIuc3RhcnQoKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvbywgb3JpZ2luYWxfZm9vKQogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgMSkKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLmcsIDIpCiAgICAgICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgICAgICBwYXRjaGVyLnN0b3AoKQoKICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhGb28sIG9yaWdpbmFsX2ZvbykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgb3JpZ2luYWxfZikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZywgb3JpZ2luYWxfZykKCgogICAgICAgIEBwYXRjaC5tdWx0aXBsZShmb29fbmFtZSwgZj0zLCBnPTQpCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhGb28sIG9yaWdpbmFsX2ZvbykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgMykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZywgNCkKCiAgICAgICAgdGVzdCgpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX211bHRpcGxlX25vX2t3YXJncyhzZWxmKToKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhWYWx1ZUVycm9yLCBwYXRjaC5tdWx0aXBsZSwgZm9vX25hbWUpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVmFsdWVFcnJvciwgcGF0Y2gubXVsdGlwbGUsIEZvbykKCgogICAgZGVmIHRlc3RfcGF0Y2hfbXVsdGlwbGVfY3JlYXRlX21vY2tzKHNlbGYpOgogICAgICAgIG9yaWdpbmFsX2ZvbyA9IEZvbwogICAgICAgIG9yaWdpbmFsX2YgPSBGb28uZgogICAgICAgIG9yaWdpbmFsX2cgPSBGb28uZwoKICAgICAgICBAcGF0Y2gubXVsdGlwbGUoZm9vX25hbWUsIGY9REVGQVVMVCwgZz0zLCBmb289REVGQVVMVCkKICAgICAgICBkZWYgdGVzdChmLCBmb28pOgogICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvbywgb3JpZ2luYWxfZm9vKQogICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvby5mLCBmKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZvby5nLCAzKQogICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvby5mb28sIGZvbykKICAgICAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzX2luc3RhbmNlKGYsIE1hZ2ljTW9jaykpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShpc19pbnN0YW5jZShmb28sIE1hZ2ljTW9jaykpCgogICAgICAgIHRlc3QoKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLmYsIG9yaWdpbmFsX2YpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZywgb3JpZ2luYWxfZykKCgogICAgZGVmIHRlc3RfcGF0Y2hfbXVsdGlwbGVfY3JlYXRlX21vY2tzX2RpZmZlcmVudF9vcmRlcihzZWxmKToKICAgICAgICAjIGJ1ZyByZXZlYWxlZCBieSBKeXRob24hCiAgICAgICAgb3JpZ2luYWxfZiA9IEZvby5mCiAgICAgICAgb3JpZ2luYWxfZyA9IEZvby5nCgogICAgICAgIHBhdGNoZXIgPSBwYXRjaC5vYmplY3QoRm9vLCAnZicsIDMpCiAgICAgICAgcGF0Y2hlci5hdHRyaWJ1dGVfbmFtZSA9ICdmJwoKICAgICAgICBvdGhlciA9IHBhdGNoLm9iamVjdChGb28sICdnJywgREVGQVVMVCkKICAgICAgICBvdGhlci5hdHRyaWJ1dGVfbmFtZSA9ICdnJwogICAgICAgIHBhdGNoZXIuYWRkaXRpb25hbF9wYXRjaGVycyA9IFtvdGhlcl0KCiAgICAgICAgQHBhdGNoZXIKICAgICAgICBkZWYgdGVzdChnKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhGb28uZywgZykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgMykKCiAgICAgICAgdGVzdCgpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgb3JpZ2luYWxfZikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZvby5nLCBvcmlnaW5hbF9nKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9tdWx0aXBsZV9zdGFja2VkX2RlY29yYXRvcnMoc2VsZik6CiAgICAgICAgb3JpZ2luYWxfZm9vID0gRm9vCiAgICAgICAgb3JpZ2luYWxfZiA9IEZvby5mCiAgICAgICAgb3JpZ2luYWxfZyA9IEZvby5nCgogICAgICAgIEBwYXRjaC5tdWx0aXBsZShmb29fbmFtZSwgZj1ERUZBVUxUKQogICAgICAgIEBwYXRjaC5tdWx0aXBsZShmb29fbmFtZSwgZm9vPURFRkFVTFQpCiAgICAgICAgQHBhdGNoKGZvb19uYW1lICsgJy5nJykKICAgICAgICBkZWYgdGVzdDEoZywgKiprd2FyZ3MpOgogICAgICAgICAgICBfdGVzdChnLCAqKmt3YXJncykKCiAgICAgICAgQHBhdGNoLm11bHRpcGxlKGZvb19uYW1lLCBmPURFRkFVTFQpCiAgICAgICAgQHBhdGNoKGZvb19uYW1lICsgJy5nJykKICAgICAgICBAcGF0Y2gubXVsdGlwbGUoZm9vX25hbWUsIGZvbz1ERUZBVUxUKQogICAgICAgIGRlZiB0ZXN0MihnLCAqKmt3YXJncyk6CiAgICAgICAgICAgIF90ZXN0KGcsICoqa3dhcmdzKQoKICAgICAgICBAcGF0Y2goZm9vX25hbWUgKyAnLmcnKQogICAgICAgIEBwYXRjaC5tdWx0aXBsZShmb29fbmFtZSwgZj1ERUZBVUxUKQogICAgICAgIEBwYXRjaC5tdWx0aXBsZShmb29fbmFtZSwgZm9vPURFRkFVTFQpCiAgICAgICAgZGVmIHRlc3QzKGcsICoqa3dhcmdzKToKICAgICAgICAgICAgX3Rlc3QoZywgKiprd2FyZ3MpCgogICAgICAgIGRlZiBfdGVzdChnLCAqKmt3YXJncyk6CiAgICAgICAgICAgIGYgPSBrd2FyZ3MucG9wKCdmJykKICAgICAgICAgICAgZm9vID0ga3dhcmdzLnBvcCgnZm9vJykKICAgICAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShrd2FyZ3MpCgogICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvbywgb3JpZ2luYWxfZm9vKQogICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvby5mLCBmKQogICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvby5nLCBnKQogICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvby5mb28sIGZvbykKICAgICAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzX2luc3RhbmNlKGYsIE1hZ2ljTW9jaykpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShpc19pbnN0YW5jZShnLCBNYWdpY01vY2spKQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UoZm9vLCBNYWdpY01vY2spKQoKICAgICAgICB0ZXN0MSgpCiAgICAgICAgdGVzdDIoKQogICAgICAgIHRlc3QzKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZvby5mLCBvcmlnaW5hbF9mKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLmcsIG9yaWdpbmFsX2cpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX211bHRpcGxlX2NyZWF0ZV9tb2Nrc19wYXRjaGVyKHNlbGYpOgogICAgICAgIG9yaWdpbmFsX2ZvbyA9IEZvbwogICAgICAgIG9yaWdpbmFsX2YgPSBGb28uZgogICAgICAgIG9yaWdpbmFsX2cgPSBGb28uZwoKICAgICAgICBwYXRjaGVyID0gcGF0Y2gubXVsdGlwbGUoZm9vX25hbWUsIGY9REVGQVVMVCwgZz0zLCBmb289REVGQVVMVCkKCiAgICAgICAgcmVzdWx0ID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBmID0gcmVzdWx0WydmJ10KICAgICAgICAgICAgZm9vID0gcmVzdWx0Wydmb28nXQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNldChyZXN1bHQpLCBzZXQoWydmJywgJ2ZvbyddKSkKCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMoRm9vLCBvcmlnaW5hbF9mb28pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMoRm9vLmYsIGYpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMoRm9vLmZvbywgZm9vKQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UoZiwgTWFnaWNNb2NrKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzX2luc3RhbmNlKGZvbywgTWFnaWNNb2NrKSkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwYXRjaGVyLnN0b3AoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZvby5mLCBvcmlnaW5hbF9mKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLmcsIG9yaWdpbmFsX2cpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX211bHRpcGxlX2RlY29yYXRpbmdfY2xhc3Moc2VsZik6CiAgICAgICAgdGVzdCA9IHNlbGYKICAgICAgICBvcmlnaW5hbF9mb28gPSBGb28KICAgICAgICBvcmlnaW5hbF9mID0gRm9vLmYKICAgICAgICBvcmlnaW5hbF9nID0gRm9vLmcKCiAgICAgICAgY2xhc3MgU29tZVRlc3Qob2JqZWN0KToKCiAgICAgICAgICAgIGRlZiBfdGVzdChzZWxmLCBmLCBmb28pOgogICAgICAgICAgICAgICAgdGVzdC5hc3NlcnRJcyhGb28sIG9yaWdpbmFsX2ZvbykKICAgICAgICAgICAgICAgIHRlc3QuYXNzZXJ0SXMoRm9vLmYsIGYpCiAgICAgICAgICAgICAgICB0ZXN0LmFzc2VydEVxdWFsKEZvby5nLCAzKQogICAgICAgICAgICAgICAgdGVzdC5hc3NlcnRJcyhGb28uZm9vLCBmb28pCiAgICAgICAgICAgICAgICB0ZXN0LmFzc2VydFRydWUoaXNfaW5zdGFuY2UoZiwgTWFnaWNNb2NrKSkKICAgICAgICAgICAgICAgIHRlc3QuYXNzZXJ0VHJ1ZShpc19pbnN0YW5jZShmb28sIE1hZ2ljTW9jaykpCgogICAgICAgICAgICBkZWYgdGVzdF90d28oc2VsZiwgZiwgZm9vKToKICAgICAgICAgICAgICAgIHNlbGYuX3Rlc3QoZiwgZm9vKQogICAgICAgICAgICBkZWYgdGVzdF9vbmUoc2VsZiwgZiwgZm9vKToKICAgICAgICAgICAgICAgIHNlbGYuX3Rlc3QoZiwgZm9vKQoKICAgICAgICBTb21lVGVzdCA9IHBhdGNoLm11bHRpcGxlKAogICAgICAgICAgICBmb29fbmFtZSwgZj1ERUZBVUxULCBnPTMsIGZvbz1ERUZBVUxUCiAgICAgICAgKShTb21lVGVzdCkKCiAgICAgICAgdGhpbmcgPSBTb21lVGVzdCgpCiAgICAgICAgdGhpbmcudGVzdF9vbmUoKQogICAgICAgIHRoaW5nLnRlc3RfdHdvKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgb3JpZ2luYWxfZikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZvby5nLCBvcmlnaW5hbF9nKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9tdWx0aXBsZV9jcmVhdGUoc2VsZik6CiAgICAgICAgcGF0Y2hlciA9IHBhdGNoLm11bHRpcGxlKEZvbywgYmxhbT0nYmxhbScpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIHBhdGNoZXIuc3RhcnQpCgogICAgICAgIHBhdGNoZXIgPSBwYXRjaC5tdWx0aXBsZShGb28sIGJsYW09J2JsYW0nLCBjcmVhdGU9VHJ1ZSkKICAgICAgICBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLmJsYW0sICdibGFtJykKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwYXRjaGVyLnN0b3AoKQoKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKGhhc2F0dHIoRm9vLCAnYmxhbScpKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9tdWx0aXBsZV9zcGVjX3NldChzZWxmKToKICAgICAgICAjIGlmIHNwZWNfc2V0IHdvcmtzIHRoZW4gd2UgY2FuIGFzc3VtZSB0aGF0IHNwZWMgYW5kIGF1dG9zcGVjIGFsc28KICAgICAgICAjIHdvcmsgYXMgdGhlIHVuZGVybHlpbmcgbWFjaGluZXJ5IGlzIHRoZSBzYW1lCiAgICAgICAgcGF0Y2hlciA9IHBhdGNoLm11bHRpcGxlKEZvbywgZm9vPURFRkFVTFQsIHNwZWNfc2V0PVsnYScsICdiJ10pCiAgICAgICAgcmVzdWx0ID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZvby5mb28sIHJlc3VsdFsnZm9vJ10pCiAgICAgICAgICAgIEZvby5mb28uYSgxKQogICAgICAgICAgICBGb28uZm9vLmIoMikKICAgICAgICAgICAgRm9vLmZvby5hLmFzc2VydF9jYWxsZWRfd2l0aCgxKQogICAgICAgICAgICBGb28uZm9vLmIuYXNzZXJ0X2NhbGxlZF93aXRoKDIpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBzZXRhdHRyLCBGb28uZm9vLCAnYycsIE5vbmUpCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgcGF0Y2hlci5zdG9wKCkKCgogICAgZGVmIHRlc3RfcGF0Y2hfbXVsdGlwbGVfbmV3X2NhbGxhYmxlKHNlbGYpOgogICAgICAgIGNsYXNzIFRoaW5nKG9iamVjdCk6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgcGF0Y2hlciA9IHBhdGNoLm11bHRpcGxlKAogICAgICAgICAgICBGb28sIGY9REVGQVVMVCwgZz1ERUZBVUxULCBuZXdfY2FsbGFibGU9VGhpbmcKICAgICAgICApCiAgICAgICAgcmVzdWx0ID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvby5mLCByZXN1bHRbJ2YnXSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhGb28uZywgcmVzdWx0WydnJ10pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShGb28uZiwgVGhpbmcpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShGb28uZywgVGhpbmcpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNOb3QoRm9vLmYsIEZvby5nKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHBhdGNoZXIuc3RvcCgpCgoKICAgIGRlZiB0ZXN0X25lc3RlZF9wYXRjaF9mYWlsdXJlKHNlbGYpOgogICAgICAgIG9yaWdpbmFsX2YgPSBGb28uZgogICAgICAgIG9yaWdpbmFsX2cgPSBGb28uZwoKICAgICAgICBAcGF0Y2gub2JqZWN0KEZvbywgJ2cnLCAxKQogICAgICAgIEBwYXRjaC5vYmplY3QoRm9vLCAnbWlzc2luZycsIDEpCiAgICAgICAgQHBhdGNoLm9iamVjdChGb28sICdmJywgMSkKICAgICAgICBkZWYgdGhpbmcxKCk6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgQHBhdGNoLm9iamVjdChGb28sICdtaXNzaW5nJywgMSkKICAgICAgICBAcGF0Y2gub2JqZWN0KEZvbywgJ2cnLCAxKQogICAgICAgIEBwYXRjaC5vYmplY3QoRm9vLCAnZicsIDEpCiAgICAgICAgZGVmIHRoaW5nMigpOgogICAgICAgICAgICBwYXNzCgogICAgICAgIEBwYXRjaC5vYmplY3QoRm9vLCAnZycsIDEpCiAgICAgICAgQHBhdGNoLm9iamVjdChGb28sICdmJywgMSkKICAgICAgICBAcGF0Y2gub2JqZWN0KEZvbywgJ21pc3NpbmcnLCAxKQogICAgICAgIGRlZiB0aGluZzMoKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBmb3IgZnVuYyBpbiB0aGluZzEsIHRoaW5nMiwgdGhpbmczOgogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZnVuYykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgb3JpZ2luYWxfZikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZywgb3JpZ2luYWxfZykKCgogICAgZGVmIHRlc3RfbmV3X2NhbGxhYmxlX2ZhaWx1cmUoc2VsZik6CiAgICAgICAgb3JpZ2luYWxfZiA9IEZvby5mCiAgICAgICAgb3JpZ2luYWxfZyA9IEZvby5nCiAgICAgICAgb3JpZ2luYWxfZm9vID0gRm9vLmZvbwoKICAgICAgICBkZWYgY3Jhc2hlcigpOgogICAgICAgICAgICByYWlzZSBOYW1lRXJyb3IoJ2NyYXNoZXInKQoKICAgICAgICBAcGF0Y2gub2JqZWN0KEZvbywgJ2cnLCAxKQogICAgICAgIEBwYXRjaC5vYmplY3QoRm9vLCAnZm9vJywgbmV3X2NhbGxhYmxlPWNyYXNoZXIpCiAgICAgICAgQHBhdGNoLm9iamVjdChGb28sICdmJywgMSkKICAgICAgICBkZWYgdGhpbmcxKCk6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgQHBhdGNoLm9iamVjdChGb28sICdmb28nLCBuZXdfY2FsbGFibGU9Y3Jhc2hlcikKICAgICAgICBAcGF0Y2gub2JqZWN0KEZvbywgJ2cnLCAxKQogICAgICAgIEBwYXRjaC5vYmplY3QoRm9vLCAnZicsIDEpCiAgICAgICAgZGVmIHRoaW5nMigpOgogICAgICAgICAgICBwYXNzCgogICAgICAgIEBwYXRjaC5vYmplY3QoRm9vLCAnZycsIDEpCiAgICAgICAgQHBhdGNoLm9iamVjdChGb28sICdmJywgMSkKICAgICAgICBAcGF0Y2gub2JqZWN0KEZvbywgJ2ZvbycsIG5ld19jYWxsYWJsZT1jcmFzaGVyKQogICAgICAgIGRlZiB0aGluZzMoKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBmb3IgZnVuYyBpbiB0aGluZzEsIHRoaW5nMiwgdGhpbmczOgogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhOYW1lRXJyb3IsIGZ1bmMpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLmYsIG9yaWdpbmFsX2YpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLmcsIG9yaWdpbmFsX2cpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLmZvbywgb3JpZ2luYWxfZm9vKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9tdWx0aXBsZV9mYWlsdXJlKHNlbGYpOgogICAgICAgIG9yaWdpbmFsX2YgPSBGb28uZgogICAgICAgIG9yaWdpbmFsX2cgPSBGb28uZwoKICAgICAgICBwYXRjaGVyID0gcGF0Y2gub2JqZWN0KEZvbywgJ2YnLCAxKQogICAgICAgIHBhdGNoZXIuYXR0cmlidXRlX25hbWUgPSAnZicKCiAgICAgICAgZ29vZCA9IHBhdGNoLm9iamVjdChGb28sICdnJywgMSkKICAgICAgICBnb29kLmF0dHJpYnV0ZV9uYW1lID0gJ2cnCgogICAgICAgIGJhZCA9IHBhdGNoLm9iamVjdChGb28sICdtaXNzaW5nJywgMSkKICAgICAgICBiYWQuYXR0cmlidXRlX25hbWUgPSAnbWlzc2luZycKCiAgICAgICAgZm9yIGFkZGl0aW9uYWxzIGluIFtnb29kLCBiYWRdLCBbYmFkLCBnb29kXToKICAgICAgICAgICAgcGF0Y2hlci5hZGRpdGlvbmFsX3BhdGNoZXJzID0gYWRkaXRpb25hbHMKCiAgICAgICAgICAgIEBwYXRjaGVyCiAgICAgICAgICAgIGRlZiBmdW5jKCk6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZnVuYykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgb3JpZ2luYWxfZikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZywgb3JpZ2luYWxfZykKCgogICAgZGVmIHRlc3RfcGF0Y2hfbXVsdGlwbGVfbmV3X2NhbGxhYmxlX2ZhaWx1cmUoc2VsZik6CiAgICAgICAgb3JpZ2luYWxfZiA9IEZvby5mCiAgICAgICAgb3JpZ2luYWxfZyA9IEZvby5nCiAgICAgICAgb3JpZ2luYWxfZm9vID0gRm9vLmZvbwoKICAgICAgICBkZWYgY3Jhc2hlcigpOgogICAgICAgICAgICByYWlzZSBOYW1lRXJyb3IoJ2NyYXNoZXInKQoKICAgICAgICBwYXRjaGVyID0gcGF0Y2gub2JqZWN0KEZvbywgJ2YnLCAxKQogICAgICAgIHBhdGNoZXIuYXR0cmlidXRlX25hbWUgPSAnZicKCiAgICAgICAgZ29vZCA9IHBhdGNoLm9iamVjdChGb28sICdnJywgMSkKICAgICAgICBnb29kLmF0dHJpYnV0ZV9uYW1lID0gJ2cnCgogICAgICAgIGJhZCA9IHBhdGNoLm9iamVjdChGb28sICdmb28nLCBuZXdfY2FsbGFibGU9Y3Jhc2hlcikKICAgICAgICBiYWQuYXR0cmlidXRlX25hbWUgPSAnZm9vJwoKICAgICAgICBmb3IgYWRkaXRpb25hbHMgaW4gW2dvb2QsIGJhZF0sIFtiYWQsIGdvb2RdOgogICAgICAgICAgICBwYXRjaGVyLmFkZGl0aW9uYWxfcGF0Y2hlcnMgPSBhZGRpdGlvbmFscwoKICAgICAgICAgICAgQHBhdGNoZXIKICAgICAgICAgICAgZGVmIGZ1bmMoKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKE5hbWVFcnJvciwgZnVuYykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgb3JpZ2luYWxfZikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZywgb3JpZ2luYWxfZykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZm9vLCBvcmlnaW5hbF9mb28pCgoKICAgIGRlZiB0ZXN0X3BhdGNoX211bHRpcGxlX3N0cmluZ19zdWJjbGFzc2VzKHNlbGYpOgogICAgICAgIEZvbyA9IHR5cGUoJ0ZvbycsIChzdHIsKSwgeydmaXNoJzogJ3Rhc3R5J30pCiAgICAgICAgZm9vID0gRm9vKCkKICAgICAgICBAcGF0Y2gubXVsdGlwbGUoZm9vLCBmaXNoPSduZWFybHkgZ29uZScpCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28uZmlzaCwgJ25lYXJseSBnb25lJykKCiAgICAgICAgdGVzdCgpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28uZmlzaCwgJ3Rhc3R5JykKCgogICAgQHBhdGNoKCd1bml0dGVzdC5tb2NrLnBhdGNoLlRFU1RfUFJFRklYJywgJ2ZvbycpCiAgICBkZWYgdGVzdF9wYXRjaF90ZXN0X3ByZWZpeChzZWxmKToKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgdGhpbmcgPSAnb3JpZ2luYWwnCgogICAgICAgICAgICBkZWYgZm9vX29uZShzZWxmKToKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnRoaW5nCiAgICAgICAgICAgIGRlZiBmb29fdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYudGhpbmcKICAgICAgICAgICAgZGVmIHRlc3Rfb25lKHNlbGYpOgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYudGhpbmcKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYudGhpbmcKCiAgICAgICAgRm9vID0gcGF0Y2gub2JqZWN0KEZvbywgJ3RoaW5nJywgJ2NoYW5nZWQnKShGb28pCgogICAgICAgIGZvbyA9IEZvbygpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28uZm9vX29uZSgpLCAnY2hhbmdlZCcpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28uZm9vX3R3bygpLCAnY2hhbmdlZCcpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28udGVzdF9vbmUoKSwgJ29yaWdpbmFsJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvby50ZXN0X3R3bygpLCAnb3JpZ2luYWwnKQoKCiAgICBAcGF0Y2goJ3VuaXR0ZXN0Lm1vY2sucGF0Y2guVEVTVF9QUkVGSVgnLCAnYmFyJykKICAgIGRlZiB0ZXN0X3BhdGNoX2RpY3RfdGVzdF9wcmVmaXgoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKG9iamVjdCk6CiAgICAgICAgICAgIGRlZiBiYXJfb25lKHNlbGYpOgogICAgICAgICAgICAgICAgcmV0dXJuIGRpY3QodGhlX2RpY3QpCiAgICAgICAgICAgIGRlZiBiYXJfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcmV0dXJuIGRpY3QodGhlX2RpY3QpCiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHJldHVybiBkaWN0KHRoZV9kaWN0KQogICAgICAgICAgICBkZWYgdGVzdF90d28oc2VsZik6CiAgICAgICAgICAgICAgICByZXR1cm4gZGljdCh0aGVfZGljdCkKCiAgICAgICAgdGhlX2RpY3QgPSB7J2tleSc6ICdvcmlnaW5hbCd9CiAgICAgICAgRm9vID0gcGF0Y2guZGljdCh0aGVfZGljdCwga2V5PSdjaGFuZ2VkJykoRm9vKQoKICAgICAgICBmb28gPUZvbygpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28uYmFyX29uZSgpLCB7J2tleSc6ICdjaGFuZ2VkJ30pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28uYmFyX3R3bygpLCB7J2tleSc6ICdjaGFuZ2VkJ30pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28udGVzdF9vbmUoKSwgeydrZXknOiAnb3JpZ2luYWwnfSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvby50ZXN0X3R3bygpLCB7J2tleSc6ICdvcmlnaW5hbCd9KQoKCiAgICBkZWYgdGVzdF9wYXRjaF93aXRoX3NwZWNfbW9ja19yZXByKHNlbGYpOgogICAgICAgIGZvciBhcmcgaW4gKCdzcGVjJywgJ2F1dG9zcGVjJywgJ3NwZWNfc2V0Jyk6CiAgICAgICAgICAgIHAgPSBwYXRjaCgnJXMuU29tZUNsYXNzJyAlIF9fbmFtZV9fLCAqKnthcmc6IFRydWV9KQogICAgICAgICAgICBtID0gcC5zdGFydCgpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0SW4oIiBuYW1lPSdTb21lQ2xhc3MnIiwgcmVwcihtKSkKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0SW4oIiBuYW1lPSdTb21lQ2xhc3MuY2xhc3NfYXR0cmlidXRlJyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcHIobS5jbGFzc19hdHRyaWJ1dGUpKQogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigiIG5hbWU9J1NvbWVDbGFzcygpJyIsIHJlcHIobSgpKSkKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0SW4oIiBuYW1lPSdTb21lQ2xhc3MoKS5jbGFzc19hdHRyaWJ1dGUnIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwcihtKCkuY2xhc3NfYXR0cmlidXRlKSkKICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgIHAuc3RvcCgpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX25lc3RlZF9hdXRvc3BlY19yZXByKHNlbGYpOgogICAgICAgIHdpdGggcGF0Y2goJ3VuaXR0ZXN0LnRlc3QudGVzdG1vY2suc3VwcG9ydCcsIGF1dG9zcGVjPVRydWUpIGFzIG06CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SW4oIiBuYW1lPSdzdXBwb3J0LlNvbWVDbGFzcy53aWJibGUoKSciLAogICAgICAgICAgICAgICAgICAgICAgICAgIHJlcHIobS5Tb21lQ2xhc3Mud2liYmxlKCkpKQogICAgICAgICAgICBzZWxmLmFzc2VydEluKCIgbmFtZT0nc3VwcG9ydC5Tb21lQ2xhc3MoKS53aWJibGUoKSciLAogICAgICAgICAgICAgICAgICAgICAgICAgIHJlcHIobS5Tb21lQ2xhc3MoKS53aWJibGUoKSkpCgoKCiAgICBkZWYgdGVzdF9tb2NrX2NhbGxzX3dpdGhfcGF0Y2goc2VsZik6CiAgICAgICAgZm9yIGFyZyBpbiAoJ3NwZWMnLCAnYXV0b3NwZWMnLCAnc3BlY19zZXQnKToKICAgICAgICAgICAgcCA9IHBhdGNoKCclcy5Tb21lQ2xhc3MnICUgX19uYW1lX18sICoqe2FyZzogVHJ1ZX0pCiAgICAgICAgICAgIG0gPSBwLnN0YXJ0KCkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgbS53aWJibGUoKQoKICAgICAgICAgICAgICAgIGthbGxzID0gW2NhbGwud2liYmxlKCldCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0ubW9ja19jYWxscywga2FsbHMpCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0ubWV0aG9kX2NhbGxzLCBrYWxscykKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobS53aWJibGUubW9ja19jYWxscywgW2NhbGwoKV0pCgogICAgICAgICAgICAgICAgcmVzdWx0ID0gbSgpCiAgICAgICAgICAgICAgICBrYWxscy5hcHBlbmQoY2FsbCgpKQogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtLm1vY2tfY2FsbHMsIGthbGxzKQoKICAgICAgICAgICAgICAgIHJlc3VsdC53aWJibGUoKQogICAgICAgICAgICAgICAga2FsbHMuYXBwZW5kKGNhbGwoKS53aWJibGUoKSkKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobS5tb2NrX2NhbGxzLCBrYWxscykKCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC5tb2NrX2NhbGxzLCBbY2FsbC53aWJibGUoKV0pCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC53aWJibGUubW9ja19jYWxscywgW2NhbGwoKV0pCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC5tZXRob2RfY2FsbHMsIFtjYWxsLndpYmJsZSgpXSkKICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgIHAuc3RvcCgpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX2ltcG9ydHNfbGF6aWx5KHNlbGYpOgogICAgICAgIHN5cy5tb2R1bGVzLnBvcCgnc3F1aXp6JywgTm9uZSkKCiAgICAgICAgcDEgPSBwYXRjaCgnc3F1aXp6LnNxdW96eicpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoSW1wb3J0RXJyb3IsIHAxLnN0YXJ0KQoKICAgICAgICBzcXVpenogPSBNb2NrKCkKICAgICAgICBzcXVpenouc3F1b3p6ID0gNgogICAgICAgIHN5cy5tb2R1bGVzWydzcXVpenonXSA9IHNxdWl6egogICAgICAgIHAxID0gcGF0Y2goJ3NxdWl6ei5zcXVvenonKQogICAgICAgIHNxdWl6ei5zcXVvenogPSAzCiAgICAgICAgcDEuc3RhcnQoKQogICAgICAgIHAxLnN0b3AoKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3F1aXp6LnNxdW96eiwgMykKCgogICAgZGVmIHRlc3RfcGF0Y2hfcHJvcG9ncmF0ZXNfZXhjX29uX2V4aXQoc2VsZik6CiAgICAgICAgY2xhc3MgaG9sZGVyOgogICAgICAgICAgICBleGNfaW5mbyA9IE5vbmUsIE5vbmUsIE5vbmUKCiAgICAgICAgY2xhc3MgY3VzdG9tX3BhdGNoKF9wYXRjaCk6CiAgICAgICAgICAgIGRlZiBfX2V4aXRfXyhzZWxmLCBldHlwZT1Ob25lLCB2YWw9Tm9uZSwgdGI9Tm9uZSk6CiAgICAgICAgICAgICAgICBfcGF0Y2guX19leGl0X18oc2VsZiwgZXR5cGUsIHZhbCwgdGIpCiAgICAgICAgICAgICAgICBob2xkZXIuZXhjX2luZm8gPSBldHlwZSwgdmFsLCB0YgogICAgICAgICAgICBzdG9wID0gX19leGl0X18KCiAgICAgICAgZGVmIHdpdGhfY3VzdG9tX3BhdGNoKHRhcmdldCk6CiAgICAgICAgICAgIGdldHRlciwgYXR0cmlidXRlID0gX2dldF90YXJnZXQodGFyZ2V0KQogICAgICAgICAgICByZXR1cm4gY3VzdG9tX3BhdGNoKAogICAgICAgICAgICAgICAgZ2V0dGVyLCBhdHRyaWJ1dGUsIERFRkFVTFQsIE5vbmUsIEZhbHNlLCBOb25lLAogICAgICAgICAgICAgICAgTm9uZSwgTm9uZSwge30KICAgICAgICAgICAgKQoKICAgICAgICBAd2l0aF9jdXN0b21fcGF0Y2goJ3NxdWl6ei5zcXVvenonKQogICAgICAgIGRlZiB0ZXN0KG1vY2spOgogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoUnVudGltZUVycm9yLCB0ZXN0KQogICAgICAgIHNlbGYuYXNzZXJ0SXMoaG9sZGVyLmV4Y19pbmZvWzBdLCBSdW50aW1lRXJyb3IpCiAgICAgICAgc2VsZi5hc3NlcnRJc05vdE5vbmUoaG9sZGVyLmV4Y19pbmZvWzFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2V4Y2VwdGlvbiB2YWx1ZSBub3QgcHJvcGdhdGVkJykKICAgICAgICBzZWxmLmFzc2VydElzTm90Tm9uZShob2xkZXIuZXhjX2luZm9bMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZXhjZXB0aW9uIHRyYWNlYmFjayBub3QgcHJvcGdhdGVkJykKCgogICAgZGVmIHRlc3RfY3JlYXRlX2FuZF9zcGVjcyhzZWxmKToKICAgICAgICBmb3Iga3dhcmcgaW4gKCdzcGVjJywgJ3NwZWNfc2V0JywgJ2F1dG9zcGVjJyk6CiAgICAgICAgICAgIHAgPSBwYXRjaCgnJXMuZG9lc25vdGV4aXN0JyAlIF9fbmFtZV9fLCBjcmVhdGU9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICoqe2t3YXJnOiBUcnVlfSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBwLnN0YXJ0KQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhOYW1lRXJyb3IsIGxhbWJkYTogZG9lc25vdGV4aXN0KQoKICAgICAgICAgICAgIyBjaGVjayB0aGF0IHNwZWMgd2l0aCBjcmVhdGUgaXMgaW5ub2N1b3VzIGlmIHRoZSBvcmlnaW5hbCBleGlzdHMKICAgICAgICAgICAgcCA9IHBhdGNoKE1PRE5BTUUsIGNyZWF0ZT1UcnVlLCAqKntrd2FyZzogVHJ1ZX0pCiAgICAgICAgICAgIHAuc3RhcnQoKQogICAgICAgICAgICBwLnN0b3AoKQoKCiAgICBkZWYgdGVzdF9tdWx0aXBsZV9zcGVjcyhzZWxmKToKICAgICAgICBvcmlnaW5hbCA9IFBUTW9kdWxlCiAgICAgICAgZm9yIGt3YXJnIGluICgnc3BlYycsICdzcGVjX3NldCcpOgogICAgICAgICAgICBwID0gcGF0Y2goTU9ETkFNRSwgYXV0b3NwZWM9MCwgKip7a3dhcmc6IDB9KQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIHAuc3RhcnQpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMoUFRNb2R1bGUsIG9yaWdpbmFsKQoKICAgICAgICBmb3Iga3dhcmcgaW4gKCdzcGVjJywgJ2F1dG9zcGVjJyk6CiAgICAgICAgICAgIHAgPSBwYXRjaChNT0ROQU1FLCBzcGVjX3NldD0wLCAqKntrd2FyZzogMH0pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgcC5zdGFydCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhQVE1vZHVsZSwgb3JpZ2luYWwpCgogICAgICAgIGZvciBrd2FyZyBpbiAoJ3NwZWNfc2V0JywgJ2F1dG9zcGVjJyk6CiAgICAgICAgICAgIHAgPSBwYXRjaChNT0ROQU1FLCBzcGVjPTAsICoqe2t3YXJnOiAwfSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBwLnN0YXJ0KQogICAgICAgICAgICBzZWxmLmFzc2VydElzKFBUTW9kdWxlLCBvcmlnaW5hbCkKCgogICAgZGVmIHRlc3Rfc3BlY3NfZmFsc2VfaW5zdGVhZF9vZl9ub25lKHNlbGYpOgogICAgICAgIHAgPSBwYXRjaChNT0ROQU1FLCBzcGVjPUZhbHNlLCBzcGVjX3NldD1GYWxzZSwgYXV0b3NwZWM9RmFsc2UpCiAgICAgICAgbW9jayA9IHAuc3RhcnQoKQogICAgICAgIHRyeToKICAgICAgICAgICAgIyBubyBzcGVjIHNob3VsZCBoYXZlIGJlZW4gc2V0LCBzbyBhdHRyaWJ1dGUgYWNjZXNzIHNob3VsZCBub3QgZmFpbAogICAgICAgICAgICBtb2NrLmRvZXNfbm90X2V4aXN0CiAgICAgICAgICAgIG1vY2suZG9lc19ub3RfZXhpc3QgPSAzCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgcC5zdG9wKCkKCgogICAgZGVmIHRlc3RfZmFsc2V5X3NwZWMoc2VsZik6CiAgICAgICAgZm9yIGt3YXJnIGluICgnc3BlYycsICdhdXRvc3BlYycsICdzcGVjX3NldCcpOgogICAgICAgICAgICBwID0gcGF0Y2goTU9ETkFNRSwgKip7a3dhcmc6IDB9KQogICAgICAgICAgICBtID0gcC5zdGFydCgpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBnZXRhdHRyLCBtLCAnZG9lc25vdGV4aXQnKQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgcC5zdG9wKCkKCgogICAgZGVmIHRlc3Rfc3BlY19zZXRfdHJ1ZShzZWxmKToKICAgICAgICBmb3Iga3dhcmcgaW4gKCdzcGVjJywgJ2F1dG9zcGVjJyk6CiAgICAgICAgICAgIHAgPSBwYXRjaChNT0ROQU1FLCBzcGVjX3NldD1UcnVlLCAqKntrd2FyZzogVHJ1ZX0pCiAgICAgICAgICAgIG0gPSBwLnN0YXJ0KCkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIHNldGF0dHIsIG0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZG9lc25vdGV4aXN0JywgJ3NvbWV0aGluZycpCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgbSwgJ2RvZXNub3RleGlzdCcpCiAgICAgICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgICAgICBwLnN0b3AoKQoKCiAgICBkZWYgdGVzdF9jYWxsYWJsZV9zcGVjX2FzX2xpc3Qoc2VsZik6CiAgICAgICAgc3BlYyA9ICgnX19jYWxsX18nLCkKICAgICAgICBwID0gcGF0Y2goTU9ETkFNRSwgc3BlYz1zcGVjKQogICAgICAgIG0gPSBwLnN0YXJ0KCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShjYWxsYWJsZShtKSkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwLnN0b3AoKQoKCiAgICBkZWYgdGVzdF9ub3RfY2FsbGFibGVfc3BlY19hc19saXN0KHNlbGYpOgogICAgICAgIHNwZWMgPSAoJ2ZvbycsICdiYXInKQogICAgICAgIHAgPSBwYXRjaChNT0ROQU1FLCBzcGVjPXNwZWMpCiAgICAgICAgbSA9IHAuc3RhcnQoKQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShjYWxsYWJsZShtKSkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwLnN0b3AoKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9zdG9wYWxsKHNlbGYpOgogICAgICAgIHVubGluayA9IG9zLnVubGluawogICAgICAgIGNoZGlyID0gb3MuY2hkaXIKICAgICAgICBwYXRoID0gb3MucGF0aAogICAgICAgIHBhdGNoKCdvcy51bmxpbmsnLCBzb21ldGhpbmcpLnN0YXJ0KCkKICAgICAgICBwYXRjaCgnb3MuY2hkaXInLCBzb21ldGhpbmdfZWxzZSkuc3RhcnQoKQoKICAgICAgICBAcGF0Y2goJ29zLnBhdGgnKQogICAgICAgIGRlZiBwYXRjaGVkKG1vY2tfcGF0aCk6CiAgICAgICAgICAgIHBhdGNoLnN0b3BhbGwoKQogICAgICAgICAgICBzZWxmLmFzc2VydElzKG9zLnBhdGgsIG1vY2tfcGF0aCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhvcy51bmxpbmssIHVubGluaykKICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhvcy5jaGRpciwgY2hkaXIpCgogICAgICAgIHBhdGNoZWQoKQogICAgICAgIHNlbGYuYXNzZXJ0SXMob3MucGF0aCwgcGF0aCkKCgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIHVuaXR0ZXN0Lm1haW4oKQo=',
'/Lib/unittest/test/testmock/testsentinel.py':'aW1wb3J0IHVuaXR0ZXN0CmZyb20gdW5pdHRlc3QubW9jayBpbXBvcnQgc2VudGluZWwsIERFRkFVTFQKCgpjbGFzcyBTZW50aW5lbFRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgoKICAgIGRlZiB0ZXN0U2VudGluZWxzKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc2VudGluZWwud2hhdGV2ZXIsIHNlbnRpbmVsLndoYXRldmVyLAogICAgICAgICAgICAgICAgICAgICAgICAgJ3NlbnRpbmVsIG5vdCBzdG9yZWQnKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoc2VudGluZWwud2hhdGV2ZXIsIHNlbnRpbmVsLndoYXRldmVyZWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzZW50aW5lbCBzaG91bGQgYmUgdW5pcXVlJykKCgogICAgZGVmIHRlc3RTZW50aW5lbE5hbWUoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIoc2VudGluZWwud2hhdGV2ZXIpLCAnc2VudGluZWwud2hhdGV2ZXInLAogICAgICAgICAgICAgICAgICAgICAgICAgJ3NlbnRpbmVsIG5hbWUgaW5jb3JyZWN0JykKCgogICAgZGVmIHRlc3RERUZBVUxUKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShERUZBVUxUIGlzIHNlbnRpbmVsLkRFRkFVTFQpCgogICAgZGVmIHRlc3RCYXNlcyhzZWxmKToKICAgICAgICAjIElmIHRoaXMgZG9lc24ndCByYWlzZSBhbiBBdHRyaWJ1dGVFcnJvciB0aGVuIGhlbHAobW9jaykgaXMgYnJva2VuCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGxhbWJkYTogc2VudGluZWwuX19iYXNlc19fKQoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICB1bml0dGVzdC5tYWluKCkK',
'/Lib/unittest/test/testmock/testwith.py':'aW1wb3J0IHVuaXR0ZXN0CmZyb20gd2FybmluZ3MgaW1wb3J0IGNhdGNoX3dhcm5pbmdzCgpmcm9tIHVuaXR0ZXN0LnRlc3QudGVzdG1vY2suc3VwcG9ydCBpbXBvcnQgaXNfaW5zdGFuY2UKZnJvbSB1bml0dGVzdC5tb2NrIGltcG9ydCBNYWdpY01vY2ssIE1vY2ssIHBhdGNoLCBzZW50aW5lbCwgbW9ja19vcGVuLCBjYWxsCgoKCnNvbWV0aGluZyAgPSBzZW50aW5lbC5Tb21ldGhpbmcKc29tZXRoaW5nX2Vsc2UgID0gc2VudGluZWwuU29tZXRoaW5nRWxzZQoKCgpjbGFzcyBXaXRoVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIHRlc3Rfd2l0aF9zdGF0ZW1lbnQoc2VsZik6CiAgICAgICAgd2l0aCBwYXRjaCgnJXMuc29tZXRoaW5nJyAlIF9fbmFtZV9fLCBzZW50aW5lbC5Tb21ldGhpbmcyKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzb21ldGhpbmcsIHNlbnRpbmVsLlNvbWV0aGluZzIsICJ1bnBhdGNoZWQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLCBzZW50aW5lbC5Tb21ldGhpbmcpCgoKICAgIGRlZiB0ZXN0X3dpdGhfc3RhdGVtZW50X2V4Y2VwdGlvbihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdpdGggcGF0Y2goJyVzLnNvbWV0aGluZycgJSBfX25hbWVfXywgc2VudGluZWwuU29tZXRoaW5nMik6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNvbWV0aGluZywgc2VudGluZWwuU29tZXRoaW5nMiwgInVucGF0Y2hlZCIpCiAgICAgICAgICAgICAgICByYWlzZSBFeGNlcHRpb24oJ3BvdycpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgicGF0Y2ggc3dhbGxvd2VkIGV4Y2VwdGlvbiIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzb21ldGhpbmcsIHNlbnRpbmVsLlNvbWV0aGluZykKCgogICAgZGVmIHRlc3Rfd2l0aF9zdGF0ZW1lbnRfYXMoc2VsZik6CiAgICAgICAgd2l0aCBwYXRjaCgnJXMuc29tZXRoaW5nJyAlIF9fbmFtZV9fKSBhcyBtb2NrX3NvbWV0aGluZzoKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzb21ldGhpbmcsIG1vY2tfc29tZXRoaW5nLCAidW5wYXRjaGVkIikKICAgICAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzX2luc3RhbmNlKG1vY2tfc29tZXRoaW5nLCBNYWdpY01vY2spLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInBhdGNoaW5nIHdyb25nIHR5cGUiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLCBzZW50aW5lbC5Tb21ldGhpbmcpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX29iamVjdF93aXRoX3N0YXRlbWVudChzZWxmKToKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgc29tZXRoaW5nID0gJ2ZvbycKICAgICAgICBvcmlnaW5hbCA9IEZvby5zb21ldGhpbmcKICAgICAgICB3aXRoIHBhdGNoLm9iamVjdChGb28sICdzb21ldGhpbmcnKToKICAgICAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChGb28uc29tZXRoaW5nLCBvcmlnaW5hbCwgInVucGF0Y2hlZCIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uc29tZXRoaW5nLCBvcmlnaW5hbCkKCgogICAgZGVmIHRlc3Rfd2l0aF9zdGF0ZW1lbnRfbmVzdGVkKHNlbGYpOgogICAgICAgIHdpdGggY2F0Y2hfd2FybmluZ3MocmVjb3JkPVRydWUpOgogICAgICAgICAgICB3aXRoIHBhdGNoKCclcy5zb21ldGhpbmcnICUgX19uYW1lX18pIGFzIG1vY2tfc29tZXRoaW5nLCBwYXRjaCgnJXMuc29tZXRoaW5nX2Vsc2UnICUgX19uYW1lX18pIGFzIG1vY2tfc29tZXRoaW5nX2Vsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNvbWV0aGluZywgbW9ja19zb21ldGhpbmcsICJ1bnBhdGNoZWQiKQogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzb21ldGhpbmdfZWxzZSwgbW9ja19zb21ldGhpbmdfZWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInVucGF0Y2hlZCIpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLCBzZW50aW5lbC5Tb21ldGhpbmcpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzb21ldGhpbmdfZWxzZSwgc2VudGluZWwuU29tZXRoaW5nRWxzZSkKCgogICAgZGVmIHRlc3Rfd2l0aF9zdGF0ZW1lbnRfc3BlY2lmaWVkKHNlbGYpOgogICAgICAgIHdpdGggcGF0Y2goJyVzLnNvbWV0aGluZycgJSBfX25hbWVfXywgc2VudGluZWwuUGF0Y2hlZCkgYXMgbW9ja19zb21ldGhpbmc6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLCBtb2NrX3NvbWV0aGluZywgInVucGF0Y2hlZCIpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9ja19zb21ldGhpbmcsIHNlbnRpbmVsLlBhdGNoZWQsICJ3cm9uZyBwYXRjaCIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzb21ldGhpbmcsIHNlbnRpbmVsLlNvbWV0aGluZykKCgogICAgZGVmIHRlc3RDb250ZXh0TWFuYWdlck1vY2tpbmcoc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2suX19lbnRlcl9fID0gTW9jaygpCiAgICAgICAgbW9jay5fX2V4aXRfXyA9IE1vY2soKQogICAgICAgIG1vY2suX19leGl0X18ucmV0dXJuX3ZhbHVlID0gRmFsc2UKCiAgICAgICAgd2l0aCBtb2NrIGFzIG06CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobSwgbW9jay5fX2VudGVyX18ucmV0dXJuX3ZhbHVlKQogICAgICAgIG1vY2suX19lbnRlcl9fLmFzc2VydF9jYWxsZWRfd2l0aCgpCiAgICAgICAgbW9jay5fX2V4aXRfXy5hc3NlcnRfY2FsbGVkX3dpdGgoTm9uZSwgTm9uZSwgTm9uZSkKCgogICAgZGVmIHRlc3RfY29udGV4dF9tYW5hZ2VyX3dpdGhfbWFnaWNfbW9jayhzZWxmKToKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IpOgogICAgICAgICAgICB3aXRoIG1vY2s6CiAgICAgICAgICAgICAgICAnZm9vJyArIDMKICAgICAgICBtb2NrLl9fZW50ZXJfXy5hc3NlcnRfY2FsbGVkX3dpdGgoKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShtb2NrLl9fZXhpdF9fLmNhbGxlZCkKCgogICAgZGVmIHRlc3Rfd2l0aF9zdGF0ZW1lbnRfc2FtZV9hdHRyaWJ1dGUoc2VsZik6CiAgICAgICAgd2l0aCBwYXRjaCgnJXMuc29tZXRoaW5nJyAlIF9fbmFtZV9fLCBzZW50aW5lbC5QYXRjaGVkKSBhcyBtb2NrX3NvbWV0aGluZzoKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzb21ldGhpbmcsIG1vY2tfc29tZXRoaW5nLCAidW5wYXRjaGVkIikKCiAgICAgICAgICAgIHdpdGggcGF0Y2goJyVzLnNvbWV0aGluZycgJSBfX25hbWVfXykgYXMgbW9ja19hZ2FpbjoKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLCBtb2NrX2FnYWluLCAidW5wYXRjaGVkIikKCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLCBtb2NrX3NvbWV0aGluZywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAicmVzdG9yZWQgd2l0aCB3cm9uZyBpbnN0YW5jZSIpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLCBzZW50aW5lbC5Tb21ldGhpbmcsICJub3QgcmVzdG9yZWQiKQoKCiAgICBkZWYgdGVzdF93aXRoX3N0YXRlbWVudF9pbWJyaWNhdGVkKHNlbGYpOgogICAgICAgIHdpdGggcGF0Y2goJyVzLnNvbWV0aGluZycgJSBfX25hbWVfXykgYXMgbW9ja19zb21ldGhpbmc6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLCBtb2NrX3NvbWV0aGluZywgInVucGF0Y2hlZCIpCgogICAgICAgICAgICB3aXRoIHBhdGNoKCclcy5zb21ldGhpbmdfZWxzZScgJSBfX25hbWVfXykgYXMgbW9ja19zb21ldGhpbmdfZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nX2Vsc2UsIG1vY2tfc29tZXRoaW5nX2Vsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ1bnBhdGNoZWQiKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNvbWV0aGluZywgc2VudGluZWwuU29tZXRoaW5nKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nX2Vsc2UsIHNlbnRpbmVsLlNvbWV0aGluZ0Vsc2UpCgoKICAgIGRlZiB0ZXN0X2RpY3RfY29udGV4dF9tYW5hZ2VyKHNlbGYpOgogICAgICAgIGZvbyA9IHt9CiAgICAgICAgd2l0aCBwYXRjaC5kaWN0KGZvbywgeydhJzogJ2InfSk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZm9vLCB7J2EnOiAnYid9KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZm9vLCB7fSkKCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhOYW1lRXJyb3IpOgogICAgICAgICAgICB3aXRoIHBhdGNoLmRpY3QoZm9vLCB7J2EnOiAnYid9KToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZm9vLCB7J2EnOiAnYid9KQogICAgICAgICAgICAgICAgcmFpc2UgTmFtZUVycm9yKCdLb25yYWQnKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvbywge30pCgoKCmNsYXNzIFRlc3RNb2NrT3Blbih1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIHRlc3RfbW9ja19vcGVuKHNlbGYpOgogICAgICAgIG1vY2sgPSBtb2NrX29wZW4oKQogICAgICAgIHdpdGggcGF0Y2goJyVzLm9wZW4nICUgX19uYW1lX18sIG1vY2ssIGNyZWF0ZT1UcnVlKSBhcyBwYXRjaGVkOgogICAgICAgICAgICBzZWxmLmFzc2VydElzKHBhdGNoZWQsIG1vY2spCiAgICAgICAgICAgIG9wZW4oJ2ZvbycpCgogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoJ2ZvbycpCgoKICAgIGRlZiB0ZXN0X21vY2tfb3Blbl9jb250ZXh0X21hbmFnZXIoc2VsZik6CiAgICAgICAgbW9jayA9IG1vY2tfb3BlbigpCiAgICAgICAgaGFuZGxlID0gbW9jay5yZXR1cm5fdmFsdWUKICAgICAgICB3aXRoIHBhdGNoKCclcy5vcGVuJyAlIF9fbmFtZV9fLCBtb2NrLCBjcmVhdGU9VHJ1ZSk6CiAgICAgICAgICAgIHdpdGggb3BlbignZm9vJykgYXMgZjoKICAgICAgICAgICAgICAgIGYucmVhZCgpCgogICAgICAgIGV4cGVjdGVkX2NhbGxzID0gW2NhbGwoJ2ZvbycpLCBjYWxsKCkuX19lbnRlcl9fKCksIGNhbGwoKS5yZWFkKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbCgpLl9fZXhpdF9fKE5vbmUsIE5vbmUsIE5vbmUpXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tb2NrX2NhbGxzLCBleHBlY3RlZF9jYWxscykKICAgICAgICBzZWxmLmFzc2VydElzKGYsIGhhbmRsZSkKCgogICAgZGVmIHRlc3RfZXhwbGljaXRfbW9jayhzZWxmKToKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKICAgICAgICBtb2NrX29wZW4obW9jaykKCiAgICAgICAgd2l0aCBwYXRjaCgnJXMub3BlbicgJSBfX25hbWVfXywgbW9jaywgY3JlYXRlPVRydWUpIGFzIHBhdGNoZWQ6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMocGF0Y2hlZCwgbW9jaykKICAgICAgICAgICAgb3BlbignZm9vJykKCiAgICAgICAgbW9jay5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCgnZm9vJykKCgogICAgZGVmIHRlc3RfcmVhZF9kYXRhKHNlbGYpOgogICAgICAgIG1vY2sgPSBtb2NrX29wZW4ocmVhZF9kYXRhPSdmb28nKQogICAgICAgIHdpdGggcGF0Y2goJyVzLm9wZW4nICUgX19uYW1lX18sIG1vY2ssIGNyZWF0ZT1UcnVlKToKICAgICAgICAgICAgaCA9IG9wZW4oJ2JhcicpCiAgICAgICAgICAgIHJlc3VsdCA9IGgucmVhZCgpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LCAnZm9vJykKCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgdW5pdHRlc3QubWFpbigpCg==',
'/Lib/unittest/test/testmock/__init__.py':'aW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IHVuaXR0ZXN0CgoKaGVyZSA9IG9zLnBhdGguZGlybmFtZShfX2ZpbGVfXykKbG9hZGVyID0gdW5pdHRlc3QuZGVmYXVsdFRlc3RMb2FkZXIKCmRlZiBsb2FkX3Rlc3RzKCphcmdzKToKICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKICAgIGZvciBmbiBpbiBvcy5saXN0ZGlyKGhlcmUpOgogICAgICAgIGlmIGZuLnN0YXJ0c3dpdGgoInRlc3QiKSBhbmQgZm4uZW5kc3dpdGgoIi5weSIpOgogICAgICAgICAgICBtb2RuYW1lID0gInVuaXR0ZXN0LnRlc3QudGVzdG1vY2suIiArIGZuWzotM10KICAgICAgICAgICAgX19pbXBvcnRfXyhtb2RuYW1lKQogICAgICAgICAgICBtb2R1bGUgPSBzeXMubW9kdWxlc1ttb2RuYW1lXQogICAgICAgICAgICBzdWl0ZS5hZGRUZXN0KGxvYWRlci5sb2FkVGVzdHNGcm9tTW9kdWxlKG1vZHVsZSkpCiAgICByZXR1cm4gc3VpdGUK'
}


function readFromVFS(lib){
   //borrowed code from http://stackoverflow.com/questions/1119722/base-62-conversion-in-python
   if (window.atob === undefined) {
      // browser is not chrome, firefox or safari :(
      window.atob=function(s) {
        var e={},i,k,v=[],r='',w=String.fromCharCode;
        var n=[[65,91],[97,123],[48,58],[43,44],[47,48]];

        for(z in n){for(i=n[z][0];i<n[z][1];i++){v.push(w(i));}}
        for(i=0;i<64;i++){e[v[i]]=i;}

        for(i=0;i<s.length;i+=72){
           var b=0,c,x,l=0,o=s.substring(i,i+72);
           for(x=0;x<o.length;x++){
              c=e[o.charAt(x)];b=(b<<6)+c;l+=6;
              while(l>=8){r+=w((b>>>(l-=8))%256);}
           }
        }
        return r;
      }
   }

   if (__BRYTHON__.$py_VFS[lib] === undefined) return undefined
   //retrieve module from virutal file system and return contents
   return window.atob(__BRYTHON__.$py_VFS[lib])
}


function $import_pyj_module(module,alias,names,path,module_contents) {
    __BRYTHON__.$py_module_path[module]=path
    __BRYTHON__.$py_module_alias[module]=alias
    __BRYTHON__.scope[module+'.py']={}
    __BRYTHON__.scope[module+'.py'].__dict__={}

   try {
     eval(module_contents);
     // add names defined in the module as attributes of $module
     for(var attr in __BRYTHON__.scope[module].__dict__){
       $module[attr] = __BRYTHON__.scope[module].__dict__[attr]
     }
        
     // add class and __str__
     $module.__class__ = $type
     $module.__repr__ = function(){return "<module '"+module+"' from "+path+" >"}
     $module.__str__ = function(){return "<module '"+module+"' from "+path+" >"}
     $module.__file__ = path
     return $module
   } catch(err) {
     eval('throw '+err.name+'(err.message)')
   }
}

//define import procedure to look up module in VFS
$import_via_VFS=function(module,alias,names){
  var ext=['.js', '.pyj', '.py']
  var search_path=__BRYTHON__.path
  var root = __BRYTHON__.brython_path;
  if (root.endswith('/')) {
     root=root.substring(0,root.length-1); 
  }
  if (search_path.indexOf(root+'/libs') == -1) {
     search_path.unshift(root+'/libs')
  }

  if (search_path.indexOf(root+'/Lib') == -1) {
     search_path.unshift(root+'/Lib')
  }

  for(var i=0; i<search_path.length; i++) {
     for (var j=0; j<ext.length; j++) {
         var path=search_path[i].replace(root, '')
         path+='/'+module+ext[j]
         
         //console.log("searching for " + path + " in VFS");
         var module_contents=readFromVFS(path)
         if(module_contents !== undefined) {
           console.log("imported ("+module+") via VFS:" + path)
           if (ext[j] == '.js') {
              return $import_js_module(module,alias,names,path,module_contents)
           }
           if (ext[j] == '.pyj') {
              return $import_pyj_module(module,alias,names,path,module_contents)
           }
           return $import_py_module(module,alias,names,path,module_contents)
         }
     }
  }
  res = Error()
  res.name = 'NotFoundError'
  res.message = "No module named '"+module+"'"
  throw res
}

// since $import_funcs is now a local variable (import_funcs), we have
// to over write the $import_single function to get VFS to work
$import_single=function (module){
    var import_funcs = [$import_via_VFS, $import_js, $import_module_search_path]
    if(module.name.search(/\./)>-1){import_funcs = [$import_module_search_path]}
    for(var j=0;j<import_funcs.length;j++){
        try{
            return import_funcs[j](module)
        } catch(err){
            if(err.name==="NotFoundError"){
                if(j==import_funcs.length-1){
                    throw ImportError("no module named '"+module.name+"'")
                }else{
                    continue
                }
            }else{throw(err)}
        }
    }
}
  