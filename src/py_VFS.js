__BRYTHON__.py_VFS={
'/libs/builtins.js':'JG1vZHVsZSA9IChmdW5jdGlvbigpewogICAgdmFyIG9iaiA9IHtfX2NsYXNzX186JE1vZHVsZURpY3QsX19uYW1lX186J2J1aWx0aW5zJ30KICAgIHZhciBidWlsdGluX25hbWVzID0gWydBcml0aG1ldGljRXJyb3InLCAnQXNzZXJ0aW9uRXJyb3InLCAnQXR0cmlidXRlRXJyb3InLCAKICAgICdCYXNlRXhjZXB0aW9uJywgJ0Jsb2NraW5nSU9FcnJvcicsICdCcm9rZW5QaXBlRXJyb3InLCAnQnVmZmVyRXJyb3InLCAKICAgICdCeXRlc1dhcm5pbmcnLCAnQ2hpbGRQcm9jZXNzRXJyb3InLCAnQ29ubmVjdGlvbkFib3J0ZWRFcnJvcicsIAogICAgJ0Nvbm5lY3Rpb25FcnJvcicsICdDb25uZWN0aW9uUmVmdXNlZEVycm9yJywgJ0Nvbm5lY3Rpb25SZXNldEVycm9yJywgCiAgICAnRGVwcmVjYXRpb25XYXJuaW5nJywgJ0VPRkVycm9yJywgJ0VsbGlwc2lzJywgJ0Vudmlyb25tZW50RXJyb3InLCAnRXhjZXB0aW9uJywgCiAgICAnRmFsc2UnLCAnRmlsZUV4aXN0c0Vycm9yJywgJ0ZpbGVOb3RGb3VuZEVycm9yJywgJ0Zsb2F0aW5nUG9pbnRFcnJvcicsIAogICAgJ0Z1dHVyZVdhcm5pbmcnLCAnR2VuZXJhdG9yRXhpdCcsICdJT0Vycm9yJywgJ0ltcG9ydEVycm9yJywgJ0ltcG9ydFdhcm5pbmcnLCAKICAgICdJbmRlbnRhdGlvbkVycm9yJywgJ0luZGV4RXJyb3InLCAnSW50ZXJydXB0ZWRFcnJvcicsICdJc0FEaXJlY3RvcnlFcnJvcicsCiAgICAnS2V5RXJyb3InLCAnS2V5Ym9hcmRJbnRlcnJ1cHQnLCAnTG9va3VwRXJyb3InLCAnTWVtb3J5RXJyb3InLCAnTmFtZUVycm9yJywgCiAgICAnTm9uZScsICdOb3RBRGlyZWN0b3J5RXJyb3InLCAnTm90SW1wbGVtZW50ZWQnLCAnTm90SW1wbGVtZW50ZWRFcnJvcicsIAogICAgJ09TRXJyb3InLCAnT3ZlcmZsb3dFcnJvcicsICdQZW5kaW5nRGVwcmVjYXRpb25XYXJuaW5nJywgJ1Blcm1pc3Npb25FcnJvcicsIAogICAgJ1Byb2Nlc3NMb29rdXBFcnJvcicsICdSZWZlcmVuY2VFcnJvcicsICdSZXNvdXJjZVdhcm5pbmcnLCAnUnVudGltZUVycm9yJywgCiAgICAnUnVudGltZVdhcm5pbmcnLCAnU3RvcEl0ZXJhdGlvbicsICdTeW50YXhFcnJvcicsICdTeW50YXhXYXJuaW5nJywgCiAgICAnU3lzdGVtRXJyb3InLCAnU3lzdGVtRXhpdCcsICdUYWJFcnJvcicsICdUaW1lb3V0RXJyb3InLCAnVHJ1ZScsICdUeXBlRXJyb3InLCAKICAgICdVbmJvdW5kTG9jYWxFcnJvcicsICdVbmljb2RlRGVjb2RlRXJyb3InLCAnVW5pY29kZUVuY29kZUVycm9yJywgCiAgICAnVW5pY29kZUVycm9yJywgJ1VuaWNvZGVUcmFuc2xhdGVFcnJvcicsICdVbmljb2RlV2FybmluZycsICdVc2VyV2FybmluZycsIAogICAgJ1ZhbHVlRXJyb3InLCAnV2FybmluZycsICdXaW5kb3dzRXJyb3InLCAnWmVyb0RpdmlzaW9uRXJyb3InLCAnXycsIAogICAgJ19fYnVpbGRfY2xhc3NfXycsICdfX2RlYnVnX18nLCAnX19kb2NfXycsICdfX2ltcG9ydF9fJywgJ19fbmFtZV9fJywgCiAgICAnX19wYWNrYWdlX18nLCAnYWJzJywgJ2FsbCcsICdhbnknLCAnYXNjaWknLCAnYmluJywgJ2Jvb2wnLCAnYnl0ZWFycmF5JywgCiAgICAnYnl0ZXMnLCdjYWxsYWJsZScsICdjaHInLCAnY2xhc3NtZXRob2QnLCAnY29tcGlsZScsICdjb21wbGV4JywgJ2NvcHlyaWdodCcsIAogICAgJ2NyZWRpdHMnLCdkZWxhdHRyJywgJ2RpY3QnLCAnZGlyJywgJ2Rpdm1vZCcsICdlbnVtZXJhdGUnLCAnZXZhbCcsICdleGVjJywgCiAgICAnZXhpdCcsICdmaWx0ZXInLCAnZmxvYXQnLCAnZm9ybWF0JywgJ2Zyb3plbnNldCcsICdnZXRhdHRyJywgJ2dsb2JhbHMnLCAKICAgICdoYXNhdHRyJywgJ2hhc2gnLCAnaGVscCcsICdoZXgnLCAnaWQnLCAnaW5wdXQnLCAnaW50JywgJ2lzaW5zdGFuY2UnLCAKICAgICdpc3N1YmNsYXNzJywgJ2l0ZXInLCAnbGVuJywgJ2xpY2Vuc2UnLCAnbGlzdCcsICdsb2NhbHMnLCAnbWFwJywgJ21heCcsIAogICAgJ21lbW9yeXZpZXcnLCAnbWluJywgJ25leHQnLCAnb2JqZWN0JywgJ29jdCcsICdvcGVuJywgJ29yZCcsICdwb3cnLCAncHJpbnQnLCAKICAgICdwcm9wZXJ0eScsICdxdWl0JywgJ3JhbmdlJywgJ3JlcHInLCAncmV2ZXJzZWQnLCAncm91bmQnLCAnc2V0JywgJ3NldGF0dHInLCAKICAgICdzbGljZScsICdzb3J0ZWQnLCAnc3RhdGljbWV0aG9kJywgJ3N0cicsICdzdW0nLCAnc3VwZXInLCAndHVwbGUnLCAndHlwZScsIAogICAgJ3ZhcnMnLCAnemlwJ10KICAgIGZvcih2YXIgaT0wO2k8YnVpbHRpbl9uYW1lcy5sZW5ndGg7aSsrKXsKICAgICAgICB0cnl7b2JqW2J1aWx0aW5fbmFtZXNbaV1dPWV2YWwoYnVpbHRpbl9uYW1lc1tpXSl9CiAgICAgICAgY2F0Y2goZXJyKXt9CiAgICB9CiAgICByZXR1cm4gb2JqCn0pKCkK',
'/libs/hashlib.js':'JG1vZHVsZSA9IHsKICAgIF9fZ2V0YXR0cl9fIDogZnVuY3Rpb24oYXR0cil7CiAgICAgICAgaWYgKGF0dHIgPT0gJ25ldycpIHtyZXR1cm4gJGhhc2hsaWJfbmV3O30KICAgICAgICByZXR1cm4gdGhpc1thdHRyXQogICAgfSwKICAgIG1kNTogZnVuY3Rpb24oKSB7cmV0dXJuICRoYXNobGliX25ldygnbWQ1Jyl9LAogICAgc2hhMTogZnVuY3Rpb24oKSB7cmV0dXJuICRoYXNobGliX25ldygnc2hhMScpfSwKICAgIHNoYTIyNDogZnVuY3Rpb24oKSB7cmV0dXJuICRoYXNobGliX25ldygnc2hhMjI0Jyl9LAogICAgc2hhMjU2OiBmdW5jdGlvbigpIHtyZXR1cm4gJGhhc2hsaWJfbmV3KCdzaGEyNTYnKX0sCiAgICBzaGEzODQ6IGZ1bmN0aW9uKCkge3JldHVybiAkaGFzaGxpYl9uZXcoJ3NoYTM4NCcpfSwKICAgIHNoYTUxMjogZnVuY3Rpb24oKSB7cmV0dXJuICRoYXNobGliX25ldygnc2hhNTEyJyl9LAoKICAgIGFsZ29yaXRobXNfZ3VhcmFudGVlZDogWydtZDUnLCAnc2hhMScsICdzaGEyMjQnLCAnc2hhMjU2JywgJ3NoYTM4NCcsICdzaGE1MTInXSwKICAgIGFsZ29yaXRobXNfYXZhaWxhYmxlOiAgWydtZDUnLCAnc2hhMScsICdzaGEyMjQnLCAnc2hhMjU2JywgJ3NoYTM4NCcsICdzaGE1MTInXQp9CgoKLy90b2RvOiBldmVudHVhbGx5IG1vdmUgdGhpcyBmdW5jdGlvbiB0byBhICJ1dGlsaXR5IiBmaWxlIG9yIHVzZSBhamF4IG1vZHVsZT8KZnVuY3Rpb24gJGdldF9DcnlwdG9KU19saWIoYWxnKSB7CiAgIHZhciBpbXA9JGltcG9ydGVyKCkKICAgdmFyICR4bWxodHRwPWltcFswXSwgZmFrZV9xcz1pbXBbMV0sIHRpbWVyPWltcFsyXSwgcmVzPW51bGwKCiAgICR4bWxodHRwLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCl7CiAgICAgICAgaWYoJHhtbGh0dHAucmVhZHlTdGF0ZT09NCl7CiAgICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGltZXIpCiAgICAgICAgICAgIGlmKCR4bWxodHRwLnN0YXR1cz09MjAwIHx8ICR4bWxodHRwLnN0YXR1cz09MCl7cmVzPSR4bWxodHRwLnJlc3BvbnNlVGV4dH0KICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgIC8vIGRvbid0IHRocm93IGFuIGV4Y2VwdGlvbiBoZXJlLCBpdCB3aWxsIG5vdCBiZSBjYXVnaHQgKGlzc3VlICMzMCkKICAgICAgICAgICAgICAgIHJlcyA9IEVycm9yKCkKICAgICAgICAgICAgICAgIHJlcy5uYW1lID0gJ05vdEZvdW5kRXJyb3InCiAgICAgICAgICAgICAgICByZXMubWVzc2FnZSA9ICJObyBDcnlwdG9KUyBsaWIgbmFtZWQgJyIrYWxnKyInIgogICAgICAgICAgICB9CiAgICAgICAgfQogICB9CgogICAkeG1saHR0cC5vcGVuKCdHRVQnLCBfX0JSWVRIT05fXy5icnl0aG9uX3BhdGgrJ2xpYnMvY3J5cHRvX2pzL3JvbGx1cHMvJythbGcrJy5qcycrZmFrZV9xcyxmYWxzZSkKICAgaWYoJ292ZXJyaWRlTWltZVR5cGUnIGluICR4bWxodHRwKXskeG1saHR0cC5vdmVycmlkZU1pbWVUeXBlKCJ0ZXh0L3BsYWluIil9CiAgICR4bWxodHRwLnNlbmQoKQogICBpZihyZXMuY29uc3RydWN0b3I9PT1FcnJvcil7dGhyb3cgcmVzfSAvLyBtb2R1bGUgbm90IGZvdW5kCgogICB0cnl7CiAgICAgIGV2YWwocmVzICsgIjsgX19CUllUSE9OX18uQ3J5cHRvSlM9Q3J5cHRvSlM7IikKICAgfSBjYXRjaCAoZXJyKSB7IAogICAgICB0aHJvdyBFcnJvcigiSlMgRXZhbCBFcnJvciIsICJDYW5ub3QgZXZhbCBDcnlwdG9KUyBhbGdvcml0aG0gJyIgKyBhbGcgKyAiJyA6IGVycm9yOiIgKyBlcnIpOwogICB9Cn0KCmZ1bmN0aW9uICRoYXNobGliX25ldyhhbGcpIHsKICAgIGlmIChhbGcgPT0gJ21kNScpIHsKICAgICAgIGlmIChfX0JSWVRIT05fXy5DcnlwdG8gPT09IHVuZGVmaW5lZCB8fCAKICAgICAgICAgICBfX0JSWVRIT05fXy5DcnlwdG9KUy5hbGdvLk1ENSA9PT0gdW5kZWZpbmVkKSAkZ2V0X0NyeXB0b0pTX2xpYignbWQ1JykKICAgICAgIHRoaXMuaGFzaCA9IF9fQlJZVEhPTl9fLkNyeXB0b0pTLmFsZ28uTUQ1LmNyZWF0ZSgpCiAgICB9IGVsc2UgaWYgKGFsZyA9PSAnc2hhMScpIHsKICAgICAgIGlmIChfX0JSWVRIT05fXy5DcnlwdG8gPT09IHVuZGVmaW5lZCB8fCAKICAgICAgICAgICBfX0JSWVRIT05fXy5DcnlwdG9KUy5hbGdvLlNIQTEgPT09IHVuZGVmaW5lZCkgJGdldF9DcnlwdG9KU19saWIoJ3NoYTEnKQogICAgICAgdGhpcy5oYXNoID0gX19CUllUSE9OX18uQ3J5cHRvSlMuYWxnby5TSEExLmNyZWF0ZSgpCiAgICB9IGVsc2UgaWYgKGFsZyA9PSAnc2hhMjI0JykgewogICAgICAgaWYgKF9fQlJZVEhPTl9fLkNyeXB0byA9PT0gdW5kZWZpbmVkIHx8IAogICAgICAgICAgIF9fQlJZVEhPTl9fLkNyeXB0b0pTLmFsZ28uU0hBMjI0ID09PSB1bmRlZmluZWQpICRnZXRfQ3J5cHRvSlNfbGliKCdzaGEyMjQnKQogICAgICAgdGhpcy5oYXNoID0gX19CUllUSE9OX18uQ3J5cHRvSlMuYWxnby5TSEEyMjQuY3JlYXRlKCkKICAgIH0gZWxzZSBpZiAoYWxnID09ICdzaGEyNTYnKSB7CiAgICAgICBpZiAoX19CUllUSE9OX18uQ3J5cHRvID09PSB1bmRlZmluZWQgfHwgCiAgICAgICAgICAgX19CUllUSE9OX18uQ3J5cHRvSlMuYWxnby5TSEEyNTYgPT09IHVuZGVmaW5lZCkgJGdldF9DcnlwdG9KU19saWIoJ3NoYTI1NicpCiAgICAgICB0aGlzLmhhc2ggPSBfX0JSWVRIT05fXy5DcnlwdG9KUy5hbGdvLlNIQTI1Ni5jcmVhdGUoKQogICAgfSBlbHNlIGlmIChhbGcgPT0gJ3NoYTM4NCcpIHsKICAgICAgIGlmIChfX0JSWVRIT05fXy5DcnlwdG8gPT09IHVuZGVmaW5lZCB8fCAKICAgICAgICAgICBfX0JSWVRIT05fXy5DcnlwdG9KUy5hbGdvLlNIQTM4NCA9PT0gdW5kZWZpbmVkKSAkZ2V0X0NyeXB0b0pTX2xpYignc2hhMzg0JykKICAgICAgIHRoaXMuaGFzaCA9IF9fQlJZVEhPTl9fLkNyeXB0b0pTLmFsZ28uU0hBMzg0LmNyZWF0ZSgpCiAgICB9IGVsc2UgaWYgKGFsZyA9PSAnc2hhNTEyJykgewogICAgICAgaWYgKF9fQlJZVEhPTl9fLkNyeXB0byA9PT0gdW5kZWZpbmVkIHx8IAogICAgICAgICAgIF9fQlJZVEhPTl9fLkNyeXB0b0pTLmFsZ28uU0hBNTEyID09PSB1bmRlZmluZWQpICRnZXRfQ3J5cHRvSlNfbGliKCdzaGE1MTInKQogICAgICAgdGhpcy5oYXNoID0gX19CUllUSE9OX18uQ3J5cHRvSlMuYWxnby5TSEE1MTIuY3JlYXRlKCkKICAgIH0gZWxzZSB7CiAgICAgICAkcmFpc2UoJ0F0dHJpYnV0ZUVycm9yJywgJ0ludmFsaWQgaGFzaCBhbGdvcml0aG06JyArIGFsZykKICAgIH0KIAogICAgdGhpcy5fX2NsYXNzX18gPSAkdHlwZQogICAgdGhpcy5fX2dldGF0dHJfXyA9IGZ1bmN0aW9uKGF0dHIpe3JldHVybiAkZ2V0YXR0cih0aGlzLGF0dHIpfQogICAgdGhpcy5fX3N0cl9fID0gZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oZXhkaWdlc3QoKX0KICAgIHRoaXMudXBkYXRlID0gZnVuY3Rpb24obXNnKXt0aGlzLmhhc2gudXBkYXRlKG1zZyl9CiAgICB0aGlzLmNvcHkgPSBmdW5jdGlvbigpe3JldHVybiB0aGlzLmhhc2guY2xvbmUoKX0KCiAgICB0aGlzLmhleGRpZ2VzdCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHZhciB0ZW1wPXRoaXMuaGFzaC5jbG9uZSgpOwogICAgICAgIHRlbXA9dGVtcC5maW5hbGl6ZSgpOwogICAgICAgIHJldHVybiB0ZW1wLnRvU3RyaW5nKCk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7Cn0KCiRtb2R1bGUuX19jbGFzc19fID0gJG1vZHVsZQokbW9kdWxlLl9fc3RyX18gPSBmdW5jdGlvbigpIHtyZXR1cm4gIjxtb2R1bGUgJ2hhc2hsaWInPiJ9Cg==',
'/libs/javascript.js':'JG1vZHVsZSA9IChmdW5jdGlvbigpewovLyB0cmFuc2Zvcm1zIGEgSmF2YXNjcmlwdCBjb25zdHJ1Y3RvciBpbnRvIGEgUHl0aG9uIGZ1bmN0aW9uCi8vIHRoYXQgcmV0dXJucyBpbnN0YW5jZXMgb2YgdGhlIGNvbnN0cnVjdG9yLCBjb252ZXJ0ZWQgdG8gUHl0aG9uIG9iamVjdHMKZnVuY3Rpb24gJGFwcGx5VG9Db25zdHJ1Y3Rvcihjb25zdHJ1Y3RvciwgYXJnQXJyYXkpIHsKICAgIHZhciBhcmdzID0gW251bGxdLmNvbmNhdChhcmdBcnJheSk7CiAgICB2YXIgZmFjdG9yeUZ1bmN0aW9uID0gY29uc3RydWN0b3IuYmluZC5hcHBseShjb25zdHJ1Y3RvciwgYXJncyk7CiAgICByZXR1cm4gbmV3IGZhY3RvcnlGdW5jdGlvbigpOwp9CgokSlNDb25zdHJ1Y3RvckRpY3QgPSB7CiAgICBfX2NsYXNzX186JHR5cGUsCiAgICBfX25hbWVfXzonSlNDb25zdHJ1Y3RvcicKfQoKJEpTQ29uc3RydWN0b3JEaWN0Ll9fY2FsbF9fID0gZnVuY3Rpb24oc2VsZil7CiAgICAvLyB0aGlzLmpzIGlzIGEgY29uc3RydWN0b3IKICAgIC8vIGl0IHRha2VzIEphdmFzY3JpcHQgYXJndW1lbnRzIHNvIHdlIG11c3QgY29udmVydAogICAgLy8gdGhvc2UgcGFzc2VkIHRvIHRoZSBQeXRob24gZnVuY3Rpb24KICAgIHZhciBhcmdzID0gW10KICAgIGZvcih2YXIgaT0xO2k8YXJndW1lbnRzLmxlbmd0aDtpKyspewogICAgICAgIHZhciBhcmcgPSBhcmd1bWVudHNbaV0KICAgICAgICBpZihhcmcgJiYgKGFyZy5fX2NsYXNzX189PT0kSlNPYmplY3REaWN0IHx8IGFyZy5fX2NsYXNzX189PT0kSlNDb25zdHJ1Y3RvckRpY3QpKXsKICAgICAgICAgICAgYXJncy5wdXNoKGFyZy5qcykKICAgICAgICB9CiAgICAgICAgZWxzZSBpZihpc2luc3RhbmNlKGFyZyxkaWN0KSl7CiAgICAgICAgICAgIHZhciBvYmogPSBuZXcgT2JqZWN0KCkKICAgICAgICAgICAgZm9yKHZhciBqPTA7ajxhcmcuJGtleXMubGVuZ3RoO2orKyl7CiAgICAgICAgICAgICAgICBvYmpbYXJnLiRrZXlzW2pdXT1hcmcuJHZhbHVlc1tqXQogICAgICAgICAgICB9CiAgICAgICAgICAgIGFyZ3MucHVzaChvYmopCiAgICAgICAgfWVsc2V7YXJncy5wdXNoKGFyZyl9CiAgICB9CiAgICB2YXIgcmVzID0gJGFwcGx5VG9Db25zdHJ1Y3RvcihzZWxmLmpzLGFyZ3MpCiAgICAvLyByZXMgaXMgYSBKYXZhc2NyaXB0IG9iamVjdAogICAgcmV0dXJuIEpTT2JqZWN0KHJlcykKfQoKJEpTQ29uc3RydWN0b3JEaWN0Ll9fbXJvX18gPSBbJEpTQ29uc3RydWN0b3JEaWN0LCRPYmplY3REaWN0XQoKZnVuY3Rpb24gSlNDb25zdHJ1Y3RvcihvYmopewogICAgcmV0dXJuIHsKICAgICAgICBfX2NsYXNzX186JEpTQ29uc3RydWN0b3JEaWN0LAogICAgICAgIGpzOm9iagogICAgfQp9CkpTQ29uc3RydWN0b3IuX19jbGFzc19fID0gJGZhY3RvcnkKSlNDb25zdHJ1Y3Rvci4kZGljdCA9ICRKU0NvbnN0cnVjdG9yRGljdAoKLy8gSlNPYmplY3QgOiB3cmFwcGVyIGFyb3VuZCBhIG5hdGl2ZSBKYXZhc2NyaXB0IG9iamVjdApmdW5jdGlvbiAkSlNPYmplY3QoanMpewogICAgdGhpcy5qcyA9IGpzCiAgICB0aGlzLiRkaWN0ID0ganMKICAgIHRoaXMuX19jbGFzc19fID0gJEpTT2JqZWN0RGljdAogICAgdGhpcy5fX3N0cl9fID0gZnVuY3Rpb24oKXtyZXR1cm4gIjxvYmplY3QgJ0pTT2JqZWN0JyB3cmFwcyAiK3RoaXMuanMrIj4ifQogICAgdGhpcy50b1N0cmluZyA9IHRoaXMuX19zdHJfXwp9CgokSlNPYmplY3REaWN0ID0gewogICAgX19jbGFzc19fOiR0eXBlLAogICAgX19uYW1lX186J0pTT2JqZWN0JywKICAgIHRvU3RyaW5nOmZ1bmN0aW9uKCl7cmV0dXJuICcoSlNPYmplY3QpJ30KfQoKJEpTT2JqZWN0RGljdC5fX2Jvb2xfXyA9IGZ1bmN0aW9uKHNlbGYpewogICAgcmV0dXJuIChuZXcgQm9vbGVhbihzZWxmLmpzKSkudmFsdWVPZigpCn0KCiRKU09iamVjdERpY3QuX19nZXRhdHRyaWJ1dGVfXyA9IGZ1bmN0aW9uKG9iaixhdHRyKXsKICAgIGlmKG9iai5qcz09PW51bGwpe3JldHVybiAkT2JqZWN0RGljdC5fX2dldGF0dHJpYnV0ZV9fKE5vbmUsYXR0cil9CiAgICBpZihhdHRyPT09J19fY2xhc3NfXycpe3JldHVybiAkSlNPYmplY3REaWN0fQogICAgaWYob2JqWydnZXRfJythdHRyXSE9PXVuZGVmaW5lZCl7CiAgICAgICAgdmFyIHJlcyA9IG9ialsnZ2V0XycrYXR0cl0KICAgICAgICBpZih0eXBlb2YgcmVzPT09J2Z1bmN0aW9uJyl7CiAgICAgICAgICAgIHJldHVybiAoZnVuY3Rpb24ob2JqKXsKICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpe3JldHVybiBvYmpbJ2dldF8nK2F0dHJdLmFwcGx5KG9iaixhcmd1bWVudHMpfQogICAgICAgICAgICAgIH0pKG9iaikKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG9ialsnZ2V0XycrYXR0cl0KICAgIH1lbHNlIGlmKG9iai5qc1thdHRyXSAhPT0gdW5kZWZpbmVkKXsKICAgICAgICBpZih0eXBlb2Ygb2JqLmpzW2F0dHJdPT0nZnVuY3Rpb24nKXsKICAgICAgICAgICAgdmFyIHJlcyA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdLGFyZwogICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxhcmd1bWVudHMubGVuZ3RoO2krKyl7CiAgICAgICAgICAgICAgICAgICAgYXJnID0gYXJndW1lbnRzW2ldCiAgICAgICAgICAgICAgICAgICAgaWYoYXJnICYmIChhcmcuX19jbGFzc19fPT09JEpTT2JqZWN0RGljdCB8fCBhcmcuX19jbGFzc19fPT09JEpTQ29uc3RydWN0b3JEaWN0KSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChhcmcuanMpCiAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChhcmcpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIHJlcyA9IG9iai5qc1thdHRyXS5hcHBseShvYmouanMsYXJncykKICAgICAgICAgICAgICAgIGlmKHR5cGVvZiByZXMgPT0gJ29iamVjdCcpe3JldHVybiBKU09iamVjdChyZXMpfQogICAgICAgICAgICAgICAgZWxzZSBpZihyZXM9PT11bmRlZmluZWQpe3JldHVybiBOb25lfQogICAgICAgICAgICAgICAgZWxzZXtyZXR1cm4gJEpTMlB5KHJlcyl9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVzLl9fcmVwcl9fID0gZnVuY3Rpb24oKXtyZXR1cm4gJzxmdW5jdGlvbiAnK2F0dHIrJz4nfQogICAgICAgICAgICByZXMuX19zdHJfXyA9IGZ1bmN0aW9uKCl7cmV0dXJuICc8ZnVuY3Rpb24gJythdHRyKyc+J30KICAgICAgICAgICAgcmV0dXJuIHJlcwogICAgICAgIH1lbHNlewogICAgICAgICAgICByZXR1cm4gJEpTMlB5KG9iai5qc1thdHRyXSkKICAgICAgICB9CiAgICB9ZWxzZSBpZihvYmouanM9PT13aW5kb3cgJiYgYXR0cj09PSckJGxvY2F0aW9uJyl7CiAgICAgICAgLy8gc3BlY2lhbCBsb29rdXAgYmVjYXVzZSBvZiBGaXJlZm94IGJ1ZyAKICAgICAgICAvLyBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD04MTQ2MjIKICAgICAgICByZXR1cm4gJExvY2F0aW9uKCkKICAgIH0KICAgIAogICAgdmFyIHJlcwogICAgLy8gc2VhcmNoIGluIGNsYXNzZXMgaGllcmFyY2h5LCBmb2xsb3dpbmcgbWV0aG9kIHJlc29sdXRpb24gb3JkZXIKICAgIHZhciBtcm8gPSBbJEpTT2JqZWN0RGljdCwkT2JqZWN0RGljdF0KICAgIGZvcih2YXIgaT0wO2k8bXJvLmxlbmd0aDtpKyspewogICAgICAgIHZhciB2PW1yb1tpXVthdHRyXQogICAgICAgIGlmKHYhPT11bmRlZmluZWQpewogICAgICAgICAgICByZXMgPSB2CiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgfQogICAgfQogICAgaWYocmVzIT09dW5kZWZpbmVkKXsKICAgICAgICBpZih0eXBlb2YgcmVzPT09J2Z1bmN0aW9uJyl7CiAgICAgICAgICAgIC8vIHJlcyBpcyB0aGUgZnVuY3Rpb24gaW4gb25lIG9mIHBhcmVudCBjbGFzc2VzCiAgICAgICAgICAgIC8vIHJldHVybiBhIGZ1bmN0aW9uIHRoYXQgdGFrZXMgb2JqIGFzIGZpcnN0IGFyZ3VtZW50CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbb2JqXSxhcmcKICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8YXJndW1lbnRzLmxlbmd0aDtpKyspewogICAgICAgICAgICAgICAgICAgIGFyZyA9IGFyZ3VtZW50c1tpXQogICAgICAgICAgICAgICAgICAgIGlmKGFyZyAmJiAoYXJnLl9fY2xhc3NfXz09PSRKU09iamVjdERpY3QgfHwgYXJnLl9fY2xhc3NfXz09PSRKU0NvbnN0cnVjdG9yRGljdCkpewogICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goYXJnLmpzKQogICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goYXJnKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiByZXMuYXBwbHkob2JqLGFyZ3MpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuICRKUzJQeShyZXMpCiAgICB9ZWxzZXsKICAgICAgICAvLyBYWFggc2VhcmNoIF9fZ2V0YXR0cl9fCiAgICAgICAgdGhyb3cgQXR0cmlidXRlRXJyb3IoIm5vIGF0dHJpYnV0ZSAiK2F0dHIrJyBmb3IgJyt0aGlzKQogICAgfQoKfQoKJEpTT2JqZWN0RGljdC5fX2dldGl0ZW1fXyA9IGZ1bmN0aW9uKHNlbGYscmFuayl7CiAgICB0cnl7cmV0dXJuIGdldGF0dHIoc2VsZi5qcywnX19nZXRpdGVtX18nKShyYW5rKX0KICAgIGNhdGNoKGVycil7CiAgICAgICAgY29uc29sZS5sb2coJ2VyciBpbiBKU09iamVjdC5fX2dldGl0ZW1fXyA6ICcrZXJyKQogICAgICAgIHRocm93IEF0dHJpYnV0ZUVycm9yKHNlbGYrJyBoYXMgbm8gYXR0cmlidXRlIF9fZ2V0aXRlbV9fJykKICAgIH0KfQoKJEpTT2JqZWN0RGljdC5fX2l0ZXJfXyA9IGZ1bmN0aW9uKHNlbGYpeyAvLyBmb3IgaXRlcmF0b3IgcHJvdG9jb2wKICAgIHZhciByZXMgPSB7CiAgICAgICAgX19jbGFzc19fOkpTT2JqZWN0LAogICAgICAgIF9fZ2V0YXR0cl9fOmZ1bmN0aW9uKGF0dHIpe3JldHVybiByZXNbYXR0cl19LAogICAgICAgIF9faXRlcl9fOmZ1bmN0aW9uKCl7cmV0dXJuIHJlc30sCiAgICAgICAgX19uZXh0X186ZnVuY3Rpb24oKXsKICAgICAgICAgICAgcmVzLmNvdW50ZXIrKwogICAgICAgICAgICBpZihyZXMuY291bnRlcjxzZWxmLmpzLmxlbmd0aCl7cmV0dXJuIHNlbGYuanNbcmVzLmNvdW50ZXJdfQogICAgICAgICAgICBlbHNle3Rocm93IFN0b3BJdGVyYXRpb24oIlN0b3BJdGVyYXRpb24iKX0KICAgICAgICB9LAogICAgICAgIF9fcmVwcl9fOmZ1bmN0aW9uKCl7cmV0dXJuICI8SlNPYmplY3QgaXRlcmF0b3Igb2JqZWN0PiJ9LAogICAgICAgIF9fc3RyX186ZnVuY3Rpb24oKXtyZXR1cm4gIjxKU09iamVjdCBpdGVyYXRvciBvYmplY3Q+In0sCiAgICAgICAgY291bnRlcjotMQogICAgfQogICAgcmV0dXJuIHJlcwp9CgokSlNPYmplY3REaWN0Ll9fbGVuX18gPSBmdW5jdGlvbihzZWxmKXsKICAgIHRyeXtyZXR1cm4gZ2V0YXR0cihzZWxmLmpzLCdfX2xlbl9fJykoKX0KICAgIGNhdGNoKGVycil7CiAgICAgICAgY29uc29sZS5sb2coJ2VyciBpbiBKU09iamVjdC5fX2xlbl9fIDogJytlcnIpCiAgICAgICAgdGhyb3cgQXR0cmlidXRlRXJyb3IodGhpcysnIGhhcyBubyBhdHRyaWJ1dGUgX19sZW5fXycpCiAgICB9Cn0KCiRKU09iamVjdERpY3QuX19tcm9fXyA9IFskSlNPYmplY3REaWN0LCRPYmplY3REaWN0XQoKJEpTT2JqZWN0RGljdC5fX3NldGF0dHJfXyA9IGZ1bmN0aW9uKHNlbGYsYXR0cix2YWx1ZSl7CiAgICBpZihpc2luc3RhbmNlKHZhbHVlLEpTT2JqZWN0KSl7CiAgICAgICAgc2VsZi5qc1thdHRyXT12YWx1ZS5qcwogICAgfWVsc2V7CiAgICAgICAgc2VsZi5qc1thdHRyXT12YWx1ZQogICAgfQp9CgpmdW5jdGlvbiBKU09iamVjdChvYmopewogICAgaWYob2JqPT09bnVsbCl7cmV0dXJuIG5ldyAkSlNPYmplY3Qob2JqKX0KICAgIGlmKG9iai5fX2NsYXNzX189PT0kTGlzdERpY3QpewogICAgICAgIC8vIEpTIGFycmF5cyBub3QgY3JlYXRlZCBieSBsaXN0KCkgbXVzdCBiZSB3cmFwcGVkCiAgICAgICAgaWYob2JqLl9fYnJ5dGhvbl9fKXtyZXR1cm4gb2JqfQogICAgICAgIGVsc2V7cmV0dXJuIG5ldyAkSlNPYmplY3Qob2JqKX0KICAgIH0KICAgIGlmKG9iai5fX2NsYXNzX18hPT11bmRlZmluZWQgJiYgKHR5cGVvZiBvYmohPT0nZnVuY3Rpb24nKSl7cmV0dXJuIG9ian0KICAgIHJldHVybiBuZXcgJEpTT2JqZWN0KG9iaikKfQpKU09iamVjdC5fX2NsYXNzX18gPSAkZmFjdG9yeQpKU09iamVjdC4kZGljdCA9ICRKU09iamVjdERpY3QKCnJldHVybiB7SlNPYmplY3Q6SlNPYmplY3QsSlNDb25zdHJ1Y3RvcjpKU0NvbnN0cnVjdG9yfQp9KSgp',
'/libs/json.js':'ZnVuY3Rpb24gX3B5KG9iail7CiAgICBpZihvYmo9PT1udWxsKXtyZXR1cm4gTm9uZX0KICAgIGlmKGlzaW5zdGFuY2Uob2JqLGxpc3QpKXsKICAgICAgICB2YXIgcmVzID0gW10KICAgICAgICBmb3IodmFyIGk9MDtpPG9iai5sZW5ndGg7aSsrKXsKICAgICAgICAgICAgcmVzLnB1c2goX3B5KG9ialtpXSkpCiAgICAgICAgfQogICAgICAgIHJldHVybiByZXMKICAgIH0KICAgIGlmKG9iai5fX2NsYXNzX18hPT11bmRlZmluZWQpewogICAgICAgIGlmKG9iai5fX2NsYXNzX189PT1saXN0KXsKICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxvYmoubGVuZ3RoO2krKyl7CiAgICAgICAgICAgICAgICBvYmpbaV0gPSBfcHkob2JqW2ldKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBvYmoKICAgIH0KICAgIGlmKHR5cGVvZiBvYmo9PT0nb2JqZWN0JyAmJiBvYmouX19jbGFzc19fPT09dW5kZWZpbmVkKXsKICAgICAgICAvLyB0cmFuc2Zvcm0gSlMgb2JqZWN0IGludG8gYSBQeXRob24gZGljdAogICAgICAgIHZhciByZXMgPSBkaWN0KCkKICAgICAgICBmb3IodmFyIGF0dHIgaW4gb2JqKXsKICAgICAgICAgICAgZ2V0YXR0cihyZXMsJ19fc2V0aXRlbV9fJykoYXR0cixfcHkob2JqW2F0dHJdKSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlcwogICAgfQogICAgcmV0dXJuIEpTT2JqZWN0KG9iaikKfQpmdW5jdGlvbiBfanMob2JqKXsKICAgIC8vIG9iaiBpcyBhIFB5dGhvbiBvYmplY3QKICAgIGlmIChpc2luc3RhbmNlKG9iaixbaW50LHN0cl0pKXtyZXR1cm4gb2JqfQogICAgZWxzZSBpZihvYmo9PT1Ob25lKXtyZXR1cm4gbnVsbH0KICAgIGVsc2UgaWYob2JqPT09VHJ1ZSl7cmV0dXJuIHRydWV9CiAgICBlbHNlIGlmKG9iaj09PUZhbHNlKXtyZXR1cm4gZmFsc2V9CiAgICBlbHNlIGlmKGlzaW5zdGFuY2Uob2JqLGZsb2F0KSl7cmV0dXJuIG9iai52YWx1ZX0KICAgIGVsc2UgaWYoaXNpbnN0YW5jZShvYmosW2xpc3QsdHVwbGVdKSl7CiAgICAgICAgdmFyIHJlcyA9IFtdCiAgICAgICAgZm9yKHZhciBpPTA7aTxvYmoubGVuZ3RoO2krKyl7cmVzLnB1c2goX2pzKG9ialtpXSkpfQogICAgICAgIHJldHVybiByZXMKICAgIH1lbHNlIGlmKGlzaW5zdGFuY2Uob2JqLGRpY3QpKXsKICAgICAgICB2YXIgcmVzID0gbmV3IE9iamVjdCgpCiAgICAgICAgZm9yKHZhciBpPTA7aTxvYmouJGtleXMubGVuZ3RoO2krKyl7CiAgICAgICAgICAgIHJlc1tfanMob2JqLiRrZXlzW2ldKV09X2pzKG9iai4kdmFsdWVzW2ldKQogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzCiAgICB9ZWxzZXsKICAgICAgICB0aHJvdyBUeXBlRXJyb3Ioc3RyKG9iaikrJyBpcyBub3QgSlNPTiBzZXJpYWxpemFibGUnKQogICAgfQp9CgokbW9kdWxlID0gIHsKCiAgICBsb2FkcyA6IGZ1bmN0aW9uKGpzb25fb2JqKXtyZXR1cm4gX3B5KEpTT04ucGFyc2UoanNvbl9vYmopKX0sCgogICAgZHVtcHMgOiBmdW5jdGlvbihvYmope3JldHVybiBKU09OLnN0cmluZ2lmeShfanMob2JqKSl9LAp9',
'/libs/marshal.js':'ZnVuY3Rpb24gX3B5KG9iail7CiAgICBpZihvYmo9PT1udWxsKXtyZXR1cm4gTm9uZX0KICAgIGlmKGlzaW5zdGFuY2Uob2JqLGxpc3QpKXsKICAgICAgICB2YXIgcmVzID0gW10KICAgICAgICBmb3IodmFyIGk9MDtpPG9iai5sZW5ndGg7aSsrKXsKICAgICAgICAgICAgcmVzLnB1c2goX3B5KG9ialtpXSkpCiAgICAgICAgfQogICAgICAgIHJldHVybiByZXMKICAgIH0KICAgIGlmKG9iai5fX2NsYXNzX18hPT11bmRlZmluZWQpewogICAgICAgIGlmKG9iai5fX2NsYXNzX189PT1saXN0KXsKICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxvYmoubGVuZ3RoO2krKyl7CiAgICAgICAgICAgICAgICBvYmpbaV0gPSBfcHkob2JqW2ldKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBvYmoKICAgIH0KICAgIGlmKHR5cGVvZiBvYmo9PT0nb2JqZWN0JyAmJiBvYmouX19jbGFzc19fPT09dW5kZWZpbmVkKXsKICAgICAgICAvLyB0cmFuc2Zvcm0gSlMgb2JqZWN0IGludG8gYSBQeXRob24gZGljdAogICAgICAgIHZhciByZXMgPSBkaWN0KCkKICAgICAgICBmb3IodmFyIGF0dHIgaW4gb2JqKXsKICAgICAgICAgICAgZ2V0YXR0cihyZXMsJ19fc2V0aXRlbV9fJykoYXR0cixfcHkob2JqW2F0dHJdKSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlcwogICAgfQogICAgcmV0dXJuIEpTT2JqZWN0KG9iaikKfQpmdW5jdGlvbiBfanMob2JqKXsKICAgIC8vIG9iaiBpcyBhIFB5dGhvbiBvYmplY3QKICAgIGlmIChpc2luc3RhbmNlKG9iaixbaW50LHN0cl0pKXtyZXR1cm4gb2JqfQogICAgZWxzZSBpZihvYmo9PT1Ob25lKXtyZXR1cm4gbnVsbH0KICAgIGVsc2UgaWYob2JqPT09VHJ1ZSl7cmV0dXJuIHRydWV9CiAgICBlbHNlIGlmKG9iaj09PUZhbHNlKXtyZXR1cm4gZmFsc2V9CiAgICBlbHNlIGlmKGlzaW5zdGFuY2Uob2JqLGZsb2F0KSl7cmV0dXJuIG9iai52YWx1ZX0KICAgIGVsc2UgaWYoaXNpbnN0YW5jZShvYmosW2xpc3QsdHVwbGVdKSl7CiAgICAgICAgdmFyIHJlcyA9IFtdCiAgICAgICAgZm9yKHZhciBpPTA7aTxvYmoubGVuZ3RoO2krKyl7cmVzLnB1c2goX2pzKG9ialtpXSkpfQogICAgICAgIHJldHVybiByZXMKICAgIH1lbHNlIGlmKGlzaW5zdGFuY2Uob2JqLGRpY3QpKXsKICAgICAgICB2YXIgcmVzID0gbmV3IE9iamVjdCgpCiAgICAgICAgZm9yKHZhciBpPTA7aTxvYmouJGtleXMubGVuZ3RoO2krKyl7CiAgICAgICAgICAgIHJlc1tfanMob2JqLiRrZXlzW2ldKV09X2pzKG9iai4kdmFsdWVzW2ldKQogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzCiAgICB9ZWxzZXsKICAgICAgICB0aHJvdyBUeXBlRXJyb3Ioc3RyKG9iaikrJyBpcyBub3QgSlNPTiBzZXJpYWxpemFibGUnKQogICAgfQp9CgokbW9kdWxlID0gIHsKCiAgICBsb2FkcyA6IGZ1bmN0aW9uKGpzb25fb2JqKXtyZXR1cm4gX3B5KEpTT04ucGFyc2UoanNvbl9vYmopKX0sCgogICAgZHVtcHMgOiBmdW5jdGlvbihvYmope3JldHVybiBKU09OLnN0cmluZ2lmeShfanMob2JqKSl9LAp9',
'/libs/math.js':'CnZhciBmbG9hdF9jaGVjaz1mdW5jdGlvbih4KSB7CiAgICBpZiAoaXNpbnN0YW5jZSh4LCBmbG9hdCkpIHJldHVybiB4LnZhbHVlOwogICAgcmV0dXJuIHg7Cn0KCnZhciBpc2luZj1mdW5jdGlvbih4KSB7CiAgICB2YXIgeDE9ZmxvYXRfY2hlY2soeCk7CiAgICByZXR1cm4geDEgPT0gLUluZmluaXR5IHx8IHgxID09IEluZmluaXR5IHx8IHgxID09IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSB8fCB4MSA9PSBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFk7Cn0KCiRtb2R1bGUgPSB7CiAgICBfX2dldGF0dHJfXyA6IGZ1bmN0aW9uKGF0dHIpewogICAgICAgIHZhciByZXMgPSB0aGlzW2F0dHJdCiAgICAgICAgaWYocmVzPT09dW5kZWZpbmVkKXskcmFpc2UoJ0F0dHJpYnV0ZUVycm9yJywnbW9kdWxlIG1hdGggaGFzIG5vIGF0dHJpYnV0ZSAnK2F0dHIpfQogICAgICAgIHJldHVybiByZXMKICAgIH0sCiAgICBhY29zOiBmdW5jdGlvbih4KSB7cmV0dXJuIGZsb2F0KE1hdGguYWNvcyhmbG9hdF9jaGVjayh4KSkpfSwKICAgIGFjb3NoOiBmdW5jdGlvbih4KSB7IAogICAgICAgIGlmIChpc2luZih4KSkgcmV0dXJuIGZsb2F0KCdpbmYnKTsKICAgICAgICB2YXIgeSA9IGZsb2F0X2NoZWNrKHgpOwogICAgICAgIHJldHVybiBmbG9hdChNYXRoLmxvZyh5ICsgTWF0aC5zcXJ0KHkqeS0xKSkpOwogICAgfSwKICAgIGFzaW46IGZ1bmN0aW9uKHgpIHtyZXR1cm4gZmxvYXQoTWF0aC5hc2luKGZsb2F0X2NoZWNrKHgpKSl9LAogICAgYXNpbmg6IGZ1bmN0aW9uKHgpIHsKICAgICAgICBpZiAoaXNpbmYoeCkpIHJldHVybiBmbG9hdCgnaW5mJyk7CiAgICAgICAgdmFyIHkgPSBmbG9hdF9jaGVjayh4KTsKICAgICAgICAKICAgICAgICByZXR1cm4gZmxvYXQoTWF0aC5sb2coeSArIE1hdGguc3FydCh5KnkrMSkpKQogICAgfSwKICAgIGF0YW46IGZ1bmN0aW9uKHgpIHsKICAgICAgICBpZiAoaXNpbmYoeCkpIHJldHVybiBmbG9hdChNYXRoLlBJLzIpOwogICAgICAgIHJldHVybiBmbG9hdChNYXRoLmF0YW4oZmxvYXRfY2hlY2soeCkpKX0sCiAgICBhdGFuMjogZnVuY3Rpb24oeSx4KSB7cmV0dXJuIGZsb2F0KE1hdGguYXRhbjIoeSx4KSl9LAogICAgYXRhbmg6IGZ1bmN0aW9uKHgpIHsgCiAgICAgICB2YXIgeT1mbG9hdF9jaGVjayh4KTsKICAgICAgIGlmICh5PT0wKSByZXR1cm4gMDsKICAgICAgIHJldHVybiBmbG9hdCgwLjUgKiBNYXRoLmxvZygoMS95KzEpLygxL3ktMSkpKTsKICAgIH0sCiAgICBjZWlsOiBmdW5jdGlvbih4KSB7CiAgICAgICB2YXIgeT1mbG9hdF9jaGVjayh4KTsKICAgICAgIGlmICghaXNOYU4ocGFyc2VGbG9hdCh5KSkgJiYgaXNGaW5pdGUoeSkpIHJldHVybiBpbnQoTWF0aC5jZWlsKHkpKTsKICAgICAgIHRyeXtyZXR1cm4gZ2V0YXR0cih5LCdfX2NlaWxfXycpKCl9Y2F0Y2goZXJyKXskcG9wX2V4YygpfQogICAgICAgCiAgICAgICAkcmFpc2UoJ1ZhbHVlRXJyb3InLCAnb2JqZWN0IGlzIG5vdCBhIG51bWJlciBhbmQgZG9lcyBub3QgY29udGFpbiBfX2NlaWxfXycpCiAgICB9LAogICAgY29weXNpZ246IGZ1bmN0aW9uKHgseSkgewogICAgICAgIHZhciB4MT1NYXRoLmFicyhmbG9hdF9jaGVjayh4KSk7CiAgICAgICAgdmFyIHkxPWZsb2F0X2NoZWNrKHkpOyAKICAgICAgICB2YXIgc2lnbj15MT95MTwwPy0xOjE6MQogICAgICAgIGlmKGlzaW5zdGFuY2UoeCxpbnQpKXtyZXR1cm4geDEgKiBzaWdufQogICAgICAgIGVsc2V7cmV0dXJuIGZsb2F0KHgxICogc2lnbil9CiAgICB9LAogICAgY29zIDogZnVuY3Rpb24oeCl7cmV0dXJuIGZsb2F0KE1hdGguY29zKGZsb2F0X2NoZWNrKHgpKSl9LAogICAgZGVncmVlczogZnVuY3Rpb24oeCl7cmV0dXJuIGZsb2F0KGZsb2F0X2NoZWNrKHgpICogMTgwL01hdGguUEkpfSwKICAgIGU6IGZsb2F0KE1hdGguRSksCiAgICBlcmY6IGZ1bmN0aW9uKHgpIHsKICAgICAgICAvLyBpbnNwaXJlZCBmcm9tIAogICAgICAgIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNDU3NDA4L2lzLXRoZXJlLWFuLWVhc2lseS1hdmFpbGFibGUtaW1wbGVtZW50YXRpb24tb2YtZXJmLWZvci1weXRob24KICAgICAgICB2YXIgeSA9ZmxvYXRfY2hlY2soeCk7CiAgICAgICAgdmFyIHQgPSAxLjAgLyAoMS4wICsgMC41ICogTWF0aC5hYnMoeSkpCiAgICAgICAgdmFyIGFucyA9IDEgLSB0ICogTWF0aC5leHAoIC15KnkgLSAxLjI2NTUxMjIzICsKICAgICAgICAgICAgICAgICAgICAgdCAqICggMS4wMDAwMjM2OCArCiAgICAgICAgICAgICAgICAgICAgIHQgKiAoIDAuMzc0MDkxOTYgKyAKICAgICAgICAgICAgICAgICAgICAgdCAqICggMC4wOTY3ODQxOCArIAogICAgICAgICAgICAgICAgICAgICB0ICogKC0wLjE4NjI4ODA2ICsgCiAgICAgICAgICAgICAgICAgICAgIHQgKiAoIDAuMjc4ODY4MDcgKyAKICAgICAgICAgICAgICAgICAgICAgdCAqICgtMS4xMzUyMDM5OCArIAogICAgICAgICAgICAgICAgICAgICB0ICogKCAxLjQ4ODUxNTg3ICsgCiAgICAgICAgICAgICAgICAgICAgIHQgKiAoLTAuODIyMTUyMjMgKyAKICAgICAgICAgICAgICAgICAgICAgdCAqIDAuMTcwODcyNzcpKSkpKSkpKSkKICAgICAgICBpZiAoeSA+PSAwLjApIHJldHVybiBhbnMKCiAgICAgICAgcmV0dXJuIC1hbnMKICAgIH0sCgogICAgZXJmYzogZnVuY3Rpb24oeCkgewogICAgICAgIC8vIGluc3BpcmVkIGZyb20gCiAgICAgICAgLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy80NTc0MDgvaXMtdGhlcmUtYW4tZWFzaWx5LWF2YWlsYWJsZS1pbXBsZW1lbnRhdGlvbi1vZi1lcmYtZm9yLXB5dGhvbgogICAgICAgIHZhciB5ID0gZmxvYXRfY2hlY2soeCk7CiAgICAgICAgdmFyIHQgPSAxLjAgLyAoMS4wICsgMC41ICogTWF0aC5hYnMoeSkpCiAgICAgICAgdmFyIGFucyA9IDEgLSB0ICogTWF0aC5leHAoIC15KnkgLSAxLjI2NTUxMjIzICsKICAgICAgICAgICAgICAgICAgICAgdCAqICggMS4wMDAwMjM2OCArCiAgICAgICAgICAgICAgICAgICAgIHQgKiAoIDAuMzc0MDkxOTYgKyAKICAgICAgICAgICAgICAgICAgICAgdCAqICggMC4wOTY3ODQxOCArIAogICAgICAgICAgICAgICAgICAgICB0ICogKC0wLjE4NjI4ODA2ICsgCiAgICAgICAgICAgICAgICAgICAgIHQgKiAoIDAuMjc4ODY4MDcgKyAKICAgICAgICAgICAgICAgICAgICAgdCAqICgtMS4xMzUyMDM5OCArIAogICAgICAgICAgICAgICAgICAgICB0ICogKCAxLjQ4ODUxNTg3ICsgCiAgICAgICAgICAgICAgICAgICAgIHQgKiAoLTAuODIyMTUyMjMgKyAKICAgICAgICAgICAgICAgICAgICAgdCAqIDAuMTcwODcyNzcpKSkpKSkpKSkKICAgICAgICBpZiAoeSA+PSAwLjApIHJldHVybiAxLWFucwogICAgICAgIHJldHVybiAxK2FucwogICAgfSwKICAgIGV4cDogZnVuY3Rpb24oeCl7cmV0dXJuIGZsb2F0KE1hdGguZXhwKGZsb2F0X2NoZWNrKHgpKSl9LAogICAgZXhwbTE6IGZ1bmN0aW9uKHgpe3JldHVybiBmbG9hdChNYXRoLmV4cChmbG9hdF9jaGVjayh4KSktMSl9LAogICAgZmFiczogZnVuY3Rpb24oeCl7IHJldHVybiB4PjA/ZmxvYXQoeCk6ZmxvYXQoLXgpfSwKICAgIGZhY3RvcmlhbDogZnVuY3Rpb24oeCkgewogICAgICAgICAvL3VzaW5nIGNvZGUgZnJvbSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzM5NTkyMTEvZmFzdC1mYWN0b3JpYWwtZnVuY3Rpb24taW4tamF2YXNjcmlwdAogICAgICAgICB2YXIgeT1mbG9hdF9jaGVjayh4KTsKICAgICAgICAgdmFyIHI9MQogICAgICAgICBmb3IgKHZhciBpPTI7IGk8PXk7IGkrKyl7cio9aX0KICAgICAgICAgcmV0dXJuIHIKICAgIH0sCiAgICBmbG9vcjpmdW5jdGlvbih4KXtyZXR1cm4gTWF0aC5mbG9vcihmbG9hdF9jaGVjayh4KSl9LAogICAgZm1vZDpmdW5jdGlvbih4LHkpe3JldHVybiBmbG9hdChmbG9hdF9jaGVjayh4KSVmbG9hdF9jaGVjayh5KSl9LAogICAgZnJleHA6ZnVuY3Rpb24oeCl7CiAgICAgICB2YXIgeDE9ZmxvYXRfY2hlY2soeCk7CiAgICAgICB2YXIgZXggPSBNYXRoLmZsb29yKE1hdGgubG9nKHgxKSAvIE1hdGgubG9nKDIpKSArIDE7CiAgICAgICBmcmFjID0geDEgLyBNYXRoLnBvdygyLCBleCk7CiAgICAgICByZXR1cm4gW2ZyYWMsIGV4XTsKICAgIH0sCiAgICAvL2ZzdW06ZnVuY3Rpb24oeCl7fSwKICAgIGdhbW1hOiBmdW5jdGlvbih4KXsKICAgICAgICAgLy91c2luZyBjb2RlIGZyb20gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8zOTU5MjExL2Zhc3QtZmFjdG9yaWFsLWZ1bmN0aW9uLWluLWphdmFzY3JpcHQKICAgICAgICAgLy8gTGFuY3pvcyBBcHByb3hpbWF0aW9uIG9mIHRoZSBHYW1tYSBGdW5jdGlvbgogICAgICAgICAvLyBBcyBkZXNjcmliZWQgaW4gTnVtZXJpY2FsIFJlY2lwZXMgaW4gQyAoMm5kIGVkLiBDYW1icmlkZ2UgVW5pdmVyc2l0eSBQcmVzcywgMTk5MikKICAgICAgICAgdmFyIHk9ZmxvYXRfY2hlY2soeCk7CiAgICAgICAgIHZhciB6ID0geSArIDE7CiAgICAgICAgIHZhciBkMSA9IE1hdGguc3FydCgyICogTWF0aC5QSSkgLyB6OwoKICAgICAgICAgdmFyIGQyID0gMS4wMDAwMDAwMDAxOTAwMTU7CiAgICAgICAgIGQyICs9ICA3Ni4xODAwOTE3Mjk0NzE0NiAvICh6KzEpOwogICAgICAgICBkMiArPSAtODYuNTA1MzIwMzI5NDE2NzcgLyAoeisyKTsKICAgICAgICAgZDIgKz0gIDI0LjAxNDA5ODI0MDgzMDkxIC8gKHorMyk7IAogICAgICAgICBkMiArPSAtMS4yMzE3Mzk1NzI0NTAxNTUgLyAoeis0KTsgCiAgICAgICAgIGQyICs9ICAxLjIwODY1MDk3Mzg2NjE3OUUtMyAvICh6KzUpOwogICAgICAgICBkMiArPSAtNS4zOTUyMzkzODQ5NTNFLTYgLyAoeis2KTsKCiAgICAgICAgIHJldHVybiBkMSAqIGQyICogTWF0aC5wb3coeis1LjUseiswLjUpICogTWF0aC5leHAoLSh6KzUuNSkpOwogICAgfSwKICAgIGh5cG90OiBmdW5jdGlvbih4LHkpewogICAgICAgdmFyIHgxPWZsb2F0X2NoZWNrKHgpOwogICAgICAgdmFyIHkxPWZsb2F0X2NoZWNrKHkpOwogICAgICAgcmV0dXJuIGZsb2F0KE1hdGguc3FydCh4MSp4MSArIHkxKnkxKSl9LAogICAgaXNmaW5pdGU6ZnVuY3Rpb24oeCkge3JldHVybiBpc0Zpbml0ZShmbG9hdF9jaGVjayh4KSl9LAogICAgaXNpbmY6ZnVuY3Rpb24oeCkgeyByZXR1cm4gaXNpbmYoeCk7fSwKICAgIGlzbmFuOmZ1bmN0aW9uKHgpIHtyZXR1cm4gaXNOYU4oZmxvYXRfY2hlY2soeCkpfSwKICAgIGxkZXhwOmZ1bmN0aW9uKHgsaSkgewogICAgICAgIHZhciBtdWwgPSBNYXRoLnBvdygyLGZsb2F0X2NoZWNrKGkpKQogICAgICAgIGlmKGlzaW5zdGFuY2UoeCxpbnQpKXtyZXR1cm4geCAqIG11bH0KICAgICAgICBlbHNle3JldHVybiBmbG9hdCh4LnZhbHVlKm11bCl9CiAgICB9LAogICAgbGdhbW1hOmZ1bmN0aW9uKHgpIHsKICAgICAgICAgLy8gc2VlIGdhbW1hIGZ1bmN0aW9uIGZvciBzb3VyY2VzCiAgICAgICAgIHZhciB5PWZsb2F0X2NoZWNrKHgpOwogICAgICAgICB2YXIgeiA9IHkgKyAxOwogICAgICAgICB2YXIgZDEgPSBNYXRoLnNxcnQoMiAqIE1hdGguUEkpIC8gejsKCiAgICAgICAgIHZhciBkMiA9IDEuMDAwMDAwMDAwMTkwMDE1OwogICAgICAgICBkMiArPSAgNzYuMTgwMDkxNzI5NDcxNDYgLyAoeisxKTsKICAgICAgICAgZDIgKz0gLTg2LjUwNTMyMDMyOTQxNjc3IC8gKHorMik7CiAgICAgICAgIGQyICs9ICAyNC4wMTQwOTgyNDA4MzA5MSAvICh6KzMpOyAKICAgICAgICAgZDIgKz0gLTEuMjMxNzM5NTcyNDUwMTU1IC8gKHorNCk7IAogICAgICAgICBkMiArPSAgMS4yMDg2NTA5NzM4NjYxNzlFLTMgLyAoeis1KTsKICAgICAgICAgZDIgKz0gLTUuMzk1MjM5Mzg0OTUzRS02IC8gKHorNik7CgogICAgICAgICByZXR1cm4gZmxvYXQoTWF0aC5sb2coTWF0aC5hYnMoZDEgKiBkMiAqIE1hdGgucG93KHorNS41LHorMC41KSAqIE1hdGguZXhwKC0oeis1LjUpKSkpKTsKICAgIH0sCiAgICBsb2c6IGZ1bmN0aW9uKHgsIGJhc2UpIHsKICAgICAgICAgdmFyIHgxPWZsb2F0X2NoZWNrKHgpOwogICAgICAgICBpZiAoYmFzZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gZmxvYXQoTWF0aC5sb2coeDEpKTsKICAgICAgICAgcmV0dXJuIGZsb2F0KE1hdGgubG9nKHgxKS9NYXRoLmxvZyhmbG9hdF9jaGVjayhiYXNlKSkpOwogICAgfSwKICAgIGxvZzFwOiBmdW5jdGlvbih4KSB7cmV0dXJuIGZsb2F0KE1hdGgubG9nKDEuMCArIGZsb2F0X2NoZWNrKHgpKSl9LAogICAgbG9nMjogZnVuY3Rpb24oeCkge3JldHVybiBmbG9hdChNYXRoLmxvZyhmbG9hdF9jaGVjayh4KSkvTWF0aC5MTjIpfSwKICAgIGxvZzEwOiBmdW5jdGlvbih4KSB7cmV0dXJuIGZsb2F0KE1hdGgubG9nKGZsb2F0X2NoZWNrKHgpKS9NYXRoLkxOMTApfSwKICAgIG1vZGY6ZnVuY3Rpb24oeCkgewogICAgICAgdmFyIHgxPWZsb2F0X2NoZWNrKHgpOwogICAgICAgaWYgKHgxID4gMCkgewogICAgICAgICAgdmFyIGk9ZmxvYXQoeDEtTWF0aC5mbG9vcih4MSkpOwogICAgICAgICAgcmV0dXJuIFtpLCBmbG9hdCh4MS1pKV0KICAgICAgIH0KCiAgICAgICB2YXIgaT1mbG9hdCh4MS1NYXRoLmNlaWwoeDEpKTsKICAgICAgIHJldHVybiBbaSwgZmxvYXQoTWF0aC5jZWlsKHgxKSldCiAgICB9LAogICAgcGkgOiBmbG9hdChNYXRoLlBJKSwKICAgIHBvdzogZnVuY3Rpb24oeCx5KSB7CiAgICAgICAgaWYoaXNpbnN0YW5jZSh4LGludCkpe3JldHVybiBNYXRoLnBvdyh4LGZsb2F0X2NoZWNrKHkpKX0KICAgICAgICBlbHNle3JldHVybiBmbG9hdChNYXRoLnBvdyh4LnZhbHVlLGZsb2F0X2NoZWNrKHkpKSl9CiAgICB9LAogICAgcmFkaWFuczogZnVuY3Rpb24oeCl7cmV0dXJuIGZsb2F0KGZsb2F0X2NoZWNrKHgpICogTWF0aC5QSS8xODApfSwKICAgIHNpbiA6IGZ1bmN0aW9uKHgpe3JldHVybiBmbG9hdChNYXRoLnNpbihmbG9hdF9jaGVjayh4KSkpfSwKICAgIHNxcnQgOiBmdW5jdGlvbih4KXtyZXR1cm4gZmxvYXQoTWF0aC5zcXJ0KGZsb2F0X2NoZWNrKHgpKSl9LAogICAgdHJ1bmM6IGZ1bmN0aW9uKHgpIHsKICAgICAgIHRyeXtyZXR1cm4gZ2V0YXR0cih4LCdfX3RydW5jX18nKSgpfWNhdGNoKGVycil7JHBvcF9leGMoKX0KICAgICAgIHZhciB4MT1mbG9hdF9jaGVjayh4KTsKICAgICAgIGlmICghaXNOYU4ocGFyc2VGbG9hdCh4MSkpICYmIGlzRmluaXRlKHgxKSkgcmV0dXJuIGludChNYXRoLmZsb29yKHgxKSk7CiAgICAgICAKICAgICAgICRyYWlzZSgnVmFsdWVFcnJvcicsICdvYmplY3QgaXMgbm90IGEgbnVtYmVyIGFuZCBkb2VzIG5vdCBjb250YWluIF9fdHJ1bmNfXycpCiAgICB9Cn0KCmZvcih2YXIgJGF0dHIgaW4gJG1vZHVsZSl7CiAgICBpZih0eXBlb2YgJG1vZHVsZVskYXR0cl09PT0nZnVuY3Rpb24nKXsKICAgICAgICAkbW9kdWxlWyRhdHRyXS5fX3JlcHJfXz0oZnVuY3Rpb24oZnVuYyl7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpe3JldHVybiAnPGJ1aWx0LWluIGZ1bmN0aW9uICcrZnVuYysnPid9fSkoJGF0dHIpCiAgICAgICAgJG1vZHVsZVskYXR0cl0uX19zdHJfXz0oZnVuY3Rpb24oZnVuYyl7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpe3JldHVybiAnPGJ1aWx0LWluIGZ1bmN0aW9uICcrZnVuYysnPid9fSkoJGF0dHIpCiAgICB9Cn0K',
'/libs/random.js':'JG1vZHVsZSA9IHsKICAgIF9fZ2V0YXR0cl9fIDogZnVuY3Rpb24oYXR0cil7cmV0dXJuIHRoaXNbYXR0cl19LAogICAgcmFuZG9tOmZ1bmN0aW9uKCl7CiAgICAgIGlmKGFyZ3VtZW50cy5sZW5ndGggPiAwKXsKICAgICAgICB0aHJvdyBUeXBlRXJyb3IoInJhbmRvbSgpIHRha2VzIG5vIGFyZ3VtZW50cyAoIithcmd1bWVudHMubGVuZ3RoKyIgZ2l2ZW4pIikKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmxvYXQoTWF0aC5yYW5kb20oKSk7CiAgICAgIH0KICAgIH0sCiAgICByYW5kaW50OmZ1bmN0aW9uKGEsYil7cmV0dXJuIGludChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqKGItYSsxKSthKSl9LAogICAgcmFuZHJhbmdlOmZ1bmN0aW9uKHN0YXJ0LHN0b3Asc3RlcCl7CiAgICAgIGlmKHN0ZXAgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHN0ZXA9MTsKICAgICAgfSBlbHNlIGlmKHN0ZXAgPT0gMCkgeyAKICAgICAgICAvL3JhaXNlIFZhbHVlRXJyb3IoInplcm8gc3RlcCBmb3IgcmFuZHJhbmdlKCkiKTsKICAgICAgfQoKICAgICAgaWYoc3RvcCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgIHN0b3A9c3RhcnQ7CiAgICAgICAgIHN0YXJ0PTA7CiAgICAgIH0KICAgICAgdmFyIHdpZHRoPXN0b3Atc3RhcnQ7CiAgICAgIGlmIChzdGVwPT0xICYmIHdpZHRoID4gMCkgewogICAgICAgIHJldHVybiBzdGFydCArIGludChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqd2lkdGgpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyByYWlzZSBWYWx1ZUVycm9yKCJlbXB0eSByYW5nZSBmb3IgcmFuZHJhbmdlKCkgKCIrc3RhcnQrIiwiK3N0b3ArJywnK3N0ZXArJyknKTsKICAgICAgfQogICAgICAKICAgICAgdmFyIG47CiAgICAgIGlmIChzdGVwID4gMCkgewogICAgICAgICBuPU1hdGguZmxvb3IoKHdpZHRoK3N0ZXAtMSkvc3RlcCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgIG49TWF0aC5mbG9vcigod2lkdGgrc3RlcCsxKS9zdGVwKTsKICAgICAgfQogICAgICByZXR1cm4gc3RhcnQgKyBzdGVwKmludChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqbikpCiAgICAgIC8vcmV0dXJuIGludChNYXRoLnJhbmRvbSgpKihzdG9wL3N0ZXAtc3RhcnQvc3RlcCkqc3RlcCArIHN0YXJ0KQogICAgfSwKICAgIHNodWZmbGU6ZnVuY3Rpb24oeCwgcm5kKXsKICAgICAgaWYgKHgubGVuZ3RoIDw9IDEpIHsgcmV0dXJuIHh9CgogICAgICBpZiAocm5kID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgcm5kPU1hdGgucmFuZG9tCiAgICAgIH0KCiAgICAgIGZvcih2YXIgaiwgbywgaSA9IHgubGVuZ3RoOyBpOyBqID0gcGFyc2VJbnQocm5kKCkgKiBpKSwgbyA9IHhbLS1pXSwgeFtpXSA9IHhbal0sIHhbal0gPSBvKTsKICAgIH0KfQokbW9kdWxlLl9fY2xhc3NfXyA9ICRtb2R1bGUgLy8gZGVmaW5lZCBpbiAkcHlfdXRpbHMKJG1vZHVsZS5fX3N0cl9fID0gZnVuY3Rpb24oKXtyZXR1cm4gIjxtb2R1bGUgJ3JhbmRvbSc+In0K',
'/libs/re.js':'JG1vZHVsZSA9IChmdW5jdGlvbigpewogICAgb2JqID0ge19fY2xhc3NfXzokbW9kdWxlLAogICAgICAgIF9fc3RyX186IGZ1bmN0aW9uKCl7cmV0dXJuICI8bW9kdWxlICdyZSc+In0KICAgIH0KICAgIG9iai5BID0gb2JqLkFTQ0lJID0gMjU2CiAgICBvYmouSSA9IG9iai5JR05PUkVDQVNFID0gJ2knCiAgICBvYmouTSA9IG9iai5NVUxUSUxJTkUgPSAnbScKICAgICRTUkVfUGF0dGVybkRpY3QgPSB7CiAgICAgICAgX19jbGFzc19fOiR0eXBlLAogICAgICAgIF9fbmFtZV9fOidTUkVfUGF0dGVybicKICAgIH0KICAgICRTUkVfUGF0dGVybkRpY3QubWF0Y2ggPSBmdW5jdGlvbihzZWxmLHN0cmluZyl7CiAgICAgICAgcmV0dXJuIG9iai5tYXRjaChzZWxmLnBhdHRlcm4sc3RyaW5nLHNlbGYuZmxhZ3MpCiAgICB9CiAgICAkU1JFX1BhdHRlcm5EaWN0LnNlYXJjaCA9IGZ1bmN0aW9uKHNlbGYsc3RyaW5nKXsKICAgICAgICByZXR1cm4gb2JqLm9iaihzZWxmLnBhdHRlcm4sc3RyaW5nLHNlbGYuZmxhZ3MpCiAgICB9CiAgICBvYmouY29tcGlsZSA9IGZ1bmN0aW9uKHBhdHRlcm4sZmxhZ3MpewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIF9fY2xhc3NfXzokU1JFX1BhdHRlcm5EaWN0LAogICAgICAgICAgICBwYXR0ZXJuOnBhdHRlcm4sCiAgICAgICAgICAgIGZsYWdzOmZsYWdzCiAgICAgICAgfQogICAgfQogICAgb2JqLmZpbmRhbGwgPSBmdW5jdGlvbihwYXR0ZXJuLHN0cmluZyxmbGFncyl7CiAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoJ3JlLnNlYXJjaCcsYXJndW1lbnRzLFsncGF0dGVybicsJ3N0cmluZyddLHt9LCdhcmdzJywna3cnKQogICAgICAgIHZhciBhcmdzID0gJG5zWydhcmdzJ10KICAgICAgICBpZihhcmdzLmxlbmd0aD4wKXt2YXIgZmxhZ3M9YXJnc1swXX0KICAgICAgICBlbHNle3ZhciBmbGFncyA9ICRuc1sna3cnXS5nZXQoJ2ZsYWdzJywnJyl9CiAgICAgICAgZmxhZ3MgKz0gJ2dtJwogICAgICAgIHZhciBqc3AgPSBuZXcgUmVnRXhwKHBhdHRlcm4sZmxhZ3MpCiAgICAgICAgdmFyIGpzbWF0Y2ggPSBzdHJpbmcubWF0Y2goanNwKQogICAgICAgIGlmKGpzbWF0Y2g9PT1udWxsKXtyZXR1cm4gW119CiAgICAgICAgcmV0dXJuIGpzbWF0Y2gKICAgIH0KICAgIG9iai5zZWFyY2ggPSBmdW5jdGlvbihwYXR0ZXJuLHN0cmluZyl7CiAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoJ3JlLnNlYXJjaCcsYXJndW1lbnRzLFsncGF0dGVybicsJ3N0cmluZyddLHt9LCdhcmdzJywna3cnKQogICAgICAgIHZhciBhcmdzID0gJG5zWydhcmdzJ10KICAgICAgICBpZihhcmdzLmxlbmd0aD4wKXt2YXIgZmxhZ3M9YXJnc1swXX0KICAgICAgICBlbHNle3ZhciBmbGFncyA9IGdldGF0dHIoJG5zWydrdyddLCdnZXQnKSgnZmxhZ3MnLCcnKX0KICAgICAgICB2YXIganNwID0gbmV3IFJlZ0V4cChwYXR0ZXJuLGZsYWdzKQogICAgICAgIHZhciBqc21hdGNoID0gc3RyaW5nLm1hdGNoKGpzcCkKICAgICAgICBpZihqc21hdGNoPT09bnVsbCl7cmV0dXJuIE5vbmV9CiAgICAgICAgdmFyIG1vID0gbmV3IE9iamVjdCgpCiAgICAgICAgbW8uZ3JvdXAgPSBmdW5jdGlvbigpewogICAgICAgICAgICB2YXIgcmVzID0gW10KICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxhcmd1bWVudHMubGVuZ3RoO2krKyl7CiAgICAgICAgICAgICAgICBpZihqc21hdGNoW2FyZ3VtZW50c1tpXV09PT11bmRlZmluZWQpe3Jlcy5wdXNoKE5vbmUpfQogICAgICAgICAgICAgICAgZWxzZXtyZXMucHVzaChqc21hdGNoW2FyZ3VtZW50c1tpXV0pfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4gcmVzWzBdfQogICAgICAgICAgICByZXR1cm4gdHVwbGUocmVzKQogICAgICAgIH0KICAgICAgICBtby5ncm91cHMgPSBmdW5jdGlvbihfZGVmYXVsdCl7CiAgICAgICAgICAgIGlmKF9kZWZhdWx0PT09dW5kZWZpbmVkKXtfZGVmYXVsdD1Ob25lfQogICAgICAgICAgICB2YXIgcmVzID0gW10KICAgICAgICAgICAgZm9yKHZhciBpPTE7aTxqc21hdGNoLmxlbmd0aDtpKyspewogICAgICAgICAgICAgICAgaWYoanNtYXRjaFtpXT09PXVuZGVmaW5lZCl7cmVzLnB1c2goX2RlZmF1bHQpfQogICAgICAgICAgICAgICAgZWxzZXtyZXMucHVzaChqc21hdGNoW2ldKX0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdHVwbGUocmVzKQogICAgICAgIH0KICAgICAgICBtby5zdGFydCA9IGZ1bmN0aW9uKCl7cmV0dXJuIGpzbWF0Y2guaW5kZXh9CiAgICAgICAgbW8uc3RyaW5nID0gc3RyaW5nCiAgICAgICAgcmV0dXJuIEpTT2JqZWN0KG1vKQogICAgfQogICAgb2JqLnN1YiA9IGZ1bmN0aW9uKHBhdHRlcm4scmVwbCxzdHJpbmcpewogICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCdyZS5zZWFyY2gnLGFyZ3VtZW50cyxbJ3BhdHRlcm4nLCdyZXBsJywnc3RyaW5nJ10se30sJ2FyZ3MnLCdrdycpCiAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgdmFyIGFyZ3MgPSAkbnNbJ2FyZ3MnXQogICAgICAgIHZhciBjb3VudCA9ICREaWN0RGljdC5nZXQoJG5zWydrdyddLCdjb3VudCcsMCkKICAgICAgICB2YXIgZmxhZ3MgPSAkRGljdERpY3QuZ2V0KCRuc1sna3cnXSwnZmxhZ3MnLCcnKQogICAgICAgIGlmKGFyZ3MubGVuZ3RoPjApe3ZhciBjb3VudD1hcmdzWzBdfQogICAgICAgIGlmKGFyZ3MubGVuZ3RoPjEpe3ZhciBmbGFncz1hcmdzWzFdfQogICAgICAgIGlmKHR5cGVvZiByZXBsPT09InN0cmluZyIpewogICAgICAgICAgICAvLyBiYWNrcmVmZXJlbmNlcyBhcmUgXDEsIFwyLi4uIGluIFB5dGhvbiBidXQgJDEsJDIuLi4gaW4gSmF2YXNjcmlwdAogICAgICAgICAgICByZXBsID0gcmVwbC5yZXBsYWNlKC9cXChcZCspL2csJyQkJDEnKQogICAgICAgIH1lbHNlIGlmKHR5cGVvZiByZXBsPT09ImZ1bmN0aW9uIil7CiAgICAgICAgICAgIC8vIHRoZSBhcmd1bWVudCBwYXNzZWQgdG8gdGhlIFB5dGhvbiBmdW5jdGlvbiBpcyB0aGUgbWF0Y2ggb2JqZWN0CiAgICAgICAgICAgIC8vIHRoZSBhcmd1bWVudHMgcGFzc2VkIHRvIHRoZSBKYXZhc2NyaXB0IGZ1bmN0aW9uIGFyZSA6CiAgICAgICAgICAgIC8vIC0gdGhlIG1hdGNoZWQgc3Vic3RyaW5nCiAgICAgICAgICAgIC8vIC0gdGhlIG1hdGNoZWQgZ3JvdXBzCiAgICAgICAgICAgIC8vIC0gdGhlIG9mZnNldCBvZiB0aGUgbWF0Y2hlZCBzdWJzdHJpbmcgaW5zaWRlIHRoZSBzdHJpbmcKICAgICAgICAgICAgLy8gLSB0aGUgc3RyaW5nIGJlaW5nIGV4YW1pbmVkCiAgICAgICAgICAgIHZhciAkcmVwbDEgPSBmdW5jdGlvbigpewogICAgICAgICAgICAgICAgdmFyIG1vID0gT2JqZWN0KCkKICAgICAgICAgICAgICAgIG1vLnN0cmluZyA9IGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoLTFdCiAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBhcmd1bWVudHNbYXJndW1lbnRzLmxlbmd0aC0yXQogICAgICAgICAgICAgICAgdmFyIGVuZCA9IHN0YXJ0ICsgYXJndW1lbnRzWzBdLmxlbmd0aAogICAgICAgICAgICAgICAgbW8uc3RhcnQgPSBmdW5jdGlvbigpe3JldHVybiBzdGFydH0KICAgICAgICAgICAgICAgIG1vLmVuZCA9IGZ1bmN0aW9uKCl7cmV0dXJuIGVuZH0KICAgICAgICAgICAgICAgIGdyb3VwcyA9IFtdCiAgICAgICAgICAgICAgICBmb3IodmFyIGk9MTtpPGFyZ3VtZW50cy5sZW5ndGgtMjtpKyspe2dyb3Vwcy5wdXNoKGFyZ3VtZW50c1tpXSl9CiAgICAgICAgICAgICAgICBtby5ncm91cHMgPSBmdW5jdGlvbihfZGVmYXVsdCl7CiAgICAgICAgICAgICAgICAgICAgaWYoX2RlZmF1bHQ9PT11bmRlZmluZWQpe19kZWZhdWx0PU5vbmV9CiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IFtdCiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxncm91cHMubGVuZ3RoO2krKyl7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGdyb3Vwc1tpXT09PXVuZGVmaW5lZCl7cmVzLnB1c2goX2RlZmF1bHQpfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNle3Jlcy5wdXNoKGdyb3Vwc1tpXSl9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiByZXBsKEpTT2JqZWN0KG1vKSkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZihjb3VudD09MCl7ZmxhZ3MrPSdnJ30KICAgICAgICB2YXIganNwID0gbmV3IFJlZ0V4cChwYXR0ZXJuLGZsYWdzKQogICAgICAgIGlmKHR5cGVvZiByZXBsPT09J2Z1bmN0aW9uJyl7cmV0dXJuIHN0cmluZy5yZXBsYWNlKGpzcCwkcmVwbDEpfQogICAgICAgIGVsc2V7cmV0dXJuIHN0cmluZy5yZXBsYWNlKGpzcCxyZXBsKX0KICAgIH0KICAgIG9iai5tYXRjaCA9IChmdW5jdGlvbihzZWFyY2hfZnVuYyl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIC8vIG1hdGNoIGlzIGxpa2Ugc2VhcmNoIGJ1dCBwYXR0ZXJuIG11c3Qgc3RhcnQgd2l0aCBeCiAgICAgICAgICAgIHBhdHRlcm4gPSBhcmd1bWVudHNbMF0KICAgICAgICAgICAgaWYocGF0dGVybi5jaGFyQXQoMCkhPT0nXicpe3BhdHRlcm4gPSAnXicrcGF0dGVybn0KICAgICAgICAgICAgdmFyIGFyZ3MgPSBbcGF0dGVybl0KICAgICAgICAgICAgZm9yKHZhciBpPTE7aTxhcmd1bWVudHMubGVuZ3RoO2krKyl7YXJncy5wdXNoKGFyZ3VtZW50c1tpXSl9CiAgICAgICAgICAgIHJldHVybiBzZWFyY2hfZnVuYy5hcHBseShudWxsLGFyZ3MpCiAgICAgICAgfQogICAgfSkob2JqLnNlYXJjaCkKCiAgICByZXR1cm4gb2JqCn0KKSgp',
'/libs/time.js':'JG1vZHVsZSA9ICB7CgogICAgX19nZXRhdHRyX18gOiBmdW5jdGlvbihhdHRyKXtyZXR1cm4gdGhpc1thdHRyXX0sCiAgICAKICAgIF9fbmFtZV9fIDogJ3RpbWUnLAoKICAgIGN0aW1lOiBmdW5jdGlvbih0aW1lc3RhbXApewogICAgICAgaWYgKHRpbWVzdGFtcCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICB0aW1lc3RhbXA9aW50KG5ldyBEYXRlKCkuZ2V0VGltZSgpLzEwMDApOwogICAgICAgfQogICAgICAgdmFyIGQ9bmV3IERhdGUoMCk7ICAKICAgICAgIGQuc2V0VVRDU2Vjb25kcyh0aW1lc3RhbXApOwogICAgICAgcmV0dXJuIGQudG9VVENTdHJpbmcoKTsKICAgIH0sCiAgICBnbXRpbWU6IGZ1bmN0aW9uKCl7CiAgICAgICB2YXIgZD1uZXcgRGF0ZSgpOwogICAgICAgcmV0dXJuIGxpc3QoW2QuZ2V0RnVsbFllYXIoKSwgZC5nZXRNb250aCgpKzEsIGQuZ2V0RGF0ZSgpLCBkLmdldEhvdXJzKCksCiAgICAgICAgICAgICAgICAgICAgZC5nZXRNaW51dGVzKCksIGQuZ2V0U2Vjb25kcygpLCBkLmdldERheSgpLCAwLCAwXSkKICAgIH0sCiAgICBwZXJmX2NvdW50ZXI6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBmbG9hdCgobmV3IERhdGUoKSkuZ2V0VGltZSgpLzEwMDAuMCk7CiAgICB9LAogICAgCiAgICBsb2NhbHRpbWUgOiBmdW5jdGlvbihzZWNzKXsgCiAgICAgICB2YXIgZD1uZXcgRGF0ZSgpOwogICAgICAgaWYgKHNlY3MgPT09IHVuZGVmaW5lZCB8fCBzZWNzID09PSBOb25lKSB7cmV0dXJuIGQuZ2V0VGltZSgpfQoKICAgICAgIC8vIGNhbGN1bGF0ZSBpZiB3ZSBhcmUgaW4gZGF5bGlnaHQgc2F2aW5ncyB0aW1lIG9yIG5vdC4KICAgICAgIC8vIGJvcnJvd2VkIGZyb20gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMTg4NzkzNC9jaGVjay1pZi1kYXlsaWdodC1zYXZpbmctdGltZS1pcy1pbi1lZmZlY3QtYW5kLWlmLWl0LWlzLWZvci1ob3ctbWFueS1ob3VycwogICAgICAgdmFyIGphbiA9IG5ldyBEYXRlKGQuZ2V0RnVsbFllYXIoKSwgMCwgMSk7CiAgICAgICB2YXIganVsID0gbmV3IERhdGUoZC5nZXRGdWxsWWVhcigpLCA2LCAxKTsKICAgICAgIHZhciBkc3Q9aW50KGQuZ2V0VGltZXpvbmVPZmZzZXQoKSA8IE1hdGgubWF4KGphbi5nZXRUaW1lem9uZU9mZnNldCgpLCBqdWwuZ2V0VGltZXpvbmVPZmZzZXQoKSkpOwoKICAgICAgIHJldHVybiBsaXN0KFtkLmdldEZ1bGxZZWFyKCksIGQuZ2V0TW9udGgoKSsxLCBkLmdldERhdGUoKSwgZC5nZXRIb3VycygpLAogICAgICAgICAgICAgICAgICAgIGQuZ2V0TWludXRlcygpLCBkLmdldFNlY29uZHMoKSwgZC5nZXREYXkoKSwgMCwgZHN0XSkKICAgICAgIC8vZml4bWUgIChzZWNvbmQgdG8gbGFzdCB2YWx1ZSBpcyAwIHdoaWNoIGlzIHRoZSBudW1iZXIgb2YgZGF5cyBpbiB0aGlzIHllYXIuLikKICAgIH0sCiAgICB0aW1lIDogZnVuY3Rpb24oKXtyZXR1cm4gZmxvYXQoKG5ldyBEYXRlKCkuZ2V0VGltZSgpKS8xMDAwKX0sCiAgICAKICAgIHN0cmZ0aW1lIDogZnVuY3Rpb24oZm9ybWF0LGFyZyl7CiAgICAgICAgZnVuY3Rpb24gbnMoYXJnLG5iKXsKICAgICAgICAgICAgLy8gbGVmdCBwYWRkaW5nIHdpdGggMAogICAgICAgICAgICB2YXIgcmVzID0gYXJnLnRvU3RyaW5nKCkKICAgICAgICAgICAgd2hpbGUocmVzLmxlbmd0aDxuYil7cmVzID0gJzAnK3Jlc30KICAgICAgICAgICAgcmV0dXJuIHJlcwogICAgICAgIH0KICAgICAgICBpZihhcmcpewogICAgICAgICAgICB2YXIgb2JqID0gbmV3IERhdGUoYXJnWzBdLGFyZ1sxXS0xLGFyZ1syXSxhcmdbM10sYXJnWzRdLGFyZ1s1XSxhcmdbNl0pCiAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIHZhciBvYmo9bmV3IERhdGUoKQogICAgICAgIH0KICAgICAgICB2YXIgYWJiX3dlZWtkYXlzID0gWydTdScsJ01vJywnVHUnLCdXZScsJ1RoJywnRnInLCdTYSddCiAgICAgICAgdmFyIGZ1bGxfd2Vla2RheXMgPSBbJ1N1bmRheScsJ01vbmRheScsJ1R1ZXNkYXknLCdXZWRuZXNkYXknLAogICAgICAgICAgICAnVGh1cnNkYXknLCdGcmlkYXknLCdTYXR1cmRheSddCiAgICAgICAgdmFyIGFiYl9tb250aHMgPSBbJ0phbicsJ0ZlYicsJ01hcicsJ0FwcicsJ01heScsJ0p1bicsCiAgICAgICAgICAgICdKdWwnLCdBdWcnLCdTZXAnLCdPY3QnLCdOb3YnLCdEZWMnXQogICAgICAgIHZhciBmdWxsX21vbnRocyA9IFsnSmFudWFyeScsJ0ZlYnJ1YXJ5JywnTWFyY2gnLCdBcHJpbCcsJ01heScsJ0p1bmUnLAogICAgICAgICAgICAnSnVseScsJ0F1Z3VzdCcsJ1NlcHRlbWJlcicsJ09jdG9iZXInLCdOb3ZlbWJlcicsJ0RlY2VtYmVyJ10KICAgICAgICB2YXIgcmVzID0gZm9ybWF0CiAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoLyVILyxucyhvYmouZ2V0SG91cnMoKSwyKSkKICAgICAgICByZXMgPSByZXMucmVwbGFjZSgvJU0vLG5zKG9iai5nZXRNaW51dGVzKCksMikpCiAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoLyVTLyxucyhvYmouZ2V0U2Vjb25kcygpLDIpKQogICAgICAgIHJlcyA9IHJlcy5yZXBsYWNlKC8lWS8sbnMob2JqLmdldEZ1bGxZZWFyKCksNCkpCiAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoLyV5LyxucyhvYmouZ2V0RnVsbFllYXIoKSw0KS5zdWJzdHIoMikpCiAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoLyVtLyxucyhvYmouZ2V0TW9udGgoKSsxLDIpKQogICAgICAgIHJlcyA9IHJlcy5yZXBsYWNlKC8lZC8sbnMob2JqLmdldERhdGUoKSwyKSkKICAgICAgICByZXMgPSByZXMucmVwbGFjZSgvJWEvLGFiYl93ZWVrZGF5c1tvYmouZ2V0RGF5KCldKQogICAgICAgIHJlcyA9IHJlcy5yZXBsYWNlKC8lQS8sZnVsbF93ZWVrZGF5c1tvYmouZ2V0RGF5KCldKQogICAgICAgIHJlcyA9IHJlcy5yZXBsYWNlKC8lYi8sYWJiX21vbnRoc1tvYmouZ2V0TW9udGgoKV0pCiAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoLyVCLyxmdWxsX21vbnRoc1tvYmouZ2V0TW9udGgoKV0pCiAgICAgICAgcmV0dXJuIHJlcwogICAgfSwKICAgIAogICAgc3RydWN0X3RpbWUgOiBmdW5jdGlvbihhcmcpewogICAgICAgIGlmKCFpc2luc3RhbmNlKGFyZyxbdHVwbGUsbGlzdF0pKXsKICAgICAgICAgICAgdGhyb3cgVHlwZUVycm9yKCdjb25zdHJ1Y3RvciByZXF1aXJlcyBhIHNlcXVlbmNlJykKICAgICAgICB9CiAgICAgICAgaWYobGVuKGFyZykhPTkpewogICAgICAgICAgICB0aHJvdyBUeXBlRXJyb3IoInRpbWUuc3RydWN0X3RpbWUoKSB0YWtlcyBhIDktc2VxdWVuY2UgKCIrbGVuKGFyZykrIi1zZXF1ZW5jZSBnaXZlbiIpCiAgICAgICAgfQogICAgICAgIHZhciByZXMgPSBhcmcKICAgICAgICB2YXIgbmFtZXMgPSBbJ3RtX3llYXInLCd0bV9tb24nLCd0bV9tZGF5JywndG1faG91cicsJ3RtX21pbicsJ3RtX3NlYycsJ3RtX3dkYXknLAogICAgICAgICAgICAndG1feWRheScsJ3RtX2lzZHN0JywndG1fem9uZScsJ3RtX2dtdG9mZiddCiAgICAgICAgcmVzLl9fZ2V0YXR0cl9fID0gZnVuY3Rpb24oYXR0cil7CiAgICAgICAgICAgIHZhciBpeCA9IG5hbWVzLmluZGV4T2YoYXR0cikKICAgICAgICAgICAgaWYoaXg+LTEpe3JldHVybiBhcmcuX19nZXRpdGVtX18oaXgpfQogICAgICAgICAgICBpZih0eXBlb2YgcmVzW2F0dHJdPT09J2Z1bmN0aW9uJyl7CiAgICAgICAgICAgICAgICByZXR1cm4gKGZ1bmN0aW9uKG9iail7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG9ialthdHRyXS5hcHBseShvYmosYXJndW1lbnRzKX0KICAgICAgICAgICAgICAgIH0pKHJlcykKICAgICAgICAgICAgfWVsc2UgaWYocmVzW2F0dHJdIT09dW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgIHJldHVybiByZXNbYXR0cl0KICAgICAgICAgICAgfWVsc2V7dGhyb3cgQXR0cmlidXRlRXJyb3IoIm9iamVjdCBoYXMgbm8gYXR0cmlidXRlICciK2F0dHIrIiciKX0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlcwogICAgfQp9Cg==',
'/libs/_ajax.js':'Ly8gYWpheAokbW9kdWxlID0gKGZ1bmN0aW9uKCl7CgokWE1MSHR0cERpY3QgPSB7CiAgICBfX2NsYXNzX186JHR5cGUsCiAgICBfX25hbWVfXzonWE1MSHR0cCcKfQoKJFhNTEh0dHBEaWN0Ll9fZ2V0YXR0cmlidXRlX18gPSBmdW5jdGlvbihzZWxmLGF0dHIpewogICAgaWYoWydoZWFkZXJzJywndGV4dCcsJ3htbCddLmluZGV4T2YoYXR0cik+LTEpewogICAgICAgIHJldHVybiAkWE1MSHR0cERpY3RbYXR0cl0oc2VsZikKICAgIH0KICAgIHJldHVybiAkT2JqZWN0RGljdC5fX2dldGF0dHJpYnV0ZV9fKHNlbGYsYXR0cikKfQoKJFhNTEh0dHBEaWN0Ll9fbXJvX18gPSBbJFhNTEh0dHBEaWN0LCRPYmplY3REaWN0XQoKJFhNTEh0dHBEaWN0Ll9fcmVwcl9fID0gZnVuY3Rpb24oc2VsZil7cmV0dXJuICc8b2JqZWN0IFhNTEh0dHA+J30KCiRYTUxIdHRwRGljdC5fX3N0cl9fID0gJFhNTEh0dHBEaWN0LnRvU3RyaW5nID0gJFhNTEh0dHBEaWN0Ll9fcmVwcl9fCgokWE1MSHR0cERpY3QudGV4dCA9IGZ1bmN0aW9uKHNlbGYpe3JldHVybiBzZWxmLnJlc3BvbnNlVGV4dH0KICAgIAokWE1MSHR0cERpY3QueG1sID0gZnVuY3Rpb24oc2VsZil7cmV0dXJuICREb21PYmplY3Qoc2VsZi5yZXNwb25zZVhNTCl9CiAgICAKJFhNTEh0dHBEaWN0LmhlYWRlcnMgPSBmdW5jdGlvbihzZWxmKXsKICAgIHJldHVybiBsaXN0KHNlbGYuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkuc3BsaXQoJ1xuJykpCn0KCiRYTUxIdHRwRGljdC5nZXRfaGVhZGVyID0gZnVuY3Rpb24oKXsKICAgIHZhciByZXFvYmogPSBzZWxmOwogICAgcmV0dXJuIGZ1bmN0aW9uKGhlYWRlcil7IHJldHVybiByZXFvYmouZ2V0UmVzcG9uc2VIZWFkZXIoaGVhZGVyKSB9Cn0KCiRBamF4RGljdCA9IHsKICAgIF9fY2xhc3NfXzokdHlwZSwKICAgIF9fbmFtZV9fOidhamF4Jwp9CgokQWpheERpY3QuX19tcm9fXyA9IFskQWpheERpY3QsJE9iamVjdERpY3RdCgokQWpheERpY3QuX19yZXByX18gPSBmdW5jdGlvbihzZWxmKXsKICAgIHJldHVybiAnPG9iamVjdCBBamF4PicKfQoKJEFqYXhEaWN0Ll9fc3RyX18gPSAkQWpheERpY3QudG9TdHJpbmcgPSAkQWpheERpY3QuX19yZXByX18KCiRBamF4RGljdC5iaW5kID0gZnVuY3Rpb24oc2VsZixldnQsZnVuYyl7CiAgICAvLyByZXEuYmluZChldnQsZnVuYykgaXMgdGhlIHNhbWUgYXMgcmVxLm9uX2V2dCA9IGZ1bmMKICAgIHNlbGZbJ29uXycrZXZ0XT1mdW5jCn0KCiRBamF4RGljdC5vcGVuID0gZnVuY3Rpb24oc2VsZixtZXRob2QsdXJsLGFzeW5jKXsKICAgIHNlbGYuJHhtbGh0dHAub3BlbihtZXRob2QsdXJsLGFzeW5jKQp9CgokQWpheERpY3Quc2VuZCA9IGZ1bmN0aW9uKHNlbGYscGFyYW1zKXsKICAgIC8vIHBhcmFtcyBpcyBhIFB5dGhvbiBkaWN0aW9uYXJ5CiAgICB2YXIgcmVzID0gJycKICAgIGlmKCFwYXJhbXMgfHwgcGFyYW1zLiRrZXlzLmxlbmd0aD09MCl7c2VsZi4keG1saHR0cC5zZW5kKCk7cmV0dXJufQogICAgZWxzZSBpZihpc2luc3RhbmNlKHBhcmFtcyxzdHIpKXsKICAgICAgICByZXMgPSBwYXJhbXMKICAgIH1lbHNlIGlmKGlzaW5zdGFuY2UocGFyYW1zLGRpY3QpKXsKICAgICAgICBmb3IoaT0wO2k8cGFyYW1zLiRrZXlzLmxlbmd0aDtpKyspewogICAgICAgICAgICByZXMgKz1lbmNvZGVVUklDb21wb25lbnQoc3RyKHBhcmFtcy4ka2V5c1tpXSkpKyc9JytlbmNvZGVVUklDb21wb25lbnQoc3RyKHBhcmFtcy4kdmFsdWVzW2ldKSkrJyYnCiAgICAgICAgfQogICAgICAgIHJlcyA9IHJlcy5zdWJzdHIoMCxyZXMubGVuZ3RoLTEpCiAgICB9ZWxzZXsKICAgICAgICB0aHJvdyBUeXBlRXJyb3IoInNlbmQoKSBhcmd1bWVudCBtdXN0IGJlIHN0cmluZyBvciBkaWN0b25hcnksIG5vdCAnIitzdHIocGFyYW1zLl9fY2xhc3NfXykrIiciKQogICAgfQogICAgc2VsZi4keG1saHR0cC5zZW5kKHJlcykKfQoKJEFqYXhEaWN0LnNldF9oZWFkZXIgPSBmdW5jdGlvbihzZWxmLGtleSx2YWx1ZSl7CiAgICBzZWxmLiR4bWxodHRwLnNldFJlcXVlc3RIZWFkZXIoa2V5LHZhbHVlKQp9CgokQWpheERpY3Quc2V0X3RpbWVvdXQgPSBmdW5jdGlvbihzZWxmLHNlY29uZHMsZnVuYyl7CiAgICBzZWxmLiR4bWxodHRwLiRyZXF1ZXN0VGltZXIgPSBzZXRUaW1lb3V0KAogICAgICAgIGZ1bmN0aW9uKCkge3NlbGYuJHhtbGh0dHAuYWJvcnQoKTtmdW5jKCl9LCAKICAgICAgICBzZWNvbmRzKjEwMDApOyAKfQoKZnVuY3Rpb24gYWpheCgpewoKICAgIHZhciByZXMgPSB7CiAgICAgICAgX19jbGFzc19fOiRBamF4RGljdAogICAgfQoKICAgIGlmICh3aW5kb3cuWE1MSHR0cFJlcXVlc3Qpey8vIGNvZGUgZm9yIElFNyssIEZpcmVmb3gsIENocm9tZSwgT3BlcmEsIFNhZmFyaQogICAgICAgIHZhciAkeG1saHR0cD1uZXcgWE1MSHR0cFJlcXVlc3QoKTsKICAgIH1lbHNley8vIGNvZGUgZm9yIElFNiwgSUU1CiAgICAgICAgdmFyICR4bWxodHRwPW5ldyBBY3RpdmVYT2JqZWN0KCJNaWNyb3NvZnQuWE1MSFRUUCIpOwogICAgfQogICAgJHhtbGh0dHAuJHJlcXVlc3RUaW1lciA9IG51bGwKICAgICR4bWxodHRwLl9fY2xhc3NfXyA9ICRYTUxIdHRwRGljdAogICAgCiAgICAkeG1saHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpewogICAgICAgIC8vIGhlcmUsICJ0aGlzIiByZWZlcnMgdG8gJHhtbGh0dHAKICAgICAgICB2YXIgc3RhdGUgPSB0aGlzLnJlYWR5U3RhdGUKICAgICAgICB2YXIgcmVxID0gdGhpcy4kYWpheAogICAgICAgIHZhciB0aW1lciA9IHRoaXMuJHJlcXVlc3RUaW1lcgogICAgICAgIHZhciBvYmogPSB0aGlzCiAgICAgICAgaWYoc3RhdGU9PT0wICYmICdvbl91bmluaXRpYWxpemVkJyBpbiByZXEpe3JlcS5vbl91bmluaXRpYWxpemVkKG9iail9CiAgICAgICAgZWxzZSBpZihzdGF0ZT09PTEgJiYgJ29uX2xvYWRpbmcnIGluIHJlcSl7cmVxLm9uX2xvYWRpbmcob2JqKX0KICAgICAgICBlbHNlIGlmKHN0YXRlPT09MiAmJiAnb25fbG9hZGVkJyBpbiByZXEpe3JlcS5vbl9sb2FkZWQob2JqKX0KICAgICAgICBlbHNlIGlmKHN0YXRlPT09MyAmJiAnb25faW50ZXJhY3RpdmUnIGluIHJlcSl7cmVxLm9uX2ludGVyYWN0aXZlKG9iail9CiAgICAgICAgZWxzZSBpZihzdGF0ZT09PTQgJiYgJ29uX2NvbXBsZXRlJyBpbiByZXEpewogICAgICAgICAgICBpZih0aW1lciAhPT0gbnVsbCl7d2luZG93LmNsZWFyVGltZW91dCh0aW1lcil9CiAgICAgICAgICAgIHJlcS5vbl9jb21wbGV0ZShvYmopCiAgICAgICAgfQogICAgfQogICAgJHhtbGh0dHAuJGFqYXggPSByZXMKICAgIHJlcy4keG1saHR0cCA9ICR4bWxodHRwCiAgICByZXR1cm4gcmVzCn0KCmFqYXguX19jbGFzc19fID0gJGZhY3RvcnkKYWpheC4kZGljdCA9ICRBamF4RGljdAoKcmV0dXJuIHthamF4OmFqYXh9Cgp9KSgp',
'/libs/_browser.js':'JG1vZHVsZSA9IHsKICAgIF9fZ2V0YXR0cl9fIDogZnVuY3Rpb24oYXR0cil7cmV0dXJuIHRoaXNbYXR0cl19LAogICAgYWxlcnQ6IGFsZXJ0LAogICAgY29uZmlybTogZnVuY3Rpb24obWVzc2FnZSl7cmV0dXJuIEpTT2JqZWN0KHdpbmRvdy5jb25maXJtKG1lc3NhZ2UpKX0sCiAgICBkb2M6ICRET01Ob2RlKGRvY3VtZW50KSwgICAvL3dhbnQgdG8gdXNlIGRvY3VtZW50IGluc3RlYWQgb2YgZG9jCiAgICBtb3VzZUNvb3JkczogZnVuY3Rpb24oZXYpe3JldHVybiBKU09iamVjdCgkbW91c2VDb29yZHMoZXYpKX0sCiAgICBwcm9tcHQ6IGZ1bmN0aW9uKG1lc3NhZ2UsIGRlZmF1bHRfdmFsdWUpe3JldHVybiBKU09iamVjdCh3aW5kb3cucHJvbXB0KG1lc3NhZ2UsIGRlZmF1bHRfdmFsdWV8fCcnKSl9LAogICAgd2luOiBKU09iamVjdCh3aW5kb3cpICAgICAvL3dhbnQgdG8gdXNlIHdpbmRvdyBpbnN0ZWFkIG9mIHdpbgp9CiRtb2R1bGUuX19jbGFzc19fID0gJG1vZHVsZSAvLyBkZWZpbmVkIGluICRweV91dGlscwokbW9kdWxlLl9fc3RyX18gPSBmdW5jdGlvbigpe3JldHVybiAiPG1vZHVsZSAnYnJvd3Nlcic+In0K',
'/libs/_html.js':'Ly8gY3JlYXRpb24gb2YgYW4gSFRNTCBlbGVtZW50CiRtb2R1bGUgPSAoZnVuY3Rpb24oKXsKZnVuY3Rpb24gJFRhZyh0YWdOYW1lLGFyZ3MpewogICAgdmFyIG9iaiA9ICRET01Ob2RlKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnTmFtZSkpCiAgICAvLyBvYmouZWx0IGlzIHRoZSBET00gZWxlbWVudAogICAgb2JqLnBhcmVudCA9IHRoaXMKICAgIGlmKGFyZ3MhPXVuZGVmaW5lZCAmJiBhcmdzLmxlbmd0aD4wKXsKICAgICAgICAkc3RhcnQgPSAwCiAgICAgICAgJGZpcnN0ID0gYXJnc1swXQogICAgICAgIC8vIGlmIGZpcnN0IGFyZ3VtZW50IGlzIG5vdCBhIGtleXdvcmQsIGl0J3MgdGhlIHRhZyBjb250ZW50CiAgICAgICAgaWYoJGZpcnN0Ll9fY2xhc3NfXyE9PSRLdyl7CiAgICAgICAgICAgICRzdGFydCA9IDEKICAgICAgICAgICAgaWYoaXNpbnN0YW5jZSgkZmlyc3QsW3N0cixpbnQsZmxvYXRdKSl7CiAgICAgICAgICAgICAgICB0eHQgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShzdHIoJGZpcnN0KSkKICAgICAgICAgICAgICAgIG9iai5lbHQuYXBwZW5kQ2hpbGQodHh0KQogICAgICAgICAgICB9IGVsc2UgaWYoJGZpcnN0Ll9fY2xhc3NfXz09PSRUYWdTdW1EaWN0KXsKICAgICAgICAgICAgICAgIGZvcigkaT0wOyRpPCRmaXJzdC5jaGlsZHJlbi5sZW5ndGg7JGkrKyl7CiAgICAgICAgICAgICAgICAgICAgb2JqLmVsdC5hcHBlbmRDaGlsZCgkZmlyc3QuY2hpbGRyZW5bJGldLmVsdCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsgLy8gYXJndW1lbnQgaXMgYW5vdGhlciBET01Ob2RlIGluc3RhbmNlCiAgICAgICAgICAgICAgICB0cnl7b2JqLmVsdC5hcHBlbmRDaGlsZCgkZmlyc3QuZWx0KX0KICAgICAgICAgICAgICAgIGNhdGNoKGVycil7Y29uc29sZS5sb2coJ2VycmV1ciAnK2Vycik7dGhyb3cgVmFsdWVFcnJvcignd3JvbmcgZWxlbWVudCAnKyRmaXJzdCl9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy8gYXR0cmlidXRlcwogICAgICAgIGZvcih2YXIgJGk9JHN0YXJ0OyRpPGFyZ3MubGVuZ3RoOyRpKyspewogICAgICAgICAgICAvLyBrZXl3b3JkIGFyZ3VtZW50cwogICAgICAgICAgICAkYXJnID0gYXJnc1skaV0KICAgICAgICAgICAgaWYoJGFyZyAmJiAkYXJnLl9fY2xhc3NfXz09PSRLdyl7CiAgICAgICAgICAgICAgICBpZigkYXJnLm5hbWUudG9Mb3dlckNhc2UoKS5zdWJzdHIoMCwyKT09PSJvbiIpeyAvLyBldmVudHMKICAgICAgICAgICAgICAgICAgICBldmFsKCdET01Ob2RlLmJpbmQob2JqLCInKyRhcmcubmFtZS50b0xvd2VyQ2FzZSgpLnN1YnN0cigyKSsnIixmdW5jdGlvbigpeycrJGFyZy52YWx1ZSsnfSknKQogICAgICAgICAgICAgICAgfWVsc2UgaWYoJGFyZy5uYW1lLnRvTG93ZXJDYXNlKCk9PSJzdHlsZSIpewogICAgICAgICAgICAgICAgICAgIERPTU5vZGUuc2V0X3N0eWxlKG9iaiwkYXJnLnZhbHVlKQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZigkYXJnLnZhbHVlIT09ZmFsc2UpewogICAgICAgICAgICAgICAgICAgICAgICAvLyBvcHRpb24uc2VsZWN0ZWQ9ZmFsc2Ugc2V0cyBpdCB0byB0cnVlIDotKQogICAgICAgICAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJnID0gJGFyZy5uYW1lLnRvTG93ZXJDYXNlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai5lbHQuc2V0QXR0cmlidXRlKGFyZywkYXJnLnZhbHVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYXJnPT0iY2xhc3MiKXsgLy8gZm9yIElFCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLmVsdC5zZXRBdHRyaWJ1dGUoImNsYXNzTmFtZSIsJGFyZy52YWx1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfWNhdGNoKGVycil7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyZXVyICcrZXJyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgVmFsdWVFcnJvcigiY2FuJ3Qgc2V0IGF0dHJpYnV0ZSAiKyRhcmcubmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIHJldHVybiBvYmoKfQoKLy8gdGhlIGNsYXNzZXMgdXNlZCBmb3IgdGFnIHN1bXMsICRUYWdTVW0gYW5kICRUYWdTdW1DbGFzcyAKLy8gYXJlIGRlZmluZWQgaW4gcHlfZG9tLmpzCgpmdW5jdGlvbiBBKCl7CiAgICB2YXIgb2JqID0gJFRhZygnQScsYXJndW1lbnRzKQogICAgcmV0dXJuIG9iagp9CkEuX19uYW1lX189J2h0bWwuQScKCnZhciAkc3JjID0gQSsnJyAvLyBzb3VyY2Ugb2YgZnVuY3Rpb24gQQovLyBIVE1MNCB0YWdzCiR0YWdzID0gWydBJywgJ0FCQlInLCAnQUNST05ZTScsICdBRERSRVNTJywgJ0FQUExFVCcsCiAgICAgICAgICAgICdCJywgJ0JETycsICdCSUcnLCAnQkxPQ0tRVU9URScsICdCVVRUT04nLAogICAgICAgICAgICAnQ0FQVElPTicsICdDRU5URVInLCAnQ0lURScsICdDT0RFJywKICAgICAgICAgICAgJ0RFTCcsICdERk4nLCAnRElSJywgJ0RJVicsICdETCcsCiAgICAgICAgICAgICdFTScsICdGSUVMRFNFVCcsICdGT05UJywgJ0ZPUk0nLCAnRlJBTUVTRVQnLAogICAgICAgICAgICAnSDEnLCAnSDInLCAnSDMnLCAnSDQnLCAnSDUnLCAnSDYnLAogICAgICAgICAgICAnSScsICdJRlJBTUUnLCAnSU5TJywgJ0tCRCcsICdMQUJFTCcsICdMRUdFTkQnLAogICAgICAgICAgICAnTUFQJywgJ01FTlUnLCAnTk9GUkFNRVMnLCAnTk9TQ1JJUFQnLCAnT0JKRUNUJywKICAgICAgICAgICAgJ09MJywgJ09QVEdST1VQJywgJ1BSRScsICdRJywgJ1MnLCAnU0FNUCcsCiAgICAgICAgICAgICdTQ1JJUFQnLCAnU0VMRUNUJywgJ1NNQUxMJywgJ1NQQU4nLCAnU1RSSUtFJywKICAgICAgICAgICAgJ1NUUk9ORycsICdTVFlMRScsICdTVUInLCAnU1VQJywgJ1RBQkxFJywKICAgICAgICAgICAgJ1RFWFRBUkVBJywgJ1RJVExFJywgJ1RUJywgJ1UnLCAnVUwnLAogICAgICAgICAgICAnVkFSJywgJ0JPRFknLCAnQ09MR1JPVVAnLCAnREQnLCAnRFQnLCAnSEVBRCcsCiAgICAgICAgICAgICdIVE1MJywgJ0xJJywgJ1AnLCAnVEJPRFknLCdPUFRJT04nLCAKICAgICAgICAgICAgJ1REJywgJ1RGT09UJywgJ1RIJywgJ1RIRUFEJywgJ1RSJywKICAgICAgICAgICAgJ0FSRUEnLCAnQkFTRScsICdCQVNFRk9OVCcsICdCUicsICdDT0wnLCAnRlJBTUUnLAogICAgICAgICAgICAnSFInLCAnSU1HJywgJ0lOUFVUJywgJ0lTSU5ERVgnLCAnTElOSycsCiAgICAgICAgICAgICdNRVRBJywgJ1BBUkFNJ10KCi8vIEhUTUw1IHRhZ3MKJHRhZ3MgPSAkdGFncy5jb25jYXQoWydBUlRJQ0xFJywnQVNJREUnLCdBVURJTycsJ0JESScsCiAgICAnQ0FOVkFTJywnQ09NTUFORCcsJ0RBVEFMSVNUJywnREVUQUlMUycsJ0RJQUxPRycsCiAgICAnRU1CRUQnLCdGSUdDQVBUSU9OJywnRklHVVJFJywnRk9PVEVSJywnSEVBREVSJywKICAgICdLRVlHRU4nLCdNQVJLJywnTUVURVInLCdOQVYnLCdPVVRQVVQnLAogICAgJ1BST0dSRVNTJywnUlAnLCdSVCcsJ1JVQlknLCdTRUNUSU9OJywnU09VUkNFJywKICAgICdTVU1NQVJZJywnVElNRScsJ1RSQUNLJywnVklERU8nLCdXQlInXSkKCi8vIGNyZWF0ZSBjbGFzc2VzCnZhciBvYmogPSBuZXcgT2JqZWN0KCkKZm9yKCRpPTA7JGk8JHRhZ3MubGVuZ3RoOyRpKyspewogICAgJGNvZGUgPSAkc3JjLnJlcGxhY2UoL0EvZ20sJHRhZ3NbJGldKQogICAgZXZhbCgib2JqLiIrJHRhZ3NbJGldKyI9IiskY29kZSkKICAgIGV2YWwoIm9iai4iKyR0YWdzWyRpXSsnLl9fbmFtZV9fPSJodG1sLicrJHRhZ3NbJGldKyciJykKfQpvYmouX19nZXRhdHRyX18gPSBmdW5jdGlvbihhdHRyKXtyZXR1cm4gdGhpc1thdHRyXX0KcmV0dXJuIG9iagp9KSgpCg==',
'/libs/_io.js':'Ly8gcmVxdWlyZWQgdG8gYXBwZWFyIGluIHN5cy5idWlsdGluX21vZHVsZV9uYW1lcwokbW9kdWxlPXt9',
'/libs/_os.js':'JG1vZHVsZSA9IHsKICAgIF9fZ2V0YXR0cl9fIDogZnVuY3Rpb24oYXR0cil7cmV0dXJuIHRoaXNbYXR0cl19LAogICAgcmFuZG9tOmZ1bmN0aW9uKCl7cmV0dXJuIGZsb2F0KE1hdGgucmFuZG9tKCkpfSwKICAgIHJhbmRpbnQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gaW50KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSooYi1hKSthKSl9Cn0KJG1vZHVsZS5fX2NsYXNzX18gPSAkbW9kdWxlIC8vIGRlZmluZWQgaW4gJHB5X3V0aWxzCiRtb2R1bGUuX19zdHJfXyA9IGZ1bmN0aW9uKCl7cmV0dXJuICI8bW9kdWxlICdfb3MnPiJ9Cg==',
'/libs/_svg.js':'JG1vZHVsZSA9IChmdW5jdGlvbigpewoKJHN2Z05TID0gImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgokeGxpbmtOUyA9ICJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIgoKZnVuY3Rpb24gJFNWR1RhZyh0YWdfbmFtZSxhcmdzKXsKICAgIC8vIHJlcHJlc2VudHMgYW4gU1ZHIHRhZwogICAgdmFyICRpID0gbnVsbAogICAgdmFyICRvYmogPSB0aGlzCiAgICB2YXIgb2JqID0gJERPTU5vZGUoZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCRzdmdOUyx0YWdfbmFtZSkpCiAgICBpZihhcmdzIT11bmRlZmluZWQgJiYgYXJncy5sZW5ndGg+MCl7CiAgICAgICAgJHN0YXJ0ID0gMAogICAgICAgICRmaXJzdCA9IGFyZ3NbMF0KICAgICAgICAvLyBpZiBmaXJzdCBhcmd1bWVudCBpcyBub3QgYSBrZXl3b3JkLCBpdCdzIHRoZSB0YWcgY29udGVudAogICAgICAgIGlmKCRmaXJzdC5fX2NsYXNzX18hPT0kS3cpewogICAgICAgICAgICAkc3RhcnQgPSAxCiAgICAgICAgICAgIGlmKGlzaW5zdGFuY2UoJGZpcnN0LFtzdHIsaW50LGZsb2F0XSkpewogICAgICAgICAgICAgICAgdHh0ID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoc3RyKCRmaXJzdCkpCiAgICAgICAgICAgICAgICBvYmouZWx0LmFwcGVuZENoaWxkKHR4dCkKICAgICAgICAgICAgfSBlbHNlIGlmKCRmaXJzdC5fX2NsYXNzX189PT0kVGFnU3VtRGljdCl7CiAgICAgICAgICAgICAgICBmb3IoJGk9MDskaTwkZmlyc3QuY2hpbGRyZW4ubGVuZ3RoOyRpKyspewogICAgICAgICAgICAgICAgICAgIG9iai5lbHQuYXBwZW5kQ2hpbGQoJGZpcnN0LmNoaWxkcmVuWyRpXSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRyeXtvYmouZWx0LmFwcGVuZENoaWxkKCRmaXJzdC5lbHQpfQogICAgICAgICAgICAgICAgY2F0Y2goZXJyKXskcmFpc2UoJ1ZhbHVlRXJyb3InLCd3cm9uZyBlbGVtZW50ICcrJGZpcnN0KX0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvLyBhdHRyaWJ1dGVzCiAgICAgICAgZm9yKCRpPSRzdGFydDskaTxhcmdzLmxlbmd0aDskaSsrKXsKICAgICAgICAgICAgLy8ga2V5d29yZCBhcmd1bWVudHMKICAgICAgICAgICAgJGFyZyA9IGFyZ3NbJGldCiAgICAgICAgICAgIGlmKCRhcmcgJiYgJGFyZy5fX2NsYXNzX189PT0kS3cpewogICAgICAgICAgICAgICAgaWYoJGFyZy5uYW1lLnRvTG93ZXJDYXNlKCkuc3Vic3RyKDAsMik9PSJvbiIpeyAvLyBldmVudHMKICAgICAgICAgICAgICAgICAgICBldmFsKCdET01Ob2RlLmJpbmQob2JqLCInKyRhcmcubmFtZS50b0xvd2VyQ2FzZSgpLnN1YnN0cigyKSsnIixmdW5jdGlvbigpeycrJGFyZy52YWx1ZSsnfSknKQogICAgICAgICAgICAgICAgfWVsc2UgaWYoJGFyZy5uYW1lLnRvTG93ZXJDYXNlKCk9PSJzdHlsZSIpewogICAgICAgICAgICAgICAgICAgIERPTU5vZGUuc2V0X3N0eWxlKG9iaiwkYXJnLnZhbHVlKQogICAgICAgICAgICAgICAgfWVsc2UgaWYoJGFyZy5uYW1lLnRvTG93ZXJDYXNlKCkuaW5kZXhPZigiaHJlZiIpICE9PSAtMSl7IC8vIHhsaW5rOmhyZWYKICAgICAgICAgICAgICAgICAgICBvYmouZWx0LnNldEF0dHJpYnV0ZU5TKCAiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIsImhyZWYiLCRhcmcudmFsdWUpCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmKCRhcmcudmFsdWUhPT1mYWxzZSl7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9wdGlvbi5zZWxlY3RlZD1mYWxzZSBzZXRzIGl0IHRvIHRydWUgOi0pCiAgICAgICAgICAgICAgICAgICAgICAgIG9iai5lbHQuc2V0QXR0cmlidXRlTlMobnVsbCwkYXJnLm5hbWUucmVwbGFjZSgnXycsJy0nKSwkYXJnLnZhbHVlKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIHJldHVybiBvYmoKfQoKLy8gU1ZHCnZhciAkc3ZnX3RhZ3MgPSBbJ2EnLAonYWx0R2x5cGgnLAonYWx0R2x5cGhEZWYnLAonYWx0R2x5cGhJdGVtJywKJ2FuaW1hdGUnLAonYW5pbWF0ZUNvbG9yJywKJ2FuaW1hdGVNb3Rpb24nLAonYW5pbWF0ZVRyYW5zZm9ybScsCidjaXJjbGUnLAonY2xpcFBhdGgnLAonY29sb3JfcHJvZmlsZScsIC8vIGluc3RlYWQgb2YgY29sb3ItcHJvZmlsZQonY3Vyc29yJywKJ2RlZnMnLAonZGVzYycsCidlbGxpcHNlJywKJ2ZlQmxlbmQnLAonZycsCidpbWFnZScsCidsaW5lJywKJ2xpbmVhckdyYWRpZW50JywKJ21hcmtlcicsCidtYXNrJywKJ3BhdGgnLAoncGF0dGVybicsCidwb2x5Z29uJywKJ3BvbHlsaW5lJywKJ3JhZGlhbEdyYWRpZW50JywKJ3JlY3QnLAonc3RvcCcsCidzdmcnLAondGV4dCcsCid0cmVmJywKJ3RzcGFuJywKJ3VzZSddCgokc3ZnID0gZnVuY3Rpb24oKXtyZXR1cm4gJFNWR1RhZygnWCcsYXJndW1lbnRzKX0KJHN2ZyArPSAnJyAvLyBzb3VyY2UgY29kZQoKdmFyIG9iaiA9IG5ldyBPYmplY3QoKQpmb3IodmFyIGk9MDtpPCRzdmdfdGFncy5sZW5ndGg7aSsrKXsKICAgIHZhciB0YWcgPSAkc3ZnX3RhZ3NbaV0KICAgIGV2YWwoJ29iai4nK3RhZysnPScrJHN2Zy5yZXBsYWNlKCdYJyx0YWcpKQp9Cm9iai5fX2dldGF0dHJfXyA9IGZ1bmN0aW9uKGF0dHIpe3JldHVybiB0aGlzW2F0dHJdfQpyZXR1cm4gb2JqCn0pKCk=',
'/libs/_sys.js':'JG1vZHVsZSA9IHsKICAgIG1vZHVsZXMgOiB7J19fZ2V0X18nOmZ1bmN0aW9uKCl7cmV0dXJuIGRpY3QoSlNPYmplY3QoX19CUllUSE9OX18uaW1wb3J0ZWQpKX0sCiAgICAgICAgJ19fc2V0X18nOjAgLy8gZGF0YSBkZXNjcmlwdG9yLCB0byBmb3JjZSB1c2Ugb2YgX19nZXRfXwogICAgfQp9',
'/libs/_timer.js':'JG1vZHVsZSA9ICB7CgogICAgX19uYW1lX18gOiAndGltZXInLAoKICAgIGNsZWFyX2ludGVydmFsIDogZnVuY3Rpb24oaW50X2lkKXt3aW5kb3cuY2xlYXJJbnRlcnZhbChpbnRfaWQpfSwKICAgIAogICAgY2xlYXJfdGltZW91dCA6IGZ1bmN0aW9uKHRpbWVvdXRfaWQpe3dpbmRvdy5jbGVhclRpbWVvdXQodGltZW91dF9pZCl9LAoKICAgIHNldF9pbnRlcnZhbCA6IGZ1bmN0aW9uKGZ1bmMsaW50ZXJ2YWwpewogICAgICAgIHJldHVybiBpbnQod2luZG93LnNldEludGVydmFsKGZ1bmMsaW50ZXJ2YWwpKQogICAgfSwKCiAgICBzZXRfdGltZW91dCA6IGZ1bmN0aW9uKGZ1bmMsaW50ZXJ2YWwpe3dpbmRvdy5zZXRUaW1lb3V0KGZ1bmMsaW50ZXJ2YWwpfSwKICAgIAogICAgcmVxdWVzdF9hbmltYXRpb25fZnJhbWU6IGZ1bmN0aW9uKGZ1bmMpewogICAgICAgIHJldHVybiBpbnQod2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jKSl9LAogICAgCiAgICBjYW5jZWxfYW5pbWF0aW9uX2ZyYW1lOiBmdW5jdGlvbihpbnRfaWQpe3dpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZShpbnRfaWQpfSwKCn0K',
'/libs/_websocket.js':'Ly8gd2Vic29ja2V0CiRtb2R1bGUgPSAoZnVuY3Rpb24oKXsKCiRXZWJTb2NrZXREaWN0ID0gewogICAgX19jbGFzc19fIDogJHR5cGUsCiAgICBfX25hbWVfXzonV2ViU29ja2V0Jwp9CgokV2ViU29ja2V0RGljdC5iaW5kID0gZnVuY3Rpb24oc2VsZixldmVudCxjYWxsYmFjayl7CiAgICBzZWxmLiR3c1snb24nK2V2ZW50XSA9IGNhbGxiYWNrCn0KCiRXZWJTb2NrZXREaWN0LnNlbmQgPSBmdW5jdGlvbihzZWxmLGRhdGEpewogICAgc2VsZi4kd3Muc2VuZChkYXRhKQp9CiAgICAKJFdlYlNvY2tldERpY3QuY2xvc2UgPSBmdW5jdGlvbihzZWxmKXsKICAgIHNlbGYuJHdzLmNsb3NlKCkKfQoKJFdlYlNvY2tldERpY3QuX19tcm9fXyA9IFskV2ViU29ja2V0RGljdCwkT2JqZWN0RGljdF0KCmZ1bmN0aW9uIHdlYnNvY2tldChob3N0KXsKICAgIHZhciAkc29ja2V0ID0gbmV3IFdlYlNvY2tldChob3N0KTsKICAgIHZhciByZXMgPSB7CiAgICAgICAgX19jbGFzc19fOiRXZWJTb2NrZXREaWN0LAogICAgICAgICR3cyA6ICRzb2NrZXQKICAgIH0KICAgIHJlcy4kd2Vic29ja2V0ID0gJHNvY2tldAogICAgcmV0dXJuIHJlcwp9CndlYnNvY2tldC5fX2NsYXNzX18gPSAkZmFjdG9yeQp3ZWJzb2NrZXQuJGRpY3QgPSAkV2ViU29ja2V0RGljdAoKcmV0dXJuIHt3ZWJzb2NrZXQ6d2Vic29ja2V0fQoKfSkoKQ==',
'/libs/crypto_js/rollups/md5.js':'LyoKQ3J5cHRvSlMgdjMuMS4yCmNvZGUuZ29vZ2xlLmNvbS9wL2NyeXB0by1qcwooYykgMjAwOS0yMDEzIGJ5IEplZmYgTW90dC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KY29kZS5nb29nbGUuY29tL3AvY3J5cHRvLWpzL3dpa2kvTGljZW5zZQoqLwp2YXIgQ3J5cHRvSlM9Q3J5cHRvSlN8fGZ1bmN0aW9uKHMscCl7dmFyIG09e30sbD1tLmxpYj17fSxuPWZ1bmN0aW9uKCl7fSxyPWwuQmFzZT17ZXh0ZW5kOmZ1bmN0aW9uKGIpe24ucHJvdG90eXBlPXRoaXM7dmFyIGg9bmV3IG47YiYmaC5taXhJbihiKTtoLmhhc093blByb3BlcnR5KCJpbml0Iil8fChoLmluaXQ9ZnVuY3Rpb24oKXtoLiRzdXBlci5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pO2guaW5pdC5wcm90b3R5cGU9aDtoLiRzdXBlcj10aGlzO3JldHVybiBofSxjcmVhdGU6ZnVuY3Rpb24oKXt2YXIgYj10aGlzLmV4dGVuZCgpO2IuaW5pdC5hcHBseShiLGFyZ3VtZW50cyk7cmV0dXJuIGJ9LGluaXQ6ZnVuY3Rpb24oKXt9LG1peEluOmZ1bmN0aW9uKGIpe2Zvcih2YXIgaCBpbiBiKWIuaGFzT3duUHJvcGVydHkoaCkmJih0aGlzW2hdPWJbaF0pO2IuaGFzT3duUHJvcGVydHkoInRvU3RyaW5nIikmJih0aGlzLnRvU3RyaW5nPWIudG9TdHJpbmcpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmluaXQucHJvdG90eXBlLmV4dGVuZCh0aGlzKX19LApxPWwuV29yZEFycmF5PXIuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGIsaCl7Yj10aGlzLndvcmRzPWJ8fFtdO3RoaXMuc2lnQnl0ZXM9aCE9cD9oOjQqYi5sZW5ndGh9LHRvU3RyaW5nOmZ1bmN0aW9uKGIpe3JldHVybihifHx0KS5zdHJpbmdpZnkodGhpcyl9LGNvbmNhdDpmdW5jdGlvbihiKXt2YXIgaD10aGlzLndvcmRzLGE9Yi53b3JkcyxqPXRoaXMuc2lnQnl0ZXM7Yj1iLnNpZ0J5dGVzO3RoaXMuY2xhbXAoKTtpZihqJTQpZm9yKHZhciBnPTA7ZzxiO2crKyloW2orZz4+PjJdfD0oYVtnPj4+Ml0+Pj4yNC04KihnJTQpJjI1NSk8PDI0LTgqKChqK2cpJTQpO2Vsc2UgaWYoNjU1MzU8YS5sZW5ndGgpZm9yKGc9MDtnPGI7Zys9NCloW2orZz4+PjJdPWFbZz4+PjJdO2Vsc2UgaC5wdXNoLmFwcGx5KGgsYSk7dGhpcy5zaWdCeXRlcys9YjtyZXR1cm4gdGhpc30sY2xhbXA6ZnVuY3Rpb24oKXt2YXIgYj10aGlzLndvcmRzLGg9dGhpcy5zaWdCeXRlcztiW2g+Pj4yXSY9NDI5NDk2NzI5NTw8CjMyLTgqKGglNCk7Yi5sZW5ndGg9cy5jZWlsKGgvNCl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGI9ci5jbG9uZS5jYWxsKHRoaXMpO2Iud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKTtyZXR1cm4gYn0scmFuZG9tOmZ1bmN0aW9uKGIpe2Zvcih2YXIgaD1bXSxhPTA7YTxiO2ErPTQpaC5wdXNoKDQyOTQ5NjcyOTYqcy5yYW5kb20oKXwwKTtyZXR1cm4gbmV3IHEuaW5pdChoLGIpfX0pLHY9bS5lbmM9e30sdD12LkhleD17c3RyaW5naWZ5OmZ1bmN0aW9uKGIpe3ZhciBhPWIud29yZHM7Yj1iLnNpZ0J5dGVzO2Zvcih2YXIgZz1bXSxqPTA7ajxiO2orKyl7dmFyIGs9YVtqPj4+Ml0+Pj4yNC04KihqJTQpJjI1NTtnLnB1c2goKGs+Pj40KS50b1N0cmluZygxNikpO2cucHVzaCgoayYxNSkudG9TdHJpbmcoMTYpKX1yZXR1cm4gZy5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24oYil7Zm9yKHZhciBhPWIubGVuZ3RoLGc9W10saj0wO2o8YTtqKz0yKWdbaj4+PjNdfD1wYXJzZUludChiLnN1YnN0cihqLAoyKSwxNik8PDI0LTQqKGolOCk7cmV0dXJuIG5ldyBxLmluaXQoZyxhLzIpfX0sYT12LkxhdGluMT17c3RyaW5naWZ5OmZ1bmN0aW9uKGIpe3ZhciBhPWIud29yZHM7Yj1iLnNpZ0J5dGVzO2Zvcih2YXIgZz1bXSxqPTA7ajxiO2orKylnLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShhW2o+Pj4yXT4+PjI0LTgqKGolNCkmMjU1KSk7cmV0dXJuIGcuam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKGIpe2Zvcih2YXIgYT1iLmxlbmd0aCxnPVtdLGo9MDtqPGE7aisrKWdbaj4+PjJdfD0oYi5jaGFyQ29kZUF0KGopJjI1NSk8PDI0LTgqKGolNCk7cmV0dXJuIG5ldyBxLmluaXQoZyxhKX19LHU9di5VdGY4PXtzdHJpbmdpZnk6ZnVuY3Rpb24oYil7dHJ5e3JldHVybiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKGEuc3RyaW5naWZ5KGIpKSl9Y2F0Y2goZyl7dGhyb3cgRXJyb3IoIk1hbGZvcm1lZCBVVEYtOCBkYXRhIik7fX0scGFyc2U6ZnVuY3Rpb24oYil7cmV0dXJuIGEucGFyc2UodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGIpKSl9fSwKZz1sLkJ1ZmZlcmVkQmxvY2tBbGdvcml0aG09ci5leHRlbmQoe3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fZGF0YT1uZXcgcS5pbml0O3RoaXMuX25EYXRhQnl0ZXM9MH0sX2FwcGVuZDpmdW5jdGlvbihiKXsic3RyaW5nIj09dHlwZW9mIGImJihiPXUucGFyc2UoYikpO3RoaXMuX2RhdGEuY29uY2F0KGIpO3RoaXMuX25EYXRhQnl0ZXMrPWIuc2lnQnl0ZXN9LF9wcm9jZXNzOmZ1bmN0aW9uKGIpe3ZhciBhPXRoaXMuX2RhdGEsZz1hLndvcmRzLGo9YS5zaWdCeXRlcyxrPXRoaXMuYmxvY2tTaXplLG09ai8oNCprKSxtPWI/cy5jZWlsKG0pOnMubWF4KChtfDApLXRoaXMuX21pbkJ1ZmZlclNpemUsMCk7Yj1tKms7aj1zLm1pbig0KmIsaik7aWYoYil7Zm9yKHZhciBsPTA7bDxiO2wrPWspdGhpcy5fZG9Qcm9jZXNzQmxvY2soZyxsKTtsPWcuc3BsaWNlKDAsYik7YS5zaWdCeXRlcy09an1yZXR1cm4gbmV3IHEuaW5pdChsLGopfSxjbG9uZTpmdW5jdGlvbigpe3ZhciBiPXIuY2xvbmUuY2FsbCh0aGlzKTsKYi5fZGF0YT10aGlzLl9kYXRhLmNsb25lKCk7cmV0dXJuIGJ9LF9taW5CdWZmZXJTaXplOjB9KTtsLkhhc2hlcj1nLmV4dGVuZCh7Y2ZnOnIuZXh0ZW5kKCksaW5pdDpmdW5jdGlvbihiKXt0aGlzLmNmZz10aGlzLmNmZy5leHRlbmQoYik7dGhpcy5yZXNldCgpfSxyZXNldDpmdW5jdGlvbigpe2cucmVzZXQuY2FsbCh0aGlzKTt0aGlzLl9kb1Jlc2V0KCl9LHVwZGF0ZTpmdW5jdGlvbihiKXt0aGlzLl9hcHBlbmQoYik7dGhpcy5fcHJvY2VzcygpO3JldHVybiB0aGlzfSxmaW5hbGl6ZTpmdW5jdGlvbihiKXtiJiZ0aGlzLl9hcHBlbmQoYik7cmV0dXJuIHRoaXMuX2RvRmluYWxpemUoKX0sYmxvY2tTaXplOjE2LF9jcmVhdGVIZWxwZXI6ZnVuY3Rpb24oYil7cmV0dXJuIGZ1bmN0aW9uKGEsZyl7cmV0dXJuKG5ldyBiLmluaXQoZykpLmZpbmFsaXplKGEpfX0sX2NyZWF0ZUhtYWNIZWxwZXI6ZnVuY3Rpb24oYil7cmV0dXJuIGZ1bmN0aW9uKGEsZyl7cmV0dXJuKG5ldyBrLkhNQUMuaW5pdChiLApnKSkuZmluYWxpemUoYSl9fX0pO3ZhciBrPW0uYWxnbz17fTtyZXR1cm4gbX0oTWF0aCk7CihmdW5jdGlvbihzKXtmdW5jdGlvbiBwKGEsayxiLGgsbCxqLG0pe2E9YSsoayZifH5rJmgpK2wrbTtyZXR1cm4oYTw8anxhPj4+MzItaikra31mdW5jdGlvbiBtKGEsayxiLGgsbCxqLG0pe2E9YSsoayZofGImfmgpK2wrbTtyZXR1cm4oYTw8anxhPj4+MzItaikra31mdW5jdGlvbiBsKGEsayxiLGgsbCxqLG0pe2E9YSsoa15iXmgpK2wrbTtyZXR1cm4oYTw8anxhPj4+MzItaikra31mdW5jdGlvbiBuKGEsayxiLGgsbCxqLG0pe2E9YSsoYl4oa3x+aCkpK2wrbTtyZXR1cm4oYTw8anxhPj4+MzItaikra31mb3IodmFyIHI9Q3J5cHRvSlMscT1yLmxpYix2PXEuV29yZEFycmF5LHQ9cS5IYXNoZXIscT1yLmFsZ28sYT1bXSx1PTA7NjQ+dTt1KyspYVt1XT00Mjk0OTY3Mjk2KnMuYWJzKHMuc2luKHUrMSkpfDA7cT1xLk1ENT10LmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9oYXNoPW5ldyB2LmluaXQoWzE3MzI1ODQxOTMsNDAyMzIzMzQxNywyNTYyMzgzMTAyLDI3MTczMzg3OF0pfSwKX2RvUHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKGcsayl7Zm9yKHZhciBiPTA7MTY+YjtiKyspe3ZhciBoPWsrYix3PWdbaF07Z1toXT0odzw8OHx3Pj4+MjQpJjE2NzExOTM1fCh3PDwyNHx3Pj4+OCkmNDI3ODI1NTM2MH12YXIgYj10aGlzLl9oYXNoLndvcmRzLGg9Z1trKzBdLHc9Z1trKzFdLGo9Z1trKzJdLHE9Z1trKzNdLHI9Z1trKzRdLHM9Z1trKzVdLHQ9Z1trKzZdLHU9Z1trKzddLHY9Z1trKzhdLHg9Z1trKzldLHk9Z1trKzEwXSx6PWdbaysxMV0sQT1nW2srMTJdLEI9Z1trKzEzXSxDPWdbaysxNF0sRD1nW2srMTVdLGM9YlswXSxkPWJbMV0sZT1iWzJdLGY9YlszXSxjPXAoYyxkLGUsZixoLDcsYVswXSksZj1wKGYsYyxkLGUsdywxMixhWzFdKSxlPXAoZSxmLGMsZCxqLDE3LGFbMl0pLGQ9cChkLGUsZixjLHEsMjIsYVszXSksYz1wKGMsZCxlLGYsciw3LGFbNF0pLGY9cChmLGMsZCxlLHMsMTIsYVs1XSksZT1wKGUsZixjLGQsdCwxNyxhWzZdKSxkPXAoZCxlLGYsYyx1LDIyLGFbN10pLApjPXAoYyxkLGUsZix2LDcsYVs4XSksZj1wKGYsYyxkLGUseCwxMixhWzldKSxlPXAoZSxmLGMsZCx5LDE3LGFbMTBdKSxkPXAoZCxlLGYsYyx6LDIyLGFbMTFdKSxjPXAoYyxkLGUsZixBLDcsYVsxMl0pLGY9cChmLGMsZCxlLEIsMTIsYVsxM10pLGU9cChlLGYsYyxkLEMsMTcsYVsxNF0pLGQ9cChkLGUsZixjLEQsMjIsYVsxNV0pLGM9bShjLGQsZSxmLHcsNSxhWzE2XSksZj1tKGYsYyxkLGUsdCw5LGFbMTddKSxlPW0oZSxmLGMsZCx6LDE0LGFbMThdKSxkPW0oZCxlLGYsYyxoLDIwLGFbMTldKSxjPW0oYyxkLGUsZixzLDUsYVsyMF0pLGY9bShmLGMsZCxlLHksOSxhWzIxXSksZT1tKGUsZixjLGQsRCwxNCxhWzIyXSksZD1tKGQsZSxmLGMsciwyMCxhWzIzXSksYz1tKGMsZCxlLGYseCw1LGFbMjRdKSxmPW0oZixjLGQsZSxDLDksYVsyNV0pLGU9bShlLGYsYyxkLHEsMTQsYVsyNl0pLGQ9bShkLGUsZixjLHYsMjAsYVsyN10pLGM9bShjLGQsZSxmLEIsNSxhWzI4XSksZj1tKGYsYywKZCxlLGosOSxhWzI5XSksZT1tKGUsZixjLGQsdSwxNCxhWzMwXSksZD1tKGQsZSxmLGMsQSwyMCxhWzMxXSksYz1sKGMsZCxlLGYscyw0LGFbMzJdKSxmPWwoZixjLGQsZSx2LDExLGFbMzNdKSxlPWwoZSxmLGMsZCx6LDE2LGFbMzRdKSxkPWwoZCxlLGYsYyxDLDIzLGFbMzVdKSxjPWwoYyxkLGUsZix3LDQsYVszNl0pLGY9bChmLGMsZCxlLHIsMTEsYVszN10pLGU9bChlLGYsYyxkLHUsMTYsYVszOF0pLGQ9bChkLGUsZixjLHksMjMsYVszOV0pLGM9bChjLGQsZSxmLEIsNCxhWzQwXSksZj1sKGYsYyxkLGUsaCwxMSxhWzQxXSksZT1sKGUsZixjLGQscSwxNixhWzQyXSksZD1sKGQsZSxmLGMsdCwyMyxhWzQzXSksYz1sKGMsZCxlLGYseCw0LGFbNDRdKSxmPWwoZixjLGQsZSxBLDExLGFbNDVdKSxlPWwoZSxmLGMsZCxELDE2LGFbNDZdKSxkPWwoZCxlLGYsYyxqLDIzLGFbNDddKSxjPW4oYyxkLGUsZixoLDYsYVs0OF0pLGY9bihmLGMsZCxlLHUsMTAsYVs0OV0pLGU9bihlLGYsYyxkLApDLDE1LGFbNTBdKSxkPW4oZCxlLGYsYyxzLDIxLGFbNTFdKSxjPW4oYyxkLGUsZixBLDYsYVs1Ml0pLGY9bihmLGMsZCxlLHEsMTAsYVs1M10pLGU9bihlLGYsYyxkLHksMTUsYVs1NF0pLGQ9bihkLGUsZixjLHcsMjEsYVs1NV0pLGM9bihjLGQsZSxmLHYsNixhWzU2XSksZj1uKGYsYyxkLGUsRCwxMCxhWzU3XSksZT1uKGUsZixjLGQsdCwxNSxhWzU4XSksZD1uKGQsZSxmLGMsQiwyMSxhWzU5XSksYz1uKGMsZCxlLGYsciw2LGFbNjBdKSxmPW4oZixjLGQsZSx6LDEwLGFbNjFdKSxlPW4oZSxmLGMsZCxqLDE1LGFbNjJdKSxkPW4oZCxlLGYsYyx4LDIxLGFbNjNdKTtiWzBdPWJbMF0rY3wwO2JbMV09YlsxXStkfDA7YlsyXT1iWzJdK2V8MDtiWzNdPWJbM10rZnwwfSxfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMuX2RhdGEsaz1hLndvcmRzLGI9OCp0aGlzLl9uRGF0YUJ5dGVzLGg9OCphLnNpZ0J5dGVzO2tbaD4+PjVdfD0xMjg8PDI0LWglMzI7dmFyIGw9cy5mbG9vcihiLwo0Mjk0OTY3Mjk2KTtrWyhoKzY0Pj4+OTw8NCkrMTVdPShsPDw4fGw+Pj4yNCkmMTY3MTE5MzV8KGw8PDI0fGw+Pj44KSY0Mjc4MjU1MzYwO2tbKGgrNjQ+Pj45PDw0KSsxNF09KGI8PDh8Yj4+PjI0KSYxNjcxMTkzNXwoYjw8MjR8Yj4+PjgpJjQyNzgyNTUzNjA7YS5zaWdCeXRlcz00KihrLmxlbmd0aCsxKTt0aGlzLl9wcm9jZXNzKCk7YT10aGlzLl9oYXNoO2s9YS53b3Jkcztmb3IoYj0wOzQ+YjtiKyspaD1rW2JdLGtbYl09KGg8PDh8aD4+PjI0KSYxNjcxMTkzNXwoaDw8MjR8aD4+PjgpJjQyNzgyNTUzNjA7cmV0dXJuIGF9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9dC5jbG9uZS5jYWxsKHRoaXMpO2EuX2hhc2g9dGhpcy5faGFzaC5jbG9uZSgpO3JldHVybiBhfX0pO3IuTUQ1PXQuX2NyZWF0ZUhlbHBlcihxKTtyLkhtYWNNRDU9dC5fY3JlYXRlSG1hY0hlbHBlcihxKX0pKE1hdGgpOwo=',
'/libs/crypto_js/rollups/sha1.js':'LyoKQ3J5cHRvSlMgdjMuMS4yCmNvZGUuZ29vZ2xlLmNvbS9wL2NyeXB0by1qcwooYykgMjAwOS0yMDEzIGJ5IEplZmYgTW90dC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KY29kZS5nb29nbGUuY29tL3AvY3J5cHRvLWpzL3dpa2kvTGljZW5zZQoqLwp2YXIgQ3J5cHRvSlM9Q3J5cHRvSlN8fGZ1bmN0aW9uKGUsbSl7dmFyIHA9e30saj1wLmxpYj17fSxsPWZ1bmN0aW9uKCl7fSxmPWouQmFzZT17ZXh0ZW5kOmZ1bmN0aW9uKGEpe2wucHJvdG90eXBlPXRoaXM7dmFyIGM9bmV3IGw7YSYmYy5taXhJbihhKTtjLmhhc093blByb3BlcnR5KCJpbml0Iil8fChjLmluaXQ9ZnVuY3Rpb24oKXtjLiRzdXBlci5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pO2MuaW5pdC5wcm90b3R5cGU9YztjLiRzdXBlcj10aGlzO3JldHVybiBjfSxjcmVhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmV4dGVuZCgpO2EuaW5pdC5hcHBseShhLGFyZ3VtZW50cyk7cmV0dXJuIGF9LGluaXQ6ZnVuY3Rpb24oKXt9LG1peEluOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYyBpbiBhKWEuaGFzT3duUHJvcGVydHkoYykmJih0aGlzW2NdPWFbY10pO2EuaGFzT3duUHJvcGVydHkoInRvU3RyaW5nIikmJih0aGlzLnRvU3RyaW5nPWEudG9TdHJpbmcpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmluaXQucHJvdG90eXBlLmV4dGVuZCh0aGlzKX19LApuPWouV29yZEFycmF5PWYuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGEsYyl7YT10aGlzLndvcmRzPWF8fFtdO3RoaXMuc2lnQnl0ZXM9YyE9bT9jOjQqYS5sZW5ndGh9LHRvU3RyaW5nOmZ1bmN0aW9uKGEpe3JldHVybihhfHxoKS5zdHJpbmdpZnkodGhpcyl9LGNvbmNhdDpmdW5jdGlvbihhKXt2YXIgYz10aGlzLndvcmRzLHE9YS53b3JkcyxkPXRoaXMuc2lnQnl0ZXM7YT1hLnNpZ0J5dGVzO3RoaXMuY2xhbXAoKTtpZihkJTQpZm9yKHZhciBiPTA7YjxhO2IrKyljW2QrYj4+PjJdfD0ocVtiPj4+Ml0+Pj4yNC04KihiJTQpJjI1NSk8PDI0LTgqKChkK2IpJTQpO2Vsc2UgaWYoNjU1MzU8cS5sZW5ndGgpZm9yKGI9MDtiPGE7Yis9NCljW2QrYj4+PjJdPXFbYj4+PjJdO2Vsc2UgYy5wdXNoLmFwcGx5KGMscSk7dGhpcy5zaWdCeXRlcys9YTtyZXR1cm4gdGhpc30sY2xhbXA6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLndvcmRzLGM9dGhpcy5zaWdCeXRlczthW2M+Pj4yXSY9NDI5NDk2NzI5NTw8CjMyLTgqKGMlNCk7YS5sZW5ndGg9ZS5jZWlsKGMvNCl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9Zi5jbG9uZS5jYWxsKHRoaXMpO2Eud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKTtyZXR1cm4gYX0scmFuZG9tOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYz1bXSxiPTA7YjxhO2IrPTQpYy5wdXNoKDQyOTQ5NjcyOTYqZS5yYW5kb20oKXwwKTtyZXR1cm4gbmV3IG4uaW5pdChjLGEpfX0pLGI9cC5lbmM9e30saD1iLkhleD17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBjPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgYj1bXSxkPTA7ZDxhO2QrKyl7dmFyIGY9Y1tkPj4+Ml0+Pj4yNC04KihkJTQpJjI1NTtiLnB1c2goKGY+Pj40KS50b1N0cmluZygxNikpO2IucHVzaCgoZiYxNSkudG9TdHJpbmcoMTYpKX1yZXR1cm4gYi5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24oYSl7Zm9yKHZhciBjPWEubGVuZ3RoLGI9W10sZD0wO2Q8YztkKz0yKWJbZD4+PjNdfD1wYXJzZUludChhLnN1YnN0cihkLAoyKSwxNik8PDI0LTQqKGQlOCk7cmV0dXJuIG5ldyBuLmluaXQoYixjLzIpfX0sZz1iLkxhdGluMT17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBjPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgYj1bXSxkPTA7ZDxhO2QrKyliLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjW2Q+Pj4yXT4+PjI0LTgqKGQlNCkmMjU1KSk7cmV0dXJuIGIuam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYz1hLmxlbmd0aCxiPVtdLGQ9MDtkPGM7ZCsrKWJbZD4+PjJdfD0oYS5jaGFyQ29kZUF0KGQpJjI1NSk8PDI0LTgqKGQlNCk7cmV0dXJuIG5ldyBuLmluaXQoYixjKX19LHI9Yi5VdGY4PXtzdHJpbmdpZnk6ZnVuY3Rpb24oYSl7dHJ5e3JldHVybiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKGcuc3RyaW5naWZ5KGEpKSl9Y2F0Y2goYyl7dGhyb3cgRXJyb3IoIk1hbGZvcm1lZCBVVEYtOCBkYXRhIik7fX0scGFyc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIGcucGFyc2UodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGEpKSl9fSwKaz1qLkJ1ZmZlcmVkQmxvY2tBbGdvcml0aG09Zi5leHRlbmQoe3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fZGF0YT1uZXcgbi5pbml0O3RoaXMuX25EYXRhQnl0ZXM9MH0sX2FwcGVuZDpmdW5jdGlvbihhKXsic3RyaW5nIj09dHlwZW9mIGEmJihhPXIucGFyc2UoYSkpO3RoaXMuX2RhdGEuY29uY2F0KGEpO3RoaXMuX25EYXRhQnl0ZXMrPWEuc2lnQnl0ZXN9LF9wcm9jZXNzOmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXMuX2RhdGEsYj1jLndvcmRzLGQ9Yy5zaWdCeXRlcyxmPXRoaXMuYmxvY2tTaXplLGg9ZC8oNCpmKSxoPWE/ZS5jZWlsKGgpOmUubWF4KChofDApLXRoaXMuX21pbkJ1ZmZlclNpemUsMCk7YT1oKmY7ZD1lLm1pbig0KmEsZCk7aWYoYSl7Zm9yKHZhciBnPTA7ZzxhO2crPWYpdGhpcy5fZG9Qcm9jZXNzQmxvY2soYixnKTtnPWIuc3BsaWNlKDAsYSk7Yy5zaWdCeXRlcy09ZH1yZXR1cm4gbmV3IG4uaW5pdChnLGQpfSxjbG9uZTpmdW5jdGlvbigpe3ZhciBhPWYuY2xvbmUuY2FsbCh0aGlzKTsKYS5fZGF0YT10aGlzLl9kYXRhLmNsb25lKCk7cmV0dXJuIGF9LF9taW5CdWZmZXJTaXplOjB9KTtqLkhhc2hlcj1rLmV4dGVuZCh7Y2ZnOmYuZXh0ZW5kKCksaW5pdDpmdW5jdGlvbihhKXt0aGlzLmNmZz10aGlzLmNmZy5leHRlbmQoYSk7dGhpcy5yZXNldCgpfSxyZXNldDpmdW5jdGlvbigpe2sucmVzZXQuY2FsbCh0aGlzKTt0aGlzLl9kb1Jlc2V0KCl9LHVwZGF0ZTpmdW5jdGlvbihhKXt0aGlzLl9hcHBlbmQoYSk7dGhpcy5fcHJvY2VzcygpO3JldHVybiB0aGlzfSxmaW5hbGl6ZTpmdW5jdGlvbihhKXthJiZ0aGlzLl9hcHBlbmQoYSk7cmV0dXJuIHRoaXMuX2RvRmluYWxpemUoKX0sYmxvY2tTaXplOjE2LF9jcmVhdGVIZWxwZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGMsYil7cmV0dXJuKG5ldyBhLmluaXQoYikpLmZpbmFsaXplKGMpfX0sX2NyZWF0ZUhtYWNIZWxwZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGIsZil7cmV0dXJuKG5ldyBzLkhNQUMuaW5pdChhLApmKSkuZmluYWxpemUoYil9fX0pO3ZhciBzPXAuYWxnbz17fTtyZXR1cm4gcH0oTWF0aCk7CihmdW5jdGlvbigpe3ZhciBlPUNyeXB0b0pTLG09ZS5saWIscD1tLldvcmRBcnJheSxqPW0uSGFzaGVyLGw9W10sbT1lLmFsZ28uU0hBMT1qLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9oYXNoPW5ldyBwLmluaXQoWzE3MzI1ODQxOTMsNDAyMzIzMzQxNywyNTYyMzgzMTAyLDI3MTczMzg3OCwzMjg1Mzc3NTIwXSl9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbihmLG4pe2Zvcih2YXIgYj10aGlzLl9oYXNoLndvcmRzLGg9YlswXSxnPWJbMV0sZT1iWzJdLGs9YlszXSxqPWJbNF0sYT0wOzgwPmE7YSsrKXtpZigxNj5hKWxbYV09ZltuK2FdfDA7ZWxzZXt2YXIgYz1sW2EtM11ebFthLThdXmxbYS0xNF1ebFthLTE2XTtsW2FdPWM8PDF8Yz4+PjMxfWM9KGg8PDV8aD4+PjI3KStqK2xbYV07Yz0yMD5hP2MrKChnJmV8fmcmaykrMTUxODUwMDI0OSk6NDA+YT9jKygoZ15lXmspKzE4NTk3NzUzOTMpOjYwPmE/YysoKGcmZXxnJmt8ZSZrKS0xODk0MDA3NTg4KTpjKygoZ15lXgprKS04OTk0OTc1MTQpO2o9aztrPWU7ZT1nPDwzMHxnPj4+MjtnPWg7aD1jfWJbMF09YlswXStofDA7YlsxXT1iWzFdK2d8MDtiWzJdPWJbMl0rZXwwO2JbM109YlszXStrfDA7Yls0XT1iWzRdK2p8MH0sX2RvRmluYWxpemU6ZnVuY3Rpb24oKXt2YXIgZj10aGlzLl9kYXRhLGU9Zi53b3JkcyxiPTgqdGhpcy5fbkRhdGFCeXRlcyxoPTgqZi5zaWdCeXRlcztlW2g+Pj41XXw9MTI4PDwyNC1oJTMyO2VbKGgrNjQ+Pj45PDw0KSsxNF09TWF0aC5mbG9vcihiLzQyOTQ5NjcyOTYpO2VbKGgrNjQ+Pj45PDw0KSsxNV09YjtmLnNpZ0J5dGVzPTQqZS5sZW5ndGg7dGhpcy5fcHJvY2VzcygpO3JldHVybiB0aGlzLl9oYXNofSxjbG9uZTpmdW5jdGlvbigpe3ZhciBlPWouY2xvbmUuY2FsbCh0aGlzKTtlLl9oYXNoPXRoaXMuX2hhc2guY2xvbmUoKTtyZXR1cm4gZX19KTtlLlNIQTE9ai5fY3JlYXRlSGVscGVyKG0pO2UuSG1hY1NIQTE9ai5fY3JlYXRlSG1hY0hlbHBlcihtKX0pKCk7Cg==',
'/libs/crypto_js/rollups/sha224.js':'LyoKQ3J5cHRvSlMgdjMuMS4yCmNvZGUuZ29vZ2xlLmNvbS9wL2NyeXB0by1qcwooYykgMjAwOS0yMDEzIGJ5IEplZmYgTW90dC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KY29kZS5nb29nbGUuY29tL3AvY3J5cHRvLWpzL3dpa2kvTGljZW5zZQoqLwp2YXIgQ3J5cHRvSlM9Q3J5cHRvSlN8fGZ1bmN0aW9uKGcsbCl7dmFyIGY9e30saz1mLmxpYj17fSxoPWZ1bmN0aW9uKCl7fSxtPWsuQmFzZT17ZXh0ZW5kOmZ1bmN0aW9uKGEpe2gucHJvdG90eXBlPXRoaXM7dmFyIGM9bmV3IGg7YSYmYy5taXhJbihhKTtjLmhhc093blByb3BlcnR5KCJpbml0Iil8fChjLmluaXQ9ZnVuY3Rpb24oKXtjLiRzdXBlci5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pO2MuaW5pdC5wcm90b3R5cGU9YztjLiRzdXBlcj10aGlzO3JldHVybiBjfSxjcmVhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmV4dGVuZCgpO2EuaW5pdC5hcHBseShhLGFyZ3VtZW50cyk7cmV0dXJuIGF9LGluaXQ6ZnVuY3Rpb24oKXt9LG1peEluOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYyBpbiBhKWEuaGFzT3duUHJvcGVydHkoYykmJih0aGlzW2NdPWFbY10pO2EuaGFzT3duUHJvcGVydHkoInRvU3RyaW5nIikmJih0aGlzLnRvU3RyaW5nPWEudG9TdHJpbmcpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmluaXQucHJvdG90eXBlLmV4dGVuZCh0aGlzKX19LApxPWsuV29yZEFycmF5PW0uZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGEsYyl7YT10aGlzLndvcmRzPWF8fFtdO3RoaXMuc2lnQnl0ZXM9YyE9bD9jOjQqYS5sZW5ndGh9LHRvU3RyaW5nOmZ1bmN0aW9uKGEpe3JldHVybihhfHxzKS5zdHJpbmdpZnkodGhpcyl9LGNvbmNhdDpmdW5jdGlvbihhKXt2YXIgYz10aGlzLndvcmRzLGQ9YS53b3JkcyxiPXRoaXMuc2lnQnl0ZXM7YT1hLnNpZ0J5dGVzO3RoaXMuY2xhbXAoKTtpZihiJTQpZm9yKHZhciBlPTA7ZTxhO2UrKyljW2IrZT4+PjJdfD0oZFtlPj4+Ml0+Pj4yNC04KihlJTQpJjI1NSk8PDI0LTgqKChiK2UpJTQpO2Vsc2UgaWYoNjU1MzU8ZC5sZW5ndGgpZm9yKGU9MDtlPGE7ZSs9NCljW2IrZT4+PjJdPWRbZT4+PjJdO2Vsc2UgYy5wdXNoLmFwcGx5KGMsZCk7dGhpcy5zaWdCeXRlcys9YTtyZXR1cm4gdGhpc30sY2xhbXA6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLndvcmRzLGM9dGhpcy5zaWdCeXRlczthW2M+Pj4yXSY9NDI5NDk2NzI5NTw8CjMyLTgqKGMlNCk7YS5sZW5ndGg9Zy5jZWlsKGMvNCl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9bS5jbG9uZS5jYWxsKHRoaXMpO2Eud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKTtyZXR1cm4gYX0scmFuZG9tOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYz1bXSxkPTA7ZDxhO2QrPTQpYy5wdXNoKDQyOTQ5NjcyOTYqZy5yYW5kb20oKXwwKTtyZXR1cm4gbmV3IHEuaW5pdChjLGEpfX0pLHQ9Zi5lbmM9e30scz10LkhleD17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBjPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgZD1bXSxiPTA7YjxhO2IrKyl7dmFyIGU9Y1tiPj4+Ml0+Pj4yNC04KihiJTQpJjI1NTtkLnB1c2goKGU+Pj40KS50b1N0cmluZygxNikpO2QucHVzaCgoZSYxNSkudG9TdHJpbmcoMTYpKX1yZXR1cm4gZC5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24oYSl7Zm9yKHZhciBjPWEubGVuZ3RoLGQ9W10sYj0wO2I8YztiKz0yKWRbYj4+PjNdfD1wYXJzZUludChhLnN1YnN0cihiLAoyKSwxNik8PDI0LTQqKGIlOCk7cmV0dXJuIG5ldyBxLmluaXQoZCxjLzIpfX0sbj10LkxhdGluMT17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBjPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgZD1bXSxiPTA7YjxhO2IrKylkLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjW2I+Pj4yXT4+PjI0LTgqKGIlNCkmMjU1KSk7cmV0dXJuIGQuam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYz1hLmxlbmd0aCxkPVtdLGI9MDtiPGM7YisrKWRbYj4+PjJdfD0oYS5jaGFyQ29kZUF0KGIpJjI1NSk8PDI0LTgqKGIlNCk7cmV0dXJuIG5ldyBxLmluaXQoZCxjKX19LGo9dC5VdGY4PXtzdHJpbmdpZnk6ZnVuY3Rpb24oYSl7dHJ5e3JldHVybiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKG4uc3RyaW5naWZ5KGEpKSl9Y2F0Y2goYyl7dGhyb3cgRXJyb3IoIk1hbGZvcm1lZCBVVEYtOCBkYXRhIik7fX0scGFyc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIG4ucGFyc2UodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGEpKSl9fSwKdz1rLkJ1ZmZlcmVkQmxvY2tBbGdvcml0aG09bS5leHRlbmQoe3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fZGF0YT1uZXcgcS5pbml0O3RoaXMuX25EYXRhQnl0ZXM9MH0sX2FwcGVuZDpmdW5jdGlvbihhKXsic3RyaW5nIj09dHlwZW9mIGEmJihhPWoucGFyc2UoYSkpO3RoaXMuX2RhdGEuY29uY2F0KGEpO3RoaXMuX25EYXRhQnl0ZXMrPWEuc2lnQnl0ZXN9LF9wcm9jZXNzOmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXMuX2RhdGEsZD1jLndvcmRzLGI9Yy5zaWdCeXRlcyxlPXRoaXMuYmxvY2tTaXplLGY9Yi8oNCplKSxmPWE/Zy5jZWlsKGYpOmcubWF4KChmfDApLXRoaXMuX21pbkJ1ZmZlclNpemUsMCk7YT1mKmU7Yj1nLm1pbig0KmEsYik7aWYoYSl7Zm9yKHZhciB1PTA7dTxhO3UrPWUpdGhpcy5fZG9Qcm9jZXNzQmxvY2soZCx1KTt1PWQuc3BsaWNlKDAsYSk7Yy5zaWdCeXRlcy09Yn1yZXR1cm4gbmV3IHEuaW5pdCh1LGIpfSxjbG9uZTpmdW5jdGlvbigpe3ZhciBhPW0uY2xvbmUuY2FsbCh0aGlzKTsKYS5fZGF0YT10aGlzLl9kYXRhLmNsb25lKCk7cmV0dXJuIGF9LF9taW5CdWZmZXJTaXplOjB9KTtrLkhhc2hlcj13LmV4dGVuZCh7Y2ZnOm0uZXh0ZW5kKCksaW5pdDpmdW5jdGlvbihhKXt0aGlzLmNmZz10aGlzLmNmZy5leHRlbmQoYSk7dGhpcy5yZXNldCgpfSxyZXNldDpmdW5jdGlvbigpe3cucmVzZXQuY2FsbCh0aGlzKTt0aGlzLl9kb1Jlc2V0KCl9LHVwZGF0ZTpmdW5jdGlvbihhKXt0aGlzLl9hcHBlbmQoYSk7dGhpcy5fcHJvY2VzcygpO3JldHVybiB0aGlzfSxmaW5hbGl6ZTpmdW5jdGlvbihhKXthJiZ0aGlzLl9hcHBlbmQoYSk7cmV0dXJuIHRoaXMuX2RvRmluYWxpemUoKX0sYmxvY2tTaXplOjE2LF9jcmVhdGVIZWxwZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGMsZCl7cmV0dXJuKG5ldyBhLmluaXQoZCkpLmZpbmFsaXplKGMpfX0sX2NyZWF0ZUhtYWNIZWxwZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGMsZCl7cmV0dXJuKG5ldyB2LkhNQUMuaW5pdChhLApkKSkuZmluYWxpemUoYyl9fX0pO3ZhciB2PWYuYWxnbz17fTtyZXR1cm4gZn0oTWF0aCk7CihmdW5jdGlvbihnKXtmb3IodmFyIGw9Q3J5cHRvSlMsZj1sLmxpYixrPWYuV29yZEFycmF5LGg9Zi5IYXNoZXIsZj1sLmFsZ28sbT1bXSxxPVtdLHQ9ZnVuY3Rpb24oYSl7cmV0dXJuIDQyOTQ5NjcyOTYqKGEtKGF8MCkpfDB9LHM9MixuPTA7NjQ+bjspe3ZhciBqO2E6e2o9cztmb3IodmFyIHc9Zy5zcXJ0KGopLHY9Mjt2PD13O3YrKylpZighKGoldikpe2o9ITE7YnJlYWsgYX1qPSEwfWomJig4Pm4mJihtW25dPXQoZy5wb3cocywwLjUpKSkscVtuXT10KGcucG93KHMsMS8zKSksbisrKTtzKyt9dmFyIGE9W10sZj1mLlNIQTI1Nj1oLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9oYXNoPW5ldyBrLmluaXQobS5zbGljZSgwKSl9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbihjLGQpe2Zvcih2YXIgYj10aGlzLl9oYXNoLndvcmRzLGU9YlswXSxmPWJbMV0sZz1iWzJdLGs9YlszXSxoPWJbNF0sbD1iWzVdLG09Yls2XSxuPWJbN10scD0wOzY0PnA7cCsrKXtpZigxNj5wKWFbcF09CmNbZCtwXXwwO2Vsc2V7dmFyIGo9YVtwLTE1XSxyPWFbcC0yXTthW3BdPSgoajw8MjV8aj4+PjcpXihqPDwxNHxqPj4+MTgpXmo+Pj4zKSthW3AtN10rKChyPDwxNXxyPj4+MTcpXihyPDwxM3xyPj4+MTkpXnI+Pj4xMCkrYVtwLTE2XX1qPW4rKChoPDwyNnxoPj4+NileKGg8PDIxfGg+Pj4xMSleKGg8PDd8aD4+PjI1KSkrKGgmbF5+aCZtKStxW3BdK2FbcF07cj0oKGU8PDMwfGU+Pj4yKV4oZTw8MTl8ZT4+PjEzKV4oZTw8MTB8ZT4+PjIyKSkrKGUmZl5lJmdeZiZnKTtuPW07bT1sO2w9aDtoPWsranwwO2s9ZztnPWY7Zj1lO2U9aityfDB9YlswXT1iWzBdK2V8MDtiWzFdPWJbMV0rZnwwO2JbMl09YlsyXStnfDA7YlszXT1iWzNdK2t8MDtiWzRdPWJbNF0raHwwO2JbNV09Yls1XStsfDA7Yls2XT1iWzZdK218MDtiWzddPWJbN10rbnwwfSxfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMuX2RhdGEsZD1hLndvcmRzLGI9OCp0aGlzLl9uRGF0YUJ5dGVzLGU9OCphLnNpZ0J5dGVzOwpkW2U+Pj41XXw9MTI4PDwyNC1lJTMyO2RbKGUrNjQ+Pj45PDw0KSsxNF09Zy5mbG9vcihiLzQyOTQ5NjcyOTYpO2RbKGUrNjQ+Pj45PDw0KSsxNV09YjthLnNpZ0J5dGVzPTQqZC5sZW5ndGg7dGhpcy5fcHJvY2VzcygpO3JldHVybiB0aGlzLl9oYXNofSxjbG9uZTpmdW5jdGlvbigpe3ZhciBhPWguY2xvbmUuY2FsbCh0aGlzKTthLl9oYXNoPXRoaXMuX2hhc2guY2xvbmUoKTtyZXR1cm4gYX19KTtsLlNIQTI1Nj1oLl9jcmVhdGVIZWxwZXIoZik7bC5IbWFjU0hBMjU2PWguX2NyZWF0ZUhtYWNIZWxwZXIoZil9KShNYXRoKTsKKGZ1bmN0aW9uKCl7dmFyIGc9Q3J5cHRvSlMsbD1nLmxpYi5Xb3JkQXJyYXksZj1nLmFsZ28saz1mLlNIQTI1NixmPWYuU0hBMjI0PWsuZXh0ZW5kKHtfZG9SZXNldDpmdW5jdGlvbigpe3RoaXMuX2hhc2g9bmV3IGwuaW5pdChbMzIzODM3MTAzMiw5MTQxNTA2NjMsODEyNzAyOTk5LDQxNDQ5MTI2OTcsNDI5MDc3NTg1NywxNzUwNjAzMDI1LDE2OTQwNzY4MzksMzIwNDA3NTQyOF0pfSxfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3ZhciBmPWsuX2RvRmluYWxpemUuY2FsbCh0aGlzKTtmLnNpZ0J5dGVzLT00O3JldHVybiBmfX0pO2cuU0hBMjI0PWsuX2NyZWF0ZUhlbHBlcihmKTtnLkhtYWNTSEEyMjQ9ay5fY3JlYXRlSG1hY0hlbHBlcihmKX0pKCk7Cg==',
'/libs/crypto_js/rollups/sha3.js':'LyoKQ3J5cHRvSlMgdjMuMS4yCmNvZGUuZ29vZ2xlLmNvbS9wL2NyeXB0by1qcwooYykgMjAwOS0yMDEzIGJ5IEplZmYgTW90dC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KY29kZS5nb29nbGUuY29tL3AvY3J5cHRvLWpzL3dpa2kvTGljZW5zZQoqLwp2YXIgQ3J5cHRvSlM9Q3J5cHRvSlN8fGZ1bmN0aW9uKHYscCl7dmFyIGQ9e30sdT1kLmxpYj17fSxyPWZ1bmN0aW9uKCl7fSxmPXUuQmFzZT17ZXh0ZW5kOmZ1bmN0aW9uKGEpe3IucHJvdG90eXBlPXRoaXM7dmFyIGI9bmV3IHI7YSYmYi5taXhJbihhKTtiLmhhc093blByb3BlcnR5KCJpbml0Iil8fChiLmluaXQ9ZnVuY3Rpb24oKXtiLiRzdXBlci5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pO2IuaW5pdC5wcm90b3R5cGU9YjtiLiRzdXBlcj10aGlzO3JldHVybiBifSxjcmVhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmV4dGVuZCgpO2EuaW5pdC5hcHBseShhLGFyZ3VtZW50cyk7cmV0dXJuIGF9LGluaXQ6ZnVuY3Rpb24oKXt9LG1peEluOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYiBpbiBhKWEuaGFzT3duUHJvcGVydHkoYikmJih0aGlzW2JdPWFbYl0pO2EuaGFzT3duUHJvcGVydHkoInRvU3RyaW5nIikmJih0aGlzLnRvU3RyaW5nPWEudG9TdHJpbmcpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmluaXQucHJvdG90eXBlLmV4dGVuZCh0aGlzKX19LApzPXUuV29yZEFycmF5PWYuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGEsYil7YT10aGlzLndvcmRzPWF8fFtdO3RoaXMuc2lnQnl0ZXM9YiE9cD9iOjQqYS5sZW5ndGh9LHRvU3RyaW5nOmZ1bmN0aW9uKGEpe3JldHVybihhfHx5KS5zdHJpbmdpZnkodGhpcyl9LGNvbmNhdDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLndvcmRzLGM9YS53b3JkcyxqPXRoaXMuc2lnQnl0ZXM7YT1hLnNpZ0J5dGVzO3RoaXMuY2xhbXAoKTtpZihqJTQpZm9yKHZhciBuPTA7bjxhO24rKyliW2orbj4+PjJdfD0oY1tuPj4+Ml0+Pj4yNC04KihuJTQpJjI1NSk8PDI0LTgqKChqK24pJTQpO2Vsc2UgaWYoNjU1MzU8Yy5sZW5ndGgpZm9yKG49MDtuPGE7bis9NCliW2orbj4+PjJdPWNbbj4+PjJdO2Vsc2UgYi5wdXNoLmFwcGx5KGIsYyk7dGhpcy5zaWdCeXRlcys9YTtyZXR1cm4gdGhpc30sY2xhbXA6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLndvcmRzLGI9dGhpcy5zaWdCeXRlczthW2I+Pj4yXSY9NDI5NDk2NzI5NTw8CjMyLTgqKGIlNCk7YS5sZW5ndGg9di5jZWlsKGIvNCl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9Zi5jbG9uZS5jYWxsKHRoaXMpO2Eud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKTtyZXR1cm4gYX0scmFuZG9tOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1bXSxjPTA7YzxhO2MrPTQpYi5wdXNoKDQyOTQ5NjcyOTYqdi5yYW5kb20oKXwwKTtyZXR1cm4gbmV3IHMuaW5pdChiLGEpfX0pLHg9ZC5lbmM9e30seT14LkhleD17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBiPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgYz1bXSxqPTA7ajxhO2orKyl7dmFyIG49YltqPj4+Ml0+Pj4yNC04KihqJTQpJjI1NTtjLnB1c2goKG4+Pj40KS50b1N0cmluZygxNikpO2MucHVzaCgobiYxNSkudG9TdHJpbmcoMTYpKX1yZXR1cm4gYy5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPWEubGVuZ3RoLGM9W10saj0wO2o8YjtqKz0yKWNbaj4+PjNdfD1wYXJzZUludChhLnN1YnN0cihqLAoyKSwxNik8PDI0LTQqKGolOCk7cmV0dXJuIG5ldyBzLmluaXQoYyxiLzIpfX0sZT14LkxhdGluMT17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBiPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgYz1bXSxqPTA7ajxhO2orKyljLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShiW2o+Pj4yXT4+PjI0LTgqKGolNCkmMjU1KSk7cmV0dXJuIGMuam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1hLmxlbmd0aCxjPVtdLGo9MDtqPGI7aisrKWNbaj4+PjJdfD0oYS5jaGFyQ29kZUF0KGopJjI1NSk8PDI0LTgqKGolNCk7cmV0dXJuIG5ldyBzLmluaXQoYyxiKX19LHE9eC5VdGY4PXtzdHJpbmdpZnk6ZnVuY3Rpb24oYSl7dHJ5e3JldHVybiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKGUuc3RyaW5naWZ5KGEpKSl9Y2F0Y2goYil7dGhyb3cgRXJyb3IoIk1hbGZvcm1lZCBVVEYtOCBkYXRhIik7fX0scGFyc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIGUucGFyc2UodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGEpKSl9fSwKdD11LkJ1ZmZlcmVkQmxvY2tBbGdvcml0aG09Zi5leHRlbmQoe3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fZGF0YT1uZXcgcy5pbml0O3RoaXMuX25EYXRhQnl0ZXM9MH0sX2FwcGVuZDpmdW5jdGlvbihhKXsic3RyaW5nIj09dHlwZW9mIGEmJihhPXEucGFyc2UoYSkpO3RoaXMuX2RhdGEuY29uY2F0KGEpO3RoaXMuX25EYXRhQnl0ZXMrPWEuc2lnQnl0ZXN9LF9wcm9jZXNzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuX2RhdGEsYz1iLndvcmRzLGo9Yi5zaWdCeXRlcyxuPXRoaXMuYmxvY2tTaXplLGU9ai8oNCpuKSxlPWE/di5jZWlsKGUpOnYubWF4KChlfDApLXRoaXMuX21pbkJ1ZmZlclNpemUsMCk7YT1lKm47aj12Lm1pbig0KmEsaik7aWYoYSl7Zm9yKHZhciBmPTA7ZjxhO2YrPW4pdGhpcy5fZG9Qcm9jZXNzQmxvY2soYyxmKTtmPWMuc3BsaWNlKDAsYSk7Yi5zaWdCeXRlcy09an1yZXR1cm4gbmV3IHMuaW5pdChmLGopfSxjbG9uZTpmdW5jdGlvbigpe3ZhciBhPWYuY2xvbmUuY2FsbCh0aGlzKTsKYS5fZGF0YT10aGlzLl9kYXRhLmNsb25lKCk7cmV0dXJuIGF9LF9taW5CdWZmZXJTaXplOjB9KTt1Lkhhc2hlcj10LmV4dGVuZCh7Y2ZnOmYuZXh0ZW5kKCksaW5pdDpmdW5jdGlvbihhKXt0aGlzLmNmZz10aGlzLmNmZy5leHRlbmQoYSk7dGhpcy5yZXNldCgpfSxyZXNldDpmdW5jdGlvbigpe3QucmVzZXQuY2FsbCh0aGlzKTt0aGlzLl9kb1Jlc2V0KCl9LHVwZGF0ZTpmdW5jdGlvbihhKXt0aGlzLl9hcHBlbmQoYSk7dGhpcy5fcHJvY2VzcygpO3JldHVybiB0aGlzfSxmaW5hbGl6ZTpmdW5jdGlvbihhKXthJiZ0aGlzLl9hcHBlbmQoYSk7cmV0dXJuIHRoaXMuX2RvRmluYWxpemUoKX0sYmxvY2tTaXplOjE2LF9jcmVhdGVIZWxwZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGIsYyl7cmV0dXJuKG5ldyBhLmluaXQoYykpLmZpbmFsaXplKGIpfX0sX2NyZWF0ZUhtYWNIZWxwZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGIsYyl7cmV0dXJuKG5ldyB3LkhNQUMuaW5pdChhLApjKSkuZmluYWxpemUoYil9fX0pO3ZhciB3PWQuYWxnbz17fTtyZXR1cm4gZH0oTWF0aCk7CihmdW5jdGlvbih2KXt2YXIgcD1DcnlwdG9KUyxkPXAubGliLHU9ZC5CYXNlLHI9ZC5Xb3JkQXJyYXkscD1wLng2ND17fTtwLldvcmQ9dS5leHRlbmQoe2luaXQ6ZnVuY3Rpb24oZixzKXt0aGlzLmhpZ2g9Zjt0aGlzLmxvdz1zfX0pO3AuV29yZEFycmF5PXUuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGYscyl7Zj10aGlzLndvcmRzPWZ8fFtdO3RoaXMuc2lnQnl0ZXM9cyE9dj9zOjgqZi5sZW5ndGh9LHRvWDMyOmZ1bmN0aW9uKCl7Zm9yKHZhciBmPXRoaXMud29yZHMscz1mLmxlbmd0aCxkPVtdLHA9MDtwPHM7cCsrKXt2YXIgZT1mW3BdO2QucHVzaChlLmhpZ2gpO2QucHVzaChlLmxvdyl9cmV0dXJuIHIuY3JlYXRlKGQsdGhpcy5zaWdCeXRlcyl9LGNsb25lOmZ1bmN0aW9uKCl7Zm9yKHZhciBmPXUuY2xvbmUuY2FsbCh0aGlzKSxkPWYud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKSxwPWQubGVuZ3RoLHI9MDtyPHA7cisrKWRbcl09ZFtyXS5jbG9uZSgpO3JldHVybiBmfX0pfSkoKTsKKGZ1bmN0aW9uKHYpe2Zvcih2YXIgcD1DcnlwdG9KUyxkPXAubGliLHU9ZC5Xb3JkQXJyYXkscj1kLkhhc2hlcixmPXAueDY0LldvcmQsZD1wLmFsZ28scz1bXSx4PVtdLHk9W10sZT0xLHE9MCx0PTA7MjQ+dDt0Kyspe3NbZSs1KnFdPSh0KzEpKih0KzIpLzIlNjQ7dmFyIHc9KDIqZSszKnEpJTUsZT1xJTUscT13fWZvcihlPTA7NT5lO2UrKylmb3IocT0wOzU+cTtxKyspeFtlKzUqcV09cSs1KigoMiplKzMqcSklNSk7ZT0xO2ZvcihxPTA7MjQ+cTtxKyspe2Zvcih2YXIgYT13PXQ9MDs3PmE7YSsrKXtpZihlJjEpe3ZhciBiPSgxPDxhKS0xOzMyPmI/d149MTw8Yjp0Xj0xPDxiLTMyfWU9ZSYxMjg/ZTw8MV4xMTM6ZTw8MX15W3FdPWYuY3JlYXRlKHQsdyl9Zm9yKHZhciBjPVtdLGU9MDsyNT5lO2UrKyljW2VdPWYuY3JlYXRlKCk7ZD1kLlNIQTM9ci5leHRlbmQoe2NmZzpyLmNmZy5leHRlbmQoe291dHB1dExlbmd0aDo1MTJ9KSxfZG9SZXNldDpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLl9zdGF0ZT0KW10sYj0wOzI1PmI7YisrKWFbYl09bmV3IGYuaW5pdDt0aGlzLmJsb2NrU2l6ZT0oMTYwMC0yKnRoaXMuY2ZnLm91dHB1dExlbmd0aCkvMzJ9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbihhLGIpe2Zvcih2YXIgZT10aGlzLl9zdGF0ZSxmPXRoaXMuYmxvY2tTaXplLzIsaD0wO2g8ZjtoKyspe3ZhciBsPWFbYisyKmhdLG09YVtiKzIqaCsxXSxsPShsPDw4fGw+Pj4yNCkmMTY3MTE5MzV8KGw8PDI0fGw+Pj44KSY0Mjc4MjU1MzYwLG09KG08PDh8bT4+PjI0KSYxNjcxMTkzNXwobTw8MjR8bT4+PjgpJjQyNzgyNTUzNjAsZz1lW2hdO2cuaGlnaF49bTtnLmxvd149bH1mb3IoZj0wOzI0PmY7ZisrKXtmb3IoaD0wOzU+aDtoKyspe2Zvcih2YXIgZD1sPTAsaz0wOzU+aztrKyspZz1lW2grNSprXSxsXj1nLmhpZ2gsZF49Zy5sb3c7Zz1jW2hdO2cuaGlnaD1sO2cubG93PWR9Zm9yKGg9MDs1Pmg7aCsrKXtnPWNbKGgrNCklNV07bD1jWyhoKzEpJTVdO209bC5oaWdoO2s9bC5sb3c7bD1nLmhpZ2heCihtPDwxfGs+Pj4zMSk7ZD1nLmxvd14oazw8MXxtPj4+MzEpO2ZvcihrPTA7NT5rO2srKylnPWVbaCs1KmtdLGcuaGlnaF49bCxnLmxvd149ZH1mb3IobT0xOzI1Pm07bSsrKWc9ZVttXSxoPWcuaGlnaCxnPWcubG93LGs9c1ttXSwzMj5rPyhsPWg8PGt8Zz4+PjMyLWssZD1nPDxrfGg+Pj4zMi1rKToobD1nPDxrLTMyfGg+Pj42NC1rLGQ9aDw8ay0zMnxnPj4+NjQtayksZz1jW3hbbV1dLGcuaGlnaD1sLGcubG93PWQ7Zz1jWzBdO2g9ZVswXTtnLmhpZ2g9aC5oaWdoO2cubG93PWgubG93O2ZvcihoPTA7NT5oO2grKylmb3Ioaz0wOzU+aztrKyspbT1oKzUqayxnPWVbbV0sbD1jW21dLG09Y1soaCsxKSU1KzUqa10sZD1jWyhoKzIpJTUrNSprXSxnLmhpZ2g9bC5oaWdoXn5tLmhpZ2gmZC5oaWdoLGcubG93PWwubG93Xn5tLmxvdyZkLmxvdztnPWVbMF07aD15W2ZdO2cuaGlnaF49aC5oaWdoO2cubG93Xj1oLmxvd319LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5fZGF0YSwKYj1hLndvcmRzLGM9OCphLnNpZ0J5dGVzLGU9MzIqdGhpcy5ibG9ja1NpemU7YltjPj4+NV18PTE8PDI0LWMlMzI7Ylsodi5jZWlsKChjKzEpL2UpKmU+Pj41KS0xXXw9MTI4O2Euc2lnQnl0ZXM9NCpiLmxlbmd0aDt0aGlzLl9wcm9jZXNzKCk7Zm9yKHZhciBhPXRoaXMuX3N0YXRlLGI9dGhpcy5jZmcub3V0cHV0TGVuZ3RoLzgsYz1iLzgsZT1bXSxoPTA7aDxjO2grKyl7dmFyIGQ9YVtoXSxmPWQuaGlnaCxkPWQubG93LGY9KGY8PDh8Zj4+PjI0KSYxNjcxMTkzNXwoZjw8MjR8Zj4+PjgpJjQyNzgyNTUzNjAsZD0oZDw8OHxkPj4+MjQpJjE2NzExOTM1fChkPDwyNHxkPj4+OCkmNDI3ODI1NTM2MDtlLnB1c2goZCk7ZS5wdXNoKGYpfXJldHVybiBuZXcgdS5pbml0KGUsYil9LGNsb25lOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXIuY2xvbmUuY2FsbCh0aGlzKSxiPWEuX3N0YXRlPXRoaXMuX3N0YXRlLnNsaWNlKDApLGM9MDsyNT5jO2MrKyliW2NdPWJbY10uY2xvbmUoKTtyZXR1cm4gYX19KTsKcC5TSEEzPXIuX2NyZWF0ZUhlbHBlcihkKTtwLkhtYWNTSEEzPXIuX2NyZWF0ZUhtYWNIZWxwZXIoZCl9KShNYXRoKTsK',
'/libs/crypto_js/rollups/sha384.js':'LyoKQ3J5cHRvSlMgdjMuMS4yCmNvZGUuZ29vZ2xlLmNvbS9wL2NyeXB0by1qcwooYykgMjAwOS0yMDEzIGJ5IEplZmYgTW90dC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KY29kZS5nb29nbGUuY29tL3AvY3J5cHRvLWpzL3dpa2kvTGljZW5zZQoqLwp2YXIgQ3J5cHRvSlM9Q3J5cHRvSlN8fGZ1bmN0aW9uKGEsYyl7dmFyIGQ9e30saj1kLmxpYj17fSxmPWZ1bmN0aW9uKCl7fSxtPWouQmFzZT17ZXh0ZW5kOmZ1bmN0aW9uKGEpe2YucHJvdG90eXBlPXRoaXM7dmFyIGI9bmV3IGY7YSYmYi5taXhJbihhKTtiLmhhc093blByb3BlcnR5KCJpbml0Iil8fChiLmluaXQ9ZnVuY3Rpb24oKXtiLiRzdXBlci5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pO2IuaW5pdC5wcm90b3R5cGU9YjtiLiRzdXBlcj10aGlzO3JldHVybiBifSxjcmVhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmV4dGVuZCgpO2EuaW5pdC5hcHBseShhLGFyZ3VtZW50cyk7cmV0dXJuIGF9LGluaXQ6ZnVuY3Rpb24oKXt9LG1peEluOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYiBpbiBhKWEuaGFzT3duUHJvcGVydHkoYikmJih0aGlzW2JdPWFbYl0pO2EuaGFzT3duUHJvcGVydHkoInRvU3RyaW5nIikmJih0aGlzLnRvU3RyaW5nPWEudG9TdHJpbmcpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmluaXQucHJvdG90eXBlLmV4dGVuZCh0aGlzKX19LApCPWouV29yZEFycmF5PW0uZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGEsYil7YT10aGlzLndvcmRzPWF8fFtdO3RoaXMuc2lnQnl0ZXM9YiE9Yz9iOjQqYS5sZW5ndGh9LHRvU3RyaW5nOmZ1bmN0aW9uKGEpe3JldHVybihhfHx5KS5zdHJpbmdpZnkodGhpcyl9LGNvbmNhdDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLndvcmRzLGc9YS53b3JkcyxlPXRoaXMuc2lnQnl0ZXM7YT1hLnNpZ0J5dGVzO3RoaXMuY2xhbXAoKTtpZihlJTQpZm9yKHZhciBrPTA7azxhO2srKyliW2Uraz4+PjJdfD0oZ1trPj4+Ml0+Pj4yNC04KihrJTQpJjI1NSk8PDI0LTgqKChlK2spJTQpO2Vsc2UgaWYoNjU1MzU8Zy5sZW5ndGgpZm9yKGs9MDtrPGE7ays9NCliW2Uraz4+PjJdPWdbaz4+PjJdO2Vsc2UgYi5wdXNoLmFwcGx5KGIsZyk7dGhpcy5zaWdCeXRlcys9YTtyZXR1cm4gdGhpc30sY2xhbXA6ZnVuY3Rpb24oKXt2YXIgbj10aGlzLndvcmRzLGI9dGhpcy5zaWdCeXRlcztuW2I+Pj4yXSY9NDI5NDk2NzI5NTw8CjMyLTgqKGIlNCk7bi5sZW5ndGg9YS5jZWlsKGIvNCl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9bS5jbG9uZS5jYWxsKHRoaXMpO2Eud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKTtyZXR1cm4gYX0scmFuZG9tOmZ1bmN0aW9uKG4pe2Zvcih2YXIgYj1bXSxnPTA7ZzxuO2crPTQpYi5wdXNoKDQyOTQ5NjcyOTYqYS5yYW5kb20oKXwwKTtyZXR1cm4gbmV3IEIuaW5pdChiLG4pfX0pLHY9ZC5lbmM9e30seT12LkhleD17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBiPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgZz1bXSxlPTA7ZTxhO2UrKyl7dmFyIGs9YltlPj4+Ml0+Pj4yNC04KihlJTQpJjI1NTtnLnB1c2goKGs+Pj40KS50b1N0cmluZygxNikpO2cucHVzaCgoayYxNSkudG9TdHJpbmcoMTYpKX1yZXR1cm4gZy5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPWEubGVuZ3RoLGc9W10sZT0wO2U8YjtlKz0yKWdbZT4+PjNdfD1wYXJzZUludChhLnN1YnN0cihlLAoyKSwxNik8PDI0LTQqKGUlOCk7cmV0dXJuIG5ldyBCLmluaXQoZyxiLzIpfX0sRj12LkxhdGluMT17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBiPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgZz1bXSxlPTA7ZTxhO2UrKylnLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShiW2U+Pj4yXT4+PjI0LTgqKGUlNCkmMjU1KSk7cmV0dXJuIGcuam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1hLmxlbmd0aCxnPVtdLGU9MDtlPGI7ZSsrKWdbZT4+PjJdfD0oYS5jaGFyQ29kZUF0KGUpJjI1NSk8PDI0LTgqKGUlNCk7cmV0dXJuIG5ldyBCLmluaXQoZyxiKX19LGhhPXYuVXRmOD17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3RyeXtyZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGVzY2FwZShGLnN0cmluZ2lmeShhKSkpfWNhdGNoKGIpe3Rocm93IEVycm9yKCJNYWxmb3JtZWQgVVRGLTggZGF0YSIpO319LHBhcnNlOmZ1bmN0aW9uKGEpe3JldHVybiBGLnBhcnNlKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChhKSkpfX0sClo9ai5CdWZmZXJlZEJsb2NrQWxnb3JpdGhtPW0uZXh0ZW5kKHtyZXNldDpmdW5jdGlvbigpe3RoaXMuX2RhdGE9bmV3IEIuaW5pdDt0aGlzLl9uRGF0YUJ5dGVzPTB9LF9hcHBlbmQ6ZnVuY3Rpb24oYSl7InN0cmluZyI9PXR5cGVvZiBhJiYoYT1oYS5wYXJzZShhKSk7dGhpcy5fZGF0YS5jb25jYXQoYSk7dGhpcy5fbkRhdGFCeXRlcys9YS5zaWdCeXRlc30sX3Byb2Nlc3M6ZnVuY3Rpb24obil7dmFyIGI9dGhpcy5fZGF0YSxnPWIud29yZHMsZT1iLnNpZ0J5dGVzLGs9dGhpcy5ibG9ja1NpemUsbT1lLyg0KmspLG09bj9hLmNlaWwobSk6YS5tYXgoKG18MCktdGhpcy5fbWluQnVmZmVyU2l6ZSwwKTtuPW0qaztlPWEubWluKDQqbixlKTtpZihuKXtmb3IodmFyIGM9MDtjPG47Yys9ayl0aGlzLl9kb1Byb2Nlc3NCbG9jayhnLGMpO2M9Zy5zcGxpY2UoMCxuKTtiLnNpZ0J5dGVzLT1lfXJldHVybiBuZXcgQi5pbml0KGMsZSl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9bS5jbG9uZS5jYWxsKHRoaXMpOwphLl9kYXRhPXRoaXMuX2RhdGEuY2xvbmUoKTtyZXR1cm4gYX0sX21pbkJ1ZmZlclNpemU6MH0pO2ouSGFzaGVyPVouZXh0ZW5kKHtjZmc6bS5leHRlbmQoKSxpbml0OmZ1bmN0aW9uKGEpe3RoaXMuY2ZnPXRoaXMuY2ZnLmV4dGVuZChhKTt0aGlzLnJlc2V0KCl9LHJlc2V0OmZ1bmN0aW9uKCl7Wi5yZXNldC5jYWxsKHRoaXMpO3RoaXMuX2RvUmVzZXQoKX0sdXBkYXRlOmZ1bmN0aW9uKGEpe3RoaXMuX2FwcGVuZChhKTt0aGlzLl9wcm9jZXNzKCk7cmV0dXJuIHRoaXN9LGZpbmFsaXplOmZ1bmN0aW9uKGEpe2EmJnRoaXMuX2FwcGVuZChhKTtyZXR1cm4gdGhpcy5fZG9GaW5hbGl6ZSgpfSxibG9ja1NpemU6MTYsX2NyZWF0ZUhlbHBlcjpmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYixnKXtyZXR1cm4obmV3IGEuaW5pdChnKSkuZmluYWxpemUoYil9fSxfY3JlYXRlSG1hY0hlbHBlcjpmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYixnKXtyZXR1cm4obmV3IGlhLkhNQUMuaW5pdChhLApnKSkuZmluYWxpemUoYil9fX0pO3ZhciBpYT1kLmFsZ289e307cmV0dXJuIGR9KE1hdGgpOwooZnVuY3Rpb24oYSl7dmFyIGM9Q3J5cHRvSlMsZD1jLmxpYixqPWQuQmFzZSxmPWQuV29yZEFycmF5LGM9Yy54NjQ9e307Yy5Xb3JkPWouZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGEsYyl7dGhpcy5oaWdoPWE7dGhpcy5sb3c9Y319KTtjLldvcmRBcnJheT1qLmV4dGVuZCh7aW5pdDpmdW5jdGlvbihjLGQpe2M9dGhpcy53b3Jkcz1jfHxbXTt0aGlzLnNpZ0J5dGVzPWQhPWE/ZDo4KmMubGVuZ3RofSx0b1gzMjpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLndvcmRzLGM9YS5sZW5ndGgsZD1bXSxqPTA7ajxjO2orKyl7dmFyIEY9YVtqXTtkLnB1c2goRi5oaWdoKTtkLnB1c2goRi5sb3cpfXJldHVybiBmLmNyZWF0ZShkLHRoaXMuc2lnQnl0ZXMpfSxjbG9uZTpmdW5jdGlvbigpe2Zvcih2YXIgYT1qLmNsb25lLmNhbGwodGhpcyksYz1hLndvcmRzPXRoaXMud29yZHMuc2xpY2UoMCksZD1jLmxlbmd0aCxmPTA7ZjxkO2YrKyljW2ZdPWNbZl0uY2xvbmUoKTtyZXR1cm4gYX19KX0pKCk7CihmdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXtyZXR1cm4gZi5jcmVhdGUuYXBwbHkoZixhcmd1bWVudHMpfWZvcih2YXIgYz1DcnlwdG9KUyxkPWMubGliLkhhc2hlcixqPWMueDY0LGY9ai5Xb3JkLG09ai5Xb3JkQXJyYXksaj1jLmFsZ28sQj1bYSgxMTE2MzUyNDA4LDM2MDk3Njc0NTgpLGEoMTg5OTQ0NzQ0MSw2MDI4OTE3MjUpLGEoMzA0OTMyMzQ3MSwzOTY0NDg0Mzk5KSxhKDM5MjEwMDk1NzMsMjE3MzI5NTU0OCksYSg5NjE5ODcxNjMsNDA4MTYyODQ3MiksYSgxNTA4OTcwOTkzLDMwNTM4MzQyNjUpLGEoMjQ1MzYzNTc0OCwyOTM3NjcxNTc5KSxhKDI4NzA3NjMyMjEsMzY2NDYwOTU2MCksYSgzNjI0MzgxMDgwLDI3MzQ4ODMzOTQpLGEoMzEwNTk4NDAxLDExNjQ5OTY1NDIpLGEoNjA3MjI1Mjc4LDEzMjM2MTA3NjQpLGEoMTQyNjg4MTk4NywzNTkwMzA0OTk0KSxhKDE5MjUwNzgzODgsNDA2ODE4MjM4MyksYSgyMTYyMDc4MjA2LDk5MTMzNjExMyksYSgyNjE0ODg4MTAzLDYzMzgwMzMxNyksCmEoMzI0ODIyMjU4MCwzNDc5Nzc0ODY4KSxhKDM4MzUzOTA0MDEsMjY2NjYxMzQ1OCksYSg0MDIyMjI0Nzc0LDk0NDcxMTEzOSksYSgyNjQzNDcwNzgsMjM0MTI2Mjc3MyksYSg2MDQ4MDc2MjgsMjAwNzgwMDkzMyksYSg3NzAyNTU5ODMsMTQ5NTk5MDkwMSksYSgxMjQ5MTUwMTIyLDE4NTY0MzEyMzUpLGEoMTU1NTA4MTY5MiwzMTc1MjE4MTMyKSxhKDE5OTYwNjQ5ODYsMjE5ODk1MDgzNyksYSgyNTU0MjIwODgyLDM5OTk3MTkzMzkpLGEoMjgyMTgzNDM0OSw3NjY3ODQwMTYpLGEoMjk1Mjk5NjgwOCwyNTY2NTk0ODc5KSxhKDMyMTAzMTM2NzEsMzIwMzMzNzk1NiksYSgzMzM2NTcxODkxLDEwMzQ0NTcwMjYpLGEoMzU4NDUyODcxMSwyNDY2OTQ4OTAxKSxhKDExMzkyNjk5MywzNzU4MzI2MzgzKSxhKDMzODI0MTg5NSwxNjg3MTc5MzYpLGEoNjY2MzA3MjA1LDExODgxNzk5NjQpLGEoNzczNTI5OTEyLDE1NDYwNDU3MzQpLGEoMTI5NDc1NzM3MiwxNTIyODA1NDg1KSxhKDEzOTYxODIyOTEsCjI2NDM4MzM4MjMpLGEoMTY5NTE4MzcwMCwyMzQzNTI3MzkwKSxhKDE5ODY2NjEwNTEsMTAxNDQ3NzQ4MCksYSgyMTc3MDI2MzUwLDEyMDY3NTkxNDIpLGEoMjQ1Njk1NjAzNywzNDQwNzc2MjcpLGEoMjczMDQ4NTkyMSwxMjkwODYzNDYwKSxhKDI4MjAzMDI0MTEsMzE1ODQ1NDI3MyksYSgzMjU5NzMwODAwLDM1MDU5NTI2NTcpLGEoMzM0NTc2NDc3MSwxMDYyMTcwMDgpLGEoMzUxNjA2NTgxNywzNjA2MDA4MzQ0KSxhKDM2MDAzNTI4MDQsMTQzMjcyNTc3NiksYSg0MDk0NTcxOTA5LDE0NjcwMzE1OTQpLGEoMjc1NDIzMzQ0LDg1MTE2OTcyMCksYSg0MzAyMjc3MzQsMzEwMDgyMzc1MiksYSg1MDY5NDg2MTYsMTM2MzI1ODE5NSksYSg2NTkwNjA1NTYsMzc1MDY4NTU5MyksYSg4ODM5OTc4NzcsMzc4NTA1MDI4MCksYSg5NTgxMzk1NzEsMzMxODMwNzQyNyksYSgxMzIyODIyMjE4LDM4MTI3MjM0MDMpLGEoMTUzNzAwMjA2MywyMDAzMDM0OTk1KSxhKDE3NDc4NzM3NzksMzYwMjAzNjg5OSksCmEoMTk1NTU2MjIyMiwxNTc1OTkwMDEyKSxhKDIwMjQxMDQ4MTUsMTEyNTU5MjkyOCksYSgyMjI3NzMwNDUyLDI3MTY5MDQzMDYpLGEoMjM2MTg1MjQyNCw0NDI3NzYwNDQpLGEoMjQyODQzNjQ3NCw1OTM2OTgzNDQpLGEoMjc1NjczNDE4NywzNzMzMTEwMjQ5KSxhKDMyMDQwMzE0NzksMjk5OTM1MTU3MyksYSgzMzI5MzI1Mjk4LDM4MTU5MjA0MjcpLGEoMzM5MTU2OTYxNCwzOTI4MzgzOTAwKSxhKDM1MTUyNjcyNzEsNTY2MjgwNzExKSxhKDM5NDAxODc2MDYsMzQ1NDA2OTUzNCksYSg0MTE4NjMwMjcxLDQwMDAyMzk5OTIpLGEoMTE2NDE4NDc0LDE5MTQxMzg1NTQpLGEoMTc0MjkyNDIxLDI3MzEwNTUyNzApLGEoMjg5MzgwMzU2LDMyMDM5OTMwMDYpLGEoNDYwMzkzMjY5LDMyMDYyMDMxNSksYSg2ODU0NzE3MzMsNTg3NDk2ODM2KSxhKDg1MjE0Mjk3MSwxMDg2NzkyODUxKSxhKDEwMTcwMzYyOTgsMzY1NTQzMTAwKSxhKDExMjYwMDA1ODAsMjYxODI5NzY3NiksYSgxMjg4MDMzNDcwLAozNDA5ODU1MTU4KSxhKDE1MDE1MDU5NDgsNDIzNDUwOTg2NiksYSgxNjA3MTY3OTE1LDk4NzE2NzQ2OCksYSgxODE2NDAyMzE2LDEyNDYxODk1OTEpXSx2PVtdLHk9MDs4MD55O3krKyl2W3ldPWEoKTtqPWouU0hBNTEyPWQuZXh0ZW5kKHtfZG9SZXNldDpmdW5jdGlvbigpe3RoaXMuX2hhc2g9bmV3IG0uaW5pdChbbmV3IGYuaW5pdCgxNzc5MDMzNzAzLDQwODkyMzU3MjApLG5ldyBmLmluaXQoMzE0NDEzNDI3NywyMjI3ODczNTk1KSxuZXcgZi5pbml0KDEwMTM5MDQyNDIsNDI3MTE3NTcyMyksbmV3IGYuaW5pdCgyNzczNDgwNzYyLDE1OTU3NTAxMjkpLG5ldyBmLmluaXQoMTM1OTg5MzExOSwyOTE3NTY1MTM3KSxuZXcgZi5pbml0KDI2MDA4MjI5MjQsNzI1NTExMTk5KSxuZXcgZi5pbml0KDUyODczNDYzNSw0MjE1Mzg5NTQ3KSxuZXcgZi5pbml0KDE1NDE0NTkyMjUsMzI3MDMzMjA5KV0pfSxfZG9Qcm9jZXNzQmxvY2s6ZnVuY3Rpb24oYSxjKXtmb3IodmFyIGQ9dGhpcy5faGFzaC53b3JkcywKZj1kWzBdLGo9ZFsxXSxiPWRbMl0sZz1kWzNdLGU9ZFs0XSxrPWRbNV0sbT1kWzZdLGQ9ZFs3XSx5PWYuaGlnaCxNPWYubG93LCQ9ai5oaWdoLE49ai5sb3csYWE9Yi5oaWdoLE89Yi5sb3csYmE9Zy5oaWdoLFA9Zy5sb3csY2E9ZS5oaWdoLFE9ZS5sb3csZGE9ay5oaWdoLFI9ay5sb3csZWE9bS5oaWdoLFM9bS5sb3csZmE9ZC5oaWdoLFQ9ZC5sb3cscz15LHA9TSxHPSQsRD1OLEg9YWEsRT1PLFc9YmEsST1QLHQ9Y2EscT1RLFU9ZGEsSj1SLFY9ZWEsSz1TLFg9ZmEsTD1ULHU9MDs4MD51O3UrKyl7dmFyIHo9dlt1XTtpZigxNj51KXZhciByPXouaGlnaD1hW2MrMip1XXwwLGg9ei5sb3c9YVtjKzIqdSsxXXwwO2Vsc2V7dmFyIHI9dlt1LTE1XSxoPXIuaGlnaCx3PXIubG93LHI9KGg+Pj4xfHc8PDMxKV4oaD4+Pjh8dzw8MjQpXmg+Pj43LHc9KHc+Pj4xfGg8PDMxKV4odz4+Pjh8aDw8MjQpXih3Pj4+N3xoPDwyNSksQz12W3UtMl0saD1DLmhpZ2gsbD1DLmxvdyxDPShoPj4+MTl8bDw8CjEzKV4oaDw8M3xsPj4+MjkpXmg+Pj42LGw9KGw+Pj4xOXxoPDwxMyleKGw8PDN8aD4+PjI5KV4obD4+PjZ8aDw8MjYpLGg9dlt1LTddLFk9aC5oaWdoLEE9dlt1LTE2XSx4PUEuaGlnaCxBPUEubG93LGg9dytoLmxvdyxyPXIrWSsoaD4+PjA8dz4+PjA/MTowKSxoPWgrbCxyPXIrQysoaD4+PjA8bD4+PjA/MTowKSxoPWgrQSxyPXIreCsoaD4+PjA8QT4+PjA/MTowKTt6LmhpZ2g9cjt6Lmxvdz1ofXZhciBZPXQmVV5+dCZWLEE9cSZKXn5xJkssej1zJkdecyZIXkcmSCxqYT1wJkRecCZFXkQmRSx3PShzPj4+Mjh8cDw8NCleKHM8PDMwfHA+Pj4yKV4oczw8MjV8cD4+PjcpLEM9KHA+Pj4yOHxzPDw0KV4ocDw8MzB8cz4+PjIpXihwPDwyNXxzPj4+NyksbD1CW3VdLGthPWwuaGlnaCxnYT1sLmxvdyxsPUwrKChxPj4+MTR8dDw8MTgpXihxPj4+MTh8dDw8MTQpXihxPDwyM3x0Pj4+OSkpLHg9WCsoKHQ+Pj4xNHxxPDwxOCleKHQ+Pj4xOHxxPDwxNCleKHQ8PDIzfHE+Pj45KSkrKGw+Pj4wPApMPj4+MD8xOjApLGw9bCtBLHg9eCtZKyhsPj4+MDxBPj4+MD8xOjApLGw9bCtnYSx4PXgra2ErKGw+Pj4wPGdhPj4+MD8xOjApLGw9bCtoLHg9eCtyKyhsPj4+MDxoPj4+MD8xOjApLGg9QytqYSx6PXcreisoaD4+PjA8Qz4+PjA/MTowKSxYPVYsTD1LLFY9VSxLPUosVT10LEo9cSxxPUkrbHwwLHQ9Vyt4KyhxPj4+MDxJPj4+MD8xOjApfDAsVz1ILEk9RSxIPUcsRT1ELEc9cyxEPXAscD1sK2h8MCxzPXgreisocD4+PjA8bD4+PjA/MTowKXwwfU09Zi5sb3c9TStwO2YuaGlnaD15K3MrKE0+Pj4wPHA+Pj4wPzE6MCk7Tj1qLmxvdz1OK0Q7ai5oaWdoPSQrRysoTj4+PjA8RD4+PjA/MTowKTtPPWIubG93PU8rRTtiLmhpZ2g9YWErSCsoTz4+PjA8RT4+PjA/MTowKTtQPWcubG93PVArSTtnLmhpZ2g9YmErVysoUD4+PjA8ST4+PjA/MTowKTtRPWUubG93PVErcTtlLmhpZ2g9Y2ErdCsoUT4+PjA8cT4+PjA/MTowKTtSPWsubG93PVIrSjtrLmhpZ2g9ZGErVSsoUj4+PjA8Sj4+PjA/MTowKTsKUz1tLmxvdz1TK0s7bS5oaWdoPWVhK1YrKFM+Pj4wPEs+Pj4wPzE6MCk7VD1kLmxvdz1UK0w7ZC5oaWdoPWZhK1grKFQ+Pj4wPEw+Pj4wPzE6MCl9LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5fZGF0YSxjPWEud29yZHMsZD04KnRoaXMuX25EYXRhQnl0ZXMsZj04KmEuc2lnQnl0ZXM7Y1tmPj4+NV18PTEyODw8MjQtZiUzMjtjWyhmKzEyOD4+PjEwPDw1KSszMF09TWF0aC5mbG9vcihkLzQyOTQ5NjcyOTYpO2NbKGYrMTI4Pj4+MTA8PDUpKzMxXT1kO2Euc2lnQnl0ZXM9NCpjLmxlbmd0aDt0aGlzLl9wcm9jZXNzKCk7cmV0dXJuIHRoaXMuX2hhc2gudG9YMzIoKX0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgYT1kLmNsb25lLmNhbGwodGhpcyk7YS5faGFzaD10aGlzLl9oYXNoLmNsb25lKCk7cmV0dXJuIGF9LGJsb2NrU2l6ZTozMn0pO2MuU0hBNTEyPWQuX2NyZWF0ZUhlbHBlcihqKTtjLkhtYWNTSEE1MTI9ZC5fY3JlYXRlSG1hY0hlbHBlcihqKX0pKCk7CihmdW5jdGlvbigpe3ZhciBhPUNyeXB0b0pTLGM9YS54NjQsZD1jLldvcmQsaj1jLldvcmRBcnJheSxjPWEuYWxnbyxmPWMuU0hBNTEyLGM9Yy5TSEEzODQ9Zi5leHRlbmQoe19kb1Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5faGFzaD1uZXcgai5pbml0KFtuZXcgZC5pbml0KDM0MTgwNzAzNjUsMzIzODM3MTAzMiksbmV3IGQuaW5pdCgxNjU0MjcwMjUwLDkxNDE1MDY2MyksbmV3IGQuaW5pdCgyNDM4NTI5MzcwLDgxMjcwMjk5OSksbmV3IGQuaW5pdCgzNTU0NjIzNjAsNDE0NDkxMjY5NyksbmV3IGQuaW5pdCgxNzMxNDA1NDE1LDQyOTA3NzU4NTcpLG5ldyBkLmluaXQoMjM5NDE4MDIzMSwxNzUwNjAzMDI1KSxuZXcgZC5pbml0KDM2NzUwMDg1MjUsMTY5NDA3NjgzOSksbmV3IGQuaW5pdCgxMjAzMDYyODEzLDMyMDQwNzU0MjgpXSl9LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIGE9Zi5fZG9GaW5hbGl6ZS5jYWxsKHRoaXMpO2Euc2lnQnl0ZXMtPTE2O3JldHVybiBhfX0pO2EuU0hBMzg0PQpmLl9jcmVhdGVIZWxwZXIoYyk7YS5IbWFjU0hBMzg0PWYuX2NyZWF0ZUhtYWNIZWxwZXIoYyl9KSgpOwo=',
'/libs/crypto_js/rollups/sha512.js':'LyoKQ3J5cHRvSlMgdjMuMS4yCmNvZGUuZ29vZ2xlLmNvbS9wL2NyeXB0by1qcwooYykgMjAwOS0yMDEzIGJ5IEplZmYgTW90dC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KY29kZS5nb29nbGUuY29tL3AvY3J5cHRvLWpzL3dpa2kvTGljZW5zZQoqLwp2YXIgQ3J5cHRvSlM9Q3J5cHRvSlN8fGZ1bmN0aW9uKGEsbSl7dmFyIHI9e30sZj1yLmxpYj17fSxnPWZ1bmN0aW9uKCl7fSxsPWYuQmFzZT17ZXh0ZW5kOmZ1bmN0aW9uKGEpe2cucHJvdG90eXBlPXRoaXM7dmFyIGI9bmV3IGc7YSYmYi5taXhJbihhKTtiLmhhc093blByb3BlcnR5KCJpbml0Iil8fChiLmluaXQ9ZnVuY3Rpb24oKXtiLiRzdXBlci5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pO2IuaW5pdC5wcm90b3R5cGU9YjtiLiRzdXBlcj10aGlzO3JldHVybiBifSxjcmVhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmV4dGVuZCgpO2EuaW5pdC5hcHBseShhLGFyZ3VtZW50cyk7cmV0dXJuIGF9LGluaXQ6ZnVuY3Rpb24oKXt9LG1peEluOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYiBpbiBhKWEuaGFzT3duUHJvcGVydHkoYikmJih0aGlzW2JdPWFbYl0pO2EuaGFzT3duUHJvcGVydHkoInRvU3RyaW5nIikmJih0aGlzLnRvU3RyaW5nPWEudG9TdHJpbmcpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmluaXQucHJvdG90eXBlLmV4dGVuZCh0aGlzKX19LApwPWYuV29yZEFycmF5PWwuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGEsYil7YT10aGlzLndvcmRzPWF8fFtdO3RoaXMuc2lnQnl0ZXM9YiE9bT9iOjQqYS5sZW5ndGh9LHRvU3RyaW5nOmZ1bmN0aW9uKGEpe3JldHVybihhfHxxKS5zdHJpbmdpZnkodGhpcyl9LGNvbmNhdDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLndvcmRzLGQ9YS53b3JkcyxjPXRoaXMuc2lnQnl0ZXM7YT1hLnNpZ0J5dGVzO3RoaXMuY2xhbXAoKTtpZihjJTQpZm9yKHZhciBqPTA7ajxhO2orKyliW2Mraj4+PjJdfD0oZFtqPj4+Ml0+Pj4yNC04KihqJTQpJjI1NSk8PDI0LTgqKChjK2opJTQpO2Vsc2UgaWYoNjU1MzU8ZC5sZW5ndGgpZm9yKGo9MDtqPGE7ais9NCliW2Mraj4+PjJdPWRbaj4+PjJdO2Vsc2UgYi5wdXNoLmFwcGx5KGIsZCk7dGhpcy5zaWdCeXRlcys9YTtyZXR1cm4gdGhpc30sY2xhbXA6ZnVuY3Rpb24oKXt2YXIgbj10aGlzLndvcmRzLGI9dGhpcy5zaWdCeXRlcztuW2I+Pj4yXSY9NDI5NDk2NzI5NTw8CjMyLTgqKGIlNCk7bi5sZW5ndGg9YS5jZWlsKGIvNCl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9bC5jbG9uZS5jYWxsKHRoaXMpO2Eud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKTtyZXR1cm4gYX0scmFuZG9tOmZ1bmN0aW9uKG4pe2Zvcih2YXIgYj1bXSxkPTA7ZDxuO2QrPTQpYi5wdXNoKDQyOTQ5NjcyOTYqYS5yYW5kb20oKXwwKTtyZXR1cm4gbmV3IHAuaW5pdChiLG4pfX0pLHk9ci5lbmM9e30scT15LkhleD17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBiPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgZD1bXSxjPTA7YzxhO2MrKyl7dmFyIGo9YltjPj4+Ml0+Pj4yNC04KihjJTQpJjI1NTtkLnB1c2goKGo+Pj40KS50b1N0cmluZygxNikpO2QucHVzaCgoaiYxNSkudG9TdHJpbmcoMTYpKX1yZXR1cm4gZC5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPWEubGVuZ3RoLGQ9W10sYz0wO2M8YjtjKz0yKWRbYz4+PjNdfD1wYXJzZUludChhLnN1YnN0cihjLAoyKSwxNik8PDI0LTQqKGMlOCk7cmV0dXJuIG5ldyBwLmluaXQoZCxiLzIpfX0sRz15LkxhdGluMT17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3ZhciBiPWEud29yZHM7YT1hLnNpZ0J5dGVzO2Zvcih2YXIgZD1bXSxjPTA7YzxhO2MrKylkLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShiW2M+Pj4yXT4+PjI0LTgqKGMlNCkmMjU1KSk7cmV0dXJuIGQuam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1hLmxlbmd0aCxkPVtdLGM9MDtjPGI7YysrKWRbYz4+PjJdfD0oYS5jaGFyQ29kZUF0KGMpJjI1NSk8PDI0LTgqKGMlNCk7cmV0dXJuIG5ldyBwLmluaXQoZCxiKX19LGZhPXkuVXRmOD17c3RyaW5naWZ5OmZ1bmN0aW9uKGEpe3RyeXtyZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGVzY2FwZShHLnN0cmluZ2lmeShhKSkpfWNhdGNoKGIpe3Rocm93IEVycm9yKCJNYWxmb3JtZWQgVVRGLTggZGF0YSIpO319LHBhcnNlOmZ1bmN0aW9uKGEpe3JldHVybiBHLnBhcnNlKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChhKSkpfX0sCmg9Zi5CdWZmZXJlZEJsb2NrQWxnb3JpdGhtPWwuZXh0ZW5kKHtyZXNldDpmdW5jdGlvbigpe3RoaXMuX2RhdGE9bmV3IHAuaW5pdDt0aGlzLl9uRGF0YUJ5dGVzPTB9LF9hcHBlbmQ6ZnVuY3Rpb24oYSl7InN0cmluZyI9PXR5cGVvZiBhJiYoYT1mYS5wYXJzZShhKSk7dGhpcy5fZGF0YS5jb25jYXQoYSk7dGhpcy5fbkRhdGFCeXRlcys9YS5zaWdCeXRlc30sX3Byb2Nlc3M6ZnVuY3Rpb24obil7dmFyIGI9dGhpcy5fZGF0YSxkPWIud29yZHMsYz1iLnNpZ0J5dGVzLGo9dGhpcy5ibG9ja1NpemUsbD1jLyg0KmopLGw9bj9hLmNlaWwobCk6YS5tYXgoKGx8MCktdGhpcy5fbWluQnVmZmVyU2l6ZSwwKTtuPWwqajtjPWEubWluKDQqbixjKTtpZihuKXtmb3IodmFyIGg9MDtoPG47aCs9ail0aGlzLl9kb1Byb2Nlc3NCbG9jayhkLGgpO2g9ZC5zcGxpY2UoMCxuKTtiLnNpZ0J5dGVzLT1jfXJldHVybiBuZXcgcC5pbml0KGgsYyl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9bC5jbG9uZS5jYWxsKHRoaXMpOwphLl9kYXRhPXRoaXMuX2RhdGEuY2xvbmUoKTtyZXR1cm4gYX0sX21pbkJ1ZmZlclNpemU6MH0pO2YuSGFzaGVyPWguZXh0ZW5kKHtjZmc6bC5leHRlbmQoKSxpbml0OmZ1bmN0aW9uKGEpe3RoaXMuY2ZnPXRoaXMuY2ZnLmV4dGVuZChhKTt0aGlzLnJlc2V0KCl9LHJlc2V0OmZ1bmN0aW9uKCl7aC5yZXNldC5jYWxsKHRoaXMpO3RoaXMuX2RvUmVzZXQoKX0sdXBkYXRlOmZ1bmN0aW9uKGEpe3RoaXMuX2FwcGVuZChhKTt0aGlzLl9wcm9jZXNzKCk7cmV0dXJuIHRoaXN9LGZpbmFsaXplOmZ1bmN0aW9uKGEpe2EmJnRoaXMuX2FwcGVuZChhKTtyZXR1cm4gdGhpcy5fZG9GaW5hbGl6ZSgpfSxibG9ja1NpemU6MTYsX2NyZWF0ZUhlbHBlcjpmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYixkKXtyZXR1cm4obmV3IGEuaW5pdChkKSkuZmluYWxpemUoYil9fSxfY3JlYXRlSG1hY0hlbHBlcjpmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYixkKXtyZXR1cm4obmV3IGdhLkhNQUMuaW5pdChhLApkKSkuZmluYWxpemUoYil9fX0pO3ZhciBnYT1yLmFsZ289e307cmV0dXJuIHJ9KE1hdGgpOwooZnVuY3Rpb24oYSl7dmFyIG09Q3J5cHRvSlMscj1tLmxpYixmPXIuQmFzZSxnPXIuV29yZEFycmF5LG09bS54NjQ9e307bS5Xb3JkPWYuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGEscCl7dGhpcy5oaWdoPWE7dGhpcy5sb3c9cH19KTttLldvcmRBcnJheT1mLmV4dGVuZCh7aW5pdDpmdW5jdGlvbihsLHApe2w9dGhpcy53b3Jkcz1sfHxbXTt0aGlzLnNpZ0J5dGVzPXAhPWE/cDo4KmwubGVuZ3RofSx0b1gzMjpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLndvcmRzLHA9YS5sZW5ndGgsZj1bXSxxPTA7cTxwO3ErKyl7dmFyIEc9YVtxXTtmLnB1c2goRy5oaWdoKTtmLnB1c2goRy5sb3cpfXJldHVybiBnLmNyZWF0ZShmLHRoaXMuc2lnQnl0ZXMpfSxjbG9uZTpmdW5jdGlvbigpe2Zvcih2YXIgYT1mLmNsb25lLmNhbGwodGhpcykscD1hLndvcmRzPXRoaXMud29yZHMuc2xpY2UoMCksZz1wLmxlbmd0aCxxPTA7cTxnO3ErKylwW3FdPXBbcV0uY2xvbmUoKTtyZXR1cm4gYX19KX0pKCk7CihmdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXtyZXR1cm4gZy5jcmVhdGUuYXBwbHkoZyxhcmd1bWVudHMpfWZvcih2YXIgbT1DcnlwdG9KUyxyPW0ubGliLkhhc2hlcixmPW0ueDY0LGc9Zi5Xb3JkLGw9Zi5Xb3JkQXJyYXksZj1tLmFsZ28scD1bYSgxMTE2MzUyNDA4LDM2MDk3Njc0NTgpLGEoMTg5OTQ0NzQ0MSw2MDI4OTE3MjUpLGEoMzA0OTMyMzQ3MSwzOTY0NDg0Mzk5KSxhKDM5MjEwMDk1NzMsMjE3MzI5NTU0OCksYSg5NjE5ODcxNjMsNDA4MTYyODQ3MiksYSgxNTA4OTcwOTkzLDMwNTM4MzQyNjUpLGEoMjQ1MzYzNTc0OCwyOTM3NjcxNTc5KSxhKDI4NzA3NjMyMjEsMzY2NDYwOTU2MCksYSgzNjI0MzgxMDgwLDI3MzQ4ODMzOTQpLGEoMzEwNTk4NDAxLDExNjQ5OTY1NDIpLGEoNjA3MjI1Mjc4LDEzMjM2MTA3NjQpLGEoMTQyNjg4MTk4NywzNTkwMzA0OTk0KSxhKDE5MjUwNzgzODgsNDA2ODE4MjM4MyksYSgyMTYyMDc4MjA2LDk5MTMzNjExMyksYSgyNjE0ODg4MTAzLDYzMzgwMzMxNyksCmEoMzI0ODIyMjU4MCwzNDc5Nzc0ODY4KSxhKDM4MzUzOTA0MDEsMjY2NjYxMzQ1OCksYSg0MDIyMjI0Nzc0LDk0NDcxMTEzOSksYSgyNjQzNDcwNzgsMjM0MTI2Mjc3MyksYSg2MDQ4MDc2MjgsMjAwNzgwMDkzMyksYSg3NzAyNTU5ODMsMTQ5NTk5MDkwMSksYSgxMjQ5MTUwMTIyLDE4NTY0MzEyMzUpLGEoMTU1NTA4MTY5MiwzMTc1MjE4MTMyKSxhKDE5OTYwNjQ5ODYsMjE5ODk1MDgzNyksYSgyNTU0MjIwODgyLDM5OTk3MTkzMzkpLGEoMjgyMTgzNDM0OSw3NjY3ODQwMTYpLGEoMjk1Mjk5NjgwOCwyNTY2NTk0ODc5KSxhKDMyMTAzMTM2NzEsMzIwMzMzNzk1NiksYSgzMzM2NTcxODkxLDEwMzQ0NTcwMjYpLGEoMzU4NDUyODcxMSwyNDY2OTQ4OTAxKSxhKDExMzkyNjk5MywzNzU4MzI2MzgzKSxhKDMzODI0MTg5NSwxNjg3MTc5MzYpLGEoNjY2MzA3MjA1LDExODgxNzk5NjQpLGEoNzczNTI5OTEyLDE1NDYwNDU3MzQpLGEoMTI5NDc1NzM3MiwxNTIyODA1NDg1KSxhKDEzOTYxODIyOTEsCjI2NDM4MzM4MjMpLGEoMTY5NTE4MzcwMCwyMzQzNTI3MzkwKSxhKDE5ODY2NjEwNTEsMTAxNDQ3NzQ4MCksYSgyMTc3MDI2MzUwLDEyMDY3NTkxNDIpLGEoMjQ1Njk1NjAzNywzNDQwNzc2MjcpLGEoMjczMDQ4NTkyMSwxMjkwODYzNDYwKSxhKDI4MjAzMDI0MTEsMzE1ODQ1NDI3MyksYSgzMjU5NzMwODAwLDM1MDU5NTI2NTcpLGEoMzM0NTc2NDc3MSwxMDYyMTcwMDgpLGEoMzUxNjA2NTgxNywzNjA2MDA4MzQ0KSxhKDM2MDAzNTI4MDQsMTQzMjcyNTc3NiksYSg0MDk0NTcxOTA5LDE0NjcwMzE1OTQpLGEoMjc1NDIzMzQ0LDg1MTE2OTcyMCksYSg0MzAyMjc3MzQsMzEwMDgyMzc1MiksYSg1MDY5NDg2MTYsMTM2MzI1ODE5NSksYSg2NTkwNjA1NTYsMzc1MDY4NTU5MyksYSg4ODM5OTc4NzcsMzc4NTA1MDI4MCksYSg5NTgxMzk1NzEsMzMxODMwNzQyNyksYSgxMzIyODIyMjE4LDM4MTI3MjM0MDMpLGEoMTUzNzAwMjA2MywyMDAzMDM0OTk1KSxhKDE3NDc4NzM3NzksMzYwMjAzNjg5OSksCmEoMTk1NTU2MjIyMiwxNTc1OTkwMDEyKSxhKDIwMjQxMDQ4MTUsMTEyNTU5MjkyOCksYSgyMjI3NzMwNDUyLDI3MTY5MDQzMDYpLGEoMjM2MTg1MjQyNCw0NDI3NzYwNDQpLGEoMjQyODQzNjQ3NCw1OTM2OTgzNDQpLGEoMjc1NjczNDE4NywzNzMzMTEwMjQ5KSxhKDMyMDQwMzE0NzksMjk5OTM1MTU3MyksYSgzMzI5MzI1Mjk4LDM4MTU5MjA0MjcpLGEoMzM5MTU2OTYxNCwzOTI4MzgzOTAwKSxhKDM1MTUyNjcyNzEsNTY2MjgwNzExKSxhKDM5NDAxODc2MDYsMzQ1NDA2OTUzNCksYSg0MTE4NjMwMjcxLDQwMDAyMzk5OTIpLGEoMTE2NDE4NDc0LDE5MTQxMzg1NTQpLGEoMTc0MjkyNDIxLDI3MzEwNTUyNzApLGEoMjg5MzgwMzU2LDMyMDM5OTMwMDYpLGEoNDYwMzkzMjY5LDMyMDYyMDMxNSksYSg2ODU0NzE3MzMsNTg3NDk2ODM2KSxhKDg1MjE0Mjk3MSwxMDg2NzkyODUxKSxhKDEwMTcwMzYyOTgsMzY1NTQzMTAwKSxhKDExMjYwMDA1ODAsMjYxODI5NzY3NiksYSgxMjg4MDMzNDcwLAozNDA5ODU1MTU4KSxhKDE1MDE1MDU5NDgsNDIzNDUwOTg2NiksYSgxNjA3MTY3OTE1LDk4NzE2NzQ2OCksYSgxODE2NDAyMzE2LDEyNDYxODk1OTEpXSx5PVtdLHE9MDs4MD5xO3ErKyl5W3FdPWEoKTtmPWYuU0hBNTEyPXIuZXh0ZW5kKHtfZG9SZXNldDpmdW5jdGlvbigpe3RoaXMuX2hhc2g9bmV3IGwuaW5pdChbbmV3IGcuaW5pdCgxNzc5MDMzNzAzLDQwODkyMzU3MjApLG5ldyBnLmluaXQoMzE0NDEzNDI3NywyMjI3ODczNTk1KSxuZXcgZy5pbml0KDEwMTM5MDQyNDIsNDI3MTE3NTcyMyksbmV3IGcuaW5pdCgyNzczNDgwNzYyLDE1OTU3NTAxMjkpLG5ldyBnLmluaXQoMTM1OTg5MzExOSwyOTE3NTY1MTM3KSxuZXcgZy5pbml0KDI2MDA4MjI5MjQsNzI1NTExMTk5KSxuZXcgZy5pbml0KDUyODczNDYzNSw0MjE1Mzg5NTQ3KSxuZXcgZy5pbml0KDE1NDE0NTkyMjUsMzI3MDMzMjA5KV0pfSxfZG9Qcm9jZXNzQmxvY2s6ZnVuY3Rpb24oYSxmKXtmb3IodmFyIGg9dGhpcy5faGFzaC53b3JkcywKZz1oWzBdLG49aFsxXSxiPWhbMl0sZD1oWzNdLGM9aFs0XSxqPWhbNV0sbD1oWzZdLGg9aFs3XSxxPWcuaGlnaCxtPWcubG93LHI9bi5oaWdoLE49bi5sb3csWj1iLmhpZ2gsTz1iLmxvdywkPWQuaGlnaCxQPWQubG93LGFhPWMuaGlnaCxRPWMubG93LGJhPWouaGlnaCxSPWoubG93LGNhPWwuaGlnaCxTPWwubG93LGRhPWguaGlnaCxUPWgubG93LHY9cSxzPW0sSD1yLEU9TixJPVosRj1PLFc9JCxKPVAsdz1hYSx0PVEsVT1iYSxLPVIsVj1jYSxMPVMsWD1kYSxNPVQseD0wOzgwPng7eCsrKXt2YXIgQj15W3hdO2lmKDE2PngpdmFyIHU9Qi5oaWdoPWFbZisyKnhdfDAsZT1CLmxvdz1hW2YrMip4KzFdfDA7ZWxzZXt2YXIgdT15W3gtMTVdLGU9dS5oaWdoLHo9dS5sb3csdT0oZT4+PjF8ejw8MzEpXihlPj4+OHx6PDwyNCleZT4+Pjcsej0oej4+PjF8ZTw8MzEpXih6Pj4+OHxlPDwyNCleKHo+Pj43fGU8PDI1KSxEPXlbeC0yXSxlPUQuaGlnaCxrPUQubG93LEQ9KGU+Pj4xOXxrPDwxMyleCihlPDwzfGs+Pj4yOSleZT4+PjYsaz0oaz4+PjE5fGU8PDEzKV4oazw8M3xlPj4+MjkpXihrPj4+NnxlPDwyNiksZT15W3gtN10sWT1lLmhpZ2gsQz15W3gtMTZdLEE9Qy5oaWdoLEM9Qy5sb3csZT16K2UubG93LHU9dStZKyhlPj4+MDx6Pj4+MD8xOjApLGU9ZStrLHU9dStEKyhlPj4+MDxrPj4+MD8xOjApLGU9ZStDLHU9dStBKyhlPj4+MDxDPj4+MD8xOjApO0IuaGlnaD11O0IubG93PWV9dmFyIFk9dyZVXn53JlYsQz10JktefnQmTCxCPXYmSF52JkleSCZJLGhhPXMmRV5zJkZeRSZGLHo9KHY+Pj4yOHxzPDw0KV4odjw8MzB8cz4+PjIpXih2PDwyNXxzPj4+NyksRD0ocz4+PjI4fHY8PDQpXihzPDwzMHx2Pj4+MileKHM8PDI1fHY+Pj43KSxrPXBbeF0saWE9ay5oaWdoLGVhPWsubG93LGs9TSsoKHQ+Pj4xNHx3PDwxOCleKHQ+Pj4xOHx3PDwxNCleKHQ8PDIzfHc+Pj45KSksQT1YKygodz4+PjE0fHQ8PDE4KV4odz4+PjE4fHQ8PDE0KV4odzw8MjN8dD4+PjkpKSsoaz4+PjA8TT4+PgowPzE6MCksaz1rK0MsQT1BK1krKGs+Pj4wPEM+Pj4wPzE6MCksaz1rK2VhLEE9QStpYSsoaz4+PjA8ZWE+Pj4wPzE6MCksaz1rK2UsQT1BK3UrKGs+Pj4wPGU+Pj4wPzE6MCksZT1EK2hhLEI9eitCKyhlPj4+MDxEPj4+MD8xOjApLFg9VixNPUwsVj1VLEw9SyxVPXcsSz10LHQ9SitrfDAsdz1XK0ErKHQ+Pj4wPEo+Pj4wPzE6MCl8MCxXPUksSj1GLEk9SCxGPUUsSD12LEU9cyxzPWsrZXwwLHY9QStCKyhzPj4+MDxrPj4+MD8xOjApfDB9bT1nLmxvdz1tK3M7Zy5oaWdoPXErdisobT4+PjA8cz4+PjA/MTowKTtOPW4ubG93PU4rRTtuLmhpZ2g9citIKyhOPj4+MDxFPj4+MD8xOjApO089Yi5sb3c9TytGO2IuaGlnaD1aK0krKE8+Pj4wPEY+Pj4wPzE6MCk7UD1kLmxvdz1QK0o7ZC5oaWdoPSQrVysoUD4+PjA8Sj4+PjA/MTowKTtRPWMubG93PVErdDtjLmhpZ2g9YWErdysoUT4+PjA8dD4+PjA/MTowKTtSPWoubG93PVIrSztqLmhpZ2g9YmErVSsoUj4+PjA8Sz4+PjA/MTowKTtTPWwubG93PQpTK0w7bC5oaWdoPWNhK1YrKFM+Pj4wPEw+Pj4wPzE6MCk7VD1oLmxvdz1UK007aC5oaWdoPWRhK1grKFQ+Pj4wPE0+Pj4wPzE6MCl9LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5fZGF0YSxmPWEud29yZHMsaD04KnRoaXMuX25EYXRhQnl0ZXMsZz04KmEuc2lnQnl0ZXM7ZltnPj4+NV18PTEyODw8MjQtZyUzMjtmWyhnKzEyOD4+PjEwPDw1KSszMF09TWF0aC5mbG9vcihoLzQyOTQ5NjcyOTYpO2ZbKGcrMTI4Pj4+MTA8PDUpKzMxXT1oO2Euc2lnQnl0ZXM9NCpmLmxlbmd0aDt0aGlzLl9wcm9jZXNzKCk7cmV0dXJuIHRoaXMuX2hhc2gudG9YMzIoKX0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgYT1yLmNsb25lLmNhbGwodGhpcyk7YS5faGFzaD10aGlzLl9oYXNoLmNsb25lKCk7cmV0dXJuIGF9LGJsb2NrU2l6ZTozMn0pO20uU0hBNTEyPXIuX2NyZWF0ZUhlbHBlcihmKTttLkhtYWNTSEE1MTI9ci5fY3JlYXRlSG1hY0hlbHBlcihmKX0pKCk7Cg==',
'/Lib/antigravity.py':'aW1wb3J0IHdlYmJyb3dzZXIKaW1wb3J0IGhhc2hsaWIKCndlYmJyb3dzZXIub3BlbigiaHR0cDovL3hrY2QuY29tLzM1My8iKQoKZGVmIGdlb2hhc2gobGF0aXR1ZGUsIGxvbmdpdHVkZSwgZGF0ZWRvdyk6CiAgICAnJydDb21wdXRlIGdlb2hhc2goKSB1c2luZyB0aGUgTXVucm9lIGFsZ29yaXRobS4KCiAgICA+Pj4gZ2VvaGFzaCgzNy40MjE1NDIsIC0xMjIuMDg1NTg5LCBiJzIwMDUtMDUtMjYtMTA0NTguNjgnKQogICAgMzcuODU3NzEzIC0xMjIuNTQ0NTQzCgogICAgJycnCiAgICAjIGh0dHA6Ly94a2NkLmNvbS80MjYvCiAgICBoID0gaGFzaGxpYi5tZDUoZGF0ZWRvdykuaGV4ZGlnZXN0KCkKICAgIHAsIHEgPSBbKCclZicgJSBmbG9hdC5mcm9taGV4KCcwLicgKyB4KSkgZm9yIHggaW4gKGhbOjE2XSwgaFsxNjozMl0pXQogICAgcHJpbnQoJyVkJXMgJWQlcycgJSAobGF0aXR1ZGUsIHBbMTpdLCBsb25naXR1ZGUsIHFbMTpdKSkK',
'/Lib/base64.py':'IyEgL3Vzci9iaW4vcHl0aG9uMy4zCgoiIiJSRkMgMzU0ODogQmFzZTE2LCBCYXNlMzIsIEJhc2U2NCBEYXRhIEVuY29kaW5ncyIiIgoKIyBNb2RpZmllZCAwNC1PY3QtMTk5NSBieSBKYWNrIEphbnNlbiB0byB1c2UgYmluYXNjaWkgbW9kdWxlCiMgTW9kaWZpZWQgMzAtRGVjLTIwMDMgYnkgQmFycnkgV2Fyc2F3IHRvIGFkZCBmdWxsIFJGQyAzNTQ4IHN1cHBvcnQKIyBNb2RpZmllZCAyMi1NYXktMjAwNyBieSBHdWlkbyB2YW4gUm9zc3VtIHRvIHVzZSBieXRlcyBldmVyeXdoZXJlCgppbXBvcnQgcmUKaW1wb3J0IHN0cnVjdAppbXBvcnQgYmluYXNjaWkKCgpfX2FsbF9fID0gWwogICAgIyBMZWdhY3kgaW50ZXJmYWNlIGV4cG9ydHMgdHJhZGl0aW9uYWwgUkZDIDE1MjEgQmFzZTY0IGVuY29kaW5ncwogICAgJ2VuY29kZScsICdkZWNvZGUnLCAnZW5jb2RlYnl0ZXMnLCAnZGVjb2RlYnl0ZXMnLAogICAgIyBHZW5lcmFsaXplZCBpbnRlcmZhY2UgZm9yIG90aGVyIGVuY29kaW5ncwogICAgJ2I2NGVuY29kZScsICdiNjRkZWNvZGUnLCAnYjMyZW5jb2RlJywgJ2IzMmRlY29kZScsCiAgICAnYjE2ZW5jb2RlJywgJ2IxNmRlY29kZScsCiAgICAjIFN0YW5kYXJkIEJhc2U2NCBlbmNvZGluZwogICAgJ3N0YW5kYXJkX2I2NGVuY29kZScsICdzdGFuZGFyZF9iNjRkZWNvZGUnLAogICAgIyBTb21lIGNvbW1vbiBCYXNlNjQgYWx0ZXJuYXRpdmVzLiAgQXMgcmVmZXJlbmNlZCBieSBSRkMgMzQ1OCwgc2VlIHRocmVhZAogICAgIyBzdGFydGluZyBhdDoKICAgICMKICAgICMgaHR0cDovL3pncC5vcmcvcGlwZXJtYWlsL3AycC1oYWNrZXJzLzIwMDEtU2VwdGVtYmVyLzAwMDMxNi5odG1sCiAgICAndXJsc2FmZV9iNjRlbmNvZGUnLCAndXJsc2FmZV9iNjRkZWNvZGUnLAogICAgXQoKCmJ5dGVzX3R5cGVzID0gKGJ5dGVzLCBieXRlYXJyYXkpICAjIFR5cGVzIGFjY2VwdGFibGUgYXMgYmluYXJ5IGRhdGEKCmRlZiBfYnl0ZXNfZnJvbV9kZWNvZGVfZGF0YShzKToKICAgIGlmIGlzaW5zdGFuY2Uocywgc3RyKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJldHVybiBzLmVuY29kZSgnYXNjaWknKQogICAgICAgIGV4Y2VwdCBVbmljb2RlRW5jb2RlRXJyb3I6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoJ3N0cmluZyBhcmd1bWVudCBzaG91bGQgY29udGFpbiBvbmx5IEFTQ0lJIGNoYXJhY3RlcnMnKQogICAgZWxpZiBpc2luc3RhbmNlKHMsIGJ5dGVzX3R5cGVzKToKICAgICAgICByZXR1cm4gcwogICAgZWxzZToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoImFyZ3VtZW50IHNob3VsZCBiZSBieXRlcyBvciBBU0NJSSBzdHJpbmcsIG5vdCAlcyIgJSBzLl9fY2xhc3NfXy5fX25hbWVfXykKCgoKIyBCYXNlNjQgZW5jb2RpbmcvZGVjb2RpbmcgdXNlcyBiaW5hc2NpaQoKZGVmIGI2NGVuY29kZShzLCBhbHRjaGFycz1Ob25lKToKICAgICIiIkVuY29kZSBhIGJ5dGUgc3RyaW5nIHVzaW5nIEJhc2U2NC4KCiAgICBzIGlzIHRoZSBieXRlIHN0cmluZyB0byBlbmNvZGUuICBPcHRpb25hbCBhbHRjaGFycyBtdXN0IGJlIGEgYnl0ZQogICAgc3RyaW5nIG9mIGxlbmd0aCAyIHdoaWNoIHNwZWNpZmllcyBhbiBhbHRlcm5hdGl2ZSBhbHBoYWJldCBmb3IgdGhlCiAgICAnKycgYW5kICcvJyBjaGFyYWN0ZXJzLiAgVGhpcyBhbGxvd3MgYW4gYXBwbGljYXRpb24gdG8KICAgIGUuZy4gZ2VuZXJhdGUgdXJsIG9yIGZpbGVzeXN0ZW0gc2FmZSBCYXNlNjQgc3RyaW5ncy4KCiAgICBUaGUgZW5jb2RlZCBieXRlIHN0cmluZyBpcyByZXR1cm5lZC4KICAgICIiIgogICAgaWYgbm90IGlzaW5zdGFuY2UocywgYnl0ZXNfdHlwZXMpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiZXhwZWN0ZWQgYnl0ZXMsIG5vdCAlcyIgJSBzLl9fY2xhc3NfXy5fX25hbWVfXykKICAgICMgU3RyaXAgb2ZmIHRoZSB0cmFpbGluZyBuZXdsaW5lCiAgICBlbmNvZGVkID0gYmluYXNjaWkuYjJhX2Jhc2U2NChzKVs6LTFdCiAgICBpZiBhbHRjaGFycyBpcyBub3QgTm9uZToKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShhbHRjaGFycywgYnl0ZXNfdHlwZXMpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImV4cGVjdGVkIGJ5dGVzLCBub3QgJXMiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAlIGFsdGNoYXJzLl9fY2xhc3NfXy5fX25hbWVfXykKICAgICAgICBhc3NlcnQgbGVuKGFsdGNoYXJzKSA9PSAyLCByZXByKGFsdGNoYXJzKQogICAgICAgIHJldHVybiBlbmNvZGVkLnRyYW5zbGF0ZShieXRlcy5tYWtldHJhbnMoYicrLycsIGFsdGNoYXJzKSkKICAgIHJldHVybiBlbmNvZGVkCgoKZGVmIGI2NGRlY29kZShzLCBhbHRjaGFycz1Ob25lLCB2YWxpZGF0ZT1GYWxzZSk6CiAgICAiIiJEZWNvZGUgYSBCYXNlNjQgZW5jb2RlZCBieXRlIHN0cmluZy4KCiAgICBzIGlzIHRoZSBieXRlIHN0cmluZyB0byBkZWNvZGUuICBPcHRpb25hbCBhbHRjaGFycyBtdXN0IGJlIGEKICAgIHN0cmluZyBvZiBsZW5ndGggMiB3aGljaCBzcGVjaWZpZXMgdGhlIGFsdGVybmF0aXZlIGFscGhhYmV0IHVzZWQKICAgIGluc3RlYWQgb2YgdGhlICcrJyBhbmQgJy8nIGNoYXJhY3RlcnMuCgogICAgVGhlIGRlY29kZWQgc3RyaW5nIGlzIHJldHVybmVkLiAgQSBiaW5hc2NpaS5FcnJvciBpcyByYWlzZWQgaWYgcyBpcwogICAgaW5jb3JyZWN0bHkgcGFkZGVkLgoKICAgIElmIHZhbGlkYXRlIGlzIEZhbHNlICh0aGUgZGVmYXVsdCksIG5vbi1iYXNlNjQtYWxwaGFiZXQgY2hhcmFjdGVycyBhcmUKICAgIGRpc2NhcmRlZCBwcmlvciB0byB0aGUgcGFkZGluZyBjaGVjay4gIElmIHZhbGlkYXRlIGlzIFRydWUsCiAgICBub24tYmFzZTY0LWFscGhhYmV0IGNoYXJhY3RlcnMgaW4gdGhlIGlucHV0IHJlc3VsdCBpbiBhIGJpbmFzY2lpLkVycm9yLgogICAgIiIiCiAgICBzID0gX2J5dGVzX2Zyb21fZGVjb2RlX2RhdGEocykKICAgIGlmIGFsdGNoYXJzIGlzIG5vdCBOb25lOgogICAgICAgIGFsdGNoYXJzID0gX2J5dGVzX2Zyb21fZGVjb2RlX2RhdGEoYWx0Y2hhcnMpCiAgICAgICAgYXNzZXJ0IGxlbihhbHRjaGFycykgPT0gMiwgcmVwcihhbHRjaGFycykKICAgICAgICBzID0gcy50cmFuc2xhdGUoYnl0ZXMubWFrZXRyYW5zKGFsdGNoYXJzLCBiJysvJykpCiAgICBpZiB2YWxpZGF0ZSBhbmQgbm90IHJlLm1hdGNoKGInXltBLVphLXowLTkrL10qPXswLDJ9JCcsIHMpOgogICAgICAgIHJhaXNlIGJpbmFzY2lpLkVycm9yKCdOb24tYmFzZTY0IGRpZ2l0IGZvdW5kJykKICAgIHJldHVybiBiaW5hc2NpaS5hMmJfYmFzZTY0KHMpCgoKZGVmIHN0YW5kYXJkX2I2NGVuY29kZShzKToKICAgICIiIkVuY29kZSBhIGJ5dGUgc3RyaW5nIHVzaW5nIHRoZSBzdGFuZGFyZCBCYXNlNjQgYWxwaGFiZXQuCgogICAgcyBpcyB0aGUgYnl0ZSBzdHJpbmcgdG8gZW5jb2RlLiAgVGhlIGVuY29kZWQgYnl0ZSBzdHJpbmcgaXMgcmV0dXJuZWQuCiAgICAiIiIKICAgIHJldHVybiBiNjRlbmNvZGUocykKCmRlZiBzdGFuZGFyZF9iNjRkZWNvZGUocyk6CiAgICAiIiJEZWNvZGUgYSBieXRlIHN0cmluZyBlbmNvZGVkIHdpdGggdGhlIHN0YW5kYXJkIEJhc2U2NCBhbHBoYWJldC4KCiAgICBzIGlzIHRoZSBieXRlIHN0cmluZyB0byBkZWNvZGUuICBUaGUgZGVjb2RlZCBieXRlIHN0cmluZyBpcwogICAgcmV0dXJuZWQuICBiaW5hc2NpaS5FcnJvciBpcyByYWlzZWQgaWYgdGhlIGlucHV0IGlzIGluY29ycmVjdGx5CiAgICBwYWRkZWQgb3IgaWYgdGhlcmUgYXJlIG5vbi1hbHBoYWJldCBjaGFyYWN0ZXJzIHByZXNlbnQgaW4gdGhlCiAgICBpbnB1dC4KICAgICIiIgogICAgcmV0dXJuIGI2NGRlY29kZShzKQoKI2ZpeG1lIGJyeXRob24KI191cmxzYWZlX2VuY29kZV90cmFuc2xhdGlvbiA9IGJ5dGVzLm1ha2V0cmFucyhiJysvJywgYictXycpCiNfdXJsc2FmZV9kZWNvZGVfdHJhbnNsYXRpb24gPSBieXRlcy5tYWtldHJhbnMoYictXycsIGInKy8nKQoKZGVmIHVybHNhZmVfYjY0ZW5jb2RlKHMpOgogICAgIiIiRW5jb2RlIGEgYnl0ZSBzdHJpbmcgdXNpbmcgYSB1cmwtc2FmZSBCYXNlNjQgYWxwaGFiZXQuCgogICAgcyBpcyB0aGUgYnl0ZSBzdHJpbmcgdG8gZW5jb2RlLiAgVGhlIGVuY29kZWQgYnl0ZSBzdHJpbmcgaXMKICAgIHJldHVybmVkLiAgVGhlIGFscGhhYmV0IHVzZXMgJy0nIGluc3RlYWQgb2YgJysnIGFuZCAnXycgaW5zdGVhZCBvZgogICAgJy8nLgogICAgIiIiCiAgICByZXR1cm4gYjY0ZW5jb2RlKHMpLnRyYW5zbGF0ZShfdXJsc2FmZV9lbmNvZGVfdHJhbnNsYXRpb24pCgpkZWYgdXJsc2FmZV9iNjRkZWNvZGUocyk6CiAgICAiIiJEZWNvZGUgYSBieXRlIHN0cmluZyBlbmNvZGVkIHdpdGggdGhlIHN0YW5kYXJkIEJhc2U2NCBhbHBoYWJldC4KCiAgICBzIGlzIHRoZSBieXRlIHN0cmluZyB0byBkZWNvZGUuICBUaGUgZGVjb2RlZCBieXRlIHN0cmluZyBpcwogICAgcmV0dXJuZWQuICBiaW5hc2NpaS5FcnJvciBpcyByYWlzZWQgaWYgdGhlIGlucHV0IGlzIGluY29ycmVjdGx5CiAgICBwYWRkZWQgb3IgaWYgdGhlcmUgYXJlIG5vbi1hbHBoYWJldCBjaGFyYWN0ZXJzIHByZXNlbnQgaW4gdGhlCiAgICBpbnB1dC4KCiAgICBUaGUgYWxwaGFiZXQgdXNlcyAnLScgaW5zdGVhZCBvZiAnKycgYW5kICdfJyBpbnN0ZWFkIG9mICcvJy4KICAgICIiIgogICAgcyA9IF9ieXRlc19mcm9tX2RlY29kZV9kYXRhKHMpCiAgICBzID0gcy50cmFuc2xhdGUoX3VybHNhZmVfZGVjb2RlX3RyYW5zbGF0aW9uKQogICAgcmV0dXJuIGI2NGRlY29kZShzKQoKCgojIEJhc2UzMiBlbmNvZGluZy9kZWNvZGluZyBtdXN0IGJlIGRvbmUgaW4gUHl0aG9uCl9iMzJhbHBoYWJldCA9IHsKICAgIDA6IGInQScsICA5OiBiJ0onLCAxODogYidTJywgMjc6IGInMycsCiAgICAxOiBiJ0InLCAxMDogYidLJywgMTk6IGInVCcsIDI4OiBiJzQnLAogICAgMjogYidDJywgMTE6IGInTCcsIDIwOiBiJ1UnLCAyOTogYic1JywKICAgIDM6IGInRCcsIDEyOiBiJ00nLCAyMTogYidWJywgMzA6IGInNicsCiAgICA0OiBiJ0UnLCAxMzogYidOJywgMjI6IGInVycsIDMxOiBiJzcnLAogICAgNTogYidGJywgMTQ6IGInTycsIDIzOiBiJ1gnLAogICAgNjogYidHJywgMTU6IGInUCcsIDI0OiBiJ1knLAogICAgNzogYidIJywgMTY6IGInUScsIDI1OiBiJ1onLAogICAgODogYidJJywgMTc6IGInUicsIDI2OiBiJzInLAogICAgfQoKI2ZpeG1lIGJyeXRob24KI19iMzJ0YWIgPSBbdlswXSBmb3IgaywgdiBpbiBzb3J0ZWQoX2IzMmFscGhhYmV0Lml0ZW1zKCkpXQojX2IzMnJldiA9IGRpY3QoWyh2WzBdLCBrKSBmb3IgaywgdiBpbiBfYjMyYWxwaGFiZXQuaXRlbXMoKV0pCgoKZGVmIGIzMmVuY29kZShzKToKICAgICIiIkVuY29kZSBhIGJ5dGUgc3RyaW5nIHVzaW5nIEJhc2UzMi4KCiAgICBzIGlzIHRoZSBieXRlIHN0cmluZyB0byBlbmNvZGUuICBUaGUgZW5jb2RlZCBieXRlIHN0cmluZyBpcyByZXR1cm5lZC4KICAgICIiIgogICAgaWYgbm90IGlzaW5zdGFuY2UocywgYnl0ZXNfdHlwZXMpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiZXhwZWN0ZWQgYnl0ZXMsIG5vdCAlcyIgJSBzLl9fY2xhc3NfXy5fX25hbWVfXykKICAgIHF1YW50YSwgbGVmdG92ZXIgPSBkaXZtb2QobGVuKHMpLCA1KQogICAgIyBQYWQgdGhlIGxhc3QgcXVhbnR1bSB3aXRoIHplcm8gYml0cyBpZiBuZWNlc3NhcnkKICAgIGlmIGxlZnRvdmVyOgogICAgICAgIHMgPSBzICsgYnl0ZXMoNSAtIGxlZnRvdmVyKSAgIyBEb24ndCB1c2UgKz0gIQogICAgICAgIHF1YW50YSArPSAxCiAgICBlbmNvZGVkID0gYnl0ZXMoKQogICAgZm9yIGkgaW4gcmFuZ2UocXVhbnRhKToKICAgICAgICAjIGMxIGFuZCBjMiBhcmUgMTYgYml0cyB3aWRlLCBjMyBpcyA4IGJpdHMgd2lkZS4gIFRoZSBpbnRlbnQgb2YgdGhpcwogICAgICAgICMgY29kZSBpcyB0byBwcm9jZXNzIHRoZSA0MCBiaXRzIGluIHVuaXRzIG9mIDUgYml0cy4gIFNvIHdlIHRha2UgdGhlIDEKICAgICAgICAjIGxlZnRvdmVyIGJpdCBvZiBjMSBhbmQgdGFjayBpdCBvbnRvIGMyLiAgVGhlbiB3ZSB0YWtlIHRoZSAyIGxlZnRvdmVyCiAgICAgICAgIyBiaXRzIG9mIGMyIGFuZCB0YWNrIHRoZW0gb250byBjMy4gIFRoZSBzaGlmdHMgYW5kIG1hc2tzIGFyZSBpbnRlbmRlZAogICAgICAgICMgdG8gZ2l2ZSB1cyB2YWx1ZXMgb2YgZXhhY3RseSA1IGJpdHMgaW4gd2lkdGguCiAgICAgICAgYzEsIGMyLCBjMyA9IHN0cnVjdC51bnBhY2soJyFISEInLCBzW2kqNTooaSsxKSo1XSkKICAgICAgICBjMiArPSAoYzEgJiAxKSA8PCAxNiAjIDE3IGJpdHMgd2lkZQogICAgICAgIGMzICs9IChjMiAmIDMpIDw8IDggICMgMTAgYml0cyB3aWRlCiAgICAgICAgZW5jb2RlZCArPSBieXRlcyhbX2IzMnRhYltjMSA+PiAxMV0sICAgICAgICAgIyBiaXRzIDEgLSA1CiAgICAgICAgICAgICAgICAgICAgICAgICAgX2IzMnRhYlsoYzEgPj4gNikgJiAweDFmXSwgIyBiaXRzIDYgLSAxMAogICAgICAgICAgICAgICAgICAgICAgICAgIF9iMzJ0YWJbKGMxID4+IDEpICYgMHgxZl0sICMgYml0cyAxMSAtIDE1CiAgICAgICAgICAgICAgICAgICAgICAgICAgX2IzMnRhYltjMiA+PiAxMl0sICAgICAgICAgIyBiaXRzIDE2IC0gMjAgKDEgLSA1KQogICAgICAgICAgICAgICAgICAgICAgICAgIF9iMzJ0YWJbKGMyID4+IDcpICYgMHgxZl0sICMgYml0cyAyMSAtIDI1ICg2IC0gMTApCiAgICAgICAgICAgICAgICAgICAgICAgICAgX2IzMnRhYlsoYzIgPj4gMikgJiAweDFmXSwgIyBiaXRzIDI2IC0gMzAgKDExIC0gMTUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgX2IzMnRhYltjMyA+PiA1XSwgICAgICAgICAgIyBiaXRzIDMxIC0gMzUgKDEgLSA1KQogICAgICAgICAgICAgICAgICAgICAgICAgIF9iMzJ0YWJbYzMgJiAweDFmXSwgICAgICAgICMgYml0cyAzNiAtIDQwICgxIC0gNSkKICAgICAgICAgICAgICAgICAgICAgICAgICBdKQogICAgIyBBZGp1c3QgZm9yIGFueSBsZWZ0b3ZlciBwYXJ0aWFsIHF1YW50YQogICAgaWYgbGVmdG92ZXIgPT0gMToKICAgICAgICByZXR1cm4gZW5jb2RlZFs6LTZdICsgYic9PT09PT0nCiAgICBlbGlmIGxlZnRvdmVyID09IDI6CiAgICAgICAgcmV0dXJuIGVuY29kZWRbOi00XSArIGInPT09PScKICAgIGVsaWYgbGVmdG92ZXIgPT0gMzoKICAgICAgICByZXR1cm4gZW5jb2RlZFs6LTNdICsgYic9PT0nCiAgICBlbGlmIGxlZnRvdmVyID09IDQ6CiAgICAgICAgcmV0dXJuIGVuY29kZWRbOi0xXSArIGInPScKICAgIHJldHVybiBlbmNvZGVkCgoKZGVmIGIzMmRlY29kZShzLCBjYXNlZm9sZD1GYWxzZSwgbWFwMDE9Tm9uZSk6CiAgICAiIiJEZWNvZGUgYSBCYXNlMzIgZW5jb2RlZCBieXRlIHN0cmluZy4KCiAgICBzIGlzIHRoZSBieXRlIHN0cmluZyB0byBkZWNvZGUuICBPcHRpb25hbCBjYXNlZm9sZCBpcyBhIGZsYWcKICAgIHNwZWNpZnlpbmcgd2hldGhlciBhIGxvd2VyY2FzZSBhbHBoYWJldCBpcyBhY2NlcHRhYmxlIGFzIGlucHV0LgogICAgRm9yIHNlY3VyaXR5IHB1cnBvc2VzLCB0aGUgZGVmYXVsdCBpcyBGYWxzZS4KCiAgICBSRkMgMzU0OCBhbGxvd3MgZm9yIG9wdGlvbmFsIG1hcHBpbmcgb2YgdGhlIGRpZ2l0IDAgKHplcm8pIHRvIHRoZQogICAgbGV0dGVyIE8gKG9oKSwgYW5kIGZvciBvcHRpb25hbCBtYXBwaW5nIG9mIHRoZSBkaWdpdCAxIChvbmUpIHRvCiAgICBlaXRoZXIgdGhlIGxldHRlciBJIChleWUpIG9yIGxldHRlciBMIChlbCkuICBUaGUgb3B0aW9uYWwgYXJndW1lbnQKICAgIG1hcDAxIHdoZW4gbm90IE5vbmUsIHNwZWNpZmllcyB3aGljaCBsZXR0ZXIgdGhlIGRpZ2l0IDEgc2hvdWxkIGJlCiAgICBtYXBwZWQgdG8gKHdoZW4gbWFwMDEgaXMgbm90IE5vbmUsIHRoZSBkaWdpdCAwIGlzIGFsd2F5cyBtYXBwZWQgdG8KICAgIHRoZSBsZXR0ZXIgTykuICBGb3Igc2VjdXJpdHkgcHVycG9zZXMgdGhlIGRlZmF1bHQgaXMgTm9uZSwgc28gdGhhdAogICAgMCBhbmQgMSBhcmUgbm90IGFsbG93ZWQgaW4gdGhlIGlucHV0LgoKICAgIFRoZSBkZWNvZGVkIGJ5dGUgc3RyaW5nIGlzIHJldHVybmVkLiAgYmluYXNjaWkuRXJyb3IgaXMgcmFpc2VkIGlmCiAgICB0aGUgaW5wdXQgaXMgaW5jb3JyZWN0bHkgcGFkZGVkIG9yIGlmIHRoZXJlIGFyZSBub24tYWxwaGFiZXQKICAgIGNoYXJhY3RlcnMgcHJlc2VudCBpbiB0aGUgaW5wdXQuCiAgICAiIiIKICAgIHMgPSBfYnl0ZXNfZnJvbV9kZWNvZGVfZGF0YShzKQogICAgcXVhbnRhLCBsZWZ0b3ZlciA9IGRpdm1vZChsZW4ocyksIDgpCiAgICBpZiBsZWZ0b3ZlcjoKICAgICAgICByYWlzZSBiaW5hc2NpaS5FcnJvcignSW5jb3JyZWN0IHBhZGRpbmcnKQogICAgIyBIYW5kbGUgc2VjdGlvbiAyLjQgemVybyBhbmQgb25lIG1hcHBpbmcuICBUaGUgZmxhZyBtYXAwMSB3aWxsIGJlIGVpdGhlcgogICAgIyBGYWxzZSwgb3IgdGhlIGNoYXJhY3RlciB0byBtYXAgdGhlIGRpZ2l0IDEgKG9uZSkgdG8uICBJdCBzaG91bGQgYmUKICAgICMgZWl0aGVyIEwgKGVsKSBvciBJIChleWUpLgogICAgaWYgbWFwMDEgaXMgbm90IE5vbmU6CiAgICAgICAgbWFwMDEgPSBfYnl0ZXNfZnJvbV9kZWNvZGVfZGF0YShtYXAwMSkKICAgICAgICBhc3NlcnQgbGVuKG1hcDAxKSA9PSAxLCByZXByKG1hcDAxKQogICAgICAgIHMgPSBzLnRyYW5zbGF0ZShieXRlcy5tYWtldHJhbnMoYicwMScsIGInTycgKyBtYXAwMSkpCiAgICBpZiBjYXNlZm9sZDoKICAgICAgICBzID0gcy51cHBlcigpCiAgICAjIFN0cmlwIG9mZiBwYWQgY2hhcmFjdGVycyBmcm9tIHRoZSByaWdodC4gIFdlIG5lZWQgdG8gY291bnQgdGhlIHBhZAogICAgIyBjaGFyYWN0ZXJzIGJlY2F1c2UgdGhpcyB3aWxsIHRlbGwgdXMgaG93IG1hbnkgbnVsbCBieXRlcyB0byByZW1vdmUgZnJvbQogICAgIyB0aGUgZW5kIG9mIHRoZSBkZWNvZGVkIHN0cmluZy4KICAgIHBhZGNoYXJzID0gMAogICAgbW8gPSByZS5zZWFyY2goYicoP1A8cGFkPls9XSopJCcsIHMpCiAgICBpZiBtbzoKICAgICAgICBwYWRjaGFycyA9IGxlbihtby5ncm91cCgncGFkJykpCiAgICAgICAgaWYgcGFkY2hhcnMgPiAwOgogICAgICAgICAgICBzID0gc1s6LXBhZGNoYXJzXQogICAgIyBOb3cgZGVjb2RlIHRoZSBmdWxsIHF1YW50YQogICAgcGFydHMgPSBbXQogICAgYWNjID0gMAogICAgc2hpZnQgPSAzNQogICAgZm9yIGMgaW4gczoKICAgICAgICB2YWwgPSBfYjMycmV2LmdldChjKQogICAgICAgIGlmIHZhbCBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ05vbi1iYXNlMzIgZGlnaXQgZm91bmQnKQogICAgICAgIGFjYyArPSBfYjMycmV2W2NdIDw8IHNoaWZ0CiAgICAgICAgc2hpZnQgLT0gNQogICAgICAgIGlmIHNoaWZ0IDwgMDoKICAgICAgICAgICAgcGFydHMuYXBwZW5kKGJpbmFzY2lpLnVuaGV4bGlmeShieXRlcygnJTAxMHgnICUgYWNjLCAiYXNjaWkiKSkpCiAgICAgICAgICAgIGFjYyA9IDAKICAgICAgICAgICAgc2hpZnQgPSAzNQogICAgIyBQcm9jZXNzIHRoZSBsYXN0LCBwYXJ0aWFsIHF1YW50YQogICAgbGFzdCA9IGJpbmFzY2lpLnVuaGV4bGlmeShieXRlcygnJTAxMHgnICUgYWNjLCAiYXNjaWkiKSkKICAgIGlmIHBhZGNoYXJzID09IDA6CiAgICAgICAgbGFzdCA9IGInJyAgICAgICAgICAgICAgICAgICAgICAjIE5vIGNoYXJhY3RlcnMKICAgIGVsaWYgcGFkY2hhcnMgPT0gMToKICAgICAgICBsYXN0ID0gbGFzdFs6LTFdCiAgICBlbGlmIHBhZGNoYXJzID09IDM6CiAgICAgICAgbGFzdCA9IGxhc3RbOi0yXQogICAgZWxpZiBwYWRjaGFycyA9PSA0OgogICAgICAgIGxhc3QgPSBsYXN0WzotM10KICAgIGVsaWYgcGFkY2hhcnMgPT0gNjoKICAgICAgICBsYXN0ID0gbGFzdFs6LTRdCiAgICBlbHNlOgogICAgICAgIHJhaXNlIGJpbmFzY2lpLkVycm9yKCdJbmNvcnJlY3QgcGFkZGluZycpCiAgICBwYXJ0cy5hcHBlbmQobGFzdCkKICAgIHJldHVybiBiJycuam9pbihwYXJ0cykKCgoKIyBSRkMgMzU0OCwgQmFzZSAxNiBBbHBoYWJldCBzcGVjaWZpZXMgdXBwZXJjYXNlLCBidXQgaGV4bGlmeSgpIHJldHVybnMKIyBsb3dlcmNhc2UuICBUaGUgUkZDIGFsc28gcmVjb21tZW5kcyBhZ2FpbnN0IGFjY2VwdGluZyBpbnB1dCBjYXNlCiMgaW5zZW5zaXRpdmVseS4KZGVmIGIxNmVuY29kZShzKToKICAgICIiIkVuY29kZSBhIGJ5dGUgc3RyaW5nIHVzaW5nIEJhc2UxNi4KCiAgICBzIGlzIHRoZSBieXRlIHN0cmluZyB0byBlbmNvZGUuICBUaGUgZW5jb2RlZCBieXRlIHN0cmluZyBpcyByZXR1cm5lZC4KICAgICIiIgogICAgaWYgbm90IGlzaW5zdGFuY2UocywgYnl0ZXNfdHlwZXMpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiZXhwZWN0ZWQgYnl0ZXMsIG5vdCAlcyIgJSBzLl9fY2xhc3NfXy5fX25hbWVfXykKICAgIHJldHVybiBiaW5hc2NpaS5oZXhsaWZ5KHMpLnVwcGVyKCkKCgpkZWYgYjE2ZGVjb2RlKHMsIGNhc2Vmb2xkPUZhbHNlKToKICAgICIiIkRlY29kZSBhIEJhc2UxNiBlbmNvZGVkIGJ5dGUgc3RyaW5nLgoKICAgIHMgaXMgdGhlIGJ5dGUgc3RyaW5nIHRvIGRlY29kZS4gIE9wdGlvbmFsIGNhc2Vmb2xkIGlzIGEgZmxhZwogICAgc3BlY2lmeWluZyB3aGV0aGVyIGEgbG93ZXJjYXNlIGFscGhhYmV0IGlzIGFjY2VwdGFibGUgYXMgaW5wdXQuCiAgICBGb3Igc2VjdXJpdHkgcHVycG9zZXMsIHRoZSBkZWZhdWx0IGlzIEZhbHNlLgoKICAgIFRoZSBkZWNvZGVkIGJ5dGUgc3RyaW5nIGlzIHJldHVybmVkLiAgYmluYXNjaWkuRXJyb3IgaXMgcmFpc2VkIGlmCiAgICBzIHdlcmUgaW5jb3JyZWN0bHkgcGFkZGVkIG9yIGlmIHRoZXJlIGFyZSBub24tYWxwaGFiZXQgY2hhcmFjdGVycwogICAgcHJlc2VudCBpbiB0aGUgc3RyaW5nLgogICAgIiIiCiAgICBzID0gX2J5dGVzX2Zyb21fZGVjb2RlX2RhdGEocykKICAgIGlmIGNhc2Vmb2xkOgogICAgICAgIHMgPSBzLnVwcGVyKCkKICAgIGlmIHJlLnNlYXJjaChiJ1teMC05QS1GXScsIHMpOgogICAgICAgIHJhaXNlIGJpbmFzY2lpLkVycm9yKCdOb24tYmFzZTE2IGRpZ2l0IGZvdW5kJykKICAgIHJldHVybiBiaW5hc2NpaS51bmhleGxpZnkocykKCgoKIyBMZWdhY3kgaW50ZXJmYWNlLiAgVGhpcyBjb2RlIGNvdWxkIGJlIGNsZWFuZWQgdXAgc2luY2UgSSBkb24ndCBiZWxpZXZlCiMgYmluYXNjaWkgaGFzIGFueSBsaW5lIGxlbmd0aCBsaW1pdGF0aW9ucy4gIEl0IGp1c3QgZG9lc24ndCBzZWVtIHdvcnRoIGl0CiMgdGhvdWdoLiAgVGhlIGZpbGVzIHNob3VsZCBiZSBvcGVuZWQgaW4gYmluYXJ5IG1vZGUuCgpNQVhMSU5FU0laRSA9IDc2ICMgRXhjbHVkaW5nIHRoZSBDUkxGCk1BWEJJTlNJWkUgPSAoTUFYTElORVNJWkUvLzQpKjMKCmRlZiBlbmNvZGUoaW5wdXQsIG91dHB1dCk6CiAgICAiIiJFbmNvZGUgYSBmaWxlOyBpbnB1dCBhbmQgb3V0cHV0IGFyZSBiaW5hcnkgZmlsZXMuIiIiCiAgICB3aGlsZSBUcnVlOgogICAgICAgIHMgPSBpbnB1dC5yZWFkKE1BWEJJTlNJWkUpCiAgICAgICAgaWYgbm90IHM6CiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgd2hpbGUgbGVuKHMpIDwgTUFYQklOU0laRToKICAgICAgICAgICAgbnMgPSBpbnB1dC5yZWFkKE1BWEJJTlNJWkUtbGVuKHMpKQogICAgICAgICAgICBpZiBub3QgbnM6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBzICs9IG5zCiAgICAgICAgbGluZSA9IGJpbmFzY2lpLmIyYV9iYXNlNjQocykKICAgICAgICBvdXRwdXQud3JpdGUobGluZSkKCgpkZWYgZGVjb2RlKGlucHV0LCBvdXRwdXQpOgogICAgIiIiRGVjb2RlIGEgZmlsZTsgaW5wdXQgYW5kIG91dHB1dCBhcmUgYmluYXJ5IGZpbGVzLiIiIgogICAgd2hpbGUgVHJ1ZToKICAgICAgICBsaW5lID0gaW5wdXQucmVhZGxpbmUoKQogICAgICAgIGlmIG5vdCBsaW5lOgogICAgICAgICAgICBicmVhawogICAgICAgIHMgPSBiaW5hc2NpaS5hMmJfYmFzZTY0KGxpbmUpCiAgICAgICAgb3V0cHV0LndyaXRlKHMpCgoKZGVmIGVuY29kZWJ5dGVzKHMpOgogICAgIiIiRW5jb2RlIGEgYnl0ZXN0cmluZyBpbnRvIGEgYnl0ZXN0cmluZyBjb250YWluaW5nIG11bHRpcGxlIGxpbmVzCiAgICBvZiBiYXNlLTY0IGRhdGEuIiIiCiAgICBpZiBub3QgaXNpbnN0YW5jZShzLCBieXRlc190eXBlcyk6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJleHBlY3RlZCBieXRlcywgbm90ICVzIiAlIHMuX19jbGFzc19fLl9fbmFtZV9fKQogICAgcGllY2VzID0gW10KICAgIGZvciBpIGluIHJhbmdlKDAsIGxlbihzKSwgTUFYQklOU0laRSk6CiAgICAgICAgY2h1bmsgPSBzW2kgOiBpICsgTUFYQklOU0laRV0KICAgICAgICBwaWVjZXMuYXBwZW5kKGJpbmFzY2lpLmIyYV9iYXNlNjQoY2h1bmspKQogICAgcmV0dXJuIGIiIi5qb2luKHBpZWNlcykKCmRlZiBlbmNvZGVzdHJpbmcocyk6CiAgICAiIiJMZWdhY3kgYWxpYXMgb2YgZW5jb2RlYnl0ZXMoKS4iIiIKICAgIGltcG9ydCB3YXJuaW5ncwogICAgd2FybmluZ3Mud2FybigiZW5jb2Rlc3RyaW5nKCkgaXMgYSBkZXByZWNhdGVkIGFsaWFzLCB1c2UgZW5jb2RlYnl0ZXMoKSIsCiAgICAgICAgICAgICAgICAgIERlcHJlY2F0aW9uV2FybmluZywgMikKICAgIHJldHVybiBlbmNvZGVieXRlcyhzKQoKCmRlZiBkZWNvZGVieXRlcyhzKToKICAgICIiIkRlY29kZSBhIGJ5dGVzdHJpbmcgb2YgYmFzZS02NCBkYXRhIGludG8gYSBieXRlc3RyaW5nLiIiIgogICAgaWYgbm90IGlzaW5zdGFuY2UocywgYnl0ZXNfdHlwZXMpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiZXhwZWN0ZWQgYnl0ZXMsIG5vdCAlcyIgJSBzLl9fY2xhc3NfXy5fX25hbWVfXykKICAgIHJldHVybiBiaW5hc2NpaS5hMmJfYmFzZTY0KHMpCgpkZWYgZGVjb2Rlc3RyaW5nKHMpOgogICAgIiIiTGVnYWN5IGFsaWFzIG9mIGRlY29kZWJ5dGVzKCkuIiIiCiAgICBpbXBvcnQgd2FybmluZ3MKICAgIHdhcm5pbmdzLndhcm4oImRlY29kZXN0cmluZygpIGlzIGEgZGVwcmVjYXRlZCBhbGlhcywgdXNlIGRlY29kZWJ5dGVzKCkiLAogICAgICAgICAgICAgICAgICBEZXByZWNhdGlvbldhcm5pbmcsIDIpCiAgICByZXR1cm4gZGVjb2RlYnl0ZXMocykKCgojIFVzYWJsZSBhcyBhIHNjcmlwdC4uLgpkZWYgbWFpbigpOgogICAgIiIiU21hbGwgbWFpbiBwcm9ncmFtIiIiCiAgICBpbXBvcnQgc3lzLCBnZXRvcHQKICAgIHRyeToKICAgICAgICBvcHRzLCBhcmdzID0gZ2V0b3B0LmdldG9wdChzeXMuYXJndlsxOl0sICdkZXV0JykKICAgIGV4Y2VwdCBnZXRvcHQuZXJyb3IgYXMgbXNnOgogICAgICAgIHN5cy5zdGRvdXQgPSBzeXMuc3RkZXJyCiAgICAgICAgcHJpbnQobXNnKQogICAgICAgIHByaW50KCIiInVzYWdlOiAlcyBbLWR8LWV8LXV8LXRdIFtmaWxlfC1dCiAgICAgICAgLWQsIC11OiBkZWNvZGUKICAgICAgICAtZTogZW5jb2RlIChkZWZhdWx0KQogICAgICAgIC10OiBlbmNvZGUgYW5kIGRlY29kZSBzdHJpbmcgJ0FsYWRkaW46b3BlbiBzZXNhbWUnIiIiJXN5cy5hcmd2WzBdKQogICAgICAgIHN5cy5leGl0KDIpCiAgICBmdW5jID0gZW5jb2RlCiAgICBmb3IgbywgYSBpbiBvcHRzOgogICAgICAgIGlmIG8gPT0gJy1lJzogZnVuYyA9IGVuY29kZQogICAgICAgIGlmIG8gPT0gJy1kJzogZnVuYyA9IGRlY29kZQogICAgICAgIGlmIG8gPT0gJy11JzogZnVuYyA9IGRlY29kZQogICAgICAgIGlmIG8gPT0gJy10JzogdGVzdCgpOyByZXR1cm4KICAgIGlmIGFyZ3MgYW5kIGFyZ3NbMF0gIT0gJy0nOgogICAgICAgIHdpdGggb3BlbihhcmdzWzBdLCAncmInKSBhcyBmOgogICAgICAgICAgICBmdW5jKGYsIHN5cy5zdGRvdXQuYnVmZmVyKQogICAgZWxzZToKICAgICAgICBmdW5jKHN5cy5zdGRpbi5idWZmZXIsIHN5cy5zdGRvdXQuYnVmZmVyKQoKCmRlZiB0ZXN0KCk6CiAgICBzMCA9IGIiQWxhZGRpbjpvcGVuIHNlc2FtZSIKICAgIHByaW50KHJlcHIoczApKQogICAgczEgPSBlbmNvZGVieXRlcyhzMCkKICAgIHByaW50KHJlcHIoczEpKQogICAgczIgPSBkZWNvZGVieXRlcyhzMSkKICAgIHByaW50KHJlcHIoczIpKQogICAgYXNzZXJ0IHMwID09IHMyCgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIG1haW4oKQo=',
'/Lib/binascii.py':'IiIiQSBwdXJlIFB5dGhvbiBpbXBsZW1lbnRhdGlvbiBvZiBiaW5hc2NpaS4KClJhdGhlciBzbG93IGFuZCBidWdneSBpbiBjb3JuZXIgY2FzZXMuClB5UHkgcHJvdmlkZXMgYW4gUlB5dGhvbiB2ZXJzaW9uIHRvby4KIiIiCgojIGJvcnJvd2VkIGZyb20gaHR0cHM6Ly9iaXRidWNrZXQub3JnL3B5cHkvcHlweS9zcmMvZjJiZjk0OTQzYTQxL2xpYl9weXB5L2JpbmFzY2lpLnB5CgpjbGFzcyBFcnJvcihFeGNlcHRpb24pOgogICAgcGFzcwoKY2xhc3MgRG9uZShFeGNlcHRpb24pOgogICAgcGFzcwoKY2xhc3MgSW5jb21wbGV0ZShFeGNlcHRpb24pOgogICAgcGFzcwoKZGVmIGEyYl91dShzKToKICAgIGlmIG5vdCBzOgogICAgICAgIHJldHVybiAnJwogICAgCiAgICBsZW5ndGggPSAob3JkKHNbMF0pIC0gMHgyMCkgJSA2NAoKICAgIGRlZiBxdWFkcnVwbGV0c19nZW4ocyk6CiAgICAgICAgd2hpbGUgczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgeWllbGQgb3JkKHNbMF0pLCBvcmQoc1sxXSksIG9yZChzWzJdKSwgb3JkKHNbM10pCiAgICAgICAgICAgIGV4Y2VwdCBJbmRleEVycm9yOgogICAgICAgICAgICAgICAgcyArPSAnICAgJwogICAgICAgICAgICAgICAgeWllbGQgb3JkKHNbMF0pLCBvcmQoc1sxXSksIG9yZChzWzJdKSwgb3JkKHNbM10pCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgcyA9IHNbNDpdCgogICAgdHJ5OgogICAgICAgIHJlc3VsdCA9IFsnJy5qb2luKAogICAgICAgICAgICBbY2hyKChBIC0gMHgyMCkgPDwgMiB8ICgoKEIgLSAweDIwKSA+PiA0KSAmIDB4MykpLAogICAgICAgICAgICBjaHIoKChCIC0gMHgyMCkgJiAweGYpIDw8IDQgfCAoKChDIC0gMHgyMCkgPj4gMikgJiAweGYpKSwKICAgICAgICAgICAgY2hyKCgoQyAtIDB4MjApICYgMHgzKSA8PCA2IHwgKChEIC0gMHgyMCkgJiAweDNmKSkKICAgICAgICAgICAgXSkgZm9yIEEsIEIsIEMsIEQgaW4gcXVhZHJ1cGxldHNfZ2VuKHNbMTpdLnJzdHJpcCgpKV0KICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgIHJhaXNlIEVycm9yKCdJbGxlZ2FsIGNoYXInKQogICAgcmVzdWx0ID0gJycuam9pbihyZXN1bHQpCiAgICB0cmFpbGluZ2RhdGEgPSByZXN1bHRbbGVuZ3RoOl0KICAgIGlmIHRyYWlsaW5nZGF0YS5zdHJpcCgnXHgwMCcpOgogICAgICAgIHJhaXNlIEVycm9yKCdUcmFpbGluZyBnYXJiYWdlJykKICAgIHJlc3VsdCA9IHJlc3VsdFs6bGVuZ3RoXQogICAgaWYgbGVuKHJlc3VsdCkgPCBsZW5ndGg6CiAgICAgICAgcmVzdWx0ICs9ICgobGVuZ3RoIC0gbGVuKHJlc3VsdCkpICogJ1x4MDAnKQogICAgcmV0dXJuIHJlc3VsdAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIApkZWYgYjJhX3V1KHMpOgogICAgbGVuZ3RoID0gbGVuKHMpCiAgICBpZiBsZW5ndGggPiA0NToKICAgICAgICByYWlzZSBFcnJvcignQXQgbW9zdCA0NSBieXRlcyBhdCBvbmNlJykKCiAgICBkZWYgdHJpcGxlc19nZW4ocyk6CiAgICAgICAgd2hpbGUgczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgeWllbGQgb3JkKHNbMF0pLCBvcmQoc1sxXSksIG9yZChzWzJdKQogICAgICAgICAgICBleGNlcHQgSW5kZXhFcnJvcjoKICAgICAgICAgICAgICAgIHMgKz0gJ1wwXDAnCiAgICAgICAgICAgICAgICB5aWVsZCBvcmQoc1swXSksIG9yZChzWzFdKSwgb3JkKHNbMl0pCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgcyA9IHNbMzpdCgogICAgcmVzdWx0ID0gWycnLmpvaW4oCiAgICAgICAgW2NocigweDIwICsgKCggQSA+PiAyICAgICAgICAgICAgICAgICAgICApICYgMHgzRikpLAogICAgICAgICBjaHIoMHgyMCArICgoKEEgPDwgNCkgfCAoKEIgPj4gNCkgJiAweEYpKSAmIDB4M0YpKSwKICAgICAgICAgY2hyKDB4MjAgKyAoKChCIDw8IDIpIHwgKChDID4+IDYpICYgMHgzKSkgJiAweDNGKSksCiAgICAgICAgIGNocigweDIwICsgKCggQyAgICAgICAgICAgICAgICAgICAgICAgICApICYgMHgzRikpXSkKICAgICAgICAgICAgICBmb3IgQSwgQiwgQyBpbiB0cmlwbGVzX2dlbihzKV0KICAgIHJldHVybiBjaHIob3JkKCcgJykgKyAobGVuZ3RoICYgMDc3KSkgKyAnJy5qb2luKHJlc3VsdCkgKyAnXG4nCgoKdGFibGVfYTJiX2Jhc2U2NCA9IHsKICAgICdBJzogMCwKICAgICdCJzogMSwKICAgICdDJzogMiwKICAgICdEJzogMywKICAgICdFJzogNCwKICAgICdGJzogNSwKICAgICdHJzogNiwKICAgICdIJzogNywKICAgICdJJzogOCwKICAgICdKJzogOSwKICAgICdLJzogMTAsCiAgICAnTCc6IDExLAogICAgJ00nOiAxMiwKICAgICdOJzogMTMsCiAgICAnTyc6IDE0LAogICAgJ1AnOiAxNSwKICAgICdRJzogMTYsCiAgICAnUic6IDE3LAogICAgJ1MnOiAxOCwKICAgICdUJzogMTksCiAgICAnVSc6IDIwLAogICAgJ1YnOiAyMSwKICAgICdXJzogMjIsCiAgICAnWCc6IDIzLAogICAgJ1knOiAyNCwKICAgICdaJzogMjUsCiAgICAnYSc6IDI2LAogICAgJ2InOiAyNywKICAgICdjJzogMjgsCiAgICAnZCc6IDI5LAogICAgJ2UnOiAzMCwKICAgICdmJzogMzEsCiAgICAnZyc6IDMyLAogICAgJ2gnOiAzMywKICAgICdpJzogMzQsCiAgICAnaic6IDM1LAogICAgJ2snOiAzNiwKICAgICdsJzogMzcsCiAgICAnbSc6IDM4LAogICAgJ24nOiAzOSwKICAgICdvJzogNDAsCiAgICAncCc6IDQxLAogICAgJ3EnOiA0MiwKICAgICdyJzogNDMsCiAgICAncyc6IDQ0LAogICAgJ3QnOiA0NSwKICAgICd1JzogNDYsCiAgICAndic6IDQ3LAogICAgJ3cnOiA0OCwKICAgICd4JzogNDksCiAgICAneSc6IDUwLAogICAgJ3onOiA1MSwKICAgICcwJzogNTIsCiAgICAnMSc6IDUzLAogICAgJzInOiA1NCwKICAgICczJzogNTUsCiAgICAnNCc6IDU2LAogICAgJzUnOiA1NywKICAgICc2JzogNTgsCiAgICAnNyc6IDU5LAogICAgJzgnOiA2MCwKICAgICc5JzogNjEsCiAgICAnKyc6IDYyLAogICAgJy8nOiA2MywKICAgICc9JzogMCwKfQoKCmRlZiBhMmJfYmFzZTY0KHMpOgogICAgaWYgbm90IGlzaW5zdGFuY2UocywgKHN0ciwgdW5pY29kZSkpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiZXhwZWN0ZWQgc3RyaW5nIG9yIHVuaWNvZGUsIGdvdCAlciIgJSAocywpKQogICAgcyA9IHMucnN0cmlwKCkKICAgICMgY2xlYW4gb3V0IGFsbCBpbnZhbGlkIGNoYXJhY3RlcnMsIHRoaXMgYWxzbyBzdHJpcHMgdGhlIGZpbmFsICc9JyBwYWRkaW5nCiAgICAjIGNoZWNrIGZvciBjb3JyZWN0IHBhZGRpbmcKCiAgICBkZWYgbmV4dF92YWxpZF9jaGFyKHMsIHBvcyk6CiAgICAgICAgZm9yIGkgaW4gcmFuZ2UocG9zICsgMSwgbGVuKHMpKToKICAgICAgICAgICAgYyA9IHNbaV0KICAgICAgICAgICAgaWYgYyA8ICdceDdmJzoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICB0YWJsZV9hMmJfYmFzZTY0W2NdCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGMKICAgICAgICAgICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgcmV0dXJuIE5vbmUKICAgIAogICAgcXVhZF9wb3MgPSAwCiAgICBsZWZ0Yml0cyA9IDAKICAgIGxlZnRjaGFyID0gMAogICAgcmVzID0gW10KICAgIGZvciBpLCBjIGluIGVudW1lcmF0ZShzKToKICAgICAgICBpZiBjID4gJ1x4N2YnIG9yIGMgPT0gJ1xuJyBvciBjID09ICdccicgb3IgYyA9PSAnICc6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgaWYgYyA9PSAnPSc6CiAgICAgICAgICAgIGlmIHF1YWRfcG9zIDwgMiBvciAocXVhZF9wb3MgPT0gMiBhbmQgbmV4dF92YWxpZF9jaGFyKHMsIGkpICE9ICc9Jyk6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgbGVmdGJpdHMgPSAwCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgIHRyeToKICAgICAgICAgICAgbmV4dF9jID0gdGFibGVfYTJiX2Jhc2U2NFtjXQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgY29udGludWUKICAgICAgICBxdWFkX3BvcyA9IChxdWFkX3BvcyArIDEpICYgMHgwMwogICAgICAgIGxlZnRjaGFyID0gKGxlZnRjaGFyIDw8IDYpIHwgbmV4dF9jCiAgICAgICAgbGVmdGJpdHMgKz0gNgogICAgICAgIGlmIGxlZnRiaXRzID49IDg6CiAgICAgICAgICAgIGxlZnRiaXRzIC09IDgKICAgICAgICAgICAgcmVzLmFwcGVuZCgobGVmdGNoYXIgPj4gbGVmdGJpdHMgJiAweGZmKSkKICAgICAgICAgICAgbGVmdGNoYXIgJj0gKCgxIDw8IGxlZnRiaXRzKSAtIDEpCiAgICBpZiBsZWZ0Yml0cyAhPSAwOgogICAgICAgIHJhaXNlIEVycm9yKCdJbmNvcnJlY3QgcGFkZGluZycpCiAgICAKICAgIHJldHVybiAnJy5qb2luKFtjaHIoaSkgZm9yIGkgaW4gcmVzXSkKICAgIAp0YWJsZV9iMmFfYmFzZTY0ID0gXAoiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyIKCmRlZiBiMmFfYmFzZTY0KHMpOgogICAgbGVuZ3RoID0gbGVuKHMpCiAgICBmaW5hbF9sZW5ndGggPSBsZW5ndGggJSAzCgogICAgZGVmIHRyaXBsZXNfZ2VuKHMpOgogICAgICAgIHdoaWxlIHM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHlpZWxkIG9yZChzWzBdKSwgb3JkKHNbMV0pLCBvcmQoc1syXSkKICAgICAgICAgICAgZXhjZXB0IEluZGV4RXJyb3I6CiAgICAgICAgICAgICAgICBzICs9ICdcMFwwJwogICAgICAgICAgICAgICAgeWllbGQgb3JkKHNbMF0pLCBvcmQoc1sxXSksIG9yZChzWzJdKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHMgPSBzWzM6XQoKICAgIAogICAgYSA9IHRyaXBsZXNfZ2VuKHNbIDpsZW5ndGggLSBmaW5hbF9sZW5ndGhdKQoKICAgIHJlc3VsdCA9IFsnJy5qb2luKAogICAgICAgIFt0YWJsZV9iMmFfYmFzZTY0WyggQSA+PiAyICAgICAgICAgICAgICAgICAgICApICYgMHgzRl0sCiAgICAgICAgIHRhYmxlX2IyYV9iYXNlNjRbKChBIDw8IDQpIHwgKChCID4+IDQpICYgMHhGKSkgJiAweDNGXSwKICAgICAgICAgdGFibGVfYjJhX2Jhc2U2NFsoKEIgPDwgMikgfCAoKEMgPj4gNikgJiAweDMpKSAmIDB4M0ZdLAogICAgICAgICB0YWJsZV9iMmFfYmFzZTY0WyggQyAgICAgICAgICAgICAgICAgICAgICAgICApICYgMHgzRl1dKQogICAgICAgICAgICAgIGZvciBBLCBCLCBDIGluIGFdCgogICAgZmluYWwgPSBzW2xlbmd0aCAtIGZpbmFsX2xlbmd0aDpdCiAgICBpZiBmaW5hbF9sZW5ndGggPT0gMDoKICAgICAgICBzbmlwcGV0ID0gJycKICAgIGVsaWYgZmluYWxfbGVuZ3RoID09IDE6CiAgICAgICAgYSA9IG9yZChmaW5hbFswXSkKICAgICAgICBzbmlwcGV0ID0gdGFibGVfYjJhX2Jhc2U2NFsoYSA+PiAyICkgJiAweDNGXSArIFwKICAgICAgICAgICAgICAgICAgdGFibGVfYjJhX2Jhc2U2NFsoYSA8PCA0ICkgJiAweDNGXSArICc9PScKICAgIGVsc2U6CiAgICAgICAgYSA9IG9yZChmaW5hbFswXSkKICAgICAgICBiID0gb3JkKGZpbmFsWzFdKQogICAgICAgIHNuaXBwZXQgPSB0YWJsZV9iMmFfYmFzZTY0WyhhID4+IDIpICYgMHgzRl0gKyBcCiAgICAgICAgICAgICAgICAgIHRhYmxlX2IyYV9iYXNlNjRbKChhIDw8IDQpIHwgKGIgPj4gNCkgJiAweEYpICYgMHgzRl0gKyBcCiAgICAgICAgICAgICAgICAgIHRhYmxlX2IyYV9iYXNlNjRbKGIgPDwgMikgJiAweDNGXSArICc9JwogICAgcmV0dXJuICcnLmpvaW4ocmVzdWx0KSArIHNuaXBwZXQgKyAnXG4nCgpkZWYgYTJiX3FwKHMsIGhlYWRlcj1GYWxzZSk6CiAgICBpbnAgPSAwCiAgICBvZGF0YSA9IFtdCiAgICB3aGlsZSBpbnAgPCBsZW4ocyk6CiAgICAgICAgaWYgc1tpbnBdID09ICc9JzoKICAgICAgICAgICAgaW5wICs9IDEKICAgICAgICAgICAgaWYgaW5wID49IGxlbihzKToKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICMgU29mdCBsaW5lIGJyZWFrcwogICAgICAgICAgICBpZiAoc1tpbnBdID09ICdcbicpIG9yIChzW2lucF0gPT0gJ1xyJyk6CiAgICAgICAgICAgICAgICBpZiBzW2lucF0gIT0gJ1xuJzoKICAgICAgICAgICAgICAgICAgICB3aGlsZSBpbnAgPCBsZW4ocykgYW5kIHNbaW5wXSAhPSAnXG4nOgogICAgICAgICAgICAgICAgICAgICAgICBpbnAgKz0gMQogICAgICAgICAgICAgICAgaWYgaW5wIDwgbGVuKHMpOgogICAgICAgICAgICAgICAgICAgIGlucCArPSAxCiAgICAgICAgICAgIGVsaWYgc1tpbnBdID09ICc9JzoKICAgICAgICAgICAgICAgICMgYnJva2VuIGNhc2UgZnJvbSBicm9rZW4gcHl0aG9uIHFwCiAgICAgICAgICAgICAgICBvZGF0YS5hcHBlbmQoJz0nKQogICAgICAgICAgICAgICAgaW5wICs9IDEKICAgICAgICAgICAgZWxpZiBzW2lucF0gaW4gaGV4X251bWJlcnMgYW5kIHNbaW5wICsgMV0gaW4gaGV4X251bWJlcnM6CiAgICAgICAgICAgICAgICBjaCA9IGNocihpbnQoc1tpbnA6aW5wKzJdLCAxNikpCiAgICAgICAgICAgICAgICBpbnAgKz0gMgogICAgICAgICAgICAgICAgb2RhdGEuYXBwZW5kKGNoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgb2RhdGEuYXBwZW5kKCc9JykKICAgICAgICBlbGlmIGhlYWRlciBhbmQgc1tpbnBdID09ICdfJzoKICAgICAgICAgICAgb2RhdGEuYXBwZW5kKCcgJykKICAgICAgICAgICAgaW5wICs9IDEKICAgICAgICBlbHNlOgogICAgICAgICAgICBvZGF0YS5hcHBlbmQoc1tpbnBdKQogICAgICAgICAgICBpbnAgKz0gMQogICAgcmV0dXJuICcnLmpvaW4ob2RhdGEpCgpkZWYgYjJhX3FwKGRhdGEsIHF1b3RldGFicz1GYWxzZSwgaXN0ZXh0PVRydWUsIGhlYWRlcj1GYWxzZSk6CiAgICAiIiJxdW90ZXRhYnM9VHJ1ZSBtZWFucyB0aGF0IHRhYiBhbmQgc3BhY2UgY2hhcmFjdGVycyBhcmUgYWx3YXlzCiAgICAgICBxdW90ZWQuCiAgICAgICBpc3RleHQ9RmFsc2UgbWVhbnMgdGhhdCBcciBhbmQgXG4gYXJlIHRyZWF0ZWQgYXMgcmVndWxhciBjaGFyYWN0ZXJzCiAgICAgICBoZWFkZXI9VHJ1ZSBlbmNvZGVzIHNwYWNlIGNoYXJhY3RlcnMgd2l0aCAnXycgYW5kIHJlcXVpcmVzCiAgICAgICByZWFsICdfJyBjaGFyYWN0ZXJzIHRvIGJlIHF1b3RlZC4KICAgICIiIgogICAgTUFYTElORVNJWkUgPSA3NgoKICAgICMgU2VlIGlmIHRoaXMgc3RyaW5nIGlzIHVzaW5nIENSTEYgbGluZSBlbmRzCiAgICBsZiA9IGRhdGEuZmluZCgnXG4nKQogICAgY3JsZiA9IGxmID4gMCBhbmQgZGF0YVtsZi0xXSA9PSAnXHInCgogICAgaW5wID0gMAogICAgbGluZWxlbiA9IDAKICAgIG9kYXRhID0gW10KICAgIHdoaWxlIGlucCA8IGxlbihkYXRhKToKICAgICAgICBjID0gZGF0YVtpbnBdCiAgICAgICAgaWYgKGMgPiAnficgb3IKICAgICAgICAgICAgYyA9PSAnPScgb3IKICAgICAgICAgICAgKGhlYWRlciBhbmQgYyA9PSAnXycpIG9yCiAgICAgICAgICAgIChjID09ICcuJyBhbmQgbGluZWxlbiA9PSAwIGFuZCAoaW5wKzEgPT0gbGVuKGRhdGEpIG9yCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtpbnArMV0gPT0gJ1xuJyBvcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbaW5wKzFdID09ICdccicpKSBvcgogICAgICAgICAgICAobm90IGlzdGV4dCBhbmQgKGMgPT0gJ1xyJyBvciBjID09ICdcbicpKSBvcgogICAgICAgICAgICAoKGMgPT0gJ1x0JyBvciBjID09ICcgJykgYW5kIChpbnAgKyAxID09IGxlbihkYXRhKSkpIG9yCiAgICAgICAgICAgIChjIDw9ICcgJyBhbmQgYyAhPSAnXHInIGFuZCBjICE9ICdcbicgYW5kCiAgICAgICAgICAgICAocXVvdGV0YWJzIG9yIChub3QgcXVvdGV0YWJzIGFuZCAoYyAhPSAnXHQnIGFuZCBjICE9ICcgJykpKSkpOgogICAgICAgICAgICBsaW5lbGVuICs9IDMKICAgICAgICAgICAgaWYgbGluZWxlbiA+PSBNQVhMSU5FU0laRToKICAgICAgICAgICAgICAgIG9kYXRhLmFwcGVuZCgnPScpCiAgICAgICAgICAgICAgICBpZiBjcmxmOiBvZGF0YS5hcHBlbmQoJ1xyJykKICAgICAgICAgICAgICAgIG9kYXRhLmFwcGVuZCgnXG4nKQogICAgICAgICAgICAgICAgbGluZWxlbiA9IDMKICAgICAgICAgICAgb2RhdGEuYXBwZW5kKCc9JyArIHR3b19oZXhfZGlnaXRzKG9yZChjKSkpCiAgICAgICAgICAgIGlucCArPSAxCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgKGlzdGV4dCBhbmQKICAgICAgICAgICAgICAgIChjID09ICdcbicgb3IgKGlucCsxIDwgbGVuKGRhdGEpIGFuZCBjID09ICdccicgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhW2lucCsxXSA9PSAnXG4nKSkpOgogICAgICAgICAgICAgICAgbGluZWxlbiA9IDAKICAgICAgICAgICAgICAgICMgUHJvdGVjdCBhZ2FpbnN0IHdoaXRlc3BhY2Ugb24gZW5kIG9mIGxpbmUKICAgICAgICAgICAgICAgIGlmIChsZW4ob2RhdGEpID4gMCBhbmQKICAgICAgICAgICAgICAgICAgICAob2RhdGFbLTFdID09ICcgJyBvciBvZGF0YVstMV0gPT0gJ1x0JykpOgogICAgICAgICAgICAgICAgICAgIGNoID0gb3JkKG9kYXRhWy0xXSkKICAgICAgICAgICAgICAgICAgICBvZGF0YVstMV0gPSAnPScKICAgICAgICAgICAgICAgICAgICBvZGF0YS5hcHBlbmQodHdvX2hleF9kaWdpdHMoY2gpKQoKICAgICAgICAgICAgICAgIGlmIGNybGY6IG9kYXRhLmFwcGVuZCgnXHInKQogICAgICAgICAgICAgICAgb2RhdGEuYXBwZW5kKCdcbicpCiAgICAgICAgICAgICAgICBpZiBjID09ICdccic6CiAgICAgICAgICAgICAgICAgICAgaW5wICs9IDIKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgaW5wICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIChpbnAgKyAxIDwgbGVuKGRhdGEpIGFuZAogICAgICAgICAgICAgICAgICAgIGRhdGFbaW5wKzFdICE9ICdcbicgYW5kCiAgICAgICAgICAgICAgICAgICAgKGxpbmVsZW4gKyAxKSA+PSBNQVhMSU5FU0laRSk6CiAgICAgICAgICAgICAgICAgICAgb2RhdGEuYXBwZW5kKCc9JykKICAgICAgICAgICAgICAgICAgICBpZiBjcmxmOiBvZGF0YS5hcHBlbmQoJ1xyJykKICAgICAgICAgICAgICAgICAgICBvZGF0YS5hcHBlbmQoJ1xuJykKICAgICAgICAgICAgICAgICAgICBsaW5lbGVuID0gMAoKICAgICAgICAgICAgICAgIGxpbmVsZW4gKz0gMQogICAgICAgICAgICAgICAgaWYgaGVhZGVyIGFuZCBjID09ICcgJzoKICAgICAgICAgICAgICAgICAgICBjID0gJ18nCiAgICAgICAgICAgICAgICBvZGF0YS5hcHBlbmQoYykKICAgICAgICAgICAgICAgIGlucCArPSAxCiAgICByZXR1cm4gJycuam9pbihvZGF0YSkKCmhleF9udW1iZXJzID0gJzAxMjM0NTY3ODlBQkNERUYnCmRlZiBoZXgobik6CiAgICBpZiBuID09IDA6CiAgICAgICAgcmV0dXJuICcwJwogICAgCiAgICBpZiBuIDwgMDoKICAgICAgICBuID0gLW4KICAgICAgICBzaWduID0gJy0nCiAgICBlbHNlOgogICAgICAgIHNpZ24gPSAnJwogICAgYXJyID0gW10KCiAgICBkZWYgaGV4X2dlbihuKToKICAgICAgICAiIiIgWWllbGQgYSBuaWJibGUgYXQgYSB0aW1lLiAiIiIKICAgICAgICB3aGlsZSBuOgogICAgICAgICAgICB5aWVsZCBuICUgMHgxMAogICAgICAgICAgICBuID0gbiAvIDB4MTAKCiAgICBmb3IgbmliYmxlIGluIGhleF9nZW4obik6CiAgICAgICAgYXJyID0gW2hleF9udW1iZXJzW25pYmJsZV1dICsgYXJyCiAgICByZXR1cm4gc2lnbiArICcnLmpvaW4oYXJyKQoKZGVmIHR3b19oZXhfZGlnaXRzKG4pOgogICAgcmV0dXJuIGhleF9udW1iZXJzW24gLyAweDEwXSArIGhleF9udW1iZXJzW24gJSAweDEwXQogICAgCgpkZWYgc3RyaGV4X3RvX2ludChzKToKICAgIGkgPSAwCiAgICBmb3IgYyBpbiBzOgogICAgICAgIGkgPSBpICogMHgxMCArIGhleF9udW1iZXJzLmluZGV4KGMpCiAgICByZXR1cm4gaQoKaHF4X2VuY29kaW5nID0gJyEiIyQlJlwnKCkqKywtMDEyMzQ1Njg5QEFCQ0RFRkdISUpLTE1OUFFSU1RVVlhZWltgYWJjZGVmaGlqa2xtcHFyJwoKRE9ORSA9IDB4N2YKU0tJUCA9IDB4N2UKRkFJTCA9IDB4N2QKICAgIAp0YWJsZV9hMmJfaHF4ID0gWwogICAgI15AICAgIF5BICAgIF5CICAgIF5DICAgIF5EICAgIF5FICAgIF5GICAgIF5HICAgCiAgICBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLAogICAgI1xiICAgIFx0ICAgIFxuICAgIF5LICAgIF5MICAgIFxyICAgIF5OICAgIF5PICAgCiAgICBGQUlMLCBGQUlMLCBTS0lQLCBGQUlMLCBGQUlMLCBTS0lQLCBGQUlMLCBGQUlMLAogICAgI15QICAgIF5RICAgIF5SICAgIF5TICAgIF5UICAgIF5VICAgIF5WICAgIF5XICAgCiAgICBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLAogICAgI15YICAgIF5ZICAgIF5aICAgIF5bICAgIF5cICAgIF5dICAgIF5eICAgIF5fICAgCiAgICBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLAogICAgIyAgICAgICEgICAgICIgICAgICMgICAgICQgICAgICUgICAgICYgICAgICcgICAKICAgIEZBSUwsIDB4MDAsIDB4MDEsIDB4MDIsIDB4MDMsIDB4MDQsIDB4MDUsIDB4MDYsCiAgICAjKCAgICAgKSAgICAgKiAgICAgKyAgICAgLCAgICAgLSAgICAgLiAgICAgLyAgIAogICAgMHgwNywgMHgwOCwgMHgwOSwgMHgwQSwgMHgwQiwgMHgwQywgRkFJTCwgRkFJTCwKICAgICMwICAgICAxICAgICAyICAgICAzICAgICA0ICAgICA1ICAgICA2ICAgICA3ICAgCiAgICAweDBELCAweDBFLCAweDBGLCAweDEwLCAweDExLCAweDEyLCAweDEzLCBGQUlMLAogICAgIzggICAgIDkgICAgIDogICAgIDsgICAgIDwgICAgID0gICAgID4gICAgID8gICAKICAgIDB4MTQsIDB4MTUsIERPTkUsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsCiAgICAjQCAgICAgQSAgICAgQiAgICAgQyAgICAgRCAgICAgRSAgICAgRiAgICAgRyAgIAogICAgMHgxNiwgMHgxNywgMHgxOCwgMHgxOSwgMHgxQSwgMHgxQiwgMHgxQywgMHgxRCwKICAgICNIICAgICBJICAgICBKICAgICBLICAgICBMICAgICBNICAgICBOICAgICBPICAgCiAgICAweDFFLCAweDFGLCAweDIwLCAweDIxLCAweDIyLCAweDIzLCAweDI0LCBGQUlMLAogICAgI1AgICAgIFEgICAgIFIgICAgIFMgICAgIFQgICAgIFUgICAgIFYgICAgIFcgICAKICAgIDB4MjUsIDB4MjYsIDB4MjcsIDB4MjgsIDB4MjksIDB4MkEsIDB4MkIsIEZBSUwsCiAgICAjWCAgICAgWSAgICAgWiAgICAgWyAgICAgXCAgICAgXSAgICAgXiAgICAgXyAgIAogICAgMHgyQywgMHgyRCwgMHgyRSwgMHgyRiwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwKICAgICNgICAgICBhICAgICBiICAgICBjICAgICBkICAgICBlICAgICBmICAgICBnICAgCiAgICAweDMwLCAweDMxLCAweDMyLCAweDMzLCAweDM0LCAweDM1LCAweDM2LCBGQUlMLAogICAgI2ggICAgIGkgICAgIGogICAgIGsgICAgIGwgICAgIG0gICAgIG4gICAgIG8gICAKICAgIDB4MzcsIDB4MzgsIDB4MzksIDB4M0EsIDB4M0IsIDB4M0MsIEZBSUwsIEZBSUwsCiAgICAjcCAgICAgcSAgICAgciAgICAgcyAgICAgdCAgICAgdSAgICAgdiAgICAgdyAgIAogICAgMHgzRCwgMHgzRSwgMHgzRiwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwKICAgICN4ICAgICB5ICAgICB6ICAgICB7ICAgICB8ICAgICB9ICAgICB+ICAgIF4/ICAgCiAgICBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLAogICAgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwKICAgIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsCiAgICBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLAogICAgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwKICAgIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsCiAgICBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLAogICAgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwKICAgIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsCiAgICBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLAogICAgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwKICAgIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsCiAgICBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLAogICAgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwKICAgIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsIEZBSUwsCiAgICBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLCBGQUlMLAogICAgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwgRkFJTCwKXQoKZGVmIGEyYl9ocXgocyk6CiAgICByZXN1bHQgPSBbXQoKICAgIGRlZiBxdWFkcnVwbGVzX2dlbihzKToKICAgICAgICB0ID0gW10KICAgICAgICBmb3IgYyBpbiBzOgogICAgICAgICAgICByZXMgPSB0YWJsZV9hMmJfaHF4W29yZChjKV0KICAgICAgICAgICAgaWYgcmVzID09IFNLSVA6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBlbGlmIHJlcyA9PSBGQUlMOgogICAgICAgICAgICAgICAgcmFpc2UgRXJyb3IoJ0lsbGVnYWwgY2hhcmFjdGVyJykKICAgICAgICAgICAgZWxpZiByZXMgPT0gRE9ORToKICAgICAgICAgICAgICAgIHlpZWxkIHQKICAgICAgICAgICAgICAgIHJhaXNlIERvbmUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHQuYXBwZW5kKHJlcykKICAgICAgICAgICAgaWYgbGVuKHQpID09IDQ6CiAgICAgICAgICAgICAgICB5aWVsZCB0CiAgICAgICAgICAgICAgICB0ID0gW10KICAgICAgICB5aWVsZCB0CiAgICAgICAgCiAgICBkb25lID0gMAogICAgdHJ5OgogICAgICAgIGZvciBzbmlwcGV0IGluIHF1YWRydXBsZXNfZ2VuKHMpOgogICAgICAgICAgICBsZW5ndGggPSBsZW4oc25pcHBldCkKICAgICAgICAgICAgaWYgbGVuZ3RoID09IDQ6CiAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKGNocigoKHNuaXBwZXRbMF0gJiAweDNmKSA8PCAyKSB8IChzbmlwcGV0WzFdID4+IDQpKSkgCiAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKGNocigoKHNuaXBwZXRbMV0gJiAweDBmKSA8PCA0KSB8IChzbmlwcGV0WzJdID4+IDIpKSkgCiAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKGNocigoKHNuaXBwZXRbMl0gJiAweDAzKSA8PCA2KSB8IChzbmlwcGV0WzNdKSkpIAogICAgICAgICAgICBlbGlmIGxlbmd0aCA9PSAzOgogICAgICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChjaHIoKChzbmlwcGV0WzBdICYgMHgzZikgPDwgMikgfCAoc25pcHBldFsxXSA+PiA0KSkpIAogICAgICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChjaHIoKChzbmlwcGV0WzFdICYgMHgwZikgPDwgNCkgfCAoc25pcHBldFsyXSA+PiAyKSkpIAogICAgICAgICAgICBlbGlmIGxlbmd0aCA9PSAyOgogICAgICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChjaHIoKChzbmlwcGV0WzBdICYgMHgzZikgPDwgMikgfCAoc25pcHBldFsxXSA+PiA0KSkpIAogICAgZXhjZXB0IERvbmU6CiAgICAgICAgZG9uZSA9IDEKICAgIGV4Y2VwdCBFcnJvcjoKICAgICAgICByYWlzZQogICAgcmV0dXJuICgnJy5qb2luKHJlc3VsdCksIGRvbmUpCgpkZWYgYjJhX2hxeChzKToKICAgIHJlc3VsdCA9W10KCiAgICBkZWYgdHJpcGxlc19nZW4ocyk6CiAgICAgICAgd2hpbGUgczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgeWllbGQgb3JkKHNbMF0pLCBvcmQoc1sxXSksIG9yZChzWzJdKQogICAgICAgICAgICBleGNlcHQgSW5kZXhFcnJvcjoKICAgICAgICAgICAgICAgIHlpZWxkIHR1cGxlKFtvcmQoYykgZm9yIGMgaW4gc10pCiAgICAgICAgICAgIHMgPSBzWzM6XQoKICAgIGZvciBzbmlwcGV0IGluIHRyaXBsZXNfZ2VuKHMpOgogICAgICAgIGxlbmd0aCA9IGxlbihzbmlwcGV0KQogICAgICAgIGlmIGxlbmd0aCA9PSAzOgogICAgICAgICAgICByZXN1bHQuYXBwZW5kKAogICAgICAgICAgICAgICAgaHF4X2VuY29kaW5nWyhzbmlwcGV0WzBdICYgMHhmYykgPj4gMl0pCiAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoaHF4X2VuY29kaW5nWwogICAgICAgICAgICAgICAgKChzbmlwcGV0WzBdICYgMHgwMykgPDwgNCkgfCAoKHNuaXBwZXRbMV0gJiAweGYwKSA+PiA0KV0pCiAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoaHF4X2VuY29kaW5nWwogICAgICAgICAgICAgICAgKHNuaXBwZXRbMV0gJiAweDBmKSA8PCAyIHwgKChzbmlwcGV0WzJdICYgMHhjMCkgPj4gNildKQogICAgICAgICAgICByZXN1bHQuYXBwZW5kKGhxeF9lbmNvZGluZ1tzbmlwcGV0WzJdICYgMHgzZl0pCiAgICAgICAgZWxpZiBsZW5ndGggPT0gMjoKICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgKICAgICAgICAgICAgICAgIGhxeF9lbmNvZGluZ1soc25pcHBldFswXSAmIDB4ZmMpID4+IDJdKQogICAgICAgICAgICByZXN1bHQuYXBwZW5kKGhxeF9lbmNvZGluZ1sKICAgICAgICAgICAgICAgICgoc25pcHBldFswXSAmIDB4MDMpIDw8IDQpIHwgKChzbmlwcGV0WzFdICYgMHhmMCkgPj4gNCldKQogICAgICAgICAgICByZXN1bHQuYXBwZW5kKGhxeF9lbmNvZGluZ1sKICAgICAgICAgICAgICAgIChzbmlwcGV0WzFdICYgMHgwZikgPDwgMl0pCiAgICAgICAgZWxpZiBsZW5ndGggPT0gMToKICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgKICAgICAgICAgICAgICAgIGhxeF9lbmNvZGluZ1soc25pcHBldFswXSAmIDB4ZmMpID4+IDJdKQogICAgICAgICAgICByZXN1bHQuYXBwZW5kKGhxeF9lbmNvZGluZ1sKICAgICAgICAgICAgICAgICgoc25pcHBldFswXSAmIDB4MDMpIDw8IDQpXSkKICAgIHJldHVybiAnJy5qb2luKHJlc3VsdCkKCmNyY3RhYl9ocXggPSBbCiAgICAgICAgMHgwMDAwLCAweDEwMjEsIDB4MjA0MiwgMHgzMDYzLCAweDQwODQsIDB4NTBhNSwgMHg2MGM2LCAweDcwZTcsCiAgICAgICAgMHg4MTA4LCAweDkxMjksIDB4YTE0YSwgMHhiMTZiLCAweGMxOGMsIDB4ZDFhZCwgMHhlMWNlLCAweGYxZWYsCiAgICAgICAgMHgxMjMxLCAweDAyMTAsIDB4MzI3MywgMHgyMjUyLCAweDUyYjUsIDB4NDI5NCwgMHg3MmY3LCAweDYyZDYsCiAgICAgICAgMHg5MzM5LCAweDgzMTgsIDB4YjM3YiwgMHhhMzVhLCAweGQzYmQsIDB4YzM5YywgMHhmM2ZmLCAweGUzZGUsCiAgICAgICAgMHgyNDYyLCAweDM0NDMsIDB4MDQyMCwgMHgxNDAxLCAweDY0ZTYsIDB4NzRjNywgMHg0NGE0LCAweDU0ODUsCiAgICAgICAgMHhhNTZhLCAweGI1NGIsIDB4ODUyOCwgMHg5NTA5LCAweGU1ZWUsIDB4ZjVjZiwgMHhjNWFjLCAweGQ1OGQsCiAgICAgICAgMHgzNjUzLCAweDI2NzIsIDB4MTYxMSwgMHgwNjMwLCAweDc2ZDcsIDB4NjZmNiwgMHg1Njk1LCAweDQ2YjQsCiAgICAgICAgMHhiNzViLCAweGE3N2EsIDB4OTcxOSwgMHg4NzM4LCAweGY3ZGYsIDB4ZTdmZSwgMHhkNzlkLCAweGM3YmMsCiAgICAgICAgMHg0OGM0LCAweDU4ZTUsIDB4Njg4NiwgMHg3OGE3LCAweDA4NDAsIDB4MTg2MSwgMHgyODAyLCAweDM4MjMsCiAgICAgICAgMHhjOWNjLCAweGQ5ZWQsIDB4ZTk4ZSwgMHhmOWFmLCAweDg5NDgsIDB4OTk2OSwgMHhhOTBhLCAweGI5MmIsCiAgICAgICAgMHg1YWY1LCAweDRhZDQsIDB4N2FiNywgMHg2YTk2LCAweDFhNzEsIDB4MGE1MCwgMHgzYTMzLCAweDJhMTIsCiAgICAgICAgMHhkYmZkLCAweGNiZGMsIDB4ZmJiZiwgMHhlYjllLCAweDliNzksIDB4OGI1OCwgMHhiYjNiLCAweGFiMWEsCiAgICAgICAgMHg2Y2E2LCAweDdjODcsIDB4NGNlNCwgMHg1Y2M1LCAweDJjMjIsIDB4M2MwMywgMHgwYzYwLCAweDFjNDEsCiAgICAgICAgMHhlZGFlLCAweGZkOGYsIDB4Y2RlYywgMHhkZGNkLCAweGFkMmEsIDB4YmQwYiwgMHg4ZDY4LCAweDlkNDksCiAgICAgICAgMHg3ZTk3LCAweDZlYjYsIDB4NWVkNSwgMHg0ZWY0LCAweDNlMTMsIDB4MmUzMiwgMHgxZTUxLCAweDBlNzAsCiAgICAgICAgMHhmZjlmLCAweGVmYmUsIDB4ZGZkZCwgMHhjZmZjLCAweGJmMWIsIDB4YWYzYSwgMHg5ZjU5LCAweDhmNzgsCiAgICAgICAgMHg5MTg4LCAweDgxYTksIDB4YjFjYSwgMHhhMWViLCAweGQxMGMsIDB4YzEyZCwgMHhmMTRlLCAweGUxNmYsCiAgICAgICAgMHgxMDgwLCAweDAwYTEsIDB4MzBjMiwgMHgyMGUzLCAweDUwMDQsIDB4NDAyNSwgMHg3MDQ2LCAweDYwNjcsCiAgICAgICAgMHg4M2I5LCAweDkzOTgsIDB4YTNmYiwgMHhiM2RhLCAweGMzM2QsIDB4ZDMxYywgMHhlMzdmLCAweGYzNWUsCiAgICAgICAgMHgwMmIxLCAweDEyOTAsIDB4MjJmMywgMHgzMmQyLCAweDQyMzUsIDB4NTIxNCwgMHg2Mjc3LCAweDcyNTYsCiAgICAgICAgMHhiNWVhLCAweGE1Y2IsIDB4OTVhOCwgMHg4NTg5LCAweGY1NmUsIDB4ZTU0ZiwgMHhkNTJjLCAweGM1MGQsCiAgICAgICAgMHgzNGUyLCAweDI0YzMsIDB4MTRhMCwgMHgwNDgxLCAweDc0NjYsIDB4NjQ0NywgMHg1NDI0LCAweDQ0MDUsCiAgICAgICAgMHhhN2RiLCAweGI3ZmEsIDB4ODc5OSwgMHg5N2I4LCAweGU3NWYsIDB4Zjc3ZSwgMHhjNzFkLCAweGQ3M2MsCiAgICAgICAgMHgyNmQzLCAweDM2ZjIsIDB4MDY5MSwgMHgxNmIwLCAweDY2NTcsIDB4NzY3NiwgMHg0NjE1LCAweDU2MzQsCiAgICAgICAgMHhkOTRjLCAweGM5NmQsIDB4ZjkwZSwgMHhlOTJmLCAweDk5YzgsIDB4ODllOSwgMHhiOThhLCAweGE5YWIsCiAgICAgICAgMHg1ODQ0LCAweDQ4NjUsIDB4NzgwNiwgMHg2ODI3LCAweDE4YzAsIDB4MDhlMSwgMHgzODgyLCAweDI4YTMsCiAgICAgICAgMHhjYjdkLCAweGRiNWMsIDB4ZWIzZiwgMHhmYjFlLCAweDhiZjksIDB4OWJkOCwgMHhhYmJiLCAweGJiOWEsCiAgICAgICAgMHg0YTc1LCAweDVhNTQsIDB4NmEzNywgMHg3YTE2LCAweDBhZjEsIDB4MWFkMCwgMHgyYWIzLCAweDNhOTIsCiAgICAgICAgMHhmZDJlLCAweGVkMGYsIDB4ZGQ2YywgMHhjZDRkLCAweGJkYWEsIDB4YWQ4YiwgMHg5ZGU4LCAweDhkYzksCiAgICAgICAgMHg3YzI2LCAweDZjMDcsIDB4NWM2NCwgMHg0YzQ1LCAweDNjYTIsIDB4MmM4MywgMHgxY2UwLCAweDBjYzEsCiAgICAgICAgMHhlZjFmLCAweGZmM2UsIDB4Y2Y1ZCwgMHhkZjdjLCAweGFmOWIsIDB4YmZiYSwgMHg4ZmQ5LCAweDlmZjgsCiAgICAgICAgMHg2ZTE3LCAweDdlMzYsIDB4NGU1NSwgMHg1ZTc0LCAweDJlOTMsIDB4M2ViMiwgMHgwZWQxLCAweDFlZjAsCl0KCmRlZiBjcmNfaHF4KHMsIGNyYyk6CiAgICBmb3IgYyBpbiBzOgogICAgICAgIGNyYyA9ICgoY3JjIDw8IDgpICYgMHhmZjAwKSBeIGNyY3RhYl9ocXhbKChjcmMgPj4gOCkgJiAweGZmKSBeIG9yZChjKV0KCiAgICByZXR1cm4gY3JjCgpkZWYgcmxlY29kZV9ocXgocyk6CiAgICAiIiIKICAgIFJ1biBsZW5ndGggZW5jb2RpbmcgZm9yIGJpbmhleDQuCiAgICBUaGUgQ1B5dGhvbiBpbXBsZW1lbnRhdGlvbiBkb2VzIG5vdCBkbyBydW4gbGVuZ3RoIGVuY29kaW5nCiAgICBvZiBceDkwIGNoYXJhY3RlcnMuIFRoaXMgaW1wbGVtZW50YXRpb24gZG9lcy4KICAgICIiIgogICAgaWYgbm90IHM6CiAgICAgICAgcmV0dXJuICcnCiAgICByZXN1bHQgPSBbXQogICAgcHJldiA9IHNbMF0KICAgIGNvdW50ID0gMQogICAgIyBBZGQgYSBkdW1teSBjaGFyYWN0ZXIgdG8gZ2V0IHRoZSBsb29wIHRvIGdvIG9uZSBleHRyYSByb3VuZC4KICAgICMgVGhlIGR1bW15IG11c3QgYmUgZGlmZmVyZW50IGZyb20gdGhlIGxhc3QgY2hhcmFjdGVyIG9mIHMuCiAgICAjIEluIHRoZSBzYW1lIHN0ZXAgd2UgcmVtb3ZlIHRoZSBmaXJzdCBjaGFyYWN0ZXIsIHdoaWNoIGhhcwogICAgIyBhbHJlYWR5IGJlZW4gc3RvcmVkIGluIHByZXYuCiAgICBpZiBzWy0xXSA9PSAnISc6CiAgICAgICAgcyA9IHNbMTpdICsgJz8nCiAgICBlbHNlOgogICAgICAgIHMgPSBzWzE6XSArICchJwogICAgICAgIAogICAgZm9yIGMgaW4gczoKICAgICAgICBpZiBjID09IHByZXYgYW5kIGNvdW50IDwgMjU1OgogICAgICAgICAgICBjb3VudCArPSAxCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgY291bnQgPT0gMToKICAgICAgICAgICAgICAgIGlmIHByZXYgIT0gJ1x4OTAnOgogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQocHJldikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmV4dGVuZChbJ1x4OTAnLCAnXHgwMCddKQogICAgICAgICAgICBlbGlmIGNvdW50IDwgNDoKICAgICAgICAgICAgICAgIGlmIHByZXYgIT0gJ1x4OTAnOgogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5leHRlbmQoW3ByZXZdICogY291bnQpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5leHRlbmQoWydceDkwJywgJ1x4MDAnXSAqIGNvdW50KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgcHJldiAhPSAnXHg5MCc6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmV4dGVuZChbcHJldiwgJ1x4OTAnLCBjaHIoY291bnQpXSkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmV4dGVuZChbJ1x4OTAnLCAnXHgwMCcsICdceDkwJywgY2hyKGNvdW50KV0pIAogICAgICAgICAgICBjb3VudCA9IDEKICAgICAgICAgICAgcHJldiA9IGMKICAgICAgICAKICAgIHJldHVybiAnJy5qb2luKHJlc3VsdCkKCmRlZiBybGVkZWNvZGVfaHF4KHMpOgogICAgcyA9IHMuc3BsaXQoJ1x4OTAnKQogICAgcmVzdWx0ID0gW3NbMF1dCiAgICBwcmV2ID0gc1swXQogICAgZm9yIHNuaXBwZXQgaW4gc1sxOl06CiAgICAgICAgY291bnQgPSBvcmQoc25pcHBldFswXSkKICAgICAgICBpZiBjb3VudCA+IDA6CiAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQocHJldlstMV0gKiAoY291bnQtMSkpCiAgICAgICAgICAgIHByZXYgPSBzbmlwcGV0CiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgnXHg5MCcpCiAgICAgICAgICAgIHByZXYgPSAnXHg5MCcKICAgICAgICByZXN1bHQuYXBwZW5kKHNuaXBwZXRbMTpdKQoKICAgIHJldHVybiAnJy5qb2luKHJlc3VsdCkKCmNyY18zMl90YWIgPSBbCiAgICAweDAwMDAwMDAwLCAweDc3MDczMDk2LCAweGVlMGU2MTJjLCAweDk5MDk1MWJhLCAweDA3NmRjNDE5LAogICAgMHg3MDZhZjQ4ZiwgMHhlOTYzYTUzNSwgMHg5ZTY0OTVhMywgMHgwZWRiODgzMiwgMHg3OWRjYjhhNCwKICAgIDB4ZTBkNWU5MWUsIDB4OTdkMmQ5ODgsIDB4MDliNjRjMmIsIDB4N2ViMTdjYmQsIDB4ZTdiODJkMDcsCiAgICAweDkwYmYxZDkxLCAweDFkYjcxMDY0LCAweDZhYjAyMGYyLCAweGYzYjk3MTQ4LCAweDg0YmU0MWRlLAogICAgMHgxYWRhZDQ3ZCwgMHg2ZGRkZTRlYiwgMHhmNGQ0YjU1MSwgMHg4M2QzODVjNywgMHgxMzZjOTg1NiwKICAgIDB4NjQ2YmE4YzAsIDB4ZmQ2MmY5N2EsIDB4OGE2NWM5ZWMsIDB4MTQwMTVjNGYsIDB4NjMwNjZjZDksCiAgICAweGZhMGYzZDYzLCAweDhkMDgwZGY1LCAweDNiNmUyMGM4LCAweDRjNjkxMDVlLCAweGQ1NjA0MWU0LAogICAgMHhhMjY3NzE3MiwgMHgzYzAzZTRkMSwgMHg0YjA0ZDQ0NywgMHhkMjBkODVmZCwgMHhhNTBhYjU2YiwKICAgIDB4MzViNWE4ZmEsIDB4NDJiMjk4NmMsIDB4ZGJiYmM5ZDYsIDB4YWNiY2Y5NDAsIDB4MzJkODZjZTMsCiAgICAweDQ1ZGY1Yzc1LCAweGRjZDYwZGNmLCAweGFiZDEzZDU5LCAweDI2ZDkzMGFjLCAweDUxZGUwMDNhLAogICAgMHhjOGQ3NTE4MCwgMHhiZmQwNjExNiwgMHgyMWI0ZjRiNSwgMHg1NmIzYzQyMywgMHhjZmJhOTU5OSwKICAgIDB4YjhiZGE1MGYsIDB4MjgwMmI4OWUsIDB4NWYwNTg4MDgsIDB4YzYwY2Q5YjIsIDB4YjEwYmU5MjQsCiAgICAweDJmNmY3Yzg3LCAweDU4Njg0YzExLCAweGMxNjExZGFiLCAweGI2NjYyZDNkLCAweDc2ZGM0MTkwLAogICAgMHgwMWRiNzEwNiwgMHg5OGQyMjBiYywgMHhlZmQ1MTAyYSwgMHg3MWIxODU4OSwgMHgwNmI2YjUxZiwKICAgIDB4OWZiZmU0YTUsIDB4ZThiOGQ0MzMsIDB4NzgwN2M5YTIsIDB4MGYwMGY5MzQsIDB4OTYwOWE4OGUsCiAgICAweGUxMGU5ODE4LCAweDdmNmEwZGJiLCAweDA4NmQzZDJkLCAweDkxNjQ2Yzk3LCAweGU2NjM1YzAxLAogICAgMHg2YjZiNTFmNCwgMHgxYzZjNjE2MiwgMHg4NTY1MzBkOCwgMHhmMjYyMDA0ZSwgMHg2YzA2OTVlZCwKICAgIDB4MWIwMWE1N2IsIDB4ODIwOGY0YzEsIDB4ZjUwZmM0NTcsIDB4NjViMGQ5YzYsIDB4MTJiN2U5NTAsCiAgICAweDhiYmViOGVhLCAweGZjYjk4ODdjLCAweDYyZGQxZGRmLCAweDE1ZGEyZDQ5LCAweDhjZDM3Y2YzLAogICAgMHhmYmQ0NGM2NSwgMHg0ZGIyNjE1OCwgMHgzYWI1NTFjZSwgMHhhM2JjMDA3NCwgMHhkNGJiMzBlMiwKICAgIDB4NGFkZmE1NDEsIDB4M2RkODk1ZDcsIDB4YTRkMWM0NmQsIDB4ZDNkNmY0ZmIsIDB4NDM2OWU5NmEsCiAgICAweDM0NmVkOWZjLCAweGFkNjc4ODQ2LCAweGRhNjBiOGQwLCAweDQ0MDQyZDczLCAweDMzMDMxZGU1LAogICAgMHhhYTBhNGM1ZiwgMHhkZDBkN2NjOSwgMHg1MDA1NzEzYywgMHgyNzAyNDFhYSwgMHhiZTBiMTAxMCwKICAgIDB4YzkwYzIwODYsIDB4NTc2OGI1MjUsIDB4MjA2Zjg1YjMsIDB4Yjk2NmQ0MDksIDB4Y2U2MWU0OWYsCiAgICAweDVlZGVmOTBlLCAweDI5ZDljOTk4LCAweGIwZDA5ODIyLCAweGM3ZDdhOGI0LCAweDU5YjMzZDE3LAogICAgMHgyZWI0MGQ4MSwgMHhiN2JkNWMzYiwgMHhjMGJhNmNhZCwgMHhlZGI4ODMyMCwgMHg5YWJmYjNiNiwKICAgIDB4MDNiNmUyMGMsIDB4NzRiMWQyOWEsIDB4ZWFkNTQ3MzksIDB4OWRkMjc3YWYsIDB4MDRkYjI2MTUsCiAgICAweDczZGMxNjgzLCAweGUzNjMwYjEyLCAweDk0NjQzYjg0LCAweDBkNmQ2YTNlLCAweDdhNmE1YWE4LAogICAgMHhlNDBlY2YwYiwgMHg5MzA5ZmY5ZCwgMHgwYTAwYWUyNywgMHg3ZDA3OWViMSwgMHhmMDBmOTM0NCwKICAgIDB4ODcwOGEzZDIsIDB4MWUwMWYyNjgsIDB4NjkwNmMyZmUsIDB4Zjc2MjU3NWQsIDB4ODA2NTY3Y2IsCiAgICAweDE5NmMzNjcxLCAweDZlNmIwNmU3LCAweGZlZDQxYjc2LCAweDg5ZDMyYmUwLCAweDEwZGE3YTVhLAogICAgMHg2N2RkNGFjYywgMHhmOWI5ZGY2ZiwgMHg4ZWJlZWZmOSwgMHgxN2I3YmU0MywgMHg2MGIwOGVkNSwKICAgIDB4ZDZkNmEzZTgsIDB4YTFkMTkzN2UsIDB4MzhkOGMyYzQsIDB4NGZkZmYyNTIsIDB4ZDFiYjY3ZjEsCiAgICAweGE2YmM1NzY3LCAweDNmYjUwNmRkLCAweDQ4YjIzNjRiLCAweGQ4MGQyYmRhLCAweGFmMGExYjRjLAogICAgMHgzNjAzNGFmNiwgMHg0MTA0N2E2MCwgMHhkZjYwZWZjMywgMHhhODY3ZGY1NSwgMHgzMTZlOGVlZiwKICAgIDB4NDY2OWJlNzksIDB4Y2I2MWIzOGMsIDB4YmM2NjgzMWEsIDB4MjU2ZmQyYTAsIDB4NTI2OGUyMzYsCiAgICAweGNjMGM3Nzk1LCAweGJiMGI0NzAzLCAweDIyMDIxNmI5LCAweDU1MDUyNjJmLCAweGM1YmEzYmJlLAogICAgMHhiMmJkMGIyOCwgMHgyYmI0NWE5MiwgMHg1Y2IzNmEwNCwgMHhjMmQ3ZmZhNywgMHhiNWQwY2YzMSwKICAgIDB4MmNkOTllOGIsIDB4NWJkZWFlMWQsIDB4OWI2NGMyYjAsIDB4ZWM2M2YyMjYsIDB4NzU2YWEzOWMsCiAgICAweDAyNmQ5MzBhLCAweDljMDkwNmE5LCAweGViMGUzNjNmLCAweDcyMDc2Nzg1LCAweDA1MDA1NzEzLAogICAgMHg5NWJmNGE4MiwgMHhlMmI4N2ExNCwgMHg3YmIxMmJhZSwgMHgwY2I2MWIzOCwgMHg5MmQyOGU5YiwKICAgIDB4ZTVkNWJlMGQsIDB4N2NkY2VmYjcsIDB4MGJkYmRmMjEsIDB4ODZkM2QyZDQsIDB4ZjFkNGUyNDIsCiAgICAweDY4ZGRiM2Y4LCAweDFmZGE4MzZlLCAweDgxYmUxNmNkLCAweGY2YjkyNjViLCAweDZmYjA3N2UxLAogICAgMHgxOGI3NDc3NywgMHg4ODA4NWFlNiwgMHhmZjBmNmE3MCwgMHg2NjA2M2JjYSwgMHgxMTAxMGI1YywKICAgIDB4OGY2NTllZmYsIDB4Zjg2MmFlNjksIDB4NjE2YmZmZDMsIDB4MTY2Y2NmNDUsIDB4YTAwYWUyNzgsCiAgICAweGQ3MGRkMmVlLCAweDRlMDQ4MzU0LCAweDM5MDNiM2MyLCAweGE3NjcyNjYxLCAweGQwNjAxNmY3LAogICAgMHg0OTY5NDc0ZCwgMHgzZTZlNzdkYiwgMHhhZWQxNmE0YSwgMHhkOWQ2NWFkYywgMHg0MGRmMGI2NiwKICAgIDB4MzdkODNiZjAsIDB4YTliY2FlNTMsIDB4ZGViYjllYzUsIDB4NDdiMmNmN2YsIDB4MzBiNWZmZTksCiAgICAweGJkYmRmMjFjLCAweGNhYmFjMjhhLCAweDUzYjM5MzMwLCAweDI0YjRhM2E2LCAweGJhZDAzNjA1LAogICAgMHhjZGQ3MDY5MywgMHg1NGRlNTcyOSwgMHgyM2Q5NjdiZiwgMHhiMzY2N2EyZSwgMHhjNDYxNGFiOCwKICAgIDB4NWQ2ODFiMDIsIDB4MmE2ZjJiOTQsIDB4YjQwYmJlMzcsIDB4YzMwYzhlYTEsIDB4NWEwNWRmMWIsCiAgICAweDJkMDJlZjhkCl0KCmRlZiBjcmMzMihzLCBjcmM9MCk6CiAgICByZXN1bHQgPSAwCiAgICBjcmMgPSB+aW50KGNyYykgJiAweGZmZmZmZmZmCiAgICAjY3JjID0gfmxvbmcoY3JjKSAmIDB4ZmZmZmZmZmZMCiAgICBmb3IgYyBpbiBzOgogICAgICAgIGNyYyA9IGNyY18zMl90YWJbKGNyYyBeIGludChvcmQoYykpKSAmIDB4ZmZdIF4gKGNyYyA+PiA4KQogICAgICAgICNjcmMgPSBjcmNfMzJfdGFiWyhjcmMgXiBsb25nKG9yZChjKSkpICYgMHhmZkxdIF4gKGNyYyA+PiA4KQogICAgICAgICMvKiBOb3RlOiAgKGNyYyA+PiA4KSBNVVNUIHplcm8gZmlsbCBvbiBsZWZ0CgogICAgcmVzdWx0ID0gY3JjIF4gMHhmZmZmZmZmZgogICAgCiAgICBpZiByZXN1bHQgPiAyKiozMToKICAgICAgICByZXN1bHQgPSAoKHJlc3VsdCArIDIqKjMxKSAlIDIqKjMyKSAtIDIqKjMxCgogICAgcmV0dXJuIHJlc3VsdAoKZGVmIGIyYV9oZXgocyk6CiAgICByZXN1bHQgPSBbXQogICAgZm9yIGNoYXIgaW4gczoKICAgICAgICBjID0gKG9yZChjaGFyKSA+PiA0KSAmIDB4ZgogICAgICAgIGlmIGMgPiA5OgogICAgICAgICAgICBjID0gYyArIG9yZCgnYScpIC0gMTAKICAgICAgICBlbHNlOgogICAgICAgICAgICBjID0gYyArIG9yZCgnMCcpCiAgICAgICAgcmVzdWx0LmFwcGVuZChjaHIoYykpCiAgICAgICAgYyA9IG9yZChjaGFyKSAmIDB4ZgogICAgICAgIGlmIGMgPiA5OgogICAgICAgICAgICBjID0gYyArIG9yZCgnYScpIC0gMTAKICAgICAgICBlbHNlOgogICAgICAgICAgICBjID0gYyArIG9yZCgnMCcpCiAgICAgICAgcmVzdWx0LmFwcGVuZChjaHIoYykpCiAgICByZXR1cm4gJycuam9pbihyZXN1bHQpCgpoZXhsaWZ5ID0gYjJhX2hleAoKdGFibGVfaGV4ID0gWwogICAgLTEsLTEsLTEsLTEsIC0xLC0xLC0xLC0xLCAtMSwtMSwtMSwtMSwgLTEsLTEsLTEsLTEsCiAgICAtMSwtMSwtMSwtMSwgLTEsLTEsLTEsLTEsIC0xLC0xLC0xLC0xLCAtMSwtMSwtMSwtMSwKICAgIC0xLC0xLC0xLC0xLCAtMSwtMSwtMSwtMSwgLTEsLTEsLTEsLTEsIC0xLC0xLC0xLC0xLAogICAgMCwgMSwgMiwgMywgIDQsIDUsIDYsIDcsICA4LCA5LC0xLC0xLCAtMSwtMSwtMSwtMSwKICAgIC0xLDEwLDExLDEyLCAxMywxNCwxNSwtMSwgLTEsLTEsLTEsLTEsIC0xLC0xLC0xLC0xLAogICAgLTEsLTEsLTEsLTEsIC0xLC0xLC0xLC0xLCAtMSwtMSwtMSwtMSwgLTEsLTEsLTEsLTEsCiAgICAtMSwxMCwxMSwxMiwgMTMsMTQsMTUsLTEsIC0xLC0xLC0xLC0xLCAtMSwtMSwtMSwtMSwKICAgIC0xLC0xLC0xLC0xLCAtMSwtMSwtMSwtMSwgLTEsLTEsLTEsLTEsIC0xLC0xLC0xLC0xCl0KCgpkZWYgYTJiX2hleCh0KToKICAgIHJlc3VsdCA9IFtdCgogICAgZGVmIHBhaXJzX2dlbihzKToKICAgICAgICB3aGlsZSBzOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB5aWVsZCB0YWJsZV9oZXhbb3JkKHNbMF0pXSwgdGFibGVfaGV4W29yZChzWzFdKV0KICAgICAgICAgICAgZXhjZXB0IEluZGV4RXJyb3I6CiAgICAgICAgICAgICAgICBpZiBsZW4ocyk6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdPZGQtbGVuZ3RoIHN0cmluZycpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgcyA9IHNbMjpdCgogICAgZm9yIGEsIGIgaW4gcGFpcnNfZ2VuKHQpOgogICAgICAgIGlmIGEgPCAwIG9yIGIgPCAwOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ05vbi1oZXhhZGVjaW1hbCBkaWdpdCBmb3VuZCcpCiAgICAgICAgcmVzdWx0LmFwcGVuZChjaHIoKGEgPDwgNCkgKyBiKSkKICAgIHJldHVybiAnJy5qb2luKHJlc3VsdCkKICAgIAoKdW5oZXhsaWZ5ID0gYTJiX2hleAo=',
'/Lib/bisect.py':'IiIiQmlzZWN0aW9uIGFsZ29yaXRobXMuIiIiCgpkZWYgaW5zb3J0X3JpZ2h0KGEsIHgsIGxvPTAsIGhpPU5vbmUpOgogICAgIiIiSW5zZXJ0IGl0ZW0geCBpbiBsaXN0IGEsIGFuZCBrZWVwIGl0IHNvcnRlZCBhc3N1bWluZyBhIGlzIHNvcnRlZC4KCiAgICBJZiB4IGlzIGFscmVhZHkgaW4gYSwgaW5zZXJ0IGl0IHRvIHRoZSByaWdodCBvZiB0aGUgcmlnaHRtb3N0IHguCgogICAgT3B0aW9uYWwgYXJncyBsbyAoZGVmYXVsdCAwKSBhbmQgaGkgKGRlZmF1bHQgbGVuKGEpKSBib3VuZCB0aGUKICAgIHNsaWNlIG9mIGEgdG8gYmUgc2VhcmNoZWQuCiAgICAiIiIKCiAgICBpZiBsbyA8IDA6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignbG8gbXVzdCBiZSBub24tbmVnYXRpdmUnKQogICAgaWYgaGkgaXMgTm9uZToKICAgICAgICBoaSA9IGxlbihhKQogICAgd2hpbGUgbG8gPCBoaToKICAgICAgICBtaWQgPSAobG8raGkpLy8yCiAgICAgICAgaWYgeCA8IGFbbWlkXTogaGkgPSBtaWQKICAgICAgICBlbHNlOiBsbyA9IG1pZCsxCiAgICBhLmluc2VydChsbywgeCkKCmluc29ydCA9IGluc29ydF9yaWdodCAgICMgYmFja3dhcmQgY29tcGF0aWJpbGl0eQoKZGVmIGJpc2VjdF9yaWdodChhLCB4LCBsbz0wLCBoaT1Ob25lKToKICAgICIiIlJldHVybiB0aGUgaW5kZXggd2hlcmUgdG8gaW5zZXJ0IGl0ZW0geCBpbiBsaXN0IGEsIGFzc3VtaW5nIGEgaXMgc29ydGVkLgoKICAgIFRoZSByZXR1cm4gdmFsdWUgaSBpcyBzdWNoIHRoYXQgYWxsIGUgaW4gYVs6aV0gaGF2ZSBlIDw9IHgsIGFuZCBhbGwgZSBpbgogICAgYVtpOl0gaGF2ZSBlID4geC4gIFNvIGlmIHggYWxyZWFkeSBhcHBlYXJzIGluIHRoZSBsaXN0LCBhLmluc2VydCh4KSB3aWxsCiAgICBpbnNlcnQganVzdCBhZnRlciB0aGUgcmlnaHRtb3N0IHggYWxyZWFkeSB0aGVyZS4KCiAgICBPcHRpb25hbCBhcmdzIGxvIChkZWZhdWx0IDApIGFuZCBoaSAoZGVmYXVsdCBsZW4oYSkpIGJvdW5kIHRoZQogICAgc2xpY2Ugb2YgYSB0byBiZSBzZWFyY2hlZC4KICAgICIiIgoKICAgIGlmIGxvIDwgMDoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdsbyBtdXN0IGJlIG5vbi1uZWdhdGl2ZScpCiAgICBpZiBoaSBpcyBOb25lOgogICAgICAgIGhpID0gbGVuKGEpCiAgICB3aGlsZSBsbyA8IGhpOgogICAgICAgIG1pZCA9IChsbytoaSkvLzIKICAgICAgICBpZiB4IDwgYVttaWRdOiBoaSA9IG1pZAogICAgICAgIGVsc2U6IGxvID0gbWlkKzEKICAgIHJldHVybiBsbwoKYmlzZWN0ID0gYmlzZWN0X3JpZ2h0ICAgIyBiYWNrd2FyZCBjb21wYXRpYmlsaXR5CgpkZWYgaW5zb3J0X2xlZnQoYSwgeCwgbG89MCwgaGk9Tm9uZSk6CiAgICAiIiJJbnNlcnQgaXRlbSB4IGluIGxpc3QgYSwgYW5kIGtlZXAgaXQgc29ydGVkIGFzc3VtaW5nIGEgaXMgc29ydGVkLgoKICAgIElmIHggaXMgYWxyZWFkeSBpbiBhLCBpbnNlcnQgaXQgdG8gdGhlIGxlZnQgb2YgdGhlIGxlZnRtb3N0IHguCgogICAgT3B0aW9uYWwgYXJncyBsbyAoZGVmYXVsdCAwKSBhbmQgaGkgKGRlZmF1bHQgbGVuKGEpKSBib3VuZCB0aGUKICAgIHNsaWNlIG9mIGEgdG8gYmUgc2VhcmNoZWQuCiAgICAiIiIKCiAgICBpZiBsbyA8IDA6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignbG8gbXVzdCBiZSBub24tbmVnYXRpdmUnKQogICAgaWYgaGkgaXMgTm9uZToKICAgICAgICBoaSA9IGxlbihhKQogICAgd2hpbGUgbG8gPCBoaToKICAgICAgICBtaWQgPSAobG8raGkpLy8yCiAgICAgICAgaWYgYVttaWRdIDwgeDogbG8gPSBtaWQrMQogICAgICAgIGVsc2U6IGhpID0gbWlkCiAgICBhLmluc2VydChsbywgeCkKCgpkZWYgYmlzZWN0X2xlZnQoYSwgeCwgbG89MCwgaGk9Tm9uZSk6CiAgICAiIiJSZXR1cm4gdGhlIGluZGV4IHdoZXJlIHRvIGluc2VydCBpdGVtIHggaW4gbGlzdCBhLCBhc3N1bWluZyBhIGlzIHNvcnRlZC4KCiAgICBUaGUgcmV0dXJuIHZhbHVlIGkgaXMgc3VjaCB0aGF0IGFsbCBlIGluIGFbOmldIGhhdmUgZSA8IHgsIGFuZCBhbGwgZSBpbgogICAgYVtpOl0gaGF2ZSBlID49IHguICBTbyBpZiB4IGFscmVhZHkgYXBwZWFycyBpbiB0aGUgbGlzdCwgYS5pbnNlcnQoeCkgd2lsbAogICAgaW5zZXJ0IGp1c3QgYmVmb3JlIHRoZSBsZWZ0bW9zdCB4IGFscmVhZHkgdGhlcmUuCgogICAgT3B0aW9uYWwgYXJncyBsbyAoZGVmYXVsdCAwKSBhbmQgaGkgKGRlZmF1bHQgbGVuKGEpKSBib3VuZCB0aGUKICAgIHNsaWNlIG9mIGEgdG8gYmUgc2VhcmNoZWQuCiAgICAiIiIKCiAgICBpZiBsbyA8IDA6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignbG8gbXVzdCBiZSBub24tbmVnYXRpdmUnKQogICAgaWYgaGkgaXMgTm9uZToKICAgICAgICBoaSA9IGxlbihhKQogICAgd2hpbGUgbG8gPCBoaToKICAgICAgICBtaWQgPSAobG8raGkpLy8yCiAgICAgICAgaWYgYVttaWRdIDwgeDogbG8gPSBtaWQrMQogICAgICAgIGVsc2U6IGhpID0gbWlkCiAgICByZXR1cm4gbG8KCiMgZG9udCcgbmVlZCB0aGlzIGZvciBicnl0aG9uCiMgT3ZlcndyaXRlIGFib3ZlIGRlZmluaXRpb25zIHdpdGggYSBmYXN0IEMgaW1wbGVtZW50YXRpb24KI3RyeToKIyAgICBmcm9tIF9iaXNlY3QgaW1wb3J0ICoKI2V4Y2VwdCBJbXBvcnRFcnJvcjoKIyAgICBwYXNzCg==',
'/Lib/calendar.py':'IiIiQ2FsZW5kYXIgcHJpbnRpbmcgZnVuY3Rpb25zCgpOb3RlIHdoZW4gY29tcGFyaW5nIHRoZXNlIGNhbGVuZGFycyB0byB0aGUgb25lcyBwcmludGVkIGJ5IGNhbCgxKTogQnkKZGVmYXVsdCwgdGhlc2UgY2FsZW5kYXJzIGhhdmUgTW9uZGF5IGFzIHRoZSBmaXJzdCBkYXkgb2YgdGhlIHdlZWssIGFuZApTdW5kYXkgYXMgdGhlIGxhc3QgKHRoZSBFdXJvcGVhbiBjb252ZW50aW9uKS4gVXNlIHNldGZpcnN0d2Vla2RheSgpIHRvCnNldCB0aGUgZmlyc3QgZGF5IG9mIHRoZSB3ZWVrICgwPU1vbmRheSwgNj1TdW5kYXkpLiIiIgoKaW1wb3J0IHN5cwppbXBvcnQgZGF0ZXRpbWUKaW1wb3J0IGxvY2FsZSBhcyBfbG9jYWxlCgpfX2FsbF9fID0gWyJJbGxlZ2FsTW9udGhFcnJvciIsICJJbGxlZ2FsV2Vla2RheUVycm9yIiwgInNldGZpcnN0d2Vla2RheSIsCiAgICAgICAgICAgImZpcnN0d2Vla2RheSIsICJpc2xlYXAiLCAibGVhcGRheXMiLCAid2Vla2RheSIsICJtb250aHJhbmdlIiwKICAgICAgICAgICAibW9udGhjYWxlbmRhciIsICJwcm1vbnRoIiwgIm1vbnRoIiwgInByY2FsIiwgImNhbGVuZGFyIiwKICAgICAgICAgICAidGltZWdtIiwgIm1vbnRoX25hbWUiLCAibW9udGhfYWJiciIsICJkYXlfbmFtZSIsICJkYXlfYWJiciJdCgojIEV4Y2VwdGlvbiByYWlzZWQgZm9yIGJhZCBpbnB1dCAod2l0aCBzdHJpbmcgcGFyYW1ldGVyIGZvciBkZXRhaWxzKQplcnJvciA9IFZhbHVlRXJyb3IKCiMgRXhjZXB0aW9ucyByYWlzZWQgZm9yIGJhZCBpbnB1dApjbGFzcyBJbGxlZ2FsTW9udGhFcnJvcihWYWx1ZUVycm9yKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBtb250aCk6CiAgICAgICAgc2VsZi5tb250aCA9IG1vbnRoCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gImJhZCBtb250aCBudW1iZXIgJXI7IG11c3QgYmUgMS0xMiIgJSBzZWxmLm1vbnRoCgoKY2xhc3MgSWxsZWdhbFdlZWtkYXlFcnJvcihWYWx1ZUVycm9yKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB3ZWVrZGF5KToKICAgICAgICBzZWxmLndlZWtkYXkgPSB3ZWVrZGF5CiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gImJhZCB3ZWVrZGF5IG51bWJlciAlcjsgbXVzdCBiZSAwIChNb25kYXkpIHRvIDYgKFN1bmRheSkiICUgc2VsZi53ZWVrZGF5CgoKIyBDb25zdGFudHMgZm9yIG1vbnRocyByZWZlcmVuY2VkIGxhdGVyCkphbnVhcnkgPSAxCkZlYnJ1YXJ5ID0gMgoKIyBOdW1iZXIgb2YgZGF5cyBwZXIgbW9udGggKGV4Y2VwdCBmb3IgRmVicnVhcnkgaW4gbGVhcCB5ZWFycykKbWRheXMgPSBbMCwgMzEsIDI4LCAzMSwgMzAsIDMxLCAzMCwgMzEsIDMxLCAzMCwgMzEsIDMwLCAzMV0KCiMgVGhpcyBtb2R1bGUgdXNlZCB0byBoYXZlIGhhcmQtY29kZWQgbGlzdHMgb2YgZGF5IGFuZCBtb250aCBuYW1lcywgYXMKIyBFbmdsaXNoIHN0cmluZ3MuICBUaGUgY2xhc3NlcyBmb2xsb3dpbmcgZW11bGF0ZSBhIHJlYWQtb25seSB2ZXJzaW9uIG9mCiMgdGhhdCwgYnV0IHN1cHBseSBsb2NhbGl6ZWQgbmFtZXMuICBOb3RlIHRoYXQgdGhlIHZhbHVlcyBhcmUgY29tcHV0ZWQKIyBmcmVzaCBvbiBlYWNoIGNhbGwsIGluIGNhc2UgdGhlIHVzZXIgY2hhbmdlcyBsb2NhbGUgYmV0d2VlbiBjYWxscy4KCmNsYXNzIF9sb2NhbGl6ZWRfbW9udGg6CgogICAgX21vbnRocyA9IFtkYXRldGltZS5kYXRlKDIwMDEsIGkrMSwgMSkuc3RyZnRpbWUgZm9yIGkgaW4gcmFuZ2UoMTIpXQogICAgX21vbnRocy5pbnNlcnQoMCwgbGFtYmRhIHg6ICIiKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBmb3JtYXQpOgogICAgICAgIHNlbGYuZm9ybWF0ID0gZm9ybWF0CgogICAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGkpOgogICAgICAgIGZ1bmNzID0gc2VsZi5fbW9udGhzW2ldCiAgICAgICAgaWYgaXNpbnN0YW5jZShpLCBzbGljZSk6CiAgICAgICAgICAgIHJldHVybiBbZihzZWxmLmZvcm1hdCkgZm9yIGYgaW4gZnVuY3NdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIGZ1bmNzKHNlbGYuZm9ybWF0KQoKICAgIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICAgIHJldHVybiAxMwoKCmNsYXNzIF9sb2NhbGl6ZWRfZGF5OgoKICAgICMgSmFudWFyeSAxLCAyMDAxLCB3YXMgYSBNb25kYXkuCiAgICBfZGF5cyA9IFtkYXRldGltZS5kYXRlKDIwMDEsIDEsIGkrMSkuc3RyZnRpbWUgZm9yIGkgaW4gcmFuZ2UoNyldCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGZvcm1hdCk6CiAgICAgICAgc2VsZi5mb3JtYXQgPSBmb3JtYXQKCiAgICBkZWYgX19nZXRpdGVtX18oc2VsZiwgaSk6CiAgICAgICAgZnVuY3MgPSBzZWxmLl9kYXlzW2ldCiAgICAgICAgaWYgaXNpbnN0YW5jZShpLCBzbGljZSk6CiAgICAgICAgICAgIHJldHVybiBbZihzZWxmLmZvcm1hdCkgZm9yIGYgaW4gZnVuY3NdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIGZ1bmNzKHNlbGYuZm9ybWF0KQoKICAgIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICAgIHJldHVybiA3CgoKIyBGdWxsIGFuZCBhYmJyZXZpYXRlZCBuYW1lcyBvZiB3ZWVrZGF5cwpkYXlfbmFtZSA9IF9sb2NhbGl6ZWRfZGF5KCclQScpCmRheV9hYmJyID0gX2xvY2FsaXplZF9kYXkoJyVhJykKCiMgRnVsbCBhbmQgYWJicmV2aWF0ZWQgbmFtZXMgb2YgbW9udGhzICgxLWJhc2VkIGFycmF5cyEhISkKbW9udGhfbmFtZSA9IF9sb2NhbGl6ZWRfbW9udGgoJyVCJykKbW9udGhfYWJiciA9IF9sb2NhbGl6ZWRfbW9udGgoJyViJykKCiMgQ29uc3RhbnRzIGZvciB3ZWVrZGF5cwooTU9OREFZLCBUVUVTREFZLCBXRURORVNEQVksIFRIVVJTREFZLCBGUklEQVksIFNBVFVSREFZLCBTVU5EQVkpID0gcmFuZ2UoNykKCgpkZWYgaXNsZWFwKHllYXIpOgogICAgIiIiUmV0dXJuIFRydWUgZm9yIGxlYXAgeWVhcnMsIEZhbHNlIGZvciBub24tbGVhcCB5ZWFycy4iIiIKICAgIHJldHVybiB5ZWFyICUgNCA9PSAwIGFuZCAoeWVhciAlIDEwMCAhPSAwIG9yIHllYXIgJSA0MDAgPT0gMCkKCgpkZWYgbGVhcGRheXMoeTEsIHkyKToKICAgICIiIlJldHVybiBudW1iZXIgb2YgbGVhcCB5ZWFycyBpbiByYW5nZSBbeTEsIHkyKS4KICAgICAgIEFzc3VtZSB5MSA8PSB5Mi4iIiIKICAgIHkxIC09IDEKICAgIHkyIC09IDEKICAgIHJldHVybiAoeTIvLzQgLSB5MS8vNCkgLSAoeTIvLzEwMCAtIHkxLy8xMDApICsgKHkyLy80MDAgLSB5MS8vNDAwKQoKCmRlZiB3ZWVrZGF5KHllYXIsIG1vbnRoLCBkYXkpOgogICAgIiIiUmV0dXJuIHdlZWtkYXkgKDAtNiB+IE1vbi1TdW4pIGZvciB5ZWFyICgxOTcwLS4uLiksIG1vbnRoICgxLTEyKSwKICAgICAgIGRheSAoMS0zMSkuIiIiCiAgICByZXR1cm4gZGF0ZXRpbWUuZGF0ZSh5ZWFyLCBtb250aCwgZGF5KS53ZWVrZGF5KCkKCgpkZWYgbW9udGhyYW5nZSh5ZWFyLCBtb250aCk6CiAgICAiIiJSZXR1cm4gd2Vla2RheSAoMC02IH4gTW9uLVN1bikgYW5kIG51bWJlciBvZiBkYXlzICgyOC0zMSkgZm9yCiAgICAgICB5ZWFyLCBtb250aC4iIiIKICAgIGlmIG5vdCAxIDw9IG1vbnRoIDw9IDEyOgogICAgICAgIHJhaXNlIElsbGVnYWxNb250aEVycm9yKG1vbnRoKQogICAgZGF5MSA9IHdlZWtkYXkoeWVhciwgbW9udGgsIDEpCiAgICBuZGF5cyA9IG1kYXlzW21vbnRoXSArIChtb250aCA9PSBGZWJydWFyeSBhbmQgaXNsZWFwKHllYXIpKQogICAgcmV0dXJuIGRheTEsIG5kYXlzCgoKY2xhc3MgQ2FsZW5kYXIob2JqZWN0KToKICAgICIiIgogICAgQmFzZSBjYWxlbmRhciBjbGFzcy4gVGhpcyBjbGFzcyBkb2Vzbid0IGRvIGFueSBmb3JtYXR0aW5nLiBJdCBzaW1wbHkKICAgIHByb3ZpZGVzIGRhdGEgdG8gc3ViY2xhc3Nlcy4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBmaXJzdHdlZWtkYXk9MCk6CiAgICAgICAgc2VsZi5maXJzdHdlZWtkYXkgPSBmaXJzdHdlZWtkYXkgIyAwID0gTW9uZGF5LCA2ID0gU3VuZGF5CgogICAgZGVmIGdldGZpcnN0d2Vla2RheShzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fZmlyc3R3ZWVrZGF5ICUgNwoKICAgIGRlZiBzZXRmaXJzdHdlZWtkYXkoc2VsZiwgZmlyc3R3ZWVrZGF5KToKICAgICAgICBzZWxmLl9maXJzdHdlZWtkYXkgPSBmaXJzdHdlZWtkYXkKCiAgICBmaXJzdHdlZWtkYXkgPSBwcm9wZXJ0eShnZXRmaXJzdHdlZWtkYXksIHNldGZpcnN0d2Vla2RheSkKCiAgICBkZWYgaXRlcndlZWtkYXlzKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIFJldHVybiBhIGl0ZXJhdG9yIGZvciBvbmUgd2VlayBvZiB3ZWVrZGF5IG51bWJlcnMgc3RhcnRpbmcgd2l0aCB0aGUKICAgICAgICBjb25maWd1cmVkIGZpcnN0IG9uZS4KICAgICAgICAiIiIKICAgICAgICBmb3IgaSBpbiByYW5nZShzZWxmLmZpcnN0d2Vla2RheSwgc2VsZi5maXJzdHdlZWtkYXkgKyA3KToKICAgICAgICAgICAgeWllbGQgaSU3CgogICAgZGVmIGl0ZXJtb250aGRhdGVzKHNlbGYsIHllYXIsIG1vbnRoKToKICAgICAgICAiIiIKICAgICAgICBSZXR1cm4gYW4gaXRlcmF0b3IgZm9yIG9uZSBtb250aC4gVGhlIGl0ZXJhdG9yIHdpbGwgeWllbGQgZGF0ZXRpbWUuZGF0ZQogICAgICAgIHZhbHVlcyBhbmQgd2lsbCBhbHdheXMgaXRlcmF0ZSB0aHJvdWdoIGNvbXBsZXRlIHdlZWtzLCBzbyBpdCB3aWxsIHlpZWxkCiAgICAgICAgZGF0ZXMgb3V0c2lkZSB0aGUgc3BlY2lmaWVkIG1vbnRoLgogICAgICAgICIiIgogICAgICAgIGRhdGUgPSBkYXRldGltZS5kYXRlKHllYXIsIG1vbnRoLCAxKQogICAgICAgICMgR28gYmFjayB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSB3ZWVrCiAgICAgICAgZGF5cyA9IChkYXRlLndlZWtkYXkoKSAtIHNlbGYuZmlyc3R3ZWVrZGF5KSAlIDcKICAgICAgICBkYXRlIC09IGRhdGV0aW1lLnRpbWVkZWx0YShkYXlzPWRheXMpCiAgICAgICAgb25lZGF5ID0gZGF0ZXRpbWUudGltZWRlbHRhKGRheXM9MSkKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICB5aWVsZCBkYXRlCiAgICAgICAgICAgIGRhdGUgKz0gb25lZGF5CiAgICAgICAgICAgIGlmIGRhdGUubW9udGggIT0gbW9udGggYW5kIGRhdGUud2Vla2RheSgpID09IHNlbGYuZmlyc3R3ZWVrZGF5OgogICAgICAgICAgICAgICAgYnJlYWsKCiAgICBkZWYgaXRlcm1vbnRoZGF5czIoc2VsZiwgeWVhciwgbW9udGgpOgogICAgICAgICIiIgogICAgICAgIExpa2UgaXRlcm1vbnRoZGF0ZXMoKSwgYnV0IHdpbGwgeWllbGQgKGRheSBudW1iZXIsIHdlZWtkYXkgbnVtYmVyKQogICAgICAgIHR1cGxlcy4gRm9yIGRheXMgb3V0c2lkZSB0aGUgc3BlY2lmaWVkIG1vbnRoIHRoZSBkYXkgbnVtYmVyIGlzIDAuCiAgICAgICAgIiIiCiAgICAgICAgZm9yIGRhdGUgaW4gc2VsZi5pdGVybW9udGhkYXRlcyh5ZWFyLCBtb250aCk6CiAgICAgICAgICAgIGlmIGRhdGUubW9udGggIT0gbW9udGg6CiAgICAgICAgICAgICAgICB5aWVsZCAoMCwgZGF0ZS53ZWVrZGF5KCkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB5aWVsZCAoZGF0ZS5kYXksIGRhdGUud2Vla2RheSgpKQoKICAgIGRlZiBpdGVybW9udGhkYXlzKHNlbGYsIHllYXIsIG1vbnRoKToKICAgICAgICAiIiIKICAgICAgICBMaWtlIGl0ZXJtb250aGRhdGVzKCksIGJ1dCB3aWxsIHlpZWxkIGRheSBudW1iZXJzLiBGb3IgZGF5cyBvdXRzaWRlCiAgICAgICAgdGhlIHNwZWNpZmllZCBtb250aCB0aGUgZGF5IG51bWJlciBpcyAwLgogICAgICAgICIiIgogICAgICAgIGZvciBkYXRlIGluIHNlbGYuaXRlcm1vbnRoZGF0ZXMoeWVhciwgbW9udGgpOgogICAgICAgICAgICBpZiBkYXRlLm1vbnRoICE9IG1vbnRoOgogICAgICAgICAgICAgICAgeWllbGQgMAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgeWllbGQgZGF0ZS5kYXkKCiAgICBkZWYgbW9udGhkYXRlc2NhbGVuZGFyKHNlbGYsIHllYXIsIG1vbnRoKToKICAgICAgICAiIiIKICAgICAgICBSZXR1cm4gYSBtYXRyaXggKGxpc3Qgb2YgbGlzdHMpIHJlcHJlc2VudGluZyBhIG1vbnRoJ3MgY2FsZW5kYXIuCiAgICAgICAgRWFjaCByb3cgcmVwcmVzZW50cyBhIHdlZWs7IHdlZWsgZW50cmllcyBhcmUgZGF0ZXRpbWUuZGF0ZSB2YWx1ZXMuCiAgICAgICAgIiIiCiAgICAgICAgZGF0ZXMgPSBsaXN0KHNlbGYuaXRlcm1vbnRoZGF0ZXMoeWVhciwgbW9udGgpKQogICAgICAgIHJldHVybiBbIGRhdGVzW2k6aSs3XSBmb3IgaSBpbiByYW5nZSgwLCBsZW4oZGF0ZXMpLCA3KSBdCgogICAgZGVmIG1vbnRoZGF5czJjYWxlbmRhcihzZWxmLCB5ZWFyLCBtb250aCk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJuIGEgbWF0cml4IHJlcHJlc2VudGluZyBhIG1vbnRoJ3MgY2FsZW5kYXIuCiAgICAgICAgRWFjaCByb3cgcmVwcmVzZW50cyBhIHdlZWs7IHdlZWsgZW50cmllcyBhcmUKICAgICAgICAoZGF5IG51bWJlciwgd2Vla2RheSBudW1iZXIpIHR1cGxlcy4gRGF5IG51bWJlcnMgb3V0c2lkZSB0aGlzIG1vbnRoCiAgICAgICAgYXJlIHplcm8uCiAgICAgICAgIiIiCiAgICAgICAgZGF5cyA9IGxpc3Qoc2VsZi5pdGVybW9udGhkYXlzMih5ZWFyLCBtb250aCkpCiAgICAgICAgcmV0dXJuIFsgZGF5c1tpOmkrN10gZm9yIGkgaW4gcmFuZ2UoMCwgbGVuKGRheXMpLCA3KSBdCgogICAgZGVmIG1vbnRoZGF5c2NhbGVuZGFyKHNlbGYsIHllYXIsIG1vbnRoKToKICAgICAgICAiIiIKICAgICAgICBSZXR1cm4gYSBtYXRyaXggcmVwcmVzZW50aW5nIGEgbW9udGgncyBjYWxlbmRhci4KICAgICAgICBFYWNoIHJvdyByZXByZXNlbnRzIGEgd2VlazsgZGF5cyBvdXRzaWRlIHRoaXMgbW9udGggYXJlIHplcm8uCiAgICAgICAgIiIiCiAgICAgICAgZGF5cyA9IGxpc3Qoc2VsZi5pdGVybW9udGhkYXlzKHllYXIsIG1vbnRoKSkKICAgICAgICByZXR1cm4gWyBkYXlzW2k6aSs3XSBmb3IgaSBpbiByYW5nZSgwLCBsZW4oZGF5cyksIDcpIF0KCiAgICBkZWYgeWVhcmRhdGVzY2FsZW5kYXIoc2VsZiwgeWVhciwgd2lkdGg9Myk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJuIHRoZSBkYXRhIGZvciB0aGUgc3BlY2lmaWVkIHllYXIgcmVhZHkgZm9yIGZvcm1hdHRpbmcuIFRoZSByZXR1cm4KICAgICAgICB2YWx1ZSBpcyBhIGxpc3Qgb2YgbW9udGggcm93cy4gRWFjaCBtb250aCByb3cgY29udGFpbnMgdXB0byB3aWR0aCBtb250aHMuCiAgICAgICAgRWFjaCBtb250aCBjb250YWlucyBiZXR3ZWVuIDQgYW5kIDYgd2Vla3MgYW5kIGVhY2ggd2VlayBjb250YWlucyAxLTcKICAgICAgICBkYXlzLiBEYXlzIGFyZSBkYXRldGltZS5kYXRlIG9iamVjdHMuCiAgICAgICAgIiIiCiAgICAgICAgbW9udGhzID0gWwogICAgICAgICAgICBzZWxmLm1vbnRoZGF0ZXNjYWxlbmRhcih5ZWFyLCBpKQogICAgICAgICAgICBmb3IgaSBpbiByYW5nZShKYW51YXJ5LCBKYW51YXJ5KzEyKQogICAgICAgIF0KICAgICAgICByZXR1cm4gW21vbnRoc1tpOmkrd2lkdGhdIGZvciBpIGluIHJhbmdlKDAsIGxlbihtb250aHMpLCB3aWR0aCkgXQoKICAgIGRlZiB5ZWFyZGF5czJjYWxlbmRhcihzZWxmLCB5ZWFyLCB3aWR0aD0zKToKICAgICAgICAiIiIKICAgICAgICBSZXR1cm4gdGhlIGRhdGEgZm9yIHRoZSBzcGVjaWZpZWQgeWVhciByZWFkeSBmb3IgZm9ybWF0dGluZyAoc2ltaWxhciB0bwogICAgICAgIHllYXJkYXRlc2NhbGVuZGFyKCkpLiBFbnRyaWVzIGluIHRoZSB3ZWVrIGxpc3RzIGFyZQogICAgICAgIChkYXkgbnVtYmVyLCB3ZWVrZGF5IG51bWJlcikgdHVwbGVzLiBEYXkgbnVtYmVycyBvdXRzaWRlIHRoaXMgbW9udGggYXJlCiAgICAgICAgemVyby4KICAgICAgICAiIiIKICAgICAgICBtb250aHMgPSBbCiAgICAgICAgICAgIHNlbGYubW9udGhkYXlzMmNhbGVuZGFyKHllYXIsIGkpCiAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKEphbnVhcnksIEphbnVhcnkrMTIpCiAgICAgICAgXQogICAgICAgIHJldHVybiBbbW9udGhzW2k6aSt3aWR0aF0gZm9yIGkgaW4gcmFuZ2UoMCwgbGVuKG1vbnRocyksIHdpZHRoKSBdCgogICAgZGVmIHllYXJkYXlzY2FsZW5kYXIoc2VsZiwgeWVhciwgd2lkdGg9Myk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJuIHRoZSBkYXRhIGZvciB0aGUgc3BlY2lmaWVkIHllYXIgcmVhZHkgZm9yIGZvcm1hdHRpbmcgKHNpbWlsYXIgdG8KICAgICAgICB5ZWFyZGF0ZXNjYWxlbmRhcigpKS4gRW50cmllcyBpbiB0aGUgd2VlayBsaXN0cyBhcmUgZGF5IG51bWJlcnMuCiAgICAgICAgRGF5IG51bWJlcnMgb3V0c2lkZSB0aGlzIG1vbnRoIGFyZSB6ZXJvLgogICAgICAgICIiIgogICAgICAgIG1vbnRocyA9IFsKICAgICAgICAgICAgc2VsZi5tb250aGRheXNjYWxlbmRhcih5ZWFyLCBpKQogICAgICAgICAgICBmb3IgaSBpbiByYW5nZShKYW51YXJ5LCBKYW51YXJ5KzEyKQogICAgICAgIF0KICAgICAgICByZXR1cm4gW21vbnRoc1tpOmkrd2lkdGhdIGZvciBpIGluIHJhbmdlKDAsIGxlbihtb250aHMpLCB3aWR0aCkgXQoKCmNsYXNzIFRleHRDYWxlbmRhcihDYWxlbmRhcik6CiAgICAiIiIKICAgIFN1YmNsYXNzIG9mIENhbGVuZGFyIHRoYXQgb3V0cHV0cyBhIGNhbGVuZGFyIGFzIGEgc2ltcGxlIHBsYWluIHRleHQKICAgIHNpbWlsYXIgdG8gdGhlIFVOSVggcHJvZ3JhbSBjYWwuCiAgICAiIiIKCiAgICBkZWYgcHJ3ZWVrKHNlbGYsIHRoZXdlZWssIHdpZHRoKToKICAgICAgICAiIiIKICAgICAgICBQcmludCBhIHNpbmdsZSB3ZWVrIChubyBuZXdsaW5lKS4KICAgICAgICAiIiIKICAgICAgICBwcmludChzZWxmLmZvcm1hdHdlZWsodGhld2Vlaywgd2lkdGgpLCBlbmQ9JyAnKQoKICAgIGRlZiBmb3JtYXRkYXkoc2VsZiwgZGF5LCB3ZWVrZGF5LCB3aWR0aCk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJucyBhIGZvcm1hdHRlZCBkYXkuCiAgICAgICAgIiIiCiAgICAgICAgaWYgZGF5ID09IDA6CiAgICAgICAgICAgIHMgPSAnJwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHMgPSAnJTJpJyAlIGRheSAgICAgICAgICAgICAjIHJpZ2h0LWFsaWduIHNpbmdsZS1kaWdpdCBkYXlzCiAgICAgICAgcmV0dXJuIHMuY2VudGVyKHdpZHRoKQoKICAgIGRlZiBmb3JtYXR3ZWVrKHNlbGYsIHRoZXdlZWssIHdpZHRoKToKICAgICAgICAiIiIKICAgICAgICBSZXR1cm5zIGEgc2luZ2xlIHdlZWsgaW4gYSBzdHJpbmcgKG5vIG5ld2xpbmUpLgogICAgICAgICIiIgogICAgICAgIHJldHVybiAnICcuam9pbihzZWxmLmZvcm1hdGRheShkLCB3ZCwgd2lkdGgpIGZvciAoZCwgd2QpIGluIHRoZXdlZWspCgogICAgZGVmIGZvcm1hdHdlZWtkYXkoc2VsZiwgZGF5LCB3aWR0aCk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJucyBhIGZvcm1hdHRlZCB3ZWVrIGRheSBuYW1lLgogICAgICAgICIiIgogICAgICAgIGlmIHdpZHRoID49IDk6CiAgICAgICAgICAgIG5hbWVzID0gZGF5X25hbWUKICAgICAgICBlbHNlOgogICAgICAgICAgICBuYW1lcyA9IGRheV9hYmJyCiAgICAgICAgcmV0dXJuIG5hbWVzW2RheV1bOndpZHRoXS5jZW50ZXIod2lkdGgpCgogICAgZGVmIGZvcm1hdHdlZWtoZWFkZXIoc2VsZiwgd2lkdGgpOgogICAgICAgICIiIgogICAgICAgIFJldHVybiBhIGhlYWRlciBmb3IgYSB3ZWVrLgogICAgICAgICIiIgogICAgICAgIHJldHVybiAnICcuam9pbihzZWxmLmZvcm1hdHdlZWtkYXkoaSwgd2lkdGgpIGZvciBpIGluIHNlbGYuaXRlcndlZWtkYXlzKCkpCgogICAgZGVmIGZvcm1hdG1vbnRobmFtZShzZWxmLCB0aGV5ZWFyLCB0aGVtb250aCwgd2lkdGgsIHdpdGh5ZWFyPVRydWUpOgogICAgICAgICIiIgogICAgICAgIFJldHVybiBhIGZvcm1hdHRlZCBtb250aCBuYW1lLgogICAgICAgICIiIgogICAgICAgIHMgPSBtb250aF9uYW1lW3RoZW1vbnRoXQogICAgICAgIGlmIHdpdGh5ZWFyOgogICAgICAgICAgICBzID0gIiVzICVyIiAlIChzLCB0aGV5ZWFyKQogICAgICAgIHJldHVybiBzLmNlbnRlcih3aWR0aCkKCiAgICBkZWYgcHJtb250aChzZWxmLCB0aGV5ZWFyLCB0aGVtb250aCwgdz0wLCBsPTApOgogICAgICAgICIiIgogICAgICAgIFByaW50IGEgbW9udGgncyBjYWxlbmRhci4KICAgICAgICAiIiIKICAgICAgICBwcmludChzZWxmLmZvcm1hdG1vbnRoKHRoZXllYXIsIHRoZW1vbnRoLCB3LCBsKSwgZW5kPScgJykKCiAgICBkZWYgZm9ybWF0bW9udGgoc2VsZiwgdGhleWVhciwgdGhlbW9udGgsIHc9MCwgbD0wKToKICAgICAgICAiIiIKICAgICAgICBSZXR1cm4gYSBtb250aCdzIGNhbGVuZGFyIHN0cmluZyAobXVsdGktbGluZSkuCiAgICAgICAgIiIiCiAgICAgICAgdyA9IG1heCgyLCB3KQogICAgICAgIGwgPSBtYXgoMSwgbCkKICAgICAgICBzID0gc2VsZi5mb3JtYXRtb250aG5hbWUodGhleWVhciwgdGhlbW9udGgsIDcgKiAodyArIDEpIC0gMSkKICAgICAgICBzID0gcy5yc3RyaXAoKQogICAgICAgIHMgKz0gJ1xuJyAqIGwKICAgICAgICBzICs9IHNlbGYuZm9ybWF0d2Vla2hlYWRlcih3KS5yc3RyaXAoKQogICAgICAgIHMgKz0gJ1xuJyAqIGwKICAgICAgICBmb3Igd2VlayBpbiBzZWxmLm1vbnRoZGF5czJjYWxlbmRhcih0aGV5ZWFyLCB0aGVtb250aCk6CiAgICAgICAgICAgIHMgKz0gc2VsZi5mb3JtYXR3ZWVrKHdlZWssIHcpLnJzdHJpcCgpCiAgICAgICAgICAgIHMgKz0gJ1xuJyAqIGwKICAgICAgICByZXR1cm4gcwoKICAgIGRlZiBmb3JtYXR5ZWFyKHNlbGYsIHRoZXllYXIsIHc9MiwgbD0xLCBjPTYsIG09Myk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJucyBhIHllYXIncyBjYWxlbmRhciBhcyBhIG11bHRpLWxpbmUgc3RyaW5nLgogICAgICAgICIiIgogICAgICAgIHcgPSBtYXgoMiwgdykKICAgICAgICBsID0gbWF4KDEsIGwpCiAgICAgICAgYyA9IG1heCgyLCBjKQogICAgICAgIGNvbHdpZHRoID0gKHcgKyAxKSAqIDcgLSAxCiAgICAgICAgdiA9IFtdCiAgICAgICAgYSA9IHYuYXBwZW5kCiAgICAgICAgYShyZXByKHRoZXllYXIpLmNlbnRlcihjb2x3aWR0aCptK2MqKG0tMSkpLnJzdHJpcCgpKQogICAgICAgIGEoJ1xuJypsKQogICAgICAgIGhlYWRlciA9IHNlbGYuZm9ybWF0d2Vla2hlYWRlcih3KQogICAgICAgIGZvciAoaSwgcm93KSBpbiBlbnVtZXJhdGUoc2VsZi55ZWFyZGF5czJjYWxlbmRhcih0aGV5ZWFyLCBtKSk6CiAgICAgICAgICAgICMgbW9udGhzIGluIHRoaXMgcm93CiAgICAgICAgICAgIG1vbnRocyA9IHJhbmdlKG0qaSsxLCBtaW4obSooaSsxKSsxLCAxMykpCiAgICAgICAgICAgIGEoJ1xuJypsKQogICAgICAgICAgICBuYW1lcyA9IChzZWxmLmZvcm1hdG1vbnRobmFtZSh0aGV5ZWFyLCBrLCBjb2x3aWR0aCwgRmFsc2UpCiAgICAgICAgICAgICAgICAgICAgIGZvciBrIGluIG1vbnRocykKICAgICAgICAgICAgYShmb3JtYXRzdHJpbmcobmFtZXMsIGNvbHdpZHRoLCBjKS5yc3RyaXAoKSkKICAgICAgICAgICAgYSgnXG4nKmwpCiAgICAgICAgICAgIGhlYWRlcnMgPSAoaGVhZGVyIGZvciBrIGluIG1vbnRocykKICAgICAgICAgICAgYShmb3JtYXRzdHJpbmcoaGVhZGVycywgY29sd2lkdGgsIGMpLnJzdHJpcCgpKQogICAgICAgICAgICBhKCdcbicqbCkKICAgICAgICAgICAgIyBtYXggbnVtYmVyIG9mIHdlZWtzIGZvciB0aGlzIHJvdwogICAgICAgICAgICBoZWlnaHQgPSBtYXgobGVuKGNhbCkgZm9yIGNhbCBpbiByb3cpCiAgICAgICAgICAgIGZvciBqIGluIHJhbmdlKGhlaWdodCk6CiAgICAgICAgICAgICAgICB3ZWVrcyA9IFtdCiAgICAgICAgICAgICAgICBmb3IgY2FsIGluIHJvdzoKICAgICAgICAgICAgICAgICAgICBpZiBqID49IGxlbihjYWwpOgogICAgICAgICAgICAgICAgICAgICAgICB3ZWVrcy5hcHBlbmQoJycpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgd2Vla3MuYXBwZW5kKHNlbGYuZm9ybWF0d2VlayhjYWxbal0sIHcpKQogICAgICAgICAgICAgICAgYShmb3JtYXRzdHJpbmcod2Vla3MsIGNvbHdpZHRoLCBjKS5yc3RyaXAoKSkKICAgICAgICAgICAgICAgIGEoJ1xuJyAqIGwpCiAgICAgICAgcmV0dXJuICcnLmpvaW4odikKCiAgICBkZWYgcHJ5ZWFyKHNlbGYsIHRoZXllYXIsIHc9MCwgbD0wLCBjPTYsIG09Myk6CiAgICAgICAgIiIiUHJpbnQgYSB5ZWFyJ3MgY2FsZW5kYXIuIiIiCiAgICAgICAgcHJpbnQoc2VsZi5mb3JtYXR5ZWFyKHRoZXllYXIsIHcsIGwsIGMsIG0pKQoKCmNsYXNzIEhUTUxDYWxlbmRhcihDYWxlbmRhcik6CiAgICAiIiIKICAgIFRoaXMgY2FsZW5kYXIgcmV0dXJucyBjb21wbGV0ZSBIVE1MIHBhZ2VzLgogICAgIiIiCgogICAgIyBDU1MgY2xhc3NlcyBmb3IgdGhlIGRheSA8dGQ+cwogICAgY3NzY2xhc3NlcyA9IFsibW9uIiwgInR1ZSIsICJ3ZWQiLCAidGh1IiwgImZyaSIsICJzYXQiLCAic3VuIl0KCiAgICBkZWYgZm9ybWF0ZGF5KHNlbGYsIGRheSwgd2Vla2RheSk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJuIGEgZGF5IGFzIGEgdGFibGUgY2VsbC4KICAgICAgICAiIiIKICAgICAgICBpZiBkYXkgPT0gMDoKICAgICAgICAgICAgcmV0dXJuICc8dGQgY2xhc3M9Im5vZGF5Ij4mbmJzcDs8L3RkPicgIyBkYXkgb3V0c2lkZSBtb250aAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiAnPHRkIGNsYXNzPSIlcyI+JWQ8L3RkPicgJSAoc2VsZi5jc3NjbGFzc2VzW3dlZWtkYXldLCBkYXkpCgogICAgZGVmIGZvcm1hdHdlZWsoc2VsZiwgdGhld2Vlayk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJuIGEgY29tcGxldGUgd2VlayBhcyBhIHRhYmxlIHJvdy4KICAgICAgICAiIiIKICAgICAgICBzID0gJycuam9pbihzZWxmLmZvcm1hdGRheShkLCB3ZCkgZm9yIChkLCB3ZCkgaW4gdGhld2VlaykKICAgICAgICByZXR1cm4gJzx0cj4lczwvdHI+JyAlIHMKCiAgICBkZWYgZm9ybWF0d2Vla2RheShzZWxmLCBkYXkpOgogICAgICAgICIiIgogICAgICAgIFJldHVybiBhIHdlZWtkYXkgbmFtZSBhcyBhIHRhYmxlIGhlYWRlci4KICAgICAgICAiIiIKICAgICAgICByZXR1cm4gJzx0aCBjbGFzcz0iJXMiPiVzPC90aD4nICUgKHNlbGYuY3NzY2xhc3Nlc1tkYXldLCBkYXlfYWJicltkYXldKQoKICAgIGRlZiBmb3JtYXR3ZWVraGVhZGVyKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIFJldHVybiBhIGhlYWRlciBmb3IgYSB3ZWVrIGFzIGEgdGFibGUgcm93LgogICAgICAgICIiIgogICAgICAgIHMgPSAnJy5qb2luKHNlbGYuZm9ybWF0d2Vla2RheShpKSBmb3IgaSBpbiBzZWxmLml0ZXJ3ZWVrZGF5cygpKQogICAgICAgIHJldHVybiAnPHRyPiVzPC90cj4nICUgcwoKICAgIGRlZiBmb3JtYXRtb250aG5hbWUoc2VsZiwgdGhleWVhciwgdGhlbW9udGgsIHdpdGh5ZWFyPVRydWUpOgogICAgICAgICIiIgogICAgICAgIFJldHVybiBhIG1vbnRoIG5hbWUgYXMgYSB0YWJsZSByb3cuCiAgICAgICAgIiIiCiAgICAgICAgaWYgd2l0aHllYXI6CiAgICAgICAgICAgIHMgPSAnJXMgJXMnICUgKG1vbnRoX25hbWVbdGhlbW9udGhdLCB0aGV5ZWFyKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHMgPSAnJXMnICUgbW9udGhfbmFtZVt0aGVtb250aF0KICAgICAgICByZXR1cm4gJzx0cj48dGggY29sc3Bhbj0iNyIgY2xhc3M9Im1vbnRoIj4lczwvdGg+PC90cj4nICUgcwoKICAgIGRlZiBmb3JtYXRtb250aChzZWxmLCB0aGV5ZWFyLCB0aGVtb250aCwgd2l0aHllYXI9VHJ1ZSk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJuIGEgZm9ybWF0dGVkIG1vbnRoIGFzIGEgdGFibGUuCiAgICAgICAgIiIiCiAgICAgICAgdiA9IFtdCiAgICAgICAgYSA9IHYuYXBwZW5kCiAgICAgICAgYSgnPHRhYmxlIGJvcmRlcj0iMCIgY2VsbHBhZGRpbmc9IjAiIGNlbGxzcGFjaW5nPSIwIiBjbGFzcz0ibW9udGgiPicpCiAgICAgICAgYSgnXG4nKQogICAgICAgIGEoc2VsZi5mb3JtYXRtb250aG5hbWUodGhleWVhciwgdGhlbW9udGgsIHdpdGh5ZWFyPXdpdGh5ZWFyKSkKICAgICAgICBhKCdcbicpCiAgICAgICAgYShzZWxmLmZvcm1hdHdlZWtoZWFkZXIoKSkKICAgICAgICBhKCdcbicpCiAgICAgICAgZm9yIHdlZWsgaW4gc2VsZi5tb250aGRheXMyY2FsZW5kYXIodGhleWVhciwgdGhlbW9udGgpOgogICAgICAgICAgICBhKHNlbGYuZm9ybWF0d2Vlayh3ZWVrKSkKICAgICAgICAgICAgYSgnXG4nKQogICAgICAgIGEoJzwvdGFibGU+JykKICAgICAgICBhKCdcbicpCiAgICAgICAgcmV0dXJuICcnLmpvaW4odikKCiAgICBkZWYgZm9ybWF0eWVhcihzZWxmLCB0aGV5ZWFyLCB3aWR0aD0zKToKICAgICAgICAiIiIKICAgICAgICBSZXR1cm4gYSBmb3JtYXR0ZWQgeWVhciBhcyBhIHRhYmxlIG9mIHRhYmxlcy4KICAgICAgICAiIiIKICAgICAgICB2ID0gW10KICAgICAgICBhID0gdi5hcHBlbmQKICAgICAgICB3aWR0aCA9IG1heCh3aWR0aCwgMSkKICAgICAgICBhKCc8dGFibGUgYm9yZGVyPSIwIiBjZWxscGFkZGluZz0iMCIgY2VsbHNwYWNpbmc9IjAiIGNsYXNzPSJ5ZWFyIj4nKQogICAgICAgIGEoJ1xuJykKICAgICAgICBhKCc8dHI+PHRoIGNvbHNwYW49IiVkIiBjbGFzcz0ieWVhciI+JXM8L3RoPjwvdHI+JyAlICh3aWR0aCwgdGhleWVhcikpCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UoSmFudWFyeSwgSmFudWFyeSsxMiwgd2lkdGgpOgogICAgICAgICAgICAjIG1vbnRocyBpbiB0aGlzIHJvdwogICAgICAgICAgICBtb250aHMgPSByYW5nZShpLCBtaW4oaSt3aWR0aCwgMTMpKQogICAgICAgICAgICBhKCc8dHI+JykKICAgICAgICAgICAgZm9yIG0gaW4gbW9udGhzOgogICAgICAgICAgICAgICAgYSgnPHRkPicpCiAgICAgICAgICAgICAgICBhKHNlbGYuZm9ybWF0bW9udGgodGhleWVhciwgbSwgd2l0aHllYXI9RmFsc2UpKQogICAgICAgICAgICAgICAgYSgnPC90ZD4nKQogICAgICAgICAgICBhKCc8L3RyPicpCiAgICAgICAgYSgnPC90YWJsZT4nKQogICAgICAgIHJldHVybiAnJy5qb2luKHYpCgogICAgZGVmIGZvcm1hdHllYXJwYWdlKHNlbGYsIHRoZXllYXIsIHdpZHRoPTMsIGNzcz0nY2FsZW5kYXIuY3NzJywgZW5jb2Rpbmc9Tm9uZSk6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJuIGEgZm9ybWF0dGVkIHllYXIgYXMgYSBjb21wbGV0ZSBIVE1MIHBhZ2UuCiAgICAgICAgIiIiCiAgICAgICAgaWYgZW5jb2RpbmcgaXMgTm9uZToKICAgICAgICAgICAgZW5jb2RpbmcgPSBzeXMuZ2V0ZGVmYXVsdGVuY29kaW5nKCkKICAgICAgICB2ID0gW10KICAgICAgICBhID0gdi5hcHBlbmQKICAgICAgICBhKCc8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSIlcyI/PlxuJyAlIGVuY29kaW5nKQogICAgICAgIGEoJzwhRE9DVFlQRSBodG1sIFBVQkxJQyAiLS8vVzNDLy9EVEQgWEhUTUwgMS4wIFN0cmljdC8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9UUi94aHRtbDEvRFREL3hodG1sMS1zdHJpY3QuZHRkIj5cbicpCiAgICAgICAgYSgnPGh0bWw+XG4nKQogICAgICAgIGEoJzxoZWFkPlxuJykKICAgICAgICBhKCc8bWV0YSBodHRwLWVxdWl2PSJDb250ZW50LVR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD0lcyIgLz5cbicgJSBlbmNvZGluZykKICAgICAgICBpZiBjc3MgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGEoJzxsaW5rIHJlbD0ic3R5bGVzaGVldCIgdHlwZT0idGV4dC9jc3MiIGhyZWY9IiVzIiAvPlxuJyAlIGNzcykKICAgICAgICBhKCc8dGl0bGU+Q2FsZW5kYXIgZm9yICVkPC90aXRsZT5cbicgJSB0aGV5ZWFyKQogICAgICAgIGEoJzwvaGVhZD5cbicpCiAgICAgICAgYSgnPGJvZHk+XG4nKQogICAgICAgIGEoc2VsZi5mb3JtYXR5ZWFyKHRoZXllYXIsIHdpZHRoKSkKICAgICAgICBhKCc8L2JvZHk+XG4nKQogICAgICAgIGEoJzwvaHRtbD5cbicpCiAgICAgICAgcmV0dXJuICcnLmpvaW4odikuZW5jb2RlKGVuY29kaW5nLCAieG1sY2hhcnJlZnJlcGxhY2UiKQoKCmNsYXNzIGRpZmZlcmVudF9sb2NhbGU6CiAgICBkZWYgX19pbml0X18oc2VsZiwgbG9jYWxlKToKICAgICAgICBzZWxmLmxvY2FsZSA9IGxvY2FsZQoKICAgIGRlZiBfX2VudGVyX18oc2VsZik6CiAgICAgICAgc2VsZi5vbGRsb2NhbGUgPSBfbG9jYWxlLmdldGxvY2FsZShfbG9jYWxlLkxDX1RJTUUpCiAgICAgICAgX2xvY2FsZS5zZXRsb2NhbGUoX2xvY2FsZS5MQ19USU1FLCBzZWxmLmxvY2FsZSkKCiAgICBkZWYgX19leGl0X18oc2VsZiwgKmFyZ3MpOgogICAgICAgIF9sb2NhbGUuc2V0bG9jYWxlKF9sb2NhbGUuTENfVElNRSwgc2VsZi5vbGRsb2NhbGUpCgoKY2xhc3MgTG9jYWxlVGV4dENhbGVuZGFyKFRleHRDYWxlbmRhcik6CiAgICAiIiIKICAgIFRoaXMgY2xhc3MgY2FuIGJlIHBhc3NlZCBhIGxvY2FsZSBuYW1lIGluIHRoZSBjb25zdHJ1Y3RvciBhbmQgd2lsbCByZXR1cm4KICAgIG1vbnRoIGFuZCB3ZWVrZGF5IG5hbWVzIGluIHRoZSBzcGVjaWZpZWQgbG9jYWxlLiBJZiB0aGlzIGxvY2FsZSBpbmNsdWRlcwogICAgYW4gZW5jb2RpbmcgYWxsIHN0cmluZ3MgY29udGFpbmluZyBtb250aCBhbmQgd2Vla2RheSBuYW1lcyB3aWxsIGJlIHJldHVybmVkCiAgICBhcyB1bmljb2RlLgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGZpcnN0d2Vla2RheT0wLCBsb2NhbGU9Tm9uZSk6CiAgICAgICAgVGV4dENhbGVuZGFyLl9faW5pdF9fKHNlbGYsIGZpcnN0d2Vla2RheSkKICAgICAgICBpZiBsb2NhbGUgaXMgTm9uZToKICAgICAgICAgICAgbG9jYWxlID0gX2xvY2FsZS5nZXRkZWZhdWx0bG9jYWxlKCkKICAgICAgICBzZWxmLmxvY2FsZSA9IGxvY2FsZQoKICAgIGRlZiBmb3JtYXR3ZWVrZGF5KHNlbGYsIGRheSwgd2lkdGgpOgogICAgICAgIHdpdGggZGlmZmVyZW50X2xvY2FsZShzZWxmLmxvY2FsZSk6CiAgICAgICAgICAgIGlmIHdpZHRoID49IDk6CiAgICAgICAgICAgICAgICBuYW1lcyA9IGRheV9uYW1lCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBuYW1lcyA9IGRheV9hYmJyCiAgICAgICAgICAgIG5hbWUgPSBuYW1lc1tkYXldCiAgICAgICAgICAgIHJldHVybiBuYW1lWzp3aWR0aF0uY2VudGVyKHdpZHRoKQoKICAgIGRlZiBmb3JtYXRtb250aG5hbWUoc2VsZiwgdGhleWVhciwgdGhlbW9udGgsIHdpZHRoLCB3aXRoeWVhcj1UcnVlKToKICAgICAgICB3aXRoIGRpZmZlcmVudF9sb2NhbGUoc2VsZi5sb2NhbGUpOgogICAgICAgICAgICBzID0gbW9udGhfbmFtZVt0aGVtb250aF0KICAgICAgICAgICAgaWYgd2l0aHllYXI6CiAgICAgICAgICAgICAgICBzID0gIiVzICVyIiAlIChzLCB0aGV5ZWFyKQogICAgICAgICAgICByZXR1cm4gcy5jZW50ZXIod2lkdGgpCgoKY2xhc3MgTG9jYWxlSFRNTENhbGVuZGFyKEhUTUxDYWxlbmRhcik6CiAgICAiIiIKICAgIFRoaXMgY2xhc3MgY2FuIGJlIHBhc3NlZCBhIGxvY2FsZSBuYW1lIGluIHRoZSBjb25zdHJ1Y3RvciBhbmQgd2lsbCByZXR1cm4KICAgIG1vbnRoIGFuZCB3ZWVrZGF5IG5hbWVzIGluIHRoZSBzcGVjaWZpZWQgbG9jYWxlLiBJZiB0aGlzIGxvY2FsZSBpbmNsdWRlcwogICAgYW4gZW5jb2RpbmcgYWxsIHN0cmluZ3MgY29udGFpbmluZyBtb250aCBhbmQgd2Vla2RheSBuYW1lcyB3aWxsIGJlIHJldHVybmVkCiAgICBhcyB1bmljb2RlLgogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgZmlyc3R3ZWVrZGF5PTAsIGxvY2FsZT1Ob25lKToKICAgICAgICBIVE1MQ2FsZW5kYXIuX19pbml0X18oc2VsZiwgZmlyc3R3ZWVrZGF5KQogICAgICAgIGlmIGxvY2FsZSBpcyBOb25lOgogICAgICAgICAgICBsb2NhbGUgPSBfbG9jYWxlLmdldGRlZmF1bHRsb2NhbGUoKQogICAgICAgIHNlbGYubG9jYWxlID0gbG9jYWxlCgogICAgZGVmIGZvcm1hdHdlZWtkYXkoc2VsZiwgZGF5KToKICAgICAgICB3aXRoIGRpZmZlcmVudF9sb2NhbGUoc2VsZi5sb2NhbGUpOgogICAgICAgICAgICBzID0gZGF5X2FiYnJbZGF5XQogICAgICAgICAgICByZXR1cm4gJzx0aCBjbGFzcz0iJXMiPiVzPC90aD4nICUgKHNlbGYuY3NzY2xhc3Nlc1tkYXldLCBzKQoKICAgIGRlZiBmb3JtYXRtb250aG5hbWUoc2VsZiwgdGhleWVhciwgdGhlbW9udGgsIHdpdGh5ZWFyPVRydWUpOgogICAgICAgIHdpdGggZGlmZmVyZW50X2xvY2FsZShzZWxmLmxvY2FsZSk6CiAgICAgICAgICAgIHMgPSBtb250aF9uYW1lW3RoZW1vbnRoXQogICAgICAgICAgICBpZiB3aXRoeWVhcjoKICAgICAgICAgICAgICAgIHMgPSAnJXMgJXMnICUgKHMsIHRoZXllYXIpCiAgICAgICAgICAgIHJldHVybiAnPHRyPjx0aCBjb2xzcGFuPSI3IiBjbGFzcz0ibW9udGgiPiVzPC90aD48L3RyPicgJSBzCgoKIyBTdXBwb3J0IGZvciBvbGQgbW9kdWxlIGxldmVsIGludGVyZmFjZQpjID0gVGV4dENhbGVuZGFyKCkKCmZpcnN0d2Vla2RheSA9IGMuZ2V0Zmlyc3R3ZWVrZGF5CgpkZWYgc2V0Zmlyc3R3ZWVrZGF5KGZpcnN0d2Vla2RheSk6CiAgICBpZiBub3QgTU9OREFZIDw9IGZpcnN0d2Vla2RheSA8PSBTVU5EQVk6CiAgICAgICAgcmFpc2UgSWxsZWdhbFdlZWtkYXlFcnJvcihmaXJzdHdlZWtkYXkpCiAgICBjLmZpcnN0d2Vla2RheSA9IGZpcnN0d2Vla2RheQoKbW9udGhjYWxlbmRhciA9IGMubW9udGhkYXlzY2FsZW5kYXIKcHJ3ZWVrID0gYy5wcndlZWsKd2VlayA9IGMuZm9ybWF0d2Vlawp3ZWVraGVhZGVyID0gYy5mb3JtYXR3ZWVraGVhZGVyCnBybW9udGggPSBjLnBybW9udGgKbW9udGggPSBjLmZvcm1hdG1vbnRoCmNhbGVuZGFyID0gYy5mb3JtYXR5ZWFyCnByY2FsID0gYy5wcnllYXIKCgojIFNwYWNpbmcgb2YgbW9udGggY29sdW1ucyBmb3IgbXVsdGktY29sdW1uIHllYXIgY2FsZW5kYXIKX2NvbHdpZHRoID0gNyozIC0gMSAgICAgICAgICMgQW1vdW50IHByaW50ZWQgYnkgcHJ3ZWVrKCkKX3NwYWNpbmcgPSA2ICAgICAgICAgICAgICAgICMgTnVtYmVyIG9mIHNwYWNlcyBiZXR3ZWVuIGNvbHVtbnMKCgpkZWYgZm9ybWF0KGNvbHMsIGNvbHdpZHRoPV9jb2x3aWR0aCwgc3BhY2luZz1fc3BhY2luZyk6CiAgICAiIiJQcmludHMgbXVsdGktY29sdW1uIGZvcm1hdHRpbmcgZm9yIHllYXIgY2FsZW5kYXJzIiIiCiAgICBwcmludChmb3JtYXRzdHJpbmcoY29scywgY29sd2lkdGgsIHNwYWNpbmcpKQoKCmRlZiBmb3JtYXRzdHJpbmcoY29scywgY29sd2lkdGg9X2NvbHdpZHRoLCBzcGFjaW5nPV9zcGFjaW5nKToKICAgICIiIlJldHVybnMgYSBzdHJpbmcgZm9ybWF0dGVkIGZyb20gbiBzdHJpbmdzLCBjZW50ZXJlZCB3aXRoaW4gbiBjb2x1bW5zLiIiIgogICAgc3BhY2luZyAqPSAnICcKICAgIHJldHVybiBzcGFjaW5nLmpvaW4oYy5jZW50ZXIoY29sd2lkdGgpIGZvciBjIGluIGNvbHMpCgoKRVBPQ0ggPSAxOTcwCl9FUE9DSF9PUkQgPSBkYXRldGltZS5kYXRlKEVQT0NILCAxLCAxKS50b29yZGluYWwoKQoKCmRlZiB0aW1lZ20odHVwbGUpOgogICAgIiIiVW5yZWxhdGVkIGJ1dCBoYW5keSBmdW5jdGlvbiB0byBjYWxjdWxhdGUgVW5peCB0aW1lc3RhbXAgZnJvbSBHTVQuIiIiCiAgICB5ZWFyLCBtb250aCwgZGF5LCBob3VyLCBtaW51dGUsIHNlY29uZCA9IHR1cGxlWzo2XQogICAgZGF5cyA9IGRhdGV0aW1lLmRhdGUoeWVhciwgbW9udGgsIDEpLnRvb3JkaW5hbCgpIC0gX0VQT0NIX09SRCArIGRheSAtIDEKICAgIGhvdXJzID0gZGF5cyoyNCArIGhvdXIKICAgIG1pbnV0ZXMgPSBob3Vycyo2MCArIG1pbnV0ZQogICAgc2Vjb25kcyA9IG1pbnV0ZXMqNjAgKyBzZWNvbmQKICAgIHJldHVybiBzZWNvbmRzCgoKZGVmIG1haW4oYXJncyk6CiAgICBpbXBvcnQgb3B0cGFyc2UKICAgIHBhcnNlciA9IG9wdHBhcnNlLk9wdGlvblBhcnNlcih1c2FnZT0idXNhZ2U6ICVwcm9nIFtvcHRpb25zXSBbeWVhciBbbW9udGhdXSIpCiAgICBwYXJzZXIuYWRkX29wdGlvbigKICAgICAgICAiLXciLCAiLS13aWR0aCIsCiAgICAgICAgZGVzdD0id2lkdGgiLCB0eXBlPSJpbnQiLCBkZWZhdWx0PTIsCiAgICAgICAgaGVscD0id2lkdGggb2YgZGF0ZSBjb2x1bW4gKGRlZmF1bHQgMiwgdGV4dCBvbmx5KSIKICAgICkKICAgIHBhcnNlci5hZGRfb3B0aW9uKAogICAgICAgICItbCIsICItLWxpbmVzIiwKICAgICAgICBkZXN0PSJsaW5lcyIsIHR5cGU9ImludCIsIGRlZmF1bHQ9MSwKICAgICAgICBoZWxwPSJudW1iZXIgb2YgbGluZXMgZm9yIGVhY2ggd2VlayAoZGVmYXVsdCAxLCB0ZXh0IG9ubHkpIgogICAgKQogICAgcGFyc2VyLmFkZF9vcHRpb24oCiAgICAgICAgIi1zIiwgIi0tc3BhY2luZyIsCiAgICAgICAgZGVzdD0ic3BhY2luZyIsIHR5cGU9ImludCIsIGRlZmF1bHQ9NiwKICAgICAgICBoZWxwPSJzcGFjaW5nIGJldHdlZW4gbW9udGhzIChkZWZhdWx0IDYsIHRleHQgb25seSkiCiAgICApCiAgICBwYXJzZXIuYWRkX29wdGlvbigKICAgICAgICAiLW0iLCAiLS1tb250aHMiLAogICAgICAgIGRlc3Q9Im1vbnRocyIsIHR5cGU9ImludCIsIGRlZmF1bHQ9MywKICAgICAgICBoZWxwPSJtb250aHMgcGVyIHJvdyAoZGVmYXVsdCAzLCB0ZXh0IG9ubHkpIgogICAgKQogICAgcGFyc2VyLmFkZF9vcHRpb24oCiAgICAgICAgIi1jIiwgIi0tY3NzIiwKICAgICAgICBkZXN0PSJjc3MiLCBkZWZhdWx0PSJjYWxlbmRhci5jc3MiLAogICAgICAgIGhlbHA9IkNTUyB0byB1c2UgZm9yIHBhZ2UgKGh0bWwgb25seSkiCiAgICApCiAgICBwYXJzZXIuYWRkX29wdGlvbigKICAgICAgICAiLUwiLCAiLS1sb2NhbGUiLAogICAgICAgIGRlc3Q9ImxvY2FsZSIsIGRlZmF1bHQ9Tm9uZSwKICAgICAgICBoZWxwPSJsb2NhbGUgdG8gYmUgdXNlZCBmcm9tIG1vbnRoIGFuZCB3ZWVrZGF5IG5hbWVzIgogICAgKQogICAgcGFyc2VyLmFkZF9vcHRpb24oCiAgICAgICAgIi1lIiwgIi0tZW5jb2RpbmciLAogICAgICAgIGRlc3Q9ImVuY29kaW5nIiwgZGVmYXVsdD1Ob25lLAogICAgICAgIGhlbHA9IkVuY29kaW5nIHRvIHVzZSBmb3Igb3V0cHV0LiIKICAgICkKICAgIHBhcnNlci5hZGRfb3B0aW9uKAogICAgICAgICItdCIsICItLXR5cGUiLAogICAgICAgIGRlc3Q9InR5cGUiLCBkZWZhdWx0PSJ0ZXh0IiwKICAgICAgICBjaG9pY2VzPSgidGV4dCIsICJodG1sIiksCiAgICAgICAgaGVscD0ib3V0cHV0IHR5cGUgKHRleHQgb3IgaHRtbCkiCiAgICApCgogICAgKG9wdGlvbnMsIGFyZ3MpID0gcGFyc2VyLnBhcnNlX2FyZ3MoYXJncykKCiAgICBpZiBvcHRpb25zLmxvY2FsZSBhbmQgbm90IG9wdGlvbnMuZW5jb2Rpbmc6CiAgICAgICAgcGFyc2VyLmVycm9yKCJpZiAtLWxvY2FsZSBpcyBzcGVjaWZpZWQgLS1lbmNvZGluZyBpcyByZXF1aXJlZCIpCiAgICAgICAgc3lzLmV4aXQoMSkKCiAgICBsb2NhbGUgPSBvcHRpb25zLmxvY2FsZSwgb3B0aW9ucy5lbmNvZGluZwoKICAgIGlmIG9wdGlvbnMudHlwZSA9PSAiaHRtbCI6CiAgICAgICAgaWYgb3B0aW9ucy5sb2NhbGU6CiAgICAgICAgICAgIGNhbCA9IExvY2FsZUhUTUxDYWxlbmRhcihsb2NhbGU9bG9jYWxlKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNhbCA9IEhUTUxDYWxlbmRhcigpCiAgICAgICAgZW5jb2RpbmcgPSBvcHRpb25zLmVuY29kaW5nCiAgICAgICAgaWYgZW5jb2RpbmcgaXMgTm9uZToKICAgICAgICAgICAgZW5jb2RpbmcgPSBzeXMuZ2V0ZGVmYXVsdGVuY29kaW5nKCkKICAgICAgICBvcHRkaWN0ID0gZGljdChlbmNvZGluZz1lbmNvZGluZywgY3NzPW9wdGlvbnMuY3NzKQogICAgICAgIHdyaXRlID0gc3lzLnN0ZG91dC5idWZmZXIud3JpdGUKICAgICAgICBpZiBsZW4oYXJncykgPT0gMToKICAgICAgICAgICAgd3JpdGUoY2FsLmZvcm1hdHllYXJwYWdlKGRhdGV0aW1lLmRhdGUudG9kYXkoKS55ZWFyLCAqKm9wdGRpY3QpKQogICAgICAgIGVsaWYgbGVuKGFyZ3MpID09IDI6CiAgICAgICAgICAgIHdyaXRlKGNhbC5mb3JtYXR5ZWFycGFnZShpbnQoYXJnc1sxXSksICoqb3B0ZGljdCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcGFyc2VyLmVycm9yKCJpbmNvcnJlY3QgbnVtYmVyIG9mIGFyZ3VtZW50cyIpCiAgICAgICAgICAgIHN5cy5leGl0KDEpCiAgICBlbHNlOgogICAgICAgIGlmIG9wdGlvbnMubG9jYWxlOgogICAgICAgICAgICBjYWwgPSBMb2NhbGVUZXh0Q2FsZW5kYXIobG9jYWxlPWxvY2FsZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBjYWwgPSBUZXh0Q2FsZW5kYXIoKQogICAgICAgIG9wdGRpY3QgPSBkaWN0KHc9b3B0aW9ucy53aWR0aCwgbD1vcHRpb25zLmxpbmVzKQogICAgICAgIGlmIGxlbihhcmdzKSAhPSAzOgogICAgICAgICAgICBvcHRkaWN0WyJjIl0gPSBvcHRpb25zLnNwYWNpbmcKICAgICAgICAgICAgb3B0ZGljdFsibSJdID0gb3B0aW9ucy5tb250aHMKICAgICAgICBpZiBsZW4oYXJncykgPT0gMToKICAgICAgICAgICAgcmVzdWx0ID0gY2FsLmZvcm1hdHllYXIoZGF0ZXRpbWUuZGF0ZS50b2RheSgpLnllYXIsICoqb3B0ZGljdCkKICAgICAgICBlbGlmIGxlbihhcmdzKSA9PSAyOgogICAgICAgICAgICByZXN1bHQgPSBjYWwuZm9ybWF0eWVhcihpbnQoYXJnc1sxXSksICoqb3B0ZGljdCkKICAgICAgICBlbGlmIGxlbihhcmdzKSA9PSAzOgogICAgICAgICAgICByZXN1bHQgPSBjYWwuZm9ybWF0bW9udGgoaW50KGFyZ3NbMV0pLCBpbnQoYXJnc1syXSksICoqb3B0ZGljdCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwYXJzZXIuZXJyb3IoImluY29ycmVjdCBudW1iZXIgb2YgYXJndW1lbnRzIikKICAgICAgICAgICAgc3lzLmV4aXQoMSkKICAgICAgICB3cml0ZSA9IHN5cy5zdGRvdXQud3JpdGUKICAgICAgICBpZiBvcHRpb25zLmVuY29kaW5nOgogICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuZW5jb2RlKG9wdGlvbnMuZW5jb2RpbmcpCiAgICAgICAgICAgIHdyaXRlID0gc3lzLnN0ZG91dC5idWZmZXIud3JpdGUKICAgICAgICB3cml0ZShyZXN1bHQpCgoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIG1haW4oc3lzLmFyZ3YpCg==',
'/Lib/codecs.py':'IiIiIGNvZGVjcyAtLSBQeXRob24gQ29kZWMgUmVnaXN0cnksIEFQSSBhbmQgaGVscGVycy4KCgpXcml0dGVuIGJ5IE1hcmMtQW5kcmUgTGVtYnVyZyAobWFsQGxlbWJ1cmcuY29tKS4KCihjKSBDb3B5cmlnaHQgQ05SSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZC4gTk8gV0FSUkFOVFkuCgoiIiIjIgoKaW1wb3J0IGJ1aWx0aW5zLCBzeXMKCiMjIyBSZWdpc3RyeSBhbmQgYnVpbHRpbiBzdGF0ZWxlc3MgY29kZWMgZnVuY3Rpb25zCgp0cnk6CiAgICBmcm9tIF9jb2RlY3MgaW1wb3J0ICoKZXhjZXB0IEltcG9ydEVycm9yIGFzIHdoeToKICAgIHJhaXNlIFN5c3RlbUVycm9yKCdGYWlsZWQgdG8gbG9hZCB0aGUgYnVpbHRpbiBjb2RlY3M6ICVzJyAlIHdoeSkKCl9fYWxsX18gPSBbInJlZ2lzdGVyIiwgImxvb2t1cCIsICJvcGVuIiwgIkVuY29kZWRGaWxlIiwgIkJPTSIsICJCT01fQkUiLAogICAgICAgICAgICJCT01fTEUiLCAiQk9NMzJfQkUiLCAiQk9NMzJfTEUiLCAiQk9NNjRfQkUiLCAiQk9NNjRfTEUiLAogICAgICAgICAgICJCT01fVVRGOCIsICJCT01fVVRGMTYiLCAiQk9NX1VURjE2X0xFIiwgIkJPTV9VVEYxNl9CRSIsCiAgICAgICAgICAgIkJPTV9VVEYzMiIsICJCT01fVVRGMzJfTEUiLCAiQk9NX1VURjMyX0JFIiwKICAgICAgICAgICAic3RyaWN0X2Vycm9ycyIsICJpZ25vcmVfZXJyb3JzIiwgInJlcGxhY2VfZXJyb3JzIiwKICAgICAgICAgICAieG1sY2hhcnJlZnJlcGxhY2VfZXJyb3JzIiwKICAgICAgICAgICAicmVnaXN0ZXJfZXJyb3IiLCAibG9va3VwX2Vycm9yIl0KCiMjIyBDb25zdGFudHMKCiMKIyBCeXRlIE9yZGVyIE1hcmsgKEJPTSA9IFpFUk8gV0lEVEggTk8tQlJFQUsgU1BBQ0UgPSBVK0ZFRkYpCiMgYW5kIGl0cyBwb3NzaWJsZSBieXRlIHN0cmluZyB2YWx1ZXMKIyBmb3IgVVRGOC9VVEYxNi9VVEYzMiBvdXRwdXQgYW5kIGxpdHRsZS9iaWcgZW5kaWFuIG1hY2hpbmVzCiMKCiMgVVRGLTgKQk9NX1VURjggPSBiJ1x4ZWZceGJiXHhiZicKCiMgVVRGLTE2LCBsaXR0bGUgZW5kaWFuCkJPTV9MRSA9IEJPTV9VVEYxNl9MRSA9IGInXHhmZlx4ZmUnCgojIFVURi0xNiwgYmlnIGVuZGlhbgpCT01fQkUgPSBCT01fVVRGMTZfQkUgPSBiJ1x4ZmVceGZmJwoKIyBVVEYtMzIsIGxpdHRsZSBlbmRpYW4KQk9NX1VURjMyX0xFID0gYidceGZmXHhmZVx4MDBceDAwJwoKIyBVVEYtMzIsIGJpZyBlbmRpYW4KQk9NX1VURjMyX0JFID0gYidceDAwXHgwMFx4ZmVceGZmJwoKaWYgc3lzLmJ5dGVvcmRlciA9PSAnbGl0dGxlJzoKCiAgICAjIFVURi0xNiwgbmF0aXZlIGVuZGlhbm5lc3MKICAgIEJPTSA9IEJPTV9VVEYxNiA9IEJPTV9VVEYxNl9MRQoKICAgICMgVVRGLTMyLCBuYXRpdmUgZW5kaWFubmVzcwogICAgQk9NX1VURjMyID0gQk9NX1VURjMyX0xFCgplbHNlOgoKICAgICMgVVRGLTE2LCBuYXRpdmUgZW5kaWFubmVzcwogICAgQk9NID0gQk9NX1VURjE2ID0gQk9NX1VURjE2X0JFCgogICAgIyBVVEYtMzIsIG5hdGl2ZSBlbmRpYW5uZXNzCiAgICBCT01fVVRGMzIgPSBCT01fVVRGMzJfQkUKCiMgT2xkIGJyb2tlbiBuYW1lcyAoZG9uJ3QgdXNlIGluIG5ldyBjb2RlKQpCT00zMl9MRSA9IEJPTV9VVEYxNl9MRQpCT00zMl9CRSA9IEJPTV9VVEYxNl9CRQpCT002NF9MRSA9IEJPTV9VVEYzMl9MRQpCT002NF9CRSA9IEJPTV9VVEYzMl9CRQoKCiMjIyBDb2RlYyBiYXNlIGNsYXNzZXMgKGRlZmluaW5nIHRoZSBBUEkpCgpjbGFzcyBDb2RlY0luZm8odHVwbGUpOgoKICAgIGRlZiBfX25ld19fKGNscywgZW5jb2RlLCBkZWNvZGUsIHN0cmVhbXJlYWRlcj1Ob25lLCBzdHJlYW13cml0ZXI9Tm9uZSwKICAgICAgICBpbmNyZW1lbnRhbGVuY29kZXI9Tm9uZSwgaW5jcmVtZW50YWxkZWNvZGVyPU5vbmUsIG5hbWU9Tm9uZSk6CiAgICAgICAgc2VsZiA9IHR1cGxlLl9fbmV3X18oY2xzLCAoZW5jb2RlLCBkZWNvZGUsIHN0cmVhbXJlYWRlciwgc3RyZWFtd3JpdGVyKSkKICAgICAgICBzZWxmLm5hbWUgPSBuYW1lCiAgICAgICAgc2VsZi5lbmNvZGUgPSBlbmNvZGUKICAgICAgICBzZWxmLmRlY29kZSA9IGRlY29kZQogICAgICAgIHNlbGYuaW5jcmVtZW50YWxlbmNvZGVyID0gaW5jcmVtZW50YWxlbmNvZGVyCiAgICAgICAgc2VsZi5pbmNyZW1lbnRhbGRlY29kZXIgPSBpbmNyZW1lbnRhbGRlY29kZXIKICAgICAgICBzZWxmLnN0cmVhbXdyaXRlciA9IHN0cmVhbXdyaXRlcgogICAgICAgIHNlbGYuc3RyZWFtcmVhZGVyID0gc3RyZWFtcmVhZGVyCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICI8JXMuJXMgb2JqZWN0IGZvciBlbmNvZGluZyAlcyBhdCAweCV4PiIgJSBcCiAgICAgICAgICAgICAgICAoc2VsZi5fX2NsYXNzX18uX19tb2R1bGVfXywgc2VsZi5fX2NsYXNzX18uX19uYW1lX18sCiAgICAgICAgICAgICAgICAgc2VsZi5uYW1lLCBpZChzZWxmKSkKCmNsYXNzIENvZGVjOgoKICAgICIiIiBEZWZpbmVzIHRoZSBpbnRlcmZhY2UgZm9yIHN0YXRlbGVzcyBlbmNvZGVycy9kZWNvZGVycy4KCiAgICAgICAgVGhlIC5lbmNvZGUoKS8uZGVjb2RlKCkgbWV0aG9kcyBtYXkgdXNlIGRpZmZlcmVudCBlcnJvcgogICAgICAgIGhhbmRsaW5nIHNjaGVtZXMgYnkgcHJvdmlkaW5nIHRoZSBlcnJvcnMgYXJndW1lbnQuIFRoZXNlCiAgICAgICAgc3RyaW5nIHZhbHVlcyBhcmUgcHJlZGVmaW5lZDoKCiAgICAgICAgICdzdHJpY3QnIC0gcmFpc2UgYSBWYWx1ZUVycm9yIGVycm9yIChvciBhIHN1YmNsYXNzKQogICAgICAgICAnaWdub3JlJyAtIGlnbm9yZSB0aGUgY2hhcmFjdGVyIGFuZCBjb250aW51ZSB3aXRoIHRoZSBuZXh0CiAgICAgICAgICdyZXBsYWNlJyAtIHJlcGxhY2Ugd2l0aCBhIHN1aXRhYmxlIHJlcGxhY2VtZW50IGNoYXJhY3RlcjsKICAgICAgICAgICAgICAgICAgICBQeXRob24gd2lsbCB1c2UgdGhlIG9mZmljaWFsIFUrRkZGRCBSRVBMQUNFTUVOVAogICAgICAgICAgICAgICAgICAgIENIQVJBQ1RFUiBmb3IgdGhlIGJ1aWx0aW4gVW5pY29kZSBjb2RlY3Mgb24KICAgICAgICAgICAgICAgICAgICBkZWNvZGluZyBhbmQgJz8nIG9uIGVuY29kaW5nLgogICAgICAgICAneG1sY2hhcnJlZnJlcGxhY2UnIC0gUmVwbGFjZSB3aXRoIHRoZSBhcHByb3ByaWF0ZSBYTUwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlciByZWZlcmVuY2UgKG9ubHkgZm9yIGVuY29kaW5nKS4KICAgICAgICAgJ2JhY2tzbGFzaHJlcGxhY2UnICAtIFJlcGxhY2Ugd2l0aCBiYWNrc2xhc2hlZCBlc2NhcGUgc2VxdWVuY2VzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAob25seSBmb3IgZW5jb2RpbmcpLgoKICAgICAgICBUaGUgc2V0IG9mIGFsbG93ZWQgdmFsdWVzIGNhbiBiZSBleHRlbmRlZCB2aWEgcmVnaXN0ZXJfZXJyb3IuCgogICAgIiIiCiAgICBkZWYgZW5jb2RlKHNlbGYsIGlucHV0LCBlcnJvcnM9J3N0cmljdCcpOgoKICAgICAgICAiIiIgRW5jb2RlcyB0aGUgb2JqZWN0IGlucHV0IGFuZCByZXR1cm5zIGEgdHVwbGUgKG91dHB1dAogICAgICAgICAgICBvYmplY3QsIGxlbmd0aCBjb25zdW1lZCkuCgogICAgICAgICAgICBlcnJvcnMgZGVmaW5lcyB0aGUgZXJyb3IgaGFuZGxpbmcgdG8gYXBwbHkuIEl0IGRlZmF1bHRzIHRvCiAgICAgICAgICAgICdzdHJpY3QnIGhhbmRsaW5nLgoKICAgICAgICAgICAgVGhlIG1ldGhvZCBtYXkgbm90IHN0b3JlIHN0YXRlIGluIHRoZSBDb2RlYyBpbnN0YW5jZS4gVXNlCiAgICAgICAgICAgIFN0cmVhbUNvZGVjIGZvciBjb2RlY3Mgd2hpY2ggaGF2ZSB0byBrZWVwIHN0YXRlIGluIG9yZGVyIHRvCiAgICAgICAgICAgIG1ha2UgZW5jb2RpbmcvZGVjb2RpbmcgZWZmaWNpZW50LgoKICAgICAgICAgICAgVGhlIGVuY29kZXIgbXVzdCBiZSBhYmxlIHRvIGhhbmRsZSB6ZXJvIGxlbmd0aCBpbnB1dCBhbmQKICAgICAgICAgICAgcmV0dXJuIGFuIGVtcHR5IG9iamVjdCBvZiB0aGUgb3V0cHV0IG9iamVjdCB0eXBlIGluIHRoaXMKICAgICAgICAgICAgc2l0dWF0aW9uLgoKICAgICAgICAiIiIKICAgICAgICByYWlzZSBOb3RJbXBsZW1lbnRlZEVycm9yCgogICAgZGVmIGRlY29kZShzZWxmLCBpbnB1dCwgZXJyb3JzPSdzdHJpY3QnKToKCiAgICAgICAgIiIiIERlY29kZXMgdGhlIG9iamVjdCBpbnB1dCBhbmQgcmV0dXJucyBhIHR1cGxlIChvdXRwdXQKICAgICAgICAgICAgb2JqZWN0LCBsZW5ndGggY29uc3VtZWQpLgoKICAgICAgICAgICAgaW5wdXQgbXVzdCBiZSBhbiBvYmplY3Qgd2hpY2ggcHJvdmlkZXMgdGhlIGJmX2dldHJlYWRidWYKICAgICAgICAgICAgYnVmZmVyIHNsb3QuIFB5dGhvbiBzdHJpbmdzLCBidWZmZXIgb2JqZWN0cyBhbmQgbWVtb3J5CiAgICAgICAgICAgIG1hcHBlZCBmaWxlcyBhcmUgZXhhbXBsZXMgb2Ygb2JqZWN0cyBwcm92aWRpbmcgdGhpcyBzbG90LgoKICAgICAgICAgICAgZXJyb3JzIGRlZmluZXMgdGhlIGVycm9yIGhhbmRsaW5nIHRvIGFwcGx5LiBJdCBkZWZhdWx0cyB0bwogICAgICAgICAgICAnc3RyaWN0JyBoYW5kbGluZy4KCiAgICAgICAgICAgIFRoZSBtZXRob2QgbWF5IG5vdCBzdG9yZSBzdGF0ZSBpbiB0aGUgQ29kZWMgaW5zdGFuY2UuIFVzZQogICAgICAgICAgICBTdHJlYW1Db2RlYyBmb3IgY29kZWNzIHdoaWNoIGhhdmUgdG8ga2VlcCBzdGF0ZSBpbiBvcmRlciB0bwogICAgICAgICAgICBtYWtlIGVuY29kaW5nL2RlY29kaW5nIGVmZmljaWVudC4KCiAgICAgICAgICAgIFRoZSBkZWNvZGVyIG11c3QgYmUgYWJsZSB0byBoYW5kbGUgemVybyBsZW5ndGggaW5wdXQgYW5kCiAgICAgICAgICAgIHJldHVybiBhbiBlbXB0eSBvYmplY3Qgb2YgdGhlIG91dHB1dCBvYmplY3QgdHlwZSBpbiB0aGlzCiAgICAgICAgICAgIHNpdHVhdGlvbi4KCiAgICAgICAgIiIiCiAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcgoKY2xhc3MgSW5jcmVtZW50YWxFbmNvZGVyKG9iamVjdCk6CiAgICAiIiIKICAgIEFuIEluY3JlbWVudGFsRW5jb2RlciBlbmNvZGVzIGFuIGlucHV0IGluIG11bHRpcGxlIHN0ZXBzLiBUaGUgaW5wdXQgY2FuCiAgICBiZSBwYXNzZWQgcGllY2UgYnkgcGllY2UgdG8gdGhlIGVuY29kZSgpIG1ldGhvZC4gVGhlIEluY3JlbWVudGFsRW5jb2RlcgogICAgcmVtZW1iZXJzIHRoZSBzdGF0ZSBvZiB0aGUgZW5jb2RpbmcgcHJvY2VzcyBiZXR3ZWVuIGNhbGxzIHRvIGVuY29kZSgpLgogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgZXJyb3JzPSdzdHJpY3QnKToKICAgICAgICAiIiIKICAgICAgICBDcmVhdGVzIGFuIEluY3JlbWVudGFsRW5jb2RlciBpbnN0YW5jZS4KCiAgICAgICAgVGhlIEluY3JlbWVudGFsRW5jb2RlciBtYXkgdXNlIGRpZmZlcmVudCBlcnJvciBoYW5kbGluZyBzY2hlbWVzIGJ5CiAgICAgICAgcHJvdmlkaW5nIHRoZSBlcnJvcnMga2V5d29yZCBhcmd1bWVudC4gU2VlIHRoZSBtb2R1bGUgZG9jc3RyaW5nCiAgICAgICAgZm9yIGEgbGlzdCBvZiBwb3NzaWJsZSB2YWx1ZXMuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5lcnJvcnMgPSBlcnJvcnMKICAgICAgICBzZWxmLmJ1ZmZlciA9ICIiCgogICAgZGVmIGVuY29kZShzZWxmLCBpbnB1dCwgZmluYWw9RmFsc2UpOgogICAgICAgICIiIgogICAgICAgIEVuY29kZXMgaW5wdXQgYW5kIHJldHVybnMgdGhlIHJlc3VsdGluZyBvYmplY3QuCiAgICAgICAgIiIiCiAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcgoKICAgIGRlZiByZXNldChzZWxmKToKICAgICAgICAiIiIKICAgICAgICBSZXNldHMgdGhlIGVuY29kZXIgdG8gdGhlIGluaXRpYWwgc3RhdGUuCiAgICAgICAgIiIiCgogICAgZGVmIGdldHN0YXRlKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIFJldHVybiB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgZW5jb2Rlci4KICAgICAgICAiIiIKICAgICAgICByZXR1cm4gMAoKICAgIGRlZiBzZXRzdGF0ZShzZWxmLCBzdGF0ZSk6CiAgICAgICAgIiIiCiAgICAgICAgU2V0IHRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBlbmNvZGVyLiBzdGF0ZSBtdXN0IGhhdmUgYmVlbgogICAgICAgIHJldHVybmVkIGJ5IGdldHN0YXRlKCkuCiAgICAgICAgIiIiCgpjbGFzcyBCdWZmZXJlZEluY3JlbWVudGFsRW5jb2RlcihJbmNyZW1lbnRhbEVuY29kZXIpOgogICAgIiIiCiAgICBUaGlzIHN1YmNsYXNzIG9mIEluY3JlbWVudGFsRW5jb2RlciBjYW4gYmUgdXNlZCBhcyB0aGUgYmFzZWNsYXNzIGZvciBhbgogICAgaW5jcmVtZW50YWwgZW5jb2RlciBpZiB0aGUgZW5jb2RlciBtdXN0IGtlZXAgc29tZSBvZiB0aGUgb3V0cHV0IGluIGEKICAgIGJ1ZmZlciBiZXR3ZWVuIGNhbGxzIHRvIGVuY29kZSgpLgogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgZXJyb3JzPSdzdHJpY3QnKToKICAgICAgICBJbmNyZW1lbnRhbEVuY29kZXIuX19pbml0X18oc2VsZiwgZXJyb3JzKQogICAgICAgICMgdW5lbmNvZGVkIGlucHV0IHRoYXQgaXMga2VwdCBiZXR3ZWVuIGNhbGxzIHRvIGVuY29kZSgpCiAgICAgICAgc2VsZi5idWZmZXIgPSAiIgoKICAgIGRlZiBfYnVmZmVyX2VuY29kZShzZWxmLCBpbnB1dCwgZXJyb3JzLCBmaW5hbCk6CiAgICAgICAgIyBPdmVyd3JpdGUgdGhpcyBtZXRob2QgaW4gc3ViY2xhc3NlczogSXQgbXVzdCBlbmNvZGUgaW5wdXQKICAgICAgICAjIGFuZCByZXR1cm4gYW4gKG91dHB1dCwgbGVuZ3RoIGNvbnN1bWVkKSB0dXBsZQogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IKCiAgICBkZWYgZW5jb2RlKHNlbGYsIGlucHV0LCBmaW5hbD1GYWxzZSk6CiAgICAgICAgIyBlbmNvZGUgaW5wdXQgKHRha2luZyB0aGUgYnVmZmVyIGludG8gYWNjb3VudCkKICAgICAgICBkYXRhID0gc2VsZi5idWZmZXIgKyBpbnB1dAogICAgICAgIChyZXN1bHQsIGNvbnN1bWVkKSA9IHNlbGYuX2J1ZmZlcl9lbmNvZGUoZGF0YSwgc2VsZi5lcnJvcnMsIGZpbmFsKQogICAgICAgICMga2VlcCB1bmVuY29kZWQgaW5wdXQgdW50aWwgdGhlIG5leHQgY2FsbAogICAgICAgIHNlbGYuYnVmZmVyID0gZGF0YVtjb25zdW1lZDpdCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiByZXNldChzZWxmKToKICAgICAgICBJbmNyZW1lbnRhbEVuY29kZXIucmVzZXQoc2VsZikKICAgICAgICBzZWxmLmJ1ZmZlciA9ICIiCgogICAgZGVmIGdldHN0YXRlKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmJ1ZmZlciBvciAwCgogICAgZGVmIHNldHN0YXRlKHNlbGYsIHN0YXRlKToKICAgICAgICBzZWxmLmJ1ZmZlciA9IHN0YXRlIG9yICIiCgpjbGFzcyBJbmNyZW1lbnRhbERlY29kZXIob2JqZWN0KToKICAgICIiIgogICAgQW4gSW5jcmVtZW50YWxEZWNvZGVyIGRlY29kZXMgYW4gaW5wdXQgaW4gbXVsdGlwbGUgc3RlcHMuIFRoZSBpbnB1dCBjYW4KICAgIGJlIHBhc3NlZCBwaWVjZSBieSBwaWVjZSB0byB0aGUgZGVjb2RlKCkgbWV0aG9kLiBUaGUgSW5jcmVtZW50YWxEZWNvZGVyCiAgICByZW1lbWJlcnMgdGhlIHN0YXRlIG9mIHRoZSBkZWNvZGluZyBwcm9jZXNzIGJldHdlZW4gY2FsbHMgdG8gZGVjb2RlKCkuCiAgICAiIiIKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBlcnJvcnM9J3N0cmljdCcpOgogICAgICAgICIiIgogICAgICAgIENyZWF0ZSBhIEluY3JlbWVudGFsRGVjb2RlciBpbnN0YW5jZS4KCiAgICAgICAgVGhlIEluY3JlbWVudGFsRGVjb2RlciBtYXkgdXNlIGRpZmZlcmVudCBlcnJvciBoYW5kbGluZyBzY2hlbWVzIGJ5CiAgICAgICAgcHJvdmlkaW5nIHRoZSBlcnJvcnMga2V5d29yZCBhcmd1bWVudC4gU2VlIHRoZSBtb2R1bGUgZG9jc3RyaW5nCiAgICAgICAgZm9yIGEgbGlzdCBvZiBwb3NzaWJsZSB2YWx1ZXMuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5lcnJvcnMgPSBlcnJvcnMKCiAgICBkZWYgZGVjb2RlKHNlbGYsIGlucHV0LCBmaW5hbD1GYWxzZSk6CiAgICAgICAgIiIiCiAgICAgICAgRGVjb2RlIGlucHV0IGFuZCByZXR1cm5zIHRoZSByZXN1bHRpbmcgb2JqZWN0LgogICAgICAgICIiIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IKCiAgICBkZWYgcmVzZXQoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgUmVzZXQgdGhlIGRlY29kZXIgdG8gdGhlIGluaXRpYWwgc3RhdGUuCiAgICAgICAgIiIiCgogICAgZGVmIGdldHN0YXRlKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIFJldHVybiB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgZGVjb2Rlci4KCiAgICAgICAgVGhpcyBtdXN0IGJlIGEgKGJ1ZmZlcmVkX2lucHV0LCBhZGRpdGlvbmFsX3N0YXRlX2luZm8pIHR1cGxlLgogICAgICAgIGJ1ZmZlcmVkX2lucHV0IG11c3QgYmUgYSBieXRlcyBvYmplY3QgY29udGFpbmluZyBieXRlcyB0aGF0CiAgICAgICAgd2VyZSBwYXNzZWQgdG8gZGVjb2RlKCkgdGhhdCBoYXZlIG5vdCB5ZXQgYmVlbiBjb252ZXJ0ZWQuCiAgICAgICAgYWRkaXRpb25hbF9zdGF0ZV9pbmZvIG11c3QgYmUgYSBub24tbmVnYXRpdmUgaW50ZWdlcgogICAgICAgIHJlcHJlc2VudGluZyB0aGUgc3RhdGUgb2YgdGhlIGRlY29kZXIgV0lUSE9VVCB5ZXQgaGF2aW5nCiAgICAgICAgcHJvY2Vzc2VkIHRoZSBjb250ZW50cyBvZiBidWZmZXJlZF9pbnB1dC4gIEluIHRoZSBpbml0aWFsIHN0YXRlCiAgICAgICAgYW5kIGFmdGVyIHJlc2V0KCksIGdldHN0YXRlKCkgbXVzdCByZXR1cm4gKGIiIiwgMCkuCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIChiIiIsIDApCgogICAgZGVmIHNldHN0YXRlKHNlbGYsIHN0YXRlKToKICAgICAgICAiIiIKICAgICAgICBTZXQgdGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIGRlY29kZXIuCgogICAgICAgIHN0YXRlIG11c3QgaGF2ZSBiZWVuIHJldHVybmVkIGJ5IGdldHN0YXRlKCkuICBUaGUgZWZmZWN0IG9mCiAgICAgICAgc2V0c3RhdGUoKGIiIiwgMCkpIG11c3QgYmUgZXF1aXZhbGVudCB0byByZXNldCgpLgogICAgICAgICIiIgoKY2xhc3MgQnVmZmVyZWRJbmNyZW1lbnRhbERlY29kZXIoSW5jcmVtZW50YWxEZWNvZGVyKToKICAgICIiIgogICAgVGhpcyBzdWJjbGFzcyBvZiBJbmNyZW1lbnRhbERlY29kZXIgY2FuIGJlIHVzZWQgYXMgdGhlIGJhc2VjbGFzcyBmb3IgYW4KICAgIGluY3JlbWVudGFsIGRlY29kZXIgaWYgdGhlIGRlY29kZXIgbXVzdCBiZSBhYmxlIHRvIGhhbmRsZSBpbmNvbXBsZXRlCiAgICBieXRlIHNlcXVlbmNlcy4KICAgICIiIgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGVycm9ycz0nc3RyaWN0Jyk6CiAgICAgICAgSW5jcmVtZW50YWxEZWNvZGVyLl9faW5pdF9fKHNlbGYsIGVycm9ycykKICAgICAgICAjIHVuZGVjb2RlZCBpbnB1dCB0aGF0IGlzIGtlcHQgYmV0d2VlbiBjYWxscyB0byBkZWNvZGUoKQogICAgICAgIHNlbGYuYnVmZmVyID0gYiIiCgogICAgZGVmIF9idWZmZXJfZGVjb2RlKHNlbGYsIGlucHV0LCBlcnJvcnMsIGZpbmFsKToKICAgICAgICAjIE92ZXJ3cml0ZSB0aGlzIG1ldGhvZCBpbiBzdWJjbGFzc2VzOiBJdCBtdXN0IGRlY29kZSBpbnB1dAogICAgICAgICMgYW5kIHJldHVybiBhbiAob3V0cHV0LCBsZW5ndGggY29uc3VtZWQpIHR1cGxlCiAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcgoKICAgIGRlZiBkZWNvZGUoc2VsZiwgaW5wdXQsIGZpbmFsPUZhbHNlKToKICAgICAgICAjIGRlY29kZSBpbnB1dCAodGFraW5nIHRoZSBidWZmZXIgaW50byBhY2NvdW50KQogICAgICAgIGRhdGEgPSBzZWxmLmJ1ZmZlciArIGlucHV0CiAgICAgICAgKHJlc3VsdCwgY29uc3VtZWQpID0gc2VsZi5fYnVmZmVyX2RlY29kZShkYXRhLCBzZWxmLmVycm9ycywgZmluYWwpCiAgICAgICAgIyBrZWVwIHVuZGVjb2RlZCBpbnB1dCB1bnRpbCB0aGUgbmV4dCBjYWxsCiAgICAgICAgc2VsZi5idWZmZXIgPSBkYXRhW2NvbnN1bWVkOl0KICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIHJlc2V0KHNlbGYpOgogICAgICAgIEluY3JlbWVudGFsRGVjb2Rlci5yZXNldChzZWxmKQogICAgICAgIHNlbGYuYnVmZmVyID0gYiIiCgogICAgZGVmIGdldHN0YXRlKHNlbGYpOgogICAgICAgICMgYWRkaXRpb25hbCBzdGF0ZSBpbmZvIGlzIGFsd2F5cyAwCiAgICAgICAgcmV0dXJuIChzZWxmLmJ1ZmZlciwgMCkKCiAgICBkZWYgc2V0c3RhdGUoc2VsZiwgc3RhdGUpOgogICAgICAgICMgaWdub3JlIGFkZGl0aW9uYWwgc3RhdGUgaW5mbwogICAgICAgIHNlbGYuYnVmZmVyID0gc3RhdGVbMF0KCiMKIyBUaGUgU3RyZWFtV3JpdGVyIGFuZCBTdHJlYW1SZWFkZXIgY2xhc3MgcHJvdmlkZSBnZW5lcmljIHdvcmtpbmcKIyBpbnRlcmZhY2VzIHdoaWNoIGNhbiBiZSB1c2VkIHRvIGltcGxlbWVudCBuZXcgZW5jb2Rpbmcgc3VibW9kdWxlcwojIHZlcnkgZWFzaWx5LiBTZWUgZW5jb2RpbmdzL3V0Zl84LnB5IGZvciBhbiBleGFtcGxlIG9uIGhvdyB0aGlzIGlzCiMgZG9uZS4KIwoKY2xhc3MgU3RyZWFtV3JpdGVyKENvZGVjKToKCiAgICBkZWYgX19pbml0X18oc2VsZiwgc3RyZWFtLCBlcnJvcnM9J3N0cmljdCcpOgoKICAgICAgICAiIiIgQ3JlYXRlcyBhIFN0cmVhbVdyaXRlciBpbnN0YW5jZS4KCiAgICAgICAgICAgIHN0cmVhbSBtdXN0IGJlIGEgZmlsZS1saWtlIG9iamVjdCBvcGVuIGZvciB3cml0aW5nCiAgICAgICAgICAgIChiaW5hcnkpIGRhdGEuCgogICAgICAgICAgICBUaGUgU3RyZWFtV3JpdGVyIG1heSB1c2UgZGlmZmVyZW50IGVycm9yIGhhbmRsaW5nCiAgICAgICAgICAgIHNjaGVtZXMgYnkgcHJvdmlkaW5nIHRoZSBlcnJvcnMga2V5d29yZCBhcmd1bWVudC4gVGhlc2UKICAgICAgICAgICAgcGFyYW1ldGVycyBhcmUgcHJlZGVmaW5lZDoKCiAgICAgICAgICAgICAnc3RyaWN0JyAtIHJhaXNlIGEgVmFsdWVFcnJvciAob3IgYSBzdWJjbGFzcykKICAgICAgICAgICAgICdpZ25vcmUnIC0gaWdub3JlIHRoZSBjaGFyYWN0ZXIgYW5kIGNvbnRpbnVlIHdpdGggdGhlIG5leHQKICAgICAgICAgICAgICdyZXBsYWNlJy0gcmVwbGFjZSB3aXRoIGEgc3VpdGFibGUgcmVwbGFjZW1lbnQgY2hhcmFjdGVyCiAgICAgICAgICAgICAneG1sY2hhcnJlZnJlcGxhY2UnIC0gUmVwbGFjZSB3aXRoIHRoZSBhcHByb3ByaWF0ZSBYTUwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXIgcmVmZXJlbmNlLgogICAgICAgICAgICAgJ2JhY2tzbGFzaHJlcGxhY2UnICAtIFJlcGxhY2Ugd2l0aCBiYWNrc2xhc2hlZCBlc2NhcGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXF1ZW5jZXMgKG9ubHkgZm9yIGVuY29kaW5nKS4KCiAgICAgICAgICAgIFRoZSBzZXQgb2YgYWxsb3dlZCBwYXJhbWV0ZXIgdmFsdWVzIGNhbiBiZSBleHRlbmRlZCB2aWEKICAgICAgICAgICAgcmVnaXN0ZXJfZXJyb3IuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5zdHJlYW0gPSBzdHJlYW0KICAgICAgICBzZWxmLmVycm9ycyA9IGVycm9ycwoKICAgIGRlZiB3cml0ZShzZWxmLCBvYmplY3QpOgoKICAgICAgICAiIiIgV3JpdGVzIHRoZSBvYmplY3QncyBjb250ZW50cyBlbmNvZGVkIHRvIHNlbGYuc3RyZWFtLgogICAgICAgICIiIgogICAgICAgIGRhdGEsIGNvbnN1bWVkID0gc2VsZi5lbmNvZGUob2JqZWN0LCBzZWxmLmVycm9ycykKICAgICAgICBzZWxmLnN0cmVhbS53cml0ZShkYXRhKQoKICAgIGRlZiB3cml0ZWxpbmVzKHNlbGYsIGxpc3QpOgoKICAgICAgICAiIiIgV3JpdGVzIHRoZSBjb25jYXRlbmF0ZWQgbGlzdCBvZiBzdHJpbmdzIHRvIHRoZSBzdHJlYW0KICAgICAgICAgICAgdXNpbmcgLndyaXRlKCkuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi53cml0ZSgnJy5qb2luKGxpc3QpKQoKICAgIGRlZiByZXNldChzZWxmKToKCiAgICAgICAgIiIiIEZsdXNoZXMgYW5kIHJlc2V0cyB0aGUgY29kZWMgYnVmZmVycyB1c2VkIGZvciBrZWVwaW5nIHN0YXRlLgoKICAgICAgICAgICAgQ2FsbGluZyB0aGlzIG1ldGhvZCBzaG91bGQgZW5zdXJlIHRoYXQgdGhlIGRhdGEgb24gdGhlCiAgICAgICAgICAgIG91dHB1dCBpcyBwdXQgaW50byBhIGNsZWFuIHN0YXRlLCB0aGF0IGFsbG93cyBhcHBlbmRpbmcKICAgICAgICAgICAgb2YgbmV3IGZyZXNoIGRhdGEgd2l0aG91dCBoYXZpbmcgdG8gcmVzY2FuIHRoZSB3aG9sZQogICAgICAgICAgICBzdHJlYW0gdG8gcmVjb3ZlciBzdGF0ZS4KCiAgICAgICAgIiIiCiAgICAgICAgcGFzcwoKICAgIGRlZiBzZWVrKHNlbGYsIG9mZnNldCwgd2hlbmNlPTApOgogICAgICAgIHNlbGYuc3RyZWFtLnNlZWsob2Zmc2V0LCB3aGVuY2UpCiAgICAgICAgaWYgd2hlbmNlID09IDAgYW5kIG9mZnNldCA9PSAwOgogICAgICAgICAgICBzZWxmLnJlc2V0KCkKCiAgICBkZWYgX19nZXRhdHRyX18oc2VsZiwgbmFtZSwKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyPWdldGF0dHIpOgoKICAgICAgICAiIiIgSW5oZXJpdCBhbGwgb3RoZXIgbWV0aG9kcyBmcm9tIHRoZSB1bmRlcmx5aW5nIHN0cmVhbS4KICAgICAgICAiIiIKICAgICAgICByZXR1cm4gZ2V0YXR0cihzZWxmLnN0cmVhbSwgbmFtZSkKCiAgICBkZWYgX19lbnRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fZXhpdF9fKHNlbGYsIHR5cGUsIHZhbHVlLCB0Yik6CiAgICAgICAgc2VsZi5zdHJlYW0uY2xvc2UoKQoKIyMjCgpjbGFzcyBTdHJlYW1SZWFkZXIoQ29kZWMpOgoKICAgIGNoYXJidWZmZXJ0eXBlID0gc3RyCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHN0cmVhbSwgZXJyb3JzPSdzdHJpY3QnKToKCiAgICAgICAgIiIiIENyZWF0ZXMgYSBTdHJlYW1SZWFkZXIgaW5zdGFuY2UuCgogICAgICAgICAgICBzdHJlYW0gbXVzdCBiZSBhIGZpbGUtbGlrZSBvYmplY3Qgb3BlbiBmb3IgcmVhZGluZwogICAgICAgICAgICAoYmluYXJ5KSBkYXRhLgoKICAgICAgICAgICAgVGhlIFN0cmVhbVJlYWRlciBtYXkgdXNlIGRpZmZlcmVudCBlcnJvciBoYW5kbGluZwogICAgICAgICAgICBzY2hlbWVzIGJ5IHByb3ZpZGluZyB0aGUgZXJyb3JzIGtleXdvcmQgYXJndW1lbnQuIFRoZXNlCiAgICAgICAgICAgIHBhcmFtZXRlcnMgYXJlIHByZWRlZmluZWQ6CgogICAgICAgICAgICAgJ3N0cmljdCcgLSByYWlzZSBhIFZhbHVlRXJyb3IgKG9yIGEgc3ViY2xhc3MpCiAgICAgICAgICAgICAnaWdub3JlJyAtIGlnbm9yZSB0aGUgY2hhcmFjdGVyIGFuZCBjb250aW51ZSB3aXRoIHRoZSBuZXh0CiAgICAgICAgICAgICAncmVwbGFjZSctIHJlcGxhY2Ugd2l0aCBhIHN1aXRhYmxlIHJlcGxhY2VtZW50IGNoYXJhY3RlcjsKCiAgICAgICAgICAgIFRoZSBzZXQgb2YgYWxsb3dlZCBwYXJhbWV0ZXIgdmFsdWVzIGNhbiBiZSBleHRlbmRlZCB2aWEKICAgICAgICAgICAgcmVnaXN0ZXJfZXJyb3IuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5zdHJlYW0gPSBzdHJlYW0KICAgICAgICBzZWxmLmVycm9ycyA9IGVycm9ycwogICAgICAgIHNlbGYuYnl0ZWJ1ZmZlciA9IGIiIgogICAgICAgIHNlbGYuX2VtcHR5X2NoYXJidWZmZXIgPSBzZWxmLmNoYXJidWZmZXJ0eXBlKCkKICAgICAgICBzZWxmLmNoYXJidWZmZXIgPSBzZWxmLl9lbXB0eV9jaGFyYnVmZmVyCiAgICAgICAgc2VsZi5saW5lYnVmZmVyID0gTm9uZQoKICAgIGRlZiBkZWNvZGUoc2VsZiwgaW5wdXQsIGVycm9ycz0nc3RyaWN0Jyk6CiAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcgoKICAgIGRlZiByZWFkKHNlbGYsIHNpemU9LTEsIGNoYXJzPS0xLCBmaXJzdGxpbmU9RmFsc2UpOgoKICAgICAgICAiIiIgRGVjb2RlcyBkYXRhIGZyb20gdGhlIHN0cmVhbSBzZWxmLnN0cmVhbSBhbmQgcmV0dXJucyB0aGUKICAgICAgICAgICAgcmVzdWx0aW5nIG9iamVjdC4KCiAgICAgICAgICAgIGNoYXJzIGluZGljYXRlcyB0aGUgbnVtYmVyIG9mIGNoYXJhY3RlcnMgdG8gcmVhZCBmcm9tIHRoZQogICAgICAgICAgICBzdHJlYW0uIHJlYWQoKSB3aWxsIG5ldmVyIHJldHVybiBtb3JlIHRoYW4gY2hhcnMKICAgICAgICAgICAgY2hhcmFjdGVycywgYnV0IGl0IG1pZ2h0IHJldHVybiBsZXNzLCBpZiB0aGVyZSBhcmUgbm90IGVub3VnaAogICAgICAgICAgICBjaGFyYWN0ZXJzIGF2YWlsYWJsZS4KCiAgICAgICAgICAgIHNpemUgaW5kaWNhdGVzIHRoZSBhcHByb3hpbWF0ZSBtYXhpbXVtIG51bWJlciBvZiBieXRlcyB0bwogICAgICAgICAgICByZWFkIGZyb20gdGhlIHN0cmVhbSBmb3IgZGVjb2RpbmcgcHVycG9zZXMuIFRoZSBkZWNvZGVyCiAgICAgICAgICAgIGNhbiBtb2RpZnkgdGhpcyBzZXR0aW5nIGFzIGFwcHJvcHJpYXRlLiBUaGUgZGVmYXVsdCB2YWx1ZQogICAgICAgICAgICAtMSBpbmRpY2F0ZXMgdG8gcmVhZCBhbmQgZGVjb2RlIGFzIG11Y2ggYXMgcG9zc2libGUuICBzaXplCiAgICAgICAgICAgIGlzIGludGVuZGVkIHRvIHByZXZlbnQgaGF2aW5nIHRvIGRlY29kZSBodWdlIGZpbGVzIGluIG9uZQogICAgICAgICAgICBzdGVwLgoKICAgICAgICAgICAgSWYgZmlyc3RsaW5lIGlzIHRydWUsIGFuZCBhIFVuaWNvZGVEZWNvZGVFcnJvciBoYXBwZW5zCiAgICAgICAgICAgIGFmdGVyIHRoZSBmaXJzdCBsaW5lIHRlcm1pbmF0b3IgaW4gdGhlIGlucHV0IG9ubHkgdGhlIGZpcnN0IGxpbmUKICAgICAgICAgICAgd2lsbCBiZSByZXR1cm5lZCwgdGhlIHJlc3Qgb2YgdGhlIGlucHV0IHdpbGwgYmUga2VwdCB1bnRpbCB0aGUKICAgICAgICAgICAgbmV4dCBjYWxsIHRvIHJlYWQoKS4KCiAgICAgICAgICAgIFRoZSBtZXRob2Qgc2hvdWxkIHVzZSBhIGdyZWVkeSByZWFkIHN0cmF0ZWd5IG1lYW5pbmcgdGhhdAogICAgICAgICAgICBpdCBzaG91bGQgcmVhZCBhcyBtdWNoIGRhdGEgYXMgaXMgYWxsb3dlZCB3aXRoaW4gdGhlCiAgICAgICAgICAgIGRlZmluaXRpb24gb2YgdGhlIGVuY29kaW5nIGFuZCB0aGUgZ2l2ZW4gc2l6ZSwgZS5nLiAgaWYKICAgICAgICAgICAgb3B0aW9uYWwgZW5jb2RpbmcgZW5kaW5ncyBvciBzdGF0ZSBtYXJrZXJzIGFyZSBhdmFpbGFibGUKICAgICAgICAgICAgb24gdGhlIHN0cmVhbSwgdGhlc2Ugc2hvdWxkIGJlIHJlYWQgdG9vLgogICAgICAgICIiIgogICAgICAgICMgSWYgd2UgaGF2ZSBsaW5lcyBjYWNoZWQsIGZpcnN0IG1lcmdlIHRoZW0gYmFjayBpbnRvIGNoYXJhY3RlcnMKICAgICAgICBpZiBzZWxmLmxpbmVidWZmZXI6CiAgICAgICAgICAgIHNlbGYuY2hhcmJ1ZmZlciA9IHNlbGYuX2VtcHR5X2NoYXJidWZmZXIuam9pbihzZWxmLmxpbmVidWZmZXIpCiAgICAgICAgICAgIHNlbGYubGluZWJ1ZmZlciA9IE5vbmUKCiAgICAgICAgIyByZWFkIHVudGlsIHdlIGdldCB0aGUgcmVxdWlyZWQgbnVtYmVyIG9mIGNoYXJhY3RlcnMgKGlmIGF2YWlsYWJsZSkKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAjIGNhbiB0aGUgcmVxdWVzdCBjYW4gYmUgc2F0aXNmaWVkIGZyb20gdGhlIGNoYXJhY3RlciBidWZmZXI/CiAgICAgICAgICAgIGlmIGNoYXJzIDwgMDoKICAgICAgICAgICAgICAgIGlmIHNpemUgPCAwOgogICAgICAgICAgICAgICAgICAgIGlmIHNlbGYuY2hhcmJ1ZmZlcjoKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGVsaWYgbGVuKHNlbGYuY2hhcmJ1ZmZlcikgPj0gc2l6ZToKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgbGVuKHNlbGYuY2hhcmJ1ZmZlcikgPj0gY2hhcnM6CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgIyB3ZSBuZWVkIG1vcmUgZGF0YQogICAgICAgICAgICBpZiBzaXplIDwgMDoKICAgICAgICAgICAgICAgIG5ld2RhdGEgPSBzZWxmLnN0cmVhbS5yZWFkKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG5ld2RhdGEgPSBzZWxmLnN0cmVhbS5yZWFkKHNpemUpCiAgICAgICAgICAgICMgZGVjb2RlIGJ5dGVzICh0aG9zZSByZW1haW5pbmcgZnJvbSB0aGUgbGFzdCBjYWxsIGluY2x1ZGVkKQogICAgICAgICAgICBkYXRhID0gc2VsZi5ieXRlYnVmZmVyICsgbmV3ZGF0YQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBuZXdjaGFycywgZGVjb2RlZGJ5dGVzID0gc2VsZi5kZWNvZGUoZGF0YSwgc2VsZi5lcnJvcnMpCiAgICAgICAgICAgIGV4Y2VwdCBVbmljb2RlRGVjb2RlRXJyb3IgYXMgZXhjOgogICAgICAgICAgICAgICAgaWYgZmlyc3RsaW5lOgogICAgICAgICAgICAgICAgICAgIG5ld2NoYXJzLCBkZWNvZGVkYnl0ZXMgPSBcCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZGVjb2RlKGRhdGFbOmV4Yy5zdGFydF0sIHNlbGYuZXJyb3JzKQogICAgICAgICAgICAgICAgICAgIGxpbmVzID0gbmV3Y2hhcnMuc3BsaXRsaW5lcyhrZWVwZW5kcz1UcnVlKQogICAgICAgICAgICAgICAgICAgIGlmIGxlbihsaW5lcyk8PTE6CiAgICAgICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICMga2VlcCB1bmRlY29kZWQgYnl0ZXMgdW50aWwgdGhlIG5leHQgY2FsbAogICAgICAgICAgICBzZWxmLmJ5dGVidWZmZXIgPSBkYXRhW2RlY29kZWRieXRlczpdCiAgICAgICAgICAgICMgcHV0IG5ldyBjaGFyYWN0ZXJzIGluIHRoZSBjaGFyYWN0ZXIgYnVmZmVyCiAgICAgICAgICAgIHNlbGYuY2hhcmJ1ZmZlciArPSBuZXdjaGFycwogICAgICAgICAgICAjIHRoZXJlIHdhcyBubyBkYXRhIGF2YWlsYWJsZQogICAgICAgICAgICBpZiBub3QgbmV3ZGF0YToKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgaWYgY2hhcnMgPCAwOgogICAgICAgICAgICAjIFJldHVybiBldmVyeXRoaW5nIHdlJ3ZlIGdvdAogICAgICAgICAgICByZXN1bHQgPSBzZWxmLmNoYXJidWZmZXIKICAgICAgICAgICAgc2VsZi5jaGFyYnVmZmVyID0gc2VsZi5fZW1wdHlfY2hhcmJ1ZmZlcgogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgUmV0dXJuIHRoZSBmaXJzdCBjaGFycyBjaGFyYWN0ZXJzCiAgICAgICAgICAgIHJlc3VsdCA9IHNlbGYuY2hhcmJ1ZmZlcls6Y2hhcnNdCiAgICAgICAgICAgIHNlbGYuY2hhcmJ1ZmZlciA9IHNlbGYuY2hhcmJ1ZmZlcltjaGFyczpdCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiByZWFkbGluZShzZWxmLCBzaXplPU5vbmUsIGtlZXBlbmRzPVRydWUpOgoKICAgICAgICAiIiIgUmVhZCBvbmUgbGluZSBmcm9tIHRoZSBpbnB1dCBzdHJlYW0gYW5kIHJldHVybiB0aGUKICAgICAgICAgICAgZGVjb2RlZCBkYXRhLgoKICAgICAgICAgICAgc2l6ZSwgaWYgZ2l2ZW4sIGlzIHBhc3NlZCBhcyBzaXplIGFyZ3VtZW50IHRvIHRoZQogICAgICAgICAgICByZWFkKCkgbWV0aG9kLgoKICAgICAgICAiIiIKICAgICAgICAjIElmIHdlIGhhdmUgbGluZXMgY2FjaGVkIGZyb20gYW4gZWFybGllciByZWFkLCByZXR1cm4KICAgICAgICAjIHRoZW0gdW5jb25kaXRpb25hbGx5CiAgICAgICAgaWYgc2VsZi5saW5lYnVmZmVyOgogICAgICAgICAgICBsaW5lID0gc2VsZi5saW5lYnVmZmVyWzBdCiAgICAgICAgICAgIGRlbCBzZWxmLmxpbmVidWZmZXJbMF0KICAgICAgICAgICAgaWYgbGVuKHNlbGYubGluZWJ1ZmZlcikgPT0gMToKICAgICAgICAgICAgICAgICMgcmV2ZXJ0IHRvIGNoYXJidWZmZXIgbW9kZTsgd2UgbWlnaHQgbmVlZCBtb3JlIGRhdGEKICAgICAgICAgICAgICAgICMgbmV4dCB0aW1lCiAgICAgICAgICAgICAgICBzZWxmLmNoYXJidWZmZXIgPSBzZWxmLmxpbmVidWZmZXJbMF0KICAgICAgICAgICAgICAgIHNlbGYubGluZWJ1ZmZlciA9IE5vbmUKICAgICAgICAgICAgaWYgbm90IGtlZXBlbmRzOgogICAgICAgICAgICAgICAgbGluZSA9IGxpbmUuc3BsaXRsaW5lcyhrZWVwZW5kcz1GYWxzZSlbMF0KICAgICAgICAgICAgcmV0dXJuIGxpbmUKCiAgICAgICAgcmVhZHNpemUgPSBzaXplIG9yIDcyCiAgICAgICAgbGluZSA9IHNlbGYuX2VtcHR5X2NoYXJidWZmZXIKICAgICAgICAjIElmIHNpemUgaXMgZ2l2ZW4sIHdlIGNhbGwgcmVhZCgpIG9ubHkgb25jZQogICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgIGRhdGEgPSBzZWxmLnJlYWQocmVhZHNpemUsIGZpcnN0bGluZT1UcnVlKQogICAgICAgICAgICBpZiBkYXRhOgogICAgICAgICAgICAgICAgIyBJZiB3ZSdyZSBhdCBhICJcciIgcmVhZCBvbmUgZXh0cmEgY2hhcmFjdGVyICh3aGljaCBtaWdodAogICAgICAgICAgICAgICAgIyBiZSBhICJcbiIpIHRvIGdldCBhIHByb3BlciBsaW5lIGVuZGluZy4gSWYgdGhlIHN0cmVhbSBpcwogICAgICAgICAgICAgICAgIyB0ZW1wb3JhcmlseSBleGhhdXN0ZWQgd2UgcmV0dXJuIHRoZSB3cm9uZyBsaW5lIGVuZGluZy4KICAgICAgICAgICAgICAgIGlmIChpc2luc3RhbmNlKGRhdGEsIHN0cikgYW5kIGRhdGEuZW5kc3dpdGgoIlxyIikpIG9yIFwKICAgICAgICAgICAgICAgICAgIChpc2luc3RhbmNlKGRhdGEsIGJ5dGVzKSBhbmQgZGF0YS5lbmRzd2l0aChiIlxyIikpOgogICAgICAgICAgICAgICAgICAgIGRhdGEgKz0gc2VsZi5yZWFkKHNpemU9MSwgY2hhcnM9MSkKCiAgICAgICAgICAgIGxpbmUgKz0gZGF0YQogICAgICAgICAgICBsaW5lcyA9IGxpbmUuc3BsaXRsaW5lcyhrZWVwZW5kcz1UcnVlKQogICAgICAgICAgICBpZiBsaW5lczoKICAgICAgICAgICAgICAgIGlmIGxlbihsaW5lcykgPiAxOgogICAgICAgICAgICAgICAgICAgICMgTW9yZSB0aGFuIG9uZSBsaW5lIHJlc3VsdDsgdGhlIGZpcnN0IGxpbmUgaXMgYSBmdWxsIGxpbmUKICAgICAgICAgICAgICAgICAgICAjIHRvIHJldHVybgogICAgICAgICAgICAgICAgICAgIGxpbmUgPSBsaW5lc1swXQogICAgICAgICAgICAgICAgICAgIGRlbCBsaW5lc1swXQogICAgICAgICAgICAgICAgICAgIGlmIGxlbihsaW5lcykgPiAxOgogICAgICAgICAgICAgICAgICAgICAgICAjIGNhY2hlIHRoZSByZW1haW5pbmcgbGluZXMKICAgICAgICAgICAgICAgICAgICAgICAgbGluZXNbLTFdICs9IHNlbGYuY2hhcmJ1ZmZlcgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxpbmVidWZmZXIgPSBsaW5lcwogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNoYXJidWZmZXIgPSBOb25lCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgIyBvbmx5IG9uZSByZW1haW5pbmcgbGluZSwgcHV0IGl0IGJhY2sgaW50byBjaGFyYnVmZmVyCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY2hhcmJ1ZmZlciA9IGxpbmVzWzBdICsgc2VsZi5jaGFyYnVmZmVyCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGtlZXBlbmRzOgogICAgICAgICAgICAgICAgICAgICAgICBsaW5lID0gbGluZS5zcGxpdGxpbmVzKGtlZXBlbmRzPUZhbHNlKVswXQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBsaW5lMHdpdGhlbmQgPSBsaW5lc1swXQogICAgICAgICAgICAgICAgbGluZTB3aXRob3V0ZW5kID0gbGluZXNbMF0uc3BsaXRsaW5lcyhrZWVwZW5kcz1GYWxzZSlbMF0KICAgICAgICAgICAgICAgIGlmIGxpbmUwd2l0aGVuZCAhPSBsaW5lMHdpdGhvdXRlbmQ6ICMgV2UgcmVhbGx5IGhhdmUgYSBsaW5lIGVuZAogICAgICAgICAgICAgICAgICAgICMgUHV0IHRoZSByZXN0IGJhY2sgdG9nZXRoZXIgYW5kIGtlZXAgaXQgdW50aWwgdGhlIG5leHQgY2FsbAogICAgICAgICAgICAgICAgICAgIHNlbGYuY2hhcmJ1ZmZlciA9IHNlbGYuX2VtcHR5X2NoYXJidWZmZXIuam9pbihsaW5lc1sxOl0pICsgXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY2hhcmJ1ZmZlcgogICAgICAgICAgICAgICAgICAgIGlmIGtlZXBlbmRzOgogICAgICAgICAgICAgICAgICAgICAgICBsaW5lID0gbGluZTB3aXRoZW5kCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgbGluZSA9IGxpbmUwd2l0aG91dGVuZAogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICMgd2UgZGlkbid0IGdldCBhbnl0aGluZyBvciB0aGlzIHdhcyBvdXIgb25seSB0cnkKICAgICAgICAgICAgaWYgbm90IGRhdGEgb3Igc2l6ZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIGlmIGxpbmUgYW5kIG5vdCBrZWVwZW5kczoKICAgICAgICAgICAgICAgICAgICBsaW5lID0gbGluZS5zcGxpdGxpbmVzKGtlZXBlbmRzPUZhbHNlKVswXQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgaWYgcmVhZHNpemUgPCA4MDAwOgogICAgICAgICAgICAgICAgcmVhZHNpemUgKj0gMgogICAgICAgIHJldHVybiBsaW5lCgogICAgZGVmIHJlYWRsaW5lcyhzZWxmLCBzaXplaGludD1Ob25lLCBrZWVwZW5kcz1UcnVlKToKCiAgICAgICAgIiIiIFJlYWQgYWxsIGxpbmVzIGF2YWlsYWJsZSBvbiB0aGUgaW5wdXQgc3RyZWFtCiAgICAgICAgICAgIGFuZCByZXR1cm4gdGhlbSBhcyBsaXN0IG9mIGxpbmVzLgoKICAgICAgICAgICAgTGluZSBicmVha3MgYXJlIGltcGxlbWVudGVkIHVzaW5nIHRoZSBjb2RlYydzIGRlY29kZXIKICAgICAgICAgICAgbWV0aG9kIGFuZCBhcmUgaW5jbHVkZWQgaW4gdGhlIGxpc3QgZW50cmllcy4KCiAgICAgICAgICAgIHNpemVoaW50LCBpZiBnaXZlbiwgaXMgaWdub3JlZCBzaW5jZSB0aGVyZSBpcyBubyBlZmZpY2llbnQKICAgICAgICAgICAgd2F5IHRvIGZpbmRpbmcgdGhlIHRydWUgZW5kLW9mLWxpbmUuCgogICAgICAgICIiIgogICAgICAgIGRhdGEgPSBzZWxmLnJlYWQoKQogICAgICAgIHJldHVybiBkYXRhLnNwbGl0bGluZXMoa2VlcGVuZHMpCgogICAgZGVmIHJlc2V0KHNlbGYpOgoKICAgICAgICAiIiIgUmVzZXRzIHRoZSBjb2RlYyBidWZmZXJzIHVzZWQgZm9yIGtlZXBpbmcgc3RhdGUuCgogICAgICAgICAgICBOb3RlIHRoYXQgbm8gc3RyZWFtIHJlcG9zaXRpb25pbmcgc2hvdWxkIHRha2UgcGxhY2UuCiAgICAgICAgICAgIFRoaXMgbWV0aG9kIGlzIHByaW1hcmlseSBpbnRlbmRlZCB0byBiZSBhYmxlIHRvIHJlY292ZXIKICAgICAgICAgICAgZnJvbSBkZWNvZGluZyBlcnJvcnMuCgogICAgICAgICIiIgogICAgICAgIHNlbGYuYnl0ZWJ1ZmZlciA9IGIiIgogICAgICAgIHNlbGYuY2hhcmJ1ZmZlciA9IHNlbGYuX2VtcHR5X2NoYXJidWZmZXIKICAgICAgICBzZWxmLmxpbmVidWZmZXIgPSBOb25lCgogICAgZGVmIHNlZWsoc2VsZiwgb2Zmc2V0LCB3aGVuY2U9MCk6CiAgICAgICAgIiIiIFNldCB0aGUgaW5wdXQgc3RyZWFtJ3MgY3VycmVudCBwb3NpdGlvbi4KCiAgICAgICAgICAgIFJlc2V0cyB0aGUgY29kZWMgYnVmZmVycyB1c2VkIGZvciBrZWVwaW5nIHN0YXRlLgogICAgICAgICIiIgogICAgICAgIHNlbGYuc3RyZWFtLnNlZWsob2Zmc2V0LCB3aGVuY2UpCiAgICAgICAgc2VsZi5yZXNldCgpCgogICAgZGVmIF9fbmV4dF9fKHNlbGYpOgoKICAgICAgICAiIiIgUmV0dXJuIHRoZSBuZXh0IGRlY29kZWQgbGluZSBmcm9tIHRoZSBpbnB1dCBzdHJlYW0uIiIiCiAgICAgICAgbGluZSA9IHNlbGYucmVhZGxpbmUoKQogICAgICAgIGlmIGxpbmU6CiAgICAgICAgICAgIHJldHVybiBsaW5lCiAgICAgICAgcmFpc2UgU3RvcEl0ZXJhdGlvbgoKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX2dldGF0dHJfXyhzZWxmLCBuYW1lLAogICAgICAgICAgICAgICAgICAgIGdldGF0dHI9Z2V0YXR0cik6CgogICAgICAgICIiIiBJbmhlcml0IGFsbCBvdGhlciBtZXRob2RzIGZyb20gdGhlIHVuZGVybHlpbmcgc3RyZWFtLgogICAgICAgICIiIgogICAgICAgIHJldHVybiBnZXRhdHRyKHNlbGYuc3RyZWFtLCBuYW1lKQoKICAgIGRlZiBfX2VudGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19leGl0X18oc2VsZiwgdHlwZSwgdmFsdWUsIHRiKToKICAgICAgICBzZWxmLnN0cmVhbS5jbG9zZSgpCgojIyMKCmNsYXNzIFN0cmVhbVJlYWRlcldyaXRlcjoKCiAgICAiIiIgU3RyZWFtUmVhZGVyV3JpdGVyIGluc3RhbmNlcyBhbGxvdyB3cmFwcGluZyBzdHJlYW1zIHdoaWNoCiAgICAgICAgd29yayBpbiBib3RoIHJlYWQgYW5kIHdyaXRlIG1vZGVzLgoKICAgICAgICBUaGUgZGVzaWduIGlzIHN1Y2ggdGhhdCBvbmUgY2FuIHVzZSB0aGUgZmFjdG9yeSBmdW5jdGlvbnMKICAgICAgICByZXR1cm5lZCBieSB0aGUgY29kZWMubG9va3VwKCkgZnVuY3Rpb24gdG8gY29uc3RydWN0IHRoZQogICAgICAgIGluc3RhbmNlLgoKICAgICIiIgogICAgIyBPcHRpb25hbCBhdHRyaWJ1dGVzIHNldCBieSB0aGUgZmlsZSB3cmFwcGVycyBiZWxvdwogICAgZW5jb2RpbmcgPSAndW5rbm93bicKCiAgICBkZWYgX19pbml0X18oc2VsZiwgc3RyZWFtLCBSZWFkZXIsIFdyaXRlciwgZXJyb3JzPSdzdHJpY3QnKToKCiAgICAgICAgIiIiIENyZWF0ZXMgYSBTdHJlYW1SZWFkZXJXcml0ZXIgaW5zdGFuY2UuCgogICAgICAgICAgICBzdHJlYW0gbXVzdCBiZSBhIFN0cmVhbS1saWtlIG9iamVjdC4KCiAgICAgICAgICAgIFJlYWRlciwgV3JpdGVyIG11c3QgYmUgZmFjdG9yeSBmdW5jdGlvbnMgb3IgY2xhc3NlcwogICAgICAgICAgICBwcm92aWRpbmcgdGhlIFN0cmVhbVJlYWRlciwgU3RyZWFtV3JpdGVyIGludGVyZmFjZSByZXNwLgoKICAgICAgICAgICAgRXJyb3IgaGFuZGxpbmcgaXMgZG9uZSBpbiB0aGUgc2FtZSB3YXkgYXMgZGVmaW5lZCBmb3IgdGhlCiAgICAgICAgICAgIFN0cmVhbVdyaXRlci9SZWFkZXJzLgoKICAgICAgICAiIiIKICAgICAgICBzZWxmLnN0cmVhbSA9IHN0cmVhbQogICAgICAgIHNlbGYucmVhZGVyID0gUmVhZGVyKHN0cmVhbSwgZXJyb3JzKQogICAgICAgIHNlbGYud3JpdGVyID0gV3JpdGVyKHN0cmVhbSwgZXJyb3JzKQogICAgICAgIHNlbGYuZXJyb3JzID0gZXJyb3JzCgogICAgZGVmIHJlYWQoc2VsZiwgc2l6ZT0tMSk6CgogICAgICAgIHJldHVybiBzZWxmLnJlYWRlci5yZWFkKHNpemUpCgogICAgZGVmIHJlYWRsaW5lKHNlbGYsIHNpemU9Tm9uZSk6CgogICAgICAgIHJldHVybiBzZWxmLnJlYWRlci5yZWFkbGluZShzaXplKQoKICAgIGRlZiByZWFkbGluZXMoc2VsZiwgc2l6ZWhpbnQ9Tm9uZSk6CgogICAgICAgIHJldHVybiBzZWxmLnJlYWRlci5yZWFkbGluZXMoc2l6ZWhpbnQpCgogICAgZGVmIF9fbmV4dF9fKHNlbGYpOgoKICAgICAgICAiIiIgUmV0dXJuIHRoZSBuZXh0IGRlY29kZWQgbGluZSBmcm9tIHRoZSBpbnB1dCBzdHJlYW0uIiIiCiAgICAgICAgcmV0dXJuIG5leHQoc2VsZi5yZWFkZXIpCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIHdyaXRlKHNlbGYsIGRhdGEpOgoKICAgICAgICByZXR1cm4gc2VsZi53cml0ZXIud3JpdGUoZGF0YSkKCiAgICBkZWYgd3JpdGVsaW5lcyhzZWxmLCBsaXN0KToKCiAgICAgICAgcmV0dXJuIHNlbGYud3JpdGVyLndyaXRlbGluZXMobGlzdCkKCiAgICBkZWYgcmVzZXQoc2VsZik6CgogICAgICAgIHNlbGYucmVhZGVyLnJlc2V0KCkKICAgICAgICBzZWxmLndyaXRlci5yZXNldCgpCgogICAgZGVmIHNlZWsoc2VsZiwgb2Zmc2V0LCB3aGVuY2U9MCk6CiAgICAgICAgc2VsZi5zdHJlYW0uc2VlayhvZmZzZXQsIHdoZW5jZSkKICAgICAgICBzZWxmLnJlYWRlci5yZXNldCgpCiAgICAgICAgaWYgd2hlbmNlID09IDAgYW5kIG9mZnNldCA9PSAwOgogICAgICAgICAgICBzZWxmLndyaXRlci5yZXNldCgpCgogICAgZGVmIF9fZ2V0YXR0cl9fKHNlbGYsIG5hbWUsCiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cj1nZXRhdHRyKToKCiAgICAgICAgIiIiIEluaGVyaXQgYWxsIG90aGVyIG1ldGhvZHMgZnJvbSB0aGUgdW5kZXJseWluZyBzdHJlYW0uCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIGdldGF0dHIoc2VsZi5zdHJlYW0sIG5hbWUpCgogICAgIyB0aGVzZSBhcmUgbmVlZGVkIHRvIG1ha2UgIndpdGggY29kZWNzLm9wZW4oLi4uKSIgd29yayBwcm9wZXJseQoKICAgIGRlZiBfX2VudGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19leGl0X18oc2VsZiwgdHlwZSwgdmFsdWUsIHRiKToKICAgICAgICBzZWxmLnN0cmVhbS5jbG9zZSgpCgojIyMKCmNsYXNzIFN0cmVhbVJlY29kZXI6CgogICAgIiIiIFN0cmVhbVJlY29kZXIgaW5zdGFuY2VzIHByb3ZpZGUgYSBmcm9udGVuZCAtIGJhY2tlbmQKICAgICAgICB2aWV3IG9mIGVuY29kaW5nIGRhdGEuCgogICAgICAgIFRoZXkgdXNlIHRoZSBjb21wbGV0ZSBzZXQgb2YgQVBJcyByZXR1cm5lZCBieSB0aGUKICAgICAgICBjb2RlY3MubG9va3VwKCkgZnVuY3Rpb24gdG8gaW1wbGVtZW50IHRoZWlyIHRhc2suCgogICAgICAgIERhdGEgd3JpdHRlbiB0byB0aGUgc3RyZWFtIGlzIGZpcnN0IGRlY29kZWQgaW50byBhbgogICAgICAgIGludGVybWVkaWF0ZSBmb3JtYXQgKHdoaWNoIGlzIGRlcGVuZGVudCBvbiB0aGUgZ2l2ZW4gY29kZWMKICAgICAgICBjb21iaW5hdGlvbikgYW5kIHRoZW4gd3JpdHRlbiB0byB0aGUgc3RyZWFtIHVzaW5nIGFuIGluc3RhbmNlCiAgICAgICAgb2YgdGhlIHByb3ZpZGVkIFdyaXRlciBjbGFzcy4KCiAgICAgICAgSW4gdGhlIG90aGVyIGRpcmVjdGlvbiwgZGF0YSBpcyByZWFkIGZyb20gdGhlIHN0cmVhbSB1c2luZyBhCiAgICAgICAgUmVhZGVyIGluc3RhbmNlIGFuZCB0aGVuIHJldHVybiBlbmNvZGVkIGRhdGEgdG8gdGhlIGNhbGxlci4KCiAgICAiIiIKICAgICMgT3B0aW9uYWwgYXR0cmlidXRlcyBzZXQgYnkgdGhlIGZpbGUgd3JhcHBlcnMgYmVsb3cKICAgIGRhdGFfZW5jb2RpbmcgPSAndW5rbm93bicKICAgIGZpbGVfZW5jb2RpbmcgPSAndW5rbm93bicKCiAgICBkZWYgX19pbml0X18oc2VsZiwgc3RyZWFtLCBlbmNvZGUsIGRlY29kZSwgUmVhZGVyLCBXcml0ZXIsCiAgICAgICAgICAgICAgICAgZXJyb3JzPSdzdHJpY3QnKToKCiAgICAgICAgIiIiIENyZWF0ZXMgYSBTdHJlYW1SZWNvZGVyIGluc3RhbmNlIHdoaWNoIGltcGxlbWVudHMgYSB0d28td2F5CiAgICAgICAgICAgIGNvbnZlcnNpb246IGVuY29kZSBhbmQgZGVjb2RlIHdvcmsgb24gdGhlIGZyb250ZW5kICh0aGUKICAgICAgICAgICAgaW5wdXQgdG8gLnJlYWQoKSBhbmQgb3V0cHV0IG9mIC53cml0ZSgpKSB3aGlsZQogICAgICAgICAgICBSZWFkZXIgYW5kIFdyaXRlciB3b3JrIG9uIHRoZSBiYWNrZW5kIChyZWFkaW5nIGFuZAogICAgICAgICAgICB3cml0aW5nIHRvIHRoZSBzdHJlYW0pLgoKICAgICAgICAgICAgWW91IGNhbiB1c2UgdGhlc2Ugb2JqZWN0cyB0byBkbyB0cmFuc3BhcmVudCBkaXJlY3QKICAgICAgICAgICAgcmVjb2RpbmdzIGZyb20gZS5nLiBsYXRpbi0xIHRvIHV0Zi04IGFuZCBiYWNrLgoKICAgICAgICAgICAgc3RyZWFtIG11c3QgYmUgYSBmaWxlLWxpa2Ugb2JqZWN0LgoKICAgICAgICAgICAgZW5jb2RlLCBkZWNvZGUgbXVzdCBhZGhlcmUgdG8gdGhlIENvZGVjIGludGVyZmFjZSwgUmVhZGVyLAogICAgICAgICAgICBXcml0ZXIgbXVzdCBiZSBmYWN0b3J5IGZ1bmN0aW9ucyBvciBjbGFzc2VzIHByb3ZpZGluZyB0aGUKICAgICAgICAgICAgU3RyZWFtUmVhZGVyLCBTdHJlYW1Xcml0ZXIgaW50ZXJmYWNlIHJlc3AuCgogICAgICAgICAgICBlbmNvZGUgYW5kIGRlY29kZSBhcmUgbmVlZGVkIGZvciB0aGUgZnJvbnRlbmQgdHJhbnNsYXRpb24sCiAgICAgICAgICAgIFJlYWRlciBhbmQgV3JpdGVyIGZvciB0aGUgYmFja2VuZCB0cmFuc2xhdGlvbi4gVW5pY29kZSBpcwogICAgICAgICAgICB1c2VkIGFzIGludGVybWVkaWF0ZSBlbmNvZGluZy4KCiAgICAgICAgICAgIEVycm9yIGhhbmRsaW5nIGlzIGRvbmUgaW4gdGhlIHNhbWUgd2F5IGFzIGRlZmluZWQgZm9yIHRoZQogICAgICAgICAgICBTdHJlYW1Xcml0ZXIvUmVhZGVycy4KCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5zdHJlYW0gPSBzdHJlYW0KICAgICAgICBzZWxmLmVuY29kZSA9IGVuY29kZQogICAgICAgIHNlbGYuZGVjb2RlID0gZGVjb2RlCiAgICAgICAgc2VsZi5yZWFkZXIgPSBSZWFkZXIoc3RyZWFtLCBlcnJvcnMpCiAgICAgICAgc2VsZi53cml0ZXIgPSBXcml0ZXIoc3RyZWFtLCBlcnJvcnMpCiAgICAgICAgc2VsZi5lcnJvcnMgPSBlcnJvcnMKCiAgICBkZWYgcmVhZChzZWxmLCBzaXplPS0xKToKCiAgICAgICAgZGF0YSA9IHNlbGYucmVhZGVyLnJlYWQoc2l6ZSkKICAgICAgICBkYXRhLCBieXRlc2VuY29kZWQgPSBzZWxmLmVuY29kZShkYXRhLCBzZWxmLmVycm9ycykKICAgICAgICByZXR1cm4gZGF0YQoKICAgIGRlZiByZWFkbGluZShzZWxmLCBzaXplPU5vbmUpOgoKICAgICAgICBpZiBzaXplIGlzIE5vbmU6CiAgICAgICAgICAgIGRhdGEgPSBzZWxmLnJlYWRlci5yZWFkbGluZSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZGF0YSA9IHNlbGYucmVhZGVyLnJlYWRsaW5lKHNpemUpCiAgICAgICAgZGF0YSwgYnl0ZXNlbmNvZGVkID0gc2VsZi5lbmNvZGUoZGF0YSwgc2VsZi5lcnJvcnMpCiAgICAgICAgcmV0dXJuIGRhdGEKCiAgICBkZWYgcmVhZGxpbmVzKHNlbGYsIHNpemVoaW50PU5vbmUpOgoKICAgICAgICBkYXRhID0gc2VsZi5yZWFkZXIucmVhZCgpCiAgICAgICAgZGF0YSwgYnl0ZXNlbmNvZGVkID0gc2VsZi5lbmNvZGUoZGF0YSwgc2VsZi5lcnJvcnMpCiAgICAgICAgcmV0dXJuIGRhdGEuc3BsaXRsaW5lcyhrZWVwZW5kcz1UcnVlKQoKICAgIGRlZiBfX25leHRfXyhzZWxmKToKCiAgICAgICAgIiIiIFJldHVybiB0aGUgbmV4dCBkZWNvZGVkIGxpbmUgZnJvbSB0aGUgaW5wdXQgc3RyZWFtLiIiIgogICAgICAgIGRhdGEgPSBuZXh0KHNlbGYucmVhZGVyKQogICAgICAgIGRhdGEsIGJ5dGVzZW5jb2RlZCA9IHNlbGYuZW5jb2RlKGRhdGEsIHNlbGYuZXJyb3JzKQogICAgICAgIHJldHVybiBkYXRhCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIHdyaXRlKHNlbGYsIGRhdGEpOgoKICAgICAgICBkYXRhLCBieXRlc2RlY29kZWQgPSBzZWxmLmRlY29kZShkYXRhLCBzZWxmLmVycm9ycykKICAgICAgICByZXR1cm4gc2VsZi53cml0ZXIud3JpdGUoZGF0YSkKCiAgICBkZWYgd3JpdGVsaW5lcyhzZWxmLCBsaXN0KToKCiAgICAgICAgZGF0YSA9ICcnLmpvaW4obGlzdCkKICAgICAgICBkYXRhLCBieXRlc2RlY29kZWQgPSBzZWxmLmRlY29kZShkYXRhLCBzZWxmLmVycm9ycykKICAgICAgICByZXR1cm4gc2VsZi53cml0ZXIud3JpdGUoZGF0YSkKCiAgICBkZWYgcmVzZXQoc2VsZik6CgogICAgICAgIHNlbGYucmVhZGVyLnJlc2V0KCkKICAgICAgICBzZWxmLndyaXRlci5yZXNldCgpCgogICAgZGVmIF9fZ2V0YXR0cl9fKHNlbGYsIG5hbWUsCiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cj1nZXRhdHRyKToKCiAgICAgICAgIiIiIEluaGVyaXQgYWxsIG90aGVyIG1ldGhvZHMgZnJvbSB0aGUgdW5kZXJseWluZyBzdHJlYW0uCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIGdldGF0dHIoc2VsZi5zdHJlYW0sIG5hbWUpCgogICAgZGVmIF9fZW50ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX2V4aXRfXyhzZWxmLCB0eXBlLCB2YWx1ZSwgdGIpOgogICAgICAgIHNlbGYuc3RyZWFtLmNsb3NlKCkKCiMjIyBTaG9ydGN1dHMKCmRlZiBvcGVuKGZpbGVuYW1lLCBtb2RlPSdyYicsIGVuY29kaW5nPU5vbmUsIGVycm9ycz0nc3RyaWN0JywgYnVmZmVyaW5nPTEpOgoKICAgICIiIiBPcGVuIGFuIGVuY29kZWQgZmlsZSB1c2luZyB0aGUgZ2l2ZW4gbW9kZSBhbmQgcmV0dXJuCiAgICAgICAgYSB3cmFwcGVkIHZlcnNpb24gcHJvdmlkaW5nIHRyYW5zcGFyZW50IGVuY29kaW5nL2RlY29kaW5nLgoKICAgICAgICBOb3RlOiBUaGUgd3JhcHBlZCB2ZXJzaW9uIHdpbGwgb25seSBhY2NlcHQgdGhlIG9iamVjdCBmb3JtYXQKICAgICAgICBkZWZpbmVkIGJ5IHRoZSBjb2RlY3MsIGkuZS4gVW5pY29kZSBvYmplY3RzIGZvciBtb3N0IGJ1aWx0aW4KICAgICAgICBjb2RlY3MuIE91dHB1dCBpcyBhbHNvIGNvZGVjIGRlcGVuZGVudCBhbmQgd2lsbCB1c3VhbGx5IGJlCiAgICAgICAgVW5pY29kZSBhcyB3ZWxsLgoKICAgICAgICBGaWxlcyBhcmUgYWx3YXlzIG9wZW5lZCBpbiBiaW5hcnkgbW9kZSwgZXZlbiBpZiBubyBiaW5hcnkgbW9kZQogICAgICAgIHdhcyBzcGVjaWZpZWQuIFRoaXMgaXMgZG9uZSB0byBhdm9pZCBkYXRhIGxvc3MgZHVlIHRvIGVuY29kaW5ncwogICAgICAgIHVzaW5nIDgtYml0IHZhbHVlcy4gVGhlIGRlZmF1bHQgZmlsZSBtb2RlIGlzICdyYicgbWVhbmluZyB0bwogICAgICAgIG9wZW4gdGhlIGZpbGUgaW4gYmluYXJ5IHJlYWQgbW9kZS4KCiAgICAgICAgZW5jb2Rpbmcgc3BlY2lmaWVzIHRoZSBlbmNvZGluZyB3aGljaCBpcyB0byBiZSB1c2VkIGZvciB0aGUKICAgICAgICBmaWxlLgoKICAgICAgICBlcnJvcnMgbWF5IGJlIGdpdmVuIHRvIGRlZmluZSB0aGUgZXJyb3IgaGFuZGxpbmcuIEl0IGRlZmF1bHRzCiAgICAgICAgdG8gJ3N0cmljdCcgd2hpY2ggY2F1c2VzIFZhbHVlRXJyb3JzIHRvIGJlIHJhaXNlZCBpbiBjYXNlIGFuCiAgICAgICAgZW5jb2RpbmcgZXJyb3Igb2NjdXJzLgoKICAgICAgICBidWZmZXJpbmcgaGFzIHRoZSBzYW1lIG1lYW5pbmcgYXMgZm9yIHRoZSBidWlsdGluIG9wZW4oKSBBUEkuCiAgICAgICAgSXQgZGVmYXVsdHMgdG8gbGluZSBidWZmZXJlZC4KCiAgICAgICAgVGhlIHJldHVybmVkIHdyYXBwZWQgZmlsZSBvYmplY3QgcHJvdmlkZXMgYW4gZXh0cmEgYXR0cmlidXRlCiAgICAgICAgLmVuY29kaW5nIHdoaWNoIGFsbG93cyBxdWVyeWluZyB0aGUgdXNlZCBlbmNvZGluZy4gVGhpcwogICAgICAgIGF0dHJpYnV0ZSBpcyBvbmx5IGF2YWlsYWJsZSBpZiBhbiBlbmNvZGluZyB3YXMgc3BlY2lmaWVkIGFzCiAgICAgICAgcGFyYW1ldGVyLgoKICAgICIiIgogICAgaWYgZW5jb2RpbmcgaXMgbm90IE5vbmUgYW5kIFwKICAgICAgICdiJyBub3QgaW4gbW9kZToKICAgICAgICAjIEZvcmNlIG9wZW5pbmcgb2YgdGhlIGZpbGUgaW4gYmluYXJ5IG1vZGUKICAgICAgICBtb2RlID0gbW9kZSArICdiJwogICAgZmlsZSA9IGJ1aWx0aW5zLm9wZW4oZmlsZW5hbWUsIG1vZGUsIGJ1ZmZlcmluZykKICAgIGlmIGVuY29kaW5nIGlzIE5vbmU6CiAgICAgICAgcmV0dXJuIGZpbGUKICAgIGluZm8gPSBsb29rdXAoZW5jb2RpbmcpCiAgICBzcncgPSBTdHJlYW1SZWFkZXJXcml0ZXIoZmlsZSwgaW5mby5zdHJlYW1yZWFkZXIsIGluZm8uc3RyZWFtd3JpdGVyLCBlcnJvcnMpCiAgICAjIEFkZCBhdHRyaWJ1dGVzIHRvIHNpbXBsaWZ5IGludHJvc3BlY3Rpb24KICAgIHNydy5lbmNvZGluZyA9IGVuY29kaW5nCiAgICByZXR1cm4gc3J3CgpkZWYgRW5jb2RlZEZpbGUoZmlsZSwgZGF0YV9lbmNvZGluZywgZmlsZV9lbmNvZGluZz1Ob25lLCBlcnJvcnM9J3N0cmljdCcpOgoKICAgICIiIiBSZXR1cm4gYSB3cmFwcGVkIHZlcnNpb24gb2YgZmlsZSB3aGljaCBwcm92aWRlcyB0cmFuc3BhcmVudAogICAgICAgIGVuY29kaW5nIHRyYW5zbGF0aW9uLgoKICAgICAgICBTdHJpbmdzIHdyaXR0ZW4gdG8gdGhlIHdyYXBwZWQgZmlsZSBhcmUgaW50ZXJwcmV0ZWQgYWNjb3JkaW5nCiAgICAgICAgdG8gdGhlIGdpdmVuIGRhdGFfZW5jb2RpbmcgYW5kIHRoZW4gd3JpdHRlbiB0byB0aGUgb3JpZ2luYWwKICAgICAgICBmaWxlIGFzIHN0cmluZyB1c2luZyBmaWxlX2VuY29kaW5nLiBUaGUgaW50ZXJtZWRpYXRlIGVuY29kaW5nCiAgICAgICAgd2lsbCB1c3VhbGx5IGJlIFVuaWNvZGUgYnV0IGRlcGVuZHMgb24gdGhlIHNwZWNpZmllZCBjb2RlY3MuCgogICAgICAgIFN0cmluZ3MgYXJlIHJlYWQgZnJvbSB0aGUgZmlsZSB1c2luZyBmaWxlX2VuY29kaW5nIGFuZCB0aGVuCiAgICAgICAgcGFzc2VkIGJhY2sgdG8gdGhlIGNhbGxlciBhcyBzdHJpbmcgdXNpbmcgZGF0YV9lbmNvZGluZy4KCiAgICAgICAgSWYgZmlsZV9lbmNvZGluZyBpcyBub3QgZ2l2ZW4sIGl0IGRlZmF1bHRzIHRvIGRhdGFfZW5jb2RpbmcuCgogICAgICAgIGVycm9ycyBtYXkgYmUgZ2l2ZW4gdG8gZGVmaW5lIHRoZSBlcnJvciBoYW5kbGluZy4gSXQgZGVmYXVsdHMKICAgICAgICB0byAnc3RyaWN0JyB3aGljaCBjYXVzZXMgVmFsdWVFcnJvcnMgdG8gYmUgcmFpc2VkIGluIGNhc2UgYW4KICAgICAgICBlbmNvZGluZyBlcnJvciBvY2N1cnMuCgogICAgICAgIFRoZSByZXR1cm5lZCB3cmFwcGVkIGZpbGUgb2JqZWN0IHByb3ZpZGVzIHR3byBleHRyYSBhdHRyaWJ1dGVzCiAgICAgICAgLmRhdGFfZW5jb2RpbmcgYW5kIC5maWxlX2VuY29kaW5nIHdoaWNoIHJlZmxlY3QgdGhlIGdpdmVuCiAgICAgICAgcGFyYW1ldGVycyBvZiB0aGUgc2FtZSBuYW1lLiBUaGUgYXR0cmlidXRlcyBjYW4gYmUgdXNlZCBmb3IKICAgICAgICBpbnRyb3NwZWN0aW9uIGJ5IFB5dGhvbiBwcm9ncmFtcy4KCiAgICAiIiIKICAgIGlmIGZpbGVfZW5jb2RpbmcgaXMgTm9uZToKICAgICAgICBmaWxlX2VuY29kaW5nID0gZGF0YV9lbmNvZGluZwogICAgZGF0YV9pbmZvID0gbG9va3VwKGRhdGFfZW5jb2RpbmcpCiAgICBmaWxlX2luZm8gPSBsb29rdXAoZmlsZV9lbmNvZGluZykKICAgIHNyID0gU3RyZWFtUmVjb2RlcihmaWxlLCBkYXRhX2luZm8uZW5jb2RlLCBkYXRhX2luZm8uZGVjb2RlLAogICAgICAgICAgICAgICAgICAgICAgIGZpbGVfaW5mby5zdHJlYW1yZWFkZXIsIGZpbGVfaW5mby5zdHJlYW13cml0ZXIsIGVycm9ycykKICAgICMgQWRkIGF0dHJpYnV0ZXMgdG8gc2ltcGxpZnkgaW50cm9zcGVjdGlvbgogICAgc3IuZGF0YV9lbmNvZGluZyA9IGRhdGFfZW5jb2RpbmcKICAgIHNyLmZpbGVfZW5jb2RpbmcgPSBmaWxlX2VuY29kaW5nCiAgICByZXR1cm4gc3IKCiMjIyBIZWxwZXJzIGZvciBjb2RlYyBsb29rdXAKCmRlZiBnZXRlbmNvZGVyKGVuY29kaW5nKToKCiAgICAiIiIgTG9va3VwIHVwIHRoZSBjb2RlYyBmb3IgdGhlIGdpdmVuIGVuY29kaW5nIGFuZCByZXR1cm4KICAgICAgICBpdHMgZW5jb2RlciBmdW5jdGlvbi4KCiAgICAgICAgUmFpc2VzIGEgTG9va3VwRXJyb3IgaW4gY2FzZSB0aGUgZW5jb2RpbmcgY2Fubm90IGJlIGZvdW5kLgoKICAgICIiIgogICAgcmV0dXJuIGxvb2t1cChlbmNvZGluZykuZW5jb2RlCgpkZWYgZ2V0ZGVjb2RlcihlbmNvZGluZyk6CgogICAgIiIiIExvb2t1cCB1cCB0aGUgY29kZWMgZm9yIHRoZSBnaXZlbiBlbmNvZGluZyBhbmQgcmV0dXJuCiAgICAgICAgaXRzIGRlY29kZXIgZnVuY3Rpb24uCgogICAgICAgIFJhaXNlcyBhIExvb2t1cEVycm9yIGluIGNhc2UgdGhlIGVuY29kaW5nIGNhbm5vdCBiZSBmb3VuZC4KCiAgICAiIiIKICAgIHJldHVybiBsb29rdXAoZW5jb2RpbmcpLmRlY29kZQoKZGVmIGdldGluY3JlbWVudGFsZW5jb2RlcihlbmNvZGluZyk6CgogICAgIiIiIExvb2t1cCB1cCB0aGUgY29kZWMgZm9yIHRoZSBnaXZlbiBlbmNvZGluZyBhbmQgcmV0dXJuCiAgICAgICAgaXRzIEluY3JlbWVudGFsRW5jb2RlciBjbGFzcyBvciBmYWN0b3J5IGZ1bmN0aW9uLgoKICAgICAgICBSYWlzZXMgYSBMb29rdXBFcnJvciBpbiBjYXNlIHRoZSBlbmNvZGluZyBjYW5ub3QgYmUgZm91bmQKICAgICAgICBvciB0aGUgY29kZWNzIGRvZXNuJ3QgcHJvdmlkZSBhbiBpbmNyZW1lbnRhbCBlbmNvZGVyLgoKICAgICIiIgogICAgZW5jb2RlciA9IGxvb2t1cChlbmNvZGluZykuaW5jcmVtZW50YWxlbmNvZGVyCiAgICBpZiBlbmNvZGVyIGlzIE5vbmU6CiAgICAgICAgcmFpc2UgTG9va3VwRXJyb3IoZW5jb2RpbmcpCiAgICByZXR1cm4gZW5jb2RlcgoKZGVmIGdldGluY3JlbWVudGFsZGVjb2RlcihlbmNvZGluZyk6CgogICAgIiIiIExvb2t1cCB1cCB0aGUgY29kZWMgZm9yIHRoZSBnaXZlbiBlbmNvZGluZyBhbmQgcmV0dXJuCiAgICAgICAgaXRzIEluY3JlbWVudGFsRGVjb2RlciBjbGFzcyBvciBmYWN0b3J5IGZ1bmN0aW9uLgoKICAgICAgICBSYWlzZXMgYSBMb29rdXBFcnJvciBpbiBjYXNlIHRoZSBlbmNvZGluZyBjYW5ub3QgYmUgZm91bmQKICAgICAgICBvciB0aGUgY29kZWNzIGRvZXNuJ3QgcHJvdmlkZSBhbiBpbmNyZW1lbnRhbCBkZWNvZGVyLgoKICAgICIiIgogICAgZGVjb2RlciA9IGxvb2t1cChlbmNvZGluZykuaW5jcmVtZW50YWxkZWNvZGVyCiAgICBpZiBkZWNvZGVyIGlzIE5vbmU6CiAgICAgICAgcmFpc2UgTG9va3VwRXJyb3IoZW5jb2RpbmcpCiAgICByZXR1cm4gZGVjb2RlcgoKZGVmIGdldHJlYWRlcihlbmNvZGluZyk6CgogICAgIiIiIExvb2t1cCB1cCB0aGUgY29kZWMgZm9yIHRoZSBnaXZlbiBlbmNvZGluZyBhbmQgcmV0dXJuCiAgICAgICAgaXRzIFN0cmVhbVJlYWRlciBjbGFzcyBvciBmYWN0b3J5IGZ1bmN0aW9uLgoKICAgICAgICBSYWlzZXMgYSBMb29rdXBFcnJvciBpbiBjYXNlIHRoZSBlbmNvZGluZyBjYW5ub3QgYmUgZm91bmQuCgogICAgIiIiCiAgICByZXR1cm4gbG9va3VwKGVuY29kaW5nKS5zdHJlYW1yZWFkZXIKCmRlZiBnZXR3cml0ZXIoZW5jb2RpbmcpOgoKICAgICIiIiBMb29rdXAgdXAgdGhlIGNvZGVjIGZvciB0aGUgZ2l2ZW4gZW5jb2RpbmcgYW5kIHJldHVybgogICAgICAgIGl0cyBTdHJlYW1Xcml0ZXIgY2xhc3Mgb3IgZmFjdG9yeSBmdW5jdGlvbi4KCiAgICAgICAgUmFpc2VzIGEgTG9va3VwRXJyb3IgaW4gY2FzZSB0aGUgZW5jb2RpbmcgY2Fubm90IGJlIGZvdW5kLgoKICAgICIiIgogICAgcmV0dXJuIGxvb2t1cChlbmNvZGluZykuc3RyZWFtd3JpdGVyCgpkZWYgaXRlcmVuY29kZShpdGVyYXRvciwgZW5jb2RpbmcsIGVycm9ycz0nc3RyaWN0JywgKiprd2FyZ3MpOgogICAgIiIiCiAgICBFbmNvZGluZyBpdGVyYXRvci4KCiAgICBFbmNvZGVzIHRoZSBpbnB1dCBzdHJpbmdzIGZyb20gdGhlIGl0ZXJhdG9yIHVzaW5nIGEgSW5jcmVtZW50YWxFbmNvZGVyLgoKICAgIGVycm9ycyBhbmQga3dhcmdzIGFyZSBwYXNzZWQgdGhyb3VnaCB0byB0aGUgSW5jcmVtZW50YWxFbmNvZGVyCiAgICBjb25zdHJ1Y3Rvci4KICAgICIiIgogICAgZW5jb2RlciA9IGdldGluY3JlbWVudGFsZW5jb2RlcihlbmNvZGluZykoZXJyb3JzLCAqKmt3YXJncykKICAgIGZvciBpbnB1dCBpbiBpdGVyYXRvcjoKICAgICAgICBvdXRwdXQgPSBlbmNvZGVyLmVuY29kZShpbnB1dCkKICAgICAgICBpZiBvdXRwdXQ6CiAgICAgICAgICAgIHlpZWxkIG91dHB1dAogICAgb3V0cHV0ID0gZW5jb2Rlci5lbmNvZGUoIiIsIFRydWUpCiAgICBpZiBvdXRwdXQ6CiAgICAgICAgeWllbGQgb3V0cHV0CgpkZWYgaXRlcmRlY29kZShpdGVyYXRvciwgZW5jb2RpbmcsIGVycm9ycz0nc3RyaWN0JywgKiprd2FyZ3MpOgogICAgIiIiCiAgICBEZWNvZGluZyBpdGVyYXRvci4KCiAgICBEZWNvZGVzIHRoZSBpbnB1dCBzdHJpbmdzIGZyb20gdGhlIGl0ZXJhdG9yIHVzaW5nIGEgSW5jcmVtZW50YWxEZWNvZGVyLgoKICAgIGVycm9ycyBhbmQga3dhcmdzIGFyZSBwYXNzZWQgdGhyb3VnaCB0byB0aGUgSW5jcmVtZW50YWxEZWNvZGVyCiAgICBjb25zdHJ1Y3Rvci4KICAgICIiIgogICAgZGVjb2RlciA9IGdldGluY3JlbWVudGFsZGVjb2RlcihlbmNvZGluZykoZXJyb3JzLCAqKmt3YXJncykKICAgIGZvciBpbnB1dCBpbiBpdGVyYXRvcjoKICAgICAgICBvdXRwdXQgPSBkZWNvZGVyLmRlY29kZShpbnB1dCkKICAgICAgICBpZiBvdXRwdXQ6CiAgICAgICAgICAgIHlpZWxkIG91dHB1dAogICAgb3V0cHV0ID0gZGVjb2Rlci5kZWNvZGUoYiIiLCBUcnVlKQogICAgaWYgb3V0cHV0OgogICAgICAgIHlpZWxkIG91dHB1dAoKIyMjIEhlbHBlcnMgZm9yIGNoYXJtYXAtYmFzZWQgY29kZWNzCgpkZWYgbWFrZV9pZGVudGl0eV9kaWN0KHJuZyk6CgogICAgIiIiIG1ha2VfaWRlbnRpdHlfZGljdChybmcpIC0+IGRpY3QKCiAgICAgICAgUmV0dXJuIGEgZGljdGlvbmFyeSB3aGVyZSBlbGVtZW50cyBvZiB0aGUgcm5nIHNlcXVlbmNlIGFyZQogICAgICAgIG1hcHBlZCB0byB0aGVtc2VsdmVzLgoKICAgICIiIgogICAgcmV0dXJuIHtpOmkgZm9yIGkgaW4gcm5nfQoKZGVmIG1ha2VfZW5jb2RpbmdfbWFwKGRlY29kaW5nX21hcCk6CgogICAgIiIiIENyZWF0ZXMgYW4gZW5jb2RpbmcgbWFwIGZyb20gYSBkZWNvZGluZyBtYXAuCgogICAgICAgIElmIGEgdGFyZ2V0IG1hcHBpbmcgaW4gdGhlIGRlY29kaW5nIG1hcCBvY2N1cnMgbXVsdGlwbGUKICAgICAgICB0aW1lcywgdGhlbiB0aGF0IHRhcmdldCBpcyBtYXBwZWQgdG8gTm9uZSAodW5kZWZpbmVkIG1hcHBpbmcpLAogICAgICAgIGNhdXNpbmcgYW4gZXhjZXB0aW9uIHdoZW4gZW5jb3VudGVyZWQgYnkgdGhlIGNoYXJtYXAgY29kZWMKICAgICAgICBkdXJpbmcgdHJhbnNsYXRpb24uCgogICAgICAgIE9uZSBleGFtcGxlIHdoZXJlIHRoaXMgaGFwcGVucyBpcyBjcDg3NS5weSB3aGljaCBkZWNvZGVzCiAgICAgICAgbXVsdGlwbGUgY2hhcmFjdGVyIHRvIFx1MDAxYS4KCiAgICAiIiIKICAgIG0gPSB7fQogICAgZm9yIGssdiBpbiBkZWNvZGluZ19tYXAuaXRlbXMoKToKICAgICAgICBpZiBub3QgdiBpbiBtOgogICAgICAgICAgICBtW3ZdID0gawogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1bdl0gPSBOb25lCiAgICByZXR1cm4gbQoKIyMjIGVycm9yIGhhbmRsZXJzCgp0cnk6CiAgICBzdHJpY3RfZXJyb3JzID0gbG9va3VwX2Vycm9yKCJzdHJpY3QiKQogICAgaWdub3JlX2Vycm9ycyA9IGxvb2t1cF9lcnJvcigiaWdub3JlIikKICAgIHJlcGxhY2VfZXJyb3JzID0gbG9va3VwX2Vycm9yKCJyZXBsYWNlIikKICAgIHhtbGNoYXJyZWZyZXBsYWNlX2Vycm9ycyA9IGxvb2t1cF9lcnJvcigieG1sY2hhcnJlZnJlcGxhY2UiKQogICAgYmFja3NsYXNocmVwbGFjZV9lcnJvcnMgPSBsb29rdXBfZXJyb3IoImJhY2tzbGFzaHJlcGxhY2UiKQpleGNlcHQgTG9va3VwRXJyb3I6CiAgICAjIEluIC0tZGlzYWJsZS11bmljb2RlIGJ1aWxkcywgdGhlc2UgZXJyb3IgaGFuZGxlciBhcmUgbWlzc2luZwogICAgc3RyaWN0X2Vycm9ycyA9IE5vbmUKICAgIGlnbm9yZV9lcnJvcnMgPSBOb25lCiAgICByZXBsYWNlX2Vycm9ycyA9IE5vbmUKICAgIHhtbGNoYXJyZWZyZXBsYWNlX2Vycm9ycyA9IE5vbmUKICAgIGJhY2tzbGFzaHJlcGxhY2VfZXJyb3JzID0gTm9uZQoKIyBUZWxsIG1vZHVsZWZpbmRlciB0aGF0IHVzaW5nIGNvZGVjcyBwcm9iYWJseSBuZWVkcyB0aGUgZW5jb2RpbmdzCiMgcGFja2FnZQpfZmFsc2UgPSAwCmlmIF9mYWxzZToKICAgIGltcG9ydCBlbmNvZGluZ3MKCiMjIyBUZXN0cwoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKCiAgICAjIE1ha2Ugc3Rkb3V0IHRyYW5zbGF0ZSBMYXRpbi0xIG91dHB1dCBpbnRvIFVURi04IG91dHB1dAogICAgc3lzLnN0ZG91dCA9IEVuY29kZWRGaWxlKHN5cy5zdGRvdXQsICdsYXRpbi0xJywgJ3V0Zi04JykKCiAgICAjIEhhdmUgc3RkaW4gdHJhbnNsYXRlIExhdGluLTEgaW5wdXQgaW50byBVVEYtOCBpbnB1dAogICAgc3lzLnN0ZGluID0gRW5jb2RlZEZpbGUoc3lzLnN0ZGluLCAndXRmLTgnLCAnbGF0aW4tMScpCg==',
'/Lib/colorsys.py':'IiIiQ29udmVyc2lvbiBmdW5jdGlvbnMgYmV0d2VlbiBSR0IgYW5kIG90aGVyIGNvbG9yIHN5c3RlbXMuCgpUaGlzIG1vZHVsZXMgcHJvdmlkZXMgdHdvIGZ1bmN0aW9ucyBmb3IgZWFjaCBjb2xvciBzeXN0ZW0gQUJDOgoKICByZ2JfdG9fYWJjKHIsIGcsIGIpIC0tPiBhLCBiLCBjCiAgYWJjX3RvX3JnYihhLCBiLCBjKSAtLT4gciwgZywgYgoKQWxsIGlucHV0cyBhbmQgb3V0cHV0cyBhcmUgdHJpcGxlcyBvZiBmbG9hdHMgaW4gdGhlIHJhbmdlIFswLjAuLi4xLjBdCih3aXRoIHRoZSBleGNlcHRpb24gb2YgSSBhbmQgUSwgd2hpY2ggY292ZXJzIGEgc2xpZ2h0bHkgbGFyZ2VyIHJhbmdlKS4KSW5wdXRzIG91dHNpZGUgdGhlIHZhbGlkIHJhbmdlIG1heSBjYXVzZSBleGNlcHRpb25zIG9yIGludmFsaWQgb3V0cHV0cy4KClN1cHBvcnRlZCBjb2xvciBzeXN0ZW1zOgpSR0I6IFJlZCwgR3JlZW4sIEJsdWUgY29tcG9uZW50cwpZSVE6IEx1bWluYW5jZSwgQ2hyb21pbmFuY2UgKHVzZWQgYnkgY29tcG9zaXRlIHZpZGVvIHNpZ25hbHMpCkhMUzogSHVlLCBMdW1pbmFuY2UsIFNhdHVyYXRpb24KSFNWOiBIdWUsIFNhdHVyYXRpb24sIFZhbHVlCiIiIgoKIyBSZWZlcmVuY2VzOgojIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvWUlRCiMgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9ITFNfY29sb3Jfc3BhY2UKIyBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0hTVl9jb2xvcl9zcGFjZQoKX19hbGxfXyA9IFsicmdiX3RvX3lpcSIsInlpcV90b19yZ2IiLCJyZ2JfdG9faGxzIiwiaGxzX3RvX3JnYiIsCiAgICAgICAgICAgInJnYl90b19oc3YiLCJoc3ZfdG9fcmdiIl0KCiMgU29tZSBmbG9hdGluZyBwb2ludCBjb25zdGFudHMKCk9ORV9USElSRCA9IDEuMC8zLjAKT05FX1NJWFRIID0gMS4wLzYuMApUV09fVEhJUkQgPSAyLjAvMy4wCgojIFlJUTogdXNlZCBieSBjb21wb3NpdGUgdmlkZW8gc2lnbmFscyAobGluZWFyIGNvbWJpbmF0aW9ucyBvZiBSR0IpCiMgWTogcGVyY2VpdmVkIGdyZXkgbGV2ZWwgKDAuMCA9PSBibGFjaywgMS4wID09IHdoaXRlKQojIEksIFE6IGNvbG9yIGNvbXBvbmVudHMKCmRlZiByZ2JfdG9feWlxKHIsIGcsIGIpOgogICAgeSA9IDAuMzAqciArIDAuNTkqZyArIDAuMTEqYgogICAgaSA9IDAuNjAqciAtIDAuMjgqZyAtIDAuMzIqYgogICAgcSA9IDAuMjEqciAtIDAuNTIqZyArIDAuMzEqYgogICAgcmV0dXJuICh5LCBpLCBxKQoKZGVmIHlpcV90b19yZ2IoeSwgaSwgcSk6CiAgICByID0geSArIDAuOTQ4MjYyKmkgKyAwLjYyNDAxMypxCiAgICBnID0geSAtIDAuMjc2MDY2KmkgLSAwLjYzOTgxMCpxCiAgICBiID0geSAtIDEuMTA1NDUwKmkgKyAxLjcyOTg2MCpxCiAgICBpZiByIDwgMC4wOgogICAgICAgIHIgPSAwLjAKICAgIGlmIGcgPCAwLjA6CiAgICAgICAgZyA9IDAuMAogICAgaWYgYiA8IDAuMDoKICAgICAgICBiID0gMC4wCiAgICBpZiByID4gMS4wOgogICAgICAgIHIgPSAxLjAKICAgIGlmIGcgPiAxLjA6CiAgICAgICAgZyA9IDEuMAogICAgaWYgYiA+IDEuMDoKICAgICAgICBiID0gMS4wCiAgICByZXR1cm4gKHIsIGcsIGIpCgoKIyBITFM6IEh1ZSwgTHVtaW5hbmNlLCBTYXR1cmF0aW9uCiMgSDogcG9zaXRpb24gaW4gdGhlIHNwZWN0cnVtCiMgTDogY29sb3IgbGlnaHRuZXNzCiMgUzogY29sb3Igc2F0dXJhdGlvbgoKZGVmIHJnYl90b19obHMociwgZywgYik6CiAgICBtYXhjID0gbWF4KHIsIGcsIGIpCiAgICBtaW5jID0gbWluKHIsIGcsIGIpCiAgICAjIFhYWCBDYW4gb3B0aW1pemUgKG1heGMrbWluYykgYW5kIChtYXhjLW1pbmMpCiAgICBsID0gKG1pbmMrbWF4YykvMi4wCiAgICBpZiBtaW5jID09IG1heGM6CiAgICAgICAgcmV0dXJuIDAuMCwgbCwgMC4wCiAgICBpZiBsIDw9IDAuNToKICAgICAgICBzID0gKG1heGMtbWluYykgLyAobWF4YyttaW5jKQogICAgZWxzZToKICAgICAgICBzID0gKG1heGMtbWluYykgLyAoMi4wLW1heGMtbWluYykKICAgIHJjID0gKG1heGMtcikgLyAobWF4Yy1taW5jKQogICAgZ2MgPSAobWF4Yy1nKSAvIChtYXhjLW1pbmMpCiAgICBiYyA9IChtYXhjLWIpIC8gKG1heGMtbWluYykKICAgIGlmIHIgPT0gbWF4YzoKICAgICAgICBoID0gYmMtZ2MKICAgIGVsaWYgZyA9PSBtYXhjOgogICAgICAgIGggPSAyLjArcmMtYmMKICAgIGVsc2U6CiAgICAgICAgaCA9IDQuMCtnYy1yYwogICAgaCA9IChoLzYuMCkgJSAxLjAKICAgIHJldHVybiBoLCBsLCBzCgpkZWYgaGxzX3RvX3JnYihoLCBsLCBzKToKICAgIGlmIHMgPT0gMC4wOgogICAgICAgIHJldHVybiBsLCBsLCBsCiAgICBpZiBsIDw9IDAuNToKICAgICAgICBtMiA9IGwgKiAoMS4wK3MpCiAgICBlbHNlOgogICAgICAgIG0yID0gbCtzLShsKnMpCiAgICBtMSA9IDIuMCpsIC0gbTIKICAgIHJldHVybiAoX3YobTEsIG0yLCBoK09ORV9USElSRCksIF92KG0xLCBtMiwgaCksIF92KG0xLCBtMiwgaC1PTkVfVEhJUkQpKQoKZGVmIF92KG0xLCBtMiwgaHVlKToKICAgIGh1ZSA9IGh1ZSAlIDEuMAogICAgaWYgaHVlIDwgT05FX1NJWFRIOgogICAgICAgIHJldHVybiBtMSArIChtMi1tMSkqaHVlKjYuMAogICAgaWYgaHVlIDwgMC41OgogICAgICAgIHJldHVybiBtMgogICAgaWYgaHVlIDwgVFdPX1RISVJEOgogICAgICAgIHJldHVybiBtMSArIChtMi1tMSkqKFRXT19USElSRC1odWUpKjYuMAogICAgcmV0dXJuIG0xCgoKIyBIU1Y6IEh1ZSwgU2F0dXJhdGlvbiwgVmFsdWUKIyBIOiBwb3NpdGlvbiBpbiB0aGUgc3BlY3RydW0KIyBTOiBjb2xvciBzYXR1cmF0aW9uICgicHVyaXR5IikKIyBWOiBjb2xvciBicmlnaHRuZXNzCgpkZWYgcmdiX3RvX2hzdihyLCBnLCBiKToKICAgIG1heGMgPSBtYXgociwgZywgYikKICAgIG1pbmMgPSBtaW4ociwgZywgYikKICAgIHYgPSBtYXhjCiAgICBpZiBtaW5jID09IG1heGM6CiAgICAgICAgcmV0dXJuIDAuMCwgMC4wLCB2CiAgICBzID0gKG1heGMtbWluYykgLyBtYXhjCiAgICByYyA9IChtYXhjLXIpIC8gKG1heGMtbWluYykKICAgIGdjID0gKG1heGMtZykgLyAobWF4Yy1taW5jKQogICAgYmMgPSAobWF4Yy1iKSAvIChtYXhjLW1pbmMpCiAgICBpZiByID09IG1heGM6CiAgICAgICAgaCA9IGJjLWdjCiAgICBlbGlmIGcgPT0gbWF4YzoKICAgICAgICBoID0gMi4wK3JjLWJjCiAgICBlbHNlOgogICAgICAgIGggPSA0LjArZ2MtcmMKICAgIGggPSAoaC82LjApICUgMS4wCiAgICByZXR1cm4gaCwgcywgdgoKZGVmIGhzdl90b19yZ2IoaCwgcywgdik6CiAgICBpZiBzID09IDAuMDoKICAgICAgICByZXR1cm4gdiwgdiwgdgogICAgaSA9IGludChoKjYuMCkgIyBYWFggYXNzdW1lIGludCgpIHRydW5jYXRlcyEKICAgIGYgPSAoaCo2LjApIC0gaQogICAgcCA9IHYqKDEuMCAtIHMpCiAgICBxID0gdiooMS4wIC0gcypmKQogICAgdCA9IHYqKDEuMCAtIHMqKDEuMC1mKSkKICAgIGkgPSBpJTYKICAgIGlmIGkgPT0gMDoKICAgICAgICByZXR1cm4gdiwgdCwgcAogICAgaWYgaSA9PSAxOgogICAgICAgIHJldHVybiBxLCB2LCBwCiAgICBpZiBpID09IDI6CiAgICAgICAgcmV0dXJuIHAsIHYsIHQKICAgIGlmIGkgPT0gMzoKICAgICAgICByZXR1cm4gcCwgcSwgdgogICAgaWYgaSA9PSA0OgogICAgICAgIHJldHVybiB0LCBwLCB2CiAgICBpZiBpID09IDU6CiAgICAgICAgcmV0dXJuIHYsIHAsIHEKICAgICMgQ2Fubm90IGdldCBoZXJlCg==',
'/Lib/contextlib.py':'IiIiVXRpbGl0aWVzIGZvciB3aXRoLXN0YXRlbWVudCBjb250ZXh0cy4gIFNlZSBQRVAgMzQzLiIiIgoKaW1wb3J0IHN5cwpmcm9tIGNvbGxlY3Rpb25zIGltcG9ydCBkZXF1ZQpmcm9tIGZ1bmN0b29scyBpbXBvcnQgd3JhcHMKCl9fYWxsX18gPSBbImNvbnRleHRtYW5hZ2VyIiwgImNsb3NpbmciLCAiQ29udGV4dERlY29yYXRvciIsICJFeGl0U3RhY2siXQoKCmNsYXNzIENvbnRleHREZWNvcmF0b3Iob2JqZWN0KToKICAgICJBIGJhc2UgY2xhc3Mgb3IgbWl4aW4gdGhhdCBlbmFibGVzIGNvbnRleHQgbWFuYWdlcnMgdG8gd29yayBhcyBkZWNvcmF0b3JzLiIKCiAgICBkZWYgX3JlY3JlYXRlX2NtKHNlbGYpOgogICAgICAgICIiIlJldHVybiBhIHJlY3JlYXRlZCBpbnN0YW5jZSBvZiBzZWxmLgoKICAgICAgICBBbGxvd3MgYW4gb3RoZXJ3aXNlIG9uZS1zaG90IGNvbnRleHQgbWFuYWdlciBsaWtlCiAgICAgICAgX0dlbmVyYXRvckNvbnRleHRNYW5hZ2VyIHRvIHN1cHBvcnQgdXNlIGFzCiAgICAgICAgYSBkZWNvcmF0b3IgdmlhIGltcGxpY2l0IHJlY3JlYXRpb24uCgogICAgICAgIFRoaXMgaXMgYSBwcml2YXRlIGludGVyZmFjZSBqdXN0IGZvciBfR2VuZXJhdG9yQ29udGV4dE1hbmFnZXIuCiAgICAgICAgU2VlIGlzc3VlICMxMTY0NyBmb3IgZGV0YWlscy4KICAgICAgICAiIiIKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX2NhbGxfXyhzZWxmLCBmdW5jKToKICAgICAgICBAd3JhcHMoZnVuYykKICAgICAgICBkZWYgaW5uZXIoKmFyZ3MsICoqa3dkcyk6CiAgICAgICAgICAgIHdpdGggc2VsZi5fcmVjcmVhdGVfY20oKToKICAgICAgICAgICAgICAgIHJldHVybiBmdW5jKCphcmdzLCAqKmt3ZHMpCiAgICAgICAgcmV0dXJuIGlubmVyCgoKY2xhc3MgX0dlbmVyYXRvckNvbnRleHRNYW5hZ2VyKENvbnRleHREZWNvcmF0b3IpOgogICAgIiIiSGVscGVyIGZvciBAY29udGV4dG1hbmFnZXIgZGVjb3JhdG9yLiIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBmdW5jLCAqYXJncywgKiprd2RzKToKICAgICAgICBzZWxmLmdlbiA9IGZ1bmMoKmFyZ3MsICoqa3dkcykKICAgICAgICBzZWxmLmZ1bmMsIHNlbGYuYXJncywgc2VsZi5rd2RzID0gZnVuYywgYXJncywga3dkcwoKICAgIGRlZiBfcmVjcmVhdGVfY20oc2VsZik6CiAgICAgICAgIyBfR0NNIGluc3RhbmNlcyBhcmUgb25lLXNob3QgY29udGV4dCBtYW5hZ2Vycywgc28gdGhlCiAgICAgICAgIyBDTSBtdXN0IGJlIHJlY3JlYXRlZCBlYWNoIHRpbWUgYSBkZWNvcmF0ZWQgZnVuY3Rpb24gaXMKICAgICAgICAjIGNhbGxlZAogICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLmZ1bmMsICpzZWxmLmFyZ3MsICoqc2VsZi5rd2RzKQoKICAgIGRlZiBfX2VudGVyX18oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gbmV4dChzZWxmLmdlbikKICAgICAgICBleGNlcHQgU3RvcEl0ZXJhdGlvbjoKICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCJnZW5lcmF0b3IgZGlkbid0IHlpZWxkIikKCiAgICBkZWYgX19leGl0X18oc2VsZiwgdHlwZSwgdmFsdWUsIHRyYWNlYmFjayk6CiAgICAgICAgaWYgdHlwZSBpcyBOb25lOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBuZXh0KHNlbGYuZ2VuKQogICAgICAgICAgICBleGNlcHQgU3RvcEl0ZXJhdGlvbjoKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCJnZW5lcmF0b3IgZGlkbid0IHN0b3AiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIHZhbHVlIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAjIE5lZWQgdG8gZm9yY2UgaW5zdGFudGlhdGlvbiBzbyB3ZSBjYW4gcmVsaWFibHkKICAgICAgICAgICAgICAgICMgdGVsbCBpZiB3ZSBnZXQgdGhlIHNhbWUgZXhjZXB0aW9uIGJhY2sKICAgICAgICAgICAgICAgIHZhbHVlID0gdHlwZSgpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYuZ2VuLnRocm93KHR5cGUsIHZhbHVlLCB0cmFjZWJhY2spCiAgICAgICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoImdlbmVyYXRvciBkaWRuJ3Qgc3RvcCBhZnRlciB0aHJvdygpIikKICAgICAgICAgICAgZXhjZXB0IFN0b3BJdGVyYXRpb24gYXMgZXhjOgogICAgICAgICAgICAgICAgIyBTdXBwcmVzcyB0aGUgZXhjZXB0aW9uICp1bmxlc3MqIGl0J3MgdGhlIHNhbWUgZXhjZXB0aW9uIHRoYXQKICAgICAgICAgICAgICAgICMgd2FzIHBhc3NlZCB0byB0aHJvdygpLiAgVGhpcyBwcmV2ZW50cyBhIFN0b3BJdGVyYXRpb24KICAgICAgICAgICAgICAgICMgcmFpc2VkIGluc2lkZSB0aGUgIndpdGgiIHN0YXRlbWVudCBmcm9tIGJlaW5nIHN1cHByZXNzZWQKICAgICAgICAgICAgICAgIHJldHVybiBleGMgaXMgbm90IHZhbHVlCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICMgb25seSByZS1yYWlzZSBpZiBpdCdzICpub3QqIHRoZSBleGNlcHRpb24gdGhhdCB3YXMKICAgICAgICAgICAgICAgICMgcGFzc2VkIHRvIHRocm93KCksIGJlY2F1c2UgX19leGl0X18oKSBtdXN0IG5vdCByYWlzZQogICAgICAgICAgICAgICAgIyBhbiBleGNlcHRpb24gdW5sZXNzIF9fZXhpdF9fKCkgaXRzZWxmIGZhaWxlZC4gIEJ1dCB0aHJvdygpCiAgICAgICAgICAgICAgICAjIGhhcyB0byByYWlzZSB0aGUgZXhjZXB0aW9uIHRvIHNpZ25hbCBwcm9wYWdhdGlvbiwgc28gdGhpcwogICAgICAgICAgICAgICAgIyBmaXhlcyB0aGUgaW1wZWRhbmNlIG1pc21hdGNoIGJldHdlZW4gdGhlIHRocm93KCkgcHJvdG9jb2wKICAgICAgICAgICAgICAgICMgYW5kIHRoZSBfX2V4aXRfXygpIHByb3RvY29sLgogICAgICAgICAgICAgICAgIwogICAgICAgICAgICAgICAgaWYgc3lzLmV4Y19pbmZvKClbMV0gaXMgbm90IHZhbHVlOgogICAgICAgICAgICAgICAgICAgIHJhaXNlCgoKZGVmIGNvbnRleHRtYW5hZ2VyKGZ1bmMpOgogICAgIiIiQGNvbnRleHRtYW5hZ2VyIGRlY29yYXRvci4KCiAgICBUeXBpY2FsIHVzYWdlOgoKICAgICAgICBAY29udGV4dG1hbmFnZXIKICAgICAgICBkZWYgc29tZV9nZW5lcmF0b3IoPGFyZ3VtZW50cz4pOgogICAgICAgICAgICA8c2V0dXA+CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHlpZWxkIDx2YWx1ZT4KICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgIDxjbGVhbnVwPgoKICAgIFRoaXMgbWFrZXMgdGhpczoKCiAgICAgICAgd2l0aCBzb21lX2dlbmVyYXRvcig8YXJndW1lbnRzPikgYXMgPHZhcmlhYmxlPjoKICAgICAgICAgICAgPGJvZHk+CgogICAgZXF1aXZhbGVudCB0byB0aGlzOgoKICAgICAgICA8c2V0dXA+CiAgICAgICAgdHJ5OgogICAgICAgICAgICA8dmFyaWFibGU+ID0gPHZhbHVlPgogICAgICAgICAgICA8Ym9keT4KICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICA8Y2xlYW51cD4KCiAgICAiIiIKICAgIEB3cmFwcyhmdW5jKQogICAgZGVmIGhlbHBlcigqYXJncywgKiprd2RzKToKICAgICAgICByZXR1cm4gX0dlbmVyYXRvckNvbnRleHRNYW5hZ2VyKGZ1bmMsICphcmdzLCAqKmt3ZHMpCiAgICByZXR1cm4gaGVscGVyCgoKY2xhc3MgY2xvc2luZyhvYmplY3QpOgogICAgIiIiQ29udGV4dCB0byBhdXRvbWF0aWNhbGx5IGNsb3NlIHNvbWV0aGluZyBhdCB0aGUgZW5kIG9mIGEgYmxvY2suCgogICAgQ29kZSBsaWtlIHRoaXM6CgogICAgICAgIHdpdGggY2xvc2luZyg8bW9kdWxlPi5vcGVuKDxhcmd1bWVudHM+KSkgYXMgZjoKICAgICAgICAgICAgPGJsb2NrPgoKICAgIGlzIGVxdWl2YWxlbnQgdG8gdGhpczoKCiAgICAgICAgZiA9IDxtb2R1bGU+Lm9wZW4oPGFyZ3VtZW50cz4pCiAgICAgICAgdHJ5OgogICAgICAgICAgICA8YmxvY2s+CiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgZi5jbG9zZSgpCgogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgdGhpbmcpOgogICAgICAgIHNlbGYudGhpbmcgPSB0aGluZwogICAgZGVmIF9fZW50ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi50aGluZwogICAgZGVmIF9fZXhpdF9fKHNlbGYsICpleGNfaW5mbyk6CiAgICAgICAgc2VsZi50aGluZy5jbG9zZSgpCgoKIyBJbnNwaXJlZCBieSBkaXNjdXNzaW9ucyBvbiBodHRwOi8vYnVncy5weXRob24ub3JnL2lzc3VlMTM1ODUKY2xhc3MgRXhpdFN0YWNrKG9iamVjdCk6CiAgICAiIiJDb250ZXh0IG1hbmFnZXIgZm9yIGR5bmFtaWMgbWFuYWdlbWVudCBvZiBhIHN0YWNrIG9mIGV4aXQgY2FsbGJhY2tzCgogICAgRm9yIGV4YW1wbGU6CgogICAgICAgIHdpdGggRXhpdFN0YWNrKCkgYXMgc3RhY2s6CiAgICAgICAgICAgIGZpbGVzID0gW3N0YWNrLmVudGVyX2NvbnRleHQob3BlbihmbmFtZSkpIGZvciBmbmFtZSBpbiBmaWxlbmFtZXNdCiAgICAgICAgICAgICMgQWxsIG9wZW5lZCBmaWxlcyB3aWxsIGF1dG9tYXRpY2FsbHkgYmUgY2xvc2VkIGF0IHRoZSBlbmQgb2YKICAgICAgICAgICAgIyB0aGUgd2l0aCBzdGF0ZW1lbnQsIGV2ZW4gaWYgYXR0ZW1wdHMgdG8gb3BlbiBmaWxlcyBsYXRlcgogICAgICAgICAgICAjIGluIHRoZSBsaXN0IHRocm93IGFuIGV4Y2VwdGlvbgoKICAgICIiIgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuX2V4aXRfY2FsbGJhY2tzID0gZGVxdWUoKQoKICAgIGRlZiBwb3BfYWxsKHNlbGYpOgogICAgICAgICIiIlByZXNlcnZlIHRoZSBjb250ZXh0IHN0YWNrIGJ5IHRyYW5zZmVycmluZyBpdCB0byBhIG5ldyBpbnN0YW5jZSIiIgogICAgICAgIG5ld19zdGFjayA9IHR5cGUoc2VsZikoKQogICAgICAgIG5ld19zdGFjay5fZXhpdF9jYWxsYmFja3MgPSBzZWxmLl9leGl0X2NhbGxiYWNrcwogICAgICAgIHNlbGYuX2V4aXRfY2FsbGJhY2tzID0gZGVxdWUoKQogICAgICAgIHJldHVybiBuZXdfc3RhY2sKCiAgICBkZWYgX3B1c2hfY21fZXhpdChzZWxmLCBjbSwgY21fZXhpdCk6CiAgICAgICAgIiIiSGVscGVyIHRvIGNvcnJlY3RseSByZWdpc3RlciBjYWxsYmFja3MgdG8gX19leGl0X18gbWV0aG9kcyIiIgogICAgICAgIGRlZiBfZXhpdF93cmFwcGVyKCpleGNfZGV0YWlscyk6CiAgICAgICAgICAgIHJldHVybiBjbV9leGl0KGNtLCAqZXhjX2RldGFpbHMpCiAgICAgICAgX2V4aXRfd3JhcHBlci5fX3NlbGZfXyA9IGNtCiAgICAgICAgc2VsZi5wdXNoKF9leGl0X3dyYXBwZXIpCgogICAgZGVmIHB1c2goc2VsZiwgZXhpdCk6CiAgICAgICAgIiIiUmVnaXN0ZXJzIGEgY2FsbGJhY2sgd2l0aCB0aGUgc3RhbmRhcmQgX19leGl0X18gbWV0aG9kIHNpZ25hdHVyZQoKICAgICAgICBDYW4gc3VwcHJlc3MgZXhjZXB0aW9ucyB0aGUgc2FtZSB3YXkgX19leGl0X18gbWV0aG9kcyBjYW4uCgogICAgICAgIEFsc28gYWNjZXB0cyBhbnkgb2JqZWN0IHdpdGggYW4gX19leGl0X18gbWV0aG9kIChyZWdpc3RlcmluZyBhIGNhbGwKICAgICAgICB0byB0aGUgbWV0aG9kIGluc3RlYWQgb2YgdGhlIG9iamVjdCBpdHNlbGYpCiAgICAgICAgIiIiCiAgICAgICAgIyBXZSB1c2UgYW4gdW5ib3VuZCBtZXRob2QgcmF0aGVyIHRoYW4gYSBib3VuZCBtZXRob2QgdG8gZm9sbG93CiAgICAgICAgIyB0aGUgc3RhbmRhcmQgbG9va3VwIGJlaGF2aW91ciBmb3Igc3BlY2lhbCBtZXRob2RzCiAgICAgICAgX2NiX3R5cGUgPSB0eXBlKGV4aXQpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBleGl0X21ldGhvZCA9IF9jYl90eXBlLl9fZXhpdF9fCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICAjIE5vdCBhIGNvbnRleHQgbWFuYWdlciwgc28gYXNzdW1lIGl0cyBhIGNhbGxhYmxlCiAgICAgICAgICAgIHNlbGYuX2V4aXRfY2FsbGJhY2tzLmFwcGVuZChleGl0KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuX3B1c2hfY21fZXhpdChleGl0LCBleGl0X21ldGhvZCkKICAgICAgICByZXR1cm4gZXhpdCAjIEFsbG93IHVzZSBhcyBhIGRlY29yYXRvcgoKICAgIGRlZiBjYWxsYmFjayhzZWxmLCBjYWxsYmFjaywgKmFyZ3MsICoqa3dkcyk6CiAgICAgICAgIiIiUmVnaXN0ZXJzIGFuIGFyYml0cmFyeSBjYWxsYmFjayBhbmQgYXJndW1lbnRzLgoKICAgICAgICBDYW5ub3Qgc3VwcHJlc3MgZXhjZXB0aW9ucy4KICAgICAgICAiIiIKICAgICAgICBkZWYgX2V4aXRfd3JhcHBlcihleGNfdHlwZSwgZXhjLCB0Yik6CiAgICAgICAgICAgIGNhbGxiYWNrKCphcmdzLCAqKmt3ZHMpCiAgICAgICAgIyBXZSBjaGFuZ2VkIHRoZSBzaWduYXR1cmUsIHNvIHVzaW5nIEB3cmFwcyBpcyBub3QgYXBwcm9wcmlhdGUsIGJ1dAogICAgICAgICMgc2V0dGluZyBfX3dyYXBwZWRfXyBtYXkgc3RpbGwgaGVscCB3aXRoIGludHJvc3BlY3Rpb24KICAgICAgICBfZXhpdF93cmFwcGVyLl9fd3JhcHBlZF9fID0gY2FsbGJhY2sKICAgICAgICBzZWxmLnB1c2goX2V4aXRfd3JhcHBlcikKICAgICAgICByZXR1cm4gY2FsbGJhY2sgIyBBbGxvdyB1c2UgYXMgYSBkZWNvcmF0b3IKCiAgICBkZWYgZW50ZXJfY29udGV4dChzZWxmLCBjbSk6CiAgICAgICAgIiIiRW50ZXJzIHRoZSBzdXBwbGllZCBjb250ZXh0IG1hbmFnZXIKCiAgICAgICAgSWYgc3VjY2Vzc2Z1bCwgYWxzbyBwdXNoZXMgaXRzIF9fZXhpdF9fIG1ldGhvZCBhcyBhIGNhbGxiYWNrIGFuZAogICAgICAgIHJldHVybnMgdGhlIHJlc3VsdCBvZiB0aGUgX19lbnRlcl9fIG1ldGhvZC4KICAgICAgICAiIiIKICAgICAgICAjIFdlIGxvb2sgdXAgdGhlIHNwZWNpYWwgbWV0aG9kcyBvbiB0aGUgdHlwZSB0byBtYXRjaCB0aGUgd2l0aCBzdGF0ZW1lbnQKICAgICAgICBfY21fdHlwZSA9IHR5cGUoY20pCiAgICAgICAgX2V4aXQgPSBfY21fdHlwZS5fX2V4aXRfXwogICAgICAgIHJlc3VsdCA9IF9jbV90eXBlLl9fZW50ZXJfXyhjbSkKICAgICAgICBzZWxmLl9wdXNoX2NtX2V4aXQoY20sIF9leGl0KQogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgY2xvc2Uoc2VsZik6CiAgICAgICAgIiIiSW1tZWRpYXRlbHkgdW53aW5kIHRoZSBjb250ZXh0IHN0YWNrIiIiCiAgICAgICAgc2VsZi5fX2V4aXRfXyhOb25lLCBOb25lLCBOb25lKQoKICAgIGRlZiBfX2VudGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19leGl0X18oc2VsZiwgKmV4Y19kZXRhaWxzKToKICAgICAgICAjIFdlIG1hbmlwdWxhdGUgdGhlIGV4Y2VwdGlvbiBzdGF0ZSBzbyBpdCBiZWhhdmVzIGFzIHRob3VnaAogICAgICAgICMgd2Ugd2VyZSBhY3R1YWxseSBuZXN0aW5nIG11bHRpcGxlIHdpdGggc3RhdGVtZW50cwogICAgICAgIGZyYW1lX2V4YyA9IHN5cy5leGNfaW5mbygpWzFdCiAgICAgICAgZGVmIF9maXhfZXhjZXB0aW9uX2NvbnRleHQobmV3X2V4Yywgb2xkX2V4Yyk6CiAgICAgICAgICAgIHdoaWxlIDE6CiAgICAgICAgICAgICAgICBleGNfY29udGV4dCA9IG5ld19leGMuX19jb250ZXh0X18KICAgICAgICAgICAgICAgIGlmIGV4Y19jb250ZXh0IGluIChOb25lLCBmcmFtZV9leGMpOgogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBuZXdfZXhjID0gZXhjX2NvbnRleHQKICAgICAgICAgICAgbmV3X2V4Yy5fX2NvbnRleHRfXyA9IG9sZF9leGMKCiAgICAgICAgIyBDYWxsYmFja3MgYXJlIGludm9rZWQgaW4gTElGTyBvcmRlciB0byBtYXRjaCB0aGUgYmVoYXZpb3VyIG9mCiAgICAgICAgIyBuZXN0ZWQgY29udGV4dCBtYW5hZ2VycwogICAgICAgIHN1cHByZXNzZWRfZXhjID0gRmFsc2UKICAgICAgICB3aGlsZSBzZWxmLl9leGl0X2NhbGxiYWNrczoKICAgICAgICAgICAgY2IgPSBzZWxmLl9leGl0X2NhbGxiYWNrcy5wb3AoKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpZiBjYigqZXhjX2RldGFpbHMpOgogICAgICAgICAgICAgICAgICAgIHN1cHByZXNzZWRfZXhjID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgIGV4Y19kZXRhaWxzID0gKE5vbmUsIE5vbmUsIE5vbmUpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIG5ld19leGNfZGV0YWlscyA9IHN5cy5leGNfaW5mbygpCiAgICAgICAgICAgICAgICAjIHNpbXVsYXRlIHRoZSBzdGFjayBvZiBleGNlcHRpb25zIGJ5IHNldHRpbmcgdGhlIGNvbnRleHQKICAgICAgICAgICAgICAgIF9maXhfZXhjZXB0aW9uX2NvbnRleHQobmV3X2V4Y19kZXRhaWxzWzFdLCBleGNfZGV0YWlsc1sxXSkKICAgICAgICAgICAgICAgIGlmIG5vdCBzZWxmLl9leGl0X2NhbGxiYWNrczoKICAgICAgICAgICAgICAgICAgICByYWlzZQogICAgICAgICAgICAgICAgZXhjX2RldGFpbHMgPSBuZXdfZXhjX2RldGFpbHMKICAgICAgICByZXR1cm4gc3VwcHJlc3NlZF9leGMK',
'/Lib/copy.py':'IiIiR2VuZXJpYyAoc2hhbGxvdyBhbmQgZGVlcCkgY29weWluZyBvcGVyYXRpb25zLgoKSW50ZXJmYWNlIHN1bW1hcnk6CgogICAgICAgIGltcG9ydCBjb3B5CgogICAgICAgIHggPSBjb3B5LmNvcHkoeSkgICAgICAgICMgbWFrZSBhIHNoYWxsb3cgY29weSBvZiB5CiAgICAgICAgeCA9IGNvcHkuZGVlcGNvcHkoeSkgICAgIyBtYWtlIGEgZGVlcCBjb3B5IG9mIHkKCkZvciBtb2R1bGUgc3BlY2lmaWMgZXJyb3JzLCBjb3B5LkVycm9yIGlzIHJhaXNlZC4KClRoZSBkaWZmZXJlbmNlIGJldHdlZW4gc2hhbGxvdyBhbmQgZGVlcCBjb3B5aW5nIGlzIG9ubHkgcmVsZXZhbnQgZm9yCmNvbXBvdW5kIG9iamVjdHMgKG9iamVjdHMgdGhhdCBjb250YWluIG90aGVyIG9iamVjdHMsIGxpa2UgbGlzdHMgb3IKY2xhc3MgaW5zdGFuY2VzKS4KCi0gQSBzaGFsbG93IGNvcHkgY29uc3RydWN0cyBhIG5ldyBjb21wb3VuZCBvYmplY3QgYW5kIHRoZW4gKHRvIHRoZQogIGV4dGVudCBwb3NzaWJsZSkgaW5zZXJ0cyAqdGhlIHNhbWUgb2JqZWN0cyogaW50byBpdCB0aGF0IHRoZQogIG9yaWdpbmFsIGNvbnRhaW5zLgoKLSBBIGRlZXAgY29weSBjb25zdHJ1Y3RzIGEgbmV3IGNvbXBvdW5kIG9iamVjdCBhbmQgdGhlbiwgcmVjdXJzaXZlbHksCiAgaW5zZXJ0cyAqY29waWVzKiBpbnRvIGl0IG9mIHRoZSBvYmplY3RzIGZvdW5kIGluIHRoZSBvcmlnaW5hbC4KClR3byBwcm9ibGVtcyBvZnRlbiBleGlzdCB3aXRoIGRlZXAgY29weSBvcGVyYXRpb25zIHRoYXQgZG9uJ3QgZXhpc3QKd2l0aCBzaGFsbG93IGNvcHkgb3BlcmF0aW9uczoKCiBhKSByZWN1cnNpdmUgb2JqZWN0cyAoY29tcG91bmQgb2JqZWN0cyB0aGF0LCBkaXJlY3RseSBvciBpbmRpcmVjdGx5LAogICAgY29udGFpbiBhIHJlZmVyZW5jZSB0byB0aGVtc2VsdmVzKSBtYXkgY2F1c2UgYSByZWN1cnNpdmUgbG9vcAoKIGIpIGJlY2F1c2UgZGVlcCBjb3B5IGNvcGllcyAqZXZlcnl0aGluZyogaXQgbWF5IGNvcHkgdG9vIG11Y2gsIGUuZy4KICAgIGFkbWluaXN0cmF0aXZlIGRhdGEgc3RydWN0dXJlcyB0aGF0IHNob3VsZCBiZSBzaGFyZWQgZXZlbiBiZXR3ZWVuCiAgICBjb3BpZXMKClB5dGhvbidzIGRlZXAgY29weSBvcGVyYXRpb24gYXZvaWRzIHRoZXNlIHByb2JsZW1zIGJ5OgoKIGEpIGtlZXBpbmcgYSB0YWJsZSBvZiBvYmplY3RzIGFscmVhZHkgY29waWVkIGR1cmluZyB0aGUgY3VycmVudAogICAgY29weWluZyBwYXNzCgogYikgbGV0dGluZyB1c2VyLWRlZmluZWQgY2xhc3NlcyBvdmVycmlkZSB0aGUgY29weWluZyBvcGVyYXRpb24gb3IgdGhlCiAgICBzZXQgb2YgY29tcG9uZW50cyBjb3BpZWQKClRoaXMgdmVyc2lvbiBkb2VzIG5vdCBjb3B5IHR5cGVzIGxpa2UgbW9kdWxlLCBjbGFzcywgZnVuY3Rpb24sIG1ldGhvZCwKbm9yIHN0YWNrIHRyYWNlLCBzdGFjayBmcmFtZSwgbm9yIGZpbGUsIHNvY2tldCwgd2luZG93LCBub3IgYXJyYXksIG5vcgphbnkgc2ltaWxhciB0eXBlcy4KCkNsYXNzZXMgY2FuIHVzZSB0aGUgc2FtZSBpbnRlcmZhY2VzIHRvIGNvbnRyb2wgY29weWluZyB0aGF0IHRoZXkgdXNlCnRvIGNvbnRyb2wgcGlja2xpbmc6IHRoZXkgY2FuIGRlZmluZSBtZXRob2RzIGNhbGxlZCBfX2dldGluaXRhcmdzX18oKSwKX19nZXRzdGF0ZV9fKCkgYW5kIF9fc2V0c3RhdGVfXygpLiAgU2VlIHRoZSBkb2N1bWVudGF0aW9uIGZvciBtb2R1bGUKInBpY2tsZSIgZm9yIGluZm9ybWF0aW9uIG9uIHRoZXNlIG1ldGhvZHMuCiIiIgoKaW1wb3J0IHR5cGVzCmltcG9ydCB3ZWFrcmVmCiMgQkUsIGNvcHlyZWcgaXMgZm9yIEMgY2xhc3NlcywgZXRjLCBzbyBtYXliZSBub3QgbmVlZCBpdCBmb3IgYnJ5dGhvbgojZnJvbSBjb3B5cmVnIGltcG9ydCBkaXNwYXRjaF90YWJsZQpkaXNwYXRjaF90YWJsZT17fQppbXBvcnQgYnVpbHRpbnMKCmNsYXNzIEVycm9yKEV4Y2VwdGlvbik6CiAgICBwYXNzCmVycm9yID0gRXJyb3IgICAjIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkKCiN0cnk6CiMgICAgZnJvbSBvcmcucHl0aG9uLmNvcmUgaW1wb3J0IFB5U3RyaW5nTWFwCiNleGNlcHQgSW1wb3J0RXJyb3I6CiMgICAgUHlTdHJpbmdNYXAgPSBOb25lClB5U3RyaW5nTWFwID0gTm9uZQoKX19hbGxfXyA9IFsiRXJyb3IiLCAiY29weSIsICJkZWVwY29weSJdCgpkZWYgY29weSh4KToKICAgICIiIlNoYWxsb3cgY29weSBvcGVyYXRpb24gb24gYXJiaXRyYXJ5IFB5dGhvbiBvYmplY3RzLgoKICAgIFNlZSB0aGUgbW9kdWxlJ3MgX19kb2NfXyBzdHJpbmcgZm9yIG1vcmUgaW5mby4KICAgICIiIgoKICAgIGNscyA9IHR5cGUoeCkKCiAgICBjb3BpZXIgPSBfY29weV9kaXNwYXRjaC5nZXQoY2xzKQogICAgaWYgY29waWVyOgogICAgICAgIHJldHVybiBjb3BpZXIoeCkKCiAgICBjb3BpZXIgPSBnZXRhdHRyKGNscywgIl9fY29weV9fIiwgTm9uZSkKICAgIGlmIGNvcGllcjoKICAgICAgICByZXR1cm4gY29waWVyKHgpCgogICAgcmVkdWN0b3IgPSBkaXNwYXRjaF90YWJsZS5nZXQoY2xzKQogICAgaWYgcmVkdWN0b3I6CiAgICAgICAgcnYgPSByZWR1Y3Rvcih4KQogICAgZWxzZToKICAgICAgICByZWR1Y3RvciA9IGdldGF0dHIoeCwgIl9fcmVkdWNlX2V4X18iLCBOb25lKQogICAgICAgIGlmIHJlZHVjdG9yOgogICAgICAgICAgICBydiA9IHJlZHVjdG9yKDIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmVkdWN0b3IgPSBnZXRhdHRyKHgsICJfX3JlZHVjZV9fIiwgTm9uZSkKICAgICAgICAgICAgaWYgcmVkdWN0b3I6CiAgICAgICAgICAgICAgICBydiA9IHJlZHVjdG9yKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlIEVycm9yKCJ1bihzaGFsbG93KWNvcHlhYmxlIG9iamVjdCBvZiB0eXBlICVzIiAlIGNscykKCiAgICByZXR1cm4gX3JlY29uc3RydWN0KHgsIHJ2LCAwKQoKCl9jb3B5X2Rpc3BhdGNoID0gZCA9IHt9CgpkZWYgX2NvcHlfaW1tdXRhYmxlKHgpOgogICAgcmV0dXJuIHgKZm9yIHQgaW4gKHR5cGUoTm9uZSksIGludCwgZmxvYXQsIGJvb2wsIHN0ciwgdHVwbGUsCiAgICAgICAgICBmcm96ZW5zZXQsIHR5cGUsIHJhbmdlLAogICAgICAgICAgdHlwZXMuQnVpbHRpbkZ1bmN0aW9uVHlwZSwgdHlwZShFbGxpcHNpcyksCiAgICAgICAgICB0eXBlcy5GdW5jdGlvblR5cGUsIHdlYWtyZWYucmVmKToKICAgIGRbdF0gPSBfY29weV9pbW11dGFibGUKdCA9IGdldGF0dHIodHlwZXMsICJDb2RlVHlwZSIsIE5vbmUpCmlmIHQgaXMgbm90IE5vbmU6CiAgICBkW3RdID0gX2NvcHlfaW1tdXRhYmxlCmZvciBuYW1lIGluICgiY29tcGxleCIsICJ1bmljb2RlIik6CiAgICB0ID0gZ2V0YXR0cihidWlsdGlucywgbmFtZSwgTm9uZSkKICAgIGlmIHQgaXMgbm90IE5vbmU6CiAgICAgICAgZFt0XSA9IF9jb3B5X2ltbXV0YWJsZQoKZGVmIF9jb3B5X3dpdGhfY29uc3RydWN0b3IoeCk6CiAgICByZXR1cm4gdHlwZSh4KSh4KQpmb3IgdCBpbiAobGlzdCwgZGljdCwgc2V0KToKICAgIGRbdF0gPSBfY29weV93aXRoX2NvbnN0cnVjdG9yCgpkZWYgX2NvcHlfd2l0aF9jb3B5X21ldGhvZCh4KToKICAgIHJldHVybiB4LmNvcHkoKQppZiBQeVN0cmluZ01hcCBpcyBub3QgTm9uZToKICAgIGRbUHlTdHJpbmdNYXBdID0gX2NvcHlfd2l0aF9jb3B5X21ldGhvZAoKZGVsIGQKCmRlZiBkZWVwY29weSh4LCBtZW1vPU5vbmUsIF9uaWw9W10pOgogICAgIiIiRGVlcCBjb3B5IG9wZXJhdGlvbiBvbiBhcmJpdHJhcnkgUHl0aG9uIG9iamVjdHMuCgogICAgU2VlIHRoZSBtb2R1bGUncyBfX2RvY19fIHN0cmluZyBmb3IgbW9yZSBpbmZvLgogICAgIiIiCgogICAgaWYgbWVtbyBpcyBOb25lOgogICAgICAgIG1lbW8gPSB7fQoKICAgIGQgPSBpZCh4KQogICAgeSA9IG1lbW8uZ2V0KGQsIF9uaWwpCiAgICBpZiB5IGlzIG5vdCBfbmlsOgogICAgICAgIHJldHVybiB5CgogICAgY2xzID0gdHlwZSh4KQoKICAgIGNvcGllciA9IF9kZWVwY29weV9kaXNwYXRjaC5nZXQoY2xzKQogICAgaWYgY29waWVyOgogICAgICAgIHkgPSBjb3BpZXIoeCwgbWVtbykKICAgIGVsc2U6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBpc3NjID0gaXNzdWJjbGFzcyhjbHMsIHR5cGUpCiAgICAgICAgZXhjZXB0IFR5cGVFcnJvcjogIyBjbHMgaXMgbm90IGEgY2xhc3MgKG9sZCBCb29zdDsgc2VlIFNGICM1MDIwODUpCiAgICAgICAgICAgIGlzc2MgPSAwCiAgICAgICAgaWYgaXNzYzoKICAgICAgICAgICAgeSA9IF9kZWVwY29weV9hdG9taWMoeCwgbWVtbykKICAgICAgICBlbHNlOgogICAgICAgICAgICBjb3BpZXIgPSBnZXRhdHRyKHgsICJfX2RlZXBjb3B5X18iLCBOb25lKQogICAgICAgICAgICBpZiBjb3BpZXI6CiAgICAgICAgICAgICAgICB5ID0gY29waWVyKG1lbW8pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZWR1Y3RvciA9IGRpc3BhdGNoX3RhYmxlLmdldChjbHMpCiAgICAgICAgICAgICAgICBpZiByZWR1Y3RvcjoKICAgICAgICAgICAgICAgICAgICBydiA9IHJlZHVjdG9yKHgpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHJlZHVjdG9yID0gZ2V0YXR0cih4LCAiX19yZWR1Y2VfZXhfXyIsIE5vbmUpCiAgICAgICAgICAgICAgICAgICAgaWYgcmVkdWN0b3I6CiAgICAgICAgICAgICAgICAgICAgICAgIHJ2ID0gcmVkdWN0b3IoMikKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICByZWR1Y3RvciA9IGdldGF0dHIoeCwgIl9fcmVkdWNlX18iLCBOb25lKQogICAgICAgICAgICAgICAgICAgICAgICBpZiByZWR1Y3RvcjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ2ID0gcmVkdWN0b3IoKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFpc2UgRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInVuKGRlZXApY29weWFibGUgb2JqZWN0IG9mIHR5cGUgJXMiICUgY2xzKQogICAgICAgICAgICAgICAgeSA9IF9yZWNvbnN0cnVjdCh4LCBydiwgMSwgbWVtbykKCiAgICAjIElmIGlzIGl0cyBvd24gY29weSwgZG9uJ3QgbWVtb2l6ZS4KICAgIGlmIHkgaXMgbm90IHg6CiAgICAgICAgbWVtb1tkXSA9IHkKICAgICAgICBfa2VlcF9hbGl2ZSh4LCBtZW1vKSAjIE1ha2Ugc3VyZSB4IGxpdmVzIGF0IGxlYXN0IGFzIGxvbmcgYXMgZAogICAgcmV0dXJuIHkKCl9kZWVwY29weV9kaXNwYXRjaCA9IGQgPSB7fQoKZGVmIF9kZWVwY29weV9hdG9taWMoeCwgbWVtbyk6CiAgICByZXR1cm4geApkW3R5cGUoTm9uZSldID0gX2RlZXBjb3B5X2F0b21pYwpkW3R5cGUoRWxsaXBzaXMpXSA9IF9kZWVwY29weV9hdG9taWMKZFtpbnRdID0gX2RlZXBjb3B5X2F0b21pYwpkW2Zsb2F0XSA9IF9kZWVwY29weV9hdG9taWMKZFtib29sXSA9IF9kZWVwY29weV9hdG9taWMKdHJ5OgogICAgZFtjb21wbGV4XSA9IF9kZWVwY29weV9hdG9taWMKZXhjZXB0IE5hbWVFcnJvcjoKICAgIHBhc3MKZFtieXRlc10gPSBfZGVlcGNvcHlfYXRvbWljCmRbc3RyXSA9IF9kZWVwY29weV9hdG9taWMKdHJ5OgogICAgZFt0eXBlcy5Db2RlVHlwZV0gPSBfZGVlcGNvcHlfYXRvbWljCmV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgIHBhc3MKZFt0eXBlXSA9IF9kZWVwY29weV9hdG9taWMKZFtyYW5nZV0gPSBfZGVlcGNvcHlfYXRvbWljCmRbdHlwZXMuQnVpbHRpbkZ1bmN0aW9uVHlwZV0gPSBfZGVlcGNvcHlfYXRvbWljCmRbdHlwZXMuRnVuY3Rpb25UeXBlXSA9IF9kZWVwY29weV9hdG9taWMKZFt3ZWFrcmVmLnJlZl0gPSBfZGVlcGNvcHlfYXRvbWljCgpkZWYgX2RlZXBjb3B5X2xpc3QoeCwgbWVtbyk6CiAgICB5ID0gW10KICAgIG1lbW9baWQoeCldID0geQogICAgZm9yIGEgaW4geDoKICAgICAgICB5LmFwcGVuZChkZWVwY29weShhLCBtZW1vKSkKICAgIHJldHVybiB5CmRbbGlzdF0gPSBfZGVlcGNvcHlfbGlzdAoKZGVmIF9kZWVwY29weV90dXBsZSh4LCBtZW1vKToKICAgIHkgPSBbXQogICAgZm9yIGEgaW4geDoKICAgICAgICB5LmFwcGVuZChkZWVwY29weShhLCBtZW1vKSkKICAgICMgV2UncmUgbm90IGdvaW5nIHRvIHB1dCB0aGUgdHVwbGUgaW4gdGhlIG1lbW8sIGJ1dCBpdCdzIHN0aWxsIGltcG9ydGFudCB3ZQogICAgIyBjaGVjayBmb3IgaXQsIGluIGNhc2UgdGhlIHR1cGxlIGNvbnRhaW5zIHJlY3Vyc2l2ZSBtdXRhYmxlIHN0cnVjdHVyZXMuCiAgICB0cnk6CiAgICAgICAgcmV0dXJuIG1lbW9baWQoeCldCiAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgcGFzcwogICAgZm9yIGkgaW4gcmFuZ2UobGVuKHgpKToKICAgICAgICBpZiB4W2ldIGlzIG5vdCB5W2ldOgogICAgICAgICAgICB5ID0gdHVwbGUoeSkKICAgICAgICAgICAgYnJlYWsKICAgIGVsc2U6CiAgICAgICAgeSA9IHgKICAgIHJldHVybiB5CmRbdHVwbGVdID0gX2RlZXBjb3B5X3R1cGxlCgpkZWYgX2RlZXBjb3B5X2RpY3QoeCwgbWVtbyk6CiAgICB5ID0ge30KICAgIG1lbW9baWQoeCldID0geQogICAgZm9yIGtleSwgdmFsdWUgaW4geC5pdGVtcygpOgogICAgICAgIHlbZGVlcGNvcHkoa2V5LCBtZW1vKV0gPSBkZWVwY29weSh2YWx1ZSwgbWVtbykKICAgIHJldHVybiB5CmRbZGljdF0gPSBfZGVlcGNvcHlfZGljdAppZiBQeVN0cmluZ01hcCBpcyBub3QgTm9uZToKICAgIGRbUHlTdHJpbmdNYXBdID0gX2RlZXBjb3B5X2RpY3QKCmRlZiBfZGVlcGNvcHlfbWV0aG9kKHgsIG1lbW8pOiAjIENvcHkgaW5zdGFuY2UgbWV0aG9kcwogICAgcmV0dXJuIHR5cGUoeCkoeC5fX2Z1bmNfXywgZGVlcGNvcHkoeC5fX3NlbGZfXywgbWVtbykpCl9kZWVwY29weV9kaXNwYXRjaFt0eXBlcy5NZXRob2RUeXBlXSA9IF9kZWVwY29weV9tZXRob2QKCmRlZiBfa2VlcF9hbGl2ZSh4LCBtZW1vKToKICAgICIiIktlZXBzIGEgcmVmZXJlbmNlIHRvIHRoZSBvYmplY3QgeCBpbiB0aGUgbWVtby4KCiAgICBCZWNhdXNlIHdlIHJlbWVtYmVyIG9iamVjdHMgYnkgdGhlaXIgaWQsIHdlIGhhdmUKICAgIHRvIGFzc3VyZSB0aGF0IHBvc3NpYmx5IHRlbXBvcmFyeSBvYmplY3RzIGFyZSBrZXB0CiAgICBhbGl2ZSBieSByZWZlcmVuY2luZyB0aGVtLgogICAgV2Ugc3RvcmUgYSByZWZlcmVuY2UgYXQgdGhlIGlkIG9mIHRoZSBtZW1vLCB3aGljaCBzaG91bGQKICAgIG5vcm1hbGx5IG5vdCBiZSB1c2VkIHVubGVzcyBzb21lb25lIHRyaWVzIHRvIGRlZXBjb3B5CiAgICB0aGUgbWVtbyBpdHNlbGYuLi4KICAgICIiIgogICAgdHJ5OgogICAgICAgIG1lbW9baWQobWVtbyldLmFwcGVuZCh4KQogICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICMgYWhhLCB0aGlzIGlzIHRoZSBmaXJzdCBvbmUgOi0pCiAgICAgICAgbWVtb1tpZChtZW1vKV09W3hdCgpkZWYgX3JlY29uc3RydWN0KHgsIGluZm8sIGRlZXAsIG1lbW89Tm9uZSk6CiAgICBpZiBpc2luc3RhbmNlKGluZm8sIHN0cik6CiAgICAgICAgcmV0dXJuIHgKICAgIGFzc2VydCBpc2luc3RhbmNlKGluZm8sIHR1cGxlKQogICAgaWYgbWVtbyBpcyBOb25lOgogICAgICAgIG1lbW8gPSB7fQogICAgbiA9IGxlbihpbmZvKQogICAgYXNzZXJ0IG4gaW4gKDIsIDMsIDQsIDUpCiAgICBjYWxsYWJsZSwgYXJncyA9IGluZm9bOjJdCiAgICBpZiBuID4gMjoKICAgICAgICBzdGF0ZSA9IGluZm9bMl0KICAgIGVsc2U6CiAgICAgICAgc3RhdGUgPSB7fQogICAgaWYgbiA+IDM6CiAgICAgICAgbGlzdGl0ZXIgPSBpbmZvWzNdCiAgICBlbHNlOgogICAgICAgIGxpc3RpdGVyID0gTm9uZQogICAgaWYgbiA+IDQ6CiAgICAgICAgZGljdGl0ZXIgPSBpbmZvWzRdCiAgICBlbHNlOgogICAgICAgIGRpY3RpdGVyID0gTm9uZQogICAgaWYgZGVlcDoKICAgICAgICBhcmdzID0gZGVlcGNvcHkoYXJncywgbWVtbykKICAgIHkgPSBjYWxsYWJsZSgqYXJncykKICAgIG1lbW9baWQoeCldID0geQoKICAgIGlmIHN0YXRlOgogICAgICAgIGlmIGRlZXA6CiAgICAgICAgICAgIHN0YXRlID0gZGVlcGNvcHkoc3RhdGUsIG1lbW8pCiAgICAgICAgaWYgaGFzYXR0cih5LCAnX19zZXRzdGF0ZV9fJyk6CiAgICAgICAgICAgIHkuX19zZXRzdGF0ZV9fKHN0YXRlKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uoc3RhdGUsIHR1cGxlKSBhbmQgbGVuKHN0YXRlKSA9PSAyOgogICAgICAgICAgICAgICAgc3RhdGUsIHNsb3RzdGF0ZSA9IHN0YXRlCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzbG90c3RhdGUgPSBOb25lCiAgICAgICAgICAgIGlmIHN0YXRlIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgeS5fX2RpY3RfXy51cGRhdGUoc3RhdGUpCiAgICAgICAgICAgIGlmIHNsb3RzdGF0ZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIGZvciBrZXksIHZhbHVlIGluIHNsb3RzdGF0ZS5pdGVtcygpOgogICAgICAgICAgICAgICAgICAgIHNldGF0dHIoeSwga2V5LCB2YWx1ZSkKCiAgICBpZiBsaXN0aXRlciBpcyBub3QgTm9uZToKICAgICAgICBmb3IgaXRlbSBpbiBsaXN0aXRlcjoKICAgICAgICAgICAgaWYgZGVlcDoKICAgICAgICAgICAgICAgIGl0ZW0gPSBkZWVwY29weShpdGVtLCBtZW1vKQogICAgICAgICAgICB5LmFwcGVuZChpdGVtKQogICAgaWYgZGljdGl0ZXIgaXMgbm90IE5vbmU6CiAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gZGljdGl0ZXI6CiAgICAgICAgICAgIGlmIGRlZXA6CiAgICAgICAgICAgICAgICBrZXkgPSBkZWVwY29weShrZXksIG1lbW8pCiAgICAgICAgICAgICAgICB2YWx1ZSA9IGRlZXBjb3B5KHZhbHVlLCBtZW1vKQogICAgICAgICAgICB5W2tleV0gPSB2YWx1ZQogICAgcmV0dXJuIHkKCmRlbCBkCgpkZWwgdHlwZXMKCiMgSGVscGVyIGZvciBpbnN0YW5jZSBjcmVhdGlvbiB3aXRob3V0IGNhbGxpbmcgX19pbml0X18KY2xhc3MgX0VtcHR5Q2xhc3M6CiAgICBwYXNzCg==',
'/Lib/copyreg.py':'IiIiSGVscGVyIHRvIHByb3ZpZGUgZXh0ZW5zaWJpbGl0eSBmb3IgcGlja2xlLgoKVGhpcyBpcyBvbmx5IHVzZWZ1bCB0byBhZGQgcGlja2xlIHN1cHBvcnQgZm9yIGV4dGVuc2lvbiB0eXBlcyBkZWZpbmVkIGluCkMsIG5vdCBmb3IgaW5zdGFuY2VzIG9mIHVzZXItZGVmaW5lZCBjbGFzc2VzLgoiIiIKCl9fYWxsX18gPSBbInBpY2tsZSIsICJjb25zdHJ1Y3RvciIsCiAgICAgICAgICAgImFkZF9leHRlbnNpb24iLCAicmVtb3ZlX2V4dGVuc2lvbiIsICJjbGVhcl9leHRlbnNpb25fY2FjaGUiXQoKZGlzcGF0Y2hfdGFibGUgPSB7fQoKZGVmIHBpY2tsZShvYl90eXBlLCBwaWNrbGVfZnVuY3Rpb24sIGNvbnN0cnVjdG9yX29iPU5vbmUpOgogICAgaWYgbm90IGNhbGxhYmxlKHBpY2tsZV9mdW5jdGlvbik6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJyZWR1Y3Rpb24gZnVuY3Rpb25zIG11c3QgYmUgY2FsbGFibGUiKQogICAgZGlzcGF0Y2hfdGFibGVbb2JfdHlwZV0gPSBwaWNrbGVfZnVuY3Rpb24KCiAgICAjIFRoZSBjb25zdHJ1Y3Rvcl9vYiBmdW5jdGlvbiBpcyBhIHZlc3RpZ2Ugb2Ygc2FmZSBmb3IgdW5waWNrbGluZy4KICAgICMgVGhlcmUgaXMgbm8gcmVhc29uIGZvciB0aGUgY2FsbGVyIHRvIHBhc3MgaXQgYW55bW9yZS4KICAgIGlmIGNvbnN0cnVjdG9yX29iIGlzIG5vdCBOb25lOgogICAgICAgIGNvbnN0cnVjdG9yKGNvbnN0cnVjdG9yX29iKQoKZGVmIGNvbnN0cnVjdG9yKG9iamVjdCk6CiAgICBpZiBub3QgY2FsbGFibGUob2JqZWN0KToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoImNvbnN0cnVjdG9ycyBtdXN0IGJlIGNhbGxhYmxlIikKCiMgRXhhbXBsZTogcHJvdmlkZSBwaWNrbGluZyBzdXBwb3J0IGZvciBjb21wbGV4IG51bWJlcnMuCgp0cnk6CiAgICBjb21wbGV4CmV4Y2VwdCBOYW1lRXJyb3I6CiAgICBwYXNzCmVsc2U6CgogICAgZGVmIHBpY2tsZV9jb21wbGV4KGMpOgogICAgICAgIHJldHVybiBjb21wbGV4LCAoYy5yZWFsLCBjLmltYWcpCgogICAgcGlja2xlKGNvbXBsZXgsIHBpY2tsZV9jb21wbGV4LCBjb21wbGV4KQoKIyBTdXBwb3J0IGZvciBwaWNrbGluZyBuZXctc3R5bGUgb2JqZWN0cwoKZGVmIF9yZWNvbnN0cnVjdG9yKGNscywgYmFzZSwgc3RhdGUpOgogICAgaWYgYmFzZSBpcyBvYmplY3Q6CiAgICAgICAgb2JqID0gb2JqZWN0Ll9fbmV3X18oY2xzKQogICAgZWxzZToKICAgICAgICBvYmogPSBiYXNlLl9fbmV3X18oY2xzLCBzdGF0ZSkKICAgICAgICBpZiBiYXNlLl9faW5pdF9fICE9IG9iamVjdC5fX2luaXRfXzoKICAgICAgICAgICAgYmFzZS5fX2luaXRfXyhvYmosIHN0YXRlKQogICAgcmV0dXJuIG9iagoKX0hFQVBUWVBFID0gMTw8OQoKIyBQeXRob24gY29kZSBmb3Igb2JqZWN0Ll9fcmVkdWNlX2V4X18gZm9yIHByb3RvY29scyAwIGFuZCAxCgpkZWYgX3JlZHVjZV9leChzZWxmLCBwcm90byk6CiAgICBhc3NlcnQgcHJvdG8gPCAyCiAgICBmb3IgYmFzZSBpbiBzZWxmLl9fY2xhc3NfXy5fX21yb19fOgogICAgICAgIGlmIGhhc2F0dHIoYmFzZSwgJ19fZmxhZ3NfXycpIGFuZCBub3QgYmFzZS5fX2ZsYWdzX18gJiBfSEVBUFRZUEU6CiAgICAgICAgICAgIGJyZWFrCiAgICBlbHNlOgogICAgICAgIGJhc2UgPSBvYmplY3QgIyBub3QgcmVhbGx5IHJlYWNoYWJsZQogICAgaWYgYmFzZSBpcyBvYmplY3Q6CiAgICAgICAgc3RhdGUgPSBOb25lCiAgICBlbHNlOgogICAgICAgIGlmIGJhc2UgaXMgc2VsZi5fX2NsYXNzX186CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiY2FuJ3QgcGlja2xlICVzIG9iamVjdHMiICUgYmFzZS5fX25hbWVfXykKICAgICAgICBzdGF0ZSA9IGJhc2Uoc2VsZikKICAgIGFyZ3MgPSAoc2VsZi5fX2NsYXNzX18sIGJhc2UsIHN0YXRlKQogICAgdHJ5OgogICAgICAgIGdldHN0YXRlID0gc2VsZi5fX2dldHN0YXRlX18KICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICBpZiBnZXRhdHRyKHNlbGYsICJfX3Nsb3RzX18iLCBOb25lKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJhIGNsYXNzIHRoYXQgZGVmaW5lcyBfX3Nsb3RzX18gd2l0aG91dCAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZGVmaW5pbmcgX19nZXRzdGF0ZV9fIGNhbm5vdCBiZSBwaWNrbGVkIikKICAgICAgICB0cnk6CiAgICAgICAgICAgIGRpY3QgPSBzZWxmLl9fZGljdF9fCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICBkaWN0ID0gTm9uZQogICAgZWxzZToKICAgICAgICBkaWN0ID0gZ2V0c3RhdGUoKQogICAgaWYgZGljdDoKICAgICAgICByZXR1cm4gX3JlY29uc3RydWN0b3IsIGFyZ3MsIGRpY3QKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIF9yZWNvbnN0cnVjdG9yLCBhcmdzCgojIEhlbHBlciBmb3IgX19yZWR1Y2VfZXhfXyBwcm90b2NvbCAyCgpkZWYgX19uZXdvYmpfXyhjbHMsICphcmdzKToKICAgIHJldHVybiBjbHMuX19uZXdfXyhjbHMsICphcmdzKQoKZGVmIF9zbG90bmFtZXMoY2xzKToKICAgICIiIlJldHVybiBhIGxpc3Qgb2Ygc2xvdCBuYW1lcyBmb3IgYSBnaXZlbiBjbGFzcy4KCiAgICBUaGlzIG5lZWRzIHRvIGZpbmQgc2xvdHMgZGVmaW5lZCBieSB0aGUgY2xhc3MgYW5kIGl0cyBiYXNlcywgc28gd2UKICAgIGNhbid0IHNpbXBseSByZXR1cm4gdGhlIF9fc2xvdHNfXyBhdHRyaWJ1dGUuICBXZSBtdXN0IHdhbGsgZG93bgogICAgdGhlIE1ldGhvZCBSZXNvbHV0aW9uIE9yZGVyIGFuZCBjb25jYXRlbmF0ZSB0aGUgX19zbG90c19fIG9mIGVhY2gKICAgIGNsYXNzIGZvdW5kIHRoZXJlLiAgKFRoaXMgYXNzdW1lcyBjbGFzc2VzIGRvbid0IG1vZGlmeSB0aGVpcgogICAgX19zbG90c19fIGF0dHJpYnV0ZSB0byBtaXNyZXByZXNlbnQgdGhlaXIgc2xvdHMgYWZ0ZXIgdGhlIGNsYXNzIGlzCiAgICBkZWZpbmVkLikKICAgICIiIgoKICAgICMgR2V0IHRoZSB2YWx1ZSBmcm9tIGEgY2FjaGUgaW4gdGhlIGNsYXNzIGlmIHBvc3NpYmxlCiAgICBuYW1lcyA9IGNscy5fX2RpY3RfXy5nZXQoIl9fc2xvdG5hbWVzX18iKQogICAgaWYgbmFtZXMgaXMgbm90IE5vbmU6CiAgICAgICAgcmV0dXJuIG5hbWVzCgogICAgIyBOb3QgY2FjaGVkIC0tIGNhbGN1bGF0ZSB0aGUgdmFsdWUKICAgIG5hbWVzID0gW10KICAgIGlmIG5vdCBoYXNhdHRyKGNscywgIl9fc2xvdHNfXyIpOgogICAgICAgICMgVGhpcyBjbGFzcyBoYXMgbm8gc2xvdHMKICAgICAgICBwYXNzCiAgICBlbHNlOgogICAgICAgICMgU2xvdHMgZm91bmQgLS0gZ2F0aGVyIHNsb3QgbmFtZXMgZnJvbSBhbGwgYmFzZSBjbGFzc2VzCiAgICAgICAgZm9yIGMgaW4gY2xzLl9fbXJvX186CiAgICAgICAgICAgIGlmICJfX3Nsb3RzX18iIGluIGMuX19kaWN0X186CiAgICAgICAgICAgICAgICBzbG90cyA9IGMuX19kaWN0X19bJ19fc2xvdHNfXyddCiAgICAgICAgICAgICAgICAjIGlmIGNsYXNzIGhhcyBhIHNpbmdsZSBzbG90LCBpdCBjYW4gYmUgZ2l2ZW4gYXMgYSBzdHJpbmcKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uoc2xvdHMsIHN0cik6CiAgICAgICAgICAgICAgICAgICAgc2xvdHMgPSAoc2xvdHMsKQogICAgICAgICAgICAgICAgZm9yIG5hbWUgaW4gc2xvdHM6CiAgICAgICAgICAgICAgICAgICAgIyBzcGVjaWFsIGRlc2NyaXB0b3JzCiAgICAgICAgICAgICAgICAgICAgaWYgbmFtZSBpbiAoIl9fZGljdF9fIiwgIl9fd2Vha3JlZl9fIik6CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgIyBtYW5nbGVkIG5hbWVzCiAgICAgICAgICAgICAgICAgICAgZWxpZiBuYW1lLnN0YXJ0c3dpdGgoJ19fJykgYW5kIG5vdCBuYW1lLmVuZHN3aXRoKCdfXycpOgogICAgICAgICAgICAgICAgICAgICAgICBuYW1lcy5hcHBlbmQoJ18lcyVzJyAlIChjLl9fbmFtZV9fLCBuYW1lKSkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBuYW1lcy5hcHBlbmQobmFtZSkKCiAgICAjIENhY2hlIHRoZSBvdXRjb21lIGluIHRoZSBjbGFzcyBpZiBhdCBhbGwgcG9zc2libGUKICAgIHRyeToKICAgICAgICBjbHMuX19zbG90bmFtZXNfXyA9IG5hbWVzCiAgICBleGNlcHQ6CiAgICAgICAgcGFzcyAjIEJ1dCBkb24ndCBkaWUgaWYgd2UgY2FuJ3QKCiAgICByZXR1cm4gbmFtZXMKCiMgQSByZWdpc3RyeSBvZiBleHRlbnNpb24gY29kZXMuICBUaGlzIGlzIGFuIGFkLWhvYyBjb21wcmVzc2lvbgojIG1lY2hhbmlzbS4gIFdoZW5ldmVyIGEgZ2xvYmFsIHJlZmVyZW5jZSB0byA8bW9kdWxlPiwgPG5hbWU+IGlzIGFib3V0CiMgdG8gYmUgcGlja2xlZCwgdGhlICg8bW9kdWxlPiwgPG5hbWU+KSB0dXBsZSBpcyBsb29rZWQgdXAgaGVyZSB0byBzZWUKIyBpZiBpdCBpcyBhIHJlZ2lzdGVyZWQgZXh0ZW5zaW9uIGNvZGUgZm9yIGl0LiAgRXh0ZW5zaW9uIGNvZGVzIGFyZQojIHVuaXZlcnNhbCwgc28gdGhhdCB0aGUgbWVhbmluZyBvZiBhIHBpY2tsZSBkb2VzIG5vdCBkZXBlbmQgb24KIyBjb250ZXh0LiAgKFRoZXJlIGFyZSBhbHNvIHNvbWUgY29kZXMgcmVzZXJ2ZWQgZm9yIGxvY2FsIHVzZSB0aGF0CiMgZG9uJ3QgaGF2ZSB0aGlzIHJlc3RyaWN0aW9uLikgIENvZGVzIGFyZSBwb3NpdGl2ZSBpbnRzOyAwIGlzCiMgcmVzZXJ2ZWQuCgpfZXh0ZW5zaW9uX3JlZ2lzdHJ5ID0ge30gICAgICAgICAgICAgICAgIyBrZXkgLT4gY29kZQpfaW52ZXJ0ZWRfcmVnaXN0cnkgPSB7fSAgICAgICAgICAgICAgICAgIyBjb2RlIC0+IGtleQpfZXh0ZW5zaW9uX2NhY2hlID0ge30gICAgICAgICAgICAgICAgICAgIyBjb2RlIC0+IG9iamVjdAojIERvbid0IGV2ZXIgcmViaW5kIHRob3NlIG5hbWVzOiAgcGlja2xpbmcgZ3JhYnMgYSByZWZlcmVuY2UgdG8gdGhlbSB3aGVuCiMgaXQncyBpbml0aWFsaXplZCwgYW5kIHdvbid0IHNlZSBhIHJlYmluZGluZy4KCmRlZiBhZGRfZXh0ZW5zaW9uKG1vZHVsZSwgbmFtZSwgY29kZSk6CiAgICAiIiJSZWdpc3RlciBhbiBleHRlbnNpb24gY29kZS4iIiIKICAgIGNvZGUgPSBpbnQoY29kZSkKICAgIGlmIG5vdCAxIDw9IGNvZGUgPD0gMHg3ZmZmZmZmZjoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJjb2RlIG91dCBvZiByYW5nZSIpCiAgICBrZXkgPSAobW9kdWxlLCBuYW1lKQogICAgaWYgKF9leHRlbnNpb25fcmVnaXN0cnkuZ2V0KGtleSkgPT0gY29kZSBhbmQKICAgICAgICBfaW52ZXJ0ZWRfcmVnaXN0cnkuZ2V0KGNvZGUpID09IGtleSk6CiAgICAgICAgcmV0dXJuICMgUmVkdW5kYW50IHJlZ2lzdHJhdGlvbnMgYXJlIGJlbmlnbgogICAgaWYga2V5IGluIF9leHRlbnNpb25fcmVnaXN0cnk6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigia2V5ICVzIGlzIGFscmVhZHkgcmVnaXN0ZXJlZCB3aXRoIGNvZGUgJXMiICUKICAgICAgICAgICAgICAgICAgICAgICAgIChrZXksIF9leHRlbnNpb25fcmVnaXN0cnlba2V5XSkpCiAgICBpZiBjb2RlIGluIF9pbnZlcnRlZF9yZWdpc3RyeToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJjb2RlICVzIGlzIGFscmVhZHkgaW4gdXNlIGZvciBrZXkgJXMiICUKICAgICAgICAgICAgICAgICAgICAgICAgIChjb2RlLCBfaW52ZXJ0ZWRfcmVnaXN0cnlbY29kZV0pKQogICAgX2V4dGVuc2lvbl9yZWdpc3RyeVtrZXldID0gY29kZQogICAgX2ludmVydGVkX3JlZ2lzdHJ5W2NvZGVdID0ga2V5CgpkZWYgcmVtb3ZlX2V4dGVuc2lvbihtb2R1bGUsIG5hbWUsIGNvZGUpOgogICAgIiIiVW5yZWdpc3RlciBhbiBleHRlbnNpb24gY29kZS4gIEZvciB0ZXN0aW5nIG9ubHkuIiIiCiAgICBrZXkgPSAobW9kdWxlLCBuYW1lKQogICAgaWYgKF9leHRlbnNpb25fcmVnaXN0cnkuZ2V0KGtleSkgIT0gY29kZSBvcgogICAgICAgIF9pbnZlcnRlZF9yZWdpc3RyeS5nZXQoY29kZSkgIT0ga2V5KToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJrZXkgJXMgaXMgbm90IHJlZ2lzdGVyZWQgd2l0aCBjb2RlICVzIiAlCiAgICAgICAgICAgICAgICAgICAgICAgICAoa2V5LCBjb2RlKSkKICAgIGRlbCBfZXh0ZW5zaW9uX3JlZ2lzdHJ5W2tleV0KICAgIGRlbCBfaW52ZXJ0ZWRfcmVnaXN0cnlbY29kZV0KICAgIGlmIGNvZGUgaW4gX2V4dGVuc2lvbl9jYWNoZToKICAgICAgICBkZWwgX2V4dGVuc2lvbl9jYWNoZVtjb2RlXQoKZGVmIGNsZWFyX2V4dGVuc2lvbl9jYWNoZSgpOgogICAgX2V4dGVuc2lvbl9jYWNoZS5jbGVhcigpCgojIFN0YW5kYXJkIGV4dGVuc2lvbiBjb2RlIGFzc2lnbm1lbnRzCgojIFJlc2VydmVkIHJhbmdlcwoKIyBGaXJzdCAgTGFzdCBDb3VudCAgUHVycG9zZQojICAgICAxICAgMTI3ICAgMTI3ICBSZXNlcnZlZCBmb3IgUHl0aG9uIHN0YW5kYXJkIGxpYnJhcnkKIyAgIDEyOCAgIDE5MSAgICA2NCAgUmVzZXJ2ZWQgZm9yIFpvcGUKIyAgIDE5MiAgIDIzOSAgICA0OCAgUmVzZXJ2ZWQgZm9yIDNyZCBwYXJ0aWVzCiMgICAyNDAgICAyNTUgICAgMTYgIFJlc2VydmVkIGZvciBwcml2YXRlIHVzZSAod2lsbCBuZXZlciBiZSBhc3NpZ25lZCkKIyAgIDI1NiAgIEluZiAgIEluZiAgUmVzZXJ2ZWQgZm9yIGZ1dHVyZSBhc3NpZ25tZW50CgojIEV4dGVuc2lvbiBjb2RlcyBhcmUgYXNzaWduZWQgYnkgdGhlIFB5dGhvbiBTb2Z0d2FyZSBGb3VuZGF0aW9uLgo=',
'/Lib/datetime.py':'IiIiQ29uY3JldGUgZGF0ZS90aW1lIGFuZCByZWxhdGVkIHR5cGVzIC0tIHByb3RvdHlwZSBpbXBsZW1lbnRlZCBpbiBQeXRob24uCgpTZWUgaHR0cDovL3d3dy56b3BlLm9yZy9NZW1iZXJzL2ZkcmFrZS9EYXRlVGltZVdpa2kvRnJvbnRQYWdlCgpTZWUgYWxzbyBodHRwOi8vZGlyLnlhaG9vLmNvbS9SZWZlcmVuY2UvY2FsZW5kYXJzLwoKRm9yIGEgcHJpbWVyIG9uIERTVCwgaW5jbHVkaW5nIG1hbnkgY3VycmVudCBEU1QgcnVsZXMsIHNlZQpodHRwOi8vd2ViZXhoaWJpdHMub3JnL2RheWxpZ2h0c2F2aW5nLwoKRm9yIG1vcmUgYWJvdXQgRFNUIHRoYW4geW91IGV2ZXIgd2FudGVkIHRvIGtub3csIHNlZQpmdHA6Ly9lbHNpZS5uY2kubmloLmdvdi9wdWIvCgpTb3VyY2VzIGZvciB0aW1lIHpvbmUgYW5kIERTVCBkYXRhOiBodHRwOi8vd3d3LnR3aW5zdW4uY29tL3R6L3R6LWxpbmsuaHRtCgpUaGlzIHdhcyBvcmlnaW5hbGx5IGNvcGllZCBmcm9tIHRoZSBzYW5kYm94IG9mIHRoZSBDUHl0aG9uIENWUyByZXBvc2l0b3J5LgpUaGFua3MgdG8gVGltIFBldGVycyBmb3Igc3VnZ2VzdGluZyB1c2luZyBpdC4KIiIiCgppbXBvcnQgdGltZSBhcyBfdGltZQppbXBvcnQgbWF0aCBhcyBfbWF0aAoKZGVmIF9zdGF0ZV9jbXAoeCwgeSk6CiAgICByZXR1cm4gMCBpZiB4ID09IHkgZWxzZSAxIGlmIHggPiB5IGVsc2UgLTEKCmRlZiBfdHVwbGVfY21wKHgsIHkpOgogICAgcmV0dXJuIDAgaWYgeCA9PSB5IGVsc2UgMSBpZiB4ID4geSBlbHNlIC0xCgpNSU5ZRUFSID0gMQpNQVhZRUFSID0gOTk5OQpfTUFYT1JESU5BTCA9IDM2NTIwNTkgIyBkYXRlLm1heC50b29yZGluYWwoKQoKIyBVdGlsaXR5IGZ1bmN0aW9ucywgYWRhcHRlZCBmcm9tIFB5dGhvbidzIERlbW8vY2xhc3Nlcy9EYXRlcy5weSwgd2hpY2gKIyBhbHNvIGFzc3VtZXMgdGhlIGN1cnJlbnQgR3JlZ29yaWFuIGNhbGVuZGFyIGluZGVmaW5pdGVseSBleHRlbmRlZCBpbgojIGJvdGggZGlyZWN0aW9ucy4gIERpZmZlcmVuY2U6ICBEYXRlcy5weSBjYWxscyBKYW51YXJ5IDEgb2YgeWVhciAwIGRheQojIG51bWJlciAxLiAgVGhlIGNvZGUgaGVyZSBjYWxscyBKYW51YXJ5IDEgb2YgeWVhciAxIGRheSBudW1iZXIgMS4gIFRoaXMgaXMKIyB0byBtYXRjaCB0aGUgZGVmaW5pdGlvbiBvZiB0aGUgInByb2xlcHRpYyBHcmVnb3JpYW4iIGNhbGVuZGFyIGluIERlcnNob3dpdHoKIyBhbmQgUmVpbmdvbGQncyAiQ2FsZW5kcmljYWwgQ2FsY3VsYXRpb25zIiwgd2hlcmUgaXQncyB0aGUgYmFzZSBjYWxlbmRhcgojIGZvciBhbGwgY29tcHV0YXRpb25zLiAgU2VlIHRoZSBib29rIGZvciBhbGdvcml0aG1zIGZvciBjb252ZXJ0aW5nIGJldHdlZW4KIyBwcm9sZXB0aWMgR3JlZ29yaWFuIG9yZGluYWxzIGFuZCBtYW55IG90aGVyIGNhbGVuZGFyIHN5c3RlbXMuCgpfREFZU19JTl9NT05USCA9IFtOb25lLCAzMSwgMjgsIDMxLCAzMCwgMzEsIDMwLCAzMSwgMzEsIDMwLCAzMSwgMzAsIDMxXQoKX0RBWVNfQkVGT1JFX01PTlRIID0gW05vbmVdCmRibSA9IDAKZm9yIGRpbSBpbiBfREFZU19JTl9NT05USFsxOl06CiAgICBfREFZU19CRUZPUkVfTU9OVEguYXBwZW5kKGRibSkKICAgIGRibSArPSBkaW0KI2RlbCBkYm0sIGRpbQoKZGVmIF9pc19sZWFwKHllYXIpOgogICAgInllYXIgLT4gMSBpZiBsZWFwIHllYXIsIGVsc2UgMC4iCiAgICByZXR1cm4geWVhciAlIDQgPT0gMCBhbmQgKHllYXIgJSAxMDAgIT0gMCBvciB5ZWFyICUgNDAwID09IDApCgpkZWYgX2RheXNfYmVmb3JlX3llYXIoeWVhcik6CiAgICAieWVhciAtPiBudW1iZXIgb2YgZGF5cyBiZWZvcmUgSmFudWFyeSAxc3Qgb2YgeWVhci4iCiAgICB5ID0geWVhciAtIDEKICAgIHJldHVybiB5KjM2NSArIHkvLzQgLSB5Ly8xMDAgKyB5Ly80MDAKCmRlZiBfZGF5c19pbl9tb250aCh5ZWFyLCBtb250aCk6CiAgICAieWVhciwgbW9udGggLT4gbnVtYmVyIG9mIGRheXMgaW4gdGhhdCBtb250aCBpbiB0aGF0IHllYXIuIgogICAgYXNzZXJ0IDEgPD0gbW9udGggPD0gMTIsIG1vbnRoCiAgICBpZiBtb250aCA9PSAyIGFuZCBfaXNfbGVhcCh5ZWFyKToKICAgICAgICByZXR1cm4gMjkKICAgIHJldHVybiBfREFZU19JTl9NT05USFttb250aF0KCmRlZiBfZGF5c19iZWZvcmVfbW9udGgoeWVhciwgbW9udGgpOgogICAgInllYXIsIG1vbnRoIC0+IG51bWJlciBvZiBkYXlzIGluIHllYXIgcHJlY2VlZGluZyBmaXJzdCBkYXkgb2YgbW9udGguIgogICAgYXNzZXJ0IDEgPD0gbW9udGggPD0gMTIsICdtb250aCBtdXN0IGJlIGluIDEuLjEyJwogICAgcmV0dXJuIF9EQVlTX0JFRk9SRV9NT05USFttb250aF0gKyAobW9udGggPiAyIGFuZCBfaXNfbGVhcCh5ZWFyKSkKCmRlZiBfeW1kMm9yZCh5ZWFyLCBtb250aCwgZGF5KToKICAgICJ5ZWFyLCBtb250aCwgZGF5IC0+IG9yZGluYWwsIGNvbnNpZGVyaW5nIDAxLUphbi0wMDAxIGFzIGRheSAxLiIKICAgIGFzc2VydCAxIDw9IG1vbnRoIDw9IDEyLCAnbW9udGggbXVzdCBiZSBpbiAxLi4xMicKICAgIGRpbSA9IF9kYXlzX2luX21vbnRoKHllYXIsIG1vbnRoKQogICAgYXNzZXJ0IDEgPD0gZGF5IDw9IGRpbSwgKCdkYXkgbXVzdCBiZSBpbiAxLi4lZCcgJSBkaW0pCiAgICByZXR1cm4gKF9kYXlzX2JlZm9yZV95ZWFyKHllYXIpICsKICAgICAgICAgICAgX2RheXNfYmVmb3JlX21vbnRoKHllYXIsIG1vbnRoKSArCiAgICAgICAgICAgIGRheSkKCl9ESTQwMFkgPSBfZGF5c19iZWZvcmVfeWVhcig0MDEpICAgICMgbnVtYmVyIG9mIGRheXMgaW4gNDAwIHllYXJzCl9ESTEwMFkgPSBfZGF5c19iZWZvcmVfeWVhcigxMDEpICAgICMgICAgIiAgICAiICAgIiAgICIgMTAwICAgIgpfREk0WSAgID0gX2RheXNfYmVmb3JlX3llYXIoNSkgICAgICAjICAgICIgICAgIiAgICIgICAiICAgNCAgICIKCiMgQSA0LXllYXIgY3ljbGUgaGFzIGFuIGV4dHJhIGxlYXAgZGF5IG92ZXIgd2hhdCB3ZSdkIGdldCBmcm9tIHBhc3RpbmcKIyB0b2dldGhlciA0IHNpbmdsZSB5ZWFycy4KYXNzZXJ0IF9ESTRZID09IDQgKiAzNjUgKyAxCgojIFNpbWlsYXJseSwgYSA0MDAteWVhciBjeWNsZSBoYXMgYW4gZXh0cmEgbGVhcCBkYXkgb3ZlciB3aGF0IHdlJ2QgZ2V0IGZyb20KIyBwYXN0aW5nIHRvZ2V0aGVyIDQgMTAwLXllYXIgY3ljbGVzLgphc3NlcnQgX0RJNDAwWSA9PSA0ICogX0RJMTAwWSArIDEKCiMgT1RPSCwgYSAxMDAteWVhciBjeWNsZSBoYXMgb25lIGZld2VyIGxlYXAgZGF5IHRoYW4gd2UnZCBnZXQgZnJvbQojIHBhc3RpbmcgdG9nZXRoZXIgMjUgNC15ZWFyIGN5Y2xlcy4KYXNzZXJ0IF9ESTEwMFkgPT0gMjUgKiBfREk0WSAtIDEKCmRlZiBfb3JkMnltZChuKToKICAgICJvcmRpbmFsIC0+ICh5ZWFyLCBtb250aCwgZGF5KSwgY29uc2lkZXJpbmcgMDEtSmFuLTAwMDEgYXMgZGF5IDEuIgoKICAgICMgbiBpcyBhIDEtYmFzZWQgaW5kZXgsIHN0YXJ0aW5nIGF0IDEtSmFuLTEuICBUaGUgcGF0dGVybiBvZiBsZWFwIHllYXJzCiAgICAjIHJlcGVhdHMgZXhhY3RseSBldmVyeSA0MDAgeWVhcnMuICBUaGUgYmFzaWMgc3RyYXRlZ3kgaXMgdG8gZmluZCB0aGUKICAgICMgY2xvc2VzdCA0MDAteWVhciBib3VuZGFyeSBhdCBvciBiZWZvcmUgbiwgdGhlbiB3b3JrIHdpdGggdGhlIG9mZnNldAogICAgIyBmcm9tIHRoYXQgYm91bmRhcnkgdG8gbi4gIExpZmUgaXMgbXVjaCBjbGVhcmVyIGlmIHdlIHN1YnRyYWN0IDEgZnJvbQogICAgIyBuIGZpcnN0IC0tIHRoZW4gdGhlIHZhbHVlcyBvZiBuIGF0IDQwMC15ZWFyIGJvdW5kYXJpZXMgYXJlIGV4YWN0bHkKICAgICMgdGhvc2UgZGl2aXNpYmxlIGJ5IF9ESTQwMFk6CiAgICAjCiAgICAjICAgICBEICBNICAgWSAgICAgICAgICAgIG4gICAgICAgICAgICAgIG4tMQogICAgIyAgICAgLS0gLS0tIC0tLS0gICAgICAgIC0tLS0tLS0tLS0gICAgIC0tLS0tLS0tLS0tLS0tLS0KICAgICMgICAgIDMxIERlYyAtNDAwICAgICAgICAtX0RJNDAwWSAgICAgICAtX0RJNDAwWSAtMQogICAgIyAgICAgIDEgSmFuIC0zOTkgICAgICAgICAtX0RJNDAwWSArMSAgIC1fREk0MDBZICAgICAgNDAwLXllYXIgYm91bmRhcnkKICAgICMgICAgIC4uLgogICAgIyAgICAgMzAgRGVjICAwMDAgICAgICAgIC0xICAgICAgICAgICAgIC0yCiAgICAjICAgICAzMSBEZWMgIDAwMCAgICAgICAgIDAgICAgICAgICAgICAgLTEKICAgICMgICAgICAxIEphbiAgMDAxICAgICAgICAgMSAgICAgICAgICAgICAgMCAgICAgICAgICAgIDQwMC15ZWFyIGJvdW5kYXJ5CiAgICAjICAgICAgMiBKYW4gIDAwMSAgICAgICAgIDIgICAgICAgICAgICAgIDEKICAgICMgICAgICAzIEphbiAgMDAxICAgICAgICAgMyAgICAgICAgICAgICAgMgogICAgIyAgICAgLi4uCiAgICAjICAgICAzMSBEZWMgIDQwMCAgICAgICAgIF9ESTQwMFkgICAgICAgIF9ESTQwMFkgLTEKICAgICMgICAgICAxIEphbiAgNDAxICAgICAgICAgX0RJNDAwWSArMSAgICAgX0RJNDAwWSAgICAgIDQwMC15ZWFyIGJvdW5kYXJ5CiAgICBuIC09IDEKICAgIG40MDAsIG4gPSBkaXZtb2QobiwgX0RJNDAwWSkKICAgIHllYXIgPSBuNDAwICogNDAwICsgMSAgICMgLi4uLCAtMzk5LCAxLCA0MDEsIC4uLgoKICAgICMgTm93IG4gaXMgdGhlIChub24tbmVnYXRpdmUpIG9mZnNldCwgaW4gZGF5cywgZnJvbSBKYW51YXJ5IDEgb2YgeWVhciwgdG8KICAgICMgdGhlIGRlc2lyZWQgZGF0ZS4gIE5vdyBjb21wdXRlIGhvdyBtYW55IDEwMC15ZWFyIGN5Y2xlcyBwcmVjZWRlIG4uCiAgICAjIE5vdGUgdGhhdCBpdCdzIHBvc3NpYmxlIGZvciBuMTAwIHRvIGVxdWFsIDQhICBJbiB0aGF0IGNhc2UgNCBmdWxsCiAgICAjIDEwMC15ZWFyIGN5Y2xlcyBwcmVjZWRlIHRoZSBkZXNpcmVkIGRheSwgd2hpY2ggaW1wbGllcyB0aGUgZGVzaXJlZAogICAgIyBkYXkgaXMgRGVjZW1iZXIgMzEgYXQgdGhlIGVuZCBvZiBhIDQwMC15ZWFyIGN5Y2xlLgogICAgbjEwMCwgbiA9IGRpdm1vZChuLCBfREkxMDBZKQoKICAgICMgTm93IGNvbXB1dGUgaG93IG1hbnkgNC15ZWFyIGN5Y2xlcyBwcmVjZWRlIGl0LgogICAgbjQsIG4gPSBkaXZtb2QobiwgX0RJNFkpCgogICAgIyBBbmQgbm93IGhvdyBtYW55IHNpbmdsZSB5ZWFycy4gIEFnYWluIG4xIGNhbiBiZSA0LCBhbmQgYWdhaW4gbWVhbmluZwogICAgIyB0aGF0IHRoZSBkZXNpcmVkIGRheSBpcyBEZWNlbWJlciAzMSBhdCB0aGUgZW5kIG9mIHRoZSA0LXllYXIgY3ljbGUuCiAgICBuMSwgbiA9IGRpdm1vZChuLCAzNjUpCgogICAgeWVhciArPSBuMTAwICogMTAwICsgbjQgKiA0ICsgbjEKICAgIGlmIG4xID09IDQgb3IgbjEwMCA9PSA0OgogICAgICAgIGFzc2VydCBuID09IDAKICAgICAgICByZXR1cm4geWVhci0xLCAxMiwgMzEKCiAgICAjIE5vdyB0aGUgeWVhciBpcyBjb3JyZWN0LCBhbmQgbiBpcyB0aGUgb2Zmc2V0IGZyb20gSmFudWFyeSAxLiAgV2UgZmluZAogICAgIyB0aGUgbW9udGggdmlhIGFuIGVzdGltYXRlIHRoYXQncyBlaXRoZXIgZXhhY3Qgb3Igb25lIHRvbyBsYXJnZS4KICAgIGxlYXB5ZWFyID0gbjEgPT0gMyBhbmQgKG40ICE9IDI0IG9yIG4xMDAgPT0gMykKICAgIGFzc2VydCBsZWFweWVhciA9PSBfaXNfbGVhcCh5ZWFyKQogICAgbW9udGggPSAobiArIDUwKSA+PiA1CiAgICBwcmVjZWRpbmcgPSBfREFZU19CRUZPUkVfTU9OVEhbbW9udGhdICsgKG1vbnRoID4gMiBhbmQgbGVhcHllYXIpCiAgICBpZiBwcmVjZWRpbmcgPiBuOiAgIyBlc3RpbWF0ZSBpcyB0b28gbGFyZ2UKICAgICAgICBtb250aCAtPSAxCiAgICAgICAgcHJlY2VkaW5nIC09IF9EQVlTX0lOX01PTlRIW21vbnRoXSArIChtb250aCA9PSAyIGFuZCBsZWFweWVhcikKICAgIG4gLT0gcHJlY2VkaW5nCiAgICBhc3NlcnQgMCA8PSBuIDwgX2RheXNfaW5fbW9udGgoeWVhciwgbW9udGgpCgogICAgIyBOb3cgdGhlIHllYXIgYW5kIG1vbnRoIGFyZSBjb3JyZWN0LCBhbmQgbiBpcyB0aGUgb2Zmc2V0IGZyb20gdGhlCiAgICAjIHN0YXJ0IG9mIHRoYXQgbW9udGg6ICB3ZSdyZSBkb25lIQogICAgcmV0dXJuIHllYXIsIG1vbnRoLCBuKzEKCiMgTW9udGggYW5kIGRheSBuYW1lcy4gIEZvciBsb2NhbGl6ZWQgdmVyc2lvbnMsIHNlZSB0aGUgY2FsZW5kYXIgbW9kdWxlLgpfTU9OVEhOQU1FUyA9IFtOb25lLCAiSmFuIiwgIkZlYiIsICJNYXIiLCAiQXByIiwgIk1heSIsICJKdW4iLAogICAgICAgICAgICAgICAgICAgICAiSnVsIiwgIkF1ZyIsICJTZXAiLCAiT2N0IiwgIk5vdiIsICJEZWMiXQpfREFZTkFNRVMgPSBbTm9uZSwgIk1vbiIsICJUdWUiLCAiV2VkIiwgIlRodSIsICJGcmkiLCAiU2F0IiwgIlN1biJdCgoKZGVmIF9idWlsZF9zdHJ1Y3RfdGltZSh5LCBtLCBkLCBoaCwgbW0sIHNzLCBkc3RmbGFnKToKICAgIHdkYXkgPSAoX3ltZDJvcmQoeSwgbSwgZCkgKyA2KSAlIDcKICAgIGRudW0gPSBfZGF5c19iZWZvcmVfbW9udGgoeSwgbSkgKyBkCiAgICByZXR1cm4gX3RpbWUuc3RydWN0X3RpbWUoKHksIG0sIGQsIGhoLCBtbSwgc3MsIHdkYXksIGRudW0sIGRzdGZsYWcpKQoKZGVmIF9mb3JtYXRfdGltZShoaCwgbW0sIHNzLCB1cyk6CiAgICAjIFNraXAgdHJhaWxpbmcgbWljcm9zZWNvbmRzIHdoZW4gdXM9PTAuCiAgICByZXN1bHQgPSAiJTAyZDolMDJkOiUwMmQiICUgKGhoLCBtbSwgc3MpCiAgICBpZiB1czoKICAgICAgICByZXN1bHQgKz0gIi4lMDZkIiAlIHVzCiAgICByZXR1cm4gcmVzdWx0CgojIENvcnJlY3RseSBzdWJzdGl0dXRlIGZvciAleiBhbmQgJVogZXNjYXBlcyBpbiBzdHJmdGltZSBmb3JtYXRzLgpkZWYgX3dyYXBfc3RyZnRpbWUob2JqZWN0LCBmb3JtYXQsIHRpbWV0dXBsZSk6CiAgICB5ZWFyID0gdGltZXR1cGxlWzBdCiAgICBpZiB5ZWFyIDwgMTAwMDoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJ5ZWFyPSVkIGlzIGJlZm9yZSAxMDAwOyB0aGUgZGF0ZXRpbWUgc3RyZnRpbWUoKSAiCiAgICAgICAgICAgICAgICAgICAgICAgICAibWV0aG9kcyByZXF1aXJlIHllYXIgPj0gMTAwMCIgJSB5ZWFyKQogICAgIyBEb24ndCBjYWxsIHV0Y29mZnNldCgpIG9yIHR6bmFtZSgpIHVubGVzcyBhY3R1YWxseSBuZWVkZWQuCiAgICBmcmVwbGFjZSA9IE5vbmUgIyB0aGUgc3RyaW5nIHRvIHVzZSBmb3IgJWYKICAgIHpyZXBsYWNlID0gTm9uZSAjIHRoZSBzdHJpbmcgdG8gdXNlIGZvciAlegogICAgWnJlcGxhY2UgPSBOb25lICMgdGhlIHN0cmluZyB0byB1c2UgZm9yICVaCgogICAgIyBTY2FuIGZvcm1hdCBmb3IgJXogYW5kICVaIGVzY2FwZXMsIHJlcGxhY2luZyBhcyBuZWVkZWQuCiAgICBuZXdmb3JtYXQgPSBbXQogICAgcHVzaCA9IG5ld2Zvcm1hdC5hcHBlbmQKICAgIGksIG4gPSAwLCBsZW4oZm9ybWF0KQogICAgd2hpbGUgaSA8IG46CiAgICAgICAgY2ggPSBmb3JtYXRbaV0KICAgICAgICBpICs9IDEKICAgICAgICBpZiBjaCA9PSAnJSc6CiAgICAgICAgICAgIGlmIGkgPCBuOgogICAgICAgICAgICAgICAgY2ggPSBmb3JtYXRbaV0KICAgICAgICAgICAgICAgIGkgKz0gMQogICAgICAgICAgICAgICAgaWYgY2ggPT0gJ2YnOgogICAgICAgICAgICAgICAgICAgIGlmIGZyZXBsYWNlIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIGZyZXBsYWNlID0gJyUwNmQnICUgZ2V0YXR0cihvYmplY3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbWljcm9zZWNvbmQnLCAwKQogICAgICAgICAgICAgICAgICAgIG5ld2Zvcm1hdC5hcHBlbmQoZnJlcGxhY2UpCiAgICAgICAgICAgICAgICBlbGlmIGNoID09ICd6JzoKICAgICAgICAgICAgICAgICAgICBpZiB6cmVwbGFjZSBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICB6cmVwbGFjZSA9ICIiCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGhhc2F0dHIob2JqZWN0LCAidXRjb2Zmc2V0Iik6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBvYmplY3QudXRjb2Zmc2V0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9mZnNldCBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWduID0gJysnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgb2Zmc2V0LmRheXMgPCAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSAtb2Zmc2V0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZ24gPSAnLScKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLCBtID0gZGl2bW9kKG9mZnNldCwgdGltZWRlbHRhKGhvdXJzPTEpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydCBub3QgbSAlIHRpbWVkZWx0YShtaW51dGVzPTEpLCAid2hvbGUgbWludXRlIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0gLy89IHRpbWVkZWx0YShtaW51dGVzPTEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgenJlcGxhY2UgPSAnJWMlMDJkJTAyZCcgJSAoc2lnbiwgaCwgbSkKICAgICAgICAgICAgICAgICAgICBhc3NlcnQgJyUnIG5vdCBpbiB6cmVwbGFjZQogICAgICAgICAgICAgICAgICAgIG5ld2Zvcm1hdC5hcHBlbmQoenJlcGxhY2UpCiAgICAgICAgICAgICAgICBlbGlmIGNoID09ICdaJzoKICAgICAgICAgICAgICAgICAgICBpZiBacmVwbGFjZSBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICBacmVwbGFjZSA9ICIiCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGhhc2F0dHIob2JqZWN0LCAidHpuYW1lIik6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzID0gb2JqZWN0LnR6bmFtZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBzIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgc3RyZnRpbWUgaXMgZ29pbmcgdG8gaGF2ZSBhdCB0aGlzOiBlc2NhcGUgJQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFpyZXBsYWNlID0gcy5yZXBsYWNlKCclJywgJyUlJykKICAgICAgICAgICAgICAgICAgICBuZXdmb3JtYXQuYXBwZW5kKFpyZXBsYWNlKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBwdXNoKCclJykKICAgICAgICAgICAgICAgICAgICBwdXNoKGNoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHVzaCgnJScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHVzaChjaCkKICAgIG5ld2Zvcm1hdCA9ICIiLmpvaW4obmV3Zm9ybWF0KQogICAgcmV0dXJuIF90aW1lLnN0cmZ0aW1lKG5ld2Zvcm1hdCwgdGltZXR1cGxlKQoKZGVmIF9jYWxsX3R6aW5mb19tZXRob2QodHppbmZvLCBtZXRobmFtZSwgdHppbmZvYXJnKToKICAgIGlmIHR6aW5mbyBpcyBOb25lOgogICAgICAgIHJldHVybiBOb25lCiAgICByZXR1cm4gZ2V0YXR0cih0emluZm8sIG1ldGhuYW1lKSh0emluZm9hcmcpCgojIEp1c3QgcmFpc2UgVHlwZUVycm9yIGlmIHRoZSBhcmcgaXNuJ3QgTm9uZSBvciBhIHN0cmluZy4KZGVmIF9jaGVja190em5hbWUobmFtZSk6CiAgICBpZiBuYW1lIGlzIG5vdCBOb25lIGFuZCBub3QgaXNpbnN0YW5jZShuYW1lLCBzdHIpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigidHppbmZvLnR6bmFtZSgpIG11c3QgcmV0dXJuIE5vbmUgb3Igc3RyaW5nLCAiCiAgICAgICAgICAgICAgICAgICAgICAgICJub3QgJyVzJyIgJSB0eXBlKG5hbWUpKQoKIyBuYW1lIGlzIHRoZSBvZmZzZXQtcHJvZHVjaW5nIG1ldGhvZCwgInV0Y29mZnNldCIgb3IgImRzdCIuCiMgb2Zmc2V0IGlzIHdoYXQgaXQgcmV0dXJuZWQuCiMgSWYgb2Zmc2V0IGlzbid0IE5vbmUgb3IgdGltZWRlbHRhLCByYWlzZXMgVHlwZUVycm9yLgojIElmIG9mZnNldCBpcyBOb25lLCByZXR1cm5zIE5vbmUuCiMgRWxzZSBvZmZzZXQgaXMgY2hlY2tlZCBmb3IgYmVpbmcgaW4gcmFuZ2UsIGFuZCBhIHdob2xlICMgb2YgbWludXRlcy4KIyBJZiBpdCBpcywgaXRzIGludGVnZXIgdmFsdWUgaXMgcmV0dXJuZWQuICBFbHNlIFZhbHVlRXJyb3IgaXMgcmFpc2VkLgpkZWYgX2NoZWNrX3V0Y19vZmZzZXQobmFtZSwgb2Zmc2V0KToKICAgIGFzc2VydCBuYW1lIGluICgidXRjb2Zmc2V0IiwgImRzdCIpCiAgICBpZiBvZmZzZXQgaXMgTm9uZToKICAgICAgICByZXR1cm4KICAgIGlmIG5vdCBpc2luc3RhbmNlKG9mZnNldCwgdGltZWRlbHRhKToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoInR6aW5mby4lcygpIG11c3QgcmV0dXJuIE5vbmUgIgogICAgICAgICAgICAgICAgICAgICAgICAib3IgdGltZWRlbHRhLCBub3QgJyVzJyIgJSAobmFtZSwgdHlwZShvZmZzZXQpKSkKICAgIGlmIG9mZnNldCAlIHRpbWVkZWx0YShtaW51dGVzPTEpIG9yIG9mZnNldC5taWNyb3NlY29uZHM6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigidHppbmZvLiVzKCkgbXVzdCByZXR1cm4gYSB3aG9sZSBudW1iZXIgIgogICAgICAgICAgICAgICAgICAgICAgICAgIm9mIG1pbnV0ZXMsIGdvdCAlcyIgJSAobmFtZSwgb2Zmc2V0KSkKICAgIGlmIG5vdCAtdGltZWRlbHRhKDEpIDwgb2Zmc2V0IDwgdGltZWRlbHRhKDEpOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIiVzKCk9JXMsIG11c3QgYmUgbXVzdCBiZSBzdHJpY3RseSBiZXR3ZWVuIgogICAgICAgICAgICAgICAgICAgICAgICAgIiAtdGltZWRlbHRhKGhvdXJzPTI0KSBhbmQgdGltZWRlbHRhKGhvdXJzPTI0KSIKICAgICAgICAgICAgICAgICAgICAgICAgICUgKG5hbWUsIG9mZnNldCkpCgpkZWYgX2NoZWNrX2RhdGVfZmllbGRzKHllYXIsIG1vbnRoLCBkYXkpOgogICAgaWYgbm90IGlzaW5zdGFuY2UoeWVhciwgaW50KToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ2ludCBleHBlY3RlZCcpCiAgICBpZiBub3QgTUlOWUVBUiA8PSB5ZWFyIDw9IE1BWFlFQVI6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigneWVhciBtdXN0IGJlIGluICVkLi4lZCcgJSAoTUlOWUVBUiwgTUFYWUVBUiksIHllYXIpCiAgICBpZiBub3QgMSA8PSBtb250aCA8PSAxMjoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdtb250aCBtdXN0IGJlIGluIDEuLjEyJywgbW9udGgpCiAgICBkaW0gPSBfZGF5c19pbl9tb250aCh5ZWFyLCBtb250aCkKICAgIGlmIG5vdCAxIDw9IGRheSA8PSBkaW06CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignZGF5IG11c3QgYmUgaW4gMS4uJWQnICUgZGltLCBkYXkpCgpkZWYgX2NoZWNrX3RpbWVfZmllbGRzKGhvdXIsIG1pbnV0ZSwgc2Vjb25kLCBtaWNyb3NlY29uZCk6CiAgICBpZiBub3QgaXNpbnN0YW5jZShob3VyLCBpbnQpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcignaW50IGV4cGVjdGVkJykKICAgIGlmIG5vdCAwIDw9IGhvdXIgPD0gMjM6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignaG91ciBtdXN0IGJlIGluIDAuLjIzJywgaG91cikKICAgIGlmIG5vdCAwIDw9IG1pbnV0ZSA8PSA1OToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdtaW51dGUgbXVzdCBiZSBpbiAwLi41OScsIG1pbnV0ZSkKICAgIGlmIG5vdCAwIDw9IHNlY29uZCA8PSA1OToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdzZWNvbmQgbXVzdCBiZSBpbiAwLi41OScsIHNlY29uZCkKICAgIGlmIG5vdCAwIDw9IG1pY3Jvc2Vjb25kIDw9IDk5OTk5OToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdtaWNyb3NlY29uZCBtdXN0IGJlIGluIDAuLjk5OTk5OScsIG1pY3Jvc2Vjb25kKQoKZGVmIF9jaGVja190emluZm9fYXJnKHR6KToKICAgIGlmIHR6IGlzIG5vdCBOb25lIGFuZCBub3QgaXNpbnN0YW5jZSh0eiwgdHppbmZvKToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoInR6aW5mbyBhcmd1bWVudCBtdXN0IGJlIE5vbmUgb3Igb2YgYSB0emluZm8gc3ViY2xhc3MiKQoKZGVmIF9jbXBlcnJvcih4LCB5KToKICAgIHJhaXNlIFR5cGVFcnJvcigiY2FuJ3QgY29tcGFyZSAnJXMnIHRvICclcyciICUgKAogICAgICAgICAgICAgICAgICAgIHR5cGUoeCkuX19uYW1lX18sIHR5cGUoeSkuX19uYW1lX18pKQoKY2xhc3MgdGltZWRlbHRhOgogICAgIiIiUmVwcmVzZW50IHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdHdvIGRhdGV0aW1lIG9iamVjdHMuCgogICAgU3VwcG9ydGVkIG9wZXJhdG9yczoKCiAgICAtIGFkZCwgc3VidHJhY3QgdGltZWRlbHRhCiAgICAtIHVuYXJ5IHBsdXMsIG1pbnVzLCBhYnMKICAgIC0gY29tcGFyZSB0byB0aW1lZGVsdGEKICAgIC0gbXVsdGlwbHksIGRpdmlkZSBieSBpbnQvbG9uZwoKICAgIEluIGFkZGl0aW9uLCBkYXRldGltZSBzdXBwb3J0cyBzdWJ0cmFjdGlvbiBvZiB0d28gZGF0ZXRpbWUgb2JqZWN0cwogICAgcmV0dXJuaW5nIGEgdGltZWRlbHRhLCBhbmQgYWRkaXRpb24gb3Igc3VidHJhY3Rpb24gb2YgYSBkYXRldGltZQogICAgYW5kIGEgdGltZWRlbHRhIGdpdmluZyBhIGRhdGV0aW1lLgoKICAgIFJlcHJlc2VudGF0aW9uOiAoZGF5cywgc2Vjb25kcywgbWljcm9zZWNvbmRzKS4gIFdoeT8gIEJlY2F1c2UgSQogICAgZmVsdCBsaWtlIGl0LgogICAgIiIiCiAgICBfX3Nsb3RzX18gPSAnX2RheXMnLCAnX3NlY29uZHMnLCAnX21pY3Jvc2Vjb25kcycKCiAgICBkZWYgX19uZXdfXyhjbHMsIGRheXM9MCwgc2Vjb25kcz0wLCBtaWNyb3NlY29uZHM9MCwKICAgICAgICAgICAgICAgIG1pbGxpc2Vjb25kcz0wLCBtaW51dGVzPTAsIGhvdXJzPTAsIHdlZWtzPTApOgogICAgICAgICMgRG9pbmcgdGhpcyBlZmZpY2llbnRseSBhbmQgYWNjdXJhdGVseSBpbiBDIGlzIGdvaW5nIHRvIGJlIGRpZmZpY3VsdAogICAgICAgICMgYW5kIGVycm9yLXByb25lLCBkdWUgdG8gdWJpcXVpdG91cyBvdmVyZmxvdyBwb3NzaWJpbGl0aWVzLCBhbmQgdGhhdAogICAgICAgICMgQyBkb3VibGUgZG9lc24ndCBoYXZlIGVub3VnaCBiaXRzIG9mIHByZWNpc2lvbiB0byByZXByZXNlbnQKICAgICAgICAjIG1pY3Jvc2Vjb25kcyBvdmVyIDEwSyB5ZWFycyBmYWl0aGZ1bGx5LiAgVGhlIGNvZGUgaGVyZSB0cmllcyB0byBtYWtlCiAgICAgICAgIyBleHBsaWNpdCB3aGVyZSBnby1mYXN0IGFzc3VtcHRpb25zIGNhbiBiZSByZWxpZWQgb24sIGluIG9yZGVyIHRvCiAgICAgICAgIyBndWlkZSB0aGUgQyBpbXBsZW1lbnRhdGlvbjsgaXQncyB3YXkgbW9yZSBjb252b2x1dGVkIHRoYW4gc3BlZWQtCiAgICAgICAgIyBpZ25vcmluZyBhdXRvLW92ZXJmbG93LXRvLWxvbmcgaWRpb21hdGljIFB5dGhvbiBjb3VsZCBiZS4KCiAgICAgICAgIyBYWFggQ2hlY2sgdGhhdCBhbGwgaW5wdXRzIGFyZSBpbnRzIG9yIGZsb2F0cy4KCiAgICAgICAgIyBGaW5hbCB2YWx1ZXMsIGFsbCBpbnRlZ2VyLgogICAgICAgICMgcyBhbmQgdXMgZml0IGluIDMyLWJpdCBzaWduZWQgaW50czsgZCBpc24ndCBib3VuZGVkLgogICAgICAgIGQgPSBzID0gdXMgPSAwCgogICAgICAgICMgTm9ybWFsaXplIGV2ZXJ5dGhpbmcgdG8gZGF5cywgc2Vjb25kcywgbWljcm9zZWNvbmRzLgogICAgICAgIGRheXMgKz0gd2Vla3MqNwogICAgICAgIHNlY29uZHMgKz0gbWludXRlcyo2MCArIGhvdXJzKjM2MDAKICAgICAgICBtaWNyb3NlY29uZHMgKz0gbWlsbGlzZWNvbmRzKjEwMDAKCiAgICAgICAgIyBHZXQgcmlkIG9mIGFsbCBmcmFjdGlvbnMsIGFuZCBub3JtYWxpemUgcyBhbmQgdXMuCiAgICAgICAgIyBUYWtlIGEgZGVlcCBicmVhdGggPHdpbms+LgogICAgICAgIGlmIGlzaW5zdGFuY2UoZGF5cywgZmxvYXQpOgogICAgICAgICAgICBkYXlmcmFjLCBkYXlzID0gX21hdGgubW9kZihkYXlzKQogICAgICAgICAgICBkYXlzZWNvbmRzZnJhYywgZGF5c2Vjb25kc3dob2xlID0gX21hdGgubW9kZihkYXlmcmFjICogKDI0LiozNjAwLikpCiAgICAgICAgICAgIGFzc2VydCBkYXlzZWNvbmRzd2hvbGUgPT0gaW50KGRheXNlY29uZHN3aG9sZSkgICMgY2FuJ3Qgb3ZlcmZsb3cKICAgICAgICAgICAgcyA9IGludChkYXlzZWNvbmRzd2hvbGUpCiAgICAgICAgICAgIGFzc2VydCBkYXlzID09IGludChkYXlzKQogICAgICAgICAgICBkID0gaW50KGRheXMpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZGF5c2Vjb25kc2ZyYWMgPSAwLjAKICAgICAgICAgICAgZCA9IGRheXMKICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShkYXlzZWNvbmRzZnJhYywgZmxvYXQpCiAgICAgICAgYXNzZXJ0IGFicyhkYXlzZWNvbmRzZnJhYykgPD0gMS4wCiAgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2UoZCwgaW50KQogICAgICAgIGFzc2VydCBhYnMocykgPD0gMjQgKiAzNjAwCiAgICAgICAgIyBkYXlzIGlzbid0IHJlZmVyZW5jZWQgYWdhaW4gYmVmb3JlIHJlZGVmaW5pdGlvbgoKICAgICAgICBpZiBpc2luc3RhbmNlKHNlY29uZHMsIGZsb2F0KToKICAgICAgICAgICAgc2Vjb25kc2ZyYWMsIHNlY29uZHMgPSBfbWF0aC5tb2RmKHNlY29uZHMpCiAgICAgICAgICAgIGFzc2VydCBzZWNvbmRzID09IGludChzZWNvbmRzKQogICAgICAgICAgICBzZWNvbmRzID0gaW50KHNlY29uZHMpCiAgICAgICAgICAgIHNlY29uZHNmcmFjICs9IGRheXNlY29uZHNmcmFjCiAgICAgICAgICAgIGFzc2VydCBhYnMoc2Vjb25kc2ZyYWMpIDw9IDIuMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlY29uZHNmcmFjID0gZGF5c2Vjb25kc2ZyYWMKICAgICAgICAjIGRheXNlY29uZHNmcmFjIGlzbid0IHJlZmVyZW5jZWQgYWdhaW4KICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShzZWNvbmRzZnJhYywgZmxvYXQpCiAgICAgICAgYXNzZXJ0IGFicyhzZWNvbmRzZnJhYykgPD0gMi4wCgogICAgICAgIGFzc2VydCBpc2luc3RhbmNlKHNlY29uZHMsIGludCkKICAgICAgICBkYXlzLCBzZWNvbmRzID0gZGl2bW9kKHNlY29uZHMsIDI0KjM2MDApCiAgICAgICAgZCArPSBkYXlzCiAgICAgICAgcyArPSBpbnQoc2Vjb25kcykgICAgIyBjYW4ndCBvdmVyZmxvdwogICAgICAgIGFzc2VydCBpc2luc3RhbmNlKHMsIGludCkKICAgICAgICBhc3NlcnQgYWJzKHMpIDw9IDIgKiAyNCAqIDM2MDAKICAgICAgICAjIHNlY29uZHMgaXNuJ3QgcmVmZXJlbmNlZCBhZ2FpbiBiZWZvcmUgcmVkZWZpbml0aW9uCgogICAgICAgIHVzZG91YmxlID0gc2Vjb25kc2ZyYWMgKiAxZTYKICAgICAgICBhc3NlcnQgYWJzKHVzZG91YmxlKSA8IDIuMWU2ICAgICMgZXhhY3QgdmFsdWUgbm90IGNyaXRpY2FsCiAgICAgICAgIyBzZWNvbmRzZnJhYyBpc24ndCByZWZlcmVuY2VkIGFnYWluCiAgICAgICAgCiAgICAgICAgaWYgaXNpbnN0YW5jZShtaWNyb3NlY29uZHMsIGZsb2F0KToKICAgICAgICAgICAgbWljcm9zZWNvbmRzICs9IHVzZG91YmxlCiAgICAgICAgICAgIG1pY3Jvc2Vjb25kcyA9IHJvdW5kKG1pY3Jvc2Vjb25kcywgMCkKICAgICAgICAgICAgc2Vjb25kcywgbWljcm9zZWNvbmRzID0gZGl2bW9kKG1pY3Jvc2Vjb25kcywgMWU2KQogICAgICAgICAgICBhc3NlcnQgbWljcm9zZWNvbmRzID09IGludChtaWNyb3NlY29uZHMpCiAgICAgICAgICAgIGFzc2VydCBzZWNvbmRzID09IGludChzZWNvbmRzKQogICAgICAgICAgICBkYXlzLCBzZWNvbmRzID0gZGl2bW9kKHNlY29uZHMsIDI0LiozNjAwLikKICAgICAgICAgICAgYXNzZXJ0IGRheXMgPT0gaW50KGRheXMpCiAgICAgICAgICAgIGFzc2VydCBzZWNvbmRzID09IGludChzZWNvbmRzKQogICAgICAgICAgICBkICs9IGludChkYXlzKQogICAgICAgICAgICBzICs9IGludChzZWNvbmRzKSAgICMgY2FuJ3Qgb3ZlcmZsb3cKICAgICAgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2UocywgaW50KQogICAgICAgICAgICBhc3NlcnQgYWJzKHMpIDw9IDMgKiAyNCAqIDM2MDAKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWNvbmRzLCBtaWNyb3NlY29uZHMgPSBkaXZtb2QobWljcm9zZWNvbmRzLCAxMDAwMDAwKQogICAgICAgICAgICBkYXlzLCBzZWNvbmRzID0gZGl2bW9kKHNlY29uZHMsIDI0KjM2MDApCiAgICAgICAgICAgIGQgKz0gZGF5cwogICAgICAgICAgICBzICs9IGludChzZWNvbmRzKSAgICAjIGNhbid0IG92ZXJmbG93CiAgICAgICAgICAgIGFzc2VydCBpc2luc3RhbmNlKHMsIGludCkKICAgICAgICAgICAgYXNzZXJ0IGFicyhzKSA8PSAzICogMjQgKiAzNjAwCiAgICAgICAgICAgIG1pY3Jvc2Vjb25kcyA9IGZsb2F0KG1pY3Jvc2Vjb25kcykKICAgICAgICAgICAgbWljcm9zZWNvbmRzICs9IHVzZG91YmxlCiAgICAgICAgICAgIG1pY3Jvc2Vjb25kcyA9IHJvdW5kKG1pY3Jvc2Vjb25kcywgMCkKICAgICAgICBhc3NlcnQgYWJzKHMpIDw9IDMgKiAyNCAqIDM2MDAKICAgICAgICBhc3NlcnQgYWJzKG1pY3Jvc2Vjb25kcykgPCAzLjFlNgoKICAgICAgICAjIEp1c3QgYSBsaXR0bGUgYml0IG9mIGNhcnJ5aW5nIHBvc3NpYmxlIGZvciBtaWNyb3NlY29uZHMgYW5kIHNlY29uZHMuCiAgICAgICAgI2lzIHRoZSBiZWxvdyB0d28gc3RhdGVtZW50cyBldmVuIHBvc3NpYmxlPwogICAgICAgICNhc3NlcnQgaXNpbnN0YW5jZShtaWNyb3NlY29uZHMsIGZsb2F0KQogICAgICAgICNhc3NlcnQgaW50KG1pY3Jvc2Vjb25kcykgPT0gbWljcm9zZWNvbmRzCiAgICAgICAgdXMgPSBpbnQobWljcm9zZWNvbmRzKQogICAgICAgIHNlY29uZHMsIHVzID0gZGl2bW9kKHVzLCAxMDAwMDAwKQogICAgICAgIHMgKz0gc2Vjb25kcyAgICAjIGNhbnQndCBvdmVyZmxvdwogICAgICAgIGFzc2VydCBpc2luc3RhbmNlKHMsIGludCkKICAgICAgICBkYXlzLCBzID0gZGl2bW9kKHMsIDI0KjM2MDApCiAgICAgICAgZCArPSBkYXlzCgogICAgICAgIGFzc2VydCBpc2luc3RhbmNlKGQsIGludCkKICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShzLCBpbnQpIGFuZCAwIDw9IHMgPCAyNCozNjAwCiAgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2UodXMsIGludCkgYW5kIDAgPD0gdXMgPCAxMDAwMDAwCgogICAgICAgIHNlbGYgPSBvYmplY3QuX19uZXdfXyhjbHMpCgogICAgICAgIHNlbGYuX2RheXMgPSBkCiAgICAgICAgc2VsZi5fc2Vjb25kcyA9IHMKICAgICAgICBzZWxmLl9taWNyb3NlY29uZHMgPSB1cwoKICAgICAgICBpZiBhYnMoZCkgPiA5OTk5OTk5OTk6CiAgICAgICAgICAgIHJhaXNlIE92ZXJmbG93RXJyb3IoInRpbWVkZWx0YSAjIG9mIGRheXMgaXMgdG9vIGxhcmdlOiAlZCIgJSBkKQoKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICBpZiBzZWxmLl9taWNyb3NlY29uZHM6CiAgICAgICAgICAgIHJldHVybiAiJXMoJWQsICVkLCAlZCkiICUgKCdkYXRldGltZS4nICsgc2VsZi5fX2NsYXNzX18uX19uYW1lX18sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2RheXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlY29uZHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX21pY3Jvc2Vjb25kcykKICAgICAgICBpZiBzZWxmLl9zZWNvbmRzOgogICAgICAgICAgICByZXR1cm4gIiVzKCVkLCAlZCkiICUgKCdkYXRldGltZS4nICsgc2VsZi5fX2NsYXNzX18uX19uYW1lX18sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fZGF5cywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZWNvbmRzKQogICAgICAgIHJldHVybiAiJXMoJWQpIiAlICgnZGF0ZXRpbWUuJyArIHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLCBzZWxmLl9kYXlzKQoKICAgIGRlZiBfX3N0cl9fKHNlbGYpOgogICAgICAgIG1tLCBzcyA9IGRpdm1vZChzZWxmLl9zZWNvbmRzLCA2MCkKICAgICAgICBoaCwgbW0gPSBkaXZtb2QobW0sIDYwKQogICAgICAgIHMgPSAiJWQ6JTAyZDolMDJkIiAlIChoaCwgbW0sIHNzKQogICAgICAgIGlmIHNlbGYuX2RheXM6CiAgICAgICAgICAgIGRlZiBwbHVyYWwobik6CiAgICAgICAgICAgICAgICByZXR1cm4gbiwgYWJzKG4pICE9IDEgYW5kICJzIiBvciAiIgogICAgICAgICAgICBzID0gKCIlZCBkYXklcywgIiAlIHBsdXJhbChzZWxmLl9kYXlzKSkgKyBzCiAgICAgICAgaWYgc2VsZi5fbWljcm9zZWNvbmRzOgogICAgICAgICAgICBzID0gcyArICIuJTA2ZCIgJSBzZWxmLl9taWNyb3NlY29uZHMKICAgICAgICByZXR1cm4gcwoKICAgIGRlZiB0b3RhbF9zZWNvbmRzKHNlbGYpOgogICAgICAgICIiIlRvdGFsIHNlY29uZHMgaW4gdGhlIGR1cmF0aW9uLiIiIgogICAgICAgIHJldHVybiAoKHNlbGYuZGF5cyAqIDg2NDAwICsgc2VsZi5zZWNvbmRzKSoxMCoqNiArCiAgICAgICAgICAgICAgICBzZWxmLm1pY3Jvc2Vjb25kcykgLyAxMCoqNgoKICAgICMgUmVhZC1vbmx5IGZpZWxkIGFjY2Vzc29ycwogICAgQHByb3BlcnR5CiAgICBkZWYgZGF5cyhzZWxmKToKICAgICAgICAiIiJkYXlzIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX2RheXMKCiAgICBAcHJvcGVydHkKICAgIGRlZiBzZWNvbmRzKHNlbGYpOgogICAgICAgICIiInNlY29uZHMiIiIKICAgICAgICByZXR1cm4gc2VsZi5fc2Vjb25kcwoKICAgIEBwcm9wZXJ0eQogICAgZGVmIG1pY3Jvc2Vjb25kcyhzZWxmKToKICAgICAgICAiIiJtaWNyb3NlY29uZHMiIiIKICAgICAgICByZXR1cm4gc2VsZi5fbWljcm9zZWNvbmRzCgogICAgZGVmIF9fYWRkX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHRpbWVkZWx0YSk6CiAgICAgICAgICAgICMgZm9yIENQeXRob24gY29tcGF0aWJpbGl0eSwgd2UgY2Fubm90IHVzZQogICAgICAgICAgICAjIG91ciBfX2NsYXNzX18gaGVyZSwgYnV0IG5lZWQgYSByZWFsIHRpbWVkZWx0YQogICAgICAgICAgICByZXR1cm4gdGltZWRlbHRhKHNlbGYuX2RheXMgKyBvdGhlci5fZGF5cywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZWNvbmRzICsgb3RoZXIuX3NlY29uZHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fbWljcm9zZWNvbmRzICsgb3RoZXIuX21pY3Jvc2Vjb25kcykKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICBfX3JhZGRfXyA9IF9fYWRkX18KCiAgICBkZWYgX19zdWJfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgdGltZWRlbHRhKToKICAgICAgICAgICAgIyBmb3IgQ1B5dGhvbiBjb21wYXRpYmlsaXR5LCB3ZSBjYW5ub3QgdXNlCiAgICAgICAgICAgICMgb3VyIF9fY2xhc3NfXyBoZXJlLCBidXQgbmVlZCBhIHJlYWwgdGltZWRlbHRhCiAgICAgICAgICAgIHJldHVybiB0aW1lZGVsdGEoc2VsZi5fZGF5cyAtIG90aGVyLl9kYXlzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlY29uZHMgLSBvdGhlci5fc2Vjb25kcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9taWNyb3NlY29uZHMgLSBvdGhlci5fbWljcm9zZWNvbmRzKQogICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgIGRlZiBfX3JzdWJfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgdGltZWRlbHRhKToKICAgICAgICAgICAgcmV0dXJuIC1zZWxmICsgb3RoZXIKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICBkZWYgX19uZWdfXyhzZWxmKToKICAgICAgICAjIGZvciBDUHl0aG9uIGNvbXBhdGliaWxpdHksIHdlIGNhbm5vdCB1c2UKICAgICAgICAjIG91ciBfX2NsYXNzX18gaGVyZSwgYnV0IG5lZWQgYSByZWFsIHRpbWVkZWx0YQogICAgICAgIHJldHVybiB0aW1lZGVsdGEoLXNlbGYuX2RheXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAtc2VsZi5fc2Vjb25kcywKICAgICAgICAgICAgICAgICAgICAgICAgIC1zZWxmLl9taWNyb3NlY29uZHMpCgogICAgZGVmIF9fcG9zX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19hYnNfXyhzZWxmKToKICAgICAgICBpZiBzZWxmLl9kYXlzIDwgMDoKICAgICAgICAgICAgcmV0dXJuIC1zZWxmCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19tdWxfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgaW50KToKICAgICAgICAgICAgIyBmb3IgQ1B5dGhvbiBjb21wYXRpYmlsaXR5LCB3ZSBjYW5ub3QgdXNlCiAgICAgICAgICAgICMgb3VyIF9fY2xhc3NfXyBoZXJlLCBidXQgbmVlZCBhIHJlYWwgdGltZWRlbHRhCiAgICAgICAgICAgIHJldHVybiB0aW1lZGVsdGEoc2VsZi5fZGF5cyAqIG90aGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlY29uZHMgKiBvdGhlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9taWNyb3NlY29uZHMgKiBvdGhlcikKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBmbG9hdCk6CiAgICAgICAgICAgIGEsIGIgPSBvdGhlci5hc19pbnRlZ2VyX3JhdGlvKCkKICAgICAgICAgICAgcmV0dXJuIHNlbGYgKiBhIC8gYgogICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgIF9fcm11bF9fID0gX19tdWxfXwoKICAgIGRlZiBfdG9fbWljcm9zZWNvbmRzKHNlbGYpOgogICAgICAgIHJldHVybiAoKHNlbGYuX2RheXMgKiAoMjQqMzYwMCkgKyBzZWxmLl9zZWNvbmRzKSAqIDEwMDAwMDAgKwogICAgICAgICAgICAgICAgc2VsZi5fbWljcm9zZWNvbmRzKQoKICAgIGRlZiBfX2Zsb29yZGl2X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCAoaW50LCB0aW1lZGVsdGEpKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgdXNlYyA9IHNlbGYuX3RvX21pY3Jvc2Vjb25kcygpCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgdGltZWRlbHRhKToKICAgICAgICAgICAgcmV0dXJuIHVzZWMgLy8gb3RoZXIuX3RvX21pY3Jvc2Vjb25kcygpCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgaW50KToKICAgICAgICAgICAgcmV0dXJuIHRpbWVkZWx0YSgwLCAwLCB1c2VjIC8vIG90aGVyKQoKICAgIGRlZiBfX3RydWVkaXZfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIChpbnQsIGZsb2F0LCB0aW1lZGVsdGEpKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgdXNlYyA9IHNlbGYuX3RvX21pY3Jvc2Vjb25kcygpCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgdGltZWRlbHRhKToKICAgICAgICAgICAgcmV0dXJuIHVzZWMgLyBvdGhlci5fdG9fbWljcm9zZWNvbmRzKCkKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBpbnQpOgogICAgICAgICAgICByZXR1cm4gdGltZWRlbHRhKDAsIDAsIHVzZWMgLyBvdGhlcikKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBmbG9hdCk6CiAgICAgICAgICAgIGEsIGIgPSBvdGhlci5hc19pbnRlZ2VyX3JhdGlvKCkKICAgICAgICAgICAgcmV0dXJuIHRpbWVkZWx0YSgwLCAwLCBiICogdXNlYyAvIGEpCgogICAgZGVmIF9fbW9kX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHRpbWVkZWx0YSk6CiAgICAgICAgICAgIHIgPSBzZWxmLl90b19taWNyb3NlY29uZHMoKSAlIG90aGVyLl90b19taWNyb3NlY29uZHMoKQogICAgICAgICAgICByZXR1cm4gdGltZWRlbHRhKDAsIDAsIHIpCiAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCgogICAgZGVmIF9fZGl2bW9kX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHRpbWVkZWx0YSk6CiAgICAgICAgICAgIHEsIHIgPSBkaXZtb2Qoc2VsZi5fdG9fbWljcm9zZWNvbmRzKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgb3RoZXIuX3RvX21pY3Jvc2Vjb25kcygpKQogICAgICAgICAgICByZXR1cm4gcSwgdGltZWRlbHRhKDAsIDAsIHIpCiAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCgogICAgIyBDb21wYXJpc29ucyBvZiB0aW1lZGVsdGEgb2JqZWN0cyB3aXRoIG90aGVyLgoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHRpbWVkZWx0YSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpID09IDAKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgX19uZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCB0aW1lZGVsdGEpOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fY21wKG90aGVyKSAhPSAwCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgX19sZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCB0aW1lZGVsdGEpOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fY21wKG90aGVyKSA8PSAwCiAgICAgICAgZWxzZToKICAgICAgICAgICAgX2NtcGVycm9yKHNlbGYsIG90aGVyKQoKICAgIGRlZiBfX2x0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHRpbWVkZWx0YSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpIDwgMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIF9jbXBlcnJvcihzZWxmLCBvdGhlcikKCiAgICBkZWYgX19nZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCB0aW1lZGVsdGEpOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fY21wKG90aGVyKSA+PSAwCiAgICAgICAgZWxzZToKICAgICAgICAgICAgX2NtcGVycm9yKHNlbGYsIG90aGVyKQoKICAgIGRlZiBfX2d0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHRpbWVkZWx0YSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpID4gMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIF9jbXBlcnJvcihzZWxmLCBvdGhlcikKCiAgICBkZWYgX2NtcChzZWxmLCBvdGhlcik6CiAgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2Uob3RoZXIsIHRpbWVkZWx0YSkKICAgICAgICAjZml4bWUgYnJ5dGhvbgogICAgICAgICNyZXR1cm4gX2NtcChzZWxmLl9nZXRzdGF0ZSgpLCBvdGhlci5fZ2V0c3RhdGUoKSkKICAgICAgICByZXR1cm4gX3N0YXRlX2NtcChzZWxmLl9nZXRzdGF0ZSgpLCBvdGhlci5fZ2V0c3RhdGUoKSkKCiAgICBkZWYgX19oYXNoX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGhhc2goc2VsZi5fZ2V0c3RhdGUoKSkKCiAgICBkZWYgX19ib29sX18oc2VsZik6CiAgICAgICAgcmV0dXJuIChzZWxmLl9kYXlzICE9IDAgb3IKICAgICAgICAgICAgICAgIHNlbGYuX3NlY29uZHMgIT0gMCBvcgogICAgICAgICAgICAgICAgc2VsZi5fbWljcm9zZWNvbmRzICE9IDApCgogICAgIyBQaWNrbGUgc3VwcG9ydC4KCiAgICBkZWYgX2dldHN0YXRlKHNlbGYpOgogICAgICAgIHJldHVybiAoc2VsZi5fZGF5cywgc2VsZi5fc2Vjb25kcywgc2VsZi5fbWljcm9zZWNvbmRzKQoKICAgIGRlZiBfX3JlZHVjZV9fKHNlbGYpOgogICAgICAgIHJldHVybiAoc2VsZi5fX2NsYXNzX18sIHNlbGYuX2dldHN0YXRlKCkpCgp0aW1lZGVsdGEubWluID0gdGltZWRlbHRhKC05OTk5OTk5OTkpCnRpbWVkZWx0YS5tYXggPSB0aW1lZGVsdGEoZGF5cz05OTk5OTk5OTksIGhvdXJzPTIzLCBtaW51dGVzPTU5LCBzZWNvbmRzPTU5LAogICAgICAgICAgICAgICAgICAgICAgICAgIG1pY3Jvc2Vjb25kcz05OTk5OTkpCnRpbWVkZWx0YS5yZXNvbHV0aW9uID0gdGltZWRlbHRhKG1pY3Jvc2Vjb25kcz0xKQoKY2xhc3MgZGF0ZToKICAgICIiIkNvbmNyZXRlIGRhdGUgdHlwZS4KCiAgICBDb25zdHJ1Y3RvcnM6CgogICAgX19uZXdfXygpCiAgICBmcm9tdGltZXN0YW1wKCkKICAgIHRvZGF5KCkKICAgIGZyb21vcmRpbmFsKCkKCiAgICBPcGVyYXRvcnM6CgogICAgX19yZXByX18sIF9fc3RyX18KICAgIF9fY21wX18sIF9faGFzaF9fCiAgICBfX2FkZF9fLCBfX3JhZGRfXywgX19zdWJfXyAoYWRkL3JhZGQgb25seSB3aXRoIHRpbWVkZWx0YSBhcmcpCgogICAgTWV0aG9kczoKCiAgICB0aW1ldHVwbGUoKQogICAgdG9vcmRpbmFsKCkKICAgIHdlZWtkYXkoKQogICAgaXNvd2Vla2RheSgpLCBpc29jYWxlbmRhcigpLCBpc29mb3JtYXQoKQogICAgY3RpbWUoKQogICAgc3RyZnRpbWUoKQoKICAgIFByb3BlcnRpZXMgKHJlYWRvbmx5KToKICAgIHllYXIsIG1vbnRoLCBkYXkKICAgICIiIgogICAgX19zbG90c19fID0gJ195ZWFyJywgJ19tb250aCcsICdfZGF5JwoKICAgIGRlZiBfX25ld19fKGNscywgeWVhciwgbW9udGg9Tm9uZSwgZGF5PU5vbmUpOgogICAgICAgICIiIkNvbnN0cnVjdG9yLgoKICAgICAgICBBcmd1bWVudHM6CgogICAgICAgIHllYXIsIG1vbnRoLCBkYXkgKHJlcXVpcmVkLCBiYXNlIDEpCiAgICAgICAgIiIiCiAgICAgICAgaWYgKGlzaW5zdGFuY2UoeWVhciwgYnl0ZXMpIGFuZCBsZW4oeWVhcikgPT0gNCBhbmQKICAgICAgICAgICAgMSA8PSB5ZWFyWzJdIDw9IDEyIGFuZCBtb250aCBpcyBOb25lKTogICMgTW9udGggaXMgc2FuZQogICAgICAgICAgICAjIFBpY2tsZSBzdXBwb3J0CiAgICAgICAgICAgIHNlbGYgPSBvYmplY3QuX19uZXdfXyhjbHMpCiAgICAgICAgICAgIHNlbGYuX19zZXRzdGF0ZSh5ZWFyKQogICAgICAgICAgICByZXR1cm4gc2VsZgogICAgICAgIF9jaGVja19kYXRlX2ZpZWxkcyh5ZWFyLCBtb250aCwgZGF5KQogICAgICAgIHNlbGYgPSBvYmplY3QuX19uZXdfXyhjbHMpCiAgICAgICAgc2VsZi5feWVhciA9IHllYXIKICAgICAgICBzZWxmLl9tb250aCA9IG1vbnRoCiAgICAgICAgc2VsZi5fZGF5ID0gZGF5CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICAjIEFkZGl0aW9uYWwgY29uc3RydWN0b3JzCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbXRpbWVzdGFtcChjbHMsIHQpOgogICAgICAgICJDb25zdHJ1Y3QgYSBkYXRlIGZyb20gYSBQT1NJWCB0aW1lc3RhbXAgKGxpa2UgdGltZS50aW1lKCkpLiIKICAgICAgICB5LCBtLCBkLCBoaCwgbW0sIHNzLCB3ZWVrZGF5LCBqZGF5LCBkc3QgPSBfdGltZS5sb2NhbHRpbWUodCkKICAgICAgICByZXR1cm4gY2xzKHksIG0sIGQpCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgdG9kYXkoY2xzKToKICAgICAgICAiQ29uc3RydWN0IGEgZGF0ZSBmcm9tIHRpbWUudGltZSgpLiIKICAgICAgICB0ID0gX3RpbWUudGltZSgpCiAgICAgICAgcmV0dXJuIGNscy5mcm9tdGltZXN0YW1wKHQpCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbW9yZGluYWwoY2xzLCBuKToKICAgICAgICAiIiJDb250cnVjdCBhIGRhdGUgZnJvbSBhIHByb2xlcHRpYyBHcmVnb3JpYW4gb3JkaW5hbC4KCiAgICAgICAgSmFudWFyeSAxIG9mIHllYXIgMSBpcyBkYXkgMS4gIE9ubHkgdGhlIHllYXIsIG1vbnRoIGFuZCBkYXkgYXJlCiAgICAgICAgbm9uLXplcm8gaW4gdGhlIHJlc3VsdC4KICAgICAgICAiIiIKICAgICAgICB5LCBtLCBkID0gX29yZDJ5bWQobikKICAgICAgICByZXR1cm4gY2xzKHksIG0sIGQpCgogICAgIyBDb252ZXJzaW9ucyB0byBzdHJpbmcKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgIiIiQ29udmVydCB0byBmb3JtYWwgc3RyaW5nLCBmb3IgcmVwcigpLgoKICAgICAgICA+Pj4gZHQgPSBkYXRldGltZSgyMDEwLCAxLCAxKQogICAgICAgID4+PiByZXByKGR0KQogICAgICAgICdkYXRldGltZS5kYXRldGltZSgyMDEwLCAxLCAxLCAwLCAwKScKCiAgICAgICAgPj4+IGR0ID0gZGF0ZXRpbWUoMjAxMCwgMSwgMSwgdHppbmZvPXRpbWV6b25lLnV0YykKICAgICAgICA+Pj4gcmVwcihkdCkKICAgICAgICAnZGF0ZXRpbWUuZGF0ZXRpbWUoMjAxMCwgMSwgMSwgMCwgMCwgdHppbmZvPWRhdGV0aW1lLnRpbWV6b25lLnV0YyknCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuICIlcyglZCwgJWQsICVkKSIgJSAoJ2RhdGV0aW1lLicgKyBzZWxmLl9fY2xhc3NfXy5fX25hbWVfXywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl95ZWFyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX21vbnRoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2RheSkKICAgICMgWFhYIFRoZXNlIHNob3VsZG4ndCBkZXBlbmQgb24gdGltZS5sb2NhbHRpbWUoKSwgYmVjYXVzZSB0aGF0CiAgICAjIGNsaXBzIHRoZSB1c2FibGUgZGF0ZXMgdG8gWzE5NzAgLi4gMjAzOCkuICBBdCBsZWFzdCBjdGltZSgpIGlzCiAgICAjIGVhc2lseSBkb25lIHdpdGhvdXQgdXNpbmcgc3RyZnRpbWUoKSAtLSB0aGF0J3MgYmV0dGVyIHRvbyBiZWNhdXNlCiAgICAjIHN0cmZ0aW1lKCIlYyIsIC4uLikgaXMgbG9jYWxlIHNwZWNpZmljLgoKCiAgICBkZWYgY3RpbWUoc2VsZik6CiAgICAgICAgIlJldHVybiBjdGltZSgpIHN0eWxlIHN0cmluZy4iCiAgICAgICAgd2Vla2RheSA9IHNlbGYudG9vcmRpbmFsKCkgJSA3IG9yIDcKICAgICAgICByZXR1cm4gIiVzICVzICUyZCAwMDowMDowMCAlMDRkIiAlICgKICAgICAgICAgICAgX0RBWU5BTUVTW3dlZWtkYXldLAogICAgICAgICAgICBfTU9OVEhOQU1FU1tzZWxmLl9tb250aF0sCiAgICAgICAgICAgIHNlbGYuX2RheSwgc2VsZi5feWVhcikKCiAgICBkZWYgc3RyZnRpbWUoc2VsZiwgZm10KToKICAgICAgICAiRm9ybWF0IHVzaW5nIHN0cmZ0aW1lKCkuIgogICAgICAgIHJldHVybiBfd3JhcF9zdHJmdGltZShzZWxmLCBmbXQsIHNlbGYudGltZXR1cGxlKCkpCgogICAgZGVmIF9fZm9ybWF0X18oc2VsZiwgZm10KToKICAgICAgICBpZiBsZW4oZm10KSAhPSAwOgogICAgICAgICAgICByZXR1cm4gc2VsZi5zdHJmdGltZShmbXQpCiAgICAgICAgcmV0dXJuIHN0cihzZWxmKQoKICAgIGRlZiBpc29mb3JtYXQoc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIHRoZSBkYXRlIGZvcm1hdHRlZCBhY2NvcmRpbmcgdG8gSVNPLgoKICAgICAgICBUaGlzIGlzICdZWVlZLU1NLUREJy4KCiAgICAgICAgUmVmZXJlbmNlczoKICAgICAgICAtIGh0dHA6Ly93d3cudzMub3JnL1RSL05PVEUtZGF0ZXRpbWUKICAgICAgICAtIGh0dHA6Ly93d3cuY2wuY2FtLmFjLnVrL35tZ2syNS9pc28tdGltZS5odG1sCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuICIlMDRkLSUwMmQtJTAyZCIgJSAoc2VsZi5feWVhciwgc2VsZi5fbW9udGgsIHNlbGYuX2RheSkKCiAgICBfX3N0cl9fID0gaXNvZm9ybWF0CgogICAgIyBSZWFkLW9ubHkgZmllbGQgYWNjZXNzb3JzCiAgICBAcHJvcGVydHkKICAgIGRlZiB5ZWFyKHNlbGYpOgogICAgICAgICIiInllYXIgKDEtOTk5OSkiIiIKICAgICAgICByZXR1cm4gc2VsZi5feWVhcgoKICAgIEBwcm9wZXJ0eQogICAgZGVmIG1vbnRoKHNlbGYpOgogICAgICAgICIiIm1vbnRoICgxLTEyKSIiIgogICAgICAgIHJldHVybiBzZWxmLl9tb250aAoKICAgIEBwcm9wZXJ0eQogICAgZGVmIGRheShzZWxmKToKICAgICAgICAiIiJkYXkgKDEtMzEpIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX2RheQoKICAgICMgU3RhbmRhcmQgY29udmVyc2lvbnMsIF9fY21wX18sIF9faGFzaF9fIChhbmQgaGVscGVycykKCiAgICBkZWYgdGltZXR1cGxlKHNlbGYpOgogICAgICAgICJSZXR1cm4gbG9jYWwgdGltZSB0dXBsZSBjb21wYXRpYmxlIHdpdGggdGltZS5sb2NhbHRpbWUoKS4iCiAgICAgICAgcmV0dXJuIF9idWlsZF9zdHJ1Y3RfdGltZShzZWxmLl95ZWFyLCBzZWxmLl9tb250aCwgc2VsZi5fZGF5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCwgMCwgMCwgLTEpCgogICAgZGVmIHRvb3JkaW5hbChzZWxmKToKICAgICAgICAiIiJSZXR1cm4gcHJvbGVwdGljIEdyZWdvcmlhbiBvcmRpbmFsIGZvciB0aGUgeWVhciwgbW9udGggYW5kIGRheS4KCiAgICAgICAgSmFudWFyeSAxIG9mIHllYXIgMSBpcyBkYXkgMS4gIE9ubHkgdGhlIHllYXIsIG1vbnRoIGFuZCBkYXkgdmFsdWVzCiAgICAgICAgY29udHJpYnV0ZSB0byB0aGUgcmVzdWx0LgogICAgICAgICIiIgogICAgICAgIHJldHVybiBfeW1kMm9yZChzZWxmLl95ZWFyLCBzZWxmLl9tb250aCwgc2VsZi5fZGF5KQoKICAgIGRlZiByZXBsYWNlKHNlbGYsIHllYXI9Tm9uZSwgbW9udGg9Tm9uZSwgZGF5PU5vbmUpOgogICAgICAgICIiIlJldHVybiBhIG5ldyBkYXRlIHdpdGggbmV3IHZhbHVlcyBmb3IgdGhlIHNwZWNpZmllZCBmaWVsZHMuIiIiCiAgICAgICAgaWYgeWVhciBpcyBOb25lOgogICAgICAgICAgICB5ZWFyID0gc2VsZi5feWVhcgogICAgICAgIGlmIG1vbnRoIGlzIE5vbmU6CiAgICAgICAgICAgIG1vbnRoID0gc2VsZi5fbW9udGgKICAgICAgICBpZiBkYXkgaXMgTm9uZToKICAgICAgICAgICAgZGF5ID0gc2VsZi5fZGF5CiAgICAgICAgX2NoZWNrX2RhdGVfZmllbGRzKHllYXIsIG1vbnRoLCBkYXkpCiAgICAgICAgcmV0dXJuIGRhdGUoeWVhciwgbW9udGgsIGRheSkKCiAgICAjIENvbXBhcmlzb25zIG9mIGRhdGUgb2JqZWN0cyB3aXRoIG90aGVyLgoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIGRhdGUpOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fY21wKG90aGVyKSA9PSAwCiAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCgogICAgZGVmIF9fbmVfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgZGF0ZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpICE9IDAKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICBkZWYgX19sZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkYXRlKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NtcChvdGhlcikgPD0gMAogICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgIGRlZiBfX2x0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIGRhdGUpOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fY21wKG90aGVyKSA8IDAKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICBkZWYgX19nZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkYXRlKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NtcChvdGhlcikgPj0gMAogICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgIGRlZiBfX2d0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIGRhdGUpOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fY21wKG90aGVyKSA+IDAKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICBkZWYgX2NtcChzZWxmLCBvdGhlcik6CiAgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2Uob3RoZXIsIGRhdGUpCiAgICAgICAgeSwgbSwgZCA9IHNlbGYuX3llYXIsIHNlbGYuX21vbnRoLCBzZWxmLl9kYXkKICAgICAgICB5MiwgbTIsIGQyID0gb3RoZXIuX3llYXIsIG90aGVyLl9tb250aCwgb3RoZXIuX2RheQogICAgICAgICNmaXhtZSBicnl0aG9uCiAgICAgICAgI3JldHVybiBfY21wKCh5LCBtLCBkKSwgKHkyLCBtMiwgZDIpKQogICAgICAgIHJldHVybiBfc3RhdGVfY21wKCh5LCBtLCBkKSwgKHkyLCBtMiwgZDIpKQoKICAgIGRlZiBfX2hhc2hfXyhzZWxmKToKICAgICAgICAiSGFzaC4iCiAgICAgICAgcmV0dXJuIGhhc2goc2VsZi5fZ2V0c3RhdGUoKSkKCiAgICAjIENvbXB1dGF0aW9ucwoKICAgIGRlZiBfX2FkZF9fKHNlbGYsIG90aGVyKToKICAgICAgICAiQWRkIGEgZGF0ZSB0byBhIHRpbWVkZWx0YS4iCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgdGltZWRlbHRhKToKICAgICAgICAgICAgbyA9IHNlbGYudG9vcmRpbmFsKCkgKyBvdGhlci5kYXlzCiAgICAgICAgICAgIGlmIDAgPCBvIDw9IF9NQVhPUkRJTkFMOgogICAgICAgICAgICAgICAgcmV0dXJuIGRhdGUuZnJvbW9yZGluYWwobykKICAgICAgICAgICAgcmFpc2UgT3ZlcmZsb3dFcnJvcigicmVzdWx0IG91dCBvZiByYW5nZSIpCiAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCgogICAgX19yYWRkX18gPSBfX2FkZF9fCgogICAgZGVmIF9fc3ViX18oc2VsZiwgb3RoZXIpOgogICAgICAgICIiIlN1YnRyYWN0IHR3byBkYXRlcywgb3IgYSBkYXRlIGFuZCBhIHRpbWVkZWx0YS4iIiIKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCB0aW1lZGVsdGEpOgogICAgICAgICAgICByZXR1cm4gc2VsZiArIHRpbWVkZWx0YSgtb3RoZXIuZGF5cykKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkYXRlKToKICAgICAgICAgICAgZGF5czEgPSBzZWxmLnRvb3JkaW5hbCgpCiAgICAgICAgICAgIGRheXMyID0gb3RoZXIudG9vcmRpbmFsKCkKICAgICAgICAgICAgcmV0dXJuIHRpbWVkZWx0YShkYXlzMSAtIGRheXMyKQogICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgIGRlZiB3ZWVrZGF5KHNlbGYpOgogICAgICAgICJSZXR1cm4gZGF5IG9mIHRoZSB3ZWVrLCB3aGVyZSBNb25kYXkgPT0gMCAuLi4gU3VuZGF5ID09IDYuIgogICAgICAgIHJldHVybiAoc2VsZi50b29yZGluYWwoKSArIDYpICUgNwoKICAgICMgRGF5LW9mLXRoZS13ZWVrIGFuZCB3ZWVrLW9mLXRoZS15ZWFyLCBhY2NvcmRpbmcgdG8gSVNPCgogICAgZGVmIGlzb3dlZWtkYXkoc2VsZik6CiAgICAgICAgIlJldHVybiBkYXkgb2YgdGhlIHdlZWssIHdoZXJlIE1vbmRheSA9PSAxIC4uLiBTdW5kYXkgPT0gNy4iCiAgICAgICAgIyAxLUphbi0wMDAxIGlzIGEgTW9uZGF5CiAgICAgICAgcmV0dXJuIHNlbGYudG9vcmRpbmFsKCkgJSA3IG9yIDcKCiAgICBkZWYgaXNvY2FsZW5kYXIoc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIGEgMy10dXBsZSBjb250YWluaW5nIElTTyB5ZWFyLCB3ZWVrIG51bWJlciwgYW5kIHdlZWtkYXkuCgogICAgICAgIFRoZSBmaXJzdCBJU08gd2VlayBvZiB0aGUgeWVhciBpcyB0aGUgKE1vbi1TdW4pIHdlZWsKICAgICAgICBjb250YWluaW5nIHRoZSB5ZWFyJ3MgZmlyc3QgVGh1cnNkYXk7IGV2ZXJ5dGhpbmcgZWxzZSBkZXJpdmVzCiAgICAgICAgZnJvbSB0aGF0LgoKICAgICAgICBUaGUgZmlyc3Qgd2VlayBpcyAxOyBNb25kYXkgaXMgMSAuLi4gU3VuZGF5IGlzIDcuCgogICAgICAgIElTTyBjYWxlbmRhciBhbGdvcml0aG0gdGFrZW4gZnJvbQogICAgICAgIGh0dHA6Ly93d3cucGh5cy51dS5ubC9+dmdlbnQvY2FsZW5kYXIvaXNvY2FsZW5kYXIuaHRtCiAgICAgICAgIiIiCiAgICAgICAgeWVhciA9IHNlbGYuX3llYXIKICAgICAgICB3ZWVrMW1vbmRheSA9IF9pc293ZWVrMW1vbmRheSh5ZWFyKQogICAgICAgIHRvZGF5ID0gX3ltZDJvcmQoc2VsZi5feWVhciwgc2VsZi5fbW9udGgsIHNlbGYuX2RheSkKICAgICAgICAjIEludGVybmFsbHksIHdlZWsgYW5kIGRheSBoYXZlIG9yaWdpbiAwCiAgICAgICAgd2VlaywgZGF5ID0gZGl2bW9kKHRvZGF5IC0gd2VlazFtb25kYXksIDcpCiAgICAgICAgaWYgd2VlayA8IDA6CiAgICAgICAgICAgIHllYXIgLT0gMQogICAgICAgICAgICB3ZWVrMW1vbmRheSA9IF9pc293ZWVrMW1vbmRheSh5ZWFyKQogICAgICAgICAgICB3ZWVrLCBkYXkgPSBkaXZtb2QodG9kYXkgLSB3ZWVrMW1vbmRheSwgNykKICAgICAgICBlbGlmIHdlZWsgPj0gNTI6CiAgICAgICAgICAgIGlmIHRvZGF5ID49IF9pc293ZWVrMW1vbmRheSh5ZWFyKzEpOgogICAgICAgICAgICAgICAgeWVhciArPSAxCiAgICAgICAgICAgICAgICB3ZWVrID0gMAogICAgICAgIHJldHVybiB5ZWFyLCB3ZWVrKzEsIGRheSsxCgogICAgIyBQaWNrbGUgc3VwcG9ydC4KCiAgICBkZWYgX2dldHN0YXRlKHNlbGYpOgogICAgICAgIHloaSwgeWxvID0gZGl2bW9kKHNlbGYuX3llYXIsIDI1NikKICAgICAgICByZXR1cm4gYnl0ZXMoW3loaSwgeWxvLCBzZWxmLl9tb250aCwgc2VsZi5fZGF5XSksCgogICAgZGVmIF9fc2V0c3RhdGUoc2VsZiwgc3RyaW5nKToKICAgICAgICBpZiBsZW4oc3RyaW5nKSAhPSA0IG9yIG5vdCAoMSA8PSBzdHJpbmdbMl0gPD0gMTIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIm5vdCBlbm91Z2ggYXJndW1lbnRzIikKICAgICAgICB5aGksIHlsbywgc2VsZi5fbW9udGgsIHNlbGYuX2RheSA9IHN0cmluZwogICAgICAgIHNlbGYuX3llYXIgPSB5aGkgKiAyNTYgKyB5bG8KCiAgICBkZWYgX19yZWR1Y2VfXyhzZWxmKToKICAgICAgICByZXR1cm4gKHNlbGYuX19jbGFzc19fLCBzZWxmLl9nZXRzdGF0ZSgpKQoKX2RhdGVfY2xhc3MgPSBkYXRlICAjIHNvIGZ1bmN0aW9ucyB3LyBhcmdzIG5hbWVkICJkYXRlIiBjYW4gZ2V0IGF0IHRoZSBjbGFzcwoKZGF0ZS5taW4gPSBkYXRlKDEsIDEsIDEpCmRhdGUubWF4ID0gZGF0ZSg5OTk5LCAxMiwgMzEpCmRhdGUucmVzb2x1dGlvbiA9IHRpbWVkZWx0YShkYXlzPTEpCgpjbGFzcyB0emluZm86CiAgICAiIiJBYnN0cmFjdCBiYXNlIGNsYXNzIGZvciB0aW1lIHpvbmUgaW5mbyBjbGFzc2VzLgoKICAgIFN1YmNsYXNzZXMgbXVzdCBvdmVycmlkZSB0aGUgbmFtZSgpLCB1dGNvZmZzZXQoKSBhbmQgZHN0KCkgbWV0aG9kcy4KICAgICIiIgogICAgX19zbG90c19fID0gKCkKICAgIGRlZiB0em5hbWUoc2VsZiwgZHQpOgogICAgICAgICJkYXRldGltZSAtPiBzdHJpbmcgbmFtZSBvZiB0aW1lIHpvbmUuIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoInR6aW5mbyBzdWJjbGFzcyBtdXN0IG92ZXJyaWRlIHR6bmFtZSgpIikKCiAgICBkZWYgdXRjb2Zmc2V0KHNlbGYsIGR0KToKICAgICAgICAiZGF0ZXRpbWUgLT4gbWludXRlcyBlYXN0IG9mIFVUQyAobmVnYXRpdmUgZm9yIHdlc3Qgb2YgVVRDKSIKICAgICAgICByYWlzZSBOb3RJbXBsZW1lbnRlZEVycm9yKCJ0emluZm8gc3ViY2xhc3MgbXVzdCBvdmVycmlkZSB1dGNvZmZzZXQoKSIpCgogICAgZGVmIGRzdChzZWxmLCBkdCk6CiAgICAgICAgIiIiZGF0ZXRpbWUgLT4gRFNUIG9mZnNldCBpbiBtaW51dGVzIGVhc3Qgb2YgVVRDLgoKICAgICAgICBSZXR1cm4gMCBpZiBEU1Qgbm90IGluIGVmZmVjdC4gIHV0Y29mZnNldCgpIG11c3QgaW5jbHVkZSB0aGUgRFNUCiAgICAgICAgb2Zmc2V0LgogICAgICAgICIiIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoInR6aW5mbyBzdWJjbGFzcyBtdXN0IG92ZXJyaWRlIGRzdCgpIikKCiAgICBkZWYgZnJvbXV0YyhzZWxmLCBkdCk6CiAgICAgICAgImRhdGV0aW1lIGluIFVUQyAtPiBkYXRldGltZSBpbiBsb2NhbCB0aW1lLiIKCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoZHQsIGRhdGV0aW1lKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJmcm9tdXRjKCkgcmVxdWlyZXMgYSBkYXRldGltZSBhcmd1bWVudCIpCiAgICAgICAgaWYgZHQudHppbmZvIGlzIG5vdCBzZWxmOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJkdC50emluZm8gaXMgbm90IHNlbGYiKQoKICAgICAgICBkdG9mZiA9IGR0LnV0Y29mZnNldCgpCiAgICAgICAgaWYgZHRvZmYgaXMgTm9uZToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiZnJvbXV0YygpIHJlcXVpcmVzIGEgbm9uLU5vbmUgdXRjb2Zmc2V0KCkgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJyZXN1bHQiKQoKICAgICAgICAjIFNlZSB0aGUgbG9uZyBjb21tZW50IGJsb2NrIGF0IHRoZSBlbmQgb2YgdGhpcyBmaWxlIGZvciBhbgogICAgICAgICMgZXhwbGFuYXRpb24gb2YgdGhpcyBhbGdvcml0aG0uCiAgICAgICAgZHRkc3QgPSBkdC5kc3QoKQogICAgICAgIGlmIGR0ZHN0IGlzIE5vbmU6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImZyb211dGMoKSByZXF1aXJlcyBhIG5vbi1Ob25lIGRzdCgpIHJlc3VsdCIpCiAgICAgICAgZGVsdGEgPSBkdG9mZiAtIGR0ZHN0CiAgICAgICAgaWYgZGVsdGE6CiAgICAgICAgICAgIGR0ICs9IGRlbHRhCiAgICAgICAgICAgIGR0ZHN0ID0gZHQuZHN0KCkKICAgICAgICAgICAgaWYgZHRkc3QgaXMgTm9uZToKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImZyb211dGMoKTogZHQuZHN0IGdhdmUgaW5jb25zaXN0ZW50ICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInJlc3VsdHM7IGNhbm5vdCBjb252ZXJ0IikKICAgICAgICByZXR1cm4gZHQgKyBkdGRzdAoKICAgICMgUGlja2xlIHN1cHBvcnQuCgogICAgZGVmIF9fcmVkdWNlX18oc2VsZik6CiAgICAgICAgZ2V0aW5pdGFyZ3MgPSBnZXRhdHRyKHNlbGYsICJfX2dldGluaXRhcmdzX18iLCBOb25lKQogICAgICAgIGlmIGdldGluaXRhcmdzOgogICAgICAgICAgICBhcmdzID0gZ2V0aW5pdGFyZ3MoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGFyZ3MgPSAoKQogICAgICAgIGdldHN0YXRlID0gZ2V0YXR0cihzZWxmLCAiX19nZXRzdGF0ZV9fIiwgTm9uZSkKICAgICAgICBpZiBnZXRzdGF0ZToKICAgICAgICAgICAgc3RhdGUgPSBnZXRzdGF0ZSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc3RhdGUgPSBnZXRhdHRyKHNlbGYsICJfX2RpY3RfXyIsIE5vbmUpIG9yIE5vbmUKICAgICAgICBpZiBzdGF0ZSBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gKHNlbGYuX19jbGFzc19fLCBhcmdzKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiAoc2VsZi5fX2NsYXNzX18sIGFyZ3MsIHN0YXRlKQoKX3R6aW5mb19jbGFzcyA9IHR6aW5mbwoKY2xhc3MgdGltZToKICAgICIiIlRpbWUgd2l0aCB0aW1lIHpvbmUuCgogICAgQ29uc3RydWN0b3JzOgoKICAgIF9fbmV3X18oKQoKICAgIE9wZXJhdG9yczoKCiAgICBfX3JlcHJfXywgX19zdHJfXwogICAgX19jbXBfXywgX19oYXNoX18KCiAgICBNZXRob2RzOgoKICAgIHN0cmZ0aW1lKCkKICAgIGlzb2Zvcm1hdCgpCiAgICB1dGNvZmZzZXQoKQogICAgdHpuYW1lKCkKICAgIGRzdCgpCgogICAgUHJvcGVydGllcyAocmVhZG9ubHkpOgogICAgaG91ciwgbWludXRlLCBzZWNvbmQsIG1pY3Jvc2Vjb25kLCB0emluZm8KICAgICIiIgoKICAgIGRlZiBfX25ld19fKGNscywgaG91cj0wLCBtaW51dGU9MCwgc2Vjb25kPTAsIG1pY3Jvc2Vjb25kPTAsIHR6aW5mbz1Ob25lKToKICAgICAgICAiIiJDb25zdHJ1Y3Rvci4KCiAgICAgICAgQXJndW1lbnRzOgoKICAgICAgICBob3VyLCBtaW51dGUgKHJlcXVpcmVkKQogICAgICAgIHNlY29uZCwgbWljcm9zZWNvbmQgKGRlZmF1bHQgdG8gemVybykKICAgICAgICB0emluZm8gKGRlZmF1bHQgdG8gTm9uZSkKICAgICAgICAiIiIKICAgICAgICBzZWxmID0gb2JqZWN0Ll9fbmV3X18oY2xzKQogICAgICAgIGlmIGlzaW5zdGFuY2UoaG91ciwgYnl0ZXMpIGFuZCBsZW4oaG91cikgPT0gNjoKICAgICAgICAgICAgIyBQaWNrbGUgc3VwcG9ydAogICAgICAgICAgICBzZWxmLl9fc2V0c3RhdGUoaG91ciwgbWludXRlIG9yIE5vbmUpCiAgICAgICAgICAgIHJldHVybiBzZWxmCiAgICAgICAgX2NoZWNrX3R6aW5mb19hcmcodHppbmZvKQogICAgICAgIF9jaGVja190aW1lX2ZpZWxkcyhob3VyLCBtaW51dGUsIHNlY29uZCwgbWljcm9zZWNvbmQpCiAgICAgICAgc2VsZi5faG91ciA9IGhvdXIKICAgICAgICBzZWxmLl9taW51dGUgPSBtaW51dGUKICAgICAgICBzZWxmLl9zZWNvbmQgPSBzZWNvbmQKICAgICAgICBzZWxmLl9taWNyb3NlY29uZCA9IG1pY3Jvc2Vjb25kCiAgICAgICAgc2VsZi5fdHppbmZvID0gdHppbmZvCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICAjIFJlYWQtb25seSBmaWVsZCBhY2Nlc3NvcnMKICAgIEBwcm9wZXJ0eQogICAgZGVmIGhvdXIoc2VsZik6CiAgICAgICAgIiIiaG91ciAoMC0yMykiIiIKICAgICAgICByZXR1cm4gc2VsZi5faG91cgoKICAgIEBwcm9wZXJ0eQogICAgZGVmIG1pbnV0ZShzZWxmKToKICAgICAgICAiIiJtaW51dGUgKDAtNTkpIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX21pbnV0ZQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIHNlY29uZChzZWxmKToKICAgICAgICAiIiJzZWNvbmQgKDAtNTkpIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX3NlY29uZAoKICAgIEBwcm9wZXJ0eQogICAgZGVmIG1pY3Jvc2Vjb25kKHNlbGYpOgogICAgICAgICIiIm1pY3Jvc2Vjb25kICgwLTk5OTk5OSkiIiIKICAgICAgICByZXR1cm4gc2VsZi5fbWljcm9zZWNvbmQKCiAgICBAcHJvcGVydHkKICAgIGRlZiB0emluZm8oc2VsZik6CiAgICAgICAgIiIidGltZXpvbmUgaW5mbyBvYmplY3QiIiIKICAgICAgICByZXR1cm4gc2VsZi5fdHppbmZvCgogICAgIyBTdGFuZGFyZCBjb252ZXJzaW9ucywgX19oYXNoX18gKGFuZCBoZWxwZXJzKQoKICAgICMgQ29tcGFyaXNvbnMgb2YgdGltZSBvYmplY3RzIHdpdGggb3RoZXIuCgogICAgZGVmIF9fZXFfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgdGltZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpID09IDAKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgX19uZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCB0aW1lKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NtcChvdGhlcikgIT0gMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIF9fbGVfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgdGltZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpIDw9IDAKICAgICAgICBlbHNlOgogICAgICAgICAgICBfY21wZXJyb3Ioc2VsZiwgb3RoZXIpCgogICAgZGVmIF9fbHRfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgdGltZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpIDwgMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIF9jbXBlcnJvcihzZWxmLCBvdGhlcikKCiAgICBkZWYgX19nZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCB0aW1lKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NtcChvdGhlcikgPj0gMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIF9jbXBlcnJvcihzZWxmLCBvdGhlcikKCiAgICBkZWYgX19ndF9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCB0aW1lKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NtcChvdGhlcikgPiAwCiAgICAgICAgZWxzZToKICAgICAgICAgICAgX2NtcGVycm9yKHNlbGYsIG90aGVyKQoKICAgIGRlZiBfY21wKHNlbGYsIG90aGVyKToKICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShvdGhlciwgdGltZSkKICAgICAgICBteXR6ID0gc2VsZi5fdHppbmZvCiAgICAgICAgb3R0eiA9IG90aGVyLl90emluZm8KICAgICAgICBteW9mZiA9IG90b2ZmID0gTm9uZQoKICAgICAgICBpZiBteXR6IGlzIG90dHo6CiAgICAgICAgICAgIGJhc2VfY29tcGFyZSA9IFRydWUKICAgICAgICBlbHNlOgogICAgICAgICAgICBteW9mZiA9IHNlbGYudXRjb2Zmc2V0KCkKICAgICAgICAgICAgb3RvZmYgPSBvdGhlci51dGNvZmZzZXQoKQogICAgICAgICAgICBiYXNlX2NvbXBhcmUgPSBteW9mZiA9PSBvdG9mZgoKICAgICAgICBpZiBiYXNlX2NvbXBhcmU6CiAgICAgICAgICAgICNmaXhtZSBicnl0aG9uCiAgICAgICAgICAgICNyZXR1cm4gX2NtcCgoc2VsZi5faG91ciwgc2VsZi5fbWludXRlLCBzZWxmLl9zZWNvbmQsCiAgICAgICAgICAgICMgICAgICAgICAgICAgc2VsZi5fbWljcm9zZWNvbmQpLAogICAgICAgICAgICAjICAgICAgICAgICAob3RoZXIuX2hvdXIsIG90aGVyLl9taW51dGUsIG90aGVyLl9zZWNvbmQsCiAgICAgICAgICAgICMgICAgICAgICAgICBvdGhlci5fbWljcm9zZWNvbmQpKQogICAgICAgICAgICByZXR1cm4gX3R1cGxlX2NtcCgoc2VsZi5faG91ciwgc2VsZi5fbWludXRlLCBzZWxmLl9zZWNvbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9taWNyb3NlY29uZCksCiAgICAgICAgICAgICAgICAgICAgICAgKG90aGVyLl9ob3VyLCBvdGhlci5fbWludXRlLCBvdGhlci5fc2Vjb25kLAogICAgICAgICAgICAgICAgICAgICAgICBvdGhlci5fbWljcm9zZWNvbmQpKQogICAgICAgIGlmIG15b2ZmIGlzIE5vbmUgb3Igb3RvZmYgaXMgTm9uZToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJjYW5ub3QgY29tcGFyZSBuYWl2ZSBhbmQgYXdhcmUgdGltZXMiKQogICAgICAgIG15aGhtbSA9IHNlbGYuX2hvdXIgKiA2MCArIHNlbGYuX21pbnV0ZSAtIG15b2ZmLy90aW1lZGVsdGEobWludXRlcz0xKQogICAgICAgIG90aGhtbSA9IG90aGVyLl9ob3VyICogNjAgKyBvdGhlci5fbWludXRlIC0gb3RvZmYvL3RpbWVkZWx0YShtaW51dGVzPTEpCiAgICAgICAgI2ZpeG1lIGJyeXRob24KICAgICAgICAjcmV0dXJuIF9jbXAoKG15aGhtbSwgc2VsZi5fc2Vjb25kLCBzZWxmLl9taWNyb3NlY29uZCksCiAgICAgICAgIyAgICAgICAgICAgIChvdGhobW0sIG90aGVyLl9zZWNvbmQsIG90aGVyLl9taWNyb3NlY29uZCkpCiAgICAgICAgcmV0dXJuIF90dXBsZV9jbXAoKG15aGhtbSwgc2VsZi5fc2Vjb25kLCBzZWxmLl9taWNyb3NlY29uZCksCiAgICAgICAgICAgICAgICAgICAgKG90aGhtbSwgb3RoZXIuX3NlY29uZCwgb3RoZXIuX21pY3Jvc2Vjb25kKSkKCiAgICBkZWYgX19oYXNoX18oc2VsZik6CiAgICAgICAgIiIiSGFzaC4iIiIKICAgICAgICB0em9mZiA9IHNlbGYudXRjb2Zmc2V0KCkKICAgICAgICBpZiBub3QgdHpvZmY6ICMgemVybyBvciBOb25lCiAgICAgICAgICAgIHJldHVybiBoYXNoKHNlbGYuX2dldHN0YXRlKClbMF0pCiAgICAgICAgaCwgbSA9IGRpdm1vZCh0aW1lZGVsdGEoaG91cnM9c2VsZi5ob3VyLCBtaW51dGVzPXNlbGYubWludXRlKSAtIHR6b2ZmLAogICAgICAgICAgICAgICAgICAgICAgdGltZWRlbHRhKGhvdXJzPTEpKQogICAgICAgIGFzc2VydCBub3QgbSAlIHRpbWVkZWx0YShtaW51dGVzPTEpLCAid2hvbGUgbWludXRlIgogICAgICAgIG0gLy89IHRpbWVkZWx0YShtaW51dGVzPTEpCiAgICAgICAgaWYgMCA8PSBoIDwgMjQ6CiAgICAgICAgICAgIHJldHVybiBoYXNoKHRpbWUoaCwgbSwgc2VsZi5zZWNvbmQsIHNlbGYubWljcm9zZWNvbmQpKQogICAgICAgIHJldHVybiBoYXNoKChoLCBtLCBzZWxmLnNlY29uZCwgc2VsZi5taWNyb3NlY29uZCkpCgogICAgIyBDb252ZXJzaW9uIHRvIHN0cmluZwoKICAgIGRlZiBfdHpzdHIoc2VsZiwgc2VwPSI6Iik6CiAgICAgICAgIiIiUmV0dXJuIGZvcm1hdHRlZCB0aW1lem9uZSBvZmZzZXQgKCt4eDp4eCkgb3IgTm9uZS4iIiIKICAgICAgICBvZmYgPSBzZWxmLnV0Y29mZnNldCgpCiAgICAgICAgaWYgb2ZmIGlzIG5vdCBOb25lOgogICAgICAgICAgICBpZiBvZmYuZGF5cyA8IDA6CiAgICAgICAgICAgICAgICBzaWduID0gIi0iCiAgICAgICAgICAgICAgICBvZmYgPSAtb2ZmCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzaWduID0gIisiCiAgICAgICAgICAgIGhoLCBtbSA9IGRpdm1vZChvZmYsIHRpbWVkZWx0YShob3Vycz0xKSkKICAgICAgICAgICAgYXNzZXJ0IG5vdCBtbSAlIHRpbWVkZWx0YShtaW51dGVzPTEpLCAid2hvbGUgbWludXRlIgogICAgICAgICAgICBtbSAvLz0gdGltZWRlbHRhKG1pbnV0ZXM9MSkKICAgICAgICAgICAgYXNzZXJ0IDAgPD0gaGggPCAyNAogICAgICAgICAgICBvZmYgPSAiJXMlMDJkJXMlMDJkIiAlIChzaWduLCBoaCwgc2VwLCBtbSkKICAgICAgICByZXR1cm4gb2ZmCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgICIiIkNvbnZlcnQgdG8gZm9ybWFsIHN0cmluZywgZm9yIHJlcHIoKS4iIiIKICAgICAgICBpZiBzZWxmLl9taWNyb3NlY29uZCAhPSAwOgogICAgICAgICAgICBzID0gIiwgJWQsICVkIiAlIChzZWxmLl9zZWNvbmQsIHNlbGYuX21pY3Jvc2Vjb25kKQogICAgICAgIGVsaWYgc2VsZi5fc2Vjb25kICE9IDA6CiAgICAgICAgICAgIHMgPSAiLCAlZCIgJSBzZWxmLl9zZWNvbmQKICAgICAgICBlbHNlOgogICAgICAgICAgICBzID0gIiIKICAgICAgICBzPSAiJXMoJWQsICVkJXMpIiAlICgnZGF0ZXRpbWUuJyArIHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2hvdXIsIHNlbGYuX21pbnV0ZSwgcykKICAgICAgICBpZiBzZWxmLl90emluZm8gaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGFzc2VydCBzWy0xOl0gPT0gIikiCiAgICAgICAgICAgIHMgPSBzWzotMV0gKyAiLCB0emluZm89JXIiICUgc2VsZi5fdHppbmZvICsgIikiCiAgICAgICAgcmV0dXJuIHMKCiAgICBkZWYgaXNvZm9ybWF0KHNlbGYpOgogICAgICAgICIiIlJldHVybiB0aGUgdGltZSBmb3JtYXR0ZWQgYWNjb3JkaW5nIHRvIElTTy4KCiAgICAgICAgVGhpcyBpcyAnSEg6TU06U1MubW1tbW1tK3p6Onp6Jywgb3IgJ0hIOk1NOlNTK3p6Onp6JyBpZgogICAgICAgIHNlbGYubWljcm9zZWNvbmQgPT0gMC4KICAgICAgICAiIiIKICAgICAgICBzID0gX2Zvcm1hdF90aW1lKHNlbGYuX2hvdXIsIHNlbGYuX21pbnV0ZSwgc2VsZi5fc2Vjb25kLAogICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fbWljcm9zZWNvbmQpCiAgICAgICAgdHogPSBzZWxmLl90enN0cigpCiAgICAgICAgaWYgdHo6CiAgICAgICAgICAgIHMgKz0gdHoKICAgICAgICByZXR1cm4gcwoKICAgIF9fc3RyX18gPSBpc29mb3JtYXQKCiAgICBkZWYgc3RyZnRpbWUoc2VsZiwgZm10KToKICAgICAgICAiIiJGb3JtYXQgdXNpbmcgc3RyZnRpbWUoKS4gIFRoZSBkYXRlIHBhcnQgb2YgdGhlIHRpbWVzdGFtcCBwYXNzZWQKICAgICAgICB0byB1bmRlcmx5aW5nIHN0cmZ0aW1lIHNob3VsZCBub3QgYmUgdXNlZC4KICAgICAgICAiIiIKICAgICAgICAjIFRoZSB5ZWFyIG11c3QgYmUgPj0gMTAwMCBlbHNlIFB5dGhvbidzIHN0cmZ0aW1lIGltcGxlbWVudGF0aW9uCiAgICAgICAgIyBjYW4gcmFpc2UgYSBib2d1cyBleGNlcHRpb24uCiAgICAgICAgdGltZXR1cGxlID0gKDE5MDAsIDEsIDEsCiAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2hvdXIsIHNlbGYuX21pbnV0ZSwgc2VsZi5fc2Vjb25kLAogICAgICAgICAgICAgICAgICAgICAwLCAxLCAtMSkKICAgICAgICByZXR1cm4gX3dyYXBfc3RyZnRpbWUoc2VsZiwgZm10LCB0aW1ldHVwbGUpCgogICAgZGVmIF9fZm9ybWF0X18oc2VsZiwgZm10KToKICAgICAgICBpZiBsZW4oZm10KSAhPSAwOgogICAgICAgICAgICByZXR1cm4gc2VsZi5zdHJmdGltZShmbXQpCiAgICAgICAgcmV0dXJuIHN0cihzZWxmKQoKICAgICMgVGltZXpvbmUgZnVuY3Rpb25zCgogICAgZGVmIHV0Y29mZnNldChzZWxmKToKICAgICAgICAiIiJSZXR1cm4gdGhlIHRpbWV6b25lIG9mZnNldCBpbiBtaW51dGVzIGVhc3Qgb2YgVVRDIChuZWdhdGl2ZSB3ZXN0IG9mCiAgICAgICAgVVRDKS4iIiIKICAgICAgICBpZiBzZWxmLl90emluZm8gaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICBvZmZzZXQgPSBzZWxmLl90emluZm8udXRjb2Zmc2V0KE5vbmUpCiAgICAgICAgX2NoZWNrX3V0Y19vZmZzZXQoInV0Y29mZnNldCIsIG9mZnNldCkKICAgICAgICByZXR1cm4gb2Zmc2V0CgogICAgZGVmIHR6bmFtZShzZWxmKToKICAgICAgICAiIiJSZXR1cm4gdGhlIHRpbWV6b25lIG5hbWUuCgogICAgICAgIE5vdGUgdGhhdCB0aGUgbmFtZSBpcyAxMDAlIGluZm9ybWF0aW9uYWwgLS0gdGhlcmUncyBubyByZXF1aXJlbWVudCB0aGF0CiAgICAgICAgaXQgbWVhbiBhbnl0aGluZyBpbiBwYXJ0aWN1bGFyLiBGb3IgZXhhbXBsZSwgIkdNVCIsICJVVEMiLCAiLTUwMCIsCiAgICAgICAgIi01OjAwIiwgIkVEVCIsICJVUy9FYXN0ZXJuIiwgIkFtZXJpY2EvTmV3IFlvcmsiIGFyZSBhbGwgdmFsaWQgcmVwbGllcy4KICAgICAgICAiIiIKICAgICAgICBpZiBzZWxmLl90emluZm8gaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICBuYW1lID0gc2VsZi5fdHppbmZvLnR6bmFtZShOb25lKQogICAgICAgIF9jaGVja190em5hbWUobmFtZSkKICAgICAgICByZXR1cm4gbmFtZQoKICAgIGRlZiBkc3Qoc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIDAgaWYgRFNUIGlzIG5vdCBpbiBlZmZlY3QsIG9yIHRoZSBEU1Qgb2Zmc2V0IChpbiBtaW51dGVzCiAgICAgICAgZWFzdHdhcmQpIGlmIERTVCBpcyBpbiBlZmZlY3QuCgogICAgICAgIFRoaXMgaXMgcHVyZWx5IGluZm9ybWF0aW9uYWw7IHRoZSBEU1Qgb2Zmc2V0IGhhcyBhbHJlYWR5IGJlZW4gYWRkZWQgdG8KICAgICAgICB0aGUgVVRDIG9mZnNldCByZXR1cm5lZCBieSB1dGNvZmZzZXQoKSBpZiBhcHBsaWNhYmxlLCBzbyB0aGVyZSdzIG5vCiAgICAgICAgbmVlZCB0byBjb25zdWx0IGRzdCgpIHVubGVzcyB5b3UncmUgaW50ZXJlc3RlZCBpbiBkaXNwbGF5aW5nIHRoZSBEU1QKICAgICAgICBpbmZvLgogICAgICAgICIiIgogICAgICAgIGlmIHNlbGYuX3R6aW5mbyBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIG9mZnNldCA9IHNlbGYuX3R6aW5mby5kc3QoTm9uZSkKICAgICAgICBfY2hlY2tfdXRjX29mZnNldCgiZHN0Iiwgb2Zmc2V0KQogICAgICAgIHJldHVybiBvZmZzZXQKCiAgICBkZWYgcmVwbGFjZShzZWxmLCBob3VyPU5vbmUsIG1pbnV0ZT1Ob25lLCBzZWNvbmQ9Tm9uZSwgbWljcm9zZWNvbmQ9Tm9uZSwKICAgICAgICAgICAgICAgIHR6aW5mbz1UcnVlKToKICAgICAgICAiIiJSZXR1cm4gYSBuZXcgdGltZSB3aXRoIG5ldyB2YWx1ZXMgZm9yIHRoZSBzcGVjaWZpZWQgZmllbGRzLiIiIgogICAgICAgIGlmIGhvdXIgaXMgTm9uZToKICAgICAgICAgICAgaG91ciA9IHNlbGYuaG91cgogICAgICAgIGlmIG1pbnV0ZSBpcyBOb25lOgogICAgICAgICAgICBtaW51dGUgPSBzZWxmLm1pbnV0ZQogICAgICAgIGlmIHNlY29uZCBpcyBOb25lOgogICAgICAgICAgICBzZWNvbmQgPSBzZWxmLnNlY29uZAogICAgICAgIGlmIG1pY3Jvc2Vjb25kIGlzIE5vbmU6CiAgICAgICAgICAgIG1pY3Jvc2Vjb25kID0gc2VsZi5taWNyb3NlY29uZAogICAgICAgIGlmIHR6aW5mbyBpcyBUcnVlOgogICAgICAgICAgICB0emluZm8gPSBzZWxmLnR6aW5mbwogICAgICAgIF9jaGVja190aW1lX2ZpZWxkcyhob3VyLCBtaW51dGUsIHNlY29uZCwgbWljcm9zZWNvbmQpCiAgICAgICAgX2NoZWNrX3R6aW5mb19hcmcodHppbmZvKQogICAgICAgIHJldHVybiB0aW1lKGhvdXIsIG1pbnV0ZSwgc2Vjb25kLCBtaWNyb3NlY29uZCwgdHppbmZvKQoKICAgIGRlZiBfX2Jvb2xfXyhzZWxmKToKICAgICAgICBpZiBzZWxmLnNlY29uZCBvciBzZWxmLm1pY3Jvc2Vjb25kOgogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIG9mZnNldCA9IHNlbGYudXRjb2Zmc2V0KCkgb3IgdGltZWRlbHRhKDApCiAgICAgICAgcmV0dXJuIHRpbWVkZWx0YShob3Vycz1zZWxmLmhvdXIsIG1pbnV0ZXM9c2VsZi5taW51dGUpICE9IG9mZnNldAoKICAgICMgUGlja2xlIHN1cHBvcnQuCgogICAgZGVmIF9nZXRzdGF0ZShzZWxmKToKICAgICAgICB1czIsIHVzMyA9IGRpdm1vZChzZWxmLl9taWNyb3NlY29uZCwgMjU2KQogICAgICAgIHVzMSwgdXMyID0gZGl2bW9kKHVzMiwgMjU2KQogICAgICAgIGJhc2VzdGF0ZSA9IGJ5dGVzKFtzZWxmLl9ob3VyLCBzZWxmLl9taW51dGUsIHNlbGYuX3NlY29uZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgdXMxLCB1czIsIHVzM10pCiAgICAgICAgaWYgc2VsZi5fdHppbmZvIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiAoYmFzZXN0YXRlLCkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gKGJhc2VzdGF0ZSwgc2VsZi5fdHppbmZvKQoKICAgIGRlZiBfX3NldHN0YXRlKHNlbGYsIHN0cmluZywgdHppbmZvKToKICAgICAgICBpZiBsZW4oc3RyaW5nKSAhPSA2IG9yIHN0cmluZ1swXSA+PSAyNDoKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJhbiBpbnRlZ2VyIGlzIHJlcXVpcmVkIikKICAgICAgICAoc2VsZi5faG91ciwgc2VsZi5fbWludXRlLCBzZWxmLl9zZWNvbmQsCiAgICAgICAgIHVzMSwgdXMyLCB1czMpID0gc3RyaW5nCiAgICAgICAgc2VsZi5fbWljcm9zZWNvbmQgPSAoKCh1czEgPDwgOCkgfCB1czIpIDw8IDgpIHwgdXMzCiAgICAgICAgaWYgdHppbmZvIGlzIE5vbmUgb3IgaXNpbnN0YW5jZSh0emluZm8sIF90emluZm9fY2xhc3MpOgogICAgICAgICAgICBzZWxmLl90emluZm8gPSB0emluZm8KICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImJhZCB0emluZm8gc3RhdGUgYXJnICVyIiAlIHR6aW5mbykKCiAgICBkZWYgX19yZWR1Y2VfXyhzZWxmKToKICAgICAgICByZXR1cm4gKHRpbWUsIHNlbGYuX2dldHN0YXRlKCkpCgpfdGltZV9jbGFzcyA9IHRpbWUgICMgc28gZnVuY3Rpb25zIHcvIGFyZ3MgbmFtZWQgInRpbWUiIGNhbiBnZXQgYXQgdGhlIGNsYXNzCgp0aW1lLm1pbiA9IHRpbWUoMCwgMCwgMCkKdGltZS5tYXggPSB0aW1lKDIzLCA1OSwgNTksIDk5OTk5OSkKdGltZS5yZXNvbHV0aW9uID0gdGltZWRlbHRhKG1pY3Jvc2Vjb25kcz0xKQoKY2xhc3MgZGF0ZXRpbWUoZGF0ZSk6CiAgICAiIiJkYXRldGltZSh5ZWFyLCBtb250aCwgZGF5WywgaG91clssIG1pbnV0ZVssIHNlY29uZFssIG1pY3Jvc2Vjb25kWyx0emluZm9dXV1dXSkKCiAgICBUaGUgeWVhciwgbW9udGggYW5kIGRheSBhcmd1bWVudHMgYXJlIHJlcXVpcmVkLiB0emluZm8gbWF5IGJlIE5vbmUsIG9yIGFuCiAgICBpbnN0YW5jZSBvZiBhIHR6aW5mbyBzdWJjbGFzcy4gVGhlIHJlbWFpbmluZyBhcmd1bWVudHMgbWF5IGJlIGludHMgb3IgbG9uZ3MuCiAgICAiIiIKCiAgICAjZml4bWUgYnJ5dGhvbgogICAgI19fc2xvdHNfXyA9IGRhdGUuX19zbG90c19fICsgKAogICAgX19zbG90c19fID0gKCdfeWVhcicsICdfbW9udGgnLCAnX2RheScsIAogICAgICAgICAgICAgICAgICdfaG91cicsJ19taW51dGUnLCdfc2Vjb25kJywnX21pY3Jvc2Vjb25kJywnX3R6aW5mbycpCiAgICBkZWYgX19uZXdfXyhjbHMsIHllYXIsIG1vbnRoPU5vbmUsIGRheT1Ob25lLCBob3VyPTAsIG1pbnV0ZT0wLCBzZWNvbmQ9MCwKICAgICAgICAgICAgICAgIG1pY3Jvc2Vjb25kPTAsIHR6aW5mbz1Ob25lKToKICAgICAgICAgICAgIAogICAgICAgIGlmIGlzaW5zdGFuY2UoeWVhciwgYnl0ZXMpIGFuZCBsZW4oeWVhcikgPT0gMTA6CiAgICAgICAgICAgICMgUGlja2xlIHN1cHBvcnQKICAgICAgICAgICAgc2VsZiA9IGRhdGUuX19uZXdfXyhjbHMsIHllYXJbOjRdKQogICAgICAgICAgICBzZWxmLl9fc2V0c3RhdGUoeWVhciwgbW9udGgpCiAgICAgICAgICAgIHJldHVybiBzZWxmCiAgICAgICAgX2NoZWNrX3R6aW5mb19hcmcodHppbmZvKQogICAgICAgIF9jaGVja190aW1lX2ZpZWxkcyhob3VyLCBtaW51dGUsIHNlY29uZCwgbWljcm9zZWNvbmQpCiAgICAgICAgI3ByaW50KGRpcihkYXRlKSkKICAgICAgICBzZWxmID0gZGF0ZS5fX25ld19fKGNscywgeWVhciwgbW9udGgsIGRheSkKICAgICAgICBzZWxmLl9ob3VyID0gaG91cgogICAgICAgIHNlbGYuX21pbnV0ZSA9IG1pbnV0ZQogICAgICAgIHNlbGYuX3NlY29uZCA9IHNlY29uZAogICAgICAgIHNlbGYuX21pY3Jvc2Vjb25kID0gbWljcm9zZWNvbmQKICAgICAgICBzZWxmLl90emluZm8gPSB0emluZm8KICAgICAgICByZXR1cm4gc2VsZgoKICAgICMgUmVhZC1vbmx5IGZpZWxkIGFjY2Vzc29ycwogICAgQHByb3BlcnR5CiAgICBkZWYgaG91cihzZWxmKToKICAgICAgICAiIiJob3VyICgwLTIzKSIiIgogICAgICAgIHJldHVybiBzZWxmLl9ob3VyCgogICAgQHByb3BlcnR5CiAgICBkZWYgbWludXRlKHNlbGYpOgogICAgICAgICIiIm1pbnV0ZSAoMC01OSkiIiIKICAgICAgICByZXR1cm4gc2VsZi5fbWludXRlCgogICAgQHByb3BlcnR5CiAgICBkZWYgc2Vjb25kKHNlbGYpOgogICAgICAgICIiInNlY29uZCAoMC01OSkiIiIKICAgICAgICByZXR1cm4gc2VsZi5fc2Vjb25kCgogICAgQHByb3BlcnR5CiAgICBkZWYgbWljcm9zZWNvbmQoc2VsZik6CiAgICAgICAgIiIibWljcm9zZWNvbmQgKDAtOTk5OTk5KSIiIgogICAgICAgIHJldHVybiBzZWxmLl9taWNyb3NlY29uZAoKICAgIEBwcm9wZXJ0eQogICAgZGVmIHR6aW5mbyhzZWxmKToKICAgICAgICAiIiJ0aW1lem9uZSBpbmZvIG9iamVjdCIiIgogICAgICAgIHJldHVybiBzZWxmLl90emluZm8KCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBmcm9tdGltZXN0YW1wKGNscywgdCwgdHo9Tm9uZSk6CiAgICAgICAgIiIiQ29uc3RydWN0IGEgZGF0ZXRpbWUgZnJvbSBhIFBPU0lYIHRpbWVzdGFtcCAobGlrZSB0aW1lLnRpbWUoKSkuCgogICAgICAgIEEgdGltZXpvbmUgaW5mbyBvYmplY3QgbWF5IGJlIHBhc3NlZCBpbiBhcyB3ZWxsLgogICAgICAgICIiIgogICAgICAgIF9jaGVja190emluZm9fYXJnKHR6KQoKICAgICAgICBjb252ZXJ0ZXIgPSBfdGltZS5sb2NhbHRpbWUgaWYgdHogaXMgTm9uZSBlbHNlIF90aW1lLmdtdGltZQoKICAgICAgICB0LCBmcmFjID0gZGl2bW9kKHQsIDEuMCkKICAgICAgICB1cyA9IHJvdW5kKGZyYWMgKiAxZTYpCgogICAgICAgICMgSWYgdGltZXN0YW1wIGlzIGxlc3MgdGhhbiBvbmUgbWljcm9zZWNvbmQgc21hbGxlciB0aGFuIGEKICAgICAgICAjIGZ1bGwgc2Vjb25kLCB1cyBjYW4gYmUgcm91bmRlZCB1cCB0byAxMDAwMDAwLiAgSW4gdGhpcyBjYXNlLAogICAgICAgICMgcm9sbCBvdmVyIHRvIHNlY29uZHMsIG90aGVyd2lzZSwgVmFsdWVFcnJvciBpcyByYWlzZWQKICAgICAgICAjIGJ5IHRoZSBjb25zdHJ1Y3Rvci4KICAgICAgICBpZiB1cyA9PSAxMDAwMDAwOgogICAgICAgICAgICB0ICs9IDEKICAgICAgICAgICAgdXMgPSAwCiAgICAgICAgeSwgbSwgZCwgaGgsIG1tLCBzcywgd2Vla2RheSwgamRheSwgZHN0ID0gY29udmVydGVyKHQpCiAgICAgICAgc3MgPSBtaW4oc3MsIDU5KSAgICAjIGNsYW1wIG91dCBsZWFwIHNlY29uZHMgaWYgdGhlIHBsYXRmb3JtIGhhcyB0aGVtCiAgICAgICAgcmVzdWx0ID0gY2xzKHksIG0sIGQsIGhoLCBtbSwgc3MsIHVzLCB0eikKICAgICAgICBpZiB0eiBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmVzdWx0ID0gdHouZnJvbXV0YyhyZXN1bHQpCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIHV0Y2Zyb210aW1lc3RhbXAoY2xzLCB0KToKICAgICAgICAiQ29uc3RydWN0IGEgVVRDIGRhdGV0aW1lIGZyb20gYSBQT1NJWCB0aW1lc3RhbXAgKGxpa2UgdGltZS50aW1lKCkpLiIKICAgICAgICB0LCBmcmFjID0gZGl2bW9kKHQsIDEuMCkKICAgICAgICB1cyA9IHJvdW5kKGZyYWMgKiAxZTYpCgogICAgICAgICMgSWYgdGltZXN0YW1wIGlzIGxlc3MgdGhhbiBvbmUgbWljcm9zZWNvbmQgc21hbGxlciB0aGFuIGEKICAgICAgICAjIGZ1bGwgc2Vjb25kLCB1cyBjYW4gYmUgcm91bmRlZCB1cCB0byAxMDAwMDAwLiAgSW4gdGhpcyBjYXNlLAogICAgICAgICMgcm9sbCBvdmVyIHRvIHNlY29uZHMsIG90aGVyd2lzZSwgVmFsdWVFcnJvciBpcyByYWlzZWQKICAgICAgICAjIGJ5IHRoZSBjb25zdHJ1Y3Rvci4KICAgICAgICBpZiB1cyA9PSAxMDAwMDAwOgogICAgICAgICAgICB0ICs9IDEKICAgICAgICAgICAgdXMgPSAwCiAgICAgICAgeSwgbSwgZCwgaGgsIG1tLCBzcywgd2Vla2RheSwgamRheSwgZHN0ID0gX3RpbWUuZ210aW1lKHQpCiAgICAgICAgc3MgPSBtaW4oc3MsIDU5KSAgICAjIGNsYW1wIG91dCBsZWFwIHNlY29uZHMgaWYgdGhlIHBsYXRmb3JtIGhhcyB0aGVtCiAgICAgICAgcmV0dXJuIGNscyh5LCBtLCBkLCBoaCwgbW0sIHNzLCB1cykKCiAgICAjIFhYWCBUaGlzIGlzIHN1cHBvc2VkIHRvIGRvIGJldHRlciB0aGFuIHdlICpjYW4qIGRvIGJ5IHVzaW5nIHRpbWUudGltZSgpLAogICAgIyBYWFggaWYgdGhlIHBsYXRmb3JtIHN1cHBvcnRzIGEgbW9yZSBhY2N1cmF0ZSB3YXkuICBUaGUgQyBpbXBsZW1lbnRhdGlvbgogICAgIyBYWFggdXNlcyBnZXR0aW1lb2ZkYXkgb24gcGxhdGZvcm1zIHRoYXQgaGF2ZSBpdCwgYnV0IHRoYXQgaXNuJ3QKICAgICMgWFhYIGF2YWlsYWJsZSBmcm9tIFB5dGhvbi4gIFNvIG5vdygpIG1heSByZXR1cm4gZGlmZmVyZW50IHJlc3VsdHMKICAgICMgWFhYIGFjcm9zcyB0aGUgaW1wbGVtZW50YXRpb25zLgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgbm93KGNscywgdHo9Tm9uZSk6CiAgICAgICAgIkNvbnN0cnVjdCBhIGRhdGV0aW1lIGZyb20gdGltZS50aW1lKCkgYW5kIG9wdGlvbmFsIHRpbWUgem9uZSBpbmZvLiIKICAgICAgICB0ID0gX3RpbWUudGltZSgpCiAgICAgICAgcmV0dXJuIGNscy5mcm9tdGltZXN0YW1wKHQsIHR6KQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIHV0Y25vdyhjbHMpOgogICAgICAgICJDb25zdHJ1Y3QgYSBVVEMgZGF0ZXRpbWUgZnJvbSB0aW1lLnRpbWUoKS4iCiAgICAgICAgdCA9IF90aW1lLnRpbWUoKQogICAgICAgIHJldHVybiBjbHMudXRjZnJvbXRpbWVzdGFtcCh0KQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIGNvbWJpbmUoY2xzLCBkYXRlLCB0aW1lKToKICAgICAgICAiQ29uc3RydWN0IGEgZGF0ZXRpbWUgZnJvbSBhIGdpdmVuIGRhdGUgYW5kIGEgZ2l2ZW4gdGltZS4iCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoZGF0ZSwgX2RhdGVfY2xhc3MpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImRhdGUgYXJndW1lbnQgbXVzdCBiZSBhIGRhdGUgaW5zdGFuY2UiKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHRpbWUsIF90aW1lX2NsYXNzKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJ0aW1lIGFyZ3VtZW50IG11c3QgYmUgYSB0aW1lIGluc3RhbmNlIikKICAgICAgICByZXR1cm4gY2xzKGRhdGUueWVhciwgZGF0ZS5tb250aCwgZGF0ZS5kYXksCiAgICAgICAgICAgICAgICAgICB0aW1lLmhvdXIsIHRpbWUubWludXRlLCB0aW1lLnNlY29uZCwgdGltZS5taWNyb3NlY29uZCwKICAgICAgICAgICAgICAgICAgIHRpbWUudHppbmZvKQoKICAgIGRlZiB0aW1ldHVwbGUoc2VsZik6CiAgICAgICAgIlJldHVybiBsb2NhbCB0aW1lIHR1cGxlIGNvbXBhdGlibGUgd2l0aCB0aW1lLmxvY2FsdGltZSgpLiIKICAgICAgICBkc3QgPSBzZWxmLmRzdCgpCiAgICAgICAgaWYgZHN0IGlzIE5vbmU6CiAgICAgICAgICAgIGRzdCA9IC0xCiAgICAgICAgZWxpZiBkc3Q6CiAgICAgICAgICAgIGRzdCA9IDEKICAgICAgICBlbHNlOgogICAgICAgICAgICBkc3QgPSAwCiAgICAgICAgcmV0dXJuIF9idWlsZF9zdHJ1Y3RfdGltZShzZWxmLnllYXIsIHNlbGYubW9udGgsIHNlbGYuZGF5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ob3VyLCBzZWxmLm1pbnV0ZSwgc2VsZi5zZWNvbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkc3QpCgogICAgZGVmIHV0Y3RpbWV0dXBsZShzZWxmKToKICAgICAgICAiUmV0dXJuIFVUQyB0aW1lIHR1cGxlIGNvbXBhdGlibGUgd2l0aCB0aW1lLmdtdGltZSgpLiIKICAgICAgICBvZmZzZXQgPSBzZWxmLnV0Y29mZnNldCgpCiAgICAgICAgaWYgb2Zmc2V0OgogICAgICAgICAgICBzZWxmIC09IG9mZnNldAogICAgICAgIHksIG0sIGQgPSBzZWxmLnllYXIsIHNlbGYubW9udGgsIHNlbGYuZGF5CiAgICAgICAgaGgsIG1tLCBzcyA9IHNlbGYuaG91ciwgc2VsZi5taW51dGUsIHNlbGYuc2Vjb25kCiAgICAgICAgcmV0dXJuIF9idWlsZF9zdHJ1Y3RfdGltZSh5LCBtLCBkLCBoaCwgbW0sIHNzLCAwKQoKICAgIGRlZiBkYXRlKHNlbGYpOgogICAgICAgICJSZXR1cm4gdGhlIGRhdGUgcGFydC4iCiAgICAgICAgcmV0dXJuIGRhdGUoc2VsZi5feWVhciwgc2VsZi5fbW9udGgsIHNlbGYuX2RheSkKCiAgICBkZWYgdGltZShzZWxmKToKICAgICAgICAiUmV0dXJuIHRoZSB0aW1lIHBhcnQsIHdpdGggdHppbmZvIE5vbmUuIgogICAgICAgIHJldHVybiB0aW1lKHNlbGYuaG91ciwgc2VsZi5taW51dGUsIHNlbGYuc2Vjb25kLCBzZWxmLm1pY3Jvc2Vjb25kKQoKICAgIGRlZiB0aW1ldHooc2VsZik6CiAgICAgICAgIlJldHVybiB0aGUgdGltZSBwYXJ0LCB3aXRoIHNhbWUgdHppbmZvLiIKICAgICAgICByZXR1cm4gdGltZShzZWxmLmhvdXIsIHNlbGYubWludXRlLCBzZWxmLnNlY29uZCwgc2VsZi5taWNyb3NlY29uZCwKICAgICAgICAgICAgICAgICAgICBzZWxmLl90emluZm8pCgogICAgZGVmIHJlcGxhY2Uoc2VsZiwgeWVhcj1Ob25lLCBtb250aD1Ob25lLCBkYXk9Tm9uZSwgaG91cj1Ob25lLAogICAgICAgICAgICAgICAgbWludXRlPU5vbmUsIHNlY29uZD1Ob25lLCBtaWNyb3NlY29uZD1Ob25lLCB0emluZm89VHJ1ZSk6CiAgICAgICAgIiIiUmV0dXJuIGEgbmV3IGRhdGV0aW1lIHdpdGggbmV3IHZhbHVlcyBmb3IgdGhlIHNwZWNpZmllZCBmaWVsZHMuIiIiCiAgICAgICAgaWYgeWVhciBpcyBOb25lOgogICAgICAgICAgICB5ZWFyID0gc2VsZi55ZWFyCiAgICAgICAgaWYgbW9udGggaXMgTm9uZToKICAgICAgICAgICAgbW9udGggPSBzZWxmLm1vbnRoCiAgICAgICAgaWYgZGF5IGlzIE5vbmU6CiAgICAgICAgICAgIGRheSA9IHNlbGYuZGF5CiAgICAgICAgaWYgaG91ciBpcyBOb25lOgogICAgICAgICAgICBob3VyID0gc2VsZi5ob3VyCiAgICAgICAgaWYgbWludXRlIGlzIE5vbmU6CiAgICAgICAgICAgIG1pbnV0ZSA9IHNlbGYubWludXRlCiAgICAgICAgaWYgc2Vjb25kIGlzIE5vbmU6CiAgICAgICAgICAgIHNlY29uZCA9IHNlbGYuc2Vjb25kCiAgICAgICAgaWYgbWljcm9zZWNvbmQgaXMgTm9uZToKICAgICAgICAgICAgbWljcm9zZWNvbmQgPSBzZWxmLm1pY3Jvc2Vjb25kCiAgICAgICAgaWYgdHppbmZvIGlzIFRydWU6CiAgICAgICAgICAgIHR6aW5mbyA9IHNlbGYudHppbmZvCiAgICAgICAgX2NoZWNrX2RhdGVfZmllbGRzKHllYXIsIG1vbnRoLCBkYXkpCiAgICAgICAgX2NoZWNrX3RpbWVfZmllbGRzKGhvdXIsIG1pbnV0ZSwgc2Vjb25kLCBtaWNyb3NlY29uZCkKICAgICAgICBfY2hlY2tfdHppbmZvX2FyZyh0emluZm8pCiAgICAgICAgcmV0dXJuIGRhdGV0aW1lKHllYXIsIG1vbnRoLCBkYXksIGhvdXIsIG1pbnV0ZSwgc2Vjb25kLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1pY3Jvc2Vjb25kLCB0emluZm8pCgogICAgZGVmIGFzdGltZXpvbmUoc2VsZiwgdHopOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHR6LCB0emluZm8pOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoInR6IGFyZ3VtZW50IG11c3QgYmUgYW4gaW5zdGFuY2Ugb2YgdHppbmZvIikKCiAgICAgICAgbXl0eiA9IHNlbGYudHppbmZvCiAgICAgICAgaWYgbXl0eiBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJhc3RpbWV6b25lKCkgcmVxdWlyZXMgYW4gYXdhcmUgZGF0ZXRpbWUiKQoKICAgICAgICBpZiB0eiBpcyBteXR6OgogICAgICAgICAgICByZXR1cm4gc2VsZgoKICAgICAgICAjIENvbnZlcnQgc2VsZiB0byBVVEMsIGFuZCBhdHRhY2ggdGhlIG5ldyB0aW1lIHpvbmUgb2JqZWN0LgogICAgICAgIG15b2Zmc2V0ID0gc2VsZi51dGNvZmZzZXQoKQogICAgICAgIGlmIG15b2Zmc2V0IGlzIE5vbmU6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImFzdGltZXpvbmUoKSByZXF1aXJlcyBhbiBhd2FyZSBkYXRldGltZSIpCiAgICAgICAgdXRjID0gKHNlbGYgLSBteW9mZnNldCkucmVwbGFjZSh0emluZm89dHopCgogICAgICAgICMgQ29udmVydCBmcm9tIFVUQyB0byB0eidzIGxvY2FsIHRpbWUuCiAgICAgICAgcmV0dXJuIHR6LmZyb211dGModXRjKQoKICAgICMgV2F5cyB0byBwcm9kdWNlIGEgc3RyaW5nLgoKICAgIGRlZiBjdGltZShzZWxmKToKICAgICAgICAiUmV0dXJuIGN0aW1lKCkgc3R5bGUgc3RyaW5nLiIKICAgICAgICB3ZWVrZGF5ID0gc2VsZi50b29yZGluYWwoKSAlIDcgb3IgNwogICAgICAgIHJldHVybiAiJXMgJXMgJTJkICUwMmQ6JTAyZDolMDJkICUwNGQiICUgKAogICAgICAgICAgICBfREFZTkFNRVNbd2Vla2RheV0sCiAgICAgICAgICAgIF9NT05USE5BTUVTW3NlbGYuX21vbnRoXSwKICAgICAgICAgICAgc2VsZi5fZGF5LAogICAgICAgICAgICBzZWxmLl9ob3VyLCBzZWxmLl9taW51dGUsIHNlbGYuX3NlY29uZCwKICAgICAgICAgICAgc2VsZi5feWVhcikKCiAgICBkZWYgaXNvZm9ybWF0KHNlbGYsIHNlcD0nVCcpOgogICAgICAgICIiIlJldHVybiB0aGUgdGltZSBmb3JtYXR0ZWQgYWNjb3JkaW5nIHRvIElTTy4KCiAgICAgICAgVGhpcyBpcyAnWVlZWS1NTS1ERCBISDpNTTpTUy5tbW1tbW0nLCBvciAnWVlZWS1NTS1ERCBISDpNTTpTUycgaWYKICAgICAgICBzZWxmLm1pY3Jvc2Vjb25kID09IDAuCgogICAgICAgIElmIHNlbGYudHppbmZvIGlzIG5vdCBOb25lLCB0aGUgVVRDIG9mZnNldCBpcyBhbHNvIGF0dGFjaGVkLCBnaXZpbmcKICAgICAgICAnWVlZWS1NTS1ERCBISDpNTTpTUy5tbW1tbW0rSEg6TU0nIG9yICdZWVlZLU1NLUREIEhIOk1NOlNTK0hIOk1NJy4KCiAgICAgICAgT3B0aW9uYWwgYXJndW1lbnQgc2VwIHNwZWNpZmllcyB0aGUgc2VwYXJhdG9yIGJldHdlZW4gZGF0ZSBhbmQKICAgICAgICB0aW1lLCBkZWZhdWx0ICdUJy4KICAgICAgICAiIiIKICAgICAgICBzID0gKCIlMDRkLSUwMmQtJTAyZCVjIiAlIChzZWxmLl95ZWFyLCBzZWxmLl9tb250aCwgc2VsZi5fZGF5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VwKSArCiAgICAgICAgICAgICAgICBfZm9ybWF0X3RpbWUoc2VsZi5faG91ciwgc2VsZi5fbWludXRlLCBzZWxmLl9zZWNvbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fbWljcm9zZWNvbmQpKQogICAgICAgIG9mZiA9IHNlbGYudXRjb2Zmc2V0KCkKICAgICAgICBpZiBvZmYgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGlmIG9mZi5kYXlzIDwgMDoKICAgICAgICAgICAgICAgIHNpZ24gPSAiLSIKICAgICAgICAgICAgICAgIG9mZiA9IC1vZmYKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNpZ24gPSAiKyIKICAgICAgICAgICAgaGgsIG1tID0gZGl2bW9kKG9mZiwgdGltZWRlbHRhKGhvdXJzPTEpKQogICAgICAgICAgICBhc3NlcnQgbm90IG1tICUgdGltZWRlbHRhKG1pbnV0ZXM9MSksICJ3aG9sZSBtaW51dGUiCiAgICAgICAgICAgIG1tIC8vPSB0aW1lZGVsdGEobWludXRlcz0xKQogICAgICAgICAgICBzICs9ICIlcyUwMmQ6JTAyZCIgJSAoc2lnbiwgaGgsIG1tKQogICAgICAgIHJldHVybiBzCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgICIiIkNvbnZlcnQgdG8gZm9ybWFsIHN0cmluZywgZm9yIHJlcHIoKS4iIiIKICAgICAgICBMID0gW3NlbGYuX3llYXIsIHNlbGYuX21vbnRoLCBzZWxmLl9kYXksICMgVGhlc2UgYXJlIG5ldmVyIHplcm8KICAgICAgICAgICAgIHNlbGYuX2hvdXIsIHNlbGYuX21pbnV0ZSwgc2VsZi5fc2Vjb25kLCBzZWxmLl9taWNyb3NlY29uZF0KICAgICAgICBpZiBMWy0xXSA9PSAwOgogICAgICAgICAgICBkZWwgTFstMV0KICAgICAgICBpZiBMWy0xXSA9PSAwOgogICAgICAgICAgICBkZWwgTFstMV0KICAgICAgICBzID0gIiwgIi5qb2luKG1hcChzdHIsIEwpKQogICAgICAgIHMgPSAiJXMoJXMpIiAlICgnZGF0ZXRpbWUuJyArIHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLCBzKQogICAgICAgIGlmIHNlbGYuX3R6aW5mbyBpcyBub3QgTm9uZToKICAgICAgICAgICAgYXNzZXJ0IHNbLTE6XSA9PSAiKSIKICAgICAgICAgICAgcyA9IHNbOi0xXSArICIsIHR6aW5mbz0lciIgJSBzZWxmLl90emluZm8gKyAiKSIKICAgICAgICByZXR1cm4gcwoKICAgIGRlZiBfX3N0cl9fKHNlbGYpOgogICAgICAgICJDb252ZXJ0IHRvIHN0cmluZywgZm9yIHN0cigpLiIKICAgICAgICByZXR1cm4gc2VsZi5pc29mb3JtYXQoc2VwPScgJykKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBzdHJwdGltZShjbHMsIGRhdGVfc3RyaW5nLCBmb3JtYXQpOgogICAgICAgICdzdHJpbmcsIGZvcm1hdCAtPiBuZXcgZGF0ZXRpbWUgcGFyc2VkIGZyb20gYSBzdHJpbmcgKGxpa2UgdGltZS5zdHJwdGltZSgpKS4nCiAgICAgICAgaW1wb3J0IF9zdHJwdGltZQogICAgICAgIHJldHVybiBfc3RycHRpbWUuX3N0cnB0aW1lX2RhdGV0aW1lKGNscywgZGF0ZV9zdHJpbmcsIGZvcm1hdCkKCiAgICBkZWYgdXRjb2Zmc2V0KHNlbGYpOgogICAgICAgICIiIlJldHVybiB0aGUgdGltZXpvbmUgb2Zmc2V0IGluIG1pbnV0ZXMgZWFzdCBvZiBVVEMgKG5lZ2F0aXZlIHdlc3Qgb2YKICAgICAgICBVVEMpLiIiIgogICAgICAgIGlmIHNlbGYuX3R6aW5mbyBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIG9mZnNldCA9IHNlbGYuX3R6aW5mby51dGNvZmZzZXQoc2VsZikKICAgICAgICBfY2hlY2tfdXRjX29mZnNldCgidXRjb2Zmc2V0Iiwgb2Zmc2V0KQogICAgICAgIHJldHVybiBvZmZzZXQKCiAgICBkZWYgdHpuYW1lKHNlbGYpOgogICAgICAgICIiIlJldHVybiB0aGUgdGltZXpvbmUgbmFtZS4KCiAgICAgICAgTm90ZSB0aGF0IHRoZSBuYW1lIGlzIDEwMCUgaW5mb3JtYXRpb25hbCAtLSB0aGVyZSdzIG5vIHJlcXVpcmVtZW50IHRoYXQKICAgICAgICBpdCBtZWFuIGFueXRoaW5nIGluIHBhcnRpY3VsYXIuIEZvciBleGFtcGxlLCAiR01UIiwgIlVUQyIsICItNTAwIiwKICAgICAgICAiLTU6MDAiLCAiRURUIiwgIlVTL0Vhc3Rlcm4iLCAiQW1lcmljYS9OZXcgWW9yayIgYXJlIGFsbCB2YWxpZCByZXBsaWVzLgogICAgICAgICIiIgogICAgICAgIG5hbWUgPSBfY2FsbF90emluZm9fbWV0aG9kKHNlbGYuX3R6aW5mbywgInR6bmFtZSIsIHNlbGYpCiAgICAgICAgX2NoZWNrX3R6bmFtZShuYW1lKQogICAgICAgIHJldHVybiBuYW1lCgogICAgZGVmIGRzdChzZWxmKToKICAgICAgICAiIiJSZXR1cm4gMCBpZiBEU1QgaXMgbm90IGluIGVmZmVjdCwgb3IgdGhlIERTVCBvZmZzZXQgKGluIG1pbnV0ZXMKICAgICAgICBlYXN0d2FyZCkgaWYgRFNUIGlzIGluIGVmZmVjdC4KCiAgICAgICAgVGhpcyBpcyBwdXJlbHkgaW5mb3JtYXRpb25hbDsgdGhlIERTVCBvZmZzZXQgaGFzIGFscmVhZHkgYmVlbiBhZGRlZCB0bwogICAgICAgIHRoZSBVVEMgb2Zmc2V0IHJldHVybmVkIGJ5IHV0Y29mZnNldCgpIGlmIGFwcGxpY2FibGUsIHNvIHRoZXJlJ3Mgbm8KICAgICAgICBuZWVkIHRvIGNvbnN1bHQgZHN0KCkgdW5sZXNzIHlvdSdyZSBpbnRlcmVzdGVkIGluIGRpc3BsYXlpbmcgdGhlIERTVAogICAgICAgIGluZm8uCiAgICAgICAgIiIiCiAgICAgICAgaWYgc2VsZi5fdHppbmZvIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgb2Zmc2V0ID0gc2VsZi5fdHppbmZvLmRzdChzZWxmKQogICAgICAgIF9jaGVja191dGNfb2Zmc2V0KCJkc3QiLCBvZmZzZXQpCiAgICAgICAgcmV0dXJuIG9mZnNldAoKICAgICMgQ29tcGFyaXNvbnMgb2YgZGF0ZXRpbWUgb2JqZWN0cyB3aXRoIG90aGVyLgoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIGRhdGV0aW1lKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NtcChvdGhlcikgPT0gMAogICAgICAgIGVsaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIGRhdGUpOgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgX19uZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkYXRldGltZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpICE9IDAKICAgICAgICBlbGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBkYXRlKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgX19sZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkYXRldGltZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpIDw9IDAKICAgICAgICBlbGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBkYXRlKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgZWxzZToKICAgICAgICAgICAgX2NtcGVycm9yKHNlbGYsIG90aGVyKQoKICAgIGRlZiBfX2x0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIGRhdGV0aW1lKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NtcChvdGhlcikgPCAwCiAgICAgICAgZWxpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgZGF0ZSk6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIF9jbXBlcnJvcihzZWxmLCBvdGhlcikKCiAgICBkZWYgX19nZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkYXRldGltZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9jbXAob3RoZXIpID49IDAKICAgICAgICBlbGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBkYXRlKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgZWxzZToKICAgICAgICAgICAgX2NtcGVycm9yKHNlbGYsIG90aGVyKQoKICAgIGRlZiBfX2d0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIGRhdGV0aW1lKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NtcChvdGhlcikgPiAwCiAgICAgICAgZWxpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgZGF0ZSk6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIF9jbXBlcnJvcihzZWxmLCBvdGhlcikKCiAgICBkZWYgX2NtcChzZWxmLCBvdGhlcik6CiAgICAgICAgYXNzZXJ0IGlzaW5zdGFuY2Uob3RoZXIsIGRhdGV0aW1lKQogICAgICAgIG15dHogPSBzZWxmLl90emluZm8KICAgICAgICBvdHR6ID0gb3RoZXIuX3R6aW5mbwogICAgICAgIG15b2ZmID0gb3RvZmYgPSBOb25lCgogICAgICAgIGlmIG15dHogaXMgb3R0ejoKICAgICAgICAgICAgYmFzZV9jb21wYXJlID0gVHJ1ZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIG15dHogaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBteW9mZiA9IHNlbGYudXRjb2Zmc2V0KCkKICAgICAgICAgICAgaWYgb3R0eiBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIG90b2ZmID0gb3RoZXIudXRjb2Zmc2V0KCkKICAgICAgICAgICAgYmFzZV9jb21wYXJlID0gbXlvZmYgPT0gb3RvZmYKCiAgICAgICAgaWYgYmFzZV9jb21wYXJlOgogICAgICAgICAgICAjZml4bWUgYnJ5dGhvbgogICAgICAgICAgICAjcmV0dXJuIF9jbXAoKHNlbGYuX3llYXIsIHNlbGYuX21vbnRoLCBzZWxmLl9kYXksCiAgICAgICAgICAgICMgICAgICAgICAgICAgc2VsZi5faG91ciwgc2VsZi5fbWludXRlLCBzZWxmLl9zZWNvbmQsCiAgICAgICAgICAgICMgICAgICAgICAgICAgc2VsZi5fbWljcm9zZWNvbmQpLAogICAgICAgICAgICAjICAgICAgICAgICAob3RoZXIuX3llYXIsIG90aGVyLl9tb250aCwgb3RoZXIuX2RheSwKICAgICAgICAgICAgIyAgICAgICAgICAgIG90aGVyLl9ob3VyLCBvdGhlci5fbWludXRlLCBvdGhlci5fc2Vjb25kLAogICAgICAgICAgICAjICAgICAgICAgICAgb3RoZXIuX21pY3Jvc2Vjb25kKSkKICAgICAgICAgICAgcmV0dXJuIF90dXBsZV9jbXAoKHNlbGYuX3llYXIsIHNlbGYuX21vbnRoLCBzZWxmLl9kYXksCiAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9ob3VyLCBzZWxmLl9taW51dGUsIHNlbGYuX3NlY29uZCwKICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX21pY3Jvc2Vjb25kKSwKICAgICAgICAgICAgICAgICAgICAgICAob3RoZXIuX3llYXIsIG90aGVyLl9tb250aCwgb3RoZXIuX2RheSwKICAgICAgICAgICAgICAgICAgICAgICAgb3RoZXIuX2hvdXIsIG90aGVyLl9taW51dGUsIG90aGVyLl9zZWNvbmQsCiAgICAgICAgICAgICAgICAgICAgICAgIG90aGVyLl9taWNyb3NlY29uZCkpCiAgICAgICAgaWYgbXlvZmYgaXMgTm9uZSBvciBvdG9mZiBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImNhbm5vdCBjb21wYXJlIG5haXZlIGFuZCBhd2FyZSBkYXRldGltZXMiKQogICAgICAgICMgWFhYIFdoYXQgZm9sbG93cyBjb3VsZCBiZSBkb25lIG1vcmUgZWZmaWNpZW50bHkuLi4KICAgICAgICBkaWZmID0gc2VsZiAtIG90aGVyICAgICAjIHRoaXMgd2lsbCB0YWtlIG9mZnNldHMgaW50byBhY2NvdW50CiAgICAgICAgaWYgZGlmZi5kYXlzIDwgMDoKICAgICAgICAgICAgcmV0dXJuIC0xCiAgICAgICAgcmV0dXJuIGRpZmYgYW5kIDEgb3IgMAoKICAgIGRlZiBfX2FkZF9fKHNlbGYsIG90aGVyKToKICAgICAgICAiQWRkIGEgZGF0ZXRpbWUgYW5kIGEgdGltZWRlbHRhLiIKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgdGltZWRlbHRhKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgZGVsdGEgPSB0aW1lZGVsdGEoc2VsZi50b29yZGluYWwoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICBob3Vycz1zZWxmLl9ob3VyLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1pbnV0ZXM9c2VsZi5fbWludXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZHM9c2VsZi5fc2Vjb25kLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1pY3Jvc2Vjb25kcz1zZWxmLl9taWNyb3NlY29uZCkKICAgICAgICBkZWx0YSArPSBvdGhlcgogICAgICAgIGhvdXIsIHJlbSA9IGRpdm1vZChkZWx0YS5zZWNvbmRzLCAzNjAwKQogICAgICAgIG1pbnV0ZSwgc2Vjb25kID0gZGl2bW9kKHJlbSwgNjApCiAgICAgICAgaWYgMCA8IGRlbHRhLmRheXMgPD0gX01BWE9SRElOQUw6CiAgICAgICAgICAgIHJldHVybiBkYXRldGltZS5jb21iaW5lKGRhdGUuZnJvbW9yZGluYWwoZGVsdGEuZGF5cyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWUoaG91ciwgbWludXRlLCBzZWNvbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGEubWljcm9zZWNvbmRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR6aW5mbz1zZWxmLl90emluZm8pKQogICAgICAgIHJhaXNlIE92ZXJmbG93RXJyb3IoInJlc3VsdCBvdXQgb2YgcmFuZ2UiKQoKICAgIF9fcmFkZF9fID0gX19hZGRfXwoKICAgIGRlZiBfX3N1Yl9fKHNlbGYsIG90aGVyKToKICAgICAgICAiU3VidHJhY3QgdHdvIGRhdGV0aW1lcywgb3IgYSBkYXRldGltZSBhbmQgYSB0aW1lZGVsdGEuIgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBkYXRldGltZSk6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIHRpbWVkZWx0YSk6CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZiArIC1vdGhlcgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICAgICAgZGF5czEgPSBzZWxmLnRvb3JkaW5hbCgpCiAgICAgICAgZGF5czIgPSBvdGhlci50b29yZGluYWwoKQogICAgICAgIHNlY3MxID0gc2VsZi5fc2Vjb25kICsgc2VsZi5fbWludXRlICogNjAgKyBzZWxmLl9ob3VyICogMzYwMAogICAgICAgIHNlY3MyID0gb3RoZXIuX3NlY29uZCArIG90aGVyLl9taW51dGUgKiA2MCArIG90aGVyLl9ob3VyICogMzYwMAogICAgICAgIGJhc2UgPSB0aW1lZGVsdGEoZGF5czEgLSBkYXlzMiwKICAgICAgICAgICAgICAgICAgICAgICAgIHNlY3MxIC0gc2VjczIsCiAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9taWNyb3NlY29uZCAtIG90aGVyLl9taWNyb3NlY29uZCkKICAgICAgICBpZiBzZWxmLl90emluZm8gaXMgb3RoZXIuX3R6aW5mbzoKICAgICAgICAgICAgcmV0dXJuIGJhc2UKICAgICAgICBteW9mZiA9IHNlbGYudXRjb2Zmc2V0KCkKICAgICAgICBvdG9mZiA9IG90aGVyLnV0Y29mZnNldCgpCiAgICAgICAgaWYgbXlvZmYgPT0gb3RvZmY6CiAgICAgICAgICAgIHJldHVybiBiYXNlCiAgICAgICAgaWYgbXlvZmYgaXMgTm9uZSBvciBvdG9mZiBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImNhbm5vdCBtaXggbmFpdmUgYW5kIHRpbWV6b25lLWF3YXJlIHRpbWUiKQogICAgICAgIHJldHVybiBiYXNlICsgb3RvZmYgLSBteW9mZgoKICAgIGRlZiBfX2hhc2hfXyhzZWxmKToKICAgICAgICB0em9mZiA9IHNlbGYudXRjb2Zmc2V0KCkKICAgICAgICBpZiB0em9mZiBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gaGFzaChzZWxmLl9nZXRzdGF0ZSgpWzBdKQogICAgICAgIGRheXMgPSBfeW1kMm9yZChzZWxmLnllYXIsIHNlbGYubW9udGgsIHNlbGYuZGF5KQogICAgICAgIHNlY29uZHMgPSBzZWxmLmhvdXIgKiAzNjAwICsgc2VsZi5taW51dGUgKiA2MCArIHNlbGYuc2Vjb25kCiAgICAgICAgcmV0dXJuIGhhc2godGltZWRlbHRhKGRheXMsIHNlY29uZHMsIHNlbGYubWljcm9zZWNvbmQpIC0gdHpvZmYpCgogICAgIyBQaWNrbGUgc3VwcG9ydC4KCiAgICBkZWYgX2dldHN0YXRlKHNlbGYpOgogICAgICAgIHloaSwgeWxvID0gZGl2bW9kKHNlbGYuX3llYXIsIDI1NikKICAgICAgICB1czIsIHVzMyA9IGRpdm1vZChzZWxmLl9taWNyb3NlY29uZCwgMjU2KQogICAgICAgIHVzMSwgdXMyID0gZGl2bW9kKHVzMiwgMjU2KQogICAgICAgIGJhc2VzdGF0ZSA9IGJ5dGVzKFt5aGksIHlsbywgc2VsZi5fbW9udGgsIHNlbGYuX2RheSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5faG91ciwgc2VsZi5fbWludXRlLCBzZWxmLl9zZWNvbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzMSwgdXMyLCB1czNdKQogICAgICAgIGlmIHNlbGYuX3R6aW5mbyBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gKGJhc2VzdGF0ZSwpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIChiYXNlc3RhdGUsIHNlbGYuX3R6aW5mbykKCiAgICBkZWYgX19zZXRzdGF0ZShzZWxmLCBzdHJpbmcsIHR6aW5mbyk6CiAgICAgICAgKHloaSwgeWxvLCBzZWxmLl9tb250aCwgc2VsZi5fZGF5LCBzZWxmLl9ob3VyLAogICAgICAgICBzZWxmLl9taW51dGUsIHNlbGYuX3NlY29uZCwgdXMxLCB1czIsIHVzMykgPSBzdHJpbmcKICAgICAgICBzZWxmLl95ZWFyID0geWhpICogMjU2ICsgeWxvCiAgICAgICAgc2VsZi5fbWljcm9zZWNvbmQgPSAoKCh1czEgPDwgOCkgfCB1czIpIDw8IDgpIHwgdXMzCiAgICAgICAgaWYgdHppbmZvIGlzIE5vbmUgb3IgaXNpbnN0YW5jZSh0emluZm8sIF90emluZm9fY2xhc3MpOgogICAgICAgICAgICBzZWxmLl90emluZm8gPSB0emluZm8KICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImJhZCB0emluZm8gc3RhdGUgYXJnICVyIiAlIHR6aW5mbykKCiAgICBkZWYgX19yZWR1Y2VfXyhzZWxmKToKICAgICAgICByZXR1cm4gKHNlbGYuX19jbGFzc19fLCBzZWxmLl9nZXRzdGF0ZSgpKQoKI2ZpeG1lIGJyeXRob24KI2RhdGV0aW1lLm1pbiA9IGRhdGV0aW1lKDEsIDEsIDEpCiNkYXRldGltZS5tYXggPSBkYXRldGltZSg5OTk5LCAxMiwgMzEsIDIzLCA1OSwgNTksIDk5OTk5OSkKI2RhdGV0aW1lLnJlc29sdXRpb24gPSB0aW1lZGVsdGEobWljcm9zZWNvbmRzPTEpCgoKZGVmIF9pc293ZWVrMW1vbmRheSh5ZWFyKToKICAgICMgSGVscGVyIHRvIGNhbGN1bGF0ZSB0aGUgZGF5IG51bWJlciBvZiB0aGUgTW9uZGF5IHN0YXJ0aW5nIHdlZWsgMQogICAgIyBYWFggVGhpcyBjb3VsZCBiZSBkb25lIG1vcmUgZWZmaWNpZW50bHkKICAgIFRIVVJTREFZID0gMwogICAgZmlyc3RkYXkgPSBfeW1kMm9yZCh5ZWFyLCAxLCAxKQogICAgZmlyc3R3ZWVrZGF5ID0gKGZpcnN0ZGF5ICsgNikgJSA3ICMgU2VlIHdlZWtkYXkoKSBhYm92ZQogICAgd2VlazFtb25kYXkgPSBmaXJzdGRheSAtIGZpcnN0d2Vla2RheQogICAgaWYgZmlyc3R3ZWVrZGF5ID4gVEhVUlNEQVk6CiAgICAgICAgd2VlazFtb25kYXkgKz0gNwogICAgcmV0dXJuIHdlZWsxbW9uZGF5CgpjbGFzcyB0aW1lem9uZSh0emluZm8pOgogICAgX19zbG90c19fID0gJ19vZmZzZXQnLCAnX25hbWUnCgogICAgIyBTZW50aW5lbCB2YWx1ZSB0byBkaXNhbGxvdyBOb25lCiAgICBfT21pdHRlZCA9IG9iamVjdCgpCiAgICAjZml4bWUgYnJ5dGhvbgogICAgI2RlZiBfX25ld19fKGNscywgb2Zmc2V0LCBuYW1lPV9PbWl0dGVkKToKICAgIGRlZiBfX25ld19fKGNscywgb2Zmc2V0LCBuYW1lPU5vbmUpOgogICAgICAgIGlmIG5hbWUgaXMgTm9uZToKICAgICAgICAgICBuYW1lPV9PbWl0dGVkCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob2Zmc2V0LCB0aW1lZGVsdGEpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIm9mZnNldCBtdXN0IGJlIGEgdGltZWRlbHRhIikKICAgICAgICBpZiBuYW1lIGlzIGNscy5fT21pdHRlZDoKICAgICAgICAgICAgaWYgbm90IG9mZnNldDoKICAgICAgICAgICAgICAgIHJldHVybiBjbHMudXRjCiAgICAgICAgICAgIG5hbWUgPSBOb25lCiAgICAgICAgZWxpZiBub3QgaXNpbnN0YW5jZShuYW1lLCBzdHIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIm5hbWUgbXVzdCBiZSBhIHN0cmluZyIpCiAgICAgICAgaWYgbm90IGNscy5fbWlub2Zmc2V0IDw9IG9mZnNldCA8PSBjbHMuX21heG9mZnNldDoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigib2Zmc2V0IG11c3QgYmUgYSB0aW1lZGVsdGEiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBzdHJpY3RseSBiZXR3ZWVuIC10aW1lZGVsdGEoaG91cnM9MjQpIGFuZCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIHRpbWVkZWx0YShob3Vycz0yNCkuIikKICAgICAgICBpZiAob2Zmc2V0Lm1pY3Jvc2Vjb25kcyAhPSAwIG9yCiAgICAgICAgICAgIG9mZnNldC5zZWNvbmRzICUgNjAgIT0gMCk6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIm9mZnNldCBtdXN0IGJlIGEgdGltZWRlbHRhIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgcmVwcmVzZW50aW5nIGEgd2hvbGUgbnVtYmVyIG9mIG1pbnV0ZXMiKQogICAgICAgIHJldHVybiBjbHMuX2NyZWF0ZShvZmZzZXQsIG5hbWUpCgogICAgI0BjbGFzc21ldGhvZAogICAgZGVmIF9jcmVhdGUoY2xzLCBvZmZzZXQsIG5hbWU9Tm9uZSk6CiAgICAgICAgc2VsZiA9IHR6aW5mby5fX25ld19fKGNscykKICAgICAgICBzZWxmLl9vZmZzZXQgPSBvZmZzZXQKICAgICAgICBzZWxmLl9uYW1lID0gbmFtZQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fZ2V0aW5pdGFyZ3NfXyhzZWxmKToKICAgICAgICAiIiJwaWNrbGUgc3VwcG9ydCIiIgogICAgICAgIGlmIHNlbGYuX25hbWUgaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIChzZWxmLl9vZmZzZXQsKQogICAgICAgIHJldHVybiAoc2VsZi5fb2Zmc2V0LCBzZWxmLl9uYW1lKQoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIHR5cGUob3RoZXIpICE9IHRpbWV6b25lOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICByZXR1cm4gc2VsZi5fb2Zmc2V0ID09IG90aGVyLl9vZmZzZXQKCiAgICBkZWYgX19oYXNoX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGhhc2goc2VsZi5fb2Zmc2V0KQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICAiIiJDb252ZXJ0IHRvIGZvcm1hbCBzdHJpbmcsIGZvciByZXByKCkuCgogICAgICAgID4+PiB0eiA9IHRpbWV6b25lLnV0YwogICAgICAgID4+PiByZXByKHR6KQogICAgICAgICdkYXRldGltZS50aW1lem9uZS51dGMnCiAgICAgICAgPj4+IHR6ID0gdGltZXpvbmUodGltZWRlbHRhKGhvdXJzPS01KSwgJ0VTVCcpCiAgICAgICAgPj4+IHJlcHIodHopCiAgICAgICAgImRhdGV0aW1lLnRpbWV6b25lKGRhdGV0aW1lLnRpbWVkZWx0YSgtMSwgNjg0MDApLCAnRVNUJykiCiAgICAgICAgIiIiCiAgICAgICAgaWYgc2VsZiBpcyBzZWxmLnV0YzoKICAgICAgICAgICAgcmV0dXJuICdkYXRldGltZS50aW1lem9uZS51dGMnCiAgICAgICAgaWYgc2VsZi5fbmFtZSBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gIiVzKCVyKSIgJSAoJ2RhdGV0aW1lLicgKyBzZWxmLl9fY2xhc3NfXy5fX25hbWVfXywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX29mZnNldCkKICAgICAgICByZXR1cm4gIiVzKCVyLCAlcikiICUgKCdkYXRldGltZS4nICsgc2VsZi5fX2NsYXNzX18uX19uYW1lX18sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9vZmZzZXQsIHNlbGYuX25hbWUpCgogICAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYudHpuYW1lKE5vbmUpCgogICAgZGVmIHV0Y29mZnNldChzZWxmLCBkdCk6CiAgICAgICAgaWYgaXNpbnN0YW5jZShkdCwgZGF0ZXRpbWUpIG9yIGR0IGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9vZmZzZXQKICAgICAgICByYWlzZSBUeXBlRXJyb3IoInV0Y29mZnNldCgpIGFyZ3VtZW50IG11c3QgYmUgYSBkYXRldGltZSBpbnN0YW5jZSIKICAgICAgICAgICAgICAgICAgICAgICAgIiBvciBOb25lIikKCiAgICBkZWYgdHpuYW1lKHNlbGYsIGR0KToKICAgICAgICBpZiBpc2luc3RhbmNlKGR0LCBkYXRldGltZSkgb3IgZHQgaXMgTm9uZToKICAgICAgICAgICAgaWYgc2VsZi5fbmFtZSBpcyBOb25lOgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX25hbWVfZnJvbV9vZmZzZXQoc2VsZi5fb2Zmc2V0KQogICAgICAgICAgICByZXR1cm4gc2VsZi5fbmFtZQogICAgICAgIHJhaXNlIFR5cGVFcnJvcigidHpuYW1lKCkgYXJndW1lbnQgbXVzdCBiZSBhIGRhdGV0aW1lIGluc3RhbmNlIgogICAgICAgICAgICAgICAgICAgICAgICAiIG9yIE5vbmUiKQoKICAgIGRlZiBkc3Qoc2VsZiwgZHQpOgogICAgICAgIGlmIGlzaW5zdGFuY2UoZHQsIGRhdGV0aW1lKSBvciBkdCBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiZHN0KCkgYXJndW1lbnQgbXVzdCBiZSBhIGRhdGV0aW1lIGluc3RhbmNlIgogICAgICAgICAgICAgICAgICAgICAgICAiIG9yIE5vbmUiKQoKICAgIGRlZiBmcm9tdXRjKHNlbGYsIGR0KToKICAgICAgICBpZiBpc2luc3RhbmNlKGR0LCBkYXRldGltZSk6CiAgICAgICAgICAgIGlmIGR0LnR6aW5mbyBpcyBub3Qgc2VsZjoKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImZyb211dGM6IGR0LnR6aW5mbyAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJpcyBub3Qgc2VsZiIpCiAgICAgICAgICAgIHJldHVybiBkdCArIHNlbGYuX29mZnNldAogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiZnJvbXV0YygpIGFyZ3VtZW50IG11c3QgYmUgYSBkYXRldGltZSBpbnN0YW5jZSIKICAgICAgICAgICAgICAgICAgICAgICAgIiBvciBOb25lIikKCiAgICAjX21heG9mZnNldCA9IHRpbWVkZWx0YShob3Vycz0yMywgbWludXRlcz01OSkKICAgICNfbWlub2Zmc2V0ID0gLV9tYXhvZmZzZXQKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX25hbWVfZnJvbV9vZmZzZXQoZGVsdGEpOgogICAgICAgIGlmIGRlbHRhIDwgdGltZWRlbHRhKDApOgogICAgICAgICAgICBzaWduID0gJy0nCiAgICAgICAgICAgIGRlbHRhID0gLWRlbHRhCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2lnbiA9ICcrJwogICAgICAgIGhvdXJzLCByZXN0ID0gZGl2bW9kKGRlbHRhLCB0aW1lZGVsdGEoaG91cnM9MSkpCiAgICAgICAgbWludXRlcyA9IHJlc3QgLy8gdGltZWRlbHRhKG1pbnV0ZXM9MSkKICAgICAgICByZXR1cm4gJ1VUQ3t9ezowMmR9Ons6MDJkfScuZm9ybWF0KHNpZ24sIGhvdXJzLCBtaW51dGVzKQoKI2ZpeG1lIGJyeXRob24KI3RpbWV6b25lLnV0YyA9IHRpbWV6b25lLl9jcmVhdGUodGltZWRlbHRhKDApKQojdGltZXpvbmUubWluID0gdGltZXpvbmUuX2NyZWF0ZSh0aW1lem9uZS5fbWlub2Zmc2V0KQojdGltZXpvbmUubWF4ID0gdGltZXpvbmUuX2NyZWF0ZSh0aW1lem9uZS5fbWF4b2Zmc2V0KQoK',
'/Lib/difflib.py':'IyEgL3Vzci9iaW4vZW52IHB5dGhvbjMKCiIiIgpNb2R1bGUgZGlmZmxpYiAtLSBoZWxwZXJzIGZvciBjb21wdXRpbmcgZGVsdGFzIGJldHdlZW4gb2JqZWN0cy4KCkZ1bmN0aW9uIGdldF9jbG9zZV9tYXRjaGVzKHdvcmQsIHBvc3NpYmlsaXRpZXMsIG49MywgY3V0b2ZmPTAuNik6CiAgICBVc2UgU2VxdWVuY2VNYXRjaGVyIHRvIHJldHVybiBsaXN0IG9mIHRoZSBiZXN0ICJnb29kIGVub3VnaCIgbWF0Y2hlcy4KCkZ1bmN0aW9uIGNvbnRleHRfZGlmZihhLCBiKToKICAgIEZvciB0d28gbGlzdHMgb2Ygc3RyaW5ncywgcmV0dXJuIGEgZGVsdGEgaW4gY29udGV4dCBkaWZmIGZvcm1hdC4KCkZ1bmN0aW9uIG5kaWZmKGEsIGIpOgogICAgUmV0dXJuIGEgZGVsdGE6IHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gYGFgIGFuZCBgYmAgKGxpc3RzIG9mIHN0cmluZ3MpLgoKRnVuY3Rpb24gcmVzdG9yZShkZWx0YSwgd2hpY2gpOgogICAgUmV0dXJuIG9uZSBvZiB0aGUgdHdvIHNlcXVlbmNlcyB0aGF0IGdlbmVyYXRlZCBhbiBuZGlmZiBkZWx0YS4KCkZ1bmN0aW9uIHVuaWZpZWRfZGlmZihhLCBiKToKICAgIEZvciB0d28gbGlzdHMgb2Ygc3RyaW5ncywgcmV0dXJuIGEgZGVsdGEgaW4gdW5pZmllZCBkaWZmIGZvcm1hdC4KCkNsYXNzIFNlcXVlbmNlTWF0Y2hlcjoKICAgIEEgZmxleGlibGUgY2xhc3MgZm9yIGNvbXBhcmluZyBwYWlycyBvZiBzZXF1ZW5jZXMgb2YgYW55IHR5cGUuCgpDbGFzcyBEaWZmZXI6CiAgICBGb3IgcHJvZHVjaW5nIGh1bWFuLXJlYWRhYmxlIGRlbHRhcyBmcm9tIHNlcXVlbmNlcyBvZiBsaW5lcyBvZiB0ZXh0LgoKQ2xhc3MgSHRtbERpZmY6CiAgICBGb3IgcHJvZHVjaW5nIEhUTUwgc2lkZSBieSBzaWRlIGNvbXBhcmlzb24gd2l0aCBjaGFuZ2UgaGlnaGxpZ2h0cy4KIiIiCgpfX2FsbF9fID0gWydnZXRfY2xvc2VfbWF0Y2hlcycsICduZGlmZicsICdyZXN0b3JlJywgJ1NlcXVlbmNlTWF0Y2hlcicsCiAgICAgICAgICAgJ0RpZmZlcicsJ0lTX0NIQVJBQ1RFUl9KVU5LJywgJ0lTX0xJTkVfSlVOSycsICdjb250ZXh0X2RpZmYnLAogICAgICAgICAgICd1bmlmaWVkX2RpZmYnLCAnSHRtbERpZmYnLCAnTWF0Y2gnXQoKaW1wb3J0IHdhcm5pbmdzCmltcG9ydCBoZWFwcQpmcm9tIGNvbGxlY3Rpb25zIGltcG9ydCBuYW1lZHR1cGxlIGFzIF9uYW1lZHR1cGxlCgpNYXRjaCA9IF9uYW1lZHR1cGxlKCdNYXRjaCcsICdhIGIgc2l6ZScpCgpkZWYgX2NhbGN1bGF0ZV9yYXRpbyhtYXRjaGVzLCBsZW5ndGgpOgogICAgaWYgbGVuZ3RoOgogICAgICAgIHJldHVybiAyLjAgKiBtYXRjaGVzIC8gbGVuZ3RoCiAgICByZXR1cm4gMS4wCgpjbGFzcyBTZXF1ZW5jZU1hdGNoZXI6CgogICAgIiIiCiAgICBTZXF1ZW5jZU1hdGNoZXIgaXMgYSBmbGV4aWJsZSBjbGFzcyBmb3IgY29tcGFyaW5nIHBhaXJzIG9mIHNlcXVlbmNlcyBvZgogICAgYW55IHR5cGUsIHNvIGxvbmcgYXMgdGhlIHNlcXVlbmNlIGVsZW1lbnRzIGFyZSBoYXNoYWJsZS4gIFRoZSBiYXNpYwogICAgYWxnb3JpdGhtIHByZWRhdGVzLCBhbmQgaXMgYSBsaXR0bGUgZmFuY2llciB0aGFuLCBhbiBhbGdvcml0aG0KICAgIHB1Ymxpc2hlZCBpbiB0aGUgbGF0ZSAxOTgwJ3MgYnkgUmF0Y2xpZmYgYW5kIE9iZXJzaGVscCB1bmRlciB0aGUKICAgIGh5cGVyYm9saWMgbmFtZSAiZ2VzdGFsdCBwYXR0ZXJuIG1hdGNoaW5nIi4gIFRoZSBiYXNpYyBpZGVhIGlzIHRvIGZpbmQKICAgIHRoZSBsb25nZXN0IGNvbnRpZ3VvdXMgbWF0Y2hpbmcgc3Vic2VxdWVuY2UgdGhhdCBjb250YWlucyBubyAianVuayIKICAgIGVsZW1lbnRzIChSLU8gZG9lc24ndCBhZGRyZXNzIGp1bmspLiAgVGhlIHNhbWUgaWRlYSBpcyB0aGVuIGFwcGxpZWQKICAgIHJlY3Vyc2l2ZWx5IHRvIHRoZSBwaWVjZXMgb2YgdGhlIHNlcXVlbmNlcyB0byB0aGUgbGVmdCBhbmQgdG8gdGhlIHJpZ2h0CiAgICBvZiB0aGUgbWF0Y2hpbmcgc3Vic2VxdWVuY2UuICBUaGlzIGRvZXMgbm90IHlpZWxkIG1pbmltYWwgZWRpdAogICAgc2VxdWVuY2VzLCBidXQgZG9lcyB0ZW5kIHRvIHlpZWxkIG1hdGNoZXMgdGhhdCAibG9vayByaWdodCIgdG8gcGVvcGxlLgoKICAgIFNlcXVlbmNlTWF0Y2hlciB0cmllcyB0byBjb21wdXRlIGEgImh1bWFuLWZyaWVuZGx5IGRpZmYiIGJldHdlZW4gdHdvCiAgICBzZXF1ZW5jZXMuICBVbmxpa2UgZS5nLiBVTklYKHRtKSBkaWZmLCB0aGUgZnVuZGFtZW50YWwgbm90aW9uIGlzIHRoZQogICAgbG9uZ2VzdCAqY29udGlndW91cyogJiBqdW5rLWZyZWUgbWF0Y2hpbmcgc3Vic2VxdWVuY2UuICBUaGF0J3Mgd2hhdAogICAgY2F0Y2hlcyBwZW9wbGVzJyBleWVzLiAgVGhlIFdpbmRvd3ModG0pIHdpbmRpZmYgaGFzIGFub3RoZXIgaW50ZXJlc3RpbmcKICAgIG5vdGlvbiwgcGFpcmluZyB1cCBlbGVtZW50cyB0aGF0IGFwcGVhciB1bmlxdWVseSBpbiBlYWNoIHNlcXVlbmNlLgogICAgVGhhdCwgYW5kIHRoZSBtZXRob2QgaGVyZSwgYXBwZWFyIHRvIHlpZWxkIG1vcmUgaW50dWl0aXZlIGRpZmZlcmVuY2UKICAgIHJlcG9ydHMgdGhhbiBkb2VzIGRpZmYuICBUaGlzIG1ldGhvZCBhcHBlYXJzIHRvIGJlIHRoZSBsZWFzdCB2dWxuZXJhYmxlCiAgICB0byBzeW5jaGluZyB1cCBvbiBibG9ja3Mgb2YgImp1bmsgbGluZXMiLCB0aG91Z2ggKGxpa2UgYmxhbmsgbGluZXMgaW4KICAgIG9yZGluYXJ5IHRleHQgZmlsZXMsIG9yIG1heWJlICI8UD4iIGxpbmVzIGluIEhUTUwgZmlsZXMpLiAgVGhhdCBtYXkgYmUKICAgIGJlY2F1c2UgdGhpcyBpcyB0aGUgb25seSBtZXRob2Qgb2YgdGhlIDMgdGhhdCBoYXMgYSAqY29uY2VwdCogb2YKICAgICJqdW5rIiA8d2luaz4uCgogICAgRXhhbXBsZSwgY29tcGFyaW5nIHR3byBzdHJpbmdzLCBhbmQgY29uc2lkZXJpbmcgYmxhbmtzIHRvIGJlICJqdW5rIjoKCiAgICA+Pj4gcyA9IFNlcXVlbmNlTWF0Y2hlcihsYW1iZGEgeDogeCA9PSAiICIsCiAgICAuLi4gICAgICAgICAgICAgICAgICAgICAicHJpdmF0ZSBUaHJlYWQgY3VycmVudFRocmVhZDsiLAogICAgLi4uICAgICAgICAgICAgICAgICAgICAgInByaXZhdGUgdm9sYXRpbGUgVGhyZWFkIGN1cnJlbnRUaHJlYWQ7IikKICAgID4+PgoKICAgIC5yYXRpbygpIHJldHVybnMgYSBmbG9hdCBpbiBbMCwgMV0sIG1lYXN1cmluZyB0aGUgInNpbWlsYXJpdHkiIG9mIHRoZQogICAgc2VxdWVuY2VzLiAgQXMgYSBydWxlIG9mIHRodW1iLCBhIC5yYXRpbygpIHZhbHVlIG92ZXIgMC42IG1lYW5zIHRoZQogICAgc2VxdWVuY2VzIGFyZSBjbG9zZSBtYXRjaGVzOgoKICAgID4+PiBwcmludChyb3VuZChzLnJhdGlvKCksIDMpKQogICAgMC44NjYKICAgID4+PgoKICAgIElmIHlvdSdyZSBvbmx5IGludGVyZXN0ZWQgaW4gd2hlcmUgdGhlIHNlcXVlbmNlcyBtYXRjaCwKICAgIC5nZXRfbWF0Y2hpbmdfYmxvY2tzKCkgaXMgaGFuZHk6CgogICAgPj4+IGZvciBibG9jayBpbiBzLmdldF9tYXRjaGluZ19ibG9ja3MoKToKICAgIC4uLiAgICAgcHJpbnQoImFbJWRdIGFuZCBiWyVkXSBtYXRjaCBmb3IgJWQgZWxlbWVudHMiICUgYmxvY2spCiAgICBhWzBdIGFuZCBiWzBdIG1hdGNoIGZvciA4IGVsZW1lbnRzCiAgICBhWzhdIGFuZCBiWzE3XSBtYXRjaCBmb3IgMjEgZWxlbWVudHMKICAgIGFbMjldIGFuZCBiWzM4XSBtYXRjaCBmb3IgMCBlbGVtZW50cwoKICAgIE5vdGUgdGhhdCB0aGUgbGFzdCB0dXBsZSByZXR1cm5lZCBieSAuZ2V0X21hdGNoaW5nX2Jsb2NrcygpIGlzIGFsd2F5cyBhCiAgICBkdW1teSwgKGxlbihhKSwgbGVuKGIpLCAwKSwgYW5kIHRoaXMgaXMgdGhlIG9ubHkgY2FzZSBpbiB3aGljaCB0aGUgbGFzdAogICAgdHVwbGUgZWxlbWVudCAobnVtYmVyIG9mIGVsZW1lbnRzIG1hdGNoZWQpIGlzIDAuCgogICAgSWYgeW91IHdhbnQgdG8ga25vdyBob3cgdG8gY2hhbmdlIHRoZSBmaXJzdCBzZXF1ZW5jZSBpbnRvIHRoZSBzZWNvbmQsCiAgICB1c2UgLmdldF9vcGNvZGVzKCk6CgogICAgPj4+IGZvciBvcGNvZGUgaW4gcy5nZXRfb3Bjb2RlcygpOgogICAgLi4uICAgICBwcmludCgiJTZzIGFbJWQ6JWRdIGJbJWQ6JWRdIiAlIG9wY29kZSkKICAgICBlcXVhbCBhWzA6OF0gYlswOjhdCiAgICBpbnNlcnQgYVs4OjhdIGJbODoxN10KICAgICBlcXVhbCBhWzg6MjldIGJbMTc6MzhdCgogICAgU2VlIHRoZSBEaWZmZXIgY2xhc3MgZm9yIGEgZmFuY3kgaHVtYW4tZnJpZW5kbHkgZmlsZSBkaWZmZXJlbmNlciwgd2hpY2gKICAgIHVzZXMgU2VxdWVuY2VNYXRjaGVyIGJvdGggdG8gY29tcGFyZSBzZXF1ZW5jZXMgb2YgbGluZXMsIGFuZCB0byBjb21wYXJlCiAgICBzZXF1ZW5jZXMgb2YgY2hhcmFjdGVycyB3aXRoaW4gc2ltaWxhciAobmVhci1tYXRjaGluZykgbGluZXMuCgogICAgU2VlIGFsc28gZnVuY3Rpb24gZ2V0X2Nsb3NlX21hdGNoZXMoKSBpbiB0aGlzIG1vZHVsZSwgd2hpY2ggc2hvd3MgaG93CiAgICBzaW1wbGUgY29kZSBidWlsZGluZyBvbiBTZXF1ZW5jZU1hdGNoZXIgY2FuIGJlIHVzZWQgdG8gZG8gdXNlZnVsIHdvcmsuCgogICAgVGltaW5nOiAgQmFzaWMgUi1PIGlzIGN1YmljIHRpbWUgd29yc3QgY2FzZSBhbmQgcXVhZHJhdGljIHRpbWUgZXhwZWN0ZWQKICAgIGNhc2UuICBTZXF1ZW5jZU1hdGNoZXIgaXMgcXVhZHJhdGljIHRpbWUgZm9yIHRoZSB3b3JzdCBjYXNlIGFuZCBoYXMKICAgIGV4cGVjdGVkLWNhc2UgYmVoYXZpb3IgZGVwZW5kZW50IGluIGEgY29tcGxpY2F0ZWQgd2F5IG9uIGhvdyBtYW55CiAgICBlbGVtZW50cyB0aGUgc2VxdWVuY2VzIGhhdmUgaW4gY29tbW9uOyBiZXN0IGNhc2UgdGltZSBpcyBsaW5lYXIuCgogICAgTWV0aG9kczoKCiAgICBfX2luaXRfXyhpc2p1bms9Tm9uZSwgYT0nJywgYj0nJykKICAgICAgICBDb25zdHJ1Y3QgYSBTZXF1ZW5jZU1hdGNoZXIuCgogICAgc2V0X3NlcXMoYSwgYikKICAgICAgICBTZXQgdGhlIHR3byBzZXF1ZW5jZXMgdG8gYmUgY29tcGFyZWQuCgogICAgc2V0X3NlcTEoYSkKICAgICAgICBTZXQgdGhlIGZpcnN0IHNlcXVlbmNlIHRvIGJlIGNvbXBhcmVkLgoKICAgIHNldF9zZXEyKGIpCiAgICAgICAgU2V0IHRoZSBzZWNvbmQgc2VxdWVuY2UgdG8gYmUgY29tcGFyZWQuCgogICAgZmluZF9sb25nZXN0X21hdGNoKGFsbywgYWhpLCBibG8sIGJoaSkKICAgICAgICBGaW5kIGxvbmdlc3QgbWF0Y2hpbmcgYmxvY2sgaW4gYVthbG86YWhpXSBhbmQgYltibG86YmhpXS4KCiAgICBnZXRfbWF0Y2hpbmdfYmxvY2tzKCkKICAgICAgICBSZXR1cm4gbGlzdCBvZiB0cmlwbGVzIGRlc2NyaWJpbmcgbWF0Y2hpbmcgc3Vic2VxdWVuY2VzLgoKICAgIGdldF9vcGNvZGVzKCkKICAgICAgICBSZXR1cm4gbGlzdCBvZiA1LXR1cGxlcyBkZXNjcmliaW5nIGhvdyB0byB0dXJuIGEgaW50byBiLgoKICAgIHJhdGlvKCkKICAgICAgICBSZXR1cm4gYSBtZWFzdXJlIG9mIHRoZSBzZXF1ZW5jZXMnIHNpbWlsYXJpdHkgKGZsb2F0IGluIFswLDFdKS4KCiAgICBxdWlja19yYXRpbygpCiAgICAgICAgUmV0dXJuIGFuIHVwcGVyIGJvdW5kIG9uIC5yYXRpbygpIHJlbGF0aXZlbHkgcXVpY2tseS4KCiAgICByZWFsX3F1aWNrX3JhdGlvKCkKICAgICAgICBSZXR1cm4gYW4gdXBwZXIgYm91bmQgb24gcmF0aW8oKSB2ZXJ5IHF1aWNrbHkuCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaXNqdW5rPU5vbmUsIGE9JycsIGI9JycsIGF1dG9qdW5rPVRydWUpOgogICAgICAgICIiIkNvbnN0cnVjdCBhIFNlcXVlbmNlTWF0Y2hlci4KCiAgICAgICAgT3B0aW9uYWwgYXJnIGlzanVuayBpcyBOb25lICh0aGUgZGVmYXVsdCksIG9yIGEgb25lLWFyZ3VtZW50CiAgICAgICAgZnVuY3Rpb24gdGhhdCB0YWtlcyBhIHNlcXVlbmNlIGVsZW1lbnQgYW5kIHJldHVybnMgdHJ1ZSBpZmYgdGhlCiAgICAgICAgZWxlbWVudCBpcyBqdW5rLiAgTm9uZSBpcyBlcXVpdmFsZW50IHRvIHBhc3NpbmcgImxhbWJkYSB4OiAwIiwgaS5lLgogICAgICAgIG5vIGVsZW1lbnRzIGFyZSBjb25zaWRlcmVkIHRvIGJlIGp1bmsuICBGb3IgZXhhbXBsZSwgcGFzcwogICAgICAgICAgICBsYW1iZGEgeDogeCBpbiAiIFxcdCIKICAgICAgICBpZiB5b3UncmUgY29tcGFyaW5nIGxpbmVzIGFzIHNlcXVlbmNlcyBvZiBjaGFyYWN0ZXJzLCBhbmQgZG9uJ3QKICAgICAgICB3YW50IHRvIHN5bmNoIHVwIG9uIGJsYW5rcyBvciBoYXJkIHRhYnMuCgogICAgICAgIE9wdGlvbmFsIGFyZyBhIGlzIHRoZSBmaXJzdCBvZiB0d28gc2VxdWVuY2VzIHRvIGJlIGNvbXBhcmVkLiAgQnkKICAgICAgICBkZWZhdWx0LCBhbiBlbXB0eSBzdHJpbmcuICBUaGUgZWxlbWVudHMgb2YgYSBtdXN0IGJlIGhhc2hhYmxlLiAgU2VlCiAgICAgICAgYWxzbyAuc2V0X3NlcXMoKSBhbmQgLnNldF9zZXExKCkuCgogICAgICAgIE9wdGlvbmFsIGFyZyBiIGlzIHRoZSBzZWNvbmQgb2YgdHdvIHNlcXVlbmNlcyB0byBiZSBjb21wYXJlZC4gIEJ5CiAgICAgICAgZGVmYXVsdCwgYW4gZW1wdHkgc3RyaW5nLiAgVGhlIGVsZW1lbnRzIG9mIGIgbXVzdCBiZSBoYXNoYWJsZS4gU2VlCiAgICAgICAgYWxzbyAuc2V0X3NlcXMoKSBhbmQgLnNldF9zZXEyKCkuCgogICAgICAgIE9wdGlvbmFsIGFyZyBhdXRvanVuayBzaG91bGQgYmUgc2V0IHRvIEZhbHNlIHRvIGRpc2FibGUgdGhlCiAgICAgICAgImF1dG9tYXRpYyBqdW5rIGhldXJpc3RpYyIgdGhhdCB0cmVhdHMgcG9wdWxhciBlbGVtZW50cyBhcyBqdW5rCiAgICAgICAgKHNlZSBtb2R1bGUgZG9jdW1lbnRhdGlvbiBmb3IgbW9yZSBpbmZvcm1hdGlvbikuCiAgICAgICAgIiIiCgogICAgICAgICMgTWVtYmVyczoKICAgICAgICAjIGEKICAgICAgICAjICAgICAgZmlyc3Qgc2VxdWVuY2UKICAgICAgICAjIGIKICAgICAgICAjICAgICAgc2Vjb25kIHNlcXVlbmNlOyBkaWZmZXJlbmNlcyBhcmUgY29tcHV0ZWQgYXMgIndoYXQgZG8KICAgICAgICAjICAgICAgd2UgbmVlZCB0byBkbyB0byAnYScgdG8gY2hhbmdlIGl0IGludG8gJ2InPyIKICAgICAgICAjIGIyagogICAgICAgICMgICAgICBmb3IgeCBpbiBiLCBiMmpbeF0gaXMgYSBsaXN0IG9mIHRoZSBpbmRpY2VzIChpbnRvIGIpCiAgICAgICAgIyAgICAgIGF0IHdoaWNoIHggYXBwZWFyczsganVuayBhbmQgcG9wdWxhciBlbGVtZW50cyBkbyBub3QgYXBwZWFyCiAgICAgICAgIyBmdWxsYmNvdW50CiAgICAgICAgIyAgICAgIGZvciB4IGluIGIsIGZ1bGxiY291bnRbeF0gPT0gdGhlIG51bWJlciBvZiB0aW1lcyB4CiAgICAgICAgIyAgICAgIGFwcGVhcnMgaW4gYjsgb25seSBtYXRlcmlhbGl6ZWQgaWYgcmVhbGx5IG5lZWRlZCAodXNlZAogICAgICAgICMgICAgICBvbmx5IGZvciBjb21wdXRpbmcgcXVpY2tfcmF0aW8oKSkKICAgICAgICAjIG1hdGNoaW5nX2Jsb2NrcwogICAgICAgICMgICAgICBhIGxpc3Qgb2YgKGksIGosIGspIHRyaXBsZXMsIHdoZXJlIGFbaTppK2tdID09IGJbajpqK2tdOwogICAgICAgICMgICAgICBhc2NlbmRpbmcgJiBub24tb3ZlcmxhcHBpbmcgaW4gaSBhbmQgaW4gajsgdGVybWluYXRlZCBieQogICAgICAgICMgICAgICBhIGR1bW15IChsZW4oYSksIGxlbihiKSwgMCkgc2VudGluZWwKICAgICAgICAjIG9wY29kZXMKICAgICAgICAjICAgICAgYSBsaXN0IG9mICh0YWcsIGkxLCBpMiwgajEsIGoyKSB0dXBsZXMsIHdoZXJlIHRhZyBpcwogICAgICAgICMgICAgICBvbmUgb2YKICAgICAgICAjICAgICAgICAgICdyZXBsYWNlJyAgIGFbaTE6aTJdIHNob3VsZCBiZSByZXBsYWNlZCBieSBiW2oxOmoyXQogICAgICAgICMgICAgICAgICAgJ2RlbGV0ZScgICAgYVtpMTppMl0gc2hvdWxkIGJlIGRlbGV0ZWQKICAgICAgICAjICAgICAgICAgICdpbnNlcnQnICAgIGJbajE6ajJdIHNob3VsZCBiZSBpbnNlcnRlZAogICAgICAgICMgICAgICAgICAgJ2VxdWFsJyAgICAgYVtpMTppMl0gPT0gYltqMTpqMl0KICAgICAgICAjIGlzanVuawogICAgICAgICMgICAgICBhIHVzZXItc3VwcGxpZWQgZnVuY3Rpb24gdGFraW5nIGEgc2VxdWVuY2UgZWxlbWVudCBhbmQKICAgICAgICAjICAgICAgcmV0dXJuaW5nIHRydWUgaWZmIHRoZSBlbGVtZW50IGlzICJqdW5rIiAtLSB0aGlzIGhhcwogICAgICAgICMgICAgICBzdWJ0bGUgYnV0IGhlbHBmdWwgZWZmZWN0cyBvbiB0aGUgYWxnb3JpdGhtLCB3aGljaCBJJ2xsCiAgICAgICAgIyAgICAgIGdldCBhcm91bmQgdG8gd3JpdGluZyB1cCBzb21lZGF5IDwwLjkgd2luaz4uCiAgICAgICAgIyAgICAgIERPTidUIFVTRSEgIE9ubHkgX19jaGFpbl9iIHVzZXMgdGhpcy4gIFVzZSAiaW4gc2VsZi5ianVuayIuCiAgICAgICAgIyBianVuawogICAgICAgICMgICAgICB0aGUgaXRlbXMgaW4gYiBmb3Igd2hpY2ggaXNqdW5rIGlzIFRydWUuCiAgICAgICAgIyBicG9wdWxhcgogICAgICAgICMgICAgICBub25qdW5rIGl0ZW1zIGluIGIgdHJlYXRlZCBhcyBqdW5rIGJ5IHRoZSBoZXVyaXN0aWMgKGlmIHVzZWQpLgoKICAgICAgICBzZWxmLmlzanVuayA9IGlzanVuawogICAgICAgIHNlbGYuYSA9IHNlbGYuYiA9IE5vbmUKICAgICAgICBzZWxmLmF1dG9qdW5rID0gYXV0b2p1bmsKICAgICAgICBzZWxmLnNldF9zZXFzKGEsIGIpCgogICAgZGVmIHNldF9zZXFzKHNlbGYsIGEsIGIpOgogICAgICAgICIiIlNldCB0aGUgdHdvIHNlcXVlbmNlcyB0byBiZSBjb21wYXJlZC4KCiAgICAgICAgPj4+IHMgPSBTZXF1ZW5jZU1hdGNoZXIoKQogICAgICAgID4+PiBzLnNldF9zZXFzKCJhYmNkIiwgImJjZGUiKQogICAgICAgID4+PiBzLnJhdGlvKCkKICAgICAgICAwLjc1CiAgICAgICAgIiIiCgogICAgICAgIHNlbGYuc2V0X3NlcTEoYSkKICAgICAgICBzZWxmLnNldF9zZXEyKGIpCgogICAgZGVmIHNldF9zZXExKHNlbGYsIGEpOgogICAgICAgICIiIlNldCB0aGUgZmlyc3Qgc2VxdWVuY2UgdG8gYmUgY29tcGFyZWQuCgogICAgICAgIFRoZSBzZWNvbmQgc2VxdWVuY2UgdG8gYmUgY29tcGFyZWQgaXMgbm90IGNoYW5nZWQuCgogICAgICAgID4+PiBzID0gU2VxdWVuY2VNYXRjaGVyKE5vbmUsICJhYmNkIiwgImJjZGUiKQogICAgICAgID4+PiBzLnJhdGlvKCkKICAgICAgICAwLjc1CiAgICAgICAgPj4+IHMuc2V0X3NlcTEoImJjZGUiKQogICAgICAgID4+PiBzLnJhdGlvKCkKICAgICAgICAxLjAKICAgICAgICA+Pj4KCiAgICAgICAgU2VxdWVuY2VNYXRjaGVyIGNvbXB1dGVzIGFuZCBjYWNoZXMgZGV0YWlsZWQgaW5mb3JtYXRpb24gYWJvdXQgdGhlCiAgICAgICAgc2Vjb25kIHNlcXVlbmNlLCBzbyBpZiB5b3Ugd2FudCB0byBjb21wYXJlIG9uZSBzZXF1ZW5jZSBTIGFnYWluc3QKICAgICAgICBtYW55IHNlcXVlbmNlcywgdXNlIC5zZXRfc2VxMihTKSBvbmNlIGFuZCBjYWxsIC5zZXRfc2VxMSh4KQogICAgICAgIHJlcGVhdGVkbHkgZm9yIGVhY2ggb2YgdGhlIG90aGVyIHNlcXVlbmNlcy4KCiAgICAgICAgU2VlIGFsc28gc2V0X3NlcXMoKSBhbmQgc2V0X3NlcTIoKS4KICAgICAgICAiIiIKCiAgICAgICAgaWYgYSBpcyBzZWxmLmE6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIHNlbGYuYSA9IGEKICAgICAgICBzZWxmLm1hdGNoaW5nX2Jsb2NrcyA9IHNlbGYub3Bjb2RlcyA9IE5vbmUKCiAgICBkZWYgc2V0X3NlcTIoc2VsZiwgYik6CiAgICAgICAgIiIiU2V0IHRoZSBzZWNvbmQgc2VxdWVuY2UgdG8gYmUgY29tcGFyZWQuCgogICAgICAgIFRoZSBmaXJzdCBzZXF1ZW5jZSB0byBiZSBjb21wYXJlZCBpcyBub3QgY2hhbmdlZC4KCiAgICAgICAgPj4+IHMgPSBTZXF1ZW5jZU1hdGNoZXIoTm9uZSwgImFiY2QiLCAiYmNkZSIpCiAgICAgICAgPj4+IHMucmF0aW8oKQogICAgICAgIDAuNzUKICAgICAgICA+Pj4gcy5zZXRfc2VxMigiYWJjZCIpCiAgICAgICAgPj4+IHMucmF0aW8oKQogICAgICAgIDEuMAogICAgICAgID4+PgoKICAgICAgICBTZXF1ZW5jZU1hdGNoZXIgY29tcHV0ZXMgYW5kIGNhY2hlcyBkZXRhaWxlZCBpbmZvcm1hdGlvbiBhYm91dCB0aGUKICAgICAgICBzZWNvbmQgc2VxdWVuY2UsIHNvIGlmIHlvdSB3YW50IHRvIGNvbXBhcmUgb25lIHNlcXVlbmNlIFMgYWdhaW5zdAogICAgICAgIG1hbnkgc2VxdWVuY2VzLCB1c2UgLnNldF9zZXEyKFMpIG9uY2UgYW5kIGNhbGwgLnNldF9zZXExKHgpCiAgICAgICAgcmVwZWF0ZWRseSBmb3IgZWFjaCBvZiB0aGUgb3RoZXIgc2VxdWVuY2VzLgoKICAgICAgICBTZWUgYWxzbyBzZXRfc2VxcygpIGFuZCBzZXRfc2VxMSgpLgogICAgICAgICIiIgoKICAgICAgICBpZiBiIGlzIHNlbGYuYjoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgc2VsZi5iID0gYgogICAgICAgIHNlbGYubWF0Y2hpbmdfYmxvY2tzID0gc2VsZi5vcGNvZGVzID0gTm9uZQogICAgICAgIHNlbGYuZnVsbGJjb3VudCA9IE5vbmUKICAgICAgICBzZWxmLl9fY2hhaW5fYigpCgogICAgIyBGb3IgZWFjaCBlbGVtZW50IHggaW4gYiwgc2V0IGIyalt4XSB0byBhIGxpc3Qgb2YgdGhlIGluZGljZXMgaW4KICAgICMgYiB3aGVyZSB4IGFwcGVhcnM7IHRoZSBpbmRpY2VzIGFyZSBpbiBpbmNyZWFzaW5nIG9yZGVyOyBub3RlIHRoYXQKICAgICMgdGhlIG51bWJlciBvZiB0aW1lcyB4IGFwcGVhcnMgaW4gYiBpcyBsZW4oYjJqW3hdKSAuLi4KICAgICMgd2hlbiBzZWxmLmlzanVuayBpcyBkZWZpbmVkLCBqdW5rIGVsZW1lbnRzIGRvbid0IHNob3cgdXAgaW4gdGhpcwogICAgIyBtYXAgYXQgYWxsLCB3aGljaCBzdG9wcyB0aGUgY2VudHJhbCBmaW5kX2xvbmdlc3RfbWF0Y2ggbWV0aG9kCiAgICAjIGZyb20gc3RhcnRpbmcgYW55IG1hdGNoaW5nIGJsb2NrIGF0IGEganVuayBlbGVtZW50IC4uLgogICAgIyBiMmogYWxzbyBkb2VzIG5vdCBjb250YWluIGVudHJpZXMgZm9yICJwb3B1bGFyIiBlbGVtZW50cywgbWVhbmluZwogICAgIyBlbGVtZW50cyB0aGF0IGFjY291bnQgZm9yIG1vcmUgdGhhbiAxICsgMSUgb2YgdGhlIHRvdGFsIGVsZW1lbnRzLCBhbmQKICAgICMgd2hlbiB0aGUgc2VxdWVuY2UgaXMgcmVhc29uYWJseSBsYXJnZSAoPj0gMjAwIGVsZW1lbnRzKTsgdGhpcyBjYW4KICAgICMgYmUgdmlld2VkIGFzIGFuIGFkYXB0aXZlIG5vdGlvbiBvZiBzZW1pLWp1bmssIGFuZCB5aWVsZHMgYW4gZW5vcm1vdXMKICAgICMgc3BlZWR1cCB3aGVuLCBlLmcuLCBjb21wYXJpbmcgcHJvZ3JhbSBmaWxlcyB3aXRoIGh1bmRyZWRzIG9mCiAgICAjIGluc3RhbmNlcyBvZiAicmV0dXJuIE5VTEw7IiAuLi4KICAgICMgbm90ZSB0aGF0IHRoaXMgaXMgb25seSBjYWxsZWQgd2hlbiBiIGNoYW5nZXM7IHNvIGZvciBjcm9zcy1wcm9kdWN0CiAgICAjIGtpbmRzIG9mIG1hdGNoZXMsIGl0J3MgYmVzdCB0byBjYWxsIHNldF9zZXEyIG9uY2UsIHRoZW4gc2V0X3NlcTEKICAgICMgcmVwZWF0ZWRseQoKICAgIGRlZiBfX2NoYWluX2Ioc2VsZik6CiAgICAgICAgIyBCZWNhdXNlIGlzanVuayBpcyBhIHVzZXItZGVmaW5lZCAobm90IEMpIGZ1bmN0aW9uLCBhbmQgd2UgdGVzdAogICAgICAgICMgZm9yIGp1bmsgYSBMT1QsIGl0J3MgaW1wb3J0YW50IHRvIG1pbmltaXplIHRoZSBudW1iZXIgb2YgY2FsbHMuCiAgICAgICAgIyBCZWZvcmUgdGhlIHRyaWNrcyBkZXNjcmliZWQgaGVyZSwgX19jaGFpbl9iIHdhcyBieSBmYXIgdGhlIG1vc3QKICAgICAgICAjIHRpbWUtY29uc3VtaW5nIHJvdXRpbmUgaW4gdGhlIHdob2xlIG1vZHVsZSEgIElmIGFueW9uZSBzZWVzCiAgICAgICAgIyBKaW0gUm9za2luZCwgdGhhbmsgaGltIGFnYWluIGZvciBwcm9maWxlLnB5IC0tIEkgbmV2ZXIgd291bGQKICAgICAgICAjIGhhdmUgZ3Vlc3NlZCB0aGF0LgogICAgICAgICMgVGhlIGZpcnN0IHRyaWNrIGlzIHRvIGJ1aWxkIGIyaiBpZ25vcmluZyB0aGUgcG9zc2liaWxpdHkKICAgICAgICAjIG9mIGp1bmsuICBJLmUuLCB3ZSBkb24ndCBjYWxsIGlzanVuayBhdCBhbGwgeWV0LiAgVGhyb3dpbmcKICAgICAgICAjIG91dCB0aGUganVuayBsYXRlciBpcyBtdWNoIGNoZWFwZXIgdGhhbiBidWlsZGluZyBiMmogInJpZ2h0IgogICAgICAgICMgZnJvbSB0aGUgc3RhcnQuCiAgICAgICAgYiA9IHNlbGYuYgogICAgICAgIHNlbGYuYjJqID0gYjJqID0ge30KCiAgICAgICAgZm9yIGksIGVsdCBpbiBlbnVtZXJhdGUoYik6CiAgICAgICAgICAgIGluZGljZXMgPSBiMmouc2V0ZGVmYXVsdChlbHQsIFtdKQogICAgICAgICAgICBpbmRpY2VzLmFwcGVuZChpKQoKICAgICAgICAjIFB1cmdlIGp1bmsgZWxlbWVudHMKICAgICAgICBzZWxmLmJqdW5rID0ganVuayA9IHNldCgpCiAgICAgICAgaXNqdW5rID0gc2VsZi5pc2p1bmsKICAgICAgICBpZiBpc2p1bms6CiAgICAgICAgICAgIGZvciBlbHQgaW4gYjJqLmtleXMoKToKICAgICAgICAgICAgICAgIGlmIGlzanVuayhlbHQpOgogICAgICAgICAgICAgICAgICAgIGp1bmsuYWRkKGVsdCkKICAgICAgICAgICAgZm9yIGVsdCBpbiBqdW5rOiAjIHNlcGFyYXRlIGxvb3AgYXZvaWRzIHNlcGFyYXRlIGxpc3Qgb2Yga2V5cwogICAgICAgICAgICAgICAgZGVsIGIyaltlbHRdCgogICAgICAgICMgUHVyZ2UgcG9wdWxhciBlbGVtZW50cyB0aGF0IGFyZSBub3QganVuawogICAgICAgIHNlbGYuYnBvcHVsYXIgPSBwb3B1bGFyID0gc2V0KCkKICAgICAgICBuID0gbGVuKGIpCiAgICAgICAgaWYgc2VsZi5hdXRvanVuayBhbmQgbiA+PSAyMDA6CiAgICAgICAgICAgIG50ZXN0ID0gbiAvLyAxMDAgKyAxCiAgICAgICAgICAgIGZvciBlbHQsIGlkeHMgaW4gYjJqLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBpZiBsZW4oaWR4cykgPiBudGVzdDoKICAgICAgICAgICAgICAgICAgICBwb3B1bGFyLmFkZChlbHQpCiAgICAgICAgICAgIGZvciBlbHQgaW4gcG9wdWxhcjogIyBkaXR0bzsgYXMgZmFzdCBmb3IgMSUgZGVsZXRpb24KICAgICAgICAgICAgICAgIGRlbCBiMmpbZWx0XQoKICAgIGRlZiBpc2JqdW5rKHNlbGYsIGl0ZW0pOgogICAgICAgICJEZXByZWNhdGVkOyB1c2UgJ2l0ZW0gaW4gU2VxdWVuY2VNYXRjaGVyKCkuYmp1bmsnLiIKICAgICAgICB3YXJuaW5ncy53YXJuKCInU2VxdWVuY2VNYXRjaGVyKCkuaXNianVuayhpdGVtKScgaXMgZGVwcmVjYXRlZDtcbiIKICAgICAgICAgICAgICAgICAgICAgICJ1c2UgJ2l0ZW0gaW4gU01pbnN0YW5jZS5ianVuaycgaW5zdGVhZC4iLAogICAgICAgICAgICAgICAgICAgICAgRGVwcmVjYXRpb25XYXJuaW5nLCAyKQogICAgICAgIHJldHVybiBpdGVtIGluIHNlbGYuYmp1bmsKCiAgICBkZWYgaXNicG9wdWxhcihzZWxmLCBpdGVtKToKICAgICAgICAiRGVwcmVjYXRlZDsgdXNlICdpdGVtIGluIFNlcXVlbmNlTWF0Y2hlcigpLmJwb3B1bGFyJy4iCiAgICAgICAgd2FybmluZ3Mud2FybigiJ1NlcXVlbmNlTWF0Y2hlcigpLmlzYnBvcHVsYXIoaXRlbSknIGlzIGRlcHJlY2F0ZWQ7XG4iCiAgICAgICAgICAgICAgICAgICAgICAidXNlICdpdGVtIGluIFNNaW5zdGFuY2UuYnBvcHVsYXInIGluc3RlYWQuIiwKICAgICAgICAgICAgICAgICAgICAgIERlcHJlY2F0aW9uV2FybmluZywgMikKICAgICAgICByZXR1cm4gaXRlbSBpbiBzZWxmLmJwb3B1bGFyCgogICAgZGVmIGZpbmRfbG9uZ2VzdF9tYXRjaChzZWxmLCBhbG8sIGFoaSwgYmxvLCBiaGkpOgogICAgICAgICIiIkZpbmQgbG9uZ2VzdCBtYXRjaGluZyBibG9jayBpbiBhW2FsbzphaGldIGFuZCBiW2JsbzpiaGldLgoKICAgICAgICBJZiBpc2p1bmsgaXMgbm90IGRlZmluZWQ6CgogICAgICAgIFJldHVybiAoaSxqLGspIHN1Y2ggdGhhdCBhW2k6aStrXSBpcyBlcXVhbCB0byBiW2o6aitrXSwgd2hlcmUKICAgICAgICAgICAgYWxvIDw9IGkgPD0gaStrIDw9IGFoaQogICAgICAgICAgICBibG8gPD0gaiA8PSBqK2sgPD0gYmhpCiAgICAgICAgYW5kIGZvciBhbGwgKGknLGonLGsnKSBtZWV0aW5nIHRob3NlIGNvbmRpdGlvbnMsCiAgICAgICAgICAgIGsgPj0gaycKICAgICAgICAgICAgaSA8PSBpJwogICAgICAgICAgICBhbmQgaWYgaSA9PSBpJywgaiA8PSBqJwoKICAgICAgICBJbiBvdGhlciB3b3Jkcywgb2YgYWxsIG1heGltYWwgbWF0Y2hpbmcgYmxvY2tzLCByZXR1cm4gb25lIHRoYXQKICAgICAgICBzdGFydHMgZWFybGllc3QgaW4gYSwgYW5kIG9mIGFsbCB0aG9zZSBtYXhpbWFsIG1hdGNoaW5nIGJsb2NrcyB0aGF0CiAgICAgICAgc3RhcnQgZWFybGllc3QgaW4gYSwgcmV0dXJuIHRoZSBvbmUgdGhhdCBzdGFydHMgZWFybGllc3QgaW4gYi4KCiAgICAgICAgPj4+IHMgPSBTZXF1ZW5jZU1hdGNoZXIoTm9uZSwgIiBhYmNkIiwgImFiY2QgYWJjZCIpCiAgICAgICAgPj4+IHMuZmluZF9sb25nZXN0X21hdGNoKDAsIDUsIDAsIDkpCiAgICAgICAgTWF0Y2goYT0wLCBiPTQsIHNpemU9NSkKCiAgICAgICAgSWYgaXNqdW5rIGlzIGRlZmluZWQsIGZpcnN0IHRoZSBsb25nZXN0IG1hdGNoaW5nIGJsb2NrIGlzCiAgICAgICAgZGV0ZXJtaW5lZCBhcyBhYm92ZSwgYnV0IHdpdGggdGhlIGFkZGl0aW9uYWwgcmVzdHJpY3Rpb24gdGhhdCBubwogICAgICAgIGp1bmsgZWxlbWVudCBhcHBlYXJzIGluIHRoZSBibG9jay4gIFRoZW4gdGhhdCBibG9jayBpcyBleHRlbmRlZCBhcwogICAgICAgIGZhciBhcyBwb3NzaWJsZSBieSBtYXRjaGluZyAob25seSkganVuayBlbGVtZW50cyBvbiBib3RoIHNpZGVzLiAgU28KICAgICAgICB0aGUgcmVzdWx0aW5nIGJsb2NrIG5ldmVyIG1hdGNoZXMgb24ganVuayBleGNlcHQgYXMgaWRlbnRpY2FsIGp1bmsKICAgICAgICBoYXBwZW5zIHRvIGJlIGFkamFjZW50IHRvIGFuICJpbnRlcmVzdGluZyIgbWF0Y2guCgogICAgICAgIEhlcmUncyB0aGUgc2FtZSBleGFtcGxlIGFzIGJlZm9yZSwgYnV0IGNvbnNpZGVyaW5nIGJsYW5rcyB0byBiZQogICAgICAgIGp1bmsuICBUaGF0IHByZXZlbnRzICIgYWJjZCIgZnJvbSBtYXRjaGluZyB0aGUgIiBhYmNkIiBhdCB0aGUgdGFpbAogICAgICAgIGVuZCBvZiB0aGUgc2Vjb25kIHNlcXVlbmNlIGRpcmVjdGx5LiAgSW5zdGVhZCBvbmx5IHRoZSAiYWJjZCIgY2FuCiAgICAgICAgbWF0Y2gsIGFuZCBtYXRjaGVzIHRoZSBsZWZ0bW9zdCAiYWJjZCIgaW4gdGhlIHNlY29uZCBzZXF1ZW5jZToKCiAgICAgICAgPj4+IHMgPSBTZXF1ZW5jZU1hdGNoZXIobGFtYmRhIHg6IHg9PSIgIiwgIiBhYmNkIiwgImFiY2QgYWJjZCIpCiAgICAgICAgPj4+IHMuZmluZF9sb25nZXN0X21hdGNoKDAsIDUsIDAsIDkpCiAgICAgICAgTWF0Y2goYT0xLCBiPTAsIHNpemU9NCkKCiAgICAgICAgSWYgbm8gYmxvY2tzIG1hdGNoLCByZXR1cm4gKGFsbywgYmxvLCAwKS4KCiAgICAgICAgPj4+IHMgPSBTZXF1ZW5jZU1hdGNoZXIoTm9uZSwgImFiIiwgImMiKQogICAgICAgID4+PiBzLmZpbmRfbG9uZ2VzdF9tYXRjaCgwLCAyLCAwLCAxKQogICAgICAgIE1hdGNoKGE9MCwgYj0wLCBzaXplPTApCiAgICAgICAgIiIiCgogICAgICAgICMgQ0FVVElPTjogIHN0cmlwcGluZyBjb21tb24gcHJlZml4IG9yIHN1ZmZpeCB3b3VsZCBiZSBpbmNvcnJlY3QuCiAgICAgICAgIyBFLmcuLAogICAgICAgICMgICAgYWIKICAgICAgICAjICAgIGFjYWIKICAgICAgICAjIExvbmdlc3QgbWF0Y2hpbmcgYmxvY2sgaXMgImFiIiwgYnV0IGlmIGNvbW1vbiBwcmVmaXggaXMKICAgICAgICAjIHN0cmlwcGVkLCBpdCdzICJhIiAodGllZCB3aXRoICJiIikuICBVTklYKHRtKSBkaWZmIGRvZXMgc28KICAgICAgICAjIHN0cmlwLCBzbyBlbmRzIHVwIGNsYWltaW5nIHRoYXQgYWIgaXMgY2hhbmdlZCB0byBhY2FiIGJ5CiAgICAgICAgIyBpbnNlcnRpbmcgImNhIiBpbiB0aGUgbWlkZGxlLiAgVGhhdCdzIG1pbmltYWwgYnV0IHVuaW50dWl0aXZlOgogICAgICAgICMgIml0J3Mgb2J2aW91cyIgdGhhdCBzb21lb25lIGluc2VydGVkICJhYyIgYXQgdGhlIGZyb250LgogICAgICAgICMgV2luZGlmZiBlbmRzIHVwIGF0IHRoZSBzYW1lIHBsYWNlIGFzIGRpZmYsIGJ1dCBieSBwYWlyaW5nIHVwCiAgICAgICAgIyB0aGUgdW5pcXVlICdiJ3MgYW5kIHRoZW4gbWF0Y2hpbmcgdGhlIGZpcnN0IHR3byAnYSdzLgoKICAgICAgICBhLCBiLCBiMmosIGlzYmp1bmsgPSBzZWxmLmEsIHNlbGYuYiwgc2VsZi5iMmosIHNlbGYuYmp1bmsuX19jb250YWluc19fCiAgICAgICAgYmVzdGksIGJlc3RqLCBiZXN0c2l6ZSA9IGFsbywgYmxvLCAwCiAgICAgICAgIyBmaW5kIGxvbmdlc3QganVuay1mcmVlIG1hdGNoCiAgICAgICAgIyBkdXJpbmcgYW4gaXRlcmF0aW9uIG9mIHRoZSBsb29wLCBqMmxlbltqXSA9IGxlbmd0aCBvZiBsb25nZXN0CiAgICAgICAgIyBqdW5rLWZyZWUgbWF0Y2ggZW5kaW5nIHdpdGggYVtpLTFdIGFuZCBiW2pdCiAgICAgICAgajJsZW4gPSB7fQogICAgICAgIG5vdGhpbmcgPSBbXQogICAgICAgIGZvciBpIGluIHJhbmdlKGFsbywgYWhpKToKICAgICAgICAgICAgIyBsb29rIGF0IGFsbCBpbnN0YW5jZXMgb2YgYVtpXSBpbiBiOyBub3RlIHRoYXQgYmVjYXVzZQogICAgICAgICAgICAjIGIyaiBoYXMgbm8ganVuayBrZXlzLCB0aGUgbG9vcCBpcyBza2lwcGVkIGlmIGFbaV0gaXMganVuawogICAgICAgICAgICBqMmxlbmdldCA9IGoybGVuLmdldAogICAgICAgICAgICBuZXdqMmxlbiA9IHt9CiAgICAgICAgICAgIGZvciBqIGluIGIyai5nZXQoYVtpXSwgbm90aGluZyk6CiAgICAgICAgICAgICAgICAjIGFbaV0gbWF0Y2hlcyBiW2pdCiAgICAgICAgICAgICAgICBpZiBqIDwgYmxvOgogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICBpZiBqID49IGJoaToKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgayA9IG5ld2oybGVuW2pdID0gajJsZW5nZXQoai0xLCAwKSArIDEKICAgICAgICAgICAgICAgIGlmIGsgPiBiZXN0c2l6ZToKICAgICAgICAgICAgICAgICAgICBiZXN0aSwgYmVzdGosIGJlc3RzaXplID0gaS1rKzEsIGotaysxLCBrCiAgICAgICAgICAgIGoybGVuID0gbmV3ajJsZW4KCiAgICAgICAgIyBFeHRlbmQgdGhlIGJlc3QgYnkgbm9uLWp1bmsgZWxlbWVudHMgb24gZWFjaCBlbmQuICBJbiBwYXJ0aWN1bGFyLAogICAgICAgICMgInBvcHVsYXIiIG5vbi1qdW5rIGVsZW1lbnRzIGFyZW4ndCBpbiBiMmosIHdoaWNoIGdyZWF0bHkgc3BlZWRzCiAgICAgICAgIyB0aGUgaW5uZXIgbG9vcCBhYm92ZSwgYnV0IGFsc28gbWVhbnMgInRoZSBiZXN0IiBtYXRjaCBzbyBmYXIKICAgICAgICAjIGRvZXNuJ3QgY29udGFpbiBhbnkganVuayAqb3IqIHBvcHVsYXIgbm9uLWp1bmsgZWxlbWVudHMuCiAgICAgICAgd2hpbGUgYmVzdGkgPiBhbG8gYW5kIGJlc3RqID4gYmxvIGFuZCBcCiAgICAgICAgICAgICAgbm90IGlzYmp1bmsoYltiZXN0ai0xXSkgYW5kIFwKICAgICAgICAgICAgICBhW2Jlc3RpLTFdID09IGJbYmVzdGotMV06CiAgICAgICAgICAgIGJlc3RpLCBiZXN0aiwgYmVzdHNpemUgPSBiZXN0aS0xLCBiZXN0ai0xLCBiZXN0c2l6ZSsxCiAgICAgICAgd2hpbGUgYmVzdGkrYmVzdHNpemUgPCBhaGkgYW5kIGJlc3RqK2Jlc3RzaXplIDwgYmhpIGFuZCBcCiAgICAgICAgICAgICAgbm90IGlzYmp1bmsoYltiZXN0aitiZXN0c2l6ZV0pIGFuZCBcCiAgICAgICAgICAgICAgYVtiZXN0aStiZXN0c2l6ZV0gPT0gYltiZXN0aitiZXN0c2l6ZV06CiAgICAgICAgICAgIGJlc3RzaXplICs9IDEKCiAgICAgICAgIyBOb3cgdGhhdCB3ZSBoYXZlIGEgd2hvbGx5IGludGVyZXN0aW5nIG1hdGNoIChhbGJlaXQgcG9zc2libHkKICAgICAgICAjIGVtcHR5ISksIHdlIG1heSBhcyB3ZWxsIHN1Y2sgdXAgdGhlIG1hdGNoaW5nIGp1bmsgb24gZWFjaAogICAgICAgICMgc2lkZSBvZiBpdCB0b28uICBDYW4ndCB0aGluayBvZiBhIGdvb2QgcmVhc29uIG5vdCB0bywgYW5kIGl0CiAgICAgICAgIyBzYXZlcyBwb3N0LXByb2Nlc3NpbmcgdGhlIChwb3NzaWJseSBjb25zaWRlcmFibGUpIGV4cGVuc2Ugb2YKICAgICAgICAjIGZpZ3VyaW5nIG91dCB3aGF0IHRvIGRvIHdpdGggaXQuICBJbiB0aGUgY2FzZSBvZiBhbiBlbXB0eQogICAgICAgICMgaW50ZXJlc3RpbmcgbWF0Y2gsIHRoaXMgaXMgY2xlYXJseSB0aGUgcmlnaHQgdGhpbmcgdG8gZG8sCiAgICAgICAgIyBiZWNhdXNlIG5vIG90aGVyIGtpbmQgb2YgbWF0Y2ggaXMgcG9zc2libGUgaW4gdGhlIHJlZ2lvbnMuCiAgICAgICAgd2hpbGUgYmVzdGkgPiBhbG8gYW5kIGJlc3RqID4gYmxvIGFuZCBcCiAgICAgICAgICAgICAgaXNianVuayhiW2Jlc3RqLTFdKSBhbmQgXAogICAgICAgICAgICAgIGFbYmVzdGktMV0gPT0gYltiZXN0ai0xXToKICAgICAgICAgICAgYmVzdGksIGJlc3RqLCBiZXN0c2l6ZSA9IGJlc3RpLTEsIGJlc3RqLTEsIGJlc3RzaXplKzEKICAgICAgICB3aGlsZSBiZXN0aStiZXN0c2l6ZSA8IGFoaSBhbmQgYmVzdGorYmVzdHNpemUgPCBiaGkgYW5kIFwKICAgICAgICAgICAgICBpc2JqdW5rKGJbYmVzdGorYmVzdHNpemVdKSBhbmQgXAogICAgICAgICAgICAgIGFbYmVzdGkrYmVzdHNpemVdID09IGJbYmVzdGorYmVzdHNpemVdOgogICAgICAgICAgICBiZXN0c2l6ZSA9IGJlc3RzaXplICsgMQoKICAgICAgICByZXR1cm4gTWF0Y2goYmVzdGksIGJlc3RqLCBiZXN0c2l6ZSkKCiAgICBkZWYgZ2V0X21hdGNoaW5nX2Jsb2NrcyhzZWxmKToKICAgICAgICAiIiJSZXR1cm4gbGlzdCBvZiB0cmlwbGVzIGRlc2NyaWJpbmcgbWF0Y2hpbmcgc3Vic2VxdWVuY2VzLgoKICAgICAgICBFYWNoIHRyaXBsZSBpcyBvZiB0aGUgZm9ybSAoaSwgaiwgbiksIGFuZCBtZWFucyB0aGF0CiAgICAgICAgYVtpOmkrbl0gPT0gYltqOmorbl0uICBUaGUgdHJpcGxlcyBhcmUgbW9ub3RvbmljYWxseSBpbmNyZWFzaW5nIGluCiAgICAgICAgaSBhbmQgaW4gai4gIE5ldyBpbiBQeXRob24gMi41LCBpdCdzIGFsc28gZ3VhcmFudGVlZCB0aGF0IGlmCiAgICAgICAgKGksIGosIG4pIGFuZCAoaScsIGonLCBuJykgYXJlIGFkamFjZW50IHRyaXBsZXMgaW4gdGhlIGxpc3QsIGFuZAogICAgICAgIHRoZSBzZWNvbmQgaXMgbm90IHRoZSBsYXN0IHRyaXBsZSBpbiB0aGUgbGlzdCwgdGhlbiBpK24gIT0gaScgb3IKICAgICAgICBqK24gIT0gaicuICBJT1csIGFkamFjZW50IHRyaXBsZXMgbmV2ZXIgZGVzY3JpYmUgYWRqYWNlbnQgZXF1YWwKICAgICAgICBibG9ja3MuCgogICAgICAgIFRoZSBsYXN0IHRyaXBsZSBpcyBhIGR1bW15LCAobGVuKGEpLCBsZW4oYiksIDApLCBhbmQgaXMgdGhlIG9ubHkKICAgICAgICB0cmlwbGUgd2l0aCBuPT0wLgoKICAgICAgICA+Pj4gcyA9IFNlcXVlbmNlTWF0Y2hlcihOb25lLCAiYWJ4Y2QiLCAiYWJjZCIpCiAgICAgICAgPj4+IGxpc3Qocy5nZXRfbWF0Y2hpbmdfYmxvY2tzKCkpCiAgICAgICAgW01hdGNoKGE9MCwgYj0wLCBzaXplPTIpLCBNYXRjaChhPTMsIGI9Miwgc2l6ZT0yKSwgTWF0Y2goYT01LCBiPTQsIHNpemU9MCldCiAgICAgICAgIiIiCgogICAgICAgIGlmIHNlbGYubWF0Y2hpbmdfYmxvY2tzIGlzIG5vdCBOb25lOgogICAgICAgICAgICByZXR1cm4gc2VsZi5tYXRjaGluZ19ibG9ja3MKICAgICAgICBsYSwgbGIgPSBsZW4oc2VsZi5hKSwgbGVuKHNlbGYuYikKCiAgICAgICAgIyBUaGlzIGlzIG1vc3QgbmF0dXJhbGx5IGV4cHJlc3NlZCBhcyBhIHJlY3Vyc2l2ZSBhbGdvcml0aG0sIGJ1dAogICAgICAgICMgYXQgbGVhc3Qgb25lIHVzZXIgYnVtcGVkIGludG8gZXh0cmVtZSB1c2UgY2FzZXMgdGhhdCBleGNlZWRlZAogICAgICAgICMgdGhlIHJlY3Vyc2lvbiBsaW1pdCBvbiB0aGVpciBib3guICBTbywgbm93IHdlIG1haW50YWluIGEgbGlzdAogICAgICAgICMgKCdxdWV1ZWApIG9mIGJsb2NrcyB3ZSBzdGlsbCBuZWVkIHRvIGxvb2sgYXQsIGFuZCBhcHBlbmQgcGFydGlhbAogICAgICAgICMgcmVzdWx0cyB0byBgbWF0Y2hpbmdfYmxvY2tzYCBpbiBhIGxvb3A7IHRoZSBtYXRjaGVzIGFyZSBzb3J0ZWQKICAgICAgICAjIGF0IHRoZSBlbmQuCiAgICAgICAgcXVldWUgPSBbKDAsIGxhLCAwLCBsYildCiAgICAgICAgbWF0Y2hpbmdfYmxvY2tzID0gW10KICAgICAgICB3aGlsZSBxdWV1ZToKICAgICAgICAgICAgYWxvLCBhaGksIGJsbywgYmhpID0gcXVldWUucG9wKCkKICAgICAgICAgICAgaSwgaiwgayA9IHggPSBzZWxmLmZpbmRfbG9uZ2VzdF9tYXRjaChhbG8sIGFoaSwgYmxvLCBiaGkpCiAgICAgICAgICAgICMgYVthbG86aV0gdnMgYltibG86al0gdW5rbm93bgogICAgICAgICAgICAjIGFbaTppK2tdIHNhbWUgYXMgYltqOmora10KICAgICAgICAgICAgIyBhW2krazphaGldIHZzIGJbaitrOmJoaV0gdW5rbm93bgogICAgICAgICAgICBpZiBrOiAgICMgaWYgayBpcyAwLCB0aGVyZSB3YXMgbm8gbWF0Y2hpbmcgYmxvY2sKICAgICAgICAgICAgICAgIG1hdGNoaW5nX2Jsb2Nrcy5hcHBlbmQoeCkKICAgICAgICAgICAgICAgIGlmIGFsbyA8IGkgYW5kIGJsbyA8IGo6CiAgICAgICAgICAgICAgICAgICAgcXVldWUuYXBwZW5kKChhbG8sIGksIGJsbywgaikpCiAgICAgICAgICAgICAgICBpZiBpK2sgPCBhaGkgYW5kIGorayA8IGJoaToKICAgICAgICAgICAgICAgICAgICBxdWV1ZS5hcHBlbmQoKGkraywgYWhpLCBqK2ssIGJoaSkpCiAgICAgICAgbWF0Y2hpbmdfYmxvY2tzLnNvcnQoKQoKICAgICAgICAjIEl0J3MgcG9zc2libGUgdGhhdCB3ZSBoYXZlIGFkamFjZW50IGVxdWFsIGJsb2NrcyBpbiB0aGUKICAgICAgICAjIG1hdGNoaW5nX2Jsb2NrcyBsaXN0IG5vdy4gIFN0YXJ0aW5nIHdpdGggMi41LCB0aGlzIGNvZGUgd2FzIGFkZGVkCiAgICAgICAgIyB0byBjb2xsYXBzZSB0aGVtLgogICAgICAgIGkxID0gajEgPSBrMSA9IDAKICAgICAgICBub25fYWRqYWNlbnQgPSBbXQogICAgICAgIGZvciBpMiwgajIsIGsyIGluIG1hdGNoaW5nX2Jsb2NrczoKICAgICAgICAgICAgIyBJcyB0aGlzIGJsb2NrIGFkamFjZW50IHRvIGkxLCBqMSwgazE/CiAgICAgICAgICAgIGlmIGkxICsgazEgPT0gaTIgYW5kIGoxICsgazEgPT0gajI6CiAgICAgICAgICAgICAgICAjIFllcywgc28gY29sbGFwc2UgdGhlbSAtLSB0aGlzIGp1c3QgaW5jcmVhc2VzIHRoZSBsZW5ndGggb2YKICAgICAgICAgICAgICAgICMgdGhlIGZpcnN0IGJsb2NrIGJ5IHRoZSBsZW5ndGggb2YgdGhlIHNlY29uZCwgYW5kIHRoZSBmaXJzdAogICAgICAgICAgICAgICAgIyBibG9jayBzbyBsZW5ndGhlbmVkIHJlbWFpbnMgdGhlIGJsb2NrIHRvIGNvbXBhcmUgYWdhaW5zdC4KICAgICAgICAgICAgICAgIGsxICs9IGsyCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAjIE5vdCBhZGphY2VudC4gIFJlbWVtYmVyIHRoZSBmaXJzdCBibG9jayAoazE9PTAgbWVhbnMgaXQncwogICAgICAgICAgICAgICAgIyB0aGUgZHVtbXkgd2Ugc3RhcnRlZCB3aXRoKSwgYW5kIG1ha2UgdGhlIHNlY29uZCBibG9jayB0aGUKICAgICAgICAgICAgICAgICMgbmV3IGJsb2NrIHRvIGNvbXBhcmUgYWdhaW5zdC4KICAgICAgICAgICAgICAgIGlmIGsxOgogICAgICAgICAgICAgICAgICAgIG5vbl9hZGphY2VudC5hcHBlbmQoKGkxLCBqMSwgazEpKQogICAgICAgICAgICAgICAgaTEsIGoxLCBrMSA9IGkyLCBqMiwgazIKICAgICAgICBpZiBrMToKICAgICAgICAgICAgbm9uX2FkamFjZW50LmFwcGVuZCgoaTEsIGoxLCBrMSkpCgogICAgICAgIG5vbl9hZGphY2VudC5hcHBlbmQoIChsYSwgbGIsIDApICkKICAgICAgICBzZWxmLm1hdGNoaW5nX2Jsb2NrcyA9IG5vbl9hZGphY2VudAogICAgICAgIHJldHVybiBtYXAoTWF0Y2guX21ha2UsIHNlbGYubWF0Y2hpbmdfYmxvY2tzKQoKICAgIGRlZiBnZXRfb3Bjb2RlcyhzZWxmKToKICAgICAgICAiIiJSZXR1cm4gbGlzdCBvZiA1LXR1cGxlcyBkZXNjcmliaW5nIGhvdyB0byB0dXJuIGEgaW50byBiLgoKICAgICAgICBFYWNoIHR1cGxlIGlzIG9mIHRoZSBmb3JtICh0YWcsIGkxLCBpMiwgajEsIGoyKS4gIFRoZSBmaXJzdCB0dXBsZQogICAgICAgIGhhcyBpMSA9PSBqMSA9PSAwLCBhbmQgcmVtYWluaW5nIHR1cGxlcyBoYXZlIGkxID09IHRoZSBpMiBmcm9tIHRoZQogICAgICAgIHR1cGxlIHByZWNlZGluZyBpdCwgYW5kIGxpa2V3aXNlIGZvciBqMSA9PSB0aGUgcHJldmlvdXMgajIuCgogICAgICAgIFRoZSB0YWdzIGFyZSBzdHJpbmdzLCB3aXRoIHRoZXNlIG1lYW5pbmdzOgoKICAgICAgICAncmVwbGFjZSc6ICBhW2kxOmkyXSBzaG91bGQgYmUgcmVwbGFjZWQgYnkgYltqMTpqMl0KICAgICAgICAnZGVsZXRlJzogICBhW2kxOmkyXSBzaG91bGQgYmUgZGVsZXRlZC4KICAgICAgICAgICAgICAgICAgICBOb3RlIHRoYXQgajE9PWoyIGluIHRoaXMgY2FzZS4KICAgICAgICAnaW5zZXJ0JzogICBiW2oxOmoyXSBzaG91bGQgYmUgaW5zZXJ0ZWQgYXQgYVtpMTppMV0uCiAgICAgICAgICAgICAgICAgICAgTm90ZSB0aGF0IGkxPT1pMiBpbiB0aGlzIGNhc2UuCiAgICAgICAgJ2VxdWFsJzogICAgYVtpMTppMl0gPT0gYltqMTpqMl0KCiAgICAgICAgPj4+IGEgPSAicWFieGNkIgogICAgICAgID4+PiBiID0gImFieWNkZiIKICAgICAgICA+Pj4gcyA9IFNlcXVlbmNlTWF0Y2hlcihOb25lLCBhLCBiKQogICAgICAgID4+PiBmb3IgdGFnLCBpMSwgaTIsIGoxLCBqMiBpbiBzLmdldF9vcGNvZGVzKCk6CiAgICAgICAgLi4uICAgIHByaW50KCgiJTdzIGFbJWQ6JWRdICglcykgYlslZDolZF0gKCVzKSIgJQogICAgICAgIC4uLiAgICAgICAgICAgKHRhZywgaTEsIGkyLCBhW2kxOmkyXSwgajEsIGoyLCBiW2oxOmoyXSkpKQogICAgICAgICBkZWxldGUgYVswOjFdIChxKSBiWzA6MF0gKCkKICAgICAgICAgIGVxdWFsIGFbMTozXSAoYWIpIGJbMDoyXSAoYWIpCiAgICAgICAgcmVwbGFjZSBhWzM6NF0gKHgpIGJbMjozXSAoeSkKICAgICAgICAgIGVxdWFsIGFbNDo2XSAoY2QpIGJbMzo1XSAoY2QpCiAgICAgICAgIGluc2VydCBhWzY6Nl0gKCkgYls1OjZdIChmKQogICAgICAgICIiIgoKICAgICAgICBpZiBzZWxmLm9wY29kZXMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJldHVybiBzZWxmLm9wY29kZXMKICAgICAgICBpID0gaiA9IDAKICAgICAgICBzZWxmLm9wY29kZXMgPSBhbnN3ZXIgPSBbXQogICAgICAgIGZvciBhaSwgYmosIHNpemUgaW4gc2VsZi5nZXRfbWF0Y2hpbmdfYmxvY2tzKCk6CiAgICAgICAgICAgICMgaW52YXJpYW50OiAgd2UndmUgcHVtcGVkIG91dCBjb3JyZWN0IGRpZmZzIHRvIGNoYW5nZQogICAgICAgICAgICAjIGFbOmldIGludG8gYls6al0sIGFuZCB0aGUgbmV4dCBtYXRjaGluZyBibG9jayBpcwogICAgICAgICAgICAjIGFbYWk6YWkrc2l6ZV0gPT0gYltiajpiaitzaXplXS4gIFNvIHdlIG5lZWQgdG8gcHVtcAogICAgICAgICAgICAjIG91dCBhIGRpZmYgdG8gY2hhbmdlIGFbaTphaV0gaW50byBiW2o6YmpdLCBwdW1wIG91dAogICAgICAgICAgICAjIHRoZSBtYXRjaGluZyBibG9jaywgYW5kIG1vdmUgKGksaikgYmV5b25kIHRoZSBtYXRjaAogICAgICAgICAgICB0YWcgPSAnJwogICAgICAgICAgICBpZiBpIDwgYWkgYW5kIGogPCBiajoKICAgICAgICAgICAgICAgIHRhZyA9ICdyZXBsYWNlJwogICAgICAgICAgICBlbGlmIGkgPCBhaToKICAgICAgICAgICAgICAgIHRhZyA9ICdkZWxldGUnCiAgICAgICAgICAgIGVsaWYgaiA8IGJqOgogICAgICAgICAgICAgICAgdGFnID0gJ2luc2VydCcKICAgICAgICAgICAgaWYgdGFnOgogICAgICAgICAgICAgICAgYW5zd2VyLmFwcGVuZCggKHRhZywgaSwgYWksIGosIGJqKSApCiAgICAgICAgICAgIGksIGogPSBhaStzaXplLCBiaitzaXplCiAgICAgICAgICAgICMgdGhlIGxpc3Qgb2YgbWF0Y2hpbmcgYmxvY2tzIGlzIHRlcm1pbmF0ZWQgYnkgYQogICAgICAgICAgICAjIHNlbnRpbmVsIHdpdGggc2l6ZSAwCiAgICAgICAgICAgIGlmIHNpemU6CiAgICAgICAgICAgICAgICBhbnN3ZXIuYXBwZW5kKCAoJ2VxdWFsJywgYWksIGksIGJqLCBqKSApCiAgICAgICAgcmV0dXJuIGFuc3dlcgoKICAgIGRlZiBnZXRfZ3JvdXBlZF9vcGNvZGVzKHNlbGYsIG49Myk6CiAgICAgICAgIiIiIElzb2xhdGUgY2hhbmdlIGNsdXN0ZXJzIGJ5IGVsaW1pbmF0aW5nIHJhbmdlcyB3aXRoIG5vIGNoYW5nZXMuCgogICAgICAgIFJldHVybiBhIGdlbmVyYXRvciBvZiBncm91cHMgd2l0aCB1cHRvIG4gbGluZXMgb2YgY29udGV4dC4KICAgICAgICBFYWNoIGdyb3VwIGlzIGluIHRoZSBzYW1lIGZvcm1hdCBhcyByZXR1cm5lZCBieSBnZXRfb3Bjb2RlcygpLgoKICAgICAgICA+Pj4gZnJvbSBwcHJpbnQgaW1wb3J0IHBwcmludAogICAgICAgID4+PiBhID0gbGlzdChtYXAoc3RyLCByYW5nZSgxLDQwKSkpCiAgICAgICAgPj4+IGIgPSBhWzpdCiAgICAgICAgPj4+IGJbODo4XSA9IFsnaSddICAgICAjIE1ha2UgYW4gaW5zZXJ0aW9uCiAgICAgICAgPj4+IGJbMjBdICs9ICd4JyAgICAgICAjIE1ha2UgYSByZXBsYWNlbWVudAogICAgICAgID4+PiBiWzIzOjI4XSA9IFtdICAgICAgIyBNYWtlIGEgZGVsZXRpb24KICAgICAgICA+Pj4gYlszMF0gKz0gJ3knICAgICAgICMgTWFrZSBhbm90aGVyIHJlcGxhY2VtZW50CiAgICAgICAgPj4+IHBwcmludChsaXN0KFNlcXVlbmNlTWF0Y2hlcihOb25lLGEsYikuZ2V0X2dyb3VwZWRfb3Bjb2RlcygpKSkKICAgICAgICBbWygnZXF1YWwnLCA1LCA4LCA1LCA4KSwgKCdpbnNlcnQnLCA4LCA4LCA4LCA5KSwgKCdlcXVhbCcsIDgsIDExLCA5LCAxMildLAogICAgICAgICBbKCdlcXVhbCcsIDE2LCAxOSwgMTcsIDIwKSwKICAgICAgICAgICgncmVwbGFjZScsIDE5LCAyMCwgMjAsIDIxKSwKICAgICAgICAgICgnZXF1YWwnLCAyMCwgMjIsIDIxLCAyMyksCiAgICAgICAgICAoJ2RlbGV0ZScsIDIyLCAyNywgMjMsIDIzKSwKICAgICAgICAgICgnZXF1YWwnLCAyNywgMzAsIDIzLCAyNildLAogICAgICAgICBbKCdlcXVhbCcsIDMxLCAzNCwgMjcsIDMwKSwKICAgICAgICAgICgncmVwbGFjZScsIDM0LCAzNSwgMzAsIDMxKSwKICAgICAgICAgICgnZXF1YWwnLCAzNSwgMzgsIDMxLCAzNCldXQogICAgICAgICIiIgoKICAgICAgICBjb2RlcyA9IHNlbGYuZ2V0X29wY29kZXMoKQogICAgICAgIGlmIG5vdCBjb2RlczoKICAgICAgICAgICAgY29kZXMgPSBbKCJlcXVhbCIsIDAsIDEsIDAsIDEpXQogICAgICAgICMgRml4dXAgbGVhZGluZyBhbmQgdHJhaWxpbmcgZ3JvdXBzIGlmIHRoZXkgc2hvdyBubyBjaGFuZ2VzLgogICAgICAgIGlmIGNvZGVzWzBdWzBdID09ICdlcXVhbCc6CiAgICAgICAgICAgIHRhZywgaTEsIGkyLCBqMSwgajIgPSBjb2Rlc1swXQogICAgICAgICAgICBjb2Rlc1swXSA9IHRhZywgbWF4KGkxLCBpMi1uKSwgaTIsIG1heChqMSwgajItbiksIGoyCiAgICAgICAgaWYgY29kZXNbLTFdWzBdID09ICdlcXVhbCc6CiAgICAgICAgICAgIHRhZywgaTEsIGkyLCBqMSwgajIgPSBjb2Rlc1stMV0KICAgICAgICAgICAgY29kZXNbLTFdID0gdGFnLCBpMSwgbWluKGkyLCBpMStuKSwgajEsIG1pbihqMiwgajErbikKCiAgICAgICAgbm4gPSBuICsgbgogICAgICAgIGdyb3VwID0gW10KICAgICAgICBmb3IgdGFnLCBpMSwgaTIsIGoxLCBqMiBpbiBjb2RlczoKICAgICAgICAgICAgIyBFbmQgdGhlIGN1cnJlbnQgZ3JvdXAgYW5kIHN0YXJ0IGEgbmV3IG9uZSB3aGVuZXZlcgogICAgICAgICAgICAjIHRoZXJlIGlzIGEgbGFyZ2UgcmFuZ2Ugd2l0aCBubyBjaGFuZ2VzLgogICAgICAgICAgICBpZiB0YWcgPT0gJ2VxdWFsJyBhbmQgaTItaTEgPiBubjoKICAgICAgICAgICAgICAgIGdyb3VwLmFwcGVuZCgodGFnLCBpMSwgbWluKGkyLCBpMStuKSwgajEsIG1pbihqMiwgajErbikpKQogICAgICAgICAgICAgICAgeWllbGQgZ3JvdXAKICAgICAgICAgICAgICAgIGdyb3VwID0gW10KICAgICAgICAgICAgICAgIGkxLCBqMSA9IG1heChpMSwgaTItbiksIG1heChqMSwgajItbikKICAgICAgICAgICAgZ3JvdXAuYXBwZW5kKCh0YWcsIGkxLCBpMiwgajEgLGoyKSkKICAgICAgICBpZiBncm91cCBhbmQgbm90IChsZW4oZ3JvdXApPT0xIGFuZCBncm91cFswXVswXSA9PSAnZXF1YWwnKToKICAgICAgICAgICAgeWllbGQgZ3JvdXAKCiAgICBkZWYgcmF0aW8oc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIGEgbWVhc3VyZSBvZiB0aGUgc2VxdWVuY2VzJyBzaW1pbGFyaXR5IChmbG9hdCBpbiBbMCwxXSkuCgogICAgICAgIFdoZXJlIFQgaXMgdGhlIHRvdGFsIG51bWJlciBvZiBlbGVtZW50cyBpbiBib3RoIHNlcXVlbmNlcywgYW5kCiAgICAgICAgTSBpcyB0aGUgbnVtYmVyIG9mIG1hdGNoZXMsIHRoaXMgaXMgMi4wKk0gLyBULgogICAgICAgIE5vdGUgdGhhdCB0aGlzIGlzIDEgaWYgdGhlIHNlcXVlbmNlcyBhcmUgaWRlbnRpY2FsLCBhbmQgMCBpZgogICAgICAgIHRoZXkgaGF2ZSBub3RoaW5nIGluIGNvbW1vbi4KCiAgICAgICAgLnJhdGlvKCkgaXMgZXhwZW5zaXZlIHRvIGNvbXB1dGUgaWYgeW91IGhhdmVuJ3QgYWxyZWFkeSBjb21wdXRlZAogICAgICAgIC5nZXRfbWF0Y2hpbmdfYmxvY2tzKCkgb3IgLmdldF9vcGNvZGVzKCksIGluIHdoaWNoIGNhc2UgeW91IG1heQogICAgICAgIHdhbnQgdG8gdHJ5IC5xdWlja19yYXRpbygpIG9yIC5yZWFsX3F1aWNrX3JhdGlvKCkgZmlyc3QgdG8gZ2V0IGFuCiAgICAgICAgdXBwZXIgYm91bmQuCgogICAgICAgID4+PiBzID0gU2VxdWVuY2VNYXRjaGVyKE5vbmUsICJhYmNkIiwgImJjZGUiKQogICAgICAgID4+PiBzLnJhdGlvKCkKICAgICAgICAwLjc1CiAgICAgICAgPj4+IHMucXVpY2tfcmF0aW8oKQogICAgICAgIDAuNzUKICAgICAgICA+Pj4gcy5yZWFsX3F1aWNrX3JhdGlvKCkKICAgICAgICAxLjAKICAgICAgICAiIiIKCiAgICAgICAgbWF0Y2hlcyA9IHN1bSh0cmlwbGVbLTFdIGZvciB0cmlwbGUgaW4gc2VsZi5nZXRfbWF0Y2hpbmdfYmxvY2tzKCkpCiAgICAgICAgcmV0dXJuIF9jYWxjdWxhdGVfcmF0aW8obWF0Y2hlcywgbGVuKHNlbGYuYSkgKyBsZW4oc2VsZi5iKSkKCiAgICBkZWYgcXVpY2tfcmF0aW8oc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIGFuIHVwcGVyIGJvdW5kIG9uIHJhdGlvKCkgcmVsYXRpdmVseSBxdWlja2x5LgoKICAgICAgICBUaGlzIGlzbid0IGRlZmluZWQgYmV5b25kIHRoYXQgaXQgaXMgYW4gdXBwZXIgYm91bmQgb24gLnJhdGlvKCksIGFuZAogICAgICAgIGlzIGZhc3RlciB0byBjb21wdXRlLgogICAgICAgICIiIgoKICAgICAgICAjIHZpZXdpbmcgYSBhbmQgYiBhcyBtdWx0aXNldHMsIHNldCBtYXRjaGVzIHRvIHRoZSBjYXJkaW5hbGl0eQogICAgICAgICMgb2YgdGhlaXIgaW50ZXJzZWN0aW9uOyB0aGlzIGNvdW50cyB0aGUgbnVtYmVyIG9mIG1hdGNoZXMKICAgICAgICAjIHdpdGhvdXQgcmVnYXJkIHRvIG9yZGVyLCBzbyBpcyBjbGVhcmx5IGFuIHVwcGVyIGJvdW5kCiAgICAgICAgaWYgc2VsZi5mdWxsYmNvdW50IGlzIE5vbmU6CiAgICAgICAgICAgIHNlbGYuZnVsbGJjb3VudCA9IGZ1bGxiY291bnQgPSB7fQogICAgICAgICAgICBmb3IgZWx0IGluIHNlbGYuYjoKICAgICAgICAgICAgICAgIGZ1bGxiY291bnRbZWx0XSA9IGZ1bGxiY291bnQuZ2V0KGVsdCwgMCkgKyAxCiAgICAgICAgZnVsbGJjb3VudCA9IHNlbGYuZnVsbGJjb3VudAogICAgICAgICMgYXZhaWxbeF0gaXMgdGhlIG51bWJlciBvZiB0aW1lcyB4IGFwcGVhcnMgaW4gJ2InIGxlc3MgdGhlCiAgICAgICAgIyBudW1iZXIgb2YgdGltZXMgd2UndmUgc2VlbiBpdCBpbiAnYScgc28gZmFyIC4uLiBraW5kYQogICAgICAgIGF2YWlsID0ge30KICAgICAgICBhdmFpbGhhcywgbWF0Y2hlcyA9IGF2YWlsLl9fY29udGFpbnNfXywgMAogICAgICAgIGZvciBlbHQgaW4gc2VsZi5hOgogICAgICAgICAgICBpZiBhdmFpbGhhcyhlbHQpOgogICAgICAgICAgICAgICAgbnVtYiA9IGF2YWlsW2VsdF0KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG51bWIgPSBmdWxsYmNvdW50LmdldChlbHQsIDApCiAgICAgICAgICAgIGF2YWlsW2VsdF0gPSBudW1iIC0gMQogICAgICAgICAgICBpZiBudW1iID4gMDoKICAgICAgICAgICAgICAgIG1hdGNoZXMgPSBtYXRjaGVzICsgMQogICAgICAgIHJldHVybiBfY2FsY3VsYXRlX3JhdGlvKG1hdGNoZXMsIGxlbihzZWxmLmEpICsgbGVuKHNlbGYuYikpCgogICAgZGVmIHJlYWxfcXVpY2tfcmF0aW8oc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIGFuIHVwcGVyIGJvdW5kIG9uIHJhdGlvKCkgdmVyeSBxdWlja2x5LgoKICAgICAgICBUaGlzIGlzbid0IGRlZmluZWQgYmV5b25kIHRoYXQgaXQgaXMgYW4gdXBwZXIgYm91bmQgb24gLnJhdGlvKCksIGFuZAogICAgICAgIGlzIGZhc3RlciB0byBjb21wdXRlIHRoYW4gZWl0aGVyIC5yYXRpbygpIG9yIC5xdWlja19yYXRpbygpLgogICAgICAgICIiIgoKICAgICAgICBsYSwgbGIgPSBsZW4oc2VsZi5hKSwgbGVuKHNlbGYuYikKICAgICAgICAjIGNhbid0IGhhdmUgbW9yZSBtYXRjaGVzIHRoYW4gdGhlIG51bWJlciBvZiBlbGVtZW50cyBpbiB0aGUKICAgICAgICAjIHNob3J0ZXIgc2VxdWVuY2UKICAgICAgICByZXR1cm4gX2NhbGN1bGF0ZV9yYXRpbyhtaW4obGEsIGxiKSwgbGEgKyBsYikKCmRlZiBnZXRfY2xvc2VfbWF0Y2hlcyh3b3JkLCBwb3NzaWJpbGl0aWVzLCBuPTMsIGN1dG9mZj0wLjYpOgogICAgIiIiVXNlIFNlcXVlbmNlTWF0Y2hlciB0byByZXR1cm4gbGlzdCBvZiB0aGUgYmVzdCAiZ29vZCBlbm91Z2giIG1hdGNoZXMuCgogICAgd29yZCBpcyBhIHNlcXVlbmNlIGZvciB3aGljaCBjbG9zZSBtYXRjaGVzIGFyZSBkZXNpcmVkICh0eXBpY2FsbHkgYQogICAgc3RyaW5nKS4KCiAgICBwb3NzaWJpbGl0aWVzIGlzIGEgbGlzdCBvZiBzZXF1ZW5jZXMgYWdhaW5zdCB3aGljaCB0byBtYXRjaCB3b3JkCiAgICAodHlwaWNhbGx5IGEgbGlzdCBvZiBzdHJpbmdzKS4KCiAgICBPcHRpb25hbCBhcmcgbiAoZGVmYXVsdCAzKSBpcyB0aGUgbWF4aW11bSBudW1iZXIgb2YgY2xvc2UgbWF0Y2hlcyB0bwogICAgcmV0dXJuLiAgbiBtdXN0IGJlID4gMC4KCiAgICBPcHRpb25hbCBhcmcgY3V0b2ZmIChkZWZhdWx0IDAuNikgaXMgYSBmbG9hdCBpbiBbMCwgMV0uICBQb3NzaWJpbGl0aWVzCiAgICB0aGF0IGRvbid0IHNjb3JlIGF0IGxlYXN0IHRoYXQgc2ltaWxhciB0byB3b3JkIGFyZSBpZ25vcmVkLgoKICAgIFRoZSBiZXN0IChubyBtb3JlIHRoYW4gbikgbWF0Y2hlcyBhbW9uZyB0aGUgcG9zc2liaWxpdGllcyBhcmUgcmV0dXJuZWQKICAgIGluIGEgbGlzdCwgc29ydGVkIGJ5IHNpbWlsYXJpdHkgc2NvcmUsIG1vc3Qgc2ltaWxhciBmaXJzdC4KCiAgICA+Pj4gZ2V0X2Nsb3NlX21hdGNoZXMoImFwcGVsIiwgWyJhcGUiLCAiYXBwbGUiLCAicGVhY2giLCAicHVwcHkiXSkKICAgIFsnYXBwbGUnLCAnYXBlJ10KICAgID4+PiBpbXBvcnQga2V5d29yZCBhcyBfa2V5d29yZAogICAgPj4+IGdldF9jbG9zZV9tYXRjaGVzKCJ3aGVlbCIsIF9rZXl3b3JkLmt3bGlzdCkKICAgIFsnd2hpbGUnXQogICAgPj4+IGdldF9jbG9zZV9tYXRjaGVzKCJBcHBsZSIsIF9rZXl3b3JkLmt3bGlzdCkKICAgIFtdCiAgICA+Pj4gZ2V0X2Nsb3NlX21hdGNoZXMoImFjY2VwdCIsIF9rZXl3b3JkLmt3bGlzdCkKICAgIFsnZXhjZXB0J10KICAgICIiIgoKICAgIGlmIG5vdCBuID4gIDA6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigibiBtdXN0IGJlID4gMDogJXIiICUgKG4sKSkKICAgIGlmIG5vdCAwLjAgPD0gY3V0b2ZmIDw9IDEuMDoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJjdXRvZmYgbXVzdCBiZSBpbiBbMC4wLCAxLjBdOiAlciIgJSAoY3V0b2ZmLCkpCiAgICByZXN1bHQgPSBbXQogICAgcyA9IFNlcXVlbmNlTWF0Y2hlcigpCiAgICBzLnNldF9zZXEyKHdvcmQpCiAgICBmb3IgeCBpbiBwb3NzaWJpbGl0aWVzOgogICAgICAgIHMuc2V0X3NlcTEoeCkKICAgICAgICBpZiBzLnJlYWxfcXVpY2tfcmF0aW8oKSA+PSBjdXRvZmYgYW5kIFwKICAgICAgICAgICBzLnF1aWNrX3JhdGlvKCkgPj0gY3V0b2ZmIGFuZCBcCiAgICAgICAgICAgcy5yYXRpbygpID49IGN1dG9mZjoKICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgocy5yYXRpbygpLCB4KSkKCiAgICAjIE1vdmUgdGhlIGJlc3Qgc2NvcmVycyB0byBoZWFkIG9mIGxpc3QKICAgIHJlc3VsdCA9IGhlYXBxLm5sYXJnZXN0KG4sIHJlc3VsdCkKICAgICMgU3RyaXAgc2NvcmVzIGZvciB0aGUgYmVzdCBuIG1hdGNoZXMKICAgIHJldHVybiBbeCBmb3Igc2NvcmUsIHggaW4gcmVzdWx0XQoKZGVmIF9jb3VudF9sZWFkaW5nKGxpbmUsIGNoKToKICAgICIiIgogICAgUmV0dXJuIG51bWJlciBvZiBgY2hgIGNoYXJhY3RlcnMgYXQgdGhlIHN0YXJ0IG9mIGBsaW5lYC4KCiAgICBFeGFtcGxlOgoKICAgID4+PiBfY291bnRfbGVhZGluZygnICAgYWJjJywgJyAnKQogICAgMwogICAgIiIiCgogICAgaSwgbiA9IDAsIGxlbihsaW5lKQogICAgd2hpbGUgaSA8IG4gYW5kIGxpbmVbaV0gPT0gY2g6CiAgICAgICAgaSArPSAxCiAgICByZXR1cm4gaQoKY2xhc3MgRGlmZmVyOgogICAgciIiIgogICAgRGlmZmVyIGlzIGEgY2xhc3MgZm9yIGNvbXBhcmluZyBzZXF1ZW5jZXMgb2YgbGluZXMgb2YgdGV4dCwgYW5kCiAgICBwcm9kdWNpbmcgaHVtYW4tcmVhZGFibGUgZGlmZmVyZW5jZXMgb3IgZGVsdGFzLiAgRGlmZmVyIHVzZXMKICAgIFNlcXVlbmNlTWF0Y2hlciBib3RoIHRvIGNvbXBhcmUgc2VxdWVuY2VzIG9mIGxpbmVzLCBhbmQgdG8gY29tcGFyZQogICAgc2VxdWVuY2VzIG9mIGNoYXJhY3RlcnMgd2l0aGluIHNpbWlsYXIgKG5lYXItbWF0Y2hpbmcpIGxpbmVzLgoKICAgIEVhY2ggbGluZSBvZiBhIERpZmZlciBkZWx0YSBiZWdpbnMgd2l0aCBhIHR3by1sZXR0ZXIgY29kZToKCiAgICAgICAgJy0gJyAgICBsaW5lIHVuaXF1ZSB0byBzZXF1ZW5jZSAxCiAgICAgICAgJysgJyAgICBsaW5lIHVuaXF1ZSB0byBzZXF1ZW5jZSAyCiAgICAgICAgJyAgJyAgICBsaW5lIGNvbW1vbiB0byBib3RoIHNlcXVlbmNlcwogICAgICAgICc/ICcgICAgbGluZSBub3QgcHJlc2VudCBpbiBlaXRoZXIgaW5wdXQgc2VxdWVuY2UKCiAgICBMaW5lcyBiZWdpbm5pbmcgd2l0aCAnPyAnIGF0dGVtcHQgdG8gZ3VpZGUgdGhlIGV5ZSB0byBpbnRyYWxpbmUKICAgIGRpZmZlcmVuY2VzLCBhbmQgd2VyZSBub3QgcHJlc2VudCBpbiBlaXRoZXIgaW5wdXQgc2VxdWVuY2UuICBUaGVzZSBsaW5lcwogICAgY2FuIGJlIGNvbmZ1c2luZyBpZiB0aGUgc2VxdWVuY2VzIGNvbnRhaW4gdGFiIGNoYXJhY3RlcnMuCgogICAgTm90ZSB0aGF0IERpZmZlciBtYWtlcyBubyBjbGFpbSB0byBwcm9kdWNlIGEgKm1pbmltYWwqIGRpZmYuICBUbyB0aGUKICAgIGNvbnRyYXJ5LCBtaW5pbWFsIGRpZmZzIGFyZSBvZnRlbiBjb3VudGVyLWludHVpdGl2ZSwgYmVjYXVzZSB0aGV5IHN5bmNoCiAgICB1cCBhbnl3aGVyZSBwb3NzaWJsZSwgc29tZXRpbWVzIGFjY2lkZW50YWwgbWF0Y2hlcyAxMDAgcGFnZXMgYXBhcnQuCiAgICBSZXN0cmljdGluZyBzeW5jaCBwb2ludHMgdG8gY29udGlndW91cyBtYXRjaGVzIHByZXNlcnZlcyBzb21lIG5vdGlvbiBvZgogICAgbG9jYWxpdHksIGF0IHRoZSBvY2Nhc2lvbmFsIGNvc3Qgb2YgcHJvZHVjaW5nIGEgbG9uZ2VyIGRpZmYuCgogICAgRXhhbXBsZTogQ29tcGFyaW5nIHR3byB0ZXh0cy4KCiAgICBGaXJzdCB3ZSBzZXQgdXAgdGhlIHRleHRzLCBzZXF1ZW5jZXMgb2YgaW5kaXZpZHVhbCBzaW5nbGUtbGluZSBzdHJpbmdzCiAgICBlbmRpbmcgd2l0aCBuZXdsaW5lcyAoc3VjaCBzZXF1ZW5jZXMgY2FuIGFsc28gYmUgb2J0YWluZWQgZnJvbSB0aGUKICAgIGByZWFkbGluZXMoKWAgbWV0aG9kIG9mIGZpbGUtbGlrZSBvYmplY3RzKToKCiAgICA+Pj4gdGV4dDEgPSAnJycgIDEuIEJlYXV0aWZ1bCBpcyBiZXR0ZXIgdGhhbiB1Z2x5LgogICAgLi4uICAgMi4gRXhwbGljaXQgaXMgYmV0dGVyIHRoYW4gaW1wbGljaXQuCiAgICAuLi4gICAzLiBTaW1wbGUgaXMgYmV0dGVyIHRoYW4gY29tcGxleC4KICAgIC4uLiAgIDQuIENvbXBsZXggaXMgYmV0dGVyIHRoYW4gY29tcGxpY2F0ZWQuCiAgICAuLi4gJycnLnNwbGl0bGluZXMoa2VlcGVuZHM9VHJ1ZSkKICAgID4+PiBsZW4odGV4dDEpCiAgICA0CiAgICA+Pj4gdGV4dDFbMF1bLTFdCiAgICAnXG4nCiAgICA+Pj4gdGV4dDIgPSAnJycgIDEuIEJlYXV0aWZ1bCBpcyBiZXR0ZXIgdGhhbiB1Z2x5LgogICAgLi4uICAgMy4gICBTaW1wbGUgaXMgYmV0dGVyIHRoYW4gY29tcGxleC4KICAgIC4uLiAgIDQuIENvbXBsaWNhdGVkIGlzIGJldHRlciB0aGFuIGNvbXBsZXguCiAgICAuLi4gICA1LiBGbGF0IGlzIGJldHRlciB0aGFuIG5lc3RlZC4KICAgIC4uLiAnJycuc3BsaXRsaW5lcyhrZWVwZW5kcz1UcnVlKQoKICAgIE5leHQgd2UgaW5zdGFudGlhdGUgYSBEaWZmZXIgb2JqZWN0OgoKICAgID4+PiBkID0gRGlmZmVyKCkKCiAgICBOb3RlIHRoYXQgd2hlbiBpbnN0YW50aWF0aW5nIGEgRGlmZmVyIG9iamVjdCB3ZSBtYXkgcGFzcyBmdW5jdGlvbnMgdG8KICAgIGZpbHRlciBvdXQgbGluZSBhbmQgY2hhcmFjdGVyICdqdW5rJy4gIFNlZSBEaWZmZXIuX19pbml0X18gZm9yIGRldGFpbHMuCgogICAgRmluYWxseSwgd2UgY29tcGFyZSB0aGUgdHdvOgoKICAgID4+PiByZXN1bHQgPSBsaXN0KGQuY29tcGFyZSh0ZXh0MSwgdGV4dDIpKQoKICAgICdyZXN1bHQnIGlzIGEgbGlzdCBvZiBzdHJpbmdzLCBzbyBsZXQncyBwcmV0dHktcHJpbnQgaXQ6CgogICAgPj4+IGZyb20gcHByaW50IGltcG9ydCBwcHJpbnQgYXMgX3BwcmludAogICAgPj4+IF9wcHJpbnQocmVzdWx0KQogICAgWycgICAgMS4gQmVhdXRpZnVsIGlzIGJldHRlciB0aGFuIHVnbHkuXG4nLAogICAgICctICAgMi4gRXhwbGljaXQgaXMgYmV0dGVyIHRoYW4gaW1wbGljaXQuXG4nLAogICAgICctICAgMy4gU2ltcGxlIGlzIGJldHRlciB0aGFuIGNvbXBsZXguXG4nLAogICAgICcrICAgMy4gICBTaW1wbGUgaXMgYmV0dGVyIHRoYW4gY29tcGxleC5cbicsCiAgICAgJz8gICAgICsrXG4nLAogICAgICctICAgNC4gQ29tcGxleCBpcyBiZXR0ZXIgdGhhbiBjb21wbGljYXRlZC5cbicsCiAgICAgJz8gICAgICAgICAgICBeICAgICAgICAgICAgICAgICAgICAgLS0tLSBeXG4nLAogICAgICcrICAgNC4gQ29tcGxpY2F0ZWQgaXMgYmV0dGVyIHRoYW4gY29tcGxleC5cbicsCiAgICAgJz8gICAgICAgICAgICsrKysgXiAgICAgICAgICAgICAgICAgICAgICBeXG4nLAogICAgICcrICAgNS4gRmxhdCBpcyBiZXR0ZXIgdGhhbiBuZXN0ZWQuXG4nXQoKICAgIEFzIGEgc2luZ2xlIG11bHRpLWxpbmUgc3RyaW5nIGl0IGxvb2tzIGxpa2UgdGhpczoKCiAgICA+Pj4gcHJpbnQoJycuam9pbihyZXN1bHQpLCBlbmQ9IiIpCiAgICAgICAgMS4gQmVhdXRpZnVsIGlzIGJldHRlciB0aGFuIHVnbHkuCiAgICAtICAgMi4gRXhwbGljaXQgaXMgYmV0dGVyIHRoYW4gaW1wbGljaXQuCiAgICAtICAgMy4gU2ltcGxlIGlzIGJldHRlciB0aGFuIGNvbXBsZXguCiAgICArICAgMy4gICBTaW1wbGUgaXMgYmV0dGVyIHRoYW4gY29tcGxleC4KICAgID8gICAgICsrCiAgICAtICAgNC4gQ29tcGxleCBpcyBiZXR0ZXIgdGhhbiBjb21wbGljYXRlZC4KICAgID8gICAgICAgICAgICBeICAgICAgICAgICAgICAgICAgICAgLS0tLSBeCiAgICArICAgNC4gQ29tcGxpY2F0ZWQgaXMgYmV0dGVyIHRoYW4gY29tcGxleC4KICAgID8gICAgICAgICAgICsrKysgXiAgICAgICAgICAgICAgICAgICAgICBeCiAgICArICAgNS4gRmxhdCBpcyBiZXR0ZXIgdGhhbiBuZXN0ZWQuCgogICAgTWV0aG9kczoKCiAgICBfX2luaXRfXyhsaW5lanVuaz1Ob25lLCBjaGFyanVuaz1Ob25lKQogICAgICAgIENvbnN0cnVjdCBhIHRleHQgZGlmZmVyZW5jZXIsIHdpdGggb3B0aW9uYWwgZmlsdGVycy4KCiAgICBjb21wYXJlKGEsIGIpCiAgICAgICAgQ29tcGFyZSB0d28gc2VxdWVuY2VzIG9mIGxpbmVzOyBnZW5lcmF0ZSB0aGUgcmVzdWx0aW5nIGRlbHRhLgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGxpbmVqdW5rPU5vbmUsIGNoYXJqdW5rPU5vbmUpOgogICAgICAgICIiIgogICAgICAgIENvbnN0cnVjdCBhIHRleHQgZGlmZmVyZW5jZXIsIHdpdGggb3B0aW9uYWwgZmlsdGVycy4KCiAgICAgICAgVGhlIHR3byBvcHRpb25hbCBrZXl3b3JkIHBhcmFtZXRlcnMgYXJlIGZvciBmaWx0ZXIgZnVuY3Rpb25zOgoKICAgICAgICAtIGBsaW5lanVua2A6IEEgZnVuY3Rpb24gdGhhdCBzaG91bGQgYWNjZXB0IGEgc2luZ2xlIHN0cmluZyBhcmd1bWVudCwKICAgICAgICAgIGFuZCByZXR1cm4gdHJ1ZSBpZmYgdGhlIHN0cmluZyBpcyBqdW5rLiBUaGUgbW9kdWxlLWxldmVsIGZ1bmN0aW9uCiAgICAgICAgICBgSVNfTElORV9KVU5LYCBtYXkgYmUgdXNlZCB0byBmaWx0ZXIgb3V0IGxpbmVzIHdpdGhvdXQgdmlzaWJsZQogICAgICAgICAgY2hhcmFjdGVycywgZXhjZXB0IGZvciBhdCBtb3N0IG9uZSBzcGxhdCAoJyMnKS4gIEl0IGlzIHJlY29tbWVuZGVkCiAgICAgICAgICB0byBsZWF2ZSBsaW5lanVuayBOb25lOyBhcyBvZiBQeXRob24gMi4zLCB0aGUgdW5kZXJseWluZwogICAgICAgICAgU2VxdWVuY2VNYXRjaGVyIGNsYXNzIGhhcyBncm93biBhbiBhZGFwdGl2ZSBub3Rpb24gb2YgIm5vaXNlIiBsaW5lcwogICAgICAgICAgdGhhdCdzIGJldHRlciB0aGFuIGFueSBzdGF0aWMgZGVmaW5pdGlvbiB0aGUgYXV0aG9yIGhhcyBldmVyIGJlZW4KICAgICAgICAgIGFibGUgdG8gY3JhZnQuCgogICAgICAgIC0gYGNoYXJqdW5rYDogQSBmdW5jdGlvbiB0aGF0IHNob3VsZCBhY2NlcHQgYSBzdHJpbmcgb2YgbGVuZ3RoIDEuIFRoZQogICAgICAgICAgbW9kdWxlLWxldmVsIGZ1bmN0aW9uIGBJU19DSEFSQUNURVJfSlVOS2AgbWF5IGJlIHVzZWQgdG8gZmlsdGVyIG91dAogICAgICAgICAgd2hpdGVzcGFjZSBjaGFyYWN0ZXJzIChhIGJsYW5rIG9yIHRhYjsgKipub3RlKio6IGJhZCBpZGVhIHRvIGluY2x1ZGUKICAgICAgICAgIG5ld2xpbmUgaW4gdGhpcyEpLiAgVXNlIG9mIElTX0NIQVJBQ1RFUl9KVU5LIGlzIHJlY29tbWVuZGVkLgogICAgICAgICIiIgoKICAgICAgICBzZWxmLmxpbmVqdW5rID0gbGluZWp1bmsKICAgICAgICBzZWxmLmNoYXJqdW5rID0gY2hhcmp1bmsKCiAgICBkZWYgY29tcGFyZShzZWxmLCBhLCBiKToKICAgICAgICByIiIiCiAgICAgICAgQ29tcGFyZSB0d28gc2VxdWVuY2VzIG9mIGxpbmVzOyBnZW5lcmF0ZSB0aGUgcmVzdWx0aW5nIGRlbHRhLgoKICAgICAgICBFYWNoIHNlcXVlbmNlIG11c3QgY29udGFpbiBpbmRpdmlkdWFsIHNpbmdsZS1saW5lIHN0cmluZ3MgZW5kaW5nIHdpdGgKICAgICAgICBuZXdsaW5lcy4gU3VjaCBzZXF1ZW5jZXMgY2FuIGJlIG9idGFpbmVkIGZyb20gdGhlIGByZWFkbGluZXMoKWAgbWV0aG9kCiAgICAgICAgb2YgZmlsZS1saWtlIG9iamVjdHMuICBUaGUgZGVsdGEgZ2VuZXJhdGVkIGFsc28gY29uc2lzdHMgb2YgbmV3bGluZS0KICAgICAgICB0ZXJtaW5hdGVkIHN0cmluZ3MsIHJlYWR5IHRvIGJlIHByaW50ZWQgYXMtaXMgdmlhIHRoZSB3cml0ZWxpbmUoKQogICAgICAgIG1ldGhvZCBvZiBhIGZpbGUtbGlrZSBvYmplY3QuCgogICAgICAgIEV4YW1wbGU6CgogICAgICAgID4+PiBwcmludCgnJy5qb2luKERpZmZlcigpLmNvbXBhcmUoJ29uZVxudHdvXG50aHJlZVxuJy5zcGxpdGxpbmVzKFRydWUpLAogICAgICAgIC4uLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29yZVxudHJlZVxuZW11XG4nLnNwbGl0bGluZXMoVHJ1ZSkpKSwKICAgICAgICAuLi4gICAgICAgZW5kPSIiKQogICAgICAgIC0gb25lCiAgICAgICAgPyAgXgogICAgICAgICsgb3JlCiAgICAgICAgPyAgXgogICAgICAgIC0gdHdvCiAgICAgICAgLSB0aHJlZQogICAgICAgID8gIC0KICAgICAgICArIHRyZWUKICAgICAgICArIGVtdQogICAgICAgICIiIgoKICAgICAgICBjcnVuY2hlciA9IFNlcXVlbmNlTWF0Y2hlcihzZWxmLmxpbmVqdW5rLCBhLCBiKQogICAgICAgIGZvciB0YWcsIGFsbywgYWhpLCBibG8sIGJoaSBpbiBjcnVuY2hlci5nZXRfb3Bjb2RlcygpOgogICAgICAgICAgICBpZiB0YWcgPT0gJ3JlcGxhY2UnOgogICAgICAgICAgICAgICAgZyA9IHNlbGYuX2ZhbmN5X3JlcGxhY2UoYSwgYWxvLCBhaGksIGIsIGJsbywgYmhpKQogICAgICAgICAgICBlbGlmIHRhZyA9PSAnZGVsZXRlJzoKICAgICAgICAgICAgICAgIGcgPSBzZWxmLl9kdW1wKCctJywgYSwgYWxvLCBhaGkpCiAgICAgICAgICAgIGVsaWYgdGFnID09ICdpbnNlcnQnOgogICAgICAgICAgICAgICAgZyA9IHNlbGYuX2R1bXAoJysnLCBiLCBibG8sIGJoaSkKICAgICAgICAgICAgZWxpZiB0YWcgPT0gJ2VxdWFsJzoKICAgICAgICAgICAgICAgIGcgPSBzZWxmLl9kdW1wKCcgJywgYSwgYWxvLCBhaGkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCd1bmtub3duIHRhZyAlcicgJSAodGFnLCkpCgogICAgICAgICAgICBmb3IgbGluZSBpbiBnOgogICAgICAgICAgICAgICAgeWllbGQgbGluZQoKICAgIGRlZiBfZHVtcChzZWxmLCB0YWcsIHgsIGxvLCBoaSk6CiAgICAgICAgIiIiR2VuZXJhdGUgY29tcGFyaXNvbiByZXN1bHRzIGZvciBhIHNhbWUtdGFnZ2VkIHJhbmdlLiIiIgogICAgICAgIGZvciBpIGluIHJhbmdlKGxvLCBoaSk6CiAgICAgICAgICAgIHlpZWxkICclcyAlcycgJSAodGFnLCB4W2ldKQoKICAgIGRlZiBfcGxhaW5fcmVwbGFjZShzZWxmLCBhLCBhbG8sIGFoaSwgYiwgYmxvLCBiaGkpOgogICAgICAgIGFzc2VydCBhbG8gPCBhaGkgYW5kIGJsbyA8IGJoaQogICAgICAgICMgZHVtcCB0aGUgc2hvcnRlciBibG9jayBmaXJzdCAtLSByZWR1Y2VzIHRoZSBidXJkZW4gb24gc2hvcnQtdGVybQogICAgICAgICMgbWVtb3J5IGlmIHRoZSBibG9ja3MgYXJlIG9mIHZlcnkgZGlmZmVyZW50IHNpemVzCiAgICAgICAgaWYgYmhpIC0gYmxvIDwgYWhpIC0gYWxvOgogICAgICAgICAgICBmaXJzdCAgPSBzZWxmLl9kdW1wKCcrJywgYiwgYmxvLCBiaGkpCiAgICAgICAgICAgIHNlY29uZCA9IHNlbGYuX2R1bXAoJy0nLCBhLCBhbG8sIGFoaSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBmaXJzdCAgPSBzZWxmLl9kdW1wKCctJywgYSwgYWxvLCBhaGkpCiAgICAgICAgICAgIHNlY29uZCA9IHNlbGYuX2R1bXAoJysnLCBiLCBibG8sIGJoaSkKCiAgICAgICAgZm9yIGcgaW4gZmlyc3QsIHNlY29uZDoKICAgICAgICAgICAgZm9yIGxpbmUgaW4gZzoKICAgICAgICAgICAgICAgIHlpZWxkIGxpbmUKCiAgICBkZWYgX2ZhbmN5X3JlcGxhY2Uoc2VsZiwgYSwgYWxvLCBhaGksIGIsIGJsbywgYmhpKToKICAgICAgICByIiIiCiAgICAgICAgV2hlbiByZXBsYWNpbmcgb25lIGJsb2NrIG9mIGxpbmVzIHdpdGggYW5vdGhlciwgc2VhcmNoIHRoZSBibG9ja3MKICAgICAgICBmb3IgKnNpbWlsYXIqIGxpbmVzOyB0aGUgYmVzdC1tYXRjaGluZyBwYWlyIChpZiBhbnkpIGlzIHVzZWQgYXMgYQogICAgICAgIHN5bmNoIHBvaW50LCBhbmQgaW50cmFsaW5lIGRpZmZlcmVuY2UgbWFya2luZyBpcyBkb25lIG9uIHRoZQogICAgICAgIHNpbWlsYXIgcGFpci4gTG90cyBvZiB3b3JrLCBidXQgb2Z0ZW4gd29ydGggaXQuCgogICAgICAgIEV4YW1wbGU6CgogICAgICAgID4+PiBkID0gRGlmZmVyKCkKICAgICAgICA+Pj4gcmVzdWx0cyA9IGQuX2ZhbmN5X3JlcGxhY2UoWydhYmNEZWZnaGlKa2xcbiddLCAwLCAxLAogICAgICAgIC4uLiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbJ2FiY2RlZkdoaWprbFxuJ10sIDAsIDEpCiAgICAgICAgPj4+IHByaW50KCcnLmpvaW4ocmVzdWx0cyksIGVuZD0iIikKICAgICAgICAtIGFiY0RlZmdoaUprbAogICAgICAgID8gICAgXiAgXiAgXgogICAgICAgICsgYWJjZGVmR2hpamtsCiAgICAgICAgPyAgICBeICBeICBeCiAgICAgICAgIiIiCgogICAgICAgICMgZG9uJ3Qgc3luY2ggdXAgdW5sZXNzIHRoZSBsaW5lcyBoYXZlIGEgc2ltaWxhcml0eSBzY29yZSBvZiBhdAogICAgICAgICMgbGVhc3QgY3V0b2ZmOyBiZXN0X3JhdGlvIHRyYWNrcyB0aGUgYmVzdCBzY29yZSBzZWVuIHNvIGZhcgogICAgICAgIGJlc3RfcmF0aW8sIGN1dG9mZiA9IDAuNzQsIDAuNzUKICAgICAgICBjcnVuY2hlciA9IFNlcXVlbmNlTWF0Y2hlcihzZWxmLmNoYXJqdW5rKQogICAgICAgIGVxaSwgZXFqID0gTm9uZSwgTm9uZSAgICMgMXN0IGluZGljZXMgb2YgZXF1YWwgbGluZXMgKGlmIGFueSkKCiAgICAgICAgIyBzZWFyY2ggZm9yIHRoZSBwYWlyIHRoYXQgbWF0Y2hlcyBiZXN0IHdpdGhvdXQgYmVpbmcgaWRlbnRpY2FsCiAgICAgICAgIyAoaWRlbnRpY2FsIGxpbmVzIG11c3QgYmUganVuayBsaW5lcywgJiB3ZSBkb24ndCB3YW50IHRvIHN5bmNoIHVwCiAgICAgICAgIyBvbiBqdW5rIC0tIHVubGVzcyB3ZSBoYXZlIHRvKQogICAgICAgIGZvciBqIGluIHJhbmdlKGJsbywgYmhpKToKICAgICAgICAgICAgYmogPSBiW2pdCiAgICAgICAgICAgIGNydW5jaGVyLnNldF9zZXEyKGJqKQogICAgICAgICAgICBmb3IgaSBpbiByYW5nZShhbG8sIGFoaSk6CiAgICAgICAgICAgICAgICBhaSA9IGFbaV0KICAgICAgICAgICAgICAgIGlmIGFpID09IGJqOgogICAgICAgICAgICAgICAgICAgIGlmIGVxaSBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICBlcWksIGVxaiA9IGksIGoKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgY3J1bmNoZXIuc2V0X3NlcTEoYWkpCiAgICAgICAgICAgICAgICAjIGNvbXB1dGluZyBzaW1pbGFyaXR5IGlzIGV4cGVuc2l2ZSwgc28gdXNlIHRoZSBxdWljawogICAgICAgICAgICAgICAgIyB1cHBlciBib3VuZHMgZmlyc3QgLS0gaGF2ZSBzZWVuIHRoaXMgc3BlZWQgdXAgbWVzc3kKICAgICAgICAgICAgICAgICMgY29tcGFyZXMgYnkgYSBmYWN0b3Igb2YgMy4KICAgICAgICAgICAgICAgICMgbm90ZSB0aGF0IHJhdGlvKCkgaXMgb25seSBleHBlbnNpdmUgdG8gY29tcHV0ZSB0aGUgZmlyc3QKICAgICAgICAgICAgICAgICMgdGltZSBpdCdzIGNhbGxlZCBvbiBhIHNlcXVlbmNlIHBhaXI7IHRoZSBleHBlbnNpdmUgcGFydAogICAgICAgICAgICAgICAgIyBvZiB0aGUgY29tcHV0YXRpb24gaXMgY2FjaGVkIGJ5IGNydW5jaGVyCiAgICAgICAgICAgICAgICBpZiBjcnVuY2hlci5yZWFsX3F1aWNrX3JhdGlvKCkgPiBiZXN0X3JhdGlvIGFuZCBcCiAgICAgICAgICAgICAgICAgICAgICBjcnVuY2hlci5xdWlja19yYXRpbygpID4gYmVzdF9yYXRpbyBhbmQgXAogICAgICAgICAgICAgICAgICAgICAgY3J1bmNoZXIucmF0aW8oKSA+IGJlc3RfcmF0aW86CiAgICAgICAgICAgICAgICAgICAgYmVzdF9yYXRpbywgYmVzdF9pLCBiZXN0X2ogPSBjcnVuY2hlci5yYXRpbygpLCBpLCBqCiAgICAgICAgaWYgYmVzdF9yYXRpbyA8IGN1dG9mZjoKICAgICAgICAgICAgIyBubyBub24taWRlbnRpY2FsICJwcmV0dHkgY2xvc2UiIHBhaXIKICAgICAgICAgICAgaWYgZXFpIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAjIG5vIGlkZW50aWNhbCBwYWlyIGVpdGhlciAtLSB0cmVhdCBpdCBhcyBhIHN0cmFpZ2h0IHJlcGxhY2UKICAgICAgICAgICAgICAgIGZvciBsaW5lIGluIHNlbGYuX3BsYWluX3JlcGxhY2UoYSwgYWxvLCBhaGksIGIsIGJsbywgYmhpKToKICAgICAgICAgICAgICAgICAgICB5aWVsZCBsaW5lCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgIyBubyBjbG9zZSBwYWlyLCBidXQgYW4gaWRlbnRpY2FsIHBhaXIgLS0gc3luY2ggdXAgb24gdGhhdAogICAgICAgICAgICBiZXN0X2ksIGJlc3RfaiwgYmVzdF9yYXRpbyA9IGVxaSwgZXFqLCAxLjAKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIHRoZXJlJ3MgYSBjbG9zZSBwYWlyLCBzbyBmb3JnZXQgdGhlIGlkZW50aWNhbCBwYWlyIChpZiBhbnkpCiAgICAgICAgICAgIGVxaSA9IE5vbmUKCiAgICAgICAgIyBhW2Jlc3RfaV0gdmVyeSBzaW1pbGFyIHRvIGJbYmVzdF9qXTsgZXFpIGlzIE5vbmUgaWZmIHRoZXkncmUgbm90CiAgICAgICAgIyBpZGVudGljYWwKCiAgICAgICAgIyBwdW1wIG91dCBkaWZmcyBmcm9tIGJlZm9yZSB0aGUgc3luY2ggcG9pbnQKICAgICAgICBmb3IgbGluZSBpbiBzZWxmLl9mYW5jeV9oZWxwZXIoYSwgYWxvLCBiZXN0X2ksIGIsIGJsbywgYmVzdF9qKToKICAgICAgICAgICAgeWllbGQgbGluZQoKICAgICAgICAjIGRvIGludHJhbGluZSBtYXJraW5nIG9uIHRoZSBzeW5jaCBwYWlyCiAgICAgICAgYWVsdCwgYmVsdCA9IGFbYmVzdF9pXSwgYltiZXN0X2pdCiAgICAgICAgaWYgZXFpIGlzIE5vbmU6CiAgICAgICAgICAgICMgcHVtcCBvdXQgYSAnLScsICc/JywgJysnLCAnPycgcXVhZCBmb3IgdGhlIHN5bmNoZWQgbGluZXMKICAgICAgICAgICAgYXRhZ3MgPSBidGFncyA9ICIiCiAgICAgICAgICAgIGNydW5jaGVyLnNldF9zZXFzKGFlbHQsIGJlbHQpCiAgICAgICAgICAgIGZvciB0YWcsIGFpMSwgYWkyLCBiajEsIGJqMiBpbiBjcnVuY2hlci5nZXRfb3Bjb2RlcygpOgogICAgICAgICAgICAgICAgbGEsIGxiID0gYWkyIC0gYWkxLCBiajIgLSBiajEKICAgICAgICAgICAgICAgIGlmIHRhZyA9PSAncmVwbGFjZSc6CiAgICAgICAgICAgICAgICAgICAgYXRhZ3MgKz0gJ14nICogbGEKICAgICAgICAgICAgICAgICAgICBidGFncyArPSAnXicgKiBsYgogICAgICAgICAgICAgICAgZWxpZiB0YWcgPT0gJ2RlbGV0ZSc6CiAgICAgICAgICAgICAgICAgICAgYXRhZ3MgKz0gJy0nICogbGEKICAgICAgICAgICAgICAgIGVsaWYgdGFnID09ICdpbnNlcnQnOgogICAgICAgICAgICAgICAgICAgIGJ0YWdzICs9ICcrJyAqIGxiCiAgICAgICAgICAgICAgICBlbGlmIHRhZyA9PSAnZXF1YWwnOgogICAgICAgICAgICAgICAgICAgIGF0YWdzICs9ICcgJyAqIGxhCiAgICAgICAgICAgICAgICAgICAgYnRhZ3MgKz0gJyAnICogbGIKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigndW5rbm93biB0YWcgJXInICUgKHRhZywpKQogICAgICAgICAgICBmb3IgbGluZSBpbiBzZWxmLl9xZm9ybWF0KGFlbHQsIGJlbHQsIGF0YWdzLCBidGFncyk6CiAgICAgICAgICAgICAgICB5aWVsZCBsaW5lCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyB0aGUgc3luY2ggcGFpciBpcyBpZGVudGljYWwKICAgICAgICAgICAgeWllbGQgJyAgJyArIGFlbHQKCiAgICAgICAgIyBwdW1wIG91dCBkaWZmcyBmcm9tIGFmdGVyIHRoZSBzeW5jaCBwb2ludAogICAgICAgIGZvciBsaW5lIGluIHNlbGYuX2ZhbmN5X2hlbHBlcihhLCBiZXN0X2krMSwgYWhpLCBiLCBiZXN0X2orMSwgYmhpKToKICAgICAgICAgICAgeWllbGQgbGluZQoKICAgIGRlZiBfZmFuY3lfaGVscGVyKHNlbGYsIGEsIGFsbywgYWhpLCBiLCBibG8sIGJoaSk6CiAgICAgICAgZyA9IFtdCiAgICAgICAgaWYgYWxvIDwgYWhpOgogICAgICAgICAgICBpZiBibG8gPCBiaGk6CiAgICAgICAgICAgICAgICBnID0gc2VsZi5fZmFuY3lfcmVwbGFjZShhLCBhbG8sIGFoaSwgYiwgYmxvLCBiaGkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBnID0gc2VsZi5fZHVtcCgnLScsIGEsIGFsbywgYWhpKQogICAgICAgIGVsaWYgYmxvIDwgYmhpOgogICAgICAgICAgICBnID0gc2VsZi5fZHVtcCgnKycsIGIsIGJsbywgYmhpKQoKICAgICAgICBmb3IgbGluZSBpbiBnOgogICAgICAgICAgICB5aWVsZCBsaW5lCgogICAgZGVmIF9xZm9ybWF0KHNlbGYsIGFsaW5lLCBibGluZSwgYXRhZ3MsIGJ0YWdzKToKICAgICAgICByIiIiCiAgICAgICAgRm9ybWF0ICI/IiBvdXRwdXQgYW5kIGRlYWwgd2l0aCBsZWFkaW5nIHRhYnMuCgogICAgICAgIEV4YW1wbGU6CgogICAgICAgID4+PiBkID0gRGlmZmVyKCkKICAgICAgICA+Pj4gcmVzdWx0cyA9IGQuX3Fmb3JtYXQoJ1x0YWJjRGVmZ2hpSmtsXG4nLCAnXHRhYmNkZWZHaGlqa2xcbicsCiAgICAgICAgLi4uICAgICAgICAgICAgICAgICAgICAgICcgIF4gXiAgXiAgICAgICcsICcgIF4gXiAgXiAgICAgICcpCiAgICAgICAgPj4+IGZvciBsaW5lIGluIHJlc3VsdHM6IHByaW50KHJlcHIobGluZSkpCiAgICAgICAgLi4uCiAgICAgICAgJy0gXHRhYmNEZWZnaGlKa2xcbicKICAgICAgICAnPyBcdCBeIF4gIF5cbicKICAgICAgICAnKyBcdGFiY2RlZkdoaWprbFxuJwogICAgICAgICc/IFx0IF4gXiAgXlxuJwogICAgICAgICIiIgoKICAgICAgICAjIENhbiBodXJ0LCBidXQgd2lsbCBwcm9iYWJseSBoZWxwIG1vc3Qgb2YgdGhlIHRpbWUuCiAgICAgICAgY29tbW9uID0gbWluKF9jb3VudF9sZWFkaW5nKGFsaW5lLCAiXHQiKSwKICAgICAgICAgICAgICAgICAgICAgX2NvdW50X2xlYWRpbmcoYmxpbmUsICJcdCIpKQogICAgICAgIGNvbW1vbiA9IG1pbihjb21tb24sIF9jb3VudF9sZWFkaW5nKGF0YWdzWzpjb21tb25dLCAiICIpKQogICAgICAgIGNvbW1vbiA9IG1pbihjb21tb24sIF9jb3VudF9sZWFkaW5nKGJ0YWdzWzpjb21tb25dLCAiICIpKQogICAgICAgIGF0YWdzID0gYXRhZ3NbY29tbW9uOl0ucnN0cmlwKCkKICAgICAgICBidGFncyA9IGJ0YWdzW2NvbW1vbjpdLnJzdHJpcCgpCgogICAgICAgIHlpZWxkICItICIgKyBhbGluZQogICAgICAgIGlmIGF0YWdzOgogICAgICAgICAgICB5aWVsZCAiPyAlcyVzXG4iICUgKCJcdCIgKiBjb21tb24sIGF0YWdzKQoKICAgICAgICB5aWVsZCAiKyAiICsgYmxpbmUKICAgICAgICBpZiBidGFnczoKICAgICAgICAgICAgeWllbGQgIj8gJXMlc1xuIiAlICgiXHQiICogY29tbW9uLCBidGFncykKCiMgV2l0aCByZXNwZWN0IHRvIGp1bmssIGFuIGVhcmxpZXIgdmVyc2lvbiBvZiBuZGlmZiBzaW1wbHkgcmVmdXNlZCB0bwojICpzdGFydCogYSBtYXRjaCB3aXRoIGEganVuayBlbGVtZW50LiAgVGhlIHJlc3VsdCB3YXMgY2FzZXMgbGlrZSB0aGlzOgojICAgICBiZWZvcmU6IHByaXZhdGUgVGhyZWFkIGN1cnJlbnRUaHJlYWQ7CiMgICAgIGFmdGVyOiAgcHJpdmF0ZSB2b2xhdGlsZSBUaHJlYWQgY3VycmVudFRocmVhZDsKIyBJZiB5b3UgY29uc2lkZXIgd2hpdGVzcGFjZSB0byBiZSBqdW5rLCB0aGUgbG9uZ2VzdCBjb250aWd1b3VzIG1hdGNoCiMgbm90IHN0YXJ0aW5nIHdpdGgganVuayBpcyAiZSBUaHJlYWQgY3VycmVudFRocmVhZCIuICBTbyBuZGlmZiByZXBvcnRlZAojIHRoYXQgImUgdm9sYXRpbCIgd2FzIGluc2VydGVkIGJldHdlZW4gdGhlICd0JyBhbmQgdGhlICdlJyBpbiAicHJpdmF0ZSIuCiMgV2hpbGUgYW4gYWNjdXJhdGUgdmlldywgdG8gcGVvcGxlIHRoYXQncyBhYnN1cmQuICBUaGUgY3VycmVudCB2ZXJzaW9uCiMgbG9va3MgZm9yIG1hdGNoaW5nIGJsb2NrcyB0aGF0IGFyZSBlbnRpcmVseSBqdW5rLWZyZWUsIHRoZW4gZXh0ZW5kcyB0aGUKIyBsb25nZXN0IG9uZSBvZiB0aG9zZSBhcyBmYXIgYXMgcG9zc2libGUgYnV0IG9ubHkgd2l0aCBtYXRjaGluZyBqdW5rLgojIFNvIG5vdyAiY3VycmVudFRocmVhZCIgaXMgbWF0Y2hlZCwgdGhlbiBleHRlbmRlZCB0byBzdWNrIHVwIHRoZQojIHByZWNlZGluZyBibGFuazsgdGhlbiAicHJpdmF0ZSIgaXMgbWF0Y2hlZCwgYW5kIGV4dGVuZGVkIHRvIHN1Y2sgdXAgdGhlCiMgZm9sbG93aW5nIGJsYW5rOyB0aGVuICJUaHJlYWQiIGlzIG1hdGNoZWQ7IGFuZCBmaW5hbGx5IG5kaWZmIHJlcG9ydHMKIyB0aGF0ICJ2b2xhdGlsZSAiIHdhcyBpbnNlcnRlZCBiZWZvcmUgIlRocmVhZCIuICBUaGUgb25seSBxdWliYmxlCiMgcmVtYWluaW5nIGlzIHRoYXQgcGVyaGFwcyBpdCB3YXMgcmVhbGx5IHRoZSBjYXNlIHRoYXQgIiB2b2xhdGlsZSIKIyB3YXMgaW5zZXJ0ZWQgYWZ0ZXIgInByaXZhdGUiLiAgSSBjYW4gbGl2ZSB3aXRoIHRoYXQgPHdpbms+LgoKaW1wb3J0IHJlCgpkZWYgSVNfTElORV9KVU5LKGxpbmUsIHBhdD1yZS5jb21waWxlKHIiXHMqIz9ccyokIikubWF0Y2gpOgogICAgciIiIgogICAgUmV0dXJuIDEgZm9yIGlnbm9yYWJsZSBsaW5lOiBpZmYgYGxpbmVgIGlzIGJsYW5rIG9yIGNvbnRhaW5zIGEgc2luZ2xlICcjJy4KCiAgICBFeGFtcGxlczoKCiAgICA+Pj4gSVNfTElORV9KVU5LKCdcbicpCiAgICBUcnVlCiAgICA+Pj4gSVNfTElORV9KVU5LKCcgICMgICBcbicpCiAgICBUcnVlCiAgICA+Pj4gSVNfTElORV9KVU5LKCdoZWxsb1xuJykKICAgIEZhbHNlCiAgICAiIiIKCiAgICByZXR1cm4gcGF0KGxpbmUpIGlzIG5vdCBOb25lCgpkZWYgSVNfQ0hBUkFDVEVSX0pVTksoY2gsIHdzPSIgXHQiKToKICAgIHIiIiIKICAgIFJldHVybiAxIGZvciBpZ25vcmFibGUgY2hhcmFjdGVyOiBpZmYgYGNoYCBpcyBhIHNwYWNlIG9yIHRhYi4KCiAgICBFeGFtcGxlczoKCiAgICA+Pj4gSVNfQ0hBUkFDVEVSX0pVTksoJyAnKQogICAgVHJ1ZQogICAgPj4+IElTX0NIQVJBQ1RFUl9KVU5LKCdcdCcpCiAgICBUcnVlCiAgICA+Pj4gSVNfQ0hBUkFDVEVSX0pVTksoJ1xuJykKICAgIEZhbHNlCiAgICA+Pj4gSVNfQ0hBUkFDVEVSX0pVTksoJ3gnKQogICAgRmFsc2UKICAgICIiIgoKICAgIHJldHVybiBjaCBpbiB3cwoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMgIFVuaWZpZWQgRGlmZgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBfZm9ybWF0X3JhbmdlX3VuaWZpZWQoc3RhcnQsIHN0b3ApOgogICAgJ0NvbnZlcnQgcmFuZ2UgdG8gdGhlICJlZCIgZm9ybWF0JwogICAgIyBQZXIgdGhlIGRpZmYgc3BlYyBhdCBodHRwOi8vd3d3LnVuaXgub3JnL3NpbmdsZV91bml4X3NwZWNpZmljYXRpb24vCiAgICBiZWdpbm5pbmcgPSBzdGFydCArIDEgICAgICMgbGluZXMgc3RhcnQgbnVtYmVyaW5nIHdpdGggb25lCiAgICBsZW5ndGggPSBzdG9wIC0gc3RhcnQKICAgIGlmIGxlbmd0aCA9PSAxOgogICAgICAgIHJldHVybiAne30nLmZvcm1hdChiZWdpbm5pbmcpCiAgICBpZiBub3QgbGVuZ3RoOgogICAgICAgIGJlZ2lubmluZyAtPSAxICAgICAgICAjIGVtcHR5IHJhbmdlcyBiZWdpbiBhdCBsaW5lIGp1c3QgYmVmb3JlIHRoZSByYW5nZQogICAgcmV0dXJuICd7fSx7fScuZm9ybWF0KGJlZ2lubmluZywgbGVuZ3RoKQoKZGVmIHVuaWZpZWRfZGlmZihhLCBiLCBmcm9tZmlsZT0nJywgdG9maWxlPScnLCBmcm9tZmlsZWRhdGU9JycsCiAgICAgICAgICAgICAgICAgdG9maWxlZGF0ZT0nJywgbj0zLCBsaW5ldGVybT0nXG4nKToKICAgIHIiIiIKICAgIENvbXBhcmUgdHdvIHNlcXVlbmNlcyBvZiBsaW5lczsgZ2VuZXJhdGUgdGhlIGRlbHRhIGFzIGEgdW5pZmllZCBkaWZmLgoKICAgIFVuaWZpZWQgZGlmZnMgYXJlIGEgY29tcGFjdCB3YXkgb2Ygc2hvd2luZyBsaW5lIGNoYW5nZXMgYW5kIGEgZmV3CiAgICBsaW5lcyBvZiBjb250ZXh0LiAgVGhlIG51bWJlciBvZiBjb250ZXh0IGxpbmVzIGlzIHNldCBieSAnbicgd2hpY2gKICAgIGRlZmF1bHRzIHRvIHRocmVlLgoKICAgIEJ5IGRlZmF1bHQsIHRoZSBkaWZmIGNvbnRyb2wgbGluZXMgKHRob3NlIHdpdGggLS0tLCArKyssIG9yIEBAKSBhcmUKICAgIGNyZWF0ZWQgd2l0aCBhIHRyYWlsaW5nIG5ld2xpbmUuICBUaGlzIGlzIGhlbHBmdWwgc28gdGhhdCBpbnB1dHMKICAgIGNyZWF0ZWQgZnJvbSBmaWxlLnJlYWRsaW5lcygpIHJlc3VsdCBpbiBkaWZmcyB0aGF0IGFyZSBzdWl0YWJsZSBmb3IKICAgIGZpbGUud3JpdGVsaW5lcygpIHNpbmNlIGJvdGggdGhlIGlucHV0cyBhbmQgb3V0cHV0cyBoYXZlIHRyYWlsaW5nCiAgICBuZXdsaW5lcy4KCiAgICBGb3IgaW5wdXRzIHRoYXQgZG8gbm90IGhhdmUgdHJhaWxpbmcgbmV3bGluZXMsIHNldCB0aGUgbGluZXRlcm0KICAgIGFyZ3VtZW50IHRvICIiIHNvIHRoYXQgdGhlIG91dHB1dCB3aWxsIGJlIHVuaWZvcm1seSBuZXdsaW5lIGZyZWUuCgogICAgVGhlIHVuaWRpZmYgZm9ybWF0IG5vcm1hbGx5IGhhcyBhIGhlYWRlciBmb3IgZmlsZW5hbWVzIGFuZCBtb2RpZmljYXRpb24KICAgIHRpbWVzLiAgQW55IG9yIGFsbCBvZiB0aGVzZSBtYXkgYmUgc3BlY2lmaWVkIHVzaW5nIHN0cmluZ3MgZm9yCiAgICAnZnJvbWZpbGUnLCAndG9maWxlJywgJ2Zyb21maWxlZGF0ZScsIGFuZCAndG9maWxlZGF0ZScuCiAgICBUaGUgbW9kaWZpY2F0aW9uIHRpbWVzIGFyZSBub3JtYWxseSBleHByZXNzZWQgaW4gdGhlIElTTyA4NjAxIGZvcm1hdC4KCiAgICBFeGFtcGxlOgoKICAgID4+PiBmb3IgbGluZSBpbiB1bmlmaWVkX2RpZmYoJ29uZSB0d28gdGhyZWUgZm91cicuc3BsaXQoKSwKICAgIC4uLiAgICAgICAgICAgICAnemVybyBvbmUgdHJlZSBmb3VyJy5zcGxpdCgpLCAnT3JpZ2luYWwnLCAnQ3VycmVudCcsCiAgICAuLi4gICAgICAgICAgICAgJzIwMDUtMDEtMjYgMjM6MzA6NTAnLCAnMjAxMC0wNC0wMiAxMDoyMDo1MicsCiAgICAuLi4gICAgICAgICAgICAgbGluZXRlcm09JycpOgogICAgLi4uICAgICBwcmludChsaW5lKSAgICAgICAgICAgICAgICAgIyBkb2N0ZXN0OiArTk9STUFMSVpFX1dISVRFU1BBQ0UKICAgIC0tLSBPcmlnaW5hbCAgICAgICAgMjAwNS0wMS0yNiAyMzozMDo1MAogICAgKysrIEN1cnJlbnQgICAgICAgICAyMDEwLTA0LTAyIDEwOjIwOjUyCiAgICBAQCAtMSw0ICsxLDQgQEAKICAgICt6ZXJvCiAgICAgb25lCiAgICAtdHdvCiAgICAtdGhyZWUKICAgICt0cmVlCiAgICAgZm91cgogICAgIiIiCgogICAgc3RhcnRlZCA9IEZhbHNlCiAgICBmb3IgZ3JvdXAgaW4gU2VxdWVuY2VNYXRjaGVyKE5vbmUsYSxiKS5nZXRfZ3JvdXBlZF9vcGNvZGVzKG4pOgogICAgICAgIGlmIG5vdCBzdGFydGVkOgogICAgICAgICAgICBzdGFydGVkID0gVHJ1ZQogICAgICAgICAgICBmcm9tZGF0ZSA9ICdcdHt9Jy5mb3JtYXQoZnJvbWZpbGVkYXRlKSBpZiBmcm9tZmlsZWRhdGUgZWxzZSAnJwogICAgICAgICAgICB0b2RhdGUgPSAnXHR7fScuZm9ybWF0KHRvZmlsZWRhdGUpIGlmIHRvZmlsZWRhdGUgZWxzZSAnJwogICAgICAgICAgICB5aWVsZCAnLS0tIHt9e317fScuZm9ybWF0KGZyb21maWxlLCBmcm9tZGF0ZSwgbGluZXRlcm0pCiAgICAgICAgICAgIHlpZWxkICcrKysge317fXt9Jy5mb3JtYXQodG9maWxlLCB0b2RhdGUsIGxpbmV0ZXJtKQoKICAgICAgICBmaXJzdCwgbGFzdCA9IGdyb3VwWzBdLCBncm91cFstMV0KICAgICAgICBmaWxlMV9yYW5nZSA9IF9mb3JtYXRfcmFuZ2VfdW5pZmllZChmaXJzdFsxXSwgbGFzdFsyXSkKICAgICAgICBmaWxlMl9yYW5nZSA9IF9mb3JtYXRfcmFuZ2VfdW5pZmllZChmaXJzdFszXSwgbGFzdFs0XSkKICAgICAgICB5aWVsZCAnQEAgLXt9ICt7fSBAQHt9Jy5mb3JtYXQoZmlsZTFfcmFuZ2UsIGZpbGUyX3JhbmdlLCBsaW5ldGVybSkKCiAgICAgICAgZm9yIHRhZywgaTEsIGkyLCBqMSwgajIgaW4gZ3JvdXA6CiAgICAgICAgICAgIGlmIHRhZyA9PSAnZXF1YWwnOgogICAgICAgICAgICAgICAgZm9yIGxpbmUgaW4gYVtpMTppMl06CiAgICAgICAgICAgICAgICAgICAgeWllbGQgJyAnICsgbGluZQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgaWYgdGFnIGluIHsncmVwbGFjZScsICdkZWxldGUnfToKICAgICAgICAgICAgICAgIGZvciBsaW5lIGluIGFbaTE6aTJdOgogICAgICAgICAgICAgICAgICAgIHlpZWxkICctJyArIGxpbmUKICAgICAgICAgICAgaWYgdGFnIGluIHsncmVwbGFjZScsICdpbnNlcnQnfToKICAgICAgICAgICAgICAgIGZvciBsaW5lIGluIGJbajE6ajJdOgogICAgICAgICAgICAgICAgICAgIHlpZWxkICcrJyArIGxpbmUKCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjICBDb250ZXh0IERpZmYKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgX2Zvcm1hdF9yYW5nZV9jb250ZXh0KHN0YXJ0LCBzdG9wKToKICAgICdDb252ZXJ0IHJhbmdlIHRvIHRoZSAiZWQiIGZvcm1hdCcKICAgICMgUGVyIHRoZSBkaWZmIHNwZWMgYXQgaHR0cDovL3d3dy51bml4Lm9yZy9zaW5nbGVfdW5peF9zcGVjaWZpY2F0aW9uLwogICAgYmVnaW5uaW5nID0gc3RhcnQgKyAxICAgICAjIGxpbmVzIHN0YXJ0IG51bWJlcmluZyB3aXRoIG9uZQogICAgbGVuZ3RoID0gc3RvcCAtIHN0YXJ0CiAgICBpZiBub3QgbGVuZ3RoOgogICAgICAgIGJlZ2lubmluZyAtPSAxICAgICAgICAjIGVtcHR5IHJhbmdlcyBiZWdpbiBhdCBsaW5lIGp1c3QgYmVmb3JlIHRoZSByYW5nZQogICAgaWYgbGVuZ3RoIDw9IDE6CiAgICAgICAgcmV0dXJuICd7fScuZm9ybWF0KGJlZ2lubmluZykKICAgIHJldHVybiAne30se30nLmZvcm1hdChiZWdpbm5pbmcsIGJlZ2lubmluZyArIGxlbmd0aCAtIDEpCgojIFNlZSBodHRwOi8vd3d3LnVuaXgub3JnL3NpbmdsZV91bml4X3NwZWNpZmljYXRpb24vCmRlZiBjb250ZXh0X2RpZmYoYSwgYiwgZnJvbWZpbGU9JycsIHRvZmlsZT0nJywKICAgICAgICAgICAgICAgICBmcm9tZmlsZWRhdGU9JycsIHRvZmlsZWRhdGU9JycsIG49MywgbGluZXRlcm09J1xuJyk6CiAgICByIiIiCiAgICBDb21wYXJlIHR3byBzZXF1ZW5jZXMgb2YgbGluZXM7IGdlbmVyYXRlIHRoZSBkZWx0YSBhcyBhIGNvbnRleHQgZGlmZi4KCiAgICBDb250ZXh0IGRpZmZzIGFyZSBhIGNvbXBhY3Qgd2F5IG9mIHNob3dpbmcgbGluZSBjaGFuZ2VzIGFuZCBhIGZldwogICAgbGluZXMgb2YgY29udGV4dC4gIFRoZSBudW1iZXIgb2YgY29udGV4dCBsaW5lcyBpcyBzZXQgYnkgJ24nIHdoaWNoCiAgICBkZWZhdWx0cyB0byB0aHJlZS4KCiAgICBCeSBkZWZhdWx0LCB0aGUgZGlmZiBjb250cm9sIGxpbmVzICh0aG9zZSB3aXRoICoqKiBvciAtLS0pIGFyZQogICAgY3JlYXRlZCB3aXRoIGEgdHJhaWxpbmcgbmV3bGluZS4gIFRoaXMgaXMgaGVscGZ1bCBzbyB0aGF0IGlucHV0cwogICAgY3JlYXRlZCBmcm9tIGZpbGUucmVhZGxpbmVzKCkgcmVzdWx0IGluIGRpZmZzIHRoYXQgYXJlIHN1aXRhYmxlIGZvcgogICAgZmlsZS53cml0ZWxpbmVzKCkgc2luY2UgYm90aCB0aGUgaW5wdXRzIGFuZCBvdXRwdXRzIGhhdmUgdHJhaWxpbmcKICAgIG5ld2xpbmVzLgoKICAgIEZvciBpbnB1dHMgdGhhdCBkbyBub3QgaGF2ZSB0cmFpbGluZyBuZXdsaW5lcywgc2V0IHRoZSBsaW5ldGVybQogICAgYXJndW1lbnQgdG8gIiIgc28gdGhhdCB0aGUgb3V0cHV0IHdpbGwgYmUgdW5pZm9ybWx5IG5ld2xpbmUgZnJlZS4KCiAgICBUaGUgY29udGV4dCBkaWZmIGZvcm1hdCBub3JtYWxseSBoYXMgYSBoZWFkZXIgZm9yIGZpbGVuYW1lcyBhbmQKICAgIG1vZGlmaWNhdGlvbiB0aW1lcy4gIEFueSBvciBhbGwgb2YgdGhlc2UgbWF5IGJlIHNwZWNpZmllZCB1c2luZwogICAgc3RyaW5ncyBmb3IgJ2Zyb21maWxlJywgJ3RvZmlsZScsICdmcm9tZmlsZWRhdGUnLCBhbmQgJ3RvZmlsZWRhdGUnLgogICAgVGhlIG1vZGlmaWNhdGlvbiB0aW1lcyBhcmUgbm9ybWFsbHkgZXhwcmVzc2VkIGluIHRoZSBJU08gODYwMSBmb3JtYXQuCiAgICBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgc3RyaW5ncyBkZWZhdWx0IHRvIGJsYW5rcy4KCiAgICBFeGFtcGxlOgoKICAgID4+PiBwcmludCgnJy5qb2luKGNvbnRleHRfZGlmZignb25lXG50d29cbnRocmVlXG5mb3VyXG4nLnNwbGl0bGluZXMoVHJ1ZSksCiAgICAuLi4gICAgICAgJ3plcm9cbm9uZVxudHJlZVxuZm91clxuJy5zcGxpdGxpbmVzKFRydWUpLCAnT3JpZ2luYWwnLCAnQ3VycmVudCcpKSwKICAgIC4uLiAgICAgICBlbmQ9IiIpCiAgICAqKiogT3JpZ2luYWwKICAgIC0tLSBDdXJyZW50CiAgICAqKioqKioqKioqKioqKioKICAgICoqKiAxLDQgKioqKgogICAgICBvbmUKICAgICEgdHdvCiAgICAhIHRocmVlCiAgICAgIGZvdXIKICAgIC0tLSAxLDQgLS0tLQogICAgKyB6ZXJvCiAgICAgIG9uZQogICAgISB0cmVlCiAgICAgIGZvdXIKICAgICIiIgoKICAgIHByZWZpeCA9IGRpY3QoaW5zZXJ0PScrICcsIGRlbGV0ZT0nLSAnLCByZXBsYWNlPSchICcsIGVxdWFsPScgICcpCiAgICBzdGFydGVkID0gRmFsc2UKICAgIGZvciBncm91cCBpbiBTZXF1ZW5jZU1hdGNoZXIoTm9uZSxhLGIpLmdldF9ncm91cGVkX29wY29kZXMobik6CiAgICAgICAgaWYgbm90IHN0YXJ0ZWQ6CiAgICAgICAgICAgIHN0YXJ0ZWQgPSBUcnVlCiAgICAgICAgICAgIGZyb21kYXRlID0gJ1x0e30nLmZvcm1hdChmcm9tZmlsZWRhdGUpIGlmIGZyb21maWxlZGF0ZSBlbHNlICcnCiAgICAgICAgICAgIHRvZGF0ZSA9ICdcdHt9Jy5mb3JtYXQodG9maWxlZGF0ZSkgaWYgdG9maWxlZGF0ZSBlbHNlICcnCiAgICAgICAgICAgIHlpZWxkICcqKioge317fXt9Jy5mb3JtYXQoZnJvbWZpbGUsIGZyb21kYXRlLCBsaW5ldGVybSkKICAgICAgICAgICAgeWllbGQgJy0tLSB7fXt9e30nLmZvcm1hdCh0b2ZpbGUsIHRvZGF0ZSwgbGluZXRlcm0pCgogICAgICAgIGZpcnN0LCBsYXN0ID0gZ3JvdXBbMF0sIGdyb3VwWy0xXQogICAgICAgIHlpZWxkICcqKioqKioqKioqKioqKionICsgbGluZXRlcm0KCiAgICAgICAgZmlsZTFfcmFuZ2UgPSBfZm9ybWF0X3JhbmdlX2NvbnRleHQoZmlyc3RbMV0sIGxhc3RbMl0pCiAgICAgICAgeWllbGQgJyoqKiB7fSAqKioqe30nLmZvcm1hdChmaWxlMV9yYW5nZSwgbGluZXRlcm0pCgogICAgICAgIGlmIGFueSh0YWcgaW4geydyZXBsYWNlJywgJ2RlbGV0ZSd9IGZvciB0YWcsIF8sIF8sIF8sIF8gaW4gZ3JvdXApOgogICAgICAgICAgICBmb3IgdGFnLCBpMSwgaTIsIF8sIF8gaW4gZ3JvdXA6CiAgICAgICAgICAgICAgICBpZiB0YWcgIT0gJ2luc2VydCc6CiAgICAgICAgICAgICAgICAgICAgZm9yIGxpbmUgaW4gYVtpMTppMl06CiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHByZWZpeFt0YWddICsgbGluZQoKICAgICAgICBmaWxlMl9yYW5nZSA9IF9mb3JtYXRfcmFuZ2VfY29udGV4dChmaXJzdFszXSwgbGFzdFs0XSkKICAgICAgICB5aWVsZCAnLS0tIHt9IC0tLS17fScuZm9ybWF0KGZpbGUyX3JhbmdlLCBsaW5ldGVybSkKCiAgICAgICAgaWYgYW55KHRhZyBpbiB7J3JlcGxhY2UnLCAnaW5zZXJ0J30gZm9yIHRhZywgXywgXywgXywgXyBpbiBncm91cCk6CiAgICAgICAgICAgIGZvciB0YWcsIF8sIF8sIGoxLCBqMiBpbiBncm91cDoKICAgICAgICAgICAgICAgIGlmIHRhZyAhPSAnZGVsZXRlJzoKICAgICAgICAgICAgICAgICAgICBmb3IgbGluZSBpbiBiW2oxOmoyXToKICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgcHJlZml4W3RhZ10gKyBsaW5lCgpkZWYgbmRpZmYoYSwgYiwgbGluZWp1bms9Tm9uZSwgY2hhcmp1bms9SVNfQ0hBUkFDVEVSX0pVTkspOgogICAgciIiIgogICAgQ29tcGFyZSBgYWAgYW5kIGBiYCAobGlzdHMgb2Ygc3RyaW5ncyk7IHJldHVybiBhIGBEaWZmZXJgLXN0eWxlIGRlbHRhLgoKICAgIE9wdGlvbmFsIGtleXdvcmQgcGFyYW1ldGVycyBgbGluZWp1bmtgIGFuZCBgY2hhcmp1bmtgIGFyZSBmb3IgZmlsdGVyCiAgICBmdW5jdGlvbnMgKG9yIE5vbmUpOgoKICAgIC0gbGluZWp1bms6IEEgZnVuY3Rpb24gdGhhdCBzaG91bGQgYWNjZXB0IGEgc2luZ2xlIHN0cmluZyBhcmd1bWVudCwgYW5kCiAgICAgIHJldHVybiB0cnVlIGlmZiB0aGUgc3RyaW5nIGlzIGp1bmsuICBUaGUgZGVmYXVsdCBpcyBOb25lLCBhbmQgaXMKICAgICAgcmVjb21tZW5kZWQ7IGFzIG9mIFB5dGhvbiAyLjMsIGFuIGFkYXB0aXZlIG5vdGlvbiBvZiAibm9pc2UiIGxpbmVzIGlzCiAgICAgIHVzZWQgdGhhdCBkb2VzIGEgZ29vZCBqb2Igb24gaXRzIG93bi4KCiAgICAtIGNoYXJqdW5rOiBBIGZ1bmN0aW9uIHRoYXQgc2hvdWxkIGFjY2VwdCBhIHN0cmluZyBvZiBsZW5ndGggMS4gVGhlCiAgICAgIGRlZmF1bHQgaXMgbW9kdWxlLWxldmVsIGZ1bmN0aW9uIElTX0NIQVJBQ1RFUl9KVU5LLCB3aGljaCBmaWx0ZXJzIG91dAogICAgICB3aGl0ZXNwYWNlIGNoYXJhY3RlcnMgKGEgYmxhbmsgb3IgdGFiOyBub3RlOiBiYWQgaWRlYSB0byBpbmNsdWRlIG5ld2xpbmUKICAgICAgaW4gdGhpcyEpLgoKICAgIFRvb2xzL3NjcmlwdHMvbmRpZmYucHkgaXMgYSBjb21tYW5kLWxpbmUgZnJvbnQtZW5kIHRvIHRoaXMgZnVuY3Rpb24uCgogICAgRXhhbXBsZToKCiAgICA+Pj4gZGlmZiA9IG5kaWZmKCdvbmVcbnR3b1xudGhyZWVcbicuc3BsaXRsaW5lcyhrZWVwZW5kcz1UcnVlKSwKICAgIC4uLiAgICAgICAgICAgICAgJ29yZVxudHJlZVxuZW11XG4nLnNwbGl0bGluZXMoa2VlcGVuZHM9VHJ1ZSkpCiAgICA+Pj4gcHJpbnQoJycuam9pbihkaWZmKSwgZW5kPSIiKQogICAgLSBvbmUKICAgID8gIF4KICAgICsgb3JlCiAgICA/ICBeCiAgICAtIHR3bwogICAgLSB0aHJlZQogICAgPyAgLQogICAgKyB0cmVlCiAgICArIGVtdQogICAgIiIiCiAgICByZXR1cm4gRGlmZmVyKGxpbmVqdW5rLCBjaGFyanVuaykuY29tcGFyZShhLCBiKQoKZGVmIF9tZGlmZihmcm9tbGluZXMsIHRvbGluZXMsIGNvbnRleHQ9Tm9uZSwgbGluZWp1bms9Tm9uZSwKICAgICAgICAgICBjaGFyanVuaz1JU19DSEFSQUNURVJfSlVOSyk6CiAgICByIiIiUmV0dXJucyBnZW5lcmF0b3IgeWllbGRpbmcgbWFya2VkIHVwIGZyb20vdG8gc2lkZSBieSBzaWRlIGRpZmZlcmVuY2VzLgoKICAgIEFyZ3VtZW50czoKICAgIGZyb21saW5lcyAtLSBsaXN0IG9mIHRleHQgbGluZXMgdG8gY29tcGFyZWQgdG8gdG9saW5lcwogICAgdG9saW5lcyAtLSBsaXN0IG9mIHRleHQgbGluZXMgdG8gYmUgY29tcGFyZWQgdG8gZnJvbWxpbmVzCiAgICBjb250ZXh0IC0tIG51bWJlciBvZiBjb250ZXh0IGxpbmVzIHRvIGRpc3BsYXkgb24gZWFjaCBzaWRlIG9mIGRpZmZlcmVuY2UsCiAgICAgICAgICAgICAgIGlmIE5vbmUsIGFsbCBmcm9tL3RvIHRleHQgbGluZXMgd2lsbCBiZSBnZW5lcmF0ZWQuCiAgICBsaW5lanVuayAtLSBwYXNzZWQgb24gdG8gbmRpZmYgKHNlZSBuZGlmZiBkb2N1bWVudGF0aW9uKQogICAgY2hhcmp1bmsgLS0gcGFzc2VkIG9uIHRvIG5kaWZmIChzZWUgbmRpZmYgZG9jdW1lbnRhdGlvbikKCiAgICBUaGlzIGZ1bmN0aW9uIHJldHVybnMgYW4gaW50ZXJhdG9yIHdoaWNoIHJldHVybnMgYSB0dXBsZToKICAgIChmcm9tIGxpbmUgdHVwbGUsIHRvIGxpbmUgdHVwbGUsIGJvb2xlYW4gZmxhZykKCiAgICBmcm9tL3RvIGxpbmUgdHVwbGUgLS0gKGxpbmUgbnVtLCBsaW5lIHRleHQpCiAgICAgICAgbGluZSBudW0gLS0gaW50ZWdlciBvciBOb25lICh0byBpbmRpY2F0ZSBhIGNvbnRleHQgc2VwYXJhdGlvbikKICAgICAgICBsaW5lIHRleHQgLS0gb3JpZ2luYWwgbGluZSB0ZXh0IHdpdGggZm9sbG93aW5nIG1hcmtlcnMgaW5zZXJ0ZWQ6CiAgICAgICAgICAgICdcMCsnIC0tIG1hcmtzIHN0YXJ0IG9mIGFkZGVkIHRleHQKICAgICAgICAgICAgJ1wwLScgLS0gbWFya3Mgc3RhcnQgb2YgZGVsZXRlZCB0ZXh0CiAgICAgICAgICAgICdcMF4nIC0tIG1hcmtzIHN0YXJ0IG9mIGNoYW5nZWQgdGV4dAogICAgICAgICAgICAnXDEnIC0tIG1hcmtzIGVuZCBvZiBhZGRlZC9kZWxldGVkL2NoYW5nZWQgdGV4dAoKICAgIGJvb2xlYW4gZmxhZyAtLSBOb25lIGluZGljYXRlcyBjb250ZXh0IHNlcGFyYXRpb24sIFRydWUgaW5kaWNhdGVzCiAgICAgICAgZWl0aGVyICJmcm9tIiBvciAidG8iIGxpbmUgY29udGFpbnMgYSBjaGFuZ2UsIG90aGVyd2lzZSBGYWxzZS4KCiAgICBUaGlzIGZ1bmN0aW9uL2l0ZXJhdG9yIHdhcyBvcmlnaW5hbGx5IGRldmVsb3BlZCB0byBnZW5lcmF0ZSBzaWRlIGJ5IHNpZGUKICAgIGZpbGUgZGlmZmVyZW5jZSBmb3IgbWFraW5nIEhUTUwgcGFnZXMgKHNlZSBIdG1sRGlmZiBjbGFzcyBmb3IgZXhhbXBsZQogICAgdXNhZ2UpLgoKICAgIE5vdGUsIHRoaXMgZnVuY3Rpb24gdXRpbGl6ZXMgdGhlIG5kaWZmIGZ1bmN0aW9uIHRvIGdlbmVyYXRlIHRoZSBzaWRlIGJ5CiAgICBzaWRlIGRpZmZlcmVuY2UgbWFya3VwLiAgT3B0aW9uYWwgbmRpZmYgYXJndW1lbnRzIG1heSBiZSBwYXNzZWQgdG8gdGhpcwogICAgZnVuY3Rpb24gYW5kIHRoZXkgaW4gdHVybiB3aWxsIGJlIHBhc3NlZCB0byBuZGlmZi4KICAgICIiIgogICAgaW1wb3J0IHJlCgogICAgIyByZWd1bGFyIGV4cHJlc3Npb24gZm9yIGZpbmRpbmcgaW50cmFsaW5lIGNoYW5nZSBpbmRpY2VzCiAgICBjaGFuZ2VfcmUgPSByZS5jb21waWxlKCcoXCsrfFwtK3xcXispJykKCiAgICAjIGNyZWF0ZSB0aGUgZGlmZmVyZW5jZSBpdGVyYXRvciB0byBnZW5lcmF0ZSB0aGUgZGlmZmVyZW5jZXMKICAgIGRpZmZfbGluZXNfaXRlcmF0b3IgPSBuZGlmZihmcm9tbGluZXMsdG9saW5lcyxsaW5lanVuayxjaGFyanVuaykKCiAgICBkZWYgX21ha2VfbGluZShsaW5lcywgZm9ybWF0X2tleSwgc2lkZSwgbnVtX2xpbmVzPVswLDBdKToKICAgICAgICAiIiJSZXR1cm5zIGxpbmUgb2YgdGV4dCB3aXRoIHVzZXIncyBjaGFuZ2UgbWFya3VwIGFuZCBsaW5lIGZvcm1hdHRpbmcuCgogICAgICAgIGxpbmVzIC0tIGxpc3Qgb2YgbGluZXMgZnJvbSB0aGUgbmRpZmYgZ2VuZXJhdG9yIHRvIHByb2R1Y2UgYSBsaW5lIG9mCiAgICAgICAgICAgICAgICAgdGV4dCBmcm9tLiAgV2hlbiBwcm9kdWNpbmcgdGhlIGxpbmUgb2YgdGV4dCB0byByZXR1cm4sIHRoZQogICAgICAgICAgICAgICAgIGxpbmVzIHVzZWQgYXJlIHJlbW92ZWQgZnJvbSB0aGlzIGxpc3QuCiAgICAgICAgZm9ybWF0X2tleSAtLSAnKycgcmV0dXJuIGZpcnN0IGxpbmUgaW4gbGlzdCB3aXRoICJhZGQiIG1hcmt1cCBhcm91bmQKICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgZW50aXJlIGxpbmUuCiAgICAgICAgICAgICAgICAgICAgICAnLScgcmV0dXJuIGZpcnN0IGxpbmUgaW4gbGlzdCB3aXRoICJkZWxldGUiIG1hcmt1cCBhcm91bmQKICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgZW50aXJlIGxpbmUuCiAgICAgICAgICAgICAgICAgICAgICAnPycgcmV0dXJuIGZpcnN0IGxpbmUgaW4gbGlzdCB3aXRoIGFkZC9kZWxldGUvY2hhbmdlCiAgICAgICAgICAgICAgICAgICAgICAgICAgaW50cmFsaW5lIG1hcmt1cCAoaW5kaWNlcyBvYnRhaW5lZCBmcm9tIHNlY29uZCBsaW5lKQogICAgICAgICAgICAgICAgICAgICAgTm9uZSByZXR1cm4gZmlyc3QgbGluZSBpbiBsaXN0IHdpdGggbm8gbWFya3VwCiAgICAgICAgc2lkZSAtLSBpbmRpY2UgaW50byB0aGUgbnVtX2xpbmVzIGxpc3QgKDA9ZnJvbSwxPXRvKQogICAgICAgIG51bV9saW5lcyAtLSBmcm9tL3RvIGN1cnJlbnQgbGluZSBudW1iZXIuICBUaGlzIGlzIE5PVCBpbnRlbmRlZCB0byBiZSBhCiAgICAgICAgICAgICAgICAgICAgIHBhc3NlZCBwYXJhbWV0ZXIuICBJdCBpcyBwcmVzZW50IGFzIGEga2V5d29yZCBhcmd1bWVudCB0bwogICAgICAgICAgICAgICAgICAgICBtYWludGFpbiBtZW1vcnkgb2YgdGhlIGN1cnJlbnQgbGluZSBudW1iZXJzIGJldHdlZW4gY2FsbHMKICAgICAgICAgICAgICAgICAgICAgb2YgdGhpcyBmdW5jdGlvbi4KCiAgICAgICAgTm90ZSwgdGhpcyBmdW5jdGlvbiBpcyBwdXJwb3NlZnVsbHkgbm90IGRlZmluZWQgYXQgdGhlIG1vZHVsZSBzY29wZSBzbwogICAgICAgIHRoYXQgZGF0YSBpdCBuZWVkcyBmcm9tIGl0cyBwYXJlbnQgZnVuY3Rpb24gKHdpdGhpbiB3aG9zZSBjb250ZXh0IGl0CiAgICAgICAgaXMgZGVmaW5lZCkgZG9lcyBub3QgbmVlZCB0byBiZSBvZiBtb2R1bGUgc2NvcGUuCiAgICAgICAgIiIiCiAgICAgICAgbnVtX2xpbmVzW3NpZGVdICs9IDEKICAgICAgICAjIEhhbmRsZSBjYXNlIHdoZXJlIG5vIHVzZXIgbWFya3VwIGlzIHRvIGJlIGFkZGVkLCBqdXN0IHJldHVybiBsaW5lIG9mCiAgICAgICAgIyB0ZXh0IHdpdGggdXNlcidzIGxpbmUgZm9ybWF0IHRvIGFsbG93IGZvciB1c2FnZSBvZiB0aGUgbGluZSBudW1iZXIuCiAgICAgICAgaWYgZm9ybWF0X2tleSBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gKG51bV9saW5lc1tzaWRlXSxsaW5lcy5wb3AoMClbMjpdKQogICAgICAgICMgSGFuZGxlIGNhc2Ugb2YgaW50cmFsaW5lIGNoYW5nZXMKICAgICAgICBpZiBmb3JtYXRfa2V5ID09ICc/JzoKICAgICAgICAgICAgdGV4dCwgbWFya2VycyA9IGxpbmVzLnBvcCgwKSwgbGluZXMucG9wKDApCiAgICAgICAgICAgICMgZmluZCBpbnRyYWxpbmUgY2hhbmdlcyAoc3RvcmUgY2hhbmdlIHR5cGUgYW5kIGluZGljZXMgaW4gdHVwbGVzKQogICAgICAgICAgICBzdWJfaW5mbyA9IFtdCiAgICAgICAgICAgIGRlZiByZWNvcmRfc3ViX2luZm8obWF0Y2hfb2JqZWN0LHN1Yl9pbmZvPXN1Yl9pbmZvKToKICAgICAgICAgICAgICAgIHN1Yl9pbmZvLmFwcGVuZChbbWF0Y2hfb2JqZWN0Lmdyb3VwKDEpWzBdLG1hdGNoX29iamVjdC5zcGFuKCldKQogICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoX29iamVjdC5ncm91cCgxKQogICAgICAgICAgICBjaGFuZ2VfcmUuc3ViKHJlY29yZF9zdWJfaW5mbyxtYXJrZXJzKQogICAgICAgICAgICAjIHByb2Nlc3MgZWFjaCB0dXBsZSBpbnNlcnRpbmcgb3VyIHNwZWNpYWwgbWFya3MgdGhhdCB3b24ndCBiZQogICAgICAgICAgICAjIG5vdGljZWQgYnkgYW4geG1sL2h0bWwgZXNjYXBlci4KICAgICAgICAgICAgZm9yIGtleSwoYmVnaW4sZW5kKSBpbiBzdWJfaW5mb1s6Oi0xXToKICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0WzA6YmVnaW5dKydcMCcra2V5K3RleHRbYmVnaW46ZW5kXSsnXDEnK3RleHRbZW5kOl0KICAgICAgICAgICAgdGV4dCA9IHRleHRbMjpdCiAgICAgICAgIyBIYW5kbGUgY2FzZSBvZiBhZGQvZGVsZXRlIGVudGlyZSBsaW5lCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdGV4dCA9IGxpbmVzLnBvcCgwKVsyOl0KICAgICAgICAgICAgIyBpZiBsaW5lIG9mIHRleHQgaXMganVzdCBhIG5ld2xpbmUsIGluc2VydCBhIHNwYWNlIHNvIHRoZXJlIGlzCiAgICAgICAgICAgICMgc29tZXRoaW5nIGZvciB0aGUgdXNlciB0byBoaWdobGlnaHQgYW5kIHNlZS4KICAgICAgICAgICAgaWYgbm90IHRleHQ6CiAgICAgICAgICAgICAgICB0ZXh0ID0gJyAnCiAgICAgICAgICAgICMgaW5zZXJ0IG1hcmtzIHRoYXQgd29uJ3QgYmUgbm90aWNlZCBieSBhbiB4bWwvaHRtbCBlc2NhcGVyLgogICAgICAgICAgICB0ZXh0ID0gJ1wwJyArIGZvcm1hdF9rZXkgKyB0ZXh0ICsgJ1wxJwogICAgICAgICMgUmV0dXJuIGxpbmUgb2YgdGV4dCwgZmlyc3QgYWxsb3cgdXNlcidzIGxpbmUgZm9ybWF0dGVyIHRvIGRvIGl0cwogICAgICAgICMgdGhpbmcgKHN1Y2ggYXMgYWRkaW5nIHRoZSBsaW5lIG51bWJlcikgdGhlbiByZXBsYWNlIHRoZSBzcGVjaWFsCiAgICAgICAgIyBtYXJrcyB3aXRoIHdoYXQgdGhlIHVzZXIncyBjaGFuZ2UgbWFya3VwLgogICAgICAgIHJldHVybiAobnVtX2xpbmVzW3NpZGVdLHRleHQpCgogICAgZGVmIF9saW5lX2l0ZXJhdG9yKCk6CiAgICAgICAgIiIiWWllbGRzIGZyb20vdG8gbGluZXMgb2YgdGV4dCB3aXRoIGEgY2hhbmdlIGluZGljYXRpb24uCgogICAgICAgIFRoaXMgZnVuY3Rpb24gaXMgYW4gaXRlcmF0b3IuICBJdCBpdHNlbGYgcHVsbHMgbGluZXMgZnJvbSBhCiAgICAgICAgZGlmZmVyZW5jaW5nIGl0ZXJhdG9yLCBwcm9jZXNzZXMgdGhlbSBhbmQgeWllbGRzIHRoZW0uICBXaGVuIGl0IGNhbgogICAgICAgIGl0IHlpZWxkcyBib3RoIGEgImZyb20iIGFuZCBhICJ0byIgbGluZSwgb3RoZXJ3aXNlIGl0IHdpbGwgeWllbGQgb25lCiAgICAgICAgb3IgdGhlIG90aGVyLiAgSW4gYWRkaXRpb24gdG8geWllbGRpbmcgdGhlIGxpbmVzIG9mIGZyb20vdG8gdGV4dCwgYQogICAgICAgIGJvb2xlYW4gZmxhZyBpcyB5aWVsZGVkIHRvIGluZGljYXRlIGlmIHRoZSB0ZXh0IGxpbmUocykgaGF2ZQogICAgICAgIGRpZmZlcmVuY2VzIGluIHRoZW0uCgogICAgICAgIE5vdGUsIHRoaXMgZnVuY3Rpb24gaXMgcHVycG9zZWZ1bGx5IG5vdCBkZWZpbmVkIGF0IHRoZSBtb2R1bGUgc2NvcGUgc28KICAgICAgICB0aGF0IGRhdGEgaXQgbmVlZHMgZnJvbSBpdHMgcGFyZW50IGZ1bmN0aW9uICh3aXRoaW4gd2hvc2UgY29udGV4dCBpdAogICAgICAgIGlzIGRlZmluZWQpIGRvZXMgbm90IG5lZWQgdG8gYmUgb2YgbW9kdWxlIHNjb3BlLgogICAgICAgICIiIgogICAgICAgIGxpbmVzID0gW10KICAgICAgICBudW1fYmxhbmtzX3BlbmRpbmcsIG51bV9ibGFua3NfdG9feWllbGQgPSAwLCAwCiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgIyBMb2FkIHVwIG5leHQgNCBsaW5lcyBzbyB3ZSBjYW4gbG9vayBhaGVhZCwgY3JlYXRlIHN0cmluZ3Mgd2hpY2gKICAgICAgICAgICAgIyBhcmUgYSBjb25jYXRlbmF0aW9uIG9mIHRoZSBmaXJzdCBjaGFyYWN0ZXIgb2YgZWFjaCBvZiB0aGUgNCBsaW5lcwogICAgICAgICAgICAjIHNvIHdlIGNhbiBkbyBzb21lIHZlcnkgcmVhZGFibGUgY29tcGFyaXNvbnMuCiAgICAgICAgICAgIHdoaWxlIGxlbihsaW5lcykgPCA0OgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGxpbmVzLmFwcGVuZChuZXh0KGRpZmZfbGluZXNfaXRlcmF0b3IpKQogICAgICAgICAgICAgICAgZXhjZXB0IFN0b3BJdGVyYXRpb246CiAgICAgICAgICAgICAgICAgICAgbGluZXMuYXBwZW5kKCdYJykKICAgICAgICAgICAgcyA9ICcnLmpvaW4oW2xpbmVbMF0gZm9yIGxpbmUgaW4gbGluZXNdKQogICAgICAgICAgICBpZiBzLnN0YXJ0c3dpdGgoJ1gnKToKICAgICAgICAgICAgICAgICMgV2hlbiBubyBtb3JlIGxpbmVzLCBwdW1wIG91dCBhbnkgcmVtYWluaW5nIGJsYW5rIGxpbmVzIHNvIHRoZQogICAgICAgICAgICAgICAgIyBjb3JyZXNwb25kaW5nIGFkZC9kZWxldGUgbGluZXMgZ2V0IGEgbWF0Y2hpbmcgYmxhbmsgbGluZSBzbwogICAgICAgICAgICAgICAgIyBhbGwgbGluZSBwYWlycyBnZXQgeWllbGRlZCBhdCB0aGUgbmV4dCBsZXZlbC4KICAgICAgICAgICAgICAgIG51bV9ibGFua3NfdG9feWllbGQgPSBudW1fYmxhbmtzX3BlbmRpbmcKICAgICAgICAgICAgZWxpZiBzLnN0YXJ0c3dpdGgoJy0/Kz8nKToKICAgICAgICAgICAgICAgICMgc2ltcGxlIGludHJhbGluZSBjaGFuZ2UKICAgICAgICAgICAgICAgIHlpZWxkIF9tYWtlX2xpbmUobGluZXMsJz8nLDApLCBfbWFrZV9saW5lKGxpbmVzLCc/JywxKSwgVHJ1ZQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZWxpZiBzLnN0YXJ0c3dpdGgoJy0tKysnKToKICAgICAgICAgICAgICAgICMgaW4gZGVsZXRlIGJsb2NrLCBhZGQgYmxvY2sgY29taW5nOiB3ZSBkbyBOT1Qgd2FudCB0byBnZXQKICAgICAgICAgICAgICAgICMgY2F1Z2h0IHVwIG9uIGJsYW5rIGxpbmVzIHlldCwganVzdCBwcm9jZXNzIHRoZSBkZWxldGUgbGluZQogICAgICAgICAgICAgICAgbnVtX2JsYW5rc19wZW5kaW5nIC09IDEKICAgICAgICAgICAgICAgIHlpZWxkIF9tYWtlX2xpbmUobGluZXMsJy0nLDApLCBOb25lLCBUcnVlCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBlbGlmIHMuc3RhcnRzd2l0aCgoJy0tPysnLCAnLS0rJywgJy0gJykpOgogICAgICAgICAgICAgICAgIyBpbiBkZWxldGUgYmxvY2sgYW5kIHNlZSBhIGludHJhbGluZSBjaGFuZ2Ugb3IgdW5jaGFuZ2VkIGxpbmUKICAgICAgICAgICAgICAgICMgY29taW5nOiB5aWVsZCB0aGUgZGVsZXRlIGxpbmUgYW5kIHRoZW4gYmxhbmtzCiAgICAgICAgICAgICAgICBmcm9tX2xpbmUsdG9fbGluZSA9IF9tYWtlX2xpbmUobGluZXMsJy0nLDApLCBOb25lCiAgICAgICAgICAgICAgICBudW1fYmxhbmtzX3RvX3lpZWxkLG51bV9ibGFua3NfcGVuZGluZyA9IG51bV9ibGFua3NfcGVuZGluZy0xLDAKICAgICAgICAgICAgZWxpZiBzLnN0YXJ0c3dpdGgoJy0rPycpOgogICAgICAgICAgICAgICAgIyBpbnRyYWxpbmUgY2hhbmdlCiAgICAgICAgICAgICAgICB5aWVsZCBfbWFrZV9saW5lKGxpbmVzLE5vbmUsMCksIF9tYWtlX2xpbmUobGluZXMsJz8nLDEpLCBUcnVlCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBlbGlmIHMuc3RhcnRzd2l0aCgnLT8rJyk6CiAgICAgICAgICAgICAgICAjIGludHJhbGluZSBjaGFuZ2UKICAgICAgICAgICAgICAgIHlpZWxkIF9tYWtlX2xpbmUobGluZXMsJz8nLDApLCBfbWFrZV9saW5lKGxpbmVzLE5vbmUsMSksIFRydWUKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGVsaWYgcy5zdGFydHN3aXRoKCctJyk6CiAgICAgICAgICAgICAgICAjIGRlbGV0ZSBGUk9NIGxpbmUKICAgICAgICAgICAgICAgIG51bV9ibGFua3NfcGVuZGluZyAtPSAxCiAgICAgICAgICAgICAgICB5aWVsZCBfbWFrZV9saW5lKGxpbmVzLCctJywwKSwgTm9uZSwgVHJ1ZQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZWxpZiBzLnN0YXJ0c3dpdGgoJystLScpOgogICAgICAgICAgICAgICAgIyBpbiBhZGQgYmxvY2ssIGRlbGV0ZSBibG9jayBjb21pbmc6IHdlIGRvIE5PVCB3YW50IHRvIGdldAogICAgICAgICAgICAgICAgIyBjYXVnaHQgdXAgb24gYmxhbmsgbGluZXMgeWV0LCBqdXN0IHByb2Nlc3MgdGhlIGFkZCBsaW5lCiAgICAgICAgICAgICAgICBudW1fYmxhbmtzX3BlbmRpbmcgKz0gMQogICAgICAgICAgICAgICAgeWllbGQgTm9uZSwgX21ha2VfbGluZShsaW5lcywnKycsMSksIFRydWUKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGVsaWYgcy5zdGFydHN3aXRoKCgnKyAnLCAnKy0nKSk6CiAgICAgICAgICAgICAgICAjIHdpbGwgYmUgbGVhdmluZyBhbiBhZGQgYmxvY2s6IHlpZWxkIGJsYW5rcyB0aGVuIGFkZCBsaW5lCiAgICAgICAgICAgICAgICBmcm9tX2xpbmUsIHRvX2xpbmUgPSBOb25lLCBfbWFrZV9saW5lKGxpbmVzLCcrJywxKQogICAgICAgICAgICAgICAgbnVtX2JsYW5rc190b195aWVsZCxudW1fYmxhbmtzX3BlbmRpbmcgPSBudW1fYmxhbmtzX3BlbmRpbmcrMSwwCiAgICAgICAgICAgIGVsaWYgcy5zdGFydHN3aXRoKCcrJyk6CiAgICAgICAgICAgICAgICAjIGluc2lkZSBhbiBhZGQgYmxvY2ssIHlpZWxkIHRoZSBhZGQgbGluZQogICAgICAgICAgICAgICAgbnVtX2JsYW5rc19wZW5kaW5nICs9IDEKICAgICAgICAgICAgICAgIHlpZWxkIE5vbmUsIF9tYWtlX2xpbmUobGluZXMsJysnLDEpLCBUcnVlCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBlbGlmIHMuc3RhcnRzd2l0aCgnICcpOgogICAgICAgICAgICAgICAgIyB1bmNoYW5nZWQgdGV4dCwgeWllbGQgaXQgdG8gYm90aCBzaWRlcwogICAgICAgICAgICAgICAgeWllbGQgX21ha2VfbGluZShsaW5lc1s6XSxOb25lLDApLF9tYWtlX2xpbmUobGluZXMsTm9uZSwxKSxGYWxzZQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgIyBDYXRjaCB1cCBvbiB0aGUgYmxhbmsgbGluZXMgc28gd2hlbiB3ZSB5aWVsZCB0aGUgbmV4dCBmcm9tL3RvCiAgICAgICAgICAgICMgcGFpciwgdGhleSBhcmUgbGluZWQgdXAuCiAgICAgICAgICAgIHdoaWxlKG51bV9ibGFua3NfdG9feWllbGQgPCAwKToKICAgICAgICAgICAgICAgIG51bV9ibGFua3NfdG9feWllbGQgKz0gMQogICAgICAgICAgICAgICAgeWllbGQgTm9uZSwoJycsJ1xuJyksVHJ1ZQogICAgICAgICAgICB3aGlsZShudW1fYmxhbmtzX3RvX3lpZWxkID4gMCk6CiAgICAgICAgICAgICAgICBudW1fYmxhbmtzX3RvX3lpZWxkIC09IDEKICAgICAgICAgICAgICAgIHlpZWxkICgnJywnXG4nKSxOb25lLFRydWUKICAgICAgICAgICAgaWYgcy5zdGFydHN3aXRoKCdYJyk6CiAgICAgICAgICAgICAgICByYWlzZSBTdG9wSXRlcmF0aW9uCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB5aWVsZCBmcm9tX2xpbmUsdG9fbGluZSxUcnVlCgogICAgZGVmIF9saW5lX3BhaXJfaXRlcmF0b3IoKToKICAgICAgICAiIiJZaWVsZHMgZnJvbS90byBsaW5lcyBvZiB0ZXh0IHdpdGggYSBjaGFuZ2UgaW5kaWNhdGlvbi4KCiAgICAgICAgVGhpcyBmdW5jdGlvbiBpcyBhbiBpdGVyYXRvci4gIEl0IGl0c2VsZiBwdWxscyBsaW5lcyBmcm9tIHRoZSBsaW5lCiAgICAgICAgaXRlcmF0b3IuICBJdHMgZGlmZmVyZW5jZSBmcm9tIHRoYXQgaXRlcmF0b3IgaXMgdGhhdCB0aGlzIGZ1bmN0aW9uCiAgICAgICAgYWx3YXlzIHlpZWxkcyBhIHBhaXIgb2YgZnJvbS90byB0ZXh0IGxpbmVzICh3aXRoIHRoZSBjaGFuZ2UKICAgICAgICBpbmRpY2F0aW9uKS4gIElmIG5lY2Vzc2FyeSBpdCB3aWxsIGNvbGxlY3Qgc2luZ2xlIGZyb20vdG8gbGluZXMKICAgICAgICB1bnRpbCBpdCBoYXMgYSBtYXRjaGluZyBwYWlyIGZyb20vdG8gcGFpciB0byB5aWVsZC4KCiAgICAgICAgTm90ZSwgdGhpcyBmdW5jdGlvbiBpcyBwdXJwb3NlZnVsbHkgbm90IGRlZmluZWQgYXQgdGhlIG1vZHVsZSBzY29wZSBzbwogICAgICAgIHRoYXQgZGF0YSBpdCBuZWVkcyBmcm9tIGl0cyBwYXJlbnQgZnVuY3Rpb24gKHdpdGhpbiB3aG9zZSBjb250ZXh0IGl0CiAgICAgICAgaXMgZGVmaW5lZCkgZG9lcyBub3QgbmVlZCB0byBiZSBvZiBtb2R1bGUgc2NvcGUuCiAgICAgICAgIiIiCiAgICAgICAgbGluZV9pdGVyYXRvciA9IF9saW5lX2l0ZXJhdG9yKCkKICAgICAgICBmcm9tbGluZXMsdG9saW5lcz1bXSxbXQogICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgICMgQ29sbGVjdGluZyBsaW5lcyBvZiB0ZXh0IHVudGlsIHdlIGhhdmUgYSBmcm9tL3RvIHBhaXIKICAgICAgICAgICAgd2hpbGUgKGxlbihmcm9tbGluZXMpPT0wIG9yIGxlbih0b2xpbmVzKT09MCk6CiAgICAgICAgICAgICAgICBmcm9tX2xpbmUsIHRvX2xpbmUsIGZvdW5kX2RpZmYgPSBuZXh0KGxpbmVfaXRlcmF0b3IpCiAgICAgICAgICAgICAgICBpZiBmcm9tX2xpbmUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgZnJvbWxpbmVzLmFwcGVuZCgoZnJvbV9saW5lLGZvdW5kX2RpZmYpKQogICAgICAgICAgICAgICAgaWYgdG9fbGluZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICB0b2xpbmVzLmFwcGVuZCgodG9fbGluZSxmb3VuZF9kaWZmKSkKICAgICAgICAgICAgIyBPbmNlIHdlIGhhdmUgYSBwYWlyLCByZW1vdmUgdGhlbSBmcm9tIHRoZSBjb2xsZWN0aW9uIGFuZCB5aWVsZCBpdAogICAgICAgICAgICBmcm9tX2xpbmUsIGZyb21EaWZmID0gZnJvbWxpbmVzLnBvcCgwKQogICAgICAgICAgICB0b19saW5lLCB0b19kaWZmID0gdG9saW5lcy5wb3AoMCkKICAgICAgICAgICAgeWllbGQgKGZyb21fbGluZSx0b19saW5lLGZyb21EaWZmIG9yIHRvX2RpZmYpCgogICAgIyBIYW5kbGUgY2FzZSB3aGVyZSB1c2VyIGRvZXMgbm90IHdhbnQgY29udGV4dCBkaWZmZXJlbmNpbmcsIGp1c3QgeWllbGQKICAgICMgdGhlbSB1cCB3aXRob3V0IGRvaW5nIGFueXRoaW5nIGVsc2Ugd2l0aCB0aGVtLgogICAgbGluZV9wYWlyX2l0ZXJhdG9yID0gX2xpbmVfcGFpcl9pdGVyYXRvcigpCiAgICBpZiBjb250ZXh0IGlzIE5vbmU6CiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgeWllbGQgbmV4dChsaW5lX3BhaXJfaXRlcmF0b3IpCiAgICAjIEhhbmRsZSBjYXNlIHdoZXJlIHVzZXIgd2FudHMgY29udGV4dCBkaWZmZXJlbmNpbmcuICBXZSBtdXN0IGRvIHNvbWUKICAgICMgc3RvcmFnZSBvZiBsaW5lcyB1bnRpbCB3ZSBrbm93IGZvciBzdXJlIHRoYXQgdGhleSBhcmUgdG8gYmUgeWllbGRlZC4KICAgIGVsc2U6CiAgICAgICAgY29udGV4dCArPSAxCiAgICAgICAgbGluZXNfdG9fd3JpdGUgPSAwCiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgIyBTdG9yZSBsaW5lcyB1cCB1bnRpbCB3ZSBmaW5kIGEgZGlmZmVyZW5jZSwgbm90ZSB1c2Ugb2YgYQogICAgICAgICAgICAjIGNpcmN1bGFyIHF1ZXVlIGJlY2F1c2Ugd2Ugb25seSBuZWVkIHRvIGtlZXAgYXJvdW5kIHdoYXQKICAgICAgICAgICAgIyB3ZSBuZWVkIGZvciBjb250ZXh0LgogICAgICAgICAgICBpbmRleCwgY29udGV4dExpbmVzID0gMCwgW05vbmVdKihjb250ZXh0KQogICAgICAgICAgICBmb3VuZF9kaWZmID0gRmFsc2UKICAgICAgICAgICAgd2hpbGUoZm91bmRfZGlmZiBpcyBGYWxzZSk6CiAgICAgICAgICAgICAgICBmcm9tX2xpbmUsIHRvX2xpbmUsIGZvdW5kX2RpZmYgPSBuZXh0KGxpbmVfcGFpcl9pdGVyYXRvcikKICAgICAgICAgICAgICAgIGkgPSBpbmRleCAlIGNvbnRleHQKICAgICAgICAgICAgICAgIGNvbnRleHRMaW5lc1tpXSA9IChmcm9tX2xpbmUsIHRvX2xpbmUsIGZvdW5kX2RpZmYpCiAgICAgICAgICAgICAgICBpbmRleCArPSAxCiAgICAgICAgICAgICMgWWllbGQgbGluZXMgdGhhdCB3ZSBoYXZlIGNvbGxlY3RlZCBzbyBmYXIsIGJ1dCBmaXJzdCB5aWVsZAogICAgICAgICAgICAjIHRoZSB1c2VyJ3Mgc2VwYXJhdG9yLgogICAgICAgICAgICBpZiBpbmRleCA+IGNvbnRleHQ6CiAgICAgICAgICAgICAgICB5aWVsZCBOb25lLCBOb25lLCBOb25lCiAgICAgICAgICAgICAgICBsaW5lc190b193cml0ZSA9IGNvbnRleHQKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGxpbmVzX3RvX3dyaXRlID0gaW5kZXgKICAgICAgICAgICAgICAgIGluZGV4ID0gMAogICAgICAgICAgICB3aGlsZShsaW5lc190b193cml0ZSk6CiAgICAgICAgICAgICAgICBpID0gaW5kZXggJSBjb250ZXh0CiAgICAgICAgICAgICAgICBpbmRleCArPSAxCiAgICAgICAgICAgICAgICB5aWVsZCBjb250ZXh0TGluZXNbaV0KICAgICAgICAgICAgICAgIGxpbmVzX3RvX3dyaXRlIC09IDEKICAgICAgICAgICAgIyBOb3cgeWllbGQgdGhlIGNvbnRleHQgbGluZXMgYWZ0ZXIgdGhlIGNoYW5nZQogICAgICAgICAgICBsaW5lc190b193cml0ZSA9IGNvbnRleHQtMQogICAgICAgICAgICB3aGlsZShsaW5lc190b193cml0ZSk6CiAgICAgICAgICAgICAgICBmcm9tX2xpbmUsIHRvX2xpbmUsIGZvdW5kX2RpZmYgPSBuZXh0KGxpbmVfcGFpcl9pdGVyYXRvcikKICAgICAgICAgICAgICAgICMgSWYgYW5vdGhlciBjaGFuZ2Ugd2l0aGluIHRoZSBjb250ZXh0LCBleHRlbmQgdGhlIGNvbnRleHQKICAgICAgICAgICAgICAgIGlmIGZvdW5kX2RpZmY6CiAgICAgICAgICAgICAgICAgICAgbGluZXNfdG9fd3JpdGUgPSBjb250ZXh0LTEKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgbGluZXNfdG9fd3JpdGUgLT0gMQogICAgICAgICAgICAgICAgeWllbGQgZnJvbV9saW5lLCB0b19saW5lLCBmb3VuZF9kaWZmCgoKX2ZpbGVfdGVtcGxhdGUgPSAiIiIKPCFET0NUWVBFIGh0bWwgUFVCTElDICItLy9XM0MvL0RURCBYSFRNTCAxLjAgVHJhbnNpdGlvbmFsLy9FTiIKICAgICAgICAgICJodHRwOi8vd3d3LnczLm9yZy9UUi94aHRtbDEvRFREL3hodG1sMS10cmFuc2l0aW9uYWwuZHRkIj4KCjxodG1sPgoKPGhlYWQ+CiAgICA8bWV0YSBodHRwLWVxdWl2PSJDb250ZW50LVR5cGUiCiAgICAgICAgICBjb250ZW50PSJ0ZXh0L2h0bWw7IGNoYXJzZXQ9SVNPLTg4NTktMSIgLz4KICAgIDx0aXRsZT48L3RpdGxlPgogICAgPHN0eWxlIHR5cGU9InRleHQvY3NzIj4lKHN0eWxlcylzCiAgICA8L3N0eWxlPgo8L2hlYWQ+Cgo8Ym9keT4KICAgICUodGFibGUpcyUobGVnZW5kKXMKPC9ib2R5PgoKPC9odG1sPiIiIgoKX3N0eWxlcyA9ICIiIgogICAgICAgIHRhYmxlLmRpZmYge2ZvbnQtZmFtaWx5OkNvdXJpZXI7IGJvcmRlcjptZWRpdW07fQogICAgICAgIC5kaWZmX2hlYWRlciB7YmFja2dyb3VuZC1jb2xvcjojZTBlMGUwfQogICAgICAgIHRkLmRpZmZfaGVhZGVyIHt0ZXh0LWFsaWduOnJpZ2h0fQogICAgICAgIC5kaWZmX25leHQge2JhY2tncm91bmQtY29sb3I6I2MwYzBjMH0KICAgICAgICAuZGlmZl9hZGQge2JhY2tncm91bmQtY29sb3I6I2FhZmZhYX0KICAgICAgICAuZGlmZl9jaGcge2JhY2tncm91bmQtY29sb3I6I2ZmZmY3N30KICAgICAgICAuZGlmZl9zdWIge2JhY2tncm91bmQtY29sb3I6I2ZmYWFhYX0iIiIKCl90YWJsZV90ZW1wbGF0ZSA9ICIiIgogICAgPHRhYmxlIGNsYXNzPSJkaWZmIiBpZD0iZGlmZmxpYl9jaGdfJShwcmVmaXgpc190b3AiCiAgICAgICAgICAgY2VsbHNwYWNpbmc9IjAiIGNlbGxwYWRkaW5nPSIwIiBydWxlcz0iZ3JvdXBzIiA+CiAgICAgICAgPGNvbGdyb3VwPjwvY29sZ3JvdXA+IDxjb2xncm91cD48L2NvbGdyb3VwPiA8Y29sZ3JvdXA+PC9jb2xncm91cD4KICAgICAgICA8Y29sZ3JvdXA+PC9jb2xncm91cD4gPGNvbGdyb3VwPjwvY29sZ3JvdXA+IDxjb2xncm91cD48L2NvbGdyb3VwPgogICAgICAgICUoaGVhZGVyX3JvdylzCiAgICAgICAgPHRib2R5PgolKGRhdGFfcm93cylzICAgICAgICA8L3Rib2R5PgogICAgPC90YWJsZT4iIiIKCl9sZWdlbmQgPSAiIiIKICAgIDx0YWJsZSBjbGFzcz0iZGlmZiIgc3VtbWFyeT0iTGVnZW5kcyI+CiAgICAgICAgPHRyPiA8dGggY29sc3Bhbj0iMiI+IExlZ2VuZHMgPC90aD4gPC90cj4KICAgICAgICA8dHI+IDx0ZD4gPHRhYmxlIGJvcmRlcj0iIiBzdW1tYXJ5PSJDb2xvcnMiPgogICAgICAgICAgICAgICAgICAgICAgPHRyPjx0aD4gQ29sb3JzIDwvdGg+IDwvdHI+CiAgICAgICAgICAgICAgICAgICAgICA8dHI+PHRkIGNsYXNzPSJkaWZmX2FkZCI+Jm5ic3A7QWRkZWQmbmJzcDs8L3RkPjwvdHI+CiAgICAgICAgICAgICAgICAgICAgICA8dHI+PHRkIGNsYXNzPSJkaWZmX2NoZyI+Q2hhbmdlZDwvdGQ+IDwvdHI+CiAgICAgICAgICAgICAgICAgICAgICA8dHI+PHRkIGNsYXNzPSJkaWZmX3N1YiI+RGVsZXRlZDwvdGQ+IDwvdHI+CiAgICAgICAgICAgICAgICAgIDwvdGFibGU+PC90ZD4KICAgICAgICAgICAgIDx0ZD4gPHRhYmxlIGJvcmRlcj0iIiBzdW1tYXJ5PSJMaW5rcyI+CiAgICAgICAgICAgICAgICAgICAgICA8dHI+PHRoIGNvbHNwYW49IjIiPiBMaW5rcyA8L3RoPiA8L3RyPgogICAgICAgICAgICAgICAgICAgICAgPHRyPjx0ZD4oZilpcnN0IGNoYW5nZTwvdGQ+IDwvdHI+CiAgICAgICAgICAgICAgICAgICAgICA8dHI+PHRkPihuKWV4dCBjaGFuZ2U8L3RkPiA8L3RyPgogICAgICAgICAgICAgICAgICAgICAgPHRyPjx0ZD4odClvcDwvdGQ+IDwvdHI+CiAgICAgICAgICAgICAgICAgIDwvdGFibGU+PC90ZD4gPC90cj4KICAgIDwvdGFibGU+IiIiCgpjbGFzcyBIdG1sRGlmZihvYmplY3QpOgogICAgIiIiRm9yIHByb2R1Y2luZyBIVE1MIHNpZGUgYnkgc2lkZSBjb21wYXJpc29uIHdpdGggY2hhbmdlIGhpZ2hsaWdodHMuCgogICAgVGhpcyBjbGFzcyBjYW4gYmUgdXNlZCB0byBjcmVhdGUgYW4gSFRNTCB0YWJsZSAob3IgYSBjb21wbGV0ZSBIVE1MIGZpbGUKICAgIGNvbnRhaW5pbmcgdGhlIHRhYmxlKSBzaG93aW5nIGEgc2lkZSBieSBzaWRlLCBsaW5lIGJ5IGxpbmUgY29tcGFyaXNvbgogICAgb2YgdGV4dCB3aXRoIGludGVyLWxpbmUgYW5kIGludHJhLWxpbmUgY2hhbmdlIGhpZ2hsaWdodHMuICBUaGUgdGFibGUgY2FuCiAgICBiZSBnZW5lcmF0ZWQgaW4gZWl0aGVyIGZ1bGwgb3IgY29udGV4dHVhbCBkaWZmZXJlbmNlIG1vZGUuCgogICAgVGhlIGZvbGxvd2luZyBtZXRob2RzIGFyZSBwcm92aWRlZCBmb3IgSFRNTCBnZW5lcmF0aW9uOgoKICAgIG1ha2VfdGFibGUgLS0gZ2VuZXJhdGVzIEhUTUwgZm9yIGEgc2luZ2xlIHNpZGUgYnkgc2lkZSB0YWJsZQogICAgbWFrZV9maWxlIC0tIGdlbmVyYXRlcyBjb21wbGV0ZSBIVE1MIGZpbGUgd2l0aCBhIHNpbmdsZSBzaWRlIGJ5IHNpZGUgdGFibGUKCiAgICBTZWUgdG9vbHMvc2NyaXB0cy9kaWZmLnB5IGZvciBhbiBleGFtcGxlIHVzYWdlIG9mIHRoaXMgY2xhc3MuCiAgICAiIiIKCiAgICBfZmlsZV90ZW1wbGF0ZSA9IF9maWxlX3RlbXBsYXRlCiAgICBfc3R5bGVzID0gX3N0eWxlcwogICAgX3RhYmxlX3RlbXBsYXRlID0gX3RhYmxlX3RlbXBsYXRlCiAgICBfbGVnZW5kID0gX2xlZ2VuZAogICAgX2RlZmF1bHRfcHJlZml4ID0gMAoKICAgIGRlZiBfX2luaXRfXyhzZWxmLHRhYnNpemU9OCx3cmFwY29sdW1uPU5vbmUsbGluZWp1bms9Tm9uZSwKICAgICAgICAgICAgICAgICBjaGFyanVuaz1JU19DSEFSQUNURVJfSlVOSyk6CiAgICAgICAgIiIiSHRtbERpZmYgaW5zdGFuY2UgaW5pdGlhbGl6ZXIKCiAgICAgICAgQXJndW1lbnRzOgogICAgICAgIHRhYnNpemUgLS0gdGFiIHN0b3Agc3BhY2luZywgZGVmYXVsdHMgdG8gOC4KICAgICAgICB3cmFwY29sdW1uIC0tIGNvbHVtbiBudW1iZXIgd2hlcmUgbGluZXMgYXJlIGJyb2tlbiBhbmQgd3JhcHBlZCwKICAgICAgICAgICAgZGVmYXVsdHMgdG8gTm9uZSB3aGVyZSBsaW5lcyBhcmUgbm90IHdyYXBwZWQuCiAgICAgICAgbGluZWp1bmssY2hhcmp1bmsgLS0ga2V5d29yZCBhcmd1bWVudHMgcGFzc2VkIGludG8gbmRpZmYoKSAodXNlZCB0byBieQogICAgICAgICAgICBIdG1sRGlmZigpIHRvIGdlbmVyYXRlIHRoZSBzaWRlIGJ5IHNpZGUgSFRNTCBkaWZmZXJlbmNlcykuICBTZWUKICAgICAgICAgICAgbmRpZmYoKSBkb2N1bWVudGF0aW9uIGZvciBhcmd1bWVudCBkZWZhdWx0IHZhbHVlcyBhbmQgZGVzY3JpcHRpb25zLgogICAgICAgICIiIgogICAgICAgIHNlbGYuX3RhYnNpemUgPSB0YWJzaXplCiAgICAgICAgc2VsZi5fd3JhcGNvbHVtbiA9IHdyYXBjb2x1bW4KICAgICAgICBzZWxmLl9saW5lanVuayA9IGxpbmVqdW5rCiAgICAgICAgc2VsZi5fY2hhcmp1bmsgPSBjaGFyanVuawoKICAgIGRlZiBtYWtlX2ZpbGUoc2VsZixmcm9tbGluZXMsdG9saW5lcyxmcm9tZGVzYz0nJyx0b2Rlc2M9JycsY29udGV4dD1GYWxzZSwKICAgICAgICAgICAgICAgICAgbnVtbGluZXM9NSk6CiAgICAgICAgIiIiUmV0dXJucyBIVE1MIGZpbGUgb2Ygc2lkZSBieSBzaWRlIGNvbXBhcmlzb24gd2l0aCBjaGFuZ2UgaGlnaGxpZ2h0cwoKICAgICAgICBBcmd1bWVudHM6CiAgICAgICAgZnJvbWxpbmVzIC0tIGxpc3Qgb2YgImZyb20iIGxpbmVzCiAgICAgICAgdG9saW5lcyAtLSBsaXN0IG9mICJ0byIgbGluZXMKICAgICAgICBmcm9tZGVzYyAtLSAiZnJvbSIgZmlsZSBjb2x1bW4gaGVhZGVyIHN0cmluZwogICAgICAgIHRvZGVzYyAtLSAidG8iIGZpbGUgY29sdW1uIGhlYWRlciBzdHJpbmcKICAgICAgICBjb250ZXh0IC0tIHNldCB0byBUcnVlIGZvciBjb250ZXh0dWFsIGRpZmZlcmVuY2VzIChkZWZhdWx0cyB0byBGYWxzZQogICAgICAgICAgICB3aGljaCBzaG93cyBmdWxsIGRpZmZlcmVuY2VzKS4KICAgICAgICBudW1saW5lcyAtLSBudW1iZXIgb2YgY29udGV4dCBsaW5lcy4gIFdoZW4gY29udGV4dCBpcyBzZXQgVHJ1ZSwKICAgICAgICAgICAgY29udHJvbHMgbnVtYmVyIG9mIGxpbmVzIGRpc3BsYXllZCBiZWZvcmUgYW5kIGFmdGVyIHRoZSBjaGFuZ2UuCiAgICAgICAgICAgIFdoZW4gY29udGV4dCBpcyBGYWxzZSwgY29udHJvbHMgdGhlIG51bWJlciBvZiBsaW5lcyB0byBwbGFjZQogICAgICAgICAgICB0aGUgIm5leHQiIGxpbmsgYW5jaG9ycyBiZWZvcmUgdGhlIG5leHQgY2hhbmdlIChzbyBjbGljayBvZgogICAgICAgICAgICAibmV4dCIgbGluayBqdW1wcyB0byBqdXN0IGJlZm9yZSB0aGUgY2hhbmdlKS4KICAgICAgICAiIiIKCiAgICAgICAgcmV0dXJuIHNlbGYuX2ZpbGVfdGVtcGxhdGUgJSBkaWN0KAogICAgICAgICAgICBzdHlsZXMgPSBzZWxmLl9zdHlsZXMsCiAgICAgICAgICAgIGxlZ2VuZCA9IHNlbGYuX2xlZ2VuZCwKICAgICAgICAgICAgdGFibGUgPSBzZWxmLm1ha2VfdGFibGUoZnJvbWxpbmVzLHRvbGluZXMsZnJvbWRlc2MsdG9kZXNjLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0PWNvbnRleHQsbnVtbGluZXM9bnVtbGluZXMpKQoKICAgIGRlZiBfdGFiX25ld2xpbmVfcmVwbGFjZShzZWxmLGZyb21saW5lcyx0b2xpbmVzKToKICAgICAgICAiIiJSZXR1cm5zIGZyb20vdG8gbGluZSBsaXN0cyB3aXRoIHRhYnMgZXhwYW5kZWQgYW5kIG5ld2xpbmVzIHJlbW92ZWQuCgogICAgICAgIEluc3RlYWQgb2YgdGFiIGNoYXJhY3RlcnMgYmVpbmcgcmVwbGFjZWQgYnkgdGhlIG51bWJlciBvZiBzcGFjZXMKICAgICAgICBuZWVkZWQgdG8gZmlsbCBpbiB0byB0aGUgbmV4dCB0YWIgc3RvcCwgdGhpcyBmdW5jdGlvbiB3aWxsIGZpbGwKICAgICAgICB0aGUgc3BhY2Ugd2l0aCB0YWIgY2hhcmFjdGVycy4gIFRoaXMgaXMgZG9uZSBzbyB0aGF0IHRoZSBkaWZmZXJlbmNlCiAgICAgICAgYWxnb3JpdGhtcyBjYW4gaWRlbnRpZnkgY2hhbmdlcyBpbiBhIGZpbGUgd2hlbiB0YWJzIGFyZSByZXBsYWNlZCBieQogICAgICAgIHNwYWNlcyBhbmQgdmljZSB2ZXJzYS4gIEF0IHRoZSBlbmQgb2YgdGhlIEhUTUwgZ2VuZXJhdGlvbiwgdGhlIHRhYgogICAgICAgIGNoYXJhY3RlcnMgd2lsbCBiZSByZXBsYWNlZCB3aXRoIGEgbm9uYnJlYWthYmxlIHNwYWNlLgogICAgICAgICIiIgogICAgICAgIGRlZiBleHBhbmRfdGFicyhsaW5lKToKICAgICAgICAgICAgIyBoaWRlIHJlYWwgc3BhY2VzCiAgICAgICAgICAgIGxpbmUgPSBsaW5lLnJlcGxhY2UoJyAnLCdcMCcpCiAgICAgICAgICAgICMgZXhwYW5kIHRhYnMgaW50byBzcGFjZXMKICAgICAgICAgICAgbGluZSA9IGxpbmUuZXhwYW5kdGFicyhzZWxmLl90YWJzaXplKQogICAgICAgICAgICAjIHJlcGxhY2Ugc3BhY2VzIGZyb20gZXhwYW5kZWQgdGFicyBiYWNrIGludG8gdGFiIGNoYXJhY3RlcnMKICAgICAgICAgICAgIyAod2UnbGwgcmVwbGFjZSB0aGVtIHdpdGggbWFya3VwIGFmdGVyIHdlIGRvIGRpZmZlcmVuY2luZykKICAgICAgICAgICAgbGluZSA9IGxpbmUucmVwbGFjZSgnICcsJ1x0JykKICAgICAgICAgICAgcmV0dXJuIGxpbmUucmVwbGFjZSgnXDAnLCcgJykucnN0cmlwKCdcbicpCiAgICAgICAgZnJvbWxpbmVzID0gW2V4cGFuZF90YWJzKGxpbmUpIGZvciBsaW5lIGluIGZyb21saW5lc10KICAgICAgICB0b2xpbmVzID0gW2V4cGFuZF90YWJzKGxpbmUpIGZvciBsaW5lIGluIHRvbGluZXNdCiAgICAgICAgcmV0dXJuIGZyb21saW5lcyx0b2xpbmVzCgogICAgZGVmIF9zcGxpdF9saW5lKHNlbGYsZGF0YV9saXN0LGxpbmVfbnVtLHRleHQpOgogICAgICAgICIiIkJ1aWxkcyBsaXN0IG9mIHRleHQgbGluZXMgYnkgc3BsaXR0aW5nIHRleHQgbGluZXMgYXQgd3JhcCBwb2ludAoKICAgICAgICBUaGlzIGZ1bmN0aW9uIHdpbGwgZGV0ZXJtaW5lIGlmIHRoZSBpbnB1dCB0ZXh0IGxpbmUgbmVlZHMgdG8gYmUKICAgICAgICB3cmFwcGVkIChzcGxpdCkgaW50byBzZXBhcmF0ZSBsaW5lcy4gIElmIHNvLCB0aGUgZmlyc3Qgd3JhcCBwb2ludAogICAgICAgIHdpbGwgYmUgZGV0ZXJtaW5lZCBhbmQgdGhlIGZpcnN0IGxpbmUgYXBwZW5kZWQgdG8gdGhlIG91dHB1dAogICAgICAgIHRleHQgbGluZSBsaXN0LiAgVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHJlY3Vyc2l2ZWx5IHRvIGhhbmRsZQogICAgICAgIHRoZSBzZWNvbmQgcGFydCBvZiB0aGUgc3BsaXQgbGluZSB0byBmdXJ0aGVyIHNwbGl0IGl0LgogICAgICAgICIiIgogICAgICAgICMgaWYgYmxhbmsgbGluZSBvciBjb250ZXh0IHNlcGFyYXRvciwganVzdCBhZGQgaXQgdG8gdGhlIG91dHB1dCBsaXN0CiAgICAgICAgaWYgbm90IGxpbmVfbnVtOgogICAgICAgICAgICBkYXRhX2xpc3QuYXBwZW5kKChsaW5lX251bSx0ZXh0KSkKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICMgaWYgbGluZSB0ZXh0IGRvZXNuJ3QgbmVlZCB3cmFwcGluZywganVzdCBhZGQgaXQgdG8gdGhlIG91dHB1dCBsaXN0CiAgICAgICAgc2l6ZSA9IGxlbih0ZXh0KQogICAgICAgIG1heCA9IHNlbGYuX3dyYXBjb2x1bW4KICAgICAgICBpZiAoc2l6ZSA8PSBtYXgpIG9yICgoc2l6ZSAtKHRleHQuY291bnQoJ1wwJykqMykpIDw9IG1heCk6CiAgICAgICAgICAgIGRhdGFfbGlzdC5hcHBlbmQoKGxpbmVfbnVtLHRleHQpKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgIyBzY2FuIHRleHQgbG9va2luZyBmb3IgdGhlIHdyYXAgcG9pbnQsIGtlZXBpbmcgdHJhY2sgaWYgdGhlIHdyYXAKICAgICAgICAjIHBvaW50IGlzIGluc2lkZSBtYXJrZXJzCiAgICAgICAgaSA9IDAKICAgICAgICBuID0gMAogICAgICAgIG1hcmsgPSAnJwogICAgICAgIHdoaWxlIG4gPCBtYXggYW5kIGkgPCBzaXplOgogICAgICAgICAgICBpZiB0ZXh0W2ldID09ICdcMCc6CiAgICAgICAgICAgICAgICBpICs9IDEKICAgICAgICAgICAgICAgIG1hcmsgPSB0ZXh0W2ldCiAgICAgICAgICAgICAgICBpICs9IDEKICAgICAgICAgICAgZWxpZiB0ZXh0W2ldID09ICdcMSc6CiAgICAgICAgICAgICAgICBpICs9IDEKICAgICAgICAgICAgICAgIG1hcmsgPSAnJwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaSArPSAxCiAgICAgICAgICAgICAgICBuICs9IDEKCiAgICAgICAgIyB3cmFwIHBvaW50IGlzIGluc2lkZSB0ZXh0LCBicmVhayBpdCB1cCBpbnRvIHNlcGFyYXRlIGxpbmVzCiAgICAgICAgbGluZTEgPSB0ZXh0WzppXQogICAgICAgIGxpbmUyID0gdGV4dFtpOl0KCiAgICAgICAgIyBpZiB3cmFwIHBvaW50IGlzIGluc2lkZSBtYXJrZXJzLCBwbGFjZSBlbmQgbWFya2VyIGF0IGVuZCBvZiBmaXJzdAogICAgICAgICMgbGluZSBhbmQgc3RhcnQgbWFya2VyIGF0IGJlZ2lubmluZyBvZiBzZWNvbmQgbGluZSBiZWNhdXNlIGVhY2gKICAgICAgICAjIGxpbmUgd2lsbCBoYXZlIGl0cyBvd24gdGFibGUgdGFnIG1hcmt1cCBhcm91bmQgaXQuCiAgICAgICAgaWYgbWFyazoKICAgICAgICAgICAgbGluZTEgPSBsaW5lMSArICdcMScKICAgICAgICAgICAgbGluZTIgPSAnXDAnICsgbWFyayArIGxpbmUyCgogICAgICAgICMgdGFjayBvbiBmaXJzdCBsaW5lIG9udG8gdGhlIG91dHB1dCBsaXN0CiAgICAgICAgZGF0YV9saXN0LmFwcGVuZCgobGluZV9udW0sbGluZTEpKQoKICAgICAgICAjIHVzZSB0aGlzIHJvdXRpbmUgYWdhaW4gdG8gd3JhcCB0aGUgcmVtYWluaW5nIHRleHQKICAgICAgICBzZWxmLl9zcGxpdF9saW5lKGRhdGFfbGlzdCwnPicsbGluZTIpCgogICAgZGVmIF9saW5lX3dyYXBwZXIoc2VsZixkaWZmcyk6CiAgICAgICAgIiIiUmV0dXJucyBpdGVyYXRvciB0aGF0IHNwbGl0cyAod3JhcHMpIG1kaWZmIHRleHQgbGluZXMiIiIKCiAgICAgICAgIyBwdWxsIGZyb20vdG8gZGF0YSBhbmQgZmxhZ3MgZnJvbSBtZGlmZiBpdGVyYXRvcgogICAgICAgIGZvciBmcm9tZGF0YSx0b2RhdGEsZmxhZyBpbiBkaWZmczoKICAgICAgICAgICAgIyBjaGVjayBmb3IgY29udGV4dCBzZXBhcmF0b3JzIGFuZCBwYXNzIHRoZW0gdGhyb3VnaAogICAgICAgICAgICBpZiBmbGFnIGlzIE5vbmU6CiAgICAgICAgICAgICAgICB5aWVsZCBmcm9tZGF0YSx0b2RhdGEsZmxhZwogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgKGZyb21saW5lLGZyb210ZXh0KSwodG9saW5lLHRvdGV4dCkgPSBmcm9tZGF0YSx0b2RhdGEKICAgICAgICAgICAgIyBmb3IgZWFjaCBmcm9tL3RvIGxpbmUgc3BsaXQgaXQgYXQgdGhlIHdyYXAgY29sdW1uIHRvIGZvcm0KICAgICAgICAgICAgIyBsaXN0IG9mIHRleHQgbGluZXMuCiAgICAgICAgICAgIGZyb21saXN0LHRvbGlzdCA9IFtdLFtdCiAgICAgICAgICAgIHNlbGYuX3NwbGl0X2xpbmUoZnJvbWxpc3QsZnJvbWxpbmUsZnJvbXRleHQpCiAgICAgICAgICAgIHNlbGYuX3NwbGl0X2xpbmUodG9saXN0LHRvbGluZSx0b3RleHQpCiAgICAgICAgICAgICMgeWllbGQgZnJvbS90byBsaW5lIGluIHBhaXJzIGluc2VydGluZyBibGFuayBsaW5lcyBhcwogICAgICAgICAgICAjIG5lY2Vzc2FyeSB3aGVuIG9uZSBzaWRlIGhhcyBtb3JlIHdyYXBwZWQgbGluZXMKICAgICAgICAgICAgd2hpbGUgZnJvbWxpc3Qgb3IgdG9saXN0OgogICAgICAgICAgICAgICAgaWYgZnJvbWxpc3Q6CiAgICAgICAgICAgICAgICAgICAgZnJvbWRhdGEgPSBmcm9tbGlzdC5wb3AoMCkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgZnJvbWRhdGEgPSAoJycsJyAnKQogICAgICAgICAgICAgICAgaWYgdG9saXN0OgogICAgICAgICAgICAgICAgICAgIHRvZGF0YSA9IHRvbGlzdC5wb3AoMCkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgdG9kYXRhID0gKCcnLCcgJykKICAgICAgICAgICAgICAgIHlpZWxkIGZyb21kYXRhLHRvZGF0YSxmbGFnCgogICAgZGVmIF9jb2xsZWN0X2xpbmVzKHNlbGYsZGlmZnMpOgogICAgICAgICIiIkNvbGxlY3RzIG1kaWZmIG91dHB1dCBpbnRvIHNlcGFyYXRlIGxpc3RzCgogICAgICAgIEJlZm9yZSBzdG9yaW5nIHRoZSBtZGlmZiBmcm9tL3RvIGRhdGEgaW50byBhIGxpc3QsIGl0IGlzIGNvbnZlcnRlZAogICAgICAgIGludG8gYSBzaW5nbGUgbGluZSBvZiB0ZXh0IHdpdGggSFRNTCBtYXJrdXAuCiAgICAgICAgIiIiCgogICAgICAgIGZyb21saXN0LHRvbGlzdCxmbGFnbGlzdCA9IFtdLFtdLFtdCiAgICAgICAgIyBwdWxsIGZyb20vdG8gZGF0YSBhbmQgZmxhZ3MgZnJvbSBtZGlmZiBzdHlsZSBpdGVyYXRvcgogICAgICAgIGZvciBmcm9tZGF0YSx0b2RhdGEsZmxhZyBpbiBkaWZmczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgIyBzdG9yZSBIVE1MIG1hcmt1cCBvZiB0aGUgbGluZXMgaW50byB0aGUgbGlzdHMKICAgICAgICAgICAgICAgIGZyb21saXN0LmFwcGVuZChzZWxmLl9mb3JtYXRfbGluZSgwLGZsYWcsKmZyb21kYXRhKSkKICAgICAgICAgICAgICAgIHRvbGlzdC5hcHBlbmQoc2VsZi5fZm9ybWF0X2xpbmUoMSxmbGFnLCp0b2RhdGEpKQogICAgICAgICAgICBleGNlcHQgVHlwZUVycm9yOgogICAgICAgICAgICAgICAgIyBleGNlcHRpb25zIG9jY3VyIGZvciBsaW5lcyB3aGVyZSBjb250ZXh0IHNlcGFyYXRvcnMgZ28KICAgICAgICAgICAgICAgIGZyb21saXN0LmFwcGVuZChOb25lKQogICAgICAgICAgICAgICAgdG9saXN0LmFwcGVuZChOb25lKQogICAgICAgICAgICBmbGFnbGlzdC5hcHBlbmQoZmxhZykKICAgICAgICByZXR1cm4gZnJvbWxpc3QsdG9saXN0LGZsYWdsaXN0CgogICAgZGVmIF9mb3JtYXRfbGluZShzZWxmLHNpZGUsZmxhZyxsaW5lbnVtLHRleHQpOgogICAgICAgICIiIlJldHVybnMgSFRNTCBtYXJrdXAgb2YgImZyb20iIC8gInRvIiB0ZXh0IGxpbmVzCgogICAgICAgIHNpZGUgLS0gMCBvciAxIGluZGljYXRpbmcgImZyb20iIG9yICJ0byIgdGV4dAogICAgICAgIGZsYWcgLS0gaW5kaWNhdGVzIGlmIGRpZmZlcmVuY2Ugb24gbGluZQogICAgICAgIGxpbmVudW0gLS0gbGluZSBudW1iZXIgKHVzZWQgZm9yIGxpbmUgbnVtYmVyIGNvbHVtbikKICAgICAgICB0ZXh0IC0tIGxpbmUgdGV4dCB0byBiZSBtYXJrZWQgdXAKICAgICAgICAiIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxpbmVudW0gPSAnJWQnICUgbGluZW51bQogICAgICAgICAgICBpZCA9ICcgaWQ9IiVzJXMiJyAlIChzZWxmLl9wcmVmaXhbc2lkZV0sbGluZW51bSkKICAgICAgICBleGNlcHQgVHlwZUVycm9yOgogICAgICAgICAgICAjIGhhbmRsZSBibGFuayBsaW5lcyB3aGVyZSBsaW5lbnVtIGlzICc+JyBvciAnJwogICAgICAgICAgICBpZCA9ICcnCiAgICAgICAgIyByZXBsYWNlIHRob3NlIHRoaW5ncyB0aGF0IHdvdWxkIGdldCBjb25mdXNlZCB3aXRoIEhUTUwgc3ltYm9scwogICAgICAgIHRleHQ9dGV4dC5yZXBsYWNlKCImIiwiJmFtcDsiKS5yZXBsYWNlKCI+IiwiJmd0OyIpLnJlcGxhY2UoIjwiLCImbHQ7IikKCiAgICAgICAgIyBtYWtlIHNwYWNlIG5vbi1icmVha2FibGUgc28gdGhleSBkb24ndCBnZXQgY29tcHJlc3NlZCBvciBsaW5lIHdyYXBwZWQKICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKCcgJywnJm5ic3A7JykucnN0cmlwKCkKCiAgICAgICAgcmV0dXJuICc8dGQgY2xhc3M9ImRpZmZfaGVhZGVyIiVzPiVzPC90ZD48dGQgbm93cmFwPSJub3dyYXAiPiVzPC90ZD4nIFwKICAgICAgICAgICAgICAgJSAoaWQsbGluZW51bSx0ZXh0KQoKICAgIGRlZiBfbWFrZV9wcmVmaXgoc2VsZik6CiAgICAgICAgIiIiQ3JlYXRlIHVuaXF1ZSBhbmNob3IgcHJlZml4ZXMiIiIKCiAgICAgICAgIyBHZW5lcmF0ZSBhIHVuaXF1ZSBhbmNob3IgcHJlZml4IHNvIG11bHRpcGxlIHRhYmxlcwogICAgICAgICMgY2FuIGV4aXN0IG9uIHRoZSBzYW1lIEhUTUwgcGFnZSB3aXRob3V0IGNvbmZsaWN0cy4KICAgICAgICBmcm9tcHJlZml4ID0gImZyb20lZF8iICUgSHRtbERpZmYuX2RlZmF1bHRfcHJlZml4CiAgICAgICAgdG9wcmVmaXggPSAidG8lZF8iICUgSHRtbERpZmYuX2RlZmF1bHRfcHJlZml4CiAgICAgICAgSHRtbERpZmYuX2RlZmF1bHRfcHJlZml4ICs9IDEKICAgICAgICAjIHN0b3JlIHByZWZpeGVzIHNvIGxpbmUgZm9ybWF0IG1ldGhvZCBoYXMgYWNjZXNzCiAgICAgICAgc2VsZi5fcHJlZml4ID0gW2Zyb21wcmVmaXgsdG9wcmVmaXhdCgogICAgZGVmIF9jb252ZXJ0X2ZsYWdzKHNlbGYsZnJvbWxpc3QsdG9saXN0LGZsYWdsaXN0LGNvbnRleHQsbnVtbGluZXMpOgogICAgICAgICIiIk1ha2VzIGxpc3Qgb2YgIm5leHQiIGxpbmtzIiIiCgogICAgICAgICMgYWxsIGFuY2hvciBuYW1lcyB3aWxsIGJlIGdlbmVyYXRlZCB1c2luZyB0aGUgdW5pcXVlICJ0byIgcHJlZml4CiAgICAgICAgdG9wcmVmaXggPSBzZWxmLl9wcmVmaXhbMV0KCiAgICAgICAgIyBwcm9jZXNzIGNoYW5nZSBmbGFncywgZ2VuZXJhdGluZyBtaWRkbGUgY29sdW1uIG9mIG5leHQgYW5jaG9ycy9saW5rcwogICAgICAgIG5leHRfaWQgPSBbJyddKmxlbihmbGFnbGlzdCkKICAgICAgICBuZXh0X2hyZWYgPSBbJyddKmxlbihmbGFnbGlzdCkKICAgICAgICBudW1fY2hnLCBpbl9jaGFuZ2UgPSAwLCBGYWxzZQogICAgICAgIGxhc3QgPSAwCiAgICAgICAgZm9yIGksZmxhZyBpbiBlbnVtZXJhdGUoZmxhZ2xpc3QpOgogICAgICAgICAgICBpZiBmbGFnOgogICAgICAgICAgICAgICAgaWYgbm90IGluX2NoYW5nZToKICAgICAgICAgICAgICAgICAgICBpbl9jaGFuZ2UgPSBUcnVlCiAgICAgICAgICAgICAgICAgICAgbGFzdCA9IGkKICAgICAgICAgICAgICAgICAgICAjIGF0IHRoZSBiZWdpbm5pbmcgb2YgYSBjaGFuZ2UsIGRyb3AgYW4gYW5jaG9yIGEgZmV3IGxpbmVzCiAgICAgICAgICAgICAgICAgICAgIyAodGhlIGNvbnRleHQgbGluZXMpIGJlZm9yZSB0aGUgY2hhbmdlIGZvciB0aGUgcHJldmlvdXMKICAgICAgICAgICAgICAgICAgICAjIGxpbmsKICAgICAgICAgICAgICAgICAgICBpID0gbWF4KFswLGktbnVtbGluZXNdKQogICAgICAgICAgICAgICAgICAgIG5leHRfaWRbaV0gPSAnIGlkPSJkaWZmbGliX2NoZ18lc18lZCInICUgKHRvcHJlZml4LG51bV9jaGcpCiAgICAgICAgICAgICAgICAgICAgIyBhdCB0aGUgYmVnaW5uaW5nIG9mIGEgY2hhbmdlLCBkcm9wIGEgbGluayB0byB0aGUgbmV4dAogICAgICAgICAgICAgICAgICAgICMgY2hhbmdlCiAgICAgICAgICAgICAgICAgICAgbnVtX2NoZyArPSAxCiAgICAgICAgICAgICAgICAgICAgbmV4dF9ocmVmW2xhc3RdID0gJzxhIGhyZWY9IiNkaWZmbGliX2NoZ18lc18lZCI+bjwvYT4nICUgKAogICAgICAgICAgICAgICAgICAgICAgICAgdG9wcmVmaXgsbnVtX2NoZykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGluX2NoYW5nZSA9IEZhbHNlCiAgICAgICAgIyBjaGVjayBmb3IgY2FzZXMgd2hlcmUgdGhlcmUgaXMgbm8gY29udGVudCB0byBhdm9pZCBleGNlcHRpb25zCiAgICAgICAgaWYgbm90IGZsYWdsaXN0OgogICAgICAgICAgICBmbGFnbGlzdCA9IFtGYWxzZV0KICAgICAgICAgICAgbmV4dF9pZCA9IFsnJ10KICAgICAgICAgICAgbmV4dF9ocmVmID0gWycnXQogICAgICAgICAgICBsYXN0ID0gMAogICAgICAgICAgICBpZiBjb250ZXh0OgogICAgICAgICAgICAgICAgZnJvbWxpc3QgPSBbJzx0ZD48L3RkPjx0ZD4mbmJzcDtObyBEaWZmZXJlbmNlcyBGb3VuZCZuYnNwOzwvdGQ+J10KICAgICAgICAgICAgICAgIHRvbGlzdCA9IGZyb21saXN0CiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBmcm9tbGlzdCA9IHRvbGlzdCA9IFsnPHRkPjwvdGQ+PHRkPiZuYnNwO0VtcHR5IEZpbGUmbmJzcDs8L3RkPiddCiAgICAgICAgIyBpZiBub3QgYSBjaGFuZ2Ugb24gZmlyc3QgbGluZSwgZHJvcCBhIGxpbmsKICAgICAgICBpZiBub3QgZmxhZ2xpc3RbMF06CiAgICAgICAgICAgIG5leHRfaHJlZlswXSA9ICc8YSBocmVmPSIjZGlmZmxpYl9jaGdfJXNfMCI+ZjwvYT4nICUgdG9wcmVmaXgKICAgICAgICAjIHJlZG8gdGhlIGxhc3QgbGluayB0byBsaW5rIHRvIHRoZSB0b3AKICAgICAgICBuZXh0X2hyZWZbbGFzdF0gPSAnPGEgaHJlZj0iI2RpZmZsaWJfY2hnXyVzX3RvcCI+dDwvYT4nICUgKHRvcHJlZml4KQoKICAgICAgICByZXR1cm4gZnJvbWxpc3QsdG9saXN0LGZsYWdsaXN0LG5leHRfaHJlZixuZXh0X2lkCgogICAgZGVmIG1ha2VfdGFibGUoc2VsZixmcm9tbGluZXMsdG9saW5lcyxmcm9tZGVzYz0nJyx0b2Rlc2M9JycsY29udGV4dD1GYWxzZSwKICAgICAgICAgICAgICAgICAgIG51bWxpbmVzPTUpOgogICAgICAgICIiIlJldHVybnMgSFRNTCB0YWJsZSBvZiBzaWRlIGJ5IHNpZGUgY29tcGFyaXNvbiB3aXRoIGNoYW5nZSBoaWdobGlnaHRzCgogICAgICAgIEFyZ3VtZW50czoKICAgICAgICBmcm9tbGluZXMgLS0gbGlzdCBvZiAiZnJvbSIgbGluZXMKICAgICAgICB0b2xpbmVzIC0tIGxpc3Qgb2YgInRvIiBsaW5lcwogICAgICAgIGZyb21kZXNjIC0tICJmcm9tIiBmaWxlIGNvbHVtbiBoZWFkZXIgc3RyaW5nCiAgICAgICAgdG9kZXNjIC0tICJ0byIgZmlsZSBjb2x1bW4gaGVhZGVyIHN0cmluZwogICAgICAgIGNvbnRleHQgLS0gc2V0IHRvIFRydWUgZm9yIGNvbnRleHR1YWwgZGlmZmVyZW5jZXMgKGRlZmF1bHRzIHRvIEZhbHNlCiAgICAgICAgICAgIHdoaWNoIHNob3dzIGZ1bGwgZGlmZmVyZW5jZXMpLgogICAgICAgIG51bWxpbmVzIC0tIG51bWJlciBvZiBjb250ZXh0IGxpbmVzLiAgV2hlbiBjb250ZXh0IGlzIHNldCBUcnVlLAogICAgICAgICAgICBjb250cm9scyBudW1iZXIgb2YgbGluZXMgZGlzcGxheWVkIGJlZm9yZSBhbmQgYWZ0ZXIgdGhlIGNoYW5nZS4KICAgICAgICAgICAgV2hlbiBjb250ZXh0IGlzIEZhbHNlLCBjb250cm9scyB0aGUgbnVtYmVyIG9mIGxpbmVzIHRvIHBsYWNlCiAgICAgICAgICAgIHRoZSAibmV4dCIgbGluayBhbmNob3JzIGJlZm9yZSB0aGUgbmV4dCBjaGFuZ2UgKHNvIGNsaWNrIG9mCiAgICAgICAgICAgICJuZXh0IiBsaW5rIGp1bXBzIHRvIGp1c3QgYmVmb3JlIHRoZSBjaGFuZ2UpLgogICAgICAgICIiIgoKICAgICAgICAjIG1ha2UgdW5pcXVlIGFuY2hvciBwcmVmaXhlcyBzbyB0aGF0IG11bHRpcGxlIHRhYmxlcyBtYXkgZXhpc3QKICAgICAgICAjIG9uIHRoZSBzYW1lIHBhZ2Ugd2l0aG91dCBjb25mbGljdC4KICAgICAgICBzZWxmLl9tYWtlX3ByZWZpeCgpCgogICAgICAgICMgY2hhbmdlIHRhYnMgdG8gc3BhY2VzIGJlZm9yZSBpdCBnZXRzIG1vcmUgZGlmZmljdWx0IGFmdGVyIHdlIGluc2VydAogICAgICAgICMgbWFya2t1cAogICAgICAgIGZyb21saW5lcyx0b2xpbmVzID0gc2VsZi5fdGFiX25ld2xpbmVfcmVwbGFjZShmcm9tbGluZXMsdG9saW5lcykKCiAgICAgICAgIyBjcmVhdGUgZGlmZnMgaXRlcmF0b3Igd2hpY2ggZ2VuZXJhdGVzIHNpZGUgYnkgc2lkZSBmcm9tL3RvIGRhdGEKICAgICAgICBpZiBjb250ZXh0OgogICAgICAgICAgICBjb250ZXh0X2xpbmVzID0gbnVtbGluZXMKICAgICAgICBlbHNlOgogICAgICAgICAgICBjb250ZXh0X2xpbmVzID0gTm9uZQogICAgICAgIGRpZmZzID0gX21kaWZmKGZyb21saW5lcyx0b2xpbmVzLGNvbnRleHRfbGluZXMsbGluZWp1bms9c2VsZi5fbGluZWp1bmssCiAgICAgICAgICAgICAgICAgICAgICBjaGFyanVuaz1zZWxmLl9jaGFyanVuaykKCiAgICAgICAgIyBzZXQgdXAgaXRlcmF0b3IgdG8gd3JhcCBsaW5lcyB0aGF0IGV4Y2VlZCBkZXNpcmVkIHdpZHRoCiAgICAgICAgaWYgc2VsZi5fd3JhcGNvbHVtbjoKICAgICAgICAgICAgZGlmZnMgPSBzZWxmLl9saW5lX3dyYXBwZXIoZGlmZnMpCgogICAgICAgICMgY29sbGVjdCB1cCBmcm9tL3RvIGxpbmVzIGFuZCBmbGFncyBpbnRvIGxpc3RzIChhbHNvIGZvcm1hdCB0aGUgbGluZXMpCiAgICAgICAgZnJvbWxpc3QsdG9saXN0LGZsYWdsaXN0ID0gc2VsZi5fY29sbGVjdF9saW5lcyhkaWZmcykKCiAgICAgICAgIyBwcm9jZXNzIGNoYW5nZSBmbGFncywgZ2VuZXJhdGluZyBtaWRkbGUgY29sdW1uIG9mIG5leHQgYW5jaG9ycy9saW5rcwogICAgICAgIGZyb21saXN0LHRvbGlzdCxmbGFnbGlzdCxuZXh0X2hyZWYsbmV4dF9pZCA9IHNlbGYuX2NvbnZlcnRfZmxhZ3MoCiAgICAgICAgICAgIGZyb21saXN0LHRvbGlzdCxmbGFnbGlzdCxjb250ZXh0LG51bWxpbmVzKQoKICAgICAgICBzID0gW10KICAgICAgICBmbXQgPSAnICAgICAgICAgICAgPHRyPjx0ZCBjbGFzcz0iZGlmZl9uZXh0IiVzPiVzPC90ZD4lcycgKyBcCiAgICAgICAgICAgICAgJzx0ZCBjbGFzcz0iZGlmZl9uZXh0Ij4lczwvdGQ+JXM8L3RyPlxuJwogICAgICAgIGZvciBpIGluIHJhbmdlKGxlbihmbGFnbGlzdCkpOgogICAgICAgICAgICBpZiBmbGFnbGlzdFtpXSBpcyBOb25lOgogICAgICAgICAgICAgICAgIyBtZGlmZiB5aWVsZHMgTm9uZSBvbiBzZXBhcmF0b3IgbGluZXMgc2tpcCB0aGUgYm9ndXMgb25lcwogICAgICAgICAgICAgICAgIyBnZW5lcmF0ZWQgZm9yIHRoZSBmaXJzdCBsaW5lCiAgICAgICAgICAgICAgICBpZiBpID4gMDoKICAgICAgICAgICAgICAgICAgICBzLmFwcGVuZCgnICAgICAgICA8L3Rib2R5PiAgICAgICAgXG4gICAgICAgIDx0Ym9keT5cbicpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzLmFwcGVuZCggZm10ICUgKG5leHRfaWRbaV0sbmV4dF9ocmVmW2ldLGZyb21saXN0W2ldLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dF9ocmVmW2ldLHRvbGlzdFtpXSkpCiAgICAgICAgaWYgZnJvbWRlc2Mgb3IgdG9kZXNjOgogICAgICAgICAgICBoZWFkZXJfcm93ID0gJzx0aGVhZD48dHI+JXMlcyVzJXM8L3RyPjwvdGhlYWQ+JyAlICgKICAgICAgICAgICAgICAgICc8dGggY2xhc3M9ImRpZmZfbmV4dCI+PGJyIC8+PC90aD4nLAogICAgICAgICAgICAgICAgJzx0aCBjb2xzcGFuPSIyIiBjbGFzcz0iZGlmZl9oZWFkZXIiPiVzPC90aD4nICUgZnJvbWRlc2MsCiAgICAgICAgICAgICAgICAnPHRoIGNsYXNzPSJkaWZmX25leHQiPjxiciAvPjwvdGg+JywKICAgICAgICAgICAgICAgICc8dGggY29sc3Bhbj0iMiIgY2xhc3M9ImRpZmZfaGVhZGVyIj4lczwvdGg+JyAlIHRvZGVzYykKICAgICAgICBlbHNlOgogICAgICAgICAgICBoZWFkZXJfcm93ID0gJycKCiAgICAgICAgdGFibGUgPSBzZWxmLl90YWJsZV90ZW1wbGF0ZSAlIGRpY3QoCiAgICAgICAgICAgIGRhdGFfcm93cz0nJy5qb2luKHMpLAogICAgICAgICAgICBoZWFkZXJfcm93PWhlYWRlcl9yb3csCiAgICAgICAgICAgIHByZWZpeD1zZWxmLl9wcmVmaXhbMV0pCgogICAgICAgIHJldHVybiB0YWJsZS5yZXBsYWNlKCdcMCsnLCc8c3BhbiBjbGFzcz0iZGlmZl9hZGQiPicpLiBcCiAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2UoJ1wwLScsJzxzcGFuIGNsYXNzPSJkaWZmX3N1YiI+JykuIFwKICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZSgnXDBeJywnPHNwYW4gY2xhc3M9ImRpZmZfY2hnIj4nKS4gXAogICAgICAgICAgICAgICAgICAgICByZXBsYWNlKCdcMScsJzwvc3Bhbj4nKS4gXAogICAgICAgICAgICAgICAgICAgICByZXBsYWNlKCdcdCcsJyZuYnNwOycpCgpkZWwgcmUKCmRlZiByZXN0b3JlKGRlbHRhLCB3aGljaCk6CiAgICByIiIiCiAgICBHZW5lcmF0ZSBvbmUgb2YgdGhlIHR3byBzZXF1ZW5jZXMgdGhhdCBnZW5lcmF0ZWQgYSBkZWx0YS4KCiAgICBHaXZlbiBhIGBkZWx0YWAgcHJvZHVjZWQgYnkgYERpZmZlci5jb21wYXJlKClgIG9yIGBuZGlmZigpYCwgZXh0cmFjdAogICAgbGluZXMgb3JpZ2luYXRpbmcgZnJvbSBmaWxlIDEgb3IgMiAocGFyYW1ldGVyIGB3aGljaGApLCBzdHJpcHBpbmcgb2ZmIGxpbmUKICAgIHByZWZpeGVzLgoKICAgIEV4YW1wbGVzOgoKICAgID4+PiBkaWZmID0gbmRpZmYoJ29uZVxudHdvXG50aHJlZVxuJy5zcGxpdGxpbmVzKGtlZXBlbmRzPVRydWUpLAogICAgLi4uICAgICAgICAgICAgICAnb3JlXG50cmVlXG5lbXVcbicuc3BsaXRsaW5lcyhrZWVwZW5kcz1UcnVlKSkKICAgID4+PiBkaWZmID0gbGlzdChkaWZmKQogICAgPj4+IHByaW50KCcnLmpvaW4ocmVzdG9yZShkaWZmLCAxKSksIGVuZD0iIikKICAgIG9uZQogICAgdHdvCiAgICB0aHJlZQogICAgPj4+IHByaW50KCcnLmpvaW4ocmVzdG9yZShkaWZmLCAyKSksIGVuZD0iIikKICAgIG9yZQogICAgdHJlZQogICAgZW11CiAgICAiIiIKICAgIHRyeToKICAgICAgICB0YWcgPSB7MTogIi0gIiwgMjogIisgIn1baW50KHdoaWNoKV0KICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCd1bmtub3duIGRlbHRhIGNob2ljZSAobXVzdCBiZSAxIG9yIDIpOiAlcicKICAgICAgICAgICAgICAgICAgICAgICAgICAgJSB3aGljaCkKICAgIHByZWZpeGVzID0gKCIgICIsIHRhZykKICAgIGZvciBsaW5lIGluIGRlbHRhOgogICAgICAgIGlmIGxpbmVbOjJdIGluIHByZWZpeGVzOgogICAgICAgICAgICB5aWVsZCBsaW5lWzI6XQoKZGVmIF90ZXN0KCk6CiAgICBpbXBvcnQgZG9jdGVzdCwgZGlmZmxpYgogICAgcmV0dXJuIGRvY3Rlc3QudGVzdG1vZChkaWZmbGliKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIF90ZXN0KCkK',
'/Lib/dis.py':'ZGVmIGRpcyhzcmMpOgogICAgcmV0dXJuIEpTT2JqZWN0KF9fQlJZVEhPTl9fLnB5MmpzKHNyYykpLnRvX2pzKCkK',
'/Lib/errno.py':'IlRoaXMgbW9kdWxlIG1ha2VzIGF2YWlsYWJsZSBzdGFuZGFyZCBlcnJubyBzeXN0ZW0gc3ltYm9scy5cblxuVGhlIHZhbHVlIG9mIGVhY2ggc3ltYm9sIGlzIHRoZSBjb3JyZXNwb25kaW5nIGludGVnZXIgdmFsdWUsXG5lLmcuLCBvbiBtb3N0IHN5c3RlbXMsIGVycm5vLkVOT0VOVCBlcXVhbHMgdGhlIGludGVnZXIgMi5cblxuVGhlIGRpY3Rpb25hcnkgZXJybm8uZXJyb3Jjb2RlIG1hcHMgbnVtZXJpYyBjb2RlcyB0byBzeW1ib2wgbmFtZXMsXG5lLmcuLCBlcnJuby5lcnJvcmNvZGVbMl0gY291bGQgYmUgdGhlIHN0cmluZyAnRU5PRU5UJy5cblxuU3ltYm9scyB0aGF0IGFyZSBub3QgcmVsZXZhbnQgdG8gdGhlIHVuZGVybHlpbmcgc3lzdGVtIGFyZSBub3QgZGVmaW5lZC5cblxuVG8gbWFwIGVycm9yIGNvZGVzIHRvIGVycm9yIG1lc3NhZ2VzLCB1c2UgdGhlIGZ1bmN0aW9uIG9zLnN0cmVycm9yKCksXG5lLmcuIG9zLnN0cmVycm9yKDIpIGNvdWxkIHJldHVybiAnTm8gc3VjaCBmaWxlIG9yIGRpcmVjdG9yeScuIgoKRTJCSUcgPSA3CkVBQ0NFUyA9IDEzCkVBRERSSU5VU0UgPSA5OApFQUREUk5PVEFWQUlMID0gOTkKRUFEViA9IDY4CkVBRk5PU1VQUE9SVCA9IDk3CkVBR0FJTiA9IDExCkVBTFJFQURZID0gMTE0CkVCQURFID0gNTIKRUJBREYgPSA5CkVCQURGRCA9IDc3CkVCQURNU0cgPSA3NApFQkFEUiA9IDUzCkVCQURSUUMgPSA1NgpFQkFEU0xUID0gNTcKRUJGT05UID0gNTkKRUJVU1kgPSAxNgpFQ0hJTEQgPSAxMApFQ0hSTkcgPSA0NApFQ09NTSA9IDcwCkVDT05OQUJPUlRFRCA9IDEwMwpFQ09OTlJFRlVTRUQgPSAxMTEKRUNPTk5SRVNFVCA9IDEwNApFREVBRExLID0gMzUKRURFQURMT0NLID0gMzUKRURFU1RBRERSUkVRID0gODkKRURPTSA9IDMzCkVET1RET1QgPSA3MwpFRFFVT1QgPSAxMjIKRUVYSVNUID0gMTcKRUZBVUxUID0gMTQKRUZCSUcgPSAyNwpFSE9TVERPV04gPSAxMTIKRUhPU1RVTlJFQUNIID0gMTEzCkVJRFJNID0gNDMKRUlMU0VRID0gODQKRUlOUFJPR1JFU1MgPSAxMTUKRUlOVFIgPSA0CkVJTlZBTCA9IDIyCkVJTyA9IDUKRUlTQ09OTiA9IDEwNgpFSVNESVIgPSAyMQpFSVNOQU0gPSAxMjAKRUwySExUID0gNTEKRUwyTlNZTkMgPSA0NQpFTDNITFQgPSA0NgpFTDNSU1QgPSA0NwpFTElCQUNDID0gNzkKRUxJQkJBRCA9IDgwCkVMSUJFWEVDID0gODMKRUxJQk1BWCA9IDgyCkVMSUJTQ04gPSA4MQpFTE5STkcgPSA0OApFTE9PUCA9IDQwCkVNRklMRSA9IDI0CkVNTElOSyA9IDMxCkVNU0dTSVpFID0gOTAKRU1VTFRJSE9QID0gNzIKRU5BTUVUT09MT05HID0gMzYKRU5BVkFJTCA9IDExOQpFTkVURE9XTiA9IDEwMApFTkVUUkVTRVQgPSAxMDIKRU5FVFVOUkVBQ0ggPSAxMDEKRU5GSUxFID0gMjMKRU5PQU5PID0gNTUKRU5PQlVGUyA9IDEwNQpFTk9DU0kgPSA1MApFTk9EQVRBID0gNjEKRU5PREVWID0gMTkKRU5PRU5UID0gMgpFTk9FWEVDID0gOApFTk9MQ0sgPSAzNwpFTk9MSU5LID0gNjcKRU5PTUVNID0gMTIKRU5PTVNHID0gNDIKRU5PTkVUID0gNjQKRU5PUEtHID0gNjUKRU5PUFJPVE9PUFQgPSA5MgpFTk9TUEMgPSAyOApFTk9TUiA9IDYzCkVOT1NUUiA9IDYwCkVOT1NZUyA9IDM4CkVOT1RCTEsgPSAxNQpFTk9UQ09OTiA9IDEwNwpFTk9URElSID0gMjAKRU5PVEVNUFRZID0gMzkKRU5PVE5BTSA9IDExOApFTk9UU09DSyA9IDg4CkVOT1RUWSA9IDI1CkVOT1RVTklRID0gNzYKRU5YSU8gPSA2CkVPUE5PVFNVUFAgPSA5NQpFT1ZFUkZMT1cgPSA3NQpFUEVSTSA9IDEKRVBGTk9TVVBQT1JUID0gOTYKRVBJUEUgPSAzMgpFUFJPVE8gPSA3MQpFUFJPVE9OT1NVUFBPUlQgPSA5MwpFUFJPVE9UWVBFID0gOTEKRVJBTkdFID0gMzQKRVJFTUNIRyA9IDc4CkVSRU1PVEUgPSA2NgpFUkVNT1RFSU8gPSAxMjEKRVJFU1RBUlQgPSA4NQpFUk9GUyA9IDMwCkVTSFVURE9XTiA9IDEwOApFU09DS1ROT1NVUFBPUlQgPSA5NApFU1BJUEUgPSAyOQpFU1JDSCA9IDMKRVNSTU5UID0gNjkKRVNUQUxFID0gMTE2CkVTVFJQSVBFID0gODYKRVRJTUUgPSA2MgpFVElNRURPVVQgPSAxMTAKRVRPT01BTllSRUZTID0gMTA5CkVUWFRCU1kgPSAyNgpFVUNMRUFOID0gMTE3CkVVTkFUQ0ggPSA0OQpFVVNFUlMgPSA4NwpFV09VTERCTE9DSyA9IDExCkVYREVWID0gMTgKRVhGVUxMID0gNTQKIyBlcnJvcmNvZGUK',
'/Lib/external_import.py':'aW1wb3J0IG9zCmZyb20gYnJvd3NlciBpbXBvcnQgZG9jCmltcG9ydCB1cmxsaWIucmVxdWVzdAoKIyMgdGhpcyBtb2R1bGUgaXMgYWJsZSB0byBkb3dubG9hZCBtb2R1bGVzIHRoYXQgYXJlIGV4dGVybmFsIHRvCiMjIGxvY2FsaG9zdC9zcmMKIyMgc28gd2UgY291bGQgZG93bmxvYWQgZnJvbSBhbnkgVVJMCgpjbGFzcyBNb2R1bGVGaW5kZXI6CiAgICBkZWYgX19pbml0X18oc2VsZiwgcGF0aF9lbnRyeSk6CiAgICAgICAgcHJpbnQoImV4dGVybmFsX2ltcG9ydCBoZXJlLi4iKQogICAgICAgICNwcmludChwYXRoX2VudHJ5KQogICAgICAgIHNlbGYuX21vZHVsZT1Ob25lCiAgICAgICAgaWYgcGF0aF9lbnRyeS5zdGFydHN3aXRoKCdodHRwOi8vJyk6CiAgICAgICAgICAgc2VsZi5wYXRoX2VudHJ5PXBhdGhfZW50cnkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBJbXBvcnRFcnJvcigpCiAgICAgICAgCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gJzwlcyBmb3IgIiVzIj4nICUgKHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLCBzZWxmLnBhdGhfZW50cnkpCiAgICAgICAgCiAgICBkZWYgZmluZF9tb2R1bGUoc2VsZiwgZnVsbG5hbWUsIHBhdGg9Tm9uZSk6CiAgICAgICAgcGF0aCA9IHBhdGggb3Igc2VsZi5wYXRoX2VudHJ5CiAgICAgICAgI3ByaW50KCdsb29raW5nIGZvciAiJXMiIGluICVzIC4uLicgJSAoZnVsbG5hbWUsIHBhdGgpKQogICAgICAgIGZvciBfZXh0IGluIFsnanMnLCAncHlqJywgJ3B5J106CiAgICAgICAgICAgIF9mcCxfdXJsLF9oZWFkZXJzPXVybGxpYi5yZXF1ZXN0LnVybG9wZW4ocGF0aCArICcvJyArICclcy4lcycgJSAoZnVsbG5hbWUsIF9leHQpKQogICAgICAgICAgICBzZWxmLl9tb2R1bGU9X2ZwLnJlYWQoKQogICAgICAgICAgICBfZnAuY2xvc2UoKQogICAgICAgICAgICBpZiBzZWxmLl9tb2R1bGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgIHByaW50KCJtb2R1bGUgZm91bmQgYXQgJXM6JXMiICUgKHBhdGgsIGZ1bGxuYW1lKSkKICAgICAgICAgICAgICAgcmV0dXJuIE1vZHVsZUxvYWRlcihwYXRoLCBmdWxsbmFtZSwgc2VsZi5fbW9kdWxlKQoKICAgICAgICBwcmludCgnbW9kdWxlICVzIG5vdCBmb3VuZCcgJSBmdWxsbmFtZSkKICAgICAgICByYWlzZSBJbXBvcnRFcnJvcigpCiAgICAgICAgcmV0dXJuIE5vbmUKCmNsYXNzIE1vZHVsZUxvYWRlcjoKICAgICIiIkxvYWQgc291cmNlIGZvciBtb2R1bGVzIiIiCiAgICAKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBmaWxlcGF0aCwgbmFtZSwgbW9kdWxlX3NvdXJjZSk6CiAgICAgICAgc2VsZi5fZmlsZXBhdGg9ZmlsZXBhdGgKICAgICAgICBzZWxmLl9uYW1lPW5hbWUKICAgICAgICBzZWxmLl9tb2R1bGVfc291cmNlPW1vZHVsZV9zb3VyY2UKICAgICAgICAKICAgIGRlZiBnZXRfc291cmNlKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9tb2R1bGVfc291cmNlCgogICAgZGVmIGlzX3BhY2thZ2Uoc2VsZik6CiAgICAgICAgcmV0dXJuICcuJyBpbiBzZWxmLl9uYW1lCiAgICAgICAgICAgIAogICAgZGVmIGxvYWRfbW9kdWxlKHNlbGYpOgogICAgICAgIGlmIHNlbGYuX25hbWUgaW4gc3lzLm1vZHVsZXM6CiAgICAgICAgICAgI3ByaW50KCdyZXVzaW5nIGV4aXN0aW5nIG1vZHVsZSBmcm9tIHByZXZpb3VzIGltcG9ydCBvZiAiJXMiJyAlIGZ1bGxuYW1lKQogICAgICAgICAgIG1vZCA9IHN5cy5tb2R1bGVzW3NlbGYuX25hbWVdCiAgICAgICAgICAgcmV0dXJuIG1vZAogICAgICAgIAogICAgICAgIF9zcmM9c2VsZi5nZXRfc291cmNlKCkKICAgICAgICBpZiBzZWxmLl9maWxlcGF0aC5lbmRzd2l0aCgnLmpzJyk6CiAgICAgICAgICAgbW9kPUpTT2JqZWN0KGltcG9ydF9qc19tb2R1bGUoX3NyYywgc2VsZi5fZmlsZXBhdGgsIHNlbGYuX25hbWUpKQogICAgICAgIGVsaWYgc2VsZi5fZmlsZXBhdGguZW5kc3dpdGgoJy5weScpOgogICAgICAgICAgIG1vZD1KU09iamVjdChpbXBvcnRfcHlfbW9kdWxlKF9zcmMsIHNlbGYuX2ZpbGVwYXRoLCBzZWxmLl9uYW1lKSkKICAgICAgICBlbGlmIHNlbGYuX2ZpbGVwYXRoLmVuZHN3aXRoKCcucHlqJyk6CiAgICAgICAgICAgbW9kPUpTT2JqZWN0KGltcG9ydF9weWpfbW9kdWxlKF9zcmMsIHNlbGYuX2ZpbGVwYXRoLCBzZWxmLl9uYW1lKSkKICAgICAgICBlbHNlOgogICAgICAgICAgIHJhaXNlIEltcG9ydEVycm9yKCdJbnZhbGlkIE1vZHVsZTogJXMnICUgc2VsZi5fZmlsZXBhdGgpCgogICAgICAgICMgU2V0IGEgZmV3IHByb3BlcnRpZXMgcmVxdWlyZWQgYnkgUEVQIDMwMgogICAgICAgIG1vZC5fX2ZpbGVfXyA9IHNlbGYuX2ZpbGVwYXRoCiAgICAgICAgbW9kLl9fbmFtZV9fID0gc2VsZi5fbmFtZQogICAgICAgIG1vZC5fX3BhdGhfXyA9IG9zLnBhdGguYWJzcGF0aChzZWxmLl9maWxlcGF0aCkKICAgICAgICBtb2QuX19sb2FkZXJfXyA9IHNlbGYKICAgICAgICBtb2QuX19wYWNrYWdlX18gPSAnLicuam9pbihzZWxmLl9uYW1lLnNwbGl0KCcuJylbOi0xXSkKICAgICAgICAKICAgICAgICBpZiBzZWxmLmlzX3BhY2thZ2UoKToKICAgICAgICAgICBwcmludCgnYWRkaW5nIHBhdGggZm9yIHBhY2thZ2UnKQogICAgICAgICAgICMgU2V0IF9fcGF0aF9fIGZvciBwYWNrYWdlcwogICAgICAgICAgICMgc28gd2UgY2FuIGZpbmQgdGhlIHN1Yi1tb2R1bGVzLgogICAgICAgICAgIG1vZC5fX3BhdGhfXyA9IFsgc2VsZi5fZmlsZXBhdGggXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KCdpbXBvcnRlZCBhcyByZWd1bGFyIG1vZHVsZScpCiAgICAgICAgCiAgICAgICAgcHJpbnQoJ2NyZWF0aW5nIGEgbmV3IG1vZHVsZSBvYmplY3QgZm9yICIlcyInICUgc2VsZi5fbmFtZSkKICAgICAgICBzeXMubW9kdWxlcy5zZXRkZWZhdWx0KHNlbGYuX25hbWUsIG1vZCkKICAgICAgICBKU09iamVjdChfX0JSWVRIT05fXy5pbXBvcnRlZClbc2VsZi5fbmFtZV09bW9kCgogICAgICAgIHJldHVybiBtb2QK',
'/Lib/fnmatch.py':'IiIiRmlsZW5hbWUgbWF0Y2hpbmcgd2l0aCBzaGVsbCBwYXR0ZXJucy4KCmZubWF0Y2goRklMRU5BTUUsIFBBVFRFUk4pIG1hdGNoZXMgYWNjb3JkaW5nIHRvIHRoZSBsb2NhbCBjb252ZW50aW9uLgpmbm1hdGNoY2FzZShGSUxFTkFNRSwgUEFUVEVSTikgYWx3YXlzIHRha2VzIGNhc2UgaW4gYWNjb3VudC4KClRoZSBmdW5jdGlvbnMgb3BlcmF0ZSBieSB0cmFuc2xhdGluZyB0aGUgcGF0dGVybiBpbnRvIGEgcmVndWxhcgpleHByZXNzaW9uLiAgVGhleSBjYWNoZSB0aGUgY29tcGlsZWQgcmVndWxhciBleHByZXNzaW9ucyBmb3Igc3BlZWQuCgpUaGUgZnVuY3Rpb24gdHJhbnNsYXRlKFBBVFRFUk4pIHJldHVybnMgYSByZWd1bGFyIGV4cHJlc3Npb24KY29ycmVzcG9uZGluZyB0byBQQVRURVJOLiAgKEl0IGRvZXMgbm90IGNvbXBpbGUgaXQuKQoiIiIKaW1wb3J0IG9zCmltcG9ydCBwb3NpeHBhdGgKaW1wb3J0IHJlCmltcG9ydCBmdW5jdG9vbHMKCl9fYWxsX18gPSBbImZpbHRlciIsICJmbm1hdGNoIiwgImZubWF0Y2hjYXNlIiwgInRyYW5zbGF0ZSJdCgpkZWYgZm5tYXRjaChuYW1lLCBwYXQpOgogICAgIiIiVGVzdCB3aGV0aGVyIEZJTEVOQU1FIG1hdGNoZXMgUEFUVEVSTi4KCiAgICBQYXR0ZXJucyBhcmUgVW5peCBzaGVsbCBzdHlsZToKCiAgICAqICAgICAgIG1hdGNoZXMgZXZlcnl0aGluZwogICAgPyAgICAgICBtYXRjaGVzIGFueSBzaW5nbGUgY2hhcmFjdGVyCiAgICBbc2VxXSAgIG1hdGNoZXMgYW55IGNoYXJhY3RlciBpbiBzZXEKICAgIFshc2VxXSAgbWF0Y2hlcyBhbnkgY2hhciBub3QgaW4gc2VxCgogICAgQW4gaW5pdGlhbCBwZXJpb2QgaW4gRklMRU5BTUUgaXMgbm90IHNwZWNpYWwuCiAgICBCb3RoIEZJTEVOQU1FIGFuZCBQQVRURVJOIGFyZSBmaXJzdCBjYXNlLW5vcm1hbGl6ZWQKICAgIGlmIHRoZSBvcGVyYXRpbmcgc3lzdGVtIHJlcXVpcmVzIGl0LgogICAgSWYgeW91IGRvbid0IHdhbnQgdGhpcywgdXNlIGZubWF0Y2hjYXNlKEZJTEVOQU1FLCBQQVRURVJOKS4KICAgICIiIgogICAgbmFtZSA9IG9zLnBhdGgubm9ybWNhc2UobmFtZSkKICAgIHBhdCA9IG9zLnBhdGgubm9ybWNhc2UocGF0KQogICAgcmV0dXJuIGZubWF0Y2hjYXNlKG5hbWUsIHBhdCkKCkBmdW5jdG9vbHMubHJ1X2NhY2hlKG1heHNpemU9MjUwLCB0eXBlZD1UcnVlKQpkZWYgX2NvbXBpbGVfcGF0dGVybihwYXQpOgogICAgaWYgaXNpbnN0YW5jZShwYXQsIGJ5dGVzKToKICAgICAgICBwYXRfc3RyID0gc3RyKHBhdCwgJ0lTTy04ODU5LTEnKQogICAgICAgIHJlc19zdHIgPSB0cmFuc2xhdGUocGF0X3N0cikKICAgICAgICByZXMgPSBieXRlcyhyZXNfc3RyLCAnSVNPLTg4NTktMScpCiAgICBlbHNlOgogICAgICAgIHJlcyA9IHRyYW5zbGF0ZShwYXQpCiAgICByZXR1cm4gcmUuY29tcGlsZShyZXMpLm1hdGNoCgpkZWYgZmlsdGVyKG5hbWVzLCBwYXQpOgogICAgIiIiUmV0dXJuIHRoZSBzdWJzZXQgb2YgdGhlIGxpc3QgTkFNRVMgdGhhdCBtYXRjaCBQQVQuIiIiCiAgICByZXN1bHQgPSBbXQogICAgcGF0ID0gb3MucGF0aC5ub3JtY2FzZShwYXQpCiAgICBtYXRjaCA9IF9jb21waWxlX3BhdHRlcm4ocGF0KQogICAgaWYgb3MucGF0aCBpcyBwb3NpeHBhdGg6CiAgICAgICAgIyBub3JtY2FzZSBvbiBwb3NpeCBpcyBOT1AuIE9wdGltaXplIGl0IGF3YXkgZnJvbSB0aGUgbG9vcC4KICAgICAgICBmb3IgbmFtZSBpbiBuYW1lczoKICAgICAgICAgICAgaWYgbWF0Y2gobmFtZSk6CiAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKG5hbWUpCiAgICBlbHNlOgogICAgICAgIGZvciBuYW1lIGluIG5hbWVzOgogICAgICAgICAgICBpZiBtYXRjaChvcy5wYXRoLm5vcm1jYXNlKG5hbWUpKToKICAgICAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQobmFtZSkKICAgIHJldHVybiByZXN1bHQKCmRlZiBmbm1hdGNoY2FzZShuYW1lLCBwYXQpOgogICAgIiIiVGVzdCB3aGV0aGVyIEZJTEVOQU1FIG1hdGNoZXMgUEFUVEVSTiwgaW5jbHVkaW5nIGNhc2UuCgogICAgVGhpcyBpcyBhIHZlcnNpb24gb2YgZm5tYXRjaCgpIHdoaWNoIGRvZXNuJ3QgY2FzZS1ub3JtYWxpemUKICAgIGl0cyBhcmd1bWVudHMuCiAgICAiIiIKICAgIG1hdGNoID0gX2NvbXBpbGVfcGF0dGVybihwYXQpCiAgICByZXR1cm4gbWF0Y2gobmFtZSkgaXMgbm90IE5vbmUKCgpkZWYgdHJhbnNsYXRlKHBhdCk6CiAgICAiIiJUcmFuc2xhdGUgYSBzaGVsbCBQQVRURVJOIHRvIGEgcmVndWxhciBleHByZXNzaW9uLgoKICAgIFRoZXJlIGlzIG5vIHdheSB0byBxdW90ZSBtZXRhLWNoYXJhY3RlcnMuCiAgICAiIiIKCiAgICBpLCBuID0gMCwgbGVuKHBhdCkKICAgIHJlcyA9ICcnCiAgICB3aGlsZSBpIDwgbjoKICAgICAgICBjID0gcGF0W2ldCiAgICAgICAgaSA9IGkrMQogICAgICAgIGlmIGMgPT0gJyonOgogICAgICAgICAgICByZXMgPSByZXMgKyAnLionCiAgICAgICAgZWxpZiBjID09ICc/JzoKICAgICAgICAgICAgcmVzID0gcmVzICsgJy4nCiAgICAgICAgZWxpZiBjID09ICdbJzoKICAgICAgICAgICAgaiA9IGkKICAgICAgICAgICAgaWYgaiA8IG4gYW5kIHBhdFtqXSA9PSAnISc6CiAgICAgICAgICAgICAgICBqID0gaisxCiAgICAgICAgICAgIGlmIGogPCBuIGFuZCBwYXRbal0gPT0gJ10nOgogICAgICAgICAgICAgICAgaiA9IGorMQogICAgICAgICAgICB3aGlsZSBqIDwgbiBhbmQgcGF0W2pdICE9ICddJzoKICAgICAgICAgICAgICAgIGogPSBqKzEKICAgICAgICAgICAgaWYgaiA+PSBuOgogICAgICAgICAgICAgICAgcmVzID0gcmVzICsgJ1xcWycKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHN0dWZmID0gcGF0W2k6al0ucmVwbGFjZSgnXFwnLCdcXFxcJykKICAgICAgICAgICAgICAgIGkgPSBqKzEKICAgICAgICAgICAgICAgIGlmIHN0dWZmWzBdID09ICchJzoKICAgICAgICAgICAgICAgICAgICBzdHVmZiA9ICdeJyArIHN0dWZmWzE6XQogICAgICAgICAgICAgICAgZWxpZiBzdHVmZlswXSA9PSAnXic6CiAgICAgICAgICAgICAgICAgICAgc3R1ZmYgPSAnXFwnICsgc3R1ZmYKICAgICAgICAgICAgICAgIHJlcyA9ICclc1slc10nICUgKHJlcywgc3R1ZmYpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmVzID0gcmVzICsgcmUuZXNjYXBlKGMpCiAgICByZXR1cm4gcmVzICsgJ1xaKD9tcyknCg==',
'/Lib/functools.py':'IiIiZnVuY3Rvb2xzLnB5IC0gVG9vbHMgZm9yIHdvcmtpbmcgd2l0aCBmdW5jdGlvbnMgYW5kIGNhbGxhYmxlIG9iamVjdHMKIiIiCiMgUHl0aG9uIG1vZHVsZSB3cmFwcGVyIGZvciBfZnVuY3Rvb2xzIEMgbW9kdWxlCiMgdG8gYWxsb3cgdXRpbGl0aWVzIHdyaXR0ZW4gaW4gUHl0aG9uIHRvIGJlIGFkZGVkCiMgdG8gdGhlIGZ1bmN0b29scyBtb2R1bGUuCiMgV3JpdHRlbiBieSBOaWNrIENvZ2hsYW4gPG5jb2dobGFuIGF0IGdtYWlsLmNvbT4KIyBhbmQgUmF5bW9uZCBIZXR0aW5nZXIgPHB5dGhvbiBhdCByY24uY29tPgojICAgQ29weXJpZ2h0IChDKSAyMDA2LTIwMTAgUHl0aG9uIFNvZnR3YXJlIEZvdW5kYXRpb24uCiMgU2VlIEMgc291cmNlIGNvZGUgZm9yIF9mdW5jdG9vbHMgY3JlZGl0cy9jb3B5cmlnaHQKCl9fYWxsX18gPSBbJ3VwZGF0ZV93cmFwcGVyJywgJ3dyYXBzJywgJ1dSQVBQRVJfQVNTSUdOTUVOVFMnLCAnV1JBUFBFUl9VUERBVEVTJywKICAgICAgICAgICAndG90YWxfb3JkZXJpbmcnLCAnY21wX3RvX2tleScsICdscnVfY2FjaGUnLCAncmVkdWNlJywgJ3BhcnRpYWwnXQoKZnJvbSBfZnVuY3Rvb2xzIGltcG9ydCBwYXJ0aWFsLCByZWR1Y2UKZnJvbSBjb2xsZWN0aW9ucyBpbXBvcnQgbmFtZWR0dXBsZQp0cnk6CiAgICBmcm9tIF90aHJlYWQgaW1wb3J0IGFsbG9jYXRlX2xvY2sgYXMgTG9jawpleGNlcHQ6CiAgICBmcm9tIF9kdW1teV90aHJlYWQgaW1wb3J0IGFsbG9jYXRlX2xvY2sgYXMgTG9jawoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIyB1cGRhdGVfd3JhcHBlcigpIGFuZCB3cmFwcygpIGRlY29yYXRvcgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKIyB1cGRhdGVfd3JhcHBlcigpIGFuZCB3cmFwcygpIGFyZSB0b29scyB0byBoZWxwIHdyaXRlCiMgd3JhcHBlciBmdW5jdGlvbnMgdGhhdCBjYW4gaGFuZGxlIG5haXZlIGludHJvc3BlY3Rpb24KCldSQVBQRVJfQVNTSUdOTUVOVFMgPSAoJ19fbW9kdWxlX18nLCAnX19uYW1lX18nLCAnX19xdWFsbmFtZV9fJywgJ19fZG9jX18nLAogICAgICAgICAgICAgICAgICAgICAgICdfX2Fubm90YXRpb25zX18nKQpXUkFQUEVSX1VQREFURVMgPSAoJ19fZGljdF9fJywpCmRlZiB1cGRhdGVfd3JhcHBlcih3cmFwcGVyLAogICAgICAgICAgICAgICAgICAgd3JhcHBlZCwKICAgICAgICAgICAgICAgICAgIGFzc2lnbmVkID0gV1JBUFBFUl9BU1NJR05NRU5UUywKICAgICAgICAgICAgICAgICAgIHVwZGF0ZWQgPSBXUkFQUEVSX1VQREFURVMpOgogICAgIiIiVXBkYXRlIGEgd3JhcHBlciBmdW5jdGlvbiB0byBsb29rIGxpa2UgdGhlIHdyYXBwZWQgZnVuY3Rpb24KCiAgICAgICB3cmFwcGVyIGlzIHRoZSBmdW5jdGlvbiB0byBiZSB1cGRhdGVkCiAgICAgICB3cmFwcGVkIGlzIHRoZSBvcmlnaW5hbCBmdW5jdGlvbgogICAgICAgYXNzaWduZWQgaXMgYSB0dXBsZSBuYW1pbmcgdGhlIGF0dHJpYnV0ZXMgYXNzaWduZWQgZGlyZWN0bHkKICAgICAgIGZyb20gdGhlIHdyYXBwZWQgZnVuY3Rpb24gdG8gdGhlIHdyYXBwZXIgZnVuY3Rpb24gKGRlZmF1bHRzIHRvCiAgICAgICBmdW5jdG9vbHMuV1JBUFBFUl9BU1NJR05NRU5UUykKICAgICAgIHVwZGF0ZWQgaXMgYSB0dXBsZSBuYW1pbmcgdGhlIGF0dHJpYnV0ZXMgb2YgdGhlIHdyYXBwZXIgdGhhdAogICAgICAgYXJlIHVwZGF0ZWQgd2l0aCB0aGUgY29ycmVzcG9uZGluZyBhdHRyaWJ1dGUgZnJvbSB0aGUgd3JhcHBlZAogICAgICAgZnVuY3Rpb24gKGRlZmF1bHRzIHRvIGZ1bmN0b29scy5XUkFQUEVSX1VQREFURVMpCiAgICAiIiIKICAgIHdyYXBwZXIuX193cmFwcGVkX18gPSB3cmFwcGVkCiAgICBmb3IgYXR0ciBpbiBhc3NpZ25lZDoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHZhbHVlID0gZ2V0YXR0cih3cmFwcGVkLCBhdHRyKQogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNldGF0dHIod3JhcHBlciwgYXR0ciwgdmFsdWUpCiAgICBmb3IgYXR0ciBpbiB1cGRhdGVkOgogICAgICAgIGdldGF0dHIod3JhcHBlciwgYXR0cikudXBkYXRlKGdldGF0dHIod3JhcHBlZCwgYXR0ciwge30pKQogICAgIyBSZXR1cm4gdGhlIHdyYXBwZXIgc28gdGhpcyBjYW4gYmUgdXNlZCBhcyBhIGRlY29yYXRvciB2aWEgcGFydGlhbCgpCiAgICByZXR1cm4gd3JhcHBlcgoKZGVmIHdyYXBzKHdyYXBwZWQsCiAgICAgICAgICBhc3NpZ25lZCA9IFdSQVBQRVJfQVNTSUdOTUVOVFMsCiAgICAgICAgICB1cGRhdGVkID0gV1JBUFBFUl9VUERBVEVTKToKICAgICIiIkRlY29yYXRvciBmYWN0b3J5IHRvIGFwcGx5IHVwZGF0ZV93cmFwcGVyKCkgdG8gYSB3cmFwcGVyIGZ1bmN0aW9uCgogICAgICAgUmV0dXJucyBhIGRlY29yYXRvciB0aGF0IGludm9rZXMgdXBkYXRlX3dyYXBwZXIoKSB3aXRoIHRoZSBkZWNvcmF0ZWQKICAgICAgIGZ1bmN0aW9uIGFzIHRoZSB3cmFwcGVyIGFyZ3VtZW50IGFuZCB0aGUgYXJndW1lbnRzIHRvIHdyYXBzKCkgYXMgdGhlCiAgICAgICByZW1haW5pbmcgYXJndW1lbnRzLiBEZWZhdWx0IGFyZ3VtZW50cyBhcmUgYXMgZm9yIHVwZGF0ZV93cmFwcGVyKCkuCiAgICAgICBUaGlzIGlzIGEgY29udmVuaWVuY2UgZnVuY3Rpb24gdG8gc2ltcGxpZnkgYXBwbHlpbmcgcGFydGlhbCgpIHRvCiAgICAgICB1cGRhdGVfd3JhcHBlcigpLgogICAgIiIiCiAgICByZXR1cm4gcGFydGlhbCh1cGRhdGVfd3JhcHBlciwgd3JhcHBlZD13cmFwcGVkLAogICAgICAgICAgICAgICAgICAgYXNzaWduZWQ9YXNzaWduZWQsIHVwZGF0ZWQ9dXBkYXRlZCkKCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMgdG90YWxfb3JkZXJpbmcgY2xhc3MgZGVjb3JhdG9yCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgdG90YWxfb3JkZXJpbmcoY2xzKToKICAgICIiIkNsYXNzIGRlY29yYXRvciB0aGF0IGZpbGxzIGluIG1pc3Npbmcgb3JkZXJpbmcgbWV0aG9kcyIiIgogICAgY29udmVydCA9IHsKICAgICAgICAnX19sdF9fJzogWygnX19ndF9fJywgbGFtYmRhIHNlbGYsIG90aGVyOiBub3QgKHNlbGYgPCBvdGhlciBvciBzZWxmID09IG90aGVyKSksCiAgICAgICAgICAgICAgICAgICAoJ19fbGVfXycsIGxhbWJkYSBzZWxmLCBvdGhlcjogc2VsZiA8IG90aGVyIG9yIHNlbGYgPT0gb3RoZXIpLAogICAgICAgICAgICAgICAgICAgKCdfX2dlX18nLCBsYW1iZGEgc2VsZiwgb3RoZXI6IG5vdCBzZWxmIDwgb3RoZXIpXSwKICAgICAgICAnX19sZV9fJzogWygnX19nZV9fJywgbGFtYmRhIHNlbGYsIG90aGVyOiBub3Qgc2VsZiA8PSBvdGhlciBvciBzZWxmID09IG90aGVyKSwKICAgICAgICAgICAgICAgICAgICgnX19sdF9fJywgbGFtYmRhIHNlbGYsIG90aGVyOiBzZWxmIDw9IG90aGVyIGFuZCBub3Qgc2VsZiA9PSBvdGhlciksCiAgICAgICAgICAgICAgICAgICAoJ19fZ3RfXycsIGxhbWJkYSBzZWxmLCBvdGhlcjogbm90IHNlbGYgPD0gb3RoZXIpXSwKICAgICAgICAnX19ndF9fJzogWygnX19sdF9fJywgbGFtYmRhIHNlbGYsIG90aGVyOiBub3QgKHNlbGYgPiBvdGhlciBvciBzZWxmID09IG90aGVyKSksCiAgICAgICAgICAgICAgICAgICAoJ19fZ2VfXycsIGxhbWJkYSBzZWxmLCBvdGhlcjogc2VsZiA+IG90aGVyIG9yIHNlbGYgPT0gb3RoZXIpLAogICAgICAgICAgICAgICAgICAgKCdfX2xlX18nLCBsYW1iZGEgc2VsZiwgb3RoZXI6IG5vdCBzZWxmID4gb3RoZXIpXSwKICAgICAgICAnX19nZV9fJzogWygnX19sZV9fJywgbGFtYmRhIHNlbGYsIG90aGVyOiAobm90IHNlbGYgPj0gb3RoZXIpIG9yIHNlbGYgPT0gb3RoZXIpLAogICAgICAgICAgICAgICAgICAgKCdfX2d0X18nLCBsYW1iZGEgc2VsZiwgb3RoZXI6IHNlbGYgPj0gb3RoZXIgYW5kIG5vdCBzZWxmID09IG90aGVyKSwKICAgICAgICAgICAgICAgICAgICgnX19sdF9fJywgbGFtYmRhIHNlbGYsIG90aGVyOiBub3Qgc2VsZiA+PSBvdGhlcildCiAgICB9CiAgICAjIEZpbmQgdXNlci1kZWZpbmVkIGNvbXBhcmlzb25zIChub3QgdGhvc2UgaW5oZXJpdGVkIGZyb20gb2JqZWN0KS4KICAgIHJvb3RzID0gW29wIGZvciBvcCBpbiBjb252ZXJ0IGlmIGdldGF0dHIoY2xzLCBvcCwgTm9uZSkgaXMgbm90IGdldGF0dHIob2JqZWN0LCBvcCwgTm9uZSldCiAgICBpZiBub3Qgcm9vdHM6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignbXVzdCBkZWZpbmUgYXQgbGVhc3Qgb25lIG9yZGVyaW5nIG9wZXJhdGlvbjogPCA+IDw9ID49JykKICAgIHJvb3QgPSBtYXgocm9vdHMpICAgICAgICMgcHJlZmVyIF9fbHRfXyB0byBfX2xlX18gdG8gX19ndF9fIHRvIF9fZ2VfXwogICAgZm9yIG9wbmFtZSwgb3BmdW5jIGluIGNvbnZlcnRbcm9vdF06CiAgICAgICAgaWYgb3BuYW1lIG5vdCBpbiByb290czoKICAgICAgICAgICAgb3BmdW5jLl9fbmFtZV9fID0gb3BuYW1lCiAgICAgICAgICAgIG9wZnVuYy5fX2RvY19fID0gZ2V0YXR0cihpbnQsIG9wbmFtZSkuX19kb2NfXwogICAgICAgICAgICBzZXRhdHRyKGNscywgb3BuYW1lLCBvcGZ1bmMpCiAgICByZXR1cm4gY2xzCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjIGNtcF90b19rZXkoKSBmdW5jdGlvbiBjb252ZXJ0ZXIKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBjbXBfdG9fa2V5KG15Y21wKToKICAgICIiIkNvbnZlcnQgYSBjbXA9IGZ1bmN0aW9uIGludG8gYSBrZXk9IGZ1bmN0aW9uIiIiCiAgICBjbGFzcyBLKG9iamVjdCk6CiAgICAgICAgX19zbG90c19fID0gWydvYmonXQogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBvYmopOgogICAgICAgICAgICBzZWxmLm9iaiA9IG9iagogICAgICAgIGRlZiBfX2x0X18oc2VsZiwgb3RoZXIpOgogICAgICAgICAgICByZXR1cm4gbXljbXAoc2VsZi5vYmosIG90aGVyLm9iaikgPCAwCiAgICAgICAgZGVmIF9fZ3RfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgICAgIHJldHVybiBteWNtcChzZWxmLm9iaiwgb3RoZXIub2JqKSA+IDAKICAgICAgICBkZWYgX19lcV9fKHNlbGYsIG90aGVyKToKICAgICAgICAgICAgcmV0dXJuIG15Y21wKHNlbGYub2JqLCBvdGhlci5vYmopID09IDAKICAgICAgICBkZWYgX19sZV9fKHNlbGYsIG90aGVyKToKICAgICAgICAgICAgcmV0dXJuIG15Y21wKHNlbGYub2JqLCBvdGhlci5vYmopIDw9IDAKICAgICAgICBkZWYgX19nZV9fKHNlbGYsIG90aGVyKToKICAgICAgICAgICAgcmV0dXJuIG15Y21wKHNlbGYub2JqLCBvdGhlci5vYmopID49IDAKICAgICAgICBkZWYgX19uZV9fKHNlbGYsIG90aGVyKToKICAgICAgICAgICAgcmV0dXJuIG15Y21wKHNlbGYub2JqLCBvdGhlci5vYmopICE9IDAKICAgICAgICBfX2hhc2hfXyA9IE5vbmUKICAgIHJldHVybiBLCgp0cnk6CiAgICBmcm9tIF9mdW5jdG9vbHMgaW1wb3J0IGNtcF90b19rZXkKZXhjZXB0IEltcG9ydEVycm9yOgogICAgcGFzcwoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIyBMUlUgQ2FjaGUgZnVuY3Rpb24gZGVjb3JhdG9yCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpfQ2FjaGVJbmZvID0gbmFtZWR0dXBsZSgiQ2FjaGVJbmZvIiwgWyJoaXRzIiwgIm1pc3NlcyIsICJtYXhzaXplIiwgImN1cnJzaXplIl0pCgpjbGFzcyBfSGFzaGVkU2VxKGxpc3QpOgogICAgX19zbG90c19fID0gJ2hhc2h2YWx1ZScKCiAgICBkZWYgX19pbml0X18oc2VsZiwgdHVwLCBoYXNoPWhhc2gpOgogICAgICAgIHNlbGZbOl0gPSB0dXAKICAgICAgICBzZWxmLmhhc2h2YWx1ZSA9IGhhc2godHVwKQoKICAgIGRlZiBfX2hhc2hfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5oYXNodmFsdWUKCmRlZiBfbWFrZV9rZXkoYXJncywga3dkcywgdHlwZWQsCiAgICAgICAgICAgICBrd2RfbWFyayA9IChvYmplY3QoKSwpLAogICAgICAgICAgICAgZmFzdHR5cGVzID0ge2ludCwgc3RyLCBmcm96ZW5zZXQsIHR5cGUoTm9uZSl9LAogICAgICAgICAgICAgc29ydGVkPXNvcnRlZCwgdHVwbGU9dHVwbGUsIHR5cGU9dHlwZSwgbGVuPWxlbik6CiAgICAnTWFrZSBhIGNhY2hlIGtleSBmcm9tIG9wdGlvbmFsbHkgdHlwZWQgcG9zaXRpb25hbCBhbmQga2V5d29yZCBhcmd1bWVudHMnCiAgICBrZXkgPSBhcmdzCiAgICBpZiBrd2RzOgogICAgICAgIHNvcnRlZF9pdGVtcyA9IHNvcnRlZChrd2RzLml0ZW1zKCkpCiAgICAgICAga2V5ICs9IGt3ZF9tYXJrCiAgICAgICAgZm9yIGl0ZW0gaW4gc29ydGVkX2l0ZW1zOgogICAgICAgICAgICBrZXkgKz0gaXRlbQogICAgaWYgdHlwZWQ6CiAgICAgICAga2V5ICs9IHR1cGxlKHR5cGUodikgZm9yIHYgaW4gYXJncykKICAgICAgICBpZiBrd2RzOgogICAgICAgICAgICBrZXkgKz0gdHVwbGUodHlwZSh2KSBmb3IgaywgdiBpbiBzb3J0ZWRfaXRlbXMpCiAgICBlbGlmIGxlbihrZXkpID09IDEgYW5kIHR5cGUoa2V5WzBdKSBpbiBmYXN0dHlwZXM6CiAgICAgICAgcmV0dXJuIGtleVswXQogICAgcmV0dXJuIF9IYXNoZWRTZXEoa2V5KQoKZGVmIGxydV9jYWNoZShtYXhzaXplPTEyOCwgdHlwZWQ9RmFsc2UpOgogICAgIiIiTGVhc3QtcmVjZW50bHktdXNlZCBjYWNoZSBkZWNvcmF0b3IuCgogICAgSWYgKm1heHNpemUqIGlzIHNldCB0byBOb25lLCB0aGUgTFJVIGZlYXR1cmVzIGFyZSBkaXNhYmxlZCBhbmQgdGhlIGNhY2hlCiAgICBjYW4gZ3JvdyB3aXRob3V0IGJvdW5kLgoKICAgIElmICp0eXBlZCogaXMgVHJ1ZSwgYXJndW1lbnRzIG9mIGRpZmZlcmVudCB0eXBlcyB3aWxsIGJlIGNhY2hlZCBzZXBhcmF0ZWx5LgogICAgRm9yIGV4YW1wbGUsIGYoMy4wKSBhbmQgZigzKSB3aWxsIGJlIHRyZWF0ZWQgYXMgZGlzdGluY3QgY2FsbHMgd2l0aAogICAgZGlzdGluY3QgcmVzdWx0cy4KCiAgICBBcmd1bWVudHMgdG8gdGhlIGNhY2hlZCBmdW5jdGlvbiBtdXN0IGJlIGhhc2hhYmxlLgoKICAgIFZpZXcgdGhlIGNhY2hlIHN0YXRpc3RpY3MgbmFtZWQgdHVwbGUgKGhpdHMsIG1pc3NlcywgbWF4c2l6ZSwgY3VycnNpemUpCiAgICB3aXRoIGYuY2FjaGVfaW5mbygpLiAgQ2xlYXIgdGhlIGNhY2hlIGFuZCBzdGF0aXN0aWNzIHdpdGggZi5jYWNoZV9jbGVhcigpLgogICAgQWNjZXNzIHRoZSB1bmRlcmx5aW5nIGZ1bmN0aW9uIHdpdGggZi5fX3dyYXBwZWRfXy4KCiAgICBTZWU6ICBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NhY2hlX2FsZ29yaXRobXMjTGVhc3RfUmVjZW50bHlfVXNlZAoKICAgICIiIgoKICAgICMgVXNlcnMgc2hvdWxkIG9ubHkgYWNjZXNzIHRoZSBscnVfY2FjaGUgdGhyb3VnaCBpdHMgcHVibGljIEFQSToKICAgICMgICAgICAgY2FjaGVfaW5mbywgY2FjaGVfY2xlYXIsIGFuZCBmLl9fd3JhcHBlZF9fCiAgICAjIFRoZSBpbnRlcm5hbHMgb2YgdGhlIGxydV9jYWNoZSBhcmUgZW5jYXBzdWxhdGVkIGZvciB0aHJlYWQgc2FmZXR5IGFuZAogICAgIyB0byBhbGxvdyB0aGUgaW1wbGVtZW50YXRpb24gdG8gY2hhbmdlIChpbmNsdWRpbmcgYSBwb3NzaWJsZSBDIHZlcnNpb24pLgoKICAgICMgQ29uc3RhbnRzIHNoYXJlZCBieSBhbGwgbHJ1IGNhY2hlIGluc3RhbmNlczoKICAgIHNlbnRpbmVsID0gb2JqZWN0KCkgICAgICAgICAgIyB1bmlxdWUgb2JqZWN0IHVzZWQgdG8gc2lnbmFsIGNhY2hlIG1pc3NlcwogICAgbWFrZV9rZXkgPSBfbWFrZV9rZXkgICAgICAgICAjIGJ1aWxkIGEga2V5IGZyb20gdGhlIGZ1bmN0aW9uIGFyZ3VtZW50cwogICAgUFJFViwgTkVYVCwgS0VZLCBSRVNVTFQgPSAwLCAxLCAyLCAzICAgIyBuYW1lcyBmb3IgdGhlIGxpbmsgZmllbGRzCgogICAgZGVmIGRlY29yYXRpbmdfZnVuY3Rpb24odXNlcl9mdW5jdGlvbik6CgogICAgICAgIGNhY2hlID0ge30KICAgICAgICBoaXRzID0gbWlzc2VzID0gY3VycnNpemUgPSAwCiAgICAgICAgZnVsbCA9IEZhbHNlCiAgICAgICAgY2FjaGVfZ2V0ID0gY2FjaGUuZ2V0ICAgICMgYm91bmQgbWV0aG9kIHRvIGxvb2t1cCBhIGtleSBvciByZXR1cm4gTm9uZQogICAgICAgIGxvY2sgPSBMb2NrKCkgICAgICAgICAgICAjIGJlY2F1c2UgbGlua2VkbGlzdCB1cGRhdGVzIGFyZW4ndCB0aHJlYWRzYWZlCiAgICAgICAgcm9vdCA9IFtdICAgICAgICAgICAgICAgICMgcm9vdCBvZiB0aGUgY2lyY3VsYXIgZG91Ymx5IGxpbmtlZCBsaXN0CiAgICAgICAgcm9vdFs6XSA9IFtyb290LCByb290LCBOb25lLCBOb25lXSAgICAgIyBpbml0aWFsaXplIGJ5IHBvaW50aW5nIHRvIHNlbGYKCiAgICAgICAgaWYgbWF4c2l6ZSA9PSAwOgoKICAgICAgICAgICAgZGVmIHdyYXBwZXIoKmFyZ3MsICoqa3dkcyk6CiAgICAgICAgICAgICAgICAjIG5vIGNhY2hpbmcsIGp1c3QgYSBzdGF0aXN0aWNzIHVwZGF0ZSBhZnRlciBhIHN1Y2Nlc3NmdWwgY2FsbAogICAgICAgICAgICAgICAgbm9ubG9jYWwgbWlzc2VzCiAgICAgICAgICAgICAgICByZXN1bHQgPSB1c2VyX2Z1bmN0aW9uKCphcmdzLCAqKmt3ZHMpCiAgICAgICAgICAgICAgICBtaXNzZXMgKz0gMQogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgICAgICBlbGlmIG1heHNpemUgaXMgTm9uZToKCiAgICAgICAgICAgIGRlZiB3cmFwcGVyKCphcmdzLCAqKmt3ZHMpOgogICAgICAgICAgICAgICAgIyBzaW1wbGUgY2FjaGluZyB3aXRob3V0IG9yZGVyaW5nIG9yIHNpemUgbGltaXQKICAgICAgICAgICAgICAgIG5vbmxvY2FsIGhpdHMsIG1pc3NlcywgY3VycnNpemUKICAgICAgICAgICAgICAgIGtleSA9IG1ha2Vfa2V5KGFyZ3MsIGt3ZHMsIHR5cGVkKQogICAgICAgICAgICAgICAgcmVzdWx0ID0gY2FjaGVfZ2V0KGtleSwgc2VudGluZWwpCiAgICAgICAgICAgICAgICBpZiByZXN1bHQgaXMgbm90IHNlbnRpbmVsOgogICAgICAgICAgICAgICAgICAgIGhpdHMgKz0gMQogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHVzZXJfZnVuY3Rpb24oKmFyZ3MsICoqa3dkcykKICAgICAgICAgICAgICAgIGNhY2hlW2tleV0gPSByZXN1bHQKICAgICAgICAgICAgICAgIG1pc3NlcyArPSAxCiAgICAgICAgICAgICAgICBjdXJyc2l6ZSArPSAxCiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgICAgIGVsc2U6CgogICAgICAgICAgICBkZWYgd3JhcHBlcigqYXJncywgKiprd2RzKToKICAgICAgICAgICAgICAgICMgc2l6ZSBsaW1pdGVkIGNhY2hpbmcgdGhhdCB0cmFja3MgYWNjZXNzZXMgYnkgcmVjZW5jeQogICAgICAgICAgICAgICAgbm9ubG9jYWwgcm9vdCwgaGl0cywgbWlzc2VzLCBjdXJyc2l6ZSwgZnVsbAogICAgICAgICAgICAgICAga2V5ID0gbWFrZV9rZXkoYXJncywga3dkcywgdHlwZWQpCiAgICAgICAgICAgICAgICB3aXRoIGxvY2s6CiAgICAgICAgICAgICAgICAgICAgbGluayA9IGNhY2hlX2dldChrZXkpCiAgICAgICAgICAgICAgICAgICAgaWYgbGluayBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICAgICAgIyBtb3ZlIHRoZSBsaW5rIHRvIHRoZSBmcm9udCBvZiB0aGUgY2lyY3VsYXIgcXVldWUKICAgICAgICAgICAgICAgICAgICAgICAgbGlua19wcmV2LCBsaW5rX25leHQsIGtleSwgcmVzdWx0ID0gbGluawogICAgICAgICAgICAgICAgICAgICAgICBsaW5rX3ByZXZbTkVYVF0gPSBsaW5rX25leHQKICAgICAgICAgICAgICAgICAgICAgICAgbGlua19uZXh0W1BSRVZdID0gbGlua19wcmV2CiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3QgPSByb290W1BSRVZdCiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RbTkVYVF0gPSByb290W1BSRVZdID0gbGluawogICAgICAgICAgICAgICAgICAgICAgICBsaW5rW1BSRVZdID0gbGFzdAogICAgICAgICAgICAgICAgICAgICAgICBsaW5rW05FWFRdID0gcm9vdAogICAgICAgICAgICAgICAgICAgICAgICBoaXRzICs9IDEKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgICAgICAgICAgcmVzdWx0ID0gdXNlcl9mdW5jdGlvbigqYXJncywgKiprd2RzKQogICAgICAgICAgICAgICAgd2l0aCBsb2NrOgogICAgICAgICAgICAgICAgICAgIGlmIGtleSBpbiBjYWNoZToKICAgICAgICAgICAgICAgICAgICAgICAgIyBnZXR0aW5nIGhlcmUgbWVhbnMgdGhhdCB0aGlzIHNhbWUga2V5IHdhcyBhZGRlZCB0byB0aGUKICAgICAgICAgICAgICAgICAgICAgICAgIyBjYWNoZSB3aGlsZSB0aGUgbG9jayB3YXMgcmVsZWFzZWQuICBzaW5jZSB0aGUgbGluawogICAgICAgICAgICAgICAgICAgICAgICAjIHVwZGF0ZSBpcyBhbHJlYWR5IGRvbmUsIHdlIG5lZWQgb25seSByZXR1cm4gdGhlCiAgICAgICAgICAgICAgICAgICAgICAgICMgY29tcHV0ZWQgcmVzdWx0IGFuZCB1cGRhdGUgdGhlIGNvdW50IG9mIG1pc3Nlcy4KICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgICAgIGVsaWYgZnVsbDoKICAgICAgICAgICAgICAgICAgICAgICAgIyB1c2Ugcm9vdCB0byBzdG9yZSB0aGUgbmV3IGtleSBhbmQgcmVzdWx0CiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3RbS0VZXSA9IGtleQogICAgICAgICAgICAgICAgICAgICAgICByb290W1JFU1VMVF0gPSByZXN1bHQKICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVba2V5XSA9IHJvb3QKICAgICAgICAgICAgICAgICAgICAgICAgIyBlbXB0eSB0aGUgb2xkZXN0IGxpbmsgYW5kIG1ha2UgaXQgdGhlIG5ldyByb290CiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3QgPSByb290W05FWFRdCiAgICAgICAgICAgICAgICAgICAgICAgIGRlbCBjYWNoZVtyb290W0tFWV1dCiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3RbS0VZXSA9IHJvb3RbUkVTVUxUXSA9IE5vbmUKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAjIHB1dCByZXN1bHQgaW4gYSBuZXcgbGluayBhdCB0aGUgZnJvbnQgb2YgdGhlIHF1ZXVlCiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3QgPSByb290W1BSRVZdCiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsgPSBbbGFzdCwgcm9vdCwga2V5LCByZXN1bHRdCiAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlW2tleV0gPSBsYXN0W05FWFRdID0gcm9vdFtQUkVWXSA9IGxpbmsKICAgICAgICAgICAgICAgICAgICAgICAgY3VycnNpemUgKz0gMQogICAgICAgICAgICAgICAgICAgICAgICBmdWxsID0gKGN1cnJzaXplID09IG1heHNpemUpCiAgICAgICAgICAgICAgICAgICAgbWlzc2VzICs9IDEKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQKCiAgICAgICAgZGVmIGNhY2hlX2luZm8oKToKICAgICAgICAgICAgIiIiUmVwb3J0IGNhY2hlIHN0YXRpc3RpY3MiIiIKICAgICAgICAgICAgd2l0aCBsb2NrOgogICAgICAgICAgICAgICAgcmV0dXJuIF9DYWNoZUluZm8oaGl0cywgbWlzc2VzLCBtYXhzaXplLCBjdXJyc2l6ZSkKCiAgICAgICAgZGVmIGNhY2hlX2NsZWFyKCk6CiAgICAgICAgICAgICIiIkNsZWFyIHRoZSBjYWNoZSBhbmQgY2FjaGUgc3RhdGlzdGljcyIiIgogICAgICAgICAgICBub25sb2NhbCBoaXRzLCBtaXNzZXMsIGN1cnJzaXplLCBmdWxsCiAgICAgICAgICAgIHdpdGggbG9jazoKICAgICAgICAgICAgICAgIGNhY2hlLmNsZWFyKCkKICAgICAgICAgICAgICAgIHJvb3RbOl0gPSBbcm9vdCwgcm9vdCwgTm9uZSwgTm9uZV0KICAgICAgICAgICAgICAgIGhpdHMgPSBtaXNzZXMgPSBjdXJyc2l6ZSA9IDAKICAgICAgICAgICAgICAgIGZ1bGwgPSBGYWxzZQoKICAgICAgICB3cmFwcGVyLmNhY2hlX2luZm8gPSBjYWNoZV9pbmZvCiAgICAgICAgd3JhcHBlci5jYWNoZV9jbGVhciA9IGNhY2hlX2NsZWFyCiAgICAgICAgcmV0dXJuIHVwZGF0ZV93cmFwcGVyKHdyYXBwZXIsIHVzZXJfZnVuY3Rpb24pCgogICAgcmV0dXJuIGRlY29yYXRpbmdfZnVuY3Rpb24K',
'/Lib/gc.py':'IiIiVGhpcyBtb2R1bGUgcHJvdmlkZXMgYWNjZXNzIHRvIHRoZSBnYXJiYWdlIGNvbGxlY3RvciBmb3IgcmVmZXJlbmNlIGN5Y2xlcy4KCmVuYWJsZSgpIC0tIEVuYWJsZSBhdXRvbWF0aWMgZ2FyYmFnZSBjb2xsZWN0aW9uLgpkaXNhYmxlKCkgLS0gRGlzYWJsZSBhdXRvbWF0aWMgZ2FyYmFnZSBjb2xsZWN0aW9uLgppc2VuYWJsZWQoKSAtLSBSZXR1cm5zIHRydWUgaWYgYXV0b21hdGljIGNvbGxlY3Rpb24gaXMgZW5hYmxlZC4KY29sbGVjdCgpIC0tIERvIGEgZnVsbCBjb2xsZWN0aW9uIHJpZ2h0IG5vdy4KZ2V0X2NvdW50KCkgLS0gUmV0dXJuIHRoZSBjdXJyZW50IGNvbGxlY3Rpb24gY291bnRzLgpzZXRfZGVidWcoKSAtLSBTZXQgZGVidWdnaW5nIGZsYWdzLgpnZXRfZGVidWcoKSAtLSBHZXQgZGVidWdnaW5nIGZsYWdzLgpzZXRfdGhyZXNob2xkKCkgLS0gU2V0IHRoZSBjb2xsZWN0aW9uIHRocmVzaG9sZHMuCmdldF90aHJlc2hvbGQoKSAtLSBSZXR1cm4gdGhlIGN1cnJlbnQgdGhlIGNvbGxlY3Rpb24gdGhyZXNob2xkcy4KZ2V0X29iamVjdHMoKSAtLSBSZXR1cm4gYSBsaXN0IG9mIGFsbCBvYmplY3RzIHRyYWNrZWQgYnkgdGhlIGNvbGxlY3Rvci4KaXNfdHJhY2tlZCgpIC0tIFJldHVybnMgdHJ1ZSBpZiBhIGdpdmVuIG9iamVjdCBpcyB0cmFja2VkLgpnZXRfcmVmZXJyZXJzKCkgLS0gUmV0dXJuIHRoZSBsaXN0IG9mIG9iamVjdHMgdGhhdCByZWZlciB0byBhbiBvYmplY3QuCmdldF9yZWZlcmVudHMoKSAtLSBSZXR1cm4gdGhlIGxpc3Qgb2Ygb2JqZWN0cyB0aGF0IGFuIG9iamVjdCByZWZlcnMgdG8uCiIiIgoKCkRFQlVHX0NPTExFQ1RBQkxFID0gMgoKREVCVUdfTEVBSyA9IDM4CgpERUJVR19TQVZFQUxMID0gMzIKCkRFQlVHX1NUQVRTID0gMQoKREVCVUdfVU5DT0xMRUNUQUJMRSA9IDQKCmNsYXNzIF9fbG9hZGVyX186CiAgICBwYXNzCgpjYWxsYmFja3MgPSBbXQoKZGVmIGNvbGxlY3QoKmFyZ3MsKiprdyk6CiAgICAiIiJjb2xsZWN0KFtnZW5lcmF0aW9uXSkgLT4gbiAgICAKICAgIFdpdGggbm8gYXJndW1lbnRzLCBydW4gYSBmdWxsIGNvbGxlY3Rpb24uICBUaGUgb3B0aW9uYWwgYXJndW1lbnQKICAgIG1heSBiZSBhbiBpbnRlZ2VyIHNwZWNpZnlpbmcgd2hpY2ggZ2VuZXJhdGlvbiB0byBjb2xsZWN0LiAgQSBWYWx1ZUVycm9yCiAgICBpcyByYWlzZWQgaWYgdGhlIGdlbmVyYXRpb24gbnVtYmVyIGlzIGludmFsaWQuCiAgICAKICAgIFRoZSBudW1iZXIgb2YgdW5yZWFjaGFibGUgb2JqZWN0cyBpcyByZXR1cm5lZC4KICAgICIiIgogICAgcGFzcwoKZGVmIGRpc2FibGUoKmFyZ3MsKiprdyk6CiAgICAiIiJkaXNhYmxlKCkgLT4gTm9uZSAgICAKICAgIERpc2FibGUgYXV0b21hdGljIGdhcmJhZ2UgY29sbGVjdGlvbi4KICAgICIiIgogICAgcGFzcwoKZGVmIGVuYWJsZSgqYXJncywqKmt3KToKICAgICIiImVuYWJsZSgpIC0+IE5vbmUgICAgCiAgICBFbmFibGUgYXV0b21hdGljIGdhcmJhZ2UgY29sbGVjdGlvbi4KICAgICIiIgogICAgcGFzcwoKZ2FyYmFnZSA9IFtdCgpkZWYgZ2V0X2NvdW50KCphcmdzLCoqa3cpOgogICAgIiIiZ2V0X2NvdW50KCkgLT4gKGNvdW50MCwgY291bnQxLCBjb3VudDIpICAgIAogICAgUmV0dXJuIHRoZSBjdXJyZW50IGNvbGxlY3Rpb24gY291bnRzCiAgICAiIiIKICAgIHBhc3MKCmRlZiBnZXRfZGVidWcoKmFyZ3MsKiprdyk6CiAgICAiIiJnZXRfZGVidWcoKSAtPiBmbGFncyAgICAKICAgIEdldCB0aGUgZ2FyYmFnZSBjb2xsZWN0aW9uIGRlYnVnZ2luZyBmbGFncy4KICAgICIiIgogICAgcGFzcwoKZGVmIGdldF9vYmplY3RzKCphcmdzLCoqa3cpOgogICAgIiIiZ2V0X29iamVjdHMoKSAtPiBbLi4uXSAgICAKICAgIFJldHVybiBhIGxpc3Qgb2Ygb2JqZWN0cyB0cmFja2VkIGJ5IHRoZSBjb2xsZWN0b3IgKGV4Y2x1ZGluZyB0aGUgbGlzdAogICAgcmV0dXJuZWQpLgogICAgIiIiCiAgICBwYXNzCgpkZWYgZ2V0X3JlZmVyZW50cygqYXJncywqKmt3KToKICAgICIiImdldF9yZWZlcmVudHMoKm9ianMpIC0+IGxpc3QgICAgUmV0dXJuIHRoZSBsaXN0IG9mIG9iamVjdHMgdGhhdCBhcmUgZGlyZWN0bHkgcmVmZXJyZWQgdG8gYnkgb2Jqcy4iIiIKICAgIHBhc3MKCmRlZiBnZXRfcmVmZXJyZXJzKCphcmdzLCoqa3cpOgogICAgIiIiZ2V0X3JlZmVycmVycygqb2JqcykgLT4gbGlzdCAgICBSZXR1cm4gdGhlIGxpc3Qgb2Ygb2JqZWN0cyB0aGF0IGRpcmVjdGx5IHJlZmVyIHRvIGFueSBvZiBvYmpzLiIiIgogICAgcGFzcwoKZGVmIGdldF90aHJlc2hvbGQoKmFyZ3MsKiprdyk6CiAgICAiIiJnZXRfdGhyZXNob2xkKCkgLT4gKHRocmVzaG9sZDAsIHRocmVzaG9sZDEsIHRocmVzaG9sZDIpICAgIAogICAgUmV0dXJuIHRoZSBjdXJyZW50IGNvbGxlY3Rpb24gdGhyZXNob2xkcwogICAgIiIiCiAgICBwYXNzCgpkZWYgaXNfdHJhY2tlZCgqYXJncywqKmt3KToKICAgICIiImlzX3RyYWNrZWQob2JqKSAtPiBib29sICAgIAogICAgUmV0dXJucyB0cnVlIGlmIHRoZSBvYmplY3QgaXMgdHJhY2tlZCBieSB0aGUgZ2FyYmFnZSBjb2xsZWN0b3IuCiAgICBTaW1wbGUgYXRvbWljIG9iamVjdHMgd2lsbCByZXR1cm4gZmFsc2UuCiAgICAiIiIKICAgIHBhc3MKCmRlZiBpc2VuYWJsZWQoKmFyZ3MsKiprdyk6CiAgICAiIiJpc2VuYWJsZWQoKSAtPiBzdGF0dXMgICAgCiAgICBSZXR1cm5zIHRydWUgaWYgYXV0b21hdGljIGdhcmJhZ2UgY29sbGVjdGlvbiBpcyBlbmFibGVkLgogICAgIiIiCiAgICBwYXNzCgpkZWYgc2V0X2RlYnVnKCphcmdzLCoqa3cpOgogICAgIiIic2V0X2RlYnVnKGZsYWdzKSAtPiBOb25lICAgIAogICAgU2V0IHRoZSBnYXJiYWdlIGNvbGxlY3Rpb24gZGVidWdnaW5nIGZsYWdzLiBEZWJ1Z2dpbmcgaW5mb3JtYXRpb24gaXMKICAgIHdyaXR0ZW4gdG8gc3lzLnN0ZGVyci4KICAgIAogICAgZmxhZ3MgaXMgYW4gaW50ZWdlciBhbmQgY2FuIGhhdmUgdGhlIGZvbGxvd2luZyBiaXRzIHR1cm5lZCBvbjoKICAgIAogICAgICBERUJVR19TVEFUUyAtIFByaW50IHN0YXRpc3RpY3MgZHVyaW5nIGNvbGxlY3Rpb24uCiAgICAgIERFQlVHX0NPTExFQ1RBQkxFIC0gUHJpbnQgY29sbGVjdGFibGUgb2JqZWN0cyBmb3VuZC4KICAgICAgREVCVUdfVU5DT0xMRUNUQUJMRSAtIFByaW50IHVucmVhY2hhYmxlIGJ1dCB1bmNvbGxlY3RhYmxlIG9iamVjdHMgZm91bmQuCiAgICAgIERFQlVHX1NBVkVBTEwgLSBTYXZlIG9iamVjdHMgdG8gZ2MuZ2FyYmFnZSByYXRoZXIgdGhhbiBmcmVlaW5nIHRoZW0uCiAgICAgIERFQlVHX0xFQUsgLSBEZWJ1ZyBsZWFraW5nIHByb2dyYW1zIChldmVyeXRoaW5nIGJ1dCBTVEFUUykuCiAgICAiIiIKICAgIHBhc3MKCmRlZiBzZXRfdGhyZXNob2xkKCphcmdzLCoqa3cpOgogICAgIiIic2V0X3RocmVzaG9sZCh0aHJlc2hvbGQwLCBbdGhyZXNob2xkMSwgdGhyZXNob2xkMl0pIC0+IE5vbmUgICAgCiAgICBTZXRzIHRoZSBjb2xsZWN0aW9uIHRocmVzaG9sZHMuICBTZXR0aW5nIHRocmVzaG9sZDAgdG8gemVybyBkaXNhYmxlcwogICAgY29sbGVjdGlvbi4KICAgICIiIgogICAgcGFzcwo=',
'/Lib/genericpath.py':'IiIiClBhdGggb3BlcmF0aW9ucyBjb21tb24gdG8gbW9yZSB0aGFuIG9uZSBPUwpEbyBub3QgdXNlIGRpcmVjdGx5LiAgVGhlIE9TIHNwZWNpZmljIG1vZHVsZXMgaW1wb3J0IHRoZSBhcHByb3ByaWF0ZQpmdW5jdGlvbnMgZnJvbSB0aGlzIG1vZHVsZSB0aGVtc2VsdmVzLgoiIiIKaW1wb3J0IG9zCmltcG9ydCBzdGF0CgpfX2FsbF9fID0gWydjb21tb25wcmVmaXgnLCAnZXhpc3RzJywgJ2dldGF0aW1lJywgJ2dldGN0aW1lJywgJ2dldG10aW1lJywKICAgICAgICAgICAnZ2V0c2l6ZScsICdpc2RpcicsICdpc2ZpbGUnXQoKCiMgRG9lcyBhIHBhdGggZXhpc3Q/CiMgVGhpcyBpcyBmYWxzZSBmb3IgZGFuZ2xpbmcgc3ltYm9saWMgbGlua3Mgb24gc3lzdGVtcyB0aGF0IHN1cHBvcnQgdGhlbS4KZGVmIGV4aXN0cyhwYXRoKToKICAgICIiIlRlc3Qgd2hldGhlciBhIHBhdGggZXhpc3RzLiAgUmV0dXJucyBGYWxzZSBmb3IgYnJva2VuIHN5bWJvbGljIGxpbmtzIiIiCiAgICB0cnk6CiAgICAgICAgb3Muc3RhdChwYXRoKQogICAgZXhjZXB0IG9zLmVycm9yOgogICAgICAgIHJldHVybiBGYWxzZQogICAgcmV0dXJuIFRydWUKCgojIFRoaXMgZm9sbG93cyBzeW1ib2xpYyBsaW5rcywgc28gYm90aCBpc2xpbmsoKSBhbmQgaXNkaXIoKSBjYW4gYmUgdHJ1ZQojIGZvciB0aGUgc2FtZSBwYXRoIG9ubyBzeXN0ZW1zIHRoYXQgc3VwcG9ydCBzeW1saW5rcwpkZWYgaXNmaWxlKHBhdGgpOgogICAgIiIiVGVzdCB3aGV0aGVyIGEgcGF0aCBpcyBhIHJlZ3VsYXIgZmlsZSIiIgogICAgdHJ5OgogICAgICAgIHN0ID0gb3Muc3RhdChwYXRoKQogICAgZXhjZXB0IG9zLmVycm9yOgogICAgICAgIHJldHVybiBGYWxzZQogICAgcmV0dXJuIHN0YXQuU19JU1JFRyhzdC5zdF9tb2RlKQoKCiMgSXMgYSBwYXRoIGEgZGlyZWN0b3J5PwojIFRoaXMgZm9sbG93cyBzeW1ib2xpYyBsaW5rcywgc28gYm90aCBpc2xpbmsoKSBhbmQgaXNkaXIoKQojIGNhbiBiZSB0cnVlIGZvciB0aGUgc2FtZSBwYXRoIG9uIHN5c3RlbXMgdGhhdCBzdXBwb3J0IHN5bWxpbmtzCmRlZiBpc2RpcihzKToKICAgICIiIlJldHVybiB0cnVlIGlmIHRoZSBwYXRobmFtZSByZWZlcnMgdG8gYW4gZXhpc3RpbmcgZGlyZWN0b3J5LiIiIgogICAgdHJ5OgogICAgICAgIHN0ID0gb3Muc3RhdChzKQogICAgZXhjZXB0IG9zLmVycm9yOgogICAgICAgIHJldHVybiBGYWxzZQogICAgcmV0dXJuIHN0YXQuU19JU0RJUihzdC5zdF9tb2RlKQoKCmRlZiBnZXRzaXplKGZpbGVuYW1lKToKICAgICIiIlJldHVybiB0aGUgc2l6ZSBvZiBhIGZpbGUsIHJlcG9ydGVkIGJ5IG9zLnN0YXQoKS4iIiIKICAgIHJldHVybiBvcy5zdGF0KGZpbGVuYW1lKS5zdF9zaXplCgoKZGVmIGdldG10aW1lKGZpbGVuYW1lKToKICAgICIiIlJldHVybiB0aGUgbGFzdCBtb2RpZmljYXRpb24gdGltZSBvZiBhIGZpbGUsIHJlcG9ydGVkIGJ5IG9zLnN0YXQoKS4iIiIKICAgIHJldHVybiBvcy5zdGF0KGZpbGVuYW1lKS5zdF9tdGltZQoKCmRlZiBnZXRhdGltZShmaWxlbmFtZSk6CiAgICAiIiJSZXR1cm4gdGhlIGxhc3QgYWNjZXNzIHRpbWUgb2YgYSBmaWxlLCByZXBvcnRlZCBieSBvcy5zdGF0KCkuIiIiCiAgICByZXR1cm4gb3Muc3RhdChmaWxlbmFtZSkuc3RfYXRpbWUKCgpkZWYgZ2V0Y3RpbWUoZmlsZW5hbWUpOgogICAgIiIiUmV0dXJuIHRoZSBtZXRhZGF0YSBjaGFuZ2UgdGltZSBvZiBhIGZpbGUsIHJlcG9ydGVkIGJ5IG9zLnN0YXQoKS4iIiIKICAgIHJldHVybiBvcy5zdGF0KGZpbGVuYW1lKS5zdF9jdGltZQoKCiMgUmV0dXJuIHRoZSBsb25nZXN0IHByZWZpeCBvZiBhbGwgbGlzdCBlbGVtZW50cy4KZGVmIGNvbW1vbnByZWZpeChtKToKICAgICJHaXZlbiBhIGxpc3Qgb2YgcGF0aG5hbWVzLCByZXR1cm5zIHRoZSBsb25nZXN0IGNvbW1vbiBsZWFkaW5nIGNvbXBvbmVudCIKICAgIGlmIG5vdCBtOiByZXR1cm4gJycKICAgIHMxID0gbWluKG0pCiAgICBzMiA9IG1heChtKQogICAgZm9yIGksIGMgaW4gZW51bWVyYXRlKHMxKToKICAgICAgICBpZiBjICE9IHMyW2ldOgogICAgICAgICAgICByZXR1cm4gczFbOmldCiAgICByZXR1cm4gczEKCiMgU3BsaXQgYSBwYXRoIGluIHJvb3QgYW5kIGV4dGVuc2lvbi4KIyBUaGUgZXh0ZW5zaW9uIGlzIGV2ZXJ5dGhpbmcgc3RhcnRpbmcgYXQgdGhlIGxhc3QgZG90IGluIHRoZSBsYXN0CiMgcGF0aG5hbWUgY29tcG9uZW50OyB0aGUgcm9vdCBpcyBldmVyeXRoaW5nIGJlZm9yZSB0aGF0LgojIEl0IGlzIGFsd2F5cyB0cnVlIHRoYXQgcm9vdCArIGV4dCA9PSBwLgoKIyBHZW5lcmljIGltcGxlbWVudGF0aW9uIG9mIHNwbGl0ZXh0LCB0byBiZSBwYXJhbWV0cml6ZWQgd2l0aAojIHRoZSBzZXBhcmF0b3JzCmRlZiBfc3BsaXRleHQocCwgc2VwLCBhbHRzZXAsIGV4dHNlcCk6CiAgICAiIiJTcGxpdCB0aGUgZXh0ZW5zaW9uIGZyb20gYSBwYXRobmFtZS4KCiAgICBFeHRlbnNpb24gaXMgZXZlcnl0aGluZyBmcm9tIHRoZSBsYXN0IGRvdCB0byB0aGUgZW5kLCBpZ25vcmluZwogICAgbGVhZGluZyBkb3RzLiAgUmV0dXJucyAiKHJvb3QsIGV4dCkiOyBleHQgbWF5IGJlIGVtcHR5LiIiIgogICAgIyBOT1RFOiBUaGlzIGNvZGUgbXVzdCB3b3JrIGZvciB0ZXh0IGFuZCBieXRlcyBzdHJpbmdzLgoKICAgIHNlcEluZGV4ID0gcC5yZmluZChzZXApCiAgICBpZiBhbHRzZXA6CiAgICAgICAgYWx0c2VwSW5kZXggPSBwLnJmaW5kKGFsdHNlcCkKICAgICAgICBzZXBJbmRleCA9IG1heChzZXBJbmRleCwgYWx0c2VwSW5kZXgpCgogICAgZG90SW5kZXggPSBwLnJmaW5kKGV4dHNlcCkKICAgIGlmIGRvdEluZGV4ID4gc2VwSW5kZXg6CiAgICAgICAgIyBza2lwIGFsbCBsZWFkaW5nIGRvdHMKICAgICAgICBmaWxlbmFtZUluZGV4ID0gc2VwSW5kZXggKyAxCiAgICAgICAgd2hpbGUgZmlsZW5hbWVJbmRleCA8IGRvdEluZGV4OgogICAgICAgICAgICBpZiBwW2ZpbGVuYW1lSW5kZXg6ZmlsZW5hbWVJbmRleCsxXSAhPSBleHRzZXA6CiAgICAgICAgICAgICAgICByZXR1cm4gcFs6ZG90SW5kZXhdLCBwW2RvdEluZGV4Ol0KICAgICAgICAgICAgZmlsZW5hbWVJbmRleCArPSAxCgogICAgcmV0dXJuIHAsIHBbOjBdCg==',
'/Lib/getopt.py':'IiIiUGFyc2VyIGZvciBjb21tYW5kIGxpbmUgb3B0aW9ucy4KClRoaXMgbW9kdWxlIGhlbHBzIHNjcmlwdHMgdG8gcGFyc2UgdGhlIGNvbW1hbmQgbGluZSBhcmd1bWVudHMgaW4Kc3lzLmFyZ3YuICBJdCBzdXBwb3J0cyB0aGUgc2FtZSBjb252ZW50aW9ucyBhcyB0aGUgVW5peCBnZXRvcHQoKQpmdW5jdGlvbiAoaW5jbHVkaW5nIHRoZSBzcGVjaWFsIG1lYW5pbmdzIG9mIGFyZ3VtZW50cyBvZiB0aGUgZm9ybSBgLScKYW5kIGAtLScpLiAgTG9uZyBvcHRpb25zIHNpbWlsYXIgdG8gdGhvc2Ugc3VwcG9ydGVkIGJ5IEdOVSBzb2Z0d2FyZQptYXkgYmUgdXNlZCBhcyB3ZWxsIHZpYSBhbiBvcHRpb25hbCB0aGlyZCBhcmd1bWVudC4gIFRoaXMgbW9kdWxlCnByb3ZpZGVzIHR3byBmdW5jdGlvbnMgYW5kIGFuIGV4Y2VwdGlvbjoKCmdldG9wdCgpIC0tIFBhcnNlIGNvbW1hbmQgbGluZSBvcHRpb25zCmdudV9nZXRvcHQoKSAtLSBMaWtlIGdldG9wdCgpLCBidXQgYWxsb3cgb3B0aW9uIGFuZCBub24tb3B0aW9uIGFyZ3VtZW50cwp0byBiZSBpbnRlcm1peGVkLgpHZXRvcHRFcnJvciAtLSBleGNlcHRpb24gKGNsYXNzKSByYWlzZWQgd2l0aCAnb3B0JyBhdHRyaWJ1dGUsIHdoaWNoIGlzIHRoZQpvcHRpb24gaW52b2x2ZWQgd2l0aCB0aGUgZXhjZXB0aW9uLgoiIiIKCiMgTG9uZyBvcHRpb24gc3VwcG9ydCBhZGRlZCBieSBMYXJzIFdpcnplbml1cyA8bGl3QGlraS5maT4uCiMKIyBHZXJyaXQgSG9sbCA8Z2Vycml0QG5sLmxpbnV4Lm9yZz4gbW92ZWQgdGhlIHN0cmluZy1iYXNlZCBleGNlcHRpb25zCiMgdG8gY2xhc3MtYmFzZWQgZXhjZXB0aW9ucy4KIwojIFBldGVyIMODwoVzdHJhbmQgPGFzdHJhbmRAbHlzYXRvci5saXUuc2U+IGFkZGVkIGdudV9nZXRvcHQoKS4KIwojIFRPRE8gZm9yIGdudV9nZXRvcHQoKToKIwojIC0gR05VIGdldG9wdF9sb25nX29ubHkgbWVjaGFuaXNtCiMgLSBhbGxvdyB0aGUgY2FsbGVyIHRvIHNwZWNpZnkgb3JkZXJpbmcKIyAtIFJFVFVSTl9JTl9PUkRFUiBvcHRpb24KIyAtIEdOVSBleHRlbnNpb24gd2l0aCAnLScgYXMgZmlyc3QgY2hhcmFjdGVyIG9mIG9wdGlvbiBzdHJpbmcKIyAtIG9wdGlvbmFsIGFyZ3VtZW50cywgc3BlY2lmaWVkIGJ5IGRvdWJsZSBjb2xvbnMKIyAtIGEgb3B0aW9uIHN0cmluZyB3aXRoIGEgVyBmb2xsb3dlZCBieSBzZW1pY29sb24gc2hvdWxkCiMgICB0cmVhdCAiLVcgZm9vIiBhcyAiLS1mb28iCgpfX2FsbF9fID0gWyJHZXRvcHRFcnJvciIsImVycm9yIiwiZ2V0b3B0IiwiZ251X2dldG9wdCJdCgppbXBvcnQgb3MKCmNsYXNzIEdldG9wdEVycm9yKEV4Y2VwdGlvbik6CiAgICBvcHQgPSAnJwogICAgbXNnID0gJycKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBtc2csIG9wdD0nJyk6CiAgICAgICAgc2VsZi5tc2cgPSBtc2cKICAgICAgICBzZWxmLm9wdCA9IG9wdAogICAgICAgIEV4Y2VwdGlvbi5fX2luaXRfXyhzZWxmLCBtc2csIG9wdCkKCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5tc2cKCmVycm9yID0gR2V0b3B0RXJyb3IgIyBiYWNrd2FyZCBjb21wYXRpYmlsaXR5CgpkZWYgZ2V0b3B0KGFyZ3MsIHNob3J0b3B0cywgbG9uZ29wdHMgPSBbXSk6CiAgICAiIiJnZXRvcHQoYXJncywgb3B0aW9uc1ssIGxvbmdfb3B0aW9uc10pIC0+IG9wdHMsIGFyZ3MKCiAgICBQYXJzZXMgY29tbWFuZCBsaW5lIG9wdGlvbnMgYW5kIHBhcmFtZXRlciBsaXN0LiAgYXJncyBpcyB0aGUKICAgIGFyZ3VtZW50IGxpc3QgdG8gYmUgcGFyc2VkLCB3aXRob3V0IHRoZSBsZWFkaW5nIHJlZmVyZW5jZSB0byB0aGUKICAgIHJ1bm5pbmcgcHJvZ3JhbS4gIFR5cGljYWxseSwgdGhpcyBtZWFucyAic3lzLmFyZ3ZbMTpdIi4gIHNob3J0b3B0cwogICAgaXMgdGhlIHN0cmluZyBvZiBvcHRpb24gbGV0dGVycyB0aGF0IHRoZSBzY3JpcHQgd2FudHMgdG8KICAgIHJlY29nbml6ZSwgd2l0aCBvcHRpb25zIHRoYXQgcmVxdWlyZSBhbiBhcmd1bWVudCBmb2xsb3dlZCBieSBhCiAgICBjb2xvbiAoaS5lLiwgdGhlIHNhbWUgZm9ybWF0IHRoYXQgVW5peCBnZXRvcHQoKSB1c2VzKS4gIElmCiAgICBzcGVjaWZpZWQsIGxvbmdvcHRzIGlzIGEgbGlzdCBvZiBzdHJpbmdzIHdpdGggdGhlIG5hbWVzIG9mIHRoZQogICAgbG9uZyBvcHRpb25zIHdoaWNoIHNob3VsZCBiZSBzdXBwb3J0ZWQuICBUaGUgbGVhZGluZyAnLS0nCiAgICBjaGFyYWN0ZXJzIHNob3VsZCBub3QgYmUgaW5jbHVkZWQgaW4gdGhlIG9wdGlvbiBuYW1lLiAgT3B0aW9ucwogICAgd2hpY2ggcmVxdWlyZSBhbiBhcmd1bWVudCBzaG91bGQgYmUgZm9sbG93ZWQgYnkgYW4gZXF1YWwgc2lnbgogICAgKCc9JykuCgogICAgVGhlIHJldHVybiB2YWx1ZSBjb25zaXN0cyBvZiB0d28gZWxlbWVudHM6IHRoZSBmaXJzdCBpcyBhIGxpc3Qgb2YKICAgIChvcHRpb24sIHZhbHVlKSBwYWlyczsgdGhlIHNlY29uZCBpcyB0aGUgbGlzdCBvZiBwcm9ncmFtIGFyZ3VtZW50cwogICAgbGVmdCBhZnRlciB0aGUgb3B0aW9uIGxpc3Qgd2FzIHN0cmlwcGVkICh0aGlzIGlzIGEgdHJhaWxpbmcgc2xpY2UKICAgIG9mIHRoZSBmaXJzdCBhcmd1bWVudCkuICBFYWNoIG9wdGlvbi1hbmQtdmFsdWUgcGFpciByZXR1cm5lZCBoYXMKICAgIHRoZSBvcHRpb24gYXMgaXRzIGZpcnN0IGVsZW1lbnQsIHByZWZpeGVkIHdpdGggYSBoeXBoZW4gKGUuZy4sCiAgICAnLXgnKSwgYW5kIHRoZSBvcHRpb24gYXJndW1lbnQgYXMgaXRzIHNlY29uZCBlbGVtZW50LCBvciBhbiBlbXB0eQogICAgc3RyaW5nIGlmIHRoZSBvcHRpb24gaGFzIG5vIGFyZ3VtZW50LiAgVGhlIG9wdGlvbnMgb2NjdXIgaW4gdGhlCiAgICBsaXN0IGluIHRoZSBzYW1lIG9yZGVyIGluIHdoaWNoIHRoZXkgd2VyZSBmb3VuZCwgdGh1cyBhbGxvd2luZwogICAgbXVsdGlwbGUgb2NjdXJyZW5jZXMuICBMb25nIGFuZCBzaG9ydCBvcHRpb25zIG1heSBiZSBtaXhlZC4KCiAgICAiIiIKCiAgICBvcHRzID0gW10KICAgIGlmIHR5cGUobG9uZ29wdHMpID09IHR5cGUoIiIpOgogICAgICAgIGxvbmdvcHRzID0gW2xvbmdvcHRzXQogICAgZWxzZToKICAgICAgICBsb25nb3B0cyA9IGxpc3QobG9uZ29wdHMpCiAgICB3aGlsZSBhcmdzIGFuZCBhcmdzWzBdLnN0YXJ0c3dpdGgoJy0nKSBhbmQgYXJnc1swXSAhPSAnLSc6CiAgICAgICAgaWYgYXJnc1swXSA9PSAnLS0nOgogICAgICAgICAgICBhcmdzID0gYXJnc1sxOl0KICAgICAgICAgICAgYnJlYWsKICAgICAgICBpZiBhcmdzWzBdLnN0YXJ0c3dpdGgoJy0tJyk6CiAgICAgICAgICAgIG9wdHMsIGFyZ3MgPSBkb19sb25ncyhvcHRzLCBhcmdzWzBdWzI6XSwgbG9uZ29wdHMsIGFyZ3NbMTpdKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG9wdHMsIGFyZ3MgPSBkb19zaG9ydHMob3B0cywgYXJnc1swXVsxOl0sIHNob3J0b3B0cywgYXJnc1sxOl0pCgogICAgcmV0dXJuIG9wdHMsIGFyZ3MKCmRlZiBnbnVfZ2V0b3B0KGFyZ3MsIHNob3J0b3B0cywgbG9uZ29wdHMgPSBbXSk6CiAgICAiIiJnZXRvcHQoYXJncywgb3B0aW9uc1ssIGxvbmdfb3B0aW9uc10pIC0+IG9wdHMsIGFyZ3MKCiAgICBUaGlzIGZ1bmN0aW9uIHdvcmtzIGxpa2UgZ2V0b3B0KCksIGV4Y2VwdCB0aGF0IEdOVSBzdHlsZSBzY2FubmluZwogICAgbW9kZSBpcyB1c2VkIGJ5IGRlZmF1bHQuIFRoaXMgbWVhbnMgdGhhdCBvcHRpb24gYW5kIG5vbi1vcHRpb24KICAgIGFyZ3VtZW50cyBtYXkgYmUgaW50ZXJtaXhlZC4gVGhlIGdldG9wdCgpIGZ1bmN0aW9uIHN0b3BzCiAgICBwcm9jZXNzaW5nIG9wdGlvbnMgYXMgc29vbiBhcyBhIG5vbi1vcHRpb24gYXJndW1lbnQgaXMKICAgIGVuY291bnRlcmVkLgoKICAgIElmIHRoZSBmaXJzdCBjaGFyYWN0ZXIgb2YgdGhlIG9wdGlvbiBzdHJpbmcgaXMgYCsnLCBvciBpZiB0aGUKICAgIGVudmlyb25tZW50IHZhcmlhYmxlIFBPU0lYTFlfQ09SUkVDVCBpcyBzZXQsIHRoZW4gb3B0aW9uCiAgICBwcm9jZXNzaW5nIHN0b3BzIGFzIHNvb24gYXMgYSBub24tb3B0aW9uIGFyZ3VtZW50IGlzIGVuY291bnRlcmVkLgoKICAgICIiIgoKICAgIG9wdHMgPSBbXQogICAgcHJvZ19hcmdzID0gW10KICAgIGlmIGlzaW5zdGFuY2UobG9uZ29wdHMsIHN0cik6CiAgICAgICAgbG9uZ29wdHMgPSBbbG9uZ29wdHNdCiAgICBlbHNlOgogICAgICAgIGxvbmdvcHRzID0gbGlzdChsb25nb3B0cykKCiAgICAjIEFsbG93IG9wdGlvbnMgYWZ0ZXIgbm9uLW9wdGlvbiBhcmd1bWVudHM/CiAgICBpZiBzaG9ydG9wdHMuc3RhcnRzd2l0aCgnKycpOgogICAgICAgIHNob3J0b3B0cyA9IHNob3J0b3B0c1sxOl0KICAgICAgICBhbGxfb3B0aW9uc19maXJzdCA9IFRydWUKICAgIGVsaWYgb3MuZW52aXJvbi5nZXQoIlBPU0lYTFlfQ09SUkVDVCIpOgogICAgICAgIGFsbF9vcHRpb25zX2ZpcnN0ID0gVHJ1ZQogICAgZWxzZToKICAgICAgICBhbGxfb3B0aW9uc19maXJzdCA9IEZhbHNlCgogICAgd2hpbGUgYXJnczoKICAgICAgICBpZiBhcmdzWzBdID09ICctLSc6CiAgICAgICAgICAgIHByb2dfYXJncyArPSBhcmdzWzE6XQogICAgICAgICAgICBicmVhawoKICAgICAgICBpZiBhcmdzWzBdWzoyXSA9PSAnLS0nOgogICAgICAgICAgICBvcHRzLCBhcmdzID0gZG9fbG9uZ3Mob3B0cywgYXJnc1swXVsyOl0sIGxvbmdvcHRzLCBhcmdzWzE6XSkKICAgICAgICBlbGlmIGFyZ3NbMF1bOjFdID09ICctJyBhbmQgYXJnc1swXSAhPSAnLSc6CiAgICAgICAgICAgIG9wdHMsIGFyZ3MgPSBkb19zaG9ydHMob3B0cywgYXJnc1swXVsxOl0sIHNob3J0b3B0cywgYXJnc1sxOl0pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgYWxsX29wdGlvbnNfZmlyc3Q6CiAgICAgICAgICAgICAgICBwcm9nX2FyZ3MgKz0gYXJncwogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByb2dfYXJncy5hcHBlbmQoYXJnc1swXSkKICAgICAgICAgICAgICAgIGFyZ3MgPSBhcmdzWzE6XQoKICAgIHJldHVybiBvcHRzLCBwcm9nX2FyZ3MKCmRlZiBkb19sb25ncyhvcHRzLCBvcHQsIGxvbmdvcHRzLCBhcmdzKToKICAgIHRyeToKICAgICAgICBpID0gb3B0LmluZGV4KCc9JykKICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgIG9wdGFyZyA9IE5vbmUKICAgIGVsc2U6CiAgICAgICAgb3B0LCBvcHRhcmcgPSBvcHRbOmldLCBvcHRbaSsxOl0KCiAgICBoYXNfYXJnLCBvcHQgPSBsb25nX2hhc19hcmdzKG9wdCwgbG9uZ29wdHMpCiAgICBpZiBoYXNfYXJnOgogICAgICAgIGlmIG9wdGFyZyBpcyBOb25lOgogICAgICAgICAgICBpZiBub3QgYXJnczoKICAgICAgICAgICAgICAgIHJhaXNlIEdldG9wdEVycm9yKCdvcHRpb24gLS0lcyByZXF1aXJlcyBhcmd1bWVudCcgJSBvcHQsIG9wdCkKICAgICAgICAgICAgb3B0YXJnLCBhcmdzID0gYXJnc1swXSwgYXJnc1sxOl0KICAgIGVsaWYgb3B0YXJnIGlzIG5vdCBOb25lOgogICAgICAgIHJhaXNlIEdldG9wdEVycm9yKCdvcHRpb24gLS0lcyBtdXN0IG5vdCBoYXZlIGFuIGFyZ3VtZW50JyAlIG9wdCwgb3B0KQogICAgb3B0cy5hcHBlbmQoKCctLScgKyBvcHQsIG9wdGFyZyBvciAnJykpCiAgICByZXR1cm4gb3B0cywgYXJncwoKIyBSZXR1cm46CiMgICBoYXNfYXJnPwojICAgZnVsbCBvcHRpb24gbmFtZQpkZWYgbG9uZ19oYXNfYXJncyhvcHQsIGxvbmdvcHRzKToKICAgIHBvc3NpYmlsaXRpZXMgPSBbbyBmb3IgbyBpbiBsb25nb3B0cyBpZiBvLnN0YXJ0c3dpdGgob3B0KV0KICAgIGlmIG5vdCBwb3NzaWJpbGl0aWVzOgogICAgICAgIHJhaXNlIEdldG9wdEVycm9yKCdvcHRpb24gLS0lcyBub3QgcmVjb2duaXplZCcgJSBvcHQsIG9wdCkKICAgICMgSXMgdGhlcmUgYW4gZXhhY3QgbWF0Y2g/CiAgICBpZiBvcHQgaW4gcG9zc2liaWxpdGllczoKICAgICAgICByZXR1cm4gRmFsc2UsIG9wdAogICAgZWxpZiBvcHQgKyAnPScgaW4gcG9zc2liaWxpdGllczoKICAgICAgICByZXR1cm4gVHJ1ZSwgb3B0CiAgICAjIE5vIGV4YWN0IG1hdGNoLCBzbyBiZXR0ZXIgYmUgdW5pcXVlLgogICAgaWYgbGVuKHBvc3NpYmlsaXRpZXMpID4gMToKICAgICAgICAjIFhYWCBzaW5jZSBwb3NzaWJpbGl0aWVzIGNvbnRhaW5zIGFsbCB2YWxpZCBjb250aW51YXRpb25zLCBtaWdodCBiZQogICAgICAgICMgbmljZSB0byB3b3JrIHRoZW0gaW50byB0aGUgZXJyb3IgbXNnCiAgICAgICAgcmFpc2UgR2V0b3B0RXJyb3IoJ29wdGlvbiAtLSVzIG5vdCBhIHVuaXF1ZSBwcmVmaXgnICUgb3B0LCBvcHQpCiAgICBhc3NlcnQgbGVuKHBvc3NpYmlsaXRpZXMpID09IDEKICAgIHVuaXF1ZV9tYXRjaCA9IHBvc3NpYmlsaXRpZXNbMF0KICAgIGhhc19hcmcgPSB1bmlxdWVfbWF0Y2guZW5kc3dpdGgoJz0nKQogICAgaWYgaGFzX2FyZzoKICAgICAgICB1bmlxdWVfbWF0Y2ggPSB1bmlxdWVfbWF0Y2hbOi0xXQogICAgcmV0dXJuIGhhc19hcmcsIHVuaXF1ZV9tYXRjaAoKZGVmIGRvX3Nob3J0cyhvcHRzLCBvcHRzdHJpbmcsIHNob3J0b3B0cywgYXJncyk6CiAgICB3aGlsZSBvcHRzdHJpbmcgIT0gJyc6CiAgICAgICAgb3B0LCBvcHRzdHJpbmcgPSBvcHRzdHJpbmdbMF0sIG9wdHN0cmluZ1sxOl0KICAgICAgICBpZiBzaG9ydF9oYXNfYXJnKG9wdCwgc2hvcnRvcHRzKToKICAgICAgICAgICAgaWYgb3B0c3RyaW5nID09ICcnOgogICAgICAgICAgICAgICAgaWYgbm90IGFyZ3M6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgR2V0b3B0RXJyb3IoJ29wdGlvbiAtJXMgcmVxdWlyZXMgYXJndW1lbnQnICUgb3B0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdCkKICAgICAgICAgICAgICAgIG9wdHN0cmluZywgYXJncyA9IGFyZ3NbMF0sIGFyZ3NbMTpdCiAgICAgICAgICAgIG9wdGFyZywgb3B0c3RyaW5nID0gb3B0c3RyaW5nLCAnJwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG9wdGFyZyA9ICcnCiAgICAgICAgb3B0cy5hcHBlbmQoKCctJyArIG9wdCwgb3B0YXJnKSkKICAgIHJldHVybiBvcHRzLCBhcmdzCgpkZWYgc2hvcnRfaGFzX2FyZyhvcHQsIHNob3J0b3B0cyk6CiAgICBmb3IgaSBpbiByYW5nZShsZW4oc2hvcnRvcHRzKSk6CiAgICAgICAgaWYgb3B0ID09IHNob3J0b3B0c1tpXSAhPSAnOic6CiAgICAgICAgICAgIHJldHVybiBzaG9ydG9wdHMuc3RhcnRzd2l0aCgnOicsIGkrMSkKICAgIHJhaXNlIEdldG9wdEVycm9yKCdvcHRpb24gLSVzIG5vdCByZWNvZ25pemVkJyAlIG9wdCwgb3B0KQoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIGltcG9ydCBzeXMKICAgIHByaW50KGdldG9wdChzeXMuYXJndlsxOl0sICJhOmIiLCBbImFscGhhPSIsICJiZXRhIl0pKQo=',
'/Lib/heapq.py':'IiIiSGVhcCBxdWV1ZSBhbGdvcml0aG0gKGEuay5hLiBwcmlvcml0eSBxdWV1ZSkuCgpIZWFwcyBhcmUgYXJyYXlzIGZvciB3aGljaCBhW2tdIDw9IGFbMiprKzFdIGFuZCBhW2tdIDw9IGFbMiprKzJdIGZvcgphbGwgaywgY291bnRpbmcgZWxlbWVudHMgZnJvbSAwLiAgRm9yIHRoZSBzYWtlIG9mIGNvbXBhcmlzb24sCm5vbi1leGlzdGluZyBlbGVtZW50cyBhcmUgY29uc2lkZXJlZCB0byBiZSBpbmZpbml0ZS4gIFRoZSBpbnRlcmVzdGluZwpwcm9wZXJ0eSBvZiBhIGhlYXAgaXMgdGhhdCBhWzBdIGlzIGFsd2F5cyBpdHMgc21hbGxlc3QgZWxlbWVudC4KClVzYWdlOgoKaGVhcCA9IFtdICAgICAgICAgICAgIyBjcmVhdGVzIGFuIGVtcHR5IGhlYXAKaGVhcHB1c2goaGVhcCwgaXRlbSkgIyBwdXNoZXMgYSBuZXcgaXRlbSBvbiB0aGUgaGVhcAppdGVtID0gaGVhcHBvcChoZWFwKSAjIHBvcHMgdGhlIHNtYWxsZXN0IGl0ZW0gZnJvbSB0aGUgaGVhcAppdGVtID0gaGVhcFswXSAgICAgICAjIHNtYWxsZXN0IGl0ZW0gb24gdGhlIGhlYXAgd2l0aG91dCBwb3BwaW5nIGl0CmhlYXBpZnkoeCkgICAgICAgICAgICMgdHJhbnNmb3JtcyBsaXN0IGludG8gYSBoZWFwLCBpbi1wbGFjZSwgaW4gbGluZWFyIHRpbWUKaXRlbSA9IGhlYXByZXBsYWNlKGhlYXAsIGl0ZW0pICMgcG9wcyBhbmQgcmV0dXJucyBzbWFsbGVzdCBpdGVtLCBhbmQgYWRkcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBuZXcgaXRlbTsgdGhlIGhlYXAgc2l6ZSBpcyB1bmNoYW5nZWQKCk91ciBBUEkgZGlmZmVycyBmcm9tIHRleHRib29rIGhlYXAgYWxnb3JpdGhtcyBhcyBmb2xsb3dzOgoKLSBXZSB1c2UgMC1iYXNlZCBpbmRleGluZy4gIFRoaXMgbWFrZXMgdGhlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIHRoZQogIGluZGV4IGZvciBhIG5vZGUgYW5kIHRoZSBpbmRleGVzIGZvciBpdHMgY2hpbGRyZW4gc2xpZ2h0bHkgbGVzcwogIG9idmlvdXMsIGJ1dCBpcyBtb3JlIHN1aXRhYmxlIHNpbmNlIFB5dGhvbiB1c2VzIDAtYmFzZWQgaW5kZXhpbmcuCgotIE91ciBoZWFwcG9wKCkgbWV0aG9kIHJldHVybnMgdGhlIHNtYWxsZXN0IGl0ZW0sIG5vdCB0aGUgbGFyZ2VzdC4KClRoZXNlIHR3byBtYWtlIGl0IHBvc3NpYmxlIHRvIHZpZXcgdGhlIGhlYXAgYXMgYSByZWd1bGFyIFB5dGhvbiBsaXN0CndpdGhvdXQgc3VycHJpc2VzOiBoZWFwWzBdIGlzIHRoZSBzbWFsbGVzdCBpdGVtLCBhbmQgaGVhcC5zb3J0KCkKbWFpbnRhaW5zIHRoZSBoZWFwIGludmFyaWFudCEKIiIiCgojIE9yaWdpbmFsIGNvZGUgYnkgS2V2aW4gTydDb25ub3IsIGF1Z21lbnRlZCBieSBUaW0gUGV0ZXJzIGFuZCBSYXltb25kIEhldHRpbmdlcgoKX19hYm91dF9fID0gIiIiSGVhcCBxdWV1ZXMKCltleHBsYW5hdGlvbiBieSBGcmFuw6dvaXMgUGluYXJkXQoKSGVhcHMgYXJlIGFycmF5cyBmb3Igd2hpY2ggYVtrXSA8PSBhWzIqaysxXSBhbmQgYVtrXSA8PSBhWzIqaysyXSBmb3IKYWxsIGssIGNvdW50aW5nIGVsZW1lbnRzIGZyb20gMC4gIEZvciB0aGUgc2FrZSBvZiBjb21wYXJpc29uLApub24tZXhpc3RpbmcgZWxlbWVudHMgYXJlIGNvbnNpZGVyZWQgdG8gYmUgaW5maW5pdGUuICBUaGUgaW50ZXJlc3RpbmcKcHJvcGVydHkgb2YgYSBoZWFwIGlzIHRoYXQgYVswXSBpcyBhbHdheXMgaXRzIHNtYWxsZXN0IGVsZW1lbnQuCgpUaGUgc3RyYW5nZSBpbnZhcmlhbnQgYWJvdmUgaXMgbWVhbnQgdG8gYmUgYW4gZWZmaWNpZW50IG1lbW9yeQpyZXByZXNlbnRhdGlvbiBmb3IgYSB0b3VybmFtZW50LiAgVGhlIG51bWJlcnMgYmVsb3cgYXJlIGBrJywgbm90IGFba106CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAKCiAgICAgICAgICAgICAgICAgIDEgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAyCgogICAgICAgICAgMyAgICAgICAgICAgICAgIDQgICAgICAgICAgICAgICAgNSAgICAgICAgICAgICAgIDYKCiAgICAgIDcgICAgICAgOCAgICAgICA5ICAgICAgIDEwICAgICAgMTEgICAgICAxMiAgICAgIDEzICAgICAgMTQKCiAgICAxNSAxNiAgIDE3IDE4ICAgMTkgMjAgICAyMSAyMiAgIDIzIDI0ICAgMjUgMjYgICAyNyAyOCAgIDI5IDMwCgoKSW4gdGhlIHRyZWUgYWJvdmUsIGVhY2ggY2VsbCBgaycgaXMgdG9wcGluZyBgMiprKzEnIGFuZCBgMiprKzInLiAgSW4KYW4gdXN1YWwgYmluYXJ5IHRvdXJuYW1lbnQgd2Ugc2VlIGluIHNwb3J0cywgZWFjaCBjZWxsIGlzIHRoZSB3aW5uZXIKb3ZlciB0aGUgdHdvIGNlbGxzIGl0IHRvcHMsIGFuZCB3ZSBjYW4gdHJhY2UgdGhlIHdpbm5lciBkb3duIHRoZSB0cmVlCnRvIHNlZSBhbGwgb3Bwb25lbnRzIHMvaGUgaGFkLiAgSG93ZXZlciwgaW4gbWFueSBjb21wdXRlciBhcHBsaWNhdGlvbnMKb2Ygc3VjaCB0b3VybmFtZW50cywgd2UgZG8gbm90IG5lZWQgdG8gdHJhY2UgdGhlIGhpc3Rvcnkgb2YgYSB3aW5uZXIuClRvIGJlIG1vcmUgbWVtb3J5IGVmZmljaWVudCwgd2hlbiBhIHdpbm5lciBpcyBwcm9tb3RlZCwgd2UgdHJ5IHRvCnJlcGxhY2UgaXQgYnkgc29tZXRoaW5nIGVsc2UgYXQgYSBsb3dlciBsZXZlbCwgYW5kIHRoZSBydWxlIGJlY29tZXMKdGhhdCBhIGNlbGwgYW5kIHRoZSB0d28gY2VsbHMgaXQgdG9wcyBjb250YWluIHRocmVlIGRpZmZlcmVudCBpdGVtcywKYnV0IHRoZSB0b3AgY2VsbCAid2lucyIgb3ZlciB0aGUgdHdvIHRvcHBlZCBjZWxscy4KCklmIHRoaXMgaGVhcCBpbnZhcmlhbnQgaXMgcHJvdGVjdGVkIGF0IGFsbCB0aW1lLCBpbmRleCAwIGlzIGNsZWFybHkKdGhlIG92ZXJhbGwgd2lubmVyLiAgVGhlIHNpbXBsZXN0IGFsZ29yaXRobWljIHdheSB0byByZW1vdmUgaXQgYW5kCmZpbmQgdGhlICJuZXh0IiB3aW5uZXIgaXMgdG8gbW92ZSBzb21lIGxvc2VyIChsZXQncyBzYXkgY2VsbCAzMCBpbiB0aGUKZGlhZ3JhbSBhYm92ZSkgaW50byB0aGUgMCBwb3NpdGlvbiwgYW5kIHRoZW4gcGVyY29sYXRlIHRoaXMgbmV3IDAgZG93bgp0aGUgdHJlZSwgZXhjaGFuZ2luZyB2YWx1ZXMsIHVudGlsIHRoZSBpbnZhcmlhbnQgaXMgcmUtZXN0YWJsaXNoZWQuClRoaXMgaXMgY2xlYXJseSBsb2dhcml0aG1pYyBvbiB0aGUgdG90YWwgbnVtYmVyIG9mIGl0ZW1zIGluIHRoZSB0cmVlLgpCeSBpdGVyYXRpbmcgb3ZlciBhbGwgaXRlbXMsIHlvdSBnZXQgYW4gTyhuIGxuIG4pIHNvcnQuCgpBIG5pY2UgZmVhdHVyZSBvZiB0aGlzIHNvcnQgaXMgdGhhdCB5b3UgY2FuIGVmZmljaWVudGx5IGluc2VydCBuZXcKaXRlbXMgd2hpbGUgdGhlIHNvcnQgaXMgZ29pbmcgb24sIHByb3ZpZGVkIHRoYXQgdGhlIGluc2VydGVkIGl0ZW1zIGFyZQpub3QgImJldHRlciIgdGhhbiB0aGUgbGFzdCAwJ3RoIGVsZW1lbnQgeW91IGV4dHJhY3RlZC4gIFRoaXMgaXMKZXNwZWNpYWxseSB1c2VmdWwgaW4gc2ltdWxhdGlvbiBjb250ZXh0cywgd2hlcmUgdGhlIHRyZWUgaG9sZHMgYWxsCmluY29taW5nIGV2ZW50cywgYW5kIHRoZSAid2luIiBjb25kaXRpb24gbWVhbnMgdGhlIHNtYWxsZXN0IHNjaGVkdWxlZAp0aW1lLiAgV2hlbiBhbiBldmVudCBzY2hlZHVsZSBvdGhlciBldmVudHMgZm9yIGV4ZWN1dGlvbiwgdGhleSBhcmUKc2NoZWR1bGVkIGludG8gdGhlIGZ1dHVyZSwgc28gdGhleSBjYW4gZWFzaWx5IGdvIGludG8gdGhlIGhlYXAuICBTbywgYQpoZWFwIGlzIGEgZ29vZCBzdHJ1Y3R1cmUgZm9yIGltcGxlbWVudGluZyBzY2hlZHVsZXJzICh0aGlzIGlzIHdoYXQgSQp1c2VkIGZvciBteSBNSURJIHNlcXVlbmNlciA6LSkuCgpWYXJpb3VzIHN0cnVjdHVyZXMgZm9yIGltcGxlbWVudGluZyBzY2hlZHVsZXJzIGhhdmUgYmVlbiBleHRlbnNpdmVseQpzdHVkaWVkLCBhbmQgaGVhcHMgYXJlIGdvb2QgZm9yIHRoaXMsIGFzIHRoZXkgYXJlIHJlYXNvbmFibHkgc3BlZWR5LAp0aGUgc3BlZWQgaXMgYWxtb3N0IGNvbnN0YW50LCBhbmQgdGhlIHdvcnN0IGNhc2UgaXMgbm90IG11Y2ggZGlmZmVyZW50CnRoYW4gdGhlIGF2ZXJhZ2UgY2FzZS4gIEhvd2V2ZXIsIHRoZXJlIGFyZSBvdGhlciByZXByZXNlbnRhdGlvbnMgd2hpY2gKYXJlIG1vcmUgZWZmaWNpZW50IG92ZXJhbGwsIHlldCB0aGUgd29yc3QgY2FzZXMgbWlnaHQgYmUgdGVycmlibGUuCgpIZWFwcyBhcmUgYWxzbyB2ZXJ5IHVzZWZ1bCBpbiBiaWcgZGlzayBzb3J0cy4gIFlvdSBtb3N0IHByb2JhYmx5IGFsbAprbm93IHRoYXQgYSBiaWcgc29ydCBpbXBsaWVzIHByb2R1Y2luZyAicnVucyIgKHdoaWNoIGFyZSBwcmUtc29ydGVkCnNlcXVlbmNlcywgd2hpY2ggc2l6ZSBpcyB1c3VhbGx5IHJlbGF0ZWQgdG8gdGhlIGFtb3VudCBvZiBDUFUgbWVtb3J5KSwKZm9sbG93ZWQgYnkgYSBtZXJnaW5nIHBhc3NlcyBmb3IgdGhlc2UgcnVucywgd2hpY2ggbWVyZ2luZyBpcyBvZnRlbgp2ZXJ5IGNsZXZlcmx5IG9yZ2FuaXNlZFsxXS4gIEl0IGlzIHZlcnkgaW1wb3J0YW50IHRoYXQgdGhlIGluaXRpYWwKc29ydCBwcm9kdWNlcyB0aGUgbG9uZ2VzdCBydW5zIHBvc3NpYmxlLiAgVG91cm5hbWVudHMgYXJlIGEgZ29vZCB3YXkKdG8gdGhhdC4gIElmLCB1c2luZyBhbGwgdGhlIG1lbW9yeSBhdmFpbGFibGUgdG8gaG9sZCBhIHRvdXJuYW1lbnQsIHlvdQpyZXBsYWNlIGFuZCBwZXJjb2xhdGUgaXRlbXMgdGhhdCBoYXBwZW4gdG8gZml0IHRoZSBjdXJyZW50IHJ1biwgeW91J2xsCnByb2R1Y2UgcnVucyB3aGljaCBhcmUgdHdpY2UgdGhlIHNpemUgb2YgdGhlIG1lbW9yeSBmb3IgcmFuZG9tIGlucHV0LAphbmQgbXVjaCBiZXR0ZXIgZm9yIGlucHV0IGZ1enppbHkgb3JkZXJlZC4KCk1vcmVvdmVyLCBpZiB5b3Ugb3V0cHV0IHRoZSAwJ3RoIGl0ZW0gb24gZGlzayBhbmQgZ2V0IGFuIGlucHV0IHdoaWNoCm1heSBub3QgZml0IGluIHRoZSBjdXJyZW50IHRvdXJuYW1lbnQgKGJlY2F1c2UgdGhlIHZhbHVlICJ3aW5zIiBvdmVyCnRoZSBsYXN0IG91dHB1dCB2YWx1ZSksIGl0IGNhbm5vdCBmaXQgaW4gdGhlIGhlYXAsIHNvIHRoZSBzaXplIG9mIHRoZQpoZWFwIGRlY3JlYXNlcy4gIFRoZSBmcmVlZCBtZW1vcnkgY291bGQgYmUgY2xldmVybHkgcmV1c2VkIGltbWVkaWF0ZWx5CmZvciBwcm9ncmVzc2l2ZWx5IGJ1aWxkaW5nIGEgc2Vjb25kIGhlYXAsIHdoaWNoIGdyb3dzIGF0IGV4YWN0bHkgdGhlCnNhbWUgcmF0ZSB0aGUgZmlyc3QgaGVhcCBpcyBtZWx0aW5nLiAgV2hlbiB0aGUgZmlyc3QgaGVhcCBjb21wbGV0ZWx5CnZhbmlzaGVzLCB5b3Ugc3dpdGNoIGhlYXBzIGFuZCBzdGFydCBhIG5ldyBydW4uICBDbGV2ZXIgYW5kIHF1aXRlCmVmZmVjdGl2ZSEKCkluIGEgd29yZCwgaGVhcHMgYXJlIHVzZWZ1bCBtZW1vcnkgc3RydWN0dXJlcyB0byBrbm93LiAgSSB1c2UgdGhlbSBpbgphIGZldyBhcHBsaWNhdGlvbnMsIGFuZCBJIHRoaW5rIGl0IGlzIGdvb2QgdG8ga2VlcCBhIGBoZWFwJyBtb2R1bGUKYXJvdW5kLiA6LSkKCi0tLS0tLS0tLS0tLS0tLS0tLS0tClsxXSBUaGUgZGlzayBiYWxhbmNpbmcgYWxnb3JpdGhtcyB3aGljaCBhcmUgY3VycmVudCwgbm93YWRheXMsIGFyZQptb3JlIGFubm95aW5nIHRoYW4gY2xldmVyLCBhbmQgdGhpcyBpcyBhIGNvbnNlcXVlbmNlIG9mIHRoZSBzZWVraW5nCmNhcGFiaWxpdGllcyBvZiB0aGUgZGlza3MuICBPbiBkZXZpY2VzIHdoaWNoIGNhbm5vdCBzZWVrLCBsaWtlIGJpZwp0YXBlIGRyaXZlcywgdGhlIHN0b3J5IHdhcyBxdWl0ZSBkaWZmZXJlbnQsIGFuZCBvbmUgaGFkIHRvIGJlIHZlcnkKY2xldmVyIHRvIGVuc3VyZSAoZmFyIGluIGFkdmFuY2UpIHRoYXQgZWFjaCB0YXBlIG1vdmVtZW50IHdpbGwgYmUgdGhlCm1vc3QgZWZmZWN0aXZlIHBvc3NpYmxlICh0aGF0IGlzLCB3aWxsIGJlc3QgcGFydGljaXBhdGUgYXQKInByb2dyZXNzaW5nIiB0aGUgbWVyZ2UpLiAgU29tZSB0YXBlcyB3ZXJlIGV2ZW4gYWJsZSB0byByZWFkCmJhY2t3YXJkcywgYW5kIHRoaXMgd2FzIGFsc28gdXNlZCB0byBhdm9pZCB0aGUgcmV3aW5kaW5nIHRpbWUuCkJlbGlldmUgbWUsIHJlYWwgZ29vZCB0YXBlIHNvcnRzIHdlcmUgcXVpdGUgc3BlY3RhY3VsYXIgdG8gd2F0Y2ghCkZyb20gYWxsIHRpbWVzLCBzb3J0aW5nIGhhcyBhbHdheXMgYmVlbiBhIEdyZWF0IEFydCEgOi0pCiIiIgoKX19hbGxfXyA9IFsnaGVhcHB1c2gnLCAnaGVhcHBvcCcsICdoZWFwaWZ5JywgJ2hlYXByZXBsYWNlJywgJ21lcmdlJywKICAgICAgICAgICAnbmxhcmdlc3QnLCAnbnNtYWxsZXN0JywgJ2hlYXBwdXNocG9wJ10KCmZyb20gaXRlcnRvb2xzIGltcG9ydCBpc2xpY2UsIHJlcGVhdCwgY291bnQsIHRlZSwgY2hhaW4KaW1wb3J0IGJpc2VjdAoKZGVmIGhlYXBwdXNoKGhlYXAsIGl0ZW0pOgogICAgIiIiUHVzaCBpdGVtIG9udG8gaGVhcCwgbWFpbnRhaW5pbmcgdGhlIGhlYXAgaW52YXJpYW50LiIiIgogICAgaGVhcC5hcHBlbmQoaXRlbSkKICAgIF9zaWZ0ZG93bihoZWFwLCAwLCBsZW4oaGVhcCktMSkKCmRlZiBoZWFwcG9wKGhlYXApOgogICAgIiIiUG9wIHRoZSBzbWFsbGVzdCBpdGVtIG9mZiB0aGUgaGVhcCwgbWFpbnRhaW5pbmcgdGhlIGhlYXAgaW52YXJpYW50LiIiIgogICAgbGFzdGVsdCA9IGhlYXAucG9wKCkgICAgIyByYWlzZXMgYXBwcm9wcmlhdGUgSW5kZXhFcnJvciBpZiBoZWFwIGlzIGVtcHR5CiAgICBpZiBoZWFwOgogICAgICAgIHJldHVybml0ZW0gPSBoZWFwWzBdCiAgICAgICAgaGVhcFswXSA9IGxhc3RlbHQKICAgICAgICBfc2lmdHVwKGhlYXAsIDApCiAgICBlbHNlOgogICAgICAgIHJldHVybml0ZW0gPSBsYXN0ZWx0CiAgICByZXR1cm4gcmV0dXJuaXRlbQoKZGVmIGhlYXByZXBsYWNlKGhlYXAsIGl0ZW0pOgogICAgIiIiUG9wIGFuZCByZXR1cm4gdGhlIGN1cnJlbnQgc21hbGxlc3QgdmFsdWUsIGFuZCBhZGQgdGhlIG5ldyBpdGVtLgoKICAgIFRoaXMgaXMgbW9yZSBlZmZpY2llbnQgdGhhbiBoZWFwcG9wKCkgZm9sbG93ZWQgYnkgaGVhcHB1c2goKSwgYW5kIGNhbiBiZQogICAgbW9yZSBhcHByb3ByaWF0ZSB3aGVuIHVzaW5nIGEgZml4ZWQtc2l6ZSBoZWFwLiAgTm90ZSB0aGF0IHRoZSB2YWx1ZQogICAgcmV0dXJuZWQgbWF5IGJlIGxhcmdlciB0aGFuIGl0ZW0hICBUaGF0IGNvbnN0cmFpbnMgcmVhc29uYWJsZSB1c2VzIG9mCiAgICB0aGlzIHJvdXRpbmUgdW5sZXNzIHdyaXR0ZW4gYXMgcGFydCBvZiBhIGNvbmRpdGlvbmFsIHJlcGxhY2VtZW50OgoKICAgICAgICBpZiBpdGVtID4gaGVhcFswXToKICAgICAgICAgICAgaXRlbSA9IGhlYXByZXBsYWNlKGhlYXAsIGl0ZW0pCiAgICAiIiIKICAgIHJldHVybml0ZW0gPSBoZWFwWzBdICAgICMgcmFpc2VzIGFwcHJvcHJpYXRlIEluZGV4RXJyb3IgaWYgaGVhcCBpcyBlbXB0eQogICAgaGVhcFswXSA9IGl0ZW0KICAgIF9zaWZ0dXAoaGVhcCwgMCkKICAgIHJldHVybiByZXR1cm5pdGVtCgpkZWYgaGVhcHB1c2hwb3AoaGVhcCwgaXRlbSk6CiAgICAiIiJGYXN0IHZlcnNpb24gb2YgYSBoZWFwcHVzaCBmb2xsb3dlZCBieSBhIGhlYXBwb3AuIiIiCiAgICBpZiBoZWFwIGFuZCBoZWFwWzBdIDwgaXRlbToKICAgICAgICBpdGVtLCBoZWFwWzBdID0gaGVhcFswXSwgaXRlbQogICAgICAgIF9zaWZ0dXAoaGVhcCwgMCkKICAgIHJldHVybiBpdGVtCgpkZWYgaGVhcGlmeSh4KToKICAgICIiIlRyYW5zZm9ybSBsaXN0IGludG8gYSBoZWFwLCBpbi1wbGFjZSwgaW4gTyhsZW4oeCkpIHRpbWUuIiIiCiAgICBuID0gbGVuKHgpCiAgICAjIFRyYW5zZm9ybSBib3R0b20tdXAuICBUaGUgbGFyZ2VzdCBpbmRleCB0aGVyZSdzIGFueSBwb2ludCB0byBsb29raW5nIGF0CiAgICAjIGlzIHRoZSBsYXJnZXN0IHdpdGggYSBjaGlsZCBpbmRleCBpbi1yYW5nZSwgc28gbXVzdCBoYXZlIDIqaSArIDEgPCBuLAogICAgIyBvciBpIDwgKG4tMSkvMi4gIElmIG4gaXMgZXZlbiA9IDIqaiwgdGhpcyBpcyAoMipqLTEpLzIgPSBqLTEvMiBzbwogICAgIyBqLTEgaXMgdGhlIGxhcmdlc3QsIHdoaWNoIGlzIG4vLzIgLSAxLiAgSWYgbiBpcyBvZGQgPSAyKmorMSwgdGhpcyBpcwogICAgIyAoMipqKzEtMSkvMiA9IGogc28gai0xIGlzIHRoZSBsYXJnZXN0LCBhbmQgdGhhdCdzIGFnYWluIG4vLzItMS4KICAgIGZvciBpIGluIHJldmVyc2VkKHJhbmdlKG4vLzIpKToKICAgICAgICBfc2lmdHVwKHgsIGkpCgpkZWYgbmxhcmdlc3QobiwgaXRlcmFibGUpOgogICAgIiIiRmluZCB0aGUgbiBsYXJnZXN0IGVsZW1lbnRzIGluIGEgZGF0YXNldC4KCiAgICBFcXVpdmFsZW50IHRvOiAgc29ydGVkKGl0ZXJhYmxlLCByZXZlcnNlPVRydWUpWzpuXQogICAgIiIiCiAgICBpZiBuIDwgMDoKICAgICAgICByZXR1cm4gW10KICAgIGl0ID0gaXRlcihpdGVyYWJsZSkKICAgIHJlc3VsdCA9IGxpc3QoaXNsaWNlKGl0LCBuKSkKICAgIGlmIG5vdCByZXN1bHQ6CiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgaGVhcGlmeShyZXN1bHQpCiAgICBfaGVhcHB1c2hwb3AgPSBoZWFwcHVzaHBvcAogICAgZm9yIGVsZW0gaW4gaXQ6CiAgICAgICAgX2hlYXBwdXNocG9wKHJlc3VsdCwgZWxlbSkKICAgIHJlc3VsdC5zb3J0KHJldmVyc2U9VHJ1ZSkKICAgIHJldHVybiByZXN1bHQKCmRlZiBuc21hbGxlc3QobiwgaXRlcmFibGUpOgogICAgIiIiRmluZCB0aGUgbiBzbWFsbGVzdCBlbGVtZW50cyBpbiBhIGRhdGFzZXQuCgogICAgRXF1aXZhbGVudCB0bzogIHNvcnRlZChpdGVyYWJsZSlbOm5dCiAgICAiIiIKICAgIGlmIG4gPCAwOgogICAgICAgIHJldHVybiBbXQogICAgaWYgaGFzYXR0cihpdGVyYWJsZSwgJ19fbGVuX18nKSBhbmQgbiAqIDEwIDw9IGxlbihpdGVyYWJsZSk6CiAgICAgICAgIyBGb3Igc21hbGxlciB2YWx1ZXMgb2YgbiwgdGhlIGJpc2VjdCBtZXRob2QgaXMgZmFzdGVyIHRoYW4gYSBtaW5oZWFwLgogICAgICAgICMgSXQgaXMgYWxzbyBtZW1vcnkgZWZmaWNpZW50LCBjb25zdW1pbmcgb25seSBuIGVsZW1lbnRzIG9mIHNwYWNlLgogICAgICAgIGl0ID0gaXRlcihpdGVyYWJsZSkKICAgICAgICByZXN1bHQgPSBzb3J0ZWQoaXNsaWNlKGl0LCAwLCBuKSkKICAgICAgICBpZiBub3QgcmVzdWx0OgogICAgICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgaW5zb3J0ID0gYmlzZWN0Lmluc29ydAogICAgICAgIHBvcCA9IHJlc3VsdC5wb3AKICAgICAgICBsb3MgPSByZXN1bHRbLTFdICAgICMgbG9zIC0tPiBMYXJnZXN0IG9mIHRoZSBuc21hbGxlc3QKICAgICAgICBmb3IgZWxlbSBpbiBpdDoKICAgICAgICAgICAgaWYgZWxlbSA8IGxvczoKICAgICAgICAgICAgICAgIGluc29ydChyZXN1bHQsIGVsZW0pCiAgICAgICAgICAgICAgICBwb3AoKQogICAgICAgICAgICAgICAgbG9zID0gcmVzdWx0Wy0xXQogICAgICAgIHJldHVybiByZXN1bHQKICAgICMgQW4gYWx0ZXJuYXRpdmUgYXBwcm9hY2ggbWFuaWZlc3RzIHRoZSB3aG9sZSBpdGVyYWJsZSBpbiBtZW1vcnkgYnV0CiAgICAjIHNhdmVzIGNvbXBhcmlzb25zIGJ5IGhlYXBpZnlpbmcgYWxsIGF0IG9uY2UuICBBbHNvLCBzYXZlcyB0aW1lCiAgICAjIG92ZXIgYmlzZWN0Lmluc29ydCgpIHdoaWNoIGhhcyBPKG4pIGRhdGEgbW92ZW1lbnQgdGltZSBmb3IgZXZlcnkKICAgICMgaW5zZXJ0aW9uLiAgRmluZGluZyB0aGUgbiBzbWFsbGVzdCBvZiBhbiBtIGxlbmd0aCBpdGVyYWJsZSByZXF1aXJlcwogICAgIyAgICBPKG0pICsgTyhuIGxvZyBtKSBjb21wYXJpc29ucy4KICAgIGggPSBsaXN0KGl0ZXJhYmxlKQogICAgaGVhcGlmeShoKQogICAgcmV0dXJuIGxpc3QobWFwKGhlYXBwb3AsIHJlcGVhdChoLCBtaW4obiwgbGVuKGgpKSkpKQoKIyAnaGVhcCcgaXMgYSBoZWFwIGF0IGFsbCBpbmRpY2VzID49IHN0YXJ0cG9zLCBleGNlcHQgcG9zc2libHkgZm9yIHBvcy4gIHBvcwojIGlzIHRoZSBpbmRleCBvZiBhIGxlYWYgd2l0aCBhIHBvc3NpYmx5IG91dC1vZi1vcmRlciB2YWx1ZS4gIFJlc3RvcmUgdGhlCiMgaGVhcCBpbnZhcmlhbnQuCmRlZiBfc2lmdGRvd24oaGVhcCwgc3RhcnRwb3MsIHBvcyk6CiAgICBuZXdpdGVtID0gaGVhcFtwb3NdCiAgICAjIEZvbGxvdyB0aGUgcGF0aCB0byB0aGUgcm9vdCwgbW92aW5nIHBhcmVudHMgZG93biB1bnRpbCBmaW5kaW5nIGEgcGxhY2UKICAgICMgbmV3aXRlbSBmaXRzLgogICAgd2hpbGUgcG9zID4gc3RhcnRwb3M6CiAgICAgICAgcGFyZW50cG9zID0gKHBvcyAtIDEpID4+IDEKICAgICAgICBwYXJlbnQgPSBoZWFwW3BhcmVudHBvc10KICAgICAgICBpZiBuZXdpdGVtIDwgcGFyZW50OgogICAgICAgICAgICBoZWFwW3Bvc10gPSBwYXJlbnQKICAgICAgICAgICAgcG9zID0gcGFyZW50cG9zCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgYnJlYWsKICAgIGhlYXBbcG9zXSA9IG5ld2l0ZW0KCiMgVGhlIGNoaWxkIGluZGljZXMgb2YgaGVhcCBpbmRleCBwb3MgYXJlIGFscmVhZHkgaGVhcHMsIGFuZCB3ZSB3YW50IHRvIG1ha2UKIyBhIGhlYXAgYXQgaW5kZXggcG9zIHRvby4gIFdlIGRvIHRoaXMgYnkgYnViYmxpbmcgdGhlIHNtYWxsZXIgY2hpbGQgb2YKIyBwb3MgdXAgKGFuZCBzbyBvbiB3aXRoIHRoYXQgY2hpbGQncyBjaGlsZHJlbiwgZXRjKSB1bnRpbCBoaXR0aW5nIGEgbGVhZiwKIyB0aGVuIHVzaW5nIF9zaWZ0ZG93biB0byBtb3ZlIHRoZSBvZGRiYWxsIG9yaWdpbmFsbHkgYXQgaW5kZXggcG9zIGludG8gcGxhY2UuCiMKIyBXZSAqY291bGQqIGJyZWFrIG91dCBvZiB0aGUgbG9vcCBhcyBzb29uIGFzIHdlIGZpbmQgYSBwb3Mgd2hlcmUgbmV3aXRlbSA8PQojIGJvdGggaXRzIGNoaWxkcmVuLCBidXQgdHVybnMgb3V0IHRoYXQncyBub3QgYSBnb29kIGlkZWEsIGFuZCBkZXNwaXRlIHRoYXQKIyBtYW55IGJvb2tzIHdyaXRlIHRoZSBhbGdvcml0aG0gdGhhdCB3YXkuICBEdXJpbmcgYSBoZWFwIHBvcCwgdGhlIGxhc3QgYXJyYXkKIyBlbGVtZW50IGlzIHNpZnRlZCBpbiwgYW5kIHRoYXQgdGVuZHMgdG8gYmUgbGFyZ2UsIHNvIHRoYXQgY29tcGFyaW5nIGl0CiMgYWdhaW5zdCB2YWx1ZXMgc3RhcnRpbmcgZnJvbSB0aGUgcm9vdCB1c3VhbGx5IGRvZXNuJ3QgcGF5ICg9IHVzdWFsbHkgZG9lc24ndAojIGdldCB1cyBvdXQgb2YgdGhlIGxvb3AgZWFybHkpLiAgU2VlIEtudXRoLCBWb2x1bWUgMywgd2hlcmUgdGhpcyBpcwojIGV4cGxhaW5lZCBhbmQgcXVhbnRpZmllZCBpbiBhbiBleGVyY2lzZS4KIwojIEN1dHRpbmcgdGhlICMgb2YgY29tcGFyaXNvbnMgaXMgaW1wb3J0YW50LCBzaW5jZSB0aGVzZSByb3V0aW5lcyBoYXZlIG5vCiMgd2F5IHRvIGV4dHJhY3QgInRoZSBwcmlvcml0eSIgZnJvbSBhbiBhcnJheSBlbGVtZW50LCBzbyB0aGF0IGludGVsbGlnZW5jZQojIGlzIGxpa2VseSB0byBiZSBoaWRpbmcgaW4gY3VzdG9tIGNvbXBhcmlzb24gbWV0aG9kcywgb3IgaW4gYXJyYXkgZWxlbWVudHMKIyBzdG9yaW5nIChwcmlvcml0eSwgcmVjb3JkKSB0dXBsZXMuICBDb21wYXJpc29ucyBhcmUgdGh1cyBwb3RlbnRpYWxseQojIGV4cGVuc2l2ZS4KIwojIE9uIHJhbmRvbSBhcnJheXMgb2YgbGVuZ3RoIDEwMDAsIG1ha2luZyB0aGlzIGNoYW5nZSBjdXQgdGhlIG51bWJlciBvZgojIGNvbXBhcmlzb25zIG1hZGUgYnkgaGVhcGlmeSgpIGEgbGl0dGxlLCBhbmQgdGhvc2UgbWFkZSBieSBleGhhdXN0aXZlCiMgaGVhcHBvcCgpIGEgbG90LCBpbiBhY2NvcmQgd2l0aCB0aGVvcnkuICBIZXJlIGFyZSB0eXBpY2FsIHJlc3VsdHMgZnJvbSAzCiMgcnVucyAoMyBqdXN0IHRvIGRlbW9uc3RyYXRlIGhvdyBzbWFsbCB0aGUgdmFyaWFuY2UgaXMpOgojCiMgQ29tcGFyZXMgbmVlZGVkIGJ5IGhlYXBpZnkgICAgIENvbXBhcmVzIG5lZWRlZCBieSAxMDAwIGhlYXBwb3BzCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgMTgzNyBjdXQgdG8gMTY2MyAgICAgICAgICAgICAgIDE0OTk2IGN1dCB0byA4NjgwCiMgMTg1NSBjdXQgdG8gMTY1OSAgICAgICAgICAgICAgIDE0OTY2IGN1dCB0byA4Njc4CiMgMTg0NyBjdXQgdG8gMTY2MCAgICAgICAgICAgICAgIDE1MDI0IGN1dCB0byA4NzAzCiMKIyBCdWlsZGluZyB0aGUgaGVhcCBieSB1c2luZyBoZWFwcHVzaCgpIDEwMDAgdGltZXMgaW5zdGVhZCByZXF1aXJlZAojIDIxOTgsIDIxNDgsIGFuZCAyMjE5IGNvbXBhcmVzOiAgaGVhcGlmeSgpIGlzIG1vcmUgZWZmaWNpZW50LCB3aGVuCiMgeW91IGNhbiB1c2UgaXQuCiMKIyBUaGUgdG90YWwgY29tcGFyZXMgbmVlZGVkIGJ5IGxpc3Quc29ydCgpIG9uIHRoZSBzYW1lIGxpc3RzIHdlcmUgODYyNywKIyA4NjI3LCBhbmQgODYzMiAodGhpcyBzaG91bGQgYmUgY29tcGFyZWQgdG8gdGhlIHN1bSBvZiBoZWFwaWZ5KCkgYW5kCiMgaGVhcHBvcCgpIGNvbXBhcmVzKTogIGxpc3Quc29ydCgpIGlzICh1bnN1cnByaXNpbmdseSEpIG1vcmUgZWZmaWNpZW50CiMgZm9yIHNvcnRpbmcuCgpkZWYgX3NpZnR1cChoZWFwLCBwb3MpOgogICAgZW5kcG9zID0gbGVuKGhlYXApCiAgICBzdGFydHBvcyA9IHBvcwogICAgbmV3aXRlbSA9IGhlYXBbcG9zXQogICAgIyBCdWJibGUgdXAgdGhlIHNtYWxsZXIgY2hpbGQgdW50aWwgaGl0dGluZyBhIGxlYWYuCiAgICBjaGlsZHBvcyA9IDIqcG9zICsgMSAgICAjIGxlZnRtb3N0IGNoaWxkIHBvc2l0aW9uCiAgICB3aGlsZSBjaGlsZHBvcyA8IGVuZHBvczoKICAgICAgICAjIFNldCBjaGlsZHBvcyB0byBpbmRleCBvZiBzbWFsbGVyIGNoaWxkLgogICAgICAgIHJpZ2h0cG9zID0gY2hpbGRwb3MgKyAxCiAgICAgICAgaWYgcmlnaHRwb3MgPCBlbmRwb3MgYW5kIG5vdCBoZWFwW2NoaWxkcG9zXSA8IGhlYXBbcmlnaHRwb3NdOgogICAgICAgICAgICBjaGlsZHBvcyA9IHJpZ2h0cG9zCiAgICAgICAgIyBNb3ZlIHRoZSBzbWFsbGVyIGNoaWxkIHVwLgogICAgICAgIGhlYXBbcG9zXSA9IGhlYXBbY2hpbGRwb3NdCiAgICAgICAgcG9zID0gY2hpbGRwb3MKICAgICAgICBjaGlsZHBvcyA9IDIqcG9zICsgMQogICAgIyBUaGUgbGVhZiBhdCBwb3MgaXMgZW1wdHkgbm93LiAgUHV0IG5ld2l0ZW0gdGhlcmUsIGFuZCBidWJibGUgaXQgdXAKICAgICMgdG8gaXRzIGZpbmFsIHJlc3RpbmcgcGxhY2UgKGJ5IHNpZnRpbmcgaXRzIHBhcmVudHMgZG93bikuCiAgICBoZWFwW3Bvc10gPSBuZXdpdGVtCiAgICBfc2lmdGRvd24oaGVhcCwgc3RhcnRwb3MsIHBvcykKCiMgbm90IGF2YWlsYWJsZSBpbiBicnl0aG9uCiMgSWYgYXZhaWxhYmxlLCB1c2UgQyBpbXBsZW1lbnRhdGlvbgojdHJ5OgojICAgIGZyb20gX2hlYXBxIGltcG9ydCAqCiNleGNlcHQgSW1wb3J0RXJyb3I6CiMgICAgcGFzcwoKZGVmIG1lcmdlKCppdGVyYWJsZXMpOgogICAgJycnTWVyZ2UgbXVsdGlwbGUgc29ydGVkIGlucHV0cyBpbnRvIGEgc2luZ2xlIHNvcnRlZCBvdXRwdXQuCgogICAgU2ltaWxhciB0byBzb3J0ZWQoaXRlcnRvb2xzLmNoYWluKCppdGVyYWJsZXMpKSBidXQgcmV0dXJucyBhIGdlbmVyYXRvciwKICAgIGRvZXMgbm90IHB1bGwgdGhlIGRhdGEgaW50byBtZW1vcnkgYWxsIGF0IG9uY2UsIGFuZCBhc3N1bWVzIHRoYXQgZWFjaCBvZgogICAgdGhlIGlucHV0IHN0cmVhbXMgaXMgYWxyZWFkeSBzb3J0ZWQgKHNtYWxsZXN0IHRvIGxhcmdlc3QpLgoKICAgID4+PiBsaXN0KG1lcmdlKFsxLDMsNSw3XSwgWzAsMiw0LDhdLCBbNSwxMCwxNSwyMF0sIFtdLCBbMjVdKSkKICAgIFswLCAxLCAyLCAzLCA0LCA1LCA1LCA3LCA4LCAxMCwgMTUsIDIwLCAyNV0KCiAgICAnJycKICAgIF9oZWFwcG9wLCBfaGVhcHJlcGxhY2UsIF9TdG9wSXRlcmF0aW9uID0gaGVhcHBvcCwgaGVhcHJlcGxhY2UsIFN0b3BJdGVyYXRpb24KCiAgICBoID0gW10KICAgIGhfYXBwZW5kID0gaC5hcHBlbmQKICAgIGZvciBpdG51bSwgaXQgaW4gZW51bWVyYXRlKG1hcChpdGVyLCBpdGVyYWJsZXMpKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIG5leHQgPSBpdC5fX25leHRfXwogICAgICAgICAgICBoX2FwcGVuZChbbmV4dCgpLCBpdG51bSwgbmV4dF0pCiAgICAgICAgZXhjZXB0IF9TdG9wSXRlcmF0aW9uOgogICAgICAgICAgICBwYXNzCiAgICBoZWFwaWZ5KGgpCgogICAgd2hpbGUgMToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdoaWxlIDE6CiAgICAgICAgICAgICAgICB2LCBpdG51bSwgbmV4dCA9IHMgPSBoWzBdICAgIyByYWlzZXMgSW5kZXhFcnJvciB3aGVuIGggaXMgZW1wdHkKICAgICAgICAgICAgICAgIHlpZWxkIHYKICAgICAgICAgICAgICAgIHNbMF0gPSBuZXh0KCkgICAgICAgICAgICAgICAjIHJhaXNlcyBTdG9wSXRlcmF0aW9uIHdoZW4gZXhoYXVzdGVkCiAgICAgICAgICAgICAgICBfaGVhcHJlcGxhY2UoaCwgcykgICAgICAgICAgIyByZXN0b3JlIGhlYXAgY29uZGl0aW9uCiAgICAgICAgZXhjZXB0IF9TdG9wSXRlcmF0aW9uOgogICAgICAgICAgICBfaGVhcHBvcChoKSAgICAgICAgICAgICAgICAgICAgICMgcmVtb3ZlIGVtcHR5IGl0ZXJhdG9yCiAgICAgICAgZXhjZXB0IEluZGV4RXJyb3I6CiAgICAgICAgICAgIHJldHVybgoKIyBFeHRlbmQgdGhlIGltcGxlbWVudGF0aW9ucyBvZiBuc21hbGxlc3QgYW5kIG5sYXJnZXN0IHRvIHVzZSBhIGtleT0gYXJndW1lbnQKX25zbWFsbGVzdCA9IG5zbWFsbGVzdApkZWYgbnNtYWxsZXN0KG4sIGl0ZXJhYmxlLCBrZXk9Tm9uZSk6CiAgICAiIiJGaW5kIHRoZSBuIHNtYWxsZXN0IGVsZW1lbnRzIGluIGEgZGF0YXNldC4KCiAgICBFcXVpdmFsZW50IHRvOiAgc29ydGVkKGl0ZXJhYmxlLCBrZXk9a2V5KVs6bl0KICAgICIiIgogICAgIyBTaG9ydC1jdXQgZm9yIG49PTEgaXMgdG8gdXNlIG1pbigpIHdoZW4gbGVuKGl0ZXJhYmxlKT4wCiAgICBpZiBuID09IDE6CiAgICAgICAgaXQgPSBpdGVyKGl0ZXJhYmxlKQogICAgICAgIGhlYWQgPSBsaXN0KGlzbGljZShpdCwgMSkpCiAgICAgICAgaWYgbm90IGhlYWQ6CiAgICAgICAgICAgIHJldHVybiBbXQogICAgICAgIGlmIGtleSBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gW21pbihjaGFpbihoZWFkLCBpdCkpXQogICAgICAgIHJldHVybiBbbWluKGNoYWluKGhlYWQsIGl0KSwga2V5PWtleSldCgogICAgIyBXaGVuIG4+PXNpemUsIGl0J3MgZmFzdGVyIHRvIHVzZSBzb3J0ZWQoKQogICAgdHJ5OgogICAgICAgIHNpemUgPSBsZW4oaXRlcmFibGUpCiAgICBleGNlcHQgKFR5cGVFcnJvciwgQXR0cmlidXRlRXJyb3IpOgogICAgICAgIHBhc3MKICAgIGVsc2U6CiAgICAgICAgaWYgbiA+PSBzaXplOgogICAgICAgICAgICByZXR1cm4gc29ydGVkKGl0ZXJhYmxlLCBrZXk9a2V5KVs6bl0KCiAgICAjIFdoZW4ga2V5IGlzIG5vbmUsIHVzZSBzaW1wbGVyIGRlY29yYXRpb24KICAgIGlmIGtleSBpcyBOb25lOgogICAgICAgIGl0ID0gemlwKGl0ZXJhYmxlLCBjb3VudCgpKSAgICAgICAgICAgICAgICAgICAgICAgICAjIGRlY29yYXRlCiAgICAgICAgcmVzdWx0ID0gX25zbWFsbGVzdChuLCBpdCkKICAgICAgICByZXR1cm4gW3JbMF0gZm9yIHIgaW4gcmVzdWx0XSAgICAgICAgICAgICAgICAgICAgICAgIyB1bmRlY29yYXRlCgogICAgIyBHZW5lcmFsIGNhc2UsIHNsb3dlc3QgbWV0aG9kCiAgICBpbjEsIGluMiA9IHRlZShpdGVyYWJsZSkKICAgIGl0ID0gemlwKG1hcChrZXksIGluMSksIGNvdW50KCksIGluMikgICAgICAgICAgICAgICAgICAgIyBkZWNvcmF0ZQogICAgcmVzdWx0ID0gX25zbWFsbGVzdChuLCBpdCkKICAgIHJldHVybiBbclsyXSBmb3IgciBpbiByZXN1bHRdICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB1bmRlY29yYXRlCgoKX25sYXJnZXN0ID0gbmxhcmdlc3QKZGVmIG5sYXJnZXN0KG4sIGl0ZXJhYmxlLCBrZXk9Tm9uZSk6CiAgICAiIiJGaW5kIHRoZSBuIGxhcmdlc3QgZWxlbWVudHMgaW4gYSBkYXRhc2V0LgogICAgCiAgICAgRXF1aXZhbGVudCB0bzogIHNvcnRlZChpdGVyYWJsZSwga2V5PWtleSwgcmV2ZXJzZT1UcnVlKVs6bl0KCiAgICAgU2hvcnQtY3V0IGZvciBuPT0xIGlzIHRvIHVzZSBtYXgoKSB3aGVuIGxlbihpdGVyYWJsZSk+MAogICAgIiIiCiAgICBpZiBuID09IDE6CiAgICAgICAgaXQgPSBpdGVyKGl0ZXJhYmxlKQogICAgICAgIGhlYWQgPSBsaXN0KGlzbGljZShpdCwgMSkpCiAgICAgICAgaWYgbm90IGhlYWQ6CiAgICAgICAgICAgIHJldHVybiBbXQogICAgICAgIGlmIGtleSBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gW21heChjaGFpbihoZWFkLCBpdCkpXQogICAgICAgIHJldHVybiBbbWF4KGNoYWluKGhlYWQsIGl0KSwga2V5PWtleSldCgogICAgIyBXaGVuIG4+PXNpemUsIGl0J3MgZmFzdGVyIHRvIHVzZSBzb3J0ZWQoKQogICAgdHJ5OgogICAgICAgIHNpemUgPSBsZW4oaXRlcmFibGUpCiAgICBleGNlcHQgKFR5cGVFcnJvciwgQXR0cmlidXRlRXJyb3IpOgogICAgICAgIHBhc3MKICAgIGVsc2U6CiAgICAgICAgaWYgbiA+PSBzaXplOgogICAgICAgICAgICByZXR1cm4gc29ydGVkKGl0ZXJhYmxlLCBrZXk9a2V5LCByZXZlcnNlPVRydWUpWzpuXQoKICAgICMgV2hlbiBrZXkgaXMgbm9uZSwgdXNlIHNpbXBsZXIgZGVjb3JhdGlvbgogICAgaWYga2V5IGlzIE5vbmU6CiAgICAgICAgaXQgPSB6aXAoaXRlcmFibGUsIGNvdW50KDAsLTEpKSAgICAgICAgICAgICAgICAgICAgICMgZGVjb3JhdGUKICAgICAgICByZXN1bHQgPSBfbmxhcmdlc3QobiwgaXQpCiAgICAgICAgcmV0dXJuIFtyWzBdIGZvciByIGluIHJlc3VsdF0gICAgICAgICAgICAgICAgICAgICAgICMgdW5kZWNvcmF0ZQoKICAgICMgR2VuZXJhbCBjYXNlLCBzbG93ZXN0IG1ldGhvZAogICAgaW4xLCBpbjIgPSB0ZWUoaXRlcmFibGUpCiAgICBpdCA9IHppcChtYXAoa2V5LCBpbjEpLCBjb3VudCgwLC0xKSwgaW4yKSAgICAgICAgICAgICAgICMgZGVjb3JhdGUKICAgIHJlc3VsdCA9IF9ubGFyZ2VzdChuLCBpdCkKICAgIHJldHVybiBbclsyXSBmb3IgciBpbiByZXN1bHRdICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB1bmRlY29yYXRlCg==',
'/Lib/imp.py':'IiIiVGhpcyBtb2R1bGUgcHJvdmlkZXMgdGhlIGNvbXBvbmVudHMgbmVlZGVkIHRvIGJ1aWxkIHlvdXIgb3duIF9faW1wb3J0X18KZnVuY3Rpb24uICBVbmRvY3VtZW50ZWQgZnVuY3Rpb25zIGFyZSBvYnNvbGV0ZS4KCkluIG1vc3QgY2FzZXMgaXQgaXMgcHJlZmVycmVkIHlvdSBjb25zaWRlciB1c2luZyB0aGUgaW1wb3J0bGliIG1vZHVsZSdzCmZ1bmN0aW9uYWxpdHkgb3ZlciB0aGlzIG1vZHVsZS4KCiIiIgojIChQcm9iYWJseSkgbmVlZCB0byBzdGF5IGluIF9pbXAKcHJpbnQoJ2ltcCA5JykKZnJvbSBfaW1wIGltcG9ydCAobG9ja19oZWxkLCBhY3F1aXJlX2xvY2ssIHJlbGVhc2VfbG9jaywKICAgICAgICAgICAgICAgICAgbG9hZF9keW5hbWljLCBnZXRfZnJvemVuX29iamVjdCwgaXNfZnJvemVuX3BhY2thZ2UsCiAgICAgICAgICAgICAgICAgIGluaXRfYnVpbHRpbiwgaW5pdF9mcm96ZW4sIGlzX2J1aWx0aW4sIGlzX2Zyb3plbiwKICAgICAgICAgICAgICAgICAgX2ZpeF9jb19maWxlbmFtZSkKcHJpbnQoJ2ltcDE0JykKIyBEaXJlY3RseSBleHBvc2VkIGJ5IHRoaXMgbW9kdWxlCmZyb20gaW1wb3J0bGliLl9ib290c3RyYXAgaW1wb3J0IG5ld19tb2R1bGUKZnJvbSBpbXBvcnRsaWIuX2Jvb3RzdHJhcCBpbXBvcnQgY2FjaGVfZnJvbV9zb3VyY2UsIHNvdXJjZV9mcm9tX2NhY2hlCgoKZnJvbSBpbXBvcnRsaWIgaW1wb3J0IF9ib290c3RyYXAKZnJvbSBpbXBvcnRsaWIgaW1wb3J0IG1hY2hpbmVyeQppbXBvcnQgb3MKaW1wb3J0IHN5cwpwcmludCgnaW1wMjQnKQppbXBvcnQgdG9rZW5pemUKcHJpbnQoJ2ltcCAyNicpCmltcG9ydCB3YXJuaW5ncwoKIyBERVBSRUNBVEVEClNFQVJDSF9FUlJPUiA9IDAKUFlfU09VUkNFID0gMQpQWV9DT01QSUxFRCA9IDIKQ19FWFRFTlNJT04gPSAzClBZX1JFU09VUkNFID0gNApQS0dfRElSRUNUT1JZID0gNQpDX0JVSUxUSU4gPSA2ClBZX0ZST1pFTiA9IDcKUFlfQ09ERVJFU09VUkNFID0gOApJTVBfSE9PSyA9IDkKCgpkZWYgZ2V0X21hZ2ljKCk6CiAgICAiIiJSZXR1cm4gdGhlIG1hZ2ljIG51bWJlciBmb3IgLnB5YyBvciAucHlvIGZpbGVzLiIiIgogICAgcmV0dXJuIF9ib290c3RyYXAuX01BR0lDX0JZVEVTCgoKZGVmIGdldF90YWcoKToKICAgICIiIlJldHVybiB0aGUgbWFnaWMgdGFnIGZvciAucHljIG9yIC5weW8gZmlsZXMuIiIiCiAgICByZXR1cm4gc3lzLmltcGxlbWVudGF0aW9uLmNhY2hlX3RhZwoKCmRlZiBnZXRfc3VmZml4ZXMoKToKICAgIHdhcm5pbmdzLndhcm4oJ2ltcC5nZXRfc3VmZml4ZXMoKSBpcyBkZXByZWNhdGVkOyB1c2UgdGhlIGNvbnN0YW50cyAnCiAgICAgICAgICAgICAgICAgICdkZWZpbmVkIG9uIGltcG9ydGxpYi5tYWNoaW5lcnkgaW5zdGVhZCcsCiAgICAgICAgICAgICAgICAgIERlcHJlY2F0aW9uV2FybmluZywgMikKICAgIGV4dGVuc2lvbnMgPSBbKHMsICdyYicsIENfRVhURU5TSU9OKSBmb3IgcyBpbiBtYWNoaW5lcnkuRVhURU5TSU9OX1NVRkZJWEVTXQogICAgc291cmNlID0gWyhzLCAnVScsIFBZX1NPVVJDRSkgZm9yIHMgaW4gbWFjaGluZXJ5LlNPVVJDRV9TVUZGSVhFU10KICAgIGJ5dGVjb2RlID0gWyhzLCAncmInLCBQWV9DT01QSUxFRCkgZm9yIHMgaW4gbWFjaGluZXJ5LkJZVEVDT0RFX1NVRkZJWEVTXQoKICAgIHJldHVybiBleHRlbnNpb25zICsgc291cmNlICsgYnl0ZWNvZGUKCgpjbGFzcyBOdWxsSW1wb3J0ZXI6CgogICAgIiIiTnVsbCBpbXBvcnQgb2JqZWN0LiIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBwYXRoKToKICAgICAgICBpZiBwYXRoID09ICcnOgogICAgICAgICAgICByYWlzZSBJbXBvcnRFcnJvcignZW1wdHkgcGF0aG5hbWUnLCBwYXRoPScnKQogICAgICAgIGVsaWYgb3MucGF0aC5pc2RpcihwYXRoKToKICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IoJ2V4aXN0aW5nIGRpcmVjdG9yeScsIHBhdGg9cGF0aCkKCiAgICBkZWYgZmluZF9tb2R1bGUoc2VsZiwgZnVsbG5hbWUpOgogICAgICAgICIiIkFsd2F5cyByZXR1cm5zIE5vbmUuIiIiCiAgICAgICAgcmV0dXJuIE5vbmUKCgpjbGFzcyBfSGFja2VkR2V0RGF0YToKCiAgICAiIiJDb21wYXRpYmlpbHR5IHN1cHBvcnQgZm9yICdmaWxlJyBhcmd1bWVudHMgb2YgdmFyaW91cyBsb2FkXyooKQogICAgZnVuY3Rpb25zLiIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBmdWxsbmFtZSwgcGF0aCwgZmlsZT1Ob25lKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGZ1bGxuYW1lLCBwYXRoKQogICAgICAgIHNlbGYuZmlsZSA9IGZpbGUKCiAgICBkZWYgZ2V0X2RhdGEoc2VsZiwgcGF0aCk6CiAgICAgICAgIiIiR3Jvc3MgaGFjayB0byBjb250b3J0IGxvYWRlciB0byBkZWFsIHcvIGxvYWRfKigpJ3MgYmFkIEFQSS4iIiIKICAgICAgICBpZiBzZWxmLmZpbGUgYW5kIHBhdGggPT0gc2VsZi5wYXRoOgogICAgICAgICAgICB3aXRoIHNlbGYuZmlsZToKICAgICAgICAgICAgICAgICMgVGVjaG5pY2FsbHkgc2hvdWxkIGJlIHJldHVybmluZyBieXRlcywgYnV0CiAgICAgICAgICAgICAgICAjIFNvdXJjZUxvYWRlci5nZXRfY29kZSgpIGp1c3QgcGFzc2VkIHdoYXQgaXMgcmV0dXJuZWQgdG8KICAgICAgICAgICAgICAgICMgY29tcGlsZSgpIHdoaWNoIGNhbiBoYW5kbGUgc3RyLiBBbmQgY29udmVydGluZyB0byBieXRlcyB3b3VsZAogICAgICAgICAgICAgICAgIyByZXF1aXJlIGZpZ3VyaW5nIG91dCB0aGUgZW5jb2RpbmcgdG8gZGVjb2RlIHRvIGFuZAogICAgICAgICAgICAgICAgIyB0b2tlbml6ZS5kZXRlY3RfZW5jb2RpbmcoKSBvbmx5IGFjY2VwdHMgYnl0ZXMuCiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5maWxlLnJlYWQoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBzdXBlcigpLmdldF9kYXRhKHBhdGgpCgoKY2xhc3MgX0xvYWRTb3VyY2VDb21wYXRpYmlsaXR5KF9IYWNrZWRHZXREYXRhLCBfYm9vdHN0cmFwLlNvdXJjZUZpbGVMb2FkZXIpOgoKICAgICIiIkNvbXBhdGliaWxpdHkgc3VwcG9ydCBmb3IgaW1wbGVtZW50aW5nIGxvYWRfc291cmNlKCkuIiIiCgoKZGVmIGxvYWRfc291cmNlKG5hbWUsIHBhdGhuYW1lLCBmaWxlPU5vbmUpOgogICAgbXNnID0gKCdpbXAubG9hZF9zb3VyY2UoKSBpcyBkZXByZWNhdGVkOyB1c2UgJwogICAgICAgICAgICdpbXBvcnRsaWIubWFjaGluZXJ5LlNvdXJjZUZpbGVMb2FkZXIobmFtZSwgcGF0aG5hbWUpLmxvYWRfbW9kdWxlKCknCiAgICAgICAgICAgJyBpbnN0ZWFkJykKICAgIHdhcm5pbmdzLndhcm4obXNnLCBEZXByZWNhdGlvbldhcm5pbmcsIDIpCiAgICByZXR1cm4gX0xvYWRTb3VyY2VDb21wYXRpYmlsaXR5KG5hbWUsIHBhdGhuYW1lLCBmaWxlKS5sb2FkX21vZHVsZShuYW1lKQoKCmNsYXNzIF9Mb2FkQ29tcGlsZWRDb21wYXRpYmlsaXR5KF9IYWNrZWRHZXREYXRhLAogICAgICAgIF9ib290c3RyYXAuU291cmNlbGVzc0ZpbGVMb2FkZXIpOgoKICAgICIiIkNvbXBhdGliaWxpdHkgc3VwcG9ydCBmb3IgaW1wbGVtZW50aW5nIGxvYWRfY29tcGlsZWQoKS4iIiIKCgpkZWYgbG9hZF9jb21waWxlZChuYW1lLCBwYXRobmFtZSwgZmlsZT1Ob25lKToKICAgIG1zZyA9ICgnaW1wLmxvYWRfY29tcGlsZWQoKSBpcyBkZXByZWNhdGVkOyB1c2UgJwogICAgICAgICAgICdpbXBvcnRsaWIubWFjaGluZXJ5LlNvdXJjZWxlc3NGaWxlTG9hZGVyKG5hbWUsIHBhdGhuYW1lKS4nCiAgICAgICAgICAgJ2xvYWRfbW9kdWxlKCkgaW5zdGVhZCAnKQogICAgd2FybmluZ3Mud2Fybihtc2csIERlcHJlY2F0aW9uV2FybmluZywgMikKICAgIHJldHVybiBfTG9hZENvbXBpbGVkQ29tcGF0aWJpbGl0eShuYW1lLCBwYXRobmFtZSwgZmlsZSkubG9hZF9tb2R1bGUobmFtZSkKCgpkZWYgbG9hZF9wYWNrYWdlKG5hbWUsIHBhdGgpOgogICAgbXNnID0gKCdpbXAubG9hZF9wYWNrYWdlKCkgaXMgZGVwcmVjYXRlZDsgdXNlIGVpdGhlciAnCiAgICAgICAgICAgJ2ltcG9ydGxpYi5tYWNoaW5lcnkuU291cmNlRmlsZUxvYWRlcigpIG9yICcKICAgICAgICAgICAnaW1wb3J0bGliLm1hY2hpbmVyeS5Tb3VyY2VsZXNzRmlsZUxvYWRlcigpIGluc3RlYWQnKQogICAgd2FybmluZ3Mud2Fybihtc2csIERlcHJlY2F0aW9uV2FybmluZywgMikKICAgIGlmIG9zLnBhdGguaXNkaXIocGF0aCk6CiAgICAgICAgZXh0ZW5zaW9ucyA9IChtYWNoaW5lcnkuU09VUkNFX1NVRkZJWEVTWzpdICsKICAgICAgICAgICAgICAgICAgICAgIG1hY2hpbmVyeS5CWVRFQ09ERV9TVUZGSVhFU1s6XSkKICAgICAgICBmb3IgZXh0ZW5zaW9uIGluIGV4dGVuc2lvbnM6CiAgICAgICAgICAgIHBhdGggPSBvcy5wYXRoLmpvaW4ocGF0aCwgJ19faW5pdF9fJytleHRlbnNpb24pCiAgICAgICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCd7IXJ9IGlzIG5vdCBhIHBhY2thZ2UnLmZvcm1hdChwYXRoKSkKICAgIHJldHVybiBfYm9vdHN0cmFwLlNvdXJjZUZpbGVMb2FkZXIobmFtZSwgcGF0aCkubG9hZF9tb2R1bGUobmFtZSkKCgpkZWYgbG9hZF9tb2R1bGUobmFtZSwgZmlsZSwgZmlsZW5hbWUsIGRldGFpbHMpOgogICAgIiIiKipERVBSRUNBVEVEKioKCiAgICBMb2FkIGEgbW9kdWxlLCBnaXZlbiBpbmZvcm1hdGlvbiByZXR1cm5lZCBieSBmaW5kX21vZHVsZSgpLgoKICAgIFRoZSBtb2R1bGUgbmFtZSBtdXN0IGluY2x1ZGUgdGhlIGZ1bGwgcGFja2FnZSBuYW1lLCBpZiBhbnkuCgogICAgIiIiCiAgICBzdWZmaXgsIG1vZGUsIHR5cGVfID0gZGV0YWlscwogICAgd2l0aCB3YXJuaW5ncy5jYXRjaF93YXJuaW5ncygpOgogICAgICAgIHdhcm5pbmdzLnNpbXBsZWZpbHRlcignaWdub3JlJykKICAgICAgICBpZiBtb2RlIGFuZCAobm90IG1vZGUuc3RhcnRzd2l0aCgoJ3InLCAnVScpKSBvciAnKycgaW4gbW9kZSk6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoJ2ludmFsaWQgZmlsZSBvcGVuIG1vZGUgeyFyfScuZm9ybWF0KG1vZGUpKQogICAgICAgIGVsaWYgZmlsZSBpcyBOb25lIGFuZCB0eXBlXyBpbiB7UFlfU09VUkNFLCBQWV9DT01QSUxFRH06CiAgICAgICAgICAgIG1zZyA9ICdmaWxlIG9iamVjdCByZXF1aXJlZCBmb3IgaW1wb3J0ICh0eXBlIGNvZGUge30pJy5mb3JtYXQodHlwZV8pCiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IobXNnKQogICAgICAgIGVsaWYgdHlwZV8gPT0gUFlfU09VUkNFOgogICAgICAgICAgICByZXR1cm4gbG9hZF9zb3VyY2UobmFtZSwgZmlsZW5hbWUsIGZpbGUpCiAgICAgICAgZWxpZiB0eXBlXyA9PSBQWV9DT01QSUxFRDoKICAgICAgICAgICAgcmV0dXJuIGxvYWRfY29tcGlsZWQobmFtZSwgZmlsZW5hbWUsIGZpbGUpCiAgICAgICAgZWxpZiB0eXBlXyA9PSBQS0dfRElSRUNUT1JZOgogICAgICAgICAgICByZXR1cm4gbG9hZF9wYWNrYWdlKG5hbWUsIGZpbGVuYW1lKQogICAgICAgIGVsaWYgdHlwZV8gPT0gQ19CVUlMVElOOgogICAgICAgICAgICByZXR1cm4gaW5pdF9idWlsdGluKG5hbWUpCiAgICAgICAgZWxpZiB0eXBlXyA9PSBQWV9GUk9aRU46CiAgICAgICAgICAgIHJldHVybiBpbml0X2Zyb3plbihuYW1lKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1zZyA9ICAiRG9uJ3Qga25vdyBob3cgdG8gaW1wb3J0IHt9ICh0eXBlIGNvZGUge30iLmZvcm1hdChuYW1lLCB0eXBlXykKICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IobXNnLCBuYW1lPW5hbWUpCgoKZGVmIGZpbmRfbW9kdWxlKG5hbWUsIHBhdGg9Tm9uZSk6CiAgICAiIiIqKkRFUFJFQ0FURUQqKgoKICAgIFNlYXJjaCBmb3IgYSBtb2R1bGUuCgogICAgSWYgcGF0aCBpcyBvbWl0dGVkIG9yIE5vbmUsIHNlYXJjaCBmb3IgYSBidWlsdC1pbiwgZnJvemVuIG9yIHNwZWNpYWwKICAgIG1vZHVsZSBhbmQgY29udGludWUgc2VhcmNoIGluIHN5cy5wYXRoLiBUaGUgbW9kdWxlIG5hbWUgY2Fubm90CiAgICBjb250YWluICcuJzsgdG8gc2VhcmNoIGZvciBhIHN1Ym1vZHVsZSBvZiBhIHBhY2thZ2UsIHBhc3MgdGhlCiAgICBzdWJtb2R1bGUgbmFtZSBhbmQgdGhlIHBhY2thZ2UncyBfX3BhdGhfXy4KCiAgICAiIiIKICAgIGlmIG5vdCBpc2luc3RhbmNlKG5hbWUsIHN0cik6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCInbmFtZScgbXVzdCBiZSBhIHN0ciwgbm90IHt9Ii5mb3JtYXQodHlwZShuYW1lKSkpCiAgICBlbGlmIG5vdCBpc2luc3RhbmNlKHBhdGgsICh0eXBlKE5vbmUpLCBsaXN0KSk6CiAgICAgICAgIyBCYWNrd2FyZHMtY29tcGF0aWJpbGl0eQogICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigiJ2xpc3QnIG11c3QgYmUgTm9uZSBvciBhIGxpc3QsICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIm5vdCB7fSIuZm9ybWF0KHR5cGUobmFtZSkpKQoKICAgIGlmIHBhdGggaXMgTm9uZToKICAgICAgICBpZiBpc19idWlsdGluKG5hbWUpOgogICAgICAgICAgICByZXR1cm4gTm9uZSwgTm9uZSwgKCcnLCAnJywgQ19CVUlMVElOKQogICAgICAgIGVsaWYgaXNfZnJvemVuKG5hbWUpOgogICAgICAgICAgICByZXR1cm4gTm9uZSwgTm9uZSwgKCcnLCAnJywgUFlfRlJPWkVOKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHBhdGggPSBzeXMucGF0aAoKICAgIGZvciBlbnRyeSBpbiBwYXRoOgogICAgICAgIHBhY2thZ2VfZGlyZWN0b3J5ID0gb3MucGF0aC5qb2luKGVudHJ5LCBuYW1lKQogICAgICAgIGZvciBzdWZmaXggaW4gWycucHknLCBtYWNoaW5lcnkuQllURUNPREVfU1VGRklYRVNbMF1dOgogICAgICAgICAgICBwYWNrYWdlX2ZpbGVfbmFtZSA9ICdfX2luaXRfXycgKyBzdWZmaXgKICAgICAgICAgICAgZmlsZV9wYXRoID0gb3MucGF0aC5qb2luKHBhY2thZ2VfZGlyZWN0b3J5LCBwYWNrYWdlX2ZpbGVfbmFtZSkKICAgICAgICAgICAgaWYgb3MucGF0aC5pc2ZpbGUoZmlsZV9wYXRoKToKICAgICAgICAgICAgICAgIHJldHVybiBOb25lLCBwYWNrYWdlX2RpcmVjdG9yeSwgKCcnLCAnJywgUEtHX0RJUkVDVE9SWSkKICAgICAgICB3aXRoIHdhcm5pbmdzLmNhdGNoX3dhcm5pbmdzKCk6CiAgICAgICAgICAgIHdhcm5pbmdzLnNpbXBsZWZpbHRlcignaWdub3JlJykKICAgICAgICAgICAgZm9yIHN1ZmZpeCwgbW9kZSwgdHlwZV8gaW4gZ2V0X3N1ZmZpeGVzKCk6CiAgICAgICAgICAgICAgICBmaWxlX25hbWUgPSBuYW1lICsgc3VmZml4CiAgICAgICAgICAgICAgICBmaWxlX3BhdGggPSBvcy5wYXRoLmpvaW4oZW50cnksIGZpbGVfbmFtZSkKICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguaXNmaWxlKGZpbGVfcGF0aCk6CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGJyZWFrICAjIEJyZWFrIG91dCBvZiBvdXRlciBsb29wIHdoZW4gYnJlYWtpbmcgb3V0IG9mIGlubmVyIGxvb3AuCiAgICBlbHNlOgogICAgICAgIHJhaXNlIEltcG9ydEVycm9yKF9ib290c3RyYXAuX0VSUl9NU0cuZm9ybWF0KG5hbWUpLCBuYW1lPW5hbWUpCgogICAgZW5jb2RpbmcgPSBOb25lCiAgICBpZiBtb2RlID09ICdVJzoKICAgICAgICB3aXRoIG9wZW4oZmlsZV9wYXRoLCAncmInKSBhcyBmaWxlOgogICAgICAgICAgICBlbmNvZGluZyA9IHRva2VuaXplLmRldGVjdF9lbmNvZGluZyhmaWxlLnJlYWRsaW5lKVswXQogICAgZmlsZSA9IG9wZW4oZmlsZV9wYXRoLCBtb2RlLCBlbmNvZGluZz1lbmNvZGluZykKICAgIHJldHVybiBmaWxlLCBmaWxlX3BhdGgsIChzdWZmaXgsIG1vZGUsIHR5cGVfKQoKCl9SRUxPQURJTkcgPSB7fQoKZGVmIHJlbG9hZChtb2R1bGUpOgogICAgIiIiUmVsb2FkIHRoZSBtb2R1bGUgYW5kIHJldHVybiBpdC4KCiAgICBUaGUgbW9kdWxlIG11c3QgaGF2ZSBiZWVuIHN1Y2Nlc3NmdWxseSBpbXBvcnRlZCBiZWZvcmUuCgogICAgIiIiCiAgICBpZiBub3QgbW9kdWxlIG9yIHR5cGUobW9kdWxlKSAhPSB0eXBlKHN5cyk6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJyZWxvYWQoKSBhcmd1bWVudCBtdXN0IGJlIG1vZHVsZSIpCiAgICBuYW1lID0gbW9kdWxlLl9fbmFtZV9fCiAgICBpZiBuYW1lIG5vdCBpbiBzeXMubW9kdWxlczoKICAgICAgICBtc2cgPSAibW9kdWxlIHt9IG5vdCBpbiBzeXMubW9kdWxlcyIKICAgICAgICByYWlzZSBJbXBvcnRFcnJvcihtc2cuZm9ybWF0KG5hbWUpLCBuYW1lPW5hbWUpCiAgICBpZiBuYW1lIGluIF9SRUxPQURJTkc6CiAgICAgICAgcmV0dXJuIF9SRUxPQURJTkdbbmFtZV0KICAgIF9SRUxPQURJTkdbbmFtZV0gPSBtb2R1bGUKICAgIHRyeToKICAgICAgICBwYXJlbnRfbmFtZSA9IG5hbWUucnBhcnRpdGlvbignLicpWzBdCiAgICAgICAgaWYgcGFyZW50X25hbWUgYW5kIHBhcmVudF9uYW1lIG5vdCBpbiBzeXMubW9kdWxlczoKICAgICAgICAgICAgbXNnID0gInBhcmVudCB7IXJ9IG5vdCBpbiBzeXMubW9kdWxlcyIKICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IobXNnLmZvcm1hdChwYXJlbnRuYW1lKSwgbmFtZT1wYXJlbnRfbmFtZSkKICAgICAgICByZXR1cm4gbW9kdWxlLl9fbG9hZGVyX18ubG9hZF9tb2R1bGUobmFtZSkKICAgIGZpbmFsbHk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBkZWwgX1JFTE9BRElOR1tuYW1lXQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgcGFzcwo=',
'/Lib/io.py':'aW1wb3J0IGJ1aWx0aW5zCgpvcGVuID0gYnVpbHRpbnMub3BlbgoKY2xhc3MgU3RyaW5nSU86CgogICAgZGVmIF9faW5pdF9fKHNlbGYsaW5pdGlhbF92YWx1ZT0nJyxuZXdsaW5lPU5vbmUpOgogICAgICAgIHNlbGYudmFsdWUgPSBpbml0aWFsX3ZhbHVlCiAgICAgICAgc2VsZi5uZXdsaW5lID0gbmV3bGluZQogICAgICAgIHNlbGYuX3BvcyA9IGxlbihpbml0aWFsX3ZhbHVlKQogICAgCiAgICBkZWYgd3JpdGUoc2VsZixkYXRhKToKICAgICAgICBzZWxmLnZhbHVlICs9IGRhdGEKICAgIAogICAgZGVmIHJlYWQoc2VsZixuYj0tMSk6CiAgICAgICAgaWYgbmIhPS0xOgogICAgICAgICAgICByZXMgPSBzZWxmLnZhbHVlW3NlbGYuX3BvczpzZWxmLl9wb3MrbmJdCiAgICAgICAgICAgIHNlbGYuX3BvcyA9IG1pbihzZWxmLl9wb3MrbmIsbGVuKHNlbGYudmFsdWUpLTEpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmVzID0gc2VsZi52YWx1ZVtzZWxmLl9wb3M6XQogICAgICAgICAgICBzZWxmLl9wb3MgPSBsZW4oc2VsZi52YWx1ZSktMQogICAgICAgIHJldHVybiByZXMKClRleHRJT1dyYXBwZXIgPSBTdHJpbmdJTwoKY2xhc3MgUmF3SU9CYXNlOgoKICAgIGRlZiByZWFkKHNlbGYsbj0tMSk6CiAgICAgICAgcGFzcwogICAgZGVmIHJlYWRhbGwoc2VsZik6CiAgICAgICAgcGFzcwogICAgZGVmIHJlYWRpbnRvKHNlbGYsYik6CiAgICAgICAgcGFzcwogICAgZGVmIHdyaXRlKHNlbGYsYik6CiAgICAgICAgcGFzcwoKQnVmZmVyZWRSZWFkZXIgPSBSYXdJT0Jhc2U=',
'/Lib/itertools.py':'aW1wb3J0IG9wZXJhdG9yCgpjbGFzcyBhY2N1bXVsYXRlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGl0ZXJhYmxlLCBmdW5jID0gb3BlcmF0b3IuYWRkKToKICAgICAgICBzZWxmLml0ID0gaXRlcihpdGVyYWJsZSkKICAgICAgICBzZWxmLl90b3RhbCA9IE5vbmUKICAgICAgICBzZWxmLmZ1bmMgPSBmdW5jCiAgICAgICAgCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgaWYgbm90IHNlbGYuX3RvdGFsOgogICAgICAgICAgICBzZWxmLl90b3RhbCA9IG5leHQoc2VsZi5pdCkKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX3RvdGFsCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZWxlbWVudCA9IG5leHQoc2VsZi5pdCkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VsZi5fdG90YWwgPSBzZWxmLmZ1bmMoc2VsZi5fdG90YWwsIGVsZW1lbnQpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigidW5zdXBwb3J0ZWQgb3BlcmFuZCB0eXBlIikKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX3RvdGFsCiAgICAgICAgICAgICAgICAKIyMgQWRhcHRlZCBmcm9tOgojIyBodHRwczovL2JpdGJ1Y2tldC5vcmcvcHlweS9weXB5L3NyYy9jMWFhNzRjMDZlODYvbGliX3B5cHkvaXRlcnRvb2xzLnB5I2NsLTM0CmNsYXNzIGNoYWluOgogICAgZGVmIF9faW5pdF9fKHNlbGYsICppdGVyYWJsZXMpOgogICAgICAgIHNlbGYuX2l0ZXJhYmxlc19pdGVyID0gaXRlcihtYXAoaXRlciwgaXRlcmFibGVzKSkKICAgICAgICAjIGxpdHRsZSB0cmljayBmb3IgdGhlIGZpcnN0IGNoYWluLl9fbmV4dF9fKCkgY2FsbAogICAgICAgIHNlbGYuX2N1cl9pdGVyYWJsZV9pdGVyID0gaXRlcihbXSkKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKICAgIAogICAgZGVmIF9fbmV4dF9fKHNlbGYpOgogICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHJldHVybiBuZXh0KHNlbGYuX2N1cl9pdGVyYWJsZV9pdGVyKQogICAgICAgICAgICBleGNlcHQgU3RvcEl0ZXJhdGlvbjoKICAgICAgICAgICAgICAgIHNlbGYuX2N1cl9pdGVyYWJsZV9pdGVyID0gbmV4dChzZWxmLl9pdGVyYWJsZXNfaXRlcikKICAgIAogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbV9pdGVyYWJsZShjbHMsIGl0ZXJhYmxlKToKICAgICAgICBmb3IgaXQgaW4gaXRlcmFibGU6CiAgICAgICAgICAgIGZvciBlbGVtZW50IGluIGl0OgogICAgICAgICAgICAgICAgeWllbGQgZWxlbWVudAogICAgICAgICAgICAgICAgCmNsYXNzIGNvbWJpbmF0aW9uczoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpdGVyYWJsZSwgcik6CiAgICAgICAgc2VsZi5wb29sID0gdHVwbGUoaXRlcmFibGUpCiAgICAgICAgc2VsZi5uID0gbGVuKHNlbGYucG9vbCkKICAgICAgICBzZWxmLnIgPSByCiAgICAgICAgc2VsZi5pbmRpY2VzID0gbGlzdChyYW5nZShzZWxmLnIpKQogICAgICAgIHNlbGYuemVybyA9IEZhbHNlCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fbmV4dF9fKHNlbGYpOgogICAgICAgIGlmIHNlbGYuciA+IHNlbGYubjoKICAgICAgICAgICAgcmFpc2UgU3RvcEl0ZXJhdGlvbgogICAgICAgIGlmIG5vdCBzZWxmLnplcm86CiAgICAgICAgICAgIHNlbGYuemVybyA9IFRydWUKICAgICAgICAgICAgcmV0dXJuIHR1cGxlKHNlbGYucG9vbFtpXSBmb3IgaSBpbiBzZWxmLmluZGljZXMpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZm9yIGkgaW4gcmV2ZXJzZWQocmFuZ2Uoc2VsZi5yKSk6CiAgICAgICAgICAgICAgICAgICAgaWYgc2VsZi5pbmRpY2VzW2ldICE9IGkgKyBzZWxmLm4gLSBzZWxmLnI6CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBzZWxmLmluZGljZXNbaV0gKz0gMQogICAgICAgICAgICAgICAgZm9yIGogaW4gcmFuZ2UoaSsxLCBzZWxmLnIpOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaW5kaWNlc1tqXSA9IHNlbGYuaW5kaWNlc1tqLTFdICsgMQogICAgICAgICAgICAgICAgcmV0dXJuIHR1cGxlKHNlbGYucG9vbFtpXSBmb3IgaSBpbiBzZWxmLmluZGljZXMpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHJhaXNlIFN0b3BJdGVyYXRpb24KICAgICAgICAgICAgICAgIApjbGFzcyBjb21iaW5hdGlvbnNfd2l0aF9yZXBsYWNlbWVudDoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpdGVyYWJsZSwgcik6CiAgICAgICAgc2VsZi5wb29sID0gdHVwbGUoaXRlcmFibGUpCiAgICAgICAgc2VsZi5uID0gbGVuKHNlbGYucG9vbCkKICAgICAgICBzZWxmLnIgPSByCiAgICAgICAgc2VsZi5pbmRpY2VzID0gWzBdICogc2VsZi5yCiAgICAgICAgc2VsZi56ZXJvID0gRmFsc2UKICAgICAgICAKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgogICAgCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgaWYgbm90IHNlbGYubiBhbmQgc2VsZi5yOgogICAgICAgICAgICByYWlzZSBTdG9wSXRlcmF0aW9uCiAgICAgICAgaWYgbm90IHNlbGYuemVybzoKICAgICAgICAgICAgc2VsZi56ZXJvID0gVHJ1ZQogICAgICAgICAgICByZXR1cm4gdHVwbGUoc2VsZi5wb29sW2ldIGZvciBpIGluIHNlbGYuaW5kaWNlcykKICAgICAgICBlbHNlOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBmb3IgaSBpbiByZXZlcnNlZChyYW5nZShzZWxmLnIpKToKICAgICAgICAgICAgICAgICAgICBpZiBzZWxmLmluZGljZXNbaV0gIT0gc2VsZi5uIC0gMToKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIHNlbGYuaW5kaWNlc1tpOl0gPSBbc2VsZi5pbmRpY2VzW2ldICsgMV0gKiAoc2VsZi5yIC0gaSkKICAgICAgICAgICAgICAgIHJldHVybiB0dXBsZShzZWxmLnBvb2xbaV0gZm9yIGkgaW4gc2VsZi5pbmRpY2VzKQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICByYWlzZSBTdG9wSXRlcmF0aW9uCiAgICAgICAgICAgICAgICAKIyMgTGl0ZXJhbGx5IGNvcGllZCBmcm9tCiMjaHR0cHM6Ly9iaXRidWNrZXQub3JnL3B5cHkvcHlweS9zcmMvYzFhYTc0YzA2ZTg2L2xpYl9weXB5L2l0ZXJ0b29scy5weSNjbC02MyAKY2xhc3MgY29tcHJlc3M6CiAgICBkZWYgX19pbml0X18oc2VsZiwgZGF0YSwgc2VsZWN0b3JzKToKICAgICAgICBzZWxmLmRhdGEgPSBpdGVyKGRhdGEpCiAgICAgICAgc2VsZi5zZWxlY3RvcnMgPSBpdGVyKHNlbGVjdG9ycykKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgbmV4dF9pdGVtID0gbmV4dChzZWxmLmRhdGEpCiAgICAgICAgICAgIG5leHRfc2VsZWN0b3IgPSBuZXh0KHNlbGYuc2VsZWN0b3JzKQogICAgICAgICAgICBpZiBib29sKG5leHRfc2VsZWN0b3IpOgogICAgICAgICAgICAgICAgcmV0dXJuIG5leHRfaXRlbQogICAgICAgICAgICAgICAgCiMjIEFkYXB0ZWQgZnJvbQojI2h0dHBzOi8vYml0YnVja2V0Lm9yZy9weXB5L3B5cHkvc3JjL2MxYWE3NGMwNmU4Ni9saWJfcHlweS9pdGVydG9vbHMucHkjY2wtNzkKIyMgSSBtaW1pY2tlZCB0aGUgPiBweXRob24zLjEgYmVoYXZpb3IKY2xhc3MgY291bnQ6CiAgICAiIiIKICAgIElucHV0IGlzIGFuIGludCBvciBhIGZsb2F0LiBUaGUgb3JpZ2luYWwgUHl0aG9uIDMgaW1wbGVtZW50YXRpb24KICAgIGluY2x1ZGVzIGFsc28gY29tcGxleCBudW1iZXJzLi4uIGJ1dCBpdCBzdGlsbCBpcyBub3QgaW1wbGVtZW50ZWQgCiAgICBpbiBCcnl0aG9uIGFzIGNvbXBsZXggdHlwZSBpcyBOb3RJbXBsZW1lbnRlZAogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgc3RhcnQgPSAwLCBzdGVwID0gMSk6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uoc3RhcnQsIChpbnQsIGZsb2F0KSk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcignYSBudW1iZXIgaXMgcmVxdWlyZWQnKQogICAgICAgIHNlbGYudGltZXMgPSBzdGFydCAtIHN0ZXAKICAgICAgICBzZWxmLnN0ZXAgPSBzdGVwCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fbmV4dF9fKHNlbGYpOgogICAgICAgIHNlbGYudGltZXMgKz0gc2VsZi5zdGVwCiAgICAgICAgcmV0dXJuIHNlbGYudGltZXMKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICdjb3VudCglZCknICUgKHNlbGYudGltZXMgKyBzZWxmLnN0ZXApCgojIyBMaXRlcmFsbHkgY29waWVkIGZyb20KIyNodHRwczovL2JpdGJ1Y2tldC5vcmcvcHlweS9weXB5L3NyYy9jMWFhNzRjMDZlODYvbGliX3B5cHkvaXRlcnRvb2xzLnB5I2NsLTExMiAgICAgICAgCmNsYXNzIGN5Y2xlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGl0ZXJhYmxlKToKICAgICAgICBzZWxmLl9jdXJfaXRlciA9IGl0ZXIoaXRlcmFibGUpCiAgICAgICAgc2VsZi5fc2F2ZWQgPSBbXQogICAgICAgIHNlbGYuX211c3Rfc2F2ZSA9IFRydWUKICAgICAgICAKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX25leHRfXyhzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIG5leHRfZWx0ID0gbmV4dChzZWxmLl9jdXJfaXRlcikKICAgICAgICAgICAgaWYgc2VsZi5fbXVzdF9zYXZlOgogICAgICAgICAgICAgICAgc2VsZi5fc2F2ZWQuYXBwZW5kKG5leHRfZWx0KQogICAgICAgIGV4Y2VwdCBTdG9wSXRlcmF0aW9uOgogICAgICAgICAgICBzZWxmLl9jdXJfaXRlciA9IGl0ZXIoc2VsZi5fc2F2ZWQpCiAgICAgICAgICAgIG5leHRfZWx0ID0gbmV4dChzZWxmLl9jdXJfaXRlcikKICAgICAgICAgICAgc2VsZi5fbXVzdF9zYXZlID0gRmFsc2UKICAgICAgICByZXR1cm4gbmV4dF9lbHQKICAgICAgICAKIyMgTGl0ZXJhbGx5IGNvcGllZCBmcm9tCiMjaHR0cHM6Ly9iaXRidWNrZXQub3JnL3B5cHkvcHlweS9zcmMvYzFhYTc0YzA2ZTg2L2xpYl9weXB5L2l0ZXJ0b29scy5weSNjbC0xNDkKY2xhc3MgZHJvcHdoaWxlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHByZWRpY2F0ZSwgaXRlcmFibGUpOgogICAgICAgIHNlbGYuX3ByZWRpY2F0ZSA9IHByZWRpY2F0ZQogICAgICAgIHNlbGYuX2l0ZXIgPSBpdGVyKGl0ZXJhYmxlKQogICAgICAgIHNlbGYuX2Ryb3BwZWQgPSBGYWxzZQoKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX25leHRfXyhzZWxmKToKICAgICAgICB2YWx1ZSA9IG5leHQoc2VsZi5faXRlcikKICAgICAgICBpZiBzZWxmLl9kcm9wcGVkOgogICAgICAgICAgICByZXR1cm4gdmFsdWUKICAgICAgICB3aGlsZSBzZWxmLl9wcmVkaWNhdGUodmFsdWUpOgogICAgICAgICAgICB2YWx1ZSA9IG5leHQoc2VsZi5faXRlcikKICAgICAgICBzZWxmLl9kcm9wcGVkID0gVHJ1ZQogICAgICAgIHJldHVybiB2YWx1ZQogICAgICAgIAojIyBBZGFwdGVkIGZyb20KIyNodHRwczovL2JpdGJ1Y2tldC5vcmcvcHlweS9weXB5L3NyYy9jMWFhNzRjMDZlODYvbGliX3B5cHkvaXRlcnRvb2xzLnB5I2NsLTI2MQpjbGFzcyBmaWx0ZXJmYWxzZToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBwcmVkaWNhdGUsIGl0ZXJhYmxlKToKICAgICAgICAjIE1ha2Ugc3VyZSBpdGVyYWJsZSAqSVMqIGl0ZXJhYmxlCiAgICAgICAgc2VsZi5faXRlciA9IGl0ZXIoaXRlcmFibGUpCiAgICAgICAgaWYgcHJlZGljYXRlIGlzIE5vbmU6CiAgICAgICAgICAgIHNlbGYuX3ByZWRpY2F0ZSA9IGJvb2wKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl9wcmVkaWNhdGUgPSBwcmVkaWNhdGUKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKICAgIGRlZiBfX25leHRfXyhzZWxmKToKICAgICAgICBuZXh0X2VsdCA9IG5leHQoc2VsZi5faXRlcikKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICBpZiBub3Qgc2VsZi5fcHJlZGljYXRlKG5leHRfZWx0KToKICAgICAgICAgICAgICAgIHJldHVybiBuZXh0X2VsdAogICAgICAgICAgICBuZXh0X2VsdCA9IG5leHQoc2VsZi5faXRlcikKCmNsYXNzIGdyb3VwYnk6CiAgICAjIyBUTy1ETwogICAgcGFzcwogICAgICAgICAgCiMjIGFkYXB0ZWQgZnJvbQojI2h0dHBzOi8vYml0YnVja2V0Lm9yZy9weXB5L3B5cHkvc3JjL2MxYWE3NGMwNmU4Ni9saWJfcHlweS9pdGVydG9vbHMucHkjY2wtMzIzCmNsYXNzIGlzbGljZToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpdGVyYWJsZSwgKmFyZ3MpOgogICAgICAgIHMgPSBzbGljZSgqYXJncykKICAgICAgICBzZWxmLnN0YXJ0LCBzZWxmLnN0b3AsIHNlbGYuc3RlcCA9IHMuc3RhcnQgb3IgMCwgcy5zdG9wLCBzLnN0ZXAKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShzZWxmLnN0YXJ0LCBpbnQpOgogICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIlN0YXJ0IGFyZ3VtZW50IG11c3QgYmUgYW4gaW50ZWdlciIpCiAgICAgICAgaWYgc2VsZi5zdG9wICE9IE5vbmUgYW5kIG5vdCBpc2luc3RhbmNlKHNlbGYuc3RvcCwgaW50KToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiU3RvcCBhcmd1bWVudCBtdXN0IGJlIGFuIGludGVnZXIgb3IgTm9uZSIpCiAgICAgICAgaWYgc2VsZi5zdGVwIGlzIE5vbmU6CiAgICAgICAgICAgIHNlbGYuc3RlcCA9IDEKICAgICAgICBpZiBzZWxmLnN0YXJ0PDAgb3IgKHNlbGYuc3RvcCAhPSBOb25lIGFuZCBzZWxmLnN0b3A8MAogICAgICAgICAgICkgb3Igc2VsZi5zdGVwPD0wOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJpbmRpY2VzIGZvciBpc2xpY2UoKSBtdXN0IGJlIHBvc2l0aXZlIikKICAgICAgICBzZWxmLml0ID0gaXRlcihpdGVyYWJsZSkKICAgICAgICBzZWxmLmRvbmV4dCA9IE5vbmUKICAgICAgICBzZWxmLmNudCA9IDAKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgbmV4dGluZGV4ID0gc2VsZi5zdGFydAogICAgICAgIGlmIHNlbGYuc3RvcCAhPSBOb25lIGFuZCBuZXh0aW5kZXggPj0gc2VsZi5zdG9wOgogICAgICAgICAgICByYWlzZSBTdG9wSXRlcmF0aW9uCiAgICAgICAgd2hpbGUgc2VsZi5jbnQgPD0gbmV4dGluZGV4OgogICAgICAgICAgICBuZXh0aXRlbSA9IG5leHQoc2VsZi5pdCkKICAgICAgICAgICAgc2VsZi5jbnQgKz0gMQogICAgICAgIHNlbGYuc3RhcnQgKz0gc2VsZi5zdGVwIAogICAgICAgIHJldHVybiBuZXh0aXRlbQogICAgICAgIApjbGFzcyBwZXJtdXRhdGlvbnM6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaXRlcmFibGUsIHIgPSBOb25lKToKICAgICAgICBzZWxmLnBvb2wgPSB0dXBsZShpdGVyYWJsZSkKICAgICAgICBzZWxmLm4gPSBsZW4oc2VsZi5wb29sKQogICAgICAgIHNlbGYuciA9IHNlbGYubiBpZiByIGlzIE5vbmUgZWxzZSByCiAgICAgICAgc2VsZi5pbmRpY2VzID0gbGlzdChyYW5nZShzZWxmLm4pKQogICAgICAgIHNlbGYuY3ljbGVzID0gbGlzdChyYW5nZShzZWxmLm4sIHNlbGYubiAtIHIsIC0xKSkKICAgICAgICBzZWxmLnplcm8gPSBGYWxzZQogICAgICAgIHNlbGYuc3RvcCA9IEZhbHNlCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fbmV4dF9fKHNlbGYpOgogICAgICAgIGluZGljZXMgPSBzZWxmLmluZGljZXMKICAgICAgICBpZiBzZWxmLnIgPiBzZWxmLm46CiAgICAgICAgICAgIHJhaXNlIFN0b3BJdGVyYXRpb24KICAgICAgICBpZiBub3Qgc2VsZi56ZXJvOgogICAgICAgICAgICBzZWxmLnplcm8gPSBUcnVlCiAgICAgICAgICAgIHJldHVybiB0dXBsZShzZWxmLnBvb2xbaV0gZm9yIGkgaW4gaW5kaWNlc1s6c2VsZi5yXSkKICAgICAgICAKICAgICAgICBpID0gc2VsZi5yIC0gMQogICAgICAgIHdoaWxlIGkgPj0gMDoKICAgICAgICAgICAgaiA9IHNlbGYuY3ljbGVzW2ldIC0gMQogICAgICAgICAgICBpZiBqID4gMDoKICAgICAgICAgICAgICAgIHNlbGYuY3ljbGVzW2ldID0gagogICAgICAgICAgICAgICAgaW5kaWNlc1tpXSwgaW5kaWNlc1stal0gPSBpbmRpY2VzWy1qXSwgaW5kaWNlc1tpXQogICAgICAgICAgICAgICAgcmV0dXJuIHR1cGxlKHNlbGYucG9vbFtpXSBmb3IgaSBpbiBpbmRpY2VzWzpzZWxmLnJdKQogICAgICAgICAgICBzZWxmLmN5Y2xlc1tpXSA9IGxlbihpbmRpY2VzKSAtIGkKICAgICAgICAgICAgbjEgPSBsZW4oaW5kaWNlcykgLSAxCiAgICAgICAgICAgIGFzc2VydCBuMSA+PSAwCiAgICAgICAgICAgIG51bSA9IGluZGljZXNbaV0KICAgICAgICAgICAgZm9yIGsgaW4gcmFuZ2UoaSwgbjEpOgogICAgICAgICAgICAgICAgaW5kaWNlc1trXSA9IGluZGljZXNbaysxXQogICAgICAgICAgICBpbmRpY2VzW24xXSA9IG51bQogICAgICAgICAgICBpIC09IDEKICAgICAgICByYWlzZSBTdG9wSXRlcmF0aW9uCgojIyBhZGFwdGVkIGZyb20KIyNodHRwczovL2JpdGJ1Y2tldC5vcmcvcHlweS9weXB5L3NyYy9jMWFhNzRjMDZlODYvbGliX3B5cHkvaXRlcnRvb2xzLnB5I2NsLTM5MiAgICAgICAgCmNsYXNzIHByb2R1Y3Q6CiAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3cpOgogICAgICAgIGlmIGxlbihrdykgPiAxOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoInByb2R1Y3QoKSB0YWtlcyBhdCBtb3N0IDEgYXJndW1lbnQgKCVkIGdpdmVuKSIgJQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlbihrdykpCiAgICAgICAgc2VsZi5yZXBlYXQgPSBrdy5nZXQoJ3JlcGVhdCcsIDEpCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uoc2VsZi5yZXBlYXQsIGludCk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiaW50ZWdlciBhcmd1bWVudCBleHBlY3RlZCwgZ290ICVzIiAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZShzZWxmLnJlcGVhdCkpCiAgICAgICAgc2VsZi5nZWFycyA9IFt4IGZvciB4IGluIGFyZ3NdICogc2VsZi5yZXBlYXQKICAgICAgICBzZWxmLm51bV9nZWFycyA9IGxlbihzZWxmLmdlYXJzKQogICAgICAgICMgaW5pdGlhbGl6YXRpb24gb2YgaW5kaWNpZXMgdG8gbG9vcCBvdmVyCiAgICAgICAgc2VsZi5pbmRpY2llcyA9IFsoMCwgbGVuKHNlbGYuZ2VhcnNbeF0pKQogICAgICAgICAgICAgICAgICAgICAgICAgZm9yIHggaW4gcmFuZ2UoMCwgc2VsZi5udW1fZ2VhcnMpXQogICAgICAgIHNlbGYuY29udCA9IFRydWUKICAgICAgICBzZWxmLnplcm8gPSBGYWxzZQoKICAgIGRlZiByb2xsX2dlYXJzKHNlbGYpOgogICAgICAgICMgU3RhcnRpbmcgZnJvbSB0aGUgZW5kIG9mIHRoZSBnZWFyIGluZGljaWVzIHdvcmsgdG8gdGhlIGZyb250CiAgICAgICAgIyBpbmNyZW1lbnRpbmcgdGhlIGdlYXIgdW50aWwgdGhlIGxpbWl0IGlzIHJlYWNoZWQuIFdoZW4gdGhlIGxpbWl0CiAgICAgICAgIyBpcyByZWFjaGVkIGNhcnJ5IG9wZXJhdGlvbiB0byB0aGUgbmV4dCBnZWFyCiAgICAgICAgc2hvdWxkX2NhcnJ5ID0gVHJ1ZQogICAgICAgIGZvciBuIGluIHJhbmdlKDAsIHNlbGYubnVtX2dlYXJzKToKICAgICAgICAgICAgbnRoX2dlYXIgPSBzZWxmLm51bV9nZWFycyAtIG4gLSAxCiAgICAgICAgICAgIGlmIHNob3VsZF9jYXJyeToKICAgICAgICAgICAgICAgIGNvdW50LCBsaW0gPSBzZWxmLmluZGljaWVzW250aF9nZWFyXQogICAgICAgICAgICAgICAgY291bnQgKz0gMQogICAgICAgICAgICAgICAgaWYgY291bnQgPT0gbGltIGFuZCBudGhfZ2VhciA9PSAwOgogICAgICAgICAgICAgICAgICAgIHNlbGYuY29udCA9IEZhbHNlCiAgICAgICAgICAgICAgICBpZiBjb3VudCA9PSBsaW06CiAgICAgICAgICAgICAgICAgICAgc2hvdWxkX2NhcnJ5ID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgIGNvdW50ID0gMAogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzaG91bGRfY2FycnkgPSBGYWxzZQogICAgICAgICAgICAgICAgc2VsZi5pbmRpY2llc1tudGhfZ2Vhcl0gPSAoY291bnQsIGxpbSkgIAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgYnJlYWsKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgaWYgc2VsZi56ZXJvOgogICAgICAgICAgICByYWlzZSBTdG9wSXRlcmF0aW9uCiAgICAgICAgaWYgc2VsZi5yZXBlYXQgPiAwOgogICAgICAgICAgICBpZiBub3Qgc2VsZi5jb250OgogICAgICAgICAgICAgICAgcmFpc2UgU3RvcEl0ZXJhdGlvbgogICAgICAgICAgICBsID0gW10KICAgICAgICAgICAgZm9yIHggaW4gcmFuZ2UoMCwgc2VsZi5udW1fZ2VhcnMpOgogICAgICAgICAgICAgICAgaW5kZXgsIGxpbWl0ID0gc2VsZi5pbmRpY2llc1t4XQogICAgICAgICAgICAgICAgbC5hcHBlbmQoc2VsZi5nZWFyc1t4XVtpbmRleF0pCiAgICAgICAgICAgIHNlbGYucm9sbF9nZWFycygpCiAgICAgICAgICAgIHJldHVybiB0dXBsZShsKQogICAgICAgIGVsaWYgc2VsZi5yZXBlYXQgPT0gMDoKICAgICAgICAgICAgc2VsZi56ZXJvID0gVHJ1ZQogICAgICAgICAgICByZXR1cm4gKCkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJyZXBlYXQgYXJndW1lbnQgY2Fubm90IGJlIG5lZ2F0aXZlIikKICAgICAgICAgICAgCiMjIExpdGVyYWxseSBjb3BpZWQgZnJvbQojI2h0dHBzOi8vYml0YnVja2V0Lm9yZy9weXB5L3B5cHkvc3JjL2MxYWE3NGMwNmU4Ni9saWJfcHlweS9pdGVydG9vbHMucHkjY2wtNDQxCmNsYXNzIHJlcGVhdDoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBvYmosIHRpbWVzPU5vbmUpOgogICAgICAgIHNlbGYuX29iaiA9IG9iagogICAgICAgIGlmIHRpbWVzIGlzIG5vdCBOb25lOgogICAgICAgICAgICByYW5nZSh0aW1lcykgIyBSYWlzZSBhIFR5cGVFcnJvcgogICAgICAgICAgICBpZiB0aW1lcyA8IDA6CiAgICAgICAgICAgICAgICB0aW1lcyA9IDAKICAgICAgICBzZWxmLl90aW1lcyA9IHRpbWVzCiAgICAgICAgCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgIyBfX25leHRfXygpICpuZWVkKiB0byBkZWNyZW1lbnQgc2VsZi5fdGltZXMgd2hlbiBjb25zdW1lZAogICAgICAgIGlmIHNlbGYuX3RpbWVzIGlzIG5vdCBOb25lOgogICAgICAgICAgICBpZiBzZWxmLl90aW1lcyA8PSAwOiAKICAgICAgICAgICAgICAgIHJhaXNlIFN0b3BJdGVyYXRpb24oKQogICAgICAgICAgICBzZWxmLl90aW1lcyAtPSAxCiAgICAgICAgcmV0dXJuIHNlbGYuX29iagoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICBpZiBzZWxmLl90aW1lcyBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmV0dXJuICdyZXBlYXQoJXIsICVyKScgJSAoc2VsZi5fb2JqLCBzZWxmLl90aW1lcykKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gJ3JlcGVhdCglciknICUgKHNlbGYuX29iaiwpCgogICAgZGVmIF9fbGVuX18oc2VsZik6CiAgICAgICAgaWYgc2VsZi5fdGltZXMgPT0gLTEgb3Igc2VsZi5fdGltZXMgaXMgTm9uZToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJsZW4oKSBvZiB1bmlzemVkIG9iamVjdCIpCiAgICAgICAgcmV0dXJuIHNlbGYuX3RpbWVzCgojIyBBZGFwdGVkIGZyb20KIyNodHRwczovL2JpdGJ1Y2tldC5vcmcvcHlweS9weXB5L3NyYy9jMWFhNzRjMDZlODYvbGliX3B5cHkvaXRlcnRvb2xzLnB5I2NsLTQ4OQpjbGFzcyBzdGFybWFwKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgZnVuY3Rpb24sIGl0ZXJhYmxlKToKICAgICAgICBzZWxmLl9mdW5jID0gZnVuY3Rpb24KICAgICAgICBzZWxmLl9pdGVyID0gaXRlcihpdGVyYWJsZSkKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgdCA9IG5leHQoc2VsZi5faXRlcikKICAgICAgICByZXR1cm4gc2VsZi5fZnVuYygqdCkKICAgICAgICAKIyMgTGl0ZXJhbGx5IGNvcGllZCBmcm9tCiMjaHR0cHM6Ly9iaXRidWNrZXQub3JnL3B5cHkvcHlweS9zcmMvYzFhYTc0YzA2ZTg2L2xpYl9weXB5L2l0ZXJ0b29scy5weSNjbC01MjAKY2xhc3MgdGFrZXdoaWxlKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgcHJlZGljYXRlLCBpdGVyYWJsZSk6CiAgICAgICAgc2VsZi5fcHJlZGljYXRlID0gcHJlZGljYXRlCiAgICAgICAgc2VsZi5faXRlciA9IGl0ZXIoaXRlcmFibGUpCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fbmV4dF9fKHNlbGYpOgogICAgICAgIHZhbHVlID0gbmV4dChzZWxmLl9pdGVyKQogICAgICAgIGlmIG5vdCBzZWxmLl9wcmVkaWNhdGUodmFsdWUpOgogICAgICAgICAgICByYWlzZSBTdG9wSXRlcmF0aW9uKCkKICAgICAgICByZXR1cm4gdmFsdWUKCiMjIEFsbW9zdCBsaXRlcmFsIGZyb20KIyNodHRwczovL2JpdGJ1Y2tldC5vcmcvcHlweS9weXB5L3NyYy9jMWFhNzRjMDZlODYvbGliX3B5cHkvaXRlcnRvb2xzLnB5I2NsLTU0NwpjbGFzcyBUZWVEYXRhKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaXRlcmF0b3IpOgogICAgICAgIHNlbGYuZGF0YSA9IFtdCiAgICAgICAgc2VsZi5faXRlciA9IGl0ZXJhdG9yCgogICAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGkpOgogICAgICAgICMgaXRlcmF0ZXMgdW50aWwgJ2knIGlmIG5vdCBkb25lIHlldAogICAgICAgIHdoaWxlIGk+PSBsZW4oc2VsZi5kYXRhKToKICAgICAgICAgICAgc2VsZi5kYXRhLmFwcGVuZChuZXh0KHNlbGYuX2l0ZXIpKQogICAgICAgIHJldHVybiBzZWxmLmRhdGFbaV0KCgpjbGFzcyBUZWVPYmplY3Qob2JqZWN0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpdGVyYWJsZT1Ob25lLCB0ZWVfZGF0YT1Ob25lKToKICAgICAgICBpZiB0ZWVfZGF0YToKICAgICAgICAgICAgc2VsZi50ZWVfZGF0YSA9IHRlZV9kYXRhCiAgICAgICAgICAgIHNlbGYucG9zID0gMAogICAgICAgICMgPD0+IENvcHkgY29uc3RydWN0b3IKICAgICAgICBlbGlmIGlzaW5zdGFuY2UoaXRlcmFibGUsIFRlZU9iamVjdCk6CiAgICAgICAgICAgIHNlbGYudGVlX2RhdGEgPSBpdGVyYWJsZS50ZWVfZGF0YQogICAgICAgICAgICBzZWxmLnBvcyA9IGl0ZXJhYmxlLnBvcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYudGVlX2RhdGEgPSBUZWVEYXRhKGl0ZXIoaXRlcmFibGUpKQogICAgICAgICAgICBzZWxmLnBvcyA9IDAKICAgICAgICAgICAgCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgZGF0YSA9IHNlbGYudGVlX2RhdGFbc2VsZi5wb3NdCiAgICAgICAgc2VsZi5wb3MgKz0gMQogICAgICAgIHJldHVybiBkYXRhCiAgICAKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgoKCmRlZiB0ZWUoaXRlcmFibGUsIG49Mik6CiAgICBpZiBpc2luc3RhbmNlKGl0ZXJhYmxlLCBUZWVPYmplY3QpOgogICAgICAgIHJldHVybiB0dXBsZShbaXRlcmFibGVdICsKICAgICAgICBbVGVlT2JqZWN0KHRlZV9kYXRhPWl0ZXJhYmxlLnRlZV9kYXRhKSBmb3IgaSBpbiByYW5nZShuIC0gMSldKQogICAgdGVlX2RhdGEgPSBUZWVEYXRhKGl0ZXIoaXRlcmFibGUpKQogICAgcmV0dXJuIHR1cGxlKFtUZWVPYmplY3QodGVlX2RhdGE9dGVlX2RhdGEpIGZvciBpIGluIHJhbmdlKG4pXSkKCmNsYXNzIHppcF9sb25nZXN0OgogICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCBmaWxsdmFsdWUgPSBOb25lKToKICAgICAgICBzZWxmLmFyZ3MgPSBhcmdzCiAgICAgICAgc2VsZi5maWxsdmFsdWUgPSBmaWxsdmFsdWUKICAgICAgICBzZWxmLm1heF9sZW5ndGggPSBtYXgoW2xlbihhcmcpIGZvciBhcmcgaW4gc2VsZi5hcmdzXSkKICAgICAgICBzZWxmLnVuaXRzID0gbGVuKGFyZ3MpCiAgICAgICAgc2VsZi5jb3VudGVyID0gMAogICAgCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKICAgIAogICAgZGVmIF9fbmV4dF9fKHNlbGYpOgogICAgICAgIGlmIHNlbGYuY291bnRlciA9PSBzZWxmLm1heF9sZW5ndGg6CiAgICAgICAgICAgIHJhaXNlIFN0b3BJdGVyYXRpb24KICAgICAgICBlbHNlOgogICAgICAgICAgICB0ZW1wID0gW10KICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2Uoc2VsZi51bml0cyk6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgdGVtcC5hcHBlbmQoc2VsZi5hcmdzW2ldW3NlbGYuY291bnRlcl0pCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgdGVtcC5hcHBlbmQoc2VsZi5maWxsdmFsdWUpCiAgICAgICAgICAgIHNlbGYuY291bnRlciA9IHNlbGYuY291bnRlciArIDEKICAgICAgICAgICAgcmV0dXJuIHR1cGxlKHRlbXAp',
'/Lib/keyword.py':'a3dsaXN0ID0gWwojLS1zdGFydCBrZXl3b3Jkcy0tCiAgICAgICAgJ0ZhbHNlJywKICAgICAgICAnTm9uZScsCiAgICAgICAgJ1RydWUnLAogICAgICAgICdhbmQnLAogICAgICAgICdhcycsCiAgICAgICAgJ2Fzc2VydCcsCiAgICAgICAgJ2JyZWFrJywKICAgICAgICAnY2xhc3MnLAogICAgICAgICdjb250aW51ZScsCiAgICAgICAgJ2RlZicsCiAgICAgICAgJ2RlbCcsCiAgICAgICAgJ2VsaWYnLAogICAgICAgICdlbHNlJywKICAgICAgICAnZXhjZXB0JywKICAgICAgICAnZmluYWxseScsCiAgICAgICAgJ2ZvcicsCiAgICAgICAgJ2Zyb20nLAogICAgICAgICdnbG9iYWwnLAogICAgICAgICdpZicsCiAgICAgICAgJ2ltcG9ydCcsCiAgICAgICAgJ2luJywKICAgICAgICAnaXMnLAogICAgICAgICdsYW1iZGEnLAogICAgICAgICdub25sb2NhbCcsCiAgICAgICAgJ25vdCcsCiAgICAgICAgJ29yJywKICAgICAgICAncGFzcycsCiAgICAgICAgJ3JhaXNlJywKICAgICAgICAncmV0dXJuJywKICAgICAgICAndHJ5JywKICAgICAgICAnd2hpbGUnLAogICAgICAgICd3aXRoJywKICAgICAgICAneWllbGQnLAojLS1lbmQga2V5d29yZHMtLQogICAgICAgIF0KCmRlZiBpc2tleXdvcmQod29yZCk6CiAgICByZXR1cm4gd29yZCBpbiBrd2xpc3QK',
'/Lib/linecache.py':'IiIiQ2FjaGUgbGluZXMgZnJvbSBmaWxlcy4KClRoaXMgaXMgaW50ZW5kZWQgdG8gcmVhZCBsaW5lcyBmcm9tIG1vZHVsZXMgaW1wb3J0ZWQgLS0gaGVuY2UgaWYgYSBmaWxlbmFtZQppcyBub3QgZm91bmQsIGl0IHdpbGwgbG9vayBkb3duIHRoZSBtb2R1bGUgc2VhcmNoIHBhdGggZm9yIGEgZmlsZSBieQp0aGF0IG5hbWUuCiIiIgoKaW1wb3J0IHN5cwppbXBvcnQgb3MKI2ZpeG1lIGJyeXRob24KI2ltcG9ydCB0b2tlbml6ZQoKX19hbGxfXyA9IFsiZ2V0bGluZSIsICJjbGVhcmNhY2hlIiwgImNoZWNrY2FjaGUiXQoKZGVmIGdldGxpbmUoZmlsZW5hbWUsIGxpbmVubywgbW9kdWxlX2dsb2JhbHM9Tm9uZSk6CiAgICBsaW5lcyA9IGdldGxpbmVzKGZpbGVuYW1lLCBtb2R1bGVfZ2xvYmFscykKICAgIGlmIDEgPD0gbGluZW5vIDw9IGxlbihsaW5lcyk6CiAgICAgICAgcmV0dXJuIGxpbmVzW2xpbmVuby0xXQogICAgZWxzZToKICAgICAgICByZXR1cm4gJycKCgojIFRoZSBjYWNoZQoKY2FjaGUgPSB7fSAjIFRoZSBjYWNoZQoKCmRlZiBjbGVhcmNhY2hlKCk6CiAgICAiIiJDbGVhciB0aGUgY2FjaGUgZW50aXJlbHkuIiIiCgogICAgZ2xvYmFsIGNhY2hlCiAgICBjYWNoZSA9IHt9CgoKZGVmIGdldGxpbmVzKGZpbGVuYW1lLCBtb2R1bGVfZ2xvYmFscz1Ob25lKToKICAgICIiIkdldCB0aGUgbGluZXMgZm9yIGEgZmlsZSBmcm9tIHRoZSBjYWNoZS4KICAgIFVwZGF0ZSB0aGUgY2FjaGUgaWYgaXQgZG9lc24ndCBjb250YWluIGFuIGVudHJ5IGZvciB0aGlzIGZpbGUgYWxyZWFkeS4iIiIKCiAgICBpZiBmaWxlbmFtZSBpbiBjYWNoZToKICAgICAgICByZXR1cm4gY2FjaGVbZmlsZW5hbWVdWzJdCiAgICBlbHNlOgogICAgICAgIHJldHVybiB1cGRhdGVjYWNoZShmaWxlbmFtZSwgbW9kdWxlX2dsb2JhbHMpCgoKZGVmIGNoZWNrY2FjaGUoZmlsZW5hbWU9Tm9uZSk6CiAgICAiIiJEaXNjYXJkIGNhY2hlIGVudHJpZXMgdGhhdCBhcmUgb3V0IG9mIGRhdGUuCiAgICAoVGhpcyBpcyBub3QgY2hlY2tlZCB1cG9uIGVhY2ggY2FsbCEpIiIiCgogICAgaWYgZmlsZW5hbWUgaXMgTm9uZToKICAgICAgICBmaWxlbmFtZXMgPSBsaXN0KGNhY2hlLmtleXMoKSkKICAgIGVsc2U6CiAgICAgICAgaWYgZmlsZW5hbWUgaW4gY2FjaGU6CiAgICAgICAgICAgIGZpbGVuYW1lcyA9IFtmaWxlbmFtZV0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4KCiAgICBmb3IgZmlsZW5hbWUgaW4gZmlsZW5hbWVzOgogICAgICAgIHNpemUsIG10aW1lLCBsaW5lcywgZnVsbG5hbWUgPSBjYWNoZVtmaWxlbmFtZV0KICAgICAgICBpZiBtdGltZSBpcyBOb25lOgogICAgICAgICAgICBjb250aW51ZSAgICMgbm8tb3AgZm9yIGZpbGVzIGxvYWRlZCB2aWEgYSBfX2xvYWRlcl9fCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzdGF0ID0gb3Muc3RhdChmdWxsbmFtZSkKICAgICAgICAjZml4bWUgYnJ5dGhvbgogICAgICAgICNleGNlcHQgb3MuZXJyb3I6CiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBkZWwgY2FjaGVbZmlsZW5hbWVdCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgaWYgc2l6ZSAhPSBzdGF0LnN0X3NpemUgb3IgbXRpbWUgIT0gc3RhdC5zdF9tdGltZToKICAgICAgICAgICAgZGVsIGNhY2hlW2ZpbGVuYW1lXQoKCmRlZiB1cGRhdGVjYWNoZShmaWxlbmFtZSwgbW9kdWxlX2dsb2JhbHM9Tm9uZSk6CiAgICAiIiJVcGRhdGUgYSBjYWNoZSBlbnRyeSBhbmQgcmV0dXJuIGl0cyBsaXN0IG9mIGxpbmVzLgogICAgSWYgc29tZXRoaW5nJ3Mgd3JvbmcsIHByaW50IGEgbWVzc2FnZSwgZGlzY2FyZCB0aGUgY2FjaGUgZW50cnksCiAgICBhbmQgcmV0dXJuIGFuIGVtcHR5IGxpc3QuIiIiCgogICAgaWYgZmlsZW5hbWUgaW4gY2FjaGU6CiAgICAgICAgZGVsIGNhY2hlW2ZpbGVuYW1lXQogICAgaWYgbm90IGZpbGVuYW1lIG9yIChmaWxlbmFtZS5zdGFydHN3aXRoKCc8JykgYW5kIGZpbGVuYW1lLmVuZHN3aXRoKCc+JykpOgogICAgICAgIHJldHVybiBbXQoKICAgIGZ1bGxuYW1lID0gZmlsZW5hbWUKICAgIHRyeToKICAgICAgICBzdGF0ID0gb3Muc3RhdChmdWxsbmFtZSkKICAgIGV4Y2VwdCBPU0Vycm9yOgogICAgICAgIGJhc2VuYW1lID0gZmlsZW5hbWUKCiAgICAgICAgIyBUcnkgZm9yIGEgX19sb2FkZXJfXywgaWYgYXZhaWxhYmxlCiAgICAgICAgaWYgbW9kdWxlX2dsb2JhbHMgYW5kICdfX2xvYWRlcl9fJyBpbiBtb2R1bGVfZ2xvYmFsczoKICAgICAgICAgICAgbmFtZSA9IG1vZHVsZV9nbG9iYWxzLmdldCgnX19uYW1lX18nKQogICAgICAgICAgICBsb2FkZXIgPSBtb2R1bGVfZ2xvYmFsc1snX19sb2FkZXJfXyddCiAgICAgICAgICAgIGdldF9zb3VyY2UgPSBnZXRhdHRyKGxvYWRlciwgJ2dldF9zb3VyY2UnLCBOb25lKQoKICAgICAgICAgICAgaWYgbmFtZSBhbmQgZ2V0X3NvdXJjZToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBkYXRhID0gZ2V0X3NvdXJjZShuYW1lKQogICAgICAgICAgICAgICAgZXhjZXB0IChJbXBvcnRFcnJvciwgSU9FcnJvcik6CiAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBpZiBkYXRhIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgICMgTm8gbHVjaywgdGhlIFBFUDMwMiBsb2FkZXIgY2Fubm90IGZpbmQgdGhlIHNvdXJjZQogICAgICAgICAgICAgICAgICAgICAgICAjIGZvciB0aGlzIG1vZHVsZS4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtdCiAgICAgICAgICAgICAgICAgICAgY2FjaGVbZmlsZW5hbWVdID0gKAogICAgICAgICAgICAgICAgICAgICAgICBsZW4oZGF0YSksIE5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgIFtsaW5lKydcbicgZm9yIGxpbmUgaW4gZGF0YS5zcGxpdGxpbmVzKCldLCBmdWxsbmFtZQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGVbZmlsZW5hbWVdWzJdCgogICAgICAgICMgVHJ5IGxvb2tpbmcgdGhyb3VnaCB0aGUgbW9kdWxlIHNlYXJjaCBwYXRoLCB3aGljaCBpcyBvbmx5IHVzZWZ1bAogICAgICAgICMgd2hlbiBoYW5kbGluZyBhIHJlbGF0aXZlIGZpbGVuYW1lLgogICAgICAgIGlmIG9zLnBhdGguaXNhYnMoZmlsZW5hbWUpOgogICAgICAgICAgICByZXR1cm4gW10KCiAgICAgICAgIyBUYWtlIGNhcmUgdG8gaGFuZGxlIHBhY2thZ2VzLgogICAgICAgIGlmIGJhc2VuYW1lID09ICdfX2luaXRfXy5weSc6CiAgICAgICAgICAgICMgZmlsZW5hbWUgcmVmZXJlcyB0byBhIHBhY2thZ2UKICAgICAgICAgICAgYmFzZW5hbWUgPSBmaWxlbmFtZQoKICAgICAgICBmb3IgZGlybmFtZSBpbiBzeXMucGF0aDoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZnVsbG5hbWUgPSBvcy5wYXRoLmpvaW4oZGlybmFtZSwgYmFzZW5hbWUpCiAgICAgICAgICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBBdHRyaWJ1dGVFcnJvcik6CiAgICAgICAgICAgICAgICAjIE5vdCBzdWZmaWNpZW50bHkgc3RyaW5nLWxpa2UgdG8gZG8gYW55dGhpbmcgdXNlZnVsIHdpdGguCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzdGF0ID0gb3Muc3RhdChmdWxsbmFtZSkKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICNmaXhtZSBicnl0aG9uLCBpbnZhbGlkIHN5bnRheCAKICAgICAgICAgICAgI2V4Y2VwdCBvcy5lcnJvcjoKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICNmaXhtZSBicnl0aG9uIHVuZXhwZWN0ZWQgdG9rZW4gZWxzZQogICAgICAgICNlbHNlOgogICAgICAgICMgICAgcmV0dXJuIFtdCiAgICB0cnk6CiAgICAgICAgZnA9b3BlbihmdWxsbmFtZSkKICAgICAgICAjZml4bWUgYnJ5dGhvbgogICAgICAgICN3aXRoIHRva2VuaXplLm9wZW4oZnVsbG5hbWUpIGFzIGZwOgogICAgICAgIGxpbmVzID0gZnAucmVhZGxpbmVzKCkKICAgICAgICBmcC5jbG9zZSgpCiAgICBleGNlcHQgSU9FcnJvcjoKICAgICAgICByZXR1cm4gW10KICAgIGlmIGxpbmVzIGFuZCBub3QgbGluZXNbLTFdLmVuZHN3aXRoKCdcbicpOgogICAgICAgIGxpbmVzWy0xXSArPSAnXG4nCiAgICBzaXplLCBtdGltZSA9IHN0YXQuc3Rfc2l6ZSwgc3RhdC5zdF9tdGltZQogICAgY2FjaGVbZmlsZW5hbWVdID0gc2l6ZSwgbXRpbWUsIGxpbmVzLCBmdWxsbmFtZQogICAgcmV0dXJuIGxpbmVzCg==',
'/Lib/locale.py':'ZGVmIGdldGRlZmF1bHRsb2NhbGUoKToKICAgIHJldHVybiBfX0JSWVRIT05fXy5sYW5ndWFnZSxOb25l',
'/Lib/module1.js':'dmFyICRnbG9iYWxzID0gX19CUllUSE9OX18uc2NvcGVbIl9fbWFpbl9fIl0uX19kaWN0X18KdmFyICRsb2NhbHMgPSAkZ2xvYmFscwpfX2RvY19fPSRnbG9iYWxzWyJfX2RvY19fIl09IlJlYWQgZnJvbSBhbmQgd3JpdGUgdG8gdGFyIGZvcm1hdCBhcmNoaXZlcy5cblwKIgpfX25hbWVfXz0kZ2xvYmFsc1siX19uYW1lX18iXT0iX19tYWluX18iCl9fZmlsZV9fPSRnbG9iYWxzWyJfX2ZpbGVfXyJdPSJodHRwOi8vbG9jYWxob3N0OjgwMDAvc2l0ZS90ZXN0cy9pbmRleC5odG1sIgpkb2N1bWVudC4kbGluZV9pbmZvPVsyOSwiX19tYWluX18iXTtOb25lOwoiUmVhZCBmcm9tIGFuZCB3cml0ZSB0byB0YXIgZm9ybWF0IGFyY2hpdmVzLlxuXAoiCmRvY3VtZW50LiRsaW5lX2luZm89WzMyLCJfX21haW5fXyJdO05vbmU7CnZlcnNpb249JGdsb2JhbHNbInZlcnNpb24iXT0iMC45LjAiO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzMzLCJfX21haW5fXyJdO05vbmU7Cl9fYXV0aG9yX189JGdsb2JhbHNbIl9fYXV0aG9yX18iXT0iTGFycyBHdXN0XHUwMGU0YmVsIChsYXJzQGd1c3RhZWJlbC5kZSkiO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzM0LCJfX21haW5fXyJdO05vbmU7Cl9fZGF0ZV9fPSRnbG9iYWxzWyJfX2RhdGVfXyJdPSIkRGF0ZTogMjAxMS0wMi0yNSAxNzo0MjowMSArMDIwMCAoRnJpLCAyNSBGZWIgMjAxMSkgJCI7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzUsIl9fbWFpbl9fIl07Tm9uZTsKX19jdnNpZF9fPSRnbG9iYWxzWyJfX2N2c2lkX18iXT0iJElkOiB0YXJmaWxlLnB5IDg4NTg2IDIwMTEtMDItMjUgMTU6NDI6MDFaIG1hcmMtYW5kcmUubGVtYnVyZyAkIjtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVszNiwiX19tYWluX18iXTtOb25lOwpfX2NyZWRpdHNfXz0kZ2xvYmFsc1siX19jcmVkaXRzX18iXT0iR3VzdGF2byBOaWVtZXllciwgTmllbHMgR3VzdFx1MDBlNGJlbCwgUmljaGFyZCBUb3duc2VuZC4iO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzQxLCJfX21haW5fXyJdO05vbmU7CiRpbXBvcnRfbGlzdChbInN5cyJdKTtzeXM9JGdsb2JhbHNbInN5cyJdPV9fQlJZVEhPTl9fLmltcG9ydGVkWyJzeXMiXTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVs0MiwiX19tYWluX18iXTtOb25lOwokaW1wb3J0X2xpc3QoWyJvcyJdKTtvcz0kZ2xvYmFsc1sib3MiXT1fX0JSWVRIT05fXy5pbXBvcnRlZFsib3MiXTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVs0MywiX19tYWluX18iXTtOb25lOwokaW1wb3J0X2xpc3QoWyJpbyJdKTtpbz0kZ2xvYmFsc1siaW8iXT1fX0JSWVRIT05fXy5pbXBvcnRlZFsiaW8iXTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVs0NCwiX19tYWluX18iXTtOb25lOwokaW1wb3J0X2xpc3QoWyJzaHV0aWwiXSk7c2h1dGlsPSRnbG9iYWxzWyJzaHV0aWwiXT1fX0JSWVRIT05fXy5pbXBvcnRlZFsic2h1dGlsIl07Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDUsIl9fbWFpbl9fIl07Tm9uZTsKJGltcG9ydF9saXN0KFsic3RhdCJdKTtzdGF0PSRnbG9iYWxzWyJzdGF0Il09X19CUllUSE9OX18uaW1wb3J0ZWRbInN0YXQiXTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVs0NiwiX19tYWluX18iXTtOb25lOwokaW1wb3J0X2xpc3QoWyJ0aW1lIl0pO3RpbWU9JGdsb2JhbHNbInRpbWUiXT1fX0JSWVRIT05fXy5pbXBvcnRlZFsidGltZSJdO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzQ3LCJfX21haW5fXyJdO05vbmU7CiRpbXBvcnRfbGlzdChbInN0cnVjdCJdKTtzdHJ1Y3Q9JGdsb2JhbHNbInN0cnVjdCJdPV9fQlJZVEhPTl9fLmltcG9ydGVkWyJzdHJ1Y3QiXTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVs0OCwiX19tYWluX18iXTtOb25lOwokaW1wb3J0X2xpc3QoWyJjb3B5Il0pO2NvcHk9JGdsb2JhbHNbImNvcHkiXT1fX0JSWVRIT05fXy5pbXBvcnRlZFsiY29weSJdO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzQ5LCJfX21haW5fXyJdO05vbmU7CiRpbXBvcnRfbGlzdChbInJlIl0pO3JlPSRnbG9iYWxzWyJyZSJdPV9fQlJZVEhPTl9fLmltcG9ydGVkWyJyZSJdO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzUxLCJfX21haW5fXyJdO05vbmU7CiRmYWlsZWQxMTQ1PWZhbHNlO3RyeXsKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzUyLCJfX21haW5fXyJdO05vbmU7CiAgICAkaW1wb3J0X2xpc3QoWyJncnAiLCJwd2QiXSk7Z3JwPSRnbG9iYWxzWyJncnAiXT1fX0JSWVRIT05fXy5pbXBvcnRlZFsiZ3JwIl07cHdkPSRnbG9iYWxzWyJwd2QiXT1fX0JSWVRIT05fXy5pbXBvcnRlZFsicHdkIl07Tm9uZTsKfQpjYXRjaCgkZXJyMTE0NSl7CiAgICB2YXIgJGZhaWxlZDExNDU9dHJ1ZTtpZihmYWxzZSl7dm9pZCgwKX0KICAgIGVsc2UgaWYoJGlzX2V4YygkZXJyMTE0NSxbSW1wb3J0RXJyb3JdKSl7CiAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICBwd2Q9JGdsb2JhbHNbInB3ZCJdPU5vbmU7Tm9uZTsKICAgICAgICBncnA9JGdsb2JhbHNbImdycCJdPXB3ZDtOb25lOwogICAgfQogICAgZWxzZXt0aHJvdyAkZXJyMTE0NX0KfQpkb2N1bWVudC4kbGluZV9pbmZvPVs1NywiX19tYWluX18iXTtOb25lOwpzeW1saW5rX2V4Y2VwdGlvbj0kZ2xvYmFsc1sic3ltbGlua19leGNlcHRpb24iXT10dXBsZShbQXR0cmlidXRlRXJyb3IsTm90SW1wbGVtZW50ZWRFcnJvcl0pO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzU4LCJfX21haW5fXyJdO05vbmU7CiRmYWlsZWQxMTQ2PWZhbHNlO3RyeXsKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzYxLCJfX21haW5fXyJdO05vbmU7CiAgICAkdGVtcD10dXBsZShbV2luZG93c0Vycm9yXSk7Tm9uZTsKICAgIGlmKCR0ZW1wLiRmYXN0X2F1Z20gJiYgc3ltbGlua19leGNlcHRpb24uJGZhc3RfYXVnbSl7c3ltbGlua19leGNlcHRpb24rPSR0ZW1wOyRnbG9iYWxzWyJzeW1saW5rX2V4Y2VwdGlvbiJdPXN5bWxpbmtfZXhjZXB0aW9ufQogICAgZWxzZSBpZighaGFzYXR0cihzeW1saW5rX2V4Y2VwdGlvbiwiX19pYWRkX18iKSl7CiAgICAgICAgc3ltbGlua19leGNlcHRpb249JGdsb2JhbHNbInN5bWxpbmtfZXhjZXB0aW9uIl09Z2V0YXR0cihzeW1saW5rX2V4Y2VwdGlvbiwiX19hZGRfXyIpKCR0ZW1wKTtOb25lOwogICAgfQogICAgZWxzZXsKICAgICAgICBzeW1saW5rX2V4Y2VwdGlvbj0kZ2xvYmFsc1sic3ltbGlua19leGNlcHRpb24iXT1nZXRhdHRyKHN5bWxpbmtfZXhjZXB0aW9uLCJfX2lhZGRfXyIpKCR0ZW1wKQogICAgfQp9CmNhdGNoKCRlcnIxMTQ2KXsKICAgIHZhciAkZmFpbGVkMTE0Nj10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMTQ2LFtOYW1lRXJyb3JdKSl7CiAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICB2b2lkKDApCiAgICB9CiAgICBlbHNle3Rocm93ICRlcnIxMTQ2fQp9CmRvY3VtZW50LiRsaW5lX2luZm89WzY2LCJfX21haW5fXyJdO05vbmU7Cl9fYWxsX189JGdsb2JhbHNbIl9fYWxsX18iXT1saXN0Ll9fY2FsbF9fKFsiVGFyRmlsZSIsIlRhckluZm8iLCJpc190YXJmaWxlIiwiVGFyRXJyb3IiXSk7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjgsIl9fbWFpbl9fIl07Tm9uZTsKJGltcG9ydF9mcm9tKCJidWlsdGlucyIsWyJvcGVuIixdLCJfX21haW5fXyIpOwp0cnl7dmFyIF9vcGVuPSRnbG9iYWxzWyJfb3BlbiJdPWdldGF0dHIoX19CUllUSE9OX18uaW1wb3J0ZWRbImJ1aWx0aW5zIl0sIm9wZW4iKX0KY2F0Y2goJGVycjEyMjkpe2lmKCRlcnIxMjI5Ll9fY2xhc3NfXz09PSRBdHRyaWJ1dGVFcnJvckRpY3QpeyRlcnIxMjI5Ll9fY2xhc3NfXz0kSW1wb3J0RXJyb3JEaWN0fTt0aHJvdyAkZXJyMTIyOX07Ck5vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzczLCJfX21haW5fXyJdO05vbmU7Ck5VTD0kZ2xvYmFsc1siTlVMIl09Ynl0ZXMoIlwwIik7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzQsIl9fbWFpbl9fIl07Tm9uZTsKQkxPQ0tTSVpFPSRnbG9iYWxzWyJCTE9DS1NJWkUiXT1OdW1iZXIoNTEyKTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVs3NSwiX19tYWluX18iXTtOb25lOwpSRUNPUkRTSVpFPSRnbG9iYWxzWyJSRUNPUkRTSVpFIl09Z2V0YXR0cihCTE9DS1NJWkUsIl9fbXVsX18iKShOdW1iZXIoMjApKTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVs3NiwiX19tYWluX18iXTtOb25lOwpHTlVfTUFHSUM9JGdsb2JhbHNbIkdOVV9NQUdJQyJdPWJ5dGVzKCJ1c3RhciAgXDAiKTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVs3NywiX19tYWluX18iXTtOb25lOwpQT1NJWF9NQUdJQz0kZ2xvYmFsc1siUE9TSVhfTUFHSUMiXT1ieXRlcygidXN0YXJceDAwMDAiKTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVs3OSwiX19tYWluX18iXTtOb25lOwpMRU5HVEhfTkFNRT0kZ2xvYmFsc1siTEVOR1RIX05BTUUiXT1OdW1iZXIoMTAwKTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVs4MCwiX19tYWluX18iXTtOb25lOwpMRU5HVEhfTElOSz0kZ2xvYmFsc1siTEVOR1RIX0xJTksiXT1OdW1iZXIoMTAwKTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVs4MSwiX19tYWluX18iXTtOb25lOwpMRU5HVEhfUFJFRklYPSRnbG9iYWxzWyJMRU5HVEhfUFJFRklYIl09TnVtYmVyKDE1NSk7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bODMsIl9fbWFpbl9fIl07Tm9uZTsKUkVHVFlQRT0kZ2xvYmFsc1siUkVHVFlQRSJdPWJ5dGVzKCIwIik7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bODQsIl9fbWFpbl9fIl07Tm9uZTsKQVJFR1RZUEU9JGdsb2JhbHNbIkFSRUdUWVBFIl09Ynl0ZXMoIlwwIik7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bODUsIl9fbWFpbl9fIl07Tm9uZTsKTE5LVFlQRT0kZ2xvYmFsc1siTE5LVFlQRSJdPWJ5dGVzKCIxIik7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bODYsIl9fbWFpbl9fIl07Tm9uZTsKU1lNVFlQRT0kZ2xvYmFsc1siU1lNVFlQRSJdPWJ5dGVzKCIyIik7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bODcsIl9fbWFpbl9fIl07Tm9uZTsKQ0hSVFlQRT0kZ2xvYmFsc1siQ0hSVFlQRSJdPWJ5dGVzKCIzIik7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bODgsIl9fbWFpbl9fIl07Tm9uZTsKQkxLVFlQRT0kZ2xvYmFsc1siQkxLVFlQRSJdPWJ5dGVzKCI0Iik7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bODksIl9fbWFpbl9fIl07Tm9uZTsKRElSVFlQRT0kZ2xvYmFsc1siRElSVFlQRSJdPWJ5dGVzKCI1Iik7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTAsIl9fbWFpbl9fIl07Tm9uZTsKRklGT1RZUEU9JGdsb2JhbHNbIkZJRk9UWVBFIl09Ynl0ZXMoIjYiKTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVs5MSwiX19tYWluX18iXTtOb25lOwpDT05UVFlQRT0kZ2xvYmFsc1siQ09OVFRZUEUiXT1ieXRlcygiNyIpO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzkzLCJfX21haW5fXyJdO05vbmU7CkdOVVRZUEVfTE9OR05BTUU9JGdsb2JhbHNbIkdOVVRZUEVfTE9OR05BTUUiXT1ieXRlcygiTCIpO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89Wzk0LCJfX21haW5fXyJdO05vbmU7CkdOVVRZUEVfTE9OR0xJTks9JGdsb2JhbHNbIkdOVVRZUEVfTE9OR0xJTksiXT1ieXRlcygiSyIpO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89Wzk1LCJfX21haW5fXyJdO05vbmU7CkdOVVRZUEVfU1BBUlNFPSRnbG9iYWxzWyJHTlVUWVBFX1NQQVJTRSJdPWJ5dGVzKCJTIik7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTcsIl9fbWFpbl9fIl07Tm9uZTsKWEhEVFlQRT0kZ2xvYmFsc1siWEhEVFlQRSJdPWJ5dGVzKCJ4Iik7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTgsIl9fbWFpbl9fIl07Tm9uZTsKWEdMVFlQRT0kZ2xvYmFsc1siWEdMVFlQRSJdPWJ5dGVzKCJnIik7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTksIl9fbWFpbl9fIl07Tm9uZTsKU09MQVJJU19YSERUWVBFPSRnbG9iYWxzWyJTT0xBUklTX1hIRFRZUEUiXT1ieXRlcygiWCIpO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzEwMSwiX19tYWluX18iXTtOb25lOwpVU1RBUl9GT1JNQVQ9JGdsb2JhbHNbIlVTVEFSX0ZPUk1BVCJdPU51bWJlcigwKTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVsxMDIsIl9fbWFpbl9fIl07Tm9uZTsKR05VX0ZPUk1BVD0kZ2xvYmFsc1siR05VX0ZPUk1BVCJdPU51bWJlcigxKTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVsxMDMsIl9fbWFpbl9fIl07Tm9uZTsKUEFYX0ZPUk1BVD0kZ2xvYmFsc1siUEFYX0ZPUk1BVCJdPU51bWJlcigyKTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVsxMDQsIl9fbWFpbl9fIl07Tm9uZTsKREVGQVVMVF9GT1JNQVQ9JGdsb2JhbHNbIkRFRkFVTFRfRk9STUFUIl09R05VX0ZPUk1BVDtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVsxMTAsIl9fbWFpbl9fIl07Tm9uZTsKU1VQUE9SVEVEX1RZUEVTPSRnbG9iYWxzWyJTVVBQT1JURURfVFlQRVMiXT10dXBsZShbUkVHVFlQRSxBUkVHVFlQRSxMTktUWVBFLFNZTVRZUEUsRElSVFlQRSxGSUZPVFlQRSxDT05UVFlQRSxDSFJUWVBFLEJMS1RZUEUsR05VVFlQRV9MT05HTkFNRSxHTlVUWVBFX0xPTkdMSU5LLEdOVVRZUEVfU1BBUlNFXSk7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTE3LCJfX21haW5fXyJdO05vbmU7ClJFR1VMQVJfVFlQRVM9JGdsb2JhbHNbIlJFR1VMQVJfVFlQRVMiXT10dXBsZShbUkVHVFlQRSxBUkVHVFlQRSxDT05UVFlQRSxHTlVUWVBFX1NQQVJTRV0pO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzEyMSwiX19tYWluX18iXTtOb25lOwpHTlVfVFlQRVM9JGdsb2JhbHNbIkdOVV9UWVBFUyJdPXR1cGxlKFtHTlVUWVBFX0xPTkdOQU1FLEdOVVRZUEVfTE9OR0xJTkssR05VVFlQRV9TUEFSU0VdKTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVsxMjUsIl9fbWFpbl9fIl07Tm9uZTsKUEFYX0ZJRUxEUz0kZ2xvYmFsc1siUEFYX0ZJRUxEUyJdPXR1cGxlKFsicGF0aCIsImxpbmtwYXRoIiwic2l6ZSIsIm10aW1lIiwidWlkIiwiZ2lkIiwidW5hbWUiLCJnbmFtZSJdKTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVsxMjksIl9fbWFpbl9fIl07Tm9uZTsKUEFYX05BTUVfRklFTERTPSRnbG9iYWxzWyJQQVhfTkFNRV9GSUVMRFMiXT1zZXQoWyJwYXRoIiwibGlua3BhdGgiLCJ1bmFtZSIsImduYW1lIl0pO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzEzMywiX19tYWluX18iXTtOb25lOwpQQVhfTlVNQkVSX0ZJRUxEUz0kZ2xvYmFsc1siUEFYX05VTUJFUl9GSUVMRFMiXT0kZGljdChbWyJhdGltZSIsZmxvYXRdLFsiY3RpbWUiLGZsb2F0XSxbIm10aW1lIixmbG9hdF0sWyJ1aWQiLGludF0sWyJnaWQiLGludF0sWyJzaXplIixpbnRdXSk7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ1LCJfX21haW5fXyJdO05vbmU7ClNfSUZMTks9JGdsb2JhbHNbIlNfSUZMTksiXT1OdW1iZXIoNDA5NjApO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzE0NiwiX19tYWluX18iXTtOb25lOwpTX0lGUkVHPSRnbG9iYWxzWyJTX0lGUkVHIl09TnVtYmVyKDMyNzY4KTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVsxNDcsIl9fbWFpbl9fIl07Tm9uZTsKU19JRkJMSz0kZ2xvYmFsc1siU19JRkJMSyJdPU51bWJlcigyNDU3Nik7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ4LCJfX21haW5fXyJdO05vbmU7ClNfSUZESVI9JGdsb2JhbHNbIlNfSUZESVIiXT1OdW1iZXIoMTYzODQpO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzE0OSwiX19tYWluX18iXTtOb25lOwpTX0lGQ0hSPSRnbG9iYWxzWyJTX0lGQ0hSIl09TnVtYmVyKDgxOTIpO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzE1MCwiX19tYWluX18iXTtOb25lOwpTX0lGSUZPPSRnbG9iYWxzWyJTX0lGSUZPIl09TnVtYmVyKDQwOTYpO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzE1MiwiX19tYWluX18iXTtOb25lOwpUU1VJRD0kZ2xvYmFsc1siVFNVSUQiXT1OdW1iZXIoMjA0OCk7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTUzLCJfX21haW5fXyJdO05vbmU7ClRTR0lEPSRnbG9iYWxzWyJUU0dJRCJdPU51bWJlcigxMDI0KTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVsxNTQsIl9fbWFpbl9fIl07Tm9uZTsKVFNWVFg9JGdsb2JhbHNbIlRTVlRYIl09TnVtYmVyKDUxMik7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTU2LCJfX21haW5fXyJdO05vbmU7ClRVUkVBRD0kZ2xvYmFsc1siVFVSRUFEIl09TnVtYmVyKDI1Nik7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTU3LCJfX21haW5fXyJdO05vbmU7ClRVV1JJVEU9JGdsb2JhbHNbIlRVV1JJVEUiXT1OdW1iZXIoMTI4KTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVsxNTgsIl9fbWFpbl9fIl07Tm9uZTsKVFVFWEVDPSRnbG9iYWxzWyJUVUVYRUMiXT1OdW1iZXIoNjQpO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzE1OSwiX19tYWluX18iXTtOb25lOwpUR1JFQUQ9JGdsb2JhbHNbIlRHUkVBRCJdPU51bWJlcigzMik7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTYwLCJfX21haW5fXyJdO05vbmU7ClRHV1JJVEU9JGdsb2JhbHNbIlRHV1JJVEUiXT1OdW1iZXIoMTYpO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzE2MSwiX19tYWluX18iXTtOb25lOwpUR0VYRUM9JGdsb2JhbHNbIlRHRVhFQyJdPU51bWJlcig4KTtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVsxNjIsIl9fbWFpbl9fIl07Tm9uZTsKVE9SRUFEPSRnbG9iYWxzWyJUT1JFQUQiXT1OdW1iZXIoNCk7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTYzLCJfX21haW5fXyJdO05vbmU7ClRPV1JJVEU9JGdsb2JhbHNbIlRPV1JJVEUiXT1OdW1iZXIoMik7Tm9uZTsKZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTY0LCJfX21haW5fXyJdO05vbmU7ClRPRVhFQz0kZ2xvYmFsc1siVE9FWEVDIl09TnVtYmVyKDEpO05vbmU7CmRvY3VtZW50LiRsaW5lX2luZm89WzE2OSwiX19tYWluX18iXTtOb25lOwppZihib29sKGdldGF0dHIoZ2V0YXR0cihvcywibmFtZSIpLCJfX2luX18iKSh0dXBsZShbIm50IiwiY2UiXSkpKSl7CiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzAsIl9fbWFpbl9fIl07Tm9uZTsKICAgIEVOQ09ESU5HPSRnbG9iYWxzWyJFTkNPRElORyJdPSJ1dGYtOCI7Tm9uZTsKfQplbHNlewogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTcyLCJfX21haW5fXyJdO05vbmU7CiAgICBFTkNPRElORz0kZ2xvYmFsc1siRU5DT0RJTkciXT1nZXRhdHRyKGdldGF0dHIoc3lzLCJnZXRmaWxlc3lzdGVtZW5jb2RpbmciKSwiX19jYWxsX18iKSgpO05vbmU7Cn0KZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTc4LCJfX21haW5fXyJdO05vbmU7CnZhciBzdG49IChmdW5jdGlvbiAoKXsKICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgIHRyeXsKICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoInN0biIsYXJndW1lbnRzLFsicyIsImxlbmd0aCIsImVuY29kaW5nIiwiZXJyb3JzIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsibzh3OHNlMGoiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTc5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICJDb252ZXJ0IGEgc3RyaW5nIHRvIGEgbnVsbC10ZXJtaW5hdGVkIGJ5dGVzIG9iamVjdC5cblwKICAgICIKICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTgxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgIHZhciBzPSRsb2NhbHNbInMiXT1nZXRhdHRyKGdldGF0dHIocywiZW5jb2RlIiksIl9fY2FsbF9fIikoZW5jb2RpbmcsZXJyb3JzKTtOb25lOwogICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoZ2V0YXR0cihzLCJfX2dldGl0ZW1fXyIpKHNsaWNlKG51bGwsbGVuZ3RoKSksIl9fYWRkX18iKShnZXRhdHRyKGdldGF0dHIobGVuZ3RoLCJfX3N1Yl9fIikoZ2V0YXR0cihsZW4sIl9fY2FsbF9fIikocykpLCJfX211bF9fIikoTlVMKSkKICAgICAgICB9CiAgICAgICAgY2F0Y2goZXJyMTE0Nyl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNDcpfQogICAgfQp9CikoKQpzdG4uX19uYW1lX189InN0biIKd2luZG93LnN0bj1zdG4KJGdsb2JhbHNbInN0biJdPXN0bjtzdG4uJHR5cGU9J2Z1bmN0aW9uJwpzdG4uX19tb2R1bGVfXyA9ICJfX21haW5fXyIKc3RuLl9fZG9jX189IkNvbnZlcnQgYSBzdHJpbmcgdG8gYSBudWxsLXRlcm1pbmF0ZWQgYnl0ZXMgb2JqZWN0LlxuXAogICAgIgpkb2N1bWVudC4kbGluZV9pbmZvPVsxODQsIl9fbWFpbl9fIl07Tm9uZTsKdmFyIG50cz0gKGZ1bmN0aW9uICgpewogICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgdHJ5ewogICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygibnRzIixhcmd1bWVudHMsWyJzIiwiZW5jb2RpbmciLCJlcnJvcnMiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJnODVwNWJwMiJdLl9fZGljdF9fPSRucwogICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgIkNvbnZlcnQgYSBudWxsLXRlcm1pbmF0ZWQgYnl0ZXMgb2JqZWN0IHRvIGEgc3RyaW5nLlxuXAogICAgIgogICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgdmFyIHA9JGxvY2Fsc1sicCJdPWdldGF0dHIoZ2V0YXR0cihzLCJmaW5kIiksIl9fY2FsbF9fIikoYnl0ZXMoIlwwIikpO05vbmU7CiAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICBpZihib29sKGdldGF0dHIocCwiX19uZV9fIikoTnVtYmVyKC0xKSkpKXsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIHM9JGxvY2Fsc1sicyJdPWdldGF0dHIocywiX19nZXRpdGVtX18iKShzbGljZShudWxsLHApKTtOb25lOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICByZXR1cm4gZ2V0YXR0cihnZXRhdHRyKHMsImRlY29kZSIpLCJfX2NhbGxfXyIpKGVuY29kaW5nLGVycm9ycykKICAgICAgICB9CiAgICAgICAgY2F0Y2goZXJyMTE0Nyl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNDcpfQogICAgfQp9CikoKQpudHMuX19uYW1lX189Im50cyIKd2luZG93Lm50cz1udHMKJGdsb2JhbHNbIm50cyJdPW50cztudHMuJHR5cGU9J2Z1bmN0aW9uJwpudHMuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKbnRzLl9fZG9jX189IkNvbnZlcnQgYSBudWxsLXRlcm1pbmF0ZWQgYnl0ZXMgb2JqZWN0IHRvIGEgc3RyaW5nLlxuXAogICAgIgpkb2N1bWVudC4kbGluZV9pbmZvPVsxOTIsIl9fbWFpbl9fIl07Tm9uZTsKdmFyIG50aT0gKGZ1bmN0aW9uICgpewogICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgdHJ5ewogICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygibnRpIixhcmd1bWVudHMsWyJzIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiYzh0NHdzOGoiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTkzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICJDb252ZXJ0IGEgbnVtYmVyIGZpZWxkIHRvIGEgcHl0aG9uIG51bWJlci5cblwKICAgICIKICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTk3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKHMsIl9fZ2V0aXRlbV9fIikoTnVtYmVyKDApKSwiX19pbl9fIikodHVwbGUoW051bWJlcigxMjgpLE51bWJlcigyNTUpXSkpKSl7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBuPSRsb2NhbHNbIm4iXT1OdW1iZXIoMCk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyICRuZXh0MTE0Nz1nZXRhdHRyKGl0ZXIoZ2V0YXR0cihyYW5nZSwiX19jYWxsX18iKShnZXRhdHRyKGdldGF0dHIobGVuLCJfX2NhbGxfXyIpKHMpLCJfX3N1Yl9fIikoTnVtYmVyKDEpKSkpLCJfX25leHRfXyIpCiAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTE0Nz10cnVlO3doaWxlKHRydWUpewogICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGk9JGxvY2Fsc1siaSJdPSRuZXh0MTE0NygpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIpe2lmKCRpc19leGMoJGVycixbU3RvcEl0ZXJhdGlvbl0pKXskcG9wX2V4YygpO2JyZWFrfWVsc2V7dGhyb3coJGVycil9fQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwMCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciAkdGVtcD0kbG9jYWxzWyIkdGVtcCJdPU51bWJlcig4KTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKCFoYXNhdHRyKG4sIl9faWxzaGlmdF9fIikpewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbj0kbG9jYWxzWyJuIl09Z2V0YXR0cihuLCJfX2xzaGlmdF9fIikoJHRlbXApO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIG49Z2V0YXR0cihuLCJfX2lsc2hpZnRfXyIpKCR0ZW1wKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMDEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgJHRlbXA9JGxvY2Fsc1siJHRlbXAiXT1nZXRhdHRyKHMsIl9fZ2V0aXRlbV9fIikoZ2V0YXR0cihpLCJfX2FkZF9fIikoTnVtYmVyKDEpKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZigkdGVtcC4kZmFzdF9hdWdtICYmIG4uJGZhc3RfYXVnbSl7bis9JHRlbXA7JGxvY2Fsc1sibiJdPW59CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZighaGFzYXR0cihuLCJfX2lhZGRfXyIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG49JGxvY2Fsc1sibiJdPWdldGF0dHIobiwiX19hZGRfXyIpKCR0ZW1wKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBuPSRsb2NhbHNbIm4iXT1nZXRhdHRyKG4sIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjAyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cihzLCJfX2dldGl0ZW1fXyIpKE51bWJlcigwKSksIl9fZXFfXyIpKE51bWJlcigyNTUpKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwMywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBuPSRsb2NhbHNbIm4iXT1nZXRhdHRyKC0sIl9fY2FsbF9fIikoZ2V0YXR0cihnZXRhdHRyKE51bWJlcigyNTYpLCJfX3Bvd19fIikoZ2V0YXR0cihnZXRhdHRyKGxlbiwiX19jYWxsX18iKShzKSwiX19zdWJfXyIpKE51bWJlcigxKSkpLCJfX3N1Yl9fIikobikpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwNSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgJGZhaWxlZDExNDg9ZmFsc2U7dHJ5ewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwNiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBuPSRsb2NhbHNbIm4iXT1nZXRhdHRyKGludCwiX19jYWxsX18iKSgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oZ2V0YXR0cihudHMsIl9fY2FsbF9fIikocywiYXNjaWkiLCJzdHJpY3QiKSl8fCR0ZXN0X2l0ZW0oIjAiKSksTnVtYmVyKDgpKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2goJGVycjExNDgpewogICAgICAgICAgICAgICAgICAgIHZhciAkZmFpbGVkMTE0OD10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoJGlzX2V4YygkZXJyMTE0OCxbVmFsdWVFcnJvcl0pKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjA4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGdldGF0dHIoSW52YWxpZEhlYWRlckVycm9yLCJfX2NhbGxfXyIpKCJpbnZhbGlkIGhlYWRlciIpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2V7dGhyb3cgJGVycjExNDh9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjA5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgIHJldHVybiBuCiAgICAgICAgfQogICAgICAgIGNhdGNoKGVycjExNDcpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTQ3KX0KICAgIH0KfQopKCkKbnRpLl9fbmFtZV9fPSJudGkiCndpbmRvdy5udGk9bnRpCiRnbG9iYWxzWyJudGkiXT1udGk7bnRpLiR0eXBlPSdmdW5jdGlvbicKbnRpLl9fbW9kdWxlX18gPSAiX19tYWluX18iCm50aS5fX2RvY19fPSJDb252ZXJ0IGEgbnVtYmVyIGZpZWxkIHRvIGEgcHl0aG9uIG51bWJlci5cblwKICAgICIKZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjExLCJfX21haW5fXyJdO05vbmU7CnZhciBpdG49IChmdW5jdGlvbiAoREVGQVVMVF9GT1JNQVQpewogICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgdHJ5ewogICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiaXRuIixhcmd1bWVudHMsWyJuIl0seyJkaWdpdHMiOk51bWJlcig4KSwiZm9ybWF0IjpERUZBVUxUX0ZPUk1BVH0sbnVsbCxudWxsKQogICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiYXdwenJxbmgiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjEyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICJDb252ZXJ0IGEgcHl0aG9uIG51bWJlciB0byBhIG51bWJlciBmaWVsZC5cblwKICAgICIKICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjIyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgIGlmKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKGdldGF0dHIoTnVtYmVyKDApLCJfX2xlX18iKShuKSkmJiR0ZXN0X2l0ZW0oZ2V0YXR0cihuLCJfX2x0X18iKShnZXRhdHRyKE51bWJlcig4KSwiX19wb3dfXyIpKGdldGF0dHIoZGlnaXRzLCJfX3N1Yl9fIikoTnVtYmVyKDEpKSkpKSkpKXsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyMywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIHM9JGxvY2Fsc1sicyJdPWdldGF0dHIoZ2V0YXR0cihieXRlcywiX19jYWxsX18iKShnZXRhdHRyKCIlMCpvIiwiX19tb2RfXyIpKHR1cGxlKFtnZXRhdHRyKGRpZ2l0cywiX19zdWJfXyIpKE51bWJlcigxKSksbl0pKSwiYXNjaWkiKSwiX19hZGRfXyIpKE5VTCk7Tm9uZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKGdldGF0dHIoZm9ybWF0LCJfX2VxX18iKShHTlVfRk9STUFUKSkmJiR0ZXN0X2l0ZW0oJHRlc3RfZXhwcigkdGVzdF9pdGVtKGdldGF0dHIoZ2V0YXR0cihOdW1iZXIoLTI1NiksIl9fcG93X18iKShnZXRhdHRyKGRpZ2l0cywiX19zdWJfXyIpKE51bWJlcigxKSkpLCJfX2xlX18iKShuKSkmJiR0ZXN0X2l0ZW0oZ2V0YXR0cihuLCJfX2x0X18iKShnZXRhdHRyKE51bWJlcigyNTYpLCJfX3Bvd19fIikoZ2V0YXR0cihkaWdpdHMsIl9fc3ViX18iKShOdW1iZXIoMSkpKSkpKSkpKSl7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihuLCJfX2dlX18iKShOdW1iZXIoMCkpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjI2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHM9JGxvY2Fsc1sicyJdPWdldGF0dHIoYnl0ZWFycmF5LCJfX2NhbGxfXyIpKGxpc3QuX19jYWxsX18oW051bWJlcigxMjgpXSkpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyOCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBzPSRsb2NhbHNbInMiXT1nZXRhdHRyKGJ5dGVhcnJheSwiX19jYWxsX18iKShsaXN0Ll9fY2FsbF9fKFtOdW1iZXIoMjU1KV0pKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBuPSRsb2NhbHNbIm4iXT1nZXRhdHRyKGdldGF0dHIoTnVtYmVyKDI1NiksIl9fcG93X18iKShkaWdpdHMpLCJfX2FkZF9fIikobik7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzMSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyICRuZXh0MTE0OT1nZXRhdHRyKGl0ZXIoZ2V0YXR0cihyYW5nZSwiX19jYWxsX18iKShnZXRhdHRyKGRpZ2l0cywiX19zdWJfXyIpKE51bWJlcigxKSkpKSwiX19uZXh0X18iKQogICAgICAgICAgICAgICAgdmFyICRub19icmVhazExNDk9dHJ1ZTt3aGlsZSh0cnVlKXsKICAgICAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpPSRsb2NhbHNbImkiXT0kbmV4dDExNDkoKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyKXtpZigkaXNfZXhjKCRlcnIsW1N0b3BJdGVyYXRpb25dKSl7JHBvcF9leGMoKTticmVha31lbHNle3Rocm93KCRlcnIpfX0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIocywiaW5zZXJ0IiksIl9fY2FsbF9fIikoTnVtYmVyKDEpLGdldGF0dHIobiwiX19hbmRfXyIpKE51bWJlcigyNTUpKSkKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgJHRlbXA9JGxvY2Fsc1siJHRlbXAiXT1OdW1iZXIoOCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZighaGFzYXR0cihuLCJfX2lyc2hpZnRfXyIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG49JGxvY2Fsc1sibiJdPWdldGF0dHIobiwiX19yc2hpZnRfXyIpKCR0ZW1wKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBuPWdldGF0dHIobiwiX19pcnNoaWZ0X18iKSgkdGVtcCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzNSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihWYWx1ZUVycm9yLCJfX2NhbGxfXyIpKCJvdmVyZmxvdyBpbiBudW1iZXIgZmllbGQiKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzNywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICByZXR1cm4gcwogICAgICAgIH0KICAgICAgICBjYXRjaChlcnIxMTQ5KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE0OSl9CiAgICB9Cn0KKSgkY2xhc3MuREVGQVVMVF9GT1JNQVQgIT0gdW5kZWZpbmVkID8gJGNsYXNzLkRFRkFVTFRfRk9STUFUIDogREVGQVVMVF9GT1JNQVQpCml0bi5fX25hbWVfXz0iaXRuIgp3aW5kb3cuaXRuPWl0bgokZ2xvYmFsc1siaXRuIl09aXRuO2l0bi4kdHlwZT0nZnVuY3Rpb24nCml0bi5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgppdG4uX19kb2NfXz0iQ29udmVydCBhIHB5dGhvbiBudW1iZXIgdG8gYSBudW1iZXIgZmllbGQuXG5cCiAgICAiCmRvY3VtZW50LiRsaW5lX2luZm89WzIzOSwiX19tYWluX18iXTtOb25lOwp2YXIgY2FsY19jaGtzdW1zPSAoZnVuY3Rpb24gKCl7CiAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICB0cnl7CiAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJjYWxjX2Noa3N1bXMiLGFyZ3VtZW50cyxbImJ1ZiJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImpqcXh4aDhpIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzI0MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAiQ2FsY3VsYXRlIHRoZSBjaGVja3N1bSBmb3IgYSBtZW1iZXIncyBoZWFkZXIgYnkgc3VtbWluZyB1cCBhbGxcblwKICAgICAgIGNoYXJhY3RlcnMgZXhjZXB0IGZvciB0aGUgY2hrc3VtIGZpZWxkIHdoaWNoIGlzIHRyZWF0ZWQgYXMgaWZcblwKICAgICAgIGl0IHdhcyBmaWxsZWQgd2l0aCBzcGFjZXMuIEFjY29yZGluZyB0byB0aGUgR05VIHRhciBzb3VyY2VzLFxuXAogICAgICAgc29tZSB0YXJzIChTdW4gYW5kIE5lWFQpIGNhbGN1bGF0ZSBjaGtzdW0gd2l0aCBzaWduZWQgY2hhcixcblwKICAgICAgIHdoaWNoIHdpbGwgYmUgZGlmZmVyZW50IGlmIHRoZXJlIGFyZSBjaGFycyBpbiB0aGUgYnVmZmVyIHdpdGhcblwKICAgICAgIHRoZSBoaWdoIGJpdCBzZXQuIFNvIHdlIGNhbGN1bGF0ZSB0d28gY2hlY2tzdW1zLCB1bnNpZ25lZCBhbmRcblwKICAgICAgIHNpZ25lZC5cblwKICAgICIKICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjQ4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgIHZhciB1bnNpZ25lZF9jaGtzdW09JGxvY2Fsc1sidW5zaWduZWRfY2hrc3VtIl09Z2V0YXR0cihOdW1iZXIoMjU2KSwiX19hZGRfXyIpKGdldGF0dHIoc3VtLCJfX2NhbGxfXyIpKGdldGF0dHIoZ2V0YXR0cihzdHJ1Y3QsInVucGFja19mcm9tIiksIl9fY2FsbF9fIikoIjE0OEI4eDM1NkIiLGJ1ZikpKTtOb25lOwogICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyNDksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgdmFyIHNpZ25lZF9jaGtzdW09JGxvY2Fsc1sic2lnbmVkX2Noa3N1bSJdPWdldGF0dHIoTnVtYmVyKDI1NiksIl9fYWRkX18iKShnZXRhdHRyKHN1bSwiX19jYWxsX18iKShnZXRhdHRyKGdldGF0dHIoc3RydWN0LCJ1bnBhY2tfZnJvbSIpLCJfX2NhbGxfXyIpKCIxNDhiOHgzNTZiIixidWYpKSk7Tm9uZTsKICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjUwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgIHJldHVybiB0dXBsZShbdW5zaWduZWRfY2hrc3VtLHNpZ25lZF9jaGtzdW1dKQogICAgICAgIH0KICAgICAgICBjYXRjaChlcnIxMTUwKXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE1MCl9CiAgICB9Cn0KKSgpCmNhbGNfY2hrc3Vtcy5fX25hbWVfXz0iY2FsY19jaGtzdW1zIgp3aW5kb3cuY2FsY19jaGtzdW1zPWNhbGNfY2hrc3VtcwokZ2xvYmFsc1siY2FsY19jaGtzdW1zIl09Y2FsY19jaGtzdW1zO2NhbGNfY2hrc3Vtcy4kdHlwZT0nZnVuY3Rpb24nCmNhbGNfY2hrc3Vtcy5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgpjYWxjX2Noa3N1bXMuX19kb2NfXz0iQ2FsY3VsYXRlIHRoZSBjaGVja3N1bSBmb3IgYSBtZW1iZXIncyBoZWFkZXIgYnkgc3VtbWluZyB1cCBhbGxcblwKICAgICAgIGNoYXJhY3RlcnMgZXhjZXB0IGZvciB0aGUgY2hrc3VtIGZpZWxkIHdoaWNoIGlzIHRyZWF0ZWQgYXMgaWZcblwKICAgICAgIGl0IHdhcyBmaWxsZWQgd2l0aCBzcGFjZXMuIEFjY29yZGluZyB0byB0aGUgR05VIHRhciBzb3VyY2VzLFxuXAogICAgICAgc29tZSB0YXJzIChTdW4gYW5kIE5lWFQpIGNhbGN1bGF0ZSBjaGtzdW0gd2l0aCBzaWduZWQgY2hhcixcblwKICAgICAgIHdoaWNoIHdpbGwgYmUgZGlmZmVyZW50IGlmIHRoZXJlIGFyZSBjaGFycyBpbiB0aGUgYnVmZmVyIHdpdGhcblwKICAgICAgIHRoZSBoaWdoIGJpdCBzZXQuIFNvIHdlIGNhbGN1bGF0ZSB0d28gY2hlY2tzdW1zLCB1bnNpZ25lZCBhbmRcblwKICAgICAgIHNpZ25lZC5cblwKICAgICIKZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjUyLCJfX21haW5fXyJdO05vbmU7CnZhciBjb3B5ZmlsZW9iaj0gKGZ1bmN0aW9uIChOb25lKXsKICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgIHRyeXsKICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoImNvcHlmaWxlb2JqIixhcmd1bWVudHMsWyJzcmMiLCJkc3QiXSx7Imxlbmd0aCI6Tm9uZX0sbnVsbCxudWxsKQogICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiYXluMWZyeWwiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjUzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICJDb3B5IGxlbmd0aCBieXRlcyBmcm9tIGZpbGVvYmogc3JjIHRvIGZpbGVvYmogZHN0LlxuXAogICAgICAgSWYgbGVuZ3RoIGlzIE5vbmUsIGNvcHkgdGhlIGVudGlyZSBjb250ZW50LlxuXAogICAgIgogICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyNTYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGxlbmd0aCwiX19lcV9fIikoTnVtYmVyKDApKSkpewogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjU3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjU4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgIGlmKGJvb2wobGVuZ3RoPT09Tm9uZSkpewogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjU5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2h1dGlsLCJjb3B5ZmlsZW9iaiIpLCJfX2NhbGxfXyIpKHNyYyxkc3QpCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyNjAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiAKICAgICAgICAgICAgfQogICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyNjIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgdmFyIEJVRlNJWkU9JGxvY2Fsc1siQlVGU0laRSJdPWdldGF0dHIoTnVtYmVyKDE2KSwiX19tdWxfXyIpKE51bWJlcigxMDI0KSk7Tm9uZTsKICAgICAgICAgICAgJHJpZ2h0PWl0ZXIoZ2V0YXR0cihkaXZtb2QsIl9fY2FsbF9fIikobGVuZ3RoLEJVRlNJWkUpKTskY291bnRlcj0tMQogICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyNjMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgdmFyIGJsb2Nrcz0kbG9jYWxzWyJibG9ja3MiXT1uZXh0KCRyaWdodCk7Tm9uZTsKICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgIHZhciByZW1haW5kZXI9JGxvY2Fsc1sicmVtYWluZGVyIl09bmV4dCgkcmlnaHQpO05vbmU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goJGVycjExNTApewogICAgICAgICAgICAgICAgaWYoJGVycjExNTAuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKTt0aHJvdyBWYWx1ZUVycm9yKCJuZWVkIG1vcmUgdGhhbiAiKyRjb3VudGVyKyIgdmFsdWUiKygkY291bnRlcj4xID8gInMiIDogIiIpKyIgdG8gdW5wYWNrIil9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyICRleGhhdXN0ZWQ9dHJ1ZTt0cnl7bmV4dCgkcmlnaHQpOyRleGhhdXN0ZWQ9ZmFsc2V9Y2F0Y2goZXJyKXtpZihlcnIuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKX19aWYoISRleGhhdXN0ZWQpe3Rocm93IFZhbHVlRXJyb3IoInRvbyBtYW55IHZhbHVlcyB0byB1bnBhY2sgKGV4cGVjdGVkICIrKCRjb3VudGVyKzEpKyIpIil9CiAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzI2NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICB2YXIgJG5leHQxMTUxPWdldGF0dHIoaXRlcihnZXRhdHRyKHJhbmdlLCJfX2NhbGxfXyIpKGJsb2NrcykpLCJfX25leHRfXyIpCiAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMTUxPXRydWU7d2hpbGUodHJ1ZSl7CiAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgdmFyIGI9JGxvY2Fsc1siYiJdPSRuZXh0MTE1MSgpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCgkZXJyKXtpZigkaXNfZXhjKCRlcnIsW1N0b3BJdGVyYXRpb25dKSl7JHBvcF9leGMoKTticmVha31lbHNle3Rocm93KCRlcnIpfX0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzI2NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIGJ1Zj0kbG9jYWxzWyJidWYiXT1nZXRhdHRyKGdldGF0dHIoc3JjLCJyZWFkIiksIl9fY2FsbF9fIikoQlVGU0laRSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzI2NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIobGVuLCJfX2NhbGxfXyIpKGJ1ZiksIl9fbHRfXyIpKEJVRlNJWkUpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjY3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihJT0Vycm9yLCJfX2NhbGxfXyIpKCJlbmQgb2YgZmlsZSByZWFjaGVkIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzI2OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGRzdCwid3JpdGUiKSwiX19jYWxsX18iKShidWYpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjcwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihyZW1haW5kZXIsIl9fbmVfXyIpKE51bWJlcigwKSkpKXsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzI3MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIGJ1Zj0kbG9jYWxzWyJidWYiXT1nZXRhdHRyKGdldGF0dHIoc3JjLCJyZWFkIiksIl9fY2FsbF9fIikocmVtYWluZGVyKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjcyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cihsZW4sIl9fY2FsbF9fIikoYnVmKSwiX19sdF9fIikocmVtYWluZGVyKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzI3MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHRocm93IGdldGF0dHIoSU9FcnJvciwiX19jYWxsX18iKSgiZW5kIG9mIGZpbGUgcmVhY2hlZCIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyNzQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihkc3QsIndyaXRlIiksIl9fY2FsbF9fIikoYnVmKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzI3NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICByZXR1cm4gCiAgICAgICAgfQogICAgICAgIGNhdGNoKGVycjExNTApe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTUwKX0KICAgIH0KfQopKCRjbGFzcy5Ob25lICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5Ob25lIDogTm9uZSkKY29weWZpbGVvYmouX19uYW1lX189ImNvcHlmaWxlb2JqIgp3aW5kb3cuY29weWZpbGVvYmo9Y29weWZpbGVvYmoKJGdsb2JhbHNbImNvcHlmaWxlb2JqIl09Y29weWZpbGVvYmo7Y29weWZpbGVvYmouJHR5cGU9J2Z1bmN0aW9uJwpjb3B5ZmlsZW9iai5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgpjb3B5ZmlsZW9iai5fX2RvY19fPSJDb3B5IGxlbmd0aCBieXRlcyBmcm9tIGZpbGVvYmogc3JjIHRvIGZpbGVvYmogZHN0LlxuXAogICAgICAgSWYgbGVuZ3RoIGlzIE5vbmUsIGNvcHkgdGhlIGVudGlyZSBjb250ZW50LlxuXAogICAgIgpkb2N1bWVudC4kbGluZV9pbmZvPVsyNzcsIl9fbWFpbl9fIl07Tm9uZTsKdmFyIGZpbGVtb2RlPSAoZnVuY3Rpb24gKCl7CiAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICB0cnl7CiAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJmaWxlbW9kZSIsYXJndW1lbnRzLFsibW9kZSJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbIjFrejg5NDYwIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzI3OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAiRGVwcmVjYXRlZCBpbiB0aGlzIGxvY2F0aW9uOyB1c2Ugc3RhdC5maWxlbW9kZS4iCiAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzI3OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAkaW1wb3J0X2xpc3QoWyJ3YXJuaW5ncyJdKTt2YXIgd2FybmluZ3M9JGxvY2Fsc1sid2FybmluZ3MiXT1fX0JSWVRIT05fXy5pbXBvcnRlZFsid2FybmluZ3MiXTtOb25lOwogICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyODAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHdhcm5pbmdzLCJ3YXJuIiksIl9fY2FsbF9fIikoImRlcHJlY2F0ZWQgaW4gZmF2b3Igb2Ygc3RhdC5maWxlbW9kZSIsRGVwcmVjYXRpb25XYXJuaW5nLE51bWJlcigyKSkKICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjgyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgIHJldHVybiBnZXRhdHRyKGdldGF0dHIoc3RhdCwiZmlsZW1vZGUiKSwiX19jYWxsX18iKShtb2RlKQogICAgICAgIH0KICAgICAgICBjYXRjaChlcnIxMTUyKXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE1Mil9CiAgICB9Cn0KKSgpCmZpbGVtb2RlLl9fbmFtZV9fPSJmaWxlbW9kZSIKd2luZG93LmZpbGVtb2RlPWZpbGVtb2RlCiRnbG9iYWxzWyJmaWxlbW9kZSJdPWZpbGVtb2RlO2ZpbGVtb2RlLiR0eXBlPSdmdW5jdGlvbicKZmlsZW1vZGUuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKZmlsZW1vZGUuX19kb2NfXz0iRGVwcmVjYXRlZCBpbiB0aGlzIGxvY2F0aW9uOyB1c2Ugc3RhdC5maWxlbW9kZS4iCmRvY3VtZW50LiRsaW5lX2luZm89WzI4NSwiX19tYWluX18iXTtOb25lOwp2YXIgJFRhckVycm9yPShmdW5jdGlvbigpewogICAgdmFyICRjbGFzcyA9IG5ldyBPYmplY3QoKQogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjg2LCJfX21haW5fXyJdO05vbmU7CiAgICAiQmFzZSBleGNlcHRpb24uIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjg3LCJfX21haW5fXyJdO05vbmU7CiAgICB2b2lkKDApCiAgICByZXR1cm4gJGNsYXNzCn0KKSgpCiRUYXJFcnJvci5fX2RvY19fPSJCYXNlIGV4Y2VwdGlvbi4iCiRUYXJFcnJvci5fX21vZHVsZV9fPSJfX21haW5fXyIKdmFyIFRhckVycm9yPSRjbGFzc19jb25zdHJ1Y3RvcigiVGFyRXJyb3IiLCRUYXJFcnJvcixFeGNlcHRpb24pCndpbmRvdy5UYXJFcnJvcj1UYXJFcnJvcgpfX0JSWVRIT05fXy5zY29wZVsiX19tYWluX18iXS5fX2RpY3RfX1siVGFyRXJyb3IiXT1UYXJFcnJvcgpkb2N1bWVudC4kbGluZV9pbmZvPVsyODgsIl9fbWFpbl9fIl07Tm9uZTsKdmFyICRFeHRyYWN0RXJyb3I9KGZ1bmN0aW9uKCl7CiAgICB2YXIgJGNsYXNzID0gbmV3IE9iamVjdCgpCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyODksIl9fbWFpbl9fIl07Tm9uZTsKICAgICJHZW5lcmFsIGV4Y2VwdGlvbiBmb3IgZXh0cmFjdCBlcnJvcnMuIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjkwLCJfX21haW5fXyJdO05vbmU7CiAgICB2b2lkKDApCiAgICByZXR1cm4gJGNsYXNzCn0KKSgpCiRFeHRyYWN0RXJyb3IuX19kb2NfXz0iR2VuZXJhbCBleGNlcHRpb24gZm9yIGV4dHJhY3QgZXJyb3JzLiIKJEV4dHJhY3RFcnJvci5fX21vZHVsZV9fPSJfX21haW5fXyIKdmFyIEV4dHJhY3RFcnJvcj0kY2xhc3NfY29uc3RydWN0b3IoIkV4dHJhY3RFcnJvciIsJEV4dHJhY3RFcnJvcixUYXJFcnJvcikKd2luZG93LkV4dHJhY3RFcnJvcj1FeHRyYWN0RXJyb3IKX19CUllUSE9OX18uc2NvcGVbIl9fbWFpbl9fIl0uX19kaWN0X19bIkV4dHJhY3RFcnJvciJdPUV4dHJhY3RFcnJvcgpkb2N1bWVudC4kbGluZV9pbmZvPVsyOTEsIl9fbWFpbl9fIl07Tm9uZTsKdmFyICRSZWFkRXJyb3I9KGZ1bmN0aW9uKCl7CiAgICB2YXIgJGNsYXNzID0gbmV3IE9iamVjdCgpCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyOTIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICJFeGNlcHRpb24gZm9yIHVucmVhZGJsZSB0YXIgYXJjaGl2ZXMuIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjkzLCJfX21haW5fXyJdO05vbmU7CiAgICB2b2lkKDApCiAgICByZXR1cm4gJGNsYXNzCn0KKSgpCiRSZWFkRXJyb3IuX19kb2NfXz0iRXhjZXB0aW9uIGZvciB1bnJlYWRibGUgdGFyIGFyY2hpdmVzLiIKJFJlYWRFcnJvci5fX21vZHVsZV9fPSJfX21haW5fXyIKdmFyIFJlYWRFcnJvcj0kY2xhc3NfY29uc3RydWN0b3IoIlJlYWRFcnJvciIsJFJlYWRFcnJvcixUYXJFcnJvcikKd2luZG93LlJlYWRFcnJvcj1SZWFkRXJyb3IKX19CUllUSE9OX18uc2NvcGVbIl9fbWFpbl9fIl0uX19kaWN0X19bIlJlYWRFcnJvciJdPVJlYWRFcnJvcgpkb2N1bWVudC4kbGluZV9pbmZvPVsyOTQsIl9fbWFpbl9fIl07Tm9uZTsKdmFyICRDb21wcmVzc2lvbkVycm9yPShmdW5jdGlvbigpewogICAgdmFyICRjbGFzcyA9IG5ldyBPYmplY3QoKQogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjk1LCJfX21haW5fXyJdO05vbmU7CiAgICAiRXhjZXB0aW9uIGZvciB1bmF2YWlsYWJsZSBjb21wcmVzc2lvbiBtZXRob2RzLiIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzI5NiwiX19tYWluX18iXTtOb25lOwogICAgdm9pZCgwKQogICAgcmV0dXJuICRjbGFzcwp9CikoKQokQ29tcHJlc3Npb25FcnJvci5fX2RvY19fPSJFeGNlcHRpb24gZm9yIHVuYXZhaWxhYmxlIGNvbXByZXNzaW9uIG1ldGhvZHMuIgokQ29tcHJlc3Npb25FcnJvci5fX21vZHVsZV9fPSJfX21haW5fXyIKdmFyIENvbXByZXNzaW9uRXJyb3I9JGNsYXNzX2NvbnN0cnVjdG9yKCJDb21wcmVzc2lvbkVycm9yIiwkQ29tcHJlc3Npb25FcnJvcixUYXJFcnJvcikKd2luZG93LkNvbXByZXNzaW9uRXJyb3I9Q29tcHJlc3Npb25FcnJvcgpfX0JSWVRIT05fXy5zY29wZVsiX19tYWluX18iXS5fX2RpY3RfX1siQ29tcHJlc3Npb25FcnJvciJdPUNvbXByZXNzaW9uRXJyb3IKZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjk3LCJfX21haW5fXyJdO05vbmU7CnZhciAkU3RyZWFtRXJyb3I9KGZ1bmN0aW9uKCl7CiAgICB2YXIgJGNsYXNzID0gbmV3IE9iamVjdCgpCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyOTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICJFeGNlcHRpb24gZm9yIHVuc3VwcG9ydGVkIG9wZXJhdGlvbnMgb24gc3RyZWFtLWxpa2UgVGFyRmlsZXMuIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjk5LCJfX21haW5fXyJdO05vbmU7CiAgICB2b2lkKDApCiAgICByZXR1cm4gJGNsYXNzCn0KKSgpCiRTdHJlYW1FcnJvci5fX2RvY19fPSJFeGNlcHRpb24gZm9yIHVuc3VwcG9ydGVkIG9wZXJhdGlvbnMgb24gc3RyZWFtLWxpa2UgVGFyRmlsZXMuIgokU3RyZWFtRXJyb3IuX19tb2R1bGVfXz0iX19tYWluX18iCnZhciBTdHJlYW1FcnJvcj0kY2xhc3NfY29uc3RydWN0b3IoIlN0cmVhbUVycm9yIiwkU3RyZWFtRXJyb3IsVGFyRXJyb3IpCndpbmRvdy5TdHJlYW1FcnJvcj1TdHJlYW1FcnJvcgpfX0JSWVRIT05fXy5zY29wZVsiX19tYWluX18iXS5fX2RpY3RfX1siU3RyZWFtRXJyb3IiXT1TdHJlYW1FcnJvcgpkb2N1bWVudC4kbGluZV9pbmZvPVszMDAsIl9fbWFpbl9fIl07Tm9uZTsKdmFyICRIZWFkZXJFcnJvcj0oZnVuY3Rpb24oKXsKICAgIHZhciAkY2xhc3MgPSBuZXcgT2JqZWN0KCkKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzMwMSwiX19tYWluX18iXTtOb25lOwogICAgIkJhc2UgZXhjZXB0aW9uIGZvciBoZWFkZXIgZXJyb3JzLiIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzMwMiwiX19tYWluX18iXTtOb25lOwogICAgdm9pZCgwKQogICAgcmV0dXJuICRjbGFzcwp9CikoKQokSGVhZGVyRXJyb3IuX19kb2NfXz0iQmFzZSBleGNlcHRpb24gZm9yIGhlYWRlciBlcnJvcnMuIgokSGVhZGVyRXJyb3IuX19tb2R1bGVfXz0iX19tYWluX18iCnZhciBIZWFkZXJFcnJvcj0kY2xhc3NfY29uc3RydWN0b3IoIkhlYWRlckVycm9yIiwkSGVhZGVyRXJyb3IsVGFyRXJyb3IpCndpbmRvdy5IZWFkZXJFcnJvcj1IZWFkZXJFcnJvcgpfX0JSWVRIT05fXy5zY29wZVsiX19tYWluX18iXS5fX2RpY3RfX1siSGVhZGVyRXJyb3IiXT1IZWFkZXJFcnJvcgpkb2N1bWVudC4kbGluZV9pbmZvPVszMDMsIl9fbWFpbl9fIl07Tm9uZTsKdmFyICRFbXB0eUhlYWRlckVycm9yPShmdW5jdGlvbigpewogICAgdmFyICRjbGFzcyA9IG5ldyBPYmplY3QoKQogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzA0LCJfX21haW5fXyJdO05vbmU7CiAgICAiRXhjZXB0aW9uIGZvciBlbXB0eSBoZWFkZXJzLiIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzMwNSwiX19tYWluX18iXTtOb25lOwogICAgdm9pZCgwKQogICAgcmV0dXJuICRjbGFzcwp9CikoKQokRW1wdHlIZWFkZXJFcnJvci5fX2RvY19fPSJFeGNlcHRpb24gZm9yIGVtcHR5IGhlYWRlcnMuIgokRW1wdHlIZWFkZXJFcnJvci5fX21vZHVsZV9fPSJfX21haW5fXyIKdmFyIEVtcHR5SGVhZGVyRXJyb3I9JGNsYXNzX2NvbnN0cnVjdG9yKCJFbXB0eUhlYWRlckVycm9yIiwkRW1wdHlIZWFkZXJFcnJvcixIZWFkZXJFcnJvcikKd2luZG93LkVtcHR5SGVhZGVyRXJyb3I9RW1wdHlIZWFkZXJFcnJvcgpfX0JSWVRIT05fXy5zY29wZVsiX19tYWluX18iXS5fX2RpY3RfX1siRW1wdHlIZWFkZXJFcnJvciJdPUVtcHR5SGVhZGVyRXJyb3IKZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzA2LCJfX21haW5fXyJdO05vbmU7CnZhciAkVHJ1bmNhdGVkSGVhZGVyRXJyb3I9KGZ1bmN0aW9uKCl7CiAgICB2YXIgJGNsYXNzID0gbmV3IE9iamVjdCgpCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVszMDcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICJFeGNlcHRpb24gZm9yIHRydW5jYXRlZCBoZWFkZXJzLiIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzMwOCwiX19tYWluX18iXTtOb25lOwogICAgdm9pZCgwKQogICAgcmV0dXJuICRjbGFzcwp9CikoKQokVHJ1bmNhdGVkSGVhZGVyRXJyb3IuX19kb2NfXz0iRXhjZXB0aW9uIGZvciB0cnVuY2F0ZWQgaGVhZGVycy4iCiRUcnVuY2F0ZWRIZWFkZXJFcnJvci5fX21vZHVsZV9fPSJfX21haW5fXyIKdmFyIFRydW5jYXRlZEhlYWRlckVycm9yPSRjbGFzc19jb25zdHJ1Y3RvcigiVHJ1bmNhdGVkSGVhZGVyRXJyb3IiLCRUcnVuY2F0ZWRIZWFkZXJFcnJvcixIZWFkZXJFcnJvcikKd2luZG93LlRydW5jYXRlZEhlYWRlckVycm9yPVRydW5jYXRlZEhlYWRlckVycm9yCl9fQlJZVEhPTl9fLnNjb3BlWyJfX21haW5fXyJdLl9fZGljdF9fWyJUcnVuY2F0ZWRIZWFkZXJFcnJvciJdPVRydW5jYXRlZEhlYWRlckVycm9yCmRvY3VtZW50LiRsaW5lX2luZm89WzMwOSwiX19tYWluX18iXTtOb25lOwp2YXIgJEVPRkhlYWRlckVycm9yPShmdW5jdGlvbigpewogICAgdmFyICRjbGFzcyA9IG5ldyBPYmplY3QoKQogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzEwLCJfX21haW5fXyJdO05vbmU7CiAgICAiRXhjZXB0aW9uIGZvciBlbmQgb2YgZmlsZSBoZWFkZXJzLiIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzMxMSwiX19tYWluX18iXTtOb25lOwogICAgdm9pZCgwKQogICAgcmV0dXJuICRjbGFzcwp9CikoKQokRU9GSGVhZGVyRXJyb3IuX19kb2NfXz0iRXhjZXB0aW9uIGZvciBlbmQgb2YgZmlsZSBoZWFkZXJzLiIKJEVPRkhlYWRlckVycm9yLl9fbW9kdWxlX189Il9fbWFpbl9fIgp2YXIgRU9GSGVhZGVyRXJyb3I9JGNsYXNzX2NvbnN0cnVjdG9yKCJFT0ZIZWFkZXJFcnJvciIsJEVPRkhlYWRlckVycm9yLEhlYWRlckVycm9yKQp3aW5kb3cuRU9GSGVhZGVyRXJyb3I9RU9GSGVhZGVyRXJyb3IKX19CUllUSE9OX18uc2NvcGVbIl9fbWFpbl9fIl0uX19kaWN0X19bIkVPRkhlYWRlckVycm9yIl09RU9GSGVhZGVyRXJyb3IKZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzEyLCJfX21haW5fXyJdO05vbmU7CnZhciAkSW52YWxpZEhlYWRlckVycm9yPShmdW5jdGlvbigpewogICAgdmFyICRjbGFzcyA9IG5ldyBPYmplY3QoKQogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzEzLCJfX21haW5fXyJdO05vbmU7CiAgICAiRXhjZXB0aW9uIGZvciBpbnZhbGlkIGhlYWRlcnMuIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzE0LCJfX21haW5fXyJdO05vbmU7CiAgICB2b2lkKDApCiAgICByZXR1cm4gJGNsYXNzCn0KKSgpCiRJbnZhbGlkSGVhZGVyRXJyb3IuX19kb2NfXz0iRXhjZXB0aW9uIGZvciBpbnZhbGlkIGhlYWRlcnMuIgokSW52YWxpZEhlYWRlckVycm9yLl9fbW9kdWxlX189Il9fbWFpbl9fIgp2YXIgSW52YWxpZEhlYWRlckVycm9yPSRjbGFzc19jb25zdHJ1Y3RvcigiSW52YWxpZEhlYWRlckVycm9yIiwkSW52YWxpZEhlYWRlckVycm9yLEhlYWRlckVycm9yKQp3aW5kb3cuSW52YWxpZEhlYWRlckVycm9yPUludmFsaWRIZWFkZXJFcnJvcgpfX0JSWVRIT05fXy5zY29wZVsiX19tYWluX18iXS5fX2RpY3RfX1siSW52YWxpZEhlYWRlckVycm9yIl09SW52YWxpZEhlYWRlckVycm9yCmRvY3VtZW50LiRsaW5lX2luZm89WzMxNSwiX19tYWluX18iXTtOb25lOwp2YXIgJFN1YnNlcXVlbnRIZWFkZXJFcnJvcj0oZnVuY3Rpb24oKXsKICAgIHZhciAkY2xhc3MgPSBuZXcgT2JqZWN0KCkKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzMxNiwiX19tYWluX18iXTtOb25lOwogICAgIkV4Y2VwdGlvbiBmb3IgbWlzc2luZyBhbmQgaW52YWxpZCBleHRlbmRlZCBoZWFkZXJzLiIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzMxNywiX19tYWluX18iXTtOb25lOwogICAgdm9pZCgwKQogICAgcmV0dXJuICRjbGFzcwp9CikoKQokU3Vic2VxdWVudEhlYWRlckVycm9yLl9fZG9jX189IkV4Y2VwdGlvbiBmb3IgbWlzc2luZyBhbmQgaW52YWxpZCBleHRlbmRlZCBoZWFkZXJzLiIKJFN1YnNlcXVlbnRIZWFkZXJFcnJvci5fX21vZHVsZV9fPSJfX21haW5fXyIKdmFyIFN1YnNlcXVlbnRIZWFkZXJFcnJvcj0kY2xhc3NfY29uc3RydWN0b3IoIlN1YnNlcXVlbnRIZWFkZXJFcnJvciIsJFN1YnNlcXVlbnRIZWFkZXJFcnJvcixIZWFkZXJFcnJvcikKd2luZG93LlN1YnNlcXVlbnRIZWFkZXJFcnJvcj1TdWJzZXF1ZW50SGVhZGVyRXJyb3IKX19CUllUSE9OX18uc2NvcGVbIl9fbWFpbl9fIl0uX19kaWN0X19bIlN1YnNlcXVlbnRIZWFkZXJFcnJvciJdPVN1YnNlcXVlbnRIZWFkZXJFcnJvcgpkb2N1bWVudC4kbGluZV9pbmZvPVszMjIsIl9fbWFpbl9fIl07Tm9uZTsKdmFyICRfTG93TGV2ZWxGaWxlPShmdW5jdGlvbigpewogICAgdmFyICRjbGFzcyA9IG5ldyBPYmplY3QoKQogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzIzLCJfX21haW5fXyJdO05vbmU7CiAgICAiTG93LWxldmVsIGZpbGUgb2JqZWN0LiBTdXBwb3J0cyByZWFkaW5nIGFuZCB3cml0aW5nLlxuXAogICAgICAgSXQgaXMgdXNlZCBpbnN0ZWFkIG9mIGEgcmVndWxhciBmaWxlIG9iamVjdCBmb3Igc3RyZWFtaW5nXG5cCiAgICAgICBhY2Nlc3MuXG5cCiAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVszMjgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5fX2luaXRfXz0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiX19pbml0X18iLGFyZ3VtZW50cyxbInNlbGYiLCJuYW1lIiwibW9kZSJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiYml3c2NicTUiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzMyOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIG1vZGU9JGxvY2Fsc1sibW9kZSJdPWdldGF0dHIoJGRpY3QoW1siciIsZ2V0YXR0cihvcywiT19SRE9OTFkiKV0sWyJ3IixnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihvcywiT19XUk9OTFkiKSwiX19vcl9fIikoZ2V0YXR0cihvcywiT19DUkVBVCIpKSwiX19vcl9fIikoZ2V0YXR0cihvcywiT19UUlVOQyIpKV1dKSwiX19nZXRpdGVtX18iKShtb2RlKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzMzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoaGFzYXR0ciwiX19jYWxsX18iKShvcywiT19CSU5BUlkiKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzMzNCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciAkdGVtcD0kbG9jYWxzWyIkdGVtcCJdPWdldGF0dHIob3MsIk9fQklOQVJZIik7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZighaGFzYXR0cihtb2RlLCJfX2lvcl9fIikpewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZT0kbG9jYWxzWyJtb2RlIl09Z2V0YXR0cihtb2RlLCJfX29yX18iKSgkdGVtcCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgbW9kZT1nZXRhdHRyKG1vZGUsIl9faW9yX18iKSgkdGVtcCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVszMzUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiZmQiLGdldGF0dHIoZ2V0YXR0cihvcywib3BlbiIpLCJfX2NhbGxfXyIpKG5hbWUsbW9kZSxOdW1iZXIoNDM4KSkpO05vbmU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE1Mil7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNTIpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9faW5pdF9fLl9fbmFtZV9fPSJfX2luaXRfXyIKICAgICRjbGFzcy5fX2luaXRfXy5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9faW5pdF9fLl9fZG9jX189IiIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzMzNywiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLmNsb3NlPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJjbG9zZSIsYXJndW1lbnRzLFsic2VsZiJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiZDF6OHRvMm8iXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzMzOCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKG9zLCJjbG9zZSIpLCJfX2NhbGxfXyIpKGdldGF0dHIoc2VsZiwiZmQiKSkKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTUyKXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE1Mil9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuY2xvc2UuX19uYW1lX189ImNsb3NlIgogICAgJGNsYXNzLmNsb3NlLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuY2xvc2UuX19kb2NfXz0iIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzQwLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MucmVhZD0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygicmVhZCIsYXJndW1lbnRzLFsic2VsZiIsInNpemUiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImQ3N3QyanVnIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVszNDEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiBnZXRhdHRyKGdldGF0dHIob3MsInJlYWQiKSwiX19jYWxsX18iKShnZXRhdHRyKHNlbGYsImZkIiksc2l6ZSkKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTUyKXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE1Mil9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MucmVhZC5fX25hbWVfXz0icmVhZCIKICAgICRjbGFzcy5yZWFkLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MucmVhZC5fX2RvY19fPSIiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVszNDMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy53cml0ZT0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygid3JpdGUiLGFyZ3VtZW50cyxbInNlbGYiLCJzIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJ2bzFwanFkeSJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzQ0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIob3MsIndyaXRlIiksIl9fY2FsbF9fIikoZ2V0YXR0cihzZWxmLCJmZCIpLHMpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE1Mil7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNTIpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLndyaXRlLl9fbmFtZV9fPSJ3cml0ZSIKICAgICRjbGFzcy53cml0ZS5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLndyaXRlLl9fZG9jX189IiIKICAgIHJldHVybiAkY2xhc3MKfQopKCkKJF9Mb3dMZXZlbEZpbGUuX19kb2NfXz0iTG93LWxldmVsIGZpbGUgb2JqZWN0LiBTdXBwb3J0cyByZWFkaW5nIGFuZCB3cml0aW5nLlxuXAogICAgICAgSXQgaXMgdXNlZCBpbnN0ZWFkIG9mIGEgcmVndWxhciBmaWxlIG9iamVjdCBmb3Igc3RyZWFtaW5nXG5cCiAgICAgICBhY2Nlc3MuXG5cCiAgICAiCiRfTG93TGV2ZWxGaWxlLl9fbW9kdWxlX189Il9fbWFpbl9fIgp2YXIgX0xvd0xldmVsRmlsZT0kY2xhc3NfY29uc3RydWN0b3IoIl9Mb3dMZXZlbEZpbGUiLCRfTG93TGV2ZWxGaWxlKQp3aW5kb3cuX0xvd0xldmVsRmlsZT1fTG93TGV2ZWxGaWxlCl9fQlJZVEhPTl9fLnNjb3BlWyJfX21haW5fXyJdLl9fZGljdF9fWyJfTG93TGV2ZWxGaWxlIl09X0xvd0xldmVsRmlsZQpkb2N1bWVudC4kbGluZV9pbmZvPVszNDYsIl9fbWFpbl9fIl07Tm9uZTsKdmFyICRfU3RyZWFtPShmdW5jdGlvbigpewogICAgdmFyICRjbGFzcyA9IG5ldyBPYmplY3QoKQogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzQ3LCJfX21haW5fXyJdO05vbmU7CiAgICAiQ2xhc3MgdGhhdCBzZXJ2ZXMgYXMgYW4gYWRhcHRlciBiZXR3ZWVuIFRhckZpbGUgYW5kXG5cCiAgICAgICBhIHN0cmVhbS1saWtlIG9iamVjdC4gIFRoZSBzdHJlYW0tbGlrZSBvYmplY3Qgb25seVxuXAogICAgICAgbmVlZHMgdG8gaGF2ZSBhIHJlYWQoKSBvciB3cml0ZSgpIG1ldGhvZCBhbmQgaXMgYWNjZXNzZWRcblwKICAgICAgIGJsb2Nrd2lzZS4gIFVzZSBvZiBnemlwIG9yIGJ6aXAyIGNvbXByZXNzaW9uIGlzIHBvc3NpYmxlLlxuXAogICAgICAgQSBzdHJlYW0tbGlrZSBvYmplY3QgY291bGQgYmUgZm9yIGV4YW1wbGU6IHN5cy5zdGRpbixcblwKICAgICAgIHN5cy5zdGRvdXQsIGEgc29ja2V0LCBhIHRhcGUgZGV2aWNlIGV0Yy5cblwKXG5cCiAgICAgICBfU3RyZWFtIGlzIGludGVuZGVkIHRvIGJlIHVzZWQgb25seSBpbnRlcm5hbGx5LlxuXAogICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzU3LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX19pbml0X189IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9faW5pdF9fIixhcmd1bWVudHMsWyJzZWxmIiwibmFtZSIsIm1vZGUiLCJjb21wdHlwZSIsImZpbGVvYmoiLCJidWZzaXplIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJlZ2t0ZGM2eCJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzU4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiQ29uc3RydWN0IGEgX1N0cmVhbSBvYmplY3QuXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzYwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsIl9leHRmaWxlb2JqIixUcnVlKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzYxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGZpbGVvYmo9PT1Ob25lKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzYyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGVvYmo9JGxvY2Fsc1siZmlsZW9iaiJdPWdldGF0dHIoX0xvd0xldmVsRmlsZSwiX19jYWxsX18iKShuYW1lLG1vZGUpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzYzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJfZXh0ZmlsZW9iaiIsRmFsc2UpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVszNjUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihjb21wdHlwZSwiX19lcV9fIikoJyonKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzM2OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBmaWxlb2JqPSRsb2NhbHNbImZpbGVvYmoiXT1nZXRhdHRyKF9TdHJlYW1Qcm94eSwiX19jYWxsX18iKShmaWxlb2JqKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzM2OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBjb21wdHlwZT0kbG9jYWxzWyJjb21wdHlwZSJdPWdldGF0dHIoZ2V0YXR0cihmaWxlb2JqLCJnZXRjb21wdHlwZSIpLCJfX2NhbGxfXyIpKCk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzM3MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJuYW1lIiwkdGVzdF9leHByKCR0ZXN0X2l0ZW0obmFtZSl8fCR0ZXN0X2l0ZW0oIiIpKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzM3MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJtb2RlIixtb2RlKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzczLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImNvbXB0eXBlIixjb21wdHlwZSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzM3NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJmaWxlb2JqIixmaWxlb2JqKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzc1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImJ1ZnNpemUiLGJ1ZnNpemUpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVszNzYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiYnVmIixieXRlcygiIikpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVszNzcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwicG9zIixOdW1iZXIoMCkpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVszNzgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiY2xvc2VkIixGYWxzZSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzM4MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgJGZhaWxlZDExNTI9ZmFsc2U7dHJ5ewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzM4MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihjb21wdHlwZSwiX19lcV9fIikoImd6IikpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzgyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICRmYWlsZWQxMTUzPWZhbHNlO3RyeXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzM4MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGltcG9ydF9saXN0KFsiemxpYiJdKTt2YXIgemxpYj0kbG9jYWxzWyJ6bGliIl09X19CUllUSE9OX18uaW1wb3J0ZWRbInpsaWIiXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIxMTUzKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZmFpbGVkMTE1Mz10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMTUzLFtJbXBvcnRFcnJvcl0pKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVszODUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKENvbXByZXNzaW9uRXJyb3IsIl9fY2FsbF9fIikoInpsaWIgbW9kdWxlIGlzIG5vdCBhdmFpbGFibGUiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXt0aHJvdyAkZXJyMTE1M30KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVszODYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJ6bGliIix6bGliKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVszODcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJjcmMiLGdldGF0dHIoZ2V0YXR0cih6bGliLCJjcmMzMiIpLCJfX2NhbGxfXyIpKGJ5dGVzKCIiKSkpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzM4OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIobW9kZSwiX19lcV9fIikoInIiKSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzg5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX2luaXRfcmVhZF9neiIpLCJfX2NhbGxfXyIpKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzM5MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJleGNlcHRpb24iLGdldGF0dHIoemxpYiwiZXJyb3IiKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzkyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX2luaXRfd3JpdGVfZ3oiKSwiX19jYWxsX18iKSgpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihib29sKGdldGF0dHIoY29tcHR5cGUsIl9fZXFfXyIpKCJiejIiKSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVszOTUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgJGZhaWxlZDExNTQ9ZmFsc2U7dHJ5ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzk2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaW1wb3J0X2xpc3QoWyJiejIiXSk7dmFyIGJ6Mj0kbG9jYWxzWyJiejIiXT1fX0JSWVRIT05fXy5pbXBvcnRlZFsiYnoyIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTE1NCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGZhaWxlZDExNTQ9dHJ1ZTtpZihmYWxzZSl7dm9pZCgwKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoJGlzX2V4YygkZXJyMTE1NCxbSW1wb3J0RXJyb3JdKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMzk4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihDb21wcmVzc2lvbkVycm9yLCJfX2NhbGxfXyIpKCJiejIgbW9kdWxlIGlzIG5vdCBhdmFpbGFibGUiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXt0aHJvdyAkZXJyMTE1NH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVszOTksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKG1vZGUsIl9fZXFfXyIpKCJyIikpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzQwMCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJkYnVmIixieXRlcygiIikpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0MDEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiY21wIixnZXRhdHRyKGdldGF0dHIoYnoyLCJCWjJEZWNvbXByZXNzb3IiKSwiX19jYWxsX18iKSgpKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDAyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImV4Y2VwdGlvbiIsSU9FcnJvcik7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDA0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImNtcCIsZ2V0YXR0cihnZXRhdHRyKGJ6MiwiQloyQ29tcHJlc3NvciIpLCJfX2NhbGxfXyIpKCkpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihib29sKGdldGF0dHIoY29tcHR5cGUsIl9fZXFfXyIpKCJ4eiIpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzQwNywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAkZmFpbGVkMTE1NT1mYWxzZTt0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0MDgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRpbXBvcnRfbGlzdChbImx6bWEiXSk7dmFyIGx6bWE9JGxvY2Fsc1sibHptYSJdPV9fQlJZVEhPTl9fLmltcG9ydGVkWyJsem1hIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTE1NSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGZhaWxlZDExNTU9dHJ1ZTtpZihmYWxzZSl7dm9pZCgwKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoJGlzX2V4YygkZXJyMTE1NSxbSW1wb3J0RXJyb3JdKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDEwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihDb21wcmVzc2lvbkVycm9yLCJfX2NhbGxfXyIpKCJsem1hIG1vZHVsZSBpcyBub3QgYXZhaWxhYmxlIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7dGhyb3cgJGVycjExNTV9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDExLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihtb2RlLCJfX2VxX18iKSgiciIpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0MTIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiZGJ1ZiIsYnl0ZXMoIiIpKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDEzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImNtcCIsZ2V0YXR0cihnZXRhdHRyKGx6bWEsIkxaTUFEZWNvbXByZXNzb3IiKSwiX19jYWxsX18iKSgpKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDE0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImV4Y2VwdGlvbiIsZ2V0YXR0cihsem1hLCJMWk1BRXJyb3IiKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDE2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImNtcCIsZ2V0YXR0cihnZXRhdHRyKGx6bWEsIkxaTUFDb21wcmVzc29yIiksIl9fY2FsbF9fIikoKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKGJvb2woZ2V0YXR0cihjb21wdHlwZSwiX19uZV9fIikoInRhciIpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzQxOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKENvbXByZXNzaW9uRXJyb3IsIl9fY2FsbF9fIikoZ2V0YXR0cigidW5rbm93biBjb21wcmVzc2lvbiB0eXBlICVyIiwiX19tb2RfXyIpKGNvbXB0eXBlKSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTE1Mil7CiAgICAgICAgICAgICAgICAgICAgdmFyICRmYWlsZWQxMTUyPXRydWU7aWYoZmFsc2Upe3ZvaWQoMCl9CiAgICAgICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDIyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJvb2woIWJvb2woZ2V0YXR0cihzZWxmLCJfZXh0ZmlsZW9iaiIpKSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDIzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJmaWxlb2JqIiksImNsb3NlIiksIl9fY2FsbF9fIikoKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzQyNCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImNsb3NlZCIsVHJ1ZSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDI1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICRyYWlzZSgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNTIpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTUyKX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5fX2luaXRfXy5fX25hbWVfXz0iX19pbml0X18iCiAgICAkY2xhc3MuX19pbml0X18uX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5fX2luaXRfXy5fX2RvY19fPSJDb25zdHJ1Y3QgYSBfU3RyZWFtIG9iamVjdC5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0MjcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5fX2RlbF9fPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJfX2RlbF9fIixhcmd1bWVudHMsWyJzZWxmIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJhN21qc283NyJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDI4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKCR0ZXN0X2V4cHIoJHRlc3RfaXRlbShnZXRhdHRyKGhhc2F0dHIsIl9fY2FsbF9fIikoc2VsZiwiY2xvc2VkIikpJiYkdGVzdF9pdGVtKCFib29sKGdldGF0dHIoc2VsZiwiY2xvc2VkIikpKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0MjksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiY2xvc2UiKSwiX19jYWxsX18iKSgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE1Nil7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNTYpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9fZGVsX18uX19uYW1lX189Il9fZGVsX18iCiAgICAkY2xhc3MuX19kZWxfXy5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9fZGVsX18uX19kb2NfXz0iIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDMxLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX2luaXRfd3JpdGVfZ3o9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9pbml0X3dyaXRlX2d6Iixhcmd1bWVudHMsWyJzZWxmIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyIwNGxmZ3dxbyJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDMyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiSW5pdGlhbGl6ZSBmb3Igd3JpdGluZyB3aXRoIGd6aXAgY29tcHJlc3Npb24uXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDM0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImNtcCIsZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwiemxpYiIpLCJjb21wcmVzc29iaiIpLCJfX2NhbGxfXyIpKE51bWJlcig5KSxnZXRhdHRyKGdldGF0dHIoc2VsZiwiemxpYiIpLCJERUZMQVRFRCIpLGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwiemxpYiIpLCJNQVhfV0JJVFMiKSwiX19uZWdfXyIpLCJfX2NhbGxfXyIpKCksZ2V0YXR0cihnZXRhdHRyKHNlbGYsInpsaWIiKSwiREVGX01FTV9MRVZFTCIpLE51bWJlcigwKSkpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0MzgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciB0aW1lc3RhbXA9JGxvY2Fsc1sidGltZXN0YW1wIl09Z2V0YXR0cihnZXRhdHRyKHN0cnVjdCwicGFjayIpLCJfX2NhbGxfXyIpKCI8TCIsZ2V0YXR0cihpbnQsIl9fY2FsbF9fIikoZ2V0YXR0cihnZXRhdHRyKHRpbWUsInRpbWUiKSwiX19jYWxsX18iKSgpKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzQzOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9fd3JpdGUiKSwiX19jYWxsX18iKShnZXRhdHRyKGdldGF0dHIoYnl0ZXMoIlwwMzdcMjEzXDAxMFwwMTAiKSwiX19hZGRfXyIpKHRpbWVzdGFtcCksIl9fYWRkX18iKShieXRlcygiXDAwMlwzNzciKSkpCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0NDAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwibmFtZSIpLCJlbmRzd2l0aCIpLCJfX2NhbGxfXyIpKCIuZ3oiKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzQ0MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwibmFtZSIsZ2V0YXR0cihnZXRhdHRyKHNlbGYsIm5hbWUiKSwiX19nZXRpdGVtX18iKShzbGljZShudWxsLE51bWJlcigtMykpKSk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzQ0MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9fd3JpdGUiKSwiX19jYWxsX18iKShnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHNlbGYsIm5hbWUiKSwiZW5jb2RlIiksIl9fY2FsbF9fIikoImlzby04ODU5LTEiLCJyZXBsYWNlIiksIl9fYWRkX18iKShOVUwpKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNTYpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTU2KX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5faW5pdF93cml0ZV9nei5fX25hbWVfXz0iX2luaXRfd3JpdGVfZ3oiCiAgICAkY2xhc3MuX2luaXRfd3JpdGVfZ3ouX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5faW5pdF93cml0ZV9nei5fX2RvY19fPSJJbml0aWFsaXplIGZvciB3cml0aW5nIHdpdGggZ3ppcCBjb21wcmVzc2lvbi5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0NDUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy53cml0ZT0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygid3JpdGUiLGFyZ3VtZW50cyxbInNlbGYiLCJzIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJicjhoYmNxZiJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDQ2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiV3JpdGUgc3RyaW5nIHMgdG8gdGhlIHN0cmVhbS5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0NDgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKHNlbGYsImNvbXB0eXBlIiksIl9fZXFfXyIpKCJneiIpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDQ5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJjcmMiLGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHNlbGYsInpsaWIiKSwiY3JjMzIiKSwiX19jYWxsX18iKShzLGdldGF0dHIoc2VsZiwiY3JjIikpKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDUwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgJHRlbXA9JGxvY2Fsc1siJHRlbXAiXT1nZXRhdHRyKGxlbiwiX19jYWxsX18iKShzKTtOb25lOwogICAgICAgICAgICAgICAgaWYoIWhhc2F0dHIoZ2V0YXR0cihzZWxmLCJwb3MiKSwiX19pYWRkX18iKSl7CiAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJwb3MiLGdldGF0dHIoZ2V0YXR0cihzZWxmLCJwb3MiKSwiX19hZGRfXyIpKCR0ZW1wKSk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihzZWxmLCJwb3MiKT1nZXRhdHRyKGdldGF0dHIoc2VsZiwicG9zIiksIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0NTEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKHNlbGYsImNvbXB0eXBlIiksIl9fbmVfXyIpKCJ0YXIiKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzQ1MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBzPSRsb2NhbHNbInMiXT1nZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJjbXAiKSwiY29tcHJlc3MiKSwiX19jYWxsX18iKShzKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDUzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX193cml0ZSIpLCJfX2NhbGxfXyIpKHMpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE1Nil7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNTYpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLndyaXRlLl9fbmFtZV9fPSJ3cml0ZSIKICAgICRjbGFzcy53cml0ZS5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLndyaXRlLl9fZG9jX189IldyaXRlIHN0cmluZyBzIHRvIHRoZSBzdHJlYW0uXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDU1LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX193cml0ZT0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiX193cml0ZSIsYXJndW1lbnRzLFsic2VsZiIsInMiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbIm04em9uZjU1Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0NTYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJXcml0ZSBzdHJpbmcgcyB0byB0aGUgc3RyZWFtIGlmIGEgd2hvbGUgbmV3IGJsb2NrXG5cCiAgICAgICAgICAgaXMgcmVhZHkgdG8gYmUgd3JpdHRlbi5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0NTksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciAkdGVtcD0kbG9jYWxzWyIkdGVtcCJdPXM7Tm9uZTsKICAgICAgICAgICAgICAgIGlmKCFoYXNhdHRyKGdldGF0dHIoc2VsZiwiYnVmIiksIl9faWFkZF9fIikpewogICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiYnVmIixnZXRhdHRyKGdldGF0dHIoc2VsZiwiYnVmIiksIl9fYWRkX18iKSgkdGVtcCkpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGdldGF0dHIoc2VsZiwiYnVmIik9Z2V0YXR0cihnZXRhdHRyKHNlbGYsImJ1ZiIpLCJfX2lhZGRfXyIpKCR0ZW1wKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDYwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTEyOT10cnVlO3doaWxlKGJvb2woZ2V0YXR0cihnZXRhdHRyKGxlbiwiX19jYWxsX18iKShnZXRhdHRyKHNlbGYsImJ1ZiIpKSwiX19ndF9fIikoZ2V0YXR0cihzZWxmLCJidWZzaXplIikpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDYxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwiZmlsZW9iaiIpLCJ3cml0ZSIpLCJfX2NhbGxfXyIpKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJidWYiKSwiX19nZXRpdGVtX18iKShzbGljZShudWxsLGdldGF0dHIoc2VsZiwiYnVmc2l6ZSIpKSkpCiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDYyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJidWYiLGdldGF0dHIoZ2V0YXR0cihzZWxmLCJidWYiKSwiX19nZXRpdGVtX18iKShzbGljZShnZXRhdHRyKHNlbGYsImJ1ZnNpemUiKSxudWxsKSkpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE1Nil7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNTYpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9fd3JpdGUuX19uYW1lX189Il9fd3JpdGUiCiAgICAkY2xhc3MuX193cml0ZS5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9fd3JpdGUuX19kb2NfXz0iV3JpdGUgc3RyaW5nIHMgdG8gdGhlIHN0cmVhbSBpZiBhIHdob2xlIG5ldyBibG9ja1xuXAogICAgICAgICAgIGlzIHJlYWR5IHRvIGJlIHdyaXR0ZW4uXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDY0LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuY2xvc2U9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoImNsb3NlIixhcmd1bWVudHMsWyJzZWxmIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyI0cWdycmJ6byJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDY1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiQ2xvc2UgdGhlIF9TdHJlYW0gb2JqZWN0LiBObyBvcGVyYXRpb24gc2hvdWxkIGJlXG5cCiAgICAgICAgICAgZG9uZSBvbiBpdCBhZnRlcndhcmRzLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzQ2OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKHNlbGYsImNsb3NlZCIpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDY5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDcxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKCR0ZXN0X2V4cHIoJHRlc3RfaXRlbShnZXRhdHRyKGdldGF0dHIoc2VsZiwibW9kZSIpLCJfX2VxX18iKSgidyIpKSYmJHRlc3RfaXRlbShnZXRhdHRyKGdldGF0dHIoc2VsZiwiY29tcHR5cGUiKSwiX19uZV9fIikoInRhciIpKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0NzIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgJHRlbXA9JGxvY2Fsc1siJHRlbXAiXT1nZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJjbXAiKSwiZmx1c2giKSwiX19jYWxsX18iKSgpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoIWhhc2F0dHIoZ2V0YXR0cihzZWxmLCJidWYiKSwiX19pYWRkX18iKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiYnVmIixnZXRhdHRyKGdldGF0dHIoc2VsZiwiYnVmIiksIl9fYWRkX18iKSgkdGVtcCkpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoc2VsZiwiYnVmIik9Z2V0YXR0cihnZXRhdHRyKHNlbGYsImJ1ZiIpLCJfX2lhZGRfXyIpKCR0ZW1wKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzQ3NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKHNlbGYsIm1vZGUiKSwiX19lcV9fIikoInciKSkmJiR0ZXN0X2l0ZW0oZ2V0YXR0cihzZWxmLCJidWYiKSkpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDc1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwiZmlsZW9iaiIpLCJ3cml0ZSIpLCJfX2NhbGxfXyIpKGdldGF0dHIoc2VsZiwiYnVmIikpCiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDc2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJidWYiLGJ5dGVzKCIiKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0NzcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJjb21wdHlwZSIpLCJfX2VxX18iKSgiZ3oiKSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0ODQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwiZmlsZW9iaiIpLCJ3cml0ZSIpLCJfX2NhbGxfXyIpKGdldGF0dHIoZ2V0YXR0cihzdHJ1Y3QsInBhY2siKSwiX19jYWxsX18iKSgiPEwiLGdldGF0dHIoZ2V0YXR0cihzZWxmLCJjcmMiKSwiX19hbmRfXyIpKE51bWJlcig0Mjk0OTY3Mjk1KSkpKQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0ODUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwiZmlsZW9iaiIpLCJ3cml0ZSIpLCJfX2NhbGxfXyIpKGdldGF0dHIoZ2V0YXR0cihzdHJ1Y3QsInBhY2siKSwiX19jYWxsX18iKSgiPEwiLGdldGF0dHIoZ2V0YXR0cihzZWxmLCJwb3MiKSwiX19hbmRfXyIpKE51bWJlcig0Mjk0OTY3Mjk1KSkpKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzQ4NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbCghYm9vbChnZXRhdHRyKHNlbGYsIl9leHRmaWxlb2JqIikpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDg4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwiZmlsZW9iaiIpLCJjbG9zZSIpLCJfX2NhbGxfXyIpKCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzQ5MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJjbG9zZWQiLFRydWUpO05vbmU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE1Nil7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNTYpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLmNsb3NlLl9fbmFtZV9fPSJjbG9zZSIKICAgICRjbGFzcy5jbG9zZS5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLmNsb3NlLl9fZG9jX189IkNsb3NlIHRoZSBfU3RyZWFtIG9iamVjdC4gTm8gb3BlcmF0aW9uIHNob3VsZCBiZVxuXAogICAgICAgICAgIGRvbmUgb24gaXQgYWZ0ZXJ3YXJkcy5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs0OTIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5faW5pdF9yZWFkX2d6PSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJfaW5pdF9yZWFkX2d6Iixhcmd1bWVudHMsWyJzZWxmIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJscTNrMjFlMSJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDkzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiSW5pdGlhbGl6ZSBmb3IgcmVhZGluZyBhIGd6aXAgY29tcHJlc3NlZCBmaWxlb2JqLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzQ5NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJjbXAiLGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHNlbGYsInpsaWIiKSwiZGVjb21wcmVzc29iaiIpLCJfX2NhbGxfXyIpKGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwiemxpYiIpLCJNQVhfV0JJVFMiKSwiX19uZWdfXyIpLCJfX2NhbGxfXyIpKCkpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNDk2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImRidWYiLGJ5dGVzKCIiKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzQ5OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfX3JlYWQiKSwiX19jYWxsX18iKShOdW1iZXIoMikpLCJfX25lX18iKShieXRlcygiXDAzN1wyMTMiKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1MDAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKFJlYWRFcnJvciwiX19jYWxsX18iKSgibm90IGEgZ3ppcCBmaWxlIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzUwMSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfX3JlYWQiKSwiX19jYWxsX18iKShOdW1iZXIoMSkpLCJfX25lX18iKShieXRlcygiXDAxMCIpKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzUwMiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHRocm93IGdldGF0dHIoQ29tcHJlc3Npb25FcnJvciwiX19jYWxsX18iKSgidW5zdXBwb3J0ZWQgY29tcHJlc3Npb24gbWV0aG9kIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzUwNCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIGZsYWc9JGxvY2Fsc1siZmxhZyJdPWdldGF0dHIob3JkLCJfX2NhbGxfXyIpKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfX3JlYWQiKSwiX19jYWxsX18iKShOdW1iZXIoMSkpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTA1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX19yZWFkIiksIl9fY2FsbF9fIikoTnVtYmVyKDYpKQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTA3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZmxhZywiX19hbmRfXyIpKE51bWJlcig0KSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1MDgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgeGxlbj0kbG9jYWxzWyJ4bGVuIl09Z2V0YXR0cihnZXRhdHRyKG9yZCwiX19jYWxsX18iKShnZXRhdHRyKGdldGF0dHIoc2VsZiwiX19yZWFkIiksIl9fY2FsbF9fIikoTnVtYmVyKDEpKSksIl9fYWRkX18iKShnZXRhdHRyKE51bWJlcigyNTYpLCJfX211bF9fIikoZ2V0YXR0cihvcmQsIl9fY2FsbF9fIikoZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9fcmVhZCIpLCJfX2NhbGxfXyIpKE51bWJlcigxKSkpKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1MDksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwicmVhZCIpLCJfX2NhbGxfXyIpKHhsZW4pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1MTAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihmbGFnLCJfX2FuZF9fIikoTnVtYmVyKDgpKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzUxMSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMTMwPXRydWU7d2hpbGUoYm9vbChUcnVlKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzUxMiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcz0kbG9jYWxzWyJzIl09Z2V0YXR0cihnZXRhdHRyKHNlbGYsIl9fcmVhZCIpLCJfX2NhbGxfXyIpKE51bWJlcigxKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTEzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKCFib29sKHMpKXx8JHRlc3RfaXRlbShnZXRhdHRyKHMsIl9fZXFfXyIpKE5VTCkpKSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTE0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTEzMD1mYWxzZTticmVhawogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTE1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZmxhZywiX19hbmRfXyIpKE51bWJlcigxNikpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTE2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICRub19icmVhazExMzE9dHJ1ZTt3aGlsZShib29sKFRydWUpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTE3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzPSRsb2NhbHNbInMiXT1nZXRhdHRyKGdldGF0dHIoc2VsZiwiX19yZWFkIiksIl9fY2FsbF9fIikoTnVtYmVyKDEpKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1MTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oIWJvb2wocykpfHwkdGVzdF9pdGVtKGdldGF0dHIocywiX19lcV9fIikoTlVMKSkpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1MTksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMTMxPWZhbHNlO2JyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1MjAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihmbGFnLCJfX2FuZF9fIikoTnVtYmVyKDIpKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzUyMSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfX3JlYWQiKSwiX19jYWxsX18iKShOdW1iZXIoMikpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE1Nil7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNTYpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9pbml0X3JlYWRfZ3ouX19uYW1lX189Il9pbml0X3JlYWRfZ3oiCiAgICAkY2xhc3MuX2luaXRfcmVhZF9nei5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9pbml0X3JlYWRfZ3ouX19kb2NfXz0iSW5pdGlhbGl6ZSBmb3IgcmVhZGluZyBhIGd6aXAgY29tcHJlc3NlZCBmaWxlb2JqLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzUyMywiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLnRlbGw9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoInRlbGwiLGFyZ3VtZW50cyxbInNlbGYiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbInMxaGZsczF0Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1MjQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJSZXR1cm4gdGhlIHN0cmVhbSdzIGZpbGUgcG9pbnRlciBwb3NpdGlvbi5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1MjYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiBnZXRhdHRyKHNlbGYsInBvcyIpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE1Nil7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNTYpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLnRlbGwuX19uYW1lX189InRlbGwiCiAgICAkY2xhc3MudGVsbC5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLnRlbGwuX19kb2NfXz0iUmV0dXJuIHRoZSBzdHJlYW0ncyBmaWxlIHBvaW50ZXIgcG9zaXRpb24uXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTI4LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3Muc2Vlaz0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygic2VlayIsYXJndW1lbnRzLFsic2VsZiJdLHsicG9zIjpOdW1iZXIoMCl9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiZzZsY2s0b2UiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzUyOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIlNldCB0aGUgc3RyZWFtJ3MgZmlsZSBwb2ludGVyIHRvIHBvcy4gTmVnYXRpdmUgc2Vla2luZ1xuXAogICAgICAgICAgIGlzIGZvcmJpZGRlbi5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1MzIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKHBvcywiX19zdWJfXyIpKGdldGF0dHIoc2VsZiwicG9zIikpLCJfX2dlX18iKShOdW1iZXIoMCkpKSl7CiAgICAgICAgICAgICAgICAgICAgJHJpZ2h0PWl0ZXIoZ2V0YXR0cihkaXZtb2QsIl9fY2FsbF9fIikoZ2V0YXR0cihwb3MsIl9fc3ViX18iKShnZXRhdHRyKHNlbGYsInBvcyIpKSxnZXRhdHRyKHNlbGYsImJ1ZnNpemUiKSkpOyRjb3VudGVyPS0xCiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTMzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICAkY291bnRlcisrCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBibG9ja3M9JGxvY2Fsc1siYmxvY2tzIl09bmV4dCgkcmlnaHQpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbWFpbmRlcj0kbG9jYWxzWyJyZW1haW5kZXIiXT1uZXh0KCRyaWdodCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycjExNTYpewogICAgICAgICAgICAgICAgICAgICAgICBpZigkZXJyMTE1Ni5fX25hbWVfXz09IlN0b3BJdGVyYXRpb24iKXskcG9wX2V4YygpO3Rocm93IFZhbHVlRXJyb3IoIm5lZWQgbW9yZSB0aGFuICIrJGNvdW50ZXIrIiB2YWx1ZSIrKCRjb3VudGVyPjEgPyAicyIgOiAiIikrIiB0byB1bnBhY2siKX0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdmFyICRleGhhdXN0ZWQ9dHJ1ZTt0cnl7bmV4dCgkcmlnaHQpOyRleGhhdXN0ZWQ9ZmFsc2V9Y2F0Y2goZXJyKXtpZihlcnIuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKX19aWYoISRleGhhdXN0ZWQpe3Rocm93IFZhbHVlRXJyb3IoInRvbyBtYW55IHZhbHVlcyB0byB1bnBhY2sgKGV4cGVjdGVkICIrKCRjb3VudGVyKzEpKyIpIil9CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTM0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICRuZXh0MTE1Nz1nZXRhdHRyKGl0ZXIoZ2V0YXR0cihyYW5nZSwiX19jYWxsX18iKShibG9ja3MpKSwiX19uZXh0X18iKQogICAgICAgICAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMTU3PXRydWU7d2hpbGUodHJ1ZSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpPSRsb2NhbHNbImkiXT0kbmV4dDExNTcoKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIpe2lmKCRpc19leGMoJGVycixbU3RvcEl0ZXJhdGlvbl0pKXskcG9wX2V4YygpO2JyZWFrfWVsc2V7dGhyb3coJGVycil9fQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1MzUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsInJlYWQiKSwiX19jYWxsX18iKShnZXRhdHRyKHNlbGYsImJ1ZnNpemUiKSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTM2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsInJlYWQiKSwiX19jYWxsX18iKShyZW1haW5kZXIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzUzOCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHRocm93IGdldGF0dHIoU3RyZWFtRXJyb3IsIl9fY2FsbF9fIikoInNlZWtpbmcgYmFja3dhcmRzIGlzIG5vdCBhbGxvd2VkIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzUzOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoc2VsZiwicG9zIikKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTU2KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE1Nil9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3Muc2Vlay5fX25hbWVfXz0ic2VlayIKICAgICRjbGFzcy5zZWVrLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3Muc2Vlay5fX2RvY19fPSJTZXQgdGhlIHN0cmVhbSdzIGZpbGUgcG9pbnRlciB0byBwb3MuIE5lZ2F0aXZlIHNlZWtpbmdcblwKICAgICAgICAgICBpcyBmb3JiaWRkZW4uXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTQxLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MucmVhZD0gKGZ1bmN0aW9uIChOb25lKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoInJlYWQiLGFyZ3VtZW50cyxbInNlbGYiXSx7InNpemUiOigkY2xhc3NbIk5vbmUiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIk5vbmUiXSA6IE5vbmUpfSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbIm56a2p4MzNtIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1NDIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJSZXR1cm4gdGhlIG5leHQgc2l6ZSBudW1iZXIgb2YgYnl0ZXMgZnJvbSB0aGUgc3RyZWFtLlxuXAogICAgICAgICAgIElmIHNpemUgaXMgbm90IGRlZmluZWQsIHJldHVybiBhbGwgYnl0ZXMgb2YgdGhlIHN0cmVhbVxuXAogICAgICAgICAgIHVwIHRvIEVPRi5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1NDYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woc2l6ZT09PU5vbmUpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1NDcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgdD0kbG9jYWxzWyJ0Il09bGlzdC5fX2NhbGxfXyhbXSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1NDgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTEzMj10cnVlO3doaWxlKGJvb2woVHJ1ZSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1NDksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ1Zj0kbG9jYWxzWyJidWYiXT1nZXRhdHRyKGdldGF0dHIoc2VsZiwiX3JlYWQiKSwiX19jYWxsX18iKShnZXRhdHRyKHNlbGYsImJ1ZnNpemUiKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTUwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJvb2woIWJvb2woYnVmKSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTUxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTEzMj1mYWxzZTticmVhawogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzU1MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIodCwiYXBwZW5kIiksIl9fY2FsbF9fIikoYnVmKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1NTMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgYnVmPSRsb2NhbHNbImJ1ZiJdPWdldGF0dHIoZ2V0YXR0cigiIiwiam9pbiIpLCJfX2NhbGxfXyIpKHQpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzU1NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBidWY9JGxvY2Fsc1siYnVmIl09Z2V0YXR0cihnZXRhdHRyKHNlbGYsIl9yZWFkIiksIl9fY2FsbF9fIikoc2l6ZSk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzU1NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyICR0ZW1wPSRsb2NhbHNbIiR0ZW1wIl09Z2V0YXR0cihsZW4sIl9fY2FsbF9fIikoYnVmKTtOb25lOwogICAgICAgICAgICAgICAgaWYoIWhhc2F0dHIoZ2V0YXR0cihzZWxmLCJwb3MiKSwiX19pYWRkX18iKSl7CiAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJwb3MiLGdldGF0dHIoZ2V0YXR0cihzZWxmLCJwb3MiKSwiX19hZGRfXyIpKCR0ZW1wKSk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihzZWxmLCJwb3MiKT1nZXRhdHRyKGdldGF0dHIoc2VsZiwicG9zIiksIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1NTcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiBidWYKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTU4KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE1OCl9CiAgICAgICAgfQogICAgfQogICAgKSgkY2xhc3MuTm9uZSAhPSB1bmRlZmluZWQgPyAkY2xhc3MuTm9uZSA6IE5vbmUpCiAgICAkY2xhc3MucmVhZC5fX25hbWVfXz0icmVhZCIKICAgICRjbGFzcy5yZWFkLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MucmVhZC5fX2RvY19fPSJSZXR1cm4gdGhlIG5leHQgc2l6ZSBudW1iZXIgb2YgYnl0ZXMgZnJvbSB0aGUgc3RyZWFtLlxuXAogICAgICAgICAgIElmIHNpemUgaXMgbm90IGRlZmluZWQsIHJldHVybiBhbGwgYnl0ZXMgb2YgdGhlIHN0cmVhbVxuXAogICAgICAgICAgIHVwIHRvIEVPRi5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1NTksIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5fcmVhZD0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiX3JlYWQiLGFyZ3VtZW50cyxbInNlbGYiLCJzaXplIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJ3Z2V3eGlnYSJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTYwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiUmV0dXJuIHNpemUgYnl0ZXMgZnJvbSB0aGUgc3RyZWFtLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzU2MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIoc2VsZiwiY29tcHR5cGUiKSwiX19lcV9fIikoInRhciIpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTYzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfX3JlYWQiKSwiX19jYWxsX18iKShzaXplKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTY1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgYz0kbG9jYWxzWyJjIl09Z2V0YXR0cihsZW4sIl9fY2FsbF9fIikoZ2V0YXR0cihzZWxmLCJkYnVmIikpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1NjYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMTMzPXRydWU7d2hpbGUoYm9vbChnZXRhdHRyKGMsIl9fbHRfXyIpKHNpemUpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTY3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIGJ1Zj0kbG9jYWxzWyJidWYiXT1nZXRhdHRyKGdldGF0dHIoc2VsZiwiX19yZWFkIiksIl9fY2FsbF9fIikoZ2V0YXR0cihzZWxmLCJidWZzaXplIikpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTY4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbCghYm9vbChidWYpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzU2OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTEzMz1mYWxzZTticmVhawogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1NzAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAkZmFpbGVkMTE1OD1mYWxzZTt0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzU3MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYnVmPSRsb2NhbHNbImJ1ZiJdPWdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHNlbGYsImNtcCIpLCJkZWNvbXByZXNzIiksIl9fY2FsbF9fIikoYnVmKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTE1OCl7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZmFpbGVkMTE1OD10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKCRpc19leGMoJGVycjExNTgsW2dldGF0dHIoc2VsZiwiZXhjZXB0aW9uIildKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1NzMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGdldGF0dHIoUmVhZEVycm9yLCJfX2NhbGxfXyIpKCJpbnZhbGlkIGNvbXByZXNzZWQgZGF0YSIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXt0aHJvdyAkZXJyMTE1OH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTc0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICR0ZW1wPSRsb2NhbHNbIiR0ZW1wIl09YnVmO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoIWhhc2F0dHIoZ2V0YXR0cihzZWxmLCJkYnVmIiksIl9faWFkZF9fIikpewogICAgICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImRidWYiLGdldGF0dHIoZ2V0YXR0cihzZWxmLCJkYnVmIiksIl9fYWRkX18iKSgkdGVtcCkpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoc2VsZiwiZGJ1ZiIpPWdldGF0dHIoZ2V0YXR0cihzZWxmLCJkYnVmIiksIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzU3NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciAkdGVtcD0kbG9jYWxzWyIkdGVtcCJdPWdldGF0dHIobGVuLCJfX2NhbGxfXyIpKGJ1Zik7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZigkdGVtcC4kZmFzdF9hdWdtICYmIGMuJGZhc3RfYXVnbSl7Yys9JHRlbXA7JGxvY2Fsc1siYyJdPWN9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZighaGFzYXR0cihjLCJfX2lhZGRfXyIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGM9JGxvY2Fsc1siYyJdPWdldGF0dHIoYywiX19hZGRfXyIpKCR0ZW1wKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBjPSRsb2NhbHNbImMiXT1nZXRhdHRyKGMsIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTc2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgYnVmPSRsb2NhbHNbImJ1ZiJdPWdldGF0dHIoZ2V0YXR0cihzZWxmLCJkYnVmIiksIl9fZ2V0aXRlbV9fIikoc2xpY2UobnVsbCxzaXplKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzU3NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJkYnVmIixnZXRhdHRyKGdldGF0dHIoc2VsZiwiZGJ1ZiIpLCJfX2dldGl0ZW1fXyIpKHNsaWNlKHNpemUsbnVsbCkpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTc4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gYnVmCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE1OCl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNTgpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9yZWFkLl9fbmFtZV9fPSJfcmVhZCIKICAgICRjbGFzcy5fcmVhZC5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9yZWFkLl9fZG9jX189IlJldHVybiBzaXplIGJ5dGVzIGZyb20gdGhlIHN0cmVhbS5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1ODAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5fX3JlYWQ9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9fcmVhZCIsYXJndW1lbnRzLFsic2VsZiIsInNpemUiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImZhOGxqanp3Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1ODEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJSZXR1cm4gc2l6ZSBieXRlcyBmcm9tIHN0cmVhbS4gSWYgaW50ZXJuYWwgYnVmZmVyIGlzIGVtcHR5LFxuXAogICAgICAgICAgIHJlYWQgYW5vdGhlciBibG9jayBmcm9tIHRoZSBzdHJlYW0uXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTg0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgYz0kbG9jYWxzWyJjIl09Z2V0YXR0cihsZW4sIl9fY2FsbF9fIikoZ2V0YXR0cihzZWxmLCJidWYiKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzU4NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyICRub19icmVhazExMzQ9dHJ1ZTt3aGlsZShib29sKGdldGF0dHIoYywiX19sdF9fIikoc2l6ZSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1ODYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgYnVmPSRsb2NhbHNbImJ1ZiJdPWdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHNlbGYsImZpbGVvYmoiKSwicmVhZCIpLCJfX2NhbGxfXyIpKGdldGF0dHIoc2VsZiwiYnVmc2l6ZSIpKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzU4NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKGJvb2woIWJvb2woYnVmKSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1ODgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRub19icmVhazExMzQ9ZmFsc2U7YnJlYWsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTg5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICR0ZW1wPSRsb2NhbHNbIiR0ZW1wIl09YnVmO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoIWhhc2F0dHIoZ2V0YXR0cihzZWxmLCJidWYiKSwiX19pYWRkX18iKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiYnVmIixnZXRhdHRyKGdldGF0dHIoc2VsZiwiYnVmIiksIl9fYWRkX18iKSgkdGVtcCkpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoc2VsZiwiYnVmIik9Z2V0YXR0cihnZXRhdHRyKHNlbGYsImJ1ZiIpLCJfX2lhZGRfXyIpKCR0ZW1wKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs1OTAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgJHRlbXA9JGxvY2Fsc1siJHRlbXAiXT1nZXRhdHRyKGxlbiwiX19jYWxsX18iKShidWYpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoJHRlbXAuJGZhc3RfYXVnbSAmJiBjLiRmYXN0X2F1Z20pe2MrPSR0ZW1wOyRsb2NhbHNbImMiXT1jfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoIWhhc2F0dHIoYywiX19pYWRkX18iKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjPSRsb2NhbHNbImMiXT1nZXRhdHRyKGMsIl9fYWRkX18iKSgkdGVtcCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgYz0kbG9jYWxzWyJjIl09Z2V0YXR0cihjLCJfX2lhZGRfXyIpKCR0ZW1wKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzU5MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIGJ1Zj0kbG9jYWxzWyJidWYiXT1nZXRhdHRyKGdldGF0dHIoc2VsZiwiYnVmIiksIl9fZ2V0aXRlbV9fIikoc2xpY2UobnVsbCxzaXplKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzU5MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJidWYiLGdldGF0dHIoZ2V0YXR0cihzZWxmLCJidWYiKSwiX19nZXRpdGVtX18iKShzbGljZShzaXplLG51bGwpKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzU5MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGJ1ZgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNTkpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTU5KX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5fX3JlYWQuX19uYW1lX189Il9fcmVhZCIKICAgICRjbGFzcy5fX3JlYWQuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5fX3JlYWQuX19kb2NfXz0iUmV0dXJuIHNpemUgYnl0ZXMgZnJvbSBzdHJlYW0uIElmIGludGVybmFsIGJ1ZmZlciBpcyBlbXB0eSxcblwKICAgICAgICAgICByZWFkIGFub3RoZXIgYmxvY2sgZnJvbSB0aGUgc3RyZWFtLlxuXAogICAgICAgICIKICAgIHJldHVybiAkY2xhc3MKfQopKCkKJF9TdHJlYW0uX19kb2NfXz0iQ2xhc3MgdGhhdCBzZXJ2ZXMgYXMgYW4gYWRhcHRlciBiZXR3ZWVuIFRhckZpbGUgYW5kXG5cCiAgICAgICBhIHN0cmVhbS1saWtlIG9iamVjdC4gIFRoZSBzdHJlYW0tbGlrZSBvYmplY3Qgb25seVxuXAogICAgICAgbmVlZHMgdG8gaGF2ZSBhIHJlYWQoKSBvciB3cml0ZSgpIG1ldGhvZCBhbmQgaXMgYWNjZXNzZWRcblwKICAgICAgIGJsb2Nrd2lzZS4gIFVzZSBvZiBnemlwIG9yIGJ6aXAyIGNvbXByZXNzaW9uIGlzIHBvc3NpYmxlLlxuXAogICAgICAgQSBzdHJlYW0tbGlrZSBvYmplY3QgY291bGQgYmUgZm9yIGV4YW1wbGU6IHN5cy5zdGRpbixcblwKICAgICAgIHN5cy5zdGRvdXQsIGEgc29ja2V0LCBhIHRhcGUgZGV2aWNlIGV0Yy5cblwKXG5cCiAgICAgICBfU3RyZWFtIGlzIGludGVuZGVkIHRvIGJlIHVzZWQgb25seSBpbnRlcm5hbGx5LlxuXAogICAgIgokX1N0cmVhbS5fX21vZHVsZV9fPSJfX21haW5fXyIKdmFyIF9TdHJlYW09JGNsYXNzX2NvbnN0cnVjdG9yKCJfU3RyZWFtIiwkX1N0cmVhbSkKd2luZG93Ll9TdHJlYW09X1N0cmVhbQpfX0JSWVRIT05fXy5zY29wZVsiX19tYWluX18iXS5fX2RpY3RfX1siX1N0cmVhbSJdPV9TdHJlYW0KZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTk2LCJfX21haW5fXyJdO05vbmU7CnZhciAkX1N0cmVhbVByb3h5PShmdW5jdGlvbigpewogICAgdmFyICRjbGFzcyA9IG5ldyBPYmplY3QoKQogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNTk3LCJfX21haW5fXyJdO05vbmU7CiAgICAiU21hbGwgcHJveHkgY2xhc3MgdGhhdCBlbmFibGVzIHRyYW5zcGFyZW50IGNvbXByZXNzaW9uXG5cCiAgICAgICBkZXRlY3Rpb24gZm9yIHRoZSBTdHJlYW0gaW50ZXJmYWNlIChtb2RlICdyfConKS5cblwKICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzYwMSwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLl9faW5pdF9fPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJfX2luaXRfXyIsYXJndW1lbnRzLFsic2VsZiIsImZpbGVvYmoiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbIm9qeXRud2d1Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2MDIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiZmlsZW9iaiIsZmlsZW9iaik7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzYwMywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJidWYiLGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHNlbGYsImZpbGVvYmoiKSwicmVhZCIpLCJfX2NhbGxfXyIpKEJMT0NLU0laRSkpO05vbmU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE1OSl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNTkpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9faW5pdF9fLl9fbmFtZV9fPSJfX2luaXRfXyIKICAgICRjbGFzcy5fX2luaXRfXy5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9faW5pdF9fLl9fZG9jX189IiIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzYwNSwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLnJlYWQ9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoInJlYWQiLGFyZ3VtZW50cyxbInNlbGYiLCJzaXplIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJsYm1id3J1NyJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjA2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsInJlYWQiLGdldGF0dHIoZ2V0YXR0cihzZWxmLCJmaWxlb2JqIiksInJlYWQiKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzYwNywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoc2VsZiwiYnVmIikKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTU5KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE1OSl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MucmVhZC5fX25hbWVfXz0icmVhZCIKICAgICRjbGFzcy5yZWFkLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MucmVhZC5fX2RvY19fPSIiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2MDksIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5nZXRjb21wdHlwZT0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiZ2V0Y29tcHR5cGUiLGFyZ3VtZW50cyxbInNlbGYiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImgzM2FxdnZyIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2MTAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwiYnVmIiksInN0YXJ0c3dpdGgiKSwiX19jYWxsX18iKShieXRlcygiXHgxZlx4OGJceDA4IikpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjExLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJneiIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwiYnVmIiksIl9fZ2V0aXRlbV9fIikoc2xpY2UoTnVtYmVyKDApLE51bWJlcigzKSkpLCJfX2VxX18iKShieXRlcygiQlpoIikpKSYmJHRlc3RfaXRlbShnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJidWYiKSwiX19nZXRpdGVtX18iKShzbGljZShOdW1iZXIoNCksTnVtYmVyKDEwKSkpLCJfX2VxX18iKShieXRlcygiMUFZJlNZIikpKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2MTMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gImJ6MiIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJidWYiKSwic3RhcnRzd2l0aCIpLCJfX2NhbGxfXyIpKHR1cGxlKFtieXRlcygiXHg1ZFx4MDBceDAwXHg4MCIpLGJ5dGVzKCJceGZkN3pYWiIpXSkpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjE1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJ4eiIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjE3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJ0YXIiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE1OSl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNTkpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLmdldGNvbXB0eXBlLl9fbmFtZV9fPSJnZXRjb21wdHlwZSIKICAgICRjbGFzcy5nZXRjb21wdHlwZS5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLmdldGNvbXB0eXBlLl9fZG9jX189IiIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzYxOSwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLmNsb3NlPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJjbG9zZSIsYXJndW1lbnRzLFsic2VsZiJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiMmRmaXZkc2IiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzYyMCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwiZmlsZW9iaiIpLCJjbG9zZSIpLCJfX2NhbGxfXyIpKCkKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTU5KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE1OSl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuY2xvc2UuX19uYW1lX189ImNsb3NlIgogICAgJGNsYXNzLmNsb3NlLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuY2xvc2UuX19kb2NfXz0iIgogICAgcmV0dXJuICRjbGFzcwp9CikoKQokX1N0cmVhbVByb3h5Ll9fZG9jX189IlNtYWxsIHByb3h5IGNsYXNzIHRoYXQgZW5hYmxlcyB0cmFuc3BhcmVudCBjb21wcmVzc2lvblxuXAogICAgICAgZGV0ZWN0aW9uIGZvciB0aGUgU3RyZWFtIGludGVyZmFjZSAobW9kZSAncnwqJykuXG5cCiAgICAiCiRfU3RyZWFtUHJveHkuX19tb2R1bGVfXz0iX19tYWluX18iCnZhciBfU3RyZWFtUHJveHk9JGNsYXNzX2NvbnN0cnVjdG9yKCJfU3RyZWFtUHJveHkiLCRfU3RyZWFtUHJveHksb2JqZWN0KQp3aW5kb3cuX1N0cmVhbVByb3h5PV9TdHJlYW1Qcm94eQpfX0JSWVRIT05fXy5zY29wZVsiX19tYWluX18iXS5fX2RpY3RfX1siX1N0cmVhbVByb3h5Il09X1N0cmVhbVByb3h5CmRvY3VtZW50LiRsaW5lX2luZm89WzYyNiwiX19tYWluX18iXTtOb25lOwp2YXIgJF9GaWxlSW5GaWxlPShmdW5jdGlvbigpewogICAgdmFyICRjbGFzcyA9IG5ldyBPYmplY3QoKQogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjI3LCJfX21haW5fXyJdO05vbmU7CiAgICAiQSB0aGluIHdyYXBwZXIgYXJvdW5kIGFuIGV4aXN0aW5nIGZpbGUgb2JqZWN0IHRoYXRcblwKICAgICAgIHByb3ZpZGVzIGEgcGFydCBvZiBpdHMgZGF0YSBhcyBhbiBpbmRpdmlkdWFsIGZpbGVcblwKICAgICAgIG9iamVjdC5cblwKICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzYzMiwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLl9faW5pdF9fPSAoZnVuY3Rpb24gKE5vbmUpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiX19pbml0X18iLGFyZ3VtZW50cyxbInNlbGYiLCJmaWxlb2JqIiwib2Zmc2V0Iiwic2l6ZSJdLHsiYmxvY2tpbmZvIjooJGNsYXNzWyJOb25lIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJOb25lIl0gOiBOb25lKX0sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJob3puZzg3MyJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjMzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImZpbGVvYmoiLGZpbGVvYmopO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2MzQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwib2Zmc2V0IixvZmZzZXQpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2MzUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwic2l6ZSIsc2l6ZSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzYzNiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJwb3NpdGlvbiIsTnVtYmVyKDApKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjM3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsIm5hbWUiLGdldGF0dHIoZ2V0YXR0ciwiX19jYWxsX18iKShmaWxlb2JqLCJuYW1lIixOb25lKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzYzOCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJjbG9zZWQiLEZhbHNlKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjQwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGJsb2NraW5mbz09PU5vbmUpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2NDEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgYmxvY2tpbmZvPSRsb2NhbHNbImJsb2NraW5mbyJdPWxpc3QuX19jYWxsX18oW3R1cGxlKFtOdW1iZXIoMCksc2l6ZV0pXSk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzY0NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJtYXBfaW5kZXgiLE51bWJlcigwKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzY0NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJtYXAiLGxpc3QuX19jYWxsX18oW10pKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjQ2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgbGFzdHBvcz0kbG9jYWxzWyJsYXN0cG9zIl09TnVtYmVyKDApO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2NDcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciByZWFscG9zPSRsb2NhbHNbInJlYWxwb3MiXT1nZXRhdHRyKHNlbGYsIm9mZnNldCIpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2NDgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciAkbmV4dDExNTk9Z2V0YXR0cihpdGVyKGJsb2NraW5mbyksIl9fbmV4dF9fIikKICAgICAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMTU5PXRydWU7d2hpbGUodHJ1ZSl7CiAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICAkcmlnaHQ9aXRlcigkbmV4dDExNTkoKSk7JGNvdW50ZXI9LTEKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9mZnNldD0kbG9jYWxzWyJvZmZzZXQiXT1uZXh0KCRyaWdodCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaXplPSRsb2NhbHNbInNpemUiXT1uZXh0KCRyaWdodCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTE2MCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkZXJyMTE2MC5fX25hbWVfXz09IlN0b3BJdGVyYXRpb24iKXskcG9wX2V4YygpO3Rocm93IFZhbHVlRXJyb3IoIm5lZWQgbW9yZSB0aGFuICIrJGNvdW50ZXIrIiB2YWx1ZSIrKCRjb3VudGVyPjEgPyAicyIgOiAiIikrIiB0byB1bnBhY2siKX0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGV4aGF1c3RlZD10cnVlO3RyeXtuZXh0KCRyaWdodCk7JGV4aGF1c3RlZD1mYWxzZX1jYXRjaChlcnIpe2lmKGVyci5fX25hbWVfXz09IlN0b3BJdGVyYXRpb24iKXskcG9wX2V4YygpfX1pZighJGV4aGF1c3RlZCl7dGhyb3cgVmFsdWVFcnJvcigidG9vIG1hbnkgdmFsdWVzIHRvIHVucGFjayAoZXhwZWN0ZWQgIisoJGNvdW50ZXIrMSkrIikiKX0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycil7aWYoJGlzX2V4YygkZXJyLFtTdG9wSXRlcmF0aW9uXSkpeyRwb3BfZXhjKCk7YnJlYWt9ZWxzZXt0aHJvdygkZXJyKX19CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjQ5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKG9mZnNldCwiX19ndF9fIikobGFzdHBvcykpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjUwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHNlbGYsIm1hcCIpLCJhcHBlbmQiKSwiX19jYWxsX18iKSh0dXBsZShbRmFsc2UsbGFzdHBvcyxvZmZzZXQsTm9uZV0pKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2NTEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJtYXAiKSwiYXBwZW5kIiksIl9fY2FsbF9fIikodHVwbGUoW1RydWUsb2Zmc2V0LGdldGF0dHIob2Zmc2V0LCJfX2FkZF9fIikoc2l6ZSkscmVhbHBvc10pKQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzY1MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciAkdGVtcD0kbG9jYWxzWyIkdGVtcCJdPXNpemU7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZigkdGVtcC4kZmFzdF9hdWdtICYmIHJlYWxwb3MuJGZhc3RfYXVnbSl7cmVhbHBvcys9JHRlbXA7JGxvY2Fsc1sicmVhbHBvcyJdPXJlYWxwb3N9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZighaGFzYXR0cihyZWFscG9zLCJfX2lhZGRfXyIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlYWxwb3M9JGxvY2Fsc1sicmVhbHBvcyJdPWdldGF0dHIocmVhbHBvcywiX19hZGRfXyIpKCR0ZW1wKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICByZWFscG9zPSRsb2NhbHNbInJlYWxwb3MiXT1nZXRhdHRyKHJlYWxwb3MsIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzY1MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBsYXN0cG9zPSRsb2NhbHNbImxhc3Rwb3MiXT1nZXRhdHRyKG9mZnNldCwiX19hZGRfXyIpKHNpemUpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2NTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihsYXN0cG9zLCJfX2x0X18iKShnZXRhdHRyKHNlbGYsInNpemUiKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2NTUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJtYXAiKSwiYXBwZW5kIiksIl9fY2FsbF9fIikodHVwbGUoW0ZhbHNlLGxhc3Rwb3MsZ2V0YXR0cihzZWxmLCJzaXplIiksTm9uZV0pKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNTkpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTU5KX0KICAgICAgICB9CiAgICB9CiAgICApKCRjbGFzcy5Ob25lICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5Ob25lIDogTm9uZSkKICAgICRjbGFzcy5fX2luaXRfXy5fX25hbWVfXz0iX19pbml0X18iCiAgICAkY2xhc3MuX19pbml0X18uX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5fX2luaXRfXy5fX2RvY19fPSIiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2NTcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5mbHVzaD0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiZmx1c2giLGFyZ3VtZW50cyxbInNlbGYiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbInAzbDBycmp6Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2NTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZvaWQoMCkKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTYxKXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE2MSl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuZmx1c2guX19uYW1lX189ImZsdXNoIgogICAgJGNsYXNzLmZsdXNoLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuZmx1c2guX19kb2NfXz0iIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjYwLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MucmVhZGFibGU9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoInJlYWRhYmxlIixhcmd1bWVudHMsWyJzZWxmIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJoN2prdWdldyJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjYxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNjEpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTYxKX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5yZWFkYWJsZS5fX25hbWVfXz0icmVhZGFibGUiCiAgICAkY2xhc3MucmVhZGFibGUuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5yZWFkYWJsZS5fX2RvY19fPSIiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2NjMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy53cml0YWJsZT0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygid3JpdGFibGUiLGFyZ3VtZW50cyxbInNlbGYiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImxtYXl6YzkyIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2NjQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNjEpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTYxKX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy53cml0YWJsZS5fX25hbWVfXz0id3JpdGFibGUiCiAgICAkY2xhc3Mud3JpdGFibGUuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy53cml0YWJsZS5fX2RvY19fPSIiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2NjYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5zZWVrYWJsZT0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygic2Vla2FibGUiLGFyZ3VtZW50cyxbInNlbGYiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImQxcWo0dmY2Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2NjcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiBnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJmaWxlb2JqIiksInNlZWthYmxlIiksIl9fY2FsbF9fIikoKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNjEpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTYxKX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5zZWVrYWJsZS5fX25hbWVfXz0ic2Vla2FibGUiCiAgICAkY2xhc3Muc2Vla2FibGUuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5zZWVrYWJsZS5fX2RvY19fPSIiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2NjksIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy50ZWxsPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJ0ZWxsIixhcmd1bWVudHMsWyJzZWxmIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJmbGs3dHBiciJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjcwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiUmV0dXJuIHRoZSBjdXJyZW50IGZpbGUgcG9zaXRpb24uXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjcyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0YXR0cihzZWxmLCJwb3NpdGlvbiIpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE2MSl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNjEpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLnRlbGwuX19uYW1lX189InRlbGwiCiAgICAkY2xhc3MudGVsbC5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLnRlbGwuX19kb2NfXz0iUmV0dXJuIHRoZSBjdXJyZW50IGZpbGUgcG9zaXRpb24uXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjc0LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3Muc2Vlaz0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygic2VlayIsYXJndW1lbnRzLFsic2VsZiIsInBvc2l0aW9uIl0seyJ3aGVuY2UiOmdldGF0dHIoKCRjbGFzc1siaW8iXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbImlvIl0gOiBpbyksIlNFRUtfU0VUIil9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsid3oyNmV3Y20iXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzY3NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIlNlZWsgdG8gYSBwb3NpdGlvbiBpbiB0aGUgZmlsZS5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2NzcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cih3aGVuY2UsIl9fZXFfXyIpKGdldGF0dHIoaW8sIlNFRUtfU0VUIikpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjc4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJwb3NpdGlvbiIsZ2V0YXR0cihtaW4sIl9fY2FsbF9fIikoZ2V0YXR0cihtYXgsIl9fY2FsbF9fIikocG9zaXRpb24sTnVtYmVyKDApKSxnZXRhdHRyKHNlbGYsInNpemUiKSkpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGJvb2woZ2V0YXR0cih3aGVuY2UsIl9fZXFfXyIpKGdldGF0dHIoaW8sIlNFRUtfQ1VSIikpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjgwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKHBvc2l0aW9uLCJfX2x0X18iKShOdW1iZXIoMCkpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzY4MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsInBvc2l0aW9uIixnZXRhdHRyKG1heCwiX19jYWxsX18iKShnZXRhdHRyKGdldGF0dHIoc2VsZiwicG9zaXRpb24iKSwiX19hZGRfXyIpKHBvc2l0aW9uKSxOdW1iZXIoMCkpKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2ODMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJwb3NpdGlvbiIsZ2V0YXR0cihtaW4sIl9fY2FsbF9fIikoZ2V0YXR0cihnZXRhdHRyKHNlbGYsInBvc2l0aW9uIiksIl9fYWRkX18iKShwb3NpdGlvbiksZ2V0YXR0cihzZWxmLCJzaXplIikpKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoYm9vbChnZXRhdHRyKHdoZW5jZSwiX19lcV9fIikoZ2V0YXR0cihpbywiU0VFS19FTkQiKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2ODUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsInBvc2l0aW9uIixnZXRhdHRyKG1heCwiX19jYWxsX18iKShnZXRhdHRyKG1pbiwiX19jYWxsX18iKShnZXRhdHRyKGdldGF0dHIoc2VsZiwic2l6ZSIpLCJfX2FkZF9fIikocG9zaXRpb24pLGdldGF0dHIoc2VsZiwic2l6ZSIpKSxOdW1iZXIoMCkpKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs2ODcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKFZhbHVlRXJyb3IsIl9fY2FsbF9fIikoIkludmFsaWQgYXJndW1lbnQiKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjg4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0YXR0cihzZWxmLCJwb3NpdGlvbiIpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE2MSl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNjEpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLnNlZWsuX19uYW1lX189InNlZWsiCiAgICAkY2xhc3Muc2Vlay5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLnNlZWsuX19kb2NfXz0iU2VlayB0byBhIHBvc2l0aW9uIGluIHRoZSBmaWxlLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzY5MCwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLnJlYWQ9IChmdW5jdGlvbiAoTm9uZSl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJyZWFkIixhcmd1bWVudHMsWyJzZWxmIl0seyJzaXplIjooJGNsYXNzWyJOb25lIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJOb25lIl0gOiBOb25lKX0sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJnNzQxd3R6MCJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjkxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiUmVhZCBkYXRhIGZyb20gdGhlIGZpbGUuXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjkzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKHNpemU9PT1Ob25lKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjk0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHNpemU9JGxvY2Fsc1sic2l6ZSJdPWdldGF0dHIoZ2V0YXR0cihzZWxmLCJzaXplIiksIl9fc3ViX18iKShnZXRhdHRyKHNlbGYsInBvc2l0aW9uIikpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzY5NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBzaXplPSRsb2NhbHNbInNpemUiXT1nZXRhdHRyKG1pbiwiX19jYWxsX18iKShzaXplLGdldGF0dHIoZ2V0YXR0cihzZWxmLCJzaXplIiksIl9fc3ViX18iKShnZXRhdHRyKHNlbGYsInBvc2l0aW9uIikpKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjk4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgYnVmPSRsb2NhbHNbImJ1ZiJdPWJ5dGVzKCIiKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNjk5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTEzNT10cnVlO3doaWxlKGJvb2woZ2V0YXR0cihzaXplLCJfX2d0X18iKShOdW1iZXIoMCkpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzAwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICRub19icmVhazExMzY9dHJ1ZTt3aGlsZShib29sKFRydWUpKXsKICAgICAgICAgICAgICAgICAgICAgICAgJHJpZ2h0PWl0ZXIoZ2V0YXR0cihnZXRhdHRyKHNlbGYsIm1hcCIpLCJfX2dldGl0ZW1fXyIpKGdldGF0dHIoc2VsZiwibWFwX2luZGV4IikpKTskY291bnRlcj0tMQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3MDEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGE9JGxvY2Fsc1siZGF0YSJdPW5leHQoJHJpZ2h0KTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0PSRsb2NhbHNbInN0YXJ0Il09bmV4dCgkcmlnaHQpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY291bnRlcisrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RvcD0kbG9jYWxzWyJzdG9wIl09bmV4dCgkcmlnaHQpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY291bnRlcisrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0PSRsb2NhbHNbIm9mZnNldCJdPW5leHQoJHJpZ2h0KTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIxMTYxKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRlcnIxMTYxLl9fbmFtZV9fPT0iU3RvcEl0ZXJhdGlvbiIpeyRwb3BfZXhjKCk7dGhyb3cgVmFsdWVFcnJvcigibmVlZCBtb3JlIHRoYW4gIiskY291bnRlcisiIHZhbHVlIisoJGNvdW50ZXI+MSA/ICJzIiA6ICIiKSsiIHRvIHVucGFjayIpfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZXhoYXVzdGVkPXRydWU7dHJ5e25leHQoJHJpZ2h0KTskZXhoYXVzdGVkPWZhbHNlfWNhdGNoKGVycil7aWYoZXJyLl9fbmFtZV9fPT0iU3RvcEl0ZXJhdGlvbiIpeyRwb3BfZXhjKCl9fWlmKCEkZXhoYXVzdGVkKXt0aHJvdyBWYWx1ZUVycm9yKCJ0b28gbWFueSB2YWx1ZXMgdG8gdW5wYWNrIChleHBlY3RlZCAiKygkY291bnRlcisxKSsiKSIpfQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3MDIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oZ2V0YXR0cihzdGFydCwiX19sZV9fIikoZ2V0YXR0cihzZWxmLCJwb3NpdGlvbiIpKSkmJiR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKHNlbGYsInBvc2l0aW9uIiksIl9fbHRfXyIpKHN0b3ApKSkpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzcwMywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRub19icmVhazExMzY9ZmFsc2U7YnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzA1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJHRlbXA9JGxvY2Fsc1siJHRlbXAiXT1OdW1iZXIoMSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFoYXNhdHRyKGdldGF0dHIoc2VsZiwibWFwX2luZGV4IiksIl9faWFkZF9fIikpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwibWFwX2luZGV4IixnZXRhdHRyKGdldGF0dHIoc2VsZiwibWFwX2luZGV4IiksIl9fYWRkX18iKSgkdGVtcCkpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoc2VsZiwibWFwX2luZGV4Iik9Z2V0YXR0cihnZXRhdHRyKHNlbGYsIm1hcF9pbmRleCIpLCJfX2lhZGRfXyIpKCR0ZW1wKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzA2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJtYXBfaW5kZXgiKSwiX19lcV9fIikoZ2V0YXR0cihsZW4sIl9fY2FsbF9fIikoZ2V0YXR0cihzZWxmLCJtYXAiKSkpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzA3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJtYXBfaW5kZXgiLE51bWJlcigwKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3MDgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgbGVuZ3RoPSRsb2NhbHNbImxlbmd0aCJdPWdldGF0dHIobWluLCJfX2NhbGxfXyIpKHNpemUsZ2V0YXR0cihzdG9wLCJfX3N1Yl9fIikoZ2V0YXR0cihzZWxmLCJwb3NpdGlvbiIpKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3MDksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZihib29sKGRhdGEpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzEwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHNlbGYsImZpbGVvYmoiKSwic2VlayIpLCJfX2NhbGxfXyIpKGdldGF0dHIob2Zmc2V0LCJfX2FkZF9fIikoZ2V0YXR0cihnZXRhdHRyKHNlbGYsInBvc2l0aW9uIiksIl9fc3ViX18iKShzdGFydCkpKQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3MTEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyICR0ZW1wPSRsb2NhbHNbIiR0ZW1wIl09Z2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwiZmlsZW9iaiIpLCJyZWFkIiksIl9fY2FsbF9fIikobGVuZ3RoKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBpZigkdGVtcC4kZmFzdF9hdWdtICYmIGJ1Zi4kZmFzdF9hdWdtKXtidWYrPSR0ZW1wOyRsb2NhbHNbImJ1ZiJdPWJ1Zn0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZighaGFzYXR0cihidWYsIl9faWFkZF9fIikpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ1Zj0kbG9jYWxzWyJidWYiXT1nZXRhdHRyKGJ1ZiwiX19hZGRfXyIpKCR0ZW1wKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWY9JGxvY2Fsc1siYnVmIl09Z2V0YXR0cihidWYsIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzEzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkdGVtcD0kbG9jYWxzWyIkdGVtcCJdPWdldGF0dHIoTlVMLCJfX211bF9fIikobGVuZ3RoKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBpZigkdGVtcC4kZmFzdF9hdWdtICYmIGJ1Zi4kZmFzdF9hdWdtKXtidWYrPSR0ZW1wOyRsb2NhbHNbImJ1ZiJdPWJ1Zn0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZighaGFzYXR0cihidWYsIl9faWFkZF9fIikpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ1Zj0kbG9jYWxzWyJidWYiXT1nZXRhdHRyKGJ1ZiwiX19hZGRfXyIpKCR0ZW1wKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWY9JGxvY2Fsc1siYnVmIl09Z2V0YXR0cihidWYsIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzE0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICR0ZW1wPSRsb2NhbHNbIiR0ZW1wIl09bGVuZ3RoO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoJHRlbXAuJGZhc3RfYXVnbSAmJiBzaXplLiRmYXN0X2F1Z20pe3NpemUtPSR0ZW1wOyRsb2NhbHNbInNpemUiXT1zaXplfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoIWhhc2F0dHIoc2l6ZSwiX19pc3ViX18iKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaXplPSRsb2NhbHNbInNpemUiXT1nZXRhdHRyKHNpemUsIl9fc3ViX18iKSgkdGVtcCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT0kbG9jYWxzWyJzaXplIl09Z2V0YXR0cihzaXplLCJfX2lzdWJfXyIpKCR0ZW1wKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3MTUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgJHRlbXA9JGxvY2Fsc1siJHRlbXAiXT1sZW5ndGg7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZighaGFzYXR0cihnZXRhdHRyKHNlbGYsInBvc2l0aW9uIiksIl9faWFkZF9fIikpewogICAgICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsInBvc2l0aW9uIixnZXRhdHRyKGdldGF0dHIoc2VsZiwicG9zaXRpb24iKSwiX19hZGRfXyIpKCR0ZW1wKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihzZWxmLCJwb3NpdGlvbiIpPWdldGF0dHIoZ2V0YXR0cihzZWxmLCJwb3NpdGlvbiIpLCJfX2lhZGRfXyIpKCR0ZW1wKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzcxNiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGJ1ZgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNjEpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTYxKX0KICAgICAgICB9CiAgICB9CiAgICApKCRjbGFzcy5Ob25lICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5Ob25lIDogTm9uZSkKICAgICRjbGFzcy5yZWFkLl9fbmFtZV9fPSJyZWFkIgogICAgJGNsYXNzLnJlYWQuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5yZWFkLl9fZG9jX189IlJlYWQgZGF0YSBmcm9tIHRoZSBmaWxlLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzcxOCwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLnJlYWRpbnRvPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJyZWFkaW50byIsYXJndW1lbnRzLFsic2VsZiIsImIiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbInoxcTNqYjR1Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3MTksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBidWY9JGxvY2Fsc1siYnVmIl09Z2V0YXR0cihnZXRhdHRyKHNlbGYsInJlYWQiKSwiX19jYWxsX18iKShnZXRhdHRyKGxlbiwiX19jYWxsX18iKShiKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzcyMCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihiLCJfX3NldGl0ZW1fXyIpKHNsaWNlKG51bGwsZ2V0YXR0cihsZW4sIl9fY2FsbF9fIikoYnVmKSksYnVmKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzIxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0YXR0cihsZW4sIl9fY2FsbF9fIikoYnVmKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNjIpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTYyKX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5yZWFkaW50by5fX25hbWVfXz0icmVhZGludG8iCiAgICAkY2xhc3MucmVhZGludG8uX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5yZWFkaW50by5fX2RvY19fPSIiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3MjMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5jbG9zZT0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiY2xvc2UiLGFyZ3VtZW50cyxbInNlbGYiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbInBvNnNwYzI5Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3MjQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiY2xvc2VkIixUcnVlKTtOb25lOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNjIpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTYyKX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5jbG9zZS5fX25hbWVfXz0iY2xvc2UiCiAgICAkY2xhc3MuY2xvc2UuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5jbG9zZS5fX2RvY19fPSIiCiAgICByZXR1cm4gJGNsYXNzCn0KKSgpCiRfRmlsZUluRmlsZS5fX2RvY19fPSJBIHRoaW4gd3JhcHBlciBhcm91bmQgYW4gZXhpc3RpbmcgZmlsZSBvYmplY3QgdGhhdFxuXAogICAgICAgcHJvdmlkZXMgYSBwYXJ0IG9mIGl0cyBkYXRhIGFzIGFuIGluZGl2aWR1YWwgZmlsZVxuXAogICAgICAgb2JqZWN0LlxuXAogICAgIgokX0ZpbGVJbkZpbGUuX19tb2R1bGVfXz0iX19tYWluX18iCnZhciBfRmlsZUluRmlsZT0kY2xhc3NfY29uc3RydWN0b3IoIl9GaWxlSW5GaWxlIiwkX0ZpbGVJbkZpbGUsb2JqZWN0KQp3aW5kb3cuX0ZpbGVJbkZpbGU9X0ZpbGVJbkZpbGUKX19CUllUSE9OX18uc2NvcGVbIl9fbWFpbl9fIl0uX19kaWN0X19bIl9GaWxlSW5GaWxlIl09X0ZpbGVJbkZpbGUKZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzI3LCJfX21haW5fXyJdO05vbmU7CnZhciAkRXhGaWxlT2JqZWN0PShmdW5jdGlvbigpewogICAgdmFyICRjbGFzcyA9IG5ldyBPYmplY3QoKQogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzI5LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX19pbml0X189IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9faW5pdF9fIixhcmd1bWVudHMsWyJzZWxmIiwidGFyZmlsZSIsInRhcmluZm8iXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbInFpbHpybXd0Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3MzAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBmaWxlb2JqPSRsb2NhbHNbImZpbGVvYmoiXT1nZXRhdHRyKF9GaWxlSW5GaWxlLCJfX2NhbGxfXyIpKGdldGF0dHIodGFyZmlsZSwiZmlsZW9iaiIpLGdldGF0dHIodGFyaW5mbywib2Zmc2V0X2RhdGEiKSxnZXRhdHRyKHRhcmluZm8sInNpemUiKSxnZXRhdHRyKHRhcmluZm8sInNwYXJzZSIpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzMyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cigkJHN1cGVyLCJfX2NhbGxfXyIpKEV4RmlsZU9iamVjdCksIl9faW5pdF9fIiksIl9fY2FsbF9fIikoZmlsZW9iaikKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTYyKXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE2Mil9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuX19pbml0X18uX19uYW1lX189Il9faW5pdF9fIgogICAgJGNsYXNzLl9faW5pdF9fLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuX19pbml0X18uX19kb2NfXz0iIgogICAgcmV0dXJuICRjbGFzcwp9CikoKQokRXhGaWxlT2JqZWN0Ll9fZG9jX189IiIKJEV4RmlsZU9iamVjdC5fX21vZHVsZV9fPSJfX21haW5fXyIKdmFyIEV4RmlsZU9iamVjdD0kY2xhc3NfY29uc3RydWN0b3IoIkV4RmlsZU9iamVjdCIsJEV4RmlsZU9iamVjdCxnZXRhdHRyKGlvLCJCdWZmZXJlZFJlYWRlciIpKQp3aW5kb3cuRXhGaWxlT2JqZWN0PUV4RmlsZU9iamVjdApfX0JSWVRIT05fXy5zY29wZVsiX19tYWluX18iXS5fX2RpY3RfX1siRXhGaWxlT2JqZWN0Il09RXhGaWxlT2JqZWN0CmRvY3VtZW50LiRsaW5lX2luZm89WzczOCwiX19tYWluX18iXTtOb25lOwp2YXIgJFRhckluZm89KGZ1bmN0aW9uKCl7CiAgICB2YXIgJGNsYXNzID0gbmV3IE9iamVjdCgpCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3MzksIl9fbWFpbl9fIl07Tm9uZTsKICAgICJJbmZvcm1hdGlvbmFsIGNsYXNzIHdoaWNoIGhvbGRzIHRoZSBkZXRhaWxzIGFib3V0IGFuXG5cCiAgICAgICBhcmNoaXZlIG1lbWJlciBnaXZlbiBieSBhIHRhciBoZWFkZXIgYmxvY2suXG5cCiAgICAgICBUYXJJbmZvIG9iamVjdHMgYXJlIHJldHVybmVkIGJ5IFRhckZpbGUuZ2V0bWVtYmVyKCksXG5cCiAgICAgICBUYXJGaWxlLmdldG1lbWJlcnMoKSBhbmQgVGFyRmlsZS5nZXR0YXJpbmZvKCkgYW5kIGFyZVxuXAogICAgICAgdXN1YWxseSBjcmVhdGVkIGludGVybmFsbHkuXG5cCiAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3NDYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5fX3Nsb3RzX189dHVwbGUoWyJuYW1lIiwibW9kZSIsInVpZCIsImdpZCIsInNpemUiLCJtdGltZSIsImNoa3N1bSIsInR5cGUiLCJsaW5rbmFtZSIsInVuYW1lIiwiZ25hbWUiLCJkZXZtYWpvciIsImRldm1pbm9yIiwib2Zmc2V0Iiwib2Zmc2V0X2RhdGEiLCJwYXhfaGVhZGVycyIsInNwYXJzZSIsInRhcmZpbGUiLCJfc3BhcnNlX3N0cnVjdHMiLCJfbGlua190YXJnZXQiXSkKICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc1MiwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLl9faW5pdF9fPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJfX2luaXRfXyIsYXJndW1lbnRzLFsic2VsZiJdLHsibmFtZSI6IiJ9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsidHNtMTdvZXciXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc1MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIkNvbnN0cnVjdCBhIFRhckluZm8gb2JqZWN0LiBuYW1lIGlzIHRoZSBvcHRpb25hbCBuYW1lXG5cCiAgICAgICAgICAgb2YgdGhlIG1lbWJlci5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3NTYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwibmFtZSIsbmFtZSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc1NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJtb2RlIixOdW1iZXIoNDIwKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc1OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJ1aWQiLE51bWJlcigwKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc1OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJnaWQiLE51bWJlcigwKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc2MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJzaXplIixOdW1iZXIoMCkpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3NjEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwibXRpbWUiLE51bWJlcigwKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc2MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJjaGtzdW0iLE51bWJlcigwKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc2MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJ0eXBlIixSRUdUWVBFKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzY0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImxpbmtuYW1lIiwiIik7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc2NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJ1bmFtZSIsIiIpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3NjYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiZ25hbWUiLCIiKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzY3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImRldm1ham9yIixOdW1iZXIoMCkpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3NjgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiZGV2bWlub3IiLE51bWJlcigwKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc3MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJvZmZzZXQiLE51bWJlcigwKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc3MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJvZmZzZXRfZGF0YSIsTnVtYmVyKDApKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzczLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsInNwYXJzZSIsTm9uZSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc3NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJwYXhfaGVhZGVycyIsJGRpY3QoW10pKTtOb25lOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNjIpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTYyKX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5fX2luaXRfXy5fX25hbWVfXz0iX19pbml0X18iCiAgICAkY2xhc3MuX19pbml0X18uX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5fX2luaXRfXy5fX2RvY19fPSJDb25zdHJ1Y3QgYSBUYXJJbmZvIG9iamVjdC4gbmFtZSBpcyB0aGUgb3B0aW9uYWwgbmFtZVxuXAogICAgICAgICAgIG9mIHRoZSBtZW1iZXIuXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzc4LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX2dldHBhdGg9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9nZXRwYXRoIixhcmd1bWVudHMsWyJzZWxmIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJ5M2xkMGhiaSJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzc5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0YXR0cihzZWxmLCJuYW1lIikKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTYyKXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE2Mil9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuX2dldHBhdGguX19uYW1lX189Il9nZXRwYXRoIgogICAgJGNsYXNzLl9nZXRwYXRoLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuX2dldHBhdGguX19kb2NfXz0iIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzgwLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX3NldHBhdGg9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9zZXRwYXRoIixhcmd1bWVudHMsWyJzZWxmIiwibmFtZSJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsib3E1eThwaWMiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc4MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJuYW1lIixuYW1lKTtOb25lOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNjIpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTYyKX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5fc2V0cGF0aC5fX25hbWVfXz0iX3NldHBhdGgiCiAgICAkY2xhc3MuX3NldHBhdGguX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5fc2V0cGF0aC5fX2RvY19fPSIiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3ODIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5wYXRoPWdldGF0dHIoKCRjbGFzc1sicHJvcGVydHkiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbInByb3BlcnR5Il0gOiBwcm9wZXJ0eSksIl9fY2FsbF9fIikoKCRjbGFzc1siX2dldHBhdGgiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIl9nZXRwYXRoIl0gOiBfZ2V0cGF0aCksKCRjbGFzc1siX3NldHBhdGgiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIl9zZXRwYXRoIl0gOiBfc2V0cGF0aCkpCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3ODQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5fZ2V0bGlua3BhdGg9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9nZXRsaW5rcGF0aCIsYXJndW1lbnRzLFsic2VsZiJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsidHN6Y2t2MHIiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc4NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoc2VsZiwibGlua25hbWUiKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNjIpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTYyKX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5fZ2V0bGlua3BhdGguX19uYW1lX189Il9nZXRsaW5rcGF0aCIKICAgICRjbGFzcy5fZ2V0bGlua3BhdGguX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5fZ2V0bGlua3BhdGguX19kb2NfXz0iIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzg2LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX3NldGxpbmtwYXRoPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJfc2V0bGlua3BhdGgiLGFyZ3VtZW50cyxbInNlbGYiLCJsaW5rbmFtZSJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiZGRvMXlxbzgiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc4NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJsaW5rbmFtZSIsbGlua25hbWUpO05vbmU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE2Mil7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNjIpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9zZXRsaW5rcGF0aC5fX25hbWVfXz0iX3NldGxpbmtwYXRoIgogICAgJGNsYXNzLl9zZXRsaW5rcGF0aC5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9zZXRsaW5rcGF0aC5fX2RvY19fPSIiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs3ODgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5saW5rcGF0aD1nZXRhdHRyKCgkY2xhc3NbInByb3BlcnR5Il0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJwcm9wZXJ0eSJdIDogcHJvcGVydHkpLCJfX2NhbGxfXyIpKCgkY2xhc3NbIl9nZXRsaW5rcGF0aCJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siX2dldGxpbmtwYXRoIl0gOiBfZ2V0bGlua3BhdGgpLCgkY2xhc3NbIl9zZXRsaW5rcGF0aCJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siX3NldGxpbmtwYXRoIl0gOiBfc2V0bGlua3BhdGgpKQogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzkwLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX19yZXByX189IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9fcmVwcl9fIixhcmd1bWVudHMsWyJzZWxmIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJlcmJ4MWg3cyJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bNzkxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0YXR0cigiPCVzICVyIGF0ICUjeD4iLCJfX21vZF9fIikodHVwbGUoW2dldGF0dHIoZ2V0YXR0cihzZWxmLCJfX2NsYXNzX18iKSwiX19uYW1lX18iKSxnZXRhdHRyKHNlbGYsIm5hbWUiKSxnZXRhdHRyKGlkLCJfX2NhbGxfXyIpKHNlbGYpXSkpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE2Mil7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNjIpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9fcmVwcl9fLl9fbmFtZV9fPSJfX3JlcHJfXyIKICAgICRjbGFzcy5fX3JlcHJfXy5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9fcmVwcl9fLl9fZG9jX189IiIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc5MywiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLmdldF9pbmZvPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJnZXRfaW5mbyIsYXJndW1lbnRzLFsic2VsZiJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsic2ozbm15bXgiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc5NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIlJldHVybiB0aGUgVGFySW5mbydzIGF0dHJpYnV0ZXMgYXMgYSBkaWN0aW9uYXJ5LlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzc5NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIGluZm89JGxvY2Fsc1siaW5mbyJdPSRkaWN0KFtbIm5hbWUiLGdldGF0dHIoc2VsZiwibmFtZSIpXSxbIm1vZGUiLGdldGF0dHIoZ2V0YXR0cihzZWxmLCJtb2RlIiksIl9fYW5kX18iKShOdW1iZXIoNDA5NSkpXSxbInVpZCIsZ2V0YXR0cihzZWxmLCJ1aWQiKV0sWyJnaWQiLGdldGF0dHIoc2VsZiwiZ2lkIildLFsic2l6ZSIsZ2V0YXR0cihzZWxmLCJzaXplIildLFsibXRpbWUiLGdldGF0dHIoc2VsZiwibXRpbWUiKV0sWyJjaGtzdW0iLGdldGF0dHIoc2VsZiwiY2hrc3VtIildLFsidHlwZSIsZ2V0YXR0cihzZWxmLCJ0eXBlIildLFsibGlua25hbWUiLGdldGF0dHIoc2VsZiwibGlua25hbWUiKV0sWyJ1bmFtZSIsZ2V0YXR0cihzZWxmLCJ1bmFtZSIpXSxbImduYW1lIixnZXRhdHRyKHNlbGYsImduYW1lIildLFsiZGV2bWFqb3IiLGdldGF0dHIoc2VsZiwiZGV2bWFqb3IiKV0sWyJkZXZtaW5vciIsZ2V0YXR0cihzZWxmLCJkZXZtaW5vciIpXV0pO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs4MTIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKGdldGF0dHIoZ2V0YXR0cihpbmZvLCJfX2dldGl0ZW1fXyIpKCJ0eXBlIiksIl9fZXFfXyIpKERJUlRZUEUpKSYmJHRlc3RfaXRlbSghYm9vbChnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihpbmZvLCJfX2dldGl0ZW1fXyIpKCJuYW1lIiksImVuZHN3aXRoIiksIl9fY2FsbF9fIikoIi8iKSkpKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzgxMywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciAkdGVtcD0kbG9jYWxzWyIkdGVtcCJdPSIvIjtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKCFoYXNhdHRyKGdldGF0dHIoaW5mbywiX19nZXRpdGVtX18iKSgibmFtZSIpLCJfX2lhZGRfXyIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihpbmZvLCJfX3NldGl0ZW1fXyIpKCJuYW1lIixnZXRhdHRyKGdldGF0dHIoaW5mbywiX19nZXRpdGVtX18iKSgibmFtZSIpLCJfX2FkZF9fIikoJHRlbXApKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGluZm8sIl9fZ2V0aXRlbV9fIikoIm5hbWUiKT1nZXRhdHRyKGdldGF0dHIoaW5mbywiX19nZXRpdGVtX18iKSgibmFtZSIpLCJfX2lhZGRfXyIpKCR0ZW1wKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzgxNSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGluZm8KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTYyKXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE2Mil9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuZ2V0X2luZm8uX19uYW1lX189ImdldF9pbmZvIgogICAgJGNsYXNzLmdldF9pbmZvLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuZ2V0X2luZm8uX19kb2NfXz0iUmV0dXJuIHRoZSBUYXJJbmZvJ3MgYXR0cmlidXRlcyBhcyBhIGRpY3Rpb25hcnkuXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODE3LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MudG9idWY9IChmdW5jdGlvbiAoREVGQVVMVF9GT1JNQVQsRU5DT0RJTkcpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygidG9idWYiLGFyZ3VtZW50cyxbInNlbGYiXSx7ImZvcm1hdCI6KCRjbGFzc1siREVGQVVMVF9GT1JNQVQiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIkRFRkFVTFRfRk9STUFUIl0gOiBERUZBVUxUX0ZPUk1BVCksImVuY29kaW5nIjooJGNsYXNzWyJFTkNPRElORyJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siRU5DT0RJTkciXSA6IEVOQ09ESU5HKSwiZXJyb3JzIjoic3Vycm9nYXRlZXNjYXBlIn0sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJqdTIzcGo4dCJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODE4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiUmV0dXJuIGEgdGFyIGhlYWRlciBhcyBhIHN0cmluZyBvZiA1MTIgYnl0ZSBibG9ja3MuXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODIwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgaW5mbz0kbG9jYWxzWyJpbmZvIl09Z2V0YXR0cihnZXRhdHRyKHNlbGYsImdldF9pbmZvIiksIl9fY2FsbF9fIikoKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODIyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZm9ybWF0LCJfX2VxX18iKShVU1RBUl9GT1JNQVQpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODIzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJjcmVhdGVfdXN0YXJfaGVhZGVyIiksIl9fY2FsbF9fIikoaW5mbyxlbmNvZGluZyxlcnJvcnMpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGJvb2woZ2V0YXR0cihmb3JtYXQsIl9fZXFfXyIpKEdOVV9GT1JNQVQpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODI1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJjcmVhdGVfZ251X2hlYWRlciIpLCJfX2NhbGxfXyIpKGluZm8sZW5jb2RpbmcsZXJyb3JzKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihib29sKGdldGF0dHIoZm9ybWF0LCJfX2VxX18iKShQQVhfRk9STUFUKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzgyNywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRhdHRyKGdldGF0dHIoc2VsZiwiY3JlYXRlX3BheF9oZWFkZXIiKSwiX19jYWxsX18iKShpbmZvLGVuY29kaW5nKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs4MjksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKFZhbHVlRXJyb3IsIl9fY2FsbF9fIikoImludmFsaWQgZm9ybWF0IikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTYyKXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE2Mil9CiAgICAgICAgfQogICAgfQogICAgKSgkY2xhc3MuREVGQVVMVF9GT1JNQVQgIT0gdW5kZWZpbmVkID8gJGNsYXNzLkRFRkFVTFRfRk9STUFUIDogREVGQVVMVF9GT1JNQVQsJGNsYXNzLkVOQ09ESU5HICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5FTkNPRElORyA6IEVOQ09ESU5HKQogICAgJGNsYXNzLnRvYnVmLl9fbmFtZV9fPSJ0b2J1ZiIKICAgICRjbGFzcy50b2J1Zi5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLnRvYnVmLl9fZG9jX189IlJldHVybiBhIHRhciBoZWFkZXIgYXMgYSBzdHJpbmcgb2YgNTEyIGJ5dGUgYmxvY2tzLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzgzMSwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLmNyZWF0ZV91c3Rhcl9oZWFkZXI9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoImNyZWF0ZV91c3Rhcl9oZWFkZXIiLGFyZ3VtZW50cyxbInNlbGYiLCJpbmZvIiwiZW5jb2RpbmciLCJlcnJvcnMiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImJ4NjQ0eGZwIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs4MzIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJSZXR1cm4gdGhlIG9iamVjdCBhcyBhIHVzdGFyIGhlYWRlciBibG9jay5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs4MzQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGdldGF0dHIoaW5mbywiX19zZXRpdGVtX18iKSgibWFnaWMiLFBPU0lYX01BR0lDKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODM2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cihsZW4sIl9fY2FsbF9fIikoZ2V0YXR0cihpbmZvLCJfX2dldGl0ZW1fXyIpKCJsaW5rbmFtZSIpKSwiX19ndF9fIikoTEVOR1RIX0xJTkspKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODM3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihWYWx1ZUVycm9yLCJfX2NhbGxfXyIpKCJsaW5rbmFtZSBpcyB0b28gbG9uZyIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs4MzksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKGxlbiwiX19jYWxsX18iKShnZXRhdHRyKGluZm8sIl9fZ2V0aXRlbV9fIikoIm5hbWUiKSksIl9fZ3RfXyIpKExFTkdUSF9OQU1FKSkpewogICAgICAgICAgICAgICAgICAgICRyaWdodD1pdGVyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfcG9zaXhfc3BsaXRfbmFtZSIpLCJfX2NhbGxfXyIpKGdldGF0dHIoaW5mbywiX19nZXRpdGVtX18iKSgibmFtZSIpKSk7JGNvdW50ZXI9LTEKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs4NDAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihpbmZvLCJfX3NldGl0ZW1fXyIpKCJwcmVmaXgiLG5leHQoJHJpZ2h0KSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGluZm8sIl9fc2V0aXRlbV9fIikoIm5hbWUiLG5leHQoJHJpZ2h0KSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycjExNjIpewogICAgICAgICAgICAgICAgICAgICAgICBpZigkZXJyMTE2Mi5fX25hbWVfXz09IlN0b3BJdGVyYXRpb24iKXskcG9wX2V4YygpO3Rocm93IFZhbHVlRXJyb3IoIm5lZWQgbW9yZSB0aGFuICIrJGNvdW50ZXIrIiB2YWx1ZSIrKCRjb3VudGVyPjEgPyAicyIgOiAiIikrIiB0byB1bnBhY2siKX0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdmFyICRleGhhdXN0ZWQ9dHJ1ZTt0cnl7bmV4dCgkcmlnaHQpOyRleGhhdXN0ZWQ9ZmFsc2V9Y2F0Y2goZXJyKXtpZihlcnIuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKX19aWYoISRleGhhdXN0ZWQpe3Rocm93IFZhbHVlRXJyb3IoInRvbyBtYW55IHZhbHVlcyB0byB1bnBhY2sgKGV4cGVjdGVkICIrKCRjb3VudGVyKzEpKyIpIil9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs4NDIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX2NyZWF0ZV9oZWFkZXIiKSwiX19jYWxsX18iKShpbmZvLFVTVEFSX0ZPUk1BVCxlbmNvZGluZyxlcnJvcnMpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE2Mil7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNjIpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLmNyZWF0ZV91c3Rhcl9oZWFkZXIuX19uYW1lX189ImNyZWF0ZV91c3Rhcl9oZWFkZXIiCiAgICAkY2xhc3MuY3JlYXRlX3VzdGFyX2hlYWRlci5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLmNyZWF0ZV91c3Rhcl9oZWFkZXIuX19kb2NfXz0iUmV0dXJuIHRoZSBvYmplY3QgYXMgYSB1c3RhciBoZWFkZXIgYmxvY2suXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODQ0LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuY3JlYXRlX2dudV9oZWFkZXI9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoImNyZWF0ZV9nbnVfaGVhZGVyIixhcmd1bWVudHMsWyJzZWxmIiwiaW5mbyIsImVuY29kaW5nIiwiZXJyb3JzIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJtem9sNmJ0ZCJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODQ1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiUmV0dXJuIHRoZSBvYmplY3QgYXMgYSBHTlUgaGVhZGVyIGJsb2NrIHNlcXVlbmNlLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzg0NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihpbmZvLCJfX3NldGl0ZW1fXyIpKCJtYWdpYyIsR05VX01BR0lDKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODQ5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgYnVmPSRsb2NhbHNbImJ1ZiJdPWJ5dGVzKCIiKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODUwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cihsZW4sIl9fY2FsbF9fIikoZ2V0YXR0cihpbmZvLCJfX2dldGl0ZW1fXyIpKCJsaW5rbmFtZSIpKSwiX19ndF9fIikoTEVOR1RIX0xJTkspKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODUxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICR0ZW1wPSRsb2NhbHNbIiR0ZW1wIl09Z2V0YXR0cihnZXRhdHRyKHNlbGYsIl9jcmVhdGVfZ251X2xvbmdfaGVhZGVyIiksIl9fY2FsbF9fIikoZ2V0YXR0cihpbmZvLCJfX2dldGl0ZW1fXyIpKCJsaW5rbmFtZSIpLEdOVVRZUEVfTE9OR0xJTkssZW5jb2RpbmcsZXJyb3JzKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKCR0ZW1wLiRmYXN0X2F1Z20gJiYgYnVmLiRmYXN0X2F1Z20pe2J1Zis9JHRlbXA7JGxvY2Fsc1siYnVmIl09YnVmfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoIWhhc2F0dHIoYnVmLCJfX2lhZGRfXyIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ1Zj0kbG9jYWxzWyJidWYiXT1nZXRhdHRyKGJ1ZiwiX19hZGRfXyIpKCR0ZW1wKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBidWY9JGxvY2Fsc1siYnVmIl09Z2V0YXR0cihidWYsIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODUzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cihsZW4sIl9fY2FsbF9fIikoZ2V0YXR0cihpbmZvLCJfX2dldGl0ZW1fXyIpKCJuYW1lIikpLCJfX2d0X18iKShMRU5HVEhfTkFNRSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs4NTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgJHRlbXA9JGxvY2Fsc1siJHRlbXAiXT1nZXRhdHRyKGdldGF0dHIoc2VsZiwiX2NyZWF0ZV9nbnVfbG9uZ19oZWFkZXIiKSwiX19jYWxsX18iKShnZXRhdHRyKGluZm8sIl9fZ2V0aXRlbV9fIikoIm5hbWUiKSxHTlVUWVBFX0xPTkdOQU1FLGVuY29kaW5nLGVycm9ycyk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZigkdGVtcC4kZmFzdF9hdWdtICYmIGJ1Zi4kZmFzdF9hdWdtKXtidWYrPSR0ZW1wOyRsb2NhbHNbImJ1ZiJdPWJ1Zn0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKCFoYXNhdHRyKGJ1ZiwiX19pYWRkX18iKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBidWY9JGxvY2Fsc1siYnVmIl09Z2V0YXR0cihidWYsIl9fYWRkX18iKSgkdGVtcCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgYnVmPSRsb2NhbHNbImJ1ZiJdPWdldGF0dHIoYnVmLCJfX2lhZGRfXyIpKCR0ZW1wKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzg1NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoYnVmLCJfX2FkZF9fIikoZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9jcmVhdGVfaGVhZGVyIiksIl9fY2FsbF9fIikoaW5mbyxHTlVfRk9STUFULGVuY29kaW5nLGVycm9ycykpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE2Myl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNjMpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLmNyZWF0ZV9nbnVfaGVhZGVyLl9fbmFtZV9fPSJjcmVhdGVfZ251X2hlYWRlciIKICAgICRjbGFzcy5jcmVhdGVfZ251X2hlYWRlci5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLmNyZWF0ZV9nbnVfaGVhZGVyLl9fZG9jX189IlJldHVybiB0aGUgb2JqZWN0IGFzIGEgR05VIGhlYWRlciBibG9jayBzZXF1ZW5jZS5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs4NTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5jcmVhdGVfcGF4X2hlYWRlcj0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiY3JlYXRlX3BheF9oZWFkZXIiLGFyZ3VtZW50cyxbInNlbGYiLCJpbmZvIiwiZW5jb2RpbmciXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImZiMHE2dm12Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs4NTksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJSZXR1cm4gdGhlIG9iamVjdCBhcyBhIHVzdGFyIGhlYWRlciBibG9jay4gSWYgaXQgY2Fubm90IGJlXG5cCiAgICAgICAgICAgcmVwcmVzZW50ZWQgdGhpcyB3YXksIHByZXBlbmQgYSBwYXggZXh0ZW5kZWQgaGVhZGVyIHNlcXVlbmNlXG5cCiAgICAgICAgICAgd2l0aCBzdXBwbGVtZW50IGluZm9ybWF0aW9uLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzg2MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihpbmZvLCJfX3NldGl0ZW1fXyIpKCJtYWdpYyIsUE9TSVhfTUFHSUMpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs4NjQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBwYXhfaGVhZGVycz0kbG9jYWxzWyJwYXhfaGVhZGVycyJdPWdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHNlbGYsInBheF9oZWFkZXJzIiksImNvcHkiKSwiX19jYWxsX18iKSgpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs4NjgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciAkbmV4dDExNjM9Z2V0YXR0cihpdGVyKHR1cGxlKFt0dXBsZShbIm5hbWUiLCJwYXRoIixMRU5HVEhfTkFNRV0pLHR1cGxlKFsibGlua25hbWUiLCJsaW5rcGF0aCIsTEVOR1RIX0xJTktdKSx0dXBsZShbInVuYW1lIiwidW5hbWUiLE51bWJlcigzMildKSx0dXBsZShbImduYW1lIiwiZ25hbWUiLE51bWJlcigzMildKV0pKSwiX19uZXh0X18iKQogICAgICAgICAgICAgICAgdmFyICRub19icmVhazExNjM9dHJ1ZTt3aGlsZSh0cnVlKXsKICAgICAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgICRyaWdodD1pdGVyKCRuZXh0MTE2MygpKTskY291bnRlcj0tMQogICAgICAgICAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY291bnRlcisrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmFtZT0kbG9jYWxzWyJuYW1lIl09bmV4dCgkcmlnaHQpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY291bnRlcisrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaG5hbWU9JGxvY2Fsc1siaG5hbWUiXT1uZXh0KCRyaWdodCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsZW5ndGg9JGxvY2Fsc1sibGVuZ3RoIl09bmV4dCgkcmlnaHQpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycjExNjQpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJGVycjExNjQuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKTt0aHJvdyBWYWx1ZUVycm9yKCJuZWVkIG1vcmUgdGhhbiAiKyRjb3VudGVyKyIgdmFsdWUiKygkY291bnRlcj4xID8gInMiIDogIiIpKyIgdG8gdW5wYWNrIil9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRleGhhdXN0ZWQ9dHJ1ZTt0cnl7bmV4dCgkcmlnaHQpOyRleGhhdXN0ZWQ9ZmFsc2V9Y2F0Y2goZXJyKXtpZihlcnIuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKX19aWYoISRleGhhdXN0ZWQpe3Rocm93IFZhbHVlRXJyb3IoInRvbyBtYW55IHZhbHVlcyB0byB1bnBhY2sgKGV4cGVjdGVkICIrKCRjb3VudGVyKzEpKyIpIil9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIpe2lmKCRpc19leGMoJGVycixbU3RvcEl0ZXJhdGlvbl0pKXskcG9wX2V4YygpO2JyZWFrfWVsc2V7dGhyb3coJGVycil9fQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzg3MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihobmFtZSwiX19pbl9fIikocGF4X2hlYWRlcnMpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzg3NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs4NzcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAkZmFpbGVkMTE2NT1mYWxzZTt0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzg3OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihpbmZvLCJfX2dldGl0ZW1fXyIpKG5hbWUpLCJlbmNvZGUiKSwiX19jYWxsX18iKSgiYXNjaWkiLCJzdHJpY3QiKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTE2NSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZmFpbGVkMTE2NT10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKCRpc19leGMoJGVycjExNjUsW1VuaWNvZGVFbmNvZGVFcnJvcl0pKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzg4MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihwYXhfaGVhZGVycywiX19zZXRpdGVtX18iKShobmFtZSxnZXRhdHRyKGluZm8sIl9fZ2V0aXRlbV9fIikobmFtZSkpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs4ODEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXt0aHJvdyAkZXJyMTE2NX0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODgzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIobGVuLCJfX2NhbGxfXyIpKGdldGF0dHIoaW5mbywiX19nZXRpdGVtX18iKShuYW1lKSksIl9fZ3RfXyIpKGxlbmd0aCkpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODg0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIocGF4X2hlYWRlcnMsIl9fc2V0aXRlbV9fIikoaG5hbWUsZ2V0YXR0cihpbmZvLCJfX2dldGl0ZW1fXyIpKG5hbWUpKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzg4OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyICRuZXh0MTE2Nj1nZXRhdHRyKGl0ZXIodHVwbGUoW3R1cGxlKFsidWlkIixOdW1iZXIoOCldKSx0dXBsZShbImdpZCIsTnVtYmVyKDgpXSksdHVwbGUoWyJzaXplIixOdW1iZXIoMTIpXSksdHVwbGUoWyJtdGltZSIsTnVtYmVyKDEyKV0pXSkpLCJfX25leHRfXyIpCiAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTE2Nj10cnVlO3doaWxlKHRydWUpewogICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgJHJpZ2h0PWl0ZXIoJG5leHQxMTY2KCkpOyRjb3VudGVyPS0xCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuYW1lPSRsb2NhbHNbIm5hbWUiXT1uZXh0KCRyaWdodCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaWdpdHM9JGxvY2Fsc1siZGlnaXRzIl09bmV4dCgkcmlnaHQpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycjExNjcpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJGVycjExNjcuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKTt0aHJvdyBWYWx1ZUVycm9yKCJuZWVkIG1vcmUgdGhhbiAiKyRjb3VudGVyKyIgdmFsdWUiKygkY291bnRlcj4xID8gInMiIDogIiIpKyIgdG8gdW5wYWNrIil9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRleGhhdXN0ZWQ9dHJ1ZTt0cnl7bmV4dCgkcmlnaHQpOyRleGhhdXN0ZWQ9ZmFsc2V9Y2F0Y2goZXJyKXtpZihlcnIuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKX19aWYoISRleGhhdXN0ZWQpe3Rocm93IFZhbHVlRXJyb3IoInRvbyBtYW55IHZhbHVlcyB0byB1bnBhY2sgKGV4cGVjdGVkICIrKCRjb3VudGVyKzEpKyIpIil9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIpe2lmKCRpc19leGMoJGVycixbU3RvcEl0ZXJhdGlvbl0pKXskcG9wX2V4YygpO2JyZWFrfWVsc2V7dGhyb3coJGVycil9fQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzg4OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihuYW1lLCJfX2luX18iKShwYXhfaGVhZGVycykpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODkxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoaW5mbywiX19zZXRpdGVtX18iKShuYW1lLE51bWJlcigwKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODkyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzg5NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciB2YWw9JGxvY2Fsc1sidmFsIl09Z2V0YXR0cihpbmZvLCJfX2dldGl0ZW1fXyIpKG5hbWUpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bODk1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbCghYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oJHRlc3RfZXhwcigkdGVzdF9pdGVtKGdldGF0dHIoTnVtYmVyKDApLCJfX2xlX18iKSh2YWwpKSYmJHRlc3RfaXRlbShnZXRhdHRyKHZhbCwiX19sdF9fIikoZ2V0YXR0cihOdW1iZXIoOCksIl9fcG93X18iKShnZXRhdHRyKGRpZ2l0cywiX19zdWJfXyIpKE51bWJlcigxKSkpKSkpKXx8JHRlc3RfaXRlbShnZXRhdHRyKGlzaW5zdGFuY2UsIl9fY2FsbF9fIikodmFsLGZsb2F0KSkpKSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs4OTYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihwYXhfaGVhZGVycywiX19zZXRpdGVtX18iKShuYW1lLGdldGF0dHIoc3RyLCJfX2NhbGxfXyIpKHZhbCkpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzg5NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGluZm8sIl9fc2V0aXRlbV9fIikobmFtZSxOdW1iZXIoMCkpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTAwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKHBheF9oZWFkZXJzKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTAxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIGJ1Zj0kbG9jYWxzWyJidWYiXT1nZXRhdHRyKGdldGF0dHIoc2VsZiwiX2NyZWF0ZV9wYXhfZ2VuZXJpY19oZWFkZXIiKSwiX19jYWxsX18iKShwYXhfaGVhZGVycyxYSERUWVBFLGVuY29kaW5nKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5MDMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgYnVmPSRsb2NhbHNbImJ1ZiJdPWJ5dGVzKCIiKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTA1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0YXR0cihidWYsIl9fYWRkX18iKShnZXRhdHRyKGdldGF0dHIoc2VsZiwiX2NyZWF0ZV9oZWFkZXIiKSwiX19jYWxsX18iKShpbmZvLFVTVEFSX0ZPUk1BVCwiYXNjaWkiLCJyZXBsYWNlIikpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE2Myl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNjMpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLmNyZWF0ZV9wYXhfaGVhZGVyLl9fbmFtZV9fPSJjcmVhdGVfcGF4X2hlYWRlciIKICAgICRjbGFzcy5jcmVhdGVfcGF4X2hlYWRlci5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLmNyZWF0ZV9wYXhfaGVhZGVyLl9fZG9jX189IlJldHVybiB0aGUgb2JqZWN0IGFzIGEgdXN0YXIgaGVhZGVyIGJsb2NrLiBJZiBpdCBjYW5ub3QgYmVcblwKICAgICAgICAgICByZXByZXNlbnRlZCB0aGlzIHdheSwgcHJlcGVuZCBhIHBheCBleHRlbmRlZCBoZWFkZXIgc2VxdWVuY2VcblwKICAgICAgICAgICB3aXRoIHN1cHBsZW1lbnQgaW5mb3JtYXRpb24uXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTA3LCJfX21haW5fXyJdO05vbmU7CiAgICAkeXhrYXh2bjY9KCRjbGFzc1siY2xhc3NtZXRob2QiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbImNsYXNzbWV0aG9kIl0gOiBjbGFzc21ldGhvZCk7CiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5MDgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5jcmVhdGVfcGF4X2dsb2JhbF9oZWFkZXI9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoImNyZWF0ZV9wYXhfZ2xvYmFsX2hlYWRlciIsYXJndW1lbnRzLFsiY2xzIiwicGF4X2hlYWRlcnMiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbInNrdGwzbXBnIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5MDksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJSZXR1cm4gdGhlIG9iamVjdCBhcyBhIHBheCBnbG9iYWwgaGVhZGVyIGJsb2NrIHNlcXVlbmNlLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzkxMSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoZ2V0YXR0cihjbHMsIl9jcmVhdGVfcGF4X2dlbmVyaWNfaGVhZGVyIiksIl9fY2FsbF9fIikocGF4X2hlYWRlcnMsWEdMVFlQRSwidXRmLTgiKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNjgpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTY4KX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5jcmVhdGVfcGF4X2dsb2JhbF9oZWFkZXIuX19uYW1lX189ImNyZWF0ZV9wYXhfZ2xvYmFsX2hlYWRlciIKICAgICRjbGFzcy5jcmVhdGVfcGF4X2dsb2JhbF9oZWFkZXIuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5jcmVhdGVfcGF4X2dsb2JhbF9oZWFkZXIuX19kb2NfXz0iUmV0dXJuIHRoZSBvYmplY3QgYXMgYSBwYXggZ2xvYmFsIGhlYWRlciBibG9jayBzZXF1ZW5jZS5cblwKICAgICAgICAiCiAgICAkY2xhc3MuY3JlYXRlX3BheF9nbG9iYWxfaGVhZGVyPSR5eGtheHZuNigkY2xhc3MsJGNsYXNzLmNyZWF0ZV9wYXhfZ2xvYmFsX2hlYWRlcikKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzkxMywiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLl9wb3NpeF9zcGxpdF9uYW1lPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJfcG9zaXhfc3BsaXRfbmFtZSIsYXJndW1lbnRzLFsic2VsZiIsIm5hbWUiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbIjZ5dXAyZXJ1Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5MTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJTcGxpdCBhIG5hbWUgbG9uZ2VyIHRoYW4gMTAwIGNoYXJzIGludG8gYSBwcmVmaXhcblwKICAgICAgICAgICBhbmQgYSBuYW1lIHBhcnQuXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTE3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgcHJlZml4PSRsb2NhbHNbInByZWZpeCJdPWdldGF0dHIobmFtZSwiX19nZXRpdGVtX18iKShzbGljZShudWxsLGdldGF0dHIoTEVOR1RIX1BSRUZJWCwiX19hZGRfXyIpKE51bWJlcigxKSkpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTE4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTEzNz10cnVlO3doaWxlKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKHByZWZpeCkmJiR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKHByZWZpeCwiX19nZXRpdGVtX18iKShOdW1iZXIoLTEpKSwiX19uZV9fIikoIi8iKSkpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTE5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHByZWZpeD0kbG9jYWxzWyJwcmVmaXgiXT1nZXRhdHRyKHByZWZpeCwiX19nZXRpdGVtX18iKShzbGljZShudWxsLE51bWJlcigtMSkpKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTIxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgbmFtZT0kbG9jYWxzWyJuYW1lIl09Z2V0YXR0cihuYW1lLCJfX2dldGl0ZW1fXyIpKHNsaWNlKGdldGF0dHIobGVuLCJfX2NhbGxfXyIpKHByZWZpeCksbnVsbCkpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5MjIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBwcmVmaXg9JGxvY2Fsc1sicHJlZml4Il09Z2V0YXR0cihwcmVmaXgsIl9fZ2V0aXRlbV9fIikoc2xpY2UobnVsbCxOdW1iZXIoLTEpKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzkyNCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oIWJvb2wocHJlZml4KSl8fCR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKGxlbiwiX19jYWxsX18iKShuYW1lKSwiX19ndF9fIikoTEVOR1RIX05BTUUpKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5MjUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKFZhbHVlRXJyb3IsIl9fY2FsbF9fIikoIm5hbWUgaXMgdG9vIGxvbmciKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTI2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gdHVwbGUoW3ByZWZpeCxuYW1lXSkKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTY4KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE2OCl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuX3Bvc2l4X3NwbGl0X25hbWUuX19uYW1lX189Il9wb3NpeF9zcGxpdF9uYW1lIgogICAgJGNsYXNzLl9wb3NpeF9zcGxpdF9uYW1lLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuX3Bvc2l4X3NwbGl0X25hbWUuX19kb2NfXz0iU3BsaXQgYSBuYW1lIGxvbmdlciB0aGFuIDEwMCBjaGFycyBpbnRvIGEgcHJlZml4XG5cCiAgICAgICAgICAgYW5kIGEgbmFtZSBwYXJ0LlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzkyOCwiX19tYWluX18iXTtOb25lOwogICAgJHByNnZsa242PSgkY2xhc3NbInN0YXRpY21ldGhvZCJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1sic3RhdGljbWV0aG9kIl0gOiBzdGF0aWNtZXRob2QpOwogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTI5LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX2NyZWF0ZV9oZWFkZXI9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9jcmVhdGVfaGVhZGVyIixhcmd1bWVudHMsWyJpbmZvIiwiZm9ybWF0IiwiZW5jb2RpbmciLCJlcnJvcnMiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbIm9lZHA4dHhmIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5MzAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJSZXR1cm4gYSBoZWFkZXIgYmxvY2suIGluZm8gaXMgYSBkaWN0aW9uYXJ5IHdpdGggZmlsZVxuXAogICAgICAgICAgIGluZm9ybWF0aW9uLCBmb3JtYXQgbXVzdCBiZSBvbmUgb2YgdGhlICpfRk9STUFUIGNvbnN0YW50cy5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5MzMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBwYXJ0cz0kbG9jYWxzWyJwYXJ0cyJdPWxpc3QuX19jYWxsX18oW2dldGF0dHIoc3RuLCJfX2NhbGxfXyIpKGdldGF0dHIoZ2V0YXR0cihpbmZvLCJnZXQiKSwiX19jYWxsX18iKSgibmFtZSIsIiIpLE51bWJlcigxMDApLGVuY29kaW5nLGVycm9ycyksZ2V0YXR0cihpdG4sIl9fY2FsbF9fIikoZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoaW5mbywiZ2V0IiksIl9fY2FsbF9fIikoIm1vZGUiLE51bWJlcigwKSksIl9fYW5kX18iKShOdW1iZXIoNDA5NSkpLE51bWJlcig4KSxmb3JtYXQpLGdldGF0dHIoaXRuLCJfX2NhbGxfXyIpKGdldGF0dHIoZ2V0YXR0cihpbmZvLCJnZXQiKSwiX19jYWxsX18iKSgidWlkIixOdW1iZXIoMCkpLE51bWJlcig4KSxmb3JtYXQpLGdldGF0dHIoaXRuLCJfX2NhbGxfXyIpKGdldGF0dHIoZ2V0YXR0cihpbmZvLCJnZXQiKSwiX19jYWxsX18iKSgiZ2lkIixOdW1iZXIoMCkpLE51bWJlcig4KSxmb3JtYXQpLGdldGF0dHIoaXRuLCJfX2NhbGxfXyIpKGdldGF0dHIoZ2V0YXR0cihpbmZvLCJnZXQiKSwiX19jYWxsX18iKSgic2l6ZSIsTnVtYmVyKDApKSxOdW1iZXIoMTIpLGZvcm1hdCksZ2V0YXR0cihpdG4sIl9fY2FsbF9fIikoZ2V0YXR0cihnZXRhdHRyKGluZm8sImdldCIpLCJfX2NhbGxfXyIpKCJtdGltZSIsTnVtYmVyKDApKSxOdW1iZXIoMTIpLGZvcm1hdCksYnl0ZXMoIiAgICAgICAgIiksZ2V0YXR0cihnZXRhdHRyKGluZm8sImdldCIpLCJfX2NhbGxfXyIpKCJ0eXBlIixSRUdUWVBFKSxnZXRhdHRyKHN0biwiX19jYWxsX18iKShnZXRhdHRyKGdldGF0dHIoaW5mbywiZ2V0IiksIl9fY2FsbF9fIikoImxpbmtuYW1lIiwiIiksTnVtYmVyKDEwMCksZW5jb2RpbmcsZXJyb3JzKSxnZXRhdHRyKGdldGF0dHIoaW5mbywiZ2V0IiksIl9fY2FsbF9fIikoIm1hZ2ljIixQT1NJWF9NQUdJQyksZ2V0YXR0cihzdG4sIl9fY2FsbF9fIikoZ2V0YXR0cihnZXRhdHRyKGluZm8sImdldCIpLCJfX2NhbGxfXyIpKCJ1bmFtZSIsIiIpLE51bWJlcigzMiksZW5jb2RpbmcsZXJyb3JzKSxnZXRhdHRyKHN0biwiX19jYWxsX18iKShnZXRhdHRyKGdldGF0dHIoaW5mbywiZ2V0IiksIl9fY2FsbF9fIikoImduYW1lIiwiIiksTnVtYmVyKDMyKSxlbmNvZGluZyxlcnJvcnMpLGdldGF0dHIoaXRuLCJfX2NhbGxfXyIpKGdldGF0dHIoZ2V0YXR0cihpbmZvLCJnZXQiKSwiX19jYWxsX18iKSgiZGV2bWFqb3IiLE51bWJlcigwKSksTnVtYmVyKDgpLGZvcm1hdCksZ2V0YXR0cihpdG4sIl9fY2FsbF9fIikoZ2V0YXR0cihnZXRhdHRyKGluZm8sImdldCIpLCJfX2NhbGxfXyIpKCJkZXZtaW5vciIsTnVtYmVyKDApKSxOdW1iZXIoOCksZm9ybWF0KSxnZXRhdHRyKHN0biwiX19jYWxsX18iKShnZXRhdHRyKGdldGF0dHIoaW5mbywiZ2V0IiksIl9fY2FsbF9fIikoInByZWZpeCIsIiIpLE51bWJlcigxNTUpLGVuY29kaW5nLGVycm9ycyldKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTUxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgYnVmPSRsb2NhbHNbImJ1ZiJdPWdldGF0dHIoZ2V0YXR0cihzdHJ1Y3QsInBhY2siKSwiX19jYWxsX18iKShnZXRhdHRyKCIlZHMiLCJfX21vZF9fIikoQkxPQ0tTSVpFKSxnZXRhdHRyKGdldGF0dHIoYnl0ZXMoIiIpLCJqb2luIiksIl9fY2FsbF9fIikocGFydHMpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTUyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgY2hrc3VtPSRsb2NhbHNbImNoa3N1bSJdPWdldGF0dHIoZ2V0YXR0cihjYWxjX2Noa3N1bXMsIl9fY2FsbF9fIikoZ2V0YXR0cihidWYsIl9fZ2V0aXRlbV9fIikoc2xpY2UobnVsbCxudWxsKSkpLCJfX2dldGl0ZW1fXyIpKE51bWJlcigwKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzk1MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIGJ1Zj0kbG9jYWxzWyJidWYiXT1nZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihidWYsIl9fZ2V0aXRlbV9fIikoc2xpY2UobnVsbCxOdW1iZXIoLTM2NCkpKSwiX19hZGRfXyIpKGdldGF0dHIoYnl0ZXMsIl9fY2FsbF9fIikoZ2V0YXR0cigiJTA2b1wwIiwiX19tb2RfXyIpKGNoa3N1bSksImFzY2lpIikpLCJfX2FkZF9fIikoZ2V0YXR0cihidWYsIl9fZ2V0aXRlbV9fIikoc2xpY2UoTnVtYmVyKC0zNTcpLG51bGwpKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzk1NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGJ1ZgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNjgpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTY4KX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5fY3JlYXRlX2hlYWRlci5fX25hbWVfXz0iX2NyZWF0ZV9oZWFkZXIiCiAgICAkY2xhc3MuX2NyZWF0ZV9oZWFkZXIuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5fY3JlYXRlX2hlYWRlci5fX2RvY19fPSJSZXR1cm4gYSBoZWFkZXIgYmxvY2suIGluZm8gaXMgYSBkaWN0aW9uYXJ5IHdpdGggZmlsZVxuXAogICAgICAgICAgIGluZm9ybWF0aW9uLCBmb3JtYXQgbXVzdCBiZSBvbmUgb2YgdGhlICpfRk9STUFUIGNvbnN0YW50cy5cblwKICAgICAgICAiCiAgICAkY2xhc3MuX2NyZWF0ZV9oZWFkZXI9JHByNnZsa242KCRjbGFzcy5fY3JlYXRlX2hlYWRlcikKICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzk1NiwiX19tYWluX18iXTtOb25lOwogICAgJGJ1d2x0aXpvPSgkY2xhc3NbInN0YXRpY21ldGhvZCJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1sic3RhdGljbWV0aG9kIl0gOiBzdGF0aWNtZXRob2QpOwogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTU3LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX2NyZWF0ZV9wYXlsb2FkPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJfY3JlYXRlX3BheWxvYWQiLGFyZ3VtZW50cyxbInBheWxvYWQiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbIjVxaGxtemlpIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5NTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJSZXR1cm4gdGhlIHN0cmluZyBwYXlsb2FkIGZpbGxlZCB3aXRoIHplcm8gYnl0ZXNcblwKICAgICAgICAgICB1cCB0byB0aGUgbmV4dCA1MTIgYnl0ZSBib3JkZXIuXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgJHJpZ2h0PWl0ZXIoZ2V0YXR0cihkaXZtb2QsIl9fY2FsbF9fIikoZ2V0YXR0cihsZW4sIl9fY2FsbF9fIikocGF5bG9hZCksQkxPQ0tTSVpFKSk7JGNvdW50ZXI9LTEKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzk2MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICB2YXIgYmxvY2tzPSRsb2NhbHNbImJsb2NrcyJdPW5leHQoJHJpZ2h0KTtOb25lOwogICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICB2YXIgcmVtYWluZGVyPSRsb2NhbHNbInJlbWFpbmRlciJdPW5leHQoJHJpZ2h0KTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2goJGVycjExNjgpewogICAgICAgICAgICAgICAgICAgIGlmKCRlcnIxMTY4Ll9fbmFtZV9fPT0iU3RvcEl0ZXJhdGlvbiIpeyRwb3BfZXhjKCk7dGhyb3cgVmFsdWVFcnJvcigibmVlZCBtb3JlIHRoYW4gIiskY291bnRlcisiIHZhbHVlIisoJGNvdW50ZXI+MSA/ICJzIiA6ICIiKSsiIHRvIHVucGFjayIpfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyICRleGhhdXN0ZWQ9dHJ1ZTt0cnl7bmV4dCgkcmlnaHQpOyRleGhhdXN0ZWQ9ZmFsc2V9Y2F0Y2goZXJyKXtpZihlcnIuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKX19aWYoISRleGhhdXN0ZWQpe3Rocm93IFZhbHVlRXJyb3IoInRvbyBtYW55IHZhbHVlcyB0byB1bnBhY2sgKGV4cGVjdGVkICIrKCRjb3VudGVyKzEpKyIpIil9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5NjIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihyZW1haW5kZXIsIl9fZ3RfXyIpKE51bWJlcigwKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5NjMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgJHRlbXA9JGxvY2Fsc1siJHRlbXAiXT1nZXRhdHRyKGdldGF0dHIoQkxPQ0tTSVpFLCJfX3N1Yl9fIikocmVtYWluZGVyKSwiX19tdWxfXyIpKE5VTCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZigkdGVtcC4kZmFzdF9hdWdtICYmIHBheWxvYWQuJGZhc3RfYXVnbSl7cGF5bG9hZCs9JHRlbXA7JGxvY2Fsc1sicGF5bG9hZCJdPXBheWxvYWR9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZighaGFzYXR0cihwYXlsb2FkLCJfX2lhZGRfXyIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBheWxvYWQ9JGxvY2Fsc1sicGF5bG9hZCJdPWdldGF0dHIocGF5bG9hZCwiX19hZGRfXyIpKCR0ZW1wKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBwYXlsb2FkPSRsb2NhbHNbInBheWxvYWQiXT1nZXRhdHRyKHBheWxvYWQsIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTY0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gcGF5bG9hZAogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNjgpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTY4KX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5fY3JlYXRlX3BheWxvYWQuX19uYW1lX189Il9jcmVhdGVfcGF5bG9hZCIKICAgICRjbGFzcy5fY3JlYXRlX3BheWxvYWQuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5fY3JlYXRlX3BheWxvYWQuX19kb2NfXz0iUmV0dXJuIHRoZSBzdHJpbmcgcGF5bG9hZCBmaWxsZWQgd2l0aCB6ZXJvIGJ5dGVzXG5cCiAgICAgICAgICAgdXAgdG8gdGhlIG5leHQgNTEyIGJ5dGUgYm9yZGVyLlxuXAogICAgICAgICIKICAgICRjbGFzcy5fY3JlYXRlX3BheWxvYWQ9JGJ1d2x0aXpvKCRjbGFzcy5fY3JlYXRlX3BheWxvYWQpCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5NjYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRpMDdkdHJtbD0oJGNsYXNzWyJjbGFzc21ldGhvZCJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siY2xhc3NtZXRob2QiXSA6IGNsYXNzbWV0aG9kKTsKICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzk2NywiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLl9jcmVhdGVfZ251X2xvbmdfaGVhZGVyPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJfY3JlYXRlX2dudV9sb25nX2hlYWRlciIsYXJndW1lbnRzLFsiY2xzIiwibmFtZSIsInR5cGUiLCJlbmNvZGluZyIsImVycm9ycyJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsibmt3bjJuOXQiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzk2OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIlJldHVybiBhIEdOVVRZUEVfTE9OR05BTUUgb3IgR05VVFlQRV9MT05HTElOSyBzZXF1ZW5jZVxuXAogICAgICAgICAgIGZvciBuYW1lLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzk3MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIG5hbWU9JGxvY2Fsc1sibmFtZSJdPWdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKG5hbWUsImVuY29kZSIpLCJfX2NhbGxfXyIpKGVuY29kaW5nLGVycm9ycyksIl9fYWRkX18iKShOVUwpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5NzMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBpbmZvPSRsb2NhbHNbImluZm8iXT0kZGljdChbXSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzk3NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihpbmZvLCJfX3NldGl0ZW1fXyIpKCJuYW1lIiwiLi8uL0BMb25nTGluayIpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5NzUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGdldGF0dHIoaW5mbywiX19zZXRpdGVtX18iKSgidHlwZSIsdHlwZSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzk3NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihpbmZvLCJfX3NldGl0ZW1fXyIpKCJzaXplIixnZXRhdHRyKGxlbiwiX19jYWxsX18iKShuYW1lKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzk3NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihpbmZvLCJfX3NldGl0ZW1fXyIpKCJtYWdpYyIsR05VX01BR0lDKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTgwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoY2xzLCJfY3JlYXRlX2hlYWRlciIpLCJfX2NhbGxfXyIpKGluZm8sVVNUQVJfRk9STUFULGVuY29kaW5nLGVycm9ycyksIl9fYWRkX18iKShnZXRhdHRyKGdldGF0dHIoY2xzLCJfY3JlYXRlX3BheWxvYWQiKSwiX19jYWxsX18iKShuYW1lKSkKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTY5KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE2OSl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuX2NyZWF0ZV9nbnVfbG9uZ19oZWFkZXIuX19uYW1lX189Il9jcmVhdGVfZ251X2xvbmdfaGVhZGVyIgogICAgJGNsYXNzLl9jcmVhdGVfZ251X2xvbmdfaGVhZGVyLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuX2NyZWF0ZV9nbnVfbG9uZ19oZWFkZXIuX19kb2NfXz0iUmV0dXJuIGEgR05VVFlQRV9MT05HTkFNRSBvciBHTlVUWVBFX0xPTkdMSU5LIHNlcXVlbmNlXG5cCiAgICAgICAgICAgZm9yIG5hbWUuXG5cCiAgICAgICAgIgogICAgJGNsYXNzLl9jcmVhdGVfZ251X2xvbmdfaGVhZGVyPSRpMDdkdHJtbCgkY2xhc3MsJGNsYXNzLl9jcmVhdGVfZ251X2xvbmdfaGVhZGVyKQogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTgzLCJfX21haW5fXyJdO05vbmU7CiAgICAkYmdxZmFrbDE9KCRjbGFzc1siY2xhc3NtZXRob2QiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbImNsYXNzbWV0aG9kIl0gOiBjbGFzc21ldGhvZCk7CiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5ODQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5fY3JlYXRlX3BheF9nZW5lcmljX2hlYWRlcj0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiX2NyZWF0ZV9wYXhfZ2VuZXJpY19oZWFkZXIiLGFyZ3VtZW50cyxbImNscyIsInBheF9oZWFkZXJzIiwidHlwZSIsImVuY29kaW5nIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJkNmloc3VuaiJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTg1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiUmV0dXJuIGEgUE9TSVguMS0yMDA4IGV4dGVuZGVkIG9yIGdsb2JhbCBoZWFkZXIgc2VxdWVuY2VcblwKICAgICAgICAgICB0aGF0IGNvbnRhaW5zIGEgbGlzdCBvZiBrZXl3b3JkLCB2YWx1ZSBwYWlycy4gVGhlIHZhbHVlc1xuXAogICAgICAgICAgIG11c3QgYmUgc3RyaW5ncy5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5OTEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBiaW5hcnk9JGxvY2Fsc1siYmluYXJ5Il09RmFsc2U7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzk5MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyICRuZXh0MTE2OT1nZXRhdHRyKGl0ZXIoZ2V0YXR0cihnZXRhdHRyKHBheF9oZWFkZXJzLCJpdGVtcyIpLCJfX2NhbGxfXyIpKCkpLCJfX25leHRfXyIpCiAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTE2OT10cnVlO3doaWxlKHRydWUpewogICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgJHJpZ2h0PWl0ZXIoJG5leHQxMTY5KCkpOyRjb3VudGVyPS0xCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZXl3b3JkPSRsb2NhbHNbImtleXdvcmQiXT1uZXh0KCRyaWdodCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZT0kbG9jYWxzWyJ2YWx1ZSJdPW5leHQoJHJpZ2h0KTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIxMTcwKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRlcnIxMTcwLl9fbmFtZV9fPT0iU3RvcEl0ZXJhdGlvbiIpeyRwb3BfZXhjKCk7dGhyb3cgVmFsdWVFcnJvcigibmVlZCBtb3JlIHRoYW4gIiskY291bnRlcisiIHZhbHVlIisoJGNvdW50ZXI+MSA/ICJzIiA6ICIiKSsiIHRvIHVucGFjayIpfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZXhoYXVzdGVkPXRydWU7dHJ5e25leHQoJHJpZ2h0KTskZXhoYXVzdGVkPWZhbHNlfWNhdGNoKGVycil7aWYoZXJyLl9fbmFtZV9fPT0iU3RvcEl0ZXJhdGlvbiIpeyRwb3BfZXhjKCl9fWlmKCEkZXhoYXVzdGVkKXt0aHJvdyBWYWx1ZUVycm9yKCJ0b28gbWFueSB2YWx1ZXMgdG8gdW5wYWNrIChleHBlY3RlZCAiKygkY291bnRlcisxKSsiKSIpfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyKXtpZigkaXNfZXhjKCRlcnIsW1N0b3BJdGVyYXRpb25dKSl7JHBvcF9leGMoKTticmVha31lbHNle3Rocm93KCRlcnIpfX0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVs5OTMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAkZmFpbGVkMTE3MT1mYWxzZTt0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzk5NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIodmFsdWUsImVuY29kZSIpLCJfX2NhbGxfXyIpKCJ1dGYtOCIsInN0cmljdCIpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIxMTcxKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRmYWlsZWQxMTcxPXRydWU7aWYoZmFsc2Upe3ZvaWQoMCl9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoJGlzX2V4YygkZXJyMTE3MSxbVW5pY29kZUVuY29kZUVycm9yXSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bOTk2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmluYXJ5PSRsb2NhbHNbImJpbmFyeSJdPVRydWU7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzk5NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRub19icmVhazExNjk9ZmFsc2U7YnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNle3Rocm93ICRlcnIxMTcxfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89Wzk5OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIHJlY29yZHM9JGxvY2Fsc1sicmVjb3JkcyJdPWJ5dGVzKCIiKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTAwMCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChiaW5hcnkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDAyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICR0ZW1wPSRsb2NhbHNbIiR0ZW1wIl09Ynl0ZXMoIjIxIGhkcmNoYXJzZXQ9QklOQVJZXG4iKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKCR0ZW1wLiRmYXN0X2F1Z20gJiYgcmVjb3Jkcy4kZmFzdF9hdWdtKXtyZWNvcmRzKz0kdGVtcDskbG9jYWxzWyJyZWNvcmRzIl09cmVjb3Jkc30KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKCFoYXNhdHRyKHJlY29yZHMsIl9faWFkZF9fIikpewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjb3Jkcz0kbG9jYWxzWyJyZWNvcmRzIl09Z2V0YXR0cihyZWNvcmRzLCJfX2FkZF9fIikoJHRlbXApO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlY29yZHM9JGxvY2Fsc1sicmVjb3JkcyJdPWdldGF0dHIocmVjb3JkcywiX19pYWRkX18iKSgkdGVtcCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDA0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgJG5leHQxMTcyPWdldGF0dHIoaXRlcihnZXRhdHRyKGdldGF0dHIocGF4X2hlYWRlcnMsIml0ZW1zIiksIl9fY2FsbF9fIikoKSksIl9fbmV4dF9fIikKICAgICAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMTcyPXRydWU7d2hpbGUodHJ1ZSl7CiAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICAkcmlnaHQ9aXRlcigkbmV4dDExNzIoKSk7JGNvdW50ZXI9LTEKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtleXdvcmQ9JGxvY2Fsc1sia2V5d29yZCJdPW5leHQoJHJpZ2h0KTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlPSRsb2NhbHNbInZhbHVlIl09bmV4dCgkcmlnaHQpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycjExNzMpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJGVycjExNzMuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKTt0aHJvdyBWYWx1ZUVycm9yKCJuZWVkIG1vcmUgdGhhbiAiKyRjb3VudGVyKyIgdmFsdWUiKygkY291bnRlcj4xID8gInMiIDogIiIpKyIgdG8gdW5wYWNrIil9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRleGhhdXN0ZWQ9dHJ1ZTt0cnl7bmV4dCgkcmlnaHQpOyRleGhhdXN0ZWQ9ZmFsc2V9Y2F0Y2goZXJyKXtpZihlcnIuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKX19aWYoISRleGhhdXN0ZWQpe3Rocm93IFZhbHVlRXJyb3IoInRvbyBtYW55IHZhbHVlcyB0byB1bnBhY2sgKGV4cGVjdGVkICIrKCRjb3VudGVyKzEpKyIpIil9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIpe2lmKCRpc19leGMoJGVycixbU3RvcEl0ZXJhdGlvbl0pKXskcG9wX2V4YygpO2JyZWFrfWVsc2V7dGhyb3coJGVycil9fQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwMDUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIga2V5d29yZD0kbG9jYWxzWyJrZXl3b3JkIl09Z2V0YXR0cihnZXRhdHRyKGtleXdvcmQsImVuY29kZSIpLCJfX2NhbGxfXyIpKCJ1dGYtOCIpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTAwNiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKGJvb2woYmluYXJ5KSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwMDksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlPSRsb2NhbHNbInZhbHVlIl09Z2V0YXR0cihnZXRhdHRyKHZhbHVlLCJlbmNvZGUiKSwiX19jYWxsX18iKShlbmNvZGluZywic3Vycm9nYXRlZXNjYXBlIik7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTAxMSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWU9JGxvY2Fsc1sidmFsdWUiXT1nZXRhdHRyKGdldGF0dHIodmFsdWUsImVuY29kZSIpLCJfX2NhbGxfXyIpKCJ1dGYtOCIpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwMTMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgbD0kbG9jYWxzWyJsIl09Z2V0YXR0cihnZXRhdHRyKGdldGF0dHIobGVuLCJfX2NhbGxfXyIpKGtleXdvcmQpLCJfX2FkZF9fIikoZ2V0YXR0cihsZW4sIl9fY2FsbF9fIikodmFsdWUpKSwiX19hZGRfXyIpKE51bWJlcigzKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDE0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHA9JGxvY2Fsc1sicCJdPU51bWJlcigwKTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBuPSRsb2NhbHNbIm4iXT1wO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTAxNSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMTM4PXRydWU7d2hpbGUoYm9vbChUcnVlKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwMTYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG49JGxvY2Fsc1sibiJdPWdldGF0dHIobCwiX19hZGRfXyIpKGdldGF0dHIobGVuLCJfX2NhbGxfXyIpKGdldGF0dHIoc3RyLCJfX2NhbGxfXyIpKHApKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTAxNywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIobiwiX19lcV9fIikocCkpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwMTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMTM4PWZhbHNlO2JyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTAxOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcD0kbG9jYWxzWyJwIl09bjtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDIwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICR0ZW1wPSRsb2NhbHNbIiR0ZW1wIl09Z2V0YXR0cihnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoYnl0ZXMsIl9fY2FsbF9fIikoZ2V0YXR0cihzdHIsIl9fY2FsbF9fIikocCksImFzY2lpIiksIl9fYWRkX18iKShieXRlcygiICIpKSwiX19hZGRfXyIpKGtleXdvcmQpLCJfX2FkZF9fIikoYnl0ZXMoIj0iKSksIl9fYWRkX18iKSh2YWx1ZSksIl9fYWRkX18iKShieXRlcygiXG4iKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZigkdGVtcC4kZmFzdF9hdWdtICYmIHJlY29yZHMuJGZhc3RfYXVnbSl7cmVjb3Jkcys9JHRlbXA7JGxvY2Fsc1sicmVjb3JkcyJdPXJlY29yZHN9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZighaGFzYXR0cihyZWNvcmRzLCJfX2lhZGRfXyIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlY29yZHM9JGxvY2Fsc1sicmVjb3JkcyJdPWdldGF0dHIocmVjb3JkcywiX19hZGRfXyIpKCR0ZW1wKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICByZWNvcmRzPSRsb2NhbHNbInJlY29yZHMiXT1nZXRhdHRyKHJlY29yZHMsIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTAyNCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIGluZm89JGxvY2Fsc1siaW5mbyJdPSRkaWN0KFtdKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTAyNSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihpbmZvLCJfX3NldGl0ZW1fXyIpKCJuYW1lIiwiLi8uL0BQYXhIZWFkZXIiKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTAyNiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihpbmZvLCJfX3NldGl0ZW1fXyIpKCJ0eXBlIix0eXBlKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTAyNywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihpbmZvLCJfX3NldGl0ZW1fXyIpKCJzaXplIixnZXRhdHRyKGxlbiwiX19jYWxsX18iKShyZWNvcmRzKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwMjgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGdldGF0dHIoaW5mbywiX19zZXRpdGVtX18iKSgibWFnaWMiLFBPU0lYX01BR0lDKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTAzMSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKGNscywiX2NyZWF0ZV9oZWFkZXIiKSwiX19jYWxsX18iKShpbmZvLFVTVEFSX0ZPUk1BVCwiYXNjaWkiLCJyZXBsYWNlIiksIl9fYWRkX18iKShnZXRhdHRyKGdldGF0dHIoY2xzLCJfY3JlYXRlX3BheWxvYWQiKSwiX19jYWxsX18iKShyZWNvcmRzKSkKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTY5KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE2OSl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuX2NyZWF0ZV9wYXhfZ2VuZXJpY19oZWFkZXIuX19uYW1lX189Il9jcmVhdGVfcGF4X2dlbmVyaWNfaGVhZGVyIgogICAgJGNsYXNzLl9jcmVhdGVfcGF4X2dlbmVyaWNfaGVhZGVyLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuX2NyZWF0ZV9wYXhfZ2VuZXJpY19oZWFkZXIuX19kb2NfXz0iUmV0dXJuIGEgUE9TSVguMS0yMDA4IGV4dGVuZGVkIG9yIGdsb2JhbCBoZWFkZXIgc2VxdWVuY2VcblwKICAgICAgICAgICB0aGF0IGNvbnRhaW5zIGEgbGlzdCBvZiBrZXl3b3JkLCB2YWx1ZSBwYWlycy4gVGhlIHZhbHVlc1xuXAogICAgICAgICAgIG11c3QgYmUgc3RyaW5ncy5cblwKICAgICAgICAiCiAgICAkY2xhc3MuX2NyZWF0ZV9wYXhfZ2VuZXJpY19oZWFkZXI9JGJncWZha2wxKCRjbGFzcywkY2xhc3MuX2NyZWF0ZV9wYXhfZ2VuZXJpY19oZWFkZXIpCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDM0LCJfX21haW5fXyJdO05vbmU7CiAgICAkdGdxcXhoZDk9KCRjbGFzc1siY2xhc3NtZXRob2QiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbImNsYXNzbWV0aG9kIl0gOiBjbGFzc21ldGhvZCk7CiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDM1LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuZnJvbWJ1Zj0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiZnJvbWJ1ZiIsYXJndW1lbnRzLFsiY2xzIiwiYnVmIiwiZW5jb2RpbmciLCJlcnJvcnMiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbInBlY3N0Nml3Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDM2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiQ29uc3RydWN0IGEgVGFySW5mbyBvYmplY3QgZnJvbSBhIDUxMiBieXRlIGJ5dGVzIG9iamVjdC5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDM4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cihsZW4sIl9fY2FsbF9fIikoYnVmKSwiX19lcV9fIikoTnVtYmVyKDApKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwMzksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKEVtcHR5SGVhZGVyRXJyb3IsIl9fY2FsbF9fIikoImVtcHR5IGhlYWRlciIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDQwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cihsZW4sIl9fY2FsbF9fIikoYnVmKSwiX19uZV9fIikoQkxPQ0tTSVpFKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwNDEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKFRydW5jYXRlZEhlYWRlckVycm9yLCJfX2NhbGxfXyIpKCJ0cnVuY2F0ZWQgaGVhZGVyIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwNDIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoYnVmLCJjb3VudCIpLCJfX2NhbGxfXyIpKE5VTCksIl9fZXFfXyIpKEJMT0NLU0laRSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDQzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihFT0ZIZWFkZXJFcnJvciwiX19jYWxsX18iKSgiZW5kIG9mIGZpbGUgaGVhZGVyIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwNDUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBjaGtzdW09JGxvY2Fsc1siY2hrc3VtIl09Z2V0YXR0cihudGksIl9fY2FsbF9fIikoZ2V0YXR0cihidWYsIl9fZ2V0aXRlbV9fIikoc2xpY2UoTnVtYmVyKDE0OCksTnVtYmVyKDE1NikpKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwNDYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihjaGtzdW0sIl9fbm90X2luX18iKShnZXRhdHRyKGNhbGNfY2hrc3VtcywiX19jYWxsX18iKShidWYpKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwNDcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKEludmFsaWRIZWFkZXJFcnJvciwiX19jYWxsX18iKSgiYmFkIGNoZWNrc3VtIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwNDksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBvYmo9JGxvY2Fsc1sib2JqIl09Z2V0YXR0cihjbHMsIl9fY2FsbF9fIikoKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTA1MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihvYmosIm5hbWUiLGdldGF0dHIobnRzLCJfX2NhbGxfXyIpKGdldGF0dHIoYnVmLCJfX2dldGl0ZW1fXyIpKHNsaWNlKE51bWJlcigwKSxOdW1iZXIoMTAwKSkpLGVuY29kaW5nLGVycm9ycykpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDUxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKG9iaiwibW9kZSIsZ2V0YXR0cihudGksIl9fY2FsbF9fIikoZ2V0YXR0cihidWYsIl9fZ2V0aXRlbV9fIikoc2xpY2UoTnVtYmVyKDEwMCksTnVtYmVyKDEwOCkpKSkpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDUyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKG9iaiwidWlkIixnZXRhdHRyKG50aSwiX19jYWxsX18iKShnZXRhdHRyKGJ1ZiwiX19nZXRpdGVtX18iKShzbGljZShOdW1iZXIoMTA4KSxOdW1iZXIoMTE2KSkpKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwNTMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIob2JqLCJnaWQiLGdldGF0dHIobnRpLCJfX2NhbGxfXyIpKGdldGF0dHIoYnVmLCJfX2dldGl0ZW1fXyIpKHNsaWNlKE51bWJlcigxMTYpLE51bWJlcigxMjQpKSkpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTA1NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihvYmosInNpemUiLGdldGF0dHIobnRpLCJfX2NhbGxfXyIpKGdldGF0dHIoYnVmLCJfX2dldGl0ZW1fXyIpKHNsaWNlKE51bWJlcigxMjQpLE51bWJlcigxMzYpKSkpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTA1NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihvYmosIm10aW1lIixnZXRhdHRyKG50aSwiX19jYWxsX18iKShnZXRhdHRyKGJ1ZiwiX19nZXRpdGVtX18iKShzbGljZShOdW1iZXIoMTM2KSxOdW1iZXIoMTQ4KSkpKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwNTYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIob2JqLCJjaGtzdW0iLGNoa3N1bSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwNTcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIob2JqLCJ0eXBlIixnZXRhdHRyKGJ1ZiwiX19nZXRpdGVtX18iKShzbGljZShOdW1iZXIoMTU2KSxOdW1iZXIoMTU3KSkpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTA1OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihvYmosImxpbmtuYW1lIixnZXRhdHRyKG50cywiX19jYWxsX18iKShnZXRhdHRyKGJ1ZiwiX19nZXRpdGVtX18iKShzbGljZShOdW1iZXIoMTU3KSxOdW1iZXIoMjU3KSkpLGVuY29kaW5nLGVycm9ycykpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDU5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKG9iaiwidW5hbWUiLGdldGF0dHIobnRzLCJfX2NhbGxfXyIpKGdldGF0dHIoYnVmLCJfX2dldGl0ZW1fXyIpKHNsaWNlKE51bWJlcigyNjUpLE51bWJlcigyOTcpKSksZW5jb2RpbmcsZXJyb3JzKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwNjAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIob2JqLCJnbmFtZSIsZ2V0YXR0cihudHMsIl9fY2FsbF9fIikoZ2V0YXR0cihidWYsIl9fZ2V0aXRlbV9fIikoc2xpY2UoTnVtYmVyKDI5NyksTnVtYmVyKDMyOSkpKSxlbmNvZGluZyxlcnJvcnMpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTA2MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihvYmosImRldm1ham9yIixnZXRhdHRyKG50aSwiX19jYWxsX18iKShnZXRhdHRyKGJ1ZiwiX19nZXRpdGVtX18iKShzbGljZShOdW1iZXIoMzI5KSxOdW1iZXIoMzM3KSkpKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwNjIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIob2JqLCJkZXZtaW5vciIsZ2V0YXR0cihudGksIl9fY2FsbF9fIikoZ2V0YXR0cihidWYsIl9fZ2V0aXRlbV9fIikoc2xpY2UoTnVtYmVyKDMzNyksTnVtYmVyKDM0NSkpKSkpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDYzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgcHJlZml4PSRsb2NhbHNbInByZWZpeCJdPWdldGF0dHIobnRzLCJfX2NhbGxfXyIpKGdldGF0dHIoYnVmLCJfX2dldGl0ZW1fXyIpKHNsaWNlKE51bWJlcigzNDUpLE51bWJlcig1MDApKSksZW5jb2RpbmcsZXJyb3JzKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTA2NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKG9iaiwidHlwZSIpLCJfX2VxX18iKShBUkVHVFlQRSkpJiYkdGVzdF9pdGVtKGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKG9iaiwibmFtZSIpLCJlbmRzd2l0aCIpLCJfX2NhbGxfXyIpKCIvIikpKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwNjgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKG9iaiwidHlwZSIsRElSVFlQRSk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwNzMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKG9iaiwidHlwZSIpLCJfX2VxX18iKShHTlVUWVBFX1NQQVJTRSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDc0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHBvcz0kbG9jYWxzWyJwb3MiXT1OdW1iZXIoMzg2KTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwNzUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgc3RydWN0cz0kbG9jYWxzWyJzdHJ1Y3RzIl09bGlzdC5fX2NhbGxfXyhbXSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDc2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICRuZXh0MTE3ND1nZXRhdHRyKGl0ZXIoZ2V0YXR0cihyYW5nZSwiX19jYWxsX18iKShOdW1iZXIoNCkpKSwiX19uZXh0X18iKQogICAgICAgICAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMTc0PXRydWU7d2hpbGUodHJ1ZSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpPSRsb2NhbHNbImkiXT0kbmV4dDExNzQoKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIpe2lmKCRpc19leGMoJGVycixbU3RvcEl0ZXJhdGlvbl0pKXskcG9wX2V4YygpO2JyZWFrfWVsc2V7dGhyb3coJGVycil9fQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDc3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICRmYWlsZWQxMTc1PWZhbHNlO3RyeXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwNzgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvZmZzZXQ9JGxvY2Fsc1sib2Zmc2V0Il09Z2V0YXR0cihudGksIl9fY2FsbF9fIikoZ2V0YXR0cihidWYsIl9fZ2V0aXRlbV9fIikoc2xpY2UocG9zLGdldGF0dHIocG9zLCJfX2FkZF9fIikoTnVtYmVyKDEyKSkpKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwNzksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBudW1ieXRlcz0kbG9jYWxzWyJudW1ieXRlcyJdPWdldGF0dHIobnRpLCJfX2NhbGxfXyIpKGdldGF0dHIoYnVmLCJfX2dldGl0ZW1fXyIpKHNsaWNlKGdldGF0dHIocG9zLCJfX2FkZF9fIikoTnVtYmVyKDEyKSksZ2V0YXR0cihwb3MsIl9fYWRkX18iKShOdW1iZXIoMjQpKSkpKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIxMTc1KXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZmFpbGVkMTE3NT10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMTc1LFtWYWx1ZUVycm9yXSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwODEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTE3ND1mYWxzZTticmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXt0aHJvdyAkZXJyMTE3NX0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDgyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzdHJ1Y3RzLCJhcHBlbmQiKSwiX19jYWxsX18iKSh0dXBsZShbb2Zmc2V0LG51bWJ5dGVzXSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwODMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyICR0ZW1wPSRsb2NhbHNbIiR0ZW1wIl09TnVtYmVyKDI0KTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBpZigkdGVtcC4kZmFzdF9hdWdtICYmIHBvcy4kZmFzdF9hdWdtKXtwb3MrPSR0ZW1wOyRsb2NhbHNbInBvcyJdPXBvc30KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZighaGFzYXR0cihwb3MsIl9faWFkZF9fIikpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvcz0kbG9jYWxzWyJwb3MiXT1nZXRhdHRyKHBvcywiX19hZGRfXyIpKCR0ZW1wKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3M9JGxvY2Fsc1sicG9zIl09Z2V0YXR0cihwb3MsIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTA4NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBpc2V4dGVuZGVkPSRsb2NhbHNbImlzZXh0ZW5kZWQiXT1nZXRhdHRyKGJvb2wsIl9fY2FsbF9fIikoZ2V0YXR0cihidWYsIl9fZ2V0aXRlbV9fIikoTnVtYmVyKDQ4MikpKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwODUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgb3JpZ3NpemU9JGxvY2Fsc1sib3JpZ3NpemUiXT1nZXRhdHRyKG50aSwiX19jYWxsX18iKShnZXRhdHRyKGJ1ZiwiX19nZXRpdGVtX18iKShzbGljZShOdW1iZXIoNDgzKSxOdW1iZXIoNDk1KSkpKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwODYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKG9iaiwiX3NwYXJzZV9zdHJ1Y3RzIix0dXBsZShbc3RydWN0cyxpc2V4dGVuZGVkLG9yaWdzaXplXSkpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDg5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cihvYmosImlzZGlyIiksIl9fY2FsbF9fIikoKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwOTAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKG9iaiwibmFtZSIsZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIob2JqLCJuYW1lIiksInJzdHJpcCIpLCJfX2NhbGxfXyIpKCIvIikpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDkzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKCR0ZXN0X2V4cHIoJHRlc3RfaXRlbShwcmVmaXgpJiYkdGVzdF9pdGVtKGdldGF0dHIoZ2V0YXR0cihvYmosInR5cGUiKSwiX19ub3RfaW5fXyIpKEdOVV9UWVBFUykpKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwOTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKG9iaiwibmFtZSIsZ2V0YXR0cihnZXRhdHRyKHByZWZpeCwiX19hZGRfXyIpKCIvIiksIl9fYWRkX18iKShnZXRhdHRyKG9iaiwibmFtZSIpKSk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEwOTUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiBvYmoKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTc0KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE3NCl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuZnJvbWJ1Zi5fX25hbWVfXz0iZnJvbWJ1ZiIKICAgICRjbGFzcy5mcm9tYnVmLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuZnJvbWJ1Zi5fX2RvY19fPSJDb25zdHJ1Y3QgYSBUYXJJbmZvIG9iamVjdCBmcm9tIGEgNTEyIGJ5dGUgYnl0ZXMgb2JqZWN0LlxuXAogICAgICAgICIKICAgICRjbGFzcy5mcm9tYnVmPSR0Z3FxeGhkOSgkY2xhc3MsJGNsYXNzLmZyb21idWYpCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDk3LCJfX21haW5fXyJdO05vbmU7CiAgICAkZzhyNW1ubWM9KCRjbGFzc1siY2xhc3NtZXRob2QiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbImNsYXNzbWV0aG9kIl0gOiBjbGFzc21ldGhvZCk7CiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMDk4LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuZnJvbXRhcmZpbGU9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoImZyb210YXJmaWxlIixhcmd1bWVudHMsWyJjbHMiLCJ0YXJmaWxlIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJrcWkzeXkyaSJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTA5OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIlJldHVybiB0aGUgbmV4dCBUYXJJbmZvIG9iamVjdCBmcm9tIFRhckZpbGUgb2JqZWN0XG5cCiAgICAgICAgICAgdGFyZmlsZS5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMTAyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgYnVmPSRsb2NhbHNbImJ1ZiJdPWdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHRhcmZpbGUsImZpbGVvYmoiKSwicmVhZCIpLCJfX2NhbGxfXyIpKEJMT0NLU0laRSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExMDMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBvYmo9JGxvY2Fsc1sib2JqIl09Z2V0YXR0cihnZXRhdHRyKGNscywiZnJvbWJ1ZiIpLCJfX2NhbGxfXyIpKGJ1ZixnZXRhdHRyKHRhcmZpbGUsImVuY29kaW5nIiksZ2V0YXR0cih0YXJmaWxlLCJlcnJvcnMiKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExMDQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIob2JqLCJvZmZzZXQiLGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIodGFyZmlsZSwiZmlsZW9iaiIpLCJ0ZWxsIiksIl9fY2FsbF9fIikoKSwiX19zdWJfXyIpKEJMT0NLU0laRSkpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMTA1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0YXR0cihnZXRhdHRyKG9iaiwiX3Byb2NfbWVtYmVyIiksIl9fY2FsbF9fIikodGFyZmlsZSkKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTc2KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE3Nil9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuZnJvbXRhcmZpbGUuX19uYW1lX189ImZyb210YXJmaWxlIgogICAgJGNsYXNzLmZyb210YXJmaWxlLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuZnJvbXRhcmZpbGUuX19kb2NfXz0iUmV0dXJuIHRoZSBuZXh0IFRhckluZm8gb2JqZWN0IGZyb20gVGFyRmlsZSBvYmplY3RcblwKICAgICAgICAgICB0YXJmaWxlLlxuXAogICAgICAgICIKICAgICRjbGFzcy5mcm9tdGFyZmlsZT0kZzhyNW1ubWMoJGNsYXNzLCRjbGFzcy5mcm9tdGFyZmlsZSkKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExMTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5fcHJvY19tZW1iZXI9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9wcm9jX21lbWJlciIsYXJndW1lbnRzLFsic2VsZiIsInRhcmZpbGUiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbInJzYmtidDEyIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMTE5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiQ2hvb3NlIHRoZSByaWdodCBwcm9jZXNzaW5nIG1ldGhvZCBkZXBlbmRpbmcgb25cblwKICAgICAgICAgICB0aGUgdHlwZSBhbmQgY2FsbCBpdC5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMTIyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJ0eXBlIiksIl9faW5fXyIpKHR1cGxlKFtHTlVUWVBFX0xPTkdOQU1FLEdOVVRZUEVfTE9OR0xJTktdKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMTIzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfcHJvY19nbnVsb25nIiksIl9fY2FsbF9fIikodGFyZmlsZSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIoc2VsZiwidHlwZSIpLCJfX2VxX18iKShHTlVUWVBFX1NQQVJTRSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMTI1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfcHJvY19zcGFyc2UiKSwiX19jYWxsX18iKSh0YXJmaWxlKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihib29sKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJ0eXBlIiksIl9faW5fXyIpKHR1cGxlKFtYSERUWVBFLFhHTFRZUEUsU09MQVJJU19YSERUWVBFXSkpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTEyNywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX3Byb2NfcGF4IiksIl9fY2FsbF9fIikodGFyZmlsZSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTEyOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX3Byb2NfYnVpbHRpbiIpLCJfX2NhbGxfXyIpKHRhcmZpbGUpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE3Nil7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNzYpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9wcm9jX21lbWJlci5fX25hbWVfXz0iX3Byb2NfbWVtYmVyIgogICAgJGNsYXNzLl9wcm9jX21lbWJlci5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9wcm9jX21lbWJlci5fX2RvY19fPSJDaG9vc2UgdGhlIHJpZ2h0IHByb2Nlc3NpbmcgbWV0aG9kIGRlcGVuZGluZyBvblxuXAogICAgICAgICAgIHRoZSB0eXBlIGFuZCBjYWxsIGl0LlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExMzEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5fcHJvY19idWlsdGluPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJfcHJvY19idWlsdGluIixhcmd1bWVudHMsWyJzZWxmIiwidGFyZmlsZSJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiYThocm80dmEiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExMzIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJQcm9jZXNzIGEgYnVpbHRpbiB0eXBlIG9yIGFuIHVua25vd24gdHlwZSB3aGljaFxuXAogICAgICAgICAgIHdpbGwgYmUgdHJlYXRlZCBhcyBhIHJlZ3VsYXIgZmlsZS5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMTM1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsIm9mZnNldF9kYXRhIixnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cih0YXJmaWxlLCJmaWxlb2JqIiksInRlbGwiKSwiX19jYWxsX18iKSgpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTEzNiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIG9mZnNldD0kbG9jYWxzWyJvZmZzZXQiXT1nZXRhdHRyKHNlbGYsIm9mZnNldF9kYXRhIik7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExMzcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJpc3JlZyIpLCJfX2NhbGxfXyIpKCkpfHwkdGVzdF9pdGVtKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJ0eXBlIiksIl9fbm90X2luX18iKShTVVBQT1JURURfVFlQRVMpKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMTM5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICR0ZW1wPSRsb2NhbHNbIiR0ZW1wIl09Z2V0YXR0cihnZXRhdHRyKHNlbGYsIl9ibG9jayIpLCJfX2NhbGxfXyIpKGdldGF0dHIoc2VsZiwic2l6ZSIpKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKCR0ZW1wLiRmYXN0X2F1Z20gJiYgb2Zmc2V0LiRmYXN0X2F1Z20pe29mZnNldCs9JHRlbXA7JGxvY2Fsc1sib2Zmc2V0Il09b2Zmc2V0fQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoIWhhc2F0dHIob2Zmc2V0LCJfX2lhZGRfXyIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9mZnNldD0kbG9jYWxzWyJvZmZzZXQiXT1nZXRhdHRyKG9mZnNldCwiX19hZGRfXyIpKCR0ZW1wKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ9JGxvY2Fsc1sib2Zmc2V0Il09Z2V0YXR0cihvZmZzZXQsIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTE0MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cih0YXJmaWxlLCJvZmZzZXQiLG9mZnNldCk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExNDQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfYXBwbHlfcGF4X2luZm8iKSwiX19jYWxsX18iKShnZXRhdHRyKHRhcmZpbGUsInBheF9oZWFkZXJzIiksZ2V0YXR0cih0YXJmaWxlLCJlbmNvZGluZyIpLGdldGF0dHIodGFyZmlsZSwiZXJyb3JzIikpCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMTQ2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExNzYpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTc2KX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5fcHJvY19idWlsdGluLl9fbmFtZV9fPSJfcHJvY19idWlsdGluIgogICAgJGNsYXNzLl9wcm9jX2J1aWx0aW4uX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5fcHJvY19idWlsdGluLl9fZG9jX189IlByb2Nlc3MgYSBidWlsdGluIHR5cGUgb3IgYW4gdW5rbm93biB0eXBlIHdoaWNoXG5cCiAgICAgICAgICAgd2lsbCBiZSB0cmVhdGVkIGFzIGEgcmVndWxhciBmaWxlLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExNDgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5fcHJvY19nbnVsb25nPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJfcHJvY19nbnVsb25nIixhcmd1bWVudHMsWyJzZWxmIiwidGFyZmlsZSJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiM2o0NHduYmoiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExNDksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJQcm9jZXNzIHRoZSBibG9ja3MgdGhhdCBob2xkIGEgR05VIGxvbmduYW1lXG5cCiAgICAgICAgICAgb3IgbG9uZ2xpbmsgbWVtYmVyLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExNTIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBidWY9JGxvY2Fsc1siYnVmIl09Z2V0YXR0cihnZXRhdHRyKGdldGF0dHIodGFyZmlsZSwiZmlsZW9iaiIpLCJyZWFkIiksIl9fY2FsbF9fIikoZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9ibG9jayIpLCJfX2NhbGxfXyIpKGdldGF0dHIoc2VsZiwic2l6ZSIpKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExNTUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICRmYWlsZWQxMTc2PWZhbHNlO3RyeXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMTU2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIG5leHQ9JGxvY2Fsc1sibmV4dCJdPWdldGF0dHIoZ2V0YXR0cihzZWxmLCJmcm9tdGFyZmlsZSIpLCJfX2NhbGxfXyIpKHRhcmZpbGUpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTE3Nil7CiAgICAgICAgICAgICAgICAgICAgdmFyICRmYWlsZWQxMTc2PXRydWU7aWYoZmFsc2Upe3ZvaWQoMCl9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMTc2LFtIZWFkZXJFcnJvcl0pKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTE1OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKFN1YnNlcXVlbnRIZWFkZXJFcnJvciwiX19jYWxsX18iKSgibWlzc2luZyBvciBiYWQgc3Vic2VxdWVudCBoZWFkZXIiKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNle3Rocm93ICRlcnIxMTc2fQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTE2MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihuZXh0LCJvZmZzZXQiLGdldGF0dHIoc2VsZiwib2Zmc2V0IikpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMTYzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJ0eXBlIiksIl9fZXFfXyIpKEdOVVRZUEVfTE9OR05BTUUpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTE2NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHNldGF0dHIobmV4dCwibmFtZSIsZ2V0YXR0cihudHMsIl9fY2FsbF9fIikoYnVmLGdldGF0dHIodGFyZmlsZSwiZW5jb2RpbmciKSxnZXRhdHRyKHRhcmZpbGUsImVycm9ycyIpKSk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIoc2VsZiwidHlwZSIpLCJfX2VxX18iKShHTlVUWVBFX0xPTkdMSU5LKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExNjYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKG5leHQsImxpbmtuYW1lIixnZXRhdHRyKG50cywiX19jYWxsX18iKShidWYsZ2V0YXR0cih0YXJmaWxlLCJlbmNvZGluZyIpLGdldGF0dHIodGFyZmlsZSwiZXJyb3JzIikpKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTE2OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIG5leHQKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTc2KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE3Nil9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuX3Byb2NfZ251bG9uZy5fX25hbWVfXz0iX3Byb2NfZ251bG9uZyIKICAgICRjbGFzcy5fcHJvY19nbnVsb25nLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuX3Byb2NfZ251bG9uZy5fX2RvY19fPSJQcm9jZXNzIHRoZSBibG9ja3MgdGhhdCBob2xkIGEgR05VIGxvbmduYW1lXG5cCiAgICAgICAgICAgb3IgbG9uZ2xpbmsgbWVtYmVyLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExNzAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5fcHJvY19zcGFyc2U9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9wcm9jX3NwYXJzZSIsYXJndW1lbnRzLFsic2VsZiIsInRhcmZpbGUiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImU4dml3M2FiIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMTcxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiUHJvY2VzcyBhIEdOVSBzcGFyc2UgaGVhZGVyIHBsdXMgZXh0cmEgaGVhZGVycy5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICAkcmlnaHQ9aXRlcihnZXRhdHRyKHNlbGYsIl9zcGFyc2Vfc3RydWN0cyIpKTskY291bnRlcj0tMQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTE3NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICB2YXIgc3RydWN0cz0kbG9jYWxzWyJzdHJ1Y3RzIl09bmV4dCgkcmlnaHQpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgICAgIHZhciBpc2V4dGVuZGVkPSRsb2NhbHNbImlzZXh0ZW5kZWQiXT1uZXh0KCRyaWdodCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAkY291bnRlcisrCiAgICAgICAgICAgICAgICAgICAgdmFyIG9yaWdzaXplPSRsb2NhbHNbIm9yaWdzaXplIl09bmV4dCgkcmlnaHQpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTE3Nyl7CiAgICAgICAgICAgICAgICAgICAgaWYoJGVycjExNzcuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKTt0aHJvdyBWYWx1ZUVycm9yKCJuZWVkIG1vcmUgdGhhbiAiKyRjb3VudGVyKyIgdmFsdWUiKygkY291bnRlcj4xID8gInMiIDogIiIpKyIgdG8gdW5wYWNrIil9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgJGV4aGF1c3RlZD10cnVlO3RyeXtuZXh0KCRyaWdodCk7JGV4aGF1c3RlZD1mYWxzZX1jYXRjaChlcnIpe2lmKGVyci5fX25hbWVfXz09IlN0b3BJdGVyYXRpb24iKXskcG9wX2V4YygpfX1pZighJGV4aGF1c3RlZCl7dGhyb3cgVmFsdWVFcnJvcigidG9vIG1hbnkgdmFsdWVzIHRvIHVucGFjayAoZXhwZWN0ZWQgIisoJGNvdW50ZXIrMSkrIikiKX0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExNzUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGRlbGF0dHIoc2VsZiwiX3NwYXJzZV9zdHJ1Y3RzIikKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExNzgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMTM5PXRydWU7d2hpbGUoYm9vbChpc2V4dGVuZGVkKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTE3OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBidWY9JGxvY2Fsc1siYnVmIl09Z2V0YXR0cihnZXRhdHRyKGdldGF0dHIodGFyZmlsZSwiZmlsZW9iaiIpLCJyZWFkIiksIl9fY2FsbF9fIikoQkxPQ0tTSVpFKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExODAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgcG9zPSRsb2NhbHNbInBvcyJdPU51bWJlcigwKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExODEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgJG5leHQxMTc4PWdldGF0dHIoaXRlcihnZXRhdHRyKHJhbmdlLCJfX2NhbGxfXyIpKE51bWJlcigyMSkpKSwiX19uZXh0X18iKQogICAgICAgICAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMTc4PXRydWU7d2hpbGUodHJ1ZSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpPSRsb2NhbHNbImkiXT0kbmV4dDExNzgoKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIpe2lmKCRpc19leGMoJGVycixbU3RvcEl0ZXJhdGlvbl0pKXskcG9wX2V4YygpO2JyZWFrfWVsc2V7dGhyb3coJGVycil9fQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMTgyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICRmYWlsZWQxMTc5PWZhbHNlO3RyeXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExODMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvZmZzZXQ9JGxvY2Fsc1sib2Zmc2V0Il09Z2V0YXR0cihudGksIl9fY2FsbF9fIikoZ2V0YXR0cihidWYsIl9fZ2V0aXRlbV9fIikoc2xpY2UocG9zLGdldGF0dHIocG9zLCJfX2FkZF9fIikoTnVtYmVyKDEyKSkpKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExODQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBudW1ieXRlcz0kbG9jYWxzWyJudW1ieXRlcyJdPWdldGF0dHIobnRpLCJfX2NhbGxfXyIpKGdldGF0dHIoYnVmLCJfX2dldGl0ZW1fXyIpKHNsaWNlKGdldGF0dHIocG9zLCJfX2FkZF9fIikoTnVtYmVyKDEyKSksZ2V0YXR0cihwb3MsIl9fYWRkX18iKShOdW1iZXIoMjQpKSkpKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIxMTc5KXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZmFpbGVkMTE3OT10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMTc5LFtWYWx1ZUVycm9yXSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExODYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTE3OD1mYWxzZTticmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXt0aHJvdyAkZXJyMTE3OX0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMTg3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKG9mZnNldCkmJiR0ZXN0X2l0ZW0obnVtYnl0ZXMpKSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTE4OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHN0cnVjdHMsImFwcGVuZCIpLCJfX2NhbGxfXyIpKHR1cGxlKFtvZmZzZXQsbnVtYnl0ZXNdKSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMTg5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkdGVtcD0kbG9jYWxzWyIkdGVtcCJdPU51bWJlcigyNCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoJHRlbXAuJGZhc3RfYXVnbSAmJiBwb3MuJGZhc3RfYXVnbSl7cG9zKz0kdGVtcDskbG9jYWxzWyJwb3MiXT1wb3N9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoIWhhc2F0dHIocG9zLCJfX2lhZGRfXyIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3M9JGxvY2Fsc1sicG9zIl09Z2V0YXR0cihwb3MsIl9fYWRkX18iKSgkdGVtcCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zPSRsb2NhbHNbInBvcyJdPWdldGF0dHIocG9zLCJfX2lhZGRfXyIpKCR0ZW1wKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExOTAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgaXNleHRlbmRlZD0kbG9jYWxzWyJpc2V4dGVuZGVkIl09Z2V0YXR0cihib29sLCJfX2NhbGxfXyIpKGdldGF0dHIoYnVmLCJfX2dldGl0ZW1fXyIpKE51bWJlcig1MDQpKSk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExOTEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwic3BhcnNlIixzdHJ1Y3RzKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTE5MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJvZmZzZXRfZGF0YSIsZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIodGFyZmlsZSwiZmlsZW9iaiIpLCJ0ZWxsIiksIl9fY2FsbF9fIikoKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExOTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIodGFyZmlsZSwib2Zmc2V0IixnZXRhdHRyKGdldGF0dHIoc2VsZiwib2Zmc2V0X2RhdGEiKSwiX19hZGRfXyIpKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfYmxvY2siKSwiX19jYWxsX18iKShnZXRhdHRyKHNlbGYsInNpemUiKSkpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTE5NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJzaXplIixvcmlnc2l6ZSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExOTYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE3Nyl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExNzcpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9wcm9jX3NwYXJzZS5fX25hbWVfXz0iX3Byb2Nfc3BhcnNlIgogICAgJGNsYXNzLl9wcm9jX3NwYXJzZS5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9wcm9jX3NwYXJzZS5fX2RvY19fPSJQcm9jZXNzIGEgR05VIHNwYXJzZSBoZWFkZXIgcGx1cyBleHRyYSBoZWFkZXJzLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzExOTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5fcHJvY19wYXg9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9wcm9jX3BheCIsYXJndW1lbnRzLFsic2VsZiIsInRhcmZpbGUiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbInp5N2MxcDk4Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMTk5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiUHJvY2VzcyBhbiBleHRlbmRlZCBvciBnbG9iYWwgaGVhZGVyIGFzIGRlc2NyaWJlZCBpblxuXAogICAgICAgICAgIFBPU0lYLjEtMjAwOC5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMjAzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgYnVmPSRsb2NhbHNbImJ1ZiJdPWdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHRhcmZpbGUsImZpbGVvYmoiKSwicmVhZCIpLCJfX2NhbGxfXyIpKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfYmxvY2siKSwiX19jYWxsX18iKShnZXRhdHRyKHNlbGYsInNpemUiKSkpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMjA4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJ0eXBlIiksIl9fZXFfXyIpKFhHTFRZUEUpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTIwOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBwYXhfaGVhZGVycz0kbG9jYWxzWyJwYXhfaGVhZGVycyJdPWdldGF0dHIodGFyZmlsZSwicGF4X2hlYWRlcnMiKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMjExLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHBheF9oZWFkZXJzPSRsb2NhbHNbInBheF9oZWFkZXJzIl09Z2V0YXR0cihnZXRhdHRyKGdldGF0dHIodGFyZmlsZSwicGF4X2hlYWRlcnMiKSwiY29weSIpLCJfX2NhbGxfXyIpKCk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEyMTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBtYXRjaD0kbG9jYWxzWyJtYXRjaCJdPWdldGF0dHIoZ2V0YXR0cihyZSwic2VhcmNoIiksIl9fY2FsbF9fIikoYnl0ZXMoIlxcZCsgaGRyY2hhcnNldD0oW15cXG5dKylcXG4iKSxidWYpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMjE5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKG1hdGNoIT09Tm9uZSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEyMjAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKHBheF9oZWFkZXJzLCJfX3NldGl0ZW1fXyIpKCJoZHJjaGFyc2V0IixnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKG1hdGNoLCJncm91cCIpLCJfX2NhbGxfXyIpKE51bWJlcigxKSksImRlY29kZSIpLCJfX2NhbGxfXyIpKCJ1dGYtOCIpKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTIyNSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIGhkcmNoYXJzZXQ9JGxvY2Fsc1siaGRyY2hhcnNldCJdPWdldGF0dHIoZ2V0YXR0cihwYXhfaGVhZGVycywiZ2V0IiksIl9fY2FsbF9fIikoImhkcmNoYXJzZXQiKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTIyNiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGhkcmNoYXJzZXQsIl9fZXFfXyIpKCJCSU5BUlkiKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEyMjcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgZW5jb2Rpbmc9JGxvY2Fsc1siZW5jb2RpbmciXT1nZXRhdHRyKHRhcmZpbGUsImVuY29kaW5nIik7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTIyOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBlbmNvZGluZz0kbG9jYWxzWyJlbmNvZGluZyJdPSJ1dGYtOCI7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEyMzUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciByZWdleD0kbG9jYWxzWyJyZWdleCJdPWdldGF0dHIoZ2V0YXR0cihyZSwiY29tcGlsZSIpLCJfX2NhbGxfXyIpKGJ5dGVzKCIoXFxkKykgKFtePV0rKT0iKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEyMzYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBwb3M9JGxvY2Fsc1sicG9zIl09TnVtYmVyKDApO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMjM3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTE0MD10cnVlO3doaWxlKGJvb2woVHJ1ZSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEyMzgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2g9JGxvY2Fsc1sibWF0Y2giXT1nZXRhdHRyKGdldGF0dHIocmVnZXgsIm1hdGNoIiksIl9fY2FsbF9fIikoYnVmLHBvcyk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMjM5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbCghYm9vbChtYXRjaCkpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTI0MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTE0MD1mYWxzZTticmVhawogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkcmlnaHQ9aXRlcihnZXRhdHRyKGdldGF0dHIobWF0Y2gsImdyb3VwcyIpLCJfX2NhbGxfXyIpKCkpOyRjb3VudGVyPS0xCiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTI0MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGVuZ3RoPSRsb2NhbHNbImxlbmd0aCJdPW5leHQoJHJpZ2h0KTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAkY291bnRlcisrCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZXl3b3JkPSRsb2NhbHNbImtleXdvcmQiXT1uZXh0KCRyaWdodCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycjExODApewogICAgICAgICAgICAgICAgICAgICAgICBpZigkZXJyMTE4MC5fX25hbWVfXz09IlN0b3BJdGVyYXRpb24iKXskcG9wX2V4YygpO3Rocm93IFZhbHVlRXJyb3IoIm5lZWQgbW9yZSB0aGFuICIrJGNvdW50ZXIrIiB2YWx1ZSIrKCRjb3VudGVyPjEgPyAicyIgOiAiIikrIiB0byB1bnBhY2siKX0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdmFyICRleGhhdXN0ZWQ9dHJ1ZTt0cnl7bmV4dCgkcmlnaHQpOyRleGhhdXN0ZWQ9ZmFsc2V9Y2F0Y2goZXJyKXtpZihlcnIuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKX19aWYoISRleGhhdXN0ZWQpe3Rocm93IFZhbHVlRXJyb3IoInRvbyBtYW55IHZhbHVlcyB0byB1bnBhY2sgKGV4cGVjdGVkICIrKCRjb3VudGVyKzEpKyIpIil9CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTI0MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBsZW5ndGg9JGxvY2Fsc1sibGVuZ3RoIl09Z2V0YXR0cihpbnQsIl9fY2FsbF9fIikobGVuZ3RoKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEyNDQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWU9JGxvY2Fsc1sidmFsdWUiXT1nZXRhdHRyKGJ1ZiwiX19nZXRpdGVtX18iKShzbGljZShnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihtYXRjaCwiZW5kIiksIl9fY2FsbF9fIikoTnVtYmVyKDIpKSwiX19hZGRfXyIpKE51bWJlcigxKSksZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIobWF0Y2gsInN0YXJ0IiksIl9fY2FsbF9fIikoTnVtYmVyKDEpKSwiX19hZGRfXyIpKGdldGF0dHIobGVuZ3RoLCJfX3N1Yl9fIikoTnVtYmVyKDEpKSkpKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEyNTMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIga2V5d29yZD0kbG9jYWxzWyJrZXl3b3JkIl09Z2V0YXR0cihnZXRhdHRyKHNlbGYsIl9kZWNvZGVfcGF4X2ZpZWxkIiksIl9fY2FsbF9fIikoa2V5d29yZCwidXRmLTgiLCJ1dGYtOCIsZ2V0YXR0cih0YXJmaWxlLCJlcnJvcnMiKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMjU1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGtleXdvcmQsIl9faW5fXyIpKFBBWF9OQU1FX0ZJRUxEUykpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTI1NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWU9JGxvY2Fsc1sidmFsdWUiXT1nZXRhdHRyKGdldGF0dHIoc2VsZiwiX2RlY29kZV9wYXhfZmllbGQiKSwiX19jYWxsX18iKSh2YWx1ZSxlbmNvZGluZyxnZXRhdHRyKHRhcmZpbGUsImVuY29kaW5nIiksZ2V0YXR0cih0YXJmaWxlLCJlcnJvcnMiKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTI1OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWU9JGxvY2Fsc1sidmFsdWUiXT1nZXRhdHRyKGdldGF0dHIoc2VsZiwiX2RlY29kZV9wYXhfZmllbGQiKSwiX19jYWxsX18iKSh2YWx1ZSwidXRmLTgiLCJ1dGYtOCIsZ2V0YXR0cih0YXJmaWxlLCJlcnJvcnMiKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTI2MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGdldGF0dHIocGF4X2hlYWRlcnMsIl9fc2V0aXRlbV9fIikoa2V5d29yZCx2YWx1ZSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMjYzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICR0ZW1wPSRsb2NhbHNbIiR0ZW1wIl09bGVuZ3RoO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoJHRlbXAuJGZhc3RfYXVnbSAmJiBwb3MuJGZhc3RfYXVnbSl7cG9zKz0kdGVtcDskbG9jYWxzWyJwb3MiXT1wb3N9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZighaGFzYXR0cihwb3MsIl9faWFkZF9fIikpewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zPSRsb2NhbHNbInBvcyJdPWdldGF0dHIocG9zLCJfX2FkZF9fIikoJHRlbXApO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvcz0kbG9jYWxzWyJwb3MiXT1nZXRhdHRyKHBvcywiX19pYWRkX18iKSgkdGVtcCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMjY2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAkZmFpbGVkMTE4MT1mYWxzZTt0cnl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTI2NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBuZXh0PSRsb2NhbHNbIm5leHQiXT1nZXRhdHRyKGdldGF0dHIoc2VsZiwiZnJvbXRhcmZpbGUiKSwiX19jYWxsX18iKSh0YXJmaWxlKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2goJGVycjExODEpewogICAgICAgICAgICAgICAgICAgIHZhciAkZmFpbGVkMTE4MT10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoJGlzX2V4YygkZXJyMTE4MSxbSGVhZGVyRXJyb3JdKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEyNjksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihTdWJzZXF1ZW50SGVhZGVyRXJyb3IsIl9fY2FsbF9fIikoIm1pc3Npbmcgb3IgYmFkIHN1YnNlcXVlbnQgaGVhZGVyIikKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZXt0aHJvdyAkZXJyMTE4MX0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEyNzIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cigiR05VLnNwYXJzZS5tYXAiLCJfX2luX18iKShwYXhfaGVhZGVycykpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMjc0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9wcm9jX2dudXNwYXJzZV8wMSIpLCJfX2NhbGxfXyIpKG5leHQscGF4X2hlYWRlcnMpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGJvb2woZ2V0YXR0cigiR05VLnNwYXJzZS5zaXplIiwiX19pbl9fIikocGF4X2hlYWRlcnMpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTI3OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfcHJvY19nbnVzcGFyc2VfMDAiKSwiX19jYWxsX18iKShuZXh0LHBheF9oZWFkZXJzLGJ1ZikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIocGF4X2hlYWRlcnMsImdldCIpLCJfX2NhbGxfXyIpKCJHTlUuc3BhcnNlLm1ham9yIiksIl9fZXFfXyIpKCIxIikpJiYkdGVzdF9pdGVtKGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHBheF9oZWFkZXJzLCJnZXQiKSwiX19jYWxsX18iKSgiR05VLnNwYXJzZS5taW5vciIpLCJfX2VxX18iKSgiMCIpKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMjgyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9wcm9jX2dudXNwYXJzZV8xMCIpLCJfX2NhbGxfXyIpKG5leHQscGF4X2hlYWRlcnMsdGFyZmlsZSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEyODQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKHNlbGYsInR5cGUiKSwiX19pbl9fIikodHVwbGUoW1hIRFRZUEUsU09MQVJJU19YSERUWVBFXSkpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTI4NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihuZXh0LCJfYXBwbHlfcGF4X2luZm8iKSwiX19jYWxsX18iKShwYXhfaGVhZGVycyxnZXRhdHRyKHRhcmZpbGUsImVuY29kaW5nIiksZ2V0YXR0cih0YXJmaWxlLCJlcnJvcnMiKSkKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMjg3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihuZXh0LCJvZmZzZXQiLGdldGF0dHIoc2VsZiwib2Zmc2V0IikpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTI4OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cigic2l6ZSIsIl9faW5fXyIpKHBheF9oZWFkZXJzKSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMjkzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvZmZzZXQ9JGxvY2Fsc1sib2Zmc2V0Il09Z2V0YXR0cihuZXh0LCJvZmZzZXRfZGF0YSIpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEyOTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKG5leHQsImlzcmVnIiksIl9fY2FsbF9fIikoKSl8fCR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKG5leHQsInR5cGUiKSwiX19ub3RfaW5fXyIpKFNVUFBPUlRFRF9UWVBFUykpKSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTI5NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICR0ZW1wPSRsb2NhbHNbIiR0ZW1wIl09Z2V0YXR0cihnZXRhdHRyKG5leHQsIl9ibG9jayIpLCJfX2NhbGxfXyIpKGdldGF0dHIobmV4dCwic2l6ZSIpKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJHRlbXAuJGZhc3RfYXVnbSAmJiBvZmZzZXQuJGZhc3RfYXVnbSl7b2Zmc2V0Kz0kdGVtcDskbG9jYWxzWyJvZmZzZXQiXT1vZmZzZXR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKCFoYXNhdHRyKG9mZnNldCwiX19pYWRkX18iKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9mZnNldD0kbG9jYWxzWyJvZmZzZXQiXT1nZXRhdHRyKG9mZnNldCwiX19hZGRfXyIpKCR0ZW1wKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ9JGxvY2Fsc1sib2Zmc2V0Il09Z2V0YXR0cihvZmZzZXQsIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTI5NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHRhcmZpbGUsIm9mZnNldCIsb2Zmc2V0KTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEyOTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiBuZXh0CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE4MCl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExODApfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9wcm9jX3BheC5fX25hbWVfXz0iX3Byb2NfcGF4IgogICAgJGNsYXNzLl9wcm9jX3BheC5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9wcm9jX3BheC5fX2RvY19fPSJQcm9jZXNzIGFuIGV4dGVuZGVkIG9yIGdsb2JhbCBoZWFkZXIgYXMgZGVzY3JpYmVkIGluXG5cCiAgICAgICAgICAgUE9TSVguMS0yMDA4LlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzMDAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5fcHJvY19nbnVzcGFyc2VfMDA9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9wcm9jX2dudXNwYXJzZV8wMCIsYXJndW1lbnRzLFsic2VsZiIsIm5leHQiLCJwYXhfaGVhZGVycyIsImJ1ZiJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiM3k2dzM3NDIiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzMDEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJQcm9jZXNzIGEgR05VIHRhciBleHRlbmRlZCBzcGFyc2UgaGVhZGVyLCB2ZXJzaW9uIDAuMC5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzAzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0cz0kbG9jYWxzWyJvZmZzZXRzIl09bGlzdC5fX2NhbGxfXyhbXSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzMDQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciAkbmV4dDExODI9Z2V0YXR0cihpdGVyKGdldGF0dHIoZ2V0YXR0cihyZSwiZmluZGl0ZXIiKSwiX19jYWxsX18iKShieXRlcygiXFxkKyBHTlUuc3BhcnNlLm9mZnNldD0oXFxkKylcXG4iKSxidWYpKSwiX19uZXh0X18iKQogICAgICAgICAgICAgICAgdmFyICRub19icmVhazExODI9dHJ1ZTt3aGlsZSh0cnVlKXsKICAgICAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYXRjaD0kbG9jYWxzWyJtYXRjaCJdPSRuZXh0MTE4MigpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIpe2lmKCRpc19leGMoJGVycixbU3RvcEl0ZXJhdGlvbl0pKXskcG9wX2V4YygpO2JyZWFrfWVsc2V7dGhyb3coJGVycil9fQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzMDUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIob2Zmc2V0cywiYXBwZW5kIiksIl9fY2FsbF9fIikoZ2V0YXR0cihpbnQsIl9fY2FsbF9fIikoZ2V0YXR0cihnZXRhdHRyKG1hdGNoLCJncm91cCIpLCJfX2NhbGxfXyIpKE51bWJlcigxKSkpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTMwNiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIG51bWJ5dGVzPSRsb2NhbHNbIm51bWJ5dGVzIl09bGlzdC5fX2NhbGxfXyhbXSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzMDcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciAkbmV4dDExODM9Z2V0YXR0cihpdGVyKGdldGF0dHIoZ2V0YXR0cihyZSwiZmluZGl0ZXIiKSwiX19jYWxsX18iKShieXRlcygiXFxkKyBHTlUuc3BhcnNlLm51bWJ5dGVzPShcXGQrKVxcbiIpLGJ1ZikpLCJfX25leHRfXyIpCiAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTE4Mz10cnVlO3doaWxlKHRydWUpewogICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hdGNoPSRsb2NhbHNbIm1hdGNoIl09JG5leHQxMTgzKCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycil7aWYoJGlzX2V4YygkZXJyLFtTdG9wSXRlcmF0aW9uXSkpeyRwb3BfZXhjKCk7YnJlYWt9ZWxzZXt0aHJvdygkZXJyKX19CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTMwOCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihudW1ieXRlcywiYXBwZW5kIiksIl9fY2FsbF9fIikoZ2V0YXR0cihpbnQsIl9fY2FsbF9fIikoZ2V0YXR0cihnZXRhdHRyKG1hdGNoLCJncm91cCIpLCJfX2NhbGxfXyIpKE51bWJlcigxKSkpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTMwOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihuZXh0LCJzcGFyc2UiLGdldGF0dHIobGlzdCwiX19jYWxsX18iKShnZXRhdHRyKHppcCwiX19jYWxsX18iKShvZmZzZXRzLG51bWJ5dGVzKSkpO05vbmU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE4Mil7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExODIpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9wcm9jX2dudXNwYXJzZV8wMC5fX25hbWVfXz0iX3Byb2NfZ251c3BhcnNlXzAwIgogICAgJGNsYXNzLl9wcm9jX2dudXNwYXJzZV8wMC5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9wcm9jX2dudXNwYXJzZV8wMC5fX2RvY19fPSJQcm9jZXNzIGEgR05VIHRhciBleHRlbmRlZCBzcGFyc2UgaGVhZGVyLCB2ZXJzaW9uIDAuMC5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzExLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX3Byb2NfZ251c3BhcnNlXzAxPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJfcHJvY19nbnVzcGFyc2VfMDEiLGFyZ3VtZW50cyxbInNlbGYiLCJuZXh0IiwicGF4X2hlYWRlcnMiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImxneXR6dWMzIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzEyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiUHJvY2VzcyBhIEdOVSB0YXIgZXh0ZW5kZWQgc3BhcnNlIGhlYWRlciwgdmVyc2lvbiAwLjEuXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTMxNCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIHNwYXJzZT0kbG9jYWxzWyJzcGFyc2UiXT0kbGlzdF9jb21wKCRta2RpY3QoJGdsb2JhbHMsJGxvY2FscyksImludCh4KSAiLCJmb3IgeCBpbiBwYXhfaGVhZGVyc1tcIkdOVS5zcGFyc2UubWFwXCJdLnNwbGl0KFwiLFwiKSIpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzE1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKG5leHQsInNwYXJzZSIsZ2V0YXR0cihsaXN0LCJfX2NhbGxfXyIpKGdldGF0dHIoemlwLCJfX2NhbGxfXyIpKGdldGF0dHIoc3BhcnNlLCJfX2dldGl0ZW1fXyIpKHNsaWNlKG51bGwsbnVsbCxOdW1iZXIoMikpKSxnZXRhdHRyKHNwYXJzZSwiX19nZXRpdGVtX18iKShzbGljZShOdW1iZXIoMSksbnVsbCxOdW1iZXIoMikpKSkpKTtOb25lOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExODQpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTg0KX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5fcHJvY19nbnVzcGFyc2VfMDEuX19uYW1lX189Il9wcm9jX2dudXNwYXJzZV8wMSIKICAgICRjbGFzcy5fcHJvY19nbnVzcGFyc2VfMDEuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5fcHJvY19nbnVzcGFyc2VfMDEuX19kb2NfXz0iUHJvY2VzcyBhIEdOVSB0YXIgZXh0ZW5kZWQgc3BhcnNlIGhlYWRlciwgdmVyc2lvbiAwLjEuXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTMxNywiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLl9wcm9jX2dudXNwYXJzZV8xMD0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiX3Byb2NfZ251c3BhcnNlXzEwIixhcmd1bWVudHMsWyJzZWxmIiwibmV4dCIsInBheF9oZWFkZXJzIiwidGFyZmlsZSJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsic3MxOG4wNHYiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzMTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJQcm9jZXNzIGEgR05VIHRhciBleHRlbmRlZCBzcGFyc2UgaGVhZGVyLCB2ZXJzaW9uIDEuMC5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzIwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgZmllbGRzPSRsb2NhbHNbImZpZWxkcyJdPU5vbmU7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzMjEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBzcGFyc2U9JGxvY2Fsc1sic3BhcnNlIl09bGlzdC5fX2NhbGxfXyhbXSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzMjIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBidWY9JGxvY2Fsc1siYnVmIl09Z2V0YXR0cihnZXRhdHRyKGdldGF0dHIodGFyZmlsZSwiZmlsZW9iaiIpLCJyZWFkIiksIl9fY2FsbF9fIikoQkxPQ0tTSVpFKTtOb25lOwogICAgICAgICAgICAgICAgJHJpZ2h0PWl0ZXIoZ2V0YXR0cihnZXRhdHRyKGJ1Ziwic3BsaXQiKSwiX19jYWxsX18iKShieXRlcygiXG4iKSxOdW1iZXIoMSkpKTskY291bnRlcj0tMQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTMyMywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICB2YXIgZmllbGRzPSRsb2NhbHNbImZpZWxkcyJdPW5leHQoJHJpZ2h0KTtOb25lOwogICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICB2YXIgYnVmPSRsb2NhbHNbImJ1ZiJdPW5leHQoJHJpZ2h0KTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2goJGVycjExODQpewogICAgICAgICAgICAgICAgICAgIGlmKCRlcnIxMTg0Ll9fbmFtZV9fPT0iU3RvcEl0ZXJhdGlvbiIpeyRwb3BfZXhjKCk7dGhyb3cgVmFsdWVFcnJvcigibmVlZCBtb3JlIHRoYW4gIiskY291bnRlcisiIHZhbHVlIisoJGNvdW50ZXI+MSA/ICJzIiA6ICIiKSsiIHRvIHVucGFjayIpfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyICRleGhhdXN0ZWQ9dHJ1ZTt0cnl7bmV4dCgkcmlnaHQpOyRleGhhdXN0ZWQ9ZmFsc2V9Y2F0Y2goZXJyKXtpZihlcnIuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKX19aWYoISRleGhhdXN0ZWQpe3Rocm93IFZhbHVlRXJyb3IoInRvbyBtYW55IHZhbHVlcyB0byB1bnBhY2sgKGV4cGVjdGVkICIrKCRjb3VudGVyKzEpKyIpIil9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzI0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgZmllbGRzPSRsb2NhbHNbImZpZWxkcyJdPWdldGF0dHIoaW50LCJfX2NhbGxfXyIpKGZpZWxkcyk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzMjUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMTQxPXRydWU7d2hpbGUoYm9vbChnZXRhdHRyKGdldGF0dHIobGVuLCJfX2NhbGxfXyIpKHNwYXJzZSksIl9fbHRfXyIpKGdldGF0dHIoZmllbGRzLCJfX211bF9fIikoTnVtYmVyKDIpKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzI2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGJ5dGVzKCJcbiIpLCJfX25vdF9pbl9fIikoYnVmKSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzI3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkdGVtcD0kbG9jYWxzWyIkdGVtcCJdPWdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHRhcmZpbGUsImZpbGVvYmoiKSwicmVhZCIpLCJfX2NhbGxfXyIpKEJMT0NLU0laRSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoJHRlbXAuJGZhc3RfYXVnbSAmJiBidWYuJGZhc3RfYXVnbSl7YnVmKz0kdGVtcDskbG9jYWxzWyJidWYiXT1idWZ9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoIWhhc2F0dHIoYnVmLCJfX2lhZGRfXyIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBidWY9JGxvY2Fsc1siYnVmIl09Z2V0YXR0cihidWYsIl9fYWRkX18iKSgkdGVtcCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVmPSRsb2NhbHNbImJ1ZiJdPWdldGF0dHIoYnVmLCJfX2lhZGRfXyIpKCR0ZW1wKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICRyaWdodD1pdGVyKGdldGF0dHIoZ2V0YXR0cihidWYsInNwbGl0IiksIl9fY2FsbF9fIikoYnl0ZXMoIlxuIiksTnVtYmVyKDEpKSk7JGNvdW50ZXI9LTEKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzI4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICAkY291bnRlcisrCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBudW1iZXI9JGxvY2Fsc1sibnVtYmVyIl09bmV4dCgkcmlnaHQpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ1Zj0kbG9jYWxzWyJidWYiXT1uZXh0KCRyaWdodCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycjExODUpewogICAgICAgICAgICAgICAgICAgICAgICBpZigkZXJyMTE4NS5fX25hbWVfXz09IlN0b3BJdGVyYXRpb24iKXskcG9wX2V4YygpO3Rocm93IFZhbHVlRXJyb3IoIm5lZWQgbW9yZSB0aGFuICIrJGNvdW50ZXIrIiB2YWx1ZSIrKCRjb3VudGVyPjEgPyAicyIgOiAiIikrIiB0byB1bnBhY2siKX0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdmFyICRleGhhdXN0ZWQ9dHJ1ZTt0cnl7bmV4dCgkcmlnaHQpOyRleGhhdXN0ZWQ9ZmFsc2V9Y2F0Y2goZXJyKXtpZihlcnIuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKX19aWYoISRleGhhdXN0ZWQpe3Rocm93IFZhbHVlRXJyb3IoInRvbyBtYW55IHZhbHVlcyB0byB1bnBhY2sgKGV4cGVjdGVkICIrKCRjb3VudGVyKzEpKyIpIil9CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTMyOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzcGFyc2UsImFwcGVuZCIpLCJfX2NhbGxfXyIpKGdldGF0dHIoaW50LCJfX2NhbGxfXyIpKG51bWJlcikpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzMwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKG5leHQsIm9mZnNldF9kYXRhIixnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cih0YXJmaWxlLCJmaWxlb2JqIiksInRlbGwiKSwiX19jYWxsX18iKSgpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTMzMSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihuZXh0LCJzcGFyc2UiLGdldGF0dHIobGlzdCwiX19jYWxsX18iKShnZXRhdHRyKHppcCwiX19jYWxsX18iKShnZXRhdHRyKHNwYXJzZSwiX19nZXRpdGVtX18iKShzbGljZShudWxsLG51bGwsTnVtYmVyKDIpKSksZ2V0YXR0cihzcGFyc2UsIl9fZ2V0aXRlbV9fIikoc2xpY2UoTnVtYmVyKDEpLG51bGwsTnVtYmVyKDIpKSkpKSk7Tm9uZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTg0KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE4NCl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuX3Byb2NfZ251c3BhcnNlXzEwLl9fbmFtZV9fPSJfcHJvY19nbnVzcGFyc2VfMTAiCiAgICAkY2xhc3MuX3Byb2NfZ251c3BhcnNlXzEwLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuX3Byb2NfZ251c3BhcnNlXzEwLl9fZG9jX189IlByb2Nlc3MgYSBHTlUgdGFyIGV4dGVuZGVkIHNwYXJzZSBoZWFkZXIsIHZlcnNpb24gMS4wLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzMzMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5fYXBwbHlfcGF4X2luZm89IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9hcHBseV9wYXhfaW5mbyIsYXJndW1lbnRzLFsic2VsZiIsInBheF9oZWFkZXJzIiwiZW5jb2RpbmciLCJlcnJvcnMiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImx3OTIxajE2Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzM0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiUmVwbGFjZSBmaWVsZHMgd2l0aCBzdXBwbGVtZW50YWwgaW5mb3JtYXRpb24gZnJvbSBhIHByZXZpb3VzXG5cCiAgICAgICAgICAgcGF4IGV4dGVuZGVkIG9yIGdsb2JhbCBoZWFkZXIuXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTMzNywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyICRuZXh0MTE4Nj1nZXRhdHRyKGl0ZXIoZ2V0YXR0cihnZXRhdHRyKHBheF9oZWFkZXJzLCJpdGVtcyIpLCJfX2NhbGxfXyIpKCkpLCJfX25leHRfXyIpCiAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTE4Nj10cnVlO3doaWxlKHRydWUpewogICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgJHJpZ2h0PWl0ZXIoJG5leHQxMTg2KCkpOyRjb3VudGVyPS0xCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZXl3b3JkPSRsb2NhbHNbImtleXdvcmQiXT1uZXh0KCRyaWdodCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZT0kbG9jYWxzWyJ2YWx1ZSJdPW5leHQoJHJpZ2h0KTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIxMTg3KXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRlcnIxMTg3Ll9fbmFtZV9fPT0iU3RvcEl0ZXJhdGlvbiIpeyRwb3BfZXhjKCk7dGhyb3cgVmFsdWVFcnJvcigibmVlZCBtb3JlIHRoYW4gIiskY291bnRlcisiIHZhbHVlIisoJGNvdW50ZXI+MSA/ICJzIiA6ICIiKSsiIHRvIHVucGFjayIpfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZXhoYXVzdGVkPXRydWU7dHJ5e25leHQoJHJpZ2h0KTskZXhoYXVzdGVkPWZhbHNlfWNhdGNoKGVycil7aWYoZXJyLl9fbmFtZV9fPT0iU3RvcEl0ZXJhdGlvbiIpeyRwb3BfZXhjKCl9fWlmKCEkZXhoYXVzdGVkKXt0aHJvdyBWYWx1ZUVycm9yKCJ0b28gbWFueSB2YWx1ZXMgdG8gdW5wYWNrIChleHBlY3RlZCAiKygkY291bnRlcisxKSsiKSIpfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyKXtpZigkaXNfZXhjKCRlcnIsW1N0b3BJdGVyYXRpb25dKSl7JHBvcF9leGMoKTticmVha31lbHNle3Rocm93KCRlcnIpfX0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzM4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGtleXdvcmQsIl9fZXFfXyIpKCJHTlUuc3BhcnNlLm5hbWUiKSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzM5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoc2V0YXR0ciwiX19jYWxsX18iKShzZWxmLCJwYXRoIix2YWx1ZSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihib29sKGdldGF0dHIoa2V5d29yZCwiX19lcV9fIikoIkdOVS5zcGFyc2Uuc2l6ZSIpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzNDEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihzZXRhdHRyLCJfX2NhbGxfXyIpKHNlbGYsInNpemUiLGdldGF0dHIoaW50LCJfX2NhbGxfXyIpKHZhbHVlKSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihib29sKGdldGF0dHIoa2V5d29yZCwiX19lcV9fIikoIkdOVS5zcGFyc2UucmVhbHNpemUiKSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzQzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoc2V0YXR0ciwiX19jYWxsX18iKShzZWxmLCJzaXplIixnZXRhdHRyKGludCwiX19jYWxsX18iKSh2YWx1ZSkpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoYm9vbChnZXRhdHRyKGtleXdvcmQsIl9faW5fXyIpKFBBWF9GSUVMRFMpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzNDUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGtleXdvcmQsIl9faW5fXyIpKFBBWF9OVU1CRVJfRklFTERTKSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTM0NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGZhaWxlZDExODg9ZmFsc2U7dHJ5ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzNDcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWU9JGxvY2Fsc1sidmFsdWUiXT1nZXRhdHRyKGdldGF0dHIoUEFYX05VTUJFUl9GSUVMRFMsIl9fZ2V0aXRlbV9fIikoa2V5d29yZCksIl9fY2FsbF9fIikodmFsdWUpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTE4OCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRmYWlsZWQxMTg4PXRydWU7aWYoZmFsc2Upe3ZvaWQoMCl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMTg4LFtWYWx1ZUVycm9yXSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzQ5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZT0kbG9jYWxzWyJ2YWx1ZSJdPU51bWJlcigwKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNle3Rocm93ICRlcnIxMTg4fQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzNTAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGtleXdvcmQsIl9fZXFfXyIpKCJwYXRoIikpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzNTEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZT0kbG9jYWxzWyJ2YWx1ZSJdPWdldGF0dHIoZ2V0YXR0cih2YWx1ZSwicnN0cmlwIiksIl9fY2FsbF9fIikoIi8iKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzNTIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihzZXRhdHRyLCJfX2NhbGxfXyIpKHNlbGYsa2V5d29yZCx2YWx1ZSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzU0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsInBheF9oZWFkZXJzIixnZXRhdHRyKGdldGF0dHIocGF4X2hlYWRlcnMsImNvcHkiKSwiX19jYWxsX18iKSgpKTtOb25lOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExODYpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTg2KX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5fYXBwbHlfcGF4X2luZm8uX19uYW1lX189Il9hcHBseV9wYXhfaW5mbyIKICAgICRjbGFzcy5fYXBwbHlfcGF4X2luZm8uX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5fYXBwbHlfcGF4X2luZm8uX19kb2NfXz0iUmVwbGFjZSBmaWVsZHMgd2l0aCBzdXBwbGVtZW50YWwgaW5mb3JtYXRpb24gZnJvbSBhIHByZXZpb3VzXG5cCiAgICAgICAgICAgcGF4IGV4dGVuZGVkIG9yIGdsb2JhbCBoZWFkZXIuXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTM1NiwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLl9kZWNvZGVfcGF4X2ZpZWxkPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJfZGVjb2RlX3BheF9maWVsZCIsYXJndW1lbnRzLFsic2VsZiIsInZhbHVlIiwiZW5jb2RpbmciLCJmYWxsYmFja19lbmNvZGluZyIsImZhbGxiYWNrX2Vycm9ycyJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiMDFycW83enAiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzNTcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJEZWNvZGUgYSBzaW5nbGUgZmllbGQgZnJvbSBhIHBheCByZWNvcmQuXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTM1OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgJGZhaWxlZDExODk9ZmFsc2U7dHJ5ewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzNjAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0YXR0cihnZXRhdHRyKHZhbHVlLCJkZWNvZGUiKSwiX19jYWxsX18iKShlbmNvZGluZywic3RyaWN0IikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIxMTg5KXsKICAgICAgICAgICAgICAgICAgICB2YXIgJGZhaWxlZDExODk9dHJ1ZTtpZihmYWxzZSl7dm9pZCgwKX0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKCRpc19leGMoJGVycjExODksW1VuaWNvZGVEZWNvZGVFcnJvcl0pKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTM2MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0YXR0cihnZXRhdHRyKHZhbHVlLCJkZWNvZGUiKSwiX19jYWxsX18iKShmYWxsYmFja19lbmNvZGluZyxmYWxsYmFja19lcnJvcnMpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2V7dGhyb3cgJGVycjExODl9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE4OSl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExODkpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9kZWNvZGVfcGF4X2ZpZWxkLl9fbmFtZV9fPSJfZGVjb2RlX3BheF9maWVsZCIKICAgICRjbGFzcy5fZGVjb2RlX3BheF9maWVsZC5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9kZWNvZGVfcGF4X2ZpZWxkLl9fZG9jX189IkRlY29kZSBhIHNpbmdsZSBmaWVsZCBmcm9tIGEgcGF4IHJlY29yZC5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzY0LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX2Jsb2NrPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJfYmxvY2siLGFyZ3VtZW50cyxbInNlbGYiLCJjb3VudCJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsicHF0N3E0dGIiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzNjUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJSb3VuZCB1cCBhIGJ5dGUgY291bnQgYnkgQkxPQ0tTSVpFIGFuZCByZXR1cm4gaXQsXG5cCiAgICAgICAgICAgZS5nLiBfYmxvY2soODM0KSA9PiAxMDI0LlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgICRyaWdodD1pdGVyKGdldGF0dHIoZGl2bW9kLCJfX2NhbGxfXyIpKGNvdW50LEJMT0NLU0laRSkpOyRjb3VudGVyPS0xCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzY4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgICAgIHZhciBibG9ja3M9JGxvY2Fsc1siYmxvY2tzIl09bmV4dCgkcmlnaHQpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgICAgIHZhciByZW1haW5kZXI9JGxvY2Fsc1sicmVtYWluZGVyIl09bmV4dCgkcmlnaHQpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTE5MCl7CiAgICAgICAgICAgICAgICAgICAgaWYoJGVycjExOTAuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKTt0aHJvdyBWYWx1ZUVycm9yKCJuZWVkIG1vcmUgdGhhbiAiKyRjb3VudGVyKyIgdmFsdWUiKygkY291bnRlcj4xID8gInMiIDogIiIpKyIgdG8gdW5wYWNrIil9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgJGV4aGF1c3RlZD10cnVlO3RyeXtuZXh0KCRyaWdodCk7JGV4aGF1c3RlZD1mYWxzZX1jYXRjaChlcnIpe2lmKGVyci5fX25hbWVfXz09IlN0b3BJdGVyYXRpb24iKXskcG9wX2V4YygpfX1pZighJGV4aGF1c3RlZCl7dGhyb3cgVmFsdWVFcnJvcigidG9vIG1hbnkgdmFsdWVzIHRvIHVucGFjayAoZXhwZWN0ZWQgIisoJGNvdW50ZXIrMSkrIikiKX0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzNjksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2wocmVtYWluZGVyKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTM3MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciAkdGVtcD0kbG9jYWxzWyIkdGVtcCJdPU51bWJlcigxKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKCR0ZW1wLiRmYXN0X2F1Z20gJiYgYmxvY2tzLiRmYXN0X2F1Z20pe2Jsb2Nrcys9JHRlbXA7JGxvY2Fsc1siYmxvY2tzIl09YmxvY2tzfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoIWhhc2F0dHIoYmxvY2tzLCJfX2lhZGRfXyIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJsb2Nrcz0kbG9jYWxzWyJibG9ja3MiXT1nZXRhdHRyKGJsb2NrcywiX19hZGRfXyIpKCR0ZW1wKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBibG9ja3M9JGxvY2Fsc1siYmxvY2tzIl09Z2V0YXR0cihibG9ja3MsIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTM3MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoYmxvY2tzLCJfX211bF9fIikoQkxPQ0tTSVpFKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExOTApe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTkwKX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5fYmxvY2suX19uYW1lX189Il9ibG9jayIKICAgICRjbGFzcy5fYmxvY2suX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5fYmxvY2suX19kb2NfXz0iUm91bmQgdXAgYSBieXRlIGNvdW50IGJ5IEJMT0NLU0laRSBhbmQgcmV0dXJuIGl0LFxuXAogICAgICAgICAgIGUuZy4gX2Jsb2NrKDgzNCkgPT4gMTAyNC5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzczLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuaXNyZWc9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoImlzcmVnIixhcmd1bWVudHMsWyJzZWxmIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJqM3JpbTVieSJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTM3NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJ0eXBlIiksIl9faW5fXyIpKFJFR1VMQVJfVFlQRVMpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE5MSl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExOTEpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLmlzcmVnLl9fbmFtZV9fPSJpc3JlZyIKICAgICRjbGFzcy5pc3JlZy5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLmlzcmVnLl9fZG9jX189IiIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzNzUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5pc2ZpbGU9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoImlzZmlsZSIsYXJndW1lbnRzLFsic2VsZiJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiZnhxNTQyajgiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzNzYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiBnZXRhdHRyKGdldGF0dHIoc2VsZiwiaXNyZWciKSwiX19jYWxsX18iKSgpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE5MSl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExOTEpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLmlzZmlsZS5fX25hbWVfXz0iaXNmaWxlIgogICAgJGNsYXNzLmlzZmlsZS5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLmlzZmlsZS5fX2RvY19fPSIiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzc3LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuaXNkaXI9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoImlzZGlyIixhcmd1bWVudHMsWyJzZWxmIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJzcDNuNzRubSJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTM3OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJ0eXBlIiksIl9fZXFfXyIpKERJUlRZUEUpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE5MSl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExOTEpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLmlzZGlyLl9fbmFtZV9fPSJpc2RpciIKICAgICRjbGFzcy5pc2Rpci5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLmlzZGlyLl9fZG9jX189IiIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzNzksIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5pc3N5bT0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiaXNzeW0iLGFyZ3VtZW50cyxbInNlbGYiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImpycGJhYjViIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzgwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0YXR0cihnZXRhdHRyKHNlbGYsInR5cGUiKSwiX19lcV9fIikoU1lNVFlQRSkKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTkxKXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE5MSl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuaXNzeW0uX19uYW1lX189Imlzc3ltIgogICAgJGNsYXNzLmlzc3ltLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuaXNzeW0uX19kb2NfXz0iIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTM4MSwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLmlzbG5rPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJpc2xuayIsYXJndW1lbnRzLFsic2VsZiJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsibTdrc2JnNnciXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzODIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiBnZXRhdHRyKGdldGF0dHIoc2VsZiwidHlwZSIpLCJfX2VxX18iKShMTktUWVBFKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExOTEpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTkxKX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5pc2xuay5fX25hbWVfXz0iaXNsbmsiCiAgICAkY2xhc3MuaXNsbmsuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5pc2xuay5fX2RvY19fPSIiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzgzLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuaXNjaHI9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoImlzY2hyIixhcmd1bWVudHMsWyJzZWxmIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJnd3A5c2szdCJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTM4NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJ0eXBlIiksIl9fZXFfXyIpKENIUlRZUEUpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE5MSl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExOTEpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLmlzY2hyLl9fbmFtZV9fPSJpc2NociIKICAgICRjbGFzcy5pc2Noci5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLmlzY2hyLl9fZG9jX189IiIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzODUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5pc2Jsaz0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiaXNibGsiLGFyZ3VtZW50cyxbInNlbGYiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbInRwZG1xdHczIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzg2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0YXR0cihnZXRhdHRyKHNlbGYsInR5cGUiKSwiX19lcV9fIikoQkxLVFlQRSkKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTkxKXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE5MSl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuaXNibGsuX19uYW1lX189ImlzYmxrIgogICAgJGNsYXNzLmlzYmxrLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuaXNibGsuX19kb2NfXz0iIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTM4NywiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLmlzZmlmbz0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiaXNmaWZvIixhcmd1bWVudHMsWyJzZWxmIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJma2c1dHM2ciJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTM4OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJ0eXBlIiksIl9fZXFfXyIpKEZJRk9UWVBFKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExOTEpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTkxKX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5pc2ZpZm8uX19uYW1lX189ImlzZmlmbyIKICAgICRjbGFzcy5pc2ZpZm8uX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5pc2ZpZm8uX19kb2NfXz0iIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTM4OSwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLmlzc3BhcnNlPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJpc3NwYXJzZSIsYXJndW1lbnRzLFsic2VsZiJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiYmoxMTlyMW4iXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzOTAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiBnZXRhdHRyKHNlbGYsInNwYXJzZSIpIT09Tm9uZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExOTEpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTkxKX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5pc3NwYXJzZS5fX25hbWVfXz0iaXNzcGFyc2UiCiAgICAkY2xhc3MuaXNzcGFyc2UuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5pc3NwYXJzZS5fX2RvY19fPSIiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzkxLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuaXNkZXY9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoImlzZGV2Iixhcmd1bWVudHMsWyJzZWxmIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyIwa2hyeG00eCJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTM5MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJ0eXBlIiksIl9faW5fXyIpKHR1cGxlKFtDSFJUWVBFLEJMS1RZUEUsRklGT1RZUEVdKSkKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTkxKXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE5MSl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuaXNkZXYuX19uYW1lX189ImlzZGV2IgogICAgJGNsYXNzLmlzZGV2Ll9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuaXNkZXYuX19kb2NfXz0iIgogICAgcmV0dXJuICRjbGFzcwp9CikoKQokVGFySW5mby5fX2RvY19fPSJJbmZvcm1hdGlvbmFsIGNsYXNzIHdoaWNoIGhvbGRzIHRoZSBkZXRhaWxzIGFib3V0IGFuXG5cCiAgICAgICBhcmNoaXZlIG1lbWJlciBnaXZlbiBieSBhIHRhciBoZWFkZXIgYmxvY2suXG5cCiAgICAgICBUYXJJbmZvIG9iamVjdHMgYXJlIHJldHVybmVkIGJ5IFRhckZpbGUuZ2V0bWVtYmVyKCksXG5cCiAgICAgICBUYXJGaWxlLmdldG1lbWJlcnMoKSBhbmQgVGFyRmlsZS5nZXR0YXJpbmZvKCkgYW5kIGFyZVxuXAogICAgICAgdXN1YWxseSBjcmVhdGVkIGludGVybmFsbHkuXG5cCiAgICAiCiRUYXJJbmZvLl9fbW9kdWxlX189Il9fbWFpbl9fIgp2YXIgVGFySW5mbz0kY2xhc3NfY29uc3RydWN0b3IoIlRhckluZm8iLCRUYXJJbmZvLG9iamVjdCkKd2luZG93LlRhckluZm89VGFySW5mbwpfX0JSWVRIT05fXy5zY29wZVsiX19tYWluX18iXS5fX2RpY3RfX1siVGFySW5mbyJdPVRhckluZm8KZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTM5NSwiX19tYWluX18iXTtOb25lOwp2YXIgJFRhckZpbGU9KGZ1bmN0aW9uKCl7CiAgICB2YXIgJGNsYXNzID0gbmV3IE9iamVjdCgpCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxMzk2LCJfX21haW5fXyJdO05vbmU7CiAgICAiVGhlIFRhckZpbGUgQ2xhc3MgcHJvdmlkZXMgYW4gaW50ZXJmYWNlIHRvIHRhciBhcmNoaXZlcy5cblwKICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzEzOTksIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5kZWJ1Zz1OdW1iZXIoMCkKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0MDEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5kZXJlZmVyZW5jZT0oJGNsYXNzWyJGYWxzZSJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siRmFsc2UiXSA6IEZhbHNlKQogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQwNCwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLmlnbm9yZV96ZXJvcz0oJGNsYXNzWyJGYWxzZSJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siRmFsc2UiXSA6IEZhbHNlKQogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQwNywiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLmVycm9ybGV2ZWw9TnVtYmVyKDEpCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNDExLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuZm9ybWF0PSgkY2xhc3NbIkRFRkFVTFRfRk9STUFUIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJERUZBVUxUX0ZPUk1BVCJdIDogREVGQVVMVF9GT1JNQVQpCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNDEzLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuZW5jb2Rpbmc9KCRjbGFzc1siRU5DT0RJTkciXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIkVOQ09ESU5HIl0gOiBFTkNPRElORykKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0MTUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5lcnJvcnM9KCRjbGFzc1siTm9uZSJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siTm9uZSJdIDogTm9uZSkKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0MTcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy50YXJpbmZvPSgkY2xhc3NbIlRhckluZm8iXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIlRhckluZm8iXSA6IFRhckluZm8pCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNDE5LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuZmlsZW9iamVjdD0oJGNsYXNzWyJFeEZpbGVPYmplY3QiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIkV4RmlsZU9iamVjdCJdIDogRXhGaWxlT2JqZWN0KQogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQyMSwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLl9faW5pdF9fPSAoZnVuY3Rpb24gKE5vbmUsTm9uZSxOb25lLE5vbmUsTm9uZSxOb25lLE5vbmUsTm9uZSxOb25lLE5vbmUpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiX19pbml0X18iLGFyZ3VtZW50cyxbInNlbGYiXSx7Im5hbWUiOigkY2xhc3NbIk5vbmUiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIk5vbmUiXSA6IE5vbmUpLCJtb2RlIjoiciIsImZpbGVvYmoiOigkY2xhc3NbIk5vbmUiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIk5vbmUiXSA6IE5vbmUpLCJmb3JtYXQiOigkY2xhc3NbIk5vbmUiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIk5vbmUiXSA6IE5vbmUpLCJ0YXJpbmZvIjooJGNsYXNzWyJOb25lIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJOb25lIl0gOiBOb25lKSwiZGVyZWZlcmVuY2UiOigkY2xhc3NbIk5vbmUiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIk5vbmUiXSA6IE5vbmUpLCJpZ25vcmVfemVyb3MiOigkY2xhc3NbIk5vbmUiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIk5vbmUiXSA6IE5vbmUpLCJlbmNvZGluZyI6KCRjbGFzc1siTm9uZSJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siTm9uZSJdIDogTm9uZSksImVycm9ycyI6InN1cnJvZ2F0ZWVzY2FwZSIsInBheF9oZWFkZXJzIjooJGNsYXNzWyJOb25lIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJOb25lIl0gOiBOb25lKSwiZGVidWciOigkY2xhc3NbIk5vbmUiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIk5vbmUiXSA6IE5vbmUpLCJlcnJvcmxldmVsIjooJGNsYXNzWyJOb25lIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJOb25lIl0gOiBOb25lKX0sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJoYXF1N25iYyJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQyNCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIk9wZW4gYW4gKHVuY29tcHJlc3NlZCkgdGFyIGFyY2hpdmUgYG5hbWUnLiBgbW9kZScgaXMgZWl0aGVyICdyJyB0b1xuXAogICAgICAgICAgIHJlYWQgZnJvbSBhbiBleGlzdGluZyBhcmNoaXZlLCAnYScgdG8gYXBwZW5kIGRhdGEgdG8gYW4gZXhpc3RpbmdcblwKICAgICAgICAgICBmaWxlIG9yICd3JyB0byBjcmVhdGUgYSBuZXcgZmlsZSBvdmVyd3JpdGluZyBhbiBleGlzdGluZyBvbmUuIGBtb2RlJ1xuXAogICAgICAgICAgIGRlZmF1bHRzIHRvICdyJy5cblwKICAgICAgICAgICBJZiBgZmlsZW9iaicgaXMgZ2l2ZW4sIGl0IGlzIHVzZWQgZm9yIHJlYWRpbmcgb3Igd3JpdGluZyBkYXRhLiBJZiBpdFxuXAogICAgICAgICAgIGNhbiBiZSBkZXRlcm1pbmVkLCBgbW9kZScgaXMgb3ZlcnJpZGRlbiBieSBgZmlsZW9iaidzIG1vZGUuXG5cCiAgICAgICAgICAgYGZpbGVvYmonIGlzIG5vdCBjbG9zZWQsIHdoZW4gVGFyRmlsZSBpcyBjbG9zZWQuXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQzMiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKGxlbiwiX19jYWxsX18iKShtb2RlKSwiX19ndF9fIikoTnVtYmVyKDEpKSl8fCR0ZXN0X2l0ZW0oZ2V0YXR0cihtb2RlLCJfX25vdF9pbl9fIikoInJhdyIpKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNDMzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihWYWx1ZUVycm9yLCJfX2NhbGxfXyIpKCJtb2RlIG11c3QgYmUgJ3InLCAnYScgb3IgJ3cnIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0MzQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwibW9kZSIsbW9kZSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0MzUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiX21vZGUiLGdldGF0dHIoJGRpY3QoW1siciIsInJiIl0sWyJhIiwicitiIl0sWyJ3Iiwid2IiXV0pLCJfX2dldGl0ZW1fXyIpKG1vZGUpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQzNywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbCghYm9vbChmaWxlb2JqKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0MzgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZihib29sKCR0ZXN0X2V4cHIoJHRlc3RfaXRlbShnZXRhdHRyKGdldGF0dHIoc2VsZiwibW9kZSIpLCJfX2VxX18iKSgiYSIpKSYmJHRlc3RfaXRlbSghYm9vbChnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihvcywicGF0aCIpLCJleGlzdHMiKSwiX19jYWxsX18iKShuYW1lKSkpKSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNDQwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwibW9kZSIsInciKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNDQxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiX21vZGUiLCJ3YiIpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0NDIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZW9iaj0kbG9jYWxzWyJmaWxlb2JqIl09Z2V0YXR0cihibHRuX29wZW4sIl9fY2FsbF9fIikobmFtZSxnZXRhdHRyKHNlbGYsIl9tb2RlIikpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ0MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiX2V4dGZpbGVvYmoiLEZhbHNlKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNDQ1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0obmFtZT09PU5vbmUpJiYkdGVzdF9pdGVtKGdldGF0dHIoaGFzYXR0ciwiX19jYWxsX18iKShmaWxlb2JqLCJuYW1lIikpKSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNDQ2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuYW1lPSRsb2NhbHNbIm5hbWUiXT1nZXRhdHRyKGZpbGVvYmosIm5hbWUiKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNDQ3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGhhc2F0dHIsIl9fY2FsbF9fIikoZmlsZW9iaiwibW9kZSIpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0NDgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJfbW9kZSIsZ2V0YXR0cihmaWxlb2JqLCJtb2RlIikpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0NDksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsIl9leHRmaWxlb2JqIixUcnVlKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ1MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJuYW1lIiwkdGVybmFyeSh7Im9zIjpvcywibmFtZSI6bmFtZSwiTm9uZSI6Tm9uZX0sIm5hbWUiLCJnZXRhdHRyJTI4Z2V0YXR0ciUyOGdldGF0dHIlMjhvcyUyQyUyMnBhdGglMjIlMjklMkMlMjJhYnNwYXRoJTIyJTI5JTJDJTIyX19jYWxsX18lMjIlMjklMjhuYW1lJTI5IiwiTm9uZSIpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ1MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJmaWxlb2JqIixmaWxlb2JqKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ1NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChmb3JtYXQhPT1Ob25lKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ1NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiZm9ybWF0Iixmb3JtYXQpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNDU2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKHRhcmluZm8hPT1Ob25lKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ1NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwidGFyaW5mbyIsdGFyaW5mbyk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0NTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZGVyZWZlcmVuY2UhPT1Ob25lKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ1OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiZGVyZWZlcmVuY2UiLGRlcmVmZXJlbmNlKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ2MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChpZ25vcmVfemVyb3MhPT1Ob25lKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ2MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiaWdub3JlX3plcm9zIixpZ25vcmVfemVyb3MpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNDYyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGVuY29kaW5nIT09Tm9uZSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0NjMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImVuY29kaW5nIixlbmNvZGluZyk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0NjQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiZXJyb3JzIixlcnJvcnMpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNDY2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKCR0ZXN0X2V4cHIoJHRlc3RfaXRlbShwYXhfaGVhZGVycyE9PU5vbmUpJiYkdGVzdF9pdGVtKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJmb3JtYXQiKSwiX19lcV9fIikoUEFYX0ZPUk1BVCkpKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0NjcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsInBheF9oZWFkZXJzIixwYXhfaGVhZGVycyk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ2OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwicGF4X2hlYWRlcnMiLCRkaWN0KFtdKSk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0NzEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZGVidWchPT1Ob25lKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ3MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiZGVidWciLGRlYnVnKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ3MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChlcnJvcmxldmVsIT09Tm9uZSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0NzQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImVycm9ybGV2ZWwiLGVycm9ybGV2ZWwpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNDc3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImNsb3NlZCIsRmFsc2UpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNDc4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsIm1lbWJlcnMiLGxpc3QuX19jYWxsX18oW10pKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ3OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJfbG9hZGVkIixGYWxzZSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0ODAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwib2Zmc2V0IixnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJmaWxlb2JqIiksInRlbGwiKSwiX19jYWxsX18iKSgpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ4MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJpbm9kZXMiLCRkaWN0KFtdKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0ODUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICRmYWlsZWQxMTkxPWZhbHNlO3RyeXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNDg2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIoc2VsZiwibW9kZSIpLCJfX2VxX18iKSgiciIpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0ODcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJmaXJzdG1lbWJlciIsTm9uZSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ4OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsImZpcnN0bWVtYmVyIixnZXRhdHRyKGdldGF0dHIoc2VsZiwibmV4dCIpLCJfX2NhbGxfXyIpKCkpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0OTAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJtb2RlIiksIl9fZXFfXyIpKCJhIikpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ5MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTE0Mj10cnVlO3doaWxlKGJvb2woVHJ1ZSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ5NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwiZmlsZW9iaiIpLCJzZWVrIiksIl9fY2FsbF9fIikoZ2V0YXR0cihzZWxmLCJvZmZzZXQiKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0OTUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRmYWlsZWQxMTkyPWZhbHNlO3RyeXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNDk2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmluZm89JGxvY2Fsc1sidGFyaW5mbyJdPWdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHNlbGYsInRhcmluZm8iKSwiZnJvbXRhcmZpbGUiKSwiX19jYWxsX18iKShzZWxmKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE0OTcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJtZW1iZXJzIiksImFwcGVuZCIpLCJfX2NhbGxfXyIpKHRhcmluZm8pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTE5Mil7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRmYWlsZWQxMTkyPXRydWU7aWYoZmFsc2Upe3ZvaWQoMCl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMTkyLFtFT0ZIZWFkZXJFcnJvcl0pKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTQ5OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJmaWxlb2JqIiksInNlZWsiKSwiX19jYWxsX18iKShnZXRhdHRyKHNlbGYsIm9mZnNldCIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTAwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMTQyPWZhbHNlO2JyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoJGlzX2V4YygkZXJyMTE5MixbSGVhZGVyRXJyb3JdKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlPV9fQlJZVEhPTl9fLmV4Y2VwdGlvbigkZXJyMTE5MikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTUwMiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKFJlYWRFcnJvciwiX19jYWxsX18iKShnZXRhdHRyKHN0ciwiX19jYWxsX18iKShlKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXt0aHJvdyAkZXJyMTE5Mn0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTA0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIoc2VsZiwibW9kZSIpLCJfX2luX18iKSgiYXciKSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTA1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiX2xvYWRlZCIsVHJ1ZSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTUwNywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoc2VsZiwicGF4X2hlYWRlcnMiKSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTUwOCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ1Zj0kbG9jYWxzWyJidWYiXT1nZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJ0YXJpbmZvIiksImNyZWF0ZV9wYXhfZ2xvYmFsX2hlYWRlciIpLCJfX2NhbGxfXyIpKGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHNlbGYsInBheF9oZWFkZXJzIiksImNvcHkiKSwiX19jYWxsX18iKSgpKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTUwOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwiZmlsZW9iaiIpLCJ3cml0ZSIpLCJfX2NhbGxfXyIpKGJ1ZikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE1MTAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkdGVtcD0kbG9jYWxzWyIkdGVtcCJdPWdldGF0dHIobGVuLCJfX2NhbGxfXyIpKGJ1Zik7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFoYXNhdHRyKGdldGF0dHIoc2VsZiwib2Zmc2V0IiksIl9faWFkZF9fIikpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwib2Zmc2V0IixnZXRhdHRyKGdldGF0dHIoc2VsZiwib2Zmc2V0IiksIl9fYWRkX18iKSgkdGVtcCkpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoc2VsZiwib2Zmc2V0Iik9Z2V0YXR0cihnZXRhdHRyKHNlbGYsIm9mZnNldCIpLCJfX2lhZGRfXyIpKCR0ZW1wKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2goJGVycjExOTEpewogICAgICAgICAgICAgICAgICAgIHZhciAkZmFpbGVkMTE5MT10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE1MTIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoYm9vbCghYm9vbChnZXRhdHRyKHNlbGYsIl9leHRmaWxlb2JqIikpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTEzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJmaWxlb2JqIiksImNsb3NlIiksIl9fY2FsbF9fIikoKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE1MTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJjbG9zZWQiLFRydWUpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE1MTUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgJHJhaXNlKCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTE5MSl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjExOTEpfQogICAgICAgIH0KICAgIH0KICAgICkoJGNsYXNzLk5vbmUgIT0gdW5kZWZpbmVkID8gJGNsYXNzLk5vbmUgOiBOb25lLCRjbGFzcy5Ob25lICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5Ob25lIDogTm9uZSwkY2xhc3MuTm9uZSAhPSB1bmRlZmluZWQgPyAkY2xhc3MuTm9uZSA6IE5vbmUsJGNsYXNzLk5vbmUgIT0gdW5kZWZpbmVkID8gJGNsYXNzLk5vbmUgOiBOb25lLCRjbGFzcy5Ob25lICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5Ob25lIDogTm9uZSwkY2xhc3MuTm9uZSAhPSB1bmRlZmluZWQgPyAkY2xhc3MuTm9uZSA6IE5vbmUsJGNsYXNzLk5vbmUgIT0gdW5kZWZpbmVkID8gJGNsYXNzLk5vbmUgOiBOb25lLCRjbGFzcy5Ob25lICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5Ob25lIDogTm9uZSwkY2xhc3MuTm9uZSAhPSB1bmRlZmluZWQgPyAkY2xhc3MuTm9uZSA6IE5vbmUsJGNsYXNzLk5vbmUgIT0gdW5kZWZpbmVkID8gJGNsYXNzLk5vbmUgOiBOb25lKQogICAgJGNsYXNzLl9faW5pdF9fLl9fbmFtZV9fPSJfX2luaXRfXyIKICAgICRjbGFzcy5fX2luaXRfXy5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9faW5pdF9fLl9fZG9jX189Ik9wZW4gYW4gKHVuY29tcHJlc3NlZCkgdGFyIGFyY2hpdmUgYG5hbWUnLiBgbW9kZScgaXMgZWl0aGVyICdyJyB0b1xuXAogICAgICAgICAgIHJlYWQgZnJvbSBhbiBleGlzdGluZyBhcmNoaXZlLCAnYScgdG8gYXBwZW5kIGRhdGEgdG8gYW4gZXhpc3RpbmdcblwKICAgICAgICAgICBmaWxlIG9yICd3JyB0byBjcmVhdGUgYSBuZXcgZmlsZSBvdmVyd3JpdGluZyBhbiBleGlzdGluZyBvbmUuIGBtb2RlJ1xuXAogICAgICAgICAgIGRlZmF1bHRzIHRvICdyJy5cblwKICAgICAgICAgICBJZiBgZmlsZW9iaicgaXMgZ2l2ZW4sIGl0IGlzIHVzZWQgZm9yIHJlYWRpbmcgb3Igd3JpdGluZyBkYXRhLiBJZiBpdFxuXAogICAgICAgICAgIGNhbiBiZSBkZXRlcm1pbmVkLCBgbW9kZScgaXMgb3ZlcnJpZGRlbiBieSBgZmlsZW9iaidzIG1vZGUuXG5cCiAgICAgICAgICAgYGZpbGVvYmonIGlzIG5vdCBjbG9zZWQsIHdoZW4gVGFyRmlsZSBpcyBjbG9zZWQuXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTUyOCwiX19tYWluX18iXTtOb25lOwogICAgJDMzem5zeTkxPSgkY2xhc3NbImNsYXNzbWV0aG9kIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJjbGFzc21ldGhvZCJdIDogY2xhc3NtZXRob2QpOwogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTUyOSwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLm9wZW49IChmdW5jdGlvbiAoTm9uZSxOb25lLFJFQ09SRFNJWkUpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygib3BlbiIsYXJndW1lbnRzLFsiY2xzIl0seyJuYW1lIjooJGNsYXNzWyJOb25lIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJOb25lIl0gOiBOb25lKSwibW9kZSI6InIiLCJmaWxlb2JqIjooJGNsYXNzWyJOb25lIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJOb25lIl0gOiBOb25lKSwiYnVmc2l6ZSI6KCRjbGFzc1siUkVDT1JEU0laRSJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siUkVDT1JEU0laRSJdIDogUkVDT1JEU0laRSl9LG51bGwsImt3YXJncyIpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImhiejE4M3BrIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTMwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiT3BlbiBhIHRhciBhcmNoaXZlIGZvciByZWFkaW5nLCB3cml0aW5nIG9yIGFwcGVuZGluZy4gUmV0dXJuXG5cCiAgICAgICAgICAgYW4gYXBwcm9wcmlhdGUgVGFyRmlsZSBjbGFzcy5cblwKXG5cCiAgICAgICAgICAgbW9kZTpcblwKICAgICAgICAgICAncicgb3IgJ3I6Kicgb3BlbiBmb3IgcmVhZGluZyB3aXRoIHRyYW5zcGFyZW50IGNvbXByZXNzaW9uXG5cCiAgICAgICAgICAgJ3I6JyAgICAgICAgIG9wZW4gZm9yIHJlYWRpbmcgZXhjbHVzaXZlbHkgdW5jb21wcmVzc2VkXG5cCiAgICAgICAgICAgJ3I6Z3onICAgICAgIG9wZW4gZm9yIHJlYWRpbmcgd2l0aCBnemlwIGNvbXByZXNzaW9uXG5cCiAgICAgICAgICAgJ3I6YnoyJyAgICAgIG9wZW4gZm9yIHJlYWRpbmcgd2l0aCBiemlwMiBjb21wcmVzc2lvblxuXAogICAgICAgICAgICdyOnh6JyAgICAgICBvcGVuIGZvciByZWFkaW5nIHdpdGggbHptYSBjb21wcmVzc2lvblxuXAogICAgICAgICAgICdhJyBvciAnYTonICBvcGVuIGZvciBhcHBlbmRpbmcsIGNyZWF0aW5nIHRoZSBmaWxlIGlmIG5lY2Vzc2FyeVxuXAogICAgICAgICAgICd3JyBvciAndzonICBvcGVuIGZvciB3cml0aW5nIHdpdGhvdXQgY29tcHJlc3Npb25cblwKICAgICAgICAgICAndzpneicgICAgICAgb3BlbiBmb3Igd3JpdGluZyB3aXRoIGd6aXAgY29tcHJlc3Npb25cblwKICAgICAgICAgICAndzpiejInICAgICAgb3BlbiBmb3Igd3JpdGluZyB3aXRoIGJ6aXAyIGNvbXByZXNzaW9uXG5cCiAgICAgICAgICAgJ3c6eHonICAgICAgIG9wZW4gZm9yIHdyaXRpbmcgd2l0aCBsem1hIGNvbXByZXNzaW9uXG5cClxuXAogICAgICAgICAgICdyfConICAgICAgICBvcGVuIGEgc3RyZWFtIG9mIHRhciBibG9ja3Mgd2l0aCB0cmFuc3BhcmVudCBjb21wcmVzc2lvblxuXAogICAgICAgICAgICdyfCcgICAgICAgICBvcGVuIGFuIHVuY29tcHJlc3NlZCBzdHJlYW0gb2YgdGFyIGJsb2NrcyBmb3IgcmVhZGluZ1xuXAogICAgICAgICAgICdyfGd6JyAgICAgICBvcGVuIGEgZ3ppcCBjb21wcmVzc2VkIHN0cmVhbSBvZiB0YXIgYmxvY2tzXG5cCiAgICAgICAgICAgJ3J8YnoyJyAgICAgIG9wZW4gYSBiemlwMiBjb21wcmVzc2VkIHN0cmVhbSBvZiB0YXIgYmxvY2tzXG5cCiAgICAgICAgICAgJ3J8eHonICAgICAgIG9wZW4gYW4gbHptYSBjb21wcmVzc2VkIHN0cmVhbSBvZiB0YXIgYmxvY2tzXG5cCiAgICAgICAgICAgJ3d8JyAgICAgICAgIG9wZW4gYW4gdW5jb21wcmVzc2VkIHN0cmVhbSBmb3Igd3JpdGluZ1xuXAogICAgICAgICAgICd3fGd6JyAgICAgICBvcGVuIGEgZ3ppcCBjb21wcmVzc2VkIHN0cmVhbSBmb3Igd3JpdGluZ1xuXAogICAgICAgICAgICd3fGJ6MicgICAgICBvcGVuIGEgYnppcDIgY29tcHJlc3NlZCBzdHJlYW0gZm9yIHdyaXRpbmdcblwKICAgICAgICAgICAnd3x4eicgICAgICAgb3BlbiBhbiBsem1hIGNvbXByZXNzZWQgc3RyZWFtIGZvciB3cml0aW5nXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTU1NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oIWJvb2wobmFtZSkpJiYkdGVzdF9pdGVtKCFib29sKGZpbGVvYmopKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTU3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihWYWx1ZUVycm9yLCJfX2NhbGxfXyIpKCJub3RoaW5nIHRvIG9wZW4iKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTU1OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKG1vZGUsIl9faW5fXyIpKHR1cGxlKFsiciIsInI6KiJdKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTYxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICRuZXh0MTE5Mz1nZXRhdHRyKGl0ZXIoZ2V0YXR0cihjbHMsIk9QRU5fTUVUSCIpKSwiX19uZXh0X18iKQogICAgICAgICAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMTkzPXRydWU7d2hpbGUodHJ1ZSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb21wdHlwZT0kbG9jYWxzWyJjb21wdHlwZSJdPSRuZXh0MTE5MygpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycil7aWYoJGlzX2V4YygkZXJyLFtTdG9wSXRlcmF0aW9uXSkpeyRwb3BfZXhjKCk7YnJlYWt9ZWxzZXt0aHJvdygkZXJyKX19CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE1NjIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZ1bmM9JGxvY2Fsc1siZnVuYyJdPWdldGF0dHIoZ2V0YXR0ciwiX19jYWxsX18iKShjbHMsZ2V0YXR0cihnZXRhdHRyKGNscywiT1BFTl9NRVRIIiksIl9fZ2V0aXRlbV9fIikoY29tcHR5cGUpKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTYzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJvb2woZmlsZW9iaiE9PU5vbmUpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE1NjQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzYXZlZF9wb3M9JGxvY2Fsc1sic2F2ZWRfcG9zIl09Z2V0YXR0cihnZXRhdHRyKGZpbGVvYmosInRlbGwiKSwiX19jYWxsX18iKSgpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTU2NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAkZmFpbGVkMTE5ND1mYWxzZTt0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTY2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0YXR0cihmdW5jLCJfX2NhbGxfXyIpKG5hbWUsInIiLGZpbGVvYmosJHBkaWN0KGt3YXJncykpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycjExOTQpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRmYWlsZWQxMTk0PXRydWU7aWYoZmFsc2Upe3ZvaWQoMCl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKCRpc19leGMoJGVycjExOTQsW3R1cGxlKFtSZWFkRXJyb3IsQ29tcHJlc3Npb25FcnJvcl0pXSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlPV9fQlJZVEhPTl9fLmV4Y2VwdGlvbigkZXJyMTE5NCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTY4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChmaWxlb2JqIT09Tm9uZSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTY5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihmaWxlb2JqLCJzZWVrIiksIl9fY2FsbF9fIikoc2F2ZWRfcG9zKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTcwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7dGhyb3cgJGVycjExOTR9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTU3MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHRocm93IGdldGF0dHIoUmVhZEVycm9yLCJfX2NhbGxfXyIpKCJmaWxlIGNvdWxkIG5vdCBiZSBvcGVuZWQgc3VjY2Vzc2Z1bGx5IikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoYm9vbChnZXRhdHRyKCI6IiwiX19pbl9fIikobW9kZSkpKXsKICAgICAgICAgICAgICAgICAgICAkcmlnaHQ9aXRlcihnZXRhdHRyKGdldGF0dHIobW9kZSwic3BsaXQiKSwiX19jYWxsX18iKSgiOiIsTnVtYmVyKDEpKSk7JGNvdW50ZXI9LTEKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTc0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICAkY291bnRlcisrCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWxlbW9kZT0kbG9jYWxzWyJmaWxlbW9kZSJdPW5leHQoJHJpZ2h0KTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAkY291bnRlcisrCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb21wdHlwZT0kbG9jYWxzWyJjb21wdHlwZSJdPW5leHQoJHJpZ2h0KTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTE5NSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRlcnIxMTk1Ll9fbmFtZV9fPT0iU3RvcEl0ZXJhdGlvbiIpeyRwb3BfZXhjKCk7dGhyb3cgVmFsdWVFcnJvcigibmVlZCBtb3JlIHRoYW4gIiskY291bnRlcisiIHZhbHVlIisoJGNvdW50ZXI+MSA/ICJzIiA6ICIiKSsiIHRvIHVucGFjayIpfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB2YXIgJGV4aGF1c3RlZD10cnVlO3RyeXtuZXh0KCRyaWdodCk7JGV4aGF1c3RlZD1mYWxzZX1jYXRjaChlcnIpe2lmKGVyci5fX25hbWVfXz09IlN0b3BJdGVyYXRpb24iKXskcG9wX2V4YygpfX1pZighJGV4aGF1c3RlZCl7dGhyb3cgVmFsdWVFcnJvcigidG9vIG1hbnkgdmFsdWVzIHRvIHVucGFjayAoZXhwZWN0ZWQgIisoJGNvdW50ZXIrMSkrIikiKX0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTc1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGVtb2RlPSRsb2NhbHNbImZpbGVtb2RlIl09JHRlc3RfZXhwcigkdGVzdF9pdGVtKGZpbGVtb2RlKXx8JHRlc3RfaXRlbSgiciIpKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE1NzYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgY29tcHR5cGU9JGxvY2Fsc1siY29tcHR5cGUiXT0kdGVzdF9leHByKCR0ZXN0X2l0ZW0oY29tcHR5cGUpfHwkdGVzdF9pdGVtKCJ0YXIiKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTgwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGNvbXB0eXBlLCJfX2luX18iKShnZXRhdHRyKGNscywiT1BFTl9NRVRIIikpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE1ODEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZ1bmM9JGxvY2Fsc1siZnVuYyJdPWdldGF0dHIoZ2V0YXR0ciwiX19jYWxsX18iKShjbHMsZ2V0YXR0cihnZXRhdHRyKGNscywiT1BFTl9NRVRIIiksIl9fZ2V0aXRlbV9fIikoY29tcHR5cGUpKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTgzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGdldGF0dHIoQ29tcHJlc3Npb25FcnJvciwiX19jYWxsX18iKShnZXRhdHRyKCJ1bmtub3duIGNvbXByZXNzaW9uIHR5cGUgJXIiLCJfX21vZF9fIikoY29tcHR5cGUpKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTg0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoZnVuYywiX19jYWxsX18iKShuYW1lLGZpbGVtb2RlLGZpbGVvYmosJHBkaWN0KGt3YXJncykpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGJvb2woZ2V0YXR0cigifCIsIl9faW5fXyIpKG1vZGUpKSl7CiAgICAgICAgICAgICAgICAgICAgJHJpZ2h0PWl0ZXIoZ2V0YXR0cihnZXRhdHRyKG1vZGUsInNwbGl0IiksIl9fY2FsbF9fIikoInwiLE51bWJlcigxKSkpOyRjb3VudGVyPS0xCiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTU4NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZW1vZGU9JGxvY2Fsc1siZmlsZW1vZGUiXT1uZXh0KCRyaWdodCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29tcHR5cGU9JGxvY2Fsc1siY29tcHR5cGUiXT1uZXh0KCRyaWdodCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycjExOTYpewogICAgICAgICAgICAgICAgICAgICAgICBpZigkZXJyMTE5Ni5fX25hbWVfXz09IlN0b3BJdGVyYXRpb24iKXskcG9wX2V4YygpO3Rocm93IFZhbHVlRXJyb3IoIm5lZWQgbW9yZSB0aGFuICIrJGNvdW50ZXIrIiB2YWx1ZSIrKCRjb3VudGVyPjEgPyAicyIgOiAiIikrIiB0byB1bnBhY2siKX0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdmFyICRleGhhdXN0ZWQ9dHJ1ZTt0cnl7bmV4dCgkcmlnaHQpOyRleGhhdXN0ZWQ9ZmFsc2V9Y2F0Y2goZXJyKXtpZihlcnIuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKX19aWYoISRleGhhdXN0ZWQpe3Rocm93IFZhbHVlRXJyb3IoInRvbyBtYW55IHZhbHVlcyB0byB1bnBhY2sgKGV4cGVjdGVkICIrKCRjb3VudGVyKzEpKyIpIil9CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTU4OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBmaWxlbW9kZT0kbG9jYWxzWyJmaWxlbW9kZSJdPSR0ZXN0X2V4cHIoJHRlc3RfaXRlbShmaWxlbW9kZSl8fCR0ZXN0X2l0ZW0oInIiKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTg5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXB0eXBlPSRsb2NhbHNbImNvbXB0eXBlIl09JHRlc3RfZXhwcigkdGVzdF9pdGVtKGNvbXB0eXBlKXx8JHRlc3RfaXRlbSgidGFyIikpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTU5MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihmaWxlbW9kZSwiX19ub3RfaW5fXyIpKCJydyIpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE1OTIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihWYWx1ZUVycm9yLCJfX2NhbGxfXyIpKCJtb2RlIG11c3QgYmUgJ3InIG9yICd3JyIpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE1OTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgc3RyZWFtPSRsb2NhbHNbInN0cmVhbSJdPWdldGF0dHIoX1N0cmVhbSwiX19jYWxsX18iKShuYW1lLGZpbGVtb2RlLGNvbXB0eXBlLGZpbGVvYmosYnVmc2l6ZSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTk1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgJGZhaWxlZDExOTc9ZmFsc2U7dHJ5ewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNTk2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0PSRsb2NhbHNbInQiXT1nZXRhdHRyKGNscywiX19jYWxsX18iKShuYW1lLGZpbGVtb2RlLHN0cmVhbSwkcGRpY3Qoa3dhcmdzKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycjExOTcpewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGZhaWxlZDExOTc9dHJ1ZTtpZihmYWxzZSl7dm9pZCgwKX0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE1OTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzdHJlYW0sImNsb3NlIiksIl9fY2FsbF9fIikoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTU5OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJhaXNlKCkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjAwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgc2V0YXR0cih0LCJfZXh0ZmlsZW9iaiIsRmFsc2UpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTYwMSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGJvb2woZ2V0YXR0cihtb2RlLCJfX2luX18iKSgiYXciKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2MDQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0YXR0cihnZXRhdHRyKGNscywidGFyb3BlbiIpLCJfX2NhbGxfXyIpKG5hbWUsbW9kZSxmaWxlb2JqLCRwZGljdChrd2FyZ3MpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTYwNiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihWYWx1ZUVycm9yLCJfX2NhbGxfXyIpKCJ1bmRpc2Nlcm5pYmxlIG1vZGUiKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExOTMpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTkzKX0KICAgICAgICB9CiAgICB9CiAgICApKCRjbGFzcy5Ob25lICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5Ob25lIDogTm9uZSwkY2xhc3MuTm9uZSAhPSB1bmRlZmluZWQgPyAkY2xhc3MuTm9uZSA6IE5vbmUsJGNsYXNzLlJFQ09SRFNJWkUgIT0gdW5kZWZpbmVkID8gJGNsYXNzLlJFQ09SRFNJWkUgOiBSRUNPUkRTSVpFKQogICAgJGNsYXNzLm9wZW4uX19uYW1lX189Im9wZW4iCiAgICAkY2xhc3Mub3Blbi5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLm9wZW4uX19kb2NfXz0iT3BlbiBhIHRhciBhcmNoaXZlIGZvciByZWFkaW5nLCB3cml0aW5nIG9yIGFwcGVuZGluZy4gUmV0dXJuXG5cCiAgICAgICAgICAgYW4gYXBwcm9wcmlhdGUgVGFyRmlsZSBjbGFzcy5cblwKXG5cCiAgICAgICAgICAgbW9kZTpcblwKICAgICAgICAgICAncicgb3IgJ3I6Kicgb3BlbiBmb3IgcmVhZGluZyB3aXRoIHRyYW5zcGFyZW50IGNvbXByZXNzaW9uXG5cCiAgICAgICAgICAgJ3I6JyAgICAgICAgIG9wZW4gZm9yIHJlYWRpbmcgZXhjbHVzaXZlbHkgdW5jb21wcmVzc2VkXG5cCiAgICAgICAgICAgJ3I6Z3onICAgICAgIG9wZW4gZm9yIHJlYWRpbmcgd2l0aCBnemlwIGNvbXByZXNzaW9uXG5cCiAgICAgICAgICAgJ3I6YnoyJyAgICAgIG9wZW4gZm9yIHJlYWRpbmcgd2l0aCBiemlwMiBjb21wcmVzc2lvblxuXAogICAgICAgICAgICdyOnh6JyAgICAgICBvcGVuIGZvciByZWFkaW5nIHdpdGggbHptYSBjb21wcmVzc2lvblxuXAogICAgICAgICAgICdhJyBvciAnYTonICBvcGVuIGZvciBhcHBlbmRpbmcsIGNyZWF0aW5nIHRoZSBmaWxlIGlmIG5lY2Vzc2FyeVxuXAogICAgICAgICAgICd3JyBvciAndzonICBvcGVuIGZvciB3cml0aW5nIHdpdGhvdXQgY29tcHJlc3Npb25cblwKICAgICAgICAgICAndzpneicgICAgICAgb3BlbiBmb3Igd3JpdGluZyB3aXRoIGd6aXAgY29tcHJlc3Npb25cblwKICAgICAgICAgICAndzpiejInICAgICAgb3BlbiBmb3Igd3JpdGluZyB3aXRoIGJ6aXAyIGNvbXByZXNzaW9uXG5cCiAgICAgICAgICAgJ3c6eHonICAgICAgIG9wZW4gZm9yIHdyaXRpbmcgd2l0aCBsem1hIGNvbXByZXNzaW9uXG5cClxuXAogICAgICAgICAgICdyfConICAgICAgICBvcGVuIGEgc3RyZWFtIG9mIHRhciBibG9ja3Mgd2l0aCB0cmFuc3BhcmVudCBjb21wcmVzc2lvblxuXAogICAgICAgICAgICdyfCcgICAgICAgICBvcGVuIGFuIHVuY29tcHJlc3NlZCBzdHJlYW0gb2YgdGFyIGJsb2NrcyBmb3IgcmVhZGluZ1xuXAogICAgICAgICAgICdyfGd6JyAgICAgICBvcGVuIGEgZ3ppcCBjb21wcmVzc2VkIHN0cmVhbSBvZiB0YXIgYmxvY2tzXG5cCiAgICAgICAgICAgJ3J8YnoyJyAgICAgIG9wZW4gYSBiemlwMiBjb21wcmVzc2VkIHN0cmVhbSBvZiB0YXIgYmxvY2tzXG5cCiAgICAgICAgICAgJ3J8eHonICAgICAgIG9wZW4gYW4gbHptYSBjb21wcmVzc2VkIHN0cmVhbSBvZiB0YXIgYmxvY2tzXG5cCiAgICAgICAgICAgJ3d8JyAgICAgICAgIG9wZW4gYW4gdW5jb21wcmVzc2VkIHN0cmVhbSBmb3Igd3JpdGluZ1xuXAogICAgICAgICAgICd3fGd6JyAgICAgICBvcGVuIGEgZ3ppcCBjb21wcmVzc2VkIHN0cmVhbSBmb3Igd3JpdGluZ1xuXAogICAgICAgICAgICd3fGJ6MicgICAgICBvcGVuIGEgYnppcDIgY29tcHJlc3NlZCBzdHJlYW0gZm9yIHdyaXRpbmdcblwKICAgICAgICAgICAnd3x4eicgICAgICAgb3BlbiBhbiBsem1hIGNvbXByZXNzZWQgc3RyZWFtIGZvciB3cml0aW5nXG5cCiAgICAgICAgIgogICAgJGNsYXNzLm9wZW49JDMzem5zeTkxKCRjbGFzcywkY2xhc3Mub3BlbikKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2MDgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICQwaWR5MG8yZj0oJGNsYXNzWyJjbGFzc21ldGhvZCJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siY2xhc3NtZXRob2QiXSA6IGNsYXNzbWV0aG9kKTsKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2MDksIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy50YXJvcGVuPSAoZnVuY3Rpb24gKE5vbmUpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygidGFyb3BlbiIsYXJndW1lbnRzLFsiY2xzIiwibmFtZSJdLHsibW9kZSI6InIiLCJmaWxlb2JqIjooJGNsYXNzWyJOb25lIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJOb25lIl0gOiBOb25lKX0sbnVsbCwia3dhcmdzIikKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiOGdmd3RhZGEiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2MTAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJPcGVuIHVuY29tcHJlc3NlZCB0YXIgYXJjaGl2ZSBuYW1lIGZvciByZWFkaW5nIG9yIHdyaXRpbmcuXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTYxMiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKGxlbiwiX19jYWxsX18iKShtb2RlKSwiX19ndF9fIikoTnVtYmVyKDEpKSl8fCR0ZXN0X2l0ZW0oZ2V0YXR0cihtb2RlLCJfX25vdF9pbl9fIikoInJhdyIpKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjEzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihWYWx1ZUVycm9yLCJfX2NhbGxfXyIpKCJtb2RlIG11c3QgYmUgJ3InLCAnYScgb3IgJ3cnIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2MTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiBnZXRhdHRyKGNscywiX19jYWxsX18iKShuYW1lLG1vZGUsZmlsZW9iaiwkcGRpY3Qoa3dhcmdzKSkKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMTk4KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTE5OCl9CiAgICAgICAgfQogICAgfQogICAgKSgkY2xhc3MuTm9uZSAhPSB1bmRlZmluZWQgPyAkY2xhc3MuTm9uZSA6IE5vbmUpCiAgICAkY2xhc3MudGFyb3Blbi5fX25hbWVfXz0idGFyb3BlbiIKICAgICRjbGFzcy50YXJvcGVuLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MudGFyb3Blbi5fX2RvY19fPSJPcGVuIHVuY29tcHJlc3NlZCB0YXIgYXJjaGl2ZSBuYW1lIGZvciByZWFkaW5nIG9yIHdyaXRpbmcuXG5cCiAgICAgICAgIgogICAgJGNsYXNzLnRhcm9wZW49JDBpZHkwbzJmKCRjbGFzcywkY2xhc3MudGFyb3BlbikKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2MTYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRxcDVyYXowYT0oJGNsYXNzWyJjbGFzc21ldGhvZCJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siY2xhc3NtZXRob2QiXSA6IGNsYXNzbWV0aG9kKTsKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2MTcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5nem9wZW49IChmdW5jdGlvbiAoTm9uZSl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJnem9wZW4iLGFyZ3VtZW50cyxbImNscyIsIm5hbWUiXSx7Im1vZGUiOiJyIiwiZmlsZW9iaiI6KCRjbGFzc1siTm9uZSJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siTm9uZSJdIDogTm9uZSksImNvbXByZXNzbGV2ZWwiOk51bWJlcig5KX0sbnVsbCwia3dhcmdzIikKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiaml5bWdhN2IiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2MTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJPcGVuIGd6aXAgY29tcHJlc3NlZCB0YXIgYXJjaGl2ZSBuYW1lIGZvciByZWFkaW5nIG9yIHdyaXRpbmcuXG5cCiAgICAgICAgICAgQXBwZW5kaW5nIGlzIG5vdCBhbGxvd2VkLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2MjEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKGdldGF0dHIoZ2V0YXR0cihsZW4sIl9fY2FsbF9fIikobW9kZSksIl9fZ3RfXyIpKE51bWJlcigxKSkpfHwkdGVzdF9pdGVtKGdldGF0dHIobW9kZSwiX19ub3RfaW5fXyIpKCJydyIpKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjIyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihWYWx1ZUVycm9yLCJfX2NhbGxfXyIpKCJtb2RlIG11c3QgYmUgJ3InIG9yICd3JyIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjI0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAkZmFpbGVkMTE5OD1mYWxzZTt0cnl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTYyNSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICRpbXBvcnRfbGlzdChbImd6aXAiXSk7dmFyIGd6aXA9JGxvY2Fsc1siZ3ppcCJdPV9fQlJZVEhPTl9fLmltcG9ydGVkWyJnemlwIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjI2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnemlwLCJHemlwRmlsZSIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTE5OCl7CiAgICAgICAgICAgICAgICAgICAgdmFyICRmYWlsZWQxMTk4PXRydWU7aWYoZmFsc2Upe3ZvaWQoMCl9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMTk4LFt0dXBsZShbSW1wb3J0RXJyb3IsQXR0cmlidXRlRXJyb3JdKV0pKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTYyOCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKENvbXByZXNzaW9uRXJyb3IsIl9fY2FsbF9fIikoImd6aXAgbW9kdWxlIGlzIG5vdCBhdmFpbGFibGUiKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNle3Rocm93ICRlcnIxMTk4fQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTYzMCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIGV4dGZpbGVvYmo9JGxvY2Fsc1siZXh0ZmlsZW9iaiJdPWZpbGVvYmohPT1Ob25lO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjMxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAkZmFpbGVkMTE5OT1mYWxzZTt0cnl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTYzMiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBmaWxlb2JqPSRsb2NhbHNbImZpbGVvYmoiXT1nZXRhdHRyKGdldGF0dHIoZ3ppcCwiR3ppcEZpbGUiKSwiX19jYWxsX18iKShuYW1lLGdldGF0dHIobW9kZSwiX19hZGRfXyIpKCJiIiksY29tcHJlc3NsZXZlbCxmaWxlb2JqKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2MzMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgdD0kbG9jYWxzWyJ0Il09Z2V0YXR0cihnZXRhdHRyKGNscywidGFyb3BlbiIpLCJfX2NhbGxfXyIpKG5hbWUsbW9kZSxmaWxlb2JqLCRwZGljdChrd2FyZ3MpKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2goJGVycjExOTkpewogICAgICAgICAgICAgICAgICAgIHZhciAkZmFpbGVkMTE5OT10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoJGlzX2V4YygkZXJyMTE5OSxbSU9FcnJvcl0pKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTYzNSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBpZihib29sKCR0ZXN0X2V4cHIoJHRlc3RfaXRlbSghYm9vbChleHRmaWxlb2JqKSkmJiR0ZXN0X2l0ZW0oZmlsZW9iaiE9PU5vbmUpKSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTYzNiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGZpbGVvYmosImNsb3NlIiksIl9fY2FsbF9fIikoKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2MzcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChmaWxlb2JqPT09Tm9uZSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTYzOCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJhaXNlKCkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjM5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGdldGF0dHIoUmVhZEVycm9yLCJfX2NhbGxfXyIpKCJub3QgYSBnemlwIGZpbGUiKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjQxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKCFib29sKGV4dGZpbGVvYmopKSYmJHRlc3RfaXRlbShmaWxlb2JqIT09Tm9uZSkpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjQyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoZmlsZW9iaiwiY2xvc2UiKSwiX19jYWxsX18iKSgpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTY0MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAkcmFpc2UoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2NDQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIodCwiX2V4dGZpbGVvYmoiLGV4dGZpbGVvYmopO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjQ1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gdAogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjExOTgpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMTk4KX0KICAgICAgICB9CiAgICB9CiAgICApKCRjbGFzcy5Ob25lICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5Ob25lIDogTm9uZSkKICAgICRjbGFzcy5nem9wZW4uX19uYW1lX189Imd6b3BlbiIKICAgICRjbGFzcy5nem9wZW4uX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5nem9wZW4uX19kb2NfXz0iT3BlbiBnemlwIGNvbXByZXNzZWQgdGFyIGFyY2hpdmUgbmFtZSBmb3IgcmVhZGluZyBvciB3cml0aW5nLlxuXAogICAgICAgICAgIEFwcGVuZGluZyBpcyBub3QgYWxsb3dlZC5cblwKICAgICAgICAiCiAgICAkY2xhc3MuZ3pvcGVuPSRxcDVyYXowYSgkY2xhc3MsJGNsYXNzLmd6b3BlbikKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2NDcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICR4bndtNHp0ej0oJGNsYXNzWyJjbGFzc21ldGhvZCJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siY2xhc3NtZXRob2QiXSA6IGNsYXNzbWV0aG9kKTsKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2NDgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5iejJvcGVuPSAoZnVuY3Rpb24gKE5vbmUpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiYnoyb3BlbiIsYXJndW1lbnRzLFsiY2xzIiwibmFtZSJdLHsibW9kZSI6InIiLCJmaWxlb2JqIjooJGNsYXNzWyJOb25lIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJOb25lIl0gOiBOb25lKSwiY29tcHJlc3NsZXZlbCI6TnVtYmVyKDkpfSxudWxsLCJrd2FyZ3MiKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyI1ZG15NHZqNiJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTY0OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIk9wZW4gYnppcDIgY29tcHJlc3NlZCB0YXIgYXJjaGl2ZSBuYW1lIGZvciByZWFkaW5nIG9yIHdyaXRpbmcuXG5cCiAgICAgICAgICAgQXBwZW5kaW5nIGlzIG5vdCBhbGxvd2VkLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2NTIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKGdldGF0dHIoZ2V0YXR0cihsZW4sIl9fY2FsbF9fIikobW9kZSksIl9fZ3RfXyIpKE51bWJlcigxKSkpfHwkdGVzdF9pdGVtKGdldGF0dHIobW9kZSwiX19ub3RfaW5fXyIpKCJydyIpKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjUzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihWYWx1ZUVycm9yLCJfX2NhbGxfXyIpKCJtb2RlIG11c3QgYmUgJ3InIG9yICd3Jy4iKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTY1NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgJGZhaWxlZDEyMDA9ZmFsc2U7dHJ5ewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2NTYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAkaW1wb3J0X2xpc3QoWyJiejIiXSk7dmFyIGJ6Mj0kbG9jYWxzWyJiejIiXT1fX0JSWVRIT05fXy5pbXBvcnRlZFsiYnoyIl07Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIxMjAwKXsKICAgICAgICAgICAgICAgICAgICB2YXIgJGZhaWxlZDEyMDA9dHJ1ZTtpZihmYWxzZSl7dm9pZCgwKX0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKCRpc19leGMoJGVycjEyMDAsW0ltcG9ydEVycm9yXSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjU4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGdldGF0dHIoQ29tcHJlc3Npb25FcnJvciwiX19jYWxsX18iKSgiYnoyIG1vZHVsZSBpcyBub3QgYXZhaWxhYmxlIikKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZXt0aHJvdyAkZXJyMTIwMH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2NjAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBmaWxlb2JqPSRsb2NhbHNbImZpbGVvYmoiXT1nZXRhdHRyKGdldGF0dHIoYnoyLCJCWjJGaWxlIiksIl9fY2FsbF9fIikoJHRlc3RfZXhwcigkdGVzdF9pdGVtKGZpbGVvYmopfHwkdGVzdF9pdGVtKG5hbWUpKSxtb2RlLCRLdygiY29tcHJlc3NsZXZlbCIsY29tcHJlc3NsZXZlbCkpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjYzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAkZmFpbGVkMTIwMT1mYWxzZTt0cnl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTY2NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciB0PSRsb2NhbHNbInQiXT1nZXRhdHRyKGdldGF0dHIoY2xzLCJ0YXJvcGVuIiksIl9fY2FsbF9fIikobmFtZSxtb2RlLGZpbGVvYmosJHBkaWN0KGt3YXJncykpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTIwMSl7CiAgICAgICAgICAgICAgICAgICAgdmFyICRmYWlsZWQxMjAxPXRydWU7aWYoZmFsc2Upe3ZvaWQoMCl9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMjAxLFt0dXBsZShbSU9FcnJvcixFT0ZFcnJvcl0pXSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjY2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihmaWxlb2JqLCJjbG9zZSIpLCJfX2NhbGxfXyIpKCkKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTY2NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKFJlYWRFcnJvciwiX19jYWxsX18iKSgibm90IGEgYnppcDIgZmlsZSIpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2V7dGhyb3cgJGVycjEyMDF9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjY4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHQsIl9leHRmaWxlb2JqIixGYWxzZSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2NjksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiB0CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTIwMCl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjEyMDApfQogICAgICAgIH0KICAgIH0KICAgICkoJGNsYXNzLk5vbmUgIT0gdW5kZWZpbmVkID8gJGNsYXNzLk5vbmUgOiBOb25lKQogICAgJGNsYXNzLmJ6Mm9wZW4uX19uYW1lX189ImJ6Mm9wZW4iCiAgICAkY2xhc3MuYnoyb3Blbi5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLmJ6Mm9wZW4uX19kb2NfXz0iT3BlbiBiemlwMiBjb21wcmVzc2VkIHRhciBhcmNoaXZlIG5hbWUgZm9yIHJlYWRpbmcgb3Igd3JpdGluZy5cblwKICAgICAgICAgICBBcHBlbmRpbmcgaXMgbm90IGFsbG93ZWQuXG5cCiAgICAgICAgIgogICAgJGNsYXNzLmJ6Mm9wZW49JHhud200enR6KCRjbGFzcywkY2xhc3MuYnoyb3BlbikKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2NzEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRxNmk0Z3pqNj0oJGNsYXNzWyJjbGFzc21ldGhvZCJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siY2xhc3NtZXRob2QiXSA6IGNsYXNzbWV0aG9kKTsKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2NzIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy54em9wZW49IChmdW5jdGlvbiAoTm9uZSxOb25lKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoInh6b3BlbiIsYXJndW1lbnRzLFsiY2xzIiwibmFtZSJdLHsibW9kZSI6InIiLCJmaWxlb2JqIjooJGNsYXNzWyJOb25lIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJOb25lIl0gOiBOb25lKSwicHJlc2V0IjooJGNsYXNzWyJOb25lIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJOb25lIl0gOiBOb25lKX0sbnVsbCwia3dhcmdzIikKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsieDA4YzBqMzUiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2NzMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJPcGVuIGx6bWEgY29tcHJlc3NlZCB0YXIgYXJjaGl2ZSBuYW1lIGZvciByZWFkaW5nIG9yIHdyaXRpbmcuXG5cCiAgICAgICAgICAgQXBwZW5kaW5nIGlzIG5vdCBhbGxvd2VkLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2NzYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihtb2RlLCJfX25vdF9pbl9fIikodHVwbGUoWyJyIiwidyJdKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjc3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihWYWx1ZUVycm9yLCJfX2NhbGxfXyIpKCJtb2RlIG11c3QgYmUgJ3InIG9yICd3JyIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjc5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAkZmFpbGVkMTIwMj1mYWxzZTt0cnl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTY4MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICRpbXBvcnRfbGlzdChbImx6bWEiXSk7dmFyIGx6bWE9JGxvY2Fsc1sibHptYSJdPV9fQlJZVEhPTl9fLmltcG9ydGVkWyJsem1hIl07Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIxMjAyKXsKICAgICAgICAgICAgICAgICAgICB2YXIgJGZhaWxlZDEyMDI9dHJ1ZTtpZihmYWxzZSl7dm9pZCgwKX0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKCRpc19leGMoJGVycjEyMDIsW0ltcG9ydEVycm9yXSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjgyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGdldGF0dHIoQ29tcHJlc3Npb25FcnJvciwiX19jYWxsX18iKSgibHptYSBtb2R1bGUgaXMgbm90IGF2YWlsYWJsZSIpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2V7dGhyb3cgJGVycjEyMDJ9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjg0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgZmlsZW9iaj0kbG9jYWxzWyJmaWxlb2JqIl09Z2V0YXR0cihnZXRhdHRyKGx6bWEsIkxaTUFGaWxlIiksIl9fY2FsbF9fIikoJHRlc3RfZXhwcigkdGVzdF9pdGVtKGZpbGVvYmopfHwkdGVzdF9pdGVtKG5hbWUpKSxtb2RlLCRLdygicHJlc2V0IixwcmVzZXQpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTY4NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgJGZhaWxlZDEyMDM9ZmFsc2U7dHJ5ewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2ODcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgdD0kbG9jYWxzWyJ0Il09Z2V0YXR0cihnZXRhdHRyKGNscywidGFyb3BlbiIpLCJfX2NhbGxfXyIpKG5hbWUsbW9kZSxmaWxlb2JqLCRwZGljdChrd2FyZ3MpKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2goJGVycjEyMDMpewogICAgICAgICAgICAgICAgICAgIHZhciAkZmFpbGVkMTIwMz10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoJGlzX2V4YygkZXJyMTIwMyxbdHVwbGUoW2dldGF0dHIobHptYSwiTFpNQUVycm9yIiksRU9GRXJyb3JdKV0pKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTY4OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoZmlsZW9iaiwiY2xvc2UiKSwiX19jYWxsX18iKSgpCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE2OTAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihSZWFkRXJyb3IsIl9fY2FsbF9fIikoIm5vdCBhbiBsem1hIGZpbGUiKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNle3Rocm93ICRlcnIxMjAzfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTY5MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cih0LCJfZXh0ZmlsZW9iaiIsRmFsc2UpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjkyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gdAogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjEyMDIpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMjAyKX0KICAgICAgICB9CiAgICB9CiAgICApKCRjbGFzcy5Ob25lICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5Ob25lIDogTm9uZSwkY2xhc3MuTm9uZSAhPSB1bmRlZmluZWQgPyAkY2xhc3MuTm9uZSA6IE5vbmUpCiAgICAkY2xhc3MueHpvcGVuLl9fbmFtZV9fPSJ4em9wZW4iCiAgICAkY2xhc3MueHpvcGVuLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MueHpvcGVuLl9fZG9jX189Ik9wZW4gbHptYSBjb21wcmVzc2VkIHRhciBhcmNoaXZlIG5hbWUgZm9yIHJlYWRpbmcgb3Igd3JpdGluZy5cblwKICAgICAgICAgICBBcHBlbmRpbmcgaXMgbm90IGFsbG93ZWQuXG5cCiAgICAgICAgIgogICAgJGNsYXNzLnh6b3Blbj0kcTZpNGd6ajYoJGNsYXNzLCRjbGFzcy54em9wZW4pCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNjk1LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuT1BFTl9NRVRIPSRkaWN0KFtbInRhciIsInRhcm9wZW4iXSxbImd6IiwiZ3pvcGVuIl0sWyJiejIiLCJiejJvcGVuIl0sWyJ4eiIsInh6b3BlbiJdXSkKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE3MDUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5jbG9zZT0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiY2xvc2UiLGFyZ3VtZW50cyxbInNlbGYiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImFiNTdudHVzIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzA2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiQ2xvc2UgdGhlIFRhckZpbGUuIEluIHdyaXRlLW1vZGUsIHR3byBmaW5pc2hpbmcgemVybyBibG9ja3MgYXJlXG5cCiAgICAgICAgICAgYXBwZW5kZWQgdG8gdGhlIGFyY2hpdmUuXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTcwOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKHNlbGYsImNsb3NlZCIpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTcxMCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE3MTIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKHNlbGYsIm1vZGUiKSwiX19pbl9fIikoImF3IikpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzEzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwiZmlsZW9iaiIpLCJ3cml0ZSIpLCJfX2NhbGxfXyIpKGdldGF0dHIoTlVMLCJfX211bF9fIikoZ2V0YXR0cihCTE9DS1NJWkUsIl9fbXVsX18iKShOdW1iZXIoMikpKSkKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzE0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICR0ZW1wPSRsb2NhbHNbIiR0ZW1wIl09Z2V0YXR0cihCTE9DS1NJWkUsIl9fbXVsX18iKShOdW1iZXIoMikpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoIWhhc2F0dHIoZ2V0YXR0cihzZWxmLCJvZmZzZXQiKSwiX19pYWRkX18iKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwib2Zmc2V0IixnZXRhdHRyKGdldGF0dHIoc2VsZiwib2Zmc2V0IiksIl9fYWRkX18iKSgkdGVtcCkpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoc2VsZiwib2Zmc2V0Iik9Z2V0YXR0cihnZXRhdHRyKHNlbGYsIm9mZnNldCIpLCJfX2lhZGRfXyIpKCR0ZW1wKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkcmlnaHQ9aXRlcihnZXRhdHRyKGRpdm1vZCwiX19jYWxsX18iKShnZXRhdHRyKHNlbGYsIm9mZnNldCIpLFJFQ09SRFNJWkUpKTskY291bnRlcj0tMQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE3MTcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgICRjb3VudGVyKysKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJsb2Nrcz0kbG9jYWxzWyJibG9ja3MiXT1uZXh0KCRyaWdodCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtYWluZGVyPSRsb2NhbHNbInJlbWFpbmRlciJdPW5leHQoJHJpZ2h0KTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTIwNCl7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRlcnIxMjA0Ll9fbmFtZV9fPT0iU3RvcEl0ZXJhdGlvbiIpeyRwb3BfZXhjKCk7dGhyb3cgVmFsdWVFcnJvcigibmVlZCBtb3JlIHRoYW4gIiskY291bnRlcisiIHZhbHVlIisoJGNvdW50ZXI+MSA/ICJzIiA6ICIiKSsiIHRvIHVucGFjayIpfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB2YXIgJGV4aGF1c3RlZD10cnVlO3RyeXtuZXh0KCRyaWdodCk7JGV4aGF1c3RlZD1mYWxzZX1jYXRjaChlcnIpe2lmKGVyci5fX25hbWVfXz09IlN0b3BJdGVyYXRpb24iKXskcG9wX2V4YygpfX1pZighJGV4aGF1c3RlZCl7dGhyb3cgVmFsdWVFcnJvcigidG9vIG1hbnkgdmFsdWVzIHRvIHVucGFjayAoZXhwZWN0ZWQgIisoJGNvdW50ZXIrMSkrIikiKX0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzE4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKHJlbWFpbmRlciwiX19ndF9fIikoTnVtYmVyKDApKSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzE5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHNlbGYsImZpbGVvYmoiKSwid3JpdGUiKSwiX19jYWxsX18iKShnZXRhdHRyKE5VTCwiX19tdWxfXyIpKGdldGF0dHIoUkVDT1JEU0laRSwiX19zdWJfXyIpKHJlbWFpbmRlcikpKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE3MjEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woIWJvb2woZ2V0YXR0cihzZWxmLCJfZXh0ZmlsZW9iaiIpKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE3MjIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJmaWxlb2JqIiksImNsb3NlIiksIl9fY2FsbF9fIikoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTcyMywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJjbG9zZWQiLFRydWUpO05vbmU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTIwNCl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjEyMDQpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLmNsb3NlLl9fbmFtZV9fPSJjbG9zZSIKICAgICRjbGFzcy5jbG9zZS5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLmNsb3NlLl9fZG9jX189IkNsb3NlIHRoZSBUYXJGaWxlLiBJbiB3cml0ZS1tb2RlLCB0d28gZmluaXNoaW5nIHplcm8gYmxvY2tzIGFyZVxuXAogICAgICAgICAgIGFwcGVuZGVkIHRvIHRoZSBhcmNoaXZlLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE3MjUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5nZXRtZW1iZXI9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoImdldG1lbWJlciIsYXJndW1lbnRzLFsic2VsZiIsIm5hbWUiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbIjdkbnJoeTAwIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzI2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiUmV0dXJuIGEgVGFySW5mbyBvYmplY3QgZm9yIG1lbWJlciBgbmFtZScuIElmIGBuYW1lJyBjYW4gbm90IGJlXG5cCiAgICAgICAgICAgZm91bmQgaW4gdGhlIGFyY2hpdmUsIEtleUVycm9yIGlzIHJhaXNlZC4gSWYgYSBtZW1iZXIgb2NjdXJzIG1vcmVcblwKICAgICAgICAgICB0aGFuIG9uY2UgaW4gdGhlIGFyY2hpdmUsIGl0cyBsYXN0IG9jY3VycmVuY2UgaXMgYXNzdW1lZCB0byBiZSB0aGVcblwKICAgICAgICAgICBtb3N0IHVwLXRvLWRhdGUgdmVyc2lvbi5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzMxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgdGFyaW5mbz0kbG9jYWxzWyJ0YXJpbmZvIl09Z2V0YXR0cihnZXRhdHRyKHNlbGYsIl9nZXRtZW1iZXIiKSwiX19jYWxsX18iKShuYW1lKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTczMiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbCh0YXJpbmZvPT09Tm9uZSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE3MzMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKEtleUVycm9yLCJfX2NhbGxfXyIpKGdldGF0dHIoImZpbGVuYW1lICVyIG5vdCBmb3VuZCIsIl9fbW9kX18iKShuYW1lKSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE3MzQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiB0YXJpbmZvCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTIwNSl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjEyMDUpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLmdldG1lbWJlci5fX25hbWVfXz0iZ2V0bWVtYmVyIgogICAgJGNsYXNzLmdldG1lbWJlci5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLmdldG1lbWJlci5fX2RvY19fPSJSZXR1cm4gYSBUYXJJbmZvIG9iamVjdCBmb3IgbWVtYmVyIGBuYW1lJy4gSWYgYG5hbWUnIGNhbiBub3QgYmVcblwKICAgICAgICAgICBmb3VuZCBpbiB0aGUgYXJjaGl2ZSwgS2V5RXJyb3IgaXMgcmFpc2VkLiBJZiBhIG1lbWJlciBvY2N1cnMgbW9yZVxuXAogICAgICAgICAgIHRoYW4gb25jZSBpbiB0aGUgYXJjaGl2ZSwgaXRzIGxhc3Qgb2NjdXJyZW5jZSBpcyBhc3N1bWVkIHRvIGJlIHRoZVxuXAogICAgICAgICAgIG1vc3QgdXAtdG8tZGF0ZSB2ZXJzaW9uLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE3MzYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5nZXRtZW1iZXJzPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJnZXRtZW1iZXJzIixhcmd1bWVudHMsWyJzZWxmIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyIxZWdtYWVsNiJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTczNywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIlJldHVybiB0aGUgbWVtYmVycyBvZiB0aGUgYXJjaGl2ZSBhcyBhIGxpc3Qgb2YgVGFySW5mbyBvYmplY3RzLiBUaGVcblwKICAgICAgICAgICBsaXN0IGhhcyB0aGUgc2FtZSBvcmRlciBhcyB0aGUgbWVtYmVycyBpbiB0aGUgYXJjaGl2ZS5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzQwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX2NoZWNrIiksIl9fY2FsbF9fIikoKQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTc0MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbCghYm9vbChnZXRhdHRyKHNlbGYsIl9sb2FkZWQiKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzQyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9sb2FkIiksIl9fY2FsbF9fIikoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTc0NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoc2VsZiwibWVtYmVycyIpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTIwNSl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjEyMDUpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLmdldG1lbWJlcnMuX19uYW1lX189ImdldG1lbWJlcnMiCiAgICAkY2xhc3MuZ2V0bWVtYmVycy5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLmdldG1lbWJlcnMuX19kb2NfXz0iUmV0dXJuIHRoZSBtZW1iZXJzIG9mIHRoZSBhcmNoaXZlIGFzIGEgbGlzdCBvZiBUYXJJbmZvIG9iamVjdHMuIFRoZVxuXAogICAgICAgICAgIGxpc3QgaGFzIHRoZSBzYW1lIG9yZGVyIGFzIHRoZSBtZW1iZXJzIGluIHRoZSBhcmNoaXZlLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE3NDYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5nZXRuYW1lcz0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiZ2V0bmFtZXMiLGFyZ3VtZW50cyxbInNlbGYiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbIjc0eWZ4MjZ0Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzQ3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiUmV0dXJuIHRoZSBtZW1iZXJzIG9mIHRoZSBhcmNoaXZlIGFzIGEgbGlzdCBvZiB0aGVpciBuYW1lcy4gSXQgaGFzXG5cCiAgICAgICAgICAgdGhlIHNhbWUgb3JkZXIgYXMgdGhlIGxpc3QgcmV0dXJuZWQgYnkgZ2V0bWVtYmVycygpLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE3NTAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiAkbGlzdF9jb21wKCRta2RpY3QoJGdsb2JhbHMsJGxvY2FscyksInRhcmluZm8ubmFtZSAiLCJmb3IgdGFyaW5mbyBpbiBzZWxmLmdldG1lbWJlcnMoKSIpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTIwNSl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjEyMDUpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLmdldG5hbWVzLl9fbmFtZV9fPSJnZXRuYW1lcyIKICAgICRjbGFzcy5nZXRuYW1lcy5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLmdldG5hbWVzLl9fZG9jX189IlJldHVybiB0aGUgbWVtYmVycyBvZiB0aGUgYXJjaGl2ZSBhcyBhIGxpc3Qgb2YgdGhlaXIgbmFtZXMuIEl0IGhhc1xuXAogICAgICAgICAgIHRoZSBzYW1lIG9yZGVyIGFzIHRoZSBsaXN0IHJldHVybmVkIGJ5IGdldG1lbWJlcnMoKS5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzUyLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuZ2V0dGFyaW5mbz0gKGZ1bmN0aW9uIChOb25lLE5vbmUsTm9uZSl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJnZXR0YXJpbmZvIixhcmd1bWVudHMsWyJzZWxmIl0seyJuYW1lIjooJGNsYXNzWyJOb25lIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJOb25lIl0gOiBOb25lKSwiYXJjbmFtZSI6KCRjbGFzc1siTm9uZSJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siTm9uZSJdIDogTm9uZSksImZpbGVvYmoiOigkY2xhc3NbIk5vbmUiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIk5vbmUiXSA6IE5vbmUpfSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbInIzZ2hkc285Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzUzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiQ3JlYXRlIGEgVGFySW5mbyBvYmplY3QgZm9yIGVpdGhlciB0aGUgZmlsZSBgbmFtZScgb3IgdGhlIGZpbGVcblwKICAgICAgICAgICBvYmplY3QgYGZpbGVvYmonICh1c2luZyBvcy5mc3RhdCBvbiBpdHMgZmlsZSBkZXNjcmlwdG9yKS4gWW91IGNhblxuXAogICAgICAgICAgIG1vZGlmeSBzb21lIG9mIHRoZSBUYXJJbmZvJ3MgYXR0cmlidXRlcyBiZWZvcmUgeW91IGFkZCBpdCB1c2luZ1xuXAogICAgICAgICAgIGFkZGZpbGUoKS4gSWYgZ2l2ZW4sIGBhcmNuYW1lJyBzcGVjaWZpZXMgYW4gYWx0ZXJuYXRpdmUgbmFtZSBmb3IgdGhlXG5cCiAgICAgICAgICAgZmlsZSBpbiB0aGUgYXJjaGl2ZS5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzU5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX2NoZWNrIiksIl9fY2FsbF9fIikoImF3IikKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE3NjMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZmlsZW9iaiE9PU5vbmUpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzY0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWU9JGxvY2Fsc1sibmFtZSJdPWdldGF0dHIoZmlsZW9iaiwibmFtZSIpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzY5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGFyY25hbWU9PT1Ob25lKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTc3MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBhcmNuYW1lPSRsb2NhbHNbImFyY25hbWUiXT1uYW1lO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkcmlnaHQ9aXRlcihnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihvcywicGF0aCIpLCJzcGxpdGRyaXZlIiksIl9fY2FsbF9fIikoYXJjbmFtZSkpOyRjb3VudGVyPS0xCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzcxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgICAgIHZhciBkcnY9JGxvY2Fsc1siZHJ2Il09bmV4dCgkcmlnaHQpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgICAgIHZhciBhcmNuYW1lPSRsb2NhbHNbImFyY25hbWUiXT1uZXh0KCRyaWdodCk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIxMjA1KXsKICAgICAgICAgICAgICAgICAgICBpZigkZXJyMTIwNS5fX25hbWVfXz09IlN0b3BJdGVyYXRpb24iKXskcG9wX2V4YygpO3Rocm93IFZhbHVlRXJyb3IoIm5lZWQgbW9yZSB0aGFuICIrJGNvdW50ZXIrIiB2YWx1ZSIrKCRjb3VudGVyPjEgPyAicyIgOiAiIikrIiB0byB1bnBhY2siKX0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciAkZXhoYXVzdGVkPXRydWU7dHJ5e25leHQoJHJpZ2h0KTskZXhoYXVzdGVkPWZhbHNlfWNhdGNoKGVycil7aWYoZXJyLl9fbmFtZV9fPT0iU3RvcEl0ZXJhdGlvbiIpeyRwb3BfZXhjKCl9fWlmKCEkZXhoYXVzdGVkKXt0aHJvdyBWYWx1ZUVycm9yKCJ0b28gbWFueSB2YWx1ZXMgdG8gdW5wYWNrIChleHBlY3RlZCAiKygkY291bnRlcisxKSsiKSIpfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTc3MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIGFyY25hbWU9JGxvY2Fsc1siYXJjbmFtZSJdPWdldGF0dHIoZ2V0YXR0cihhcmNuYW1lLCJyZXBsYWNlIiksIl9fY2FsbF9fIikoZ2V0YXR0cihvcywic2VwIiksIi8iKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTc3MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIGFyY25hbWU9JGxvY2Fsc1siYXJjbmFtZSJdPWdldGF0dHIoZ2V0YXR0cihhcmNuYW1lLCJsc3RyaXAiKSwiX19jYWxsX18iKSgiLyIpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzc3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgdGFyaW5mbz0kbG9jYWxzWyJ0YXJpbmZvIl09Z2V0YXR0cihnZXRhdHRyKHNlbGYsInRhcmluZm8iKSwiX19jYWxsX18iKSgpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzc4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHRhcmluZm8sInRhcmZpbGUiLHNlbGYpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzgyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGZpbGVvYmo9PT1Ob25lKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTc4MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKGdldGF0dHIoaGFzYXR0ciwiX19jYWxsX18iKShvcywibHN0YXQiKSkmJiR0ZXN0X2l0ZW0oIWJvb2woZ2V0YXR0cihzZWxmLCJkZXJlZmVyZW5jZSIpKSkpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE3ODQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXRyZXM9JGxvY2Fsc1sic3RhdHJlcyJdPWdldGF0dHIoZ2V0YXR0cihvcywibHN0YXQiKSwiX19jYWxsX18iKShuYW1lKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzg2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGF0cmVzPSRsb2NhbHNbInN0YXRyZXMiXT1nZXRhdHRyKGdldGF0dHIob3MsInN0YXQiKSwiX19jYWxsX18iKShuYW1lKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTc4OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBzdGF0cmVzPSRsb2NhbHNbInN0YXRyZXMiXT1nZXRhdHRyKGdldGF0dHIob3MsImZzdGF0IiksIl9fY2FsbF9fIikoZ2V0YXR0cihnZXRhdHRyKGZpbGVvYmosImZpbGVubyIpLCJfX2NhbGxfXyIpKCkpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzg5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgbGlua25hbWU9JGxvY2Fsc1sibGlua25hbWUiXT0iIjtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTc5MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIHN0bWQ9JGxvY2Fsc1sic3RtZCJdPWdldGF0dHIoc3RhdHJlcywic3RfbW9kZSIpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzkyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cihzdGF0LCJTX0lTUkVHIiksIl9fY2FsbF9fIikoc3RtZCkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxNzkzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlub2RlPSRsb2NhbHNbImlub2RlIl09dHVwbGUoW2dldGF0dHIoc3RhdHJlcywic3RfaW5vIiksZ2V0YXR0cihzdGF0cmVzLCJzdF9kZXYiKV0pO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTc5NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKCR0ZXN0X2V4cHIoJHRlc3RfaXRlbSgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oIWJvb2woZ2V0YXR0cihzZWxmLCJkZXJlZmVyZW5jZSIpKSkmJiR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKHN0YXRyZXMsInN0X25saW5rIiksIl9fZ3RfXyIpKE51bWJlcigxKSkpKSkmJiR0ZXN0X2l0ZW0oZ2V0YXR0cihpbm9kZSwiX19pbl9fIikoZ2V0YXR0cihzZWxmLCJpbm9kZXMiKSkpKSkmJiR0ZXN0X2l0ZW0oZ2V0YXR0cihhcmNuYW1lLCJfX25lX18iKShnZXRhdHRyKGdldGF0dHIoc2VsZiwiaW5vZGVzIiksIl9fZ2V0aXRlbV9fIikoaW5vZGUpKSkpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE3OTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGU9JGxvY2Fsc1sidHlwZSJdPUxOS1RZUEU7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTc5OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGlua25hbWU9JGxvY2Fsc1sibGlua25hbWUiXT1nZXRhdHRyKGdldGF0dHIoc2VsZiwiaW5vZGVzIiksIl9fZ2V0aXRlbV9fIikoaW5vZGUpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4MDMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGU9JGxvY2Fsc1sidHlwZSJdPVJFR1RZUEU7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTgwNCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoaW5vZGUsIl9fZ2V0aXRlbV9fIikoTnVtYmVyKDApKSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTgwNSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsImlub2RlcyIpLCJfX3NldGl0ZW1fXyIpKGlub2RlLGFyY25hbWUpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKHN0YXQsIlNfSVNESVIiKSwiX19jYWxsX18iKShzdG1kKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4MDcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgdHlwZT0kbG9jYWxzWyJ0eXBlIl09RElSVFlQRTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihib29sKGdldGF0dHIoZ2V0YXR0cihzdGF0LCJTX0lTRklGTyIpLCJfX2NhbGxfXyIpKHN0bWQpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTgwOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciB0eXBlPSRsb2NhbHNbInR5cGUiXT1GSUZPVFlQRTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihib29sKGdldGF0dHIoZ2V0YXR0cihzdGF0LCJTX0lTTE5LIiksIl9fY2FsbF9fIikoc3RtZCkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODExLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGU9JGxvY2Fsc1sidHlwZSJdPVNZTVRZUEU7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODEyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmtuYW1lPSRsb2NhbHNbImxpbmtuYW1lIl09Z2V0YXR0cihnZXRhdHRyKG9zLCJyZWFkbGluayIpLCJfX2NhbGxfXyIpKG5hbWUpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKHN0YXQsIlNfSVNDSFIiKSwiX19jYWxsX18iKShzdG1kKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4MTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgdHlwZT0kbG9jYWxzWyJ0eXBlIl09Q0hSVFlQRTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihib29sKGdldGF0dHIoZ2V0YXR0cihzdGF0LCJTX0lTQkxLIiksIl9fY2FsbF9fIikoc3RtZCkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODE2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGU9JGxvY2Fsc1sidHlwZSJdPUJMS1RZUEU7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTgxOCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODIyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHRhcmluZm8sIm5hbWUiLGFyY25hbWUpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODIzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHRhcmluZm8sIm1vZGUiLHN0bWQpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODI0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBzZXRhdHRyKHRhcmluZm8sInVpZCIsZ2V0YXR0cihzdGF0cmVzLCJzdF91aWQiKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4MjUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIodGFyaW5mbywiZ2lkIixnZXRhdHRyKHN0YXRyZXMsInN0X2dpZCIpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTgyNiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKHR5cGUsIl9fZXFfXyIpKFJFR1RZUEUpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTgyNywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHNldGF0dHIodGFyaW5mbywic2l6ZSIsZ2V0YXR0cihzdGF0cmVzLCJzdF9zaXplIikpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4MjksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHRhcmluZm8sInNpemUiLE51bWJlcigwKSk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4MzAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIodGFyaW5mbywibXRpbWUiLGdldGF0dHIoc3RhdHJlcywic3RfbXRpbWUiKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4MzEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIodGFyaW5mbywidHlwZSIsdHlwZSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4MzIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIodGFyaW5mbywibGlua25hbWUiLGxpbmtuYW1lKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTgzMywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChwd2QpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODM0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgJGZhaWxlZDEyMDY9ZmFsc2U7dHJ5ewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODM1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldGF0dHIodGFyaW5mbywidW5hbWUiLGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHB3ZCwiZ2V0cHd1aWQiKSwiX19jYWxsX18iKShnZXRhdHRyKHRhcmluZm8sInVpZCIpKSwiX19nZXRpdGVtX18iKShOdW1iZXIoMCkpKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTIwNil7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZmFpbGVkMTIwNj10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKCRpc19leGMoJGVycjEyMDYsW0tleUVycm9yXSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTgzNywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCgwKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7dGhyb3cgJGVycjEyMDZ9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTgzOCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChncnApKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODM5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgJGZhaWxlZDEyMDc9ZmFsc2U7dHJ5ewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODQwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldGF0dHIodGFyaW5mbywiZ25hbWUiLGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKGdycCwiZ2V0Z3JnaWQiKSwiX19jYWxsX18iKShnZXRhdHRyKHRhcmluZm8sImdpZCIpKSwiX19nZXRpdGVtX18iKShOdW1iZXIoMCkpKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTIwNyl7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZmFpbGVkMTIwNz10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKCRpc19leGMoJGVycjEyMDcsW0tleUVycm9yXSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTg0MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCgwKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7dGhyb3cgJGVycjEyMDd9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTg0NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKHR5cGUsIl9faW5fXyIpKHR1cGxlKFtDSFJUWVBFLEJMS1RZUEVdKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODQ1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oZ2V0YXR0cihoYXNhdHRyLCJfX2NhbGxfXyIpKG9zLCJtYWpvciIpKSYmJHRlc3RfaXRlbShnZXRhdHRyKGhhc2F0dHIsIl9fY2FsbF9fIikob3MsIm1pbm9yIikpKSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODQ2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldGF0dHIodGFyaW5mbywiZGV2bWFqb3IiLGdldGF0dHIoZ2V0YXR0cihvcywibWFqb3IiKSwiX19jYWxsX18iKShnZXRhdHRyKHN0YXRyZXMsInN0X3JkZXYiKSkpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4NDcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0YXR0cih0YXJpbmZvLCJkZXZtaW5vciIsZ2V0YXR0cihnZXRhdHRyKG9zLCJtaW5vciIpLCJfX2NhbGxfXyIpKGdldGF0dHIoc3RhdHJlcywic3RfcmRldiIpKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODQ4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gdGFyaW5mbwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjEyMDUpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMjA1KX0KICAgICAgICB9CiAgICB9CiAgICApKCRjbGFzcy5Ob25lICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5Ob25lIDogTm9uZSwkY2xhc3MuTm9uZSAhPSB1bmRlZmluZWQgPyAkY2xhc3MuTm9uZSA6IE5vbmUsJGNsYXNzLk5vbmUgIT0gdW5kZWZpbmVkID8gJGNsYXNzLk5vbmUgOiBOb25lKQogICAgJGNsYXNzLmdldHRhcmluZm8uX19uYW1lX189ImdldHRhcmluZm8iCiAgICAkY2xhc3MuZ2V0dGFyaW5mby5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLmdldHRhcmluZm8uX19kb2NfXz0iQ3JlYXRlIGEgVGFySW5mbyBvYmplY3QgZm9yIGVpdGhlciB0aGUgZmlsZSBgbmFtZScgb3IgdGhlIGZpbGVcblwKICAgICAgICAgICBvYmplY3QgYGZpbGVvYmonICh1c2luZyBvcy5mc3RhdCBvbiBpdHMgZmlsZSBkZXNjcmlwdG9yKS4gWW91IGNhblxuXAogICAgICAgICAgIG1vZGlmeSBzb21lIG9mIHRoZSBUYXJJbmZvJ3MgYXR0cmlidXRlcyBiZWZvcmUgeW91IGFkZCBpdCB1c2luZ1xuXAogICAgICAgICAgIGFkZGZpbGUoKS4gSWYgZ2l2ZW4sIGBhcmNuYW1lJyBzcGVjaWZpZXMgYW4gYWx0ZXJuYXRpdmUgbmFtZSBmb3IgdGhlXG5cCiAgICAgICAgICAgZmlsZSBpbiB0aGUgYXJjaGl2ZS5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODUwLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MubGlzdD0gKGZ1bmN0aW9uIChUcnVlKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoImxpc3QiLGFyZ3VtZW50cyxbInNlbGYiXSx7InZlcmJvc2UiOigkY2xhc3NbIlRydWUiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIlRydWUiXSA6IFRydWUpfSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImxmazViZzlpIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODUxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiUHJpbnQgYSB0YWJsZSBvZiBjb250ZW50cyB0byBzeXMuc3Rkb3V0LiBJZiBgdmVyYm9zZScgaXMgRmFsc2UsIG9ubHlcblwKICAgICAgICAgICB0aGUgbmFtZXMgb2YgdGhlIG1lbWJlcnMgYXJlIHByaW50ZWQuIElmIGl0IGlzIFRydWUsIGFuIGBscyAtbCctbGlrZVxuXAogICAgICAgICAgIG91dHB1dCBpcyBwcm9kdWNlZC5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODU1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX2NoZWNrIiksIl9fY2FsbF9fIikoKQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTg1NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyICRuZXh0MTIwOD1nZXRhdHRyKGl0ZXIoc2VsZiksIl9fbmV4dF9fIikKICAgICAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMjA4PXRydWU7d2hpbGUodHJ1ZSl7CiAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyaW5mbz0kbG9jYWxzWyJ0YXJpbmZvIl09JG5leHQxMjA4KCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycil7aWYoJGlzX2V4YygkZXJyLFtTdG9wSXRlcmF0aW9uXSkpeyRwb3BfZXhjKCk7YnJlYWt9ZWxzZXt0aHJvdygkZXJyKX19CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTg1OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKGJvb2wodmVyYm9zZSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODU5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoJHByaW50LCJfX2NhbGxfXyIpKGdldGF0dHIoZ2V0YXR0cihzdGF0LCJmaWxlbW9kZSIpLCJfX2NhbGxfXyIpKGdldGF0dHIodGFyaW5mbywibW9kZSIpKSwkS3coImVuZCIsJyAnKSkKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTg2MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKCRwcmludCwiX19jYWxsX18iKShnZXRhdHRyKCIlcy8lcyIsIl9fbW9kX18iKSh0dXBsZShbJHRlc3RfZXhwcigkdGVzdF9pdGVtKGdldGF0dHIodGFyaW5mbywidW5hbWUiKSl8fCR0ZXN0X2l0ZW0oZ2V0YXR0cih0YXJpbmZvLCJ1aWQiKSkpLCR0ZXN0X2V4cHIoJHRlc3RfaXRlbShnZXRhdHRyKHRhcmluZm8sImduYW1lIikpfHwkdGVzdF9pdGVtKGdldGF0dHIodGFyaW5mbywiZ2lkIikpKV0pKSwkS3coImVuZCIsJyAnKSkKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTg2MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBpZihib29sKCR0ZXN0X2V4cHIoJHRlc3RfaXRlbShnZXRhdHRyKGdldGF0dHIodGFyaW5mbywiaXNjaHIiKSwiX19jYWxsX18iKSgpKXx8JHRlc3RfaXRlbShnZXRhdHRyKGdldGF0dHIodGFyaW5mbywiaXNibGsiKSwiX19jYWxsX18iKSgpKSkpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4NjMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoJHByaW50LCJfX2NhbGxfXyIpKGdldGF0dHIoIiUxMHMiLCJfX21vZF9fIikoZ2V0YXR0cigiJWQsJWQiLCJfX21vZF9fIikodHVwbGUoW2dldGF0dHIodGFyaW5mbywiZGV2bWFqb3IiKSxnZXRhdHRyKHRhcmluZm8sImRldm1pbm9yIildKSkpLCRLdygiZW5kIiwnICcpKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODY2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKCRwcmludCwiX19jYWxsX18iKShnZXRhdHRyKCIlMTBkIiwiX19tb2RfXyIpKGdldGF0dHIodGFyaW5mbywic2l6ZSIpKSwkS3coImVuZCIsJyAnKSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODY3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoJHByaW50LCJfX2NhbGxfXyIpKGdldGF0dHIoIiVkLSUwMmQtJTAyZCAlMDJkOiUwMmQ6JTAyZCIsIl9fbW9kX18iKShnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cih0aW1lLCJsb2NhbHRpbWUiKSwiX19jYWxsX18iKShnZXRhdHRyKHRhcmluZm8sIm10aW1lIikpLCJfX2dldGl0ZW1fXyIpKHNsaWNlKG51bGwsTnVtYmVyKDYpKSkpLCRLdygiZW5kIiwnICcpKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODcwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cigkcHJpbnQsIl9fY2FsbF9fIikoZ2V0YXR0cihnZXRhdHRyKHRhcmluZm8sIm5hbWUiKSwiX19hZGRfXyIpKCR0ZXJuYXJ5KHsidGFyaW5mbyI6dGFyaW5mb30sImdldGF0dHIoZ2V0YXR0cih0YXJpbmZvLFwiaXNkaXJcIiksXCJfX2NhbGxfX1wiKSgpIiwiJTIyLyUyMiIsIiUyMiUyMiIpKSwkS3coImVuZCIsJyAnKSkKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODcyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbCh2ZXJib3NlKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4NzMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIodGFyaW5mbywiaXNzeW0iKSwiX19jYWxsX18iKSgpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODc0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKCRwcmludCwiX19jYWxsX18iKSgiLT4iLGdldGF0dHIodGFyaW5mbywibGlua25hbWUiKSwkS3coImVuZCIsJyAnKSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODc1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKHRhcmluZm8sImlzbG5rIiksIl9fY2FsbF9fIikoKSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTg3NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cigkcHJpbnQsIl9fY2FsbF9fIikoImxpbmsgdG8iLGdldGF0dHIodGFyaW5mbywibGlua25hbWUiKSwkS3coImVuZCIsJyAnKSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxODc3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cigkcHJpbnQsIl9fY2FsbF9fIikoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjEyMDgpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMjA4KX0KICAgICAgICB9CiAgICB9CiAgICApKCRjbGFzcy5UcnVlICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5UcnVlIDogVHJ1ZSkKICAgICRjbGFzcy5saXN0Ll9fbmFtZV9fPSJsaXN0IgogICAgJGNsYXNzLmxpc3QuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5saXN0Ll9fZG9jX189IlByaW50IGEgdGFibGUgb2YgY29udGVudHMgdG8gc3lzLnN0ZG91dC4gSWYgYHZlcmJvc2UnIGlzIEZhbHNlLCBvbmx5XG5cCiAgICAgICAgICAgdGhlIG5hbWVzIG9mIHRoZSBtZW1iZXJzIGFyZSBwcmludGVkLiBJZiBpdCBpcyBUcnVlLCBhbiBgbHMgLWwnLWxpa2VcblwKICAgICAgICAgICBvdXRwdXQgaXMgcHJvZHVjZWQuXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTg3OSwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLmFkZD0gKGZ1bmN0aW9uIChOb25lLFRydWUsTm9uZSxOb25lKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoImFkZCIsYXJndW1lbnRzLFsic2VsZiIsIm5hbWUiXSx7ImFyY25hbWUiOigkY2xhc3NbIk5vbmUiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIk5vbmUiXSA6IE5vbmUpLCJyZWN1cnNpdmUiOigkY2xhc3NbIlRydWUiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIlRydWUiXSA6IFRydWUpLCJleGNsdWRlIjooJGNsYXNzWyJOb25lIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJOb25lIl0gOiBOb25lKSwiZmlsdGVyIjooJGNsYXNzWyJOb25lIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJOb25lIl0gOiBOb25lKX0sIiRkdW1teSIsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiaGJseHJ1Z2QiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4ODAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJBZGQgdGhlIGZpbGUgYG5hbWUnIHRvIHRoZSBhcmNoaXZlLiBgbmFtZScgbWF5IGJlIGFueSB0eXBlIG9mIGZpbGVcblwKICAgICAgICAgICAoZGlyZWN0b3J5LCBmaWZvLCBzeW1ib2xpYyBsaW5rLCBldGMuKS4gSWYgZ2l2ZW4sIGBhcmNuYW1lJ1xuXAogICAgICAgICAgIHNwZWNpZmllcyBhbiBhbHRlcm5hdGl2ZSBuYW1lIGZvciB0aGUgZmlsZSBpbiB0aGUgYXJjaGl2ZS5cblwKICAgICAgICAgICBEaXJlY3RvcmllcyBhcmUgYWRkZWQgcmVjdXJzaXZlbHkgYnkgZGVmYXVsdC4gVGhpcyBjYW4gYmUgYXZvaWRlZCBieVxuXAogICAgICAgICAgIHNldHRpbmcgYHJlY3Vyc2l2ZScgdG8gRmFsc2UuIGBleGNsdWRlJyBpcyBhIGZ1bmN0aW9uIHRoYXQgc2hvdWxkXG5cCiAgICAgICAgICAgcmV0dXJuIFRydWUgZm9yIGVhY2ggZmlsZW5hbWUgdG8gYmUgZXhjbHVkZWQuIGBmaWx0ZXInIGlzIGEgZnVuY3Rpb25cblwKICAgICAgICAgICB0aGF0IGV4cGVjdHMgYSBUYXJJbmZvIG9iamVjdCBhcmd1bWVudCBhbmQgcmV0dXJucyB0aGUgY2hhbmdlZFxuXAogICAgICAgICAgIFRhckluZm8gb2JqZWN0LCBpZiBpdCByZXR1cm5zIE5vbmUgdGhlIFRhckluZm8gb2JqZWN0IHdpbGwgYmVcblwKICAgICAgICAgICBleGNsdWRlZCBmcm9tIHRoZSBhcmNoaXZlLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4OTAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfY2hlY2siKSwiX19jYWxsX18iKSgiYXciKQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTg5MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChhcmNuYW1lPT09Tm9uZSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4OTMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJjbmFtZT0kbG9jYWxzWyJhcmNuYW1lIl09bmFtZTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTg5NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChleGNsdWRlIT09Tm9uZSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4OTcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAkaW1wb3J0X2xpc3QoWyJ3YXJuaW5ncyJdKTt2YXIgd2FybmluZ3M9JGxvY2Fsc1sid2FybmluZ3MiXT1fX0JSWVRIT05fXy5pbXBvcnRlZFsid2FybmluZ3MiXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE4OTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIod2FybmluZ3MsIndhcm4iKSwiX19jYWxsX18iKSgidXNlIHRoZSBmaWx0ZXIgYXJndW1lbnQgaW5zdGVhZCIsRGVwcmVjYXRpb25XYXJuaW5nLE51bWJlcigyKSkKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTAwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGV4Y2x1ZGUsIl9fY2FsbF9fIikobmFtZSkpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTkwMSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX2RiZyIpLCJfX2NhbGxfXyIpKE51bWJlcigyKSxnZXRhdHRyKCJ0YXJmaWxlOiBFeGNsdWRlZCAlciIsIl9fbW9kX18iKShuYW1lKSkKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTkwMiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTkwNSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oZ2V0YXR0cihzZWxmLCJuYW1lIikhPT1Ob25lKSYmJHRlc3RfaXRlbShnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKG9zLCJwYXRoIiksImFic3BhdGgiKSwiX19jYWxsX18iKShuYW1lKSwiX19lcV9fIikoZ2V0YXR0cihzZWxmLCJuYW1lIikpKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTA2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9kYmciKSwiX19jYWxsX18iKShOdW1iZXIoMiksZ2V0YXR0cigidGFyZmlsZTogU2tpcHBlZCAlciIsIl9fbW9kX18iKShuYW1lKSkKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTA3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTkwOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9kYmciKSwiX19jYWxsX18iKShOdW1iZXIoMSksbmFtZSkKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5MTIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciB0YXJpbmZvPSRsb2NhbHNbInRhcmluZm8iXT1nZXRhdHRyKGdldGF0dHIoc2VsZiwiZ2V0dGFyaW5mbyIpLCJfX2NhbGxfXyIpKG5hbWUsYXJjbmFtZSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5MTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2wodGFyaW5mbz09PU5vbmUpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTE1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9kYmciKSwiX19jYWxsX18iKShOdW1iZXIoMSksZ2V0YXR0cigidGFyZmlsZTogVW5zdXBwb3J0ZWQgdHlwZSAlciIsIl9fbW9kX18iKShuYW1lKSkKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTE2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTkxOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChmaWx0ZXIhPT1Ob25lKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTkyMCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciB0YXJpbmZvPSRsb2NhbHNbInRhcmluZm8iXT1nZXRhdHRyKGZpbHRlciwiX19jYWxsX18iKSh0YXJpbmZvKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5MjEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZihib29sKHRhcmluZm89PT1Ob25lKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5MjIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9kYmciKSwiX19jYWxsX18iKShOdW1iZXIoMiksZ2V0YXR0cigidGFyZmlsZTogRXhjbHVkZWQgJXIiLCJfX21vZF9fIikobmFtZSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5MjMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5MjYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKHRhcmluZm8sImlzcmVnIiksIl9fY2FsbF9fIikoKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5MjcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgZj0kbG9jYWxzWyJmIl09Z2V0YXR0cihibHRuX29wZW4sIl9fY2FsbF9fIikobmFtZSwicmIiKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5MjgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiYWRkZmlsZSIpLCJfX2NhbGxfXyIpKHRhcmluZm8sZikKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTI5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGYsImNsb3NlIiksIl9fY2FsbF9fIikoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihib29sKGdldGF0dHIoZ2V0YXR0cih0YXJpbmZvLCJpc2RpciIpLCJfX2NhbGxfXyIpKCkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTMyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsImFkZGZpbGUiKSwiX19jYWxsX18iKSh0YXJpbmZvKQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5MzMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZihib29sKHJlY3Vyc2l2ZSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTM0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkbmV4dDEyMDk9Z2V0YXR0cihpdGVyKGdldGF0dHIoZ2V0YXR0cihvcywibGlzdGRpciIpLCJfX2NhbGxfXyIpKG5hbWUpKSwiX19uZXh0X18iKQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTIwOT10cnVlO3doaWxlKHRydWUpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmPSRsb2NhbHNbImYiXT0kbmV4dDEyMDkoKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycil7aWYoJGlzX2V4YygkZXJyLFtTdG9wSXRlcmF0aW9uXSkpeyRwb3BfZXhjKCk7YnJlYWt9ZWxzZXt0aHJvdygkZXJyKX19CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTM1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiYWRkIiksIl9fY2FsbF9fIikoZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIob3MsInBhdGgiKSwiam9pbiIpLCJfX2NhbGxfXyIpKG5hbWUsZiksZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIob3MsInBhdGgiKSwiam9pbiIpLCJfX2NhbGxfXyIpKGFyY25hbWUsZikscmVjdXJzaXZlLGV4Y2x1ZGUsJEt3KCJmaWx0ZXIiLGZpbHRlcikpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5MzksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiYWRkZmlsZSIpLCJfX2NhbGxfXyIpKHRhcmluZm8pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTIwOSl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjEyMDkpfQogICAgICAgIH0KICAgIH0KICAgICkoJGNsYXNzLk5vbmUgIT0gdW5kZWZpbmVkID8gJGNsYXNzLk5vbmUgOiBOb25lLCRjbGFzcy5UcnVlICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5UcnVlIDogVHJ1ZSwkY2xhc3MuTm9uZSAhPSB1bmRlZmluZWQgPyAkY2xhc3MuTm9uZSA6IE5vbmUsJGNsYXNzLk5vbmUgIT0gdW5kZWZpbmVkID8gJGNsYXNzLk5vbmUgOiBOb25lKQogICAgJGNsYXNzLmFkZC5fX25hbWVfXz0iYWRkIgogICAgJGNsYXNzLmFkZC5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLmFkZC5fX2RvY19fPSJBZGQgdGhlIGZpbGUgYG5hbWUnIHRvIHRoZSBhcmNoaXZlLiBgbmFtZScgbWF5IGJlIGFueSB0eXBlIG9mIGZpbGVcblwKICAgICAgICAgICAoZGlyZWN0b3J5LCBmaWZvLCBzeW1ib2xpYyBsaW5rLCBldGMuKS4gSWYgZ2l2ZW4sIGBhcmNuYW1lJ1xuXAogICAgICAgICAgIHNwZWNpZmllcyBhbiBhbHRlcm5hdGl2ZSBuYW1lIGZvciB0aGUgZmlsZSBpbiB0aGUgYXJjaGl2ZS5cblwKICAgICAgICAgICBEaXJlY3RvcmllcyBhcmUgYWRkZWQgcmVjdXJzaXZlbHkgYnkgZGVmYXVsdC4gVGhpcyBjYW4gYmUgYXZvaWRlZCBieVxuXAogICAgICAgICAgIHNldHRpbmcgYHJlY3Vyc2l2ZScgdG8gRmFsc2UuIGBleGNsdWRlJyBpcyBhIGZ1bmN0aW9uIHRoYXQgc2hvdWxkXG5cCiAgICAgICAgICAgcmV0dXJuIFRydWUgZm9yIGVhY2ggZmlsZW5hbWUgdG8gYmUgZXhjbHVkZWQuIGBmaWx0ZXInIGlzIGEgZnVuY3Rpb25cblwKICAgICAgICAgICB0aGF0IGV4cGVjdHMgYSBUYXJJbmZvIG9iamVjdCBhcmd1bWVudCBhbmQgcmV0dXJucyB0aGUgY2hhbmdlZFxuXAogICAgICAgICAgIFRhckluZm8gb2JqZWN0LCBpZiBpdCByZXR1cm5zIE5vbmUgdGhlIFRhckluZm8gb2JqZWN0IHdpbGwgYmVcblwKICAgICAgICAgICBleGNsdWRlZCBmcm9tIHRoZSBhcmNoaXZlLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5NDEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5hZGRmaWxlPSAoZnVuY3Rpb24gKE5vbmUpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiYWRkZmlsZSIsYXJndW1lbnRzLFsic2VsZiIsInRhcmluZm8iXSx7ImZpbGVvYmoiOigkY2xhc3NbIk5vbmUiXSAhPT11bmRlZmluZWQgPyAkY2xhc3NbIk5vbmUiXSA6IE5vbmUpfSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImZoamNlcWQ4Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTQyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiQWRkIHRoZSBUYXJJbmZvIG9iamVjdCBgdGFyaW5mbycgdG8gdGhlIGFyY2hpdmUuIElmIGBmaWxlb2JqJyBpc1xuXAogICAgICAgICAgIGdpdmVuLCB0YXJpbmZvLnNpemUgYnl0ZXMgYXJlIHJlYWQgZnJvbSBpdCBhbmQgYWRkZWQgdG8gdGhlIGFyY2hpdmUuXG5cCiAgICAgICAgICAgWW91IGNhbiBjcmVhdGUgVGFySW5mbyBvYmplY3RzIHVzaW5nIGdldHRhcmluZm8oKS5cblwKICAgICAgICAgICBPbiBXaW5kb3dzIHBsYXRmb3JtcywgYGZpbGVvYmonIHNob3VsZCBhbHdheXMgYmUgb3BlbmVkIHdpdGggbW9kZVxuXAogICAgICAgICAgICdyYicgdG8gYXZvaWQgaXJyaXRhdGlvbiBhYm91dCB0aGUgZmlsZSBzaXplLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5NDgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfY2hlY2siKSwiX19jYWxsX18iKSgiYXciKQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTk1MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIHRhcmluZm89JGxvY2Fsc1sidGFyaW5mbyJdPWdldGF0dHIoZ2V0YXR0cihjb3B5LCJjb3B5IiksIl9fY2FsbF9fIikodGFyaW5mbyk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5NTIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBidWY9JGxvY2Fsc1siYnVmIl09Z2V0YXR0cihnZXRhdHRyKHRhcmluZm8sInRvYnVmIiksIl9fY2FsbF9fIikoZ2V0YXR0cihzZWxmLCJmb3JtYXQiKSxnZXRhdHRyKHNlbGYsImVuY29kaW5nIiksZ2V0YXR0cihzZWxmLCJlcnJvcnMiKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5NTMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHNlbGYsImZpbGVvYmoiKSwid3JpdGUiKSwiX19jYWxsX18iKShidWYpCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTU0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgJHRlbXA9JGxvY2Fsc1siJHRlbXAiXT1nZXRhdHRyKGxlbiwiX19jYWxsX18iKShidWYpO05vbmU7CiAgICAgICAgICAgICAgICBpZighaGFzYXR0cihnZXRhdHRyKHNlbGYsIm9mZnNldCIpLCJfX2lhZGRfXyIpKXsKICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsIm9mZnNldCIsZ2V0YXR0cihnZXRhdHRyKHNlbGYsIm9mZnNldCIpLCJfX2FkZF9fIikoJHRlbXApKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKHNlbGYsIm9mZnNldCIpPWdldGF0dHIoZ2V0YXR0cihzZWxmLCJvZmZzZXQiKSwiX19pYWRkX18iKSgkdGVtcCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5NTcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZmlsZW9iaiE9PU5vbmUpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTU4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihjb3B5ZmlsZW9iaiwiX19jYWxsX18iKShmaWxlb2JqLGdldGF0dHIoc2VsZiwiZmlsZW9iaiIpLGdldGF0dHIodGFyaW5mbywic2l6ZSIpKQogICAgICAgICAgICAgICAgICAgICRyaWdodD1pdGVyKGdldGF0dHIoZGl2bW9kLCJfX2NhbGxfXyIpKGdldGF0dHIodGFyaW5mbywic2l6ZSIpLEJMT0NLU0laRSkpOyRjb3VudGVyPS0xCiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTk1OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgJGNvdW50ZXIrKwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmxvY2tzPSRsb2NhbHNbImJsb2NrcyJdPW5leHQoJHJpZ2h0KTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAkY291bnRlcisrCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1haW5kZXI9JGxvY2Fsc1sicmVtYWluZGVyIl09bmV4dCgkcmlnaHQpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIxMjEwKXsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoJGVycjEyMTAuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKTt0aHJvdyBWYWx1ZUVycm9yKCJuZWVkIG1vcmUgdGhhbiAiKyRjb3VudGVyKyIgdmFsdWUiKygkY291bnRlcj4xID8gInMiIDogIiIpKyIgdG8gdW5wYWNrIil9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHZhciAkZXhoYXVzdGVkPXRydWU7dHJ5e25leHQoJHJpZ2h0KTskZXhoYXVzdGVkPWZhbHNlfWNhdGNoKGVycil7aWYoZXJyLl9fbmFtZV9fPT0iU3RvcEl0ZXJhdGlvbiIpeyRwb3BfZXhjKCl9fWlmKCEkZXhoYXVzdGVkKXt0aHJvdyBWYWx1ZUVycm9yKCJ0b28gbWFueSB2YWx1ZXMgdG8gdW5wYWNrIChleHBlY3RlZCAiKygkY291bnRlcisxKSsiKSIpfQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5NjAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIocmVtYWluZGVyLCJfX2d0X18iKShOdW1iZXIoMCkpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5NjEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwiZmlsZW9iaiIpLCJ3cml0ZSIpLCJfX2NhbGxfXyIpKGdldGF0dHIoTlVMLCJfX211bF9fIikoZ2V0YXR0cihCTE9DS1NJWkUsIl9fc3ViX18iKShyZW1haW5kZXIpKSkKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTk2MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgJHRlbXA9JGxvY2Fsc1siJHRlbXAiXT1OdW1iZXIoMSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoJHRlbXAuJGZhc3RfYXVnbSAmJiBibG9ja3MuJGZhc3RfYXVnbSl7YmxvY2tzKz0kdGVtcDskbG9jYWxzWyJibG9ja3MiXT1ibG9ja3N9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoIWhhc2F0dHIoYmxvY2tzLCJfX2lhZGRfXyIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBibG9ja3M9JGxvY2Fsc1siYmxvY2tzIl09Z2V0YXR0cihibG9ja3MsIl9fYWRkX18iKSgkdGVtcCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tzPSRsb2NhbHNbImJsb2NrcyJdPWdldGF0dHIoYmxvY2tzLCJfX2lhZGRfXyIpKCR0ZW1wKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5NjMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgJHRlbXA9JGxvY2Fsc1siJHRlbXAiXT1nZXRhdHRyKGJsb2NrcywiX19tdWxfXyIpKEJMT0NLU0laRSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZighaGFzYXR0cihnZXRhdHRyKHNlbGYsIm9mZnNldCIpLCJfX2lhZGRfXyIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJvZmZzZXQiLGdldGF0dHIoZ2V0YXR0cihzZWxmLCJvZmZzZXQiKSwiX19hZGRfXyIpKCR0ZW1wKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihzZWxmLCJvZmZzZXQiKT1nZXRhdHRyKGdldGF0dHIoc2VsZiwib2Zmc2V0IiksIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTk2NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwibWVtYmVycyIpLCJhcHBlbmQiKSwiX19jYWxsX18iKSh0YXJpbmZvKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjEyMTApe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMjEwKX0KICAgICAgICB9CiAgICB9CiAgICApKCRjbGFzcy5Ob25lICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5Ob25lIDogTm9uZSkKICAgICRjbGFzcy5hZGRmaWxlLl9fbmFtZV9fPSJhZGRmaWxlIgogICAgJGNsYXNzLmFkZGZpbGUuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5hZGRmaWxlLl9fZG9jX189IkFkZCB0aGUgVGFySW5mbyBvYmplY3QgYHRhcmluZm8nIHRvIHRoZSBhcmNoaXZlLiBJZiBgZmlsZW9iaicgaXNcblwKICAgICAgICAgICBnaXZlbiwgdGFyaW5mby5zaXplIGJ5dGVzIGFyZSByZWFkIGZyb20gaXQgYW5kIGFkZGVkIHRvIHRoZSBhcmNoaXZlLlxuXAogICAgICAgICAgIFlvdSBjYW4gY3JlYXRlIFRhckluZm8gb2JqZWN0cyB1c2luZyBnZXR0YXJpbmZvKCkuXG5cCiAgICAgICAgICAgT24gV2luZG93cyBwbGF0Zm9ybXMsIGBmaWxlb2JqJyBzaG91bGQgYWx3YXlzIGJlIG9wZW5lZCB3aXRoIG1vZGVcblwKICAgICAgICAgICAncmInIHRvIGF2b2lkIGlycml0YXRpb24gYWJvdXQgdGhlIGZpbGUgc2l6ZS5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTY3LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuZXh0cmFjdGFsbD0gKGZ1bmN0aW9uIChOb25lKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoImV4dHJhY3RhbGwiLGFyZ3VtZW50cyxbInNlbGYiXSx7InBhdGgiOiIuIiwibWVtYmVycyI6KCRjbGFzc1siTm9uZSJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siTm9uZSJdIDogTm9uZSl9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiYndiamxseWwiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5NjgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJFeHRyYWN0IGFsbCBtZW1iZXJzIGZyb20gdGhlIGFyY2hpdmUgdG8gdGhlIGN1cnJlbnQgd29ya2luZ1xuXAogICAgICAgICAgIGRpcmVjdG9yeSBhbmQgc2V0IG93bmVyLCBtb2RpZmljYXRpb24gdGltZSBhbmQgcGVybWlzc2lvbnMgb25cblwKICAgICAgICAgICBkaXJlY3RvcmllcyBhZnRlcndhcmRzLiBgcGF0aCcgc3BlY2lmaWVzIGEgZGlmZmVyZW50IGRpcmVjdG9yeVxuXAogICAgICAgICAgIHRvIGV4dHJhY3QgdG8uIGBtZW1iZXJzJyBpcyBvcHRpb25hbCBhbmQgbXVzdCBiZSBhIHN1YnNldCBvZiB0aGVcblwKICAgICAgICAgICBsaXN0IHJldHVybmVkIGJ5IGdldG1lbWJlcnMoKS5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTc0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgZGlyZWN0b3JpZXM9JGxvY2Fsc1siZGlyZWN0b3JpZXMiXT1saXN0Ll9fY2FsbF9fKFtdKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTk3NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChtZW1iZXJzPT09Tm9uZSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5NzcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgbWVtYmVycz0kbG9jYWxzWyJtZW1iZXJzIl09c2VsZjtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTk3OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyICRuZXh0MTIxMT1nZXRhdHRyKGl0ZXIobWVtYmVycyksIl9fbmV4dF9fIikKICAgICAgICAgICAgICAgIHZhciAkbm9fYnJlYWsxMjExPXRydWU7d2hpbGUodHJ1ZSl7CiAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyaW5mbz0kbG9jYWxzWyJ0YXJpbmZvIl09JG5leHQxMjExKCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycil7aWYoJGlzX2V4YygkZXJyLFtTdG9wSXRlcmF0aW9uXSkpeyRwb3BfZXhjKCk7YnJlYWt9ZWxzZXt0aHJvdygkZXJyKX19CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTk4MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKHRhcmluZm8sImlzZGlyIiksIl9fY2FsbF9fIikoKSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTgyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihkaXJlY3RvcmllcywiYXBwZW5kIiksIl9fY2FsbF9fIikodGFyaW5mbykKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTk4MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyaW5mbz0kbG9jYWxzWyJ0YXJpbmZvIl09Z2V0YXR0cihnZXRhdHRyKGNvcHksImNvcHkiKSwiX19jYWxsX18iKSh0YXJpbmZvKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTg0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldGF0dHIodGFyaW5mbywibW9kZSIsTnVtYmVyKDQ0OCkpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5ODYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiZXh0cmFjdCIpLCJfX2NhbGxfXyIpKHRhcmluZm8scGF0aCwkS3coInNldF9hdHRycyIsIWJvb2woZ2V0YXR0cihnZXRhdHRyKHRhcmluZm8sImlzZGlyIiksIl9fY2FsbF9fIikoKSkpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTk4OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGRpcmVjdG9yaWVzLCJzb3J0IiksIl9fY2FsbF9fIikoJEt3KCJrZXkiLCRsYW1iZGEoJGdsb2JhbHMsJGxvY2FscywiIGEiLCIgYS5uYW1lIikpKQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTk5MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGRpcmVjdG9yaWVzLCJyZXZlcnNlIiksIl9fY2FsbF9fIikoKQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTk5MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyICRuZXh0MTIxMj1nZXRhdHRyKGl0ZXIoZGlyZWN0b3JpZXMpLCJfX25leHRfXyIpCiAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTIxMj10cnVlO3doaWxlKHRydWUpewogICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmluZm89JGxvY2Fsc1sidGFyaW5mbyJdPSRuZXh0MTIxMigpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIpe2lmKCRpc19leGMoJGVycixbU3RvcEl0ZXJhdGlvbl0pKXskcG9wX2V4YygpO2JyZWFrfWVsc2V7dGhyb3coJGVycil9fQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5OTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgZGlycGF0aD0kbG9jYWxzWyJkaXJwYXRoIl09Z2V0YXR0cihnZXRhdHRyKGdldGF0dHIob3MsInBhdGgiKSwiam9pbiIpLCJfX2NhbGxfXyIpKHBhdGgsZ2V0YXR0cih0YXJpbmZvLCJuYW1lIikpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTk5NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICRmYWlsZWQxMjEzPWZhbHNlO3RyeXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMTk5NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiY2hvd24iKSwiX19jYWxsX18iKSh0YXJpbmZvLGRpcnBhdGgpCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzE5OTcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsInV0aW1lIiksIl9fY2FsbF9fIikodGFyaW5mbyxkaXJwYXRoKQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsxOTk4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJjaG1vZCIpLCJfX2NhbGxfXyIpKHRhcmluZm8sZGlycGF0aCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycjEyMTMpewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGZhaWxlZDEyMTM9dHJ1ZTtpZihmYWxzZSl7dm9pZCgwKX0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMjEzLFtFeHRyYWN0RXJyb3JdKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZT1fX0JSWVRIT05fXy5leGNlcHRpb24oJGVycjEyMTMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMDAwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJlcnJvcmxldmVsIiksIl9fZ3RfXyIpKE51bWJlcigxKSkpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMDAxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJhaXNlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjAwMywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfZGJnIiksIl9fY2FsbF9fIikoTnVtYmVyKDEpLGdldGF0dHIoInRhcmZpbGU6ICVzIiwiX19tb2RfXyIpKGUpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7dGhyb3cgJGVycjEyMTN9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjEyMTEpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMjExKX0KICAgICAgICB9CiAgICB9CiAgICApKCRjbGFzcy5Ob25lICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5Ob25lIDogTm9uZSkKICAgICRjbGFzcy5leHRyYWN0YWxsLl9fbmFtZV9fPSJleHRyYWN0YWxsIgogICAgJGNsYXNzLmV4dHJhY3RhbGwuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5leHRyYWN0YWxsLl9fZG9jX189IkV4dHJhY3QgYWxsIG1lbWJlcnMgZnJvbSB0aGUgYXJjaGl2ZSB0byB0aGUgY3VycmVudCB3b3JraW5nXG5cCiAgICAgICAgICAgZGlyZWN0b3J5IGFuZCBzZXQgb3duZXIsIG1vZGlmaWNhdGlvbiB0aW1lIGFuZCBwZXJtaXNzaW9ucyBvblxuXAogICAgICAgICAgIGRpcmVjdG9yaWVzIGFmdGVyd2FyZHMuIGBwYXRoJyBzcGVjaWZpZXMgYSBkaWZmZXJlbnQgZGlyZWN0b3J5XG5cCiAgICAgICAgICAgdG8gZXh0cmFjdCB0by4gYG1lbWJlcnMnIGlzIG9wdGlvbmFsIGFuZCBtdXN0IGJlIGEgc3Vic2V0IG9mIHRoZVxuXAogICAgICAgICAgIGxpc3QgcmV0dXJuZWQgYnkgZ2V0bWVtYmVycygpLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwMDUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5leHRyYWN0PSAoZnVuY3Rpb24gKFRydWUpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiZXh0cmFjdCIsYXJndW1lbnRzLFsic2VsZiIsIm1lbWJlciJdLHsicGF0aCI6IiIsInNldF9hdHRycyI6KCRjbGFzc1siVHJ1ZSJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siVHJ1ZSJdIDogVHJ1ZSl9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiMDRjYWY5a2siXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwMDYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJFeHRyYWN0IGEgbWVtYmVyIGZyb20gdGhlIGFyY2hpdmUgdG8gdGhlIGN1cnJlbnQgd29ya2luZyBkaXJlY3RvcnksXG5cCiAgICAgICAgICAgdXNpbmcgaXRzIGZ1bGwgbmFtZS4gSXRzIGZpbGUgaW5mb3JtYXRpb24gaXMgZXh0cmFjdGVkIGFzIGFjY3VyYXRlbHlcblwKICAgICAgICAgICBhcyBwb3NzaWJsZS4gYG1lbWJlcicgbWF5IGJlIGEgZmlsZW5hbWUgb3IgYSBUYXJJbmZvIG9iamVjdC4gWW91IGNhblxuXAogICAgICAgICAgIHNwZWNpZnkgYSBkaWZmZXJlbnQgZGlyZWN0b3J5IHVzaW5nIGBwYXRoJy4gRmlsZSBhdHRyaWJ1dGVzIChvd25lcixcblwKICAgICAgICAgICBtdGltZSwgbW9kZSkgYXJlIHNldCB1bmxlc3MgYHNldF9hdHRycycgaXMgRmFsc2UuXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjAxMiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9jaGVjayIpLCJfX2NhbGxfXyIpKCJyIikKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwMTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihpc2luc3RhbmNlLCJfX2NhbGxfXyIpKG1lbWJlcixzdHIpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjAxNSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciB0YXJpbmZvPSRsb2NhbHNbInRhcmluZm8iXT1nZXRhdHRyKGdldGF0dHIoc2VsZiwiZ2V0bWVtYmVyIiksIl9fY2FsbF9fIikobWVtYmVyKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMDE3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmluZm89JGxvY2Fsc1sidGFyaW5mbyJdPW1lbWJlcjtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjAyMCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIodGFyaW5mbywiaXNsbmsiKSwiX19jYWxsX18iKSgpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjAyMSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHNldGF0dHIodGFyaW5mbywiX2xpbmtfdGFyZ2V0IixnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihvcywicGF0aCIpLCJqb2luIiksIl9fY2FsbF9fIikocGF0aCxnZXRhdHRyKHRhcmluZm8sImxpbmtuYW1lIikpKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjAyMywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgJGZhaWxlZDEyMTQ9ZmFsc2U7dHJ5ewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwMjQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX2V4dHJhY3RfbWVtYmVyIiksIl9fY2FsbF9fIikodGFyaW5mbyxnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihvcywicGF0aCIpLCJqb2luIiksIl9fY2FsbF9fIikocGF0aCxnZXRhdHRyKHRhcmluZm8sIm5hbWUiKSksJEt3KCJzZXRfYXR0cnMiLHNldF9hdHRycykpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTIxNCl7CiAgICAgICAgICAgICAgICAgICAgdmFyICRmYWlsZWQxMjE0PXRydWU7aWYoZmFsc2Upe3ZvaWQoMCl9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMjE0LFtFbnZpcm9ubWVudEVycm9yXSkpewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZT1fX0JSWVRIT05fXy5leGNlcHRpb24oJGVycjEyMTQpCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwMjcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIoc2VsZiwiZXJyb3JsZXZlbCIpLCJfX2d0X18iKShOdW1iZXIoMCkpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMDI4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmFpc2UoKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMDMwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZSwiZmlsZW5hbWUiKT09PU5vbmUpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMDMxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9kYmciKSwiX19jYWxsX18iKShOdW1iZXIoMSksZ2V0YXR0cigidGFyZmlsZTogJXMiLCJfX21vZF9fIikoZ2V0YXR0cihlLCJzdHJlcnJvciIpKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjAzMywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfZGJnIiksIl9fY2FsbF9fIikoTnVtYmVyKDEpLGdldGF0dHIoInRhcmZpbGU6ICVzICVyIiwiX19tb2RfXyIpKHR1cGxlKFtnZXRhdHRyKGUsInN0cmVycm9yIiksZ2V0YXR0cihlLCJmaWxlbmFtZSIpXSkpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoJGlzX2V4YygkZXJyMTIxNCxbRXh0cmFjdEVycm9yXSkpewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZT1fX0JSWVRIT05fXy5leGNlcHRpb24oJGVycjEyMTQpCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwMzUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIoc2VsZiwiZXJyb3JsZXZlbCIpLCJfX2d0X18iKShOdW1iZXIoMSkpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMDM2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmFpc2UoKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMDM4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX2RiZyIpLCJfX2NhbGxfXyIpKE51bWJlcigxKSxnZXRhdHRyKCJ0YXJmaWxlOiAlcyIsIl9fbW9kX18iKShlKSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNle3Rocm93ICRlcnIxMjE0fQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjEyMTQpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMjE0KX0KICAgICAgICB9CiAgICB9CiAgICApKCRjbGFzcy5UcnVlICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5UcnVlIDogVHJ1ZSkKICAgICRjbGFzcy5leHRyYWN0Ll9fbmFtZV9fPSJleHRyYWN0IgogICAgJGNsYXNzLmV4dHJhY3QuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5leHRyYWN0Ll9fZG9jX189IkV4dHJhY3QgYSBtZW1iZXIgZnJvbSB0aGUgYXJjaGl2ZSB0byB0aGUgY3VycmVudCB3b3JraW5nIGRpcmVjdG9yeSxcblwKICAgICAgICAgICB1c2luZyBpdHMgZnVsbCBuYW1lLiBJdHMgZmlsZSBpbmZvcm1hdGlvbiBpcyBleHRyYWN0ZWQgYXMgYWNjdXJhdGVseVxuXAogICAgICAgICAgIGFzIHBvc3NpYmxlLiBgbWVtYmVyJyBtYXkgYmUgYSBmaWxlbmFtZSBvciBhIFRhckluZm8gb2JqZWN0LiBZb3UgY2FuXG5cCiAgICAgICAgICAgc3BlY2lmeSBhIGRpZmZlcmVudCBkaXJlY3RvcnkgdXNpbmcgYHBhdGgnLiBGaWxlIGF0dHJpYnV0ZXMgKG93bmVyLFxuXAogICAgICAgICAgIG10aW1lLCBtb2RlKSBhcmUgc2V0IHVubGVzcyBgc2V0X2F0dHJzJyBpcyBGYWxzZS5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMDQwLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuZXh0cmFjdGZpbGU9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoImV4dHJhY3RmaWxlIixhcmd1bWVudHMsWyJzZWxmIiwibWVtYmVyIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJiaG95MmNtaSJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjA0MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIkV4dHJhY3QgYSBtZW1iZXIgZnJvbSB0aGUgYXJjaGl2ZSBhcyBhIGZpbGUgb2JqZWN0LiBgbWVtYmVyJyBtYXkgYmVcblwKICAgICAgICAgICBhIGZpbGVuYW1lIG9yIGEgVGFySW5mbyBvYmplY3QuIElmIGBtZW1iZXInIGlzIGEgcmVndWxhciBmaWxlIG9yIGFcblwKICAgICAgICAgICBsaW5rLCBhbiBpby5CdWZmZXJlZFJlYWRlciBvYmplY3QgaXMgcmV0dXJuZWQuIE90aGVyd2lzZSwgTm9uZSBpc1xuXAogICAgICAgICAgIHJldHVybmVkLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwNDYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfY2hlY2siKSwiX19jYWxsX18iKSgiciIpCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMDQ4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoaXNpbnN0YW5jZSwiX19jYWxsX18iKShtZW1iZXIsc3RyKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwNDksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFyaW5mbz0kbG9jYWxzWyJ0YXJpbmZvIl09Z2V0YXR0cihnZXRhdHRyKHNlbGYsImdldG1lbWJlciIpLCJfX2NhbGxfXyIpKG1lbWJlcik7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjA1MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciB0YXJpbmZvPSRsb2NhbHNbInRhcmluZm8iXT1tZW1iZXI7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwNTMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKGdldGF0dHIoZ2V0YXR0cih0YXJpbmZvLCJpc3JlZyIpLCJfX2NhbGxfXyIpKCkpfHwkdGVzdF9pdGVtKGdldGF0dHIoZ2V0YXR0cih0YXJpbmZvLCJ0eXBlIiksIl9fbm90X2luX18iKShTVVBQT1JURURfVFlQRVMpKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMDU1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJmaWxlb2JqZWN0IiksIl9fY2FsbF9fIikoc2VsZix0YXJpbmZvKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihib29sKCR0ZXN0X2V4cHIoJHRlc3RfaXRlbShnZXRhdHRyKGdldGF0dHIodGFyaW5mbywiaXNsbmsiKSwiX19jYWxsX18iKSgpKXx8JHRlc3RfaXRlbShnZXRhdHRyKGdldGF0dHIodGFyaW5mbywiaXNzeW0iKSwiX19jYWxsX18iKSgpKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMDU4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGlzaW5zdGFuY2UsIl9fY2FsbF9fIikoZ2V0YXR0cihzZWxmLCJmaWxlb2JqIiksX1N0cmVhbSkpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjA2MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKFN0cmVhbUVycm9yLCJfX2NhbGxfXyIpKCJjYW5ub3QgZXh0cmFjdCAoc3ltKWxpbmsgYXMgZmlsZSBvYmplY3QiKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMDY1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRhdHRyKGdldGF0dHIoc2VsZiwiZXh0cmFjdGZpbGUiKSwiX19jYWxsX18iKShnZXRhdHRyKGdldGF0dHIoc2VsZiwiX2ZpbmRfbGlua190YXJnZXQiKSwiX19jYWxsX18iKSh0YXJpbmZvKSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwNjksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjEyMTUpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMjE1KX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5leHRyYWN0ZmlsZS5fX25hbWVfXz0iZXh0cmFjdGZpbGUiCiAgICAkY2xhc3MuZXh0cmFjdGZpbGUuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5leHRyYWN0ZmlsZS5fX2RvY19fPSJFeHRyYWN0IGEgbWVtYmVyIGZyb20gdGhlIGFyY2hpdmUgYXMgYSBmaWxlIG9iamVjdC4gYG1lbWJlcicgbWF5IGJlXG5cCiAgICAgICAgICAgYSBmaWxlbmFtZSBvciBhIFRhckluZm8gb2JqZWN0LiBJZiBgbWVtYmVyJyBpcyBhIHJlZ3VsYXIgZmlsZSBvciBhXG5cCiAgICAgICAgICAgbGluaywgYW4gaW8uQnVmZmVyZWRSZWFkZXIgb2JqZWN0IGlzIHJldHVybmVkLiBPdGhlcndpc2UsIE5vbmUgaXNcblwKICAgICAgICAgICByZXR1cm5lZC5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMDcxLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX2V4dHJhY3RfbWVtYmVyPSAoZnVuY3Rpb24gKFRydWUpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiX2V4dHJhY3RfbWVtYmVyIixhcmd1bWVudHMsWyJzZWxmIiwidGFyaW5mbyIsInRhcmdldHBhdGgiXSx7InNldF9hdHRycyI6KCRjbGFzc1siVHJ1ZSJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siVHJ1ZSJdIDogVHJ1ZSl9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiNzd1Z3JiejIiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwNzIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJFeHRyYWN0IHRoZSBUYXJJbmZvIG9iamVjdCB0YXJpbmZvIHRvIGEgcGh5c2ljYWxcblwKICAgICAgICAgICBmaWxlIGNhbGxlZCB0YXJnZXRwYXRoLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwNzgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciB0YXJnZXRwYXRoPSRsb2NhbHNbInRhcmdldHBhdGgiXT1nZXRhdHRyKGdldGF0dHIodGFyZ2V0cGF0aCwicnN0cmlwIiksIl9fY2FsbF9fIikoIi8iKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjA3OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIHRhcmdldHBhdGg9JGxvY2Fsc1sidGFyZ2V0cGF0aCJdPWdldGF0dHIoZ2V0YXR0cih0YXJnZXRwYXRoLCJyZXBsYWNlIiksIl9fY2FsbF9fIikoIi8iLGdldGF0dHIob3MsInNlcCIpKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjA4MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIHVwcGVyZGlycz0kbG9jYWxzWyJ1cHBlcmRpcnMiXT1nZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihvcywicGF0aCIpLCJkaXJuYW1lIiksIl9fY2FsbF9fIikodGFyZ2V0cGF0aCk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwODMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKHVwcGVyZGlycykmJiR0ZXN0X2l0ZW0oIWJvb2woZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIob3MsInBhdGgiKSwiZXhpc3RzIiksIl9fY2FsbF9fIikodXBwZXJkaXJzKSkpKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwODYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIob3MsIm1ha2VkaXJzIiksIl9fY2FsbF9fIikodXBwZXJkaXJzKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjA4OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKHRhcmluZm8sImlzbG5rIiksIl9fY2FsbF9fIikoKSl8fCR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKHRhcmluZm8sImlzc3ltIiksIl9fY2FsbF9fIikoKSkpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjA4OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfZGJnIiksIl9fY2FsbF9fIikoTnVtYmVyKDEpLGdldGF0dHIoIiVzIC0+ICVzIiwiX19tb2RfXyIpKHR1cGxlKFtnZXRhdHRyKHRhcmluZm8sIm5hbWUiKSxnZXRhdHRyKHRhcmluZm8sImxpbmtuYW1lIildKSkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwOTEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX2RiZyIpLCJfX2NhbGxfXyIpKE51bWJlcigxKSxnZXRhdHRyKHRhcmluZm8sIm5hbWUiKSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwOTMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKHRhcmluZm8sImlzcmVnIiksIl9fY2FsbF9fIikoKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwOTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwibWFrZWZpbGUiKSwiX19jYWxsX18iKSh0YXJpbmZvLHRhcmdldHBhdGgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKHRhcmluZm8sImlzZGlyIiksIl9fY2FsbF9fIikoKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwOTYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwibWFrZWRpciIpLCJfX2NhbGxfXyIpKHRhcmluZm8sdGFyZ2V0cGF0aCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIodGFyaW5mbywiaXNmaWZvIiksIl9fY2FsbF9fIikoKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIwOTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwibWFrZWZpZm8iKSwiX19jYWxsX18iKSh0YXJpbmZvLHRhcmdldHBhdGgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKGdldGF0dHIoZ2V0YXR0cih0YXJpbmZvLCJpc2NociIpLCJfX2NhbGxfXyIpKCkpfHwkdGVzdF9pdGVtKGdldGF0dHIoZ2V0YXR0cih0YXJpbmZvLCJpc2JsayIpLCJfX2NhbGxfXyIpKCkpKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxMDAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwibWFrZWRldiIpLCJfX2NhbGxfXyIpKHRhcmluZm8sdGFyZ2V0cGF0aCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoYm9vbCgkdGVzdF9leHByKCR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKHRhcmluZm8sImlzbG5rIiksIl9fY2FsbF9fIikoKSl8fCR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKHRhcmluZm8sImlzc3ltIiksIl9fY2FsbF9fIikoKSkpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjEwMiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJtYWtlbGluayIpLCJfX2NhbGxfXyIpKHRhcmluZm8sdGFyZ2V0cGF0aCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIodGFyaW5mbywidHlwZSIpLCJfX25vdF9pbl9fIikoU1VQUE9SVEVEX1RZUEVTKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxMDQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwibWFrZXVua25vd24iKSwiX19jYWxsX18iKSh0YXJpbmZvLHRhcmdldHBhdGgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxMDYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwibWFrZWZpbGUiKSwiX19jYWxsX18iKSh0YXJpbmZvLHRhcmdldHBhdGgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTA4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKHNldF9hdHRycykpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxMDksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiY2hvd24iKSwiX19jYWxsX18iKSh0YXJpbmZvLHRhcmdldHBhdGgpCiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjExMCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKGJvb2woIWJvb2woZ2V0YXR0cihnZXRhdHRyKHRhcmluZm8sImlzc3ltIiksIl9fY2FsbF9fIikoKSkpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjExMSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiY2htb2QiKSwiX19jYWxsX18iKSh0YXJpbmZvLHRhcmdldHBhdGgpCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxMTIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsInV0aW1lIiksIl9fY2FsbF9fIikodGFyaW5mbyx0YXJnZXRwYXRoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMjE1KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTIxNSl9CiAgICAgICAgfQogICAgfQogICAgKSgkY2xhc3MuVHJ1ZSAhPSB1bmRlZmluZWQgPyAkY2xhc3MuVHJ1ZSA6IFRydWUpCiAgICAkY2xhc3MuX2V4dHJhY3RfbWVtYmVyLl9fbmFtZV9fPSJfZXh0cmFjdF9tZW1iZXIiCiAgICAkY2xhc3MuX2V4dHJhY3RfbWVtYmVyLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuX2V4dHJhY3RfbWVtYmVyLl9fZG9jX189IkV4dHJhY3QgdGhlIFRhckluZm8gb2JqZWN0IHRhcmluZm8gdG8gYSBwaHlzaWNhbFxuXAogICAgICAgICAgIGZpbGUgY2FsbGVkIHRhcmdldHBhdGguXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjExOSwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLm1ha2VkaXI9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIm1ha2VkaXIiLGFyZ3VtZW50cyxbInNlbGYiLCJ0YXJpbmZvIiwidGFyZ2V0cGF0aCJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsicDRrc2lwcjYiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxMjAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJNYWtlIGEgZGlyZWN0b3J5IGNhbGxlZCB0YXJnZXRwYXRoLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxMjIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICRmYWlsZWQxMjE1PWZhbHNlO3RyeXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTI1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKG9zLCJta2RpciIpLCJfX2NhbGxfXyIpKHRhcmdldHBhdGgsTnVtYmVyKDQ0OCkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTIxNSl7CiAgICAgICAgICAgICAgICAgICAgdmFyICRmYWlsZWQxMjE1PXRydWU7aWYoZmFsc2Upe3ZvaWQoMCl9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMjE1LFtGaWxlRXhpc3RzRXJyb3JdKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxMjcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCgwKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNle3Rocm93ICRlcnIxMjE1fQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjEyMTUpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMjE1KX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5tYWtlZGlyLl9fbmFtZV9fPSJtYWtlZGlyIgogICAgJGNsYXNzLm1ha2VkaXIuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5tYWtlZGlyLl9fZG9jX189Ik1ha2UgYSBkaXJlY3RvcnkgY2FsbGVkIHRhcmdldHBhdGguXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjEyOSwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLm1ha2VmaWxlPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJtYWtlZmlsZSIsYXJndW1lbnRzLFsic2VsZiIsInRhcmluZm8iLCJ0YXJnZXRwYXRoIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyI5NzB0dW94cCJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjEzMCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIk1ha2UgYSBmaWxlIGNhbGxlZCB0YXJnZXRwYXRoLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxMzIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciBzb3VyY2U9JGxvY2Fsc1sic291cmNlIl09Z2V0YXR0cihzZWxmLCJmaWxlb2JqIik7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxMzMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzb3VyY2UsInNlZWsiKSwiX19jYWxsX18iKShnZXRhdHRyKHRhcmluZm8sIm9mZnNldF9kYXRhIikpCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTM0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0PSRsb2NhbHNbInRhcmdldCJdPWdldGF0dHIoYmx0bl9vcGVuLCJfX2NhbGxfXyIpKHRhcmdldHBhdGgsIndiIik7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxMzUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cih0YXJpbmZvLCJzcGFyc2UiKSE9PU5vbmUpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTM2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICRuZXh0MTIxNj1nZXRhdHRyKGl0ZXIoZ2V0YXR0cih0YXJpbmZvLCJzcGFyc2UiKSksIl9fbmV4dF9fIikKICAgICAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTIxNj10cnVlO3doaWxlKHRydWUpewogICAgICAgICAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmlnaHQ9aXRlcigkbmV4dDEyMTYoKSk7JGNvdW50ZXI9LTEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY291bnRlcisrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9mZnNldD0kbG9jYWxzWyJvZmZzZXQiXT1uZXh0KCRyaWdodCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY291bnRlcisrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNpemU9JGxvY2Fsc1sic2l6ZSJdPW5leHQoJHJpZ2h0KTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycjEyMTcpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRlcnIxMjE3Ll9fbmFtZV9fPT0iU3RvcEl0ZXJhdGlvbiIpeyRwb3BfZXhjKCk7dGhyb3cgVmFsdWVFcnJvcigibmVlZCBtb3JlIHRoYW4gIiskY291bnRlcisiIHZhbHVlIisoJGNvdW50ZXI+MSA/ICJzIiA6ICIiKSsiIHRvIHVucGFjayIpfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRleGhhdXN0ZWQ9dHJ1ZTt0cnl7bmV4dCgkcmlnaHQpOyRleGhhdXN0ZWQ9ZmFsc2V9Y2F0Y2goZXJyKXtpZihlcnIuX19uYW1lX189PSJTdG9wSXRlcmF0aW9uIil7JHBvcF9leGMoKX19aWYoISRleGhhdXN0ZWQpe3Rocm93IFZhbHVlRXJyb3IoInRvbyBtYW55IHZhbHVlcyB0byB1bnBhY2sgKGV4cGVjdGVkICIrKCRjb3VudGVyKzEpKyIpIil9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycil7aWYoJGlzX2V4YygkZXJyLFtTdG9wSXRlcmF0aW9uXSkpeyRwb3BfZXhjKCk7YnJlYWt9ZWxzZXt0aHJvdygkZXJyKX19CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxMzcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHRhcmdldCwic2VlayIpLCJfX2NhbGxfXyIpKG9mZnNldCkKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjEzOCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGNvcHlmaWxlb2JqLCJfX2NhbGxfXyIpKHNvdXJjZSx0YXJnZXQsc2l6ZSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxNDAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGNvcHlmaWxlb2JqLCJfX2NhbGxfXyIpKHNvdXJjZSx0YXJnZXQsZ2V0YXR0cih0YXJpbmZvLCJzaXplIikpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTQxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIodGFyZ2V0LCJzZWVrIiksIl9fY2FsbF9fIikoZ2V0YXR0cih0YXJpbmZvLCJzaXplIikpCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTQyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIodGFyZ2V0LCJ0cnVuY2F0ZSIpLCJfX2NhbGxfXyIpKCkKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxNDMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cih0YXJnZXQsImNsb3NlIiksIl9fY2FsbF9fIikoKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjEyMTYpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMjE2KX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5tYWtlZmlsZS5fX25hbWVfXz0ibWFrZWZpbGUiCiAgICAkY2xhc3MubWFrZWZpbGUuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5tYWtlZmlsZS5fX2RvY19fPSJNYWtlIGEgZmlsZSBjYWxsZWQgdGFyZ2V0cGF0aC5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTQ1LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MubWFrZXVua25vd249IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIm1ha2V1bmtub3duIixhcmd1bWVudHMsWyJzZWxmIiwidGFyaW5mbyIsInRhcmdldHBhdGgiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbIjF5YWV4eDVxIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTQ2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiTWFrZSBhIGZpbGUgZnJvbSBhIFRhckluZm8gb2JqZWN0IHdpdGggYW4gdW5rbm93biB0eXBlXG5cCiAgICAgICAgICAgYXQgdGFyZ2V0cGF0aC5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTQ5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwibWFrZWZpbGUiKSwiX19jYWxsX18iKSh0YXJpbmZvLHRhcmdldHBhdGgpCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTUwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX2RiZyIpLCJfX2NhbGxfXyIpKE51bWJlcigxKSxnZXRhdHRyKCJ0YXJmaWxlOiBVbmtub3duIGZpbGUgdHlwZSAlciwgIisiZXh0cmFjdGVkIGFzIHJlZ3VsYXIgZmlsZS4iLCJfX21vZF9fIikoZ2V0YXR0cih0YXJpbmZvLCJ0eXBlIikpKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjEyMTgpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMjE4KX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5tYWtldW5rbm93bi5fX25hbWVfXz0ibWFrZXVua25vd24iCiAgICAkY2xhc3MubWFrZXVua25vd24uX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5tYWtldW5rbm93bi5fX2RvY19fPSJNYWtlIGEgZmlsZSBmcm9tIGEgVGFySW5mbyBvYmplY3Qgd2l0aCBhbiB1bmtub3duIHR5cGVcblwKICAgICAgICAgICBhdCB0YXJnZXRwYXRoLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxNTMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5tYWtlZmlmbz0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygibWFrZWZpZm8iLGFyZ3VtZW50cyxbInNlbGYiLCJ0YXJpbmZvIiwidGFyZ2V0cGF0aCJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsienl1bnhzbDMiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxNTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJNYWtlIGEgZmlmbyBjYWxsZWQgdGFyZ2V0cGF0aC5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTU2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoaGFzYXR0ciwiX19jYWxsX18iKShvcywibWtmaWZvIikpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTU3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKG9zLCJta2ZpZm8iKSwiX19jYWxsX18iKSh0YXJnZXRwYXRoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTU5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihFeHRyYWN0RXJyb3IsIl9fY2FsbF9fIikoImZpZm8gbm90IHN1cHBvcnRlZCBieSBzeXN0ZW0iKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjEyMTgpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMjE4KX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5tYWtlZmlmby5fX25hbWVfXz0ibWFrZWZpZm8iCiAgICAkY2xhc3MubWFrZWZpZm8uX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5tYWtlZmlmby5fX2RvY19fPSJNYWtlIGEgZmlmbyBjYWxsZWQgdGFyZ2V0cGF0aC5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTYxLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MubWFrZWRldj0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygibWFrZWRldiIsYXJndW1lbnRzLFsic2VsZiIsInRhcmluZm8iLCJ0YXJnZXRwYXRoIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJ6a2w3OHJhNCJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjE2MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIk1ha2UgYSBjaGFyYWN0ZXIgb3IgYmxvY2sgZGV2aWNlIGNhbGxlZCB0YXJnZXRwYXRoLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxNjQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKCFib29sKGdldGF0dHIoaGFzYXR0ciwiX19jYWxsX18iKShvcywibWtub2QiKSkpfHwkdGVzdF9pdGVtKCFib29sKGdldGF0dHIoaGFzYXR0ciwiX19jYWxsX18iKShvcywibWFrZWRldiIpKSkpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjE2NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHRocm93IGdldGF0dHIoRXh0cmFjdEVycm9yLCJfX2NhbGxfXyIpKCJzcGVjaWFsIGRldmljZXMgbm90IHN1cHBvcnRlZCBieSBzeXN0ZW0iKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjE2NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIG1vZGU9JGxvY2Fsc1sibW9kZSJdPWdldGF0dHIodGFyaW5mbywibW9kZSIpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTY4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cih0YXJpbmZvLCJpc2JsayIpLCJfX2NhbGxfXyIpKCkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTY5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICR0ZW1wPSRsb2NhbHNbIiR0ZW1wIl09Z2V0YXR0cihzdGF0LCJTX0lGQkxLIik7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZighaGFzYXR0cihtb2RlLCJfX2lvcl9fIikpewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZT0kbG9jYWxzWyJtb2RlIl09Z2V0YXR0cihtb2RlLCJfX29yX18iKSgkdGVtcCk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgbW9kZT1nZXRhdHRyKG1vZGUsIl9faW9yX18iKSgkdGVtcCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxNzEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgJHRlbXA9JGxvY2Fsc1siJHRlbXAiXT1nZXRhdHRyKHN0YXQsIlNfSUZDSFIiKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKCFoYXNhdHRyKG1vZGUsIl9faW9yX18iKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2RlPSRsb2NhbHNbIm1vZGUiXT1nZXRhdHRyKG1vZGUsIl9fb3JfXyIpKCR0ZW1wKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBtb2RlPWdldGF0dHIobW9kZSwiX19pb3JfXyIpKCR0ZW1wKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxNzMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihvcywibWtub2QiKSwiX19jYWxsX18iKSh0YXJnZXRwYXRoLG1vZGUsZ2V0YXR0cihnZXRhdHRyKG9zLCJtYWtlZGV2IiksIl9fY2FsbF9fIikoZ2V0YXR0cih0YXJpbmZvLCJkZXZtYWpvciIpLGdldGF0dHIodGFyaW5mbywiZGV2bWlub3IiKSkpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTIxOCl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjEyMTgpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLm1ha2VkZXYuX19uYW1lX189Im1ha2VkZXYiCiAgICAkY2xhc3MubWFrZWRldi5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLm1ha2VkZXYuX19kb2NfXz0iTWFrZSBhIGNoYXJhY3RlciBvciBibG9jayBkZXZpY2UgY2FsbGVkIHRhcmdldHBhdGguXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjE3NiwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLm1ha2VsaW5rPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJtYWtlbGluayIsYXJndW1lbnRzLFsic2VsZiIsInRhcmluZm8iLCJ0YXJnZXRwYXRoIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJvcXkybXljbiJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjE3NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIk1ha2UgYSAoc3ltYm9saWMpIGxpbmsgY2FsbGVkIHRhcmdldHBhdGguIElmIGl0IGNhbm5vdCBiZSBjcmVhdGVkXG5cCiAgICAgICAgICAocGxhdGZvcm0gbGltaXRhdGlvbiksIHdlIHRyeSB0byBtYWtlIGEgY29weSBvZiB0aGUgcmVmZXJlbmNlZCBmaWxlXG5cCiAgICAgICAgICBpbnN0ZWFkIG9mIGEgbGluay5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTgxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAkZmFpbGVkMTIxOD1mYWxzZTt0cnl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjE4MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKHRhcmluZm8sImlzc3ltIiksIl9fY2FsbF9fIikoKSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTg0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihvcywic3ltbGluayIpLCJfX2NhbGxfXyIpKGdldGF0dHIodGFyaW5mbywibGlua25hbWUiKSx0YXJnZXRwYXRoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTg3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIob3MsInBhdGgiKSwiZXhpc3RzIiksIl9fY2FsbF9fIikoZ2V0YXR0cih0YXJpbmZvLCJfbGlua190YXJnZXQiKSkpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxODgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihvcywibGluayIpLCJfX2NhbGxfXyIpKGdldGF0dHIodGFyaW5mbywiX2xpbmtfdGFyZ2V0IiksdGFyZ2V0cGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjE5MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9leHRyYWN0X21lbWJlciIpLCJfX2NhbGxfXyIpKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfZmluZF9saW5rX3RhcmdldCIpLCJfX2NhbGxfXyIpKHRhcmluZm8pLHRhcmdldHBhdGgpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTIxOCl7CiAgICAgICAgICAgICAgICAgICAgdmFyICRmYWlsZWQxMjE4PXRydWU7aWYoZmFsc2Upe3ZvaWQoMCl9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMjE4LFtzeW1saW5rX2V4Y2VwdGlvbl0pKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjE5MywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAkZmFpbGVkMTIxOT1mYWxzZTt0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMTk0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX2V4dHJhY3RfbWVtYmVyIiksIl9fY2FsbF9fIikoZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9maW5kX2xpbmtfdGFyZ2V0IiksIl9fY2FsbF9fIikodGFyaW5mbyksdGFyZ2V0cGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTIxOSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGZhaWxlZDEyMTk9dHJ1ZTtpZihmYWxzZSl7dm9pZCgwKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoJGlzX2V4YygkZXJyMTIxOSxbS2V5RXJyb3JdKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjE5NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGdldGF0dHIoRXh0cmFjdEVycm9yLCJfX2NhbGxfXyIpKCJ1bmFibGUgdG8gcmVzb2x2ZSBsaW5rIGluc2lkZSBhcmNoaXZlIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7dGhyb3cgJGVycjEyMTl9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZXt0aHJvdyAkZXJyMTIxOH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMjE4KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTIxOCl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MubWFrZWxpbmsuX19uYW1lX189Im1ha2VsaW5rIgogICAgJGNsYXNzLm1ha2VsaW5rLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MubWFrZWxpbmsuX19kb2NfXz0iTWFrZSBhIChzeW1ib2xpYykgbGluayBjYWxsZWQgdGFyZ2V0cGF0aC4gSWYgaXQgY2Fubm90IGJlIGNyZWF0ZWRcblwKICAgICAgICAgIChwbGF0Zm9ybSBsaW1pdGF0aW9uKSwgd2UgdHJ5IHRvIG1ha2UgYSBjb3B5IG9mIHRoZSByZWZlcmVuY2VkIGZpbGVcblwKICAgICAgICAgIGluc3RlYWQgb2YgYSBsaW5rLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIxOTksIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5jaG93bj0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiY2hvd24iLGFyZ3VtZW50cyxbInNlbGYiLCJ0YXJpbmZvIiwidGFyZ2V0cGF0aCJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiamFkMW10bGYiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyMDAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJTZXQgb3duZXIgb2YgdGFyZ2V0cGF0aCBhY2NvcmRpbmcgdG8gdGFyaW5mby5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjAyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKCR0ZXN0X2V4cHIoJHRlc3RfaXRlbSgkdGVzdF9leHByKCR0ZXN0X2l0ZW0ocHdkKSYmJHRlc3RfaXRlbShnZXRhdHRyKGhhc2F0dHIsIl9fY2FsbF9fIikob3MsImdldGV1aWQiKSkpKSYmJHRlc3RfaXRlbShnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihvcywiZ2V0ZXVpZCIpLCJfX2NhbGxfXyIpKCksIl9fZXFfXyIpKE51bWJlcigwKSkpKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyMDQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAkZmFpbGVkMTIyMD1mYWxzZTt0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyMDUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGc9JGxvY2Fsc1siZyJdPWdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKGdycCwiZ2V0Z3JuYW0iKSwiX19jYWxsX18iKShnZXRhdHRyKHRhcmluZm8sImduYW1lIikpLCJfX2dldGl0ZW1fXyIpKE51bWJlcigyKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycjEyMjApewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGZhaWxlZDEyMjA9dHJ1ZTtpZihmYWxzZSl7dm9pZCgwKX0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMjIwLFtLZXlFcnJvcl0pKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyMDcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnPSRsb2NhbHNbImciXT1nZXRhdHRyKHRhcmluZm8sImdpZCIpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXt0aHJvdyAkZXJyMTIyMH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjIwOCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICRmYWlsZWQxMjIxPWZhbHNlO3RyeXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjIwOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdT0kbG9jYWxzWyJ1Il09Z2V0YXR0cihnZXRhdHRyKGdldGF0dHIocHdkLCJnZXRwd25hbSIpLCJfX2NhbGxfXyIpKGdldGF0dHIodGFyaW5mbywidW5hbWUiKSksIl9fZ2V0aXRlbV9fIikoTnVtYmVyKDIpKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTIyMSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZmFpbGVkMTIyMT10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKCRpc19leGMoJGVycjEyMjEsW0tleUVycm9yXSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjIxMSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHU9JGxvY2Fsc1sidSJdPWdldGF0dHIodGFyaW5mbywidWlkIik7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNle3Rocm93ICRlcnIxMjIxfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjEyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgJGZhaWxlZDEyMjI9ZmFsc2U7dHJ5ewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjEzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJvb2woJHRlc3RfZXhwcigkdGVzdF9pdGVtKGdldGF0dHIoZ2V0YXR0cih0YXJpbmZvLCJpc3N5bSIpLCJfX2NhbGxfXyIpKCkpJiYkdGVzdF9pdGVtKGdldGF0dHIoaGFzYXR0ciwiX19jYWxsX18iKShvcywibGNob3duIikpKSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjIxNCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKG9zLCJsY2hvd24iKSwiX19jYWxsX18iKSh0YXJnZXRwYXRoLHUsZykKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjIxNiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIoc3lzLCJwbGF0Zm9ybSIpLCJfX25lX18iKSgib3MyZW14IikpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjE3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKG9zLCJjaG93biIpLCJfX2NhbGxfXyIpKHRhcmdldHBhdGgsdSxnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIxMjIyKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRmYWlsZWQxMjIyPXRydWU7aWYoZmFsc2Upe3ZvaWQoMCl9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoJGlzX2V4YygkZXJyMTIyMixbRW52aXJvbm1lbnRFcnJvcl0pKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlPV9fQlJZVEhPTl9fLmV4Y2VwdGlvbigkZXJyMTIyMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyMTksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGdldGF0dHIoRXh0cmFjdEVycm9yLCJfX2NhbGxfXyIpKCJjb3VsZCBub3QgY2hhbmdlIG93bmVyIikKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNle3Rocm93ICRlcnIxMjIyfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMjIwKXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTIyMCl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuY2hvd24uX19uYW1lX189ImNob3duIgogICAgJGNsYXNzLmNob3duLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuY2hvd24uX19kb2NfXz0iU2V0IG93bmVyIG9mIHRhcmdldHBhdGggYWNjb3JkaW5nIHRvIHRhcmluZm8uXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjIyMSwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLmNobW9kPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJjaG1vZCIsYXJndW1lbnRzLFsic2VsZiIsInRhcmluZm8iLCJ0YXJnZXRwYXRoIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJtcGN4d2h5diJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjIyMiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIlNldCBmaWxlIHBlcm1pc3Npb25zIG9mIHRhcmdldHBhdGggYWNjb3JkaW5nIHRvIHRhcmluZm8uXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjIyNCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGhhc2F0dHIsIl9fY2FsbF9fIikob3MsJ2NobW9kJykpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjI1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgJGZhaWxlZDEyMjM9ZmFsc2U7dHJ5ewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjI2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihvcywiY2htb2QiKSwiX19jYWxsX18iKSh0YXJnZXRwYXRoLGdldGF0dHIodGFyaW5mbywibW9kZSIpKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTIyMyl7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZmFpbGVkMTIyMz10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKCRpc19leGMoJGVycjEyMjMsW0Vudmlyb25tZW50RXJyb3JdKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZT1fX0JSWVRIT05fXy5leGNlcHRpb24oJGVycjEyMjMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjI4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKEV4dHJhY3RFcnJvciwiX19jYWxsX18iKSgiY291bGQgbm90IGNoYW5nZSBtb2RlIikKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNle3Rocm93ICRlcnIxMjIzfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMjIzKXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTIyMyl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuY2htb2QuX19uYW1lX189ImNobW9kIgogICAgJGNsYXNzLmNobW9kLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuY2htb2QuX19kb2NfXz0iU2V0IGZpbGUgcGVybWlzc2lvbnMgb2YgdGFyZ2V0cGF0aCBhY2NvcmRpbmcgdG8gdGFyaW5mby5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjMwLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MudXRpbWU9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoInV0aW1lIixhcmd1bWVudHMsWyJzZWxmIiwidGFyaW5mbyIsInRhcmdldHBhdGgiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbIjJ2ejB3OGh5Il0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjMxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiU2V0IG1vZGlmaWNhdGlvbiB0aW1lIG9mIHRhcmdldHBhdGggYWNjb3JkaW5nIHRvIHRhcmluZm8uXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjIzMywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbCghYm9vbChnZXRhdHRyKGhhc2F0dHIsIl9fY2FsbF9fIikob3MsJ3V0aW1lJykpKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjIzNCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyMzUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICRmYWlsZWQxMjI0PWZhbHNlO3RyeXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjM2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKG9zLCJ1dGltZSIpLCJfX2NhbGxfXyIpKHRhcmdldHBhdGgsdHVwbGUoW2dldGF0dHIodGFyaW5mbywibXRpbWUiKSxnZXRhdHRyKHRhcmluZm8sIm10aW1lIildKSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoKCRlcnIxMjI0KXsKICAgICAgICAgICAgICAgICAgICB2YXIgJGZhaWxlZDEyMjQ9dHJ1ZTtpZihmYWxzZSl7dm9pZCgwKX0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKCRpc19leGMoJGVycjEyMjQsW0Vudmlyb25tZW50RXJyb3JdKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlPV9fQlJZVEhPTl9fLmV4Y2VwdGlvbigkZXJyMTIyNCkKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjIzOCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKEV4dHJhY3RFcnJvciwiX19jYWxsX18iKSgiY291bGQgbm90IGNoYW5nZSBtb2RpZmljYXRpb24gdGltZSIpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2V7dGhyb3cgJGVycjEyMjR9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTIyNCl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjEyMjQpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLnV0aW1lLl9fbmFtZV9fPSJ1dGltZSIKICAgICRjbGFzcy51dGltZS5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLnV0aW1lLl9fZG9jX189IlNldCBtb2RpZmljYXRpb24gdGltZSBvZiB0YXJnZXRwYXRoIGFjY29yZGluZyB0byB0YXJpbmZvLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyNDEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5uZXh0PSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJuZXh0Iixhcmd1bWVudHMsWyJzZWxmIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyIzYngzaW1kOSJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjI0MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIlJldHVybiB0aGUgbmV4dCBtZW1iZXIgb2YgdGhlIGFyY2hpdmUgYXMgYSBUYXJJbmZvIG9iamVjdCwgd2hlblxuXAogICAgICAgICAgIFRhckZpbGUgaXMgb3BlbmVkIGZvciByZWFkaW5nLiBSZXR1cm4gTm9uZSBpZiB0aGVyZSBpcyBubyBtb3JlXG5cCiAgICAgICAgICAgYXZhaWxhYmxlLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyNDYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfY2hlY2siKSwiX19jYWxsX18iKSgicmEiKQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjI0NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKHNlbGYsImZpcnN0bWVtYmVyIikhPT1Ob25lKSl7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjI0OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIHZhciBtPSRsb2NhbHNbIm0iXT1nZXRhdHRyKHNlbGYsImZpcnN0bWVtYmVyIik7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjQ5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJmaXJzdG1lbWJlciIsTm9uZSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjUwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyNTMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKHNlbGYsImZpbGVvYmoiKSwic2VlayIpLCJfX2NhbGxfXyIpKGdldGF0dHIoc2VsZiwib2Zmc2V0IikpCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjU0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgdGFyaW5mbz0kbG9jYWxzWyJ0YXJpbmZvIl09Tm9uZTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjI1NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyICRub19icmVhazExNDM9dHJ1ZTt3aGlsZShib29sKFRydWUpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjU2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgJGZhaWxlZDEyMjU9ZmFsc2U7dHJ5ewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjU3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJpbmZvPSRsb2NhbHNbInRhcmluZm8iXT1nZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJ0YXJpbmZvIiksImZyb210YXJmaWxlIiksIl9fY2FsbF9fIikoc2VsZik7Tm9uZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2goJGVycjEyMjUpewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGZhaWxlZDEyMjU9dHJ1ZTtpZihmYWxzZSl7dm9pZCgwKX0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMjI1LFtFT0ZIZWFkZXJFcnJvcl0pKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlPV9fQlJZVEhPTl9fLmV4Y2VwdGlvbigkZXJyMTIyNSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyNTksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihzZWxmLCJpZ25vcmVfemVyb3MiKSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyNjAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiX2RiZyIpLCJfX2NhbGxfXyIpKE51bWJlcigyKSxnZXRhdHRyKCIweCVYOiAlcyIsIl9fbW9kX18iKSh0dXBsZShbZ2V0YXR0cihzZWxmLCJvZmZzZXQiKSxlXSkpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyNjEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJHRlbXA9JGxvY2Fsc1siJHRlbXAiXT1CTE9DS1NJWkU7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighaGFzYXR0cihnZXRhdHRyKHNlbGYsIm9mZnNldCIpLCJfX2lhZGRfXyIpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJvZmZzZXQiLGdldGF0dHIoZ2V0YXR0cihzZWxmLCJvZmZzZXQiKSwiX19hZGRfXyIpKCR0ZW1wKSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihzZWxmLCJvZmZzZXQiKT1nZXRhdHRyKGdldGF0dHIoc2VsZiwib2Zmc2V0IiksIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyNjIsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoJGlzX2V4YygkZXJyMTIyNSxbSW52YWxpZEhlYWRlckVycm9yXSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGU9X19CUllUSE9OX18uZXhjZXB0aW9uKCRlcnIxMjI1KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjI2NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKHNlbGYsImlnbm9yZV96ZXJvcyIpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjI2NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfZGJnIiksIl9fY2FsbF9fIikoTnVtYmVyKDIpLGdldGF0dHIoIjB4JVg6ICVzIiwiX19tb2RfXyIpKHR1cGxlKFtnZXRhdHRyKHNlbGYsIm9mZnNldCIpLGVdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjI2NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkdGVtcD0kbG9jYWxzWyIkdGVtcCJdPUJMT0NLU0laRTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFoYXNhdHRyKGdldGF0dHIoc2VsZiwib2Zmc2V0IiksIl9faWFkZF9fIikpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsIm9mZnNldCIsZ2V0YXR0cihnZXRhdHRyKHNlbGYsIm9mZnNldCIpLCJfX2FkZF9fIikoJHRlbXApKTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKHNlbGYsIm9mZnNldCIpPWdldGF0dHIoZ2V0YXR0cihzZWxmLCJvZmZzZXQiKSwiX19pYWRkX18iKSgkdGVtcCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjI2NywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKHNlbGYsIm9mZnNldCIpLCJfX2VxX18iKShOdW1iZXIoMCkpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjI2OSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGdldGF0dHIoUmVhZEVycm9yLCJfX2NhbGxfXyIpKGdldGF0dHIoc3RyLCJfX2NhbGxfXyIpKGUpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoJGlzX2V4YygkZXJyMTIyNSxbRW1wdHlIZWFkZXJFcnJvcl0pKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyNzEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihnZXRhdHRyKHNlbGYsIm9mZnNldCIpLCJfX2VxX18iKShOdW1iZXIoMCkpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjI3MiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGdldGF0dHIoUmVhZEVycm9yLCJfX2NhbGxfXyIpKCJlbXB0eSBmaWxlIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKCRpc19leGMoJGVycjEyMjUsW1RydW5jYXRlZEhlYWRlckVycm9yXSkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGU9X19CUllUSE9OX18uZXhjZXB0aW9uKCRlcnIxMjI1KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjI3NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKGdldGF0dHIoc2VsZiwib2Zmc2V0IiksIl9fZXFfXyIpKE51bWJlcigwKSkpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjc1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihSZWFkRXJyb3IsIl9fY2FsbF9fIikoZ2V0YXR0cihzdHIsIl9fY2FsbF9fIikoZSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMjI1LFtTdWJzZXF1ZW50SGVhZGVyRXJyb3JdKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZT1fX0JSWVRIT05fXy5leGNlcHRpb24oJGVycjEyMjUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjc3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKFJlYWRFcnJvciwiX19jYWxsX18iKShnZXRhdHRyKHN0ciwiX19jYWxsX18iKShlKSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNle3Rocm93ICRlcnIxMjI1fQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjc4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyICRub19icmVhazExNDM9ZmFsc2U7YnJlYWsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyODAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2wodGFyaW5mbyE9PU5vbmUpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjgxLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwibWVtYmVycyIpLCJhcHBlbmQiKSwiX19jYWxsX18iKSh0YXJpbmZvKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjgzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJfbG9hZGVkIixUcnVlKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjI4NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgcmV0dXJuIHRhcmluZm8KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMjI1KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTIyNSl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MubmV4dC5fX25hbWVfXz0ibmV4dCIKICAgICRjbGFzcy5uZXh0Ll9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MubmV4dC5fX2RvY19fPSJSZXR1cm4gdGhlIG5leHQgbWVtYmVyIG9mIHRoZSBhcmNoaXZlIGFzIGEgVGFySW5mbyBvYmplY3QsIHdoZW5cblwKICAgICAgICAgICBUYXJGaWxlIGlzIG9wZW5lZCBmb3IgcmVhZGluZy4gUmV0dXJuIE5vbmUgaWYgdGhlcmUgaXMgbm8gbW9yZVxuXAogICAgICAgICAgIGF2YWlsYWJsZS5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMjkwLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX2dldG1lbWJlcj0gKGZ1bmN0aW9uIChOb25lLEZhbHNlKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9nZXRtZW1iZXIiLGFyZ3VtZW50cyxbInNlbGYiLCJuYW1lIl0seyJ0YXJpbmZvIjooJGNsYXNzWyJOb25lIl0gIT09dW5kZWZpbmVkID8gJGNsYXNzWyJOb25lIl0gOiBOb25lKSwibm9ybWFsaXplIjooJGNsYXNzWyJGYWxzZSJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siRmFsc2UiXSA6IEZhbHNlKX0sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyIzeXhlMDNhaiJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjI5MSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIkZpbmQgYW4gYXJjaGl2ZSBtZW1iZXIgYnkgbmFtZSBmcm9tIGJvdHRvbSB0byB0b3AuXG5cCiAgICAgICAgICAgSWYgdGFyaW5mbyBpcyBnaXZlbiwgaXQgaXMgdXNlZCBhcyB0aGUgc3RhcnRpbmcgcG9pbnQuXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjI5NSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIG1lbWJlcnM9JGxvY2Fsc1sibWVtYmVycyJdPWdldGF0dHIoZ2V0YXR0cihzZWxmLCJnZXRtZW1iZXJzIiksIl9fY2FsbF9fIikoKTtOb25lOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjI5OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbCh0YXJpbmZvIT09Tm9uZSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIyOTksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgbWVtYmVycz0kbG9jYWxzWyJtZW1iZXJzIl09Z2V0YXR0cihtZW1iZXJzLCJfX2dldGl0ZW1fXyIpKHNsaWNlKG51bGwsZ2V0YXR0cihnZXRhdHRyKG1lbWJlcnMsImluZGV4IiksIl9fY2FsbF9fIikodGFyaW5mbykpKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjMwMSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChub3JtYWxpemUpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzAyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWU9JGxvY2Fsc1sibmFtZSJdPWdldGF0dHIoZ2V0YXR0cihnZXRhdHRyKG9zLCJwYXRoIiksIm5vcm1wYXRoIiksIl9fY2FsbF9fIikobmFtZSk7Tm9uZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzMDQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciAkbmV4dDEyMjY9Z2V0YXR0cihpdGVyKGdldGF0dHIocmV2ZXJzZWQsIl9fY2FsbF9fIikobWVtYmVycykpLCJfX25leHRfXyIpCiAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTIyNj10cnVlO3doaWxlKHRydWUpewogICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lbWJlcj0kbG9jYWxzWyJtZW1iZXIiXT0kbmV4dDEyMjYoKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyKXtpZigkaXNfZXhjKCRlcnIsW1N0b3BJdGVyYXRpb25dKSl7JHBvcF9leGMoKTticmVha31lbHNle3Rocm93KCRlcnIpfX0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzA1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChub3JtYWxpemUpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjMwNiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWVtYmVyX25hbWU9JGxvY2Fsc1sibWVtYmVyX25hbWUiXT1nZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihvcywicGF0aCIpLCJub3JtcGF0aCIpLCJfX2NhbGxfXyIpKGdldGF0dHIobWVtYmVyLCJuYW1lIikpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzMDgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lbWJlcl9uYW1lPSRsb2NhbHNbIm1lbWJlcl9uYW1lIl09Z2V0YXR0cihtZW1iZXIsIm5hbWUiKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzEwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKG5hbWUsIl9fZXFfXyIpKG1lbWJlcl9uYW1lKSkpewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzExLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtZW1iZXIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTIyNil7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjEyMjYpfQogICAgICAgIH0KICAgIH0KICAgICkoJGNsYXNzLk5vbmUgIT0gdW5kZWZpbmVkID8gJGNsYXNzLk5vbmUgOiBOb25lLCRjbGFzcy5GYWxzZSAhPSB1bmRlZmluZWQgPyAkY2xhc3MuRmFsc2UgOiBGYWxzZSkKICAgICRjbGFzcy5fZ2V0bWVtYmVyLl9fbmFtZV9fPSJfZ2V0bWVtYmVyIgogICAgJGNsYXNzLl9nZXRtZW1iZXIuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5fZ2V0bWVtYmVyLl9fZG9jX189IkZpbmQgYW4gYXJjaGl2ZSBtZW1iZXIgYnkgbmFtZSBmcm9tIGJvdHRvbSB0byB0b3AuXG5cCiAgICAgICAgICAgSWYgdGFyaW5mbyBpcyBnaXZlbiwgaXQgaXMgdXNlZCBhcyB0aGUgc3RhcnRpbmcgcG9pbnQuXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjMxMywiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLl9sb2FkPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJfbG9hZCIsYXJndW1lbnRzLFsic2VsZiJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsia3o4eHBhcGMiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzMTQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJSZWFkIHRocm91Z2ggdGhlIGVudGlyZSBhcmNoaXZlIGZpbGUgYW5kIGxvb2sgZm9yIHJlYWRhYmxlXG5cCiAgICAgICAgICAgbWVtYmVycy5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzE3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTE0ND10cnVlO3doaWxlKGJvb2woVHJ1ZSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzMTgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFyaW5mbz0kbG9jYWxzWyJ0YXJpbmZvIl09Z2V0YXR0cihnZXRhdHRyKHNlbGYsIm5leHQiKSwiX19jYWxsX18iKSgpO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjMxOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgIGlmKGJvb2wodGFyaW5mbz09PU5vbmUpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjMyMCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgJG5vX2JyZWFrMTE0ND1mYWxzZTticmVhawogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzMjEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiX2xvYWRlZCIsVHJ1ZSk7Tm9uZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMjI3KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTIyNyl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuX2xvYWQuX19uYW1lX189Il9sb2FkIgogICAgJGNsYXNzLl9sb2FkLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuX2xvYWQuX19kb2NfXz0iUmVhZCB0aHJvdWdoIHRoZSBlbnRpcmUgYXJjaGl2ZSBmaWxlIGFuZCBsb29rIGZvciByZWFkYWJsZVxuXAogICAgICAgICAgIG1lbWJlcnMuXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjMyMywiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLl9jaGVjaz0gKGZ1bmN0aW9uIChOb25lKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9jaGVjayIsYXJndW1lbnRzLFsic2VsZiJdLHsibW9kZSI6KCRjbGFzc1siTm9uZSJdICE9PXVuZGVmaW5lZCA/ICRjbGFzc1siTm9uZSJdIDogTm9uZSl9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsibjJ4N3lwdHEiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzMjQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJDaGVjayBpZiBUYXJGaWxlIGlzIHN0aWxsIG9wZW4sIGFuZCBpZiB0aGUgb3BlcmF0aW9uJ3MgbW9kZVxuXAogICAgICAgICAgIGNvcnJlc3BvbmRzIHRvIFRhckZpbGUncyBtb2RlLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzMjcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woZ2V0YXR0cihzZWxmLCJjbG9zZWQiKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzMjgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKElPRXJyb3IsIl9fY2FsbF9fIikoZ2V0YXR0cigiJXMgaXMgY2xvc2VkIiwiX19tb2RfXyIpKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJfX2NsYXNzX18iKSwiX19uYW1lX18iKSkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzI5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKCR0ZXN0X2V4cHIoJHRlc3RfaXRlbShtb2RlIT09Tm9uZSkmJiR0ZXN0X2l0ZW0oZ2V0YXR0cihnZXRhdHRyKHNlbGYsIm1vZGUiKSwiX19ub3RfaW5fXyIpKG1vZGUpKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzMwLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZ2V0YXR0cihJT0Vycm9yLCJfX2NhbGxfXyIpKGdldGF0dHIoImJhZCBvcGVyYXRpb24gZm9yIG1vZGUgJXIiLCJfX21vZF9fIikoZ2V0YXR0cihzZWxmLCJtb2RlIikpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjEyMjcpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMjI3KX0KICAgICAgICB9CiAgICB9CiAgICApKCRjbGFzcy5Ob25lICE9IHVuZGVmaW5lZCA/ICRjbGFzcy5Ob25lIDogTm9uZSkKICAgICRjbGFzcy5fY2hlY2suX19uYW1lX189Il9jaGVjayIKICAgICRjbGFzcy5fY2hlY2suX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5fY2hlY2suX19kb2NfXz0iQ2hlY2sgaWYgVGFyRmlsZSBpcyBzdGlsbCBvcGVuLCBhbmQgaWYgdGhlIG9wZXJhdGlvbidzIG1vZGVcblwKICAgICAgICAgICBjb3JyZXNwb25kcyB0byBUYXJGaWxlJ3MgbW9kZS5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzMyLCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX2ZpbmRfbGlua190YXJnZXQ9IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9maW5kX2xpbmtfdGFyZ2V0Iixhcmd1bWVudHMsWyJzZWxmIiwidGFyaW5mbyJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiam9rajlzMnUiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzMzMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJGaW5kIHRoZSB0YXJnZXQgbWVtYmVyIG9mIGEgc3ltbGluayBvciBoYXJkbGluayBtZW1iZXIgaW4gdGhlXG5cCiAgICAgICAgICAgYXJjaGl2ZS5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzM2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIoZ2V0YXR0cih0YXJpbmZvLCJpc3N5bSIpLCJfX2NhbGxfXyIpKCkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzM4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmtuYW1lPSRsb2NhbHNbImxpbmtuYW1lIl09Z2V0YXR0cihnZXRhdHRyKCIvIiwiam9pbiIpLCJfX2NhbGxfXyIpKGdldGF0dHIoZmlsdGVyLCJfX2NhbGxfXyIpKE5vbmUsdHVwbGUoW2dldGF0dHIoZ2V0YXR0cihnZXRhdHRyKG9zLCJwYXRoIiksImRpcm5hbWUiKSwiX19jYWxsX18iKShnZXRhdHRyKHRhcmluZm8sIm5hbWUiKSksZ2V0YXR0cih0YXJpbmZvLCJsaW5rbmFtZSIpXSkpKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzMzksIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgbGltaXQ9JGxvY2Fsc1sibGltaXQiXT1Ob25lO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzNDMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgbGlua25hbWU9JGxvY2Fsc1sibGlua25hbWUiXT1nZXRhdHRyKHRhcmluZm8sImxpbmtuYW1lIik7Tm9uZTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzQ0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbWl0PSRsb2NhbHNbImxpbWl0Il09dGFyaW5mbztOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjM0NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyIG1lbWJlcj0kbG9jYWxzWyJtZW1iZXIiXT1nZXRhdHRyKGdldGF0dHIoc2VsZiwiX2dldG1lbWJlciIpLCJfX2NhbGxfXyIpKGxpbmtuYW1lLCRLdygidGFyaW5mbyIsbGltaXQpLCRLdygibm9ybWFsaXplIixUcnVlKSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzNDcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2wobWVtYmVyPT09Tm9uZSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzNDgsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBnZXRhdHRyKEtleUVycm9yLCJfX2NhbGxfXyIpKGdldGF0dHIoImxpbmtuYW1lICVyIG5vdCBmb3VuZCIsIl9fbW9kX18iKShsaW5rbmFtZSkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzQ5LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gbWVtYmVyCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTIyNyl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjEyMjcpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9maW5kX2xpbmtfdGFyZ2V0Ll9fbmFtZV9fPSJfZmluZF9saW5rX3RhcmdldCIKICAgICRjbGFzcy5fZmluZF9saW5rX3RhcmdldC5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9maW5kX2xpbmtfdGFyZ2V0Ll9fZG9jX189IkZpbmQgdGhlIHRhcmdldCBtZW1iZXIgb2YgYSBzeW1saW5rIG9yIGhhcmRsaW5rIG1lbWJlciBpbiB0aGVcblwKICAgICAgICAgICBhcmNoaXZlLlxuXAogICAgICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzNTEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5fX2l0ZXJfXz0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiX19pdGVyX18iLGFyZ3VtZW50cyxbInNlbGYiXSx7fSxudWxsLG51bGwpCiAgICAgICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgICAgIHZhciAkbG9jYWxzID0gX19CUllUSE9OX18uc2NvcGVbImI0ZXNqa3ZlIl0uX19kaWN0X189JG5zCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzUyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAiUHJvdmlkZSBhbiBpdGVyYXRvciBvYmplY3QuXG5cCiAgICAgICAgIgogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjM1NCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbChnZXRhdHRyKHNlbGYsIl9sb2FkZWQiKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzNTUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0YXR0cihpdGVyLCJfX2NhbGxfXyIpKGdldGF0dHIoc2VsZiwibWVtYmVycyIpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzU3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoVGFySXRlciwiX19jYWxsX18iKShzZWxmKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjEyMjcpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMjI3KX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5fX2l0ZXJfXy5fX25hbWVfXz0iX19pdGVyX18iCiAgICAkY2xhc3MuX19pdGVyX18uX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5fX2l0ZXJfXy5fX2RvY19fPSJQcm92aWRlIGFuIGl0ZXJhdG9yIG9iamVjdC5cblwKICAgICAgICAiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzU5LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX2RiZz0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiX2RiZyIsYXJndW1lbnRzLFsic2VsZiIsImxldmVsIiwibXNnIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyI1MjJ2eWluYSJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjM2MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIldyaXRlIGRlYnVnZ2luZyBvdXRwdXQgdG8gc3lzLnN0ZGVyci5cblwKICAgICAgICAiCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzYyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBpZihib29sKGdldGF0dHIobGV2ZWwsIl9fbGVfXyIpKGdldGF0dHIoc2VsZiwiZGVidWciKSkpKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzYzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgZ2V0YXR0cigkcHJpbnQsIl9fY2FsbF9fIikobXNnLCRLdygiZmlsZSIsZ2V0YXR0cihzeXMsInN0ZGVyciIpKSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMjI3KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTIyNyl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuX2RiZy5fX25hbWVfXz0iX2RiZyIKICAgICRjbGFzcy5fZGJnLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuX2RiZy5fX2RvY19fPSJXcml0ZSBkZWJ1Z2dpbmcgb3V0cHV0IHRvIHN5cy5zdGRlcnIuXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjM2NSwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLl9fZW50ZXJfXz0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiX19lbnRlcl9fIixhcmd1bWVudHMsWyJzZWxmIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJlaW9xcHdpNCJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjM2NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgZ2V0YXR0cihnZXRhdHRyKHNlbGYsIl9jaGVjayIpLCJfX2NhbGxfXyIpKCkKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzNjcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTIyNyl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjEyMjcpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9fZW50ZXJfXy5fX25hbWVfXz0iX19lbnRlcl9fIgogICAgJGNsYXNzLl9fZW50ZXJfXy5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9fZW50ZXJfXy5fX2RvY19fPSIiCiAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzY5LCJfX21haW5fXyJdO05vbmU7CiAgICAkY2xhc3MuX19leGl0X189IChmdW5jdGlvbiAoKXsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgdmFyICRucz0kTWFrZUFyZ3MoIl9fZXhpdF9fIixhcmd1bWVudHMsWyJzZWxmIiwidHlwZSIsInZhbHVlIiwidHJhY2ViYWNrIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJ2MHFxM3Q2YyJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjM3MCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgaWYoYm9vbCh0eXBlPT09Tm9uZSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzNzEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoc2VsZiwiY2xvc2UiKSwiX19jYWxsX18iKSgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzNzUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZihib29sKCFib29sKGdldGF0dHIoc2VsZiwiX2V4dGZpbGVvYmoiKSkpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjM3NiwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIoZ2V0YXR0cihzZWxmLCJmaWxlb2JqIiksImNsb3NlIiksIl9fY2FsbF9fIikoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyMzc3LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCJjbG9zZWQiLFRydWUpO05vbmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTIyNyl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjEyMjcpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9fZXhpdF9fLl9fbmFtZV9fPSJfX2V4aXRfXyIKICAgICRjbGFzcy5fX2V4aXRfXy5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9fZXhpdF9fLl9fZG9jX189IiIKICAgIHJldHVybiAkY2xhc3MKfQopKCkKJFRhckZpbGUuX19kb2NfXz0iVGhlIFRhckZpbGUgQ2xhc3MgcHJvdmlkZXMgYW4gaW50ZXJmYWNlIHRvIHRhciBhcmNoaXZlcy5cblwKICAgICIKJFRhckZpbGUuX19tb2R1bGVfXz0iX19tYWluX18iCnZhciBUYXJGaWxlPSRjbGFzc19jb25zdHJ1Y3RvcigiVGFyRmlsZSIsJFRhckZpbGUsb2JqZWN0KQp3aW5kb3cuVGFyRmlsZT1UYXJGaWxlCl9fQlJZVEhPTl9fLnNjb3BlWyJfX21haW5fXyJdLl9fZGljdF9fWyJUYXJGaWxlIl09VGFyRmlsZQpkb2N1bWVudC4kbGluZV9pbmZvPVsyMzgwLCJfX21haW5fXyJdO05vbmU7CnZhciAkVGFySXRlcj0oZnVuY3Rpb24oKXsKICAgIHZhciAkY2xhc3MgPSBuZXcgT2JqZWN0KCkKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzODEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICJJdGVyYXRvciBDbGFzcy5cblwKXG5cCiAgICAgICBmb3IgdGFyaW5mbyBpbiBUYXJGaWxlKC4uLik6XG5cCiAgICAgICAgICAgc3VpdGUuLi5cblwKICAgICIKICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzODcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICRjbGFzcy5fX2luaXRfXz0gKGZ1bmN0aW9uICgpewogICAgICAgIHJldHVybiBmdW5jdGlvbigpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB2YXIgJG5zPSRNYWtlQXJncygiX19pbml0X18iLGFyZ3VtZW50cyxbInNlbGYiLCJ0YXJmaWxlIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICAgICAgZm9yKCR2YXIgaW4gJG5zKXtldmFsKCJ2YXIgIiskdmFyKyI9JG5zWyR2YXJdIil9CiAgICAgICAgICAgICAgICB2YXIgJGxvY2FscyA9IF9fQlJZVEhPTl9fLnNjb3BlWyJjbmpzMXFoZSJdLl9fZGljdF9fPSRucwogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjM4OCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgIkNvbnN0cnVjdCBhIFRhckl0ZXIgb2JqZWN0LlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzOTAsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwidGFyZmlsZSIsdGFyZmlsZSk7Tm9uZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzOTEsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiaW5kZXgiLE51bWJlcigwKSk7Tm9uZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaChlcnIxMjI3KXt0aHJvdyBfX0JSWVRIT05fXy5leGNlcHRpb24oZXJyMTIyNyl9CiAgICAgICAgfQogICAgfQogICAgKSgpCiAgICAkY2xhc3MuX19pbml0X18uX19uYW1lX189Il9faW5pdF9fIgogICAgJGNsYXNzLl9faW5pdF9fLl9fbW9kdWxlX18gPSAiX19tYWluX18iCiAgICAkY2xhc3MuX19pbml0X18uX19kb2NfXz0iQ29uc3RydWN0IGEgVGFySXRlciBvYmplY3QuXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjM5MiwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLl9faXRlcl9fPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJfX2l0ZXJfXyIsYXJndW1lbnRzLFsic2VsZiJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiNWN6OW41NDQiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzOTMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJSZXR1cm4gaXRlcmF0b3Igb2JqZWN0LlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzOTUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2goZXJyMTIyNyl7dGhyb3cgX19CUllUSE9OX18uZXhjZXB0aW9uKGVycjEyMjcpfQogICAgICAgIH0KICAgIH0KICAgICkoKQogICAgJGNsYXNzLl9faXRlcl9fLl9fbmFtZV9fPSJfX2l0ZXJfXyIKICAgICRjbGFzcy5fX2l0ZXJfXy5fX21vZHVsZV9fID0gIl9fbWFpbl9fIgogICAgJGNsYXNzLl9faXRlcl9fLl9fZG9jX189IlJldHVybiBpdGVyYXRvciBvYmplY3QuXG5cCiAgICAgICAgIgogICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjM5NiwiX19tYWluX18iXTtOb25lOwogICAgJGNsYXNzLl9fbmV4dF9fPSAoZnVuY3Rpb24gKCl7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJfX25leHRfXyIsYXJndW1lbnRzLFsic2VsZiJdLHt9LG51bGwsbnVsbCkKICAgICAgICAgICAgICAgIGZvcigkdmFyIGluICRucyl7ZXZhbCgidmFyICIrJHZhcisiPSRuc1skdmFyXSIpfQogICAgICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiOTVmdTB4c20iXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzIzOTcsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICJSZXR1cm4gdGhlIG5leHQgaXRlbSB1c2luZyBUYXJGaWxlJ3MgbmV4dCgpIG1ldGhvZC5cblwKICAgICAgICAgICBXaGVuIGFsbCBtZW1iZXJzIGhhdmUgYmVlbiByZWFkLCBzZXQgVGFyRmlsZSBhcyBfbG9hZGVkLlxuXAogICAgICAgICIKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzI0MDMsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIGlmKGJvb2woIWJvb2woZ2V0YXR0cihnZXRhdHRyKHNlbGYsInRhcmZpbGUiKSwiX2xvYWRlZCIpKSkpewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzI0MDQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFyaW5mbz0kbG9jYWxzWyJ0YXJpbmZvIl09Z2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwidGFyZmlsZSIpLCJuZXh0IiksIl9fY2FsbF9fIikoKTtOb25lOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzI0MDUsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICBpZihib29sKCFib29sKHRhcmluZm8pKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzI0MDYsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0YXR0cihnZXRhdHRyKHNlbGYsInRhcmZpbGUiKSwiX2xvYWRlZCIsVHJ1ZSk7Tm9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjQwNywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBTdG9wSXRlcmF0aW9uKCIiKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjQwOSwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICRmYWlsZWQxMjI3PWZhbHNlO3RyeXsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjQxMCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyaW5mbz0kbG9jYWxzWyJ0YXJpbmZvIl09Z2V0YXR0cihnZXRhdHRyKGdldGF0dHIoc2VsZiwidGFyZmlsZSIpLCJtZW1iZXJzIiksIl9fZ2V0aXRlbV9fIikoZ2V0YXR0cihzZWxmLCJpbmRleCIpKTtOb25lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXRjaCgkZXJyMTIyNyl7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZmFpbGVkMTIyNz10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKCRpc19leGMoJGVycjEyMjcsW0luZGV4RXJyb3JdKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyNDEyLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBTdG9wSXRlcmF0aW9uKCIiKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7dGhyb3cgJGVycjEyMjd9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjQxMywiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAgICAgdmFyICR0ZW1wPSRsb2NhbHNbIiR0ZW1wIl09TnVtYmVyKDEpO05vbmU7CiAgICAgICAgICAgICAgICBpZighaGFzYXR0cihnZXRhdHRyKHNlbGYsImluZGV4IiksIl9faWFkZF9fIikpewogICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwiaW5kZXgiLGdldGF0dHIoZ2V0YXR0cihzZWxmLCJpbmRleCIpLCJfX2FkZF9fIikoJHRlbXApKTtOb25lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKHNlbGYsImluZGV4Iik9Z2V0YXR0cihnZXRhdHRyKHNlbGYsImluZGV4IiksIl9faWFkZF9fIikoJHRlbXApCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyNDE0LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gdGFyaW5mbwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKGVycjEyMjcpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMjI3KX0KICAgICAgICB9CiAgICB9CiAgICApKCkKICAgICRjbGFzcy5fX25leHRfXy5fX25hbWVfXz0iX19uZXh0X18iCiAgICAkY2xhc3MuX19uZXh0X18uX19tb2R1bGVfXyA9ICJfX21haW5fXyIKICAgICRjbGFzcy5fX25leHRfXy5fX2RvY19fPSJSZXR1cm4gdGhlIG5leHQgaXRlbSB1c2luZyBUYXJGaWxlJ3MgbmV4dCgpIG1ldGhvZC5cblwKICAgICAgICAgICBXaGVuIGFsbCBtZW1iZXJzIGhhdmUgYmVlbiByZWFkLCBzZXQgVGFyRmlsZSBhcyBfbG9hZGVkLlxuXAogICAgICAgICIKICAgIHJldHVybiAkY2xhc3MKfQopKCkKJFRhckl0ZXIuX19kb2NfXz0iSXRlcmF0b3IgQ2xhc3MuXG5cClxuXAogICAgICAgZm9yIHRhcmluZm8gaW4gVGFyRmlsZSguLi4pOlxuXAogICAgICAgICAgIHN1aXRlLi4uXG5cCiAgICAiCiRUYXJJdGVyLl9fbW9kdWxlX189Il9fbWFpbl9fIgp2YXIgVGFySXRlcj0kY2xhc3NfY29uc3RydWN0b3IoIlRhckl0ZXIiLCRUYXJJdGVyKQp3aW5kb3cuVGFySXRlcj1UYXJJdGVyCl9fQlJZVEhPTl9fLnNjb3BlWyJfX21haW5fXyJdLl9fZGljdF9fWyJUYXJJdGVyIl09VGFySXRlcgpkb2N1bWVudC4kbGluZV9pbmZvPVsyNDE5LCJfX21haW5fXyJdO05vbmU7CnZhciBpc190YXJmaWxlPSAoZnVuY3Rpb24gKCl7CiAgICByZXR1cm4gZnVuY3Rpb24oKXsKICAgICAgICB0cnl7CiAgICAgICAgICAgIHZhciAkbnM9JE1ha2VBcmdzKCJpc190YXJmaWxlIixhcmd1bWVudHMsWyJuYW1lIl0se30sbnVsbCxudWxsKQogICAgICAgICAgICBmb3IoJHZhciBpbiAkbnMpe2V2YWwoInZhciAiKyR2YXIrIj0kbnNbJHZhcl0iKX0KICAgICAgICAgICAgdmFyICRsb2NhbHMgPSBfX0JSWVRIT05fXy5zY29wZVsiMWQwaHZ2NTMiXS5fX2RpY3RfXz0kbnMKICAgICAgICAgICAgZG9jdW1lbnQuJGxpbmVfaW5mbz1bMjQyMCwiX19tYWluX18iXTtOb25lOwogICAgICAgICAgICAiUmV0dXJuIFRydWUgaWYgbmFtZSBwb2ludHMgdG8gYSB0YXIgYXJjaGl2ZSB0aGF0IHdlXG5cCiAgICAgICBhcmUgYWJsZSB0byBoYW5kbGUsIGVsc2UgcmV0dXJuIEZhbHNlLlxuXAogICAgIgogICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyNDIzLCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICRmYWlsZWQxMjI4PWZhbHNlO3RyeXsKICAgICAgICAgICAgICAgIGRvY3VtZW50LiRsaW5lX2luZm89WzI0MjQsIl9fbWFpbl9fIl07Tm9uZTsKICAgICAgICAgICAgICAgIHZhciB0PSRsb2NhbHNbInQiXT1nZXRhdHRyKCRvcGVuLCJfX2NhbGxfXyIpKG5hbWUpO05vbmU7CiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyNDI1LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICBnZXRhdHRyKGdldGF0dHIodCwiY2xvc2UiKSwiX19jYWxsX18iKSgpCiAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyNDI2LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoKCRlcnIxMjI4KXsKICAgICAgICAgICAgICAgIHZhciAkZmFpbGVkMTIyOD10cnVlO2lmKGZhbHNlKXt2b2lkKDApfQogICAgICAgICAgICAgICAgZWxzZSBpZigkaXNfZXhjKCRlcnIxMjI4LFtUYXJFcnJvcl0pKXsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC4kbGluZV9pbmZvPVsyNDI4LCJfX21haW5fXyJdO05vbmU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNle3Rocm93ICRlcnIxMjI4fQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNhdGNoKGVycjEyMjgpe3Rocm93IF9fQlJZVEhPTl9fLmV4Y2VwdGlvbihlcnIxMjI4KX0KICAgIH0KfQopKCkKaXNfdGFyZmlsZS5fX25hbWVfXz0iaXNfdGFyZmlsZSIKd2luZG93LmlzX3RhcmZpbGU9aXNfdGFyZmlsZQokZ2xvYmFsc1siaXNfdGFyZmlsZSJdPWlzX3RhcmZpbGU7aXNfdGFyZmlsZS4kdHlwZT0nZnVuY3Rpb24nCmlzX3RhcmZpbGUuX19tb2R1bGVfXyA9ICJfX21haW5fXyIKaXNfdGFyZmlsZS5fX2RvY19fPSJSZXR1cm4gVHJ1ZSBpZiBuYW1lIHBvaW50cyB0byBhIHRhciBhcmNoaXZlIHRoYXQgd2VcblwKICAgICAgIGFyZSBhYmxlIHRvIGhhbmRsZSwgZWxzZSByZXR1cm4gRmFsc2UuXG5cCiAgICAiCmRvY3VtZW50LiRsaW5lX2luZm89WzI0MzAsIl9fbWFpbl9fIl07Tm9uZTsKYmx0bl9vcGVuPSRnbG9iYWxzWyJibHRuX29wZW4iXT0kb3BlbjtOb25lOwpkb2N1bWVudC4kbGluZV9pbmZvPVsyNDMxLCJfX21haW5fXyJdO05vbmU7CiRvcGVuPWdldGF0dHIoVGFyRmlsZSwib3BlbiIpO05vbmU7Cg==',
'/Lib/module1.py':'IiIibGlicmFkb3MgUHl0aG9uIGN0eXBlcyB3cmFwcGVyCkNvcHlyaWdodCAyMDExLCBIYW5udSBWYWx0b25lbiA8aGFubnUudmFsdG9uZW5Ab3Jtb2QuY29tPgoiIiIKZnJvbSBjdHlwZXMgaW1wb3J0IENETEwsIGNfY2hhcl9wLCBjX3NpemVfdCwgY192b2lkX3AsIGNfaW50LCBjX2xvbmcsIFwKICAgIGNyZWF0ZV9zdHJpbmdfYnVmZmVyLCBieXJlZiwgU3RydWN0dXJlLCBjX3VpbnQ2NCwgY191Ynl0ZSwgcG9pbnRlciwgXAogICAgQ0ZVTkNUWVBFCmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IGN0eXBlcwppbXBvcnQgZXJybm8KaW1wb3J0IHRpbWUKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUKCkFOT05ZTU9VU19BVUlEID0gMHhmZmZmZmZmZmZmZmZmZmZmCkFETUlOX0FVSUQgPSAwCgpjbGFzcyBFcnJvcihFeGNlcHRpb24pOgogICAgcGFzcwoKY2xhc3MgUGVybWlzc2lvbkVycm9yKEVycm9yKToKICAgIHBhc3MKCmNsYXNzIE9iamVjdE5vdEZvdW5kKEVycm9yKToKICAgIHBhc3MKCmNsYXNzIE5vRGF0YShFcnJvcik6CiAgICBwYXNzCgpjbGFzcyBPYmplY3RFeGlzdHMoRXJyb3IpOgogICAgcGFzcwoKY2xhc3MgSU9FcnJvcihFcnJvcik6CiAgICBwYXNzCgpjbGFzcyBOb1NwYWNlKEVycm9yKToKICAgIHBhc3MKCmNsYXNzIEluY29tcGxldGVXcml0ZUVycm9yKEVycm9yKToKICAgIHBhc3MKCmNsYXNzIFJhZG9zU3RhdGVFcnJvcihFcnJvcik6CiAgICBwYXNzCgpjbGFzcyBJb2N0eFN0YXRlRXJyb3IoRXJyb3IpOgogICAgcGFzcwoKY2xhc3MgT2JqZWN0U3RhdGVFcnJvcihFcnJvcik6CiAgICBwYXNzCgpjbGFzcyBMb2dpY0Vycm9yKEVycm9yKToKICAgIHBhc3MKCmRlZiBtYWtlX2V4KHJldCwgbXNnKToKICAgIHJldCA9IGFicyhyZXQpCiAgICBpZiAocmV0ID09IGVycm5vLkVQRVJNKToKICAgICAgICByZXR1cm4gUGVybWlzc2lvbkVycm9yKG1zZykKICAgIGVsaWYgKHJldCA9PSBlcnJuby5FTk9FTlQpOgogICAgICAgIHJldHVybiBPYmplY3ROb3RGb3VuZChtc2cpCiAgICBlbGlmIChyZXQgPT0gZXJybm8uRUlPKToKICAgICAgICByZXR1cm4gSU9FcnJvcihtc2cpCiAgICBlbGlmIChyZXQgPT0gZXJybm8uRU5PU1BDKToKICAgICAgICByZXR1cm4gTm9TcGFjZShtc2cpCiAgICBlbGlmIChyZXQgPT0gZXJybm8uRUVYSVNUKToKICAgICAgICByZXR1cm4gT2JqZWN0RXhpc3RzKG1zZykKICAgIGVsaWYgKHJldCA9PSBlcnJuby5FTk9EQVRBKToKICAgICAgICByZXR1cm4gTm9EYXRhKG1zZykKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIEVycm9yKG1zZyArICgiOiBlcnJvciBjb2RlICVkIiAlIHJldCkpCgpjbGFzcyByYWRvc19wb29sX3N0YXRfdChTdHJ1Y3R1cmUpOgogICAgX2ZpZWxkc18gPSBbKCJudW1fYnl0ZXMiLCBjX3VpbnQ2NCksCiAgICAgICAgICAgICAgICAoIm51bV9rYiIsIGNfdWludDY0KSwKICAgICAgICAgICAgICAgICgibnVtX29iamVjdHMiLCBjX3VpbnQ2NCksCiAgICAgICAgICAgICAgICAoIm51bV9vYmplY3RfY2xvbmVzIiwgY191aW50NjQpLAogICAgICAgICAgICAgICAgKCJudW1fb2JqZWN0X2NvcGllcyIsIGNfdWludDY0KSwKICAgICAgICAgICAgICAgICgibnVtX29iamVjdHNfbWlzc2luZ19vbl9wcmltYXJ5IiwgY191aW50NjQpLAogICAgICAgICAgICAgICAgKCJudW1fb2JqZWN0c191bmZvdW5kIiwgY191aW50NjQpLAogICAgICAgICAgICAgICAgKCJudW1fb2JqZWN0c19kZWdyYWRlZCIsIGNfdWludDY0KSwKICAgICAgICAgICAgICAgICgibnVtX3JkIiwgY191aW50NjQpLAogICAgICAgICAgICAgICAgKCJudW1fcmRfa2IiLCBjX3VpbnQ2NCksCiAgICAgICAgICAgICAgICAoIm51bV93ciIsIGNfdWludDY0KSwKICAgICAgICAgICAgICAgICgibnVtX3dyX2tiIiwgY191aW50NjQpXQoKY2xhc3MgVmVyc2lvbihvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG1ham9yLCBtaW5vciwgZXh0cmEpOgogICAgICAgIHNlbGYubWFqb3IgPSBtYWpvcgogICAgICAgIHNlbGYubWlub3IgPSBtaW5vcgogICAgICAgIHNlbGYuZXh0cmEgPSBleHRyYQoKICAgIGRlZiBfX3N0cl9fKHNlbGYpOgogICAgICAgIHJldHVybiAiJWQuJWQuJWQiICUgKHNlbGYubWFqb3IsIHNlbGYubWlub3IsIHNlbGYuZXh0cmEpCgpjbGFzcyBSYWRvcyhvYmplY3QpOgogICAgIiIibGlicmFkb3MgcHl0aG9uIHdyYXBwZXIiIiIKICAgIGRlZiByZXF1aXJlX3N0YXRlKHNlbGYsICphcmdzKToKICAgICAgICBmb3IgYSBpbiBhcmdzOgogICAgICAgICAgICBpZiBzZWxmLnN0YXRlID09IGE6CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICByYWlzZSBSYWRvc1N0YXRlRXJyb3IoIllvdSBjYW5ub3QgcGVyZm9ybSB0aGF0IG9wZXJhdGlvbiBvbiBhIFwKUmFkb3Mgb2JqZWN0IGluIHN0YXRlICVzLiIgJSAoc2VsZi5zdGF0ZSkpCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHJhZG9zX2lkPU5vbmUsIGNvbmY9Tm9uZSwgY29uZmZpbGU9Tm9uZSk6CiAgICAgICAgc2VsZi5saWJyYWRvcyA9IENETEwoJ2xpYnJhZG9zLnNvLjInKQogICAgICAgIHNlbGYuY2x1c3RlciA9IGNfdm9pZF9wKCkKICAgICAgICBpZiByYWRvc19pZCBpcyBub3QgTm9uZSBhbmQgbm90IGlzaW5zdGFuY2UocmFkb3NfaWQsIHN0cik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigncmFkb3NfaWQgbXVzdCBiZSBhIHN0cmluZyBvciBOb25lJykKICAgICAgICBpZiBjb25mZmlsZSBpcyBub3QgTm9uZSBhbmQgbm90IGlzaW5zdGFuY2UoY29uZmZpbGUsIHN0cik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcignY29uZmZpbGUgbXVzdCBiZSBhIHN0cmluZyBvciBOb25lJykKICAgICAgICByZXQgPSBzZWxmLmxpYnJhZG9zLnJhZG9zX2NyZWF0ZShieXJlZihzZWxmLmNsdXN0ZXIpLCBjX2NoYXJfcChyYWRvc19pZCkpCiAgICAgICAgaWYgcmV0ICE9IDA6CiAgICAgICAgICAgIHJhaXNlIEVycm9yKCJyYWRvc19pbml0aWFsaXplIGZhaWxlZCB3aXRoIGVycm9yIGNvZGU6ICVkIiAlIHJldCkKICAgICAgICBzZWxmLnN0YXRlID0gImNvbmZpZ3VyaW5nIgogICAgICAgIGlmIGNvbmZmaWxlIGlzIG5vdCBOb25lOgogICAgICAgICAgICAjIHJlYWQgdGhlIGRlZmF1bHQgY29uZiBmaWxlIHdoZW4gJycgaXMgZ2l2ZW4KICAgICAgICAgICAgaWYgY29uZmZpbGUgPT0gJyc6CiAgICAgICAgICAgICAgICBjb25mZmlsZSA9IE5vbmUKICAgICAgICAgICAgc2VsZi5jb25mX3JlYWRfZmlsZShjb25mZmlsZSkKICAgICAgICBpZiBjb25mIGlzIG5vdCBOb25lOgogICAgICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBjb25mLml0ZXJpdGVtcygpOgogICAgICAgICAgICAgICAgc2VsZi5jb25mX3NldChrZXksIHZhbHVlKQoKICAgIGRlZiBzaHV0ZG93bihzZWxmKToKICAgICAgICBpZiAoc2VsZi5fX2RpY3RfXy5oYXNfa2V5KCJzdGF0ZSIpIGFuZCBzZWxmLnN0YXRlICE9ICJzaHV0ZG93biIpOgogICAgICAgICAgICBzZWxmLmxpYnJhZG9zLnJhZG9zX3NodXRkb3duKHNlbGYuY2x1c3RlcikKICAgICAgICAgICAgc2VsZi5zdGF0ZSA9ICJzaHV0ZG93biIKCiAgICBkZWYgX19lbnRlcl9fKHNlbGYpOgogICAgICAgIHNlbGYuY29ubmVjdCgpCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19leGl0X18oc2VsZiwgdHlwZV8sIHZhbHVlLCB0cmFjZWJhY2spOgogICAgICAgIHNlbGYuc2h1dGRvd24oKQogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBfX2RlbF9fKHNlbGYpOgogICAgICAgIHNlbGYuc2h1dGRvd24oKQoKICAgIGRlZiB2ZXJzaW9uKHNlbGYpOgogICAgICAgIG1ham9yID0gY19pbnQoMCkKICAgICAgICBtaW5vciA9IGNfaW50KDApCiAgICAgICAgZXh0cmEgPSBjX2ludCgwKQogICAgICAgIHNlbGYubGlicmFkb3MucmFkb3NfdmVyc2lvbihieXJlZihtYWpvciksIGJ5cmVmKG1pbm9yKSwgYnlyZWYoZXh0cmEpKQogICAgICAgIHJldHVybiBWZXJzaW9uKG1ham9yLnZhbHVlLCBtaW5vci52YWx1ZSwgZXh0cmEudmFsdWUpCgogICAgZGVmIGNvbmZfcmVhZF9maWxlKHNlbGYsIHBhdGg9Tm9uZSk6CiAgICAgICAgc2VsZi5yZXF1aXJlX3N0YXRlKCJjb25maWd1cmluZyIsICJjb25uZWN0ZWQiKQogICAgICAgIGlmIHBhdGggaXMgbm90IE5vbmUgYW5kIG5vdCBpc2luc3RhbmNlKHBhdGgsIHN0cik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigncGF0aCBtdXN0IGJlIGEgc3RyaW5nJykKICAgICAgICByZXQgPSBzZWxmLmxpYnJhZG9zLnJhZG9zX2NvbmZfcmVhZF9maWxlKHNlbGYuY2x1c3RlciwgY19jaGFyX3AocGF0aCkpCiAgICAgICAgaWYgKHJldCAhPSAwKToKICAgICAgICAgICAgcmFpc2UgbWFrZV9leChyZXQsICJlcnJvciBjYWxsaW5nIGNvbmZfcmVhZF9maWxlIikKCiAgICBkZWYgY29uZl9nZXQoc2VsZiwgb3B0aW9uKToKICAgICAgICBzZWxmLnJlcXVpcmVfc3RhdGUoImNvbmZpZ3VyaW5nIiwgImNvbm5lY3RlZCIpCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3B0aW9uLCBzdHIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ29wdGlvbiBtdXN0IGJlIGEgc3RyaW5nJykKICAgICAgICBsZW5ndGggPSAyMAogICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgIHJldF9idWYgPSBjcmVhdGVfc3RyaW5nX2J1ZmZlcihsZW5ndGgpCiAgICAgICAgICAgIHJldCA9IHNlbGYubGlicmFkb3MucmFkb3NfY29uZl9nZXQoc2VsZi5jbHVzdGVyLCBvcHRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldF9idWYsIGNfc2l6ZV90KGxlbmd0aCkpCiAgICAgICAgICAgIGlmIChyZXQgPT0gMCk6CiAgICAgICAgICAgICAgICByZXR1cm4gcmV0X2J1Zi52YWx1ZQogICAgICAgICAgICBlbGlmIChyZXQgPT0gLWVycm5vLkVOQU1FVE9PTE9ORyk6CiAgICAgICAgICAgICAgICBsZW5ndGggPSBsZW5ndGggKiAyCiAgICAgICAgICAgIGVsaWYgKHJldCA9PSAtZXJybm8uRU5PRU5UKToKICAgICAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZSBtYWtlX2V4KHJldCwgImVycm9yIGNhbGxpbmcgY29uZl9nZXQiKQoKICAgIGRlZiBjb25mX3NldChzZWxmLCBvcHRpb24sIHZhbCk6CiAgICAgICAgc2VsZi5yZXF1aXJlX3N0YXRlKCJjb25maWd1cmluZyIsICJjb25uZWN0ZWQiKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG9wdGlvbiwgc3RyKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdvcHRpb24gbXVzdCBiZSBhIHN0cmluZycpCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UodmFsLCBzdHIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ3ZhbCBtdXN0IGJlIGEgc3RyaW5nJykKICAgICAgICByZXQgPSBzZWxmLmxpYnJhZG9zLnJhZG9zX2NvbmZfc2V0KHNlbGYuY2x1c3RlciwgY19jaGFyX3Aob3B0aW9uKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjX2NoYXJfcCh2YWwpKQogICAgICAgIGlmIChyZXQgIT0gMCk6CiAgICAgICAgICAgIHJhaXNlIG1ha2VfZXgocmV0LCAiZXJyb3IgY2FsbGluZyBjb25mX3NldCIpCgogICAgZGVmIGNvbm5lY3Qoc2VsZik6CiAgICAgICAgc2VsZi5yZXF1aXJlX3N0YXRlKCJjb25maWd1cmluZyIpCiAgICAgICAgcmV0ID0gc2VsZi5saWJyYWRvcy5yYWRvc19jb25uZWN0KHNlbGYuY2x1c3RlcikKICAgICAgICBpZiAocmV0ICE9IDApOgogICAgICAgICAgICByYWlzZSBtYWtlX2V4KHJldCwgImVycm9yIGNhbGxpbmcgY29ubmVjdCIpCiAgICAgICAgc2VsZi5zdGF0ZSA9ICJjb25uZWN0ZWQiCgogICAgIyBSZXR1cm5zIHRydWUgaWYgdGhlIHBvb2wgZXhpc3RzOyBmYWxzZSBvdGhlcndpc2UuCiAgICBkZWYgcG9vbF9leGlzdHMoc2VsZiwgcG9vbF9uYW1lKToKICAgICAgICBzZWxmLnJlcXVpcmVfc3RhdGUoImNvbm5lY3RlZCIpCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UocG9vbF9uYW1lLCBzdHIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ3Bvb2xfbmFtZSBtdXN0IGJlIGEgc3RyaW5nJykKICAgICAgICByZXQgPSBzZWxmLmxpYnJhZG9zLnJhZG9zX3Bvb2xfbG9va3VwKHNlbGYuY2x1c3RlciwgY19jaGFyX3AocG9vbF9uYW1lKSkKICAgICAgICBpZiAocmV0ID49IDApOgogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIGVsaWYgKHJldCA9PSAtZXJybm8uRU5PRU5UKToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgbWFrZV9leChyZXQsICJlcnJvciBsb29raW5nIHVwIHBvb2wgJyVzJyIgJSBwb29sX25hbWUpCgogICAgZGVmIGNyZWF0ZV9wb29sKHNlbGYsIHBvb2xfbmFtZSwgYXVpZD1Ob25lLCBjcnVzaF9ydWxlPU5vbmUpOgogICAgICAgIHNlbGYucmVxdWlyZV9zdGF0ZSgiY29ubmVjdGVkIikKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShwb29sX25hbWUsIHN0cik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigncG9vbF9uYW1lIG11c3QgYmUgYSBzdHJpbmcnKQogICAgICAgIGlmIGNydXNoX3J1bGUgaXMgbm90IE5vbmUgYW5kIG5vdCBpc2luc3RhbmNlKGNydXNoX3J1bGUsIHN0cik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcignY3J1c2VfcnVsZSBtdXN0IGJlIGEgc3RyaW5nJykKICAgICAgICBpZiAoYXVpZCA9PSBOb25lKToKICAgICAgICAgICAgaWYgKGNydXNoX3J1bGUgPT0gTm9uZSk6CiAgICAgICAgICAgICAgICByZXQgPSBzZWxmLmxpYnJhZG9zLnJhZG9zX3Bvb2xfY3JlYXRlKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jbHVzdGVyLCBjX2NoYXJfcChwb29sX25hbWUpKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmV0ID0gc2VsZi5saWJyYWRvcy5yYWRvc19wb29sX2NyZWF0ZV93aXRoX2FsbCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY2x1c3RlciwgY19jaGFyX3AocG9vbF9uYW1lKSwgY191aW50NjQoYXVpZCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjX3VieXRlKGNydXNoX3J1bGUpKQogICAgICAgIGVsaWYgKGNydXNoX3J1bGUgPT0gTm9uZSk6CiAgICAgICAgICAgIHJldCA9IHNlbGYubGlicmFkb3MucmFkb3NfcG9vbF9jcmVhdGVfd2l0aF9hdWlkKAogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNsdXN0ZXIsIGNfY2hhcl9wKHBvb2xfbmFtZSksIGNfdWludDY0KGF1aWQpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldCA9IHNlbGYubGlicmFkb3MucmFkb3NfcG9vbF9jcmVhdGVfd2l0aF9jcnVzaF9ydWxlKAogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNsdXN0ZXIsIGNfY2hhcl9wKHBvb2xfbmFtZSksIGNfdWJ5dGUoY3J1c2hfcnVsZSkpCiAgICAgICAgaWYgcmV0IDwgMDoKICAgICAgICAgICAgcmFpc2UgbWFrZV9leChyZXQsICJlcnJvciBjcmVhdGluZyBwb29sICclcyciICUgcG9vbF9uYW1lKQoKICAgIGRlZiBkZWxldGVfcG9vbChzZWxmLCBwb29sX25hbWUpOgogICAgICAgIHNlbGYucmVxdWlyZV9zdGF0ZSgiY29ubmVjdGVkIikKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShwb29sX25hbWUsIHN0cik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigncG9vbF9uYW1lIG11c3QgYmUgYSBzdHJpbmcnKQogICAgICAgIHJldCA9IHNlbGYubGlicmFkb3MucmFkb3NfcG9vbF9kZWxldGUoc2VsZi5jbHVzdGVyLCBjX2NoYXJfcChwb29sX25hbWUpKQogICAgICAgIGlmIHJldCA8IDA6CiAgICAgICAgICAgIHJhaXNlIG1ha2VfZXgocmV0LCAiZXJyb3IgZGVsZXRpbmcgcG9vbCAnJXMnIiAlIHBvb2xfbmFtZSkKCiAgICBkZWYgbGlzdF9wb29scyhzZWxmKToKICAgICAgICBzZWxmLnJlcXVpcmVfc3RhdGUoImNvbm5lY3RlZCIpCiAgICAgICAgc2l6ZSA9IGNfc2l6ZV90KDUxMikKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICBjX25hbWVzID0gY3JlYXRlX3N0cmluZ19idWZmZXIoc2l6ZS52YWx1ZSkKICAgICAgICAgICAgcmV0ID0gc2VsZi5saWJyYWRvcy5yYWRvc19wb29sX2xpc3Qoc2VsZi5jbHVzdGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBieXJlZihjX25hbWVzKSwgc2l6ZSkKICAgICAgICAgICAgaWYgcmV0ID4gc2l6ZS52YWx1ZToKICAgICAgICAgICAgICAgIHNpemUgPSBjX3NpemVfdChyZXQpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgIHJldHVybiBmaWx0ZXIobGFtYmRhIG5hbWU6IG5hbWUgIT0gJycsIGNfbmFtZXMucmF3LnNwbGl0KCdcMCcpKQoKICAgIGRlZiBvcGVuX2lvY3R4KHNlbGYsIGlvY3R4X25hbWUpOgogICAgICAgIHNlbGYucmVxdWlyZV9zdGF0ZSgiY29ubmVjdGVkIikKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShpb2N0eF9uYW1lLCBzdHIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ2lvY3R4X25hbWUgbXVzdCBiZSBhIHN0cmluZycpCiAgICAgICAgaW9jdHggPSBjX3ZvaWRfcCgpCiAgICAgICAgcmV0ID0gc2VsZi5saWJyYWRvcy5yYWRvc19pb2N0eF9jcmVhdGUoc2VsZi5jbHVzdGVyLCBjX2NoYXJfcChpb2N0eF9uYW1lKSwgYnlyZWYoaW9jdHgpKQogICAgICAgIGlmIHJldCA8IDA6CiAgICAgICAgICAgIHJhaXNlIG1ha2VfZXgocmV0LCAiZXJyb3Igb3BlbmluZyBpb2N0eCAnJXMnIiAlIGlvY3R4X25hbWUpCiAgICAgICAgcmV0dXJuIElvY3R4KGlvY3R4X25hbWUsIHNlbGYubGlicmFkb3MsIGlvY3R4KQoKY2xhc3MgT2JqZWN0SXRlcmF0b3Iob2JqZWN0KToKICAgICIiInJhZG9zLklvY3R4IE9iamVjdCBpdGVyYXRvciIiIgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGlvY3R4KToKICAgICAgICBzZWxmLmlvY3R4ID0gaW9jdHgKICAgICAgICBzZWxmLmN0eCA9IGNfdm9pZF9wKCkKICAgICAgICByZXQgPSBzZWxmLmlvY3R4LmxpYnJhZG9zLlwKICAgICAgICAgICAgcmFkb3Nfb2JqZWN0c19saXN0X29wZW4oc2VsZi5pb2N0eC5pbywgYnlyZWYoc2VsZi5jdHgpKQogICAgICAgIGlmIHJldCA8IDA6CiAgICAgICAgICAgIHJhaXNlIG1ha2VfZXgocmV0LCAiZXJyb3IgaXRlcmF0aW5nIG92ZXIgdGhlIG9iamVjdHMgaW4gaW9jdHggJyVzJyIgXAogICAgICAgICAgICAgICAgJSBzZWxmLmlvY3R4Lm5hbWUpCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIG5leHQoc2VsZik6CiAgICAgICAga2V5ID0gY19jaGFyX3AoKQogICAgICAgIGxvY2F0b3IgPSBjX2NoYXJfcCgpCiAgICAgICAgcmV0ID0gc2VsZi5pb2N0eC5saWJyYWRvcy5yYWRvc19vYmplY3RzX2xpc3RfbmV4dChzZWxmLmN0eCwgYnlyZWYoa2V5KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ5cmVmKGxvY2F0b3IpKQogICAgICAgIGlmIHJldCA8IDA6CiAgICAgICAgICAgIHJhaXNlIFN0b3BJdGVyYXRpb24oKQogICAgICAgIHJldHVybiBPYmplY3Qoc2VsZi5pb2N0eCwga2V5LnZhbHVlLCBsb2NhdG9yLnZhbHVlKQoKICAgIGRlZiBfX2RlbF9fKHNlbGYpOgogICAgICAgIHNlbGYuaW9jdHgubGlicmFkb3MucmFkb3Nfb2JqZWN0c19saXN0X2Nsb3NlKHNlbGYuY3R4KQoKY2xhc3MgWGF0dHJJdGVyYXRvcihvYmplY3QpOgogICAgIiIiRXh0ZW5kZWQgYXR0cmlidXRlIGl0ZXJhdG9yIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgaW9jdHgsIGl0LCBvaWQpOgogICAgICAgIHNlbGYuaW9jdHggPSBpb2N0eAogICAgICAgIHNlbGYuaXQgPSBpdAogICAgICAgIHNlbGYub2lkID0gb2lkCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKICAgIGRlZiBuZXh0KHNlbGYpOgogICAgICAgIG5hbWVfID0gY19jaGFyX3AoMCkKICAgICAgICB2YWxfID0gY19jaGFyX3AoMCkKICAgICAgICBsZW5fID0gY19pbnQoMCkKICAgICAgICByZXQgPSBzZWxmLmlvY3R4LmxpYnJhZG9zLlwKICAgICAgICAgICAgcmFkb3NfZ2V0eGF0dHJzX25leHQoc2VsZi5pdCwgYnlyZWYobmFtZV8pLCBieXJlZih2YWxfKSwgYnlyZWYobGVuXykpCiAgICAgICAgaWYgKHJldCAhPSAwKToKICAgICAgICAgIHJhaXNlIG1ha2VfZXgocmV0LCAiZXJyb3IgaXRlcmF0aW5nIG92ZXIgdGhlIGV4dGVuZGVkIGF0dHJpYnV0ZXMgXAppbiAnJXMnIiAlIHNlbGYub2lkKQogICAgICAgIGlmIG5hbWVfLnZhbHVlID09IE5vbmU6CiAgICAgICAgICAgIHJhaXNlIFN0b3BJdGVyYXRpb24oKQogICAgICAgIG5hbWUgPSBjdHlwZXMuc3RyaW5nX2F0KG5hbWVfKQogICAgICAgIHZhbCA9IGN0eXBlcy5zdHJpbmdfYXQodmFsXywgbGVuXykKICAgICAgICByZXR1cm4gKG5hbWUsIHZhbCkKICAgIGRlZiBfX2RlbF9fKHNlbGYpOgogICAgICAgIHNlbGYuaW9jdHgubGlicmFkb3MucmFkb3NfZ2V0eGF0dHJzX2VuZChzZWxmLml0KQoKY2xhc3MgU25hcEl0ZXJhdG9yKG9iamVjdCk6CiAgICAiIiJTbmFwc2hvdCBpdGVyYXRvciIiIgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGlvY3R4KToKICAgICAgICBzZWxmLmlvY3R4ID0gaW9jdHgKICAgICAgICAjIFdlIGRvbid0IGtub3cgaG93IGJpZyBhIGJ1ZmZlciB3ZSBuZWVkIHVudGlsIHdlJ3ZlIGNhbGxlZCB0aGUKICAgICAgICAjIGZ1bmN0aW9uLiBTbyB1c2UgdGhlIGV4cG9uZW50aWFsIGRvdWJsaW5nIHN0cmF0ZWd5LgogICAgICAgIG51bV9zbmFwcyA9IDEwCiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgc2VsZi5zbmFwcyA9IChjdHlwZXMuY191aW50NjQgKiBudW1fc25hcHMpKCkKICAgICAgICAgICAgcmV0ID0gc2VsZi5pb2N0eC5saWJyYWRvcy5yYWRvc19pb2N0eF9zbmFwX2xpc3Qoc2VsZi5pb2N0eC5pbywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNuYXBzLCBudW1fc25hcHMpCiAgICAgICAgICAgIGlmIChyZXQgPj0gMCk6CiAgICAgICAgICAgICAgICBzZWxmLm1heF9zbmFwID0gcmV0CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBlbGlmIChyZXQgIT0gLWVycm5vLkVSQU5HRSk6CiAgICAgICAgICAgICAgICByYWlzZSBtYWtlX2V4KHJldCwgImVycm9yIGNhbGxpbmcgcmFkb3Nfc25hcF9saXN0IGZvciBcCmlvY3R4ICclcyciICUgc2VsZi5pb2N0eC5uYW1lKQogICAgICAgICAgICBudW1fc25hcHMgPSBudW1fc25hcHMgKiAyOwogICAgICAgIHNlbGYuY3VyX3NuYXAgPSAwCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIG5leHQoc2VsZik6CiAgICAgICAgaWYgKHNlbGYuY3VyX3NuYXAgPj0gc2VsZi5tYXhfc25hcCk6CiAgICAgICAgICAgIHJhaXNlIFN0b3BJdGVyYXRpb24KICAgICAgICBzbmFwX2lkID0gc2VsZi5zbmFwc1tzZWxmLmN1cl9zbmFwXQogICAgICAgIG5hbWVfbGVuID0gMTAKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICBuYW1lID0gY3JlYXRlX3N0cmluZ19idWZmZXIobmFtZV9sZW4pCiAgICAgICAgICAgIHJldCA9IHNlbGYuaW9jdHgubGlicmFkb3MucmFkb3NfaW9jdHhfc25hcF9nZXRfbmFtZShzZWxmLmlvY3R4LmlvLFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbmFwX2lkLCBieXJlZihuYW1lKSwgbmFtZV9sZW4pCiAgICAgICAgICAgIGlmIChyZXQgPT0gMCk6CiAgICAgICAgICAgICAgICBuYW1lX2xlbiA9IHJldAogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZWxpZiAocmV0ICE9IC1lcnJuby5FUkFOR0UpOgogICAgICAgICAgICAgICAgcmFpc2UgbWFrZV9leChyZXQsICJyYWRvc19zbmFwX2dldF9uYW1lIGVycm9yIikKICAgICAgICAgICAgbmFtZV9sZW4gPSBuYW1lX2xlbiAqIDIKICAgICAgICBzbmFwID0gU25hcChzZWxmLmlvY3R4LCBuYW1lLnZhbHVlLCBzbmFwX2lkKQogICAgICAgIHNlbGYuY3VyX3NuYXAgPSBzZWxmLmN1cl9zbmFwICsgMQogICAgICAgIHJldHVybiBzbmFwCgpjbGFzcyBTbmFwKG9iamVjdCk6CiAgICAiIiJTbmFwc2hvdCBvYmplY3QiIiIKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpb2N0eCwgbmFtZSwgc25hcF9pZCk6CiAgICAgICAgc2VsZi5pb2N0eCA9IGlvY3R4CiAgICAgICAgc2VsZi5uYW1lID0gbmFtZQogICAgICAgIHNlbGYuc25hcF9pZCA9IHNuYXBfaWQKCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gInJhZG9zLlNuYXAoaW9jdHg9JXMsbmFtZT0lcyxzbmFwX2lkPSVkKSIgXAogICAgICAgICAgICAlIChzdHIoc2VsZi5pb2N0eCksIHNlbGYubmFtZSwgc2VsZi5zbmFwX2lkKQoKICAgIGRlZiBnZXRfdGltZXN0YW1wKHNlbGYpOgogICAgICAgIHNuYXBfdGltZSA9IGNfbG9uZygwKQogICAgICAgIHJldCA9IHNlbGYuaW9jdHgubGlicmFkb3MucmFkb3NfaW9jdHhfc25hcF9nZXRfc3RhbXAoCiAgICAgICAgICAgIHNlbGYuaW9jdHguaW8sIHNlbGYuc25hcF9pZCwKICAgICAgICAgICAgYnlyZWYoc25hcF90aW1lKSkKICAgICAgICBpZiAocmV0ICE9IDApOgogICAgICAgICAgICByYWlzZSBtYWtlX2V4KHJldCwgInJhZG9zX2lvY3R4X3NuYXBfZ2V0X3N0YW1wIGVycm9yIikKICAgICAgICByZXR1cm4gZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcChzbmFwX3RpbWUudmFsdWUpCgpjbGFzcyBDb21wbGV0aW9uKG9iamVjdCk6CiAgICAiIiJjb21wbGV0aW9uIG9iamVjdCIiIgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGlvY3R4LCByYWRvc19jb21wLCBvbmNvbXBsZXRlLCBvbnNhZmUpOgogICAgICAgIHNlbGYucmFkb3NfY29tcCA9IHJhZG9zX2NvbXAKICAgICAgICBzZWxmLm9uY29tcGxldGUgPSBvbmNvbXBsZXRlCiAgICAgICAgc2VsZi5vbnNhZmUgPSBvbnNhZmUKICAgICAgICBzZWxmLmlvY3R4ID0gaW9jdHgKCiAgICBkZWYgd2FpdF9mb3Jfc2FmZShzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5pb2N0eC5saWJyYWRvcy5yYWRvc19haW9faXNfc2FmZSgKICAgICAgICAgICAgc2VsZi5yYWRvc19jb21wCiAgICAgICAgICAgICkKCiAgICBkZWYgd2FpdF9mb3JfY29tcGxldGUoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuaW9jdHgubGlicmFkb3MucmFkb3NfYWlvX2lzX2NvbXBsZXRlKAogICAgICAgICAgICBzZWxmLnJhZG9zX2NvbXAKICAgICAgICAgICAgKQoKICAgIGRlZiBnZXRfcmV0dXJuX3ZhbHVlKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmlvY3R4LmxpYnJhZG9zLnJhZG9zX2Fpb19nZXRfcmV0dXJuX3ZhbHVlKAogICAgICAgICAgICBzZWxmLnJhZG9zX2NvbXApCgogICAgZGVmIF9fZGVsX18oc2VsZik6CiAgICAgICAgc2VsZi5pb2N0eC5saWJyYWRvcy5yYWRvc19haW9fcmVsZWFzZSgKICAgICAgICAgICAgc2VsZi5yYWRvc19jb21wCiAgICAgICAgICAgICkKCmNsYXNzIElvY3R4KG9iamVjdCk6CiAgICAiIiJyYWRvcy5Jb2N0eCBvYmplY3QiIiIKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBuYW1lLCBsaWJyYWRvcywgaW8pOgogICAgICAgIHNlbGYubmFtZSA9IG5hbWUKICAgICAgICBzZWxmLmxpYnJhZG9zID0gbGlicmFkb3MKICAgICAgICBzZWxmLmlvID0gaW8KICAgICAgICBzZWxmLnN0YXRlID0gIm9wZW4iCiAgICAgICAgc2VsZi5sb2NhdG9yX2tleSA9ICIiCiAgICAgICAgc2VsZi5zYWZlX2NicyA9IHt9CiAgICAgICAgc2VsZi5jb21wbGV0ZV9jYnMgPSB7fQogICAgICAgIFJBRE9TX0NCID0gQ0ZVTkNUWVBFKGNfaW50LCBjX3ZvaWRfcCwgY192b2lkX3ApCiAgICAgICAgc2VsZi5fX2Fpb19zYWZlX2NiX2MgPSBSQURPU19DQihzZWxmLl9fYWlvX3NhZmVfY2IpCiAgICAgICAgc2VsZi5fX2Fpb19jb21wbGV0ZV9jYl9jID0gUkFET1NfQ0Ioc2VsZi5fX2Fpb19jb21wbGV0ZV9jYikKICAgICAgICBzZWxmLmxvY2sgPSB0aHJlYWRpbmcuTG9jaygpCgogICAgZGVmIF9fZW50ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX2V4aXRfXyhzZWxmLCB0eXBlXywgdmFsdWUsIHRyYWNlYmFjayk6CiAgICAgICAgc2VsZi5jbG9zZSgpCiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIF9fZGVsX18oc2VsZik6CiAgICAgICAgc2VsZi5jbG9zZSgpCgogICAgZGVmIF9fYWlvX3NhZmVfY2Ioc2VsZiwgY29tcGxldGlvbiwgXyk6CiAgICAgICAgY2IgPSBOb25lCiAgICAgICAgd2l0aCBzZWxmLmxvY2s6CiAgICAgICAgICAgIGNiID0gc2VsZi5zYWZlX2Nic1tjb21wbGV0aW9uXQogICAgICAgICAgICBkZWwgc2VsZi5zYWZlX2Nic1tjb21wbGV0aW9uXQogICAgICAgIGNiLm9uc2FmZShjYikKICAgICAgICByZXR1cm4gMAoKICAgIGRlZiBfX2Fpb19jb21wbGV0ZV9jYihzZWxmLCBjb21wbGV0aW9uLCBfKToKICAgICAgICBjYiA9IE5vbmUKICAgICAgICB3aXRoIHNlbGYubG9jazoKICAgICAgICAgICAgY2IgPSBzZWxmLmNvbXBsZXRlX2Nic1tjb21wbGV0aW9uXQogICAgICAgICAgICBkZWwgc2VsZi5jb21wbGV0ZV9jYnNbY29tcGxldGlvbl0KICAgICAgICBjYi5vbmNvbXBsZXRlKGNiKQogICAgICAgIHJldHVybiAwCgogICAgZGVmIF9fZ2V0X2NvbXBsZXRpb24oc2VsZiwgb25jb21wbGV0ZSwgb25zYWZlKToKICAgICAgICBjb21wbGV0aW9uID0gY192b2lkX3AoMCkKICAgICAgICBjb21wbGV0ZV9jYiA9IE5vbmUKICAgICAgICBzYWZlX2NiID0gTm9uZQogICAgICAgIGlmIG9uY29tcGxldGU6CiAgICAgICAgICAgIGNvbXBsZXRlX2NiID0gc2VsZi5fX2Fpb19jb21wbGV0ZV9jYl9jCiAgICAgICAgaWYgb25zYWZlOgogICAgICAgICAgICBzYWZlX2NiID0gc2VsZi5fX2Fpb19zYWZlX2NiX2MKICAgICAgICByZXQgPSBzZWxmLmxpYnJhZG9zLnJhZG9zX2Fpb19jcmVhdGVfY29tcGxldGlvbigKICAgICAgICAgICAgY192b2lkX3AoMCksCiAgICAgICAgICAgIGNvbXBsZXRlX2NiLAogICAgICAgICAgICBzYWZlX2NiLAogICAgICAgICAgICBieXJlZihjb21wbGV0aW9uKQogICAgICAgICAgICApCiAgICAgICAgaWYgcmV0IDwgMDoKICAgICAgICAgICAgcmFpc2UgbWFrZV9leChyZXQsICJlcnJvciBnZXR0aW5nIGEgY29tcGxldGlvbiIpCiAgICAgICAgd2l0aCBzZWxmLmxvY2s6CiAgICAgICAgICAgIGNvbXBsZXRpb25fb2JqID0gQ29tcGxldGlvbihzZWxmLCBjb21wbGV0aW9uLCBvbmNvbXBsZXRlLCBvbnNhZmUpCiAgICAgICAgICAgIGlmIG9uY29tcGxldGU6CiAgICAgICAgICAgICAgICBzZWxmLmNvbXBsZXRlX2Nic1tjb21wbGV0aW9uLnZhbHVlXSA9IGNvbXBsZXRpb25fb2JqCiAgICAgICAgICAgIGlmIG9uc2FmZToKICAgICAgICAgICAgICAgIHNlbGYuc2FmZV9jYnNbY29tcGxldGlvbi52YWx1ZV0gPSBjb21wbGV0aW9uX29iagogICAgICAgIHJldHVybiBjb21wbGV0aW9uX29iagoKICAgIGRlZiBhaW9fd3JpdGUoc2VsZiwgb2JqZWN0X25hbWUsIHRvX3dyaXRlLCBvZmZzZXQ9MCwKICAgICAgICAgICAgICAgICAgb25jb21wbGV0ZT1Ob25lLCBvbnNhZmU9Tm9uZSk6CiAgICAgICAgY29tcGxldGlvbiA9IHNlbGYuX19nZXRfY29tcGxldGlvbihvbmNvbXBsZXRlLCBvbnNhZmUpCiAgICAgICAgcmV0ID0gc2VsZi5saWJyYWRvcy5yYWRvc19haW9fd3JpdGUoCiAgICAgICAgICAgIHNlbGYuaW8sCiAgICAgICAgICAgIGNfY2hhcl9wKG9iamVjdF9uYW1lKSwKICAgICAgICAgICAgY29tcGxldGlvbi5yYWRvc19jb21wLAogICAgICAgICAgICBjX2NoYXJfcCh0b193cml0ZSksCiAgICAgICAgICAgIGNfc2l6ZV90KGxlbih0b193cml0ZSkpLAogICAgICAgICAgICBjX3VpbnQ2NChvZmZzZXQpKQogICAgICAgIGlmIHJldCA8IDA6CiAgICAgICAgICAgIHJhaXNlIG1ha2VfZXgocmV0LCAiZXJyb3Igd3JpdGluZyBvYmplY3QgJXMiICUgb2JqZWN0X25hbWUpCiAgICAgICAgcmV0dXJuIGNvbXBsZXRpb24KCiAgICBkZWYgYWlvX3dyaXRlX2Z1bGwoc2VsZiwgb2JqZWN0X25hbWUsIHRvX3dyaXRlLAogICAgICAgICAgICAgICAgICAgICAgIG9uY29tcGxldGU9Tm9uZSwgb25zYWZlPU5vbmUpOgogICAgICAgIGNvbXBsZXRpb24gPSBzZWxmLl9fZ2V0X2NvbXBsZXRpb24ob25jb21wbGV0ZSwgb25zYWZlKQogICAgICAgIHJldCA9IHNlbGYubGlicmFkb3MucmFkb3NfYWlvX3dyaXRlX2Z1bGwoCiAgICAgICAgICAgIHNlbGYuaW8sCiAgICAgICAgICAgIGNfY2hhcl9wKG9iamVjdF9uYW1lKSwKICAgICAgICAgICAgY29tcGxldGlvbi5yYWRvc19jb21wLAogICAgICAgICAgICBjX2NoYXJfcCh0b193cml0ZSksCiAgICAgICAgICAgIGNfc2l6ZV90KGxlbih0b193cml0ZSkpKQogICAgICAgIGlmIHJldCA8IDA6CiAgICAgICAgICAgIHJhaXNlIG1ha2VfZXgocmV0LCAiZXJyb3Igd3JpdGluZyBvYmplY3QgJXMiICUgb2JqZWN0X25hbWUpCiAgICAgICAgcmV0dXJuIGNvbXBsZXRpb24KCiAgICBkZWYgYWlvX2FwcGVuZChzZWxmLCBvYmplY3RfbmFtZSwgdG9fYXBwZW5kLCBvbmNvbXBsZXRlPU5vbmUsIG9uc2FmZT1Ob25lKToKICAgICAgICBjb21wbGV0aW9uID0gc2VsZi5fX2dldF9jb21wbGV0aW9uKG9uY29tcGxldGUsIG9uc2FmZSkKICAgICAgICByZXQgPSBzZWxmLmxpYnJhZG9zLnJhZG9zX2Fpb19hcHBlbmQoCiAgICAgICAgICAgIHNlbGYuaW8sCiAgICAgICAgICAgIGNfY2hhcl9wKG9iamVjdF9uYW1lKSwKICAgICAgICAgICAgY29tcGxldGlvbi5yYWRvc19jb21wLAogICAgICAgICAgICBjX2NoYXJfcCh0b19hcHBlbmQpLAogICAgICAgICAgICBjX3NpemVfdChsZW4odG9fYXBwZW5kKSkpCiAgICAgICAgaWYgcmV0IDwgMDoKICAgICAgICAgICAgcmFpc2UgbWFrZV9leChyZXQsICJlcnJvciBhcHBlbmRpbmcgdG8gb2JqZWN0ICVzIiAlIG9iamVjdF9uYW1lKQogICAgICAgIHJldHVybiBjb21wbGV0aW9uCgogICAgZGVmIGFpb19mbHVzaChzZWxmKToKICAgICAgICByZXQgPSBzZWxmLmxpYnJhZG9zLnJhZG9zX2Fpb19mbHVzaCgKICAgICAgICAgICAgc2VsZi5pbykKICAgICAgICBpZiByZXQgPCAwOgogICAgICAgICAgICByYWlzZSBtYWtlX2V4KHJldCwgImVycm9yIGZsdXNoaW5nIikKCiAgICBkZWYgYWlvX3JlYWQoc2VsZiwgb2JqZWN0X25hbWUsIGxlbmd0aCwgb2Zmc2V0LCBvbmNvbXBsZXRlKToKICAgICAgICAiIiIKb25jb21wbGV0ZSB3aWxsIGJlIGNhbGxlZCB3aXRoIHRoZSByZXR1cm5lZCByZWFkIHZhbHVlIGFzCndlbGwgYXMgdGhlIGNvbXBsZXRpb246CgpvbmNvbXBsZXRlKGNvbXBsZXRpb24sIGRhdGFfcmVhZCkKIiIiCiAgICAgICAgYnVmID0gY3JlYXRlX3N0cmluZ19idWZmZXIobGVuZ3RoKQogICAgICAgIGRlZiBvbmNvbXBsZXRlXyhjb21wbGV0aW9uKToKICAgICAgICAgICAgcmV0dXJuIG9uY29tcGxldGUoY29tcGxldGlvbiwgYnVmLnZhbHVlKQogICAgICAgIGNvbXBsZXRpb24gPSBzZWxmLl9fZ2V0X2NvbXBsZXRpb24ob25jb21wbGV0ZV8sIE5vbmUpCiAgICAgICAgcmV0ID0gc2VsZi5saWJyYWRvcy5yYWRvc19haW9fcmVhZCgKICAgICAgICAgICAgc2VsZi5pbywKICAgICAgICAgICAgY19jaGFyX3Aob2JqZWN0X25hbWUpLAogICAgICAgICAgICBjb21wbGV0aW9uLnJhZG9zX2NvbXAsCiAgICAgICAgICAgIGJ1ZiwKICAgICAgICAgICAgY19zaXplX3QobGVuZ3RoKSwKICAgICAgICAgICAgY191aW50NjQob2Zmc2V0KSkKICAgICAgICBpZiByZXQgPCAwOgogICAgICAgICAgICByYWlzZSBtYWtlX2V4KHJldCwgImVycm9yIHJlYWRpbmcgJXMiICUgb2JqZWN0X25hbWUpCiAgICAgICAgcmV0dXJuIGNvbXBsZXRpb24KCiAgICBkZWYgcmVxdWlyZV9pb2N0eF9vcGVuKHNlbGYpOgogICAgICAgIGlmIHNlbGYuc3RhdGUgIT0gIm9wZW4iOgogICAgICAgICAgICByYWlzZSBJb2N0eFN0YXRlRXJyb3IoIlRoZSBwb29sIGlzICVzIiAlIHNlbGYuc3RhdGUpCgogICAgZGVmIGNoYW5nZV9hdWlkKHNlbGYsIGF1aWQpOgogICAgICAgIHNlbGYucmVxdWlyZV9pb2N0eF9vcGVuKCkKICAgICAgICByZXQgPSBzZWxmLmxpYnJhZG9zLnJhZG9zX2lvY3R4X3Bvb2xfc2V0X2F1aWQoc2VsZi5pbyxcCiAgICAgICAgICAgICAgICBjdHlwZXMuY191aW50NjQoYXVpZCkpCiAgICAgICAgaWYgcmV0IDwgMDoKICAgICAgICAgICAgcmFpc2UgbWFrZV9leChyZXQsICJlcnJvciBjaGFuZ2luZyBhdWlkIG9mICclcycgdG8gJWxsZCIgJVwKICAgICAgICAgICAgICAgIChzZWxmLm5hbWUsIGF1aWQpKQoKICAgIGRlZiBzZXRfbG9jYXRvcl9rZXkoc2VsZiwgbG9jX2tleSk6CiAgICAgICAgc2VsZi5yZXF1aXJlX2lvY3R4X29wZW4oKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKGxvY19rZXksIHN0cik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcignbG9jX2tleSBtdXN0IGJlIGEgc3RyaW5nJykKICAgICAgICBzZWxmLmxpYnJhZG9zLnJhZG9zX2lvY3R4X2xvY2F0b3Jfc2V0X2tleShzZWxmLmlvLFwKICAgICAgICAgICAgICAgIGNfY2hhcl9wKGxvY19rZXkpKQogICAgICAgIHNlbGYubG9jYXRvcl9rZXkgPSBsb2Nfa2V5CgogICAgZGVmIGdldF9sb2NhdG9yX2tleShzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5sb2NhdG9yX2tleQoKICAgIGRlZiBjbG9zZShzZWxmKToKICAgICAgICBpZiBzZWxmLnN0YXRlID09ICJvcGVuIjoKICAgICAgICAgICAgc2VsZi5yZXF1aXJlX2lvY3R4X29wZW4oKQogICAgICAgICAgICBzZWxmLmxpYnJhZG9zLnJhZG9zX2lvY3R4X2Rlc3Ryb3koc2VsZi5pbykKICAgICAgICAgICAgc2VsZi5zdGF0ZSA9ICJjbG9zZWQiCgogICAgZGVmIHdyaXRlKHNlbGYsIGtleSwgZGF0YSwgb2Zmc2V0PTApOgogICAgICAgIHNlbGYucmVxdWlyZV9pb2N0eF9vcGVuKCkKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShkYXRhLCBzdHIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ2RhdGEgbXVzdCBiZSBhIHN0cmluZycpCiAgICAgICAgbGVuZ3RoID0gbGVuKGRhdGEpCiAgICAgICAgcmV0ID0gc2VsZi5saWJyYWRvcy5yYWRvc193cml0ZShzZWxmLmlvLCBjX2NoYXJfcChrZXkpLAogICAgICAgICAgICAgICAgIGNfY2hhcl9wKGRhdGEpLCBjX3NpemVfdChsZW5ndGgpLCBjX3VpbnQ2NChvZmZzZXQpKQogICAgICAgIGlmIHJldCA9PSBsZW5ndGg6CiAgICAgICAgICAgIHJldHVybiByZXQKICAgICAgICBlbGlmIHJldCA8IDA6CiAgICAgICAgICAgIHJhaXNlIG1ha2VfZXgocmV0LCAiSW9jdHgud3JpdGUoJXMpOiBmYWlsZWQgdG8gd3JpdGUgJXMiICUgXAogICAgICAgICAgICAgICAgKHNlbGYubmFtZSwga2V5KSkKICAgICAgICBlbGlmIHJldCA8IGxlbmd0aDoKICAgICAgICAgICAgcmFpc2UgSW5jb21wbGV0ZVdyaXRlRXJyb3IoIldyb3RlIG9ubHkgJWxkIG91dCBvZiAlbGQgYnl0ZXMiICUgXAogICAgICAgICAgICAgICAgKHJldCwgbGVuZ3RoKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBMb2dpY0Vycm9yKCJJb2N0eC53cml0ZSglcyk6IHJhZG9zX3dyaXRlIFwKcmV0dXJuZWQgJWQsIGJ1dCAlZCB3YXMgdGhlIG1heGltdW0gbnVtYmVyIG9mIGJ5dGVzIGl0IGNvdWxkIGhhdmUgXAp3cml0dGVuLiIgJSAoc2VsZi5uYW1lLCByZXQsIGxlbmd0aCkpCgogICAgZGVmIHdyaXRlX2Z1bGwoc2VsZiwga2V5LCBkYXRhKToKICAgICAgICBzZWxmLnJlcXVpcmVfaW9jdHhfb3BlbigpCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uoa2V5LCBzdHIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ2tleSBtdXN0IGJlIGEgc3RyaW5nJykKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShkYXRhLCBzdHIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ2RhdGEgbXVzdCBiZSBhIHN0cmluZycpCiAgICAgICAgbGVuZ3RoID0gbGVuKGRhdGEpCiAgICAgICAgcmV0ID0gc2VsZi5saWJyYWRvcy5yYWRvc193cml0ZV9mdWxsKHNlbGYuaW8sIGNfY2hhcl9wKGtleSksCiAgICAgICAgICAgICAgICAgY19jaGFyX3AoZGF0YSksIGNfc2l6ZV90KGxlbmd0aCkpCiAgICAgICAgaWYgcmV0ID09IDA6CiAgICAgICAgICAgIHJldHVybiByZXQKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBtYWtlX2V4KHJldCwgIklvY3R4LndyaXRlKCVzKTogZmFpbGVkIHRvIHdyaXRlX2Z1bGwgJXMiICUgXAogICAgICAgICAgICAgICAgKHNlbGYubmFtZSwga2V5KSkKCiAgICBkZWYgcmVhZChzZWxmLCBrZXksIGxlbmd0aD04MTkyLCBvZmZzZXQ9MCk6CiAgICAgICAgc2VsZi5yZXF1aXJlX2lvY3R4X29wZW4oKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKGtleSwgc3RyKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdrZXkgbXVzdCBiZSBhIHN0cmluZycpCiAgICAgICAgcmV0X2J1ZiA9IGNyZWF0ZV9zdHJpbmdfYnVmZmVyKGxlbmd0aCkKICAgICAgICByZXQgPSBzZWxmLmxpYnJhZG9zLnJhZG9zX3JlYWQoc2VsZi5pbywgY19jaGFyX3Aoa2V5KSwgcmV0X2J1ZiwKICAgICAgICAgICAgICAgIGNfc2l6ZV90KGxlbmd0aCksIGNfdWludDY0KG9mZnNldCkpCiAgICAgICAgaWYgcmV0IDwgMDoKICAgICAgICAgICAgcmFpc2UgbWFrZV9leChyZXQsICJJb2N0eC5yZWFkKCVzKTogZmFpbGVkIHRvIHJlYWQgJXMiICUgKHNlbGYubmFtZSwga2V5KSkKICAgICAgICByZXR1cm4gY3R5cGVzLnN0cmluZ19hdChyZXRfYnVmLCByZXQpCgogICAgZGVmIGdldF9zdGF0cyhzZWxmKToKICAgICAgICBzZWxmLnJlcXVpcmVfaW9jdHhfb3BlbigpCiAgICAgICAgc3RhdHMgPSByYWRvc19wb29sX3N0YXRfdCgpCiAgICAgICAgcmV0ID0gc2VsZi5saWJyYWRvcy5yYWRvc19pb2N0eF9wb29sX3N0YXQoc2VsZi5pbywgYnlyZWYoc3RhdHMpKQogICAgICAgIGlmIHJldCA8IDA6CiAgICAgICAgICAgIHJhaXNlIG1ha2VfZXgocmV0LCAiSW9jdHguZ2V0X3N0YXRzKCVzKTogZ2V0X3N0YXRzIGZhaWxlZCIgJSBzZWxmLm5hbWUpCiAgICAgICAgcmV0dXJuIHsnbnVtX2J5dGVzJzogc3RhdHMubnVtX2J5dGVzLAogICAgICAgICAgICAgICAgJ251bV9rYic6IHN0YXRzLm51bV9rYiwKICAgICAgICAgICAgICAgICdudW1fb2JqZWN0cyc6IHN0YXRzLm51bV9vYmplY3RzLAogICAgICAgICAgICAgICAgJ251bV9vYmplY3RfY2xvbmVzJzogc3RhdHMubnVtX29iamVjdF9jbG9uZXMsCiAgICAgICAgICAgICAgICAnbnVtX29iamVjdF9jb3BpZXMnOiBzdGF0cy5udW1fb2JqZWN0X2NvcGllcywKICAgICAgICAgICAgICAgICJudW1fb2JqZWN0c19taXNzaW5nX29uX3ByaW1hcnkiOiBzdGF0cy5udW1fb2JqZWN0c19taXNzaW5nX29uX3ByaW1hcnksCiAgICAgICAgICAgICAgICAibnVtX29iamVjdHNfdW5mb3VuZCI6IHN0YXRzLm51bV9vYmplY3RzX3VuZm91bmQsCiAgICAgICAgICAgICAgICAibnVtX29iamVjdHNfZGVncmFkZWQiOiBzdGF0cy5udW1fb2JqZWN0c19kZWdyYWRlZCwKICAgICAgICAgICAgICAgICJudW1fcmQiOiBzdGF0cy5udW1fcmQsCiAgICAgICAgICAgICAgICAibnVtX3JkX2tiIjogc3RhdHMubnVtX3JkX2tiLAogICAgICAgICAgICAgICAgIm51bV93ciI6IHN0YXRzLm51bV93ciwKICAgICAgICAgICAgICAgICJudW1fd3Jfa2IiOiBzdGF0cy5udW1fd3Jfa2IgfQoKICAgIGRlZiByZW1vdmVfb2JqZWN0KHNlbGYsIGtleSk6CiAgICAgICAgc2VsZi5yZXF1aXJlX2lvY3R4X29wZW4oKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKGtleSwgc3RyKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdrZXkgbXVzdCBiZSBhIHN0cmluZycpCiAgICAgICAgcmV0ID0gc2VsZi5saWJyYWRvcy5yYWRvc19yZW1vdmUoc2VsZi5pbywgY19jaGFyX3Aoa2V5KSkKICAgICAgICBpZiByZXQgPCAwOgogICAgICAgICAgICByYWlzZSBtYWtlX2V4KHJldCwgIkZhaWxlZCB0byByZW1vdmUgJyVzJyIgJSBrZXkpCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgc3RhdChzZWxmLCBrZXkpOgogICAgICAgICIiIlN0YXQgb2JqZWN0LCByZXR1cm5zLCBzaXplL3RpbWVzdGFtcCIiIgogICAgICAgIHNlbGYucmVxdWlyZV9pb2N0eF9vcGVuKCkKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShrZXksIHN0cik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigna2V5IG11c3QgYmUgYSBzdHJpbmcnKQogICAgICAgIHBzaXplID0gY191aW50NjQoKQogICAgICAgIHBtdGltZSA9IGNfdWludDY0KCkKCiAgICAgICAgcmV0ID0gc2VsZi5saWJyYWRvcy5yYWRvc19zdGF0KHNlbGYuaW8sIGNfY2hhcl9wKGtleSksIHBvaW50ZXIocHNpemUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRlcihwbXRpbWUpKQogICAgICAgIGlmIHJldCA8IDA6CiAgICAgICAgICAgIHJhaXNlIG1ha2VfZXgocmV0LCAiRmFpbGVkIHRvIHN0YXQgJXIiICUga2V5KQogICAgICAgIHJldHVybiBwc2l6ZS52YWx1ZSwgdGltZS5sb2NhbHRpbWUocG10aW1lLnZhbHVlKQoKICAgIGRlZiBnZXRfeGF0dHIoc2VsZiwga2V5LCB4YXR0cl9uYW1lKToKICAgICAgICBzZWxmLnJlcXVpcmVfaW9jdHhfb3BlbigpCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoeGF0dHJfbmFtZSwgc3RyKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCd4YXR0cl9uYW1lIG11c3QgYmUgYSBzdHJpbmcnKQogICAgICAgIHJldF9sZW5ndGggPSA0MDk2CiAgICAgICAgcmV0X2J1ZiA9IGNyZWF0ZV9zdHJpbmdfYnVmZmVyKHJldF9sZW5ndGgpCiAgICAgICAgcmV0ID0gc2VsZi5saWJyYWRvcy5yYWRvc19nZXR4YXR0cihzZWxmLmlvLCBjX2NoYXJfcChrZXkpLAogICAgICAgICAgICAgICAgICAgIGNfY2hhcl9wKHhhdHRyX25hbWUpLCByZXRfYnVmLCBjX3NpemVfdChyZXRfbGVuZ3RoKSkKICAgICAgICBpZiByZXQgPCAwOgogICAgICAgICAgICByYWlzZSBtYWtlX2V4KHJldCwgIkZhaWxlZCB0byBnZXQgeGF0dHIgJXIiICUgeGF0dHJfbmFtZSkKICAgICAgICByZXR1cm4gY3R5cGVzLnN0cmluZ19hdChyZXRfYnVmLCByZXQpCgogICAgZGVmIGdldF94YXR0cnMoc2VsZiwgb2lkKToKICAgICAgICBzZWxmLnJlcXVpcmVfaW9jdHhfb3BlbigpCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob2lkLCBzdHIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ29pZCBtdXN0IGJlIGEgc3RyaW5nJykKICAgICAgICBpdCA9IGNfdm9pZF9wKDApCiAgICAgICAgcmV0ID0gc2VsZi5saWJyYWRvcy5yYWRvc19nZXR4YXR0cnMoc2VsZi5pbywgb2lkLCBieXJlZihpdCkpCiAgICAgICAgaWYgcmV0ICE9IDA6CiAgICAgICAgICAgIHJhaXNlIG1ha2VfZXgocmV0LCAiRmFpbGVkIHRvIGdldCByYWRvcyB4YXR0cnMgZm9yIG9iamVjdCAlciIgJSBvaWQpCiAgICAgICAgcmV0dXJuIFhhdHRySXRlcmF0b3Ioc2VsZiwgaXQsIG9pZCkKCiAgICBkZWYgc2V0X3hhdHRyKHNlbGYsIGtleSwgeGF0dHJfbmFtZSwgeGF0dHJfdmFsdWUpOgogICAgICAgIHNlbGYucmVxdWlyZV9pb2N0eF9vcGVuKCkKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShrZXksIHN0cik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigna2V5IG11c3QgYmUgYSBzdHJpbmcnKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHhhdHRyX25hbWUsIHN0cik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigneGF0dHJfbmFtZSBtdXN0IGJlIGEgc3RyaW5nJykKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZSh4YXR0cl92YWx1ZSwgc3RyKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCd4YXR0cl92YWx1ZSBtdXN0IGJlIGEgc3RyaW5nJykKICAgICAgICByZXQgPSBzZWxmLmxpYnJhZG9zLnJhZG9zX3NldHhhdHRyKHNlbGYuaW8sIGNfY2hhcl9wKGtleSksCiAgICAgICAgICAgICAgICAgICAgY19jaGFyX3AoeGF0dHJfbmFtZSksIGNfY2hhcl9wKHhhdHRyX3ZhbHVlKSwKICAgICAgICAgICAgICAgICAgICBjX3NpemVfdChsZW4oeGF0dHJfdmFsdWUpKSkKICAgICAgICBpZiByZXQgPCAwOgogICAgICAgICAgICByYWlzZSBtYWtlX2V4KHJldCwgIkZhaWxlZCB0byBzZXQgeGF0dHIgJXIiICUgeGF0dHJfbmFtZSkKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBybV94YXR0cihzZWxmLCBrZXksIHhhdHRyX25hbWUpOgogICAgICAgIHNlbGYucmVxdWlyZV9pb2N0eF9vcGVuKCkKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShrZXksIHN0cik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigna2V5IG11c3QgYmUgYSBzdHJpbmcnKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHhhdHRyX25hbWUsIHN0cik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigneGF0dHJfbmFtZSBtdXN0IGJlIGEgc3RyaW5nJykKICAgICAgICByZXQgPSBzZWxmLmxpYnJhZG9zLnJhZG9zX3JteGF0dHIoc2VsZi5pbywgY19jaGFyX3Aoa2V5KSwgY19jaGFyX3AoeGF0dHJfbmFtZSkpCiAgICAgICAgaWYgcmV0IDwgMDoKICAgICAgICAgICAgcmFpc2UgbWFrZV9leChyZXQsICJGYWlsZWQgdG8gZGVsZXRlIGtleSAlciB4YXR0ciAlciIgJQogICAgICAgICAgICAgICAgKGtleSwgeGF0dHJfbmFtZSkpCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgbGlzdF9vYmplY3RzKHNlbGYpOgogICAgICAgIHNlbGYucmVxdWlyZV9pb2N0eF9vcGVuKCkKICAgICAgICByZXR1cm4gT2JqZWN0SXRlcmF0b3Ioc2VsZikKCiAgICBkZWYgbGlzdF9zbmFwcyhzZWxmKToKICAgICAgICBzZWxmLnJlcXVpcmVfaW9jdHhfb3BlbigpCiAgICAgICAgcmV0dXJuIFNuYXBJdGVyYXRvcihzZWxmKQoKICAgIGRlZiBjcmVhdGVfc25hcChzZWxmLCBzbmFwX25hbWUpOgogICAgICAgIHNlbGYucmVxdWlyZV9pb2N0eF9vcGVuKCkKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShzbmFwX25hbWUsIHN0cik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcignc25hcF9uYW1lIG11c3QgYmUgYSBzdHJpbmcnKQogICAgICAgIHJldCA9IHNlbGYubGlicmFkb3MucmFkb3NfaW9jdHhfc25hcF9jcmVhdGUoc2VsZi5pbywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY19jaGFyX3Aoc25hcF9uYW1lKSkKICAgICAgICBpZiAocmV0ICE9IDApOgogICAgICAgICAgICByYWlzZSBtYWtlX2V4KHJldCwgIkZhaWxlZCB0byBjcmVhdGUgc25hcCAlcyIgJSBzbmFwX25hbWUpCgogICAgZGVmIHJlbW92ZV9zbmFwKHNlbGYsIHNuYXBfbmFtZSk6CiAgICAgICAgc2VsZi5yZXF1aXJlX2lvY3R4X29wZW4oKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHNuYXBfbmFtZSwgc3RyKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdzbmFwX25hbWUgbXVzdCBiZSBhIHN0cmluZycpCiAgICAgICAgcmV0ID0gc2VsZi5saWJyYWRvcy5yYWRvc19pb2N0eF9zbmFwX3JlbW92ZShzZWxmLmlvLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjX2NoYXJfcChzbmFwX25hbWUpKQogICAgICAgIGlmIChyZXQgIT0gMCk6CiAgICAgICAgICAgIHJhaXNlIG1ha2VfZXgocmV0LCAiRmFpbGVkIHRvIHJlbW92ZSBzbmFwICVzIiAlIHNuYXBfbmFtZSkKCiAgICBkZWYgbG9va3VwX3NuYXAoc2VsZiwgc25hcF9uYW1lKToKICAgICAgICBzZWxmLnJlcXVpcmVfaW9jdHhfb3BlbigpCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uoc25hcF9uYW1lLCBzdHIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ3NuYXBfbmFtZSBtdXN0IGJlIGEgc3RyaW5nJykKICAgICAgICBzbmFwX2lkID0gY191aW50NjQoKQogICAgICAgIHJldCA9IHNlbGYubGlicmFkb3MucmFkb3NfaW9jdHhfc25hcF9sb29rdXAoc2VsZi5pbyxcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjX2NoYXJfcChzbmFwX25hbWUpLCBieXJlZihzbmFwX2lkKSkKICAgICAgICBpZiAocmV0ICE9IDApOgogICAgICAgICAgICByYWlzZSBtYWtlX2V4KHJldCwgIkZhaWxlZCB0byBsb29rdXAgc25hcCAlcyIgJSBzbmFwX25hbWUpCiAgICAgICAgcmV0dXJuIFNuYXAoc2VsZiwgc25hcF9uYW1lLCBzbmFwX2lkKQoKICAgIGRlZiBnZXRfbGFzdF92ZXJzaW9uKHNlbGYpOgogICAgICAgIHNlbGYucmVxdWlyZV9pb2N0eF9vcGVuKCkKICAgICAgICByZXR1cm4gc2VsZi5saWJyYWRvcy5yYWRvc19nZXRfbGFzdF92ZXJzaW9uKHNlbGYuaW8pCgpkZWYgc2V0X29iamVjdF9sb2NhdG9yKGZ1bmMpOgogICAgZGVmIHJldGZ1bmMoc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICBpZiBzZWxmLmxvY2F0b3Jfa2V5IGlzIG5vdCBOb25lOgogICAgICAgICAgICBvbGRfbG9jYXRvciA9IHNlbGYuaW9jdHguZ2V0X2xvY2F0b3Jfa2V5KCkKICAgICAgICAgICAgc2VsZi5pb2N0eC5zZXRfbG9jYXRvcl9rZXkoc2VsZi5sb2NhdG9yX2tleSkKICAgICAgICAgICAgcmV0dmFsID0gZnVuYyhzZWxmLCAqYXJncywgKiprd2FyZ3MpCiAgICAgICAgICAgIHNlbGYuaW9jdHguc2V0X2xvY2F0b3Jfa2V5KG9sZF9sb2NhdG9yKQogICAgICAgICAgICByZXR1cm4gcmV0dmFsCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIGZ1bmMoc2VsZiwgKmFyZ3MsICoqa3dhcmdzKQogICAgcmV0dXJuIHJldGZ1bmMKCmNsYXNzIE9iamVjdChvYmplY3QpOgogICAgIiIiUmFkb3Mgb2JqZWN0IHdyYXBwZXIsIG1ha2VzIHRoZSBvYmplY3QgbG9vayBsaWtlIGEgZmlsZSIiIgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGlvY3R4LCBrZXksIGxvY2F0b3Jfa2V5PU5vbmUpOgogICAgICAgIHNlbGYua2V5ID0ga2V5CiAgICAgICAgc2VsZi5pb2N0eCA9IGlvY3R4CiAgICAgICAgc2VsZi5vZmZzZXQgPSAwCiAgICAgICAgc2VsZi5zdGF0ZSA9ICJleGlzdHMiCiAgICAgICAgc2VsZi5sb2NhdG9yX2tleSA9IGxvY2F0b3Jfa2V5CgogICAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgICAgcmV0dXJuICJyYWRvcy5PYmplY3QoaW9jdHg9JXMsa2V5PSVzKSIgJSAoc3RyKHNlbGYuaW9jdHgpLCBzZWxmLmtleSkKCiAgICBkZWYgcmVxdWlyZV9vYmplY3RfZXhpc3RzKHNlbGYpOgogICAgICAgIGlmIHNlbGYuc3RhdGUgIT0gImV4aXN0cyI6CiAgICAgICAgICAgIHJhaXNlIE9iamVjdFN0YXRlRXJyb3IoIlRoZSBvYmplY3QgaXMgJXMiICUgc2VsZi5zdGF0ZSkKCiAgICBAc2V0X29iamVjdF9sb2NhdG9yCiAgICBkZWYgcmVhZChzZWxmLCBsZW5ndGggPSAxMDI0KjEwMjQpOgogICAgICAgIHNlbGYucmVxdWlyZV9vYmplY3RfZXhpc3RzKCkKICAgICAgICByZXQgPSBzZWxmLmlvY3R4LnJlYWQoc2VsZi5rZXksIGxlbmd0aCwgc2VsZi5vZmZzZXQpCiAgICAgICAgc2VsZi5vZmZzZXQgKz0gbGVuKHJldCkKICAgICAgICByZXR1cm4gcmV0CgogICAgQHNldF9vYmplY3RfbG9jYXRvcgogICAgZGVmIHdyaXRlKHNlbGYsIHN0cmluZ190b193cml0ZSk6CiAgICAgICAgc2VsZi5yZXF1aXJlX29iamVjdF9leGlzdHMoKQogICAgICAgIHJldCA9IHNlbGYuaW9jdHgud3JpdGUoc2VsZi5rZXksIHN0cmluZ190b193cml0ZSwgc2VsZi5vZmZzZXQpCiAgICAgICAgc2VsZi5vZmZzZXQgKz0gcmV0CiAgICAgICAgcmV0dXJuIHJldAoKICAgIEBzZXRfb2JqZWN0X2xvY2F0b3IKICAgIGRlZiByZW1vdmUoc2VsZik6CiAgICAgICAgc2VsZi5yZXF1aXJlX29iamVjdF9leGlzdHMoKQogICAgICAgIHNlbGYuaW9jdHgucmVtb3ZlX29iamVjdChzZWxmLmtleSkKICAgICAgICBzZWxmLnN0YXRlID0gInJlbW92ZWQiCgogICAgQHNldF9vYmplY3RfbG9jYXRvcgogICAgZGVmIHN0YXQoc2VsZik6CiAgICAgICAgc2VsZi5yZXF1aXJlX29iamVjdF9leGlzdHMoKQogICAgICAgIHJldHVybiBzZWxmLmlvY3R4LnN0YXQoc2VsZi5rZXkpCgogICAgZGVmIHNlZWsoc2VsZiwgcG9zaXRpb24pOgogICAgICAgIHNlbGYucmVxdWlyZV9vYmplY3RfZXhpc3RzKCkKICAgICAgICBzZWxmLm9mZnNldCA9IHBvc2l0aW9uCgogICAgQHNldF9vYmplY3RfbG9jYXRvcgogICAgZGVmIGdldF94YXR0cihzZWxmLCB4YXR0cl9uYW1lKToKICAgICAgICBzZWxmLnJlcXVpcmVfb2JqZWN0X2V4aXN0cygpCiAgICAgICAgcmV0dXJuIHNlbGYuaW9jdHguZ2V0X3hhdHRyKHNlbGYua2V5LCB4YXR0cl9uYW1lKQoKICAgIEBzZXRfb2JqZWN0X2xvY2F0b3IKICAgIGRlZiBnZXRfeGF0dHJzKHNlbGYsIHhhdHRyX25hbWUpOgogICAgICAgIHNlbGYucmVxdWlyZV9vYmplY3RfZXhpc3RzKCkKICAgICAgICByZXR1cm4gc2VsZi5pb2N0eC5nZXRfeGF0dHJzKHNlbGYua2V5LCB4YXR0cl9uYW1lKQoKICAgIEBzZXRfb2JqZWN0X2xvY2F0b3IKICAgIGRlZiBzZXRfeGF0dHIoc2VsZiwgeGF0dHJfbmFtZSwgeGF0dHJfdmFsdWUpOgogICAgICAgIHNlbGYucmVxdWlyZV9vYmplY3RfZXhpc3RzKCkKICAgICAgICByZXR1cm4gc2VsZi5pb2N0eC5zZXRfeGF0dHIoc2VsZi5rZXksIHhhdHRyX25hbWUsIHhhdHRyX3ZhbHVlKQoKICAgIEBzZXRfb2JqZWN0X2xvY2F0b3IKICAgIGRlZiBybV94YXR0cihzZWxmLCB4YXR0cl9uYW1lKToKICAgICAgICBzZWxmLnJlcXVpcmVfb2JqZWN0X2V4aXN0cygpCiAgICAgICAgcmV0dXJuIHNlbGYuaW9jdHgucm1feGF0dHIoc2VsZi5rZXksIHhhdHRyX25hbWUp',
'/Lib/operator.py':'IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoiIiIKT3BlcmF0b3IgSW50ZXJmYWNlCgpUaGlzIG1vZHVsZSBleHBvcnRzIGEgc2V0IG9mIGZ1bmN0aW9ucyBjb3JyZXNwb25kaW5nIHRvIHRoZSBpbnRyaW5zaWMgCm9wZXJhdG9ycyBvZiBQeXRob24uICBGb3IgZXhhbXBsZSwgb3BlcmF0b3IuYWRkKHgsIHkpIGlzIGVxdWl2YWxlbnQgCnRvIHRoZSBleHByZXNzaW9uIHgreS4gIFRoZSBmdW5jdGlvbiBuYW1lcyBhcmUgdGhvc2UgdXNlZCBmb3Igc3BlY2lhbCAKbWV0aG9kczsgdmFyaWFudHMgd2l0aG91dCBsZWFkaW5nIGFuZCB0cmFpbGluZyAnX18nIGFyZSBhbHNvIHByb3ZpZGVkIApmb3IgY29udmVuaWVuY2UuCgpUaGlzIGlzIHRoZSBwdXJlIFB5dGhvbiBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgbW9kdWxlLgoiIiIKCiMgZG93bmxvYWRlZCBmcm9tIGh0dHA6Ly9idWdzLnB5dGhvbi5vcmcvZmlsZTI4MzI3L29wZXJhdG9yLnB5CgojaW1wb3J0IGJ1aWx0aW5zIGFzIF9iaSAgI3RoZXJlIGlzIG5vIGJ1aWx0aW5zIG1vZHVsZQoKZGVmIGx0KGEsIGIpOgogICAgIlNhbWUgYXMgYSA8IGIuIgogICAgcmV0dXJuIGEgPCBiCl9fbHRfXyA9IGx0CgpkZWYgbGUoYSwgYik6CiAgICAiU2FtZSBhcyBhIDw9IGIuIgogICAgcmV0dXJuIGEgPD0gYgpfX2xlX18gPSBsZQoKZGVmIGVxKGEsIGIpOgogICAgIlNhbWUgYXMgYSA9PSBiLiIKICAgIHJldHVybiBhID09IGIKX19lcV9fID0gZXEKCmRlZiBuZShhLCBiKToKICAgICJTYW1lIGFzIGEgIT0gYi4iCiAgICByZXR1cm4gYSAhPSBiCl9fbmVfXyA9IG5lCgpkZWYgZ2UoYSwgYik6CiAgICAiU2FtZSBhcyBhID49IGIuIgogICAgcmV0dXJuIGEgPj0gYgpfX2dlX18gPSBnZQoKZGVmIGd0KGEsIGIpOgogICAgIlNhbWUgYXMgYSA+IGIuIgogICAgcmV0dXJuIGEgPiBiCl9fZ3RfXyA9IGd0CgpkZWYgbm90XyhhKToKICAgICJTYW1lIGFzIG5vdCBhLiIKICAgIHJldHVybiBub3QgYQpfX25vdF9fID0gbm90XwoKZGVmIHRydXRoKGEpOgogICAgIlJldHVybiBUcnVlIGlmIGEgaXMgdHJ1ZSwgRmFsc2Ugb3RoZXJ3aXNlLiIKICAgICNyZXR1cm4gX2JpLmJvb2woYSkKICAgIHJldHVybiBib29sKGEpCgpkZWYgaXNfKGEsIGIpOgogICAgIlNhbWUgYXMgYSBpcyBiLiIKICAgIHJldHVybiBhIGlzIGIKCiMgYnJ5dGhvbiBkb2VzIG5vdCBsaWtlICAoY2F1c2VzIHN5bnRheCBlcnJvcikKI2RlZiBpc19ub3QoYSwgYik6CiMgICAgIlNhbWUgYXMgYSBpcyBub3QgYi4iCiMgICAgcmV0dXJuIGEgaXMgbm90IGIKCiNyZWN1cnNpb24gZXJyb3Igb3IganVzdCBjb21tZW50IG91dCBhbmQgYWRkIGNvZGUgYmVsb3cgZnVuY3Rpb24KI2RlZiBhYnMoYSk6CiMgICAgIlNhbWUgYXMgYWJzKGEpLiIKIyAgICAjcmV0dXJuIF9iaS5hYnMoYSkKIyAgICByZXR1cm4gYWJzKGEpCl9fYWJzX18gPSBhYnMKYWJzPWFicwoKCmRlZiBhZGQoYSwgYik6CiAgICAiU2FtZSBhcyBhICsgYi4iCiAgICByZXR1cm4gYSArIGIKX19hZGRfXyA9IGFkZAoKZGVmIGFuZF8oYSwgYik6CiAgICAiU2FtZSBhcyBhICYgYi4iCiAgICByZXR1cm4gYSAmIGIKX19hbmRfXyA9IGFuZF8KCmRlZiBmbG9vcmRpdihhLCBiKToKICAgICJTYW1lIGFzIGEgLy8gYi4iCiAgICByZXR1cm4gYSAvLyBiCl9fZmxvb3JkaXZfXyA9IGZsb29yZGl2CgpkZWYgaW5kZXgoYSk6CiAgICAiU2FtZSBhcyBhLl9faW5kZXhfXygpLiIKICAgIHJldHVybiBhLl9faW5kZXhfXygpCl9faW5kZXhfXyA9IGluZGV4CgpkZWYgaW52KGEpOgogICAgIlNhbWUgYXMgfmEuIgogICAgI3JldHVybiB+YSAgICAjYnJ5dGhvbiBkb2VzIG5vdCBsaWtlCiAgICByZXR1cm4gYV4oMioqMzEpCmludmVydCA9IF9faW52X18gPSBfX2ludmVydF9fID0gaW52CgpkZWYgbHNoaWZ0KGEsIGIpOgogICAgIlNhbWUgYXMgYSA8PCBiLiIKICAgIHJldHVybiBhIDw8IGIKX19sc2hpZnRfXyA9IGxzaGlmdAoKZGVmIG1vZChhLCBiKToKICAgICJTYW1lIGFzIGEgJSBiLiIKICAgIHJldHVybiBhICUgYgpfX21vZF9fID0gbW9kCgpkZWYgbXVsKGEsIGIpOgogICAgIlNhbWUgYXMgYSAqIGIuIgogICAgcmV0dXJuIGEgKiBiCl9fbXVsX18gPSBtdWwKCmRlZiBuZWcoYSk6CiAgICAiU2FtZSBhcyAtYS4iCiAgICByZXR1cm4gLWEKX19uZWdfXyA9IG5lZwoKZGVmIG9yXyhhLCBiKToKICAgICJTYW1lIGFzIGEgfCBiLiIKICAgIHJldHVybiBhIHwgYgpfX29yX18gPSBvcl8KCmRlZiBwb3MoYSk6CiAgICAiU2FtZSBhcyArYS4iCiAgICAjcmV0dXJuICthICAgICNicnl0aG9uIGRvZXMgbm90IGxpa2UKICAgIGlmIGEgPj0gMDogcmV0dXJuIGEKICAgIHJldHVybiAtYQpfX3Bvc19fID0gcG9zCgpkZWYgcG93KGEsIGIpOgogICAgIlNhbWUgYXMgYSAqKiBiLiIKICAgIHJldHVybiBhICoqIGIKX19wb3dfXyA9IHBvdwoKZGVmIHJzaGlmdChhLCBiKToKICAgICJTYW1lIGFzIGEgPj4gYi4iCiAgICByZXR1cm4gYSA+PiBiCl9fcnNoaWZ0X18gPSByc2hpZnQKCmRlZiBzdWIoYSwgYik6CiAgICAiU2FtZSBhcyBhIC0gYi4iCiAgICByZXR1cm4gYSAtIGIKX19zdWJfXyA9IHN1YgoKZGVmIHRydWVkaXYoYSwgYik6CiAgICAiU2FtZSBhcyBhIC8gYi4iCiAgICByZXR1cm4gYSAvIGIKX190cnVlZGl2X18gPSB0cnVlZGl2CgpkZWYgeG9yKGEsIGIpOgogICAgIlNhbWUgYXMgYSBeIGIuIgogICAgcmV0dXJuIGEgXiBiCl9feG9yX18gPSB4b3IKCmRlZiBjb25jYXQoYSwgYik6CiAgICAiU2FtZSBhcyBhICsgYiwgZm9yIGEgYW5kIGIgc2VxdWVuY2VzLiIKICAgIGlmIG5vdCAoaGFzYXR0cihhLCAnX19nZXRpdGVtX18nKSBhbmQgaGFzYXR0cihiLCAnX19nZXRpdGVtX18nKSk6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdhIGFuZCBiIG11c3QgYmUgc2VxdWVuY2VzJykKICAgIHJldHVybiBhICsgYgpfX2NvbmNhdF9fID0gY29uY2F0CgpkZWYgY29udGFpbnMoYSwgYik6CiAgICAiU2FtZSBhcyBiIGluIGEgKG5vdGUgcmV2ZXJzZWQgb3BlcmFuZHMpLiIKICAgIHJldHVybiBiIGluIGEKX19jb250YWluc19fID0gY29udGFpbnMKCmRlZiBjb3VudE9mKGEsIGIpOgogICAgIlJldHVybiB0aGUgbnVtYmVyIG9mIHRpbWVzIGIgb2NjdXJzIGluIGEuIgogICAgY291bnQgPSAwCiAgICBmb3IgaSBpbiBhOgogICAgICAgIGlmIGkgPT0gYjoKICAgICAgICAgICAgY291bnQgKz0gMQogICAgcmV0dXJuIGNvdW50CgpkZWYgZGVsaXRlbShhLCBiKToKICAgICJTYW1lIGFzIGRlbCBhW2JdLiIKICAgIGRlbCBhW2JdCl9fZGVsaXRlbV9fID0gZGVsaXRlbQoKZGVmIGdldGl0ZW0oYSwgYik6CiAgICAiU2FtZSBhcyBhW2JdLiIKICAgIHJldHVybiBhW2JdCl9fZ2V0aXRlbV9fID0gZ2V0aXRlbQoKI2ZpeG1lICBicnl0aG9uIGRvZXNuJ3QgbGlrZSB0aGlzIGZ1bmN0aW9uCiNkZWYgaW5kZXhPZihhLCBiKToKIyAgICAiUmV0dXJuIHRoZSBmaXJzdCBpbmRleCBvZiBiIGluIGEuIgojICAgIGZvciBpLCBqIGluIF9iaS5lbnVtZXJhdGUoYSk6CiMgICAgICAgIGlmIGogPT0gYjoKIyAgICAgICAgICAgIHJldHVybiBpCiMgICAgZWxzZToKIyAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignYiBub3QgZm91bmQgaW4gYScpCgpkZWYgc2V0aXRlbShhLCBiLCBjKToKICAgICJTYW1lIGFzIGFbYl0gPSBjLiIKICAgIGFbYl0gPSBjCl9fc2V0aXRlbV9fID0gc2V0aXRlbQoKCgpjbGFzcyBhdHRyZ2V0dGVyOgogICAgIiIiCiAgICBSZXR1cm4gYSBjYWxsYWJsZSBvYmplY3QgdGhhdCBmZXRjaGVzIHRoZSBnaXZlbiBhdHRyaWJ1dGUocykgZnJvbSBpdHMgb3BlcmFuZC4KICAgIEFmdGVyIGY9YXR0cmdldHRlcignbmFtZScpLCB0aGUgY2FsbCBmKHIpIHJldHVybnMgci5uYW1lLgogICAgQWZ0ZXIgZz1hdHRyZ2V0dGVyKCduYW1lJywgJ2RhdGUnKSwgdGhlIGNhbGwgZyhyKSByZXR1cm5zIChyLm5hbWUsIHIuZGF0ZSkuCiAgICBBZnRlciBoPWF0dHJnZXR0ZXIoJ25hbWUuZmlyc3QnLCAnbmFtZS5sYXN0JyksIHRoZSBjYWxsIGgocikgcmV0dXJucwogICAgKHIubmFtZS5maXJzdCwgci5uYW1lLmxhc3QpLgogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgYXR0ciwgKmF0dHJzKToKICAgICAgICBzZWxmLl9hdHRycyA9IChhdHRyLCkKICAgICAgICBzZWxmLl9hdHRycyArPSBhdHRycwogICAgICAgIGlmIGFueShub3QgaXNpbnN0YW5jZShhdHRyLCBzdHIpIGZvciBhdHRyIGluIHNlbGYuX2F0dHJzKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdhdHRyaWJ1dGUgbmFtZSBtdXN0IGJlIGEgc3RyaW5nJykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX3Jlc29sdmVfYXR0cihvYmosIGF0dHIpOgogICAgICAgIGZvciBuYW1lIGluIGF0dHIuc3BsaXQoJy4nKToKICAgICAgICAgICAgI29iaiA9IF9iaS5nZXRhdHRyKG9iaiwgbmFtZSkKICAgICAgICAgICAgb2JqID0gZ2V0YXR0cihvYmosIG5hbWUpCiAgICAgICAgcmV0dXJuIG9iagoKICAgIGRlZiBfX2NhbGxfXyhzZWxmLCBvYmopOgogICAgICAgIGlmIGxlbihzZWxmLl9hdHRycykgPT0gMToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX3Jlc29sdmVfYXR0cihvYmosIHNlbGYuX2F0dHJzWzBdKQogICAgICAgIHJldHVybiB0dXBsZShzZWxmLl9yZXNvbHZlX2F0dHIob2JqLCBhdHRyKSBmb3IgYXR0ciBpbiBzZWxmLl9hdHRycykKCmNsYXNzIGl0ZW1nZXR0ZXI6CiAgICAiIiIKICAgIFJldHVybiBhIGNhbGxhYmxlIG9iamVjdCB0aGF0IGZldGNoZXMgdGhlIGdpdmVuIGl0ZW0ocykgZnJvbSBpdHMgb3BlcmFuZC4KICAgIEFmdGVyIGY9aXRlbWdldHRlcigyKSwgdGhlIGNhbGwgZihyKSByZXR1cm5zIHJbMl0uCiAgICBBZnRlciBnPWl0ZW1nZXR0ZXIoMiw1LDMpLCB0aGUgY2FsbCBnKHIpIHJldHVybnMgKHJbMl0sIHJbNV0sIHJbM10pCiAgICAiIiIKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpdGVtLCAqaXRlbXMpOgogICAgICAgIHNlbGYuX2l0ZW1zID0gKGl0ZW0sKQogICAgICAgIHNlbGYuX2l0ZW1zICs9IGl0ZW1zCgogICAgZGVmIF9fY2FsbF9fKHNlbGYsIG9iaik6CiAgICAgICAgaWYgbGVuKHNlbGYuX2l0ZW1zKSA9PSAxOgogICAgICAgICAgICByZXR1cm4gb2JqW3NlbGYuX2l0ZW1zWzBdXQogICAgICAgIHJldHVybiB0dXBsZShvYmpbaXRlbV0gZm9yIGl0ZW0gaW4gc2VsZi5faXRlbXMpCgpjbGFzcyBtZXRob2RjYWxsZXI6CiAgICAiIiIKICAgIFJldHVybiBhIGNhbGxhYmxlIG9iamVjdCB0aGF0IGNhbGxzIHRoZSBnaXZlbiBtZXRob2Qgb24gaXRzIG9wZXJhbmQuCiAgICBBZnRlciBmID0gbWV0aG9kY2FsbGVyKCduYW1lJyksIHRoZSBjYWxsIGYocikgcmV0dXJucyByLm5hbWUoKS4KICAgIEFmdGVyIGcgPSBtZXRob2RjYWxsZXIoJ25hbWUnLCAnZGF0ZScsIGZvbz0xKSwgdGhlIGNhbGwgZyhyKSByZXR1cm5zCiAgICByLm5hbWUoJ2RhdGUnLCBmb289MSkuCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgbmFtZSwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICBzZWxmLl9uYW1lID0gbmFtZQogICAgICAgIHNlbGYuX2FyZ3MgPSBhcmdzCiAgICAgICAgc2VsZi5fa3dhcmdzID0ga3dhcmdzCgogICAgZGVmIF9fY2FsbF9fKHNlbGYsIG9iaik6CiAgICAgICAgcmV0dXJuIGdldGF0dHIob2JqLCBzZWxmLl9uYW1lKSgqc2VsZi5fYXJncywgKipzZWxmLl9rd2FyZ3MpCgoKZGVmIGlhZGQoYSwgYik6CiAgICAiU2FtZSBhcyBhICs9IGIuIgogICAgYSArPSBiCiAgICByZXR1cm4gYQpfX2lhZGRfXyA9IGlhZGQKCmRlZiBpYW5kKGEsIGIpOgogICAgIlNhbWUgYXMgYSAmPSBiLiIKICAgIGEgJj0gYgogICAgcmV0dXJuIGEKX19pYW5kX18gPSBpYW5kCgpkZWYgaWNvbmNhdChhLCBiKToKICAgICJTYW1lIGFzIGEgKz0gYiwgZm9yIGEgYW5kIGIgc2VxdWVuY2VzLiIKICAgIGlmIG5vdCAoaGFzYXR0cihhLCAnX19nZXRpdGVtX18nKSBhbmQgaGFzYXR0cihiLCAnX19nZXRpdGVtX18nKSk6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdhIGFuZCBiIG11c3QgYmUgc2VxdWVuY2VzJykKICAgIGEgKz0gYgogICAgcmV0dXJuIGEKX19pY29uY2F0X18gPSBpY29uY2F0CgpkZWYgaWZsb29yZGl2KGEsIGIpOgogICAgIlNhbWUgYXMgYSAvLz0gYi4iCiAgICBhIC8vPSBiCiAgICByZXR1cm4gYQpfX2lmbG9vcmRpdl9fID0gaWZsb29yZGl2CgpkZWYgaWxzaGlmdChhLCBiKToKICAgICJTYW1lIGFzIGEgPDw9IGIuIgogICAgYSA8PD0gYgogICAgcmV0dXJuIGEKX19pbHNoaWZ0X18gPSBpbHNoaWZ0CgpkZWYgaW1vZChhLCBiKToKICAgICJTYW1lIGFzIGEgJT0gYi4iCiAgICBhICU9IGIKICAgIHJldHVybiBhCl9faW1vZF9fID0gaW1vZAoKZGVmIGltdWwoYSwgYik6CiAgICAiU2FtZSBhcyBhICo9IGIuIgogICAgYSAqPSBiCiAgICByZXR1cm4gYQpfX2ltdWxfXyA9IGltdWwKCmRlZiBpb3IoYSwgYik6CiAgICAiU2FtZSBhcyBhIHw9IGIuIgogICAgYSB8PSBiCiAgICByZXR1cm4gYQpfX2lvcl9fID0gaW9yCgpkZWYgaXBvdyhhLCBiKToKICAgICJTYW1lIGFzIGEgKio9IGIuIgogICAgYSAqKj1iCiAgICByZXR1cm4gYQpfX2lwb3dfXyA9IGlwb3cKCmRlZiBpcnNoaWZ0KGEsIGIpOgogICAgIlNhbWUgYXMgYSA+Pj0gYi4iCiAgICBhID4+PSBiCiAgICByZXR1cm4gYQpfX2lyc2hpZnRfXyA9IGlyc2hpZnQKCmRlZiBpc3ViKGEsIGIpOgogICAgIlNhbWUgYXMgYSAtPSBiLiIKICAgIGEgLT0gYgogICAgcmV0dXJuIGEKX19pc3ViX18gPSBpc3ViCgpkZWYgaXRydWVkaXYoYSwgYik6CiAgICAiU2FtZSBhcyBhIC89IGIuIgogICAgYSAvPSBiCiAgICByZXR1cm4gYQpfX2l0cnVlZGl2X18gPSBpdHJ1ZWRpdgoKZGVmIGl4b3IoYSwgYik6CiAgICAiU2FtZSBhcyBhIF49IGIuIgogICAgYSBePSBiCiAgICByZXR1cm4gYQpfX2l4b3JfXyA9IGl4b3IKCmRlZiBsZW5ndGhfaGludChvYmosIGRlZmF1bHQ9MCk6CiAgICAiIiIKICAgIFJldHVybiBhbiBlc3RpbWF0ZSBvZiB0aGUgbnVtYmVyIG9mIGl0ZW1zIGluIG9iai4KICAgIFRoaXMgaXMgdXNlZnVsIGZvciBwcmVzaXppbmcgY29udGFpbmVycyB3aGVuIGJ1aWxkaW5nIGZyb20gYW4gaXRlcmFibGUuCgogICAgSWYgdGhlIG9iamVjdCBzdXBwb3J0cyBsZW4oKSwgdGhlIHJlc3VsdCB3aWxsIGJlIGV4YWN0LiBPdGhlcndpc2UsIGl0IG1heQogICAgb3Zlci0gb3IgdW5kZXItZXN0aW1hdGUgYnkgYW4gYXJiaXRyYXJ5IGFtb3VudC4gVGhlIHJlc3VsdCB3aWxsIGJlIGFuCiAgICBpbnRlZ2VyID49IDAuCiAgICAiIiIKICAgIHRyeToKICAgICAgICByZXR1cm4gbGVuKG9iaikKICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB2YWwgPSBvYmouX19sZW5ndGhfaGludF9fKCkKICAgICAgICAgICAgaWYgdmFsIGlzIE5vdEltcGxlbWVudGVkOgogICAgICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yCiAgICAgICAgZXhjZXB0IChBdHRyaWJ1dGVFcnJvciwgVHlwZUVycm9yKToKICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHQKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBub3QgdmFsID4gMDoKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoJ2RlZmF1bHQgbXVzdCBiZSA+IDAnKQogICAgICAgICAgICByZXR1cm4gdmFsCgojdHJ5OgojICAgIGZyb20gX29wZXJhdG9yIGltcG9ydCAqCiMgICAgZnJvbSBfb3BlcmF0b3IgaW1wb3J0IF9fZG9jX18KI2V4Y2VwdCBJbXBvcnRFcnJvcjoKIyAgIHBhc3MK',
'/Lib/optparse.py':'IiIiQSBwb3dlcmZ1bCwgZXh0ZW5zaWJsZSwgYW5kIGVhc3ktdG8tdXNlIG9wdGlvbiBwYXJzZXIuCgpCeSBHcmVnIFdhcmQgPGd3YXJkQHB5dGhvbi5uZXQ+CgpPcmlnaW5hbGx5IGRpc3RyaWJ1dGVkIGFzIE9wdGlrLgoKRm9yIHN1cHBvcnQsIHVzZSB0aGUgb3B0aWstdXNlcnNAbGlzdHMuc291cmNlZm9yZ2UubmV0IG1haWxpbmcgbGlzdAooaHR0cDovL2xpc3RzLnNvdXJjZWZvcmdlLm5ldC9saXN0cy9saXN0aW5mby9vcHRpay11c2VycykuCgpTaW1wbGUgdXNhZ2UgZXhhbXBsZToKCiAgIGZyb20gb3B0cGFyc2UgaW1wb3J0IE9wdGlvblBhcnNlcgoKICAgcGFyc2VyID0gT3B0aW9uUGFyc2VyKCkKICAgcGFyc2VyLmFkZF9vcHRpb24oIi1mIiwgIi0tZmlsZSIsIGRlc3Q9ImZpbGVuYW1lIiwKICAgICAgICAgICAgICAgICAgICAgaGVscD0id3JpdGUgcmVwb3J0IHRvIEZJTEUiLCBtZXRhdmFyPSJGSUxFIikKICAgcGFyc2VyLmFkZF9vcHRpb24oIi1xIiwgIi0tcXVpZXQiLAogICAgICAgICAgICAgICAgICAgICBhY3Rpb249InN0b3JlX2ZhbHNlIiwgZGVzdD0idmVyYm9zZSIsIGRlZmF1bHQ9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgaGVscD0iZG9uJ3QgcHJpbnQgc3RhdHVzIG1lc3NhZ2VzIHRvIHN0ZG91dCIpCgogICAob3B0aW9ucywgYXJncykgPSBwYXJzZXIucGFyc2VfYXJncygpCiIiIgoKX192ZXJzaW9uX18gPSAiMS41LjMiCgpfX2FsbF9fID0gWydPcHRpb24nLAogICAgICAgICAgICdtYWtlX29wdGlvbicsCiAgICAgICAgICAgJ1NVUFBSRVNTX0hFTFAnLAogICAgICAgICAgICdTVVBQUkVTU19VU0FHRScsCiAgICAgICAgICAgJ1ZhbHVlcycsCiAgICAgICAgICAgJ09wdGlvbkNvbnRhaW5lcicsCiAgICAgICAgICAgJ09wdGlvbkdyb3VwJywKICAgICAgICAgICAnT3B0aW9uUGFyc2VyJywKICAgICAgICAgICAnSGVscEZvcm1hdHRlcicsCiAgICAgICAgICAgJ0luZGVudGVkSGVscEZvcm1hdHRlcicsCiAgICAgICAgICAgJ1RpdGxlZEhlbHBGb3JtYXR0ZXInLAogICAgICAgICAgICdPcHRQYXJzZUVycm9yJywKICAgICAgICAgICAnT3B0aW9uRXJyb3InLAogICAgICAgICAgICdPcHRpb25Db25mbGljdEVycm9yJywKICAgICAgICAgICAnT3B0aW9uVmFsdWVFcnJvcicsCiAgICAgICAgICAgJ0JhZE9wdGlvbkVycm9yJ10KCl9fY29weXJpZ2h0X18gPSAiIiIKQ29weXJpZ2h0IChjKSAyMDAxLTIwMDYgR3JlZ29yeSBQLiBXYXJkLiAgQWxsIHJpZ2h0cyByZXNlcnZlZC4KQ29weXJpZ2h0IChjKSAyMDAyLTIwMDYgUHl0aG9uIFNvZnR3YXJlIEZvdW5kYXRpb24uICBBbGwgcmlnaHRzIHJlc2VydmVkLgoKUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0Cm1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUKbWV0OgoKICAqIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0CiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuCgogICogUmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQKICAgIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbiB0aGUKICAgIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZSBkaXN0cmlidXRpb24uCgogICogTmVpdGhlciB0aGUgbmFtZSBvZiB0aGUgYXV0aG9yIG5vciB0aGUgbmFtZXMgb2YgaXRzCiAgICBjb250cmlidXRvcnMgbWF5IGJlIHVzZWQgdG8gZW5kb3JzZSBvciBwcm9tb3RlIHByb2R1Y3RzIGRlcml2ZWQgZnJvbQogICAgdGhpcyBzb2Z0d2FyZSB3aXRob3V0IHNwZWNpZmljIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi4KClRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgVEhFIENPUFlSSUdIVCBIT0xERVJTIEFORCBDT05UUklCVVRPUlMgIkFTCklTIiBBTkQgQU5ZIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRApUTywgVEhFIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEKUEFSVElDVUxBUiBQVVJQT1NFIEFSRSBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SIE9SCkNPTlRSSUJVVE9SUyBCRSBMSUFCTEUgRk9SIEFOWSBESVJFQ1QsIElORElSRUNULCBJTkNJREVOVEFMLCBTUEVDSUFMLApFWEVNUExBUlksIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyAoSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sClBST0NVUkVNRU5UIE9GIFNVQlNUSVRVVEUgR09PRFMgT1IgU0VSVklDRVM7IExPU1MgT0YgVVNFLCBEQVRBLCBPUgpQUk9GSVRTOyBPUiBCVVNJTkVTUyBJTlRFUlJVUFRJT04pIEhPV0VWRVIgQ0FVU0VEIEFORCBPTiBBTlkgVEhFT1JZIE9GCkxJQUJJTElUWSwgV0hFVEhFUiBJTiBDT05UUkFDVCwgU1RSSUNUIExJQUJJTElUWSwgT1IgVE9SVCAoSU5DTFVESU5HCk5FR0xJR0VOQ0UgT1IgT1RIRVJXSVNFKSBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GIFRIRSBVU0UgT0YgVEhJUwpTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS4KIiIiCgppbXBvcnQgc3lzLCBvcwppbXBvcnQgdGV4dHdyYXAKCmRlZiBfcmVwcihzZWxmKToKICAgIHJldHVybiAiPCVzIGF0IDB4JXg6ICVzPiIgJSAoc2VsZi5fX2NsYXNzX18uX19uYW1lX18sIGlkKHNlbGYpLCBzZWxmKQoKCiMgVGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgZnJvbToKIyAgIElkOiBvcHRpb25fcGFyc2VyLnB5IDUyNyAyMDA2LTA3LTIzIDE1OjIxOjMwWiBncmVnCiMgICBJZDogb3B0aW9uLnB5IDUyMiAyMDA2LTA2LTExIDE2OjIyOjAzWiBnd2FyZAojICAgSWQ6IGhlbHAucHkgNTI3IDIwMDYtMDctMjMgMTU6MjE6MzBaIGdyZWcKIyAgIElkOiBlcnJvcnMucHkgNTA5IDIwMDYtMDQtMjAgMDA6NTg6MjRaIGd3YXJkCgp0cnk6CiAgICBmcm9tIGdldHRleHQgaW1wb3J0IGdldHRleHQsIG5nZXR0ZXh0CmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIGRlZiBnZXR0ZXh0KG1lc3NhZ2UpOgogICAgICAgIHJldHVybiBtZXNzYWdlCgogICAgZGVmIG5nZXR0ZXh0KHNpbmd1bGFyLCBwbHVyYWwsIG4pOgogICAgICAgIGlmIG4gPT0gMToKICAgICAgICAgICAgcmV0dXJuIHNpbmd1bGFyCiAgICAgICAgcmV0dXJuIHBsdXJhbAoKXyA9IGdldHRleHQKCgpjbGFzcyBPcHRQYXJzZUVycm9yIChFeGNlcHRpb24pOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG1zZyk6CiAgICAgICAgc2VsZi5tc2cgPSBtc2cKCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5tc2cKCgpjbGFzcyBPcHRpb25FcnJvciAoT3B0UGFyc2VFcnJvcik6CiAgICAiIiIKICAgIFJhaXNlZCBpZiBhbiBPcHRpb24gaW5zdGFuY2UgaXMgY3JlYXRlZCB3aXRoIGludmFsaWQgb3IKICAgIGluY29uc2lzdGVudCBhcmd1bWVudHMuCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgbXNnLCBvcHRpb24pOgogICAgICAgIHNlbGYubXNnID0gbXNnCiAgICAgICAgc2VsZi5vcHRpb25faWQgPSBzdHIob3B0aW9uKQoKICAgIGRlZiBfX3N0cl9fKHNlbGYpOgogICAgICAgIGlmIHNlbGYub3B0aW9uX2lkOgogICAgICAgICAgICByZXR1cm4gIm9wdGlvbiAlczogJXMiICUgKHNlbGYub3B0aW9uX2lkLCBzZWxmLm1zZykKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gc2VsZi5tc2cKCmNsYXNzIE9wdGlvbkNvbmZsaWN0RXJyb3IgKE9wdGlvbkVycm9yKToKICAgICIiIgogICAgUmFpc2VkIGlmIGNvbmZsaWN0aW5nIG9wdGlvbnMgYXJlIGFkZGVkIHRvIGFuIE9wdGlvblBhcnNlci4KICAgICIiIgoKY2xhc3MgT3B0aW9uVmFsdWVFcnJvciAoT3B0UGFyc2VFcnJvcik6CiAgICAiIiIKICAgIFJhaXNlZCBpZiBhbiBpbnZhbGlkIG9wdGlvbiB2YWx1ZSBpcyBlbmNvdW50ZXJlZCBvbiB0aGUgY29tbWFuZAogICAgbGluZS4KICAgICIiIgoKY2xhc3MgQmFkT3B0aW9uRXJyb3IgKE9wdFBhcnNlRXJyb3IpOgogICAgIiIiCiAgICBSYWlzZWQgaWYgYW4gaW52YWxpZCBvcHRpb24gaXMgc2VlbiBvbiB0aGUgY29tbWFuZCBsaW5lLgogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgb3B0X3N0cik6CiAgICAgICAgc2VsZi5vcHRfc3RyID0gb3B0X3N0cgoKICAgIGRlZiBfX3N0cl9fKHNlbGYpOgogICAgICAgIHJldHVybiBfKCJubyBzdWNoIG9wdGlvbjogJXMiKSAlIHNlbGYub3B0X3N0cgoKY2xhc3MgQW1iaWd1b3VzT3B0aW9uRXJyb3IgKEJhZE9wdGlvbkVycm9yKToKICAgICIiIgogICAgUmFpc2VkIGlmIGFuIGFtYmlndW91cyBvcHRpb24gaXMgc2VlbiBvbiB0aGUgY29tbWFuZCBsaW5lLgogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgb3B0X3N0ciwgcG9zc2liaWxpdGllcyk6CiAgICAgICAgQmFkT3B0aW9uRXJyb3IuX19pbml0X18oc2VsZiwgb3B0X3N0cikKICAgICAgICBzZWxmLnBvc3NpYmlsaXRpZXMgPSBwb3NzaWJpbGl0aWVzCgogICAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIChfKCJhbWJpZ3VvdXMgb3B0aW9uOiAlcyAoJXM/KSIpCiAgICAgICAgICAgICAgICAlIChzZWxmLm9wdF9zdHIsICIsICIuam9pbihzZWxmLnBvc3NpYmlsaXRpZXMpKSkKCgpjbGFzcyBIZWxwRm9ybWF0dGVyOgoKICAgICIiIgogICAgQWJzdHJhY3QgYmFzZSBjbGFzcyBmb3IgZm9ybWF0dGluZyBvcHRpb24gaGVscC4gIE9wdGlvblBhcnNlcgogICAgaW5zdGFuY2VzIHNob3VsZCB1c2Ugb25lIG9mIHRoZSBIZWxwRm9ybWF0dGVyIHN1YmNsYXNzZXMgZm9yCiAgICBmb3JtYXR0aW5nIGhlbHA7IGJ5IGRlZmF1bHQgSW5kZW50ZWRIZWxwRm9ybWF0dGVyIGlzIHVzZWQuCgogICAgSW5zdGFuY2UgYXR0cmlidXRlczoKICAgICAgcGFyc2VyIDogT3B0aW9uUGFyc2VyCiAgICAgICAgdGhlIGNvbnRyb2xsaW5nIE9wdGlvblBhcnNlciBpbnN0YW5jZQogICAgICBpbmRlbnRfaW5jcmVtZW50IDogaW50CiAgICAgICAgdGhlIG51bWJlciBvZiBjb2x1bW5zIHRvIGluZGVudCBwZXIgbmVzdGluZyBsZXZlbAogICAgICBtYXhfaGVscF9wb3NpdGlvbiA6IGludAogICAgICAgIHRoZSBtYXhpbXVtIHN0YXJ0aW5nIGNvbHVtbiBmb3Igb3B0aW9uIGhlbHAgdGV4dAogICAgICBoZWxwX3Bvc2l0aW9uIDogaW50CiAgICAgICAgdGhlIGNhbGN1bGF0ZWQgc3RhcnRpbmcgY29sdW1uIGZvciBvcHRpb24gaGVscCB0ZXh0OwogICAgICAgIGluaXRpYWxseSB0aGUgc2FtZSBhcyB0aGUgbWF4aW11bQogICAgICB3aWR0aCA6IGludAogICAgICAgIHRvdGFsIG51bWJlciBvZiBjb2x1bW5zIGZvciBvdXRwdXQgKHBhc3MgTm9uZSB0byBjb25zdHJ1Y3RvciBmb3IKICAgICAgICB0aGlzIHZhbHVlIHRvIGJlIHRha2VuIGZyb20gdGhlICRDT0xVTU5TIGVudmlyb25tZW50IHZhcmlhYmxlKQogICAgICBsZXZlbCA6IGludAogICAgICAgIGN1cnJlbnQgaW5kZW50YXRpb24gbGV2ZWwKICAgICAgY3VycmVudF9pbmRlbnQgOiBpbnQKICAgICAgICBjdXJyZW50IGluZGVudGF0aW9uIGxldmVsIChpbiBjb2x1bW5zKQogICAgICBoZWxwX3dpZHRoIDogaW50CiAgICAgICAgbnVtYmVyIG9mIGNvbHVtbnMgYXZhaWxhYmxlIGZvciBvcHRpb24gaGVscCB0ZXh0IChjYWxjdWxhdGVkKQogICAgICBkZWZhdWx0X3RhZyA6IHN0cgogICAgICAgIHRleHQgdG8gcmVwbGFjZSB3aXRoIGVhY2ggb3B0aW9uJ3MgZGVmYXVsdCB2YWx1ZSwgIiVkZWZhdWx0IgogICAgICAgIGJ5IGRlZmF1bHQuICBTZXQgdG8gZmFsc2UgdmFsdWUgdG8gZGlzYWJsZSBkZWZhdWx0IHZhbHVlIGV4cGFuc2lvbi4KICAgICAgb3B0aW9uX3N0cmluZ3MgOiB7IE9wdGlvbiA6IHN0ciB9CiAgICAgICAgbWFwcyBPcHRpb24gaW5zdGFuY2VzIHRvIHRoZSBzbmlwcGV0IG9mIGhlbHAgdGV4dCBleHBsYWluaW5nCiAgICAgICAgdGhlIHN5bnRheCBvZiB0aGF0IG9wdGlvbiwgZS5nLiAiLWgsIC0taGVscCIgb3IKICAgICAgICAiLWZGSUxFLCAtLWZpbGU9RklMRSIKICAgICAgX3Nob3J0X29wdF9mbXQgOiBzdHIKICAgICAgICBmb3JtYXQgc3RyaW5nIGNvbnRyb2xsaW5nIGhvdyBzaG9ydCBvcHRpb25zIHdpdGggdmFsdWVzIGFyZQogICAgICAgIHByaW50ZWQgaW4gaGVscCB0ZXh0LiAgTXVzdCBiZSBlaXRoZXIgIiVzJXMiICgiLWZGSUxFIikgb3IKICAgICAgICAiJXMgJXMiICgiLWYgRklMRSIpLCBiZWNhdXNlIHRob3NlIGFyZSB0aGUgdHdvIHN5bnRheGVzIHRoYXQKICAgICAgICBPcHRpayBzdXBwb3J0cy4KICAgICAgX2xvbmdfb3B0X2ZtdCA6IHN0cgogICAgICAgIHNpbWlsYXIgYnV0IGZvciBsb25nIG9wdGlvbnM7IG11c3QgYmUgZWl0aGVyICIlcyAlcyIgKCItLWZpbGUgRklMRSIpCiAgICAgICAgb3IgIiVzPSVzIiAoIi0tZmlsZT1GSUxFIikuCiAgICAiIiIKCiAgICBOT19ERUZBVUxUX1ZBTFVFID0gIm5vbmUiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsCiAgICAgICAgICAgICAgICAgaW5kZW50X2luY3JlbWVudCwKICAgICAgICAgICAgICAgICBtYXhfaGVscF9wb3NpdGlvbiwKICAgICAgICAgICAgICAgICB3aWR0aCwKICAgICAgICAgICAgICAgICBzaG9ydF9maXJzdCk6CiAgICAgICAgc2VsZi5wYXJzZXIgPSBOb25lCiAgICAgICAgc2VsZi5pbmRlbnRfaW5jcmVtZW50ID0gaW5kZW50X2luY3JlbWVudAogICAgICAgIHNlbGYuaGVscF9wb3NpdGlvbiA9IHNlbGYubWF4X2hlbHBfcG9zaXRpb24gPSBtYXhfaGVscF9wb3NpdGlvbgogICAgICAgIGlmIHdpZHRoIGlzIE5vbmU6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHdpZHRoID0gaW50KG9zLmVudmlyb25bJ0NPTFVNTlMnXSkKICAgICAgICAgICAgZXhjZXB0IChLZXlFcnJvciwgVmFsdWVFcnJvcik6CiAgICAgICAgICAgICAgICB3aWR0aCA9IDgwCiAgICAgICAgICAgIHdpZHRoIC09IDIKICAgICAgICBzZWxmLndpZHRoID0gd2lkdGgKICAgICAgICBzZWxmLmN1cnJlbnRfaW5kZW50ID0gMAogICAgICAgIHNlbGYubGV2ZWwgPSAwCiAgICAgICAgc2VsZi5oZWxwX3dpZHRoID0gTm9uZSAgICAgICAgICAjIGNvbXB1dGVkIGxhdGVyCiAgICAgICAgc2VsZi5zaG9ydF9maXJzdCA9IHNob3J0X2ZpcnN0CiAgICAgICAgc2VsZi5kZWZhdWx0X3RhZyA9ICIlZGVmYXVsdCIKICAgICAgICBzZWxmLm9wdGlvbl9zdHJpbmdzID0ge30KICAgICAgICBzZWxmLl9zaG9ydF9vcHRfZm10ID0gIiVzICVzIgogICAgICAgIHNlbGYuX2xvbmdfb3B0X2ZtdCA9ICIlcz0lcyIKCiAgICBkZWYgc2V0X3BhcnNlcihzZWxmLCBwYXJzZXIpOgogICAgICAgIHNlbGYucGFyc2VyID0gcGFyc2VyCgogICAgZGVmIHNldF9zaG9ydF9vcHRfZGVsaW1pdGVyKHNlbGYsIGRlbGltKToKICAgICAgICBpZiBkZWxpbSBub3QgaW4gKCIiLCAiICIpOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKAogICAgICAgICAgICAgICAgImludmFsaWQgbWV0YXZhciBkZWxpbWl0ZXIgZm9yIHNob3J0IG9wdGlvbnM6ICVyIiAlIGRlbGltKQogICAgICAgIHNlbGYuX3Nob3J0X29wdF9mbXQgPSAiJXMiICsgZGVsaW0gKyAiJXMiCgogICAgZGVmIHNldF9sb25nX29wdF9kZWxpbWl0ZXIoc2VsZiwgZGVsaW0pOgogICAgICAgIGlmIGRlbGltIG5vdCBpbiAoIj0iLCAiICIpOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKAogICAgICAgICAgICAgICAgImludmFsaWQgbWV0YXZhciBkZWxpbWl0ZXIgZm9yIGxvbmcgb3B0aW9uczogJXIiICUgZGVsaW0pCiAgICAgICAgc2VsZi5fbG9uZ19vcHRfZm10ID0gIiVzIiArIGRlbGltICsgIiVzIgoKICAgIGRlZiBpbmRlbnQoc2VsZik6CiAgICAgICAgc2VsZi5jdXJyZW50X2luZGVudCArPSBzZWxmLmluZGVudF9pbmNyZW1lbnQKICAgICAgICBzZWxmLmxldmVsICs9IDEKCiAgICBkZWYgZGVkZW50KHNlbGYpOgogICAgICAgIHNlbGYuY3VycmVudF9pbmRlbnQgLT0gc2VsZi5pbmRlbnRfaW5jcmVtZW50CiAgICAgICAgYXNzZXJ0IHNlbGYuY3VycmVudF9pbmRlbnQgPj0gMCwgIkluZGVudCBkZWNyZWFzZWQgYmVsb3cgMC4iCiAgICAgICAgc2VsZi5sZXZlbCAtPSAxCgogICAgZGVmIGZvcm1hdF91c2FnZShzZWxmLCB1c2FnZSk6CiAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcigic3ViY2xhc3NlcyBtdXN0IGltcGxlbWVudCIpCgogICAgZGVmIGZvcm1hdF9oZWFkaW5nKHNlbGYsIGhlYWRpbmcpOgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoInN1YmNsYXNzZXMgbXVzdCBpbXBsZW1lbnQiKQoKICAgIGRlZiBfZm9ybWF0X3RleHQoc2VsZiwgdGV4dCk6CiAgICAgICAgIiIiCiAgICAgICAgRm9ybWF0IGEgcGFyYWdyYXBoIG9mIGZyZWUtZm9ybSB0ZXh0IGZvciBpbmNsdXNpb24gaW4gdGhlCiAgICAgICAgaGVscCBvdXRwdXQgYXQgdGhlIGN1cnJlbnQgaW5kZW50YXRpb24gbGV2ZWwuCiAgICAgICAgIiIiCiAgICAgICAgdGV4dF93aWR0aCA9IHNlbGYud2lkdGggLSBzZWxmLmN1cnJlbnRfaW5kZW50CiAgICAgICAgaW5kZW50ID0gIiAiKnNlbGYuY3VycmVudF9pbmRlbnQKICAgICAgICByZXR1cm4gdGV4dHdyYXAuZmlsbCh0ZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRfd2lkdGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdGlhbF9pbmRlbnQ9aW5kZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNlcXVlbnRfaW5kZW50PWluZGVudCkKCiAgICBkZWYgZm9ybWF0X2Rlc2NyaXB0aW9uKHNlbGYsIGRlc2NyaXB0aW9uKToKICAgICAgICBpZiBkZXNjcmlwdGlvbjoKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2Zvcm1hdF90ZXh0KGRlc2NyaXB0aW9uKSArICJcbiIKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gIiIKCiAgICBkZWYgZm9ybWF0X2VwaWxvZyhzZWxmLCBlcGlsb2cpOgogICAgICAgIGlmIGVwaWxvZzoKICAgICAgICAgICAgcmV0dXJuICJcbiIgKyBzZWxmLl9mb3JtYXRfdGV4dChlcGlsb2cpICsgIlxuIgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiAiIgoKCiAgICBkZWYgZXhwYW5kX2RlZmF1bHQoc2VsZiwgb3B0aW9uKToKICAgICAgICBpZiBzZWxmLnBhcnNlciBpcyBOb25lIG9yIG5vdCBzZWxmLmRlZmF1bHRfdGFnOgogICAgICAgICAgICByZXR1cm4gb3B0aW9uLmhlbHAKCiAgICAgICAgZGVmYXVsdF92YWx1ZSA9IHNlbGYucGFyc2VyLmRlZmF1bHRzLmdldChvcHRpb24uZGVzdCkKICAgICAgICBpZiBkZWZhdWx0X3ZhbHVlIGlzIE5PX0RFRkFVTFQgb3IgZGVmYXVsdF92YWx1ZSBpcyBOb25lOgogICAgICAgICAgICBkZWZhdWx0X3ZhbHVlID0gc2VsZi5OT19ERUZBVUxUX1ZBTFVFCgogICAgICAgIHJldHVybiBvcHRpb24uaGVscC5yZXBsYWNlKHNlbGYuZGVmYXVsdF90YWcsIHN0cihkZWZhdWx0X3ZhbHVlKSkKCiAgICBkZWYgZm9ybWF0X29wdGlvbihzZWxmLCBvcHRpb24pOgogICAgICAgICMgVGhlIGhlbHAgZm9yIGVhY2ggb3B0aW9uIGNvbnNpc3RzIG9mIHR3byBwYXJ0czoKICAgICAgICAjICAgKiB0aGUgb3B0IHN0cmluZ3MgYW5kIG1ldGF2YXJzCiAgICAgICAgIyAgICAgZWcuICgiLXgiLCBvciAiLWZGSUxFTkFNRSwgLS1maWxlPUZJTEVOQU1FIikKICAgICAgICAjICAgKiB0aGUgdXNlci1zdXBwbGllZCBoZWxwIHN0cmluZwogICAgICAgICMgICAgIGVnLiAoInR1cm4gb24gZXhwZXJ0IG1vZGUiLCAicmVhZCBkYXRhIGZyb20gRklMRU5BTUUiKQogICAgICAgICMKICAgICAgICAjIElmIHBvc3NpYmxlLCB3ZSB3cml0ZSBib3RoIG9mIHRoZXNlIG9uIHRoZSBzYW1lIGxpbmU6CiAgICAgICAgIyAgIC14ICAgICAgdHVybiBvbiBleHBlcnQgbW9kZQogICAgICAgICMKICAgICAgICAjIEJ1dCBpZiB0aGUgb3B0IHN0cmluZyBsaXN0IGlzIHRvbyBsb25nLCB3ZSBwdXQgdGhlIGhlbHAKICAgICAgICAjIHN0cmluZyBvbiBhIHNlY29uZCBsaW5lLCBpbmRlbnRlZCB0byB0aGUgc2FtZSBjb2x1bW4gaXQgd291bGQKICAgICAgICAjIHN0YXJ0IGluIGlmIGl0IGZpdCBvbiB0aGUgZmlyc3QgbGluZS4KICAgICAgICAjICAgLWZGSUxFTkFNRSwgLS1maWxlPUZJTEVOQU1FCiAgICAgICAgIyAgICAgICAgICAgcmVhZCBkYXRhIGZyb20gRklMRU5BTUUKICAgICAgICByZXN1bHQgPSBbXQogICAgICAgIG9wdHMgPSBzZWxmLm9wdGlvbl9zdHJpbmdzW29wdGlvbl0KICAgICAgICBvcHRfd2lkdGggPSBzZWxmLmhlbHBfcG9zaXRpb24gLSBzZWxmLmN1cnJlbnRfaW5kZW50IC0gMgogICAgICAgIGlmIGxlbihvcHRzKSA+IG9wdF93aWR0aDoKICAgICAgICAgICAgb3B0cyA9ICIlKnMlc1xuIiAlIChzZWxmLmN1cnJlbnRfaW5kZW50LCAiIiwgb3B0cykKICAgICAgICAgICAgaW5kZW50X2ZpcnN0ID0gc2VsZi5oZWxwX3Bvc2l0aW9uCiAgICAgICAgZWxzZTogICAgICAgICAgICAgICAgICAgICAgICMgc3RhcnQgaGVscCBvbiBzYW1lIGxpbmUgYXMgb3B0cwogICAgICAgICAgICBvcHRzID0gIiUqcyUtKnMgICIgJSAoc2VsZi5jdXJyZW50X2luZGVudCwgIiIsIG9wdF93aWR0aCwgb3B0cykKICAgICAgICAgICAgaW5kZW50X2ZpcnN0ID0gMAogICAgICAgIHJlc3VsdC5hcHBlbmQob3B0cykKICAgICAgICBpZiBvcHRpb24uaGVscDoKICAgICAgICAgICAgaGVscF90ZXh0ID0gc2VsZi5leHBhbmRfZGVmYXVsdChvcHRpb24pCiAgICAgICAgICAgIGhlbHBfbGluZXMgPSB0ZXh0d3JhcC53cmFwKGhlbHBfdGV4dCwgc2VsZi5oZWxwX3dpZHRoKQogICAgICAgICAgICByZXN1bHQuYXBwZW5kKCIlKnMlc1xuIiAlIChpbmRlbnRfZmlyc3QsICIiLCBoZWxwX2xpbmVzWzBdKSkKICAgICAgICAgICAgcmVzdWx0LmV4dGVuZChbIiUqcyVzXG4iICUgKHNlbGYuaGVscF9wb3NpdGlvbiwgIiIsIGxpbmUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBsaW5lIGluIGhlbHBfbGluZXNbMTpdXSkKICAgICAgICBlbGlmIG9wdHNbLTFdICE9ICJcbiI6CiAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoIlxuIikKICAgICAgICByZXR1cm4gIiIuam9pbihyZXN1bHQpCgogICAgZGVmIHN0b3JlX29wdGlvbl9zdHJpbmdzKHNlbGYsIHBhcnNlcik6CiAgICAgICAgc2VsZi5pbmRlbnQoKQogICAgICAgIG1heF9sZW4gPSAwCiAgICAgICAgZm9yIG9wdCBpbiBwYXJzZXIub3B0aW9uX2xpc3Q6CiAgICAgICAgICAgIHN0cmluZ3MgPSBzZWxmLmZvcm1hdF9vcHRpb25fc3RyaW5ncyhvcHQpCiAgICAgICAgICAgIHNlbGYub3B0aW9uX3N0cmluZ3Nbb3B0XSA9IHN0cmluZ3MKICAgICAgICAgICAgbWF4X2xlbiA9IG1heChtYXhfbGVuLCBsZW4oc3RyaW5ncykgKyBzZWxmLmN1cnJlbnRfaW5kZW50KQogICAgICAgIHNlbGYuaW5kZW50KCkKICAgICAgICBmb3IgZ3JvdXAgaW4gcGFyc2VyLm9wdGlvbl9ncm91cHM6CiAgICAgICAgICAgIGZvciBvcHQgaW4gZ3JvdXAub3B0aW9uX2xpc3Q6CiAgICAgICAgICAgICAgICBzdHJpbmdzID0gc2VsZi5mb3JtYXRfb3B0aW9uX3N0cmluZ3Mob3B0KQogICAgICAgICAgICAgICAgc2VsZi5vcHRpb25fc3RyaW5nc1tvcHRdID0gc3RyaW5ncwogICAgICAgICAgICAgICAgbWF4X2xlbiA9IG1heChtYXhfbGVuLCBsZW4oc3RyaW5ncykgKyBzZWxmLmN1cnJlbnRfaW5kZW50KQogICAgICAgIHNlbGYuZGVkZW50KCkKICAgICAgICBzZWxmLmRlZGVudCgpCiAgICAgICAgc2VsZi5oZWxwX3Bvc2l0aW9uID0gbWluKG1heF9sZW4gKyAyLCBzZWxmLm1heF9oZWxwX3Bvc2l0aW9uKQogICAgICAgIHNlbGYuaGVscF93aWR0aCA9IHNlbGYud2lkdGggLSBzZWxmLmhlbHBfcG9zaXRpb24KCiAgICBkZWYgZm9ybWF0X29wdGlvbl9zdHJpbmdzKHNlbGYsIG9wdGlvbik6CiAgICAgICAgIiIiUmV0dXJuIGEgY29tbWEtc2VwYXJhdGVkIGxpc3Qgb2Ygb3B0aW9uIHN0cmluZ3MgJiBtZXRhdmFyaWFibGVzLiIiIgogICAgICAgIGlmIG9wdGlvbi50YWtlc192YWx1ZSgpOgogICAgICAgICAgICBtZXRhdmFyID0gb3B0aW9uLm1ldGF2YXIgb3Igb3B0aW9uLmRlc3QudXBwZXIoKQogICAgICAgICAgICBzaG9ydF9vcHRzID0gW3NlbGYuX3Nob3J0X29wdF9mbXQgJSAoc29wdCwgbWV0YXZhcikKICAgICAgICAgICAgICAgICAgICAgICAgICBmb3Igc29wdCBpbiBvcHRpb24uX3Nob3J0X29wdHNdCiAgICAgICAgICAgIGxvbmdfb3B0cyA9IFtzZWxmLl9sb25nX29wdF9mbXQgJSAobG9wdCwgbWV0YXZhcikKICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBsb3B0IGluIG9wdGlvbi5fbG9uZ19vcHRzXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNob3J0X29wdHMgPSBvcHRpb24uX3Nob3J0X29wdHMKICAgICAgICAgICAgbG9uZ19vcHRzID0gb3B0aW9uLl9sb25nX29wdHMKCiAgICAgICAgaWYgc2VsZi5zaG9ydF9maXJzdDoKICAgICAgICAgICAgb3B0cyA9IHNob3J0X29wdHMgKyBsb25nX29wdHMKICAgICAgICBlbHNlOgogICAgICAgICAgICBvcHRzID0gbG9uZ19vcHRzICsgc2hvcnRfb3B0cwoKICAgICAgICByZXR1cm4gIiwgIi5qb2luKG9wdHMpCgpjbGFzcyBJbmRlbnRlZEhlbHBGb3JtYXR0ZXIgKEhlbHBGb3JtYXR0ZXIpOgogICAgIiIiRm9ybWF0IGhlbHAgd2l0aCBpbmRlbnRlZCBzZWN0aW9uIGJvZGllcy4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLAogICAgICAgICAgICAgICAgIGluZGVudF9pbmNyZW1lbnQ9MiwKICAgICAgICAgICAgICAgICBtYXhfaGVscF9wb3NpdGlvbj0yNCwKICAgICAgICAgICAgICAgICB3aWR0aD1Ob25lLAogICAgICAgICAgICAgICAgIHNob3J0X2ZpcnN0PTEpOgogICAgICAgIEhlbHBGb3JtYXR0ZXIuX19pbml0X18oCiAgICAgICAgICAgIHNlbGYsIGluZGVudF9pbmNyZW1lbnQsIG1heF9oZWxwX3Bvc2l0aW9uLCB3aWR0aCwgc2hvcnRfZmlyc3QpCgogICAgZGVmIGZvcm1hdF91c2FnZShzZWxmLCB1c2FnZSk6CiAgICAgICAgcmV0dXJuIF8oIlVzYWdlOiAlc1xuIikgJSB1c2FnZQoKICAgIGRlZiBmb3JtYXRfaGVhZGluZyhzZWxmLCBoZWFkaW5nKToKICAgICAgICByZXR1cm4gIiUqcyVzOlxuIiAlIChzZWxmLmN1cnJlbnRfaW5kZW50LCAiIiwgaGVhZGluZykKCgpjbGFzcyBUaXRsZWRIZWxwRm9ybWF0dGVyIChIZWxwRm9ybWF0dGVyKToKICAgICIiIkZvcm1hdCBoZWxwIHdpdGggdW5kZXJsaW5lZCBzZWN0aW9uIGhlYWRlcnMuCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwKICAgICAgICAgICAgICAgICBpbmRlbnRfaW5jcmVtZW50PTAsCiAgICAgICAgICAgICAgICAgbWF4X2hlbHBfcG9zaXRpb249MjQsCiAgICAgICAgICAgICAgICAgd2lkdGg9Tm9uZSwKICAgICAgICAgICAgICAgICBzaG9ydF9maXJzdD0wKToKICAgICAgICBIZWxwRm9ybWF0dGVyLl9faW5pdF9fICgKICAgICAgICAgICAgc2VsZiwgaW5kZW50X2luY3JlbWVudCwgbWF4X2hlbHBfcG9zaXRpb24sIHdpZHRoLCBzaG9ydF9maXJzdCkKCiAgICBkZWYgZm9ybWF0X3VzYWdlKHNlbGYsIHVzYWdlKToKICAgICAgICByZXR1cm4gIiVzICAlc1xuIiAlIChzZWxmLmZvcm1hdF9oZWFkaW5nKF8oIlVzYWdlIikpLCB1c2FnZSkKCiAgICBkZWYgZm9ybWF0X2hlYWRpbmcoc2VsZiwgaGVhZGluZyk6CiAgICAgICAgcmV0dXJuICIlc1xuJXNcbiIgJSAoaGVhZGluZywgIj0tIltzZWxmLmxldmVsXSAqIGxlbihoZWFkaW5nKSkKCgpkZWYgX3BhcnNlX251bSh2YWwsIHR5cGUpOgogICAgaWYgdmFsWzoyXS5sb3dlcigpID09ICIweCI6ICAgICAgICAgIyBoZXhhZGVjaW1hbAogICAgICAgIHJhZGl4ID0gMTYKICAgIGVsaWYgdmFsWzoyXS5sb3dlcigpID09ICIwYiI6ICAgICAgICMgYmluYXJ5CiAgICAgICAgcmFkaXggPSAyCiAgICAgICAgdmFsID0gdmFsWzI6XSBvciAiMCIgICAgICAgICAgICAjIGhhdmUgdG8gcmVtb3ZlICIwYiIgcHJlZml4CiAgICBlbGlmIHZhbFs6MV0gPT0gIjAiOiAgICAgICAgICAgICAgICAjIG9jdGFsCiAgICAgICAgcmFkaXggPSA4CiAgICBlbHNlOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGRlY2ltYWwKICAgICAgICByYWRpeCA9IDEwCgogICAgcmV0dXJuIHR5cGUodmFsLCByYWRpeCkKCmRlZiBfcGFyc2VfaW50KHZhbCk6CiAgICByZXR1cm4gX3BhcnNlX251bSh2YWwsIGludCkKCl9idWlsdGluX2N2dCA9IHsgImludCIgOiAoX3BhcnNlX2ludCwgXygiaW50ZWdlciIpKSwKICAgICAgICAgICAgICAgICAibG9uZyIgOiAoX3BhcnNlX2ludCwgXygiaW50ZWdlciIpKSwKICAgICAgICAgICAgICAgICAiZmxvYXQiIDogKGZsb2F0LCBfKCJmbG9hdGluZy1wb2ludCIpKSwKICAgICAgICAgICAgICAgICAiY29tcGxleCIgOiAoY29tcGxleCwgXygiY29tcGxleCIpKSB9CgpkZWYgY2hlY2tfYnVpbHRpbihvcHRpb24sIG9wdCwgdmFsdWUpOgogICAgKGN2dCwgd2hhdCkgPSBfYnVpbHRpbl9jdnRbb3B0aW9uLnR5cGVdCiAgICB0cnk6CiAgICAgICAgcmV0dXJuIGN2dCh2YWx1ZSkKICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgIHJhaXNlIE9wdGlvblZhbHVlRXJyb3IoCiAgICAgICAgICAgIF8oIm9wdGlvbiAlczogaW52YWxpZCAlcyB2YWx1ZTogJXIiKSAlIChvcHQsIHdoYXQsIHZhbHVlKSkKCmRlZiBjaGVja19jaG9pY2Uob3B0aW9uLCBvcHQsIHZhbHVlKToKICAgIGlmIHZhbHVlIGluIG9wdGlvbi5jaG9pY2VzOgogICAgICAgIHJldHVybiB2YWx1ZQogICAgZWxzZToKICAgICAgICBjaG9pY2VzID0gIiwgIi5qb2luKG1hcChyZXByLCBvcHRpb24uY2hvaWNlcykpCiAgICAgICAgcmFpc2UgT3B0aW9uVmFsdWVFcnJvcigKICAgICAgICAgICAgXygib3B0aW9uICVzOiBpbnZhbGlkIGNob2ljZTogJXIgKGNob29zZSBmcm9tICVzKSIpCiAgICAgICAgICAgICUgKG9wdCwgdmFsdWUsIGNob2ljZXMpKQoKIyBOb3Qgc3VwcGx5aW5nIGEgZGVmYXVsdCBpcyBkaWZmZXJlbnQgZnJvbSBhIGRlZmF1bHQgb2YgTm9uZSwKIyBzbyB3ZSBuZWVkIGFuIGV4cGxpY2l0ICJub3Qgc3VwcGxpZWQiIHZhbHVlLgpOT19ERUZBVUxUID0gKCJOTyIsICJERUZBVUxUIikKCgpjbGFzcyBPcHRpb246CiAgICAiIiIKICAgIEluc3RhbmNlIGF0dHJpYnV0ZXM6CiAgICAgIF9zaG9ydF9vcHRzIDogW3N0cmluZ10KICAgICAgX2xvbmdfb3B0cyA6IFtzdHJpbmddCgogICAgICBhY3Rpb24gOiBzdHJpbmcKICAgICAgdHlwZSA6IHN0cmluZwogICAgICBkZXN0IDogc3RyaW5nCiAgICAgIGRlZmF1bHQgOiBhbnkKICAgICAgbmFyZ3MgOiBpbnQKICAgICAgY29uc3QgOiBhbnkKICAgICAgY2hvaWNlcyA6IFtzdHJpbmddCiAgICAgIGNhbGxiYWNrIDogZnVuY3Rpb24KICAgICAgY2FsbGJhY2tfYXJncyA6IChhbnkqKQogICAgICBjYWxsYmFja19rd2FyZ3MgOiB7IHN0cmluZyA6IGFueSB9CiAgICAgIGhlbHAgOiBzdHJpbmcKICAgICAgbWV0YXZhciA6IHN0cmluZwogICAgIiIiCgogICAgIyBUaGUgbGlzdCBvZiBpbnN0YW5jZSBhdHRyaWJ1dGVzIHRoYXQgbWF5IGJlIHNldCB0aHJvdWdoCiAgICAjIGtleXdvcmQgYXJncyB0byB0aGUgY29uc3RydWN0b3IuCiAgICBBVFRSUyA9IFsnYWN0aW9uJywKICAgICAgICAgICAgICd0eXBlJywKICAgICAgICAgICAgICdkZXN0JywKICAgICAgICAgICAgICdkZWZhdWx0JywKICAgICAgICAgICAgICduYXJncycsCiAgICAgICAgICAgICAnY29uc3QnLAogICAgICAgICAgICAgJ2Nob2ljZXMnLAogICAgICAgICAgICAgJ2NhbGxiYWNrJywKICAgICAgICAgICAgICdjYWxsYmFja19hcmdzJywKICAgICAgICAgICAgICdjYWxsYmFja19rd2FyZ3MnLAogICAgICAgICAgICAgJ2hlbHAnLAogICAgICAgICAgICAgJ21ldGF2YXInXQoKICAgICMgVGhlIHNldCBvZiBhY3Rpb25zIGFsbG93ZWQgYnkgb3B0aW9uIHBhcnNlcnMuICBFeHBsaWNpdGx5IGxpc3RlZAogICAgIyBoZXJlIHNvIHRoZSBjb25zdHJ1Y3RvciBjYW4gdmFsaWRhdGUgaXRzIGFyZ3VtZW50cy4KICAgIEFDVElPTlMgPSAoInN0b3JlIiwKICAgICAgICAgICAgICAgInN0b3JlX2NvbnN0IiwKICAgICAgICAgICAgICAgInN0b3JlX3RydWUiLAogICAgICAgICAgICAgICAic3RvcmVfZmFsc2UiLAogICAgICAgICAgICAgICAiYXBwZW5kIiwKICAgICAgICAgICAgICAgImFwcGVuZF9jb25zdCIsCiAgICAgICAgICAgICAgICJjb3VudCIsCiAgICAgICAgICAgICAgICJjYWxsYmFjayIsCiAgICAgICAgICAgICAgICJoZWxwIiwKICAgICAgICAgICAgICAgInZlcnNpb24iKQoKICAgICMgVGhlIHNldCBvZiBhY3Rpb25zIHRoYXQgaW52b2x2ZSBzdG9yaW5nIGEgdmFsdWUgc29tZXdoZXJlOwogICAgIyBhbHNvIGxpc3RlZCBqdXN0IGZvciBjb25zdHJ1Y3RvciBhcmd1bWVudCB2YWxpZGF0aW9uLiAgKElmCiAgICAjIHRoZSBhY3Rpb24gaXMgb25lIG9mIHRoZXNlLCB0aGVyZSBtdXN0IGJlIGEgZGVzdGluYXRpb24uKQogICAgU1RPUkVfQUNUSU9OUyA9ICgic3RvcmUiLAogICAgICAgICAgICAgICAgICAgICAic3RvcmVfY29uc3QiLAogICAgICAgICAgICAgICAgICAgICAic3RvcmVfdHJ1ZSIsCiAgICAgICAgICAgICAgICAgICAgICJzdG9yZV9mYWxzZSIsCiAgICAgICAgICAgICAgICAgICAgICJhcHBlbmQiLAogICAgICAgICAgICAgICAgICAgICAiYXBwZW5kX2NvbnN0IiwKICAgICAgICAgICAgICAgICAgICAgImNvdW50IikKCiAgICAjIFRoZSBzZXQgb2YgYWN0aW9ucyBmb3Igd2hpY2ggaXQgbWFrZXMgc2Vuc2UgdG8gc3VwcGx5IGEgdmFsdWUKICAgICMgdHlwZSwgaWUuIHdoaWNoIG1heSBjb25zdW1lIGFuIGFyZ3VtZW50IGZyb20gdGhlIGNvbW1hbmQgbGluZS4KICAgIFRZUEVEX0FDVElPTlMgPSAoInN0b3JlIiwKICAgICAgICAgICAgICAgICAgICAgImFwcGVuZCIsCiAgICAgICAgICAgICAgICAgICAgICJjYWxsYmFjayIpCgogICAgIyBUaGUgc2V0IG9mIGFjdGlvbnMgd2hpY2ggKnJlcXVpcmUqIGEgdmFsdWUgdHlwZSwgaWUuIHRoYXQKICAgICMgYWx3YXlzIGNvbnN1bWUgYW4gYXJndW1lbnQgZnJvbSB0aGUgY29tbWFuZCBsaW5lLgogICAgQUxXQVlTX1RZUEVEX0FDVElPTlMgPSAoInN0b3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJhcHBlbmQiKQoKICAgICMgVGhlIHNldCBvZiBhY3Rpb25zIHdoaWNoIHRha2UgYSAnY29uc3QnIGF0dHJpYnV0ZS4KICAgIENPTlNUX0FDVElPTlMgPSAoInN0b3JlX2NvbnN0IiwKICAgICAgICAgICAgICAgICAgICAgImFwcGVuZF9jb25zdCIpCgogICAgIyBUaGUgc2V0IG9mIGtub3duIHR5cGVzIGZvciBvcHRpb24gcGFyc2Vycy4gIEFnYWluLCBsaXN0ZWQgaGVyZSBmb3IKICAgICMgY29uc3RydWN0b3IgYXJndW1lbnQgdmFsaWRhdGlvbi4KICAgIFRZUEVTID0gKCJzdHJpbmciLCAiaW50IiwgImxvbmciLCAiZmxvYXQiLCAiY29tcGxleCIsICJjaG9pY2UiKQoKICAgICMgRGljdGlvbmFyeSBvZiBhcmd1bWVudCBjaGVja2luZyBmdW5jdGlvbnMsIHdoaWNoIGNvbnZlcnQgYW5kCiAgICAjIHZhbGlkYXRlIG9wdGlvbiBhcmd1bWVudHMgYWNjb3JkaW5nIHRvIHRoZSBvcHRpb24gdHlwZS4KICAgICMKICAgICMgU2lnbmF0dXJlIG9mIGNoZWNraW5nIGZ1bmN0aW9ucyBpczoKICAgICMgICBjaGVjayhvcHRpb24gOiBPcHRpb24sIG9wdCA6IHN0cmluZywgdmFsdWUgOiBzdHJpbmcpIC0+IGFueQogICAgIyB3aGVyZQogICAgIyAgIG9wdGlvbiBpcyB0aGUgT3B0aW9uIGluc3RhbmNlIGNhbGxpbmcgdGhlIGNoZWNrZXIKICAgICMgICBvcHQgaXMgdGhlIGFjdHVhbCBvcHRpb24gc2VlbiBvbiB0aGUgY29tbWFuZC1saW5lCiAgICAjICAgICAoZWcuICItYSIsICItLWZpbGUiKQogICAgIyAgIHZhbHVlIGlzIHRoZSBvcHRpb24gYXJndW1lbnQgc2VlbiBvbiB0aGUgY29tbWFuZC1saW5lCiAgICAjCiAgICAjIFRoZSByZXR1cm4gdmFsdWUgc2hvdWxkIGJlIGluIHRoZSBhcHByb3ByaWF0ZSBQeXRob24gdHlwZQogICAgIyBmb3Igb3B0aW9uLnR5cGUgLS0gZWcuIGFuIGludGVnZXIgaWYgb3B0aW9uLnR5cGUgPT0gImludCIuCiAgICAjCiAgICAjIElmIG5vIGNoZWNrZXIgaXMgZGVmaW5lZCBmb3IgYSB0eXBlLCBhcmd1bWVudHMgd2lsbCBiZQogICAgIyB1bmNoZWNrZWQgYW5kIHJlbWFpbiBzdHJpbmdzLgogICAgVFlQRV9DSEVDS0VSID0geyAiaW50IiAgICA6IGNoZWNrX2J1aWx0aW4sCiAgICAgICAgICAgICAgICAgICAgICJsb25nIiAgIDogY2hlY2tfYnVpbHRpbiwKICAgICAgICAgICAgICAgICAgICAgImZsb2F0IiAgOiBjaGVja19idWlsdGluLAogICAgICAgICAgICAgICAgICAgICAiY29tcGxleCI6IGNoZWNrX2J1aWx0aW4sCiAgICAgICAgICAgICAgICAgICAgICJjaG9pY2UiIDogY2hlY2tfY2hvaWNlLAogICAgICAgICAgICAgICAgICAgfQoKCiAgICAjIENIRUNLX01FVEhPRFMgaXMgYSBsaXN0IG9mIHVuYm91bmQgbWV0aG9kIG9iamVjdHM7IHRoZXkgYXJlIGNhbGxlZAogICAgIyBieSB0aGUgY29uc3RydWN0b3IsIGluIG9yZGVyLCBhZnRlciBhbGwgYXR0cmlidXRlcyBhcmUKICAgICMgaW5pdGlhbGl6ZWQuICBUaGUgbGlzdCBpcyBjcmVhdGVkIGFuZCBmaWxsZWQgaW4gbGF0ZXIsIGFmdGVyIGFsbAogICAgIyB0aGUgbWV0aG9kcyBhcmUgYWN0dWFsbHkgZGVmaW5lZC4gIChJIGp1c3QgcHV0IGl0IGhlcmUgYmVjYXVzZSBJCiAgICAjIGxpa2UgdG8gZGVmaW5lIGFuZCBkb2N1bWVudCBhbGwgY2xhc3MgYXR0cmlidXRlcyBpbiB0aGUgc2FtZQogICAgIyBwbGFjZS4pICBTdWJjbGFzc2VzIHRoYXQgYWRkIGFub3RoZXIgX2NoZWNrXyooKSBtZXRob2Qgc2hvdWxkCiAgICAjIGRlZmluZSB0aGVpciBvd24gQ0hFQ0tfTUVUSE9EUyBsaXN0IHRoYXQgYWRkcyB0aGVpciBjaGVjayBtZXRob2QKICAgICMgdG8gdGhvc2UgZnJvbSB0aGlzIGNsYXNzLgogICAgQ0hFQ0tfTUVUSE9EUyA9IE5vbmUKCgogICAgIyAtLSBDb25zdHJ1Y3Rvci9pbml0aWFsaXphdGlvbiBtZXRob2RzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgX19pbml0X18oc2VsZiwgKm9wdHMsICoqYXR0cnMpOgogICAgICAgICMgU2V0IF9zaG9ydF9vcHRzLCBfbG9uZ19vcHRzIGF0dHJzIGZyb20gJ29wdHMnIHR1cGxlLgogICAgICAgICMgSGF2ZSB0byBiZSBzZXQgbm93LCBpbiBjYXNlIG5vIG9wdGlvbiBzdHJpbmdzIGFyZSBzdXBwbGllZC4KICAgICAgICBzZWxmLl9zaG9ydF9vcHRzID0gW10KICAgICAgICBzZWxmLl9sb25nX29wdHMgPSBbXQogICAgICAgIG9wdHMgPSBzZWxmLl9jaGVja19vcHRfc3RyaW5ncyhvcHRzKQogICAgICAgIHNlbGYuX3NldF9vcHRfc3RyaW5ncyhvcHRzKQoKICAgICAgICAjIFNldCBhbGwgb3RoZXIgYXR0cnMgKGFjdGlvbiwgdHlwZSwgZXRjLikgZnJvbSAnYXR0cnMnIGRpY3QKICAgICAgICBzZWxmLl9zZXRfYXR0cnMoYXR0cnMpCgogICAgICAgICMgQ2hlY2sgYWxsIHRoZSBhdHRyaWJ1dGVzIHdlIGp1c3Qgc2V0LiAgVGhlcmUgYXJlIGxvdHMgb2YKICAgICAgICAjIGNvbXBsaWNhdGVkIGludGVyZGVwZW5kZW5jaWVzLCBidXQgbHVja2lseSB0aGV5IGNhbiBiZSBmYXJtZWQKICAgICAgICAjIG91dCB0byB0aGUgX2NoZWNrXyooKSBtZXRob2RzIGxpc3RlZCBpbiBDSEVDS19NRVRIT0RTIC0tIHdoaWNoCiAgICAgICAgIyBjb3VsZCBiZSBoYW5keSBmb3Igc3ViY2xhc3NlcyEgIFRoZSBvbmUgdGhpbmcgdGhlc2UgYWxsIHNoYXJlCiAgICAgICAgIyBpcyB0aGF0IHRoZXkgcmFpc2UgT3B0aW9uRXJyb3IgaWYgdGhleSBkaXNjb3ZlciBhIHByb2JsZW0uCiAgICAgICAgZm9yIGNoZWNrZXIgaW4gc2VsZi5DSEVDS19NRVRIT0RTOgogICAgICAgICAgICBjaGVja2VyKHNlbGYpCgogICAgZGVmIF9jaGVja19vcHRfc3RyaW5ncyhzZWxmLCBvcHRzKToKICAgICAgICAjIEZpbHRlciBvdXQgTm9uZSBiZWNhdXNlIGVhcmx5IHZlcnNpb25zIG9mIE9wdGlrIGhhZCBleGFjdGx5CiAgICAgICAgIyBvbmUgc2hvcnQgb3B0aW9uIGFuZCBvbmUgbG9uZyBvcHRpb24sIGVpdGhlciBvZiB3aGljaAogICAgICAgICMgY291bGQgYmUgTm9uZS4KICAgICAgICBvcHRzID0gW29wdCBmb3Igb3B0IGluIG9wdHMgaWYgb3B0XQogICAgICAgIGlmIG5vdCBvcHRzOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImF0IGxlYXN0IG9uZSBvcHRpb24gc3RyaW5nIG11c3QgYmUgc3VwcGxpZWQiKQogICAgICAgIHJldHVybiBvcHRzCgogICAgZGVmIF9zZXRfb3B0X3N0cmluZ3Moc2VsZiwgb3B0cyk6CiAgICAgICAgZm9yIG9wdCBpbiBvcHRzOgogICAgICAgICAgICBpZiBsZW4ob3B0KSA8IDI6CiAgICAgICAgICAgICAgICByYWlzZSBPcHRpb25FcnJvcigKICAgICAgICAgICAgICAgICAgICAiaW52YWxpZCBvcHRpb24gc3RyaW5nICVyOiAiCiAgICAgICAgICAgICAgICAgICAgIm11c3QgYmUgYXQgbGVhc3QgdHdvIGNoYXJhY3RlcnMgbG9uZyIgJSBvcHQsIHNlbGYpCiAgICAgICAgICAgIGVsaWYgbGVuKG9wdCkgPT0gMjoKICAgICAgICAgICAgICAgIGlmIG5vdCAob3B0WzBdID09ICItIiBhbmQgb3B0WzFdICE9ICItIik6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgT3B0aW9uRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgICAgICJpbnZhbGlkIHNob3J0IG9wdGlvbiBzdHJpbmcgJXI6ICIKICAgICAgICAgICAgICAgICAgICAgICAgIm11c3QgYmUgb2YgdGhlIGZvcm0gLXgsICh4IGFueSBub24tZGFzaCBjaGFyKSIgJSBvcHQsCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYpCiAgICAgICAgICAgICAgICBzZWxmLl9zaG9ydF9vcHRzLmFwcGVuZChvcHQpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpZiBub3QgKG9wdFswOjJdID09ICItLSIgYW5kIG9wdFsyXSAhPSAiLSIpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlIE9wdGlvbkVycm9yKAogICAgICAgICAgICAgICAgICAgICAgICAiaW52YWxpZCBsb25nIG9wdGlvbiBzdHJpbmcgJXI6ICIKICAgICAgICAgICAgICAgICAgICAgICAgIm11c3Qgc3RhcnQgd2l0aCAtLSwgZm9sbG93ZWQgYnkgbm9uLWRhc2giICUgb3B0LAogICAgICAgICAgICAgICAgICAgICAgICBzZWxmKQogICAgICAgICAgICAgICAgc2VsZi5fbG9uZ19vcHRzLmFwcGVuZChvcHQpCgogICAgZGVmIF9zZXRfYXR0cnMoc2VsZiwgYXR0cnMpOgogICAgICAgIGZvciBhdHRyIGluIHNlbGYuQVRUUlM6CiAgICAgICAgICAgIGlmIGF0dHIgaW4gYXR0cnM6CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsIGF0dHIsIGF0dHJzW2F0dHJdKQogICAgICAgICAgICAgICAgZGVsIGF0dHJzW2F0dHJdCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpZiBhdHRyID09ICdkZWZhdWx0JzoKICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsIGF0dHIsIE5PX0RFRkFVTFQpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwgYXR0ciwgTm9uZSkKICAgICAgICBpZiBhdHRyczoKICAgICAgICAgICAgYXR0cnMgPSBzb3J0ZWQoYXR0cnMua2V5cygpKQogICAgICAgICAgICByYWlzZSBPcHRpb25FcnJvcigKICAgICAgICAgICAgICAgICJpbnZhbGlkIGtleXdvcmQgYXJndW1lbnRzOiAlcyIgJSAiLCAiLmpvaW4oYXR0cnMpLAogICAgICAgICAgICAgICAgc2VsZikKCgogICAgIyAtLSBDb25zdHJ1Y3RvciB2YWxpZGF0aW9uIG1ldGhvZHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgX2NoZWNrX2FjdGlvbihzZWxmKToKICAgICAgICBpZiBzZWxmLmFjdGlvbiBpcyBOb25lOgogICAgICAgICAgICBzZWxmLmFjdGlvbiA9ICJzdG9yZSIKICAgICAgICBlbGlmIHNlbGYuYWN0aW9uIG5vdCBpbiBzZWxmLkFDVElPTlM6CiAgICAgICAgICAgIHJhaXNlIE9wdGlvbkVycm9yKCJpbnZhbGlkIGFjdGlvbjogJXIiICUgc2VsZi5hY3Rpb24sIHNlbGYpCgogICAgZGVmIF9jaGVja190eXBlKHNlbGYpOgogICAgICAgIGlmIHNlbGYudHlwZSBpcyBOb25lOgogICAgICAgICAgICBpZiBzZWxmLmFjdGlvbiBpbiBzZWxmLkFMV0FZU19UWVBFRF9BQ1RJT05TOgogICAgICAgICAgICAgICAgaWYgc2VsZi5jaG9pY2VzIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgICMgVGhlICJjaG9pY2VzIiBhdHRyaWJ1dGUgaW1wbGllcyAiY2hvaWNlIiB0eXBlLgogICAgICAgICAgICAgICAgICAgIHNlbGYudHlwZSA9ICJjaG9pY2UiCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICMgTm8gdHlwZSBnaXZlbj8gICJzdHJpbmciIGlzIHRoZSBtb3N0IHNlbnNpYmxlIGRlZmF1bHQuCiAgICAgICAgICAgICAgICAgICAgc2VsZi50eXBlID0gInN0cmluZyIKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIEFsbG93IHR5cGUgb2JqZWN0cyBvciBidWlsdGluIHR5cGUgY29udmVyc2lvbiBmdW5jdGlvbnMKICAgICAgICAgICAgIyAoaW50LCBzdHIsIGV0Yy4pIGFzIGFuIGFsdGVybmF0aXZlIHRvIHRoZWlyIG5hbWVzLiAgKFRoZQogICAgICAgICAgICAjIGNvbXBsaWNhdGVkIGNoZWNrIG9mIGJ1aWx0aW5zIGlzIG9ubHkgbmVjZXNzYXJ5IGZvcgogICAgICAgICAgICAjIFB5dGhvbiAyLjEgYW5kIGVhcmxpZXIsIGFuZCBpcyBzaG9ydC1jaXJjdWl0ZWQgYnkgdGhlCiAgICAgICAgICAgICMgZmlyc3QgY2hlY2sgb24gbW9kZXJuIFB5dGhvbnMuKQogICAgICAgICAgICBpbXBvcnQgYnVpbHRpbnMKICAgICAgICAgICAgaWYgKCBpc2luc3RhbmNlKHNlbGYudHlwZSwgdHlwZSkgb3IKICAgICAgICAgICAgICAgICAoaGFzYXR0cihzZWxmLnR5cGUsICJfX25hbWVfXyIpIGFuZAogICAgICAgICAgICAgICAgICBnZXRhdHRyKGJ1aWx0aW5zLCBzZWxmLnR5cGUuX19uYW1lX18sIE5vbmUpIGlzIHNlbGYudHlwZSkgKToKICAgICAgICAgICAgICAgIHNlbGYudHlwZSA9IHNlbGYudHlwZS5fX25hbWVfXwoKICAgICAgICAgICAgaWYgc2VsZi50eXBlID09ICJzdHIiOgogICAgICAgICAgICAgICAgc2VsZi50eXBlID0gInN0cmluZyIKCiAgICAgICAgICAgIGlmIHNlbGYudHlwZSBub3QgaW4gc2VsZi5UWVBFUzoKICAgICAgICAgICAgICAgIHJhaXNlIE9wdGlvbkVycm9yKCJpbnZhbGlkIG9wdGlvbiB0eXBlOiAlciIgJSBzZWxmLnR5cGUsIHNlbGYpCiAgICAgICAgICAgIGlmIHNlbGYuYWN0aW9uIG5vdCBpbiBzZWxmLlRZUEVEX0FDVElPTlM6CiAgICAgICAgICAgICAgICByYWlzZSBPcHRpb25FcnJvcigKICAgICAgICAgICAgICAgICAgICAibXVzdCBub3Qgc3VwcGx5IGEgdHlwZSBmb3IgYWN0aW9uICVyIiAlIHNlbGYuYWN0aW9uLCBzZWxmKQoKICAgIGRlZiBfY2hlY2tfY2hvaWNlKHNlbGYpOgogICAgICAgIGlmIHNlbGYudHlwZSA9PSAiY2hvaWNlIjoKICAgICAgICAgICAgaWYgc2VsZi5jaG9pY2VzIGlzIE5vbmU6CiAgICAgICAgICAgICAgICByYWlzZSBPcHRpb25FcnJvcigKICAgICAgICAgICAgICAgICAgICAibXVzdCBzdXBwbHkgYSBsaXN0IG9mIGNob2ljZXMgZm9yIHR5cGUgJ2Nob2ljZSciLCBzZWxmKQogICAgICAgICAgICBlbGlmIG5vdCBpc2luc3RhbmNlKHNlbGYuY2hvaWNlcywgKHR1cGxlLCBsaXN0KSk6CiAgICAgICAgICAgICAgICByYWlzZSBPcHRpb25FcnJvcigKICAgICAgICAgICAgICAgICAgICAiY2hvaWNlcyBtdXN0IGJlIGEgbGlzdCBvZiBzdHJpbmdzICgnJXMnIHN1cHBsaWVkKSIKICAgICAgICAgICAgICAgICAgICAlIHN0cih0eXBlKHNlbGYuY2hvaWNlcykpLnNwbGl0KCInIilbMV0sIHNlbGYpCiAgICAgICAgZWxpZiBzZWxmLmNob2ljZXMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJhaXNlIE9wdGlvbkVycm9yKAogICAgICAgICAgICAgICAgIm11c3Qgbm90IHN1cHBseSBjaG9pY2VzIGZvciB0eXBlICVyIiAlIHNlbGYudHlwZSwgc2VsZikKCiAgICBkZWYgX2NoZWNrX2Rlc3Qoc2VsZik6CiAgICAgICAgIyBObyBkZXN0aW5hdGlvbiBnaXZlbiwgYW5kIHdlIG5lZWQgb25lIGZvciB0aGlzIGFjdGlvbi4gIFRoZQogICAgICAgICMgc2VsZi50eXBlIGNoZWNrIGlzIGZvciBjYWxsYmFja3MgdGhhdCB0YWtlIGEgdmFsdWUuCiAgICAgICAgdGFrZXNfdmFsdWUgPSAoc2VsZi5hY3Rpb24gaW4gc2VsZi5TVE9SRV9BQ1RJT05TIG9yCiAgICAgICAgICAgICAgICAgICAgICAgc2VsZi50eXBlIGlzIG5vdCBOb25lKQogICAgICAgIGlmIHNlbGYuZGVzdCBpcyBOb25lIGFuZCB0YWtlc192YWx1ZToKCiAgICAgICAgICAgICMgR2xlYW4gYSBkZXN0aW5hdGlvbiBmcm9tIHRoZSBmaXJzdCBsb25nIG9wdGlvbiBzdHJpbmcsCiAgICAgICAgICAgICMgb3IgZnJvbSB0aGUgZmlyc3Qgc2hvcnQgb3B0aW9uIHN0cmluZyBpZiBubyBsb25nIG9wdGlvbnMuCiAgICAgICAgICAgIGlmIHNlbGYuX2xvbmdfb3B0czoKICAgICAgICAgICAgICAgICMgZWcuICItLWZvby1iYXIiIC0+ICJmb29fYmFyIgogICAgICAgICAgICAgICAgc2VsZi5kZXN0ID0gc2VsZi5fbG9uZ19vcHRzWzBdWzI6XS5yZXBsYWNlKCctJywgJ18nKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5kZXN0ID0gc2VsZi5fc2hvcnRfb3B0c1swXVsxXQoKICAgIGRlZiBfY2hlY2tfY29uc3Qoc2VsZik6CiAgICAgICAgaWYgc2VsZi5hY3Rpb24gbm90IGluIHNlbGYuQ09OU1RfQUNUSU9OUyBhbmQgc2VsZi5jb25zdCBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmFpc2UgT3B0aW9uRXJyb3IoCiAgICAgICAgICAgICAgICAiJ2NvbnN0JyBtdXN0IG5vdCBiZSBzdXBwbGllZCBmb3IgYWN0aW9uICVyIiAlIHNlbGYuYWN0aW9uLAogICAgICAgICAgICAgICAgc2VsZikKCiAgICBkZWYgX2NoZWNrX25hcmdzKHNlbGYpOgogICAgICAgIGlmIHNlbGYuYWN0aW9uIGluIHNlbGYuVFlQRURfQUNUSU9OUzoKICAgICAgICAgICAgaWYgc2VsZi5uYXJncyBpcyBOb25lOgogICAgICAgICAgICAgICAgc2VsZi5uYXJncyA9IDEKICAgICAgICBlbGlmIHNlbGYubmFyZ3MgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJhaXNlIE9wdGlvbkVycm9yKAogICAgICAgICAgICAgICAgIiduYXJncycgbXVzdCBub3QgYmUgc3VwcGxpZWQgZm9yIGFjdGlvbiAlciIgJSBzZWxmLmFjdGlvbiwKICAgICAgICAgICAgICAgIHNlbGYpCgogICAgZGVmIF9jaGVja19jYWxsYmFjayhzZWxmKToKICAgICAgICBpZiBzZWxmLmFjdGlvbiA9PSAiY2FsbGJhY2siOgogICAgICAgICAgICBpZiBub3QgY2FsbGFibGUoc2VsZi5jYWxsYmFjayk6CiAgICAgICAgICAgICAgICByYWlzZSBPcHRpb25FcnJvcigKICAgICAgICAgICAgICAgICAgICAiY2FsbGJhY2sgbm90IGNhbGxhYmxlOiAlciIgJSBzZWxmLmNhbGxiYWNrLCBzZWxmKQogICAgICAgICAgICBpZiAoc2VsZi5jYWxsYmFja19hcmdzIGlzIG5vdCBOb25lIGFuZAogICAgICAgICAgICAgICAgbm90IGlzaW5zdGFuY2Uoc2VsZi5jYWxsYmFja19hcmdzLCB0dXBsZSkpOgogICAgICAgICAgICAgICAgcmFpc2UgT3B0aW9uRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgImNhbGxiYWNrX2FyZ3MsIGlmIHN1cHBsaWVkLCBtdXN0IGJlIGEgdHVwbGU6IG5vdCAlciIKICAgICAgICAgICAgICAgICAgICAlIHNlbGYuY2FsbGJhY2tfYXJncywgc2VsZikKICAgICAgICAgICAgaWYgKHNlbGYuY2FsbGJhY2tfa3dhcmdzIGlzIG5vdCBOb25lIGFuZAogICAgICAgICAgICAgICAgbm90IGlzaW5zdGFuY2Uoc2VsZi5jYWxsYmFja19rd2FyZ3MsIGRpY3QpKToKICAgICAgICAgICAgICAgIHJhaXNlIE9wdGlvbkVycm9yKAogICAgICAgICAgICAgICAgICAgICJjYWxsYmFja19rd2FyZ3MsIGlmIHN1cHBsaWVkLCBtdXN0IGJlIGEgZGljdDogbm90ICVyIgogICAgICAgICAgICAgICAgICAgICUgc2VsZi5jYWxsYmFja19rd2FyZ3MsIHNlbGYpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgc2VsZi5jYWxsYmFjayBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHJhaXNlIE9wdGlvbkVycm9yKAogICAgICAgICAgICAgICAgICAgICJjYWxsYmFjayBzdXBwbGllZCAoJXIpIGZvciBub24tY2FsbGJhY2sgb3B0aW9uIgogICAgICAgICAgICAgICAgICAgICUgc2VsZi5jYWxsYmFjaywgc2VsZikKICAgICAgICAgICAgaWYgc2VsZi5jYWxsYmFja19hcmdzIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgcmFpc2UgT3B0aW9uRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgImNhbGxiYWNrX2FyZ3Mgc3VwcGxpZWQgZm9yIG5vbi1jYWxsYmFjayBvcHRpb24iLCBzZWxmKQogICAgICAgICAgICBpZiBzZWxmLmNhbGxiYWNrX2t3YXJncyBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHJhaXNlIE9wdGlvbkVycm9yKAogICAgICAgICAgICAgICAgICAgICJjYWxsYmFja19rd2FyZ3Mgc3VwcGxpZWQgZm9yIG5vbi1jYWxsYmFjayBvcHRpb24iLCBzZWxmKQoKCiAgICBDSEVDS19NRVRIT0RTID0gW19jaGVja19hY3Rpb24sCiAgICAgICAgICAgICAgICAgICAgIF9jaGVja190eXBlLAogICAgICAgICAgICAgICAgICAgICBfY2hlY2tfY2hvaWNlLAogICAgICAgICAgICAgICAgICAgICBfY2hlY2tfZGVzdCwKICAgICAgICAgICAgICAgICAgICAgX2NoZWNrX2NvbnN0LAogICAgICAgICAgICAgICAgICAgICBfY2hlY2tfbmFyZ3MsCiAgICAgICAgICAgICAgICAgICAgIF9jaGVja19jYWxsYmFja10KCgogICAgIyAtLSBNaXNjZWxsYW5lb3VzIG1ldGhvZHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gIi8iLmpvaW4oc2VsZi5fc2hvcnRfb3B0cyArIHNlbGYuX2xvbmdfb3B0cykKCiAgICBfX3JlcHJfXyA9IF9yZXByCgogICAgZGVmIHRha2VzX3ZhbHVlKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLnR5cGUgaXMgbm90IE5vbmUKCiAgICBkZWYgZ2V0X29wdF9zdHJpbmcoc2VsZik6CiAgICAgICAgaWYgc2VsZi5fbG9uZ19vcHRzOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fbG9uZ19vcHRzWzBdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX3Nob3J0X29wdHNbMF0KCgogICAgIyAtLSBQcm9jZXNzaW5nIG1ldGhvZHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgY2hlY2tfdmFsdWUoc2VsZiwgb3B0LCB2YWx1ZSk6CiAgICAgICAgY2hlY2tlciA9IHNlbGYuVFlQRV9DSEVDS0VSLmdldChzZWxmLnR5cGUpCiAgICAgICAgaWYgY2hlY2tlciBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gdmFsdWUKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gY2hlY2tlcihzZWxmLCBvcHQsIHZhbHVlKQoKICAgIGRlZiBjb252ZXJ0X3ZhbHVlKHNlbGYsIG9wdCwgdmFsdWUpOgogICAgICAgIGlmIHZhbHVlIGlzIG5vdCBOb25lOgogICAgICAgICAgICBpZiBzZWxmLm5hcmdzID09IDE6CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5jaGVja192YWx1ZShvcHQsIHZhbHVlKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmV0dXJuIHR1cGxlKFtzZWxmLmNoZWNrX3ZhbHVlKG9wdCwgdikgZm9yIHYgaW4gdmFsdWVdKQoKICAgIGRlZiBwcm9jZXNzKHNlbGYsIG9wdCwgdmFsdWUsIHZhbHVlcywgcGFyc2VyKToKCiAgICAgICAgIyBGaXJzdCwgY29udmVydCB0aGUgdmFsdWUocykgdG8gdGhlIHJpZ2h0IHR5cGUuICBIb3dsIGlmIGFueQogICAgICAgICMgdmFsdWUocykgYXJlIGJvZ3VzLgogICAgICAgIHZhbHVlID0gc2VsZi5jb252ZXJ0X3ZhbHVlKG9wdCwgdmFsdWUpCgogICAgICAgICMgQW5kIHRoZW4gdGFrZSB3aGF0ZXZlciBhY3Rpb24gaXMgZXhwZWN0ZWQgb2YgdXMuCiAgICAgICAgIyBUaGlzIGlzIGEgc2VwYXJhdGUgbWV0aG9kIHRvIG1ha2UgbGlmZSBlYXNpZXIgZm9yCiAgICAgICAgIyBzdWJjbGFzc2VzIHRvIGFkZCBuZXcgYWN0aW9ucy4KICAgICAgICByZXR1cm4gc2VsZi50YWtlX2FjdGlvbigKICAgICAgICAgICAgc2VsZi5hY3Rpb24sIHNlbGYuZGVzdCwgb3B0LCB2YWx1ZSwgdmFsdWVzLCBwYXJzZXIpCgogICAgZGVmIHRha2VfYWN0aW9uKHNlbGYsIGFjdGlvbiwgZGVzdCwgb3B0LCB2YWx1ZSwgdmFsdWVzLCBwYXJzZXIpOgogICAgICAgIGlmIGFjdGlvbiA9PSAic3RvcmUiOgogICAgICAgICAgICBzZXRhdHRyKHZhbHVlcywgZGVzdCwgdmFsdWUpCiAgICAgICAgZWxpZiBhY3Rpb24gPT0gInN0b3JlX2NvbnN0IjoKICAgICAgICAgICAgc2V0YXR0cih2YWx1ZXMsIGRlc3QsIHNlbGYuY29uc3QpCiAgICAgICAgZWxpZiBhY3Rpb24gPT0gInN0b3JlX3RydWUiOgogICAgICAgICAgICBzZXRhdHRyKHZhbHVlcywgZGVzdCwgVHJ1ZSkKICAgICAgICBlbGlmIGFjdGlvbiA9PSAic3RvcmVfZmFsc2UiOgogICAgICAgICAgICBzZXRhdHRyKHZhbHVlcywgZGVzdCwgRmFsc2UpCiAgICAgICAgZWxpZiBhY3Rpb24gPT0gImFwcGVuZCI6CiAgICAgICAgICAgIHZhbHVlcy5lbnN1cmVfdmFsdWUoZGVzdCwgW10pLmFwcGVuZCh2YWx1ZSkKICAgICAgICBlbGlmIGFjdGlvbiA9PSAiYXBwZW5kX2NvbnN0IjoKICAgICAgICAgICAgdmFsdWVzLmVuc3VyZV92YWx1ZShkZXN0LCBbXSkuYXBwZW5kKHNlbGYuY29uc3QpCiAgICAgICAgZWxpZiBhY3Rpb24gPT0gImNvdW50IjoKICAgICAgICAgICAgc2V0YXR0cih2YWx1ZXMsIGRlc3QsIHZhbHVlcy5lbnN1cmVfdmFsdWUoZGVzdCwgMCkgKyAxKQogICAgICAgIGVsaWYgYWN0aW9uID09ICJjYWxsYmFjayI6CiAgICAgICAgICAgIGFyZ3MgPSBzZWxmLmNhbGxiYWNrX2FyZ3Mgb3IgKCkKICAgICAgICAgICAga3dhcmdzID0gc2VsZi5jYWxsYmFja19rd2FyZ3Mgb3Ige30KICAgICAgICAgICAgc2VsZi5jYWxsYmFjayhzZWxmLCBvcHQsIHZhbHVlLCBwYXJzZXIsICphcmdzLCAqKmt3YXJncykKICAgICAgICBlbGlmIGFjdGlvbiA9PSAiaGVscCI6CiAgICAgICAgICAgIHBhcnNlci5wcmludF9oZWxwKCkKICAgICAgICAgICAgcGFyc2VyLmV4aXQoKQogICAgICAgIGVsaWYgYWN0aW9uID09ICJ2ZXJzaW9uIjoKICAgICAgICAgICAgcGFyc2VyLnByaW50X3ZlcnNpb24oKQogICAgICAgICAgICBwYXJzZXIuZXhpdCgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigidW5rbm93biBhY3Rpb24gJXIiICUgc2VsZi5hY3Rpb24pCgogICAgICAgIHJldHVybiAxCgojIGNsYXNzIE9wdGlvbgoKClNVUFBSRVNTX0hFTFAgPSAiU1VQUFJFU1MiKyJIRUxQIgpTVVBQUkVTU19VU0FHRSA9ICJTVVBQUkVTUyIrIlVTQUdFIgoKY2xhc3MgVmFsdWVzOgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBkZWZhdWx0cz1Ob25lKToKICAgICAgICBpZiBkZWZhdWx0czoKICAgICAgICAgICAgZm9yIChhdHRyLCB2YWwpIGluIGRlZmF1bHRzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsIGF0dHIsIHZhbCkKCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc3RyKHNlbGYuX19kaWN0X18pCgogICAgX19yZXByX18gPSBfcmVwcgoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIFZhbHVlcyk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9fZGljdF9fID09IG90aGVyLl9fZGljdF9fCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKG90aGVyLCBkaWN0KToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX19kaWN0X18gPT0gb3RoZXIKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICBkZWYgX3VwZGF0ZV9jYXJlZnVsKHNlbGYsIGRpY3QpOgogICAgICAgICIiIgogICAgICAgIFVwZGF0ZSB0aGUgb3B0aW9uIHZhbHVlcyBmcm9tIGFuIGFyYml0cmFyeSBkaWN0aW9uYXJ5LCBidXQgb25seQogICAgICAgIHVzZSBrZXlzIGZyb20gZGljdCB0aGF0IGFscmVhZHkgaGF2ZSBhIGNvcnJlc3BvbmRpbmcgYXR0cmlidXRlCiAgICAgICAgaW4gc2VsZi4gIEFueSBrZXlzIGluIGRpY3Qgd2l0aG91dCBhIGNvcnJlc3BvbmRpbmcgYXR0cmlidXRlCiAgICAgICAgYXJlIHNpbGVudGx5IGlnbm9yZWQuCiAgICAgICAgIiIiCiAgICAgICAgZm9yIGF0dHIgaW4gZGlyKHNlbGYpOgogICAgICAgICAgICBpZiBhdHRyIGluIGRpY3Q6CiAgICAgICAgICAgICAgICBkdmFsID0gZGljdFthdHRyXQogICAgICAgICAgICAgICAgaWYgZHZhbCBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsIGF0dHIsIGR2YWwpCgogICAgZGVmIF91cGRhdGVfbG9vc2Uoc2VsZiwgZGljdCk6CiAgICAgICAgIiIiCiAgICAgICAgVXBkYXRlIHRoZSBvcHRpb24gdmFsdWVzIGZyb20gYW4gYXJiaXRyYXJ5IGRpY3Rpb25hcnksCiAgICAgICAgdXNpbmcgYWxsIGtleXMgZnJvbSB0aGUgZGljdGlvbmFyeSByZWdhcmRsZXNzIG9mIHdoZXRoZXIKICAgICAgICB0aGV5IGhhdmUgYSBjb3JyZXNwb25kaW5nIGF0dHJpYnV0ZSBpbiBzZWxmIG9yIG5vdC4KICAgICAgICAiIiIKICAgICAgICBzZWxmLl9fZGljdF9fLnVwZGF0ZShkaWN0KQoKICAgIGRlZiBfdXBkYXRlKHNlbGYsIGRpY3QsIG1vZGUpOgogICAgICAgIGlmIG1vZGUgPT0gImNhcmVmdWwiOgogICAgICAgICAgICBzZWxmLl91cGRhdGVfY2FyZWZ1bChkaWN0KQogICAgICAgIGVsaWYgbW9kZSA9PSAibG9vc2UiOgogICAgICAgICAgICBzZWxmLl91cGRhdGVfbG9vc2UoZGljdCkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJpbnZhbGlkIHVwZGF0ZSBtb2RlOiAlciIgJSBtb2RlKQoKICAgIGRlZiByZWFkX21vZHVsZShzZWxmLCBtb2RuYW1lLCBtb2RlPSJjYXJlZnVsIik6CiAgICAgICAgX19pbXBvcnRfXyhtb2RuYW1lKQogICAgICAgIG1vZCA9IHN5cy5tb2R1bGVzW21vZG5hbWVdCiAgICAgICAgc2VsZi5fdXBkYXRlKHZhcnMobW9kKSwgbW9kZSkKCiAgICBkZWYgcmVhZF9maWxlKHNlbGYsIGZpbGVuYW1lLCBtb2RlPSJjYXJlZnVsIik6CiAgICAgICAgdmFycyA9IHt9CiAgICAgICAgZXhlYyhvcGVuKGZpbGVuYW1lKS5yZWFkKCksIHZhcnMpCiAgICAgICAgc2VsZi5fdXBkYXRlKHZhcnMsIG1vZGUpCgogICAgZGVmIGVuc3VyZV92YWx1ZShzZWxmLCBhdHRyLCB2YWx1ZSk6CiAgICAgICAgaWYgbm90IGhhc2F0dHIoc2VsZiwgYXR0cikgb3IgZ2V0YXR0cihzZWxmLCBhdHRyKSBpcyBOb25lOgogICAgICAgICAgICBzZXRhdHRyKHNlbGYsIGF0dHIsIHZhbHVlKQogICAgICAgIHJldHVybiBnZXRhdHRyKHNlbGYsIGF0dHIpCgoKY2xhc3MgT3B0aW9uQ29udGFpbmVyOgoKICAgICIiIgogICAgQWJzdHJhY3QgYmFzZSBjbGFzcy4KCiAgICBDbGFzcyBhdHRyaWJ1dGVzOgogICAgICBzdGFuZGFyZF9vcHRpb25fbGlzdCA6IFtPcHRpb25dCiAgICAgICAgbGlzdCBvZiBzdGFuZGFyZCBvcHRpb25zIHRoYXQgd2lsbCBiZSBhY2NlcHRlZCBieSBhbGwgaW5zdGFuY2VzCiAgICAgICAgb2YgdGhpcyBwYXJzZXIgY2xhc3MgKGludGVuZGVkIHRvIGJlIG92ZXJyaWRkZW4gYnkgc3ViY2xhc3NlcykuCgogICAgSW5zdGFuY2UgYXR0cmlidXRlczoKICAgICAgb3B0aW9uX2xpc3QgOiBbT3B0aW9uXQogICAgICAgIHRoZSBsaXN0IG9mIE9wdGlvbiBvYmplY3RzIGNvbnRhaW5lZCBieSB0aGlzIE9wdGlvbkNvbnRhaW5lcgogICAgICBfc2hvcnRfb3B0IDogeyBzdHJpbmcgOiBPcHRpb24gfQogICAgICAgIGRpY3Rpb25hcnkgbWFwcGluZyBzaG9ydCBvcHRpb24gc3RyaW5ncywgZWcuICItZiIgb3IgIi1YIiwKICAgICAgICB0byB0aGUgT3B0aW9uIGluc3RhbmNlcyB0aGF0IGltcGxlbWVudCB0aGVtLiAgSWYgYW4gT3B0aW9uCiAgICAgICAgaGFzIG11bHRpcGxlIHNob3J0IG9wdGlvbiBzdHJpbmdzLCBpdCB3aWxsIGFwcGVhcnMgaW4gdGhpcwogICAgICAgIGRpY3Rpb25hcnkgbXVsdGlwbGUgdGltZXMuIFsxXQogICAgICBfbG9uZ19vcHQgOiB7IHN0cmluZyA6IE9wdGlvbiB9CiAgICAgICAgZGljdGlvbmFyeSBtYXBwaW5nIGxvbmcgb3B0aW9uIHN0cmluZ3MsIGVnLiAiLS1maWxlIiBvcgogICAgICAgICItLWV4Y2x1ZGUiLCB0byB0aGUgT3B0aW9uIGluc3RhbmNlcyB0aGF0IGltcGxlbWVudCB0aGVtLgogICAgICAgIEFnYWluLCBhIGdpdmVuIE9wdGlvbiBjYW4gb2NjdXIgbXVsdGlwbGUgdGltZXMgaW4gdGhpcwogICAgICAgIGRpY3Rpb25hcnkuIFsxXQogICAgICBkZWZhdWx0cyA6IHsgc3RyaW5nIDogYW55IH0KICAgICAgICBkaWN0aW9uYXJ5IG1hcHBpbmcgb3B0aW9uIGRlc3RpbmF0aW9uIG5hbWVzIHRvIGRlZmF1bHQKICAgICAgICB2YWx1ZXMgZm9yIGVhY2ggZGVzdGluYXRpb24gWzFdCgogICAgWzFdIFRoZXNlIG1hcHBpbmdzIGFyZSBjb21tb24gdG8gKHNoYXJlZCBieSkgYWxsIGNvbXBvbmVudHMgb2YgdGhlCiAgICAgICAgY29udHJvbGxpbmcgT3B0aW9uUGFyc2VyLCB3aGVyZSB0aGV5IGFyZSBpbml0aWFsbHkgY3JlYXRlZC4KCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgb3B0aW9uX2NsYXNzLCBjb25mbGljdF9oYW5kbGVyLCBkZXNjcmlwdGlvbik6CiAgICAgICAgIyBJbml0aWFsaXplIHRoZSBvcHRpb24gbGlzdCBhbmQgcmVsYXRlZCBkYXRhIHN0cnVjdHVyZXMuCiAgICAgICAgIyBUaGlzIG1ldGhvZCBtdXN0IGJlIHByb3ZpZGVkIGJ5IHN1YmNsYXNzZXMsIGFuZCBpdCBtdXN0CiAgICAgICAgIyBpbml0aWFsaXplIGF0IGxlYXN0IHRoZSBmb2xsb3dpbmcgaW5zdGFuY2UgYXR0cmlidXRlczoKICAgICAgICAjIG9wdGlvbl9saXN0LCBfc2hvcnRfb3B0LCBfbG9uZ19vcHQsIGRlZmF1bHRzLgogICAgICAgIHNlbGYuX2NyZWF0ZV9vcHRpb25fbGlzdCgpCgogICAgICAgIHNlbGYub3B0aW9uX2NsYXNzID0gb3B0aW9uX2NsYXNzCiAgICAgICAgc2VsZi5zZXRfY29uZmxpY3RfaGFuZGxlcihjb25mbGljdF9oYW5kbGVyKQogICAgICAgIHNlbGYuc2V0X2Rlc2NyaXB0aW9uKGRlc2NyaXB0aW9uKQoKICAgIGRlZiBfY3JlYXRlX29wdGlvbl9tYXBwaW5ncyhzZWxmKToKICAgICAgICAjIEZvciB1c2UgYnkgT3B0aW9uUGFyc2VyIGNvbnN0cnVjdG9yIC0tIGNyZWF0ZSB0aGUgbWFzdGVyCiAgICAgICAgIyBvcHRpb24gbWFwcGluZ3MgdXNlZCBieSB0aGlzIE9wdGlvblBhcnNlciBhbmQgYWxsCiAgICAgICAgIyBPcHRpb25Hcm91cHMgdGhhdCBpdCBvd25zLgogICAgICAgIHNlbGYuX3Nob3J0X29wdCA9IHt9ICAgICAgICAgICAgIyBzaW5nbGUgbGV0dGVyIC0+IE9wdGlvbiBpbnN0YW5jZQogICAgICAgIHNlbGYuX2xvbmdfb3B0ID0ge30gICAgICAgICAgICAgIyBsb25nIG9wdGlvbiAtPiBPcHRpb24gaW5zdGFuY2UKICAgICAgICBzZWxmLmRlZmF1bHRzID0ge30gICAgICAgICAgICAgICMgbWFwcyBvcHRpb24gZGVzdCAtPiBkZWZhdWx0IHZhbHVlCgoKICAgIGRlZiBfc2hhcmVfb3B0aW9uX21hcHBpbmdzKHNlbGYsIHBhcnNlcik6CiAgICAgICAgIyBGb3IgdXNlIGJ5IE9wdGlvbkdyb3VwIGNvbnN0cnVjdG9yIC0tIHVzZSBzaGFyZWQgb3B0aW9uCiAgICAgICAgIyBtYXBwaW5ncyBmcm9tIHRoZSBPcHRpb25QYXJzZXIgdGhhdCBvd25zIHRoaXMgT3B0aW9uR3JvdXAuCiAgICAgICAgc2VsZi5fc2hvcnRfb3B0ID0gcGFyc2VyLl9zaG9ydF9vcHQKICAgICAgICBzZWxmLl9sb25nX29wdCA9IHBhcnNlci5fbG9uZ19vcHQKICAgICAgICBzZWxmLmRlZmF1bHRzID0gcGFyc2VyLmRlZmF1bHRzCgogICAgZGVmIHNldF9jb25mbGljdF9oYW5kbGVyKHNlbGYsIGhhbmRsZXIpOgogICAgICAgIGlmIGhhbmRsZXIgbm90IGluICgiZXJyb3IiLCAicmVzb2x2ZSIpOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJpbnZhbGlkIGNvbmZsaWN0X3Jlc29sdXRpb24gdmFsdWUgJXIiICUgaGFuZGxlcikKICAgICAgICBzZWxmLmNvbmZsaWN0X2hhbmRsZXIgPSBoYW5kbGVyCgogICAgZGVmIHNldF9kZXNjcmlwdGlvbihzZWxmLCBkZXNjcmlwdGlvbik6CiAgICAgICAgc2VsZi5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uCgogICAgZGVmIGdldF9kZXNjcmlwdGlvbihzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5kZXNjcmlwdGlvbgoKCiAgICBkZWYgZGVzdHJveShzZWxmKToKICAgICAgICAiIiJzZWUgT3B0aW9uUGFyc2VyLmRlc3Ryb3koKS4iIiIKICAgICAgICBkZWwgc2VsZi5fc2hvcnRfb3B0CiAgICAgICAgZGVsIHNlbGYuX2xvbmdfb3B0CiAgICAgICAgZGVsIHNlbGYuZGVmYXVsdHMKCgogICAgIyAtLSBPcHRpb24tYWRkaW5nIG1ldGhvZHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgX2NoZWNrX2NvbmZsaWN0KHNlbGYsIG9wdGlvbik6CiAgICAgICAgY29uZmxpY3Rfb3B0cyA9IFtdCiAgICAgICAgZm9yIG9wdCBpbiBvcHRpb24uX3Nob3J0X29wdHM6CiAgICAgICAgICAgIGlmIG9wdCBpbiBzZWxmLl9zaG9ydF9vcHQ6CiAgICAgICAgICAgICAgICBjb25mbGljdF9vcHRzLmFwcGVuZCgob3B0LCBzZWxmLl9zaG9ydF9vcHRbb3B0XSkpCiAgICAgICAgZm9yIG9wdCBpbiBvcHRpb24uX2xvbmdfb3B0czoKICAgICAgICAgICAgaWYgb3B0IGluIHNlbGYuX2xvbmdfb3B0OgogICAgICAgICAgICAgICAgY29uZmxpY3Rfb3B0cy5hcHBlbmQoKG9wdCwgc2VsZi5fbG9uZ19vcHRbb3B0XSkpCgogICAgICAgIGlmIGNvbmZsaWN0X29wdHM6CiAgICAgICAgICAgIGhhbmRsZXIgPSBzZWxmLmNvbmZsaWN0X2hhbmRsZXIKICAgICAgICAgICAgaWYgaGFuZGxlciA9PSAiZXJyb3IiOgogICAgICAgICAgICAgICAgcmFpc2UgT3B0aW9uQ29uZmxpY3RFcnJvcigKICAgICAgICAgICAgICAgICAgICAiY29uZmxpY3Rpbmcgb3B0aW9uIHN0cmluZyhzKTogJXMiCiAgICAgICAgICAgICAgICAgICAgJSAiLCAiLmpvaW4oW2NvWzBdIGZvciBjbyBpbiBjb25mbGljdF9vcHRzXSksCiAgICAgICAgICAgICAgICAgICAgb3B0aW9uKQogICAgICAgICAgICBlbGlmIGhhbmRsZXIgPT0gInJlc29sdmUiOgogICAgICAgICAgICAgICAgZm9yIChvcHQsIGNfb3B0aW9uKSBpbiBjb25mbGljdF9vcHRzOgogICAgICAgICAgICAgICAgICAgIGlmIG9wdC5zdGFydHN3aXRoKCItLSIpOgogICAgICAgICAgICAgICAgICAgICAgICBjX29wdGlvbi5fbG9uZ19vcHRzLnJlbW92ZShvcHQpCiAgICAgICAgICAgICAgICAgICAgICAgIGRlbCBzZWxmLl9sb25nX29wdFtvcHRdCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgY19vcHRpb24uX3Nob3J0X29wdHMucmVtb3ZlKG9wdCkKICAgICAgICAgICAgICAgICAgICAgICAgZGVsIHNlbGYuX3Nob3J0X29wdFtvcHRdCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IChjX29wdGlvbi5fc2hvcnRfb3B0cyBvciBjX29wdGlvbi5fbG9uZ19vcHRzKToKICAgICAgICAgICAgICAgICAgICAgICAgY19vcHRpb24uY29udGFpbmVyLm9wdGlvbl9saXN0LnJlbW92ZShjX29wdGlvbikKCiAgICBkZWYgYWRkX29wdGlvbihzZWxmLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgICIiImFkZF9vcHRpb24oT3B0aW9uKQogICAgICAgICAgIGFkZF9vcHRpb24ob3B0X3N0ciwgLi4uLCBrd2FyZz12YWwsIC4uLikKICAgICAgICAiIiIKICAgICAgICBpZiBpc2luc3RhbmNlKGFyZ3NbMF0sIHN0cik6CiAgICAgICAgICAgIG9wdGlvbiA9IHNlbGYub3B0aW9uX2NsYXNzKCphcmdzLCAqKmt3YXJncykKICAgICAgICBlbGlmIGxlbihhcmdzKSA9PSAxIGFuZCBub3Qga3dhcmdzOgogICAgICAgICAgICBvcHRpb24gPSBhcmdzWzBdCiAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG9wdGlvbiwgT3B0aW9uKToKICAgICAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigibm90IGFuIE9wdGlvbiBpbnN0YW5jZTogJXIiICUgb3B0aW9uKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiaW52YWxpZCBhcmd1bWVudHMiKQoKICAgICAgICBzZWxmLl9jaGVja19jb25mbGljdChvcHRpb24pCgogICAgICAgIHNlbGYub3B0aW9uX2xpc3QuYXBwZW5kKG9wdGlvbikKICAgICAgICBvcHRpb24uY29udGFpbmVyID0gc2VsZgogICAgICAgIGZvciBvcHQgaW4gb3B0aW9uLl9zaG9ydF9vcHRzOgogICAgICAgICAgICBzZWxmLl9zaG9ydF9vcHRbb3B0XSA9IG9wdGlvbgogICAgICAgIGZvciBvcHQgaW4gb3B0aW9uLl9sb25nX29wdHM6CiAgICAgICAgICAgIHNlbGYuX2xvbmdfb3B0W29wdF0gPSBvcHRpb24KCiAgICAgICAgaWYgb3B0aW9uLmRlc3QgaXMgbm90IE5vbmU6ICAgICAjIG9wdGlvbiBoYXMgYSBkZXN0LCB3ZSBuZWVkIGEgZGVmYXVsdAogICAgICAgICAgICBpZiBvcHRpb24uZGVmYXVsdCBpcyBub3QgTk9fREVGQVVMVDoKICAgICAgICAgICAgICAgIHNlbGYuZGVmYXVsdHNbb3B0aW9uLmRlc3RdID0gb3B0aW9uLmRlZmF1bHQKICAgICAgICAgICAgZWxpZiBvcHRpb24uZGVzdCBub3QgaW4gc2VsZi5kZWZhdWx0czoKICAgICAgICAgICAgICAgIHNlbGYuZGVmYXVsdHNbb3B0aW9uLmRlc3RdID0gTm9uZQoKICAgICAgICByZXR1cm4gb3B0aW9uCgogICAgZGVmIGFkZF9vcHRpb25zKHNlbGYsIG9wdGlvbl9saXN0KToKICAgICAgICBmb3Igb3B0aW9uIGluIG9wdGlvbl9saXN0OgogICAgICAgICAgICBzZWxmLmFkZF9vcHRpb24ob3B0aW9uKQoKICAgICMgLS0gT3B0aW9uIHF1ZXJ5L3JlbW92YWwgbWV0aG9kcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgZGVmIGdldF9vcHRpb24oc2VsZiwgb3B0X3N0cik6CiAgICAgICAgcmV0dXJuIChzZWxmLl9zaG9ydF9vcHQuZ2V0KG9wdF9zdHIpIG9yCiAgICAgICAgICAgICAgICBzZWxmLl9sb25nX29wdC5nZXQob3B0X3N0cikpCgogICAgZGVmIGhhc19vcHRpb24oc2VsZiwgb3B0X3N0cik6CiAgICAgICAgcmV0dXJuIChvcHRfc3RyIGluIHNlbGYuX3Nob3J0X29wdCBvcgogICAgICAgICAgICAgICAgb3B0X3N0ciBpbiBzZWxmLl9sb25nX29wdCkKCiAgICBkZWYgcmVtb3ZlX29wdGlvbihzZWxmLCBvcHRfc3RyKToKICAgICAgICBvcHRpb24gPSBzZWxmLl9zaG9ydF9vcHQuZ2V0KG9wdF9zdHIpCiAgICAgICAgaWYgb3B0aW9uIGlzIE5vbmU6CiAgICAgICAgICAgIG9wdGlvbiA9IHNlbGYuX2xvbmdfb3B0LmdldChvcHRfc3RyKQogICAgICAgIGlmIG9wdGlvbiBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJubyBzdWNoIG9wdGlvbiAlciIgJSBvcHRfc3RyKQoKICAgICAgICBmb3Igb3B0IGluIG9wdGlvbi5fc2hvcnRfb3B0czoKICAgICAgICAgICAgZGVsIHNlbGYuX3Nob3J0X29wdFtvcHRdCiAgICAgICAgZm9yIG9wdCBpbiBvcHRpb24uX2xvbmdfb3B0czoKICAgICAgICAgICAgZGVsIHNlbGYuX2xvbmdfb3B0W29wdF0KICAgICAgICBvcHRpb24uY29udGFpbmVyLm9wdGlvbl9saXN0LnJlbW92ZShvcHRpb24pCgoKICAgICMgLS0gSGVscC1mb3JtYXR0aW5nIG1ldGhvZHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgZGVmIGZvcm1hdF9vcHRpb25faGVscChzZWxmLCBmb3JtYXR0ZXIpOgogICAgICAgIGlmIG5vdCBzZWxmLm9wdGlvbl9saXN0OgogICAgICAgICAgICByZXR1cm4gIiIKICAgICAgICByZXN1bHQgPSBbXQogICAgICAgIGZvciBvcHRpb24gaW4gc2VsZi5vcHRpb25fbGlzdDoKICAgICAgICAgICAgaWYgbm90IG9wdGlvbi5oZWxwIGlzIFNVUFBSRVNTX0hFTFA6CiAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKGZvcm1hdHRlci5mb3JtYXRfb3B0aW9uKG9wdGlvbikpCiAgICAgICAgcmV0dXJuICIiLmpvaW4ocmVzdWx0KQoKICAgIGRlZiBmb3JtYXRfZGVzY3JpcHRpb24oc2VsZiwgZm9ybWF0dGVyKToKICAgICAgICByZXR1cm4gZm9ybWF0dGVyLmZvcm1hdF9kZXNjcmlwdGlvbihzZWxmLmdldF9kZXNjcmlwdGlvbigpKQoKICAgIGRlZiBmb3JtYXRfaGVscChzZWxmLCBmb3JtYXR0ZXIpOgogICAgICAgIHJlc3VsdCA9IFtdCiAgICAgICAgaWYgc2VsZi5kZXNjcmlwdGlvbjoKICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChzZWxmLmZvcm1hdF9kZXNjcmlwdGlvbihmb3JtYXR0ZXIpKQogICAgICAgIGlmIHNlbGYub3B0aW9uX2xpc3Q6CiAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoc2VsZi5mb3JtYXRfb3B0aW9uX2hlbHAoZm9ybWF0dGVyKSkKICAgICAgICByZXR1cm4gIlxuIi5qb2luKHJlc3VsdCkKCgpjbGFzcyBPcHRpb25Hcm91cCAoT3B0aW9uQ29udGFpbmVyKToKCiAgICBkZWYgX19pbml0X18oc2VsZiwgcGFyc2VyLCB0aXRsZSwgZGVzY3JpcHRpb249Tm9uZSk6CiAgICAgICAgc2VsZi5wYXJzZXIgPSBwYXJzZXIKICAgICAgICBPcHRpb25Db250YWluZXIuX19pbml0X18oCiAgICAgICAgICAgIHNlbGYsIHBhcnNlci5vcHRpb25fY2xhc3MsIHBhcnNlci5jb25mbGljdF9oYW5kbGVyLCBkZXNjcmlwdGlvbikKICAgICAgICBzZWxmLnRpdGxlID0gdGl0bGUKCiAgICBkZWYgX2NyZWF0ZV9vcHRpb25fbGlzdChzZWxmKToKICAgICAgICBzZWxmLm9wdGlvbl9saXN0ID0gW10KICAgICAgICBzZWxmLl9zaGFyZV9vcHRpb25fbWFwcGluZ3Moc2VsZi5wYXJzZXIpCgogICAgZGVmIHNldF90aXRsZShzZWxmLCB0aXRsZSk6CiAgICAgICAgc2VsZi50aXRsZSA9IHRpdGxlCgogICAgZGVmIGRlc3Ryb3koc2VsZik6CiAgICAgICAgIiIic2VlIE9wdGlvblBhcnNlci5kZXN0cm95KCkuIiIiCiAgICAgICAgT3B0aW9uQ29udGFpbmVyLmRlc3Ryb3koc2VsZikKICAgICAgICBkZWwgc2VsZi5vcHRpb25fbGlzdAoKICAgICMgLS0gSGVscC1mb3JtYXR0aW5nIG1ldGhvZHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgZGVmIGZvcm1hdF9oZWxwKHNlbGYsIGZvcm1hdHRlcik6CiAgICAgICAgcmVzdWx0ID0gZm9ybWF0dGVyLmZvcm1hdF9oZWFkaW5nKHNlbGYudGl0bGUpCiAgICAgICAgZm9ybWF0dGVyLmluZGVudCgpCiAgICAgICAgcmVzdWx0ICs9IE9wdGlvbkNvbnRhaW5lci5mb3JtYXRfaGVscChzZWxmLCBmb3JtYXR0ZXIpCiAgICAgICAgZm9ybWF0dGVyLmRlZGVudCgpCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKCmNsYXNzIE9wdGlvblBhcnNlciAoT3B0aW9uQ29udGFpbmVyKToKCiAgICAiIiIKICAgIENsYXNzIGF0dHJpYnV0ZXM6CiAgICAgIHN0YW5kYXJkX29wdGlvbl9saXN0IDogW09wdGlvbl0KICAgICAgICBsaXN0IG9mIHN0YW5kYXJkIG9wdGlvbnMgdGhhdCB3aWxsIGJlIGFjY2VwdGVkIGJ5IGFsbCBpbnN0YW5jZXMKICAgICAgICBvZiB0aGlzIHBhcnNlciBjbGFzcyAoaW50ZW5kZWQgdG8gYmUgb3ZlcnJpZGRlbiBieSBzdWJjbGFzc2VzKS4KCiAgICBJbnN0YW5jZSBhdHRyaWJ1dGVzOgogICAgICB1c2FnZSA6IHN0cmluZwogICAgICAgIGEgdXNhZ2Ugc3RyaW5nIGZvciB5b3VyIHByb2dyYW0uICBCZWZvcmUgaXQgaXMgZGlzcGxheWVkCiAgICAgICAgdG8gdGhlIHVzZXIsICIlcHJvZyIgd2lsbCBiZSBleHBhbmRlZCB0byB0aGUgbmFtZSBvZgogICAgICAgIHlvdXIgcHJvZ3JhbSAoc2VsZi5wcm9nIG9yIG9zLnBhdGguYmFzZW5hbWUoc3lzLmFyZ3ZbMF0pKS4KICAgICAgcHJvZyA6IHN0cmluZwogICAgICAgIHRoZSBuYW1lIG9mIHRoZSBjdXJyZW50IHByb2dyYW0gKHRvIG92ZXJyaWRlCiAgICAgICAgb3MucGF0aC5iYXNlbmFtZShzeXMuYXJndlswXSkpLgogICAgICBkZXNjcmlwdGlvbiA6IHN0cmluZwogICAgICAgIEEgcGFyYWdyYXBoIG9mIHRleHQgZ2l2aW5nIGEgYnJpZWYgb3ZlcnZpZXcgb2YgeW91ciBwcm9ncmFtLgogICAgICAgIG9wdHBhcnNlIHJlZm9ybWF0cyB0aGlzIHBhcmFncmFwaCB0byBmaXQgdGhlIGN1cnJlbnQgdGVybWluYWwKICAgICAgICB3aWR0aCBhbmQgcHJpbnRzIGl0IHdoZW4gdGhlIHVzZXIgcmVxdWVzdHMgaGVscCAoYWZ0ZXIgdXNhZ2UsCiAgICAgICAgYnV0IGJlZm9yZSB0aGUgbGlzdCBvZiBvcHRpb25zKS4KICAgICAgZXBpbG9nIDogc3RyaW5nCiAgICAgICAgcGFyYWdyYXBoIG9mIGhlbHAgdGV4dCB0byBwcmludCBhZnRlciBvcHRpb24gaGVscAoKICAgICAgb3B0aW9uX2dyb3VwcyA6IFtPcHRpb25Hcm91cF0KICAgICAgICBsaXN0IG9mIG9wdGlvbiBncm91cHMgaW4gdGhpcyBwYXJzZXIgKG9wdGlvbiBncm91cHMgYXJlCiAgICAgICAgaXJyZWxldmFudCBmb3IgcGFyc2luZyB0aGUgY29tbWFuZC1saW5lLCBidXQgdmVyeSB1c2VmdWwKICAgICAgICBmb3IgZ2VuZXJhdGluZyBoZWxwKQoKICAgICAgYWxsb3dfaW50ZXJzcGVyc2VkX2FyZ3MgOiBib29sID0gdHJ1ZQogICAgICAgIGlmIHRydWUsIHBvc2l0aW9uYWwgYXJndW1lbnRzIG1heSBiZSBpbnRlcnNwZXJzZWQgd2l0aCBvcHRpb25zLgogICAgICAgIEFzc3VtaW5nIC1hIGFuZCAtYiBlYWNoIHRha2UgYSBzaW5nbGUgYXJndW1lbnQsIHRoZSBjb21tYW5kLWxpbmUKICAgICAgICAgIC1hYmxhaCBmb28gYmFyIC1iYm9vIGJhegogICAgICAgIHdpbGwgYmUgaW50ZXJwcmV0ZWQgdGhlIHNhbWUgYXMKICAgICAgICAgIC1hYmxhaCAtYmJvbyAtLSBmb28gYmFyIGJhegogICAgICAgIElmIHRoaXMgZmxhZyB3ZXJlIGZhbHNlLCB0aGF0IGNvbW1hbmQgbGluZSB3b3VsZCBiZSBpbnRlcnByZXRlZCBhcwogICAgICAgICAgLWFibGFoIC0tIGZvbyBiYXIgLWJib28gYmF6CiAgICAgICAgLS0gaWUuIHdlIHN0b3AgcHJvY2Vzc2luZyBvcHRpb25zIGFzIHNvb24gYXMgd2Ugc2VlIHRoZSBmaXJzdAogICAgICAgIG5vbi1vcHRpb24gYXJndW1lbnQuICAoVGhpcyBpcyB0aGUgdHJhZGl0aW9uIGZvbGxvd2VkIGJ5CiAgICAgICAgUHl0aG9uJ3MgZ2V0b3B0IG1vZHVsZSwgUGVybCdzIEdldG9wdDo6U3RkLCBhbmQgb3RoZXIgYXJndW1lbnQtCiAgICAgICAgcGFyc2luZyBsaWJyYXJpZXMsIGJ1dCBpdCBpcyBnZW5lcmFsbHkgYW5ub3lpbmcgdG8gdXNlcnMuKQoKICAgICAgcHJvY2Vzc19kZWZhdWx0X3ZhbHVlcyA6IGJvb2wgPSB0cnVlCiAgICAgICAgaWYgdHJ1ZSwgb3B0aW9uIGRlZmF1bHQgdmFsdWVzIGFyZSBwcm9jZXNzZWQgc2ltaWxhcmx5IHRvIG9wdGlvbgogICAgICAgIHZhbHVlcyBmcm9tIHRoZSBjb21tYW5kIGxpbmU6IHRoYXQgaXMsIHRoZXkgYXJlIHBhc3NlZCB0byB0aGUKICAgICAgICB0eXBlLWNoZWNraW5nIGZ1bmN0aW9uIGZvciB0aGUgb3B0aW9uJ3MgdHlwZSAoYXMgbG9uZyBhcyB0aGUKICAgICAgICBkZWZhdWx0IHZhbHVlIGlzIGEgc3RyaW5nKS4gIChUaGlzIHJlYWxseSBvbmx5IG1hdHRlcnMgaWYgeW91CiAgICAgICAgaGF2ZSBkZWZpbmVkIGN1c3RvbSB0eXBlczsgc2VlIFNGIGJ1ZyAjOTU1ODg5LikgIFNldCBpdCB0byBmYWxzZQogICAgICAgIHRvIHJlc3RvcmUgdGhlIGJlaGF2aW91ciBvZiBPcHRpayAxLjQuMSBhbmQgZWFybGllci4KCiAgICAgIHJhcmdzIDogW3N0cmluZ10KICAgICAgICB0aGUgYXJndW1lbnQgbGlzdCBjdXJyZW50bHkgYmVpbmcgcGFyc2VkLiAgT25seSBzZXQgd2hlbgogICAgICAgIHBhcnNlX2FyZ3MoKSBpcyBhY3RpdmUsIGFuZCBjb250aW51YWxseSB0cmltbWVkIGRvd24gYXMKICAgICAgICB3ZSBjb25zdW1lIGFyZ3VtZW50cy4gIE1haW5seSB0aGVyZSBmb3IgdGhlIGJlbmVmaXQgb2YKICAgICAgICBjYWxsYmFjayBvcHRpb25zLgogICAgICBsYXJncyA6IFtzdHJpbmddCiAgICAgICAgdGhlIGxpc3Qgb2YgbGVmdG92ZXIgYXJndW1lbnRzIHRoYXQgd2UgaGF2ZSBza2lwcGVkIHdoaWxlCiAgICAgICAgcGFyc2luZyBvcHRpb25zLiAgSWYgYWxsb3dfaW50ZXJzcGVyc2VkX2FyZ3MgaXMgZmFsc2UsIHRoaXMKICAgICAgICBsaXN0IGlzIGFsd2F5cyBlbXB0eS4KICAgICAgdmFsdWVzIDogVmFsdWVzCiAgICAgICAgdGhlIHNldCBvZiBvcHRpb24gdmFsdWVzIGN1cnJlbnRseSBiZWluZyBhY2N1bXVsYXRlZC4gIE9ubHkKICAgICAgICBzZXQgd2hlbiBwYXJzZV9hcmdzKCkgaXMgYWN0aXZlLiAgQWxzbyBtYWlubHkgZm9yIGNhbGxiYWNrcy4KCiAgICBCZWNhdXNlIG9mIHRoZSAncmFyZ3MnLCAnbGFyZ3MnLCBhbmQgJ3ZhbHVlcycgYXR0cmlidXRlcywKICAgIE9wdGlvblBhcnNlciBpcyBub3QgdGhyZWFkLXNhZmUuICBJZiwgZm9yIHNvbWUgcGVydmVyc2UgcmVhc29uLCB5b3UKICAgIG5lZWQgdG8gcGFyc2UgY29tbWFuZC1saW5lIGFyZ3VtZW50cyBzaW11bHRhbmVvdXNseSBpbiBkaWZmZXJlbnQKICAgIHRocmVhZHMsIHVzZSBkaWZmZXJlbnQgT3B0aW9uUGFyc2VyIGluc3RhbmNlcy4KCiAgICAiIiIKCiAgICBzdGFuZGFyZF9vcHRpb25fbGlzdCA9IFtdCgogICAgZGVmIF9faW5pdF9fKHNlbGYsCiAgICAgICAgICAgICAgICAgdXNhZ2U9Tm9uZSwKICAgICAgICAgICAgICAgICBvcHRpb25fbGlzdD1Ob25lLAogICAgICAgICAgICAgICAgIG9wdGlvbl9jbGFzcz1PcHRpb24sCiAgICAgICAgICAgICAgICAgdmVyc2lvbj1Ob25lLAogICAgICAgICAgICAgICAgIGNvbmZsaWN0X2hhbmRsZXI9ImVycm9yIiwKICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj1Ob25lLAogICAgICAgICAgICAgICAgIGZvcm1hdHRlcj1Ob25lLAogICAgICAgICAgICAgICAgIGFkZF9oZWxwX29wdGlvbj1UcnVlLAogICAgICAgICAgICAgICAgIHByb2c9Tm9uZSwKICAgICAgICAgICAgICAgICBlcGlsb2c9Tm9uZSk6CiAgICAgICAgT3B0aW9uQ29udGFpbmVyLl9faW5pdF9fKAogICAgICAgICAgICBzZWxmLCBvcHRpb25fY2xhc3MsIGNvbmZsaWN0X2hhbmRsZXIsIGRlc2NyaXB0aW9uKQogICAgICAgIHNlbGYuc2V0X3VzYWdlKHVzYWdlKQogICAgICAgIHNlbGYucHJvZyA9IHByb2cKICAgICAgICBzZWxmLnZlcnNpb24gPSB2ZXJzaW9uCiAgICAgICAgc2VsZi5hbGxvd19pbnRlcnNwZXJzZWRfYXJncyA9IFRydWUKICAgICAgICBzZWxmLnByb2Nlc3NfZGVmYXVsdF92YWx1ZXMgPSBUcnVlCiAgICAgICAgaWYgZm9ybWF0dGVyIGlzIE5vbmU6CiAgICAgICAgICAgIGZvcm1hdHRlciA9IEluZGVudGVkSGVscEZvcm1hdHRlcigpCiAgICAgICAgc2VsZi5mb3JtYXR0ZXIgPSBmb3JtYXR0ZXIKICAgICAgICBzZWxmLmZvcm1hdHRlci5zZXRfcGFyc2VyKHNlbGYpCiAgICAgICAgc2VsZi5lcGlsb2cgPSBlcGlsb2cKCiAgICAgICAgIyBQb3B1bGF0ZSB0aGUgb3B0aW9uIGxpc3Q7IGluaXRpYWwgc291cmNlcyBhcmUgdGhlCiAgICAgICAgIyBzdGFuZGFyZF9vcHRpb25fbGlzdCBjbGFzcyBhdHRyaWJ1dGUsIHRoZSAnb3B0aW9uX2xpc3QnCiAgICAgICAgIyBhcmd1bWVudCwgYW5kIChpZiBhcHBsaWNhYmxlKSB0aGUgX2FkZF92ZXJzaW9uX29wdGlvbigpIGFuZAogICAgICAgICMgX2FkZF9oZWxwX29wdGlvbigpIG1ldGhvZHMuCiAgICAgICAgc2VsZi5fcG9wdWxhdGVfb3B0aW9uX2xpc3Qob3B0aW9uX2xpc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkX2hlbHA9YWRkX2hlbHBfb3B0aW9uKQoKICAgICAgICBzZWxmLl9pbml0X3BhcnNpbmdfc3RhdGUoKQoKCiAgICBkZWYgZGVzdHJveShzZWxmKToKICAgICAgICAiIiIKICAgICAgICBEZWNsYXJlIHRoYXQgeW91IGFyZSBkb25lIHdpdGggdGhpcyBPcHRpb25QYXJzZXIuICBUaGlzIGNsZWFucyB1cAogICAgICAgIHJlZmVyZW5jZSBjeWNsZXMgc28gdGhlIE9wdGlvblBhcnNlciAoYW5kIGFsbCBvYmplY3RzIHJlZmVyZW5jZWQgYnkKICAgICAgICBpdCkgY2FuIGJlIGdhcmJhZ2UtY29sbGVjdGVkIHByb21wdGx5LiAgQWZ0ZXIgY2FsbGluZyBkZXN0cm95KCksIHRoZQogICAgICAgIE9wdGlvblBhcnNlciBpcyB1bnVzYWJsZS4KICAgICAgICAiIiIKICAgICAgICBPcHRpb25Db250YWluZXIuZGVzdHJveShzZWxmKQogICAgICAgIGZvciBncm91cCBpbiBzZWxmLm9wdGlvbl9ncm91cHM6CiAgICAgICAgICAgIGdyb3VwLmRlc3Ryb3koKQogICAgICAgIGRlbCBzZWxmLm9wdGlvbl9saXN0CiAgICAgICAgZGVsIHNlbGYub3B0aW9uX2dyb3VwcwogICAgICAgIGRlbCBzZWxmLmZvcm1hdHRlcgoKCiAgICAjIC0tIFByaXZhdGUgbWV0aG9kcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgIyAodXNlZCBieSBvdXIgb3IgT3B0aW9uQ29udGFpbmVyJ3MgY29uc3RydWN0b3IpCgogICAgZGVmIF9jcmVhdGVfb3B0aW9uX2xpc3Qoc2VsZik6CiAgICAgICAgc2VsZi5vcHRpb25fbGlzdCA9IFtdCiAgICAgICAgc2VsZi5vcHRpb25fZ3JvdXBzID0gW10KICAgICAgICBzZWxmLl9jcmVhdGVfb3B0aW9uX21hcHBpbmdzKCkKCiAgICBkZWYgX2FkZF9oZWxwX29wdGlvbihzZWxmKToKICAgICAgICBzZWxmLmFkZF9vcHRpb24oIi1oIiwgIi0taGVscCIsCiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbj0iaGVscCIsCiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHA9Xygic2hvdyB0aGlzIGhlbHAgbWVzc2FnZSBhbmQgZXhpdCIpKQoKICAgIGRlZiBfYWRkX3ZlcnNpb25fb3B0aW9uKHNlbGYpOgogICAgICAgIHNlbGYuYWRkX29wdGlvbigiLS12ZXJzaW9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uPSJ2ZXJzaW9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgaGVscD1fKCJzaG93IHByb2dyYW0ncyB2ZXJzaW9uIG51bWJlciBhbmQgZXhpdCIpKQoKICAgIGRlZiBfcG9wdWxhdGVfb3B0aW9uX2xpc3Qoc2VsZiwgb3B0aW9uX2xpc3QsIGFkZF9oZWxwPVRydWUpOgogICAgICAgIGlmIHNlbGYuc3RhbmRhcmRfb3B0aW9uX2xpc3Q6CiAgICAgICAgICAgIHNlbGYuYWRkX29wdGlvbnMoc2VsZi5zdGFuZGFyZF9vcHRpb25fbGlzdCkKICAgICAgICBpZiBvcHRpb25fbGlzdDoKICAgICAgICAgICAgc2VsZi5hZGRfb3B0aW9ucyhvcHRpb25fbGlzdCkKICAgICAgICBpZiBzZWxmLnZlcnNpb246CiAgICAgICAgICAgIHNlbGYuX2FkZF92ZXJzaW9uX29wdGlvbigpCiAgICAgICAgaWYgYWRkX2hlbHA6CiAgICAgICAgICAgIHNlbGYuX2FkZF9oZWxwX29wdGlvbigpCgogICAgZGVmIF9pbml0X3BhcnNpbmdfc3RhdGUoc2VsZik6CiAgICAgICAgIyBUaGVzZSBhcmUgc2V0IGluIHBhcnNlX2FyZ3MoKSBmb3IgdGhlIGNvbnZlbmllbmNlIG9mIGNhbGxiYWNrcy4KICAgICAgICBzZWxmLnJhcmdzID0gTm9uZQogICAgICAgIHNlbGYubGFyZ3MgPSBOb25lCiAgICAgICAgc2VsZi52YWx1ZXMgPSBOb25lCgoKICAgICMgLS0gU2ltcGxlIG1vZGlmaWVyIG1ldGhvZHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgZGVmIHNldF91c2FnZShzZWxmLCB1c2FnZSk6CiAgICAgICAgaWYgdXNhZ2UgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi51c2FnZSA9IF8oIiVwcm9nIFtvcHRpb25zXSIpCiAgICAgICAgZWxpZiB1c2FnZSBpcyBTVVBQUkVTU19VU0FHRToKICAgICAgICAgICAgc2VsZi51c2FnZSA9IE5vbmUKICAgICAgICAjIEZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSB3aXRoIE9wdGlrIDEuMyBhbmQgZWFybGllci4KICAgICAgICBlbGlmIHVzYWdlLmxvd2VyKCkuc3RhcnRzd2l0aCgidXNhZ2U6ICIpOgogICAgICAgICAgICBzZWxmLnVzYWdlID0gdXNhZ2VbNzpdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi51c2FnZSA9IHVzYWdlCgogICAgZGVmIGVuYWJsZV9pbnRlcnNwZXJzZWRfYXJncyhzZWxmKToKICAgICAgICAiIiJTZXQgcGFyc2luZyB0byBub3Qgc3RvcCBvbiB0aGUgZmlyc3Qgbm9uLW9wdGlvbiwgYWxsb3dpbmcKICAgICAgICBpbnRlcnNwZXJzaW5nIHN3aXRjaGVzIHdpdGggY29tbWFuZCBhcmd1bWVudHMuIFRoaXMgaXMgdGhlCiAgICAgICAgZGVmYXVsdCBiZWhhdmlvci4gU2VlIGFsc28gZGlzYWJsZV9pbnRlcnNwZXJzZWRfYXJncygpIGFuZCB0aGUKICAgICAgICBjbGFzcyBkb2N1bWVudGF0aW9uIGRlc2NyaXB0aW9uIG9mIHRoZSBhdHRyaWJ1dGUKICAgICAgICBhbGxvd19pbnRlcnNwZXJzZWRfYXJncy4iIiIKICAgICAgICBzZWxmLmFsbG93X2ludGVyc3BlcnNlZF9hcmdzID0gVHJ1ZQoKICAgIGRlZiBkaXNhYmxlX2ludGVyc3BlcnNlZF9hcmdzKHNlbGYpOgogICAgICAgICIiIlNldCBwYXJzaW5nIHRvIHN0b3Agb24gdGhlIGZpcnN0IG5vbi1vcHRpb24uIFVzZSB0aGlzIGlmCiAgICAgICAgeW91IGhhdmUgYSBjb21tYW5kIHByb2Nlc3NvciB3aGljaCBydW5zIGFub3RoZXIgY29tbWFuZCB0aGF0CiAgICAgICAgaGFzIG9wdGlvbnMgb2YgaXRzIG93biBhbmQgeW91IHdhbnQgdG8gbWFrZSBzdXJlIHRoZXNlIG9wdGlvbnMKICAgICAgICBkb24ndCBnZXQgY29uZnVzZWQuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5hbGxvd19pbnRlcnNwZXJzZWRfYXJncyA9IEZhbHNlCgogICAgZGVmIHNldF9wcm9jZXNzX2RlZmF1bHRfdmFsdWVzKHNlbGYsIHByb2Nlc3MpOgogICAgICAgIHNlbGYucHJvY2Vzc19kZWZhdWx0X3ZhbHVlcyA9IHByb2Nlc3MKCiAgICBkZWYgc2V0X2RlZmF1bHQoc2VsZiwgZGVzdCwgdmFsdWUpOgogICAgICAgIHNlbGYuZGVmYXVsdHNbZGVzdF0gPSB2YWx1ZQoKICAgIGRlZiBzZXRfZGVmYXVsdHMoc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuZGVmYXVsdHMudXBkYXRlKGt3YXJncykKCiAgICBkZWYgX2dldF9hbGxfb3B0aW9ucyhzZWxmKToKICAgICAgICBvcHRpb25zID0gc2VsZi5vcHRpb25fbGlzdFs6XQogICAgICAgIGZvciBncm91cCBpbiBzZWxmLm9wdGlvbl9ncm91cHM6CiAgICAgICAgICAgIG9wdGlvbnMuZXh0ZW5kKGdyb3VwLm9wdGlvbl9saXN0KQogICAgICAgIHJldHVybiBvcHRpb25zCgogICAgZGVmIGdldF9kZWZhdWx0X3ZhbHVlcyhzZWxmKToKICAgICAgICBpZiBub3Qgc2VsZi5wcm9jZXNzX2RlZmF1bHRfdmFsdWVzOgogICAgICAgICAgICAjIE9sZCwgcHJlLU9wdGlrIDEuNSBiZWhhdmlvdXIuCiAgICAgICAgICAgIHJldHVybiBWYWx1ZXMoc2VsZi5kZWZhdWx0cykKCiAgICAgICAgZGVmYXVsdHMgPSBzZWxmLmRlZmF1bHRzLmNvcHkoKQogICAgICAgIGZvciBvcHRpb24gaW4gc2VsZi5fZ2V0X2FsbF9vcHRpb25zKCk6CiAgICAgICAgICAgIGRlZmF1bHQgPSBkZWZhdWx0cy5nZXQob3B0aW9uLmRlc3QpCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoZGVmYXVsdCwgc3RyKToKICAgICAgICAgICAgICAgIG9wdF9zdHIgPSBvcHRpb24uZ2V0X29wdF9zdHJpbmcoKQogICAgICAgICAgICAgICAgZGVmYXVsdHNbb3B0aW9uLmRlc3RdID0gb3B0aW9uLmNoZWNrX3ZhbHVlKG9wdF9zdHIsIGRlZmF1bHQpCgogICAgICAgIHJldHVybiBWYWx1ZXMoZGVmYXVsdHMpCgoKICAgICMgLS0gT3B0aW9uR3JvdXAgbWV0aG9kcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgZGVmIGFkZF9vcHRpb25fZ3JvdXAoc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAjIFhYWCBsb3RzIG9mIG92ZXJsYXAgd2l0aCBPcHRpb25Db250YWluZXIuYWRkX29wdGlvbigpCiAgICAgICAgaWYgaXNpbnN0YW5jZShhcmdzWzBdLCBzdHIpOgogICAgICAgICAgICBncm91cCA9IE9wdGlvbkdyb3VwKHNlbGYsICphcmdzLCAqKmt3YXJncykKICAgICAgICBlbGlmIGxlbihhcmdzKSA9PSAxIGFuZCBub3Qga3dhcmdzOgogICAgICAgICAgICBncm91cCA9IGFyZ3NbMF0KICAgICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoZ3JvdXAsIE9wdGlvbkdyb3VwKToKICAgICAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigibm90IGFuIE9wdGlvbkdyb3VwIGluc3RhbmNlOiAlciIgJSBncm91cCkKICAgICAgICAgICAgaWYgZ3JvdXAucGFyc2VyIGlzIG5vdCBzZWxmOgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiaW52YWxpZCBPcHRpb25Hcm91cCAod3JvbmcgcGFyc2VyKSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJpbnZhbGlkIGFyZ3VtZW50cyIpCgogICAgICAgIHNlbGYub3B0aW9uX2dyb3Vwcy5hcHBlbmQoZ3JvdXApCiAgICAgICAgcmV0dXJuIGdyb3VwCgogICAgZGVmIGdldF9vcHRpb25fZ3JvdXAoc2VsZiwgb3B0X3N0cik6CiAgICAgICAgb3B0aW9uID0gKHNlbGYuX3Nob3J0X29wdC5nZXQob3B0X3N0cikgb3IKICAgICAgICAgICAgICAgICAgc2VsZi5fbG9uZ19vcHQuZ2V0KG9wdF9zdHIpKQogICAgICAgIGlmIG9wdGlvbiBhbmQgb3B0aW9uLmNvbnRhaW5lciBpcyBub3Qgc2VsZjoKICAgICAgICAgICAgcmV0dXJuIG9wdGlvbi5jb250YWluZXIKICAgICAgICByZXR1cm4gTm9uZQoKCiAgICAjIC0tIE9wdGlvbi1wYXJzaW5nIG1ldGhvZHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIGRlZiBfZ2V0X2FyZ3Moc2VsZiwgYXJncyk6CiAgICAgICAgaWYgYXJncyBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gc3lzLmFyZ3ZbMTpdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIGFyZ3NbOl0gICAgICAgICAgICAgICMgZG9uJ3QgbW9kaWZ5IGNhbGxlcidzIGxpc3QKCiAgICBkZWYgcGFyc2VfYXJncyhzZWxmLCBhcmdzPU5vbmUsIHZhbHVlcz1Ob25lKToKICAgICAgICAiIiIKICAgICAgICBwYXJzZV9hcmdzKGFyZ3MgOiBbc3RyaW5nXSA9IHN5cy5hcmd2WzE6XSwKICAgICAgICAgICAgICAgICAgIHZhbHVlcyA6IFZhbHVlcyA9IE5vbmUpCiAgICAgICAgLT4gKHZhbHVlcyA6IFZhbHVlcywgYXJncyA6IFtzdHJpbmddKQoKICAgICAgICBQYXJzZSB0aGUgY29tbWFuZC1saW5lIG9wdGlvbnMgZm91bmQgaW4gJ2FyZ3MnIChkZWZhdWx0OgogICAgICAgIHN5cy5hcmd2WzE6XSkuICBBbnkgZXJyb3JzIHJlc3VsdCBpbiBhIGNhbGwgdG8gJ2Vycm9yKCknLCB3aGljaAogICAgICAgIGJ5IGRlZmF1bHQgcHJpbnRzIHRoZSB1c2FnZSBtZXNzYWdlIHRvIHN0ZGVyciBhbmQgY2FsbHMKICAgICAgICBzeXMuZXhpdCgpIHdpdGggYW4gZXJyb3IgbWVzc2FnZS4gIE9uIHN1Y2Nlc3MgcmV0dXJucyBhIHBhaXIKICAgICAgICAodmFsdWVzLCBhcmdzKSB3aGVyZSAndmFsdWVzJyBpcyBhbiBWYWx1ZXMgaW5zdGFuY2UgKHdpdGggYWxsCiAgICAgICAgeW91ciBvcHRpb24gdmFsdWVzKSBhbmQgJ2FyZ3MnIGlzIHRoZSBsaXN0IG9mIGFyZ3VtZW50cyBsZWZ0CiAgICAgICAgb3ZlciBhZnRlciBwYXJzaW5nIG9wdGlvbnMuCiAgICAgICAgIiIiCiAgICAgICAgcmFyZ3MgPSBzZWxmLl9nZXRfYXJncyhhcmdzKQogICAgICAgIGlmIHZhbHVlcyBpcyBOb25lOgogICAgICAgICAgICB2YWx1ZXMgPSBzZWxmLmdldF9kZWZhdWx0X3ZhbHVlcygpCgogICAgICAgICMgU3RvcmUgdGhlIGhhbHZlcyBvZiB0aGUgYXJndW1lbnQgbGlzdCBhcyBhdHRyaWJ1dGVzIGZvciB0aGUKICAgICAgICAjIGNvbnZlbmllbmNlIG9mIGNhbGxiYWNrczoKICAgICAgICAjICAgcmFyZ3MKICAgICAgICAjICAgICB0aGUgcmVzdCBvZiB0aGUgY29tbWFuZC1saW5lICh0aGUgInIiIHN0YW5kcyBmb3IKICAgICAgICAjICAgICAicmVtYWluaW5nIiBvciAicmlnaHQtaGFuZCIpCiAgICAgICAgIyAgIGxhcmdzCiAgICAgICAgIyAgICAgdGhlIGxlZnRvdmVyIGFyZ3VtZW50cyAtLSBpZS4gd2hhdCdzIGxlZnQgYWZ0ZXIgcmVtb3ZpbmcKICAgICAgICAjICAgICBvcHRpb25zIGFuZCB0aGVpciBhcmd1bWVudHMgKHRoZSAibCIgc3RhbmRzIGZvciAibGVmdG92ZXIiCiAgICAgICAgIyAgICAgb3IgImxlZnQtaGFuZCIpCiAgICAgICAgc2VsZi5yYXJncyA9IHJhcmdzCiAgICAgICAgc2VsZi5sYXJncyA9IGxhcmdzID0gW10KICAgICAgICBzZWxmLnZhbHVlcyA9IHZhbHVlcwoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHN0b3AgPSBzZWxmLl9wcm9jZXNzX2FyZ3MobGFyZ3MsIHJhcmdzLCB2YWx1ZXMpCiAgICAgICAgZXhjZXB0IChCYWRPcHRpb25FcnJvciwgT3B0aW9uVmFsdWVFcnJvcikgYXMgZXJyOgogICAgICAgICAgICBzZWxmLmVycm9yKHN0cihlcnIpKQoKICAgICAgICBhcmdzID0gbGFyZ3MgKyByYXJncwogICAgICAgIHJldHVybiBzZWxmLmNoZWNrX3ZhbHVlcyh2YWx1ZXMsIGFyZ3MpCgogICAgZGVmIGNoZWNrX3ZhbHVlcyhzZWxmLCB2YWx1ZXMsIGFyZ3MpOgogICAgICAgICIiIgogICAgICAgIGNoZWNrX3ZhbHVlcyh2YWx1ZXMgOiBWYWx1ZXMsIGFyZ3MgOiBbc3RyaW5nXSkKICAgICAgICAtPiAodmFsdWVzIDogVmFsdWVzLCBhcmdzIDogW3N0cmluZ10pCgogICAgICAgIENoZWNrIHRoYXQgdGhlIHN1cHBsaWVkIG9wdGlvbiB2YWx1ZXMgYW5kIGxlZnRvdmVyIGFyZ3VtZW50cyBhcmUKICAgICAgICB2YWxpZC4gIFJldHVybnMgdGhlIG9wdGlvbiB2YWx1ZXMgYW5kIGxlZnRvdmVyIGFyZ3VtZW50cwogICAgICAgIChwb3NzaWJseSBhZGp1c3RlZCwgcG9zc2libHkgY29tcGxldGVseSBuZXcgLS0gd2hhdGV2ZXIgeW91CiAgICAgICAgbGlrZSkuICBEZWZhdWx0IGltcGxlbWVudGF0aW9uIGp1c3QgcmV0dXJucyB0aGUgcGFzc2VkLWluCiAgICAgICAgdmFsdWVzOyBzdWJjbGFzc2VzIG1heSBvdmVycmlkZSBhcyBkZXNpcmVkLgogICAgICAgICIiIgogICAgICAgIHJldHVybiAodmFsdWVzLCBhcmdzKQoKICAgIGRlZiBfcHJvY2Vzc19hcmdzKHNlbGYsIGxhcmdzLCByYXJncywgdmFsdWVzKToKICAgICAgICAiIiJfcHJvY2Vzc19hcmdzKGxhcmdzIDogW3N0cmluZ10sCiAgICAgICAgICAgICAgICAgICAgICAgICByYXJncyA6IFtzdHJpbmddLAogICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzIDogVmFsdWVzKQoKICAgICAgICBQcm9jZXNzIGNvbW1hbmQtbGluZSBhcmd1bWVudHMgYW5kIHBvcHVsYXRlICd2YWx1ZXMnLCBjb25zdW1pbmcKICAgICAgICBvcHRpb25zIGFuZCBhcmd1bWVudHMgZnJvbSAncmFyZ3MnLiAgSWYgJ2FsbG93X2ludGVyc3BlcnNlZF9hcmdzJyBpcwogICAgICAgIGZhbHNlLCBzdG9wIGF0IHRoZSBmaXJzdCBub24tb3B0aW9uIGFyZ3VtZW50LiAgSWYgdHJ1ZSwgYWNjdW11bGF0ZSBhbnkKICAgICAgICBpbnRlcnNwZXJzZWQgbm9uLW9wdGlvbiBhcmd1bWVudHMgaW4gJ2xhcmdzJy4KICAgICAgICAiIiIKICAgICAgICB3aGlsZSByYXJnczoKICAgICAgICAgICAgYXJnID0gcmFyZ3NbMF0KICAgICAgICAgICAgIyBXZSBoYW5kbGUgYmFyZSAiLS0iIGV4cGxpY2l0bHksIGFuZCBiYXJlICItIiBpcyBoYW5kbGVkIGJ5IHRoZQogICAgICAgICAgICAjIHN0YW5kYXJkIGFyZyBoYW5kbGVyIHNpbmNlIHRoZSBzaG9ydCBhcmcgY2FzZSBlbnN1cmVzIHRoYXQgdGhlCiAgICAgICAgICAgICMgbGVuIG9mIHRoZSBvcHQgc3RyaW5nIGlzIGdyZWF0ZXIgdGhhbiAxLgogICAgICAgICAgICBpZiBhcmcgPT0gIi0tIjoKICAgICAgICAgICAgICAgIGRlbCByYXJnc1swXQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGVsaWYgYXJnWzA6Ml0gPT0gIi0tIjoKICAgICAgICAgICAgICAgICMgcHJvY2VzcyBhIHNpbmdsZSBsb25nIG9wdGlvbiAocG9zc2libHkgd2l0aCB2YWx1ZShzKSkKICAgICAgICAgICAgICAgIHNlbGYuX3Byb2Nlc3NfbG9uZ19vcHQocmFyZ3MsIHZhbHVlcykKICAgICAgICAgICAgZWxpZiBhcmdbOjFdID09ICItIiBhbmQgbGVuKGFyZykgPiAxOgogICAgICAgICAgICAgICAgIyBwcm9jZXNzIGEgY2x1c3RlciBvZiBzaG9ydCBvcHRpb25zIChwb3NzaWJseSB3aXRoCiAgICAgICAgICAgICAgICAjIHZhbHVlKHMpIGZvciB0aGUgbGFzdCBvbmUgb25seSkKICAgICAgICAgICAgICAgIHNlbGYuX3Byb2Nlc3Nfc2hvcnRfb3B0cyhyYXJncywgdmFsdWVzKQogICAgICAgICAgICBlbGlmIHNlbGYuYWxsb3dfaW50ZXJzcGVyc2VkX2FyZ3M6CiAgICAgICAgICAgICAgICBsYXJncy5hcHBlbmQoYXJnKQogICAgICAgICAgICAgICAgZGVsIHJhcmdzWzBdCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZXR1cm4gICAgICAgICAgICAgICAgICAjIHN0b3Agbm93LCBsZWF2ZSB0aGlzIGFyZyBpbiByYXJncwoKICAgICAgICAjIFNheSB0aGlzIGlzIHRoZSBvcmlnaW5hbCBhcmd1bWVudCBsaXN0OgogICAgICAgICMgW2FyZzAsIGFyZzEsIC4uLiwgYXJnKGktMSksIGFyZyhpKSwgYXJnKGkrMSksIC4uLiwgYXJnKE4tMSldCiAgICAgICAgIyAgICAgICAgICAgICAgICAgICAgICAgICAgICBeCiAgICAgICAgIyAod2UgYXJlIGFib3V0IHRvIHByb2Nlc3MgYXJnKGkpKS4KICAgICAgICAjCiAgICAgICAgIyBUaGVuIHJhcmdzIGlzIFthcmcoaSksIC4uLiwgYXJnKE4tMSldIGFuZCBsYXJncyBpcyBhICpzdWJzZXQqIG9mCiAgICAgICAgIyBbYXJnMCwgLi4uLCBhcmcoaS0xKV0gKGFueSBvcHRpb25zIGFuZCB0aGVpciBhcmd1bWVudHMgd2lsbCBoYXZlCiAgICAgICAgIyBiZWVuIHJlbW92ZWQgZnJvbSBsYXJncykuCiAgICAgICAgIwogICAgICAgICMgVGhlIHdoaWxlIGxvb3Agd2lsbCB1c3VhbGx5IGNvbnN1bWUgMSBvciBtb3JlIGFyZ3VtZW50cyBwZXIgcGFzcy4KICAgICAgICAjIElmIGl0IGNvbnN1bWVzIDEgKGVnLiBhcmcgaXMgYW4gb3B0aW9uIHRoYXQgdGFrZXMgbm8gYXJndW1lbnRzKSwKICAgICAgICAjIHRoZW4gYWZ0ZXIgX3Byb2Nlc3NfYXJnKCkgaXMgZG9uZSB0aGUgc2l0dWF0aW9uIGlzOgogICAgICAgICMKICAgICAgICAjICAgbGFyZ3MgPSBzdWJzZXQgb2YgW2FyZzAsIC4uLiwgYXJnKGkpXQogICAgICAgICMgICByYXJncyA9IFthcmcoaSsxKSwgLi4uLCBhcmcoTi0xKV0KICAgICAgICAjCiAgICAgICAgIyBJZiBhbGxvd19pbnRlcnNwZXJzZWRfYXJncyBpcyBmYWxzZSwgbGFyZ3Mgd2lsbCBhbHdheXMgYmUKICAgICAgICAjICplbXB0eSogLS0gc3RpbGwgYSBzdWJzZXQgb2YgW2FyZzAsIC4uLiwgYXJnKGktMSldLCBidXQKICAgICAgICAjIG5vdCBhIHZlcnkgaW50ZXJlc3Rpbmcgc3Vic2V0IQoKICAgIGRlZiBfbWF0Y2hfbG9uZ19vcHQoc2VsZiwgb3B0KToKICAgICAgICAiIiJfbWF0Y2hfbG9uZ19vcHQob3B0IDogc3RyaW5nKSAtPiBzdHJpbmcKCiAgICAgICAgRGV0ZXJtaW5lIHdoaWNoIGxvbmcgb3B0aW9uIHN0cmluZyAnb3B0JyBtYXRjaGVzLCBpZS4gd2hpY2ggb25lCiAgICAgICAgaXQgaXMgYW4gdW5hbWJpZ3VvdXMgYWJicmV2YXRpb24gZm9yLiAgUmFpc2VzIEJhZE9wdGlvbkVycm9yIGlmCiAgICAgICAgJ29wdCcgZG9lc24ndCB1bmFtYmlndW91c2x5IG1hdGNoIGFueSBsb25nIG9wdGlvbiBzdHJpbmcuCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIF9tYXRjaF9hYmJyZXYob3B0LCBzZWxmLl9sb25nX29wdCkKCiAgICBkZWYgX3Byb2Nlc3NfbG9uZ19vcHQoc2VsZiwgcmFyZ3MsIHZhbHVlcyk6CiAgICAgICAgYXJnID0gcmFyZ3MucG9wKDApCgogICAgICAgICMgVmFsdWUgZXhwbGljaXRseSBhdHRhY2hlZCB0byBhcmc/ICBQcmV0ZW5kIGl0J3MgdGhlIG5leHQKICAgICAgICAjIGFyZ3VtZW50LgogICAgICAgIGlmICI9IiBpbiBhcmc6CiAgICAgICAgICAgIChvcHQsIG5leHRfYXJnKSA9IGFyZy5zcGxpdCgiPSIsIDEpCiAgICAgICAgICAgIHJhcmdzLmluc2VydCgwLCBuZXh0X2FyZykKICAgICAgICAgICAgaGFkX2V4cGxpY2l0X3ZhbHVlID0gVHJ1ZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG9wdCA9IGFyZwogICAgICAgICAgICBoYWRfZXhwbGljaXRfdmFsdWUgPSBGYWxzZQoKICAgICAgICBvcHQgPSBzZWxmLl9tYXRjaF9sb25nX29wdChvcHQpCiAgICAgICAgb3B0aW9uID0gc2VsZi5fbG9uZ19vcHRbb3B0XQogICAgICAgIGlmIG9wdGlvbi50YWtlc192YWx1ZSgpOgogICAgICAgICAgICBuYXJncyA9IG9wdGlvbi5uYXJncwogICAgICAgICAgICBpZiBsZW4ocmFyZ3MpIDwgbmFyZ3M6CiAgICAgICAgICAgICAgICBzZWxmLmVycm9yKG5nZXR0ZXh0KAogICAgICAgICAgICAgICAgICAgICIlKG9wdGlvbilzIG9wdGlvbiByZXF1aXJlcyAlKG51bWJlcilkIGFyZ3VtZW50IiwKICAgICAgICAgICAgICAgICAgICAiJShvcHRpb24pcyBvcHRpb24gcmVxdWlyZXMgJShudW1iZXIpZCBhcmd1bWVudHMiLAogICAgICAgICAgICAgICAgICAgIG5hcmdzKSAlIHsib3B0aW9uIjogb3B0LCAibnVtYmVyIjogbmFyZ3N9KQogICAgICAgICAgICBlbGlmIG5hcmdzID09IDE6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IHJhcmdzLnBvcCgwKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdmFsdWUgPSB0dXBsZShyYXJnc1swOm5hcmdzXSkKICAgICAgICAgICAgICAgIGRlbCByYXJnc1swOm5hcmdzXQoKICAgICAgICBlbGlmIGhhZF9leHBsaWNpdF92YWx1ZToKICAgICAgICAgICAgc2VsZi5lcnJvcihfKCIlcyBvcHRpb24gZG9lcyBub3QgdGFrZSBhIHZhbHVlIikgJSBvcHQpCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHZhbHVlID0gTm9uZQoKICAgICAgICBvcHRpb24ucHJvY2VzcyhvcHQsIHZhbHVlLCB2YWx1ZXMsIHNlbGYpCgogICAgZGVmIF9wcm9jZXNzX3Nob3J0X29wdHMoc2VsZiwgcmFyZ3MsIHZhbHVlcyk6CiAgICAgICAgYXJnID0gcmFyZ3MucG9wKDApCiAgICAgICAgc3RvcCA9IEZhbHNlCiAgICAgICAgaSA9IDEKICAgICAgICBmb3IgY2ggaW4gYXJnWzE6XToKICAgICAgICAgICAgb3B0ID0gIi0iICsgY2gKICAgICAgICAgICAgb3B0aW9uID0gc2VsZi5fc2hvcnRfb3B0LmdldChvcHQpCiAgICAgICAgICAgIGkgKz0gMSAgICAgICAgICAgICAgICAgICAgICAjIHdlIGhhdmUgY29uc3VtZWQgYSBjaGFyYWN0ZXIKCiAgICAgICAgICAgIGlmIG5vdCBvcHRpb246CiAgICAgICAgICAgICAgICByYWlzZSBCYWRPcHRpb25FcnJvcihvcHQpCiAgICAgICAgICAgIGlmIG9wdGlvbi50YWtlc192YWx1ZSgpOgogICAgICAgICAgICAgICAgIyBBbnkgY2hhcmFjdGVycyBsZWZ0IGluIGFyZz8gIFByZXRlbmQgdGhleSdyZSB0aGUKICAgICAgICAgICAgICAgICMgbmV4dCBhcmcsIGFuZCBzdG9wIGNvbnN1bWluZyBjaGFyYWN0ZXJzIG9mIGFyZy4KICAgICAgICAgICAgICAgIGlmIGkgPCBsZW4oYXJnKToKICAgICAgICAgICAgICAgICAgICByYXJncy5pbnNlcnQoMCwgYXJnW2k6XSkKICAgICAgICAgICAgICAgICAgICBzdG9wID0gVHJ1ZQoKICAgICAgICAgICAgICAgIG5hcmdzID0gb3B0aW9uLm5hcmdzCiAgICAgICAgICAgICAgICBpZiBsZW4ocmFyZ3MpIDwgbmFyZ3M6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5lcnJvcihuZ2V0dGV4dCgKICAgICAgICAgICAgICAgICAgICAgICAgIiUob3B0aW9uKXMgb3B0aW9uIHJlcXVpcmVzICUobnVtYmVyKWQgYXJndW1lbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAiJShvcHRpb24pcyBvcHRpb24gcmVxdWlyZXMgJShudW1iZXIpZCBhcmd1bWVudHMiLAogICAgICAgICAgICAgICAgICAgICAgICBuYXJncykgJSB7Im9wdGlvbiI6IG9wdCwgIm51bWJlciI6IG5hcmdzfSkKICAgICAgICAgICAgICAgIGVsaWYgbmFyZ3MgPT0gMToKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHJhcmdzLnBvcCgwKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHR1cGxlKHJhcmdzWzA6bmFyZ3NdKQogICAgICAgICAgICAgICAgICAgIGRlbCByYXJnc1swOm5hcmdzXQoKICAgICAgICAgICAgZWxzZTogICAgICAgICAgICAgICAgICAgICAgICMgb3B0aW9uIGRvZXNuJ3QgdGFrZSBhIHZhbHVlCiAgICAgICAgICAgICAgICB2YWx1ZSA9IE5vbmUKCiAgICAgICAgICAgIG9wdGlvbi5wcm9jZXNzKG9wdCwgdmFsdWUsIHZhbHVlcywgc2VsZikKCiAgICAgICAgICAgIGlmIHN0b3A6CiAgICAgICAgICAgICAgICBicmVhawoKCiAgICAjIC0tIEZlZWRiYWNrIG1ldGhvZHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIGRlZiBnZXRfcHJvZ19uYW1lKHNlbGYpOgogICAgICAgIGlmIHNlbGYucHJvZyBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gb3MucGF0aC5iYXNlbmFtZShzeXMuYXJndlswXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gc2VsZi5wcm9nCgogICAgZGVmIGV4cGFuZF9wcm9nX25hbWUoc2VsZiwgcyk6CiAgICAgICAgcmV0dXJuIHMucmVwbGFjZSgiJXByb2ciLCBzZWxmLmdldF9wcm9nX25hbWUoKSkKCiAgICBkZWYgZ2V0X2Rlc2NyaXB0aW9uKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmV4cGFuZF9wcm9nX25hbWUoc2VsZi5kZXNjcmlwdGlvbikKCiAgICBkZWYgZXhpdChzZWxmLCBzdGF0dXM9MCwgbXNnPU5vbmUpOgogICAgICAgIGlmIG1zZzoKICAgICAgICAgICAgc3lzLnN0ZGVyci53cml0ZShtc2cpCiAgICAgICAgc3lzLmV4aXQoc3RhdHVzKQoKICAgIGRlZiBlcnJvcihzZWxmLCBtc2cpOgogICAgICAgICIiImVycm9yKG1zZyA6IHN0cmluZykKCiAgICAgICAgUHJpbnQgYSB1c2FnZSBtZXNzYWdlIGluY29ycG9yYXRpbmcgJ21zZycgdG8gc3RkZXJyIGFuZCBleGl0LgogICAgICAgIElmIHlvdSBvdmVycmlkZSB0aGlzIGluIGEgc3ViY2xhc3MsIGl0IHNob3VsZCBub3QgcmV0dXJuIC0tIGl0CiAgICAgICAgc2hvdWxkIGVpdGhlciBleGl0IG9yIHJhaXNlIGFuIGV4Y2VwdGlvbi4KICAgICAgICAiIiIKICAgICAgICBzZWxmLnByaW50X3VzYWdlKHN5cy5zdGRlcnIpCiAgICAgICAgc2VsZi5leGl0KDIsICIlczogZXJyb3I6ICVzXG4iICUgKHNlbGYuZ2V0X3Byb2dfbmFtZSgpLCBtc2cpKQoKICAgIGRlZiBnZXRfdXNhZ2Uoc2VsZik6CiAgICAgICAgaWYgc2VsZi51c2FnZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuZm9ybWF0dGVyLmZvcm1hdF91c2FnZSgKICAgICAgICAgICAgICAgIHNlbGYuZXhwYW5kX3Byb2dfbmFtZShzZWxmLnVzYWdlKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gIiIKCiAgICBkZWYgcHJpbnRfdXNhZ2Uoc2VsZiwgZmlsZT1Ob25lKToKICAgICAgICAiIiJwcmludF91c2FnZShmaWxlIDogZmlsZSA9IHN0ZG91dCkKCiAgICAgICAgUHJpbnQgdGhlIHVzYWdlIG1lc3NhZ2UgZm9yIHRoZSBjdXJyZW50IHByb2dyYW0gKHNlbGYudXNhZ2UpIHRvCiAgICAgICAgJ2ZpbGUnIChkZWZhdWx0IHN0ZG91dCkuICBBbnkgb2NjdXJyZW5jZSBvZiB0aGUgc3RyaW5nICIlcHJvZyIgaW4KICAgICAgICBzZWxmLnVzYWdlIGlzIHJlcGxhY2VkIHdpdGggdGhlIG5hbWUgb2YgdGhlIGN1cnJlbnQgcHJvZ3JhbQogICAgICAgIChiYXNlbmFtZSBvZiBzeXMuYXJndlswXSkuICBEb2VzIG5vdGhpbmcgaWYgc2VsZi51c2FnZSBpcyBlbXB0eQogICAgICAgIG9yIG5vdCBkZWZpbmVkLgogICAgICAgICIiIgogICAgICAgIGlmIHNlbGYudXNhZ2U6CiAgICAgICAgICAgIHByaW50KHNlbGYuZ2V0X3VzYWdlKCksIGZpbGU9ZmlsZSkKCiAgICBkZWYgZ2V0X3ZlcnNpb24oc2VsZik6CiAgICAgICAgaWYgc2VsZi52ZXJzaW9uOgogICAgICAgICAgICByZXR1cm4gc2VsZi5leHBhbmRfcHJvZ19uYW1lKHNlbGYudmVyc2lvbikKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gIiIKCiAgICBkZWYgcHJpbnRfdmVyc2lvbihzZWxmLCBmaWxlPU5vbmUpOgogICAgICAgICIiInByaW50X3ZlcnNpb24oZmlsZSA6IGZpbGUgPSBzdGRvdXQpCgogICAgICAgIFByaW50IHRoZSB2ZXJzaW9uIG1lc3NhZ2UgZm9yIHRoaXMgcHJvZ3JhbSAoc2VsZi52ZXJzaW9uKSB0bwogICAgICAgICdmaWxlJyAoZGVmYXVsdCBzdGRvdXQpLiAgQXMgd2l0aCBwcmludF91c2FnZSgpLCBhbnkgb2NjdXJyZW5jZQogICAgICAgIG9mICIlcHJvZyIgaW4gc2VsZi52ZXJzaW9uIGlzIHJlcGxhY2VkIGJ5IHRoZSBjdXJyZW50IHByb2dyYW0ncwogICAgICAgIG5hbWUuICBEb2VzIG5vdGhpbmcgaWYgc2VsZi52ZXJzaW9uIGlzIGVtcHR5IG9yIHVuZGVmaW5lZC4KICAgICAgICAiIiIKICAgICAgICBpZiBzZWxmLnZlcnNpb246CiAgICAgICAgICAgIHByaW50KHNlbGYuZ2V0X3ZlcnNpb24oKSwgZmlsZT1maWxlKQoKICAgIGRlZiBmb3JtYXRfb3B0aW9uX2hlbHAoc2VsZiwgZm9ybWF0dGVyPU5vbmUpOgogICAgICAgIGlmIGZvcm1hdHRlciBpcyBOb25lOgogICAgICAgICAgICBmb3JtYXR0ZXIgPSBzZWxmLmZvcm1hdHRlcgogICAgICAgIGZvcm1hdHRlci5zdG9yZV9vcHRpb25fc3RyaW5ncyhzZWxmKQogICAgICAgIHJlc3VsdCA9IFtdCiAgICAgICAgcmVzdWx0LmFwcGVuZChmb3JtYXR0ZXIuZm9ybWF0X2hlYWRpbmcoXygiT3B0aW9ucyIpKSkKICAgICAgICBmb3JtYXR0ZXIuaW5kZW50KCkKICAgICAgICBpZiBzZWxmLm9wdGlvbl9saXN0OgogICAgICAgICAgICByZXN1bHQuYXBwZW5kKE9wdGlvbkNvbnRhaW5lci5mb3JtYXRfb3B0aW9uX2hlbHAoc2VsZiwgZm9ybWF0dGVyKSkKICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgiXG4iKQogICAgICAgIGZvciBncm91cCBpbiBzZWxmLm9wdGlvbl9ncm91cHM6CiAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoZ3JvdXAuZm9ybWF0X2hlbHAoZm9ybWF0dGVyKSkKICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgiXG4iKQogICAgICAgIGZvcm1hdHRlci5kZWRlbnQoKQogICAgICAgICMgRHJvcCB0aGUgbGFzdCAiXG4iLCBvciB0aGUgaGVhZGVyIGlmIG5vIG9wdGlvbnMgb3Igb3B0aW9uIGdyb3VwczoKICAgICAgICByZXR1cm4gIiIuam9pbihyZXN1bHRbOi0xXSkKCiAgICBkZWYgZm9ybWF0X2VwaWxvZyhzZWxmLCBmb3JtYXR0ZXIpOgogICAgICAgIHJldHVybiBmb3JtYXR0ZXIuZm9ybWF0X2VwaWxvZyhzZWxmLmVwaWxvZykKCiAgICBkZWYgZm9ybWF0X2hlbHAoc2VsZiwgZm9ybWF0dGVyPU5vbmUpOgogICAgICAgIGlmIGZvcm1hdHRlciBpcyBOb25lOgogICAgICAgICAgICBmb3JtYXR0ZXIgPSBzZWxmLmZvcm1hdHRlcgogICAgICAgIHJlc3VsdCA9IFtdCiAgICAgICAgaWYgc2VsZi51c2FnZToKICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChzZWxmLmdldF91c2FnZSgpICsgIlxuIikKICAgICAgICBpZiBzZWxmLmRlc2NyaXB0aW9uOgogICAgICAgICAgICByZXN1bHQuYXBwZW5kKHNlbGYuZm9ybWF0X2Rlc2NyaXB0aW9uKGZvcm1hdHRlcikgKyAiXG4iKQogICAgICAgIHJlc3VsdC5hcHBlbmQoc2VsZi5mb3JtYXRfb3B0aW9uX2hlbHAoZm9ybWF0dGVyKSkKICAgICAgICByZXN1bHQuYXBwZW5kKHNlbGYuZm9ybWF0X2VwaWxvZyhmb3JtYXR0ZXIpKQogICAgICAgIHJldHVybiAiIi5qb2luKHJlc3VsdCkKCiAgICBkZWYgcHJpbnRfaGVscChzZWxmLCBmaWxlPU5vbmUpOgogICAgICAgICIiInByaW50X2hlbHAoZmlsZSA6IGZpbGUgPSBzdGRvdXQpCgogICAgICAgIFByaW50IGFuIGV4dGVuZGVkIGhlbHAgbWVzc2FnZSwgbGlzdGluZyBhbGwgb3B0aW9ucyBhbmQgYW55CiAgICAgICAgaGVscCB0ZXh0IHByb3ZpZGVkIHdpdGggdGhlbSwgdG8gJ2ZpbGUnIChkZWZhdWx0IHN0ZG91dCkuCiAgICAgICAgIiIiCiAgICAgICAgaWYgZmlsZSBpcyBOb25lOgogICAgICAgICAgICBmaWxlID0gc3lzLnN0ZG91dAogICAgICAgIGZpbGUud3JpdGUoc2VsZi5mb3JtYXRfaGVscCgpKQoKIyBjbGFzcyBPcHRpb25QYXJzZXIKCgpkZWYgX21hdGNoX2FiYnJldihzLCB3b3JkbWFwKToKICAgICIiIl9tYXRjaF9hYmJyZXYocyA6IHN0cmluZywgd29yZG1hcCA6IHtzdHJpbmcgOiBPcHRpb259KSAtPiBzdHJpbmcKCiAgICBSZXR1cm4gdGhlIHN0cmluZyBrZXkgaW4gJ3dvcmRtYXAnIGZvciB3aGljaCAncycgaXMgYW4gdW5hbWJpZ3VvdXMKICAgIGFiYnJldmlhdGlvbi4gIElmICdzJyBpcyBmb3VuZCB0byBiZSBhbWJpZ3VvdXMgb3IgZG9lc24ndCBtYXRjaCBhbnkgb2YKICAgICd3b3JkcycsIHJhaXNlIEJhZE9wdGlvbkVycm9yLgogICAgIiIiCiAgICAjIElzIHRoZXJlIGFuIGV4YWN0IG1hdGNoPwogICAgaWYgcyBpbiB3b3JkbWFwOgogICAgICAgIHJldHVybiBzCiAgICBlbHNlOgogICAgICAgICMgSXNvbGF0ZSBhbGwgd29yZHMgd2l0aCBzIGFzIGEgcHJlZml4LgogICAgICAgIHBvc3NpYmlsaXRpZXMgPSBbd29yZCBmb3Igd29yZCBpbiB3b3JkbWFwLmtleXMoKQogICAgICAgICAgICAgICAgICAgICAgICAgaWYgd29yZC5zdGFydHN3aXRoKHMpXQogICAgICAgICMgTm8gZXhhY3QgbWF0Y2gsIHNvIHRoZXJlIGhhZCBiZXR0ZXIgYmUganVzdCBvbmUgcG9zc2liaWxpdHkuCiAgICAgICAgaWYgbGVuKHBvc3NpYmlsaXRpZXMpID09IDE6CiAgICAgICAgICAgIHJldHVybiBwb3NzaWJpbGl0aWVzWzBdCiAgICAgICAgZWxpZiBub3QgcG9zc2liaWxpdGllczoKICAgICAgICAgICAgcmFpc2UgQmFkT3B0aW9uRXJyb3IocykKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIE1vcmUgdGhhbiBvbmUgcG9zc2libGUgY29tcGxldGlvbjogYW1iaWd1b3VzIHByZWZpeC4KICAgICAgICAgICAgcG9zc2liaWxpdGllcy5zb3J0KCkKICAgICAgICAgICAgcmFpc2UgQW1iaWd1b3VzT3B0aW9uRXJyb3IocywgcG9zc2liaWxpdGllcykKCgojIFNvbWUgZGF5LCB0aGVyZSBtaWdodCBiZSBtYW55IE9wdGlvbiBjbGFzc2VzLiAgQXMgb2YgT3B0aWsgMS4zLCB0aGUKIyBwcmVmZXJyZWQgd2F5IHRvIGluc3RhbnRpYXRlIE9wdGlvbnMgaXMgaW5kaXJlY3RseSwgdmlhIG1ha2Vfb3B0aW9uKCksCiMgd2hpY2ggd2lsbCBiZWNvbWUgYSBmYWN0b3J5IGZ1bmN0aW9uIHdoZW4gdGhlcmUgYXJlIG1hbnkgT3B0aW9uCiMgY2xhc3Nlcy4KbWFrZV9vcHRpb24gPSBPcHRpb24K',
'/Lib/os.py':'ciIiIk9TIHJvdXRpbmVzIGZvciBNYWMsIE5ULCBvciBQb3NpeCBkZXBlbmRpbmcgb24gd2hhdCBzeXN0ZW0gd2UncmUgb24uCgpUaGlzIGV4cG9ydHM6CiAgLSBhbGwgZnVuY3Rpb25zIGZyb20gcG9zaXgsIG50LCBvczIsIG9yIGNlLCBlLmcuIHVubGluaywgc3RhdCwgZXRjLgogIC0gb3MucGF0aCBpcyBlaXRoZXIgcG9zaXhwYXRoIG9yIG50cGF0aAogIC0gb3MubmFtZSBpcyBlaXRoZXIgJ3Bvc2l4JywgJ250JywgJ29zMicgb3IgJ2NlJy4KICAtIG9zLmN1cmRpciBpcyBhIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGN1cnJlbnQgZGlyZWN0b3J5ICgnLicgb3IgJzonKQogIC0gb3MucGFyZGlyIGlzIGEgc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgcGFyZW50IGRpcmVjdG9yeSAoJy4uJyBvciAnOjonKQogIC0gb3Muc2VwIGlzIHRoZSAob3IgYSBtb3N0IGNvbW1vbikgcGF0aG5hbWUgc2VwYXJhdG9yICgnLycgb3IgJzonIG9yICdcXCcpCiAgLSBvcy5leHRzZXAgaXMgdGhlIGV4dGVuc2lvbiBzZXBhcmF0b3IgKGFsd2F5cyAnLicpCiAgLSBvcy5hbHRzZXAgaXMgdGhlIGFsdGVybmF0ZSBwYXRobmFtZSBzZXBhcmF0b3IgKE5vbmUgb3IgJy8nKQogIC0gb3MucGF0aHNlcCBpcyB0aGUgY29tcG9uZW50IHNlcGFyYXRvciB1c2VkIGluICRQQVRIIGV0YwogIC0gb3MubGluZXNlcCBpcyB0aGUgbGluZSBzZXBhcmF0b3IgaW4gdGV4dCBmaWxlcyAoJ1xyJyBvciAnXG4nIG9yICdcclxuJykKICAtIG9zLmRlZnBhdGggaXMgdGhlIGRlZmF1bHQgc2VhcmNoIHBhdGggZm9yIGV4ZWN1dGFibGVzCiAgLSBvcy5kZXZudWxsIGlzIHRoZSBmaWxlIHBhdGggb2YgdGhlIG51bGwgZGV2aWNlICgnL2Rldi9udWxsJywgZXRjLikKClByb2dyYW1zIHRoYXQgaW1wb3J0IGFuZCB1c2UgJ29zJyBzdGFuZCBhIGJldHRlciBjaGFuY2Ugb2YgYmVpbmcKcG9ydGFibGUgYmV0d2VlbiBkaWZmZXJlbnQgcGxhdGZvcm1zLiAgT2YgY291cnNlLCB0aGV5IG11c3QgdGhlbgpvbmx5IHVzZSBmdW5jdGlvbnMgdGhhdCBhcmUgZGVmaW5lZCBieSBhbGwgcGxhdGZvcm1zIChlLmcuLCB1bmxpbmsKYW5kIG9wZW5kaXIpLCBhbmQgbGVhdmUgYWxsIHBhdGhuYW1lIG1hbmlwdWxhdGlvbiB0byBvcy5wYXRoCihlLmcuLCBzcGxpdCBhbmQgam9pbikuCiIiIgoKIycKCmltcG9ydCBzeXMsIGVycm5vCmltcG9ydCBzdGF0IGFzIHN0CgpfbmFtZXMgPSBzeXMuYnVpbHRpbl9tb2R1bGVfbmFtZXMKCiMgTm90ZTogIG1vcmUgbmFtZXMgYXJlIGFkZGVkIHRvIF9fYWxsX18gbGF0ZXIuCl9fYWxsX18gPSBbImFsdHNlcCIsICJjdXJkaXIiLCAicGFyZGlyIiwgInNlcCIsICJwYXRoc2VwIiwgImxpbmVzZXAiLAogICAgICAgICAgICJkZWZwYXRoIiwgIm5hbWUiLCAicGF0aCIsICJkZXZudWxsIiwgIlNFRUtfU0VUIiwgIlNFRUtfQ1VSIiwKICAgICAgICAgICAiU0VFS19FTkQiLCAiZnNlbmNvZGUiLCAiZnNkZWNvZGUiLCAiZ2V0X2V4ZWNfcGF0aCIsICJmZG9wZW4iLAogICAgICAgICAgICJwb3BlbiIsICJleHRzZXAiXQoKZGVmIF9leGlzdHMobmFtZSk6CiAgICByZXR1cm4gbmFtZSBpbiBnbG9iYWxzKCkKCmRlZiBfZ2V0X2V4cG9ydHNfbGlzdChtb2R1bGUpOgogICAgdHJ5OgogICAgICAgIHJldHVybiBsaXN0KG1vZHVsZS5fX2FsbF9fKQogICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgIHJldHVybiBbbiBmb3IgbiBpbiBkaXIobW9kdWxlKSBpZiBuWzBdICE9ICdfJ10KCiMgQW55IG5ldyBkZXBlbmRlbmNpZXMgb2YgdGhlIG9zIG1vZHVsZSBhbmQvb3IgY2hhbmdlcyBpbiBwYXRoIHNlcGFyYXRvcgojIHJlcXVpcmVzIHVwZGF0aW5nIGltcG9ydGxpYiBhcyB3ZWxsLgppZiAncG9zaXgnIGluIF9uYW1lczoKICAgIG5hbWUgPSAncG9zaXgnCiAgICBsaW5lc2VwID0gJ1xuJwogICAgZnJvbSBwb3NpeCBpbXBvcnQgKgogICAgdHJ5OgogICAgICAgIGZyb20gcG9zaXggaW1wb3J0IF9leGl0CiAgICAgICAgX19hbGxfXy5hcHBlbmQoJ19leGl0JykKICAgIGV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgICAgICBwYXNzCiAgICBpbXBvcnQgcG9zaXhwYXRoIGFzIHBhdGgKCiAgICB0cnk6CiAgICAgICAgZnJvbSBwb3NpeCBpbXBvcnQgX2hhdmVfZnVuY3Rpb25zCiAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgcGFzcwoKZWxpZiAnbnQnIGluIF9uYW1lczoKICAgIG5hbWUgPSAnbnQnCiAgICBsaW5lc2VwID0gJ1xyXG4nCiAgICBmcm9tIG50IGltcG9ydCAqCiAgICB0cnk6CiAgICAgICAgZnJvbSBudCBpbXBvcnQgX2V4aXQKICAgICAgICBfX2FsbF9fLmFwcGVuZCgnX2V4aXQnKQogICAgZXhjZXB0IEltcG9ydEVycm9yOgogICAgICAgIHBhc3MKICAgIGltcG9ydCBudHBhdGggYXMgcGF0aAoKICAgIGltcG9ydCBudAogICAgX19hbGxfXy5leHRlbmQoX2dldF9leHBvcnRzX2xpc3QobnQpKQogICAgZGVsIG50CgogICAgdHJ5OgogICAgICAgIGZyb20gbnQgaW1wb3J0IF9oYXZlX2Z1bmN0aW9ucwogICAgZXhjZXB0IEltcG9ydEVycm9yOgogICAgICAgIHBhc3MKCmVsaWYgJ29zMicgaW4gX25hbWVzOgogICAgbmFtZSA9ICdvczInCiAgICBsaW5lc2VwID0gJ1xyXG4nCiAgICBmcm9tIG9zMiBpbXBvcnQgKgogICAgdHJ5OgogICAgICAgIGZyb20gb3MyIGltcG9ydCBfZXhpdAogICAgICAgIF9fYWxsX18uYXBwZW5kKCdfZXhpdCcpCiAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgcGFzcwogICAgaWYgc3lzLnZlcnNpb24uZmluZCgnRU1YIEdDQycpID09IC0xOgogICAgICAgIGltcG9ydCBudHBhdGggYXMgcGF0aAogICAgZWxzZToKICAgICAgICBpbXBvcnQgb3MyZW14cGF0aCBhcyBwYXRoCiAgICAgICAgZnJvbSBfZW14X2xpbmsgaW1wb3J0IGxpbmsKCiAgICBpbXBvcnQgb3MyCiAgICBfX2FsbF9fLmV4dGVuZChfZ2V0X2V4cG9ydHNfbGlzdChvczIpKQogICAgZGVsIG9zMgoKICAgIHRyeToKICAgICAgICBmcm9tIG9zMiBpbXBvcnQgX2hhdmVfZnVuY3Rpb25zCiAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgcGFzcwoKZWxpZiAnY2UnIGluIF9uYW1lczoKICAgIG5hbWUgPSAnY2UnCiAgICBsaW5lc2VwID0gJ1xyXG4nCiAgICBmcm9tIGNlIGltcG9ydCAqCiAgICB0cnk6CiAgICAgICAgZnJvbSBjZSBpbXBvcnQgX2V4aXQKICAgICAgICBfX2FsbF9fLmFwcGVuZCgnX2V4aXQnKQogICAgZXhjZXB0IEltcG9ydEVycm9yOgogICAgICAgIHBhc3MKICAgICMgV2UgY2FuIHVzZSB0aGUgc3RhbmRhcmQgV2luZG93cyBwYXRoLgogICAgaW1wb3J0IG50cGF0aCBhcyBwYXRoCgogICAgaW1wb3J0IGNlCiAgICBfX2FsbF9fLmV4dGVuZChfZ2V0X2V4cG9ydHNfbGlzdChjZSkpCiAgICBkZWwgY2UKCiAgICB0cnk6CiAgICAgICAgZnJvbSBjZSBpbXBvcnQgX2hhdmVfZnVuY3Rpb25zCiAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgcGFzcwoKZWxzZToKICAgIHJhaXNlIEltcG9ydEVycm9yKCdubyBvcyBzcGVjaWZpYyBtb2R1bGUgZm91bmQnKQoKc3lzLm1vZHVsZXNbJ29zLnBhdGgnXSA9IHBhdGgKZnJvbSBvcy5wYXRoIGltcG9ydCAoY3VyZGlyLCBwYXJkaXIsIHNlcCwgcGF0aHNlcCwgZGVmcGF0aCwgZXh0c2VwLCBhbHRzZXAsCiAgICBkZXZudWxsKQoKZGVsIF9uYW1lcwoKCmlmIF9leGlzdHMoIl9oYXZlX2Z1bmN0aW9ucyIpOgogICAgX2dsb2JhbHMgPSBnbG9iYWxzKCkKICAgIGRlZiBfYWRkKHN0ciwgZm4pOgogICAgICAgIGlmIChmbiBpbiBfZ2xvYmFscykgYW5kIChzdHIgaW4gX2hhdmVfZnVuY3Rpb25zKToKICAgICAgICAgICAgX3NldC5hZGQoX2dsb2JhbHNbZm5dKQoKICAgIF9zZXQgPSBzZXQoKQogICAgX2FkZCgiSEFWRV9GQUNDRVNTQVQiLCAgImFjY2VzcyIpCiAgICBfYWRkKCJIQVZFX0ZDSE1PREFUIiwgICAiY2htb2QiKQogICAgX2FkZCgiSEFWRV9GQ0hPV05BVCIsICAgImNob3duIikKICAgIF9hZGQoIkhBVkVfRlNUQVRBVCIsICAgICJzdGF0IikKICAgIF9hZGQoIkhBVkVfRlVUSU1FU0FUIiwgICJ1dGltZSIpCiAgICBfYWRkKCJIQVZFX0xJTktBVCIsICAgICAibGluayIpCiAgICBfYWRkKCJIQVZFX01LRElSQVQiLCAgICAibWtkaXIiKQogICAgX2FkZCgiSEFWRV9NS0ZJRk9BVCIsICAgIm1rZmlmbyIpCiAgICBfYWRkKCJIQVZFX01LTk9EQVQiLCAgICAibWtub2QiKQogICAgX2FkZCgiSEFWRV9PUEVOQVQiLCAgICAgIm9wZW4iKQogICAgX2FkZCgiSEFWRV9SRUFETElOS0FUIiwgInJlYWRsaW5rIikKICAgIF9hZGQoIkhBVkVfUkVOQU1FQVQiLCAgICJyZW5hbWUiKQogICAgX2FkZCgiSEFWRV9TWU1MSU5LQVQiLCAgInN5bWxpbmsiKQogICAgX2FkZCgiSEFWRV9VTkxJTktBVCIsICAgInVubGluayIpCiAgICBfYWRkKCJIQVZFX1VOTElOS0FUIiwgICAicm1kaXIiKQogICAgX2FkZCgiSEFWRV9VVElNRU5TQVQiLCAgInV0aW1lIikKICAgIHN1cHBvcnRzX2Rpcl9mZCA9IF9zZXQKCiAgICBfc2V0ID0gc2V0KCkKICAgIF9hZGQoIkhBVkVfRkFDQ0VTU0FUIiwgICJhY2Nlc3MiKQogICAgc3VwcG9ydHNfZWZmZWN0aXZlX2lkcyA9IF9zZXQKCiAgICBfc2V0ID0gc2V0KCkKICAgIF9hZGQoIkhBVkVfRkNIRElSIiwgICAgICJjaGRpciIpCiAgICBfYWRkKCJIQVZFX0ZDSE1PRCIsICAgICAiY2htb2QiKQogICAgX2FkZCgiSEFWRV9GQ0hPV04iLCAgICAgImNob3duIikKICAgIF9hZGQoIkhBVkVfRkRPUEVORElSIiwgICJsaXN0ZGlyIikKICAgIF9hZGQoIkhBVkVfRkVYRUNWRSIsICAgICJleGVjdmUiKQogICAgX3NldC5hZGQoc3RhdCkgIyBmc3RhdCBhbHdheXMgd29ya3MKICAgIF9hZGQoIkhBVkVfRlRSVU5DQVRFIiwgICJ0cnVuY2F0ZSIpCiAgICBfYWRkKCJIQVZFX0ZVVElNRU5TIiwgICAidXRpbWUiKQogICAgX2FkZCgiSEFWRV9GVVRJTUVTIiwgICAgInV0aW1lIikKICAgIF9hZGQoIkhBVkVfRlBBVEhDT05GIiwgICJwYXRoY29uZiIpCiAgICBpZiBfZXhpc3RzKCJzdGF0dmZzIikgYW5kIF9leGlzdHMoImZzdGF0dmZzIik6ICMgbWFjIG9zIHgxMC4zCiAgICAgICAgX2FkZCgiSEFWRV9GU1RBVFZGUyIsICJzdGF0dmZzIikKICAgIHN1cHBvcnRzX2ZkID0gX3NldAoKICAgIF9zZXQgPSBzZXQoKQogICAgX2FkZCgiSEFWRV9GQUNDRVNTQVQiLCAgImFjY2VzcyIpCiAgICAjIFNvbWUgcGxhdGZvcm1zIGRvbid0IHN1cHBvcnQgbGNobW9kKCkuICBPZnRlbiB0aGUgZnVuY3Rpb24gZXhpc3RzCiAgICAjIGFueXdheSwgYXMgYSBzdHViIHRoYXQgYWx3YXlzIHJldHVybnMgRU5PU1VQIG9yIHBlcmhhcHMgRU9QTk9UU1VQUC4KICAgICMgKE5vLCBJIGRvbid0IGtub3cgd2h5IHRoYXQncyBhIGdvb2QgZGVzaWduLikgIC4vY29uZmlndXJlIHdpbGwgZGV0ZWN0CiAgICAjIHRoaXMgYW5kIHJlamVjdCBpdC0tc28gSEFWRV9MQ0hNT0Qgc3RpbGwgd29uJ3QgYmUgZGVmaW5lZCBvbiBzdWNoCiAgICAjIHBsYXRmb3Jtcy4gIFRoaXMgaXMgVmVyeSBIZWxwZnVsLgogICAgIwogICAgIyBIb3dldmVyLCBzb21ldGltZXMgcGxhdGZvcm1zIHdpdGhvdXQgYSB3b3JraW5nIGxjaG1vZCgpICpkbyogaGF2ZQogICAgIyBmY2htb2RhdCgpLiAgKEV4YW1wbGVzOiBMaW51eCBrZXJuZWwgMy4yIHdpdGggZ2xpYmMgMi4xNSwKICAgICMgT3BlbkluZGlhbmEgMy54LikgIEFuZCBmY2htb2RhdCgpIGhhcyBhIGZsYWcgdGhhdCB0aGVvcmV0aWNhbGx5IG1ha2VzCiAgICAjIGl0IGJlaGF2ZSBsaWtlIGxjaG1vZCgpLiAgU28gaW4gdGhlb3J5IGl0IHdvdWxkIGJlIGEgc3VpdGFibGUKICAgICMgcmVwbGFjZW1lbnQgZm9yIGxjaG1vZCgpLiAgQnV0IHdoZW4gbGNobW9kKCkgZG9lc24ndCB3b3JrLCBmY2htb2RhdCgpJ3MKICAgICMgZmxhZyBkb2Vzbid0IHdvcmsgKmVpdGhlciouICBTYWRseSAuL2NvbmZpZ3VyZSBpc24ndCBzb3BoaXN0aWNhdGVkCiAgICAjIGVub3VnaCB0byBkZXRlY3QgdGhpcyBjb25kaXRpb24tLWl0IG9ubHkgZGV0ZXJtaW5lcyB3aGV0aGVyIG9yIG5vdAogICAgIyBmY2htb2RhdCgpIG1pbmltYWxseSB3b3Jrcy4KICAgICMKICAgICMgVGhlcmVmb3JlIHdlIHNpbXBseSBpZ25vcmUgZmNobW9kYXQoKSB3aGVuIGRlY2lkaW5nIHdoZXRoZXIgb3Igbm90CiAgICAjIG9zLmNobW9kIHN1cHBvcnRzIGZvbGxvd19zeW1saW5rcy4gIEp1c3QgY2hlY2tpbmcgbGNobW9kKCkgaXMKICAgICMgc3VmZmljaWVudC4gIEFmdGVyIGFsbC0taWYgeW91IGhhdmUgYSB3b3JraW5nIGZjaG1vZGF0KCksIHlvdXIKICAgICMgbGNobW9kKCkgYWxtb3N0IGNlcnRhaW5seSB3b3JrcyB0b28uCiAgICAjCiAgICAjIF9hZGQoIkhBVkVfRkNITU9EQVQiLCAgICJjaG1vZCIpCiAgICBfYWRkKCJIQVZFX0ZDSE9XTkFUIiwgICAiY2hvd24iKQogICAgX2FkZCgiSEFWRV9GU1RBVEFUIiwgICAgInN0YXQiKQogICAgX2FkZCgiSEFWRV9MQ0hGTEFHUyIsICAgImNoZmxhZ3MiKQogICAgX2FkZCgiSEFWRV9MQ0hNT0QiLCAgICAgImNobW9kIikKICAgIGlmIF9leGlzdHMoImxjaG93biIpOiAjIG1hYyBvcyB4MTAuMwogICAgICAgIF9hZGQoIkhBVkVfTENIT1dOIiwgImNob3duIikKICAgIF9hZGQoIkhBVkVfTElOS0FUIiwgICAgICJsaW5rIikKICAgIF9hZGQoIkhBVkVfTFVUSU1FUyIsICAgICJ1dGltZSIpCiAgICBfYWRkKCJIQVZFX0xTVEFUIiwgICAgICAic3RhdCIpCiAgICBfYWRkKCJIQVZFX0ZTVEFUQVQiLCAgICAic3RhdCIpCiAgICBfYWRkKCJIQVZFX1VUSU1FTlNBVCIsICAidXRpbWUiKQogICAgX2FkZCgiTVNfV0lORE9XUyIsICAgICAgInN0YXQiKQogICAgc3VwcG9ydHNfZm9sbG93X3N5bWxpbmtzID0gX3NldAoKICAgIGRlbCBfc2V0CiAgICBkZWwgX2hhdmVfZnVuY3Rpb25zCiAgICBkZWwgX2dsb2JhbHMKICAgIGRlbCBfYWRkCgoKIyBQeXRob24gdXNlcyBmaXhlZCB2YWx1ZXMgZm9yIHRoZSBTRUVLXyBjb25zdGFudHM7IHRoZXkgYXJlIG1hcHBlZAojIHRvIG5hdGl2ZSBjb25zdGFudHMgaWYgbmVjZXNzYXJ5IGluIHBvc2l4bW9kdWxlLmMKIyBPdGhlciBwb3NzaWJsZSBTRUVLIHZhbHVlcyBhcmUgZGlyZWN0bHkgaW1wb3J0ZWQgZnJvbSBwb3NpeG1vZHVsZS5jClNFRUtfU0VUID0gMApTRUVLX0NVUiA9IDEKU0VFS19FTkQgPSAyCgoKZGVmIF9nZXRfbWFza2VkX21vZGUobW9kZSk6CiAgICBtYXNrID0gdW1hc2soMCkKICAgIHVtYXNrKG1hc2spCiAgICByZXR1cm4gbW9kZSAmIH5tYXNrCgojIFN1cGVyIGRpcmVjdG9yeSB1dGlsaXRpZXMuCiMgKEluc3BpcmVkIGJ5IEVyaWMgUmF5bW9uZDsgdGhlIGRvYyBzdHJpbmdzIGFyZSBtb3N0bHkgaGlzKQoKZGVmIG1ha2VkaXJzKG5hbWUsIG1vZGU9MG83NzcsIGV4aXN0X29rPUZhbHNlKToKICAgICIiIm1ha2VkaXJzKHBhdGggWywgbW9kZT0wbzc3N11bLCBleGlzdF9vaz1GYWxzZV0pCgogICAgU3VwZXItbWtkaXI7IGNyZWF0ZSBhIGxlYWYgZGlyZWN0b3J5IGFuZCBhbGwgaW50ZXJtZWRpYXRlIG9uZXMuCiAgICBXb3JrcyBsaWtlIG1rZGlyLCBleGNlcHQgdGhhdCBhbnkgaW50ZXJtZWRpYXRlIHBhdGggc2VnbWVudCAobm90CiAgICBqdXN0IHRoZSByaWdodG1vc3QpIHdpbGwgYmUgY3JlYXRlZCBpZiBpdCBkb2VzIG5vdCBleGlzdC4gSWYgdGhlCiAgICB0YXJnZXQgZGlyZWN0b3J5IHdpdGggdGhlIHNhbWUgbW9kZSBhcyB3ZSBzcGVjaWZpZWQgYWxyZWFkeSBleGlzdHMsCiAgICByYWlzZXMgYW4gT1NFcnJvciBpZiBleGlzdF9vayBpcyBGYWxzZSwgb3RoZXJ3aXNlIG5vIGV4Y2VwdGlvbiBpcwogICAgcmFpc2VkLiAgVGhpcyBpcyByZWN1cnNpdmUuCgogICAgIiIiCiAgICBoZWFkLCB0YWlsID0gcGF0aC5zcGxpdChuYW1lKQogICAgaWYgbm90IHRhaWw6CiAgICAgICAgaGVhZCwgdGFpbCA9IHBhdGguc3BsaXQoaGVhZCkKICAgIGlmIGhlYWQgYW5kIHRhaWwgYW5kIG5vdCBwYXRoLmV4aXN0cyhoZWFkKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIG1ha2VkaXJzKGhlYWQsIG1vZGUsIGV4aXN0X29rKQogICAgICAgIGV4Y2VwdCBPU0Vycm9yIGFzIGU6CiAgICAgICAgICAgICMgYmUgaGFwcHkgaWYgc29tZW9uZSBhbHJlYWR5IGNyZWF0ZWQgdGhlIHBhdGgKICAgICAgICAgICAgaWYgZS5lcnJubyAhPSBlcnJuby5FRVhJU1Q6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGlmIHRhaWwgPT0gY3VyZGlyOiAgICAgICAgICAgIyB4eHgvbmV3ZGlyLy4gZXhpc3RzIGlmIHh4eC9uZXdkaXIgZXhpc3RzCiAgICAgICAgICAgIHJldHVybgogICAgdHJ5OgogICAgICAgIG1rZGlyKG5hbWUsIG1vZGUpCiAgICBleGNlcHQgT1NFcnJvciBhcyBlOgogICAgICAgIGRpcl9leGlzdHMgPSBwYXRoLmlzZGlyKG5hbWUpCiAgICAgICAgZXhwZWN0ZWRfbW9kZSA9IF9nZXRfbWFza2VkX21vZGUobW9kZSkKICAgICAgICBpZiBkaXJfZXhpc3RzOgogICAgICAgICAgICAjIFNfSVNHSUQgaXMgYXV0b21hdGljYWxseSBjb3BpZWQgYnkgdGhlIE9TIGZyb20gcGFyZW50IHRvIGNoaWxkCiAgICAgICAgICAgICMgZGlyZWN0b3JpZXMgb24gbWtkaXIuICBEb24ndCBjb25zaWRlciBpdCBiZWluZyBzZXQgdG8gYmUgYSBtb2RlCiAgICAgICAgICAgICMgbWlzbWF0Y2ggYXMgbWtkaXIgZG9lcyBub3QgdW5zZXQgaXQgd2hlbiBub3Qgc3BlY2lmaWVkIGluIG1vZGUuCiAgICAgICAgICAgIGFjdHVhbF9tb2RlID0gc3QuU19JTU9ERShsc3RhdChuYW1lKS5zdF9tb2RlKSAmIH5zdC5TX0lTR0lECiAgICAgICAgZWxzZToKICAgICAgICAgICAgYWN0dWFsX21vZGUgPSAtMQogICAgICAgIGlmIG5vdCAoZS5lcnJubyA9PSBlcnJuby5FRVhJU1QgYW5kIGV4aXN0X29rIGFuZCBkaXJfZXhpc3RzIGFuZAogICAgICAgICAgICAgICAgYWN0dWFsX21vZGUgPT0gZXhwZWN0ZWRfbW9kZSk6CiAgICAgICAgICAgIGlmIGRpcl9leGlzdHMgYW5kIGFjdHVhbF9tb2RlICE9IGV4cGVjdGVkX21vZGU6CiAgICAgICAgICAgICAgICBlLnN0cmVycm9yICs9ICcgKG1vZGUgJW8gIT0gZXhwZWN0ZWQgbW9kZSAlbyknICUgKAogICAgICAgICAgICAgICAgICAgICAgICBhY3R1YWxfbW9kZSwgZXhwZWN0ZWRfbW9kZSkKICAgICAgICAgICAgcmFpc2UKCmRlZiByZW1vdmVkaXJzKG5hbWUpOgogICAgIiIicmVtb3ZlZGlycyhwYXRoKQoKICAgIFN1cGVyLXJtZGlyOyByZW1vdmUgYSBsZWFmIGRpcmVjdG9yeSBhbmQgYWxsIGVtcHR5IGludGVybWVkaWF0ZQogICAgb25lcy4gIFdvcmtzIGxpa2Ugcm1kaXIgZXhjZXB0IHRoYXQsIGlmIHRoZSBsZWFmIGRpcmVjdG9yeSBpcwogICAgc3VjY2Vzc2Z1bGx5IHJlbW92ZWQsIGRpcmVjdG9yaWVzIGNvcnJlc3BvbmRpbmcgdG8gcmlnaHRtb3N0IHBhdGgKICAgIHNlZ21lbnRzIHdpbGwgYmUgcHJ1bmVkIGF3YXkgdW50aWwgZWl0aGVyIHRoZSB3aG9sZSBwYXRoIGlzCiAgICBjb25zdW1lZCBvciBhbiBlcnJvciBvY2N1cnMuICBFcnJvcnMgZHVyaW5nIHRoaXMgbGF0dGVyIHBoYXNlIGFyZQogICAgaWdub3JlZCAtLSB0aGV5IGdlbmVyYWxseSBtZWFuIHRoYXQgYSBkaXJlY3Rvcnkgd2FzIG5vdCBlbXB0eS4KCiAgICAiIiIKICAgIHJtZGlyKG5hbWUpCiAgICBoZWFkLCB0YWlsID0gcGF0aC5zcGxpdChuYW1lKQogICAgaWYgbm90IHRhaWw6CiAgICAgICAgaGVhZCwgdGFpbCA9IHBhdGguc3BsaXQoaGVhZCkKICAgIHdoaWxlIGhlYWQgYW5kIHRhaWw6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBybWRpcihoZWFkKQogICAgICAgIGV4Y2VwdCBlcnJvcjoKICAgICAgICAgICAgYnJlYWsKICAgICAgICBoZWFkLCB0YWlsID0gcGF0aC5zcGxpdChoZWFkKQoKZGVmIHJlbmFtZXMob2xkLCBuZXcpOgogICAgIiIicmVuYW1lcyhvbGQsIG5ldykKCiAgICBTdXBlci1yZW5hbWU7IGNyZWF0ZSBkaXJlY3RvcmllcyBhcyBuZWNlc3NhcnkgYW5kIGRlbGV0ZSBhbnkgbGVmdAogICAgZW1wdHkuICBXb3JrcyBsaWtlIHJlbmFtZSwgZXhjZXB0IGNyZWF0aW9uIG9mIGFueSBpbnRlcm1lZGlhdGUKICAgIGRpcmVjdG9yaWVzIG5lZWRlZCB0byBtYWtlIHRoZSBuZXcgcGF0aG5hbWUgZ29vZCBpcyBhdHRlbXB0ZWQKICAgIGZpcnN0LiAgQWZ0ZXIgdGhlIHJlbmFtZSwgZGlyZWN0b3JpZXMgY29ycmVzcG9uZGluZyB0byByaWdodG1vc3QKICAgIHBhdGggc2VnbWVudHMgb2YgdGhlIG9sZCBuYW1lIHdpbGwgYmUgcHJ1bmVkIHdheSB1bnRpbCBlaXRoZXIgdGhlCiAgICB3aG9sZSBwYXRoIGlzIGNvbnN1bWVkIG9yIGEgbm9uZW1wdHkgZGlyZWN0b3J5IGlzIGZvdW5kLgoKICAgIE5vdGU6IHRoaXMgZnVuY3Rpb24gY2FuIGZhaWwgd2l0aCB0aGUgbmV3IGRpcmVjdG9yeSBzdHJ1Y3R1cmUgbWFkZQogICAgaWYgeW91IGxhY2sgcGVybWlzc2lvbnMgbmVlZGVkIHRvIHVubGluayB0aGUgbGVhZiBkaXJlY3Rvcnkgb3IKICAgIGZpbGUuCgogICAgIiIiCiAgICBoZWFkLCB0YWlsID0gcGF0aC5zcGxpdChuZXcpCiAgICBpZiBoZWFkIGFuZCB0YWlsIGFuZCBub3QgcGF0aC5leGlzdHMoaGVhZCk6CiAgICAgICAgbWFrZWRpcnMoaGVhZCkKICAgIHJlbmFtZShvbGQsIG5ldykKICAgIGhlYWQsIHRhaWwgPSBwYXRoLnNwbGl0KG9sZCkKICAgIGlmIGhlYWQgYW5kIHRhaWw6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZW1vdmVkaXJzKGhlYWQpCiAgICAgICAgZXhjZXB0IGVycm9yOgogICAgICAgICAgICBwYXNzCgpfX2FsbF9fLmV4dGVuZChbIm1ha2VkaXJzIiwgInJlbW92ZWRpcnMiLCAicmVuYW1lcyJdKQoKZGVmIHdhbGsodG9wLCB0b3Bkb3duPVRydWUsIG9uZXJyb3I9Tm9uZSwgZm9sbG93bGlua3M9RmFsc2UpOgogICAgIiIiRGlyZWN0b3J5IHRyZWUgZ2VuZXJhdG9yLgoKICAgIEZvciBlYWNoIGRpcmVjdG9yeSBpbiB0aGUgZGlyZWN0b3J5IHRyZWUgcm9vdGVkIGF0IHRvcCAoaW5jbHVkaW5nIHRvcAogICAgaXRzZWxmLCBidXQgZXhjbHVkaW5nICcuJyBhbmQgJy4uJyksIHlpZWxkcyBhIDMtdHVwbGUKCiAgICAgICAgZGlycGF0aCwgZGlybmFtZXMsIGZpbGVuYW1lcwoKICAgIGRpcnBhdGggaXMgYSBzdHJpbmcsIHRoZSBwYXRoIHRvIHRoZSBkaXJlY3RvcnkuICBkaXJuYW1lcyBpcyBhIGxpc3Qgb2YKICAgIHRoZSBuYW1lcyBvZiB0aGUgc3ViZGlyZWN0b3JpZXMgaW4gZGlycGF0aCAoZXhjbHVkaW5nICcuJyBhbmQgJy4uJykuCiAgICBmaWxlbmFtZXMgaXMgYSBsaXN0IG9mIHRoZSBuYW1lcyBvZiB0aGUgbm9uLWRpcmVjdG9yeSBmaWxlcyBpbiBkaXJwYXRoLgogICAgTm90ZSB0aGF0IHRoZSBuYW1lcyBpbiB0aGUgbGlzdHMgYXJlIGp1c3QgbmFtZXMsIHdpdGggbm8gcGF0aCBjb21wb25lbnRzLgogICAgVG8gZ2V0IGEgZnVsbCBwYXRoICh3aGljaCBiZWdpbnMgd2l0aCB0b3ApIHRvIGEgZmlsZSBvciBkaXJlY3RvcnkgaW4KICAgIGRpcnBhdGgsIGRvIG9zLnBhdGguam9pbihkaXJwYXRoLCBuYW1lKS4KCiAgICBJZiBvcHRpb25hbCBhcmcgJ3RvcGRvd24nIGlzIHRydWUgb3Igbm90IHNwZWNpZmllZCwgdGhlIHRyaXBsZSBmb3IgYQogICAgZGlyZWN0b3J5IGlzIGdlbmVyYXRlZCBiZWZvcmUgdGhlIHRyaXBsZXMgZm9yIGFueSBvZiBpdHMgc3ViZGlyZWN0b3JpZXMKICAgIChkaXJlY3RvcmllcyBhcmUgZ2VuZXJhdGVkIHRvcCBkb3duKS4gIElmIHRvcGRvd24gaXMgZmFsc2UsIHRoZSB0cmlwbGUKICAgIGZvciBhIGRpcmVjdG9yeSBpcyBnZW5lcmF0ZWQgYWZ0ZXIgdGhlIHRyaXBsZXMgZm9yIGFsbCBvZiBpdHMKICAgIHN1YmRpcmVjdG9yaWVzIChkaXJlY3RvcmllcyBhcmUgZ2VuZXJhdGVkIGJvdHRvbSB1cCkuCgogICAgV2hlbiB0b3Bkb3duIGlzIHRydWUsIHRoZSBjYWxsZXIgY2FuIG1vZGlmeSB0aGUgZGlybmFtZXMgbGlzdCBpbi1wbGFjZQogICAgKGUuZy4sIHZpYSBkZWwgb3Igc2xpY2UgYXNzaWdubWVudCksIGFuZCB3YWxrIHdpbGwgb25seSByZWN1cnNlIGludG8gdGhlCiAgICBzdWJkaXJlY3RvcmllcyB3aG9zZSBuYW1lcyByZW1haW4gaW4gZGlybmFtZXM7IHRoaXMgY2FuIGJlIHVzZWQgdG8gcHJ1bmUKICAgIHRoZSBzZWFyY2gsIG9yIHRvIGltcG9zZSBhIHNwZWNpZmljIG9yZGVyIG9mIHZpc2l0aW5nLiAgTW9kaWZ5aW5nCiAgICBkaXJuYW1lcyB3aGVuIHRvcGRvd24gaXMgZmFsc2UgaXMgaW5lZmZlY3RpdmUsIHNpbmNlIHRoZSBkaXJlY3RvcmllcyBpbgogICAgZGlybmFtZXMgaGF2ZSBhbHJlYWR5IGJlZW4gZ2VuZXJhdGVkIGJ5IHRoZSB0aW1lIGRpcm5hbWVzIGl0c2VsZiBpcwogICAgZ2VuZXJhdGVkLgoKICAgIEJ5IGRlZmF1bHQgZXJyb3JzIGZyb20gdGhlIG9zLmxpc3RkaXIoKSBjYWxsIGFyZSBpZ25vcmVkLiAgSWYKICAgIG9wdGlvbmFsIGFyZyAnb25lcnJvcicgaXMgc3BlY2lmaWVkLCBpdCBzaG91bGQgYmUgYSBmdW5jdGlvbjsgaXQKICAgIHdpbGwgYmUgY2FsbGVkIHdpdGggb25lIGFyZ3VtZW50LCBhbiBvcy5lcnJvciBpbnN0YW5jZS4gIEl0IGNhbgogICAgcmVwb3J0IHRoZSBlcnJvciB0byBjb250aW51ZSB3aXRoIHRoZSB3YWxrLCBvciByYWlzZSB0aGUgZXhjZXB0aW9uCiAgICB0byBhYm9ydCB0aGUgd2Fsay4gIE5vdGUgdGhhdCB0aGUgZmlsZW5hbWUgaXMgYXZhaWxhYmxlIGFzIHRoZQogICAgZmlsZW5hbWUgYXR0cmlidXRlIG9mIHRoZSBleGNlcHRpb24gb2JqZWN0LgoKICAgIEJ5IGRlZmF1bHQsIG9zLndhbGsgZG9lcyBub3QgZm9sbG93IHN5bWJvbGljIGxpbmtzIHRvIHN1YmRpcmVjdG9yaWVzIG9uCiAgICBzeXN0ZW1zIHRoYXQgc3VwcG9ydCB0aGVtLiAgSW4gb3JkZXIgdG8gZ2V0IHRoaXMgZnVuY3Rpb25hbGl0eSwgc2V0IHRoZQogICAgb3B0aW9uYWwgYXJndW1lbnQgJ2ZvbGxvd2xpbmtzJyB0byB0cnVlLgoKICAgIENhdXRpb246ICBpZiB5b3UgcGFzcyBhIHJlbGF0aXZlIHBhdGhuYW1lIGZvciB0b3AsIGRvbid0IGNoYW5nZSB0aGUKICAgIGN1cnJlbnQgd29ya2luZyBkaXJlY3RvcnkgYmV0d2VlbiByZXN1bXB0aW9ucyBvZiB3YWxrLiAgd2FsayBuZXZlcgogICAgY2hhbmdlcyB0aGUgY3VycmVudCBkaXJlY3RvcnksIGFuZCBhc3N1bWVzIHRoYXQgdGhlIGNsaWVudCBkb2Vzbid0CiAgICBlaXRoZXIuCgogICAgRXhhbXBsZToKCiAgICBpbXBvcnQgb3MKICAgIGZyb20gb3MucGF0aCBpbXBvcnQgam9pbiwgZ2V0c2l6ZQogICAgZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoJ3B5dGhvbi9MaWIvZW1haWwnKToKICAgICAgICBwcmludChyb290LCAiY29uc3VtZXMiLCBlbmQ9IiIpCiAgICAgICAgcHJpbnQoc3VtKFtnZXRzaXplKGpvaW4ocm9vdCwgbmFtZSkpIGZvciBuYW1lIGluIGZpbGVzXSksIGVuZD0iIikKICAgICAgICBwcmludCgiYnl0ZXMgaW4iLCBsZW4oZmlsZXMpLCAibm9uLWRpcmVjdG9yeSBmaWxlcyIpCiAgICAgICAgaWYgJ0NWUycgaW4gZGlyczoKICAgICAgICAgICAgZGlycy5yZW1vdmUoJ0NWUycpICAjIGRvbid0IHZpc2l0IENWUyBkaXJlY3RvcmllcwogICAgIiIiCgogICAgaXNsaW5rLCBqb2luLCBpc2RpciA9IHBhdGguaXNsaW5rLCBwYXRoLmpvaW4sIHBhdGguaXNkaXIKCiAgICAjIFdlIG1heSBub3QgaGF2ZSByZWFkIHBlcm1pc3Npb24gZm9yIHRvcCwgaW4gd2hpY2ggY2FzZSB3ZSBjYW4ndAogICAgIyBnZXQgYSBsaXN0IG9mIHRoZSBmaWxlcyB0aGUgZGlyZWN0b3J5IGNvbnRhaW5zLiAgb3Mud2FsawogICAgIyBhbHdheXMgc3VwcHJlc3NlZCB0aGUgZXhjZXB0aW9uIHRoZW4sIHJhdGhlciB0aGFuIGJsb3cgdXAgZm9yIGEKICAgICMgbWlub3IgcmVhc29uIHdoZW4gKHNheSkgYSB0aG91c2FuZCByZWFkYWJsZSBkaXJlY3RvcmllcyBhcmUgc3RpbGwKICAgICMgbGVmdCB0byB2aXNpdC4gIFRoYXQgbG9naWMgaXMgY29waWVkIGhlcmUuCiAgICB0cnk6CiAgICAgICAgIyBOb3RlIHRoYXQgbGlzdGRpciBhbmQgZXJyb3IgYXJlIGdsb2JhbHMgaW4gdGhpcyBtb2R1bGUgZHVlCiAgICAgICAgIyB0byBlYXJsaWVyIGltcG9ydC0qLgogICAgICAgIG5hbWVzID0gbGlzdGRpcih0b3ApCiAgICBleGNlcHQgZXJyb3IgYXMgZXJyOgogICAgICAgIGlmIG9uZXJyb3IgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIG9uZXJyb3IoZXJyKQogICAgICAgIHJldHVybgoKICAgIGRpcnMsIG5vbmRpcnMgPSBbXSwgW10KICAgIGZvciBuYW1lIGluIG5hbWVzOgogICAgICAgIGlmIGlzZGlyKGpvaW4odG9wLCBuYW1lKSk6CiAgICAgICAgICAgIGRpcnMuYXBwZW5kKG5hbWUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbm9uZGlycy5hcHBlbmQobmFtZSkKCiAgICBpZiB0b3Bkb3duOgogICAgICAgIHlpZWxkIHRvcCwgZGlycywgbm9uZGlycwogICAgZm9yIG5hbWUgaW4gZGlyczoKICAgICAgICBuZXdfcGF0aCA9IGpvaW4odG9wLCBuYW1lKQogICAgICAgIGlmIGZvbGxvd2xpbmtzIG9yIG5vdCBpc2xpbmsobmV3X3BhdGgpOgogICAgICAgICAgICB5aWVsZCBmcm9tIHdhbGsobmV3X3BhdGgsIHRvcGRvd24sIG9uZXJyb3IsIGZvbGxvd2xpbmtzKQogICAgaWYgbm90IHRvcGRvd246CiAgICAgICAgeWllbGQgdG9wLCBkaXJzLCBub25kaXJzCgpfX2FsbF9fLmFwcGVuZCgid2FsayIpCgppZiB7b3Blbiwgc3RhdH0gPD0gc3VwcG9ydHNfZGlyX2ZkIGFuZCB7bGlzdGRpciwgc3RhdH0gPD0gc3VwcG9ydHNfZmQ6CgogICAgZGVmIGZ3YWxrKHRvcD0iLiIsIHRvcGRvd249VHJ1ZSwgb25lcnJvcj1Ob25lLCAqLCBmb2xsb3dfc3ltbGlua3M9RmFsc2UsIGRpcl9mZD1Ob25lKToKICAgICAgICAiIiJEaXJlY3RvcnkgdHJlZSBnZW5lcmF0b3IuCgogICAgICAgIFRoaXMgYmVoYXZlcyBleGFjdGx5IGxpa2Ugd2FsaygpLCBleGNlcHQgdGhhdCBpdCB5aWVsZHMgYSA0LXR1cGxlCgogICAgICAgICAgICBkaXJwYXRoLCBkaXJuYW1lcywgZmlsZW5hbWVzLCBkaXJmZAoKICAgICAgICBgZGlycGF0aGAsIGBkaXJuYW1lc2AgYW5kIGBmaWxlbmFtZXNgIGFyZSBpZGVudGljYWwgdG8gd2FsaygpIG91dHB1dCwKICAgICAgICBhbmQgYGRpcmZkYCBpcyBhIGZpbGUgZGVzY3JpcHRvciByZWZlcnJpbmcgdG8gdGhlIGRpcmVjdG9yeSBgZGlycGF0aGAuCgogICAgICAgIFRoZSBhZHZhbnRhZ2Ugb2YgZndhbGsoKSBvdmVyIHdhbGsoKSBpcyB0aGF0IGl0J3Mgc2FmZSBhZ2FpbnN0IHN5bWxpbmsKICAgICAgICByYWNlcyAod2hlbiBmb2xsb3dfc3ltbGlua3MgaXMgRmFsc2UpLgoKICAgICAgICBJZiBkaXJfZmQgaXMgbm90IE5vbmUsIGl0IHNob3VsZCBiZSBhIGZpbGUgZGVzY3JpcHRvciBvcGVuIHRvIGEgZGlyZWN0b3J5LAogICAgICAgICAgYW5kIHRvcCBzaG91bGQgYmUgcmVsYXRpdmU7IHRvcCB3aWxsIHRoZW4gYmUgcmVsYXRpdmUgdG8gdGhhdCBkaXJlY3RvcnkuCiAgICAgICAgICAoZGlyX2ZkIGlzIGFsd2F5cyBzdXBwb3J0ZWQgZm9yIGZ3YWxrLikKCiAgICAgICAgQ2F1dGlvbjoKICAgICAgICBTaW5jZSBmd2FsaygpIHlpZWxkcyBmaWxlIGRlc2NyaXB0b3JzLCB0aG9zZSBhcmUgb25seSB2YWxpZCB1bnRpbCB0aGUKICAgICAgICBuZXh0IGl0ZXJhdGlvbiBzdGVwLCBzbyB5b3Ugc2hvdWxkIGR1cCgpIHRoZW0gaWYgeW91IHdhbnQgdG8ga2VlcCB0aGVtCiAgICAgICAgZm9yIGEgbG9uZ2VyIHBlcmlvZC4KCiAgICAgICAgRXhhbXBsZToKCiAgICAgICAgaW1wb3J0IG9zCiAgICAgICAgZm9yIHJvb3QsIGRpcnMsIGZpbGVzLCByb290ZmQgaW4gb3MuZndhbGsoJ3B5dGhvbi9MaWIvZW1haWwnKToKICAgICAgICAgICAgcHJpbnQocm9vdCwgImNvbnN1bWVzIiwgZW5kPSIiKQogICAgICAgICAgICBwcmludChzdW0oW29zLnN0YXQobmFtZSwgZGlyX2ZkPXJvb3RmZCkuc3Rfc2l6ZSBmb3IgbmFtZSBpbiBmaWxlc10pLAogICAgICAgICAgICAgICAgICBlbmQ9IiIpCiAgICAgICAgICAgIHByaW50KCJieXRlcyBpbiIsIGxlbihmaWxlcyksICJub24tZGlyZWN0b3J5IGZpbGVzIikKICAgICAgICAgICAgaWYgJ0NWUycgaW4gZGlyczoKICAgICAgICAgICAgICAgIGRpcnMucmVtb3ZlKCdDVlMnKSAgIyBkb24ndCB2aXNpdCBDVlMgZGlyZWN0b3JpZXMKICAgICAgICAiIiIKICAgICAgICAjIE5vdGU6IFRvIGd1YXJkIGFnYWluc3Qgc3ltbGluayByYWNlcywgd2UgdXNlIHRoZSBzdGFuZGFyZAogICAgICAgICMgbHN0YXQoKS9vcGVuKCkvZnN0YXQoKSB0cmljay4KICAgICAgICBvcmlnX3N0ID0gc3RhdCh0b3AsIGZvbGxvd19zeW1saW5rcz1GYWxzZSwgZGlyX2ZkPWRpcl9mZCkKICAgICAgICB0b3BmZCA9IG9wZW4odG9wLCBPX1JET05MWSwgZGlyX2ZkPWRpcl9mZCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIGlmIChmb2xsb3dfc3ltbGlua3Mgb3IgKHN0LlNfSVNESVIob3JpZ19zdC5zdF9tb2RlKSBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aC5zYW1lc3RhdChvcmlnX3N0LCBzdGF0KHRvcGZkKSkpKToKICAgICAgICAgICAgICAgIHlpZWxkIGZyb20gX2Z3YWxrKHRvcGZkLCB0b3AsIHRvcGRvd24sIG9uZXJyb3IsIGZvbGxvd19zeW1saW5rcykKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBjbG9zZSh0b3BmZCkKCiAgICBkZWYgX2Z3YWxrKHRvcGZkLCB0b3BwYXRoLCB0b3Bkb3duLCBvbmVycm9yLCBmb2xsb3dfc3ltbGlua3MpOgogICAgICAgICMgTm90ZTogVGhpcyB1c2VzIE8oZGVwdGggb2YgdGhlIGRpcmVjdG9yeSB0cmVlKSBmaWxlIGRlc2NyaXB0b3JzOiBpZgogICAgICAgICMgbmVjZXNzYXJ5LCBpdCBjYW4gYmUgYWRhcHRlZCB0byBvbmx5IHJlcXVpcmUgTygxKSBGRHMsIHNlZSBpc3N1ZQogICAgICAgICMgIzEzNzM0LgoKICAgICAgICBuYW1lcyA9IGxpc3RkaXIodG9wZmQpCiAgICAgICAgZGlycywgbm9uZGlycyA9IFtdLCBbXQogICAgICAgIGZvciBuYW1lIGluIG5hbWVzOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAjIEhlcmUsIHdlIGRvbid0IHVzZSBBVF9TWU1MSU5LX05PRk9MTE9XIHRvIGJlIGNvbnNpc3RlbnQgd2l0aAogICAgICAgICAgICAgICAgIyB3YWxrKCkgd2hpY2ggcmVwb3J0cyBzeW1saW5rcyB0byBkaXJlY3RvcmllcyBhcyBkaXJlY3Rvcmllcy4KICAgICAgICAgICAgICAgICMgV2UgZG8gaG93ZXZlciBjaGVjayBmb3Igc3ltbGlua3MgYmVmb3JlIHJlY3Vyc2luZyBpbnRvCiAgICAgICAgICAgICAgICAjIGEgc3ViZGlyZWN0b3J5LgogICAgICAgICAgICAgICAgaWYgc3QuU19JU0RJUihzdGF0KG5hbWUsIGRpcl9mZD10b3BmZCkuc3RfbW9kZSk6CiAgICAgICAgICAgICAgICAgICAgZGlycy5hcHBlbmQobmFtZSkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgbm9uZGlycy5hcHBlbmQobmFtZSkKICAgICAgICAgICAgZXhjZXB0IEZpbGVOb3RGb3VuZEVycm9yOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICMgQWRkIGRhbmdsaW5nIHN5bWxpbmtzLCBpZ25vcmUgZGlzYXBwZWFyZWQgZmlsZXMKICAgICAgICAgICAgICAgICAgICBpZiBzdC5TX0lTTE5LKHN0YXQobmFtZSwgZGlyX2ZkPXRvcGZkLCBmb2xsb3dfc3ltbGlua3M9RmFsc2UpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN0X21vZGUpOgogICAgICAgICAgICAgICAgICAgICAgICBub25kaXJzLmFwcGVuZChuYW1lKQogICAgICAgICAgICAgICAgZXhjZXB0IEZpbGVOb3RGb3VuZEVycm9yOgogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgIGlmIHRvcGRvd246CiAgICAgICAgICAgIHlpZWxkIHRvcHBhdGgsIGRpcnMsIG5vbmRpcnMsIHRvcGZkCgogICAgICAgIGZvciBuYW1lIGluIGRpcnM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIG9yaWdfc3QgPSBzdGF0KG5hbWUsIGRpcl9mZD10b3BmZCwgZm9sbG93X3N5bWxpbmtzPWZvbGxvd19zeW1saW5rcykKICAgICAgICAgICAgICAgIGRpcmZkID0gb3BlbihuYW1lLCBPX1JET05MWSwgZGlyX2ZkPXRvcGZkKQogICAgICAgICAgICBleGNlcHQgZXJyb3IgYXMgZXJyOgogICAgICAgICAgICAgICAgaWYgb25lcnJvciBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICBvbmVycm9yKGVycikKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpZiBmb2xsb3dfc3ltbGlua3Mgb3IgcGF0aC5zYW1lc3RhdChvcmlnX3N0LCBzdGF0KGRpcmZkKSk6CiAgICAgICAgICAgICAgICAgICAgZGlycGF0aCA9IHBhdGguam9pbih0b3BwYXRoLCBuYW1lKQogICAgICAgICAgICAgICAgICAgIHlpZWxkIGZyb20gX2Z3YWxrKGRpcmZkLCBkaXJwYXRoLCB0b3Bkb3duLCBvbmVycm9yLCBmb2xsb3dfc3ltbGlua3MpCiAgICAgICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgICAgICBjbG9zZShkaXJmZCkKCiAgICAgICAgaWYgbm90IHRvcGRvd246CiAgICAgICAgICAgIHlpZWxkIHRvcHBhdGgsIGRpcnMsIG5vbmRpcnMsIHRvcGZkCgogICAgX19hbGxfXy5hcHBlbmQoImZ3YWxrIikKCiMgTWFrZSBzdXJlIG9zLmVudmlyb24gZXhpc3RzLCBhdCBsZWFzdAp0cnk6CiAgICBlbnZpcm9uCmV4Y2VwdCBOYW1lRXJyb3I6CiAgICBlbnZpcm9uID0ge30KCmRlZiBleGVjbChmaWxlLCAqYXJncyk6CiAgICAiIiJleGVjbChmaWxlLCAqYXJncykKCiAgICBFeGVjdXRlIHRoZSBleGVjdXRhYmxlIGZpbGUgd2l0aCBhcmd1bWVudCBsaXN0IGFyZ3MsIHJlcGxhY2luZyB0aGUKICAgIGN1cnJlbnQgcHJvY2Vzcy4gIiIiCiAgICBleGVjdihmaWxlLCBhcmdzKQoKZGVmIGV4ZWNsZShmaWxlLCAqYXJncyk6CiAgICAiIiJleGVjbGUoZmlsZSwgKmFyZ3MsIGVudikKCiAgICBFeGVjdXRlIHRoZSBleGVjdXRhYmxlIGZpbGUgd2l0aCBhcmd1bWVudCBsaXN0IGFyZ3MgYW5kCiAgICBlbnZpcm9ubWVudCBlbnYsIHJlcGxhY2luZyB0aGUgY3VycmVudCBwcm9jZXNzLiAiIiIKICAgIGVudiA9IGFyZ3NbLTFdCiAgICBleGVjdmUoZmlsZSwgYXJnc1s6LTFdLCBlbnYpCgpkZWYgZXhlY2xwKGZpbGUsICphcmdzKToKICAgICIiImV4ZWNscChmaWxlLCAqYXJncykKCiAgICBFeGVjdXRlIHRoZSBleGVjdXRhYmxlIGZpbGUgKHdoaWNoIGlzIHNlYXJjaGVkIGZvciBhbG9uZyAkUEFUSCkKICAgIHdpdGggYXJndW1lbnQgbGlzdCBhcmdzLCByZXBsYWNpbmcgdGhlIGN1cnJlbnQgcHJvY2Vzcy4gIiIiCiAgICBleGVjdnAoZmlsZSwgYXJncykKCmRlZiBleGVjbHBlKGZpbGUsICphcmdzKToKICAgICIiImV4ZWNscGUoZmlsZSwgKmFyZ3MsIGVudikKCiAgICBFeGVjdXRlIHRoZSBleGVjdXRhYmxlIGZpbGUgKHdoaWNoIGlzIHNlYXJjaGVkIGZvciBhbG9uZyAkUEFUSCkKICAgIHdpdGggYXJndW1lbnQgbGlzdCBhcmdzIGFuZCBlbnZpcm9ubWVudCBlbnYsIHJlcGxhY2luZyB0aGUgY3VycmVudAogICAgcHJvY2Vzcy4gIiIiCiAgICBlbnYgPSBhcmdzWy0xXQogICAgZXhlY3ZwZShmaWxlLCBhcmdzWzotMV0sIGVudikKCmRlZiBleGVjdnAoZmlsZSwgYXJncyk6CiAgICAiIiJleGVjdnAoZmlsZSwgYXJncykKCiAgICBFeGVjdXRlIHRoZSBleGVjdXRhYmxlIGZpbGUgKHdoaWNoIGlzIHNlYXJjaGVkIGZvciBhbG9uZyAkUEFUSCkKICAgIHdpdGggYXJndW1lbnQgbGlzdCBhcmdzLCByZXBsYWNpbmcgdGhlIGN1cnJlbnQgcHJvY2Vzcy4KICAgIGFyZ3MgbWF5IGJlIGEgbGlzdCBvciB0dXBsZSBvZiBzdHJpbmdzLiAiIiIKICAgIF9leGVjdnBlKGZpbGUsIGFyZ3MpCgpkZWYgZXhlY3ZwZShmaWxlLCBhcmdzLCBlbnYpOgogICAgIiIiZXhlY3ZwZShmaWxlLCBhcmdzLCBlbnYpCgogICAgRXhlY3V0ZSB0aGUgZXhlY3V0YWJsZSBmaWxlICh3aGljaCBpcyBzZWFyY2hlZCBmb3IgYWxvbmcgJFBBVEgpCiAgICB3aXRoIGFyZ3VtZW50IGxpc3QgYXJncyBhbmQgZW52aXJvbm1lbnQgZW52ICwgcmVwbGFjaW5nIHRoZQogICAgY3VycmVudCBwcm9jZXNzLgogICAgYXJncyBtYXkgYmUgYSBsaXN0IG9yIHR1cGxlIG9mIHN0cmluZ3MuICIiIgogICAgX2V4ZWN2cGUoZmlsZSwgYXJncywgZW52KQoKX19hbGxfXy5leHRlbmQoWyJleGVjbCIsImV4ZWNsZSIsImV4ZWNscCIsImV4ZWNscGUiLCJleGVjdnAiLCJleGVjdnBlIl0pCgpkZWYgX2V4ZWN2cGUoZmlsZSwgYXJncywgZW52PU5vbmUpOgogICAgaWYgZW52IGlzIG5vdCBOb25lOgogICAgICAgIGV4ZWNfZnVuYyA9IGV4ZWN2ZQogICAgICAgIGFyZ3Jlc3QgPSAoYXJncywgZW52KQogICAgZWxzZToKICAgICAgICBleGVjX2Z1bmMgPSBleGVjdgogICAgICAgIGFyZ3Jlc3QgPSAoYXJncywpCiAgICAgICAgZW52ID0gZW52aXJvbgoKICAgIGhlYWQsIHRhaWwgPSBwYXRoLnNwbGl0KGZpbGUpCiAgICBpZiBoZWFkOgogICAgICAgIGV4ZWNfZnVuYyhmaWxlLCAqYXJncmVzdCkKICAgICAgICByZXR1cm4KICAgIGxhc3RfZXhjID0gc2F2ZWRfZXhjID0gTm9uZQogICAgc2F2ZWRfdGIgPSBOb25lCiAgICBwYXRoX2xpc3QgPSBnZXRfZXhlY19wYXRoKGVudikKICAgIGlmIG5hbWUgIT0gJ250JzoKICAgICAgICBmaWxlID0gZnNlbmNvZGUoZmlsZSkKICAgICAgICBwYXRoX2xpc3QgPSBtYXAoZnNlbmNvZGUsIHBhdGhfbGlzdCkKICAgIGZvciBkaXIgaW4gcGF0aF9saXN0OgogICAgICAgIGZ1bGxuYW1lID0gcGF0aC5qb2luKGRpciwgZmlsZSkKICAgICAgICB0cnk6CiAgICAgICAgICAgIGV4ZWNfZnVuYyhmdWxsbmFtZSwgKmFyZ3Jlc3QpCiAgICAgICAgZXhjZXB0IGVycm9yIGFzIGU6CiAgICAgICAgICAgIGxhc3RfZXhjID0gZQogICAgICAgICAgICB0YiA9IHN5cy5leGNfaW5mbygpWzJdCiAgICAgICAgICAgIGlmIChlLmVycm5vICE9IGVycm5vLkVOT0VOVCBhbmQgZS5lcnJubyAhPSBlcnJuby5FTk9URElSCiAgICAgICAgICAgICAgICBhbmQgc2F2ZWRfZXhjIGlzIE5vbmUpOgogICAgICAgICAgICAgICAgc2F2ZWRfZXhjID0gZQogICAgICAgICAgICAgICAgc2F2ZWRfdGIgPSB0YgogICAgaWYgc2F2ZWRfZXhjOgogICAgICAgIHJhaXNlIHNhdmVkX2V4Yy53aXRoX3RyYWNlYmFjayhzYXZlZF90YikKICAgIHJhaXNlIGxhc3RfZXhjLndpdGhfdHJhY2ViYWNrKHRiKQoKCmRlZiBnZXRfZXhlY19wYXRoKGVudj1Ob25lKToKICAgICIiIlJldHVybnMgdGhlIHNlcXVlbmNlIG9mIGRpcmVjdG9yaWVzIHRoYXQgd2lsbCBiZSBzZWFyY2hlZCBmb3IgdGhlCiAgICBuYW1lZCBleGVjdXRhYmxlIChzaW1pbGFyIHRvIGEgc2hlbGwpIHdoZW4gbGF1bmNoaW5nIGEgcHJvY2Vzcy4KCiAgICAqZW52KiBtdXN0IGJlIGFuIGVudmlyb25tZW50IHZhcmlhYmxlIGRpY3Qgb3IgTm9uZS4gIElmICplbnYqIGlzIE5vbmUsCiAgICBvcy5lbnZpcm9uIHdpbGwgYmUgdXNlZC4KICAgICIiIgogICAgIyBVc2UgYSBsb2NhbCBpbXBvcnQgaW5zdGVhZCBvZiBhIGdsb2JhbCBpbXBvcnQgdG8gbGltaXQgdGhlIG51bWJlciBvZgogICAgIyBtb2R1bGVzIGxvYWRlZCBhdCBzdGFydHVwOiB0aGUgb3MgbW9kdWxlIGlzIGFsd2F5cyBsb2FkZWQgYXQgc3RhcnR1cCBieQogICAgIyBQeXRob24uIEl0IG1heSBhbHNvIGF2b2lkIGEgYm9vdHN0cmFwIGlzc3VlLgogICAgaW1wb3J0IHdhcm5pbmdzCgogICAgaWYgZW52IGlzIE5vbmU6CiAgICAgICAgZW52ID0gZW52aXJvbgoKICAgICMge2InUEFUSCc6IC4uLn0uZ2V0KCdQQVRIJykgYW5kIHsnUEFUSCc6IC4uLn0uZ2V0KGInUEFUSCcpIGVtaXQgYQogICAgIyBCeXRlc1dhcm5pbmcgd2hlbiB1c2luZyBweXRob24gLWIgb3IgcHl0aG9uIC1iYjogaWdub3JlIHRoZSB3YXJuaW5nCiAgICB3aXRoIHdhcm5pbmdzLmNhdGNoX3dhcm5pbmdzKCk6CiAgICAgICAgd2FybmluZ3Muc2ltcGxlZmlsdGVyKCJpZ25vcmUiLCBCeXRlc1dhcm5pbmcpCgogICAgICAgIHRyeToKICAgICAgICAgICAgcGF0aF9saXN0ID0gZW52LmdldCgnUEFUSCcpCiAgICAgICAgZXhjZXB0IFR5cGVFcnJvcjoKICAgICAgICAgICAgcGF0aF9saXN0ID0gTm9uZQoKICAgICAgICBpZiBzdXBwb3J0c19ieXRlc19lbnZpcm9uOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBwYXRoX2xpc3RiID0gZW52W2InUEFUSCddCiAgICAgICAgICAgIGV4Y2VwdCAoS2V5RXJyb3IsIFR5cGVFcnJvcik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpZiBwYXRoX2xpc3QgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgICAgICAgICAgICAgImVudiBjYW5ub3QgY29udGFpbiAnUEFUSCcgYW5kIGInUEFUSCcga2V5cyIpCiAgICAgICAgICAgICAgICBwYXRoX2xpc3QgPSBwYXRoX2xpc3RiCgogICAgICAgICAgICBpZiBwYXRoX2xpc3QgaXMgbm90IE5vbmUgYW5kIGlzaW5zdGFuY2UocGF0aF9saXN0LCBieXRlcyk6CiAgICAgICAgICAgICAgICBwYXRoX2xpc3QgPSBmc2RlY29kZShwYXRoX2xpc3QpCgogICAgaWYgcGF0aF9saXN0IGlzIE5vbmU6CiAgICAgICAgcGF0aF9saXN0ID0gZGVmcGF0aAogICAgcmV0dXJuIHBhdGhfbGlzdC5zcGxpdChwYXRoc2VwKQoKCiMgQ2hhbmdlIGVudmlyb24gdG8gYXV0b21hdGljYWxseSBjYWxsIHB1dGVudigpLCB1bnNldGVudiBpZiB0aGV5IGV4aXN0Lgpmcm9tIGNvbGxlY3Rpb25zLmFiYyBpbXBvcnQgTXV0YWJsZU1hcHBpbmcKCmNsYXNzIF9FbnZpcm9uKE11dGFibGVNYXBwaW5nKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBkYXRhLCBlbmNvZGVrZXksIGRlY29kZWtleSwgZW5jb2RldmFsdWUsIGRlY29kZXZhbHVlLCBwdXRlbnYsIHVuc2V0ZW52KToKICAgICAgICBzZWxmLmVuY29kZWtleSA9IGVuY29kZWtleQogICAgICAgIHNlbGYuZGVjb2Rla2V5ID0gZGVjb2Rla2V5CiAgICAgICAgc2VsZi5lbmNvZGV2YWx1ZSA9IGVuY29kZXZhbHVlCiAgICAgICAgc2VsZi5kZWNvZGV2YWx1ZSA9IGRlY29kZXZhbHVlCiAgICAgICAgc2VsZi5wdXRlbnYgPSBwdXRlbnYKICAgICAgICBzZWxmLnVuc2V0ZW52ID0gdW5zZXRlbnYKICAgICAgICBzZWxmLl9kYXRhID0gZGF0YQoKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBrZXkpOgogICAgICAgIHZhbHVlID0gc2VsZi5fZGF0YVtzZWxmLmVuY29kZWtleShrZXkpXQogICAgICAgIHJldHVybiBzZWxmLmRlY29kZXZhbHVlKHZhbHVlKQoKICAgIGRlZiBfX3NldGl0ZW1fXyhzZWxmLCBrZXksIHZhbHVlKToKICAgICAgICBrZXkgPSBzZWxmLmVuY29kZWtleShrZXkpCiAgICAgICAgdmFsdWUgPSBzZWxmLmVuY29kZXZhbHVlKHZhbHVlKQogICAgICAgIHNlbGYucHV0ZW52KGtleSwgdmFsdWUpCiAgICAgICAgc2VsZi5fZGF0YVtrZXldID0gdmFsdWUKCiAgICBkZWYgX19kZWxpdGVtX18oc2VsZiwga2V5KToKICAgICAgICBrZXkgPSBzZWxmLmVuY29kZWtleShrZXkpCiAgICAgICAgc2VsZi51bnNldGVudihrZXkpCiAgICAgICAgZGVsIHNlbGYuX2RhdGFba2V5XQoKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICBmb3Iga2V5IGluIHNlbGYuX2RhdGE6CiAgICAgICAgICAgIHlpZWxkIHNlbGYuZGVjb2Rla2V5KGtleSkKCiAgICBkZWYgX19sZW5fXyhzZWxmKToKICAgICAgICByZXR1cm4gbGVuKHNlbGYuX2RhdGEpCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiAnZW52aXJvbih7e3t9fX0pJy5mb3JtYXQoJywgJy5qb2luKAogICAgICAgICAgICAoJ3shcn06IHshcn0nLmZvcm1hdChzZWxmLmRlY29kZWtleShrZXkpLCBzZWxmLmRlY29kZXZhbHVlKHZhbHVlKSkKICAgICAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gc2VsZi5fZGF0YS5pdGVtcygpKSkpCgogICAgZGVmIGNvcHkoc2VsZik6CiAgICAgICAgcmV0dXJuIGRpY3Qoc2VsZikKCiAgICBkZWYgc2V0ZGVmYXVsdChzZWxmLCBrZXksIHZhbHVlKToKICAgICAgICBpZiBrZXkgbm90IGluIHNlbGY6CiAgICAgICAgICAgIHNlbGZba2V5XSA9IHZhbHVlCiAgICAgICAgcmV0dXJuIHNlbGZba2V5XQoKdHJ5OgogICAgX3B1dGVudiA9IHB1dGVudgpleGNlcHQgTmFtZUVycm9yOgogICAgX3B1dGVudiA9IGxhbWJkYSBrZXksIHZhbHVlOiBOb25lCmVsc2U6CiAgICBfX2FsbF9fLmFwcGVuZCgicHV0ZW52IikKCnRyeToKICAgIF91bnNldGVudiA9IHVuc2V0ZW52CmV4Y2VwdCBOYW1lRXJyb3I6CiAgICBfdW5zZXRlbnYgPSBsYW1iZGEga2V5OiBfcHV0ZW52KGtleSwgIiIpCmVsc2U6CiAgICBfX2FsbF9fLmFwcGVuZCgidW5zZXRlbnYiKQoKZGVmIF9jcmVhdGVlbnZpcm9uKCk6CiAgICBpZiBuYW1lIGluICgnb3MyJywgJ250Jyk6CiAgICAgICAgIyBXaGVyZSBFbnYgVmFyIE5hbWVzIE11c3QgQmUgVVBQRVJDQVNFCiAgICAgICAgZGVmIGNoZWNrX3N0cih2YWx1ZSk6CiAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHZhbHVlLCBzdHIpOgogICAgICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJzdHIgZXhwZWN0ZWQsIG5vdCAlcyIgJSB0eXBlKHZhbHVlKS5fX25hbWVfXykKICAgICAgICAgICAgcmV0dXJuIHZhbHVlCiAgICAgICAgZW5jb2RlID0gY2hlY2tfc3RyCiAgICAgICAgZGVjb2RlID0gc3RyCiAgICAgICAgZGVmIGVuY29kZWtleShrZXkpOgogICAgICAgICAgICByZXR1cm4gZW5jb2RlKGtleSkudXBwZXIoKQogICAgICAgIGRhdGEgPSB7fQogICAgICAgIGZvciBrZXksIHZhbHVlIGluIGVudmlyb24uaXRlbXMoKToKICAgICAgICAgICAgZGF0YVtlbmNvZGVrZXkoa2V5KV0gPSB2YWx1ZQogICAgZWxzZToKICAgICAgICAjIFdoZXJlIEVudiBWYXIgTmFtZXMgQ2FuIEJlIE1peGVkIENhc2UKICAgICAgICBlbmNvZGluZyA9IHN5cy5nZXRmaWxlc3lzdGVtZW5jb2RpbmcoKQogICAgICAgIGRlZiBlbmNvZGUodmFsdWUpOgogICAgICAgICAgICBpZiBub3QgaXNpbnN0YW5jZSh2YWx1ZSwgc3RyKToKICAgICAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigic3RyIGV4cGVjdGVkLCBub3QgJXMiICUgdHlwZSh2YWx1ZSkuX19uYW1lX18pCiAgICAgICAgICAgIHJldHVybiB2YWx1ZS5lbmNvZGUoZW5jb2RpbmcsICdzdXJyb2dhdGVlc2NhcGUnKQogICAgICAgIGRlZiBkZWNvZGUodmFsdWUpOgogICAgICAgICAgICByZXR1cm4gdmFsdWUuZGVjb2RlKGVuY29kaW5nLCAnc3Vycm9nYXRlZXNjYXBlJykKICAgICAgICBlbmNvZGVrZXkgPSBlbmNvZGUKICAgICAgICBkYXRhID0gZW52aXJvbgogICAgcmV0dXJuIF9FbnZpcm9uKGRhdGEsCiAgICAgICAgZW5jb2Rla2V5LCBkZWNvZGUsCiAgICAgICAgZW5jb2RlLCBkZWNvZGUsCiAgICAgICAgX3B1dGVudiwgX3Vuc2V0ZW52KQoKIyB1bmljb2RlIGVudmlyb24KZW52aXJvbiA9IF9jcmVhdGVlbnZpcm9uKCkKZGVsIF9jcmVhdGVlbnZpcm9uCgoKZGVmIGdldGVudihrZXksIGRlZmF1bHQ9Tm9uZSk6CiAgICAiIiJHZXQgYW4gZW52aXJvbm1lbnQgdmFyaWFibGUsIHJldHVybiBOb25lIGlmIGl0IGRvZXNuJ3QgZXhpc3QuCiAgICBUaGUgb3B0aW9uYWwgc2Vjb25kIGFyZ3VtZW50IGNhbiBzcGVjaWZ5IGFuIGFsdGVybmF0ZSBkZWZhdWx0LgogICAga2V5LCBkZWZhdWx0IGFuZCB0aGUgcmVzdWx0IGFyZSBzdHIuIiIiCiAgICByZXR1cm4gZW52aXJvbi5nZXQoa2V5LCBkZWZhdWx0KQoKc3VwcG9ydHNfYnl0ZXNfZW52aXJvbiA9IG5hbWUgbm90IGluICgnb3MyJywgJ250JykKX19hbGxfXy5leHRlbmQoKCJnZXRlbnYiLCAic3VwcG9ydHNfYnl0ZXNfZW52aXJvbiIpKQoKaWYgc3VwcG9ydHNfYnl0ZXNfZW52aXJvbjoKICAgIGRlZiBfY2hlY2tfYnl0ZXModmFsdWUpOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHZhbHVlLCBieXRlcyk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiYnl0ZXMgZXhwZWN0ZWQsIG5vdCAlcyIgJSB0eXBlKHZhbHVlKS5fX25hbWVfXykKICAgICAgICByZXR1cm4gdmFsdWUKCiAgICAjIGJ5dGVzIGVudmlyb24KICAgIGVudmlyb25iID0gX0Vudmlyb24oZW52aXJvbi5fZGF0YSwKICAgICAgICBfY2hlY2tfYnl0ZXMsIGJ5dGVzLAogICAgICAgIF9jaGVja19ieXRlcywgYnl0ZXMsCiAgICAgICAgX3B1dGVudiwgX3Vuc2V0ZW52KQogICAgZGVsIF9jaGVja19ieXRlcwoKICAgIGRlZiBnZXRlbnZiKGtleSwgZGVmYXVsdD1Ob25lKToKICAgICAgICAiIiJHZXQgYW4gZW52aXJvbm1lbnQgdmFyaWFibGUsIHJldHVybiBOb25lIGlmIGl0IGRvZXNuJ3QgZXhpc3QuCiAgICAgICAgVGhlIG9wdGlvbmFsIHNlY29uZCBhcmd1bWVudCBjYW4gc3BlY2lmeSBhbiBhbHRlcm5hdGUgZGVmYXVsdC4KICAgICAgICBrZXksIGRlZmF1bHQgYW5kIHRoZSByZXN1bHQgYXJlIGJ5dGVzLiIiIgogICAgICAgIHJldHVybiBlbnZpcm9uYi5nZXQoa2V5LCBkZWZhdWx0KQoKICAgIF9fYWxsX18uZXh0ZW5kKCgiZW52aXJvbmIiLCAiZ2V0ZW52YiIpKQoKZGVmIF9mc2NvZGVjKCk6CiAgICBlbmNvZGluZyA9IHN5cy5nZXRmaWxlc3lzdGVtZW5jb2RpbmcoKQogICAgaWYgZW5jb2RpbmcgPT0gJ21iY3MnOgogICAgICAgIGVycm9ycyA9ICdzdHJpY3QnCiAgICBlbHNlOgogICAgICAgIGVycm9ycyA9ICdzdXJyb2dhdGVlc2NhcGUnCgogICAgZGVmIGZzZW5jb2RlKGZpbGVuYW1lKToKICAgICAgICAiIiIKICAgICAgICBFbmNvZGUgZmlsZW5hbWUgdG8gdGhlIGZpbGVzeXN0ZW0gZW5jb2Rpbmcgd2l0aCAnc3Vycm9nYXRlZXNjYXBlJyBlcnJvcgogICAgICAgIGhhbmRsZXIsIHJldHVybiBieXRlcyB1bmNoYW5nZWQuIE9uIFdpbmRvd3MsIHVzZSAnc3RyaWN0JyBlcnJvciBoYW5kbGVyIGlmCiAgICAgICAgdGhlIGZpbGUgc3lzdGVtIGVuY29kaW5nIGlzICdtYmNzJyAod2hpY2ggaXMgdGhlIGRlZmF1bHQgZW5jb2RpbmcpLgogICAgICAgICIiIgogICAgICAgIGlmIGlzaW5zdGFuY2UoZmlsZW5hbWUsIGJ5dGVzKToKICAgICAgICAgICAgcmV0dXJuIGZpbGVuYW1lCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKGZpbGVuYW1lLCBzdHIpOgogICAgICAgICAgICByZXR1cm4gZmlsZW5hbWUuZW5jb2RlKGVuY29kaW5nLCBlcnJvcnMpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJleHBlY3QgYnl0ZXMgb3Igc3RyLCBub3QgJXMiICUgdHlwZShmaWxlbmFtZSkuX19uYW1lX18pCgogICAgZGVmIGZzZGVjb2RlKGZpbGVuYW1lKToKICAgICAgICAiIiIKICAgICAgICBEZWNvZGUgZmlsZW5hbWUgZnJvbSB0aGUgZmlsZXN5c3RlbSBlbmNvZGluZyB3aXRoICdzdXJyb2dhdGVlc2NhcGUnIGVycm9yCiAgICAgICAgaGFuZGxlciwgcmV0dXJuIHN0ciB1bmNoYW5nZWQuIE9uIFdpbmRvd3MsIHVzZSAnc3RyaWN0JyBlcnJvciBoYW5kbGVyIGlmCiAgICAgICAgdGhlIGZpbGUgc3lzdGVtIGVuY29kaW5nIGlzICdtYmNzJyAod2hpY2ggaXMgdGhlIGRlZmF1bHQgZW5jb2RpbmcpLgogICAgICAgICIiIgogICAgICAgIGlmIGlzaW5zdGFuY2UoZmlsZW5hbWUsIHN0cik6CiAgICAgICAgICAgIHJldHVybiBmaWxlbmFtZQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShmaWxlbmFtZSwgYnl0ZXMpOgogICAgICAgICAgICByZXR1cm4gZmlsZW5hbWUuZGVjb2RlKGVuY29kaW5nLCBlcnJvcnMpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJleHBlY3QgYnl0ZXMgb3Igc3RyLCBub3QgJXMiICUgdHlwZShmaWxlbmFtZSkuX19uYW1lX18pCgogICAgcmV0dXJuIGZzZW5jb2RlLCBmc2RlY29kZQoKZnNlbmNvZGUsIGZzZGVjb2RlID0gX2ZzY29kZWMoKQpkZWwgX2ZzY29kZWMKCiMgU3VwcGx5IHNwYXduKigpIChwcm9iYWJseSBvbmx5IGZvciBVbml4KQppZiBfZXhpc3RzKCJmb3JrIikgYW5kIG5vdCBfZXhpc3RzKCJzcGF3bnYiKSBhbmQgX2V4aXN0cygiZXhlY3YiKToKCiAgICBQX1dBSVQgPSAwCiAgICBQX05PV0FJVCA9IFBfTk9XQUlUTyA9IDEKCiAgICBfX2FsbF9fLmV4dGVuZChbIlBfV0FJVCIsICJQX05PV0FJVCIsICJQX05PV0FJVE8iXSkKCiAgICAjIFhYWCBTaG91bGQgd2Ugc3VwcG9ydCBQX0RFVEFDSD8gIEkgc3VwcG9zZSBpdCBjb3VsZCBmb3JrKCkqKjIKICAgICMgYW5kIGNsb3NlIHRoZSBzdGQgSS9PIHN0cmVhbXMuICBBbHNvLCBQX09WRVJMQVkgaXMgdGhlIHNhbWUKICAgICMgYXMgZXhlY3YqKCk/CgogICAgZGVmIF9zcGF3bnZlZihtb2RlLCBmaWxlLCBhcmdzLCBlbnYsIGZ1bmMpOgogICAgICAgICMgSW50ZXJuYWwgaGVscGVyOyBmdW5jIGlzIHRoZSBleGVjKigpIGZ1bmN0aW9uIHRvIHVzZQogICAgICAgIHBpZCA9IGZvcmsoKQogICAgICAgIGlmIG5vdCBwaWQ6CiAgICAgICAgICAgICMgQ2hpbGQKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgaWYgZW52IGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgZnVuYyhmaWxlLCBhcmdzKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBmdW5jKGZpbGUsIGFyZ3MsIGVudikKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgX2V4aXQoMTI3KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgUGFyZW50CiAgICAgICAgICAgIGlmIG1vZGUgPT0gUF9OT1dBSVQ6CiAgICAgICAgICAgICAgICByZXR1cm4gcGlkICMgQ2FsbGVyIGlzIHJlc3BvbnNpYmxlIGZvciB3YWl0aW5nIQogICAgICAgICAgICB3aGlsZSAxOgogICAgICAgICAgICAgICAgd3BpZCwgc3RzID0gd2FpdHBpZChwaWQsIDApCiAgICAgICAgICAgICAgICBpZiBXSUZTVE9QUEVEKHN0cyk6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIGVsaWYgV0lGU0lHTkFMRUQoc3RzKToKICAgICAgICAgICAgICAgICAgICByZXR1cm4gLVdURVJNU0lHKHN0cykKICAgICAgICAgICAgICAgIGVsaWYgV0lGRVhJVEVEKHN0cyk6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFdFWElUU1RBVFVTKHN0cykKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgZXJyb3IoIk5vdCBzdG9wcGVkLCBzaWduYWxlZCBvciBleGl0ZWQ/Pz8iKQoKICAgIGRlZiBzcGF3bnYobW9kZSwgZmlsZSwgYXJncyk6CiAgICAgICAgIiIic3Bhd252KG1vZGUsIGZpbGUsIGFyZ3MpIC0+IGludGVnZXIKCkV4ZWN1dGUgZmlsZSB3aXRoIGFyZ3VtZW50cyBmcm9tIGFyZ3MgaW4gYSBzdWJwcm9jZXNzLgpJZiBtb2RlID09IFBfTk9XQUlUIHJldHVybiB0aGUgcGlkIG9mIHRoZSBwcm9jZXNzLgpJZiBtb2RlID09IFBfV0FJVCByZXR1cm4gdGhlIHByb2Nlc3MncyBleGl0IGNvZGUgaWYgaXQgZXhpdHMgbm9ybWFsbHk7Cm90aGVyd2lzZSByZXR1cm4gLVNJRywgd2hlcmUgU0lHIGlzIHRoZSBzaWduYWwgdGhhdCBraWxsZWQgaXQuICIiIgogICAgICAgIHJldHVybiBfc3Bhd252ZWYobW9kZSwgZmlsZSwgYXJncywgTm9uZSwgZXhlY3YpCgogICAgZGVmIHNwYXdudmUobW9kZSwgZmlsZSwgYXJncywgZW52KToKICAgICAgICAiIiJzcGF3bnZlKG1vZGUsIGZpbGUsIGFyZ3MsIGVudikgLT4gaW50ZWdlcgoKRXhlY3V0ZSBmaWxlIHdpdGggYXJndW1lbnRzIGZyb20gYXJncyBpbiBhIHN1YnByb2Nlc3Mgd2l0aCB0aGUKc3BlY2lmaWVkIGVudmlyb25tZW50LgpJZiBtb2RlID09IFBfTk9XQUlUIHJldHVybiB0aGUgcGlkIG9mIHRoZSBwcm9jZXNzLgpJZiBtb2RlID09IFBfV0FJVCByZXR1cm4gdGhlIHByb2Nlc3MncyBleGl0IGNvZGUgaWYgaXQgZXhpdHMgbm9ybWFsbHk7Cm90aGVyd2lzZSByZXR1cm4gLVNJRywgd2hlcmUgU0lHIGlzIHRoZSBzaWduYWwgdGhhdCBraWxsZWQgaXQuICIiIgogICAgICAgIHJldHVybiBfc3Bhd252ZWYobW9kZSwgZmlsZSwgYXJncywgZW52LCBleGVjdmUpCgogICAgIyBOb3RlOiBzcGF3bnZwW2VdIGlzJ3QgY3VycmVudGx5IHN1cHBvcnRlZCBvbiBXaW5kb3dzCgogICAgZGVmIHNwYXdudnAobW9kZSwgZmlsZSwgYXJncyk6CiAgICAgICAgIiIic3Bhd252cChtb2RlLCBmaWxlLCBhcmdzKSAtPiBpbnRlZ2VyCgpFeGVjdXRlIGZpbGUgKHdoaWNoIGlzIGxvb2tlZCBmb3IgYWxvbmcgJFBBVEgpIHdpdGggYXJndW1lbnRzIGZyb20KYXJncyBpbiBhIHN1YnByb2Nlc3MuCklmIG1vZGUgPT0gUF9OT1dBSVQgcmV0dXJuIHRoZSBwaWQgb2YgdGhlIHByb2Nlc3MuCklmIG1vZGUgPT0gUF9XQUlUIHJldHVybiB0aGUgcHJvY2VzcydzIGV4aXQgY29kZSBpZiBpdCBleGl0cyBub3JtYWxseTsKb3RoZXJ3aXNlIHJldHVybiAtU0lHLCB3aGVyZSBTSUcgaXMgdGhlIHNpZ25hbCB0aGF0IGtpbGxlZCBpdC4gIiIiCiAgICAgICAgcmV0dXJuIF9zcGF3bnZlZihtb2RlLCBmaWxlLCBhcmdzLCBOb25lLCBleGVjdnApCgogICAgZGVmIHNwYXdudnBlKG1vZGUsIGZpbGUsIGFyZ3MsIGVudik6CiAgICAgICAgIiIic3Bhd252cGUobW9kZSwgZmlsZSwgYXJncywgZW52KSAtPiBpbnRlZ2VyCgpFeGVjdXRlIGZpbGUgKHdoaWNoIGlzIGxvb2tlZCBmb3IgYWxvbmcgJFBBVEgpIHdpdGggYXJndW1lbnRzIGZyb20KYXJncyBpbiBhIHN1YnByb2Nlc3Mgd2l0aCB0aGUgc3VwcGxpZWQgZW52aXJvbm1lbnQuCklmIG1vZGUgPT0gUF9OT1dBSVQgcmV0dXJuIHRoZSBwaWQgb2YgdGhlIHByb2Nlc3MuCklmIG1vZGUgPT0gUF9XQUlUIHJldHVybiB0aGUgcHJvY2VzcydzIGV4aXQgY29kZSBpZiBpdCBleGl0cyBub3JtYWxseTsKb3RoZXJ3aXNlIHJldHVybiAtU0lHLCB3aGVyZSBTSUcgaXMgdGhlIHNpZ25hbCB0aGF0IGtpbGxlZCBpdC4gIiIiCiAgICAgICAgcmV0dXJuIF9zcGF3bnZlZihtb2RlLCBmaWxlLCBhcmdzLCBlbnYsIGV4ZWN2cGUpCgppZiBfZXhpc3RzKCJzcGF3bnYiKToKICAgICMgVGhlc2UgYXJlbid0IHN1cHBsaWVkIGJ5IHRoZSBiYXNpYyBXaW5kb3dzIGNvZGUKICAgICMgYnV0IGNhbiBiZSBlYXNpbHkgaW1wbGVtZW50ZWQgaW4gUHl0aG9uCgogICAgZGVmIHNwYXdubChtb2RlLCBmaWxlLCAqYXJncyk6CiAgICAgICAgIiIic3Bhd25sKG1vZGUsIGZpbGUsICphcmdzKSAtPiBpbnRlZ2VyCgpFeGVjdXRlIGZpbGUgd2l0aCBhcmd1bWVudHMgZnJvbSBhcmdzIGluIGEgc3VicHJvY2Vzcy4KSWYgbW9kZSA9PSBQX05PV0FJVCByZXR1cm4gdGhlIHBpZCBvZiB0aGUgcHJvY2Vzcy4KSWYgbW9kZSA9PSBQX1dBSVQgcmV0dXJuIHRoZSBwcm9jZXNzJ3MgZXhpdCBjb2RlIGlmIGl0IGV4aXRzIG5vcm1hbGx5OwpvdGhlcndpc2UgcmV0dXJuIC1TSUcsIHdoZXJlIFNJRyBpcyB0aGUgc2lnbmFsIHRoYXQga2lsbGVkIGl0LiAiIiIKICAgICAgICByZXR1cm4gc3Bhd252KG1vZGUsIGZpbGUsIGFyZ3MpCgogICAgZGVmIHNwYXdubGUobW9kZSwgZmlsZSwgKmFyZ3MpOgogICAgICAgICIiInNwYXdubGUobW9kZSwgZmlsZSwgKmFyZ3MsIGVudikgLT4gaW50ZWdlcgoKRXhlY3V0ZSBmaWxlIHdpdGggYXJndW1lbnRzIGZyb20gYXJncyBpbiBhIHN1YnByb2Nlc3Mgd2l0aCB0aGUKc3VwcGxpZWQgZW52aXJvbm1lbnQuCklmIG1vZGUgPT0gUF9OT1dBSVQgcmV0dXJuIHRoZSBwaWQgb2YgdGhlIHByb2Nlc3MuCklmIG1vZGUgPT0gUF9XQUlUIHJldHVybiB0aGUgcHJvY2VzcydzIGV4aXQgY29kZSBpZiBpdCBleGl0cyBub3JtYWxseTsKb3RoZXJ3aXNlIHJldHVybiAtU0lHLCB3aGVyZSBTSUcgaXMgdGhlIHNpZ25hbCB0aGF0IGtpbGxlZCBpdC4gIiIiCiAgICAgICAgZW52ID0gYXJnc1stMV0KICAgICAgICByZXR1cm4gc3Bhd252ZShtb2RlLCBmaWxlLCBhcmdzWzotMV0sIGVudikKCgogICAgX19hbGxfXy5leHRlbmQoWyJzcGF3bnYiLCAic3Bhd252ZSIsICJzcGF3bmwiLCAic3Bhd25sZSIsXSkKCgppZiBfZXhpc3RzKCJzcGF3bnZwIik6CiAgICAjIEF0IHRoZSBtb21lbnQsIFdpbmRvd3MgZG9lc24ndCBpbXBsZW1lbnQgc3Bhd252cFtlXSwKICAgICMgc28gaXQgd29uJ3QgaGF2ZSBzcGF3bmxwW2VdIGVpdGhlci4KICAgIGRlZiBzcGF3bmxwKG1vZGUsIGZpbGUsICphcmdzKToKICAgICAgICAiIiJzcGF3bmxwKG1vZGUsIGZpbGUsICphcmdzKSAtPiBpbnRlZ2VyCgpFeGVjdXRlIGZpbGUgKHdoaWNoIGlzIGxvb2tlZCBmb3IgYWxvbmcgJFBBVEgpIHdpdGggYXJndW1lbnRzIGZyb20KYXJncyBpbiBhIHN1YnByb2Nlc3Mgd2l0aCB0aGUgc3VwcGxpZWQgZW52aXJvbm1lbnQuCklmIG1vZGUgPT0gUF9OT1dBSVQgcmV0dXJuIHRoZSBwaWQgb2YgdGhlIHByb2Nlc3MuCklmIG1vZGUgPT0gUF9XQUlUIHJldHVybiB0aGUgcHJvY2VzcydzIGV4aXQgY29kZSBpZiBpdCBleGl0cyBub3JtYWxseTsKb3RoZXJ3aXNlIHJldHVybiAtU0lHLCB3aGVyZSBTSUcgaXMgdGhlIHNpZ25hbCB0aGF0IGtpbGxlZCBpdC4gIiIiCiAgICAgICAgcmV0dXJuIHNwYXdudnAobW9kZSwgZmlsZSwgYXJncykKCiAgICBkZWYgc3Bhd25scGUobW9kZSwgZmlsZSwgKmFyZ3MpOgogICAgICAgICIiInNwYXdubHBlKG1vZGUsIGZpbGUsICphcmdzLCBlbnYpIC0+IGludGVnZXIKCkV4ZWN1dGUgZmlsZSAod2hpY2ggaXMgbG9va2VkIGZvciBhbG9uZyAkUEFUSCkgd2l0aCBhcmd1bWVudHMgZnJvbQphcmdzIGluIGEgc3VicHJvY2VzcyB3aXRoIHRoZSBzdXBwbGllZCBlbnZpcm9ubWVudC4KSWYgbW9kZSA9PSBQX05PV0FJVCByZXR1cm4gdGhlIHBpZCBvZiB0aGUgcHJvY2Vzcy4KSWYgbW9kZSA9PSBQX1dBSVQgcmV0dXJuIHRoZSBwcm9jZXNzJ3MgZXhpdCBjb2RlIGlmIGl0IGV4aXRzIG5vcm1hbGx5OwpvdGhlcndpc2UgcmV0dXJuIC1TSUcsIHdoZXJlIFNJRyBpcyB0aGUgc2lnbmFsIHRoYXQga2lsbGVkIGl0LiAiIiIKICAgICAgICBlbnYgPSBhcmdzWy0xXQogICAgICAgIHJldHVybiBzcGF3bnZwZShtb2RlLCBmaWxlLCBhcmdzWzotMV0sIGVudikKCgogICAgX19hbGxfXy5leHRlbmQoWyJzcGF3bnZwIiwgInNwYXdudnBlIiwgInNwYXdubHAiLCAic3Bhd25scGUiLF0pCgppbXBvcnQgY29weXJlZyBhcyBfY29weXJlZwoKZGVmIF9tYWtlX3N0YXRfcmVzdWx0KHR1cCwgZGljdCk6CiAgICByZXR1cm4gc3RhdF9yZXN1bHQodHVwLCBkaWN0KQoKZGVmIF9waWNrbGVfc3RhdF9yZXN1bHQoc3IpOgogICAgKHR5cGUsIGFyZ3MpID0gc3IuX19yZWR1Y2VfXygpCiAgICByZXR1cm4gKF9tYWtlX3N0YXRfcmVzdWx0LCBhcmdzKQoKdHJ5OgogICAgX2NvcHlyZWcucGlja2xlKHN0YXRfcmVzdWx0LCBfcGlja2xlX3N0YXRfcmVzdWx0LCBfbWFrZV9zdGF0X3Jlc3VsdCkKZXhjZXB0IE5hbWVFcnJvcjogIyBzdGF0X3Jlc3VsdCBtYXkgbm90IGV4aXN0CiAgICBwYXNzCgpkZWYgX21ha2Vfc3RhdHZmc19yZXN1bHQodHVwLCBkaWN0KToKICAgIHJldHVybiBzdGF0dmZzX3Jlc3VsdCh0dXAsIGRpY3QpCgpkZWYgX3BpY2tsZV9zdGF0dmZzX3Jlc3VsdChzcik6CiAgICAodHlwZSwgYXJncykgPSBzci5fX3JlZHVjZV9fKCkKICAgIHJldHVybiAoX21ha2Vfc3RhdHZmc19yZXN1bHQsIGFyZ3MpCgp0cnk6CiAgICBfY29weXJlZy5waWNrbGUoc3RhdHZmc19yZXN1bHQsIF9waWNrbGVfc3RhdHZmc19yZXN1bHQsCiAgICAgICAgICAgICAgICAgICAgIF9tYWtlX3N0YXR2ZnNfcmVzdWx0KQpleGNlcHQgTmFtZUVycm9yOiAjIHN0YXR2ZnNfcmVzdWx0IG1heSBub3QgZXhpc3QKICAgIHBhc3MKCiMgU3VwcGx5IG9zLnBvcGVuKCkKZGVmIHBvcGVuKGNtZCwgbW9kZT0iciIsIGJ1ZmZlcmluZz0tMSk6CiAgICBpZiBub3QgaXNpbnN0YW5jZShjbWQsIHN0cik6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJpbnZhbGlkIGNtZCB0eXBlICglcywgZXhwZWN0ZWQgc3RyaW5nKSIgJSB0eXBlKGNtZCkpCiAgICBpZiBtb2RlIG5vdCBpbiAoInIiLCAidyIpOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImludmFsaWQgbW9kZSAlciIgJSBtb2RlKQogICAgaWYgYnVmZmVyaW5nID09IDAgb3IgYnVmZmVyaW5nID09IE5vbmU6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigicG9wZW4oKSBkb2VzIG5vdCBzdXBwb3J0IHVuYnVmZmVyZWQgc3RyZWFtcyIpCiAgICBpbXBvcnQgc3VicHJvY2VzcywgaW8KICAgIGlmIG1vZGUgPT0gInIiOgogICAgICAgIHByb2MgPSBzdWJwcm9jZXNzLlBvcGVuKGNtZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGVsbD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZG91dD1zdWJwcm9jZXNzLlBJUEUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVmc2l6ZT1idWZmZXJpbmcpCiAgICAgICAgcmV0dXJuIF93cmFwX2Nsb3NlKGlvLlRleHRJT1dyYXBwZXIocHJvYy5zdGRvdXQpLCBwcm9jKQogICAgZWxzZToKICAgICAgICBwcm9jID0gc3VicHJvY2Vzcy5Qb3BlbihjbWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hlbGw9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGRpbj1zdWJwcm9jZXNzLlBJUEUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVmc2l6ZT1idWZmZXJpbmcpCiAgICAgICAgcmV0dXJuIF93cmFwX2Nsb3NlKGlvLlRleHRJT1dyYXBwZXIocHJvYy5zdGRpbiksIHByb2MpCgojIEhlbHBlciBmb3IgcG9wZW4oKSAtLSBhIHByb3h5IGZvciBhIGZpbGUgd2hvc2UgY2xvc2Ugd2FpdHMgZm9yIHRoZSBwcm9jZXNzCmNsYXNzIF93cmFwX2Nsb3NlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHN0cmVhbSwgcHJvYyk6CiAgICAgICAgc2VsZi5fc3RyZWFtID0gc3RyZWFtCiAgICAgICAgc2VsZi5fcHJvYyA9IHByb2MKICAgIGRlZiBjbG9zZShzZWxmKToKICAgICAgICBzZWxmLl9zdHJlYW0uY2xvc2UoKQogICAgICAgIHJldHVybmNvZGUgPSBzZWxmLl9wcm9jLndhaXQoKQogICAgICAgIGlmIHJldHVybmNvZGUgPT0gMDoKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICBpZiBuYW1lID09ICdudCc6CiAgICAgICAgICAgIHJldHVybiByZXR1cm5jb2RlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHJldHVybmNvZGUgPDwgOCAgIyBTaGlmdCBsZWZ0IHRvIG1hdGNoIG9sZCBiZWhhdmlvcgogICAgZGVmIF9fZW50ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgogICAgZGVmIF9fZXhpdF9fKHNlbGYsICphcmdzKToKICAgICAgICBzZWxmLmNsb3NlKCkKICAgIGRlZiBfX2dldGF0dHJfXyhzZWxmLCBuYW1lKToKICAgICAgICByZXR1cm4gZ2V0YXR0cihzZWxmLl9zdHJlYW0sIG5hbWUpCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGl0ZXIoc2VsZi5fc3RyZWFtKQoKIyBTdXBwbHkgb3MuZmRvcGVuKCkKZGVmIGZkb3BlbihmZCwgKmFyZ3MsICoqa3dhcmdzKToKICAgIGlmIG5vdCBpc2luc3RhbmNlKGZkLCBpbnQpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiaW52YWxpZCBmZCB0eXBlICglcywgZXhwZWN0ZWQgaW50ZWdlcikiICUgdHlwZShmZCkpCiAgICBpbXBvcnQgaW8KICAgIHJldHVybiBpby5vcGVuKGZkLCAqYXJncywgKiprd2FyZ3MpCg==',
'/Lib/platform.py':'IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoKIiIiIFRoaXMgbW9kdWxlIHRyaWVzIHRvIHJldHJpZXZlIGFzIG11Y2ggcGxhdGZvcm0taWRlbnRpZnlpbmcgZGF0YSBhcwogICAgcG9zc2libGUuIEl0IG1ha2VzIHRoaXMgaW5mb3JtYXRpb24gYXZhaWxhYmxlIHZpYSBmdW5jdGlvbiBBUElzLgoKICAgIElmIGNhbGxlZCBmcm9tIHRoZSBjb21tYW5kIGxpbmUsIGl0IHByaW50cyB0aGUgcGxhdGZvcm0KICAgIGluZm9ybWF0aW9uIGNvbmNhdGVuYXRlZCBhcyBzaW5nbGUgc3RyaW5nIHRvIHN0ZG91dC4gVGhlIG91dHB1dAogICAgZm9ybWF0IGlzIHVzZWFibGUgYXMgcGFydCBvZiBhIGZpbGVuYW1lLgoKIiIiCiMgICAgVGhpcyBtb2R1bGUgaXMgbWFpbnRhaW5lZCBieSBNYXJjLUFuZHJlIExlbWJ1cmcgPG1hbEBlZ2VuaXguY29tPi4KIyAgICBJZiB5b3UgZmluZCBwcm9ibGVtcywgcGxlYXNlIHN1Ym1pdCBidWcgcmVwb3J0cy9wYXRjaGVzIHZpYSB0aGUKIyAgICBQeXRob24gYnVnIHRyYWNrZXIgKGh0dHA6Ly9idWdzLnB5dGhvbi5vcmcpIGFuZCBhc3NpZ24gdGhlbSB0byAibGVtYnVyZyIuCiMKIyAgICBTdGlsbCBuZWVkZWQ6CiMgICAgKiBtb3JlIHN1cHBvcnQgZm9yIFdpbkNFCiMgICAgKiBzdXBwb3J0IGZvciBNUy1ET1MgKFB5dGhvbkRYID8pCiMgICAgKiBzdXBwb3J0IGZvciBBbWlnYSBhbmQgb3RoZXIgc3RpbGwgdW5zdXBwb3J0ZWQgcGxhdGZvcm1zIHJ1bm5pbmcgUHl0aG9uCiMgICAgKiBzdXBwb3J0IGZvciBhZGRpdGlvbmFsIExpbnV4IGRpc3RyaWJ1dGlvbnMKIwojICAgIE1hbnkgdGhhbmtzIHRvIGFsbCB0aG9zZSB3aG8gaGVscGVkIGFkZGluZyBwbGF0Zm9ybS1zcGVjaWZpYwojICAgIGNoZWNrcyAoaW4gbm8gcGFydGljdWxhciBvcmRlcik6CiMKIyAgICAgIENoYXJsZXMgRyBXYWxkbWFuLCBEYXZpZCBBcm5vbGQsIEdvcmRvbiBNY01pbGxhbiwgQmVuIERhcm5lbGwsCiMgICAgICBKZWZmIEJhdWVyLCBDbGlmZiBDcmF3Zm9yZCwgSXZhbiBWYW4gTGFuaW5naGFtLCBKb3NlZgojICAgICAgQmV0YW5jb3VydCwgUmFuZGFsbCBIb3BwZXIsIEthcmwgUHV0bGFuZCwgSm9obiBGYXJyZWxsLCBHcmVnCiMgICAgICBBbmRydWssIEp1c3QgdmFuIFJvc3N1bSwgVGhvbWFzIEhlbGxlciwgTWFyayBSLiBMZXZpbnNvbiwgTWFyawojICAgICAgSGFtbW9uZCwgQmlsbCBUdXR0LCBIYW5zIE5vd2FrLCBVd2UgWmVzc2luIChPcGVuVk1TIHN1cHBvcnQpLAojICAgICAgQ29saW4gS29uZywgVHJlbnQgTWljaywgR3VpZG8gdmFuIFJvc3N1bSwgQW50aG9ueSBCYXh0ZXIKIwojICAgIEhpc3Rvcnk6CiMKIyAgICA8c2VlIENWUyBhbmQgU1ZOIGNoZWNraW4gbWVzc2FnZXMgZm9yIGhpc3Rvcnk+CiMKIyAgICAxLjAuNyAtIGFkZGVkIERFVl9OVUxMCiMgICAgMS4wLjYgLSBhZGRlZCBsaW51eF9kaXN0cmlidXRpb24oKQojICAgIDEuMC41IC0gZml4ZWQgSmF2YSBzdXBwb3J0IHRvIGFsbG93IHJ1bm5pbmcgdGhlIG1vZHVsZSBvbiBKeXRob24KIyAgICAxLjAuNCAtIGFkZGVkIElyb25QeXRob24gc3VwcG9ydAojICAgIDEuMC4zIC0gYWRkZWQgbm9ybWFsaXphdGlvbiBvZiBXaW5kb3dzIHN5c3RlbSBuYW1lCiMgICAgMS4wLjIgLSBhZGRlZCBtb3JlIFdpbmRvd3Mgc3VwcG9ydAojICAgIDEuMC4xIC0gcmVmb3JtYXR0ZWQgdG8gbWFrZSBkb2MucHkgaGFwcHkKIyAgICAxLjAuMCAtIHJlZm9ybWF0dGVkIGEgYml0IGFuZCBjaGVja2VkIGludG8gUHl0aG9uIENWUwojICAgIDAuOC4wIC0gYWRkZWQgc3lzLnZlcnNpb24gcGFyc2VyIGFuZCB2YXJpb3VzIG5ldyBhY2Nlc3MKIyAgICAgICAgICAgIEFQSXMgKHB5dGhvbl92ZXJzaW9uKCksIHB5dGhvbl9jb21waWxlcigpLCBldGMuKQojICAgIDAuNy4yIC0gZml4ZWQgYXJjaGl0ZWN0dXJlKCkgdG8gdXNlIHNpemVvZihwb2ludGVyKSB3aGVyZSBhdmFpbGFibGUKIyAgICAwLjcuMSAtIGFkZGVkIHN1cHBvcnQgZm9yIENhbGRlcmEgT3BlbkxpbnV4CiMgICAgMC43LjAgLSBzb21lIGZpeGVzIGZvciBXaW5DRTsgdW50YWJpZmllZCB0aGUgc291cmNlIGZpbGUKIyAgICAwLjYuMiAtIHN1cHBvcnQgZm9yIE9wZW5WTVMgLSByZXF1aXJlcyB2ZXJzaW9uIDEuNS4yLVYwMDYgb3IgaGlnaGVyIGFuZAojICAgICAgICAgICAgdm1zX2xpYi5nZXRzeWkoKSBjb25maWd1cmVkCiMgICAgMC42LjEgLSBhZGRlZCBjb2RlIHRvIHByZXZlbnQgJ3VuYW1lIC1wJyBvbiBwbGF0Zm9ybXMgd2hpY2ggYXJlCiMgICAgICAgICAgICBrbm93biBub3QgdG8gc3VwcG9ydCBpdAojICAgIDAuNi4wIC0gZml4ZWQgd2luMzJfdmVyKCkgdG8gaG9wZWZ1bGx5IHdvcmsgb24gV2luOTUsOTgsTlQgYW5kIFdpbjJrOwojICAgICAgICAgICAgZGlkIHNvbWUgY2xlYW51cCBvZiB0aGUgaW50ZXJmYWNlcyAtIHNvbWUgQVBJcyBoYXZlIGNoYW5nZWQKIyAgICAwLjUuNSAtIGZpeGVkIGFub3RoZXIgdHlwZSBpbiB0aGUgTWFjT1MgY29kZS4uLiBzaG91bGQgaGF2ZQojICAgICAgICAgICAgdXNlZCBtb3JlIGNvZmZlZSB0b2RheSA7LSkKIyAgICAwLjUuNCAtIGZpeGVkIGEgZmV3IHR5cG9zIGluIHRoZSBNYWNPUyBjb2RlCiMgICAgMC41LjMgLSBhZGRlZCBleHBlcmltZW50YWwgTWFjT1Mgc3VwcG9ydDsgYWRkZWQgYmV0dGVyIHBvcGVuKCkKIyAgICAgICAgICAgIHdvcmthcm91bmRzIGluIF9zeXNjbWRfdmVyKCkgLS0gc3RpbGwgbm90IDEwMCUgZWxlZ2FudAojICAgICAgICAgICAgdGhvdWdoCiMgICAgMC41LjIgLSBmaXhlZCB1bmFtZSgpIHRvIHJldHVybiAnJyBpbnN0ZWFkIG9mICd1bmtub3duJyBpbiBhbGwKIyAgICAgICAgICAgIHJldHVybiB2YWx1ZXMgKHRoZSBzeXN0ZW0gdW5hbWUgY29tbWFuZCB0ZW5kcyB0byByZXR1cm4KIyAgICAgICAgICAgICd1bmtub3duJyBpbnN0ZWFkIG9mIGp1c3QgbGVhdmluZyB0aGUgZmllbGQgZW10cHkpCiMgICAgMC41LjEgLSBpbmNsdWRlZCBjb2RlIGZvciBzbGFja3dhcmUgZGlzdDsgYWRkZWQgZXhjZXB0aW9uIGhhbmRsZXJzCiMgICAgICAgICAgICB0byBjb3ZlciB1cCBzaXR1YXRpb25zIHdoZXJlIHBsYXRmb3JtcyBkb24ndCBoYXZlIG9zLnBvcGVuCiMgICAgICAgICAgICAoZS5nLiBNYWMpIG9yIGZhaWwgb24gc29ja2V0LmdldGhvc3RuYW1lKCk7IGZpeGVkIGxpYmMKIyAgICAgICAgICAgIGRldGVjdGlvbiBSRQojICAgIDAuNS4wIC0gY2hhbmdlZCB0aGUgQVBJIG5hbWVzIHJlZmVycmluZyB0byBzeXN0ZW0gY29tbWFuZHMgdG8gKnN5c2NtZCo7CiMgICAgICAgICAgICBhZGRlZCBqYXZhX3ZlcigpOyBtYWRlIHN5c2NtZF92ZXIoKSBhIHByaXZhdGUKIyAgICAgICAgICAgIEFQSSAod2FzIHN5c3RlbV92ZXIoKSBpbiBwcmV2aW91cyB2ZXJzaW9ucykgLS0gdXNlIHVuYW1lKCkKIyAgICAgICAgICAgIGluc3RlYWQ7IGV4dGVuZGVkIHRoZSB3aW4zMl92ZXIoKSB0byBhbHNvIHJldHVybiBwcm9jZXNzb3IKIyAgICAgICAgICAgIHR5cGUgaW5mb3JtYXRpb24KIyAgICAwLjQuMCAtIGFkZGVkIHdpbjMyX3ZlcigpIGFuZCBtb2RpZmllZCB0aGUgcGxhdGZvcm0oKSBvdXRwdXQgZm9yIFdpblhYCiMgICAgMC4zLjQgLSBmaXhlZCBhIGJ1ZyBpbiBfZm9sbG93X3N5bWxpbmtzKCkKIyAgICAwLjMuMyAtIGZpeGVkIHBvcGVuKCkgYW5kICJmaWxlIiBjb21tYW5kIGludm9rYXRpb24gYnVncwojICAgIDAuMy4yIC0gYWRkZWQgYXJjaGl0ZWN0dXJlKCkgQVBJIGFuZCBzdXBwb3J0IGZvciBpdCBpbiBwbGF0Zm9ybSgpCiMgICAgMC4zLjEgLSBmaXhlZCBzeXNjbWRfdmVyKCkgUkUgdG8gc3VwcG9ydCBXaW5kb3dzIE5UCiMgICAgMC4zLjAgLSBhZGRlZCBzeXN0ZW0gYWxpYXMgc3VwcG9ydAojICAgIDAuMi4zIC0gcmVtb3ZlZCAnd2luY2UnIGFnYWluLi4uIG9oIHdlbGwuCiMgICAgMC4yLjIgLSBhZGRlZCAnd2luY2UnIHRvIHN5c2NtZF92ZXIoKSBzdXBwb3J0ZWQgcGxhdGZvcm1zCiMgICAgMC4yLjEgLSBhZGRlZCBjYWNoZSBsb2dpYyBhbmQgY2hhbmdlZCB0aGUgcGxhdGZvcm0gc3RyaW5nIGZvcm1hdAojICAgIDAuMi4wIC0gY2hhbmdlZCB0aGUgQVBJIHRvIHVzZSBmdW5jdGlvbnMgaW5zdGVhZCBvZiBtb2R1bGUgZ2xvYmFscwojICAgICAgICAgICAgc2luY2Ugc29tZSBhY3Rpb24gdGFrZSB0b28gbG9uZyB0byBiZSBydW4gb24gbW9kdWxlIGltcG9ydAojICAgIDAuMS4wIC0gZmlyc3QgcmVsZWFzZQojCiMgICAgWW91IGNhbiBhbHdheXMgZ2V0IHRoZSBsYXRlc3QgdmVyc2lvbiBvZiB0aGlzIG1vZHVsZSBhdDoKIwojICAgICAgICAgICAgIGh0dHA6Ly93d3cuZWdlbml4LmNvbS9maWxlcy9weXRob24vcGxhdGZvcm0ucHkKIwojICAgIElmIHRoYXQgVVJMIHNob3VsZCBmYWlsLCB0cnkgY29udGFjdGluZyB0aGUgYXV0aG9yLgoKX19jb3B5cmlnaHRfXyA9ICIiIgogICAgQ29weXJpZ2h0IChjKSAxOTk5LTIwMDAsIE1hcmMtQW5kcmUgTGVtYnVyZzsgbWFpbHRvOm1hbEBsZW1idXJnLmNvbQogICAgQ29weXJpZ2h0IChjKSAyMDAwLTIwMTAsIGVHZW5peC5jb20gU29mdHdhcmUgR21iSDsgbWFpbHRvOmluZm9AZWdlbml4LmNvbQoKICAgIFBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZCBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgYW5kIGl0cwogICAgZG9jdW1lbnRhdGlvbiBmb3IgYW55IHB1cnBvc2UgYW5kIHdpdGhvdXQgZmVlIG9yIHJveWFsdHkgaXMgaGVyZWJ5IGdyYW50ZWQsCiAgICBwcm92aWRlZCB0aGF0IHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFwcGVhciBpbiBhbGwgY29waWVzIGFuZCB0aGF0CiAgICBib3RoIHRoYXQgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBhcHBlYXIgaW4KICAgIHN1cHBvcnRpbmcgZG9jdW1lbnRhdGlvbiBvciBwb3J0aW9ucyB0aGVyZW9mLCBpbmNsdWRpbmcgbW9kaWZpY2F0aW9ucywKICAgIHRoYXQgeW91IG1ha2UuCgogICAgRUdFTklYLkNPTSBTT0ZUV0FSRSBHTUJIIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIIFJFR0FSRCBUTwogICAgVEhJUyBTT0ZUV0FSRSwgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORAogICAgRklUTkVTUywgSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLAogICAgSU5ESVJFQ1QgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HCiAgICBGUk9NIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULAogICAgTkVHTElHRU5DRSBPUiBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04KICAgIFdJVEggVEhFIFVTRSBPUiBQRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFICEKCiIiIgoKX192ZXJzaW9uX18gPSAnMS4wLjcnCgppbXBvcnQgY29sbGVjdGlvbnMKaW1wb3J0IHN5cywgb3MsIHJlCgojIyMgR2xvYmFscyAmIENvbnN0YW50cwoKIyBEZXRlcm1pbmUgdGhlIHBsYXRmb3JtJ3MgL2Rldi9udWxsIGRldmljZQp0cnk6CiAgICBERVZfTlVMTCA9IG9zLmRldm51bGwKZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgIyBvcy5kZXZudWxsIHdhcyBhZGRlZCBpbiBQeXRob24gMi40LCBzbyBlbXVsYXRlIGl0IGZvciBlYXJsaWVyCiAgICAjIFB5dGhvbiB2ZXJzaW9ucwogICAgaWYgc3lzLnBsYXRmb3JtIGluICgnZG9zJywnd2luMzInLCd3aW4xNicsJ29zMicpOgogICAgICAgICMgVXNlIHRoZSBvbGQgQ1AvTSBOVUwgYXMgZGV2aWNlIG5hbWUKICAgICAgICBERVZfTlVMTCA9ICdOVUwnCiAgICBlbHNlOgogICAgICAgICMgU3RhbmRhcmQgVW5peCB1c2VzIC9kZXYvbnVsbAogICAgICAgIERFVl9OVUxMID0gJy9kZXYvbnVsbCcKCiMjIyBQbGF0Zm9ybSBzcGVjaWZpYyBBUElzCgpfbGliY19zZWFyY2ggPSByZS5jb21waWxlKGInKF9fbGliY19pbml0KScKICAgICAgICAgICAgICAgICAgICAgICAgICBiJ3wnCiAgICAgICAgICAgICAgICAgICAgICAgICAgYicoR0xJQkNfKFswLTkuXSspKScKICAgICAgICAgICAgICAgICAgICAgICAgICBiJ3wnCiAgICAgICAgICAgICAgICAgICAgICAgICAgYnInKGxpYmMoX1x3Kyk/XC5zbyg/OlwuKFxkWzAtOS5dKikpPyknLCByZS5BU0NJSSkKCmRlZiBsaWJjX3ZlcihleGVjdXRhYmxlPXN5cy5leGVjdXRhYmxlLGxpYj0nJyx2ZXJzaW9uPScnLAoKICAgICAgICAgICAgIGNodW5rc2l6ZT0xNjM4NCk6CgogICAgIiIiIFRyaWVzIHRvIGRldGVybWluZSB0aGUgbGliYyB2ZXJzaW9uIHRoYXQgdGhlIGZpbGUgZXhlY3V0YWJsZQogICAgICAgICh3aGljaCBkZWZhdWx0cyB0byB0aGUgUHl0aG9uIGludGVycHJldGVyKSBpcyBsaW5rZWQgYWdhaW5zdC4KCiAgICAgICAgUmV0dXJucyBhIHR1cGxlIG9mIHN0cmluZ3MgKGxpYix2ZXJzaW9uKSB3aGljaCBkZWZhdWx0IHRvIHRoZQogICAgICAgIGdpdmVuIHBhcmFtZXRlcnMgaW4gY2FzZSB0aGUgbG9va3VwIGZhaWxzLgoKICAgICAgICBOb3RlIHRoYXQgdGhlIGZ1bmN0aW9uIGhhcyBpbnRpbWF0ZSBrbm93bGVkZ2Ugb2YgaG93IGRpZmZlcmVudAogICAgICAgIGxpYmMgdmVyc2lvbnMgYWRkIHN5bWJvbHMgdG8gdGhlIGV4ZWN1dGFibGUgYW5kIHRodXMgaXMgcHJvYmFibHkKICAgICAgICBvbmx5IHVzZWFibGUgZm9yIGV4ZWN1dGFibGVzIGNvbXBpbGVkIHVzaW5nIGdjYy4KCiAgICAgICAgVGhlIGZpbGUgaXMgcmVhZCBhbmQgc2Nhbm5lZCBpbiBjaHVua3Mgb2YgY2h1bmtzaXplIGJ5dGVzLgoKICAgICIiIgogICAgaWYgaGFzYXR0cihvcy5wYXRoLCAncmVhbHBhdGgnKToKICAgICAgICAjIFB5dGhvbiAyLjIgaW50cm9kdWNlZCBvcy5wYXRoLnJlYWxwYXRoKCk7IGl0IGlzIHVzZWQKICAgICAgICAjIGhlcmUgdG8gd29yayBhcm91bmQgcHJvYmxlbXMgd2l0aCBDeWd3aW4gbm90IGJlaW5nCiAgICAgICAgIyBhYmxlIHRvIG9wZW4gc3ltbGlua3MgZm9yIHJlYWRpbmcKICAgICAgICBleGVjdXRhYmxlID0gb3MucGF0aC5yZWFscGF0aChleGVjdXRhYmxlKQogICAgZiA9IG9wZW4oZXhlY3V0YWJsZSwncmInKQogICAgYmluYXJ5ID0gZi5yZWFkKGNodW5rc2l6ZSkKICAgIHBvcyA9IDAKICAgIHdoaWxlIDE6CiAgICAgICAgaWYgYidsaWJjJyBpbiBiaW5hcnkgb3IgYidHTElCQycgaW4gYmluYXJ5OgogICAgICAgICAgICBtID0gX2xpYmNfc2VhcmNoLnNlYXJjaChiaW5hcnkscG9zKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG0gPSBOb25lCiAgICAgICAgaWYgbm90IG06CiAgICAgICAgICAgIGJpbmFyeSA9IGYucmVhZChjaHVua3NpemUpCiAgICAgICAgICAgIGlmIG5vdCBiaW5hcnk6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBwb3MgPSAwCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgbGliY2luaXQsZ2xpYmMsZ2xpYmN2ZXJzaW9uLHNvLHRocmVhZHMsc292ZXJzaW9uID0gWwogICAgICAgICAgICBzLmRlY29kZSgnbGF0aW4xJykgaWYgcyBpcyBub3QgTm9uZSBlbHNlIHMKICAgICAgICAgICAgZm9yIHMgaW4gbS5ncm91cHMoKV0KICAgICAgICBpZiBsaWJjaW5pdCBhbmQgbm90IGxpYjoKICAgICAgICAgICAgbGliID0gJ2xpYmMnCiAgICAgICAgZWxpZiBnbGliYzoKICAgICAgICAgICAgaWYgbGliICE9ICdnbGliYyc6CiAgICAgICAgICAgICAgICBsaWIgPSAnZ2xpYmMnCiAgICAgICAgICAgICAgICB2ZXJzaW9uID0gZ2xpYmN2ZXJzaW9uCiAgICAgICAgICAgIGVsaWYgZ2xpYmN2ZXJzaW9uID4gdmVyc2lvbjoKICAgICAgICAgICAgICAgIHZlcnNpb24gPSBnbGliY3ZlcnNpb24KICAgICAgICBlbGlmIHNvOgogICAgICAgICAgICBpZiBsaWIgIT0gJ2dsaWJjJzoKICAgICAgICAgICAgICAgIGxpYiA9ICdsaWJjJwogICAgICAgICAgICAgICAgaWYgc292ZXJzaW9uIGFuZCBzb3ZlcnNpb24gPiB2ZXJzaW9uOgogICAgICAgICAgICAgICAgICAgIHZlcnNpb24gPSBzb3ZlcnNpb24KICAgICAgICAgICAgICAgIGlmIHRocmVhZHMgYW5kIHZlcnNpb25bLWxlbih0aHJlYWRzKTpdICE9IHRocmVhZHM6CiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbiA9IHZlcnNpb24gKyB0aHJlYWRzCiAgICAgICAgcG9zID0gbS5lbmQoKQogICAgZi5jbG9zZSgpCiAgICByZXR1cm4gbGliLHZlcnNpb24KCmRlZiBfZGlzdF90cnlfaGFyZGVyKGRpc3RuYW1lLHZlcnNpb24saWQpOgoKICAgICIiIiBUcmllcyBzb21lIHNwZWNpYWwgdHJpY2tzIHRvIGdldCB0aGUgZGlzdHJpYnV0aW9uCiAgICAgICAgaW5mb3JtYXRpb24gaW4gY2FzZSB0aGUgZGVmYXVsdCBtZXRob2QgZmFpbHMuCgogICAgICAgIEN1cnJlbnRseSBzdXBwb3J0cyBvbGRlciBTdVNFIExpbnV4LCBDYWxkZXJhIE9wZW5MaW51eCBhbmQKICAgICAgICBTbGFja3dhcmUgTGludXggZGlzdHJpYnV0aW9ucy4KCiAgICAiIiIKICAgIGlmIG9zLnBhdGguZXhpc3RzKCcvdmFyL2FkbS9pbnN0LWxvZy9pbmZvJyk6CiAgICAgICAgIyBTdVNFIExpbnV4IHN0b3JlcyBkaXN0cmlidXRpb24gaW5mb3JtYXRpb24gaW4gdGhhdCBmaWxlCiAgICAgICAgZGlzdG5hbWUgPSAnU3VTRScKICAgICAgICBmb3IgbGluZSBpbiBvcGVuKCcvdmFyL2FkbS9pbnN0LWxvZy9pbmZvJyk6CiAgICAgICAgICAgIHR2ID0gbGluZS5zcGxpdCgpCiAgICAgICAgICAgIGlmIGxlbih0dikgPT0gMjoKICAgICAgICAgICAgICAgIHRhZyx2YWx1ZSA9IHR2CiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBpZiB0YWcgPT0gJ01JTl9ESVNUX1ZFUlNJT04nOgogICAgICAgICAgICAgICAgdmVyc2lvbiA9IHZhbHVlLnN0cmlwKCkKICAgICAgICAgICAgZWxpZiB0YWcgPT0gJ0RJU1RfSURFTlQnOgogICAgICAgICAgICAgICAgdmFsdWVzID0gdmFsdWUuc3BsaXQoJy0nKQogICAgICAgICAgICAgICAgaWQgPSB2YWx1ZXNbMl0KICAgICAgICByZXR1cm4gZGlzdG5hbWUsdmVyc2lvbixpZAoKICAgIGlmIG9zLnBhdGguZXhpc3RzKCcvZXRjLy5pbnN0YWxsZWQnKToKICAgICAgICAjIENhbGRlcmEgT3BlbkxpbnV4IGhhcyBzb21lIGluZm9zIGluIHRoYXQgZmlsZSAodGhhbmtzIHRvIENvbGluIEtvbmcpCiAgICAgICAgZm9yIGxpbmUgaW4gb3BlbignL2V0Yy8uaW5zdGFsbGVkJyk6CiAgICAgICAgICAgIHBrZyA9IGxpbmUuc3BsaXQoJy0nKQogICAgICAgICAgICBpZiBsZW4ocGtnKSA+PSAyIGFuZCBwa2dbMF0gPT0gJ09wZW5MaW51eCc6CiAgICAgICAgICAgICAgICAjIFhYWCBkb2VzIENhbGRlcmEgc3VwcG9ydCBub24gSW50ZWwgcGxhdGZvcm1zID8gSWYgeWVzLAogICAgICAgICAgICAgICAgIyAgICAgd2hlcmUgY2FuIHdlIGZpbmQgdGhlIG5lZWRlZCBpZCA/CiAgICAgICAgICAgICAgICByZXR1cm4gJ09wZW5MaW51eCcscGtnWzFdLGlkCgogICAgaWYgb3MucGF0aC5pc2RpcignL3Vzci9saWIvc2V0dXAnKToKICAgICAgICAjIENoZWNrIGZvciBzbGFja3dhcmUgdmVyc29uIHRhZyBmaWxlICh0aGFua3MgdG8gR3JlZyBBbmRydWspCiAgICAgICAgdmVyZmlsZXMgPSBvcy5saXN0ZGlyKCcvdXNyL2xpYi9zZXR1cCcpCiAgICAgICAgZm9yIG4gaW4gcmFuZ2UobGVuKHZlcmZpbGVzKS0xLCAtMSwgLTEpOgogICAgICAgICAgICBpZiB2ZXJmaWxlc1tuXVs6MTRdICE9ICdzbGFjay12ZXJzaW9uLSc6CiAgICAgICAgICAgICAgICBkZWwgdmVyZmlsZXNbbl0KICAgICAgICBpZiB2ZXJmaWxlczoKICAgICAgICAgICAgdmVyZmlsZXMuc29ydCgpCiAgICAgICAgICAgIGRpc3RuYW1lID0gJ3NsYWNrd2FyZScKICAgICAgICAgICAgdmVyc2lvbiA9IHZlcmZpbGVzWy0xXVsxNDpdCiAgICAgICAgICAgIHJldHVybiBkaXN0bmFtZSx2ZXJzaW9uLGlkCgogICAgcmV0dXJuIGRpc3RuYW1lLHZlcnNpb24saWQKCl9yZWxlYXNlX2ZpbGVuYW1lID0gcmUuY29tcGlsZShyJyhcdyspWy1fXShyZWxlYXNlfHZlcnNpb24pJywgcmUuQVNDSUkpCl9sc2JfcmVsZWFzZV92ZXJzaW9uID0gcmUuY29tcGlsZShyJyguKyknCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyByZWxlYXNlICcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnKFtcZC5dKyknCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1teKF0qKD86XCgoLispXCkpPycsIHJlLkFTQ0lJKQpfcmVsZWFzZV92ZXJzaW9uID0gcmUuY29tcGlsZShyJyhbXjAtOV0rKScKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcoPzogcmVsZWFzZSApPycKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcoW1xkLl0rKScKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdbXihdKig/OlwoKC4rKVwpKT8nLCByZS5BU0NJSSkKCiMgU2VlIGFsc28gaHR0cDovL3d3dy5ub3ZlbGwuY29tL2Nvb2xzb2x1dGlvbnMvZmVhdHVyZS8xMTI1MS5odG1sCiMgYW5kIGh0dHA6Ly9saW51eG1hZmlhLmNvbS9mYXEvQWRtaW4vcmVsZWFzZS1maWxlcy5odG1sCiMgYW5kIGh0dHA6Ly9kYXRhLmxpbnV4LW50ZnMub3JnL3JwbS93aGljaHJwbQojIGFuZCBodHRwOi8vd3d3LmRpZS5uZXQvZG9jL2xpbnV4L21hbi9tYW4xL2xzYl9yZWxlYXNlLjEuaHRtbAoKX3N1cHBvcnRlZF9kaXN0cyA9ICgKICAgICdTdVNFJywgJ2RlYmlhbicsICdmZWRvcmEnLCAncmVkaGF0JywgJ2NlbnRvcycsCiAgICAnbWFuZHJha2UnLCAnbWFuZHJpdmEnLCAncm9ja3MnLCAnc2xhY2t3YXJlJywgJ3llbGxvd2RvZycsICdnZW50b28nLAogICAgJ1VuaXRlZExpbnV4JywgJ3R1cmJvbGludXgnLCAnYXJjaCcsICdtYWdlaWEnKQoKZGVmIF9wYXJzZV9yZWxlYXNlX2ZpbGUoZmlyc3RsaW5lKToKCiAgICAjIERlZmF1bHQgdG8gZW1wdHkgJ3ZlcnNpb24nIGFuZCAnaWQnIHN0cmluZ3MuICBCb3RoIGRlZmF1bHRzIGFyZSB1c2VkCiAgICAjIHdoZW4gJ2ZpcnN0bGluZScgaXMgZW1wdHkuICAnaWQnIGRlZmF1bHRzIHRvIGVtcHR5IHdoZW4gYW4gaWQgY2FuIG5vdAogICAgIyBiZSBkZWR1Y2VkLgogICAgdmVyc2lvbiA9ICcnCiAgICBpZCA9ICcnCgogICAgIyBQYXJzZSB0aGUgZmlyc3QgbGluZQogICAgbSA9IF9sc2JfcmVsZWFzZV92ZXJzaW9uLm1hdGNoKGZpcnN0bGluZSkKICAgIGlmIG0gaXMgbm90IE5vbmU6CiAgICAgICAgIyBMU0IgZm9ybWF0OiAiZGlzdHJvIHJlbGVhc2UgeC54IChjb2RlbmFtZSkiCiAgICAgICAgcmV0dXJuIHR1cGxlKG0uZ3JvdXBzKCkpCgogICAgIyBQcmUtTFNCIGZvcm1hdDogImRpc3RybyB4LnggKGNvZGVuYW1lKSIKICAgIG0gPSBfcmVsZWFzZV92ZXJzaW9uLm1hdGNoKGZpcnN0bGluZSkKICAgIGlmIG0gaXMgbm90IE5vbmU6CiAgICAgICAgcmV0dXJuIHR1cGxlKG0uZ3JvdXBzKCkpCgogICAgIyBVbmtvd24gZm9ybWF0Li4uIHRha2UgdGhlIGZpcnN0IHR3byB3b3JkcwogICAgbCA9IGZpcnN0bGluZS5zdHJpcCgpLnNwbGl0KCkKICAgIGlmIGw6CiAgICAgICAgdmVyc2lvbiA9IGxbMF0KICAgICAgICBpZiBsZW4obCkgPiAxOgogICAgICAgICAgICBpZCA9IGxbMV0KICAgIHJldHVybiAnJywgdmVyc2lvbiwgaWQKCmRlZiBsaW51eF9kaXN0cmlidXRpb24oZGlzdG5hbWU9JycsIHZlcnNpb249JycsIGlkPScnLAoKICAgICAgICAgICAgICAgICAgICAgICBzdXBwb3J0ZWRfZGlzdHM9X3N1cHBvcnRlZF9kaXN0cywKICAgICAgICAgICAgICAgICAgICAgICBmdWxsX2Rpc3RyaWJ1dGlvbl9uYW1lPTEpOgoKICAgICIiIiBUcmllcyB0byBkZXRlcm1pbmUgdGhlIG5hbWUgb2YgdGhlIExpbnV4IE9TIGRpc3RyaWJ1dGlvbiBuYW1lLgoKICAgICAgICBUaGUgZnVuY3Rpb24gZmlyc3QgbG9va3MgZm9yIGEgZGlzdHJpYnV0aW9uIHJlbGVhc2UgZmlsZSBpbgogICAgICAgIC9ldGMgYW5kIHRoZW4gcmV2ZXJ0cyB0byBfZGlzdF90cnlfaGFyZGVyKCkgaW4gY2FzZSBubwogICAgICAgIHN1aXRhYmxlIGZpbGVzIGFyZSBmb3VuZC4KCiAgICAgICAgc3VwcG9ydGVkX2Rpc3RzIG1heSBiZSBnaXZlbiB0byBkZWZpbmUgdGhlIHNldCBvZiBMaW51eAogICAgICAgIGRpc3RyaWJ1dGlvbnMgdG8gbG9vayBmb3IuIEl0IGRlZmF1bHRzIHRvIGEgbGlzdCBvZiBjdXJyZW50bHkKICAgICAgICBzdXBwb3J0ZWQgTGludXggZGlzdHJpYnV0aW9ucyBpZGVudGlmaWVkIGJ5IHRoZWlyIHJlbGVhc2UgZmlsZQogICAgICAgIG5hbWUuCgogICAgICAgIElmIGZ1bGxfZGlzdHJpYnV0aW9uX25hbWUgaXMgdHJ1ZSAoZGVmYXVsdCksIHRoZSBmdWxsCiAgICAgICAgZGlzdHJpYnV0aW9uIHJlYWQgZnJvbSB0aGUgT1MgaXMgcmV0dXJuZWQuIE90aGVyd2lzZSB0aGUgc2hvcnQKICAgICAgICBuYW1lIHRha2VuIGZyb20gc3VwcG9ydGVkX2Rpc3RzIGlzIHVzZWQuCgogICAgICAgIFJldHVybnMgYSB0dXBsZSAoZGlzdG5hbWUsdmVyc2lvbixpZCkgd2hpY2ggZGVmYXVsdCB0byB0aGUKICAgICAgICBhcmdzIGdpdmVuIGFzIHBhcmFtZXRlcnMuCgogICAgIiIiCiAgICB0cnk6CiAgICAgICAgZXRjID0gb3MubGlzdGRpcignL2V0YycpCiAgICBleGNlcHQgb3MuZXJyb3I6CiAgICAgICAgIyBQcm9iYWJseSBub3QgYSBVbml4IHN5c3RlbQogICAgICAgIHJldHVybiBkaXN0bmFtZSx2ZXJzaW9uLGlkCiAgICBldGMuc29ydCgpCiAgICBmb3IgZmlsZSBpbiBldGM6CiAgICAgICAgbSA9IF9yZWxlYXNlX2ZpbGVuYW1lLm1hdGNoKGZpbGUpCiAgICAgICAgaWYgbSBpcyBub3QgTm9uZToKICAgICAgICAgICAgX2Rpc3RuYW1lLGR1bW15ID0gbS5ncm91cHMoKQogICAgICAgICAgICBpZiBfZGlzdG5hbWUgaW4gc3VwcG9ydGVkX2Rpc3RzOgogICAgICAgICAgICAgICAgZGlzdG5hbWUgPSBfZGlzdG5hbWUKICAgICAgICAgICAgICAgIGJyZWFrCiAgICBlbHNlOgogICAgICAgIHJldHVybiBfZGlzdF90cnlfaGFyZGVyKGRpc3RuYW1lLHZlcnNpb24saWQpCgogICAgIyBSZWFkIHRoZSBmaXJzdCBsaW5lCiAgICB3aXRoIG9wZW4oJy9ldGMvJytmaWxlLCAncicpIGFzIGY6CiAgICAgICAgZmlyc3RsaW5lID0gZi5yZWFkbGluZSgpCiAgICBfZGlzdG5hbWUsIF92ZXJzaW9uLCBfaWQgPSBfcGFyc2VfcmVsZWFzZV9maWxlKGZpcnN0bGluZSkKCiAgICBpZiBfZGlzdG5hbWUgYW5kIGZ1bGxfZGlzdHJpYnV0aW9uX25hbWU6CiAgICAgICAgZGlzdG5hbWUgPSBfZGlzdG5hbWUKICAgIGlmIF92ZXJzaW9uOgogICAgICAgIHZlcnNpb24gPSBfdmVyc2lvbgogICAgaWYgX2lkOgogICAgICAgIGlkID0gX2lkCiAgICByZXR1cm4gZGlzdG5hbWUsIHZlcnNpb24sIGlkCgojIFRvIG1haW50YWluIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5OgoKZGVmIGRpc3QoZGlzdG5hbWU9JycsdmVyc2lvbj0nJyxpZD0nJywKCiAgICAgICAgIHN1cHBvcnRlZF9kaXN0cz1fc3VwcG9ydGVkX2Rpc3RzKToKCiAgICAiIiIgVHJpZXMgdG8gZGV0ZXJtaW5lIHRoZSBuYW1lIG9mIHRoZSBMaW51eCBPUyBkaXN0cmlidXRpb24gbmFtZS4KCiAgICAgICAgVGhlIGZ1bmN0aW9uIGZpcnN0IGxvb2tzIGZvciBhIGRpc3RyaWJ1dGlvbiByZWxlYXNlIGZpbGUgaW4KICAgICAgICAvZXRjIGFuZCB0aGVuIHJldmVydHMgdG8gX2Rpc3RfdHJ5X2hhcmRlcigpIGluIGNhc2Ugbm8KICAgICAgICBzdWl0YWJsZSBmaWxlcyBhcmUgZm91bmQuCgogICAgICAgIFJldHVybnMgYSB0dXBsZSAoZGlzdG5hbWUsdmVyc2lvbixpZCkgd2hpY2ggZGVmYXVsdCB0byB0aGUKICAgICAgICBhcmdzIGdpdmVuIGFzIHBhcmFtZXRlcnMuCgogICAgIiIiCiAgICByZXR1cm4gbGludXhfZGlzdHJpYnV0aW9uKGRpc3RuYW1lLCB2ZXJzaW9uLCBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VwcG9ydGVkX2Rpc3RzPXN1cHBvcnRlZF9kaXN0cywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbF9kaXN0cmlidXRpb25fbmFtZT0wKQoKZGVmIHBvcGVuKGNtZCwgbW9kZT0ncicsIGJ1ZnNpemU9LTEpOgoKICAgICIiIiBQb3J0YWJsZSBwb3BlbigpIGludGVyZmFjZS4KICAgICIiIgogICAgaW1wb3J0IHdhcm5pbmdzCiAgICB3YXJuaW5ncy53YXJuKCd1c2Ugb3MucG9wZW4gaW5zdGVhZCcsIERlcHJlY2F0aW9uV2FybmluZywgc3RhY2tsZXZlbD0yKQogICAgcmV0dXJuIG9zLnBvcGVuKGNtZCwgbW9kZSwgYnVmc2l6ZSkKCmRlZiBfbm9ybV92ZXJzaW9uKHZlcnNpb24sIGJ1aWxkPScnKToKCiAgICAiIiIgTm9ybWFsaXplIHRoZSB2ZXJzaW9uIGFuZCBidWlsZCBzdHJpbmdzIGFuZCByZXR1cm4gYSBzaW5nbGUKICAgICAgICB2ZXJzaW9uIHN0cmluZyB1c2luZyB0aGUgZm9ybWF0IG1ham9yLm1pbm9yLmJ1aWxkIChvciBwYXRjaGxldmVsKS4KICAgICIiIgogICAgbCA9IHZlcnNpb24uc3BsaXQoJy4nKQogICAgaWYgYnVpbGQ6CiAgICAgICAgbC5hcHBlbmQoYnVpbGQpCiAgICB0cnk6CiAgICAgICAgaW50cyA9IG1hcChpbnQsbCkKICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgIHN0cmluZ3MgPSBsCiAgICBlbHNlOgogICAgICAgIHN0cmluZ3MgPSBsaXN0KG1hcChzdHIsaW50cykpCiAgICB2ZXJzaW9uID0gJy4nLmpvaW4oc3RyaW5nc1s6M10pCiAgICByZXR1cm4gdmVyc2lvbgoKX3Zlcl9vdXRwdXQgPSByZS5jb21waWxlKHInKD86KFtcdyBdKykgKFtcdy5dKykgJwogICAgICAgICAgICAgICAgICAgICAgICAgJy4qJwogICAgICAgICAgICAgICAgICAgICAgICAgJ1xbLiogKFtcZC5dKylcXSknKQoKIyBFeGFtcGxlcyBvZiBWRVIgY29tbWFuZCBvdXRwdXQ6CiMKIyAgIFdpbmRvd3MgMjAwMDogIE1pY3Jvc29mdCBXaW5kb3dzIDIwMDAgW1ZlcnNpb24gNS4wMC4yMTk1XQojICAgV2luZG93cyBYUDogICAgTWljcm9zb2Z0IFdpbmRvd3MgWFAgW1ZlcnNpb24gNS4xLjI2MDBdCiMgICBXaW5kb3dzIFZpc3RhOiBNaWNyb3NvZnQgV2luZG93cyBbVmVyc2lvbiA2LjAuNjAwMl0KIwojIE5vdGUgdGhhdCB0aGUgIlZlcnNpb24iIHN0cmluZyBnZXRzIGxvY2FsaXplZCBvbiBkaWZmZXJlbnQKIyBXaW5kb3dzIHZlcnNpb25zLgoKZGVmIF9zeXNjbWRfdmVyKHN5c3RlbT0nJywgcmVsZWFzZT0nJywgdmVyc2lvbj0nJywKCiAgICAgICAgICAgICAgIHN1cHBvcnRlZF9wbGF0Zm9ybXM9KCd3aW4zMicsJ3dpbjE2JywnZG9zJywnb3MyJykpOgoKICAgICIiIiBUcmllcyB0byBmaWd1cmUgb3V0IHRoZSBPUyB2ZXJzaW9uIHVzZWQgYW5kIHJldHVybnMKICAgICAgICBhIHR1cGxlIChzeXN0ZW0scmVsZWFzZSx2ZXJzaW9uKS4KCiAgICAgICAgSXQgdXNlcyB0aGUgInZlciIgc2hlbGwgY29tbWFuZCBmb3IgdGhpcyB3aGljaCBpcyBrbm93bgogICAgICAgIHRvIGV4aXN0cyBvbiBXaW5kb3dzLCBET1MgYW5kIE9TLzIuIFhYWCBPdGhlcnMgdG9vID8KCiAgICAgICAgSW4gY2FzZSB0aGlzIGZhaWxzLCB0aGUgZ2l2ZW4gcGFyYW1ldGVycyBhcmUgdXNlZCBhcwogICAgICAgIGRlZmF1bHRzLgoKICAgICIiIgogICAgaWYgc3lzLnBsYXRmb3JtIG5vdCBpbiBzdXBwb3J0ZWRfcGxhdGZvcm1zOgogICAgICAgIHJldHVybiBzeXN0ZW0scmVsZWFzZSx2ZXJzaW9uCgogICAgIyBUcnkgc29tZSBjb21tb24gY21kIHN0cmluZ3MKICAgIGZvciBjbWQgaW4gKCd2ZXInLCdjb21tYW5kIC9jIHZlcicsJ2NtZCAvYyB2ZXInKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHBpcGUgPSBwb3BlbihjbWQpCiAgICAgICAgICAgIGluZm8gPSBwaXBlLnJlYWQoKQogICAgICAgICAgICBpZiBwaXBlLmNsb3NlKCk6CiAgICAgICAgICAgICAgICByYWlzZSBvcy5lcnJvcignY29tbWFuZCBmYWlsZWQnKQogICAgICAgICAgICAjIFhYWCBIb3cgY2FuIEkgc3VwcHJlc3Mgc2hlbGwgZXJyb3JzIGZyb20gYmVpbmcgd3JpdHRlbgogICAgICAgICAgICAjICAgICB0byBzdGRlcnIgPwogICAgICAgIGV4Y2VwdCBvcy5lcnJvciBhcyB3aHk6CiAgICAgICAgICAgICNwcmludCAnQ29tbWFuZCAlcyBmYWlsZWQ6ICVzJyAlIChjbWQsd2h5KQogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGV4Y2VwdCBJT0Vycm9yIGFzIHdoeToKICAgICAgICAgICAgI3ByaW50ICdDb21tYW5kICVzIGZhaWxlZDogJXMnICUgKGNtZCx3aHkpCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYnJlYWsKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIHN5c3RlbSxyZWxlYXNlLHZlcnNpb24KCiAgICAjIFBhcnNlIHRoZSBvdXRwdXQKICAgIGluZm8gPSBpbmZvLnN0cmlwKCkKICAgIG0gPSBfdmVyX291dHB1dC5tYXRjaChpbmZvKQogICAgaWYgbSBpcyBub3QgTm9uZToKICAgICAgICBzeXN0ZW0scmVsZWFzZSx2ZXJzaW9uID0gbS5ncm91cHMoKQogICAgICAgICMgU3RyaXAgdHJhaWxpbmcgZG90cyBmcm9tIHZlcnNpb24gYW5kIHJlbGVhc2UKICAgICAgICBpZiByZWxlYXNlWy0xXSA9PSAnLic6CiAgICAgICAgICAgIHJlbGVhc2UgPSByZWxlYXNlWzotMV0KICAgICAgICBpZiB2ZXJzaW9uWy0xXSA9PSAnLic6CiAgICAgICAgICAgIHZlcnNpb24gPSB2ZXJzaW9uWzotMV0KICAgICAgICAjIE5vcm1hbGl6ZSB0aGUgdmVyc2lvbiBhbmQgYnVpbGQgc3RyaW5ncyAoZWxpbWluYXRpbmcgYWRkaXRpb25hbAogICAgICAgICMgemVyb3MpCiAgICAgICAgdmVyc2lvbiA9IF9ub3JtX3ZlcnNpb24odmVyc2lvbikKICAgIHJldHVybiBzeXN0ZW0scmVsZWFzZSx2ZXJzaW9uCgpkZWYgX3dpbjMyX2dldHZhbHVlKGtleSxuYW1lLGRlZmF1bHQ9JycpOgoKICAgICIiIiBSZWFkIGEgdmFsdWUgZm9yIG5hbWUgZnJvbSB0aGUgcmVnaXN0cnkga2V5LgoKICAgICAgICBJbiBjYXNlIHRoaXMgZmFpbHMsIGRlZmF1bHQgaXMgcmV0dXJuZWQuCgogICAgIiIiCiAgICB0cnk6CiAgICAgICAgIyBVc2Ugd2luMzJhcGkgaWYgYXZhaWxhYmxlCiAgICAgICAgZnJvbSB3aW4zMmFwaSBpbXBvcnQgUmVnUXVlcnlWYWx1ZUV4CiAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgIyBPbiBQeXRob24gMi4wIGFuZCBsYXRlciwgZW11bGF0ZSB1c2luZyB3aW5yZWcKICAgICAgICBpbXBvcnQgd2lucmVnCiAgICAgICAgUmVnUXVlcnlWYWx1ZUV4ID0gd2lucmVnLlF1ZXJ5VmFsdWVFeAogICAgdHJ5OgogICAgICAgIHJldHVybiBSZWdRdWVyeVZhbHVlRXgoa2V5LG5hbWUpCiAgICBleGNlcHQ6CiAgICAgICAgcmV0dXJuIGRlZmF1bHQKCmRlZiB3aW4zMl92ZXIocmVsZWFzZT0nJyx2ZXJzaW9uPScnLGNzZD0nJyxwdHlwZT0nJyk6CgogICAgIiIiIEdldCBhZGRpdGlvbmFsIHZlcnNpb24gaW5mb3JtYXRpb24gZnJvbSB0aGUgV2luZG93cyBSZWdpc3RyeQogICAgICAgIGFuZCByZXR1cm4gYSB0dXBsZSAodmVyc2lvbixjc2QscHR5cGUpIHJlZmVycmluZyB0byB2ZXJzaW9uCiAgICAgICAgbnVtYmVyLCBDU0QgbGV2ZWwgKHNlcnZpY2UgcGFjayksIGFuZCBPUyB0eXBlIChtdWx0aS9zaW5nbGUKICAgICAgICBwcm9jZXNzb3IpLgoKICAgICAgICBBcyBhIGhpbnQ6IHB0eXBlIHJldHVybnMgJ1VuaXByb2Nlc3NvciBGcmVlJyBvbiBzaW5nbGUKICAgICAgICBwcm9jZXNzb3IgTlQgbWFjaGluZXMgYW5kICdNdWx0aXByb2Nlc3NvciBGcmVlJyBvbiBtdWx0aQogICAgICAgIHByb2Nlc3NvciBtYWNoaW5lcy4gVGhlICdGcmVlJyByZWZlcnMgdG8gdGhlIE9TIHZlcnNpb24gYmVpbmcKICAgICAgICBmcmVlIG9mIGRlYnVnZ2luZyBjb2RlLiBJdCBjb3VsZCBhbHNvIHN0YXRlICdDaGVja2VkJyB3aGljaAogICAgICAgIG1lYW5zIHRoZSBPUyB2ZXJzaW9uIHVzZXMgZGVidWdnaW5nIGNvZGUsIGkuZS4gY29kZSB0aGF0CiAgICAgICAgY2hlY2tzIGFyZ3VtZW50cywgcmFuZ2VzLCBldGMuIChUaG9tYXMgSGVsbGVyKS4KCiAgICAgICAgTm90ZTogdGhpcyBmdW5jdGlvbiB3b3JrcyBiZXN0IHdpdGggTWFyayBIYW1tb25kJ3Mgd2luMzIKICAgICAgICBwYWNrYWdlIGluc3RhbGxlZCwgYnV0IGFsc28gb24gUHl0aG9uIDIuMyBhbmQgbGF0ZXIuIEl0CiAgICAgICAgb2J2aW91c2x5IG9ubHkgcnVucyBvbiBXaW4zMiBjb21wYXRpYmxlIHBsYXRmb3Jtcy4KCiAgICAiIiIKICAgICMgWFhYIElzIHRoZXJlIGFueSB3YXkgdG8gZmluZCBvdXQgdGhlIHByb2Nlc3NvciB0eXBlIG9uIFdpblhYID8KICAgICMgWFhYIElzIHdpbjMyIGF2YWlsYWJsZSBvbiBXaW5kb3dzIENFID8KICAgICMKICAgICMgQWRhcHRlZCBmcm9tIGNvZGUgcG9zdGVkIGJ5IEthcmwgUHV0bGFuZCB0byBjb21wLmxhbmcucHl0aG9uLgogICAgIwogICAgIyBUaGUgbWFwcGluZ3MgYmV0d2VlbiByZWcuIHZhbHVlcyBhbmQgcmVsZWFzZSBuYW1lcyBjYW4gYmUgZm91bmQKICAgICMgaGVyZTogaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9saWJyYXJ5L2VuLXVzL3N5c2luZm8vYmFzZS9vc3ZlcnNpb25pbmZvX3N0ci5hc3AKCiAgICAjIEltcG9ydCB0aGUgbmVlZGVkIEFQSXMKICAgIHRyeToKICAgICAgICBpbXBvcnQgd2luMzJhcGkKICAgICAgICBmcm9tIHdpbjMyYXBpIGltcG9ydCBSZWdRdWVyeVZhbHVlRXgsIFJlZ09wZW5LZXlFeCwgXAogICAgICAgICAgICAgUmVnQ2xvc2VLZXksIEdldFZlcnNpb25FeAogICAgICAgIGZyb20gd2luMzJjb24gaW1wb3J0IEhLRVlfTE9DQUxfTUFDSElORSwgVkVSX1BMQVRGT1JNX1dJTjMyX05ULCBcCiAgICAgICAgICAgICBWRVJfUExBVEZPUk1fV0lOMzJfV0lORE9XUywgVkVSX05UX1dPUktTVEFUSU9OCiAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgIyBFbXVsYXRlIHRoZSB3aW4zMmFwaSBtb2R1bGUgdXNpbmcgUHl0aG9uIEFQSXMKICAgICAgICB0cnk6CiAgICAgICAgICAgIHN5cy5nZXR3aW5kb3dzdmVyc2lvbgogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgIyBObyBlbXVsYXRpb24gcG9zc2libGUsIHNvIHJldHVybiB0aGUgZGVmYXVsdHMuLi4KICAgICAgICAgICAgcmV0dXJuIHJlbGVhc2UsdmVyc2lvbixjc2QscHR5cGUKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIEVtdWxhdGlvbiB1c2luZyB3aW5yZWcgKGFkZGVkIGluIFB5dGhvbiAyLjApIGFuZAogICAgICAgICAgICAjIHN5cy5nZXR3aW5kb3dzdmVyc2lvbigpIChhZGRlZCBpbiBQeXRob24gMi4zKQogICAgICAgICAgICBpbXBvcnQgd2lucmVnCiAgICAgICAgICAgIEdldFZlcnNpb25FeCA9IHN5cy5nZXR3aW5kb3dzdmVyc2lvbgogICAgICAgICAgICBSZWdRdWVyeVZhbHVlRXggPSB3aW5yZWcuUXVlcnlWYWx1ZUV4CiAgICAgICAgICAgIFJlZ09wZW5LZXlFeCA9IHdpbnJlZy5PcGVuS2V5RXgKICAgICAgICAgICAgUmVnQ2xvc2VLZXkgPSB3aW5yZWcuQ2xvc2VLZXkKICAgICAgICAgICAgSEtFWV9MT0NBTF9NQUNISU5FID0gd2lucmVnLkhLRVlfTE9DQUxfTUFDSElORQogICAgICAgICAgICBWRVJfUExBVEZPUk1fV0lOMzJfV0lORE9XUyA9IDEKICAgICAgICAgICAgVkVSX1BMQVRGT1JNX1dJTjMyX05UID0gMgogICAgICAgICAgICBWRVJfTlRfV09SS1NUQVRJT04gPSAxCiAgICAgICAgICAgIFZFUl9OVF9TRVJWRVIgPSAzCiAgICAgICAgICAgIFJFR19TWiA9IDEKCiAgICAjIEZpbmQgb3V0IHRoZSByZWdpc3RyeSBrZXkgYW5kIHNvbWUgZ2VuZXJhbCB2ZXJzaW9uIGluZm9zCiAgICB3aW52ZXIgPSBHZXRWZXJzaW9uRXgoKQogICAgbWFqLG1pbixidWlsZG5vLHBsYXQsY3NkID0gd2ludmVyCiAgICB2ZXJzaW9uID0gJyVpLiVpLiVpJyAlIChtYWosbWluLGJ1aWxkbm8gJiAweEZGRkYpCiAgICBpZiBoYXNhdHRyKHdpbnZlciwgInNlcnZpY2VfcGFjayIpOgogICAgICAgIGlmIHdpbnZlci5zZXJ2aWNlX3BhY2sgIT0gIiI6CiAgICAgICAgICAgIGNzZCA9ICdTUCVzJyAlIHdpbnZlci5zZXJ2aWNlX3BhY2tfbWFqb3IKICAgIGVsc2U6CiAgICAgICAgaWYgY3NkWzoxM10gPT0gJ1NlcnZpY2UgUGFjayAnOgogICAgICAgICAgICBjc2QgPSAnU1AnICsgY3NkWzEzOl0KCiAgICBpZiBwbGF0ID09IFZFUl9QTEFURk9STV9XSU4zMl9XSU5ET1dTOgogICAgICAgIHJlZ2tleSA9ICdTT0ZUV0FSRVxcTWljcm9zb2Z0XFxXaW5kb3dzXFxDdXJyZW50VmVyc2lvbicKICAgICAgICAjIFRyeSB0byBndWVzcyB0aGUgcmVsZWFzZSBuYW1lCiAgICAgICAgaWYgbWFqID09IDQ6CiAgICAgICAgICAgIGlmIG1pbiA9PSAwOgogICAgICAgICAgICAgICAgcmVsZWFzZSA9ICc5NScKICAgICAgICAgICAgZWxpZiBtaW4gPT0gMTA6CiAgICAgICAgICAgICAgICByZWxlYXNlID0gJzk4JwogICAgICAgICAgICBlbGlmIG1pbiA9PSA5MDoKICAgICAgICAgICAgICAgIHJlbGVhc2UgPSAnTWUnCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZWxlYXNlID0gJ3Bvc3RNZScKICAgICAgICBlbGlmIG1haiA9PSA1OgogICAgICAgICAgICByZWxlYXNlID0gJzIwMDAnCgogICAgZWxpZiBwbGF0ID09IFZFUl9QTEFURk9STV9XSU4zMl9OVDoKICAgICAgICByZWdrZXkgPSAnU09GVFdBUkVcXE1pY3Jvc29mdFxcV2luZG93cyBOVFxcQ3VycmVudFZlcnNpb24nCiAgICAgICAgaWYgbWFqIDw9IDQ6CiAgICAgICAgICAgIHJlbGVhc2UgPSAnTlQnCiAgICAgICAgZWxpZiBtYWogPT0gNToKICAgICAgICAgICAgaWYgbWluID09IDA6CiAgICAgICAgICAgICAgICByZWxlYXNlID0gJzIwMDAnCiAgICAgICAgICAgIGVsaWYgbWluID09IDE6CiAgICAgICAgICAgICAgICByZWxlYXNlID0gJ1hQJwogICAgICAgICAgICBlbGlmIG1pbiA9PSAyOgogICAgICAgICAgICAgICAgcmVsZWFzZSA9ICcyMDAzU2VydmVyJwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmVsZWFzZSA9ICdwb3N0MjAwMycKICAgICAgICBlbGlmIG1haiA9PSA2OgogICAgICAgICAgICBpZiBoYXNhdHRyKHdpbnZlciwgInByb2R1Y3RfdHlwZSIpOgogICAgICAgICAgICAgICAgcHJvZHVjdF90eXBlID0gd2ludmVyLnByb2R1Y3RfdHlwZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJvZHVjdF90eXBlID0gVkVSX05UX1dPUktTVEFUSU9OCiAgICAgICAgICAgICAgICAjIFdpdGhvdXQgYW4gT1NWRVJTSU9OSU5GT0VYIGNhcGFibGUgc3lzLmdldHdpbmRvd3N2ZXJzaW9uKCksCiAgICAgICAgICAgICAgICAjIG9yIGhlbHAgZnJvbSB0aGUgcmVnaXN0cnksIHdlIGNhbm5vdCBwcm9wZXJseSBpZGVudGlmeQogICAgICAgICAgICAgICAgIyBub24td29ya3N0YXRpb24gdmVyc2lvbnMuCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAga2V5ID0gUmVnT3BlbktleUV4KEhLRVlfTE9DQUxfTUFDSElORSwgcmVna2V5KQogICAgICAgICAgICAgICAgICAgIG5hbWUsIHR5cGUgPSBSZWdRdWVyeVZhbHVlRXgoa2V5LCAiUHJvZHVjdE5hbWUiKQogICAgICAgICAgICAgICAgICAgICMgRGlzY2FyZCBhbnkgdHlwZSB0aGF0IGlzbid0IFJFR19TWgogICAgICAgICAgICAgICAgICAgIGlmIHR5cGUgPT0gUkVHX1NaIGFuZCBuYW1lLmZpbmQoIlNlcnZlciIpICE9IC0xOgogICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0X3R5cGUgPSBWRVJfTlRfU0VSVkVSCiAgICAgICAgICAgICAgICBleGNlcHQgV2luZG93c0Vycm9yOgogICAgICAgICAgICAgICAgICAgICMgVXNlIGRlZmF1bHQgb2YgVkVSX05UX1dPUktTVEFUSU9OCiAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICAgICAgaWYgbWluID09IDA6CiAgICAgICAgICAgICAgICBpZiBwcm9kdWN0X3R5cGUgPT0gVkVSX05UX1dPUktTVEFUSU9OOgogICAgICAgICAgICAgICAgICAgIHJlbGVhc2UgPSAnVmlzdGEnCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHJlbGVhc2UgPSAnMjAwOFNlcnZlcicKICAgICAgICAgICAgZWxpZiBtaW4gPT0gMToKICAgICAgICAgICAgICAgIGlmIHByb2R1Y3RfdHlwZSA9PSBWRVJfTlRfV09SS1NUQVRJT046CiAgICAgICAgICAgICAgICAgICAgcmVsZWFzZSA9ICc3JwogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICByZWxlYXNlID0gJzIwMDhTZXJ2ZXJSMicKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJlbGVhc2UgPSAncG9zdDIwMDhTZXJ2ZXInCgogICAgZWxzZToKICAgICAgICBpZiBub3QgcmVsZWFzZToKICAgICAgICAgICAgIyBFLmcuIFdpbjMuMSB3aXRoIHdpbjMycwogICAgICAgICAgICByZWxlYXNlID0gJyVpLiVpJyAlIChtYWosbWluKQogICAgICAgIHJldHVybiByZWxlYXNlLHZlcnNpb24sY3NkLHB0eXBlCgogICAgIyBPcGVuIHRoZSByZWdpc3RyeSBrZXkKICAgIHRyeToKICAgICAgICBrZXlDdXJWZXIgPSBSZWdPcGVuS2V5RXgoSEtFWV9MT0NBTF9NQUNISU5FLCByZWdrZXkpCiAgICAgICAgIyBHZXQgYSB2YWx1ZSB0byBtYWtlIHN1cmUgdGhlIGtleSBleGlzdHMuLi4KICAgICAgICBSZWdRdWVyeVZhbHVlRXgoa2V5Q3VyVmVyLCAnU3lzdGVtUm9vdCcpCiAgICBleGNlcHQ6CiAgICAgICAgcmV0dXJuIHJlbGVhc2UsdmVyc2lvbixjc2QscHR5cGUKCiAgICAjIFBhcnNlIHZhbHVlcwogICAgI3N1YnZlcnNpb24gPSBfd2luMzJfZ2V0dmFsdWUoa2V5Q3VyVmVyLAogICAgIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAnU3ViVmVyc2lvbk51bWJlcicsCiAgICAjICAgICAgICAgICAgICAgICAgICAgICAgICAgICgnJywxKSlbMF0KICAgICNpZiBzdWJ2ZXJzaW9uOgogICAgIyAgIHJlbGVhc2UgPSByZWxlYXNlICsgc3VidmVyc2lvbiAjIDk1YSwgOTViLCBldGMuCiAgICBidWlsZCA9IF93aW4zMl9nZXR2YWx1ZShrZXlDdXJWZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ3VycmVudEJ1aWxkTnVtYmVyJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICgnJywxKSlbMF0KICAgIHB0eXBlID0gX3dpbjMyX2dldHZhbHVlKGtleUN1clZlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0N1cnJlbnRUeXBlJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgKHB0eXBlLDEpKVswXQoKICAgICMgTm9ybWFsaXplIHZlcnNpb24KICAgIHZlcnNpb24gPSBfbm9ybV92ZXJzaW9uKHZlcnNpb24sYnVpbGQpCgogICAgIyBDbG9zZSBrZXkKICAgIFJlZ0Nsb3NlS2V5KGtleUN1clZlcikKICAgIHJldHVybiByZWxlYXNlLHZlcnNpb24sY3NkLHB0eXBlCgpkZWYgX21hY192ZXJfbG9va3VwKHNlbGVjdG9ycyxkZWZhdWx0PU5vbmUpOgoKICAgIGZyb20gX2dlc3RhbHQgaW1wb3J0IGdlc3RhbHQKICAgIGwgPSBbXQogICAgYXBwZW5kID0gbC5hcHBlbmQKICAgIGZvciBzZWxlY3RvciBpbiBzZWxlY3RvcnM6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBhcHBlbmQoZ2VzdGFsdChzZWxlY3RvcikpCiAgICAgICAgZXhjZXB0IChSdW50aW1lRXJyb3IsIE9TRXJyb3IpOgogICAgICAgICAgICBhcHBlbmQoZGVmYXVsdCkKICAgIHJldHVybiBsCgpkZWYgX2JjZDJzdHIoYmNkKToKCiAgICByZXR1cm4gaGV4KGJjZClbMjpdCgpkZWYgX21hY192ZXJfZ2VzdGFsdCgpOgogICAgIiIiCiAgICAgICAgVGhhbmtzIHRvIE1hcmsgUi4gTGV2aW5zb24gZm9yIG1haWxpbmcgZG9jdW1lbnRhdGlvbiBsaW5rcyBhbmQKICAgICAgICBjb2RlIGV4YW1wbGVzIGZvciB0aGlzIGZ1bmN0aW9uLiBEb2N1bWVudGF0aW9uIGZvciB0aGUKICAgICAgICBnZXN0YWx0KCkgQVBJIGlzIGF2YWlsYWJsZSBvbmxpbmUgYXQ6CgogICAgICAgICAgIGh0dHA6Ly93d3cucmdhcm9zLm5sL2dlc3RhbHQvCiAgICAiIiIKICAgICMgQ2hlY2sgd2hldGhlciB0aGUgdmVyc2lvbiBpbmZvIG1vZHVsZSBpcyBhdmFpbGFibGUKICAgIHRyeToKICAgICAgICBpbXBvcnQgX2dlc3RhbHQKICAgIGV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgICAgICByZXR1cm4gTm9uZQogICAgIyBHZXQgdGhlIGluZm9zCiAgICBzeXN2LCBzeXNhID0gX21hY192ZXJfbG9va3VwKCgnc3lzdicsJ3N5c2EnKSkKICAgICMgRGVjb2RlIHRoZSBpbmZvcwogICAgaWYgc3lzdjoKICAgICAgICBtYWpvciA9IChzeXN2ICYgMHhGRjAwKSA+PiA4CiAgICAgICAgbWlub3IgPSAoc3lzdiAmIDB4MDBGMCkgPj4gNAogICAgICAgIHBhdGNoID0gKHN5c3YgJiAweDAwMEYpCgogICAgICAgIGlmIChtYWpvciwgbWlub3IpID49ICgxMCwgNCk6CiAgICAgICAgICAgICMgdGhlICdzeXN2JyBnZXN0YWxkIGNhbm5vdCByZXR1cm4gcGF0Y2hsZXZlbHMKICAgICAgICAgICAgIyBoaWdoZXIgdGhhbiA5LiBBcHBsZSBpbnRyb2R1Y2VkIDMgbmV3CiAgICAgICAgICAgICMgZ2VzdGFsdCBjb2RlcyBpbiAxMC40IHRvIGRlYWwgd2l0aCB0aGlzCiAgICAgICAgICAgICMgaXNzdWUgKG5lZWRlZCBiZWNhdXNlIHBhdGNoIGxldmVscyBjYW4KICAgICAgICAgICAgIyBydW4gaGlnaGVyIHRoYW4gOSwgc3VjaCBhcyAxMC40LjExKQogICAgICAgICAgICBtYWpvcixtaW5vcixwYXRjaCA9IF9tYWNfdmVyX2xvb2t1cCgoJ3N5czEnLCdzeXMyJywnc3lzMycpKQogICAgICAgICAgICByZWxlYXNlID0gJyVpLiVpLiVpJyAlKG1ham9yLCBtaW5vciwgcGF0Y2gpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmVsZWFzZSA9ICclcy4laS4laScgJSAoX2JjZDJzdHIobWFqb3IpLG1pbm9yLHBhdGNoKQoKICAgIGlmIHN5c2E6CiAgICAgICAgbWFjaGluZSA9IHsweDE6ICc2OGsnLAogICAgICAgICAgICAgICAgICAgMHgyOiAnUG93ZXJQQycsCiAgICAgICAgICAgICAgICAgICAweGE6ICdpMzg2J30uZ2V0KHN5c2EsJycpCgogICAgdmVyc2lvbmluZm89KCcnLCAnJywgJycpCiAgICByZXR1cm4gcmVsZWFzZSx2ZXJzaW9uaW5mbyxtYWNoaW5lCgpkZWYgX21hY192ZXJfeG1sKCk6CiAgICBmbiA9ICcvU3lzdGVtL0xpYnJhcnkvQ29yZVNlcnZpY2VzL1N5c3RlbVZlcnNpb24ucGxpc3QnCiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoZm4pOgogICAgICAgIHJldHVybiBOb25lCgogICAgdHJ5OgogICAgICAgIGltcG9ydCBwbGlzdGxpYgogICAgZXhjZXB0IEltcG9ydEVycm9yOgogICAgICAgIHJldHVybiBOb25lCgogICAgcGwgPSBwbGlzdGxpYi5yZWFkUGxpc3QoZm4pCiAgICByZWxlYXNlID0gcGxbJ1Byb2R1Y3RWZXJzaW9uJ10KICAgIHZlcnNpb25pbmZvPSgnJywgJycsICcnKQogICAgbWFjaGluZSA9IG9zLnVuYW1lKCkubWFjaGluZQogICAgaWYgbWFjaGluZSBpbiAoJ3BwYycsICdQb3dlciBNYWNpbnRvc2gnKToKICAgICAgICAjIGZvciBjb21wYXRpYmlsaXR5IHdpdGggdGhlIGdlc3RhbHQgYmFzZWQgY29kZQogICAgICAgIG1hY2hpbmUgPSAnUG93ZXJQQycKCiAgICByZXR1cm4gcmVsZWFzZSx2ZXJzaW9uaW5mbyxtYWNoaW5lCgoKZGVmIG1hY192ZXIocmVsZWFzZT0nJyx2ZXJzaW9uaW5mbz0oJycsJycsJycpLG1hY2hpbmU9JycpOgoKICAgICIiIiBHZXQgTWFjT1MgdmVyc2lvbiBpbmZvcm1hdGlvbiBhbmQgcmV0dXJuIGl0IGFzIHR1cGxlIChyZWxlYXNlLAogICAgICAgIHZlcnNpb25pbmZvLCBtYWNoaW5lKSB3aXRoIHZlcnNpb25pbmZvIGJlaW5nIGEgdHVwbGUgKHZlcnNpb24sCiAgICAgICAgZGV2X3N0YWdlLCBub25fcmVsZWFzZV92ZXJzaW9uKS4KCiAgICAgICAgRW50cmllcyB3aGljaCBjYW5ub3QgYmUgZGV0ZXJtaW5lZCBhcmUgc2V0IHRvIHRoZSBwYXJhbXRlciB2YWx1ZXMKICAgICAgICB3aGljaCBkZWZhdWx0IHRvICcnLiBBbGwgdHVwbGUgZW50cmllcyBhcmUgc3RyaW5ncy4KICAgICIiIgoKICAgICMgRmlyc3QgdHJ5IHJlYWRpbmcgdGhlIGluZm9ybWF0aW9uIGZyb20gYW4gWE1MIGZpbGUgd2hpY2ggc2hvdWxkCiAgICAjIGFsd2F5cyBiZSBwcmVzZW50CiAgICBpbmZvID0gX21hY192ZXJfeG1sKCkKICAgIGlmIGluZm8gaXMgbm90IE5vbmU6CiAgICAgICAgcmV0dXJuIGluZm8KCiAgICAjIElmIHRoYXQgZG9lc24ndCB3b3JrIGZvciBzb21lIHJlYXNvbiBmYWxsIGJhY2sgdG8gcmVhZGluZyB0aGUKICAgICMgaW5mb3JtYXRpb24gdXNpbmcgZ2VzdGFsdCBjYWxscy4KICAgIGluZm8gPSBfbWFjX3Zlcl9nZXN0YWx0KCkKICAgIGlmIGluZm8gaXMgbm90IE5vbmU6CiAgICAgICAgcmV0dXJuIGluZm8KCiAgICAjIElmIHRoYXQgYWxzbyBkb2Vzbid0IHdvcmsgcmV0dXJuIHRoZSBkZWZhdWx0IHZhbHVlcwogICAgcmV0dXJuIHJlbGVhc2UsdmVyc2lvbmluZm8sbWFjaGluZQoKZGVmIF9qYXZhX2dldHByb3AobmFtZSxkZWZhdWx0KToKCiAgICBmcm9tIGphdmEubGFuZyBpbXBvcnQgU3lzdGVtCiAgICB0cnk6CiAgICAgICAgdmFsdWUgPSBTeXN0ZW0uZ2V0UHJvcGVydHkobmFtZSkKICAgICAgICBpZiB2YWx1ZSBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gZGVmYXVsdAogICAgICAgIHJldHVybiB2YWx1ZQogICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgIHJldHVybiBkZWZhdWx0CgpkZWYgamF2YV92ZXIocmVsZWFzZT0nJyx2ZW5kb3I9Jycsdm1pbmZvPSgnJywnJywnJyksb3NpbmZvPSgnJywnJywnJykpOgoKICAgICIiIiBWZXJzaW9uIGludGVyZmFjZSBmb3IgSnl0aG9uLgoKICAgICAgICBSZXR1cm5zIGEgdHVwbGUgKHJlbGVhc2UsdmVuZG9yLHZtaW5mbyxvc2luZm8pIHdpdGggdm1pbmZvIGJlaW5nCiAgICAgICAgYSB0dXBsZSAodm1fbmFtZSx2bV9yZWxlYXNlLHZtX3ZlbmRvcikgYW5kIG9zaW5mbyBiZWluZyBhCiAgICAgICAgdHVwbGUgKG9zX25hbWUsb3NfdmVyc2lvbixvc19hcmNoKS4KCiAgICAgICAgVmFsdWVzIHdoaWNoIGNhbm5vdCBiZSBkZXRlcm1pbmVkIGFyZSBzZXQgdG8gdGhlIGRlZmF1bHRzCiAgICAgICAgZ2l2ZW4gYXMgcGFyYW1ldGVycyAod2hpY2ggYWxsIGRlZmF1bHQgdG8gJycpLgoKICAgICIiIgogICAgIyBJbXBvcnQgdGhlIG5lZWRlZCBBUElzCiAgICB0cnk6CiAgICAgICAgaW1wb3J0IGphdmEubGFuZwogICAgZXhjZXB0IEltcG9ydEVycm9yOgogICAgICAgIHJldHVybiByZWxlYXNlLHZlbmRvcix2bWluZm8sb3NpbmZvCgogICAgdmVuZG9yID0gX2phdmFfZ2V0cHJvcCgnamF2YS52ZW5kb3InLCB2ZW5kb3IpCiAgICByZWxlYXNlID0gX2phdmFfZ2V0cHJvcCgnamF2YS52ZXJzaW9uJywgcmVsZWFzZSkKICAgIHZtX25hbWUsIHZtX3JlbGVhc2UsIHZtX3ZlbmRvciA9IHZtaW5mbwogICAgdm1fbmFtZSA9IF9qYXZhX2dldHByb3AoJ2phdmEudm0ubmFtZScsIHZtX25hbWUpCiAgICB2bV92ZW5kb3IgPSBfamF2YV9nZXRwcm9wKCdqYXZhLnZtLnZlbmRvcicsIHZtX3ZlbmRvcikKICAgIHZtX3JlbGVhc2UgPSBfamF2YV9nZXRwcm9wKCdqYXZhLnZtLnZlcnNpb24nLCB2bV9yZWxlYXNlKQogICAgdm1pbmZvID0gdm1fbmFtZSwgdm1fcmVsZWFzZSwgdm1fdmVuZG9yCiAgICBvc19uYW1lLCBvc192ZXJzaW9uLCBvc19hcmNoID0gb3NpbmZvCiAgICBvc19hcmNoID0gX2phdmFfZ2V0cHJvcCgnamF2YS5vcy5hcmNoJywgb3NfYXJjaCkKICAgIG9zX25hbWUgPSBfamF2YV9nZXRwcm9wKCdqYXZhLm9zLm5hbWUnLCBvc19uYW1lKQogICAgb3NfdmVyc2lvbiA9IF9qYXZhX2dldHByb3AoJ2phdmEub3MudmVyc2lvbicsIG9zX3ZlcnNpb24pCiAgICBvc2luZm8gPSBvc19uYW1lLCBvc192ZXJzaW9uLCBvc19hcmNoCgogICAgcmV0dXJuIHJlbGVhc2UsIHZlbmRvciwgdm1pbmZvLCBvc2luZm8KCiMjIyBTeXN0ZW0gbmFtZSBhbGlhc2luZwoKZGVmIHN5c3RlbV9hbGlhcyhzeXN0ZW0scmVsZWFzZSx2ZXJzaW9uKToKCiAgICAiIiIgUmV0dXJucyAoc3lzdGVtLHJlbGVhc2UsdmVyc2lvbikgYWxpYXNlZCB0byBjb21tb24KICAgICAgICBtYXJrZXRpbmcgbmFtZXMgdXNlZCBmb3Igc29tZSBzeXN0ZW1zLgoKICAgICAgICBJdCBhbHNvIGRvZXMgc29tZSByZW9yZGVyaW5nIG9mIHRoZSBpbmZvcm1hdGlvbiBpbiBzb21lIGNhc2VzCiAgICAgICAgd2hlcmUgaXQgd291bGQgb3RoZXJ3aXNlIGNhdXNlIGNvbmZ1c2lvbi4KCiAgICAiIiIKICAgIGlmIHN5c3RlbSA9PSAnUmhhcHNvZHknOgogICAgICAgICMgQXBwbGUncyBCU0QgZGVyaXZhdGl2ZQogICAgICAgICMgWFhYIEhvdyBjYW4gd2UgZGV0ZXJtaW5lIHRoZSBtYXJrZXRpbmcgcmVsZWFzZSBudW1iZXIgPwogICAgICAgIHJldHVybiAnTWFjT1MgWCBTZXJ2ZXInLHN5c3RlbStyZWxlYXNlLHZlcnNpb24KCiAgICBlbGlmIHN5c3RlbSA9PSAnU3VuT1MnOgogICAgICAgICMgU3VuJ3MgT1MKICAgICAgICBpZiByZWxlYXNlIDwgJzUnOgogICAgICAgICAgICAjIFRoZXNlIHJlbGVhc2VzIHVzZSB0aGUgb2xkIG5hbWUgU3VuT1MKICAgICAgICAgICAgcmV0dXJuIHN5c3RlbSxyZWxlYXNlLHZlcnNpb24KICAgICAgICAjIE1vZGlmeSByZWxlYXNlIChtYXJrZXRpbmcgcmVsZWFzZSA9IFN1bk9TIHJlbGVhc2UgLSAzKQogICAgICAgIGwgPSByZWxlYXNlLnNwbGl0KCcuJykKICAgICAgICBpZiBsOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBtYWpvciA9IGludChsWzBdKQogICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG1ham9yID0gbWFqb3IgLSAzCiAgICAgICAgICAgICAgICBsWzBdID0gc3RyKG1ham9yKQogICAgICAgICAgICAgICAgcmVsZWFzZSA9ICcuJy5qb2luKGwpCiAgICAgICAgaWYgcmVsZWFzZSA8ICc2JzoKICAgICAgICAgICAgc3lzdGVtID0gJ1NvbGFyaXMnCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyBYWFggV2hhdGV2ZXIgdGhlIG5ldyBTdW5PUyBtYXJrZXRpbmcgbmFtZSBpcy4uLgogICAgICAgICAgICBzeXN0ZW0gPSAnU29sYXJpcycKCiAgICBlbGlmIHN5c3RlbSA9PSAnSVJJWDY0JzoKICAgICAgICAjIElSSVggcmVwb3J0cyBJUklYNjQgb24gcGxhdGZvcm1zIHdpdGggNjQtYml0IHN1cHBvcnQ7IHlldCBpdAogICAgICAgICMgaXMgcmVhbGx5IGEgdmVyc2lvbiBhbmQgbm90IGEgZGlmZmVyZW50IHBsYXRmb3JtLCBzaW5jZSAzMi1iaXQKICAgICAgICAjIGFwcHMgYXJlIGFsc28gc3VwcG9ydGVkLi4KICAgICAgICBzeXN0ZW0gPSAnSVJJWCcKICAgICAgICBpZiB2ZXJzaW9uOgogICAgICAgICAgICB2ZXJzaW9uID0gdmVyc2lvbiArICcgKDY0Yml0KScKICAgICAgICBlbHNlOgogICAgICAgICAgICB2ZXJzaW9uID0gJzY0Yml0JwoKICAgIGVsaWYgc3lzdGVtIGluICgnd2luMzInLCd3aW4xNicpOgogICAgICAgICMgSW4gY2FzZSBvbmUgb2YgdGhlIG90aGVyIHRyaWNrcwogICAgICAgIHN5c3RlbSA9ICdXaW5kb3dzJwoKICAgIHJldHVybiBzeXN0ZW0scmVsZWFzZSx2ZXJzaW9uCgojIyMgVmFyaW91cyBpbnRlcm5hbCBoZWxwZXJzCgpkZWYgX3BsYXRmb3JtKCphcmdzKToKCiAgICAiIiIgSGVscGVyIHRvIGZvcm1hdCB0aGUgcGxhdGZvcm0gc3RyaW5nIGluIGEgZmlsZW5hbWUKICAgICAgICBjb21wYXRpYmxlIGZvcm1hdCBlLmcuICJzeXN0ZW0tdmVyc2lvbi1tYWNoaW5lIi4KICAgICIiIgogICAgIyBGb3JtYXQgdGhlIHBsYXRmb3JtIHN0cmluZwogICAgcGxhdGZvcm0gPSAnLScuam9pbih4LnN0cmlwKCkgZm9yIHggaW4gZmlsdGVyKGxlbiwgYXJncykpCgogICAgIyBDbGVhbnVwIHNvbWUgcG9zc2libGUgZmlsZW5hbWUgb2JzdGFjbGVzLi4uCiAgICBwbGF0Zm9ybSA9IHBsYXRmb3JtLnJlcGxhY2UoJyAnLCdfJykKICAgIHBsYXRmb3JtID0gcGxhdGZvcm0ucmVwbGFjZSgnLycsJy0nKQogICAgcGxhdGZvcm0gPSBwbGF0Zm9ybS5yZXBsYWNlKCdcXCcsJy0nKQogICAgcGxhdGZvcm0gPSBwbGF0Zm9ybS5yZXBsYWNlKCc6JywnLScpCiAgICBwbGF0Zm9ybSA9IHBsYXRmb3JtLnJlcGxhY2UoJzsnLCctJykKICAgIHBsYXRmb3JtID0gcGxhdGZvcm0ucmVwbGFjZSgnIicsJy0nKQogICAgcGxhdGZvcm0gPSBwbGF0Zm9ybS5yZXBsYWNlKCcoJywnLScpCiAgICBwbGF0Zm9ybSA9IHBsYXRmb3JtLnJlcGxhY2UoJyknLCctJykKCiAgICAjIE5vIG5lZWQgdG8gcmVwb3J0ICd1bmtub3duJyBpbmZvcm1hdGlvbi4uLgogICAgcGxhdGZvcm0gPSBwbGF0Zm9ybS5yZXBsYWNlKCd1bmtub3duJywnJykKCiAgICAjIEZvbGQgJy0tJ3MgYW5kIHJlbW92ZSB0cmFpbGluZyAnLScKICAgIHdoaWxlIDE6CiAgICAgICAgY2xlYW5lZCA9IHBsYXRmb3JtLnJlcGxhY2UoJy0tJywnLScpCiAgICAgICAgaWYgY2xlYW5lZCA9PSBwbGF0Zm9ybToKICAgICAgICAgICAgYnJlYWsKICAgICAgICBwbGF0Zm9ybSA9IGNsZWFuZWQKICAgIHdoaWxlIHBsYXRmb3JtWy0xXSA9PSAnLSc6CiAgICAgICAgcGxhdGZvcm0gPSBwbGF0Zm9ybVs6LTFdCgogICAgcmV0dXJuIHBsYXRmb3JtCgpkZWYgX25vZGUoZGVmYXVsdD0nJyk6CgogICAgIiIiIEhlbHBlciB0byBkZXRlcm1pbmUgdGhlIG5vZGUgbmFtZSBvZiB0aGlzIG1hY2hpbmUuCiAgICAiIiIKICAgIHRyeToKICAgICAgICBpbXBvcnQgc29ja2V0CiAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgIyBObyBzb2NrZXRzLi4uCiAgICAgICAgcmV0dXJuIGRlZmF1bHQKICAgIHRyeToKICAgICAgICByZXR1cm4gc29ja2V0LmdldGhvc3RuYW1lKCkKICAgIGV4Y2VwdCBzb2NrZXQuZXJyb3I6CiAgICAgICAgIyBTdGlsbCBub3Qgd29ya2luZy4uLgogICAgICAgIHJldHVybiBkZWZhdWx0CgpkZWYgX2ZvbGxvd19zeW1saW5rcyhmaWxlcGF0aCk6CgogICAgIiIiIEluIGNhc2UgZmlsZXBhdGggaXMgYSBzeW1saW5rLCBmb2xsb3cgaXQgdW50aWwgYQogICAgICAgIHJlYWwgZmlsZSBpcyByZWFjaGVkLgogICAgIiIiCiAgICBmaWxlcGF0aCA9IG9zLnBhdGguYWJzcGF0aChmaWxlcGF0aCkKICAgIHdoaWxlIG9zLnBhdGguaXNsaW5rKGZpbGVwYXRoKToKICAgICAgICBmaWxlcGF0aCA9IG9zLnBhdGgubm9ybXBhdGgoCiAgICAgICAgICAgIG9zLnBhdGguam9pbihvcy5wYXRoLmRpcm5hbWUoZmlsZXBhdGgpLG9zLnJlYWRsaW5rKGZpbGVwYXRoKSkpCiAgICByZXR1cm4gZmlsZXBhdGgKCmRlZiBfc3lzY21kX3VuYW1lKG9wdGlvbixkZWZhdWx0PScnKToKCiAgICAiIiIgSW50ZXJmYWNlIHRvIHRoZSBzeXN0ZW0ncyB1bmFtZSBjb21tYW5kLgogICAgIiIiCiAgICBpZiBzeXMucGxhdGZvcm0gaW4gKCdkb3MnLCd3aW4zMicsJ3dpbjE2Jywnb3MyJyk6CiAgICAgICAgIyBYWFggT3RoZXJzIHRvbyA/CiAgICAgICAgcmV0dXJuIGRlZmF1bHQKICAgIHRyeToKICAgICAgICBmID0gb3MucG9wZW4oJ3VuYW1lICVzIDI+ICVzJyAlIChvcHRpb24sIERFVl9OVUxMKSkKICAgIGV4Y2VwdCAoQXR0cmlidXRlRXJyb3Isb3MuZXJyb3IpOgogICAgICAgIHJldHVybiBkZWZhdWx0CiAgICBvdXRwdXQgPSBmLnJlYWQoKS5zdHJpcCgpCiAgICByYyA9IGYuY2xvc2UoKQogICAgaWYgbm90IG91dHB1dCBvciByYzoKICAgICAgICByZXR1cm4gZGVmYXVsdAogICAgZWxzZToKICAgICAgICByZXR1cm4gb3V0cHV0CgpkZWYgX3N5c2NtZF9maWxlKHRhcmdldCxkZWZhdWx0PScnKToKCiAgICAiIiIgSW50ZXJmYWNlIHRvIHRoZSBzeXN0ZW0ncyBmaWxlIGNvbW1hbmQuCgogICAgICAgIFRoZSBmdW5jdGlvbiB1c2VzIHRoZSAtYiBvcHRpb24gb2YgdGhlIGZpbGUgY29tbWFuZCB0byBoYXZlIGl0CiAgICAgICAgb21pdCB0aGUgZmlsZW5hbWUgaW4gaXRzIG91dHB1dC4gRm9sbG93IHRoZSBzeW1saW5rcy4gSXQgcmV0dXJucwogICAgICAgIGRlZmF1bHQgaW4gY2FzZSB0aGUgY29tbWFuZCBzaG91bGQgZmFpbC4KCiAgICAiIiIKICAgIGlmIHN5cy5wbGF0Zm9ybSBpbiAoJ2RvcycsJ3dpbjMyJywnd2luMTYnLCdvczInKToKICAgICAgICAjIFhYWCBPdGhlcnMgdG9vID8KICAgICAgICByZXR1cm4gZGVmYXVsdAogICAgdGFyZ2V0ID0gX2ZvbGxvd19zeW1saW5rcyh0YXJnZXQpLnJlcGxhY2UoJyInLCAnXFwiJykKICAgIHRyeToKICAgICAgICBmID0gb3MucG9wZW4oJ2ZpbGUgLWIgIiVzIiAyPiAlcycgJSAodGFyZ2V0LCBERVZfTlVMTCkpCiAgICBleGNlcHQgKEF0dHJpYnV0ZUVycm9yLG9zLmVycm9yKToKICAgICAgICByZXR1cm4gZGVmYXVsdAogICAgb3V0cHV0ID0gZi5yZWFkKCkuc3RyaXAoKQogICAgcmMgPSBmLmNsb3NlKCkKICAgIGlmIG5vdCBvdXRwdXQgb3IgcmM6CiAgICAgICAgcmV0dXJuIGRlZmF1bHQKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIG91dHB1dAoKIyMjIEluZm9ybWF0aW9uIGFib3V0IHRoZSB1c2VkIGFyY2hpdGVjdHVyZQoKIyBEZWZhdWx0IHZhbHVlcyBmb3IgYXJjaGl0ZWN0dXJlOyBub24tZW1wdHkgc3RyaW5ncyBvdmVycmlkZSB0aGUKIyBkZWZhdWx0cyBnaXZlbiBhcyBwYXJhbWV0ZXJzCl9kZWZhdWx0X2FyY2hpdGVjdHVyZSA9IHsKICAgICd3aW4zMic6ICgnJywnV2luZG93c1BFJyksCiAgICAnd2luMTYnOiAoJycsJ1dpbmRvd3MnKSwKICAgICdkb3MnOiAoJycsJ01TRE9TJyksCn0KCmRlZiBhcmNoaXRlY3R1cmUoZXhlY3V0YWJsZT1zeXMuZXhlY3V0YWJsZSxiaXRzPScnLGxpbmthZ2U9JycpOgoKICAgICIiIiBRdWVyaWVzIHRoZSBnaXZlbiBleGVjdXRhYmxlIChkZWZhdWx0cyB0byB0aGUgUHl0aG9uIGludGVycHJldGVyCiAgICAgICAgYmluYXJ5KSBmb3IgdmFyaW91cyBhcmNoaXRlY3R1cmUgaW5mb3JtYXRpb24uCgogICAgICAgIFJldHVybnMgYSB0dXBsZSAoYml0cyxsaW5rYWdlKSB3aGljaCBjb250YWlucyBpbmZvcm1hdGlvbiBhYm91dAogICAgICAgIHRoZSBiaXQgYXJjaGl0ZWN0dXJlIGFuZCB0aGUgbGlua2FnZSBmb3JtYXQgdXNlZCBmb3IgdGhlCiAgICAgICAgZXhlY3V0YWJsZS4gQm90aCB2YWx1ZXMgYXJlIHJldHVybmVkIGFzIHN0cmluZ3MuCgogICAgICAgIFZhbHVlcyB0aGF0IGNhbm5vdCBiZSBkZXRlcm1pbmVkIGFyZSByZXR1cm5lZCBhcyBnaXZlbiBieSB0aGUKICAgICAgICBwYXJhbWV0ZXIgcHJlc2V0cy4gSWYgYml0cyBpcyBnaXZlbiBhcyAnJywgdGhlIHNpemVvZihwb2ludGVyKQogICAgICAgIChvciBzaXplb2YobG9uZykgb24gUHl0aG9uIHZlcnNpb24gPCAxLjUuMikgaXMgdXNlZCBhcwogICAgICAgIGluZGljYXRvciBmb3IgdGhlIHN1cHBvcnRlZCBwb2ludGVyIHNpemUuCgogICAgICAgIFRoZSBmdW5jdGlvbiByZWxpZXMgb24gdGhlIHN5c3RlbSdzICJmaWxlIiBjb21tYW5kIHRvIGRvIHRoZQogICAgICAgIGFjdHVhbCB3b3JrLiBUaGlzIGlzIGF2YWlsYWJsZSBvbiBtb3N0IGlmIG5vdCBhbGwgVW5peAogICAgICAgIHBsYXRmb3Jtcy4gT24gc29tZSBub24tVW5peCBwbGF0Zm9ybXMgd2hlcmUgdGhlICJmaWxlIiBjb21tYW5kCiAgICAgICAgZG9lcyBub3QgZXhpc3QgYW5kIHRoZSBleGVjdXRhYmxlIGlzIHNldCB0byB0aGUgUHl0aG9uIGludGVycHJldGVyCiAgICAgICAgYmluYXJ5IGRlZmF1bHRzIGZyb20gX2RlZmF1bHRfYXJjaGl0ZWN0dXJlIGFyZSB1c2VkLgoKICAgICIiIgogICAgIyBVc2UgdGhlIHNpemVvZihwb2ludGVyKSBhcyBkZWZhdWx0IG51bWJlciBvZiBiaXRzIGlmIG5vdGhpbmcKICAgICMgZWxzZSBpcyBnaXZlbiBhcyBkZWZhdWx0LgogICAgaWYgbm90IGJpdHM6CiAgICAgICAgaW1wb3J0IHN0cnVjdAogICAgICAgIHRyeToKICAgICAgICAgICAgc2l6ZSA9IHN0cnVjdC5jYWxjc2l6ZSgnUCcpCiAgICAgICAgZXhjZXB0IHN0cnVjdC5lcnJvcjoKICAgICAgICAgICAgIyBPbGRlciBpbnN0YWxsYXRpb25zIGNhbiBvbmx5IHF1ZXJ5IGxvbmdzCiAgICAgICAgICAgIHNpemUgPSBzdHJ1Y3QuY2FsY3NpemUoJ2wnKQogICAgICAgIGJpdHMgPSBzdHIoc2l6ZSo4KSArICdiaXQnCgogICAgIyBHZXQgZGF0YSBmcm9tIHRoZSAnZmlsZScgc3lzdGVtIGNvbW1hbmQKICAgIGlmIGV4ZWN1dGFibGU6CiAgICAgICAgZmlsZW91dCA9IF9zeXNjbWRfZmlsZShleGVjdXRhYmxlLCAnJykKICAgIGVsc2U6CiAgICAgICAgZmlsZW91dCA9ICcnCgogICAgaWYgbm90IGZpbGVvdXQgYW5kIFwKICAgICAgIGV4ZWN1dGFibGUgPT0gc3lzLmV4ZWN1dGFibGU6CiAgICAgICAgIyAiZmlsZSIgY29tbWFuZCBkaWQgbm90IHJldHVybiBhbnl0aGluZzsgd2UnbGwgdHJ5IHRvIHByb3ZpZGUKICAgICAgICAjIHNvbWUgc2Vuc2libGUgZGVmYXVsdHMgdGhlbi4uLgogICAgICAgIGlmIHN5cy5wbGF0Zm9ybSBpbiBfZGVmYXVsdF9hcmNoaXRlY3R1cmU6CiAgICAgICAgICAgIGIsbCA9IF9kZWZhdWx0X2FyY2hpdGVjdHVyZVtzeXMucGxhdGZvcm1dCiAgICAgICAgICAgIGlmIGI6CiAgICAgICAgICAgICAgICBiaXRzID0gYgogICAgICAgICAgICBpZiBsOgogICAgICAgICAgICAgICAgbGlua2FnZSA9IGwKICAgICAgICByZXR1cm4gYml0cyxsaW5rYWdlCgogICAgaWYgJ2V4ZWN1dGFibGUnIG5vdCBpbiBmaWxlb3V0OgogICAgICAgICMgRm9ybWF0IG5vdCBzdXBwb3J0ZWQKICAgICAgICByZXR1cm4gYml0cyxsaW5rYWdlCgogICAgIyBCaXRzCiAgICBpZiAnMzItYml0JyBpbiBmaWxlb3V0OgogICAgICAgIGJpdHMgPSAnMzJiaXQnCiAgICBlbGlmICdOMzInIGluIGZpbGVvdXQ6CiAgICAgICAgIyBPbiBJcml4IG9ubHkKICAgICAgICBiaXRzID0gJ24zMmJpdCcKICAgIGVsaWYgJzY0LWJpdCcgaW4gZmlsZW91dDoKICAgICAgICBiaXRzID0gJzY0Yml0JwoKICAgICMgTGlua2FnZQogICAgaWYgJ0VMRicgaW4gZmlsZW91dDoKICAgICAgICBsaW5rYWdlID0gJ0VMRicKICAgIGVsaWYgJ1BFJyBpbiBmaWxlb3V0OgogICAgICAgICMgRS5nLiBXaW5kb3dzIHVzZXMgdGhpcyBmb3JtYXQKICAgICAgICBpZiAnV2luZG93cycgaW4gZmlsZW91dDoKICAgICAgICAgICAgbGlua2FnZSA9ICdXaW5kb3dzUEUnCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbGlua2FnZSA9ICdQRScKICAgIGVsaWYgJ0NPRkYnIGluIGZpbGVvdXQ6CiAgICAgICAgbGlua2FnZSA9ICdDT0ZGJwogICAgZWxpZiAnTVMtRE9TJyBpbiBmaWxlb3V0OgogICAgICAgIGxpbmthZ2UgPSAnTVNET1MnCiAgICBlbHNlOgogICAgICAgICMgWFhYIHRoZSBBLk9VVCBmb3JtYXQgYWxzbyBmYWxscyB1bmRlciB0aGlzIGNsYXNzLi4uCiAgICAgICAgcGFzcwoKICAgIHJldHVybiBiaXRzLGxpbmthZ2UKCiMjIyBQb3J0YWJsZSB1bmFtZSgpIGludGVyZmFjZQoKdW5hbWVfcmVzdWx0ID0gY29sbGVjdGlvbnMubmFtZWR0dXBsZSgidW5hbWVfcmVzdWx0IiwKICAgICAgICAgICAgICAgICAgICAic3lzdGVtIG5vZGUgcmVsZWFzZSB2ZXJzaW9uIG1hY2hpbmUgcHJvY2Vzc29yIikKCl91bmFtZV9jYWNoZSA9IE5vbmUKCmRlZiB1bmFtZSgpOgoKICAgICIiIiBGYWlybHkgcG9ydGFibGUgdW5hbWUgaW50ZXJmYWNlLiBSZXR1cm5zIGEgdHVwbGUKICAgICAgICBvZiBzdHJpbmdzIChzeXN0ZW0sbm9kZSxyZWxlYXNlLHZlcnNpb24sbWFjaGluZSxwcm9jZXNzb3IpCiAgICAgICAgaWRlbnRpZnlpbmcgdGhlIHVuZGVybHlpbmcgcGxhdGZvcm0uCgogICAgICAgIE5vdGUgdGhhdCB1bmxpa2UgdGhlIG9zLnVuYW1lIGZ1bmN0aW9uIHRoaXMgYWxzbyByZXR1cm5zCiAgICAgICAgcG9zc2libGUgcHJvY2Vzc29yIGluZm9ybWF0aW9uIGFzIGFuIGFkZGl0aW9uYWwgdHVwbGUgZW50cnkuCgogICAgICAgIEVudHJpZXMgd2hpY2ggY2Fubm90IGJlIGRldGVybWluZWQgYXJlIHNldCB0byAnJy4KCiAgICAiIiIKICAgIGdsb2JhbCBfdW5hbWVfY2FjaGUKICAgIG5vX29zX3VuYW1lID0gMAoKICAgIGlmIF91bmFtZV9jYWNoZSBpcyBub3QgTm9uZToKICAgICAgICByZXR1cm4gX3VuYW1lX2NhY2hlCgogICAgcHJvY2Vzc29yID0gJycKCiAgICAjIEdldCBzb21lIGluZm9zIGZyb20gdGhlIGJ1aWx0aW4gb3MudW5hbWUgQVBJLi4uCiAgICB0cnk6CiAgICAgICAgc3lzdGVtLG5vZGUscmVsZWFzZSx2ZXJzaW9uLG1hY2hpbmUgPSBvcy51bmFtZSgpCiAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgbm9fb3NfdW5hbWUgPSAxCgogICAgaWYgbm9fb3NfdW5hbWUgb3Igbm90IGxpc3QoZmlsdGVyKE5vbmUsIChzeXN0ZW0sIG5vZGUsIHJlbGVhc2UsIHZlcnNpb24sIG1hY2hpbmUpKSk6CiAgICAgICAgIyBIbW0sIG5vIHRoZXJlIGlzIGVpdGhlciBubyB1bmFtZSBvciB1bmFtZSBoYXMgcmV0dXJuZWQKICAgICAgICAjJ3Vua25vd25zJy4uLiB3ZSdsbCBoYXZlIHRvIHBva2UgYXJvdW5kIHRoZSBzeXN0ZW0gdGhlbi4KICAgICAgICBpZiBub19vc191bmFtZToKICAgICAgICAgICAgc3lzdGVtID0gc3lzLnBsYXRmb3JtCiAgICAgICAgICAgIHJlbGVhc2UgPSAnJwogICAgICAgICAgICB2ZXJzaW9uID0gJycKICAgICAgICAgICAgbm9kZSA9IF9ub2RlKCkKICAgICAgICAgICAgbWFjaGluZSA9ICcnCgogICAgICAgIHVzZV9zeXNjbWRfdmVyID0gMQoKICAgICAgICAjIFRyeSB3aW4zMl92ZXIoKSBvbiB3aW4zMiBwbGF0Zm9ybXMKICAgICAgICBpZiBzeXN0ZW0gPT0gJ3dpbjMyJzoKICAgICAgICAgICAgcmVsZWFzZSx2ZXJzaW9uLGNzZCxwdHlwZSA9IHdpbjMyX3ZlcigpCiAgICAgICAgICAgIGlmIHJlbGVhc2UgYW5kIHZlcnNpb246CiAgICAgICAgICAgICAgICB1c2Vfc3lzY21kX3ZlciA9IDAKICAgICAgICAgICAgIyBUcnkgdG8gdXNlIHRoZSBQUk9DRVNTT1JfKiBlbnZpcm9ubWVudCB2YXJpYWJsZXMKICAgICAgICAgICAgIyBhdmFpbGFibGUgb24gV2luIFhQIGFuZCBsYXRlcjsgc2VlCiAgICAgICAgICAgICMgaHR0cDovL3N1cHBvcnQubWljcm9zb2Z0LmNvbS9rYi84ODg3MzEgYW5kCiAgICAgICAgICAgICMgaHR0cDovL3d3dy5nZW9jaXRpZXMuY29tL3JpY2tfbGl2ZWx5L01BTlVBTFMvRU5WL01TV0lOL1BST0NFU1NJLkhUTQogICAgICAgICAgICBpZiBub3QgbWFjaGluZToKICAgICAgICAgICAgICAgICMgV09XNjQgcHJvY2Vzc2VzIG1hc2sgdGhlIG5hdGl2ZSBhcmNoaXRlY3R1cmUKICAgICAgICAgICAgICAgIGlmICJQUk9DRVNTT1JfQVJDSElURVc2NDMyIiBpbiBvcy5lbnZpcm9uOgogICAgICAgICAgICAgICAgICAgIG1hY2hpbmUgPSBvcy5lbnZpcm9uLmdldCgiUFJPQ0VTU09SX0FSQ0hJVEVXNjQzMiIsICcnKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBtYWNoaW5lID0gb3MuZW52aXJvbi5nZXQoJ1BST0NFU1NPUl9BUkNISVRFQ1RVUkUnLCAnJykKICAgICAgICAgICAgaWYgbm90IHByb2Nlc3NvcjoKICAgICAgICAgICAgICAgIHByb2Nlc3NvciA9IG9zLmVudmlyb24uZ2V0KCdQUk9DRVNTT1JfSURFTlRJRklFUicsIG1hY2hpbmUpCgogICAgICAgICMgVHJ5IHRoZSAndmVyJyBzeXN0ZW0gY29tbWFuZCBhdmFpbGFibGUgb24gc29tZQogICAgICAgICMgcGxhdGZvcm1zCiAgICAgICAgaWYgdXNlX3N5c2NtZF92ZXI6CiAgICAgICAgICAgIHN5c3RlbSxyZWxlYXNlLHZlcnNpb24gPSBfc3lzY21kX3ZlcihzeXN0ZW0pCiAgICAgICAgICAgICMgTm9ybWFsaXplIHN5c3RlbSB0byB3aGF0IHdpbjMyX3ZlcigpIG5vcm1hbGx5IHJldHVybnMKICAgICAgICAgICAgIyAoX3N5c2NtZF92ZXIoKSB0ZW5kcyB0byByZXR1cm4gdGhlIHZlbmRvciBuYW1lIGFzIHdlbGwpCiAgICAgICAgICAgIGlmIHN5c3RlbSA9PSAnTWljcm9zb2Z0IFdpbmRvd3MnOgogICAgICAgICAgICAgICAgc3lzdGVtID0gJ1dpbmRvd3MnCiAgICAgICAgICAgIGVsaWYgc3lzdGVtID09ICdNaWNyb3NvZnQnIGFuZCByZWxlYXNlID09ICdXaW5kb3dzJzoKICAgICAgICAgICAgICAgICMgVW5kZXIgV2luZG93cyBWaXN0YSBhbmQgV2luZG93cyBTZXJ2ZXIgMjAwOCwKICAgICAgICAgICAgICAgICMgTWljcm9zb2Z0IGNoYW5nZWQgdGhlIG91dHB1dCBvZiB0aGUgdmVyIGNvbW1hbmQuIFRoZQogICAgICAgICAgICAgICAgIyByZWxlYXNlIGlzIG5vIGxvbmdlciBwcmludGVkLiAgVGhpcyBjYXVzZXMgdGhlCiAgICAgICAgICAgICAgICAjIHN5c3RlbSBhbmQgcmVsZWFzZSB0byBiZSBtaXNpZGVudGlmaWVkLgogICAgICAgICAgICAgICAgc3lzdGVtID0gJ1dpbmRvd3MnCiAgICAgICAgICAgICAgICBpZiAnNi4wJyA9PSB2ZXJzaW9uWzozXToKICAgICAgICAgICAgICAgICAgICByZWxlYXNlID0gJ1Zpc3RhJwogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICByZWxlYXNlID0gJycKCiAgICAgICAgIyBJbiBjYXNlIHdlIHN0aWxsIGRvbid0IGtub3cgYW55dGhpbmcgdXNlZnVsLCB3ZSdsbCB0cnkgdG8KICAgICAgICAjIGhlbHAgb3Vyc2VsdmVzCiAgICAgICAgaWYgc3lzdGVtIGluICgnd2luMzInLCd3aW4xNicpOgogICAgICAgICAgICBpZiBub3QgdmVyc2lvbjoKICAgICAgICAgICAgICAgIGlmIHN5c3RlbSA9PSAnd2luMzInOgogICAgICAgICAgICAgICAgICAgIHZlcnNpb24gPSAnMzJiaXQnCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHZlcnNpb24gPSAnMTZiaXQnCiAgICAgICAgICAgIHN5c3RlbSA9ICdXaW5kb3dzJwoKICAgICAgICBlbGlmIHN5c3RlbVs6NF0gPT0gJ2phdmEnOgogICAgICAgICAgICByZWxlYXNlLHZlbmRvcix2bWluZm8sb3NpbmZvID0gamF2YV92ZXIoKQogICAgICAgICAgICBzeXN0ZW0gPSAnSmF2YScKICAgICAgICAgICAgdmVyc2lvbiA9ICcsICcuam9pbih2bWluZm8pCiAgICAgICAgICAgIGlmIG5vdCB2ZXJzaW9uOgogICAgICAgICAgICAgICAgdmVyc2lvbiA9IHZlbmRvcgoKICAgICMgU3lzdGVtIHNwZWNpZmljIGV4dGVuc2lvbnMKICAgIGlmIHN5c3RlbSA9PSAnT3BlblZNUyc6CiAgICAgICAgIyBPcGVuVk1TIHNlZW1zIHRvIGhhdmUgcmVsZWFzZSBhbmQgdmVyc2lvbiBtaXhlZCB1cAogICAgICAgIGlmIG5vdCByZWxlYXNlIG9yIHJlbGVhc2UgPT0gJzAnOgogICAgICAgICAgICByZWxlYXNlID0gdmVyc2lvbgogICAgICAgICAgICB2ZXJzaW9uID0gJycKICAgICAgICAjIEdldCBwcm9jZXNzb3IgaW5mb3JtYXRpb24KICAgICAgICB0cnk6CiAgICAgICAgICAgIGltcG9ydCB2bXNfbGliCiAgICAgICAgZXhjZXB0IEltcG9ydEVycm9yOgogICAgICAgICAgICBwYXNzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY3NpZCwgY3B1X251bWJlciA9IHZtc19saWIuZ2V0c3lpKCdTWUkkX0NQVScsMCkKICAgICAgICAgICAgaWYgKGNwdV9udW1iZXIgPj0gMTI4KToKICAgICAgICAgICAgICAgIHByb2Nlc3NvciA9ICdBbHBoYScKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByb2Nlc3NvciA9ICdWQVgnCiAgICBpZiBub3QgcHJvY2Vzc29yOgogICAgICAgICMgR2V0IHByb2Nlc3NvciBpbmZvcm1hdGlvbiBmcm9tIHRoZSB1bmFtZSBzeXN0ZW0gY29tbWFuZAogICAgICAgIHByb2Nlc3NvciA9IF9zeXNjbWRfdW5hbWUoJy1wJywnJykKCiAgICAjSWYgYW55IHVua25vd25zIHN0aWxsIGV4aXN0LCByZXBsYWNlIHRoZW0gd2l0aCAnJ3MsIHdoaWNoIGFyZSBtb3JlIHBvcnRhYmxlCiAgICBpZiBzeXN0ZW0gPT0gJ3Vua25vd24nOgogICAgICAgIHN5c3RlbSA9ICcnCiAgICBpZiBub2RlID09ICd1bmtub3duJzoKICAgICAgICBub2RlID0gJycKICAgIGlmIHJlbGVhc2UgPT0gJ3Vua25vd24nOgogICAgICAgIHJlbGVhc2UgPSAnJwogICAgaWYgdmVyc2lvbiA9PSAndW5rbm93bic6CiAgICAgICAgdmVyc2lvbiA9ICcnCiAgICBpZiBtYWNoaW5lID09ICd1bmtub3duJzoKICAgICAgICBtYWNoaW5lID0gJycKICAgIGlmIHByb2Nlc3NvciA9PSAndW5rbm93bic6CiAgICAgICAgcHJvY2Vzc29yID0gJycKCiAgICAjICBub3JtYWxpemUgbmFtZQogICAgaWYgc3lzdGVtID09ICdNaWNyb3NvZnQnIGFuZCByZWxlYXNlID09ICdXaW5kb3dzJzoKICAgICAgICBzeXN0ZW0gPSAnV2luZG93cycKICAgICAgICByZWxlYXNlID0gJ1Zpc3RhJwoKICAgIF91bmFtZV9jYWNoZSA9IHVuYW1lX3Jlc3VsdChzeXN0ZW0sbm9kZSxyZWxlYXNlLHZlcnNpb24sbWFjaGluZSxwcm9jZXNzb3IpCiAgICByZXR1cm4gX3VuYW1lX2NhY2hlCgojIyMgRGlyZWN0IGludGVyZmFjZXMgdG8gc29tZSBvZiB0aGUgdW5hbWUoKSByZXR1cm4gdmFsdWVzCgpkZWYgc3lzdGVtKCk6CgogICAgIiIiIFJldHVybnMgdGhlIHN5c3RlbS9PUyBuYW1lLCBlLmcuICdMaW51eCcsICdXaW5kb3dzJyBvciAnSmF2YScuCgogICAgICAgIEFuIGVtcHR5IHN0cmluZyBpcyByZXR1cm5lZCBpZiB0aGUgdmFsdWUgY2Fubm90IGJlIGRldGVybWluZWQuCgogICAgIiIiCiAgICByZXR1cm4gdW5hbWUoKS5zeXN0ZW0KCmRlZiBub2RlKCk6CgogICAgIiIiIFJldHVybnMgdGhlIGNvbXB1dGVyJ3MgbmV0d29yayBuYW1lICh3aGljaCBtYXkgbm90IGJlIGZ1bGx5CiAgICAgICAgcXVhbGlmaWVkKQoKICAgICAgICBBbiBlbXB0eSBzdHJpbmcgaXMgcmV0dXJuZWQgaWYgdGhlIHZhbHVlIGNhbm5vdCBiZSBkZXRlcm1pbmVkLgoKICAgICIiIgogICAgcmV0dXJuIHVuYW1lKCkubm9kZQoKZGVmIHJlbGVhc2UoKToKCiAgICAiIiIgUmV0dXJucyB0aGUgc3lzdGVtJ3MgcmVsZWFzZSwgZS5nLiAnMi4yLjAnIG9yICdOVCcKCiAgICAgICAgQW4gZW1wdHkgc3RyaW5nIGlzIHJldHVybmVkIGlmIHRoZSB2YWx1ZSBjYW5ub3QgYmUgZGV0ZXJtaW5lZC4KCiAgICAiIiIKICAgIHJldHVybiB1bmFtZSgpLnJlbGVhc2UKCmRlZiB2ZXJzaW9uKCk6CgogICAgIiIiIFJldHVybnMgdGhlIHN5c3RlbSdzIHJlbGVhc2UgdmVyc2lvbiwgZS5nLiAnIzMgb24gZGVnYXMnCgogICAgICAgIEFuIGVtcHR5IHN0cmluZyBpcyByZXR1cm5lZCBpZiB0aGUgdmFsdWUgY2Fubm90IGJlIGRldGVybWluZWQuCgogICAgIiIiCiAgICByZXR1cm4gdW5hbWUoKS52ZXJzaW9uCgpkZWYgbWFjaGluZSgpOgoKICAgICIiIiBSZXR1cm5zIHRoZSBtYWNoaW5lIHR5cGUsIGUuZy4gJ2kzODYnCgogICAgICAgIEFuIGVtcHR5IHN0cmluZyBpcyByZXR1cm5lZCBpZiB0aGUgdmFsdWUgY2Fubm90IGJlIGRldGVybWluZWQuCgogICAgIiIiCiAgICByZXR1cm4gdW5hbWUoKS5tYWNoaW5lCgpkZWYgcHJvY2Vzc29yKCk6CgogICAgIiIiIFJldHVybnMgdGhlICh0cnVlKSBwcm9jZXNzb3IgbmFtZSwgZS5nLiAnYW1kazYnCgogICAgICAgIEFuIGVtcHR5IHN0cmluZyBpcyByZXR1cm5lZCBpZiB0aGUgdmFsdWUgY2Fubm90IGJlCiAgICAgICAgZGV0ZXJtaW5lZC4gTm90ZSB0aGF0IG1hbnkgcGxhdGZvcm1zIGRvIG5vdCBwcm92aWRlIHRoaXMKICAgICAgICBpbmZvcm1hdGlvbiBvciBzaW1wbHkgcmV0dXJuIHRoZSBzYW1lIHZhbHVlIGFzIGZvciBtYWNoaW5lKCksCiAgICAgICAgZS5nLiAgTmV0QlNEIGRvZXMgdGhpcy4KCiAgICAiIiIKICAgIHJldHVybiB1bmFtZSgpLnByb2Nlc3NvcgoKIyMjIFZhcmlvdXMgQVBJcyBmb3IgZXh0cmFjdGluZyBpbmZvcm1hdGlvbiBmcm9tIHN5cy52ZXJzaW9uCgpfc3lzX3ZlcnNpb25fcGFyc2VyID0gcmUuY29tcGlsZSgKICAgIHInKFtcdy4rXSspXHMqJwogICAgJ1woIz8oW14sXSspLFxzKihbXHcgXSspLFxzKihbXHcgOl0rKVwpXHMqJwogICAgJ1xbKFteXF1dKylcXT8nLCByZS5BU0NJSSkKCl9pcm9ucHl0aG9uX3N5c192ZXJzaW9uX3BhcnNlciA9IHJlLmNvbXBpbGUoCiAgICByJ0lyb25QeXRob25ccyonCiAgICAnKFtcZFwuXSspJwogICAgJyg/OiBcKChbXGRcLl0rKVwpKT8nCiAgICAnIG9uICguTkVUIFtcZFwuXSspJywgcmUuQVNDSUkpCgpfcHlweV9zeXNfdmVyc2lvbl9wYXJzZXIgPSByZS5jb21waWxlKAogICAgcicoW1x3LitdKylccyonCiAgICAnXCgjPyhbXixdKyksXHMqKFtcdyBdKyksXHMqKFtcdyA6XSspXClccyonCiAgICAnXFtQeVB5IFteXF1dK1xdPycpCgpfc3lzX3ZlcnNpb25fY2FjaGUgPSB7fQoKZGVmIF9zeXNfdmVyc2lvbihzeXNfdmVyc2lvbj1Ob25lKToKCiAgICAiIiIgUmV0dXJucyBhIHBhcnNlZCB2ZXJzaW9uIG9mIFB5dGhvbidzIHN5cy52ZXJzaW9uIGFzIHR1cGxlCiAgICAgICAgKG5hbWUsIHZlcnNpb24sIGJyYW5jaCwgcmV2aXNpb24sIGJ1aWxkbm8sIGJ1aWxkZGF0ZSwgY29tcGlsZXIpCiAgICAgICAgcmVmZXJyaW5nIHRvIHRoZSBQeXRob24gaW1wbGVtZW50YXRpb24gbmFtZSwgdmVyc2lvbiwgYnJhbmNoLAogICAgICAgIHJldmlzaW9uLCBidWlsZCBudW1iZXIsIGJ1aWxkIGRhdGUvdGltZSBhcyBzdHJpbmcgYW5kIHRoZSBjb21waWxlcgogICAgICAgIGlkZW50aWZpY2F0aW9uIHN0cmluZy4KCiAgICAgICAgTm90ZSB0aGF0IHVubGlrZSB0aGUgUHl0aG9uIHN5cy52ZXJzaW9uLCB0aGUgcmV0dXJuZWQgdmFsdWUKICAgICAgICBmb3IgdGhlIFB5dGhvbiB2ZXJzaW9uIHdpbGwgYWx3YXlzIGluY2x1ZGUgdGhlIHBhdGNobGV2ZWwgKGl0CiAgICAgICAgZGVmYXVsdHMgdG8gJy4wJykuCgogICAgICAgIFRoZSBmdW5jdGlvbiByZXR1cm5zIGVtcHR5IHN0cmluZ3MgZm9yIHR1cGxlIGVudHJpZXMgdGhhdAogICAgICAgIGNhbm5vdCBiZSBkZXRlcm1pbmVkLgoKICAgICAgICBzeXNfdmVyc2lvbiBtYXkgYmUgZ2l2ZW4gdG8gcGFyc2UgYW4gYWx0ZXJuYXRpdmUgdmVyc2lvbgogICAgICAgIHN0cmluZywgZS5nLiBpZiB0aGUgdmVyc2lvbiB3YXMgcmVhZCBmcm9tIGEgZGlmZmVyZW50IFB5dGhvbgogICAgICAgIGludGVycHJldGVyLgoKICAgICIiIgogICAgIyBHZXQgdGhlIFB5dGhvbiB2ZXJzaW9uCiAgICBpZiBzeXNfdmVyc2lvbiBpcyBOb25lOgogICAgICAgIHN5c192ZXJzaW9uID0gc3lzLnZlcnNpb24KCiAgICAjIFRyeSB0aGUgY2FjaGUgZmlyc3QKICAgIHJlc3VsdCA9IF9zeXNfdmVyc2lvbl9jYWNoZS5nZXQoc3lzX3ZlcnNpb24sIE5vbmUpCiAgICBpZiByZXN1bHQgaXMgbm90IE5vbmU6CiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgICMgUGFyc2UgaXQKICAgIGlmIHN5c192ZXJzaW9uWzoxMF0gPT0gJ0lyb25QeXRob24nOgogICAgICAgICMgSXJvblB5dGhvbgogICAgICAgIG5hbWUgPSAnSXJvblB5dGhvbicKICAgICAgICBtYXRjaCA9IF9pcm9ucHl0aG9uX3N5c192ZXJzaW9uX3BhcnNlci5tYXRjaChzeXNfdmVyc2lvbikKICAgICAgICBpZiBtYXRjaCBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKAogICAgICAgICAgICAgICAgJ2ZhaWxlZCB0byBwYXJzZSBJcm9uUHl0aG9uIHN5cy52ZXJzaW9uOiAlcycgJQogICAgICAgICAgICAgICAgcmVwcihzeXNfdmVyc2lvbikpCiAgICAgICAgdmVyc2lvbiwgYWx0X3ZlcnNpb24sIGNvbXBpbGVyID0gbWF0Y2guZ3JvdXBzKCkKICAgICAgICBidWlsZG5vID0gJycKICAgICAgICBidWlsZGRhdGUgPSAnJwoKICAgIGVsaWYgc3lzLnBsYXRmb3JtWzo0XSA9PSAnamF2YSc6CiAgICAgICAgIyBKeXRob24KICAgICAgICBuYW1lID0gJ0p5dGhvbicKICAgICAgICBtYXRjaCA9IF9zeXNfdmVyc2lvbl9wYXJzZXIubWF0Y2goc3lzX3ZlcnNpb24pCiAgICAgICAgaWYgbWF0Y2ggaXMgTm9uZToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgICAgICdmYWlsZWQgdG8gcGFyc2UgSnl0aG9uIHN5cy52ZXJzaW9uOiAlcycgJQogICAgICAgICAgICAgICAgcmVwcihzeXNfdmVyc2lvbikpCiAgICAgICAgdmVyc2lvbiwgYnVpbGRubywgYnVpbGRkYXRlLCBidWlsZHRpbWUsIF8gPSBtYXRjaC5ncm91cHMoKQogICAgICAgIGNvbXBpbGVyID0gc3lzLnBsYXRmb3JtCgogICAgZWxpZiAiUHlQeSIgaW4gc3lzX3ZlcnNpb246CiAgICAgICAgIyBQeVB5CiAgICAgICAgbmFtZSA9ICJQeVB5IgogICAgICAgIG1hdGNoID0gX3B5cHlfc3lzX3ZlcnNpb25fcGFyc2VyLm1hdGNoKHN5c192ZXJzaW9uKQogICAgICAgIGlmIG1hdGNoIGlzIE5vbmU6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImZhaWxlZCB0byBwYXJzZSBQeVB5IHN5cy52ZXJzaW9uOiAlcyIgJQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcHIoc3lzX3ZlcnNpb24pKQogICAgICAgIHZlcnNpb24sIGJ1aWxkbm8sIGJ1aWxkZGF0ZSwgYnVpbGR0aW1lID0gbWF0Y2guZ3JvdXBzKCkKICAgICAgICBjb21waWxlciA9ICIiCgogICAgZWxzZToKICAgICAgICAjIENQeXRob24KICAgICAgICBtYXRjaCA9IF9zeXNfdmVyc2lvbl9wYXJzZXIubWF0Y2goc3lzX3ZlcnNpb24pCiAgICAgICAgaWYgbWF0Y2ggaXMgTm9uZToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgICAgICdmYWlsZWQgdG8gcGFyc2UgQ1B5dGhvbiBzeXMudmVyc2lvbjogJXMnICUKICAgICAgICAgICAgICAgIHJlcHIoc3lzX3ZlcnNpb24pKQogICAgICAgIHZlcnNpb24sIGJ1aWxkbm8sIGJ1aWxkZGF0ZSwgYnVpbGR0aW1lLCBjb21waWxlciA9IFwKICAgICAgICAgICAgICBtYXRjaC5ncm91cHMoKQogICAgICAgIG5hbWUgPSAnQ1B5dGhvbicKICAgICAgICBidWlsZGRhdGUgPSBidWlsZGRhdGUgKyAnICcgKyBidWlsZHRpbWUKCiAgICBpZiBoYXNhdHRyKHN5cywgJ19tZXJjdXJpYWwnKToKICAgICAgICBfLCBicmFuY2gsIHJldmlzaW9uID0gc3lzLl9tZXJjdXJpYWwKICAgIGVsaWYgaGFzYXR0cihzeXMsICdzdWJ2ZXJzaW9uJyk6CiAgICAgICAgIyBzeXMuc3VidmVyc2lvbiB3YXMgYWRkZWQgaW4gUHl0aG9uIDIuNQogICAgICAgIF8sIGJyYW5jaCwgcmV2aXNpb24gPSBzeXMuc3VidmVyc2lvbgogICAgZWxzZToKICAgICAgICBicmFuY2ggPSAnJwogICAgICAgIHJldmlzaW9uID0gJycKCiAgICAjIEFkZCB0aGUgcGF0Y2hsZXZlbCB2ZXJzaW9uIGlmIG1pc3NpbmcKICAgIGwgPSB2ZXJzaW9uLnNwbGl0KCcuJykKICAgIGlmIGxlbihsKSA9PSAyOgogICAgICAgIGwuYXBwZW5kKCcwJykKICAgICAgICB2ZXJzaW9uID0gJy4nLmpvaW4obCkKCiAgICAjIEJ1aWxkIGFuZCBjYWNoZSB0aGUgcmVzdWx0CiAgICByZXN1bHQgPSAobmFtZSwgdmVyc2lvbiwgYnJhbmNoLCByZXZpc2lvbiwgYnVpbGRubywgYnVpbGRkYXRlLCBjb21waWxlcikKICAgIF9zeXNfdmVyc2lvbl9jYWNoZVtzeXNfdmVyc2lvbl0gPSByZXN1bHQKICAgIHJldHVybiByZXN1bHQKCmRlZiBweXRob25faW1wbGVtZW50YXRpb24oKToKCiAgICAiIiIgUmV0dXJucyBhIHN0cmluZyBpZGVudGlmeWluZyB0aGUgUHl0aG9uIGltcGxlbWVudGF0aW9uLgoKICAgICAgICBDdXJyZW50bHksIHRoZSBmb2xsb3dpbmcgaW1wbGVtZW50YXRpb25zIGFyZSBpZGVudGlmaWVkOgogICAgICAgICAgJ0NQeXRob24nIChDIGltcGxlbWVudGF0aW9uIG9mIFB5dGhvbiksCiAgICAgICAgICAnSXJvblB5dGhvbicgKC5ORVQgaW1wbGVtZW50YXRpb24gb2YgUHl0aG9uKSwKICAgICAgICAgICdKeXRob24nIChKYXZhIGltcGxlbWVudGF0aW9uIG9mIFB5dGhvbiksCiAgICAgICAgICAnUHlQeScgKFB5dGhvbiBpbXBsZW1lbnRhdGlvbiBvZiBQeXRob24pLgoKICAgICIiIgogICAgcmV0dXJuIF9zeXNfdmVyc2lvbigpWzBdCgpkZWYgcHl0aG9uX3ZlcnNpb24oKToKCiAgICAiIiIgUmV0dXJucyB0aGUgUHl0aG9uIHZlcnNpb24gYXMgc3RyaW5nICdtYWpvci5taW5vci5wYXRjaGxldmVsJwoKICAgICAgICBOb3RlIHRoYXQgdW5saWtlIHRoZSBQeXRob24gc3lzLnZlcnNpb24sIHRoZSByZXR1cm5lZCB2YWx1ZQogICAgICAgIHdpbGwgYWx3YXlzIGluY2x1ZGUgdGhlIHBhdGNobGV2ZWwgKGl0IGRlZmF1bHRzIHRvIDApLgoKICAgICIiIgogICAgcmV0dXJuIF9zeXNfdmVyc2lvbigpWzFdCgpkZWYgcHl0aG9uX3ZlcnNpb25fdHVwbGUoKToKCiAgICAiIiIgUmV0dXJucyB0aGUgUHl0aG9uIHZlcnNpb24gYXMgdHVwbGUgKG1ham9yLCBtaW5vciwgcGF0Y2hsZXZlbCkKICAgICAgICBvZiBzdHJpbmdzLgoKICAgICAgICBOb3RlIHRoYXQgdW5saWtlIHRoZSBQeXRob24gc3lzLnZlcnNpb24sIHRoZSByZXR1cm5lZCB2YWx1ZQogICAgICAgIHdpbGwgYWx3YXlzIGluY2x1ZGUgdGhlIHBhdGNobGV2ZWwgKGl0IGRlZmF1bHRzIHRvIDApLgoKICAgICIiIgogICAgcmV0dXJuIHR1cGxlKF9zeXNfdmVyc2lvbigpWzFdLnNwbGl0KCcuJykpCgpkZWYgcHl0aG9uX2JyYW5jaCgpOgoKICAgICIiIiBSZXR1cm5zIGEgc3RyaW5nIGlkZW50aWZ5aW5nIHRoZSBQeXRob24gaW1wbGVtZW50YXRpb24KICAgICAgICBicmFuY2guCgogICAgICAgIEZvciBDUHl0aG9uIHRoaXMgaXMgdGhlIFN1YnZlcnNpb24gYnJhbmNoIGZyb20gd2hpY2ggdGhlCiAgICAgICAgUHl0aG9uIGJpbmFyeSB3YXMgYnVpbHQuCgogICAgICAgIElmIG5vdCBhdmFpbGFibGUsIGFuIGVtcHR5IHN0cmluZyBpcyByZXR1cm5lZC4KCiAgICAiIiIKCiAgICByZXR1cm4gX3N5c192ZXJzaW9uKClbMl0KCmRlZiBweXRob25fcmV2aXNpb24oKToKCiAgICAiIiIgUmV0dXJucyBhIHN0cmluZyBpZGVudGlmeWluZyB0aGUgUHl0aG9uIGltcGxlbWVudGF0aW9uCiAgICAgICAgcmV2aXNpb24uCgogICAgICAgIEZvciBDUHl0aG9uIHRoaXMgaXMgdGhlIFN1YnZlcnNpb24gcmV2aXNpb24gZnJvbSB3aGljaCB0aGUKICAgICAgICBQeXRob24gYmluYXJ5IHdhcyBidWlsdC4KCiAgICAgICAgSWYgbm90IGF2YWlsYWJsZSwgYW4gZW1wdHkgc3RyaW5nIGlzIHJldHVybmVkLgoKICAgICIiIgogICAgcmV0dXJuIF9zeXNfdmVyc2lvbigpWzNdCgpkZWYgcHl0aG9uX2J1aWxkKCk6CgogICAgIiIiIFJldHVybnMgYSB0dXBsZSAoYnVpbGRubywgYnVpbGRkYXRlKSBzdGF0aW5nIHRoZSBQeXRob24KICAgICAgICBidWlsZCBudW1iZXIgYW5kIGRhdGUgYXMgc3RyaW5ncy4KCiAgICAiIiIKICAgIHJldHVybiBfc3lzX3ZlcnNpb24oKVs0OjZdCgpkZWYgcHl0aG9uX2NvbXBpbGVyKCk6CgogICAgIiIiIFJldHVybnMgYSBzdHJpbmcgaWRlbnRpZnlpbmcgdGhlIGNvbXBpbGVyIHVzZWQgZm9yIGNvbXBpbGluZwogICAgICAgIFB5dGhvbi4KCiAgICAiIiIKICAgIHJldHVybiBfc3lzX3ZlcnNpb24oKVs2XQoKIyMjIFRoZSBPcHVzIE1hZ251bSBvZiBwbGF0Zm9ybSBzdHJpbmdzIDotKQoKX3BsYXRmb3JtX2NhY2hlID0ge30KCmRlZiBwbGF0Zm9ybShhbGlhc2VkPTAsIHRlcnNlPTApOgoKICAgICIiIiBSZXR1cm5zIGEgc2luZ2xlIHN0cmluZyBpZGVudGlmeWluZyB0aGUgdW5kZXJseWluZyBwbGF0Zm9ybQogICAgICAgIHdpdGggYXMgbXVjaCB1c2VmdWwgaW5mb3JtYXRpb24gYXMgcG9zc2libGUgKGJ1dCBubyBtb3JlIDopLgoKICAgICAgICBUaGUgb3V0cHV0IGlzIGludGVuZGVkIHRvIGJlIGh1bWFuIHJlYWRhYmxlIHJhdGhlciB0aGFuCiAgICAgICAgbWFjaGluZSBwYXJzZWFibGUuIEl0IG1heSBsb29rIGRpZmZlcmVudCBvbiBkaWZmZXJlbnQKICAgICAgICBwbGF0Zm9ybXMgYW5kIHRoaXMgaXMgaW50ZW5kZWQuCgogICAgICAgIElmICJhbGlhc2VkIiBpcyB0cnVlLCB0aGUgZnVuY3Rpb24gd2lsbCB1c2UgYWxpYXNlcyBmb3IKICAgICAgICB2YXJpb3VzIHBsYXRmb3JtcyB0aGF0IHJlcG9ydCBzeXN0ZW0gbmFtZXMgd2hpY2ggZGlmZmVyIGZyb20KICAgICAgICB0aGVpciBjb21tb24gbmFtZXMsIGUuZy4gU3VuT1Mgd2lsbCBiZSByZXBvcnRlZCBhcwogICAgICAgIFNvbGFyaXMuIFRoZSBzeXN0ZW1fYWxpYXMoKSBmdW5jdGlvbiBpcyB1c2VkIHRvIGltcGxlbWVudAogICAgICAgIHRoaXMuCgogICAgICAgIFNldHRpbmcgdGVyc2UgdG8gdHJ1ZSBjYXVzZXMgdGhlIGZ1bmN0aW9uIHRvIHJldHVybiBvbmx5IHRoZQogICAgICAgIGFic29sdXRlIG1pbmltdW0gaW5mb3JtYXRpb24gbmVlZGVkIHRvIGlkZW50aWZ5IHRoZSBwbGF0Zm9ybS4KCiAgICAiIiIKICAgIHJlc3VsdCA9IF9wbGF0Zm9ybV9jYWNoZS5nZXQoKGFsaWFzZWQsIHRlcnNlKSwgTm9uZSkKICAgIGlmIHJlc3VsdCBpcyBub3QgTm9uZToKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgIyBHZXQgdW5hbWUgaW5mb3JtYXRpb24gYW5kIHRoZW4gYXBwbHkgcGxhdGZvcm0gc3BlY2lmaWMgY29zbWV0aWNzCiAgICAjIHRvIGl0Li4uCiAgICBzeXN0ZW0sbm9kZSxyZWxlYXNlLHZlcnNpb24sbWFjaGluZSxwcm9jZXNzb3IgPSB1bmFtZSgpCiAgICBpZiBtYWNoaW5lID09IHByb2Nlc3NvcjoKICAgICAgICBwcm9jZXNzb3IgPSAnJwogICAgaWYgYWxpYXNlZDoKICAgICAgICBzeXN0ZW0scmVsZWFzZSx2ZXJzaW9uID0gc3lzdGVtX2FsaWFzKHN5c3RlbSxyZWxlYXNlLHZlcnNpb24pCgogICAgaWYgc3lzdGVtID09ICdXaW5kb3dzJzoKICAgICAgICAjIE1TIHBsYXRmb3JtcwogICAgICAgIHJlbCx2ZXJzLGNzZCxwdHlwZSA9IHdpbjMyX3Zlcih2ZXJzaW9uKQogICAgICAgIGlmIHRlcnNlOgogICAgICAgICAgICBwbGF0Zm9ybSA9IF9wbGF0Zm9ybShzeXN0ZW0scmVsZWFzZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwbGF0Zm9ybSA9IF9wbGF0Zm9ybShzeXN0ZW0scmVsZWFzZSx2ZXJzaW9uLGNzZCkKCiAgICBlbGlmIHN5c3RlbSBpbiAoJ0xpbnV4JywpOgogICAgICAgICMgTGludXggYmFzZWQgc3lzdGVtcwogICAgICAgIGRpc3RuYW1lLGRpc3R2ZXJzaW9uLGRpc3RpZCA9IGRpc3QoJycpCiAgICAgICAgaWYgZGlzdG5hbWUgYW5kIG5vdCB0ZXJzZToKICAgICAgICAgICAgcGxhdGZvcm0gPSBfcGxhdGZvcm0oc3lzdGVtLHJlbGVhc2UsbWFjaGluZSxwcm9jZXNzb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd3aXRoJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzdG5hbWUsZGlzdHZlcnNpb24sZGlzdGlkKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgSWYgdGhlIGRpc3RyaWJ1dGlvbiBuYW1lIGlzIHVua25vd24gY2hlY2sgZm9yIGxpYmMgdnMuIGdsaWJjCiAgICAgICAgICAgIGxpYmNuYW1lLGxpYmN2ZXJzaW9uID0gbGliY192ZXIoc3lzLmV4ZWN1dGFibGUpCiAgICAgICAgICAgIHBsYXRmb3JtID0gX3BsYXRmb3JtKHN5c3RlbSxyZWxlYXNlLG1hY2hpbmUscHJvY2Vzc29yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnd2l0aCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYmNuYW1lK2xpYmN2ZXJzaW9uKQogICAgZWxpZiBzeXN0ZW0gPT0gJ0phdmEnOgogICAgICAgICMgSmF2YSBwbGF0Zm9ybXMKICAgICAgICByLHYsdm1pbmZvLChvc19uYW1lLG9zX3ZlcnNpb24sb3NfYXJjaCkgPSBqYXZhX3ZlcigpCiAgICAgICAgaWYgdGVyc2Ugb3Igbm90IG9zX25hbWU6CiAgICAgICAgICAgIHBsYXRmb3JtID0gX3BsYXRmb3JtKHN5c3RlbSxyZWxlYXNlLHZlcnNpb24pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcGxhdGZvcm0gPSBfcGxhdGZvcm0oc3lzdGVtLHJlbGVhc2UsdmVyc2lvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29uJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3NfbmFtZSxvc192ZXJzaW9uLG9zX2FyY2gpCgogICAgZWxpZiBzeXN0ZW0gPT0gJ01hY09TJzoKICAgICAgICAjIE1hY09TIHBsYXRmb3JtcwogICAgICAgIGlmIHRlcnNlOgogICAgICAgICAgICBwbGF0Zm9ybSA9IF9wbGF0Zm9ybShzeXN0ZW0scmVsZWFzZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwbGF0Zm9ybSA9IF9wbGF0Zm9ybShzeXN0ZW0scmVsZWFzZSxtYWNoaW5lKQoKICAgIGVsc2U6CiAgICAgICAgIyBHZW5lcmljIGhhbmRsZXIKICAgICAgICBpZiB0ZXJzZToKICAgICAgICAgICAgcGxhdGZvcm0gPSBfcGxhdGZvcm0oc3lzdGVtLHJlbGVhc2UpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYml0cyxsaW5rYWdlID0gYXJjaGl0ZWN0dXJlKHN5cy5leGVjdXRhYmxlKQogICAgICAgICAgICBwbGF0Zm9ybSA9IF9wbGF0Zm9ybShzeXN0ZW0scmVsZWFzZSxtYWNoaW5lLHByb2Nlc3NvcixiaXRzLGxpbmthZ2UpCgogICAgX3BsYXRmb3JtX2NhY2hlWyhhbGlhc2VkLCB0ZXJzZSldID0gcGxhdGZvcm0KICAgIHJldHVybiBwbGF0Zm9ybQoKIyMjIENvbW1hbmQgbGluZSBpbnRlcmZhY2UKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICAjIERlZmF1bHQgaXMgdG8gcHJpbnQgdGhlIGFsaWFzZWQgdmVyYm9zZSBwbGF0Zm9ybSBzdHJpbmcKICAgIHRlcnNlID0gKCd0ZXJzZScgaW4gc3lzLmFyZ3Ygb3IgJy0tdGVyc2UnIGluIHN5cy5hcmd2KQogICAgYWxpYXNlZCA9IChub3QgJ25vbmFsaWFzZWQnIGluIHN5cy5hcmd2IGFuZCBub3QgJy0tbm9uYWxpYXNlZCcgaW4gc3lzLmFyZ3YpCiAgICBwcmludChwbGF0Zm9ybShhbGlhc2VkLHRlcnNlKSkKICAgIHN5cy5leGl0KDApCg==',
'/Lib/posix.py':'IiIiVGhpcyBtb2R1bGUgcHJvdmlkZXMgYWNjZXNzIHRvIG9wZXJhdGluZyBzeXN0ZW0gZnVuY3Rpb25hbGl0eSB0aGF0IGlzCnN0YW5kYXJkaXplZCBieSB0aGUgQyBTdGFuZGFyZCBhbmQgdGhlIFBPU0lYIHN0YW5kYXJkIChhIHRoaW5seQpkaXNndWlzZWQgVW5peCBpbnRlcmZhY2UpLiAgUmVmZXIgdG8gdGhlIGxpYnJhcnkgbWFudWFsIGFuZApjb3JyZXNwb25kaW5nIFVuaXggbWFudWFsIGVudHJpZXMgZm9yIG1vcmUgaW5mb3JtYXRpb24gb24gY2FsbHMuIiIiCgoKRl9PSyA9IDAKCk9fQVBQRU5EID0gOAoKT19CSU5BUlkgPSAzMjc2OAoKT19DUkVBVCA9IDI1NgoKT19FWENMID0gMTAyNAoKT19OT0lOSEVSSVQgPSAxMjgKCk9fUkFORE9NID0gMTYKCk9fUkRPTkxZID0gMAoKT19SRFdSID0gMgoKT19TRVFVRU5USUFMID0gMzIKCk9fU0hPUlRfTElWRUQgPSA0MDk2CgpPX1RFTVBPUkFSWSA9IDY0CgpPX1RFWFQgPSAxNjM4NAoKT19UUlVOQyA9IDUxMgoKT19XUk9OTFkgPSAxCgpQX0RFVEFDSCA9IDQKClBfTk9XQUlUID0gMQoKUF9OT1dBSVRPID0gMwoKUF9PVkVSTEFZID0gMgoKUF9XQUlUID0gMAoKUl9PSyA9IDQKClRNUF9NQVggPSAzMjc2NwoKV19PSyA9IDIKClhfT0sgPSAxCgpjbGFzcyBfX2xvYWRlcl9fOgogICAgcGFzcwoKZGVmIF9leGl0KCphcmdzLCoqa3cpOgogICAgIiIiX2V4aXQoc3RhdHVzKSAgICAKICAgIEV4aXQgdG8gdGhlIHN5c3RlbSB3aXRoIHNwZWNpZmllZCBzdGF0dXMsIHdpdGhvdXQgbm9ybWFsIGV4aXQgcHJvY2Vzc2luZy4iIiIKICAgIHBhc3MKCmRlZiBfZ2V0ZGlza3VzYWdlKCphcmdzLCoqa3cpOgogICAgIiIiX2dldGRpc2t1c2FnZShwYXRoKSAtPiAodG90YWwsIGZyZWUpICAgIAogICAgUmV0dXJuIGRpc2sgdXNhZ2Ugc3RhdGlzdGljcyBhYm91dCB0aGUgZ2l2ZW4gcGF0aCBhcyAodG90YWwsIGZyZWUpIHR1cGxlLiIiIgogICAgcGFzcwoKZGVmIF9nZXRmaWxlaW5mb3JtYXRpb24oKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgX2dldGZpbmFscGF0aG5hbWUoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgX2dldGZ1bGxwYXRobmFtZSgqYXJncywqKmt3KToKICAgIHBhc3MKCl9oYXZlX2Z1bmN0aW9ucyA9IFsnTVNfV0lORE9XUyddCgpkZWYgX2lzZGlyKCphcmdzLCoqa3cpOgogICAgIiIiUmV0dXJuIHRydWUgaWYgdGhlIHBhdGhuYW1lIHJlZmVycyB0byBhbiBleGlzdGluZyBkaXJlY3RvcnkuIiIiCiAgICBwYXNzCgpkZWYgYWJvcnQoKmFyZ3MsKiprdyk6CiAgICAiIiJhYm9ydCgpIC0+IGRvZXMgbm90IHJldHVybiEgICAgCiAgICBBYm9ydCB0aGUgaW50ZXJwcmV0ZXIgaW1tZWRpYXRlbHkuICBUaGlzICdkdW1wcyBjb3JlJyBvciBvdGhlcndpc2UgZmFpbHMKICAgIGluIHRoZSBoYXJkZXN0IHdheSBwb3NzaWJsZSBvbiB0aGUgaG9zdGluZyBvcGVyYXRpbmcgc3lzdGVtLiIiIgogICAgcGFzcwoKZGVmIGFjY2VzcygqYXJncywqKmt3KToKICAgICIiImFjY2VzcyhwYXRoLCBtb2RlLCAqLCBkaXJfZmQ9Tm9uZSwgZWZmZWN0aXZlX2lkcz1GYWxzZSwgZm9sbG93X3N5bWxpbmtzPVRydWUpICAgIAogICAgVXNlIHRoZSByZWFsIHVpZC9naWQgdG8gdGVzdCBmb3IgYWNjZXNzIHRvIGEgcGF0aC4gIFJldHVybnMgVHJ1ZSBpZiBncmFudGVkLAogICAgRmFsc2Ugb3RoZXJ3aXNlLgogICAgCiAgICBJZiBkaXJfZmQgaXMgbm90IE5vbmUsIGl0IHNob3VsZCBiZSBhIGZpbGUgZGVzY3JpcHRvciBvcGVuIHRvIGEgZGlyZWN0b3J5LAogICAgICBhbmQgcGF0aCBzaG91bGQgYmUgcmVsYXRpdmU7IHBhdGggd2lsbCB0aGVuIGJlIHJlbGF0aXZlIHRvIHRoYXQgZGlyZWN0b3J5LgogICAgSWYgZWZmZWN0aXZlX2lkcyBpcyBUcnVlLCBhY2Nlc3Mgd2lsbCB1c2UgdGhlIGVmZmVjdGl2ZSB1aWQvZ2lkIGluc3RlYWQgb2YKICAgICAgdGhlIHJlYWwgdWlkL2dpZC4KICAgIElmIGZvbGxvd19zeW1saW5rcyBpcyBGYWxzZSwgYW5kIHRoZSBsYXN0IGVsZW1lbnQgb2YgdGhlIHBhdGggaXMgYSBzeW1ib2xpYwogICAgICBsaW5rLCBhY2Nlc3Mgd2lsbCBleGFtaW5lIHRoZSBzeW1ib2xpYyBsaW5rIGl0c2VsZiBpbnN0ZWFkIG9mIHRoZSBmaWxlIHRoZQogICAgICBsaW5rIHBvaW50cyB0by4KICAgIGRpcl9mZCwgZWZmZWN0aXZlX2lkcywgYW5kIGZvbGxvd19zeW1saW5rcyBtYXkgbm90IGJlIGltcGxlbWVudGVkCiAgICAgIG9uIHlvdXIgcGxhdGZvcm0uICBJZiB0aGV5IGFyZSB1bmF2YWlsYWJsZSwgdXNpbmcgdGhlbSB3aWxsIHJhaXNlIGEKICAgICAgTm90SW1wbGVtZW50ZWRFcnJvci4KICAgIAogICAgTm90ZSB0aGF0IG1vc3Qgb3BlcmF0aW9ucyB3aWxsIHVzZSB0aGUgZWZmZWN0aXZlIHVpZC9naWQsIHRoZXJlZm9yZSB0aGlzCiAgICAgIHJvdXRpbmUgY2FuIGJlIHVzZWQgaW4gYSBzdWlkL3NnaWQgZW52aXJvbm1lbnQgdG8gdGVzdCBpZiB0aGUgaW52b2tpbmcgdXNlcgogICAgICBoYXMgdGhlIHNwZWNpZmllZCBhY2Nlc3MgdG8gdGhlIHBhdGguCiAgICBUaGUgbW9kZSBhcmd1bWVudCBjYW4gYmUgRl9PSyB0byB0ZXN0IGV4aXN0ZW5jZSwgb3IgdGhlIGluY2x1c2l2ZS1PUgogICAgICBvZiBSX09LLCBXX09LLCBhbmQgWF9PSy4iIiIKICAgIHBhc3MKCmRlZiBjaGRpcigqYXJncywqKmt3KToKICAgICIiImNoZGlyKHBhdGgpICAgIAogICAgQ2hhbmdlIHRoZSBjdXJyZW50IHdvcmtpbmcgZGlyZWN0b3J5IHRvIHRoZSBzcGVjaWZpZWQgcGF0aC4KICAgIAogICAgcGF0aCBtYXkgYWx3YXlzIGJlIHNwZWNpZmllZCBhcyBhIHN0cmluZy4KICAgIE9uIHNvbWUgcGxhdGZvcm1zLCBwYXRoIG1heSBhbHNvIGJlIHNwZWNpZmllZCBhcyBhbiBvcGVuIGZpbGUgZGVzY3JpcHRvci4KICAgICAgSWYgdGhpcyBmdW5jdGlvbmFsaXR5IGlzIHVuYXZhaWxhYmxlLCB1c2luZyBpdCByYWlzZXMgYW4gZXhjZXB0aW9uLiIiIgogICAgcGFzcwoKZGVmIGNobW9kKCphcmdzLCoqa3cpOgogICAgIiIiY2htb2QocGF0aCwgbW9kZSwgKiwgZGlyX2ZkPU5vbmUsIGZvbGxvd19zeW1saW5rcz1UcnVlKSAgICAKICAgIENoYW5nZSB0aGUgYWNjZXNzIHBlcm1pc3Npb25zIG9mIGEgZmlsZS4KICAgIAogICAgcGF0aCBtYXkgYWx3YXlzIGJlIHNwZWNpZmllZCBhcyBhIHN0cmluZy4KICAgIE9uIHNvbWUgcGxhdGZvcm1zLCBwYXRoIG1heSBhbHNvIGJlIHNwZWNpZmllZCBhcyBhbiBvcGVuIGZpbGUgZGVzY3JpcHRvci4KICAgICAgSWYgdGhpcyBmdW5jdGlvbmFsaXR5IGlzIHVuYXZhaWxhYmxlLCB1c2luZyBpdCByYWlzZXMgYW4gZXhjZXB0aW9uLgogICAgSWYgZGlyX2ZkIGlzIG5vdCBOb25lLCBpdCBzaG91bGQgYmUgYSBmaWxlIGRlc2NyaXB0b3Igb3BlbiB0byBhIGRpcmVjdG9yeSwKICAgICAgYW5kIHBhdGggc2hvdWxkIGJlIHJlbGF0aXZlOyBwYXRoIHdpbGwgdGhlbiBiZSByZWxhdGl2ZSB0byB0aGF0IGRpcmVjdG9yeS4KICAgIElmIGZvbGxvd19zeW1saW5rcyBpcyBGYWxzZSwgYW5kIHRoZSBsYXN0IGVsZW1lbnQgb2YgdGhlIHBhdGggaXMgYSBzeW1ib2xpYwogICAgICBsaW5rLCBjaG1vZCB3aWxsIG1vZGlmeSB0aGUgc3ltYm9saWMgbGluayBpdHNlbGYgaW5zdGVhZCBvZiB0aGUgZmlsZSB0aGUKICAgICAgbGluayBwb2ludHMgdG8uCiAgICBJdCBpcyBhbiBlcnJvciB0byB1c2UgZGlyX2ZkIG9yIGZvbGxvd19zeW1saW5rcyB3aGVuIHNwZWNpZnlpbmcgcGF0aCBhcwogICAgICBhbiBvcGVuIGZpbGUgZGVzY3JpcHRvci4KICAgIGRpcl9mZCBhbmQgZm9sbG93X3N5bWxpbmtzIG1heSBub3QgYmUgaW1wbGVtZW50ZWQgb24geW91ciBwbGF0Zm9ybS4KICAgICAgSWYgdGhleSBhcmUgdW5hdmFpbGFibGUsIHVzaW5nIHRoZW0gd2lsbCByYWlzZSBhIE5vdEltcGxlbWVudGVkRXJyb3IuIiIiCiAgICBwYXNzCgpkZWYgY2xvc2UoKmFyZ3MsKiprdyk6CiAgICAiIiJjbG9zZShmZCkgICAgCiAgICBDbG9zZSBhIGZpbGUgZGVzY3JpcHRvciAoZm9yIGxvdyBsZXZlbCBJTykuIiIiCiAgICBwYXNzCgpkZWYgY2xvc2VyYW5nZSgqYXJncywqKmt3KToKICAgICIiImNsb3NlcmFuZ2UoZmRfbG93LCBmZF9oaWdoKSAgICAKICAgIENsb3NlcyBhbGwgZmlsZSBkZXNjcmlwdG9ycyBpbiBbZmRfbG93LCBmZF9oaWdoKSwgaWdub3JpbmcgZXJyb3JzLiIiIgogICAgcGFzcwoKZGVmIGRldmljZV9lbmNvZGluZygqYXJncywqKmt3KToKICAgICIiImRldmljZV9lbmNvZGluZyhmZCkgLT4gc3RyICAgIAogICAgUmV0dXJuIGEgc3RyaW5nIGRlc2NyaWJpbmcgdGhlIGVuY29kaW5nIG9mIHRoZSBkZXZpY2UKICAgIGlmIHRoZSBvdXRwdXQgaXMgYSB0ZXJtaW5hbDsgZWxzZSByZXR1cm4gTm9uZS4iIiIKICAgIHBhc3MKCmRlZiBkdXAoKmFyZ3MsKiprdyk6CiAgICAiIiJkdXAoZmQpIC0+IGZkMiAgICAKICAgIFJldHVybiBhIGR1cGxpY2F0ZSBvZiBhIGZpbGUgZGVzY3JpcHRvci4iIiIKICAgIHBhc3MKCmRlZiBkdXAyKCphcmdzLCoqa3cpOgogICAgIiIiZHVwMihvbGRfZmQsIG5ld19mZCkgICAgCiAgICBEdXBsaWNhdGUgZmlsZSBkZXNjcmlwdG9yLiIiIgogICAgcGFzcwoKZW52aXJvbiA9IHt9CgplcnJvciA9IE9TRXJyb3IKCmRlZiBleGVjdigqYXJncywqKmt3KToKICAgICIiImV4ZWN2KHBhdGgsIGFyZ3MpICAgIAogICAgRXhlY3V0ZSBhbiBleGVjdXRhYmxlIHBhdGggd2l0aCBhcmd1bWVudHMsIHJlcGxhY2luZyBjdXJyZW50IHByb2Nlc3MuCiAgICAKICAgICAgICBwYXRoOiBwYXRoIG9mIGV4ZWN1dGFibGUgZmlsZQogICAgICAgIGFyZ3M6IHR1cGxlIG9yIGxpc3Qgb2Ygc3RyaW5ncyIiIgogICAgcGFzcwoKZGVmIGV4ZWN2ZSgqYXJncywqKmt3KToKICAgICIiImV4ZWN2ZShwYXRoLCBhcmdzLCBlbnYpICAgIAogICAgRXhlY3V0ZSBhIHBhdGggd2l0aCBhcmd1bWVudHMgYW5kIGVudmlyb25tZW50LCByZXBsYWNpbmcgY3VycmVudCBwcm9jZXNzLgogICAgCiAgICAgICAgcGF0aDogcGF0aCBvZiBleGVjdXRhYmxlIGZpbGUKICAgICAgICBhcmdzOiB0dXBsZSBvciBsaXN0IG9mIGFyZ3VtZW50cwogICAgICAgIGVudjogZGljdGlvbmFyeSBvZiBzdHJpbmdzIG1hcHBpbmcgdG8gc3RyaW5ncwogICAgCiAgICBPbiBzb21lIHBsYXRmb3JtcywgeW91IG1heSBzcGVjaWZ5IGFuIG9wZW4gZmlsZSBkZXNjcmlwdG9yIGZvciBwYXRoOwogICAgICBleGVjdmUgd2lsbCBleGVjdXRlIHRoZSBwcm9ncmFtIHRoZSBmaWxlIGRlc2NyaXB0b3IgaXMgb3BlbiB0by4KICAgICAgSWYgdGhpcyBmdW5jdGlvbmFsaXR5IGlzIHVuYXZhaWxhYmxlLCB1c2luZyBpdCByYWlzZXMgTm90SW1wbGVtZW50ZWRFcnJvci4iIiIKICAgIHBhc3MKCmRlZiBmc3RhdCgqYXJncywqKmt3KToKICAgICIiImZzdGF0KGZkKSAtPiBzdGF0IHJlc3VsdCAgICAKICAgIExpa2Ugc3RhdCgpLCBidXQgZm9yIGFuIG9wZW4gZmlsZSBkZXNjcmlwdG9yLgogICAgRXF1aXZhbGVudCB0byBzdGF0KGZkPWZkKS4iIiIKICAgIHBhc3MKCmRlZiBmc3luYygqYXJncywqKmt3KToKICAgICIiImZzeW5jKGZpbGRlcykgICAgCiAgICBmb3JjZSB3cml0ZSBvZiBmaWxlIHdpdGggZmlsZWRlc2NyaXB0b3IgdG8gZGlzay4iIiIKICAgIHBhc3MKCmRlZiBnZXRfdGVybWluYWxfc2l6ZSgqYXJncywqKmt3KToKICAgICIiIlJldHVybiB0aGUgc2l6ZSBvZiB0aGUgdGVybWluYWwgd2luZG93IGFzIChjb2x1bW5zLCBsaW5lcykuICAgIAogICAgVGhlIG9wdGlvbmFsIGFyZ3VtZW50IGZkIChkZWZhdWx0IHN0YW5kYXJkIG91dHB1dCkgc3BlY2lmaWVzCiAgICB3aGljaCBmaWxlIGRlc2NyaXB0b3Igc2hvdWxkIGJlIHF1ZXJpZWQuCiAgICAKICAgIElmIHRoZSBmaWxlIGRlc2NyaXB0b3IgaXMgbm90IGNvbm5lY3RlZCB0byBhIHRlcm1pbmFsLCBhbiBPU0Vycm9yCiAgICBpcyB0aHJvd24uCiAgICAKICAgIFRoaXMgZnVuY3Rpb24gd2lsbCBvbmx5IGJlIGRlZmluZWQgaWYgYW4gaW1wbGVtZW50YXRpb24gaXMKICAgIGF2YWlsYWJsZSBmb3IgdGhpcyBzeXN0ZW0uCiAgICAKICAgIHNodXRpbC5nZXRfdGVybWluYWxfc2l6ZSBpcyB0aGUgaGlnaC1sZXZlbCBmdW5jdGlvbiB3aGljaCBzaG91bGQgCiAgICBub3JtYWxseSBiZSB1c2VkLCBvcy5nZXRfdGVybWluYWxfc2l6ZSBpcyB0aGUgbG93LWxldmVsIGltcGxlbWVudGF0aW9uLiIiIgogICAgcGFzcwoKZGVmIGdldGN3ZCgqYXJncywqKmt3KToKICAgICIiImdldGN3ZCgpIC0+IHBhdGggICAgCiAgICBSZXR1cm4gYSB1bmljb2RlIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGN1cnJlbnQgd29ya2luZyBkaXJlY3RvcnkuIiIiCiAgICBwYXNzCgpkZWYgZ2V0Y3dkYigqYXJncywqKmt3KToKICAgICIiImdldGN3ZGIoKSAtPiBwYXRoICAgIAogICAgUmV0dXJuIGEgYnl0ZXMgc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgY3VycmVudCB3b3JraW5nIGRpcmVjdG9yeS4iIiIKICAgIHBhc3MKCmRlZiBnZXRsb2dpbigqYXJncywqKmt3KToKICAgICIiImdldGxvZ2luKCkgLT4gc3RyaW5nICAgIAogICAgUmV0dXJuIHRoZSBhY3R1YWwgbG9naW4gbmFtZS4iIiIKICAgIHBhc3MKCmRlZiBnZXRwaWQoKmFyZ3MsKiprdyk6CiAgICAiIiJnZXRwaWQoKSAtPiBwaWQgICAgCiAgICBSZXR1cm4gdGhlIGN1cnJlbnQgcHJvY2VzcyBpZCIiIgogICAgcGFzcwoKZGVmIGdldHBwaWQoKmFyZ3MsKiprdyk6CiAgICAiIiJnZXRwcGlkKCkgLT4gcHBpZCAgICAKICAgIFJldHVybiB0aGUgcGFyZW50J3MgcHJvY2VzcyBpZC4gIElmIHRoZSBwYXJlbnQgcHJvY2VzcyBoYXMgYWxyZWFkeSBleGl0ZWQsCiAgICBXaW5kb3dzIG1hY2hpbmVzIHdpbGwgc3RpbGwgcmV0dXJuIGl0cyBpZDsgb3RoZXJzIHN5c3RlbXMgd2lsbCByZXR1cm4gdGhlIGlkCiAgICBvZiB0aGUgJ2luaXQnIHByb2Nlc3MgKDEpLiIiIgogICAgcGFzcwoKZGVmIGlzYXR0eSgqYXJncywqKmt3KToKICAgICIiImlzYXR0eShmZCkgLT4gYm9vbCAgICAKICAgIFJldHVybiBUcnVlIGlmIHRoZSBmaWxlIGRlc2NyaXB0b3IgJ2ZkJyBpcyBhbiBvcGVuIGZpbGUgZGVzY3JpcHRvcgogICAgY29ubmVjdGVkIHRvIHRoZSBzbGF2ZSBlbmQgb2YgYSB0ZXJtaW5hbC4iIiIKICAgIHBhc3MKCmRlZiBraWxsKCphcmdzLCoqa3cpOgogICAgIiIia2lsbChwaWQsIHNpZykgICAgCiAgICBLaWxsIGEgcHJvY2VzcyB3aXRoIGEgc2lnbmFsLiIiIgogICAgcGFzcwoKZGVmIGxpbmsoKmFyZ3MsKiprdyk6CiAgICAiIiJsaW5rKHNyYywgZHN0LCAqLCBzcmNfZGlyX2ZkPU5vbmUsIGRzdF9kaXJfZmQ9Tm9uZSwgZm9sbG93X3N5bWxpbmtzPVRydWUpICAgIAogICAgQ3JlYXRlIGEgaGFyZCBsaW5rIHRvIGEgZmlsZS4KICAgIAogICAgSWYgZWl0aGVyIHNyY19kaXJfZmQgb3IgZHN0X2Rpcl9mZCBpcyBub3QgTm9uZSwgaXQgc2hvdWxkIGJlIGEgZmlsZQogICAgICBkZXNjcmlwdG9yIG9wZW4gdG8gYSBkaXJlY3RvcnksIGFuZCB0aGUgcmVzcGVjdGl2ZSBwYXRoIHN0cmluZyAoc3JjIG9yIGRzdCkKICAgICAgc2hvdWxkIGJlIHJlbGF0aXZlOyB0aGUgcGF0aCB3aWxsIHRoZW4gYmUgcmVsYXRpdmUgdG8gdGhhdCBkaXJlY3RvcnkuCiAgICBJZiBmb2xsb3dfc3ltbGlua3MgaXMgRmFsc2UsIGFuZCB0aGUgbGFzdCBlbGVtZW50IG9mIHNyYyBpcyBhIHN5bWJvbGljCiAgICAgIGxpbmssIGxpbmsgd2lsbCBjcmVhdGUgYSBsaW5rIHRvIHRoZSBzeW1ib2xpYyBsaW5rIGl0c2VsZiBpbnN0ZWFkIG9mIHRoZQogICAgICBmaWxlIHRoZSBsaW5rIHBvaW50cyB0by4KICAgIHNyY19kaXJfZmQsIGRzdF9kaXJfZmQsIGFuZCBmb2xsb3dfc3ltbGlua3MgbWF5IG5vdCBiZSBpbXBsZW1lbnRlZCBvbiB5b3VyCiAgICAgIHBsYXRmb3JtLiAgSWYgdGhleSBhcmUgdW5hdmFpbGFibGUsIHVzaW5nIHRoZW0gd2lsbCByYWlzZSBhCiAgICAgIE5vdEltcGxlbWVudGVkRXJyb3IuIiIiCiAgICBwYXNzCgpkZWYgbGlzdGRpcigqYXJncywqKmt3KToKICAgICIiImxpc3RkaXIocGF0aD0nLicpIC0+IGxpc3Rfb2ZfZmlsZW5hbWVzICAgIAogICAgUmV0dXJuIGEgbGlzdCBjb250YWluaW5nIHRoZSBuYW1lcyBvZiB0aGUgZmlsZXMgaW4gdGhlIGRpcmVjdG9yeS4KICAgIFRoZSBsaXN0IGlzIGluIGFyYml0cmFyeSBvcmRlci4gIEl0IGRvZXMgbm90IGluY2x1ZGUgdGhlIHNwZWNpYWwKICAgIGVudHJpZXMgJy4nIGFuZCAnLi4nIGV2ZW4gaWYgdGhleSBhcmUgcHJlc2VudCBpbiB0aGUgZGlyZWN0b3J5LgogICAgCiAgICBwYXRoIGNhbiBiZSBzcGVjaWZpZWQgYXMgZWl0aGVyIHN0ciBvciBieXRlcy4gIElmIHBhdGggaXMgYnl0ZXMsCiAgICAgIHRoZSBmaWxlbmFtZXMgcmV0dXJuZWQgd2lsbCBhbHNvIGJlIGJ5dGVzOyBpbiBhbGwgb3RoZXIgY2lyY3Vtc3RhbmNlcwogICAgICB0aGUgZmlsZW5hbWVzIHJldHVybmVkIHdpbGwgYmUgc3RyLgogICAgT24gc29tZSBwbGF0Zm9ybXMsIHBhdGggbWF5IGFsc28gYmUgc3BlY2lmaWVkIGFzIGFuIG9wZW4gZmlsZSBkZXNjcmlwdG9yOwogICAgICB0aGUgZmlsZSBkZXNjcmlwdG9yIG11c3QgcmVmZXIgdG8gYSBkaXJlY3RvcnkuCiAgICAgIElmIHRoaXMgZnVuY3Rpb25hbGl0eSBpcyB1bmF2YWlsYWJsZSwgdXNpbmcgaXQgcmFpc2VzIE5vdEltcGxlbWVudGVkRXJyb3IuIiIiCiAgICBwYXNzCgpkZWYgbHNlZWsoKmFyZ3MsKiprdyk6CiAgICAiIiJsc2VlayhmZCwgcG9zLCBob3cpIC0+IG5ld3BvcyAgICAKICAgIFNldCB0aGUgY3VycmVudCBwb3NpdGlvbiBvZiBhIGZpbGUgZGVzY3JpcHRvci4KICAgIFJldHVybiB0aGUgbmV3IGN1cnNvciBwb3NpdGlvbiBpbiBieXRlcywgc3RhcnRpbmcgZnJvbSB0aGUgYmVnaW5uaW5nLiIiIgogICAgcGFzcwoKZGVmIGxzdGF0KCphcmdzLCoqa3cpOgogICAgIiIibHN0YXQocGF0aCwgKiwgZGlyX2ZkPU5vbmUpIC0+IHN0YXQgcmVzdWx0ICAgIAogICAgTGlrZSBzdGF0KCksIGJ1dCBkbyBub3QgZm9sbG93IHN5bWJvbGljIGxpbmtzLgogICAgRXF1aXZhbGVudCB0byBzdGF0KHBhdGgsIGZvbGxvd19zeW1saW5rcz1GYWxzZSkuIiIiCiAgICBwYXNzCgpkZWYgbWtkaXIoKmFyZ3MsKiprdyk6CiAgICAiIiJta2RpcihwYXRoLCBtb2RlPTBvNzc3LCAqLCBkaXJfZmQ9Tm9uZSkgICAgCiAgICBDcmVhdGUgYSBkaXJlY3RvcnkuCiAgICAKICAgIElmIGRpcl9mZCBpcyBub3QgTm9uZSwgaXQgc2hvdWxkIGJlIGEgZmlsZSBkZXNjcmlwdG9yIG9wZW4gdG8gYSBkaXJlY3RvcnksCiAgICAgIGFuZCBwYXRoIHNob3VsZCBiZSByZWxhdGl2ZTsgcGF0aCB3aWxsIHRoZW4gYmUgcmVsYXRpdmUgdG8gdGhhdCBkaXJlY3RvcnkuCiAgICBkaXJfZmQgbWF5IG5vdCBiZSBpbXBsZW1lbnRlZCBvbiB5b3VyIHBsYXRmb3JtLgogICAgICBJZiBpdCBpcyB1bmF2YWlsYWJsZSwgdXNpbmcgaXQgd2lsbCByYWlzZSBhIE5vdEltcGxlbWVudGVkRXJyb3IuCiAgICAKICAgIFRoZSBtb2RlIGFyZ3VtZW50IGlzIGlnbm9yZWQgb24gV2luZG93cy4iIiIKICAgIHBhc3MKCmRlZiBvcGVuKCphcmdzLCoqa3cpOgogICAgIiIib3BlbihwYXRoLCBmbGFncywgbW9kZT0wbzc3NywgKiwgZGlyX2ZkPU5vbmUpICAgIAogICAgT3BlbiBhIGZpbGUgZm9yIGxvdyBsZXZlbCBJTy4gIFJldHVybnMgYSBmaWxlIGhhbmRsZSAoaW50ZWdlcikuCiAgICAKICAgIElmIGRpcl9mZCBpcyBub3QgTm9uZSwgaXQgc2hvdWxkIGJlIGEgZmlsZSBkZXNjcmlwdG9yIG9wZW4gdG8gYSBkaXJlY3RvcnksCiAgICAgIGFuZCBwYXRoIHNob3VsZCBiZSByZWxhdGl2ZTsgcGF0aCB3aWxsIHRoZW4gYmUgcmVsYXRpdmUgdG8gdGhhdCBkaXJlY3RvcnkuCiAgICBkaXJfZmQgbWF5IG5vdCBiZSBpbXBsZW1lbnRlZCBvbiB5b3VyIHBsYXRmb3JtLgogICAgICBJZiBpdCBpcyB1bmF2YWlsYWJsZSwgdXNpbmcgaXQgd2lsbCByYWlzZSBhIE5vdEltcGxlbWVudGVkRXJyb3IuIiIiCiAgICBwYXNzCgpkZWYgcGlwZSgqYXJncywqKmt3KToKICAgICIiInBpcGUoKSAtPiAocmVhZF9lbmQsIHdyaXRlX2VuZCkgICAgCiAgICBDcmVhdGUgYSBwaXBlLiIiIgogICAgcGFzcwoKZGVmIHB1dGVudigqYXJncywqKmt3KToKICAgICIiInB1dGVudihrZXksIHZhbHVlKSAgICAKICAgIENoYW5nZSBvciBhZGQgYW4gZW52aXJvbm1lbnQgdmFyaWFibGUuIiIiCiAgICBwYXNzCgpkZWYgcmVhZCgqYXJncywqKmt3KToKICAgICIiInJlYWQoZmQsIGJ1ZmZlcnNpemUpIC0+IHN0cmluZyAgICAKICAgIFJlYWQgYSBmaWxlIGRlc2NyaXB0b3IuIiIiCiAgICBwYXNzCgpkZWYgcmVhZGxpbmsoKmFyZ3MsKiprdyk6CiAgICAiIiJyZWFkbGluayhwYXRoLCAqLCBkaXJfZmQ9Tm9uZSkgLT4gcGF0aCAgICAKICAgIFJldHVybiBhIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIHBhdGggdG8gd2hpY2ggdGhlIHN5bWJvbGljIGxpbmsgcG9pbnRzLgogICAgCiAgICBJZiBkaXJfZmQgaXMgbm90IE5vbmUsIGl0IHNob3VsZCBiZSBhIGZpbGUgZGVzY3JpcHRvciBvcGVuIHRvIGEgZGlyZWN0b3J5LAogICAgICBhbmQgcGF0aCBzaG91bGQgYmUgcmVsYXRpdmU7IHBhdGggd2lsbCB0aGVuIGJlIHJlbGF0aXZlIHRvIHRoYXQgZGlyZWN0b3J5LgogICAgZGlyX2ZkIG1heSBub3QgYmUgaW1wbGVtZW50ZWQgb24geW91ciBwbGF0Zm9ybS4KICAgICAgSWYgaXQgaXMgdW5hdmFpbGFibGUsIHVzaW5nIGl0IHdpbGwgcmFpc2UgYSBOb3RJbXBsZW1lbnRlZEVycm9yLiIiIgogICAgcGFzcwoKZGVmIHJlbW92ZSgqYXJncywqKmt3KToKICAgICIiInJlbW92ZShwYXRoLCAqLCBkaXJfZmQ9Tm9uZSkgICAgCiAgICBSZW1vdmUgYSBmaWxlIChzYW1lIGFzIHVubGluaygpKS4KICAgIAogICAgSWYgZGlyX2ZkIGlzIG5vdCBOb25lLCBpdCBzaG91bGQgYmUgYSBmaWxlIGRlc2NyaXB0b3Igb3BlbiB0byBhIGRpcmVjdG9yeSwKICAgICAgYW5kIHBhdGggc2hvdWxkIGJlIHJlbGF0aXZlOyBwYXRoIHdpbGwgdGhlbiBiZSByZWxhdGl2ZSB0byB0aGF0IGRpcmVjdG9yeS4KICAgIGRpcl9mZCBtYXkgbm90IGJlIGltcGxlbWVudGVkIG9uIHlvdXIgcGxhdGZvcm0uCiAgICAgIElmIGl0IGlzIHVuYXZhaWxhYmxlLCB1c2luZyBpdCB3aWxsIHJhaXNlIGEgTm90SW1wbGVtZW50ZWRFcnJvci4iIiIKICAgIHBhc3MKCmRlZiByZW5hbWUoKmFyZ3MsKiprdyk6CiAgICAiIiJyZW5hbWUoc3JjLCBkc3QsICosIHNyY19kaXJfZmQ9Tm9uZSwgZHN0X2Rpcl9mZD1Ob25lKSAgICAKICAgIFJlbmFtZSBhIGZpbGUgb3IgZGlyZWN0b3J5LgogICAgCiAgICBJZiBlaXRoZXIgc3JjX2Rpcl9mZCBvciBkc3RfZGlyX2ZkIGlzIG5vdCBOb25lLCBpdCBzaG91bGQgYmUgYSBmaWxlCiAgICAgIGRlc2NyaXB0b3Igb3BlbiB0byBhIGRpcmVjdG9yeSwgYW5kIHRoZSByZXNwZWN0aXZlIHBhdGggc3RyaW5nIChzcmMgb3IgZHN0KQogICAgICBzaG91bGQgYmUgcmVsYXRpdmU7IHRoZSBwYXRoIHdpbGwgdGhlbiBiZSByZWxhdGl2ZSB0byB0aGF0IGRpcmVjdG9yeS4KICAgIHNyY19kaXJfZmQgYW5kIGRzdF9kaXJfZmQsIG1heSBub3QgYmUgaW1wbGVtZW50ZWQgb24geW91ciBwbGF0Zm9ybS4KICAgICAgSWYgdGhleSBhcmUgdW5hdmFpbGFibGUsIHVzaW5nIHRoZW0gd2lsbCByYWlzZSBhIE5vdEltcGxlbWVudGVkRXJyb3IuIiIiCiAgICBwYXNzCgpkZWYgcmVwbGFjZSgqYXJncywqKmt3KToKICAgICIiInJlcGxhY2Uoc3JjLCBkc3QsICosIHNyY19kaXJfZmQ9Tm9uZSwgZHN0X2Rpcl9mZD1Ob25lKSAgICAKICAgIFJlbmFtZSBhIGZpbGUgb3IgZGlyZWN0b3J5LCBvdmVyd3JpdGluZyB0aGUgZGVzdGluYXRpb24uCiAgICAKICAgIElmIGVpdGhlciBzcmNfZGlyX2ZkIG9yIGRzdF9kaXJfZmQgaXMgbm90IE5vbmUsIGl0IHNob3VsZCBiZSBhIGZpbGUKICAgICAgZGVzY3JpcHRvciBvcGVuIHRvIGEgZGlyZWN0b3J5LCBhbmQgdGhlIHJlc3BlY3RpdmUgcGF0aCBzdHJpbmcgKHNyYyBvciBkc3QpCiAgICAgIHNob3VsZCBiZSByZWxhdGl2ZTsgdGhlIHBhdGggd2lsbCB0aGVuIGJlIHJlbGF0aXZlIHRvIHRoYXQgZGlyZWN0b3J5LgogICAgc3JjX2Rpcl9mZCBhbmQgZHN0X2Rpcl9mZCwgbWF5IG5vdCBiZSBpbXBsZW1lbnRlZCBvbiB5b3VyIHBsYXRmb3JtLgogICAgICBJZiB0aGV5IGFyZSB1bmF2YWlsYWJsZSwgdXNpbmcgdGhlbSB3aWxsIHJhaXNlIGEgTm90SW1wbGVtZW50ZWRFcnJvci4iIiIKICAgIHBhc3MKCmRlZiBybWRpcigqYXJncywqKmt3KToKICAgICIiInJtZGlyKHBhdGgsICosIGRpcl9mZD1Ob25lKSAgICAKICAgIFJlbW92ZSBhIGRpcmVjdG9yeS4KICAgIAogICAgSWYgZGlyX2ZkIGlzIG5vdCBOb25lLCBpdCBzaG91bGQgYmUgYSBmaWxlIGRlc2NyaXB0b3Igb3BlbiB0byBhIGRpcmVjdG9yeSwKICAgICAgYW5kIHBhdGggc2hvdWxkIGJlIHJlbGF0aXZlOyBwYXRoIHdpbGwgdGhlbiBiZSByZWxhdGl2ZSB0byB0aGF0IGRpcmVjdG9yeS4KICAgIGRpcl9mZCBtYXkgbm90IGJlIGltcGxlbWVudGVkIG9uIHlvdXIgcGxhdGZvcm0uCiAgICAgIElmIGl0IGlzIHVuYXZhaWxhYmxlLCB1c2luZyBpdCB3aWxsIHJhaXNlIGEgTm90SW1wbGVtZW50ZWRFcnJvci4iIiIKICAgIHBhc3MKCmRlZiBzcGF3bnYoKmFyZ3MsKiprdyk6CiAgICAiIiJzcGF3bnYobW9kZSwgcGF0aCwgYXJncykgICAgCiAgICBFeGVjdXRlIHRoZSBwcm9ncmFtICdwYXRoJyBpbiBhIG5ldyBwcm9jZXNzLgogICAgCiAgICAgICAgbW9kZTogbW9kZSBvZiBwcm9jZXNzIGNyZWF0aW9uCiAgICAgICAgcGF0aDogcGF0aCBvZiBleGVjdXRhYmxlIGZpbGUKICAgICAgICBhcmdzOiB0dXBsZSBvciBsaXN0IG9mIHN0cmluZ3MiIiIKICAgIHBhc3MKCmRlZiBzcGF3bnZlKCphcmdzLCoqa3cpOgogICAgIiIic3Bhd252ZShtb2RlLCBwYXRoLCBhcmdzLCBlbnYpICAgIAogICAgRXhlY3V0ZSB0aGUgcHJvZ3JhbSAncGF0aCcgaW4gYSBuZXcgcHJvY2Vzcy4KICAgIAogICAgICAgIG1vZGU6IG1vZGUgb2YgcHJvY2VzcyBjcmVhdGlvbgogICAgICAgIHBhdGg6IHBhdGggb2YgZXhlY3V0YWJsZSBmaWxlCiAgICAgICAgYXJnczogdHVwbGUgb3IgbGlzdCBvZiBhcmd1bWVudHMKICAgICAgICBlbnY6IGRpY3Rpb25hcnkgb2Ygc3RyaW5ncyBtYXBwaW5nIHRvIHN0cmluZ3MiIiIKICAgIHBhc3MKCmRlZiBzdGFydGZpbGUoKmFyZ3MsKiprdyk6CiAgICAiIiJzdGFydGZpbGUoZmlsZXBhdGggWywgb3BlcmF0aW9uXSkgLSBTdGFydCBhIGZpbGUgd2l0aCBpdHMgYXNzb2NpYXRlZCAgICBhcHBsaWNhdGlvbi4KICAgIAogICAgV2hlbiAib3BlcmF0aW9uIiBpcyBub3Qgc3BlY2lmaWVkIG9yICJvcGVuIiwgdGhpcyBhY3RzIGxpa2UKICAgIGRvdWJsZS1jbGlja2luZyB0aGUgZmlsZSBpbiBFeHBsb3Jlciwgb3IgZ2l2aW5nIHRoZSBmaWxlIG5hbWUgYXMgYW4KICAgIGFyZ3VtZW50IHRvIHRoZSBET1MgInN0YXJ0IiBjb21tYW5kOiB0aGUgZmlsZSBpcyBvcGVuZWQgd2l0aCB3aGF0ZXZlcgogICAgYXBwbGljYXRpb24gKGlmIGFueSkgaXRzIGV4dGVuc2lvbiBpcyBhc3NvY2lhdGVkLgogICAgV2hlbiBhbm90aGVyICJvcGVyYXRpb24iIGlzIGdpdmVuLCBpdCBzcGVjaWZpZXMgd2hhdCBzaG91bGQgYmUgZG9uZSB3aXRoCiAgICB0aGUgZmlsZS4gIEEgdHlwaWNhbCBvcGVyYXRpb24gaXMgInByaW50Ii4KICAgIAogICAgc3RhcnRmaWxlIHJldHVybnMgYXMgc29vbiBhcyB0aGUgYXNzb2NpYXRlZCBhcHBsaWNhdGlvbiBpcyBsYXVuY2hlZC4KICAgIFRoZXJlIGlzIG5vIG9wdGlvbiB0byB3YWl0IGZvciB0aGUgYXBwbGljYXRpb24gdG8gY2xvc2UsIGFuZCBubyB3YXkKICAgIHRvIHJldHJpZXZlIHRoZSBhcHBsaWNhdGlvbidzIGV4aXQgc3RhdHVzLgogICAgCiAgICBUaGUgZmlsZXBhdGggaXMgcmVsYXRpdmUgdG8gdGhlIGN1cnJlbnQgZGlyZWN0b3J5LiAgSWYgeW91IHdhbnQgdG8gdXNlCiAgICBhbiBhYnNvbHV0ZSBwYXRoLCBtYWtlIHN1cmUgdGhlIGZpcnN0IGNoYXJhY3RlciBpcyBub3QgYSBzbGFzaCAoIi8iKTsKICAgIHRoZSB1bmRlcmx5aW5nIFdpbjMyIFNoZWxsRXhlY3V0ZSBmdW5jdGlvbiBkb2Vzbid0IHdvcmsgaWYgaXQgaXMuIiIiCiAgICBwYXNzCgpkZWYgc3RhdCgqYXJncywqKmt3KToKICAgICIiInN0YXQocGF0aCwgKiwgZGlyX2ZkPU5vbmUsIGZvbGxvd19zeW1saW5rcz1UcnVlKSAtPiBzdGF0IHJlc3VsdCAgICAKICAgIFBlcmZvcm0gYSBzdGF0IHN5c3RlbSBjYWxsIG9uIHRoZSBnaXZlbiBwYXRoLgogICAgCiAgICBwYXRoIG1heSBiZSBzcGVjaWZpZWQgYXMgZWl0aGVyIGEgc3RyaW5nIG9yIGFzIGFuIG9wZW4gZmlsZSBkZXNjcmlwdG9yLgogICAgCiAgICBJZiBkaXJfZmQgaXMgbm90IE5vbmUsIGl0IHNob3VsZCBiZSBhIGZpbGUgZGVzY3JpcHRvciBvcGVuIHRvIGEgZGlyZWN0b3J5LAogICAgICBhbmQgcGF0aCBzaG91bGQgYmUgcmVsYXRpdmU7IHBhdGggd2lsbCB0aGVuIGJlIHJlbGF0aXZlIHRvIHRoYXQgZGlyZWN0b3J5LgogICAgICBkaXJfZmQgbWF5IG5vdCBiZSBzdXBwb3J0ZWQgb24geW91ciBwbGF0Zm9ybTsgaWYgaXQgaXMgdW5hdmFpbGFibGUsIHVzaW5nCiAgICAgIGl0IHdpbGwgcmFpc2UgYSBOb3RJbXBsZW1lbnRlZEVycm9yLgogICAgSWYgZm9sbG93X3N5bWxpbmtzIGlzIEZhbHNlLCBhbmQgdGhlIGxhc3QgZWxlbWVudCBvZiB0aGUgcGF0aCBpcyBhIHN5bWJvbGljCiAgICAgIGxpbmssIHN0YXQgd2lsbCBleGFtaW5lIHRoZSBzeW1ib2xpYyBsaW5rIGl0c2VsZiBpbnN0ZWFkIG9mIHRoZSBmaWxlIHRoZQogICAgICBsaW5rIHBvaW50cyB0by4KICAgIEl0IGlzIGFuIGVycm9yIHRvIHVzZSBkaXJfZmQgb3IgZm9sbG93X3N5bWxpbmtzIHdoZW4gc3BlY2lmeWluZyBwYXRoIGFzCiAgICAgIGFuIG9wZW4gZmlsZSBkZXNjcmlwdG9yLiIiIgogICAgcGFzcwoKZGVmIHN0YXRfZmxvYXRfdGltZXMoKmFyZ3MsKiprdyk6CiAgICAiIiJzdGF0X2Zsb2F0X3RpbWVzKFtuZXd2YWxdKSAtPiBvbGR2YWwgICAgCiAgICBEZXRlcm1pbmUgd2hldGhlciBvcy5bbGZdc3RhdCByZXByZXNlbnRzIHRpbWUgc3RhbXBzIGFzIGZsb2F0IG9iamVjdHMuCiAgICBJZiBuZXd2YWwgaXMgVHJ1ZSwgZnV0dXJlIGNhbGxzIHRvIHN0YXQoKSByZXR1cm4gZmxvYXRzLCBpZiBpdCBpcyBGYWxzZSwKICAgIGZ1dHVyZSBjYWxscyByZXR1cm4gaW50cy4gCiAgICBJZiBuZXd2YWwgaXMgb21pdHRlZCwgcmV0dXJuIHRoZSBjdXJyZW50IHNldHRpbmcuCiAgICAiIiIKICAgIHBhc3MKCmNsYXNzIHN0YXRfcmVzdWx0OgogICAgcGFzcwoKY2xhc3Mgc3RhdHZmc19yZXN1bHQ6CiAgICBwYXNzCgpkZWYgc3RyZXJyb3IoKmFyZ3MsKiprdyk6CiAgICAiIiJzdHJlcnJvcihjb2RlKSAtPiBzdHJpbmcgICAgCiAgICBUcmFuc2xhdGUgYW4gZXJyb3IgY29kZSB0byBhIG1lc3NhZ2Ugc3RyaW5nLiIiIgogICAgcGFzcwoKZGVmIHN5bWxpbmsoKmFyZ3MsKiprdyk6CiAgICAiIiJzeW1saW5rKHNyYywgZHN0LCB0YXJnZXRfaXNfZGlyZWN0b3J5PUZhbHNlLCAqLCBkaXJfZmQ9Tm9uZSkgICAgCiAgICBDcmVhdGUgYSBzeW1ib2xpYyBsaW5rIHBvaW50aW5nIHRvIHNyYyBuYW1lZCBkc3QuCiAgICAKICAgIHRhcmdldF9pc19kaXJlY3RvcnkgaXMgcmVxdWlyZWQgb24gV2luZG93cyBpZiB0aGUgdGFyZ2V0IGlzIHRvIGJlCiAgICAgIGludGVycHJldGVkIGFzIGEgZGlyZWN0b3J5LiAgKE9uIFdpbmRvd3MsIHN5bWxpbmsgcmVxdWlyZXMKICAgICAgV2luZG93cyA2LjAgb3IgZ3JlYXRlciwgYW5kIHJhaXNlcyBhIE5vdEltcGxlbWVudGVkRXJyb3Igb3RoZXJ3aXNlLikKICAgICAgdGFyZ2V0X2lzX2RpcmVjdG9yeSBpcyBpZ25vcmVkIG9uIG5vbi1XaW5kb3dzIHBsYXRmb3Jtcy4KICAgIAogICAgSWYgZGlyX2ZkIGlzIG5vdCBOb25lLCBpdCBzaG91bGQgYmUgYSBmaWxlIGRlc2NyaXB0b3Igb3BlbiB0byBhIGRpcmVjdG9yeSwKICAgICAgYW5kIHBhdGggc2hvdWxkIGJlIHJlbGF0aXZlOyBwYXRoIHdpbGwgdGhlbiBiZSByZWxhdGl2ZSB0byB0aGF0IGRpcmVjdG9yeS4KICAgIGRpcl9mZCBtYXkgbm90IGJlIGltcGxlbWVudGVkIG9uIHlvdXIgcGxhdGZvcm0uCiAgICAgIElmIGl0IGlzIHVuYXZhaWxhYmxlLCB1c2luZyBpdCB3aWxsIHJhaXNlIGEgTm90SW1wbGVtZW50ZWRFcnJvci4iIiIKICAgIHBhc3MKCmRlZiBzeXN0ZW0oKmFyZ3MsKiprdyk6CiAgICAiIiJzeXN0ZW0oY29tbWFuZCkgLT4gZXhpdF9zdGF0dXMgICAgCiAgICBFeGVjdXRlIHRoZSBjb21tYW5kIChhIHN0cmluZykgaW4gYSBzdWJzaGVsbC4iIiIKICAgIHBhc3MKCmNsYXNzIHRlcm1pbmFsX3NpemU6CiAgICBwYXNzCgpkZWYgdGltZXMoKmFyZ3MsKiprdyk6CiAgICAiIiJ0aW1lcygpIC0+IHRpbWVzX3Jlc3VsdCAgICAKICAgIFJldHVybiBhbiBvYmplY3QgY29udGFpbmluZyBmbG9hdGluZyBwb2ludCBudW1iZXJzIGluZGljYXRpbmcgcHJvY2VzcwogICAgdGltZXMuICBUaGUgb2JqZWN0IGJlaGF2ZXMgbGlrZSBhIG5hbWVkIHR1cGxlIHdpdGggdGhlc2UgZmllbGRzOgogICAgICAodXRpbWUsIHN0aW1lLCBjdXRpbWUsIGNzdGltZSwgZWxhcHNlZF90aW1lKSIiIgogICAgcGFzcwoKY2xhc3MgdGltZXNfcmVzdWx0OgogICAgcGFzcwoKZGVmIHVtYXNrKCphcmdzLCoqa3cpOgogICAgIiIidW1hc2sobmV3X21hc2spIC0+IG9sZF9tYXNrICAgIAogICAgU2V0IHRoZSBjdXJyZW50IG51bWVyaWMgdW1hc2sgYW5kIHJldHVybiB0aGUgcHJldmlvdXMgdW1hc2suIiIiCiAgICBwYXNzCgpjbGFzcyB1bmFtZV9yZXN1bHQ6CiAgICBwYXNzCgpkZWYgdW5saW5rKCphcmdzLCoqa3cpOgogICAgIiIidW5saW5rKHBhdGgsICosIGRpcl9mZD1Ob25lKSAgICAKICAgIFJlbW92ZSBhIGZpbGUgKHNhbWUgYXMgcmVtb3ZlKCkpLgogICAgCiAgICBJZiBkaXJfZmQgaXMgbm90IE5vbmUsIGl0IHNob3VsZCBiZSBhIGZpbGUgZGVzY3JpcHRvciBvcGVuIHRvIGEgZGlyZWN0b3J5LAogICAgICBhbmQgcGF0aCBzaG91bGQgYmUgcmVsYXRpdmU7IHBhdGggd2lsbCB0aGVuIGJlIHJlbGF0aXZlIHRvIHRoYXQgZGlyZWN0b3J5LgogICAgZGlyX2ZkIG1heSBub3QgYmUgaW1wbGVtZW50ZWQgb24geW91ciBwbGF0Zm9ybS4KICAgICAgSWYgaXQgaXMgdW5hdmFpbGFibGUsIHVzaW5nIGl0IHdpbGwgcmFpc2UgYSBOb3RJbXBsZW1lbnRlZEVycm9yLiIiIgogICAgcGFzcwoKZGVmIHVyYW5kb20oKmFyZ3MsKiprdyk6CiAgICAiIiJ1cmFuZG9tKG4pIC0+IHN0ciAgICAKICAgIFJldHVybiBuIHJhbmRvbSBieXRlcyBzdWl0YWJsZSBmb3IgY3J5cHRvZ3JhcGhpYyB1c2UuIiIiCiAgICBwYXNzCgpkZWYgdXRpbWUoKmFyZ3MsKiprdyk6CiAgICAiIiJ1dGltZShwYXRoLCB0aW1lcz1Ob25lLCAqLCBucz1Ob25lLCBkaXJfZmQ9Tm9uZSwgZm9sbG93X3N5bWxpbmtzPVRydWUpICAgIFNldCB0aGUgYWNjZXNzIGFuZCBtb2RpZmllZCB0aW1lIG9mIHBhdGguCiAgICAKICAgIHBhdGggbWF5IGFsd2F5cyBiZSBzcGVjaWZpZWQgYXMgYSBzdHJpbmcuCiAgICBPbiBzb21lIHBsYXRmb3JtcywgcGF0aCBtYXkgYWxzbyBiZSBzcGVjaWZpZWQgYXMgYW4gb3BlbiBmaWxlIGRlc2NyaXB0b3IuCiAgICAgIElmIHRoaXMgZnVuY3Rpb25hbGl0eSBpcyB1bmF2YWlsYWJsZSwgdXNpbmcgaXQgcmFpc2VzIGFuIGV4Y2VwdGlvbi4KICAgIAogICAgSWYgdGltZXMgaXMgbm90IE5vbmUsIGl0IG11c3QgYmUgYSB0dXBsZSAoYXRpbWUsIG10aW1lKTsKICAgICAgICBhdGltZSBhbmQgbXRpbWUgc2hvdWxkIGJlIGV4cHJlc3NlZCBhcyBmbG9hdCBzZWNvbmRzIHNpbmNlIHRoZSBlcG9jaC4KICAgIElmIG5zIGlzIG5vdCBOb25lLCBpdCBtdXN0IGJlIGEgdHVwbGUgKGF0aW1lX25zLCBtdGltZV9ucyk7CiAgICAgICAgYXRpbWVfbnMgYW5kIG10aW1lX25zIHNob3VsZCBiZSBleHByZXNzZWQgYXMgaW50ZWdlciBuYW5vc2Vjb25kcwogICAgICAgIHNpbmNlIHRoZSBlcG9jaC4KICAgIElmIGJvdGggdGltZXMgYW5kIG5zIGFyZSBOb25lLCB1dGltZSB1c2VzIHRoZSBjdXJyZW50IHRpbWUuCiAgICBTcGVjaWZ5aW5nIHR1cGxlcyBmb3IgYm90aCB0aW1lcyBhbmQgbnMgaXMgYW4gZXJyb3IuCiAgICAKICAgIElmIGRpcl9mZCBpcyBub3QgTm9uZSwgaXQgc2hvdWxkIGJlIGEgZmlsZSBkZXNjcmlwdG9yIG9wZW4gdG8gYSBkaXJlY3RvcnksCiAgICAgIGFuZCBwYXRoIHNob3VsZCBiZSByZWxhdGl2ZTsgcGF0aCB3aWxsIHRoZW4gYmUgcmVsYXRpdmUgdG8gdGhhdCBkaXJlY3RvcnkuCiAgICBJZiBmb2xsb3dfc3ltbGlua3MgaXMgRmFsc2UsIGFuZCB0aGUgbGFzdCBlbGVtZW50IG9mIHRoZSBwYXRoIGlzIGEgc3ltYm9saWMKICAgICAgbGluaywgdXRpbWUgd2lsbCBtb2RpZnkgdGhlIHN5bWJvbGljIGxpbmsgaXRzZWxmIGluc3RlYWQgb2YgdGhlIGZpbGUgdGhlCiAgICAgIGxpbmsgcG9pbnRzIHRvLgogICAgSXQgaXMgYW4gZXJyb3IgdG8gdXNlIGRpcl9mZCBvciBmb2xsb3dfc3ltbGlua3Mgd2hlbiBzcGVjaWZ5aW5nIHBhdGgKICAgICAgYXMgYW4gb3BlbiBmaWxlIGRlc2NyaXB0b3IuCiAgICBkaXJfZmQgYW5kIGZvbGxvd19zeW1saW5rcyBtYXkgbm90IGJlIGF2YWlsYWJsZSBvbiB5b3VyIHBsYXRmb3JtLgogICAgICBJZiB0aGV5IGFyZSB1bmF2YWlsYWJsZSwgdXNpbmcgdGhlbSB3aWxsIHJhaXNlIGEgTm90SW1wbGVtZW50ZWRFcnJvci4iIiIKICAgIHBhc3MKCmRlZiB3YWl0cGlkKCphcmdzLCoqa3cpOgogICAgIiIid2FpdHBpZChwaWQsIG9wdGlvbnMpIC0+IChwaWQsIHN0YXR1cyA8PCA4KSAgICAKICAgIFdhaXQgZm9yIGNvbXBsZXRpb24gb2YgYSBnaXZlbiBwcm9jZXNzLiAgb3B0aW9ucyBpcyBpZ25vcmVkIG9uIFdpbmRvd3MuIiIiCiAgICBwYXNzCgpkZWYgd3JpdGUoKmFyZ3MsKiprdyk6CiAgICAiIiJ3cml0ZShmZCwgc3RyaW5nKSAtPiBieXRlc3dyaXR0ZW4gICAgCiAgICBXcml0ZSBhIHN0cmluZyB0byBhIGZpbGUgZGVzY3JpcHRvci4iIiIKICAgIHBhc3MK',
'/Lib/posixpath.py':'IiIiQ29tbW9uIG9wZXJhdGlvbnMgb24gUG9zaXggcGF0aG5hbWVzLgoKSW5zdGVhZCBvZiBpbXBvcnRpbmcgdGhpcyBtb2R1bGUgZGlyZWN0bHksIGltcG9ydCBvcyBhbmQgcmVmZXIgdG8KdGhpcyBtb2R1bGUgYXMgb3MucGF0aC4gIFRoZSAib3MucGF0aCIgbmFtZSBpcyBhbiBhbGlhcyBmb3IgdGhpcwptb2R1bGUgb24gUG9zaXggc3lzdGVtczsgb24gb3RoZXIgc3lzdGVtcyAoZS5nLiBNYWMsIFdpbmRvd3MpLApvcy5wYXRoIHByb3ZpZGVzIHRoZSBzYW1lIG9wZXJhdGlvbnMgaW4gYSBtYW5uZXIgc3BlY2lmaWMgdG8gdGhhdApwbGF0Zm9ybSwgYW5kIGlzIGFuIGFsaWFzIHRvIGFub3RoZXIgbW9kdWxlIChlLmcuIG1hY3BhdGgsIG50cGF0aCkuCgpTb21lIG9mIHRoaXMgY2FuIGFjdHVhbGx5IGJlIHVzZWZ1bCBvbiBub24tUG9zaXggc3lzdGVtcyB0b28sIGUuZy4KZm9yIG1hbmlwdWxhdGlvbiBvZiB0aGUgcGF0aG5hbWUgY29tcG9uZW50IG9mIFVSTHMuCiIiIgoKaW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IHN0YXQKaW1wb3J0IGdlbmVyaWNwYXRoCmZyb20gZ2VuZXJpY3BhdGggaW1wb3J0ICoKCl9fYWxsX18gPSBbIm5vcm1jYXNlIiwiaXNhYnMiLCJqb2luIiwic3BsaXRkcml2ZSIsInNwbGl0Iiwic3BsaXRleHQiLAogICAgICAgICAgICJiYXNlbmFtZSIsImRpcm5hbWUiLCJjb21tb25wcmVmaXgiLCJnZXRzaXplIiwiZ2V0bXRpbWUiLAogICAgICAgICAgICJnZXRhdGltZSIsImdldGN0aW1lIiwiaXNsaW5rIiwiZXhpc3RzIiwibGV4aXN0cyIsImlzZGlyIiwiaXNmaWxlIiwKICAgICAgICAgICAiaXNtb3VudCIsICJleHBhbmR1c2VyIiwiZXhwYW5kdmFycyIsIm5vcm1wYXRoIiwiYWJzcGF0aCIsCiAgICAgICAgICAgInNhbWVmaWxlIiwic2FtZW9wZW5maWxlIiwic2FtZXN0YXQiLAogICAgICAgICAgICJjdXJkaXIiLCJwYXJkaXIiLCJzZXAiLCJwYXRoc2VwIiwiZGVmcGF0aCIsImFsdHNlcCIsImV4dHNlcCIsCiAgICAgICAgICAgImRldm51bGwiLCJyZWFscGF0aCIsInN1cHBvcnRzX3VuaWNvZGVfZmlsZW5hbWVzIiwicmVscGF0aCJdCgojIFN0cmluZ3MgcmVwcmVzZW50aW5nIHZhcmlvdXMgcGF0aC1yZWxhdGVkIGJpdHMgYW5kIHBpZWNlcy4KIyBUaGVzZSBhcmUgcHJpbWFyaWx5IGZvciBleHBvcnQ7IGludGVybmFsbHksIHRoZXkgYXJlIGhhcmRjb2RlZC4KY3VyZGlyID0gJy4nCnBhcmRpciA9ICcuLicKZXh0c2VwID0gJy4nCnNlcCA9ICcvJwpwYXRoc2VwID0gJzonCmRlZnBhdGggPSAnOi9iaW46L3Vzci9iaW4nCmFsdHNlcCA9IE5vbmUKZGV2bnVsbCA9ICcvZGV2L251bGwnCgpkZWYgX2dldF9zZXAocGF0aCk6CiAgICBpZiBpc2luc3RhbmNlKHBhdGgsIGJ5dGVzKToKICAgICAgICByZXR1cm4gYicvJwogICAgZWxzZToKICAgICAgICByZXR1cm4gJy8nCgojIE5vcm1hbGl6ZSB0aGUgY2FzZSBvZiBhIHBhdGhuYW1lLiAgVHJpdmlhbCBpbiBQb3NpeCwgc3RyaW5nLmxvd2VyIG9uIE1hYy4KIyBPbiBNUy1ET1MgdGhpcyBtYXkgYWxzbyB0dXJuIHNsYXNoZXMgaW50byBiYWNrc2xhc2hlczsgaG93ZXZlciwgb3RoZXIKIyBub3JtYWxpemF0aW9ucyAoc3VjaCBhcyBvcHRpbWl6aW5nICcuLi8nIGF3YXkpIGFyZSBub3QgYWxsb3dlZAojIChhbm90aGVyIGZ1bmN0aW9uIHNob3VsZCBiZSBkZWZpbmVkIHRvIGRvIHRoYXQpLgoKZGVmIG5vcm1jYXNlKHMpOgogICAgIiIiTm9ybWFsaXplIGNhc2Ugb2YgcGF0aG5hbWUuICBIYXMgbm8gZWZmZWN0IHVuZGVyIFBvc2l4IiIiCiAgICAjIFRPRE86IG9uIE1hYyBPUyBYLCB0aGlzIHNob3VsZCByZWFsbHkgcmV0dXJuIHMubG93ZXIoKS4KICAgIGlmIG5vdCBpc2luc3RhbmNlKHMsIChieXRlcywgc3RyKSk6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJub3JtY2FzZSgpIGFyZ3VtZW50IG11c3QgYmUgc3RyIG9yIGJ5dGVzLCAiCiAgICAgICAgICAgICAgICAgICAgICAgICJub3QgJ3t9JyIuZm9ybWF0KHMuX19jbGFzc19fLl9fbmFtZV9fKSkKICAgIHJldHVybiBzCgoKIyBSZXR1cm4gd2hldGhlciBhIHBhdGggaXMgYWJzb2x1dGUuCiMgVHJpdmlhbCBpbiBQb3NpeCwgaGFyZGVyIG9uIHRoZSBNYWMgb3IgTVMtRE9TLgoKZGVmIGlzYWJzKHMpOgogICAgIiIiVGVzdCB3aGV0aGVyIGEgcGF0aCBpcyBhYnNvbHV0ZSIiIgogICAgc2VwID0gX2dldF9zZXAocykKICAgIHJldHVybiBzLnN0YXJ0c3dpdGgoc2VwKQoKCiMgSm9pbiBwYXRobmFtZXMuCiMgSWdub3JlIHRoZSBwcmV2aW91cyBwYXJ0cyBpZiBhIHBhcnQgaXMgYWJzb2x1dGUuCiMgSW5zZXJ0IGEgJy8nIHVubGVzcyB0aGUgZmlyc3QgcGFydCBpcyBlbXB0eSBvciBhbHJlYWR5IGVuZHMgaW4gJy8nLgoKZGVmIGpvaW4oYSwgKnApOgogICAgIiIiSm9pbiB0d28gb3IgbW9yZSBwYXRobmFtZSBjb21wb25lbnRzLCBpbnNlcnRpbmcgJy8nIGFzIG5lZWRlZC4KICAgIElmIGFueSBjb21wb25lbnQgaXMgYW4gYWJzb2x1dGUgcGF0aCwgYWxsIHByZXZpb3VzIHBhdGggY29tcG9uZW50cwogICAgd2lsbCBiZSBkaXNjYXJkZWQuICBBbiBlbXB0eSBsYXN0IHBhcnQgd2lsbCByZXN1bHQgaW4gYSBwYXRoIHRoYXQKICAgIGVuZHMgd2l0aCBhIHNlcGFyYXRvci4iIiIKICAgIHNlcCA9IF9nZXRfc2VwKGEpCiAgICBwYXRoID0gYQogICAgdHJ5OgogICAgICAgIGZvciBiIGluIHA6CiAgICAgICAgICAgIGlmIGIuc3RhcnRzd2l0aChzZXApOgogICAgICAgICAgICAgICAgcGF0aCA9IGIKICAgICAgICAgICAgZWxpZiBub3QgcGF0aCBvciBwYXRoLmVuZHN3aXRoKHNlcCk6CiAgICAgICAgICAgICAgICBwYXRoICs9IGIKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHBhdGggKz0gc2VwICsgYgogICAgZXhjZXB0IFR5cGVFcnJvcjoKICAgICAgICB2YWxpZF90eXBlcyA9IGFsbChpc2luc3RhbmNlKHMsIChzdHIsIGJ5dGVzLCBieXRlYXJyYXkpKQogICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBzIGluIChhLCApICsgcCkKICAgICAgICBpZiB2YWxpZF90eXBlczoKICAgICAgICAgICAgIyBNdXN0IGhhdmUgYSBtaXh0dXJlIG9mIHRleHQgYW5kIGJpbmFyeSBkYXRhCiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiQ2FuJ3QgbWl4IHN0cmluZ3MgYW5kIGJ5dGVzIGluIHBhdGggY29tcG9uZW50cy4iKQogICAgICAgIHJhaXNlCiAgICByZXR1cm4gcGF0aAoKCiMgU3BsaXQgYSBwYXRoIGluIGhlYWQgKGV2ZXJ5dGhpbmcgdXAgdG8gdGhlIGxhc3QgJy8nKSBhbmQgdGFpbCAodGhlCiMgcmVzdCkuICBJZiB0aGUgcGF0aCBlbmRzIGluICcvJywgdGFpbCB3aWxsIGJlIGVtcHR5LiAgSWYgdGhlcmUgaXMgbm8KIyAnLycgaW4gdGhlIHBhdGgsIGhlYWQgIHdpbGwgYmUgZW1wdHkuCiMgVHJhaWxpbmcgJy8nZXMgYXJlIHN0cmlwcGVkIGZyb20gaGVhZCB1bmxlc3MgaXQgaXMgdGhlIHJvb3QuCgpkZWYgc3BsaXQocCk6CiAgICAiIiJTcGxpdCBhIHBhdGhuYW1lLiAgUmV0dXJucyB0dXBsZSAiKGhlYWQsIHRhaWwpIiB3aGVyZSAidGFpbCIgaXMKICAgIGV2ZXJ5dGhpbmcgYWZ0ZXIgdGhlIGZpbmFsIHNsYXNoLiAgRWl0aGVyIHBhcnQgbWF5IGJlIGVtcHR5LiIiIgogICAgc2VwID0gX2dldF9zZXAocCkKICAgIGkgPSBwLnJmaW5kKHNlcCkgKyAxCiAgICBoZWFkLCB0YWlsID0gcFs6aV0sIHBbaTpdCiAgICBpZiBoZWFkIGFuZCBoZWFkICE9IHNlcCpsZW4oaGVhZCk6CiAgICAgICAgaGVhZCA9IGhlYWQucnN0cmlwKHNlcCkKICAgIHJldHVybiBoZWFkLCB0YWlsCgoKIyBTcGxpdCBhIHBhdGggaW4gcm9vdCBhbmQgZXh0ZW5zaW9uLgojIFRoZSBleHRlbnNpb24gaXMgZXZlcnl0aGluZyBzdGFydGluZyBhdCB0aGUgbGFzdCBkb3QgaW4gdGhlIGxhc3QKIyBwYXRobmFtZSBjb21wb25lbnQ7IHRoZSByb290IGlzIGV2ZXJ5dGhpbmcgYmVmb3JlIHRoYXQuCiMgSXQgaXMgYWx3YXlzIHRydWUgdGhhdCByb290ICsgZXh0ID09IHAuCgpkZWYgc3BsaXRleHQocCk6CiAgICBpZiBpc2luc3RhbmNlKHAsIGJ5dGVzKToKICAgICAgICBzZXAgPSBiJy8nCiAgICAgICAgZXh0c2VwID0gYicuJwogICAgZWxzZToKICAgICAgICBzZXAgPSAnLycKICAgICAgICBleHRzZXAgPSAnLicKICAgIHJldHVybiBnZW5lcmljcGF0aC5fc3BsaXRleHQocCwgc2VwLCBOb25lLCBleHRzZXApCnNwbGl0ZXh0Ll9fZG9jX18gPSBnZW5lcmljcGF0aC5fc3BsaXRleHQuX19kb2NfXwoKIyBTcGxpdCBhIHBhdGhuYW1lIGludG8gYSBkcml2ZSBzcGVjaWZpY2F0aW9uIGFuZCB0aGUgcmVzdCBvZiB0aGUKIyBwYXRoLiAgVXNlZnVsIG9uIERPUy9XaW5kb3dzL05UOyBvbiBVbml4LCB0aGUgZHJpdmUgaXMgYWx3YXlzIGVtcHR5LgoKZGVmIHNwbGl0ZHJpdmUocCk6CiAgICAiIiJTcGxpdCBhIHBhdGhuYW1lIGludG8gZHJpdmUgYW5kIHBhdGguIE9uIFBvc2l4LCBkcml2ZSBpcyBhbHdheXMKICAgIGVtcHR5LiIiIgogICAgcmV0dXJuIHBbOjBdLCBwCgoKIyBSZXR1cm4gdGhlIHRhaWwgKGJhc2VuYW1lKSBwYXJ0IG9mIGEgcGF0aCwgc2FtZSBhcyBzcGxpdChwYXRoKVsxXS4KCmRlZiBiYXNlbmFtZShwKToKICAgICIiIlJldHVybnMgdGhlIGZpbmFsIGNvbXBvbmVudCBvZiBhIHBhdGhuYW1lIiIiCiAgICBzZXAgPSBfZ2V0X3NlcChwKQogICAgaSA9IHAucmZpbmQoc2VwKSArIDEKICAgIHJldHVybiBwW2k6XQoKCiMgUmV0dXJuIHRoZSBoZWFkIChkaXJuYW1lKSBwYXJ0IG9mIGEgcGF0aCwgc2FtZSBhcyBzcGxpdChwYXRoKVswXS4KCmRlZiBkaXJuYW1lKHApOgogICAgIiIiUmV0dXJucyB0aGUgZGlyZWN0b3J5IGNvbXBvbmVudCBvZiBhIHBhdGhuYW1lIiIiCiAgICBzZXAgPSBfZ2V0X3NlcChwKQogICAgaSA9IHAucmZpbmQoc2VwKSArIDEKICAgIGhlYWQgPSBwWzppXQogICAgaWYgaGVhZCBhbmQgaGVhZCAhPSBzZXAqbGVuKGhlYWQpOgogICAgICAgIGhlYWQgPSBoZWFkLnJzdHJpcChzZXApCiAgICByZXR1cm4gaGVhZAoKCiMgSXMgYSBwYXRoIGEgc3ltYm9saWMgbGluaz8KIyBUaGlzIHdpbGwgYWx3YXlzIHJldHVybiBmYWxzZSBvbiBzeXN0ZW1zIHdoZXJlIG9zLmxzdGF0IGRvZXNuJ3QgZXhpc3QuCgpkZWYgaXNsaW5rKHBhdGgpOgogICAgIiIiVGVzdCB3aGV0aGVyIGEgcGF0aCBpcyBhIHN5bWJvbGljIGxpbmsiIiIKICAgIHRyeToKICAgICAgICBzdCA9IG9zLmxzdGF0KHBhdGgpCiAgICBleGNlcHQgKG9zLmVycm9yLCBBdHRyaWJ1dGVFcnJvcik6CiAgICAgICAgcmV0dXJuIEZhbHNlCiAgICByZXR1cm4gc3RhdC5TX0lTTE5LKHN0LnN0X21vZGUpCgojIEJlaW5nIHRydWUgZm9yIGRhbmdsaW5nIHN5bWJvbGljIGxpbmtzIGlzIGFsc28gdXNlZnVsLgoKZGVmIGxleGlzdHMocGF0aCk6CiAgICAiIiJUZXN0IHdoZXRoZXIgYSBwYXRoIGV4aXN0cy4gIFJldHVybnMgVHJ1ZSBmb3IgYnJva2VuIHN5bWJvbGljIGxpbmtzIiIiCiAgICB0cnk6CiAgICAgICAgb3MubHN0YXQocGF0aCkKICAgIGV4Y2VwdCBvcy5lcnJvcjoKICAgICAgICByZXR1cm4gRmFsc2UKICAgIHJldHVybiBUcnVlCgoKIyBBcmUgdHdvIGZpbGVuYW1lcyByZWFsbHkgcG9pbnRpbmcgdG8gdGhlIHNhbWUgZmlsZT8KCmRlZiBzYW1lZmlsZShmMSwgZjIpOgogICAgIiIiVGVzdCB3aGV0aGVyIHR3byBwYXRobmFtZXMgcmVmZXJlbmNlIHRoZSBzYW1lIGFjdHVhbCBmaWxlIiIiCiAgICBzMSA9IG9zLnN0YXQoZjEpCiAgICBzMiA9IG9zLnN0YXQoZjIpCiAgICByZXR1cm4gc2FtZXN0YXQoczEsIHMyKQoKCiMgQXJlIHR3byBvcGVuIGZpbGVzIHJlYWxseSByZWZlcmVuY2luZyB0aGUgc2FtZSBmaWxlPwojIChOb3QgbmVjZXNzYXJpbHkgdGhlIHNhbWUgZmlsZSBkZXNjcmlwdG9yISkKCmRlZiBzYW1lb3BlbmZpbGUoZnAxLCBmcDIpOgogICAgIiIiVGVzdCB3aGV0aGVyIHR3byBvcGVuIGZpbGUgb2JqZWN0cyByZWZlcmVuY2UgdGhlIHNhbWUgZmlsZSIiIgogICAgczEgPSBvcy5mc3RhdChmcDEpCiAgICBzMiA9IG9zLmZzdGF0KGZwMikKICAgIHJldHVybiBzYW1lc3RhdChzMSwgczIpCgoKIyBBcmUgdHdvIHN0YXQgYnVmZmVycyAob2J0YWluZWQgZnJvbSBzdGF0LCBmc3RhdCBvciBsc3RhdCkKIyBkZXNjcmliaW5nIHRoZSBzYW1lIGZpbGU/CgpkZWYgc2FtZXN0YXQoczEsIHMyKToKICAgICIiIlRlc3Qgd2hldGhlciB0d28gc3RhdCBidWZmZXJzIHJlZmVyZW5jZSB0aGUgc2FtZSBmaWxlIiIiCiAgICByZXR1cm4gczEuc3RfaW5vID09IHMyLnN0X2lubyBhbmQgXAogICAgICAgICAgIHMxLnN0X2RldiA9PSBzMi5zdF9kZXYKCgojIElzIGEgcGF0aCBhIG1vdW50IHBvaW50PwojIChEb2VzIHRoaXMgd29yayBmb3IgYWxsIFVOSVhlcz8gIElzIGl0IGV2ZW4gZ3VhcmFudGVlZCB0byB3b3JrIGJ5IFBvc2l4PykKCmRlZiBpc21vdW50KHBhdGgpOgogICAgIiIiVGVzdCB3aGV0aGVyIGEgcGF0aCBpcyBhIG1vdW50IHBvaW50IiIiCiAgICBpZiBpc2xpbmsocGF0aCk6CiAgICAgICAgIyBBIHN5bWxpbmsgY2FuIG5ldmVyIGJlIGEgbW91bnQgcG9pbnQKICAgICAgICByZXR1cm4gRmFsc2UKICAgIHRyeToKICAgICAgICBzMSA9IG9zLmxzdGF0KHBhdGgpCiAgICAgICAgaWYgaXNpbnN0YW5jZShwYXRoLCBieXRlcyk6CiAgICAgICAgICAgIHBhcmVudCA9IGpvaW4ocGF0aCwgYicuLicpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcGFyZW50ID0gam9pbihwYXRoLCAnLi4nKQogICAgICAgIHMyID0gb3MubHN0YXQocGFyZW50KQogICAgZXhjZXB0IG9zLmVycm9yOgogICAgICAgIHJldHVybiBGYWxzZSAjIEl0IGRvZXNuJ3QgZXhpc3QgLS0gc28gbm90IGEgbW91bnQgcG9pbnQgOi0pCiAgICBkZXYxID0gczEuc3RfZGV2CiAgICBkZXYyID0gczIuc3RfZGV2CiAgICBpZiBkZXYxICE9IGRldjI6CiAgICAgICAgcmV0dXJuIFRydWUgICAgICMgcGF0aC8uLiBvbiBhIGRpZmZlcmVudCBkZXZpY2UgYXMgcGF0aAogICAgaW5vMSA9IHMxLnN0X2lubwogICAgaW5vMiA9IHMyLnN0X2lubwogICAgaWYgaW5vMSA9PSBpbm8yOgogICAgICAgIHJldHVybiBUcnVlICAgICAjIHBhdGgvLi4gaXMgdGhlIHNhbWUgaS1ub2RlIGFzIHBhdGgKICAgIHJldHVybiBGYWxzZQoKCiMgRXhwYW5kIHBhdGhzIGJlZ2lubmluZyB3aXRoICd+JyBvciAnfnVzZXInLgojICd+JyBtZWFucyAkSE9NRTsgJ351c2VyJyBtZWFucyB0aGF0IHVzZXIncyBob21lIGRpcmVjdG9yeS4KIyBJZiB0aGUgcGF0aCBkb2Vzbid0IGJlZ2luIHdpdGggJ34nLCBvciBpZiB0aGUgdXNlciBvciAkSE9NRSBpcyB1bmtub3duLAojIHRoZSBwYXRoIGlzIHJldHVybmVkIHVuY2hhbmdlZCAobGVhdmluZyBlcnJvciByZXBvcnRpbmcgdG8gd2hhdGV2ZXIKIyBmdW5jdGlvbiBpcyBjYWxsZWQgd2l0aCB0aGUgZXhwYW5kZWQgcGF0aCBhcyBhcmd1bWVudCkuCiMgU2VlIGFsc28gbW9kdWxlICdnbG9iJyBmb3IgZXhwYW5zaW9uIG9mICosID8gYW5kIFsuLi5dIGluIHBhdGhuYW1lcy4KIyAoQSBmdW5jdGlvbiBzaG91bGQgYWxzbyBiZSBkZWZpbmVkIHRvIGRvIGZ1bGwgKnNoLXN0eWxlIGVudmlyb25tZW50CiMgdmFyaWFibGUgZXhwYW5zaW9uLikKCmRlZiBleHBhbmR1c2VyKHBhdGgpOgogICAgIiIiRXhwYW5kIH4gYW5kIH51c2VyIGNvbnN0cnVjdGlvbnMuICBJZiB1c2VyIG9yICRIT01FIGlzIHVua25vd24sCiAgICBkbyBub3RoaW5nLiIiIgogICAgaWYgaXNpbnN0YW5jZShwYXRoLCBieXRlcyk6CiAgICAgICAgdGlsZGUgPSBiJ34nCiAgICBlbHNlOgogICAgICAgIHRpbGRlID0gJ34nCiAgICBpZiBub3QgcGF0aC5zdGFydHN3aXRoKHRpbGRlKToKICAgICAgICByZXR1cm4gcGF0aAogICAgc2VwID0gX2dldF9zZXAocGF0aCkKICAgIGkgPSBwYXRoLmZpbmQoc2VwLCAxKQogICAgaWYgaSA8IDA6CiAgICAgICAgaSA9IGxlbihwYXRoKQogICAgaWYgaSA9PSAxOgogICAgICAgIGlmICdIT01FJyBub3QgaW4gb3MuZW52aXJvbjoKICAgICAgICAgICAgaW1wb3J0IHB3ZAogICAgICAgICAgICB1c2VyaG9tZSA9IHB3ZC5nZXRwd3VpZChvcy5nZXR1aWQoKSkucHdfZGlyCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdXNlcmhvbWUgPSBvcy5lbnZpcm9uWydIT01FJ10KICAgIGVsc2U6CiAgICAgICAgaW1wb3J0IHB3ZAogICAgICAgIG5hbWUgPSBwYXRoWzE6aV0KICAgICAgICBpZiBpc2luc3RhbmNlKG5hbWUsIGJ5dGVzKToKICAgICAgICAgICAgbmFtZSA9IHN0cihuYW1lLCAnQVNDSUknKQogICAgICAgIHRyeToKICAgICAgICAgICAgcHdlbnQgPSBwd2QuZ2V0cHduYW0obmFtZSkKICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIHJldHVybiBwYXRoCiAgICAgICAgdXNlcmhvbWUgPSBwd2VudC5wd19kaXIKICAgIGlmIGlzaW5zdGFuY2UocGF0aCwgYnl0ZXMpOgogICAgICAgIHVzZXJob21lID0gb3MuZnNlbmNvZGUodXNlcmhvbWUpCiAgICAgICAgcm9vdCA9IGInLycKICAgIGVsc2U6CiAgICAgICAgcm9vdCA9ICcvJwogICAgdXNlcmhvbWUgPSB1c2VyaG9tZS5yc3RyaXAocm9vdCkKICAgIHJldHVybiAodXNlcmhvbWUgKyBwYXRoW2k6XSkgb3Igcm9vdAoKCiMgRXhwYW5kIHBhdGhzIGNvbnRhaW5pbmcgc2hlbGwgdmFyaWFibGUgc3Vic3RpdHV0aW9ucy4KIyBUaGlzIGV4cGFuZHMgdGhlIGZvcm1zICR2YXJpYWJsZSBhbmQgJHt2YXJpYWJsZX0gb25seS4KIyBOb24tZXhpc3RlbnQgdmFyaWFibGVzIGFyZSBsZWZ0IHVuY2hhbmdlZC4KCl92YXJwcm9nID0gTm9uZQpfdmFycHJvZ2IgPSBOb25lCgpkZWYgZXhwYW5kdmFycyhwYXRoKToKICAgICIiIkV4cGFuZCBzaGVsbCB2YXJpYWJsZXMgb2YgZm9ybSAkdmFyIGFuZCAke3Zhcn0uICBVbmtub3duIHZhcmlhYmxlcwogICAgYXJlIGxlZnQgdW5jaGFuZ2VkLiIiIgogICAgZ2xvYmFsIF92YXJwcm9nLCBfdmFycHJvZ2IKICAgIGlmIGlzaW5zdGFuY2UocGF0aCwgYnl0ZXMpOgogICAgICAgIGlmIGInJCcgbm90IGluIHBhdGg6CiAgICAgICAgICAgIHJldHVybiBwYXRoCiAgICAgICAgaWYgbm90IF92YXJwcm9nYjoKICAgICAgICAgICAgaW1wb3J0IHJlCiAgICAgICAgICAgIF92YXJwcm9nYiA9IHJlLmNvbXBpbGUoYnInXCQoXHcrfFx7W159XSpcfSknLCByZS5BU0NJSSkKICAgICAgICBzZWFyY2ggPSBfdmFycHJvZ2Iuc2VhcmNoCiAgICAgICAgc3RhcnQgPSBiJ3snCiAgICAgICAgZW5kID0gYid9JwogICAgZWxzZToKICAgICAgICBpZiAnJCcgbm90IGluIHBhdGg6CiAgICAgICAgICAgIHJldHVybiBwYXRoCiAgICAgICAgaWYgbm90IF92YXJwcm9nOgogICAgICAgICAgICBpbXBvcnQgcmUKICAgICAgICAgICAgX3ZhcnByb2cgPSByZS5jb21waWxlKHInXCQoXHcrfFx7W159XSpcfSknLCByZS5BU0NJSSkKICAgICAgICBzZWFyY2ggPSBfdmFycHJvZy5zZWFyY2gKICAgICAgICBzdGFydCA9ICd7JwogICAgICAgIGVuZCA9ICd9JwogICAgaSA9IDAKICAgIHdoaWxlIFRydWU6CiAgICAgICAgbSA9IHNlYXJjaChwYXRoLCBpKQogICAgICAgIGlmIG5vdCBtOgogICAgICAgICAgICBicmVhawogICAgICAgIGksIGogPSBtLnNwYW4oMCkKICAgICAgICBuYW1lID0gbS5ncm91cCgxKQogICAgICAgIGlmIG5hbWUuc3RhcnRzd2l0aChzdGFydCkgYW5kIG5hbWUuZW5kc3dpdGgoZW5kKToKICAgICAgICAgICAgbmFtZSA9IG5hbWVbMTotMV0KICAgICAgICBpZiBpc2luc3RhbmNlKG5hbWUsIGJ5dGVzKToKICAgICAgICAgICAgbmFtZSA9IHN0cihuYW1lLCAnQVNDSUknKQogICAgICAgIGlmIG5hbWUgaW4gb3MuZW52aXJvbjoKICAgICAgICAgICAgdGFpbCA9IHBhdGhbajpdCiAgICAgICAgICAgIHZhbHVlID0gb3MuZW52aXJvbltuYW1lXQogICAgICAgICAgICBpZiBpc2luc3RhbmNlKHBhdGgsIGJ5dGVzKToKICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUuZW5jb2RlKCdBU0NJSScpCiAgICAgICAgICAgIHBhdGggPSBwYXRoWzppXSArIHZhbHVlCiAgICAgICAgICAgIGkgPSBsZW4ocGF0aCkKICAgICAgICAgICAgcGF0aCArPSB0YWlsCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaSA9IGoKICAgIHJldHVybiBwYXRoCgoKIyBOb3JtYWxpemUgYSBwYXRoLCBlLmcuIEEvL0IsIEEvLi9CIGFuZCBBL2Zvby8uLi9CIGFsbCBiZWNvbWUgQS9CLgojIEl0IHNob3VsZCBiZSB1bmRlcnN0b29kIHRoYXQgdGhpcyBtYXkgY2hhbmdlIHRoZSBtZWFuaW5nIG9mIHRoZSBwYXRoCiMgaWYgaXQgY29udGFpbnMgc3ltYm9saWMgbGlua3MhCgpkZWYgbm9ybXBhdGgocGF0aCk6CiAgICAiIiJOb3JtYWxpemUgcGF0aCwgZWxpbWluYXRpbmcgZG91YmxlIHNsYXNoZXMsIGV0Yy4iIiIKICAgIGlmIGlzaW5zdGFuY2UocGF0aCwgYnl0ZXMpOgogICAgICAgIHNlcCA9IGInLycKICAgICAgICBlbXB0eSA9IGInJwogICAgICAgIGRvdCA9IGInLicKICAgICAgICBkb3Rkb3QgPSBiJy4uJwogICAgZWxzZToKICAgICAgICBzZXAgPSAnLycKICAgICAgICBlbXB0eSA9ICcnCiAgICAgICAgZG90ID0gJy4nCiAgICAgICAgZG90ZG90ID0gJy4uJwogICAgaWYgcGF0aCA9PSBlbXB0eToKICAgICAgICByZXR1cm4gZG90CiAgICBpbml0aWFsX3NsYXNoZXMgPSBwYXRoLnN0YXJ0c3dpdGgoc2VwKQogICAgIyBQT1NJWCBhbGxvd3Mgb25lIG9yIHR3byBpbml0aWFsIHNsYXNoZXMsIGJ1dCB0cmVhdHMgdGhyZWUgb3IgbW9yZQogICAgIyBhcyBzaW5nbGUgc2xhc2guCiAgICBpZiAoaW5pdGlhbF9zbGFzaGVzIGFuZAogICAgICAgIHBhdGguc3RhcnRzd2l0aChzZXAqMikgYW5kIG5vdCBwYXRoLnN0YXJ0c3dpdGgoc2VwKjMpKToKICAgICAgICBpbml0aWFsX3NsYXNoZXMgPSAyCiAgICBjb21wcyA9IHBhdGguc3BsaXQoc2VwKQogICAgbmV3X2NvbXBzID0gW10KICAgIGZvciBjb21wIGluIGNvbXBzOgogICAgICAgIGlmIGNvbXAgaW4gKGVtcHR5LCBkb3QpOgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGlmIChjb21wICE9IGRvdGRvdCBvciAobm90IGluaXRpYWxfc2xhc2hlcyBhbmQgbm90IG5ld19jb21wcykgb3IKICAgICAgICAgICAgIChuZXdfY29tcHMgYW5kIG5ld19jb21wc1stMV0gPT0gZG90ZG90KSk6CiAgICAgICAgICAgIG5ld19jb21wcy5hcHBlbmQoY29tcCkKICAgICAgICBlbGlmIG5ld19jb21wczoKICAgICAgICAgICAgbmV3X2NvbXBzLnBvcCgpCiAgICBjb21wcyA9IG5ld19jb21wcwogICAgcGF0aCA9IHNlcC5qb2luKGNvbXBzKQogICAgaWYgaW5pdGlhbF9zbGFzaGVzOgogICAgICAgICNmaXhtZSBieXRob24KICAgICAgICAjcGF0aCA9IHNlcCppbml0aWFsX3NsYXNoZXMgKyBwYXRoCiAgICAgICAgcGF0aCA9IHNlcCppbnQoaW5pdGlhbF9zbGFzaGVzKSArIHBhdGgKICAgIHJldHVybiBwYXRoIG9yIGRvdAoKCmRlZiBhYnNwYXRoKHBhdGgpOgogICAgIiIiUmV0dXJuIGFuIGFic29sdXRlIHBhdGguIiIiCiAgICBpZiBub3QgaXNhYnMocGF0aCk6CiAgICAgICAgaWYgaXNpbnN0YW5jZShwYXRoLCBieXRlcyk6CiAgICAgICAgICAgIGN3ZCA9IG9zLmdldGN3ZGIoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGN3ZCA9IG9zLmdldGN3ZCgpCiAgICAgICAgcGF0aCA9IGpvaW4oY3dkLCBwYXRoKQogICAgcmV0dXJuIG5vcm1wYXRoKHBhdGgpCgoKIyBSZXR1cm4gYSBjYW5vbmljYWwgcGF0aCAoaS5lLiB0aGUgYWJzb2x1dGUgbG9jYXRpb24gb2YgYSBmaWxlIG9uIHRoZQojIGZpbGVzeXN0ZW0pLgoKZGVmIHJlYWxwYXRoKGZpbGVuYW1lKToKICAgICIiIlJldHVybiB0aGUgY2Fub25pY2FsIHBhdGggb2YgdGhlIHNwZWNpZmllZCBmaWxlbmFtZSwgZWxpbWluYXRpbmcgYW55CnN5bWJvbGljIGxpbmtzIGVuY291bnRlcmVkIGluIHRoZSBwYXRoLiIiIgogICAgaWYgaXNpbnN0YW5jZShmaWxlbmFtZSwgYnl0ZXMpOgogICAgICAgIHNlcCA9IGInLycKICAgICAgICBlbXB0eSA9IGInJwogICAgZWxzZToKICAgICAgICBzZXAgPSAnLycKICAgICAgICBlbXB0eSA9ICcnCiAgICBpZiBpc2FicyhmaWxlbmFtZSk6CiAgICAgICAgYml0cyA9IFtzZXBdICsgZmlsZW5hbWUuc3BsaXQoc2VwKVsxOl0KICAgIGVsc2U6CiAgICAgICAgYml0cyA9IFtlbXB0eV0gKyBmaWxlbmFtZS5zcGxpdChzZXApCgogICAgZm9yIGkgaW4gcmFuZ2UoMiwgbGVuKGJpdHMpKzEpOgogICAgICAgIGNvbXBvbmVudCA9IGpvaW4oKmJpdHNbMDppXSkKICAgICAgICAjIFJlc29sdmUgc3ltYm9saWMgbGlua3MuCiAgICAgICAgaWYgaXNsaW5rKGNvbXBvbmVudCk6CiAgICAgICAgICAgIHJlc29sdmVkID0gX3Jlc29sdmVfbGluayhjb21wb25lbnQpCiAgICAgICAgICAgIGlmIHJlc29sdmVkIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAjIEluZmluaXRlIGxvb3AgLS0gcmV0dXJuIG9yaWdpbmFsIGNvbXBvbmVudCArIHJlc3Qgb2YgdGhlIHBhdGgKICAgICAgICAgICAgICAgIHJldHVybiBhYnNwYXRoKGpvaW4oKihbY29tcG9uZW50XSArIGJpdHNbaTpdKSkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBuZXdwYXRoID0gam9pbigqKFtyZXNvbHZlZF0gKyBiaXRzW2k6XSkpCiAgICAgICAgICAgICAgICByZXR1cm4gcmVhbHBhdGgobmV3cGF0aCkKCiAgICByZXR1cm4gYWJzcGF0aChmaWxlbmFtZSkKCgpkZWYgX3Jlc29sdmVfbGluayhwYXRoKToKICAgICIiIkludGVybmFsIGhlbHBlciBmdW5jdGlvbi4gIFRha2VzIGEgcGF0aCBhbmQgZm9sbG93cyBzeW1saW5rcwogICAgdW50aWwgd2UgZWl0aGVyIGFycml2ZSBhdCBzb21ldGhpbmcgdGhhdCBpc24ndCBhIHN5bWxpbmssIG9yCiAgICBlbmNvdW50ZXIgYSBwYXRoIHdlJ3ZlIHNlZW4gYmVmb3JlIChtZWFuaW5nIHRoYXQgdGhlcmUncyBhIGxvb3ApLgogICAgIiIiCiAgICBwYXRoc19zZWVuID0gc2V0KCkKICAgIHdoaWxlIGlzbGluayhwYXRoKToKICAgICAgICBpZiBwYXRoIGluIHBhdGhzX3NlZW46CiAgICAgICAgICAgICMgQWxyZWFkeSBzZWVuIHRoaXMgcGF0aCwgc28gd2UgbXVzdCBoYXZlIGEgc3ltbGluayBsb29wCiAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgcGF0aHNfc2Vlbi5hZGQocGF0aCkKICAgICAgICAjIFJlc29sdmUgd2hlcmUgdGhlIGxpbmsgcG9pbnRzIHRvCiAgICAgICAgcmVzb2x2ZWQgPSBvcy5yZWFkbGluayhwYXRoKQogICAgICAgIGlmIG5vdCBpc2FicyhyZXNvbHZlZCk6CiAgICAgICAgICAgIGRpciA9IGRpcm5hbWUocGF0aCkKICAgICAgICAgICAgcGF0aCA9IG5vcm1wYXRoKGpvaW4oZGlyLCByZXNvbHZlZCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcGF0aCA9IG5vcm1wYXRoKHJlc29sdmVkKQogICAgcmV0dXJuIHBhdGgKCnN1cHBvcnRzX3VuaWNvZGVfZmlsZW5hbWVzID0gKHN5cy5wbGF0Zm9ybSA9PSAnZGFyd2luJykKCmRlZiByZWxwYXRoKHBhdGgsIHN0YXJ0PU5vbmUpOgogICAgIiIiUmV0dXJuIGEgcmVsYXRpdmUgdmVyc2lvbiBvZiBhIHBhdGgiIiIKCiAgICBpZiBub3QgcGF0aDoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJubyBwYXRoIHNwZWNpZmllZCIpCgogICAgaWYgaXNpbnN0YW5jZShwYXRoLCBieXRlcyk6CiAgICAgICAgY3VyZGlyID0gYicuJwogICAgICAgIHNlcCA9IGInLycKICAgICAgICBwYXJkaXIgPSBiJy4uJwogICAgZWxzZToKICAgICAgICBjdXJkaXIgPSAnLicKICAgICAgICBzZXAgPSAnLycKICAgICAgICBwYXJkaXIgPSAnLi4nCgogICAgaWYgc3RhcnQgaXMgTm9uZToKICAgICAgICBzdGFydCA9IGN1cmRpcgoKICAgIHN0YXJ0X2xpc3QgPSBbeCBmb3IgeCBpbiBhYnNwYXRoKHN0YXJ0KS5zcGxpdChzZXApIGlmIHhdCiAgICBwYXRoX2xpc3QgPSBbeCBmb3IgeCBpbiBhYnNwYXRoKHBhdGgpLnNwbGl0KHNlcCkgaWYgeF0KCiAgICAjIFdvcmsgb3V0IGhvdyBtdWNoIG9mIHRoZSBmaWxlcGF0aCBpcyBzaGFyZWQgYnkgc3RhcnQgYW5kIHBhdGguCiAgICBpID0gbGVuKGNvbW1vbnByZWZpeChbc3RhcnRfbGlzdCwgcGF0aF9saXN0XSkpCgogICAgcmVsX2xpc3QgPSBbcGFyZGlyXSAqIChsZW4oc3RhcnRfbGlzdCktaSkgKyBwYXRoX2xpc3RbaTpdCiAgICBpZiBub3QgcmVsX2xpc3Q6CiAgICAgICAgcmV0dXJuIGN1cmRpcgogICAgcmV0dXJuIGpvaW4oKnJlbF9saXN0KQo=',
'/Lib/pprint.py':'IyAgQXV0aG9yOiAgICAgIEZyZWQgTC4gRHJha2UsIEpyLgojICAgICAgICAgICAgICAgZmRyYWtlQGFjbS5vcmcKIwojICBUaGlzIGlzIGEgc2ltcGxlIGxpdHRsZSBtb2R1bGUgSSB3cm90ZSB0byBtYWtlIGxpZmUgZWFzaWVyLiAgSSBkaWRuJ3QKIyAgc2VlIGFueXRoaW5nIHF1aXRlIGxpa2UgaXQgaW4gdGhlIGxpYnJhcnksIHRob3VnaCBJIG1heSBoYXZlIG92ZXJsb29rZWQKIyAgc29tZXRoaW5nLiAgSSB3cm90ZSB0aGlzIHdoZW4gSSB3YXMgdHJ5aW5nIHRvIHJlYWQgc29tZSBoZWF2aWx5IG5lc3RlZAojICB0dXBsZXMgd2l0aCBmYWlybHkgbm9uLWRlc2NyaXB0aXZlIGNvbnRlbnQuICBUaGlzIGlzIG1vZGVsZWQgdmVyeSBtdWNoCiMgIGFmdGVyIExpc3AvU2NoZW1lIC0gc3R5bGUgcHJldHR5LXByaW50aW5nIG9mIGxpc3RzLiAgSWYgeW91IGZpbmQgaXQKIyAgdXNlZnVsLCB0aGFuayBzbWFsbCBjaGlsZHJlbiB3aG8gc2xlZXAgYXQgbmlnaHQuCgoiIiJTdXBwb3J0IHRvIHByZXR0eS1wcmludCBsaXN0cywgdHVwbGVzLCAmIGRpY3Rpb25hcmllcyByZWN1cnNpdmVseS4KClZlcnkgc2ltcGxlLCBidXQgdXNlZnVsLCBlc3BlY2lhbGx5IGluIGRlYnVnZ2luZyBkYXRhIHN0cnVjdHVyZXMuCgpDbGFzc2VzCi0tLS0tLS0KClByZXR0eVByaW50ZXIoKQogICAgSGFuZGxlIHByZXR0eS1wcmludGluZyBvcGVyYXRpb25zIG9udG8gYSBzdHJlYW0gdXNpbmcgYSBjb25maWd1cmVkCiAgICBzZXQgb2YgZm9ybWF0dGluZyBwYXJhbWV0ZXJzLgoKRnVuY3Rpb25zCi0tLS0tLS0tLQoKcGZvcm1hdCgpCiAgICBGb3JtYXQgYSBQeXRob24gb2JqZWN0IGludG8gYSBwcmV0dHktcHJpbnRlZCByZXByZXNlbnRhdGlvbi4KCnBwcmludCgpCiAgICBQcmV0dHktcHJpbnQgYSBQeXRob24gb2JqZWN0IHRvIGEgc3RyZWFtIFtkZWZhdWx0IGlzIHN5cy5zdGRvdXRdLgoKc2FmZXJlcHIoKQogICAgR2VuZXJhdGUgYSAnc3RhbmRhcmQnIHJlcHIoKS1saWtlIHZhbHVlLCBidXQgcHJvdGVjdCBhZ2FpbnN0IHJlY3Vyc2l2ZQogICAgZGF0YSBzdHJ1Y3R1cmVzLgoKIiIiCgppbXBvcnQgc3lzIGFzIF9zeXMKZnJvbSBjb2xsZWN0aW9ucyBpbXBvcnQgT3JkZXJlZERpY3QgYXMgX09yZGVyZWREaWN0CmZyb20gaW8gaW1wb3J0IFN0cmluZ0lPIGFzIF9TdHJpbmdJTwoKX19hbGxfXyA9IFsicHByaW50IiwicGZvcm1hdCIsImlzcmVhZGFibGUiLCJpc3JlY3Vyc2l2ZSIsInNhZmVyZXByIiwKICAgICAgICAgICAiUHJldHR5UHJpbnRlciJdCgojIGNhY2hlIHRoZXNlIGZvciBmYXN0ZXIgYWNjZXNzOgpfY29tbWFqb2luID0gIiwgIi5qb2luCl9pZCA9IGlkCl9sZW4gPSBsZW4KX3R5cGUgPSB0eXBlCgoKZGVmIHBwcmludChvYmplY3QsIHN0cmVhbT1Ob25lLCBpbmRlbnQ9MSwgd2lkdGg9ODAsIGRlcHRoPU5vbmUpOgogICAgIiIiUHJldHR5LXByaW50IGEgUHl0aG9uIG9iamVjdCB0byBhIHN0cmVhbSBbZGVmYXVsdCBpcyBzeXMuc3Rkb3V0XS4iIiIKICAgIHByaW50ZXIgPSBQcmV0dHlQcmludGVyKAogICAgICAgIHN0cmVhbT1zdHJlYW0sIGluZGVudD1pbmRlbnQsIHdpZHRoPXdpZHRoLCBkZXB0aD1kZXB0aCkKICAgIHByaW50ZXIucHByaW50KG9iamVjdCkKCmRlZiBwZm9ybWF0KG9iamVjdCwgaW5kZW50PTEsIHdpZHRoPTgwLCBkZXB0aD1Ob25lKToKICAgICIiIkZvcm1hdCBhIFB5dGhvbiBvYmplY3QgaW50byBhIHByZXR0eS1wcmludGVkIHJlcHJlc2VudGF0aW9uLiIiIgogICAgcmV0dXJuIFByZXR0eVByaW50ZXIoaW5kZW50PWluZGVudCwgd2lkdGg9d2lkdGgsIGRlcHRoPWRlcHRoKS5wZm9ybWF0KG9iamVjdCkKCmRlZiBzYWZlcmVwcihvYmplY3QpOgogICAgIiIiVmVyc2lvbiBvZiByZXByKCkgd2hpY2ggY2FuIGhhbmRsZSByZWN1cnNpdmUgZGF0YSBzdHJ1Y3R1cmVzLiIiIgogICAgcmV0dXJuIF9zYWZlX3JlcHIob2JqZWN0LCB7fSwgTm9uZSwgMClbMF0KCmRlZiBpc3JlYWRhYmxlKG9iamVjdCk6CiAgICAiIiJEZXRlcm1pbmUgaWYgc2FmZXJlcHIob2JqZWN0KSBpcyByZWFkYWJsZSBieSBldmFsKCkuIiIiCiAgICByZXR1cm4gX3NhZmVfcmVwcihvYmplY3QsIHt9LCBOb25lLCAwKVsxXQoKZGVmIGlzcmVjdXJzaXZlKG9iamVjdCk6CiAgICAiIiJEZXRlcm1pbmUgaWYgb2JqZWN0IHJlcXVpcmVzIGEgcmVjdXJzaXZlIHJlcHJlc2VudGF0aW9uLiIiIgogICAgcmV0dXJuIF9zYWZlX3JlcHIob2JqZWN0LCB7fSwgTm9uZSwgMClbMl0KCmNsYXNzIF9zYWZlX2tleToKICAgICIiIkhlbHBlciBmdW5jdGlvbiBmb3Iga2V5IGZ1bmN0aW9ucyB3aGVuIHNvcnRpbmcgdW5vcmRlcmFibGUgb2JqZWN0cy4KCiAgICBUaGUgd3JhcHBlZC1vYmplY3Qgd2lsbCBmYWxsYmFjayB0byBhbiBQeTIueCBzdHlsZSBjb21wYXJpc29uIGZvcgogICAgdW5vcmRlcmFibGUgdHlwZXMgKHNvcnRpbmcgZmlyc3QgY29tcGFyaW5nIHRoZSB0eXBlIG5hbWUgYW5kIHRoZW4gYnkKICAgIHRoZSBvYmogaWRzKS4gIERvZXMgbm90IHdvcmsgcmVjdXJzaXZlbHksIHNvIGRpY3QuaXRlbXMoKSBtdXN0IGhhdmUKICAgIF9zYWZlX2tleSBhcHBsaWVkIHRvIGJvdGggdGhlIGtleSBhbmQgdGhlIHZhbHVlLgoKICAgICIiIgoKICAgIF9fc2xvdHNfXyA9IFsnb2JqJ10KCiAgICBkZWYgX19pbml0X18oc2VsZiwgb2JqKToKICAgICAgICBzZWxmLm9iaiA9IG9iagoKICAgIGRlZiBfX2x0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIHRyeToKICAgICAgICAgICAgcnYgPSBzZWxmLm9iai5fX2x0X18ob3RoZXIub2JqKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgICAgIHJ2ID0gTm90SW1wbGVtZW50ZWQKCiAgICAgICAgaWYgcnYgaXMgTm90SW1wbGVtZW50ZWQ6CiAgICAgICAgICAgIHJ2ID0gKHN0cih0eXBlKHNlbGYub2JqKSksIGlkKHNlbGYub2JqKSkgPCBcCiAgICAgICAgICAgICAgICAgKHN0cih0eXBlKG90aGVyLm9iaikpLCBpZChvdGhlci5vYmopKQogICAgICAgIHJldHVybiBydgoKZGVmIF9zYWZlX3R1cGxlKHQpOgogICAgIkhlbHBlciBmdW5jdGlvbiBmb3IgY29tcGFyaW5nIDItdHVwbGVzIgogICAgcmV0dXJuIF9zYWZlX2tleSh0WzBdKSwgX3NhZmVfa2V5KHRbMV0pCgpjbGFzcyBQcmV0dHlQcmludGVyOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGluZGVudD0xLCB3aWR0aD04MCwgZGVwdGg9Tm9uZSwgc3RyZWFtPU5vbmUpOgogICAgICAgICIiIkhhbmRsZSBwcmV0dHkgcHJpbnRpbmcgb3BlcmF0aW9ucyBvbnRvIGEgc3RyZWFtIHVzaW5nIGEgc2V0IG9mCiAgICAgICAgY29uZmlndXJlZCBwYXJhbWV0ZXJzLgoKICAgICAgICBpbmRlbnQKICAgICAgICAgICAgTnVtYmVyIG9mIHNwYWNlcyB0byBpbmRlbnQgZm9yIGVhY2ggbGV2ZWwgb2YgbmVzdGluZy4KCiAgICAgICAgd2lkdGgKICAgICAgICAgICAgQXR0ZW1wdGVkIG1heGltdW0gbnVtYmVyIG9mIGNvbHVtbnMgaW4gdGhlIG91dHB1dC4KCiAgICAgICAgZGVwdGgKICAgICAgICAgICAgVGhlIG1heGltdW0gZGVwdGggdG8gcHJpbnQgb3V0IG5lc3RlZCBzdHJ1Y3R1cmVzLgoKICAgICAgICBzdHJlYW0KICAgICAgICAgICAgVGhlIGRlc2lyZWQgb3V0cHV0IHN0cmVhbS4gIElmIG9taXR0ZWQgKG9yIGZhbHNlKSwgdGhlIHN0YW5kYXJkCiAgICAgICAgICAgIG91dHB1dCBzdHJlYW0gYXZhaWxhYmxlIGF0IGNvbnN0cnVjdGlvbiB3aWxsIGJlIHVzZWQuCgogICAgICAgICIiIgogICAgICAgIGluZGVudCA9IGludChpbmRlbnQpCiAgICAgICAgd2lkdGggPSBpbnQod2lkdGgpCiAgICAgICAgYXNzZXJ0IGluZGVudCA+PSAwLCAiaW5kZW50IG11c3QgYmUgPj0gMCIKICAgICAgICBhc3NlcnQgZGVwdGggaXMgTm9uZSBvciBkZXB0aCA+IDAsICJkZXB0aCBtdXN0IGJlID4gMCIKICAgICAgICBhc3NlcnQgd2lkdGgsICJ3aWR0aCBtdXN0IGJlICE9IDAiCiAgICAgICAgc2VsZi5fZGVwdGggPSBkZXB0aAogICAgICAgIHNlbGYuX2luZGVudF9wZXJfbGV2ZWwgPSBpbmRlbnQKICAgICAgICBzZWxmLl93aWR0aCA9IHdpZHRoCiAgICAgICAgaWYgc3RyZWFtIGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLl9zdHJlYW0gPSBzdHJlYW0KICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl9zdHJlYW0gPSBfc3lzLnN0ZG91dAoKICAgIGRlZiBwcHJpbnQoc2VsZiwgb2JqZWN0KToKICAgICAgICBzZWxmLl9mb3JtYXQob2JqZWN0LCBzZWxmLl9zdHJlYW0sIDAsIDAsIHt9LCAwKQogICAgICAgIHNlbGYuX3N0cmVhbS53cml0ZSgiXG4iKQoKICAgIGRlZiBwZm9ybWF0KHNlbGYsIG9iamVjdCk6CiAgICAgICAgc2lvID0gX1N0cmluZ0lPKCkKICAgICAgICBzZWxmLl9mb3JtYXQob2JqZWN0LCBzaW8sIDAsIDAsIHt9LCAwKQogICAgICAgIHJldHVybiBzaW8uZ2V0dmFsdWUoKQoKICAgIGRlZiBpc3JlY3Vyc2l2ZShzZWxmLCBvYmplY3QpOgogICAgICAgIHJldHVybiBzZWxmLmZvcm1hdChvYmplY3QsIHt9LCAwLCAwKVsyXQoKICAgIGRlZiBpc3JlYWRhYmxlKHNlbGYsIG9iamVjdCk6CiAgICAgICAgcywgcmVhZGFibGUsIHJlY3Vyc2l2ZSA9IHNlbGYuZm9ybWF0KG9iamVjdCwge30sIDAsIDApCiAgICAgICAgcmV0dXJuIHJlYWRhYmxlIGFuZCBub3QgcmVjdXJzaXZlCgogICAgZGVmIF9mb3JtYXQoc2VsZiwgb2JqZWN0LCBzdHJlYW0sIGluZGVudCwgYWxsb3dhbmNlLCBjb250ZXh0LCBsZXZlbCk6CiAgICAgICAgbGV2ZWwgPSBsZXZlbCArIDEKICAgICAgICBvYmppZCA9IF9pZChvYmplY3QpCiAgICAgICAgaWYgb2JqaWQgaW4gY29udGV4dDoKICAgICAgICAgICAgc3RyZWFtLndyaXRlKF9yZWN1cnNpb24ob2JqZWN0KSkKICAgICAgICAgICAgc2VsZi5fcmVjdXJzaXZlID0gVHJ1ZQogICAgICAgICAgICBzZWxmLl9yZWFkYWJsZSA9IEZhbHNlCiAgICAgICAgICAgIHJldHVybgogICAgICAgIHJlcCA9IHNlbGYuX3JlcHIob2JqZWN0LCBjb250ZXh0LCBsZXZlbCAtIDEpCiAgICAgICAgdHlwID0gX3R5cGUob2JqZWN0KQogICAgICAgIHNlcExpbmVzID0gX2xlbihyZXApID4gKHNlbGYuX3dpZHRoIC0gMSAtIGluZGVudCAtIGFsbG93YW5jZSkKICAgICAgICB3cml0ZSA9IHN0cmVhbS53cml0ZQoKICAgICAgICBpZiBzZWxmLl9kZXB0aCBhbmQgbGV2ZWwgPiBzZWxmLl9kZXB0aDoKICAgICAgICAgICAgd3JpdGUocmVwKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgc2VwTGluZXM6CiAgICAgICAgICAgIHIgPSBnZXRhdHRyKHR5cCwgIl9fcmVwcl9fIiwgTm9uZSkKICAgICAgICAgICAgaWYgaXNzdWJjbGFzcyh0eXAsIGRpY3QpOgogICAgICAgICAgICAgICAgd3JpdGUoJ3snKQogICAgICAgICAgICAgICAgaWYgc2VsZi5faW5kZW50X3Blcl9sZXZlbCA+IDE6CiAgICAgICAgICAgICAgICAgICAgd3JpdGUoKHNlbGYuX2luZGVudF9wZXJfbGV2ZWwgLSAxKSAqICcgJykKICAgICAgICAgICAgICAgIGxlbmd0aCA9IF9sZW4ob2JqZWN0KQogICAgICAgICAgICAgICAgaWYgbGVuZ3RoOgogICAgICAgICAgICAgICAgICAgIGNvbnRleHRbb2JqaWRdID0gMQogICAgICAgICAgICAgICAgICAgIGluZGVudCA9IGluZGVudCArIHNlbGYuX2luZGVudF9wZXJfbGV2ZWwKICAgICAgICAgICAgICAgICAgICBpZiBpc3N1YmNsYXNzKHR5cCwgX09yZGVyZWREaWN0KToKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXMgPSBsaXN0KG9iamVjdC5pdGVtcygpKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zID0gc29ydGVkKG9iamVjdC5pdGVtcygpLCBrZXk9X3NhZmVfdHVwbGUpCiAgICAgICAgICAgICAgICAgICAga2V5LCBlbnQgPSBpdGVtc1swXQogICAgICAgICAgICAgICAgICAgIHJlcCA9IHNlbGYuX3JlcHIoa2V5LCBjb250ZXh0LCBsZXZlbCkKICAgICAgICAgICAgICAgICAgICB3cml0ZShyZXApCiAgICAgICAgICAgICAgICAgICAgd3JpdGUoJzogJykKICAgICAgICAgICAgICAgICAgICBzZWxmLl9mb3JtYXQoZW50LCBzdHJlYW0sIGluZGVudCArIF9sZW4ocmVwKSArIDIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGxvd2FuY2UgKyAxLCBjb250ZXh0LCBsZXZlbCkKICAgICAgICAgICAgICAgICAgICBpZiBsZW5ndGggPiAxOgogICAgICAgICAgICAgICAgICAgICAgICBmb3Iga2V5LCBlbnQgaW4gaXRlbXNbMTpdOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwID0gc2VsZi5fcmVwcihrZXksIGNvbnRleHQsIGxldmVsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGUoJyxcbiVzJXM6ICcgJSAoJyAnKmluZGVudCwgcmVwKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2Zvcm1hdChlbnQsIHN0cmVhbSwgaW5kZW50ICsgX2xlbihyZXApICsgMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsb3dhbmNlICsgMSwgY29udGV4dCwgbGV2ZWwpCiAgICAgICAgICAgICAgICAgICAgaW5kZW50ID0gaW5kZW50IC0gc2VsZi5faW5kZW50X3Blcl9sZXZlbAogICAgICAgICAgICAgICAgICAgIGRlbCBjb250ZXh0W29iamlkXQogICAgICAgICAgICAgICAgd3JpdGUoJ30nKQogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICAgICBpZiAoKGlzc3ViY2xhc3ModHlwLCBsaXN0KSBhbmQgciBpcyBsaXN0Ll9fcmVwcl9fKSBvcgogICAgICAgICAgICAgICAgKGlzc3ViY2xhc3ModHlwLCB0dXBsZSkgYW5kIHIgaXMgdHVwbGUuX19yZXByX18pIG9yCiAgICAgICAgICAgICAgICAoaXNzdWJjbGFzcyh0eXAsIHNldCkgYW5kIHIgaXMgc2V0Ll9fcmVwcl9fKSBvcgogICAgICAgICAgICAgICAgKGlzc3ViY2xhc3ModHlwLCBmcm96ZW5zZXQpIGFuZCByIGlzIGZyb3plbnNldC5fX3JlcHJfXykKICAgICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgIGxlbmd0aCA9IF9sZW4ob2JqZWN0KQogICAgICAgICAgICAgICAgaWYgaXNzdWJjbGFzcyh0eXAsIGxpc3QpOgogICAgICAgICAgICAgICAgICAgIHdyaXRlKCdbJykKICAgICAgICAgICAgICAgICAgICBlbmRjaGFyID0gJ10nCiAgICAgICAgICAgICAgICBlbGlmIGlzc3ViY2xhc3ModHlwLCBzZXQpOgogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBsZW5ndGg6CiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlKCdzZXQoKScpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgICAgIHdyaXRlKCd7JykKICAgICAgICAgICAgICAgICAgICBlbmRjaGFyID0gJ30nCiAgICAgICAgICAgICAgICAgICAgb2JqZWN0ID0gc29ydGVkKG9iamVjdCwga2V5PV9zYWZlX2tleSkKICAgICAgICAgICAgICAgIGVsaWYgaXNzdWJjbGFzcyh0eXAsIGZyb3plbnNldCk6CiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGxlbmd0aDoKICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGUoJ2Zyb3plbnNldCgpJykKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgd3JpdGUoJ2Zyb3plbnNldCh7JykKICAgICAgICAgICAgICAgICAgICBlbmRjaGFyID0gJ30pJwogICAgICAgICAgICAgICAgICAgIG9iamVjdCA9IHNvcnRlZChvYmplY3QsIGtleT1fc2FmZV9rZXkpCiAgICAgICAgICAgICAgICAgICAgaW5kZW50ICs9IDEwCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHdyaXRlKCcoJykKICAgICAgICAgICAgICAgICAgICBlbmRjaGFyID0gJyknCiAgICAgICAgICAgICAgICBpZiBzZWxmLl9pbmRlbnRfcGVyX2xldmVsID4gMToKICAgICAgICAgICAgICAgICAgICB3cml0ZSgoc2VsZi5faW5kZW50X3Blcl9sZXZlbCAtIDEpICogJyAnKQogICAgICAgICAgICAgICAgaWYgbGVuZ3RoOgogICAgICAgICAgICAgICAgICAgIGNvbnRleHRbb2JqaWRdID0gMQogICAgICAgICAgICAgICAgICAgIGluZGVudCA9IGluZGVudCArIHNlbGYuX2luZGVudF9wZXJfbGV2ZWwKICAgICAgICAgICAgICAgICAgICBzZWxmLl9mb3JtYXQob2JqZWN0WzBdLCBzdHJlYW0sIGluZGVudCwgYWxsb3dhbmNlICsgMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dCwgbGV2ZWwpCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuZ3RoID4gMToKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGVudCBpbiBvYmplY3RbMTpdOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGUoJyxcbicgKyAnICcqaW5kZW50KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fZm9ybWF0KGVudCwgc3RyZWFtLCBpbmRlbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbG93YW5jZSArIDEsIGNvbnRleHQsIGxldmVsKQogICAgICAgICAgICAgICAgICAgIGluZGVudCA9IGluZGVudCAtIHNlbGYuX2luZGVudF9wZXJfbGV2ZWwKICAgICAgICAgICAgICAgICAgICBkZWwgY29udGV4dFtvYmppZF0KICAgICAgICAgICAgICAgIGlmIGlzc3ViY2xhc3ModHlwLCB0dXBsZSkgYW5kIGxlbmd0aCA9PSAxOgogICAgICAgICAgICAgICAgICAgIHdyaXRlKCcsJykKICAgICAgICAgICAgICAgIHdyaXRlKGVuZGNoYXIpCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgd3JpdGUocmVwKQoKICAgIGRlZiBfcmVwcihzZWxmLCBvYmplY3QsIGNvbnRleHQsIGxldmVsKToKICAgICAgICByZXByLCByZWFkYWJsZSwgcmVjdXJzaXZlID0gc2VsZi5mb3JtYXQob2JqZWN0LCBjb250ZXh0LmNvcHkoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fZGVwdGgsIGxldmVsKQogICAgICAgIGlmIG5vdCByZWFkYWJsZToKICAgICAgICAgICAgc2VsZi5fcmVhZGFibGUgPSBGYWxzZQogICAgICAgIGlmIHJlY3Vyc2l2ZToKICAgICAgICAgICAgc2VsZi5fcmVjdXJzaXZlID0gVHJ1ZQogICAgICAgIHJldHVybiByZXByCgogICAgZGVmIGZvcm1hdChzZWxmLCBvYmplY3QsIGNvbnRleHQsIG1heGxldmVscywgbGV2ZWwpOgogICAgICAgICIiIkZvcm1hdCBvYmplY3QgZm9yIGEgc3BlY2lmaWMgY29udGV4dCwgcmV0dXJuaW5nIGEgc3RyaW5nCiAgICAgICAgYW5kIGZsYWdzIGluZGljYXRpbmcgd2hldGhlciB0aGUgcmVwcmVzZW50YXRpb24gaXMgJ3JlYWRhYmxlJwogICAgICAgIGFuZCB3aGV0aGVyIHRoZSBvYmplY3QgcmVwcmVzZW50cyBhIHJlY3Vyc2l2ZSBjb25zdHJ1Y3QuCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIF9zYWZlX3JlcHIob2JqZWN0LCBjb250ZXh0LCBtYXhsZXZlbHMsIGxldmVsKQoKCiMgUmV0dXJuIHRyaXBsZSAocmVwcl9zdHJpbmcsIGlzcmVhZGFibGUsIGlzcmVjdXJzaXZlKS4KCmRlZiBfc2FmZV9yZXByKG9iamVjdCwgY29udGV4dCwgbWF4bGV2ZWxzLCBsZXZlbCk6CiAgICB0eXAgPSBfdHlwZShvYmplY3QpCiAgICBpZiB0eXAgaXMgc3RyOgogICAgICAgIGlmICdsb2NhbGUnIG5vdCBpbiBfc3lzLm1vZHVsZXM6CiAgICAgICAgICAgIHJldHVybiByZXByKG9iamVjdCksIFRydWUsIEZhbHNlCiAgICAgICAgaWYgIiciIGluIG9iamVjdCBhbmQgJyInIG5vdCBpbiBvYmplY3Q6CiAgICAgICAgICAgIGNsb3N1cmUgPSAnIicKICAgICAgICAgICAgcXVvdGVzID0geyciJzogJ1xcIid9CiAgICAgICAgZWxzZToKICAgICAgICAgICAgY2xvc3VyZSA9ICInIgogICAgICAgICAgICBxdW90ZXMgPSB7IiciOiAiXFwnIn0KICAgICAgICBxZ2V0ID0gcXVvdGVzLmdldAogICAgICAgIHNpbyA9IF9TdHJpbmdJTygpCiAgICAgICAgd3JpdGUgPSBzaW8ud3JpdGUKICAgICAgICBmb3IgY2hhciBpbiBvYmplY3Q6CiAgICAgICAgICAgIGlmIGNoYXIuaXNhbHBoYSgpOgogICAgICAgICAgICAgICAgd3JpdGUoY2hhcikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHdyaXRlKHFnZXQoY2hhciwgcmVwcihjaGFyKVsxOi0xXSkpCiAgICAgICAgcmV0dXJuICgiJXMlcyVzIiAlIChjbG9zdXJlLCBzaW8uZ2V0dmFsdWUoKSwgY2xvc3VyZSkpLCBUcnVlLCBGYWxzZQoKICAgIHIgPSBnZXRhdHRyKHR5cCwgIl9fcmVwcl9fIiwgTm9uZSkKICAgIGlmIGlzc3ViY2xhc3ModHlwLCBkaWN0KSBhbmQgciBpcyBkaWN0Ll9fcmVwcl9fOgogICAgICAgIGlmIG5vdCBvYmplY3Q6CiAgICAgICAgICAgIHJldHVybiAie30iLCBUcnVlLCBGYWxzZQogICAgICAgIG9iamlkID0gX2lkKG9iamVjdCkKICAgICAgICBpZiBtYXhsZXZlbHMgYW5kIGxldmVsID49IG1heGxldmVsczoKICAgICAgICAgICAgcmV0dXJuICJ7Li4ufSIsIEZhbHNlLCBvYmppZCBpbiBjb250ZXh0CiAgICAgICAgaWYgb2JqaWQgaW4gY29udGV4dDoKICAgICAgICAgICAgcmV0dXJuIF9yZWN1cnNpb24ob2JqZWN0KSwgRmFsc2UsIFRydWUKICAgICAgICBjb250ZXh0W29iamlkXSA9IDEKICAgICAgICByZWFkYWJsZSA9IFRydWUKICAgICAgICByZWN1cnNpdmUgPSBGYWxzZQogICAgICAgIGNvbXBvbmVudHMgPSBbXQogICAgICAgIGFwcGVuZCA9IGNvbXBvbmVudHMuYXBwZW5kCiAgICAgICAgbGV2ZWwgKz0gMQogICAgICAgIHNhZmVyZXByID0gX3NhZmVfcmVwcgogICAgICAgIGl0ZW1zID0gc29ydGVkKG9iamVjdC5pdGVtcygpLCBrZXk9X3NhZmVfdHVwbGUpCiAgICAgICAgZm9yIGssIHYgaW4gaXRlbXM6CiAgICAgICAgICAgIGtyZXByLCBrcmVhZGFibGUsIGtyZWN1ciA9IHNhZmVyZXByKGssIGNvbnRleHQsIG1heGxldmVscywgbGV2ZWwpCiAgICAgICAgICAgIHZyZXByLCB2cmVhZGFibGUsIHZyZWN1ciA9IHNhZmVyZXByKHYsIGNvbnRleHQsIG1heGxldmVscywgbGV2ZWwpCiAgICAgICAgICAgIGFwcGVuZCgiJXM6ICVzIiAlIChrcmVwciwgdnJlcHIpKQogICAgICAgICAgICByZWFkYWJsZSA9IHJlYWRhYmxlIGFuZCBrcmVhZGFibGUgYW5kIHZyZWFkYWJsZQogICAgICAgICAgICBpZiBrcmVjdXIgb3IgdnJlY3VyOgogICAgICAgICAgICAgICAgcmVjdXJzaXZlID0gVHJ1ZQogICAgICAgIGRlbCBjb250ZXh0W29iamlkXQogICAgICAgIHJldHVybiAieyVzfSIgJSBfY29tbWFqb2luKGNvbXBvbmVudHMpLCByZWFkYWJsZSwgcmVjdXJzaXZlCgogICAgaWYgKGlzc3ViY2xhc3ModHlwLCBsaXN0KSBhbmQgciBpcyBsaXN0Ll9fcmVwcl9fKSBvciBcCiAgICAgICAoaXNzdWJjbGFzcyh0eXAsIHR1cGxlKSBhbmQgciBpcyB0dXBsZS5fX3JlcHJfXyk6CiAgICAgICAgaWYgaXNzdWJjbGFzcyh0eXAsIGxpc3QpOgogICAgICAgICAgICBpZiBub3Qgb2JqZWN0OgogICAgICAgICAgICAgICAgcmV0dXJuICJbXSIsIFRydWUsIEZhbHNlCiAgICAgICAgICAgIGZvcm1hdCA9ICJbJXNdIgogICAgICAgIGVsaWYgX2xlbihvYmplY3QpID09IDE6CiAgICAgICAgICAgIGZvcm1hdCA9ICIoJXMsKSIKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBub3Qgb2JqZWN0OgogICAgICAgICAgICAgICAgcmV0dXJuICIoKSIsIFRydWUsIEZhbHNlCiAgICAgICAgICAgIGZvcm1hdCA9ICIoJXMpIgogICAgICAgIG9iamlkID0gX2lkKG9iamVjdCkKICAgICAgICBpZiBtYXhsZXZlbHMgYW5kIGxldmVsID49IG1heGxldmVsczoKICAgICAgICAgICAgcmV0dXJuIGZvcm1hdCAlICIuLi4iLCBGYWxzZSwgb2JqaWQgaW4gY29udGV4dAogICAgICAgIGlmIG9iamlkIGluIGNvbnRleHQ6CiAgICAgICAgICAgIHJldHVybiBfcmVjdXJzaW9uKG9iamVjdCksIEZhbHNlLCBUcnVlCiAgICAgICAgY29udGV4dFtvYmppZF0gPSAxCiAgICAgICAgcmVhZGFibGUgPSBUcnVlCiAgICAgICAgcmVjdXJzaXZlID0gRmFsc2UKICAgICAgICBjb21wb25lbnRzID0gW10KICAgICAgICBhcHBlbmQgPSBjb21wb25lbnRzLmFwcGVuZAogICAgICAgIGxldmVsICs9IDEKICAgICAgICBmb3IgbyBpbiBvYmplY3Q6CiAgICAgICAgICAgIG9yZXByLCBvcmVhZGFibGUsIG9yZWN1ciA9IF9zYWZlX3JlcHIobywgY29udGV4dCwgbWF4bGV2ZWxzLCBsZXZlbCkKICAgICAgICAgICAgYXBwZW5kKG9yZXByKQogICAgICAgICAgICBpZiBub3Qgb3JlYWRhYmxlOgogICAgICAgICAgICAgICAgcmVhZGFibGUgPSBGYWxzZQogICAgICAgICAgICBpZiBvcmVjdXI6CiAgICAgICAgICAgICAgICByZWN1cnNpdmUgPSBUcnVlCiAgICAgICAgZGVsIGNvbnRleHRbb2JqaWRdCiAgICAgICAgcmV0dXJuIGZvcm1hdCAlIF9jb21tYWpvaW4oY29tcG9uZW50cyksIHJlYWRhYmxlLCByZWN1cnNpdmUKCiAgICByZXAgPSByZXByKG9iamVjdCkKICAgIHJldHVybiByZXAsIChyZXAgYW5kIG5vdCByZXAuc3RhcnRzd2l0aCgnPCcpKSwgRmFsc2UKCgpkZWYgX3JlY3Vyc2lvbihvYmplY3QpOgogICAgcmV0dXJuICgiPFJlY3Vyc2lvbiBvbiAlcyB3aXRoIGlkPSVzPiIKICAgICAgICAgICAgJSAoX3R5cGUob2JqZWN0KS5fX25hbWVfXywgX2lkKG9iamVjdCkpKQoKCmRlZiBfcGVyZmNoZWNrKG9iamVjdD1Ob25lKToKICAgIGltcG9ydCB0aW1lCiAgICBpZiBvYmplY3QgaXMgTm9uZToKICAgICAgICBvYmplY3QgPSBbKCJzdHJpbmciLCAoMSwgMiksIFszLCA0XSwgezU6IDYsIDc6IDh9KV0gKiAxMDAwMDAKICAgIHAgPSBQcmV0dHlQcmludGVyKCkKICAgIHQxID0gdGltZS50aW1lKCkKICAgIF9zYWZlX3JlcHIob2JqZWN0LCB7fSwgTm9uZSwgMCkKICAgIHQyID0gdGltZS50aW1lKCkKICAgIHAucGZvcm1hdChvYmplY3QpCiAgICB0MyA9IHRpbWUudGltZSgpCiAgICBwcmludCgiX3NhZmVfcmVwcjoiLCB0MiAtIHQxKQogICAgcHJpbnQoInBmb3JtYXQ6IiwgdDMgLSB0MikKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBfcGVyZmNoZWNrKCkK',
'/Lib/random.py':'IiIiUmFuZG9tIHZhcmlhYmxlIGdlbmVyYXRvcnMuCgogICAgaW50ZWdlcnMKICAgIC0tLS0tLS0tCiAgICAgICAgICAgdW5pZm9ybSB3aXRoaW4gcmFuZ2UKCiAgICBzZXF1ZW5jZXMKICAgIC0tLS0tLS0tLQogICAgICAgICAgIHBpY2sgcmFuZG9tIGVsZW1lbnQKICAgICAgICAgICBwaWNrIHJhbmRvbSBzYW1wbGUKICAgICAgICAgICBnZW5lcmF0ZSByYW5kb20gcGVybXV0YXRpb24KCiAgICBkaXN0cmlidXRpb25zIG9uIHRoZSByZWFsIGxpbmU6CiAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAgICB1bmlmb3JtCiAgICAgICAgICAgdHJpYW5ndWxhcgogICAgICAgICAgIG5vcm1hbCAoR2F1c3NpYW4pCiAgICAgICAgICAgbG9nbm9ybWFsCiAgICAgICAgICAgbmVnYXRpdmUgZXhwb25lbnRpYWwKICAgICAgICAgICBnYW1tYQogICAgICAgICAgIGJldGEKICAgICAgICAgICBwYXJldG8KICAgICAgICAgICBXZWlidWxsCgogICAgZGlzdHJpYnV0aW9ucyBvbiB0aGUgY2lyY2xlIChhbmdsZXMgMCB0byAycGkpCiAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAgICBjaXJjdWxhciB1bmlmb3JtCiAgICAgICAgICAgdm9uIE1pc2VzCgpHZW5lcmFsIG5vdGVzIG9uIHRoZSB1bmRlcmx5aW5nIE1lcnNlbm5lIFR3aXN0ZXIgY29yZSBnZW5lcmF0b3I6CgoqIFRoZSBwZXJpb2QgaXMgMioqMTk5MzctMS4KKiBJdCBpcyBvbmUgb2YgdGhlIG1vc3QgZXh0ZW5zaXZlbHkgdGVzdGVkIGdlbmVyYXRvcnMgaW4gZXhpc3RlbmNlLgoqIFRoZSByYW5kb20oKSBtZXRob2QgaXMgaW1wbGVtZW50ZWQgaW4gQywgZXhlY3V0ZXMgaW4gYSBzaW5nbGUgUHl0aG9uIHN0ZXAsCiAgYW5kIGlzLCB0aGVyZWZvcmUsIHRocmVhZHNhZmUuCgoiIiIKCmZyb20gd2FybmluZ3MgaW1wb3J0IHdhcm4gYXMgX3dhcm4KZnJvbSB0eXBlcyBpbXBvcnQgTWV0aG9kVHlwZSBhcyBfTWV0aG9kVHlwZSwgQnVpbHRpbk1ldGhvZFR5cGUgYXMgX0J1aWx0aW5NZXRob2RUeXBlCmZyb20gbWF0aCBpbXBvcnQgbG9nIGFzIF9sb2csIGV4cCBhcyBfZXhwLCBwaSBhcyBfcGksIGUgYXMgX2UsIGNlaWwgYXMgX2NlaWwKZnJvbSBtYXRoIGltcG9ydCBzcXJ0IGFzIF9zcXJ0LCBhY29zIGFzIF9hY29zLCBjb3MgYXMgX2Nvcywgc2luIGFzIF9zaW4KZnJvbSBvcyBpbXBvcnQgdXJhbmRvbSBhcyBfdXJhbmRvbQpmcm9tIGNvbGxlY3Rpb25zIGltcG9ydCBTZXQgYXMgX1NldCwgU2VxdWVuY2UgYXMgX1NlcXVlbmNlCmZyb20gaGFzaGxpYiBpbXBvcnQgc2hhNTEyIGFzIF9zaGE1MTIKCl9fYWxsX18gPSBbIlJhbmRvbSIsInNlZWQiLCJyYW5kb20iLCJ1bmlmb3JtIiwicmFuZGludCIsImNob2ljZSIsInNhbXBsZSIsCiAgICAgICAgICAgInJhbmRyYW5nZSIsInNodWZmbGUiLCJub3JtYWx2YXJpYXRlIiwibG9nbm9ybXZhcmlhdGUiLAogICAgICAgICAgICJleHBvdmFyaWF0ZSIsInZvbm1pc2VzdmFyaWF0ZSIsImdhbW1hdmFyaWF0ZSIsInRyaWFuZ3VsYXIiLAogICAgICAgICAgICJnYXVzcyIsImJldGF2YXJpYXRlIiwicGFyZXRvdmFyaWF0ZSIsIndlaWJ1bGx2YXJpYXRlIiwKICAgICAgICAgICAiZ2V0c3RhdGUiLCJzZXRzdGF0ZSIsICJnZXRyYW5kYml0cyIsCiAgICAgICAgICAgIlN5c3RlbVJhbmRvbSJdCgpOVl9NQUdJQ0NPTlNUID0gNCAqIF9leHAoLTAuNSkvX3NxcnQoMi4wKQpUV09QSSA9IDIuMCpfcGkKTE9HNCA9IF9sb2coNC4wKQpTR19NQUdJQ0NPTlNUID0gMS4wICsgX2xvZyg0LjUpCkJQRiA9IDUzICAgICAgICAjIE51bWJlciBvZiBiaXRzIGluIGEgZmxvYXQKUkVDSVBfQlBGID0gMioqLUJQRgoKCiMgVHJhbnNsYXRlZCBieSBHdWlkbyB2YW4gUm9zc3VtIGZyb20gQyBzb3VyY2UgcHJvdmlkZWQgYnkKIyBBZHJpYW4gQmFkZGVsZXkuICBBZGFwdGVkIGJ5IFJheW1vbmQgSGV0dGluZ2VyIGZvciB1c2Ugd2l0aAojIHRoZSBNZXJzZW5uZSBUd2lzdGVyICBhbmQgb3MudXJhbmRvbSgpIGNvcmUgZ2VuZXJhdG9ycy4KCmltcG9ydCBfcmFuZG9tCgpjbGFzcyBSYW5kb20oX3JhbmRvbS5SYW5kb20pOgogICAgIiIiUmFuZG9tIG51bWJlciBnZW5lcmF0b3IgYmFzZSBjbGFzcyB1c2VkIGJ5IGJvdW5kIG1vZHVsZSBmdW5jdGlvbnMuCgogICAgVXNlZCB0byBpbnN0YW50aWF0ZSBpbnN0YW5jZXMgb2YgUmFuZG9tIHRvIGdldCBnZW5lcmF0b3JzIHRoYXQgZG9uJ3QKICAgIHNoYXJlIHN0YXRlLgoKICAgIENsYXNzIFJhbmRvbSBjYW4gYWxzbyBiZSBzdWJjbGFzc2VkIGlmIHlvdSB3YW50IHRvIHVzZSBhIGRpZmZlcmVudCBiYXNpYwogICAgZ2VuZXJhdG9yIG9mIHlvdXIgb3duIGRldmlzaW5nOiBpbiB0aGF0IGNhc2UsIG92ZXJyaWRlIHRoZSBmb2xsb3dpbmcKICAgIG1ldGhvZHM6ICByYW5kb20oKSwgc2VlZCgpLCBnZXRzdGF0ZSgpLCBhbmQgc2V0c3RhdGUoKS4KICAgIE9wdGlvbmFsbHksIGltcGxlbWVudCBhIGdldHJhbmRiaXRzKCkgbWV0aG9kIHNvIHRoYXQgcmFuZHJhbmdlKCkKICAgIGNhbiBjb3ZlciBhcmJpdHJhcmlseSBsYXJnZSByYW5nZXMuCgogICAgIiIiCgogICAgVkVSU0lPTiA9IDMgICAgICMgdXNlZCBieSBnZXRzdGF0ZS9zZXRzdGF0ZQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB4PU5vbmUpOgogICAgICAgICIiIkluaXRpYWxpemUgYW4gaW5zdGFuY2UuCgogICAgICAgIE9wdGlvbmFsIGFyZ3VtZW50IHggY29udHJvbHMgc2VlZGluZywgYXMgZm9yIFJhbmRvbS5zZWVkKCkuCiAgICAgICAgIiIiCgogICAgICAgIHNlbGYuc2VlZCh4KQogICAgICAgIHNlbGYuZ2F1c3NfbmV4dCA9IE5vbmUKCiAgICBkZWYgc2VlZChzZWxmLCBhPU5vbmUsIHZlcnNpb249Mik6CiAgICAgICAgIiIiSW5pdGlhbGl6ZSBpbnRlcm5hbCBzdGF0ZSBmcm9tIGhhc2hhYmxlIG9iamVjdC4KCiAgICAgICAgTm9uZSBvciBubyBhcmd1bWVudCBzZWVkcyBmcm9tIGN1cnJlbnQgdGltZSBvciBmcm9tIGFuIG9wZXJhdGluZwogICAgICAgIHN5c3RlbSBzcGVjaWZpYyByYW5kb21uZXNzIHNvdXJjZSBpZiBhdmFpbGFibGUuCgogICAgICAgIEZvciB2ZXJzaW9uIDIgKHRoZSBkZWZhdWx0KSwgYWxsIG9mIHRoZSBiaXRzIGFyZSB1c2VkIGlmICphKiBpcyBhIHN0ciwKICAgICAgICBieXRlcywgb3IgYnl0ZWFycmF5LiAgRm9yIHZlcnNpb24gMSwgdGhlIGhhc2goKSBvZiAqYSogaXMgdXNlZCBpbnN0ZWFkLgoKICAgICAgICBJZiAqYSogaXMgYW4gaW50LCBhbGwgYml0cyBhcmUgdXNlZC4KCiAgICAgICAgIiIiCgogICAgICAgIGlmIGEgaXMgTm9uZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgYSA9IGludC5mcm9tX2J5dGVzKF91cmFuZG9tKDMyKSwgJ2JpZycpCiAgICAgICAgICAgIGV4Y2VwdCBOb3RJbXBsZW1lbnRlZEVycm9yOgogICAgICAgICAgICAgICAgaW1wb3J0IHRpbWUKICAgICAgICAgICAgICAgIGEgPSBpbnQodGltZS50aW1lKCkgKiAyNTYpICMgdXNlIGZyYWN0aW9uYWwgc2Vjb25kcwoKICAgICAgICBpZiB2ZXJzaW9uID09IDI6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoYSwgKHN0ciwgYnl0ZXMsIGJ5dGVhcnJheSkpOgogICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShhLCBzdHIpOgogICAgICAgICAgICAgICAgICAgIGEgPSBhLmVuY29kZSgpCiAgICAgICAgICAgICAgICBhICs9IF9zaGE1MTIoYSkuZGlnZXN0KCkKICAgICAgICAgICAgICAgIGEgPSBpbnQuZnJvbV9ieXRlcyhhLCAnYmlnJykKCiAgICAgICAgI2ZpeG1lIGJyeXRob24KICAgICAgICAjc3VwZXIoKS5zZWVkKGEpCiAgICAgICAgX3JhbmRvbS5SYW5kb20uc2VlZChzZWxmLCBhKQogICAgICAgIHNlbGYuZ2F1c3NfbmV4dCA9IE5vbmUKCiAgICBkZWYgZ2V0c3RhdGUoc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIGludGVybmFsIHN0YXRlOyBjYW4gYmUgcGFzc2VkIHRvIHNldHN0YXRlKCkgbGF0ZXIuIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuVkVSU0lPTiwgc3VwZXIoKS5nZXRzdGF0ZSgpLCBzZWxmLmdhdXNzX25leHQKCiAgICBkZWYgc2V0c3RhdGUoc2VsZiwgc3RhdGUpOgogICAgICAgICIiIlJlc3RvcmUgaW50ZXJuYWwgc3RhdGUgZnJvbSBvYmplY3QgcmV0dXJuZWQgYnkgZ2V0c3RhdGUoKS4iIiIKICAgICAgICB2ZXJzaW9uID0gc3RhdGVbMF0KICAgICAgICBpZiB2ZXJzaW9uID09IDM6CiAgICAgICAgICAgIHZlcnNpb24sIGludGVybmFsc3RhdGUsIHNlbGYuZ2F1c3NfbmV4dCA9IHN0YXRlCiAgICAgICAgICAgIHN1cGVyKCkuc2V0c3RhdGUoaW50ZXJuYWxzdGF0ZSkKICAgICAgICBlbGlmIHZlcnNpb24gPT0gMjoKICAgICAgICAgICAgdmVyc2lvbiwgaW50ZXJuYWxzdGF0ZSwgc2VsZi5nYXVzc19uZXh0ID0gc3RhdGUKICAgICAgICAgICAgIyBJbiB2ZXJzaW9uIDIsIHRoZSBzdGF0ZSB3YXMgc2F2ZWQgYXMgc2lnbmVkIGludHMsIHdoaWNoIGNhdXNlcwogICAgICAgICAgICAjICAgaW5jb25zaXN0ZW5jaWVzIGJldHdlZW4gMzIvNjQtYml0IHN5c3RlbXMuIFRoZSBzdGF0ZSBpcwogICAgICAgICAgICAjICAgcmVhbGx5IHVuc2lnbmVkIDMyLWJpdCBpbnRzLCBzbyB3ZSBjb252ZXJ0IG5lZ2F0aXZlIGludHMgZnJvbQogICAgICAgICAgICAjICAgdmVyc2lvbiAyIHRvIHBvc2l0aXZlIGxvbmdzIGZvciB2ZXJzaW9uIDMuCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGludGVybmFsc3RhdGUgPSB0dXBsZSh4ICUgKDIqKjMyKSBmb3IgeCBpbiBpbnRlcm5hbHN0YXRlKQogICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvciBhcyBlOgogICAgICAgICAgICAgICAgI2ZpeG1lIGJyeXRob24KICAgICAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcihlKQogICAgICAgICAgICAgICAgI3JhaXNlIFR5cGVFcnJvciBmcm9tIGUKICAgICAgICAgICAgc3VwZXIoKS5zZXRzdGF0ZShpbnRlcm5hbHN0YXRlKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoInN0YXRlIHdpdGggdmVyc2lvbiAlcyBwYXNzZWQgdG8gIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJSYW5kb20uc2V0c3RhdGUoKSBvZiB2ZXJzaW9uICVzIiAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZlcnNpb24sIHNlbGYuVkVSU0lPTikpCgojIyAtLS0tIE1ldGhvZHMgYmVsb3cgdGhpcyBwb2ludCBkbyBub3QgbmVlZCB0byBiZSBvdmVycmlkZGVuIHdoZW4KIyMgLS0tLSBzdWJjbGFzc2luZyBmb3IgdGhlIHB1cnBvc2Ugb2YgdXNpbmcgYSBkaWZmZXJlbnQgY29yZSBnZW5lcmF0b3IuCgojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLSBwaWNrbGUgc3VwcG9ydCAgLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIGRlZiBfX2dldHN0YXRlX18oc2VsZik6ICMgZm9yIHBpY2tsZQogICAgICAgIHJldHVybiBzZWxmLmdldHN0YXRlKCkKCiAgICBkZWYgX19zZXRzdGF0ZV9fKHNlbGYsIHN0YXRlKTogICMgZm9yIHBpY2tsZQogICAgICAgIHNlbGYuc2V0c3RhdGUoc3RhdGUpCgogICAgZGVmIF9fcmVkdWNlX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fLCAoKSwgc2VsZi5nZXRzdGF0ZSgpCgojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLSBpbnRlZ2VyIG1ldGhvZHMgIC0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgcmFuZHJhbmdlKHNlbGYsIHN0YXJ0LCBzdG9wPU5vbmUsIHN0ZXA9MSwgaW50PWludCk6CiAgICAgICAgIiIiQ2hvb3NlIGEgcmFuZG9tIGl0ZW0gZnJvbSByYW5nZShzdGFydCwgc3RvcFssIHN0ZXBdKS4KCiAgICAgICAgVGhpcyBmaXhlcyB0aGUgcHJvYmxlbSB3aXRoIHJhbmRpbnQoKSB3aGljaCBpbmNsdWRlcyB0aGUKICAgICAgICBlbmRwb2ludDsgaW4gUHl0aG9uIHRoaXMgaXMgdXN1YWxseSBub3Qgd2hhdCB5b3Ugd2FudC4KCiAgICAgICAgRG8gbm90IHN1cHBseSB0aGUgJ2ludCcgYXJndW1lbnQuCiAgICAgICAgIiIiCgogICAgICAgICMgVGhpcyBjb2RlIGlzIGEgYml0IG1lc3N5IHRvIG1ha2UgaXQgZmFzdCBmb3IgdGhlCiAgICAgICAgIyBjb21tb24gY2FzZSB3aGlsZSBzdGlsbCBkb2luZyBhZGVxdWF0ZSBlcnJvciBjaGVja2luZy4KICAgICAgICBpc3RhcnQgPSBpbnQoc3RhcnQpCiAgICAgICAgaWYgaXN0YXJ0ICE9IHN0YXJ0OgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJub24taW50ZWdlciBhcmcgMSBmb3IgcmFuZHJhbmdlKCkiKQogICAgICAgIGlmIHN0b3AgaXMgTm9uZToKICAgICAgICAgICAgaWYgaXN0YXJ0ID4gMDoKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLl9yYW5kYmVsb3coaXN0YXJ0KQogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJlbXB0eSByYW5nZSBmb3IgcmFuZHJhbmdlKCkiKQoKICAgICAgICAjIHN0b3AgYXJndW1lbnQgc3VwcGxpZWQuCiAgICAgICAgaXN0b3AgPSBpbnQoc3RvcCkKICAgICAgICBpZiBpc3RvcCAhPSBzdG9wOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJub24taW50ZWdlciBzdG9wIGZvciByYW5kcmFuZ2UoKSIpCiAgICAgICAgd2lkdGggPSBpc3RvcCAtIGlzdGFydAogICAgICAgIGlmIHN0ZXAgPT0gMSBhbmQgd2lkdGggPiAwOgogICAgICAgICAgICByZXR1cm4gaXN0YXJ0ICsgc2VsZi5fcmFuZGJlbG93KHdpZHRoKQogICAgICAgIGlmIHN0ZXAgPT0gMToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiZW1wdHkgcmFuZ2UgZm9yIHJhbmRyYW5nZSgpICglZCwlZCwgJWQpIiAlIChpc3RhcnQsIGlzdG9wLCB3aWR0aCkpCgogICAgICAgICMgTm9uLXVuaXQgc3RlcCBhcmd1bWVudCBzdXBwbGllZC4KICAgICAgICBpc3RlcCA9IGludChzdGVwKQogICAgICAgIGlmIGlzdGVwICE9IHN0ZXA6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIm5vbi1pbnRlZ2VyIHN0ZXAgZm9yIHJhbmRyYW5nZSgpIikKICAgICAgICBpZiBpc3RlcCA+IDA6CiAgICAgICAgICAgIG4gPSAod2lkdGggKyBpc3RlcCAtIDEpIC8vIGlzdGVwCiAgICAgICAgZWxpZiBpc3RlcCA8IDA6CiAgICAgICAgICAgIG4gPSAod2lkdGggKyBpc3RlcCArIDEpIC8vIGlzdGVwCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiemVybyBzdGVwIGZvciByYW5kcmFuZ2UoKSIpCgogICAgICAgIGlmIG4gPD0gMDoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiZW1wdHkgcmFuZ2UgZm9yIHJhbmRyYW5nZSgpIikKCiAgICAgICAgcmV0dXJuIGlzdGFydCArIGlzdGVwKnNlbGYuX3JhbmRiZWxvdyhuKQoKICAgIGRlZiByYW5kaW50KHNlbGYsIGEsIGIpOgogICAgICAgICIiIlJldHVybiByYW5kb20gaW50ZWdlciBpbiByYW5nZSBbYSwgYl0sIGluY2x1ZGluZyBib3RoIGVuZCBwb2ludHMuCiAgICAgICAgIiIiCgogICAgICAgIHJldHVybiBzZWxmLnJhbmRyYW5nZShhLCBiKzEpCgogICAgZGVmIF9yYW5kYmVsb3coc2VsZiwgbiwgaW50PWludCwgbWF4c2l6ZT0xPDxCUEYsIHR5cGU9dHlwZSwKICAgICAgICAgICAgICAgICAgIE1ldGhvZD1fTWV0aG9kVHlwZSwgQnVpbHRpbk1ldGhvZD1fQnVpbHRpbk1ldGhvZFR5cGUpOgogICAgICAgICJSZXR1cm4gYSByYW5kb20gaW50IGluIHRoZSByYW5nZSBbMCxuKS4gIFJhaXNlcyBWYWx1ZUVycm9yIGlmIG49PTAuIgoKICAgICAgICBnZXRyYW5kYml0cyA9IHNlbGYuZ2V0cmFuZGJpdHMKICAgICAgICAjIE9ubHkgY2FsbCBzZWxmLmdldHJhbmRiaXRzIGlmIHRoZSBvcmlnaW5hbCByYW5kb20oKSBidWlsdGluIG1ldGhvZAogICAgICAgICMgaGFzIG5vdCBiZWVuIG92ZXJyaWRkZW4gb3IgaWYgYSBuZXcgZ2V0cmFuZGJpdHMoKSB3YXMgc3VwcGxpZWQuCiAgICAgICAgaWYgdHlwZShzZWxmLnJhbmRvbSkgaXMgQnVpbHRpbk1ldGhvZCBvciB0eXBlKGdldHJhbmRiaXRzKSBpcyBNZXRob2Q6CiAgICAgICAgICAgIGsgPSBuLmJpdF9sZW5ndGgoKSAgIyBkb24ndCB1c2UgKG4tMSkgaGVyZSBiZWNhdXNlIG4gY2FuIGJlIDEKICAgICAgICAgICAgciA9IGdldHJhbmRiaXRzKGspICAgICAgICAgICMgMCA8PSByIDwgMioqawogICAgICAgICAgICB3aGlsZSByID49IG46CiAgICAgICAgICAgICAgICByID0gZ2V0cmFuZGJpdHMoaykKICAgICAgICAgICAgcmV0dXJuIHIKICAgICAgICAjIFRoZXJlJ3MgYW4gb3ZlcnJpZGVuIHJhbmRvbSgpIG1ldGhvZCBidXQgbm8gbmV3IGdldHJhbmRiaXRzKCkgbWV0aG9kLAogICAgICAgICMgc28gd2UgY2FuIG9ubHkgdXNlIHJhbmRvbSgpIGZyb20gaGVyZS4KICAgICAgICByYW5kb20gPSBzZWxmLnJhbmRvbQogICAgICAgIGlmIG4gPj0gbWF4c2l6ZToKICAgICAgICAgICAgX3dhcm4oIlVuZGVybHlpbmcgcmFuZG9tKCkgZ2VuZXJhdG9yIGRvZXMgbm90IHN1cHBseSBcbiIKICAgICAgICAgICAgICAgICJlbm91Z2ggYml0cyB0byBjaG9vc2UgZnJvbSBhIHBvcHVsYXRpb24gcmFuZ2UgdGhpcyBsYXJnZS5cbiIKICAgICAgICAgICAgICAgICJUbyByZW1vdmUgdGhlIHJhbmdlIGxpbWl0YXRpb24sIGFkZCBhIGdldHJhbmRiaXRzKCkgbWV0aG9kLiIpCiAgICAgICAgICAgIHJldHVybiBpbnQocmFuZG9tKCkgKiBuKQogICAgICAgIHJlbSA9IG1heHNpemUgJSBuCiAgICAgICAgbGltaXQgPSAobWF4c2l6ZSAtIHJlbSkgLyBtYXhzaXplICAgIyBpbnQobGltaXQgKiBtYXhzaXplKSAlIG4gPT0gMAogICAgICAgIHIgPSByYW5kb20oKQogICAgICAgIHdoaWxlIHIgPj0gbGltaXQ6CiAgICAgICAgICAgIHIgPSByYW5kb20oKQogICAgICAgIHJldHVybiBpbnQociptYXhzaXplKSAlIG4KCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tIHNlcXVlbmNlIG1ldGhvZHMgIC0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgY2hvaWNlKHNlbGYsIHNlcSk6CiAgICAgICAgIiIiQ2hvb3NlIGEgcmFuZG9tIGVsZW1lbnQgZnJvbSBhIG5vbi1lbXB0eSBzZXF1ZW5jZS4iIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgIGkgPSBzZWxmLl9yYW5kYmVsb3cobGVuKHNlcSkpCiAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgIHJhaXNlIEluZGV4RXJyb3IoJ0Nhbm5vdCBjaG9vc2UgZnJvbSBhbiBlbXB0eSBzZXF1ZW5jZScpCiAgICAgICAgcmV0dXJuIHNlcVtpXQoKICAgIGRlZiBzaHVmZmxlKHNlbGYsIHgsIHJhbmRvbT1Ob25lLCBpbnQ9aW50KToKICAgICAgICAiIiJ4LCByYW5kb209cmFuZG9tLnJhbmRvbSAtPiBzaHVmZmxlIGxpc3QgeCBpbiBwbGFjZTsgcmV0dXJuIE5vbmUuCgogICAgICAgIE9wdGlvbmFsIGFyZyByYW5kb20gaXMgYSAwLWFyZ3VtZW50IGZ1bmN0aW9uIHJldHVybmluZyBhIHJhbmRvbQogICAgICAgIGZsb2F0IGluIFswLjAsIDEuMCk7IGJ5IGRlZmF1bHQsIHRoZSBzdGFuZGFyZCByYW5kb20ucmFuZG9tLgogICAgICAgICIiIgoKICAgICAgICByYW5kYmVsb3cgPSBzZWxmLl9yYW5kYmVsb3cKICAgICAgICBmb3IgaSBpbiByZXZlcnNlZChyYW5nZSgxLCBsZW4oeCkpKToKICAgICAgICAgICAgIyBwaWNrIGFuIGVsZW1lbnQgaW4geFs6aSsxXSB3aXRoIHdoaWNoIHRvIGV4Y2hhbmdlIHhbaV0KICAgICAgICAgICAgaiA9IHJhbmRiZWxvdyhpKzEpIGlmIHJhbmRvbSBpcyBOb25lIGVsc2UgaW50KHJhbmRvbSgpICogKGkrMSkpCiAgICAgICAgICAgIHhbaV0sIHhbal0gPSB4W2pdLCB4W2ldCgogICAgZGVmIHNhbXBsZShzZWxmLCBwb3B1bGF0aW9uLCBrKToKICAgICAgICAiIiJDaG9vc2VzIGsgdW5pcXVlIHJhbmRvbSBlbGVtZW50cyBmcm9tIGEgcG9wdWxhdGlvbiBzZXF1ZW5jZSBvciBzZXQuCgogICAgICAgIFJldHVybnMgYSBuZXcgbGlzdCBjb250YWluaW5nIGVsZW1lbnRzIGZyb20gdGhlIHBvcHVsYXRpb24gd2hpbGUKICAgICAgICBsZWF2aW5nIHRoZSBvcmlnaW5hbCBwb3B1bGF0aW9uIHVuY2hhbmdlZC4gIFRoZSByZXN1bHRpbmcgbGlzdCBpcwogICAgICAgIGluIHNlbGVjdGlvbiBvcmRlciBzbyB0aGF0IGFsbCBzdWItc2xpY2VzIHdpbGwgYWxzbyBiZSB2YWxpZCByYW5kb20KICAgICAgICBzYW1wbGVzLiAgVGhpcyBhbGxvd3MgcmFmZmxlIHdpbm5lcnMgKHRoZSBzYW1wbGUpIHRvIGJlIHBhcnRpdGlvbmVkCiAgICAgICAgaW50byBncmFuZCBwcml6ZSBhbmQgc2Vjb25kIHBsYWNlIHdpbm5lcnMgKHRoZSBzdWJzbGljZXMpLgoKICAgICAgICBNZW1iZXJzIG9mIHRoZSBwb3B1bGF0aW9uIG5lZWQgbm90IGJlIGhhc2hhYmxlIG9yIHVuaXF1ZS4gIElmIHRoZQogICAgICAgIHBvcHVsYXRpb24gY29udGFpbnMgcmVwZWF0cywgdGhlbiBlYWNoIG9jY3VycmVuY2UgaXMgYSBwb3NzaWJsZQogICAgICAgIHNlbGVjdGlvbiBpbiB0aGUgc2FtcGxlLgoKICAgICAgICBUbyBjaG9vc2UgYSBzYW1wbGUgaW4gYSByYW5nZSBvZiBpbnRlZ2VycywgdXNlIHJhbmdlIGFzIGFuIGFyZ3VtZW50LgogICAgICAgIFRoaXMgaXMgZXNwZWNpYWxseSBmYXN0IGFuZCBzcGFjZSBlZmZpY2llbnQgZm9yIHNhbXBsaW5nIGZyb20gYQogICAgICAgIGxhcmdlIHBvcHVsYXRpb246ICAgc2FtcGxlKHJhbmdlKDEwMDAwMDAwKSwgNjApCiAgICAgICAgIiIiCgogICAgICAgICMgU2FtcGxpbmcgd2l0aG91dCByZXBsYWNlbWVudCBlbnRhaWxzIHRyYWNraW5nIGVpdGhlciBwb3RlbnRpYWwKICAgICAgICAjIHNlbGVjdGlvbnMgKHRoZSBwb29sKSBpbiBhIGxpc3Qgb3IgcHJldmlvdXMgc2VsZWN0aW9ucyBpbiBhIHNldC4KCiAgICAgICAgIyBXaGVuIHRoZSBudW1iZXIgb2Ygc2VsZWN0aW9ucyBpcyBzbWFsbCBjb21wYXJlZCB0byB0aGUKICAgICAgICAjIHBvcHVsYXRpb24sIHRoZW4gdHJhY2tpbmcgc2VsZWN0aW9ucyBpcyBlZmZpY2llbnQsIHJlcXVpcmluZwogICAgICAgICMgb25seSBhIHNtYWxsIHNldCBhbmQgYW4gb2NjYXNpb25hbCByZXNlbGVjdGlvbi4gIEZvcgogICAgICAgICMgYSBsYXJnZXIgbnVtYmVyIG9mIHNlbGVjdGlvbnMsIHRoZSBwb29sIHRyYWNraW5nIG1ldGhvZCBpcwogICAgICAgICMgcHJlZmVycmVkIHNpbmNlIHRoZSBsaXN0IHRha2VzIGxlc3Mgc3BhY2UgdGhhbiB0aGUKICAgICAgICAjIHNldCBhbmQgaXQgZG9lc24ndCBzdWZmZXIgZnJvbSBmcmVxdWVudCByZXNlbGVjdGlvbnMuCgogICAgICAgIGlmIGlzaW5zdGFuY2UocG9wdWxhdGlvbiwgX1NldCk6CiAgICAgICAgICAgIHBvcHVsYXRpb24gPSB0dXBsZShwb3B1bGF0aW9uKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHBvcHVsYXRpb24sIF9TZXF1ZW5jZSk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiUG9wdWxhdGlvbiBtdXN0IGJlIGEgc2VxdWVuY2Ugb3Igc2V0LiAgRm9yIGRpY3RzLCB1c2UgbGlzdChkKS4iKQogICAgICAgIHJhbmRiZWxvdyA9IHNlbGYuX3JhbmRiZWxvdwogICAgICAgIG4gPSBsZW4ocG9wdWxhdGlvbikKICAgICAgICBpZiBub3QgMCA8PSBrIDw9IG46CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIlNhbXBsZSBsYXJnZXIgdGhhbiBwb3B1bGF0aW9uIikKICAgICAgICByZXN1bHQgPSBbTm9uZV0gKiBrCiAgICAgICAgc2V0c2l6ZSA9IDIxICAgICAgICAjIHNpemUgb2YgYSBzbWFsbCBzZXQgbWludXMgc2l6ZSBvZiBhbiBlbXB0eSBsaXN0CiAgICAgICAgaWYgayA+IDU6CiAgICAgICAgICAgIHNldHNpemUgKz0gNCAqKiBfY2VpbChfbG9nKGsgKiAzLCA0KSkgIyB0YWJsZSBzaXplIGZvciBiaWcgc2V0cwogICAgICAgIGlmIG4gPD0gc2V0c2l6ZToKICAgICAgICAgICAgIyBBbiBuLWxlbmd0aCBsaXN0IGlzIHNtYWxsZXIgdGhhbiBhIGstbGVuZ3RoIHNldAogICAgICAgICAgICBwb29sID0gbGlzdChwb3B1bGF0aW9uKQogICAgICAgICAgICBmb3IgaSBpbiByYW5nZShrKTogICAgICAgICAjIGludmFyaWFudDogIG5vbi1zZWxlY3RlZCBhdCBbMCxuLWkpCiAgICAgICAgICAgICAgICBqID0gcmFuZGJlbG93KG4taSkKICAgICAgICAgICAgICAgIHJlc3VsdFtpXSA9IHBvb2xbal0KICAgICAgICAgICAgICAgIHBvb2xbal0gPSBwb29sW24taS0xXSAgICMgbW92ZSBub24tc2VsZWN0ZWQgaXRlbSBpbnRvIHZhY2FuY3kKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxlY3RlZCA9IHNldCgpCiAgICAgICAgICAgIHNlbGVjdGVkX2FkZCA9IHNlbGVjdGVkLmFkZAogICAgICAgICAgICBmb3IgaSBpbiByYW5nZShrKToKICAgICAgICAgICAgICAgIGogPSByYW5kYmVsb3cobikKICAgICAgICAgICAgICAgIHdoaWxlIGogaW4gc2VsZWN0ZWQ6CiAgICAgICAgICAgICAgICAgICAgaiA9IHJhbmRiZWxvdyhuKQogICAgICAgICAgICAgICAgc2VsZWN0ZWRfYWRkKGopCiAgICAgICAgICAgICAgICByZXN1bHRbaV0gPSBwb3B1bGF0aW9uW2pdCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKIyMgLS0tLS0tLS0tLS0tLS0tLS0tLS0gcmVhbC12YWx1ZWQgZGlzdHJpYnV0aW9ucyAgLS0tLS0tLS0tLS0tLS0tLS0tLQoKIyMgLS0tLS0tLS0tLS0tLS0tLS0tLS0gdW5pZm9ybSBkaXN0cmlidXRpb24gLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIGRlZiB1bmlmb3JtKHNlbGYsIGEsIGIpOgogICAgICAgICJHZXQgYSByYW5kb20gbnVtYmVyIGluIHRoZSByYW5nZSBbYSwgYikgb3IgW2EsIGJdIGRlcGVuZGluZyBvbiByb3VuZGluZy4iCiAgICAgICAgcmV0dXJuIGEgKyAoYi1hKSAqIHNlbGYucmFuZG9tKCkKCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tIHRyaWFuZ3VsYXIgLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgdHJpYW5ndWxhcihzZWxmLCBsb3c9MC4wLCBoaWdoPTEuMCwgbW9kZT1Ob25lKToKICAgICAgICAiIiJUcmlhbmd1bGFyIGRpc3RyaWJ1dGlvbi4KCiAgICAgICAgQ29udGludW91cyBkaXN0cmlidXRpb24gYm91bmRlZCBieSBnaXZlbiBsb3dlciBhbmQgdXBwZXIgbGltaXRzLAogICAgICAgIGFuZCBoYXZpbmcgYSBnaXZlbiBtb2RlIHZhbHVlIGluLWJldHdlZW4uCgogICAgICAgIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvVHJpYW5ndWxhcl9kaXN0cmlidXRpb24KCiAgICAgICAgIiIiCiAgICAgICAgdSA9IHNlbGYucmFuZG9tKCkKICAgICAgICBjID0gMC41IGlmIG1vZGUgaXMgTm9uZSBlbHNlIChtb2RlIC0gbG93KSAvIChoaWdoIC0gbG93KQogICAgICAgIGlmIHUgPiBjOgogICAgICAgICAgICB1ID0gMS4wIC0gdQogICAgICAgICAgICBjID0gMS4wIC0gYwogICAgICAgICAgICBsb3csIGhpZ2ggPSBoaWdoLCBsb3cKICAgICAgICByZXR1cm4gbG93ICsgKGhpZ2ggLSBsb3cpICogKHUgKiBjKSAqKiAwLjUKCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tIG5vcm1hbCBkaXN0cmlidXRpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgbm9ybWFsdmFyaWF0ZShzZWxmLCBtdSwgc2lnbWEpOgogICAgICAgICIiIk5vcm1hbCBkaXN0cmlidXRpb24uCgogICAgICAgIG11IGlzIHRoZSBtZWFuLCBhbmQgc2lnbWEgaXMgdGhlIHN0YW5kYXJkIGRldmlhdGlvbi4KCiAgICAgICAgIiIiCiAgICAgICAgIyBtdSA9IG1lYW4sIHNpZ21hID0gc3RhbmRhcmQgZGV2aWF0aW9uCgogICAgICAgICMgVXNlcyBLaW5kZXJtYW4gYW5kIE1vbmFoYW4gbWV0aG9kLiBSZWZlcmVuY2U6IEtpbmRlcm1hbiwKICAgICAgICAjIEEuSi4gYW5kIE1vbmFoYW4sIEouRi4sICJDb21wdXRlciBnZW5lcmF0aW9uIG9mIHJhbmRvbQogICAgICAgICMgdmFyaWFibGVzIHVzaW5nIHRoZSByYXRpbyBvZiB1bmlmb3JtIGRldmlhdGVzIiwgQUNNIFRyYW5zCiAgICAgICAgIyBNYXRoIFNvZnR3YXJlLCAzLCAoMTk3NyksIHBwMjU3LTI2MC4KCiAgICAgICAgcmFuZG9tID0gc2VsZi5yYW5kb20KICAgICAgICB3aGlsZSAxOgogICAgICAgICAgICB1MSA9IHJhbmRvbSgpCiAgICAgICAgICAgIHUyID0gMS4wIC0gcmFuZG9tKCkKICAgICAgICAgICAgeiA9IE5WX01BR0lDQ09OU1QqKHUxLTAuNSkvdTIKICAgICAgICAgICAgenogPSB6KnovNC4wCiAgICAgICAgICAgIGlmIHp6IDw9IC1fbG9nKHUyKToKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgcmV0dXJuIG11ICsgeipzaWdtYQoKIyMgLS0tLS0tLS0tLS0tLS0tLS0tLS0gbG9nbm9ybWFsIGRpc3RyaWJ1dGlvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIGRlZiBsb2dub3JtdmFyaWF0ZShzZWxmLCBtdSwgc2lnbWEpOgogICAgICAgICIiIkxvZyBub3JtYWwgZGlzdHJpYnV0aW9uLgoKICAgICAgICBJZiB5b3UgdGFrZSB0aGUgbmF0dXJhbCBsb2dhcml0aG0gb2YgdGhpcyBkaXN0cmlidXRpb24sIHlvdSdsbCBnZXQgYQogICAgICAgIG5vcm1hbCBkaXN0cmlidXRpb24gd2l0aCBtZWFuIG11IGFuZCBzdGFuZGFyZCBkZXZpYXRpb24gc2lnbWEuCiAgICAgICAgbXUgY2FuIGhhdmUgYW55IHZhbHVlLCBhbmQgc2lnbWEgbXVzdCBiZSBncmVhdGVyIHRoYW4gemVyby4KCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIF9leHAoc2VsZi5ub3JtYWx2YXJpYXRlKG11LCBzaWdtYSkpCgojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLSBleHBvbmVudGlhbCBkaXN0cmlidXRpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgZXhwb3ZhcmlhdGUoc2VsZiwgbGFtYmQpOgogICAgICAgICIiIkV4cG9uZW50aWFsIGRpc3RyaWJ1dGlvbi4KCiAgICAgICAgbGFtYmQgaXMgMS4wIGRpdmlkZWQgYnkgdGhlIGRlc2lyZWQgbWVhbi4gIEl0IHNob3VsZCBiZQogICAgICAgIG5vbnplcm8uICAoVGhlIHBhcmFtZXRlciB3b3VsZCBiZSBjYWxsZWQgImxhbWJkYSIsIGJ1dCB0aGF0IGlzCiAgICAgICAgYSByZXNlcnZlZCB3b3JkIGluIFB5dGhvbi4pICBSZXR1cm5lZCB2YWx1ZXMgcmFuZ2UgZnJvbSAwIHRvCiAgICAgICAgcG9zaXRpdmUgaW5maW5pdHkgaWYgbGFtYmQgaXMgcG9zaXRpdmUsIGFuZCBmcm9tIG5lZ2F0aXZlCiAgICAgICAgaW5maW5pdHkgdG8gMCBpZiBsYW1iZCBpcyBuZWdhdGl2ZS4KCiAgICAgICAgIiIiCiAgICAgICAgIyBsYW1iZDogcmF0ZSBsYW1iZCA9IDEvbWVhbgogICAgICAgICMgKCdsYW1iZGEnIGlzIGEgUHl0aG9uIHJlc2VydmVkIHdvcmQpCgogICAgICAgICMgd2UgdXNlIDEtcmFuZG9tKCkgaW5zdGVhZCBvZiByYW5kb20oKSB0byBwcmVjbHVkZSB0aGUKICAgICAgICAjIHBvc3NpYmlsaXR5IG9mIHRha2luZyB0aGUgbG9nIG9mIHplcm8uCiAgICAgICAgcmV0dXJuIC1fbG9nKDEuMCAtIHNlbGYucmFuZG9tKCkpL2xhbWJkCgojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLSB2b24gTWlzZXMgZGlzdHJpYnV0aW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgZGVmIHZvbm1pc2VzdmFyaWF0ZShzZWxmLCBtdSwga2FwcGEpOgogICAgICAgICIiIkNpcmN1bGFyIGRhdGEgZGlzdHJpYnV0aW9uLgoKICAgICAgICBtdSBpcyB0aGUgbWVhbiBhbmdsZSwgZXhwcmVzc2VkIGluIHJhZGlhbnMgYmV0d2VlbiAwIGFuZCAyKnBpLCBhbmQKICAgICAgICBrYXBwYSBpcyB0aGUgY29uY2VudHJhdGlvbiBwYXJhbWV0ZXIsIHdoaWNoIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yCiAgICAgICAgZXF1YWwgdG8gemVyby4gIElmIGthcHBhIGlzIGVxdWFsIHRvIHplcm8sIHRoaXMgZGlzdHJpYnV0aW9uIHJlZHVjZXMKICAgICAgICB0byBhIHVuaWZvcm0gcmFuZG9tIGFuZ2xlIG92ZXIgdGhlIHJhbmdlIDAgdG8gMipwaS4KCiAgICAgICAgIiIiCiAgICAgICAgIyBtdTogICAgbWVhbiBhbmdsZSAoaW4gcmFkaWFucyBiZXR3ZWVuIDAgYW5kIDIqcGkpCiAgICAgICAgIyBrYXBwYTogY29uY2VudHJhdGlvbiBwYXJhbWV0ZXIga2FwcGEgKD49IDApCiAgICAgICAgIyBpZiBrYXBwYSA9IDAgZ2VuZXJhdGUgdW5pZm9ybSByYW5kb20gYW5nbGUKCiAgICAgICAgIyBCYXNlZCB1cG9uIGFuIGFsZ29yaXRobSBwdWJsaXNoZWQgaW46IEZpc2hlciwgTi5JLiwKICAgICAgICAjICJTdGF0aXN0aWNhbCBBbmFseXNpcyBvZiBDaXJjdWxhciBEYXRhIiwgQ2FtYnJpZGdlCiAgICAgICAgIyBVbml2ZXJzaXR5IFByZXNzLCAxOTkzLgoKICAgICAgICAjIFRoYW5rcyB0byBNYWdudXMgS2Vzc2xlciBmb3IgYSBjb3JyZWN0aW9uIHRvIHRoZQogICAgICAgICMgaW1wbGVtZW50YXRpb24gb2Ygc3RlcCA0LgoKICAgICAgICByYW5kb20gPSBzZWxmLnJhbmRvbQogICAgICAgIGlmIGthcHBhIDw9IDFlLTY6CiAgICAgICAgICAgIHJldHVybiBUV09QSSAqIHJhbmRvbSgpCgogICAgICAgIGEgPSAxLjAgKyBfc3FydCgxLjAgKyA0LjAgKiBrYXBwYSAqIGthcHBhKQogICAgICAgIGIgPSAoYSAtIF9zcXJ0KDIuMCAqIGEpKS8oMi4wICoga2FwcGEpCiAgICAgICAgciA9ICgxLjAgKyBiICogYikvKDIuMCAqIGIpCgogICAgICAgIHdoaWxlIDE6CiAgICAgICAgICAgIHUxID0gcmFuZG9tKCkKCiAgICAgICAgICAgIHogPSBfY29zKF9waSAqIHUxKQogICAgICAgICAgICBmID0gKDEuMCArIHIgKiB6KS8ociArIHopCiAgICAgICAgICAgIGMgPSBrYXBwYSAqIChyIC0gZikKCiAgICAgICAgICAgIHUyID0gcmFuZG9tKCkKCiAgICAgICAgICAgIGlmIHUyIDwgYyAqICgyLjAgLSBjKSBvciB1MiA8PSBjICogX2V4cCgxLjAgLSBjKToKICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgIHUzID0gcmFuZG9tKCkKICAgICAgICBpZiB1MyA+IDAuNToKICAgICAgICAgICAgdGhldGEgPSAobXUgJSBUV09QSSkgKyBfYWNvcyhmKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRoZXRhID0gKG11ICUgVFdPUEkpIC0gX2Fjb3MoZikKCiAgICAgICAgcmV0dXJuIHRoZXRhCgojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLSBnYW1tYSBkaXN0cmlidXRpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgZ2FtbWF2YXJpYXRlKHNlbGYsIGFscGhhLCBiZXRhKToKICAgICAgICAiIiJHYW1tYSBkaXN0cmlidXRpb24uICBOb3QgdGhlIGdhbW1hIGZ1bmN0aW9uIQoKICAgICAgICBDb25kaXRpb25zIG9uIHRoZSBwYXJhbWV0ZXJzIGFyZSBhbHBoYSA+IDAgYW5kIGJldGEgPiAwLgoKICAgICAgICBUaGUgcHJvYmFiaWxpdHkgZGlzdHJpYnV0aW9uIGZ1bmN0aW9uIGlzOgoKICAgICAgICAgICAgICAgICAgICB4ICoqIChhbHBoYSAtIDEpICogbWF0aC5leHAoLXggLyBiZXRhKQogICAgICAgICAgcGRmKHgpID0gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgICAgICAgICAgICBtYXRoLmdhbW1hKGFscGhhKSAqIGJldGEgKiogYWxwaGEKCiAgICAgICAgIiIiCgogICAgICAgICMgYWxwaGEgPiAwLCBiZXRhID4gMCwgbWVhbiBpcyBhbHBoYSpiZXRhLCB2YXJpYW5jZSBpcyBhbHBoYSpiZXRhKioyCgogICAgICAgICMgV2FybmluZzogYSBmZXcgb2xkZXIgc291cmNlcyBkZWZpbmUgdGhlIGdhbW1hIGRpc3RyaWJ1dGlvbiBpbiB0ZXJtcwogICAgICAgICMgb2YgYWxwaGEgPiAtMS4wCiAgICAgICAgaWYgYWxwaGEgPD0gMC4wIG9yIGJldGEgPD0gMC4wOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdnYW1tYXZhcmlhdGU6IGFscGhhIGFuZCBiZXRhIG11c3QgYmUgPiAwLjAnKQoKICAgICAgICByYW5kb20gPSBzZWxmLnJhbmRvbQogICAgICAgIGlmIGFscGhhID4gMS4wOgoKICAgICAgICAgICAgIyBVc2VzIFIuQy5ILiBDaGVuZywgIlRoZSBnZW5lcmF0aW9uIG9mIEdhbW1hCiAgICAgICAgICAgICMgdmFyaWFibGVzIHdpdGggbm9uLWludGVncmFsIHNoYXBlIHBhcmFtZXRlcnMiLAogICAgICAgICAgICAjIEFwcGxpZWQgU3RhdGlzdGljcywgKDE5NzcpLCAyNiwgTm8uIDEsIHA3MS03NAoKICAgICAgICAgICAgYWludiA9IF9zcXJ0KDIuMCAqIGFscGhhIC0gMS4wKQogICAgICAgICAgICBiYmIgPSBhbHBoYSAtIExPRzQKICAgICAgICAgICAgY2NjID0gYWxwaGEgKyBhaW52CgogICAgICAgICAgICB3aGlsZSAxOgogICAgICAgICAgICAgICAgdTEgPSByYW5kb20oKQogICAgICAgICAgICAgICAgI2ZpeG1lIGJyeXRob24KICAgICAgICAgICAgICAgICNpZiBub3QgMWUtNyA8IHUxIDwgLjk5OTk5OTk6CiAgICAgICAgICAgICAgICBpZiBub3QgMWUtNyA8IHUxIDwgMC45OTk5OTk5OgogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICB1MiA9IDEuMCAtIHJhbmRvbSgpCiAgICAgICAgICAgICAgICB2ID0gX2xvZyh1MS8oMS4wLXUxKSkvYWludgogICAgICAgICAgICAgICAgeCA9IGFscGhhKl9leHAodikKICAgICAgICAgICAgICAgIHogPSB1MSp1MSp1MgogICAgICAgICAgICAgICAgciA9IGJiYitjY2Mqdi14CiAgICAgICAgICAgICAgICBpZiByICsgU0dfTUFHSUNDT05TVCAtIDQuNSp6ID49IDAuMCBvciByID49IF9sb2coeik6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHggKiBiZXRhCgogICAgICAgIGVsaWYgYWxwaGEgPT0gMS4wOgogICAgICAgICAgICAjIGV4cG92YXJpYXRlKDEpCiAgICAgICAgICAgIHUgPSByYW5kb20oKQogICAgICAgICAgICB3aGlsZSB1IDw9IDFlLTc6CiAgICAgICAgICAgICAgICB1ID0gcmFuZG9tKCkKICAgICAgICAgICAgcmV0dXJuIC1fbG9nKHUpICogYmV0YQoKICAgICAgICBlbHNlOiAgICMgYWxwaGEgaXMgYmV0d2VlbiAwIGFuZCAxIChleGNsdXNpdmUpCgogICAgICAgICAgICAjIFVzZXMgQUxHT1JJVEhNIEdTIG9mIFN0YXRpc3RpY2FsIENvbXB1dGluZyAtIEtlbm5lZHkgJiBHZW50bGUKCiAgICAgICAgICAgIHdoaWxlIDE6CiAgICAgICAgICAgICAgICB1ID0gcmFuZG9tKCkKICAgICAgICAgICAgICAgIGIgPSAoX2UgKyBhbHBoYSkvX2UKICAgICAgICAgICAgICAgIHAgPSBiKnUKICAgICAgICAgICAgICAgIGlmIHAgPD0gMS4wOgogICAgICAgICAgICAgICAgICAgIHggPSBwICoqICgxLjAvYWxwaGEpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHggPSAtX2xvZygoYi1wKS9hbHBoYSkKICAgICAgICAgICAgICAgIHUxID0gcmFuZG9tKCkKICAgICAgICAgICAgICAgIGlmIHAgPiAxLjA6CiAgICAgICAgICAgICAgICAgICAgaWYgdTEgPD0geCAqKiAoYWxwaGEgLSAxLjApOgogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgZWxpZiB1MSA8PSBfZXhwKC14KToKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICByZXR1cm4geCAqIGJldGEKCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tIEdhdXNzIChmYXN0ZXIgYWx0ZXJuYXRpdmUpIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgZGVmIGdhdXNzKHNlbGYsIG11LCBzaWdtYSk6CiAgICAgICAgIiIiR2F1c3NpYW4gZGlzdHJpYnV0aW9uLgoKICAgICAgICBtdSBpcyB0aGUgbWVhbiwgYW5kIHNpZ21hIGlzIHRoZSBzdGFuZGFyZCBkZXZpYXRpb24uICBUaGlzIGlzCiAgICAgICAgc2xpZ2h0bHkgZmFzdGVyIHRoYW4gdGhlIG5vcm1hbHZhcmlhdGUoKSBmdW5jdGlvbi4KCiAgICAgICAgTm90IHRocmVhZC1zYWZlIHdpdGhvdXQgYSBsb2NrIGFyb3VuZCBjYWxscy4KCiAgICAgICAgIiIiCgogICAgICAgICMgV2hlbiB4IGFuZCB5IGFyZSB0d28gdmFyaWFibGVzIGZyb20gWzAsIDEpLCB1bmlmb3JtbHkKICAgICAgICAjIGRpc3RyaWJ1dGVkLCB0aGVuCiAgICAgICAgIwogICAgICAgICMgICAgY29zKDIqcGkqeCkqc3FydCgtMipsb2coMS15KSkKICAgICAgICAjICAgIHNpbigyKnBpKngpKnNxcnQoLTIqbG9nKDEteSkpCiAgICAgICAgIwogICAgICAgICMgYXJlIHR3byAqaW5kZXBlbmRlbnQqIHZhcmlhYmxlcyB3aXRoIG5vcm1hbCBkaXN0cmlidXRpb24KICAgICAgICAjIChtdSA9IDAsIHNpZ21hID0gMSkuCiAgICAgICAgIyAoTGFtYmVydCBNZWVydGVucykKICAgICAgICAjIChjb3JyZWN0ZWQgdmVyc2lvbjsgYnVnIGRpc2NvdmVyZWQgYnkgTWlrZSBNaWxsZXIsIGZpeGVkIGJ5IExNKQoKICAgICAgICAjIE11bHRpdGhyZWFkaW5nIG5vdGU6IFdoZW4gdHdvIHRocmVhZHMgY2FsbCB0aGlzIGZ1bmN0aW9uCiAgICAgICAgIyBzaW11bHRhbmVvdXNseSwgaXQgaXMgcG9zc2libGUgdGhhdCB0aGV5IHdpbGwgcmVjZWl2ZSB0aGUKICAgICAgICAjIHNhbWUgcmV0dXJuIHZhbHVlLiAgVGhlIHdpbmRvdyBpcyB2ZXJ5IHNtYWxsIHRob3VnaC4gIFRvCiAgICAgICAgIyBhdm9pZCB0aGlzLCB5b3UgaGF2ZSB0byB1c2UgYSBsb2NrIGFyb3VuZCBhbGwgY2FsbHMuICAoSQogICAgICAgICMgZGlkbid0IHdhbnQgdG8gc2xvdyB0aGlzIGRvd24gaW4gdGhlIHNlcmlhbCBjYXNlIGJ5IHVzaW5nIGEKICAgICAgICAjIGxvY2sgaGVyZS4pCgogICAgICAgIHJhbmRvbSA9IHNlbGYucmFuZG9tCiAgICAgICAgeiA9IHNlbGYuZ2F1c3NfbmV4dAogICAgICAgIHNlbGYuZ2F1c3NfbmV4dCA9IE5vbmUKICAgICAgICBpZiB6IGlzIE5vbmU6CiAgICAgICAgICAgIHgycGkgPSByYW5kb20oKSAqIFRXT1BJCiAgICAgICAgICAgIGcycmFkID0gX3NxcnQoLTIuMCAqIF9sb2coMS4wIC0gcmFuZG9tKCkpKQogICAgICAgICAgICB6ID0gX2Nvcyh4MnBpKSAqIGcycmFkCiAgICAgICAgICAgIHNlbGYuZ2F1c3NfbmV4dCA9IF9zaW4oeDJwaSkgKiBnMnJhZAoKICAgICAgICByZXR1cm4gbXUgKyB6KnNpZ21hCgojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLSBiZXRhIC0tLS0tLS0tLS0tLS0tLS0tLS0tCiMjIFNlZQojIyBodHRwOi8vbWFpbC5weXRob24ub3JnL3BpcGVybWFpbC9weXRob24tYnVncy1saXN0LzIwMDEtSmFudWFyeS8wMDM3NTIuaHRtbAojIyBmb3IgSXZhbiBGcm9obmUncyBpbnNpZ2h0ZnVsIGFuYWx5c2lzIG9mIHdoeSB0aGUgb3JpZ2luYWwgaW1wbGVtZW50YXRpb246CiMjCiMjICAgIGRlZiBiZXRhdmFyaWF0ZShzZWxmLCBhbHBoYSwgYmV0YSk6CiMjICAgICAgICAjIERpc2NyZXRlIEV2ZW50IFNpbXVsYXRpb24gaW4gQywgcHAgODctODguCiMjCiMjICAgICAgICB5ID0gc2VsZi5leHBvdmFyaWF0ZShhbHBoYSkKIyMgICAgICAgIHogPSBzZWxmLmV4cG92YXJpYXRlKDEuMC9iZXRhKQojIyAgICAgICAgcmV0dXJuIHovKHkreikKIyMKIyMgd2FzIGRlYWQgd3JvbmcsIGFuZCBob3cgaXQgcHJvYmFibHkgZ290IHRoYXQgd2F5LgoKICAgIGRlZiBiZXRhdmFyaWF0ZShzZWxmLCBhbHBoYSwgYmV0YSk6CiAgICAgICAgIiIiQmV0YSBkaXN0cmlidXRpb24uCgogICAgICAgIENvbmRpdGlvbnMgb24gdGhlIHBhcmFtZXRlcnMgYXJlIGFscGhhID4gMCBhbmQgYmV0YSA+IDAuCiAgICAgICAgUmV0dXJuZWQgdmFsdWVzIHJhbmdlIGJldHdlZW4gMCBhbmQgMS4KCiAgICAgICAgIiIiCgogICAgICAgICMgVGhpcyB2ZXJzaW9uIGR1ZSB0byBKYW5uZSBTaW5ra29uZW4sIGFuZCBtYXRjaGVzIGFsbCB0aGUgc3RkCiAgICAgICAgIyB0ZXh0cyAoZS5nLiwgS251dGggVm9sIDIgRWQgMyBwZyAxMzQgInRoZSBiZXRhIGRpc3RyaWJ1dGlvbiIpLgogICAgICAgIHkgPSBzZWxmLmdhbW1hdmFyaWF0ZShhbHBoYSwgMS4pCiAgICAgICAgaWYgeSA9PSAwOgogICAgICAgICAgICByZXR1cm4gMC4wCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHkgLyAoeSArIHNlbGYuZ2FtbWF2YXJpYXRlKGJldGEsIDEuKSkKCiMjIC0tLS0tLS0tLS0tLS0tLS0tLS0tIFBhcmV0byAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIGRlZiBwYXJldG92YXJpYXRlKHNlbGYsIGFscGhhKToKICAgICAgICAiIiJQYXJldG8gZGlzdHJpYnV0aW9uLiAgYWxwaGEgaXMgdGhlIHNoYXBlIHBhcmFtZXRlci4iIiIKICAgICAgICAjIEphaW4sIHBnLiA0OTUKCiAgICAgICAgdSA9IDEuMCAtIHNlbGYucmFuZG9tKCkKICAgICAgICByZXR1cm4gMS4wIC8gdSAqKiAoMS4wL2FscGhhKQoKIyMgLS0tLS0tLS0tLS0tLS0tLS0tLS0gV2VpYnVsbCAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIGRlZiB3ZWlidWxsdmFyaWF0ZShzZWxmLCBhbHBoYSwgYmV0YSk6CiAgICAgICAgIiIiV2VpYnVsbCBkaXN0cmlidXRpb24uCgogICAgICAgIGFscGhhIGlzIHRoZSBzY2FsZSBwYXJhbWV0ZXIgYW5kIGJldGEgaXMgdGhlIHNoYXBlIHBhcmFtZXRlci4KCiAgICAgICAgIiIiCiAgICAgICAgIyBKYWluLCBwZy4gNDk5OyBidWcgZml4IGNvdXJ0ZXN5IEJpbGwgQXJtcwoKICAgICAgICB1ID0gMS4wIC0gc2VsZi5yYW5kb20oKQogICAgICAgIHJldHVybiBhbHBoYSAqICgtX2xvZyh1KSkgKiogKDEuMC9iZXRhKQoKCiMjIC0tLS0tLS0tLS0tLS0tLSBPcGVyYXRpbmcgU3lzdGVtIFJhbmRvbSBTb3VyY2UgIC0tLS0tLS0tLS0tLS0tLS0tLQoKY2xhc3MgU3lzdGVtUmFuZG9tKFJhbmRvbSk6CiAgICAiIiJBbHRlcm5hdGUgcmFuZG9tIG51bWJlciBnZW5lcmF0b3IgdXNpbmcgc291cmNlcyBwcm92aWRlZAogICAgYnkgdGhlIG9wZXJhdGluZyBzeXN0ZW0gKHN1Y2ggYXMgL2Rldi91cmFuZG9tIG9uIFVuaXggb3IKICAgIENyeXB0R2VuUmFuZG9tIG9uIFdpbmRvd3MpLgoKICAgICBOb3QgYXZhaWxhYmxlIG9uIGFsbCBzeXN0ZW1zIChzZWUgb3MudXJhbmRvbSgpIGZvciBkZXRhaWxzKS4KICAgICIiIgoKICAgIGRlZiByYW5kb20oc2VsZik6CiAgICAgICAgIiIiR2V0IHRoZSBuZXh0IHJhbmRvbSBudW1iZXIgaW4gdGhlIHJhbmdlIFswLjAsIDEuMCkuIiIiCiAgICAgICAgcmV0dXJuIChpbnQuZnJvbV9ieXRlcyhfdXJhbmRvbSg3KSwgJ2JpZycpID4+IDMpICogUkVDSVBfQlBGCgogICAgZGVmIGdldHJhbmRiaXRzKHNlbGYsIGspOgogICAgICAgICIiImdldHJhbmRiaXRzKGspIC0+IHguICBHZW5lcmF0ZXMgYSBsb25nIGludCB3aXRoIGsgcmFuZG9tIGJpdHMuIiIiCiAgICAgICAgaWYgayA8PSAwOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdudW1iZXIgb2YgYml0cyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiB6ZXJvJykKICAgICAgICBpZiBrICE9IGludChrKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdudW1iZXIgb2YgYml0cyBzaG91bGQgYmUgYW4gaW50ZWdlcicpCiAgICAgICAgbnVtYnl0ZXMgPSAoayArIDcpIC8vIDggICAgICAgICAgICAgICAgICAgICAgICMgYml0cyAvIDggYW5kIHJvdW5kZWQgdXAKICAgICAgICB4ID0gaW50LmZyb21fYnl0ZXMoX3VyYW5kb20obnVtYnl0ZXMpLCAnYmlnJykKICAgICAgICByZXR1cm4geCA+PiAobnVtYnl0ZXMgKiA4IC0gaykgICAgICAgICAgICAgICAgIyB0cmltIGV4Y2VzcyBiaXRzCgogICAgZGVmIHNlZWQoc2VsZiwgKmFyZ3MsICoqa3dkcyk6CiAgICAgICAgIlN0dWIgbWV0aG9kLiAgTm90IHVzZWQgZm9yIGEgc3lzdGVtIHJhbmRvbSBudW1iZXIgZ2VuZXJhdG9yLiIKICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBfbm90aW1wbGVtZW50ZWQoc2VsZiwgKmFyZ3MsICoqa3dkcyk6CiAgICAgICAgIk1ldGhvZCBzaG91bGQgbm90IGJlIGNhbGxlZCBmb3IgYSBzeXN0ZW0gcmFuZG9tIG51bWJlciBnZW5lcmF0b3IuIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoJ1N5c3RlbSBlbnRyb3B5IHNvdXJjZSBkb2VzIG5vdCBoYXZlIHN0YXRlLicpCiAgICBnZXRzdGF0ZSA9IHNldHN0YXRlID0gX25vdGltcGxlbWVudGVkCgojIyAtLS0tLS0tLS0tLS0tLS0tLS0tLSB0ZXN0IHByb2dyYW0gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmRlZiBfdGVzdF9nZW5lcmF0b3IobiwgZnVuYywgYXJncyk6CiAgICBpbXBvcnQgdGltZQogICAgcHJpbnQobiwgJ3RpbWVzJywgZnVuYy5fX25hbWVfXykKICAgIHRvdGFsID0gMC4wCiAgICBzcXN1bSA9IDAuMAogICAgc21hbGxlc3QgPSAxZTEwCiAgICBsYXJnZXN0ID0gLTFlMTAKICAgIHQwID0gdGltZS50aW1lKCkKICAgIGZvciBpIGluIHJhbmdlKG4pOgogICAgICAgIHggPSBmdW5jKCphcmdzKQogICAgICAgIHRvdGFsICs9IHgKICAgICAgICBzcXN1bSA9IHNxc3VtICsgeCp4CiAgICAgICAgc21hbGxlc3QgPSBtaW4oeCwgc21hbGxlc3QpCiAgICAgICAgbGFyZ2VzdCA9IG1heCh4LCBsYXJnZXN0KQogICAgdDEgPSB0aW1lLnRpbWUoKQogICAgcHJpbnQocm91bmQodDEtdDAsIDMpLCAnc2VjLCcsIGVuZD0nICcpCiAgICBhdmcgPSB0b3RhbC9uCiAgICBzdGRkZXYgPSBfc3FydChzcXN1bS9uIC0gYXZnKmF2ZykKICAgIHByaW50KCdhdmcgJWcsIHN0ZGRldiAlZywgbWluICVnLCBtYXggJWcnICUgXAogICAgICAgICAgICAgIChhdmcsIHN0ZGRldiwgc21hbGxlc3QsIGxhcmdlc3QpKQoKCmRlZiBfdGVzdChOPTIwMDApOgogICAgX3Rlc3RfZ2VuZXJhdG9yKE4sIHJhbmRvbSwgKCkpCiAgICBfdGVzdF9nZW5lcmF0b3IoTiwgbm9ybWFsdmFyaWF0ZSwgKDAuMCwgMS4wKSkKICAgIF90ZXN0X2dlbmVyYXRvcihOLCBsb2dub3JtdmFyaWF0ZSwgKDAuMCwgMS4wKSkKICAgIF90ZXN0X2dlbmVyYXRvcihOLCB2b25taXNlc3ZhcmlhdGUsICgwLjAsIDEuMCkpCiAgICBfdGVzdF9nZW5lcmF0b3IoTiwgZ2FtbWF2YXJpYXRlLCAoMC4wMSwgMS4wKSkKICAgIF90ZXN0X2dlbmVyYXRvcihOLCBnYW1tYXZhcmlhdGUsICgwLjEsIDEuMCkpCiAgICBfdGVzdF9nZW5lcmF0b3IoTiwgZ2FtbWF2YXJpYXRlLCAoMC4xLCAyLjApKQogICAgX3Rlc3RfZ2VuZXJhdG9yKE4sIGdhbW1hdmFyaWF0ZSwgKDAuNSwgMS4wKSkKICAgIF90ZXN0X2dlbmVyYXRvcihOLCBnYW1tYXZhcmlhdGUsICgwLjksIDEuMCkpCiAgICBfdGVzdF9nZW5lcmF0b3IoTiwgZ2FtbWF2YXJpYXRlLCAoMS4wLCAxLjApKQogICAgX3Rlc3RfZ2VuZXJhdG9yKE4sIGdhbW1hdmFyaWF0ZSwgKDIuMCwgMS4wKSkKICAgIF90ZXN0X2dlbmVyYXRvcihOLCBnYW1tYXZhcmlhdGUsICgyMC4wLCAxLjApKQogICAgX3Rlc3RfZ2VuZXJhdG9yKE4sIGdhbW1hdmFyaWF0ZSwgKDIwMC4wLCAxLjApKQogICAgX3Rlc3RfZ2VuZXJhdG9yKE4sIGdhdXNzLCAoMC4wLCAxLjApKQogICAgX3Rlc3RfZ2VuZXJhdG9yKE4sIGJldGF2YXJpYXRlLCAoMy4wLCAzLjApKQogICAgX3Rlc3RfZ2VuZXJhdG9yKE4sIHRyaWFuZ3VsYXIsICgwLjAsIDEuMCwgMS4wLzMuMCkpCgojIENyZWF0ZSBvbmUgaW5zdGFuY2UsIHNlZWRlZCBmcm9tIGN1cnJlbnQgdGltZSwgYW5kIGV4cG9ydCBpdHMgbWV0aG9kcwojIGFzIG1vZHVsZS1sZXZlbCBmdW5jdGlvbnMuICBUaGUgZnVuY3Rpb25zIHNoYXJlIHN0YXRlIGFjcm9zcyBhbGwgdXNlcwojKGJvdGggaW4gdGhlIHVzZXIncyBjb2RlIGFuZCBpbiB0aGUgUHl0aG9uIGxpYnJhcmllcyksIGJ1dCB0aGF0J3MgZmluZQojIGZvciBtb3N0IHByb2dyYW1zIGFuZCBpcyBlYXNpZXIgZm9yIHRoZSBjYXN1YWwgdXNlciB0aGFuIG1ha2luZyB0aGVtCiMgaW5zdGFudGlhdGUgdGhlaXIgb3duIFJhbmRvbSgpIGluc3RhbmNlLgoKX2luc3QgPSBSYW5kb20oKQpzZWVkID0gX2luc3Quc2VlZApyYW5kb20gPSBfaW5zdC5yYW5kb20KdW5pZm9ybSA9IF9pbnN0LnVuaWZvcm0KdHJpYW5ndWxhciA9IF9pbnN0LnRyaWFuZ3VsYXIKcmFuZGludCA9IF9pbnN0LnJhbmRpbnQKY2hvaWNlID0gX2luc3QuY2hvaWNlCnJhbmRyYW5nZSA9IF9pbnN0LnJhbmRyYW5nZQpzYW1wbGUgPSBfaW5zdC5zYW1wbGUKc2h1ZmZsZSA9IF9pbnN0LnNodWZmbGUKbm9ybWFsdmFyaWF0ZSA9IF9pbnN0Lm5vcm1hbHZhcmlhdGUKbG9nbm9ybXZhcmlhdGUgPSBfaW5zdC5sb2dub3JtdmFyaWF0ZQpleHBvdmFyaWF0ZSA9IF9pbnN0LmV4cG92YXJpYXRlCnZvbm1pc2VzdmFyaWF0ZSA9IF9pbnN0LnZvbm1pc2VzdmFyaWF0ZQpnYW1tYXZhcmlhdGUgPSBfaW5zdC5nYW1tYXZhcmlhdGUKZ2F1c3MgPSBfaW5zdC5nYXVzcwpiZXRhdmFyaWF0ZSA9IF9pbnN0LmJldGF2YXJpYXRlCnBhcmV0b3ZhcmlhdGUgPSBfaW5zdC5wYXJldG92YXJpYXRlCndlaWJ1bGx2YXJpYXRlID0gX2luc3Qud2VpYnVsbHZhcmlhdGUKZ2V0c3RhdGUgPSBfaW5zdC5nZXRzdGF0ZQpzZXRzdGF0ZSA9IF9pbnN0LnNldHN0YXRlCmdldHJhbmRiaXRzID0gX2luc3QuZ2V0cmFuZGJpdHMKCiNpZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgojICAgIF90ZXN0KCkKCg==',
'/Lib/reprlib.py':'IiIiUmVkbyB0aGUgYnVpbHRpbiByZXByKCkgKHJlcHJlc2VudGF0aW9uKSBidXQgd2l0aCBsaW1pdHMgb24gbW9zdCBzaXplcy4iIiIKCl9fYWxsX18gPSBbIlJlcHIiLCAicmVwciIsICJyZWN1cnNpdmVfcmVwciJdCgppbXBvcnQgYnVpbHRpbnMKZnJvbSBpdGVydG9vbHMgaW1wb3J0IGlzbGljZQp0cnk6CiAgICBmcm9tIF90aHJlYWQgaW1wb3J0IGdldF9pZGVudApleGNlcHQgSW1wb3J0RXJyb3I6CiAgICBmcm9tIF9kdW1teV90aHJlYWQgaW1wb3J0IGdldF9pZGVudAoKZGVmIHJlY3Vyc2l2ZV9yZXByKGZpbGx2YWx1ZT0nLi4uJyk6CiAgICAnRGVjb3JhdG9yIHRvIG1ha2UgYSByZXByIGZ1bmN0aW9uIHJldHVybiBmaWxsdmFsdWUgZm9yIGEgcmVjdXJzaXZlIGNhbGwnCgogICAgZGVmIGRlY29yYXRpbmdfZnVuY3Rpb24odXNlcl9mdW5jdGlvbik6CiAgICAgICAgcmVwcl9ydW5uaW5nID0gc2V0KCkKCiAgICAgICAgZGVmIHdyYXBwZXIoc2VsZik6CiAgICAgICAgICAgIGtleSA9IGlkKHNlbGYpLCBnZXRfaWRlbnQoKQogICAgICAgICAgICBpZiBrZXkgaW4gcmVwcl9ydW5uaW5nOgogICAgICAgICAgICAgICAgcmV0dXJuIGZpbGx2YWx1ZQogICAgICAgICAgICByZXByX3J1bm5pbmcuYWRkKGtleSkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gdXNlcl9mdW5jdGlvbihzZWxmKQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgcmVwcl9ydW5uaW5nLmRpc2NhcmQoa2V5KQogICAgICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgICAgICMgQ2FuJ3QgdXNlIGZ1bmN0b29scy53cmFwcygpIGhlcmUgYmVjYXVzZSBvZiBib290c3RyYXAgaXNzdWVzCiAgICAgICAgd3JhcHBlci5fX21vZHVsZV9fID0gZ2V0YXR0cih1c2VyX2Z1bmN0aW9uLCAnX19tb2R1bGVfXycpCiAgICAgICAgd3JhcHBlci5fX2RvY19fID0gZ2V0YXR0cih1c2VyX2Z1bmN0aW9uLCAnX19kb2NfXycpCiAgICAgICAgd3JhcHBlci5fX25hbWVfXyA9IGdldGF0dHIodXNlcl9mdW5jdGlvbiwgJ19fbmFtZV9fJykKICAgICAgICB3cmFwcGVyLl9fYW5ub3RhdGlvbnNfXyA9IGdldGF0dHIodXNlcl9mdW5jdGlvbiwgJ19fYW5ub3RhdGlvbnNfXycsIHt9KQogICAgICAgIHJldHVybiB3cmFwcGVyCgogICAgcmV0dXJuIGRlY29yYXRpbmdfZnVuY3Rpb24KCmNsYXNzIFJlcHI6CgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYubWF4bGV2ZWwgPSA2CiAgICAgICAgc2VsZi5tYXh0dXBsZSA9IDYKICAgICAgICBzZWxmLm1heGxpc3QgPSA2CiAgICAgICAgc2VsZi5tYXhhcnJheSA9IDUKICAgICAgICBzZWxmLm1heGRpY3QgPSA0CiAgICAgICAgc2VsZi5tYXhzZXQgPSA2CiAgICAgICAgc2VsZi5tYXhmcm96ZW5zZXQgPSA2CiAgICAgICAgc2VsZi5tYXhkZXF1ZSA9IDYKICAgICAgICBzZWxmLm1heHN0cmluZyA9IDMwCiAgICAgICAgc2VsZi5tYXhsb25nID0gNDAKICAgICAgICBzZWxmLm1heG90aGVyID0gMzAKCiAgICBkZWYgcmVwcihzZWxmLCB4KToKICAgICAgICByZXR1cm4gc2VsZi5yZXByMSh4LCBzZWxmLm1heGxldmVsKQoKICAgIGRlZiByZXByMShzZWxmLCB4LCBsZXZlbCk6CiAgICAgICAgdHlwZW5hbWUgPSB0eXBlKHgpLl9fbmFtZV9fCiAgICAgICAgaWYgJyAnIGluIHR5cGVuYW1lOgogICAgICAgICAgICBwYXJ0cyA9IHR5cGVuYW1lLnNwbGl0KCkKICAgICAgICAgICAgdHlwZW5hbWUgPSAnXycuam9pbihwYXJ0cykKICAgICAgICBpZiBoYXNhdHRyKHNlbGYsICdyZXByXycgKyB0eXBlbmFtZSk6CiAgICAgICAgICAgIHJldHVybiBnZXRhdHRyKHNlbGYsICdyZXByXycgKyB0eXBlbmFtZSkoeCwgbGV2ZWwpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYucmVwcl9pbnN0YW5jZSh4LCBsZXZlbCkKCiAgICBkZWYgX3JlcHJfaXRlcmFibGUoc2VsZiwgeCwgbGV2ZWwsIGxlZnQsIHJpZ2h0LCBtYXhpdGVyLCB0cmFpbD0nJyk6CiAgICAgICAgbiA9IGxlbih4KQogICAgICAgIGlmIGxldmVsIDw9IDAgYW5kIG46CiAgICAgICAgICAgIHMgPSAnLi4uJwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG5ld2xldmVsID0gbGV2ZWwgLSAxCiAgICAgICAgICAgIHJlcHIxID0gc2VsZi5yZXByMQogICAgICAgICAgICBwaWVjZXMgPSBbcmVwcjEoZWxlbSwgbmV3bGV2ZWwpIGZvciBlbGVtIGluIGlzbGljZSh4LCBtYXhpdGVyKV0KICAgICAgICAgICAgaWYgbiA+IG1heGl0ZXI6ICBwaWVjZXMuYXBwZW5kKCcuLi4nKQogICAgICAgICAgICBzID0gJywgJy5qb2luKHBpZWNlcykKICAgICAgICAgICAgaWYgbiA9PSAxIGFuZCB0cmFpbDogIHJpZ2h0ID0gdHJhaWwgKyByaWdodAogICAgICAgIHJldHVybiAnJXMlcyVzJyAlIChsZWZ0LCBzLCByaWdodCkKCiAgICBkZWYgcmVwcl90dXBsZShzZWxmLCB4LCBsZXZlbCk6CiAgICAgICAgcmV0dXJuIHNlbGYuX3JlcHJfaXRlcmFibGUoeCwgbGV2ZWwsICcoJywgJyknLCBzZWxmLm1heHR1cGxlLCAnLCcpCgogICAgZGVmIHJlcHJfbGlzdChzZWxmLCB4LCBsZXZlbCk6CiAgICAgICAgcmV0dXJuIHNlbGYuX3JlcHJfaXRlcmFibGUoeCwgbGV2ZWwsICdbJywgJ10nLCBzZWxmLm1heGxpc3QpCgogICAgZGVmIHJlcHJfYXJyYXkoc2VsZiwgeCwgbGV2ZWwpOgogICAgICAgIGhlYWRlciA9ICJhcnJheSgnJXMnLCBbIiAlIHgudHlwZWNvZGUKICAgICAgICByZXR1cm4gc2VsZi5fcmVwcl9pdGVyYWJsZSh4LCBsZXZlbCwgaGVhZGVyLCAnXSknLCBzZWxmLm1heGFycmF5KQoKICAgIGRlZiByZXByX3NldChzZWxmLCB4LCBsZXZlbCk6CiAgICAgICAgeCA9IF9wb3NzaWJseV9zb3J0ZWQoeCkKICAgICAgICByZXR1cm4gc2VsZi5fcmVwcl9pdGVyYWJsZSh4LCBsZXZlbCwgJ3NldChbJywgJ10pJywgc2VsZi5tYXhzZXQpCgogICAgZGVmIHJlcHJfZnJvemVuc2V0KHNlbGYsIHgsIGxldmVsKToKICAgICAgICB4ID0gX3Bvc3NpYmx5X3NvcnRlZCh4KQogICAgICAgIHJldHVybiBzZWxmLl9yZXByX2l0ZXJhYmxlKHgsIGxldmVsLCAnZnJvemVuc2V0KFsnLCAnXSknLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubWF4ZnJvemVuc2V0KQoKICAgIGRlZiByZXByX2RlcXVlKHNlbGYsIHgsIGxldmVsKToKICAgICAgICByZXR1cm4gc2VsZi5fcmVwcl9pdGVyYWJsZSh4LCBsZXZlbCwgJ2RlcXVlKFsnLCAnXSknLCBzZWxmLm1heGRlcXVlKQoKICAgIGRlZiByZXByX2RpY3Qoc2VsZiwgeCwgbGV2ZWwpOgogICAgICAgIG4gPSBsZW4oeCkKICAgICAgICBpZiBuID09IDA6IHJldHVybiAne30nCiAgICAgICAgaWYgbGV2ZWwgPD0gMDogcmV0dXJuICd7Li4ufScKICAgICAgICBuZXdsZXZlbCA9IGxldmVsIC0gMQogICAgICAgIHJlcHIxID0gc2VsZi5yZXByMQogICAgICAgIHBpZWNlcyA9IFtdCiAgICAgICAgZm9yIGtleSBpbiBpc2xpY2UoX3Bvc3NpYmx5X3NvcnRlZCh4KSwgc2VsZi5tYXhkaWN0KToKICAgICAgICAgICAga2V5cmVwciA9IHJlcHIxKGtleSwgbmV3bGV2ZWwpCiAgICAgICAgICAgIHZhbHJlcHIgPSByZXByMSh4W2tleV0sIG5ld2xldmVsKQogICAgICAgICAgICBwaWVjZXMuYXBwZW5kKCclczogJXMnICUgKGtleXJlcHIsIHZhbHJlcHIpKQogICAgICAgIGlmIG4gPiBzZWxmLm1heGRpY3Q6IHBpZWNlcy5hcHBlbmQoJy4uLicpCiAgICAgICAgcyA9ICcsICcuam9pbihwaWVjZXMpCiAgICAgICAgcmV0dXJuICd7JXN9JyAlIChzLCkKCiAgICBkZWYgcmVwcl9zdHIoc2VsZiwgeCwgbGV2ZWwpOgogICAgICAgIHMgPSBidWlsdGlucy5yZXByKHhbOnNlbGYubWF4c3RyaW5nXSkKICAgICAgICBpZiBsZW4ocykgPiBzZWxmLm1heHN0cmluZzoKICAgICAgICAgICAgaSA9IG1heCgwLCAoc2VsZi5tYXhzdHJpbmctMykvLzIpCiAgICAgICAgICAgIGogPSBtYXgoMCwgc2VsZi5tYXhzdHJpbmctMy1pKQogICAgICAgICAgICBzID0gYnVpbHRpbnMucmVwcih4WzppXSArIHhbbGVuKHgpLWo6XSkKICAgICAgICAgICAgcyA9IHNbOmldICsgJy4uLicgKyBzW2xlbihzKS1qOl0KICAgICAgICByZXR1cm4gcwoKICAgIGRlZiByZXByX2ludChzZWxmLCB4LCBsZXZlbCk6CiAgICAgICAgcyA9IGJ1aWx0aW5zLnJlcHIoeCkgIyBYWFggSG9wZSB0aGlzIGlzbid0IHRvbyBzbG93Li4uCiAgICAgICAgaWYgbGVuKHMpID4gc2VsZi5tYXhsb25nOgogICAgICAgICAgICBpID0gbWF4KDAsIChzZWxmLm1heGxvbmctMykvLzIpCiAgICAgICAgICAgIGogPSBtYXgoMCwgc2VsZi5tYXhsb25nLTMtaSkKICAgICAgICAgICAgcyA9IHNbOmldICsgJy4uLicgKyBzW2xlbihzKS1qOl0KICAgICAgICByZXR1cm4gcwoKICAgIGRlZiByZXByX2luc3RhbmNlKHNlbGYsIHgsIGxldmVsKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHMgPSBidWlsdGlucy5yZXByKHgpCiAgICAgICAgICAgICMgQnVncyBpbiB4Ll9fcmVwcl9fKCkgY2FuIGNhdXNlIGFyYml0cmFyeQogICAgICAgICAgICAjIGV4Y2VwdGlvbnMgLS0gdGhlbiBtYWtlIHVwIHNvbWV0aGluZwogICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgIHJldHVybiAnPCVzIGluc3RhbmNlIGF0ICV4PicgJSAoeC5fX2NsYXNzX18uX19uYW1lX18sIGlkKHgpKQogICAgICAgIGlmIGxlbihzKSA+IHNlbGYubWF4b3RoZXI6CiAgICAgICAgICAgIGkgPSBtYXgoMCwgKHNlbGYubWF4b3RoZXItMykvLzIpCiAgICAgICAgICAgIGogPSBtYXgoMCwgc2VsZi5tYXhvdGhlci0zLWkpCiAgICAgICAgICAgIHMgPSBzWzppXSArICcuLi4nICsgc1tsZW4ocyktajpdCiAgICAgICAgcmV0dXJuIHMKCgpkZWYgX3Bvc3NpYmx5X3NvcnRlZCh4KToKICAgICMgU2luY2Ugbm90IGFsbCBzZXF1ZW5jZXMgb2YgaXRlbXMgY2FuIGJlIHNvcnRlZCBhbmQgY29tcGFyaXNvbgogICAgIyBmdW5jdGlvbnMgbWF5IHJhaXNlIGFyYml0cmFyeSBleGNlcHRpb25zLCByZXR1cm4gYW4gdW5zb3J0ZWQKICAgICMgc2VxdWVuY2UgaW4gdGhhdCBjYXNlLgogICAgdHJ5OgogICAgICAgIHJldHVybiBzb3J0ZWQoeCkKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIGxpc3QoeCkKCmFSZXByID0gUmVwcigpCnJlcHIgPSBhUmVwci5yZXByCg==',
'/Lib/shutil.py':'IiIiVXRpbGl0eSBmdW5jdGlvbnMgZm9yIGNvcHlpbmcgYW5kIGFyY2hpdmluZyBmaWxlcyBhbmQgZGlyZWN0b3J5IHRyZWVzLgoKWFhYIFRoZSBmdW5jdGlvbnMgaGVyZSBkb24ndCBjb3B5IHRoZSByZXNvdXJjZSBmb3JrIG9yIG90aGVyIG1ldGFkYXRhIG9uIE1hYy4KCiIiIgoKaW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IHN0YXQKZnJvbSBvcy5wYXRoIGltcG9ydCBhYnNwYXRoCmltcG9ydCBmbm1hdGNoCmltcG9ydCBjb2xsZWN0aW9ucwppbXBvcnQgZXJybm8KaW1wb3J0IHRhcmZpbGUKCnRyeToKICAgIGltcG9ydCBiejIKICAgIGRlbCBiejIKICAgIF9CWjJfU1VQUE9SVEVEID0gVHJ1ZQpleGNlcHQgSW1wb3J0RXJyb3I6CiAgICBfQloyX1NVUFBPUlRFRCA9IEZhbHNlCgp0cnk6CiAgICBmcm9tIHB3ZCBpbXBvcnQgZ2V0cHduYW0KZXhjZXB0IEltcG9ydEVycm9yOgogICAgZ2V0cHduYW0gPSBOb25lCgp0cnk6CiAgICBmcm9tIGdycCBpbXBvcnQgZ2V0Z3JuYW0KZXhjZXB0IEltcG9ydEVycm9yOgogICAgZ2V0Z3JuYW0gPSBOb25lCgpfX2FsbF9fID0gWyJjb3B5ZmlsZW9iaiIsICJjb3B5ZmlsZSIsICJjb3B5bW9kZSIsICJjb3B5c3RhdCIsICJjb3B5IiwgImNvcHkyIiwKICAgICAgICAgICAiY29weXRyZWUiLCAibW92ZSIsICJybXRyZWUiLCAiRXJyb3IiLCAiU3BlY2lhbEZpbGVFcnJvciIsCiAgICAgICAgICAgIkV4ZWNFcnJvciIsICJtYWtlX2FyY2hpdmUiLCAiZ2V0X2FyY2hpdmVfZm9ybWF0cyIsCiAgICAgICAgICAgInJlZ2lzdGVyX2FyY2hpdmVfZm9ybWF0IiwgInVucmVnaXN0ZXJfYXJjaGl2ZV9mb3JtYXQiLAogICAgICAgICAgICJnZXRfdW5wYWNrX2Zvcm1hdHMiLCAicmVnaXN0ZXJfdW5wYWNrX2Zvcm1hdCIsCiAgICAgICAgICAgInVucmVnaXN0ZXJfdW5wYWNrX2Zvcm1hdCIsICJ1bnBhY2tfYXJjaGl2ZSIsCiAgICAgICAgICAgImlnbm9yZV9wYXR0ZXJucyIsICJjaG93biIsICJ3aGljaCJdCiAgICAgICAgICAgIyBkaXNrX3VzYWdlIGlzIGFkZGVkIGxhdGVyLCBpZiBhdmFpbGFibGUgb24gdGhlIHBsYXRmb3JtCgpjbGFzcyBFcnJvcihFbnZpcm9ubWVudEVycm9yKToKICAgIHBhc3MKCmNsYXNzIFNwZWNpYWxGaWxlRXJyb3IoRW52aXJvbm1lbnRFcnJvcik6CiAgICAiIiJSYWlzZWQgd2hlbiB0cnlpbmcgdG8gZG8gYSBraW5kIG9mIG9wZXJhdGlvbiAoZS5nLiBjb3B5aW5nKSB3aGljaCBpcwogICAgbm90IHN1cHBvcnRlZCBvbiBhIHNwZWNpYWwgZmlsZSAoZS5nLiBhIG5hbWVkIHBpcGUpIiIiCgpjbGFzcyBFeGVjRXJyb3IoRW52aXJvbm1lbnRFcnJvcik6CiAgICAiIiJSYWlzZWQgd2hlbiBhIGNvbW1hbmQgY291bGQgbm90IGJlIGV4ZWN1dGVkIiIiCgpjbGFzcyBSZWFkRXJyb3IoRW52aXJvbm1lbnRFcnJvcik6CiAgICAiIiJSYWlzZWQgd2hlbiBhbiBhcmNoaXZlIGNhbm5vdCBiZSByZWFkIiIiCgpjbGFzcyBSZWdpc3RyeUVycm9yKEV4Y2VwdGlvbik6CiAgICAiIiJSYWlzZWQgd2hlbiBhIHJlZ2lzdGVyeSBvcGVyYXRpb24gd2l0aCB0aGUgYXJjaGl2aW5nCiAgICBhbmQgdW5wYWNraW5nIHJlZ2lzdGVyaWVzIGZhaWxzIiIiCgoKdHJ5OgogICAgV2luZG93c0Vycm9yCmV4Y2VwdCBOYW1lRXJyb3I6CiAgICBXaW5kb3dzRXJyb3IgPSBOb25lCgpkZWYgY29weWZpbGVvYmooZnNyYywgZmRzdCwgbGVuZ3RoPTE2KjEwMjQpOgogICAgIiIiY29weSBkYXRhIGZyb20gZmlsZS1saWtlIG9iamVjdCBmc3JjIHRvIGZpbGUtbGlrZSBvYmplY3QgZmRzdCIiIgogICAgd2hpbGUgMToKICAgICAgICBidWYgPSBmc3JjLnJlYWQobGVuZ3RoKQogICAgICAgIGlmIG5vdCBidWY6CiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZmRzdC53cml0ZShidWYpCgpkZWYgX3NhbWVmaWxlKHNyYywgZHN0KToKICAgICMgTWFjaW50b3NoLCBVbml4LgogICAgaWYgaGFzYXR0cihvcy5wYXRoLCAnc2FtZWZpbGUnKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJldHVybiBvcy5wYXRoLnNhbWVmaWxlKHNyYywgZHN0KQogICAgICAgIGV4Y2VwdCBPU0Vycm9yOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAjIEFsbCBvdGhlciBwbGF0Zm9ybXM6IGNoZWNrIGZvciBzYW1lIHBhdGhuYW1lLgogICAgcmV0dXJuIChvcy5wYXRoLm5vcm1jYXNlKG9zLnBhdGguYWJzcGF0aChzcmMpKSA9PQogICAgICAgICAgICBvcy5wYXRoLm5vcm1jYXNlKG9zLnBhdGguYWJzcGF0aChkc3QpKSkKCmRlZiBjb3B5ZmlsZShzcmMsIGRzdCwgKiwgZm9sbG93X3N5bWxpbmtzPVRydWUpOgogICAgIiIiQ29weSBkYXRhIGZyb20gc3JjIHRvIGRzdC4KCiAgICBJZiBmb2xsb3dfc3ltbGlua3MgaXMgbm90IHNldCBhbmQgc3JjIGlzIGEgc3ltYm9saWMgbGluaywgYSBuZXcKICAgIHN5bWxpbmsgd2lsbCBiZSBjcmVhdGVkIGluc3RlYWQgb2YgY29weWluZyB0aGUgZmlsZSBpdCBwb2ludHMgdG8uCgogICAgIiIiCiAgICBpZiBfc2FtZWZpbGUoc3JjLCBkc3QpOgogICAgICAgIHJhaXNlIEVycm9yKCJgJXNgIGFuZCBgJXNgIGFyZSB0aGUgc2FtZSBmaWxlIiAlIChzcmMsIGRzdCkpCgogICAgZm9yIGZuIGluIFtzcmMsIGRzdF06CiAgICAgICAgdHJ5OgogICAgICAgICAgICBzdCA9IG9zLnN0YXQoZm4pCiAgICAgICAgZXhjZXB0IE9TRXJyb3I6CiAgICAgICAgICAgICMgRmlsZSBtb3N0IGxpa2VseSBkb2VzIG5vdCBleGlzdAogICAgICAgICAgICBwYXNzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyBYWFggV2hhdCBhYm91dCBvdGhlciBzcGVjaWFsIGZpbGVzPyAoc29ja2V0cywgZGV2aWNlcy4uLikKICAgICAgICAgICAgaWYgc3RhdC5TX0lTRklGTyhzdC5zdF9tb2RlKToKICAgICAgICAgICAgICAgIHJhaXNlIFNwZWNpYWxGaWxlRXJyb3IoImAlc2AgaXMgYSBuYW1lZCBwaXBlIiAlIGZuKQoKICAgIGlmIG5vdCBmb2xsb3dfc3ltbGlua3MgYW5kIG9zLnBhdGguaXNsaW5rKHNyYyk6CiAgICAgICAgb3Muc3ltbGluayhvcy5yZWFkbGluayhzcmMpLCBkc3QpCiAgICBlbHNlOgogICAgICAgIHdpdGggb3BlbihzcmMsICdyYicpIGFzIGZzcmM6CiAgICAgICAgICAgIHdpdGggb3Blbihkc3QsICd3YicpIGFzIGZkc3Q6CiAgICAgICAgICAgICAgICBjb3B5ZmlsZW9iaihmc3JjLCBmZHN0KQogICAgcmV0dXJuIGRzdAoKZGVmIGNvcHltb2RlKHNyYywgZHN0LCAqLCBmb2xsb3dfc3ltbGlua3M9VHJ1ZSk6CiAgICAiIiJDb3B5IG1vZGUgYml0cyBmcm9tIHNyYyB0byBkc3QuCgogICAgSWYgZm9sbG93X3N5bWxpbmtzIGlzIG5vdCBzZXQsIHN5bWxpbmtzIGFyZW4ndCBmb2xsb3dlZCBpZiBhbmQgb25seQogICAgaWYgYm90aCBgc3JjYCBhbmQgYGRzdGAgYXJlIHN5bWxpbmtzLiAgSWYgYGxjaG1vZGAgaXNuJ3QgYXZhaWxhYmxlCiAgICAoZS5nLiBMaW51eCkgdGhpcyBtZXRob2QgZG9lcyBub3RoaW5nLgoKICAgICIiIgogICAgaWYgbm90IGZvbGxvd19zeW1saW5rcyBhbmQgb3MucGF0aC5pc2xpbmsoc3JjKSBhbmQgb3MucGF0aC5pc2xpbmsoZHN0KToKICAgICAgICBpZiBoYXNhdHRyKG9zLCAnbGNobW9kJyk6CiAgICAgICAgICAgIHN0YXRfZnVuYywgY2htb2RfZnVuYyA9IG9zLmxzdGF0LCBvcy5sY2htb2QKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4KICAgIGVsaWYgaGFzYXR0cihvcywgJ2NobW9kJyk6CiAgICAgICAgc3RhdF9mdW5jLCBjaG1vZF9mdW5jID0gb3Muc3RhdCwgb3MuY2htb2QKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuCgogICAgc3QgPSBzdGF0X2Z1bmMoc3JjKQogICAgY2htb2RfZnVuYyhkc3QsIHN0YXQuU19JTU9ERShzdC5zdF9tb2RlKSkKCmlmIGhhc2F0dHIob3MsICdsaXN0eGF0dHInKToKICAgIGRlZiBfY29weXhhdHRyKHNyYywgZHN0LCAqLCBmb2xsb3dfc3ltbGlua3M9VHJ1ZSk6CiAgICAgICAgIiIiQ29weSBleHRlbmRlZCBmaWxlc3lzdGVtIGF0dHJpYnV0ZXMgZnJvbSBgc3JjYCB0byBgZHN0YC4KCiAgICAgICAgT3ZlcndyaXRlIGV4aXN0aW5nIGF0dHJpYnV0ZXMuCgogICAgICAgIElmIGBmb2xsb3dfc3ltbGlua3NgIGlzIGZhbHNlLCBzeW1saW5rcyB3b24ndCBiZSBmb2xsb3dlZC4KCiAgICAgICAgIiIiCgogICAgICAgIGZvciBuYW1lIGluIG9zLmxpc3R4YXR0cihzcmMsIGZvbGxvd19zeW1saW5rcz1mb2xsb3dfc3ltbGlua3MpOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IG9zLmdldHhhdHRyKHNyYywgbmFtZSwgZm9sbG93X3N5bWxpbmtzPWZvbGxvd19zeW1saW5rcykKICAgICAgICAgICAgICAgIG9zLnNldHhhdHRyKGRzdCwgbmFtZSwgdmFsdWUsIGZvbGxvd19zeW1saW5rcz1mb2xsb3dfc3ltbGlua3MpCiAgICAgICAgICAgIGV4Y2VwdCBPU0Vycm9yIGFzIGU6CiAgICAgICAgICAgICAgICBpZiBlLmVycm5vIG5vdCBpbiAoZXJybm8uRVBFUk0sIGVycm5vLkVOT1RTVVAsIGVycm5vLkVOT0RBVEEpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlCmVsc2U6CiAgICBkZWYgX2NvcHl4YXR0cigqYXJncywgKiprd2FyZ3MpOgogICAgICAgIHBhc3MKCmRlZiBjb3B5c3RhdChzcmMsIGRzdCwgKiwgZm9sbG93X3N5bWxpbmtzPVRydWUpOgogICAgIiIiQ29weSBhbGwgc3RhdCBpbmZvIChtb2RlIGJpdHMsIGF0aW1lLCBtdGltZSwgZmxhZ3MpIGZyb20gc3JjIHRvIGRzdC4KCiAgICBJZiB0aGUgb3B0aW9uYWwgZmxhZyBgZm9sbG93X3N5bWxpbmtzYCBpcyBub3Qgc2V0LCBzeW1saW5rcyBhcmVuJ3QgZm9sbG93ZWQgaWYgYW5kCiAgICBvbmx5IGlmIGJvdGggYHNyY2AgYW5kIGBkc3RgIGFyZSBzeW1saW5rcy4KCiAgICAiIiIKICAgIGRlZiBfbm9wKCphcmdzLCBucz1Ob25lLCBmb2xsb3dfc3ltbGlua3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgICMgZm9sbG93IHN5bWxpbmtzIChha2EgZG9uJ3Qgbm90IGZvbGxvdyBzeW1saW5rcykKICAgIGZvbGxvdyA9IGZvbGxvd19zeW1saW5rcyBvciBub3QgKG9zLnBhdGguaXNsaW5rKHNyYykgYW5kIG9zLnBhdGguaXNsaW5rKGRzdCkpCiAgICBpZiBmb2xsb3c6CiAgICAgICAgIyB1c2UgdGhlIHJlYWwgZnVuY3Rpb24gaWYgaXQgZXhpc3RzCiAgICAgICAgZGVmIGxvb2t1cChuYW1lKToKICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIob3MsIG5hbWUsIF9ub3ApCiAgICBlbHNlOgogICAgICAgICMgdXNlIHRoZSByZWFsIGZ1bmN0aW9uIG9ubHkgaWYgaXQgZXhpc3RzCiAgICAgICAgIyAqYW5kKiBpdCBzdXBwb3J0cyBmb2xsb3dfc3ltbGlua3MKICAgICAgICBkZWYgbG9va3VwKG5hbWUpOgogICAgICAgICAgICBmbiA9IGdldGF0dHIob3MsIG5hbWUsIF9ub3ApCiAgICAgICAgICAgIGlmIGZuIGluIG9zLnN1cHBvcnRzX2ZvbGxvd19zeW1saW5rczoKICAgICAgICAgICAgICAgIHJldHVybiBmbgogICAgICAgICAgICByZXR1cm4gX25vcAoKICAgIHN0ID0gbG9va3VwKCJzdGF0Iikoc3JjLCBmb2xsb3dfc3ltbGlua3M9Zm9sbG93KQogICAgbW9kZSA9IHN0YXQuU19JTU9ERShzdC5zdF9tb2RlKQogICAgbG9va3VwKCJ1dGltZSIpKGRzdCwgbnM9KHN0LnN0X2F0aW1lX25zLCBzdC5zdF9tdGltZV9ucyksCiAgICAgICAgZm9sbG93X3N5bWxpbmtzPWZvbGxvdykKICAgIHRyeToKICAgICAgICBsb29rdXAoImNobW9kIikoZHN0LCBtb2RlLCBmb2xsb3dfc3ltbGlua3M9Zm9sbG93KQogICAgZXhjZXB0IE5vdEltcGxlbWVudGVkRXJyb3I6CiAgICAgICAgIyBpZiB3ZSBnb3QgYSBOb3RJbXBsZW1lbnRlZEVycm9yLCBpdCdzIGJlY2F1c2UKICAgICAgICAjICAgKiBmb2xsb3dfc3ltbGlua3M9RmFsc2UsCiAgICAgICAgIyAgICogbGNob3duKCkgaXMgdW5hdmFpbGFibGUsIGFuZAogICAgICAgICMgICAqIGVpdGhlcgogICAgICAgICMgICAgICAgKiBmY2hvd25hdCgpIGlzIHVudmFpbGFibGUgb3IKICAgICAgICAjICAgICAgICogZmNob3duYXQoKSBkb2Vzbid0IGltcGxlbWVudCBBVF9TWU1MSU5LX05PRk9MTE9XLgogICAgICAgICMgICAgICAgICAoaXQgcmV0dXJuZWQgRU5PU1VQLikKICAgICAgICAjIHRoZXJlZm9yZSB3ZSdyZSBvdXQgb2Ygb3B0aW9ucy0td2Ugc2ltcGx5IGNhbm5vdCBjaG93biB0aGUKICAgICAgICAjIHN5bWxpbmsuICBnaXZlIHVwLCBzdXBwcmVzcyB0aGUgZXJyb3IuCiAgICAgICAgIyAod2hpY2ggaXMgd2hhdCBzaHV0aWwgYWx3YXlzIGRpZCBpbiB0aGlzIGNpcmN1bXN0YW5jZS4pCiAgICAgICAgcGFzcwogICAgaWYgaGFzYXR0cihzdCwgJ3N0X2ZsYWdzJyk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBsb29rdXAoImNoZmxhZ3MiKShkc3QsIHN0LnN0X2ZsYWdzLCBmb2xsb3dfc3ltbGlua3M9Zm9sbG93KQogICAgICAgIGV4Y2VwdCBPU0Vycm9yIGFzIHdoeToKICAgICAgICAgICAgZm9yIGVyciBpbiAnRU9QTk9UU1VQUCcsICdFTk9UU1VQJzoKICAgICAgICAgICAgICAgIGlmIGhhc2F0dHIoZXJybm8sIGVycikgYW5kIHdoeS5lcnJubyA9PSBnZXRhdHRyKGVycm5vLCBlcnIpOgogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgX2NvcHl4YXR0cihzcmMsIGRzdCwgZm9sbG93X3N5bWxpbmtzPWZvbGxvdykKCmRlZiBjb3B5KHNyYywgZHN0LCAqLCBmb2xsb3dfc3ltbGlua3M9VHJ1ZSk6CiAgICAiIiJDb3B5IGRhdGEgYW5kIG1vZGUgYml0cyAoImNwIHNyYyBkc3QiKS4gUmV0dXJuIHRoZSBmaWxlJ3MgZGVzdGluYXRpb24uCgogICAgVGhlIGRlc3RpbmF0aW9uIG1heSBiZSBhIGRpcmVjdG9yeS4KCiAgICBJZiBmb2xsb3dfc3ltbGlua3MgaXMgZmFsc2UsIHN5bWxpbmtzIHdvbid0IGJlIGZvbGxvd2VkLiBUaGlzCiAgICByZXNlbWJsZXMgR05VJ3MgImNwIC1QIHNyYyBkc3QiLgoKICAgICIiIgogICAgaWYgb3MucGF0aC5pc2Rpcihkc3QpOgogICAgICAgIGRzdCA9IG9zLnBhdGguam9pbihkc3QsIG9zLnBhdGguYmFzZW5hbWUoc3JjKSkKICAgIGNvcHlmaWxlKHNyYywgZHN0LCBmb2xsb3dfc3ltbGlua3M9Zm9sbG93X3N5bWxpbmtzKQogICAgY29weW1vZGUoc3JjLCBkc3QsIGZvbGxvd19zeW1saW5rcz1mb2xsb3dfc3ltbGlua3MpCiAgICByZXR1cm4gZHN0CgpkZWYgY29weTIoc3JjLCBkc3QsICosIGZvbGxvd19zeW1saW5rcz1UcnVlKToKICAgICIiIkNvcHkgZGF0YSBhbmQgYWxsIHN0YXQgaW5mbyAoImNwIC1wIHNyYyBkc3QiKS4gUmV0dXJuIHRoZSBmaWxlJ3MKICAgIGRlc3RpbmF0aW9uLiIKCiAgICBUaGUgZGVzdGluYXRpb24gbWF5IGJlIGEgZGlyZWN0b3J5LgoKICAgIElmIGZvbGxvd19zeW1saW5rcyBpcyBmYWxzZSwgc3ltbGlua3Mgd29uJ3QgYmUgZm9sbG93ZWQuIFRoaXMKICAgIHJlc2VtYmxlcyBHTlUncyAiY3AgLVAgc3JjIGRzdCIuCgogICAgIiIiCiAgICBpZiBvcy5wYXRoLmlzZGlyKGRzdCk6CiAgICAgICAgZHN0ID0gb3MucGF0aC5qb2luKGRzdCwgb3MucGF0aC5iYXNlbmFtZShzcmMpKQogICAgY29weWZpbGUoc3JjLCBkc3QsIGZvbGxvd19zeW1saW5rcz1mb2xsb3dfc3ltbGlua3MpCiAgICBjb3B5c3RhdChzcmMsIGRzdCwgZm9sbG93X3N5bWxpbmtzPWZvbGxvd19zeW1saW5rcykKICAgIHJldHVybiBkc3QKCmRlZiBpZ25vcmVfcGF0dGVybnMoKnBhdHRlcm5zKToKICAgICIiIkZ1bmN0aW9uIHRoYXQgY2FuIGJlIHVzZWQgYXMgY29weXRyZWUoKSBpZ25vcmUgcGFyYW1ldGVyLgoKICAgIFBhdHRlcm5zIGlzIGEgc2VxdWVuY2Ugb2YgZ2xvYi1zdHlsZSBwYXR0ZXJucwogICAgdGhhdCBhcmUgdXNlZCB0byBleGNsdWRlIGZpbGVzIiIiCiAgICBkZWYgX2lnbm9yZV9wYXR0ZXJucyhwYXRoLCBuYW1lcyk6CiAgICAgICAgaWdub3JlZF9uYW1lcyA9IFtdCiAgICAgICAgZm9yIHBhdHRlcm4gaW4gcGF0dGVybnM6CiAgICAgICAgICAgIGlnbm9yZWRfbmFtZXMuZXh0ZW5kKGZubWF0Y2guZmlsdGVyKG5hbWVzLCBwYXR0ZXJuKSkKICAgICAgICByZXR1cm4gc2V0KGlnbm9yZWRfbmFtZXMpCiAgICByZXR1cm4gX2lnbm9yZV9wYXR0ZXJucwoKZGVmIGNvcHl0cmVlKHNyYywgZHN0LCBzeW1saW5rcz1GYWxzZSwgaWdub3JlPU5vbmUsIGNvcHlfZnVuY3Rpb249Y29weTIsCiAgICAgICAgICAgICBpZ25vcmVfZGFuZ2xpbmdfc3ltbGlua3M9RmFsc2UpOgogICAgIiIiUmVjdXJzaXZlbHkgY29weSBhIGRpcmVjdG9yeSB0cmVlLgoKICAgIFRoZSBkZXN0aW5hdGlvbiBkaXJlY3RvcnkgbXVzdCBub3QgYWxyZWFkeSBleGlzdC4KICAgIElmIGV4Y2VwdGlvbihzKSBvY2N1ciwgYW4gRXJyb3IgaXMgcmFpc2VkIHdpdGggYSBsaXN0IG9mIHJlYXNvbnMuCgogICAgSWYgdGhlIG9wdGlvbmFsIHN5bWxpbmtzIGZsYWcgaXMgdHJ1ZSwgc3ltYm9saWMgbGlua3MgaW4gdGhlCiAgICBzb3VyY2UgdHJlZSByZXN1bHQgaW4gc3ltYm9saWMgbGlua3MgaW4gdGhlIGRlc3RpbmF0aW9uIHRyZWU7IGlmCiAgICBpdCBpcyBmYWxzZSwgdGhlIGNvbnRlbnRzIG9mIHRoZSBmaWxlcyBwb2ludGVkIHRvIGJ5IHN5bWJvbGljCiAgICBsaW5rcyBhcmUgY29waWVkLiBJZiB0aGUgZmlsZSBwb2ludGVkIGJ5IHRoZSBzeW1saW5rIGRvZXNuJ3QKICAgIGV4aXN0LCBhbiBleGNlcHRpb24gd2lsbCBiZSBhZGRlZCBpbiB0aGUgbGlzdCBvZiBlcnJvcnMgcmFpc2VkIGluCiAgICBhbiBFcnJvciBleGNlcHRpb24gYXQgdGhlIGVuZCBvZiB0aGUgY29weSBwcm9jZXNzLgoKICAgIFlvdSBjYW4gc2V0IHRoZSBvcHRpb25hbCBpZ25vcmVfZGFuZ2xpbmdfc3ltbGlua3MgZmxhZyB0byB0cnVlIGlmIHlvdQogICAgd2FudCB0byBzaWxlbmNlIHRoaXMgZXhjZXB0aW9uLiBOb3RpY2UgdGhhdCB0aGlzIGhhcyBubyBlZmZlY3Qgb24KICAgIHBsYXRmb3JtcyB0aGF0IGRvbid0IHN1cHBvcnQgb3Muc3ltbGluay4KCiAgICBUaGUgb3B0aW9uYWwgaWdub3JlIGFyZ3VtZW50IGlzIGEgY2FsbGFibGUuIElmIGdpdmVuLCBpdAogICAgaXMgY2FsbGVkIHdpdGggdGhlIGBzcmNgIHBhcmFtZXRlciwgd2hpY2ggaXMgdGhlIGRpcmVjdG9yeQogICAgYmVpbmcgdmlzaXRlZCBieSBjb3B5dHJlZSgpLCBhbmQgYG5hbWVzYCB3aGljaCBpcyB0aGUgbGlzdCBvZgogICAgYHNyY2AgY29udGVudHMsIGFzIHJldHVybmVkIGJ5IG9zLmxpc3RkaXIoKToKCiAgICAgICAgY2FsbGFibGUoc3JjLCBuYW1lcykgLT4gaWdub3JlZF9uYW1lcwoKICAgIFNpbmNlIGNvcHl0cmVlKCkgaXMgY2FsbGVkIHJlY3Vyc2l2ZWx5LCB0aGUgY2FsbGFibGUgd2lsbCBiZQogICAgY2FsbGVkIG9uY2UgZm9yIGVhY2ggZGlyZWN0b3J5IHRoYXQgaXMgY29waWVkLiBJdCByZXR1cm5zIGEKICAgIGxpc3Qgb2YgbmFtZXMgcmVsYXRpdmUgdG8gdGhlIGBzcmNgIGRpcmVjdG9yeSB0aGF0IHNob3VsZAogICAgbm90IGJlIGNvcGllZC4KCiAgICBUaGUgb3B0aW9uYWwgY29weV9mdW5jdGlvbiBhcmd1bWVudCBpcyBhIGNhbGxhYmxlIHRoYXQgd2lsbCBiZSB1c2VkCiAgICB0byBjb3B5IGVhY2ggZmlsZS4gSXQgd2lsbCBiZSBjYWxsZWQgd2l0aCB0aGUgc291cmNlIHBhdGggYW5kIHRoZQogICAgZGVzdGluYXRpb24gcGF0aCBhcyBhcmd1bWVudHMuIEJ5IGRlZmF1bHQsIGNvcHkyKCkgaXMgdXNlZCwgYnV0IGFueQogICAgZnVuY3Rpb24gdGhhdCBzdXBwb3J0cyB0aGUgc2FtZSBzaWduYXR1cmUgKGxpa2UgY29weSgpKSBjYW4gYmUgdXNlZC4KCiAgICAiIiIKICAgIG5hbWVzID0gb3MubGlzdGRpcihzcmMpCiAgICBpZiBpZ25vcmUgaXMgbm90IE5vbmU6CiAgICAgICAgaWdub3JlZF9uYW1lcyA9IGlnbm9yZShzcmMsIG5hbWVzKQogICAgZWxzZToKICAgICAgICBpZ25vcmVkX25hbWVzID0gc2V0KCkKCiAgICBvcy5tYWtlZGlycyhkc3QpCiAgICBlcnJvcnMgPSBbXQogICAgZm9yIG5hbWUgaW4gbmFtZXM6CiAgICAgICAgaWYgbmFtZSBpbiBpZ25vcmVkX25hbWVzOgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIHNyY25hbWUgPSBvcy5wYXRoLmpvaW4oc3JjLCBuYW1lKQogICAgICAgIGRzdG5hbWUgPSBvcy5wYXRoLmpvaW4oZHN0LCBuYW1lKQogICAgICAgIHRyeToKICAgICAgICAgICAgaWYgb3MucGF0aC5pc2xpbmsoc3JjbmFtZSk6CiAgICAgICAgICAgICAgICBsaW5rdG8gPSBvcy5yZWFkbGluayhzcmNuYW1lKQogICAgICAgICAgICAgICAgaWYgc3ltbGlua3M6CiAgICAgICAgICAgICAgICAgICAgIyBXZSBjYW4ndCBqdXN0IGxlYXZlIGl0IHRvIGBjb3B5X2Z1bmN0aW9uYCBiZWNhdXNlIGxlZ2FjeQogICAgICAgICAgICAgICAgICAgICMgY29kZSB3aXRoIGEgY3VzdG9tIGBjb3B5X2Z1bmN0aW9uYCBtYXkgcmVseSBvbiBjb3B5dHJlZQogICAgICAgICAgICAgICAgICAgICMgZG9pbmcgdGhlIHJpZ2h0IHRoaW5nLgogICAgICAgICAgICAgICAgICAgIG9zLnN5bWxpbmsobGlua3RvLCBkc3RuYW1lKQogICAgICAgICAgICAgICAgICAgIGNvcHlzdGF0KHNyY25hbWUsIGRzdG5hbWUsIGZvbGxvd19zeW1saW5rcz1ub3Qgc3ltbGlua3MpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICMgaWdub3JlIGRhbmdsaW5nIHN5bWxpbmsgaWYgdGhlIGZsYWcgaXMgb24KICAgICAgICAgICAgICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMobGlua3RvKSBhbmQgaWdub3JlX2RhbmdsaW5nX3N5bWxpbmtzOgogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgICAgICMgb3RoZXJ3aXNlIGxldCB0aGUgY29weSBvY2N1cnMuIGNvcHkyIHdpbGwgcmFpc2UgYW4gZXJyb3IKICAgICAgICAgICAgICAgICAgICBjb3B5X2Z1bmN0aW9uKHNyY25hbWUsIGRzdG5hbWUpCiAgICAgICAgICAgIGVsaWYgb3MucGF0aC5pc2RpcihzcmNuYW1lKToKICAgICAgICAgICAgICAgIGNvcHl0cmVlKHNyY25hbWUsIGRzdG5hbWUsIHN5bWxpbmtzLCBpZ25vcmUsIGNvcHlfZnVuY3Rpb24pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAjIFdpbGwgcmFpc2UgYSBTcGVjaWFsRmlsZUVycm9yIGZvciB1bnN1cHBvcnRlZCBmaWxlIHR5cGVzCiAgICAgICAgICAgICAgICBjb3B5X2Z1bmN0aW9uKHNyY25hbWUsIGRzdG5hbWUpCiAgICAgICAgIyBjYXRjaCB0aGUgRXJyb3IgZnJvbSB0aGUgcmVjdXJzaXZlIGNvcHl0cmVlIHNvIHRoYXQgd2UgY2FuCiAgICAgICAgIyBjb250aW51ZSB3aXRoIG90aGVyIGZpbGVzCiAgICAgICAgZXhjZXB0IEVycm9yIGFzIGVycjoKICAgICAgICAgICAgZXJyb3JzLmV4dGVuZChlcnIuYXJnc1swXSkKICAgICAgICBleGNlcHQgRW52aXJvbm1lbnRFcnJvciBhcyB3aHk6CiAgICAgICAgICAgIGVycm9ycy5hcHBlbmQoKHNyY25hbWUsIGRzdG5hbWUsIHN0cih3aHkpKSkKICAgIHRyeToKICAgICAgICBjb3B5c3RhdChzcmMsIGRzdCkKICAgIGV4Y2VwdCBPU0Vycm9yIGFzIHdoeToKICAgICAgICBpZiBXaW5kb3dzRXJyb3IgaXMgbm90IE5vbmUgYW5kIGlzaW5zdGFuY2Uod2h5LCBXaW5kb3dzRXJyb3IpOgogICAgICAgICAgICAjIENvcHlpbmcgZmlsZSBhY2Nlc3MgdGltZXMgbWF5IGZhaWwgb24gV2luZG93cwogICAgICAgICAgICBwYXNzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZXJyb3JzLmFwcGVuZCgoc3JjLCBkc3QsIHN0cih3aHkpKSkKICAgIGlmIGVycm9yczoKICAgICAgICByYWlzZSBFcnJvcihlcnJvcnMpCiAgICByZXR1cm4gZHN0CgojIHZlcnNpb24gdnVsbmVyYWJsZSB0byByYWNlIGNvbmRpdGlvbnMKZGVmIF9ybXRyZWVfdW5zYWZlKHBhdGgsIG9uZXJyb3IpOgogICAgdHJ5OgogICAgICAgIGlmIG9zLnBhdGguaXNsaW5rKHBhdGgpOgogICAgICAgICAgICAjIHN5bWxpbmtzIHRvIGRpcmVjdG9yaWVzIGFyZSBmb3JiaWRkZW4sIHNlZSBidWcgIzE2NjkKICAgICAgICAgICAgcmFpc2UgT1NFcnJvcigiQ2Fubm90IGNhbGwgcm10cmVlIG9uIGEgc3ltYm9saWMgbGluayIpCiAgICBleGNlcHQgT1NFcnJvcjoKICAgICAgICBvbmVycm9yKG9zLnBhdGguaXNsaW5rLCBwYXRoLCBzeXMuZXhjX2luZm8oKSkKICAgICAgICAjIGNhbid0IGNvbnRpbnVlIGV2ZW4gaWYgb25lcnJvciBob29rIHJldHVybnMKICAgICAgICByZXR1cm4KICAgIG5hbWVzID0gW10KICAgIHRyeToKICAgICAgICBuYW1lcyA9IG9zLmxpc3RkaXIocGF0aCkKICAgIGV4Y2VwdCBvcy5lcnJvcjoKICAgICAgICBvbmVycm9yKG9zLmxpc3RkaXIsIHBhdGgsIHN5cy5leGNfaW5mbygpKQogICAgZm9yIG5hbWUgaW4gbmFtZXM6CiAgICAgICAgZnVsbG5hbWUgPSBvcy5wYXRoLmpvaW4ocGF0aCwgbmFtZSkKICAgICAgICB0cnk6CiAgICAgICAgICAgIG1vZGUgPSBvcy5sc3RhdChmdWxsbmFtZSkuc3RfbW9kZQogICAgICAgIGV4Y2VwdCBvcy5lcnJvcjoKICAgICAgICAgICAgbW9kZSA9IDAKICAgICAgICBpZiBzdGF0LlNfSVNESVIobW9kZSk6CiAgICAgICAgICAgIF9ybXRyZWVfdW5zYWZlKGZ1bGxuYW1lLCBvbmVycm9yKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIG9zLnVubGluayhmdWxsbmFtZSkKICAgICAgICAgICAgZXhjZXB0IG9zLmVycm9yOgogICAgICAgICAgICAgICAgb25lcnJvcihvcy51bmxpbmssIGZ1bGxuYW1lLCBzeXMuZXhjX2luZm8oKSkKICAgIHRyeToKICAgICAgICBvcy5ybWRpcihwYXRoKQogICAgZXhjZXB0IG9zLmVycm9yOgogICAgICAgIG9uZXJyb3Iob3Mucm1kaXIsIHBhdGgsIHN5cy5leGNfaW5mbygpKQoKIyBWZXJzaW9uIHVzaW5nIGZkLWJhc2VkIEFQSXMgdG8gcHJvdGVjdCBhZ2FpbnN0IHJhY2VzCmRlZiBfcm10cmVlX3NhZmVfZmQodG9wZmQsIHBhdGgsIG9uZXJyb3IpOgogICAgbmFtZXMgPSBbXQogICAgdHJ5OgogICAgICAgIG5hbWVzID0gb3MubGlzdGRpcih0b3BmZCkKICAgIGV4Y2VwdCBvcy5lcnJvcjoKICAgICAgICBvbmVycm9yKG9zLmxpc3RkaXIsIHBhdGgsIHN5cy5leGNfaW5mbygpKQogICAgZm9yIG5hbWUgaW4gbmFtZXM6CiAgICAgICAgZnVsbG5hbWUgPSBvcy5wYXRoLmpvaW4ocGF0aCwgbmFtZSkKICAgICAgICB0cnk6CiAgICAgICAgICAgIG9yaWdfc3QgPSBvcy5zdGF0KG5hbWUsIGRpcl9mZD10b3BmZCwgZm9sbG93X3N5bWxpbmtzPUZhbHNlKQogICAgICAgICAgICBtb2RlID0gb3JpZ19zdC5zdF9tb2RlCiAgICAgICAgZXhjZXB0IG9zLmVycm9yOgogICAgICAgICAgICBtb2RlID0gMAogICAgICAgIGlmIHN0YXQuU19JU0RJUihtb2RlKToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZGlyZmQgPSBvcy5vcGVuKG5hbWUsIG9zLk9fUkRPTkxZLCBkaXJfZmQ9dG9wZmQpCiAgICAgICAgICAgIGV4Y2VwdCBvcy5lcnJvcjoKICAgICAgICAgICAgICAgIG9uZXJyb3Iob3Mub3BlbiwgZnVsbG5hbWUsIHN5cy5leGNfaW5mbygpKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguc2FtZXN0YXQob3JpZ19zdCwgb3MuZnN0YXQoZGlyZmQpKToKICAgICAgICAgICAgICAgICAgICAgICAgX3JtdHJlZV9zYWZlX2ZkKGRpcmZkLCBmdWxsbmFtZSwgb25lcnJvcikKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3Mucm1kaXIobmFtZSwgZGlyX2ZkPXRvcGZkKQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQgb3MuZXJyb3I6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbmVycm9yKG9zLnJtZGlyLCBmdWxsbmFtZSwgc3lzLmV4Y19pbmZvKCkpCiAgICAgICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgICAgIG9zLmNsb3NlKGRpcmZkKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIG9zLnVubGluayhuYW1lLCBkaXJfZmQ9dG9wZmQpCiAgICAgICAgICAgIGV4Y2VwdCBvcy5lcnJvcjoKICAgICAgICAgICAgICAgIG9uZXJyb3Iob3MudW5saW5rLCBmdWxsbmFtZSwgc3lzLmV4Y19pbmZvKCkpCgpfdXNlX2ZkX2Z1bmN0aW9ucyA9ICh7b3Mub3Blbiwgb3Muc3RhdCwgb3MudW5saW5rLCBvcy5ybWRpcn0gPD0KICAgICAgICAgICAgICAgICAgICAgb3Muc3VwcG9ydHNfZGlyX2ZkIGFuZAogICAgICAgICAgICAgICAgICAgICBvcy5saXN0ZGlyIGluIG9zLnN1cHBvcnRzX2ZkIGFuZAogICAgICAgICAgICAgICAgICAgICBvcy5zdGF0IGluIG9zLnN1cHBvcnRzX2ZvbGxvd19zeW1saW5rcykKCmRlZiBybXRyZWUocGF0aCwgaWdub3JlX2Vycm9ycz1GYWxzZSwgb25lcnJvcj1Ob25lKToKICAgICIiIlJlY3Vyc2l2ZWx5IGRlbGV0ZSBhIGRpcmVjdG9yeSB0cmVlLgoKICAgIElmIGlnbm9yZV9lcnJvcnMgaXMgc2V0LCBlcnJvcnMgYXJlIGlnbm9yZWQ7IG90aGVyd2lzZSwgaWYgb25lcnJvcgogICAgaXMgc2V0LCBpdCBpcyBjYWxsZWQgdG8gaGFuZGxlIHRoZSBlcnJvciB3aXRoIGFyZ3VtZW50cyAoZnVuYywKICAgIHBhdGgsIGV4Y19pbmZvKSB3aGVyZSBmdW5jIGlzIHBsYXRmb3JtIGFuZCBpbXBsZW1lbnRhdGlvbiBkZXBlbmRlbnQ7CiAgICBwYXRoIGlzIHRoZSBhcmd1bWVudCB0byB0aGF0IGZ1bmN0aW9uIHRoYXQgY2F1c2VkIGl0IHRvIGZhaWw7IGFuZAogICAgZXhjX2luZm8gaXMgYSB0dXBsZSByZXR1cm5lZCBieSBzeXMuZXhjX2luZm8oKS4gIElmIGlnbm9yZV9lcnJvcnMKICAgIGlzIGZhbHNlIGFuZCBvbmVycm9yIGlzIE5vbmUsIGFuIGV4Y2VwdGlvbiBpcyByYWlzZWQuCgogICAgIiIiCiAgICBpZiBpZ25vcmVfZXJyb3JzOgogICAgICAgIGRlZiBvbmVycm9yKCphcmdzKToKICAgICAgICAgICAgcGFzcwogICAgZWxpZiBvbmVycm9yIGlzIE5vbmU6CiAgICAgICAgZGVmIG9uZXJyb3IoKmFyZ3MpOgogICAgICAgICAgICByYWlzZQogICAgaWYgX3VzZV9mZF9mdW5jdGlvbnM6CiAgICAgICAgIyBXaGlsZSB0aGUgdW5zYWZlIHJtdHJlZSB3b3JrcyBmaW5lIG9uIGJ5dGVzLCB0aGUgZmQgYmFzZWQgZG9lcyBub3QuCiAgICAgICAgaWYgaXNpbnN0YW5jZShwYXRoLCBieXRlcyk6CiAgICAgICAgICAgIHBhdGggPSBvcy5mc2RlY29kZShwYXRoKQogICAgICAgICMgTm90ZTogVG8gZ3VhcmQgYWdhaW5zdCBzeW1saW5rIHJhY2VzLCB3ZSB1c2UgdGhlIHN0YW5kYXJkCiAgICAgICAgIyBsc3RhdCgpL29wZW4oKS9mc3RhdCgpIHRyaWNrLgogICAgICAgIHRyeToKICAgICAgICAgICAgb3JpZ19zdCA9IG9zLmxzdGF0KHBhdGgpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICAgICAgb25lcnJvcihvcy5sc3RhdCwgcGF0aCwgc3lzLmV4Y19pbmZvKCkpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIHRyeToKICAgICAgICAgICAgZmQgPSBvcy5vcGVuKHBhdGgsIG9zLk9fUkRPTkxZKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgIG9uZXJyb3Iob3MubHN0YXQsIHBhdGgsIHN5cy5leGNfaW5mbygpKQogICAgICAgICAgICByZXR1cm4KICAgICAgICB0cnk6CiAgICAgICAgICAgIGlmIChzdGF0LlNfSVNESVIob3JpZ19zdC5zdF9tb2RlKSBhbmQKICAgICAgICAgICAgICAgIG9zLnBhdGguc2FtZXN0YXQob3JpZ19zdCwgb3MuZnN0YXQoZmQpKSk6CiAgICAgICAgICAgICAgICBfcm10cmVlX3NhZmVfZmQoZmQsIHBhdGgsIG9uZXJyb3IpCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgb3Mucm1kaXIocGF0aCkKICAgICAgICAgICAgICAgIGV4Y2VwdCBvcy5lcnJvcjoKICAgICAgICAgICAgICAgICAgICBvbmVycm9yKG9zLnJtZGlyLCBwYXRoLCBzeXMuZXhjX2luZm8oKSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlIE5vdEFEaXJlY3RvcnlFcnJvcigyMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm90IGEgZGlyZWN0b3J5OiAne30nIi5mb3JtYXQocGF0aCkpCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgb3MuY2xvc2UoZmQpCiAgICBlbHNlOgogICAgICAgIHJldHVybiBfcm10cmVlX3Vuc2FmZShwYXRoLCBvbmVycm9yKQoKIyBBbGxvdyBpbnRyb3NwZWN0aW9uIG9mIHdoZXRoZXIgb3Igbm90IHRoZSBoYXJkZW5pbmcgYWdhaW5zdCBzeW1saW5rCiMgYXR0YWNrcyBpcyBzdXBwb3J0ZWQgb24gdGhlIGN1cnJlbnQgcGxhdGZvcm0Kcm10cmVlLmF2b2lkc19zeW1saW5rX2F0dGFja3MgPSBfdXNlX2ZkX2Z1bmN0aW9ucwoKZGVmIF9iYXNlbmFtZShwYXRoKToKICAgICMgQSBiYXNlbmFtZSgpIHZhcmlhbnQgd2hpY2ggZmlyc3Qgc3RyaXBzIHRoZSB0cmFpbGluZyBzbGFzaCwgaWYgcHJlc2VudC4KICAgICMgVGh1cyB3ZSBhbHdheXMgZ2V0IHRoZSBsYXN0IGNvbXBvbmVudCBvZiB0aGUgcGF0aCwgZXZlbiBmb3IgZGlyZWN0b3JpZXMuCiAgICByZXR1cm4gb3MucGF0aC5iYXNlbmFtZShwYXRoLnJzdHJpcChvcy5wYXRoLnNlcCkpCgpkZWYgbW92ZShzcmMsIGRzdCk6CiAgICAiIiJSZWN1cnNpdmVseSBtb3ZlIGEgZmlsZSBvciBkaXJlY3RvcnkgdG8gYW5vdGhlciBsb2NhdGlvbi4gVGhpcyBpcwogICAgc2ltaWxhciB0byB0aGUgVW5peCAibXYiIGNvbW1hbmQuIFJldHVybiB0aGUgZmlsZSBvciBkaXJlY3RvcnkncwogICAgZGVzdGluYXRpb24uCgogICAgSWYgdGhlIGRlc3RpbmF0aW9uIGlzIGEgZGlyZWN0b3J5IG9yIGEgc3ltbGluayB0byBhIGRpcmVjdG9yeSwgdGhlIHNvdXJjZQogICAgaXMgbW92ZWQgaW5zaWRlIHRoZSBkaXJlY3RvcnkuIFRoZSBkZXN0aW5hdGlvbiBwYXRoIG11c3Qgbm90IGFscmVhZHkKICAgIGV4aXN0LgoKICAgIElmIHRoZSBkZXN0aW5hdGlvbiBhbHJlYWR5IGV4aXN0cyBidXQgaXMgbm90IGEgZGlyZWN0b3J5LCBpdCBtYXkgYmUKICAgIG92ZXJ3cml0dGVuIGRlcGVuZGluZyBvbiBvcy5yZW5hbWUoKSBzZW1hbnRpY3MuCgogICAgSWYgdGhlIGRlc3RpbmF0aW9uIGlzIG9uIG91ciBjdXJyZW50IGZpbGVzeXN0ZW0sIHRoZW4gcmVuYW1lKCkgaXMgdXNlZC4KICAgIE90aGVyd2lzZSwgc3JjIGlzIGNvcGllZCB0byB0aGUgZGVzdGluYXRpb24gYW5kIHRoZW4gcmVtb3ZlZC4gU3ltbGlua3MgYXJlCiAgICByZWNyZWF0ZWQgdW5kZXIgdGhlIG5ldyBuYW1lIGlmIG9zLnJlbmFtZSgpIGZhaWxzIGJlY2F1c2Ugb2YgY3Jvc3MKICAgIGZpbGVzeXN0ZW0gcmVuYW1lcy4KCiAgICBBIGxvdCBtb3JlIGNvdWxkIGJlIGRvbmUgaGVyZS4uLiAgQSBsb29rIGF0IGEgbXYuYyBzaG93cyBhIGxvdCBvZgogICAgdGhlIGlzc3VlcyB0aGlzIGltcGxlbWVudGF0aW9uIGdsb3NzZXMgb3Zlci4KCiAgICAiIiIKICAgIHJlYWxfZHN0ID0gZHN0CiAgICBpZiBvcy5wYXRoLmlzZGlyKGRzdCk6CiAgICAgICAgaWYgX3NhbWVmaWxlKHNyYywgZHN0KToKICAgICAgICAgICAgIyBXZSBtaWdodCBiZSBvbiBhIGNhc2UgaW5zZW5zaXRpdmUgZmlsZXN5c3RlbSwKICAgICAgICAgICAgIyBwZXJmb3JtIHRoZSByZW5hbWUgYW55d2F5LgogICAgICAgICAgICBvcy5yZW5hbWUoc3JjLCBkc3QpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICByZWFsX2RzdCA9IG9zLnBhdGguam9pbihkc3QsIF9iYXNlbmFtZShzcmMpKQogICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKHJlYWxfZHN0KToKICAgICAgICAgICAgcmFpc2UgRXJyb3IoIkRlc3RpbmF0aW9uIHBhdGggJyVzJyBhbHJlYWR5IGV4aXN0cyIgJSByZWFsX2RzdCkKICAgIHRyeToKICAgICAgICBvcy5yZW5hbWUoc3JjLCByZWFsX2RzdCkKICAgIGV4Y2VwdCBPU0Vycm9yOgogICAgICAgIGlmIG9zLnBhdGguaXNsaW5rKHNyYyk6CiAgICAgICAgICAgIGxpbmt0byA9IG9zLnJlYWRsaW5rKHNyYykKICAgICAgICAgICAgb3Muc3ltbGluayhsaW5rdG8sIHJlYWxfZHN0KQogICAgICAgICAgICBvcy51bmxpbmsoc3JjKQogICAgICAgIGVsaWYgb3MucGF0aC5pc2RpcihzcmMpOgogICAgICAgICAgICBpZiBfZGVzdGluc3JjKHNyYywgZHN0KToKICAgICAgICAgICAgICAgIHJhaXNlIEVycm9yKCJDYW5ub3QgbW92ZSBhIGRpcmVjdG9yeSAnJXMnIGludG8gaXRzZWxmICclcycuIiAlIChzcmMsIGRzdCkpCiAgICAgICAgICAgIGNvcHl0cmVlKHNyYywgcmVhbF9kc3QsIHN5bWxpbmtzPVRydWUpCiAgICAgICAgICAgIHJtdHJlZShzcmMpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY29weTIoc3JjLCByZWFsX2RzdCkKICAgICAgICAgICAgb3MudW5saW5rKHNyYykKICAgIHJldHVybiByZWFsX2RzdAoKZGVmIF9kZXN0aW5zcmMoc3JjLCBkc3QpOgogICAgc3JjID0gYWJzcGF0aChzcmMpCiAgICBkc3QgPSBhYnNwYXRoKGRzdCkKICAgIGlmIG5vdCBzcmMuZW5kc3dpdGgob3MucGF0aC5zZXApOgogICAgICAgIHNyYyArPSBvcy5wYXRoLnNlcAogICAgaWYgbm90IGRzdC5lbmRzd2l0aChvcy5wYXRoLnNlcCk6CiAgICAgICAgZHN0ICs9IG9zLnBhdGguc2VwCiAgICByZXR1cm4gZHN0LnN0YXJ0c3dpdGgoc3JjKQoKZGVmIF9nZXRfZ2lkKG5hbWUpOgogICAgIiIiUmV0dXJucyBhIGdpZCwgZ2l2ZW4gYSBncm91cCBuYW1lLiIiIgogICAgaWYgZ2V0Z3JuYW0gaXMgTm9uZSBvciBuYW1lIGlzIE5vbmU6CiAgICAgICAgcmV0dXJuIE5vbmUKICAgIHRyeToKICAgICAgICByZXN1bHQgPSBnZXRncm5hbShuYW1lKQogICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgIHJlc3VsdCA9IE5vbmUKICAgIGlmIHJlc3VsdCBpcyBub3QgTm9uZToKICAgICAgICByZXR1cm4gcmVzdWx0WzJdCiAgICByZXR1cm4gTm9uZQoKZGVmIF9nZXRfdWlkKG5hbWUpOgogICAgIiIiUmV0dXJucyBhbiB1aWQsIGdpdmVuIGEgdXNlciBuYW1lLiIiIgogICAgaWYgZ2V0cHduYW0gaXMgTm9uZSBvciBuYW1lIGlzIE5vbmU6CiAgICAgICAgcmV0dXJuIE5vbmUKICAgIHRyeToKICAgICAgICByZXN1bHQgPSBnZXRwd25hbShuYW1lKQogICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgIHJlc3VsdCA9IE5vbmUKICAgIGlmIHJlc3VsdCBpcyBub3QgTm9uZToKICAgICAgICByZXR1cm4gcmVzdWx0WzJdCiAgICByZXR1cm4gTm9uZQoKZGVmIF9tYWtlX3RhcmJhbGwoYmFzZV9uYW1lLCBiYXNlX2RpciwgY29tcHJlc3M9Imd6aXAiLCB2ZXJib3NlPTAsIGRyeV9ydW49MCwKICAgICAgICAgICAgICAgICAgb3duZXI9Tm9uZSwgZ3JvdXA9Tm9uZSwgbG9nZ2VyPU5vbmUpOgogICAgIiIiQ3JlYXRlIGEgKHBvc3NpYmx5IGNvbXByZXNzZWQpIHRhciBmaWxlIGZyb20gYWxsIHRoZSBmaWxlcyB1bmRlcgogICAgJ2Jhc2VfZGlyJy4KCiAgICAnY29tcHJlc3MnIG11c3QgYmUgImd6aXAiICh0aGUgZGVmYXVsdCksICJiemlwMiIsIG9yIE5vbmUuCgogICAgJ293bmVyJyBhbmQgJ2dyb3VwJyBjYW4gYmUgdXNlZCB0byBkZWZpbmUgYW4gb3duZXIgYW5kIGEgZ3JvdXAgZm9yIHRoZQogICAgYXJjaGl2ZSB0aGF0IGlzIGJlaW5nIGJ1aWx0LiBJZiBub3QgcHJvdmlkZWQsIHRoZSBjdXJyZW50IG93bmVyIGFuZCBncm91cAogICAgd2lsbCBiZSB1c2VkLgoKICAgIFRoZSBvdXRwdXQgdGFyIGZpbGUgd2lsbCBiZSBuYW1lZCAnYmFzZV9uYW1lJyArICAiLnRhciIsIHBvc3NpYmx5IHBsdXMKICAgIHRoZSBhcHByb3ByaWF0ZSBjb21wcmVzc2lvbiBleHRlbnNpb24gKCIuZ3oiLCBvciAiLmJ6MiIpLgoKICAgIFJldHVybnMgdGhlIG91dHB1dCBmaWxlbmFtZS4KICAgICIiIgogICAgdGFyX2NvbXByZXNzaW9uID0geydnemlwJzogJ2d6JywgTm9uZTogJyd9CiAgICBjb21wcmVzc19leHQgPSB7J2d6aXAnOiAnLmd6J30KCiAgICBpZiBfQloyX1NVUFBPUlRFRDoKICAgICAgICB0YXJfY29tcHJlc3Npb25bJ2J6aXAyJ10gPSAnYnoyJwogICAgICAgIGNvbXByZXNzX2V4dFsnYnppcDInXSA9ICcuYnoyJwoKICAgICMgZmxhZ3MgZm9yIGNvbXByZXNzaW9uIHByb2dyYW0sIGVhY2ggZWxlbWVudCBvZiBsaXN0IHdpbGwgYmUgYW4gYXJndW1lbnQKICAgIGlmIGNvbXByZXNzIGlzIG5vdCBOb25lIGFuZCBjb21wcmVzcyBub3QgaW4gY29tcHJlc3NfZXh0OgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImJhZCB2YWx1ZSBmb3IgJ2NvbXByZXNzJywgb3IgY29tcHJlc3Npb24gZm9ybWF0IG5vdCAiCiAgICAgICAgICAgICAgICAgICAgICAgICAic3VwcG9ydGVkIDogezB9Ii5mb3JtYXQoY29tcHJlc3MpKQoKICAgIGFyY2hpdmVfbmFtZSA9IGJhc2VfbmFtZSArICcudGFyJyArIGNvbXByZXNzX2V4dC5nZXQoY29tcHJlc3MsICcnKQogICAgYXJjaGl2ZV9kaXIgPSBvcy5wYXRoLmRpcm5hbWUoYXJjaGl2ZV9uYW1lKQoKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhhcmNoaXZlX2Rpcik6CiAgICAgICAgaWYgbG9nZ2VyIGlzIG5vdCBOb25lOgogICAgICAgICAgICBsb2dnZXIuaW5mbygiY3JlYXRpbmcgJXMiLCBhcmNoaXZlX2RpcikKICAgICAgICBpZiBub3QgZHJ5X3J1bjoKICAgICAgICAgICAgb3MubWFrZWRpcnMoYXJjaGl2ZV9kaXIpCgogICAgIyBjcmVhdGluZyB0aGUgdGFyYmFsbAogICAgaWYgbG9nZ2VyIGlzIG5vdCBOb25lOgogICAgICAgIGxvZ2dlci5pbmZvKCdDcmVhdGluZyB0YXIgYXJjaGl2ZScpCgogICAgdWlkID0gX2dldF91aWQob3duZXIpCiAgICBnaWQgPSBfZ2V0X2dpZChncm91cCkKCiAgICBkZWYgX3NldF91aWRfZ2lkKHRhcmluZm8pOgogICAgICAgIGlmIGdpZCBpcyBub3QgTm9uZToKICAgICAgICAgICAgdGFyaW5mby5naWQgPSBnaWQKICAgICAgICAgICAgdGFyaW5mby5nbmFtZSA9IGdyb3VwCiAgICAgICAgaWYgdWlkIGlzIG5vdCBOb25lOgogICAgICAgICAgICB0YXJpbmZvLnVpZCA9IHVpZAogICAgICAgICAgICB0YXJpbmZvLnVuYW1lID0gb3duZXIKICAgICAgICByZXR1cm4gdGFyaW5mbwoKICAgIGlmIG5vdCBkcnlfcnVuOgogICAgICAgIHRhciA9IHRhcmZpbGUub3BlbihhcmNoaXZlX25hbWUsICd3fCVzJyAlIHRhcl9jb21wcmVzc2lvbltjb21wcmVzc10pCiAgICAgICAgdHJ5OgogICAgICAgICAgICB0YXIuYWRkKGJhc2VfZGlyLCBmaWx0ZXI9X3NldF91aWRfZ2lkKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHRhci5jbG9zZSgpCgogICAgcmV0dXJuIGFyY2hpdmVfbmFtZQoKZGVmIF9jYWxsX2V4dGVybmFsX3ppcChiYXNlX2RpciwgemlwX2ZpbGVuYW1lLCB2ZXJib3NlPUZhbHNlLCBkcnlfcnVuPUZhbHNlKToKICAgICMgWFhYIHNlZSBpZiB3ZSB3YW50IHRvIGtlZXAgYW4gZXh0ZXJuYWwgY2FsbCBoZXJlCiAgICBpZiB2ZXJib3NlOgogICAgICAgIHppcG9wdGlvbnMgPSAiLXIiCiAgICBlbHNlOgogICAgICAgIHppcG9wdGlvbnMgPSAiLXJxIgogICAgZnJvbSBkaXN0dXRpbHMuZXJyb3JzIGltcG9ydCBEaXN0dXRpbHNFeGVjRXJyb3IKICAgIGZyb20gZGlzdHV0aWxzLnNwYXduIGltcG9ydCBzcGF3bgogICAgdHJ5OgogICAgICAgIHNwYXduKFsiemlwIiwgemlwb3B0aW9ucywgemlwX2ZpbGVuYW1lLCBiYXNlX2Rpcl0sIGRyeV9ydW49ZHJ5X3J1bikKICAgIGV4Y2VwdCBEaXN0dXRpbHNFeGVjRXJyb3I6CiAgICAgICAgIyBYWFggcmVhbGx5IHNob3VsZCBkaXN0aW5ndWlzaCBiZXR3ZWVuICJjb3VsZG4ndCBmaW5kCiAgICAgICAgIyBleHRlcm5hbCAnemlwJyBjb21tYW5kIiBhbmQgInppcCBmYWlsZWQiLgogICAgICAgIHJhaXNlIEV4ZWNFcnJvcigidW5hYmxlIHRvIGNyZWF0ZSB6aXAgZmlsZSAnJXMnOiAiCiAgICAgICAgICAgICJjb3VsZCBuZWl0aGVyIGltcG9ydCB0aGUgJ3ppcGZpbGUnIG1vZHVsZSBub3IgIgogICAgICAgICAgICAiZmluZCBhIHN0YW5kYWxvbmUgemlwIHV0aWxpdHkiKSAlIHppcF9maWxlbmFtZQoKZGVmIF9tYWtlX3ppcGZpbGUoYmFzZV9uYW1lLCBiYXNlX2RpciwgdmVyYm9zZT0wLCBkcnlfcnVuPTAsIGxvZ2dlcj1Ob25lKToKICAgICIiIkNyZWF0ZSBhIHppcCBmaWxlIGZyb20gYWxsIHRoZSBmaWxlcyB1bmRlciAnYmFzZV9kaXInLgoKICAgIFRoZSBvdXRwdXQgemlwIGZpbGUgd2lsbCBiZSBuYW1lZCAnYmFzZV9uYW1lJyArICIuemlwIi4gIFVzZXMgZWl0aGVyIHRoZQogICAgInppcGZpbGUiIFB5dGhvbiBtb2R1bGUgKGlmIGF2YWlsYWJsZSkgb3IgdGhlIEluZm9aSVAgInppcCIgdXRpbGl0eQogICAgKGlmIGluc3RhbGxlZCBhbmQgZm91bmQgb24gdGhlIGRlZmF1bHQgc2VhcmNoIHBhdGgpLiAgSWYgbmVpdGhlciB0b29sIGlzCiAgICBhdmFpbGFibGUsIHJhaXNlcyBFeGVjRXJyb3IuICBSZXR1cm5zIHRoZSBuYW1lIG9mIHRoZSBvdXRwdXQgemlwCiAgICBmaWxlLgogICAgIiIiCiAgICB6aXBfZmlsZW5hbWUgPSBiYXNlX25hbWUgKyAiLnppcCIKICAgIGFyY2hpdmVfZGlyID0gb3MucGF0aC5kaXJuYW1lKGJhc2VfbmFtZSkKCiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoYXJjaGl2ZV9kaXIpOgogICAgICAgIGlmIGxvZ2dlciBpcyBub3QgTm9uZToKICAgICAgICAgICAgbG9nZ2VyLmluZm8oImNyZWF0aW5nICVzIiwgYXJjaGl2ZV9kaXIpCiAgICAgICAgaWYgbm90IGRyeV9ydW46CiAgICAgICAgICAgIG9zLm1ha2VkaXJzKGFyY2hpdmVfZGlyKQoKICAgICMgSWYgemlwZmlsZSBtb2R1bGUgaXMgbm90IGF2YWlsYWJsZSwgdHJ5IHNwYXduaW5nIGFuIGV4dGVybmFsICd6aXAnCiAgICAjIGNvbW1hbmQuCiAgICB0cnk6CiAgICAgICAgaW1wb3J0IHppcGZpbGUKICAgIGV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgICAgICB6aXBmaWxlID0gTm9uZQoKICAgIGlmIHppcGZpbGUgaXMgTm9uZToKICAgICAgICBfY2FsbF9leHRlcm5hbF96aXAoYmFzZV9kaXIsIHppcF9maWxlbmFtZSwgdmVyYm9zZSwgZHJ5X3J1bikKICAgIGVsc2U6CiAgICAgICAgaWYgbG9nZ2VyIGlzIG5vdCBOb25lOgogICAgICAgICAgICBsb2dnZXIuaW5mbygiY3JlYXRpbmcgJyVzJyBhbmQgYWRkaW5nICclcycgdG8gaXQiLAogICAgICAgICAgICAgICAgICAgICAgICB6aXBfZmlsZW5hbWUsIGJhc2VfZGlyKQoKICAgICAgICBpZiBub3QgZHJ5X3J1bjoKICAgICAgICAgICAgemlwID0gemlwZmlsZS5aaXBGaWxlKHppcF9maWxlbmFtZSwgInciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcHJlc3Npb249emlwZmlsZS5aSVBfREVGTEFURUQpCgogICAgICAgICAgICBmb3IgZGlycGF0aCwgZGlybmFtZXMsIGZpbGVuYW1lcyBpbiBvcy53YWxrKGJhc2VfZGlyKToKICAgICAgICAgICAgICAgIGZvciBuYW1lIGluIGZpbGVuYW1lczoKICAgICAgICAgICAgICAgICAgICBwYXRoID0gb3MucGF0aC5ub3JtcGF0aChvcy5wYXRoLmpvaW4oZGlycGF0aCwgbmFtZSkpCiAgICAgICAgICAgICAgICAgICAgaWYgb3MucGF0aC5pc2ZpbGUocGF0aCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHppcC53cml0ZShwYXRoLCBwYXRoKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBsb2dnZXIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbygiYWRkaW5nICclcyciLCBwYXRoKQogICAgICAgICAgICB6aXAuY2xvc2UoKQoKICAgIHJldHVybiB6aXBfZmlsZW5hbWUKCl9BUkNISVZFX0ZPUk1BVFMgPSB7CiAgICAnZ3p0YXInOiAoX21ha2VfdGFyYmFsbCwgWygnY29tcHJlc3MnLCAnZ3ppcCcpXSwgImd6aXAnZWQgdGFyLWZpbGUiKSwKICAgICd0YXInOiAgIChfbWFrZV90YXJiYWxsLCBbKCdjb21wcmVzcycsIE5vbmUpXSwgInVuY29tcHJlc3NlZCB0YXIgZmlsZSIpLAogICAgJ3ppcCc6ICAgKF9tYWtlX3ppcGZpbGUsIFtdLCAiWklQIGZpbGUiKQogICAgfQoKaWYgX0JaMl9TVVBQT1JURUQ6CiAgICBfQVJDSElWRV9GT1JNQVRTWydienRhciddID0gKF9tYWtlX3RhcmJhbGwsIFsoJ2NvbXByZXNzJywgJ2J6aXAyJyldLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJiemlwMidlZCB0YXItZmlsZSIpCgpkZWYgZ2V0X2FyY2hpdmVfZm9ybWF0cygpOgogICAgIiIiUmV0dXJucyBhIGxpc3Qgb2Ygc3VwcG9ydGVkIGZvcm1hdHMgZm9yIGFyY2hpdmluZyBhbmQgdW5hcmNoaXZpbmcuCgogICAgRWFjaCBlbGVtZW50IG9mIHRoZSByZXR1cm5lZCBzZXF1ZW5jZSBpcyBhIHR1cGxlIChuYW1lLCBkZXNjcmlwdGlvbikKICAgICIiIgogICAgZm9ybWF0cyA9IFsobmFtZSwgcmVnaXN0cnlbMl0pIGZvciBuYW1lLCByZWdpc3RyeSBpbgogICAgICAgICAgICAgICBfQVJDSElWRV9GT1JNQVRTLml0ZW1zKCldCiAgICBmb3JtYXRzLnNvcnQoKQogICAgcmV0dXJuIGZvcm1hdHMKCmRlZiByZWdpc3Rlcl9hcmNoaXZlX2Zvcm1hdChuYW1lLCBmdW5jdGlvbiwgZXh0cmFfYXJncz1Ob25lLCBkZXNjcmlwdGlvbj0nJyk6CiAgICAiIiJSZWdpc3RlcnMgYW4gYXJjaGl2ZSBmb3JtYXQuCgogICAgbmFtZSBpcyB0aGUgbmFtZSBvZiB0aGUgZm9ybWF0LiBmdW5jdGlvbiBpcyB0aGUgY2FsbGFibGUgdGhhdCB3aWxsIGJlCiAgICB1c2VkIHRvIGNyZWF0ZSBhcmNoaXZlcy4gSWYgcHJvdmlkZWQsIGV4dHJhX2FyZ3MgaXMgYSBzZXF1ZW5jZSBvZgogICAgKG5hbWUsIHZhbHVlKSB0dXBsZXMgdGhhdCB3aWxsIGJlIHBhc3NlZCBhcyBhcmd1bWVudHMgdG8gdGhlIGNhbGxhYmxlLgogICAgZGVzY3JpcHRpb24gY2FuIGJlIHByb3ZpZGVkIHRvIGRlc2NyaWJlIHRoZSBmb3JtYXQsIGFuZCB3aWxsIGJlIHJldHVybmVkCiAgICBieSB0aGUgZ2V0X2FyY2hpdmVfZm9ybWF0cygpIGZ1bmN0aW9uLgogICAgIiIiCiAgICBpZiBleHRyYV9hcmdzIGlzIE5vbmU6CiAgICAgICAgZXh0cmFfYXJncyA9IFtdCiAgICBpZiBub3QgY2FsbGFibGUoZnVuY3Rpb24pOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcignVGhlICVzIG9iamVjdCBpcyBub3QgY2FsbGFibGUnICUgZnVuY3Rpb24pCiAgICBpZiBub3QgaXNpbnN0YW5jZShleHRyYV9hcmdzLCAodHVwbGUsIGxpc3QpKToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ2V4dHJhX2FyZ3MgbmVlZHMgdG8gYmUgYSBzZXF1ZW5jZScpCiAgICBmb3IgZWxlbWVudCBpbiBleHRyYV9hcmdzOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKGVsZW1lbnQsICh0dXBsZSwgbGlzdCkpIG9yIGxlbihlbGVtZW50KSAhPTI6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcignZXh0cmFfYXJncyBlbGVtZW50cyBhcmUgOiAoYXJnX25hbWUsIHZhbHVlKScpCgogICAgX0FSQ0hJVkVfRk9STUFUU1tuYW1lXSA9IChmdW5jdGlvbiwgZXh0cmFfYXJncywgZGVzY3JpcHRpb24pCgpkZWYgdW5yZWdpc3Rlcl9hcmNoaXZlX2Zvcm1hdChuYW1lKToKICAgIGRlbCBfQVJDSElWRV9GT1JNQVRTW25hbWVdCgpkZWYgbWFrZV9hcmNoaXZlKGJhc2VfbmFtZSwgZm9ybWF0LCByb290X2Rpcj1Ob25lLCBiYXNlX2Rpcj1Ob25lLCB2ZXJib3NlPTAsCiAgICAgICAgICAgICAgICAgZHJ5X3J1bj0wLCBvd25lcj1Ob25lLCBncm91cD1Ob25lLCBsb2dnZXI9Tm9uZSk6CiAgICAiIiJDcmVhdGUgYW4gYXJjaGl2ZSBmaWxlIChlZy4gemlwIG9yIHRhcikuCgogICAgJ2Jhc2VfbmFtZScgaXMgdGhlIG5hbWUgb2YgdGhlIGZpbGUgdG8gY3JlYXRlLCBtaW51cyBhbnkgZm9ybWF0LXNwZWNpZmljCiAgICBleHRlbnNpb247ICdmb3JtYXQnIGlzIHRoZSBhcmNoaXZlIGZvcm1hdDogb25lIG9mICJ6aXAiLCAidGFyIiwgImJ6dGFyIgogICAgb3IgImd6dGFyIi4KCiAgICAncm9vdF9kaXInIGlzIGEgZGlyZWN0b3J5IHRoYXQgd2lsbCBiZSB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhlCiAgICBhcmNoaXZlOyBpZS4gd2UgdHlwaWNhbGx5IGNoZGlyIGludG8gJ3Jvb3RfZGlyJyBiZWZvcmUgY3JlYXRpbmcgdGhlCiAgICBhcmNoaXZlLiAgJ2Jhc2VfZGlyJyBpcyB0aGUgZGlyZWN0b3J5IHdoZXJlIHdlIHN0YXJ0IGFyY2hpdmluZyBmcm9tOwogICAgaWUuICdiYXNlX2Rpcicgd2lsbCBiZSB0aGUgY29tbW9uIHByZWZpeCBvZiBhbGwgZmlsZXMgYW5kCiAgICBkaXJlY3RvcmllcyBpbiB0aGUgYXJjaGl2ZS4gICdyb290X2RpcicgYW5kICdiYXNlX2RpcicgYm90aCBkZWZhdWx0CiAgICB0byB0aGUgY3VycmVudCBkaXJlY3RvcnkuICBSZXR1cm5zIHRoZSBuYW1lIG9mIHRoZSBhcmNoaXZlIGZpbGUuCgogICAgJ293bmVyJyBhbmQgJ2dyb3VwJyBhcmUgdXNlZCB3aGVuIGNyZWF0aW5nIGEgdGFyIGFyY2hpdmUuIEJ5IGRlZmF1bHQsCiAgICB1c2VzIHRoZSBjdXJyZW50IG93bmVyIGFuZCBncm91cC4KICAgICIiIgogICAgc2F2ZV9jd2QgPSBvcy5nZXRjd2QoKQogICAgaWYgcm9vdF9kaXIgaXMgbm90IE5vbmU6CiAgICAgICAgaWYgbG9nZ2VyIGlzIG5vdCBOb25lOgogICAgICAgICAgICBsb2dnZXIuZGVidWcoImNoYW5naW5nIGludG8gJyVzJyIsIHJvb3RfZGlyKQogICAgICAgIGJhc2VfbmFtZSA9IG9zLnBhdGguYWJzcGF0aChiYXNlX25hbWUpCiAgICAgICAgaWYgbm90IGRyeV9ydW46CiAgICAgICAgICAgIG9zLmNoZGlyKHJvb3RfZGlyKQoKICAgIGlmIGJhc2VfZGlyIGlzIE5vbmU6CiAgICAgICAgYmFzZV9kaXIgPSBvcy5jdXJkaXIKCiAgICBrd2FyZ3MgPSB7J2RyeV9ydW4nOiBkcnlfcnVuLCAnbG9nZ2VyJzogbG9nZ2VyfQoKICAgIHRyeToKICAgICAgICBmb3JtYXRfaW5mbyA9IF9BUkNISVZFX0ZPUk1BVFNbZm9ybWF0XQogICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoInVua25vd24gYXJjaGl2ZSBmb3JtYXQgJyVzJyIgJSBmb3JtYXQpCgogICAgZnVuYyA9IGZvcm1hdF9pbmZvWzBdCiAgICBmb3IgYXJnLCB2YWwgaW4gZm9ybWF0X2luZm9bMV06CiAgICAgICAga3dhcmdzW2FyZ10gPSB2YWwKCiAgICBpZiBmb3JtYXQgIT0gJ3ppcCc6CiAgICAgICAga3dhcmdzWydvd25lciddID0gb3duZXIKICAgICAgICBrd2FyZ3NbJ2dyb3VwJ10gPSBncm91cAoKICAgIHRyeToKICAgICAgICBmaWxlbmFtZSA9IGZ1bmMoYmFzZV9uYW1lLCBiYXNlX2RpciwgKiprd2FyZ3MpCiAgICBmaW5hbGx5OgogICAgICAgIGlmIHJvb3RfZGlyIGlzIG5vdCBOb25lOgogICAgICAgICAgICBpZiBsb2dnZXIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoImNoYW5naW5nIGJhY2sgdG8gJyVzJyIsIHNhdmVfY3dkKQogICAgICAgICAgICBvcy5jaGRpcihzYXZlX2N3ZCkKCiAgICByZXR1cm4gZmlsZW5hbWUKCgpkZWYgZ2V0X3VucGFja19mb3JtYXRzKCk6CiAgICAiIiJSZXR1cm5zIGEgbGlzdCBvZiBzdXBwb3J0ZWQgZm9ybWF0cyBmb3IgdW5wYWNraW5nLgoKICAgIEVhY2ggZWxlbWVudCBvZiB0aGUgcmV0dXJuZWQgc2VxdWVuY2UgaXMgYSB0dXBsZQogICAgKG5hbWUsIGV4dGVuc2lvbnMsIGRlc2NyaXB0aW9uKQogICAgIiIiCiAgICBmb3JtYXRzID0gWyhuYW1lLCBpbmZvWzBdLCBpbmZvWzNdKSBmb3IgbmFtZSwgaW5mbyBpbgogICAgICAgICAgICAgICBfVU5QQUNLX0ZPUk1BVFMuaXRlbXMoKV0KICAgIGZvcm1hdHMuc29ydCgpCiAgICByZXR1cm4gZm9ybWF0cwoKZGVmIF9jaGVja191bnBhY2tfb3B0aW9ucyhleHRlbnNpb25zLCBmdW5jdGlvbiwgZXh0cmFfYXJncyk6CiAgICAiIiJDaGVja3Mgd2hhdCBnZXRzIHJlZ2lzdGVyZWQgYXMgYW4gdW5wYWNrZXIuIiIiCiAgICAjIGZpcnN0IG1ha2Ugc3VyZSBubyBvdGhlciB1bnBhY2tlciBpcyByZWdpc3RlcmVkIGZvciB0aGlzIGV4dGVuc2lvbgogICAgZXhpc3RpbmdfZXh0ZW5zaW9ucyA9IHt9CiAgICBmb3IgbmFtZSwgaW5mbyBpbiBfVU5QQUNLX0ZPUk1BVFMuaXRlbXMoKToKICAgICAgICBmb3IgZXh0IGluIGluZm9bMF06CiAgICAgICAgICAgIGV4aXN0aW5nX2V4dGVuc2lvbnNbZXh0XSA9IG5hbWUKCiAgICBmb3IgZXh0ZW5zaW9uIGluIGV4dGVuc2lvbnM6CiAgICAgICAgaWYgZXh0ZW5zaW9uIGluIGV4aXN0aW5nX2V4dGVuc2lvbnM6CiAgICAgICAgICAgIG1zZyA9ICclcyBpcyBhbHJlYWR5IHJlZ2lzdGVyZWQgZm9yICIlcyInCiAgICAgICAgICAgIHJhaXNlIFJlZ2lzdHJ5RXJyb3IobXNnICUgKGV4dGVuc2lvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdfZXh0ZW5zaW9uc1tleHRlbnNpb25dKSkKCiAgICBpZiBub3QgY2FsbGFibGUoZnVuY3Rpb24pOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcignVGhlIHJlZ2lzdGVyZWQgZnVuY3Rpb24gbXVzdCBiZSBhIGNhbGxhYmxlJykKCgpkZWYgcmVnaXN0ZXJfdW5wYWNrX2Zvcm1hdChuYW1lLCBleHRlbnNpb25zLCBmdW5jdGlvbiwgZXh0cmFfYXJncz1Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj0nJyk6CiAgICAiIiJSZWdpc3RlcnMgYW4gdW5wYWNrIGZvcm1hdC4KCiAgICBgbmFtZWAgaXMgdGhlIG5hbWUgb2YgdGhlIGZvcm1hdC4gYGV4dGVuc2lvbnNgIGlzIGEgbGlzdCBvZiBleHRlbnNpb25zCiAgICBjb3JyZXNwb25kaW5nIHRvIHRoZSBmb3JtYXQuCgogICAgYGZ1bmN0aW9uYCBpcyB0aGUgY2FsbGFibGUgdGhhdCB3aWxsIGJlCiAgICB1c2VkIHRvIHVucGFjayBhcmNoaXZlcy4gVGhlIGNhbGxhYmxlIHdpbGwgcmVjZWl2ZSBhcmNoaXZlcyB0byB1bnBhY2suCiAgICBJZiBpdCdzIHVuYWJsZSB0byBoYW5kbGUgYW4gYXJjaGl2ZSwgaXQgbmVlZHMgdG8gcmFpc2UgYSBSZWFkRXJyb3IKICAgIGV4Y2VwdGlvbi4KCiAgICBJZiBwcm92aWRlZCwgYGV4dHJhX2FyZ3NgIGlzIGEgc2VxdWVuY2Ugb2YKICAgIChuYW1lLCB2YWx1ZSkgdHVwbGVzIHRoYXQgd2lsbCBiZSBwYXNzZWQgYXMgYXJndW1lbnRzIHRvIHRoZSBjYWxsYWJsZS4KICAgIGRlc2NyaXB0aW9uIGNhbiBiZSBwcm92aWRlZCB0byBkZXNjcmliZSB0aGUgZm9ybWF0LCBhbmQgd2lsbCBiZSByZXR1cm5lZAogICAgYnkgdGhlIGdldF91bnBhY2tfZm9ybWF0cygpIGZ1bmN0aW9uLgogICAgIiIiCiAgICBpZiBleHRyYV9hcmdzIGlzIE5vbmU6CiAgICAgICAgZXh0cmFfYXJncyA9IFtdCiAgICBfY2hlY2tfdW5wYWNrX29wdGlvbnMoZXh0ZW5zaW9ucywgZnVuY3Rpb24sIGV4dHJhX2FyZ3MpCiAgICBfVU5QQUNLX0ZPUk1BVFNbbmFtZV0gPSBleHRlbnNpb25zLCBmdW5jdGlvbiwgZXh0cmFfYXJncywgZGVzY3JpcHRpb24KCmRlZiB1bnJlZ2lzdGVyX3VucGFja19mb3JtYXQobmFtZSk6CiAgICAiIiJSZW1vdmVzIHRoZSBwYWNrIGZvcm1hdCBmcm9tIHRoZSByZWdpc3RlcnkuIiIiCiAgICBkZWwgX1VOUEFDS19GT1JNQVRTW25hbWVdCgpkZWYgX2Vuc3VyZV9kaXJlY3RvcnkocGF0aCk6CiAgICAiIiJFbnN1cmUgdGhhdCB0aGUgcGFyZW50IGRpcmVjdG9yeSBvZiBgcGF0aGAgZXhpc3RzIiIiCiAgICBkaXJuYW1lID0gb3MucGF0aC5kaXJuYW1lKHBhdGgpCiAgICBpZiBub3Qgb3MucGF0aC5pc2RpcihkaXJuYW1lKToKICAgICAgICBvcy5tYWtlZGlycyhkaXJuYW1lKQoKZGVmIF91bnBhY2tfemlwZmlsZShmaWxlbmFtZSwgZXh0cmFjdF9kaXIpOgogICAgIiIiVW5wYWNrIHppcCBgZmlsZW5hbWVgIHRvIGBleHRyYWN0X2RpcmAKICAgICIiIgogICAgdHJ5OgogICAgICAgIGltcG9ydCB6aXBmaWxlCiAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgcmFpc2UgUmVhZEVycm9yKCd6bGliIG5vdCBzdXBwb3J0ZWQsIGNhbm5vdCB1bnBhY2sgdGhpcyBhcmNoaXZlLicpCgogICAgaWYgbm90IHppcGZpbGUuaXNfemlwZmlsZShmaWxlbmFtZSk6CiAgICAgICAgcmFpc2UgUmVhZEVycm9yKCIlcyBpcyBub3QgYSB6aXAgZmlsZSIgJSBmaWxlbmFtZSkKCiAgICB6aXAgPSB6aXBmaWxlLlppcEZpbGUoZmlsZW5hbWUpCiAgICB0cnk6CiAgICAgICAgZm9yIGluZm8gaW4gemlwLmluZm9saXN0KCk6CiAgICAgICAgICAgIG5hbWUgPSBpbmZvLmZpbGVuYW1lCgogICAgICAgICAgICAjIGRvbid0IGV4dHJhY3QgYWJzb2x1dGUgcGF0aHMgb3Igb25lcyB3aXRoIC4uIGluIHRoZW0KICAgICAgICAgICAgaWYgbmFtZS5zdGFydHN3aXRoKCcvJykgb3IgJy4uJyBpbiBuYW1lOgogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIHRhcmdldCA9IG9zLnBhdGguam9pbihleHRyYWN0X2RpciwgKm5hbWUuc3BsaXQoJy8nKSkKICAgICAgICAgICAgaWYgbm90IHRhcmdldDoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBfZW5zdXJlX2RpcmVjdG9yeSh0YXJnZXQpCiAgICAgICAgICAgIGlmIG5vdCBuYW1lLmVuZHN3aXRoKCcvJyk6CiAgICAgICAgICAgICAgICAjIGZpbGUKICAgICAgICAgICAgICAgIGRhdGEgPSB6aXAucmVhZChpbmZvLmZpbGVuYW1lKQogICAgICAgICAgICAgICAgZiA9IG9wZW4odGFyZ2V0LCAnd2InKQogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGYud3JpdGUoZGF0YSkKICAgICAgICAgICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgICAgICAgICAgZi5jbG9zZSgpCiAgICAgICAgICAgICAgICAgICAgZGVsIGRhdGEKICAgIGZpbmFsbHk6CiAgICAgICAgemlwLmNsb3NlKCkKCmRlZiBfdW5wYWNrX3RhcmZpbGUoZmlsZW5hbWUsIGV4dHJhY3RfZGlyKToKICAgICIiIlVucGFjayB0YXIvdGFyLmd6L3Rhci5iejIgYGZpbGVuYW1lYCB0byBgZXh0cmFjdF9kaXJgCiAgICAiIiIKICAgIHRyeToKICAgICAgICB0YXJvYmogPSB0YXJmaWxlLm9wZW4oZmlsZW5hbWUpCiAgICBleGNlcHQgdGFyZmlsZS5UYXJFcnJvcjoKICAgICAgICByYWlzZSBSZWFkRXJyb3IoCiAgICAgICAgICAgICIlcyBpcyBub3QgYSBjb21wcmVzc2VkIG9yIHVuY29tcHJlc3NlZCB0YXIgZmlsZSIgJSBmaWxlbmFtZSkKICAgIHRyeToKICAgICAgICB0YXJvYmouZXh0cmFjdGFsbChleHRyYWN0X2RpcikKICAgIGZpbmFsbHk6CiAgICAgICAgdGFyb2JqLmNsb3NlKCkKCl9VTlBBQ0tfRk9STUFUUyA9IHsKICAgICdnenRhcic6IChbJy50YXIuZ3onLCAnLnRneiddLCBfdW5wYWNrX3RhcmZpbGUsIFtdLCAiZ3ppcCdlZCB0YXItZmlsZSIpLAogICAgJ3Rhcic6ICAgKFsnLnRhciddLCBfdW5wYWNrX3RhcmZpbGUsIFtdLCAidW5jb21wcmVzc2VkIHRhciBmaWxlIiksCiAgICAnemlwJzogICAoWycuemlwJ10sIF91bnBhY2tfemlwZmlsZSwgW10sICJaSVAgZmlsZSIpCiAgICB9CgppZiBfQloyX1NVUFBPUlRFRDoKICAgIF9VTlBBQ0tfRk9STUFUU1snYnp0YXInXSA9IChbJy5iejInXSwgX3VucGFja190YXJmaWxlLCBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYnppcDInZWQgdGFyLWZpbGUiKQoKZGVmIF9maW5kX3VucGFja19mb3JtYXQoZmlsZW5hbWUpOgogICAgZm9yIG5hbWUsIGluZm8gaW4gX1VOUEFDS19GT1JNQVRTLml0ZW1zKCk6CiAgICAgICAgZm9yIGV4dGVuc2lvbiBpbiBpbmZvWzBdOgogICAgICAgICAgICBpZiBmaWxlbmFtZS5lbmRzd2l0aChleHRlbnNpb24pOgogICAgICAgICAgICAgICAgcmV0dXJuIG5hbWUKICAgIHJldHVybiBOb25lCgpkZWYgdW5wYWNrX2FyY2hpdmUoZmlsZW5hbWUsIGV4dHJhY3RfZGlyPU5vbmUsIGZvcm1hdD1Ob25lKToKICAgICIiIlVucGFjayBhbiBhcmNoaXZlLgoKICAgIGBmaWxlbmFtZWAgaXMgdGhlIG5hbWUgb2YgdGhlIGFyY2hpdmUuCgogICAgYGV4dHJhY3RfZGlyYCBpcyB0aGUgbmFtZSBvZiB0aGUgdGFyZ2V0IGRpcmVjdG9yeSwgd2hlcmUgdGhlIGFyY2hpdmUKICAgIGlzIHVucGFja2VkLiBJZiBub3QgcHJvdmlkZWQsIHRoZSBjdXJyZW50IHdvcmtpbmcgZGlyZWN0b3J5IGlzIHVzZWQuCgogICAgYGZvcm1hdGAgaXMgdGhlIGFyY2hpdmUgZm9ybWF0OiBvbmUgb2YgInppcCIsICJ0YXIiLCBvciAiZ3p0YXIiLiBPciBhbnkKICAgIG90aGVyIHJlZ2lzdGVyZWQgZm9ybWF0LiBJZiBub3QgcHJvdmlkZWQsIHVucGFja19hcmNoaXZlIHdpbGwgdXNlIHRoZQogICAgZmlsZW5hbWUgZXh0ZW5zaW9uIGFuZCBzZWUgaWYgYW4gdW5wYWNrZXIgd2FzIHJlZ2lzdGVyZWQgZm9yIHRoYXQKICAgIGV4dGVuc2lvbi4KCiAgICBJbiBjYXNlIG5vbmUgaXMgZm91bmQsIGEgVmFsdWVFcnJvciBpcyByYWlzZWQuCiAgICAiIiIKICAgIGlmIGV4dHJhY3RfZGlyIGlzIE5vbmU6CiAgICAgICAgZXh0cmFjdF9kaXIgPSBvcy5nZXRjd2QoKQoKICAgIGlmIGZvcm1hdCBpcyBub3QgTm9uZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGZvcm1hdF9pbmZvID0gX1VOUEFDS19GT1JNQVRTW2Zvcm1hdF0KICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIlVua25vd24gdW5wYWNrIGZvcm1hdCAnezB9JyIuZm9ybWF0KGZvcm1hdCkpCgogICAgICAgIGZ1bmMgPSBmb3JtYXRfaW5mb1sxXQogICAgICAgIGZ1bmMoZmlsZW5hbWUsIGV4dHJhY3RfZGlyLCAqKmRpY3QoZm9ybWF0X2luZm9bMl0pKQogICAgZWxzZToKICAgICAgICAjIHdlIG5lZWQgdG8gbG9vayBhdCB0aGUgcmVnaXN0ZXJlZCB1bnBhY2tlcnMgc3VwcG9ydGVkIGV4dGVuc2lvbnMKICAgICAgICBmb3JtYXQgPSBfZmluZF91bnBhY2tfZm9ybWF0KGZpbGVuYW1lKQogICAgICAgIGlmIGZvcm1hdCBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBSZWFkRXJyb3IoIlVua25vd24gYXJjaGl2ZSBmb3JtYXQgJ3swfSciLmZvcm1hdChmaWxlbmFtZSkpCgogICAgICAgIGZ1bmMgPSBfVU5QQUNLX0ZPUk1BVFNbZm9ybWF0XVsxXQogICAgICAgIGt3YXJncyA9IGRpY3QoX1VOUEFDS19GT1JNQVRTW2Zvcm1hdF1bMl0pCiAgICAgICAgZnVuYyhmaWxlbmFtZSwgZXh0cmFjdF9kaXIsICoqa3dhcmdzKQoKCmlmIGhhc2F0dHIob3MsICdzdGF0dmZzJyk6CgogICAgX19hbGxfXy5hcHBlbmQoJ2Rpc2tfdXNhZ2UnKQogICAgX250dXBsZV9kaXNrdXNhZ2UgPSBjb2xsZWN0aW9ucy5uYW1lZHR1cGxlKCd1c2FnZScsICd0b3RhbCB1c2VkIGZyZWUnKQoKICAgIGRlZiBkaXNrX3VzYWdlKHBhdGgpOgogICAgICAgICIiIlJldHVybiBkaXNrIHVzYWdlIHN0YXRpc3RpY3MgYWJvdXQgdGhlIGdpdmVuIHBhdGguCgogICAgICAgIFJldHVybmVkIHZhbHVlIGlzIGEgbmFtZWQgdHVwbGUgd2l0aCBhdHRyaWJ1dGVzICd0b3RhbCcsICd1c2VkJyBhbmQKICAgICAgICAnZnJlZScsIHdoaWNoIGFyZSB0aGUgYW1vdW50IG9mIHRvdGFsLCB1c2VkIGFuZCBmcmVlIHNwYWNlLCBpbiBieXRlcy4KICAgICAgICAiIiIKICAgICAgICBzdCA9IG9zLnN0YXR2ZnMocGF0aCkKICAgICAgICBmcmVlID0gc3QuZl9iYXZhaWwgKiBzdC5mX2Zyc2l6ZQogICAgICAgIHRvdGFsID0gc3QuZl9ibG9ja3MgKiBzdC5mX2Zyc2l6ZQogICAgICAgIHVzZWQgPSAoc3QuZl9ibG9ja3MgLSBzdC5mX2JmcmVlKSAqIHN0LmZfZnJzaXplCiAgICAgICAgcmV0dXJuIF9udHVwbGVfZGlza3VzYWdlKHRvdGFsLCB1c2VkLCBmcmVlKQoKZWxpZiBvcy5uYW1lID09ICdudCc6CgogICAgaW1wb3J0IG50CiAgICBfX2FsbF9fLmFwcGVuZCgnZGlza191c2FnZScpCiAgICBfbnR1cGxlX2Rpc2t1c2FnZSA9IGNvbGxlY3Rpb25zLm5hbWVkdHVwbGUoJ3VzYWdlJywgJ3RvdGFsIHVzZWQgZnJlZScpCgogICAgZGVmIGRpc2tfdXNhZ2UocGF0aCk6CiAgICAgICAgIiIiUmV0dXJuIGRpc2sgdXNhZ2Ugc3RhdGlzdGljcyBhYm91dCB0aGUgZ2l2ZW4gcGF0aC4KCiAgICAgICAgUmV0dXJuZWQgdmFsdXMgaXMgYSBuYW1lZCB0dXBsZSB3aXRoIGF0dHJpYnV0ZXMgJ3RvdGFsJywgJ3VzZWQnIGFuZAogICAgICAgICdmcmVlJywgd2hpY2ggYXJlIHRoZSBhbW91bnQgb2YgdG90YWwsIHVzZWQgYW5kIGZyZWUgc3BhY2UsIGluIGJ5dGVzLgogICAgICAgICIiIgogICAgICAgIHRvdGFsLCBmcmVlID0gbnQuX2dldGRpc2t1c2FnZShwYXRoKQogICAgICAgIHVzZWQgPSB0b3RhbCAtIGZyZWUKICAgICAgICByZXR1cm4gX250dXBsZV9kaXNrdXNhZ2UodG90YWwsIHVzZWQsIGZyZWUpCgoKZGVmIGNob3duKHBhdGgsIHVzZXI9Tm9uZSwgZ3JvdXA9Tm9uZSk6CiAgICAiIiJDaGFuZ2Ugb3duZXIgdXNlciBhbmQgZ3JvdXAgb2YgdGhlIGdpdmVuIHBhdGguCgogICAgdXNlciBhbmQgZ3JvdXAgY2FuIGJlIHRoZSB1aWQvZ2lkIG9yIHRoZSB1c2VyL2dyb3VwIG5hbWVzLCBhbmQgaW4gdGhhdCBjYXNlLAogICAgdGhleSBhcmUgY29udmVydGVkIHRvIHRoZWlyIHJlc3BlY3RpdmUgdWlkL2dpZC4KICAgICIiIgoKICAgIGlmIHVzZXIgaXMgTm9uZSBhbmQgZ3JvdXAgaXMgTm9uZToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJ1c2VyIGFuZC9vciBncm91cCBtdXN0IGJlIHNldCIpCgogICAgX3VzZXIgPSB1c2VyCiAgICBfZ3JvdXAgPSBncm91cAoKICAgICMgLTEgbWVhbnMgZG9uJ3QgY2hhbmdlIGl0CiAgICBpZiB1c2VyIGlzIE5vbmU6CiAgICAgICAgX3VzZXIgPSAtMQogICAgIyB1c2VyIGNhbiBlaXRoZXIgYmUgYW4gaW50ICh0aGUgdWlkKSBvciBhIHN0cmluZyAodGhlIHN5c3RlbSB1c2VybmFtZSkKICAgIGVsaWYgaXNpbnN0YW5jZSh1c2VyLCBzdHIpOgogICAgICAgIF91c2VyID0gX2dldF91aWQodXNlcikKICAgICAgICBpZiBfdXNlciBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBMb29rdXBFcnJvcigibm8gc3VjaCB1c2VyOiB7IXJ9Ii5mb3JtYXQodXNlcikpCgogICAgaWYgZ3JvdXAgaXMgTm9uZToKICAgICAgICBfZ3JvdXAgPSAtMQogICAgZWxpZiBub3QgaXNpbnN0YW5jZShncm91cCwgaW50KToKICAgICAgICBfZ3JvdXAgPSBfZ2V0X2dpZChncm91cCkKICAgICAgICBpZiBfZ3JvdXAgaXMgTm9uZToKICAgICAgICAgICAgcmFpc2UgTG9va3VwRXJyb3IoIm5vIHN1Y2ggZ3JvdXA6IHshcn0iLmZvcm1hdChncm91cCkpCgogICAgb3MuY2hvd24ocGF0aCwgX3VzZXIsIF9ncm91cCkKCmRlZiBnZXRfdGVybWluYWxfc2l6ZShmYWxsYmFjaz0oODAsIDI0KSk6CiAgICAiIiJHZXQgdGhlIHNpemUgb2YgdGhlIHRlcm1pbmFsIHdpbmRvdy4KCiAgICBGb3IgZWFjaCBvZiB0aGUgdHdvIGRpbWVuc2lvbnMsIHRoZSBlbnZpcm9ubWVudCB2YXJpYWJsZSwgQ09MVU1OUwogICAgYW5kIExJTkVTIHJlc3BlY3RpdmVseSwgaXMgY2hlY2tlZC4gSWYgdGhlIHZhcmlhYmxlIGlzIGRlZmluZWQgYW5kCiAgICB0aGUgdmFsdWUgaXMgYSBwb3NpdGl2ZSBpbnRlZ2VyLCBpdCBpcyB1c2VkLgoKICAgIFdoZW4gQ09MVU1OUyBvciBMSU5FUyBpcyBub3QgZGVmaW5lZCwgd2hpY2ggaXMgdGhlIGNvbW1vbiBjYXNlLAogICAgdGhlIHRlcm1pbmFsIGNvbm5lY3RlZCB0byBzeXMuX19zdGRvdXRfXyBpcyBxdWVyaWVkCiAgICBieSBpbnZva2luZyBvcy5nZXRfdGVybWluYWxfc2l6ZS4KCiAgICBJZiB0aGUgdGVybWluYWwgc2l6ZSBjYW5ub3QgYmUgc3VjY2Vzc2Z1bGx5IHF1ZXJpZWQsIGVpdGhlciBiZWNhdXNlCiAgICB0aGUgc3lzdGVtIGRvZXNuJ3Qgc3VwcG9ydCBxdWVyeWluZywgb3IgYmVjYXVzZSB3ZSBhcmUgbm90CiAgICBjb25uZWN0ZWQgdG8gYSB0ZXJtaW5hbCwgdGhlIHZhbHVlIGdpdmVuIGluIGZhbGxiYWNrIHBhcmFtZXRlcgogICAgaXMgdXNlZC4gRmFsbGJhY2sgZGVmYXVsdHMgdG8gKDgwLCAyNCkgd2hpY2ggaXMgdGhlIGRlZmF1bHQKICAgIHNpemUgdXNlZCBieSBtYW55IHRlcm1pbmFsIGVtdWxhdG9ycy4KCiAgICBUaGUgdmFsdWUgcmV0dXJuZWQgaXMgYSBuYW1lZCB0dXBsZSBvZiB0eXBlIG9zLnRlcm1pbmFsX3NpemUuCiAgICAiIiIKICAgICMgY29sdW1ucywgbGluZXMgYXJlIHRoZSB3b3JraW5nIHZhbHVlcwogICAgdHJ5OgogICAgICAgIGNvbHVtbnMgPSBpbnQob3MuZW52aXJvblsnQ09MVU1OUyddKQogICAgZXhjZXB0IChLZXlFcnJvciwgVmFsdWVFcnJvcik6CiAgICAgICAgY29sdW1ucyA9IDAKCiAgICB0cnk6CiAgICAgICAgbGluZXMgPSBpbnQob3MuZW52aXJvblsnTElORVMnXSkKICAgIGV4Y2VwdCAoS2V5RXJyb3IsIFZhbHVlRXJyb3IpOgogICAgICAgIGxpbmVzID0gMAoKICAgICMgb25seSBxdWVyeSBpZiBuZWNlc3NhcnkKICAgIGlmIGNvbHVtbnMgPD0gMCBvciBsaW5lcyA8PSAwOgogICAgICAgIHRyeToKICAgICAgICAgICAgc2l6ZSA9IG9zLmdldF90ZXJtaW5hbF9zaXplKHN5cy5fX3N0ZG91dF9fLmZpbGVubygpKQogICAgICAgIGV4Y2VwdCAoTmFtZUVycm9yLCBPU0Vycm9yKToKICAgICAgICAgICAgc2l6ZSA9IG9zLnRlcm1pbmFsX3NpemUoZmFsbGJhY2spCiAgICAgICAgaWYgY29sdW1ucyA8PSAwOgogICAgICAgICAgICBjb2x1bW5zID0gc2l6ZS5jb2x1bW5zCiAgICAgICAgaWYgbGluZXMgPD0gMDoKICAgICAgICAgICAgbGluZXMgPSBzaXplLmxpbmVzCgogICAgcmV0dXJuIG9zLnRlcm1pbmFsX3NpemUoKGNvbHVtbnMsIGxpbmVzKSkKCmRlZiB3aGljaChjbWQsIG1vZGU9b3MuRl9PSyB8IG9zLlhfT0ssIHBhdGg9Tm9uZSk6CiAgICAiIiJHaXZlbiBhIGNvbW1hbmQsIG1vZGUsIGFuZCBhIFBBVEggc3RyaW5nLCByZXR1cm4gdGhlIHBhdGggd2hpY2gKICAgIGNvbmZvcm1zIHRvIHRoZSBnaXZlbiBtb2RlIG9uIHRoZSBQQVRILCBvciBOb25lIGlmIHRoZXJlIGlzIG5vIHN1Y2gKICAgIGZpbGUuCgogICAgYG1vZGVgIGRlZmF1bHRzIHRvIG9zLkZfT0sgfCBvcy5YX09LLiBgcGF0aGAgZGVmYXVsdHMgdG8gdGhlIHJlc3VsdAogICAgb2Ygb3MuZW52aXJvbi5nZXQoIlBBVEgiKSwgb3IgY2FuIGJlIG92ZXJyaWRkZW4gd2l0aCBhIGN1c3RvbSBzZWFyY2gKICAgIHBhdGguCgogICAgIiIiCiAgICAjIENoZWNrIHRoYXQgYSBnaXZlbiBmaWxlIGNhbiBiZSBhY2Nlc3NlZCB3aXRoIHRoZSBjb3JyZWN0IG1vZGUuCiAgICAjIEFkZGl0aW9uYWxseSBjaGVjayB0aGF0IGBmaWxlYCBpcyBub3QgYSBkaXJlY3RvcnksIGFzIG9uIFdpbmRvd3MKICAgICMgZGlyZWN0b3JpZXMgcGFzcyB0aGUgb3MuYWNjZXNzIGNoZWNrLgogICAgZGVmIF9hY2Nlc3NfY2hlY2soZm4sIG1vZGUpOgogICAgICAgIHJldHVybiAob3MucGF0aC5leGlzdHMoZm4pIGFuZCBvcy5hY2Nlc3MoZm4sIG1vZGUpCiAgICAgICAgICAgICAgICBhbmQgbm90IG9zLnBhdGguaXNkaXIoZm4pKQoKICAgICMgU2hvcnQgY2lyY3VpdC4gSWYgd2UncmUgZ2l2ZW4gYSBmdWxsIHBhdGggd2hpY2ggbWF0Y2hlcyB0aGUgbW9kZQogICAgIyBhbmQgaXQgZXhpc3RzLCB3ZSdyZSBkb25lIGhlcmUuCiAgICBpZiBfYWNjZXNzX2NoZWNrKGNtZCwgbW9kZSk6CiAgICAgICAgcmV0dXJuIGNtZAoKICAgIHBhdGggPSAocGF0aCBvciBvcy5lbnZpcm9uLmdldCgiUEFUSCIsIG9zLmRlZnBhdGgpKS5zcGxpdChvcy5wYXRoc2VwKQoKICAgIGlmIHN5cy5wbGF0Zm9ybSA9PSAid2luMzIiOgogICAgICAgICMgVGhlIGN1cnJlbnQgZGlyZWN0b3J5IHRha2VzIHByZWNlZGVuY2Ugb24gV2luZG93cy4KICAgICAgICBpZiBub3Qgb3MuY3VyZGlyIGluIHBhdGg6CiAgICAgICAgICAgIHBhdGguaW5zZXJ0KDAsIG9zLmN1cmRpcikKCiAgICAgICAgIyBQQVRIRVhUIGlzIG5lY2Vzc2FyeSB0byBjaGVjayBvbiBXaW5kb3dzLgogICAgICAgIHBhdGhleHQgPSBvcy5lbnZpcm9uLmdldCgiUEFUSEVYVCIsICIiKS5zcGxpdChvcy5wYXRoc2VwKQogICAgICAgICMgU2VlIGlmIHRoZSBnaXZlbiBmaWxlIG1hdGNoZXMgYW55IG9mIHRoZSBleHBlY3RlZCBwYXRoIGV4dGVuc2lvbnMuCiAgICAgICAgIyBUaGlzIHdpbGwgYWxsb3cgdXMgdG8gc2hvcnQgY2lyY3VpdCB3aGVuIGdpdmVuICJweXRob24uZXhlIi4KICAgICAgICBtYXRjaGVzID0gW2NtZCBmb3IgZXh0IGluIHBhdGhleHQgaWYgY21kLmxvd2VyKCkuZW5kc3dpdGgoZXh0Lmxvd2VyKCkpXQogICAgICAgICMgSWYgaXQgZG9lcyBtYXRjaCwgb25seSB0ZXN0IHRoYXQgb25lLCBvdGhlcndpc2Ugd2UgaGF2ZSB0byB0cnkKICAgICAgICAjIG90aGVycy4KICAgICAgICBmaWxlcyA9IFtjbWRdIGlmIG1hdGNoZXMgZWxzZSBbY21kICsgZXh0Lmxvd2VyKCkgZm9yIGV4dCBpbiBwYXRoZXh0XQogICAgZWxzZToKICAgICAgICAjIE9uIG90aGVyIHBsYXRmb3JtcyB5b3UgZG9uJ3QgaGF2ZSB0aGluZ3MgbGlrZSBQQVRIRVhUIHRvIHRlbGwgeW91CiAgICAgICAgIyB3aGF0IGZpbGUgc3VmZml4ZXMgYXJlIGV4ZWN1dGFibGUsIHNvIGp1c3QgcGFzcyBvbiBjbWQgYXMtaXMuCiAgICAgICAgZmlsZXMgPSBbY21kXQoKICAgIHNlZW4gPSBzZXQoKQogICAgZm9yIGRpciBpbiBwYXRoOgogICAgICAgIGRpciA9IG9zLnBhdGgubm9ybWNhc2UoZGlyKQogICAgICAgIGlmIG5vdCBkaXIgaW4gc2VlbjoKICAgICAgICAgICAgc2Vlbi5hZGQoZGlyKQogICAgICAgICAgICBmb3IgdGhlZmlsZSBpbiBmaWxlczoKICAgICAgICAgICAgICAgIG5hbWUgPSBvcy5wYXRoLmpvaW4oZGlyLCB0aGVmaWxlKQogICAgICAgICAgICAgICAgaWYgX2FjY2Vzc19jaGVjayhuYW1lLCBtb2RlKToKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmFtZQogICAgcmV0dXJuIE5vbmUK',
'/Lib/signal.py':'IiIiVGhpcyBtb2R1bGUgcHJvdmlkZXMgbWVjaGFuaXNtcyB0byB1c2Ugc2lnbmFsIGhhbmRsZXJzIGluIFB5dGhvbi4KCkZ1bmN0aW9uczoKCmFsYXJtKCkgLS0gY2F1c2UgU0lHQUxSTSBhZnRlciBhIHNwZWNpZmllZCB0aW1lIFtVbml4IG9ubHldCnNldGl0aW1lcigpIC0tIGNhdXNlIGEgc2lnbmFsIChkZXNjcmliZWQgYmVsb3cpIGFmdGVyIGEgc3BlY2lmaWVkCiAgICAgICAgICAgICAgIGZsb2F0IHRpbWUgYW5kIHRoZSB0aW1lciBtYXkgcmVzdGFydCB0aGVuIFtVbml4IG9ubHldCmdldGl0aW1lcigpIC0tIGdldCBjdXJyZW50IHZhbHVlIG9mIHRpbWVyIFtVbml4IG9ubHldCnNpZ25hbCgpIC0tIHNldCB0aGUgYWN0aW9uIGZvciBhIGdpdmVuIHNpZ25hbApnZXRzaWduYWwoKSAtLSBnZXQgdGhlIHNpZ25hbCBhY3Rpb24gZm9yIGEgZ2l2ZW4gc2lnbmFsCnBhdXNlKCkgLS0gd2FpdCB1bnRpbCBhIHNpZ25hbCBhcnJpdmVzIFtVbml4IG9ubHldCmRlZmF1bHRfaW50X2hhbmRsZXIoKSAtLSBkZWZhdWx0IFNJR0lOVCBoYW5kbGVyCgpzaWduYWwgY29uc3RhbnRzOgpTSUdfREZMIC0tIHVzZWQgdG8gcmVmZXIgdG8gdGhlIHN5c3RlbSBkZWZhdWx0IGhhbmRsZXIKU0lHX0lHTiAtLSB1c2VkIHRvIGlnbm9yZSB0aGUgc2lnbmFsCk5TSUcgLS0gbnVtYmVyIG9mIGRlZmluZWQgc2lnbmFscwpTSUdJTlQsIFNJR1RFUk0sIGV0Yy4gLS0gc2lnbmFsIG51bWJlcnMKCml0aW1lciBjb25zdGFudHM6CklUSU1FUl9SRUFMIC0tIGRlY3JlbWVudHMgaW4gcmVhbCB0aW1lLCBhbmQgZGVsaXZlcnMgU0lHQUxSTSB1cG9uCiAgICAgICAgICAgICAgIGV4cGlyYXRpb24KSVRJTUVSX1ZJUlRVQUwgLS0gZGVjcmVtZW50cyBvbmx5IHdoZW4gdGhlIHByb2Nlc3MgaXMgZXhlY3V0aW5nLAogICAgICAgICAgICAgICBhbmQgZGVsaXZlcnMgU0lHVlRBTFJNIHVwb24gZXhwaXJhdGlvbgpJVElNRVJfUFJPRiAtLSBkZWNyZW1lbnRzIGJvdGggd2hlbiB0aGUgcHJvY2VzcyBpcyBleGVjdXRpbmcgYW5kCiAgICAgICAgICAgICAgIHdoZW4gdGhlIHN5c3RlbSBpcyBleGVjdXRpbmcgb24gYmVoYWxmIG9mIHRoZSBwcm9jZXNzLgogICAgICAgICAgICAgICBDb3VwbGVkIHdpdGggSVRJTUVSX1ZJUlRVQUwsIHRoaXMgdGltZXIgaXMgdXN1YWxseQogICAgICAgICAgICAgICB1c2VkIHRvIHByb2ZpbGUgdGhlIHRpbWUgc3BlbnQgYnkgdGhlIGFwcGxpY2F0aW9uCiAgICAgICAgICAgICAgIGluIHVzZXIgYW5kIGtlcm5lbCBzcGFjZS4gU0lHUFJPRiBpcyBkZWxpdmVyZWQgdXBvbgogICAgICAgICAgICAgICBleHBpcmF0aW9uLgoKCioqKiBJTVBPUlRBTlQgTk9USUNFICoqKgpBIHNpZ25hbCBoYW5kbGVyIGZ1bmN0aW9uIGlzIGNhbGxlZCB3aXRoIHR3byBhcmd1bWVudHM6CnRoZSBmaXJzdCBpcyB0aGUgc2lnbmFsIG51bWJlciwgdGhlIHNlY29uZCBpcyB0aGUgaW50ZXJydXB0ZWQgc3RhY2sgZnJhbWUuIiIiCgpDVFJMX0JSRUFLX0VWRU5UPTEKQ1RSTF9DX0VWRU5UPTAKTlNJRz0yMwpTSUdBQlJUPTIyClNJR0JSRUFLPTIxClNJR0ZQRT04ClNJR0lMTD00ClNJR0lOVD0yClNJR1NFR1Y9MTEKU0lHVEVSTT0xNQpTSUdfREZMPTAKU0lHX0lHTj0xCgpkZWYgc2lnbmFsKHNpZ25hbG51bSwgaGFuZGxlcikgOgogICAgcGFzcwo=',
'/Lib/site.py':'aW1wb3J0IHN5cwppbXBvcnQgZXh0ZXJuYWxfaW1wb3J0CnN5cy5wYXRoX2hvb2tzLmluc2VydCgwLGV4dGVybmFsX2ltcG9ydC5Nb2R1bGVGaW5kZXIpCg==',
'/Lib/socket.py':'IyBXcmFwcGVyIG1vZHVsZSBmb3IgX3NvY2tldCwgcHJvdmlkaW5nIHNvbWUgYWRkaXRpb25hbCBmYWNpbGl0aWVzCiMgaW1wbGVtZW50ZWQgaW4gUHl0aG9uLgoKIiIiXApUaGlzIG1vZHVsZSBwcm92aWRlcyBzb2NrZXQgb3BlcmF0aW9ucyBhbmQgc29tZSByZWxhdGVkIGZ1bmN0aW9ucy4KT24gVW5peCwgaXQgc3VwcG9ydHMgSVAgKEludGVybmV0IFByb3RvY29sKSBhbmQgVW5peCBkb21haW4gc29ja2V0cy4KT24gb3RoZXIgc3lzdGVtcywgaXQgb25seSBzdXBwb3J0cyBJUC4gRnVuY3Rpb25zIHNwZWNpZmljIGZvciBhCnNvY2tldCBhcmUgYXZhaWxhYmxlIGFzIG1ldGhvZHMgb2YgdGhlIHNvY2tldCBvYmplY3QuCgpGdW5jdGlvbnM6Cgpzb2NrZXQoKSAtLSBjcmVhdGUgYSBuZXcgc29ja2V0IG9iamVjdApzb2NrZXRwYWlyKCkgLS0gY3JlYXRlIGEgcGFpciBvZiBuZXcgc29ja2V0IG9iamVjdHMgWypdCmZyb21mZCgpIC0tIGNyZWF0ZSBhIHNvY2tldCBvYmplY3QgZnJvbSBhbiBvcGVuIGZpbGUgZGVzY3JpcHRvciBbKl0KZnJvbXNoYXJlKCkgLS0gY3JlYXRlIGEgc29ja2V0IG9iamVjdCBmcm9tIGRhdGEgcmVjZWl2ZWQgZnJvbSBzb2NrZXQuc2hhcmUoKSBbKl0KZ2V0aG9zdG5hbWUoKSAtLSByZXR1cm4gdGhlIGN1cnJlbnQgaG9zdG5hbWUKZ2V0aG9zdGJ5bmFtZSgpIC0tIG1hcCBhIGhvc3RuYW1lIHRvIGl0cyBJUCBudW1iZXIKZ2V0aG9zdGJ5YWRkcigpIC0tIG1hcCBhbiBJUCBudW1iZXIgb3IgaG9zdG5hbWUgdG8gRE5TIGluZm8KZ2V0c2VydmJ5bmFtZSgpIC0tIG1hcCBhIHNlcnZpY2UgbmFtZSBhbmQgYSBwcm90b2NvbCBuYW1lIHRvIGEgcG9ydCBudW1iZXIKZ2V0cHJvdG9ieW5hbWUoKSAtLSBtYXAgYSBwcm90b2NvbCBuYW1lIChlLmcuICd0Y3AnKSB0byBhIG51bWJlcgpudG9ocygpLCBudG9obCgpIC0tIGNvbnZlcnQgMTYsIDMyIGJpdCBpbnQgZnJvbSBuZXR3b3JrIHRvIGhvc3QgYnl0ZSBvcmRlcgpodG9ucygpLCBodG9ubCgpIC0tIGNvbnZlcnQgMTYsIDMyIGJpdCBpbnQgZnJvbSBob3N0IHRvIG5ldHdvcmsgYnl0ZSBvcmRlcgppbmV0X2F0b24oKSAtLSBjb252ZXJ0IElQIGFkZHIgc3RyaW5nICgxMjMuNDUuNjcuODkpIHRvIDMyLWJpdCBwYWNrZWQgZm9ybWF0CmluZXRfbnRvYSgpIC0tIGNvbnZlcnQgMzItYml0IHBhY2tlZCBmb3JtYXQgSVAgdG8gc3RyaW5nICgxMjMuNDUuNjcuODkpCnNvY2tldC5nZXRkZWZhdWx0dGltZW91dCgpIC0tIGdldCB0aGUgZGVmYXVsdCB0aW1lb3V0IHZhbHVlCnNvY2tldC5zZXRkZWZhdWx0dGltZW91dCgpIC0tIHNldCB0aGUgZGVmYXVsdCB0aW1lb3V0IHZhbHVlCmNyZWF0ZV9jb25uZWN0aW9uKCkgLS0gY29ubmVjdHMgdG8gYW4gYWRkcmVzcywgd2l0aCBhbiBvcHRpb25hbCB0aW1lb3V0IGFuZAogICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsIHNvdXJjZSBhZGRyZXNzLgoKIFsqXSBub3QgYXZhaWxhYmxlIG9uIGFsbCBwbGF0Zm9ybXMhCgpTcGVjaWFsIG9iamVjdHM6CgpTb2NrZXRUeXBlIC0tIHR5cGUgb2JqZWN0IGZvciBzb2NrZXQgb2JqZWN0cwplcnJvciAtLSBleGNlcHRpb24gcmFpc2VkIGZvciBJL08gZXJyb3JzCmhhc19pcHY2IC0tIGJvb2xlYW4gdmFsdWUgaW5kaWNhdGluZyBpZiBJUHY2IGlzIHN1cHBvcnRlZAoKSW50ZWdlciBjb25zdGFudHM6CgpBRl9JTkVULCBBRl9VTklYIC0tIHNvY2tldCBkb21haW5zIChmaXJzdCBhcmd1bWVudCB0byBzb2NrZXQoKSBjYWxsKQpTT0NLX1NUUkVBTSwgU09DS19ER1JBTSwgU09DS19SQVcgLS0gc29ja2V0IHR5cGVzIChzZWNvbmQgYXJndW1lbnQpCgpNYW55IG90aGVyIGNvbnN0YW50cyBtYXkgYmUgZGVmaW5lZDsgdGhlc2UgbWF5IGJlIHVzZWQgaW4gY2FsbHMgdG8KdGhlIHNldHNvY2tvcHQoKSBhbmQgZ2V0c29ja29wdCgpIG1ldGhvZHMuCiIiIgoKaW1wb3J0IF9zb2NrZXQKZnJvbSBfc29ja2V0IGltcG9ydCAqCgppbXBvcnQgb3MsIHN5cywgaW8KCnRyeToKICAgIGltcG9ydCBlcnJubwpleGNlcHQgSW1wb3J0RXJyb3I6CiAgICBlcnJubyA9IE5vbmUKRUJBREYgPSBnZXRhdHRyKGVycm5vLCAnRUJBREYnLCA5KQpFQUdBSU4gPSBnZXRhdHRyKGVycm5vLCAnRUFHQUlOJywgMTEpCkVXT1VMREJMT0NLID0gZ2V0YXR0cihlcnJubywgJ0VXT1VMREJMT0NLJywgMTEpCgpfX2FsbF9fID0gWyJnZXRmcWRuIiwgImNyZWF0ZV9jb25uZWN0aW9uIl0KX19hbGxfXy5leHRlbmQob3MuX2dldF9leHBvcnRzX2xpc3QoX3NvY2tldCkpCgoKX3JlYWxzb2NrZXQgPSBzb2NrZXQKCiMgV1NBIGVycm9yIGNvZGVzCmlmIHN5cy5wbGF0Zm9ybS5sb3dlcigpLnN0YXJ0c3dpdGgoIndpbiIpOgogICAgZXJyb3JUYWIgPSB7fQogICAgZXJyb3JUYWJbMTAwMDRdID0gIlRoZSBvcGVyYXRpb24gd2FzIGludGVycnVwdGVkLiIKICAgIGVycm9yVGFiWzEwMDA5XSA9ICJBIGJhZCBmaWxlIGhhbmRsZSB3YXMgcGFzc2VkLiIKICAgIGVycm9yVGFiWzEwMDEzXSA9ICJQZXJtaXNzaW9uIGRlbmllZC4iCiAgICBlcnJvclRhYlsxMDAxNF0gPSAiQSBmYXVsdCBvY2N1cnJlZCBvbiB0aGUgbmV0d29yaz8/IiAjIFdTQUVGQVVMVAogICAgZXJyb3JUYWJbMTAwMjJdID0gIkFuIGludmFsaWQgb3BlcmF0aW9uIHdhcyBhdHRlbXB0ZWQuIgogICAgZXJyb3JUYWJbMTAwMzVdID0gIlRoZSBzb2NrZXQgb3BlcmF0aW9uIHdvdWxkIGJsb2NrIgogICAgZXJyb3JUYWJbMTAwMzZdID0gIkEgYmxvY2tpbmcgb3BlcmF0aW9uIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3MuIgogICAgZXJyb3JUYWJbMTAwNDhdID0gIlRoZSBuZXR3b3JrIGFkZHJlc3MgaXMgaW4gdXNlLiIKICAgIGVycm9yVGFiWzEwMDU0XSA9ICJUaGUgY29ubmVjdGlvbiBoYXMgYmVlbiByZXNldC4iCiAgICBlcnJvclRhYlsxMDA1OF0gPSAiVGhlIG5ldHdvcmsgaGFzIGJlZW4gc2h1dCBkb3duLiIKICAgIGVycm9yVGFiWzEwMDYwXSA9ICJUaGUgb3BlcmF0aW9uIHRpbWVkIG91dC4iCiAgICBlcnJvclRhYlsxMDA2MV0gPSAiQ29ubmVjdGlvbiByZWZ1c2VkLiIKICAgIGVycm9yVGFiWzEwMDYzXSA9ICJUaGUgbmFtZSBpcyB0b28gbG9uZy4iCiAgICBlcnJvclRhYlsxMDA2NF0gPSAiVGhlIGhvc3QgaXMgZG93bi4iCiAgICBlcnJvclRhYlsxMDA2NV0gPSAiVGhlIGhvc3QgaXMgdW5yZWFjaGFibGUuIgogICAgX19hbGxfXy5hcHBlbmQoImVycm9yVGFiIikKCgpjbGFzcyBzb2NrZXQoX3NvY2tldC5zb2NrZXQpOgoKICAgICIiIkEgc3ViY2xhc3Mgb2YgX3NvY2tldC5zb2NrZXQgYWRkaW5nIHRoZSBtYWtlZmlsZSgpIG1ldGhvZC4iIiIKCiAgICBfX3Nsb3RzX18gPSBbIl9fd2Vha3JlZl9fIiwgIl9pb19yZWZzIiwgIl9jbG9zZWQiXQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBmYW1pbHk9QUZfSU5FVCwgdHlwZT1TT0NLX1NUUkVBTSwgcHJvdG89MCwgZmlsZW5vPU5vbmUpOgogICAgICAgIF9zb2NrZXQuc29ja2V0Ll9faW5pdF9fKHNlbGYsIGZhbWlseSwgdHlwZSwgcHJvdG8sIGZpbGVubykKICAgICAgICBzZWxmLl9pb19yZWZzID0gMAogICAgICAgIHNlbGYuX2Nsb3NlZCA9IEZhbHNlCgogICAgZGVmIF9fZW50ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX2V4aXRfXyhzZWxmLCAqYXJncyk6CiAgICAgICAgaWYgbm90IHNlbGYuX2Nsb3NlZDoKICAgICAgICAgICAgc2VsZi5jbG9zZSgpCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgICIiIldyYXAgX19yZXByX18oKSB0byByZXZlYWwgdGhlIHJlYWwgY2xhc3MgbmFtZS4iIiIKICAgICAgICBzID0gX3NvY2tldC5zb2NrZXQuX19yZXByX18oc2VsZikKICAgICAgICBpZiBzLnN0YXJ0c3dpdGgoIjxzb2NrZXQgb2JqZWN0Iik6CiAgICAgICAgICAgIHMgPSAiPCVzLiVzJXMlcyIgJSAoc2VsZi5fX2NsYXNzX18uX19tb2R1bGVfXywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9fY2xhc3NfXy5fX25hbWVfXywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKHNlbGYsICdfY2xvc2VkJywgRmFsc2UpIGFuZCAiIFtjbG9zZWRdICIgb3IgIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc1s3Ol0pCiAgICAgICAgcmV0dXJuIHMKCiAgICBkZWYgX19nZXRzdGF0ZV9fKHNlbGYpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiQ2Fubm90IHNlcmlhbGl6ZSBzb2NrZXQgb2JqZWN0IikKCiAgICBkZWYgZHVwKHNlbGYpOgogICAgICAgICIiImR1cCgpIC0+IHNvY2tldCBvYmplY3QKCiAgICAgICAgUmV0dXJuIGEgbmV3IHNvY2tldCBvYmplY3QgY29ubmVjdGVkIHRvIHRoZSBzYW1lIHN5c3RlbSByZXNvdXJjZS4KICAgICAgICAiIiIKICAgICAgICBmZCA9IGR1cChzZWxmLmZpbGVubygpKQogICAgICAgIHNvY2sgPSBzZWxmLl9fY2xhc3NfXyhzZWxmLmZhbWlseSwgc2VsZi50eXBlLCBzZWxmLnByb3RvLCBmaWxlbm89ZmQpCiAgICAgICAgc29jay5zZXR0aW1lb3V0KHNlbGYuZ2V0dGltZW91dCgpKQogICAgICAgIHJldHVybiBzb2NrCgogICAgZGVmIGFjY2VwdChzZWxmKToKICAgICAgICAiIiJhY2NlcHQoKSAtPiAoc29ja2V0IG9iamVjdCwgYWRkcmVzcyBpbmZvKQoKICAgICAgICBXYWl0IGZvciBhbiBpbmNvbWluZyBjb25uZWN0aW9uLiAgUmV0dXJuIGEgbmV3IHNvY2tldAogICAgICAgIHJlcHJlc2VudGluZyB0aGUgY29ubmVjdGlvbiwgYW5kIHRoZSBhZGRyZXNzIG9mIHRoZSBjbGllbnQuCiAgICAgICAgRm9yIElQIHNvY2tldHMsIHRoZSBhZGRyZXNzIGluZm8gaXMgYSBwYWlyIChob3N0YWRkciwgcG9ydCkuCiAgICAgICAgIiIiCiAgICAgICAgZmQsIGFkZHIgPSBzZWxmLl9hY2NlcHQoKQogICAgICAgIHNvY2sgPSBzb2NrZXQoc2VsZi5mYW1pbHksIHNlbGYudHlwZSwgc2VsZi5wcm90bywgZmlsZW5vPWZkKQogICAgICAgICMgSXNzdWUgIzc5OTU6IGlmIG5vIGRlZmF1bHQgdGltZW91dCBpcyBzZXQgYW5kIHRoZSBsaXN0ZW5pbmcKICAgICAgICAjIHNvY2tldCBoYWQgYSAobm9uLXplcm8pIHRpbWVvdXQsIGZvcmNlIHRoZSBuZXcgc29ja2V0IGluIGJsb2NraW5nCiAgICAgICAgIyBtb2RlIHRvIG92ZXJyaWRlIHBsYXRmb3JtLXNwZWNpZmljIHNvY2tldCBmbGFncyBpbmhlcml0YW5jZS4KICAgICAgICBpZiBnZXRkZWZhdWx0dGltZW91dCgpIGlzIE5vbmUgYW5kIHNlbGYuZ2V0dGltZW91dCgpOgogICAgICAgICAgICBzb2NrLnNldGJsb2NraW5nKFRydWUpCiAgICAgICAgcmV0dXJuIHNvY2ssIGFkZHIKCiAgICBkZWYgbWFrZWZpbGUoc2VsZiwgbW9kZT0iciIsIGJ1ZmZlcmluZz1Ob25lLCAqLAogICAgICAgICAgICAgICAgIGVuY29kaW5nPU5vbmUsIGVycm9ycz1Ob25lLCBuZXdsaW5lPU5vbmUpOgogICAgICAgICIiIm1ha2VmaWxlKC4uLikgLT4gYW4gSS9PIHN0cmVhbSBjb25uZWN0ZWQgdG8gdGhlIHNvY2tldAoKICAgICAgICBUaGUgYXJndW1lbnRzIGFyZSBhcyBmb3IgaW8ub3BlbigpIGFmdGVyIHRoZSBmaWxlbmFtZSwKICAgICAgICBleGNlcHQgdGhlIG9ubHkgbW9kZSBjaGFyYWN0ZXJzIHN1cHBvcnRlZCBhcmUgJ3InLCAndycgYW5kICdiJy4KICAgICAgICBUaGUgc2VtYW50aWNzIGFyZSBzaW1pbGFyIHRvby4gIChYWFggcmVmYWN0b3IgdG8gc2hhcmUgY29kZT8pCiAgICAgICAgIiIiCiAgICAgICAgZm9yIGMgaW4gbW9kZToKICAgICAgICAgICAgaWYgYyBub3QgaW4geyJyIiwgInciLCAiYiJ9OgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiaW52YWxpZCBtb2RlICVyIChvbmx5IHIsIHcsIGIgYWxsb3dlZCkiKQogICAgICAgIHdyaXRpbmcgPSAidyIgaW4gbW9kZQogICAgICAgIHJlYWRpbmcgPSAiciIgaW4gbW9kZSBvciBub3Qgd3JpdGluZwogICAgICAgIGFzc2VydCByZWFkaW5nIG9yIHdyaXRpbmcKICAgICAgICBiaW5hcnkgPSAiYiIgaW4gbW9kZQogICAgICAgIHJhd21vZGUgPSAiIgogICAgICAgIGlmIHJlYWRpbmc6CiAgICAgICAgICAgIHJhd21vZGUgKz0gInIiCiAgICAgICAgaWYgd3JpdGluZzoKICAgICAgICAgICAgcmF3bW9kZSArPSAidyIKICAgICAgICByYXcgPSBTb2NrZXRJTyhzZWxmLCByYXdtb2RlKQogICAgICAgIHNlbGYuX2lvX3JlZnMgKz0gMQogICAgICAgIGlmIGJ1ZmZlcmluZyBpcyBOb25lOgogICAgICAgICAgICBidWZmZXJpbmcgPSAtMQogICAgICAgIGlmIGJ1ZmZlcmluZyA8IDA6CiAgICAgICAgICAgIGJ1ZmZlcmluZyA9IGlvLkRFRkFVTFRfQlVGRkVSX1NJWkUKICAgICAgICBpZiBidWZmZXJpbmcgPT0gMDoKICAgICAgICAgICAgaWYgbm90IGJpbmFyeToKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoInVuYnVmZmVyZWQgc3RyZWFtcyBtdXN0IGJlIGJpbmFyeSIpCiAgICAgICAgICAgIHJldHVybiByYXcKICAgICAgICBpZiByZWFkaW5nIGFuZCB3cml0aW5nOgogICAgICAgICAgICBidWZmZXIgPSBpby5CdWZmZXJlZFJXUGFpcihyYXcsIHJhdywgYnVmZmVyaW5nKQogICAgICAgIGVsaWYgcmVhZGluZzoKICAgICAgICAgICAgYnVmZmVyID0gaW8uQnVmZmVyZWRSZWFkZXIocmF3LCBidWZmZXJpbmcpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYXNzZXJ0IHdyaXRpbmcKICAgICAgICAgICAgYnVmZmVyID0gaW8uQnVmZmVyZWRXcml0ZXIocmF3LCBidWZmZXJpbmcpCiAgICAgICAgaWYgYmluYXJ5OgogICAgICAgICAgICByZXR1cm4gYnVmZmVyCiAgICAgICAgdGV4dCA9IGlvLlRleHRJT1dyYXBwZXIoYnVmZmVyLCBlbmNvZGluZywgZXJyb3JzLCBuZXdsaW5lKQogICAgICAgIHRleHQubW9kZSA9IG1vZGUKICAgICAgICByZXR1cm4gdGV4dAoKICAgIGRlZiBfZGVjcmVmX3NvY2tldGlvcyhzZWxmKToKICAgICAgICBpZiBzZWxmLl9pb19yZWZzID4gMDoKICAgICAgICAgICAgc2VsZi5faW9fcmVmcyAtPSAxCiAgICAgICAgaWYgc2VsZi5fY2xvc2VkOgogICAgICAgICAgICBzZWxmLmNsb3NlKCkKCiAgICBkZWYgX3JlYWxfY2xvc2Uoc2VsZiwgX3NzPV9zb2NrZXQuc29ja2V0KToKICAgICAgICAjIFRoaXMgZnVuY3Rpb24gc2hvdWxkIG5vdCByZWZlcmVuY2UgYW55IGdsb2JhbHMuIFNlZSBpc3N1ZSAjODA4MTY0LgogICAgICAgIF9zcy5jbG9zZShzZWxmKQoKICAgIGRlZiBjbG9zZShzZWxmKToKICAgICAgICAjIFRoaXMgZnVuY3Rpb24gc2hvdWxkIG5vdCByZWZlcmVuY2UgYW55IGdsb2JhbHMuIFNlZSBpc3N1ZSAjODA4MTY0LgogICAgICAgIHNlbGYuX2Nsb3NlZCA9IFRydWUKICAgICAgICBpZiBzZWxmLl9pb19yZWZzIDw9IDA6CiAgICAgICAgICAgIHNlbGYuX3JlYWxfY2xvc2UoKQoKICAgIGRlZiBkZXRhY2goc2VsZik6CiAgICAgICAgIiIiZGV0YWNoKCkgLT4gZmlsZSBkZXNjcmlwdG9yCgogICAgICAgIENsb3NlIHRoZSBzb2NrZXQgb2JqZWN0IHdpdGhvdXQgY2xvc2luZyB0aGUgdW5kZXJseWluZyBmaWxlIGRlc2NyaXB0b3IuCiAgICAgICAgVGhlIG9iamVjdCBjYW5ub3QgYmUgdXNlZCBhZnRlciB0aGlzIGNhbGwsIGJ1dCB0aGUgZmlsZSBkZXNjcmlwdG9yCiAgICAgICAgY2FuIGJlIHJldXNlZCBmb3Igb3RoZXIgcHVycG9zZXMuICBUaGUgZmlsZSBkZXNjcmlwdG9yIGlzIHJldHVybmVkLgogICAgICAgICIiIgogICAgICAgIHNlbGYuX2Nsb3NlZCA9IFRydWUKICAgICAgICByZXR1cm4gc3VwZXIoKS5kZXRhY2goKQoKZGVmIGZyb21mZChmZCwgZmFtaWx5LCB0eXBlLCBwcm90bz0wKToKICAgICIiIiBmcm9tZmQoZmQsIGZhbWlseSwgdHlwZVssIHByb3RvXSkgLT4gc29ja2V0IG9iamVjdAoKICAgIENyZWF0ZSBhIHNvY2tldCBvYmplY3QgZnJvbSBhIGR1cGxpY2F0ZSBvZiB0aGUgZ2l2ZW4gZmlsZQogICAgZGVzY3JpcHRvci4gIFRoZSByZW1haW5pbmcgYXJndW1lbnRzIGFyZSB0aGUgc2FtZSBhcyBmb3Igc29ja2V0KCkuCiAgICAiIiIKICAgIG5mZCA9IGR1cChmZCkKICAgIHJldHVybiBzb2NrZXQoZmFtaWx5LCB0eXBlLCBwcm90bywgbmZkKQoKaWYgaGFzYXR0cihfc29ja2V0LnNvY2tldCwgInNoYXJlIik6CiAgICBkZWYgZnJvbXNoYXJlKGluZm8pOgogICAgICAgICIiIiBmcm9tc2hhcmUoaW5mbykgLT4gc29ja2V0IG9iamVjdAoKICAgICAgICBDcmVhdGUgYSBzb2NrZXQgb2JqZWN0IGZyb20gYSB0aGUgYnl0ZXMgb2JqZWN0IHJldHVybmVkIGJ5CiAgICAgICAgc29ja2V0LnNoYXJlKHBpZCkuCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIHNvY2tldCgwLCAwLCAwLCBpbmZvKQoKaWYgaGFzYXR0cihfc29ja2V0LCAic29ja2V0cGFpciIpOgoKICAgIGRlZiBzb2NrZXRwYWlyKGZhbWlseT1Ob25lLCB0eXBlPVNPQ0tfU1RSRUFNLCBwcm90bz0wKToKICAgICAgICAiIiJzb2NrZXRwYWlyKFtmYW1pbHlbLCB0eXBlWywgcHJvdG9dXV0pIC0+IChzb2NrZXQgb2JqZWN0LCBzb2NrZXQgb2JqZWN0KQoKICAgICAgICBDcmVhdGUgYSBwYWlyIG9mIHNvY2tldCBvYmplY3RzIGZyb20gdGhlIHNvY2tldHMgcmV0dXJuZWQgYnkgdGhlIHBsYXRmb3JtCiAgICAgICAgc29ja2V0cGFpcigpIGZ1bmN0aW9uLgogICAgICAgIFRoZSBhcmd1bWVudHMgYXJlIHRoZSBzYW1lIGFzIGZvciBzb2NrZXQoKSBleGNlcHQgdGhlIGRlZmF1bHQgZmFtaWx5IGlzCiAgICAgICAgQUZfVU5JWCBpZiBkZWZpbmVkIG9uIHRoZSBwbGF0Zm9ybTsgb3RoZXJ3aXNlLCB0aGUgZGVmYXVsdCBpcyBBRl9JTkVULgogICAgICAgICIiIgogICAgICAgIGlmIGZhbWlseSBpcyBOb25lOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBmYW1pbHkgPSBBRl9VTklYCiAgICAgICAgICAgIGV4Y2VwdCBOYW1lRXJyb3I6CiAgICAgICAgICAgICAgICBmYW1pbHkgPSBBRl9JTkVUCiAgICAgICAgYSwgYiA9IF9zb2NrZXQuc29ja2V0cGFpcihmYW1pbHksIHR5cGUsIHByb3RvKQogICAgICAgIGEgPSBzb2NrZXQoZmFtaWx5LCB0eXBlLCBwcm90bywgYS5kZXRhY2goKSkKICAgICAgICBiID0gc29ja2V0KGZhbWlseSwgdHlwZSwgcHJvdG8sIGIuZGV0YWNoKCkpCiAgICAgICAgcmV0dXJuIGEsIGIKCgpfYmxvY2tpbmdfZXJybm9zID0geyBFQUdBSU4sIEVXT1VMREJMT0NLIH0KCmNsYXNzIFNvY2tldElPKGlvLlJhd0lPQmFzZSk6CgogICAgIiIiUmF3IEkvTyBpbXBsZW1lbnRhdGlvbiBmb3Igc3RyZWFtIHNvY2tldHMuCgogICAgVGhpcyBjbGFzcyBzdXBwb3J0cyB0aGUgbWFrZWZpbGUoKSBtZXRob2Qgb24gc29ja2V0cy4gIEl0IHByb3ZpZGVzCiAgICB0aGUgcmF3IEkvTyBpbnRlcmZhY2Ugb24gdG9wIG9mIGEgc29ja2V0IG9iamVjdC4KICAgICIiIgoKICAgICMgT25lIG1pZ2h0IHdvbmRlciB3aHkgbm90IGxldCBGaWxlSU8gZG8gdGhlIGpvYiBpbnN0ZWFkLiAgVGhlcmUgYXJlIHR3bwogICAgIyBtYWluIHJlYXNvbnMgd2h5IEZpbGVJTyBpcyBub3QgYWRhcHRlZDoKICAgICMgLSBpdCB3b3VsZG4ndCB3b3JrIHVuZGVyIFdpbmRvd3MgKHdoZXJlIHlvdSBjYW4ndCB1c2VkIHJlYWQoKSBhbmQKICAgICMgICB3cml0ZSgpIG9uIGEgc29ja2V0IGhhbmRsZSkKICAgICMgLSBpdCB3b3VsZG4ndCB3b3JrIHdpdGggc29ja2V0IHRpbWVvdXRzIChGaWxlSU8gd291bGQgaWdub3JlIHRoZQogICAgIyAgIHRpbWVvdXQgYW5kIGNvbnNpZGVyIHRoZSBzb2NrZXQgbm9uLWJsb2NraW5nKQoKICAgICMgWFhYIE1vcmUgZG9jcwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzb2NrLCBtb2RlKToKICAgICAgICBpZiBtb2RlIG5vdCBpbiAoInIiLCAidyIsICJydyIsICJyYiIsICJ3YiIsICJyd2IiKToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiaW52YWxpZCBtb2RlOiAlciIgJSBtb2RlKQogICAgICAgIGlvLlJhd0lPQmFzZS5fX2luaXRfXyhzZWxmKQogICAgICAgIHNlbGYuX3NvY2sgPSBzb2NrCiAgICAgICAgaWYgImIiIG5vdCBpbiBtb2RlOgogICAgICAgICAgICBtb2RlICs9ICJiIgogICAgICAgIHNlbGYuX21vZGUgPSBtb2RlCiAgICAgICAgc2VsZi5fcmVhZGluZyA9ICJyIiBpbiBtb2RlCiAgICAgICAgc2VsZi5fd3JpdGluZyA9ICJ3IiBpbiBtb2RlCiAgICAgICAgc2VsZi5fdGltZW91dF9vY2N1cnJlZCA9IEZhbHNlCgogICAgZGVmIHJlYWRpbnRvKHNlbGYsIGIpOgogICAgICAgICIiIlJlYWQgdXAgdG8gbGVuKGIpIGJ5dGVzIGludG8gdGhlIHdyaXRhYmxlIGJ1ZmZlciAqYiogYW5kIHJldHVybgogICAgICAgIHRoZSBudW1iZXIgb2YgYnl0ZXMgcmVhZC4gIElmIHRoZSBzb2NrZXQgaXMgbm9uLWJsb2NraW5nIGFuZCBubyBieXRlcwogICAgICAgIGFyZSBhdmFpbGFibGUsIE5vbmUgaXMgcmV0dXJuZWQuCgogICAgICAgIElmICpiKiBpcyBub24tZW1wdHksIGEgMCByZXR1cm4gdmFsdWUgaW5kaWNhdGVzIHRoYXQgdGhlIGNvbm5lY3Rpb24KICAgICAgICB3YXMgc2h1dGRvd24gYXQgdGhlIG90aGVyIGVuZC4KICAgICAgICAiIiIKICAgICAgICBzZWxmLl9jaGVja0Nsb3NlZCgpCiAgICAgICAgc2VsZi5fY2hlY2tSZWFkYWJsZSgpCiAgICAgICAgaWYgc2VsZi5fdGltZW91dF9vY2N1cnJlZDoKICAgICAgICAgICAgcmFpc2UgSU9FcnJvcigiY2Fubm90IHJlYWQgZnJvbSB0aW1lZCBvdXQgb2JqZWN0IikKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5fc29jay5yZWN2X2ludG8oYikKICAgICAgICAgICAgZXhjZXB0IHRpbWVvdXQ6CiAgICAgICAgICAgICAgICBzZWxmLl90aW1lb3V0X29jY3VycmVkID0gVHJ1ZQogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgZXhjZXB0IEludGVycnVwdGVkRXJyb3I6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBleGNlcHQgZXJyb3IgYXMgZToKICAgICAgICAgICAgICAgIGlmIGUuYXJnc1swXSBpbiBfYmxvY2tpbmdfZXJybm9zOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgICAgICAgICByYWlzZQoKICAgIGRlZiB3cml0ZShzZWxmLCBiKToKICAgICAgICAiIiJXcml0ZSB0aGUgZ2l2ZW4gYnl0ZXMgb3IgYnl0ZWFycmF5IG9iamVjdCAqYiogdG8gdGhlIHNvY2tldAogICAgICAgIGFuZCByZXR1cm4gdGhlIG51bWJlciBvZiBieXRlcyB3cml0dGVuLiAgVGhpcyBjYW4gYmUgbGVzcyB0aGFuCiAgICAgICAgbGVuKGIpIGlmIG5vdCBhbGwgZGF0YSBjb3VsZCBiZSB3cml0dGVuLiAgSWYgdGhlIHNvY2tldCBpcwogICAgICAgIG5vbi1ibG9ja2luZyBhbmQgbm8gYnl0ZXMgY291bGQgYmUgd3JpdHRlbiBOb25lIGlzIHJldHVybmVkLgogICAgICAgICIiIgogICAgICAgIHNlbGYuX2NoZWNrQ2xvc2VkKCkKICAgICAgICBzZWxmLl9jaGVja1dyaXRhYmxlKCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9zb2NrLnNlbmQoYikKICAgICAgICBleGNlcHQgZXJyb3IgYXMgZToKICAgICAgICAgICAgIyBYWFggd2hhdCBhYm91dCBFSU5UUj8KICAgICAgICAgICAgaWYgZS5hcmdzWzBdIGluIF9ibG9ja2luZ19lcnJub3M6CiAgICAgICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgICAgICByYWlzZQoKICAgIGRlZiByZWFkYWJsZShzZWxmKToKICAgICAgICAiIiJUcnVlIGlmIHRoZSBTb2NrZXRJTyBpcyBvcGVuIGZvciByZWFkaW5nLgogICAgICAgICIiIgogICAgICAgIHJldHVybiBzZWxmLl9yZWFkaW5nIGFuZCBub3Qgc2VsZi5jbG9zZWQKCiAgICBkZWYgd3JpdGFibGUoc2VsZik6CiAgICAgICAgIiIiVHJ1ZSBpZiB0aGUgU29ja2V0SU8gaXMgb3BlbiBmb3Igd3JpdGluZy4KICAgICAgICAiIiIKICAgICAgICByZXR1cm4gc2VsZi5fd3JpdGluZyBhbmQgbm90IHNlbGYuY2xvc2VkCgogICAgZGVmIGZpbGVubyhzZWxmKToKICAgICAgICAiIiJSZXR1cm4gdGhlIGZpbGUgZGVzY3JpcHRvciBvZiB0aGUgdW5kZXJseWluZyBzb2NrZXQuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fY2hlY2tDbG9zZWQoKQogICAgICAgIHJldHVybiBzZWxmLl9zb2NrLmZpbGVubygpCgogICAgQHByb3BlcnR5CiAgICBkZWYgbmFtZShzZWxmKToKICAgICAgICBpZiBub3Qgc2VsZi5jbG9zZWQ6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmZpbGVubygpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIC0xCgogICAgQHByb3BlcnR5CiAgICBkZWYgbW9kZShzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fbW9kZQoKICAgIGRlZiBjbG9zZShzZWxmKToKICAgICAgICAiIiJDbG9zZSB0aGUgU29ja2V0SU8gb2JqZWN0LiAgVGhpcyBkb2Vzbid0IGNsb3NlIHRoZSB1bmRlcmx5aW5nCiAgICAgICAgc29ja2V0LCBleGNlcHQgaWYgYWxsIHJlZmVyZW5jZXMgdG8gaXQgaGF2ZSBkaXNhcHBlYXJlZC4KICAgICAgICAiIiIKICAgICAgICBpZiBzZWxmLmNsb3NlZDoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaW8uUmF3SU9CYXNlLmNsb3NlKHNlbGYpCiAgICAgICAgc2VsZi5fc29jay5fZGVjcmVmX3NvY2tldGlvcygpCiAgICAgICAgc2VsZi5fc29jayA9IE5vbmUKCgpkZWYgZ2V0ZnFkbihuYW1lPScnKToKICAgICIiIkdldCBmdWxseSBxdWFsaWZpZWQgZG9tYWluIG5hbWUgZnJvbSBuYW1lLgoKICAgIEFuIGVtcHR5IGFyZ3VtZW50IGlzIGludGVycHJldGVkIGFzIG1lYW5pbmcgdGhlIGxvY2FsIGhvc3QuCgogICAgRmlyc3QgdGhlIGhvc3RuYW1lIHJldHVybmVkIGJ5IGdldGhvc3RieWFkZHIoKSBpcyBjaGVja2VkLCB0aGVuCiAgICBwb3NzaWJseSBleGlzdGluZyBhbGlhc2VzLiBJbiBjYXNlIG5vIEZRRE4gaXMgYXZhaWxhYmxlLCBob3N0bmFtZQogICAgZnJvbSBnZXRob3N0bmFtZSgpIGlzIHJldHVybmVkLgogICAgIiIiCiAgICBuYW1lID0gbmFtZS5zdHJpcCgpCiAgICBpZiBub3QgbmFtZSBvciBuYW1lID09ICcwLjAuMC4wJzoKICAgICAgICBuYW1lID0gZ2V0aG9zdG5hbWUoKQogICAgdHJ5OgogICAgICAgIGhvc3RuYW1lLCBhbGlhc2VzLCBpcGFkZHJzID0gZ2V0aG9zdGJ5YWRkcihuYW1lKQogICAgZXhjZXB0IGVycm9yOgogICAgICAgIHBhc3MKICAgIGVsc2U6CiAgICAgICAgYWxpYXNlcy5pbnNlcnQoMCwgaG9zdG5hbWUpCiAgICAgICAgZm9yIG5hbWUgaW4gYWxpYXNlczoKICAgICAgICAgICAgaWYgJy4nIGluIG5hbWU6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG5hbWUgPSBob3N0bmFtZQogICAgcmV0dXJuIG5hbWUKCgpfR0xPQkFMX0RFRkFVTFRfVElNRU9VVCA9IG9iamVjdCgpCgpkZWYgY3JlYXRlX2Nvbm5lY3Rpb24oYWRkcmVzcywgdGltZW91dD1fR0xPQkFMX0RFRkFVTFRfVElNRU9VVCwKICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZV9hZGRyZXNzPU5vbmUpOgogICAgIiIiQ29ubmVjdCB0byAqYWRkcmVzcyogYW5kIHJldHVybiB0aGUgc29ja2V0IG9iamVjdC4KCiAgICBDb252ZW5pZW5jZSBmdW5jdGlvbi4gIENvbm5lY3QgdG8gKmFkZHJlc3MqIChhIDItdHVwbGUgYGAoaG9zdCwKICAgIHBvcnQpYGApIGFuZCByZXR1cm4gdGhlIHNvY2tldCBvYmplY3QuICBQYXNzaW5nIHRoZSBvcHRpb25hbAogICAgKnRpbWVvdXQqIHBhcmFtZXRlciB3aWxsIHNldCB0aGUgdGltZW91dCBvbiB0aGUgc29ja2V0IGluc3RhbmNlCiAgICBiZWZvcmUgYXR0ZW1wdGluZyB0byBjb25uZWN0LiAgSWYgbm8gKnRpbWVvdXQqIGlzIHN1cHBsaWVkLCB0aGUKICAgIGdsb2JhbCBkZWZhdWx0IHRpbWVvdXQgc2V0dGluZyByZXR1cm5lZCBieSA6ZnVuYzpgZ2V0ZGVmYXVsdHRpbWVvdXRgCiAgICBpcyB1c2VkLiAgSWYgKnNvdXJjZV9hZGRyZXNzKiBpcyBzZXQgaXQgbXVzdCBiZSBhIHR1cGxlIG9mIChob3N0LCBwb3J0KQogICAgZm9yIHRoZSBzb2NrZXQgdG8gYmluZCBhcyBhIHNvdXJjZSBhZGRyZXNzIGJlZm9yZSBtYWtpbmcgdGhlIGNvbm5lY3Rpb24uCiAgICBBbiBob3N0IG9mICcnIG9yIHBvcnQgMCB0ZWxscyB0aGUgT1MgdG8gdXNlIHRoZSBkZWZhdWx0LgogICAgIiIiCgogICAgaG9zdCwgcG9ydCA9IGFkZHJlc3MKICAgIGVyciA9IE5vbmUKICAgIGZvciByZXMgaW4gZ2V0YWRkcmluZm8oaG9zdCwgcG9ydCwgMCwgU09DS19TVFJFQU0pOgogICAgICAgIGFmLCBzb2NrdHlwZSwgcHJvdG8sIGNhbm9ubmFtZSwgc2EgPSByZXMKICAgICAgICBzb2NrID0gTm9uZQogICAgICAgIHRyeToKICAgICAgICAgICAgc29jayA9IHNvY2tldChhZiwgc29ja3R5cGUsIHByb3RvKQogICAgICAgICAgICBpZiB0aW1lb3V0IGlzIG5vdCBfR0xPQkFMX0RFRkFVTFRfVElNRU9VVDoKICAgICAgICAgICAgICAgIHNvY2suc2V0dGltZW91dCh0aW1lb3V0KQogICAgICAgICAgICBpZiBzb3VyY2VfYWRkcmVzczoKICAgICAgICAgICAgICAgIHNvY2suYmluZChzb3VyY2VfYWRkcmVzcykKICAgICAgICAgICAgc29jay5jb25uZWN0KHNhKQogICAgICAgICAgICByZXR1cm4gc29jawoKICAgICAgICBleGNlcHQgZXJyb3IgYXMgXzoKICAgICAgICAgICAgZXJyID0gXwogICAgICAgICAgICBpZiBzb2NrIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgc29jay5jbG9zZSgpCgogICAgaWYgZXJyIGlzIG5vdCBOb25lOgogICAgICAgIHJhaXNlIGVycgogICAgZWxzZToKICAgICAgICByYWlzZSBlcnJvcigiZ2V0YWRkcmluZm8gcmV0dXJucyBhbiBlbXB0eSBsaXN0IikK',
'/Lib/stat.py':'IiIiQ29uc3RhbnRzL2Z1bmN0aW9ucyBmb3IgaW50ZXJwcmV0aW5nIHJlc3VsdHMgb2Ygb3Muc3RhdCgpIGFuZCBvcy5sc3RhdCgpLgoKU3VnZ2VzdGVkIHVzYWdlOiBmcm9tIHN0YXQgaW1wb3J0ICoKIiIiCgojIEluZGljZXMgZm9yIHN0YXQgc3RydWN0IG1lbWJlcnMgaW4gdGhlIHR1cGxlIHJldHVybmVkIGJ5IG9zLnN0YXQoKQoKU1RfTU9ERSAgPSAwClNUX0lOTyAgID0gMQpTVF9ERVYgICA9IDIKU1RfTkxJTksgPSAzClNUX1VJRCAgID0gNApTVF9HSUQgICA9IDUKU1RfU0laRSAgPSA2ClNUX0FUSU1FID0gNwpTVF9NVElNRSA9IDgKU1RfQ1RJTUUgPSA5CgojIEV4dHJhY3QgYml0cyBmcm9tIHRoZSBtb2RlCgpkZWYgU19JTU9ERShtb2RlKToKICAgICIiIlJldHVybiB0aGUgcG9ydGlvbiBvZiB0aGUgZmlsZSdzIG1vZGUgdGhhdCBjYW4gYmUgc2V0IGJ5CiAgICBvcy5jaG1vZCgpLgogICAgIiIiCiAgICByZXR1cm4gbW9kZSAmIDBvNzc3NwoKZGVmIFNfSUZNVChtb2RlKToKICAgICIiIlJldHVybiB0aGUgcG9ydGlvbiBvZiB0aGUgZmlsZSdzIG1vZGUgdGhhdCBkZXNjcmliZXMgdGhlCiAgICBmaWxlIHR5cGUuCiAgICAiIiIKICAgIHJldHVybiBtb2RlICYgMG8xNzAwMDAKCiMgQ29uc3RhbnRzIHVzZWQgYXMgU19JRk1UKCkgZm9yIHZhcmlvdXMgZmlsZSB0eXBlcwojIChub3QgYWxsIGFyZSBpbXBsZW1lbnRlZCBvbiBhbGwgc3lzdGVtcykKClNfSUZESVIgID0gMG8wNDAwMDAgICMgZGlyZWN0b3J5ClNfSUZDSFIgID0gMG8wMjAwMDAgICMgY2hhcmFjdGVyIGRldmljZQpTX0lGQkxLICA9IDBvMDYwMDAwICAjIGJsb2NrIGRldmljZQpTX0lGUkVHICA9IDBvMTAwMDAwICAjIHJlZ3VsYXIgZmlsZQpTX0lGSUZPICA9IDBvMDEwMDAwICAjIGZpZm8gKG5hbWVkIHBpcGUpClNfSUZMTksgID0gMG8xMjAwMDAgICMgc3ltYm9saWMgbGluawpTX0lGU09DSyA9IDBvMTQwMDAwICAjIHNvY2tldCBmaWxlCgojIEZ1bmN0aW9ucyB0byB0ZXN0IGZvciBlYWNoIGZpbGUgdHlwZQoKZGVmIFNfSVNESVIobW9kZSk6CiAgICAiIiJSZXR1cm4gVHJ1ZSBpZiBtb2RlIGlzIGZyb20gYSBkaXJlY3RvcnkuIiIiCiAgICByZXR1cm4gU19JRk1UKG1vZGUpID09IFNfSUZESVIKCmRlZiBTX0lTQ0hSKG1vZGUpOgogICAgIiIiUmV0dXJuIFRydWUgaWYgbW9kZSBpcyBmcm9tIGEgY2hhcmFjdGVyIHNwZWNpYWwgZGV2aWNlIGZpbGUuIiIiCiAgICByZXR1cm4gU19JRk1UKG1vZGUpID09IFNfSUZDSFIKCmRlZiBTX0lTQkxLKG1vZGUpOgogICAgIiIiUmV0dXJuIFRydWUgaWYgbW9kZSBpcyBmcm9tIGEgYmxvY2sgc3BlY2lhbCBkZXZpY2UgZmlsZS4iIiIKICAgIHJldHVybiBTX0lGTVQobW9kZSkgPT0gU19JRkJMSwoKZGVmIFNfSVNSRUcobW9kZSk6CiAgICAiIiJSZXR1cm4gVHJ1ZSBpZiBtb2RlIGlzIGZyb20gYSByZWd1bGFyIGZpbGUuIiIiCiAgICByZXR1cm4gU19JRk1UKG1vZGUpID09IFNfSUZSRUcKCmRlZiBTX0lTRklGTyhtb2RlKToKICAgICIiIlJldHVybiBUcnVlIGlmIG1vZGUgaXMgZnJvbSBhIEZJRk8gKG5hbWVkIHBpcGUpLiIiIgogICAgcmV0dXJuIFNfSUZNVChtb2RlKSA9PSBTX0lGSUZPCgpkZWYgU19JU0xOSyhtb2RlKToKICAgICIiIlJldHVybiBUcnVlIGlmIG1vZGUgaXMgZnJvbSBhIHN5bWJvbGljIGxpbmsuIiIiCiAgICByZXR1cm4gU19JRk1UKG1vZGUpID09IFNfSUZMTksKCmRlZiBTX0lTU09DSyhtb2RlKToKICAgICIiIlJldHVybiBUcnVlIGlmIG1vZGUgaXMgZnJvbSBhIHNvY2tldC4iIiIKICAgIHJldHVybiBTX0lGTVQobW9kZSkgPT0gU19JRlNPQ0sKCiMgTmFtZXMgZm9yIHBlcm1pc3Npb24gYml0cwoKU19JU1VJRCA9IDBvNDAwMCAgIyBzZXQgVUlEIGJpdApTX0lTR0lEID0gMG8yMDAwICAjIHNldCBHSUQgYml0ClNfRU5GTVQgPSBTX0lTR0lEICMgZmlsZSBsb2NraW5nIGVuZm9yY2VtZW50ClNfSVNWVFggPSAwbzEwMDAgICMgc3RpY2t5IGJpdApTX0lSRUFEID0gMG8wNDAwICAjIFVuaXggVjcgc3lub255bSBmb3IgU19JUlVTUgpTX0lXUklURSA9IDBvMDIwMCAjIFVuaXggVjcgc3lub255bSBmb3IgU19JV1VTUgpTX0lFWEVDID0gMG8wMTAwICAjIFVuaXggVjcgc3lub255bSBmb3IgU19JWFVTUgpTX0lSV1hVID0gMG8wNzAwICAjIG1hc2sgZm9yIG93bmVyIHBlcm1pc3Npb25zClNfSVJVU1IgPSAwbzA0MDAgICMgcmVhZCBieSBvd25lcgpTX0lXVVNSID0gMG8wMjAwICAjIHdyaXRlIGJ5IG93bmVyClNfSVhVU1IgPSAwbzAxMDAgICMgZXhlY3V0ZSBieSBvd25lcgpTX0lSV1hHID0gMG8wMDcwICAjIG1hc2sgZm9yIGdyb3VwIHBlcm1pc3Npb25zClNfSVJHUlAgPSAwbzAwNDAgICMgcmVhZCBieSBncm91cApTX0lXR1JQID0gMG8wMDIwICAjIHdyaXRlIGJ5IGdyb3VwClNfSVhHUlAgPSAwbzAwMTAgICMgZXhlY3V0ZSBieSBncm91cApTX0lSV1hPID0gMG8wMDA3ICAjIG1hc2sgZm9yIG90aGVycyAobm90IGluIGdyb3VwKSBwZXJtaXNzaW9ucwpTX0lST1RIID0gMG8wMDA0ICAjIHJlYWQgYnkgb3RoZXJzClNfSVdPVEggPSAwbzAwMDIgICMgd3JpdGUgYnkgb3RoZXJzClNfSVhPVEggPSAwbzAwMDEgICMgZXhlY3V0ZSBieSBvdGhlcnMKCiMgTmFtZXMgZm9yIGZpbGUgZmxhZ3MKClVGX05PRFVNUCAgICA9IDB4MDAwMDAwMDEgICMgZG8gbm90IGR1bXAgZmlsZQpVRl9JTU1VVEFCTEUgPSAweDAwMDAwMDAyICAjIGZpbGUgbWF5IG5vdCBiZSBjaGFuZ2VkClVGX0FQUEVORCAgICA9IDB4MDAwMDAwMDQgICMgZmlsZSBtYXkgb25seSBiZSBhcHBlbmRlZCB0bwpVRl9PUEFRVUUgICAgPSAweDAwMDAwMDA4ICAjIGRpcmVjdG9yeSBpcyBvcGFxdWUgd2hlbiB2aWV3ZWQgdGhyb3VnaCBhIHVuaW9uIHN0YWNrClVGX05PVU5MSU5LICA9IDB4MDAwMDAwMTAgICMgZmlsZSBtYXkgbm90IGJlIHJlbmFtZWQgb3IgZGVsZXRlZApVRl9DT01QUkVTU0VEID0gMHgwMDAwMDAyMCAjIE9TIFg6IGZpbGUgaXMgaGZzLWNvbXByZXNzZWQKVUZfSElEREVOICAgID0gMHgwMDAwODAwMCAgIyBPUyBYOiBmaWxlIHNob3VsZCBub3QgYmUgZGlzcGxheWVkClNGX0FSQ0hJVkVEICA9IDB4MDAwMTAwMDAgICMgZmlsZSBtYXkgYmUgYXJjaGl2ZWQKU0ZfSU1NVVRBQkxFID0gMHgwMDAyMDAwMCAgIyBmaWxlIG1heSBub3QgYmUgY2hhbmdlZApTRl9BUFBFTkQgICAgPSAweDAwMDQwMDAwICAjIGZpbGUgbWF5IG9ubHkgYmUgYXBwZW5kZWQgdG8KU0ZfTk9VTkxJTksgID0gMHgwMDEwMDAwMCAgIyBmaWxlIG1heSBub3QgYmUgcmVuYW1lZCBvciBkZWxldGVkClNGX1NOQVBTSE9UICA9IDB4MDAyMDAwMDAgICMgZmlsZSBpcyBhIHNuYXBzaG90IGZpbGUKCgpfZmlsZW1vZGVfdGFibGUgPSAoCiAgICAoKFNfSUZMTkssICAgICAgICAgImwiKSwKICAgICAoU19JRlJFRywgICAgICAgICAiLSIpLAogICAgIChTX0lGQkxLLCAgICAgICAgICJiIiksCiAgICAgKFNfSUZESVIsICAgICAgICAgImQiKSwKICAgICAoU19JRkNIUiwgICAgICAgICAiYyIpLAogICAgIChTX0lGSUZPLCAgICAgICAgICJwIikpLAoKICAgICgoU19JUlVTUiwgICAgICAgICAiciIpLCksCiAgICAoKFNfSVdVU1IsICAgICAgICAgInciKSwpLAogICAgKChTX0lYVVNSfFNfSVNVSUQsICJzIiksCiAgICAgKFNfSVNVSUQsICAgICAgICAgIlMiKSwKICAgICAoU19JWFVTUiwgICAgICAgICAieCIpKSwKCiAgICAoKFNfSVJHUlAsICAgICAgICAgInIiKSwpLAogICAgKChTX0lXR1JQLCAgICAgICAgICJ3IiksKSwKICAgICgoU19JWEdSUHxTX0lTR0lELCAicyIpLAogICAgIChTX0lTR0lELCAgICAgICAgICJTIiksCiAgICAgKFNfSVhHUlAsICAgICAgICAgIngiKSksCgogICAgKChTX0lST1RILCAgICAgICAgICJyIiksKSwKICAgICgoU19JV09USCwgICAgICAgICAidyIpLCksCiAgICAoKFNfSVhPVEh8U19JU1ZUWCwgInQiKSwKICAgICAoU19JU1ZUWCwgICAgICAgICAiVCIpLAogICAgIChTX0lYT1RILCAgICAgICAgICJ4IikpCikKCmRlZiBmaWxlbW9kZShtb2RlKToKICAgICIiIkNvbnZlcnQgYSBmaWxlJ3MgbW9kZSB0byBhIHN0cmluZyBvZiB0aGUgZm9ybSAnLXJ3eHJ3eHJ3eCcuIiIiCiAgICBwZXJtID0gW10KICAgIGZvciB0YWJsZSBpbiBfZmlsZW1vZGVfdGFibGU6CiAgICAgICAgZm9yIGJpdCwgY2hhciBpbiB0YWJsZToKICAgICAgICAgICAgaWYgbW9kZSAmIGJpdCA9PSBiaXQ6CiAgICAgICAgICAgICAgICBwZXJtLmFwcGVuZChjaGFyKQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICBlbHNlOgogICAgICAgICAgICBwZXJtLmFwcGVuZCgiLSIpCiAgICByZXR1cm4gIiIuam9pbihwZXJtKQo=',
'/Lib/string.py':'IyBTb21lIHN0cmluZ3MgZm9yIGN0eXBlLXN0eWxlIGNoYXJhY3RlciBjbGFzc2lmaWNhdGlvbgp3aGl0ZXNwYWNlID0gJyBcdFxuXHJcdlxmJwphc2NpaV9sb3dlcmNhc2UgPSAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonCmFzY2lpX3VwcGVyY2FzZSA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWicKYXNjaWlfbGV0dGVycyA9IGFzY2lpX2xvd2VyY2FzZSArIGFzY2lpX3VwcGVyY2FzZQpkaWdpdHMgPSAnMDEyMzQ1Njc4OScKaGV4ZGlnaXRzID0gZGlnaXRzICsgJ2FiY2RlZicgKyAnQUJDREVGJwpvY3RkaWdpdHMgPSAnMDEyMzQ1NjcnCnB1bmN0dWF0aW9uID0gIiIiISIjJCUmJygpKissLS4vOjs8PT4/QFtcXV5fYHt8fX4iIiIKcHJpbnRhYmxlID0gZGlnaXRzICsgYXNjaWlfbGV0dGVycyArIHB1bmN0dWF0aW9uICsgd2hpdGVzcGFjZQoKIyBGdW5jdGlvbnMgd2hpY2ggYXJlbid0IGF2YWlsYWJsZSBhcyBzdHJpbmcgbWV0aG9kcy4KCiMgQ2FwaXRhbGl6ZSB0aGUgd29yZHMgaW4gYSBzdHJpbmcsIGUuZy4gIiBhQmMgIGRFZiAiIC0+ICJBYmMgRGVmIi4KZGVmIGNhcHdvcmRzKHMsIHNlcD1Ob25lKToKICAgICIiImNhcHdvcmRzKHMgWyxzZXBdKSAtPiBzdHJpbmcKCiAgICBTcGxpdCB0aGUgYXJndW1lbnQgaW50byB3b3JkcyB1c2luZyBzcGxpdCwgY2FwaXRhbGl6ZSBlYWNoCiAgICB3b3JkIHVzaW5nIGNhcGl0YWxpemUsIGFuZCBqb2luIHRoZSBjYXBpdGFsaXplZCB3b3JkcyB1c2luZwogICAgam9pbi4gIElmIHRoZSBvcHRpb25hbCBzZWNvbmQgYXJndW1lbnQgc2VwIGlzIGFic2VudCBvciBOb25lLAogICAgcnVucyBvZiB3aGl0ZXNwYWNlIGNoYXJhY3RlcnMgYXJlIHJlcGxhY2VkIGJ5IGEgc2luZ2xlIHNwYWNlCiAgICBhbmQgbGVhZGluZyBhbmQgdHJhaWxpbmcgd2hpdGVzcGFjZSBhcmUgcmVtb3ZlZCwgb3RoZXJ3aXNlCiAgICBzZXAgaXMgdXNlZCB0byBzcGxpdCBhbmQgam9pbiB0aGUgd29yZHMuCgogICAgIiIiCiAgICByZXR1cm4gKHNlcCBvciAnICcpLmpvaW4oeC5jYXBpdGFsaXplKCkgZm9yIHggaW4gcy5zcGxpdChzZXApKQo=',
'/Lib/struct.py':'X19hbGxfXyA9IFsKICAgICMgRnVuY3Rpb25zCiAgICAnY2FsY3NpemUnLCAncGFjaycsICdwYWNrX2ludG8nLCAndW5wYWNrJywgJ3VucGFja19mcm9tJywKCiAgICAjIENsYXNzZXMKICAgICdTdHJ1Y3QnLAoKICAgICMgRXhjZXB0aW9ucwogICAgJ2Vycm9yJwogICAgXQoKZnJvbSBfc3RydWN0IGltcG9ydCAqCmZyb20gX3N0cnVjdCBpbXBvcnQgX2NsZWFyY2FjaGUKZnJvbSBfc3RydWN0IGltcG9ydCBfX2RvY19fCg==',
'/Lib/subprocess.py':'IiIic3VicHJvY2VzcyAtIFN1YnByb2Nlc3NlcyB3aXRoIGFjY2Vzc2libGUgSS9PIHN0cmVhbXMKClRoaXMgbW9kdWxlIGFsbG93cyB5b3UgdG8gc3Bhd24gcHJvY2Vzc2VzLCBjb25uZWN0IHRvIHRoZWlyCmlucHV0L291dHB1dC9lcnJvciBwaXBlcywgYW5kIG9idGFpbiB0aGVpciByZXR1cm4gY29kZXMuICBUaGlzIG1vZHVsZQppbnRlbmRzIHRvIHJlcGxhY2Ugc2V2ZXJhbCBvdGhlciwgb2xkZXIgbW9kdWxlcyBhbmQgZnVuY3Rpb25zLCBsaWtlOgoKb3Muc3lzdGVtCm9zLnNwYXduKgpvcy5wb3BlbioKcG9wZW4yLioKY29tbWFuZHMuKgoKSW5mb3JtYXRpb24gYWJvdXQgaG93IHRoZSBzdWJwcm9jZXNzIG1vZHVsZSBjYW4gYmUgdXNlZCB0byByZXBsYWNlIHRoZXNlCm1vZHVsZXMgYW5kIGZ1bmN0aW9ucyBjYW4gYmUgZm91bmQgYmVsb3cuCgoKClVzaW5nIHRoZSBzdWJwcm9jZXNzIG1vZHVsZQo9PT09PT09PT09PT09PT09PT09PT09PT09PT0KVGhpcyBtb2R1bGUgZGVmaW5lcyBvbmUgY2xhc3MgY2FsbGVkIFBvcGVuOgoKY2xhc3MgUG9wZW4oYXJncywgYnVmc2l6ZT0wLCBleGVjdXRhYmxlPU5vbmUsCiAgICAgICAgICAgIHN0ZGluPU5vbmUsIHN0ZG91dD1Ob25lLCBzdGRlcnI9Tm9uZSwKICAgICAgICAgICAgcHJlZXhlY19mbj1Ob25lLCBjbG9zZV9mZHM9RmFsc2UsIHNoZWxsPUZhbHNlLAogICAgICAgICAgICBjd2Q9Tm9uZSwgZW52PU5vbmUsIHVuaXZlcnNhbF9uZXdsaW5lcz1GYWxzZSwKICAgICAgICAgICAgc3RhcnR1cGluZm89Tm9uZSwgY3JlYXRpb25mbGFncz0wKToKCgpBcmd1bWVudHMgYXJlOgoKYXJncyBzaG91bGQgYmUgYSBzdHJpbmcsIG9yIGEgc2VxdWVuY2Ugb2YgcHJvZ3JhbSBhcmd1bWVudHMuICBUaGUKcHJvZ3JhbSB0byBleGVjdXRlIGlzIG5vcm1hbGx5IHRoZSBmaXJzdCBpdGVtIGluIHRoZSBhcmdzIHNlcXVlbmNlIG9yCnN0cmluZywgYnV0IGNhbiBiZSBleHBsaWNpdGx5IHNldCBieSB1c2luZyB0aGUgZXhlY3V0YWJsZSBhcmd1bWVudC4KCk9uIFVOSVgsIHdpdGggc2hlbGw9RmFsc2UgKGRlZmF1bHQpOiBJbiB0aGlzIGNhc2UsIHRoZSBQb3BlbiBjbGFzcwp1c2VzIG9zLmV4ZWN2cCgpIHRvIGV4ZWN1dGUgdGhlIGNoaWxkIHByb2dyYW0uICBhcmdzIHNob3VsZCBub3JtYWxseQpiZSBhIHNlcXVlbmNlLiAgQSBzdHJpbmcgd2lsbCBiZSB0cmVhdGVkIGFzIGEgc2VxdWVuY2Ugd2l0aCB0aGUgc3RyaW5nCmFzIHRoZSBvbmx5IGl0ZW0gKHRoZSBwcm9ncmFtIHRvIGV4ZWN1dGUpLgoKT24gVU5JWCwgd2l0aCBzaGVsbD1UcnVlOiBJZiBhcmdzIGlzIGEgc3RyaW5nLCBpdCBzcGVjaWZpZXMgdGhlCmNvbW1hbmQgc3RyaW5nIHRvIGV4ZWN1dGUgdGhyb3VnaCB0aGUgc2hlbGwuICBJZiBhcmdzIGlzIGEgc2VxdWVuY2UsCnRoZSBmaXJzdCBpdGVtIHNwZWNpZmllcyB0aGUgY29tbWFuZCBzdHJpbmcsIGFuZCBhbnkgYWRkaXRpb25hbCBpdGVtcwp3aWxsIGJlIHRyZWF0ZWQgYXMgYWRkaXRpb25hbCBzaGVsbCBhcmd1bWVudHMuCgpPbiBXaW5kb3dzOiB0aGUgUG9wZW4gY2xhc3MgdXNlcyBDcmVhdGVQcm9jZXNzKCkgdG8gZXhlY3V0ZSB0aGUgY2hpbGQKcHJvZ3JhbSwgd2hpY2ggb3BlcmF0ZXMgb24gc3RyaW5ncy4gIElmIGFyZ3MgaXMgYSBzZXF1ZW5jZSwgaXQgd2lsbCBiZQpjb252ZXJ0ZWQgdG8gYSBzdHJpbmcgdXNpbmcgdGhlIGxpc3QyY21kbGluZSBtZXRob2QuICBQbGVhc2Ugbm90ZSB0aGF0Cm5vdCBhbGwgTVMgV2luZG93cyBhcHBsaWNhdGlvbnMgaW50ZXJwcmV0IHRoZSBjb21tYW5kIGxpbmUgdGhlIHNhbWUKd2F5OiBUaGUgbGlzdDJjbWRsaW5lIGlzIGRlc2lnbmVkIGZvciBhcHBsaWNhdGlvbnMgdXNpbmcgdGhlIHNhbWUKcnVsZXMgYXMgdGhlIE1TIEMgcnVudGltZS4KCmJ1ZnNpemUsIGlmIGdpdmVuLCBoYXMgdGhlIHNhbWUgbWVhbmluZyBhcyB0aGUgY29ycmVzcG9uZGluZyBhcmd1bWVudAp0byB0aGUgYnVpbHQtaW4gb3BlbigpIGZ1bmN0aW9uOiAwIG1lYW5zIHVuYnVmZmVyZWQsIDEgbWVhbnMgbGluZQpidWZmZXJlZCwgYW55IG90aGVyIHBvc2l0aXZlIHZhbHVlIG1lYW5zIHVzZSBhIGJ1ZmZlciBvZgooYXBwcm94aW1hdGVseSkgdGhhdCBzaXplLiAgQSBuZWdhdGl2ZSBidWZzaXplIG1lYW5zIHRvIHVzZSB0aGUgc3lzdGVtCmRlZmF1bHQsIHdoaWNoIHVzdWFsbHkgbWVhbnMgZnVsbHkgYnVmZmVyZWQuICBUaGUgZGVmYXVsdCB2YWx1ZSBmb3IKYnVmc2l6ZSBpcyAwICh1bmJ1ZmZlcmVkKS4KCnN0ZGluLCBzdGRvdXQgYW5kIHN0ZGVyciBzcGVjaWZ5IHRoZSBleGVjdXRlZCBwcm9ncmFtcycgc3RhbmRhcmQKaW5wdXQsIHN0YW5kYXJkIG91dHB1dCBhbmQgc3RhbmRhcmQgZXJyb3IgZmlsZSBoYW5kbGVzLCByZXNwZWN0aXZlbHkuClZhbGlkIHZhbHVlcyBhcmUgUElQRSwgYW4gZXhpc3RpbmcgZmlsZSBkZXNjcmlwdG9yIChhIHBvc2l0aXZlCmludGVnZXIpLCBhbiBleGlzdGluZyBmaWxlIG9iamVjdCwgYW5kIE5vbmUuICBQSVBFIGluZGljYXRlcyB0aGF0IGEKbmV3IHBpcGUgdG8gdGhlIGNoaWxkIHNob3VsZCBiZSBjcmVhdGVkLiAgV2l0aCBOb25lLCBubyByZWRpcmVjdGlvbgp3aWxsIG9jY3VyOyB0aGUgY2hpbGQncyBmaWxlIGhhbmRsZXMgd2lsbCBiZSBpbmhlcml0ZWQgZnJvbSB0aGUKcGFyZW50LiAgQWRkaXRpb25hbGx5LCBzdGRlcnIgY2FuIGJlIFNURE9VVCwgd2hpY2ggaW5kaWNhdGVzIHRoYXQgdGhlCnN0ZGVyciBkYXRhIGZyb20gdGhlIGFwcGxpY2F0aW9ucyBzaG91bGQgYmUgY2FwdHVyZWQgaW50byB0aGUgc2FtZQpmaWxlIGhhbmRsZSBhcyBmb3Igc3Rkb3V0LgoKSWYgcHJlZXhlY19mbiBpcyBzZXQgdG8gYSBjYWxsYWJsZSBvYmplY3QsIHRoaXMgb2JqZWN0IHdpbGwgYmUgY2FsbGVkCmluIHRoZSBjaGlsZCBwcm9jZXNzIGp1c3QgYmVmb3JlIHRoZSBjaGlsZCBpcyBleGVjdXRlZC4KCklmIGNsb3NlX2ZkcyBpcyB0cnVlLCBhbGwgZmlsZSBkZXNjcmlwdG9ycyBleGNlcHQgMCwgMSBhbmQgMiB3aWxsIGJlCmNsb3NlZCBiZWZvcmUgdGhlIGNoaWxkIHByb2Nlc3MgaXMgZXhlY3V0ZWQuCgppZiBzaGVsbCBpcyB0cnVlLCB0aGUgc3BlY2lmaWVkIGNvbW1hbmQgd2lsbCBiZSBleGVjdXRlZCB0aHJvdWdoIHRoZQpzaGVsbC4KCklmIGN3ZCBpcyBub3QgTm9uZSwgdGhlIGN1cnJlbnQgZGlyZWN0b3J5IHdpbGwgYmUgY2hhbmdlZCB0byBjd2QKYmVmb3JlIHRoZSBjaGlsZCBpcyBleGVjdXRlZC4KCklmIGVudiBpcyBub3QgTm9uZSwgaXQgZGVmaW5lcyB0aGUgZW52aXJvbm1lbnQgdmFyaWFibGVzIGZvciB0aGUgbmV3CnByb2Nlc3MuCgpJZiB1bml2ZXJzYWxfbmV3bGluZXMgaXMgdHJ1ZSwgdGhlIGZpbGUgb2JqZWN0cyBzdGRvdXQgYW5kIHN0ZGVyciBhcmUKb3BlbmVkIGFzIGEgdGV4dCBmaWxlcywgYnV0IGxpbmVzIG1heSBiZSB0ZXJtaW5hdGVkIGJ5IGFueSBvZiAnXG4nLAp0aGUgVW5peCBlbmQtb2YtbGluZSBjb252ZW50aW9uLCAnXHInLCB0aGUgTWFjaW50b3NoIGNvbnZlbnRpb24gb3IKJ1xyXG4nLCB0aGUgV2luZG93cyBjb252ZW50aW9uLiAgQWxsIG9mIHRoZXNlIGV4dGVybmFsIHJlcHJlc2VudGF0aW9ucwphcmUgc2VlbiBhcyAnXG4nIGJ5IHRoZSBQeXRob24gcHJvZ3JhbS4gIE5vdGU6IFRoaXMgZmVhdHVyZSBpcyBvbmx5CmF2YWlsYWJsZSBpZiBQeXRob24gaXMgYnVpbHQgd2l0aCB1bml2ZXJzYWwgbmV3bGluZSBzdXBwb3J0ICh0aGUKZGVmYXVsdCkuICBBbHNvLCB0aGUgbmV3bGluZXMgYXR0cmlidXRlIG9mIHRoZSBmaWxlIG9iamVjdHMgc3Rkb3V0LApzdGRpbiBhbmQgc3RkZXJyIGFyZSBub3QgdXBkYXRlZCBieSB0aGUgY29tbXVuaWNhdGUoKSBtZXRob2QuCgpUaGUgc3RhcnR1cGluZm8gYW5kIGNyZWF0aW9uZmxhZ3MsIGlmIGdpdmVuLCB3aWxsIGJlIHBhc3NlZCB0byB0aGUKdW5kZXJseWluZyBDcmVhdGVQcm9jZXNzKCkgZnVuY3Rpb24uICBUaGV5IGNhbiBzcGVjaWZ5IHRoaW5ncyBzdWNoIGFzCmFwcGVhcmFuY2Ugb2YgdGhlIG1haW4gd2luZG93IGFuZCBwcmlvcml0eSBmb3IgdGhlIG5ldyBwcm9jZXNzLgooV2luZG93cyBvbmx5KQoKClRoaXMgbW9kdWxlIGFsc28gZGVmaW5lcyBzb21lIHNob3J0Y3V0IGZ1bmN0aW9uczoKCmNhbGwoKnBvcGVuYXJncywgKiprd2FyZ3MpOgogICAgUnVuIGNvbW1hbmQgd2l0aCBhcmd1bWVudHMuICBXYWl0IGZvciBjb21tYW5kIHRvIGNvbXBsZXRlLCB0aGVuCiAgICByZXR1cm4gdGhlIHJldHVybmNvZGUgYXR0cmlidXRlLgoKICAgIFRoZSBhcmd1bWVudHMgYXJlIHRoZSBzYW1lIGFzIGZvciB0aGUgUG9wZW4gY29uc3RydWN0b3IuICBFeGFtcGxlOgoKICAgIHJldGNvZGUgPSBjYWxsKFsibHMiLCAiLWwiXSkKCmNoZWNrX2NhbGwoKnBvcGVuYXJncywgKiprd2FyZ3MpOgogICAgUnVuIGNvbW1hbmQgd2l0aCBhcmd1bWVudHMuICBXYWl0IGZvciBjb21tYW5kIHRvIGNvbXBsZXRlLiAgSWYgdGhlCiAgICBleGl0IGNvZGUgd2FzIHplcm8gdGhlbiByZXR1cm4sIG90aGVyd2lzZSByYWlzZQogICAgQ2FsbGVkUHJvY2Vzc0Vycm9yLiAgVGhlIENhbGxlZFByb2Nlc3NFcnJvciBvYmplY3Qgd2lsbCBoYXZlIHRoZQogICAgcmV0dXJuIGNvZGUgaW4gdGhlIHJldHVybmNvZGUgYXR0cmlidXRlLgoKICAgIFRoZSBhcmd1bWVudHMgYXJlIHRoZSBzYW1lIGFzIGZvciB0aGUgUG9wZW4gY29uc3RydWN0b3IuICBFeGFtcGxlOgoKICAgIGNoZWNrX2NhbGwoWyJscyIsICItbCJdKQoKY2hlY2tfb3V0cHV0KCpwb3BlbmFyZ3MsICoqa3dhcmdzKToKICAgIFJ1biBjb21tYW5kIHdpdGggYXJndW1lbnRzIGFuZCByZXR1cm4gaXRzIG91dHB1dCBhcyBhIGJ5dGUgc3RyaW5nLgoKICAgIElmIHRoZSBleGl0IGNvZGUgd2FzIG5vbi16ZXJvIGl0IHJhaXNlcyBhIENhbGxlZFByb2Nlc3NFcnJvci4gIFRoZQogICAgQ2FsbGVkUHJvY2Vzc0Vycm9yIG9iamVjdCB3aWxsIGhhdmUgdGhlIHJldHVybiBjb2RlIGluIHRoZSByZXR1cm5jb2RlCiAgICBhdHRyaWJ1dGUgYW5kIG91dHB1dCBpbiB0aGUgb3V0cHV0IGF0dHJpYnV0ZS4KCiAgICBUaGUgYXJndW1lbnRzIGFyZSB0aGUgc2FtZSBhcyBmb3IgdGhlIFBvcGVuIGNvbnN0cnVjdG9yLiAgRXhhbXBsZToKCiAgICBvdXRwdXQgPSBjaGVja19vdXRwdXQoWyJscyIsICItbCIsICIvZGV2L251bGwiXSkKCgpFeGNlcHRpb25zCi0tLS0tLS0tLS0KRXhjZXB0aW9ucyByYWlzZWQgaW4gdGhlIGNoaWxkIHByb2Nlc3MsIGJlZm9yZSB0aGUgbmV3IHByb2dyYW0gaGFzCnN0YXJ0ZWQgdG8gZXhlY3V0ZSwgd2lsbCBiZSByZS1yYWlzZWQgaW4gdGhlIHBhcmVudC4gIEFkZGl0aW9uYWxseSwKdGhlIGV4Y2VwdGlvbiBvYmplY3Qgd2lsbCBoYXZlIG9uZSBleHRyYSBhdHRyaWJ1dGUgY2FsbGVkCidjaGlsZF90cmFjZWJhY2snLCB3aGljaCBpcyBhIHN0cmluZyBjb250YWluaW5nIHRyYWNlYmFjayBpbmZvcm1hdGlvbgpmcm9tIHRoZSBjaGlsZHMgcG9pbnQgb2Ygdmlldy4KClRoZSBtb3N0IGNvbW1vbiBleGNlcHRpb24gcmFpc2VkIGlzIE9TRXJyb3IuICBUaGlzIG9jY3VycywgZm9yCmV4YW1wbGUsIHdoZW4gdHJ5aW5nIHRvIGV4ZWN1dGUgYSBub24tZXhpc3RlbnQgZmlsZS4gIEFwcGxpY2F0aW9ucwpzaG91bGQgcHJlcGFyZSBmb3IgT1NFcnJvcnMuCgpBIFZhbHVlRXJyb3Igd2lsbCBiZSByYWlzZWQgaWYgUG9wZW4gaXMgY2FsbGVkIHdpdGggaW52YWxpZCBhcmd1bWVudHMuCgpjaGVja19jYWxsKCkgYW5kIGNoZWNrX291dHB1dCgpIHdpbGwgcmFpc2UgQ2FsbGVkUHJvY2Vzc0Vycm9yLCBpZiB0aGUKY2FsbGVkIHByb2Nlc3MgcmV0dXJucyBhIG5vbi16ZXJvIHJldHVybiBjb2RlLgoKClNlY3VyaXR5Ci0tLS0tLS0tClVubGlrZSBzb21lIG90aGVyIHBvcGVuIGZ1bmN0aW9ucywgdGhpcyBpbXBsZW1lbnRhdGlvbiB3aWxsIG5ldmVyIGNhbGwKL2Jpbi9zaCBpbXBsaWNpdGx5LiAgVGhpcyBtZWFucyB0aGF0IGFsbCBjaGFyYWN0ZXJzLCBpbmNsdWRpbmcgc2hlbGwKbWV0YWNoYXJhY3RlcnMsIGNhbiBzYWZlbHkgYmUgcGFzc2VkIHRvIGNoaWxkIHByb2Nlc3Nlcy4KCgpQb3BlbiBvYmplY3RzCj09PT09PT09PT09PT0KSW5zdGFuY2VzIG9mIHRoZSBQb3BlbiBjbGFzcyBoYXZlIHRoZSBmb2xsb3dpbmcgbWV0aG9kczoKCnBvbGwoKQogICAgQ2hlY2sgaWYgY2hpbGQgcHJvY2VzcyBoYXMgdGVybWluYXRlZC4gIFJldHVybnMgcmV0dXJuY29kZQogICAgYXR0cmlidXRlLgoKd2FpdCgpCiAgICBXYWl0IGZvciBjaGlsZCBwcm9jZXNzIHRvIHRlcm1pbmF0ZS4gIFJldHVybnMgcmV0dXJuY29kZSBhdHRyaWJ1dGUuCgpjb21tdW5pY2F0ZShpbnB1dD1Ob25lKQogICAgSW50ZXJhY3Qgd2l0aCBwcm9jZXNzOiBTZW5kIGRhdGEgdG8gc3RkaW4uICBSZWFkIGRhdGEgZnJvbSBzdGRvdXQKICAgIGFuZCBzdGRlcnIsIHVudGlsIGVuZC1vZi1maWxlIGlzIHJlYWNoZWQuICBXYWl0IGZvciBwcm9jZXNzIHRvCiAgICB0ZXJtaW5hdGUuICBUaGUgb3B0aW9uYWwgaW5wdXQgYXJndW1lbnQgc2hvdWxkIGJlIGEgc3RyaW5nIHRvIGJlCiAgICBzZW50IHRvIHRoZSBjaGlsZCBwcm9jZXNzLCBvciBOb25lLCBpZiBubyBkYXRhIHNob3VsZCBiZSBzZW50IHRvCiAgICB0aGUgY2hpbGQuCgogICAgY29tbXVuaWNhdGUoKSByZXR1cm5zIGEgdHVwbGUgKHN0ZG91dCwgc3RkZXJyKS4KCiAgICBOb3RlOiBUaGUgZGF0YSByZWFkIGlzIGJ1ZmZlcmVkIGluIG1lbW9yeSwgc28gZG8gbm90IHVzZSB0aGlzCiAgICBtZXRob2QgaWYgdGhlIGRhdGEgc2l6ZSBpcyBsYXJnZSBvciB1bmxpbWl0ZWQuCgpUaGUgZm9sbG93aW5nIGF0dHJpYnV0ZXMgYXJlIGFsc28gYXZhaWxhYmxlOgoKc3RkaW4KICAgIElmIHRoZSBzdGRpbiBhcmd1bWVudCBpcyBQSVBFLCB0aGlzIGF0dHJpYnV0ZSBpcyBhIGZpbGUgb2JqZWN0CiAgICB0aGF0IHByb3ZpZGVzIGlucHV0IHRvIHRoZSBjaGlsZCBwcm9jZXNzLiAgT3RoZXJ3aXNlLCBpdCBpcyBOb25lLgoKc3Rkb3V0CiAgICBJZiB0aGUgc3Rkb3V0IGFyZ3VtZW50IGlzIFBJUEUsIHRoaXMgYXR0cmlidXRlIGlzIGEgZmlsZSBvYmplY3QKICAgIHRoYXQgcHJvdmlkZXMgb3V0cHV0IGZyb20gdGhlIGNoaWxkIHByb2Nlc3MuICBPdGhlcndpc2UsIGl0IGlzCiAgICBOb25lLgoKc3RkZXJyCiAgICBJZiB0aGUgc3RkZXJyIGFyZ3VtZW50IGlzIFBJUEUsIHRoaXMgYXR0cmlidXRlIGlzIGZpbGUgb2JqZWN0IHRoYXQKICAgIHByb3ZpZGVzIGVycm9yIG91dHB1dCBmcm9tIHRoZSBjaGlsZCBwcm9jZXNzLiAgT3RoZXJ3aXNlLCBpdCBpcwogICAgTm9uZS4KCnBpZAogICAgVGhlIHByb2Nlc3MgSUQgb2YgdGhlIGNoaWxkIHByb2Nlc3MuCgpyZXR1cm5jb2RlCiAgICBUaGUgY2hpbGQgcmV0dXJuIGNvZGUuICBBIE5vbmUgdmFsdWUgaW5kaWNhdGVzIHRoYXQgdGhlIHByb2Nlc3MKICAgIGhhc24ndCB0ZXJtaW5hdGVkIHlldC4gIEEgbmVnYXRpdmUgdmFsdWUgLU4gaW5kaWNhdGVzIHRoYXQgdGhlCiAgICBjaGlsZCB3YXMgdGVybWluYXRlZCBieSBzaWduYWwgTiAoVU5JWCBvbmx5KS4KCgpSZXBsYWNpbmcgb2xkZXIgZnVuY3Rpb25zIHdpdGggdGhlIHN1YnByb2Nlc3MgbW9kdWxlCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KSW4gdGhpcyBzZWN0aW9uLCAiYSA9PT4gYiIgbWVhbnMgdGhhdCBiIGNhbiBiZSB1c2VkIGFzIGEgcmVwbGFjZW1lbnQKZm9yIGEuCgpOb3RlOiBBbGwgZnVuY3Rpb25zIGluIHRoaXMgc2VjdGlvbiBmYWlsIChtb3JlIG9yIGxlc3MpIHNpbGVudGx5IGlmCnRoZSBleGVjdXRlZCBwcm9ncmFtIGNhbm5vdCBiZSBmb3VuZDsgdGhpcyBtb2R1bGUgcmFpc2VzIGFuIE9TRXJyb3IKZXhjZXB0aW9uLgoKSW4gdGhlIGZvbGxvd2luZyBleGFtcGxlcywgd2UgYXNzdW1lIHRoYXQgdGhlIHN1YnByb2Nlc3MgbW9kdWxlIGlzCmltcG9ydGVkIHdpdGggImZyb20gc3VicHJvY2VzcyBpbXBvcnQgKiIuCgoKUmVwbGFjaW5nIC9iaW4vc2ggc2hlbGwgYmFja3F1b3RlCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpvdXRwdXQ9YG15Y21kIG15YXJnYAo9PT4Kb3V0cHV0ID0gUG9wZW4oWyJteWNtZCIsICJteWFyZyJdLCBzdGRvdXQ9UElQRSkuY29tbXVuaWNhdGUoKVswXQoKClJlcGxhY2luZyBzaGVsbCBwaXBlIGxpbmUKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpvdXRwdXQ9YGRtZXNnIHwgZ3JlcCBoZGFgCj09PgpwMSA9IFBvcGVuKFsiZG1lc2ciXSwgc3Rkb3V0PVBJUEUpCnAyID0gUG9wZW4oWyJncmVwIiwgImhkYSJdLCBzdGRpbj1wMS5zdGRvdXQsIHN0ZG91dD1QSVBFKQpvdXRwdXQgPSBwMi5jb21tdW5pY2F0ZSgpWzBdCgoKUmVwbGFjaW5nIG9zLnN5c3RlbSgpCi0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdHMgPSBvcy5zeXN0ZW0oIm15Y21kIiArICIgbXlhcmciKQo9PT4KcCA9IFBvcGVuKCJteWNtZCIgKyAiIG15YXJnIiwgc2hlbGw9VHJ1ZSkKcGlkLCBzdHMgPSBvcy53YWl0cGlkKHAucGlkLCAwKQoKTm90ZToKCiogQ2FsbGluZyB0aGUgcHJvZ3JhbSB0aHJvdWdoIHRoZSBzaGVsbCBpcyB1c3VhbGx5IG5vdCByZXF1aXJlZC4KCiogSXQncyBlYXNpZXIgdG8gbG9vayBhdCB0aGUgcmV0dXJuY29kZSBhdHRyaWJ1dGUgdGhhbiB0aGUKICBleGl0c3RhdHVzLgoKQSBtb3JlIHJlYWwtd29ybGQgZXhhbXBsZSB3b3VsZCBsb29rIGxpa2UgdGhpczoKCnRyeToKICAgIHJldGNvZGUgPSBjYWxsKCJteWNtZCIgKyAiIG15YXJnIiwgc2hlbGw9VHJ1ZSkKICAgIGlmIHJldGNvZGUgPCAwOgogICAgICAgIHByaW50ID4+c3lzLnN0ZGVyciwgIkNoaWxkIHdhcyB0ZXJtaW5hdGVkIGJ5IHNpZ25hbCIsIC1yZXRjb2RlCiAgICBlbHNlOgogICAgICAgIHByaW50ID4+c3lzLnN0ZGVyciwgIkNoaWxkIHJldHVybmVkIiwgcmV0Y29kZQpleGNlcHQgT1NFcnJvciwgZToKICAgIHByaW50ID4+c3lzLnN0ZGVyciwgIkV4ZWN1dGlvbiBmYWlsZWQ6IiwgZQoKClJlcGxhY2luZyBvcy5zcGF3bioKLS0tLS0tLS0tLS0tLS0tLS0tLQpQX05PV0FJVCBleGFtcGxlOgoKcGlkID0gb3Muc3Bhd25scChvcy5QX05PV0FJVCwgIi9iaW4vbXljbWQiLCAibXljbWQiLCAibXlhcmciKQo9PT4KcGlkID0gUG9wZW4oWyIvYmluL215Y21kIiwgIm15YXJnIl0pLnBpZAoKClBfV0FJVCBleGFtcGxlOgoKcmV0Y29kZSA9IG9zLnNwYXdubHAob3MuUF9XQUlULCAiL2Jpbi9teWNtZCIsICJteWNtZCIsICJteWFyZyIpCj09PgpyZXRjb2RlID0gY2FsbChbIi9iaW4vbXljbWQiLCAibXlhcmciXSkKCgpWZWN0b3IgZXhhbXBsZToKCm9zLnNwYXdudnAob3MuUF9OT1dBSVQsIHBhdGgsIGFyZ3MpCj09PgpQb3BlbihbcGF0aF0gKyBhcmdzWzE6XSkKCgpFbnZpcm9ubWVudCBleGFtcGxlOgoKb3Muc3Bhd25scGUob3MuUF9OT1dBSVQsICIvYmluL215Y21kIiwgIm15Y21kIiwgIm15YXJnIiwgZW52KQo9PT4KUG9wZW4oWyIvYmluL215Y21kIiwgIm15YXJnIl0sIGVudj17IlBBVEgiOiAiL3Vzci9iaW4ifSkKCgpSZXBsYWNpbmcgb3MucG9wZW4qCi0tLS0tLS0tLS0tLS0tLS0tLS0KcGlwZSA9IG9zLnBvcGVuKCJjbWQiLCBtb2RlPSdyJywgYnVmc2l6ZSkKPT0+CnBpcGUgPSBQb3BlbigiY21kIiwgc2hlbGw9VHJ1ZSwgYnVmc2l6ZT1idWZzaXplLCBzdGRvdXQ9UElQRSkuc3Rkb3V0CgpwaXBlID0gb3MucG9wZW4oImNtZCIsIG1vZGU9J3cnLCBidWZzaXplKQo9PT4KcGlwZSA9IFBvcGVuKCJjbWQiLCBzaGVsbD1UcnVlLCBidWZzaXplPWJ1ZnNpemUsIHN0ZGluPVBJUEUpLnN0ZGluCgoKKGNoaWxkX3N0ZGluLCBjaGlsZF9zdGRvdXQpID0gb3MucG9wZW4yKCJjbWQiLCBtb2RlLCBidWZzaXplKQo9PT4KcCA9IFBvcGVuKCJjbWQiLCBzaGVsbD1UcnVlLCBidWZzaXplPWJ1ZnNpemUsCiAgICAgICAgICBzdGRpbj1QSVBFLCBzdGRvdXQ9UElQRSwgY2xvc2VfZmRzPVRydWUpCihjaGlsZF9zdGRpbiwgY2hpbGRfc3Rkb3V0KSA9IChwLnN0ZGluLCBwLnN0ZG91dCkKCgooY2hpbGRfc3RkaW4sCiBjaGlsZF9zdGRvdXQsCiBjaGlsZF9zdGRlcnIpID0gb3MucG9wZW4zKCJjbWQiLCBtb2RlLCBidWZzaXplKQo9PT4KcCA9IFBvcGVuKCJjbWQiLCBzaGVsbD1UcnVlLCBidWZzaXplPWJ1ZnNpemUsCiAgICAgICAgICBzdGRpbj1QSVBFLCBzdGRvdXQ9UElQRSwgc3RkZXJyPVBJUEUsIGNsb3NlX2Zkcz1UcnVlKQooY2hpbGRfc3RkaW4sCiBjaGlsZF9zdGRvdXQsCiBjaGlsZF9zdGRlcnIpID0gKHAuc3RkaW4sIHAuc3Rkb3V0LCBwLnN0ZGVycikKCgooY2hpbGRfc3RkaW4sIGNoaWxkX3N0ZG91dF9hbmRfc3RkZXJyKSA9IG9zLnBvcGVuNCgiY21kIiwgbW9kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVmc2l6ZSkKPT0+CnAgPSBQb3BlbigiY21kIiwgc2hlbGw9VHJ1ZSwgYnVmc2l6ZT1idWZzaXplLAogICAgICAgICAgc3RkaW49UElQRSwgc3Rkb3V0PVBJUEUsIHN0ZGVycj1TVERPVVQsIGNsb3NlX2Zkcz1UcnVlKQooY2hpbGRfc3RkaW4sIGNoaWxkX3N0ZG91dF9hbmRfc3RkZXJyKSA9IChwLnN0ZGluLCBwLnN0ZG91dCkKCk9uIFVuaXgsIG9zLnBvcGVuMiwgb3MucG9wZW4zIGFuZCBvcy5wb3BlbjQgYWxzbyBhY2NlcHQgYSBzZXF1ZW5jZSBhcwp0aGUgY29tbWFuZCB0byBleGVjdXRlLCBpbiB3aGljaCBjYXNlIGFyZ3VtZW50cyB3aWxsIGJlIHBhc3NlZApkaXJlY3RseSB0byB0aGUgcHJvZ3JhbSB3aXRob3V0IHNoZWxsIGludGVydmVudGlvbi4gIFRoaXMgdXNhZ2UgY2FuIGJlCnJlcGxhY2VkIGFzIGZvbGxvd3M6CgooY2hpbGRfc3RkaW4sIGNoaWxkX3N0ZG91dCkgPSBvcy5wb3BlbjIoWyIvYmluL2xzIiwgIi1sIl0sIG1vZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWZzaXplKQo9PT4KcCA9IFBvcGVuKFsiL2Jpbi9scyIsICItbCJdLCBidWZzaXplPWJ1ZnNpemUsIHN0ZGluPVBJUEUsIHN0ZG91dD1QSVBFKQooY2hpbGRfc3RkaW4sIGNoaWxkX3N0ZG91dCkgPSAocC5zdGRpbiwgcC5zdGRvdXQpCgpSZXR1cm4gY29kZSBoYW5kbGluZyB0cmFuc2xhdGVzIGFzIGZvbGxvd3M6CgpwaXBlID0gb3MucG9wZW4oImNtZCIsICd3JykKLi4uCnJjID0gcGlwZS5jbG9zZSgpCmlmIHJjIGlzIG5vdCBOb25lIGFuZCByYyAlIDI1NjoKICAgIHByaW50ICJUaGVyZSB3ZXJlIHNvbWUgZXJyb3JzIgo9PT4KcHJvY2VzcyA9IFBvcGVuKCJjbWQiLCAndycsIHNoZWxsPVRydWUsIHN0ZGluPVBJUEUpCi4uLgpwcm9jZXNzLnN0ZGluLmNsb3NlKCkKaWYgcHJvY2Vzcy53YWl0KCkgIT0gMDoKICAgIHByaW50ICJUaGVyZSB3ZXJlIHNvbWUgZXJyb3JzIgoKClJlcGxhY2luZyBwb3BlbjIuKgotLS0tLS0tLS0tLS0tLS0tLS0KKGNoaWxkX3N0ZG91dCwgY2hpbGRfc3RkaW4pID0gcG9wZW4yLnBvcGVuMigic29tZXN0cmluZyIsIGJ1ZnNpemUsIG1vZGUpCj09PgpwID0gUG9wZW4oWyJzb21lc3RyaW5nIl0sIHNoZWxsPVRydWUsIGJ1ZnNpemU9YnVmc2l6ZQogICAgICAgICAgc3RkaW49UElQRSwgc3Rkb3V0PVBJUEUsIGNsb3NlX2Zkcz1UcnVlKQooY2hpbGRfc3Rkb3V0LCBjaGlsZF9zdGRpbikgPSAocC5zdGRvdXQsIHAuc3RkaW4pCgpPbiBVbml4LCBwb3BlbjIgYWxzbyBhY2NlcHRzIGEgc2VxdWVuY2UgYXMgdGhlIGNvbW1hbmQgdG8gZXhlY3V0ZSwgaW4Kd2hpY2ggY2FzZSBhcmd1bWVudHMgd2lsbCBiZSBwYXNzZWQgZGlyZWN0bHkgdG8gdGhlIHByb2dyYW0gd2l0aG91dApzaGVsbCBpbnRlcnZlbnRpb24uICBUaGlzIHVzYWdlIGNhbiBiZSByZXBsYWNlZCBhcyBmb2xsb3dzOgoKKGNoaWxkX3N0ZG91dCwgY2hpbGRfc3RkaW4pID0gcG9wZW4yLnBvcGVuMihbIm15Y21kIiwgIm15YXJnIl0sIGJ1ZnNpemUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZSkKPT0+CnAgPSBQb3BlbihbIm15Y21kIiwgIm15YXJnIl0sIGJ1ZnNpemU9YnVmc2l6ZSwKICAgICAgICAgIHN0ZGluPVBJUEUsIHN0ZG91dD1QSVBFLCBjbG9zZV9mZHM9VHJ1ZSkKKGNoaWxkX3N0ZG91dCwgY2hpbGRfc3RkaW4pID0gKHAuc3Rkb3V0LCBwLnN0ZGluKQoKVGhlIHBvcGVuMi5Qb3BlbjMgYW5kIHBvcGVuMi5Qb3BlbjQgYmFzaWNhbGx5IHdvcmtzIGFzIHN1YnByb2Nlc3MuUG9wZW4sCmV4Y2VwdCB0aGF0OgoKKiBzdWJwcm9jZXNzLlBvcGVuIHJhaXNlcyBhbiBleGNlcHRpb24gaWYgdGhlIGV4ZWN1dGlvbiBmYWlscwoqIHRoZSBjYXB0dXJlc3RkZXJyIGFyZ3VtZW50IGlzIHJlcGxhY2VkIHdpdGggdGhlIHN0ZGVyciBhcmd1bWVudC4KKiBzdGRpbj1QSVBFIGFuZCBzdGRvdXQ9UElQRSBtdXN0IGJlIHNwZWNpZmllZC4KKiBwb3BlbjIgY2xvc2VzIGFsbCBmaWxlZGVzY3JpcHRvcnMgYnkgZGVmYXVsdCwgYnV0IHlvdSBoYXZlIHRvIHNwZWNpZnkKICBjbG9zZV9mZHM9VHJ1ZSB3aXRoIHN1YnByb2Nlc3MuUG9wZW4uCiIiIgoKCkNSRUFURV9ORVdfQ09OU09MRSA9IDE2CgpDUkVBVEVfTkVXX1BST0NFU1NfR1JPVVAgPSA1MTIKCmNsYXNzIENhbGxlZFByb2Nlc3NFcnJvcihFeGNlcHRpb24pOgogICAgcGFzcwoKTUFYRkQgPSAyNTYKClBJUEUgPSAtMQoKY2xhc3MgUG9wZW4ob2JqZWN0KToKICAgIHBhc3MKClNUQVJURl9VU0VTSE9XV0lORE9XID0gMQoKU1RBUlRGX1VTRVNUREhBTkRMRVMgPSAyNTYKCmNsYXNzIFNUQVJUVVBJTkZPOgogICAgcGFzcwoKU1RET1VUID0gLTIKClNURF9FUlJPUl9IQU5ETEUgPSAtMTIKClNURF9JTlBVVF9IQU5ETEUgPSAtMTAKClNURF9PVVRQVVRfSEFORExFID0gLTExCgpTV19ISURFID0gMAoKX19hbGxfXyA9ICJbJ1BvcGVuJywgJ1BJUEUnLCAnU1RET1VUJywgJ2NhbGwnLCAnY2hlY2tfY2FsbCcsICdjaGVja19vdXRwdXQnLCAnQ2FsbGVkUHJvY2Vzc0Vycm9yJywgCiAgICAnQ1JFQVRFX05FV19DT05TT0xFJywgJ0NSRUFURV9ORVdfUFJPQ0VTU19HUk9VUCcsICdTVERfSU5QVVRfSEFORExFJywgJ1NURF9PVVRQVVRfSEFORExFJywgCiAgICAnU1REX0VSUk9SX0hBTkRMRScsICdTV19ISURFJywgJ1NUQVJURl9VU0VTVERIQU5ETEVTJywgJ1NUQVJURl9VU0VTSE9XV0lORE9XJ10iCgpfYWN0aXZlID0gIltdIgoKZGVmIF9jbGVhbnVwKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIF9kZW1vX3Bvc2l4KCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIF9kZW1vX3dpbmRvd3MoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgX2VpbnRyX3JldHJ5X2NhbGwoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpfc3VicHJvY2VzcyA9ICI8bW9kdWxlICdfc3VicHJvY2VzcycgKGJ1aWx0LWluKT4iCgpkZWYgY2FsbCgqYXJncywqKmt3KToKICAgICIiIlJ1biBjb21tYW5kIHdpdGggYXJndW1lbnRzLiAgV2FpdCBmb3IgY29tbWFuZCB0byBjb21wbGV0ZSwgdGhlbiAgICAgICAgcmV0dXJuIHRoZSByZXR1cm5jb2RlIGF0dHJpYnV0ZS4KICAgIAogICAgICAgIFRoZSBhcmd1bWVudHMgYXJlIHRoZSBzYW1lIGFzIGZvciB0aGUgUG9wZW4gY29uc3RydWN0b3IuICBFeGFtcGxlOgogICAgCiAgICAgICAgcmV0Y29kZSA9IGNhbGwoWyJscyIsICItbCJdKQogICAgICAgICIiIgogICAgcGFzcwoKZGVmIGNoZWNrX2NhbGwoKmFyZ3MsKiprdyk6CiAgICAiIiJSdW4gY29tbWFuZCB3aXRoIGFyZ3VtZW50cy4gIFdhaXQgZm9yIGNvbW1hbmQgdG8gY29tcGxldGUuICBJZiAgICAgICAgdGhlIGV4aXQgY29kZSB3YXMgemVybyB0aGVuIHJldHVybiwgb3RoZXJ3aXNlIHJhaXNlCiAgICAgICAgQ2FsbGVkUHJvY2Vzc0Vycm9yLiAgVGhlIENhbGxlZFByb2Nlc3NFcnJvciBvYmplY3Qgd2lsbCBoYXZlIHRoZQogICAgICAgIHJldHVybiBjb2RlIGluIHRoZSByZXR1cm5jb2RlIGF0dHJpYnV0ZS4KICAgIAogICAgICAgIFRoZSBhcmd1bWVudHMgYXJlIHRoZSBzYW1lIGFzIGZvciB0aGUgUG9wZW4gY29uc3RydWN0b3IuICBFeGFtcGxlOgogICAgCiAgICAgICAgY2hlY2tfY2FsbChbImxzIiwgIi1sIl0pCiAgICAgICAgIiIiCiAgICBwYXNzCgpkZWYgY2hlY2tfb3V0cHV0KCphcmdzLCoqa3cpOgogICAgIiIiUnVuIGNvbW1hbmQgd2l0aCBhcmd1bWVudHMgYW5kIHJldHVybiBpdHMgb3V0cHV0IGFzIGEgYnl0ZSBzdHJpbmcuICAgIAogICAgICAgIElmIHRoZSBleGl0IGNvZGUgd2FzIG5vbi16ZXJvIGl0IHJhaXNlcyBhIENhbGxlZFByb2Nlc3NFcnJvci4gIFRoZQogICAgICAgIENhbGxlZFByb2Nlc3NFcnJvciBvYmplY3Qgd2lsbCBoYXZlIHRoZSByZXR1cm4gY29kZSBpbiB0aGUgcmV0dXJuY29kZQogICAgICAgIGF0dHJpYnV0ZSBhbmQgb3V0cHV0IGluIHRoZSBvdXRwdXQgYXR0cmlidXRlLgogICAgCiAgICAgICAgVGhlIGFyZ3VtZW50cyBhcmUgdGhlIHNhbWUgYXMgZm9yIHRoZSBQb3BlbiBjb25zdHJ1Y3Rvci4gIEV4YW1wbGU6CiAgICAKICAgICAgICA+Pj4gY2hlY2tfb3V0cHV0KFsibHMiLCAiLWwiLCAiL2Rldi9udWxsIl0pCiAgICAgICAgJ2Nydy1ydy1ydy0gMSByb290IHJvb3QgMSwgMyBPY3QgMTggIDIwMDcgL2Rldi9udWxsXG4nCiAgICAKICAgICAgICBUaGUgc3Rkb3V0IGFyZ3VtZW50IGlzIG5vdCBhbGxvd2VkIGFzIGl0IGlzIHVzZWQgaW50ZXJuYWxseS4KICAgICAgICBUbyBjYXB0dXJlIHN0YW5kYXJkIGVycm9yIGluIHRoZSByZXN1bHQsIHVzZSBzdGRlcnI9U1RET1VULgogICAgCiAgICAgICAgPj4+IGNoZWNrX291dHB1dChbIi9iaW4vc2giLCAiLWMiLAogICAgICAgIC4uLiAgICAgICAgICAgICAgICJscyAtbCBub25fZXhpc3RlbnRfZmlsZSA7IGV4aXQgMCJdLAogICAgICAgIC4uLiAgICAgICAgICAgICAgc3RkZXJyPVNURE9VVCkKICAgICAgICAnbHM6IG5vbl9leGlzdGVudF9maWxlOiBObyBzdWNoIGZpbGUgb3IgZGlyZWN0b3J5XG4nCiAgICAgICAgIiIiCiAgICBwYXNzCgplcnJubyA9ICI8bW9kdWxlICdlcnJubycgKGJ1aWx0LWluKT4iCgpnYyA9ICI8bW9kdWxlICdnYycgKGJ1aWx0LWluKT4iCgpkZWYgbGlzdDJjbWRsaW5lKCphcmdzLCoqa3cpOgogICAgIiIiICAgICAgICBUcmFuc2xhdGUgYSBzZXF1ZW5jZSBvZiBhcmd1bWVudHMgaW50byBhIGNvbW1hbmQgbGluZQogICAgICAgIHN0cmluZywgdXNpbmcgdGhlIHNhbWUgcnVsZXMgYXMgdGhlIE1TIEMgcnVudGltZToKICAgIAogICAgICAgIDEpIEFyZ3VtZW50cyBhcmUgZGVsaW1pdGVkIGJ5IHdoaXRlIHNwYWNlLCB3aGljaCBpcyBlaXRoZXIgYQogICAgICAgICAgIHNwYWNlIG9yIGEgdGFiLgogICAgCiAgICAgICAgMikgQSBzdHJpbmcgc3Vycm91bmRlZCBieSBkb3VibGUgcXVvdGF0aW9uIG1hcmtzIGlzCiAgICAgICAgICAgaW50ZXJwcmV0ZWQgYXMgYSBzaW5nbGUgYXJndW1lbnQsIHJlZ2FyZGxlc3Mgb2Ygd2hpdGUgc3BhY2UKICAgICAgICAgICBjb250YWluZWQgd2l0aGluLiAgQSBxdW90ZWQgc3RyaW5nIGNhbiBiZSBlbWJlZGRlZCBpbiBhbgogICAgICAgICAgIGFyZ3VtZW50LgogICAgCiAgICAgICAgMykgQSBkb3VibGUgcXVvdGF0aW9uIG1hcmsgcHJlY2VkZWQgYnkgYSBiYWNrc2xhc2ggaXMKICAgICAgICAgICBpbnRlcnByZXRlZCBhcyBhIGxpdGVyYWwgZG91YmxlIHF1b3RhdGlvbiBtYXJrLgogICAgCiAgICAgICAgNCkgQmFja3NsYXNoZXMgYXJlIGludGVycHJldGVkIGxpdGVyYWxseSwgdW5sZXNzIHRoZXkKICAgICAgICAgICBpbW1lZGlhdGVseSBwcmVjZWRlIGEgZG91YmxlIHF1b3RhdGlvbiBtYXJrLgogICAgCiAgICAgICAgNSkgSWYgYmFja3NsYXNoZXMgaW1tZWRpYXRlbHkgcHJlY2VkZSBhIGRvdWJsZSBxdW90YXRpb24gbWFyaywKICAgICAgICAgICBldmVyeSBwYWlyIG9mIGJhY2tzbGFzaGVzIGlzIGludGVycHJldGVkIGFzIGEgbGl0ZXJhbAogICAgICAgICAgIGJhY2tzbGFzaC4gIElmIHRoZSBudW1iZXIgb2YgYmFja3NsYXNoZXMgaXMgb2RkLCB0aGUgbGFzdAogICAgICAgICAgIGJhY2tzbGFzaCBlc2NhcGVzIHRoZSBuZXh0IGRvdWJsZSBxdW90YXRpb24gbWFyayBhcwogICAgICAgICAgIGRlc2NyaWJlZCBpbiBydWxlIDMuCiAgICAgICAgIiIiCiAgICBwYXNzCgptc3ZjcnQgPSAiPG1vZHVsZSAnbXN2Y3J0JyAoYnVpbHQtaW4pPiIKCm1zd2luZG93cyA9IFRydWUKCm9zID0gIjxtb2R1bGUgJ29zJyBmcm9tICdjOlxweXRob24yN1xsaWJcb3MucHljJz4iCgpjbGFzcyBweXdpbnR5cGVzOgogICAgcGFzcwoKc2lnbmFsID0gIjxtb2R1bGUgJ3NpZ25hbCcgKGJ1aWx0LWluKT4iCgpzeXMgPSAiPG1vZHVsZSAnc3lzJyAoYnVpbHQtaW4pPiIKCnRocmVhZGluZyA9ICI8bW9kdWxlICd0aHJlYWRpbmcnIGZyb20gJ2M6XHB5dGhvbjI3XGxpYlx0aHJlYWRpbmcucHljJz4iCgp0cmFjZWJhY2sgPSAiPG1vZHVsZSAndHJhY2ViYWNrJyBmcm9tICdjOlxweXRob24yN1xsaWJcdHJhY2ViYWNrLnB5Yyc+IgoKdHlwZXMgPSAiPG1vZHVsZSAndHlwZXMnIGZyb20gJ2M6XHB5dGhvbjI3XGxpYlx0eXBlcy5weWMnPiIK',
'/Lib/sys.py':'IyBoYWNrIHRvIHJldHVybiBzcGVjaWFsIGF0dHJpYnV0ZXMKZnJvbSBfc3lzIGltcG9ydCAqCgpmcm9tIGJyb3dzZXIgaW1wb3J0IGRvYwpfX3N0ZG91dF9fPWdldGF0dHIoZG9jLCIkc3Rkb3V0IikKX19zdGRlcnJfXz1nZXRhdHRyKGRvYywiJHN0ZGVyciIpCgpzdGRvdXQgPSBnZXRhdHRyKGRvYywiJHN0ZG91dCIpCnN0ZGVyciA9IGdldGF0dHIoZG9jLCIkc3RkZXJyIikKCgpoYXNfbG9jYWxfc3RvcmFnZT1fX0JSWVRIT05fXy5oYXNfbG9jYWxfc3RvcmFnZQpoYXNfanNvbj1fX0JSWVRIT05fXy5oYXNfanNvbgoKYXJndiA9IFsnX19tYWluX18nXQoKYmFzZV9leGVjX3ByZWZpeCA9IF9fQlJZVEhPTl9fLmJyeXRob25fcGF0aAoKYmFzZV9wcmVmaXggPSBfX0JSWVRIT05fXy5icnl0aG9uX3BhdGgKCmJ1aWx0aW5fbW9kdWxlX25hbWVzPV9fQlJZVEhPTl9fLmJ1aWx0aW5fbW9kdWxlX25hbWVzCgpieXRlb3JkZXI9J2xpdHRsZScKCmV4ZWNfcHJlZml4ID0gX19CUllUSE9OX18uYnJ5dGhvbl9wYXRoCgpleGVjdXRhYmxlID0gX19CUllUSE9OX18uYnJ5dGhvbl9wYXRoKycvYnJ5dGhvbi5qcycKCmRlZiBleGl0KGk9Tm9uZSk6CiAgICByYWlzZSBTeXN0ZW1FeGl0KCcnKQoKY2xhc3MgZmxhZ19jbGFzczoKICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgIHNlbGYuZGVidWc9MAogICAgICBzZWxmLmluc3BlY3Q9MAogICAgICBzZWxmLmludGVyYWN0aXZlPTAKICAgICAgc2VsZi5vcHRpbWl6ZT0wCiAgICAgIHNlbGYuZG9udF93cml0ZV9ieXRlY29kZT0wCiAgICAgIHNlbGYubm9fdXNlcl9zaXRlPTAKICAgICAgc2VsZi5ub19zaXRlPTAKICAgICAgc2VsZi5pZ25vcmVfZW52aXJvbm1lbnQ9MAogICAgICBzZWxmLnZlcmJvc2U9MAogICAgICBzZWxmLmJ5dGVzX3dhcm5pbmc9MAogICAgICBzZWxmLnF1aWV0PTAKICAgICAgc2VsZi5oYXNoX3JhbmRvbWl6YXRpb249MQoKZmxhZ3M9ZmxhZ19jbGFzcygpCgpkZWYgZ2V0ZmlsZXN5c3RlbWVuY29kaW5nKCphcmdzLCoqa3cpOgogICAgIiIiZ2V0ZmlsZXN5c3RlbWVuY29kaW5nKCkgLT4gc3RyaW5nICAgIAogICAgUmV0dXJuIHRoZSBlbmNvZGluZyB1c2VkIHRvIGNvbnZlcnQgVW5pY29kZSBmaWxlbmFtZXMgaW4KICAgIG9wZXJhdGluZyBzeXN0ZW0gZmlsZW5hbWVzLiIiIgogICAgcmV0dXJuICd1dGYtOCcKICAgIAptYXhzaXplPTkwMDcxOTkyNTQ3NDA5OTIgICAjbGFyZ2VzdCBpbnRlZ2VyLi4KCm1heGludD05MDA3MTk5MjU0NzQwOTkyICAgI2xhcmdlc3QgaW50ZWdlci4uCgptYXh1bmljb2RlPTExMTQxMTEKCnBhdGggPSBfX0JSWVRIT05fXy5wYXRoCgpwYXRoX2hvb2tzID0gbGlzdChKU09iamVjdChfX0JSWVRIT05fXy5wYXRoX2hvb2tzKSkKCnBsYXRmb3JtPSJicnl0aG9uIgoKcHJlZml4ID0gX19CUllUSE9OX18uYnJ5dGhvbl9wYXRoCgp2ZXJzaW9uID0gJy4nLmpvaW4oc3RyKHgpIGZvciB4IGluIF9fQlJZVEhPTl9fLnZlcnNpb25faW5mbykKCgpjbGFzcyBfX3ZlcnNpb25faW5mbyhvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHZlcnNpb25faW5mbyk6CiAgICAgICAgc2VsZi52ZXJzaW9uX2luZm8gPSB2ZXJzaW9uX2luZm8KICAgICAgICBzZWxmLm1ham9yID0gdmVyc2lvbl9pbmZvWzBdCiAgICAgICAgc2VsZi5taW5vciA9IHZlcnNpb25faW5mb1sxXQogICAgICAgIHNlbGYubWljcm8gPSB2ZXJzaW9uX2luZm9bMl0KICAgICAgICBzZWxmLnJlbGVhc2VsZXZlbCA9IHZlcnNpb25faW5mb1szXQogICAgICAgIHNlbGYuc2VyaWFsID0gdmVyc2lvbl9pbmZvWzRdCgogICAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGluZGV4KToKICAgICAgICByZXR1cm4gc2VsZi52ZXJzaW9uX2luZm9baW5kZXhdCgogICAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHN0cihzZWxmLnZlcnNpb25faW5mbykKICAgICAKdmVyc2lvbl9pbmZvPV9fdmVyc2lvbl9pbmZvKF9fQlJZVEhPTl9fLnZlcnNpb25faW5mbykKCndhcm5vcHRpb25zPVtdCgo=',
'/Lib/sysconfig.py':'IiIiQWNjZXNzIHRvIFB5dGhvbidzIGNvbmZpZ3VyYXRpb24gaW5mb3JtYXRpb24uIiIiCgppbXBvcnQgb3MKaW1wb3J0IHJlCmltcG9ydCBzeXMKZnJvbSBvcy5wYXRoIGltcG9ydCBwYXJkaXIsIHJlYWxwYXRoCgpfX2FsbF9fID0gWwogICAgJ2dldF9jb25maWdfaF9maWxlbmFtZScsCiAgICAnZ2V0X2NvbmZpZ192YXInLAogICAgJ2dldF9jb25maWdfdmFycycsCiAgICAnZ2V0X21ha2VmaWxlX2ZpbGVuYW1lJywKICAgICdnZXRfcGF0aCcsCiAgICAnZ2V0X3BhdGhfbmFtZXMnLAogICAgJ2dldF9wYXRocycsCiAgICAnZ2V0X3BsYXRmb3JtJywKICAgICdnZXRfcHl0aG9uX3ZlcnNpb24nLAogICAgJ2dldF9zY2hlbWVfbmFtZXMnLAogICAgJ3BhcnNlX2NvbmZpZ19oJywKXQoKX0lOU1RBTExfU0NIRU1FUyA9IHsKICAgICdwb3NpeF9wcmVmaXgnOiB7CiAgICAgICAgJ3N0ZGxpYic6ICd7aW5zdGFsbGVkX2Jhc2V9L2xpYi9weXRob257cHlfdmVyc2lvbl9zaG9ydH0nLAogICAgICAgICdwbGF0c3RkbGliJzogJ3twbGF0YmFzZX0vbGliL3B5dGhvbntweV92ZXJzaW9uX3Nob3J0fScsCiAgICAgICAgJ3B1cmVsaWInOiAne2Jhc2V9L2xpYi9weXRob257cHlfdmVyc2lvbl9zaG9ydH0vc2l0ZS1wYWNrYWdlcycsCiAgICAgICAgJ3BsYXRsaWInOiAne3BsYXRiYXNlfS9saWIvcHl0aG9ue3B5X3ZlcnNpb25fc2hvcnR9L3NpdGUtcGFja2FnZXMnLAogICAgICAgICdpbmNsdWRlJzoKICAgICAgICAgICAgJ3tpbnN0YWxsZWRfYmFzZX0vaW5jbHVkZS9weXRob257cHlfdmVyc2lvbl9zaG9ydH17YWJpZmxhZ3N9JywKICAgICAgICAncGxhdGluY2x1ZGUnOgogICAgICAgICAgICAne2luc3RhbGxlZF9wbGF0YmFzZX0vaW5jbHVkZS9weXRob257cHlfdmVyc2lvbl9zaG9ydH17YWJpZmxhZ3N9JywKICAgICAgICAnc2NyaXB0cyc6ICd7YmFzZX0vYmluJywKICAgICAgICAnZGF0YSc6ICd7YmFzZX0nLAogICAgICAgIH0sCiAgICAncG9zaXhfaG9tZSc6IHsKICAgICAgICAnc3RkbGliJzogJ3tpbnN0YWxsZWRfYmFzZX0vbGliL3B5dGhvbicsCiAgICAgICAgJ3BsYXRzdGRsaWInOiAne2Jhc2V9L2xpYi9weXRob24nLAogICAgICAgICdwdXJlbGliJzogJ3tiYXNlfS9saWIvcHl0aG9uJywKICAgICAgICAncGxhdGxpYic6ICd7YmFzZX0vbGliL3B5dGhvbicsCiAgICAgICAgJ2luY2x1ZGUnOiAne2luc3RhbGxlZF9iYXNlfS9pbmNsdWRlL3B5dGhvbicsCiAgICAgICAgJ3BsYXRpbmNsdWRlJzogJ3tpbnN0YWxsZWRfYmFzZX0vaW5jbHVkZS9weXRob24nLAogICAgICAgICdzY3JpcHRzJzogJ3tiYXNlfS9iaW4nLAogICAgICAgICdkYXRhJzogJ3tiYXNlfScsCiAgICAgICAgfSwKICAgICdudCc6IHsKICAgICAgICAnc3RkbGliJzogJ3tpbnN0YWxsZWRfYmFzZX0vTGliJywKICAgICAgICAncGxhdHN0ZGxpYic6ICd7YmFzZX0vTGliJywKICAgICAgICAncHVyZWxpYic6ICd7YmFzZX0vTGliL3NpdGUtcGFja2FnZXMnLAogICAgICAgICdwbGF0bGliJzogJ3tiYXNlfS9MaWIvc2l0ZS1wYWNrYWdlcycsCiAgICAgICAgJ2luY2x1ZGUnOiAne2luc3RhbGxlZF9iYXNlfS9JbmNsdWRlJywKICAgICAgICAncGxhdGluY2x1ZGUnOiAne2luc3RhbGxlZF9iYXNlfS9JbmNsdWRlJywKICAgICAgICAnc2NyaXB0cyc6ICd7YmFzZX0vU2NyaXB0cycsCiAgICAgICAgJ2RhdGEnOiAne2Jhc2V9JywKICAgICAgICB9LAogICAgJ29zMic6IHsKICAgICAgICAnc3RkbGliJzogJ3tpbnN0YWxsZWRfYmFzZX0vTGliJywKICAgICAgICAncGxhdHN0ZGxpYic6ICd7YmFzZX0vTGliJywKICAgICAgICAncHVyZWxpYic6ICd7YmFzZX0vTGliL3NpdGUtcGFja2FnZXMnLAogICAgICAgICdwbGF0bGliJzogJ3tiYXNlfS9MaWIvc2l0ZS1wYWNrYWdlcycsCiAgICAgICAgJ2luY2x1ZGUnOiAne2luc3RhbGxlZF9iYXNlfS9JbmNsdWRlJywKICAgICAgICAncGxhdGluY2x1ZGUnOiAne2luc3RhbGxlZF9iYXNlfS9JbmNsdWRlJywKICAgICAgICAnc2NyaXB0cyc6ICd7YmFzZX0vU2NyaXB0cycsCiAgICAgICAgJ2RhdGEnOiAne2Jhc2V9JywKICAgICAgICB9LAogICAgJ29zMl9ob21lJzogewogICAgICAgICdzdGRsaWInOiAne3VzZXJiYXNlfS9saWIvcHl0aG9ue3B5X3ZlcnNpb25fc2hvcnR9JywKICAgICAgICAncGxhdHN0ZGxpYic6ICd7dXNlcmJhc2V9L2xpYi9weXRob257cHlfdmVyc2lvbl9zaG9ydH0nLAogICAgICAgICdwdXJlbGliJzogJ3t1c2VyYmFzZX0vbGliL3B5dGhvbntweV92ZXJzaW9uX3Nob3J0fS9zaXRlLXBhY2thZ2VzJywKICAgICAgICAncGxhdGxpYic6ICd7dXNlcmJhc2V9L2xpYi9weXRob257cHlfdmVyc2lvbl9zaG9ydH0vc2l0ZS1wYWNrYWdlcycsCiAgICAgICAgJ2luY2x1ZGUnOiAne3VzZXJiYXNlfS9pbmNsdWRlL3B5dGhvbntweV92ZXJzaW9uX3Nob3J0fScsCiAgICAgICAgJ3NjcmlwdHMnOiAne3VzZXJiYXNlfS9iaW4nLAogICAgICAgICdkYXRhJzogJ3t1c2VyYmFzZX0nLAogICAgICAgIH0sCiAgICAnbnRfdXNlcic6IHsKICAgICAgICAnc3RkbGliJzogJ3t1c2VyYmFzZX0vUHl0aG9ue3B5X3ZlcnNpb25fbm9kb3R9JywKICAgICAgICAncGxhdHN0ZGxpYic6ICd7dXNlcmJhc2V9L1B5dGhvbntweV92ZXJzaW9uX25vZG90fScsCiAgICAgICAgJ3B1cmVsaWInOiAne3VzZXJiYXNlfS9QeXRob257cHlfdmVyc2lvbl9ub2RvdH0vc2l0ZS1wYWNrYWdlcycsCiAgICAgICAgJ3BsYXRsaWInOiAne3VzZXJiYXNlfS9QeXRob257cHlfdmVyc2lvbl9ub2RvdH0vc2l0ZS1wYWNrYWdlcycsCiAgICAgICAgJ2luY2x1ZGUnOiAne3VzZXJiYXNlfS9QeXRob257cHlfdmVyc2lvbl9ub2RvdH0vSW5jbHVkZScsCiAgICAgICAgJ3NjcmlwdHMnOiAne3VzZXJiYXNlfS9TY3JpcHRzJywKICAgICAgICAnZGF0YSc6ICd7dXNlcmJhc2V9JywKICAgICAgICB9LAogICAgJ3Bvc2l4X3VzZXInOiB7CiAgICAgICAgJ3N0ZGxpYic6ICd7dXNlcmJhc2V9L2xpYi9weXRob257cHlfdmVyc2lvbl9zaG9ydH0nLAogICAgICAgICdwbGF0c3RkbGliJzogJ3t1c2VyYmFzZX0vbGliL3B5dGhvbntweV92ZXJzaW9uX3Nob3J0fScsCiAgICAgICAgJ3B1cmVsaWInOiAne3VzZXJiYXNlfS9saWIvcHl0aG9ue3B5X3ZlcnNpb25fc2hvcnR9L3NpdGUtcGFja2FnZXMnLAogICAgICAgICdwbGF0bGliJzogJ3t1c2VyYmFzZX0vbGliL3B5dGhvbntweV92ZXJzaW9uX3Nob3J0fS9zaXRlLXBhY2thZ2VzJywKICAgICAgICAnaW5jbHVkZSc6ICd7dXNlcmJhc2V9L2luY2x1ZGUvcHl0aG9ue3B5X3ZlcnNpb25fc2hvcnR9JywKICAgICAgICAnc2NyaXB0cyc6ICd7dXNlcmJhc2V9L2JpbicsCiAgICAgICAgJ2RhdGEnOiAne3VzZXJiYXNlfScsCiAgICAgICAgfSwKICAgICdvc3hfZnJhbWV3b3JrX3VzZXInOiB7CiAgICAgICAgJ3N0ZGxpYic6ICd7dXNlcmJhc2V9L2xpYi9weXRob24nLAogICAgICAgICdwbGF0c3RkbGliJzogJ3t1c2VyYmFzZX0vbGliL3B5dGhvbicsCiAgICAgICAgJ3B1cmVsaWInOiAne3VzZXJiYXNlfS9saWIvcHl0aG9uL3NpdGUtcGFja2FnZXMnLAogICAgICAgICdwbGF0bGliJzogJ3t1c2VyYmFzZX0vbGliL3B5dGhvbi9zaXRlLXBhY2thZ2VzJywKICAgICAgICAnaW5jbHVkZSc6ICd7dXNlcmJhc2V9L2luY2x1ZGUnLAogICAgICAgICdzY3JpcHRzJzogJ3t1c2VyYmFzZX0vYmluJywKICAgICAgICAnZGF0YSc6ICd7dXNlcmJhc2V9JywKICAgICAgICB9LAogICAgfQoKX1NDSEVNRV9LRVlTID0gKCdzdGRsaWInLCAncGxhdHN0ZGxpYicsICdwdXJlbGliJywgJ3BsYXRsaWInLCAnaW5jbHVkZScsCiAgICAgICAgICAgICAgICAnc2NyaXB0cycsICdkYXRhJykKCiAjIEZJWE1FIGRvbid0IHJlbHkgb24gc3lzLnZlcnNpb24gaGVyZSwgaXRzIGZvcm1hdCBpcyBhbiBpbXBsZW1lbnRhdGlvbiBkZXRhaWwKICMgb2YgQ1B5dGhvbiwgdXNlIHN5cy52ZXJzaW9uX2luZm8gb3Igc3lzLmhleHZlcnNpb24KX1BZX1ZFUlNJT04gPSBzeXMudmVyc2lvbi5zcGxpdCgpWzBdCl9QWV9WRVJTSU9OX1NIT1JUID0gc3lzLnZlcnNpb25bOjNdCl9QWV9WRVJTSU9OX1NIT1JUX05PX0RPVCA9IF9QWV9WRVJTSU9OWzBdICsgX1BZX1ZFUlNJT05bMl0KX1BSRUZJWCA9IG9zLnBhdGgubm9ybXBhdGgoc3lzLnByZWZpeCkKX0JBU0VfUFJFRklYID0gb3MucGF0aC5ub3JtcGF0aChzeXMuYmFzZV9wcmVmaXgpCl9FWEVDX1BSRUZJWCA9IG9zLnBhdGgubm9ybXBhdGgoc3lzLmV4ZWNfcHJlZml4KQpfQkFTRV9FWEVDX1BSRUZJWCA9IG9zLnBhdGgubm9ybXBhdGgoc3lzLmJhc2VfZXhlY19wcmVmaXgpCl9DT05GSUdfVkFSUyA9IE5vbmUKX1VTRVJfQkFTRSA9IE5vbmUKCgpkZWYgX3NhZmVfcmVhbHBhdGgocGF0aCk6CiAgICB0cnk6CiAgICAgICAgcmV0dXJuIHJlYWxwYXRoKHBhdGgpCiAgICBleGNlcHQgT1NFcnJvcjoKICAgICAgICByZXR1cm4gcGF0aAoKaWYgc3lzLmV4ZWN1dGFibGU6CiAgICBfUFJPSkVDVF9CQVNFID0gb3MucGF0aC5kaXJuYW1lKF9zYWZlX3JlYWxwYXRoKHN5cy5leGVjdXRhYmxlKSkKZWxzZToKICAgICMgc3lzLmV4ZWN1dGFibGUgY2FuIGJlIGVtcHR5IGlmIGFyZ3ZbMF0gaGFzIGJlZW4gY2hhbmdlZCBhbmQgUHl0aG9uIGlzCiAgICAjIHVuYWJsZSB0byByZXRyaWV2ZSB0aGUgcmVhbCBwcm9ncmFtIG5hbWUKICAgIF9QUk9KRUNUX0JBU0UgPSBfc2FmZV9yZWFscGF0aChvcy5nZXRjd2QoKSkKCmlmIG9zLm5hbWUgPT0gIm50IiBhbmQgInBjYnVpbGQiIGluIF9QUk9KRUNUX0JBU0VbLTg6XS5sb3dlcigpOgogICAgX1BST0pFQ1RfQkFTRSA9IF9zYWZlX3JlYWxwYXRoKG9zLnBhdGguam9pbihfUFJPSkVDVF9CQVNFLCBwYXJkaXIpKQojIFBDL1ZTNy4xCmlmIG9zLm5hbWUgPT0gIm50IiBhbmQgIlxccGNcXHYiIGluIF9QUk9KRUNUX0JBU0VbLTEwOl0ubG93ZXIoKToKICAgIF9QUk9KRUNUX0JBU0UgPSBfc2FmZV9yZWFscGF0aChvcy5wYXRoLmpvaW4oX1BST0pFQ1RfQkFTRSwgcGFyZGlyLCBwYXJkaXIpKQojIFBDL0FNRDY0CmlmIG9zLm5hbWUgPT0gIm50IiBhbmQgIlxccGNidWlsZFxcYW1kNjQiIGluIF9QUk9KRUNUX0JBU0VbLTE0Ol0ubG93ZXIoKToKICAgIF9QUk9KRUNUX0JBU0UgPSBfc2FmZV9yZWFscGF0aChvcy5wYXRoLmpvaW4oX1BST0pFQ1RfQkFTRSwgcGFyZGlyLCBwYXJkaXIpKQoKIyBzZXQgZm9yIGNyb3NzIGJ1aWxkcwppZiAiX1BZVEhPTl9QUk9KRUNUX0JBU0UiIGluIG9zLmVudmlyb246CiAgICBfUFJPSkVDVF9CQVNFID0gX3NhZmVfcmVhbHBhdGgob3MuZW52aXJvblsiX1BZVEhPTl9QUk9KRUNUX0JBU0UiXSkKCmRlZiBfaXNfcHl0aG9uX3NvdXJjZV9kaXIoZCk6CiAgICBmb3IgZm4gaW4gKCJTZXR1cC5kaXN0IiwgIlNldHVwLmxvY2FsIik6CiAgICAgICAgaWYgb3MucGF0aC5pc2ZpbGUob3MucGF0aC5qb2luKGQsICJNb2R1bGVzIiwgZm4pKToKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgIHJldHVybiBGYWxzZQoKX3N5c19ob21lID0gZ2V0YXR0cihzeXMsICdfaG9tZScsIE5vbmUpCmlmIF9zeXNfaG9tZSBhbmQgb3MubmFtZSA9PSAnbnQnIGFuZCBcCiAgICBfc3lzX2hvbWUubG93ZXIoKS5lbmRzd2l0aCgoJ3BjYnVpbGQnLCAncGNidWlsZFxcYW1kNjQnKSk6CiAgICBfc3lzX2hvbWUgPSBvcy5wYXRoLmRpcm5hbWUoX3N5c19ob21lKQogICAgaWYgX3N5c19ob21lLmVuZHN3aXRoKCdwY2J1aWxkJyk6ICAgIyBtdXN0IGJlIGFtZDY0CiAgICAgICAgX3N5c19ob21lID0gb3MucGF0aC5kaXJuYW1lKF9zeXNfaG9tZSkKZGVmIGlzX3B5dGhvbl9idWlsZChjaGVja19ob21lPUZhbHNlKToKICAgIGlmIGNoZWNrX2hvbWUgYW5kIF9zeXNfaG9tZToKICAgICAgICByZXR1cm4gX2lzX3B5dGhvbl9zb3VyY2VfZGlyKF9zeXNfaG9tZSkKICAgIHJldHVybiBfaXNfcHl0aG9uX3NvdXJjZV9kaXIoX1BST0pFQ1RfQkFTRSkKCl9QWVRIT05fQlVJTEQgPSBpc19weXRob25fYnVpbGQoVHJ1ZSkKCmlmIF9QWVRIT05fQlVJTEQ6CiAgICBmb3Igc2NoZW1lIGluICgncG9zaXhfcHJlZml4JywgJ3Bvc2l4X2hvbWUnKToKICAgICAgICBfSU5TVEFMTF9TQ0hFTUVTW3NjaGVtZV1bJ2luY2x1ZGUnXSA9ICd7c3JjZGlyfS9JbmNsdWRlJwogICAgICAgIF9JTlNUQUxMX1NDSEVNRVNbc2NoZW1lXVsncGxhdGluY2x1ZGUnXSA9ICd7cHJvamVjdGJhc2V9Ly4nCgoKZGVmIF9zdWJzdF92YXJzKHMsIGxvY2FsX3ZhcnMpOgogICAgdHJ5OgogICAgICAgIHJldHVybiBzLmZvcm1hdCgqKmxvY2FsX3ZhcnMpCiAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gcy5mb3JtYXQoKipvcy5lbnZpcm9uKQogICAgICAgIGV4Y2VwdCBLZXlFcnJvciBhcyB2YXI6CiAgICAgICAgICAgIHJhaXNlIEF0dHJpYnV0ZUVycm9yKCd7JXN9JyAlIHZhcikKCmRlZiBfZXh0ZW5kX2RpY3QodGFyZ2V0X2RpY3QsIG90aGVyX2RpY3QpOgogICAgdGFyZ2V0X2tleXMgPSB0YXJnZXRfZGljdC5rZXlzKCkKICAgIGZvciBrZXksIHZhbHVlIGluIG90aGVyX2RpY3QuaXRlbXMoKToKICAgICAgICBpZiBrZXkgaW4gdGFyZ2V0X2tleXM6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgdGFyZ2V0X2RpY3Rba2V5XSA9IHZhbHVlCgoKZGVmIF9leHBhbmRfdmFycyhzY2hlbWUsIHZhcnMpOgogICAgcmVzID0ge30KICAgIGlmIHZhcnMgaXMgTm9uZToKICAgICAgICB2YXJzID0ge30KICAgIF9leHRlbmRfZGljdCh2YXJzLCBnZXRfY29uZmlnX3ZhcnMoKSkKCiAgICBmb3Iga2V5LCB2YWx1ZSBpbiBfSU5TVEFMTF9TQ0hFTUVTW3NjaGVtZV0uaXRlbXMoKToKICAgICAgICBpZiBvcy5uYW1lIGluICgncG9zaXgnLCAnbnQnKToKICAgICAgICAgICAgdmFsdWUgPSBvcy5wYXRoLmV4cGFuZHVzZXIodmFsdWUpCiAgICAgICAgcmVzW2tleV0gPSBvcy5wYXRoLm5vcm1wYXRoKF9zdWJzdF92YXJzKHZhbHVlLCB2YXJzKSkKICAgIHJldHVybiByZXMKCgpkZWYgX2dldF9kZWZhdWx0X3NjaGVtZSgpOgogICAgaWYgb3MubmFtZSA9PSAncG9zaXgnOgogICAgICAgICMgdGhlIGRlZmF1bHQgc2NoZW1lIGZvciBwb3NpeCBpcyBwb3NpeF9wcmVmaXgKICAgICAgICByZXR1cm4gJ3Bvc2l4X3ByZWZpeCcKICAgIHJldHVybiBvcy5uYW1lCgoKZGVmIF9nZXR1c2VyYmFzZSgpOgogICAgZW52X2Jhc2UgPSBvcy5lbnZpcm9uLmdldCgiUFlUSE9OVVNFUkJBU0UiLCBOb25lKQoKICAgIGRlZiBqb2ludXNlcigqYXJncyk6CiAgICAgICAgcmV0dXJuIG9zLnBhdGguZXhwYW5kdXNlcihvcy5wYXRoLmpvaW4oKmFyZ3MpKQoKICAgICMgd2hhdCBhYm91dCAnb3MyZW14JywgJ3Jpc2NvcycgPwogICAgaWYgb3MubmFtZSA9PSAibnQiOgogICAgICAgIGJhc2UgPSBvcy5lbnZpcm9uLmdldCgiQVBQREFUQSIpIG9yICJ+IgogICAgICAgIGlmIGVudl9iYXNlOgogICAgICAgICAgICByZXR1cm4gZW52X2Jhc2UKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gam9pbnVzZXIoYmFzZSwgIlB5dGhvbiIpCgogICAgaWYgc3lzLnBsYXRmb3JtID09ICJkYXJ3aW4iOgogICAgICAgIGZyYW1ld29yayA9IGdldF9jb25maWdfdmFyKCJQWVRIT05GUkFNRVdPUksiKQogICAgICAgIGlmIGZyYW1ld29yazoKICAgICAgICAgICAgaWYgZW52X2Jhc2U6CiAgICAgICAgICAgICAgICByZXR1cm4gZW52X2Jhc2UKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJldHVybiBqb2ludXNlcigifiIsICJMaWJyYXJ5IiwgZnJhbWV3b3JrLCAiJWQuJWQiICUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeXMudmVyc2lvbl9pbmZvWzoyXSkKCiAgICBpZiBlbnZfYmFzZToKICAgICAgICByZXR1cm4gZW52X2Jhc2UKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIGpvaW51c2VyKCJ+IiwgIi5sb2NhbCIpCgoKZGVmIF9wYXJzZV9tYWtlZmlsZShmaWxlbmFtZSwgdmFycz1Ob25lKToKICAgICIiIlBhcnNlIGEgTWFrZWZpbGUtc3R5bGUgZmlsZS4KCiAgICBBIGRpY3Rpb25hcnkgY29udGFpbmluZyBuYW1lL3ZhbHVlIHBhaXJzIGlzIHJldHVybmVkLiAgSWYgYW4KICAgIG9wdGlvbmFsIGRpY3Rpb25hcnkgaXMgcGFzc2VkIGluIGFzIHRoZSBzZWNvbmQgYXJndW1lbnQsIGl0IGlzCiAgICB1c2VkIGluc3RlYWQgb2YgYSBuZXcgZGljdGlvbmFyeS4KICAgICIiIgogICAgIyBSZWdleGVzIG5lZWRlZCBmb3IgcGFyc2luZyBNYWtlZmlsZSAoYW5kIHNpbWlsYXIgc3ludGF4ZXMsCiAgICAjIGxpa2Ugb2xkLXN0eWxlIFNldHVwIGZpbGVzKS4KICAgIF92YXJpYWJsZV9yeCA9IHJlLmNvbXBpbGUoIihbYS16QS1aXVthLXpBLVowLTlfXSspXHMqPVxzKiguKikiKQogICAgX2ZpbmR2YXIxX3J4ID0gcmUuY29tcGlsZShyIlwkXCgoW0EtWmEtel1bQS1aYS16MC05X10qKVwpIikKICAgIF9maW5kdmFyMl9yeCA9IHJlLmNvbXBpbGUociJcJHsoW0EtWmEtel1bQS1aYS16MC05X10qKX0iKQoKICAgIGlmIHZhcnMgaXMgTm9uZToKICAgICAgICB2YXJzID0ge30KICAgIGRvbmUgPSB7fQogICAgbm90ZG9uZSA9IHt9CgogICAgd2l0aCBvcGVuKGZpbGVuYW1lLCBlcnJvcnM9InN1cnJvZ2F0ZWVzY2FwZSIpIGFzIGY6CiAgICAgICAgbGluZXMgPSBmLnJlYWRsaW5lcygpCgogICAgZm9yIGxpbmUgaW4gbGluZXM6CiAgICAgICAgaWYgbGluZS5zdGFydHN3aXRoKCcjJykgb3IgbGluZS5zdHJpcCgpID09ICcnOgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIG0gPSBfdmFyaWFibGVfcngubWF0Y2gobGluZSkKICAgICAgICBpZiBtOgogICAgICAgICAgICBuLCB2ID0gbS5ncm91cCgxLCAyKQogICAgICAgICAgICB2ID0gdi5zdHJpcCgpCiAgICAgICAgICAgICMgYCQkJyBpcyBhIGxpdGVyYWwgYCQnIGluIG1ha2UKICAgICAgICAgICAgdG1wdiA9IHYucmVwbGFjZSgnJCQnLCAnJykKCiAgICAgICAgICAgIGlmICIkIiBpbiB0bXB2OgogICAgICAgICAgICAgICAgbm90ZG9uZVtuXSA9IHYKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICB2ID0gaW50KHYpCiAgICAgICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgICAgICAgICAjIGluc2VydCBsaXRlcmFsIGAkJwogICAgICAgICAgICAgICAgICAgIGRvbmVbbl0gPSB2LnJlcGxhY2UoJyQkJywgJyQnKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBkb25lW25dID0gdgoKICAgICMgZG8gdmFyaWFibGUgaW50ZXJwb2xhdGlvbiBoZXJlCiAgICB2YXJpYWJsZXMgPSBsaXN0KG5vdGRvbmUua2V5cygpKQoKICAgICMgVmFyaWFibGVzIHdpdGggYSAnUFlfJyBwcmVmaXggaW4gdGhlIG1ha2VmaWxlLiBUaGVzZSBuZWVkIHRvCiAgICAjIGJlIG1hZGUgYXZhaWxhYmxlIHdpdGhvdXQgdGhhdCBwcmVmaXggdGhyb3VnaCBzeXNjb25maWcuCiAgICAjIFNwZWNpYWwgY2FyZSBpcyBuZWVkZWQgdG8gZW5zdXJlIHRoYXQgdmFyaWFibGUgZXhwYW5zaW9uIHdvcmtzLCBldmVuCiAgICAjIGlmIHRoZSBleHBhbnNpb24gdXNlcyB0aGUgbmFtZSB3aXRob3V0IGEgcHJlZml4LgogICAgcmVuYW1lZF92YXJpYWJsZXMgPSAoJ0NGTEFHUycsICdMREZMQUdTJywgJ0NQUEZMQUdTJykKCiAgICB3aGlsZSBsZW4odmFyaWFibGVzKSA+IDA6CiAgICAgICAgZm9yIG5hbWUgaW4gdHVwbGUodmFyaWFibGVzKToKICAgICAgICAgICAgdmFsdWUgPSBub3Rkb25lW25hbWVdCiAgICAgICAgICAgIG0gPSBfZmluZHZhcjFfcnguc2VhcmNoKHZhbHVlKSBvciBfZmluZHZhcjJfcnguc2VhcmNoKHZhbHVlKQogICAgICAgICAgICBpZiBtIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgbiA9IG0uZ3JvdXAoMSkKICAgICAgICAgICAgICAgIGZvdW5kID0gVHJ1ZQogICAgICAgICAgICAgICAgaWYgbiBpbiBkb25lOgogICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBzdHIoZG9uZVtuXSkKICAgICAgICAgICAgICAgIGVsaWYgbiBpbiBub3Rkb25lOgogICAgICAgICAgICAgICAgICAgICMgZ2V0IGl0IG9uIGEgc3Vic2VxdWVudCByb3VuZAogICAgICAgICAgICAgICAgICAgIGZvdW5kID0gRmFsc2UKICAgICAgICAgICAgICAgIGVsaWYgbiBpbiBvcy5lbnZpcm9uOgogICAgICAgICAgICAgICAgICAgICMgZG8gaXQgbGlrZSBtYWtlOiBmYWxsIGJhY2sgdG8gZW52aXJvbm1lbnQKICAgICAgICAgICAgICAgICAgICBpdGVtID0gb3MuZW52aXJvbltuXQoKICAgICAgICAgICAgICAgIGVsaWYgbiBpbiByZW5hbWVkX3ZhcmlhYmxlczoKICAgICAgICAgICAgICAgICAgICBpZiAobmFtZS5zdGFydHN3aXRoKCdQWV8nKSBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVszOl0gaW4gcmVuYW1lZF92YXJpYWJsZXMpOgogICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gIiIKCiAgICAgICAgICAgICAgICAgICAgZWxpZiAnUFlfJyArIG4gaW4gbm90ZG9uZToKICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSBGYWxzZQoKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gc3RyKGRvbmVbJ1BZXycgKyBuXSkKCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGRvbmVbbl0gPSBpdGVtID0gIiIKCiAgICAgICAgICAgICAgICBpZiBmb3VuZDoKICAgICAgICAgICAgICAgICAgICBhZnRlciA9IHZhbHVlW20uZW5kKCk6XQogICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWVbOm0uc3RhcnQoKV0gKyBpdGVtICsgYWZ0ZXIKICAgICAgICAgICAgICAgICAgICBpZiAiJCIgaW4gYWZ0ZXI6CiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGRvbmVbbmFtZV0gPSB2YWx1ZQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gaW50KHZhbHVlKQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbmVbbmFtZV0gPSB2YWx1ZS5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lW25hbWVdID0gdmFsdWUKICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFibGVzLnJlbW92ZShuYW1lKQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbmFtZS5zdGFydHN3aXRoKCdQWV8nKSBcCiAgICAgICAgICAgICAgICAgICAgICAgIGFuZCBuYW1lWzM6XSBpbiByZW5hbWVkX3ZhcmlhYmxlczoKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gbmFtZVszOl0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5hbWUgbm90IGluIGRvbmU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9uZVtuYW1lXSA9IHZhbHVlCgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgIyBib2d1cyB2YXJpYWJsZSByZWZlcmVuY2UgKGUuZy4gInByZWZpeD0kL29wdC9weXRob24iKTsKICAgICAgICAgICAgICAgICMganVzdCBkcm9wIGl0IHNpbmNlIHdlIGNhbid0IGRlYWwKICAgICAgICAgICAgICAgIGRvbmVbbmFtZV0gPSB2YWx1ZQogICAgICAgICAgICAgICAgdmFyaWFibGVzLnJlbW92ZShuYW1lKQoKICAgICMgc3RyaXAgc3B1cmlvdXMgc3BhY2VzCiAgICBmb3IgaywgdiBpbiBkb25lLml0ZW1zKCk6CiAgICAgICAgaWYgaXNpbnN0YW5jZSh2LCBzdHIpOgogICAgICAgICAgICBkb25lW2tdID0gdi5zdHJpcCgpCgogICAgIyBzYXZlIHRoZSByZXN1bHRzIGluIHRoZSBnbG9iYWwgZGljdGlvbmFyeQogICAgdmFycy51cGRhdGUoZG9uZSkKICAgIHJldHVybiB2YXJzCgoKZGVmIGdldF9tYWtlZmlsZV9maWxlbmFtZSgpOgogICAgIiIiUmV0dXJuIHRoZSBwYXRoIG9mIHRoZSBNYWtlZmlsZS4iIiIKICAgIGlmIF9QWVRIT05fQlVJTEQ6CiAgICAgICAgcmV0dXJuIG9zLnBhdGguam9pbihfc3lzX2hvbWUgb3IgX1BST0pFQ1RfQkFTRSwgIk1ha2VmaWxlIikKICAgIGlmIGhhc2F0dHIoc3lzLCAnYWJpZmxhZ3MnKToKICAgICAgICBjb25maWdfZGlyX25hbWUgPSAnY29uZmlnLSVzJXMnICUgKF9QWV9WRVJTSU9OX1NIT1JULCBzeXMuYWJpZmxhZ3MpCiAgICBlbHNlOgogICAgICAgIGNvbmZpZ19kaXJfbmFtZSA9ICdjb25maWcnCiAgICByZXR1cm4gb3MucGF0aC5qb2luKGdldF9wYXRoKCdzdGRsaWInKSwgY29uZmlnX2Rpcl9uYW1lLCAnTWFrZWZpbGUnKQoKZGVmIF9nZW5lcmF0ZV9wb3NpeF92YXJzKCk6CiAgICAiIiJHZW5lcmF0ZSB0aGUgUHl0aG9uIG1vZHVsZSBjb250YWluaW5nIGJ1aWxkLXRpbWUgdmFyaWFibGVzLiIiIgogICAgaW1wb3J0IHBwcmludAogICAgdmFycyA9IHt9CiAgICAjIGxvYWQgdGhlIGluc3RhbGxlZCBNYWtlZmlsZToKICAgIG1ha2VmaWxlID0gZ2V0X21ha2VmaWxlX2ZpbGVuYW1lKCkKICAgIHRyeToKICAgICAgICBfcGFyc2VfbWFrZWZpbGUobWFrZWZpbGUsIHZhcnMpCiAgICBleGNlcHQgSU9FcnJvciBhcyBlOgogICAgICAgIG1zZyA9ICJpbnZhbGlkIFB5dGhvbiBpbnN0YWxsYXRpb246IHVuYWJsZSB0byBvcGVuICVzIiAlIG1ha2VmaWxlCiAgICAgICAgaWYgaGFzYXR0cihlLCAic3RyZXJyb3IiKToKICAgICAgICAgICAgbXNnID0gbXNnICsgIiAoJXMpIiAlIGUuc3RyZXJyb3IKICAgICAgICByYWlzZSBJT0Vycm9yKG1zZykKICAgICMgbG9hZCB0aGUgaW5zdGFsbGVkIHB5Y29uZmlnLmg6CiAgICBjb25maWdfaCA9IGdldF9jb25maWdfaF9maWxlbmFtZSgpCiAgICB0cnk6CiAgICAgICAgd2l0aCBvcGVuKGNvbmZpZ19oKSBhcyBmOgogICAgICAgICAgICBwYXJzZV9jb25maWdfaChmLCB2YXJzKQogICAgZXhjZXB0IElPRXJyb3IgYXMgZToKICAgICAgICBtc2cgPSAiaW52YWxpZCBQeXRob24gaW5zdGFsbGF0aW9uOiB1bmFibGUgdG8gb3BlbiAlcyIgJSBjb25maWdfaAogICAgICAgIGlmIGhhc2F0dHIoZSwgInN0cmVycm9yIik6CiAgICAgICAgICAgIG1zZyA9IG1zZyArICIgKCVzKSIgJSBlLnN0cmVycm9yCiAgICAgICAgcmFpc2UgSU9FcnJvcihtc2cpCiAgICAjIE9uIEFJWCwgdGhlcmUgYXJlIHdyb25nIHBhdGhzIHRvIHRoZSBsaW5rZXIgc2NyaXB0cyBpbiB0aGUgTWFrZWZpbGUKICAgICMgLS0gdGhlc2UgcGF0aHMgYXJlIHJlbGF0aXZlIHRvIHRoZSBQeXRob24gc291cmNlLCBidXQgd2hlbiBpbnN0YWxsZWQKICAgICMgdGhlIHNjcmlwdHMgYXJlIGluIGFub3RoZXIgZGlyZWN0b3J5LgogICAgaWYgX1BZVEhPTl9CVUlMRDoKICAgICAgICB2YXJzWydMRFNIQVJFRCddID0gdmFyc1snQkxEU0hBUkVEJ10KCiAgICBkZXN0ZmlsZSA9IG9zLnBhdGguam9pbihvcy5wYXRoLmRpcm5hbWUoX19maWxlX18pLCAnX3N5c2NvbmZpZ2RhdGEucHknKQogICAgd2l0aCBvcGVuKGRlc3RmaWxlLCAndycsIGVuY29kaW5nPSd1dGY4JykgYXMgZjoKICAgICAgICBmLndyaXRlKCcjIHN5c3RlbSBjb25maWd1cmF0aW9uIGdlbmVyYXRlZCBhbmQgdXNlZCBieScKICAgICAgICAgICAgICAgICcgdGhlIHN5c2NvbmZpZyBtb2R1bGVcbicpCiAgICAgICAgZi53cml0ZSgnYnVpbGRfdGltZV92YXJzID0gJykKICAgICAgICBwcHJpbnQucHByaW50KHZhcnMsIHN0cmVhbT1mKQoKZGVmIF9pbml0X3Bvc2l4KHZhcnMpOgogICAgIiIiSW5pdGlhbGl6ZSB0aGUgbW9kdWxlIGFzIGFwcHJvcHJpYXRlIGZvciBQT1NJWCBzeXN0ZW1zLiIiIgogICAgIyBfc3lzY29uZmlnZGF0YSBpcyBnZW5lcmF0ZWQgYXQgYnVpbGQgdGltZSwgc2VlIF9nZW5lcmF0ZV9wb3NpeF92YXJzKCkKICAgIGZyb20gX3N5c2NvbmZpZ2RhdGEgaW1wb3J0IGJ1aWxkX3RpbWVfdmFycwogICAgdmFycy51cGRhdGUoYnVpbGRfdGltZV92YXJzKQoKZGVmIF9pbml0X25vbl9wb3NpeCh2YXJzKToKICAgICIiIkluaXRpYWxpemUgdGhlIG1vZHVsZSBhcyBhcHByb3ByaWF0ZSBmb3IgTlQiIiIKICAgICMgc2V0IGJhc2ljIGluc3RhbGwgZGlyZWN0b3JpZXMKICAgIHZhcnNbJ0xJQkRFU1QnXSA9IGdldF9wYXRoKCdzdGRsaWInKQogICAgdmFyc1snQklOTElCREVTVCddID0gZ2V0X3BhdGgoJ3BsYXRzdGRsaWInKQogICAgdmFyc1snSU5DTFVERVBZJ10gPSBnZXRfcGF0aCgnaW5jbHVkZScpCiAgICB2YXJzWydTTyddID0gJy5weWQnCiAgICB2YXJzWydFWEUnXSA9ICcuZXhlJwogICAgdmFyc1snVkVSU0lPTiddID0gX1BZX1ZFUlNJT05fU0hPUlRfTk9fRE9UCiAgICB2YXJzWydCSU5ESVInXSA9IG9zLnBhdGguZGlybmFtZShfc2FmZV9yZWFscGF0aChzeXMuZXhlY3V0YWJsZSkpCgojCiMgcHVibGljIEFQSXMKIwoKCmRlZiBwYXJzZV9jb25maWdfaChmcCwgdmFycz1Ob25lKToKICAgICIiIlBhcnNlIGEgY29uZmlnLmgtc3R5bGUgZmlsZS4KCiAgICBBIGRpY3Rpb25hcnkgY29udGFpbmluZyBuYW1lL3ZhbHVlIHBhaXJzIGlzIHJldHVybmVkLiAgSWYgYW4KICAgIG9wdGlvbmFsIGRpY3Rpb25hcnkgaXMgcGFzc2VkIGluIGFzIHRoZSBzZWNvbmQgYXJndW1lbnQsIGl0IGlzCiAgICB1c2VkIGluc3RlYWQgb2YgYSBuZXcgZGljdGlvbmFyeS4KICAgICIiIgogICAgaWYgdmFycyBpcyBOb25lOgogICAgICAgIHZhcnMgPSB7fQogICAgZGVmaW5lX3J4ID0gcmUuY29tcGlsZSgiI2RlZmluZSAoW0EtWl1bQS1aYS16MC05X10rKSAoLiopXG4iKQogICAgdW5kZWZfcnggPSByZS5jb21waWxlKCIvWypdICN1bmRlZiAoW0EtWl1bQS1aYS16MC05X10rKSBbKl0vXG4iKQoKICAgIHdoaWxlIFRydWU6CiAgICAgICAgbGluZSA9IGZwLnJlYWRsaW5lKCkKICAgICAgICBpZiBub3QgbGluZToKICAgICAgICAgICAgYnJlYWsKICAgICAgICBtID0gZGVmaW5lX3J4Lm1hdGNoKGxpbmUpCiAgICAgICAgaWYgbToKICAgICAgICAgICAgbiwgdiA9IG0uZ3JvdXAoMSwgMikKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgdiA9IGludCh2KQogICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgdmFyc1tuXSA9IHYKICAgICAgICBlbHNlOgogICAgICAgICAgICBtID0gdW5kZWZfcngubWF0Y2gobGluZSkKICAgICAgICAgICAgaWYgbToKICAgICAgICAgICAgICAgIHZhcnNbbS5ncm91cCgxKV0gPSAwCiAgICByZXR1cm4gdmFycwoKCmRlZiBnZXRfY29uZmlnX2hfZmlsZW5hbWUoKToKICAgICIiIlJldHVybiB0aGUgcGF0aCBvZiBweWNvbmZpZy5oLiIiIgogICAgaWYgX1BZVEhPTl9CVUlMRDoKICAgICAgICBpZiBvcy5uYW1lID09ICJudCI6CiAgICAgICAgICAgIGluY19kaXIgPSBvcy5wYXRoLmpvaW4oX3N5c19ob21lIG9yIF9QUk9KRUNUX0JBU0UsICJQQyIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaW5jX2RpciA9IF9zeXNfaG9tZSBvciBfUFJPSkVDVF9CQVNFCiAgICBlbHNlOgogICAgICAgIGluY19kaXIgPSBnZXRfcGF0aCgncGxhdGluY2x1ZGUnKQogICAgcmV0dXJuIG9zLnBhdGguam9pbihpbmNfZGlyLCAncHljb25maWcuaCcpCgoKZGVmIGdldF9zY2hlbWVfbmFtZXMoKToKICAgICIiIlJldHVybiBhIHR1cGxlIGNvbnRhaW5pbmcgdGhlIHNjaGVtZXMgbmFtZXMuIiIiCiAgICByZXR1cm4gdHVwbGUoc29ydGVkKF9JTlNUQUxMX1NDSEVNRVMpKQoKCmRlZiBnZXRfcGF0aF9uYW1lcygpOgogICAgIiIiUmV0dXJuIGEgdHVwbGUgY29udGFpbmluZyB0aGUgcGF0aHMgbmFtZXMuIiIiCiAgICByZXR1cm4gX1NDSEVNRV9LRVlTCgoKZGVmIGdldF9wYXRocyhzY2hlbWU9X2dldF9kZWZhdWx0X3NjaGVtZSgpLCB2YXJzPU5vbmUsIGV4cGFuZD1UcnVlKToKICAgICIiIlJldHVybiBhIG1hcHBpbmcgY29udGFpbmluZyBhbiBpbnN0YWxsIHNjaGVtZS4KCiAgICBgYHNjaGVtZWBgIGlzIHRoZSBpbnN0YWxsIHNjaGVtZSBuYW1lLiBJZiBub3QgcHJvdmlkZWQsIGl0IHdpbGwKICAgIHJldHVybiB0aGUgZGVmYXVsdCBzY2hlbWUgZm9yIHRoZSBjdXJyZW50IHBsYXRmb3JtLgogICAgIiIiCiAgICBpZiBleHBhbmQ6CiAgICAgICAgcmV0dXJuIF9leHBhbmRfdmFycyhzY2hlbWUsIHZhcnMpCiAgICBlbHNlOgogICAgICAgIHJldHVybiBfSU5TVEFMTF9TQ0hFTUVTW3NjaGVtZV0KCgpkZWYgZ2V0X3BhdGgobmFtZSwgc2NoZW1lPV9nZXRfZGVmYXVsdF9zY2hlbWUoKSwgdmFycz1Ob25lLCBleHBhbmQ9VHJ1ZSk6CiAgICAiIiJSZXR1cm4gYSBwYXRoIGNvcnJlc3BvbmRpbmcgdG8gdGhlIHNjaGVtZS4KCiAgICBgYHNjaGVtZWBgIGlzIHRoZSBpbnN0YWxsIHNjaGVtZSBuYW1lLgogICAgIiIiCiAgICByZXR1cm4gZ2V0X3BhdGhzKHNjaGVtZSwgdmFycywgZXhwYW5kKVtuYW1lXQoKCmRlZiBnZXRfY29uZmlnX3ZhcnMoKmFyZ3MpOgogICAgIiIiV2l0aCBubyBhcmd1bWVudHMsIHJldHVybiBhIGRpY3Rpb25hcnkgb2YgYWxsIGNvbmZpZ3VyYXRpb24KICAgIHZhcmlhYmxlcyByZWxldmFudCBmb3IgdGhlIGN1cnJlbnQgcGxhdGZvcm0uCgogICAgT24gVW5peCwgdGhpcyBtZWFucyBldmVyeSB2YXJpYWJsZSBkZWZpbmVkIGluIFB5dGhvbidzIGluc3RhbGxlZCBNYWtlZmlsZTsKICAgIE9uIFdpbmRvd3MgaXQncyBhIG11Y2ggc21hbGxlciBzZXQuCgogICAgV2l0aCBhcmd1bWVudHMsIHJldHVybiBhIGxpc3Qgb2YgdmFsdWVzIHRoYXQgcmVzdWx0IGZyb20gbG9va2luZyB1cAogICAgZWFjaCBhcmd1bWVudCBpbiB0aGUgY29uZmlndXJhdGlvbiB2YXJpYWJsZSBkaWN0aW9uYXJ5LgogICAgIiIiCiAgICBnbG9iYWwgX0NPTkZJR19WQVJTCiAgICBpZiBfQ09ORklHX1ZBUlMgaXMgTm9uZToKICAgICAgICBfQ09ORklHX1ZBUlMgPSB7fQogICAgICAgICMgTm9ybWFsaXplZCB2ZXJzaW9ucyBvZiBwcmVmaXggYW5kIGV4ZWNfcHJlZml4IGFyZSBoYW5keSB0byBoYXZlOwogICAgICAgICMgaW4gZmFjdCwgdGhlc2UgYXJlIHRoZSBzdGFuZGFyZCB2ZXJzaW9ucyB1c2VkIG1vc3QgcGxhY2VzIGluIHRoZQogICAgICAgICMgRGlzdHV0aWxzLgogICAgICAgIF9DT05GSUdfVkFSU1sncHJlZml4J10gPSBfUFJFRklYCiAgICAgICAgX0NPTkZJR19WQVJTWydleGVjX3ByZWZpeCddID0gX0VYRUNfUFJFRklYCiAgICAgICAgX0NPTkZJR19WQVJTWydweV92ZXJzaW9uJ10gPSBfUFlfVkVSU0lPTgogICAgICAgIF9DT05GSUdfVkFSU1sncHlfdmVyc2lvbl9zaG9ydCddID0gX1BZX1ZFUlNJT05fU0hPUlQKICAgICAgICBfQ09ORklHX1ZBUlNbJ3B5X3ZlcnNpb25fbm9kb3QnXSA9IF9QWV9WRVJTSU9OWzBdICsgX1BZX1ZFUlNJT05bMl0KICAgICAgICBfQ09ORklHX1ZBUlNbJ2luc3RhbGxlZF9iYXNlJ10gPSBfQkFTRV9QUkVGSVgKICAgICAgICBfQ09ORklHX1ZBUlNbJ2Jhc2UnXSA9IF9QUkVGSVgKICAgICAgICBfQ09ORklHX1ZBUlNbJ2luc3RhbGxlZF9wbGF0YmFzZSddID0gX0JBU0VfRVhFQ19QUkVGSVgKICAgICAgICBfQ09ORklHX1ZBUlNbJ3BsYXRiYXNlJ10gPSBfRVhFQ19QUkVGSVgKICAgICAgICBfQ09ORklHX1ZBUlNbJ3Byb2plY3RiYXNlJ10gPSBfUFJPSkVDVF9CQVNFCiAgICAgICAgdHJ5OgogICAgICAgICAgICBfQ09ORklHX1ZBUlNbJ2FiaWZsYWdzJ10gPSBzeXMuYWJpZmxhZ3MKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgICMgc3lzLmFiaWZsYWdzIG1heSBub3QgYmUgZGVmaW5lZCBvbiBhbGwgcGxhdGZvcm1zLgogICAgICAgICAgICBfQ09ORklHX1ZBUlNbJ2FiaWZsYWdzJ10gPSAnJwoKICAgICAgICBpZiBvcy5uYW1lIGluICgnbnQnLCAnb3MyJyk6CiAgICAgICAgICAgIF9pbml0X25vbl9wb3NpeChfQ09ORklHX1ZBUlMpCiAgICAgICAgaWYgb3MubmFtZSA9PSAncG9zaXgnOgogICAgICAgICAgICBfaW5pdF9wb3NpeChfQ09ORklHX1ZBUlMpCiAgICAgICAgIyBTZXR0aW5nICd1c2VyYmFzZScgaXMgZG9uZSBiZWxvdyB0aGUgY2FsbCB0byB0aGUKICAgICAgICAjIGluaXQgZnVuY3Rpb24gdG8gZW5hYmxlIHVzaW5nICdnZXRfY29uZmlnX3ZhcicgaW4KICAgICAgICAjIHRoZSBpbml0LWZ1bmN0aW9uLgogICAgICAgIF9DT05GSUdfVkFSU1sndXNlcmJhc2UnXSA9IF9nZXR1c2VyYmFzZSgpCgogICAgICAgICMgQWx3YXlzIGNvbnZlcnQgc3JjZGlyIHRvIGFuIGFic29sdXRlIHBhdGgKICAgICAgICBzcmNkaXIgPSBfQ09ORklHX1ZBUlMuZ2V0KCdzcmNkaXInLCBfUFJPSkVDVF9CQVNFKQogICAgICAgIGlmIG9zLm5hbWUgPT0gJ3Bvc2l4JzoKICAgICAgICAgICAgaWYgX1BZVEhPTl9CVUlMRDoKICAgICAgICAgICAgICAgICMgSWYgc3JjZGlyIGlzIGEgcmVsYXRpdmUgcGF0aCAodHlwaWNhbGx5ICcuJyBvciAnLi4nKQogICAgICAgICAgICAgICAgIyB0aGVuIGl0IHNob3VsZCBiZSBpbnRlcnByZXRlZCByZWxhdGl2ZSB0byB0aGUgZGlyZWN0b3J5CiAgICAgICAgICAgICAgICAjIGNvbnRhaW5pbmcgTWFrZWZpbGUuCiAgICAgICAgICAgICAgICBiYXNlID0gb3MucGF0aC5kaXJuYW1lKGdldF9tYWtlZmlsZV9maWxlbmFtZSgpKQogICAgICAgICAgICAgICAgc3JjZGlyID0gb3MucGF0aC5qb2luKGJhc2UsIHNyY2RpcikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICMgc3JjZGlyIGlzIG5vdCBtZWFuaW5nZnVsIHNpbmNlIHRoZSBpbnN0YWxsYXRpb24gaXMKICAgICAgICAgICAgICAgICMgc3ByZWFkIGFib3V0IHRoZSBmaWxlc3lzdGVtLiAgV2UgY2hvb3NlIHRoZQogICAgICAgICAgICAgICAgIyBkaXJlY3RvcnkgY29udGFpbmluZyB0aGUgTWFrZWZpbGUgc2luY2Ugd2Uga25vdyBpdAogICAgICAgICAgICAgICAgIyBleGlzdHMuCiAgICAgICAgICAgICAgICBzcmNkaXIgPSBvcy5wYXRoLmRpcm5hbWUoZ2V0X21ha2VmaWxlX2ZpbGVuYW1lKCkpCiAgICAgICAgX0NPTkZJR19WQVJTWydzcmNkaXInXSA9IF9zYWZlX3JlYWxwYXRoKHNyY2RpcikKCiAgICAgICAgIyBPUyBYIHBsYXRmb3JtcyByZXF1aXJlIHNwZWNpYWwgY3VzdG9taXphdGlvbiB0byBoYW5kbGUKICAgICAgICAjIG11bHRpLWFyY2hpdGVjdHVyZSwgbXVsdGktb3MtdmVyc2lvbiBpbnN0YWxsZXJzCiAgICAgICAgaWYgc3lzLnBsYXRmb3JtID09ICdkYXJ3aW4nOgogICAgICAgICAgICBpbXBvcnQgX29zeF9zdXBwb3J0CiAgICAgICAgICAgIF9vc3hfc3VwcG9ydC5jdXN0b21pemVfY29uZmlnX3ZhcnMoX0NPTkZJR19WQVJTKQoKICAgIGlmIGFyZ3M6CiAgICAgICAgdmFscyA9IFtdCiAgICAgICAgZm9yIG5hbWUgaW4gYXJnczoKICAgICAgICAgICAgdmFscy5hcHBlbmQoX0NPTkZJR19WQVJTLmdldChuYW1lKSkKICAgICAgICByZXR1cm4gdmFscwogICAgZWxzZToKICAgICAgICByZXR1cm4gX0NPTkZJR19WQVJTCgoKZGVmIGdldF9jb25maWdfdmFyKG5hbWUpOgogICAgIiIiUmV0dXJuIHRoZSB2YWx1ZSBvZiBhIHNpbmdsZSB2YXJpYWJsZSB1c2luZyB0aGUgZGljdGlvbmFyeSByZXR1cm5lZCBieQogICAgJ2dldF9jb25maWdfdmFycygpJy4KCiAgICBFcXVpdmFsZW50IHRvIGdldF9jb25maWdfdmFycygpLmdldChuYW1lKQogICAgIiIiCiAgICByZXR1cm4gZ2V0X2NvbmZpZ192YXJzKCkuZ2V0KG5hbWUpCgoKZGVmIGdldF9wbGF0Zm9ybSgpOgogICAgIiIiUmV0dXJuIGEgc3RyaW5nIHRoYXQgaWRlbnRpZmllcyB0aGUgY3VycmVudCBwbGF0Zm9ybS4KCiAgICBUaGlzIGlzIHVzZWQgbWFpbmx5IHRvIGRpc3Rpbmd1aXNoIHBsYXRmb3JtLXNwZWNpZmljIGJ1aWxkIGRpcmVjdG9yaWVzIGFuZAogICAgcGxhdGZvcm0tc3BlY2lmaWMgYnVpbHQgZGlzdHJpYnV0aW9ucy4gIFR5cGljYWxseSBpbmNsdWRlcyB0aGUgT1MgbmFtZQogICAgYW5kIHZlcnNpb24gYW5kIHRoZSBhcmNoaXRlY3R1cmUgKGFzIHN1cHBsaWVkIGJ5ICdvcy51bmFtZSgpJyksCiAgICBhbHRob3VnaCB0aGUgZXhhY3QgaW5mb3JtYXRpb24gaW5jbHVkZWQgZGVwZW5kcyBvbiB0aGUgT1M7IGVnLiBmb3IgSVJJWAogICAgdGhlIGFyY2hpdGVjdHVyZSBpc24ndCBwYXJ0aWN1bGFybHkgaW1wb3J0YW50IChJUklYIG9ubHkgcnVucyBvbiBTR0kKICAgIGhhcmR3YXJlKSwgYnV0IGZvciBMaW51eCB0aGUga2VybmVsIHZlcnNpb24gaXNuJ3QgcGFydGljdWxhcmx5CiAgICBpbXBvcnRhbnQuCgogICAgRXhhbXBsZXMgb2YgcmV0dXJuZWQgdmFsdWVzOgogICAgICAgbGludXgtaTU4NgogICAgICAgbGludXgtYWxwaGEgKD8pCiAgICAgICBzb2xhcmlzLTIuNi1zdW40dQogICAgICAgaXJpeC01LjMKICAgICAgIGlyaXg2NC02LjIKCiAgICBXaW5kb3dzIHdpbGwgcmV0dXJuIG9uZSBvZjoKICAgICAgIHdpbi1hbWQ2NCAoNjRiaXQgV2luZG93cyBvbiBBTUQ2NCAoYWthIHg4Nl82NCwgSW50ZWw2NCwgRU02NFQsIGV0YykKICAgICAgIHdpbi1pYTY0ICg2NGJpdCBXaW5kb3dzIG9uIEl0YW5pdW0pCiAgICAgICB3aW4zMiAoYWxsIG90aGVycyAtIHNwZWNpZmljYWxseSwgc3lzLnBsYXRmb3JtIGlzIHJldHVybmVkKQoKICAgIEZvciBvdGhlciBub24tUE9TSVggcGxhdGZvcm1zLCBjdXJyZW50bHkganVzdCByZXR1cm5zICdzeXMucGxhdGZvcm0nLgogICAgIiIiCiAgICBpZiBvcy5uYW1lID09ICdudCc6CiAgICAgICAgIyBzbmlmZiBzeXMudmVyc2lvbiBmb3IgYXJjaGl0ZWN0dXJlLgogICAgICAgIHByZWZpeCA9ICIgYml0ICgiCiAgICAgICAgaSA9IHN5cy52ZXJzaW9uLmZpbmQocHJlZml4KQogICAgICAgIGlmIGkgPT0gLTE6CiAgICAgICAgICAgIHJldHVybiBzeXMucGxhdGZvcm0KICAgICAgICBqID0gc3lzLnZlcnNpb24uZmluZCgiKSIsIGkpCiAgICAgICAgbG9vayA9IHN5cy52ZXJzaW9uW2krbGVuKHByZWZpeCk6al0ubG93ZXIoKQogICAgICAgIGlmIGxvb2sgPT0gJ2FtZDY0JzoKICAgICAgICAgICAgcmV0dXJuICd3aW4tYW1kNjQnCiAgICAgICAgaWYgbG9vayA9PSAnaXRhbml1bSc6CiAgICAgICAgICAgIHJldHVybiAnd2luLWlhNjQnCiAgICAgICAgcmV0dXJuIHN5cy5wbGF0Zm9ybQoKICAgIGlmIG9zLm5hbWUgIT0gInBvc2l4IiBvciBub3QgaGFzYXR0cihvcywgJ3VuYW1lJyk6CiAgICAgICAgIyBYWFggd2hhdCBhYm91dCB0aGUgYXJjaGl0ZWN0dXJlPyBOVCBpcyBJbnRlbCBvciBBbHBoYQogICAgICAgIHJldHVybiBzeXMucGxhdGZvcm0KCiAgICAjIFNldCBmb3IgY3Jvc3MgYnVpbGRzIGV4cGxpY2l0bHkKICAgIGlmICJfUFlUSE9OX0hPU1RfUExBVEZPUk0iIGluIG9zLmVudmlyb246CiAgICAgICAgcmV0dXJuIG9zLmVudmlyb25bIl9QWVRIT05fSE9TVF9QTEFURk9STSJdCgogICAgIyBUcnkgdG8gZGlzdGluZ3Vpc2ggdmFyaW91cyBmbGF2b3VycyBvZiBVbml4CiAgICBvc25hbWUsIGhvc3QsIHJlbGVhc2UsIHZlcnNpb24sIG1hY2hpbmUgPSBvcy51bmFtZSgpCgogICAgIyBDb252ZXJ0IHRoZSBPUyBuYW1lIHRvIGxvd2VyY2FzZSwgcmVtb3ZlICcvJyBjaGFyYWN0ZXJzCiAgICAjICh0byBhY2NvbW1vZGF0ZSBCU0QvT1MpLCBhbmQgdHJhbnNsYXRlIHNwYWNlcyAoZm9yICJQb3dlciBNYWNpbnRvc2giKQogICAgb3NuYW1lID0gb3NuYW1lLmxvd2VyKCkucmVwbGFjZSgnLycsICcnKQogICAgbWFjaGluZSA9IG1hY2hpbmUucmVwbGFjZSgnICcsICdfJykKICAgIG1hY2hpbmUgPSBtYWNoaW5lLnJlcGxhY2UoJy8nLCAnLScpCgogICAgaWYgb3NuYW1lWzo1XSA9PSAibGludXgiOgogICAgICAgICMgQXQgbGVhc3Qgb24gTGludXgvSW50ZWwsICdtYWNoaW5lJyBpcyB0aGUgcHJvY2Vzc29yIC0tCiAgICAgICAgIyBpMzg2LCBldGMuCiAgICAgICAgIyBYWFggd2hhdCBhYm91dCBBbHBoYSwgU1BBUkMsIGV0Yz8KICAgICAgICByZXR1cm4gICIlcy0lcyIgJSAob3NuYW1lLCBtYWNoaW5lKQogICAgZWxpZiBvc25hbWVbOjVdID09ICJzdW5vcyI6CiAgICAgICAgaWYgcmVsZWFzZVswXSA+PSAiNSI6ICAgICAgICAgICAjIFN1bk9TIDUgPT0gU29sYXJpcyAyCiAgICAgICAgICAgIG9zbmFtZSA9ICJzb2xhcmlzIgogICAgICAgICAgICByZWxlYXNlID0gIiVkLiVzIiAlIChpbnQocmVsZWFzZVswXSkgLSAzLCByZWxlYXNlWzI6XSkKICAgICAgICAgICAgIyBXZSBjYW4ndCB1c2UgInBsYXRmb3JtLmFyY2hpdGVjdHVyZSgpWzBdIiBiZWNhdXNlIGEKICAgICAgICAgICAgIyBib290c3RyYXAgcHJvYmxlbS4gV2UgdXNlIGEgZGljdCB0byBnZXQgYW4gZXJyb3IKICAgICAgICAgICAgIyBpZiBzb21lIHN1c3BpY2lvdXMgaGFwcGVucy4KICAgICAgICAgICAgYml0bmVzcyA9IHsyMTQ3NDgzNjQ3OiIzMmJpdCIsIDkyMjMzNzIwMzY4NTQ3NzU4MDc6IjY0Yml0In0KICAgICAgICAgICAgbWFjaGluZSArPSAiLiVzIiAlIGJpdG5lc3Nbc3lzLm1heHNpemVdCiAgICAgICAgIyBmYWxsIHRocm91Z2ggdG8gc3RhbmRhcmQgb3NuYW1lLXJlbGVhc2UtbWFjaGluZSByZXByZXNlbnRhdGlvbgogICAgZWxpZiBvc25hbWVbOjRdID09ICJpcml4IjogICAgICAgICAgICAgICMgY291bGQgYmUgImlyaXg2NCIhCiAgICAgICAgcmV0dXJuICIlcy0lcyIgJSAob3NuYW1lLCByZWxlYXNlKQogICAgZWxpZiBvc25hbWVbOjNdID09ICJhaXgiOgogICAgICAgIHJldHVybiAiJXMtJXMuJXMiICUgKG9zbmFtZSwgdmVyc2lvbiwgcmVsZWFzZSkKICAgIGVsaWYgb3NuYW1lWzo2XSA9PSAiY3lnd2luIjoKICAgICAgICBvc25hbWUgPSAiY3lnd2luIgogICAgICAgIHJlbF9yZSA9IHJlLmNvbXBpbGUocidbXGQuXSsnKQogICAgICAgIG0gPSByZWxfcmUubWF0Y2gocmVsZWFzZSkKICAgICAgICBpZiBtOgogICAgICAgICAgICByZWxlYXNlID0gbS5ncm91cCgpCiAgICBlbGlmIG9zbmFtZVs6Nl0gPT0gImRhcndpbiI6CiAgICAgICAgaW1wb3J0IF9vc3hfc3VwcG9ydAogICAgICAgIG9zbmFtZSwgcmVsZWFzZSwgbWFjaGluZSA9IF9vc3hfc3VwcG9ydC5nZXRfcGxhdGZvcm1fb3N4KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldF9jb25maWdfdmFycygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zbmFtZSwgcmVsZWFzZSwgbWFjaGluZSkKCiAgICByZXR1cm4gIiVzLSVzLSVzIiAlIChvc25hbWUsIHJlbGVhc2UsIG1hY2hpbmUpCgoKZGVmIGdldF9weXRob25fdmVyc2lvbigpOgogICAgcmV0dXJuIF9QWV9WRVJTSU9OX1NIT1JUCgoKZGVmIF9wcmludF9kaWN0KHRpdGxlLCBkYXRhKToKICAgIGZvciBpbmRleCwgKGtleSwgdmFsdWUpIGluIGVudW1lcmF0ZShzb3J0ZWQoZGF0YS5pdGVtcygpKSk6CiAgICAgICAgaWYgaW5kZXggPT0gMDoKICAgICAgICAgICAgcHJpbnQoJyVzOiAnICUgKHRpdGxlKSkKICAgICAgICBwcmludCgnXHQlcyA9ICIlcyInICUgKGtleSwgdmFsdWUpKQoKCmRlZiBfbWFpbigpOgogICAgIiIiRGlzcGxheSBhbGwgaW5mb3JtYXRpb24gc3lzY29uZmlnIGRldGFpbnMuIiIiCiAgICBpZiAnLS1nZW5lcmF0ZS1wb3NpeC12YXJzJyBpbiBzeXMuYXJndjoKICAgICAgICBfZ2VuZXJhdGVfcG9zaXhfdmFycygpCiAgICAgICAgcmV0dXJuCiAgICBwcmludCgnUGxhdGZvcm06ICIlcyInICUgZ2V0X3BsYXRmb3JtKCkpCiAgICBwcmludCgnUHl0aG9uIHZlcnNpb246ICIlcyInICUgZ2V0X3B5dGhvbl92ZXJzaW9uKCkpCiAgICBwcmludCgnQ3VycmVudCBpbnN0YWxsYXRpb24gc2NoZW1lOiAiJXMiJyAlIF9nZXRfZGVmYXVsdF9zY2hlbWUoKSkKICAgIHByaW50KCkKICAgIF9wcmludF9kaWN0KCdQYXRocycsIGdldF9wYXRocygpKQogICAgcHJpbnQoKQogICAgX3ByaW50X2RpY3QoJ1ZhcmlhYmxlcycsIGdldF9jb25maWdfdmFycygpKQoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICBfbWFpbigpCg==',
'/Lib/tarfile.py':'IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIHRhcmZpbGUucHkKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBDb3B5cmlnaHQgKEMpIDIwMDIgTGFycyBHdXN0YWViZWwgPGxhcnNAZ3VzdGFlYmVsLmRlPgojIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyBQZXJtaXNzaW9uICBpcyAgaGVyZWJ5IGdyYW50ZWQsICBmcmVlICBvZiBjaGFyZ2UsICB0byAgYW55IHBlcnNvbgojIG9idGFpbmluZyBhICBjb3B5IG9mICB0aGlzIHNvZnR3YXJlICBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uCiMgZmlsZXMgICh0aGUgICJTb2Z0d2FyZSIpLCAgdG8gICBkZWFsICBpbiAgdGhlICBTb2Z0d2FyZSAgIHdpdGhvdXQKIyByZXN0cmljdGlvbiwgIGluY2x1ZGluZyAgd2l0aG91dCBsaW1pdGF0aW9uICB0aGUgIHJpZ2h0cyB0byAgdXNlLAojIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsCiMgY29waWVzICBvZiAgdGhlICBTb2Z0d2FyZSwgIGFuZCB0byAgcGVybWl0ICBwZXJzb25zICB0byAgd2hvbSB0aGUKIyBTb2Z0d2FyZSAgaXMgIGZ1cm5pc2hlZCAgdG8gIGRvICBzbywgIHN1YmplY3QgIHRvICB0aGUgIGZvbGxvd2luZwojIGNvbmRpdGlvbnM6CiMKIyBUaGUgYWJvdmUgY29weXJpZ2h0ICBub3RpY2UgYW5kIHRoaXMgIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsICBiZQojIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgojCiMgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyAgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSAgS0lORCwKIyBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyAgQlVUIE5PVCBMSU1JVEVEIFRPICBUSEUgV0FSUkFOVElFUwojIE9GICBNRVJDSEFOVEFCSUxJVFksICBGSVRORVNTICAgRk9SICBBICBQQVJUSUNVTEFSICAgUFVSUE9TRSAgQU5ECiMgTk9OSU5GUklOR0VNRU5ULiAgSU4gIE5PICBFVkVOVCBTSEFMTCAgVEhFICBBVVRIT1JTICBPUiBDT1BZUklHSFQKIyBIT0xERVJTICBCRSBMSUFCTEUgIEZPUiBBTlkgIENMQUlNLCBEQU1BR0VTICBPUiBPVEhFUiAgTElBQklMSVRZLAojIFdIRVRIRVIgIElOIEFOICBBQ1RJT04gT0YgIENPTlRSQUNULCBUT1JUICBPUiBPVEhFUldJU0UsICBBUklTSU5HCiMgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUgojIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KIwoiIiJSZWFkIGZyb20gYW5kIHdyaXRlIHRvIHRhciBmb3JtYXQgYXJjaGl2ZXMuCiIiIgoKdmVyc2lvbiAgICAgPSAiMC45LjAiCl9fYXV0aG9yX18gID0gIkxhcnMgR3VzdFx1MDBlNGJlbCAobGFyc0BndXN0YWViZWwuZGUpIgpfX2RhdGVfXyAgICA9ICIkRGF0ZTogMjAxMS0wMi0yNSAxNzo0MjowMSArMDIwMCAoRnJpLCAyNSBGZWIgMjAxMSkgJCIKX19jdnNpZF9fICAgPSAiJElkOiB0YXJmaWxlLnB5IDg4NTg2IDIwMTEtMDItMjUgMTU6NDI6MDFaIG1hcmMtYW5kcmUubGVtYnVyZyAkIgpfX2NyZWRpdHNfXyA9ICJHdXN0YXZvIE5pZW1leWVyLCBOaWVscyBHdXN0XHUwMGU0YmVsLCBSaWNoYXJkIFRvd25zZW5kLiIKCiMtLS0tLS0tLS0KIyBJbXBvcnRzCiMtLS0tLS0tLS0KaW1wb3J0IHN5cwppbXBvcnQgb3MKaW1wb3J0IGlvCmltcG9ydCBzaHV0aWwKaW1wb3J0IHN0YXQKaW1wb3J0IHRpbWUKaW1wb3J0IHN0cnVjdAppbXBvcnQgY29weQppbXBvcnQgcmUKCnRyeToKICAgIGltcG9ydCBncnAsIHB3ZApleGNlcHQgSW1wb3J0RXJyb3I6CiAgICBncnAgPSBwd2QgPSBOb25lCgojIG9zLnN5bWxpbmsgb24gV2luZG93cyBwcmlvciB0byA2LjAgcmFpc2VzIE5vdEltcGxlbWVudGVkRXJyb3IKc3ltbGlua19leGNlcHRpb24gPSAoQXR0cmlidXRlRXJyb3IsIE5vdEltcGxlbWVudGVkRXJyb3IpCnRyeToKICAgICMgV2luZG93c0Vycm9yICgxMzE0KSB3aWxsIGJlIHJhaXNlZCBpZiB0aGUgY2FsbGVyIGRvZXMgbm90IGhvbGQgdGhlCiAgICAjIFNlQ3JlYXRlU3ltYm9saWNMaW5rUHJpdmlsZWdlIHByaXZpbGVnZQogICAgc3ltbGlua19leGNlcHRpb24gKz0gKFdpbmRvd3NFcnJvciwpCmV4Y2VwdCBOYW1lRXJyb3I6CiAgICBwYXNzCgojIGZyb20gdGFyZmlsZSBpbXBvcnQgKgpfX2FsbF9fID0gWyJUYXJGaWxlIiwgIlRhckluZm8iLCAiaXNfdGFyZmlsZSIsICJUYXJFcnJvciJdCgpmcm9tIGJ1aWx0aW5zIGltcG9ydCBvcGVuIGFzIF9vcGVuICMgU2luY2UgJ29wZW4nIGlzIFRhckZpbGUub3BlbgoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIHRhciBjb25zdGFudHMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpOVUwgPSBiIlwwIiAgICAgICAgICAgICAgICAgICAgICMgdGhlIG51bGwgY2hhcmFjdGVyCkJMT0NLU0laRSA9IDUxMiAgICAgICAgICAgICAgICAgIyBsZW5ndGggb2YgcHJvY2Vzc2luZyBibG9ja3MKUkVDT1JEU0laRSA9IEJMT0NLU0laRSAqIDIwICAgICAjIGxlbmd0aCBvZiByZWNvcmRzCkdOVV9NQUdJQyA9IGIidXN0YXIgIFwwIiAgICAgICAgIyBtYWdpYyBnbnUgdGFyIHN0cmluZwpQT1NJWF9NQUdJQyA9IGIidXN0YXJceDAwMDAiICAgICMgbWFnaWMgcG9zaXggdGFyIHN0cmluZwoKTEVOR1RIX05BTUUgPSAxMDAgICAgICAgICAgICAgICAjIG1heGltdW0gbGVuZ3RoIG9mIGEgZmlsZW5hbWUKTEVOR1RIX0xJTksgPSAxMDAgICAgICAgICAgICAgICAjIG1heGltdW0gbGVuZ3RoIG9mIGEgbGlua25hbWUKTEVOR1RIX1BSRUZJWCA9IDE1NSAgICAgICAgICAgICAjIG1heGltdW0gbGVuZ3RoIG9mIHRoZSBwcmVmaXggZmllbGQKClJFR1RZUEUgPSBiIjAiICAgICAgICAgICAgICAgICAgIyByZWd1bGFyIGZpbGUKQVJFR1RZUEUgPSBiIlwwIiAgICAgICAgICAgICAgICAjIHJlZ3VsYXIgZmlsZQpMTktUWVBFID0gYiIxIiAgICAgICAgICAgICAgICAgICMgbGluayAoaW5zaWRlIHRhcmZpbGUpClNZTVRZUEUgPSBiIjIiICAgICAgICAgICAgICAgICAgIyBzeW1ib2xpYyBsaW5rCkNIUlRZUEUgPSBiIjMiICAgICAgICAgICAgICAgICAgIyBjaGFyYWN0ZXIgc3BlY2lhbCBkZXZpY2UKQkxLVFlQRSA9IGIiNCIgICAgICAgICAgICAgICAgICAjIGJsb2NrIHNwZWNpYWwgZGV2aWNlCkRJUlRZUEUgPSBiIjUiICAgICAgICAgICAgICAgICAgIyBkaXJlY3RvcnkKRklGT1RZUEUgPSBiIjYiICAgICAgICAgICAgICAgICAjIGZpZm8gc3BlY2lhbCBkZXZpY2UKQ09OVFRZUEUgPSBiIjciICAgICAgICAgICAgICAgICAjIGNvbnRpZ3VvdXMgZmlsZQoKR05VVFlQRV9MT05HTkFNRSA9IGIiTCIgICAgICAgICAjIEdOVSB0YXIgbG9uZ25hbWUKR05VVFlQRV9MT05HTElOSyA9IGIiSyIgICAgICAgICAjIEdOVSB0YXIgbG9uZ2xpbmsKR05VVFlQRV9TUEFSU0UgPSBiIlMiICAgICAgICAgICAjIEdOVSB0YXIgc3BhcnNlIGZpbGUKClhIRFRZUEUgPSBiIngiICAgICAgICAgICAgICAgICAgIyBQT1NJWC4xLTIwMDEgZXh0ZW5kZWQgaGVhZGVyClhHTFRZUEUgPSBiImciICAgICAgICAgICAgICAgICAgIyBQT1NJWC4xLTIwMDEgZ2xvYmFsIGhlYWRlcgpTT0xBUklTX1hIRFRZUEUgPSBiIlgiICAgICAgICAgICMgU29sYXJpcyBleHRlbmRlZCBoZWFkZXIKClVTVEFSX0ZPUk1BVCA9IDAgICAgICAgICAgICAgICAgIyBQT1NJWC4xLTE5ODggKHVzdGFyKSBmb3JtYXQKR05VX0ZPUk1BVCA9IDEgICAgICAgICAgICAgICAgICAjIEdOVSB0YXIgZm9ybWF0ClBBWF9GT1JNQVQgPSAyICAgICAgICAgICAgICAgICAgIyBQT1NJWC4xLTIwMDEgKHBheCkgZm9ybWF0CkRFRkFVTFRfRk9STUFUID0gR05VX0ZPUk1BVAoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIHRhcmZpbGUgY29uc3RhbnRzCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBGaWxlIHR5cGVzIHRoYXQgdGFyZmlsZSBzdXBwb3J0czoKU1VQUE9SVEVEX1RZUEVTID0gKFJFR1RZUEUsIEFSRUdUWVBFLCBMTktUWVBFLAogICAgICAgICAgICAgICAgICAgU1lNVFlQRSwgRElSVFlQRSwgRklGT1RZUEUsCiAgICAgICAgICAgICAgICAgICBDT05UVFlQRSwgQ0hSVFlQRSwgQkxLVFlQRSwKICAgICAgICAgICAgICAgICAgIEdOVVRZUEVfTE9OR05BTUUsIEdOVVRZUEVfTE9OR0xJTkssCiAgICAgICAgICAgICAgICAgICBHTlVUWVBFX1NQQVJTRSkKCiMgRmlsZSB0eXBlcyB0aGF0IHdpbGwgYmUgdHJlYXRlZCBhcyBhIHJlZ3VsYXIgZmlsZS4KUkVHVUxBUl9UWVBFUyA9IChSRUdUWVBFLCBBUkVHVFlQRSwKICAgICAgICAgICAgICAgICBDT05UVFlQRSwgR05VVFlQRV9TUEFSU0UpCgojIEZpbGUgdHlwZXMgdGhhdCBhcmUgcGFydCBvZiB0aGUgR05VIHRhciBmb3JtYXQuCkdOVV9UWVBFUyA9IChHTlVUWVBFX0xPTkdOQU1FLCBHTlVUWVBFX0xPTkdMSU5LLAogICAgICAgICAgICAgR05VVFlQRV9TUEFSU0UpCgojIEZpZWxkcyBmcm9tIGEgcGF4IGhlYWRlciB0aGF0IG92ZXJyaWRlIGEgVGFySW5mbyBhdHRyaWJ1dGUuClBBWF9GSUVMRFMgPSAoInBhdGgiLCAibGlua3BhdGgiLCAic2l6ZSIsICJtdGltZSIsCiAgICAgICAgICAgICAgInVpZCIsICJnaWQiLCAidW5hbWUiLCAiZ25hbWUiKQoKIyBGaWVsZHMgZnJvbSBhIHBheCBoZWFkZXIgdGhhdCBhcmUgYWZmZWN0ZWQgYnkgaGRyY2hhcnNldC4KUEFYX05BTUVfRklFTERTID0geyJwYXRoIiwgImxpbmtwYXRoIiwgInVuYW1lIiwgImduYW1lIn0KCiMgRmllbGRzIGluIGEgcGF4IGhlYWRlciB0aGF0IGFyZSBudW1iZXJzLCBhbGwgb3RoZXIgZmllbGRzCiMgYXJlIHRyZWF0ZWQgYXMgc3RyaW5ncy4KUEFYX05VTUJFUl9GSUVMRFMgPSB7CiAgICAiYXRpbWUiOiBmbG9hdCwKICAgICJjdGltZSI6IGZsb2F0LAogICAgIm10aW1lIjogZmxvYXQsCiAgICAidWlkIjogaW50LAogICAgImdpZCI6IGludCwKICAgICJzaXplIjogaW50Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBCaXRzIHVzZWQgaW4gdGhlIG1vZGUgZmllbGQsIHZhbHVlcyBpbiBvY3RhbC4KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpTX0lGTE5LID0gMG8xMjAwMDAgICAgICAgICMgc3ltYm9saWMgbGluawpTX0lGUkVHID0gMG8xMDAwMDAgICAgICAgICMgcmVndWxhciBmaWxlClNfSUZCTEsgPSAwbzA2MDAwMCAgICAgICAgIyBibG9jayBkZXZpY2UKU19JRkRJUiA9IDBvMDQwMDAwICAgICAgICAjIGRpcmVjdG9yeQpTX0lGQ0hSID0gMG8wMjAwMDAgICAgICAgICMgY2hhcmFjdGVyIGRldmljZQpTX0lGSUZPID0gMG8wMTAwMDAgICAgICAgICMgZmlmbwoKVFNVSUQgICA9IDBvNDAwMCAgICAgICAgICAjIHNldCBVSUQgb24gZXhlY3V0aW9uClRTR0lEICAgPSAwbzIwMDAgICAgICAgICAgIyBzZXQgR0lEIG9uIGV4ZWN1dGlvbgpUU1ZUWCAgID0gMG8xMDAwICAgICAgICAgICMgcmVzZXJ2ZWQKClRVUkVBRCAgPSAwbzQwMCAgICAgICAgICAgIyByZWFkIGJ5IG93bmVyClRVV1JJVEUgPSAwbzIwMCAgICAgICAgICAgIyB3cml0ZSBieSBvd25lcgpUVUVYRUMgID0gMG8xMDAgICAgICAgICAgICMgZXhlY3V0ZS9zZWFyY2ggYnkgb3duZXIKVEdSRUFEICA9IDBvMDQwICAgICAgICAgICAjIHJlYWQgYnkgZ3JvdXAKVEdXUklURSA9IDBvMDIwICAgICAgICAgICAjIHdyaXRlIGJ5IGdyb3VwClRHRVhFQyAgPSAwbzAxMCAgICAgICAgICAgIyBleGVjdXRlL3NlYXJjaCBieSBncm91cApUT1JFQUQgID0gMG8wMDQgICAgICAgICAgICMgcmVhZCBieSBvdGhlcgpUT1dSSVRFID0gMG8wMDIgICAgICAgICAgICMgd3JpdGUgYnkgb3RoZXIKVE9FWEVDICA9IDBvMDAxICAgICAgICAgICAjIGV4ZWN1dGUvc2VhcmNoIGJ5IG90aGVyCgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgaW5pdGlhbGl6YXRpb24KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQppZiBvcy5uYW1lIGluICgibnQiLCAiY2UiKToKICAgIEVOQ09ESU5HID0gInV0Zi04IgplbHNlOgogICAgRU5DT0RJTkcgPSBzeXMuZ2V0ZmlsZXN5c3RlbWVuY29kaW5nKCkKCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBTb21lIHVzZWZ1bCBmdW5jdGlvbnMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKZGVmIHN0bihzLCBsZW5ndGgsIGVuY29kaW5nLCBlcnJvcnMpOgogICAgIiIiQ29udmVydCBhIHN0cmluZyB0byBhIG51bGwtdGVybWluYXRlZCBieXRlcyBvYmplY3QuCiAgICAiIiIKICAgIHMgPSBzLmVuY29kZShlbmNvZGluZywgZXJyb3JzKQogICAgcmV0dXJuIHNbOmxlbmd0aF0gKyAobGVuZ3RoIC0gbGVuKHMpKSAqIE5VTAoKZGVmIG50cyhzLCBlbmNvZGluZywgZXJyb3JzKToKICAgICIiIkNvbnZlcnQgYSBudWxsLXRlcm1pbmF0ZWQgYnl0ZXMgb2JqZWN0IHRvIGEgc3RyaW5nLgogICAgIiIiCiAgICBwID0gcy5maW5kKGIiXDAiKQogICAgaWYgcCAhPSAtMToKICAgICAgICBzID0gc1s6cF0KICAgIHJldHVybiBzLmRlY29kZShlbmNvZGluZywgZXJyb3JzKQoKZGVmIG50aShzKToKICAgICIiIkNvbnZlcnQgYSBudW1iZXIgZmllbGQgdG8gYSBweXRob24gbnVtYmVyLgogICAgIiIiCiAgICAjIFRoZXJlIGFyZSB0d28gcG9zc2libGUgZW5jb2RpbmdzIGZvciBhIG51bWJlciBmaWVsZCwgc2VlCiAgICAjIGl0bigpIGJlbG93LgogICAgaWYgc1swXSBpbiAoMG8yMDAsIDBvMzc3KToKICAgICAgICBuID0gMAogICAgICAgIGZvciBpIGluIHJhbmdlKGxlbihzKSAtIDEpOgogICAgICAgICAgICBuIDw8PSA4CiAgICAgICAgICAgIG4gKz0gc1tpICsgMV0KICAgICAgICBpZiBzWzBdID09IDBvMzc3OgogICAgICAgICAgICBuID0gLSgyNTYgKiogKGxlbihzKSAtIDEpIC0gbikKICAgIGVsc2U6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBuID0gaW50KG50cyhzLCAiYXNjaWkiLCAic3RyaWN0Iikgb3IgIjAiLCA4KQogICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICByYWlzZSBJbnZhbGlkSGVhZGVyRXJyb3IoImludmFsaWQgaGVhZGVyIikKICAgIHJldHVybiBuCgpkZWYgaXRuKG4sIGRpZ2l0cz04LCBmb3JtYXQ9REVGQVVMVF9GT1JNQVQpOgogICAgIiIiQ29udmVydCBhIHB5dGhvbiBudW1iZXIgdG8gYSBudW1iZXIgZmllbGQuCiAgICAiIiIKICAgICMgUE9TSVggMTAwMy4xLTE5ODggcmVxdWlyZXMgbnVtYmVycyB0byBiZSBlbmNvZGVkIGFzIGEgc3RyaW5nIG9mCiAgICAjIG9jdGFsIGRpZ2l0cyBmb2xsb3dlZCBieSBhIG51bGwtYnl0ZSwgdGhpcyBhbGxvd3MgdmFsdWVzIHVwIHRvCiAgICAjICg4KiooZGlnaXRzLTEpKS0xLiBHTlUgdGFyIGFsbG93cyBzdG9yaW5nIG51bWJlcnMgZ3JlYXRlciB0aGFuCiAgICAjIHRoYXQgaWYgbmVjZXNzYXJ5LiBBIGxlYWRpbmcgMG8yMDAgb3IgMG8zNzcgYnl0ZSBpbmRpY2F0ZSB0aGlzCiAgICAjIHBhcnRpY3VsYXIgZW5jb2RpbmcsIHRoZSBmb2xsb3dpbmcgZGlnaXRzLTEgYnl0ZXMgYXJlIGEgYmlnLWVuZGlhbgogICAgIyBiYXNlLTI1NiByZXByZXNlbnRhdGlvbi4gVGhpcyBhbGxvd3MgdmFsdWVzIHVwIHRvICgyNTYqKihkaWdpdHMtMSkpLTEuCiAgICAjIEEgMG8yMDAgYnl0ZSBpbmRpY2F0ZXMgYSBwb3NpdGl2ZSBudW1iZXIsIGEgMG8zNzcgYnl0ZSBhIG5lZ2F0aXZlCiAgICAjIG51bWJlci4KICAgIGlmIDAgPD0gbiA8IDggKiogKGRpZ2l0cyAtIDEpOgogICAgICAgIHMgPSBieXRlcygiJTAqbyIgJSAoZGlnaXRzIC0gMSwgbiksICJhc2NpaSIpICsgTlVMCiAgICBlbGlmIGZvcm1hdCA9PSBHTlVfRk9STUFUIGFuZCAtMjU2ICoqIChkaWdpdHMgLSAxKSA8PSBuIDwgMjU2ICoqIChkaWdpdHMgLSAxKToKICAgICAgICBpZiBuID49IDA6CiAgICAgICAgICAgIHMgPSBieXRlYXJyYXkoWzBvMjAwXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzID0gYnl0ZWFycmF5KFswbzM3N10pCiAgICAgICAgICAgIG4gPSAyNTYgKiogZGlnaXRzICsgbgoKICAgICAgICBmb3IgaSBpbiByYW5nZShkaWdpdHMgLSAxKToKICAgICAgICAgICAgcy5pbnNlcnQoMSwgbiAmIDBvMzc3KQogICAgICAgICAgICBuID4+PSA4CiAgICBlbHNlOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIm92ZXJmbG93IGluIG51bWJlciBmaWVsZCIpCgogICAgcmV0dXJuIHMKCmRlZiBjYWxjX2Noa3N1bXMoYnVmKToKICAgICIiIkNhbGN1bGF0ZSB0aGUgY2hlY2tzdW0gZm9yIGEgbWVtYmVyJ3MgaGVhZGVyIGJ5IHN1bW1pbmcgdXAgYWxsCiAgICAgICBjaGFyYWN0ZXJzIGV4Y2VwdCBmb3IgdGhlIGNoa3N1bSBmaWVsZCB3aGljaCBpcyB0cmVhdGVkIGFzIGlmCiAgICAgICBpdCB3YXMgZmlsbGVkIHdpdGggc3BhY2VzLiBBY2NvcmRpbmcgdG8gdGhlIEdOVSB0YXIgc291cmNlcywKICAgICAgIHNvbWUgdGFycyAoU3VuIGFuZCBOZVhUKSBjYWxjdWxhdGUgY2hrc3VtIHdpdGggc2lnbmVkIGNoYXIsCiAgICAgICB3aGljaCB3aWxsIGJlIGRpZmZlcmVudCBpZiB0aGVyZSBhcmUgY2hhcnMgaW4gdGhlIGJ1ZmZlciB3aXRoCiAgICAgICB0aGUgaGlnaCBiaXQgc2V0LiBTbyB3ZSBjYWxjdWxhdGUgdHdvIGNoZWNrc3VtcywgdW5zaWduZWQgYW5kCiAgICAgICBzaWduZWQuCiAgICAiIiIKICAgIHVuc2lnbmVkX2Noa3N1bSA9IDI1NiArIHN1bShzdHJ1Y3QudW5wYWNrX2Zyb20oIjE0OEI4eDM1NkIiLCBidWYpKQogICAgc2lnbmVkX2Noa3N1bSA9IDI1NiArIHN1bShzdHJ1Y3QudW5wYWNrX2Zyb20oIjE0OGI4eDM1NmIiLCBidWYpKQogICAgcmV0dXJuIHVuc2lnbmVkX2Noa3N1bSwgc2lnbmVkX2Noa3N1bQoKZGVmIGNvcHlmaWxlb2JqKHNyYywgZHN0LCBsZW5ndGg9Tm9uZSk6CiAgICAiIiJDb3B5IGxlbmd0aCBieXRlcyBmcm9tIGZpbGVvYmogc3JjIHRvIGZpbGVvYmogZHN0LgogICAgICAgSWYgbGVuZ3RoIGlzIE5vbmUsIGNvcHkgdGhlIGVudGlyZSBjb250ZW50LgogICAgIiIiCiAgICBpZiBsZW5ndGggPT0gMDoKICAgICAgICByZXR1cm4KICAgIGlmIGxlbmd0aCBpcyBOb25lOgogICAgICAgIHNodXRpbC5jb3B5ZmlsZW9iaihzcmMsIGRzdCkKICAgICAgICByZXR1cm4KCiAgICBCVUZTSVpFID0gMTYgKiAxMDI0CiAgICBibG9ja3MsIHJlbWFpbmRlciA9IGRpdm1vZChsZW5ndGgsIEJVRlNJWkUpCiAgICBmb3IgYiBpbiByYW5nZShibG9ja3MpOgogICAgICAgIGJ1ZiA9IHNyYy5yZWFkKEJVRlNJWkUpCiAgICAgICAgaWYgbGVuKGJ1ZikgPCBCVUZTSVpFOgogICAgICAgICAgICByYWlzZSBJT0Vycm9yKCJlbmQgb2YgZmlsZSByZWFjaGVkIikKICAgICAgICBkc3Qud3JpdGUoYnVmKQoKICAgIGlmIHJlbWFpbmRlciAhPSAwOgogICAgICAgIGJ1ZiA9IHNyYy5yZWFkKHJlbWFpbmRlcikKICAgICAgICBpZiBsZW4oYnVmKSA8IHJlbWFpbmRlcjoKICAgICAgICAgICAgcmFpc2UgSU9FcnJvcigiZW5kIG9mIGZpbGUgcmVhY2hlZCIpCiAgICAgICAgZHN0LndyaXRlKGJ1ZikKICAgIHJldHVybgoKZGVmIGZpbGVtb2RlKG1vZGUpOgogICAgIiIiRGVwcmVjYXRlZCBpbiB0aGlzIGxvY2F0aW9uOyB1c2Ugc3RhdC5maWxlbW9kZS4iIiIKICAgIGltcG9ydCB3YXJuaW5ncwogICAgd2FybmluZ3Mud2FybigiZGVwcmVjYXRlZCBpbiBmYXZvciBvZiBzdGF0LmZpbGVtb2RlIiwKICAgICAgICAgICAgICAgICAgRGVwcmVjYXRpb25XYXJuaW5nLCAyKQogICAgcmV0dXJuIHN0YXQuZmlsZW1vZGUobW9kZSkKCgpjbGFzcyBUYXJFcnJvcihFeGNlcHRpb24pOgogICAgIiIiQmFzZSBleGNlcHRpb24uIiIiCiAgICBwYXNzCmNsYXNzIEV4dHJhY3RFcnJvcihUYXJFcnJvcik6CiAgICAiIiJHZW5lcmFsIGV4Y2VwdGlvbiBmb3IgZXh0cmFjdCBlcnJvcnMuIiIiCiAgICBwYXNzCmNsYXNzIFJlYWRFcnJvcihUYXJFcnJvcik6CiAgICAiIiJFeGNlcHRpb24gZm9yIHVucmVhZGJsZSB0YXIgYXJjaGl2ZXMuIiIiCiAgICBwYXNzCmNsYXNzIENvbXByZXNzaW9uRXJyb3IoVGFyRXJyb3IpOgogICAgIiIiRXhjZXB0aW9uIGZvciB1bmF2YWlsYWJsZSBjb21wcmVzc2lvbiBtZXRob2RzLiIiIgogICAgcGFzcwpjbGFzcyBTdHJlYW1FcnJvcihUYXJFcnJvcik6CiAgICAiIiJFeGNlcHRpb24gZm9yIHVuc3VwcG9ydGVkIG9wZXJhdGlvbnMgb24gc3RyZWFtLWxpa2UgVGFyRmlsZXMuIiIiCiAgICBwYXNzCmNsYXNzIEhlYWRlckVycm9yKFRhckVycm9yKToKICAgICIiIkJhc2UgZXhjZXB0aW9uIGZvciBoZWFkZXIgZXJyb3JzLiIiIgogICAgcGFzcwpjbGFzcyBFbXB0eUhlYWRlckVycm9yKEhlYWRlckVycm9yKToKICAgICIiIkV4Y2VwdGlvbiBmb3IgZW1wdHkgaGVhZGVycy4iIiIKICAgIHBhc3MKY2xhc3MgVHJ1bmNhdGVkSGVhZGVyRXJyb3IoSGVhZGVyRXJyb3IpOgogICAgIiIiRXhjZXB0aW9uIGZvciB0cnVuY2F0ZWQgaGVhZGVycy4iIiIKICAgIHBhc3MKY2xhc3MgRU9GSGVhZGVyRXJyb3IoSGVhZGVyRXJyb3IpOgogICAgIiIiRXhjZXB0aW9uIGZvciBlbmQgb2YgZmlsZSBoZWFkZXJzLiIiIgogICAgcGFzcwpjbGFzcyBJbnZhbGlkSGVhZGVyRXJyb3IoSGVhZGVyRXJyb3IpOgogICAgIiIiRXhjZXB0aW9uIGZvciBpbnZhbGlkIGhlYWRlcnMuIiIiCiAgICBwYXNzCmNsYXNzIFN1YnNlcXVlbnRIZWFkZXJFcnJvcihIZWFkZXJFcnJvcik6CiAgICAiIiJFeGNlcHRpb24gZm9yIG1pc3NpbmcgYW5kIGludmFsaWQgZXh0ZW5kZWQgaGVhZGVycy4iIiIKICAgIHBhc3MKCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBpbnRlcm5hbCBzdHJlYW0gaW50ZXJmYWNlCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KY2xhc3MgX0xvd0xldmVsRmlsZToKICAgICIiIkxvdy1sZXZlbCBmaWxlIG9iamVjdC4gU3VwcG9ydHMgcmVhZGluZyBhbmQgd3JpdGluZy4KICAgICAgIEl0IGlzIHVzZWQgaW5zdGVhZCBvZiBhIHJlZ3VsYXIgZmlsZSBvYmplY3QgZm9yIHN0cmVhbWluZwogICAgICAgYWNjZXNzLgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG5hbWUsIG1vZGUpOgogICAgICAgIG1vZGUgPSB7CiAgICAgICAgICAgICJyIjogb3MuT19SRE9OTFksCiAgICAgICAgICAgICJ3Ijogb3MuT19XUk9OTFkgfCBvcy5PX0NSRUFUIHwgb3MuT19UUlVOQywKICAgICAgICB9W21vZGVdCiAgICAgICAgaWYgaGFzYXR0cihvcywgIk9fQklOQVJZIik6CiAgICAgICAgICAgIG1vZGUgfD0gb3MuT19CSU5BUlkKICAgICAgICBzZWxmLmZkID0gb3Mub3BlbihuYW1lLCBtb2RlLCAwbzY2NikKCiAgICBkZWYgY2xvc2Uoc2VsZik6CiAgICAgICAgb3MuY2xvc2Uoc2VsZi5mZCkKCiAgICBkZWYgcmVhZChzZWxmLCBzaXplKToKICAgICAgICByZXR1cm4gb3MucmVhZChzZWxmLmZkLCBzaXplKQoKICAgIGRlZiB3cml0ZShzZWxmLCBzKToKICAgICAgICBvcy53cml0ZShzZWxmLmZkLCBzKQoKY2xhc3MgX1N0cmVhbToKICAgICIiIkNsYXNzIHRoYXQgc2VydmVzIGFzIGFuIGFkYXB0ZXIgYmV0d2VlbiBUYXJGaWxlIGFuZAogICAgICAgYSBzdHJlYW0tbGlrZSBvYmplY3QuICBUaGUgc3RyZWFtLWxpa2Ugb2JqZWN0IG9ubHkKICAgICAgIG5lZWRzIHRvIGhhdmUgYSByZWFkKCkgb3Igd3JpdGUoKSBtZXRob2QgYW5kIGlzIGFjY2Vzc2VkCiAgICAgICBibG9ja3dpc2UuICBVc2Ugb2YgZ3ppcCBvciBiemlwMiBjb21wcmVzc2lvbiBpcyBwb3NzaWJsZS4KICAgICAgIEEgc3RyZWFtLWxpa2Ugb2JqZWN0IGNvdWxkIGJlIGZvciBleGFtcGxlOiBzeXMuc3RkaW4sCiAgICAgICBzeXMuc3Rkb3V0LCBhIHNvY2tldCwgYSB0YXBlIGRldmljZSBldGMuCgogICAgICAgX1N0cmVhbSBpcyBpbnRlbmRlZCB0byBiZSB1c2VkIG9ubHkgaW50ZXJuYWxseS4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBuYW1lLCBtb2RlLCBjb21wdHlwZSwgZmlsZW9iaiwgYnVmc2l6ZSk6CiAgICAgICAgIiIiQ29uc3RydWN0IGEgX1N0cmVhbSBvYmplY3QuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fZXh0ZmlsZW9iaiA9IFRydWUKICAgICAgICBpZiBmaWxlb2JqIGlzIE5vbmU6CiAgICAgICAgICAgIGZpbGVvYmogPSBfTG93TGV2ZWxGaWxlKG5hbWUsIG1vZGUpCiAgICAgICAgICAgIHNlbGYuX2V4dGZpbGVvYmogPSBGYWxzZQoKICAgICAgICBpZiBjb21wdHlwZSA9PSAnKic6CiAgICAgICAgICAgICMgRW5hYmxlIHRyYW5zcGFyZW50IGNvbXByZXNzaW9uIGRldGVjdGlvbiBmb3IgdGhlCiAgICAgICAgICAgICMgc3RyZWFtIGludGVyZmFjZQogICAgICAgICAgICBmaWxlb2JqID0gX1N0cmVhbVByb3h5KGZpbGVvYmopCiAgICAgICAgICAgIGNvbXB0eXBlID0gZmlsZW9iai5nZXRjb21wdHlwZSgpCgogICAgICAgIHNlbGYubmFtZSAgICAgPSBuYW1lIG9yICIiCiAgICAgICAgc2VsZi5tb2RlICAgICA9IG1vZGUKICAgICAgICBzZWxmLmNvbXB0eXBlID0gY29tcHR5cGUKICAgICAgICBzZWxmLmZpbGVvYmogID0gZmlsZW9iagogICAgICAgIHNlbGYuYnVmc2l6ZSAgPSBidWZzaXplCiAgICAgICAgc2VsZi5idWYgICAgICA9IGIiIgogICAgICAgIHNlbGYucG9zICAgICAgPSAwCiAgICAgICAgc2VsZi5jbG9zZWQgICA9IEZhbHNlCgogICAgICAgIHRyeToKICAgICAgICAgICAgaWYgY29tcHR5cGUgPT0gImd6IjoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBpbXBvcnQgemxpYgogICAgICAgICAgICAgICAgZXhjZXB0IEltcG9ydEVycm9yOgogICAgICAgICAgICAgICAgICAgIHJhaXNlIENvbXByZXNzaW9uRXJyb3IoInpsaWIgbW9kdWxlIGlzIG5vdCBhdmFpbGFibGUiKQogICAgICAgICAgICAgICAgc2VsZi56bGliID0gemxpYgogICAgICAgICAgICAgICAgc2VsZi5jcmMgPSB6bGliLmNyYzMyKGIiIikKICAgICAgICAgICAgICAgIGlmIG1vZGUgPT0gInIiOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX2luaXRfcmVhZF9neigpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5leGNlcHRpb24gPSB6bGliLmVycm9yCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX2luaXRfd3JpdGVfZ3ooKQoKICAgICAgICAgICAgZWxpZiBjb21wdHlwZSA9PSAiYnoyIjoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBpbXBvcnQgYnoyCiAgICAgICAgICAgICAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgQ29tcHJlc3Npb25FcnJvcigiYnoyIG1vZHVsZSBpcyBub3QgYXZhaWxhYmxlIikKICAgICAgICAgICAgICAgIGlmIG1vZGUgPT0gInIiOgogICAgICAgICAgICAgICAgICAgIHNlbGYuZGJ1ZiA9IGIiIgogICAgICAgICAgICAgICAgICAgIHNlbGYuY21wID0gYnoyLkJaMkRlY29tcHJlc3NvcigpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5leGNlcHRpb24gPSBJT0Vycm9yCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuY21wID0gYnoyLkJaMkNvbXByZXNzb3IoKQoKICAgICAgICAgICAgZWxpZiBjb21wdHlwZSA9PSAieHoiOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGltcG9ydCBsem1hCiAgICAgICAgICAgICAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgQ29tcHJlc3Npb25FcnJvcigibHptYSBtb2R1bGUgaXMgbm90IGF2YWlsYWJsZSIpCiAgICAgICAgICAgICAgICBpZiBtb2RlID09ICJyIjoKICAgICAgICAgICAgICAgICAgICBzZWxmLmRidWYgPSBiIiIKICAgICAgICAgICAgICAgICAgICBzZWxmLmNtcCA9IGx6bWEuTFpNQURlY29tcHJlc3NvcigpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5leGNlcHRpb24gPSBsem1hLkxaTUFFcnJvcgogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzZWxmLmNtcCA9IGx6bWEuTFpNQUNvbXByZXNzb3IoKQoKICAgICAgICAgICAgZWxpZiBjb21wdHlwZSAhPSAidGFyIjoKICAgICAgICAgICAgICAgIHJhaXNlIENvbXByZXNzaW9uRXJyb3IoInVua25vd24gY29tcHJlc3Npb24gdHlwZSAlciIgJSBjb21wdHlwZSkKCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBpZiBub3Qgc2VsZi5fZXh0ZmlsZW9iajoKICAgICAgICAgICAgICAgIHNlbGYuZmlsZW9iai5jbG9zZSgpCiAgICAgICAgICAgIHNlbGYuY2xvc2VkID0gVHJ1ZQogICAgICAgICAgICByYWlzZQoKICAgIGRlZiBfX2RlbF9fKHNlbGYpOgogICAgICAgIGlmIGhhc2F0dHIoc2VsZiwgImNsb3NlZCIpIGFuZCBub3Qgc2VsZi5jbG9zZWQ6CiAgICAgICAgICAgIHNlbGYuY2xvc2UoKQoKICAgIGRlZiBfaW5pdF93cml0ZV9neihzZWxmKToKICAgICAgICAiIiJJbml0aWFsaXplIGZvciB3cml0aW5nIHdpdGggZ3ppcCBjb21wcmVzc2lvbi4KICAgICAgICAiIiIKICAgICAgICBzZWxmLmNtcCA9IHNlbGYuemxpYi5jb21wcmVzc29iaig5LCBzZWxmLnpsaWIuREVGTEFURUQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLXNlbGYuemxpYi5NQVhfV0JJVFMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi56bGliLkRFRl9NRU1fTEVWRUwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCkKICAgICAgICB0aW1lc3RhbXAgPSBzdHJ1Y3QucGFjaygiPEwiLCBpbnQodGltZS50aW1lKCkpKQogICAgICAgIHNlbGYuX193cml0ZShiIlwwMzdcMjEzXDAxMFwwMTAiICsgdGltZXN0YW1wICsgYiJcMDAyXDM3NyIpCiAgICAgICAgaWYgc2VsZi5uYW1lLmVuZHN3aXRoKCIuZ3oiKToKICAgICAgICAgICAgc2VsZi5uYW1lID0gc2VsZi5uYW1lWzotM10KICAgICAgICAjIFJGQzE5NTIgc2F5cyB3ZSBtdXN0IHVzZSBJU08tODg1OS0xIGZvciB0aGUgRk5BTUUgZmllbGQuCiAgICAgICAgc2VsZi5fX3dyaXRlKHNlbGYubmFtZS5lbmNvZGUoImlzby04ODU5LTEiLCAicmVwbGFjZSIpICsgTlVMKQoKICAgIGRlZiB3cml0ZShzZWxmLCBzKToKICAgICAgICAiIiJXcml0ZSBzdHJpbmcgcyB0byB0aGUgc3RyZWFtLgogICAgICAgICIiIgogICAgICAgIGlmIHNlbGYuY29tcHR5cGUgPT0gImd6IjoKICAgICAgICAgICAgc2VsZi5jcmMgPSBzZWxmLnpsaWIuY3JjMzIocywgc2VsZi5jcmMpCiAgICAgICAgc2VsZi5wb3MgKz0gbGVuKHMpCiAgICAgICAgaWYgc2VsZi5jb21wdHlwZSAhPSAidGFyIjoKICAgICAgICAgICAgcyA9IHNlbGYuY21wLmNvbXByZXNzKHMpCiAgICAgICAgc2VsZi5fX3dyaXRlKHMpCgogICAgZGVmIF9fd3JpdGUoc2VsZiwgcyk6CiAgICAgICAgIiIiV3JpdGUgc3RyaW5nIHMgdG8gdGhlIHN0cmVhbSBpZiBhIHdob2xlIG5ldyBibG9jawogICAgICAgICAgIGlzIHJlYWR5IHRvIGJlIHdyaXR0ZW4uCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5idWYgKz0gcwogICAgICAgIHdoaWxlIGxlbihzZWxmLmJ1ZikgPiBzZWxmLmJ1ZnNpemU6CiAgICAgICAgICAgIHNlbGYuZmlsZW9iai53cml0ZShzZWxmLmJ1Zls6c2VsZi5idWZzaXplXSkKICAgICAgICAgICAgc2VsZi5idWYgPSBzZWxmLmJ1ZltzZWxmLmJ1ZnNpemU6XQoKICAgIGRlZiBjbG9zZShzZWxmKToKICAgICAgICAiIiJDbG9zZSB0aGUgX1N0cmVhbSBvYmplY3QuIE5vIG9wZXJhdGlvbiBzaG91bGQgYmUKICAgICAgICAgICBkb25lIG9uIGl0IGFmdGVyd2FyZHMuCiAgICAgICAgIiIiCiAgICAgICAgaWYgc2VsZi5jbG9zZWQ6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBzZWxmLm1vZGUgPT0gInciIGFuZCBzZWxmLmNvbXB0eXBlICE9ICJ0YXIiOgogICAgICAgICAgICBzZWxmLmJ1ZiArPSBzZWxmLmNtcC5mbHVzaCgpCgogICAgICAgIGlmIHNlbGYubW9kZSA9PSAidyIgYW5kIHNlbGYuYnVmOgogICAgICAgICAgICBzZWxmLmZpbGVvYmoud3JpdGUoc2VsZi5idWYpCiAgICAgICAgICAgIHNlbGYuYnVmID0gYiIiCiAgICAgICAgICAgIGlmIHNlbGYuY29tcHR5cGUgPT0gImd6IjoKICAgICAgICAgICAgICAgICMgVGhlIG5hdGl2ZSB6bGliIGNyYyBpcyBhbiB1bnNpZ25lZCAzMi1iaXQgaW50ZWdlciwgYnV0CiAgICAgICAgICAgICAgICAjIHRoZSBQeXRob24gd3JhcHBlciBpbXBsaWNpdGx5IGNhc3RzIHRoYXQgdG8gYSBzaWduZWQgQwogICAgICAgICAgICAgICAgIyBsb25nLiAgU28sIG9uIGEgMzItYml0IGJveCBzZWxmLmNyYyBtYXkgImxvb2sgbmVnYXRpdmUiLAogICAgICAgICAgICAgICAgIyB3aGlsZSB0aGUgc2FtZSBjcmMgb24gYSA2NC1iaXQgYm94IG1heSAibG9vayBwb3NpdGl2ZSIuCiAgICAgICAgICAgICAgICAjIFRvIGF2b2lkIGlya3NvbWUgd2FybmluZ3MgZnJvbSB0aGUgYHN0cnVjdGAgbW9kdWxlLCBmb3JjZQogICAgICAgICAgICAgICAgIyBpdCB0byBsb29rIHBvc2l0aXZlIG9uIGFsbCBib3hlcy4KICAgICAgICAgICAgICAgIHNlbGYuZmlsZW9iai53cml0ZShzdHJ1Y3QucGFjaygiPEwiLCBzZWxmLmNyYyAmIDB4ZmZmZmZmZmYpKQogICAgICAgICAgICAgICAgc2VsZi5maWxlb2JqLndyaXRlKHN0cnVjdC5wYWNrKCI8TCIsIHNlbGYucG9zICYgMHhmZmZmRkZGRikpCgogICAgICAgIGlmIG5vdCBzZWxmLl9leHRmaWxlb2JqOgogICAgICAgICAgICBzZWxmLmZpbGVvYmouY2xvc2UoKQoKICAgICAgICBzZWxmLmNsb3NlZCA9IFRydWUKCiAgICBkZWYgX2luaXRfcmVhZF9neihzZWxmKToKICAgICAgICAiIiJJbml0aWFsaXplIGZvciByZWFkaW5nIGEgZ3ppcCBjb21wcmVzc2VkIGZpbGVvYmouCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5jbXAgPSBzZWxmLnpsaWIuZGVjb21wcmVzc29iaigtc2VsZi56bGliLk1BWF9XQklUUykKICAgICAgICBzZWxmLmRidWYgPSBiIiIKCiAgICAgICAgIyB0YWtlbiBmcm9tIGd6aXAuR3ppcEZpbGUgd2l0aCBzb21lIGFsdGVyYXRpb25zCiAgICAgICAgaWYgc2VsZi5fX3JlYWQoMikgIT0gYiJcMDM3XDIxMyI6CiAgICAgICAgICAgIHJhaXNlIFJlYWRFcnJvcigibm90IGEgZ3ppcCBmaWxlIikKICAgICAgICBpZiBzZWxmLl9fcmVhZCgxKSAhPSBiIlwwMTAiOgogICAgICAgICAgICByYWlzZSBDb21wcmVzc2lvbkVycm9yKCJ1bnN1cHBvcnRlZCBjb21wcmVzc2lvbiBtZXRob2QiKQoKICAgICAgICBmbGFnID0gb3JkKHNlbGYuX19yZWFkKDEpKQogICAgICAgIHNlbGYuX19yZWFkKDYpCgogICAgICAgIGlmIGZsYWcgJiA0OgogICAgICAgICAgICB4bGVuID0gb3JkKHNlbGYuX19yZWFkKDEpKSArIDI1NiAqIG9yZChzZWxmLl9fcmVhZCgxKSkKICAgICAgICAgICAgc2VsZi5yZWFkKHhsZW4pCiAgICAgICAgaWYgZmxhZyAmIDg6CiAgICAgICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgICAgICBzID0gc2VsZi5fX3JlYWQoMSkKICAgICAgICAgICAgICAgIGlmIG5vdCBzIG9yIHMgPT0gTlVMOgogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgaWYgZmxhZyAmIDE2OgogICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgcyA9IHNlbGYuX19yZWFkKDEpCiAgICAgICAgICAgICAgICBpZiBub3QgcyBvciBzID09IE5VTDoKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgIGlmIGZsYWcgJiAyOgogICAgICAgICAgICBzZWxmLl9fcmVhZCgyKQoKICAgIGRlZiB0ZWxsKHNlbGYpOgogICAgICAgICIiIlJldHVybiB0aGUgc3RyZWFtJ3MgZmlsZSBwb2ludGVyIHBvc2l0aW9uLgogICAgICAgICIiIgogICAgICAgIHJldHVybiBzZWxmLnBvcwoKICAgIGRlZiBzZWVrKHNlbGYsIHBvcz0wKToKICAgICAgICAiIiJTZXQgdGhlIHN0cmVhbSdzIGZpbGUgcG9pbnRlciB0byBwb3MuIE5lZ2F0aXZlIHNlZWtpbmcKICAgICAgICAgICBpcyBmb3JiaWRkZW4uCiAgICAgICAgIiIiCiAgICAgICAgaWYgcG9zIC0gc2VsZi5wb3MgPj0gMDoKICAgICAgICAgICAgYmxvY2tzLCByZW1haW5kZXIgPSBkaXZtb2QocG9zIC0gc2VsZi5wb3MsIHNlbGYuYnVmc2l6ZSkKICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2UoYmxvY2tzKToKICAgICAgICAgICAgICAgIHNlbGYucmVhZChzZWxmLmJ1ZnNpemUpCiAgICAgICAgICAgIHNlbGYucmVhZChyZW1haW5kZXIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgU3RyZWFtRXJyb3IoInNlZWtpbmcgYmFja3dhcmRzIGlzIG5vdCBhbGxvd2VkIikKICAgICAgICByZXR1cm4gc2VsZi5wb3MKCiAgICBkZWYgcmVhZChzZWxmLCBzaXplPU5vbmUpOgogICAgICAgICIiIlJldHVybiB0aGUgbmV4dCBzaXplIG51bWJlciBvZiBieXRlcyBmcm9tIHRoZSBzdHJlYW0uCiAgICAgICAgICAgSWYgc2l6ZSBpcyBub3QgZGVmaW5lZCwgcmV0dXJuIGFsbCBieXRlcyBvZiB0aGUgc3RyZWFtCiAgICAgICAgICAgdXAgdG8gRU9GLgogICAgICAgICIiIgogICAgICAgIGlmIHNpemUgaXMgTm9uZToKICAgICAgICAgICAgdCA9IFtdCiAgICAgICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgICAgICBidWYgPSBzZWxmLl9yZWFkKHNlbGYuYnVmc2l6ZSkKICAgICAgICAgICAgICAgIGlmIG5vdCBidWY6CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIHQuYXBwZW5kKGJ1ZikKICAgICAgICAgICAgYnVmID0gIiIuam9pbih0KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGJ1ZiA9IHNlbGYuX3JlYWQoc2l6ZSkKICAgICAgICBzZWxmLnBvcyArPSBsZW4oYnVmKQogICAgICAgIHJldHVybiBidWYKCiAgICBkZWYgX3JlYWQoc2VsZiwgc2l6ZSk6CiAgICAgICAgIiIiUmV0dXJuIHNpemUgYnl0ZXMgZnJvbSB0aGUgc3RyZWFtLgogICAgICAgICIiIgogICAgICAgIGlmIHNlbGYuY29tcHR5cGUgPT0gInRhciI6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9fcmVhZChzaXplKQoKICAgICAgICBjID0gbGVuKHNlbGYuZGJ1ZikKICAgICAgICB3aGlsZSBjIDwgc2l6ZToKICAgICAgICAgICAgYnVmID0gc2VsZi5fX3JlYWQoc2VsZi5idWZzaXplKQogICAgICAgICAgICBpZiBub3QgYnVmOgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgYnVmID0gc2VsZi5jbXAuZGVjb21wcmVzcyhidWYpCiAgICAgICAgICAgIGV4Y2VwdCBzZWxmLmV4Y2VwdGlvbjoKICAgICAgICAgICAgICAgIHJhaXNlIFJlYWRFcnJvcigiaW52YWxpZCBjb21wcmVzc2VkIGRhdGEiKQogICAgICAgICAgICBzZWxmLmRidWYgKz0gYnVmCiAgICAgICAgICAgIGMgKz0gbGVuKGJ1ZikKICAgICAgICBidWYgPSBzZWxmLmRidWZbOnNpemVdCiAgICAgICAgc2VsZi5kYnVmID0gc2VsZi5kYnVmW3NpemU6XQogICAgICAgIHJldHVybiBidWYKCiAgICBkZWYgX19yZWFkKHNlbGYsIHNpemUpOgogICAgICAgICIiIlJldHVybiBzaXplIGJ5dGVzIGZyb20gc3RyZWFtLiBJZiBpbnRlcm5hbCBidWZmZXIgaXMgZW1wdHksCiAgICAgICAgICAgcmVhZCBhbm90aGVyIGJsb2NrIGZyb20gdGhlIHN0cmVhbS4KICAgICAgICAiIiIKICAgICAgICBjID0gbGVuKHNlbGYuYnVmKQogICAgICAgIHdoaWxlIGMgPCBzaXplOgogICAgICAgICAgICBidWYgPSBzZWxmLmZpbGVvYmoucmVhZChzZWxmLmJ1ZnNpemUpCiAgICAgICAgICAgIGlmIG5vdCBidWY6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBzZWxmLmJ1ZiArPSBidWYKICAgICAgICAgICAgYyArPSBsZW4oYnVmKQogICAgICAgIGJ1ZiA9IHNlbGYuYnVmWzpzaXplXQogICAgICAgIHNlbGYuYnVmID0gc2VsZi5idWZbc2l6ZTpdCiAgICAgICAgcmV0dXJuIGJ1ZgojIGNsYXNzIF9TdHJlYW0KCmNsYXNzIF9TdHJlYW1Qcm94eShvYmplY3QpOgogICAgIiIiU21hbGwgcHJveHkgY2xhc3MgdGhhdCBlbmFibGVzIHRyYW5zcGFyZW50IGNvbXByZXNzaW9uCiAgICAgICBkZXRlY3Rpb24gZm9yIHRoZSBTdHJlYW0gaW50ZXJmYWNlIChtb2RlICdyfConKS4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBmaWxlb2JqKToKICAgICAgICBzZWxmLmZpbGVvYmogPSBmaWxlb2JqCiAgICAgICAgc2VsZi5idWYgPSBzZWxmLmZpbGVvYmoucmVhZChCTE9DS1NJWkUpCgogICAgZGVmIHJlYWQoc2VsZiwgc2l6ZSk6CiAgICAgICAgc2VsZi5yZWFkID0gc2VsZi5maWxlb2JqLnJlYWQKICAgICAgICByZXR1cm4gc2VsZi5idWYKCiAgICBkZWYgZ2V0Y29tcHR5cGUoc2VsZik6CiAgICAgICAgaWYgc2VsZi5idWYuc3RhcnRzd2l0aChiIlx4MWZceDhiXHgwOCIpOgogICAgICAgICAgICByZXR1cm4gImd6IgogICAgICAgIGVsaWYgc2VsZi5idWZbMDozXSA9PSBiIkJaaCIgYW5kIHNlbGYuYnVmWzQ6MTBdID09IGIiMUFZJlNZIjoKICAgICAgICAgICAgcmV0dXJuICJiejIiCiAgICAgICAgZWxpZiBzZWxmLmJ1Zi5zdGFydHN3aXRoKChiIlx4NWRceDAwXHgwMFx4ODAiLCBiIlx4ZmQ3elhaIikpOgogICAgICAgICAgICByZXR1cm4gInh6IgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiAidGFyIgoKICAgIGRlZiBjbG9zZShzZWxmKToKICAgICAgICBzZWxmLmZpbGVvYmouY2xvc2UoKQojIGNsYXNzIFN0cmVhbVByb3h5CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgRXh0cmFjdGlvbiBmaWxlIG9iamVjdAojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmNsYXNzIF9GaWxlSW5GaWxlKG9iamVjdCk6CiAgICAiIiJBIHRoaW4gd3JhcHBlciBhcm91bmQgYW4gZXhpc3RpbmcgZmlsZSBvYmplY3QgdGhhdAogICAgICAgcHJvdmlkZXMgYSBwYXJ0IG9mIGl0cyBkYXRhIGFzIGFuIGluZGl2aWR1YWwgZmlsZQogICAgICAgb2JqZWN0LgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGZpbGVvYmosIG9mZnNldCwgc2l6ZSwgYmxvY2tpbmZvPU5vbmUpOgogICAgICAgIHNlbGYuZmlsZW9iaiA9IGZpbGVvYmoKICAgICAgICBzZWxmLm9mZnNldCA9IG9mZnNldAogICAgICAgIHNlbGYuc2l6ZSA9IHNpemUKICAgICAgICBzZWxmLnBvc2l0aW9uID0gMAogICAgICAgIHNlbGYubmFtZSA9IGdldGF0dHIoZmlsZW9iaiwgIm5hbWUiLCBOb25lKQogICAgICAgIHNlbGYuY2xvc2VkID0gRmFsc2UKCiAgICAgICAgaWYgYmxvY2tpbmZvIGlzIE5vbmU6CiAgICAgICAgICAgIGJsb2NraW5mbyA9IFsoMCwgc2l6ZSldCgogICAgICAgICMgQ29uc3RydWN0IGEgbWFwIHdpdGggZGF0YSBhbmQgemVybyBibG9ja3MuCiAgICAgICAgc2VsZi5tYXBfaW5kZXggPSAwCiAgICAgICAgc2VsZi5tYXAgPSBbXQogICAgICAgIGxhc3Rwb3MgPSAwCiAgICAgICAgcmVhbHBvcyA9IHNlbGYub2Zmc2V0CiAgICAgICAgZm9yIG9mZnNldCwgc2l6ZSBpbiBibG9ja2luZm86CiAgICAgICAgICAgIGlmIG9mZnNldCA+IGxhc3Rwb3M6CiAgICAgICAgICAgICAgICBzZWxmLm1hcC5hcHBlbmQoKEZhbHNlLCBsYXN0cG9zLCBvZmZzZXQsIE5vbmUpKQogICAgICAgICAgICBzZWxmLm1hcC5hcHBlbmQoKFRydWUsIG9mZnNldCwgb2Zmc2V0ICsgc2l6ZSwgcmVhbHBvcykpCiAgICAgICAgICAgIHJlYWxwb3MgKz0gc2l6ZQogICAgICAgICAgICBsYXN0cG9zID0gb2Zmc2V0ICsgc2l6ZQogICAgICAgIGlmIGxhc3Rwb3MgPCBzZWxmLnNpemU6CiAgICAgICAgICAgIHNlbGYubWFwLmFwcGVuZCgoRmFsc2UsIGxhc3Rwb3MsIHNlbGYuc2l6ZSwgTm9uZSkpCgogICAgZGVmIGZsdXNoKHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgcmVhZGFibGUoc2VsZik6CiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgd3JpdGFibGUoc2VsZik6CiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIHNlZWthYmxlKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmZpbGVvYmouc2Vla2FibGUoKQoKICAgIGRlZiB0ZWxsKHNlbGYpOgogICAgICAgICIiIlJldHVybiB0aGUgY3VycmVudCBmaWxlIHBvc2l0aW9uLgogICAgICAgICIiIgogICAgICAgIHJldHVybiBzZWxmLnBvc2l0aW9uCgogICAgZGVmIHNlZWsoc2VsZiwgcG9zaXRpb24sIHdoZW5jZT1pby5TRUVLX1NFVCk6CiAgICAgICAgIiIiU2VlayB0byBhIHBvc2l0aW9uIGluIHRoZSBmaWxlLgogICAgICAgICIiIgogICAgICAgIGlmIHdoZW5jZSA9PSBpby5TRUVLX1NFVDoKICAgICAgICAgICAgc2VsZi5wb3NpdGlvbiA9IG1pbihtYXgocG9zaXRpb24sIDApLCBzZWxmLnNpemUpCiAgICAgICAgZWxpZiB3aGVuY2UgPT0gaW8uU0VFS19DVVI6CiAgICAgICAgICAgIGlmIHBvc2l0aW9uIDwgMDoKICAgICAgICAgICAgICAgIHNlbGYucG9zaXRpb24gPSBtYXgoc2VsZi5wb3NpdGlvbiArIHBvc2l0aW9uLCAwKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5wb3NpdGlvbiA9IG1pbihzZWxmLnBvc2l0aW9uICsgcG9zaXRpb24sIHNlbGYuc2l6ZSkKICAgICAgICBlbGlmIHdoZW5jZSA9PSBpby5TRUVLX0VORDoKICAgICAgICAgICAgc2VsZi5wb3NpdGlvbiA9IG1heChtaW4oc2VsZi5zaXplICsgcG9zaXRpb24sIHNlbGYuc2l6ZSksIDApCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiSW52YWxpZCBhcmd1bWVudCIpCiAgICAgICAgcmV0dXJuIHNlbGYucG9zaXRpb24KCiAgICBkZWYgcmVhZChzZWxmLCBzaXplPU5vbmUpOgogICAgICAgICIiIlJlYWQgZGF0YSBmcm9tIHRoZSBmaWxlLgogICAgICAgICIiIgogICAgICAgIGlmIHNpemUgaXMgTm9uZToKICAgICAgICAgICAgc2l6ZSA9IHNlbGYuc2l6ZSAtIHNlbGYucG9zaXRpb24KICAgICAgICBlbHNlOgogICAgICAgICAgICBzaXplID0gbWluKHNpemUsIHNlbGYuc2l6ZSAtIHNlbGYucG9zaXRpb24pCgogICAgICAgIGJ1ZiA9IGIiIgogICAgICAgIHdoaWxlIHNpemUgPiAwOgogICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgZGF0YSwgc3RhcnQsIHN0b3AsIG9mZnNldCA9IHNlbGYubWFwW3NlbGYubWFwX2luZGV4XQogICAgICAgICAgICAgICAgaWYgc3RhcnQgPD0gc2VsZi5wb3NpdGlvbiA8IHN0b3A6CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5tYXBfaW5kZXggKz0gMQogICAgICAgICAgICAgICAgICAgIGlmIHNlbGYubWFwX2luZGV4ID09IGxlbihzZWxmLm1hcCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubWFwX2luZGV4ID0gMAogICAgICAgICAgICBsZW5ndGggPSBtaW4oc2l6ZSwgc3RvcCAtIHNlbGYucG9zaXRpb24pCiAgICAgICAgICAgIGlmIGRhdGE6CiAgICAgICAgICAgICAgICBzZWxmLmZpbGVvYmouc2VlayhvZmZzZXQgKyAoc2VsZi5wb3NpdGlvbiAtIHN0YXJ0KSkKICAgICAgICAgICAgICAgIGJ1ZiArPSBzZWxmLmZpbGVvYmoucmVhZChsZW5ndGgpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBidWYgKz0gTlVMICogbGVuZ3RoCiAgICAgICAgICAgIHNpemUgLT0gbGVuZ3RoCiAgICAgICAgICAgIHNlbGYucG9zaXRpb24gKz0gbGVuZ3RoCiAgICAgICAgcmV0dXJuIGJ1ZgoKICAgIGRlZiByZWFkaW50byhzZWxmLCBiKToKICAgICAgICBidWYgPSBzZWxmLnJlYWQobGVuKGIpKQogICAgICAgIGJbOmxlbihidWYpXSA9IGJ1ZgogICAgICAgIHJldHVybiBsZW4oYnVmKQoKICAgIGRlZiBjbG9zZShzZWxmKToKICAgICAgICBzZWxmLmNsb3NlZCA9IFRydWUKI2NsYXNzIF9GaWxlSW5GaWxlCgpjbGFzcyBFeEZpbGVPYmplY3QoaW8uQnVmZmVyZWRSZWFkZXIpOgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0YXJmaWxlLCB0YXJpbmZvKToKICAgICAgICBmaWxlb2JqID0gX0ZpbGVJbkZpbGUodGFyZmlsZS5maWxlb2JqLCB0YXJpbmZvLm9mZnNldF9kYXRhLAogICAgICAgICAgICAgICAgdGFyaW5mby5zaXplLCB0YXJpbmZvLnNwYXJzZSkKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGZpbGVvYmopCiNjbGFzcyBFeEZpbGVPYmplY3QKCiMtLS0tLS0tLS0tLS0tLS0tLS0KIyBFeHBvcnRlZCBDbGFzc2VzCiMtLS0tLS0tLS0tLS0tLS0tLS0KY2xhc3MgVGFySW5mbyhvYmplY3QpOgogICAgIiIiSW5mb3JtYXRpb25hbCBjbGFzcyB3aGljaCBob2xkcyB0aGUgZGV0YWlscyBhYm91dCBhbgogICAgICAgYXJjaGl2ZSBtZW1iZXIgZ2l2ZW4gYnkgYSB0YXIgaGVhZGVyIGJsb2NrLgogICAgICAgVGFySW5mbyBvYmplY3RzIGFyZSByZXR1cm5lZCBieSBUYXJGaWxlLmdldG1lbWJlcigpLAogICAgICAgVGFyRmlsZS5nZXRtZW1iZXJzKCkgYW5kIFRhckZpbGUuZ2V0dGFyaW5mbygpIGFuZCBhcmUKICAgICAgIHVzdWFsbHkgY3JlYXRlZCBpbnRlcm5hbGx5LgogICAgIiIiCgogICAgX19zbG90c19fID0gKCJuYW1lIiwgIm1vZGUiLCAidWlkIiwgImdpZCIsICJzaXplIiwgIm10aW1lIiwKICAgICAgICAgICAgICAgICAiY2hrc3VtIiwgInR5cGUiLCAibGlua25hbWUiLCAidW5hbWUiLCAiZ25hbWUiLAogICAgICAgICAgICAgICAgICJkZXZtYWpvciIsICJkZXZtaW5vciIsCiAgICAgICAgICAgICAgICAgIm9mZnNldCIsICJvZmZzZXRfZGF0YSIsICJwYXhfaGVhZGVycyIsICJzcGFyc2UiLAogICAgICAgICAgICAgICAgICJ0YXJmaWxlIiwgIl9zcGFyc2Vfc3RydWN0cyIsICJfbGlua190YXJnZXQiKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBuYW1lPSIiKToKICAgICAgICAiIiJDb25zdHJ1Y3QgYSBUYXJJbmZvIG9iamVjdC4gbmFtZSBpcyB0aGUgb3B0aW9uYWwgbmFtZQogICAgICAgICAgIG9mIHRoZSBtZW1iZXIuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5uYW1lID0gbmFtZSAgICAgICAgIyBtZW1iZXIgbmFtZQogICAgICAgIHNlbGYubW9kZSA9IDBvNjQ0ICAgICAgICMgZmlsZSBwZXJtaXNzaW9ucwogICAgICAgIHNlbGYudWlkID0gMCAgICAgICAgICAgICMgdXNlciBpZAogICAgICAgIHNlbGYuZ2lkID0gMCAgICAgICAgICAgICMgZ3JvdXAgaWQKICAgICAgICBzZWxmLnNpemUgPSAwICAgICAgICAgICAjIGZpbGUgc2l6ZQogICAgICAgIHNlbGYubXRpbWUgPSAwICAgICAgICAgICMgbW9kaWZpY2F0aW9uIHRpbWUKICAgICAgICBzZWxmLmNoa3N1bSA9IDAgICAgICAgICAjIGhlYWRlciBjaGVja3N1bQogICAgICAgIHNlbGYudHlwZSA9IFJFR1RZUEUgICAgICMgbWVtYmVyIHR5cGUKICAgICAgICBzZWxmLmxpbmtuYW1lID0gIiIgICAgICAjIGxpbmsgbmFtZQogICAgICAgIHNlbGYudW5hbWUgPSAiIiAgICAgICAgICMgdXNlciBuYW1lCiAgICAgICAgc2VsZi5nbmFtZSA9ICIiICAgICAgICAgIyBncm91cCBuYW1lCiAgICAgICAgc2VsZi5kZXZtYWpvciA9IDAgICAgICAgIyBkZXZpY2UgbWFqb3IgbnVtYmVyCiAgICAgICAgc2VsZi5kZXZtaW5vciA9IDAgICAgICAgIyBkZXZpY2UgbWlub3IgbnVtYmVyCgogICAgICAgIHNlbGYub2Zmc2V0ID0gMCAgICAgICAgICMgdGhlIHRhciBoZWFkZXIgc3RhcnRzIGhlcmUKICAgICAgICBzZWxmLm9mZnNldF9kYXRhID0gMCAgICAjIHRoZSBmaWxlJ3MgZGF0YSBzdGFydHMgaGVyZQoKICAgICAgICBzZWxmLnNwYXJzZSA9IE5vbmUgICAgICAjIHNwYXJzZSBtZW1iZXIgaW5mb3JtYXRpb24KICAgICAgICBzZWxmLnBheF9oZWFkZXJzID0ge30gICAjIHBheCBoZWFkZXIgaW5mb3JtYXRpb24KCiAgICAjIEluIHBheCBoZWFkZXJzIHRoZSAibmFtZSIgYW5kICJsaW5rbmFtZSIgZmllbGQgYXJlIGNhbGxlZAogICAgIyAicGF0aCIgYW5kICJsaW5rcGF0aCIuCiAgICBkZWYgX2dldHBhdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYubmFtZQogICAgZGVmIF9zZXRwYXRoKHNlbGYsIG5hbWUpOgogICAgICAgIHNlbGYubmFtZSA9IG5hbWUKICAgIHBhdGggPSBwcm9wZXJ0eShfZ2V0cGF0aCwgX3NldHBhdGgpCgogICAgZGVmIF9nZXRsaW5rcGF0aChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5saW5rbmFtZQogICAgZGVmIF9zZXRsaW5rcGF0aChzZWxmLCBsaW5rbmFtZSk6CiAgICAgICAgc2VsZi5saW5rbmFtZSA9IGxpbmtuYW1lCiAgICBsaW5rcGF0aCA9IHByb3BlcnR5KF9nZXRsaW5rcGF0aCwgX3NldGxpbmtwYXRoKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gIjwlcyAlciBhdCAlI3g+IiAlIChzZWxmLl9fY2xhc3NfXy5fX25hbWVfXyxzZWxmLm5hbWUsaWQoc2VsZikpCgogICAgZGVmIGdldF9pbmZvKHNlbGYpOgogICAgICAgICIiIlJldHVybiB0aGUgVGFySW5mbydzIGF0dHJpYnV0ZXMgYXMgYSBkaWN0aW9uYXJ5LgogICAgICAgICIiIgogICAgICAgIGluZm8gPSB7CiAgICAgICAgICAgICJuYW1lIjogICAgIHNlbGYubmFtZSwKICAgICAgICAgICAgIm1vZGUiOiAgICAgc2VsZi5tb2RlICYgMG83Nzc3LAogICAgICAgICAgICAidWlkIjogICAgICBzZWxmLnVpZCwKICAgICAgICAgICAgImdpZCI6ICAgICAgc2VsZi5naWQsCiAgICAgICAgICAgICJzaXplIjogICAgIHNlbGYuc2l6ZSwKICAgICAgICAgICAgIm10aW1lIjogICAgc2VsZi5tdGltZSwKICAgICAgICAgICAgImNoa3N1bSI6ICAgc2VsZi5jaGtzdW0sCiAgICAgICAgICAgICJ0eXBlIjogICAgIHNlbGYudHlwZSwKICAgICAgICAgICAgImxpbmtuYW1lIjogc2VsZi5saW5rbmFtZSwKICAgICAgICAgICAgInVuYW1lIjogICAgc2VsZi51bmFtZSwKICAgICAgICAgICAgImduYW1lIjogICAgc2VsZi5nbmFtZSwKICAgICAgICAgICAgImRldm1ham9yIjogc2VsZi5kZXZtYWpvciwKICAgICAgICAgICAgImRldm1pbm9yIjogc2VsZi5kZXZtaW5vcgogICAgICAgIH0KCiAgICAgICAgaWYgaW5mb1sidHlwZSJdID09IERJUlRZUEUgYW5kIG5vdCBpbmZvWyJuYW1lIl0uZW5kc3dpdGgoIi8iKToKICAgICAgICAgICAgaW5mb1sibmFtZSJdICs9ICIvIgoKICAgICAgICByZXR1cm4gaW5mbwoKICAgIGRlZiB0b2J1ZihzZWxmLCBmb3JtYXQ9REVGQVVMVF9GT1JNQVQsIGVuY29kaW5nPUVOQ09ESU5HLCBlcnJvcnM9InN1cnJvZ2F0ZWVzY2FwZSIpOgogICAgICAgICIiIlJldHVybiBhIHRhciBoZWFkZXIgYXMgYSBzdHJpbmcgb2YgNTEyIGJ5dGUgYmxvY2tzLgogICAgICAgICIiIgogICAgICAgIGluZm8gPSBzZWxmLmdldF9pbmZvKCkKCiAgICAgICAgaWYgZm9ybWF0ID09IFVTVEFSX0ZPUk1BVDoKICAgICAgICAgICAgcmV0dXJuIHNlbGYuY3JlYXRlX3VzdGFyX2hlYWRlcihpbmZvLCBlbmNvZGluZywgZXJyb3JzKQogICAgICAgIGVsaWYgZm9ybWF0ID09IEdOVV9GT1JNQVQ6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmNyZWF0ZV9nbnVfaGVhZGVyKGluZm8sIGVuY29kaW5nLCBlcnJvcnMpCiAgICAgICAgZWxpZiBmb3JtYXQgPT0gUEFYX0ZPUk1BVDoKICAgICAgICAgICAgcmV0dXJuIHNlbGYuY3JlYXRlX3BheF9oZWFkZXIoaW5mbywgZW5jb2RpbmcpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiaW52YWxpZCBmb3JtYXQiKQoKICAgIGRlZiBjcmVhdGVfdXN0YXJfaGVhZGVyKHNlbGYsIGluZm8sIGVuY29kaW5nLCBlcnJvcnMpOgogICAgICAgICIiIlJldHVybiB0aGUgb2JqZWN0IGFzIGEgdXN0YXIgaGVhZGVyIGJsb2NrLgogICAgICAgICIiIgogICAgICAgIGluZm9bIm1hZ2ljIl0gPSBQT1NJWF9NQUdJQwoKICAgICAgICBpZiBsZW4oaW5mb1sibGlua25hbWUiXSkgPiBMRU5HVEhfTElOSzoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigibGlua25hbWUgaXMgdG9vIGxvbmciKQoKICAgICAgICBpZiBsZW4oaW5mb1sibmFtZSJdKSA+IExFTkdUSF9OQU1FOgogICAgICAgICAgICBpbmZvWyJwcmVmaXgiXSwgaW5mb1sibmFtZSJdID0gc2VsZi5fcG9zaXhfc3BsaXRfbmFtZShpbmZvWyJuYW1lIl0pCgogICAgICAgIHJldHVybiBzZWxmLl9jcmVhdGVfaGVhZGVyKGluZm8sIFVTVEFSX0ZPUk1BVCwgZW5jb2RpbmcsIGVycm9ycykKCiAgICBkZWYgY3JlYXRlX2dudV9oZWFkZXIoc2VsZiwgaW5mbywgZW5jb2RpbmcsIGVycm9ycyk6CiAgICAgICAgIiIiUmV0dXJuIHRoZSBvYmplY3QgYXMgYSBHTlUgaGVhZGVyIGJsb2NrIHNlcXVlbmNlLgogICAgICAgICIiIgogICAgICAgIGluZm9bIm1hZ2ljIl0gPSBHTlVfTUFHSUMKCiAgICAgICAgYnVmID0gYiIiCiAgICAgICAgaWYgbGVuKGluZm9bImxpbmtuYW1lIl0pID4gTEVOR1RIX0xJTks6CiAgICAgICAgICAgIGJ1ZiArPSBzZWxmLl9jcmVhdGVfZ251X2xvbmdfaGVhZGVyKGluZm9bImxpbmtuYW1lIl0sIEdOVVRZUEVfTE9OR0xJTkssIGVuY29kaW5nLCBlcnJvcnMpCgogICAgICAgIGlmIGxlbihpbmZvWyJuYW1lIl0pID4gTEVOR1RIX05BTUU6CiAgICAgICAgICAgIGJ1ZiArPSBzZWxmLl9jcmVhdGVfZ251X2xvbmdfaGVhZGVyKGluZm9bIm5hbWUiXSwgR05VVFlQRV9MT05HTkFNRSwgZW5jb2RpbmcsIGVycm9ycykKCiAgICAgICAgcmV0dXJuIGJ1ZiArIHNlbGYuX2NyZWF0ZV9oZWFkZXIoaW5mbywgR05VX0ZPUk1BVCwgZW5jb2RpbmcsIGVycm9ycykKCiAgICBkZWYgY3JlYXRlX3BheF9oZWFkZXIoc2VsZiwgaW5mbywgZW5jb2RpbmcpOgogICAgICAgICIiIlJldHVybiB0aGUgb2JqZWN0IGFzIGEgdXN0YXIgaGVhZGVyIGJsb2NrLiBJZiBpdCBjYW5ub3QgYmUKICAgICAgICAgICByZXByZXNlbnRlZCB0aGlzIHdheSwgcHJlcGVuZCBhIHBheCBleHRlbmRlZCBoZWFkZXIgc2VxdWVuY2UKICAgICAgICAgICB3aXRoIHN1cHBsZW1lbnQgaW5mb3JtYXRpb24uCiAgICAgICAgIiIiCiAgICAgICAgaW5mb1sibWFnaWMiXSA9IFBPU0lYX01BR0lDCiAgICAgICAgcGF4X2hlYWRlcnMgPSBzZWxmLnBheF9oZWFkZXJzLmNvcHkoKQoKICAgICAgICAjIFRlc3Qgc3RyaW5nIGZpZWxkcyBmb3IgdmFsdWVzIHRoYXQgZXhjZWVkIHRoZSBmaWVsZCBsZW5ndGggb3IgY2Fubm90CiAgICAgICAgIyBiZSByZXByZXNlbnRlZCBpbiBBU0NJSSBlbmNvZGluZy4KICAgICAgICBmb3IgbmFtZSwgaG5hbWUsIGxlbmd0aCBpbiAoCiAgICAgICAgICAgICAgICAoIm5hbWUiLCAicGF0aCIsIExFTkdUSF9OQU1FKSwgKCJsaW5rbmFtZSIsICJsaW5rcGF0aCIsIExFTkdUSF9MSU5LKSwKICAgICAgICAgICAgICAgICgidW5hbWUiLCAidW5hbWUiLCAzMiksICgiZ25hbWUiLCAiZ25hbWUiLCAzMikpOgoKICAgICAgICAgICAgaWYgaG5hbWUgaW4gcGF4X2hlYWRlcnM6CiAgICAgICAgICAgICAgICAjIFRoZSBwYXggaGVhZGVyIGhhcyBwcmlvcml0eS4KICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICAjIFRyeSB0byBlbmNvZGUgdGhlIHN0cmluZyBhcyBBU0NJSS4KICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgaW5mb1tuYW1lXS5lbmNvZGUoImFzY2lpIiwgInN0cmljdCIpCiAgICAgICAgICAgIGV4Y2VwdCBVbmljb2RlRW5jb2RlRXJyb3I6CiAgICAgICAgICAgICAgICBwYXhfaGVhZGVyc1tobmFtZV0gPSBpbmZvW25hbWVdCiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgaWYgbGVuKGluZm9bbmFtZV0pID4gbGVuZ3RoOgogICAgICAgICAgICAgICAgcGF4X2hlYWRlcnNbaG5hbWVdID0gaW5mb1tuYW1lXQoKICAgICAgICAjIFRlc3QgbnVtYmVyIGZpZWxkcyBmb3IgdmFsdWVzIHRoYXQgZXhjZWVkIHRoZSBmaWVsZCBsaW1pdCBvciB2YWx1ZXMKICAgICAgICAjIHRoYXQgbGlrZSB0byBiZSBzdG9yZWQgYXMgZmxvYXQuCiAgICAgICAgZm9yIG5hbWUsIGRpZ2l0cyBpbiAoKCJ1aWQiLCA4KSwgKCJnaWQiLCA4KSwgKCJzaXplIiwgMTIpLCAoIm10aW1lIiwgMTIpKToKICAgICAgICAgICAgaWYgbmFtZSBpbiBwYXhfaGVhZGVyczoKICAgICAgICAgICAgICAgICMgVGhlIHBheCBoZWFkZXIgaGFzIHByaW9yaXR5LiBBdm9pZCBvdmVyZmxvdy4KICAgICAgICAgICAgICAgIGluZm9bbmFtZV0gPSAwCiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgdmFsID0gaW5mb1tuYW1lXQogICAgICAgICAgICBpZiBub3QgMCA8PSB2YWwgPCA4ICoqIChkaWdpdHMgLSAxKSBvciBpc2luc3RhbmNlKHZhbCwgZmxvYXQpOgogICAgICAgICAgICAgICAgcGF4X2hlYWRlcnNbbmFtZV0gPSBzdHIodmFsKQogICAgICAgICAgICAgICAgaW5mb1tuYW1lXSA9IDAKCiAgICAgICAgIyBDcmVhdGUgYSBwYXggZXh0ZW5kZWQgaGVhZGVyIGlmIG5lY2Vzc2FyeS4KICAgICAgICBpZiBwYXhfaGVhZGVyczoKICAgICAgICAgICAgYnVmID0gc2VsZi5fY3JlYXRlX3BheF9nZW5lcmljX2hlYWRlcihwYXhfaGVhZGVycywgWEhEVFlQRSwgZW5jb2RpbmcpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYnVmID0gYiIiCgogICAgICAgIHJldHVybiBidWYgKyBzZWxmLl9jcmVhdGVfaGVhZGVyKGluZm8sIFVTVEFSX0ZPUk1BVCwgImFzY2lpIiwgInJlcGxhY2UiKQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIGNyZWF0ZV9wYXhfZ2xvYmFsX2hlYWRlcihjbHMsIHBheF9oZWFkZXJzKToKICAgICAgICAiIiJSZXR1cm4gdGhlIG9iamVjdCBhcyBhIHBheCBnbG9iYWwgaGVhZGVyIGJsb2NrIHNlcXVlbmNlLgogICAgICAgICIiIgogICAgICAgIHJldHVybiBjbHMuX2NyZWF0ZV9wYXhfZ2VuZXJpY19oZWFkZXIocGF4X2hlYWRlcnMsIFhHTFRZUEUsICJ1dGYtOCIpCgogICAgZGVmIF9wb3NpeF9zcGxpdF9uYW1lKHNlbGYsIG5hbWUpOgogICAgICAgICIiIlNwbGl0IGEgbmFtZSBsb25nZXIgdGhhbiAxMDAgY2hhcnMgaW50byBhIHByZWZpeAogICAgICAgICAgIGFuZCBhIG5hbWUgcGFydC4KICAgICAgICAiIiIKICAgICAgICBwcmVmaXggPSBuYW1lWzpMRU5HVEhfUFJFRklYICsgMV0KICAgICAgICB3aGlsZSBwcmVmaXggYW5kIHByZWZpeFstMV0gIT0gIi8iOgogICAgICAgICAgICBwcmVmaXggPSBwcmVmaXhbOi0xXQoKICAgICAgICBuYW1lID0gbmFtZVtsZW4ocHJlZml4KTpdCiAgICAgICAgcHJlZml4ID0gcHJlZml4WzotMV0KCiAgICAgICAgaWYgbm90IHByZWZpeCBvciBsZW4obmFtZSkgPiBMRU5HVEhfTkFNRToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigibmFtZSBpcyB0b28gbG9uZyIpCiAgICAgICAgcmV0dXJuIHByZWZpeCwgbmFtZQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfY3JlYXRlX2hlYWRlcihpbmZvLCBmb3JtYXQsIGVuY29kaW5nLCBlcnJvcnMpOgogICAgICAgICIiIlJldHVybiBhIGhlYWRlciBibG9jay4gaW5mbyBpcyBhIGRpY3Rpb25hcnkgd2l0aCBmaWxlCiAgICAgICAgICAgaW5mb3JtYXRpb24sIGZvcm1hdCBtdXN0IGJlIG9uZSBvZiB0aGUgKl9GT1JNQVQgY29uc3RhbnRzLgogICAgICAgICIiIgogICAgICAgIHBhcnRzID0gWwogICAgICAgICAgICBzdG4oaW5mby5nZXQoIm5hbWUiLCAiIiksIDEwMCwgZW5jb2RpbmcsIGVycm9ycyksCiAgICAgICAgICAgIGl0bihpbmZvLmdldCgibW9kZSIsIDApICYgMG83Nzc3LCA4LCBmb3JtYXQpLAogICAgICAgICAgICBpdG4oaW5mby5nZXQoInVpZCIsIDApLCA4LCBmb3JtYXQpLAogICAgICAgICAgICBpdG4oaW5mby5nZXQoImdpZCIsIDApLCA4LCBmb3JtYXQpLAogICAgICAgICAgICBpdG4oaW5mby5nZXQoInNpemUiLCAwKSwgMTIsIGZvcm1hdCksCiAgICAgICAgICAgIGl0bihpbmZvLmdldCgibXRpbWUiLCAwKSwgMTIsIGZvcm1hdCksCiAgICAgICAgICAgIGIiICAgICAgICAiLCAjIGNoZWNrc3VtIGZpZWxkCiAgICAgICAgICAgIGluZm8uZ2V0KCJ0eXBlIiwgUkVHVFlQRSksCiAgICAgICAgICAgIHN0bihpbmZvLmdldCgibGlua25hbWUiLCAiIiksIDEwMCwgZW5jb2RpbmcsIGVycm9ycyksCiAgICAgICAgICAgIGluZm8uZ2V0KCJtYWdpYyIsIFBPU0lYX01BR0lDKSwKICAgICAgICAgICAgc3RuKGluZm8uZ2V0KCJ1bmFtZSIsICIiKSwgMzIsIGVuY29kaW5nLCBlcnJvcnMpLAogICAgICAgICAgICBzdG4oaW5mby5nZXQoImduYW1lIiwgIiIpLCAzMiwgZW5jb2RpbmcsIGVycm9ycyksCiAgICAgICAgICAgIGl0bihpbmZvLmdldCgiZGV2bWFqb3IiLCAwKSwgOCwgZm9ybWF0KSwKICAgICAgICAgICAgaXRuKGluZm8uZ2V0KCJkZXZtaW5vciIsIDApLCA4LCBmb3JtYXQpLAogICAgICAgICAgICBzdG4oaW5mby5nZXQoInByZWZpeCIsICIiKSwgMTU1LCBlbmNvZGluZywgZXJyb3JzKQogICAgICAgIF0KCiAgICAgICAgYnVmID0gc3RydWN0LnBhY2soIiVkcyIgJSBCTE9DS1NJWkUsIGIiIi5qb2luKHBhcnRzKSkKICAgICAgICBjaGtzdW0gPSBjYWxjX2Noa3N1bXMoYnVmWy1CTE9DS1NJWkU6XSlbMF0KICAgICAgICBidWYgPSBidWZbOi0zNjRdICsgYnl0ZXMoIiUwNm9cMCIgJSBjaGtzdW0sICJhc2NpaSIpICsgYnVmWy0zNTc6XQogICAgICAgIHJldHVybiBidWYKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX2NyZWF0ZV9wYXlsb2FkKHBheWxvYWQpOgogICAgICAgICIiIlJldHVybiB0aGUgc3RyaW5nIHBheWxvYWQgZmlsbGVkIHdpdGggemVybyBieXRlcwogICAgICAgICAgIHVwIHRvIHRoZSBuZXh0IDUxMiBieXRlIGJvcmRlci4KICAgICAgICAiIiIKICAgICAgICBibG9ja3MsIHJlbWFpbmRlciA9IGRpdm1vZChsZW4ocGF5bG9hZCksIEJMT0NLU0laRSkKICAgICAgICBpZiByZW1haW5kZXIgPiAwOgogICAgICAgICAgICBwYXlsb2FkICs9IChCTE9DS1NJWkUgLSByZW1haW5kZXIpICogTlVMCiAgICAgICAgcmV0dXJuIHBheWxvYWQKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBfY3JlYXRlX2dudV9sb25nX2hlYWRlcihjbHMsIG5hbWUsIHR5cGUsIGVuY29kaW5nLCBlcnJvcnMpOgogICAgICAgICIiIlJldHVybiBhIEdOVVRZUEVfTE9OR05BTUUgb3IgR05VVFlQRV9MT05HTElOSyBzZXF1ZW5jZQogICAgICAgICAgIGZvciBuYW1lLgogICAgICAgICIiIgogICAgICAgIG5hbWUgPSBuYW1lLmVuY29kZShlbmNvZGluZywgZXJyb3JzKSArIE5VTAoKICAgICAgICBpbmZvID0ge30KICAgICAgICBpbmZvWyJuYW1lIl0gPSAiLi8uL0BMb25nTGluayIKICAgICAgICBpbmZvWyJ0eXBlIl0gPSB0eXBlCiAgICAgICAgaW5mb1sic2l6ZSJdID0gbGVuKG5hbWUpCiAgICAgICAgaW5mb1sibWFnaWMiXSA9IEdOVV9NQUdJQwoKICAgICAgICAjIGNyZWF0ZSBleHRlbmRlZCBoZWFkZXIgKyBuYW1lIGJsb2Nrcy4KICAgICAgICByZXR1cm4gY2xzLl9jcmVhdGVfaGVhZGVyKGluZm8sIFVTVEFSX0ZPUk1BVCwgZW5jb2RpbmcsIGVycm9ycykgKyBcCiAgICAgICAgICAgICAgICBjbHMuX2NyZWF0ZV9wYXlsb2FkKG5hbWUpCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgX2NyZWF0ZV9wYXhfZ2VuZXJpY19oZWFkZXIoY2xzLCBwYXhfaGVhZGVycywgdHlwZSwgZW5jb2RpbmcpOgogICAgICAgICIiIlJldHVybiBhIFBPU0lYLjEtMjAwOCBleHRlbmRlZCBvciBnbG9iYWwgaGVhZGVyIHNlcXVlbmNlCiAgICAgICAgICAgdGhhdCBjb250YWlucyBhIGxpc3Qgb2Yga2V5d29yZCwgdmFsdWUgcGFpcnMuIFRoZSB2YWx1ZXMKICAgICAgICAgICBtdXN0IGJlIHN0cmluZ3MuCiAgICAgICAgIiIiCiAgICAgICAgIyBDaGVjayBpZiBvbmUgb2YgdGhlIGZpZWxkcyBjb250YWlucyBzdXJyb2dhdGUgY2hhcmFjdGVycyBhbmQgdGhlcmVieQogICAgICAgICMgZm9yY2VzIGhkcmNoYXJzZXQ9QklOQVJZLCBzZWUgX3Byb2NfcGF4KCkgZm9yIG1vcmUgaW5mb3JtYXRpb24uCiAgICAgICAgYmluYXJ5ID0gRmFsc2UKICAgICAgICBmb3Iga2V5d29yZCwgdmFsdWUgaW4gcGF4X2hlYWRlcnMuaXRlbXMoKToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgdmFsdWUuZW5jb2RlKCJ1dGYtOCIsICJzdHJpY3QiKQogICAgICAgICAgICBleGNlcHQgVW5pY29kZUVuY29kZUVycm9yOgogICAgICAgICAgICAgICAgYmluYXJ5ID0gVHJ1ZQogICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgcmVjb3JkcyA9IGIiIgogICAgICAgIGlmIGJpbmFyeToKICAgICAgICAgICAgIyBQdXQgdGhlIGhkcmNoYXJzZXQgZmllbGQgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgaGVhZGVyLgogICAgICAgICAgICByZWNvcmRzICs9IGIiMjEgaGRyY2hhcnNldD1CSU5BUllcbiIKCiAgICAgICAgZm9yIGtleXdvcmQsIHZhbHVlIGluIHBheF9oZWFkZXJzLml0ZW1zKCk6CiAgICAgICAgICAgIGtleXdvcmQgPSBrZXl3b3JkLmVuY29kZSgidXRmLTgiKQogICAgICAgICAgICBpZiBiaW5hcnk6CiAgICAgICAgICAgICAgICAjIFRyeSB0byByZXN0b3JlIHRoZSBvcmlnaW5hbCBieXRlIHJlcHJlc2VudGF0aW9uIG9mIGB2YWx1ZScuCiAgICAgICAgICAgICAgICAjIE5lZWRsZXNzIHRvIHNheSwgdGhhdCB0aGUgZW5jb2RpbmcgbXVzdCBtYXRjaCB0aGUgc3RyaW5nLgogICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5lbmNvZGUoZW5jb2RpbmcsICJzdXJyb2dhdGVlc2NhcGUiKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5lbmNvZGUoInV0Zi04IikKCiAgICAgICAgICAgIGwgPSBsZW4oa2V5d29yZCkgKyBsZW4odmFsdWUpICsgMyAgICMgJyAnICsgJz0nICsgJ1xuJwogICAgICAgICAgICBuID0gcCA9IDAKICAgICAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgICAgIG4gPSBsICsgbGVuKHN0cihwKSkKICAgICAgICAgICAgICAgIGlmIG4gPT0gcDoKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgcCA9IG4KICAgICAgICAgICAgcmVjb3JkcyArPSBieXRlcyhzdHIocCksICJhc2NpaSIpICsgYiIgIiArIGtleXdvcmQgKyBiIj0iICsgdmFsdWUgKyBiIlxuIgoKICAgICAgICAjIFdlIHVzZSBhIGhhcmRjb2RlZCAiLi8uL0BQYXhIZWFkZXIiIG5hbWUgbGlrZSBzdGFyIGRvZXMKICAgICAgICAjIGluc3RlYWQgb2YgdGhlIG9uZSB0aGF0IFBPU0lYIHJlY29tbWVuZHMuCiAgICAgICAgaW5mbyA9IHt9CiAgICAgICAgaW5mb1sibmFtZSJdID0gIi4vLi9AUGF4SGVhZGVyIgogICAgICAgIGluZm9bInR5cGUiXSA9IHR5cGUKICAgICAgICBpbmZvWyJzaXplIl0gPSBsZW4ocmVjb3JkcykKICAgICAgICBpbmZvWyJtYWdpYyJdID0gUE9TSVhfTUFHSUMKCiAgICAgICAgIyBDcmVhdGUgcGF4IGhlYWRlciArIHJlY29yZCBibG9ja3MuCiAgICAgICAgcmV0dXJuIGNscy5fY3JlYXRlX2hlYWRlcihpbmZvLCBVU1RBUl9GT1JNQVQsICJhc2NpaSIsICJyZXBsYWNlIikgKyBcCiAgICAgICAgICAgICAgICBjbHMuX2NyZWF0ZV9wYXlsb2FkKHJlY29yZHMpCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbWJ1ZihjbHMsIGJ1ZiwgZW5jb2RpbmcsIGVycm9ycyk6CiAgICAgICAgIiIiQ29uc3RydWN0IGEgVGFySW5mbyBvYmplY3QgZnJvbSBhIDUxMiBieXRlIGJ5dGVzIG9iamVjdC4KICAgICAgICAiIiIKICAgICAgICBpZiBsZW4oYnVmKSA9PSAwOgogICAgICAgICAgICByYWlzZSBFbXB0eUhlYWRlckVycm9yKCJlbXB0eSBoZWFkZXIiKQogICAgICAgIGlmIGxlbihidWYpICE9IEJMT0NLU0laRToKICAgICAgICAgICAgcmFpc2UgVHJ1bmNhdGVkSGVhZGVyRXJyb3IoInRydW5jYXRlZCBoZWFkZXIiKQogICAgICAgIGlmIGJ1Zi5jb3VudChOVUwpID09IEJMT0NLU0laRToKICAgICAgICAgICAgcmFpc2UgRU9GSGVhZGVyRXJyb3IoImVuZCBvZiBmaWxlIGhlYWRlciIpCgogICAgICAgIGNoa3N1bSA9IG50aShidWZbMTQ4OjE1Nl0pCiAgICAgICAgaWYgY2hrc3VtIG5vdCBpbiBjYWxjX2Noa3N1bXMoYnVmKToKICAgICAgICAgICAgcmFpc2UgSW52YWxpZEhlYWRlckVycm9yKCJiYWQgY2hlY2tzdW0iKQoKICAgICAgICBvYmogPSBjbHMoKQogICAgICAgIG9iai5uYW1lID0gbnRzKGJ1ZlswOjEwMF0sIGVuY29kaW5nLCBlcnJvcnMpCiAgICAgICAgb2JqLm1vZGUgPSBudGkoYnVmWzEwMDoxMDhdKQogICAgICAgIG9iai51aWQgPSBudGkoYnVmWzEwODoxMTZdKQogICAgICAgIG9iai5naWQgPSBudGkoYnVmWzExNjoxMjRdKQogICAgICAgIG9iai5zaXplID0gbnRpKGJ1ZlsxMjQ6MTM2XSkKICAgICAgICBvYmoubXRpbWUgPSBudGkoYnVmWzEzNjoxNDhdKQogICAgICAgIG9iai5jaGtzdW0gPSBjaGtzdW0KICAgICAgICBvYmoudHlwZSA9IGJ1ZlsxNTY6MTU3XQogICAgICAgIG9iai5saW5rbmFtZSA9IG50cyhidWZbMTU3OjI1N10sIGVuY29kaW5nLCBlcnJvcnMpCiAgICAgICAgb2JqLnVuYW1lID0gbnRzKGJ1ZlsyNjU6Mjk3XSwgZW5jb2RpbmcsIGVycm9ycykKICAgICAgICBvYmouZ25hbWUgPSBudHMoYnVmWzI5NzozMjldLCBlbmNvZGluZywgZXJyb3JzKQogICAgICAgIG9iai5kZXZtYWpvciA9IG50aShidWZbMzI5OjMzN10pCiAgICAgICAgb2JqLmRldm1pbm9yID0gbnRpKGJ1ZlszMzc6MzQ1XSkKICAgICAgICBwcmVmaXggPSBudHMoYnVmWzM0NTo1MDBdLCBlbmNvZGluZywgZXJyb3JzKQoKICAgICAgICAjIE9sZCBWNyB0YXIgZm9ybWF0IHJlcHJlc2VudHMgYSBkaXJlY3RvcnkgYXMgYSByZWd1bGFyCiAgICAgICAgIyBmaWxlIHdpdGggYSB0cmFpbGluZyBzbGFzaC4KICAgICAgICBpZiBvYmoudHlwZSA9PSBBUkVHVFlQRSBhbmQgb2JqLm5hbWUuZW5kc3dpdGgoIi8iKToKICAgICAgICAgICAgb2JqLnR5cGUgPSBESVJUWVBFCgogICAgICAgICMgVGhlIG9sZCBHTlUgc3BhcnNlIGZvcm1hdCBvY2N1cGllcyBzb21lIG9mIHRoZSB1bnVzZWQKICAgICAgICAjIHNwYWNlIGluIHRoZSBidWZmZXIgZm9yIHVwIHRvIDQgc3BhcnNlIHN0cnVjdHVyZXMuCiAgICAgICAgIyBTYXZlIHRoZSB0aGVtIGZvciBsYXRlciBwcm9jZXNzaW5nIGluIF9wcm9jX3NwYXJzZSgpLgogICAgICAgIGlmIG9iai50eXBlID09IEdOVVRZUEVfU1BBUlNFOgogICAgICAgICAgICBwb3MgPSAzODYKICAgICAgICAgICAgc3RydWN0cyA9IFtdCiAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKDQpOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IG50aShidWZbcG9zOnBvcyArIDEyXSkKICAgICAgICAgICAgICAgICAgICBudW1ieXRlcyA9IG50aShidWZbcG9zICsgMTI6cG9zICsgMjRdKQogICAgICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIHN0cnVjdHMuYXBwZW5kKChvZmZzZXQsIG51bWJ5dGVzKSkKICAgICAgICAgICAgICAgIHBvcyArPSAyNAogICAgICAgICAgICBpc2V4dGVuZGVkID0gYm9vbChidWZbNDgyXSkKICAgICAgICAgICAgb3JpZ3NpemUgPSBudGkoYnVmWzQ4Mzo0OTVdKQogICAgICAgICAgICBvYmouX3NwYXJzZV9zdHJ1Y3RzID0gKHN0cnVjdHMsIGlzZXh0ZW5kZWQsIG9yaWdzaXplKQoKICAgICAgICAjIFJlbW92ZSByZWR1bmRhbnQgc2xhc2hlcyBmcm9tIGRpcmVjdG9yaWVzLgogICAgICAgIGlmIG9iai5pc2RpcigpOgogICAgICAgICAgICBvYmoubmFtZSA9IG9iai5uYW1lLnJzdHJpcCgiLyIpCgogICAgICAgICMgUmVjb25zdHJ1Y3QgYSB1c3RhciBsb25nbmFtZS4KICAgICAgICBpZiBwcmVmaXggYW5kIG9iai50eXBlIG5vdCBpbiBHTlVfVFlQRVM6CiAgICAgICAgICAgIG9iai5uYW1lID0gcHJlZml4ICsgIi8iICsgb2JqLm5hbWUKICAgICAgICByZXR1cm4gb2JqCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbXRhcmZpbGUoY2xzLCB0YXJmaWxlKToKICAgICAgICAiIiJSZXR1cm4gdGhlIG5leHQgVGFySW5mbyBvYmplY3QgZnJvbSBUYXJGaWxlIG9iamVjdAogICAgICAgICAgIHRhcmZpbGUuCiAgICAgICAgIiIiCiAgICAgICAgYnVmID0gdGFyZmlsZS5maWxlb2JqLnJlYWQoQkxPQ0tTSVpFKQogICAgICAgIG9iaiA9IGNscy5mcm9tYnVmKGJ1ZiwgdGFyZmlsZS5lbmNvZGluZywgdGFyZmlsZS5lcnJvcnMpCiAgICAgICAgb2JqLm9mZnNldCA9IHRhcmZpbGUuZmlsZW9iai50ZWxsKCkgLSBCTE9DS1NJWkUKICAgICAgICByZXR1cm4gb2JqLl9wcm9jX21lbWJlcih0YXJmaWxlKQoKICAgICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgIyBUaGUgZm9sbG93aW5nIGFyZSBtZXRob2RzIHRoYXQgYXJlIGNhbGxlZCBkZXBlbmRpbmcgb24gdGhlIHR5cGUgb2YgYQogICAgIyBtZW1iZXIuIFRoZSBlbnRyeSBwb2ludCBpcyBfcHJvY19tZW1iZXIoKSB3aGljaCBjYW4gYmUgb3ZlcnJpZGRlbiBpbiBhCiAgICAjIHN1YmNsYXNzIHRvIGFkZCBjdXN0b20gX3Byb2NfKigpIG1ldGhvZHMuIEEgX3Byb2NfKigpIG1ldGhvZCBNVVNUCiAgICAjIGltcGxlbWVudCB0aGUgZm9sbG93aW5nCiAgICAjIG9wZXJhdGlvbnM6CiAgICAjIDEuIFNldCBzZWxmLm9mZnNldF9kYXRhIHRvIHRoZSBwb3NpdGlvbiB3aGVyZSB0aGUgZGF0YSBibG9ja3MgYmVnaW4sCiAgICAjICAgIGlmIHRoZXJlIGlzIGRhdGEgdGhhdCBmb2xsb3dzLgogICAgIyAyLiBTZXQgdGFyZmlsZS5vZmZzZXQgdG8gdGhlIHBvc2l0aW9uIHdoZXJlIHRoZSBuZXh0IG1lbWJlcidzIGhlYWRlciB3aWxsCiAgICAjICAgIGJlZ2luLgogICAgIyAzLiBSZXR1cm4gc2VsZiBvciBhbm90aGVyIHZhbGlkIFRhckluZm8gb2JqZWN0LgogICAgZGVmIF9wcm9jX21lbWJlcihzZWxmLCB0YXJmaWxlKToKICAgICAgICAiIiJDaG9vc2UgdGhlIHJpZ2h0IHByb2Nlc3NpbmcgbWV0aG9kIGRlcGVuZGluZyBvbgogICAgICAgICAgIHRoZSB0eXBlIGFuZCBjYWxsIGl0LgogICAgICAgICIiIgogICAgICAgIGlmIHNlbGYudHlwZSBpbiAoR05VVFlQRV9MT05HTkFNRSwgR05VVFlQRV9MT05HTElOSyk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9wcm9jX2dudWxvbmcodGFyZmlsZSkKICAgICAgICBlbGlmIHNlbGYudHlwZSA9PSBHTlVUWVBFX1NQQVJTRToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX3Byb2Nfc3BhcnNlKHRhcmZpbGUpCiAgICAgICAgZWxpZiBzZWxmLnR5cGUgaW4gKFhIRFRZUEUsIFhHTFRZUEUsIFNPTEFSSVNfWEhEVFlQRSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9wcm9jX3BheCh0YXJmaWxlKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9wcm9jX2J1aWx0aW4odGFyZmlsZSkKCiAgICBkZWYgX3Byb2NfYnVpbHRpbihzZWxmLCB0YXJmaWxlKToKICAgICAgICAiIiJQcm9jZXNzIGEgYnVpbHRpbiB0eXBlIG9yIGFuIHVua25vd24gdHlwZSB3aGljaAogICAgICAgICAgIHdpbGwgYmUgdHJlYXRlZCBhcyBhIHJlZ3VsYXIgZmlsZS4KICAgICAgICAiIiIKICAgICAgICBzZWxmLm9mZnNldF9kYXRhID0gdGFyZmlsZS5maWxlb2JqLnRlbGwoKQogICAgICAgIG9mZnNldCA9IHNlbGYub2Zmc2V0X2RhdGEKICAgICAgICBpZiBzZWxmLmlzcmVnKCkgb3Igc2VsZi50eXBlIG5vdCBpbiBTVVBQT1JURURfVFlQRVM6CiAgICAgICAgICAgICMgU2tpcCB0aGUgZm9sbG93aW5nIGRhdGEgYmxvY2tzLgogICAgICAgICAgICBvZmZzZXQgKz0gc2VsZi5fYmxvY2soc2VsZi5zaXplKQogICAgICAgIHRhcmZpbGUub2Zmc2V0ID0gb2Zmc2V0CgogICAgICAgICMgUGF0Y2ggdGhlIFRhckluZm8gb2JqZWN0IHdpdGggc2F2ZWQgZ2xvYmFsCiAgICAgICAgIyBoZWFkZXIgaW5mb3JtYXRpb24uCiAgICAgICAgc2VsZi5fYXBwbHlfcGF4X2luZm8odGFyZmlsZS5wYXhfaGVhZGVycywgdGFyZmlsZS5lbmNvZGluZywgdGFyZmlsZS5lcnJvcnMpCgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9wcm9jX2dudWxvbmcoc2VsZiwgdGFyZmlsZSk6CiAgICAgICAgIiIiUHJvY2VzcyB0aGUgYmxvY2tzIHRoYXQgaG9sZCBhIEdOVSBsb25nbmFtZQogICAgICAgICAgIG9yIGxvbmdsaW5rIG1lbWJlci4KICAgICAgICAiIiIKICAgICAgICBidWYgPSB0YXJmaWxlLmZpbGVvYmoucmVhZChzZWxmLl9ibG9jayhzZWxmLnNpemUpKQoKICAgICAgICAjIEZldGNoIHRoZSBuZXh0IGhlYWRlciBhbmQgcHJvY2VzcyBpdC4KICAgICAgICB0cnk6CiAgICAgICAgICAgIG5leHQgPSBzZWxmLmZyb210YXJmaWxlKHRhcmZpbGUpCiAgICAgICAgZXhjZXB0IEhlYWRlckVycm9yOgogICAgICAgICAgICByYWlzZSBTdWJzZXF1ZW50SGVhZGVyRXJyb3IoIm1pc3Npbmcgb3IgYmFkIHN1YnNlcXVlbnQgaGVhZGVyIikKCiAgICAgICAgIyBQYXRjaCB0aGUgVGFySW5mbyBvYmplY3QgZnJvbSB0aGUgbmV4dCBoZWFkZXIgd2l0aAogICAgICAgICMgdGhlIGxvbmduYW1lIGluZm9ybWF0aW9uLgogICAgICAgIG5leHQub2Zmc2V0ID0gc2VsZi5vZmZzZXQKICAgICAgICBpZiBzZWxmLnR5cGUgPT0gR05VVFlQRV9MT05HTkFNRToKICAgICAgICAgICAgbmV4dC5uYW1lID0gbnRzKGJ1ZiwgdGFyZmlsZS5lbmNvZGluZywgdGFyZmlsZS5lcnJvcnMpCiAgICAgICAgZWxpZiBzZWxmLnR5cGUgPT0gR05VVFlQRV9MT05HTElOSzoKICAgICAgICAgICAgbmV4dC5saW5rbmFtZSA9IG50cyhidWYsIHRhcmZpbGUuZW5jb2RpbmcsIHRhcmZpbGUuZXJyb3JzKQoKICAgICAgICByZXR1cm4gbmV4dAoKICAgIGRlZiBfcHJvY19zcGFyc2Uoc2VsZiwgdGFyZmlsZSk6CiAgICAgICAgIiIiUHJvY2VzcyBhIEdOVSBzcGFyc2UgaGVhZGVyIHBsdXMgZXh0cmEgaGVhZGVycy4KICAgICAgICAiIiIKICAgICAgICAjIFdlIGFscmVhZHkgY29sbGVjdGVkIHNvbWUgc3BhcnNlIHN0cnVjdHVyZXMgaW4gZnJvbWJ1ZigpLgogICAgICAgIHN0cnVjdHMsIGlzZXh0ZW5kZWQsIG9yaWdzaXplID0gc2VsZi5fc3BhcnNlX3N0cnVjdHMKICAgICAgICBkZWwgc2VsZi5fc3BhcnNlX3N0cnVjdHMKCiAgICAgICAgIyBDb2xsZWN0IHNwYXJzZSBzdHJ1Y3R1cmVzIGZyb20gZXh0ZW5kZWQgaGVhZGVyIGJsb2Nrcy4KICAgICAgICB3aGlsZSBpc2V4dGVuZGVkOgogICAgICAgICAgICBidWYgPSB0YXJmaWxlLmZpbGVvYmoucmVhZChCTE9DS1NJWkUpCiAgICAgICAgICAgIHBvcyA9IDAKICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2UoMjEpOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IG50aShidWZbcG9zOnBvcyArIDEyXSkKICAgICAgICAgICAgICAgICAgICBudW1ieXRlcyA9IG50aShidWZbcG9zICsgMTI6cG9zICsgMjRdKQogICAgICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGlmIG9mZnNldCBhbmQgbnVtYnl0ZXM6CiAgICAgICAgICAgICAgICAgICAgc3RydWN0cy5hcHBlbmQoKG9mZnNldCwgbnVtYnl0ZXMpKQogICAgICAgICAgICAgICAgcG9zICs9IDI0CiAgICAgICAgICAgIGlzZXh0ZW5kZWQgPSBib29sKGJ1Zls1MDRdKQogICAgICAgIHNlbGYuc3BhcnNlID0gc3RydWN0cwoKICAgICAgICBzZWxmLm9mZnNldF9kYXRhID0gdGFyZmlsZS5maWxlb2JqLnRlbGwoKQogICAgICAgIHRhcmZpbGUub2Zmc2V0ID0gc2VsZi5vZmZzZXRfZGF0YSArIHNlbGYuX2Jsb2NrKHNlbGYuc2l6ZSkKICAgICAgICBzZWxmLnNpemUgPSBvcmlnc2l6ZQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9wcm9jX3BheChzZWxmLCB0YXJmaWxlKToKICAgICAgICAiIiJQcm9jZXNzIGFuIGV4dGVuZGVkIG9yIGdsb2JhbCBoZWFkZXIgYXMgZGVzY3JpYmVkIGluCiAgICAgICAgICAgUE9TSVguMS0yMDA4LgogICAgICAgICIiIgogICAgICAgICMgUmVhZCB0aGUgaGVhZGVyIGluZm9ybWF0aW9uLgogICAgICAgIGJ1ZiA9IHRhcmZpbGUuZmlsZW9iai5yZWFkKHNlbGYuX2Jsb2NrKHNlbGYuc2l6ZSkpCgogICAgICAgICMgQSBwYXggaGVhZGVyIHN0b3JlcyBzdXBwbGVtZW50YWwgaW5mb3JtYXRpb24gZm9yIGVpdGhlcgogICAgICAgICMgdGhlIGZvbGxvd2luZyBmaWxlIChleHRlbmRlZCkgb3IgYWxsIGZvbGxvd2luZyBmaWxlcwogICAgICAgICMgKGdsb2JhbCkuCiAgICAgICAgaWYgc2VsZi50eXBlID09IFhHTFRZUEU6CiAgICAgICAgICAgIHBheF9oZWFkZXJzID0gdGFyZmlsZS5wYXhfaGVhZGVycwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHBheF9oZWFkZXJzID0gdGFyZmlsZS5wYXhfaGVhZGVycy5jb3B5KCkKCiAgICAgICAgIyBDaGVjayBpZiB0aGUgcGF4IGhlYWRlciBjb250YWlucyBhIGhkcmNoYXJzZXQgZmllbGQuIFRoaXMgdGVsbHMgdXMKICAgICAgICAjIHRoZSBlbmNvZGluZyBvZiB0aGUgcGF0aCwgbGlua3BhdGgsIHVuYW1lIGFuZCBnbmFtZSBmaWVsZHMuIE5vcm1hbGx5LAogICAgICAgICMgdGhlc2UgZmllbGRzIGFyZSBVVEYtOCBlbmNvZGVkIGJ1dCBzaW5jZSBQT1NJWC4xLTIwMDggdGFyCiAgICAgICAgIyBpbXBsZW1lbnRhdGlvbnMgYXJlIGFsbG93ZWQgdG8gc3RvcmUgdGhlbSBhcyByYXcgYmluYXJ5IHN0cmluZ3MgaWYKICAgICAgICAjIHRoZSB0cmFuc2xhdGlvbiB0byBVVEYtOCBmYWlscy4KICAgICAgICBtYXRjaCA9IHJlLnNlYXJjaChiciJcZCsgaGRyY2hhcnNldD0oW15cbl0rKVxuIiwgYnVmKQogICAgICAgIGlmIG1hdGNoIGlzIG5vdCBOb25lOgogICAgICAgICAgICBwYXhfaGVhZGVyc1siaGRyY2hhcnNldCJdID0gbWF0Y2guZ3JvdXAoMSkuZGVjb2RlKCJ1dGYtOCIpCgogICAgICAgICMgRm9yIHRoZSB0aW1lIGJlaW5nLCB3ZSBkb24ndCBjYXJlIGFib3V0IGFueXRoaW5nIG90aGVyIHRoYW4gIkJJTkFSWSIuCiAgICAgICAgIyBUaGUgb25seSBvdGhlciB2YWx1ZSB0aGF0IGlzIGN1cnJlbnRseSBhbGxvd2VkIGJ5IHRoZSBzdGFuZGFyZCBpcwogICAgICAgICMgIklTTy1JUiAxMDY0NiAyMDAwIFVURi04IiBpbiBvdGhlciB3b3JkcyBVVEYtOC4KICAgICAgICBoZHJjaGFyc2V0ID0gcGF4X2hlYWRlcnMuZ2V0KCJoZHJjaGFyc2V0IikKICAgICAgICBpZiBoZHJjaGFyc2V0ID09ICJCSU5BUlkiOgogICAgICAgICAgICBlbmNvZGluZyA9IHRhcmZpbGUuZW5jb2RpbmcKICAgICAgICBlbHNlOgogICAgICAgICAgICBlbmNvZGluZyA9ICJ1dGYtOCIKCiAgICAgICAgIyBQYXJzZSBwYXggaGVhZGVyIGluZm9ybWF0aW9uLiBBIHJlY29yZCBsb29rcyBsaWtlIHRoYXQ6CiAgICAgICAgIyAiJWQgJXM9JXNcbiIgJSAobGVuZ3RoLCBrZXl3b3JkLCB2YWx1ZSkuIGxlbmd0aCBpcyB0aGUgc2l6ZQogICAgICAgICMgb2YgdGhlIGNvbXBsZXRlIHJlY29yZCBpbmNsdWRpbmcgdGhlIGxlbmd0aCBmaWVsZCBpdHNlbGYgYW5kCiAgICAgICAgIyB0aGUgbmV3bGluZS4ga2V5d29yZCBhbmQgdmFsdWUgYXJlIGJvdGggVVRGLTggZW5jb2RlZCBzdHJpbmdzLgogICAgICAgIHJlZ2V4ID0gcmUuY29tcGlsZShiciIoXGQrKSAoW149XSspPSIpCiAgICAgICAgcG9zID0gMAogICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgIG1hdGNoID0gcmVnZXgubWF0Y2goYnVmLCBwb3MpCiAgICAgICAgICAgIGlmIG5vdCBtYXRjaDoKICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICBsZW5ndGgsIGtleXdvcmQgPSBtYXRjaC5ncm91cHMoKQogICAgICAgICAgICBsZW5ndGggPSBpbnQobGVuZ3RoKQogICAgICAgICAgICB2YWx1ZSA9IGJ1ZlttYXRjaC5lbmQoMikgKyAxOm1hdGNoLnN0YXJ0KDEpICsgbGVuZ3RoIC0gMV0KCiAgICAgICAgICAgICMgTm9ybWFsbHksIHdlIGNvdWxkIGp1c3QgdXNlICJ1dGYtOCIgYXMgdGhlIGVuY29kaW5nIGFuZCAic3RyaWN0IgogICAgICAgICAgICAjIGFzIHRoZSBlcnJvciBoYW5kbGVyLCBidXQgd2UgYmV0dGVyIG5vdCB0YWtlIHRoZSByaXNrLiBGb3IKICAgICAgICAgICAgIyBleGFtcGxlLCBHTlUgdGFyIDw9IDEuMjMgaXMga25vd24gdG8gc3RvcmUgZmlsZW5hbWVzIGl0IGNhbm5vdAogICAgICAgICAgICAjIHRyYW5zbGF0ZSB0byBVVEYtOCBhcyByYXcgc3RyaW5ncyAodW5mb3J0dW5hdGVseSB3aXRob3V0IGEKICAgICAgICAgICAgIyBoZHJjaGFyc2V0PUJJTkFSWSBoZWFkZXIpLgogICAgICAgICAgICAjIFdlIGZpcnN0IHRyeSB0aGUgc3RyaWN0IHN0YW5kYXJkIGVuY29kaW5nLCBhbmQgaWYgdGhhdCBmYWlscyB3ZQogICAgICAgICAgICAjIGZhbGwgYmFjayBvbiB0aGUgdXNlcidzIGVuY29kaW5nIGFuZCBlcnJvciBoYW5kbGVyLgogICAgICAgICAgICBrZXl3b3JkID0gc2VsZi5fZGVjb2RlX3BheF9maWVsZChrZXl3b3JkLCAidXRmLTgiLCAidXRmLTgiLAogICAgICAgICAgICAgICAgICAgIHRhcmZpbGUuZXJyb3JzKQogICAgICAgICAgICBpZiBrZXl3b3JkIGluIFBBWF9OQU1FX0ZJRUxEUzoKICAgICAgICAgICAgICAgIHZhbHVlID0gc2VsZi5fZGVjb2RlX3BheF9maWVsZCh2YWx1ZSwgZW5jb2RpbmcsIHRhcmZpbGUuZW5jb2RpbmcsCiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmZpbGUuZXJyb3JzKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdmFsdWUgPSBzZWxmLl9kZWNvZGVfcGF4X2ZpZWxkKHZhbHVlLCAidXRmLTgiLCAidXRmLTgiLAogICAgICAgICAgICAgICAgICAgICAgICB0YXJmaWxlLmVycm9ycykKCiAgICAgICAgICAgIHBheF9oZWFkZXJzW2tleXdvcmRdID0gdmFsdWUKICAgICAgICAgICAgcG9zICs9IGxlbmd0aAoKICAgICAgICAjIEZldGNoIHRoZSBuZXh0IGhlYWRlci4KICAgICAgICB0cnk6CiAgICAgICAgICAgIG5leHQgPSBzZWxmLmZyb210YXJmaWxlKHRhcmZpbGUpCiAgICAgICAgZXhjZXB0IEhlYWRlckVycm9yOgogICAgICAgICAgICByYWlzZSBTdWJzZXF1ZW50SGVhZGVyRXJyb3IoIm1pc3Npbmcgb3IgYmFkIHN1YnNlcXVlbnQgaGVhZGVyIikKCiAgICAgICAgIyBQcm9jZXNzIEdOVSBzcGFyc2UgaW5mb3JtYXRpb24uCiAgICAgICAgaWYgIkdOVS5zcGFyc2UubWFwIiBpbiBwYXhfaGVhZGVyczoKICAgICAgICAgICAgIyBHTlUgZXh0ZW5kZWQgc3BhcnNlIGZvcm1hdCB2ZXJzaW9uIDAuMS4KICAgICAgICAgICAgc2VsZi5fcHJvY19nbnVzcGFyc2VfMDEobmV4dCwgcGF4X2hlYWRlcnMpCgogICAgICAgIGVsaWYgIkdOVS5zcGFyc2Uuc2l6ZSIgaW4gcGF4X2hlYWRlcnM6CiAgICAgICAgICAgICMgR05VIGV4dGVuZGVkIHNwYXJzZSBmb3JtYXQgdmVyc2lvbiAwLjAuCiAgICAgICAgICAgIHNlbGYuX3Byb2NfZ251c3BhcnNlXzAwKG5leHQsIHBheF9oZWFkZXJzLCBidWYpCgogICAgICAgIGVsaWYgcGF4X2hlYWRlcnMuZ2V0KCJHTlUuc3BhcnNlLm1ham9yIikgPT0gIjEiIGFuZCBwYXhfaGVhZGVycy5nZXQoIkdOVS5zcGFyc2UubWlub3IiKSA9PSAiMCI6CiAgICAgICAgICAgICMgR05VIGV4dGVuZGVkIHNwYXJzZSBmb3JtYXQgdmVyc2lvbiAxLjAuCiAgICAgICAgICAgIHNlbGYuX3Byb2NfZ251c3BhcnNlXzEwKG5leHQsIHBheF9oZWFkZXJzLCB0YXJmaWxlKQoKICAgICAgICBpZiBzZWxmLnR5cGUgaW4gKFhIRFRZUEUsIFNPTEFSSVNfWEhEVFlQRSk6CiAgICAgICAgICAgICMgUGF0Y2ggdGhlIFRhckluZm8gb2JqZWN0IHdpdGggdGhlIGV4dGVuZGVkIGhlYWRlciBpbmZvLgogICAgICAgICAgICBuZXh0Ll9hcHBseV9wYXhfaW5mbyhwYXhfaGVhZGVycywgdGFyZmlsZS5lbmNvZGluZywgdGFyZmlsZS5lcnJvcnMpCiAgICAgICAgICAgIG5leHQub2Zmc2V0ID0gc2VsZi5vZmZzZXQKCiAgICAgICAgICAgIGlmICJzaXplIiBpbiBwYXhfaGVhZGVyczoKICAgICAgICAgICAgICAgICMgSWYgdGhlIGV4dGVuZGVkIGhlYWRlciByZXBsYWNlcyB0aGUgc2l6ZSBmaWVsZCwKICAgICAgICAgICAgICAgICMgd2UgbmVlZCB0byByZWNhbGN1bGF0ZSB0aGUgb2Zmc2V0IHdoZXJlIHRoZSBuZXh0CiAgICAgICAgICAgICAgICAjIGhlYWRlciBzdGFydHMuCiAgICAgICAgICAgICAgICBvZmZzZXQgPSBuZXh0Lm9mZnNldF9kYXRhCiAgICAgICAgICAgICAgICBpZiBuZXh0LmlzcmVnKCkgb3IgbmV4dC50eXBlIG5vdCBpbiBTVVBQT1JURURfVFlQRVM6CiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IG5leHQuX2Jsb2NrKG5leHQuc2l6ZSkKICAgICAgICAgICAgICAgIHRhcmZpbGUub2Zmc2V0ID0gb2Zmc2V0CgogICAgICAgIHJldHVybiBuZXh0CgogICAgZGVmIF9wcm9jX2dudXNwYXJzZV8wMChzZWxmLCBuZXh0LCBwYXhfaGVhZGVycywgYnVmKToKICAgICAgICAiIiJQcm9jZXNzIGEgR05VIHRhciBleHRlbmRlZCBzcGFyc2UgaGVhZGVyLCB2ZXJzaW9uIDAuMC4KICAgICAgICAiIiIKICAgICAgICBvZmZzZXRzID0gW10KICAgICAgICBmb3IgbWF0Y2ggaW4gcmUuZmluZGl0ZXIoYnIiXGQrIEdOVS5zcGFyc2Uub2Zmc2V0PShcZCspXG4iLCBidWYpOgogICAgICAgICAgICBvZmZzZXRzLmFwcGVuZChpbnQobWF0Y2guZ3JvdXAoMSkpKQogICAgICAgIG51bWJ5dGVzID0gW10KICAgICAgICBmb3IgbWF0Y2ggaW4gcmUuZmluZGl0ZXIoYnIiXGQrIEdOVS5zcGFyc2UubnVtYnl0ZXM9KFxkKylcbiIsIGJ1Zik6CiAgICAgICAgICAgIG51bWJ5dGVzLmFwcGVuZChpbnQobWF0Y2guZ3JvdXAoMSkpKQogICAgICAgIG5leHQuc3BhcnNlID0gbGlzdCh6aXAob2Zmc2V0cywgbnVtYnl0ZXMpKQoKICAgIGRlZiBfcHJvY19nbnVzcGFyc2VfMDEoc2VsZiwgbmV4dCwgcGF4X2hlYWRlcnMpOgogICAgICAgICIiIlByb2Nlc3MgYSBHTlUgdGFyIGV4dGVuZGVkIHNwYXJzZSBoZWFkZXIsIHZlcnNpb24gMC4xLgogICAgICAgICIiIgogICAgICAgIHNwYXJzZSA9IFtpbnQoeCkgZm9yIHggaW4gcGF4X2hlYWRlcnNbIkdOVS5zcGFyc2UubWFwIl0uc3BsaXQoIiwiKV0KICAgICAgICBuZXh0LnNwYXJzZSA9IGxpc3QoemlwKHNwYXJzZVs6OjJdLCBzcGFyc2VbMTo6Ml0pKQoKICAgIGRlZiBfcHJvY19nbnVzcGFyc2VfMTAoc2VsZiwgbmV4dCwgcGF4X2hlYWRlcnMsIHRhcmZpbGUpOgogICAgICAgICIiIlByb2Nlc3MgYSBHTlUgdGFyIGV4dGVuZGVkIHNwYXJzZSBoZWFkZXIsIHZlcnNpb24gMS4wLgogICAgICAgICIiIgogICAgICAgIGZpZWxkcyA9IE5vbmUKICAgICAgICBzcGFyc2UgPSBbXQogICAgICAgIGJ1ZiA9IHRhcmZpbGUuZmlsZW9iai5yZWFkKEJMT0NLU0laRSkKICAgICAgICBmaWVsZHMsIGJ1ZiA9IGJ1Zi5zcGxpdChiIlxuIiwgMSkKICAgICAgICBmaWVsZHMgPSBpbnQoZmllbGRzKQogICAgICAgIHdoaWxlIGxlbihzcGFyc2UpIDwgZmllbGRzICogMjoKICAgICAgICAgICAgaWYgYiJcbiIgbm90IGluIGJ1ZjoKICAgICAgICAgICAgICAgIGJ1ZiArPSB0YXJmaWxlLmZpbGVvYmoucmVhZChCTE9DS1NJWkUpCiAgICAgICAgICAgIG51bWJlciwgYnVmID0gYnVmLnNwbGl0KGIiXG4iLCAxKQogICAgICAgICAgICBzcGFyc2UuYXBwZW5kKGludChudW1iZXIpKQogICAgICAgIG5leHQub2Zmc2V0X2RhdGEgPSB0YXJmaWxlLmZpbGVvYmoudGVsbCgpCiAgICAgICAgbmV4dC5zcGFyc2UgPSBsaXN0KHppcChzcGFyc2VbOjoyXSwgc3BhcnNlWzE6OjJdKSkKCiAgICBkZWYgX2FwcGx5X3BheF9pbmZvKHNlbGYsIHBheF9oZWFkZXJzLCBlbmNvZGluZywgZXJyb3JzKToKICAgICAgICAiIiJSZXBsYWNlIGZpZWxkcyB3aXRoIHN1cHBsZW1lbnRhbCBpbmZvcm1hdGlvbiBmcm9tIGEgcHJldmlvdXMKICAgICAgICAgICBwYXggZXh0ZW5kZWQgb3IgZ2xvYmFsIGhlYWRlci4KICAgICAgICAiIiIKICAgICAgICBmb3Iga2V5d29yZCwgdmFsdWUgaW4gcGF4X2hlYWRlcnMuaXRlbXMoKToKICAgICAgICAgICAgaWYga2V5d29yZCA9PSAiR05VLnNwYXJzZS5uYW1lIjoKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZiwgInBhdGgiLCB2YWx1ZSkKICAgICAgICAgICAgZWxpZiBrZXl3b3JkID09ICJHTlUuc3BhcnNlLnNpemUiOgogICAgICAgICAgICAgICAgc2V0YXR0cihzZWxmLCAic2l6ZSIsIGludCh2YWx1ZSkpCiAgICAgICAgICAgIGVsaWYga2V5d29yZCA9PSAiR05VLnNwYXJzZS5yZWFsc2l6ZSI6CiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsICJzaXplIiwgaW50KHZhbHVlKSkKICAgICAgICAgICAgZWxpZiBrZXl3b3JkIGluIFBBWF9GSUVMRFM6CiAgICAgICAgICAgICAgICBpZiBrZXl3b3JkIGluIFBBWF9OVU1CRVJfRklFTERTOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBQQVhfTlVNQkVSX0ZJRUxEU1trZXl3b3JkXSh2YWx1ZSkKICAgICAgICAgICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAwCiAgICAgICAgICAgICAgICBpZiBrZXl3b3JkID09ICJwYXRoIjoKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJzdHJpcCgiLyIpCiAgICAgICAgICAgICAgICBzZXRhdHRyKHNlbGYsIGtleXdvcmQsIHZhbHVlKQoKICAgICAgICBzZWxmLnBheF9oZWFkZXJzID0gcGF4X2hlYWRlcnMuY29weSgpCgogICAgZGVmIF9kZWNvZGVfcGF4X2ZpZWxkKHNlbGYsIHZhbHVlLCBlbmNvZGluZywgZmFsbGJhY2tfZW5jb2RpbmcsIGZhbGxiYWNrX2Vycm9ycyk6CiAgICAgICAgIiIiRGVjb2RlIGEgc2luZ2xlIGZpZWxkIGZyb20gYSBwYXggcmVjb3JkLgogICAgICAgICIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgcmV0dXJuIHZhbHVlLmRlY29kZShlbmNvZGluZywgInN0cmljdCIpCiAgICAgICAgZXhjZXB0IFVuaWNvZGVEZWNvZGVFcnJvcjoKICAgICAgICAgICAgcmV0dXJuIHZhbHVlLmRlY29kZShmYWxsYmFja19lbmNvZGluZywgZmFsbGJhY2tfZXJyb3JzKQoKICAgIGRlZiBfYmxvY2soc2VsZiwgY291bnQpOgogICAgICAgICIiIlJvdW5kIHVwIGEgYnl0ZSBjb3VudCBieSBCTE9DS1NJWkUgYW5kIHJldHVybiBpdCwKICAgICAgICAgICBlLmcuIF9ibG9jayg4MzQpID0+IDEwMjQuCiAgICAgICAgIiIiCiAgICAgICAgYmxvY2tzLCByZW1haW5kZXIgPSBkaXZtb2QoY291bnQsIEJMT0NLU0laRSkKICAgICAgICBpZiByZW1haW5kZXI6CiAgICAgICAgICAgIGJsb2NrcyArPSAxCiAgICAgICAgcmV0dXJuIGJsb2NrcyAqIEJMT0NLU0laRQoKICAgIGRlZiBpc3JlZyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi50eXBlIGluIFJFR1VMQVJfVFlQRVMKICAgIGRlZiBpc2ZpbGUoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuaXNyZWcoKQogICAgZGVmIGlzZGlyKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLnR5cGUgPT0gRElSVFlQRQogICAgZGVmIGlzc3ltKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLnR5cGUgPT0gU1lNVFlQRQogICAgZGVmIGlzbG5rKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLnR5cGUgPT0gTE5LVFlQRQogICAgZGVmIGlzY2hyKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLnR5cGUgPT0gQ0hSVFlQRQogICAgZGVmIGlzYmxrKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLnR5cGUgPT0gQkxLVFlQRQogICAgZGVmIGlzZmlmbyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi50eXBlID09IEZJRk9UWVBFCiAgICBkZWYgaXNzcGFyc2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuc3BhcnNlIGlzIG5vdCBOb25lCiAgICBkZWYgaXNkZXYoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYudHlwZSBpbiAoQ0hSVFlQRSwgQkxLVFlQRSwgRklGT1RZUEUpCiMgY2xhc3MgVGFySW5mbwoKY2xhc3MgVGFyRmlsZShvYmplY3QpOgogICAgIiIiVGhlIFRhckZpbGUgQ2xhc3MgcHJvdmlkZXMgYW4gaW50ZXJmYWNlIHRvIHRhciBhcmNoaXZlcy4KICAgICIiIgoKICAgIGRlYnVnID0gMCAgICAgICAgICAgICAgICAgICAjIE1heSBiZSBzZXQgZnJvbSAwIChubyBtc2dzKSB0byAzIChhbGwgbXNncykKCiAgICBkZXJlZmVyZW5jZSA9IEZhbHNlICAgICAgICAgIyBJZiB0cnVlLCBhZGQgY29udGVudCBvZiBsaW5rZWQgZmlsZSB0byB0aGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHRhciBmaWxlLCBlbHNlIHRoZSBsaW5rLgoKICAgIGlnbm9yZV96ZXJvcyA9IEZhbHNlICAgICAgICAjIElmIHRydWUsIHNraXBzIGVtcHR5IG9yIGludmFsaWQgYmxvY2tzIGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgY29udGludWVzIHByb2Nlc3NpbmcuCgogICAgZXJyb3JsZXZlbCA9IDEgICAgICAgICAgICAgICMgSWYgMCwgZmF0YWwgZXJyb3JzIG9ubHkgYXBwZWFyIGluIGRlYnVnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBtZXNzYWdlcyAoaWYgZGVidWcgPj0gMCkuIElmID4gMCwgZXJyb3JzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBhcmUgcGFzc2VkIHRvIHRoZSBjYWxsZXIgYXMgZXhjZXB0aW9ucy4KCiAgICBmb3JtYXQgPSBERUZBVUxUX0ZPUk1BVCAgICAgIyBUaGUgZm9ybWF0IHRvIHVzZSB3aGVuIGNyZWF0aW5nIGFuIGFyY2hpdmUuCgogICAgZW5jb2RpbmcgPSBFTkNPRElORyAgICAgICAgICMgRW5jb2RpbmcgZm9yIDgtYml0IGNoYXJhY3RlciBzdHJpbmdzLgoKICAgIGVycm9ycyA9IE5vbmUgICAgICAgICAgICAgICAjIEVycm9yIGhhbmRsZXIgZm9yIHVuaWNvZGUgY29udmVyc2lvbi4KCiAgICB0YXJpbmZvID0gVGFySW5mbyAgICAgICAgICAgIyBUaGUgZGVmYXVsdCBUYXJJbmZvIGNsYXNzIHRvIHVzZS4KCiAgICBmaWxlb2JqZWN0ID0gRXhGaWxlT2JqZWN0ICAgIyBUaGUgZmlsZS1vYmplY3QgZm9yIGV4dHJhY3RmaWxlKCkuCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG5hbWU9Tm9uZSwgbW9kZT0iciIsIGZpbGVvYmo9Tm9uZSwgZm9ybWF0PU5vbmUsCiAgICAgICAgICAgIHRhcmluZm89Tm9uZSwgZGVyZWZlcmVuY2U9Tm9uZSwgaWdub3JlX3plcm9zPU5vbmUsIGVuY29kaW5nPU5vbmUsCiAgICAgICAgICAgIGVycm9ycz0ic3Vycm9nYXRlZXNjYXBlIiwgcGF4X2hlYWRlcnM9Tm9uZSwgZGVidWc9Tm9uZSwgZXJyb3JsZXZlbD1Ob25lKToKICAgICAgICAiIiJPcGVuIGFuICh1bmNvbXByZXNzZWQpIHRhciBhcmNoaXZlIGBuYW1lJy4gYG1vZGUnIGlzIGVpdGhlciAncicgdG8KICAgICAgICAgICByZWFkIGZyb20gYW4gZXhpc3RpbmcgYXJjaGl2ZSwgJ2EnIHRvIGFwcGVuZCBkYXRhIHRvIGFuIGV4aXN0aW5nCiAgICAgICAgICAgZmlsZSBvciAndycgdG8gY3JlYXRlIGEgbmV3IGZpbGUgb3ZlcndyaXRpbmcgYW4gZXhpc3Rpbmcgb25lLiBgbW9kZScKICAgICAgICAgICBkZWZhdWx0cyB0byAncicuCiAgICAgICAgICAgSWYgYGZpbGVvYmonIGlzIGdpdmVuLCBpdCBpcyB1c2VkIGZvciByZWFkaW5nIG9yIHdyaXRpbmcgZGF0YS4gSWYgaXQKICAgICAgICAgICBjYW4gYmUgZGV0ZXJtaW5lZCwgYG1vZGUnIGlzIG92ZXJyaWRkZW4gYnkgYGZpbGVvYmoncyBtb2RlLgogICAgICAgICAgIGBmaWxlb2JqJyBpcyBub3QgY2xvc2VkLCB3aGVuIFRhckZpbGUgaXMgY2xvc2VkLgogICAgICAgICIiIgogICAgICAgIGlmIGxlbihtb2RlKSA+IDEgb3IgbW9kZSBub3QgaW4gInJhdyI6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIm1vZGUgbXVzdCBiZSAncicsICdhJyBvciAndyciKQogICAgICAgIHNlbGYubW9kZSA9IG1vZGUKICAgICAgICBzZWxmLl9tb2RlID0geyJyIjogInJiIiwgImEiOiAicitiIiwgInciOiAid2IifVttb2RlXQoKICAgICAgICBpZiBub3QgZmlsZW9iajoKICAgICAgICAgICAgaWYgc2VsZi5tb2RlID09ICJhIiBhbmQgbm90IG9zLnBhdGguZXhpc3RzKG5hbWUpOgogICAgICAgICAgICAgICAgIyBDcmVhdGUgbm9uZXhpc3RlbnQgZmlsZXMgaW4gYXBwZW5kIG1vZGUuCiAgICAgICAgICAgICAgICBzZWxmLm1vZGUgPSAidyIKICAgICAgICAgICAgICAgIHNlbGYuX21vZGUgPSAid2IiCiAgICAgICAgICAgIGZpbGVvYmogPSBibHRuX29wZW4obmFtZSwgc2VsZi5fbW9kZSkKICAgICAgICAgICAgc2VsZi5fZXh0ZmlsZW9iaiA9IEZhbHNlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgbmFtZSBpcyBOb25lIGFuZCBoYXNhdHRyKGZpbGVvYmosICJuYW1lIik6CiAgICAgICAgICAgICAgICBuYW1lID0gZmlsZW9iai5uYW1lCiAgICAgICAgICAgIGlmIGhhc2F0dHIoZmlsZW9iaiwgIm1vZGUiKToKICAgICAgICAgICAgICAgIHNlbGYuX21vZGUgPSBmaWxlb2JqLm1vZGUKICAgICAgICAgICAgc2VsZi5fZXh0ZmlsZW9iaiA9IFRydWUKICAgICAgICBzZWxmLm5hbWUgPSBvcy5wYXRoLmFic3BhdGgobmFtZSkgaWYgbmFtZSBlbHNlIE5vbmUKICAgICAgICBzZWxmLmZpbGVvYmogPSBmaWxlb2JqCgogICAgICAgICMgSW5pdCBhdHRyaWJ1dGVzLgogICAgICAgIGlmIGZvcm1hdCBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5mb3JtYXQgPSBmb3JtYXQKICAgICAgICBpZiB0YXJpbmZvIGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLnRhcmluZm8gPSB0YXJpbmZvCiAgICAgICAgaWYgZGVyZWZlcmVuY2UgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHNlbGYuZGVyZWZlcmVuY2UgPSBkZXJlZmVyZW5jZQogICAgICAgIGlmIGlnbm9yZV96ZXJvcyBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5pZ25vcmVfemVyb3MgPSBpZ25vcmVfemVyb3MKICAgICAgICBpZiBlbmNvZGluZyBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5lbmNvZGluZyA9IGVuY29kaW5nCiAgICAgICAgc2VsZi5lcnJvcnMgPSBlcnJvcnMKCiAgICAgICAgaWYgcGF4X2hlYWRlcnMgaXMgbm90IE5vbmUgYW5kIHNlbGYuZm9ybWF0ID09IFBBWF9GT1JNQVQ6CiAgICAgICAgICAgIHNlbGYucGF4X2hlYWRlcnMgPSBwYXhfaGVhZGVycwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYucGF4X2hlYWRlcnMgPSB7fQoKICAgICAgICBpZiBkZWJ1ZyBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5kZWJ1ZyA9IGRlYnVnCiAgICAgICAgaWYgZXJyb3JsZXZlbCBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5lcnJvcmxldmVsID0gZXJyb3JsZXZlbAoKICAgICAgICAjIEluaXQgZGF0YXN0cnVjdHVyZXMuCiAgICAgICAgc2VsZi5jbG9zZWQgPSBGYWxzZQogICAgICAgIHNlbGYubWVtYmVycyA9IFtdICAgICAgICMgbGlzdCBvZiBtZW1iZXJzIGFzIFRhckluZm8gb2JqZWN0cwogICAgICAgIHNlbGYuX2xvYWRlZCA9IEZhbHNlICAgICMgZmxhZyBpZiBhbGwgbWVtYmVycyBoYXZlIGJlZW4gcmVhZAogICAgICAgIHNlbGYub2Zmc2V0ID0gc2VsZi5maWxlb2JqLnRlbGwoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgY3VycmVudCBwb3NpdGlvbiBpbiB0aGUgYXJjaGl2ZSBmaWxlCiAgICAgICAgc2VsZi5pbm9kZXMgPSB7fSAgICAgICAgIyBkaWN0aW9uYXJ5IGNhY2hpbmcgdGhlIGlub2RlcyBvZgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgYXJjaGl2ZSBtZW1iZXJzIGFscmVhZHkgYWRkZWQKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBzZWxmLm1vZGUgPT0gInIiOgogICAgICAgICAgICAgICAgc2VsZi5maXJzdG1lbWJlciA9IE5vbmUKICAgICAgICAgICAgICAgIHNlbGYuZmlyc3RtZW1iZXIgPSBzZWxmLm5leHQoKQoKICAgICAgICAgICAgaWYgc2VsZi5tb2RlID09ICJhIjoKICAgICAgICAgICAgICAgICMgTW92ZSB0byB0aGUgZW5kIG9mIHRoZSBhcmNoaXZlLAogICAgICAgICAgICAgICAgIyBiZWZvcmUgdGhlIGZpcnN0IGVtcHR5IGJsb2NrLgogICAgICAgICAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgICAgICAgICBzZWxmLmZpbGVvYmouc2VlayhzZWxmLm9mZnNldCkKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmluZm8gPSBzZWxmLnRhcmluZm8uZnJvbXRhcmZpbGUoc2VsZikKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5tZW1iZXJzLmFwcGVuZCh0YXJpbmZvKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFT0ZIZWFkZXJFcnJvcjoKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5maWxlb2JqLnNlZWsoc2VsZi5vZmZzZXQpCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEhlYWRlckVycm9yIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgICAgIHJhaXNlIFJlYWRFcnJvcihzdHIoZSkpCgogICAgICAgICAgICBpZiBzZWxmLm1vZGUgaW4gImF3IjoKICAgICAgICAgICAgICAgIHNlbGYuX2xvYWRlZCA9IFRydWUKCiAgICAgICAgICAgICAgICBpZiBzZWxmLnBheF9oZWFkZXJzOgogICAgICAgICAgICAgICAgICAgIGJ1ZiA9IHNlbGYudGFyaW5mby5jcmVhdGVfcGF4X2dsb2JhbF9oZWFkZXIoc2VsZi5wYXhfaGVhZGVycy5jb3B5KCkpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5maWxlb2JqLndyaXRlKGJ1ZikKICAgICAgICAgICAgICAgICAgICBzZWxmLm9mZnNldCArPSBsZW4oYnVmKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgaWYgbm90IHNlbGYuX2V4dGZpbGVvYmo6CiAgICAgICAgICAgICAgICBzZWxmLmZpbGVvYmouY2xvc2UoKQogICAgICAgICAgICBzZWxmLmNsb3NlZCA9IFRydWUKICAgICAgICAgICAgcmFpc2UKCiAgICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICMgQmVsb3cgYXJlIHRoZSBjbGFzc21ldGhvZHMgd2hpY2ggYWN0IGFzIGFsdGVybmF0ZSBjb25zdHJ1Y3RvcnMgdG8gdGhlCiAgICAjIFRhckZpbGUgY2xhc3MuIFRoZSBvcGVuKCkgbWV0aG9kIGlzIHRoZSBvbmx5IG9uZSB0aGF0IGlzIG5lZWRlZCBmb3IKICAgICMgcHVibGljIHVzZTsgaXQgaXMgdGhlICJzdXBlciItY29uc3RydWN0b3IgYW5kIGlzIGFibGUgdG8gc2VsZWN0IGFuCiAgICAjIGFkZXF1YXRlICJzdWIiLWNvbnN0cnVjdG9yIGZvciBhIHBhcnRpY3VsYXIgY29tcHJlc3Npb24gdXNpbmcgdGhlIG1hcHBpbmcKICAgICMgZnJvbSBPUEVOX01FVEguCiAgICAjCiAgICAjIFRoaXMgY29uY2VwdCBhbGxvd3Mgb25lIHRvIHN1YmNsYXNzIFRhckZpbGUgd2l0aG91dCBsb3NpbmcgdGhlIGNvbWZvcnQgb2YKICAgICMgdGhlIHN1cGVyLWNvbnN0cnVjdG9yLiBBIHN1Yi1jb25zdHJ1Y3RvciBpcyByZWdpc3RlcmVkIGFuZCBtYWRlIGF2YWlsYWJsZQogICAgIyBieSBhZGRpbmcgaXQgdG8gdGhlIG1hcHBpbmcgaW4gT1BFTl9NRVRILgoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIG9wZW4oY2xzLCBuYW1lPU5vbmUsIG1vZGU9InIiLCBmaWxlb2JqPU5vbmUsIGJ1ZnNpemU9UkVDT1JEU0laRSwgKiprd2FyZ3MpOgogICAgICAgICIiIk9wZW4gYSB0YXIgYXJjaGl2ZSBmb3IgcmVhZGluZywgd3JpdGluZyBvciBhcHBlbmRpbmcuIFJldHVybgogICAgICAgICAgIGFuIGFwcHJvcHJpYXRlIFRhckZpbGUgY2xhc3MuCgogICAgICAgICAgIG1vZGU6CiAgICAgICAgICAgJ3InIG9yICdyOionIG9wZW4gZm9yIHJlYWRpbmcgd2l0aCB0cmFuc3BhcmVudCBjb21wcmVzc2lvbgogICAgICAgICAgICdyOicgICAgICAgICBvcGVuIGZvciByZWFkaW5nIGV4Y2x1c2l2ZWx5IHVuY29tcHJlc3NlZAogICAgICAgICAgICdyOmd6JyAgICAgICBvcGVuIGZvciByZWFkaW5nIHdpdGggZ3ppcCBjb21wcmVzc2lvbgogICAgICAgICAgICdyOmJ6MicgICAgICBvcGVuIGZvciByZWFkaW5nIHdpdGggYnppcDIgY29tcHJlc3Npb24KICAgICAgICAgICAncjp4eicgICAgICAgb3BlbiBmb3IgcmVhZGluZyB3aXRoIGx6bWEgY29tcHJlc3Npb24KICAgICAgICAgICAnYScgb3IgJ2E6JyAgb3BlbiBmb3IgYXBwZW5kaW5nLCBjcmVhdGluZyB0aGUgZmlsZSBpZiBuZWNlc3NhcnkKICAgICAgICAgICAndycgb3IgJ3c6JyAgb3BlbiBmb3Igd3JpdGluZyB3aXRob3V0IGNvbXByZXNzaW9uCiAgICAgICAgICAgJ3c6Z3onICAgICAgIG9wZW4gZm9yIHdyaXRpbmcgd2l0aCBnemlwIGNvbXByZXNzaW9uCiAgICAgICAgICAgJ3c6YnoyJyAgICAgIG9wZW4gZm9yIHdyaXRpbmcgd2l0aCBiemlwMiBjb21wcmVzc2lvbgogICAgICAgICAgICd3Onh6JyAgICAgICBvcGVuIGZvciB3cml0aW5nIHdpdGggbHptYSBjb21wcmVzc2lvbgoKICAgICAgICAgICAncnwqJyAgICAgICAgb3BlbiBhIHN0cmVhbSBvZiB0YXIgYmxvY2tzIHdpdGggdHJhbnNwYXJlbnQgY29tcHJlc3Npb24KICAgICAgICAgICAncnwnICAgICAgICAgb3BlbiBhbiB1bmNvbXByZXNzZWQgc3RyZWFtIG9mIHRhciBibG9ja3MgZm9yIHJlYWRpbmcKICAgICAgICAgICAncnxneicgICAgICAgb3BlbiBhIGd6aXAgY29tcHJlc3NlZCBzdHJlYW0gb2YgdGFyIGJsb2NrcwogICAgICAgICAgICdyfGJ6MicgICAgICBvcGVuIGEgYnppcDIgY29tcHJlc3NlZCBzdHJlYW0gb2YgdGFyIGJsb2NrcwogICAgICAgICAgICdyfHh6JyAgICAgICBvcGVuIGFuIGx6bWEgY29tcHJlc3NlZCBzdHJlYW0gb2YgdGFyIGJsb2NrcwogICAgICAgICAgICd3fCcgICAgICAgICBvcGVuIGFuIHVuY29tcHJlc3NlZCBzdHJlYW0gZm9yIHdyaXRpbmcKICAgICAgICAgICAnd3xneicgICAgICAgb3BlbiBhIGd6aXAgY29tcHJlc3NlZCBzdHJlYW0gZm9yIHdyaXRpbmcKICAgICAgICAgICAnd3xiejInICAgICAgb3BlbiBhIGJ6aXAyIGNvbXByZXNzZWQgc3RyZWFtIGZvciB3cml0aW5nCiAgICAgICAgICAgJ3d8eHonICAgICAgIG9wZW4gYW4gbHptYSBjb21wcmVzc2VkIHN0cmVhbSBmb3Igd3JpdGluZwogICAgICAgICIiIgoKICAgICAgICBpZiBub3QgbmFtZSBhbmQgbm90IGZpbGVvYmo6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIm5vdGhpbmcgdG8gb3BlbiIpCgogICAgICAgIGlmIG1vZGUgaW4gKCJyIiwgInI6KiIpOgogICAgICAgICAgICAjIEZpbmQgb3V0IHdoaWNoICpvcGVuKCkgaXMgYXBwcm9wcmlhdGUgZm9yIG9wZW5pbmcgdGhlIGZpbGUuCiAgICAgICAgICAgIGZvciBjb21wdHlwZSBpbiBjbHMuT1BFTl9NRVRIOgogICAgICAgICAgICAgICAgZnVuYyA9IGdldGF0dHIoY2xzLCBjbHMuT1BFTl9NRVRIW2NvbXB0eXBlXSkKICAgICAgICAgICAgICAgIGlmIGZpbGVvYmogaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgc2F2ZWRfcG9zID0gZmlsZW9iai50ZWxsKCkKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuYyhuYW1lLCAiciIsIGZpbGVvYmosICoqa3dhcmdzKQogICAgICAgICAgICAgICAgZXhjZXB0IChSZWFkRXJyb3IsIENvbXByZXNzaW9uRXJyb3IpIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgaWYgZmlsZW9iaiBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW9iai5zZWVrKHNhdmVkX3BvcykKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICByYWlzZSBSZWFkRXJyb3IoImZpbGUgY291bGQgbm90IGJlIG9wZW5lZCBzdWNjZXNzZnVsbHkiKQoKICAgICAgICBlbGlmICI6IiBpbiBtb2RlOgogICAgICAgICAgICBmaWxlbW9kZSwgY29tcHR5cGUgPSBtb2RlLnNwbGl0KCI6IiwgMSkKICAgICAgICAgICAgZmlsZW1vZGUgPSBmaWxlbW9kZSBvciAiciIKICAgICAgICAgICAgY29tcHR5cGUgPSBjb21wdHlwZSBvciAidGFyIgoKICAgICAgICAgICAgIyBTZWxlY3QgdGhlICpvcGVuKCkgZnVuY3Rpb24gYWNjb3JkaW5nIHRvCiAgICAgICAgICAgICMgZ2l2ZW4gY29tcHJlc3Npb24uCiAgICAgICAgICAgIGlmIGNvbXB0eXBlIGluIGNscy5PUEVOX01FVEg6CiAgICAgICAgICAgICAgICBmdW5jID0gZ2V0YXR0cihjbHMsIGNscy5PUEVOX01FVEhbY29tcHR5cGVdKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UgQ29tcHJlc3Npb25FcnJvcigidW5rbm93biBjb21wcmVzc2lvbiB0eXBlICVyIiAlIGNvbXB0eXBlKQogICAgICAgICAgICByZXR1cm4gZnVuYyhuYW1lLCBmaWxlbW9kZSwgZmlsZW9iaiwgKiprd2FyZ3MpCgogICAgICAgIGVsaWYgInwiIGluIG1vZGU6CiAgICAgICAgICAgIGZpbGVtb2RlLCBjb21wdHlwZSA9IG1vZGUuc3BsaXQoInwiLCAxKQogICAgICAgICAgICBmaWxlbW9kZSA9IGZpbGVtb2RlIG9yICJyIgogICAgICAgICAgICBjb21wdHlwZSA9IGNvbXB0eXBlIG9yICJ0YXIiCgogICAgICAgICAgICBpZiBmaWxlbW9kZSBub3QgaW4gInJ3IjoKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIm1vZGUgbXVzdCBiZSAncicgb3IgJ3cnIikKCiAgICAgICAgICAgIHN0cmVhbSA9IF9TdHJlYW0obmFtZSwgZmlsZW1vZGUsIGNvbXB0eXBlLCBmaWxlb2JqLCBidWZzaXplKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB0ID0gY2xzKG5hbWUsIGZpbGVtb2RlLCBzdHJlYW0sICoqa3dhcmdzKQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBzdHJlYW0uY2xvc2UoKQogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgdC5fZXh0ZmlsZW9iaiA9IEZhbHNlCiAgICAgICAgICAgIHJldHVybiB0CgogICAgICAgIGVsaWYgbW9kZSBpbiAiYXciOgogICAgICAgICAgICByZXR1cm4gY2xzLnRhcm9wZW4obmFtZSwgbW9kZSwgZmlsZW9iaiwgKiprd2FyZ3MpCgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoInVuZGlzY2VybmlibGUgbW9kZSIpCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgdGFyb3BlbihjbHMsIG5hbWUsIG1vZGU9InIiLCBmaWxlb2JqPU5vbmUsICoqa3dhcmdzKToKICAgICAgICAiIiJPcGVuIHVuY29tcHJlc3NlZCB0YXIgYXJjaGl2ZSBuYW1lIGZvciByZWFkaW5nIG9yIHdyaXRpbmcuCiAgICAgICAgIiIiCiAgICAgICAgaWYgbGVuKG1vZGUpID4gMSBvciBtb2RlIG5vdCBpbiAicmF3IjoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigibW9kZSBtdXN0IGJlICdyJywgJ2EnIG9yICd3JyIpCiAgICAgICAgcmV0dXJuIGNscyhuYW1lLCBtb2RlLCBmaWxlb2JqLCAqKmt3YXJncykKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBnem9wZW4oY2xzLCBuYW1lLCBtb2RlPSJyIiwgZmlsZW9iaj1Ob25lLCBjb21wcmVzc2xldmVsPTksICoqa3dhcmdzKToKICAgICAgICAiIiJPcGVuIGd6aXAgY29tcHJlc3NlZCB0YXIgYXJjaGl2ZSBuYW1lIGZvciByZWFkaW5nIG9yIHdyaXRpbmcuCiAgICAgICAgICAgQXBwZW5kaW5nIGlzIG5vdCBhbGxvd2VkLgogICAgICAgICIiIgogICAgICAgIGlmIGxlbihtb2RlKSA+IDEgb3IgbW9kZSBub3QgaW4gInJ3IjoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigibW9kZSBtdXN0IGJlICdyJyBvciAndyciKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGltcG9ydCBnemlwCiAgICAgICAgICAgIGd6aXAuR3ppcEZpbGUKICAgICAgICBleGNlcHQgKEltcG9ydEVycm9yLCBBdHRyaWJ1dGVFcnJvcik6CiAgICAgICAgICAgIHJhaXNlIENvbXByZXNzaW9uRXJyb3IoImd6aXAgbW9kdWxlIGlzIG5vdCBhdmFpbGFibGUiKQoKICAgICAgICBleHRmaWxlb2JqID0gZmlsZW9iaiBpcyBub3QgTm9uZQogICAgICAgIHRyeToKICAgICAgICAgICAgZmlsZW9iaiA9IGd6aXAuR3ppcEZpbGUobmFtZSwgbW9kZSArICJiIiwgY29tcHJlc3NsZXZlbCwgZmlsZW9iaikKICAgICAgICAgICAgdCA9IGNscy50YXJvcGVuKG5hbWUsIG1vZGUsIGZpbGVvYmosICoqa3dhcmdzKQogICAgICAgIGV4Y2VwdCBJT0Vycm9yOgogICAgICAgICAgICBpZiBub3QgZXh0ZmlsZW9iaiBhbmQgZmlsZW9iaiBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIGZpbGVvYmouY2xvc2UoKQogICAgICAgICAgICBpZiBmaWxlb2JqIGlzIE5vbmU6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgICAgICByYWlzZSBSZWFkRXJyb3IoIm5vdCBhIGd6aXAgZmlsZSIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBpZiBub3QgZXh0ZmlsZW9iaiBhbmQgZmlsZW9iaiBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIGZpbGVvYmouY2xvc2UoKQogICAgICAgICAgICByYWlzZQogICAgICAgIHQuX2V4dGZpbGVvYmogPSBleHRmaWxlb2JqCiAgICAgICAgcmV0dXJuIHQKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBiejJvcGVuKGNscywgbmFtZSwgbW9kZT0iciIsIGZpbGVvYmo9Tm9uZSwgY29tcHJlc3NsZXZlbD05LCAqKmt3YXJncyk6CiAgICAgICAgIiIiT3BlbiBiemlwMiBjb21wcmVzc2VkIHRhciBhcmNoaXZlIG5hbWUgZm9yIHJlYWRpbmcgb3Igd3JpdGluZy4KICAgICAgICAgICBBcHBlbmRpbmcgaXMgbm90IGFsbG93ZWQuCiAgICAgICAgIiIiCiAgICAgICAgaWYgbGVuKG1vZGUpID4gMSBvciBtb2RlIG5vdCBpbiAicnciOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJtb2RlIG11c3QgYmUgJ3InIG9yICd3Jy4iKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGltcG9ydCBiejIKICAgICAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgICAgIHJhaXNlIENvbXByZXNzaW9uRXJyb3IoImJ6MiBtb2R1bGUgaXMgbm90IGF2YWlsYWJsZSIpCgogICAgICAgIGZpbGVvYmogPSBiejIuQloyRmlsZShmaWxlb2JqIG9yIG5hbWUsIG1vZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXByZXNzbGV2ZWw9Y29tcHJlc3NsZXZlbCkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICB0ID0gY2xzLnRhcm9wZW4obmFtZSwgbW9kZSwgZmlsZW9iaiwgKiprd2FyZ3MpCiAgICAgICAgZXhjZXB0IChJT0Vycm9yLCBFT0ZFcnJvcik6CiAgICAgICAgICAgIGZpbGVvYmouY2xvc2UoKQogICAgICAgICAgICByYWlzZSBSZWFkRXJyb3IoIm5vdCBhIGJ6aXAyIGZpbGUiKQogICAgICAgIHQuX2V4dGZpbGVvYmogPSBGYWxzZQogICAgICAgIHJldHVybiB0CgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgeHpvcGVuKGNscywgbmFtZSwgbW9kZT0iciIsIGZpbGVvYmo9Tm9uZSwgcHJlc2V0PU5vbmUsICoqa3dhcmdzKToKICAgICAgICAiIiJPcGVuIGx6bWEgY29tcHJlc3NlZCB0YXIgYXJjaGl2ZSBuYW1lIGZvciByZWFkaW5nIG9yIHdyaXRpbmcuCiAgICAgICAgICAgQXBwZW5kaW5nIGlzIG5vdCBhbGxvd2VkLgogICAgICAgICIiIgogICAgICAgIGlmIG1vZGUgbm90IGluICgiciIsICJ3Iik6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIm1vZGUgbXVzdCBiZSAncicgb3IgJ3cnIikKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpbXBvcnQgbHptYQogICAgICAgIGV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgICAgICAgICAgcmFpc2UgQ29tcHJlc3Npb25FcnJvcigibHptYSBtb2R1bGUgaXMgbm90IGF2YWlsYWJsZSIpCgogICAgICAgIGZpbGVvYmogPSBsem1hLkxaTUFGaWxlKGZpbGVvYmogb3IgbmFtZSwgbW9kZSwgcHJlc2V0PXByZXNldCkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICB0ID0gY2xzLnRhcm9wZW4obmFtZSwgbW9kZSwgZmlsZW9iaiwgKiprd2FyZ3MpCiAgICAgICAgZXhjZXB0IChsem1hLkxaTUFFcnJvciwgRU9GRXJyb3IpOgogICAgICAgICAgICBmaWxlb2JqLmNsb3NlKCkKICAgICAgICAgICAgcmFpc2UgUmVhZEVycm9yKCJub3QgYW4gbHptYSBmaWxlIikKICAgICAgICB0Ll9leHRmaWxlb2JqID0gRmFsc2UKICAgICAgICByZXR1cm4gdAoKICAgICMgQWxsICpvcGVuKCkgbWV0aG9kcyBhcmUgcmVnaXN0ZXJlZCBoZXJlLgogICAgT1BFTl9NRVRIID0gewogICAgICAgICJ0YXIiOiAidGFyb3BlbiIsICAgIyB1bmNvbXByZXNzZWQgdGFyCiAgICAgICAgImd6IjogICJnem9wZW4iLCAgICAjIGd6aXAgY29tcHJlc3NlZCB0YXIKICAgICAgICAiYnoyIjogImJ6Mm9wZW4iLCAgICMgYnppcDIgY29tcHJlc3NlZCB0YXIKICAgICAgICAieHoiOiAgInh6b3BlbiIgICAgICMgbHptYSBjb21wcmVzc2VkIHRhcgogICAgfQoKICAgICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgIyBUaGUgcHVibGljIG1ldGhvZHMgd2hpY2ggVGFyRmlsZSBwcm92aWRlczoKCiAgICBkZWYgY2xvc2Uoc2VsZik6CiAgICAgICAgIiIiQ2xvc2UgdGhlIFRhckZpbGUuIEluIHdyaXRlLW1vZGUsIHR3byBmaW5pc2hpbmcgemVybyBibG9ja3MgYXJlCiAgICAgICAgICAgYXBwZW5kZWQgdG8gdGhlIGFyY2hpdmUuCiAgICAgICAgIiIiCiAgICAgICAgaWYgc2VsZi5jbG9zZWQ6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBzZWxmLm1vZGUgaW4gImF3IjoKICAgICAgICAgICAgc2VsZi5maWxlb2JqLndyaXRlKE5VTCAqIChCTE9DS1NJWkUgKiAyKSkKICAgICAgICAgICAgc2VsZi5vZmZzZXQgKz0gKEJMT0NLU0laRSAqIDIpCiAgICAgICAgICAgICMgZmlsbCB1cCB0aGUgZW5kIHdpdGggemVyby1ibG9ja3MKICAgICAgICAgICAgIyAobGlrZSBvcHRpb24gLWIyMCBmb3IgdGFyIGRvZXMpCiAgICAgICAgICAgIGJsb2NrcywgcmVtYWluZGVyID0gZGl2bW9kKHNlbGYub2Zmc2V0LCBSRUNPUkRTSVpFKQogICAgICAgICAgICBpZiByZW1haW5kZXIgPiAwOgogICAgICAgICAgICAgICAgc2VsZi5maWxlb2JqLndyaXRlKE5VTCAqIChSRUNPUkRTSVpFIC0gcmVtYWluZGVyKSkKCiAgICAgICAgaWYgbm90IHNlbGYuX2V4dGZpbGVvYmo6CiAgICAgICAgICAgIHNlbGYuZmlsZW9iai5jbG9zZSgpCiAgICAgICAgc2VsZi5jbG9zZWQgPSBUcnVlCgogICAgZGVmIGdldG1lbWJlcihzZWxmLCBuYW1lKToKICAgICAgICAiIiJSZXR1cm4gYSBUYXJJbmZvIG9iamVjdCBmb3IgbWVtYmVyIGBuYW1lJy4gSWYgYG5hbWUnIGNhbiBub3QgYmUKICAgICAgICAgICBmb3VuZCBpbiB0aGUgYXJjaGl2ZSwgS2V5RXJyb3IgaXMgcmFpc2VkLiBJZiBhIG1lbWJlciBvY2N1cnMgbW9yZQogICAgICAgICAgIHRoYW4gb25jZSBpbiB0aGUgYXJjaGl2ZSwgaXRzIGxhc3Qgb2NjdXJyZW5jZSBpcyBhc3N1bWVkIHRvIGJlIHRoZQogICAgICAgICAgIG1vc3QgdXAtdG8tZGF0ZSB2ZXJzaW9uLgogICAgICAgICIiIgogICAgICAgIHRhcmluZm8gPSBzZWxmLl9nZXRtZW1iZXIobmFtZSkKICAgICAgICBpZiB0YXJpbmZvIGlzIE5vbmU6CiAgICAgICAgICAgIHJhaXNlIEtleUVycm9yKCJmaWxlbmFtZSAlciBub3QgZm91bmQiICUgbmFtZSkKICAgICAgICByZXR1cm4gdGFyaW5mbwoKICAgIGRlZiBnZXRtZW1iZXJzKHNlbGYpOgogICAgICAgICIiIlJldHVybiB0aGUgbWVtYmVycyBvZiB0aGUgYXJjaGl2ZSBhcyBhIGxpc3Qgb2YgVGFySW5mbyBvYmplY3RzLiBUaGUKICAgICAgICAgICBsaXN0IGhhcyB0aGUgc2FtZSBvcmRlciBhcyB0aGUgbWVtYmVycyBpbiB0aGUgYXJjaGl2ZS4KICAgICAgICAiIiIKICAgICAgICBzZWxmLl9jaGVjaygpCiAgICAgICAgaWYgbm90IHNlbGYuX2xvYWRlZDogICAgIyBpZiB3ZSB3YW50IHRvIG9idGFpbiBhIGxpc3Qgb2YKICAgICAgICAgICAgc2VsZi5fbG9hZCgpICAgICAgICAjIGFsbCBtZW1iZXJzLCB3ZSBmaXJzdCBoYXZlIHRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBzY2FuIHRoZSB3aG9sZSBhcmNoaXZlLgogICAgICAgIHJldHVybiBzZWxmLm1lbWJlcnMKCiAgICBkZWYgZ2V0bmFtZXMoc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIHRoZSBtZW1iZXJzIG9mIHRoZSBhcmNoaXZlIGFzIGEgbGlzdCBvZiB0aGVpciBuYW1lcy4gSXQgaGFzCiAgICAgICAgICAgdGhlIHNhbWUgb3JkZXIgYXMgdGhlIGxpc3QgcmV0dXJuZWQgYnkgZ2V0bWVtYmVycygpLgogICAgICAgICIiIgogICAgICAgIHJldHVybiBbdGFyaW5mby5uYW1lIGZvciB0YXJpbmZvIGluIHNlbGYuZ2V0bWVtYmVycygpXQoKICAgIGRlZiBnZXR0YXJpbmZvKHNlbGYsIG5hbWU9Tm9uZSwgYXJjbmFtZT1Ob25lLCBmaWxlb2JqPU5vbmUpOgogICAgICAgICIiIkNyZWF0ZSBhIFRhckluZm8gb2JqZWN0IGZvciBlaXRoZXIgdGhlIGZpbGUgYG5hbWUnIG9yIHRoZSBmaWxlCiAgICAgICAgICAgb2JqZWN0IGBmaWxlb2JqJyAodXNpbmcgb3MuZnN0YXQgb24gaXRzIGZpbGUgZGVzY3JpcHRvcikuIFlvdSBjYW4KICAgICAgICAgICBtb2RpZnkgc29tZSBvZiB0aGUgVGFySW5mbydzIGF0dHJpYnV0ZXMgYmVmb3JlIHlvdSBhZGQgaXQgdXNpbmcKICAgICAgICAgICBhZGRmaWxlKCkuIElmIGdpdmVuLCBgYXJjbmFtZScgc3BlY2lmaWVzIGFuIGFsdGVybmF0aXZlIG5hbWUgZm9yIHRoZQogICAgICAgICAgIGZpbGUgaW4gdGhlIGFyY2hpdmUuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fY2hlY2soImF3IikKCiAgICAgICAgIyBXaGVuIGZpbGVvYmogaXMgZ2l2ZW4sIHJlcGxhY2UgbmFtZSBieQogICAgICAgICMgZmlsZW9iaidzIHJlYWwgbmFtZS4KICAgICAgICBpZiBmaWxlb2JqIGlzIG5vdCBOb25lOgogICAgICAgICAgICBuYW1lID0gZmlsZW9iai5uYW1lCgogICAgICAgICMgQnVpbGRpbmcgdGhlIG5hbWUgb2YgdGhlIG1lbWJlciBpbiB0aGUgYXJjaGl2ZS4KICAgICAgICAjIEJhY2t3YXJkIHNsYXNoZXMgYXJlIGNvbnZlcnRlZCB0byBmb3J3YXJkIHNsYXNoZXMsCiAgICAgICAgIyBBYnNvbHV0ZSBwYXRocyBhcmUgdHVybmVkIHRvIHJlbGF0aXZlIHBhdGhzLgogICAgICAgIGlmIGFyY25hbWUgaXMgTm9uZToKICAgICAgICAgICAgYXJjbmFtZSA9IG5hbWUKICAgICAgICBkcnYsIGFyY25hbWUgPSBvcy5wYXRoLnNwbGl0ZHJpdmUoYXJjbmFtZSkKICAgICAgICBhcmNuYW1lID0gYXJjbmFtZS5yZXBsYWNlKG9zLnNlcCwgIi8iKQogICAgICAgIGFyY25hbWUgPSBhcmNuYW1lLmxzdHJpcCgiLyIpCgogICAgICAgICMgTm93LCBmaWxsIHRoZSBUYXJJbmZvIG9iamVjdCB3aXRoCiAgICAgICAgIyBpbmZvcm1hdGlvbiBzcGVjaWZpYyBmb3IgdGhlIGZpbGUuCiAgICAgICAgdGFyaW5mbyA9IHNlbGYudGFyaW5mbygpCiAgICAgICAgdGFyaW5mby50YXJmaWxlID0gc2VsZgoKICAgICAgICAjIFVzZSBvcy5zdGF0IG9yIG9zLmxzdGF0LCBkZXBlbmRpbmcgb24gcGxhdGZvcm0KICAgICAgICAjIGFuZCBpZiBzeW1saW5rcyBzaGFsbCBiZSByZXNvbHZlZC4KICAgICAgICBpZiBmaWxlb2JqIGlzIE5vbmU6CiAgICAgICAgICAgIGlmIGhhc2F0dHIob3MsICJsc3RhdCIpIGFuZCBub3Qgc2VsZi5kZXJlZmVyZW5jZToKICAgICAgICAgICAgICAgIHN0YXRyZXMgPSBvcy5sc3RhdChuYW1lKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc3RhdHJlcyA9IG9zLnN0YXQobmFtZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzdGF0cmVzID0gb3MuZnN0YXQoZmlsZW9iai5maWxlbm8oKSkKICAgICAgICBsaW5rbmFtZSA9ICIiCgogICAgICAgIHN0bWQgPSBzdGF0cmVzLnN0X21vZGUKICAgICAgICBpZiBzdGF0LlNfSVNSRUcoc3RtZCk6CiAgICAgICAgICAgIGlub2RlID0gKHN0YXRyZXMuc3RfaW5vLCBzdGF0cmVzLnN0X2RldikKICAgICAgICAgICAgaWYgbm90IHNlbGYuZGVyZWZlcmVuY2UgYW5kIHN0YXRyZXMuc3RfbmxpbmsgPiAxIGFuZCBcCiAgICAgICAgICAgICAgICAgICAgaW5vZGUgaW4gc2VsZi5pbm9kZXMgYW5kIGFyY25hbWUgIT0gc2VsZi5pbm9kZXNbaW5vZGVdOgogICAgICAgICAgICAgICAgIyBJcyBpdCBhIGhhcmRsaW5rIHRvIGFuIGFscmVhZHkKICAgICAgICAgICAgICAgICMgYXJjaGl2ZWQgZmlsZT8KICAgICAgICAgICAgICAgIHR5cGUgPSBMTktUWVBFCiAgICAgICAgICAgICAgICBsaW5rbmFtZSA9IHNlbGYuaW5vZGVzW2lub2RlXQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgIyBUaGUgaW5vZGUgaXMgYWRkZWQgb25seSBpZiBpdHMgdmFsaWQuCiAgICAgICAgICAgICAgICAjIEZvciB3aW4zMiBpdCBpcyBhbHdheXMgMC4KICAgICAgICAgICAgICAgIHR5cGUgPSBSRUdUWVBFCiAgICAgICAgICAgICAgICBpZiBpbm9kZVswXToKICAgICAgICAgICAgICAgICAgICBzZWxmLmlub2Rlc1tpbm9kZV0gPSBhcmNuYW1lCiAgICAgICAgZWxpZiBzdGF0LlNfSVNESVIoc3RtZCk6CiAgICAgICAgICAgIHR5cGUgPSBESVJUWVBFCiAgICAgICAgZWxpZiBzdGF0LlNfSVNGSUZPKHN0bWQpOgogICAgICAgICAgICB0eXBlID0gRklGT1RZUEUKICAgICAgICBlbGlmIHN0YXQuU19JU0xOSyhzdG1kKToKICAgICAgICAgICAgdHlwZSA9IFNZTVRZUEUKICAgICAgICAgICAgbGlua25hbWUgPSBvcy5yZWFkbGluayhuYW1lKQogICAgICAgIGVsaWYgc3RhdC5TX0lTQ0hSKHN0bWQpOgogICAgICAgICAgICB0eXBlID0gQ0hSVFlQRQogICAgICAgIGVsaWYgc3RhdC5TX0lTQkxLKHN0bWQpOgogICAgICAgICAgICB0eXBlID0gQkxLVFlQRQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBOb25lCgogICAgICAgICMgRmlsbCB0aGUgVGFySW5mbyBvYmplY3Qgd2l0aCBhbGwKICAgICAgICAjIGluZm9ybWF0aW9uIHdlIGNhbiBnZXQuCiAgICAgICAgdGFyaW5mby5uYW1lID0gYXJjbmFtZQogICAgICAgIHRhcmluZm8ubW9kZSA9IHN0bWQKICAgICAgICB0YXJpbmZvLnVpZCA9IHN0YXRyZXMuc3RfdWlkCiAgICAgICAgdGFyaW5mby5naWQgPSBzdGF0cmVzLnN0X2dpZAogICAgICAgIGlmIHR5cGUgPT0gUkVHVFlQRToKICAgICAgICAgICAgdGFyaW5mby5zaXplID0gc3RhdHJlcy5zdF9zaXplCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdGFyaW5mby5zaXplID0gMAogICAgICAgIHRhcmluZm8ubXRpbWUgPSBzdGF0cmVzLnN0X210aW1lCiAgICAgICAgdGFyaW5mby50eXBlID0gdHlwZQogICAgICAgIHRhcmluZm8ubGlua25hbWUgPSBsaW5rbmFtZQogICAgICAgIGlmIHB3ZDoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgdGFyaW5mby51bmFtZSA9IHB3ZC5nZXRwd3VpZCh0YXJpbmZvLnVpZClbMF0KICAgICAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIGlmIGdycDoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgdGFyaW5mby5nbmFtZSA9IGdycC5nZXRncmdpZCh0YXJpbmZvLmdpZClbMF0KICAgICAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBpZiB0eXBlIGluIChDSFJUWVBFLCBCTEtUWVBFKToKICAgICAgICAgICAgaWYgaGFzYXR0cihvcywgIm1ham9yIikgYW5kIGhhc2F0dHIob3MsICJtaW5vciIpOgogICAgICAgICAgICAgICAgdGFyaW5mby5kZXZtYWpvciA9IG9zLm1ham9yKHN0YXRyZXMuc3RfcmRldikKICAgICAgICAgICAgICAgIHRhcmluZm8uZGV2bWlub3IgPSBvcy5taW5vcihzdGF0cmVzLnN0X3JkZXYpCiAgICAgICAgcmV0dXJuIHRhcmluZm8KCiAgICBkZWYgbGlzdChzZWxmLCB2ZXJib3NlPVRydWUpOgogICAgICAgICIiIlByaW50IGEgdGFibGUgb2YgY29udGVudHMgdG8gc3lzLnN0ZG91dC4gSWYgYHZlcmJvc2UnIGlzIEZhbHNlLCBvbmx5CiAgICAgICAgICAgdGhlIG5hbWVzIG9mIHRoZSBtZW1iZXJzIGFyZSBwcmludGVkLiBJZiBpdCBpcyBUcnVlLCBhbiBgbHMgLWwnLWxpa2UKICAgICAgICAgICBvdXRwdXQgaXMgcHJvZHVjZWQuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fY2hlY2soKQoKICAgICAgICBmb3IgdGFyaW5mbyBpbiBzZWxmOgogICAgICAgICAgICBpZiB2ZXJib3NlOgogICAgICAgICAgICAgICAgcHJpbnQoc3RhdC5maWxlbW9kZSh0YXJpbmZvLm1vZGUpLCBlbmQ9JyAnKQogICAgICAgICAgICAgICAgcHJpbnQoIiVzLyVzIiAlICh0YXJpbmZvLnVuYW1lIG9yIHRhcmluZm8udWlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJpbmZvLmduYW1lIG9yIHRhcmluZm8uZ2lkKSwgZW5kPScgJykKICAgICAgICAgICAgICAgIGlmIHRhcmluZm8uaXNjaHIoKSBvciB0YXJpbmZvLmlzYmxrKCk6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoIiUxMHMiICUgKCIlZCwlZCIgXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAlICh0YXJpbmZvLmRldm1ham9yLCB0YXJpbmZvLmRldm1pbm9yKSksIGVuZD0nICcpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHByaW50KCIlMTBkIiAlIHRhcmluZm8uc2l6ZSwgZW5kPScgJykKICAgICAgICAgICAgICAgIHByaW50KCIlZC0lMDJkLSUwMmQgJTAyZDolMDJkOiUwMmQiIFwKICAgICAgICAgICAgICAgICAgICAgICUgdGltZS5sb2NhbHRpbWUodGFyaW5mby5tdGltZSlbOjZdLCBlbmQ9JyAnKQoKICAgICAgICAgICAgcHJpbnQodGFyaW5mby5uYW1lICsgKCIvIiBpZiB0YXJpbmZvLmlzZGlyKCkgZWxzZSAiIiksIGVuZD0nICcpCgogICAgICAgICAgICBpZiB2ZXJib3NlOgogICAgICAgICAgICAgICAgaWYgdGFyaW5mby5pc3N5bSgpOgogICAgICAgICAgICAgICAgICAgIHByaW50KCItPiIsIHRhcmluZm8ubGlua25hbWUsIGVuZD0nICcpCiAgICAgICAgICAgICAgICBpZiB0YXJpbmZvLmlzbG5rKCk6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoImxpbmsgdG8iLCB0YXJpbmZvLmxpbmtuYW1lLCBlbmQ9JyAnKQogICAgICAgICAgICBwcmludCgpCgogICAgZGVmIGFkZChzZWxmLCBuYW1lLCBhcmNuYW1lPU5vbmUsIHJlY3Vyc2l2ZT1UcnVlLCBleGNsdWRlPU5vbmUsICosIGZpbHRlcj1Ob25lKToKICAgICAgICAiIiJBZGQgdGhlIGZpbGUgYG5hbWUnIHRvIHRoZSBhcmNoaXZlLiBgbmFtZScgbWF5IGJlIGFueSB0eXBlIG9mIGZpbGUKICAgICAgICAgICAoZGlyZWN0b3J5LCBmaWZvLCBzeW1ib2xpYyBsaW5rLCBldGMuKS4gSWYgZ2l2ZW4sIGBhcmNuYW1lJwogICAgICAgICAgIHNwZWNpZmllcyBhbiBhbHRlcm5hdGl2ZSBuYW1lIGZvciB0aGUgZmlsZSBpbiB0aGUgYXJjaGl2ZS4KICAgICAgICAgICBEaXJlY3RvcmllcyBhcmUgYWRkZWQgcmVjdXJzaXZlbHkgYnkgZGVmYXVsdC4gVGhpcyBjYW4gYmUgYXZvaWRlZCBieQogICAgICAgICAgIHNldHRpbmcgYHJlY3Vyc2l2ZScgdG8gRmFsc2UuIGBleGNsdWRlJyBpcyBhIGZ1bmN0aW9uIHRoYXQgc2hvdWxkCiAgICAgICAgICAgcmV0dXJuIFRydWUgZm9yIGVhY2ggZmlsZW5hbWUgdG8gYmUgZXhjbHVkZWQuIGBmaWx0ZXInIGlzIGEgZnVuY3Rpb24KICAgICAgICAgICB0aGF0IGV4cGVjdHMgYSBUYXJJbmZvIG9iamVjdCBhcmd1bWVudCBhbmQgcmV0dXJucyB0aGUgY2hhbmdlZAogICAgICAgICAgIFRhckluZm8gb2JqZWN0LCBpZiBpdCByZXR1cm5zIE5vbmUgdGhlIFRhckluZm8gb2JqZWN0IHdpbGwgYmUKICAgICAgICAgICBleGNsdWRlZCBmcm9tIHRoZSBhcmNoaXZlLgogICAgICAgICIiIgogICAgICAgIHNlbGYuX2NoZWNrKCJhdyIpCgogICAgICAgIGlmIGFyY25hbWUgaXMgTm9uZToKICAgICAgICAgICAgYXJjbmFtZSA9IG5hbWUKCiAgICAgICAgIyBFeGNsdWRlIHBhdGhuYW1lcy4KICAgICAgICBpZiBleGNsdWRlIGlzIG5vdCBOb25lOgogICAgICAgICAgICBpbXBvcnQgd2FybmluZ3MKICAgICAgICAgICAgd2FybmluZ3Mud2FybigidXNlIHRoZSBmaWx0ZXIgYXJndW1lbnQgaW5zdGVhZCIsCiAgICAgICAgICAgICAgICAgICAgRGVwcmVjYXRpb25XYXJuaW5nLCAyKQogICAgICAgICAgICBpZiBleGNsdWRlKG5hbWUpOgogICAgICAgICAgICAgICAgc2VsZi5fZGJnKDIsICJ0YXJmaWxlOiBFeGNsdWRlZCAlciIgJSBuYW1lKQogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICMgU2tpcCBpZiBzb21lYm9keSB0cmllcyB0byBhcmNoaXZlIHRoZSBhcmNoaXZlLi4uCiAgICAgICAgaWYgc2VsZi5uYW1lIGlzIG5vdCBOb25lIGFuZCBvcy5wYXRoLmFic3BhdGgobmFtZSkgPT0gc2VsZi5uYW1lOgogICAgICAgICAgICBzZWxmLl9kYmcoMiwgInRhcmZpbGU6IFNraXBwZWQgJXIiICUgbmFtZSkKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuX2RiZygxLCBuYW1lKQoKICAgICAgICAjIENyZWF0ZSBhIFRhckluZm8gb2JqZWN0IGZyb20gdGhlIGZpbGUuCiAgICAgICAgdGFyaW5mbyA9IHNlbGYuZ2V0dGFyaW5mbyhuYW1lLCBhcmNuYW1lKQoKICAgICAgICBpZiB0YXJpbmZvIGlzIE5vbmU6CiAgICAgICAgICAgIHNlbGYuX2RiZygxLCAidGFyZmlsZTogVW5zdXBwb3J0ZWQgdHlwZSAlciIgJSBuYW1lKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgIyBDaGFuZ2Ugb3IgZXhjbHVkZSB0aGUgVGFySW5mbyBvYmplY3QuCiAgICAgICAgaWYgZmlsdGVyIGlzIG5vdCBOb25lOgogICAgICAgICAgICB0YXJpbmZvID0gZmlsdGVyKHRhcmluZm8pCiAgICAgICAgICAgIGlmIHRhcmluZm8gaXMgTm9uZToKICAgICAgICAgICAgICAgIHNlbGYuX2RiZygyLCAidGFyZmlsZTogRXhjbHVkZWQgJXIiICUgbmFtZSkKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAjIEFwcGVuZCB0aGUgdGFyIGhlYWRlciBhbmQgZGF0YSB0byB0aGUgYXJjaGl2ZS4KICAgICAgICBpZiB0YXJpbmZvLmlzcmVnKCk6CiAgICAgICAgICAgIGYgPSBibHRuX29wZW4obmFtZSwgInJiIikKICAgICAgICAgICAgc2VsZi5hZGRmaWxlKHRhcmluZm8sIGYpCiAgICAgICAgICAgIGYuY2xvc2UoKQoKICAgICAgICBlbGlmIHRhcmluZm8uaXNkaXIoKToKICAgICAgICAgICAgc2VsZi5hZGRmaWxlKHRhcmluZm8pCiAgICAgICAgICAgIGlmIHJlY3Vyc2l2ZToKICAgICAgICAgICAgICAgIGZvciBmIGluIG9zLmxpc3RkaXIobmFtZSk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5hZGQob3MucGF0aC5qb2luKG5hbWUsIGYpLCBvcy5wYXRoLmpvaW4oYXJjbmFtZSwgZiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWN1cnNpdmUsIGV4Y2x1ZGUsIGZpbHRlcj1maWx0ZXIpCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuYWRkZmlsZSh0YXJpbmZvKQoKICAgIGRlZiBhZGRmaWxlKHNlbGYsIHRhcmluZm8sIGZpbGVvYmo9Tm9uZSk6CiAgICAgICAgIiIiQWRkIHRoZSBUYXJJbmZvIG9iamVjdCBgdGFyaW5mbycgdG8gdGhlIGFyY2hpdmUuIElmIGBmaWxlb2JqJyBpcwogICAgICAgICAgIGdpdmVuLCB0YXJpbmZvLnNpemUgYnl0ZXMgYXJlIHJlYWQgZnJvbSBpdCBhbmQgYWRkZWQgdG8gdGhlIGFyY2hpdmUuCiAgICAgICAgICAgWW91IGNhbiBjcmVhdGUgVGFySW5mbyBvYmplY3RzIHVzaW5nIGdldHRhcmluZm8oKS4KICAgICAgICAgICBPbiBXaW5kb3dzIHBsYXRmb3JtcywgYGZpbGVvYmonIHNob3VsZCBhbHdheXMgYmUgb3BlbmVkIHdpdGggbW9kZQogICAgICAgICAgICdyYicgdG8gYXZvaWQgaXJyaXRhdGlvbiBhYm91dCB0aGUgZmlsZSBzaXplLgogICAgICAgICIiIgogICAgICAgIHNlbGYuX2NoZWNrKCJhdyIpCgogICAgICAgIHRhcmluZm8gPSBjb3B5LmNvcHkodGFyaW5mbykKCiAgICAgICAgYnVmID0gdGFyaW5mby50b2J1ZihzZWxmLmZvcm1hdCwgc2VsZi5lbmNvZGluZywgc2VsZi5lcnJvcnMpCiAgICAgICAgc2VsZi5maWxlb2JqLndyaXRlKGJ1ZikKICAgICAgICBzZWxmLm9mZnNldCArPSBsZW4oYnVmKQoKICAgICAgICAjIElmIHRoZXJlJ3MgZGF0YSB0byBmb2xsb3csIGFwcGVuZCBpdC4KICAgICAgICBpZiBmaWxlb2JqIGlzIG5vdCBOb25lOgogICAgICAgICAgICBjb3B5ZmlsZW9iaihmaWxlb2JqLCBzZWxmLmZpbGVvYmosIHRhcmluZm8uc2l6ZSkKICAgICAgICAgICAgYmxvY2tzLCByZW1haW5kZXIgPSBkaXZtb2QodGFyaW5mby5zaXplLCBCTE9DS1NJWkUpCiAgICAgICAgICAgIGlmIHJlbWFpbmRlciA+IDA6CiAgICAgICAgICAgICAgICBzZWxmLmZpbGVvYmoud3JpdGUoTlVMICogKEJMT0NLU0laRSAtIHJlbWFpbmRlcikpCiAgICAgICAgICAgICAgICBibG9ja3MgKz0gMQogICAgICAgICAgICBzZWxmLm9mZnNldCArPSBibG9ja3MgKiBCTE9DS1NJWkUKCiAgICAgICAgc2VsZi5tZW1iZXJzLmFwcGVuZCh0YXJpbmZvKQoKICAgIGRlZiBleHRyYWN0YWxsKHNlbGYsIHBhdGg9Ii4iLCBtZW1iZXJzPU5vbmUpOgogICAgICAgICIiIkV4dHJhY3QgYWxsIG1lbWJlcnMgZnJvbSB0aGUgYXJjaGl2ZSB0byB0aGUgY3VycmVudCB3b3JraW5nCiAgICAgICAgICAgZGlyZWN0b3J5IGFuZCBzZXQgb3duZXIsIG1vZGlmaWNhdGlvbiB0aW1lIGFuZCBwZXJtaXNzaW9ucyBvbgogICAgICAgICAgIGRpcmVjdG9yaWVzIGFmdGVyd2FyZHMuIGBwYXRoJyBzcGVjaWZpZXMgYSBkaWZmZXJlbnQgZGlyZWN0b3J5CiAgICAgICAgICAgdG8gZXh0cmFjdCB0by4gYG1lbWJlcnMnIGlzIG9wdGlvbmFsIGFuZCBtdXN0IGJlIGEgc3Vic2V0IG9mIHRoZQogICAgICAgICAgIGxpc3QgcmV0dXJuZWQgYnkgZ2V0bWVtYmVycygpLgogICAgICAgICIiIgogICAgICAgIGRpcmVjdG9yaWVzID0gW10KCiAgICAgICAgaWYgbWVtYmVycyBpcyBOb25lOgogICAgICAgICAgICBtZW1iZXJzID0gc2VsZgoKICAgICAgICBmb3IgdGFyaW5mbyBpbiBtZW1iZXJzOgogICAgICAgICAgICBpZiB0YXJpbmZvLmlzZGlyKCk6CiAgICAgICAgICAgICAgICAjIEV4dHJhY3QgZGlyZWN0b3JpZXMgd2l0aCBhIHNhZmUgbW9kZS4KICAgICAgICAgICAgICAgIGRpcmVjdG9yaWVzLmFwcGVuZCh0YXJpbmZvKQogICAgICAgICAgICAgICAgdGFyaW5mbyA9IGNvcHkuY29weSh0YXJpbmZvKQogICAgICAgICAgICAgICAgdGFyaW5mby5tb2RlID0gMG83MDAKICAgICAgICAgICAgIyBEbyBub3Qgc2V0X2F0dHJzIGRpcmVjdG9yaWVzLCBhcyB3ZSB3aWxsIGRvIHRoYXQgZnVydGhlciBkb3duCiAgICAgICAgICAgIHNlbGYuZXh0cmFjdCh0YXJpbmZvLCBwYXRoLCBzZXRfYXR0cnM9bm90IHRhcmluZm8uaXNkaXIoKSkKCiAgICAgICAgIyBSZXZlcnNlIHNvcnQgZGlyZWN0b3JpZXMuCiAgICAgICAgZGlyZWN0b3JpZXMuc29ydChrZXk9bGFtYmRhIGE6IGEubmFtZSkKICAgICAgICBkaXJlY3Rvcmllcy5yZXZlcnNlKCkKCiAgICAgICAgIyBTZXQgY29ycmVjdCBvd25lciwgbXRpbWUgYW5kIGZpbGVtb2RlIG9uIGRpcmVjdG9yaWVzLgogICAgICAgIGZvciB0YXJpbmZvIGluIGRpcmVjdG9yaWVzOgogICAgICAgICAgICBkaXJwYXRoID0gb3MucGF0aC5qb2luKHBhdGgsIHRhcmluZm8ubmFtZSkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VsZi5jaG93bih0YXJpbmZvLCBkaXJwYXRoKQogICAgICAgICAgICAgICAgc2VsZi51dGltZSh0YXJpbmZvLCBkaXJwYXRoKQogICAgICAgICAgICAgICAgc2VsZi5jaG1vZCh0YXJpbmZvLCBkaXJwYXRoKQogICAgICAgICAgICBleGNlcHQgRXh0cmFjdEVycm9yIGFzIGU6CiAgICAgICAgICAgICAgICBpZiBzZWxmLmVycm9ybGV2ZWwgPiAxOgogICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX2RiZygxLCAidGFyZmlsZTogJXMiICUgZSkKCiAgICBkZWYgZXh0cmFjdChzZWxmLCBtZW1iZXIsIHBhdGg9IiIsIHNldF9hdHRycz1UcnVlKToKICAgICAgICAiIiJFeHRyYWN0IGEgbWVtYmVyIGZyb20gdGhlIGFyY2hpdmUgdG8gdGhlIGN1cnJlbnQgd29ya2luZyBkaXJlY3RvcnksCiAgICAgICAgICAgdXNpbmcgaXRzIGZ1bGwgbmFtZS4gSXRzIGZpbGUgaW5mb3JtYXRpb24gaXMgZXh0cmFjdGVkIGFzIGFjY3VyYXRlbHkKICAgICAgICAgICBhcyBwb3NzaWJsZS4gYG1lbWJlcicgbWF5IGJlIGEgZmlsZW5hbWUgb3IgYSBUYXJJbmZvIG9iamVjdC4gWW91IGNhbgogICAgICAgICAgIHNwZWNpZnkgYSBkaWZmZXJlbnQgZGlyZWN0b3J5IHVzaW5nIGBwYXRoJy4gRmlsZSBhdHRyaWJ1dGVzIChvd25lciwKICAgICAgICAgICBtdGltZSwgbW9kZSkgYXJlIHNldCB1bmxlc3MgYHNldF9hdHRycycgaXMgRmFsc2UuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fY2hlY2soInIiKQoKICAgICAgICBpZiBpc2luc3RhbmNlKG1lbWJlciwgc3RyKToKICAgICAgICAgICAgdGFyaW5mbyA9IHNlbGYuZ2V0bWVtYmVyKG1lbWJlcikKICAgICAgICBlbHNlOgogICAgICAgICAgICB0YXJpbmZvID0gbWVtYmVyCgogICAgICAgICMgUHJlcGFyZSB0aGUgbGluayB0YXJnZXQgZm9yIG1ha2VsaW5rKCkuCiAgICAgICAgaWYgdGFyaW5mby5pc2xuaygpOgogICAgICAgICAgICB0YXJpbmZvLl9saW5rX3RhcmdldCA9IG9zLnBhdGguam9pbihwYXRoLCB0YXJpbmZvLmxpbmtuYW1lKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuX2V4dHJhY3RfbWVtYmVyKHRhcmluZm8sIG9zLnBhdGguam9pbihwYXRoLCB0YXJpbmZvLm5hbWUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRfYXR0cnM9c2V0X2F0dHJzKQogICAgICAgIGV4Y2VwdCBFbnZpcm9ubWVudEVycm9yIGFzIGU6CiAgICAgICAgICAgIGlmIHNlbGYuZXJyb3JsZXZlbCA+IDA6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgZS5maWxlbmFtZSBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX2RiZygxLCAidGFyZmlsZTogJXMiICUgZS5zdHJlcnJvcikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5fZGJnKDEsICJ0YXJmaWxlOiAlcyAlciIgJSAoZS5zdHJlcnJvciwgZS5maWxlbmFtZSkpCiAgICAgICAgZXhjZXB0IEV4dHJhY3RFcnJvciBhcyBlOgogICAgICAgICAgICBpZiBzZWxmLmVycm9ybGV2ZWwgPiAxOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuX2RiZygxLCAidGFyZmlsZTogJXMiICUgZSkKCiAgICBkZWYgZXh0cmFjdGZpbGUoc2VsZiwgbWVtYmVyKToKICAgICAgICAiIiJFeHRyYWN0IGEgbWVtYmVyIGZyb20gdGhlIGFyY2hpdmUgYXMgYSBmaWxlIG9iamVjdC4gYG1lbWJlcicgbWF5IGJlCiAgICAgICAgICAgYSBmaWxlbmFtZSBvciBhIFRhckluZm8gb2JqZWN0LiBJZiBgbWVtYmVyJyBpcyBhIHJlZ3VsYXIgZmlsZSBvciBhCiAgICAgICAgICAgbGluaywgYW4gaW8uQnVmZmVyZWRSZWFkZXIgb2JqZWN0IGlzIHJldHVybmVkLiBPdGhlcndpc2UsIE5vbmUgaXMKICAgICAgICAgICByZXR1cm5lZC4KICAgICAgICAiIiIKICAgICAgICBzZWxmLl9jaGVjaygiciIpCgogICAgICAgIGlmIGlzaW5zdGFuY2UobWVtYmVyLCBzdHIpOgogICAgICAgICAgICB0YXJpbmZvID0gc2VsZi5nZXRtZW1iZXIobWVtYmVyKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRhcmluZm8gPSBtZW1iZXIKCiAgICAgICAgaWYgdGFyaW5mby5pc3JlZygpIG9yIHRhcmluZm8udHlwZSBub3QgaW4gU1VQUE9SVEVEX1RZUEVTOgogICAgICAgICAgICAjIE1lbWJlcnMgd2l0aCB1bmtub3duIHR5cGVzIGFyZSB0cmVhdGVkIGFzIHJlZ3VsYXIgZmlsZXMuCiAgICAgICAgICAgIHJldHVybiBzZWxmLmZpbGVvYmplY3Qoc2VsZiwgdGFyaW5mbykKCiAgICAgICAgZWxpZiB0YXJpbmZvLmlzbG5rKCkgb3IgdGFyaW5mby5pc3N5bSgpOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKHNlbGYuZmlsZW9iaiwgX1N0cmVhbSk6CiAgICAgICAgICAgICAgICAjIEEgc21hbGwgYnV0IHVnbHkgd29ya2Fyb3VuZCBmb3IgdGhlIGNhc2UgdGhhdCBzb21lb25lIHRyaWVzCiAgICAgICAgICAgICAgICAjIHRvIGV4dHJhY3QgYSAoc3ltKWxpbmsgYXMgYSBmaWxlLW9iamVjdCBmcm9tIGEgbm9uLXNlZWthYmxlCiAgICAgICAgICAgICAgICAjIHN0cmVhbSBvZiB0YXIgYmxvY2tzLgogICAgICAgICAgICAgICAgcmFpc2UgU3RyZWFtRXJyb3IoImNhbm5vdCBleHRyYWN0IChzeW0pbGluayBhcyBmaWxlIG9iamVjdCIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAjIEEgKHN5bSlsaW5rJ3MgZmlsZSBvYmplY3QgaXMgaXRzIHRhcmdldCdzIGZpbGUgb2JqZWN0LgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZXh0cmFjdGZpbGUoc2VsZi5fZmluZF9saW5rX3RhcmdldCh0YXJpbmZvKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIElmIHRoZXJlJ3Mgbm8gZGF0YSBhc3NvY2lhdGVkIHdpdGggdGhlIG1lbWJlciAoZGlyZWN0b3J5LCBjaHJkZXYsCiAgICAgICAgICAgICMgYmxrZGV2LCBldGMuKSwgcmV0dXJuIE5vbmUgaW5zdGVhZCBvZiBhIGZpbGUgb2JqZWN0LgogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBfZXh0cmFjdF9tZW1iZXIoc2VsZiwgdGFyaW5mbywgdGFyZ2V0cGF0aCwgc2V0X2F0dHJzPVRydWUpOgogICAgICAgICIiIkV4dHJhY3QgdGhlIFRhckluZm8gb2JqZWN0IHRhcmluZm8gdG8gYSBwaHlzaWNhbAogICAgICAgICAgIGZpbGUgY2FsbGVkIHRhcmdldHBhdGguCiAgICAgICAgIiIiCiAgICAgICAgIyBGZXRjaCB0aGUgVGFySW5mbyBvYmplY3QgZm9yIHRoZSBnaXZlbiBuYW1lCiAgICAgICAgIyBhbmQgYnVpbGQgdGhlIGRlc3RpbmF0aW9uIHBhdGhuYW1lLCByZXBsYWNpbmcKICAgICAgICAjIGZvcndhcmQgc2xhc2hlcyB0byBwbGF0Zm9ybSBzcGVjaWZpYyBzZXBhcmF0b3JzLgogICAgICAgIHRhcmdldHBhdGggPSB0YXJnZXRwYXRoLnJzdHJpcCgiLyIpCiAgICAgICAgdGFyZ2V0cGF0aCA9IHRhcmdldHBhdGgucmVwbGFjZSgiLyIsIG9zLnNlcCkKCiAgICAgICAgIyBDcmVhdGUgYWxsIHVwcGVyIGRpcmVjdG9yaWVzLgogICAgICAgIHVwcGVyZGlycyA9IG9zLnBhdGguZGlybmFtZSh0YXJnZXRwYXRoKQogICAgICAgIGlmIHVwcGVyZGlycyBhbmQgbm90IG9zLnBhdGguZXhpc3RzKHVwcGVyZGlycyk6CiAgICAgICAgICAgICMgQ3JlYXRlIGRpcmVjdG9yaWVzIHRoYXQgYXJlIG5vdCBwYXJ0IG9mIHRoZSBhcmNoaXZlIHdpdGgKICAgICAgICAgICAgIyBkZWZhdWx0IHBlcm1pc3Npb25zLgogICAgICAgICAgICBvcy5tYWtlZGlycyh1cHBlcmRpcnMpCgogICAgICAgIGlmIHRhcmluZm8uaXNsbmsoKSBvciB0YXJpbmZvLmlzc3ltKCk6CiAgICAgICAgICAgIHNlbGYuX2RiZygxLCAiJXMgLT4gJXMiICUgKHRhcmluZm8ubmFtZSwgdGFyaW5mby5saW5rbmFtZSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5fZGJnKDEsIHRhcmluZm8ubmFtZSkKCiAgICAgICAgaWYgdGFyaW5mby5pc3JlZygpOgogICAgICAgICAgICBzZWxmLm1ha2VmaWxlKHRhcmluZm8sIHRhcmdldHBhdGgpCiAgICAgICAgZWxpZiB0YXJpbmZvLmlzZGlyKCk6CiAgICAgICAgICAgIHNlbGYubWFrZWRpcih0YXJpbmZvLCB0YXJnZXRwYXRoKQogICAgICAgIGVsaWYgdGFyaW5mby5pc2ZpZm8oKToKICAgICAgICAgICAgc2VsZi5tYWtlZmlmbyh0YXJpbmZvLCB0YXJnZXRwYXRoKQogICAgICAgIGVsaWYgdGFyaW5mby5pc2NocigpIG9yIHRhcmluZm8uaXNibGsoKToKICAgICAgICAgICAgc2VsZi5tYWtlZGV2KHRhcmluZm8sIHRhcmdldHBhdGgpCiAgICAgICAgZWxpZiB0YXJpbmZvLmlzbG5rKCkgb3IgdGFyaW5mby5pc3N5bSgpOgogICAgICAgICAgICBzZWxmLm1ha2VsaW5rKHRhcmluZm8sIHRhcmdldHBhdGgpCiAgICAgICAgZWxpZiB0YXJpbmZvLnR5cGUgbm90IGluIFNVUFBPUlRFRF9UWVBFUzoKICAgICAgICAgICAgc2VsZi5tYWtldW5rbm93bih0YXJpbmZvLCB0YXJnZXRwYXRoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYubWFrZWZpbGUodGFyaW5mbywgdGFyZ2V0cGF0aCkKCiAgICAgICAgaWYgc2V0X2F0dHJzOgogICAgICAgICAgICBzZWxmLmNob3duKHRhcmluZm8sIHRhcmdldHBhdGgpCiAgICAgICAgICAgIGlmIG5vdCB0YXJpbmZvLmlzc3ltKCk6CiAgICAgICAgICAgICAgICBzZWxmLmNobW9kKHRhcmluZm8sIHRhcmdldHBhdGgpCiAgICAgICAgICAgICAgICBzZWxmLnV0aW1lKHRhcmluZm8sIHRhcmdldHBhdGgpCgogICAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAjIEJlbG93IGFyZSB0aGUgZGlmZmVyZW50IGZpbGUgbWV0aG9kcy4gVGhleSBhcmUgY2FsbGVkIHZpYQogICAgIyBfZXh0cmFjdF9tZW1iZXIoKSB3aGVuIGV4dHJhY3QoKSBpcyBjYWxsZWQuIFRoZXkgY2FuIGJlIHJlcGxhY2VkIGluIGEKICAgICMgc3ViY2xhc3MgdG8gaW1wbGVtZW50IG90aGVyIGZ1bmN0aW9uYWxpdHkuCgogICAgZGVmIG1ha2VkaXIoc2VsZiwgdGFyaW5mbywgdGFyZ2V0cGF0aCk6CiAgICAgICAgIiIiTWFrZSBhIGRpcmVjdG9yeSBjYWxsZWQgdGFyZ2V0cGF0aC4KICAgICAgICAiIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgVXNlIGEgc2FmZSBtb2RlIGZvciB0aGUgZGlyZWN0b3J5LCB0aGUgcmVhbCBtb2RlIGlzIHNldAogICAgICAgICAgICAjIGxhdGVyIGluIF9leHRyYWN0X21lbWJlcigpLgogICAgICAgICAgICBvcy5ta2Rpcih0YXJnZXRwYXRoLCAwbzcwMCkKICAgICAgICBleGNlcHQgRmlsZUV4aXN0c0Vycm9yOgogICAgICAgICAgICBwYXNzCgogICAgZGVmIG1ha2VmaWxlKHNlbGYsIHRhcmluZm8sIHRhcmdldHBhdGgpOgogICAgICAgICIiIk1ha2UgYSBmaWxlIGNhbGxlZCB0YXJnZXRwYXRoLgogICAgICAgICIiIgogICAgICAgIHNvdXJjZSA9IHNlbGYuZmlsZW9iagogICAgICAgIHNvdXJjZS5zZWVrKHRhcmluZm8ub2Zmc2V0X2RhdGEpCiAgICAgICAgdGFyZ2V0ID0gYmx0bl9vcGVuKHRhcmdldHBhdGgsICJ3YiIpCiAgICAgICAgaWYgdGFyaW5mby5zcGFyc2UgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGZvciBvZmZzZXQsIHNpemUgaW4gdGFyaW5mby5zcGFyc2U6CiAgICAgICAgICAgICAgICB0YXJnZXQuc2VlayhvZmZzZXQpCiAgICAgICAgICAgICAgICBjb3B5ZmlsZW9iaihzb3VyY2UsIHRhcmdldCwgc2l6ZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBjb3B5ZmlsZW9iaihzb3VyY2UsIHRhcmdldCwgdGFyaW5mby5zaXplKQogICAgICAgIHRhcmdldC5zZWVrKHRhcmluZm8uc2l6ZSkKICAgICAgICB0YXJnZXQudHJ1bmNhdGUoKQogICAgICAgIHRhcmdldC5jbG9zZSgpCgogICAgZGVmIG1ha2V1bmtub3duKHNlbGYsIHRhcmluZm8sIHRhcmdldHBhdGgpOgogICAgICAgICIiIk1ha2UgYSBmaWxlIGZyb20gYSBUYXJJbmZvIG9iamVjdCB3aXRoIGFuIHVua25vd24gdHlwZQogICAgICAgICAgIGF0IHRhcmdldHBhdGguCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5tYWtlZmlsZSh0YXJpbmZvLCB0YXJnZXRwYXRoKQogICAgICAgIHNlbGYuX2RiZygxLCAidGFyZmlsZTogVW5rbm93biBmaWxlIHR5cGUgJXIsICIgXAogICAgICAgICAgICAgICAgICAgICAiZXh0cmFjdGVkIGFzIHJlZ3VsYXIgZmlsZS4iICUgdGFyaW5mby50eXBlKQoKICAgIGRlZiBtYWtlZmlmbyhzZWxmLCB0YXJpbmZvLCB0YXJnZXRwYXRoKToKICAgICAgICAiIiJNYWtlIGEgZmlmbyBjYWxsZWQgdGFyZ2V0cGF0aC4KICAgICAgICAiIiIKICAgICAgICBpZiBoYXNhdHRyKG9zLCAibWtmaWZvIik6CiAgICAgICAgICAgIG9zLm1rZmlmbyh0YXJnZXRwYXRoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIEV4dHJhY3RFcnJvcigiZmlmbyBub3Qgc3VwcG9ydGVkIGJ5IHN5c3RlbSIpCgogICAgZGVmIG1ha2VkZXYoc2VsZiwgdGFyaW5mbywgdGFyZ2V0cGF0aCk6CiAgICAgICAgIiIiTWFrZSBhIGNoYXJhY3RlciBvciBibG9jayBkZXZpY2UgY2FsbGVkIHRhcmdldHBhdGguCiAgICAgICAgIiIiCiAgICAgICAgaWYgbm90IGhhc2F0dHIob3MsICJta25vZCIpIG9yIG5vdCBoYXNhdHRyKG9zLCAibWFrZWRldiIpOgogICAgICAgICAgICByYWlzZSBFeHRyYWN0RXJyb3IoInNwZWNpYWwgZGV2aWNlcyBub3Qgc3VwcG9ydGVkIGJ5IHN5c3RlbSIpCgogICAgICAgIG1vZGUgPSB0YXJpbmZvLm1vZGUKICAgICAgICBpZiB0YXJpbmZvLmlzYmxrKCk6CiAgICAgICAgICAgIG1vZGUgfD0gc3RhdC5TX0lGQkxLCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbW9kZSB8PSBzdGF0LlNfSUZDSFIKCiAgICAgICAgb3MubWtub2QodGFyZ2V0cGF0aCwgbW9kZSwKICAgICAgICAgICAgICAgICBvcy5tYWtlZGV2KHRhcmluZm8uZGV2bWFqb3IsIHRhcmluZm8uZGV2bWlub3IpKQoKICAgIGRlZiBtYWtlbGluayhzZWxmLCB0YXJpbmZvLCB0YXJnZXRwYXRoKToKICAgICAgICAiIiJNYWtlIGEgKHN5bWJvbGljKSBsaW5rIGNhbGxlZCB0YXJnZXRwYXRoLiBJZiBpdCBjYW5ub3QgYmUgY3JlYXRlZAogICAgICAgICAgKHBsYXRmb3JtIGxpbWl0YXRpb24pLCB3ZSB0cnkgdG8gbWFrZSBhIGNvcHkgb2YgdGhlIHJlZmVyZW5jZWQgZmlsZQogICAgICAgICAgaW5zdGVhZCBvZiBhIGxpbmsuCiAgICAgICAgIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICAjIEZvciBzeXN0ZW1zIHRoYXQgc3VwcG9ydCBzeW1ib2xpYyBhbmQgaGFyZCBsaW5rcy4KICAgICAgICAgICAgaWYgdGFyaW5mby5pc3N5bSgpOgogICAgICAgICAgICAgICAgb3Muc3ltbGluayh0YXJpbmZvLmxpbmtuYW1lLCB0YXJnZXRwYXRoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgIyBTZWUgZXh0cmFjdCgpLgogICAgICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHModGFyaW5mby5fbGlua190YXJnZXQpOgogICAgICAgICAgICAgICAgICAgIG9zLmxpbmsodGFyaW5mby5fbGlua190YXJnZXQsIHRhcmdldHBhdGgpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX2V4dHJhY3RfbWVtYmVyKHNlbGYuX2ZpbmRfbGlua190YXJnZXQodGFyaW5mbyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0cGF0aCkKICAgICAgICBleGNlcHQgc3ltbGlua19leGNlcHRpb246CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYuX2V4dHJhY3RfbWVtYmVyKHNlbGYuX2ZpbmRfbGlua190YXJnZXQodGFyaW5mbyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRwYXRoKQogICAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgICAgICByYWlzZSBFeHRyYWN0RXJyb3IoInVuYWJsZSB0byByZXNvbHZlIGxpbmsgaW5zaWRlIGFyY2hpdmUiKQoKICAgIGRlZiBjaG93bihzZWxmLCB0YXJpbmZvLCB0YXJnZXRwYXRoKToKICAgICAgICAiIiJTZXQgb3duZXIgb2YgdGFyZ2V0cGF0aCBhY2NvcmRpbmcgdG8gdGFyaW5mby4KICAgICAgICAiIiIKICAgICAgICBpZiBwd2QgYW5kIGhhc2F0dHIob3MsICJnZXRldWlkIikgYW5kIG9zLmdldGV1aWQoKSA9PSAwOgogICAgICAgICAgICAjIFdlIGhhdmUgdG8gYmUgcm9vdCB0byBkbyBzby4KICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZyA9IGdycC5nZXRncm5hbSh0YXJpbmZvLmduYW1lKVsyXQogICAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgICAgICBnID0gdGFyaW5mby5naWQKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgdSA9IHB3ZC5nZXRwd25hbSh0YXJpbmZvLnVuYW1lKVsyXQogICAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgICAgICB1ID0gdGFyaW5mby51aWQKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgaWYgdGFyaW5mby5pc3N5bSgpIGFuZCBoYXNhdHRyKG9zLCAibGNob3duIik6CiAgICAgICAgICAgICAgICAgICAgb3MubGNob3duKHRhcmdldHBhdGgsIHUsIGcpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGlmIHN5cy5wbGF0Zm9ybSAhPSAib3MyZW14IjoKICAgICAgICAgICAgICAgICAgICAgICAgb3MuY2hvd24odGFyZ2V0cGF0aCwgdSwgZykKICAgICAgICAgICAgZXhjZXB0IEVudmlyb25tZW50RXJyb3IgYXMgZToKICAgICAgICAgICAgICAgIHJhaXNlIEV4dHJhY3RFcnJvcigiY291bGQgbm90IGNoYW5nZSBvd25lciIpCgogICAgZGVmIGNobW9kKHNlbGYsIHRhcmluZm8sIHRhcmdldHBhdGgpOgogICAgICAgICIiIlNldCBmaWxlIHBlcm1pc3Npb25zIG9mIHRhcmdldHBhdGggYWNjb3JkaW5nIHRvIHRhcmluZm8uCiAgICAgICAgIiIiCiAgICAgICAgaWYgaGFzYXR0cihvcywgJ2NobW9kJyk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIG9zLmNobW9kKHRhcmdldHBhdGgsIHRhcmluZm8ubW9kZSkKICAgICAgICAgICAgZXhjZXB0IEVudmlyb25tZW50RXJyb3IgYXMgZToKICAgICAgICAgICAgICAgIHJhaXNlIEV4dHJhY3RFcnJvcigiY291bGQgbm90IGNoYW5nZSBtb2RlIikKCiAgICBkZWYgdXRpbWUoc2VsZiwgdGFyaW5mbywgdGFyZ2V0cGF0aCk6CiAgICAgICAgIiIiU2V0IG1vZGlmaWNhdGlvbiB0aW1lIG9mIHRhcmdldHBhdGggYWNjb3JkaW5nIHRvIHRhcmluZm8uCiAgICAgICAgIiIiCiAgICAgICAgaWYgbm90IGhhc2F0dHIob3MsICd1dGltZScpOgogICAgICAgICAgICByZXR1cm4KICAgICAgICB0cnk6CiAgICAgICAgICAgIG9zLnV0aW1lKHRhcmdldHBhdGgsICh0YXJpbmZvLm10aW1lLCB0YXJpbmZvLm10aW1lKSkKICAgICAgICBleGNlcHQgRW52aXJvbm1lbnRFcnJvciBhcyBlOgogICAgICAgICAgICByYWlzZSBFeHRyYWN0RXJyb3IoImNvdWxkIG5vdCBjaGFuZ2UgbW9kaWZpY2F0aW9uIHRpbWUiKQoKICAgICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgZGVmIG5leHQoc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIHRoZSBuZXh0IG1lbWJlciBvZiB0aGUgYXJjaGl2ZSBhcyBhIFRhckluZm8gb2JqZWN0LCB3aGVuCiAgICAgICAgICAgVGFyRmlsZSBpcyBvcGVuZWQgZm9yIHJlYWRpbmcuIFJldHVybiBOb25lIGlmIHRoZXJlIGlzIG5vIG1vcmUKICAgICAgICAgICBhdmFpbGFibGUuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fY2hlY2soInJhIikKICAgICAgICBpZiBzZWxmLmZpcnN0bWVtYmVyIGlzIG5vdCBOb25lOgogICAgICAgICAgICBtID0gc2VsZi5maXJzdG1lbWJlcgogICAgICAgICAgICBzZWxmLmZpcnN0bWVtYmVyID0gTm9uZQogICAgICAgICAgICByZXR1cm4gbQoKICAgICAgICAjIFJlYWQgdGhlIG5leHQgYmxvY2suCiAgICAgICAgc2VsZi5maWxlb2JqLnNlZWsoc2VsZi5vZmZzZXQpCiAgICAgICAgdGFyaW5mbyA9IE5vbmUKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB0YXJpbmZvID0gc2VsZi50YXJpbmZvLmZyb210YXJmaWxlKHNlbGYpCiAgICAgICAgICAgIGV4Y2VwdCBFT0ZIZWFkZXJFcnJvciBhcyBlOgogICAgICAgICAgICAgICAgaWYgc2VsZi5pZ25vcmVfemVyb3M6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5fZGJnKDIsICIweCVYOiAlcyIgJSAoc2VsZi5vZmZzZXQsIGUpKQogICAgICAgICAgICAgICAgICAgIHNlbGYub2Zmc2V0ICs9IEJMT0NLU0laRQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGV4Y2VwdCBJbnZhbGlkSGVhZGVyRXJyb3IgYXMgZToKICAgICAgICAgICAgICAgIGlmIHNlbGYuaWdub3JlX3plcm9zOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX2RiZygyLCAiMHglWDogJXMiICUgKHNlbGYub2Zmc2V0LCBlKSkKICAgICAgICAgICAgICAgICAgICBzZWxmLm9mZnNldCArPSBCTE9DS1NJWkUKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgZWxpZiBzZWxmLm9mZnNldCA9PSAwOgogICAgICAgICAgICAgICAgICAgIHJhaXNlIFJlYWRFcnJvcihzdHIoZSkpCiAgICAgICAgICAgIGV4Y2VwdCBFbXB0eUhlYWRlckVycm9yOgogICAgICAgICAgICAgICAgaWYgc2VsZi5vZmZzZXQgPT0gMDoKICAgICAgICAgICAgICAgICAgICByYWlzZSBSZWFkRXJyb3IoImVtcHR5IGZpbGUiKQogICAgICAgICAgICBleGNlcHQgVHJ1bmNhdGVkSGVhZGVyRXJyb3IgYXMgZToKICAgICAgICAgICAgICAgIGlmIHNlbGYub2Zmc2V0ID09IDA6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgUmVhZEVycm9yKHN0cihlKSkKICAgICAgICAgICAgZXhjZXB0IFN1YnNlcXVlbnRIZWFkZXJFcnJvciBhcyBlOgogICAgICAgICAgICAgICAgcmFpc2UgUmVhZEVycm9yKHN0cihlKSkKICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgaWYgdGFyaW5mbyBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5tZW1iZXJzLmFwcGVuZCh0YXJpbmZvKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuX2xvYWRlZCA9IFRydWUKCiAgICAgICAgcmV0dXJuIHRhcmluZm8KCiAgICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICMgTGl0dGxlIGhlbHBlciBtZXRob2RzOgoKICAgIGRlZiBfZ2V0bWVtYmVyKHNlbGYsIG5hbWUsIHRhcmluZm89Tm9uZSwgbm9ybWFsaXplPUZhbHNlKToKICAgICAgICAiIiJGaW5kIGFuIGFyY2hpdmUgbWVtYmVyIGJ5IG5hbWUgZnJvbSBib3R0b20gdG8gdG9wLgogICAgICAgICAgIElmIHRhcmluZm8gaXMgZ2l2ZW4sIGl0IGlzIHVzZWQgYXMgdGhlIHN0YXJ0aW5nIHBvaW50LgogICAgICAgICIiIgogICAgICAgICMgRW5zdXJlIHRoYXQgYWxsIG1lbWJlcnMgaGF2ZSBiZWVuIGxvYWRlZC4KICAgICAgICBtZW1iZXJzID0gc2VsZi5nZXRtZW1iZXJzKCkKCiAgICAgICAgIyBMaW1pdCB0aGUgbWVtYmVyIHNlYXJjaCBsaXN0IHVwIHRvIHRhcmluZm8uCiAgICAgICAgaWYgdGFyaW5mbyBpcyBub3QgTm9uZToKICAgICAgICAgICAgbWVtYmVycyA9IG1lbWJlcnNbOm1lbWJlcnMuaW5kZXgodGFyaW5mbyldCgogICAgICAgIGlmIG5vcm1hbGl6ZToKICAgICAgICAgICAgbmFtZSA9IG9zLnBhdGgubm9ybXBhdGgobmFtZSkKCiAgICAgICAgZm9yIG1lbWJlciBpbiByZXZlcnNlZChtZW1iZXJzKToKICAgICAgICAgICAgaWYgbm9ybWFsaXplOgogICAgICAgICAgICAgICAgbWVtYmVyX25hbWUgPSBvcy5wYXRoLm5vcm1wYXRoKG1lbWJlci5uYW1lKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgbWVtYmVyX25hbWUgPSBtZW1iZXIubmFtZQoKICAgICAgICAgICAgaWYgbmFtZSA9PSBtZW1iZXJfbmFtZToKICAgICAgICAgICAgICAgIHJldHVybiBtZW1iZXIKCiAgICBkZWYgX2xvYWQoc2VsZik6CiAgICAgICAgIiIiUmVhZCB0aHJvdWdoIHRoZSBlbnRpcmUgYXJjaGl2ZSBmaWxlIGFuZCBsb29rIGZvciByZWFkYWJsZQogICAgICAgICAgIG1lbWJlcnMuCiAgICAgICAgIiIiCiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgdGFyaW5mbyA9IHNlbGYubmV4dCgpCiAgICAgICAgICAgIGlmIHRhcmluZm8gaXMgTm9uZToKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgc2VsZi5fbG9hZGVkID0gVHJ1ZQoKICAgIGRlZiBfY2hlY2soc2VsZiwgbW9kZT1Ob25lKToKICAgICAgICAiIiJDaGVjayBpZiBUYXJGaWxlIGlzIHN0aWxsIG9wZW4sIGFuZCBpZiB0aGUgb3BlcmF0aW9uJ3MgbW9kZQogICAgICAgICAgIGNvcnJlc3BvbmRzIHRvIFRhckZpbGUncyBtb2RlLgogICAgICAgICIiIgogICAgICAgIGlmIHNlbGYuY2xvc2VkOgogICAgICAgICAgICByYWlzZSBJT0Vycm9yKCIlcyBpcyBjbG9zZWQiICUgc2VsZi5fX2NsYXNzX18uX19uYW1lX18pCiAgICAgICAgaWYgbW9kZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5tb2RlIG5vdCBpbiBtb2RlOgogICAgICAgICAgICByYWlzZSBJT0Vycm9yKCJiYWQgb3BlcmF0aW9uIGZvciBtb2RlICVyIiAlIHNlbGYubW9kZSkKCiAgICBkZWYgX2ZpbmRfbGlua190YXJnZXQoc2VsZiwgdGFyaW5mbyk6CiAgICAgICAgIiIiRmluZCB0aGUgdGFyZ2V0IG1lbWJlciBvZiBhIHN5bWxpbmsgb3IgaGFyZGxpbmsgbWVtYmVyIGluIHRoZQogICAgICAgICAgIGFyY2hpdmUuCiAgICAgICAgIiIiCiAgICAgICAgaWYgdGFyaW5mby5pc3N5bSgpOgogICAgICAgICAgICAjIEFsd2F5cyBzZWFyY2ggdGhlIGVudGlyZSBhcmNoaXZlLgogICAgICAgICAgICBsaW5rbmFtZSA9ICIvIi5qb2luKGZpbHRlcihOb25lLCAob3MucGF0aC5kaXJuYW1lKHRhcmluZm8ubmFtZSksIHRhcmluZm8ubGlua25hbWUpKSkKICAgICAgICAgICAgbGltaXQgPSBOb25lCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyBTZWFyY2ggdGhlIGFyY2hpdmUgYmVmb3JlIHRoZSBsaW5rLCBiZWNhdXNlIGEgaGFyZCBsaW5rIGlzCiAgICAgICAgICAgICMganVzdCBhIHJlZmVyZW5jZSB0byBhbiBhbHJlYWR5IGFyY2hpdmVkIGZpbGUuCiAgICAgICAgICAgIGxpbmtuYW1lID0gdGFyaW5mby5saW5rbmFtZQogICAgICAgICAgICBsaW1pdCA9IHRhcmluZm8KCiAgICAgICAgbWVtYmVyID0gc2VsZi5fZ2V0bWVtYmVyKGxpbmtuYW1lLCB0YXJpbmZvPWxpbWl0LCBub3JtYWxpemU9VHJ1ZSkKICAgICAgICBpZiBtZW1iZXIgaXMgTm9uZToKICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3IoImxpbmtuYW1lICVyIG5vdCBmb3VuZCIgJSBsaW5rbmFtZSkKICAgICAgICByZXR1cm4gbWVtYmVyCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgICIiIlByb3ZpZGUgYW4gaXRlcmF0b3Igb2JqZWN0LgogICAgICAgICIiIgogICAgICAgIGlmIHNlbGYuX2xvYWRlZDoKICAgICAgICAgICAgcmV0dXJuIGl0ZXIoc2VsZi5tZW1iZXJzKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBUYXJJdGVyKHNlbGYpCgogICAgZGVmIF9kYmcoc2VsZiwgbGV2ZWwsIG1zZyk6CiAgICAgICAgIiIiV3JpdGUgZGVidWdnaW5nIG91dHB1dCB0byBzeXMuc3RkZXJyLgogICAgICAgICIiIgogICAgICAgIGlmIGxldmVsIDw9IHNlbGYuZGVidWc6CiAgICAgICAgICAgIHByaW50KG1zZywgZmlsZT1zeXMuc3RkZXJyKQoKICAgIGRlZiBfX2VudGVyX18oc2VsZik6CiAgICAgICAgc2VsZi5fY2hlY2soKQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fZXhpdF9fKHNlbGYsIHR5cGUsIHZhbHVlLCB0cmFjZWJhY2spOgogICAgICAgIGlmIHR5cGUgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5jbG9zZSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyBBbiBleGNlcHRpb24gb2NjdXJyZWQuIFdlIG11c3Qgbm90IGNhbGwgY2xvc2UoKSBiZWNhdXNlCiAgICAgICAgICAgICMgaXQgd291bGQgdHJ5IHRvIHdyaXRlIGVuZC1vZi1hcmNoaXZlIGJsb2NrcyBhbmQgcGFkZGluZy4KICAgICAgICAgICAgaWYgbm90IHNlbGYuX2V4dGZpbGVvYmo6CiAgICAgICAgICAgICAgICBzZWxmLmZpbGVvYmouY2xvc2UoKQogICAgICAgICAgICBzZWxmLmNsb3NlZCA9IFRydWUKIyBjbGFzcyBUYXJGaWxlCgpjbGFzcyBUYXJJdGVyOgogICAgIiIiSXRlcmF0b3IgQ2xhc3MuCgogICAgICAgZm9yIHRhcmluZm8gaW4gVGFyRmlsZSguLi4pOgogICAgICAgICAgIHN1aXRlLi4uCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgdGFyZmlsZSk6CiAgICAgICAgIiIiQ29uc3RydWN0IGEgVGFySXRlciBvYmplY3QuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi50YXJmaWxlID0gdGFyZmlsZQogICAgICAgIHNlbGYuaW5kZXggPSAwCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIGl0ZXJhdG9yIG9iamVjdC4KICAgICAgICAiIiIKICAgICAgICByZXR1cm4gc2VsZgogICAgZGVmIF9fbmV4dF9fKHNlbGYpOgogICAgICAgICIiIlJldHVybiB0aGUgbmV4dCBpdGVtIHVzaW5nIFRhckZpbGUncyBuZXh0KCkgbWV0aG9kLgogICAgICAgICAgIFdoZW4gYWxsIG1lbWJlcnMgaGF2ZSBiZWVuIHJlYWQsIHNldCBUYXJGaWxlIGFzIF9sb2FkZWQuCiAgICAgICAgIiIiCiAgICAgICAgIyBGaXggZm9yIFNGICMxMTAwNDI5OiBVbmRlciByYXJlIGNpcmN1bXN0YW5jZXMgaXQgY2FuCiAgICAgICAgIyBoYXBwZW4gdGhhdCBnZXRtZW1iZXJzKCkgaXMgY2FsbGVkIGR1cmluZyBpdGVyYXRpb24sCiAgICAgICAgIyB3aGljaCB3aWxsIGNhdXNlIFRhckl0ZXIgdG8gc3RvcCBwcmVtYXR1cmVseS4KICAgICAgICBpZiBub3Qgc2VsZi50YXJmaWxlLl9sb2FkZWQ6CiAgICAgICAgICAgIHRhcmluZm8gPSBzZWxmLnRhcmZpbGUubmV4dCgpCiAgICAgICAgICAgIGlmIG5vdCB0YXJpbmZvOgogICAgICAgICAgICAgICAgc2VsZi50YXJmaWxlLl9sb2FkZWQgPSBUcnVlCiAgICAgICAgICAgICAgICByYWlzZSBTdG9wSXRlcmF0aW9uCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgdGFyaW5mbyA9IHNlbGYudGFyZmlsZS5tZW1iZXJzW3NlbGYuaW5kZXhdCiAgICAgICAgICAgIGV4Y2VwdCBJbmRleEVycm9yOgogICAgICAgICAgICAgICAgcmFpc2UgU3RvcEl0ZXJhdGlvbgogICAgICAgIHNlbGYuaW5kZXggKz0gMQogICAgICAgIHJldHVybiB0YXJpbmZvCgojLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBleHBvcnRlZCBmdW5jdGlvbnMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tCmRlZiBpc190YXJmaWxlKG5hbWUpOgogICAgIiIiUmV0dXJuIFRydWUgaWYgbmFtZSBwb2ludHMgdG8gYSB0YXIgYXJjaGl2ZSB0aGF0IHdlCiAgICAgICBhcmUgYWJsZSB0byBoYW5kbGUsIGVsc2UgcmV0dXJuIEZhbHNlLgogICAgIiIiCiAgICB0cnk6CiAgICAgICAgdCA9IG9wZW4obmFtZSkKICAgICAgICB0LmNsb3NlKCkKICAgICAgICByZXR1cm4gVHJ1ZQogICAgZXhjZXB0IFRhckVycm9yOgogICAgICAgIHJldHVybiBGYWxzZQoKYmx0bl9vcGVuID0gb3BlbgpvcGVuID0gVGFyRmlsZS5vcGVuCg==',
'/Lib/textwrap.py':'IiIiVGV4dCB3cmFwcGluZyBhbmQgZmlsbGluZy4KIiIiCgojIENvcHlyaWdodCAoQykgMTk5OS0yMDAxIEdyZWdvcnkgUC4gV2FyZC4KIyBDb3B5cmlnaHQgKEMpIDIwMDIsIDIwMDMgUHl0aG9uIFNvZnR3YXJlIEZvdW5kYXRpb24uCiMgV3JpdHRlbiBieSBHcmVnIFdhcmQgPGd3YXJkQHB5dGhvbi5uZXQ+CgppbXBvcnQgcmUKCl9fYWxsX18gPSBbJ1RleHRXcmFwcGVyJywgJ3dyYXAnLCAnZmlsbCcsICdkZWRlbnQnLCAnaW5kZW50J10KCiMgSGFyZGNvZGUgdGhlIHJlY29nbml6ZWQgd2hpdGVzcGFjZSBjaGFyYWN0ZXJzIHRvIHRoZSBVUy1BU0NJSQojIHdoaXRlc3BhY2UgY2hhcmFjdGVycy4gIFRoZSBtYWluIHJlYXNvbiBmb3IgZG9pbmcgdGhpcyBpcyB0aGF0IGluCiMgSVNPLTg4NTktMSwgMHhhMCBpcyBub24tYnJlYWtpbmcgd2hpdGVzcGFjZSwgc28gaW4gY2VydGFpbiBsb2NhbGVzCiMgdGhhdCBjaGFyYWN0ZXIgd2luZHMgdXAgaW4gc3RyaW5nLndoaXRlc3BhY2UuICBSZXNwZWN0aW5nCiMgc3RyaW5nLndoaXRlc3BhY2UgaW4gdGhvc2UgY2FzZXMgd291bGQgMSkgbWFrZSB0ZXh0d3JhcCB0cmVhdCAweGEwIHRoZQojIHNhbWUgYXMgYW55IG90aGVyIHdoaXRlc3BhY2UgY2hhciwgd2hpY2ggaXMgY2xlYXJseSB3cm9uZyAoaXQncyBhCiMgKm5vbi1icmVha2luZyogc3BhY2UpLCAyKSBwb3NzaWJseSBjYXVzZSBwcm9ibGVtcyB3aXRoIFVuaWNvZGUsCiMgc2luY2UgMHhhMCBpcyBub3QgaW4gcmFuZ2UoMTI4KS4KX3doaXRlc3BhY2UgPSAnXHRcblx4MGJceDBjXHIgJwoKY2xhc3MgVGV4dFdyYXBwZXI6CiAgICAiIiIKICAgIE9iamVjdCBmb3Igd3JhcHBpbmcvZmlsbGluZyB0ZXh0LiAgVGhlIHB1YmxpYyBpbnRlcmZhY2UgY29uc2lzdHMgb2YKICAgIHRoZSB3cmFwKCkgYW5kIGZpbGwoKSBtZXRob2RzOyB0aGUgb3RoZXIgbWV0aG9kcyBhcmUganVzdCB0aGVyZSBmb3IKICAgIHN1YmNsYXNzZXMgdG8gb3ZlcnJpZGUgaW4gb3JkZXIgdG8gdHdlYWsgdGhlIGRlZmF1bHQgYmVoYXZpb3VyLgogICAgSWYgeW91IHdhbnQgdG8gY29tcGxldGVseSByZXBsYWNlIHRoZSBtYWluIHdyYXBwaW5nIGFsZ29yaXRobSwKICAgIHlvdSdsbCBwcm9iYWJseSBoYXZlIHRvIG92ZXJyaWRlIF93cmFwX2NodW5rcygpLgoKICAgIFNldmVyYWwgaW5zdGFuY2UgYXR0cmlidXRlcyBjb250cm9sIHZhcmlvdXMgYXNwZWN0cyBvZiB3cmFwcGluZzoKICAgICAgd2lkdGggKGRlZmF1bHQ6IDcwKQogICAgICAgIHRoZSBtYXhpbXVtIHdpZHRoIG9mIHdyYXBwZWQgbGluZXMgKHVubGVzcyBicmVha19sb25nX3dvcmRzCiAgICAgICAgaXMgZmFsc2UpCiAgICAgIGluaXRpYWxfaW5kZW50IChkZWZhdWx0OiAiIikKICAgICAgICBzdHJpbmcgdGhhdCB3aWxsIGJlIHByZXBlbmRlZCB0byB0aGUgZmlyc3QgbGluZSBvZiB3cmFwcGVkCiAgICAgICAgb3V0cHV0LiAgQ291bnRzIHRvd2FyZHMgdGhlIGxpbmUncyB3aWR0aC4KICAgICAgc3Vic2VxdWVudF9pbmRlbnQgKGRlZmF1bHQ6ICIiKQogICAgICAgIHN0cmluZyB0aGF0IHdpbGwgYmUgcHJlcGVuZGVkIHRvIGFsbCBsaW5lcyBzYXZlIHRoZSBmaXJzdAogICAgICAgIG9mIHdyYXBwZWQgb3V0cHV0OyBhbHNvIGNvdW50cyB0b3dhcmRzIGVhY2ggbGluZSdzIHdpZHRoLgogICAgICBleHBhbmRfdGFicyAoZGVmYXVsdDogdHJ1ZSkKICAgICAgICBFeHBhbmQgdGFicyBpbiBpbnB1dCB0ZXh0IHRvIHNwYWNlcyBiZWZvcmUgZnVydGhlciBwcm9jZXNzaW5nLgogICAgICAgIEVhY2ggdGFiIHdpbGwgYmVjb21lIDAgLi4gJ3RhYnNpemUnIHNwYWNlcywgZGVwZW5kaW5nIG9uIGl0cyBwb3NpdGlvbgogICAgICAgIGluIGl0cyBsaW5lLiAgSWYgZmFsc2UsIGVhY2ggdGFiIGlzIHRyZWF0ZWQgYXMgYSBzaW5nbGUgY2hhcmFjdGVyLgogICAgICB0YWJzaXplIChkZWZhdWx0OiA4KQogICAgICAgIEV4cGFuZCB0YWJzIGluIGlucHV0IHRleHQgdG8gMCAuLiAndGFic2l6ZScgc3BhY2VzLCB1bmxlc3MKICAgICAgICAnZXhwYW5kX3RhYnMnIGlzIGZhbHNlLgogICAgICByZXBsYWNlX3doaXRlc3BhY2UgKGRlZmF1bHQ6IHRydWUpCiAgICAgICAgUmVwbGFjZSBhbGwgd2hpdGVzcGFjZSBjaGFyYWN0ZXJzIGluIHRoZSBpbnB1dCB0ZXh0IGJ5IHNwYWNlcwogICAgICAgIGFmdGVyIHRhYiBleHBhbnNpb24uICBOb3RlIHRoYXQgaWYgZXhwYW5kX3RhYnMgaXMgZmFsc2UgYW5kCiAgICAgICAgcmVwbGFjZV93aGl0ZXNwYWNlIGlzIHRydWUsIGV2ZXJ5IHRhYiB3aWxsIGJlIGNvbnZlcnRlZCB0byBhCiAgICAgICAgc2luZ2xlIHNwYWNlIQogICAgICBmaXhfc2VudGVuY2VfZW5kaW5ncyAoZGVmYXVsdDogZmFsc2UpCiAgICAgICAgRW5zdXJlIHRoYXQgc2VudGVuY2UtZW5kaW5nIHB1bmN0dWF0aW9uIGlzIGFsd2F5cyBmb2xsb3dlZAogICAgICAgIGJ5IHR3byBzcGFjZXMuICBPZmYgYnkgZGVmYXVsdCBiZWNhdXNlIHRoZSBhbGdvcml0aG0gaXMKICAgICAgICAodW5hdm9pZGFibHkpIGltcGVyZmVjdC4KICAgICAgYnJlYWtfbG9uZ193b3JkcyAoZGVmYXVsdDogdHJ1ZSkKICAgICAgICBCcmVhayB3b3JkcyBsb25nZXIgdGhhbiAnd2lkdGgnLiAgSWYgZmFsc2UsIHRob3NlIHdvcmRzIHdpbGwgbm90CiAgICAgICAgYmUgYnJva2VuLCBhbmQgc29tZSBsaW5lcyBtaWdodCBiZSBsb25nZXIgdGhhbiAnd2lkdGgnLgogICAgICBicmVha19vbl9oeXBoZW5zIChkZWZhdWx0OiB0cnVlKQogICAgICAgIEFsbG93IGJyZWFraW5nIGh5cGhlbmF0ZWQgd29yZHMuIElmIHRydWUsIHdyYXBwaW5nIHdpbGwgb2NjdXIKICAgICAgICBwcmVmZXJhYmx5IG9uIHdoaXRlc3BhY2VzIGFuZCByaWdodCBhZnRlciBoeXBoZW5zIHBhcnQgb2YKICAgICAgICBjb21wb3VuZCB3b3Jkcy4KICAgICAgZHJvcF93aGl0ZXNwYWNlIChkZWZhdWx0OiB0cnVlKQogICAgICAgIERyb3AgbGVhZGluZyBhbmQgdHJhaWxpbmcgd2hpdGVzcGFjZSBmcm9tIGxpbmVzLgogICAgIiIiCgogICAgdW5pY29kZV93aGl0ZXNwYWNlX3RyYW5zID0ge30KICAgIHVzcGFjZSA9IG9yZCgnICcpCiAgICBmb3IgeCBpbiBfd2hpdGVzcGFjZToKICAgICAgICB1bmljb2RlX3doaXRlc3BhY2VfdHJhbnNbb3JkKHgpXSA9IHVzcGFjZQoKICAgICMgVGhpcyBmdW5reSBsaXR0bGUgcmVnZXggaXMganVzdCB0aGUgdHJpY2sgZm9yIHNwbGl0dGluZwogICAgIyB0ZXh0IHVwIGludG8gd29yZC13cmFwcGFibGUgY2h1bmtzLiAgRS5nLgogICAgIyAgICJIZWxsbyB0aGVyZSAtLSB5b3UgZ29vZi1iYWxsLCB1c2UgdGhlIC1iIG9wdGlvbiEiCiAgICAjIHNwbGl0cyBpbnRvCiAgICAjICAgSGVsbG8vIC90aGVyZS8gLy0tLyAveW91LyAvZ29vZi0vYmFsbCwvIC91c2UvIC90aGUvIC8tYi8gL29wdGlvbiEKICAgICMgKGFmdGVyIHN0cmlwcGluZyBvdXQgZW1wdHkgc3RyaW5ncykuCiAgICB3b3Jkc2VwX3JlID0gcmUuY29tcGlsZSgKICAgICAgICByJyhccyt8JyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGFueSB3aGl0ZXNwYWNlCiAgICAgICAgcidbXlxzXHddKlx3K1teMC05XFddLSg/PVx3K1teMC05XFddKXwnICAgIyBoeXBoZW5hdGVkIHdvcmRzCiAgICAgICAgcicoPzw9W1x3XCFcIlwnXCZcLlwsXD9dKS17Mix9KD89XHcpKScpICAgIyBlbS1kYXNoCgogICAgIyBUaGlzIGxlc3MgZnVua3kgbGl0dGxlIHJlZ2V4IGp1c3Qgc3BsaXQgb24gcmVjb2duaXplZCBzcGFjZXMuIEUuZy4KICAgICMgICAiSGVsbG8gdGhlcmUgLS0geW91IGdvb2YtYmFsbCwgdXNlIHRoZSAtYiBvcHRpb24hIgogICAgIyBzcGxpdHMgaW50bwogICAgIyAgIEhlbGxvLyAvdGhlcmUvIC8tLS8gL3lvdS8gL2dvb2YtYmFsbCwvIC91c2UvIC90aGUvIC8tYi8gL29wdGlvbiEvCiAgICB3b3Jkc2VwX3NpbXBsZV9yZSA9IHJlLmNvbXBpbGUocicoXHMrKScpCgogICAgIyBYWFggdGhpcyBpcyBub3QgbG9jYWxlLSBvciBjaGFyc2V0LWF3YXJlIC0tIHN0cmluZy5sb3dlcmNhc2UKICAgICMgaXMgVVMtQVNDSUkgb25seSAoYW5kIHRoZXJlZm9yZSBFbmdsaXNoLW9ubHkpCiAgICBzZW50ZW5jZV9lbmRfcmUgPSByZS5jb21waWxlKHInW2Etel0nICAgICAgICAgICAgICMgbG93ZXJjYXNlIGxldHRlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByJ1tcLlwhXD9dJyAgICAgICAgICAjIHNlbnRlbmNlLWVuZGluZyBwdW5jdC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcidbXCJcJ10/JyAgICAgICAgICAgIyBvcHRpb25hbCBlbmQtb2YtcXVvdGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcidcWicpICAgICAgICAgICAgICAgIyBlbmQgb2YgY2h1bmsKCgogICAgZGVmIF9faW5pdF9fKHNlbGYsCiAgICAgICAgICAgICAgICAgd2lkdGg9NzAsCiAgICAgICAgICAgICAgICAgaW5pdGlhbF9pbmRlbnQ9IiIsCiAgICAgICAgICAgICAgICAgc3Vic2VxdWVudF9pbmRlbnQ9IiIsCiAgICAgICAgICAgICAgICAgZXhwYW5kX3RhYnM9VHJ1ZSwKICAgICAgICAgICAgICAgICByZXBsYWNlX3doaXRlc3BhY2U9VHJ1ZSwKICAgICAgICAgICAgICAgICBmaXhfc2VudGVuY2VfZW5kaW5ncz1GYWxzZSwKICAgICAgICAgICAgICAgICBicmVha19sb25nX3dvcmRzPVRydWUsCiAgICAgICAgICAgICAgICAgZHJvcF93aGl0ZXNwYWNlPVRydWUsCiAgICAgICAgICAgICAgICAgYnJlYWtfb25faHlwaGVucz1UcnVlLAogICAgICAgICAgICAgICAgIHRhYnNpemU9OCk6CiAgICAgICAgc2VsZi53aWR0aCA9IHdpZHRoCiAgICAgICAgc2VsZi5pbml0aWFsX2luZGVudCA9IGluaXRpYWxfaW5kZW50CiAgICAgICAgc2VsZi5zdWJzZXF1ZW50X2luZGVudCA9IHN1YnNlcXVlbnRfaW5kZW50CiAgICAgICAgc2VsZi5leHBhbmRfdGFicyA9IGV4cGFuZF90YWJzCiAgICAgICAgc2VsZi5yZXBsYWNlX3doaXRlc3BhY2UgPSByZXBsYWNlX3doaXRlc3BhY2UKICAgICAgICBzZWxmLmZpeF9zZW50ZW5jZV9lbmRpbmdzID0gZml4X3NlbnRlbmNlX2VuZGluZ3MKICAgICAgICBzZWxmLmJyZWFrX2xvbmdfd29yZHMgPSBicmVha19sb25nX3dvcmRzCiAgICAgICAgc2VsZi5kcm9wX3doaXRlc3BhY2UgPSBkcm9wX3doaXRlc3BhY2UKICAgICAgICBzZWxmLmJyZWFrX29uX2h5cGhlbnMgPSBicmVha19vbl9oeXBoZW5zCiAgICAgICAgc2VsZi50YWJzaXplID0gdGFic2l6ZQoKCiAgICAjIC0tIFByaXZhdGUgbWV0aG9kcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgIyAocG9zc2libHkgdXNlZnVsIGZvciBzdWJjbGFzc2VzIHRvIG92ZXJyaWRlKQoKICAgIGRlZiBfbXVuZ2Vfd2hpdGVzcGFjZShzZWxmLCB0ZXh0KToKICAgICAgICAiIiJfbXVuZ2Vfd2hpdGVzcGFjZSh0ZXh0IDogc3RyaW5nKSAtPiBzdHJpbmcKCiAgICAgICAgTXVuZ2Ugd2hpdGVzcGFjZSBpbiB0ZXh0OiBleHBhbmQgdGFicyBhbmQgY29udmVydCBhbGwgb3RoZXIKICAgICAgICB3aGl0ZXNwYWNlIGNoYXJhY3RlcnMgdG8gc3BhY2VzLiAgRWcuICIgZm9vXHRiYXJcblxuYmF6IgogICAgICAgIGJlY29tZXMgIiBmb28gICAgYmFyICBiYXoiLgogICAgICAgICIiIgogICAgICAgIGlmIHNlbGYuZXhwYW5kX3RhYnM6CiAgICAgICAgICAgIHRleHQgPSB0ZXh0LmV4cGFuZHRhYnMoc2VsZi50YWJzaXplKQogICAgICAgIGlmIHNlbGYucmVwbGFjZV93aGl0ZXNwYWNlOgogICAgICAgICAgICB0ZXh0ID0gdGV4dC50cmFuc2xhdGUoc2VsZi51bmljb2RlX3doaXRlc3BhY2VfdHJhbnMpCiAgICAgICAgcmV0dXJuIHRleHQKCgogICAgZGVmIF9zcGxpdChzZWxmLCB0ZXh0KToKICAgICAgICAiIiJfc3BsaXQodGV4dCA6IHN0cmluZykgLT4gW3N0cmluZ10KCiAgICAgICAgU3BsaXQgdGhlIHRleHQgdG8gd3JhcCBpbnRvIGluZGl2aXNpYmxlIGNodW5rcy4gIENodW5rcyBhcmUKICAgICAgICBub3QgcXVpdGUgdGhlIHNhbWUgYXMgd29yZHM7IHNlZSBfd3JhcF9jaHVua3MoKSBmb3IgZnVsbAogICAgICAgIGRldGFpbHMuICBBcyBhbiBleGFtcGxlLCB0aGUgdGV4dAogICAgICAgICAgTG9vaywgZ29vZi1iYWxsIC0tIHVzZSB0aGUgLWIgb3B0aW9uIQogICAgICAgIGJyZWFrcyBpbnRvIHRoZSBmb2xsb3dpbmcgY2h1bmtzOgogICAgICAgICAgJ0xvb2ssJywgJyAnLCAnZ29vZi0nLCAnYmFsbCcsICcgJywgJy0tJywgJyAnLAogICAgICAgICAgJ3VzZScsICcgJywgJ3RoZScsICcgJywgJy1iJywgJyAnLCAnb3B0aW9uIScKICAgICAgICBpZiBicmVha19vbl9oeXBoZW5zIGlzIFRydWUsIG9yIGluOgogICAgICAgICAgJ0xvb2ssJywgJyAnLCAnZ29vZi1iYWxsJywgJyAnLCAnLS0nLCAnICcsCiAgICAgICAgICAndXNlJywgJyAnLCAndGhlJywgJyAnLCAnLWInLCAnICcsIG9wdGlvbiEnCiAgICAgICAgb3RoZXJ3aXNlLgogICAgICAgICIiIgogICAgICAgIGlmIHNlbGYuYnJlYWtfb25faHlwaGVucyBpcyBUcnVlOgogICAgICAgICAgICBjaHVua3MgPSBzZWxmLndvcmRzZXBfcmUuc3BsaXQodGV4dCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBjaHVua3MgPSBzZWxmLndvcmRzZXBfc2ltcGxlX3JlLnNwbGl0KHRleHQpCiAgICAgICAgY2h1bmtzID0gW2MgZm9yIGMgaW4gY2h1bmtzIGlmIGNdCiAgICAgICAgcmV0dXJuIGNodW5rcwoKICAgIGRlZiBfZml4X3NlbnRlbmNlX2VuZGluZ3Moc2VsZiwgY2h1bmtzKToKICAgICAgICAiIiJfZml4X3NlbnRlbmNlX2VuZGluZ3MoY2h1bmtzIDogW3N0cmluZ10pCgogICAgICAgIENvcnJlY3QgZm9yIHNlbnRlbmNlIGVuZGluZ3MgYnVyaWVkIGluICdjaHVua3MnLiAgRWcuIHdoZW4gdGhlCiAgICAgICAgb3JpZ2luYWwgdGV4dCBjb250YWlucyAiLi4uIGZvby5cbkJhciAuLi4iLCBtdW5nZV93aGl0ZXNwYWNlKCkKICAgICAgICBhbmQgc3BsaXQoKSB3aWxsIGNvbnZlcnQgdGhhdCB0byBbLi4uLCAiZm9vLiIsICIgIiwgIkJhciIsIC4uLl0KICAgICAgICB3aGljaCBoYXMgb25lIHRvbyBmZXcgc3BhY2VzOyB0aGlzIG1ldGhvZCBzaW1wbHkgY2hhbmdlcyB0aGUgb25lCiAgICAgICAgc3BhY2UgdG8gdHdvLgogICAgICAgICIiIgogICAgICAgIGkgPSAwCiAgICAgICAgcGF0c2VhcmNoID0gc2VsZi5zZW50ZW5jZV9lbmRfcmUuc2VhcmNoCiAgICAgICAgd2hpbGUgaSA8IGxlbihjaHVua3MpLTE6CiAgICAgICAgICAgIGlmIGNodW5rc1tpKzFdID09ICIgIiBhbmQgcGF0c2VhcmNoKGNodW5rc1tpXSk6CiAgICAgICAgICAgICAgICBjaHVua3NbaSsxXSA9ICIgICIKICAgICAgICAgICAgICAgIGkgKz0gMgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaSArPSAxCgogICAgZGVmIF9oYW5kbGVfbG9uZ193b3JkKHNlbGYsIHJldmVyc2VkX2NodW5rcywgY3VyX2xpbmUsIGN1cl9sZW4sIHdpZHRoKToKICAgICAgICAiIiJfaGFuZGxlX2xvbmdfd29yZChjaHVua3MgOiBbc3RyaW5nXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJfbGluZSA6IFtzdHJpbmddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cl9sZW4gOiBpbnQsIHdpZHRoIDogaW50KQoKICAgICAgICBIYW5kbGUgYSBjaHVuayBvZiB0ZXh0IChtb3N0IGxpa2VseSBhIHdvcmQsIG5vdCB3aGl0ZXNwYWNlKSB0aGF0CiAgICAgICAgaXMgdG9vIGxvbmcgdG8gZml0IGluIGFueSBsaW5lLgogICAgICAgICIiIgogICAgICAgICMgRmlndXJlIG91dCB3aGVuIGluZGVudCBpcyBsYXJnZXIgdGhhbiB0aGUgc3BlY2lmaWVkIHdpZHRoLCBhbmQgbWFrZQogICAgICAgICMgc3VyZSBhdCBsZWFzdCBvbmUgY2hhcmFjdGVyIGlzIHN0cmlwcGVkIG9mZiBvbiBldmVyeSBwYXNzCiAgICAgICAgaWYgd2lkdGggPCAxOgogICAgICAgICAgICBzcGFjZV9sZWZ0ID0gMQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNwYWNlX2xlZnQgPSB3aWR0aCAtIGN1cl9sZW4KCiAgICAgICAgIyBJZiB3ZSdyZSBhbGxvd2VkIHRvIGJyZWFrIGxvbmcgd29yZHMsIHRoZW4gZG8gc286IHB1dCBhcyBtdWNoCiAgICAgICAgIyBvZiB0aGUgbmV4dCBjaHVuayBvbnRvIHRoZSBjdXJyZW50IGxpbmUgYXMgd2lsbCBmaXQuCiAgICAgICAgaWYgc2VsZi5icmVha19sb25nX3dvcmRzOgogICAgICAgICAgICBjdXJfbGluZS5hcHBlbmQocmV2ZXJzZWRfY2h1bmtzWy0xXVs6c3BhY2VfbGVmdF0pCiAgICAgICAgICAgIHJldmVyc2VkX2NodW5rc1stMV0gPSByZXZlcnNlZF9jaHVua3NbLTFdW3NwYWNlX2xlZnQ6XQoKICAgICAgICAjIE90aGVyd2lzZSwgd2UgaGF2ZSB0byBwcmVzZXJ2ZSB0aGUgbG9uZyB3b3JkIGludGFjdC4gIE9ubHkgYWRkCiAgICAgICAgIyBpdCB0byB0aGUgY3VycmVudCBsaW5lIGlmIHRoZXJlJ3Mgbm90aGluZyBhbHJlYWR5IHRoZXJlIC0tCiAgICAgICAgIyB0aGF0IG1pbmltaXplcyBob3cgbXVjaCB3ZSB2aW9sYXRlIHRoZSB3aWR0aCBjb25zdHJhaW50LgogICAgICAgIGVsaWYgbm90IGN1cl9saW5lOgogICAgICAgICAgICBjdXJfbGluZS5hcHBlbmQocmV2ZXJzZWRfY2h1bmtzLnBvcCgpKQoKICAgICAgICAjIElmIHdlJ3JlIG5vdCBhbGxvd2VkIHRvIGJyZWFrIGxvbmcgd29yZHMsIGFuZCB0aGVyZSdzIGFscmVhZHkKICAgICAgICAjIHRleHQgb24gdGhlIGN1cnJlbnQgbGluZSwgZG8gbm90aGluZy4gIE5leHQgdGltZSB0aHJvdWdoIHRoZQogICAgICAgICMgbWFpbiBsb29wIG9mIF93cmFwX2NodW5rcygpLCB3ZSdsbCB3aW5kIHVwIGhlcmUgYWdhaW4sIGJ1dAogICAgICAgICMgY3VyX2xlbiB3aWxsIGJlIHplcm8sIHNvIHRoZSBuZXh0IGxpbmUgd2lsbCBiZSBlbnRpcmVseQogICAgICAgICMgZGV2b3RlZCB0byB0aGUgbG9uZyB3b3JkIHRoYXQgd2UgY2FuJ3QgaGFuZGxlIHJpZ2h0IG5vdy4KCiAgICBkZWYgX3dyYXBfY2h1bmtzKHNlbGYsIGNodW5rcyk6CiAgICAgICAgIiIiX3dyYXBfY2h1bmtzKGNodW5rcyA6IFtzdHJpbmddKSAtPiBbc3RyaW5nXQoKICAgICAgICBXcmFwIGEgc2VxdWVuY2Ugb2YgdGV4dCBjaHVua3MgYW5kIHJldHVybiBhIGxpc3Qgb2YgbGluZXMgb2YKICAgICAgICBsZW5ndGggJ3NlbGYud2lkdGgnIG9yIGxlc3MuICAoSWYgJ2JyZWFrX2xvbmdfd29yZHMnIGlzIGZhbHNlLAogICAgICAgIHNvbWUgbGluZXMgbWF5IGJlIGxvbmdlciB0aGFuIHRoaXMuKSAgQ2h1bmtzIGNvcnJlc3BvbmQgcm91Z2hseQogICAgICAgIHRvIHdvcmRzIGFuZCB0aGUgd2hpdGVzcGFjZSBiZXR3ZWVuIHRoZW06IGVhY2ggY2h1bmsgaXMKICAgICAgICBpbmRpdmlzaWJsZSAobW9kdWxvICdicmVha19sb25nX3dvcmRzJyksIGJ1dCBhIGxpbmUgYnJlYWsgY2FuCiAgICAgICAgY29tZSBiZXR3ZWVuIGFueSB0d28gY2h1bmtzLiAgQ2h1bmtzIHNob3VsZCBub3QgaGF2ZSBpbnRlcm5hbAogICAgICAgIHdoaXRlc3BhY2U7IGllLiBhIGNodW5rIGlzIGVpdGhlciBhbGwgd2hpdGVzcGFjZSBvciBhICJ3b3JkIi4KICAgICAgICBXaGl0ZXNwYWNlIGNodW5rcyB3aWxsIGJlIHJlbW92ZWQgZnJvbSB0aGUgYmVnaW5uaW5nIGFuZCBlbmQgb2YKICAgICAgICBsaW5lcywgYnV0IGFwYXJ0IGZyb20gdGhhdCB3aGl0ZXNwYWNlIGlzIHByZXNlcnZlZC4KICAgICAgICAiIiIKICAgICAgICBsaW5lcyA9IFtdCiAgICAgICAgaWYgc2VsZi53aWR0aCA8PSAwOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJpbnZhbGlkIHdpZHRoICVyIChtdXN0IGJlID4gMCkiICUgc2VsZi53aWR0aCkKCiAgICAgICAgIyBBcnJhbmdlIGluIHJldmVyc2Ugb3JkZXIgc28gaXRlbXMgY2FuIGJlIGVmZmljaWVudGx5IHBvcHBlZAogICAgICAgICMgZnJvbSBhIHN0YWNrIG9mIGNodWNrcy4KICAgICAgICBjaHVua3MucmV2ZXJzZSgpCgogICAgICAgIHdoaWxlIGNodW5rczoKCiAgICAgICAgICAgICMgU3RhcnQgdGhlIGxpc3Qgb2YgY2h1bmtzIHRoYXQgd2lsbCBtYWtlIHVwIHRoZSBjdXJyZW50IGxpbmUuCiAgICAgICAgICAgICMgY3VyX2xlbiBpcyBqdXN0IHRoZSBsZW5ndGggb2YgYWxsIHRoZSBjaHVua3MgaW4gY3VyX2xpbmUuCiAgICAgICAgICAgIGN1cl9saW5lID0gW10KICAgICAgICAgICAgY3VyX2xlbiA9IDAKCiAgICAgICAgICAgICMgRmlndXJlIG91dCB3aGljaCBzdGF0aWMgc3RyaW5nIHdpbGwgcHJlZml4IHRoaXMgbGluZS4KICAgICAgICAgICAgaWYgbGluZXM6CiAgICAgICAgICAgICAgICBpbmRlbnQgPSBzZWxmLnN1YnNlcXVlbnRfaW5kZW50CiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpbmRlbnQgPSBzZWxmLmluaXRpYWxfaW5kZW50CgogICAgICAgICAgICAjIE1heGltdW0gd2lkdGggZm9yIHRoaXMgbGluZS4KICAgICAgICAgICAgd2lkdGggPSBzZWxmLndpZHRoIC0gbGVuKGluZGVudCkKCiAgICAgICAgICAgICMgRmlyc3QgY2h1bmsgb24gbGluZSBpcyB3aGl0ZXNwYWNlIC0tIGRyb3AgaXQsIHVubGVzcyB0aGlzCiAgICAgICAgICAgICMgaXMgdGhlIHZlcnkgYmVnaW5uaW5nIG9mIHRoZSB0ZXh0IChpZS4gbm8gbGluZXMgc3RhcnRlZCB5ZXQpLgogICAgICAgICAgICBpZiBzZWxmLmRyb3Bfd2hpdGVzcGFjZSBhbmQgY2h1bmtzWy0xXS5zdHJpcCgpID09ICcnIGFuZCBsaW5lczoKICAgICAgICAgICAgICAgIGRlbCBjaHVua3NbLTFdCgogICAgICAgICAgICB3aGlsZSBjaHVua3M6CiAgICAgICAgICAgICAgICBsID0gbGVuKGNodW5rc1stMV0pCgogICAgICAgICAgICAgICAgIyBDYW4gYXQgbGVhc3Qgc3F1ZWV6ZSB0aGlzIGNodW5rIG9udG8gdGhlIGN1cnJlbnQgbGluZS4KICAgICAgICAgICAgICAgIGlmIGN1cl9sZW4gKyBsIDw9IHdpZHRoOgogICAgICAgICAgICAgICAgICAgIGN1cl9saW5lLmFwcGVuZChjaHVua3MucG9wKCkpCiAgICAgICAgICAgICAgICAgICAgY3VyX2xlbiArPSBsCgogICAgICAgICAgICAgICAgIyBOb3BlLCB0aGlzIGxpbmUgaXMgZnVsbC4KICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgICAgICMgVGhlIGN1cnJlbnQgbGluZSBpcyBmdWxsLCBhbmQgdGhlIG5leHQgY2h1bmsgaXMgdG9vIGJpZyB0bwogICAgICAgICAgICAjIGZpdCBvbiAqYW55KiBsaW5lIChub3QganVzdCB0aGlzIG9uZSkuCiAgICAgICAgICAgIGlmIGNodW5rcyBhbmQgbGVuKGNodW5rc1stMV0pID4gd2lkdGg6CiAgICAgICAgICAgICAgICBzZWxmLl9oYW5kbGVfbG9uZ193b3JkKGNodW5rcywgY3VyX2xpbmUsIGN1cl9sZW4sIHdpZHRoKQoKICAgICAgICAgICAgIyBJZiB0aGUgbGFzdCBjaHVuayBvbiB0aGlzIGxpbmUgaXMgYWxsIHdoaXRlc3BhY2UsIGRyb3AgaXQuCiAgICAgICAgICAgIGlmIHNlbGYuZHJvcF93aGl0ZXNwYWNlIGFuZCBjdXJfbGluZSBhbmQgY3VyX2xpbmVbLTFdLnN0cmlwKCkgPT0gJyc6CiAgICAgICAgICAgICAgICBkZWwgY3VyX2xpbmVbLTFdCgogICAgICAgICAgICAjIENvbnZlcnQgY3VycmVudCBsaW5lIGJhY2sgdG8gYSBzdHJpbmcgYW5kIHN0b3JlIGl0IGluIGxpc3QKICAgICAgICAgICAgIyBvZiBhbGwgbGluZXMgKHJldHVybiB2YWx1ZSkuCiAgICAgICAgICAgIGlmIGN1cl9saW5lOgogICAgICAgICAgICAgICAgbGluZXMuYXBwZW5kKGluZGVudCArICcnLmpvaW4oY3VyX2xpbmUpKQoKICAgICAgICByZXR1cm4gbGluZXMKCgogICAgIyAtLSBQdWJsaWMgaW50ZXJmYWNlIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiAgICBkZWYgd3JhcChzZWxmLCB0ZXh0KToKICAgICAgICAiIiJ3cmFwKHRleHQgOiBzdHJpbmcpIC0+IFtzdHJpbmddCgogICAgICAgIFJlZm9ybWF0IHRoZSBzaW5nbGUgcGFyYWdyYXBoIGluICd0ZXh0JyBzbyBpdCBmaXRzIGluIGxpbmVzIG9mCiAgICAgICAgbm8gbW9yZSB0aGFuICdzZWxmLndpZHRoJyBjb2x1bW5zLCBhbmQgcmV0dXJuIGEgbGlzdCBvZiB3cmFwcGVkCiAgICAgICAgbGluZXMuICBUYWJzIGluICd0ZXh0JyBhcmUgZXhwYW5kZWQgd2l0aCBzdHJpbmcuZXhwYW5kdGFicygpLAogICAgICAgIGFuZCBhbGwgb3RoZXIgd2hpdGVzcGFjZSBjaGFyYWN0ZXJzIChpbmNsdWRpbmcgbmV3bGluZSkgYXJlCiAgICAgICAgY29udmVydGVkIHRvIHNwYWNlLgogICAgICAgICIiIgogICAgICAgIHRleHQgPSBzZWxmLl9tdW5nZV93aGl0ZXNwYWNlKHRleHQpCiAgICAgICAgY2h1bmtzID0gc2VsZi5fc3BsaXQodGV4dCkKICAgICAgICBpZiBzZWxmLmZpeF9zZW50ZW5jZV9lbmRpbmdzOgogICAgICAgICAgICBzZWxmLl9maXhfc2VudGVuY2VfZW5kaW5ncyhjaHVua3MpCiAgICAgICAgcmV0dXJuIHNlbGYuX3dyYXBfY2h1bmtzKGNodW5rcykKCiAgICBkZWYgZmlsbChzZWxmLCB0ZXh0KToKICAgICAgICAiIiJmaWxsKHRleHQgOiBzdHJpbmcpIC0+IHN0cmluZwoKICAgICAgICBSZWZvcm1hdCB0aGUgc2luZ2xlIHBhcmFncmFwaCBpbiAndGV4dCcgdG8gZml0IGluIGxpbmVzIG9mIG5vCiAgICAgICAgbW9yZSB0aGFuICdzZWxmLndpZHRoJyBjb2x1bW5zLCBhbmQgcmV0dXJuIGEgbmV3IHN0cmluZwogICAgICAgIGNvbnRhaW5pbmcgdGhlIGVudGlyZSB3cmFwcGVkIHBhcmFncmFwaC4KICAgICAgICAiIiIKICAgICAgICByZXR1cm4gIlxuIi5qb2luKHNlbGYud3JhcCh0ZXh0KSkKCgojIC0tIENvbnZlbmllbmNlIGludGVyZmFjZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmRlZiB3cmFwKHRleHQsIHdpZHRoPTcwLCAqKmt3YXJncyk6CiAgICAiIiJXcmFwIGEgc2luZ2xlIHBhcmFncmFwaCBvZiB0ZXh0LCByZXR1cm5pbmcgYSBsaXN0IG9mIHdyYXBwZWQgbGluZXMuCgogICAgUmVmb3JtYXQgdGhlIHNpbmdsZSBwYXJhZ3JhcGggaW4gJ3RleHQnIHNvIGl0IGZpdHMgaW4gbGluZXMgb2Ygbm8KICAgIG1vcmUgdGhhbiAnd2lkdGgnIGNvbHVtbnMsIGFuZCByZXR1cm4gYSBsaXN0IG9mIHdyYXBwZWQgbGluZXMuICBCeQogICAgZGVmYXVsdCwgdGFicyBpbiAndGV4dCcgYXJlIGV4cGFuZGVkIHdpdGggc3RyaW5nLmV4cGFuZHRhYnMoKSwgYW5kCiAgICBhbGwgb3RoZXIgd2hpdGVzcGFjZSBjaGFyYWN0ZXJzIChpbmNsdWRpbmcgbmV3bGluZSkgYXJlIGNvbnZlcnRlZCB0bwogICAgc3BhY2UuICBTZWUgVGV4dFdyYXBwZXIgY2xhc3MgZm9yIGF2YWlsYWJsZSBrZXl3b3JkIGFyZ3MgdG8gY3VzdG9taXplCiAgICB3cmFwcGluZyBiZWhhdmlvdXIuCiAgICAiIiIKICAgIHcgPSBUZXh0V3JhcHBlcih3aWR0aD13aWR0aCwgKiprd2FyZ3MpCiAgICByZXR1cm4gdy53cmFwKHRleHQpCgpkZWYgZmlsbCh0ZXh0LCB3aWR0aD03MCwgKiprd2FyZ3MpOgogICAgIiIiRmlsbCBhIHNpbmdsZSBwYXJhZ3JhcGggb2YgdGV4dCwgcmV0dXJuaW5nIGEgbmV3IHN0cmluZy4KCiAgICBSZWZvcm1hdCB0aGUgc2luZ2xlIHBhcmFncmFwaCBpbiAndGV4dCcgdG8gZml0IGluIGxpbmVzIG9mIG5vIG1vcmUKICAgIHRoYW4gJ3dpZHRoJyBjb2x1bW5zLCBhbmQgcmV0dXJuIGEgbmV3IHN0cmluZyBjb250YWluaW5nIHRoZSBlbnRpcmUKICAgIHdyYXBwZWQgcGFyYWdyYXBoLiAgQXMgd2l0aCB3cmFwKCksIHRhYnMgYXJlIGV4cGFuZGVkIGFuZCBvdGhlcgogICAgd2hpdGVzcGFjZSBjaGFyYWN0ZXJzIGNvbnZlcnRlZCB0byBzcGFjZS4gIFNlZSBUZXh0V3JhcHBlciBjbGFzcyBmb3IKICAgIGF2YWlsYWJsZSBrZXl3b3JkIGFyZ3MgdG8gY3VzdG9taXplIHdyYXBwaW5nIGJlaGF2aW91ci4KICAgICIiIgogICAgdyA9IFRleHRXcmFwcGVyKHdpZHRoPXdpZHRoLCAqKmt3YXJncykKICAgIHJldHVybiB3LmZpbGwodGV4dCkKCgojIC0tIExvb3NlbHkgcmVsYXRlZCBmdW5jdGlvbmFsaXR5IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCl93aGl0ZXNwYWNlX29ubHlfcmUgPSByZS5jb21waWxlKCdeWyBcdF0rJCcsIHJlLk1VTFRJTElORSkKX2xlYWRpbmdfd2hpdGVzcGFjZV9yZSA9IHJlLmNvbXBpbGUoJyheWyBcdF0qKSg/OlteIFx0XG5dKScsIHJlLk1VTFRJTElORSkKCmRlZiBkZWRlbnQodGV4dCk6CiAgICAiIiJSZW1vdmUgYW55IGNvbW1vbiBsZWFkaW5nIHdoaXRlc3BhY2UgZnJvbSBldmVyeSBsaW5lIGluIGB0ZXh0YC4KCiAgICBUaGlzIGNhbiBiZSB1c2VkIHRvIG1ha2UgdHJpcGxlLXF1b3RlZCBzdHJpbmdzIGxpbmUgdXAgd2l0aCB0aGUgbGVmdAogICAgZWRnZSBvZiB0aGUgZGlzcGxheSwgd2hpbGUgc3RpbGwgcHJlc2VudGluZyB0aGVtIGluIHRoZSBzb3VyY2UgY29kZQogICAgaW4gaW5kZW50ZWQgZm9ybS4KCiAgICBOb3RlIHRoYXQgdGFicyBhbmQgc3BhY2VzIGFyZSBib3RoIHRyZWF0ZWQgYXMgd2hpdGVzcGFjZSwgYnV0IHRoZXkKICAgIGFyZSBub3QgZXF1YWw6IHRoZSBsaW5lcyAiICBoZWxsbyIgYW5kICJcdGhlbGxvIiBhcmUKICAgIGNvbnNpZGVyZWQgdG8gaGF2ZSBubyBjb21tb24gbGVhZGluZyB3aGl0ZXNwYWNlLiAgKFRoaXMgYmVoYXZpb3VyIGlzCiAgICBuZXcgaW4gUHl0aG9uIDIuNTsgb2xkZXIgdmVyc2lvbnMgb2YgdGhpcyBtb2R1bGUgaW5jb3JyZWN0bHkKICAgIGV4cGFuZGVkIHRhYnMgYmVmb3JlIHNlYXJjaGluZyBmb3IgY29tbW9uIGxlYWRpbmcgd2hpdGVzcGFjZS4pCiAgICAiIiIKICAgICMgTG9vayBmb3IgdGhlIGxvbmdlc3QgbGVhZGluZyBzdHJpbmcgb2Ygc3BhY2VzIGFuZCB0YWJzIGNvbW1vbiB0bwogICAgIyBhbGwgbGluZXMuCiAgICBtYXJnaW4gPSBOb25lCiAgICB0ZXh0ID0gX3doaXRlc3BhY2Vfb25seV9yZS5zdWIoJycsIHRleHQpCiAgICBpbmRlbnRzID0gX2xlYWRpbmdfd2hpdGVzcGFjZV9yZS5maW5kYWxsKHRleHQpCiAgICBmb3IgaW5kZW50IGluIGluZGVudHM6CiAgICAgICAgaWYgbWFyZ2luIGlzIE5vbmU6CiAgICAgICAgICAgIG1hcmdpbiA9IGluZGVudAoKICAgICAgICAjIEN1cnJlbnQgbGluZSBtb3JlIGRlZXBseSBpbmRlbnRlZCB0aGFuIHByZXZpb3VzIHdpbm5lcjoKICAgICAgICAjIG5vIGNoYW5nZSAocHJldmlvdXMgd2lubmVyIGlzIHN0aWxsIG9uIHRvcCkuCiAgICAgICAgZWxpZiBpbmRlbnQuc3RhcnRzd2l0aChtYXJnaW4pOgogICAgICAgICAgICBwYXNzCgogICAgICAgICMgQ3VycmVudCBsaW5lIGNvbnNpc3RlbnQgd2l0aCBhbmQgbm8gZGVlcGVyIHRoYW4gcHJldmlvdXMgd2lubmVyOgogICAgICAgICMgaXQncyB0aGUgbmV3IHdpbm5lci4KICAgICAgICBlbGlmIG1hcmdpbi5zdGFydHN3aXRoKGluZGVudCk6CiAgICAgICAgICAgIG1hcmdpbiA9IGluZGVudAoKICAgICAgICAjIEN1cnJlbnQgbGluZSBhbmQgcHJldmlvdXMgd2lubmVyIGhhdmUgbm8gY29tbW9uIHdoaXRlc3BhY2U6CiAgICAgICAgIyB0aGVyZSBpcyBubyBtYXJnaW4uCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbWFyZ2luID0gIiIKICAgICAgICAgICAgYnJlYWsKCiAgICAjIHNhbml0eSBjaGVjayAodGVzdGluZy9kZWJ1Z2dpbmcgb25seSkKICAgIGlmIDAgYW5kIG1hcmdpbjoKICAgICAgICBmb3IgbGluZSBpbiB0ZXh0LnNwbGl0KCJcbiIpOgogICAgICAgICAgICBhc3NlcnQgbm90IGxpbmUgb3IgbGluZS5zdGFydHN3aXRoKG1hcmdpbiksIFwKICAgICAgICAgICAgICAgICAgICJsaW5lID0gJXIsIG1hcmdpbiA9ICVyIiAlIChsaW5lLCBtYXJnaW4pCgogICAgaWYgbWFyZ2luOgogICAgICAgIHRleHQgPSByZS5zdWIocicoP20pXicgKyBtYXJnaW4sICcnLCB0ZXh0KQogICAgcmV0dXJuIHRleHQKCgpkZWYgaW5kZW50KHRleHQsIHByZWZpeCwgcHJlZGljYXRlPU5vbmUpOgogICAgIiIiQWRkcyAncHJlZml4JyB0byB0aGUgYmVnaW5uaW5nIG9mIHNlbGVjdGVkIGxpbmVzIGluICd0ZXh0Jy4KCiAgICBJZiAncHJlZGljYXRlJyBpcyBwcm92aWRlZCwgJ3ByZWZpeCcgd2lsbCBvbmx5IGJlIGFkZGVkIHRvIHRoZSBsaW5lcwogICAgd2hlcmUgJ3ByZWRpY2F0ZShsaW5lKScgaXMgVHJ1ZS4gSWYgJ3ByZWRpY2F0ZScgaXMgbm90IHByb3ZpZGVkLAogICAgaXQgd2lsbCBkZWZhdWx0IHRvIGFkZGluZyAncHJlZml4JyB0byBhbGwgbm9uLWVtcHR5IGxpbmVzIHRoYXQgZG8gbm90CiAgICBjb25zaXN0IHNvbGVseSBvZiB3aGl0ZXNwYWNlIGNoYXJhY3RlcnMuCiAgICAiIiIKICAgIGlmIHByZWRpY2F0ZSBpcyBOb25lOgogICAgICAgIGRlZiBwcmVkaWNhdGUobGluZSk6CiAgICAgICAgICAgIHJldHVybiBsaW5lLnN0cmlwKCkKCiAgICBkZWYgcHJlZml4ZWRfbGluZXMoKToKICAgICAgICBmb3IgbGluZSBpbiB0ZXh0LnNwbGl0bGluZXMoVHJ1ZSk6CiAgICAgICAgICAgIHlpZWxkIChwcmVmaXggKyBsaW5lIGlmIHByZWRpY2F0ZShsaW5lKSBlbHNlIGxpbmUpCiAgICByZXR1cm4gJycuam9pbihwcmVmaXhlZF9saW5lcygpKQoKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICAjcHJpbnQgZGVkZW50KCJcdGZvb1xuXHRiYXIiKQogICAgI3ByaW50IGRlZGVudCgiICBcdGhlbGxvIHRoZXJlXG4gIFx0ICBob3cgYXJlIHlvdT8iKQogICAgcHJpbnQoZGVkZW50KCJIZWxsbyB0aGVyZS5cbiAgVGhpcyBpcyBpbmRlbnRlZC4iKSkK',
'/Lib/this.py':'cyA9ICIiIkd1ciBNcmEgYnMgQ2xndWJhLCBvbCBHdnogQ3JncmVmCgpPcm5oZ3ZzaHkgdmYgb3JnZ3JlIGd1bmEgaHR5bC4KUmtjeXZwdmcgdmYgb3JnZ3JlIGd1bmEgdnpjeXZwdmcuCkZ2emN5ciB2ZiBvcmdncmUgZ3VuYSBwYnpjeXJrLgpQYnpjeXJrIHZmIG9yZ2dyZSBndW5hIHBiemN5dnBuZ3JxLgpTeW5nIHZmIG9yZ2dyZSBndW5hIGFyZmdycS4KRmNuZWZyIHZmIG9yZ2dyZSBndW5hIHFyYWZyLgpFcm5xbm92eXZnbCBwYmhhZ2YuCkZjcnB2bnkgcG5mcmYgbmVyYSdnIGZjcnB2bnkgcmFiaHR1IGdiIG9lcm54IGd1ciBlaHlyZi4KTnlndWJodHUgY2VucGd2cG55dmdsIG9ybmdmIGNoZXZnbC4KUmVlYmVmIGZ1Ymh5cSBhcmlyZSBjbmZmIGZ2eXJhZ3lsLgpIYXlyZmYgcmtjeXZwdmd5bCBmdnlyYXBycS4KVmEgZ3VyIHNucHIgYnMgbnpvdnRodmdsLCBlcnNoZnIgZ3VyIGdyemNnbmd2YmEgZ2IgdGhyZmYuCkd1cmVyIGZ1Ymh5cSBvciBiYXItLSBuYXEgY2Vyc3Jlbm95bCBiYXlsIGJhciAtLWJvaXZiaGYgam5sIGdiIHFiIHZnLgpOeWd1Ymh0dSBndW5nIGpubCB6bmwgYWJnIG9yIGJvaXZiaGYgbmcgc3ZlZmcgaGF5cmZmIGxiaCdlciBRaGdwdS4KQWJqIHZmIG9yZ2dyZSBndW5hIGFyaXJlLgpOeWd1Ymh0dSBhcmlyZSB2ZiBic2dyYSBvcmdncmUgZ3VuYSAqZXZ0dWcqIGFiai4KVnMgZ3VyIHZ6Y3lyenJhZ25ndmJhIHZmIHVuZXEgZ2IgcmtjeW52YSwgdmcnZiBuIG9ucSB2cXJuLgpWcyBndXIgdnpjeXJ6cmFnbmd2YmEgdmYgcm5mbCBnYiBya2N5bnZhLCB2ZyB6bmwgb3IgbiB0YmJxIHZxcm4uCkFuenJmY25wcmYgbmVyIGJhciB1YmF4dmF0IHRlcm5nIHZxcm4gLS0geXJnJ2YgcWIgemJlciBicyBndWJmciEiIiIKCmQgPSB7fQpmb3IgYyBpbiAoNjUsIDk3KToKICAgIGZvciBpIGluIHJhbmdlKDI2KToKICAgICAgICBkW2NocihpK2MpXSA9IGNocigoaSsxMykgJSAyNiArIGMpCgpwcmludCgiIi5qb2luKFtkLmdldChjLCBjKSBmb3IgYyBpbiBzXSkpCg==',
'/Lib/token.py':'IiIiVG9rZW4gY29uc3RhbnRzIChmcm9tICJ0b2tlbi5oIikuIiIiCgpfX2FsbF9fID0gWyd0b2tfbmFtZScsICdJU1RFUk1JTkFMJywgJ0lTTk9OVEVSTUlOQUwnLCAnSVNFT0YnXQoKIyAgVGhpcyBmaWxlIGlzIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVkOyBwbGVhc2UgZG9uJ3QgbXVjayBpdCB1cCEKIwojICBUbyB1cGRhdGUgdGhlIHN5bWJvbHMgaW4gdGhpcyBmaWxlLCAnY2QnIHRvIHRoZSB0b3AgZGlyZWN0b3J5IG9mCiMgIHRoZSBweXRob24gc291cmNlIHRyZWUgYWZ0ZXIgYnVpbGRpbmcgdGhlIGludGVycHJldGVyIGFuZCBydW46CiMKIyAgICAuL3B5dGhvbiBMaWIvdG9rZW4ucHkKCiMtLXN0YXJ0IGNvbnN0YW50cy0tCkVORE1BUktFUiA9IDAKTkFNRSA9IDEKTlVNQkVSID0gMgpTVFJJTkcgPSAzCk5FV0xJTkUgPSA0CklOREVOVCA9IDUKREVERU5UID0gNgpMUEFSID0gNwpSUEFSID0gOApMU1FCID0gOQpSU1FCID0gMTAKQ09MT04gPSAxMQpDT01NQSA9IDEyClNFTUkgPSAxMwpQTFVTID0gMTQKTUlOVVMgPSAxNQpTVEFSID0gMTYKU0xBU0ggPSAxNwpWQkFSID0gMTgKQU1QRVIgPSAxOQpMRVNTID0gMjAKR1JFQVRFUiA9IDIxCkVRVUFMID0gMjIKRE9UID0gMjMKUEVSQ0VOVCA9IDI0CkxCUkFDRSA9IDI1ClJCUkFDRSA9IDI2CkVRRVFVQUwgPSAyNwpOT1RFUVVBTCA9IDI4CkxFU1NFUVVBTCA9IDI5CkdSRUFURVJFUVVBTCA9IDMwClRJTERFID0gMzEKQ0lSQ1VNRkxFWCA9IDMyCkxFRlRTSElGVCA9IDMzClJJR0hUU0hJRlQgPSAzNApET1VCTEVTVEFSID0gMzUKUExVU0VRVUFMID0gMzYKTUlORVFVQUwgPSAzNwpTVEFSRVFVQUwgPSAzOApTTEFTSEVRVUFMID0gMzkKUEVSQ0VOVEVRVUFMID0gNDAKQU1QRVJFUVVBTCA9IDQxClZCQVJFUVVBTCA9IDQyCkNJUkNVTUZMRVhFUVVBTCA9IDQzCkxFRlRTSElGVEVRVUFMID0gNDQKUklHSFRTSElGVEVRVUFMID0gNDUKRE9VQkxFU1RBUkVRVUFMID0gNDYKRE9VQkxFU0xBU0ggPSA0NwpET1VCTEVTTEFTSEVRVUFMID0gNDgKQVQgPSA0OQpSQVJST1cgPSA1MApFTExJUFNJUyA9IDUxCk9QID0gNTIKRVJST1JUT0tFTiA9IDUzCk5fVE9LRU5TID0gNTQKTlRfT0ZGU0VUID0gMjU2CiMtLWVuZCBjb25zdGFudHMtLQoKdG9rX25hbWUgPSB7dmFsdWU6IG5hbWUKICAgICAgICAgICAgZm9yIG5hbWUsIHZhbHVlIGluIGdsb2JhbHMoKS5pdGVtcygpCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodmFsdWUsIGludCkgYW5kIG5vdCBuYW1lLnN0YXJ0c3dpdGgoJ18nKX0KX19hbGxfXy5leHRlbmQodG9rX25hbWUudmFsdWVzKCkpCgpkZWYgSVNURVJNSU5BTCh4KToKICAgIHJldHVybiB4IDwgTlRfT0ZGU0VUCgpkZWYgSVNOT05URVJNSU5BTCh4KToKICAgIHJldHVybiB4ID49IE5UX09GRlNFVAoKZGVmIElTRU9GKHgpOgogICAgcmV0dXJuIHggPT0gRU5ETUFSS0VSCgoKZGVmIF9tYWluKCk6CiAgICBpbXBvcnQgcmUKICAgIGltcG9ydCBzeXMKICAgIGFyZ3MgPSBzeXMuYXJndlsxOl0KICAgIGluRmlsZU5hbWUgPSBhcmdzIGFuZCBhcmdzWzBdIG9yICJJbmNsdWRlL3Rva2VuLmgiCiAgICBvdXRGaWxlTmFtZSA9ICJMaWIvdG9rZW4ucHkiCiAgICBpZiBsZW4oYXJncykgPiAxOgogICAgICAgIG91dEZpbGVOYW1lID0gYXJnc1sxXQogICAgdHJ5OgogICAgICAgIGZwID0gb3BlbihpbkZpbGVOYW1lKQogICAgZXhjZXB0IElPRXJyb3IgYXMgZXJyOgogICAgICAgIHN5cy5zdGRvdXQud3JpdGUoIkkvTyBlcnJvcjogJXNcbiIgJSBzdHIoZXJyKSkKICAgICAgICBzeXMuZXhpdCgxKQogICAgbGluZXMgPSBmcC5yZWFkKCkuc3BsaXQoIlxuIikKICAgIGZwLmNsb3NlKCkKICAgIHByb2cgPSByZS5jb21waWxlKAogICAgICAgICIjZGVmaW5lWyBcdF1bIFx0XSooW0EtWjAtOV1bQS1aMC05X10qKVsgXHRdWyBcdF0qKFswLTldWzAtOV0qKSIsCiAgICAgICAgcmUuSUdOT1JFQ0FTRSkKICAgIHRva2VucyA9IHt9CiAgICBmb3IgbGluZSBpbiBsaW5lczoKICAgICAgICBtYXRjaCA9IHByb2cubWF0Y2gobGluZSkKICAgICAgICBpZiBtYXRjaDoKICAgICAgICAgICAgbmFtZSwgdmFsID0gbWF0Y2guZ3JvdXAoMSwgMikKICAgICAgICAgICAgdmFsID0gaW50KHZhbCkKICAgICAgICAgICAgdG9rZW5zW3ZhbF0gPSBuYW1lICAgICAgICAgICMgcmV2ZXJzZSBzbyB3ZSBjYW4gc29ydCB0aGVtLi4uCiAgICBrZXlzID0gc29ydGVkKHRva2Vucy5rZXlzKCkpCiAgICAjIGxvYWQgdGhlIG91dHB1dCBza2VsZXRvbiBmcm9tIHRoZSB0YXJnZXQ6CiAgICB0cnk6CiAgICAgICAgZnAgPSBvcGVuKG91dEZpbGVOYW1lKQogICAgZXhjZXB0IElPRXJyb3IgYXMgZXJyOgogICAgICAgIHN5cy5zdGRlcnIud3JpdGUoIkkvTyBlcnJvcjogJXNcbiIgJSBzdHIoZXJyKSkKICAgICAgICBzeXMuZXhpdCgyKQogICAgZm9ybWF0ID0gZnAucmVhZCgpLnNwbGl0KCJcbiIpCiAgICBmcC5jbG9zZSgpCiAgICB0cnk6CiAgICAgICAgc3RhcnQgPSBmb3JtYXQuaW5kZXgoIiMtLXN0YXJ0IGNvbnN0YW50cy0tIikgKyAxCiAgICAgICAgZW5kID0gZm9ybWF0LmluZGV4KCIjLS1lbmQgY29uc3RhbnRzLS0iKQogICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgc3lzLnN0ZGVyci53cml0ZSgidGFyZ2V0IGRvZXMgbm90IGNvbnRhaW4gZm9ybWF0IG1hcmtlcnMiKQogICAgICAgIHN5cy5leGl0KDMpCiAgICBsaW5lcyA9IFtdCiAgICBmb3IgdmFsIGluIGtleXM6CiAgICAgICAgbGluZXMuYXBwZW5kKCIlcyA9ICVkIiAlICh0b2tlbnNbdmFsXSwgdmFsKSkKICAgIGZvcm1hdFtzdGFydDplbmRdID0gbGluZXMKICAgIHRyeToKICAgICAgICBmcCA9IG9wZW4ob3V0RmlsZU5hbWUsICd3JykKICAgIGV4Y2VwdCBJT0Vycm9yIGFzIGVycjoKICAgICAgICBzeXMuc3RkZXJyLndyaXRlKCJJL08gZXJyb3I6ICVzXG4iICUgc3RyKGVycikpCiAgICAgICAgc3lzLmV4aXQoNCkKICAgIGZwLndyaXRlKCJcbiIuam9pbihmb3JtYXQpKQogICAgZnAuY2xvc2UoKQoKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBfbWFpbigpCg==',
'/Lib/tokenize.py':'IiIiVG9rZW5pemF0aW9uIGhlbHAgZm9yIFB5dGhvbiBwcm9ncmFtcy4KCnRva2VuaXplKHJlYWRsaW5lKSBpcyBhIGdlbmVyYXRvciB0aGF0IGJyZWFrcyBhIHN0cmVhbSBvZiBieXRlcyBpbnRvClB5dGhvbiB0b2tlbnMuICBJdCBkZWNvZGVzIHRoZSBieXRlcyBhY2NvcmRpbmcgdG8gUEVQLTAyNjMgZm9yCmRldGVybWluaW5nIHNvdXJjZSBmaWxlIGVuY29kaW5nLgoKSXQgYWNjZXB0cyBhIHJlYWRsaW5lLWxpa2UgbWV0aG9kIHdoaWNoIGlzIGNhbGxlZCByZXBlYXRlZGx5IHRvIGdldCB0aGUKbmV4dCBsaW5lIG9mIGlucHV0IChvciBiIiIgZm9yIEVPRikuICBJdCBnZW5lcmF0ZXMgNS10dXBsZXMgd2l0aCB0aGVzZQptZW1iZXJzOgoKICAgIHRoZSB0b2tlbiB0eXBlIChzZWUgdG9rZW4ucHkpCiAgICB0aGUgdG9rZW4gKGEgc3RyaW5nKQogICAgdGhlIHN0YXJ0aW5nIChyb3csIGNvbHVtbikgaW5kaWNlcyBvZiB0aGUgdG9rZW4gKGEgMi10dXBsZSBvZiBpbnRzKQogICAgdGhlIGVuZGluZyAocm93LCBjb2x1bW4pIGluZGljZXMgb2YgdGhlIHRva2VuIChhIDItdHVwbGUgb2YgaW50cykKICAgIHRoZSBvcmlnaW5hbCBsaW5lIChzdHJpbmcpCgpJdCBpcyBkZXNpZ25lZCB0byBtYXRjaCB0aGUgd29ya2luZyBvZiB0aGUgUHl0aG9uIHRva2VuaXplciBleGFjdGx5LCBleGNlcHQKdGhhdCBpdCBwcm9kdWNlcyBDT01NRU5UIHRva2VucyBmb3IgY29tbWVudHMgYW5kIGdpdmVzIHR5cGUgT1AgZm9yIGFsbApvcGVyYXRvcnMuICBBZGRpdGlvbmFsbHksIGFsbCB0b2tlbiBsaXN0cyBzdGFydCB3aXRoIGFuIEVOQ09ESU5HIHRva2VuCndoaWNoIHRlbGxzIHlvdSB3aGljaCBlbmNvZGluZyB3YXMgdXNlZCB0byBkZWNvZGUgdGhlIGJ5dGVzIHN0cmVhbS4KIiIiCgpfX2F1dGhvcl9fID0gJ0thLVBpbmcgWWVlIDxwaW5nQGxmdy5vcmc+JwpfX2NyZWRpdHNfXyA9ICgnR3ZSLCBFU1IsIFRpbSBQZXRlcnMsIFRob21hcyBXb3V0ZXJzLCBGcmVkIERyYWtlLCAnCiAgICAgICAgICAgICAgICdTa2lwIE1vbnRhbmFybywgUmF5bW9uZCBIZXR0aW5nZXIsIFRyZW50IE5lbHNvbiwgJwogICAgICAgICAgICAgICAnTWljaGFlbCBGb29yZCcpCgppbXBvcnQgYnVpbHRpbnMKaW1wb3J0IHJlCmltcG9ydCBzeXMKZnJvbSB0b2tlbiBpbXBvcnQgKgpmcm9tIGNvZGVjcyBpbXBvcnQgbG9va3VwLCBCT01fVVRGOAppbXBvcnQgY29sbGVjdGlvbnMKZnJvbSBpbyBpbXBvcnQgVGV4dElPV3JhcHBlcgpjb29raWVfcmUgPSByZS5jb21waWxlKCJjb2RpbmdbOj1dXHMqKFstXHcuXSspIikKCmltcG9ydCB0b2tlbgpfX2FsbF9fID0gdG9rZW4uX19hbGxfXyArIFsiQ09NTUVOVCIsICJ0b2tlbml6ZSIsICJkZXRlY3RfZW5jb2RpbmciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAiTkwiLCAidW50b2tlbml6ZSIsICJFTkNPRElORyIsICJUb2tlbkluZm8iXQpkZWwgdG9rZW4KCkNPTU1FTlQgPSBOX1RPS0VOUwp0b2tfbmFtZVtDT01NRU5UXSA9ICdDT01NRU5UJwpOTCA9IE5fVE9LRU5TICsgMQp0b2tfbmFtZVtOTF0gPSAnTkwnCkVOQ09ESU5HID0gTl9UT0tFTlMgKyAyCnRva19uYW1lW0VOQ09ESU5HXSA9ICdFTkNPRElORycKTl9UT0tFTlMgKz0gMwpFWEFDVF9UT0tFTl9UWVBFUyA9IHsKICAgICcoJzogICBMUEFSLAogICAgJyknOiAgIFJQQVIsCiAgICAnWyc6ICAgTFNRQiwKICAgICddJzogICBSU1FCLAogICAgJzonOiAgIENPTE9OLAogICAgJywnOiAgIENPTU1BLAogICAgJzsnOiAgIFNFTUksCiAgICAnKyc6ICAgUExVUywKICAgICctJzogICBNSU5VUywKICAgICcqJzogICBTVEFSLAogICAgJy8nOiAgIFNMQVNILAogICAgJ3wnOiAgIFZCQVIsCiAgICAnJic6ICAgQU1QRVIsCiAgICAnPCc6ICAgTEVTUywKICAgICc+JzogICBHUkVBVEVSLAogICAgJz0nOiAgIEVRVUFMLAogICAgJy4nOiAgIERPVCwKICAgICclJzogICBQRVJDRU5ULAogICAgJ3snOiAgIExCUkFDRSwKICAgICd9JzogICBSQlJBQ0UsCiAgICAnPT0nOiAgRVFFUVVBTCwKICAgICchPSc6ICBOT1RFUVVBTCwKICAgICc8PSc6ICBMRVNTRVFVQUwsCiAgICAnPj0nOiAgR1JFQVRFUkVRVUFMLAogICAgJ34nOiAgIFRJTERFLAogICAgJ14nOiAgIENJUkNVTUZMRVgsCiAgICAnPDwnOiAgTEVGVFNISUZULAogICAgJz4+JzogIFJJR0hUU0hJRlQsCiAgICAnKionOiAgRE9VQkxFU1RBUiwKICAgICcrPSc6ICBQTFVTRVFVQUwsCiAgICAnLT0nOiAgTUlORVFVQUwsCiAgICAnKj0nOiAgU1RBUkVRVUFMLAogICAgJy89JzogIFNMQVNIRVFVQUwsCiAgICAnJT0nOiAgUEVSQ0VOVEVRVUFMLAogICAgJyY9JzogIEFNUEVSRVFVQUwsCiAgICAnfD0nOiAgVkJBUkVRVUFMLAogICAgJ149JzogQ0lSQ1VNRkxFWEVRVUFMLAogICAgJzw8PSc6IExFRlRTSElGVEVRVUFMLAogICAgJz4+PSc6IFJJR0hUU0hJRlRFUVVBTCwKICAgICcqKj0nOiBET1VCTEVTVEFSRVFVQUwsCiAgICAnLy8nOiAgRE9VQkxFU0xBU0gsCiAgICAnLy89JzogRE9VQkxFU0xBU0hFUVVBTCwKICAgICdAJzogICBBVAp9CgpjbGFzcyBUb2tlbkluZm8oY29sbGVjdGlvbnMubmFtZWR0dXBsZSgnVG9rZW5JbmZvJywgJ3R5cGUgc3RyaW5nIHN0YXJ0IGVuZCBsaW5lJykpOgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIGFubm90YXRlZF90eXBlID0gJyVkICglcyknICUgKHNlbGYudHlwZSwgdG9rX25hbWVbc2VsZi50eXBlXSkKICAgICAgICByZXR1cm4gKCdUb2tlbkluZm8odHlwZT0lcywgc3RyaW5nPSVyLCBzdGFydD0lciwgZW5kPSVyLCBsaW5lPSVyKScgJQogICAgICAgICAgICAgICAgc2VsZi5fcmVwbGFjZSh0eXBlPWFubm90YXRlZF90eXBlKSkKCiAgICBAcHJvcGVydHkKICAgIGRlZiBleGFjdF90eXBlKHNlbGYpOgogICAgICAgIGlmIHNlbGYudHlwZSA9PSBPUCBhbmQgc2VsZi5zdHJpbmcgaW4gRVhBQ1RfVE9LRU5fVFlQRVM6CiAgICAgICAgICAgIHJldHVybiBFWEFDVF9UT0tFTl9UWVBFU1tzZWxmLnN0cmluZ10KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gc2VsZi50eXBlCgpkZWYgZ3JvdXAoKmNob2ljZXMpOiByZXR1cm4gJygnICsgJ3wnLmpvaW4oY2hvaWNlcykgKyAnKScKZGVmIGFueSgqY2hvaWNlcyk6IHJldHVybiBncm91cCgqY2hvaWNlcykgKyAnKicKZGVmIG1heWJlKCpjaG9pY2VzKTogcmV0dXJuIGdyb3VwKCpjaG9pY2VzKSArICc/JwoKIyBOb3RlOiB3ZSB1c2UgdW5pY29kZSBtYXRjaGluZyBmb3IgbmFtZXMgKCJcdyIpIGJ1dCBhc2NpaSBtYXRjaGluZyBmb3IKIyBudW1iZXIgbGl0ZXJhbHMuCldoaXRlc3BhY2UgPSByJ1sgXGZcdF0qJwpDb21tZW50ID0gcicjW15cclxuXSonCklnbm9yZSA9IFdoaXRlc3BhY2UgKyBhbnkocidcXFxyP1xuJyArIFdoaXRlc3BhY2UpICsgbWF5YmUoQ29tbWVudCkKTmFtZSA9IHInXHcrJwoKSGV4bnVtYmVyID0gcicwW3hYXVswLTlhLWZBLUZdKycKQmlubnVtYmVyID0gcicwW2JCXVswMV0rJwpPY3RudW1iZXIgPSByJzBbb09dWzAtN10rJwpEZWNudW1iZXIgPSByJyg/OjArfFsxLTldWzAtOV0qKScKSW50bnVtYmVyID0gZ3JvdXAoSGV4bnVtYmVyLCBCaW5udW1iZXIsIE9jdG51bWJlciwgRGVjbnVtYmVyKQpFeHBvbmVudCA9IHInW2VFXVstK10/WzAtOV0rJwpQb2ludGZsb2F0ID0gZ3JvdXAocidbMC05XStcLlswLTldKicsIHInXC5bMC05XSsnKSArIG1heWJlKEV4cG9uZW50KQpFeHBmbG9hdCA9IHInWzAtOV0rJyArIEV4cG9uZW50CkZsb2F0bnVtYmVyID0gZ3JvdXAoUG9pbnRmbG9hdCwgRXhwZmxvYXQpCkltYWdudW1iZXIgPSBncm91cChyJ1swLTldK1tqSl0nLCBGbG9hdG51bWJlciArIHInW2pKXScpCk51bWJlciA9IGdyb3VwKEltYWdudW1iZXIsIEZsb2F0bnVtYmVyLCBJbnRudW1iZXIpCgpTdHJpbmdQcmVmaXggPSByJyg/OltiQl1bclJdP3xbclJdW2JCXT98W3VVXSk/JwoKIyBUYWlsIGVuZCBvZiAnIHN0cmluZy4KU2luZ2xlID0gciJbXidcXF0qKD86XFwuW14nXFxdKikqJyIKIyBUYWlsIGVuZCBvZiAiIHN0cmluZy4KRG91YmxlID0gcidbXiJcXF0qKD86XFwuW14iXFxdKikqIicKIyBUYWlsIGVuZCBvZiAnJycgc3RyaW5nLgpTaW5nbGUzID0gciJbXidcXF0qKD86KD86XFwufCcoPyEnJykpW14nXFxdKikqJycnIgojIFRhaWwgZW5kIG9mICIiIiBzdHJpbmcuCkRvdWJsZTMgPSByJ1teIlxcXSooPzooPzpcXC58Iig/ISIiKSlbXiJcXF0qKSoiIiInClRyaXBsZSA9IGdyb3VwKFN0cmluZ1ByZWZpeCArICInJyciLCBTdHJpbmdQcmVmaXggKyAnIiIiJykKIyBTaW5nbGUtbGluZSAnIG9yICIgc3RyaW5nLgpTdHJpbmcgPSBncm91cChTdHJpbmdQcmVmaXggKyByIidbXlxuJ1xcXSooPzpcXC5bXlxuJ1xcXSopKiciLAogICAgICAgICAgICAgICBTdHJpbmdQcmVmaXggKyByJyJbXlxuIlxcXSooPzpcXC5bXlxuIlxcXSopKiInKQoKIyBCZWNhdXNlIG9mIGxlZnRtb3N0LXRoZW4tbG9uZ2VzdCBtYXRjaCBzZW1hbnRpY3MsIGJlIHN1cmUgdG8gcHV0IHRoZQojIGxvbmdlc3Qgb3BlcmF0b3JzIGZpcnN0IChlLmcuLCBpZiA9IGNhbWUgYmVmb3JlID09LCA9PSB3b3VsZCBnZXQKIyByZWNvZ25pemVkIGFzIHR3byBpbnN0YW5jZXMgb2YgPSkuCk9wZXJhdG9yID0gZ3JvdXAociJcKlwqPT8iLCByIj4+PT8iLCByIjw8PT8iLCByIiE9IiwKICAgICAgICAgICAgICAgICByIi8vPT8iLCByIi0+IiwKICAgICAgICAgICAgICAgICByIlsrXC0qLyUmfF49PD5dPT8iLAogICAgICAgICAgICAgICAgIHIifiIpCgpCcmFja2V0ID0gJ1tdWygpe31dJwpTcGVjaWFsID0gZ3JvdXAocidccj9cbicsIHInXC5cLlwuJywgcidbOjsuLEBdJykKRnVubnkgPSBncm91cChPcGVyYXRvciwgQnJhY2tldCwgU3BlY2lhbCkKClBsYWluVG9rZW4gPSBncm91cChOdW1iZXIsIEZ1bm55LCBTdHJpbmcsIE5hbWUpClRva2VuID0gSWdub3JlICsgUGxhaW5Ub2tlbgoKIyBGaXJzdCAob3Igb25seSkgbGluZSBvZiAnIG9yICIgc3RyaW5nLgpDb250U3RyID0gZ3JvdXAoU3RyaW5nUHJlZml4ICsgciInW15cbidcXF0qKD86XFwuW15cbidcXF0qKSoiICsKICAgICAgICAgICAgICAgIGdyb3VwKCInIiwgcidcXFxyP1xuJyksCiAgICAgICAgICAgICAgICBTdHJpbmdQcmVmaXggKyByJyJbXlxuIlxcXSooPzpcXC5bXlxuIlxcXSopKicgKwogICAgICAgICAgICAgICAgZ3JvdXAoJyInLCByJ1xcXHI/XG4nKSkKUHNldWRvRXh0cmFzID0gZ3JvdXAocidcXFxyP1xuJywgQ29tbWVudCwgVHJpcGxlKQpQc2V1ZG9Ub2tlbiA9IFdoaXRlc3BhY2UgKyBncm91cChQc2V1ZG9FeHRyYXMsIE51bWJlciwgRnVubnksIENvbnRTdHIsIE5hbWUpCgpkZWYgX2NvbXBpbGUoZXhwcik6CiAgICByZXR1cm4gcmUuY29tcGlsZShleHByLCByZS5VTklDT0RFKQoKZW5kcGF0cyA9IHsiJyI6IFNpbmdsZSwgJyInOiBEb3VibGUsCiAgICAgICAgICAgIicnJyI6IFNpbmdsZTMsICciIiInOiBEb3VibGUzLAogICAgICAgICAgICJyJycnIjogU2luZ2xlMywgJ3IiIiInOiBEb3VibGUzLAogICAgICAgICAgICJiJycnIjogU2luZ2xlMywgJ2IiIiInOiBEb3VibGUzLAogICAgICAgICAgICJSJycnIjogU2luZ2xlMywgJ1IiIiInOiBEb3VibGUzLAogICAgICAgICAgICJCJycnIjogU2luZ2xlMywgJ0IiIiInOiBEb3VibGUzLAogICAgICAgICAgICJicicnJyI6IFNpbmdsZTMsICdiciIiIic6IERvdWJsZTMsCiAgICAgICAgICAgImJSJycnIjogU2luZ2xlMywgJ2JSIiIiJzogRG91YmxlMywKICAgICAgICAgICAiQnInJyciOiBTaW5nbGUzLCAnQnIiIiInOiBEb3VibGUzLAogICAgICAgICAgICJCUicnJyI6IFNpbmdsZTMsICdCUiIiIic6IERvdWJsZTMsCiAgICAgICAgICAgInJiJycnIjogU2luZ2xlMywgJ3JiIiIiJzogRG91YmxlMywKICAgICAgICAgICAiUmInJyciOiBTaW5nbGUzLCAnUmIiIiInOiBEb3VibGUzLAogICAgICAgICAgICJyQicnJyI6IFNpbmdsZTMsICdyQiIiIic6IERvdWJsZTMsCiAgICAgICAgICAgIlJCJycnIjogU2luZ2xlMywgJ1JCIiIiJzogRG91YmxlMywKICAgICAgICAgICAidScnJyI6IFNpbmdsZTMsICd1IiIiJzogRG91YmxlMywKICAgICAgICAgICAiUicnJyI6IFNpbmdsZTMsICdSIiIiJzogRG91YmxlMywKICAgICAgICAgICAiVScnJyI6IFNpbmdsZTMsICdVIiIiJzogRG91YmxlMywKICAgICAgICAgICAncic6IE5vbmUsICdSJzogTm9uZSwgJ2InOiBOb25lLCAnQic6IE5vbmUsCiAgICAgICAgICAgJ3UnOiBOb25lLCAnVSc6IE5vbmV9Cgp0cmlwbGVfcXVvdGVkID0ge30KZm9yIHQgaW4gKCInJyciLCAnIiIiJywKICAgICAgICAgICJyJycnIiwgJ3IiIiInLCAiUicnJyIsICdSIiIiJywKICAgICAgICAgICJiJycnIiwgJ2IiIiInLCAiQicnJyIsICdCIiIiJywKICAgICAgICAgICJicicnJyIsICdiciIiIicsICJCcicnJyIsICdCciIiIicsCiAgICAgICAgICAiYlInJyciLCAnYlIiIiInLCAiQlInJyciLCAnQlIiIiInLAogICAgICAgICAgInJiJycnIiwgJ3JiIiIiJywgInJCJycnIiwgJ3JCIiIiJywKICAgICAgICAgICJSYicnJyIsICdSYiIiIicsICJSQicnJyIsICdSQiIiIicsCiAgICAgICAgICAidScnJyIsICd1IiIiJywgIlUnJyciLCAnVSIiIicsCiAgICAgICAgICApOgogICAgdHJpcGxlX3F1b3RlZFt0XSA9IHQKc2luZ2xlX3F1b3RlZCA9IHt9CmZvciB0IGluICgiJyIsICciJywKICAgICAgICAgICJyJyIsICdyIicsICJSJyIsICdSIicsCiAgICAgICAgICAiYiciLCAnYiInLCAiQiciLCAnQiInLAogICAgICAgICAgImJyJyIsICdiciInLCAiQnInIiwgJ0JyIicsCiAgICAgICAgICAiYlInIiwgJ2JSIicsICJCUiciLCAnQlIiJyAsCiAgICAgICAgICAicmInIiwgJ3JiIicsICJyQiciLCAnckIiJywKICAgICAgICAgICJSYiciLCAnUmIiJywgIlJCJyIsICdSQiInICwKICAgICAgICAgICJ1JyIsICd1IicsICJVJyIsICdVIicsCiAgICAgICAgICApOgogICAgc2luZ2xlX3F1b3RlZFt0XSA9IHQKCnRhYnNpemUgPSA4CgpjbGFzcyBUb2tlbkVycm9yKEV4Y2VwdGlvbik6IHBhc3MKCmNsYXNzIFN0b3BUb2tlbml6aW5nKEV4Y2VwdGlvbik6IHBhc3MKCgpjbGFzcyBVbnRva2VuaXplcjoKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi50b2tlbnMgPSBbXQogICAgICAgIHNlbGYucHJldl9yb3cgPSAxCiAgICAgICAgc2VsZi5wcmV2X2NvbCA9IDAKICAgICAgICBzZWxmLmVuY29kaW5nID0gTm9uZQoKICAgIGRlZiBhZGRfd2hpdGVzcGFjZShzZWxmLCBzdGFydCk6CiAgICAgICAgcm93LCBjb2wgPSBzdGFydAogICAgICAgIGFzc2VydCByb3cgPD0gc2VsZi5wcmV2X3JvdwogICAgICAgIGNvbF9vZmZzZXQgPSBjb2wgLSBzZWxmLnByZXZfY29sCiAgICAgICAgaWYgY29sX29mZnNldDoKICAgICAgICAgICAgc2VsZi50b2tlbnMuYXBwZW5kKCIgIiAqIGNvbF9vZmZzZXQpCgogICAgZGVmIHVudG9rZW5pemUoc2VsZiwgaXRlcmFibGUpOgogICAgICAgIGZvciB0IGluIGl0ZXJhYmxlOgogICAgICAgICAgICBpZiBsZW4odCkgPT0gMjoKICAgICAgICAgICAgICAgIHNlbGYuY29tcGF0KHQsIGl0ZXJhYmxlKQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgdG9rX3R5cGUsIHRva2VuLCBzdGFydCwgZW5kLCBsaW5lID0gdAogICAgICAgICAgICBpZiB0b2tfdHlwZSA9PSBFTkNPRElORzoKICAgICAgICAgICAgICAgIHNlbGYuZW5jb2RpbmcgPSB0b2tlbgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgc2VsZi5hZGRfd2hpdGVzcGFjZShzdGFydCkKICAgICAgICAgICAgc2VsZi50b2tlbnMuYXBwZW5kKHRva2VuKQogICAgICAgICAgICBzZWxmLnByZXZfcm93LCBzZWxmLnByZXZfY29sID0gZW5kCiAgICAgICAgICAgIGlmIHRva190eXBlIGluIChORVdMSU5FLCBOTCk6CiAgICAgICAgICAgICAgICBzZWxmLnByZXZfcm93ICs9IDEKICAgICAgICAgICAgICAgIHNlbGYucHJldl9jb2wgPSAwCiAgICAgICAgcmV0dXJuICIiLmpvaW4oc2VsZi50b2tlbnMpCgogICAgZGVmIGNvbXBhdChzZWxmLCB0b2tlbiwgaXRlcmFibGUpOgogICAgICAgIHN0YXJ0bGluZSA9IEZhbHNlCiAgICAgICAgaW5kZW50cyA9IFtdCiAgICAgICAgdG9rc19hcHBlbmQgPSBzZWxmLnRva2Vucy5hcHBlbmQKICAgICAgICB0b2tudW0sIHRva3ZhbCA9IHRva2VuCgogICAgICAgIGlmIHRva251bSBpbiAoTkFNRSwgTlVNQkVSKToKICAgICAgICAgICAgdG9rdmFsICs9ICcgJwogICAgICAgIGlmIHRva251bSBpbiAoTkVXTElORSwgTkwpOgogICAgICAgICAgICBzdGFydGxpbmUgPSBUcnVlCiAgICAgICAgcHJldnN0cmluZyA9IEZhbHNlCiAgICAgICAgZm9yIHRvayBpbiBpdGVyYWJsZToKICAgICAgICAgICAgdG9rbnVtLCB0b2t2YWwgPSB0b2tbOjJdCiAgICAgICAgICAgIGlmIHRva251bSA9PSBFTkNPRElORzoKICAgICAgICAgICAgICAgIHNlbGYuZW5jb2RpbmcgPSB0b2t2YWwKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBpZiB0b2tudW0gaW4gKE5BTUUsIE5VTUJFUik6CiAgICAgICAgICAgICAgICB0b2t2YWwgKz0gJyAnCgogICAgICAgICAgICAjIEluc2VydCBhIHNwYWNlIGJldHdlZW4gdHdvIGNvbnNlY3V0aXZlIHN0cmluZ3MKICAgICAgICAgICAgaWYgdG9rbnVtID09IFNUUklORzoKICAgICAgICAgICAgICAgIGlmIHByZXZzdHJpbmc6CiAgICAgICAgICAgICAgICAgICAgdG9rdmFsID0gJyAnICsgdG9rdmFsCiAgICAgICAgICAgICAgICBwcmV2c3RyaW5nID0gVHJ1ZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJldnN0cmluZyA9IEZhbHNlCgogICAgICAgICAgICBpZiB0b2tudW0gPT0gSU5ERU5UOgogICAgICAgICAgICAgICAgaW5kZW50cy5hcHBlbmQodG9rdmFsKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZWxpZiB0b2tudW0gPT0gREVERU5UOgogICAgICAgICAgICAgICAgaW5kZW50cy5wb3AoKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZWxpZiB0b2tudW0gaW4gKE5FV0xJTkUsIE5MKToKICAgICAgICAgICAgICAgIHN0YXJ0bGluZSA9IFRydWUKICAgICAgICAgICAgZWxpZiBzdGFydGxpbmUgYW5kIGluZGVudHM6CiAgICAgICAgICAgICAgICB0b2tzX2FwcGVuZChpbmRlbnRzWy0xXSkKICAgICAgICAgICAgICAgIHN0YXJ0bGluZSA9IEZhbHNlCiAgICAgICAgICAgIHRva3NfYXBwZW5kKHRva3ZhbCkKCgpkZWYgdW50b2tlbml6ZShpdGVyYWJsZSk6CiAgICAiIiJUcmFuc2Zvcm0gdG9rZW5zIGJhY2sgaW50byBQeXRob24gc291cmNlIGNvZGUuCiAgICBJdCByZXR1cm5zIGEgYnl0ZXMgb2JqZWN0LCBlbmNvZGVkIHVzaW5nIHRoZSBFTkNPRElORwogICAgdG9rZW4sIHdoaWNoIGlzIHRoZSBmaXJzdCB0b2tlbiBzZXF1ZW5jZSBvdXRwdXQgYnkgdG9rZW5pemUuCgogICAgRWFjaCBlbGVtZW50IHJldHVybmVkIGJ5IHRoZSBpdGVyYWJsZSBtdXN0IGJlIGEgdG9rZW4gc2VxdWVuY2UKICAgIHdpdGggYXQgbGVhc3QgdHdvIGVsZW1lbnRzLCBhIHRva2VuIG51bWJlciBhbmQgdG9rZW4gdmFsdWUuICBJZgogICAgb25seSB0d28gdG9rZW5zIGFyZSBwYXNzZWQsIHRoZSByZXN1bHRpbmcgb3V0cHV0IGlzIHBvb3IuCgogICAgUm91bmQtdHJpcCBpbnZhcmlhbnQgZm9yIGZ1bGwgaW5wdXQ6CiAgICAgICAgVW50b2tlbml6ZWQgc291cmNlIHdpbGwgbWF0Y2ggaW5wdXQgc291cmNlIGV4YWN0bHkKCiAgICBSb3VuZC10cmlwIGludmFyaWFudCBmb3IgbGltaXRlZCBpbnRwdXQ6CiAgICAgICAgIyBPdXRwdXQgYnl0ZXMgd2lsbCB0b2tlbml6ZSB0aGUgYmFjayB0byB0aGUgaW5wdXQKICAgICAgICB0MSA9IFt0b2tbOjJdIGZvciB0b2sgaW4gdG9rZW5pemUoZi5yZWFkbGluZSldCiAgICAgICAgbmV3Y29kZSA9IHVudG9rZW5pemUodDEpCiAgICAgICAgcmVhZGxpbmUgPSBCeXRlc0lPKG5ld2NvZGUpLnJlYWRsaW5lCiAgICAgICAgdDIgPSBbdG9rWzoyXSBmb3IgdG9rIGluIHRva2VuaXplKHJlYWRsaW5lKV0KICAgICAgICBhc3NlcnQgdDEgPT0gdDIKICAgICIiIgogICAgdXQgPSBVbnRva2VuaXplcigpCiAgICBvdXQgPSB1dC51bnRva2VuaXplKGl0ZXJhYmxlKQogICAgaWYgdXQuZW5jb2RpbmcgaXMgbm90IE5vbmU6CiAgICAgICAgb3V0ID0gb3V0LmVuY29kZSh1dC5lbmNvZGluZykKICAgIHJldHVybiBvdXQKCgpkZWYgX2dldF9ub3JtYWxfbmFtZShvcmlnX2VuYyk6CiAgICAiIiJJbWl0YXRlcyBnZXRfbm9ybWFsX25hbWUgaW4gdG9rZW5pemVyLmMuIiIiCiAgICAjIE9ubHkgY2FyZSBhYm91dCB0aGUgZmlyc3QgMTIgY2hhcmFjdGVycy4KICAgIGVuYyA9IG9yaWdfZW5jWzoxMl0ubG93ZXIoKS5yZXBsYWNlKCJfIiwgIi0iKQogICAgaWYgZW5jID09ICJ1dGYtOCIgb3IgZW5jLnN0YXJ0c3dpdGgoInV0Zi04LSIpOgogICAgICAgIHJldHVybiAidXRmLTgiCiAgICBpZiBlbmMgaW4gKCJsYXRpbi0xIiwgImlzby04ODU5LTEiLCAiaXNvLWxhdGluLTEiKSBvciBcCiAgICAgICBlbmMuc3RhcnRzd2l0aCgoImxhdGluLTEtIiwgImlzby04ODU5LTEtIiwgImlzby1sYXRpbi0xLSIpKToKICAgICAgICByZXR1cm4gImlzby04ODU5LTEiCiAgICByZXR1cm4gb3JpZ19lbmMKCmRlZiBkZXRlY3RfZW5jb2RpbmcocmVhZGxpbmUpOgogICAgIiIiCiAgICBUaGUgZGV0ZWN0X2VuY29kaW5nKCkgZnVuY3Rpb24gaXMgdXNlZCB0byBkZXRlY3QgdGhlIGVuY29kaW5nIHRoYXQgc2hvdWxkCiAgICBiZSB1c2VkIHRvIGRlY29kZSBhIFB5dGhvbiBzb3VyY2UgZmlsZS4gIEl0IHJlcXVpcmVzIG9uZSBhcmdtZW50LCByZWFkbGluZSwKICAgIGluIHRoZSBzYW1lIHdheSBhcyB0aGUgdG9rZW5pemUoKSBnZW5lcmF0b3IuCgogICAgSXQgd2lsbCBjYWxsIHJlYWRsaW5lIGEgbWF4aW11bSBvZiB0d2ljZSwgYW5kIHJldHVybiB0aGUgZW5jb2RpbmcgdXNlZAogICAgKGFzIGEgc3RyaW5nKSBhbmQgYSBsaXN0IG9mIGFueSBsaW5lcyAobGVmdCBhcyBieXRlcykgaXQgaGFzIHJlYWQgaW4uCgogICAgSXQgZGV0ZWN0cyB0aGUgZW5jb2RpbmcgZnJvbSB0aGUgcHJlc2VuY2Ugb2YgYSB1dGYtOCBib20gb3IgYW4gZW5jb2RpbmcKICAgIGNvb2tpZSBhcyBzcGVjaWZpZWQgaW4gcGVwLTAyNjMuICBJZiBib3RoIGEgYm9tIGFuZCBhIGNvb2tpZSBhcmUgcHJlc2VudCwKICAgIGJ1dCBkaXNhZ3JlZSwgYSBTeW50YXhFcnJvciB3aWxsIGJlIHJhaXNlZC4gIElmIHRoZSBlbmNvZGluZyBjb29raWUgaXMgYW4KICAgIGludmFsaWQgY2hhcnNldCwgcmFpc2UgYSBTeW50YXhFcnJvci4gIE5vdGUgdGhhdCBpZiBhIHV0Zi04IGJvbSBpcyBmb3VuZCwKICAgICd1dGYtOC1zaWcnIGlzIHJldHVybmVkLgoKICAgIElmIG5vIGVuY29kaW5nIGlzIHNwZWNpZmllZCwgdGhlbiB0aGUgZGVmYXVsdCBvZiAndXRmLTgnIHdpbGwgYmUgcmV0dXJuZWQuCiAgICAiIiIKICAgIHRyeToKICAgICAgICBmaWxlbmFtZSA9IHJlYWRsaW5lLl9fc2VsZl9fLm5hbWUKICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICBmaWxlbmFtZSA9IE5vbmUKICAgIGJvbV9mb3VuZCA9IEZhbHNlCiAgICBlbmNvZGluZyA9IE5vbmUKICAgIGRlZmF1bHQgPSAndXRmLTgnCiAgICBkZWYgcmVhZF9vcl9zdG9wKCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gcmVhZGxpbmUoKQogICAgICAgIGV4Y2VwdCBTdG9wSXRlcmF0aW9uOgogICAgICAgICAgICByZXR1cm4gYicnCgogICAgZGVmIGZpbmRfY29va2llKGxpbmUpOgogICAgICAgIHRyeToKICAgICAgICAgICAgIyBEZWNvZGUgYXMgVVRGLTguIEVpdGhlciB0aGUgbGluZSBpcyBhbiBlbmNvZGluZyBkZWNsYXJhdGlvbiwKICAgICAgICAgICAgIyBpbiB3aGljaCBjYXNlIGl0IHNob3VsZCBiZSBwdXJlIEFTQ0lJLCBvciBpdCBtdXN0IGJlIFVURi04CiAgICAgICAgICAgICMgcGVyIGRlZmF1bHQgZW5jb2RpbmcuCiAgICAgICAgICAgIGxpbmVfc3RyaW5nID0gbGluZS5kZWNvZGUoJ3V0Zi04JykKICAgICAgICBleGNlcHQgVW5pY29kZURlY29kZUVycm9yOgogICAgICAgICAgICBtc2cgPSAiaW52YWxpZCBvciBtaXNzaW5nIGVuY29kaW5nIGRlY2xhcmF0aW9uIgogICAgICAgICAgICBpZiBmaWxlbmFtZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIG1zZyA9ICd7fSBmb3IgeyFyfScuZm9ybWF0KG1zZywgZmlsZW5hbWUpCiAgICAgICAgICAgIHJhaXNlIFN5bnRheEVycm9yKG1zZykKCiAgICAgICAgbWF0Y2hlcyA9IGNvb2tpZV9yZS5maW5kYWxsKGxpbmVfc3RyaW5nKQogICAgICAgIGlmIG5vdCBtYXRjaGVzOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIGVuY29kaW5nID0gX2dldF9ub3JtYWxfbmFtZShtYXRjaGVzWzBdKQogICAgICAgIHRyeToKICAgICAgICAgICAgY29kZWMgPSBsb29rdXAoZW5jb2RpbmcpCiAgICAgICAgZXhjZXB0IExvb2t1cEVycm9yOgogICAgICAgICAgICAjIFRoaXMgYmVoYXZpb3VyIG1pbWljcyB0aGUgUHl0aG9uIGludGVycHJldGVyCiAgICAgICAgICAgIGlmIGZpbGVuYW1lIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBtc2cgPSAidW5rbm93biBlbmNvZGluZzogIiArIGVuY29kaW5nCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBtc2cgPSAidW5rbm93biBlbmNvZGluZyBmb3IgeyFyfToge30iLmZvcm1hdChmaWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2RpbmcpCiAgICAgICAgICAgIHJhaXNlIFN5bnRheEVycm9yKG1zZykKCiAgICAgICAgaWYgYm9tX2ZvdW5kOgogICAgICAgICAgICBpZiBlbmNvZGluZyAhPSAndXRmLTgnOgogICAgICAgICAgICAgICAgIyBUaGlzIGJlaGF2aW91ciBtaW1pY3MgdGhlIFB5dGhvbiBpbnRlcnByZXRlcgogICAgICAgICAgICAgICAgaWYgZmlsZW5hbWUgaXMgTm9uZToKICAgICAgICAgICAgICAgICAgICBtc2cgPSAnZW5jb2RpbmcgcHJvYmxlbTogdXRmLTgnCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIG1zZyA9ICdlbmNvZGluZyBwcm9ibGVtIGZvciB7IXJ9OiB1dGYtOCcuZm9ybWF0KGZpbGVuYW1lKQogICAgICAgICAgICAgICAgcmFpc2UgU3ludGF4RXJyb3IobXNnKQogICAgICAgICAgICBlbmNvZGluZyArPSAnLXNpZycKICAgICAgICByZXR1cm4gZW5jb2RpbmcKCiAgICBmaXJzdCA9IHJlYWRfb3Jfc3RvcCgpCiAgICBpZiBmaXJzdC5zdGFydHN3aXRoKEJPTV9VVEY4KToKICAgICAgICBib21fZm91bmQgPSBUcnVlCiAgICAgICAgZmlyc3QgPSBmaXJzdFszOl0KICAgICAgICBkZWZhdWx0ID0gJ3V0Zi04LXNpZycKICAgIGlmIG5vdCBmaXJzdDoKICAgICAgICByZXR1cm4gZGVmYXVsdCwgW10KCiAgICBlbmNvZGluZyA9IGZpbmRfY29va2llKGZpcnN0KQogICAgaWYgZW5jb2Rpbmc6CiAgICAgICAgcmV0dXJuIGVuY29kaW5nLCBbZmlyc3RdCgogICAgc2Vjb25kID0gcmVhZF9vcl9zdG9wKCkKICAgIGlmIG5vdCBzZWNvbmQ6CiAgICAgICAgcmV0dXJuIGRlZmF1bHQsIFtmaXJzdF0KCiAgICBlbmNvZGluZyA9IGZpbmRfY29va2llKHNlY29uZCkKICAgIGlmIGVuY29kaW5nOgogICAgICAgIHJldHVybiBlbmNvZGluZywgW2ZpcnN0LCBzZWNvbmRdCgogICAgcmV0dXJuIGRlZmF1bHQsIFtmaXJzdCwgc2Vjb25kXQoKCmRlZiBvcGVuKGZpbGVuYW1lKToKICAgICIiIk9wZW4gYSBmaWxlIGluIHJlYWQgb25seSBtb2RlIHVzaW5nIHRoZSBlbmNvZGluZyBkZXRlY3RlZCBieQogICAgZGV0ZWN0X2VuY29kaW5nKCkuCiAgICAiIiIKICAgIGJ1ZmZlciA9IGJ1aWx0aW5zLm9wZW4oZmlsZW5hbWUsICdyYicpCiAgICBlbmNvZGluZywgbGluZXMgPSBkZXRlY3RfZW5jb2RpbmcoYnVmZmVyLnJlYWRsaW5lKQogICAgYnVmZmVyLnNlZWsoMCkKICAgIHRleHQgPSBUZXh0SU9XcmFwcGVyKGJ1ZmZlciwgZW5jb2RpbmcsIGxpbmVfYnVmZmVyaW5nPVRydWUpCiAgICB0ZXh0Lm1vZGUgPSAncicKICAgIHJldHVybiB0ZXh0CgoKZGVmIHRva2VuaXplKHJlYWRsaW5lKToKICAgICIiIgogICAgVGhlIHRva2VuaXplKCkgZ2VuZXJhdG9yIHJlcXVpcmVzIG9uZSBhcmdtZW50LCByZWFkbGluZSwgd2hpY2gKICAgIG11c3QgYmUgYSBjYWxsYWJsZSBvYmplY3Qgd2hpY2ggcHJvdmlkZXMgdGhlIHNhbWUgaW50ZXJmYWNlIGFzIHRoZQogICAgcmVhZGxpbmUoKSBtZXRob2Qgb2YgYnVpbHQtaW4gZmlsZSBvYmplY3RzLiAgRWFjaCBjYWxsIHRvIHRoZSBmdW5jdGlvbgogICAgc2hvdWxkIHJldHVybiBvbmUgbGluZSBvZiBpbnB1dCBhcyBieXRlcy4gIEFsdGVybmF0ZWx5LCByZWFkbGluZQogICAgY2FuIGJlIGEgY2FsbGFibGUgZnVuY3Rpb24gdGVybWluYXRpbmcgd2l0aCBTdG9wSXRlcmF0aW9uOgogICAgICAgIHJlYWRsaW5lID0gb3BlbihteWZpbGUsICdyYicpLl9fbmV4dF9fICAjIEV4YW1wbGUgb2YgYWx0ZXJuYXRlIHJlYWRsaW5lCgogICAgVGhlIGdlbmVyYXRvciBwcm9kdWNlcyA1LXR1cGxlcyB3aXRoIHRoZXNlIG1lbWJlcnM6IHRoZSB0b2tlbiB0eXBlOyB0aGUKICAgIHRva2VuIHN0cmluZzsgYSAyLXR1cGxlIChzcm93LCBzY29sKSBvZiBpbnRzIHNwZWNpZnlpbmcgdGhlIHJvdyBhbmQKICAgIGNvbHVtbiB3aGVyZSB0aGUgdG9rZW4gYmVnaW5zIGluIHRoZSBzb3VyY2U7IGEgMi10dXBsZSAoZXJvdywgZWNvbCkgb2YKICAgIGludHMgc3BlY2lmeWluZyB0aGUgcm93IGFuZCBjb2x1bW4gd2hlcmUgdGhlIHRva2VuIGVuZHMgaW4gdGhlIHNvdXJjZTsKICAgIGFuZCB0aGUgbGluZSBvbiB3aGljaCB0aGUgdG9rZW4gd2FzIGZvdW5kLiAgVGhlIGxpbmUgcGFzc2VkIGlzIHRoZQogICAgbG9naWNhbCBsaW5lOyBjb250aW51YXRpb24gbGluZXMgYXJlIGluY2x1ZGVkLgoKICAgIFRoZSBmaXJzdCB0b2tlbiBzZXF1ZW5jZSB3aWxsIGFsd2F5cyBiZSBhbiBFTkNPRElORyB0b2tlbgogICAgd2hpY2ggdGVsbHMgeW91IHdoaWNoIGVuY29kaW5nIHdhcyB1c2VkIHRvIGRlY29kZSB0aGUgYnl0ZXMgc3RyZWFtLgogICAgIiIiCiAgICAjIFRoaXMgaW1wb3J0IGlzIGhlcmUgdG8gYXZvaWQgcHJvYmxlbXMgd2hlbiB0aGUgaXRlcnRvb2xzIG1vZHVsZSBpcyBub3QKICAgICMgYnVpbHQgeWV0IGFuZCB0b2tlbml6ZSBpcyBpbXBvcnRlZC4KICAgIGZyb20gaXRlcnRvb2xzIGltcG9ydCBjaGFpbiwgcmVwZWF0CiAgICBlbmNvZGluZywgY29uc3VtZWQgPSBkZXRlY3RfZW5jb2RpbmcocmVhZGxpbmUpCiAgICBybF9nZW4gPSBpdGVyKHJlYWRsaW5lLCBiIiIpCiAgICBlbXB0eSA9IHJlcGVhdChiIiIpCiAgICByZXR1cm4gX3Rva2VuaXplKGNoYWluKGNvbnN1bWVkLCBybF9nZW4sIGVtcHR5KS5fX25leHRfXywgZW5jb2RpbmcpCgoKZGVmIF90b2tlbml6ZShyZWFkbGluZSwgZW5jb2RpbmcpOgogICAgbG51bSA9IHBhcmVubGV2ID0gY29udGludWVkID0gMAogICAgbnVtY2hhcnMgPSAnMDEyMzQ1Njc4OScKICAgIGNvbnRzdHIsIG5lZWRjb250ID0gJycsIDAKICAgIGNvbnRsaW5lID0gTm9uZQogICAgaW5kZW50cyA9IFswXQoKICAgIGlmIGVuY29kaW5nIGlzIG5vdCBOb25lOgogICAgICAgIGlmIGVuY29kaW5nID09ICJ1dGYtOC1zaWciOgogICAgICAgICAgICAjIEJPTSB3aWxsIGFscmVhZHkgaGF2ZSBiZWVuIHN0cmlwcGVkLgogICAgICAgICAgICBlbmNvZGluZyA9ICJ1dGYtOCIKICAgICAgICB5aWVsZCBUb2tlbkluZm8oRU5DT0RJTkcsIGVuY29kaW5nLCAoMCwgMCksICgwLCAwKSwgJycpCiAgICB3aGlsZSBUcnVlOiAgICAgICAgICAgICAjIGxvb3Agb3ZlciBsaW5lcyBpbiBzdHJlYW0KICAgICAgICB0cnk6CiAgICAgICAgICAgIGxpbmUgPSByZWFkbGluZSgpCiAgICAgICAgZXhjZXB0IFN0b3BJdGVyYXRpb246CiAgICAgICAgICAgIGxpbmUgPSBiJycKCiAgICAgICAgaWYgZW5jb2RpbmcgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGxpbmUgPSBsaW5lLmRlY29kZShlbmNvZGluZykKICAgICAgICBsbnVtICs9IDEKICAgICAgICBwb3MsIG1heCA9IDAsIGxlbihsaW5lKQoKICAgICAgICBpZiBjb250c3RyOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGNvbnRpbnVlZCBzdHJpbmcKICAgICAgICAgICAgaWYgbm90IGxpbmU6CiAgICAgICAgICAgICAgICByYWlzZSBUb2tlbkVycm9yKCJFT0YgaW4gbXVsdGktbGluZSBzdHJpbmciLCBzdHJzdGFydCkKICAgICAgICAgICAgZW5kbWF0Y2ggPSBlbmRwcm9nLm1hdGNoKGxpbmUpCiAgICAgICAgICAgIGlmIGVuZG1hdGNoOgogICAgICAgICAgICAgICAgcG9zID0gZW5kID0gZW5kbWF0Y2guZW5kKDApCiAgICAgICAgICAgICAgICB5aWVsZCBUb2tlbkluZm8oU1RSSU5HLCBjb250c3RyICsgbGluZVs6ZW5kXSwKICAgICAgICAgICAgICAgICAgICAgICBzdHJzdGFydCwgKGxudW0sIGVuZCksIGNvbnRsaW5lICsgbGluZSkKICAgICAgICAgICAgICAgIGNvbnRzdHIsIG5lZWRjb250ID0gJycsIDAKICAgICAgICAgICAgICAgIGNvbnRsaW5lID0gTm9uZQogICAgICAgICAgICBlbGlmIG5lZWRjb250IGFuZCBsaW5lWy0yOl0gIT0gJ1xcXG4nIGFuZCBsaW5lWy0zOl0gIT0gJ1xcXHJcbic6CiAgICAgICAgICAgICAgICB5aWVsZCBUb2tlbkluZm8oRVJST1JUT0tFTiwgY29udHN0ciArIGxpbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnN0YXJ0LCAobG51bSwgbGVuKGxpbmUpKSwgY29udGxpbmUpCiAgICAgICAgICAgICAgICBjb250c3RyID0gJycKICAgICAgICAgICAgICAgIGNvbnRsaW5lID0gTm9uZQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGNvbnRzdHIgPSBjb250c3RyICsgbGluZQogICAgICAgICAgICAgICAgY29udGxpbmUgPSBjb250bGluZSArIGxpbmUKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgIGVsaWYgcGFyZW5sZXYgPT0gMCBhbmQgbm90IGNvbnRpbnVlZDogICMgbmV3IHN0YXRlbWVudAogICAgICAgICAgICBpZiBub3QgbGluZTogYnJlYWsKICAgICAgICAgICAgY29sdW1uID0gMAogICAgICAgICAgICB3aGlsZSBwb3MgPCBtYXg6ICAgICAgICAgICAgICAgICAgICMgbWVhc3VyZSBsZWFkaW5nIHdoaXRlc3BhY2UKICAgICAgICAgICAgICAgIGlmIGxpbmVbcG9zXSA9PSAnICc6CiAgICAgICAgICAgICAgICAgICAgY29sdW1uICs9IDEKICAgICAgICAgICAgICAgIGVsaWYgbGluZVtwb3NdID09ICdcdCc6CiAgICAgICAgICAgICAgICAgICAgY29sdW1uID0gKGNvbHVtbi8vdGFic2l6ZSArIDEpKnRhYnNpemUKICAgICAgICAgICAgICAgIGVsaWYgbGluZVtwb3NdID09ICdcZic6CiAgICAgICAgICAgICAgICAgICAgY29sdW1uID0gMAogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgcG9zICs9IDEKICAgICAgICAgICAgaWYgcG9zID09IG1heDoKICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICBpZiBsaW5lW3Bvc10gaW4gJyNcclxuJzogICAgICAgICAgICMgc2tpcCBjb21tZW50cyBvciBibGFuayBsaW5lcwogICAgICAgICAgICAgICAgaWYgbGluZVtwb3NdID09ICcjJzoKICAgICAgICAgICAgICAgICAgICBjb21tZW50X3Rva2VuID0gbGluZVtwb3M6XS5yc3RyaXAoJ1xyXG4nKQogICAgICAgICAgICAgICAgICAgIG5sX3BvcyA9IHBvcyArIGxlbihjb21tZW50X3Rva2VuKQogICAgICAgICAgICAgICAgICAgIHlpZWxkIFRva2VuSW5mbyhDT01NRU5ULCBjb21tZW50X3Rva2VuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAobG51bSwgcG9zKSwgKGxudW0sIHBvcyArIGxlbihjb21tZW50X3Rva2VuKSksIGxpbmUpCiAgICAgICAgICAgICAgICAgICAgeWllbGQgVG9rZW5JbmZvKE5MLCBsaW5lW25sX3BvczpdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAobG51bSwgbmxfcG9zKSwgKGxudW0sIGxlbihsaW5lKSksIGxpbmUpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHlpZWxkIFRva2VuSW5mbygoTkwsIENPTU1FTlQpW2xpbmVbcG9zXSA9PSAnIyddLCBsaW5lW3BvczpdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAobG51bSwgcG9zKSwgKGxudW0sIGxlbihsaW5lKSksIGxpbmUpCiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgaWYgY29sdW1uID4gaW5kZW50c1stMV06ICAgICAgICAgICAjIGNvdW50IGluZGVudHMgb3IgZGVkZW50cwogICAgICAgICAgICAgICAgaW5kZW50cy5hcHBlbmQoY29sdW1uKQogICAgICAgICAgICAgICAgeWllbGQgVG9rZW5JbmZvKElOREVOVCwgbGluZVs6cG9zXSwgKGxudW0sIDApLCAobG51bSwgcG9zKSwgbGluZSkKICAgICAgICAgICAgd2hpbGUgY29sdW1uIDwgaW5kZW50c1stMV06CiAgICAgICAgICAgICAgICBpZiBjb2x1bW4gbm90IGluIGluZGVudHM6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgSW5kZW50YXRpb25FcnJvcigKICAgICAgICAgICAgICAgICAgICAgICAgInVuaW5kZW50IGRvZXMgbm90IG1hdGNoIGFueSBvdXRlciBpbmRlbnRhdGlvbiBsZXZlbCIsCiAgICAgICAgICAgICAgICAgICAgICAgICgiPHRva2VuaXplPiIsIGxudW0sIHBvcywgbGluZSkpCiAgICAgICAgICAgICAgICBpbmRlbnRzID0gaW5kZW50c1s6LTFdCiAgICAgICAgICAgICAgICB5aWVsZCBUb2tlbkluZm8oREVERU5ULCAnJywgKGxudW0sIHBvcyksIChsbnVtLCBwb3MpLCBsaW5lKQoKICAgICAgICBlbHNlOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGNvbnRpbnVlZCBzdGF0ZW1lbnQKICAgICAgICAgICAgaWYgbm90IGxpbmU6CiAgICAgICAgICAgICAgICByYWlzZSBUb2tlbkVycm9yKCJFT0YgaW4gbXVsdGktbGluZSBzdGF0ZW1lbnQiLCAobG51bSwgMCkpCiAgICAgICAgICAgIGNvbnRpbnVlZCA9IDAKCiAgICAgICAgd2hpbGUgcG9zIDwgbWF4OgogICAgICAgICAgICBwc2V1ZG9tYXRjaCA9IF9jb21waWxlKFBzZXVkb1Rva2VuKS5tYXRjaChsaW5lLCBwb3MpCiAgICAgICAgICAgIGlmIHBzZXVkb21hdGNoOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBzY2FuIGZvciB0b2tlbnMKICAgICAgICAgICAgICAgIHN0YXJ0LCBlbmQgPSBwc2V1ZG9tYXRjaC5zcGFuKDEpCiAgICAgICAgICAgICAgICBzcG9zLCBlcG9zLCBwb3MgPSAobG51bSwgc3RhcnQpLCAobG51bSwgZW5kKSwgZW5kCiAgICAgICAgICAgICAgICB0b2tlbiwgaW5pdGlhbCA9IGxpbmVbc3RhcnQ6ZW5kXSwgbGluZVtzdGFydF0KCiAgICAgICAgICAgICAgICBpZiAoaW5pdGlhbCBpbiBudW1jaGFycyBvciAgICAgICAgICAgICAgICAgICMgb3JkaW5hcnkgbnVtYmVyCiAgICAgICAgICAgICAgICAgICAgKGluaXRpYWwgPT0gJy4nIGFuZCB0b2tlbiAhPSAnLicgYW5kIHRva2VuICE9ICcuLi4nKSk6CiAgICAgICAgICAgICAgICAgICAgeWllbGQgVG9rZW5JbmZvKE5VTUJFUiwgdG9rZW4sIHNwb3MsIGVwb3MsIGxpbmUpCiAgICAgICAgICAgICAgICBlbGlmIGluaXRpYWwgaW4gJ1xyXG4nOgogICAgICAgICAgICAgICAgICAgIHlpZWxkIFRva2VuSW5mbyhOTCBpZiBwYXJlbmxldiA+IDAgZWxzZSBORVdMSU5FLAogICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlbiwgc3BvcywgZXBvcywgbGluZSkKICAgICAgICAgICAgICAgIGVsaWYgaW5pdGlhbCA9PSAnIyc6CiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0IG5vdCB0b2tlbi5lbmRzd2l0aCgiXG4iKQogICAgICAgICAgICAgICAgICAgIHlpZWxkIFRva2VuSW5mbyhDT01NRU5ULCB0b2tlbiwgc3BvcywgZXBvcywgbGluZSkKICAgICAgICAgICAgICAgIGVsaWYgdG9rZW4gaW4gdHJpcGxlX3F1b3RlZDoKICAgICAgICAgICAgICAgICAgICBlbmRwcm9nID0gX2NvbXBpbGUoZW5kcGF0c1t0b2tlbl0pCiAgICAgICAgICAgICAgICAgICAgZW5kbWF0Y2ggPSBlbmRwcm9nLm1hdGNoKGxpbmUsIHBvcykKICAgICAgICAgICAgICAgICAgICBpZiBlbmRtYXRjaDogICAgICAgICAgICAgICAgICAgICAgICAgICAjIGFsbCBvbiBvbmUgbGluZQogICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBlbmRtYXRjaC5lbmQoMCkKICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW4gPSBsaW5lW3N0YXJ0OnBvc10KICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgVG9rZW5JbmZvKFNUUklORywgdG9rZW4sIHNwb3MsIChsbnVtLCBwb3MpLCBsaW5lKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHN0cnN0YXJ0ID0gKGxudW0sIHN0YXJ0KSAgICAgICAgICAgIyBtdWx0aXBsZSBsaW5lcwogICAgICAgICAgICAgICAgICAgICAgICBjb250c3RyID0gbGluZVtzdGFydDpdCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRsaW5lID0gbGluZQogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgZWxpZiBpbml0aWFsIGluIHNpbmdsZV9xdW90ZWQgb3IgXAogICAgICAgICAgICAgICAgICAgIHRva2VuWzoyXSBpbiBzaW5nbGVfcXVvdGVkIG9yIFwKICAgICAgICAgICAgICAgICAgICB0b2tlbls6M10gaW4gc2luZ2xlX3F1b3RlZDoKICAgICAgICAgICAgICAgICAgICBpZiB0b2tlblstMV0gPT0gJ1xuJzogICAgICAgICAgICAgICAgICAjIGNvbnRpbnVlZCBzdHJpbmcKICAgICAgICAgICAgICAgICAgICAgICAgc3Ryc3RhcnQgPSAobG51bSwgc3RhcnQpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZHByb2cgPSBfY29tcGlsZShlbmRwYXRzW2luaXRpYWxdIG9yCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRwYXRzW3Rva2VuWzFdXSBvcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kcGF0c1t0b2tlblsyXV0pCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRzdHIsIG5lZWRjb250ID0gbGluZVtzdGFydDpdLCAxCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRsaW5lID0gbGluZQogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIGVsc2U6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgb3JkaW5hcnkgc3RyaW5nCiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIFRva2VuSW5mbyhTVFJJTkcsIHRva2VuLCBzcG9zLCBlcG9zLCBsaW5lKQogICAgICAgICAgICAgICAgZWxpZiBpbml0aWFsLmlzaWRlbnRpZmllcigpOiAgICAgICAgICAgICAgICMgb3JkaW5hcnkgbmFtZQogICAgICAgICAgICAgICAgICAgIHlpZWxkIFRva2VuSW5mbyhOQU1FLCB0b2tlbiwgc3BvcywgZXBvcywgbGluZSkKICAgICAgICAgICAgICAgIGVsaWYgaW5pdGlhbCA9PSAnXFwnOiAgICAgICAgICAgICAgICAgICAgICAjIGNvbnRpbnVlZCBzdG10CiAgICAgICAgICAgICAgICAgICAgY29udGludWVkID0gMQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBpZiBpbml0aWFsIGluICcoW3snOgogICAgICAgICAgICAgICAgICAgICAgICBwYXJlbmxldiArPSAxCiAgICAgICAgICAgICAgICAgICAgZWxpZiBpbml0aWFsIGluICcpXX0nOgogICAgICAgICAgICAgICAgICAgICAgICBwYXJlbmxldiAtPSAxCiAgICAgICAgICAgICAgICAgICAgeWllbGQgVG9rZW5JbmZvKE9QLCB0b2tlbiwgc3BvcywgZXBvcywgbGluZSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHlpZWxkIFRva2VuSW5mbyhFUlJPUlRPS0VOLCBsaW5lW3Bvc10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgIChsbnVtLCBwb3MpLCAobG51bSwgcG9zKzEpLCBsaW5lKQogICAgICAgICAgICAgICAgcG9zICs9IDEKCiAgICBmb3IgaW5kZW50IGluIGluZGVudHNbMTpdOiAgICAgICAgICAgICAgICAgIyBwb3AgcmVtYWluaW5nIGluZGVudCBsZXZlbHMKICAgICAgICB5aWVsZCBUb2tlbkluZm8oREVERU5ULCAnJywgKGxudW0sIDApLCAobG51bSwgMCksICcnKQogICAgeWllbGQgVG9rZW5JbmZvKEVORE1BUktFUiwgJycsIChsbnVtLCAwKSwgKGxudW0sIDApLCAnJykKCgojIEFuIHVuZG9jdW1lbnRlZCwgYmFja3dhcmRzIGNvbXBhdGlibGUsIEFQSSBmb3IgYWxsIHRoZSBwbGFjZXMgaW4gdGhlIHN0YW5kYXJkCiMgbGlicmFyeSB0aGF0IGV4cGVjdCB0byBiZSBhYmxlIHRvIHVzZSB0b2tlbml6ZSB3aXRoIHN0cmluZ3MKZGVmIGdlbmVyYXRlX3Rva2VucyhyZWFkbGluZSk6CiAgICByZXR1cm4gX3Rva2VuaXplKHJlYWRsaW5lLCBOb25lKQoKZGVmIG1haW4oKToKICAgIGltcG9ydCBhcmdwYXJzZQoKICAgICMgSGVscGVyIGVycm9yIGhhbmRsaW5nIHJvdXRpbmVzCiAgICBkZWYgcGVycm9yKG1lc3NhZ2UpOgogICAgICAgIHByaW50KG1lc3NhZ2UsIGZpbGU9c3lzLnN0ZGVycikKCiAgICBkZWYgZXJyb3IobWVzc2FnZSwgZmlsZW5hbWU9Tm9uZSwgbG9jYXRpb249Tm9uZSk6CiAgICAgICAgaWYgbG9jYXRpb246CiAgICAgICAgICAgIGFyZ3MgPSAoZmlsZW5hbWUsKSArIGxvY2F0aW9uICsgKG1lc3NhZ2UsKQogICAgICAgICAgICBwZXJyb3IoIiVzOiVkOiVkOiBlcnJvcjogJXMiICUgYXJncykKICAgICAgICBlbGlmIGZpbGVuYW1lOgogICAgICAgICAgICBwZXJyb3IoIiVzOiBlcnJvcjogJXMiICUgKGZpbGVuYW1lLCBtZXNzYWdlKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwZXJyb3IoImVycm9yOiAlcyIgJSBtZXNzYWdlKQogICAgICAgIHN5cy5leGl0KDEpCgogICAgIyBQYXJzZSB0aGUgYXJndW1lbnRzIGFuZCBvcHRpb25zCiAgICBwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihwcm9nPSdweXRob24gLW0gdG9rZW5pemUnKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudChkZXN0PSdmaWxlbmFtZScsIG5hcmdzPSc/JywKICAgICAgICAgICAgICAgICAgICAgICAgbWV0YXZhcj0nZmlsZW5hbWUucHknLAogICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSd0aGUgZmlsZSB0byB0b2tlbml6ZTsgZGVmYXVsdHMgdG8gc3RkaW4nKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgnLWUnLCAnLS1leGFjdCcsIGRlc3Q9J2V4YWN0JywgYWN0aW9uPSdzdG9yZV90cnVlJywKICAgICAgICAgICAgICAgICAgICAgICAgaGVscD0nZGlzcGxheSB0b2tlbiBuYW1lcyB1c2luZyB0aGUgZXhhY3QgdHlwZScpCiAgICBhcmdzID0gcGFyc2VyLnBhcnNlX2FyZ3MoKQoKICAgIHRyeToKICAgICAgICAjIFRva2VuaXplIHRoZSBpbnB1dAogICAgICAgIGlmIGFyZ3MuZmlsZW5hbWU6CiAgICAgICAgICAgIGZpbGVuYW1lID0gYXJncy5maWxlbmFtZQogICAgICAgICAgICB3aXRoIGJ1aWx0aW5zLm9wZW4oZmlsZW5hbWUsICdyYicpIGFzIGY6CiAgICAgICAgICAgICAgICB0b2tlbnMgPSBsaXN0KHRva2VuaXplKGYucmVhZGxpbmUpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGZpbGVuYW1lID0gIjxzdGRpbj4iCiAgICAgICAgICAgIHRva2VucyA9IF90b2tlbml6ZShzeXMuc3RkaW4ucmVhZGxpbmUsIE5vbmUpCgogICAgICAgICMgT3V0cHV0IHRoZSB0b2tlbml6YXRpb24KICAgICAgICBmb3IgdG9rZW4gaW4gdG9rZW5zOgogICAgICAgICAgICB0b2tlbl90eXBlID0gdG9rZW4udHlwZQogICAgICAgICAgICBpZiBhcmdzLmV4YWN0OgogICAgICAgICAgICAgICAgdG9rZW5fdHlwZSA9IHRva2VuLmV4YWN0X3R5cGUKICAgICAgICAgICAgdG9rZW5fcmFuZ2UgPSAiJWQsJWQtJWQsJWQ6IiAlICh0b2tlbi5zdGFydCArIHRva2VuLmVuZCkKICAgICAgICAgICAgcHJpbnQoIiUtMjBzJS0xNXMlLTE1ciIgJQogICAgICAgICAgICAgICAgICAodG9rZW5fcmFuZ2UsIHRva19uYW1lW3Rva2VuX3R5cGVdLCB0b2tlbi5zdHJpbmcpKQogICAgZXhjZXB0IEluZGVudGF0aW9uRXJyb3IgYXMgZXJyOgogICAgICAgIGxpbmUsIGNvbHVtbiA9IGVyci5hcmdzWzFdWzE6M10KICAgICAgICBlcnJvcihlcnIuYXJnc1swXSwgZmlsZW5hbWUsIChsaW5lLCBjb2x1bW4pKQogICAgZXhjZXB0IFRva2VuRXJyb3IgYXMgZXJyOgogICAgICAgIGxpbmUsIGNvbHVtbiA9IGVyci5hcmdzWzFdCiAgICAgICAgZXJyb3IoZXJyLmFyZ3NbMF0sIGZpbGVuYW1lLCAobGluZSwgY29sdW1uKSkKICAgIGV4Y2VwdCBTeW50YXhFcnJvciBhcyBlcnI6CiAgICAgICAgZXJyb3IoZXJyLCBmaWxlbmFtZSkKICAgIGV4Y2VwdCBJT0Vycm9yIGFzIGVycjoKICAgICAgICBlcnJvcihlcnIpCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgcHJpbnQoImludGVycnVwdGVkXG4iKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlcnI6CiAgICAgICAgcGVycm9yKCJ1bmV4cGVjdGVkIGVycm9yOiAlcyIgJSBlcnIpCiAgICAgICAgcmFpc2UKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBtYWluKCkK',
'/Lib/traceback.py':'aW1wb3J0IHN5cwpkZWYgcHJpbnRfZXhjKGZpbGU9c3lzLnN0ZGVycik6CiAgICBleGMgPSBfX0JSWVRIT05fXy5leGNlcHRpb25fc3RhY2tbLTFdCiAgICBmaWxlLndyaXRlKGV4Yy5pbmZvKQogICAgZmlsZS53cml0ZSgnXG4nK2V4Yy5fX25hbWVfXykKICAgIGlmIGV4Yy5tZXNzYWdlOgogICAgICAgIGZpbGUud3JpdGUoJzogJytleGMubWVzc2FnZSkKICAgIGZpbGUud3JpdGUoJ1xuJykK',
'/Lib/types.py':'IiIiCkRlZmluZSBuYW1lcyBmb3IgYnVpbHQtaW4gdHlwZXMgdGhhdCBhcmVuJ3QgZGlyZWN0bHkgYWNjZXNzaWJsZSBhcyBhIGJ1aWx0aW4uCiIiIgppbXBvcnQgc3lzCgojIEl0ZXJhdG9ycyBpbiBQeXRob24gYXJlbid0IGEgbWF0dGVyIG9mIHR5cGUgYnV0IG9mIHByb3RvY29sLiAgQSBsYXJnZQojIGFuZCBjaGFuZ2luZyBudW1iZXIgb2YgYnVpbHRpbiB0eXBlcyBpbXBsZW1lbnQgKnNvbWUqIGZsYXZvciBvZgojIGl0ZXJhdG9yLiAgRG9uJ3QgY2hlY2sgdGhlIHR5cGUhICBVc2UgaGFzYXR0ciB0byBjaGVjayBmb3IgYm90aAojICJfX2l0ZXJfXyIgYW5kICJfX25leHRfXyIgYXR0cmlidXRlcyBpbnN0ZWFkLgoKI2RlZiBfZigpOiBwYXNzCiNGdW5jdGlvblR5cGUgPSB0eXBlKF9mKQojTGFtYmRhVHlwZSA9IHR5cGUobGFtYmRhOiBOb25lKSAgICAgICAgICMgU2FtZSBhcyBGdW5jdGlvblR5cGUKI0NvZGVUeXBlID0gdHlwZShfZi5fX2NvZGVfXykKCiNkZWYgX2coKToKIyAgICB5aWVsZCAxCiNHZW5lcmF0b3JUeXBlID0gdHlwZShfZygpKQoKY2xhc3MgX0M6CiAgICBkZWYgX20oc2VsZik6IHBhc3MKTWV0aG9kVHlwZSA9IHR5cGUoX0MoKS5fbSkKCkJ1aWx0aW5GdW5jdGlvblR5cGUgPSB0eXBlKGxlbikKQnVpbHRpbk1ldGhvZFR5cGUgPSB0eXBlKFtdLmFwcGVuZCkgICAgICMgU2FtZSBhcyBCdWlsdGluRnVuY3Rpb25UeXBlCgpNb2R1bGVUeXBlID0gdHlwZShzeXMpCmRlZiBmb28oKTpwYXNzCkZ1bmN0aW9uVHlwZSA9IHR5cGUoZm9vKQojdHJ5OgojICAgIHJhaXNlIFR5cGVFcnJvcgojZXhjZXB0IFR5cGVFcnJvcjoKIyAgICB0YiA9IHN5cy5leGNfaW5mbygpWzJdCiMgICAgVHJhY2ViYWNrVHlwZSA9IHR5cGUodGIpCiMgICAgRnJhbWVUeXBlID0gdHlwZSh0Yi50Yl9mcmFtZSkKIyAgICB0YiA9IE5vbmU7IGRlbCB0YgoKIyBGb3IgSnl0aG9uLCB0aGUgZm9sbG93aW5nIHR3byB0eXBlcyBhcmUgaWRlbnRpY2FsCiNHZXRTZXREZXNjcmlwdG9yVHlwZSA9IHR5cGUoRnVuY3Rpb25UeXBlLl9fY29kZV9fKQojTWVtYmVyRGVzY3JpcHRvclR5cGUgPSB0eXBlKEZ1bmN0aW9uVHlwZS5fX2dsb2JhbHNfXykKCiNmaXhtZSBicnl0aG9uCiNkZWwgc3lzLCBfZiwgX2csIF9DLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgTm90IGZvciBleHBvcnQK',
'/Lib/VFS_import.py':'aW1wb3J0IG9zCmZyb20gYnJvd3NlciBpbXBvcnQgZG9jCgojX3NjcmlwdHM9ZG9jLmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpCiNfc2NyaXB0cy5zcmM9Ii9zcmMvcHlfVkZTLmpzIgojX3NjcmlwdHMudHlwZT0idGV4dC9qYXZhc2NyaXB0IgojZG9jLmdldCh0YWc9J2hlYWQnKVswXS5hcHBlbmRDaGlsZChfc2NyaXB0cykKClZGUz1kaWN0KEpTT2JqZWN0KF9fQlJZVEhPTl9fLnB5X1ZGUykpCmNsYXNzIFZGU01vZHVsZUZpbmRlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBwYXRoX2VudHJ5KToKICAgICAgICBwcmludCgiaW4gVkZTTW9kdWxlRmluZGVyIikKICAgICAgICBpZiBwYXRoX2VudHJ5LnN0YXJ0c3dpdGgoJy9saWJzJykgb3IgcGF0aF9lbnRyeS5zdGFydHN3aXRoKCcvTGliJyk6CiAgICAgICAgICAgc2VsZi5wYXRoX2VudHJ5PXBhdGhfZW50cnkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBJbXBvcnRFcnJvcigpCiAgICAgICAgCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gJzwlcyBmb3IgIiVzIj4nICUgKHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLCBzZWxmLnBhdGhfZW50cnkpCiAgICAgICAgCiAgICBkZWYgZmluZF9tb2R1bGUoc2VsZiwgZnVsbG5hbWUsIHBhdGg9Tm9uZSk6CiAgICAgICAgcGF0aCA9IHBhdGggb3Igc2VsZi5wYXRoX2VudHJ5CiAgICAgICAgI3ByaW50KCdsb29raW5nIGZvciAiJXMiIGluICVzIC4uLicgJSAoZnVsbG5hbWUsIHBhdGgpKQogICAgICAgIGZvciBfZXh0IGluIFsnanMnLCAncHlqJywgJ3B5J106CiAgICAgICAgICAgIF9maWxlcGF0aD1vcy5wYXRoLmpvaW4oc2VsZi5wYXRoX2VudHJ5LCAnJXMuJXMnICUgKGZ1bGxuYW1lLCBfZXh0KSkKICAgICAgICAgICAgaWYgX2ZpbGVwYXRoIGluIFZGUzoKICAgICAgICAgICAgICAgcHJpbnQoIm1vZHVsZSBmb3VuZCBhdCAlczolcyIgJSAoX2ZpbGVwYXRoLCBmdWxsbmFtZSkpCiAgICAgICAgICAgICAgIHJldHVybiBWRlNNb2R1bGVMb2FkZXIoX2ZpbGVwYXRoLCBmdWxsbmFtZSkKCiAgICAgICAgcHJpbnQoJ21vZHVsZSAlcyBub3QgZm91bmQnICUgZnVsbG5hbWUpCiAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IoKQogICAgICAgIHJldHVybiBOb25lCgpjbGFzcyBWRlNNb2R1bGVMb2FkZXI6CiAgICAiIiJMb2FkIHNvdXJjZSBmb3IgbW9kdWxlcyIiIgogICAgCiAgICBkZWYgX19pbml0X18oc2VsZiwgZmlsZXBhdGgsIG5hbWUpOgogICAgICAgIHNlbGYuX2ZpbGVwYXRoPWZpbGVwYXRoCiAgICAgICAgc2VsZi5fbmFtZT1uYW1lCiAgICAgICAgCiAgICBkZWYgZ2V0X3NvdXJjZShzZWxmKToKICAgICAgICBpZiBzZWxmLl9maWxlcGF0aCBpbiBWRlM6CiAgICAgICAgICAgcmV0dXJuIEpTT2JqZWN0KHJlYWRGcm9tVkZTKHNlbGYuX2ZpbGVwYXRoKSkKCiAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IoJ2NvdWxkIG5vdCBmaW5kIHNvdXJjZSBmb3IgJXMnICUgZnVsbG5hbWUpCgogICAgZGVmIGlzX3BhY2thZ2Uoc2VsZik6CiAgICAgICAgcmV0dXJuICcuJyBpbiBzZWxmLl9uYW1lCiAgICAgICAgICAgIAogICAgZGVmIGxvYWRfbW9kdWxlKHNlbGYpOgogICAgICAgIGlmIHNlbGYuX25hbWUgaW4gc3lzLm1vZHVsZXM6CiAgICAgICAgICAgI3ByaW50KCdyZXVzaW5nIGV4aXN0aW5nIG1vZHVsZSBmcm9tIHByZXZpb3VzIGltcG9ydCBvZiAiJXMiJyAlIGZ1bGxuYW1lKQogICAgICAgICAgIG1vZCA9IHN5cy5tb2R1bGVzW3NlbGYuX25hbWVdCiAgICAgICAgICAgcmV0dXJuIG1vZAogICAgICAgIAogICAgICAgIF9zcmM9c2VsZi5nZXRfc291cmNlKCkKICAgICAgICBpZiBzZWxmLl9maWxlcGF0aC5lbmRzd2l0aCgnLmpzJyk6CiAgICAgICAgICAgbW9kPUpTT2JqZWN0KGltcG9ydF9qc19tb2R1bGUoX3NyYywgc2VsZi5fZmlsZXBhdGgsIHNlbGYuX25hbWUpKQogICAgICAgIGVsaWYgc2VsZi5fZmlsZXBhdGguZW5kc3dpdGgoJy5weScpOgogICAgICAgICAgIG1vZD1KU09iamVjdChpbXBvcnRfcHlfbW9kdWxlKF9zcmMsIHNlbGYuX2ZpbGVwYXRoLCBzZWxmLl9uYW1lKSkKICAgICAgICBlbGlmIHNlbGYuX2ZpbGVwYXRoLmVuZHN3aXRoKCcucHlqJyk6CiAgICAgICAgICAgbW9kPUpTT2JqZWN0KGltcG9ydF9weWpfbW9kdWxlKF9zcmMsIHNlbGYuX2ZpbGVwYXRoLCBzZWxmLl9uYW1lKSkKICAgICAgICBlbHNlOgogICAgICAgICAgIHJhaXNlIEltcG9ydEVycm9yKCdJbnZhbGlkIE1vZHVsZTogJXMnICUgc2VsZi5fZmlsZXBhdGgpCgogICAgICAgICMgU2V0IGEgZmV3IHByb3BlcnRpZXMgcmVxdWlyZWQgYnkgUEVQIDMwMgogICAgICAgIG1vZC5fX2ZpbGVfXyA9IHNlbGYuX2ZpbGVwYXRoCiAgICAgICAgbW9kLl9fbmFtZV9fID0gc2VsZi5fbmFtZQogICAgICAgIG1vZC5fX3BhdGhfXyA9IG9zLnBhdGguYWJzcGF0aChzZWxmLl9maWxlcGF0aCkKICAgICAgICBtb2QuX19sb2FkZXJfXyA9IHNlbGYKICAgICAgICBtb2QuX19wYWNrYWdlX18gPSAnLicuam9pbihzZWxmLl9uYW1lLnNwbGl0KCcuJylbOi0xXSkKICAgICAgICAKICAgICAgICBpZiBzZWxmLmlzX3BhY2thZ2UoKToKICAgICAgICAgICBwcmludCgnYWRkaW5nIHBhdGggZm9yIHBhY2thZ2UnKQogICAgICAgICAgICMgU2V0IF9fcGF0aF9fIGZvciBwYWNrYWdlcwogICAgICAgICAgICMgc28gd2UgY2FuIGZpbmQgdGhlIHN1Yi1tb2R1bGVzLgogICAgICAgICAgIG1vZC5fX3BhdGhfXyA9IFsgc2VsZi5wYXRoX2VudHJ5IF0KICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludCgnaW1wb3J0ZWQgYXMgcmVndWxhciBtb2R1bGUnKQogICAgICAgIAogICAgICAgIHByaW50KCdjcmVhdGluZyBhIG5ldyBtb2R1bGUgb2JqZWN0IGZvciAiJXMiJyAlIHNlbGYuX25hbWUpCiAgICAgICAgc3lzLm1vZHVsZXMuc2V0ZGVmYXVsdChzZWxmLl9uYW1lLCBtb2QpCiAgICAgICAgSlNPYmplY3QoX19CUllUSE9OX18uaW1wb3J0ZWQpW3NlbGYuX25hbWVdPW1vZAoKICAgICAgICByZXR1cm4gbW9kCgpKU09iamVjdChfX0JSWVRIT05fXy5wYXRoX2hvb2tzLmluc2VydCgwLCBWRlNNb2R1bGVGaW5kZXIpKQo=',
'/Lib/warnings.py':'IiIiUHl0aG9uIHBhcnQgb2YgdGhlIHdhcm5pbmdzIHN1YnN5c3RlbS4iIiIKCiMgTm90ZTogZnVuY3Rpb24gbGV2ZWwgaW1wb3J0cyBzaG91bGQgKm5vdCogYmUgdXNlZAojIGluIHRoaXMgbW9kdWxlIGFzIGl0IG1heSBjYXVzZSBpbXBvcnQgbG9jayBkZWFkbG9jay4KIyBTZWUgYnVnIDY4MzY1OC4KaW1wb3J0IGxpbmVjYWNoZQppbXBvcnQgc3lzCgpfX2FsbF9fID0gWyJ3YXJuIiwgInNob3d3YXJuaW5nIiwgImZvcm1hdHdhcm5pbmciLCAiZmlsdGVyd2FybmluZ3MiLAogICAgICAgICAgICJyZXNldHdhcm5pbmdzIiwgImNhdGNoX3dhcm5pbmdzIl0KCgpkZWYgc2hvd3dhcm5pbmcobWVzc2FnZSwgY2F0ZWdvcnksIGZpbGVuYW1lLCBsaW5lbm8sIGZpbGU9Tm9uZSwgbGluZT1Ob25lKToKICAgICIiIkhvb2sgdG8gd3JpdGUgYSB3YXJuaW5nIHRvIGEgZmlsZTsgcmVwbGFjZSBpZiB5b3UgbGlrZS4iIiIKICAgIGlmIGZpbGUgaXMgTm9uZToKICAgICAgICBmaWxlID0gc3lzLnN0ZGVycgogICAgdHJ5OgogICAgICAgIGZpbGUud3JpdGUoZm9ybWF0d2FybmluZyhtZXNzYWdlLCBjYXRlZ29yeSwgZmlsZW5hbWUsIGxpbmVubywgbGluZSkpCiAgICBleGNlcHQgSU9FcnJvcjoKICAgICAgICBwYXNzICMgdGhlIGZpbGUgKHByb2JhYmx5IHN0ZGVycikgaXMgaW52YWxpZCAtIHRoaXMgd2FybmluZyBnZXRzIGxvc3QuCgpkZWYgZm9ybWF0d2FybmluZyhtZXNzYWdlLCBjYXRlZ29yeSwgZmlsZW5hbWUsIGxpbmVubywgbGluZT1Ob25lKToKICAgICIiIkZ1bmN0aW9uIHRvIGZvcm1hdCBhIHdhcm5pbmcgdGhlIHN0YW5kYXJkIHdheS4iIiIKICAgIHMgPSAgIiVzOiVzOiAlczogJXNcbiIgJSAoZmlsZW5hbWUsIGxpbmVubywgY2F0ZWdvcnkuX19uYW1lX18sIG1lc3NhZ2UpCiAgICBsaW5lID0gbGluZWNhY2hlLmdldGxpbmUoZmlsZW5hbWUsIGxpbmVubykgaWYgbGluZSBpcyBOb25lIGVsc2UgbGluZQogICAgaWYgbGluZToKICAgICAgICBsaW5lID0gbGluZS5zdHJpcCgpCiAgICAgICAgcyArPSAiICAlc1xuIiAlIGxpbmUKICAgIHJldHVybiBzCgpkZWYgZmlsdGVyd2FybmluZ3MoYWN0aW9uLCBtZXNzYWdlPSIiLCBjYXRlZ29yeT1XYXJuaW5nLCBtb2R1bGU9IiIsIGxpbmVubz0wLAogICAgICAgICAgICAgICAgICAgYXBwZW5kPUZhbHNlKToKICAgICIiIkluc2VydCBhbiBlbnRyeSBpbnRvIHRoZSBsaXN0IG9mIHdhcm5pbmdzIGZpbHRlcnMgKGF0IHRoZSBmcm9udCkuCgogICAgJ2FjdGlvbicgLS0gb25lIG9mICJlcnJvciIsICJpZ25vcmUiLCAiYWx3YXlzIiwgImRlZmF1bHQiLCAibW9kdWxlIiwKICAgICAgICAgICAgICAgIG9yICJvbmNlIgogICAgJ21lc3NhZ2UnIC0tIGEgcmVnZXggdGhhdCB0aGUgd2FybmluZyBtZXNzYWdlIG11c3QgbWF0Y2gKICAgICdjYXRlZ29yeScgLS0gYSBjbGFzcyB0aGF0IHRoZSB3YXJuaW5nIG11c3QgYmUgYSBzdWJjbGFzcyBvZgogICAgJ21vZHVsZScgLS0gYSByZWdleCB0aGF0IHRoZSBtb2R1bGUgbmFtZSBtdXN0IG1hdGNoCiAgICAnbGluZW5vJyAtLSBhbiBpbnRlZ2VyIGxpbmUgbnVtYmVyLCAwIG1hdGNoZXMgYWxsIHdhcm5pbmdzCiAgICAnYXBwZW5kJyAtLSBpZiB0cnVlLCBhcHBlbmQgdG8gdGhlIGxpc3Qgb2YgZmlsdGVycwogICAgIiIiCiAgICBpbXBvcnQgcmUKICAgIGFzc2VydCBhY3Rpb24gaW4gKCJlcnJvciIsICJpZ25vcmUiLCAiYWx3YXlzIiwgImRlZmF1bHQiLCAibW9kdWxlIiwKICAgICAgICAgICAgICAgICAgICAgICJvbmNlIiksICJpbnZhbGlkIGFjdGlvbjogJXIiICUgKGFjdGlvbiwpCiAgICBhc3NlcnQgaXNpbnN0YW5jZShtZXNzYWdlLCBzdHIpLCAibWVzc2FnZSBtdXN0IGJlIGEgc3RyaW5nIgogICAgYXNzZXJ0IGlzaW5zdGFuY2UoY2F0ZWdvcnksIHR5cGUpLCAiY2F0ZWdvcnkgbXVzdCBiZSBhIGNsYXNzIgogICAgYXNzZXJ0IGlzc3ViY2xhc3MoY2F0ZWdvcnksIFdhcm5pbmcpLCAiY2F0ZWdvcnkgbXVzdCBiZSBhIFdhcm5pbmcgc3ViY2xhc3MiCiAgICBhc3NlcnQgaXNpbnN0YW5jZShtb2R1bGUsIHN0ciksICJtb2R1bGUgbXVzdCBiZSBhIHN0cmluZyIKICAgIGFzc2VydCBpc2luc3RhbmNlKGxpbmVubywgaW50KSBhbmQgbGluZW5vID49IDAsIFwKICAgICAgICAgICAibGluZW5vIG11c3QgYmUgYW4gaW50ID49IDAiCiAgICBpdGVtID0gKGFjdGlvbiwgcmUuY29tcGlsZShtZXNzYWdlLCByZS5JKSwgY2F0ZWdvcnksCiAgICAgICAgICAgIHJlLmNvbXBpbGUobW9kdWxlKSwgbGluZW5vKQogICAgaWYgYXBwZW5kOgogICAgICAgIGZpbHRlcnMuYXBwZW5kKGl0ZW0pCiAgICBlbHNlOgogICAgICAgIGZpbHRlcnMuaW5zZXJ0KDAsIGl0ZW0pCgpkZWYgc2ltcGxlZmlsdGVyKGFjdGlvbiwgY2F0ZWdvcnk9V2FybmluZywgbGluZW5vPTAsIGFwcGVuZD1GYWxzZSk6CiAgICAiIiJJbnNlcnQgYSBzaW1wbGUgZW50cnkgaW50byB0aGUgbGlzdCBvZiB3YXJuaW5ncyBmaWx0ZXJzIChhdCB0aGUgZnJvbnQpLgoKICAgIEEgc2ltcGxlIGZpbHRlciBtYXRjaGVzIGFsbCBtb2R1bGVzIGFuZCBtZXNzYWdlcy4KICAgICdhY3Rpb24nIC0tIG9uZSBvZiAiZXJyb3IiLCAiaWdub3JlIiwgImFsd2F5cyIsICJkZWZhdWx0IiwgIm1vZHVsZSIsCiAgICAgICAgICAgICAgICBvciAib25jZSIKICAgICdjYXRlZ29yeScgLS0gYSBjbGFzcyB0aGF0IHRoZSB3YXJuaW5nIG11c3QgYmUgYSBzdWJjbGFzcyBvZgogICAgJ2xpbmVubycgLS0gYW4gaW50ZWdlciBsaW5lIG51bWJlciwgMCBtYXRjaGVzIGFsbCB3YXJuaW5ncwogICAgJ2FwcGVuZCcgLS0gaWYgdHJ1ZSwgYXBwZW5kIHRvIHRoZSBsaXN0IG9mIGZpbHRlcnMKICAgICIiIgogICAgYXNzZXJ0IGFjdGlvbiBpbiAoImVycm9yIiwgImlnbm9yZSIsICJhbHdheXMiLCAiZGVmYXVsdCIsICJtb2R1bGUiLAogICAgICAgICAgICAgICAgICAgICAgIm9uY2UiKSwgImludmFsaWQgYWN0aW9uOiAlciIgJSAoYWN0aW9uLCkKICAgIGFzc2VydCBpc2luc3RhbmNlKGxpbmVubywgaW50KSBhbmQgbGluZW5vID49IDAsIFwKICAgICAgICAgICAibGluZW5vIG11c3QgYmUgYW4gaW50ID49IDAiCiAgICBpdGVtID0gKGFjdGlvbiwgTm9uZSwgY2F0ZWdvcnksIE5vbmUsIGxpbmVubykKICAgIGlmIGFwcGVuZDoKICAgICAgICBmaWx0ZXJzLmFwcGVuZChpdGVtKQogICAgZWxzZToKICAgICAgICBmaWx0ZXJzLmluc2VydCgwLCBpdGVtKQoKZGVmIHJlc2V0d2FybmluZ3MoKToKICAgICIiIkNsZWFyIHRoZSBsaXN0IG9mIHdhcm5pbmcgZmlsdGVycywgc28gdGhhdCBubyBmaWx0ZXJzIGFyZSBhY3RpdmUuIiIiCiAgICBmaWx0ZXJzWzpdID0gW10KCmNsYXNzIF9PcHRpb25FcnJvcihFeGNlcHRpb24pOgogICAgIiIiRXhjZXB0aW9uIHVzZWQgYnkgb3B0aW9uIHByb2Nlc3NpbmcgaGVscGVycy4iIiIKICAgIHBhc3MKCiMgSGVscGVyIHRvIHByb2Nlc3MgLVcgb3B0aW9ucyBwYXNzZWQgdmlhIHN5cy53YXJub3B0aW9ucwpkZWYgX3Byb2Nlc3NvcHRpb25zKGFyZ3MpOgogICAgZm9yIGFyZyBpbiBhcmdzOgogICAgICAgIHRyeToKICAgICAgICAgICAgX3NldG9wdGlvbihhcmcpCiAgICAgICAgZXhjZXB0IF9PcHRpb25FcnJvciBhcyBtc2c6CiAgICAgICAgICAgIHByaW50KCJJbnZhbGlkIC1XIG9wdGlvbiBpZ25vcmVkOiIsIG1zZywgZmlsZT1zeXMuc3RkZXJyKQoKIyBIZWxwZXIgZm9yIF9wcm9jZXNzb3B0aW9ucygpCmRlZiBfc2V0b3B0aW9uKGFyZyk6CiAgICBpbXBvcnQgcmUKICAgIHBhcnRzID0gYXJnLnNwbGl0KCc6JykKICAgIGlmIGxlbihwYXJ0cykgPiA1OgogICAgICAgIHJhaXNlIF9PcHRpb25FcnJvcigidG9vIG1hbnkgZmllbGRzIChtYXggNSk6ICVyIiAlIChhcmcsKSkKICAgIHdoaWxlIGxlbihwYXJ0cykgPCA1OgogICAgICAgIHBhcnRzLmFwcGVuZCgnJykKICAgIGFjdGlvbiwgbWVzc2FnZSwgY2F0ZWdvcnksIG1vZHVsZSwgbGluZW5vID0gW3Muc3RyaXAoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIHMgaW4gcGFydHNdCiAgICBhY3Rpb24gPSBfZ2V0YWN0aW9uKGFjdGlvbikKICAgIG1lc3NhZ2UgPSByZS5lc2NhcGUobWVzc2FnZSkKICAgIGNhdGVnb3J5ID0gX2dldGNhdGVnb3J5KGNhdGVnb3J5KQogICAgbW9kdWxlID0gcmUuZXNjYXBlKG1vZHVsZSkKICAgIGlmIG1vZHVsZToKICAgICAgICBtb2R1bGUgPSBtb2R1bGUgKyAnJCcKICAgIGlmIGxpbmVubzoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxpbmVubyA9IGludChsaW5lbm8pCiAgICAgICAgICAgIGlmIGxpbmVubyA8IDA6CiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yCiAgICAgICAgZXhjZXB0IChWYWx1ZUVycm9yLCBPdmVyZmxvd0Vycm9yKToKICAgICAgICAgICAgcmFpc2UgX09wdGlvbkVycm9yKCJpbnZhbGlkIGxpbmVubyAlciIgJSAobGluZW5vLCkpCiAgICBlbHNlOgogICAgICAgIGxpbmVubyA9IDAKICAgIGZpbHRlcndhcm5pbmdzKGFjdGlvbiwgbWVzc2FnZSwgY2F0ZWdvcnksIG1vZHVsZSwgbGluZW5vKQoKIyBIZWxwZXIgZm9yIF9zZXRvcHRpb24oKQpkZWYgX2dldGFjdGlvbihhY3Rpb24pOgogICAgaWYgbm90IGFjdGlvbjoKICAgICAgICByZXR1cm4gImRlZmF1bHQiCiAgICBpZiBhY3Rpb24gPT0gImFsbCI6IHJldHVybiAiYWx3YXlzIiAjIEFsaWFzCiAgICBmb3IgYSBpbiAoJ2RlZmF1bHQnLCAnYWx3YXlzJywgJ2lnbm9yZScsICdtb2R1bGUnLCAnb25jZScsICdlcnJvcicpOgogICAgICAgIGlmIGEuc3RhcnRzd2l0aChhY3Rpb24pOgogICAgICAgICAgICByZXR1cm4gYQogICAgcmFpc2UgX09wdGlvbkVycm9yKCJpbnZhbGlkIGFjdGlvbjogJXIiICUgKGFjdGlvbiwpKQoKIyBIZWxwZXIgZm9yIF9zZXRvcHRpb24oKQpkZWYgX2dldGNhdGVnb3J5KGNhdGVnb3J5KToKICAgIGltcG9ydCByZQogICAgaWYgbm90IGNhdGVnb3J5OgogICAgICAgIHJldHVybiBXYXJuaW5nCiAgICBpZiByZS5tYXRjaCgiXlthLXpBLVowLTlfXSskIiwgY2F0ZWdvcnkpOgogICAgICAgIHRyeToKICAgICAgICAgICAgY2F0ID0gZXZhbChjYXRlZ29yeSkKICAgICAgICBleGNlcHQgTmFtZUVycm9yOgogICAgICAgICAgICByYWlzZSBfT3B0aW9uRXJyb3IoInVua25vd24gd2FybmluZyBjYXRlZ29yeTogJXIiICUgKGNhdGVnb3J5LCkpCiAgICBlbHNlOgogICAgICAgIGkgPSBjYXRlZ29yeS5yZmluZCgiLiIpCiAgICAgICAgbW9kdWxlID0gY2F0ZWdvcnlbOmldCiAgICAgICAga2xhc3MgPSBjYXRlZ29yeVtpKzE6XQogICAgICAgIHRyeToKICAgICAgICAgICAgbSA9IF9faW1wb3J0X18obW9kdWxlLCBOb25lLCBOb25lLCBba2xhc3NdKQogICAgICAgIGV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgICAgICAgICAgcmFpc2UgX09wdGlvbkVycm9yKCJpbnZhbGlkIG1vZHVsZSBuYW1lOiAlciIgJSAobW9kdWxlLCkpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBjYXQgPSBnZXRhdHRyKG0sIGtsYXNzKQogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgcmFpc2UgX09wdGlvbkVycm9yKCJ1bmtub3duIHdhcm5pbmcgY2F0ZWdvcnk6ICVyIiAlIChjYXRlZ29yeSwpKQogICAgaWYgbm90IGlzc3ViY2xhc3MoY2F0LCBXYXJuaW5nKToKICAgICAgICByYWlzZSBfT3B0aW9uRXJyb3IoImludmFsaWQgd2FybmluZyBjYXRlZ29yeTogJXIiICUgKGNhdGVnb3J5LCkpCiAgICByZXR1cm4gY2F0CgoKIyBDb2RlIHR5cGljYWxseSByZXBsYWNlZCBieSBfd2FybmluZ3MKZGVmIHdhcm4obWVzc2FnZSwgY2F0ZWdvcnk9Tm9uZSwgc3RhY2tsZXZlbD0xKToKICAgICIiIklzc3VlIGEgd2FybmluZywgb3IgbWF5YmUgaWdub3JlIGl0IG9yIHJhaXNlIGFuIGV4Y2VwdGlvbi4iIiIKICAgICMgQ2hlY2sgaWYgbWVzc2FnZSBpcyBhbHJlYWR5IGEgV2FybmluZyBvYmplY3QKICAgIGlmIGlzaW5zdGFuY2UobWVzc2FnZSwgV2FybmluZyk6CiAgICAgICAgY2F0ZWdvcnkgPSBtZXNzYWdlLl9fY2xhc3NfXwogICAgIyBDaGVjayBjYXRlZ29yeSBhcmd1bWVudAogICAgaWYgY2F0ZWdvcnkgaXMgTm9uZToKICAgICAgICBjYXRlZ29yeSA9IFVzZXJXYXJuaW5nCiAgICBhc3NlcnQgaXNzdWJjbGFzcyhjYXRlZ29yeSwgV2FybmluZykKICAgICMgR2V0IGNvbnRleHQgaW5mb3JtYXRpb24KICAgIHRyeToKICAgICAgICBjYWxsZXIgPSBzeXMuX2dldGZyYW1lKHN0YWNrbGV2ZWwpCiAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICBnbG9iYWxzID0gc3lzLl9fZGljdF9fCiAgICAgICAgbGluZW5vID0gMQogICAgZWxzZToKICAgICAgICBnbG9iYWxzID0gY2FsbGVyLmZfZ2xvYmFscwogICAgICAgIGxpbmVubyA9IGNhbGxlci5mX2xpbmVubwogICAgaWYgJ19fbmFtZV9fJyBpbiBnbG9iYWxzOgogICAgICAgIG1vZHVsZSA9IGdsb2JhbHNbJ19fbmFtZV9fJ10KICAgIGVsc2U6CiAgICAgICAgbW9kdWxlID0gIjxzdHJpbmc+IgogICAgZmlsZW5hbWUgPSBnbG9iYWxzLmdldCgnX19maWxlX18nKQogICAgaWYgZmlsZW5hbWU6CiAgICAgICAgZm5sID0gZmlsZW5hbWUubG93ZXIoKQogICAgICAgIGlmIGZubC5lbmRzd2l0aCgoIi5weWMiLCAiLnB5byIpKToKICAgICAgICAgICAgZmlsZW5hbWUgPSBmaWxlbmFtZVs6LTFdCiAgICBlbHNlOgogICAgICAgIGlmIG1vZHVsZSA9PSAiX19tYWluX18iOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBmaWxlbmFtZSA9IHN5cy5hcmd2WzBdCiAgICAgICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgICAgICMgZW1iZWRkZWQgaW50ZXJwcmV0ZXJzIGRvbid0IGhhdmUgc3lzLmFyZ3YsIHNlZSBidWcgIzgzOTE1MQogICAgICAgICAgICAgICAgZmlsZW5hbWUgPSAnX19tYWluX18nCiAgICAgICAgaWYgbm90IGZpbGVuYW1lOgogICAgICAgICAgICBmaWxlbmFtZSA9IG1vZHVsZQogICAgcmVnaXN0cnkgPSBnbG9iYWxzLnNldGRlZmF1bHQoIl9fd2FybmluZ3JlZ2lzdHJ5X18iLCB7fSkKICAgIHdhcm5fZXhwbGljaXQobWVzc2FnZSwgY2F0ZWdvcnksIGZpbGVuYW1lLCBsaW5lbm8sIG1vZHVsZSwgcmVnaXN0cnksCiAgICAgICAgICAgICAgICAgIGdsb2JhbHMpCgpkZWYgd2Fybl9leHBsaWNpdChtZXNzYWdlLCBjYXRlZ29yeSwgZmlsZW5hbWUsIGxpbmVubywKICAgICAgICAgICAgICAgICAgbW9kdWxlPU5vbmUsIHJlZ2lzdHJ5PU5vbmUsIG1vZHVsZV9nbG9iYWxzPU5vbmUpOgogICAgbGluZW5vID0gaW50KGxpbmVubykKICAgIGlmIG1vZHVsZSBpcyBOb25lOgogICAgICAgIG1vZHVsZSA9IGZpbGVuYW1lIG9yICI8dW5rbm93bj4iCiAgICAgICAgaWYgbW9kdWxlWy0zOl0ubG93ZXIoKSA9PSAiLnB5IjoKICAgICAgICAgICAgbW9kdWxlID0gbW9kdWxlWzotM10gIyBYWFggV2hhdCBhYm91dCBsZWFkaW5nIHBhdGhuYW1lPwogICAgaWYgcmVnaXN0cnkgaXMgTm9uZToKICAgICAgICByZWdpc3RyeSA9IHt9CiAgICBpZiBpc2luc3RhbmNlKG1lc3NhZ2UsIFdhcm5pbmcpOgogICAgICAgIHRleHQgPSBzdHIobWVzc2FnZSkKICAgICAgICBjYXRlZ29yeSA9IG1lc3NhZ2UuX19jbGFzc19fCiAgICBlbHNlOgogICAgICAgIHRleHQgPSBtZXNzYWdlCiAgICAgICAgbWVzc2FnZSA9IGNhdGVnb3J5KG1lc3NhZ2UpCiAgICBrZXkgPSAodGV4dCwgY2F0ZWdvcnksIGxpbmVubykKICAgICMgUXVpY2sgdGVzdCBmb3IgY29tbW9uIGNhc2UKICAgIGlmIHJlZ2lzdHJ5LmdldChrZXkpOgogICAgICAgIHJldHVybgogICAgIyBTZWFyY2ggdGhlIGZpbHRlcnMKICAgIGZvciBpdGVtIGluIGZpbHRlcnM6CiAgICAgICAgYWN0aW9uLCBtc2csIGNhdCwgbW9kLCBsbiA9IGl0ZW0KICAgICAgICBpZiAoKG1zZyBpcyBOb25lIG9yIG1zZy5tYXRjaCh0ZXh0KSkgYW5kCiAgICAgICAgICAgIGlzc3ViY2xhc3MoY2F0ZWdvcnksIGNhdCkgYW5kCiAgICAgICAgICAgIChtb2QgaXMgTm9uZSBvciBtb2QubWF0Y2gobW9kdWxlKSkgYW5kCiAgICAgICAgICAgIChsbiA9PSAwIG9yIGxpbmVubyA9PSBsbikpOgogICAgICAgICAgICBicmVhawogICAgZWxzZToKICAgICAgICBhY3Rpb24gPSBkZWZhdWx0YWN0aW9uCiAgICAjIEVhcmx5IGV4aXQgYWN0aW9ucwogICAgaWYgYWN0aW9uID09ICJpZ25vcmUiOgogICAgICAgIHJlZ2lzdHJ5W2tleV0gPSAxCiAgICAgICAgcmV0dXJuCgogICAgIyBQcmltZSB0aGUgbGluZWNhY2hlIGZvciBmb3JtYXR0aW5nLCBpbiBjYXNlIHRoZQogICAgIyAiZmlsZSIgaXMgYWN0dWFsbHkgaW4gYSB6aXBmaWxlIG9yIHNvbWV0aGluZy4KICAgIGxpbmVjYWNoZS5nZXRsaW5lcyhmaWxlbmFtZSwgbW9kdWxlX2dsb2JhbHMpCgogICAgaWYgYWN0aW9uID09ICJlcnJvciI6CiAgICAgICAgcmFpc2UgbWVzc2FnZQogICAgIyBPdGhlciBhY3Rpb25zCiAgICBpZiBhY3Rpb24gPT0gIm9uY2UiOgogICAgICAgIHJlZ2lzdHJ5W2tleV0gPSAxCiAgICAgICAgb25jZWtleSA9ICh0ZXh0LCBjYXRlZ29yeSkKICAgICAgICBpZiBvbmNlcmVnaXN0cnkuZ2V0KG9uY2VrZXkpOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBvbmNlcmVnaXN0cnlbb25jZWtleV0gPSAxCiAgICBlbGlmIGFjdGlvbiA9PSAiYWx3YXlzIjoKICAgICAgICBwYXNzCiAgICBlbGlmIGFjdGlvbiA9PSAibW9kdWxlIjoKICAgICAgICByZWdpc3RyeVtrZXldID0gMQogICAgICAgIGFsdGtleSA9ICh0ZXh0LCBjYXRlZ29yeSwgMCkKICAgICAgICBpZiByZWdpc3RyeS5nZXQoYWx0a2V5KToKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgcmVnaXN0cnlbYWx0a2V5XSA9IDEKICAgIGVsaWYgYWN0aW9uID09ICJkZWZhdWx0IjoKICAgICAgICByZWdpc3RyeVtrZXldID0gMQogICAgZWxzZToKICAgICAgICAjIFVucmVjb2duaXplZCBhY3Rpb25zIGFyZSBlcnJvcnMKICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoCiAgICAgICAgICAgICAgIlVucmVjb2duaXplZCBhY3Rpb24gKCVyKSBpbiB3YXJuaW5ncy5maWx0ZXJzOlxuICVzIiAlCiAgICAgICAgICAgICAgKGFjdGlvbiwgaXRlbSkpCiAgICBpZiBub3QgY2FsbGFibGUoc2hvd3dhcm5pbmcpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigid2FybmluZ3Muc2hvd3dhcm5pbmcoKSBtdXN0IGJlIHNldCB0byBhICIKICAgICAgICAgICAgICAgICAgICAgICAgImZ1bmN0aW9uIG9yIG1ldGhvZCIpCiAgICAjIFByaW50IG1lc3NhZ2UgYW5kIGNvbnRleHQKICAgIHNob3d3YXJuaW5nKG1lc3NhZ2UsIGNhdGVnb3J5LCBmaWxlbmFtZSwgbGluZW5vKQoKCmNsYXNzIFdhcm5pbmdNZXNzYWdlKG9iamVjdCk6CgogICAgIiIiSG9sZHMgdGhlIHJlc3VsdCBvZiBhIHNpbmdsZSBzaG93d2FybmluZygpIGNhbGwuIiIiCgogICAgX1dBUk5JTkdfREVUQUlMUyA9ICgibWVzc2FnZSIsICJjYXRlZ29yeSIsICJmaWxlbmFtZSIsICJsaW5lbm8iLCAiZmlsZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJsaW5lIikKCiAgICBkZWYgX19pbml0X18oc2VsZiwgbWVzc2FnZSwgY2F0ZWdvcnksIGZpbGVuYW1lLCBsaW5lbm8sIGZpbGU9Tm9uZSwKICAgICAgICAgICAgICAgICAgICBsaW5lPU5vbmUpOgogICAgICAgIGxvY2FsX3ZhbHVlcyA9IGxvY2FscygpCiAgICAgICAgZm9yIGF0dHIgaW4gc2VsZi5fV0FSTklOR19ERVRBSUxTOgogICAgICAgICAgICBzZXRhdHRyKHNlbGYsIGF0dHIsIGxvY2FsX3ZhbHVlc1thdHRyXSkKICAgICAgICBzZWxmLl9jYXRlZ29yeV9uYW1lID0gY2F0ZWdvcnkuX19uYW1lX18gaWYgY2F0ZWdvcnkgZWxzZSBOb25lCgogICAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgICAgcmV0dXJuICgie21lc3NhZ2UgOiAlciwgY2F0ZWdvcnkgOiAlciwgZmlsZW5hbWUgOiAlciwgbGluZW5vIDogJXMsICIKICAgICAgICAgICAgICAgICAgICAibGluZSA6ICVyfSIgJSAoc2VsZi5tZXNzYWdlLCBzZWxmLl9jYXRlZ29yeV9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmZpbGVuYW1lLCBzZWxmLmxpbmVubywgc2VsZi5saW5lKSkKCgpjbGFzcyBjYXRjaF93YXJuaW5ncyhvYmplY3QpOgoKICAgICIiIkEgY29udGV4dCBtYW5hZ2VyIHRoYXQgY29waWVzIGFuZCByZXN0b3JlcyB0aGUgd2FybmluZ3MgZmlsdGVyIHVwb24KICAgIGV4aXRpbmcgdGhlIGNvbnRleHQuCgogICAgVGhlICdyZWNvcmQnIGFyZ3VtZW50IHNwZWNpZmllcyB3aGV0aGVyIHdhcm5pbmdzIHNob3VsZCBiZSBjYXB0dXJlZCBieSBhCiAgICBjdXN0b20gaW1wbGVtZW50YXRpb24gb2Ygd2FybmluZ3Muc2hvd3dhcm5pbmcoKSBhbmQgYmUgYXBwZW5kZWQgdG8gYSBsaXN0CiAgICByZXR1cm5lZCBieSB0aGUgY29udGV4dCBtYW5hZ2VyLiBPdGhlcndpc2UgTm9uZSBpcyByZXR1cm5lZCBieSB0aGUgY29udGV4dAogICAgbWFuYWdlci4gVGhlIG9iamVjdHMgYXBwZW5kZWQgdG8gdGhlIGxpc3QgYXJlIGFyZ3VtZW50cyB3aG9zZSBhdHRyaWJ1dGVzCiAgICBtaXJyb3IgdGhlIGFyZ3VtZW50cyB0byBzaG93d2FybmluZygpLgoKICAgIFRoZSAnbW9kdWxlJyBhcmd1bWVudCBpcyB0byBzcGVjaWZ5IGFuIGFsdGVybmF0aXZlIG1vZHVsZSB0byB0aGUgbW9kdWxlCiAgICBuYW1lZCAnd2FybmluZ3MnIGFuZCBpbXBvcnRlZCB1bmRlciB0aGF0IG5hbWUuIFRoaXMgYXJndW1lbnQgaXMgb25seSB1c2VmdWwKICAgIHdoZW4gdGVzdGluZyB0aGUgd2FybmluZ3MgbW9kdWxlIGl0c2VsZi4KCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgKiwgcmVjb3JkPUZhbHNlLCBtb2R1bGU9Tm9uZSk6CiAgICAgICAgIiIiU3BlY2lmeSB3aGV0aGVyIHRvIHJlY29yZCB3YXJuaW5ncyBhbmQgaWYgYW4gYWx0ZXJuYXRpdmUgbW9kdWxlCiAgICAgICAgc2hvdWxkIGJlIHVzZWQgb3RoZXIgdGhhbiBzeXMubW9kdWxlc1snd2FybmluZ3MnXS4KCiAgICAgICAgRm9yIGNvbXBhdGliaWxpdHkgd2l0aCBQeXRob24gMy4wLCBwbGVhc2UgY29uc2lkZXIgYWxsIGFyZ3VtZW50cyB0byBiZQogICAgICAgIGtleXdvcmQtb25seS4KCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fcmVjb3JkID0gcmVjb3JkCiAgICAgICAgc2VsZi5fbW9kdWxlID0gc3lzLm1vZHVsZXNbJ3dhcm5pbmdzJ10gaWYgbW9kdWxlIGlzIE5vbmUgZWxzZSBtb2R1bGUKICAgICAgICBzZWxmLl9lbnRlcmVkID0gRmFsc2UKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgYXJncyA9IFtdCiAgICAgICAgaWYgc2VsZi5fcmVjb3JkOgogICAgICAgICAgICBhcmdzLmFwcGVuZCgicmVjb3JkPVRydWUiKQogICAgICAgIGlmIHNlbGYuX21vZHVsZSBpcyBub3Qgc3lzLm1vZHVsZXNbJ3dhcm5pbmdzJ106CiAgICAgICAgICAgIGFyZ3MuYXBwZW5kKCJtb2R1bGU9JXIiICUgc2VsZi5fbW9kdWxlKQogICAgICAgIG5hbWUgPSB0eXBlKHNlbGYpLl9fbmFtZV9fCiAgICAgICAgcmV0dXJuICIlcyglcykiICUgKG5hbWUsICIsICIuam9pbihhcmdzKSkKCiAgICBkZWYgX19lbnRlcl9fKHNlbGYpOgogICAgICAgIGlmIHNlbGYuX2VudGVyZWQ6CiAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigiQ2Fubm90IGVudGVyICVyIHR3aWNlIiAlIHNlbGYpCiAgICAgICAgc2VsZi5fZW50ZXJlZCA9IFRydWUKICAgICAgICBzZWxmLl9maWx0ZXJzID0gc2VsZi5fbW9kdWxlLmZpbHRlcnMKICAgICAgICBzZWxmLl9tb2R1bGUuZmlsdGVycyA9IHNlbGYuX2ZpbHRlcnNbOl0KICAgICAgICBzZWxmLl9zaG93d2FybmluZyA9IHNlbGYuX21vZHVsZS5zaG93d2FybmluZwogICAgICAgIGlmIHNlbGYuX3JlY29yZDoKICAgICAgICAgICAgbG9nID0gW10KICAgICAgICAgICAgZGVmIHNob3d3YXJuaW5nKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgICAgICBsb2cuYXBwZW5kKFdhcm5pbmdNZXNzYWdlKCphcmdzLCAqKmt3YXJncykpCiAgICAgICAgICAgIHNlbGYuX21vZHVsZS5zaG93d2FybmluZyA9IHNob3d3YXJuaW5nCiAgICAgICAgICAgIHJldHVybiBsb2cKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBfX2V4aXRfXyhzZWxmLCAqZXhjX2luZm8pOgogICAgICAgIGlmIG5vdCBzZWxmLl9lbnRlcmVkOgogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoIkNhbm5vdCBleGl0ICVyIHdpdGhvdXQgZW50ZXJpbmcgZmlyc3QiICUgc2VsZikKICAgICAgICBzZWxmLl9tb2R1bGUuZmlsdGVycyA9IHNlbGYuX2ZpbHRlcnMKICAgICAgICBzZWxmLl9tb2R1bGUuc2hvd3dhcm5pbmcgPSBzZWxmLl9zaG93d2FybmluZwoKCiMgZmlsdGVycyBjb250YWlucyBhIHNlcXVlbmNlIG9mIGZpbHRlciA1LXR1cGxlcwojIFRoZSBjb21wb25lbnRzIG9mIHRoZSA1LXR1cGxlIGFyZToKIyAtIGFuIGFjdGlvbjogZXJyb3IsIGlnbm9yZSwgYWx3YXlzLCBkZWZhdWx0LCBtb2R1bGUsIG9yIG9uY2UKIyAtIGEgY29tcGlsZWQgcmVnZXggdGhhdCBtdXN0IG1hdGNoIHRoZSB3YXJuaW5nIG1lc3NhZ2UKIyAtIGEgY2xhc3MgcmVwcmVzZW50aW5nIHRoZSB3YXJuaW5nIGNhdGVnb3J5CiMgLSBhIGNvbXBpbGVkIHJlZ2V4IHRoYXQgbXVzdCBtYXRjaCB0aGUgbW9kdWxlIHRoYXQgaXMgYmVpbmcgd2FybmVkCiMgLSBhIGxpbmUgbnVtYmVyIGZvciB0aGUgbGluZSBiZWluZyB3YXJuaW5nLCBvciAwIHRvIG1lYW4gYW55IGxpbmUKIyBJZiBlaXRoZXIgaWYgdGhlIGNvbXBpbGVkIHJlZ2V4cyBhcmUgTm9uZSwgbWF0Y2ggYW55dGhpbmcuCl93YXJuaW5nc19kZWZhdWx0cyA9IEZhbHNlCnRyeToKICAgIGZyb20gX3dhcm5pbmdzIGltcG9ydCAoZmlsdGVycywgX2RlZmF1bHRhY3Rpb24sIF9vbmNlcmVnaXN0cnksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXJuLCB3YXJuX2V4cGxpY2l0KQogICAgZGVmYXVsdGFjdGlvbiA9IF9kZWZhdWx0YWN0aW9uCiAgICBvbmNlcmVnaXN0cnkgPSBfb25jZXJlZ2lzdHJ5CiAgICBfd2FybmluZ3NfZGVmYXVsdHMgPSBUcnVlCmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIGZpbHRlcnMgPSBbXQogICAgZGVmYXVsdGFjdGlvbiA9ICJkZWZhdWx0IgogICAgb25jZXJlZ2lzdHJ5ID0ge30KCgojIE1vZHVsZSBpbml0aWFsaXphdGlvbgpfcHJvY2Vzc29wdGlvbnMoc3lzLndhcm5vcHRpb25zKQppZiBub3QgX3dhcm5pbmdzX2RlZmF1bHRzOgogICAgc2lsZW5jZSA9IFtJbXBvcnRXYXJuaW5nLCBQZW5kaW5nRGVwcmVjYXRpb25XYXJuaW5nXQogICAgc2lsZW5jZS5hcHBlbmQoRGVwcmVjYXRpb25XYXJuaW5nKQogICAgZm9yIGNscyBpbiBzaWxlbmNlOgogICAgICAgIHNpbXBsZWZpbHRlcigiaWdub3JlIiwgY2F0ZWdvcnk9Y2xzKQogICAgYnl0ZXNfd2FybmluZyA9IHN5cy5mbGFncy5ieXRlc193YXJuaW5nCiAgICBpZiBieXRlc193YXJuaW5nID4gMToKICAgICAgICBieXRlc19hY3Rpb24gPSAiZXJyb3IiCiAgICBlbGlmIGJ5dGVzX3dhcm5pbmc6CiAgICAgICAgYnl0ZXNfYWN0aW9uID0gImRlZmF1bHQiCiAgICBlbHNlOgogICAgICAgIGJ5dGVzX2FjdGlvbiA9ICJpZ25vcmUiCiAgICBzaW1wbGVmaWx0ZXIoYnl0ZXNfYWN0aW9uLCBjYXRlZ29yeT1CeXRlc1dhcm5pbmcsIGFwcGVuZD0xKQogICAgIyByZXNvdXJjZSB1c2FnZSB3YXJuaW5ncyBhcmUgZW5hYmxlZCBieSBkZWZhdWx0IGluIHB5ZGVidWcgbW9kZQogICAgaWYgaGFzYXR0cihzeXMsICdnZXR0b3RhbHJlZmNvdW50Jyk6CiAgICAgICAgcmVzb3VyY2VfYWN0aW9uID0gImFsd2F5cyIKICAgIGVsc2U6CiAgICAgICAgcmVzb3VyY2VfYWN0aW9uID0gImlnbm9yZSIKICAgIHNpbXBsZWZpbHRlcihyZXNvdXJjZV9hY3Rpb24sIGNhdGVnb3J5PVJlc291cmNlV2FybmluZywgYXBwZW5kPTEpCgpkZWwgX3dhcm5pbmdzX2RlZmF1bHRzCg==',
'/Lib/weakref.py':'IiIiV2VhayByZWZlcmVuY2Ugc3VwcG9ydCBmb3IgUHl0aG9uLgoKVGhpcyBtb2R1bGUgaXMgYW4gaW1wbGVtZW50YXRpb24gb2YgUEVQIDIwNToKCmh0dHA6Ly93d3cucHl0aG9uLm9yZy9kZXYvcGVwcy9wZXAtMDIwNS8KIiIiCgojIE5hbWluZyBjb252ZW50aW9uOiBWYXJpYWJsZXMgbmFtZWQgIndyIiBhcmUgd2VhayByZWZlcmVuY2Ugb2JqZWN0czsKIyB0aGV5IGFyZSBjYWxsZWQgdGhpcyBpbnN0ZWFkIG9mICJyZWYiIHRvIGF2b2lkIG5hbWUgY29sbGlzaW9ucyB3aXRoCiMgdGhlIG1vZHVsZS1nbG9iYWwgcmVmKCkgZnVuY3Rpb24gaW1wb3J0ZWQgZnJvbSBfd2Vha3JlZi4KCmZyb20gX3dlYWtyZWYgaW1wb3J0ICgKICAgICBnZXR3ZWFrcmVmY291bnQsCiAgICAgZ2V0d2Vha3JlZnMsCiAgICAgcmVmLAogICAgIHByb3h5LAogICAgIENhbGxhYmxlUHJveHlUeXBlLAogICAgIFByb3h5VHlwZSwKICAgICBSZWZlcmVuY2VUeXBlKQoKZnJvbSBfd2Vha3JlZnNldCBpbXBvcnQgV2Vha1NldCwgX0l0ZXJhdGlvbkd1YXJkCgppbXBvcnQgY29sbGVjdGlvbnMgICMgSW1wb3J0IGFmdGVyIF93ZWFrcmVmIHRvIGF2b2lkIGNpcmN1bGFyIGltcG9ydC4KClByb3h5VHlwZXMgPSAoUHJveHlUeXBlLCBDYWxsYWJsZVByb3h5VHlwZSkKCl9fYWxsX18gPSBbInJlZiIsICJwcm94eSIsICJnZXR3ZWFrcmVmY291bnQiLCAiZ2V0d2Vha3JlZnMiLAogICAgICAgICAgICJXZWFrS2V5RGljdGlvbmFyeSIsICJSZWZlcmVuY2VUeXBlIiwgIlByb3h5VHlwZSIsCiAgICAgICAgICAgIkNhbGxhYmxlUHJveHlUeXBlIiwgIlByb3h5VHlwZXMiLCAiV2Vha1ZhbHVlRGljdGlvbmFyeSIsCiAgICAgICAgICAgIldlYWtTZXQiXQoKCmNsYXNzIFdlYWtWYWx1ZURpY3Rpb25hcnkoY29sbGVjdGlvbnMuTXV0YWJsZU1hcHBpbmcpOgogICAgIiIiTWFwcGluZyBjbGFzcyB0aGF0IHJlZmVyZW5jZXMgdmFsdWVzIHdlYWtseS4KCiAgICBFbnRyaWVzIGluIHRoZSBkaWN0aW9uYXJ5IHdpbGwgYmUgZGlzY2FyZGVkIHdoZW4gbm8gc3Ryb25nCiAgICByZWZlcmVuY2UgdG8gdGhlIHZhbHVlIGV4aXN0cyBhbnltb3JlCiAgICAiIiIKICAgICMgV2UgaW5oZXJpdCB0aGUgY29uc3RydWN0b3Igd2l0aG91dCB3b3JyeWluZyBhYm91dCB0aGUgaW5wdXQKICAgICMgZGljdGlvbmFyeTsgc2luY2UgaXQgdXNlcyBvdXIgLnVwZGF0ZSgpIG1ldGhvZCwgd2UgZ2V0IHRoZSByaWdodAogICAgIyBjaGVja3MgKGlmIHRoZSBvdGhlciBkaWN0aW9uYXJ5IGlzIGEgV2Vha1ZhbHVlRGljdGlvbmFyeSwKICAgICMgb2JqZWN0cyBhcmUgdW53cmFwcGVkIG9uIHRoZSB3YXkgb3V0LCBhbmQgd2UgYWx3YXlzIHdyYXAgb24gdGhlCiAgICAjIHdheSBpbikuCgogICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3KToKICAgICAgICBkZWYgcmVtb3ZlKHdyLCBzZWxmcmVmPXJlZihzZWxmKSk6CiAgICAgICAgICAgIHNlbGYgPSBzZWxmcmVmKCkKICAgICAgICAgICAgaWYgc2VsZiBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIGlmIHNlbGYuX2l0ZXJhdGluZzoKICAgICAgICAgICAgICAgICAgICBzZWxmLl9wZW5kaW5nX3JlbW92YWxzLmFwcGVuZCh3ci5rZXkpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGRlbCBzZWxmLmRhdGFbd3Iua2V5XQogICAgICAgIHNlbGYuX3JlbW92ZSA9IHJlbW92ZQogICAgICAgICMgQSBsaXN0IG9mIGtleXMgdG8gYmUgcmVtb3ZlZAogICAgICAgIHNlbGYuX3BlbmRpbmdfcmVtb3ZhbHMgPSBbXQogICAgICAgIHNlbGYuX2l0ZXJhdGluZyA9IHNldCgpCiAgICAgICAgc2VsZi5kYXRhID0gZCA9IHt9CiAgICAgICAgc2VsZi51cGRhdGUoKmFyZ3MsICoqa3cpCgogICAgZGVmIF9jb21taXRfcmVtb3ZhbHMoc2VsZik6CiAgICAgICAgbCA9IHNlbGYuX3BlbmRpbmdfcmVtb3ZhbHMKICAgICAgICBkID0gc2VsZi5kYXRhCiAgICAgICAgIyBXZSBzaG91bGRuJ3QgZW5jb3VudGVyIGFueSBLZXlFcnJvciwgYmVjYXVzZSB0aGlzIG1ldGhvZCBzaG91bGQKICAgICAgICAjIGFsd2F5cyBiZSBjYWxsZWQgKmJlZm9yZSogbXV0YXRpbmcgdGhlIGRpY3QuCiAgICAgICAgd2hpbGUgbDoKICAgICAgICAgICAgZGVsIGRbbC5wb3AoKV0KCiAgICBkZWYgX19nZXRpdGVtX18oc2VsZiwga2V5KToKICAgICAgICBvID0gc2VsZi5kYXRhW2tleV0oKQogICAgICAgIGlmIG8gaXMgTm9uZToKICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3Ioa2V5KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBvCgogICAgZGVmIF9fZGVsaXRlbV9fKHNlbGYsIGtleSk6CiAgICAgICAgaWYgc2VsZi5fcGVuZGluZ19yZW1vdmFsczoKICAgICAgICAgICAgc2VsZi5fY29tbWl0X3JlbW92YWxzKCkKICAgICAgICBkZWwgc2VsZi5kYXRhW2tleV0KCiAgICBkZWYgX19sZW5fXyhzZWxmKToKICAgICAgICByZXR1cm4gbGVuKHNlbGYuZGF0YSkgLSBsZW4oc2VsZi5fcGVuZGluZ19yZW1vdmFscykKCiAgICBkZWYgX19jb250YWluc19fKHNlbGYsIGtleSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBvID0gc2VsZi5kYXRhW2tleV0oKQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgcmV0dXJuIG8gaXMgbm90IE5vbmUKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICI8V2Vha1ZhbHVlRGljdGlvbmFyeSBhdCAlcz4iICUgaWQoc2VsZikKCiAgICBkZWYgX19zZXRpdGVtX18oc2VsZiwga2V5LCB2YWx1ZSk6CiAgICAgICAgaWYgc2VsZi5fcGVuZGluZ19yZW1vdmFsczoKICAgICAgICAgICAgc2VsZi5fY29tbWl0X3JlbW92YWxzKCkKICAgICAgICBzZWxmLmRhdGFba2V5XSA9IEtleWVkUmVmKHZhbHVlLCBzZWxmLl9yZW1vdmUsIGtleSkKCiAgICBkZWYgY29weShzZWxmKToKICAgICAgICBuZXcgPSBXZWFrVmFsdWVEaWN0aW9uYXJ5KCkKICAgICAgICBmb3Iga2V5LCB3ciBpbiBzZWxmLmRhdGEuaXRlbXMoKToKICAgICAgICAgICAgbyA9IHdyKCkKICAgICAgICAgICAgaWYgbyBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIG5ld1trZXldID0gbwogICAgICAgIHJldHVybiBuZXcKCiAgICBfX2NvcHlfXyA9IGNvcHkKCiAgICBkZWYgX19kZWVwY29weV9fKHNlbGYsIG1lbW8pOgogICAgICAgIGZyb20gY29weSBpbXBvcnQgZGVlcGNvcHkKICAgICAgICBuZXcgPSBzZWxmLl9fY2xhc3NfXygpCiAgICAgICAgZm9yIGtleSwgd3IgaW4gc2VsZi5kYXRhLml0ZW1zKCk6CiAgICAgICAgICAgIG8gPSB3cigpCiAgICAgICAgICAgIGlmIG8gaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBuZXdbZGVlcGNvcHkoa2V5LCBtZW1vKV0gPSBvCiAgICAgICAgcmV0dXJuIG5ldwoKICAgIGRlZiBnZXQoc2VsZiwga2V5LCBkZWZhdWx0PU5vbmUpOgogICAgICAgIHRyeToKICAgICAgICAgICAgd3IgPSBzZWxmLmRhdGFba2V5XQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHQKICAgICAgICBlbHNlOgogICAgICAgICAgICBvID0gd3IoKQogICAgICAgICAgICBpZiBvIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAjIFRoaXMgc2hvdWxkIG9ubHkgaGFwcGVuCiAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmV0dXJuIG8KCiAgICBkZWYgaXRlbXMoc2VsZik6CiAgICAgICAgd2l0aCBfSXRlcmF0aW9uR3VhcmQoc2VsZik6CiAgICAgICAgICAgIGZvciBrLCB3ciBpbiBzZWxmLmRhdGEuaXRlbXMoKToKICAgICAgICAgICAgICAgIHYgPSB3cigpCiAgICAgICAgICAgICAgICBpZiB2IGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIHlpZWxkIGssIHYKCiAgICBkZWYga2V5cyhzZWxmKToKICAgICAgICB3aXRoIF9JdGVyYXRpb25HdWFyZChzZWxmKToKICAgICAgICAgICAgZm9yIGssIHdyIGluIHNlbGYuZGF0YS5pdGVtcygpOgogICAgICAgICAgICAgICAgaWYgd3IoKSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICB5aWVsZCBrCgogICAgX19pdGVyX18gPSBrZXlzCgogICAgZGVmIGl0ZXJ2YWx1ZXJlZnMoc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIGFuIGl0ZXJhdG9yIHRoYXQgeWllbGRzIHRoZSB3ZWFrIHJlZmVyZW5jZXMgdG8gdGhlIHZhbHVlcy4KCiAgICAgICAgVGhlIHJlZmVyZW5jZXMgYXJlIG5vdCBndWFyYW50ZWVkIHRvIGJlICdsaXZlJyBhdCB0aGUgdGltZQogICAgICAgIHRoZXkgYXJlIHVzZWQsIHNvIHRoZSByZXN1bHQgb2YgY2FsbGluZyB0aGUgcmVmZXJlbmNlcyBuZWVkcwogICAgICAgIHRvIGJlIGNoZWNrZWQgYmVmb3JlIGJlaW5nIHVzZWQuICBUaGlzIGNhbiBiZSB1c2VkIHRvIGF2b2lkCiAgICAgICAgY3JlYXRpbmcgcmVmZXJlbmNlcyB0aGF0IHdpbGwgY2F1c2UgdGhlIGdhcmJhZ2UgY29sbGVjdG9yIHRvCiAgICAgICAga2VlcCB0aGUgdmFsdWVzIGFyb3VuZCBsb25nZXIgdGhhbiBuZWVkZWQuCgogICAgICAgICIiIgogICAgICAgIHdpdGggX0l0ZXJhdGlvbkd1YXJkKHNlbGYpOgogICAgICAgICAgICBmb3Igd3IgaW4gc2VsZi5kYXRhLnZhbHVlcygpOgogICAgICAgICAgICAgICAgeWllbGQgd3IKCiAgICBkZWYgdmFsdWVzKHNlbGYpOgogICAgICAgIHdpdGggX0l0ZXJhdGlvbkd1YXJkKHNlbGYpOgogICAgICAgICAgICBmb3Igd3IgaW4gc2VsZi5kYXRhLnZhbHVlcygpOgogICAgICAgICAgICAgICAgb2JqID0gd3IoKQogICAgICAgICAgICAgICAgaWYgb2JqIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIHlpZWxkIG9iagoKICAgIGRlZiBwb3BpdGVtKHNlbGYpOgogICAgICAgIGlmIHNlbGYuX3BlbmRpbmdfcmVtb3ZhbHM6CiAgICAgICAgICAgIHNlbGYuX2NvbW1pdF9yZW1vdmFscygpCiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAga2V5LCB3ciA9IHNlbGYuZGF0YS5wb3BpdGVtKCkKICAgICAgICAgICAgbyA9IHdyKCkKICAgICAgICAgICAgaWYgbyBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHJldHVybiBrZXksIG8KCiAgICBkZWYgcG9wKHNlbGYsIGtleSwgKmFyZ3MpOgogICAgICAgIGlmIHNlbGYuX3BlbmRpbmdfcmVtb3ZhbHM6CiAgICAgICAgICAgIHNlbGYuX2NvbW1pdF9yZW1vdmFscygpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBvID0gc2VsZi5kYXRhLnBvcChrZXkpKCkKICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIGlmIGFyZ3M6CiAgICAgICAgICAgICAgICByZXR1cm4gYXJnc1swXQogICAgICAgICAgICByYWlzZQogICAgICAgIGlmIG8gaXMgTm9uZToKICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3Ioa2V5KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBvCgogICAgZGVmIHNldGRlZmF1bHQoc2VsZiwga2V5LCBkZWZhdWx0PU5vbmUpOgogICAgICAgIHRyeToKICAgICAgICAgICAgd3IgPSBzZWxmLmRhdGFba2V5XQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgaWYgc2VsZi5fcGVuZGluZ19yZW1vdmFsczoKICAgICAgICAgICAgICAgIHNlbGYuX2NvbW1pdF9yZW1vdmFscygpCiAgICAgICAgICAgIHNlbGYuZGF0YVtrZXldID0gS2V5ZWRSZWYoZGVmYXVsdCwgc2VsZi5fcmVtb3ZlLCBrZXkpCiAgICAgICAgICAgIHJldHVybiBkZWZhdWx0CiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHdyKCkKCiAgICBkZWYgdXBkYXRlKHNlbGYsIGRpY3Q9Tm9uZSwgKiprd2FyZ3MpOgogICAgICAgIGlmIHNlbGYuX3BlbmRpbmdfcmVtb3ZhbHM6CiAgICAgICAgICAgIHNlbGYuX2NvbW1pdF9yZW1vdmFscygpCiAgICAgICAgZCA9IHNlbGYuZGF0YQogICAgICAgIGlmIGRpY3QgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGlmIG5vdCBoYXNhdHRyKGRpY3QsICJpdGVtcyIpOgogICAgICAgICAgICAgICAgZGljdCA9IHR5cGUoe30pKGRpY3QpCiAgICAgICAgICAgIGZvciBrZXksIG8gaW4gZGljdC5pdGVtcygpOgogICAgICAgICAgICAgICAgZFtrZXldID0gS2V5ZWRSZWYobywgc2VsZi5fcmVtb3ZlLCBrZXkpCiAgICAgICAgaWYgbGVuKGt3YXJncyk6CiAgICAgICAgICAgIHNlbGYudXBkYXRlKGt3YXJncykKCiAgICBkZWYgdmFsdWVyZWZzKHNlbGYpOgogICAgICAgICIiIlJldHVybiBhIGxpc3Qgb2Ygd2VhayByZWZlcmVuY2VzIHRvIHRoZSB2YWx1ZXMuCgogICAgICAgIFRoZSByZWZlcmVuY2VzIGFyZSBub3QgZ3VhcmFudGVlZCB0byBiZSAnbGl2ZScgYXQgdGhlIHRpbWUKICAgICAgICB0aGV5IGFyZSB1c2VkLCBzbyB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgdGhlIHJlZmVyZW5jZXMgbmVlZHMKICAgICAgICB0byBiZSBjaGVja2VkIGJlZm9yZSBiZWluZyB1c2VkLiAgVGhpcyBjYW4gYmUgdXNlZCB0byBhdm9pZAogICAgICAgIGNyZWF0aW5nIHJlZmVyZW5jZXMgdGhhdCB3aWxsIGNhdXNlIHRoZSBnYXJiYWdlIGNvbGxlY3RvciB0bwogICAgICAgIGtlZXAgdGhlIHZhbHVlcyBhcm91bmQgbG9uZ2VyIHRoYW4gbmVlZGVkLgoKICAgICAgICAiIiIKICAgICAgICByZXR1cm4gbGlzdChzZWxmLmRhdGEudmFsdWVzKCkpCgoKY2xhc3MgS2V5ZWRSZWYocmVmKToKICAgICIiIlNwZWNpYWxpemVkIHJlZmVyZW5jZSB0aGF0IGluY2x1ZGVzIGEga2V5IGNvcnJlc3BvbmRpbmcgdG8gdGhlIHZhbHVlLgoKICAgIFRoaXMgaXMgdXNlZCBpbiB0aGUgV2Vha1ZhbHVlRGljdGlvbmFyeSB0byBhdm9pZCBoYXZpbmcgdG8gY3JlYXRlCiAgICBhIGZ1bmN0aW9uIG9iamVjdCBmb3IgZWFjaCBrZXkgc3RvcmVkIGluIHRoZSBtYXBwaW5nLiAgQSBzaGFyZWQKICAgIGNhbGxiYWNrIG9iamVjdCBjYW4gdXNlIHRoZSAna2V5JyBhdHRyaWJ1dGUgb2YgYSBLZXllZFJlZiBpbnN0ZWFkCiAgICBvZiBnZXR0aW5nIGEgcmVmZXJlbmNlIHRvIHRoZSBrZXkgZnJvbSBhbiBlbmNsb3Npbmcgc2NvcGUuCgogICAgIiIiCgogICAgX19zbG90c19fID0gImtleSIsCgogICAgZGVmIF9fbmV3X18odHlwZSwgb2IsIGNhbGxiYWNrLCBrZXkpOgogICAgICAgIHNlbGYgPSByZWYuX19uZXdfXyh0eXBlLCBvYiwgY2FsbGJhY2spCiAgICAgICAgc2VsZi5rZXkgPSBrZXkKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBvYiwgY2FsbGJhY2ssIGtleSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhvYiwgY2FsbGJhY2spCgoKY2xhc3MgV2Vha0tleURpY3Rpb25hcnkoY29sbGVjdGlvbnMuTXV0YWJsZU1hcHBpbmcpOgogICAgIiIiIE1hcHBpbmcgY2xhc3MgdGhhdCByZWZlcmVuY2VzIGtleXMgd2Vha2x5LgoKICAgIEVudHJpZXMgaW4gdGhlIGRpY3Rpb25hcnkgd2lsbCBiZSBkaXNjYXJkZWQgd2hlbiB0aGVyZSBpcyBubwogICAgbG9uZ2VyIGEgc3Ryb25nIHJlZmVyZW5jZSB0byB0aGUga2V5LiBUaGlzIGNhbiBiZSB1c2VkIHRvCiAgICBhc3NvY2lhdGUgYWRkaXRpb25hbCBkYXRhIHdpdGggYW4gb2JqZWN0IG93bmVkIGJ5IG90aGVyIHBhcnRzIG9mCiAgICBhbiBhcHBsaWNhdGlvbiB3aXRob3V0IGFkZGluZyBhdHRyaWJ1dGVzIHRvIHRob3NlIG9iamVjdHMuIFRoaXMKICAgIGNhbiBiZSBlc3BlY2lhbGx5IHVzZWZ1bCB3aXRoIG9iamVjdHMgdGhhdCBvdmVycmlkZSBhdHRyaWJ1dGUKICAgIGFjY2Vzc2VzLgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGRpY3Q9Tm9uZSk6CiAgICAgICAgc2VsZi5kYXRhID0ge30KICAgICAgICBkZWYgcmVtb3ZlKGssIHNlbGZyZWY9cmVmKHNlbGYpKToKICAgICAgICAgICAgc2VsZiA9IHNlbGZyZWYoKQogICAgICAgICAgICBpZiBzZWxmIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgaWYgc2VsZi5faXRlcmF0aW5nOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX3BlbmRpbmdfcmVtb3ZhbHMuYXBwZW5kKGspCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGRlbCBzZWxmLmRhdGFba10KICAgICAgICBzZWxmLl9yZW1vdmUgPSByZW1vdmUKICAgICAgICAjIEEgbGlzdCBvZiBkZWFkIHdlYWtyZWZzIChrZXlzIHRvIGJlIHJlbW92ZWQpCiAgICAgICAgc2VsZi5fcGVuZGluZ19yZW1vdmFscyA9IFtdCiAgICAgICAgc2VsZi5faXRlcmF0aW5nID0gc2V0KCkKICAgICAgICBpZiBkaWN0IGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLnVwZGF0ZShkaWN0KQoKICAgIGRlZiBfY29tbWl0X3JlbW92YWxzKHNlbGYpOgogICAgICAgICMgTk9URTogV2UgZG9uJ3QgbmVlZCB0byBjYWxsIHRoaXMgbWV0aG9kIGJlZm9yZSBtdXRhdGluZyB0aGUgZGljdCwKICAgICAgICAjIGJlY2F1c2UgYSBkZWFkIHdlYWtyZWYgbmV2ZXIgY29tcGFyZXMgZXF1YWwgdG8gYSBsaXZlIHdlYWtyZWYsCiAgICAgICAgIyBldmVuIGlmIHRoZXkgaGFwcGVuZWQgdG8gcmVmZXIgdG8gZXF1YWwgb2JqZWN0cy4KICAgICAgICAjIEhvd2V2ZXIsIGl0IG1lYW5zIGtleXMgbWF5IGFscmVhZHkgaGF2ZSBiZWVuIHJlbW92ZWQuCiAgICAgICAgbCA9IHNlbGYuX3BlbmRpbmdfcmVtb3ZhbHMKICAgICAgICBkID0gc2VsZi5kYXRhCiAgICAgICAgd2hpbGUgbDoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZGVsIGRbbC5wb3AoKV0KICAgICAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICAgICAgcGFzcwoKICAgIGRlZiBfX2RlbGl0ZW1fXyhzZWxmLCBrZXkpOgogICAgICAgIGRlbCBzZWxmLmRhdGFbcmVmKGtleSldCgogICAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGtleSk6CiAgICAgICAgcmV0dXJuIHNlbGYuZGF0YVtyZWYoa2V5KV0KCiAgICBkZWYgX19sZW5fXyhzZWxmKToKICAgICAgICByZXR1cm4gbGVuKHNlbGYuZGF0YSkgLSBsZW4oc2VsZi5fcGVuZGluZ19yZW1vdmFscykKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICI8V2Vha0tleURpY3Rpb25hcnkgYXQgJXM+IiAlIGlkKHNlbGYpCgogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIGtleSwgdmFsdWUpOgogICAgICAgIHNlbGYuZGF0YVtyZWYoa2V5LCBzZWxmLl9yZW1vdmUpXSA9IHZhbHVlCgogICAgZGVmIGNvcHkoc2VsZik6CiAgICAgICAgbmV3ID0gV2Vha0tleURpY3Rpb25hcnkoKQogICAgICAgIGZvciBrZXksIHZhbHVlIGluIHNlbGYuZGF0YS5pdGVtcygpOgogICAgICAgICAgICBvID0ga2V5KCkKICAgICAgICAgICAgaWYgbyBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIG5ld1tvXSA9IHZhbHVlCiAgICAgICAgcmV0dXJuIG5ldwoKICAgIF9fY29weV9fID0gY29weQoKICAgIGRlZiBfX2RlZXBjb3B5X18oc2VsZiwgbWVtbyk6CiAgICAgICAgZnJvbSBjb3B5IGltcG9ydCBkZWVwY29weQogICAgICAgIG5ldyA9IHNlbGYuX19jbGFzc19fKCkKICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBzZWxmLmRhdGEuaXRlbXMoKToKICAgICAgICAgICAgbyA9IGtleSgpCiAgICAgICAgICAgIGlmIG8gaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBuZXdbb10gPSBkZWVwY29weSh2YWx1ZSwgbWVtbykKICAgICAgICByZXR1cm4gbmV3CgogICAgZGVmIGdldChzZWxmLCBrZXksIGRlZmF1bHQ9Tm9uZSk6CiAgICAgICAgcmV0dXJuIHNlbGYuZGF0YS5nZXQocmVmKGtleSksZGVmYXVsdCkKCiAgICBkZWYgX19jb250YWluc19fKHNlbGYsIGtleSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB3ciA9IHJlZihrZXkpCiAgICAgICAgZXhjZXB0IFR5cGVFcnJvcjoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgcmV0dXJuIHdyIGluIHNlbGYuZGF0YQoKICAgIGRlZiBpdGVtcyhzZWxmKToKICAgICAgICB3aXRoIF9JdGVyYXRpb25HdWFyZChzZWxmKToKICAgICAgICAgICAgZm9yIHdyLCB2YWx1ZSBpbiBzZWxmLmRhdGEuaXRlbXMoKToKICAgICAgICAgICAgICAgIGtleSA9IHdyKCkKICAgICAgICAgICAgICAgIGlmIGtleSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICB5aWVsZCBrZXksIHZhbHVlCgogICAgZGVmIGtleXMoc2VsZik6CiAgICAgICAgd2l0aCBfSXRlcmF0aW9uR3VhcmQoc2VsZik6CiAgICAgICAgICAgIGZvciB3ciBpbiBzZWxmLmRhdGE6CiAgICAgICAgICAgICAgICBvYmogPSB3cigpCiAgICAgICAgICAgICAgICBpZiBvYmogaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgeWllbGQgb2JqCgogICAgX19pdGVyX18gPSBrZXlzCgogICAgZGVmIHZhbHVlcyhzZWxmKToKICAgICAgICB3aXRoIF9JdGVyYXRpb25HdWFyZChzZWxmKToKICAgICAgICAgICAgZm9yIHdyLCB2YWx1ZSBpbiBzZWxmLmRhdGEuaXRlbXMoKToKICAgICAgICAgICAgICAgIGlmIHdyKCkgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgeWllbGQgdmFsdWUKCiAgICBkZWYga2V5cmVmcyhzZWxmKToKICAgICAgICAiIiJSZXR1cm4gYSBsaXN0IG9mIHdlYWsgcmVmZXJlbmNlcyB0byB0aGUga2V5cy4KCiAgICAgICAgVGhlIHJlZmVyZW5jZXMgYXJlIG5vdCBndWFyYW50ZWVkIHRvIGJlICdsaXZlJyBhdCB0aGUgdGltZQogICAgICAgIHRoZXkgYXJlIHVzZWQsIHNvIHRoZSByZXN1bHQgb2YgY2FsbGluZyB0aGUgcmVmZXJlbmNlcyBuZWVkcwogICAgICAgIHRvIGJlIGNoZWNrZWQgYmVmb3JlIGJlaW5nIHVzZWQuICBUaGlzIGNhbiBiZSB1c2VkIHRvIGF2b2lkCiAgICAgICAgY3JlYXRpbmcgcmVmZXJlbmNlcyB0aGF0IHdpbGwgY2F1c2UgdGhlIGdhcmJhZ2UgY29sbGVjdG9yIHRvCiAgICAgICAga2VlcCB0aGUga2V5cyBhcm91bmQgbG9uZ2VyIHRoYW4gbmVlZGVkLgoKICAgICAgICAiIiIKICAgICAgICByZXR1cm4gbGlzdChzZWxmLmRhdGEpCgogICAgZGVmIHBvcGl0ZW0oc2VsZik6CiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAga2V5LCB2YWx1ZSA9IHNlbGYuZGF0YS5wb3BpdGVtKCkKICAgICAgICAgICAgbyA9IGtleSgpCiAgICAgICAgICAgIGlmIG8gaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICByZXR1cm4gbywgdmFsdWUKCiAgICBkZWYgcG9wKHNlbGYsIGtleSwgKmFyZ3MpOgogICAgICAgIHJldHVybiBzZWxmLmRhdGEucG9wKHJlZihrZXkpLCAqYXJncykKCiAgICBkZWYgc2V0ZGVmYXVsdChzZWxmLCBrZXksIGRlZmF1bHQ9Tm9uZSk6CiAgICAgICAgcmV0dXJuIHNlbGYuZGF0YS5zZXRkZWZhdWx0KHJlZihrZXksIHNlbGYuX3JlbW92ZSksZGVmYXVsdCkKCiAgICBkZWYgdXBkYXRlKHNlbGYsIGRpY3Q9Tm9uZSwgKiprd2FyZ3MpOgogICAgICAgIGQgPSBzZWxmLmRhdGEKICAgICAgICBpZiBkaWN0IGlzIG5vdCBOb25lOgogICAgICAgICAgICBpZiBub3QgaGFzYXR0cihkaWN0LCAiaXRlbXMiKToKICAgICAgICAgICAgICAgIGRpY3QgPSB0eXBlKHt9KShkaWN0KQogICAgICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBkaWN0Lml0ZW1zKCk6CiAgICAgICAgICAgICAgICBkW3JlZihrZXksIHNlbGYuX3JlbW92ZSldID0gdmFsdWUKICAgICAgICBpZiBsZW4oa3dhcmdzKToKICAgICAgICAgICAgc2VsZi51cGRhdGUoa3dhcmdzKQo=',
'/Lib/webbrowser.py':'X19hbGxfXyA9IFsiRXJyb3IiLCAib3BlbiIsICJvcGVuX25ldyIsICJvcGVuX25ld190YWIiXQoKY2xhc3MgRXJyb3IoRXhjZXB0aW9uKToKICAgIHBhc3MKCl90YXJnZXQgPSB7IDA6ICcnLCAxOiAnX2JsYW5rJywgMjogJ19uZXcnIH0gICMgaGFjay4uLgoKCmRlZiBvcGVuKHVybCwgbmV3PTAsIGF1dG9yYWlzZT1UcnVlKToKICAgICIiIiAKICAgIG5ldyB3aW5kb3cgb3IgdGFiIGlzIG5vdCBjb250cm9sbGFibGUKICAgIG9uIHRoZSBjbGllbnQgc2lkZS4gYXV0b3JhaXNlIG5vdCBhdmFpbGFibGUuCiAgICAiIiIKICAgIGlmIHdpbi5vcGVuKHVybCwgX3RhcmdldFtuZXddKToKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgIHJldHVybiBGYWxzZQoKZGVmIG9wZW5fbmV3KHVybCk6CiAgICByZXR1cm4gb3Blbih1cmwsIDEpCgpkZWYgb3Blbl9uZXdfdGFiKHVybCk6CiAgICByZXR1cm4gb3Blbih1cmwsIDIpCgoK',
'/Lib/_abcoll.py':'IyBDb3B5cmlnaHQgMjAwNyBHb29nbGUsIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KIyBMaWNlbnNlZCB0byBQU0YgdW5kZXIgYSBDb250cmlidXRvciBBZ3JlZW1lbnQuCgoiIiJBYnN0cmFjdCBCYXNlIENsYXNzZXMgKEFCQ3MpIGZvciBjb2xsZWN0aW9ucywgYWNjb3JkaW5nIHRvIFBFUCAzMTE5LgoKRE9OJ1QgVVNFIFRISVMgTU9EVUxFIERJUkVDVExZISAgVGhlIGNsYXNzZXMgaGVyZSBzaG91bGQgYmUgaW1wb3J0ZWQKdmlhIGNvbGxlY3Rpb25zOyB0aGV5IGFyZSBkZWZpbmVkIGhlcmUgb25seSB0byBhbGxldmlhdGUgY2VydGFpbgpib290c3RyYXBwaW5nIGlzc3Vlcy4gIFVuaXQgdGVzdHMgYXJlIGluIHRlc3RfY29sbGVjdGlvbnMuCiIiIgoKI2Zyb20gYWJjIGltcG9ydCBBQkNNZXRhLCBhYnN0cmFjdG1ldGhvZAppbXBvcnQgc3lzCgpfX2FsbF9fID0gWyJIYXNoYWJsZSIsICJJdGVyYWJsZSIsICJJdGVyYXRvciIsCiAgICAgICAgICAgIlNpemVkIiwgIkNvbnRhaW5lciIsICJDYWxsYWJsZSIsCiAgICAgICAgICAgIlNldCIsICJNdXRhYmxlU2V0IiwKICAgICAgICAgICAiTWFwcGluZyIsICJNdXRhYmxlTWFwcGluZyIsCiAgICAgICAgICAgIk1hcHBpbmdWaWV3IiwgIktleXNWaWV3IiwgIkl0ZW1zVmlldyIsICJWYWx1ZXNWaWV3IiwKICAgICAgICAgICAiU2VxdWVuY2UiLCAiTXV0YWJsZVNlcXVlbmNlIiwKICAgICAgICAgICAiQnl0ZVN0cmluZyIsCiAgICAgICAgICAgXQoKIiIiCiMjIyBjb2xsZWN0aW9uIHJlbGF0ZWQgdHlwZXMgd2hpY2ggYXJlIG5vdCBleHBvc2VkIHRocm91Z2ggYnVpbHRpbiAjIyMKIyMgaXRlcmF0b3JzICMjCiNmaXhtZSBicnl0aG9uCiNieXRlc19pdGVyYXRvciA9IHR5cGUoaXRlcihiJycpKQpieXRlc19pdGVyYXRvciA9IHR5cGUoaXRlcignJykpCiNmaXhtZSBicnl0aG9uCiNieXRlYXJyYXlfaXRlcmF0b3IgPSB0eXBlKGl0ZXIoYnl0ZWFycmF5KCkpKQojY2FsbGFibGVfaXRlcmF0b3IgPSA/Pz8KZGljdF9rZXlpdGVyYXRvciA9IHR5cGUoaXRlcih7fS5rZXlzKCkpKQpkaWN0X3ZhbHVlaXRlcmF0b3IgPSB0eXBlKGl0ZXIoe30udmFsdWVzKCkpKQpkaWN0X2l0ZW1pdGVyYXRvciA9IHR5cGUoaXRlcih7fS5pdGVtcygpKSkKbGlzdF9pdGVyYXRvciA9IHR5cGUoaXRlcihbXSkpCmxpc3RfcmV2ZXJzZWl0ZXJhdG9yID0gdHlwZShpdGVyKHJldmVyc2VkKFtdKSkpCnJhbmdlX2l0ZXJhdG9yID0gdHlwZShpdGVyKHJhbmdlKDApKSkKc2V0X2l0ZXJhdG9yID0gdHlwZShpdGVyKHNldCgpKSkKc3RyX2l0ZXJhdG9yID0gdHlwZShpdGVyKCIiKSkKdHVwbGVfaXRlcmF0b3IgPSB0eXBlKGl0ZXIoKCkpKQp6aXBfaXRlcmF0b3IgPSB0eXBlKGl0ZXIoemlwKCkpKQojIyB2aWV3cyAjIwpkaWN0X2tleXMgPSB0eXBlKHt9LmtleXMoKSkKZGljdF92YWx1ZXMgPSB0eXBlKHt9LnZhbHVlcygpKQpkaWN0X2l0ZW1zID0gdHlwZSh7fS5pdGVtcygpKQojIyBtaXNjICMjCmRpY3RfcHJveHkgPSB0eXBlKHR5cGUuX19kaWN0X18pCiIiIgoKZGVmIGFic3RyYWN0bWV0aG9kKHNlbGYpOgogICAgcmV0dXJuIHNlbGYKCiMjIyBPTkUtVFJJQ0sgUE9OSUVTICMjIwoKCiNjbGFzcyBJdGVyYWJsZShtZXRhY2xhc3M9QUJDTWV0YSk6CmNsYXNzIEl0ZXJhYmxlOgoKICAgIEBhYnN0cmFjdG1ldGhvZAogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHdoaWxlIEZhbHNlOgogICAgICAgICAgICB5aWVsZCBOb25lCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgX19zdWJjbGFzc2hvb2tfXyhjbHMsIEMpOgogICAgICAgIGlmIGNscyBpcyBJdGVyYWJsZToKICAgICAgICAgICAgaWYgYW55KCJfX2l0ZXJfXyIgaW4gQi5fX2RpY3RfXyBmb3IgQiBpbiBDLl9fbXJvX18pOgogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCgojY2xhc3MgU2l6ZWQobWV0YWNsYXNzPUFCQ01ldGEpOgpjbGFzcyBTaXplZDoKCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICAgIHJldHVybiAwCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgX19zdWJjbGFzc2hvb2tfXyhjbHMsIEMpOgogICAgICAgIGlmIGNscyBpcyBTaXplZDoKICAgICAgICAgICAgaWYgYW55KCJfX2xlbl9fIiBpbiBCLl9fZGljdF9fIGZvciBCIGluIEMuX19tcm9fXyk6CiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKCiNjbGFzcyBDb250YWluZXIobWV0YWNsYXNzPUFCQ01ldGEpOgpjbGFzcyBDb250YWluZXI6CgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgX19jb250YWluc19fKHNlbGYsIHgpOgogICAgICAgIHJldHVybiBGYWxzZQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIF9fc3ViY2xhc3Nob29rX18oY2xzLCBDKToKICAgICAgICBpZiBjbHMgaXMgQ29udGFpbmVyOgogICAgICAgICAgICBpZiBhbnkoIl9fY29udGFpbnNfXyIgaW4gQi5fX2RpY3RfXyBmb3IgQiBpbiBDLl9fbXJvX18pOgogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiMjIyBNQVBQSU5HUyAjIyMKCgpjbGFzcyBNYXBwaW5nKFNpemVkLCBJdGVyYWJsZSwgQ29udGFpbmVyKToKCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBrZXkpOgogICAgICAgIHJhaXNlIEtleUVycm9yCgogICAgZGVmIGdldChzZWxmLCBrZXksIGRlZmF1bHQ9Tm9uZSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gc2VsZltrZXldCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICByZXR1cm4gZGVmYXVsdAoKICAgIGRlZiBfX2NvbnRhaW5zX18oc2VsZiwga2V5KToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGZba2V5XQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYga2V5cyhzZWxmKToKICAgICAgICByZXR1cm4gS2V5c1ZpZXcoc2VsZikKCiAgICBkZWYgaXRlbXMoc2VsZik6CiAgICAgICAgcmV0dXJuIEl0ZW1zVmlldyhzZWxmKQoKICAgIGRlZiB2YWx1ZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIFZhbHVlc1ZpZXcoc2VsZikKCiAgICBkZWYgX19lcV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgTWFwcGluZyk6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAogICAgICAgIHJldHVybiBkaWN0KHNlbGYuaXRlbXMoKSkgPT0gZGljdChvdGhlci5pdGVtcygpKQoKICAgIGRlZiBfX25lX18oc2VsZiwgb3RoZXIpOgogICAgICAgIHJldHVybiBub3QgKHNlbGYgPT0gb3RoZXIpCgoKY2xhc3MgTXV0YWJsZU1hcHBpbmcoTWFwcGluZyk6CgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgX19zZXRpdGVtX18oc2VsZiwga2V5LCB2YWx1ZSk6CiAgICAgICAgcmFpc2UgS2V5RXJyb3IKCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBfX2RlbGl0ZW1fXyhzZWxmLCBrZXkpOgogICAgICAgIHJhaXNlIEtleUVycm9yCgogICAgX19tYXJrZXIgPSBvYmplY3QoKQoKICAgIGRlZiBwb3Aoc2VsZiwga2V5LCBkZWZhdWx0PV9fbWFya2VyKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHZhbHVlID0gc2VsZltrZXldCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICBpZiBkZWZhdWx0IGlzIHNlbGYuX19tYXJrZXI6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgICAgICByZXR1cm4gZGVmYXVsdAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRlbCBzZWxmW2tleV0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlCgogICAgZGVmIHBvcGl0ZW0oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBrZXkgPSBuZXh0KGl0ZXIoc2VsZikpCiAgICAgICAgZXhjZXB0IFN0b3BJdGVyYXRpb246CiAgICAgICAgICAgIHJhaXNlIEtleUVycm9yCiAgICAgICAgdmFsdWUgPSBzZWxmW2tleV0KICAgICAgICBkZWwgc2VsZltrZXldCiAgICAgICAgcmV0dXJuIGtleSwgdmFsdWUKCiAgICBkZWYgY2xlYXIoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgc2VsZi5wb3BpdGVtKCkKICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIHBhc3MKCiAgICBkZWYgdXBkYXRlKCphcmdzLCAqKmt3ZHMpOgogICAgICAgIGlmIGxlbihhcmdzKSA+IDI6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigidXBkYXRlKCkgdGFrZXMgYXQgbW9zdCAyIHBvc2l0aW9uYWwgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgImFyZ3VtZW50cyAoe30gZ2l2ZW4pIi5mb3JtYXQobGVuKGFyZ3MpKSkKICAgICAgICBlbGlmIG5vdCBhcmdzOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoInVwZGF0ZSgpIHRha2VzIGF0IGxlYXN0IDEgYXJndW1lbnQgKDAgZ2l2ZW4pIikKICAgICAgICBzZWxmID0gYXJnc1swXQogICAgICAgIG90aGVyID0gYXJnc1sxXSBpZiBsZW4oYXJncykgPj0gMiBlbHNlICgpCgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIE1hcHBpbmcpOgogICAgICAgICAgICBmb3Iga2V5IGluIG90aGVyOgogICAgICAgICAgICAgICAgc2VsZltrZXldID0gb3RoZXJba2V5XQogICAgICAgIGVsaWYgaGFzYXR0cihvdGhlciwgImtleXMiKToKICAgICAgICAgICAgZm9yIGtleSBpbiBvdGhlci5rZXlzKCk6CiAgICAgICAgICAgICAgICBzZWxmW2tleV0gPSBvdGhlcltrZXldCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gb3RoZXI6CiAgICAgICAgICAgICAgICBzZWxmW2tleV0gPSB2YWx1ZQogICAgICAgIGZvciBrZXksIHZhbHVlIGluIGt3ZHMuaXRlbXMoKToKICAgICAgICAgICAgc2VsZltrZXldID0gdmFsdWUKCiAgICBkZWYgc2V0ZGVmYXVsdChzZWxmLCBrZXksIGRlZmF1bHQ9Tm9uZSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gc2VsZltrZXldCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICBzZWxmW2tleV0gPSBkZWZhdWx0CiAgICAgICAgcmV0dXJuIGRlZmF1bHQKCiNNdXRhYmxlTWFwcGluZy5yZWdpc3RlcihkaWN0KQo=',
'/Lib/_codecs.py':'CmRlZiBhc2NpaV9kZWNvZGUoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgYXNjaWlfZW5jb2RlKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIGNoYXJidWZmZXJfZW5jb2RlKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIGNoYXJtYXBfYnVpbGQoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgY2hhcm1hcF9kZWNvZGUoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgY2hhcm1hcF9lbmNvZGUoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgZGVjb2RlKCphcmdzLCoqa3cpOgogICAgIiIiZGVjb2RlKG9iaiwgW2VuY29kaW5nWyxlcnJvcnNdXSkgLT4gb2JqZWN0ICAgIAogICAgRGVjb2RlcyBvYmogdXNpbmcgdGhlIGNvZGVjIHJlZ2lzdGVyZWQgZm9yIGVuY29kaW5nLiBlbmNvZGluZyBkZWZhdWx0cwogICAgdG8gdGhlIGRlZmF1bHQgZW5jb2RpbmcuIGVycm9ycyBtYXkgYmUgZ2l2ZW4gdG8gc2V0IGEgZGlmZmVyZW50IGVycm9yCiAgICBoYW5kbGluZyBzY2hlbWUuIERlZmF1bHQgaXMgJ3N0cmljdCcgbWVhbmluZyB0aGF0IGVuY29kaW5nIGVycm9ycyByYWlzZQogICAgYSBWYWx1ZUVycm9yLiBPdGhlciBwb3NzaWJsZSB2YWx1ZXMgYXJlICdpZ25vcmUnIGFuZCAncmVwbGFjZScKICAgIGFzIHdlbGwgYXMgYW55IG90aGVyIG5hbWUgcmVnaXN0ZXJlZCB3aXRoIGNvZGVjcy5yZWdpc3Rlcl9lcnJvciB0aGF0IGlzCiAgICBhYmxlIHRvIGhhbmRsZSBWYWx1ZUVycm9ycy4iIiIKICAgIHBhc3MKCmRlZiBlbmNvZGUoKmFyZ3MsKiprdyk6CiAgICAiIiJlbmNvZGUob2JqLCBbZW5jb2RpbmdbLGVycm9yc11dKSAtPiBvYmplY3QgICAgCiAgICBFbmNvZGVzIG9iaiB1c2luZyB0aGUgY29kZWMgcmVnaXN0ZXJlZCBmb3IgZW5jb2RpbmcuIGVuY29kaW5nIGRlZmF1bHRzCiAgICB0byB0aGUgZGVmYXVsdCBlbmNvZGluZy4gZXJyb3JzIG1heSBiZSBnaXZlbiB0byBzZXQgYSBkaWZmZXJlbnQgZXJyb3IKICAgIGhhbmRsaW5nIHNjaGVtZS4gRGVmYXVsdCBpcyAnc3RyaWN0JyBtZWFuaW5nIHRoYXQgZW5jb2RpbmcgZXJyb3JzIHJhaXNlCiAgICBhIFZhbHVlRXJyb3IuIE90aGVyIHBvc3NpYmxlIHZhbHVlcyBhcmUgJ2lnbm9yZScsICdyZXBsYWNlJyBhbmQKICAgICd4bWxjaGFycmVmcmVwbGFjZScgYXMgd2VsbCBhcyBhbnkgb3RoZXIgbmFtZSByZWdpc3RlcmVkIHdpdGgKICAgIGNvZGVjcy5yZWdpc3Rlcl9lcnJvciB0aGF0IGNhbiBoYW5kbGUgVmFsdWVFcnJvcnMuIiIiCiAgICBwYXNzCgpkZWYgZXNjYXBlX2RlY29kZSgqYXJncywqKmt3KToKICAgIHBhc3MKCmRlZiBlc2NhcGVfZW5jb2RlKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIGxhdGluXzFfZGVjb2RlKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIGxhdGluXzFfZW5jb2RlKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIGxvb2t1cChlbmNvZGluZyk6CiAgICAiIiJsb29rdXAoZW5jb2RpbmcpIC0+IENvZGVjSW5mbyAgICAKICAgIExvb2tzIHVwIGEgY29kZWMgdHVwbGUgaW4gdGhlIFB5dGhvbiBjb2RlYyByZWdpc3RyeSBhbmQgcmV0dXJucwogICAgYSBDb2RlY0luZm8gb2JqZWN0LiIiIgogICAgcHJpbnQoJ19jb2RlY3MgbG9va3VwJyxlbmNvZGluZykKICAgIHJldHVybiBlbmNvZGluZwoKZGVmIGxvb2t1cF9lcnJvcigqYXJncywqKmt3KToKICAgICIiImxvb2t1cF9lcnJvcihlcnJvcnMpIC0+IGhhbmRsZXIgICAgCiAgICBSZXR1cm4gdGhlIGVycm9yIGhhbmRsZXIgZm9yIHRoZSBzcGVjaWZpZWQgZXJyb3IgaGFuZGxpbmcgbmFtZQogICAgb3IgcmFpc2UgYSBMb29rdXBFcnJvciwgaWYgbm8gaGFuZGxlciBleGlzdHMgdW5kZXIgdGhpcyBuYW1lLiIiIgogICAgcGFzcwoKZGVmIG1iY3NfZGVjb2RlKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIG1iY3NfZW5jb2RlKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIHJhd191bmljb2RlX2VzY2FwZV9kZWNvZGUoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgcmF3X3VuaWNvZGVfZXNjYXBlX2VuY29kZSgqYXJncywqKmt3KToKICAgIHBhc3MKCmRlZiByZWFkYnVmZmVyX2VuY29kZSgqYXJncywqKmt3KToKICAgIHBhc3MKCmRlZiByZWdpc3RlcigqYXJncywqKmt3KToKICAgICIiInJlZ2lzdGVyKHNlYXJjaF9mdW5jdGlvbikgICAgCiAgICBSZWdpc3RlciBhIGNvZGVjIHNlYXJjaCBmdW5jdGlvbi4gU2VhcmNoIGZ1bmN0aW9ucyBhcmUgZXhwZWN0ZWQgdG8gdGFrZQogICAgb25lIGFyZ3VtZW50LCB0aGUgZW5jb2RpbmcgbmFtZSBpbiBhbGwgbG93ZXIgY2FzZSBsZXR0ZXJzLCBhbmQgcmV0dXJuCiAgICBhIHR1cGxlIG9mIGZ1bmN0aW9ucyAoZW5jb2RlciwgZGVjb2Rlciwgc3RyZWFtX3JlYWRlciwgc3RyZWFtX3dyaXRlcikKICAgIChvciBhIENvZGVjSW5mbyBvYmplY3QpLiIiIgogICAgcGFzcwoKZGVmIHJlZ2lzdGVyX2Vycm9yKCphcmdzLCoqa3cpOgogICAgIiIicmVnaXN0ZXJfZXJyb3IoZXJyb3JzLCBoYW5kbGVyKSAgICAKICAgIFJlZ2lzdGVyIHRoZSBzcGVjaWZpZWQgZXJyb3IgaGFuZGxlciB1bmRlciB0aGUgbmFtZQogICAgZXJyb3JzLiBoYW5kbGVyIG11c3QgYmUgYSBjYWxsYWJsZSBvYmplY3QsIHRoYXQKICAgIHdpbGwgYmUgY2FsbGVkIHdpdGggYW4gZXhjZXB0aW9uIGluc3RhbmNlIGNvbnRhaW5pbmcKICAgIGluZm9ybWF0aW9uIGFib3V0IHRoZSBsb2NhdGlvbiBvZiB0aGUgZW5jb2RpbmcvZGVjb2RpbmcKICAgIGVycm9yIGFuZCBtdXN0IHJldHVybiBhIChyZXBsYWNlbWVudCwgbmV3IHBvc2l0aW9uKSB0dXBsZS4iIiIKICAgIHBhc3MKCmRlZiB1bmljb2RlX2VzY2FwZV9kZWNvZGUoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgdW5pY29kZV9lc2NhcGVfZW5jb2RlKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIHVuaWNvZGVfaW50ZXJuYWxfZGVjb2RlKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIHVuaWNvZGVfaW50ZXJuYWxfZW5jb2RlKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIHV0Zl8xNl9iZV9kZWNvZGUoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgdXRmXzE2X2JlX2VuY29kZSgqYXJncywqKmt3KToKICAgIHBhc3MKCmRlZiB1dGZfMTZfZGVjb2RlKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIHV0Zl8xNl9lbmNvZGUoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgdXRmXzE2X2V4X2RlY29kZSgqYXJncywqKmt3KToKICAgIHBhc3MKCmRlZiB1dGZfMTZfbGVfZGVjb2RlKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIHV0Zl8xNl9sZV9lbmNvZGUoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgdXRmXzMyX2JlX2RlY29kZSgqYXJncywqKmt3KToKICAgIHBhc3MKCmRlZiB1dGZfMzJfYmVfZW5jb2RlKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIHV0Zl8zMl9kZWNvZGUoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgdXRmXzMyX2VuY29kZSgqYXJncywqKmt3KToKICAgIHBhc3MKCmRlZiB1dGZfMzJfZXhfZGVjb2RlKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIHV0Zl8zMl9sZV9kZWNvZGUoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgdXRmXzMyX2xlX2VuY29kZSgqYXJncywqKmt3KToKICAgIHBhc3MKCmRlZiB1dGZfN19kZWNvZGUoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgdXRmXzdfZW5jb2RlKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIHV0Zl84X2RlY29kZSgqYXJncywqKmt3KToKICAgIHBhc3MKCmRlZiB1dGZfOF9lbmNvZGUoKmFyZ3MsKiprdyk6CiAgICBwYXNzCg==',
'/Lib/_collections.py':'IyAiSGlnaCBwZXJmb3JtYW5jZSBkYXRhIHN0cnVjdHVyZXMKIyAiCiMgY29waWVkIGZyb20gcHlweSByZXBvCgojCiMgQ29waWVkIGFuZCBjb21wbGV0ZWQgZnJvbSB0aGUgc2FuZGJveCBvZiBDUHl0aG9uCiMgICAobm9uZGlzdC9zYW5kYm94L2NvbGxlY3Rpb25zL3B5ZGVxdWUucHkgcmV2IDEuMSwgUmF5bW9uZCBIZXR0aW5nZXIpCiMKIyBlZGl0ZWQgZm9yIEJyeXRob24gbGluZSA1NTggOiBjYXRjaCBJbXBvcnRFcnJvciBpbnN0ZWFkIG9mIEF0dHJpYnV0ZUVycm9yCgppbXBvcnQgb3BlcmF0b3IKI3RyeToKIyAgICBmcm9tIHRocmVhZCBpbXBvcnQgZ2V0X2lkZW50IGFzIF90aHJlYWRfaWRlbnQKI2V4Y2VwdCBJbXBvcnRFcnJvcjoKZGVmIF90aHJlYWRfaWRlbnQoKToKICAgIHJldHVybiAtMQoKCm4gPSAzMApMRlRMTksgPSBuClJHVExOSyA9IG4rMQpCTE9DS1NJWiA9IG4rMgoKIyBUaGUgZGVxdWUncyBzaXplIGxpbWl0IGlzIGQubWF4bGVuLiAgVGhlIGxpbWl0IGNhbiBiZSB6ZXJvIG9yIHBvc2l0aXZlLCBvcgojIE5vbmUuICBBZnRlciBhbiBpdGVtIGlzIGFkZGVkIHRvIGEgZGVxdWUsIHdlIGNoZWNrIHRvIHNlZSBpZiB0aGUgc2l6ZSBoYXMKIyBncm93biBwYXN0IHRoZSBsaW1pdC4gSWYgaXQgaGFzLCB3ZSBnZXQgdGhlIHNpemUgYmFjayBkb3duIHRvIHRoZSBsaW1pdCBieQojIHBvcHBpbmcgYW4gaXRlbSBvZmYgb2YgdGhlIG9wcG9zaXRlIGVuZC4gIFRoZSBtZXRob2RzIHRoYXQgY2FuIHRyaWdnZXIgdGhpcwojIGFyZSBhcHBlbmQoKSwgYXBwZW5kbGVmdCgpLCBleHRlbmQoKSwgYW5kIGV4dGVuZGxlZnQoKS4KCiNjbGFzcyBkZXF1ZShvYmplY3QpOgpjbGFzcyBkZXF1ZToKCiAgICBkZWYgX19uZXdfXyhjbHMsIGl0ZXJhYmxlPSgpLCAqYXJncywgKiprdyk6CiAgICAgICAgI2ZpeG1lCiAgICAgICAgI3NlbGYgPSBzdXBlcihkZXF1ZSwgY2xzKS5fX25ld19fKGNscywgKmFyZ3MsICoqa3cpCiAgICAgICAgc2VsZj1vYmplY3QuX19uZXdfXyhjbHMsICphcmdzLCAqKmt3KQogICAgICAgIHNlbGYuY2xlYXIoKQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGl0ZXJhYmxlPSgpLCBtYXhsZW49Tm9uZSk6CiAgICAgICAgb2JqZWN0Ll9faW5pdF9fKHNlbGYpCiAgICAgICAgc2VsZi5jbGVhcigpCiAgICAgICAgaWYgbWF4bGVuIGlzIG5vdCBOb25lOgogICAgICAgICAgICBpZiBtYXhsZW4gPCAwOgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigibWF4bGVuIG11c3QgYmUgbm9uLW5lZ2F0aXZlIikKICAgICAgICBzZWxmLl9tYXhsZW4gPSBtYXhsZW4KICAgICAgICBhZGQgPSBzZWxmLmFwcGVuZAogICAgICAgIGZvciBlbGVtIGluIGl0ZXJhYmxlOgogICAgICAgICAgICBhZGQoZWxlbSkKCiAgICBAcHJvcGVydHkKICAgIGRlZiBtYXhsZW4oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX21heGxlbgoKICAgIGRlZiBjbGVhcihzZWxmKToKICAgICAgICBzZWxmLnJpZ2h0ID0gc2VsZi5sZWZ0ID0gW05vbmVdICogQkxPQ0tTSVoKICAgICAgICBzZWxmLnJpZ2h0bmR4ID0gbi8vMiAgICMgcG9pbnRzIHRvIGxhc3Qgd3JpdHRlbiBlbGVtZW50CiAgICAgICAgc2VsZi5sZWZ0bmR4ID0gbi8vMisxCiAgICAgICAgc2VsZi5sZW5ndGggPSAwCiAgICAgICAgc2VsZi5zdGF0ZSA9IDAKCiAgICBkZWYgYXBwZW5kKHNlbGYsIHgpOgogICAgICAgIHNlbGYuc3RhdGUgKz0gMQogICAgICAgIHNlbGYucmlnaHRuZHggKz0gMQogICAgICAgIGlmIHNlbGYucmlnaHRuZHggPT0gbjoKICAgICAgICAgICAgbmV3YmxvY2sgPSBbTm9uZV0gKiBCTE9DS1NJWgogICAgICAgICAgICBzZWxmLnJpZ2h0W1JHVExOS10gPSBuZXdibG9jawogICAgICAgICAgICBuZXdibG9ja1tMRlRMTktdID0gc2VsZi5yaWdodAogICAgICAgICAgICBzZWxmLnJpZ2h0ID0gbmV3YmxvY2sKICAgICAgICAgICAgc2VsZi5yaWdodG5keCA9IDAKICAgICAgICBzZWxmLmxlbmd0aCArPSAxCiAgICAgICAgc2VsZi5yaWdodFtzZWxmLnJpZ2h0bmR4XSA9IHgKICAgICAgICBpZiBzZWxmLm1heGxlbiBpcyBub3QgTm9uZSBhbmQgc2VsZi5sZW5ndGggPiBzZWxmLm1heGxlbjoKICAgICAgICAgICAgc2VsZi5wb3BsZWZ0KCkKCiAgICBkZWYgYXBwZW5kbGVmdChzZWxmLCB4KToKICAgICAgICBzZWxmLnN0YXRlICs9IDEKICAgICAgICBzZWxmLmxlZnRuZHggLT0gMQogICAgICAgIGlmIHNlbGYubGVmdG5keCA9PSAtMToKICAgICAgICAgICAgbmV3YmxvY2sgPSBbTm9uZV0gKiBCTE9DS1NJWgogICAgICAgICAgICBzZWxmLmxlZnRbTEZUTE5LXSA9IG5ld2Jsb2NrCiAgICAgICAgICAgIG5ld2Jsb2NrW1JHVExOS10gPSBzZWxmLmxlZnQKICAgICAgICAgICAgc2VsZi5sZWZ0ID0gbmV3YmxvY2sKICAgICAgICAgICAgc2VsZi5sZWZ0bmR4ID0gbi0xCiAgICAgICAgc2VsZi5sZW5ndGggKz0gMQogICAgICAgIHNlbGYubGVmdFtzZWxmLmxlZnRuZHhdID0geAogICAgICAgIGlmIHNlbGYubWF4bGVuIGlzIG5vdCBOb25lIGFuZCBzZWxmLmxlbmd0aCA+IHNlbGYubWF4bGVuOgogICAgICAgICAgICBzZWxmLnBvcCgpCgogICAgZGVmIGV4dGVuZChzZWxmLCBpdGVyYWJsZSk6CiAgICAgICAgaWYgaXRlcmFibGUgaXMgc2VsZjoKICAgICAgICAgICAgaXRlcmFibGUgPSBsaXN0KGl0ZXJhYmxlKQogICAgICAgIGZvciBlbGVtIGluIGl0ZXJhYmxlOgogICAgICAgICAgICBzZWxmLmFwcGVuZChlbGVtKQoKICAgIGRlZiBleHRlbmRsZWZ0KHNlbGYsIGl0ZXJhYmxlKToKICAgICAgICBpZiBpdGVyYWJsZSBpcyBzZWxmOgogICAgICAgICAgICBpdGVyYWJsZSA9IGxpc3QoaXRlcmFibGUpCiAgICAgICAgZm9yIGVsZW0gaW4gaXRlcmFibGU6CiAgICAgICAgICAgIHNlbGYuYXBwZW5kbGVmdChlbGVtKQoKICAgIGRlZiBwb3Aoc2VsZik6CiAgICAgICAgaWYgc2VsZi5sZWZ0IGlzIHNlbGYucmlnaHQgYW5kIHNlbGYubGVmdG5keCA+IHNlbGYucmlnaHRuZHg6CiAgICAgICAgICAgICNyYWlzZSBJbmRleEVycm9yLCAicG9wIGZyb20gYW4gZW1wdHkgZGVxdWUiICAjIGRvZXMgbm90IHdvcmsgaW4gYnJ5dGhvbgogICAgICAgICAgICByYWlzZSBJbmRleEVycm9yKCJwb3AgZnJvbSBhbiBlbXB0eSBkZXF1ZSIpCiAgICAgICAgeCA9IHNlbGYucmlnaHRbc2VsZi5yaWdodG5keF0KICAgICAgICBzZWxmLnJpZ2h0W3NlbGYucmlnaHRuZHhdID0gTm9uZQogICAgICAgIHNlbGYubGVuZ3RoIC09IDEKICAgICAgICBzZWxmLnJpZ2h0bmR4IC09IDEKICAgICAgICBzZWxmLnN0YXRlICs9IDEKICAgICAgICBpZiBzZWxmLnJpZ2h0bmR4ID09IC0xOgogICAgICAgICAgICBwcmV2YmxvY2sgPSBzZWxmLnJpZ2h0W0xGVExOS10KICAgICAgICAgICAgaWYgcHJldmJsb2NrIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAjIHRoZSBkZXF1ZSBoYXMgYmVjb21lIGVtcHR5OyByZWNlbnRlciBpbnN0ZWFkIG9mIGZyZWVpbmcgYmxvY2sKICAgICAgICAgICAgICAgIHNlbGYucmlnaHRuZHggPSBuLy8yCiAgICAgICAgICAgICAgICBzZWxmLmxlZnRuZHggPSBuLy8yKzEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByZXZibG9ja1tSR1RMTktdID0gTm9uZQogICAgICAgICAgICAgICAgc2VsZi5yaWdodFtMRlRMTktdID0gTm9uZQogICAgICAgICAgICAgICAgc2VsZi5yaWdodCA9IHByZXZibG9jawogICAgICAgICAgICAgICAgc2VsZi5yaWdodG5keCA9IG4tMQogICAgICAgIHJldHVybiB4CgogICAgZGVmIHBvcGxlZnQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5sZWZ0IGlzIHNlbGYucmlnaHQgYW5kIHNlbGYubGVmdG5keCA+IHNlbGYucmlnaHRuZHg6CiAgICAgICAgICAgICNyYWlzZSBJbmRleEVycm9yLCAicG9wIGZyb20gYW4gZW1wdHkgZGVxdWUiCiAgICAgICAgICAgIHJhaXNlIEluZGV4RXJyb3IoInBvcCBmcm9tIGFuIGVtcHR5IGRlcXVlIikKICAgICAgICB4ID0gc2VsZi5sZWZ0W3NlbGYubGVmdG5keF0KICAgICAgICBzZWxmLmxlZnRbc2VsZi5sZWZ0bmR4XSA9IE5vbmUKICAgICAgICBzZWxmLmxlbmd0aCAtPSAxCiAgICAgICAgc2VsZi5sZWZ0bmR4ICs9IDEKICAgICAgICBzZWxmLnN0YXRlICs9IDEKICAgICAgICBpZiBzZWxmLmxlZnRuZHggPT0gbjoKICAgICAgICAgICAgcHJldmJsb2NrID0gc2VsZi5sZWZ0W1JHVExOS10KICAgICAgICAgICAgaWYgcHJldmJsb2NrIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAjIHRoZSBkZXF1ZSBoYXMgYmVjb21lIGVtcHR5OyByZWNlbnRlciBpbnN0ZWFkIG9mIGZyZWVpbmcgYmxvY2sKICAgICAgICAgICAgICAgIHNlbGYucmlnaHRuZHggPSBuLy8yCiAgICAgICAgICAgICAgICBzZWxmLmxlZnRuZHggPSBuLy8yKzEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByZXZibG9ja1tMRlRMTktdID0gTm9uZQogICAgICAgICAgICAgICAgc2VsZi5sZWZ0W1JHVExOS10gPSBOb25lCiAgICAgICAgICAgICAgICBzZWxmLmxlZnQgPSBwcmV2YmxvY2sKICAgICAgICAgICAgICAgIHNlbGYubGVmdG5keCA9IDAKICAgICAgICByZXR1cm4geAoKICAgIGRlZiBjb3VudChzZWxmLCB2YWx1ZSk6CiAgICAgICAgYyA9IDAKICAgICAgICBmb3IgaXRlbSBpbiBzZWxmOgogICAgICAgICAgICBpZiBpdGVtID09IHZhbHVlOgogICAgICAgICAgICAgICAgYyArPSAxCiAgICAgICAgcmV0dXJuIGMKCiAgICBkZWYgcmVtb3ZlKHNlbGYsIHZhbHVlKToKICAgICAgICAjIE5lZWQgdG8gYmUgZGVmZW5zaXZlIGZvciBtdXRhdGluZyBjb21wYXJpc29ucwogICAgICAgIGZvciBpIGluIHJhbmdlKGxlbihzZWxmKSk6CiAgICAgICAgICAgIGlmIHNlbGZbaV0gPT0gdmFsdWU6CiAgICAgICAgICAgICAgICBkZWwgc2VsZltpXQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiZGVxdWUucmVtb3ZlKHgpOiB4IG5vdCBpbiBkZXF1ZSIpCgogICAgZGVmIHJvdGF0ZShzZWxmLCBuPTEpOgogICAgICAgIGxlbmd0aCA9IGxlbihzZWxmKQogICAgICAgIGlmIGxlbmd0aCA9PSAwOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBoYWxmbGVuID0gKGxlbmd0aCsxKSA+PiAxCiAgICAgICAgaWYgbiA+IGhhbGZsZW4gb3IgbiA8IC1oYWxmbGVuOgogICAgICAgICAgICBuICU9IGxlbmd0aAogICAgICAgICAgICBpZiBuID4gaGFsZmxlbjoKICAgICAgICAgICAgICAgIG4gLT0gbGVuZ3RoCiAgICAgICAgICAgIGVsaWYgbiA8IC1oYWxmbGVuOgogICAgICAgICAgICAgICAgbiArPSBsZW5ndGgKICAgICAgICB3aGlsZSBuID4gMDoKICAgICAgICAgICAgc2VsZi5hcHBlbmRsZWZ0KHNlbGYucG9wKCkpCiAgICAgICAgICAgIG4gLT0gMQogICAgICAgIHdoaWxlIG4gPCAwOgogICAgICAgICAgICBzZWxmLmFwcGVuZChzZWxmLnBvcGxlZnQoKSkKICAgICAgICAgICAgbiArPSAxCgogICAgZGVmIHJldmVyc2Uoc2VsZik6CiAgICAgICAgInJldmVyc2UgKklOIFBMQUNFKiIKICAgICAgICBsZWZ0YmxvY2sgPSBzZWxmLmxlZnQKICAgICAgICByaWdodGJsb2NrID0gc2VsZi5yaWdodAogICAgICAgIGxlZnRpbmRleCA9IHNlbGYubGVmdG5keAogICAgICAgIHJpZ2h0aW5kZXggPSBzZWxmLnJpZ2h0bmR4CiAgICAgICAgZm9yIGkgaW4gcmFuZ2Uoc2VsZi5sZW5ndGggLy8gMik6CiAgICAgICAgICAgICMgVmFsaWRhdGUgdGhhdCBwb2ludGVycyBoYXZlbid0IG1ldCBpbiB0aGUgbWlkZGxlCiAgICAgICAgICAgIGFzc2VydCBsZWZ0YmxvY2sgIT0gcmlnaHRibG9jayBvciBsZWZ0aW5kZXggPCByaWdodGluZGV4CgogICAgICAgICAgICAjIFN3YXAKICAgICAgICAgICAgKHJpZ2h0YmxvY2tbcmlnaHRpbmRleF0sIGxlZnRibG9ja1tsZWZ0aW5kZXhdKSA9ICgKICAgICAgICAgICAgICAgIGxlZnRibG9ja1tsZWZ0aW5kZXhdLCByaWdodGJsb2NrW3JpZ2h0aW5kZXhdKQoKICAgICAgICAgICAgIyBBZHZhbmNlIGxlZnQgYmxvY2svaW5kZXggcGFpcgogICAgICAgICAgICBsZWZ0aW5kZXggKz0gMQogICAgICAgICAgICBpZiBsZWZ0aW5kZXggPT0gbjoKICAgICAgICAgICAgICAgIGxlZnRibG9jayA9IGxlZnRibG9ja1tSR1RMTktdCiAgICAgICAgICAgICAgICBhc3NlcnQgbGVmdGJsb2NrIGlzIG5vdCBOb25lCiAgICAgICAgICAgICAgICBsZWZ0aW5kZXggPSAwCgogICAgICAgICAgICAjIFN0ZXAgYmFja3dhcmRzIHdpdGggdGhlIHJpZ2h0IGJsb2NrL2luZGV4IHBhaXIKICAgICAgICAgICAgcmlnaHRpbmRleCAtPSAxCiAgICAgICAgICAgIGlmIHJpZ2h0aW5kZXggPT0gLTE6CiAgICAgICAgICAgICAgICByaWdodGJsb2NrID0gcmlnaHRibG9ja1tMRlRMTktdCiAgICAgICAgICAgICAgICBhc3NlcnQgcmlnaHRibG9jayBpcyBub3QgTm9uZQogICAgICAgICAgICAgICAgcmlnaHRpbmRleCA9IG4gLSAxCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHRocmVhZGxvY2FsYXR0ciA9ICdfX3JlcHInICsgc3RyKF90aHJlYWRfaWRlbnQoKSkKICAgICAgICBpZiB0aHJlYWRsb2NhbGF0dHIgaW4gc2VsZi5fX2RpY3RfXzoKICAgICAgICAgICAgcmV0dXJuICdkZXF1ZShbLi4uXSknCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5fX2RpY3RfX1t0aHJlYWRsb2NhbGF0dHJdID0gVHJ1ZQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpZiBzZWxmLm1heGxlbiBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ2RlcXVlKCVyLCBtYXhsZW49JXMpJyAlIChsaXN0KHNlbGYpLCBzZWxmLm1heGxlbikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdkZXF1ZSglciknICUgKGxpc3Qoc2VsZiksKQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgZGVsIHNlbGYuX19kaWN0X19bdGhyZWFkbG9jYWxhdHRyXQoKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gZGVxdWVfaXRlcmF0b3Ioc2VsZiwgc2VsZi5faXRlcl9pbXBsKQoKICAgIGRlZiBfaXRlcl9pbXBsKHNlbGYsIG9yaWdpbmFsX3N0YXRlLCBnaXZldXApOgogICAgICAgIGlmIHNlbGYuc3RhdGUgIT0gb3JpZ2luYWxfc3RhdGU6CiAgICAgICAgICAgIGdpdmV1cCgpCiAgICAgICAgYmxvY2sgPSBzZWxmLmxlZnQKICAgICAgICB3aGlsZSBibG9jazoKICAgICAgICAgICAgbCwgciA9IDAsIG4KICAgICAgICAgICAgaWYgYmxvY2sgaXMgc2VsZi5sZWZ0OgogICAgICAgICAgICAgICAgbCA9IHNlbGYubGVmdG5keAogICAgICAgICAgICBpZiBibG9jayBpcyBzZWxmLnJpZ2h0OgogICAgICAgICAgICAgICAgciA9IHNlbGYucmlnaHRuZHggKyAxCiAgICAgICAgICAgIGZvciBlbGVtIGluIGJsb2NrW2w6cl06CiAgICAgICAgICAgICAgICB5aWVsZCBlbGVtCiAgICAgICAgICAgICAgICBpZiBzZWxmLnN0YXRlICE9IG9yaWdpbmFsX3N0YXRlOgogICAgICAgICAgICAgICAgICAgIGdpdmV1cCgpCiAgICAgICAgICAgIGJsb2NrID0gYmxvY2tbUkdUTE5LXQoKICAgIGRlZiBfX3JldmVyc2VkX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGRlcXVlX2l0ZXJhdG9yKHNlbGYsIHNlbGYuX3JldmVyc2VkX2ltcGwpCgogICAgZGVmIF9yZXZlcnNlZF9pbXBsKHNlbGYsIG9yaWdpbmFsX3N0YXRlLCBnaXZldXApOgogICAgICAgIGlmIHNlbGYuc3RhdGUgIT0gb3JpZ2luYWxfc3RhdGU6CiAgICAgICAgICAgIGdpdmV1cCgpCiAgICAgICAgYmxvY2sgPSBzZWxmLnJpZ2h0CiAgICAgICAgd2hpbGUgYmxvY2s6CiAgICAgICAgICAgIGwsIHIgPSAwLCBuCiAgICAgICAgICAgIGlmIGJsb2NrIGlzIHNlbGYubGVmdDoKICAgICAgICAgICAgICAgIGwgPSBzZWxmLmxlZnRuZHgKICAgICAgICAgICAgaWYgYmxvY2sgaXMgc2VsZi5yaWdodDoKICAgICAgICAgICAgICAgIHIgPSBzZWxmLnJpZ2h0bmR4ICsgMQogICAgICAgICAgICBmb3IgZWxlbSBpbiByZXZlcnNlZChibG9ja1tsOnJdKToKICAgICAgICAgICAgICAgIHlpZWxkIGVsZW0KICAgICAgICAgICAgICAgIGlmIHNlbGYuc3RhdGUgIT0gb3JpZ2luYWxfc3RhdGU6CiAgICAgICAgICAgICAgICAgICAgZ2l2ZXVwKCkKICAgICAgICAgICAgYmxvY2sgPSBibG9ja1tMRlRMTktdCgogICAgZGVmIF9fbGVuX18oc2VsZik6CiAgICAgICAgI3N1bSA9IDAKICAgICAgICAjYmxvY2sgPSBzZWxmLmxlZnQKICAgICAgICAjd2hpbGUgYmxvY2s6CiAgICAgICAgIyAgICBzdW0gKz0gbgogICAgICAgICMgICAgYmxvY2sgPSBibG9ja1tSR1RMTktdCiAgICAgICAgI3JldHVybiBzdW0gKyBzZWxmLnJpZ2h0bmR4IC0gc2VsZi5sZWZ0bmR4ICsgMSAtIG4KICAgICAgICByZXR1cm4gc2VsZi5sZW5ndGgKCiAgICBkZWYgX19nZXRyZWYoc2VsZiwgaW5kZXgpOgogICAgICAgIGlmIGluZGV4ID49IDA6CiAgICAgICAgICAgIGJsb2NrID0gc2VsZi5sZWZ0CiAgICAgICAgICAgIHdoaWxlIGJsb2NrOgogICAgICAgICAgICAgICAgbCwgciA9IDAsIG4KICAgICAgICAgICAgICAgIGlmIGJsb2NrIGlzIHNlbGYubGVmdDoKICAgICAgICAgICAgICAgICAgICBsID0gc2VsZi5sZWZ0bmR4CiAgICAgICAgICAgICAgICBpZiBibG9jayBpcyBzZWxmLnJpZ2h0OgogICAgICAgICAgICAgICAgICAgIHIgPSBzZWxmLnJpZ2h0bmR4ICsgMQogICAgICAgICAgICAgICAgc3BhbiA9IHItbAogICAgICAgICAgICAgICAgaWYgaW5kZXggPCBzcGFuOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBibG9jaywgbCtpbmRleAogICAgICAgICAgICAgICAgaW5kZXggLT0gc3BhbgogICAgICAgICAgICAgICAgYmxvY2sgPSBibG9ja1tSR1RMTktdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYmxvY2sgPSBzZWxmLnJpZ2h0CiAgICAgICAgICAgIHdoaWxlIGJsb2NrOgogICAgICAgICAgICAgICAgbCwgciA9IDAsIG4KICAgICAgICAgICAgICAgIGlmIGJsb2NrIGlzIHNlbGYubGVmdDoKICAgICAgICAgICAgICAgICAgICBsID0gc2VsZi5sZWZ0bmR4CiAgICAgICAgICAgICAgICBpZiBibG9jayBpcyBzZWxmLnJpZ2h0OgogICAgICAgICAgICAgICAgICAgIHIgPSBzZWxmLnJpZ2h0bmR4ICsgMQogICAgICAgICAgICAgICAgbmVnYXRpdmVfc3BhbiA9IGwtcgogICAgICAgICAgICAgICAgaWYgaW5kZXggPj0gbmVnYXRpdmVfc3BhbjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmxvY2ssIHIraW5kZXgKICAgICAgICAgICAgICAgIGluZGV4IC09IG5lZ2F0aXZlX3NwYW4KICAgICAgICAgICAgICAgIGJsb2NrID0gYmxvY2tbTEZUTE5LXQogICAgICAgIHJhaXNlIEluZGV4RXJyb3IoImRlcXVlIGluZGV4IG91dCBvZiByYW5nZSIpCgogICAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGluZGV4KToKICAgICAgICBibG9jaywgaW5kZXggPSBzZWxmLl9fZ2V0cmVmKGluZGV4KQogICAgICAgIHJldHVybiBibG9ja1tpbmRleF0KCiAgICBkZWYgX19zZXRpdGVtX18oc2VsZiwgaW5kZXgsIHZhbHVlKToKICAgICAgICBibG9jaywgaW5kZXggPSBzZWxmLl9fZ2V0cmVmKGluZGV4KQogICAgICAgIGJsb2NrW2luZGV4XSA9IHZhbHVlCgogICAgZGVmIF9fZGVsaXRlbV9fKHNlbGYsIGluZGV4KToKICAgICAgICBsZW5ndGggPSBsZW4oc2VsZikKICAgICAgICBpZiBpbmRleCA+PSAwOgogICAgICAgICAgICBpZiBpbmRleCA+PSBsZW5ndGg6CiAgICAgICAgICAgICAgICByYWlzZSBJbmRleEVycm9yKCJkZXF1ZSBpbmRleCBvdXQgb2YgcmFuZ2UiKQogICAgICAgICAgICBzZWxmLnJvdGF0ZSgtaW5kZXgpCiAgICAgICAgICAgIHNlbGYucG9wbGVmdCgpCiAgICAgICAgICAgIHNlbGYucm90YXRlKGluZGV4KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICNpbmRleCA9IH5pbmRleCAgICAgICN0b2RvIHVudGlsIGJpdCB3aXNlIG9wZXJhdG9ycyBhcmUgaW4gYnl0aG9uCiAgICAgICAgICAgIGluZGV4PSBpbmRleF4oMioqMzEpCiAgICAgICAgICAgIGlmIGluZGV4ID49IGxlbmd0aDoKICAgICAgICAgICAgICAgIHJhaXNlIEluZGV4RXJyb3IoImRlcXVlIGluZGV4IG91dCBvZiByYW5nZSIpCiAgICAgICAgICAgIHNlbGYucm90YXRlKGluZGV4KQogICAgICAgICAgICBzZWxmLnBvcCgpCiAgICAgICAgICAgIHNlbGYucm90YXRlKC1pbmRleCkKCiAgICBkZWYgX19yZWR1Y2VfZXhfXyhzZWxmLCBwcm90byk6CiAgICAgICAgcmV0dXJuIHR5cGUoc2VsZiksIChsaXN0KHNlbGYpLCBzZWxmLm1heGxlbikKCiAgICBkZWYgX19oYXNoX18oc2VsZik6CiAgICAgICAgI3JhaXNlIFR5cGVFcnJvciwgImRlcXVlIG9iamVjdHMgYXJlIHVuaGFzaGFibGUiCiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJkZXF1ZSBvYmplY3RzIGFyZSB1bmhhc2hhYmxlIikKCiAgICBkZWYgX19jb3B5X18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKHNlbGYsIHNlbGYubWF4bGVuKQoKICAgICMgWFhYIG1ha2UgY29tcGFyaXNvbiBtb3JlIGVmZmljaWVudAogICAgZGVmIF9fZXFfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgZGVxdWUpOgogICAgICAgICAgICByZXR1cm4gbGlzdChzZWxmKSA9PSBsaXN0KG90aGVyKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgIGRlZiBfX25lX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIGlzaW5zdGFuY2Uob3RoZXIsIGRlcXVlKToKICAgICAgICAgICAgcmV0dXJuIGxpc3Qoc2VsZikgIT0gbGlzdChvdGhlcikKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICBkZWYgX19sdF9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkZXF1ZSk6CiAgICAgICAgICAgIHJldHVybiBsaXN0KHNlbGYpIDwgbGlzdChvdGhlcikKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICBkZWYgX19sZV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCBkZXF1ZSk6CiAgICAgICAgICAgIHJldHVybiBsaXN0KHNlbGYpIDw9IGxpc3Qob3RoZXIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCgogICAgZGVmIF9fZ3RfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgZGVxdWUpOgogICAgICAgICAgICByZXR1cm4gbGlzdChzZWxmKSA+IGxpc3Qob3RoZXIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCgogICAgZGVmIF9fZ2VfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgZGVxdWUpOgogICAgICAgICAgICByZXR1cm4gbGlzdChzZWxmKSA+PSBsaXN0KG90aGVyKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgIGRlZiBfX2lhZGRfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgc2VsZi5leHRlbmQob3RoZXIpCiAgICAgICAgcmV0dXJuIHNlbGYKCgpjbGFzcyBkZXF1ZV9pdGVyYXRvcihvYmplY3QpOgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBkZXEsIGl0ZXJnZW4pOgogICAgICAgIHNlbGYuY291bnRlciA9IGxlbihkZXEpCiAgICAgICAgZGVmIGdpdmV1cCgpOgogICAgICAgICAgICBzZWxmLmNvdW50ZXIgPSAwCiAgICAgICAgICAgICNyYWlzZSBSdW50aW1lRXJyb3IsICJkZXF1ZSBtdXRhdGVkIGR1cmluZyBpdGVyYXRpb24iCiAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigiZGVxdWUgbXV0YXRlZCBkdXJpbmcgaXRlcmF0aW9uIikKICAgICAgICBzZWxmLl9nZW4gPSBpdGVyZ2VuKGRlcS5zdGF0ZSwgZ2l2ZXVwKQoKICAgIGRlZiBuZXh0KHNlbGYpOgogICAgICAgIHJlcyA9ICBzZWxmLl9nZW4ubmV4dCgpCiAgICAgICAgc2VsZi5jb3VudGVyIC09IDEKICAgICAgICByZXR1cm4gcmVzCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgpjbGFzcyBkZWZhdWx0ZGljdChkaWN0KToKICAgIAogICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3ZHMpOgogICAgICAgIGlmIGxlbihhcmdzKSA+IDA6CiAgICAgICAgICAgIGRlZmF1bHRfZmFjdG9yeSA9IGFyZ3NbMF0KICAgICAgICAgICAgYXJncyA9IGFyZ3NbMTpdCiAgICAgICAgICAgIGlmIG5vdCBjYWxsYWJsZShkZWZhdWx0X2ZhY3RvcnkpIGFuZCBkZWZhdWx0X2ZhY3RvcnkgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImZpcnN0IGFyZ3VtZW50IG11c3QgYmUgY2FsbGFibGUiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRlZmF1bHRfZmFjdG9yeSA9IE5vbmUKICAgICAgICBkaWN0Ll9faW5pdF9fKHNlbGYsIGFyZ3MsIGt3ZHMpCiAgICAgICAgc2VsZi5kZWZhdWx0X2ZhY3RvcnkgPSBkZWZhdWx0X2ZhY3RvcnkKICAgICAgICBzZWxmLnVwZGF0ZShhcmdzLCBrd2RzKQogICAgICAgICNzdXBlcihkZWZhdWx0ZGljdCwgc2VsZikuX19pbml0X18oKmFyZ3MsICoqa3dkcykKCiAgICAjZml4bWUuLiAgaGFkIHRvIGFkZCB0aGlzIGZ1bmN0aW9uIHRvIGdldCBkZWZhdWx0ZGljdCB3b3JraW5nIHdpdGggYnJ5dGhvbiBjb3JyZWN0bHkKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBrZXkpOgogICAgICAgIGlmIHNlbGYuX19jb250YWluc19fKGtleSk6ICAKICAgICAgICAgICByZXR1cm4gZGljdC5fX2dldGl0ZW1fXyhzZWxmLGtleSkKICAgIAogICAgICAgIHJldHVybiBzZWxmLl9fbWlzc2luZ19fKGtleSkKCiAgICBkZWYgX19taXNzaW5nX18oc2VsZiwga2V5KToKICAgICAgICAjIGZyb20gZGVmYXVsdGRpY3QgZG9jcwogICAgICAgIGlmIHNlbGYuZGVmYXVsdF9mYWN0b3J5IGlzIE5vbmU6IAogICAgICAgICAgICByYWlzZSBLZXlFcnJvcihrZXkpCiAgICAgICAgc2VsZltrZXldID0gdmFsdWUgPSBzZWxmLmRlZmF1bHRfZmFjdG9yeSgpCiAgICAgICAgcmV0dXJuIHZhbHVlCgogICAgZGVmIF9fcmVwcl9fKHNlbGYsIHJlY3Vyc2U9c2V0KCkpOgogICAgICAgIGlmIGlkKHNlbGYpIGluIHJlY3Vyc2U6CiAgICAgICAgICAgIHJldHVybiAiZGVmYXVsdGRpY3QoLi4uKSIKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlY3Vyc2UuYWRkKGlkKHNlbGYpKQogICAgICAgICAgICByZXR1cm4gImRlZmF1bHRkaWN0KCVzLCAlcykiICUgKHJlcHIoc2VsZi5kZWZhdWx0X2ZhY3RvcnkpLCBzdXBlcihkZWZhdWx0ZGljdCwgc2VsZikuX19yZXByX18oKSkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICByZWN1cnNlLnJlbW92ZShpZChzZWxmKSkKCiAgICBkZWYgY29weShzZWxmKToKICAgICAgICByZXR1cm4gdHlwZShzZWxmKShzZWxmLmRlZmF1bHRfZmFjdG9yeSwgc2VsZikKICAgIAogICAgZGVmIF9fY29weV9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmNvcHkoKQoKICAgIGRlZiBfX3JlZHVjZV9fKHNlbGYpOgogICAgICAgICMKICAgICAgICAjX19yZWR1Y2VfXyBtdXN0IHJldHVybiBhIDUtdHVwbGUgYXMgZm9sbG93czoKICAgICAgICAjCiAgICAgICAgIyAgIC0gZmFjdG9yeSBmdW5jdGlvbgogICAgICAgICMgICAtIHR1cGxlIG9mIGFyZ3MgZm9yIHRoZSBmYWN0b3J5IGZ1bmN0aW9uCiAgICAgICAgIyAgIC0gYWRkaXRpb25hbCBzdGF0ZSAoaGVyZSBOb25lKQogICAgICAgICMgICAtIHNlcXVlbmNlIGl0ZXJhdG9yIChoZXJlIE5vbmUpCiAgICAgICAgIyAgIC0gZGljdGlvbmFyeSBpdGVyYXRvciAoeWllbGRpbmcgc3VjY2Vzc2l2ZSAoa2V5LCB2YWx1ZSkgcGFpcnMKCiAgICAgICAgIyAgIFRoaXMgQVBJIGlzIHVzZWQgYnkgcGlja2xlLnB5IGFuZCBjb3B5LnB5LgogICAgICAgICMKICAgICAgICByZXR1cm4gKHR5cGUoc2VsZiksIChzZWxmLmRlZmF1bHRfZmFjdG9yeSwpLCBOb25lLCBOb25lLCBzZWxmLml0ZXJpdGVtcygpKQoKZnJvbSBvcGVyYXRvciBpbXBvcnQgaXRlbWdldHRlciBhcyBfaXRlbWdldHRlcgpmcm9tIGtleXdvcmQgaW1wb3J0IGlza2V5d29yZCBhcyBfaXNrZXl3b3JkCmltcG9ydCBzeXMgYXMgX3N5cwoKZGVmIG5hbWVkdHVwbGUodHlwZW5hbWUsIGZpZWxkX25hbWVzLCB2ZXJib3NlPUZhbHNlLCByZW5hbWU9RmFsc2UpOgogICAgIiIiUmV0dXJucyBhIG5ldyBzdWJjbGFzcyBvZiB0dXBsZSB3aXRoIG5hbWVkIGZpZWxkcy4KCiAgICA+Pj4gUG9pbnQgPSBuYW1lZHR1cGxlKCdQb2ludCcsICd4IHknKQogICAgPj4+IFBvaW50Ll9fZG9jX18gICAgICAgICAgICAgICAgICAgIyBkb2NzdHJpbmcgZm9yIHRoZSBuZXcgY2xhc3MKICAgICdQb2ludCh4LCB5KScKICAgID4+PiBwID0gUG9pbnQoMTEsIHk9MjIpICAgICAgICAgICAgICMgaW5zdGFudGlhdGUgd2l0aCBwb3NpdGlvbmFsIGFyZ3Mgb3Iga2V5d29yZHMKICAgID4+PiBwWzBdICsgcFsxXSAgICAgICAgICAgICAgICAgICAgICMgaW5kZXhhYmxlIGxpa2UgYSBwbGFpbiB0dXBsZQogICAgMzMKICAgID4+PiB4LCB5ID0gcCAgICAgICAgICAgICAgICAgICAgICAgICMgdW5wYWNrIGxpa2UgYSByZWd1bGFyIHR1cGxlCiAgICA+Pj4geCwgeQogICAgKDExLCAyMikKICAgID4+PiBwLnggKyBwLnkgICAgICAgICAgICAgICAgICAgICAgICMgZmllbGRzIGFsc28gYWNjZXNzYWJsZSBieSBuYW1lCiAgICAzMwogICAgPj4+IGQgPSBwLl9hc2RpY3QoKSAgICAgICAgICAgICAgICAgIyBjb252ZXJ0IHRvIGEgZGljdGlvbmFyeQogICAgPj4+IGRbJ3gnXQogICAgMTEKICAgID4+PiBQb2ludCgqKmQpICAgICAgICAgICAgICAgICAgICAgICMgY29udmVydCBmcm9tIGEgZGljdGlvbmFyeQogICAgUG9pbnQoeD0xMSwgeT0yMikKICAgID4+PiBwLl9yZXBsYWNlKHg9MTAwKSAgICAgICAgICAgICAgICMgX3JlcGxhY2UoKSBpcyBsaWtlIHN0ci5yZXBsYWNlKCkgYnV0IHRhcmdldHMgbmFtZWQgZmllbGRzCiAgICBQb2ludCh4PTEwMCwgeT0yMikKCiAgICAiIiIKCiAgICAjIFBhcnNlIGFuZCB2YWxpZGF0ZSB0aGUgZmllbGQgbmFtZXMuICBWYWxpZGF0aW9uIHNlcnZlcyB0d28gcHVycG9zZXMsCiAgICAjIGdlbmVyYXRpbmcgaW5mb3JtYXRpdmUgZXJyb3IgbWVzc2FnZXMgYW5kIHByZXZlbnRpbmcgdGVtcGxhdGUgaW5qZWN0aW9uIGF0dGFja3MuCiAgICBpZiBpc2luc3RhbmNlKGZpZWxkX25hbWVzLCBzdHIpOgogICAgICAgIGZpZWxkX25hbWVzID0gZmllbGRfbmFtZXMucmVwbGFjZSgnLCcsICcgJykuc3BsaXQoKSAjIG5hbWVzIHNlcGFyYXRlZCBieSB3aGl0ZXNwYWNlIGFuZC9vciBjb21tYXMKICAgIGZpZWxkX25hbWVzID0gdHVwbGUobWFwKHN0ciwgZmllbGRfbmFtZXMpKQogICAgaWYgcmVuYW1lOgogICAgICAgIG5hbWVzID0gbGlzdChmaWVsZF9uYW1lcykKICAgICAgICBzZWVuID0gc2V0KCkKICAgICAgICBmb3IgaSwgbmFtZSBpbiBlbnVtZXJhdGUobmFtZXMpOgogICAgICAgICAgICBpZiAobm90IG1pbihjLmlzYWxudW0oKSBvciBjPT0nXycgZm9yIGMgaW4gbmFtZSkgb3IgX2lza2V5d29yZChuYW1lKQogICAgICAgICAgICAgICAgb3Igbm90IG5hbWUgb3IgbmFtZVswXS5pc2RpZ2l0KCkgb3IgbmFtZS5zdGFydHN3aXRoKCdfJykKICAgICAgICAgICAgICAgIG9yIG5hbWUgaW4gc2Vlbik6CiAgICAgICAgICAgICAgICAgICAgbmFtZXNbaV0gPSAnXyVkJyAlIGkKICAgICAgICAgICAgc2Vlbi5hZGQobmFtZSkKICAgICAgICBmaWVsZF9uYW1lcyA9IHR1cGxlKG5hbWVzKQogICAgZm9yIG5hbWUgaW4gKHR5cGVuYW1lLCkgKyBmaWVsZF9uYW1lczoKICAgICAgICBpZiBub3QgbWluKGMuaXNhbG51bSgpIG9yIGM9PSdfJyBmb3IgYyBpbiBuYW1lKToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignVHlwZSBuYW1lcyBhbmQgZmllbGQgbmFtZXMgY2FuIG9ubHkgY29udGFpbiBhbHBoYW51bWVyaWMgY2hhcmFjdGVycyBhbmQgdW5kZXJzY29yZXM6ICVyJyAlIG5hbWUpCiAgICAgICAgaWYgX2lza2V5d29yZChuYW1lKToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignVHlwZSBuYW1lcyBhbmQgZmllbGQgbmFtZXMgY2Fubm90IGJlIGEga2V5d29yZDogJXInICUgbmFtZSkKICAgICAgICBpZiBuYW1lWzBdLmlzZGlnaXQoKToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignVHlwZSBuYW1lcyBhbmQgZmllbGQgbmFtZXMgY2Fubm90IHN0YXJ0IHdpdGggYSBudW1iZXI6ICVyJyAlIG5hbWUpCiAgICBzZWVuX25hbWVzID0gc2V0KCkKICAgIGZvciBuYW1lIGluIGZpZWxkX25hbWVzOgogICAgICAgIGlmIG5hbWUuc3RhcnRzd2l0aCgnXycpIGFuZCBub3QgcmVuYW1lOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdGaWVsZCBuYW1lcyBjYW5ub3Qgc3RhcnQgd2l0aCBhbiB1bmRlcnNjb3JlOiAlcicgJSBuYW1lKQogICAgICAgIGlmIG5hbWUgaW4gc2Vlbl9uYW1lczoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignRW5jb3VudGVyZWQgZHVwbGljYXRlIGZpZWxkIG5hbWU6ICVyJyAlIG5hbWUpCiAgICAgICAgc2Vlbl9uYW1lcy5hZGQobmFtZSkKCiAgICAjIENyZWF0ZSBhbmQgZmlsbC1pbiB0aGUgY2xhc3MgdGVtcGxhdGUKICAgIG51bWZpZWxkcyA9IGxlbihmaWVsZF9uYW1lcykKICAgIGFyZ3R4dCA9IHJlcHIoZmllbGRfbmFtZXMpLnJlcGxhY2UoIiciLCAiIilbMTotMV0gICAjIHR1cGxlIHJlcHIgd2l0aG91dCBwYXJlbnMgb3IgcXVvdGVzCiAgICByZXBydHh0ID0gJywgJy5qb2luKCclcz0lJXInICUgbmFtZSBmb3IgbmFtZSBpbiBmaWVsZF9uYW1lcykKICAgIHRlbXBsYXRlID0gJycnY2xhc3MgJSh0eXBlbmFtZSlzKHR1cGxlKToKICAgICAgICAnJSh0eXBlbmFtZSlzKCUoYXJndHh0KXMpJyBcbgogICAgICAgIF9fc2xvdHNfXyA9ICgpIFxuCiAgICAgICAgX2ZpZWxkcyA9ICUoZmllbGRfbmFtZXMpciBcbgogICAgICAgIGRlZiBfX25ld19fKF9jbHMsICUoYXJndHh0KXMpOgogICAgICAgICAgICByZXR1cm4gX3R1cGxlLl9fbmV3X18oX2NscywgKCUoYXJndHh0KXMpKSBcbgogICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgIGRlZiBfbWFrZShjbHMsIGl0ZXJhYmxlLCBuZXc9dHVwbGUuX19uZXdfXywgbGVuPWxlbik6CiAgICAgICAgICAgICdNYWtlIGEgbmV3ICUodHlwZW5hbWUpcyBvYmplY3QgZnJvbSBhIHNlcXVlbmNlIG9yIGl0ZXJhYmxlJwogICAgICAgICAgICByZXN1bHQgPSBuZXcoY2xzLCBpdGVyYWJsZSkKICAgICAgICAgICAgaWYgbGVuKHJlc3VsdCkgIT0gJShudW1maWVsZHMpZDoKICAgICAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcignRXhwZWN0ZWQgJShudW1maWVsZHMpZCBhcmd1bWVudHMsIGdvdCAlJWQnICUlIGxlbihyZXN1bHQpKQogICAgICAgICAgICByZXR1cm4gcmVzdWx0IFxuCiAgICAgICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgICAgICByZXR1cm4gJyUodHlwZW5hbWUpcyglKHJlcHJ0eHQpcyknICUlIHNlbGYgXG4KICAgICAgICBkZWYgX2FzZGljdChzZWxmKToKICAgICAgICAgICAgJ1JldHVybiBhIG5ldyBkaWN0IHdoaWNoIG1hcHMgZmllbGQgbmFtZXMgdG8gdGhlaXIgdmFsdWVzJwogICAgICAgICAgICByZXR1cm4gZGljdCh6aXAoc2VsZi5fZmllbGRzLCBzZWxmKSkgXG4KICAgICAgICBkZWYgX3JlcGxhY2UoX3NlbGYsICoqa3dkcyk6CiAgICAgICAgICAgICdSZXR1cm4gYSBuZXcgJSh0eXBlbmFtZSlzIG9iamVjdCByZXBsYWNpbmcgc3BlY2lmaWVkIGZpZWxkcyB3aXRoIG5ldyB2YWx1ZXMnCiAgICAgICAgICAgIHJlc3VsdCA9IF9zZWxmLl9tYWtlKG1hcChrd2RzLnBvcCwgJShmaWVsZF9uYW1lcylyLCBfc2VsZikpCiAgICAgICAgICAgIGlmIGt3ZHM6CiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdHb3QgdW5leHBlY3RlZCBmaWVsZCBuYW1lczogJSVyJyAlJSBrd2RzLmtleXMoKSkKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdCBcbgogICAgICAgIGRlZiBfX2dldG5ld2FyZ3NfXyhzZWxmKToKICAgICAgICAgICAgcmV0dXJuIHR1cGxlKHNlbGYpIFxuXG4nJycgJSBsb2NhbHMoKQogICAgZm9yIGksIG5hbWUgaW4gZW51bWVyYXRlKGZpZWxkX25hbWVzKToKICAgICAgICB0ZW1wbGF0ZSArPSAnICAgICAgICAlcyA9IF9wcm9wZXJ0eShfaXRlbWdldHRlciglZCkpXG4nICUgKG5hbWUsIGkpCiAgICAKICAgIGlmIHZlcmJvc2U6CiAgICAgICAgcHJpbnQodGVtcGxhdGUpCgogICAgIyBFeGVjdXRlIHRoZSB0ZW1wbGF0ZSBzdHJpbmcgaW4gYSB0ZW1wb3JhcnkgbmFtZXNwYWNlCiAgICBuYW1lc3BhY2UgPSBkaWN0KF9pdGVtZ2V0dGVyPV9pdGVtZ2V0dGVyLCBfX25hbWVfXz0nbmFtZWR0dXBsZV8lcycgJSB0eXBlbmFtZSwKICAgICAgICAgICAgICAgICAgICAgX3Byb3BlcnR5PXByb3BlcnR5LCBfdHVwbGU9dHVwbGUpCiAgICB0cnk6CiAgICAgICAgZXhlYyh0ZW1wbGF0ZSxuYW1lc3BhY2UpCiAgICBleGNlcHQgU3ludGF4RXJyb3IgYXMgZToKICAgICAgICByYWlzZSBTeW50YXhFcnJvcihlLm1lc3NhZ2UgKyAnOlxuJyArIHRlbXBsYXRlKQogICAgcmVzdWx0ID0gbmFtZXNwYWNlW3R5cGVuYW1lXQoKICAgICMgRm9yIHBpY2tsaW5nIHRvIHdvcmssIHRoZSBfX21vZHVsZV9fIHZhcmlhYmxlIG5lZWRzIHRvIGJlIHNldCB0byB0aGUgZnJhbWUKICAgICMgd2hlcmUgdGhlIG5hbWVkIHR1cGxlIGlzIGNyZWF0ZWQuICBCeXBhc3MgdGhpcyBzdGVwIGluIGVudmlyb21lbnRzIHdoZXJlCiAgICAjIHN5cy5fZ2V0ZnJhbWUgaXMgbm90IGRlZmluZWQgKEp5dGhvbiBmb3IgZXhhbXBsZSkgb3Igc3lzLl9nZXRmcmFtZSBpcyBub3QKICAgICMgZGVmaW5lZCBmb3IgYXJndW1lbnRzIGdyZWF0ZXIgdGhhbiAwIChJcm9uUHl0aG9uKS4KICAgIHRyeToKICAgICAgICByZXN1bHQuX19tb2R1bGVfXyA9IF9zeXMuX2dldGZyYW1lKDEpLmZfZ2xvYmFscy5nZXQoJ19fbmFtZV9fJywgJ19fbWFpbl9fJykKICAgIGV4Y2VwdCAoQXR0cmlidXRlRXJyb3IsIFZhbHVlRXJyb3IpOgogICAgICAgIHBhc3MKCiAgICByZXR1cm4gcmVzdWx0CgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgUG9pbnQgPSBuYW1lZHR1cGxlKCdQb2ludCcsIFsneCcsICd5J10pCiAgICBwID0gUG9pbnQoMTEsIHk9MjIpCiAgICBwcmludChwWzBdK3BbMV0pCiAgICB4LHk9cAogICAgcHJpbnQoeCx5KQogICAgcHJpbnQocC54K3AueSkKICAgIHByaW50KHApCg==',
'/Lib/_dummy_thread.py':'IiIiRHJvcC1pbiByZXBsYWNlbWVudCBmb3IgdGhlIHRocmVhZCBtb2R1bGUuCgpNZWFudCB0byBiZSB1c2VkIGFzIGEgYnJhaW4tZGVhZCBzdWJzdGl0dXRlIHNvIHRoYXQgdGhyZWFkZWQgY29kZSBkb2VzCm5vdCBuZWVkIHRvIGJlIHJld3JpdHRlbiBmb3Igd2hlbiB0aGUgdGhyZWFkIG1vZHVsZSBpcyBub3QgcHJlc2VudC4KClN1Z2dlc3RlZCB1c2FnZSBpczo6CgogICAgdHJ5OgogICAgICAgIGltcG9ydCBfdGhyZWFkCiAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgaW1wb3J0IF9kdW1teV90aHJlYWQgYXMgX3RocmVhZAoKIiIiCiMgRXhwb3J0cyBvbmx5IHRoaW5ncyBzcGVjaWZpZWQgYnkgdGhyZWFkIGRvY3VtZW50YXRpb247CiMgc2tpcHBpbmcgb2Jzb2xldGUgc3lub255bXMgYWxsb2NhdGUoKSwgc3RhcnRfbmV3KCksIGV4aXRfdGhyZWFkKCkuCl9fYWxsX18gPSBbJ2Vycm9yJywgJ3N0YXJ0X25ld190aHJlYWQnLCAnZXhpdCcsICdnZXRfaWRlbnQnLCAnYWxsb2NhdGVfbG9jaycsCiAgICAgICAgICAgJ2ludGVycnVwdF9tYWluJywgJ0xvY2tUeXBlJ10KCiMgQSBkdW1teSB2YWx1ZQpUSU1FT1VUX01BWCA9IDIqKjMxCgojIE5PVEU6IHRoaXMgbW9kdWxlIGNhbiBiZSBpbXBvcnRlZCBlYXJseSBpbiB0aGUgZXh0ZW5zaW9uIGJ1aWxkaW5nIHByb2Nlc3MsCiMgYW5kIHNvIHRvcCBsZXZlbCBpbXBvcnRzIG9mIG90aGVyIG1vZHVsZXMgc2hvdWxkIGJlIGF2b2lkZWQuICBJbnN0ZWFkLCBhbGwKIyBpbXBvcnRzIGFyZSBkb25lIHdoZW4gbmVlZGVkIG9uIGEgZnVuY3Rpb24tYnktZnVuY3Rpb24gYmFzaXMuICBTaW5jZSB0aHJlYWRzCiMgYXJlIGRpc2FibGVkLCB0aGUgaW1wb3J0IGxvY2sgc2hvdWxkIG5vdCBiZSBhbiBpc3N1ZSBhbnl3YXkgKD8/KS4KCmVycm9yID0gUnVudGltZUVycm9yCgpkZWYgc3RhcnRfbmV3X3RocmVhZChmdW5jdGlvbiwgYXJncywga3dhcmdzPXt9KToKICAgICIiIkR1bW15IGltcGxlbWVudGF0aW9uIG9mIF90aHJlYWQuc3RhcnRfbmV3X3RocmVhZCgpLgoKICAgIENvbXBhdGliaWxpdHkgaXMgbWFpbnRhaW5lZCBieSBtYWtpbmcgc3VyZSB0aGF0IGBgYXJnc2BgIGlzIGEKICAgIHR1cGxlIGFuZCBgYGt3YXJnc2BgIGlzIGEgZGljdGlvbmFyeS4gIElmIGFuIGV4Y2VwdGlvbiBpcyByYWlzZWQKICAgIGFuZCBpdCBpcyBTeXN0ZW1FeGl0ICh3aGljaCBjYW4gYmUgZG9uZSBieSBfdGhyZWFkLmV4aXQoKSkgaXQgaXMKICAgIGNhdWdodCBhbmQgbm90aGluZyBpcyBkb25lOyBhbGwgb3RoZXIgZXhjZXB0aW9ucyBhcmUgcHJpbnRlZCBvdXQKICAgIGJ5IHVzaW5nIHRyYWNlYmFjay5wcmludF9leGMoKS4KCiAgICBJZiB0aGUgZXhlY3V0ZWQgZnVuY3Rpb24gY2FsbHMgaW50ZXJydXB0X21haW4gdGhlIEtleWJvYXJkSW50ZXJydXB0IHdpbGwgYmUKICAgIHJhaXNlZCB3aGVuIHRoZSBmdW5jdGlvbiByZXR1cm5zLgoKICAgICIiIgogICAgaWYgdHlwZShhcmdzKSAhPSB0eXBlKHR1cGxlKCkpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiMm5kIGFyZyBtdXN0IGJlIGEgdHVwbGUiKQogICAgaWYgdHlwZShrd2FyZ3MpICE9IHR5cGUoZGljdCgpKToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoIjNyZCBhcmcgbXVzdCBiZSBhIGRpY3QiKQogICAgZ2xvYmFsIF9tYWluCiAgICBfbWFpbiA9IEZhbHNlCiAgICB0cnk6CiAgICAgICAgZnVuY3Rpb24oKmFyZ3MsICoqa3dhcmdzKQogICAgZXhjZXB0IFN5c3RlbUV4aXQ6CiAgICAgICAgcGFzcwogICAgZXhjZXB0OgogICAgICAgIGltcG9ydCB0cmFjZWJhY2sKICAgICAgICB0cmFjZWJhY2sucHJpbnRfZXhjKCkKICAgIF9tYWluID0gVHJ1ZQogICAgZ2xvYmFsIF9pbnRlcnJ1cHQKICAgIGlmIF9pbnRlcnJ1cHQ6CiAgICAgICAgX2ludGVycnVwdCA9IEZhbHNlCiAgICAgICAgcmFpc2UgS2V5Ym9hcmRJbnRlcnJ1cHQKCmRlZiBleGl0KCk6CiAgICAiIiJEdW1teSBpbXBsZW1lbnRhdGlvbiBvZiBfdGhyZWFkLmV4aXQoKS4iIiIKICAgIHJhaXNlIFN5c3RlbUV4aXQKCmRlZiBnZXRfaWRlbnQoKToKICAgICIiIkR1bW15IGltcGxlbWVudGF0aW9uIG9mIF90aHJlYWQuZ2V0X2lkZW50KCkuCgogICAgU2luY2UgdGhpcyBtb2R1bGUgc2hvdWxkIG9ubHkgYmUgdXNlZCB3aGVuIF90aHJlYWRtb2R1bGUgaXMgbm90CiAgICBhdmFpbGFibGUsIGl0IGlzIHNhZmUgdG8gYXNzdW1lIHRoYXQgdGhlIGN1cnJlbnQgcHJvY2VzcyBpcyB0aGUKICAgIG9ubHkgdGhyZWFkLiAgVGh1cyBhIGNvbnN0YW50IGNhbiBiZSBzYWZlbHkgcmV0dXJuZWQuCiAgICAiIiIKICAgIHJldHVybiAtMQoKZGVmIGFsbG9jYXRlX2xvY2soKToKICAgICIiIkR1bW15IGltcGxlbWVudGF0aW9uIG9mIF90aHJlYWQuYWxsb2NhdGVfbG9jaygpLiIiIgogICAgcmV0dXJuIExvY2tUeXBlKCkKCmRlZiBzdGFja19zaXplKHNpemU9Tm9uZSk6CiAgICAiIiJEdW1teSBpbXBsZW1lbnRhdGlvbiBvZiBfdGhyZWFkLnN0YWNrX3NpemUoKS4iIiIKICAgIGlmIHNpemUgaXMgbm90IE5vbmU6CiAgICAgICAgcmFpc2UgZXJyb3IoInNldHRpbmcgdGhyZWFkIHN0YWNrIHNpemUgbm90IHN1cHBvcnRlZCIpCiAgICByZXR1cm4gMAoKY2xhc3MgTG9ja1R5cGUob2JqZWN0KToKICAgICIiIkNsYXNzIGltcGxlbWVudGluZyBkdW1teSBpbXBsZW1lbnRhdGlvbiBvZiBfdGhyZWFkLkxvY2tUeXBlLgoKICAgIENvbXBhdGliaWxpdHkgaXMgbWFpbnRhaW5lZCBieSBtYWludGFpbmluZyBzZWxmLmxvY2tlZF9zdGF0dXMKICAgIHdoaWNoIGlzIGEgYm9vbGVhbiB0aGF0IHN0b3JlcyB0aGUgc3RhdGUgb2YgdGhlIGxvY2suICBQaWNrbGluZyBvZgogICAgdGhlIGxvY2ssIHRob3VnaCwgc2hvdWxkIG5vdCBiZSBkb25lIHNpbmNlIGlmIHRoZSBfdGhyZWFkIG1vZHVsZSBpcwogICAgdGhlbiB1c2VkIHdpdGggYW4gdW5waWNrbGVkIGBgbG9jaygpYGAgZnJvbSBoZXJlIHByb2JsZW1zIGNvdWxkCiAgICBvY2N1ciBmcm9tIHRoaXMgY2xhc3Mgbm90IGhhdmluZyBhdG9taWMgbWV0aG9kcy4KCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi5sb2NrZWRfc3RhdHVzID0gRmFsc2UKCiAgICBkZWYgYWNxdWlyZShzZWxmLCB3YWl0ZmxhZz1Ob25lLCB0aW1lb3V0PS0xKToKICAgICAgICAiIiJEdW1teSBpbXBsZW1lbnRhdGlvbiBvZiBhY3F1aXJlKCkuCgogICAgICAgIEZvciBibG9ja2luZyBjYWxscywgc2VsZi5sb2NrZWRfc3RhdHVzIGlzIGF1dG9tYXRpY2FsbHkgc2V0IHRvCiAgICAgICAgVHJ1ZSBhbmQgcmV0dXJuZWQgYXBwcm9wcmlhdGVseSBiYXNlZCBvbiB2YWx1ZSBvZgogICAgICAgIGBgd2FpdGZsYWdgYC4gIElmIGl0IGlzIG5vbi1ibG9ja2luZywgdGhlbiB0aGUgdmFsdWUgaXMKICAgICAgICBhY3R1YWxseSBjaGVja2VkIGFuZCBub3Qgc2V0IGlmIGl0IGlzIGFscmVhZHkgYWNxdWlyZWQuICBUaGlzCiAgICAgICAgaXMgYWxsIGRvbmUgc28gdGhhdCB0aHJlYWRpbmcuQ29uZGl0aW9uJ3MgYXNzZXJ0IHN0YXRlbWVudHMKICAgICAgICBhcmVuJ3QgdHJpZ2dlcmVkIGFuZCB0aHJvdyBhIGxpdHRsZSBmaXQuCgogICAgICAgICIiIgogICAgICAgIGlmIHdhaXRmbGFnIGlzIE5vbmUgb3Igd2FpdGZsYWc6CiAgICAgICAgICAgIHNlbGYubG9ja2VkX3N0YXR1cyA9IFRydWUKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBub3Qgc2VsZi5sb2NrZWRfc3RhdHVzOgogICAgICAgICAgICAgICAgc2VsZi5sb2NrZWRfc3RhdHVzID0gVHJ1ZQogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIHRpbWVvdXQgPiAwOgogICAgICAgICAgICAgICAgICAgIGltcG9ydCB0aW1lCiAgICAgICAgICAgICAgICAgICAgdGltZS5zbGVlcCh0aW1lb3V0KQogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgX19lbnRlcl9fID0gYWNxdWlyZQoKICAgIGRlZiBfX2V4aXRfXyhzZWxmLCB0eXAsIHZhbCwgdGIpOgogICAgICAgIHNlbGYucmVsZWFzZSgpCgogICAgZGVmIHJlbGVhc2Uoc2VsZik6CiAgICAgICAgIiIiUmVsZWFzZSB0aGUgZHVtbXkgbG9jay4iIiIKICAgICAgICAjIFhYWCBQZXJoYXBzIHNob3VsZG4ndCBhY3R1YWxseSBib3RoZXIgdG8gdGVzdD8gIENvdWxkIGxlYWQKICAgICAgICAjICAgICB0byBwcm9ibGVtcyBmb3IgY29tcGxleCwgdGhyZWFkZWQgY29kZS4KICAgICAgICBpZiBub3Qgc2VsZi5sb2NrZWRfc3RhdHVzOgogICAgICAgICAgICByYWlzZSBlcnJvcgogICAgICAgIHNlbGYubG9ja2VkX3N0YXR1cyA9IEZhbHNlCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgbG9ja2VkKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmxvY2tlZF9zdGF0dXMKCiMgVXNlZCB0byBzaWduYWwgdGhhdCBpbnRlcnJ1cHRfbWFpbiB3YXMgY2FsbGVkIGluIGEgInRocmVhZCIKX2ludGVycnVwdCA9IEZhbHNlCiMgVHJ1ZSB3aGVuIG5vdCBleGVjdXRpbmcgaW4gYSAidGhyZWFkIgpfbWFpbiA9IFRydWUKCmRlZiBpbnRlcnJ1cHRfbWFpbigpOgogICAgIiIiU2V0IF9pbnRlcnJ1cHQgZmxhZyB0byBUcnVlIHRvIGhhdmUgc3RhcnRfbmV3X3RocmVhZCByYWlzZQogICAgS2V5Ym9hcmRJbnRlcnJ1cHQgdXBvbiBleGl0aW5nLiIiIgogICAgaWYgX21haW46CiAgICAgICAgcmFpc2UgS2V5Ym9hcmRJbnRlcnJ1cHQKICAgIGVsc2U6CiAgICAgICAgZ2xvYmFsIF9pbnRlcnJ1cHQKICAgICAgICBfaW50ZXJydXB0ID0gVHJ1ZQo=',
'/Lib/_functools.py':'ZGVmIHBhcnRpYWwoZnVuYywgKmFyZ3MsICoqa2V5d29yZHMpOgogICAgZGVmIG5ld2Z1bmMoKmZhcmdzLCAqKmZrZXl3b3Jkcyk6CiAgICAgICAgbmV3a2V5d29yZHMgPSBrZXl3b3Jkcy5jb3B5KCkKICAgICAgICBuZXdrZXl3b3Jkcy51cGRhdGUoZmtleXdvcmRzKQogICAgICAgIHJldHVybiBmdW5jKCooYXJncyArIGZhcmdzKSwgKipuZXdrZXl3b3JkcykKICAgIG5ld2Z1bmMuZnVuYyA9IGZ1bmMKICAgIG5ld2Z1bmMuYXJncyA9IGFyZ3MKICAgIG5ld2Z1bmMua2V5d29yZHMgPSBrZXl3b3JkcwogICAgcmV0dXJuIG5ld2Z1bmMKCmRlZiByZWR1Y2UoZnVuYyxpdGVyYWJsZSxpbml0aWFsaXplcj1Ob25lKToKICAgIGFyZ3MgPSBpdGVyKGl0ZXJhYmxlKQogICAgaWYgaW5pdGlhbGl6ZXIgaXMgbm90IE5vbmU6CiAgICAgICAgcmVzID0gaW5pdGlhbGl6ZXIKICAgIGVsc2U6CiAgICAgICAgcmVzID0gbmV4dChhcmcpCiAgICB3aGlsZSBUcnVlOgogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzID0gZnVuYyhyZXMsbmV4dChhcmdzKSkKICAgICAgICBleGNlcHQgU3RvcEl0ZXJhdGlvbjoKICAgICAgICAgICAgcmV0dXJuIHJlcwo=',
'/Lib/_imp.py':'IiIiKEV4dHJlbWVseSkgbG93LWxldmVsIGltcG9ydCBtYWNoaW5lcnkgYml0cyBhcyB1c2VkIGJ5IGltcG9ydGxpYiBhbmQgaW1wLiIiIgoKCmNsYXNzIF9fbG9hZGVyX18ob2JqZWN0KTpwYXNzCgpkZWYgX2ZpeF9jb19maWxlbmFtZSgqYXJncywqKmt3KToKICAgIHBhc3MKCmRlZiBhY3F1aXJlX2xvY2soKmFyZ3MsKiprdyk6CiAgICAiIiJhY3F1aXJlX2xvY2soKSAtPiBOb25lICAgIEFjcXVpcmVzIHRoZSBpbnRlcnByZXRlcidzIGltcG9ydCBsb2NrIGZvciB0aGUgY3VycmVudCB0aHJlYWQuCiAgICBUaGlzIGxvY2sgc2hvdWxkIGJlIHVzZWQgYnkgaW1wb3J0IGhvb2tzIHRvIGVuc3VyZSB0aHJlYWQtc2FmZXR5CiAgICB3aGVuIGltcG9ydGluZyBtb2R1bGVzLgogICAgT24gcGxhdGZvcm1zIHdpdGhvdXQgdGhyZWFkcywgdGhpcyBmdW5jdGlvbiBkb2VzIG5vdGhpbmcuIiIiCiAgICBwYXNzCgpkZWYgZXh0ZW5zaW9uX3N1ZmZpeGVzKCphcmdzLCoqa3cpOgogICAgIiIiZXh0ZW5zaW9uX3N1ZmZpeGVzKCkgLT4gbGlzdCBvZiBzdHJpbmdzICAgIFJldHVybnMgdGhlIGxpc3Qgb2YgZmlsZSBzdWZmaXhlcyB1c2VkIHRvIGlkZW50aWZ5IGV4dGVuc2lvbiBtb2R1bGVzLiIiIgogICAgcmV0dXJuIFsnLnB5ZCddCgpkZWYgZ2V0X2Zyb3plbl9vYmplY3QoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgaW5pdF9idWlsdGluKG1vZHVsZSwqYXJncywqKmt3KToKICAgIHJldHVybiBfX2ltcG9ydF9fKG1vZHVsZSkKCmRlZiBpbml0X2Zyb3plbigqYXJncywqKmt3KToKICAgIHBhc3MKCmRlZiBpc19idWlsdGluKCphcmdzLCoqa3cpOgogICAgcGFzcwoKZGVmIGlzX2Zyb3plbigqYXJncywqKmt3KToKICAgIHBhc3MKCmRlZiBpc19mcm96ZW5fcGFja2FnZSgqYXJncywqKmt3KToKICAgIHBhc3MKCmRlZiBsb2FkX2R5bmFtaWMoKmFyZ3MsKiprdyk6CiAgICBwYXNzCgpkZWYgbG9ja19oZWxkKCphcmdzLCoqa3cpOgogICAgIiIibG9ja19oZWxkKCkgLT4gYm9vbGVhbiAgICBSZXR1cm4gVHJ1ZSBpZiB0aGUgaW1wb3J0IGxvY2sgaXMgY3VycmVudGx5IGhlbGQsIGVsc2UgRmFsc2UuCiAgICBPbiBwbGF0Zm9ybXMgd2l0aG91dCB0aHJlYWRzLCByZXR1cm4gRmFsc2UuIiIiCiAgICBwYXNzCgpkZWYgcmVsZWFzZV9sb2NrKCphcmdzLCoqa3cpOgogICAgIiIicmVsZWFzZV9sb2NrKCkgLT4gTm9uZSAgICBSZWxlYXNlIHRoZSBpbnRlcnByZXRlcidzIGltcG9ydCBsb2NrLgogICAgT24gcGxhdGZvcm1zIHdpdGhvdXQgdGhyZWFkcywgdGhpcyBmdW5jdGlvbiBkb2VzIG5vdGhpbmcuIiIiCiAgICBwYXNzCg==',
'/Lib/_pyio.py':'IyAiUHl0aG9uIGltcGxlbWVudGF0aW9uIG9mIHRoZSBpbyBtb2R1bGUuIgoKaW1wb3J0IG9zCiNpbXBvcnQgYWJjCmltcG9ydCBjb2RlY3MKaW1wb3J0IHdhcm5pbmdzCmltcG9ydCBlcnJubwojIEltcG9ydCBfdGhyZWFkIGluc3RlYWQgb2YgdGhyZWFkaW5nIHRvIHJlZHVjZSBzdGFydHVwIGNvc3QKI3RyeToKIyAgICBmcm9tIF90aHJlYWQgaW1wb3J0IGFsbG9jYXRlX2xvY2sgYXMgTG9jawojZXhjZXB0IEltcG9ydEVycm9yOgpmcm9tIF9kdW1teV90aHJlYWQgaW1wb3J0IGFsbG9jYXRlX2xvY2sgYXMgTG9jawoKI2ltcG9ydCBpbwojZnJvbSBpbyBpbXBvcnQgKF9fYWxsX18sIFNFRUtfU0VULCBTRUVLX0NVUiwgU0VFS19FTkQpCmZyb20gZXJybm8gaW1wb3J0IEVJTlRSCgojIGZvciBzZWVrKCkgICAodGFrZW4gZnJvbSBpby5weSkKU0VFS19TRVQgPSAwClNFRUtfQ1VSID0gMQpTRUVLX0VORCA9IDIKCiMgb3BlbigpIHVzZXMgc3RfYmxrc2l6ZSB3aGVuZXZlciB3ZSBjYW4KREVGQVVMVF9CVUZGRVJfU0laRSA9IDggKiAxMDI0ICAjIGJ5dGVzCgojIE5PVEU6IEJhc2UgY2xhc3NlcyBkZWZpbmVkIGhlcmUgYXJlIHJlZ2lzdGVyZWQgd2l0aCB0aGUgIm9mZmljaWFsIiBBQkNzCiMgZGVmaW5lZCBpbiBpby5weS4gV2UgZG9uJ3QgdXNlIHJlYWwgaW5oZXJpdGFuY2UgdGhvdWdoLCBiZWNhdXNlIHdlIGRvbid0CiMgd2FudCB0byBpbmhlcml0IHRoZSBDIGltcGxlbWVudGF0aW9ucy4KCmNsYXNzIEJsb2NraW5nSU9FcnJvcihJT0Vycm9yKToKICAgICJFeGNlcHRpb24gcmFpc2VkIHdoZW4gSS9PIHdvdWxkIGJsb2NrIG9uIGEgbm9uLWJsb2NraW5nIEkvTyBzdHJlYW0uIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBlcnJubywgc3RyZXJyb3IsIGNoYXJhY3RlcnNfd3JpdHRlbj0wKToKICAgICAgICAjc3VwZXIoKS5fX2luaXRfXyhlcnJubywgc3RyZXJyb3IpICAgI2ZpeG1lCiAgICAgICAgSU9FcnJvci5fX2luaXRfXyhzZWxmLCBlcnJubywgc3RyZXJyb3IpCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoY2hhcmFjdGVyc193cml0dGVuLCBpbnQpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImNoYXJhY3RlcnNfd3JpdHRlbiBtdXN0IGJlIGEgaW50ZWdlciIpCiAgICAgICAgc2VsZi5jaGFyYWN0ZXJzX3dyaXR0ZW4gPSBjaGFyYWN0ZXJzX3dyaXR0ZW4KCgpkZWYgb3BlbihmaWxlLCBtb2RlPSJyIiwgYnVmZmVyaW5nPS0xLCBlbmNvZGluZz1Ob25lLCBlcnJvcnM9Tm9uZSxcCiAgICAgICAgIG5ld2xpbmU9Tm9uZSwgY2xvc2VmZD1UcnVlKToKCiAgICBpZiBub3QgaXNpbnN0YW5jZShmaWxlLCAoc3RyLCBieXRlcywgaW50KSk6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJpbnZhbGlkIGZpbGU6ICVyIiAlIGZpbGUpCiAgICBpZiBub3QgaXNpbnN0YW5jZShtb2RlLCBzdHIpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiaW52YWxpZCBtb2RlOiAlciIgJSBtb2RlKQogICAgaWYgbm90IGlzaW5zdGFuY2UoYnVmZmVyaW5nLCBpbnQpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiaW52YWxpZCBidWZmZXJpbmc6ICVyIiAlIGJ1ZmZlcmluZykKICAgIGlmIGVuY29kaW5nIGlzIG5vdCBOb25lIGFuZCBub3QgaXNpbnN0YW5jZShlbmNvZGluZywgc3RyKToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoImludmFsaWQgZW5jb2Rpbmc6ICVyIiAlIGVuY29kaW5nKQogICAgaWYgZXJyb3JzIGlzIG5vdCBOb25lIGFuZCBub3QgaXNpbnN0YW5jZShlcnJvcnMsIHN0cik6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJpbnZhbGlkIGVycm9yczogJXIiICUgZXJyb3JzKQogICAgbW9kZXMgPSBzZXQobW9kZSkKICAgIGlmIG1vZGVzIC0gc2V0KCJhcndiK3RVIikgb3IgbGVuKG1vZGUpID4gbGVuKG1vZGVzKToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJpbnZhbGlkIG1vZGU6ICVyIiAlIG1vZGUpCiAgICByZWFkaW5nID0gInIiIGluIG1vZGVzCiAgICB3cml0aW5nID0gInciIGluIG1vZGVzCiAgICBhcHBlbmRpbmcgPSAiYSIgaW4gbW9kZXMKICAgIHVwZGF0aW5nID0gIisiIGluIG1vZGVzCiAgICB0ZXh0ID0gInQiIGluIG1vZGVzCiAgICBiaW5hcnkgPSAiYiIgaW4gbW9kZXMKICAgIGlmICJVIiBpbiBtb2RlczoKICAgICAgICBpZiB3cml0aW5nIG9yIGFwcGVuZGluZzoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiY2FuJ3QgdXNlIFUgYW5kIHdyaXRpbmcgbW9kZSBhdCBvbmNlIikKICAgICAgICByZWFkaW5nID0gVHJ1ZQogICAgaWYgdGV4dCBhbmQgYmluYXJ5OgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImNhbid0IGhhdmUgdGV4dCBhbmQgYmluYXJ5IG1vZGUgYXQgb25jZSIpCiAgICBpZiByZWFkaW5nICsgd3JpdGluZyArIGFwcGVuZGluZyA+IDE6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiY2FuJ3QgaGF2ZSByZWFkL3dyaXRlL2FwcGVuZCBtb2RlIGF0IG9uY2UiKQogICAgaWYgbm90IChyZWFkaW5nIG9yIHdyaXRpbmcgb3IgYXBwZW5kaW5nKToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJtdXN0IGhhdmUgZXhhY3RseSBvbmUgb2YgcmVhZC93cml0ZS9hcHBlbmQgbW9kZSIpCiAgICBpZiBiaW5hcnkgYW5kIGVuY29kaW5nIGlzIG5vdCBOb25lOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImJpbmFyeSBtb2RlIGRvZXNuJ3QgdGFrZSBhbiBlbmNvZGluZyBhcmd1bWVudCIpCiAgICBpZiBiaW5hcnkgYW5kIGVycm9ycyBpcyBub3QgTm9uZToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJiaW5hcnkgbW9kZSBkb2Vzbid0IHRha2UgYW4gZXJyb3JzIGFyZ3VtZW50IikKICAgIGlmIGJpbmFyeSBhbmQgbmV3bGluZSBpcyBub3QgTm9uZToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJiaW5hcnkgbW9kZSBkb2Vzbid0IHRha2UgYSBuZXdsaW5lIGFyZ3VtZW50IikKICAgIHJhdyA9IEZpbGVJTyhmaWxlLAogICAgICAgICAgICAgICAgIChyZWFkaW5nIGFuZCAiciIgb3IgIiIpICsKICAgICAgICAgICAgICAgICAod3JpdGluZyBhbmQgInciIG9yICIiKSArCiAgICAgICAgICAgICAgICAgKGFwcGVuZGluZyBhbmQgImEiIG9yICIiKSArCiAgICAgICAgICAgICAgICAgKHVwZGF0aW5nIGFuZCAiKyIgb3IgIiIpLAogICAgICAgICAgICAgICAgIGNsb3NlZmQpCiAgICBsaW5lX2J1ZmZlcmluZyA9IEZhbHNlCiAgICBpZiBidWZmZXJpbmcgPT0gMSBvciBidWZmZXJpbmcgPCAwIGFuZCByYXcuaXNhdHR5KCk6CiAgICAgICAgYnVmZmVyaW5nID0gLTEKICAgICAgICBsaW5lX2J1ZmZlcmluZyA9IFRydWUKICAgIGlmIGJ1ZmZlcmluZyA8IDA6CiAgICAgICAgYnVmZmVyaW5nID0gREVGQVVMVF9CVUZGRVJfU0laRQogICAgICAgIHRyeToKICAgICAgICAgICAgYnMgPSBvcy5mc3RhdChyYXcuZmlsZW5vKCkpLnN0X2Jsa3NpemUKICAgICAgICAjZXhjZXB0IChvcy5lcnJvciwgQXR0cmlidXRlRXJyb3IpOiAgICNmaXhtZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIGJzID4gMToKICAgICAgICAgICAgICAgIGJ1ZmZlcmluZyA9IGJzCiAgICBpZiBidWZmZXJpbmcgPCAwOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImludmFsaWQgYnVmZmVyaW5nIHNpemUiKQogICAgaWYgYnVmZmVyaW5nID09IDA6CiAgICAgICAgaWYgYmluYXJ5OgogICAgICAgICAgICByZXR1cm4gcmF3CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiY2FuJ3QgaGF2ZSB1bmJ1ZmZlcmVkIHRleHQgSS9PIikKICAgIGlmIHVwZGF0aW5nOgogICAgICAgIGJ1ZmZlciA9IEJ1ZmZlcmVkUmFuZG9tKHJhdywgYnVmZmVyaW5nKQogICAgZWxpZiB3cml0aW5nIG9yIGFwcGVuZGluZzoKICAgICAgICBidWZmZXIgPSBCdWZmZXJlZFdyaXRlcihyYXcsIGJ1ZmZlcmluZykKICAgIGVsaWYgcmVhZGluZzoKICAgICAgICBidWZmZXIgPSBCdWZmZXJlZFJlYWRlcihyYXcsIGJ1ZmZlcmluZykKICAgIGVsc2U6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigidW5rbm93biBtb2RlOiAlciIgJSBtb2RlKQogICAgaWYgYmluYXJ5OgogICAgICAgIHJldHVybiBidWZmZXIKICAgIHRleHQgPSBUZXh0SU9XcmFwcGVyKGJ1ZmZlciwgZW5jb2RpbmcsIGVycm9ycywgbmV3bGluZSwgbGluZV9idWZmZXJpbmcpCiAgICB0ZXh0Lm1vZGUgPSBtb2RlCiAgICByZXR1cm4gdGV4dAoKCmNsYXNzIERvY0Rlc2NyaXB0b3I6CiAgICAiSGVscGVyIGZvciBidWlsdGlucy5vcGVuLl9fZG9jX18iCiAgICBkZWYgX19nZXRfXyhzZWxmLCBvYmosIHR5cCk6CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgIm9wZW4oZmlsZSwgbW9kZT0ncicsIGJ1ZmZlcmluZz0tMSwgZW5jb2Rpbmc9Tm9uZSwgIgogICAgICAgICAgICAgICAgICJlcnJvcnM9Tm9uZSwgbmV3bGluZT1Ob25lLCBjbG9zZWZkPVRydWUpXG5cbiIgKwogICAgICAgICAgICBvcGVuLl9fZG9jX18pCgpjbGFzcyBPcGVuV3JhcHBlcjoKICAgIF9fZG9jX18gPSBEb2NEZXNjcmlwdG9yKCkKCiAgICBkZWYgX19uZXdfXyhjbHMsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgcmV0dXJuIG9wZW4oKmFyZ3MsICoqa3dhcmdzKQoKCiMgSW4gbm9ybWFsIG9wZXJhdGlvbiwgYm90aCBgVW5zdXBwb3J0ZWRPcGVyYXRpb25gcyBzaG91bGQgYmUgYm91bmQgdG8gdGhlCiMgc2FtZSBvYmplY3QuCiN0cnk6CiAgICAjQkUgY29tbWVudGVkIHRoaXMgb3V0IHNpbmNlIHdlIGFyZSBub3QgaW1wb3J0aW5nIGlvIG1vZHVsZQogICAgI1Vuc3VwcG9ydGVkT3BlcmF0aW9uID0gaW8uVW5zdXBwb3J0ZWRPcGVyYXRpb24KICAgIHBhc3MKI2V4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKY2xhc3MgVW5zdXBwb3J0ZWRPcGVyYXRpb24oVmFsdWVFcnJvciwgSU9FcnJvcik6CiAgIHBhc3MKCgojY2xhc3MgSU9CYXNlKG1ldGFjbGFzcz1hYmMuQUJDTWV0YSk6ICAgI2ZpeG1lCmNsYXNzIElPQmFzZToKCiAgICAjIyMgSW50ZXJuYWwgIyMjCgogICAgZGVmIF91bnN1cHBvcnRlZChzZWxmLCBuYW1lKToKICAgICAgICAiSW50ZXJuYWw6IHJhaXNlIGFuIElPRXJyb3IgZXhjZXB0aW9uIGZvciB1bnN1cHBvcnRlZCBvcGVyYXRpb25zLiIKICAgICAgICByYWlzZSBVbnN1cHBvcnRlZE9wZXJhdGlvbigiJXMuJXMoKSBub3Qgc3VwcG9ydGVkIiAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLCBuYW1lKSkKCiAgICAjIyMgUG9zaXRpb25pbmcgIyMjCgogICAgZGVmIHNlZWsoc2VsZiwgcG9zLCB3aGVuY2U9MCk6CiAgICAgICAgc2VsZi5fdW5zdXBwb3J0ZWQoInNlZWsiKQoKICAgIGRlZiB0ZWxsKHNlbGYpOgogICAgICAgICJSZXR1cm4gYW4gaW50IGluZGljYXRpbmcgdGhlIGN1cnJlbnQgc3RyZWFtIHBvc2l0aW9uLiIKICAgICAgICByZXR1cm4gc2VsZi5zZWVrKDAsIDEpCgogICAgZGVmIHRydW5jYXRlKHNlbGYsIHBvcz1Ob25lKToKICAgICAgICAjIlRydW5jYXRlIGZpbGUgdG8gc2l6ZSBieXRlcy4KICAgICAgICAjCiAgICAgICAgI1NpemUgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgSU8gcG9zaXRpb24gYXMgcmVwb3J0ZWQgYnkgdGVsbCgpLiAgUmV0dXJuCiAgICAgICAgI3RoZSBuZXcgc2l6ZS4KICAgICAgICAjIgogICAgICAgIHNlbGYuX3Vuc3VwcG9ydGVkKCJ0cnVuY2F0ZSIpCgogICAgIyMjIEZsdXNoIGFuZCBjbG9zZSAjIyMKCiAgICBkZWYgZmx1c2goc2VsZik6CiAgICAgICAgIyJGbHVzaCB3cml0ZSBidWZmZXJzLCBpZiBhcHBsaWNhYmxlLgogICAgICAgICMKICAgICAgICAjVGhpcyBpcyBub3QgaW1wbGVtZW50ZWQgZm9yIHJlYWQtb25seSBhbmQgbm9uLWJsb2NraW5nIHN0cmVhbXMuCiAgICAgICAgIyIKICAgICAgICBzZWxmLl9jaGVja0Nsb3NlZCgpCiAgICAgICAgIyBYWFggU2hvdWxkIHRoaXMgcmV0dXJuIHRoZSBudW1iZXIgb2YgYnl0ZXMgd3JpdHRlbj8/PwoKICAgIF9fY2xvc2VkID0gRmFsc2UKCiAgICBkZWYgY2xvc2Uoc2VsZik6CiAgICAgICAgIyJGbHVzaCBhbmQgY2xvc2UgdGhlIElPIG9iamVjdC4KCiAgICAgICAgI1RoaXMgbWV0aG9kIGhhcyBubyBlZmZlY3QgaWYgdGhlIGZpbGUgaXMgYWxyZWFkeSBjbG9zZWQuCiAgICAgICAgIyIKICAgICAgICBpZiBub3Qgc2VsZi5fX2Nsb3NlZDoKICAgICAgICAgICAgc2VsZi5mbHVzaCgpCiAgICAgICAgICAgIHNlbGYuX19jbG9zZWQgPSBUcnVlCgogICAgZGVmIF9fZGVsX18oc2VsZik6CiAgICAgICAgIyJEZXN0cnVjdG9yLiAgQ2FsbHMgY2xvc2UoKS4iCiAgICAgICAgIyBUaGUgdHJ5L2V4Y2VwdCBibG9jayBpcyBpbiBjYXNlIHRoaXMgaXMgY2FsbGVkIGF0IHByb2dyYW0KICAgICAgICAjIGV4aXQgdGltZSwgd2hlbiBpdCdzIHBvc3NpYmxlIHRoYXQgZ2xvYmFscyBoYXZlIGFscmVhZHkgYmVlbgogICAgICAgICMgZGVsZXRlZCwgYW5kIHRoZW4gdGhlIGNsb3NlKCkgY2FsbCBtaWdodCBmYWlsLiAgU2luY2UKICAgICAgICAjIHRoZXJlJ3Mgbm90aGluZyB3ZSBjYW4gZG8gYWJvdXQgc3VjaCBmYWlsdXJlcyBhbmQgdGhleSBhbm5veQogICAgICAgICMgdGhlIGVuZCB1c2Vycywgd2Ugc3VwcHJlc3MgdGhlIHRyYWNlYmFjay4KICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuY2xvc2UoKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwoKICAgICMjIyBJbnF1aXJpZXMgIyMjCgogICAgZGVmIHNlZWthYmxlKHNlbGYpOgogICAgICAgICMiUmV0dXJuIGEgYm9vbCBpbmRpY2F0aW5nIHdoZXRoZXIgb2JqZWN0IHN1cHBvcnRzIHJhbmRvbSBhY2Nlc3MuCiAgICAgICAgIwogICAgICAgICNJZiBGYWxzZSwgc2VlaygpLCB0ZWxsKCkgYW5kIHRydW5jYXRlKCkgd2lsbCByYWlzZSBVbnN1cHBvcnRlZE9wZXJhdGlvbi4KICAgICAgICAjVGhpcyBtZXRob2QgbWF5IG5lZWQgdG8gZG8gYSB0ZXN0IHNlZWsoKS4KICAgICAgICAjIgogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBfY2hlY2tTZWVrYWJsZShzZWxmLCBtc2c9Tm9uZSk6CiAgICAgICAgIyJJbnRlcm5hbDogcmFpc2UgVW5zdXBwb3J0ZWRPcGVyYXRpb24gaWYgZmlsZSBpcyBub3Qgc2Vla2FibGUKICAgICAgICAjIgogICAgICAgIGlmIG5vdCBzZWxmLnNlZWthYmxlKCk6CiAgICAgICAgICAgIHJhaXNlIFVuc3VwcG9ydGVkT3BlcmF0aW9uKCJGaWxlIG9yIHN0cmVhbSBpcyBub3Qgc2Vla2FibGUuIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBtc2cgaXMgTm9uZSBlbHNlIG1zZykKCiAgICBkZWYgcmVhZGFibGUoc2VsZik6CiAgICAgICAgIyJSZXR1cm4gYSBib29sIGluZGljYXRpbmcgd2hldGhlciBvYmplY3Qgd2FzIG9wZW5lZCBmb3IgcmVhZGluZy4KCiAgICAgICAgI0lmIEZhbHNlLCByZWFkKCkgd2lsbCByYWlzZSBVbnN1cHBvcnRlZE9wZXJhdGlvbi4KICAgICAgICAjIgogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBfY2hlY2tSZWFkYWJsZShzZWxmLCBtc2c9Tm9uZSk6CiAgICAgICAgIyJJbnRlcm5hbDogcmFpc2UgVW5zdXBwb3J0ZWRPcGVyYXRpb24gaWYgZmlsZSBpcyBub3QgcmVhZGFibGUKICAgICAgICAjIgogICAgICAgIGlmIG5vdCBzZWxmLnJlYWRhYmxlKCk6CiAgICAgICAgICAgIHJhaXNlIFVuc3VwcG9ydGVkT3BlcmF0aW9uKCJGaWxlIG9yIHN0cmVhbSBpcyBub3QgcmVhZGFibGUuIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBtc2cgaXMgTm9uZSBlbHNlIG1zZykKCiAgICBkZWYgd3JpdGFibGUoc2VsZik6CiAgICAgICAgIyJSZXR1cm4gYSBib29sIGluZGljYXRpbmcgd2hldGhlciBvYmplY3Qgd2FzIG9wZW5lZCBmb3Igd3JpdGluZy4KCiAgICAgICAgI0lmIEZhbHNlLCB3cml0ZSgpIGFuZCB0cnVuY2F0ZSgpIHdpbGwgcmFpc2UgVW5zdXBwb3J0ZWRPcGVyYXRpb24uCiAgICAgICAgIyIKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgX2NoZWNrV3JpdGFibGUoc2VsZiwgbXNnPU5vbmUpOgogICAgICAgICMiSW50ZXJuYWw6IHJhaXNlIFVuc3VwcG9ydGVkT3BlcmF0aW9uIGlmIGZpbGUgaXMgbm90IHdyaXRhYmxlCiAgICAgICAgIyIKICAgICAgICBpZiBub3Qgc2VsZi53cml0YWJsZSgpOgogICAgICAgICAgICByYWlzZSBVbnN1cHBvcnRlZE9wZXJhdGlvbigiRmlsZSBvciBzdHJlYW0gaXMgbm90IHdyaXRhYmxlLiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbXNnIGlzIE5vbmUgZWxzZSBtc2cpCgogICAgIyMgZml4bWUuLiAgd2UgbmVlZCB0byBpbXBsZW1lbnQgcHJvcGVydHkgdmlhIGRlY29yYXRvcnMuCiAgICAjIyBAcHJvcGVydHkKICAgIGRlZiBjbG9zZWQoc2VsZik6CiAgICAgICAgIyJjbG9zZWQ6IGJvb2wuICBUcnVlIGlmZiB0aGUgZmlsZSBoYXMgYmVlbiBjbG9zZWQuCgogICAgICAgICNGb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHksIHRoaXMgaXMgYSBwcm9wZXJ0eSwgbm90IGEgcHJlZGljYXRlLgogICAgICAgICMiCiAgICAgICAgcmV0dXJuIHNlbGYuX19jbG9zZWQKCiAgICBkZWYgX2NoZWNrQ2xvc2VkKHNlbGYsIG1zZz1Ob25lKToKICAgICAgICAjIkludGVybmFsOiByYWlzZSBhbiBWYWx1ZUVycm9yIGlmIGZpbGUgaXMgY2xvc2VkCiAgICAgICAgIyIKICAgICAgICBpZiBzZWxmLmNsb3NlZDoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiSS9PIG9wZXJhdGlvbiBvbiBjbG9zZWQgZmlsZS4iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbXNnIGlzIE5vbmUgZWxzZSBtc2cpCgogICAgIyMjIENvbnRleHQgbWFuYWdlciAjIyMKCiAgICBkZWYgX19lbnRlcl9fKHNlbGYpOiAgIyBUaGF0J3MgYSBmb3J3YXJkIHJlZmVyZW5jZQogICAgICAgICMiQ29udGV4dCBtYW5hZ2VtZW50IHByb3RvY29sLiAgUmV0dXJucyBzZWxmIChhbiBpbnN0YW5jZSBvZiBJT0Jhc2UpIgogICAgICAgIHNlbGYuX2NoZWNrQ2xvc2VkKCkKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX2V4aXRfXyhzZWxmLCAqYXJncyk6CiAgICAgICAgIyJDb250ZXh0IG1hbmFnZW1lbnQgcHJvdG9jb2wuICBDYWxscyBjbG9zZSgpIgogICAgICAgIHNlbGYuY2xvc2UoKQoKICAgICMjIyBMb3dlci1sZXZlbCBBUElzICMjIwoKICAgICMgWFhYIFNob3VsZCB0aGVzZSBiZSBwcmVzZW50IGV2ZW4gaWYgdW5pbXBsZW1lbnRlZD8KCiAgICBkZWYgZmlsZW5vKHNlbGYpOgogICAgICAgICMiUmV0dXJucyB1bmRlcmx5aW5nIGZpbGUgZGVzY3JpcHRvciAoYW4gaW50KSBpZiBvbmUgZXhpc3RzLgoKICAgICAgICAjQW4gSU9FcnJvciBpcyByYWlzZWQgaWYgdGhlIElPIG9iamVjdCBkb2VzIG5vdCB1c2UgYSBmaWxlIGRlc2NyaXB0b3IuCiAgICAgICAgIyIKICAgICAgICBzZWxmLl91bnN1cHBvcnRlZCgiZmlsZW5vIikKCiAgICBkZWYgaXNhdHR5KHNlbGYpOgogICAgICAgICMiUmV0dXJuIGEgYm9vbCBpbmRpY2F0aW5nIHdoZXRoZXIgdGhpcyBpcyBhbiAnaW50ZXJhY3RpdmUnIHN0cmVhbS4KCiAgICAgICAgI1JldHVybiBGYWxzZSBpZiBpdCBjYW4ndCBiZSBkZXRlcm1pbmVkLgogICAgICAgICMiCiAgICAgICAgc2VsZi5fY2hlY2tDbG9zZWQoKQogICAgICAgIHJldHVybiBGYWxzZQoKICAgICMjIyBSZWFkbGluZVtzXSBhbmQgd3JpdGVsaW5lcyAjIyMKCiAgICBkZWYgcmVhZGxpbmUoc2VsZiwgbGltaXQ9LTEpOgogICAgICAgICMgRm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5LCBhIChzbG93aXNoKSByZWFkbGluZSgpLgogICAgICAgIGlmIGhhc2F0dHIoc2VsZiwgInBlZWsiKToKICAgICAgICAgICAgZGVmIG5yZWFkYWhlYWQoKToKICAgICAgICAgICAgICAgIHJlYWRhaGVhZCA9IHNlbGYucGVlaygxKQogICAgICAgICAgICAgICAgaWYgbm90IHJlYWRhaGVhZDoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gMQogICAgICAgICAgICAgICAgI24gPSAocmVhZGFoZWFkLmZpbmQoYiJcbiIpICsgMSkgb3IgbGVuKHJlYWRhaGVhZCkgI2ZpeG1lCiAgICAgICAgICAgICAgICBuID0gKHJlYWRhaGVhZC5maW5kKCJcbiIpICsgMSkgb3IgbGVuKHJlYWRhaGVhZCkKICAgICAgICAgICAgICAgIGlmIGxpbWl0ID49IDA6CiAgICAgICAgICAgICAgICAgICAgbiA9IG1pbihuLCBsaW1pdCkKICAgICAgICAgICAgICAgIHJldHVybiBuCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZGVmIG5yZWFkYWhlYWQoKToKICAgICAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgaWYgbGltaXQgaXMgTm9uZToKICAgICAgICAgICAgbGltaXQgPSAtMQogICAgICAgIGVsaWYgbm90IGlzaW5zdGFuY2UobGltaXQsIGludCk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigibGltaXQgbXVzdCBiZSBhbiBpbnRlZ2VyIikKICAgICAgICByZXMgPSBieXRlYXJyYXkoKQogICAgICAgIHdoaWxlIGxpbWl0IDwgMCBvciBsZW4ocmVzKSA8IGxpbWl0OgogICAgICAgICAgICBiID0gc2VsZi5yZWFkKG5yZWFkYWhlYWQoKSkKICAgICAgICAgICAgaWYgbm90IGI6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICByZXMgKz0gYgogICAgICAgICAgICAjaWYgcmVzLmVuZHN3aXRoKGIiXG4iKTogICNmaXhtZQogICAgICAgICAgICBpZiByZXMuZW5kc3dpdGgoIlxuIik6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgIHJldHVybiBieXRlcyhyZXMpCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHNlbGYuX2NoZWNrQ2xvc2VkKCkKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBfX25leHRfXyhzZWxmKToKICAgICAgICBsaW5lID0gc2VsZi5yZWFkbGluZSgpCiAgICAgICAgaWYgbm90IGxpbmU6CiAgICAgICAgICAgIHJhaXNlIFN0b3BJdGVyYXRpb24KICAgICAgICByZXR1cm4gbGluZQoKICAgIGRlZiByZWFkbGluZXMoc2VsZiwgaGludD1Ob25lKToKICAgICAgICAjIlJldHVybiBhIGxpc3Qgb2YgbGluZXMgZnJvbSB0aGUgc3RyZWFtLgoKICAgICAgICAjaGludCBjYW4gYmUgc3BlY2lmaWVkIHRvIGNvbnRyb2wgdGhlIG51bWJlciBvZiBsaW5lcyByZWFkOiBubyBtb3JlCiAgICAgICAgI2xpbmVzIHdpbGwgYmUgcmVhZCBpZiB0aGUgdG90YWwgc2l6ZSAoaW4gYnl0ZXMvY2hhcmFjdGVycykgb2YgYWxsCiAgICAgICAgI2xpbmVzIHNvIGZhciBleGNlZWRzIGhpbnQuCiAgICAgICAgIyIKICAgICAgICBpZiBoaW50IGlzIE5vbmUgb3IgaGludCA8PSAwOgogICAgICAgICAgICByZXR1cm4gbGlzdChzZWxmKQogICAgICAgIG4gPSAwCiAgICAgICAgbGluZXMgPSBbXQogICAgICAgIGZvciBsaW5lIGluIHNlbGY6CiAgICAgICAgICAgIGxpbmVzLmFwcGVuZChsaW5lKQogICAgICAgICAgICBuICs9IGxlbihsaW5lKQogICAgICAgICAgICBpZiBuID49IGhpbnQ6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgIHJldHVybiBsaW5lcwoKICAgIGRlZiB3cml0ZWxpbmVzKHNlbGYsIGxpbmVzKToKICAgICAgICBzZWxmLl9jaGVja0Nsb3NlZCgpCiAgICAgICAgZm9yIGxpbmUgaW4gbGluZXM6CiAgICAgICAgICAgIHNlbGYud3JpdGUobGluZSkKCiNCRSBjb21tZW50aW5nIHRoaXMgb3V0IGZvciBub3cuCiNpby5JT0Jhc2UucmVnaXN0ZXIoSU9CYXNlKQoKY2xhc3MgUmF3SU9CYXNlKElPQmFzZSk6CiAgICBkZWYgcmVhZChzZWxmLCBuPS0xKToKICAgICAgICAjIlJlYWQgYW5kIHJldHVybiB1cCB0byBuIGJ5dGVzLCB3aGVyZSBuIGlzIGFuIGludC4KCiAgICAgICAgI1JldHVybnMgYW4gZW1wdHkgYnl0ZXMgb2JqZWN0IG9uIEVPRiwgb3IgTm9uZSBpZiB0aGUgb2JqZWN0IGlzCiAgICAgICAgIyNzZXQgbm90IHRvIGJsb2NrIGFuZCBoYXMgbm8gZGF0YSB0byByZWFkLgogICAgICAgICMiCiAgICAgICAgaWYgbiBpcyBOb25lOgogICAgICAgICAgICBuID0gLTEKICAgICAgICBpZiBuIDwgMDoKICAgICAgICAgICAgcmV0dXJuIHNlbGYucmVhZGFsbCgpCiAgICAgICAgYiA9IGJ5dGVhcnJheShuLl9faW5kZXhfXygpKQogICAgICAgIG4gPSBzZWxmLnJlYWRpbnRvKGIpCiAgICAgICAgaWYgbiBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIGRlbCBiW246XQogICAgICAgIHJldHVybiBieXRlcyhiKQoKICAgIGRlZiByZWFkYWxsKHNlbGYpOgogICAgICAgICMiUmVhZCB1bnRpbCBFT0YsIHVzaW5nIG11bHRpcGxlIHJlYWQoKSBjYWxsLiIKICAgICAgICByZXMgPSBieXRlYXJyYXkoKQogICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgIGRhdGEgPSBzZWxmLnJlYWQoREVGQVVMVF9CVUZGRVJfU0laRSkKICAgICAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICByZXMgKz0gZGF0YQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIGJ5dGVzKHJlcykKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIGInJyBvciBOb25lCiAgICAgICAgICAgIHJldHVybiBkYXRhCgogICAgZGVmIHJlYWRpbnRvKHNlbGYsIGIpOgogICAgICAgICMiUmVhZCB1cCB0byBsZW4oYikgYnl0ZXMgaW50byBieXRlYXJyYXkgIgoKICAgICAgICAjUmV0dXJucyBhbiBpbnQgcmVwcmVzZW50aW5nIHRoZSBudW1iZXIgb2YgYnl0ZXMgcmVhZCAoMCBmb3IgRU9GKSwgb3IKICAgICAgICAjTm9uZSBpZiB0aGUgb2JqZWN0IGlzIHNldCBub3QgdG8gYmxvY2sgYW5kIGhhcyBubyBkYXRhIHRvIHJlYWQuCiAgICAgICAgIyIKICAgICAgICBzZWxmLl91bnN1cHBvcnRlZCgicmVhZGludG8iKQoKICAgIGRlZiB3cml0ZShzZWxmLCBiKToKICAgICAgICAjIldyaXRlIHRoZSBnaXZlbiBidWZmZXIgdG8gdGhlIElPIHN0cmVhbS4KCiAgICAgICAgI1JldHVybnMgdGhlIG51bWJlciBvZiBieXRlcyB3cml0dGVuLCB3aGljaCBtYXkgYmUgbGVzcyB0aGFuIGxlbihiKS4KICAgICAgICAjIgogICAgICAgIHNlbGYuX3Vuc3VwcG9ydGVkKCJ3cml0ZSIpCgojQkUgY29tbWVudGluZyB0aGlzIG91dAojaW8uUmF3SU9CYXNlLnJlZ2lzdGVyKFJhd0lPQmFzZSkKI2Zyb20gX2lvIGltcG9ydCBGaWxlSU8KCmNsYXNzIEZpbGVJTyhSYXdJT0Jhc2UpOgogIHBhc3MKI1Jhd0lPQmFzZS5yZWdpc3RlcihGaWxlSU8pCgpjbGFzcyBCdWZmZXJlZElPQmFzZShJT0Jhc2UpOgoKICAgICMiQmFzZSBjbGFzcyBmb3IgYnVmZmVyZWQgSU8gb2JqZWN0cy4KCiAgICAjVGhlIG1haW4gZGlmZmVyZW5jZSB3aXRoIFJhd0lPQmFzZSBpcyB0aGF0IHRoZSByZWFkKCkgbWV0aG9kCiAgICAjc3VwcG9ydHMgb21pdHRpbmcgdGhlIHNpemUgYXJndW1lbnQsIGFuZCBkb2VzIG5vdCBoYXZlIGEgZGVmYXVsdAogICAgI2ltcGxlbWVudGF0aW9uIHRoYXQgZGVmZXJzIHRvIHJlYWRpbnRvKCkuCgogICAgI0luIGFkZGl0aW9uLCByZWFkKCksIHJlYWRpbnRvKCkgYW5kIHdyaXRlKCkgbWF5IHJhaXNlCiAgICAjQmxvY2tpbmdJT0Vycm9yIGlmIHRoZSB1bmRlcmx5aW5nIHJhdyBzdHJlYW0gaXMgaW4gbm9uLWJsb2NraW5nCiAgICAjbW9kZSBhbmQgbm90IHJlYWR5OyB1bmxpa2UgdGhlaXIgcmF3IGNvdW50ZXJwYXJ0cywgdGhleSB3aWxsIG5ldmVyCiAgICAjcmV0dXJuIE5vbmUuCgogICAgI0EgdHlwaWNhbCBpbXBsZW1lbnRhdGlvbiBzaG91bGQgbm90IGluaGVyaXQgZnJvbSBhIFJhd0lPQmFzZQogICAgI2ltcGxlbWVudGF0aW9uLCBidXQgd3JhcCBvbmUuCiAgICAjIgoKICAgIGRlZiByZWFkKHNlbGYsIG49Tm9uZSk6CiAgICAgICAgIyJSZWFkIGFuZCByZXR1cm4gdXAgdG8gbiBieXRlcywgd2hlcmUgbiBpcyBhbiBpbnQuCgogICAgICAgICNJZiB0aGUgYXJndW1lbnQgaXMgb21pdHRlZCwgTm9uZSwgb3IgbmVnYXRpdmUsIHJlYWRzIGFuZAogICAgICAgICNyZXR1cm5zIGFsbCBkYXRhIHVudGlsIEVPRi4KCiAgICAgICAgI0lmIHRoZSBhcmd1bWVudCBpcyBwb3NpdGl2ZSwgYW5kIHRoZSB1bmRlcmx5aW5nIHJhdyBzdHJlYW0gaXMKICAgICAgICAjbm90ICdpbnRlcmFjdGl2ZScsIG11bHRpcGxlIHJhdyByZWFkcyBtYXkgYmUgaXNzdWVkIHRvIHNhdGlzZnkKICAgICAgICAjdGhlIGJ5dGUgY291bnQgKHVubGVzcyBFT0YgaXMgcmVhY2hlZCBmaXJzdCkuICBCdXQgZm9yCiAgICAgICAgI2ludGVyYWN0aXZlIHJhdyBzdHJlYW1zIChYWFggYW5kIGZvciBwaXBlcz8pLCBhdCBtb3N0IG9uZSByYXcKICAgICAgICAjcmVhZCB3aWxsIGJlIGlzc3VlZCwgYW5kIGEgc2hvcnQgcmVzdWx0IGRvZXMgbm90IGltcGx5IHRoYXQKICAgICAgICAjRU9GIGlzIGltbWluZW50LgoKICAgICAgICAjUmV0dXJucyBhbiBlbXB0eSBieXRlcyBhcnJheSBvbiBFT0YuCgogICAgICAgICNSYWlzZXMgQmxvY2tpbmdJT0Vycm9yIGlmIHRoZSB1bmRlcmx5aW5nIHJhdyBzdHJlYW0gaGFzIG5vCiAgICAgICAgI2RhdGEgYXQgdGhlIG1vbWVudC4KICAgICAgICAjIgogICAgICAgIHNlbGYuX3Vuc3VwcG9ydGVkKCJyZWFkIikKCiAgICBkZWYgcmVhZDEoc2VsZiwgbj1Ob25lKToKICAgICAgICAjIlJlYWQgdXAgdG8gbiBieXRlcyB3aXRoIGF0IG1vc3Qgb25lIHJlYWQoKSBzeXN0ZW0gY2FsbCwKICAgICAgICAjd2hlcmUgbiBpcyBhbiBpbnQuCiAgICAgICAgIyIKICAgICAgICBzZWxmLl91bnN1cHBvcnRlZCgicmVhZDEiKQoKICAgIGRlZiByZWFkaW50byhzZWxmLCBiKToKICAgICAgICAjIlJlYWQgdXAgdG8gbGVuKGIpIGJ5dGVzIGludG8gYnl0ZWFycmF5IGIuCgogICAgICAgICNMaWtlIHJlYWQoKSwgdGhpcyBtYXkgaXNzdWUgbXVsdGlwbGUgcmVhZHMgdG8gdGhlIHVuZGVybHlpbmcgcmF3CiAgICAgICAgI3N0cmVhbSwgdW5sZXNzIHRoZSBsYXR0ZXIgaXMgJ2ludGVyYWN0aXZlJy4KCiAgICAgICAgI1JldHVybnMgYW4gaW50IHJlcHJlc2VudGluZyB0aGUgbnVtYmVyIG9mIGJ5dGVzIHJlYWQgKDAgZm9yIEVPRikuCgogICAgICAgICNSYWlzZXMgQmxvY2tpbmdJT0Vycm9yIGlmIHRoZSB1bmRlcmx5aW5nIHJhdyBzdHJlYW0gaGFzIG5vCiAgICAgICAgI2RhdGEgYXQgdGhlIG1vbWVudC4KICAgICAgICAjIgogICAgICAgICMgWFhYIFRoaXMgb3VnaHQgdG8gd29yayB3aXRoIGFueXRoaW5nIHRoYXQgc3VwcG9ydHMgdGhlIGJ1ZmZlciBBUEkKICAgICAgICBkYXRhID0gc2VsZi5yZWFkKGxlbihiKSkKICAgICAgICBuID0gbGVuKGRhdGEpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBiWzpuXSA9IGRhdGEKICAgICAgICBleGNlcHQgVHlwZUVycm9yIGFzIGVycjoKICAgICAgICAgICAgaW1wb3J0IGFycmF5CiAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKGIsIGFycmF5LmFycmF5KToKICAgICAgICAgICAgICAgIHJhaXNlIGVycgogICAgICAgICAgICBiWzpuXSA9IGFycmF5LmFycmF5KCdiJywgZGF0YSkKICAgICAgICByZXR1cm4gbgoKICAgIGRlZiB3cml0ZShzZWxmLCBiKToKICAgICAgICAjIldyaXRlIHRoZSBnaXZlbiBieXRlcyBidWZmZXIgdG8gdGhlIElPIHN0cmVhbS4KCiAgICAgICAgI1JldHVybiB0aGUgbnVtYmVyIG9mIGJ5dGVzIHdyaXR0ZW4sIHdoaWNoIGlzIG5ldmVyIGxlc3MgdGhhbgogICAgICAgICNsZW4oYikuCgogICAgICAgICNSYWlzZXMgQmxvY2tpbmdJT0Vycm9yIGlmIHRoZSBidWZmZXIgaXMgZnVsbCBhbmQgdGhlCiAgICAgICAgI3VuZGVybHlpbmcgcmF3IHN0cmVhbSBjYW5ub3QgYWNjZXB0IG1vcmUgZGF0YSBhdCB0aGUgbW9tZW50LgogICAgICAgICMiCiAgICAgICAgc2VsZi5fdW5zdXBwb3J0ZWQoIndyaXRlIikKCiAgICBkZWYgZGV0YWNoKHNlbGYpOgogICAgICAgICMiCiAgICAgICAgI1NlcGFyYXRlIHRoZSB1bmRlcmx5aW5nIHJhdyBzdHJlYW0gZnJvbSB0aGUgYnVmZmVyIGFuZCByZXR1cm4gaXQuCgogICAgICAgICNBZnRlciB0aGUgcmF3IHN0cmVhbSBoYXMgYmVlbiBkZXRhY2hlZCwgdGhlIGJ1ZmZlciBpcyBpbiBhbiB1bnVzYWJsZQogICAgICAgICNzdGF0ZS4KICAgICAgICAjIgogICAgICAgIHNlbGYuX3Vuc3VwcG9ydGVkKCJkZXRhY2giKQoKI0JFIGNvbW1lbnRpbmcgdGhpcyBvdXQKI2lvLkJ1ZmZlcmVkSU9CYXNlLnJlZ2lzdGVyKEJ1ZmZlcmVkSU9CYXNlKQoKCmNsYXNzIF9CdWZmZXJlZElPTWl4aW4oQnVmZmVyZWRJT0Jhc2UpOgoKICAgICMiQSBtaXhpbiBpbXBsZW1lbnRhdGlvbiBvZiBCdWZmZXJlZElPQmFzZSB3aXRoIGFuIHVuZGVybHlpbmcgcmF3IHN0cmVhbS4KCiAgICAjVGhpcyBwYXNzZXMgbW9zdCByZXF1ZXN0cyBvbiB0byB0aGUgdW5kZXJseWluZyByYXcgc3RyZWFtLiAgSXQKICAgICNkb2VzICpub3QqIHByb3ZpZGUgaW1wbGVtZW50YXRpb25zIG9mIHJlYWQoKSwgcmVhZGludG8oKSBvcgogICAgI3dyaXRlKCkuCiAgICAjIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCByYXcpOgogICAgICAgIHNlbGYuX3JhdyA9IHJhdwoKICAgICMjIyBQb3NpdGlvbmluZyAjIyMKCiAgICBkZWYgc2VlayhzZWxmLCBwb3MsIHdoZW5jZT0wKToKICAgICAgICBuZXdfcG9zaXRpb24gPSBzZWxmLnJhdy5zZWVrKHBvcywgd2hlbmNlKQogICAgICAgIGlmIG5ld19wb3NpdGlvbiA8IDA6CiAgICAgICAgICAgIHJhaXNlIElPRXJyb3IoInNlZWsoKSByZXR1cm5lZCBhbiBpbnZhbGlkIHBvc2l0aW9uIikKICAgICAgICByZXR1cm4gbmV3X3Bvc2l0aW9uCgogICAgZGVmIHRlbGwoc2VsZik6CiAgICAgICAgcG9zID0gc2VsZi5yYXcudGVsbCgpCiAgICAgICAgaWYgcG9zIDwgMDoKICAgICAgICAgICAgcmFpc2UgSU9FcnJvcigidGVsbCgpIHJldHVybmVkIGFuIGludmFsaWQgcG9zaXRpb24iKQogICAgICAgIHJldHVybiBwb3MKCiAgICBkZWYgdHJ1bmNhdGUoc2VsZiwgcG9zPU5vbmUpOgogICAgICAgICMgRmx1c2ggdGhlIHN0cmVhbS4gIFdlJ3JlIG1peGluZyBidWZmZXJlZCBJL08gd2l0aCBsb3dlci1sZXZlbCBJL08sCiAgICAgICAgIyBhbmQgYSBmbHVzaCBtYXkgYmUgbmVjZXNzYXJ5IHRvIHN5bmNoIGJvdGggdmlld3Mgb2YgdGhlIGN1cnJlbnQKICAgICAgICAjIGZpbGUgc3RhdGUuCiAgICAgICAgc2VsZi5mbHVzaCgpCgogICAgICAgIGlmIHBvcyBpcyBOb25lOgogICAgICAgICAgICBwb3MgPSBzZWxmLnRlbGwoKQogICAgICAgICMgWFhYOiBTaG91bGQgc2VlaygpIGJlIHVzZWQsIGluc3RlYWQgb2YgcGFzc2luZyB0aGUgcG9zaXRpb24KICAgICAgICAjIFhYWCAgZGlyZWN0bHkgdG8gdHJ1bmNhdGU/CiAgICAgICAgcmV0dXJuIHNlbGYucmF3LnRydW5jYXRlKHBvcykKCiAgICAjIyMgRmx1c2ggYW5kIGNsb3NlICMjIwoKICAgIGRlZiBmbHVzaChzZWxmKToKICAgICAgICBpZiBzZWxmLmNsb3NlZDoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiZmx1c2ggb2YgY2xvc2VkIGZpbGUiKQogICAgICAgIHNlbGYucmF3LmZsdXNoKCkKCiAgICBkZWYgY2xvc2Uoc2VsZik6CiAgICAgICAgaWYgc2VsZi5yYXcgaXMgbm90IE5vbmUgYW5kIG5vdCBzZWxmLmNsb3NlZDoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VsZi5mbHVzaCgpICAgI2ZpeCBtZQogICAgICAgICAgICAgICAgIyBtYXkgcmFpc2UgQmxvY2tpbmdJT0Vycm9yIG9yIEJyb2tlblBpcGVFcnJvciBldGMKICAgICAgICAgICAgI2V4Y2VwdDogICAgI2ZpeG1lCQkKICAgICAgICAgICAgIyAgICBhPTEgICAgI2ZpeG1lCiAgICAgICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgICAgICBzZWxmLnJhdy5jbG9zZSgpCgogICAgZGVmIGRldGFjaChzZWxmKToKICAgICAgICBpZiBzZWxmLnJhdyBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJyYXcgc3RyZWFtIGFscmVhZHkgZGV0YWNoZWQiKQogICAgICAgIHNlbGYuZmx1c2goKQogICAgICAgIHJhdyA9IHNlbGYuX3JhdwogICAgICAgIHNlbGYuX3JhdyA9IE5vbmUKICAgICAgICByZXR1cm4gcmF3CgogICAgIyMjIElucXVpcmllcyAjIyMKCiAgICBkZWYgc2Vla2FibGUoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYucmF3LnNlZWthYmxlKCkKCiAgICBkZWYgcmVhZGFibGUoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYucmF3LnJlYWRhYmxlKCkKCiAgICBkZWYgd3JpdGFibGUoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYucmF3LndyaXRhYmxlKCkKCiAgICAjQHByb3BlcnR5CiAgICBkZWYgcmF3KHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9yYXcKCiAgICAjQHByb3BlcnR5CiAgICBkZWYgY2xvc2VkKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLnJhdy5jbG9zZWQKCiAgICAjQHByb3BlcnR5CiAgICBkZWYgbmFtZShzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5yYXcubmFtZQoKICAgICNAcHJvcGVydHkKICAgIGRlZiBtb2RlKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLnJhdy5tb2RlCgogICAgZGVmIF9fZ2V0c3RhdGVfXyhzZWxmKToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoImNhbiBub3Qgc2VyaWFsaXplIGEgJ3swfScgb2JqZWN0IgogICAgICAgICAgICAgICAgICAgICAgICAuZm9ybWF0KHNlbGYuX19jbGFzc19fLl9fbmFtZV9fKSkKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgY2xzbmFtZSA9IHNlbGYuX19jbGFzc19fLl9fbmFtZV9fCiAgICAgICAgdHJ5OgogICAgICAgICAgICBuYW1lID0gc2VsZi5uYW1lCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICByZXR1cm4gIjxfcHlpby57MH0+Ii5mb3JtYXQoY2xzbmFtZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gIjxfcHlpby57MH0gbmFtZT17MSFyfT4iLmZvcm1hdChjbHNuYW1lLCBuYW1lKQoKICAgICMjIyBMb3dlci1sZXZlbCBBUElzICMjIwoKICAgIGRlZiBmaWxlbm8oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYucmF3LmZpbGVubygpCgogICAgZGVmIGlzYXR0eShzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5yYXcuaXNhdHR5KCkKCmNsYXNzIEJ5dGVzSU8oQnVmZmVyZWRJT0Jhc2UpOgoKICAgICMiQnVmZmVyZWQgSS9PIGltcGxlbWVudGF0aW9uIHVzaW5nIGFuIGluLW1lbW9yeSBieXRlcyBidWZmZXIuIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpbml0aWFsX2J5dGVzPU5vbmUpOgogICAgICAgIGJ1ZiA9IGJ5dGVhcnJheSgpCiAgICAgICAgaWYgaW5pdGlhbF9ieXRlcyBpcyBub3QgTm9uZToKICAgICAgICAgICAgYnVmICs9IGluaXRpYWxfYnl0ZXMKICAgICAgICBzZWxmLl9idWZmZXIgPSBidWYKICAgICAgICBzZWxmLl9wb3MgPSAwCgogICAgZGVmIF9fZ2V0c3RhdGVfXyhzZWxmKToKICAgICAgICBpZiBzZWxmLmNsb3NlZDoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiX19nZXRzdGF0ZV9fIG9uIGNsb3NlZCBmaWxlIikKICAgICAgICByZXR1cm4gc2VsZi5fX2RpY3RfXy5jb3B5KCkKCiAgICBkZWYgZ2V0dmFsdWUoc2VsZik6CiAgICAgICAgIyJSZXR1cm4gdGhlIGJ5dGVzIHZhbHVlIChjb250ZW50cykgb2YgdGhlIGJ1ZmZlcgogICAgICAgICMiCiAgICAgICAgaWYgc2VsZi5jbG9zZWQ6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImdldHZhbHVlIG9uIGNsb3NlZCBmaWxlIikKICAgICAgICByZXR1cm4gYnl0ZXMoc2VsZi5fYnVmZmVyKQoKICAgIGRlZiBnZXRidWZmZXIoc2VsZik6CiAgICAgICAgIyJSZXR1cm4gYSByZWFkYWJsZSBhbmQgd3JpdGFibGUgdmlldyBvZiB0aGUgYnVmZmVyLgogICAgICAgICMiCiAgICAgICAgcmV0dXJuIG1lbW9yeXZpZXcoc2VsZi5fYnVmZmVyKQoKICAgIGRlZiByZWFkKHNlbGYsIG49Tm9uZSk6CiAgICAgICAgaWYgc2VsZi5jbG9zZWQ6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoInJlYWQgZnJvbSBjbG9zZWQgZmlsZSIpCiAgICAgICAgaWYgbiBpcyBOb25lOgogICAgICAgICAgICBuID0gLTEKICAgICAgICBpZiBuIDwgMDoKICAgICAgICAgICAgbiA9IGxlbihzZWxmLl9idWZmZXIpCiAgICAgICAgaWYgbGVuKHNlbGYuX2J1ZmZlcikgPD0gc2VsZi5fcG9zOgogICAgICAgICAgICByZXR1cm4gIiIKICAgICAgICBuZXdwb3MgPSBtaW4obGVuKHNlbGYuX2J1ZmZlciksIHNlbGYuX3BvcyArIG4pCiAgICAgICAgYiA9IHNlbGYuX2J1ZmZlcltzZWxmLl9wb3MgOiBuZXdwb3NdCiAgICAgICAgc2VsZi5fcG9zID0gbmV3cG9zCiAgICAgICAgcmV0dXJuIGJ5dGVzKGIpCgogICAgZGVmIHJlYWQxKHNlbGYsIG4pOgogICAgICAgICMiVGhpcyBpcyB0aGUgc2FtZSBhcyByZWFkLgogICAgICAgICMiCiAgICAgICAgcmV0dXJuIHNlbGYucmVhZChuKQoKICAgIGRlZiB3cml0ZShzZWxmLCBiKToKICAgICAgICBpZiBzZWxmLmNsb3NlZDoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigid3JpdGUgdG8gY2xvc2VkIGZpbGUiKQogICAgICAgIGlmIGlzaW5zdGFuY2UoYiwgc3RyKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJjYW4ndCB3cml0ZSBzdHIgdG8gYmluYXJ5IHN0cmVhbSIpCiAgICAgICAgbiA9IGxlbihiKQogICAgICAgIGlmIG4gPT0gMDoKICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICBwb3MgPSBzZWxmLl9wb3MKICAgICAgICBpZiBwb3MgPiBsZW4oc2VsZi5fYnVmZmVyKToKICAgICAgICAgICAgIyBJbnNlcnRzIG51bGwgYnl0ZXMgYmV0d2VlbiB0aGUgY3VycmVudCBlbmQgb2YgdGhlIGZpbGUKICAgICAgICAgICAgIyBhbmQgdGhlIG5ldyB3cml0ZSBwb3NpdGlvbi4KICAgICAgICAgICAgI3BhZGRpbmcgPSBiJ1x4MDAnICogKHBvcyAtIGxlbihzZWxmLl9idWZmZXIpKSAgICNmaXhtZQogICAgICAgICAgICBwYWRkaW5nID0gJ1x4MDAnICogKHBvcyAtIGxlbihzZWxmLl9idWZmZXIpKQogICAgICAgICAgICBzZWxmLl9idWZmZXIgKz0gcGFkZGluZwogICAgICAgIHNlbGYuX2J1ZmZlcltwb3M6cG9zICsgbl0gPSBiCiAgICAgICAgc2VsZi5fcG9zICs9IG4KICAgICAgICByZXR1cm4gbgoKICAgIGRlZiBzZWVrKHNlbGYsIHBvcywgd2hlbmNlPTApOgogICAgICAgIGlmIHNlbGYuY2xvc2VkOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJzZWVrIG9uIGNsb3NlZCBmaWxlIikKICAgICAgICB0cnk6CiAgICAgICAgICAgIHBvcy5fX2luZGV4X18KICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3IgYXMgZXJyOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImFuIGludGVnZXIgaXMgcmVxdWlyZWQiKSAjZnJvbSBlcnIgZml4bWUKICAgICAgICBpZiB3aGVuY2UgPT0gMDoKICAgICAgICAgICAgaWYgcG9zIDwgMDoKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIm5lZ2F0aXZlIHNlZWsgcG9zaXRpb24gJXIiICUgKHBvcywpKQogICAgICAgICAgICBzZWxmLl9wb3MgPSBwb3MKICAgICAgICBlbGlmIHdoZW5jZSA9PSAxOgogICAgICAgICAgICBzZWxmLl9wb3MgPSBtYXgoMCwgc2VsZi5fcG9zICsgcG9zKQogICAgICAgIGVsaWYgd2hlbmNlID09IDI6CiAgICAgICAgICAgIHNlbGYuX3BvcyA9IG1heCgwLCBsZW4oc2VsZi5fYnVmZmVyKSArIHBvcykKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJpbnZhbGlkIHdoZW5jZSB2YWx1ZSIpCiAgICAgICAgcmV0dXJuIHNlbGYuX3BvcwoKICAgIGRlZiB0ZWxsKHNlbGYpOgogICAgICAgIGlmIHNlbGYuY2xvc2VkOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJ0ZWxsIG9uIGNsb3NlZCBmaWxlIikKICAgICAgICByZXR1cm4gc2VsZi5fcG9zCgogICAgZGVmIHRydW5jYXRlKHNlbGYsIHBvcz1Ob25lKToKICAgICAgICBpZiBzZWxmLmNsb3NlZDoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigidHJ1bmNhdGUgb24gY2xvc2VkIGZpbGUiKQogICAgICAgIGlmIHBvcyBpcyBOb25lOgogICAgICAgICAgICBwb3MgPSBzZWxmLl9wb3MKICAgICAgICBlbHNlOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBwb3MuX19pbmRleF9fCiAgICAgICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvciBhcyBlcnI6CiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImFuIGludGVnZXIgaXMgcmVxdWlyZWQiKSAjZnJvbSBlcnIgI2ZpeG1lCiAgICAgICAgICAgIGlmIHBvcyA8IDA6CiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJuZWdhdGl2ZSB0cnVuY2F0ZSBwb3NpdGlvbiAlciIgJSAocG9zLCkpCiAgICAgICAgZGVsIHNlbGYuX2J1ZmZlcltwb3M6XQogICAgICAgIHJldHVybiBwb3MKCiAgICBkZWYgcmVhZGFibGUoc2VsZik6CiAgICAgICAgaWYgc2VsZi5jbG9zZWQ6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIkkvTyBvcGVyYXRpb24gb24gY2xvc2VkIGZpbGUuIikKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiB3cml0YWJsZShzZWxmKToKICAgICAgICBpZiBzZWxmLmNsb3NlZDoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiSS9PIG9wZXJhdGlvbiBvbiBjbG9zZWQgZmlsZS4iKQogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIHNlZWthYmxlKHNlbGYpOgogICAgICAgIGlmIHNlbGYuY2xvc2VkOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJJL08gb3BlcmF0aW9uIG9uIGNsb3NlZCBmaWxlLiIpCiAgICAgICAgcmV0dXJuIFRydWUKCgpjbGFzcyBCdWZmZXJlZFJlYWRlcihfQnVmZmVyZWRJT01peGluKToKCiAgICAjIkJ1ZmZlcmVkUmVhZGVyKHJhd1ssIGJ1ZmZlcl9zaXplXSkKCiAgICAjQSBidWZmZXIgZm9yIGEgcmVhZGFibGUsIHNlcXVlbnRpYWwgQmFzZVJhd0lPIG9iamVjdC4KCiAgICAjVGhlIGNvbnN0cnVjdG9yIGNyZWF0ZXMgYSBCdWZmZXJlZFJlYWRlciBmb3IgdGhlIGdpdmVuIHJlYWRhYmxlIHJhdwogICAgI3N0cmVhbSBhbmQgYnVmZmVyX3NpemUuIElmIGJ1ZmZlcl9zaXplIGlzIG9taXR0ZWQsIERFRkFVTFRfQlVGRkVSX1NJWkUKICAgICNpcyB1c2VkLgogICAgIyIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgcmF3LCBidWZmZXJfc2l6ZT1ERUZBVUxUX0JVRkZFUl9TSVpFKToKICAgICAgICAjIkNyZWF0ZSBhIG5ldyBidWZmZXJlZCByZWFkZXIgdXNpbmcgdGhlIGdpdmVuIHJlYWRhYmxlIHJhdyBJTyBvYmplY3QuCiAgICAgICAgIyIKICAgICAgICBpZiBub3QgcmF3LnJlYWRhYmxlKCk6CiAgICAgICAgICAgIHJhaXNlIElPRXJyb3IoJyJyYXciIGFyZ3VtZW50IG11c3QgYmUgcmVhZGFibGUuJykKCiAgICAgICAgX0J1ZmZlcmVkSU9NaXhpbi5fX2luaXRfXyhzZWxmLCByYXcpCiAgICAgICAgaWYgYnVmZmVyX3NpemUgPD0gMDoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiaW52YWxpZCBidWZmZXIgc2l6ZSIpCiAgICAgICAgc2VsZi5idWZmZXJfc2l6ZSA9IGJ1ZmZlcl9zaXplCiAgICAgICAgc2VsZi5fcmVzZXRfcmVhZF9idWYoKQogICAgICAgIHNlbGYuX3JlYWRfbG9jayA9IExvY2soKQoKICAgIGRlZiBfcmVzZXRfcmVhZF9idWYoc2VsZik6CiAgICAgICAgI3NlbGYuX3JlYWRfYnVmID0gYiIiICAgI2ZpeG1lCiAgICAgICAgc2VsZi5fcmVhZF9idWYgPSAiIgogICAgICAgIHNlbGYuX3JlYWRfcG9zID0gMAoKICAgIGRlZiByZWFkKHNlbGYsIG49Tm9uZSk6CiAgICAgICAgIyJSZWFkIG4gYnl0ZXMuCgogICAgICAgICNSZXR1cm5zIGV4YWN0bHkgbiBieXRlcyBvZiBkYXRhIHVubGVzcyB0aGUgdW5kZXJseWluZyByYXcgSU8KICAgICAgICAjc3RyZWFtIHJlYWNoZXMgRU9GIG9yIGlmIHRoZSBjYWxsIHdvdWxkIGJsb2NrIGluIG5vbi1ibG9ja2luZwogICAgICAgICNtb2RlLiBJZiBuIGlzIG5lZ2F0aXZlLCByZWFkIHVudGlsIEVPRiBvciB1bnRpbCByZWFkKCkgd291bGQKICAgICAgICAjYmxvY2suCiAgICAgICAgIyIKICAgICAgICBpZiBuIGlzIG5vdCBOb25lIGFuZCBuIDwgLTE6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImludmFsaWQgbnVtYmVyIG9mIGJ5dGVzIHRvIHJlYWQiKQogICAgICAgICN3aXRoIHNlbGYuX3JlYWRfbG9jazogICAgIyBmaXhtZQogICAgICAgIHJldHVybiBzZWxmLl9yZWFkX3VubG9ja2VkKG4pCgogICAgZGVmIF9yZWFkX3VubG9ja2VkKHNlbGYsIG49Tm9uZSk6CiAgICAgICAgI25vZGF0YV92YWwgPSBiIiIgICAjZml4bWUKICAgICAgICBub2RhdGFfdmFsID0gIiIKICAgICAgICAjZW1wdHlfdmFsdWVzID0gKGIiIiwgTm9uZSkgICNmaXhtZQogICAgICAgIGVtcHR5X3ZhbHVlcyA9ICgiIiwgTm9uZSkKICAgICAgICBidWYgPSBzZWxmLl9yZWFkX2J1ZgogICAgICAgIHBvcyA9IHNlbGYuX3JlYWRfcG9zCgogICAgICAgICMgU3BlY2lhbCBjYXNlIGZvciB3aGVuIHRoZSBudW1iZXIgb2YgYnl0ZXMgdG8gcmVhZCBpcyB1bnNwZWNpZmllZC4KICAgICAgICBpZiBuIGlzIE5vbmUgb3IgbiA9PSAtMToKICAgICAgICAgICAgc2VsZi5fcmVzZXRfcmVhZF9idWYoKQogICAgICAgICAgICBjaHVua3MgPSBbYnVmW3BvczpdXSAgIyBTdHJpcCB0aGUgY29uc3VtZWQgYnl0ZXMuCiAgICAgICAgICAgIGN1cnJlbnRfc2l6ZSA9IDAKICAgICAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgICAgICMgUmVhZCB1bnRpbCBFT0Ygb3IgdW50aWwgcmVhZCgpIHdvdWxkIGJsb2NrLgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGNodW5rID0gc2VsZi5yYXcucmVhZCgpCiAgICAgICAgICAgICAgICBleGNlcHQgSU9FcnJvciBhcyBlOgogICAgICAgICAgICAgICAgICAgIGlmIGUuZXJybm8gIT0gRUlOVFI6CiAgICAgICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIGlmIGNodW5rIGluIGVtcHR5X3ZhbHVlczoKICAgICAgICAgICAgICAgICAgICBub2RhdGFfdmFsID0gY2h1bmsKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgY3VycmVudF9zaXplICs9IGxlbihjaHVuaykKICAgICAgICAgICAgICAgIGNodW5rcy5hcHBlbmQoY2h1bmspCiAgICAgICAgICAgIHJldHVybiAiIi5qb2luKGNodW5rcykgb3Igbm9kYXRhX3ZhbAoKICAgICAgICAjIFRoZSBudW1iZXIgb2YgYnl0ZXMgdG8gcmVhZCBpcyBzcGVjaWZpZWQsIHJldHVybiBhdCBtb3N0IG4gYnl0ZXMuCiAgICAgICAgYXZhaWwgPSBsZW4oYnVmKSAtIHBvcyAgIyBMZW5ndGggb2YgdGhlIGF2YWlsYWJsZSBidWZmZXJlZCBkYXRhLgogICAgICAgIGlmIG4gPD0gYXZhaWw6CiAgICAgICAgICAgICMgRmFzdCBwYXRoOiB0aGUgZGF0YSB0byByZWFkIGlzIGZ1bGx5IGJ1ZmZlcmVkLgogICAgICAgICAgICBzZWxmLl9yZWFkX3BvcyArPSBuCiAgICAgICAgICAgIHJldHVybiBidWZbcG9zOnBvcytuXQogICAgICAgICMgU2xvdyBwYXRoOiByZWFkIGZyb20gdGhlIHN0cmVhbSB1bnRpbCBlbm91Z2ggYnl0ZXMgYXJlIHJlYWQsCiAgICAgICAgIyBvciB1bnRpbCBhbiBFT0Ygb2NjdXJzIG9yIHVudGlsIHJlYWQoKSB3b3VsZCBibG9jay4KICAgICAgICBjaHVua3MgPSBbYnVmW3BvczpdXQogICAgICAgIHdhbnRlZCA9IG1heChzZWxmLmJ1ZmZlcl9zaXplLCBuKQogICAgICAgIHdoaWxlIGF2YWlsIDwgbjoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgY2h1bmsgPSBzZWxmLnJhdy5yZWFkKHdhbnRlZCkKICAgICAgICAgICAgZXhjZXB0IElPRXJyb3IgYXMgZToKICAgICAgICAgICAgICAgIGlmIGUuZXJybm8gIT0gRUlOVFI6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGlmIGNodW5rIGluIGVtcHR5X3ZhbHVlczoKICAgICAgICAgICAgICAgIG5vZGF0YV92YWwgPSBjaHVuawogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgYXZhaWwgKz0gbGVuKGNodW5rKQogICAgICAgICAgICBjaHVua3MuYXBwZW5kKGNodW5rKQogICAgICAgICMgbiBpcyBtb3JlIHRoZW4gYXZhaWwgb25seSB3aGVuIGFuIEVPRiBvY2N1cnJlZCBvciB3aGVuCiAgICAgICAgIyByZWFkKCkgd291bGQgaGF2ZSBibG9ja2VkLgogICAgICAgIG4gPSBtaW4obiwgYXZhaWwpCiAgICAgICAgI291dCA9IGIiIi5qb2luKGNodW5rcykgICAjZml4bWUKICAgICAgICBvdXQgPSAiIi5qb2luKGNodW5rcykKICAgICAgICBzZWxmLl9yZWFkX2J1ZiA9IG91dFtuOl0gICMgU2F2ZSB0aGUgZXh0cmEgZGF0YSBpbiB0aGUgYnVmZmVyLgogICAgICAgIHNlbGYuX3JlYWRfcG9zID0gMAogICAgICAgIHJldHVybiBvdXRbOm5dIGlmIG91dCBlbHNlIG5vZGF0YV92YWwKCiAgICBkZWYgcGVlayhzZWxmLCBuPTApOgogICAgICAgICMiUmV0dXJucyBidWZmZXJlZCBieXRlcyB3aXRob3V0IGFkdmFuY2luZyB0aGUgcG9zaXRpb24uCgogICAgICAgICNUaGUgYXJndW1lbnQgaW5kaWNhdGVzIGEgZGVzaXJlZCBtaW5pbWFsIG51bWJlciBvZiBieXRlczsgd2UKICAgICAgICAjZG8gYXQgbW9zdCBvbmUgcmF3IHJlYWQgdG8gc2F0aXNmeSBpdC4gIFdlIG5ldmVyIHJldHVybiBtb3JlCiAgICAgICAgI3RoYW4gc2VsZi5idWZmZXJfc2l6ZS4KICAgICAgICAjIgogICAgICAgICN3aXRoIHNlbGYuX3JlYWRfbG9jazogICAgICNmaXhtZQogICAgICAgIHJldHVybiBzZWxmLl9wZWVrX3VubG9ja2VkKG4pCgogICAgZGVmIF9wZWVrX3VubG9ja2VkKHNlbGYsIG49MCk6CiAgICAgICAgd2FudCA9IG1pbihuLCBzZWxmLmJ1ZmZlcl9zaXplKQogICAgICAgIGhhdmUgPSBsZW4oc2VsZi5fcmVhZF9idWYpIC0gc2VsZi5fcmVhZF9wb3MKICAgICAgICBpZiBoYXZlIDwgd2FudCBvciBoYXZlIDw9IDA6CiAgICAgICAgICAgIHRvX3JlYWQgPSBzZWxmLmJ1ZmZlcl9zaXplIC0gaGF2ZQogICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBzZWxmLnJhdy5yZWFkKHRvX3JlYWQpCiAgICAgICAgICAgICAgICBleGNlcHQgSU9FcnJvciBhcyBlOgogICAgICAgICAgICAgICAgICAgIGlmIGUuZXJybm8gIT0gRUlOVFI6CiAgICAgICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGlmIGN1cnJlbnQ6CiAgICAgICAgICAgICAgICBzZWxmLl9yZWFkX2J1ZiA9IHNlbGYuX3JlYWRfYnVmW3NlbGYuX3JlYWRfcG9zOl0gKyBjdXJyZW50CiAgICAgICAgICAgICAgICBzZWxmLl9yZWFkX3BvcyA9IDAKICAgICAgICByZXR1cm4gc2VsZi5fcmVhZF9idWZbc2VsZi5fcmVhZF9wb3M6XQoKICAgIGRlZiByZWFkMShzZWxmLCBuKToKICAgICAgICAjIlJlYWRzIHVwIHRvIG4gYnl0ZXMsIHdpdGggYXQgbW9zdCBvbmUgcmVhZCgpIHN5c3RlbSBjYWxsLiIKICAgICAgICAjIFJldHVybnMgdXAgdG8gbiBieXRlcy4gIElmIGF0IGxlYXN0IG9uZSBieXRlIGlzIGJ1ZmZlcmVkLCB3ZQogICAgICAgICMgb25seSByZXR1cm4gYnVmZmVyZWQgYnl0ZXMuICBPdGhlcndpc2UsIHdlIGRvIG9uZSByYXcgcmVhZC4KICAgICAgICBpZiBuIDwgMDoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigibnVtYmVyIG9mIGJ5dGVzIHRvIHJlYWQgbXVzdCBiZSBwb3NpdGl2ZSIpCiAgICAgICAgaWYgbiA9PSAwOgogICAgICAgICAgICAjcmV0dXJuIGIiIgogICAgICAgICAgICByZXR1cm4gIiIKICAgICAgICAjd2l0aCBzZWxmLl9yZWFkX2xvY2s6ICAgI2ZpeG1lCiAgICAgICAgc2VsZi5fcGVla191bmxvY2tlZCgxKQogICAgICAgIHJldHVybiBzZWxmLl9yZWFkX3VubG9ja2VkKAogICAgICAgICAgICAgICAgbWluKG4sIGxlbihzZWxmLl9yZWFkX2J1ZikgLSBzZWxmLl9yZWFkX3BvcykpCgogICAgZGVmIHRlbGwoc2VsZik6CiAgICAgICAgcmV0dXJuIF9CdWZmZXJlZElPTWl4aW4udGVsbChzZWxmKSAtIGxlbihzZWxmLl9yZWFkX2J1ZikgKyBzZWxmLl9yZWFkX3BvcwoKICAgIGRlZiBzZWVrKHNlbGYsIHBvcywgd2hlbmNlPTApOgogICAgICAgIGlmIG5vdCAoMCA8PSB3aGVuY2UgPD0gMik6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImludmFsaWQgd2hlbmNlIHZhbHVlIikKICAgICAgICAjd2l0aCBzZWxmLl9yZWFkX2xvY2s6ICAgI2ZpeG1lCiAgICAgICAgaWYgMToKICAgICAgICAgICAgaWYgd2hlbmNlID09IDE6CiAgICAgICAgICAgICAgICBwb3MgLT0gbGVuKHNlbGYuX3JlYWRfYnVmKSAtIHNlbGYuX3JlYWRfcG9zCiAgICAgICAgICAgIHBvcyA9IF9CdWZmZXJlZElPTWl4aW4uc2VlayhzZWxmLCBwb3MsIHdoZW5jZSkKICAgICAgICAgICAgc2VsZi5fcmVzZXRfcmVhZF9idWYoKQogICAgICAgICAgICByZXR1cm4gcG9zCgpjbGFzcyBCdWZmZXJlZFdyaXRlcihfQnVmZmVyZWRJT01peGluKToKCiAgICAjIkEgYnVmZmVyIGZvciBhIHdyaXRlYWJsZSBzZXF1ZW50aWFsIFJhd0lPIG9iamVjdC4KCiAgICAjVGhlIGNvbnN0cnVjdG9yIGNyZWF0ZXMgYSBCdWZmZXJlZFdyaXRlciBmb3IgdGhlIGdpdmVuIHdyaXRlYWJsZSByYXcKICAgICNzdHJlYW0uIElmIHRoZSBidWZmZXJfc2l6ZSBpcyBub3QgZ2l2ZW4sIGl0IGRlZmF1bHRzIHRvCiAgICAjREVGQVVMVF9CVUZGRVJfU0laRS4KICAgICMiCgogICAgX3dhcm5pbmdfc3RhY2tfb2Zmc2V0ID0gMgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCByYXcsCiAgICAgICAgICAgICAgICAgYnVmZmVyX3NpemU9REVGQVVMVF9CVUZGRVJfU0laRSwgbWF4X2J1ZmZlcl9zaXplPU5vbmUpOgogICAgICAgIGlmIG5vdCByYXcud3JpdGFibGUoKToKICAgICAgICAgICAgcmFpc2UgSU9FcnJvcignInJhdyIgYXJndW1lbnQgbXVzdCBiZSB3cml0YWJsZS4nKQoKICAgICAgICBfQnVmZmVyZWRJT01peGluLl9faW5pdF9fKHNlbGYsIHJhdykKICAgICAgICBpZiBidWZmZXJfc2l6ZSA8PSAwOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJpbnZhbGlkIGJ1ZmZlciBzaXplIikKICAgICAgICBpZiBtYXhfYnVmZmVyX3NpemUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHdhcm5pbmdzLndhcm4oIm1heF9idWZmZXJfc2l6ZSBpcyBkZXByZWNhdGVkIiwgRGVwcmVjYXRpb25XYXJuaW5nLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3dhcm5pbmdfc3RhY2tfb2Zmc2V0KQogICAgICAgIHNlbGYuYnVmZmVyX3NpemUgPSBidWZmZXJfc2l6ZQogICAgICAgIHNlbGYuX3dyaXRlX2J1ZiA9IGJ5dGVhcnJheSgpCiAgICAgICAgc2VsZi5fd3JpdGVfbG9jayA9IExvY2soKQoKICAgIGRlZiB3cml0ZShzZWxmLCBiKToKICAgICAgICBpZiBzZWxmLmNsb3NlZDoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigid3JpdGUgdG8gY2xvc2VkIGZpbGUiKQogICAgICAgIGlmIGlzaW5zdGFuY2UoYiwgc3RyKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJjYW4ndCB3cml0ZSBzdHIgdG8gYmluYXJ5IHN0cmVhbSIpCiAgICAgICAgI3dpdGggc2VsZi5fd3JpdGVfbG9jazogICAjZml4bWUKICAgICAgICBpZiAxOgogICAgICAgICAgICAjIFhYWCB3ZSBjYW4gaW1wbGVtZW50IHNvbWUgbW9yZSB0cmlja3MgdG8gdHJ5IGFuZCBhdm9pZAogICAgICAgICAgICAjIHBhcnRpYWwgd3JpdGVzCiAgICAgICAgICAgIGlmIGxlbihzZWxmLl93cml0ZV9idWYpID4gc2VsZi5idWZmZXJfc2l6ZToKICAgICAgICAgICAgICAgICMgV2UncmUgZnVsbCwgc28gbGV0J3MgcHJlLWZsdXNoIHRoZSBidWZmZXIuICAoVGhpcyBtYXkKICAgICAgICAgICAgICAgICMgcmFpc2UgQmxvY2tpbmdJT0Vycm9yIHdpdGggY2hhcmFjdGVyc193cml0dGVuID09IDAuKQogICAgICAgICAgICAgICAgc2VsZi5fZmx1c2hfdW5sb2NrZWQoKQogICAgICAgICAgICBiZWZvcmUgPSBsZW4oc2VsZi5fd3JpdGVfYnVmKQogICAgICAgICAgICBzZWxmLl93cml0ZV9idWYuZXh0ZW5kKGIpCiAgICAgICAgICAgIHdyaXR0ZW4gPSBsZW4oc2VsZi5fd3JpdGVfYnVmKSAtIGJlZm9yZQogICAgICAgICAgICBpZiBsZW4oc2VsZi5fd3JpdGVfYnVmKSA+IHNlbGYuYnVmZmVyX3NpemU6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5fZmx1c2hfdW5sb2NrZWQoKQogICAgICAgICAgICAgICAgZXhjZXB0IEJsb2NraW5nSU9FcnJvciBhcyBlOgogICAgICAgICAgICAgICAgICAgIGlmIGxlbihzZWxmLl93cml0ZV9idWYpID4gc2VsZi5idWZmZXJfc2l6ZToKICAgICAgICAgICAgICAgICAgICAgICAgIyBXZSd2ZSBoaXQgdGhlIGJ1ZmZlcl9zaXplLiBXZSBoYXZlIHRvIGFjY2VwdCBhIHBhcnRpYWwKICAgICAgICAgICAgICAgICAgICAgICAgIyB3cml0ZSBhbmQgY3V0IGJhY2sgb3VyIGJ1ZmZlci4KICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmFnZSA9IGxlbihzZWxmLl93cml0ZV9idWYpIC0gc2VsZi5idWZmZXJfc2l6ZQogICAgICAgICAgICAgICAgICAgICAgICB3cml0dGVuIC09IG92ZXJhZ2UKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fd3JpdGVfYnVmID0gc2VsZi5fd3JpdGVfYnVmWzpzZWxmLmJ1ZmZlcl9zaXplXQogICAgICAgICAgICAgICAgICAgICAgICByYWlzZSBCbG9ja2luZ0lPRXJyb3IoZS5lcnJubywgZS5zdHJlcnJvciwgd3JpdHRlbikKICAgICAgICAgICAgcmV0dXJuIHdyaXR0ZW4KCiAgICBkZWYgdHJ1bmNhdGUoc2VsZiwgcG9zPU5vbmUpOgogICAgICAgICN3aXRoIHNlbGYuX3dyaXRlX2xvY2s6ICAgICNmaXhtZQogICAgICAgIGlmIDE6CiAgICAgICAgICAgIHNlbGYuX2ZsdXNoX3VubG9ja2VkKCkKICAgICAgICAgICAgaWYgcG9zIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBwb3MgPSBzZWxmLnJhdy50ZWxsKCkKICAgICAgICAgICAgcmV0dXJuIHNlbGYucmF3LnRydW5jYXRlKHBvcykKCiAgICBkZWYgZmx1c2goc2VsZik6CiAgICAgICAgI3dpdGggc2VsZi5fd3JpdGVfbG9jazogICNmaXhtZQogICAgICAgIHNlbGYuX2ZsdXNoX3VubG9ja2VkKCkKCiAgICBkZWYgX2ZsdXNoX3VubG9ja2VkKHNlbGYpOgogICAgICAgIGlmIHNlbGYuY2xvc2VkOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJmbHVzaCBvZiBjbG9zZWQgZmlsZSIpCiAgICAgICAgd2hpbGUgc2VsZi5fd3JpdGVfYnVmOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBuID0gc2VsZi5yYXcud3JpdGUoc2VsZi5fd3JpdGVfYnVmKQogICAgICAgICAgICBleGNlcHQgQmxvY2tpbmdJT0Vycm9yOgogICAgICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCJzZWxmLnJhdyBzaG91bGQgaW1wbGVtZW50IFJhd0lPQmFzZTogaXQgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG91bGQgbm90IHJhaXNlIEJsb2NraW5nSU9FcnJvciIpCiAgICAgICAgICAgIGV4Y2VwdCBJT0Vycm9yIGFzIGU6CiAgICAgICAgICAgICAgICBpZiBlLmVycm5vICE9IEVJTlRSOgogICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBpZiBuIGlzIE5vbmU6CiAgICAgICAgICAgICAgICByYWlzZSBCbG9ja2luZ0lPRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgZXJybm8uRUFHQUlOLAogICAgICAgICAgICAgICAgICAgICJ3cml0ZSBjb3VsZCBub3QgY29tcGxldGUgd2l0aG91dCBibG9ja2luZyIsIDApCiAgICAgICAgICAgIGlmIG4gPiBsZW4oc2VsZi5fd3JpdGVfYnVmKSBvciBuIDwgMDoKICAgICAgICAgICAgICAgIHJhaXNlIElPRXJyb3IoIndyaXRlKCkgcmV0dXJuZWQgaW5jb3JyZWN0IG51bWJlciBvZiBieXRlcyIpCiAgICAgICAgICAgIGRlbCBzZWxmLl93cml0ZV9idWZbOm5dCgogICAgZGVmIHRlbGwoc2VsZik6CiAgICAgICAgcmV0dXJuIF9CdWZmZXJlZElPTWl4aW4udGVsbChzZWxmKSArIGxlbihzZWxmLl93cml0ZV9idWYpCgogICAgZGVmIHNlZWsoc2VsZiwgcG9zLCB3aGVuY2U9MCk6CiAgICAgICAgaWYgbm90ICgwIDw9IHdoZW5jZSA8PSAyKToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiaW52YWxpZCB3aGVuY2UiKQogICAgICAgICN3aXRoIHNlbGYuX3dyaXRlX2xvY2s6ICAgI2ZpeG1lCiAgICAgICAgaWYgMToKICAgICAgICAgICAgc2VsZi5fZmx1c2hfdW5sb2NrZWQoKQogICAgICAgICAgICByZXR1cm4gX0J1ZmZlcmVkSU9NaXhpbi5zZWVrKHNlbGYsIHBvcywgd2hlbmNlKQoKCmNsYXNzIEJ1ZmZlcmVkUldQYWlyKEJ1ZmZlcmVkSU9CYXNlKToKCiAgICAjIkEgYnVmZmVyZWQgcmVhZGVyIGFuZCB3cml0ZXIgb2JqZWN0IHRvZ2V0aGVyLgoKICAgICNBIGJ1ZmZlcmVkIHJlYWRlciBvYmplY3QgYW5kIGJ1ZmZlcmVkIHdyaXRlciBvYmplY3QgcHV0IHRvZ2V0aGVyIHRvCiAgICAjZm9ybSBhIHNlcXVlbnRpYWwgSU8gb2JqZWN0IHRoYXQgY2FuIHJlYWQgYW5kIHdyaXRlLiBUaGlzIGlzIHR5cGljYWxseQogICAgI3VzZWQgd2l0aCBhIHNvY2tldCBvciB0d28td2F5IHBpcGUuCgogICAgI3JlYWRlciBhbmQgd3JpdGVyIGFyZSBSYXdJT0Jhc2Ugb2JqZWN0cyB0aGF0IGFyZSByZWFkYWJsZSBhbmQKICAgICN3cml0ZWFibGUgcmVzcGVjdGl2ZWx5LiBJZiB0aGUgYnVmZmVyX3NpemUgaXMgb21pdHRlZCBpdCBkZWZhdWx0cyB0bwogICAgI0RFRkFVTFRfQlVGRkVSX1NJWkUuCiAgICAjIgoKICAgICMgWFhYIFRoZSB1c2VmdWxuZXNzIG9mIHRoaXMgKGNvbXBhcmVkIHRvIGhhdmluZyB0d28gc2VwYXJhdGUgSU8KICAgICMgb2JqZWN0cykgaXMgcXVlc3Rpb25hYmxlLgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCByZWFkZXIsIHdyaXRlciwKICAgICAgICAgICAgICAgICBidWZmZXJfc2l6ZT1ERUZBVUxUX0JVRkZFUl9TSVpFLCBtYXhfYnVmZmVyX3NpemU9Tm9uZSk6CiAgICAgICAgIyJDb25zdHJ1Y3Rvci4KCiAgICAgICAgI1RoZSBhcmd1bWVudHMgYXJlIHR3byBSYXdJTyBpbnN0YW5jZXMuCiAgICAgICAgIyIKICAgICAgICBpZiBtYXhfYnVmZmVyX3NpemUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHdhcm5pbmdzLndhcm4oIm1heF9idWZmZXJfc2l6ZSBpcyBkZXByZWNhdGVkIiwgRGVwcmVjYXRpb25XYXJuaW5nLCAyKQoKICAgICAgICBpZiBub3QgcmVhZGVyLnJlYWRhYmxlKCk6CiAgICAgICAgICAgIHJhaXNlIElPRXJyb3IoJyJyZWFkZXIiIGFyZ3VtZW50IG11c3QgYmUgcmVhZGFibGUuJykKCiAgICAgICAgaWYgbm90IHdyaXRlci53cml0YWJsZSgpOgogICAgICAgICAgICByYWlzZSBJT0Vycm9yKCcid3JpdGVyIiBhcmd1bWVudCBtdXN0IGJlIHdyaXRhYmxlLicpCgogICAgICAgIHNlbGYucmVhZGVyID0gQnVmZmVyZWRSZWFkZXIocmVhZGVyLCBidWZmZXJfc2l6ZSkKICAgICAgICBzZWxmLndyaXRlciA9IEJ1ZmZlcmVkV3JpdGVyKHdyaXRlciwgYnVmZmVyX3NpemUpCgogICAgZGVmIHJlYWQoc2VsZiwgbj1Ob25lKToKICAgICAgICBpZiBuIGlzIE5vbmU6CiAgICAgICAgICAgIG4gPSAtMQogICAgICAgIHJldHVybiBzZWxmLnJlYWRlci5yZWFkKG4pCgogICAgZGVmIHJlYWRpbnRvKHNlbGYsIGIpOgogICAgICAgIHJldHVybiBzZWxmLnJlYWRlci5yZWFkaW50byhiKQoKICAgIGRlZiB3cml0ZShzZWxmLCBiKToKICAgICAgICByZXR1cm4gc2VsZi53cml0ZXIud3JpdGUoYikKCiAgICBkZWYgcGVlayhzZWxmLCBuPTApOgogICAgICAgIHJldHVybiBzZWxmLnJlYWRlci5wZWVrKG4pCgogICAgZGVmIHJlYWQxKHNlbGYsIG4pOgogICAgICAgIHJldHVybiBzZWxmLnJlYWRlci5yZWFkMShuKQoKICAgIGRlZiByZWFkYWJsZShzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5yZWFkZXIucmVhZGFibGUoKQoKICAgIGRlZiB3cml0YWJsZShzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi53cml0ZXIud3JpdGFibGUoKQoKICAgIGRlZiBmbHVzaChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi53cml0ZXIuZmx1c2goKQoKICAgIGRlZiBjbG9zZShzZWxmKToKICAgICAgICBzZWxmLndyaXRlci5jbG9zZSgpCiAgICAgICAgc2VsZi5yZWFkZXIuY2xvc2UoKQoKICAgIGRlZiBpc2F0dHkoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYucmVhZGVyLmlzYXR0eSgpIG9yIHNlbGYud3JpdGVyLmlzYXR0eSgpCgogICAgI0Bwcm9wZXJ0eQogICAgZGVmIGNsb3NlZChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi53cml0ZXIuY2xvc2VkCgoKY2xhc3MgQnVmZmVyZWRSYW5kb20oQnVmZmVyZWRXcml0ZXIsIEJ1ZmZlcmVkUmVhZGVyKToKCiAgICAjIkEgYnVmZmVyZWQgaW50ZXJmYWNlIHRvIHJhbmRvbSBhY2Nlc3Mgc3RyZWFtcy4KCiAgICAjVGhlIGNvbnN0cnVjdG9yIGNyZWF0ZXMgYSByZWFkZXIgYW5kIHdyaXRlciBmb3IgYSBzZWVrYWJsZSBzdHJlYW0sCiAgICAjcmF3LCBnaXZlbiBpbiB0aGUgZmlyc3QgYXJndW1lbnQuIElmIHRoZSBidWZmZXJfc2l6ZSBpcyBvbWl0dGVkIGl0CiAgICAjZGVmYXVsdHMgdG8gREVGQVVMVF9CVUZGRVJfU0laRS4KICAgICMiCgogICAgX3dhcm5pbmdfc3RhY2tfb2Zmc2V0ID0gMwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCByYXcsCiAgICAgICAgICAgICAgICAgYnVmZmVyX3NpemU9REVGQVVMVF9CVUZGRVJfU0laRSwgbWF4X2J1ZmZlcl9zaXplPU5vbmUpOgogICAgICAgIHJhdy5fY2hlY2tTZWVrYWJsZSgpCiAgICAgICAgQnVmZmVyZWRSZWFkZXIuX19pbml0X18oc2VsZiwgcmF3LCBidWZmZXJfc2l6ZSkKICAgICAgICBCdWZmZXJlZFdyaXRlci5fX2luaXRfXyhzZWxmLCByYXcsIGJ1ZmZlcl9zaXplLCBtYXhfYnVmZmVyX3NpemUpCgogICAgZGVmIHNlZWsoc2VsZiwgcG9zLCB3aGVuY2U9MCk6CiAgICAgICAgaWYgbm90ICgwIDw9IHdoZW5jZSA8PSAyKToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiaW52YWxpZCB3aGVuY2UiKQogICAgICAgIHNlbGYuZmx1c2goKQogICAgICAgIGlmIHNlbGYuX3JlYWRfYnVmOgogICAgICAgICAgICAjIFVuZG8gcmVhZCBhaGVhZC4KICAgICAgICAgICAgI3dpdGggc2VsZi5fcmVhZF9sb2NrOiAgICNmaXhtZQogICAgICAgICAgICBzZWxmLnJhdy5zZWVrKHNlbGYuX3JlYWRfcG9zIC0gbGVuKHNlbGYuX3JlYWRfYnVmKSwgMSkKICAgICAgICAjIEZpcnN0IGRvIHRoZSByYXcgc2VlaywgdGhlbiBlbXB0eSB0aGUgcmVhZCBidWZmZXIsIHNvIHRoYXQKICAgICAgICAjIGlmIHRoZSByYXcgc2VlayBmYWlscywgd2UgZG9uJ3QgbG9zZSBidWZmZXJlZCBkYXRhIGZvcmV2ZXIuCiAgICAgICAgcG9zID0gc2VsZi5yYXcuc2Vlayhwb3MsIHdoZW5jZSkKICAgICAgICAjd2l0aCBzZWxmLl9yZWFkX2xvY2s6ICAgI2ZpeG1lCiAgICAgICAgc2VsZi5fcmVzZXRfcmVhZF9idWYoKQogICAgICAgIGlmIHBvcyA8IDA6CiAgICAgICAgICAgIHJhaXNlIElPRXJyb3IoInNlZWsoKSByZXR1cm5lZCBpbnZhbGlkIHBvc2l0aW9uIikKICAgICAgICByZXR1cm4gcG9zCgogICAgZGVmIHRlbGwoc2VsZik6CiAgICAgICAgaWYgc2VsZi5fd3JpdGVfYnVmOgogICAgICAgICAgICByZXR1cm4gQnVmZmVyZWRXcml0ZXIudGVsbChzZWxmKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBCdWZmZXJlZFJlYWRlci50ZWxsKHNlbGYpCgogICAgZGVmIHRydW5jYXRlKHNlbGYsIHBvcz1Ob25lKToKICAgICAgICBpZiBwb3MgaXMgTm9uZToKICAgICAgICAgICAgcG9zID0gc2VsZi50ZWxsKCkKICAgICAgICAjIFVzZSBzZWVrIHRvIGZsdXNoIHRoZSByZWFkIGJ1ZmZlci4KICAgICAgICByZXR1cm4gQnVmZmVyZWRXcml0ZXIudHJ1bmNhdGUoc2VsZiwgcG9zKQoKICAgIGRlZiByZWFkKHNlbGYsIG49Tm9uZSk6CiAgICAgICAgaWYgbiBpcyBOb25lOgogICAgICAgICAgICBuID0gLTEKICAgICAgICBzZWxmLmZsdXNoKCkKICAgICAgICByZXR1cm4gQnVmZmVyZWRSZWFkZXIucmVhZChzZWxmLCBuKQoKICAgIGRlZiByZWFkaW50byhzZWxmLCBiKToKICAgICAgICBzZWxmLmZsdXNoKCkKICAgICAgICByZXR1cm4gQnVmZmVyZWRSZWFkZXIucmVhZGludG8oc2VsZiwgYikKCiAgICBkZWYgcGVlayhzZWxmLCBuPTApOgogICAgICAgIHNlbGYuZmx1c2goKQogICAgICAgIHJldHVybiBCdWZmZXJlZFJlYWRlci5wZWVrKHNlbGYsIG4pCgogICAgZGVmIHJlYWQxKHNlbGYsIG4pOgogICAgICAgIHNlbGYuZmx1c2goKQogICAgICAgIHJldHVybiBCdWZmZXJlZFJlYWRlci5yZWFkMShzZWxmLCBuKQoKICAgIGRlZiB3cml0ZShzZWxmLCBiKToKICAgICAgICBpZiBzZWxmLl9yZWFkX2J1ZjoKICAgICAgICAgICAgIyBVbmRvIHJlYWRhaGVhZAogICAgICAgICAgICAjd2l0aCBzZWxmLl9yZWFkX2xvY2s6ICAjZml4bWUKICAgICAgICAgICAgc2VsZi5yYXcuc2VlayhzZWxmLl9yZWFkX3BvcyAtIGxlbihzZWxmLl9yZWFkX2J1ZiksIDEpCiAgICAgICAgICAgIHNlbGYuX3Jlc2V0X3JlYWRfYnVmKCkKICAgICAgICByZXR1cm4gQnVmZmVyZWRXcml0ZXIud3JpdGUoc2VsZiwgYikKCgpjbGFzcyBUZXh0SU9CYXNlKElPQmFzZSk6CgogICAgIyJCYXNlIGNsYXNzIGZvciB0ZXh0IEkvTy4KCiAgICAjVGhpcyBjbGFzcyBwcm92aWRlcyBhIGNoYXJhY3RlciBhbmQgbGluZSBiYXNlZCBpbnRlcmZhY2UgdG8gc3RyZWFtCiAgICAjSS9PLiBUaGVyZSBpcyBubyByZWFkaW50byBtZXRob2QgYmVjYXVzZSBQeXRob24ncyBjaGFyYWN0ZXIgc3RyaW5ncwogICAgI2FyZSBpbW11dGFibGUuIFRoZXJlIGlzIG5vIHB1YmxpYyBjb25zdHJ1Y3Rvci4KICAgICMiCgogICAgZGVmIHJlYWQoc2VsZiwgbj0tMSk6CiAgICAgICAgIyJSZWFkIGF0IG1vc3QgbiBjaGFyYWN0ZXJzIGZyb20gc3RyZWFtLCB3aGVyZSBuIGlzIGFuIGludC4KCiAgICAgICAgI1JlYWQgZnJvbSB1bmRlcmx5aW5nIGJ1ZmZlciB1bnRpbCB3ZSBoYXZlIG4gY2hhcmFjdGVycyBvciB3ZSBoaXQgRU9GLgogICAgICAgICNJZiBuIGlzIG5lZ2F0aXZlIG9yIG9taXR0ZWQsIHJlYWQgdW50aWwgRU9GLgoKICAgICAgICAjUmV0dXJucyBhIHN0cmluZy4KICAgICAgICAjIgogICAgICAgIHNlbGYuX3Vuc3VwcG9ydGVkKCJyZWFkIikKCiAgICBkZWYgd3JpdGUoc2VsZiwgcyk6CiAgICAgICAgIyJXcml0ZSBzdHJpbmcgcyB0byBzdHJlYW0gYW5kIHJldHVybmluZyBhbiBpbnQuIgogICAgICAgIHNlbGYuX3Vuc3VwcG9ydGVkKCJ3cml0ZSIpCgogICAgZGVmIHRydW5jYXRlKHNlbGYsIHBvcz1Ob25lKToKICAgICAgICAjIlRydW5jYXRlIHNpemUgdG8gcG9zLCB3aGVyZSBwb3MgaXMgYW4gaW50LiIKICAgICAgICBzZWxmLl91bnN1cHBvcnRlZCgidHJ1bmNhdGUiKQoKICAgIGRlZiByZWFkbGluZShzZWxmKToKICAgICAgICAjIlJlYWQgdW50aWwgbmV3bGluZSBvciBFT0YuCgogICAgICAgICNSZXR1cm5zIGFuIGVtcHR5IHN0cmluZyBpZiBFT0YgaXMgaGl0IGltbWVkaWF0ZWx5LgogICAgICAgICMiCiAgICAgICAgc2VsZi5fdW5zdXBwb3J0ZWQoInJlYWRsaW5lIikKCiAgICBkZWYgZGV0YWNoKHNlbGYpOgogICAgICAgICMiCiAgICAgICAgI1NlcGFyYXRlIHRoZSB1bmRlcmx5aW5nIGJ1ZmZlciBmcm9tIHRoZSBUZXh0SU9CYXNlIGFuZCByZXR1cm4gaXQuCgogICAgICAgICNBZnRlciB0aGUgdW5kZXJseWluZyBidWZmZXIgaGFzIGJlZW4gZGV0YWNoZWQsIHRoZSBUZXh0SU8gaXMgaW4gYW4KICAgICAgICAjdW51c2FibGUgc3RhdGUuCiAgICAgICAgIyIKICAgICAgICBzZWxmLl91bnN1cHBvcnRlZCgiZGV0YWNoIikKCiAgICAjQHByb3BlcnR5CiAgICBkZWYgZW5jb2Rpbmcoc2VsZik6CiAgICAgICAgIyJTdWJjbGFzc2VzIHNob3VsZCBvdmVycmlkZS4iCiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICAjQHByb3BlcnR5CiAgICBkZWYgbmV3bGluZXMoc2VsZik6CiAgICAgICAgIyJMaW5lIGVuZGluZ3MgdHJhbnNsYXRlZCBzbyBmYXIuCgogICAgICAgICNPbmx5IGxpbmUgZW5kaW5ncyB0cmFuc2xhdGVkIGR1cmluZyByZWFkaW5nIGFyZSBjb25zaWRlcmVkLgoKICAgICAgICAjU3ViY2xhc3NlcyBzaG91bGQgb3ZlcnJpZGUuCiAgICAgICAgIyIKICAgICAgICByZXR1cm4gTm9uZQoKICAgICNAcHJvcGVydHkKICAgIGRlZiBlcnJvcnMoc2VsZik6CiAgICAgICAgIyIiRXJyb3Igc2V0dGluZyBvZiB0aGUgZGVjb2RlciBvciBlbmNvZGVyLgoKICAgICAgICAjU3ViY2xhc3NlcyBzaG91bGQgb3ZlcnJpZGUuIgogICAgICAgIHJldHVybiBOb25lCgojQkUgY29tbWVudGluZyB0aHNpIG91dAojaW8uVGV4dElPQmFzZS5yZWdpc3RlcihUZXh0SU9CYXNlKQoKCmNsYXNzIEluY3JlbWVudGFsTmV3bGluZURlY29kZXIoY29kZWNzLkluY3JlbWVudGFsRGVjb2Rlcik6CgogICAgIyAiQ29kZWMgdXNlZCB3aGVuIHJlYWRpbmcgYSBmaWxlIGluIHVuaXZlcnNhbCBuZXdsaW5lcyBtb2RlLiAgSXQgd3JhcHMKICAgICMgYW5vdGhlciBpbmNyZW1lbnRhbCBkZWNvZGVyLCB0cmFuc2xhdGluZyBcclxuIGFuZCBcciBpbnRvIFxuLiAgSXQgYWxzbwogICAgI3JlY29yZHMgdGhlIHR5cGVzIG9mIG5ld2xpbmVzIGVuY291bnRlcmVkLiAgV2hlbiB1c2VkIHdpdGgKICAgICN0cmFuc2xhdGU9RmFsc2UsIGl0IGVuc3VyZXMgdGhhdCB0aGUgbmV3bGluZSBzZXF1ZW5jZSBpcyByZXR1cm5lZCBpbgogICAgI29uZSBwaWVjZS4KICAgICMgIgogICAgCiAgICBkZWYgX19pbml0X18oc2VsZiwgZGVjb2RlciwgdHJhbnNsYXRlLCBlcnJvcnM9J3N0cmljdCcpOgogICAgICAgIGNvZGVjcy5JbmNyZW1lbnRhbERlY29kZXIuX19pbml0X18oc2VsZiwgZXJyb3JzPWVycm9ycykKICAgICAgICBzZWxmLnRyYW5zbGF0ZSA9IHRyYW5zbGF0ZQogICAgICAgIHNlbGYuZGVjb2RlciA9IGRlY29kZXIKICAgICAgICBzZWxmLnNlZW5ubCA9IDAKICAgICAgICBzZWxmLnBlbmRpbmdjciA9IEZhbHNlCiAgICBkZWYgZGVjb2RlKHNlbGYsIGlucHV0LCBmaW5hbD1GYWxzZSk6CiAgICAgICAgIyBkZWNvZGUgaW5wdXQgKHdpdGggdGhlIGV2ZW50dWFsIFxyIGZyb20gYSBwcmV2aW91cyBwYXNzKQogICAgICAgIGlmIHNlbGYuZGVjb2RlciBpcyBOb25lOgogICAgICAgICAgICBvdXRwdXQgPSBpbnB1dAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG91dHB1dCA9IHNlbGYuZGVjb2Rlci5kZWNvZGUoaW5wdXQsIGZpbmFsPWZpbmFsKQogICAgICAgIGlmIHNlbGYucGVuZGluZ2NyIGFuZCAob3V0cHV0IG9yIGZpbmFsKToKICAgICAgICAgICAgb3V0cHV0ID0gIlxyIiArIG91dHB1dAogICAgICAgICAgICBzZWxmLnBlbmRpbmdjciA9IEZhbHNlCgogICAgICAgICMgcmV0YWluIGxhc3QgXHIgZXZlbiB3aGVuIG5vdCB0cmFuc2xhdGluZyBkYXRhOgogICAgICAgICMgdGhlbiByZWFkbGluZSgpIGlzIHN1cmUgdG8gZ2V0IFxyXG4gaW4gb25lIHBhc3MKICAgICAgICBpZiBvdXRwdXQuZW5kc3dpdGgoIlxyIikgYW5kIG5vdCBmaW5hbDoKICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0WzotMV0KICAgICAgICAgICAgc2VsZi5wZW5kaW5nY3IgPSBUcnVlCgogICAgICAgICMgUmVjb3JkIHdoaWNoIG5ld2xpbmVzIGFyZSByZWFkCiAgICAgICAgY3JsZiA9IG91dHB1dC5jb3VudCgnXHJcbicpCiAgICAgICAgY3IgPSBvdXRwdXQuY291bnQoJ1xyJykgLSBjcmxmCiAgICAgICAgbGYgPSBvdXRwdXQuY291bnQoJ1xuJykgLSBjcmxmCiAgICAgICAgc2VsZi5zZWVubmwgfD0gKGxmIGFuZCBzZWxmLl9MRikgfCAoY3IgYW5kIHNlbGYuX0NSKSBcCiAgICAgICAgICAgICAgICAgICAgfCAoY3JsZiBhbmQgc2VsZi5fQ1JMRikKCiAgICAgICAgaWYgc2VsZi50cmFuc2xhdGU6CiAgICAgICAgICAgIGlmIGNybGY6CiAgICAgICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZSgiXHJcbiIsICJcbiIpCiAgICAgICAgICAgIGlmIGNyOgogICAgICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UoIlxyIiwgIlxuIikKCiAgICAgICAgcmV0dXJuIG91dHB1dAoKICAgIGRlZiBnZXRzdGF0ZShzZWxmKToKICAgICAgICBpZiBzZWxmLmRlY29kZXIgaXMgTm9uZToKICAgICAgICAgICAgI2J1ZiA9IGIiIiAgICNmaXhtZQogICAgICAgICAgICBidWYgPSAiIgogICAgICAgICAgICBmbGFnID0gMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGJ1ZiwgZmxhZyA9IHNlbGYuZGVjb2Rlci5nZXRzdGF0ZSgpCiAgICAgICAgZmxhZyA8PD0gMQogICAgICAgIGlmIHNlbGYucGVuZGluZ2NyOgogICAgICAgICAgICBmbGFnIHw9IDEKICAgICAgICByZXR1cm4gYnVmLCBmbGFnCgogICAgZGVmIHNldHN0YXRlKHNlbGYsIHN0YXRlKToKICAgICAgICBidWYsIGZsYWcgPSBzdGF0ZQogICAgICAgIHNlbGYucGVuZGluZ2NyID0gYm9vbChmbGFnICYgMSkKICAgICAgICBpZiBzZWxmLmRlY29kZXIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHNlbGYuZGVjb2Rlci5zZXRzdGF0ZSgoYnVmLCBmbGFnID4+IDEpKQoKICAgIGRlZiByZXNldChzZWxmKToKICAgICAgICBzZWxmLnNlZW5ubCA9IDAKICAgICAgICBzZWxmLnBlbmRpbmdjciA9IEZhbHNlCiAgICAgICAgaWYgc2VsZi5kZWNvZGVyIGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLmRlY29kZXIucmVzZXQoKQoKICAgIF9MRiA9IDEKICAgIF9DUiA9IDIKICAgIF9DUkxGID0gNAogICAgCiAgICAjQHByb3BlcnR5CiAgICBkZWYgbmV3bGluZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIChOb25lLAogICAgICAgICAgICAgICAgIlxuIiwKICAgICAgICAgICAgICAgICJcciIsCiAgICAgICAgICAgICAgICAoIlxyIiwgIlxuIiksCiAgICAgICAgICAgICAgICAiXHJcbiIsCiAgICAgICAgICAgICAgICAoIlxuIiwgIlxyXG4iKSwKICAgICAgICAgICAgICAgICgiXHIiLCAiXHJcbiIpLAogICAgICAgICAgICAgICAgKCJcciIsICJcbiIsICJcclxuIikKICAgICAgICAgICAgICAgKVtzZWxmLnNlZW5ubF0KCgpjbGFzcyBUZXh0SU9XcmFwcGVyKFRleHRJT0Jhc2UpOgogICAgX0NIVU5LX1NJWkUgPSAyMDQ4CgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGJ1ZmZlciwgZW5jb2Rpbmc9Tm9uZSwgZXJyb3JzPU5vbmUsIG5ld2xpbmU9Tm9uZSwKICAgICAgICAgICAgICAgICBsaW5lX2J1ZmZlcmluZz1GYWxzZSwgd3JpdGVfdGhyb3VnaD1GYWxzZSk6CiAgICAgICAgaWYgbmV3bGluZSBpcyBub3QgTm9uZSBhbmQgbm90IGlzaW5zdGFuY2UobmV3bGluZSwgc3RyKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJpbGxlZ2FsIG5ld2xpbmUgdHlwZTogJXIiICUgKHR5cGUobmV3bGluZSksKSkKICAgICAgICBpZiBuZXdsaW5lIG5vdCBpbiAoTm9uZSwgIiIsICJcbiIsICJcciIsICJcclxuIik6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImlsbGVnYWwgbmV3bGluZSB2YWx1ZTogJXIiICUgKG5ld2xpbmUsKSkKICAgICAgICBpZiBlbmNvZGluZyBpcyBOb25lOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBlbmNvZGluZyA9IG9zLmRldmljZV9lbmNvZGluZyhidWZmZXIuZmlsZW5vKCkpCiAgICAgICAgICAgIGV4Y2VwdCAoQXR0cmlidXRlRXJyb3IsIFVuc3VwcG9ydGVkT3BlcmF0aW9uKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgaWYgZW5jb2RpbmcgaXMgTm9uZToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBpbXBvcnQgbG9jYWxlCiAgICAgICAgICAgICAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgICAgICAgICAgICAgIyBJbXBvcnRpbmcgbG9jYWxlIG1heSBmYWlsIGlmIFB5dGhvbiBpcyBiZWluZyBidWlsdAogICAgICAgICAgICAgICAgICAgIGVuY29kaW5nID0gImFzY2lpIgogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBlbmNvZGluZyA9IGxvY2FsZS5nZXRwcmVmZXJyZWRlbmNvZGluZygpCgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKGVuY29kaW5nLCBzdHIpOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJpbnZhbGlkIGVuY29kaW5nOiAlciIgJSBlbmNvZGluZykKCiAgICAgICAgaWYgZXJyb3JzIGlzIE5vbmU6CiAgICAgICAgICAgIGVycm9ycyA9ICJzdHJpY3QiCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoZXJyb3JzLCBzdHIpOgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiaW52YWxpZCBlcnJvcnM6ICVyIiAlIGVycm9ycykKCiAgICAgICAgc2VsZi5fYnVmZmVyID0gYnVmZmVyCiAgICAgICAgc2VsZi5fbGluZV9idWZmZXJpbmcgPSBsaW5lX2J1ZmZlcmluZwogICAgICAgIHNlbGYuX2VuY29kaW5nID0gZW5jb2RpbmcKICAgICAgICBzZWxmLl9lcnJvcnMgPSBlcnJvcnMKICAgICAgICBzZWxmLl9yZWFkdW5pdmVyc2FsID0gbm90IG5ld2xpbmUKICAgICAgICBzZWxmLl9yZWFkdHJhbnNsYXRlID0gbmV3bGluZSBpcyBOb25lCiAgICAgICAgc2VsZi5fcmVhZG5sID0gbmV3bGluZQogICAgICAgIHNlbGYuX3dyaXRldHJhbnNsYXRlID0gbmV3bGluZSAhPSAnJwogICAgICAgIHNlbGYuX3dyaXRlbmwgPSBuZXdsaW5lIG9yIG9zLmxpbmVzZXAKICAgICAgICBzZWxmLl9lbmNvZGVyID0gTm9uZQogICAgICAgIHNlbGYuX2RlY29kZXIgPSBOb25lCiAgICAgICAgc2VsZi5fZGVjb2RlZF9jaGFycyA9ICcnICAjIGJ1ZmZlciBmb3IgdGV4dCByZXR1cm5lZCBmcm9tIGRlY29kZXIKICAgICAgICBzZWxmLl9kZWNvZGVkX2NoYXJzX3VzZWQgPSAwICAjIG9mZnNldCBpbnRvIF9kZWNvZGVkX2NoYXJzIGZvciByZWFkKCkKICAgICAgICBzZWxmLl9zbmFwc2hvdCA9IE5vbmUgICMgaW5mbyBmb3IgcmVjb25zdHJ1Y3RpbmcgZGVjb2RlciBzdGF0ZQogICAgICAgIHNlbGYuX3NlZWthYmxlID0gc2VsZi5fdGVsbGluZyA9IHNlbGYuYnVmZmVyLnNlZWthYmxlKCkKICAgICAgICBzZWxmLl9oYXNfcmVhZDEgPSBoYXNhdHRyKHNlbGYuYnVmZmVyLCAncmVhZDEnKQoKICAgICAgICBpZiBzZWxmLl9zZWVrYWJsZSBhbmQgc2VsZi53cml0YWJsZSgpOgogICAgICAgICAgICBwb3NpdGlvbiA9IHNlbGYuYnVmZmVyLnRlbGwoKQogICAgICAgICAgICBpZiBwb3NpdGlvbiAhPSAwOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHNlbGYuX2dldF9lbmNvZGVyKCkuc2V0c3RhdGUoMCkKICAgICAgICAgICAgICAgIGV4Y2VwdCBMb29rdXBFcnJvcjoKICAgICAgICAgICAgICAgICAgICAjIFNvbWV0aW1lcyB0aGUgZW5jb2RlciBkb2Vzbid0IGV4aXN0CiAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAgICMgc2VsZi5fc25hcHNob3QgaXMgZWl0aGVyIE5vbmUsIG9yIGEgdHVwbGUgKGRlY19mbGFncywgbmV4dF9pbnB1dCkKICAgICMgd2hlcmUgZGVjX2ZsYWdzIGlzIHRoZSBzZWNvbmQgKGludGVnZXIpIGl0ZW0gb2YgdGhlIGRlY29kZXIgc3RhdGUKICAgICMgYW5kIG5leHRfaW5wdXQgaXMgdGhlIGNodW5rIG9mIGlucHV0IGJ5dGVzIHRoYXQgY29tZXMgbmV4dCBhZnRlciB0aGUKICAgICMgc25hcHNob3QgcG9pbnQuICBXZSB1c2UgdGhpcyB0byByZWNvbnN0cnVjdCBkZWNvZGVyIHN0YXRlcyBpbiB0ZWxsKCkuCgogICAgIyBOYW1pbmcgY29udmVudGlvbjoKICAgICMgICAtICJieXRlc18uLi4iIGZvciBpbnRlZ2VyIHZhcmlhYmxlcyB0aGF0IGNvdW50IGlucHV0IGJ5dGVzCiAgICAjICAgLSAiY2hhcnNfLi4uIiBmb3IgaW50ZWdlciB2YXJpYWJsZXMgdGhhdCBjb3VudCBkZWNvZGVkIGNoYXJhY3RlcnMKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmVzdWx0ID0gIjxfcHlpby5UZXh0SU9XcmFwcGVyIgogICAgICAgIHRyeToKICAgICAgICAgICAgbmFtZSA9IHNlbGYubmFtZQogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJlc3VsdCArPSAiIG5hbWU9ezAhcn0iLmZvcm1hdChuYW1lKQogICAgICAgIHRyeToKICAgICAgICAgICAgbW9kZSA9IHNlbGYubW9kZQogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJlc3VsdCArPSAiIG1vZGU9ezAhcn0iLmZvcm1hdChtb2RlKQogICAgICAgIHJldHVybiByZXN1bHQgKyAiIGVuY29kaW5nPXswIXJ9PiIuZm9ybWF0KHNlbGYuZW5jb2RpbmcpCgogICAgI0Bwcm9wZXJ0eQogICAgZGVmIGVuY29kaW5nKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9lbmNvZGluZwoKICAgICNAcHJvcGVydHkKICAgIGRlZiBlcnJvcnMoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX2Vycm9ycwoKICAgICNAcHJvcGVydHkKICAgIGRlZiBsaW5lX2J1ZmZlcmluZyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fbGluZV9idWZmZXJpbmcKCiAgICAjQHByb3BlcnR5CiAgICBkZWYgYnVmZmVyKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9idWZmZXIKCiAgICBkZWYgc2Vla2FibGUoc2VsZik6CiAgICAgICAgaWYgc2VsZi5jbG9zZWQ6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIkkvTyBvcGVyYXRpb24gb24gY2xvc2VkIGZpbGUuIikKICAgICAgICByZXR1cm4gc2VsZi5fc2Vla2FibGUKCiAgICBkZWYgcmVhZGFibGUoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuYnVmZmVyLnJlYWRhYmxlKCkKCiAgICBkZWYgd3JpdGFibGUoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuYnVmZmVyLndyaXRhYmxlKCkKCiAgICBkZWYgZmx1c2goc2VsZik6CiAgICAgICAgc2VsZi5idWZmZXIuZmx1c2goKQogICAgICAgIHNlbGYuX3RlbGxpbmcgPSBzZWxmLl9zZWVrYWJsZQoKICAgIGRlZiBjbG9zZShzZWxmKToKICAgICAgICBpZiBzZWxmLmJ1ZmZlciBpcyBub3QgTm9uZSBhbmQgbm90IHNlbGYuY2xvc2VkOgogICAgICAgICAgICBzZWxmLmZsdXNoKCkKICAgICAgICAgICAgc2VsZi5idWZmZXIuY2xvc2UoKQoKICAgICNAcHJvcGVydHkKICAgIGRlZiBjbG9zZWQoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuYnVmZmVyLmNsb3NlZAoKICAgICNAcHJvcGVydHkKICAgIGRlZiBuYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmJ1ZmZlci5uYW1lCgogICAgZGVmIGZpbGVubyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5idWZmZXIuZmlsZW5vKCkKCiAgICBkZWYgaXNhdHR5KHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmJ1ZmZlci5pc2F0dHkoKQoKICAgIGRlZiB3cml0ZShzZWxmLCBzKToKICAgICAgICAnV3JpdGUgZGF0YSwgd2hlcmUgcyBpcyBhIHN0cicKICAgICAgICBpZiBzZWxmLmNsb3NlZDoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigid3JpdGUgdG8gY2xvc2VkIGZpbGUiKQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHMsIHN0cik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiY2FuJ3Qgd3JpdGUgJXMgdG8gdGV4dCBzdHJlYW0iICUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHMuX19jbGFzc19fLl9fbmFtZV9fKQogICAgICAgIGxlbmd0aCA9IGxlbihzKQogICAgICAgIGhhc2xmID0gKHNlbGYuX3dyaXRldHJhbnNsYXRlIG9yIHNlbGYuX2xpbmVfYnVmZmVyaW5nKSBhbmQgIlxuIiBpbiBzCiAgICAgICAgaWYgaGFzbGYgYW5kIHNlbGYuX3dyaXRldHJhbnNsYXRlIGFuZCBzZWxmLl93cml0ZW5sICE9ICJcbiI6CiAgICAgICAgICAgIHMgPSBzLnJlcGxhY2UoIlxuIiwgc2VsZi5fd3JpdGVubCkKICAgICAgICBlbmNvZGVyID0gc2VsZi5fZW5jb2RlciBvciBzZWxmLl9nZXRfZW5jb2RlcigpCiAgICAgICAgIyBYWFggV2hhdCBpZiB3ZSB3ZXJlIGp1c3QgcmVhZGluZz8KICAgICAgICBiID0gZW5jb2Rlci5lbmNvZGUocykKICAgICAgICBzZWxmLmJ1ZmZlci53cml0ZShiKQogICAgICAgIGlmIHNlbGYuX2xpbmVfYnVmZmVyaW5nIGFuZCAoaGFzbGYgb3IgIlxyIiBpbiBzKToKICAgICAgICAgICAgc2VsZi5mbHVzaCgpCiAgICAgICAgc2VsZi5fc25hcHNob3QgPSBOb25lCiAgICAgICAgaWYgc2VsZi5fZGVjb2RlcjoKICAgICAgICAgICAgc2VsZi5fZGVjb2Rlci5yZXNldCgpCiAgICAgICAgcmV0dXJuIGxlbmd0aAoKICAgIGRlZiBfZ2V0X2VuY29kZXIoc2VsZik6CiAgICAgICAgbWFrZV9lbmNvZGVyID0gY29kZWNzLmdldGluY3JlbWVudGFsZW5jb2RlcihzZWxmLl9lbmNvZGluZykKICAgICAgICBzZWxmLl9lbmNvZGVyID0gbWFrZV9lbmNvZGVyKHNlbGYuX2Vycm9ycykKICAgICAgICByZXR1cm4gc2VsZi5fZW5jb2RlcgoKICAgIGRlZiBfZ2V0X2RlY29kZXIoc2VsZik6CiAgICAgICAgbWFrZV9kZWNvZGVyID0gY29kZWNzLmdldGluY3JlbWVudGFsZGVjb2RlcihzZWxmLl9lbmNvZGluZykKICAgICAgICBkZWNvZGVyID0gbWFrZV9kZWNvZGVyKHNlbGYuX2Vycm9ycykKICAgICAgICBpZiBzZWxmLl9yZWFkdW5pdmVyc2FsOgogICAgICAgICAgICBkZWNvZGVyID0gSW5jcmVtZW50YWxOZXdsaW5lRGVjb2RlcihkZWNvZGVyLCBzZWxmLl9yZWFkdHJhbnNsYXRlKQogICAgICAgIHNlbGYuX2RlY29kZXIgPSBkZWNvZGVyCiAgICAgICAgcmV0dXJuIGRlY29kZXIKCiAgICAjIFRoZSBmb2xsb3dpbmcgdGhyZWUgbWV0aG9kcyBpbXBsZW1lbnQgYW4gQURUIGZvciBfZGVjb2RlZF9jaGFycy4KICAgICMgVGV4dCByZXR1cm5lZCBmcm9tIHRoZSBkZWNvZGVyIGlzIGJ1ZmZlcmVkIGhlcmUgdW50aWwgdGhlIGNsaWVudAogICAgIyByZXF1ZXN0cyBpdCBieSBjYWxsaW5nIG91ciByZWFkKCkgb3IgcmVhZGxpbmUoKSBtZXRob2QuCiAgICBkZWYgX3NldF9kZWNvZGVkX2NoYXJzKHNlbGYsIGNoYXJzKToKICAgICAgICAiU2V0IHRoZSBfZGVjb2RlZF9jaGFycyBidWZmZXIuIgogICAgICAgIHNlbGYuX2RlY29kZWRfY2hhcnMgPSBjaGFycwogICAgICAgIHNlbGYuX2RlY29kZWRfY2hhcnNfdXNlZCA9IDAKCiAgICBkZWYgX2dldF9kZWNvZGVkX2NoYXJzKHNlbGYsIG49Tm9uZSk6CiAgICAgICAgIkFkdmFuY2UgaW50byB0aGUgX2RlY29kZWRfY2hhcnMgYnVmZmVyLiIKICAgICAgICBvZmZzZXQgPSBzZWxmLl9kZWNvZGVkX2NoYXJzX3VzZWQKICAgICAgICBpZiBuIGlzIE5vbmU6CiAgICAgICAgICAgIGNoYXJzID0gc2VsZi5fZGVjb2RlZF9jaGFyc1tvZmZzZXQ6XQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNoYXJzID0gc2VsZi5fZGVjb2RlZF9jaGFyc1tvZmZzZXQ6b2Zmc2V0ICsgbl0KICAgICAgICBzZWxmLl9kZWNvZGVkX2NoYXJzX3VzZWQgKz0gbGVuKGNoYXJzKQogICAgICAgIHJldHVybiBjaGFycwoKICAgIGRlZiBfcmV3aW5kX2RlY29kZWRfY2hhcnMoc2VsZiwgbik6CiAgICAgICAgIlJld2luZCB0aGUgX2RlY29kZWRfY2hhcnMgYnVmZmVyLiIKICAgICAgICBpZiBzZWxmLl9kZWNvZGVkX2NoYXJzX3VzZWQgPCBuOgogICAgICAgICAgICByYWlzZSBBc3NlcnRpb25FcnJvcigicmV3aW5kIGRlY29kZWRfY2hhcnMgb3V0IG9mIGJvdW5kcyIpCiAgICAgICAgc2VsZi5fZGVjb2RlZF9jaGFyc191c2VkIC09IG4KCiAgICBkZWYgX3JlYWRfY2h1bmsoc2VsZik6CiAgICAgICAgIlJlYWQgYW5kIGRlY29kZSB0aGUgbmV4dCBjaHVuayBvZiBkYXRhIGZyb20gdGhlIEJ1ZmZlcmVkUmVhZGVyLiIKCiAgICAgICAgIyBUaGUgcmV0dXJuIHZhbHVlIGlzIFRydWUgdW5sZXNzIEVPRiB3YXMgcmVhY2hlZC4gIFRoZSBkZWNvZGVkCiAgICAgICAgIyBzdHJpbmcgaXMgcGxhY2VkIGluIHNlbGYuX2RlY29kZWRfY2hhcnMgKHJlcGxhY2luZyBpdHMgcHJldmlvdXMKICAgICAgICAjIHZhbHVlKS4gIFRoZSBlbnRpcmUgaW5wdXQgY2h1bmsgaXMgc2VudCB0byB0aGUgZGVjb2RlciwgdGhvdWdoCiAgICAgICAgIyBzb21lIG9mIGl0IG1heSByZW1haW4gYnVmZmVyZWQgaW4gdGhlIGRlY29kZXIsIHlldCB0byBiZQogICAgICAgICMgY29udmVydGVkLgoKICAgICAgICBpZiBzZWxmLl9kZWNvZGVyIGlzIE5vbmU6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIm5vIGRlY29kZXIiKQoKICAgICAgICBpZiBzZWxmLl90ZWxsaW5nOgogICAgICAgICAgICAjIFRvIHByZXBhcmUgZm9yIHRlbGwoKSwgd2UgbmVlZCB0byBzbmFwc2hvdCBhIHBvaW50IGluIHRoZQogICAgICAgICAgICAjIGZpbGUgd2hlcmUgdGhlIGRlY29kZXIncyBpbnB1dCBidWZmZXIgaXMgZW1wdHkuCgogICAgICAgICAgICBkZWNfYnVmZmVyLCBkZWNfZmxhZ3MgPSBzZWxmLl9kZWNvZGVyLmdldHN0YXRlKCkKICAgICAgICAgICAgIyBHaXZlbiB0aGlzLCB3ZSBrbm93IHRoZXJlIHdhcyBhIHZhbGlkIHNuYXBzaG90IHBvaW50CiAgICAgICAgICAgICMgbGVuKGRlY19idWZmZXIpIGJ5dGVzIGFnbyB3aXRoIGRlY29kZXIgc3RhdGUgKGInJywgZGVjX2ZsYWdzKS4KCiAgICAgICAgIyBSZWFkIGEgY2h1bmssIGRlY29kZSBpdCwgYW5kIHB1dCB0aGUgcmVzdWx0IGluIHNlbGYuX2RlY29kZWRfY2hhcnMuCiAgICAgICAgaWYgc2VsZi5faGFzX3JlYWQxOgogICAgICAgICAgICBpbnB1dF9jaHVuayA9IHNlbGYuYnVmZmVyLnJlYWQxKHNlbGYuX0NIVU5LX1NJWkUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaW5wdXRfY2h1bmsgPSBzZWxmLmJ1ZmZlci5yZWFkKHNlbGYuX0NIVU5LX1NJWkUpCiAgICAgICAgZW9mID0gbm90IGlucHV0X2NodW5rCiAgICAgICAgc2VsZi5fc2V0X2RlY29kZWRfY2hhcnMoc2VsZi5fZGVjb2Rlci5kZWNvZGUoaW5wdXRfY2h1bmssIGVvZikpCgogICAgICAgIGlmIHNlbGYuX3RlbGxpbmc6CiAgICAgICAgICAgICMgQXQgdGhlIHNuYXBzaG90IHBvaW50LCBsZW4oZGVjX2J1ZmZlcikgYnl0ZXMgYmVmb3JlIHRoZSByZWFkLAogICAgICAgICAgICAjIHRoZSBuZXh0IGlucHV0IHRvIGJlIGRlY29kZWQgaXMgZGVjX2J1ZmZlciArIGlucHV0X2NodW5rLgogICAgICAgICAgICBzZWxmLl9zbmFwc2hvdCA9IChkZWNfZmxhZ3MsIGRlY19idWZmZXIgKyBpbnB1dF9jaHVuaykKCiAgICAgICAgcmV0dXJuIG5vdCBlb2YKCiAgICBkZWYgX3BhY2tfY29va2llKHNlbGYsIHBvc2l0aW9uLCBkZWNfZmxhZ3M9MCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgYnl0ZXNfdG9fZmVlZD0wLCBuZWVkX2VvZj0wLCBjaGFyc190b19za2lwPTApOgogICAgICAgICMgVGhlIG1lYW5pbmcgb2YgYSB0ZWxsKCkgY29va2llIGlzOiBzZWVrIHRvIHBvc2l0aW9uLCBzZXQgdGhlCiAgICAgICAgIyBkZWNvZGVyIGZsYWdzIHRvIGRlY19mbGFncywgcmVhZCBieXRlc190b19mZWVkIGJ5dGVzLCBmZWVkIHRoZW0KICAgICAgICAjIGludG8gdGhlIGRlY29kZXIgd2l0aCBuZWVkX2VvZiBhcyB0aGUgRU9GIGZsYWcsIHRoZW4gc2tpcAogICAgICAgICMgY2hhcnNfdG9fc2tpcCBjaGFyYWN0ZXJzIG9mIHRoZSBkZWNvZGVkIHJlc3VsdC4gIEZvciBtb3N0IHNpbXBsZQogICAgICAgICMgZGVjb2RlcnMsIHRlbGwoKSB3aWxsIG9mdGVuIGp1c3QgZ2l2ZSBhIGJ5dGUgb2Zmc2V0IGluIHRoZSBmaWxlLgogICAgICAgIHJldHVybiAocG9zaXRpb24gfCAoZGVjX2ZsYWdzPDw2NCkgfCAoYnl0ZXNfdG9fZmVlZDw8MTI4KSB8CiAgICAgICAgICAgICAgIChjaGFyc190b19za2lwPDwxOTIpIHwgYm9vbChuZWVkX2VvZik8PDI1NikKCiAgICBkZWYgX3VucGFja19jb29raWUoc2VsZiwgYmlnaW50KToKICAgICAgICByZXN0LCBwb3NpdGlvbiA9IGRpdm1vZChiaWdpbnQsIDE8PDY0KQogICAgICAgIHJlc3QsIGRlY19mbGFncyA9IGRpdm1vZChyZXN0LCAxPDw2NCkKICAgICAgICByZXN0LCBieXRlc190b19mZWVkID0gZGl2bW9kKHJlc3QsIDE8PDY0KQogICAgICAgIG5lZWRfZW9mLCBjaGFyc190b19za2lwID0gZGl2bW9kKHJlc3QsIDE8PDY0KQogICAgICAgIHJldHVybiBwb3NpdGlvbiwgZGVjX2ZsYWdzLCBieXRlc190b19mZWVkLCBuZWVkX2VvZiwgY2hhcnNfdG9fc2tpcAogICAgIiIiCiAgICAjIyAjZml4bWUgSSBkaWRuJ3Qga25vdyB0aGF0IGZvci4uIGVsc2UgY291bGQgZXZlbiBvY2N1ciEgOigKICAgIGRlZiB0ZWxsKHNlbGYpOgogICAgICAgIGlmIG5vdCBzZWxmLl9zZWVrYWJsZToKICAgICAgICAgICAgcmFpc2UgVW5zdXBwb3J0ZWRPcGVyYXRpb24oInVuZGVybHlpbmcgc3RyZWFtIGlzIG5vdCBzZWVrYWJsZSIpCiAgICAgICAgaWYgbm90IHNlbGYuX3RlbGxpbmc6CiAgICAgICAgICAgIHJhaXNlIElPRXJyb3IoInRlbGxpbmcgcG9zaXRpb24gZGlzYWJsZWQgYnkgbmV4dCgpIGNhbGwiKQogICAgICAgIHNlbGYuZmx1c2goKQogICAgICAgIHBvc2l0aW9uID0gc2VsZi5idWZmZXIudGVsbCgpCiAgICAgICAgZGVjb2RlciA9IHNlbGYuX2RlY29kZXIKICAgICAgICBpZiBkZWNvZGVyIGlzIE5vbmUgb3Igc2VsZi5fc25hcHNob3QgaXMgTm9uZToKICAgICAgICAgICAgaWYgc2VsZi5fZGVjb2RlZF9jaGFyczoKICAgICAgICAgICAgICAgICMgVGhpcyBzaG91bGQgbmV2ZXIgaGFwcGVuLgogICAgICAgICAgICAgICAgcmFpc2UgQXNzZXJ0aW9uRXJyb3IoInBlbmRpbmcgZGVjb2RlZCB0ZXh0IikKICAgICAgICAgICAgcmV0dXJuIHBvc2l0aW9uCgogICAgICAgICMgU2tpcCBiYWNrd2FyZCB0byB0aGUgc25hcHNob3QgcG9pbnQgKHNlZSBfcmVhZF9jaHVuaykuCiAgICAgICAgZGVjX2ZsYWdzLCBuZXh0X2lucHV0ID0gc2VsZi5fc25hcHNob3QKICAgICAgICBwb3NpdGlvbiAtPSBsZW4obmV4dF9pbnB1dCkKCiAgICAgICAgIyBIb3cgbWFueSBkZWNvZGVkIGNoYXJhY3RlcnMgaGF2ZSBiZWVuIHVzZWQgdXAgc2luY2UgdGhlIHNuYXBzaG90PwogICAgICAgIGNoYXJzX3RvX3NraXAgPSBzZWxmLl9kZWNvZGVkX2NoYXJzX3VzZWQKICAgICAgICBpZiBjaGFyc190b19za2lwID09IDA6CiAgICAgICAgICAgICMgV2UgaGF2ZW4ndCBtb3ZlZCBmcm9tIHRoZSBzbmFwc2hvdCBwb2ludC4KICAgICAgICAgICAgcmV0dXJuIHNlbGYuX3BhY2tfY29va2llKHBvc2l0aW9uLCBkZWNfZmxhZ3MpCgogICAgICAgICMgU3RhcnRpbmcgZnJvbSB0aGUgc25hcHNob3QgcG9zaXRpb24sIHdlIHdpbGwgd2FsayB0aGUgZGVjb2RlcgogICAgICAgICMgZm9yd2FyZCB1bnRpbCBpdCBnaXZlcyB1cyBlbm91Z2ggZGVjb2RlZCBjaGFyYWN0ZXJzLgogICAgICAgIHNhdmVkX3N0YXRlID0gZGVjb2Rlci5nZXRzdGF0ZSgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICAjIE5vdGUgb3VyIGluaXRpYWwgc3RhcnQgcG9pbnQuCiAgICAgICAgICAgICNkZWNvZGVyLnNldHN0YXRlKChiJycsIGRlY19mbGFncykpICAjZml4bWUKICAgICAgICAgICAgZGVjb2Rlci5zZXRzdGF0ZSgoJycsIGRlY19mbGFncykpCiAgICAgICAgICAgIHN0YXJ0X3BvcyA9IHBvc2l0aW9uCiAgICAgICAgICAgIHN0YXJ0X2ZsYWdzLCBieXRlc19mZWQsIGNoYXJzX2RlY29kZWQgPSBkZWNfZmxhZ3MsIDAsIDAKICAgICAgICAgICAgbmVlZF9lb2YgPSAwCgogICAgICAgICAgICAjIEZlZWQgdGhlIGRlY29kZXIgb25lIGJ5dGUgYXQgYSB0aW1lLiAgQXMgd2UgZ28sIG5vdGUgdGhlCiAgICAgICAgICAgICMgbmVhcmVzdCAic2FmZSBzdGFydCBwb2ludCIgYmVmb3JlIHRoZSBjdXJyZW50IGxvY2F0aW9uCiAgICAgICAgICAgICMgKGEgcG9pbnQgd2hlcmUgdGhlIGRlY29kZXIgaGFzIG5vdGhpbmcgYnVmZmVyZWQsIHNvIHNlZWsoKQogICAgICAgICAgICAjIGNhbiBzYWZlbHkgc3RhcnQgZnJvbSB0aGVyZSBhbmQgYWR2YW5jZSB0byB0aGlzIGxvY2F0aW9uKS4KICAgICAgICAgICAgbmV4dF9ieXRlID0gYnl0ZWFycmF5KDEpCiAgICAgICAgICAgICNmb3IgbmV4dF9ieXRlWzBdIGluIG5leHRfaW5wdXQ6ICAgI2ZpeG1lCiAgICAgICAgICAgIGZvciBfaSBpbiBuZXh0X2lucHV0OgogICAgICAgICAgICAgICAgbmV4dF9ieXRlWzBdPV9pCiAgICAgICAgICAgICAgICBieXRlc19mZWQgKz0gMQogICAgICAgICAgICAgICAgY2hhcnNfZGVjb2RlZCArPSBsZW4oZGVjb2Rlci5kZWNvZGUobmV4dF9ieXRlKSkKICAgICAgICAgICAgICAgIGRlY19idWZmZXIsIGRlY19mbGFncyA9IGRlY29kZXIuZ2V0c3RhdGUoKQogICAgICAgICAgICAgICAgaWYgbm90IGRlY19idWZmZXIgYW5kIGNoYXJzX2RlY29kZWQgPD0gY2hhcnNfdG9fc2tpcDoKICAgICAgICAgICAgICAgICAgICAjIERlY29kZXIgYnVmZmVyIGlzIGVtcHR5LCBzbyB0aGlzIGlzIGEgc2FmZSBzdGFydCBwb2ludC4KICAgICAgICAgICAgICAgICAgICBzdGFydF9wb3MgKz0gYnl0ZXNfZmVkCiAgICAgICAgICAgICAgICAgICAgY2hhcnNfdG9fc2tpcCAtPSBjaGFyc19kZWNvZGVkCiAgICAgICAgICAgICAgICAgICAgc3RhcnRfZmxhZ3MsIGJ5dGVzX2ZlZCwgY2hhcnNfZGVjb2RlZCA9IGRlY19mbGFncywgMCwgMAogICAgICAgICAgICAgICAgaWYgY2hhcnNfZGVjb2RlZCA+PSBjaGFyc190b19za2lwOgogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAjIFdlIGRpZG4ndCBnZXQgZW5vdWdoIGRlY29kZWQgZGF0YTsgc2lnbmFsIEVPRiB0byBnZXQgbW9yZS4KICAgICAgICAgICAgICAgICNjaGFyc19kZWNvZGVkICs9IGxlbihkZWNvZGVyLmRlY29kZShiJycsIGZpbmFsPVRydWUpKQogICAgICAgICAgICAgICAgY2hhcnNfZGVjb2RlZCArPSBsZW4oZGVjb2Rlci5kZWNvZGUoJycsIGZpbmFsPVRydWUpKSAgI2ZpeG1lCiAgICAgICAgICAgICAgICBuZWVkX2VvZiA9IDEKICAgICAgICAgICAgICAgIGlmIGNoYXJzX2RlY29kZWQgPCBjaGFyc190b19za2lwOgogICAgICAgICAgICAgICAgICAgIHJhaXNlIElPRXJyb3IoImNhbid0IHJlY29uc3RydWN0IGxvZ2ljYWwgZmlsZSBwb3NpdGlvbiIpCgogICAgICAgICAgICAjIFRoZSByZXR1cm5lZCBjb29raWUgY29ycmVzcG9uZHMgdG8gdGhlIGxhc3Qgc2FmZSBzdGFydCBwb2ludC4KICAgICAgICAgICAgcmV0dXJuIHNlbGYuX3BhY2tfY29va2llKAogICAgICAgICAgICAgICAgc3RhcnRfcG9zLCBzdGFydF9mbGFncywgYnl0ZXNfZmVkLCBuZWVkX2VvZiwgY2hhcnNfdG9fc2tpcCkKICAgICAgICAjZXhjZXB0OiAgI2ZpeG1lCiAgICAgICAgIyAgICBhPTEgICMgcGFzcyAjZml4bWUKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBkZWNvZGVyLnNldHN0YXRlKHNhdmVkX3N0YXRlKQogICAgIiIiCiAgICBkZWYgdHJ1bmNhdGUoc2VsZiwgcG9zPU5vbmUpOgogICAgICAgIHNlbGYuZmx1c2goKQogICAgICAgIGlmIHBvcyBpcyBOb25lOgogICAgICAgICAgICBwb3MgPSBzZWxmLnRlbGwoKQogICAgICAgIHJldHVybiBzZWxmLmJ1ZmZlci50cnVuY2F0ZShwb3MpCgogICAgZGVmIGRldGFjaChzZWxmKToKICAgICAgICBpZiBzZWxmLmJ1ZmZlciBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJidWZmZXIgaXMgYWxyZWFkeSBkZXRhY2hlZCIpCiAgICAgICAgc2VsZi5mbHVzaCgpCiAgICAgICAgYnVmZmVyID0gc2VsZi5fYnVmZmVyCiAgICAgICAgc2VsZi5fYnVmZmVyID0gTm9uZQogICAgICAgIHJldHVybiBidWZmZXIKCiAgICBkZWYgc2VlayhzZWxmLCBjb29raWUsIHdoZW5jZT0wKToKICAgICAgICBpZiBzZWxmLmNsb3NlZDoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigidGVsbCBvbiBjbG9zZWQgZmlsZSIpCiAgICAgICAgaWYgbm90IHNlbGYuX3NlZWthYmxlOgogICAgICAgICAgICByYWlzZSBVbnN1cHBvcnRlZE9wZXJhdGlvbigidW5kZXJseWluZyBzdHJlYW0gaXMgbm90IHNlZWthYmxlIikKICAgICAgICBpZiB3aGVuY2UgPT0gMTogIyBzZWVrIHJlbGF0aXZlIHRvIGN1cnJlbnQgcG9zaXRpb24KICAgICAgICAgICAgaWYgY29va2llICE9IDA6CiAgICAgICAgICAgICAgICByYWlzZSBVbnN1cHBvcnRlZE9wZXJhdGlvbigiY2FuJ3QgZG8gbm9uemVybyBjdXItcmVsYXRpdmUgc2Vla3MiKQogICAgICAgICAgICAjIFNlZWtpbmcgdG8gdGhlIGN1cnJlbnQgcG9zaXRpb24gc2hvdWxkIGF0dGVtcHQgdG8KICAgICAgICAgICAgIyBzeW5jIHRoZSB1bmRlcmx5aW5nIGJ1ZmZlciB3aXRoIHRoZSBjdXJyZW50IHBvc2l0aW9uLgogICAgICAgICAgICB3aGVuY2UgPSAwCiAgICAgICAgICAgIGNvb2tpZSA9IHNlbGYudGVsbCgpCiAgICAgICAgaWYgd2hlbmNlID09IDI6ICMgc2VlayByZWxhdGl2ZSB0byBlbmQgb2YgZmlsZQogICAgICAgICAgICBpZiBjb29raWUgIT0gMDoKICAgICAgICAgICAgICAgIHJhaXNlIFVuc3VwcG9ydGVkT3BlcmF0aW9uKCJjYW4ndCBkbyBub256ZXJvIGVuZC1yZWxhdGl2ZSBzZWVrcyIpCiAgICAgICAgICAgIHNlbGYuZmx1c2goKQogICAgICAgICAgICBwb3NpdGlvbiA9IHNlbGYuYnVmZmVyLnNlZWsoMCwgMikKICAgICAgICAgICAgc2VsZi5fc2V0X2RlY29kZWRfY2hhcnMoJycpCiAgICAgICAgICAgIHNlbGYuX3NuYXBzaG90ID0gTm9uZQogICAgICAgICAgICBpZiBzZWxmLl9kZWNvZGVyOgogICAgICAgICAgICAgICAgc2VsZi5fZGVjb2Rlci5yZXNldCgpCiAgICAgICAgICAgIHJldHVybiBwb3NpdGlvbgogICAgICAgIGlmIHdoZW5jZSAhPSAwOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJpbnZhbGlkIHdoZW5jZSAoJXIsIHNob3VsZCBiZSAwLCAxIG9yIDIpIiAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHdoZW5jZSwpKQogICAgICAgIGlmIGNvb2tpZSA8IDA6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIm5lZ2F0aXZlIHNlZWsgcG9zaXRpb24gJXIiICUgKGNvb2tpZSwpKQogICAgICAgIHNlbGYuZmx1c2goKQoKICAgICAgICAjIFRoZSBzdHJhdGVneSBvZiBzZWVrKCkgaXMgdG8gZ28gYmFjayB0byB0aGUgc2FmZSBzdGFydCBwb2ludAogICAgICAgICMgYW5kIHJlcGxheSB0aGUgZWZmZWN0IG9mIHJlYWQoY2hhcnNfdG9fc2tpcCkgZnJvbSB0aGVyZS4KICAgICAgICBzdGFydF9wb3MsIGRlY19mbGFncywgYnl0ZXNfdG9fZmVlZCwgbmVlZF9lb2YsIGNoYXJzX3RvX3NraXAgPSBcCiAgICAgICAgICAgIHNlbGYuX3VucGFja19jb29raWUoY29va2llKQoKICAgICAgICAjIFNlZWsgYmFjayB0byB0aGUgc2FmZSBzdGFydCBwb2ludC4KICAgICAgICBzZWxmLmJ1ZmZlci5zZWVrKHN0YXJ0X3BvcykKICAgICAgICBzZWxmLl9zZXRfZGVjb2RlZF9jaGFycygnJykKICAgICAgICBzZWxmLl9zbmFwc2hvdCA9IE5vbmUKCiAgICAgICAgIyBSZXN0b3JlIHRoZSBkZWNvZGVyIHRvIGl0cyBzdGF0ZSBmcm9tIHRoZSBzYWZlIHN0YXJ0IHBvaW50LgogICAgICAgIGlmIGNvb2tpZSA9PSAwIGFuZCBzZWxmLl9kZWNvZGVyOgogICAgICAgICAgICBzZWxmLl9kZWNvZGVyLnJlc2V0KCkKICAgICAgICBlbGlmIHNlbGYuX2RlY29kZXIgb3IgZGVjX2ZsYWdzIG9yIGNoYXJzX3RvX3NraXA6CiAgICAgICAgICAgIHNlbGYuX2RlY29kZXIgPSBzZWxmLl9kZWNvZGVyIG9yIHNlbGYuX2dldF9kZWNvZGVyKCkKICAgICAgICAgICAgI3NlbGYuX2RlY29kZXIuc2V0c3RhdGUoKGInJywgZGVjX2ZsYWdzKSkgI2ZpeG1lCiAgICAgICAgICAgIHNlbGYuX2RlY29kZXIuc2V0c3RhdGUoKCcnLCBkZWNfZmxhZ3MpKQogICAgICAgICAgICAjc2VsZi5fc25hcHNob3QgPSAoZGVjX2ZsYWdzLCBiJycpICAgI2ZpeG1lCiAgICAgICAgICAgIHNlbGYuX3NuYXBzaG90ID0gKGRlY19mbGFncywgJycpICAgCgogICAgICAgIGlmIGNoYXJzX3RvX3NraXA6CiAgICAgICAgICAgICMgSnVzdCBsaWtlIF9yZWFkX2NodW5rLCBmZWVkIHRoZSBkZWNvZGVyIGFuZCBzYXZlIGEgc25hcHNob3QuCiAgICAgICAgICAgIGlucHV0X2NodW5rID0gc2VsZi5idWZmZXIucmVhZChieXRlc190b19mZWVkKQogICAgICAgICAgICBzZWxmLl9zZXRfZGVjb2RlZF9jaGFycygKICAgICAgICAgICAgICAgIHNlbGYuX2RlY29kZXIuZGVjb2RlKGlucHV0X2NodW5rLCBuZWVkX2VvZikpCiAgICAgICAgICAgIHNlbGYuX3NuYXBzaG90ID0gKGRlY19mbGFncywgaW5wdXRfY2h1bmspCgogICAgICAgICAgICAjIFNraXAgY2hhcnNfdG9fc2tpcCBvZiB0aGUgZGVjb2RlZCBjaGFyYWN0ZXJzLgogICAgICAgICAgICBpZiBsZW4oc2VsZi5fZGVjb2RlZF9jaGFycykgPCBjaGFyc190b19za2lwOgogICAgICAgICAgICAgICAgcmFpc2UgSU9FcnJvcigiY2FuJ3QgcmVzdG9yZSBsb2dpY2FsIGZpbGUgcG9zaXRpb24iKQogICAgICAgICAgICBzZWxmLl9kZWNvZGVkX2NoYXJzX3VzZWQgPSBjaGFyc190b19za2lwCgogICAgICAgICMgRmluYWxseSwgcmVzZXQgdGhlIGVuY29kZXIgKG1lcmVseSB1c2VmdWwgZm9yIHByb3BlciBCT00gaGFuZGxpbmcpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBlbmNvZGVyID0gc2VsZi5fZW5jb2RlciBvciBzZWxmLl9nZXRfZW5jb2RlcigpCiAgICAgICAgZXhjZXB0IExvb2t1cEVycm9yOgogICAgICAgICAgICAjIFNvbWV0aW1lcyB0aGUgZW5jb2RlciBkb2Vzbid0IGV4aXN0CiAgICAgICAgICAgIGE9MSAgICNmaXhtZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIGNvb2tpZSAhPSAwOgogICAgICAgICAgICAgICAgZW5jb2Rlci5zZXRzdGF0ZSgwKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZW5jb2Rlci5yZXNldCgpCiAgICAgICAgcmV0dXJuIGNvb2tpZQoKICAgIGRlZiByZWFkKHNlbGYsIG49Tm9uZSk6CiAgICAgICAgc2VsZi5fY2hlY2tSZWFkYWJsZSgpCiAgICAgICAgaWYgbiBpcyBOb25lOgogICAgICAgICAgICBuID0gLTEKICAgICAgICBkZWNvZGVyID0gc2VsZi5fZGVjb2RlciBvciBzZWxmLl9nZXRfZGVjb2RlcigpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBuLl9faW5kZXhfXwogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvciBhcyBlcnI6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiYW4gaW50ZWdlciBpcyByZXF1aXJlZCIpICNmcm9tIGVyciAgI2ZpeG1lCiAgICAgICAgaWYgbiA8IDA6CiAgICAgICAgICAgICMgUmVhZCBldmVyeXRoaW5nLgogICAgICAgICAgICByZXN1bHQgPSAoc2VsZi5fZ2V0X2RlY29kZWRfY2hhcnMoKSArCiAgICAgICAgICAgICAgICAgICAgICBkZWNvZGVyLmRlY29kZShzZWxmLmJ1ZmZlci5yZWFkKCksIGZpbmFsPVRydWUpKQogICAgICAgICAgICBzZWxmLl9zZXRfZGVjb2RlZF9jaGFycygnJykKICAgICAgICAgICAgc2VsZi5fc25hcHNob3QgPSBOb25lCiAgICAgICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIEtlZXAgcmVhZGluZyBjaHVua3MgdW50aWwgd2UgaGF2ZSBuIGNoYXJhY3RlcnMgdG8gcmV0dXJuLgogICAgICAgICAgICBlb2YgPSBGYWxzZQogICAgICAgICAgICByZXN1bHQgPSBzZWxmLl9nZXRfZGVjb2RlZF9jaGFycyhuKQogICAgICAgICAgICB3aGlsZSBsZW4ocmVzdWx0KSA8IG4gYW5kIG5vdCBlb2Y6CiAgICAgICAgICAgICAgICBlb2YgPSBub3Qgc2VsZi5fcmVhZF9jaHVuaygpCiAgICAgICAgICAgICAgICByZXN1bHQgKz0gc2VsZi5fZ2V0X2RlY29kZWRfY2hhcnMobiAtIGxlbihyZXN1bHQpKQogICAgICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIF9fbmV4dF9fKHNlbGYpOgogICAgICAgIHNlbGYuX3RlbGxpbmcgPSBGYWxzZQogICAgICAgIGxpbmUgPSBzZWxmLnJlYWRsaW5lKCkKICAgICAgICBpZiBub3QgbGluZToKICAgICAgICAgICAgc2VsZi5fc25hcHNob3QgPSBOb25lCiAgICAgICAgICAgIHNlbGYuX3RlbGxpbmcgPSBzZWxmLl9zZWVrYWJsZQogICAgICAgICAgICByYWlzZSBTdG9wSXRlcmF0aW9uCiAgICAgICAgcmV0dXJuIGxpbmUKCiAgICBkZWYgcmVhZGxpbmUoc2VsZiwgbGltaXQ9Tm9uZSk6CiAgICAgICAgaWYgc2VsZi5jbG9zZWQ6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoInJlYWQgZnJvbSBjbG9zZWQgZmlsZSIpCiAgICAgICAgaWYgbGltaXQgaXMgTm9uZToKICAgICAgICAgICAgbGltaXQgPSAtMQogICAgICAgIGVsaWYgbm90IGlzaW5zdGFuY2UobGltaXQsIGludCk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigibGltaXQgbXVzdCBiZSBhbiBpbnRlZ2VyIikKCiAgICAgICAgIyBHcmFiIGFsbCB0aGUgZGVjb2RlZCB0ZXh0ICh3ZSB3aWxsIHJld2luZCBhbnkgZXh0cmEgYml0cyBsYXRlcikuCiAgICAgICAgbGluZSA9IHNlbGYuX2dldF9kZWNvZGVkX2NoYXJzKCkKCiAgICAgICAgc3RhcnQgPSAwCiAgICAgICAgIyBNYWtlIHRoZSBkZWNvZGVyIGlmIGl0IGRvZXNuJ3QgYWxyZWFkeSBleGlzdC4KICAgICAgICBpZiBub3Qgc2VsZi5fZGVjb2RlcjoKICAgICAgICAgICAgc2VsZi5fZ2V0X2RlY29kZXIoKQoKICAgICAgICBwb3MgPSBlbmRwb3MgPSBOb25lCiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgaWYgc2VsZi5fcmVhZHRyYW5zbGF0ZToKICAgICAgICAgICAgICAgICMgTmV3bGluZXMgYXJlIGFscmVhZHkgdHJhbnNsYXRlZCwgb25seSBzZWFyY2ggZm9yIFxuCiAgICAgICAgICAgICAgICBwb3MgPSBsaW5lLmZpbmQoJ1xuJywgc3RhcnQpCiAgICAgICAgICAgICAgICBpZiBwb3MgPj0gMDoKICAgICAgICAgICAgICAgICAgICBlbmRwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBsZW4obGluZSkKCiAgICAgICAgICAgIGVsaWYgc2VsZi5fcmVhZHVuaXZlcnNhbDoKICAgICAgICAgICAgICAgICMgVW5pdmVyc2FsIG5ld2xpbmUgc2VhcmNoLiBGaW5kIGFueSBvZiBcciwgXHJcbiwgXG4KICAgICAgICAgICAgICAgICMgVGhlIGRlY29kZXIgZW5zdXJlcyB0aGF0IFxyXG4gYXJlIG5vdCBzcGxpdCBpbiB0d28gcGllY2VzCgogICAgICAgICAgICAgICAgIyBJbiBDIHdlJ2QgbG9vayBmb3IgdGhlc2UgaW4gcGFyYWxsZWwgb2YgY291cnNlLgogICAgICAgICAgICAgICAgbmxwb3MgPSBsaW5lLmZpbmQoIlxuIiwgc3RhcnQpCiAgICAgICAgICAgICAgICBjcnBvcyA9IGxpbmUuZmluZCgiXHIiLCBzdGFydCkKICAgICAgICAgICAgICAgIGlmIGNycG9zID09IC0xOgogICAgICAgICAgICAgICAgICAgIGlmIG5scG9zID09IC0xOgogICAgICAgICAgICAgICAgICAgICAgICAjIE5vdGhpbmcgZm91bmQKICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBsZW4obGluZSkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAjIEZvdW5kIFxuCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZHBvcyA9IG5scG9zICsgMQogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgZWxpZiBubHBvcyA9PSAtMToKICAgICAgICAgICAgICAgICAgICAjIEZvdW5kIGxvbmUgXHIKICAgICAgICAgICAgICAgICAgICBlbmRwb3MgPSBjcnBvcyArIDEKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgZWxpZiBubHBvcyA8IGNycG9zOgogICAgICAgICAgICAgICAgICAgICMgRm91bmQgXG4KICAgICAgICAgICAgICAgICAgICBlbmRwb3MgPSBubHBvcyArIDEKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgZWxpZiBubHBvcyA9PSBjcnBvcyArIDE6CiAgICAgICAgICAgICAgICAgICAgIyBGb3VuZCBcclxuCiAgICAgICAgICAgICAgICAgICAgZW5kcG9zID0gY3Jwb3MgKyAyCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgIyBGb3VuZCBccgogICAgICAgICAgICAgICAgICAgIGVuZHBvcyA9IGNycG9zICsgMQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAjIG5vbi11bml2ZXJzYWwKICAgICAgICAgICAgICAgIHBvcyA9IGxpbmUuZmluZChzZWxmLl9yZWFkbmwpCiAgICAgICAgICAgICAgICBpZiBwb3MgPj0gMDoKICAgICAgICAgICAgICAgICAgICBlbmRwb3MgPSBwb3MgKyBsZW4oc2VsZi5fcmVhZG5sKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICBpZiBsaW1pdCA+PSAwIGFuZCBsZW4obGluZSkgPj0gbGltaXQ6CiAgICAgICAgICAgICAgICBlbmRwb3MgPSBsaW1pdCAgIyByZWFjaGVkIGxlbmd0aCBsaW1pdAogICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgICAgICMgTm8gbGluZSBlbmRpbmcgc2VlbiB5ZXQgLSBnZXQgbW9yZSBkYXRhJwogICAgICAgICAgICB3aGlsZSBzZWxmLl9yZWFkX2NodW5rKCk6CiAgICAgICAgICAgICAgICBpZiBzZWxmLl9kZWNvZGVkX2NoYXJzOgogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGlmIHNlbGYuX2RlY29kZWRfY2hhcnM6CiAgICAgICAgICAgICAgICBsaW5lICs9IHNlbGYuX2dldF9kZWNvZGVkX2NoYXJzKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICMgZW5kIG9mIGZpbGUKICAgICAgICAgICAgICAgIHNlbGYuX3NldF9kZWNvZGVkX2NoYXJzKCcnKQogICAgICAgICAgICAgICAgc2VsZi5fc25hcHNob3QgPSBOb25lCiAgICAgICAgICAgICAgICByZXR1cm4gbGluZQoKICAgICAgICBpZiBsaW1pdCA+PSAwIGFuZCBlbmRwb3MgPiBsaW1pdDoKICAgICAgICAgICAgZW5kcG9zID0gbGltaXQgICMgZG9uJ3QgZXhjZWVkIGxpbWl0CgogICAgICAgICMgUmV3aW5kIF9kZWNvZGVkX2NoYXJzIHRvIGp1c3QgYWZ0ZXIgdGhlIGxpbmUgZW5kaW5nIHdlIGZvdW5kLgogICAgICAgIHNlbGYuX3Jld2luZF9kZWNvZGVkX2NoYXJzKGxlbihsaW5lKSAtIGVuZHBvcykKICAgICAgICByZXR1cm4gbGluZVs6ZW5kcG9zXQoKICAgICNAcHJvcGVydHkKICAgIGRlZiBuZXdsaW5lcyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fZGVjb2Rlci5uZXdsaW5lcyBpZiBzZWxmLl9kZWNvZGVyIGVsc2UgTm9uZQoKCmNsYXNzIFN0cmluZ0lPKFRleHRJT1dyYXBwZXIpOgogICAgIyJUZXh0IEkvTyBpbXBsZW1lbnRhdGlvbiB1c2luZyBhbiBpbi1tZW1vcnkgYnVmZmVyLgoKICAgICNUaGUgaW5pdGlhbF92YWx1ZSBhcmd1bWVudCBzZXRzIHRoZSB2YWx1ZSBvZiBvYmplY3QuICBUaGUgbmV3bGluZQogICAgI2FyZ3VtZW50IGlzIGxpa2UgdGhlIG9uZSBvZiBUZXh0SU9XcmFwcGVyJ3MgY29uc3RydWN0b3IuCiAgICAjIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpbml0aWFsX3ZhbHVlPSIiLCBuZXdsaW5lPSJcbiIpOgogICAgICAgICNzdXBlcihTdHJpbmdJTywgc2VsZikuX19pbml0X18oQnl0ZXNJTygpLCAgICAjZml4bWUKICAgICAgICBUZXh0SU9XcmFwcGVyLl9faW5pdF9fKHNlbGYsIEJ5dGVzSU8oKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2Rpbmc9InV0Zi04IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JzPSJzdHJpY3QiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdsaW5lPW5ld2xpbmUpCiAgICAgICAgIyBJc3N1ZSAjNTY0NTogbWFrZSB1bml2ZXJzYWwgbmV3bGluZXMgc2VtYW50aWNzIHRoZSBzYW1lIGFzIGluIHRoZQogICAgICAgICMgQyB2ZXJzaW9uLCBldmVuIHVuZGVyIFdpbmRvd3MuCiAgICAgICAgaWYgbmV3bGluZSBpcyBOb25lOgogICAgICAgICAgICBzZWxmLl93cml0ZXRyYW5zbGF0ZSA9IEZhbHNlCiAgICAgICAgaWYgaW5pdGlhbF92YWx1ZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoaW5pdGlhbF92YWx1ZSwgc3RyKToKICAgICAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiaW5pdGlhbF92YWx1ZSBtdXN0IGJlIHN0ciBvciBOb25lLCBub3QgezB9IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JtYXQodHlwZShpbml0aWFsX3ZhbHVlKS5fX25hbWVfXykpCiAgICAgICAgICAgICAgICBpbml0aWFsX3ZhbHVlID0gc3RyKGluaXRpYWxfdmFsdWUpCiAgICAgICAgICAgIHNlbGYud3JpdGUoaW5pdGlhbF92YWx1ZSkKICAgICAgICAgICAgc2VsZi5zZWVrKDApCgogICAgZGVmIGdldHZhbHVlKHNlbGYpOgogICAgICAgIHNlbGYuZmx1c2goKQogICAgICAgIHJldHVybiBzZWxmLmJ1ZmZlci5nZXR2YWx1ZSgpLmRlY29kZShzZWxmLl9lbmNvZGluZywgc2VsZi5fZXJyb3JzKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICAjIFRleHRJT1dyYXBwZXIgdGVsbHMgdGhlIGVuY29kaW5nIGluIGl0cyByZXByLiBJbiBTdHJpbmdJTywKICAgICAgICAjIHRoYXQncyBhIGltcGxlbWVudGF0aW9uIGRldGFpbC4KICAgICAgICByZXR1cm4gb2JqZWN0Ll9fcmVwcl9fKHNlbGYpCgogICAgI0Bwcm9wZXJ0eQogICAgZGVmIGVycm9ycyhzZWxmKToKICAgICAgICByZXR1cm4gTm9uZQoKICAgICNAcHJvcGVydHkKICAgIGRlZiBlbmNvZGluZyhzZWxmKToKICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBkZXRhY2goc2VsZik6CiAgICAgICAgIyBUaGlzIGRvZXNuJ3QgbWFrZSBzZW5zZSBvbiBTdHJpbmdJTy4KICAgICAgICBzZWxmLl91bnN1cHBvcnRlZCgiZGV0YWNoIikK',
'/Lib/_random.py':'aW1wb3J0IF9vcwpjbGFzcyBSYW5kb206CiAgICAiIiJSYW5kb20gbnVtYmVyIGdlbmVyYXRvciBiYXNlIGNsYXNzIHVzZWQgYnkgYm91bmQgbW9kdWxlIGZ1bmN0aW9ucy4KCiAgICBVc2VkIHRvIGluc3RhbnRpYXRlIGluc3RhbmNlcyBvZiBSYW5kb20gdG8gZ2V0IGdlbmVyYXRvcnMgdGhhdCBkb24ndAogICAgc2hhcmUgc3RhdGUuCgogICAgQ2xhc3MgUmFuZG9tIGNhbiBhbHNvIGJlIHN1YmNsYXNzZWQgaWYgeW91IHdhbnQgdG8gdXNlIGEgZGlmZmVyZW50IGJhc2ljCiAgICBnZW5lcmF0b3Igb2YgeW91ciBvd24gZGV2aXNpbmc6IGluIHRoYXQgY2FzZSwgb3ZlcnJpZGUgdGhlIGZvbGxvd2luZwogICAgbWV0aG9kczogIHJhbmRvbSgpLCBzZWVkKCksIGdldHN0YXRlKCksIGFuZCBzZXRzdGF0ZSgpLgogICAgT3B0aW9uYWxseSwgaW1wbGVtZW50IGEgZ2V0cmFuZGJpdHMoKSBtZXRob2Qgc28gdGhhdCByYW5kcmFuZ2UoKQogICAgY2FuIGNvdmVyIGFyYml0cmFyaWx5IGxhcmdlIHJhbmdlcy4KCiAgICAiIiIKICAgICNyYW5kb20KICAgICNzZWVkCiAgICAjZ2V0c3RhdGUKICAgICNzZXRzdGF0ZQoKCiAgICBWRVJTSU9OID0gMyAgICAgIyB1c2VkIGJ5IGdldHN0YXRlL3NldHN0YXRlCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHg9Tm9uZSk6CiAgICAgICAgIiIiSW5pdGlhbGl6ZSBhbiBpbnN0YW5jZS4KCiAgICAgICAgT3B0aW9uYWwgYXJndW1lbnQgeCBjb250cm9scyBzZWVkaW5nLCBhcyBmb3IgUmFuZG9tLnNlZWQoKS4KICAgICAgICAiIiIKCiAgICAgICAgc2VsZi5fc3RhdGU9eAoKICAgIGRlZiBzZWVkKHNlbGYsIGE9Tm9uZSwgdmVyc2lvbj0yKToKICAgICAgICAiIiJJbml0aWFsaXplIGludGVybmFsIHN0YXRlIGZyb20gaGFzaGFibGUgb2JqZWN0LgoKICAgICAgICBOb25lIG9yIG5vIGFyZ3VtZW50IHNlZWRzIGZyb20gY3VycmVudCB0aW1lIG9yIGZyb20gYW4gb3BlcmF0aW5nCiAgICAgICAgc3lzdGVtIHNwZWNpZmljIHJhbmRvbW5lc3Mgc291cmNlIGlmIGF2YWlsYWJsZS4KCiAgICAgICAgRm9yIHZlcnNpb24gMiAodGhlIGRlZmF1bHQpLCBhbGwgb2YgdGhlIGJpdHMgYXJlIHVzZWQgaWYgKmEqIGlzIGEgc3RyLAogICAgICAgIGJ5dGVzLCBvciBieXRlYXJyYXkuICBGb3IgdmVyc2lvbiAxLCB0aGUgaGFzaCgpIG9mICphKiBpcyB1c2VkIGluc3RlYWQuCgogICAgICAgIElmICphKiBpcyBhbiBpbnQsIGFsbCBiaXRzIGFyZSB1c2VkLgoKICAgICAgICAiIiIKCiAgICAgICAgc2VsZi5fc3RhdGU9YQogICAgICAgIHNlbGYuZ2F1c3NfbmV4dCA9IE5vbmUKCiAgICBkZWYgZ2V0c3RhdGUoc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIGludGVybmFsIHN0YXRlOyBjYW4gYmUgcGFzc2VkIHRvIHNldHN0YXRlKCkgbGF0ZXIuIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX3N0YXRlCgogICAgZGVmIHNldHN0YXRlKHNlbGYsIHN0YXRlKToKICAgICAgICAiIiJSZXN0b3JlIGludGVybmFsIHN0YXRlIGZyb20gb2JqZWN0IHJldHVybmVkIGJ5IGdldHN0YXRlKCkuIiIiCiAgICAgICAgc2VsZi5fc3RhdGU9c3RhdGUKCiAgICBkZWYgcmFuZG9tKHNlbGYpOgogICAgICAgICIiIkdldCB0aGUgbmV4dCByYW5kb20gbnVtYmVyIGluIHRoZSByYW5nZSBbMC4wLCAxLjApLiIiIgogICAgICAgIHJldHVybiBfb3MucmFuZG9tKCkKCiAgICBkZWYgZ2V0cmFuZGJpdHMoc2VsZiwgayk6CiAgICAgICAgIiIiZ2V0cmFuZGJpdHMoaykgLT4geC4gIEdlbmVyYXRlcyBhIGxvbmcgaW50IHdpdGggayByYW5kb20gYml0cy4iIiIKICAgICAgICBpZiBrIDw9IDA6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoJ251bWJlciBvZiBiaXRzIG11c3QgYmUgZ3JlYXRlciB0aGFuIHplcm8nKQogICAgICAgIGlmIGsgIT0gaW50KGspOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ251bWJlciBvZiBiaXRzIHNob3VsZCBiZSBhbiBpbnRlZ2VyJykKICAgICAgICBudW1ieXRlcyA9IChrICsgNykgLy8gOCAgICAgICAgICAgICAgICAgICAgICAgIyBiaXRzIC8gOCBhbmQgcm91bmRlZCB1cAogICAgICAgIHggPSBpbnQuZnJvbV9ieXRlcyhfdXJhbmRvbShudW1ieXRlcyksICdiaWcnKQogICAgICAgIHJldHVybiB4ID4+IChudW1ieXRlcyAqIDggLSBrKSAgICAgICAgICAgICAgICAjIHRyaW0gZXhjZXNzIGJpdHMK',
'/Lib/_socket.py':'IiIiSW1wbGVtZW50YXRpb24gbW9kdWxlIGZvciBzb2NrZXQgb3BlcmF0aW9ucy4KClNlZSB0aGUgc29ja2V0IG1vZHVsZSBmb3IgZG9jdW1lbnRhdGlvbi4iIiIKCgpBRl9BUFBMRVRBTEsgPSAxNgoKQUZfREVDbmV0ID0gMTIKCkFGX0lORVQgPSAyCgpBRl9JTkVUNiA9IDIzCgpBRl9JUFggPSA2CgpBRl9JUkRBID0gMjYKCkFGX1NOQSA9IDExCgpBRl9VTlNQRUMgPSAwCgpBSV9BRERSQ09ORklHID0gMTAyNAoKQUlfQUxMID0gMjU2CgpBSV9DQU5PTk5BTUUgPSAyCgpBSV9OVU1FUklDSE9TVCA9IDQKCkFJX05VTUVSSUNTRVJWID0gOAoKQUlfUEFTU0lWRSA9IDEKCkFJX1Y0TUFQUEVEID0gMjA0OAoKQ0FQSSA9ICc8Y2Fwc3VsZSBvYmplY3QgIl9zb2NrZXQuQ0FQSSIgYXQgMHgwMEJDNEYzOD4nCgpFQUlfQUdBSU4gPSAxMTAwMgoKRUFJX0JBREZMQUdTID0gMTAwMjIKCkVBSV9GQUlMID0gMTEwMDMKCkVBSV9GQU1JTFkgPSAxMDA0NwoKRUFJX01FTU9SWSA9IDgKCkVBSV9OT0RBVEEgPSAxMTAwMQoKRUFJX05PTkFNRSA9IDExMDAxCgpFQUlfU0VSVklDRSA9IDEwMTA5CgpFQUlfU09DS1RZUEUgPSAxMDA0NAoKSU5BRERSX0FMTEhPU1RTX0dST1VQID0gLTUzNjg3MDkxMQoKSU5BRERSX0FOWSA9IDAKCklOQUREUl9CUk9BRENBU1QgPSAtMQoKSU5BRERSX0xPT1BCQUNLID0gMjEzMDcwNjQzMwoKSU5BRERSX01BWF9MT0NBTF9HUk9VUCA9IC01MzY4NzA2NTcKCklOQUREUl9OT05FID0gLTEKCklOQUREUl9VTlNQRUNfR1JPVVAgPSAtNTM2ODcwOTEyCgpJUFBPUlRfUkVTRVJWRUQgPSAxMDI0CgpJUFBPUlRfVVNFUlJFU0VSVkVEID0gNTAwMAoKSVBQUk9UT19JQ01QID0gMQoKSVBQUk9UT19JUCA9IDAKCklQUFJPVE9fUkFXID0gMjU1CgpJUFBST1RPX1RDUCA9IDYKCklQUFJPVE9fVURQID0gMTcKCklQVjZfQ0hFQ0tTVU0gPSAyNgoKSVBWNl9ET05URlJBRyA9IDE0CgpJUFY2X0hPUExJTUlUID0gMjEKCklQVjZfSE9QT1BUUyA9IDEKCklQVjZfSk9JTl9HUk9VUCA9IDEyCgpJUFY2X0xFQVZFX0dST1VQID0gMTMKCklQVjZfTVVMVElDQVNUX0hPUFMgPSAxMAoKSVBWNl9NVUxUSUNBU1RfSUYgPSA5CgpJUFY2X01VTFRJQ0FTVF9MT09QID0gMTEKCklQVjZfUEtUSU5GTyA9IDE5CgpJUFY2X1JFQ1ZSVEhEUiA9IDM4CgpJUFY2X1JFQ1ZUQ0xBU1MgPSA0MAoKSVBWNl9SVEhEUiA9IDMyCgpJUFY2X1RDTEFTUyA9IDM5CgpJUFY2X1VOSUNBU1RfSE9QUyA9IDQKCklQVjZfVjZPTkxZID0gMjcKCklQX0FERF9NRU1CRVJTSElQID0gMTIKCklQX0RST1BfTUVNQkVSU0hJUCA9IDEzCgpJUF9IRFJJTkNMID0gMgoKSVBfTVVMVElDQVNUX0lGID0gOQoKSVBfTVVMVElDQVNUX0xPT1AgPSAxMQoKSVBfTVVMVElDQVNUX1RUTCA9IDEwCgpJUF9PUFRJT05TID0gMQoKSVBfUkVDVkRTVEFERFIgPSAyNQoKSVBfVE9TID0gMwoKSVBfVFRMID0gNAoKTVNHX0JDQVNUID0gMTAyNAoKTVNHX0NUUlVOQyA9IDUxMgoKTVNHX0RPTlRST1VURSA9IDQKCk1TR19NQ0FTVCA9IDIwNDgKCk1TR19PT0IgPSAxCgpNU0dfUEVFSyA9IDIKCk1TR19UUlVOQyA9IDI1NgoKTklfREdSQU0gPSAxNgoKTklfTUFYSE9TVCA9IDEwMjUKCk5JX01BWFNFUlYgPSAzMgoKTklfTkFNRVJFUUQgPSA0CgpOSV9OT0ZRRE4gPSAxCgpOSV9OVU1FUklDSE9TVCA9IDIKCk5JX05VTUVSSUNTRVJWID0gOAoKUkNWQUxMX01BWCA9IDMKClJDVkFMTF9PRkYgPSAwCgpSQ1ZBTExfT04gPSAxCgpSQ1ZBTExfU09DS0VUTEVWRUxPTkxZID0gMgoKU0hVVF9SRCA9IDAKClNIVVRfUkRXUiA9IDIKClNIVVRfV1IgPSAxCgpTSU9fS0VFUEFMSVZFX1ZBTFMgPSAyNTUwMTM2ODM2CgpTSU9fUkNWQUxMID0gMjU1MDEzNjgzMwoKU09DS19ER1JBTSA9IDIKClNPQ0tfUkFXID0gMwoKU09DS19SRE0gPSA0CgpTT0NLX1NFUVBBQ0tFVCA9IDUKClNPQ0tfU1RSRUFNID0gMQoKU09MX0lQID0gMAoKU09MX1NPQ0tFVCA9IDY1NTM1CgpTT0xfVENQID0gNgoKU09MX1VEUCA9IDE3CgpTT01BWENPTk4gPSAyMTQ3NDgzNjQ3CgpTT19BQ0NFUFRDT05OID0gMgoKU09fQlJPQURDQVNUID0gMzIKClNPX0RFQlVHID0gMQoKU09fRE9OVFJPVVRFID0gMTYKClNPX0VSUk9SID0gNDEwMwoKU09fRVhDTFVTSVZFQUREUlVTRSA9IC01CgpTT19LRUVQQUxJVkUgPSA4CgpTT19MSU5HRVIgPSAxMjgKClNPX09PQklOTElORSA9IDI1NgoKU09fUkNWQlVGID0gNDA5OAoKU09fUkNWTE9XQVQgPSA0MTAwCgpTT19SQ1ZUSU1FTyA9IDQxMDIKClNPX1JFVVNFQUREUiA9IDQKClNPX1NOREJVRiA9IDQwOTcKClNPX1NORExPV0FUID0gNDA5OQoKU09fU05EVElNRU8gPSA0MTAxCgpTT19UWVBFID0gNDEwNAoKU09fVVNFTE9PUEJBQ0sgPSA2NAoKY2xhc3MgU29ja2V0VHlwZToKICAgIHBhc3MKClRDUF9NQVhTRUcgPSA0CgpUQ1BfTk9ERUxBWSA9IDEKCl9fbG9hZGVyX18gPSAnPF9mcm96ZW5faW1wb3J0bGliLkV4dGVuc2lvbkZpbGVMb2FkZXIgb2JqZWN0IGF0IDB4MDBDQTJEOTA+JwoKZGVmIGR1cCgqYXJncywqKmt3KToKICAgICIiImR1cChpbnRlZ2VyKSAtPiBpbnRlZ2VyICAgIAogICAgRHVwbGljYXRlIGFuIGludGVnZXIgc29ja2V0IGZpbGUgZGVzY3JpcHRvci4gIFRoaXMgaXMgbGlrZSBvcy5kdXAoKSwgYnV0IGZvcgogICAgc29ja2V0czsgb24gc29tZSBwbGF0Zm9ybXMgb3MuZHVwKCkgd29uJ3Qgd29yayBmb3Igc29ja2V0IGZpbGUgZGVzY3JpcHRvcnMuIiIiCiAgICBwYXNzCgpjbGFzcyBlcnJvcjoKICAgIHBhc3MKCmNsYXNzIGdhaWVycm9yOgogICAgcGFzcwoKZGVmIGdldGFkZHJpbmZvKCphcmdzLCoqa3cpOgogICAgIiIiZ2V0YWRkcmluZm8oaG9zdCwgcG9ydCBbLCBmYW1pbHksIHNvY2t0eXBlLCBwcm90bywgZmxhZ3NdKSAgICAgICAgLT4gbGlzdCBvZiAoZmFtaWx5LCBzb2NrdHlwZSwgcHJvdG8sIGNhbm9ubmFtZSwgc29ja2FkZHIpCiAgICAKICAgIFJlc29sdmUgaG9zdCBhbmQgcG9ydCBpbnRvIGFkZHJpbmZvIHN0cnVjdC4iIiIKICAgIHBhc3MKCmRlZiBnZXRkZWZhdWx0dGltZW91dCgqYXJncywqKmt3KToKICAgICIiImdldGRlZmF1bHR0aW1lb3V0KCkgLT4gdGltZW91dCAgICAKICAgIFJldHVybnMgdGhlIGRlZmF1bHQgdGltZW91dCBpbiBzZWNvbmRzIChmbG9hdCkgZm9yIG5ldyBzb2NrZXQgb2JqZWN0cy4KICAgIEEgdmFsdWUgb2YgTm9uZSBpbmRpY2F0ZXMgdGhhdCBuZXcgc29ja2V0IG9iamVjdHMgaGF2ZSBubyB0aW1lb3V0LgogICAgV2hlbiB0aGUgc29ja2V0IG1vZHVsZSBpcyBmaXJzdCBpbXBvcnRlZCwgdGhlIGRlZmF1bHQgaXMgTm9uZS4iIiIKICAgIHBhc3MKCmRlZiBnZXRob3N0YnlhZGRyKCphcmdzLCoqa3cpOgogICAgIiIiZ2V0aG9zdGJ5YWRkcihob3N0KSAtPiAobmFtZSwgYWxpYXNsaXN0LCBhZGRyZXNzbGlzdCkgICAgCiAgICBSZXR1cm4gdGhlIHRydWUgaG9zdCBuYW1lLCBhIGxpc3Qgb2YgYWxpYXNlcywgYW5kIGEgbGlzdCBvZiBJUCBhZGRyZXNzZXMsCiAgICBmb3IgYSBob3N0LiAgVGhlIGhvc3QgYXJndW1lbnQgaXMgYSBzdHJpbmcgZ2l2aW5nIGEgaG9zdCBuYW1lIG9yIElQIG51bWJlci4iIiIKICAgIHBhc3MKCmRlZiBnZXRob3N0YnluYW1lKCphcmdzLCoqa3cpOgogICAgIiIiZ2V0aG9zdGJ5bmFtZShob3N0KSAtPiBhZGRyZXNzICAgIAogICAgUmV0dXJuIHRoZSBJUCBhZGRyZXNzIChhIHN0cmluZyBvZiB0aGUgZm9ybSAnMjU1LjI1NS4yNTUuMjU1JykgZm9yIGEgaG9zdC4iIiIKICAgIHBhc3MKCmRlZiBnZXRob3N0YnluYW1lX2V4KCphcmdzLCoqa3cpOgogICAgIiIiZ2V0aG9zdGJ5bmFtZV9leChob3N0KSAtPiAobmFtZSwgYWxpYXNsaXN0LCBhZGRyZXNzbGlzdCkgICAgCiAgICBSZXR1cm4gdGhlIHRydWUgaG9zdCBuYW1lLCBhIGxpc3Qgb2YgYWxpYXNlcywgYW5kIGEgbGlzdCBvZiBJUCBhZGRyZXNzZXMsCiAgICBmb3IgYSBob3N0LiAgVGhlIGhvc3QgYXJndW1lbnQgaXMgYSBzdHJpbmcgZ2l2aW5nIGEgaG9zdCBuYW1lIG9yIElQIG51bWJlci4iIiIKICAgIHBhc3MKCmRlZiBnZXRob3N0bmFtZSgqYXJncywqKmt3KToKICAgICIiImdldGhvc3RuYW1lKCkgLT4gc3RyaW5nICAgIAogICAgUmV0dXJuIHRoZSBjdXJyZW50IGhvc3QgbmFtZS4iIiIKICAgIHBhc3MKCmRlZiBnZXRuYW1laW5mbygqYXJncywqKmt3KToKICAgICIiImdldG5hbWVpbmZvKHNvY2thZGRyLCBmbGFncykgLS0+IChob3N0LCBwb3J0KSAgICAKICAgIEdldCBob3N0IGFuZCBwb3J0IGZvciBhIHNvY2thZGRyLiIiIgogICAgcGFzcwoKZGVmIGdldHByb3RvYnluYW1lKCphcmdzLCoqa3cpOgogICAgIiIiZ2V0cHJvdG9ieW5hbWUobmFtZSkgLT4gaW50ZWdlciAgICAKICAgIFJldHVybiB0aGUgcHJvdG9jb2wgbnVtYmVyIGZvciB0aGUgbmFtZWQgcHJvdG9jb2wuICAoUmFyZWx5IHVzZWQuKSIiIgogICAgcGFzcwoKZGVmIGdldHNlcnZieW5hbWUoKmFyZ3MsKiprdyk6CiAgICAiIiJnZXRzZXJ2YnluYW1lKHNlcnZpY2VuYW1lWywgcHJvdG9jb2xuYW1lXSkgLT4gaW50ZWdlciAgICAKICAgIFJldHVybiBhIHBvcnQgbnVtYmVyIGZyb20gYSBzZXJ2aWNlIG5hbWUgYW5kIHByb3RvY29sIG5hbWUuCiAgICBUaGUgb3B0aW9uYWwgcHJvdG9jb2wgbmFtZSwgaWYgZ2l2ZW4sIHNob3VsZCBiZSAndGNwJyBvciAndWRwJywKICAgIG90aGVyd2lzZSBhbnkgcHJvdG9jb2wgd2lsbCBtYXRjaC4iIiIKICAgIHBhc3MKCmRlZiBnZXRzZXJ2Ynlwb3J0KCphcmdzLCoqa3cpOgogICAgIiIiZ2V0c2VydmJ5cG9ydChwb3J0WywgcHJvdG9jb2xuYW1lXSkgLT4gc3RyaW5nICAgIAogICAgUmV0dXJuIHRoZSBzZXJ2aWNlIG5hbWUgZnJvbSBhIHBvcnQgbnVtYmVyIGFuZCBwcm90b2NvbCBuYW1lLgogICAgVGhlIG9wdGlvbmFsIHByb3RvY29sIG5hbWUsIGlmIGdpdmVuLCBzaG91bGQgYmUgJ3RjcCcgb3IgJ3VkcCcsCiAgICBvdGhlcndpc2UgYW55IHByb3RvY29sIHdpbGwgbWF0Y2guIiIiCiAgICBwYXNzCgpoYXNfaXB2NiA9IFRydWUKCmNsYXNzIGhlcnJvcjoKICAgIHBhc3MKCmRlZiBodG9ubCgqYXJncywqKmt3KToKICAgICIiImh0b25sKGludGVnZXIpIC0+IGludGVnZXIgICAgCiAgICBDb252ZXJ0IGEgMzItYml0IGludGVnZXIgZnJvbSBob3N0IHRvIG5ldHdvcmsgYnl0ZSBvcmRlci4iIiIKICAgIHBhc3MKCmRlZiBodG9ucygqYXJncywqKmt3KToKICAgICIiImh0b25zKGludGVnZXIpIC0+IGludGVnZXIgICAgCiAgICBDb252ZXJ0IGEgMTYtYml0IGludGVnZXIgZnJvbSBob3N0IHRvIG5ldHdvcmsgYnl0ZSBvcmRlci4iIiIKICAgIHBhc3MKCmRlZiBpbmV0X2F0b24oKmFyZ3MsKiprdyk6CiAgICAiIiJpbmV0X2F0b24oc3RyaW5nKSAtPiBieXRlcyBnaXZpbmcgcGFja2VkIDMyLWJpdCBJUCByZXByZXNlbnRhdGlvbiAgICAKICAgIENvbnZlcnQgYW4gSVAgYWRkcmVzcyBpbiBzdHJpbmcgZm9ybWF0ICgxMjMuNDUuNjcuODkpIHRvIHRoZSAzMi1iaXQgcGFja2VkCiAgICBiaW5hcnkgZm9ybWF0IHVzZWQgaW4gbG93LWxldmVsIG5ldHdvcmsgZnVuY3Rpb25zLiIiIgogICAgcGFzcwoKZGVmIGluZXRfbnRvYSgqYXJncywqKmt3KToKICAgICIiImluZXRfbnRvYShwYWNrZWRfaXApIC0+IGlwX2FkZHJlc3Nfc3RyaW5nICAgIAogICAgQ29udmVydCBhbiBJUCBhZGRyZXNzIGZyb20gMzItYml0IHBhY2tlZCBiaW5hcnkgZm9ybWF0IHRvIHN0cmluZyBmb3JtYXQiIiIKICAgIHBhc3MKCmRlZiBudG9obCgqYXJncywqKmt3KToKICAgICIiIm50b2hsKGludGVnZXIpIC0+IGludGVnZXIgICAgCiAgICBDb252ZXJ0IGEgMzItYml0IGludGVnZXIgZnJvbSBuZXR3b3JrIHRvIGhvc3QgYnl0ZSBvcmRlci4iIiIKICAgIHBhc3MKCmRlZiBudG9ocygqYXJncywqKmt3KToKICAgICIiIm50b2hzKGludGVnZXIpIC0+IGludGVnZXIgICAgCiAgICBDb252ZXJ0IGEgMTYtYml0IGludGVnZXIgZnJvbSBuZXR3b3JrIHRvIGhvc3QgYnl0ZSBvcmRlci4iIiIKICAgIHBhc3MKCmRlZiBzZXRkZWZhdWx0dGltZW91dCgqYXJncywqKmt3KToKICAgICIiInNldGRlZmF1bHR0aW1lb3V0KHRpbWVvdXQpICAgIAogICAgU2V0IHRoZSBkZWZhdWx0IHRpbWVvdXQgaW4gc2Vjb25kcyAoZmxvYXQpIGZvciBuZXcgc29ja2V0IG9iamVjdHMuCiAgICBBIHZhbHVlIG9mIE5vbmUgaW5kaWNhdGVzIHRoYXQgbmV3IHNvY2tldCBvYmplY3RzIGhhdmUgbm8gdGltZW91dC4KICAgIFdoZW4gdGhlIHNvY2tldCBtb2R1bGUgaXMgZmlyc3QgaW1wb3J0ZWQsIHRoZSBkZWZhdWx0IGlzIE5vbmUuIiIiCiAgICBwYXNzCgpjbGFzcyBzb2NrZXQ6CiAgICBwYXNzCgpjbGFzcyB0aW1lb3V0OgogICAgcGFzcwo=',
'/Lib/_struct.py':'IwojIFRoaXMgbW9kdWxlIGlzIGEgcHVyZSBQeXRob24gdmVyc2lvbiBvZiBweXB5Lm1vZHVsZS5zdHJ1Y3QuCiMgSXQgaXMgb25seSBpbXBvcnRlZCBpZiB0aGUgdmFzdGx5IGZhc3RlciBweXB5Lm1vZHVsZS5zdHJ1Y3QgaXMgbm90CiMgY29tcGlsZWQgaW4uICBGb3Igbm93IHdlIGtlZXAgdGhpcyB2ZXJzaW9uIGZvciByZWZlcmVuY2UgYW5kCiMgYmVjYXVzZSBweXB5Lm1vZHVsZS5zdHJ1Y3QgaXMgbm90IG9vdHlwZS1iYWNrZW5kLWZyaWVuZGx5IHlldC4KIwoKIyB0aGlzIG1vZHVsZSAnYm9ycm93ZWQnIGZyb20gCiMgaHR0cHM6Ly9iaXRidWNrZXQub3JnL3B5cHkvcHlweS9zcmMvMTg2MjY0NTlhOWIyL2xpYl9weXB5L19zdHJ1Y3QucHk/YXQ9cHkzay1saXN0dmlld19zdHIKCiIiIkZ1bmN0aW9ucyB0byBjb252ZXJ0IGJldHdlZW4gUHl0aG9uIHZhbHVlcyBhbmQgQyBzdHJ1Y3RzLgpQeXRob24gc3RyaW5ncyBhcmUgdXNlZCB0byBob2xkIHRoZSBkYXRhIHJlcHJlc2VudGluZyB0aGUgQyBzdHJ1Y3QKYW5kIGFsc28gYXMgZm9ybWF0IHN0cmluZ3MgdG8gZGVzY3JpYmUgdGhlIGxheW91dCBvZiBkYXRhIGluIHRoZSBDIHN0cnVjdC4KClRoZSBvcHRpb25hbCBmaXJzdCBmb3JtYXQgY2hhciBpbmRpY2F0ZXMgYnl0ZSBvcmRlciwgc2l6ZSBhbmQgYWxpZ25tZW50OgogQDogbmF0aXZlIG9yZGVyLCBzaXplICYgYWxpZ25tZW50IChkZWZhdWx0KQogPTogbmF0aXZlIG9yZGVyLCBzdGQuIHNpemUgJiBhbGlnbm1lbnQKIDw6IGxpdHRsZS1lbmRpYW4sIHN0ZC4gc2l6ZSAmIGFsaWdubWVudAogPjogYmlnLWVuZGlhbiwgc3RkLiBzaXplICYgYWxpZ25tZW50CiAhOiBzYW1lIGFzID4KClRoZSByZW1haW5pbmcgY2hhcnMgaW5kaWNhdGUgdHlwZXMgb2YgYXJncyBhbmQgbXVzdCBtYXRjaCBleGFjdGx5Owp0aGVzZSBjYW4gYmUgcHJlY2VkZWQgYnkgYSBkZWNpbWFsIHJlcGVhdCBjb3VudDoKICAgeDogcGFkIGJ5dGUgKG5vIGRhdGEpOwogICBjOmNoYXI7CiAgIGI6c2lnbmVkIGJ5dGU7CiAgIEI6dW5zaWduZWQgYnl0ZTsKICAgaDpzaG9ydDsKICAgSDp1bnNpZ25lZCBzaG9ydDsKICAgaTppbnQ7CiAgIEk6dW5zaWduZWQgaW50OwogICBsOmxvbmc7CiAgIEw6dW5zaWduZWQgbG9uZzsKICAgZjpmbG9hdDsKICAgZDpkb3VibGUuClNwZWNpYWwgY2FzZXMgKHByZWNlZGluZyBkZWNpbWFsIGNvdW50IGluZGljYXRlcyBsZW5ndGgpOgogICBzOnN0cmluZyAoYXJyYXkgb2YgY2hhcik7IHA6IHBhc2NhbCBzdHJpbmcgKHdpdGggY291bnQgYnl0ZSkuClNwZWNpYWwgY2FzZSAob25seSBhdmFpbGFibGUgaW4gbmF0aXZlIGZvcm1hdCk6CiAgIFA6YW4gaW50ZWdlciB0eXBlIHRoYXQgaXMgd2lkZSBlbm91Z2ggdG8gaG9sZCBhIHBvaW50ZXIuClNwZWNpYWwgY2FzZSAobm90IGluIG5hdGl2ZSBtb2RlIHVubGVzcyAnbG9uZyBsb25nJyBpbiBwbGF0Zm9ybSBDKToKICAgcTpsb25nIGxvbmc7CiAgIFE6dW5zaWduZWQgbG9uZyBsb25nCldoaXRlc3BhY2UgYmV0d2VlbiBmb3JtYXRzIGlzIGlnbm9yZWQuCgpUaGUgdmFyaWFibGUgc3RydWN0LmVycm9yIGlzIGFuIGV4Y2VwdGlvbiByYWlzZWQgb24gZXJyb3JzLiIiIgoKaW1wb3J0IG1hdGgsIHN5cwoKIyBUT0RPOiBYWFggRmluZCBhIHdheSB0byBnZXQgaW5mb3JtYXRpb24gb24gbmF0aXZlIHNpemVzIGFuZCBhbGlnbm1lbnRzCmNsYXNzIFN0cnVjdEVycm9yKEV4Y2VwdGlvbik6CiAgICBwYXNzCmVycm9yID0gU3RydWN0RXJyb3IKZGVmIHVucGFja19pbnQoZGF0YSxpbmRleCxzaXplLGxlKToKICAgIGJ5dGVzID0gW2IgZm9yIGIgaW4gZGF0YVtpbmRleDppbmRleCtzaXplXV0KICAgIGlmIGxlID09ICdsaXR0bGUnOgogICAgICAgIGJ5dGVzLnJldmVyc2UoKQogICAgbnVtYmVyID0gMAogICAgZm9yIGIgaW4gYnl0ZXM6CiAgICAgICAgbnVtYmVyID0gbnVtYmVyIDw8IDggfCBiCiAgICByZXR1cm4gaW50KG51bWJlcikKCmRlZiB1bnBhY2tfc2lnbmVkX2ludChkYXRhLGluZGV4LHNpemUsbGUpOgogICAgbnVtYmVyID0gdW5wYWNrX2ludChkYXRhLGluZGV4LHNpemUsbGUpCiAgICBtYXggPSAyKiooc2l6ZSo4KQogICAgaWYgbnVtYmVyID4gMioqKHNpemUqOCAtIDEpIC0gMToKICAgICAgICBudW1iZXIgPSBpbnQoLTEqKG1heCAtIG51bWJlcikpCiAgICByZXR1cm4gbnVtYmVyCgpJTkZJTklUWSA9IDFlMjAwICogMWUyMDAKTkFOID0gSU5GSU5JVFkgLyBJTkZJTklUWQoKZGVmIHVucGFja19jaGFyKGRhdGEsaW5kZXgsc2l6ZSxsZSk6CiAgICByZXR1cm4gZGF0YVtpbmRleDppbmRleCtzaXplXQoKZGVmIHBhY2tfaW50KG51bWJlcixzaXplLGxlKToKICAgIHg9bnVtYmVyCiAgICByZXM9W10KICAgIGZvciBpIGluIHJhbmdlKHNpemUpOgogICAgICAgIHJlcy5hcHBlbmQoeCYweGZmKQogICAgICAgIHggPj49IDgKICAgIGlmIGxlID09ICdiaWcnOgogICAgICAgIHJlcy5yZXZlcnNlKCkKICAgIHJldHVybiBieXRlcyhyZXMpCgpkZWYgcGFja19zaWduZWRfaW50KG51bWJlcixzaXplLGxlKToKICAgIGlmIG5vdCBpc2luc3RhbmNlKG51bWJlciwgaW50KToKICAgICAgICByYWlzZSBTdHJ1Y3RFcnJvcigiYXJndW1lbnQgZm9yIGksSSxsLEwscSxRLGgsSCBtdXN0IGJlIGludGVnZXIiKQogICAgaWYgIG51bWJlciA+IDIqKig4KnNpemUtMSktMSBvciBudW1iZXIgPCAtMSoyKiooOCpzaXplLTEpOgogICAgICAgIHJhaXNlIE92ZXJmbG93RXJyb3IoIk51bWJlcjolaSB0b28gbGFyZ2UgdG8gY29udmVydCIgJSBudW1iZXIpCiAgICByZXR1cm4gcGFja19pbnQobnVtYmVyLHNpemUsbGUpCgpkZWYgcGFja191bnNpZ25lZF9pbnQobnVtYmVyLHNpemUsbGUpOgogICAgaWYgbm90IGlzaW5zdGFuY2UobnVtYmVyLCBpbnQpOgogICAgICAgIHJhaXNlIFN0cnVjdEVycm9yKCJhcmd1bWVudCBmb3IgaSxJLGwsTCxxLFEsaCxIIG11c3QgYmUgaW50ZWdlciIpCiAgICBpZiBudW1iZXIgPCAwOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiY2FuJ3QgY29udmVydCBuZWdhdGl2ZSBsb25nIHRvIHVuc2lnbmVkIikKICAgIGlmIG51bWJlciA+IDIqKig4KnNpemUpLTE6CiAgICAgICAgcmFpc2UgT3ZlcmZsb3dFcnJvcigiTnVtYmVyOiVpIHRvbyBsYXJnZSB0byBjb252ZXJ0IiAlIG51bWJlcikKICAgIHJldHVybiBwYWNrX2ludChudW1iZXIsc2l6ZSxsZSkKCmRlZiBwYWNrX2NoYXIoY2hhcixzaXplLGxlKToKICAgIHJldHVybiBieXRlcyhjaGFyKQoKZGVmIGlzaW5mKHgpOgogICAgcmV0dXJuIHggIT0gMC4wIGFuZCB4IC8gMiA9PSB4CmRlZiBpc25hbih2KToKICAgIHJldHVybiB2ICE9IHYqMS4wIG9yICh2ID09IDEuMCBhbmQgdiA9PSAyLjApCgpkZWYgcGFja19mbG9hdCh4LCBzaXplLCBsZSk6CiAgICB1bnNpZ25lZCA9IGZsb2F0X3BhY2soeCwgc2l6ZSkKICAgIHJlc3VsdCA9IFtdCiAgICBmb3IgaSBpbiByYW5nZSg4KToKICAgICAgICByZXN1bHQuYXBwZW5kKCh1bnNpZ25lZCA+PiAoaSAqIDgpKSAmIDB4RkYpCiAgICBpZiBsZSA9PSAiYmlnIjoKICAgICAgICByZXN1bHQucmV2ZXJzZSgpCiAgICByZXR1cm4gYnl0ZXMocmVzdWx0KQoKZGVmIHVucGFja19mbG9hdChkYXRhLCBpbmRleCwgc2l6ZSwgbGUpOgogICAgYmluYXJ5ID0gW2RhdGFbaV0gZm9yIGkgaW4gcmFuZ2UoaW5kZXgsIGluZGV4ICsgOCldCiAgICBpZiBsZSA9PSAiYmlnIjoKICAgICAgICBiaW5hcnkucmV2ZXJzZSgpCiAgICB1bnNpZ25lZCA9IDAKICAgIGZvciBpIGluIHJhbmdlKDgpOgogICAgICAgIHVuc2lnbmVkIHw9IGJpbmFyeVtpXSA8PCAoaSAqIDgpCiAgICByZXR1cm4gZmxvYXRfdW5wYWNrKHVuc2lnbmVkLCBzaXplLCBsZSkKCmRlZiByb3VuZF90b19uZWFyZXN0KHgpOgogICAgIiIiUHl0aG9uIDMgc3R5bGUgcm91bmQ6ICByb3VuZCBhIGZsb2F0IHggdG8gdGhlIG5lYXJlc3QgaW50LCBidXQKICAgIHVubGlrZSB0aGUgYnVpbHRpbiBQeXRob24gMi54IHJvdW5kIGZ1bmN0aW9uOgoKICAgICAgLSByZXR1cm4gYW4gaW50LCBub3QgYSBmbG9hdAogICAgICAtIGRvIHJvdW5kLWhhbGYtdG8tZXZlbiwgbm90IHJvdW5kLWhhbGYtYXdheS1mcm9tLXplcm8uCgogICAgV2UgYXNzdW1lIHRoYXQgeCBpcyBmaW5pdGUgYW5kIG5vbm5lZ2F0aXZlOyBleGNlcHQgd3JvbmcgcmVzdWx0cwogICAgaWYgeW91IHVzZSB0aGlzIGZvciBuZWdhdGl2ZSB4LgoKICAgICIiIgogICAgaW50X3BhcnQgPSBpbnQoeCkKICAgIGZyYWNfcGFydCA9IHggLSBpbnRfcGFydAogICAgaWYgZnJhY19wYXJ0ID4gMC41IG9yIGZyYWNfcGFydCA9PSAwLjUgYW5kIGludF9wYXJ0ICYgMSA9PSAxOgogICAgICAgIGludF9wYXJ0ICs9IDEKICAgIHJldHVybiBpbnRfcGFydAoKZGVmIGZsb2F0X3VucGFjayhRLCBzaXplLCBsZSk6CiAgICAiIiJDb252ZXJ0IGEgMzItYml0IG9yIDY0LWJpdCBpbnRlZ2VyIGNyZWF0ZWQKICAgIGJ5IGZsb2F0X3BhY2sgaW50byBhIFB5dGhvbiBmbG9hdC4iIiIKCiAgICBpZiBzaXplID09IDg6CiAgICAgICAgTUlOX0VYUCA9IC0xMDIxICAjID0gc3lzLmZsb2F0X2luZm8ubWluX2V4cAogICAgICAgIE1BWF9FWFAgPSAxMDI0ICAgIyA9IHN5cy5mbG9hdF9pbmZvLm1heF9leHAKICAgICAgICBNQU5UX0RJRyA9IDUzICAgICMgPSBzeXMuZmxvYXRfaW5mby5tYW50X2RpZwogICAgICAgIEJJVFMgPSA2NAogICAgZWxpZiBzaXplID09IDQ6CiAgICAgICAgTUlOX0VYUCA9IC0xMjUgICAjIEMncyBGTFRfTUlOX0VYUAogICAgICAgIE1BWF9FWFAgPSAxMjggICAgIyBGTFRfTUFYX0VYUAogICAgICAgIE1BTlRfRElHID0gMjQgICAgIyBGTFRfTUFOVF9ESUcKICAgICAgICBCSVRTID0gMzIKICAgIGVsc2U6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiaW52YWxpZCBzaXplIHZhbHVlIikKCiAgICBpZiBRID4+IEJJVFM6CiAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoImlucHV0IG91dCBvZiByYW5nZSIpCgogICAgIyBleHRyYWN0IHBpZWNlcwogICAgc2lnbiA9IFEgPj4gQklUUyAtIDEKICAgIGV4cCA9IChRICYgKCgxIDw8IEJJVFMgLSAxKSAtICgxIDw8IE1BTlRfRElHIC0gMSkpKSA+PiBNQU5UX0RJRyAtIDEKICAgIG1hbnQgPSBRICYgKCgxIDw8IE1BTlRfRElHIC0gMSkgLSAxKQoKICAgIGlmIGV4cCA9PSBNQVhfRVhQIC0gTUlOX0VYUCArIDI6CiAgICAgICAgIyBuYW4gb3IgaW5maW5pdHkKICAgICAgICByZXN1bHQgPSBmbG9hdCgnbmFuJykgaWYgbWFudCBlbHNlIGZsb2F0KCdpbmYnKQogICAgZWxpZiBleHAgPT0gMDoKICAgICAgICAjIHN1Ym5vcm1hbCBvciB6ZXJvCiAgICAgICAgcmVzdWx0ID0gbWF0aC5sZGV4cChmbG9hdChtYW50KSwgTUlOX0VYUCAtIE1BTlRfRElHKQogICAgZWxzZToKICAgICAgICAjIG5vcm1hbAogICAgICAgIG1hbnQgKz0gMSA8PCBNQU5UX0RJRyAtIDEKICAgICAgICByZXN1bHQgPSBtYXRoLmxkZXhwKGZsb2F0KG1hbnQpLCBleHAgKyBNSU5fRVhQIC0gTUFOVF9ESUcgLSAxKQogICAgcmV0dXJuIC1yZXN1bHQgaWYgc2lnbiBlbHNlIHJlc3VsdAoKCmRlZiBmbG9hdF9wYWNrKHgsIHNpemUpOgogICAgIiIiQ29udmVydCBhIFB5dGhvbiBmbG9hdCB4IGludG8gYSA2NC1iaXQgdW5zaWduZWQgaW50ZWdlcgogICAgd2l0aCB0aGUgc2FtZSBieXRlIHJlcHJlc2VudGF0aW9uLiIiIgoKICAgIGlmIHNpemUgPT0gODoKICAgICAgICBNSU5fRVhQID0gLTEwMjEgICMgPSBzeXMuZmxvYXRfaW5mby5taW5fZXhwCiAgICAgICAgTUFYX0VYUCA9IDEwMjQgICAjID0gc3lzLmZsb2F0X2luZm8ubWF4X2V4cAogICAgICAgIE1BTlRfRElHID0gNTMgICAgIyA9IHN5cy5mbG9hdF9pbmZvLm1hbnRfZGlnCiAgICAgICAgQklUUyA9IDY0CiAgICBlbGlmIHNpemUgPT0gNDoKICAgICAgICBNSU5fRVhQID0gLTEyNSAgICMgQydzIEZMVF9NSU5fRVhQCiAgICAgICAgTUFYX0VYUCA9IDEyOCAgICAjIEZMVF9NQVhfRVhQCiAgICAgICAgTUFOVF9ESUcgPSAyNCAgICAjIEZMVF9NQU5UX0RJRwogICAgICAgIEJJVFMgPSAzMgogICAgZWxzZToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJpbnZhbGlkIHNpemUgdmFsdWUiKQoKICAgIHNpZ24gPSBtYXRoLmNvcHlzaWduKDEuMCwgeCkgPCAwLjAKICAgIGlmIG1hdGguaXNpbmYoeCk6CiAgICAgICAgbWFudCA9IDAKICAgICAgICBleHAgPSBNQVhfRVhQIC0gTUlOX0VYUCArIDIKICAgIGVsaWYgbWF0aC5pc25hbih4KToKICAgICAgICBtYW50ID0gMSA8PCAoTUFOVF9ESUctMikgIyBvdGhlciB2YWx1ZXMgcG9zc2libGUKICAgICAgICBleHAgPSBNQVhfRVhQIC0gTUlOX0VYUCArIDIKICAgIGVsaWYgeCA9PSAwLjA6CiAgICAgICAgbWFudCA9IDAKICAgICAgICBleHAgPSAwCiAgICBlbHNlOgogICAgICAgIG0sIGUgPSBtYXRoLmZyZXhwKGFicyh4KSkgICMgYWJzKHgpID09IG0gKiAyKiplCiAgICAgICAgZXhwID0gZSAtIChNSU5fRVhQIC0gMSkKICAgICAgICBpZiBleHAgPiAwOgogICAgICAgICAgICAjIE5vcm1hbCBjYXNlLgogICAgICAgICAgICBtYW50ID0gcm91bmRfdG9fbmVhcmVzdChtICogKDEgPDwgTUFOVF9ESUcpKQogICAgICAgICAgICBtYW50IC09IDEgPDwgTUFOVF9ESUcgLSAxCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyBTdWJub3JtYWwgY2FzZS4KICAgICAgICAgICAgaWYgZXhwICsgTUFOVF9ESUcgLSAxID49IDA6CiAgICAgICAgICAgICAgICBtYW50ID0gcm91bmRfdG9fbmVhcmVzdChtICogKDEgPDwgZXhwICsgTUFOVF9ESUcgLSAxKSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG1hbnQgPSAwCiAgICAgICAgICAgIGV4cCA9IDAKCiAgICAgICAgIyBTcGVjaWFsIGNhc2U6IHJvdW5kaW5nIHByb2R1Y2VkIGEgTUFOVF9ESUctYml0IG1hbnRpc3NhLgogICAgICAgIGFzc2VydCAwIDw9IG1hbnQgPD0gMSA8PCBNQU5UX0RJRyAtIDEKICAgICAgICBpZiBtYW50ID09IDEgPDwgTUFOVF9ESUcgLSAxOgogICAgICAgICAgICBtYW50ID0gMAogICAgICAgICAgICBleHAgKz0gMQoKICAgICAgICAjIFJhaXNlIG9uIG92ZXJmbG93IChpbiBzb21lIGNpcmN1bXN0YW5jZXMsIG1heSB3YW50IHRvIHJldHVybgogICAgICAgICMgaW5maW5pdHkgaW5zdGVhZCkuCiAgICAgICAgaWYgZXhwID49IE1BWF9FWFAgLSBNSU5fRVhQICsgMjoKICAgICAgICAgICAgIHJhaXNlIE92ZXJmbG93RXJyb3IoImZsb2F0IHRvbyBsYXJnZSB0byBwYWNrIGluIHRoaXMgZm9ybWF0IikKCiAgICAjIGNoZWNrIGNvbnN0cmFpbnRzCiAgICBhc3NlcnQgMCA8PSBtYW50IDwgMSA8PCBNQU5UX0RJRyAtIDEKICAgIGFzc2VydCAwIDw9IGV4cCA8PSBNQVhfRVhQIC0gTUlOX0VYUCArIDIKICAgIGFzc2VydCAwIDw9IHNpZ24gPD0gMQogICAgcmV0dXJuICgoc2lnbiA8PCBCSVRTIC0gMSkgfCAoZXhwIDw8IE1BTlRfRElHIC0gMSkpIHwgbWFudAoKCmJpZ19lbmRpYW5fZm9ybWF0ID0gewogICAgJ3gnOnsgJ3NpemUnIDogMSwgJ2FsaWdubWVudCcgOiAwLCAncGFjaycgOiBOb25lLCAndW5wYWNrJyA6IE5vbmV9LAogICAgJ2InOnsgJ3NpemUnIDogMSwgJ2FsaWdubWVudCcgOiAwLCAncGFjaycgOiBwYWNrX3NpZ25lZF9pbnQsICd1bnBhY2snIDogdW5wYWNrX3NpZ25lZF9pbnR9LAogICAgJ0InOnsgJ3NpemUnIDogMSwgJ2FsaWdubWVudCcgOiAwLCAncGFjaycgOiBwYWNrX3Vuc2lnbmVkX2ludCwgJ3VucGFjaycgOiB1bnBhY2tfaW50fSwKICAgICdjJzp7ICdzaXplJyA6IDEsICdhbGlnbm1lbnQnIDogMCwgJ3BhY2snIDogcGFja19jaGFyLCAndW5wYWNrJyA6IHVucGFja19jaGFyfSwKICAgICdzJzp7ICdzaXplJyA6IDEsICdhbGlnbm1lbnQnIDogMCwgJ3BhY2snIDogTm9uZSwgJ3VucGFjaycgOiBOb25lfSwKICAgICdwJzp7ICdzaXplJyA6IDEsICdhbGlnbm1lbnQnIDogMCwgJ3BhY2snIDogTm9uZSwgJ3VucGFjaycgOiBOb25lfSwKICAgICdoJzp7ICdzaXplJyA6IDIsICdhbGlnbm1lbnQnIDogMCwgJ3BhY2snIDogcGFja19zaWduZWRfaW50LCAndW5wYWNrJyA6IHVucGFja19zaWduZWRfaW50fSwKICAgICdIJzp7ICdzaXplJyA6IDIsICdhbGlnbm1lbnQnIDogMCwgJ3BhY2snIDogcGFja191bnNpZ25lZF9pbnQsICd1bnBhY2snIDogdW5wYWNrX2ludH0sCiAgICAnaSc6eyAnc2l6ZScgOiA0LCAnYWxpZ25tZW50JyA6IDAsICdwYWNrJyA6IHBhY2tfc2lnbmVkX2ludCwgJ3VucGFjaycgOiB1bnBhY2tfc2lnbmVkX2ludH0sCiAgICAnSSc6eyAnc2l6ZScgOiA0LCAnYWxpZ25tZW50JyA6IDAsICdwYWNrJyA6IHBhY2tfdW5zaWduZWRfaW50LCAndW5wYWNrJyA6IHVucGFja19pbnR9LAogICAgJ2wnOnsgJ3NpemUnIDogNCwgJ2FsaWdubWVudCcgOiAwLCAncGFjaycgOiBwYWNrX3NpZ25lZF9pbnQsICd1bnBhY2snIDogdW5wYWNrX3NpZ25lZF9pbnR9LAogICAgJ0wnOnsgJ3NpemUnIDogNCwgJ2FsaWdubWVudCcgOiAwLCAncGFjaycgOiBwYWNrX3Vuc2lnbmVkX2ludCwgJ3VucGFjaycgOiB1bnBhY2tfaW50fSwKICAgICdxJzp7ICdzaXplJyA6IDgsICdhbGlnbm1lbnQnIDogMCwgJ3BhY2snIDogcGFja19zaWduZWRfaW50LCAndW5wYWNrJyA6IHVucGFja19zaWduZWRfaW50fSwKICAgICdRJzp7ICdzaXplJyA6IDgsICdhbGlnbm1lbnQnIDogMCwgJ3BhY2snIDogcGFja191bnNpZ25lZF9pbnQsICd1bnBhY2snIDogdW5wYWNrX2ludH0sCiAgICAnZic6eyAnc2l6ZScgOiA0LCAnYWxpZ25tZW50JyA6IDAsICdwYWNrJyA6IHBhY2tfZmxvYXQsICd1bnBhY2snIDogdW5wYWNrX2Zsb2F0fSwKICAgICdkJzp7ICdzaXplJyA6IDgsICdhbGlnbm1lbnQnIDogMCwgJ3BhY2snIDogcGFja19mbG9hdCwgJ3VucGFjaycgOiB1bnBhY2tfZmxvYXR9LAogICAgfQpkZWZhdWx0ID0gYmlnX2VuZGlhbl9mb3JtYXQKZm9ybWF0bW9kZT17ICc8JyA6IChkZWZhdWx0LCAnbGl0dGxlJyksCiAgICAgICAgICAgICAnPicgOiAoZGVmYXVsdCwgJ2JpZycpLAogICAgICAgICAgICAgJyEnIDogKGRlZmF1bHQsICdiaWcnKSwKICAgICAgICAgICAgICc9JyA6IChkZWZhdWx0LCBzeXMuYnl0ZW9yZGVyKSwKICAgICAgICAgICAgICdAJyA6IChkZWZhdWx0LCBzeXMuYnl0ZW9yZGVyKQogICAgICAgICAgICB9CgpkZWYgZ2V0bW9kZShmbXQpOgogICAgdHJ5OgogICAgICAgIGZvcm1hdGRlZixlbmRpYW5uZXNzID0gZm9ybWF0bW9kZVtmbXRbMF1dCiAgICAgICAgaW5kZXggPSAxCiAgICBleGNlcHQgKEluZGV4RXJyb3IsIEtleUVycm9yKToKICAgICAgICBmb3JtYXRkZWYsZW5kaWFubmVzcyA9IGZvcm1hdG1vZGVbJ0AnXQogICAgICAgIGluZGV4ID0gMAogICAgcmV0dXJuIGZvcm1hdGRlZixlbmRpYW5uZXNzLGluZGV4CmRlZiBnZXROdW0oZm10LGkpOgogICAgbnVtPU5vbmUKICAgIGN1ciA9IGZtdFtpXQogICAgd2hpbGUgKCcwJzw9IGN1ciApIGFuZCAoIGN1ciA8PSAnOScpOgogICAgICAgIGlmIG51bSA9PSBOb25lOgogICAgICAgICAgICBudW0gPSBpbnQoY3VyKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG51bSA9IDEwKm51bSArIGludChjdXIpCiAgICAgICAgaSArPSAxCiAgICAgICAgY3VyID0gZm10W2ldCiAgICByZXR1cm4gbnVtLGkKCmRlZiBjYWxjc2l6ZShmbXQpOgogICAgIiIiY2FsY3NpemUoZm10KSAtPiBpbnQKICAgIFJldHVybiBzaXplIG9mIEMgc3RydWN0IGRlc2NyaWJlZCBieSBmb3JtYXQgc3RyaW5nIGZtdC4KICAgIFNlZSBzdHJ1Y3QuX19kb2NfXyBmb3IgbW9yZSBvbiBmb3JtYXQgc3RyaW5ncy4iIiIKCiAgICBmb3JtYXRkZWYsZW5kaWFubmVzcyxpID0gZ2V0bW9kZShmbXQpCiAgICBudW0gPSAwCiAgICByZXN1bHQgPSAwCiAgICB3aGlsZSBpPGxlbihmbXQpOgogICAgICAgIG51bSxpID0gZ2V0TnVtKGZtdCxpKQogICAgICAgIGN1ciA9IGZtdFtpXQogICAgICAgIHRyeToKICAgICAgICAgICAgZm9ybWF0ID0gZm9ybWF0ZGVmW2N1cl0KICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIHJhaXNlIFN0cnVjdEVycm9yKCIlcyBpcyBub3QgYSB2YWxpZCBmb3JtYXQiICUgY3VyKQogICAgICAgIGlmIG51bSAhPSBOb25lIDoKICAgICAgICAgICAgcmVzdWx0ICs9IG51bSpmb3JtYXRbJ3NpemUnXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJlc3VsdCArPSBmb3JtYXRbJ3NpemUnXQogICAgICAgIG51bSA9IDAKICAgICAgICBpICs9IDEKICAgIHJldHVybiByZXN1bHQKCmRlZiBwYWNrKGZtdCwqYXJncyk6CiAgICAiIiJwYWNrKGZtdCwgdjEsIHYyLCAuLi4pIC0+IHN0cmluZwogICAgICAgUmV0dXJuIHN0cmluZyBjb250YWluaW5nIHZhbHVlcyB2MSwgdjIsIC4uLiBwYWNrZWQgYWNjb3JkaW5nIHRvIGZtdC4KICAgICAgIFNlZSBzdHJ1Y3QuX19kb2NfXyBmb3IgbW9yZSBvbiBmb3JtYXQgc3RyaW5ncy4iIiIKICAgIGZvcm1hdGRlZixlbmRpYW5uZXNzLGkgPSBnZXRtb2RlKGZtdCkKICAgIGFyZ3MgPSBsaXN0KGFyZ3MpCiAgICBuX2FyZ3MgPSBsZW4oYXJncykKICAgIHJlc3VsdCA9IFtdCiAgICB3aGlsZSBpPGxlbihmbXQpOgogICAgICAgIG51bSxpID0gZ2V0TnVtKGZtdCxpKQogICAgICAgIGN1ciA9IGZtdFtpXQogICAgICAgIHRyeToKICAgICAgICAgICAgZm9ybWF0ID0gZm9ybWF0ZGVmW2N1cl0KICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIHJhaXNlIFN0cnVjdEVycm9yKCIlcyBpcyBub3QgYSB2YWxpZCBmb3JtYXQiICUgY3VyKQogICAgICAgIGlmIG51bSA9PSBOb25lIDoKICAgICAgICAgICAgbnVtX3MgPSAwCiAgICAgICAgICAgIG51bSA9IDEKICAgICAgICBlbHNlOgogICAgICAgICAgICBudW1fcyA9IG51bQoKICAgICAgICBpZiBjdXIgPT0gJ3gnOgogICAgICAgICAgICByZXN1bHQgKz0gW2InXDAnKm51bV0KICAgICAgICBlbGlmIGN1ciA9PSAncyc6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoYXJnc1swXSwgYnl0ZXMpOgogICAgICAgICAgICAgICAgcGFkZGluZyA9IG51bSAtIGxlbihhcmdzWzBdKQogICAgICAgICAgICAgICAgcmVzdWx0ICs9IFthcmdzWzBdWzpudW1dICsgYidcMCcqcGFkZGluZ10KICAgICAgICAgICAgICAgIGFyZ3MucG9wKDApCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZSBTdHJ1Y3RFcnJvcigiYXJnIGZvciBzdHJpbmcgZm9ybWF0IG5vdCBhIHN0cmluZyIpCiAgICAgICAgZWxpZiBjdXIgPT0gJ3AnOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGFyZ3NbMF0sIGJ5dGVzKToKICAgICAgICAgICAgICAgIHBhZGRpbmcgPSBudW0gLSBsZW4oYXJnc1swXSkgLSAxCgogICAgICAgICAgICAgICAgaWYgcGFkZGluZyA+IDA6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IFtieXRlcyhbbGVuKGFyZ3NbMF0pXSkgKyBhcmdzWzBdWzpudW0tMV0gKyBiJ1wwJypwYWRkaW5nXQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBpZiBudW08MjU1OgogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gW2J5dGVzKFtudW0tMV0pICsgYXJnc1swXVs6bnVtLTFdXQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBbYnl0ZXMoWzI1NV0pICsgYXJnc1swXVs6bnVtLTFdXQogICAgICAgICAgICAgICAgYXJncy5wb3AoMCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlIFN0cnVjdEVycm9yKCJhcmcgZm9yIHN0cmluZyBmb3JtYXQgbm90IGEgc3RyaW5nIikKCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgbGVuKGFyZ3MpIDwgbnVtOgogICAgICAgICAgICAgICAgcmFpc2UgU3RydWN0RXJyb3IoImluc3VmZmljaWVudCBhcmd1bWVudHMgdG8gcGFjayIpCiAgICAgICAgICAgIGZvciB2YXIgaW4gYXJnc1s6bnVtXToKICAgICAgICAgICAgICAgIHJlc3VsdCArPSBbZm9ybWF0WydwYWNrJ10odmFyLGZvcm1hdFsnc2l6ZSddLGVuZGlhbm5lc3MpXQogICAgICAgICAgICBhcmdzPWFyZ3NbbnVtOl0KICAgICAgICBudW0gPSBOb25lCiAgICAgICAgaSArPSAxCiAgICBpZiBsZW4oYXJncykgIT0gMDoKICAgICAgICByYWlzZSBTdHJ1Y3RFcnJvcigidG9vIG1hbnkgYXJndW1lbnRzIGZvciBwYWNrIGZvcm1hdCIpCiAgICByZXR1cm4gYicnLmpvaW4ocmVzdWx0KQoKZGVmIHVucGFjayhmbXQsZGF0YSk6CiAgICAiIiJ1bnBhY2soZm10LCBzdHJpbmcpIC0+ICh2MSwgdjIsIC4uLikKICAgICAgIFVucGFjayB0aGUgc3RyaW5nLCBjb250YWluaW5nIHBhY2tlZCBDIHN0cnVjdHVyZSBkYXRhLCBhY2NvcmRpbmcKICAgICAgIHRvIGZtdC4gIFJlcXVpcmVzIGxlbihzdHJpbmcpPT1jYWxjc2l6ZShmbXQpLgogICAgICAgU2VlIHN0cnVjdC5fX2RvY19fIGZvciBtb3JlIG9uIGZvcm1hdCBzdHJpbmdzLiIiIgogICAgZm9ybWF0ZGVmLGVuZGlhbm5lc3MsaSA9IGdldG1vZGUoZm10KQogICAgaiA9IDAKICAgIG51bSA9IDAKICAgIHJlc3VsdCA9IFtdCiAgICBsZW5ndGg9IGNhbGNzaXplKGZtdCkKICAgIGlmIGxlbmd0aCAhPSBsZW4gKGRhdGEpOgogICAgICAgIHJhaXNlIFN0cnVjdEVycm9yKCJ1bnBhY2sgc3RyIHNpemUgZG9lcyBub3QgbWF0Y2ggZm9ybWF0IikKICAgIHdoaWxlIGk8bGVuKGZtdCk6CiAgICAgICAgbnVtLGk9Z2V0TnVtKGZtdCxpKQogICAgICAgIGN1ciA9IGZtdFtpXQogICAgICAgIGkgKz0gMQogICAgICAgIHRyeToKICAgICAgICAgICAgZm9ybWF0ID0gZm9ybWF0ZGVmW2N1cl0KICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIHJhaXNlIFN0cnVjdEVycm9yKCIlcyBpcyBub3QgYSB2YWxpZCBmb3JtYXQiICUgY3VyKQoKICAgICAgICBpZiBub3QgbnVtIDoKICAgICAgICAgICAgbnVtID0gMQoKICAgICAgICBpZiBjdXIgPT0gJ3gnOgogICAgICAgICAgICBqICs9IG51bQogICAgICAgIGVsaWYgY3VyID09ICdzJzoKICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChkYXRhW2o6aitudW1dKQogICAgICAgICAgICBqICs9IG51bQogICAgICAgIGVsaWYgY3VyID09ICdwJzoKICAgICAgICAgICAgbj1kYXRhW2pdCiAgICAgICAgICAgIGlmIG4gPj0gbnVtOgogICAgICAgICAgICAgICAgbiA9IG51bS0xCiAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoZGF0YVtqKzE6aituKzFdKQogICAgICAgICAgICBqICs9IG51bQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGZvciBuIGluIHJhbmdlKG51bSk6CiAgICAgICAgICAgICAgICByZXN1bHQgKz0gW2Zvcm1hdFsndW5wYWNrJ10oZGF0YSxqLGZvcm1hdFsnc2l6ZSddLGVuZGlhbm5lc3MpXQogICAgICAgICAgICAgICAgaiArPSBmb3JtYXRbJ3NpemUnXQoKICAgIHJldHVybiB0dXBsZShyZXN1bHQpCgpkZWYgcGFja19pbnRvKGZtdCwgYnVmLCBvZmZzZXQsICphcmdzKToKICAgIGRhdGEgPSBwYWNrKGZtdCwgKmFyZ3MpCiAgICBidWZmZXIoYnVmKVtvZmZzZXQ6b2Zmc2V0K2xlbihkYXRhKV0gPSBkYXRhCgpkZWYgdW5wYWNrX2Zyb20oZm10LCBidWYsIG9mZnNldD0wKToKICAgIHNpemUgPSBjYWxjc2l6ZShmbXQpCiAgICBkYXRhID0gYnVmZmVyKGJ1Zilbb2Zmc2V0Om9mZnNldCtzaXplXQogICAgaWYgbGVuKGRhdGEpICE9IHNpemU6CiAgICAgICAgcmFpc2UgZXJyb3IoInVucGFja19mcm9tIHJlcXVpcmVzIGEgYnVmZmVyIG9mIGF0IGxlYXN0ICVkIGJ5dGVzIgogICAgICAgICAgICAgICAgICAgICUgKHNpemUsKSkKICAgIHJldHVybiB1bnBhY2soZm10LCBkYXRhKQoKZGVmIF9jbGVhcmNhY2hlKCk6CiAgICAiQ2xlYXIgdGhlIGludGVybmFsIGNhY2hlLiIKICAgICMgTm8gY2FjaGUgaW4gdGhpcyBpbXBsZW1lbnRhdGlvbgo=',
'/Lib/_thread.py':'IiIiRHJvcC1pbiByZXBsYWNlbWVudCBmb3IgdGhlIHRocmVhZCBtb2R1bGUuCgpNZWFudCB0byBiZSB1c2VkIGFzIGEgYnJhaW4tZGVhZCBzdWJzdGl0dXRlIHNvIHRoYXQgdGhyZWFkZWQgY29kZSBkb2VzCm5vdCBuZWVkIHRvIGJlIHJld3JpdHRlbiBmb3Igd2hlbiB0aGUgdGhyZWFkIG1vZHVsZSBpcyBub3QgcHJlc2VudC4KClN1Z2dlc3RlZCB1c2FnZSBpczo6CgogICAgdHJ5OgogICAgICAgIGltcG9ydCBfdGhyZWFkCiAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgaW1wb3J0IF9kdW1teV90aHJlYWQgYXMgX3RocmVhZAoKIiIiCiMgRXhwb3J0cyBvbmx5IHRoaW5ncyBzcGVjaWZpZWQgYnkgdGhyZWFkIGRvY3VtZW50YXRpb247CiMgc2tpcHBpbmcgb2Jzb2xldGUgc3lub255bXMgYWxsb2NhdGUoKSwgc3RhcnRfbmV3KCksIGV4aXRfdGhyZWFkKCkuCl9fYWxsX18gPSBbJ2Vycm9yJywgJ3N0YXJ0X25ld190aHJlYWQnLCAnZXhpdCcsICdnZXRfaWRlbnQnLCAnYWxsb2NhdGVfbG9jaycsCiAgICAgICAgICAgJ2ludGVycnVwdF9tYWluJywgJ0xvY2tUeXBlJ10KCiMgQSBkdW1teSB2YWx1ZQpUSU1FT1VUX01BWCA9IDIqKjMxCgojIE5PVEU6IHRoaXMgbW9kdWxlIGNhbiBiZSBpbXBvcnRlZCBlYXJseSBpbiB0aGUgZXh0ZW5zaW9uIGJ1aWxkaW5nIHByb2Nlc3MsCiMgYW5kIHNvIHRvcCBsZXZlbCBpbXBvcnRzIG9mIG90aGVyIG1vZHVsZXMgc2hvdWxkIGJlIGF2b2lkZWQuICBJbnN0ZWFkLCBhbGwKIyBpbXBvcnRzIGFyZSBkb25lIHdoZW4gbmVlZGVkIG9uIGEgZnVuY3Rpb24tYnktZnVuY3Rpb24gYmFzaXMuICBTaW5jZSB0aHJlYWRzCiMgYXJlIGRpc2FibGVkLCB0aGUgaW1wb3J0IGxvY2sgc2hvdWxkIG5vdCBiZSBhbiBpc3N1ZSBhbnl3YXkgKD8/KS4KCmVycm9yID0gUnVudGltZUVycm9yCgpkZWYgc3RhcnRfbmV3X3RocmVhZChmdW5jdGlvbiwgYXJncywga3dhcmdzPXt9KToKICAgICIiIkR1bW15IGltcGxlbWVudGF0aW9uIG9mIF90aHJlYWQuc3RhcnRfbmV3X3RocmVhZCgpLgoKICAgIENvbXBhdGliaWxpdHkgaXMgbWFpbnRhaW5lZCBieSBtYWtpbmcgc3VyZSB0aGF0IGBgYXJnc2BgIGlzIGEKICAgIHR1cGxlIGFuZCBgYGt3YXJnc2BgIGlzIGEgZGljdGlvbmFyeS4gIElmIGFuIGV4Y2VwdGlvbiBpcyByYWlzZWQKICAgIGFuZCBpdCBpcyBTeXN0ZW1FeGl0ICh3aGljaCBjYW4gYmUgZG9uZSBieSBfdGhyZWFkLmV4aXQoKSkgaXQgaXMKICAgIGNhdWdodCBhbmQgbm90aGluZyBpcyBkb25lOyBhbGwgb3RoZXIgZXhjZXB0aW9ucyBhcmUgcHJpbnRlZCBvdXQKICAgIGJ5IHVzaW5nIHRyYWNlYmFjay5wcmludF9leGMoKS4KCiAgICBJZiB0aGUgZXhlY3V0ZWQgZnVuY3Rpb24gY2FsbHMgaW50ZXJydXB0X21haW4gdGhlIEtleWJvYXJkSW50ZXJydXB0IHdpbGwgYmUKICAgIHJhaXNlZCB3aGVuIHRoZSBmdW5jdGlvbiByZXR1cm5zLgoKICAgICIiIgogICAgaWYgdHlwZShhcmdzKSAhPSB0eXBlKHR1cGxlKCkpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiMm5kIGFyZyBtdXN0IGJlIGEgdHVwbGUiKQogICAgaWYgdHlwZShrd2FyZ3MpICE9IHR5cGUoZGljdCgpKToKICAgICAgICByYWlzZSBUeXBlRXJyb3IoIjNyZCBhcmcgbXVzdCBiZSBhIGRpY3QiKQogICAgZ2xvYmFsIF9tYWluCiAgICBfbWFpbiA9IEZhbHNlCiAgICB0cnk6CiAgICAgICAgZnVuY3Rpb24oKmFyZ3MsICoqa3dhcmdzKQogICAgZXhjZXB0IFN5c3RlbUV4aXQ6CiAgICAgICAgcGFzcwogICAgZXhjZXB0OgogICAgICAgIGltcG9ydCB0cmFjZWJhY2sKICAgICAgICB0cmFjZWJhY2sucHJpbnRfZXhjKCkKICAgIF9tYWluID0gVHJ1ZQogICAgZ2xvYmFsIF9pbnRlcnJ1cHQKICAgIGlmIF9pbnRlcnJ1cHQ6CiAgICAgICAgX2ludGVycnVwdCA9IEZhbHNlCiAgICAgICAgcmFpc2UgS2V5Ym9hcmRJbnRlcnJ1cHQKCmRlZiBleGl0KCk6CiAgICAiIiJEdW1teSBpbXBsZW1lbnRhdGlvbiBvZiBfdGhyZWFkLmV4aXQoKS4iIiIKICAgIHJhaXNlIFN5c3RlbUV4aXQKCmRlZiBnZXRfaWRlbnQoKToKICAgICIiIkR1bW15IGltcGxlbWVudGF0aW9uIG9mIF90aHJlYWQuZ2V0X2lkZW50KCkuCgogICAgU2luY2UgdGhpcyBtb2R1bGUgc2hvdWxkIG9ubHkgYmUgdXNlZCB3aGVuIF90aHJlYWRtb2R1bGUgaXMgbm90CiAgICBhdmFpbGFibGUsIGl0IGlzIHNhZmUgdG8gYXNzdW1lIHRoYXQgdGhlIGN1cnJlbnQgcHJvY2VzcyBpcyB0aGUKICAgIG9ubHkgdGhyZWFkLiAgVGh1cyBhIGNvbnN0YW50IGNhbiBiZSBzYWZlbHkgcmV0dXJuZWQuCiAgICAiIiIKICAgIHJldHVybiAtMQoKZGVmIGFsbG9jYXRlX2xvY2soKToKICAgICIiIkR1bW15IGltcGxlbWVudGF0aW9uIG9mIF90aHJlYWQuYWxsb2NhdGVfbG9jaygpLiIiIgogICAgcmV0dXJuIExvY2tUeXBlKCkKCmRlZiBzdGFja19zaXplKHNpemU9Tm9uZSk6CiAgICAiIiJEdW1teSBpbXBsZW1lbnRhdGlvbiBvZiBfdGhyZWFkLnN0YWNrX3NpemUoKS4iIiIKICAgIGlmIHNpemUgaXMgbm90IE5vbmU6CiAgICAgICAgcmFpc2UgZXJyb3IoInNldHRpbmcgdGhyZWFkIHN0YWNrIHNpemUgbm90IHN1cHBvcnRlZCIpCiAgICByZXR1cm4gMAoKY2xhc3MgTG9ja1R5cGUob2JqZWN0KToKICAgICIiIkNsYXNzIGltcGxlbWVudGluZyBkdW1teSBpbXBsZW1lbnRhdGlvbiBvZiBfdGhyZWFkLkxvY2tUeXBlLgoKICAgIENvbXBhdGliaWxpdHkgaXMgbWFpbnRhaW5lZCBieSBtYWludGFpbmluZyBzZWxmLmxvY2tlZF9zdGF0dXMKICAgIHdoaWNoIGlzIGEgYm9vbGVhbiB0aGF0IHN0b3JlcyB0aGUgc3RhdGUgb2YgdGhlIGxvY2suICBQaWNrbGluZyBvZgogICAgdGhlIGxvY2ssIHRob3VnaCwgc2hvdWxkIG5vdCBiZSBkb25lIHNpbmNlIGlmIHRoZSBfdGhyZWFkIG1vZHVsZSBpcwogICAgdGhlbiB1c2VkIHdpdGggYW4gdW5waWNrbGVkIGBgbG9jaygpYGAgZnJvbSBoZXJlIHByb2JsZW1zIGNvdWxkCiAgICBvY2N1ciBmcm9tIHRoaXMgY2xhc3Mgbm90IGhhdmluZyBhdG9taWMgbWV0aG9kcy4KCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi5sb2NrZWRfc3RhdHVzID0gRmFsc2UKCiAgICBkZWYgYWNxdWlyZShzZWxmLCB3YWl0ZmxhZz1Ob25lLCB0aW1lb3V0PS0xKToKICAgICAgICAiIiJEdW1teSBpbXBsZW1lbnRhdGlvbiBvZiBhY3F1aXJlKCkuCgogICAgICAgIEZvciBibG9ja2luZyBjYWxscywgc2VsZi5sb2NrZWRfc3RhdHVzIGlzIGF1dG9tYXRpY2FsbHkgc2V0IHRvCiAgICAgICAgVHJ1ZSBhbmQgcmV0dXJuZWQgYXBwcm9wcmlhdGVseSBiYXNlZCBvbiB2YWx1ZSBvZgogICAgICAgIGBgd2FpdGZsYWdgYC4gIElmIGl0IGlzIG5vbi1ibG9ja2luZywgdGhlbiB0aGUgdmFsdWUgaXMKICAgICAgICBhY3R1YWxseSBjaGVja2VkIGFuZCBub3Qgc2V0IGlmIGl0IGlzIGFscmVhZHkgYWNxdWlyZWQuICBUaGlzCiAgICAgICAgaXMgYWxsIGRvbmUgc28gdGhhdCB0aHJlYWRpbmcuQ29uZGl0aW9uJ3MgYXNzZXJ0IHN0YXRlbWVudHMKICAgICAgICBhcmVuJ3QgdHJpZ2dlcmVkIGFuZCB0aHJvdyBhIGxpdHRsZSBmaXQuCgogICAgICAgICIiIgogICAgICAgIGlmIHdhaXRmbGFnIGlzIE5vbmUgb3Igd2FpdGZsYWc6CiAgICAgICAgICAgIHNlbGYubG9ja2VkX3N0YXR1cyA9IFRydWUKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBub3Qgc2VsZi5sb2NrZWRfc3RhdHVzOgogICAgICAgICAgICAgICAgc2VsZi5sb2NrZWRfc3RhdHVzID0gVHJ1ZQogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIHRpbWVvdXQgPiAwOgogICAgICAgICAgICAgICAgICAgIGltcG9ydCB0aW1lCiAgICAgICAgICAgICAgICAgICAgdGltZS5zbGVlcCh0aW1lb3V0KQogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgX19lbnRlcl9fID0gYWNxdWlyZQoKICAgIGRlZiBfX2V4aXRfXyhzZWxmLCB0eXAsIHZhbCwgdGIpOgogICAgICAgIHNlbGYucmVsZWFzZSgpCgogICAgZGVmIHJlbGVhc2Uoc2VsZik6CiAgICAgICAgIiIiUmVsZWFzZSB0aGUgZHVtbXkgbG9jay4iIiIKICAgICAgICAjIFhYWCBQZXJoYXBzIHNob3VsZG4ndCBhY3R1YWxseSBib3RoZXIgdG8gdGVzdD8gIENvdWxkIGxlYWQKICAgICAgICAjICAgICB0byBwcm9ibGVtcyBmb3IgY29tcGxleCwgdGhyZWFkZWQgY29kZS4KICAgICAgICBpZiBub3Qgc2VsZi5sb2NrZWRfc3RhdHVzOgogICAgICAgICAgICByYWlzZSBlcnJvcgogICAgICAgIHNlbGYubG9ja2VkX3N0YXR1cyA9IEZhbHNlCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgbG9ja2VkKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmxvY2tlZF9zdGF0dXMKCiMgVXNlZCB0byBzaWduYWwgdGhhdCBpbnRlcnJ1cHRfbWFpbiB3YXMgY2FsbGVkIGluIGEgInRocmVhZCIKX2ludGVycnVwdCA9IEZhbHNlCiMgVHJ1ZSB3aGVuIG5vdCBleGVjdXRpbmcgaW4gYSAidGhyZWFkIgpfbWFpbiA9IFRydWUKCmRlZiBpbnRlcnJ1cHRfbWFpbigpOgogICAgIiIiU2V0IF9pbnRlcnJ1cHQgZmxhZyB0byBUcnVlIHRvIGhhdmUgc3RhcnRfbmV3X3RocmVhZCByYWlzZQogICAgS2V5Ym9hcmRJbnRlcnJ1cHQgdXBvbiBleGl0aW5nLiIiIgogICAgaWYgX21haW46CiAgICAgICAgcmFpc2UgS2V5Ym9hcmRJbnRlcnJ1cHQKICAgIGVsc2U6CiAgICAgICAgZ2xvYmFsIF9pbnRlcnJ1cHQKICAgICAgICBfaW50ZXJydXB0ID0gVHJ1ZQo=',
'/Lib/_weakref.py':'Y2xhc3MgUHJveHlUeXBlOgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLG9iaik6CiAgICAgICAgc2VsZi5vYmogPSBvYmoKCkNhbGxhYmxlUHJveHlUeXBlID0gUHJveHlUeXBlClByb3h5VHlwZXMgPSBbUHJveHlUeXBlLENhbGxhYmxlUHJveHlUeXBlXQoKY2xhc3MgUmVmZXJlbmNlVHlwZToKCiAgICBkZWYgX19pbml0X18oc2VsZixvYmosY2FsbGJhY2spOgogICAgICAgIHNlbGYub2JqID0gb2JqCiAgICAgICAgc2VsZi5jYWxsYmFjayA9IGNhbGxiYWNrCgpjbGFzcyByZWY6CgogICAgZGVmIF9faW5pdF9fKHNlbGYsb2JqLGNhbGxiYWNrPU5vbmUpOgogICAgICAgIHNlbGYub2JqID0gUmVmZXJlbmNlVHlwZShvYmosY2FsbGJhY2spCiAgICAgICAgc2VsZi5jYWxsYmFjaz1jYWxsYmFjawoKZGVmIGdldHdlYWtyZWZjb3VudChvYmopOgogICAgcmV0dXJuIDEKCmRlZiBnZXR3ZWFrcmVmcyhvYmopOgogICAgcmV0dXJuIG9iagoKCmRlZiBwcm94eShvYmosY2FsbGJhY2spOgogICAgcmV0dXJuIFByb3h5VHlwZShvYmopCgo=',
'/Lib/_weakrefset.py':'IyBBY2Nlc3MgV2Vha1NldCB0aHJvdWdoIHRoZSB3ZWFrcmVmIG1vZHVsZS4KIyBUaGlzIGNvZGUgaXMgc2VwYXJhdGVkLW91dCBiZWNhdXNlIGl0IGlzIG5lZWRlZAojIGJ5IGFiYy5weSB0byBsb2FkIGV2ZXJ5dGhpbmcgZWxzZSBhdCBzdGFydHVwLgoKZnJvbSBfd2Vha3JlZiBpbXBvcnQgcmVmCgpfX2FsbF9fID0gWydXZWFrU2V0J10KCgpjbGFzcyBfSXRlcmF0aW9uR3VhcmQ6CiAgICAjIFRoaXMgY29udGV4dCBtYW5hZ2VyIHJlZ2lzdGVycyBpdHNlbGYgaW4gdGhlIGN1cnJlbnQgaXRlcmF0b3JzIG9mIHRoZQogICAgIyB3ZWFrIGNvbnRhaW5lciwgc3VjaCBhcyB0byBkZWxheSBhbGwgcmVtb3ZhbHMgdW50aWwgdGhlIGNvbnRleHQgbWFuYWdlcgogICAgIyBleGl0cy4KICAgICMgVGhpcyB0ZWNobmlxdWUgc2hvdWxkIGJlIHJlbGF0aXZlbHkgdGhyZWFkLXNhZmUgKHNpbmNlIHNldHMgYXJlKS4KCiAgICBkZWYgX19pbml0X18oc2VsZiwgd2Vha2NvbnRhaW5lcik6CiAgICAgICAgIyBEb24ndCBjcmVhdGUgY3ljbGVzCiAgICAgICAgcHJpbnQoJ2NyZWF0ZSBpdGVyYXRpb24gZ3VhcmQnLCB3ZWFrY29udGFpbmVyKQogICAgICAgIHNlbGYud2Vha2NvbnRhaW5lciA9IHJlZih3ZWFrY29udGFpbmVyKQoKICAgIGRlZiBfX2VudGVyX18oc2VsZik6CiAgICAgICAgcHJpbnQoJ2VudGVyIGl0ZXJhdGlvbiBndWFyZCcpCiAgICAgICAgdyA9IHNlbGYud2Vha2NvbnRhaW5lcigpCiAgICAgICAgaWYgdyBpcyBub3QgTm9uZToKICAgICAgICAgICAgdy5faXRlcmF0aW5nLmFkZChzZWxmKQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fZXhpdF9fKHNlbGYsIGUsIHQsIGIpOgogICAgICAgIHcgPSBzZWxmLndlYWtjb250YWluZXIoKQogICAgICAgIGlmIHcgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHMgPSB3Ll9pdGVyYXRpbmcKICAgICAgICAgICAgcy5yZW1vdmUoc2VsZikKICAgICAgICAgICAgaWYgbm90IHM6CiAgICAgICAgICAgICAgICB3Ll9jb21taXRfcmVtb3ZhbHMoKQoKCmNsYXNzIFdlYWtTZXQ6CiAgICBkZWYgX19pbml0X18oc2VsZiwgZGF0YT1Ob25lKToKICAgICAgICBzZWxmLmRhdGEgPSBzZXQoKQogICAgICAgIGRlZiBfcmVtb3ZlKGl0ZW0sIHNlbGZyZWY9cmVmKHNlbGYpKToKICAgICAgICAgICAgc2VsZiA9IHNlbGZyZWYoKQogICAgICAgICAgICBpZiBzZWxmIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgaWYgc2VsZi5faXRlcmF0aW5nOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX3BlbmRpbmdfcmVtb3ZhbHMuYXBwZW5kKGl0ZW0pCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuZGF0YS5kaXNjYXJkKGl0ZW0pCiAgICAgICAgc2VsZi5fcmVtb3ZlID0gX3JlbW92ZQogICAgICAgICMgQSBsaXN0IG9mIGtleXMgdG8gYmUgcmVtb3ZlZAogICAgICAgIHNlbGYuX3BlbmRpbmdfcmVtb3ZhbHMgPSBbXQogICAgICAgIHNlbGYuX2l0ZXJhdGluZyA9IHNldCgpCiAgICAgICAgaWYgZGF0YSBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi51cGRhdGUoZGF0YSkKCiAgICBkZWYgX2NvbW1pdF9yZW1vdmFscyhzZWxmKToKICAgICAgICBsID0gc2VsZi5fcGVuZGluZ19yZW1vdmFscwogICAgICAgIGRpc2NhcmQgPSBzZWxmLmRhdGEuZGlzY2FyZAogICAgICAgIHdoaWxlIGw6CiAgICAgICAgICAgIGRpc2NhcmQobC5wb3AoKSkKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgd2l0aCBfSXRlcmF0aW9uR3VhcmQoc2VsZik6CiAgICAgICAgICAgIGZvciBpdGVtcmVmIGluIHNlbGYuZGF0YToKICAgICAgICAgICAgICAgIGl0ZW0gPSBpdGVtcmVmKCkKICAgICAgICAgICAgICAgIGlmIGl0ZW0gaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgeWllbGQgaXRlbQoKICAgIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICAgIHJldHVybiBsZW4oc2VsZi5kYXRhKSAtIGxlbihzZWxmLl9wZW5kaW5nX3JlbW92YWxzKQoKICAgIGRlZiBfX2NvbnRhaW5zX18oc2VsZiwgaXRlbSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB3ciA9IHJlZihpdGVtKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIHJldHVybiB3ciBpbiBzZWxmLmRhdGEKCiAgICBkZWYgX19yZWR1Y2VfXyhzZWxmKToKICAgICAgICByZXR1cm4gKHNlbGYuX19jbGFzc19fLCAobGlzdChzZWxmKSwpLAogICAgICAgICAgICAgICAgZ2V0YXR0cihzZWxmLCAnX19kaWN0X18nLCBOb25lKSkKCiAgICBkZWYgYWRkKHNlbGYsIGl0ZW0pOgogICAgICAgIGlmIHNlbGYuX3BlbmRpbmdfcmVtb3ZhbHM6CiAgICAgICAgICAgIHNlbGYuX2NvbW1pdF9yZW1vdmFscygpCiAgICAgICAgc2VsZi5kYXRhLmFkZChyZWYoaXRlbSwgc2VsZi5fcmVtb3ZlKSkKCiAgICBkZWYgY2xlYXIoc2VsZik6CiAgICAgICAgaWYgc2VsZi5fcGVuZGluZ19yZW1vdmFsczoKICAgICAgICAgICAgc2VsZi5fY29tbWl0X3JlbW92YWxzKCkKICAgICAgICBzZWxmLmRhdGEuY2xlYXIoKQoKICAgIGRlZiBjb3B5KHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmKQoKICAgIGRlZiBwb3Aoc2VsZik6CiAgICAgICAgaWYgc2VsZi5fcGVuZGluZ19yZW1vdmFsczoKICAgICAgICAgICAgc2VsZi5fY29tbWl0X3JlbW92YWxzKCkKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpdGVtcmVmID0gc2VsZi5kYXRhLnBvcCgpCiAgICAgICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgICAgIHJhaXNlIEtleUVycm9yKCdwb3AgZnJvbSBlbXB0eSBXZWFrU2V0JykKICAgICAgICAgICAgaXRlbSA9IGl0ZW1yZWYoKQogICAgICAgICAgICBpZiBpdGVtIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0KCiAgICBkZWYgcmVtb3ZlKHNlbGYsIGl0ZW0pOgogICAgICAgIGlmIHNlbGYuX3BlbmRpbmdfcmVtb3ZhbHM6CiAgICAgICAgICAgIHNlbGYuX2NvbW1pdF9yZW1vdmFscygpCiAgICAgICAgc2VsZi5kYXRhLnJlbW92ZShyZWYoaXRlbSkpCgogICAgZGVmIGRpc2NhcmQoc2VsZiwgaXRlbSk6CiAgICAgICAgaWYgc2VsZi5fcGVuZGluZ19yZW1vdmFsczoKICAgICAgICAgICAgc2VsZi5fY29tbWl0X3JlbW92YWxzKCkKICAgICAgICBzZWxmLmRhdGEuZGlzY2FyZChyZWYoaXRlbSkpCgogICAgZGVmIHVwZGF0ZShzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgc2VsZi5fcGVuZGluZ19yZW1vdmFsczoKICAgICAgICAgICAgc2VsZi5fY29tbWl0X3JlbW92YWxzKCkKICAgICAgICBmb3IgZWxlbWVudCBpbiBvdGhlcjoKICAgICAgICAgICAgc2VsZi5hZGQoZWxlbWVudCkKCiAgICBkZWYgX19pb3JfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgc2VsZi51cGRhdGUob3RoZXIpCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgZGlmZmVyZW5jZShzZWxmLCBvdGhlcik6CiAgICAgICAgbmV3c2V0ID0gc2VsZi5jb3B5KCkKICAgICAgICBuZXdzZXQuZGlmZmVyZW5jZV91cGRhdGUob3RoZXIpCiAgICAgICAgcmV0dXJuIG5ld3NldAogICAgX19zdWJfXyA9IGRpZmZlcmVuY2UKCiAgICBkZWYgZGlmZmVyZW5jZV91cGRhdGUoc2VsZiwgb3RoZXIpOgogICAgICAgIHNlbGYuX19pc3ViX18ob3RoZXIpCiAgICBkZWYgX19pc3ViX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIHNlbGYuX3BlbmRpbmdfcmVtb3ZhbHM6CiAgICAgICAgICAgIHNlbGYuX2NvbW1pdF9yZW1vdmFscygpCiAgICAgICAgaWYgc2VsZiBpcyBvdGhlcjoKICAgICAgICAgICAgc2VsZi5kYXRhLmNsZWFyKCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmRhdGEuZGlmZmVyZW5jZV91cGRhdGUocmVmKGl0ZW0pIGZvciBpdGVtIGluIG90aGVyKQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIGludGVyc2VjdGlvbihzZWxmLCBvdGhlcik6CiAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKGl0ZW0gZm9yIGl0ZW0gaW4gb3RoZXIgaWYgaXRlbSBpbiBzZWxmKQogICAgX19hbmRfXyA9IGludGVyc2VjdGlvbgoKICAgIGRlZiBpbnRlcnNlY3Rpb25fdXBkYXRlKHNlbGYsIG90aGVyKToKICAgICAgICBzZWxmLl9faWFuZF9fKG90aGVyKQogICAgZGVmIF9faWFuZF9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBzZWxmLl9wZW5kaW5nX3JlbW92YWxzOgogICAgICAgICAgICBzZWxmLl9jb21taXRfcmVtb3ZhbHMoKQogICAgICAgIHNlbGYuZGF0YS5pbnRlcnNlY3Rpb25fdXBkYXRlKHJlZihpdGVtKSBmb3IgaXRlbSBpbiBvdGhlcikKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiBpc3N1YnNldChzZWxmLCBvdGhlcik6CiAgICAgICAgcmV0dXJuIHNlbGYuZGF0YS5pc3N1YnNldChyZWYoaXRlbSkgZm9yIGl0ZW0gaW4gb3RoZXIpCiAgICBfX2xlX18gPSBpc3N1YnNldAoKICAgIGRlZiBfX2x0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIHJldHVybiBzZWxmLmRhdGEgPCBzZXQocmVmKGl0ZW0pIGZvciBpdGVtIGluIG90aGVyKQoKICAgIGRlZiBpc3N1cGVyc2V0KHNlbGYsIG90aGVyKToKICAgICAgICByZXR1cm4gc2VsZi5kYXRhLmlzc3VwZXJzZXQocmVmKGl0ZW0pIGZvciBpdGVtIGluIG90aGVyKQogICAgX19nZV9fID0gaXNzdXBlcnNldAoKICAgIGRlZiBfX2d0X18oc2VsZiwgb3RoZXIpOgogICAgICAgIHJldHVybiBzZWxmLmRhdGEgPiBzZXQocmVmKGl0ZW0pIGZvciBpdGVtIGluIG90aGVyKQoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBzZWxmLl9fY2xhc3NfXyk6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAogICAgICAgIHJldHVybiBzZWxmLmRhdGEgPT0gc2V0KHJlZihpdGVtKSBmb3IgaXRlbSBpbiBvdGhlcikKCiAgICBkZWYgc3ltbWV0cmljX2RpZmZlcmVuY2Uoc2VsZiwgb3RoZXIpOgogICAgICAgIG5ld3NldCA9IHNlbGYuY29weSgpCiAgICAgICAgbmV3c2V0LnN5bW1ldHJpY19kaWZmZXJlbmNlX3VwZGF0ZShvdGhlcikKICAgICAgICByZXR1cm4gbmV3c2V0CiAgICBfX3hvcl9fID0gc3ltbWV0cmljX2RpZmZlcmVuY2UKCiAgICBkZWYgc3ltbWV0cmljX2RpZmZlcmVuY2VfdXBkYXRlKHNlbGYsIG90aGVyKToKICAgICAgICBzZWxmLl9faXhvcl9fKG90aGVyKQogICAgZGVmIF9faXhvcl9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBzZWxmLl9wZW5kaW5nX3JlbW92YWxzOgogICAgICAgICAgICBzZWxmLl9jb21taXRfcmVtb3ZhbHMoKQogICAgICAgIGlmIHNlbGYgaXMgb3RoZXI6CiAgICAgICAgICAgIHNlbGYuZGF0YS5jbGVhcigpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5kYXRhLnN5bW1ldHJpY19kaWZmZXJlbmNlX3VwZGF0ZShyZWYoaXRlbSwgc2VsZi5fcmVtb3ZlKSBmb3IgaXRlbSBpbiBvdGhlcikKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiB1bmlvbihzZWxmLCBvdGhlcik6CiAgICAgICAgcmV0dXJuIHNlbGYuX19jbGFzc19fKGUgZm9yIHMgaW4gKHNlbGYsIG90aGVyKSBmb3IgZSBpbiBzKQogICAgX19vcl9fID0gdW5pb24KCiAgICBkZWYgaXNkaXNqb2ludChzZWxmLCBvdGhlcik6CiAgICAgICAgcmV0dXJuIGxlbihzZWxmLmludGVyc2VjdGlvbihvdGhlcikpID09IDAK',
'/Lib/browser/ajax.py':'ZnJvbSBfYWpheCBpbXBvcnQgKg==',
'/Lib/browser/html.py':'ZnJvbSBfaHRtbCBpbXBvcnQgKg==',
'/Lib/browser/indexed_db.py':'Y2xhc3MgRXZlbnRMaXN0ZW5lcjoKICBkZWYgX19pbml0X18oc2VsZiwgZXZlbnRzPVtdKToKICAgICAgc2VsZi5fZXZlbnRzPWV2ZW50cwoKICBkZWYgYXBwZW5kKHNlbGYsIGV2ZW50KToKICAgICAgc2VsZi5fZXZlbnRzLmFwcGVuZChldmVudCkKCiAgZGVmIGZpcmUoc2VsZiwgZSk6CiAgICAgIGZvciBfZXZlbnQgaW4gc2VsZi5fZXZlbnRzOgogICAgICAgICAgX2V2ZW50KGUpCgpjbGFzcyBJbmRleGVkREI6CiAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICBpZiBub3QgX19CUllUSE9OX18uaGFzX2luZGV4ZWREQjoKICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCJOb3RJbXBsZW1lbnRlZEVycm9yIiwgIllvdXIgYnJvd3NlciBkb2Vzbid0IHN1cHBvcnQgaW5kZXhlZERCIikKICAgICAgICAgcmV0dXJuCgogICAgICBzZWxmLl9pbmRleGVkREI9X19CUllUSE9OX18uaW5kZXhlZERCKCkKICAgICAgc2VsZi5fZGI9Tm9uZQogICAgICBzZWxmLl92ZXJzaW9uPU5vbmUKCiAgZGVmIF9vbnN1Y2Nlc3Moc2VsZiwgZXZlbnQpOgogICAgICBzZWxmLl9kYj1ldmVudC50YXJnZXQucmVzdWx0CgogIGRlZiBvcGVuKHNlbGYsIG5hbWUsIG9uc3VjY2VzcywgdmVyc2lvbj0xLjAsIG9uZXJyb3I9Tm9uZSwgCiAgICAgICAgICAgb251cGdyYWRlbmVlZGVkPU5vbmUpOgogICAgICBzZWxmLl92ZXJzaW9uPXZlcnNpb24KICAgICAgX3Jlc3VsdD1zZWxmLl9pbmRleGVkREIub3BlbihuYW1lLCB2ZXJzaW9uKQogICAgICBfc3VjY2Vzcz1FdmVudExpc3RlbmVyKFtzZWxmLl9vbnN1Y2Nlc3MsIG9uc3VjY2Vzc10pCiAgICAgIF9yZXN1bHQub25zdWNjZXNzPV9zdWNjZXNzLmZpcmUKICAgICAgX3Jlc3VsdC5vbnVwZ3JhZGVuZWVkZWQ9b251cGdyYWRlbmVlZGVkCgogICAgICAjaWYgb25lcnJvciBpcyBOb25lOgogICAgICBkZWYgb25lcnJvcihlKToKICAgICAgICAgIHByaW50KCJvbmVycm9yOiAlczolcyIgJSAgKGUudHlwZSwgZS50YXJnZXQucmVzdWx0KSkKCiAgICAgIGRlZiBvbmJsb2NrZWQoZSk6CiAgICAgICAgICBwcmludCgiYmxvY2tlZDogJXM6JXMiICUgIChlLnR5cGUsIGUucmVzdWx0KSkKCiAgICAgIF9yZXN1bHQub25lcnJvcj1vbmVycm9yCiAgICAgIF9yZXN1bHQub25ibG9ja2VkPW9uYmxvY2tlZAoKICBkZWYgdHJhbnNhY3Rpb24oc2VsZiwgZW50aXRpZXMsIG1vZGU9J3JlYWQnKToKICAgICAgcmV0dXJuIFRyYW5zYWN0aW9uKHNlbGYuX2RiLnRyYW5zYWN0aW9uKGVudGl0aWVzLCBtb2RlKSkKCmNsYXNzIFRyYW5zYWN0aW9uOgogIGRlZiBfX2luaXRfXyhzZWxmLCB0cmFuc2FjdGlvbik6CiAgICAgIHNlbGYuX3RyYW5zYWN0aW9uPXRyYW5zYWN0aW9uCgogIGRlZiBvYmplY3RTdG9yZShzZWxmLCBuYW1lKToKICAgICAgcmV0dXJuIE9iamVjdFN0b3JlKHNlbGYuX3RyYW5zYWN0aW9uLm9iamVjdFN0b3JlKG5hbWUpKQoKY2xhc3MgT2JqZWN0U3RvcmU6CiAgZGVmIF9faW5pdF9fKHNlbGYsIG9iamVjdFN0b3JlKToKICAgICAgc2VsZi5fb2JqZWN0U3RvcmU9b2JqZWN0U3RvcmUKICAgICAgc2VsZi5fZGF0YT1bXQoKICBkZWYgY2xlYXIoc2VsZiwgb25zdWNjZXNzPU5vbmUsIG9uZXJyb3I9Tm9uZSk6CiAgICAgIF9yZXN1bHQ9c2VsZi5fb2JqZWN0U3RvcmUuY2xlYXIoKQoKICAgICAgaWYgb25zdWNjZXNzIGlzIG5vdCBOb25lOgogICAgICAgICBfcmVzdWx0Lm9uc3VjY2Vzcz1vbnN1Y2Nlc3MKCiAgICAgIGlmIG9uZXJyb3IgaXMgbm90IE5vbmU6CiAgICAgICAgIF9yZXN1bHQub25lcnJvcj1vbmVycm9yCgogIGRlZiBfaGVscGVyKHNlbGYsIGZ1bmMsIG9iamVjdCwgb25zdWNjZXNzPU5vbmUsIG9uZXJyb3I9Tm9uZSk6CiAgICAgIF9yZXN1bHQ9ZnVuYyhvYmplY3QpCgogICAgICBpZiBvbnN1Y2Nlc3MgaXMgbm90IE5vbmU6CiAgICAgICAgIF9yZXN1bHQub25zdWNjZXNzPW9uc3VjY2VzcwoKICAgICAgaWYgb25lcnJvciBpcyBub3QgTm9uZToKICAgICAgICAgX3Jlc3VsdC5vbmVycm9yPW9uZXJyb3IKCiAgZGVmIHB1dChzZWxmLCBvYmplY3QsIGtleT1Ob25lLCBvbnN1Y2Nlc3M9Tm9uZSwgb25lcnJvcj1Ob25lKToKICAgICAgX3I9c2VsZi5fb2JqZWN0U3RvcmUucHV0KG9iamVjdCwga2V5KQogICAgICBfci5vbnN1Y2Nlc3M9b25zdWNjZXNzCiAgICAgIF9yLm9uZXJyb3I9b25lcnJvcgoKICBkZWYgYWRkKHNlbGYsIG9iamVjdCwgb25zdWNjZXNzPU5vbmUsIG9uZXJyb3I9Tm9uZSk6CiAgICAgIHNlbGYuX2hlbHBlcihzZWxmLl9vYmplY3RTdG9yZS5hZGQsIG9iamVjdCwgb25zdWNjZXNzLCBvbmVycm9yKQoKICBkZWYgZGVsZXRlKHNlbGYsIGluZGV4LCBvbnN1Y2Nlc3M9Tm9uZSwgb25lcnJvcj1Ob25lKTogCiAgICAgIHNlbGYuX2hlbHBlcihzZWxmLl9vYmplY3RTdG9yZS5kZWxldGUsIGluZGV4LCBvbnN1Y2Nlc3MsIG9uZXJyb3IpCiAgICAgCiAgZGVmIHF1ZXJ5KHNlbGYsICphcmdzKToKICAgICAgc2VsZi5fZGF0YT1bXQogICAgICBkZWYgb25zdWNjZXNzKGV2ZW50KToKICAgICAgICAgIGN1cnNvcj1ldmVudC50YXJnZXQucmVzdWx0CiAgICAgICAgICBpZiBjdXJzb3IgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICBzZWxmLl9kYXRhLmFwcGVuZChjdXJzb3IudmFsdWUpCiAgICAgICAgICAgICBjdXJzb3IuY29udGludWUoKQoKICAgICAgc2VsZi5fb2JqZWN0U3RvcmUub3BlbkN1cnNvcihhcmdzKS5vbnN1Y2Nlc3M9b25zdWNjZXNzCgogIGRlZiBmZXRjaGFsbChzZWxmKToKICAgICAgeWllbGQgc2VsZi5fZGF0YQoKICBkZWYgZ2V0KHNlbGYsIGtleSwgb25zdWNjZXNzPU5vbmUsIG9uZXJyb3I9Tm9uZSk6CiAgICAgIHNlbGYuX2hlbHBlcihzZWxmLl9vYmplY3RTdG9yZS5nZXQsIGtleSwgb25zdWNjZXNzLCBvbmVycm9yKQo=',
'/Lib/browser/local_storage.py':'IyBsb2NhbCBzdG9yYWdlIGluIGJyb3dzZXIKCmNsYXNzIExvY2FsU3RvcmFnZToKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgaWYgbm90IF9fQlJZVEhPTl9fLmhhc19sb2NhbF9zdG9yYWdlOgogICAgICAgICAgICByYWlzZSBOYW1lRXJyb3IoJ2xvY2FsIHN0b3JhZ2UgaXMgbm90IHN1cHBvcnRlZCBieSB0aGUgYnJvd3NlcicpCiAgICAgICAgc2VsZi5zdG9yZSA9IF9fQlJZVEhPTl9fLmxvY2FsX3N0b3JhZ2UoKQogICAgICAgIAogICAgZGVmIF9fZGVsaXRlbV9fKHNlbGYsa2V5KToKICAgICAgICBzZWxmLnN0b3JlLnJlbW92ZUl0ZW0oa2V5KQoKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLGtleSk6CiAgICAgICAgcmVzPXNlbGYuc3RvcmUuZ2V0SXRlbShrZXkpCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgIHJldHVybiByZXMKICAgICAgICByYWlzZSBLZXlFcnJvcihrZXkpCgogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsa2V5LHZhbHVlKToKICAgICAgICBzZWxmLnN0b3JlLnNldEl0ZW0oa2V5LHZhbHVlKQoKICAgICNpbXBsZW1lbnQgImluIiBmdW5jdGlvbmFsaXR5CiAgICBkZWYgX19jb250YWluc19fKHNlbGYsIGtleSk6CiAgICAgICAgcmVzPXNlbGYuc3RvcmUuZ2V0SXRlbShrZXkpCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgIHJldHVybiBUcnVlCgogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBrZXlzKHNlbGYpOgogICAgICAgIHJldHVybiBsaXN0KHNlbGYuc3RvcmUpCgogICAgZGVmIHZhbHVlcyhzZWxmKToKICAgICAgICByZXR1cm4gW3NlbGYuX19nZXRpdGVtX18oaykgZm9yIGsgaW4gc2VsZi5rZXlzKCldCgogICAgZGVmIGl0ZW1zKHNlbGYpOgogICAgICAgIHJldHVybiB6aXAoc2VsZi5rZXlzKCksc2VsZi52YWx1ZXMoKSkKCnN0b3JhZ2UgPSBMb2NhbFN0b3JhZ2UoKQoK',
'/Lib/browser/markdown.py':'aW1wb3J0IGJyb3dzZXIuaHRtbAppbXBvcnQgcmUKCmNsYXNzIFVSTDoKICAgIGRlZiBfX2luaXRfXyhzZWxmLHNyYyk6CiAgICAgICAgZWx0cyA9IHNyYy5zcGxpdChtYXhzcGxpdD0xKQogICAgICAgIHNlbGYuaHJlZiA9IGVsdHNbMF0KICAgICAgICBzZWxmLmFsdCA9ICcnCiAgICAgICAgaWYgbGVuKGVsdHMpPT0yOgogICAgICAgICAgICBhbHQgPSBlbHRzWzFdCiAgICAgICAgICAgIGlmIGFsdFswXT09JyInIGFuZCBhbHRbLTFdPT0nIic6c2VsZi5hbHQ9YWx0WzE6LTFdCiAgICAgICAgICAgIGVsaWYgYWx0WzBdPT0iJyIgYW5kIGFsdFstMV09PSInIjpzZWxmLmFsdD1hbHRbMTotMV0KICAgICAgICAgICAgZWxpZiBhbHRbMF09PSIoIiBhbmQgYWx0Wy0xXT09IikiOnNlbGYuYWx0PWFsdFsxOi0xXQogICAgICAgIApjbGFzcyBDb2RlQmxvY2s6CiAgICBkZWYgX19pbml0X18oc2VsZixsaW5lKToKICAgICAgICBzZWxmLmxpbmVzID0gW2xpbmVdCiAgICAKICAgIGRlZiB0b19odG1sKHNlbGYpOgogICAgICAgIHJlcyA9IGVzY2FwZSgnXG4nLmpvaW4oc2VsZi5saW5lcykpCiAgICAgICAgcmVzID0gdW5tYXJrKHJlcykKICAgICAgICByZXMgPSAnPHByZSBjbGFzcz0ibWFya2VkIj4lczwvcHJlPlxuJyAlcmVzCiAgICAgICAgcmV0dXJuIHJlcyxbXQoKY2xhc3MgTWFya2VkOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYubGluZXMgPSBbXQogICAgICAgIHNlbGYuY2hpbGRyZW4gPSBbXQoKICAgIGRlZiB0b19odG1sKHNlbGYpOgogICAgICAgIHJldHVybiBhcHBseV9tYXJrZG93bignXG4nLmpvaW4oc2VsZi5saW5lcykpCiAgICAgICAgCiMgZ2V0IHJlZmVyZW5jZXMKcmVmcyA9IHt9CnJlZl9wYXR0ZXJuID0gciJeXFsoLiopXF06XHMrKC4qKSIKCmRlZiBtYXJrKHNyYyk6CgogICAgZ2xvYmFsIHJlZnMKICAgIHJlZnMgPSB7fQogICAgIyBzcGxpdCBzb3VyY2UgaW4gc2VjdGlvbnMKICAgICMgc2VjdGlvbnMgY2FuIGJlIDoKICAgICMgLSBhIGJsb2NrLWxldmVsIEhUTUwgZWxlbWVudCAobWFya2Rvd24gc3ludGF4IHdpbGwgbm90IGJlIHByb2Nlc3NlZCkKICAgICMgLSBhIHNjcmlwdAogICAgIyAtIGEgc3Bhbi1sZXZlbCBIVE1MIHRhZyAobWFya2Rvd24gc3ludGF4IHdpbGwgYmUgcHJvY2Vzc2VkKQogICAgIyAtIGEgY29kZSBibG9jawogICAgCiAgICBsaW5lcyA9IHNyYy5zcGxpdCgnXG4nKQogICAgCiAgICBzZWN0aW9ucyA9IFtdCiAgICBzY3JpcHRzID0gW10KICAgIHNlY3Rpb24gPSBNYXJrZWQoKQoKICAgIGkgPSAwCiAgICB3aGlsZSBpPGxlbihsaW5lcyk6CiAgICAgICAgbGluZSA9IGxpbmVzW2ldCiAgICAgICAgaWYgaXNpbnN0YW5jZShzZWN0aW9uLE1hcmtlZCk6CiAgICAgICAgICAgIGlmIGxpbmUubG93ZXIoKS5zdGFydHN3aXRoKCc8c2NyaXB0Jyk6CiAgICAgICAgICAgICAgICBqID0gaSsxCiAgICAgICAgICAgICAgICB3aGlsZSBqPGxlbihsaW5lcyk6CiAgICAgICAgICAgICAgICAgICAgaWYgbGluZXNbal0ubG93ZXIoKS5zdGFydHN3aXRoKCc8L3NjcmlwdD4nKToKICAgICAgICAgICAgICAgICAgICAgICAgc2NyaXB0cy5hcHBlbmQoJ1xuJy5qb2luKGxpbmVzW2krMTpqXSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBrIGluIHJhbmdlKGksaisxKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVzW2tdID0gJycKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICBqICs9IDEKICAgICAgICAgICAgICAgIGkgPSBqKzEKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGlmIGxpbmUuc3RyaXAoKSBhbmQgbGluZS5zdGFydHN3aXRoKCcgICAgJyk6CiAgICAgICAgICAgICAgICBpZiBzZWN0aW9uLmxpbmVzOgogICAgICAgICAgICAgICAgICAgIHNlY3Rpb25zLmFwcGVuZChzZWN0aW9uKQogICAgICAgICAgICAgICAgc2VjdGlvbiA9IENvZGVCbG9jayhsaW5lWzQ6XSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG1vID0gcmUuc2VhcmNoKHJlZl9wYXR0ZXJuLGxpbmUpCiAgICAgICAgICAgICAgICBpZiBtbyBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICBrZXkgPSBtby5ncm91cHMoKVswXQogICAgICAgICAgICAgICAgICAgIHZhbHVlID0gVVJMKG1vLmdyb3VwcygpWzFdKQogICAgICAgICAgICAgICAgICAgIHJlZnNba2V5Lmxvd2VyKCldID0gdmFsdWUKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VjdGlvbi5saW5lcy5hcHBlbmQobGluZSkKICAgICAgICBlbGlmIGlzaW5zdGFuY2Uoc2VjdGlvbixDb2RlQmxvY2spOgogICAgICAgICAgICBpZiBsaW5lLnN0YXJ0c3dpdGgoJyAgICAnKSBvciBub3QgbGluZS5zdHJpcCgpOgogICAgICAgICAgICAgICAgc2VjdGlvbi5saW5lcy5hcHBlbmQobGluZVs0Ol0pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWN0aW9ucy5hcHBlbmQoc2VjdGlvbikKICAgICAgICAgICAgICAgIHNlY3Rpb24gPSBNYXJrZWQoKSAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHNlY3Rpb24ubGluZXMuYXBwZW5kKGxpbmUpCiAgICAgICAgaSArPSAxCiAgICBpZiBzZWN0aW9uLmxpbmVzOgogICAgICAgIHNlY3Rpb25zLmFwcGVuZChzZWN0aW9uKQoKICAgIHJlcyA9ICcnCiAgICBmb3Igc2VjdGlvbiBpbiBzZWN0aW9uczoKICAgICAgICBtayxfc2NyaXB0cyA9IHNlY3Rpb24udG9faHRtbCgpCiAgICAgICAgcmVzICs9IG1rCiAgICAgICAgc2NyaXB0cyArPSBfc2NyaXB0cwogICAgcmV0dXJuIHJlcyxzY3JpcHRzCgpkZWYgZXNjYXBlKGN6b25lKToKICAgIGN6b25lID0gY3pvbmUucmVwbGFjZSgnJicsJyZhbXA7JykKICAgIGN6b25lID0gY3pvbmUucmVwbGFjZSgnPCcsJyZsdDsnKQogICAgY3pvbmUgPSBjem9uZS5yZXBsYWNlKCc+JywnJmd0OycpCiAgICByZXR1cm4gY3pvbmUKCmRlZiBzX2VzY2FwZShtbyk6CiAgICAjIHVzZWQgaW4gcmUuc3ViCiAgICBjem9uZSA9IG1vLnN0cmluZ1ttby5zdGFydCgpOm1vLmVuZCgpXQogICAgcmV0dXJuIGVzY2FwZShjem9uZSkKCmRlZiB1bm1hcmsoY29kZV96b25lKToKICAgICMgY29udmVydCBfIHRvICYjOTU7IGluc2lkZSBpbmxpbmUgY29kZQogICAgY29kZV96b25lID0gY29kZV96b25lLnJlcGxhY2UoJ18nLCcmIzk1OycpCiAgICByZXR1cm4gY29kZV96b25lCgpkZWYgc191bm1hcmsobW8pOgogICAgIyBjb252ZXJ0IF8gdG8gJiM5NTsgaW5zaWRlIGlubGluZSBjb2RlCiAgICBjb2RlX3pvbmUgPSBtby5zdHJpbmdbbW8uc3RhcnQoKTptby5lbmQoKV0KICAgIGNvZGVfem9uZSA9IGNvZGVfem9uZS5yZXBsYWNlKCdfJywnJiM5NTsnKQogICAgcmV0dXJuIGNvZGVfem9uZQoKZGVmIGFwcGx5X21hcmtkb3duKHNyYyk6CgogICAgc2NyaXB0cyA9IFtdCgogICAgIyBibG9ja3F1b3RlcwogICAgbGluZXMgPSBzcmMuc3BsaXQoJ1xuJykKICAgIHdoaWxlIFRydWU6CiAgICAgICAgbmIgPSAwCiAgICAgICAgaSA9IDAKICAgICAgICB3aGlsZSBpPGxlbihsaW5lcyk6CiAgICAgICAgICAgIGlmIGxpbmVzW2ldLnN0YXJ0c3dpdGgoJz4nKToKICAgICAgICAgICAgICAgIGhlYWQgPSAnXG4nLmpvaW4obGluZXNbOmldKQogICAgICAgICAgICAgICAgYnFsaW5lcyA9IFtdCiAgICAgICAgICAgICAgICBuYiArPSAxCiAgICAgICAgICAgICAgICByZXN0ID0gbGluZXNbaV1bMTpdCiAgICAgICAgICAgICAgICBpZiByZXN0LmxzdHJpcCgpLnN0YXJ0c3dpdGgoJz4nKToKICAgICAgICAgICAgICAgICAgICByZXN0ID0gcmVzdC5sc3RyaXAoKQogICAgICAgICAgICAgICAgYnFsaW5lcy5hcHBlbmQocmVzdCkKICAgICAgICAgICAgICAgIGogPSBpKzEKICAgICAgICAgICAgICAgIHdoaWxlIGo8bGVuKGxpbmVzKToKICAgICAgICAgICAgICAgICAgICBpZiBsaW5lc1tqXS5zdGFydHN3aXRoKCc+Jyk6CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3QgPSBsaW5lc1tqXVsxOl0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgcmVzdC5sc3RyaXAoKS5zdGFydHN3aXRoKCc+Jyk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN0ID0gcmVzdC5sc3RyaXAoKQogICAgICAgICAgICAgICAgICAgICAgICBicWxpbmVzLmFwcGVuZChyZXN0KQogICAgICAgICAgICAgICAgICAgICAgICBqICs9IDEKICAgICAgICAgICAgICAgICAgICBlbGlmIGxpbmVzW2pdLnN0cmlwKCkgYW5kIGxpbmVzW2pdWzBdIT0nICc6CiAgICAgICAgICAgICAgICAgICAgICAgIGJxbGluZXMuYXBwZW5kKGxpbmVzW2pdKQogICAgICAgICAgICAgICAgICAgICAgICBqICs9IDEKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgIyBicWxpbmVzIGhvbGRzIHRoZSBsaW5lcyBpbiB0aGUgYmxvY2txdW90ZSwgc3RyaXBwZWQgb2YKICAgICAgICAgICAgICAgICMgdGhlIGxlYWRpbmcgPgogICAgICAgICAgICAgICAgIyB3ZSBhcHBseSB0aGUgd2hvbGUgbWFya2Rvd24gcHJvY2VzcyB0byB0aGVzZSBsaW5lcwogICAgICAgICAgICAgICAgbWssX3NjcmlwdHMgPSBtYXJrKCdcbicuam9pbihicWxpbmVzKSkKICAgICAgICAgICAgICAgIHNjcmlwdHMgKz0gX3NjcmlwdHMKICAgICAgICAgICAgICAgIHNyYyA9IGhlYWQKICAgICAgICAgICAgICAgIHNyYyArPSAnXG48YmxvY2txdW90ZT4nICsgbWsgKyAnPC9ibG9ja3F1b3RlPicKICAgICAgICAgICAgICAgIHNyYyArPSAnXG4nLmpvaW4obGluZXNbajpdKQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgaSArPSAxCiAgICAgICAgaWYgbmI9PTA6YnJlYWsKICAgICAgICBsaW5lcyA9IHNyYy5zcGxpdGxpbmVzKCkKCiAgICAjIHJlcGxhY2UgXGAgYnkgJiM5NjsKICAgIHNyYyA9IHJlLnN1YihyJ1xcXGAnLCcmIzk2Oycsc3JjKQoKICAgICMgZXNjYXBlIDwgPiAmIGluIGlubGluZSBjb2RlCiAgICBjb2RlX3BhdHRlcm4gPSByJ1xgKFxTLio/XFMpXGAnCiAgICBzcmMgPSByZS5zdWIoY29kZV9wYXR0ZXJuLHNfZXNjYXBlLHNyYykKICAgICMgYWxzbyBjb252ZXJ0IF8KICAgIHNyYyA9IHJlLnN1Yihjb2RlX3BhdHRlcm4sc191bm1hcmssc3JjKQogICAgCiAgICAjIGlubGluZSBsaW5rcwogICAgbGlua19wYXR0ZXJuMSA9IHInXFsoLis/KVxdXHM/XCgoLis/KVwpJwogICAgZGVmIHJlcGwobW8pOgogICAgICAgIGcxLGcyID0gbW8uZ3JvdXBzKCkKICAgICAgICBnMiA9IHJlLnN1YignXycsJyYjOTU7JyxnMikKICAgICAgICByZXR1cm4gJzxhIGhyZWY9IiVzIj4lczwvYT4nICUoZzIsZzEpCiAgICBzcmMgPSByZS5zdWIobGlua19wYXR0ZXJuMSxyZXBsLHNyYykKCiAgICAjIHJlZmVyZW5jZSBsaW5rcwogICAgbGlua19wYXR0ZXJuMiA9IHInXFsoLis/KVxdXHM/XFsoLio/KVxdJwogICAgd2hpbGUgVHJ1ZToKICAgICAgICBtbyA9IHJlLnNlYXJjaChsaW5rX3BhdHRlcm4yLHNyYykKICAgICAgICBpZiBtbyBpcyBOb25lOmJyZWFrCiAgICAgICAgdGV4dCxrZXkgPSBtby5ncm91cHMoKQogICAgICAgIHByaW50KHRleHQsa2V5KQogICAgICAgIGlmIG5vdCBrZXk6a2V5PXRleHQgIyBpbXBsaWNpdCBsaW5rIG5hbWUKICAgICAgICBpZiBrZXkubG93ZXIoKSBub3QgaW4gcmVmczoKICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3IoJ3Vua25vdyByZWZlcmVuY2UgJXMnICVrZXkpCiAgICAgICAgdXJsID0gcmVmc1trZXkubG93ZXIoKV0KICAgICAgICByZXBsID0gJzxhIGhyZWY9IicrdXJsLmhyZWYrJyInCiAgICAgICAgaWYgdXJsLmFsdDoKICAgICAgICAgICAgcmVwbCArPSAnIHRpdGxlPSInK3VybC5hbHQrJyInCiAgICAgICAgcmVwbCArPSAnPiVzPC9hPicgJXRleHQKICAgICAgICBzcmMgPSByZS5zdWIobGlua19wYXR0ZXJuMixyZXBsLHNyYyxjb3VudD0xKQoKICAgICMgZW1waGFzaXMKCiAgICAjIHJlcGxhY2UgXCogYnkgJiM0MjsKICAgIHNyYyA9IHJlLnN1YihyJ1xcXConLCcmIzQyOycsc3JjKQogICAgIyByZXBsYWNlIFxfIGJ5ICYjOTU7CiAgICBzcmMgPSByZS5zdWIocidcXFxfJywnJiM5NTsnLHNyYykKICAgICMgXyBhbmQgKiBzdXJyb3VuZGVkIGJ5IHNwYWNlcyBhcmUgbm90IG1hcmt1cAogICAgc3JjID0gcmUuc3ViKHInIF8gJywnICYjOTU7ICcsc3JjKQogICAgc3JjID0gcmUuc3ViKHInIFwqICcsJyAmIzQyOyAnLHNyYykKCiAgICBzdHJvbmdfcGF0dGVybnMgPSBbKCdTVFJPTkcnLHInXCpcKiguKj8pXCpcKicpLCgnQicscidfXyguKj8pX18nKV0KICAgIGZvciB0YWcsc3Ryb25nX3BhdHRlcm4gaW4gc3Ryb25nX3BhdHRlcm5zOgogICAgICAgIHNyYyA9IHJlLnN1YihzdHJvbmdfcGF0dGVybixyJzwlcz5cMTwvJXM+JyAlKHRhZyx0YWcpLHNyYykKCiAgICBlbV9wYXR0ZXJucyA9IFsoJ0VNJyxyJ1wqKC4qPylcKicpLCgnSScscidcXyguKj8pXF8nKV0KICAgIGZvciB0YWcsZW1fcGF0dGVybiBpbiBlbV9wYXR0ZXJuczoKICAgICAgICBzcmMgPSByZS5zdWIoZW1fcGF0dGVybixyJzwlcz5cMTwvJXM+JyAlKHRhZyx0YWcpLHNyYykKCiAgICAjIGlubGluZSBjb2RlCiAgICAjIHJlcGxhY2UgXGAgYnkgJiM5NjsKICAgIHNyYyA9IHJlLnN1YihyJ1xcXGAnLCcmIzk2Oycsc3JjKQoKICAgIGNvZGVfcGF0dGVybiA9IHInXGAoLio/KVxgJwogICAgc3JjID0gcmUuc3ViKGNvZGVfcGF0dGVybixyJzxjb2RlPlwxPC9jb2RlPicsc3JjKQoKICAgICMgdW5vcmRlcmVkIGxpc3RzCiAgICBsaW5lcyA9IHNyYy5zcGxpdCgnXG4nKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICBuYiA9IDAKICAgICAgICBpID0gMAogICAgICAgIHdoaWxlIGk8bGVuKGxpbmVzKToKICAgICAgICAgICAgbW8gPSByZS5zZWFyY2gocideKCAqWysqLV0pJyxsaW5lc1tpXSkKICAgICAgICAgICAgaWYgbW86CiAgICAgICAgICAgICAgICBzdGFydGVyID0gbW8uZ3JvdXBzKClbMF0KICAgICAgICAgICAgICAgIGlmIG5vdCBsaW5lc1tpXS5zdHJpcChzdGFydGVyKToKICAgICAgICAgICAgICAgICAgICBpICs9IDEKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgbmIgKz0gMQogICAgICAgICAgICAgICAgbGluZXNbaV0gPSAnPHVsPlxuPGxpPicrbGluZXNbaV1bbGVuKHN0YXJ0ZXIpOl0KICAgICAgICAgICAgICAgIGogPSBpKzEKICAgICAgICAgICAgICAgIHdoaWxlIGo8bGVuKGxpbmVzKToKICAgICAgICAgICAgICAgICAgICBpZiBsaW5lc1tqXS5zdGFydHN3aXRoKHN0YXJ0ZXIpOgogICAgICAgICAgICAgICAgICAgICAgICBsaW5lc1tqXSA9ICc8bGk+JytsaW5lc1tqXVtsZW4oc3RhcnRlcik6XQogICAgICAgICAgICAgICAgICAgICAgICBqICs9IDEKICAgICAgICAgICAgICAgICAgICBlbGlmIGxpbmVzW2pdLnN0YXJ0c3dpdGgoJyAnKSBhbmQgbGluZXNbal0ubHN0cmlwKCkuc3RhcnRzd2l0aChzdGFydGVyKToKICAgICAgICAgICAgICAgICAgICAgICAgaiArPSAxCiAgICAgICAgICAgICAgICAgICAgZWxpZiBub3QgbGluZXNbal0uc3RyaXAoKToKICAgICAgICAgICAgICAgICAgICAgICAgais9MQogICAgICAgICAgICAgICAgICAgIGVsaWYgbGluZXNbal0uc3RhcnRzd2l0aCgnICcqbGVuKHN0YXJ0ZXIpKToKICAgICAgICAgICAgICAgICAgICAgICAgais9MQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBsaW5lc1tqLTFdICs9ICdcbjwvdWw+JwogICAgICAgICAgICBpICs9IDEKICAgICAgICBzcmMgPSAnXG4nLmpvaW4obGluZXMpCiAgICAgICAgaWYgbmI9PTA6YnJlYWsKICAgICAgICBsaW5lcyA9IHNyYy5zcGxpdGxpbmVzKCkKCiAgICAjIG9yZGVyZWQgbGlzdHMKICAgIGxpbmVzID0gc3JjLnNwbGl0KCdcbicpCiAgICB3aGlsZSBUcnVlOgogICAgICAgIG5iID0gMAogICAgICAgIGkgPSAwCiAgICAgICAgd2hpbGUgaTxsZW4obGluZXMpOgogICAgICAgICAgICBpZiByZS5zZWFyY2gocideXGQrXC4nLGxpbmVzW2ldKToKICAgICAgICAgICAgICAgIG5iICs9IDEKICAgICAgICAgICAgICAgIGxpbmVzW2ldID0gJzxvbD5cbjxsaT4nK2xpbmVzW2ldW2xpbmVzW2ldLmZpbmQoJy4nKSsxOl0KICAgICAgICAgICAgICAgIGogPSBpKzEKICAgICAgICAgICAgICAgIHdoaWxlIGo8bGVuKGxpbmVzKToKICAgICAgICAgICAgICAgICAgICBpZiByZS5zZWFyY2gocideXGQrXC4nLGxpbmVzW2pdKToKICAgICAgICAgICAgICAgICAgICAgICAgbGluZXNbal0gPSAnPGxpPicrbGluZXNbal1bbGluZXNbal0uZmluZCgnLicpKzE6XQogICAgICAgICAgICAgICAgICAgICAgICBqICs9IDEKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgbGluZXNbai0xXSArPSAnXG48L29sPicKICAgICAgICAgICAgaSArPSAxCiAgICAgICAgc3JjID0gJ1xuJy5qb2luKGxpbmVzKQogICAgICAgIGlmIG5iPT0wOmJyZWFrCiAgICAgICAgbGluZXMgPSBzcmMuc3BsaXRsaW5lcygpCgogICAgIyBoZWFkZXJzCiAgICBpID0gMQogICAgd2hpbGUgaTxsZW4obGluZXMpOgogICAgICAgIGxpbmUgPSBsaW5lc1tpXQogICAgICAgIGlmIGxpbmUuc3RhcnRzd2l0aCgnPScpIGFuZCBub3QgbGluZS5zdHJpcCgnPScpLnN0cmlwKCk6CiAgICAgICAgICAgIGxpbmVzW2ktMV0gPSAnPEgxPiVzPC9IMT4nICVsaW5lc1tpLTFdCiAgICAgICAgICAgIGRlbCBsaW5lc1tpXQogICAgICAgIGVsaWYgbGluZS5zdGFydHN3aXRoKCctJykgYW5kIG5vdCBsaW5lLnN0cmlwKCctJykuc3RyaXAoKToKICAgICAgICAgICAgbGluZXNbaS0xXSA9ICc8SDI+JXM8L0gyPicgJWxpbmVzW2ktMV0KICAgICAgICAgICAgZGVsIGxpbmVzW2ldCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaSArPSAxCiAgICAgICAgICAgCiAgICBhdHhfaGVhZGVyX3BhdHRlcm4gPSAnXigjKykoLiopKCMqKScKICAgIGZvciBpLGxpbmUgaW4gZW51bWVyYXRlKGxpbmVzKToKICAgICAgICBtbyA9IHJlLnNlYXJjaChhdHhfaGVhZGVyX3BhdHRlcm4sbGluZSkKICAgICAgICBpZiBub3QgbW86Y29udGludWUKICAgICAgICBsZXZlbCA9IGxlbihtby5ncm91cHMoKVswXSkKICAgICAgICBsaW5lc1tpXSA9IHJlLnN1YihhdHhfaGVhZGVyX3BhdHRlcm4sCiAgICAgICAgICAgICc8SCVzPiVzPC9IJXM+XG4nICUobGV2ZWwsbW8uZ3JvdXBzKClbMV0sbGV2ZWwpLAogICAgICAgICAgICBsaW5lLGNvdW50PTEpCgogICAgc3JjID0gJ1xuJy5qb2luKGxpbmVzKSAgICAgIAogICAgc3JjID0gcmUuc3ViKCdcblxuKycsJ1xuPHA+JyxzcmMpKydcbicKCiAgICByZXR1cm4gc3JjLHNjcmlwdHMK',
'/Lib/browser/pydom.py':'ZnJvbSBicm93c2VyIGltcG9ydCBkb2MKCmNsYXNzIE5vZGVDb2xsZWN0aW9uU2VsZWN0b3IoU2VsZWN0b3IpOgogIGRlZiBfX2luaXRfXyhzZWxmLCBzZWxlY3RvciwgY29sbGVjdGlvbik6CiAgICAgIFNlbGVjdG9yLl9faW5pdF9fKHNlbGYsIHNlbGVjdG9yKQogICAgICBzZWxmLl9jb2xsZWN0aW9uPWNvbGxlY3Rpb24KCiAgICAgIGlmIHNlbGYuX3NlbGVjdG9yX3R5cGUgPT0gJ2lkJzoKICAgICAgICAgc2VsZi5fbWF0Y2g9c2VsZi5fbWF0Y2hfaWQKICAgICAgZWxpZiBzZWxmLl9zZWxlY3Rvcl90eXBlID09J3RhZyc6CiAgICAgICAgIHNlbGYuX21hdGNoPXNlbGYuX21hdGNoX3RhZwogICAgICBlbGlmIHNlbGYuX3NlbGVjdG9yX3R5cGUgPT0gJ2NsYXNzbmFtZSc6CiAgICAgICAgIHNlbGYuX21hdGNoPXNlbGYuX21hdGNoX2NsYXNzbmFtZQoKICBkZWYgX21hdGNoX2lkKHNlbGYsIG5vZGUpOgogICAgICBpZiBub2RlLmlkIGlzIE5vbmU6IHJldHVybiBGYWxzZQogICAgICByZXR1cm4gbm9kZS5pZCA9PSBzZWxmLl9zZWxlY3RvcgoKICBkZWYgX21hdGNoX3RhZyhzZWxmLCBub2RlKToKICAgICAgcmV0dXJuIG5vZGUudGFnTmFtZSA9PSBzZWxmLl9zZWxlY3RvcgoKICBkZWYgX21hdGNoX2NsYXNzbmFtZShzZWxmLCBub2RlKToKICAgICAgcmV0dXJuIHNlbGYuX3NlbGVjdG9yIGluIG5vZGUuY2xhc3NuYW1lCgogIGRlZiBnZXQoc2VsZik6CiAgICAgIF9jMT1Ob2RlQ29sbGVjdGlvbigpCiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9jb2xsZWN0aW9uOgogICAgICAgICAgaWYgc2VsZi5fbWF0Y2goX25vZGUpOgogICAgICAgICAgICAgX2MxLmFwcGVuZChfbm9kZSkKCiAgICAgIHJldHVybiBfYzEKCmNsYXNzIFNlbGVjdG9yOgogIHRhZ3M9WydBJywnQUJCUicsJ0FDUk9OWU0nLCdBRERSRVNTJywnQVBQTEVUJywnQicsJ0JETycsJ0JJRycsJ0JMT0NLUVVPVEUnLAogICAgICAgICdCVVRUT04nLCdDQVBUSU9OJywnQ0VOVEVSJywnQ0lURScsJ0NPREUnLCdERUwnLCdERk4nLCdESVInLCdESVYnLCdETCcsCiAgICAgICAgJ0VNJywnRklFTERTRVQnLCdGT05UJywnRk9STScsJ0ZSQU1FU0VUJywnSDEnLCdIMicsJ0gzJywnSDQnLCdINScsJ0g2JywKICAgICAgICAnSScsJ0lGUkFNRScsJ0lOUycsJ0tCRCcsJ0xBQkVMJywnTEVHRU5EJywnTUFQJywnTUVOVScsJ05PRlJBTUVTJywgCiAgICAgICAgJ05PU0NSSVBUJywnT0JKRUNUJywnT0wnLCdPUFRHUk9VUCcsJ1BSRScsJ1EnLCdTJywnU0FNUCcsJ1NDUklQVCcsIAogICAgICAgICdTRUxFQ1QnLCdTTUFMTCcsJ1NQQU4nLCdTVFJJS0UnLCdTVFJPTkcnLCdTVFlMRScsJ1NVQicsJ1NVUCcsJ1RBQkxFJywKICAgICAgICAnVEVYVEFSRUEnLCdUSVRMRScsJ1RUJywnVScsJ1VMJywnVkFSJywnQk9EWScsJ0NPTEdST1VQJywnREQnLCdEVCcsCiAgICAgICAgJ0hFQUQnLCdIVE1MJywnTEknLCdQJywnVEJPRFknLCdPUFRJT04nLCdURCcsJ1RGT09UJywnVEgnLCdUSEVBRCcsJ1RSJywKICAgICAgICAnQVJFQScsJ0JBU0UnLCdCQVNFRk9OVCcsJ0JSJywnQ09MJywnRlJBTUUnLCdIUicsJ0lNRycsJ0lOUFVUJywKICAgICAgICAnSVNJTkRFWCcsJ0xJTksnLCdNRVRBJywnUEFSQU0nLCAgI0hUTUwgNSBlbGVtZW50cy4uLgogICAgICAgICdBUlRJQ0xFJywnQVNJREUnLCdBVURJTycsJ0JESScsJ0NBTlZBUycsJ0NPTU1BTkQnLCdEQVRBTElTVCcsCiAgICAgICAgJ0RFVEFJTFMnLCdESUFMT0cnLCdFTUJFRCcsJ0ZJR0NBUFRJT04nLCdGSUdVUkUnLCdGT09URVInLCdIRUFERVInLAogICAgICAgICdLRVlHRU4nLCdNQVJLJywnTUVURVInLCdOQVYnLCdPVVRQVVQnLCdQUk9HUkVTUycsJ1JQJywnUlQnLAogICAgICAgICdSVUJZJywnU0VDVElPTicsJ1NPVVJDRScsJ1NVTU1BUlknLCdUSU1FJywnVFJBQ0snLCdWSURFTycsJ1dCUiddCgogIGRlZiBfX2luaXRfXyhzZWxmLCBzZWxlY3Rvciwgc3RhcnRfbm9kZT1kb2MpOgogICAgICBzZWxmLl9kb2M9c3RhcnRfbm9kZQoKICAgICAgaWYgKGlzaW5zdGFuY2Uoc2VsZWN0b3IsIHN0cikpOgogICAgICAgICBpZiBzZWxlY3Rvci5zdGFydHN3aXRoKCIuIik6ICAgI2NsYXNzIHNlbGVjdG9yCiAgICAgICAgICAgIHNlbGYuX3NlbGVjdG9yPXNlbGVjdG9yWzE6XQogICAgICAgICAgICBzZWxmLl9zZWxlY3Rvcl90eXBlPSJjbGFzc25hbWUiCiAgICAgICAgIGVsaWYgc2VsZWN0b3Iuc3RhcnRzd2l0aCgiIyIpOiAgI2lkIHNlbGVjdG9yCiAgICAgICAgICAgIHNlbGYuX3NlbGVjdG9yPXNlbGVjdG9yWzE6XQogICAgICAgICAgICBzZWxmLl9zZWxlY3Rvcl90eXBlPSJpZCIKICAgICAgICAgZWxpZiBzZWxlY3Rvci51cHBlcigpIGluIHRhZ3M6CiAgICAgICAgICAgIHNlbGYuX3NlbGVjdG9yPXNlbGVjdG9yLnVwcGVyKCkKICAgICAgICAgICAgc2VsZi5fc2VsZWN0b3JfdHlwZT0idGFnIgogICAgICAgICBlbHNlOiAgCiAgICAgICAgICAgIHNlbGYuX3NlbGVjdG9yPXNlbGVjdG9yCiAgICAgICAgICAgIHNlbGYuX3NlbGVjdG9yX3R5cGU9InNlbGVjdG9yIgogICAgICBlbHNlOiAgI3RoaXMgaXMgYSBmdW5jdGlvbgogICAgICAgICBzZWxmLl9zZWxlY3Rvcl90eXBlPSJzZWxlY3RvciIKICAgICAgICAgc2VsZi5fZnVuY3Rpb249c2VsZWN0b3IKICAgICAgICAgc2VsZi5nZXQ9c2VsZi5fZnVuY3Rpb25fZ2V0CgogIGRlZiBfZnVuY3Rpb25fZ2V0KHNlbGYpOgogICAgICBkZWYgcmVjdXJzZShub2RlKToKICAgICAgICAgIF9saXN0PVtdCiAgICAgICAgICBpZiBzZWxmLl9mdW5jdGlvbihub2RlKToKICAgICAgICAgICAgIF9saXN0LmFwcGVuZChub2RlKQoKICAgICAgICAgIGZvciBfbm9kZSBpbiBub2RlLmNoaWxkTm9kZXM6CiAgICAgICAgICAgICAgX2xpc3QrPXJlY3Vyc2UoX25vZGUpCgogICAgICAgICAgcmV0dXJuIF9saXN0CgogICAgICBfbWF0Y2hlZF9ub2Rlcz1yZWN1cnNlKHNlbGYuX2RvYykKICAgICAgcmV0dXJuIE5vZGVDb2xsZWN0aW9uKF9tYXRjaGVkX25vZGVzKQoKICBkZWYgZ2V0KHNlbGYpOgogICAgICBpZiBzZWxmLl9zZWxlY3Rvcl90eXBlPT0iaWQiOgogICAgICAgICBfbWF0Y2hlZF9ub2Rlcz1zZWxmLl9kb2MuZ2V0KGlkPXNlbGYuX3NlbGVjdG9yKQogICAgICBlbGlmIHNlbGYuX3NlbGVjdG9yX3R5cGU9PSJjbGFzc25hbWUiOgogICAgICAgICBfbWF0Y2hlZF9ub2Rlcz1zZWxmLl9kb2MuZ2V0KGNsYXNzbmFtZT1zZWxmLl9zZWxlY3RvcikKICAgICAgZWxpZiBzZWxmLl9zZWxlY3Rvcl90eXBlID09ICJ0YWciOgogICAgICAgICBfbWF0Y2hlZF9ub2Rlcz1zZWxmLl9kb2MuZ2V0KHRhZz1zZWxmLl9zZWxlY3RvcikKICAgICAgZWxpZiBzZWxmLl9zZWxlY3Rvcl90eXBlPT0ic2VsZWN0b3IiOgogICAgICAgICBfbWF0Y2hlZF9ub2Rlcz1zZWxmLl9kb2MuZ2V0KHNlbGVjdG9yPXNlbGYuX3NlbGVjdG9yKQogICAgICBlbHNlOgogICAgICAgICBfbWF0Y2hlZF9ub2Rlcz1bXQogICAgICByZXR1cm4gTm9kZUNvbGxlY3Rpb24oX21hdGNoZWRfbm9kZXMpCgpjbGFzcyBOb2RlQ29sbGVjdGlvbjoKICBkZWYgX19pbml0X18oc2VsZiwgbm9kZXM9W10pOgogICAgICBzZWxmLl9ub2Rlcz1ub2RlcwoKICBkZWYgX19sZW5fXyhzZWxmKToKICAgICAgcmV0dXJuIGxlbihzZWxmLl9ub2RlcykKCiAgZGVmIF9faXRlbV9fKHNlbGYsIGkpOgogICAgICByZXR1cm4gc2VsZi5fbm9kZXNbaV0KCiAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGkpOgogICAgICByZXR1cm4gc2VsZi5fbm9kZXNbaV0KCiAgZGVmIF9fYWRkX18oc2VsZiwgbm9kZXMpOgogICAgICBzZWxmLl9ub2Rlcys9bm9kZXMKCiAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgIF9zdHI9W10KICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgX3N0ci5hcHBlbmQoX25vZGUuX19zdHJfXygpKQoKICAgICAgcmV0dXJuICc8YnI+Jy5qb2luKF9zdHIpCgogIGRlZiBhcHBlbmQoc2VsZiwgbm9kZSk6ICAgICAgICAKICAgICAgc2VsZi5fbm9kZXMuYXBwZW5kKG5vZGUpCgogIGRlZiBuZXh0KHNlbGYpOgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICB5aWVsZCBfbm9kZQoKICBkZWYgYWRkKHNlbGYsIHNlbGVjdG9yLCBjb250ZXh0KToKICAgICAgX25zPU5vZGVDb2xsZWN0aW9uU2VsZWN0b3Ioc2VsZWN0b3IsIHNlbGYpCiAgICAgIHNlbGYuX25vZGVzKz1fbnMuZ2V0KCkKCiAgZGVmIGFkZEJhY2soc2VsZik6CiAgICAgIHBhc3MKCiAgZGVmIGFkZENsYXNzKHNlbGYsIGNsYXNzbmFtZSk6CiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIF9ub2RlLmFkZENsYXNzKGNsYXNzbmFtZSkKCiAgZGVmIGFmdGVyKHNlbGYsIGNvbnRlbnQpOgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBfbm9kZS5hZnRlcihjb250ZW50KQoKICBkZWYgYXBwZW5kX2NvbnRlbnQoc2VsZiwgY29udGVudCk6CiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIF9ub2RlLmFwcGVuZChjb250ZW50KQoKICBkZWYgYXBwZW5kVG8oc2VsZiwgc2VsZWN0b3IpOgogICAgICBfcz1TZWxlY3RvcihzZWxlY3RvcikKCiAgICAgIGZvciBfbm9kZSBpbiBfcy5nZXQoKToKICAgICAgICAgIF9ub2RlLmFwcGVuZChzZWxmLl9ub2RlWzBdLmNsb25lKCkpCgogIGRlZiBhdHRyKHNlbGYsIHByb3BlcnR5LCB2YWx1ZT1Ob25lKToKICAgICAgaWYgdmFsdWUgaXMgTm9uZToKICAgICAgICAgcmV0dXJuIHNlbGYuX25vZGVzWzBdW3Byb3BlcnR5XQoKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgX25vZGVbcHJvcGVydHldPXZhbHVlCgogIGRlZiBiZWZvcmUoc2VsZiwgY29udGVudCk6CiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIF9ub2RlLmJlZm9yZShjb250ZW50KQoKICBkZWYgYmluZChzZWxmLCBldmVudCwgaGFuZGxlcik6CiAgICAgIGlmICcgJyBpbiBldmVudDoKICAgICAgICAgX2V2ZW50cz0nICcuc3BsaXQoZXZlbnQpCiAgICAgICAgIGZvciBfZXZlbnQgaW4gX2V2ZW50czoKICAgICAgICAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgICAgICAgICBfbm9kZVsnb24lcycgJSBldmVudF09aGFuZGxlcgogICAgICAgICByZXR1cm4KCiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIF9ub2RlWydvbiVzJyAlIGV2ZW50XT1oYW5kbGVyCgogIGRlZiBibHVyKHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIGNoYW5nZShzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBjaGlsZHJlbihzZWxmLCBzZWxlY3Rvcj1Ob25lKToKICAgICAgX2M9Tm9kZUNvbGxlY3Rpb24oKQogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBmb3IgX2NoaWxkIGluIF9ub2RlLmdldF9jaGlsZHJlbigpOgogICAgICAgICAgICAgIF9jLmFwcGVuZChfY2hpbGQpCgogICAgICBpZiBzZWxlY3RvciBpcyBOb25lOgogICAgICAgICByZXR1cm4gX2MKCiAgICAgICNzZWxlY3RvciBpcyBub3QgTm9uZQogICAgICBfbnM9Tm9kZUNvbGxlY3Rpb25TZWxlY3RvcihzZWxlY3RvciwgX2MpCiAgICAgIHJldHVybiBfbnMuZ2V0KCkKCiAgZGVmIGNsaWNrKHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIGNsb25lKHNlbGYpOgogICAgICByZXR1cm4gTm9kZUNvbGxlY3Rpb24oW19ub2RlLmNsb25lKCkgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzXSkKCiAgZGVmIGNsb3Nlc3Qoc2VsZiwgc2VsZWN0b3IpOgogICAgICBpZiBpc2luc3RhbmNlKHNlbGVjdG9yLCBzdHIpOgogICAgICAgICBfbnM9U2VsZWN0b3Ioc2VsZWN0b3IpCiAgICAgICAgIHNlbGVjdG9yPV9ucy5nZXQoKQoKICAgICAgX2M9Tm9kZUNvbGxlY3Rpb24oKQogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBfYy5hcHBlbmQoX25vZGUuY2xvc2VzdChzZWxlY3RvcikpCgogICAgICByZXR1cm4gX2MKCiAgZGVmIGNvbnRhaW5zKHNlbGYsIHRleHQpOgogICAgICBwYXNzCgogIGRlZiBjb250ZW50cyhzZWxmKToKICAgICAgcGFzcwoKICBkZWYgY3NzKHNlbGYsIHByb3BlcnR5LCB2YWx1ZT1Ob25lKToKICAgICAgaWYgdmFsdWUgaXMgTm9uZSBhbmQgbm90IGlzaW5zdGFuY2UocHJvcGVydHksIGRpY3QpOgogICAgICAgICByZXR1cm4gc2VsZi5fbm9kZXNbMF0uY3NzKHByb3BlcnR5KQoKICAgICAgaWYgaXNpbnN0YW5jZShwcm9wZXJ0eSwgZGljdCk6CiAgICAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgICAgIF9ub2RlLmNzcyhwcm9wZXJ0eSkKICAgICAgZWxzZToKICAgICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgICAgX25vZGUuY3NzKHByb3BlcnR5LCB2YWx1ZSkKCiAgZGVmIGRhdGEoc2VsZik6CiAgICAgIHBhc3MKCiAgZGVmIGRibGNsaWNrKHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIGRldGFjaChzZWxmKToKICAgICAgcGFzcwoKICBkZWYgZWFjaChzZWxmLCBmdW5jKToKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgZnVuYyhfbm9kZSkKCiAgZGVmIGVtcHR5KHNlbGYpOgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBfbm9kZS5lbXB0eSgpCgogIGRlZiBlcShzZWxmLCBpbmRleCk6CiAgICAgIGlmIGluZGV4IDwgbGVuKHNlbGYuX25vZGVzKToKICAgICAgICAgcmV0dXJuIE5vZGVDb2xsZWN0aW9ucyhzZWxmLl9ub2Rlc1tpbmRleF0pCgogICAgICByZXR1cm4gTm9kZUNvbGxlY3Rpb25zKCkKCiAgZGVmIGVycm9yKHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIGZhZGVJbihzZWxmKToKICAgICAgcGFzcwoKICBkZWYgZmFkZU91dChzZWxmKToKICAgICAgcGFzcwoKICBkZWYgZmFkZVRvKHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBmYWRlVG9nZ2xlKHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBmaWx0ZXIoc2VsZiwgc2VsZWN0b3IpOgogICAgICBfbnM9Tm9kZUNvbGxlY3Rpb25TZWxlY3RvcihzZWxlY3Rvciwgc2VsZikKICAgICAgcmV0dXJuIF9ucy5nZXQoKQoKICBkZWYgZmluZChzZWxmKToKICAgICAgcGFzcwoKICBkZWYgZmlyc3Qoc2VsZik6CiAgICAgIGlmIGxlbihzZWxmLl9ub2RlcykgPT0gMDoKICAgICAgICAgcmV0dXJuIE5vZGVDb2xsZWN0aW9uKCkKCiAgICAgIHJldHVybiBOb2RlQ29sbGVjdGlvbihbc2VsZi5fbm9kZXNbMF1dKQoKICBkZWYgZm9jdXMoc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgZm9jdXNpbihzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBmb2N1c291dChzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBnZXQoc2VsZiwgaW5kZXg9Tm9uZSk6CiAgICAgIGlmIGluZGV4IGlzIE5vbmU6CiAgICAgICAgIHJldHVybiBbX25vZGUgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzXQoKICAgICAgcmV0dXJuIHNlbGYuX25vZGVzW2luZGV4XQoKICBkZWYgZ3Qoc2VsZiwgaW5kZXgpOgogICAgICByZXR1cm4gTm9kZUNvbGxlY3Rpb24oW3NlbGYuX25vZGVzW2luZGV4Ol1dKQoKICBkZWYgaGFzKHNlbGYsIHNlbGVjdG9yKToKICAgICAgcGFzcwogIAogIGRlZiBoYXNDbGFzcyhzZWxmLCBuYW1lKToKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgaWYgX25vZGUuaGFzQ2xhc3MobmFtZSk6CiAgICAgICAgICAgICByZXR1cm4gVHJ1ZQoKICAgICAgcmV0dXJuIEZhbHNlCgogIGRlZiBoZWlnaHQoc2VsZiwgdmFsdWU9Tm9uZSk6CiAgICAgIGlmIHZhbHVlIGlzIE5vbmU6CiAgICAgICAgIHJldHVybiBzZWxmLl9ub2Rlc1swXS5jc3MoJ2hlaWdodCcpCgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBfbm9kZS5zZXRfc3R5bGUoeydoZWlnaHQnOiB2YWx1ZX0pCgogIGRlZiBoaWRlKHNlbGYpOgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBfbm9kZS5zZXRfc3R5bGUoeydkaXNwbGF5JzogJ25vbmUnfSkKCiAgZGVmIGhvdmVyKHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIGh0bWwoc2VsZiwgY29udGVudD1Ob25lKToKICAgICAgaWYgY29udGVudCBpcyBOb25lOgogICAgICAgICByZXR1cm4gc2VsZi5fbm9kZXNbMF0uZ2V0X2h0bWwoKQoKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgX25vZGUuc2V0X2h0bWwoY29udGVudCkKCiAgZGVmIGlubmVySGVpZ2h0KHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBpbm5lcldpZHRoKHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBpbnNlcnRBZnRlcihzZWxmLCB0YXJnZXQpOgogICAgICBwYXNzCgogIGRlZiBpbnNlcnRCZWZvcmUoc2VsZiwgdGFyZ2V0KToKICAgICAgcGFzcwoKICAjZGVmIGlzKHNlbGYsIHNlbGVjdG9yKToKICAjICAgIHBhc3MKCiAgZGVmIGtleWRvd24oc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYga2V5cHJlc3Moc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYga2V5dXAoc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgbGFzdChzZWxmKToKICAgICAgcmV0dXJuIHNlbGYuX25vZGVzWy0xXQoKICBAcHJvcGVydHkKICBkZWYgbGVuZ3RoKHNlbGYpOgogICAgICByZXR1cm4gbGVuKHNlbGYuX25vZGVzKQoKICBkZWYgbW91c2Vkb3duKHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIG1vdXNlZW50ZXIoc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgbW91c2VsZWF2ZShzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBtb3VzZW1vdmUoc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgbW91c2VvdXQoc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgbW91c2VvdmVyKHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIG1vdXNldXAoc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgbmV4dChzZWxmKToKICAgICAgcGFzcwoKICBkZWYgbmV4dEFsbChzZWxmKToKICAgICAgcGFzcwoKICBkZWYgbmV4dFV0aWwoc2VsZik6CiAgICAgIHBhc3MKCiAgZGVmIG9mZihzZWxmLCBoYW5kbGVyKToKICAgICAgcGFzcwoKICBkZWYgb2Zmc2V0KHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBvZmZzZXRQYXJlbnQoc2VsZik6CiAgICAgIHBhc3MKCiAgZGVmIG9uKHNlbGYsIGhhbmRsZXIpOgogICAgICBwYXNzCgogIGRlZiBvdXRlckhlaWdodChzZWxmKToKICAgICAgcGFzcwoKICBkZWYgb3V0ZXJXaWR0aChzZWxmKToKICAgICAgcGFzcwoKICBkZWYgcGFyZW50KHNlbGYpOgogICAgICBfcD1Ob2RlQ29sbGVjdGlvbigpCiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIF9wLmFwcGVuZChfbm9kZS5nZXRfcGFyZW50KCkpCgogIGRlZiBwYXJlbnRzKHNlbGYsIHNlbGVjdG9yPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBwYXJlbnRzVW50aWwoc2VsZiwgc2VsZWN0b3I9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIHBvc2l0aW9uKHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBwcmVwZW5kKHNlbGYsIGNvbnRlbnQpOgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBfbm9kZS5wcmVwZW5kKGNvbnRlbnQpCgogIGRlZiBwcmVwZW5kVG8oc2VsZiwgdGFyZ2V0KToKICAgICAgcGFzcwoKICBkZWYgcHJldihzZWxmKToKICAgICAgX3AxPU5vZGVDb2xsZWN0aW9uKCkKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgX3BhcmVudD1fbm9kZS5nZXRfcGFyZW50KCkKICAgICAgICAgIGZvciBfaSBpbiByYW5nZShsZW4oX3BhcmVudC5jaGlsZE5vZGVzKSk6CiAgICAgICAgICAgICAgaWYgX3BhcmVudC5jaGlsZE5vZGVzW19pXSA9PSBfbm9kZToKICAgICAgICAgICAgICAgICBpZiBfaSA+IDA6CiAgICAgICAgICAgICAgICAgICAgX3AxLmFwcGVuZChfcGFyZW50LmNoaWxkTm9kZXNbX2ktMV0pCiAgICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgIHJldHVybiBfcDEKCiAgZGVmIHByZXZBbGwoc2VsZiwgc2VsZWN0b3I9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIHByZXZVbnRpbChzZWxmLCBzZWxlY3Rvcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgcHJvcChzZWxmLCBwcm9wZXJ0eSwgdmFsdWU9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIHJlYWR5KHNlbGYsIGZ1bmMpOgogICAgICBwYXNzCgogIGRlZiByZW1vdmUoc2VsZik6CiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIF9ub2RlLmdldF9wYXJlbnQoKS5yZW1vdmVDaGlsZChfbm9kZSkgCgogIGRlZiByZW1vdmVBdHRyKHNlbGYsIGF0dHIpOgogICAgICBwYXNzCgogIGRlZiByZW1vdmVDbGFzcyhzZWxmLCBuYW1lKToKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgX25vZGUucmVtb3ZlQ2xhc3MobmFtZSkKCiAgZGVmIHJlbW92ZVByb3Aoc2VsZiwgcHJvcGVydHkpOgogICAgICBwYXNzCgogIGRlZiByZXBsYWNlQWxsKHNlbGYpOgogICAgICBwYXNzCgogIGRlZiByZXBsYWNlV2l0aChzZWxmLCBjb250ZW50KToKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgX25vZGUuZ2V0X3BhcmVudCgpLnJlcGxhY2VXaXRoKGNvbnRlbnQsIF9ub2RlKQoKICBkZWYgcmVzaXplKHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIHNjcm9sbChzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBzY3JvbGxMZWZ0KHNlbGYsIHZhbHVlPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBzY3JvbGxUb3Aoc2VsZiwgdmFsdWU9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIHNlbGVjdChzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiBzaG93KHNlbGYpOgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBfbm9kZS5zZXRfc3R5bGUoeydkaXNwbGF5JzogJ2Jsb2NrJ30pCgogIGRlZiBzaWJsaW5ncyhzZWxmLCBzZWxlY3Rvcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgc2l6ZShzZWxmKToKICAgICAgcGFzcwoKICBkZWYgc2xpY2Uoc2VsZiwgaW5kZXgxPU5vbmUsIGluZGV4Mj1Ob25lKToKICAgICAgaWYgaW5kZXgxIGlzIE5vbmUgYW5kIGluZGV4MiBpcyBOb25lOgogICAgICAgICByZXR1cm4gTm9kZUNvbGxlY3Rpb24oKQoKICAgICAgcmV0dXJuIE5vZGVDb2xsZWN0aW9uKHNlbGYuX25vZGVzW2luZGV4MTppbmRleDJdKQoKICBkZWYgc2xpZGVEb3duKHNlbGYpOgogICAgICBwYXNzCgogIGRlZiBzbGlkZVRvZ2dsZShzZWxmKToKICAgICAgcGFzcwoKICBkZWYgc2xpZGVVcChzZWxmKToKICAgICAgcGFzcwoKICBkZWYgc3VibWl0KHNlbGYsIGhhbmRsZXI9Tm9uZSk6CiAgICAgIHBhc3MKCiAgZGVmIHRleHQoc2VsZiwgY29udGVudD1Ob25lKToKICAgICAgaWYgY29udGVudCBpcyBOb25lOgogICAgICAgICByZXR1cm4gc2VsZi5fbm9kZXNbMF0uZ2V0X3RleHQoKQoKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgX25vZGUuc2V0X3RleHQoY29udGVudCkgCgogIGRlZiB0b2dnbGUoc2VsZiwgRnVuY3Rpb249Tm9uZSk6CiAgICAgIGlmIEZ1bmN0aW9uIGlzIE5vbmU6CiAgICAgICAgIF9zaG93PVRydWUKICAgICAgICAgaWYgc2VsZi5fbm9kZXNbMF0uY3NzKCdkaXNwbGF5JykgIT0gJ25vbmUnOgogICAgICAgICAgICBfc2hvdz1GYWxzZQogICAgICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICAgICBpZiBfc2hvdzoKICAgICAgICAgICAgICAgIF9ub2RlLnNldF9zdHlsZSh7J2Rpc3BsYXknOiAnYmxvY2snfSkKICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBfbm9kZS5zZXRfc3R5bGUoeydkaXNwbGF5JzogJ25vbmUnfSkKICAKICAgICAgICAgICAgIF9zaG93PW5vdCBfc2hvdwoKICAgICAgICAgcmV0dXJuCgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBpZiBGdW5jdGlvbihfbm9kZSk6CiAgICAgICAgICAgICBfbm9kZS5zZXRfc3R5bGUoeydkaXNwbGF5JzogJ2Jsb2NrJ30pCiAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgX25vZGUuc2V0X3N0eWxlKHsnZGlzcGxheSc6ICdub25lJ30pCgogIGRlZiB0b2dnbGVDbGFzcyhzZWxmKToKICAgICAgcGFzcwoKICBkZWYgdG9MaXN0KHNlbGYpOgogICAgICByZXR1cm4gc2VsZi5fbm9kZXMKCiAgdG9BcnJheT10b0xpc3QgICAjZm9yIGpRdWVyeSBjb21wYXRpYmlsaXR5CgogIGRlZiB0b3VjaGVuZChzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiB0b3VjaG1vdmUoc2VsZiwgaGFuZGxlcj1Ob25lKToKICAgICAgcGFzcwoKICBkZWYgdG91Y2hzdGFydChzZWxmLCBoYW5kbGVyPU5vbmUpOgogICAgICBwYXNzCgogIGRlZiB0cmlnZ2VyKHNlbGYsIGV2ZW50X3R5cGUpOgogICAgICBwYXNzCgogIGRlZiB0cmlnZ2VySGFuZGxlcihzZWxmLCBldmVudF90eXBlKToKICAgICAgcGFzcwoKCiAgZGVmIHVuYmluZChzZWxmLCBldmVudCwgaGFuZGxlcik6CiAgICAgIGlmICcgJyBpbiBldmVudDoKICAgICAgICAgX2V2ZW50cz0nICcuc3BsaXQoZXZlbnQpCiAgICAgICAgIGZvciBfZXZlbnQgaW4gX2V2ZW50czoKICAgICAgICAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgICAgICAgICBwcmludCgiZml4IG1lISIpCiAgICAgICAgIHJldHVybgoKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgI2xvb2sgaW50byBob3cgdG8gZGV0YWNoIGFuIGV2ZW50CiAgICAgICAgICBwcmludCgiZml4IG1lIikKCgogIGRlZiB1bmxvYWQoc2VsZiwgaGFuZGxlcik6CiAgICAgIHBhc3MKCiAgZGVmIHVud3JhcChzZWxmKToKICAgICAgZm9yIF9ub2RlIGluIHNlbGYuX25vZGVzOgogICAgICAgICAgX3BhcmVudD1fbm9kZS5nZXRfcGFyZW50KCkKICAgICAgICAgIF9ncmFuZHBhcmVudD1fcGFyZW50LmdldF9wYXJlbnQoKQogICAgICAgICAgX2dyYW5kcGFyZW50LnJlcGxhY2VDaGlsZChfbm9kZSwgX3BhcmVudCkKCiAgICAgICAgICBfcGFyZW50LnJlbW92ZSgpCgogIGRlZiB2YWwoc2VsZiwgdmFsdWU9Tm9uZSk6CiAgICAgIGlmIHZhbHVlIGlzIE5vbmU6CiAgICAgICAgIHJldHVybiBzZWxmLl9ub2Rlc1swXVsndGV4dCddICAgI2lzIHRleHQgdGhlIGJlc3QgaGVyZT8KCiAgICAgIGZvciBfbm9kZSBpbiBzZWxmLl9ub2RlczoKICAgICAgICAgIF9ub2RlWyd0ZXh0J109dmFsdWUKCiAgZGVmIHdpZHRoKHNlbGYsIHdpZHRoPU5vbmUpOgogICAgICBpZiB3aWR0aCBpcyBOb25lOgogICAgICAgICByZXR1cm4gc2VsZi5fbm9kZXNbMF0uY3NzKCd3aWR0aCcpCgogICAgICBmb3IgX25vZGUgaW4gc2VsZi5fbm9kZXM6CiAgICAgICAgICBfbm9kZS5zZXRfc3R5bGUoeyd3aWR0aCc6IHdpZHRofSkKCiAgZGVmIHdyYXAoc2VsZik6CiAgICAgIHBhc3MKCiAgZGVmIHdyYXBBbGwoc2VsZik6CiAgICAgIHBhc3MKCiAgZGVmIHdyYXBJbm5lcihzZWxmKToKICAgICAgcGFzcwoKZGVmIGJ5SWQoaWQpOgogICAgX3Jlc3VsdD1kb2MuZ2V0KGlkPWlkKQogICAgcmV0dXJuIF9yZXN1bHRbMF0KCmRlZiBjcmVhdGVDU1NDbGFzcyhjc3N0ZXh0KToKICAgIF9zdHlsZT1kb2MuY3JlYXRlRWxlbWVudCgnc3R5bGUnKQogICAgX3N0eWxlLnR5cGU9J3RleHQvY3NzJwogICAgX3N0eWxlLmlubmVySFRNTCA9IGNzc3RleHQKICAgIGRvYy5nZXQodGFnPSdoZWFkJylbMF0uYXBwZW5kQ2hpbGQoX3N0eWxlKQo=',
'/Lib/browser/svg.py':'ZnJvbSBfc3ZnIGltcG9ydCAq',
'/Lib/browser/timer.py':'ZnJvbSBfdGltZXIgaW1wb3J0ICo=',
'/Lib/browser/websocket.py':'ZnJvbSBfd2Vic29ja2V0IGltcG9ydCAq',
'/Lib/browser/__init__.py':'ZnJvbSBfYnJvd3NlciBpbXBvcnQgKgo=',
'/Lib/collections/abc.py':'TXV0YWJsZU1hcHBpbmcgPSBkaWN0',
'/Lib/collections/__init__.py':'I19fYWxsX18gPSBbJ2RlcXVlJywgJ2RlZmF1bHRkaWN0JywgJ0NvdW50ZXInXQoKZnJvbSBfY29sbGVjdGlvbnMgaW1wb3J0IGRlcXVlLCBkZWZhdWx0ZGljdAoKI2Zyb20gaXRlcnRvb2xzIGltcG9ydCByZXBlYXQgYXMgX3JlcGVhdCwgY2hhaW4gYXMgX2NoYWluLCBzdGFybWFwIGFzIF9zdGFybWFwCgpfX2FsbF9fID0gWydkZXF1ZScsICdkZWZhdWx0ZGljdCcsICduYW1lZHR1cGxlJywgJ1VzZXJEaWN0JywgJ1VzZXJMaXN0JywKICAgICAgICAgICAgJ1VzZXJTdHJpbmcnLCAnQ291bnRlcicsICdPcmRlcmVkRGljdCddCiMgRm9yIGJvb3RzdHJhcHBpbmcgcmVhc29ucywgdGhlIGNvbGxlY3Rpb24gQUJDcyBhcmUgZGVmaW5lZCBpbiBfYWJjb2xsLnB5LgojIFRoZXkgc2hvdWxkIGhvd2V2ZXIgYmUgY29uc2lkZXJlZCBhbiBpbnRlZ3JhbCBwYXJ0IG9mIGNvbGxlY3Rpb25zLnB5LgoKIyBmaXhtZSBicnl0aG9uLi4gdGhlcmUgaXMgYW4gaXNzdWUgd2l0aCBfYWJjb2xsCiNmcm9tIF9hYmNvbGwgaW1wb3J0ICoKI2Zyb20gX2FiY29sbCBpbXBvcnQgU2V0CmZyb20gX2FiY29sbCBpbXBvcnQgTXV0YWJsZU1hcHBpbmcKI2ltcG9ydCBfYWJjb2xsCiNfX2FsbF9fICs9IF9hYmNvbGwuX19hbGxfXwoKZnJvbSBfY29sbGVjdGlvbnMgaW1wb3J0IGRlcXVlLCBkZWZhdWx0ZGljdCwgbmFtZWR0dXBsZQojZml4bWUsIGJyeXRob24uICBUaGlzIGNhdXNlcyBhIFJlZmVyZW5jZUVycm9yOiBpdGVtZ2V0dGVyIGlzIG5vdCBkZWZpbmVkCmZyb20gb3BlcmF0b3IgaW1wb3J0IGl0ZW1nZXR0ZXIgYXMgX2l0ZW1nZXR0ZXIKZnJvbSBrZXl3b3JkIGltcG9ydCBpc2tleXdvcmQgYXMgX2lza2V5d29yZAppbXBvcnQgc3lzIGFzIF9zeXMKaW1wb3J0IGhlYXBxIGFzIF9oZWFwcQojZml4bWUgYnJ5dGhvbgojZnJvbSB3ZWFrcmVmIGltcG9ydCBwcm94eSBhcyBfcHJveHkKZnJvbSBpdGVydG9vbHMgaW1wb3J0IHJlcGVhdCBhcyBfcmVwZWF0LCBjaGFpbiBhcyBfY2hhaW4sIHN0YXJtYXAgYXMgX3N0YXJtYXAKI2ZpeG1lIGJyeXRob24gCmZyb20gcmVwcmxpYiBpbXBvcnQgcmVjdXJzaXZlX3JlcHIgYXMgX3JlY3Vyc2l2ZV9yZXByCgpjbGFzcyBTZXQoc2V0KToKICAgIHBhc3MKCmNsYXNzIFNlcXVlbmNlKGxpc3QpOgogICAgcGFzcwoKZGVmIF9wcm94eShvYmopOgogICAgcmV0dXJuIG9iagoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjIE9yZGVyZWREaWN0CiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpjbGFzcyBfTGluayhvYmplY3QpOgogICAgX19zbG90c19fID0gJ3ByZXYnLCAnbmV4dCcsICdrZXknLCAnX193ZWFrcmVmX18nCgpjbGFzcyBPcmRlcmVkRGljdChkaWN0KToKICAgICdEaWN0aW9uYXJ5IHRoYXQgcmVtZW1iZXJzIGluc2VydGlvbiBvcmRlcicKICAgICMgQW4gaW5oZXJpdGVkIGRpY3QgbWFwcyBrZXlzIHRvIHZhbHVlcy4KICAgICMgVGhlIGluaGVyaXRlZCBkaWN0IHByb3ZpZGVzIF9fZ2V0aXRlbV9fLCBfX2xlbl9fLCBfX2NvbnRhaW5zX18sIGFuZCBnZXQuCiAgICAjIFRoZSByZW1haW5pbmcgbWV0aG9kcyBhcmUgb3JkZXItYXdhcmUuCiAgICAjIEJpZy1PIHJ1bm5pbmcgdGltZXMgZm9yIGFsbCBtZXRob2RzIGFyZSB0aGUgc2FtZSBhcyByZWd1bGFyIGRpY3Rpb25hcmllcy4KCiAgICAjIFRoZSBpbnRlcm5hbCBzZWxmLl9fbWFwIGRpY3QgbWFwcyBrZXlzIHRvIGxpbmtzIGluIGEgZG91Ymx5IGxpbmtlZCBsaXN0LgogICAgIyBUaGUgY2lyY3VsYXIgZG91Ymx5IGxpbmtlZCBsaXN0IHN0YXJ0cyBhbmQgZW5kcyB3aXRoIGEgc2VudGluZWwgZWxlbWVudC4KICAgICMgVGhlIHNlbnRpbmVsIGVsZW1lbnQgbmV2ZXIgZ2V0cyBkZWxldGVkICh0aGlzIHNpbXBsaWZpZXMgdGhlIGFsZ29yaXRobSkuCiAgICAjIFRoZSBzZW50aW5lbCBpcyBpbiBzZWxmLl9faGFyZHJvb3Qgd2l0aCBhIHdlYWtyZWYgcHJveHkgaW4gc2VsZi5fX3Jvb3QuCiAgICAjIFRoZSBwcmV2IGxpbmtzIGFyZSB3ZWFrcmVmIHByb3hpZXMgKHRvIHByZXZlbnQgY2lyY3VsYXIgcmVmZXJlbmNlcykuCiAgICAjIEluZGl2aWR1YWwgbGlua3MgYXJlIGtlcHQgYWxpdmUgYnkgdGhlIGhhcmQgcmVmZXJlbmNlIGluIHNlbGYuX19tYXAuCiAgICAjIFRob3NlIGhhcmQgcmVmZXJlbmNlcyBkaXNhcHBlYXIgd2hlbiBhIGtleSBpcyBkZWxldGVkIGZyb20gYW4gT3JkZXJlZERpY3QuCgogICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3ZHMpOgogICAgICAgICcnJ0luaXRpYWxpemUgYW4gb3JkZXJlZCBkaWN0aW9uYXJ5LiAgVGhlIHNpZ25hdHVyZSBpcyB0aGUgc2FtZSBhcwogICAgICAgIHJlZ3VsYXIgZGljdGlvbmFyaWVzLCBidXQga2V5d29yZCBhcmd1bWVudHMgYXJlIG5vdCByZWNvbW1lbmRlZCBiZWNhdXNlCiAgICAgICAgdGhlaXIgaW5zZXJ0aW9uIG9yZGVyIGlzIGFyYml0cmFyeS4KCiAgICAgICAgJycnCiAgICAgICAgaWYgbGVuKGFyZ3MpID4gMToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdleHBlY3RlZCBhdCBtb3N0IDEgYXJndW1lbnRzLCBnb3QgJWQnICUgbGVuKGFyZ3MpKQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5fX3Jvb3QKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHNlbGYuX19oYXJkcm9vdCA9IF9MaW5rKCkKICAgICAgICAgICAgc2VsZi5fX3Jvb3QgPSByb290ID0gX3Byb3h5KHNlbGYuX19oYXJkcm9vdCkKICAgICAgICAgICAgcm9vdC5wcmV2ID0gcm9vdC5uZXh0ID0gcm9vdAogICAgICAgICAgICBzZWxmLl9fbWFwID0ge30KICAgICAgICBzZWxmLl9fdXBkYXRlKCphcmdzLCAqKmt3ZHMpCgogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIGtleSwgdmFsdWUsCiAgICAgICAgICAgICAgICAgICAgZGljdF9zZXRpdGVtPWRpY3QuX19zZXRpdGVtX18sIHByb3h5PV9wcm94eSwgTGluaz1fTGluayk6CiAgICAgICAgJ29kLl9fc2V0aXRlbV9fKGksIHkpIDw9PT4gb2RbaV09eScKICAgICAgICAjIFNldHRpbmcgYSBuZXcgaXRlbSBjcmVhdGVzIGEgbmV3IGxpbmsgYXQgdGhlIGVuZCBvZiB0aGUgbGlua2VkIGxpc3QsCiAgICAgICAgIyBhbmQgdGhlIGluaGVyaXRlZCBkaWN0aW9uYXJ5IGlzIHVwZGF0ZWQgd2l0aCB0aGUgbmV3IGtleS92YWx1ZSBwYWlyLgogICAgICAgIGlmIGtleSBub3QgaW4gc2VsZjoKICAgICAgICAgICAgc2VsZi5fX21hcFtrZXldID0gbGluayA9IExpbmsoKQogICAgICAgICAgICByb290ID0gc2VsZi5fX3Jvb3QKICAgICAgICAgICAgbGFzdCA9IHJvb3QucHJldgogICAgICAgICAgICBsaW5rLnByZXYsIGxpbmsubmV4dCwgbGluay5rZXkgPSBsYXN0LCByb290LCBrZXkKICAgICAgICAgICAgbGFzdC5uZXh0ID0gbGluawogICAgICAgICAgICByb290LnByZXYgPSBwcm94eShsaW5rKQogICAgICAgIGRpY3Rfc2V0aXRlbShzZWxmLCBrZXksIHZhbHVlKQoKICAgIGRlZiBfX2RlbGl0ZW1fXyhzZWxmLCBrZXksIGRpY3RfZGVsaXRlbT1kaWN0Ll9fZGVsaXRlbV9fKToKICAgICAgICAnb2QuX19kZWxpdGVtX18oeSkgPD09PiBkZWwgb2RbeV0nCiAgICAgICAgIyBEZWxldGluZyBhbiBleGlzdGluZyBpdGVtIHVzZXMgc2VsZi5fX21hcCB0byBmaW5kIHRoZSBsaW5rIHdoaWNoIGdldHMKICAgICAgICAjIHJlbW92ZWQgYnkgdXBkYXRpbmcgdGhlIGxpbmtzIGluIHRoZSBwcmVkZWNlc3NvciBhbmQgc3VjY2Vzc29yIG5vZGVzLgogICAgICAgIGRpY3RfZGVsaXRlbShzZWxmLCBrZXkpCiAgICAgICAgbGluayA9IHNlbGYuX19tYXAucG9wKGtleSkKICAgICAgICBsaW5rX3ByZXYgPSBsaW5rLnByZXYKICAgICAgICBsaW5rX25leHQgPSBsaW5rLm5leHQKICAgICAgICBsaW5rX3ByZXYubmV4dCA9IGxpbmtfbmV4dAogICAgICAgIGxpbmtfbmV4dC5wcmV2ID0gbGlua19wcmV2CgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgICdvZC5fX2l0ZXJfXygpIDw9PT4gaXRlcihvZCknCiAgICAgICAgIyBUcmF2ZXJzZSB0aGUgbGlua2VkIGxpc3QgaW4gb3JkZXIuCiAgICAgICAgcm9vdCA9IHNlbGYuX19yb290CiAgICAgICAgY3VyciA9IHJvb3QubmV4dAogICAgICAgIHdoaWxlIGN1cnIgaXMgbm90IHJvb3Q6CiAgICAgICAgICAgIHlpZWxkIGN1cnIua2V5CiAgICAgICAgICAgIGN1cnIgPSBjdXJyLm5leHQKCiAgICBkZWYgX19yZXZlcnNlZF9fKHNlbGYpOgogICAgICAgICdvZC5fX3JldmVyc2VkX18oKSA8PT0+IHJldmVyc2VkKG9kKScKICAgICAgICAjIFRyYXZlcnNlIHRoZSBsaW5rZWQgbGlzdCBpbiByZXZlcnNlIG9yZGVyLgogICAgICAgIHJvb3QgPSBzZWxmLl9fcm9vdAogICAgICAgIGN1cnIgPSByb290LnByZXYKICAgICAgICB3aGlsZSBjdXJyIGlzIG5vdCByb290OgogICAgICAgICAgICB5aWVsZCBjdXJyLmtleQogICAgICAgICAgICBjdXJyID0gY3Vyci5wcmV2CgogICAgZGVmIGNsZWFyKHNlbGYpOgogICAgICAgICdvZC5jbGVhcigpIC0+IE5vbmUuICBSZW1vdmUgYWxsIGl0ZW1zIGZyb20gb2QuJwogICAgICAgIHJvb3QgPSBzZWxmLl9fcm9vdAogICAgICAgIHJvb3QucHJldiA9IHJvb3QubmV4dCA9IHJvb3QKICAgICAgICBzZWxmLl9fbWFwLmNsZWFyKCkKICAgICAgICBkaWN0LmNsZWFyKHNlbGYpCgogICAgZGVmIHBvcGl0ZW0oc2VsZiwgbGFzdD1UcnVlKToKICAgICAgICAnJydvZC5wb3BpdGVtKCkgLT4gKGssIHYpLCByZXR1cm4gYW5kIHJlbW92ZSBhIChrZXksIHZhbHVlKSBwYWlyLgogICAgICAgIFBhaXJzIGFyZSByZXR1cm5lZCBpbiBMSUZPIG9yZGVyIGlmIGxhc3QgaXMgdHJ1ZSBvciBGSUZPIG9yZGVyIGlmIGZhbHNlLgoKICAgICAgICAnJycKICAgICAgICBpZiBub3Qgc2VsZjoKICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3IoJ2RpY3Rpb25hcnkgaXMgZW1wdHknKQogICAgICAgIHJvb3QgPSBzZWxmLl9fcm9vdAogICAgICAgIGlmIGxhc3Q6CiAgICAgICAgICAgIGxpbmsgPSByb290LnByZXYKICAgICAgICAgICAgbGlua19wcmV2ID0gbGluay5wcmV2CiAgICAgICAgICAgIGxpbmtfcHJldi5uZXh0ID0gcm9vdAogICAgICAgICAgICByb290LnByZXYgPSBsaW5rX3ByZXYKICAgICAgICBlbHNlOgogICAgICAgICAgICBsaW5rID0gcm9vdC5uZXh0CiAgICAgICAgICAgIGxpbmtfbmV4dCA9IGxpbmsubmV4dAogICAgICAgICAgICByb290Lm5leHQgPSBsaW5rX25leHQKICAgICAgICAgICAgbGlua19uZXh0LnByZXYgPSByb290CiAgICAgICAga2V5ID0gbGluay5rZXkKICAgICAgICBkZWwgc2VsZi5fX21hcFtrZXldCiAgICAgICAgdmFsdWUgPSBkaWN0LnBvcChzZWxmLCBrZXkpCiAgICAgICAgcmV0dXJuIGtleSwgdmFsdWUKCiAgICBkZWYgbW92ZV90b19lbmQoc2VsZiwga2V5LCBsYXN0PVRydWUpOgogICAgICAgICcnJ01vdmUgYW4gZXhpc3RpbmcgZWxlbWVudCB0byB0aGUgZW5kIChvciBiZWdpbm5pbmcgaWYgbGFzdD09RmFsc2UpLgoKICAgICAgICBSYWlzZXMgS2V5RXJyb3IgaWYgdGhlIGVsZW1lbnQgZG9lcyBub3QgZXhpc3QuCiAgICAgICAgV2hlbiBsYXN0PVRydWUsIGFjdHMgbGlrZSBhIGZhc3QgdmVyc2lvbiBvZiBzZWxmW2tleV09c2VsZi5wb3Aoa2V5KS4KCiAgICAgICAgJycnCiAgICAgICAgbGluayA9IHNlbGYuX19tYXBba2V5XQogICAgICAgIGxpbmtfcHJldiA9IGxpbmsucHJldgogICAgICAgIGxpbmtfbmV4dCA9IGxpbmsubmV4dAogICAgICAgIGxpbmtfcHJldi5uZXh0ID0gbGlua19uZXh0CiAgICAgICAgbGlua19uZXh0LnByZXYgPSBsaW5rX3ByZXYKICAgICAgICByb290ID0gc2VsZi5fX3Jvb3QKICAgICAgICBpZiBsYXN0OgogICAgICAgICAgICBsYXN0ID0gcm9vdC5wcmV2CiAgICAgICAgICAgIGxpbmsucHJldiA9IGxhc3QKICAgICAgICAgICAgbGluay5uZXh0ID0gcm9vdAogICAgICAgICAgICBsYXN0Lm5leHQgPSByb290LnByZXYgPSBsaW5rCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZmlyc3QgPSByb290Lm5leHQKICAgICAgICAgICAgbGluay5wcmV2ID0gcm9vdAogICAgICAgICAgICBsaW5rLm5leHQgPSBmaXJzdAogICAgICAgICAgICByb290Lm5leHQgPSBmaXJzdC5wcmV2ID0gbGluawoKICAgIGRlZiBfX3NpemVvZl9fKHNlbGYpOgogICAgICAgIHNpemVvZiA9IF9zeXMuZ2V0c2l6ZW9mCiAgICAgICAgbiA9IGxlbihzZWxmKSArIDEgICAgICAgICAgICAgICAgICAgICAgICMgbnVtYmVyIG9mIGxpbmtzIGluY2x1ZGluZyByb290CiAgICAgICAgc2l6ZSA9IHNpemVvZihzZWxmLl9fZGljdF9fKSAgICAgICAgICAgICMgaW5zdGFuY2UgZGljdGlvbmFyeQogICAgICAgIHNpemUgKz0gc2l6ZW9mKHNlbGYuX19tYXApICogMiAgICAgICAgICAjIGludGVybmFsIGRpY3QgYW5kIGluaGVyaXRlZCBkaWN0CiAgICAgICAgc2l6ZSArPSBzaXplb2Yoc2VsZi5fX2hhcmRyb290KSAqIG4gICAgICMgbGluayBvYmplY3RzCiAgICAgICAgc2l6ZSArPSBzaXplb2Yoc2VsZi5fX3Jvb3QpICogbiAgICAgICAgICMgcHJveHkgb2JqZWN0cwogICAgICAgIHJldHVybiBzaXplCgogICAgI2ZpeG1lIGJyeXRob24uLiAgSXNzdWUgd2l0aCBfYWJjb2xsLCB3aGljaCBjb250YWlucyBNdXRhYmxlTWFwcGluZwogICAgdXBkYXRlID0gX191cGRhdGUgPSBNdXRhYmxlTWFwcGluZy51cGRhdGUKICAgIGtleXMgPSBNdXRhYmxlTWFwcGluZy5rZXlzCiAgICB2YWx1ZXMgPSBNdXRhYmxlTWFwcGluZy52YWx1ZXMKICAgIGl0ZW1zID0gTXV0YWJsZU1hcHBpbmcuaXRlbXMKICAgIF9fbmVfXyA9IE11dGFibGVNYXBwaW5nLl9fbmVfXwoKICAgIF9fbWFya2VyID0gb2JqZWN0KCkKCiAgICBkZWYgcG9wKHNlbGYsIGtleSwgZGVmYXVsdD1fX21hcmtlcik6CiAgICAgICAgJycnb2QucG9wKGtbLGRdKSAtPiB2LCByZW1vdmUgc3BlY2lmaWVkIGtleSBhbmQgcmV0dXJuIHRoZSBjb3JyZXNwb25kaW5nCiAgICAgICAgdmFsdWUuICBJZiBrZXkgaXMgbm90IGZvdW5kLCBkIGlzIHJldHVybmVkIGlmIGdpdmVuLCBvdGhlcndpc2UgS2V5RXJyb3IKICAgICAgICBpcyByYWlzZWQuCgogICAgICAgICcnJwogICAgICAgIGlmIGtleSBpbiBzZWxmOgogICAgICAgICAgICByZXN1bHQgPSBzZWxmW2tleV0KICAgICAgICAgICAgZGVsIHNlbGZba2V5XQogICAgICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgaWYgZGVmYXVsdCBpcyBzZWxmLl9fbWFya2VyOgogICAgICAgICAgICByYWlzZSBLZXlFcnJvcihrZXkpCiAgICAgICAgcmV0dXJuIGRlZmF1bHQKCiAgICBkZWYgc2V0ZGVmYXVsdChzZWxmLCBrZXksIGRlZmF1bHQ9Tm9uZSk6CiAgICAgICAgJ29kLnNldGRlZmF1bHQoa1ssZF0pIC0+IG9kLmdldChrLGQpLCBhbHNvIHNldCBvZFtrXT1kIGlmIGsgbm90IGluIG9kJwogICAgICAgIGlmIGtleSBpbiBzZWxmOgogICAgICAgICAgICByZXR1cm4gc2VsZltrZXldCiAgICAgICAgc2VsZltrZXldID0gZGVmYXVsdAogICAgICAgIHJldHVybiBkZWZhdWx0CgogICAgI2ZpeG1lLCBicnl0aG9uIGlzc3VlCiAgICAjQF9yZWN1cnNpdmVfcmVwcigpCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgJ29kLl9fcmVwcl9fKCkgPD09PiByZXByKG9kKScKICAgICAgICBpZiBub3Qgc2VsZjoKICAgICAgICAgICAgcmV0dXJuICclcygpJyAlIChzZWxmLl9fY2xhc3NfXy5fX25hbWVfXywpCiAgICAgICAgcmV0dXJuICclcyglciknICUgKHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLCBsaXN0KHNlbGYuaXRlbXMoKSkpCgogICAgZGVmIF9fcmVkdWNlX18oc2VsZik6CiAgICAgICAgJ1JldHVybiBzdGF0ZSBpbmZvcm1hdGlvbiBmb3IgcGlja2xpbmcnCiAgICAgICAgaXRlbXMgPSBbW2ssIHNlbGZba11dIGZvciBrIGluIHNlbGZdCiAgICAgICAgaW5zdF9kaWN0ID0gdmFycyhzZWxmKS5jb3B5KCkKICAgICAgICBmb3IgayBpbiB2YXJzKE9yZGVyZWREaWN0KCkpOgogICAgICAgICAgICBpbnN0X2RpY3QucG9wKGssIE5vbmUpCiAgICAgICAgaWYgaW5zdF9kaWN0OgogICAgICAgICAgICByZXR1cm4gKHNlbGYuX19jbGFzc19fLCAoaXRlbXMsKSwgaW5zdF9kaWN0KQogICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXywgKGl0ZW1zLCkKCiAgICBkZWYgY29weShzZWxmKToKICAgICAgICAnb2QuY29weSgpIC0+IGEgc2hhbGxvdyBjb3B5IG9mIG9kJwogICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmKQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIGZyb21rZXlzKGNscywgaXRlcmFibGUsIHZhbHVlPU5vbmUpOgogICAgICAgICcnJ09ELmZyb21rZXlzKFNbLCB2XSkgLT4gTmV3IG9yZGVyZWQgZGljdGlvbmFyeSB3aXRoIGtleXMgZnJvbSBTLgogICAgICAgIElmIG5vdCBzcGVjaWZpZWQsIHRoZSB2YWx1ZSBkZWZhdWx0cyB0byBOb25lLgoKICAgICAgICAnJycKICAgICAgICBzZWxmID0gY2xzKCkKICAgICAgICBmb3Iga2V5IGluIGl0ZXJhYmxlOgogICAgICAgICAgICBzZWxmW2tleV0gPSB2YWx1ZQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fZXFfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgJycnb2QuX19lcV9fKHkpIDw9PT4gb2Q9PXkuICBDb21wYXJpc29uIHRvIGFub3RoZXIgT0QgaXMgb3JkZXItc2Vuc2l0aXZlCiAgICAgICAgd2hpbGUgY29tcGFyaXNvbiB0byBhIHJlZ3VsYXIgbWFwcGluZyBpcyBvcmRlci1pbnNlbnNpdGl2ZS4KCiAgICAgICAgJycnCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgT3JkZXJlZERpY3QpOgogICAgICAgICAgICByZXR1cm4gbGVuKHNlbGYpPT1sZW4ob3RoZXIpIGFuZCBcCiAgICAgICAgICAgICAgICAgICBhbGwocD09cSBmb3IgcCwgcSBpbiB6aXAoc2VsZi5pdGVtcygpLCBvdGhlci5pdGVtcygpKSkKICAgICAgICByZXR1cm4gZGljdC5fX2VxX18oc2VsZiwgb3RoZXIpCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIyAgQ291bnRlcgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCgpkZWYgX2NvdW50X2VsZW1lbnRzKG1hcHBpbmcsIGl0ZXJhYmxlKToKICAgICdUYWxseSBlbGVtZW50cyBmcm9tIHRoZSBpdGVyYWJsZS4nCiAgICBtYXBwaW5nX2dldCA9IG1hcHBpbmcuZ2V0CiAgICBmb3IgZWxlbSBpbiBpdGVyYWJsZToKICAgICAgICBtYXBwaW5nW2VsZW1dID0gbWFwcGluZ19nZXQoZWxlbSwgMCkgKyAxCgojdHJ5OiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgTG9hZCBDIGhlbHBlciBmdW5jdGlvbiBpZiBhdmFpbGFibGUKIyAgICBmcm9tIF9jb2xsZWN0aW9ucyBpbXBvcnQgX2NvdW50X2VsZW1lbnRzCiNleGNlcHQgSW1wb3J0RXJyb3I6CiMgICAgcGFzcwoKY2xhc3MgQ291bnRlcihkaWN0KToKICAgICcnJ0RpY3Qgc3ViY2xhc3MgZm9yIGNvdW50aW5nIGhhc2hhYmxlIGl0ZW1zLiAgU29tZXRpbWVzIGNhbGxlZCBhIGJhZwogICAgb3IgbXVsdGlzZXQuICBFbGVtZW50cyBhcmUgc3RvcmVkIGFzIGRpY3Rpb25hcnkga2V5cyBhbmQgdGhlaXIgY291bnRzCiAgICBhcmUgc3RvcmVkIGFzIGRpY3Rpb25hcnkgdmFsdWVzLgoKICAgID4+PiBjID0gQ291bnRlcignYWJjZGVhYmNkYWJjYWJhJykgICMgY291bnQgZWxlbWVudHMgZnJvbSBhIHN0cmluZwoKICAgID4+PiBjLm1vc3RfY29tbW9uKDMpICAgICAgICAgICAgICAgICMgdGhyZWUgbW9zdCBjb21tb24gZWxlbWVudHMKICAgIFsoJ2EnLCA1KSwgKCdiJywgNCksICgnYycsIDMpXQogICAgPj4+IHNvcnRlZChjKSAgICAgICAgICAgICAgICAgICAgICAgIyBsaXN0IGFsbCB1bmlxdWUgZWxlbWVudHMKICAgIFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ10KICAgID4+PiAnJy5qb2luKHNvcnRlZChjLmVsZW1lbnRzKCkpKSAgICMgbGlzdCBlbGVtZW50cyB3aXRoIHJlcGV0aXRpb25zCiAgICAnYWFhYWFiYmJiY2NjZGRlJwogICAgPj4+IHN1bShjLnZhbHVlcygpKSAgICAgICAgICAgICAgICAgIyB0b3RhbCBvZiBhbGwgY291bnRzCiAgICAxNQoKICAgID4+PiBjWydhJ10gICAgICAgICAgICAgICAgICAgICAgICAgICMgY291bnQgb2YgbGV0dGVyICdhJwogICAgNQogICAgPj4+IGZvciBlbGVtIGluICdzaGF6YW0nOiAgICAgICAgICAgIyB1cGRhdGUgY291bnRzIGZyb20gYW4gaXRlcmFibGUKICAgIC4uLiAgICAgY1tlbGVtXSArPSAxICAgICAgICAgICAgICAgICMgYnkgYWRkaW5nIDEgdG8gZWFjaCBlbGVtZW50J3MgY291bnQKICAgID4+PiBjWydhJ10gICAgICAgICAgICAgICAgICAgICAgICAgICMgbm93IHRoZXJlIGFyZSBzZXZlbiAnYScKICAgIDcKICAgID4+PiBkZWwgY1snYiddICAgICAgICAgICAgICAgICAgICAgICMgcmVtb3ZlIGFsbCAnYicKICAgID4+PiBjWydiJ10gICAgICAgICAgICAgICAgICAgICAgICAgICMgbm93IHRoZXJlIGFyZSB6ZXJvICdiJwogICAgMAoKICAgID4+PiBkID0gQ291bnRlcignc2ltc2FsYWJpbScpICAgICAgICMgbWFrZSBhbm90aGVyIGNvdW50ZXIKICAgID4+PiBjLnVwZGF0ZShkKSAgICAgICAgICAgICAgICAgICAgICMgYWRkIGluIHRoZSBzZWNvbmQgY291bnRlcgogICAgPj4+IGNbJ2EnXSAgICAgICAgICAgICAgICAgICAgICAgICAgIyBub3cgdGhlcmUgYXJlIG5pbmUgJ2EnCiAgICA5CgogICAgPj4+IGMuY2xlYXIoKSAgICAgICAgICAgICAgICAgICAgICAgIyBlbXB0eSB0aGUgY291bnRlcgogICAgPj4+IGMKICAgIENvdW50ZXIoKQoKICAgIE5vdGU6ICBJZiBhIGNvdW50IGlzIHNldCB0byB6ZXJvIG9yIHJlZHVjZWQgdG8gemVybywgaXQgd2lsbCByZW1haW4KICAgIGluIHRoZSBjb3VudGVyIHVudGlsIHRoZSBlbnRyeSBpcyBkZWxldGVkIG9yIHRoZSBjb3VudGVyIGlzIGNsZWFyZWQ6CgogICAgPj4+IGMgPSBDb3VudGVyKCdhYWFiYmMnKQogICAgPj4+IGNbJ2InXSAtPSAyICAgICAgICAgICAgICAgICAgICAgIyByZWR1Y2UgdGhlIGNvdW50IG9mICdiJyBieSB0d28KICAgID4+PiBjLm1vc3RfY29tbW9uKCkgICAgICAgICAgICAgICAgICMgJ2InIGlzIHN0aWxsIGluLCBidXQgaXRzIGNvdW50IGlzIHplcm8KICAgIFsoJ2EnLCAzKSwgKCdjJywgMSksICgnYicsIDApXQoKICAgICcnJwogICAgIyBSZWZlcmVuY2VzOgogICAgIyAgIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTXVsdGlzZXQKICAgICMgICBodHRwOi8vd3d3LmdudS5vcmcvc29mdHdhcmUvc21hbGx0YWxrL21hbnVhbC1iYXNlL2h0bWxfbm9kZS9CYWcuaHRtbAogICAgIyAgIGh0dHA6Ly93d3cuZGVtbzJzLmNvbS9UdXRvcmlhbC9DcHAvMDM4MF9fc2V0LW11bHRpc2V0L0NhdGFsb2cwMzgwX19zZXQtbXVsdGlzZXQuaHRtCiAgICAjICAgaHR0cDovL2NvZGUuYWN0aXZlc3RhdGUuY29tL3JlY2lwZXMvMjU5MTc0LwogICAgIyAgIEtudXRoLCBUQU9DUCBWb2wuIElJIHNlY3Rpb24gNC42LjMKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaXRlcmFibGU9Tm9uZSwgKiprd2RzKToKICAgICAgICAnJydDcmVhdGUgYSBuZXcsIGVtcHR5IENvdW50ZXIgb2JqZWN0LiAgQW5kIGlmIGdpdmVuLCBjb3VudCBlbGVtZW50cwogICAgICAgIGZyb20gYW4gaW5wdXQgaXRlcmFibGUuICBPciwgaW5pdGlhbGl6ZSB0aGUgY291bnQgZnJvbSBhbm90aGVyIG1hcHBpbmcKICAgICAgICBvZiBlbGVtZW50cyB0byB0aGVpciBjb3VudHMuCgogICAgICAgID4+PiBjID0gQ291bnRlcigpICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBhIG5ldywgZW1wdHkgY291bnRlcgogICAgICAgID4+PiBjID0gQ291bnRlcignZ2FsbGFoYWQnKSAgICAgICAgICAgICAgICAgIyBhIG5ldyBjb3VudGVyIGZyb20gYW4gaXRlcmFibGUKICAgICAgICA+Pj4gYyA9IENvdW50ZXIoeydhJzogNCwgJ2InOiAyfSkgICAgICAgICAgICMgYSBuZXcgY291bnRlciBmcm9tIGEgbWFwcGluZwogICAgICAgID4+PiBjID0gQ291bnRlcihhPTQsIGI9MikgICAgICAgICAgICAgICAgICAgIyBhIG5ldyBjb3VudGVyIGZyb20ga2V5d29yZCBhcmdzCgogICAgICAgICcnJwogICAgICAgICNzdXBlcigpLl9faW5pdF9fKCkgICNCRSBtb2RpZmllZCBzaW5jZSBzdXBlciBub3Qgc3VwcG9ydGVkCiAgICAgICAgZGljdC5fX2luaXRfXyhzZWxmKQogICAgICAgIHNlbGYudXBkYXRlKGl0ZXJhYmxlLCAqKmt3ZHMpCgogICAgZGVmIF9fbWlzc2luZ19fKHNlbGYsIGtleSk6CiAgICAgICAgJ1RoZSBjb3VudCBvZiBlbGVtZW50cyBub3QgaW4gdGhlIENvdW50ZXIgaXMgemVyby4nCiAgICAgICAgIyBOZWVkZWQgc28gdGhhdCBzZWxmW21pc3NpbmdfaXRlbV0gZG9lcyBub3QgcmFpc2UgS2V5RXJyb3IKICAgICAgICByZXR1cm4gMAoKICAgIGRlZiBtb3N0X2NvbW1vbihzZWxmLCBuPU5vbmUpOgogICAgICAgICcnJ0xpc3QgdGhlIG4gbW9zdCBjb21tb24gZWxlbWVudHMgYW5kIHRoZWlyIGNvdW50cyBmcm9tIHRoZSBtb3N0CiAgICAgICAgY29tbW9uIHRvIHRoZSBsZWFzdC4gIElmIG4gaXMgTm9uZSwgdGhlbiBsaXN0IGFsbCBlbGVtZW50IGNvdW50cy4KCiAgICAgICAgPj4+IENvdW50ZXIoJ2FiY2RlYWJjZGFiY2FiYScpLm1vc3RfY29tbW9uKDMpCiAgICAgICAgWygnYScsIDUpLCAoJ2InLCA0KSwgKCdjJywgMyldCgogICAgICAgICcnJwogICAgICAgICMgRW11bGF0ZSBCYWcuc29ydGVkQnlDb3VudCBmcm9tIFNtYWxsdGFsawogICAgICAgIGlmIG4gaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIHNvcnRlZChzZWxmLml0ZW1zKCksIGtleT1faXRlbWdldHRlcigxKSwgcmV2ZXJzZT1UcnVlKQogICAgICAgIHJldHVybiBfaGVhcHEubmxhcmdlc3Qobiwgc2VsZi5pdGVtcygpLCBrZXk9X2l0ZW1nZXR0ZXIoMSkpCgogICAgZGVmIGVsZW1lbnRzKHNlbGYpOgogICAgICAgICcnJ0l0ZXJhdG9yIG92ZXIgZWxlbWVudHMgcmVwZWF0aW5nIGVhY2ggYXMgbWFueSB0aW1lcyBhcyBpdHMgY291bnQuCgogICAgICAgID4+PiBjID0gQ291bnRlcignQUJDQUJDJykKICAgICAgICA+Pj4gc29ydGVkKGMuZWxlbWVudHMoKSkKICAgICAgICBbJ0EnLCAnQScsICdCJywgJ0InLCAnQycsICdDJ10KCiAgICAgICAgIyBLbnV0aCdzIGV4YW1wbGUgZm9yIHByaW1lIGZhY3RvcnMgb2YgMTgzNjogIDIqKjIgKiAzKiozICogMTcqKjEKICAgICAgICA+Pj4gcHJpbWVfZmFjdG9ycyA9IENvdW50ZXIoezI6IDIsIDM6IDMsIDE3OiAxfSkKICAgICAgICA+Pj4gcHJvZHVjdCA9IDEKICAgICAgICA+Pj4gZm9yIGZhY3RvciBpbiBwcmltZV9mYWN0b3JzLmVsZW1lbnRzKCk6ICAgICAjIGxvb3Agb3ZlciBmYWN0b3JzCiAgICAgICAgLi4uICAgICBwcm9kdWN0ICo9IGZhY3RvciAgICAgICAgICAgICAgICAgICAgICAgIyBhbmQgbXVsdGlwbHkgdGhlbQogICAgICAgID4+PiBwcm9kdWN0CiAgICAgICAgMTgzNgoKICAgICAgICBOb3RlLCBpZiBhbiBlbGVtZW50J3MgY291bnQgaGFzIGJlZW4gc2V0IHRvIHplcm8gb3IgaXMgYSBuZWdhdGl2ZQogICAgICAgIG51bWJlciwgZWxlbWVudHMoKSB3aWxsIGlnbm9yZSBpdC4KCiAgICAgICAgJycnCiAgICAgICAgIyBFbXVsYXRlIEJhZy5kbyBmcm9tIFNtYWxsdGFsayBhbmQgTXVsdGlzZXQuYmVnaW4gZnJvbSBDKysuCiAgICAgICAgcmV0dXJuIF9jaGFpbi5mcm9tX2l0ZXJhYmxlKF9zdGFybWFwKF9yZXBlYXQsIHNlbGYuaXRlbXMoKSkpCgogICAgIyBPdmVycmlkZSBkaWN0IG1ldGhvZHMgd2hlcmUgbmVjZXNzYXJ5CgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbWtleXMoY2xzLCBpdGVyYWJsZSwgdj1Ob25lKToKICAgICAgICAjIFRoZXJlIGlzIG5vIGVxdWl2YWxlbnQgbWV0aG9kIGZvciBjb3VudGVycyBiZWNhdXNlIHNldHRpbmcgdj0xCiAgICAgICAgIyBtZWFucyB0aGF0IG5vIGVsZW1lbnQgY2FuIGhhdmUgYSBjb3VudCBncmVhdGVyIHRoYW4gb25lLgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoCiAgICAgICAgICAgICdDb3VudGVyLmZyb21rZXlzKCkgaXMgdW5kZWZpbmVkLiAgVXNlIENvdW50ZXIoaXRlcmFibGUpIGluc3RlYWQuJykKCiAgICBkZWYgdXBkYXRlKHNlbGYsIGl0ZXJhYmxlPU5vbmUsICoqa3dkcyk6CiAgICAgICAgJycnTGlrZSBkaWN0LnVwZGF0ZSgpIGJ1dCBhZGQgY291bnRzIGluc3RlYWQgb2YgcmVwbGFjaW5nIHRoZW0uCgogICAgICAgIFNvdXJjZSBjYW4gYmUgYW4gaXRlcmFibGUsIGEgZGljdGlvbmFyeSwgb3IgYW5vdGhlciBDb3VudGVyIGluc3RhbmNlLgoKICAgICAgICA+Pj4gYyA9IENvdW50ZXIoJ3doaWNoJykKICAgICAgICA+Pj4gYy51cGRhdGUoJ3dpdGNoJykgICAgICAgICAgICMgYWRkIGVsZW1lbnRzIGZyb20gYW5vdGhlciBpdGVyYWJsZQogICAgICAgID4+PiBkID0gQ291bnRlcignd2F0Y2gnKQogICAgICAgID4+PiBjLnVwZGF0ZShkKSAgICAgICAgICAgICAgICAgIyBhZGQgZWxlbWVudHMgZnJvbSBhbm90aGVyIGNvdW50ZXIKICAgICAgICA+Pj4gY1snaCddICAgICAgICAgICAgICAgICAgICAgICMgZm91ciAnaCcgaW4gd2hpY2gsIHdpdGNoLCBhbmQgd2F0Y2gKICAgICAgICA0CgogICAgICAgICcnJwogICAgICAgICMgVGhlIHJlZ3VsYXIgZGljdC51cGRhdGUoKSBvcGVyYXRpb24gbWFrZXMgbm8gc2Vuc2UgaGVyZSBiZWNhdXNlIHRoZQogICAgICAgICMgcmVwbGFjZSBiZWhhdmlvciByZXN1bHRzIGluIHRoZSBzb21lIG9mIG9yaWdpbmFsIHVudG91Y2hlZCBjb3VudHMKICAgICAgICAjIGJlaW5nIG1peGVkLWluIHdpdGggYWxsIG9mIHRoZSBvdGhlciBjb3VudHMgZm9yIGEgbWlzbWFzaCB0aGF0CiAgICAgICAgIyBkb2Vzbid0IGhhdmUgYSBzdHJhaWdodC1mb3J3YXJkIGludGVycHJldGF0aW9uIGluIG1vc3QgY291bnRpbmcKICAgICAgICAjIGNvbnRleHRzLiAgSW5zdGVhZCwgd2UgaW1wbGVtZW50IHN0cmFpZ2h0LWFkZGl0aW9uLiAgQm90aCB0aGUgaW5wdXRzCiAgICAgICAgIyBhbmQgb3V0cHV0cyBhcmUgYWxsb3dlZCB0byBjb250YWluIHplcm8gYW5kIG5lZ2F0aXZlIGNvdW50cy4KCiAgICAgICAgaWYgaXRlcmFibGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoaXRlcmFibGUsIE1hcHBpbmcpOgogICAgICAgICAgICAgICAgaWYgc2VsZjoKICAgICAgICAgICAgICAgICAgICBzZWxmX2dldCA9IHNlbGYuZ2V0CiAgICAgICAgICAgICAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIGl0ZXJhYmxlLml0ZW1zKCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGZbZWxlbV0gPSBjb3VudCArIHNlbGZfZ2V0KGVsZW0sIDApCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHN1cGVyKCkudXBkYXRlKGl0ZXJhYmxlKSAjIGZhc3QgcGF0aCB3aGVuIGNvdW50ZXIgaXMgZW1wdHkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIF9jb3VudF9lbGVtZW50cyhzZWxmLCBpdGVyYWJsZSkKICAgICAgICBpZiBrd2RzOgogICAgICAgICAgICBzZWxmLnVwZGF0ZShrd2RzKQoKICAgIGRlZiBzdWJ0cmFjdChzZWxmLCBpdGVyYWJsZT1Ob25lLCAqKmt3ZHMpOgogICAgICAgICcnJ0xpa2UgZGljdC51cGRhdGUoKSBidXQgc3VidHJhY3RzIGNvdW50cyBpbnN0ZWFkIG9mIHJlcGxhY2luZyB0aGVtLgogICAgICAgIENvdW50cyBjYW4gYmUgcmVkdWNlZCBiZWxvdyB6ZXJvLiAgQm90aCB0aGUgaW5wdXRzIGFuZCBvdXRwdXRzIGFyZQogICAgICAgIGFsbG93ZWQgdG8gY29udGFpbiB6ZXJvIGFuZCBuZWdhdGl2ZSBjb3VudHMuCgogICAgICAgIFNvdXJjZSBjYW4gYmUgYW4gaXRlcmFibGUsIGEgZGljdGlvbmFyeSwgb3IgYW5vdGhlciBDb3VudGVyIGluc3RhbmNlLgoKICAgICAgICA+Pj4gYyA9IENvdW50ZXIoJ3doaWNoJykKICAgICAgICA+Pj4gYy5zdWJ0cmFjdCgnd2l0Y2gnKSAgICAgICAgICAgICAjIHN1YnRyYWN0IGVsZW1lbnRzIGZyb20gYW5vdGhlciBpdGVyYWJsZQogICAgICAgID4+PiBjLnN1YnRyYWN0KENvdW50ZXIoJ3dhdGNoJykpICAgICMgc3VidHJhY3QgZWxlbWVudHMgZnJvbSBhbm90aGVyIGNvdW50ZXIKICAgICAgICA+Pj4gY1snaCddICAgICAgICAgICAgICAgICAgICAgICAgICAjIDIgaW4gd2hpY2gsIG1pbnVzIDEgaW4gd2l0Y2gsIG1pbnVzIDEgaW4gd2F0Y2gKICAgICAgICAwCiAgICAgICAgPj4+IGNbJ3cnXSAgICAgICAgICAgICAgICAgICAgICAgICAgIyAxIGluIHdoaWNoLCBtaW51cyAxIGluIHdpdGNoLCBtaW51cyAxIGluIHdhdGNoCiAgICAgICAgLTEKCiAgICAgICAgJycnCiAgICAgICAgaWYgaXRlcmFibGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHNlbGZfZ2V0ID0gc2VsZi5nZXQKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShpdGVyYWJsZSwgTWFwcGluZyk6CiAgICAgICAgICAgICAgICBmb3IgZWxlbSwgY291bnQgaW4gaXRlcmFibGUuaXRlbXMoKToKICAgICAgICAgICAgICAgICAgICBzZWxmW2VsZW1dID0gc2VsZl9nZXQoZWxlbSwgMCkgLSBjb3VudAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZm9yIGVsZW0gaW4gaXRlcmFibGU6CiAgICAgICAgICAgICAgICAgICAgc2VsZltlbGVtXSA9IHNlbGZfZ2V0KGVsZW0sIDApIC0gMQogICAgICAgIGlmIGt3ZHM6CiAgICAgICAgICAgIHNlbGYuc3VidHJhY3Qoa3dkcykKCiAgICBkZWYgY29weShzZWxmKToKICAgICAgICAnUmV0dXJuIGEgc2hhbGxvdyBjb3B5LicKICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oc2VsZikKCiAgICBkZWYgX19yZWR1Y2VfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18sIChkaWN0KHNlbGYpLCkKCiAgICBkZWYgX19kZWxpdGVtX18oc2VsZiwgZWxlbSk6CiAgICAgICAgJ0xpa2UgZGljdC5fX2RlbGl0ZW1fXygpIGJ1dCBkb2VzIG5vdCByYWlzZSBLZXlFcnJvciBmb3IgbWlzc2luZyB2YWx1ZXMuJwogICAgICAgIGlmIGVsZW0gaW4gc2VsZjoKICAgICAgICAgICAgc3VwZXIoKS5fX2RlbGl0ZW1fXyhlbGVtKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICBpZiBub3Qgc2VsZjoKICAgICAgICAgICAgcmV0dXJuICclcygpJyAlIHNlbGYuX19jbGFzc19fLl9fbmFtZV9fCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpdGVtcyA9ICcsICcuam9pbihtYXAoJyVyOiAlcicuX19tb2RfXywgc2VsZi5tb3N0X2NvbW1vbigpKSkKICAgICAgICAgICAgcmV0dXJuICclcyh7JXN9KScgJSAoc2VsZi5fX2NsYXNzX18uX19uYW1lX18sIGl0ZW1zKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgICAgICMgaGFuZGxlIGNhc2Ugd2hlcmUgdmFsdWVzIGFyZSBub3Qgb3JkZXJhYmxlCiAgICAgICAgICAgIHJldHVybiAnezB9KHsxIXJ9KScuZm9ybWF0KHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLCBkaWN0KHNlbGYpKQoKICAgICMgTXVsdGlzZXQtc3R5bGUgbWF0aGVtYXRpY2FsIG9wZXJhdGlvbnMgZGlzY3Vzc2VkIGluOgogICAgIyAgICAgICBLbnV0aCBUQU9DUCBWb2x1bWUgSUkgc2VjdGlvbiA0LjYuMyBleGVyY2lzZSAxOQogICAgIyAgICAgICBhbmQgYXQgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9NdWx0aXNldAogICAgIwogICAgIyBPdXRwdXRzIGd1YXJhbnRlZWQgdG8gb25seSBpbmNsdWRlIHBvc2l0aXZlIGNvdW50cy4KICAgICMKICAgICMgVG8gc3RyaXAgbmVnYXRpdmUgYW5kIHplcm8gY291bnRzLCBhZGQtaW4gYW4gZW1wdHkgY291bnRlcjoKICAgICMgICAgICAgYyArPSBDb3VudGVyKCkKCiAgICBkZWYgX19hZGRfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgJycnQWRkIGNvdW50cyBmcm9tIHR3byBjb3VudGVycy4KCiAgICAgICAgPj4+IENvdW50ZXIoJ2FiYmInKSArIENvdW50ZXIoJ2JjYycpCiAgICAgICAgQ291bnRlcih7J2InOiA0LCAnYyc6IDIsICdhJzogMX0pCgogICAgICAgICcnJwogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBDb3VudGVyKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgcmVzdWx0ID0gQ291bnRlcigpCiAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIHNlbGYuaXRlbXMoKToKICAgICAgICAgICAgbmV3Y291bnQgPSBjb3VudCArIG90aGVyW2VsZW1dCiAgICAgICAgICAgIGlmIG5ld2NvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IG5ld2NvdW50CiAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIG90aGVyLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIGVsZW0gbm90IGluIHNlbGYgYW5kIGNvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IGNvdW50CiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBfX3N1Yl9fKHNlbGYsIG90aGVyKToKICAgICAgICAnJycgU3VidHJhY3QgY291bnQsIGJ1dCBrZWVwIG9ubHkgcmVzdWx0cyB3aXRoIHBvc2l0aXZlIGNvdW50cy4KCiAgICAgICAgPj4+IENvdW50ZXIoJ2FiYmJjJykgLSBDb3VudGVyKCdiY2NkJykKICAgICAgICBDb3VudGVyKHsnYic6IDIsICdhJzogMX0pCgogICAgICAgICcnJwogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBDb3VudGVyKToKICAgICAgICAgICAgcmV0dXJuIE5vdEltcGxlbWVudGVkCiAgICAgICAgcmVzdWx0ID0gQ291bnRlcigpCiAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIHNlbGYuaXRlbXMoKToKICAgICAgICAgICAgbmV3Y291bnQgPSBjb3VudCAtIG90aGVyW2VsZW1dCiAgICAgICAgICAgIGlmIG5ld2NvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IG5ld2NvdW50CiAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIG90aGVyLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIGVsZW0gbm90IGluIHNlbGYgYW5kIGNvdW50IDwgMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IDAgLSBjb3VudAogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgX19vcl9fKHNlbGYsIG90aGVyKToKICAgICAgICAnJydVbmlvbiBpcyB0aGUgbWF4aW11bSBvZiB2YWx1ZSBpbiBlaXRoZXIgb2YgdGhlIGlucHV0IGNvdW50ZXJzLgoKICAgICAgICA+Pj4gQ291bnRlcignYWJiYicpIHwgQ291bnRlcignYmNjJykKICAgICAgICBDb3VudGVyKHsnYic6IDMsICdjJzogMiwgJ2EnOiAxfSkKCiAgICAgICAgJycnCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIENvdW50ZXIpOgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKICAgICAgICByZXN1bHQgPSBDb3VudGVyKCkKICAgICAgICBmb3IgZWxlbSwgY291bnQgaW4gc2VsZi5pdGVtcygpOgogICAgICAgICAgICBvdGhlcl9jb3VudCA9IG90aGVyW2VsZW1dCiAgICAgICAgICAgIG5ld2NvdW50ID0gb3RoZXJfY291bnQgaWYgY291bnQgPCBvdGhlcl9jb3VudCBlbHNlIGNvdW50CiAgICAgICAgICAgIGlmIG5ld2NvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IG5ld2NvdW50CiAgICAgICAgZm9yIGVsZW0sIGNvdW50IGluIG90aGVyLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIGVsZW0gbm90IGluIHNlbGYgYW5kIGNvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IGNvdW50CiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBfX2FuZF9fKHNlbGYsIG90aGVyKToKICAgICAgICAnJycgSW50ZXJzZWN0aW9uIGlzIHRoZSBtaW5pbXVtIG9mIGNvcnJlc3BvbmRpbmcgY291bnRzLgogICAgCiAgICAgICAgPj4+IENvdW50ZXIoJ2FiYmInKSAmIENvdW50ZXIoJ2JjYycpCiAgICAgICAgQ291bnRlcih7J2InOiAxfSkKCiAgICAgICAgJycnCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIENvdW50ZXIpOgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKICAgICAgICByZXN1bHQgPSBDb3VudGVyKCkKICAgICAgICBmb3IgZWxlbSwgY291bnQgaW4gc2VsZi5pdGVtcygpOgogICAgICAgICAgICBvdGhlcl9jb3VudCA9IG90aGVyW2VsZW1dCiAgICAgICAgICAgIG5ld2NvdW50ID0gY291bnQgaWYgY291bnQgPCBvdGhlcl9jb3VudCBlbHNlIG90aGVyX2NvdW50CiAgICAgICAgICAgIGlmIG5ld2NvdW50ID4gMDoKICAgICAgICAgICAgICAgIHJlc3VsdFtlbGVtXSA9IG5ld2NvdW50CiAgICAgICAgcmV0dXJuIHJlc3VsdAoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMgIENoYWluTWFwIChoZWxwZXIgZm9yIGNvbmZpZ3BhcnNlcikKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpjbGFzcyBDaGFpbk1hcChNdXRhYmxlTWFwcGluZyk6CiAgICAnJycgQSBDaGFpbk1hcCBncm91cHMgbXVsdGlwbGUgZGljdHMgKG9yIG90aGVyIG1hcHBpbmdzKSB0b2dldGhlcgogICAgdG8gY3JlYXRlIGEgc2luZ2xlLCB1cGRhdGVhYmxlIHZpZXcuCgogICAgVGhlIHVuZGVybHlpbmcgbWFwcGluZ3MgYXJlIHN0b3JlZCBpbiBhIGxpc3QuICBUaGF0IGxpc3QgaXMgcHVibGljIGFuZCBjYW4KICAgIGFjY2Vzc2VkIG9yIHVwZGF0ZWQgdXNpbmcgdGhlICptYXBzKiBhdHRyaWJ1dGUuICBUaGVyZSBpcyBubyBvdGhlciBzdGF0ZS4KCiAgICBMb29rdXBzIHNlYXJjaCB0aGUgdW5kZXJseWluZyBtYXBwaW5ncyBzdWNjZXNzaXZlbHkgdW50aWwgYSBrZXkgaXMgZm91bmQuCiAgICBJbiBjb250cmFzdCwgd3JpdGVzLCB1cGRhdGVzLCBhbmQgZGVsZXRpb25zIG9ubHkgb3BlcmF0ZSBvbiB0aGUgZmlyc3QKICAgIG1hcHBpbmcuCgogICAgJycnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsICptYXBzKToKICAgICAgICAnJydJbml0aWFsaXplIGEgQ2hhaW5NYXAgYnkgc2V0dGluZyAqbWFwcyogdG8gdGhlIGdpdmVuIG1hcHBpbmdzLgogICAgICAgIElmIG5vIG1hcHBpbmdzIGFyZSBwcm92aWRlZCwgYSBzaW5nbGUgZW1wdHkgZGljdGlvbmFyeSBpcyB1c2VkLgoKICAgICAgICAnJycKICAgICAgICBzZWxmLm1hcHMgPSBsaXN0KG1hcHMpIG9yIFt7fV0gICAgICAgICAgIyBhbHdheXMgYXQgbGVhc3Qgb25lIG1hcAoKICAgIGRlZiBfX21pc3NpbmdfXyhzZWxmLCBrZXkpOgogICAgICAgIHJhaXNlIEtleUVycm9yKGtleSkKCiAgICBkZWYgX19nZXRpdGVtX18oc2VsZiwga2V5KToKICAgICAgICBmb3IgbWFwcGluZyBpbiBzZWxmLm1hcHM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHJldHVybiBtYXBwaW5nW2tleV0gICAgICAgICAgICAgIyBjYW4ndCB1c2UgJ2tleSBpbiBtYXBwaW5nJyB3aXRoIGRlZmF1bHRkaWN0CiAgICAgICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICByZXR1cm4gc2VsZi5fX21pc3NpbmdfXyhrZXkpICAgICAgICAgICAgIyBzdXBwb3J0IHN1YmNsYXNzZXMgdGhhdCBkZWZpbmUgX19taXNzaW5nX18KCiAgICBkZWYgZ2V0KHNlbGYsIGtleSwgZGVmYXVsdD1Ob25lKToKICAgICAgICByZXR1cm4gc2VsZltrZXldIGlmIGtleSBpbiBzZWxmIGVsc2UgZGVmYXVsdAoKICAgIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICAgIHJldHVybiBsZW4oc2V0KCkudW5pb24oKnNlbGYubWFwcykpICAgICAjIHJldXNlcyBzdG9yZWQgaGFzaCB2YWx1ZXMgaWYgcG9zc2libGUKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGl0ZXIoc2V0KCkudW5pb24oKnNlbGYubWFwcykpCgogICAgZGVmIF9fY29udGFpbnNfXyhzZWxmLCBrZXkpOgogICAgICAgIHJldHVybiBhbnkoa2V5IGluIG0gZm9yIG0gaW4gc2VsZi5tYXBzKQoKICAgIGRlZiBfX2Jvb2xfXyhzZWxmKToKICAgICAgICByZXR1cm4gYW55KHNlbGYubWFwcykKCiAgICAjZml4bWUsIGJyeXRob24KICAgICNAX3JlY3Vyc2l2ZV9yZXByKCkKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gJ3swLl9fY2xhc3NfXy5fX25hbWVfX30oezF9KScuZm9ybWF0KAogICAgICAgICAgICBzZWxmLCAnLCAnLmpvaW4obWFwKHJlcHIsIHNlbGYubWFwcykpKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gJywnLmpvaW4oc3RyKF9tYXApIGZvciBfbWFwIGluIHNlbGYubWFwcykKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBmcm9ta2V5cyhjbHMsIGl0ZXJhYmxlLCAqYXJncyk6CiAgICAgICAgJ0NyZWF0ZSBhIENoYWluTWFwIHdpdGggYSBzaW5nbGUgZGljdCBjcmVhdGVkIGZyb20gdGhlIGl0ZXJhYmxlLicKICAgICAgICByZXR1cm4gY2xzKGRpY3QuZnJvbWtleXMoaXRlcmFibGUsICphcmdzKSkKCiAgICBkZWYgY29weShzZWxmKToKICAgICAgICAnTmV3IENoYWluTWFwIG9yIHN1YmNsYXNzIHdpdGggYSBuZXcgY29weSBvZiBtYXBzWzBdIGFuZCByZWZzIHRvIG1hcHNbMTpdJwogICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXyhzZWxmLm1hcHNbMF0uY29weSgpLCAqc2VsZi5tYXBzWzE6XSkKCiAgICBfX2NvcHlfXyA9IGNvcHkKCiAgICBkZWYgbmV3X2NoaWxkKHNlbGYpOiAgICAgICAgICAgICAgICAgICAgICAgICMgbGlrZSBEamFuZ28ncyBDb250ZXh0LnB1c2goKQogICAgICAgICdOZXcgQ2hhaW5NYXAgd2l0aCBhIG5ldyBkaWN0IGZvbGxvd2VkIGJ5IGFsbCBwcmV2aW91cyBtYXBzLicKICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oe30sICpzZWxmLm1hcHMpCgogICAgQHByb3BlcnR5CiAgICBkZWYgcGFyZW50cyhzZWxmKTogICAgICAgICAgICAgICAgICAgICAgICAgICMgbGlrZSBEamFuZ28ncyBDb250ZXh0LnBvcCgpCiAgICAgICAgJ05ldyBDaGFpbk1hcCBmcm9tIG1hcHNbMTpdLicKICAgICAgICByZXR1cm4gc2VsZi5fX2NsYXNzX18oKnNlbGYubWFwc1sxOl0pCgogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIGtleSwgdmFsdWUpOgogICAgICAgIHNlbGYubWFwc1swXVtrZXldID0gdmFsdWUKCiAgICBkZWYgX19kZWxpdGVtX18oc2VsZiwga2V5KToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGRlbCBzZWxmLm1hcHNbMF1ba2V5XQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3IoJ0tleSBub3QgZm91bmQgaW4gdGhlIGZpcnN0IG1hcHBpbmc6IHshcn0nLmZvcm1hdChrZXkpKQoKICAgIGRlZiBwb3BpdGVtKHNlbGYpOgogICAgICAgICdSZW1vdmUgYW5kIHJldHVybiBhbiBpdGVtIHBhaXIgZnJvbSBtYXBzWzBdLiBSYWlzZSBLZXlFcnJvciBpcyBtYXBzWzBdIGlzIGVtcHR5LicKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLm1hcHNbMF0ucG9waXRlbSgpCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICByYWlzZSBLZXlFcnJvcignTm8ga2V5cyBmb3VuZCBpbiB0aGUgZmlyc3QgbWFwcGluZy4nKQoKICAgIGRlZiBwb3Aoc2VsZiwga2V5LCAqYXJncyk6CiAgICAgICAgJ1JlbW92ZSAqa2V5KiBmcm9tIG1hcHNbMF0gYW5kIHJldHVybiBpdHMgdmFsdWUuIFJhaXNlIEtleUVycm9yIGlmICprZXkqIG5vdCBpbiBtYXBzWzBdLicKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLm1hcHNbMF0ucG9wKGtleSwgKmFyZ3MpCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICAjcmFpc2UgS2V5RXJyb3IoJ0tleSBub3QgZm91bmQgaW4gdGhlIGZpcnN0IG1hcHBpbmc6IHshcn0nLmZvcm1hdChrZXkpKQogICAgICAgICAgICByYWlzZSBLZXlFcnJvcignS2V5IG5vdCBmb3VuZCBpbiB0aGUgZmlyc3QgbWFwcGluZzogJXMnICUga2V5KQoKICAgIGRlZiBjbGVhcihzZWxmKToKICAgICAgICAnQ2xlYXIgbWFwc1swXSwgbGVhdmluZyBtYXBzWzE6XSBpbnRhY3QuJwogICAgICAgIHNlbGYubWFwc1swXS5jbGVhcigpCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjIFVzZXJEaWN0CiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpjbGFzcyBVc2VyRGljdChNdXRhYmxlTWFwcGluZyk6CgogICAgIyBTdGFydCBieSBmaWxsaW5nLW91dCB0aGUgYWJzdHJhY3QgbWV0aG9kcwogICAgZGVmIF9faW5pdF9fKHNlbGYsIGRpY3Q9Tm9uZSwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuZGF0YSA9IHt9CiAgICAgICAgaWYgZGljdCBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi51cGRhdGUoZGljdCkKICAgICAgICBpZiBsZW4oa3dhcmdzKToKICAgICAgICAgICAgc2VsZi51cGRhdGUoa3dhcmdzKQogICAgZGVmIF9fbGVuX18oc2VsZik6IHJldHVybiBsZW4oc2VsZi5kYXRhKQogICAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGtleSk6CiAgICAgICAgaWYga2V5IGluIHNlbGYuZGF0YToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuZGF0YVtrZXldCiAgICAgICAgaWYgaGFzYXR0cihzZWxmLl9fY2xhc3NfXywgIl9fbWlzc2luZ19fIik6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9fY2xhc3NfXy5fX21pc3NpbmdfXyhzZWxmLCBrZXkpCiAgICAgICAgcmFpc2UgS2V5RXJyb3Ioa2V5KQogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIGtleSwgaXRlbSk6IHNlbGYuZGF0YVtrZXldID0gaXRlbQogICAgZGVmIF9fZGVsaXRlbV9fKHNlbGYsIGtleSk6IGRlbCBzZWxmLmRhdGFba2V5XQogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBpdGVyKHNlbGYuZGF0YSkKCiAgICAjIE1vZGlmeSBfX2NvbnRhaW5zX18gdG8gd29yayBjb3JyZWN0bHkgd2hlbiBfX21pc3NpbmdfXyBpcyBwcmVzZW50CiAgICBkZWYgX19jb250YWluc19fKHNlbGYsIGtleSk6CiAgICAgICAgcmV0dXJuIGtleSBpbiBzZWxmLmRhdGEKCiAgICAjIE5vdywgYWRkIHRoZSBtZXRob2RzIGluIGRpY3RzIGJ1dCBub3QgaW4gTXV0YWJsZU1hcHBpbmcKICAgIGRlZiBfX3JlcHJfXyhzZWxmKTogcmV0dXJuIHJlcHIoc2VsZi5kYXRhKQogICAgZGVmIGNvcHkoc2VsZik6CiAgICAgICAgaWYgc2VsZi5fX2NsYXNzX18gaXMgVXNlckRpY3Q6CiAgICAgICAgICAgIHJldHVybiBVc2VyRGljdChzZWxmLmRhdGEuY29weSgpKQogICAgICAgIGltcG9ydCBjb3B5CiAgICAgICAgZGF0YSA9IHNlbGYuZGF0YQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5kYXRhID0ge30KICAgICAgICAgICAgYyA9IGNvcHkuY29weShzZWxmKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHNlbGYuZGF0YSA9IGRhdGEKICAgICAgICBjLnVwZGF0ZShzZWxmKQogICAgICAgIHJldHVybiBjCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBmcm9ta2V5cyhjbHMsIGl0ZXJhYmxlLCB2YWx1ZT1Ob25lKToKICAgICAgICBkID0gY2xzKCkKICAgICAgICBmb3Iga2V5IGluIGl0ZXJhYmxlOgogICAgICAgICAgICBkW2tleV0gPSB2YWx1ZQogICAgICAgIHJldHVybiBkCgoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIyBVc2VyTGlzdAojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMgVXNlclN0cmluZwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwo=',
'/Lib/http/cookies.py':'CiMKCiMjIyMKIyBDb3B5cmlnaHQgMjAwMCBieSBUaW1vdGh5IE8nTWFsbGV5IDx0aW1vQGFsdW0ubWl0LmVkdT4KIwojICAgICAgICAgICAgICAgIEFsbCBSaWdodHMgUmVzZXJ2ZWQKIwojIFBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZCBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUKIyBhbmQgaXRzIGRvY3VtZW50YXRpb24gZm9yIGFueSBwdXJwb3NlIGFuZCB3aXRob3V0IGZlZSBpcyBoZXJlYnkKIyBncmFudGVkLCBwcm92aWRlZCB0aGF0IHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFwcGVhciBpbiBhbGwKIyBjb3BpZXMgYW5kIHRoYXQgYm90aCB0aGF0IGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbgojIG5vdGljZSBhcHBlYXIgaW4gc3VwcG9ydGluZyBkb2N1bWVudGF0aW9uLCBhbmQgdGhhdCB0aGUgbmFtZSBvZgojIFRpbW90aHkgTydNYWxsZXkgIG5vdCBiZSB1c2VkIGluIGFkdmVydGlzaW5nIG9yIHB1YmxpY2l0eQojIHBlcnRhaW5pbmcgdG8gZGlzdHJpYnV0aW9uIG9mIHRoZSBzb2Z0d2FyZSB3aXRob3V0IHNwZWNpZmljLCB3cml0dGVuCiMgcHJpb3IgcGVybWlzc2lvbi4KIwojIFRpbW90aHkgTydNYWxsZXkgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEggUkVHQVJEIFRPIFRISVMKIyBTT0ZUV0FSRSwgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZCiMgQU5EIEZJVE5FU1MsIElOIE5PIEVWRU5UIFNIQUxMIFRpbW90aHkgTydNYWxsZXkgQkUgTElBQkxFIEZPUgojIEFOWSBTUEVDSUFMLCBJTkRJUkVDVCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMKIyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsCiMgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1IgT1RIRVIgVE9SVElPVVMKIyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SCiMgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4KIwojIyMjCiMKIyBJZDogQ29va2llLnB5LHYgMi4yOSAyMDAwLzA4LzIzIDA1OjI4OjQ5IHRpbW8gRXhwCiMgICBieSBUaW1vdGh5IE8nTWFsbGV5IDx0aW1vQGFsdW0ubWl0LmVkdT4KIwojICBDb29raWUucHkgaXMgYSBQeXRob24gbW9kdWxlIGZvciB0aGUgaGFuZGxpbmcgb2YgSFRUUAojICBjb29raWVzIGFzIGEgUHl0aG9uIGRpY3Rpb25hcnkuICBTZWUgUkZDIDIxMDkgZm9yIG1vcmUKIyAgaW5mb3JtYXRpb24gb24gY29va2llcy4KIwojICBUaGUgb3JpZ2luYWwgaWRlYSB0byB0cmVhdCBDb29raWVzIGFzIGEgZGljdGlvbmFyeSBjYW1lIGZyb20KIyAgRGF2ZSBNaXRjaGVsbCAoZGF2ZW1AbWFnbmV0LmNvbSkgaW4gMTk5NSwgd2hlbiBoZSByZWxlYXNlZCB0aGUKIyAgZmlyc3QgdmVyc2lvbiBvZiBuc2Nvb2tpZS5weS4KIwojIyMjCgpyIiIiCkhlcmUncyBhIHNhbXBsZSBzZXNzaW9uIHRvIHNob3cgaG93IHRvIHVzZSB0aGlzIG1vZHVsZS4KQXQgdGhlIG1vbWVudCwgdGhpcyBpcyB0aGUgb25seSBkb2N1bWVudGF0aW9uLgoKVGhlIEJhc2ljcwotLS0tLS0tLS0tCgpJbXBvcnRpbmcgaXMgZWFzeS4uLgoKICAgPj4+IGZyb20gaHR0cCBpbXBvcnQgY29va2llcwoKTW9zdCBvZiB0aGUgdGltZSB5b3Ugc3RhcnQgYnkgY3JlYXRpbmcgYSBjb29raWUuCgogICA+Pj4gQyA9IGNvb2tpZXMuU2ltcGxlQ29va2llKCkKCk9uY2UgeW91J3ZlIGNyZWF0ZWQgeW91ciBDb29raWUsIHlvdSBjYW4gYWRkIHZhbHVlcyBqdXN0IGFzIGlmIGl0IHdlcmUKYSBkaWN0aW9uYXJ5LgoKICAgPj4+IEMgPSBjb29raWVzLlNpbXBsZUNvb2tpZSgpCiAgID4+PiBDWyJmaWciXSA9ICJuZXd0b24iCiAgID4+PiBDWyJzdWdhciJdID0gIndhZmVyIgogICA+Pj4gQy5vdXRwdXQoKQogICAnU2V0LUNvb2tpZTogZmlnPW5ld3RvblxyXG5TZXQtQ29va2llOiBzdWdhcj13YWZlcicKCk5vdGljZSB0aGF0IHRoZSBwcmludGFibGUgcmVwcmVzZW50YXRpb24gb2YgYSBDb29raWUgaXMgdGhlCmFwcHJvcHJpYXRlIGZvcm1hdCBmb3IgYSBTZXQtQ29va2llOiBoZWFkZXIuICBUaGlzIGlzIHRoZQpkZWZhdWx0IGJlaGF2aW9yLiAgWW91IGNhbiBjaGFuZ2UgdGhlIGhlYWRlciBhbmQgcHJpbnRlZAphdHRyaWJ1dGVzIGJ5IHVzaW5nIHRoZSAub3V0cHV0KCkgZnVuY3Rpb24KCiAgID4+PiBDID0gY29va2llcy5TaW1wbGVDb29raWUoKQogICA+Pj4gQ1sicm9ja3kiXSA9ICJyb2FkIgogICA+Pj4gQ1sicm9ja3kiXVsicGF0aCJdID0gIi9jb29raWUiCiAgID4+PiBwcmludChDLm91dHB1dChoZWFkZXI9IkNvb2tpZToiKSkKICAgQ29va2llOiByb2NreT1yb2FkOyBQYXRoPS9jb29raWUKICAgPj4+IHByaW50KEMub3V0cHV0KGF0dHJzPVtdLCBoZWFkZXI9IkNvb2tpZToiKSkKICAgQ29va2llOiByb2NreT1yb2FkCgpUaGUgbG9hZCgpIG1ldGhvZCBvZiBhIENvb2tpZSBleHRyYWN0cyBjb29raWVzIGZyb20gYSBzdHJpbmcuICBJbiBhCkNHSSBzY3JpcHQsIHlvdSB3b3VsZCB1c2UgdGhpcyBtZXRob2QgdG8gZXh0cmFjdCB0aGUgY29va2llcyBmcm9tIHRoZQpIVFRQX0NPT0tJRSBlbnZpcm9ubWVudCB2YXJpYWJsZS4KCiAgID4+PiBDID0gY29va2llcy5TaW1wbGVDb29raWUoKQogICA+Pj4gQy5sb2FkKCJjaGlwcz1haG95OyB2aWVubmE9ZmluZ2VyIikKICAgPj4+IEMub3V0cHV0KCkKICAgJ1NldC1Db29raWU6IGNoaXBzPWFob3lcclxuU2V0LUNvb2tpZTogdmllbm5hPWZpbmdlcicKClRoZSBsb2FkKCkgbWV0aG9kIGlzIGRhcm4tdG9vdGluIHNtYXJ0IGFib3V0IGlkZW50aWZ5aW5nIGNvb2tpZXMKd2l0aGluIGEgc3RyaW5nLiAgRXNjYXBlZCBxdW90YXRpb24gbWFya3MsIG5lc3RlZCBzZW1pY29sb25zLCBhbmQgb3RoZXIKc3VjaCB0cmlja2VyaWVzIGRvIG5vdCBjb25mdXNlIGl0LgoKICAgPj4+IEMgPSBjb29raWVzLlNpbXBsZUNvb2tpZSgpCiAgID4+PiBDLmxvYWQoJ2tlZWJsZXI9IkU9ZXZlcnlib2R5OyBMPVxcIkxvdmVzXFwiOyBmdWRnZT1cXDAxMjsiOycpCiAgID4+PiBwcmludChDKQogICBTZXQtQ29va2llOiBrZWVibGVyPSJFPWV2ZXJ5Ym9keTsgTD1cIkxvdmVzXCI7IGZ1ZGdlPVwwMTI7IgoKRWFjaCBlbGVtZW50IG9mIHRoZSBDb29raWUgYWxzbyBzdXBwb3J0cyBhbGwgb2YgdGhlIFJGQyAyMTA5CkNvb2tpZSBhdHRyaWJ1dGVzLiAgSGVyZSdzIGFuIGV4YW1wbGUgd2hpY2ggc2V0cyB0aGUgUGF0aAphdHRyaWJ1dGUuCgogICA+Pj4gQyA9IGNvb2tpZXMuU2ltcGxlQ29va2llKCkKICAgPj4+IENbIm9yZW8iXSA9ICJkb3VibGVzdHVmZiIKICAgPj4+IENbIm9yZW8iXVsicGF0aCJdID0gIi8iCiAgID4+PiBwcmludChDKQogICBTZXQtQ29va2llOiBvcmVvPWRvdWJsZXN0dWZmOyBQYXRoPS8KCkVhY2ggZGljdGlvbmFyeSBlbGVtZW50IGhhcyBhICd2YWx1ZScgYXR0cmlidXRlLCB3aGljaCBnaXZlcyB5b3UKYmFjayB0aGUgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIHRoZSBrZXkuCgogICA+Pj4gQyA9IGNvb2tpZXMuU2ltcGxlQ29va2llKCkKICAgPj4+IENbInR3aXgiXSA9ICJub25lIGZvciB5b3UiCiAgID4+PiBDWyJ0d2l4Il0udmFsdWUKICAgJ25vbmUgZm9yIHlvdScKClRoZSBTaW1wbGVDb29raWUgZXhwZWN0cyB0aGF0IGFsbCB2YWx1ZXMgc2hvdWxkIGJlIHN0YW5kYXJkIHN0cmluZ3MuCkp1c3QgdG8gYmUgc3VyZSwgU2ltcGxlQ29va2llIGludm9rZXMgdGhlIHN0cigpIGJ1aWx0aW4gdG8gY29udmVydAp0aGUgdmFsdWUgdG8gYSBzdHJpbmcsIHdoZW4gdGhlIHZhbHVlcyBhcmUgc2V0IGRpY3Rpb25hcnktc3R5bGUuCgogICA+Pj4gQyA9IGNvb2tpZXMuU2ltcGxlQ29va2llKCkKICAgPj4+IENbIm51bWJlciJdID0gNwogICA+Pj4gQ1sic3RyaW5nIl0gPSAic2V2ZW4iCiAgID4+PiBDWyJudW1iZXIiXS52YWx1ZQogICAnNycKICAgPj4+IENbInN0cmluZyJdLnZhbHVlCiAgICdzZXZlbicKICAgPj4+IEMub3V0cHV0KCkKICAgJ1NldC1Db29raWU6IG51bWJlcj03XHJcblNldC1Db29raWU6IHN0cmluZz1zZXZlbicKCkZpbmlzLgoiIiIKCiMKIyBJbXBvcnQgb3VyIHJlcXVpcmVkIG1vZHVsZXMKIwppbXBvcnQgcmUKaW1wb3J0IHN0cmluZwoKX19hbGxfXyA9IFsiQ29va2llRXJyb3IiLCAiQmFzZUNvb2tpZSIsICJTaW1wbGVDb29raWUiXQoKX251bGxqb2luID0gJycuam9pbgpfc2VtaXNwYWNlam9pbiA9ICc7ICcuam9pbgpfc3BhY2Vqb2luID0gJyAnLmpvaW4KCiMKIyBEZWZpbmUgYW4gZXhjZXB0aW9uIHZpc2libGUgdG8gRXh0ZXJuYWwgbW9kdWxlcwojCmNsYXNzIENvb2tpZUVycm9yKEV4Y2VwdGlvbik6CiAgICBwYXNzCgoKIyBUaGVzZSBxdW90aW5nIHJvdXRpbmVzIGNvbmZvcm0gdG8gdGhlIFJGQzIxMDkgc3BlY2lmaWNhdGlvbiwgd2hpY2ggaW4KIyB0dXJuIHJlZmVyZW5jZXMgdGhlIGNoYXJhY3RlciBkZWZpbml0aW9ucyBmcm9tIFJGQzIwNjguICBUaGV5IHByb3ZpZGUKIyBhIHR3by13YXkgcXVvdGluZyBhbGdvcml0aG0uICBBbnkgbm9uLXRleHQgY2hhcmFjdGVyIGlzIHRyYW5zbGF0ZWQKIyBpbnRvIGEgNCBjaGFyYWN0ZXIgc2VxdWVuY2U6IGEgZm9yd2FyZC1zbGFzaCBmb2xsb3dlZCBieSB0aGUKIyB0aHJlZS1kaWdpdCBvY3RhbCBlcXVpdmFsZW50IG9mIHRoZSBjaGFyYWN0ZXIuICBBbnkgJ1wnIG9yICciJyBpcwojIHF1b3RlZCB3aXRoIGEgcHJlY2VlZGluZyAnXCcgc2xhc2guCiMKIyBUaGVzZSBhcmUgdGFrZW4gZnJvbSBSRkMyMDY4IGFuZCBSRkMyMTA5LgojICAgICAgIF9MZWdhbENoYXJzICAgICAgIGlzIHRoZSBsaXN0IG9mIGNoYXJzIHdoaWNoIGRvbid0IHJlcXVpcmUgIidzCiMgICAgICAgX1RyYW5zbGF0b3IgICAgICAgaGFzaC10YWJsZSBmb3IgZmFzdCBxdW90aW5nCiMKX0xlZ2FsQ2hhcnMgICAgICAgPSBzdHJpbmcuYXNjaWlfbGV0dGVycyArIHN0cmluZy5kaWdpdHMgKyAiISMkJSYnKistLl5fYHx+OiIKX1RyYW5zbGF0b3IgICAgICAgPSB7CiAgICAnXDAwMCcgOiAnXFwwMDAnLCAgJ1wwMDEnIDogJ1xcMDAxJywgICdcMDAyJyA6ICdcXDAwMicsCiAgICAnXDAwMycgOiAnXFwwMDMnLCAgJ1wwMDQnIDogJ1xcMDA0JywgICdcMDA1JyA6ICdcXDAwNScsCiAgICAnXDAwNicgOiAnXFwwMDYnLCAgJ1wwMDcnIDogJ1xcMDA3JywgICdcMDEwJyA6ICdcXDAxMCcsCiAgICAnXDAxMScgOiAnXFwwMTEnLCAgJ1wwMTInIDogJ1xcMDEyJywgICdcMDEzJyA6ICdcXDAxMycsCiAgICAnXDAxNCcgOiAnXFwwMTQnLCAgJ1wwMTUnIDogJ1xcMDE1JywgICdcMDE2JyA6ICdcXDAxNicsCiAgICAnXDAxNycgOiAnXFwwMTcnLCAgJ1wwMjAnIDogJ1xcMDIwJywgICdcMDIxJyA6ICdcXDAyMScsCiAgICAnXDAyMicgOiAnXFwwMjInLCAgJ1wwMjMnIDogJ1xcMDIzJywgICdcMDI0JyA6ICdcXDAyNCcsCiAgICAnXDAyNScgOiAnXFwwMjUnLCAgJ1wwMjYnIDogJ1xcMDI2JywgICdcMDI3JyA6ICdcXDAyNycsCiAgICAnXDAzMCcgOiAnXFwwMzAnLCAgJ1wwMzEnIDogJ1xcMDMxJywgICdcMDMyJyA6ICdcXDAzMicsCiAgICAnXDAzMycgOiAnXFwwMzMnLCAgJ1wwMzQnIDogJ1xcMDM0JywgICdcMDM1JyA6ICdcXDAzNScsCiAgICAnXDAzNicgOiAnXFwwMzYnLCAgJ1wwMzcnIDogJ1xcMDM3JywKCiAgICAjIEJlY2F1c2Ugb2YgdGhlIHdheSBicm93c2VycyByZWFsbHkgaGFuZGxlIGNvb2tpZXMgKGFzIG9wcG9zZWQKICAgICMgdG8gd2hhdCB0aGUgUkZDIHNheXMpIHdlIGFsc28gZW5jb2RlICwgYW5kIDsKCiAgICAnLCcgOiAnXFwwNTQnLCAnOycgOiAnXFwwNzMnLAoKICAgICciJyA6ICdcXCInLCAgICAgICAnXFwnIDogJ1xcXFwnLAoKICAgICdcMTc3JyA6ICdcXDE3NycsICAnXDIwMCcgOiAnXFwyMDAnLCAgJ1wyMDEnIDogJ1xcMjAxJywKICAgICdcMjAyJyA6ICdcXDIwMicsICAnXDIwMycgOiAnXFwyMDMnLCAgJ1wyMDQnIDogJ1xcMjA0JywKICAgICdcMjA1JyA6ICdcXDIwNScsICAnXDIwNicgOiAnXFwyMDYnLCAgJ1wyMDcnIDogJ1xcMjA3JywKICAgICdcMjEwJyA6ICdcXDIxMCcsICAnXDIxMScgOiAnXFwyMTEnLCAgJ1wyMTInIDogJ1xcMjEyJywKICAgICdcMjEzJyA6ICdcXDIxMycsICAnXDIxNCcgOiAnXFwyMTQnLCAgJ1wyMTUnIDogJ1xcMjE1JywKICAgICdcMjE2JyA6ICdcXDIxNicsICAnXDIxNycgOiAnXFwyMTcnLCAgJ1wyMjAnIDogJ1xcMjIwJywKICAgICdcMjIxJyA6ICdcXDIyMScsICAnXDIyMicgOiAnXFwyMjInLCAgJ1wyMjMnIDogJ1xcMjIzJywKICAgICdcMjI0JyA6ICdcXDIyNCcsICAnXDIyNScgOiAnXFwyMjUnLCAgJ1wyMjYnIDogJ1xcMjI2JywKICAgICdcMjI3JyA6ICdcXDIyNycsICAnXDIzMCcgOiAnXFwyMzAnLCAgJ1wyMzEnIDogJ1xcMjMxJywKICAgICdcMjMyJyA6ICdcXDIzMicsICAnXDIzMycgOiAnXFwyMzMnLCAgJ1wyMzQnIDogJ1xcMjM0JywKICAgICdcMjM1JyA6ICdcXDIzNScsICAnXDIzNicgOiAnXFwyMzYnLCAgJ1wyMzcnIDogJ1xcMjM3JywKICAgICdcMjQwJyA6ICdcXDI0MCcsICAnXDI0MScgOiAnXFwyNDEnLCAgJ1wyNDInIDogJ1xcMjQyJywKICAgICdcMjQzJyA6ICdcXDI0MycsICAnXDI0NCcgOiAnXFwyNDQnLCAgJ1wyNDUnIDogJ1xcMjQ1JywKICAgICdcMjQ2JyA6ICdcXDI0NicsICAnXDI0NycgOiAnXFwyNDcnLCAgJ1wyNTAnIDogJ1xcMjUwJywKICAgICdcMjUxJyA6ICdcXDI1MScsICAnXDI1MicgOiAnXFwyNTInLCAgJ1wyNTMnIDogJ1xcMjUzJywKICAgICdcMjU0JyA6ICdcXDI1NCcsICAnXDI1NScgOiAnXFwyNTUnLCAgJ1wyNTYnIDogJ1xcMjU2JywKICAgICdcMjU3JyA6ICdcXDI1NycsICAnXDI2MCcgOiAnXFwyNjAnLCAgJ1wyNjEnIDogJ1xcMjYxJywKICAgICdcMjYyJyA6ICdcXDI2MicsICAnXDI2MycgOiAnXFwyNjMnLCAgJ1wyNjQnIDogJ1xcMjY0JywKICAgICdcMjY1JyA6ICdcXDI2NScsICAnXDI2NicgOiAnXFwyNjYnLCAgJ1wyNjcnIDogJ1xcMjY3JywKICAgICdcMjcwJyA6ICdcXDI3MCcsICAnXDI3MScgOiAnXFwyNzEnLCAgJ1wyNzInIDogJ1xcMjcyJywKICAgICdcMjczJyA6ICdcXDI3MycsICAnXDI3NCcgOiAnXFwyNzQnLCAgJ1wyNzUnIDogJ1xcMjc1JywKICAgICdcMjc2JyA6ICdcXDI3NicsICAnXDI3NycgOiAnXFwyNzcnLCAgJ1wzMDAnIDogJ1xcMzAwJywKICAgICdcMzAxJyA6ICdcXDMwMScsICAnXDMwMicgOiAnXFwzMDInLCAgJ1wzMDMnIDogJ1xcMzAzJywKICAgICdcMzA0JyA6ICdcXDMwNCcsICAnXDMwNScgOiAnXFwzMDUnLCAgJ1wzMDYnIDogJ1xcMzA2JywKICAgICdcMzA3JyA6ICdcXDMwNycsICAnXDMxMCcgOiAnXFwzMTAnLCAgJ1wzMTEnIDogJ1xcMzExJywKICAgICdcMzEyJyA6ICdcXDMxMicsICAnXDMxMycgOiAnXFwzMTMnLCAgJ1wzMTQnIDogJ1xcMzE0JywKICAgICdcMzE1JyA6ICdcXDMxNScsICAnXDMxNicgOiAnXFwzMTYnLCAgJ1wzMTcnIDogJ1xcMzE3JywKICAgICdcMzIwJyA6ICdcXDMyMCcsICAnXDMyMScgOiAnXFwzMjEnLCAgJ1wzMjInIDogJ1xcMzIyJywKICAgICdcMzIzJyA6ICdcXDMyMycsICAnXDMyNCcgOiAnXFwzMjQnLCAgJ1wzMjUnIDogJ1xcMzI1JywKICAgICdcMzI2JyA6ICdcXDMyNicsICAnXDMyNycgOiAnXFwzMjcnLCAgJ1wzMzAnIDogJ1xcMzMwJywKICAgICdcMzMxJyA6ICdcXDMzMScsICAnXDMzMicgOiAnXFwzMzInLCAgJ1wzMzMnIDogJ1xcMzMzJywKICAgICdcMzM0JyA6ICdcXDMzNCcsICAnXDMzNScgOiAnXFwzMzUnLCAgJ1wzMzYnIDogJ1xcMzM2JywKICAgICdcMzM3JyA6ICdcXDMzNycsICAnXDM0MCcgOiAnXFwzNDAnLCAgJ1wzNDEnIDogJ1xcMzQxJywKICAgICdcMzQyJyA6ICdcXDM0MicsICAnXDM0MycgOiAnXFwzNDMnLCAgJ1wzNDQnIDogJ1xcMzQ0JywKICAgICdcMzQ1JyA6ICdcXDM0NScsICAnXDM0NicgOiAnXFwzNDYnLCAgJ1wzNDcnIDogJ1xcMzQ3JywKICAgICdcMzUwJyA6ICdcXDM1MCcsICAnXDM1MScgOiAnXFwzNTEnLCAgJ1wzNTInIDogJ1xcMzUyJywKICAgICdcMzUzJyA6ICdcXDM1MycsICAnXDM1NCcgOiAnXFwzNTQnLCAgJ1wzNTUnIDogJ1xcMzU1JywKICAgICdcMzU2JyA6ICdcXDM1NicsICAnXDM1NycgOiAnXFwzNTcnLCAgJ1wzNjAnIDogJ1xcMzYwJywKICAgICdcMzYxJyA6ICdcXDM2MScsICAnXDM2MicgOiAnXFwzNjInLCAgJ1wzNjMnIDogJ1xcMzYzJywKICAgICdcMzY0JyA6ICdcXDM2NCcsICAnXDM2NScgOiAnXFwzNjUnLCAgJ1wzNjYnIDogJ1xcMzY2JywKICAgICdcMzY3JyA6ICdcXDM2NycsICAnXDM3MCcgOiAnXFwzNzAnLCAgJ1wzNzEnIDogJ1xcMzcxJywKICAgICdcMzcyJyA6ICdcXDM3MicsICAnXDM3MycgOiAnXFwzNzMnLCAgJ1wzNzQnIDogJ1xcMzc0JywKICAgICdcMzc1JyA6ICdcXDM3NScsICAnXDM3NicgOiAnXFwzNzYnLCAgJ1wzNzcnIDogJ1xcMzc3JwogICAgfQoKZGVmIF9xdW90ZShzdHIsIExlZ2FsQ2hhcnM9X0xlZ2FsQ2hhcnMpOgogICAgciIiIlF1b3RlIGEgc3RyaW5nIGZvciB1c2UgaW4gYSBjb29raWUgaGVhZGVyLgoKICAgIElmIHRoZSBzdHJpbmcgZG9lcyBub3QgbmVlZCB0byBiZSBkb3VibGUtcXVvdGVkLCB0aGVuIGp1c3QgcmV0dXJuIHRoZQogICAgc3RyaW5nLiAgT3RoZXJ3aXNlLCBzdXJyb3VuZCB0aGUgc3RyaW5nIGluIGRvdWJsZXF1b3RlcyBhbmQgcXVvdGUKICAgICh3aXRoIGEgXCkgc3BlY2lhbCBjaGFyYWN0ZXJzLgogICAgIiIiCiAgICBpZiBhbGwoYyBpbiBMZWdhbENoYXJzIGZvciBjIGluIHN0cik6CiAgICAgICAgcmV0dXJuIHN0cgogICAgZWxzZToKICAgICAgICByZXR1cm4gJyInICsgX251bGxqb2luKF9UcmFuc2xhdG9yLmdldChzLCBzKSBmb3IgcyBpbiBzdHIpICsgJyInCgoKX09jdGFsUGF0dCA9IHJlLmNvbXBpbGUociJcXFswLTNdWzAtN11bMC03XSIpCl9RdW90ZVBhdHQgPSByZS5jb21waWxlKHIiW1xcXS4iKQoKZGVmIF91bnF1b3RlKHN0cik6CiAgICAjIElmIHRoZXJlIGFyZW4ndCBhbnkgZG91YmxlcXVvdGVzLAogICAgIyB0aGVuIHRoZXJlIGNhbid0IGJlIGFueSBzcGVjaWFsIGNoYXJhY3RlcnMuICBTZWUgUkZDIDIxMDkuCiAgICBpZiBsZW4oc3RyKSA8IDI6CiAgICAgICAgcmV0dXJuIHN0cgogICAgaWYgc3RyWzBdICE9ICciJyBvciBzdHJbLTFdICE9ICciJzoKICAgICAgICByZXR1cm4gc3RyCgogICAgIyBXZSBoYXZlIHRvIGFzc3VtZSB0aGF0IHdlIG11c3QgZGVjb2RlIHRoaXMgc3RyaW5nLgogICAgIyBEb3duIHRvIHdvcmsuCgogICAgIyBSZW1vdmUgdGhlICJzCiAgICBzdHIgPSBzdHJbMTotMV0KCiAgICAjIENoZWNrIGZvciBzcGVjaWFsIHNlcXVlbmNlcy4gIEV4YW1wbGVzOgogICAgIyAgICBcMDEyIC0tPiBcbgogICAgIyAgICBcIiAgIC0tPiAiCiAgICAjCiAgICBpID0gMAogICAgbiA9IGxlbihzdHIpCiAgICByZXMgPSBbXQogICAgd2hpbGUgMCA8PSBpIDwgbjoKICAgICAgICBvX21hdGNoID0gX09jdGFsUGF0dC5zZWFyY2goc3RyLCBpKQogICAgICAgIHFfbWF0Y2ggPSBfUXVvdGVQYXR0LnNlYXJjaChzdHIsIGkpCiAgICAgICAgaWYgbm90IG9fbWF0Y2ggYW5kIG5vdCBxX21hdGNoOiAgICAgICAgICAgICAgIyBOZWl0aGVyIG1hdGNoZWQKICAgICAgICAgICAgcmVzLmFwcGVuZChzdHJbaTpdKQogICAgICAgICAgICBicmVhawogICAgICAgICMgZWxzZToKICAgICAgICBqID0gayA9IC0xCiAgICAgICAgaWYgb19tYXRjaDoKICAgICAgICAgICAgaiA9IG9fbWF0Y2guc3RhcnQoMCkKICAgICAgICBpZiBxX21hdGNoOgogICAgICAgICAgICBrID0gcV9tYXRjaC5zdGFydCgwKQogICAgICAgIGlmIHFfbWF0Y2ggYW5kIChub3Qgb19tYXRjaCBvciBrIDwgaik6ICAgICAjIFF1b3RlUGF0dCBtYXRjaGVkCiAgICAgICAgICAgIHJlcy5hcHBlbmQoc3RyW2k6a10pCiAgICAgICAgICAgIHJlcy5hcHBlbmQoc3RyW2srMV0pCiAgICAgICAgICAgIGkgPSBrICsgMgogICAgICAgIGVsc2U6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIE9jdGFsUGF0dCBtYXRjaGVkCiAgICAgICAgICAgIHJlcy5hcHBlbmQoc3RyW2k6al0pCiAgICAgICAgICAgIHJlcy5hcHBlbmQoY2hyKGludChzdHJbaisxOmorNF0sIDgpKSkKICAgICAgICAgICAgaSA9IGogKyA0CiAgICByZXR1cm4gX251bGxqb2luKHJlcykKCiMgVGhlIF9nZXRkYXRlKCkgcm91dGluZSBpcyB1c2VkIHRvIHNldCB0aGUgZXhwaXJhdGlvbiB0aW1lIGluIHRoZSBjb29raWUncyBIVFRQCiMgaGVhZGVyLiAgQnkgZGVmYXVsdCwgX2dldGRhdGUoKSByZXR1cm5zIHRoZSBjdXJyZW50IHRpbWUgaW4gdGhlIGFwcHJvcHJpYXRlCiMgImV4cGlyZXMiIGZvcm1hdCBmb3IgYSBTZXQtQ29va2llIGhlYWRlci4gIFRoZSBvbmUgb3B0aW9uYWwgYXJndW1lbnQgaXMgYW4KIyBvZmZzZXQgZnJvbSBub3csIGluIHNlY29uZHMuICBGb3IgZXhhbXBsZSwgYW4gb2Zmc2V0IG9mIC0zNjAwIG1lYW5zICJvbmUgaG91cgojIGFnbyIuICBUaGUgb2Zmc2V0IG1heSBiZSBhIGZsb2F0aW5nIHBvaW50IG51bWJlci4KIwoKX3dlZWtkYXluYW1lID0gWydNb24nLCAnVHVlJywgJ1dlZCcsICdUaHUnLCAnRnJpJywgJ1NhdCcsICdTdW4nXQoKX21vbnRobmFtZSA9IFtOb25lLAogICAgICAgICAgICAgICdKYW4nLCAnRmViJywgJ01hcicsICdBcHInLCAnTWF5JywgJ0p1bicsCiAgICAgICAgICAgICAgJ0p1bCcsICdBdWcnLCAnU2VwJywgJ09jdCcsICdOb3YnLCAnRGVjJ10KCmRlZiBfZ2V0ZGF0ZShmdXR1cmU9MCwgd2Vla2RheW5hbWU9X3dlZWtkYXluYW1lLCBtb250aG5hbWU9X21vbnRobmFtZSk6CiAgICBmcm9tIHRpbWUgaW1wb3J0IGdtdGltZSwgdGltZQogICAgbm93ID0gdGltZSgpCiAgICB5ZWFyLCBtb250aCwgZGF5LCBoaCwgbW0sIHNzLCB3ZCwgeSwgeiA9IGdtdGltZShub3cgKyBmdXR1cmUpCiAgICByZXR1cm4gIiVzLCAlMDJkICUzcyAlNGQgJTAyZDolMDJkOiUwMmQgR01UIiAlIFwKICAgICAgICAgICAod2Vla2RheW5hbWVbd2RdLCBkYXksIG1vbnRobmFtZVttb250aF0sIHllYXIsIGhoLCBtbSwgc3MpCgoKY2xhc3MgTW9yc2VsKGRpY3QpOgogICAgIiIiQSBjbGFzcyB0byBob2xkIE9ORSAoa2V5LCB2YWx1ZSkgcGFpci4KCiAgICBJbiBhIGNvb2tpZSwgZWFjaCBzdWNoIHBhaXIgbWF5IGhhdmUgc2V2ZXJhbCBhdHRyaWJ1dGVzLCBzbyB0aGlzIGNsYXNzIGlzCiAgICB1c2VkIHRvIGtlZXAgdGhlIGF0dHJpYnV0ZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBhcHByb3ByaWF0ZSBrZXksdmFsdWUgcGFpci4KICAgIFRoaXMgY2xhc3MgYWxzbyBpbmNsdWRlcyBhIGNvZGVkX3ZhbHVlIGF0dHJpYnV0ZSwgd2hpY2ggaXMgdXNlZCB0byBob2xkCiAgICB0aGUgbmV0d29yayByZXByZXNlbnRhdGlvbiBvZiB0aGUgdmFsdWUuICBUaGlzIGlzIG1vc3QgdXNlZnVsIHdoZW4gUHl0aG9uCiAgICBvYmplY3RzIGFyZSBwaWNrbGVkIGZvciBuZXR3b3JrIHRyYW5zaXQuCiAgICAiIiIKICAgICMgUkZDIDIxMDkgbGlzdHMgdGhlc2UgYXR0cmlidXRlcyBhcyByZXNlcnZlZDoKICAgICMgICBwYXRoICAgICAgIGNvbW1lbnQgICAgICAgICBkb21haW4KICAgICMgICBtYXgtYWdlICAgIHNlY3VyZSAgICAgIHZlcnNpb24KICAgICMKICAgICMgRm9yIGhpc3RvcmljYWwgcmVhc29ucywgdGhlc2UgYXR0cmlidXRlcyBhcmUgYWxzbyByZXNlcnZlZDoKICAgICMgICBleHBpcmVzCiAgICAjCiAgICAjIFRoaXMgaXMgYW4gZXh0ZW5zaW9uIGZyb20gTWljcm9zb2Z0OgogICAgIyAgIGh0dHBvbmx5CiAgICAjCiAgICAjIFRoaXMgZGljdGlvbmFyeSBwcm92aWRlcyBhIG1hcHBpbmcgZnJvbSB0aGUgbG93ZXJjYXNlCiAgICAjIHZhcmlhbnQgb24gdGhlIGxlZnQgdG8gdGhlIGFwcHJvcHJpYXRlIHRyYWRpdGlvbmFsCiAgICAjIGZvcm1hdHRpbmcgb24gdGhlIHJpZ2h0LgogICAgX3Jlc2VydmVkID0gewogICAgICAgICJleHBpcmVzIiAgOiAiZXhwaXJlcyIsCiAgICAgICAgInBhdGgiICAgICA6ICJQYXRoIiwKICAgICAgICAiY29tbWVudCIgIDogIkNvbW1lbnQiLAogICAgICAgICJkb21haW4iICAgOiAiRG9tYWluIiwKICAgICAgICAibWF4LWFnZSIgIDogIk1heC1BZ2UiLAogICAgICAgICJzZWN1cmUiICAgOiAic2VjdXJlIiwKICAgICAgICAiaHR0cG9ubHkiIDogImh0dHBvbmx5IiwKICAgICAgICAidmVyc2lvbiIgIDogIlZlcnNpb24iLAogICAgfQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICAjIFNldCBkZWZhdWx0cwogICAgICAgIHNlbGYua2V5ID0gc2VsZi52YWx1ZSA9IHNlbGYuY29kZWRfdmFsdWUgPSBOb25lCgogICAgICAgICMgU2V0IGRlZmF1bHQgYXR0cmlidXRlcwogICAgICAgIGZvciBrZXkgaW4gc2VsZi5fcmVzZXJ2ZWQ6CiAgICAgICAgICAgIGRpY3QuX19zZXRpdGVtX18oc2VsZiwga2V5LCAiIikKCiAgICBkZWYgX19zZXRpdGVtX18oc2VsZiwgSywgVik6CiAgICAgICAgSyA9IEsubG93ZXIoKQogICAgICAgIGlmIG5vdCBLIGluIHNlbGYuX3Jlc2VydmVkOgogICAgICAgICAgICByYWlzZSBDb29raWVFcnJvcigiSW52YWxpZCBBdHRyaWJ1dGUgJXMiICUgSykKICAgICAgICBkaWN0Ll9fc2V0aXRlbV9fKHNlbGYsIEssIFYpCgogICAgZGVmIGlzUmVzZXJ2ZWRLZXkoc2VsZiwgSyk6CiAgICAgICAgcmV0dXJuIEsubG93ZXIoKSBpbiBzZWxmLl9yZXNlcnZlZAoKICAgIGRlZiBzZXQoc2VsZiwga2V5LCB2YWwsIGNvZGVkX3ZhbCwgTGVnYWxDaGFycz1fTGVnYWxDaGFycyk6CiAgICAgICAgIyBGaXJzdCB3ZSB2ZXJpZnkgdGhhdCB0aGUga2V5IGlzbid0IGEgcmVzZXJ2ZWQgd29yZAogICAgICAgICMgU2Vjb25kIHdlIG1ha2Ugc3VyZSBpdCBvbmx5IGNvbnRhaW5zIGxlZ2FsIGNoYXJhY3RlcnMKICAgICAgICBpZiBrZXkubG93ZXIoKSBpbiBzZWxmLl9yZXNlcnZlZDoKICAgICAgICAgICAgcmFpc2UgQ29va2llRXJyb3IoIkF0dGVtcHQgdG8gc2V0IGEgcmVzZXJ2ZWQga2V5OiAlcyIgJSBrZXkpCiAgICAgICAgaWYgYW55KGMgbm90IGluIExlZ2FsQ2hhcnMgZm9yIGMgaW4ga2V5KToKICAgICAgICAgICAgcmFpc2UgQ29va2llRXJyb3IoIklsbGVnYWwga2V5IHZhbHVlOiAlcyIgJSBrZXkpCgogICAgICAgICMgSXQncyBhIGdvb2Qga2V5LCBzbyBzYXZlIGl0LgogICAgICAgIHNlbGYua2V5ID0ga2V5CiAgICAgICAgc2VsZi52YWx1ZSA9IHZhbAogICAgICAgIHNlbGYuY29kZWRfdmFsdWUgPSBjb2RlZF92YWwKCiAgICBkZWYgb3V0cHV0KHNlbGYsIGF0dHJzPU5vbmUsIGhlYWRlcj0iU2V0LUNvb2tpZToiKToKICAgICAgICByZXR1cm4gIiVzICVzIiAlIChoZWFkZXIsIHNlbGYuT3V0cHV0U3RyaW5nKGF0dHJzKSkKCiAgICBfX3N0cl9fID0gb3V0cHV0CgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiAnPCVzOiAlcz0lcz4nICUgKHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYua2V5LCByZXByKHNlbGYudmFsdWUpKQoKICAgIGRlZiBqc19vdXRwdXQoc2VsZiwgYXR0cnM9Tm9uZSk6CiAgICAgICAgIyBQcmludCBqYXZhc2NyaXB0CiAgICAgICAgcmV0dXJuICIiIgogICAgICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KICAgICAgICA8IS0tIGJlZ2luIGhpZGluZwogICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IFwiJXNcIjsKICAgICAgICAvLyBlbmQgaGlkaW5nIC0tPgogICAgICAgIDwvc2NyaXB0PgogICAgICAgICIiIiAlIChzZWxmLk91dHB1dFN0cmluZyhhdHRycykucmVwbGFjZSgnIicsIHInXCInKSkKCiAgICBkZWYgT3V0cHV0U3RyaW5nKHNlbGYsIGF0dHJzPU5vbmUpOgogICAgICAgICMgQnVpbGQgdXAgb3VyIHJlc3VsdAogICAgICAgICMKICAgICAgICByZXN1bHQgPSBbXQogICAgICAgIGFwcGVuZCA9IHJlc3VsdC5hcHBlbmQKCiAgICAgICAgIyBGaXJzdCwgdGhlIGtleT12YWx1ZSBwYWlyCiAgICAgICAgYXBwZW5kKCIlcz0lcyIgJSAoc2VsZi5rZXksIHNlbGYuY29kZWRfdmFsdWUpKQoKICAgICAgICAjIE5vdyBhZGQgYW55IGRlZmluZWQgYXR0cmlidXRlcwogICAgICAgIGlmIGF0dHJzIGlzIE5vbmU6CiAgICAgICAgICAgIGF0dHJzID0gc2VsZi5fcmVzZXJ2ZWQKICAgICAgICBpdGVtcyA9IHNvcnRlZChzZWxmLml0ZW1zKCkpCiAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gaXRlbXM6CiAgICAgICAgICAgIGlmIHZhbHVlID09ICIiOgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgaWYga2V5IG5vdCBpbiBhdHRyczoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGlmIGtleSA9PSAiZXhwaXJlcyIgYW5kIGlzaW5zdGFuY2UodmFsdWUsIGludCk6CiAgICAgICAgICAgICAgICBhcHBlbmQoIiVzPSVzIiAlIChzZWxmLl9yZXNlcnZlZFtrZXldLCBfZ2V0ZGF0ZSh2YWx1ZSkpKQogICAgICAgICAgICBlbGlmIGtleSA9PSAibWF4LWFnZSIgYW5kIGlzaW5zdGFuY2UodmFsdWUsIGludCk6CiAgICAgICAgICAgICAgICBhcHBlbmQoIiVzPSVkIiAlIChzZWxmLl9yZXNlcnZlZFtrZXldLCB2YWx1ZSkpCiAgICAgICAgICAgIGVsaWYga2V5ID09ICJzZWN1cmUiOgogICAgICAgICAgICAgICAgYXBwZW5kKHN0cihzZWxmLl9yZXNlcnZlZFtrZXldKSkKICAgICAgICAgICAgZWxpZiBrZXkgPT0gImh0dHBvbmx5IjoKICAgICAgICAgICAgICAgIGFwcGVuZChzdHIoc2VsZi5fcmVzZXJ2ZWRba2V5XSkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBhcHBlbmQoIiVzPSVzIiAlIChzZWxmLl9yZXNlcnZlZFtrZXldLCB2YWx1ZSkpCgogICAgICAgICMgUmV0dXJuIHRoZSByZXN1bHQKICAgICAgICByZXR1cm4gX3NlbWlzcGFjZWpvaW4ocmVzdWx0KQoKCiMKIyBQYXR0ZXJuIGZvciBmaW5kaW5nIGNvb2tpZQojCiMgVGhpcyB1c2VkIHRvIGJlIHN0cmljdCBwYXJzaW5nIGJhc2VkIG9uIHRoZSBSRkMyMTA5IGFuZCBSRkMyMDY4CiMgc3BlY2lmaWNhdGlvbnMuICBJIGhhdmUgc2luY2UgZGlzY292ZXJlZCB0aGF0IE1TSUUgMy4weCBkb2Vzbid0CiMgZm9sbG93IHRoZSBjaGFyYWN0ZXIgcnVsZXMgb3V0bGluZWQgaW4gdGhvc2Ugc3BlY3MuICBBcyBhCiMgcmVzdWx0LCB0aGUgcGFyc2luZyBydWxlcyBoZXJlIGFyZSBsZXNzIHN0cmljdC4KIwoKX0xlZ2FsQ2hhcnNQYXR0ICA9IHIiW1x3XGQhIyUmJ35fYD48QCw6L1wkXCpcK1wtXC5cXlx8XClcKFw/XH1ce1w9XSIKX0Nvb2tpZVBhdHRlcm4gPSByZS5jb21waWxlKHIiIiIKICAgICg/eCkgICAgICAgICAgICAgICAgICAgICAgICAgICAjIFRoaXMgaXMgYSB2ZXJib3NlIHBhdHRlcm4KICAgICg/UDxrZXk+ICAgICAgICAgICAgICAgICAgICAgICAjIFN0YXJ0IG9mIGdyb3VwICdrZXknCiAgICAiIiIgKyBfTGVnYWxDaGFyc1BhdHQgKyByIiIiKz8gICAjIEFueSB3b3JkIG9mIGF0IGxlYXN0IG9uZSBsZXR0ZXIKICAgICkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIEVuZCBvZiBncm91cCAna2V5JwogICAgXHMqPVxzKiAgICAgICAgICAgICAgICAgICAgICAgICMgRXF1YWwgU2lnbgogICAgKD9QPHZhbD4gICAgICAgICAgICAgICAgICAgICAgICMgU3RhcnQgb2YgZ3JvdXAgJ3ZhbCcKICAgICIoPzpbXlxcIl18XFwuKSoiICAgICAgICAgICAgICAgICMgQW55IGRvdWJsZXF1b3RlZCBzdHJpbmcKICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgb3IKICAgIFx3ezN9LFxzW1x3XGRccy1dezksMTF9XHNbXGQ6XXs4fVxzR01UICAjIFNwZWNpYWwgY2FzZSBmb3IgImV4cGlyZXMiIGF0dHIKICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgb3IKICAgICIiIiArIF9MZWdhbENoYXJzUGF0dCArIHIiIiIqICAgICMgQW55IHdvcmQgb3IgZW1wdHkgc3RyaW5nCiAgICApICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBFbmQgb2YgZ3JvdXAgJ3ZhbCcKICAgIFxzKjs/ICAgICAgICAgICAgICAgICAgICAgICAgICAjIFByb2JhYmx5IGVuZGluZyBpbiBhIHNlbWktY29sb24KICAgICIiIiwgcmUuQVNDSUkpICAgICAgICAgICAgICAgICAjIE1heSBiZSByZW1vdmVkIGlmIHNhZmUuCgoKIyBBdCBsb25nIGxhc3QsIGhlcmUgaXMgdGhlIGNvb2tpZSBjbGFzcy4gIFVzaW5nIHRoaXMgY2xhc3MgaXMgYWxtb3N0IGp1c3QgbGlrZQojIHVzaW5nIGEgZGljdGlvbmFyeS4gIFNlZSB0aGlzIG1vZHVsZSdzIGRvY3N0cmluZyBmb3IgZXhhbXBsZSB1c2FnZS4KIwpjbGFzcyBCYXNlQ29va2llKGRpY3QpOgogICAgIiIiQSBjb250YWluZXIgY2xhc3MgZm9yIGEgc2V0IG9mIE1vcnNlbHMuIiIiCgogICAgZGVmIHZhbHVlX2RlY29kZShzZWxmLCB2YWwpOgogICAgICAgICIiInJlYWxfdmFsdWUsIGNvZGVkX3ZhbHVlID0gdmFsdWVfZGVjb2RlKFNUUklORykKICAgICAgICBDYWxsZWQgcHJpb3IgdG8gc2V0dGluZyBhIGNvb2tpZSdzIHZhbHVlIGZyb20gdGhlIG5ldHdvcmsKICAgICAgICByZXByZXNlbnRhdGlvbi4gIFRoZSBWQUxVRSBpcyB0aGUgdmFsdWUgcmVhZCBmcm9tIEhUVFAKICAgICAgICBoZWFkZXIuCiAgICAgICAgT3ZlcnJpZGUgdGhpcyBmdW5jdGlvbiB0byBtb2RpZnkgdGhlIGJlaGF2aW9yIG9mIGNvb2tpZXMuCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIHZhbCwgdmFsCgogICAgZGVmIHZhbHVlX2VuY29kZShzZWxmLCB2YWwpOgogICAgICAgICIiInJlYWxfdmFsdWUsIGNvZGVkX3ZhbHVlID0gdmFsdWVfZW5jb2RlKFZBTFVFKQogICAgICAgIENhbGxlZCBwcmlvciB0byBzZXR0aW5nIGEgY29va2llJ3MgdmFsdWUgZnJvbSB0aGUgZGljdGlvbmFyeQogICAgICAgIHJlcHJlc2VudGF0aW9uLiAgVGhlIFZBTFVFIGlzIHRoZSB2YWx1ZSBiZWluZyBhc3NpZ25lZC4KICAgICAgICBPdmVycmlkZSB0aGlzIGZ1bmN0aW9uIHRvIG1vZGlmeSB0aGUgYmVoYXZpb3Igb2YgY29va2llcy4KICAgICAgICAiIiIKICAgICAgICBzdHJ2YWwgPSBzdHIodmFsKQogICAgICAgIHJldHVybiBzdHJ2YWwsIHN0cnZhbAoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpbnB1dD1Ob25lKToKICAgICAgICBpZiBpbnB1dDoKICAgICAgICAgICAgc2VsZi5sb2FkKGlucHV0KQoKICAgIGRlZiBfX3NldChzZWxmLCBrZXksIHJlYWxfdmFsdWUsIGNvZGVkX3ZhbHVlKToKICAgICAgICAiIiJQcml2YXRlIG1ldGhvZCBmb3Igc2V0dGluZyBhIGNvb2tpZSdzIHZhbHVlIiIiCiAgICAgICAgTSA9IHNlbGYuZ2V0KGtleSwgTW9yc2VsKCkpCiAgICAgICAgTS5zZXQoa2V5LCByZWFsX3ZhbHVlLCBjb2RlZF92YWx1ZSkKICAgICAgICBkaWN0Ll9fc2V0aXRlbV9fKHNlbGYsIGtleSwgTSkKCiAgICBkZWYgX19zZXRpdGVtX18oc2VsZiwga2V5LCB2YWx1ZSk6CiAgICAgICAgIiIiRGljdGlvbmFyeSBzdHlsZSBhc3NpZ25tZW50LiIiIgogICAgICAgIHJ2YWwsIGN2YWwgPSBzZWxmLnZhbHVlX2VuY29kZSh2YWx1ZSkKICAgICAgICBzZWxmLl9fc2V0KGtleSwgcnZhbCwgY3ZhbCkKCiAgICBkZWYgb3V0cHV0KHNlbGYsIGF0dHJzPU5vbmUsIGhlYWRlcj0iU2V0LUNvb2tpZToiLCBzZXA9IlwwMTVcMDEyIik6CiAgICAgICAgIiIiUmV0dXJuIGEgc3RyaW5nIHN1aXRhYmxlIGZvciBIVFRQLiIiIgogICAgICAgIHJlc3VsdCA9IFtdCiAgICAgICAgaXRlbXMgPSBzb3J0ZWQoc2VsZi5pdGVtcygpKQogICAgICAgIGZvciBrZXksIHZhbHVlIGluIGl0ZW1zOgogICAgICAgICAgICByZXN1bHQuYXBwZW5kKHZhbHVlLm91dHB1dChhdHRycywgaGVhZGVyKSkKICAgICAgICByZXR1cm4gc2VwLmpvaW4ocmVzdWx0KQoKICAgIF9fc3RyX18gPSBvdXRwdXQKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgbCA9IFtdCiAgICAgICAgaXRlbXMgPSBzb3J0ZWQoc2VsZi5pdGVtcygpKQogICAgICAgIGZvciBrZXksIHZhbHVlIGluIGl0ZW1zOgogICAgICAgICAgICBsLmFwcGVuZCgnJXM9JXMnICUgKGtleSwgcmVwcih2YWx1ZS52YWx1ZSkpKQogICAgICAgIHJldHVybiAnPCVzOiAlcz4nICUgKHNlbGYuX19jbGFzc19fLl9fbmFtZV9fLCBfc3BhY2Vqb2luKGwpKQoKICAgIGRlZiBqc19vdXRwdXQoc2VsZiwgYXR0cnM9Tm9uZSk6CiAgICAgICAgIiIiUmV0dXJuIGEgc3RyaW5nIHN1aXRhYmxlIGZvciBKYXZhU2NyaXB0LiIiIgogICAgICAgIHJlc3VsdCA9IFtdCiAgICAgICAgaXRlbXMgPSBzb3J0ZWQoc2VsZi5pdGVtcygpKQogICAgICAgIGZvciBrZXksIHZhbHVlIGluIGl0ZW1zOgogICAgICAgICAgICByZXN1bHQuYXBwZW5kKHZhbHVlLmpzX291dHB1dChhdHRycykpCiAgICAgICAgcmV0dXJuIF9udWxsam9pbihyZXN1bHQpCgogICAgZGVmIGxvYWQoc2VsZiwgcmF3ZGF0YSk6CiAgICAgICAgIiIiTG9hZCBjb29raWVzIGZyb20gYSBzdHJpbmcgKHByZXN1bWFibHkgSFRUUF9DT09LSUUpIG9yCiAgICAgICAgZnJvbSBhIGRpY3Rpb25hcnkuICBMb2FkaW5nIGNvb2tpZXMgZnJvbSBhIGRpY3Rpb25hcnkgJ2QnCiAgICAgICAgaXMgZXF1aXZhbGVudCB0byBjYWxsaW5nOgogICAgICAgICAgICBtYXAoQ29va2llLl9fc2V0aXRlbV9fLCBkLmtleXMoKSwgZC52YWx1ZXMoKSkKICAgICAgICAiIiIKICAgICAgICBpZiBpc2luc3RhbmNlKHJhd2RhdGEsIHN0cik6CiAgICAgICAgICAgIHNlbGYuX19wYXJzZV9zdHJpbmcocmF3ZGF0YSkKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIHNlbGYudXBkYXRlKCkgd291bGRuJ3QgY2FsbCBvdXIgY3VzdG9tIF9fc2V0aXRlbV9fCiAgICAgICAgICAgIGZvciBrZXksIHZhbHVlIGluIHJhd2RhdGEuaXRlbXMoKToKICAgICAgICAgICAgICAgIHNlbGZba2V5XSA9IHZhbHVlCiAgICAgICAgcmV0dXJuCgogICAgZGVmIF9fcGFyc2Vfc3RyaW5nKHNlbGYsIHN0ciwgcGF0dD1fQ29va2llUGF0dGVybik6CiAgICAgICAgaSA9IDAgICAgICAgICAgICAjIE91ciBzdGFydGluZyBwb2ludAogICAgICAgIG4gPSBsZW4oc3RyKSAgICAgIyBMZW5ndGggb2Ygc3RyaW5nCiAgICAgICAgTSA9IE5vbmUgICAgICAgICAjIGN1cnJlbnQgbW9yc2VsCgogICAgICAgIHdoaWxlIDAgPD0gaSA8IG46CiAgICAgICAgICAgICMgU3RhcnQgbG9va2luZyBmb3IgYSBjb29raWUKICAgICAgICAgICAgbWF0Y2ggPSBwYXR0LnNlYXJjaChzdHIsIGkpCiAgICAgICAgICAgIGlmIG5vdCBtYXRjaDoKICAgICAgICAgICAgICAgICMgTm8gbW9yZSBjb29raWVzCiAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICAgICAga2V5LCB2YWx1ZSA9IG1hdGNoLmdyb3VwKCJrZXkiKSwgbWF0Y2guZ3JvdXAoInZhbCIpCiAgICAgICAgICAgIGkgPSBtYXRjaC5lbmQoMCkKCiAgICAgICAgICAgICMgUGFyc2UgdGhlIGtleSwgdmFsdWUgaW4gY2FzZSBpdCdzIG1ldGFpbmZvCiAgICAgICAgICAgIGlmIGtleVswXSA9PSAiJCI6CiAgICAgICAgICAgICAgICAjIFdlIGlnbm9yZSBhdHRyaWJ1dGVzIHdoaWNoIHBlcnRhaW4gdG8gdGhlIGNvb2tpZQogICAgICAgICAgICAgICAgIyBtZWNoYW5pc20gYXMgYSB3aG9sZS4gIFNlZSBSRkMgMjEwOS4KICAgICAgICAgICAgICAgICMgKERvZXMgYW55b25lIGNhcmU/KQogICAgICAgICAgICAgICAgaWYgTToKICAgICAgICAgICAgICAgICAgICBNW2tleVsxOl1dID0gdmFsdWUKICAgICAgICAgICAgZWxpZiBrZXkubG93ZXIoKSBpbiBNb3JzZWwuX3Jlc2VydmVkOgogICAgICAgICAgICAgICAgaWYgTToKICAgICAgICAgICAgICAgICAgICBNW2tleV0gPSBfdW5xdW90ZSh2YWx1ZSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJ2YWwsIGN2YWwgPSBzZWxmLnZhbHVlX2RlY29kZSh2YWx1ZSkKICAgICAgICAgICAgICAgIHNlbGYuX19zZXQoa2V5LCBydmFsLCBjdmFsKQogICAgICAgICAgICAgICAgTSA9IHNlbGZba2V5XQoKCmNsYXNzIFNpbXBsZUNvb2tpZShCYXNlQ29va2llKToKICAgICIiIgogICAgU2ltcGxlQ29va2llIHN1cHBvcnRzIHN0cmluZ3MgYXMgY29va2llIHZhbHVlcy4gIFdoZW4gc2V0dGluZwogICAgdGhlIHZhbHVlIHVzaW5nIHRoZSBkaWN0aW9uYXJ5IGFzc2lnbm1lbnQgbm90YXRpb24sIFNpbXBsZUNvb2tpZQogICAgY2FsbHMgdGhlIGJ1aWx0aW4gc3RyKCkgdG8gY29udmVydCB0aGUgdmFsdWUgdG8gYSBzdHJpbmcuICBWYWx1ZXMKICAgIHJlY2VpdmVkIGZyb20gSFRUUCBhcmUga2VwdCBhcyBzdHJpbmdzLgogICAgIiIiCiAgICBkZWYgdmFsdWVfZGVjb2RlKHNlbGYsIHZhbCk6CiAgICAgICAgcmV0dXJuIF91bnF1b3RlKHZhbCksIHZhbAoKICAgIGRlZiB2YWx1ZV9lbmNvZGUoc2VsZiwgdmFsKToKICAgICAgICBzdHJ2YWwgPSBzdHIodmFsKQogICAgICAgIHJldHVybiBzdHJ2YWwsIF9xdW90ZShzdHJ2YWwpCg==',
'/Lib/http/__init__.py':'',
'/Lib/importlib/abc.py':'IiIiQWJzdHJhY3QgYmFzZSBjbGFzc2VzIHJlbGF0ZWQgdG8gaW1wb3J0LiIiIgpmcm9tIC4gaW1wb3J0IF9ib290c3RyYXAKZnJvbSAuIGltcG9ydCBtYWNoaW5lcnkKdHJ5OgogICAgaW1wb3J0IF9mcm96ZW5faW1wb3J0bGliCmV4Y2VwdCBJbXBvcnRFcnJvciBhcyBleGM6CiAgICBpZiBleGMubmFtZSAhPSAnX2Zyb3plbl9pbXBvcnRsaWInOgogICAgICAgIHJhaXNlCiAgICBfZnJvemVuX2ltcG9ydGxpYiA9IE5vbmUKaW1wb3J0IGFiYwppbXBvcnQgaW1wCmltcG9ydCBtYXJzaGFsCmltcG9ydCBzeXMKaW1wb3J0IHRva2VuaXplCmltcG9ydCB3YXJuaW5ncwoKCmRlZiBfcmVnaXN0ZXIoYWJzdHJhY3RfY2xzLCAqY2xhc3Nlcyk6CiAgICBmb3IgY2xzIGluIGNsYXNzZXM6CiAgICAgICAgYWJzdHJhY3RfY2xzLnJlZ2lzdGVyKGNscykKICAgICAgICBpZiBfZnJvemVuX2ltcG9ydGxpYiBpcyBub3QgTm9uZToKICAgICAgICAgICAgZnJvemVuX2NscyA9IGdldGF0dHIoX2Zyb3plbl9pbXBvcnRsaWIsIGNscy5fX25hbWVfXykKICAgICAgICAgICAgYWJzdHJhY3RfY2xzLnJlZ2lzdGVyKGZyb3plbl9jbHMpCgoKY2xhc3MgRmluZGVyKG1ldGFjbGFzcz1hYmMuQUJDTWV0YSk6CgogICAgIiIiTGVnYWN5IGFic3RyYWN0IGJhc2UgY2xhc3MgZm9yIGltcG9ydCBmaW5kZXJzLgoKICAgIEl0IG1heSBiZSBzdWJjbGFzc2VkIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbGVnYWN5IHRoaXJkIHBhcnR5CiAgICByZWltcGxlbWVudGF0aW9ucyBvZiB0aGUgaW1wb3J0IHN5c3RlbS4gIE90aGVyd2lzZSwgZmluZGVyCiAgICBpbXBsZW1lbnRhdGlvbnMgc2hvdWxkIGRlcml2ZSBmcm9tIHRoZSBtb3JlIHNwZWNpZmljIE1ldGFQYXRoRmluZGVyCiAgICBvciBQYXRoRW50cnlGaW5kZXIgQUJDcy4KICAgICIiIgoKICAgIEBhYmMuYWJzdHJhY3RtZXRob2QKICAgIGRlZiBmaW5kX21vZHVsZShzZWxmLCBmdWxsbmFtZSwgcGF0aD1Ob25lKToKICAgICAgICAiIiJBbiBhYnN0cmFjdCBtZXRob2QgdGhhdCBzaG91bGQgZmluZCBhIG1vZHVsZS4KICAgICAgICBUaGUgZnVsbG5hbWUgaXMgYSBzdHIgYW5kIHRoZSBvcHRpb25hbCBwYXRoIGlzIGEgc3RyIG9yIE5vbmUuCiAgICAgICAgUmV0dXJucyBhIExvYWRlciBvYmplY3QuCiAgICAgICAgIiIiCiAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcgoKCmNsYXNzIE1ldGFQYXRoRmluZGVyKEZpbmRlcik6CgogICAgIiIiQWJzdHJhY3QgYmFzZSBjbGFzcyBmb3IgaW1wb3J0IGZpbmRlcnMgb24gc3lzLm1ldGFfcGF0aC4iIiIKCiAgICBAYWJjLmFic3RyYWN0bWV0aG9kCiAgICBkZWYgZmluZF9tb2R1bGUoc2VsZiwgZnVsbG5hbWUsIHBhdGgpOgogICAgICAgICIiIkFic3RyYWN0IG1ldGhvZCB3aGljaCwgd2hlbiBpbXBsZW1lbnRlZCwgc2hvdWxkIGZpbmQgYSBtb2R1bGUuCiAgICAgICAgVGhlIGZ1bGxuYW1lIGlzIGEgc3RyIGFuZCB0aGUgcGF0aCBpcyBhIHN0ciBvciBOb25lLgogICAgICAgIFJldHVybnMgYSBMb2FkZXIgb2JqZWN0LgogICAgICAgICIiIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IKCiAgICBkZWYgaW52YWxpZGF0ZV9jYWNoZXMoc2VsZik6CiAgICAgICAgIiIiQW4gb3B0aW9uYWwgbWV0aG9kIGZvciBjbGVhcmluZyB0aGUgZmluZGVyJ3MgY2FjaGUsIGlmIGFueS4KICAgICAgICBUaGlzIG1ldGhvZCBpcyB1c2VkIGJ5IGltcG9ydGxpYi5pbnZhbGlkYXRlX2NhY2hlcygpLgogICAgICAgICIiIgogICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKX3JlZ2lzdGVyKE1ldGFQYXRoRmluZGVyLCBtYWNoaW5lcnkuQnVpbHRpbkltcG9ydGVyLCBtYWNoaW5lcnkuRnJvemVuSW1wb3J0ZXIsCiAgICAgICAgICBtYWNoaW5lcnkuUGF0aEZpbmRlciwgbWFjaGluZXJ5LldpbmRvd3NSZWdpc3RyeUZpbmRlcikKCgpjbGFzcyBQYXRoRW50cnlGaW5kZXIoRmluZGVyKToKCiAgICAiIiJBYnN0cmFjdCBiYXNlIGNsYXNzIGZvciBwYXRoIGVudHJ5IGZpbmRlcnMgdXNlZCBieSBQYXRoRmluZGVyLiIiIgoKICAgIEBhYmMuYWJzdHJhY3RtZXRob2QKICAgIGRlZiBmaW5kX2xvYWRlcihzZWxmLCBmdWxsbmFtZSk6CiAgICAgICAgIiIiQWJzdHJhY3QgbWV0aG9kIHdoaWNoLCB3aGVuIGltcGxlbWVudGVkLCByZXR1cm5zIGEgbW9kdWxlIGxvYWRlci4KICAgICAgICBUaGUgZnVsbG5hbWUgaXMgYSBzdHIuICBSZXR1cm5zIGEgMi10dXBsZSBvZiAoTG9hZGVyLCBwb3J0aW9uKSB3aGVyZQogICAgICAgIHBvcnRpb24gaXMgYSBzZXF1ZW5jZSBvZiBmaWxlIHN5c3RlbSBsb2NhdGlvbnMgY29udHJpYnV0aW5nIHRvIHBhcnQgb2YKICAgICAgICBhIG5hbWVzcGFjZSBwYWNrYWdlLiAgVGhlIHNlcXVlbmNlIG1heSBiZSBlbXB0eSBhbmQgdGhlIGxvYWRlciBtYXkgYmUKICAgICAgICBOb25lLgogICAgICAgICIiIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IKCiAgICBmaW5kX21vZHVsZSA9IF9ib290c3RyYXAuX2ZpbmRfbW9kdWxlX3NoaW0KCiAgICBkZWYgaW52YWxpZGF0ZV9jYWNoZXMoc2VsZik6CiAgICAgICAgIiIiQW4gb3B0aW9uYWwgbWV0aG9kIGZvciBjbGVhcmluZyB0aGUgZmluZGVyJ3MgY2FjaGUsIGlmIGFueS4KICAgICAgICBUaGlzIG1ldGhvZCBpcyB1c2VkIGJ5IFBhdGhGaW5kZXIuaW52YWxpZGF0ZV9jYWNoZXMoKS4KICAgICAgICAiIiIKICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCl9yZWdpc3RlcihQYXRoRW50cnlGaW5kZXIsIG1hY2hpbmVyeS5GaWxlRmluZGVyKQoKCmNsYXNzIExvYWRlcihtZXRhY2xhc3M9YWJjLkFCQ01ldGEpOgoKICAgICIiIkFic3RyYWN0IGJhc2UgY2xhc3MgZm9yIGltcG9ydCBsb2FkZXJzLiIiIgoKICAgIEBhYmMuYWJzdHJhY3RtZXRob2QKICAgIGRlZiBsb2FkX21vZHVsZShzZWxmLCBmdWxsbmFtZSk6CiAgICAgICAgIiIiQWJzdHJhY3QgbWV0aG9kIHdoaWNoIHdoZW4gaW1wbGVtZW50ZWQgc2hvdWxkIGxvYWQgYSBtb2R1bGUuCiAgICAgICAgVGhlIGZ1bGxuYW1lIGlzIGEgc3RyLiIiIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IKCiAgICBAYWJjLmFic3RyYWN0bWV0aG9kCiAgICBkZWYgbW9kdWxlX3JlcHIoc2VsZiwgbW9kdWxlKToKICAgICAgICAiIiJBYnN0cmFjdCBtZXRob2Qgd2hpY2ggd2hlbiBpbXBsZW1lbnRlZCBjYWxjdWxhdGVzIGFuZCByZXR1cm5zIHRoZQogICAgICAgIGdpdmVuIG1vZHVsZSdzIHJlcHIuIiIiCiAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcgoKCmNsYXNzIFJlc291cmNlTG9hZGVyKExvYWRlcik6CgogICAgIiIiQWJzdHJhY3QgYmFzZSBjbGFzcyBmb3IgbG9hZGVycyB3aGljaCBjYW4gcmV0dXJuIGRhdGEgZnJvbSB0aGVpcgogICAgYmFjay1lbmQgc3RvcmFnZS4KCiAgICBUaGlzIEFCQyByZXByZXNlbnRzIG9uZSBvZiB0aGUgb3B0aW9uYWwgcHJvdG9jb2xzIHNwZWNpZmllZCBieSBQRVAgMzAyLgoKICAgICIiIgoKICAgIEBhYmMuYWJzdHJhY3RtZXRob2QKICAgIGRlZiBnZXRfZGF0YShzZWxmLCBwYXRoKToKICAgICAgICAiIiJBYnN0cmFjdCBtZXRob2Qgd2hpY2ggd2hlbiBpbXBsZW1lbnRlZCBzaG91bGQgcmV0dXJuIHRoZSBieXRlcyBmb3IKICAgICAgICB0aGUgc3BlY2lmaWVkIHBhdGguICBUaGUgcGF0aCBtdXN0IGJlIGEgc3RyLiIiIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IKCgpjbGFzcyBJbnNwZWN0TG9hZGVyKExvYWRlcik6CgogICAgIiIiQWJzdHJhY3QgYmFzZSBjbGFzcyBmb3IgbG9hZGVycyB3aGljaCBzdXBwb3J0IGluc3BlY3Rpb24gYWJvdXQgdGhlCiAgICBtb2R1bGVzIHRoZXkgY2FuIGxvYWQuCgogICAgVGhpcyBBQkMgcmVwcmVzZW50cyBvbmUgb2YgdGhlIG9wdGlvbmFsIHByb3RvY29scyBzcGVjaWZpZWQgYnkgUEVQIDMwMi4KCiAgICAiIiIKCiAgICBAYWJjLmFic3RyYWN0bWV0aG9kCiAgICBkZWYgaXNfcGFja2FnZShzZWxmLCBmdWxsbmFtZSk6CiAgICAgICAgIiIiQWJzdHJhY3QgbWV0aG9kIHdoaWNoIHdoZW4gaW1wbGVtZW50ZWQgc2hvdWxkIHJldHVybiB3aGV0aGVyIHRoZQogICAgICAgIG1vZHVsZSBpcyBhIHBhY2thZ2UuICBUaGUgZnVsbG5hbWUgaXMgYSBzdHIuICBSZXR1cm5zIGEgYm9vbC4iIiIKICAgICAgICByYWlzZSBOb3RJbXBsZW1lbnRlZEVycm9yCgogICAgQGFiYy5hYnN0cmFjdG1ldGhvZAogICAgZGVmIGdldF9jb2RlKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICAiIiJBYnN0cmFjdCBtZXRob2Qgd2hpY2ggd2hlbiBpbXBsZW1lbnRlZCBzaG91bGQgcmV0dXJuIHRoZSBjb2RlIG9iamVjdAogICAgICAgIGZvciB0aGUgbW9kdWxlLiAgVGhlIGZ1bGxuYW1lIGlzIGEgc3RyLiAgUmV0dXJucyBhIHR5cGVzLkNvZGVUeXBlLiIiIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IKCiAgICBAYWJjLmFic3RyYWN0bWV0aG9kCiAgICBkZWYgZ2V0X3NvdXJjZShzZWxmLCBmdWxsbmFtZSk6CiAgICAgICAgIiIiQWJzdHJhY3QgbWV0aG9kIHdoaWNoIHNob3VsZCByZXR1cm4gdGhlIHNvdXJjZSBjb2RlIGZvciB0aGUKICAgICAgICBtb2R1bGUuICBUaGUgZnVsbG5hbWUgaXMgYSBzdHIuICBSZXR1cm5zIGEgc3RyLiIiIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IKCl9yZWdpc3RlcihJbnNwZWN0TG9hZGVyLCBtYWNoaW5lcnkuQnVpbHRpbkltcG9ydGVyLCBtYWNoaW5lcnkuRnJvemVuSW1wb3J0ZXIsCiAgICAgICAgICAgIG1hY2hpbmVyeS5FeHRlbnNpb25GaWxlTG9hZGVyKQoKCmNsYXNzIEV4ZWN1dGlvbkxvYWRlcihJbnNwZWN0TG9hZGVyKToKCiAgICAiIiJBYnN0cmFjdCBiYXNlIGNsYXNzIGZvciBsb2FkZXJzIHRoYXQgd2lzaCB0byBzdXBwb3J0IHRoZSBleGVjdXRpb24gb2YKICAgIG1vZHVsZXMgYXMgc2NyaXB0cy4KCiAgICBUaGlzIEFCQyByZXByZXNlbnRzIG9uZSBvZiB0aGUgb3B0aW9uYWwgcHJvdG9jb2xzIHNwZWNpZmllZCBpbiBQRVAgMzAyLgoKICAgICIiIgoKICAgIEBhYmMuYWJzdHJhY3RtZXRob2QKICAgIGRlZiBnZXRfZmlsZW5hbWUoc2VsZiwgZnVsbG5hbWUpOgogICAgICAgICIiIkFic3RyYWN0IG1ldGhvZCB3aGljaCBzaG91bGQgcmV0dXJuIHRoZSB2YWx1ZSB0aGF0IF9fZmlsZV9fIGlzIHRvIGJlCiAgICAgICAgc2V0IHRvLiIiIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IKCgpjbGFzcyBGaWxlTG9hZGVyKF9ib290c3RyYXAuRmlsZUxvYWRlciwgUmVzb3VyY2VMb2FkZXIsIEV4ZWN1dGlvbkxvYWRlcik6CgogICAgIiIiQWJzdHJhY3QgYmFzZSBjbGFzcyBwYXJ0aWFsbHkgaW1wbGVtZW50aW5nIHRoZSBSZXNvdXJjZUxvYWRlciBhbmQKICAgIEV4ZWN1dGlvbkxvYWRlciBBQkNzLiIiIgoKX3JlZ2lzdGVyKEZpbGVMb2FkZXIsIG1hY2hpbmVyeS5Tb3VyY2VGaWxlTG9hZGVyLAogICAgICAgICAgICBtYWNoaW5lcnkuU291cmNlbGVzc0ZpbGVMb2FkZXIpCgoKY2xhc3MgU291cmNlTG9hZGVyKF9ib290c3RyYXAuU291cmNlTG9hZGVyLCBSZXNvdXJjZUxvYWRlciwgRXhlY3V0aW9uTG9hZGVyKToKCiAgICAiIiJBYnN0cmFjdCBiYXNlIGNsYXNzIGZvciBsb2FkaW5nIHNvdXJjZSBjb2RlIChhbmQgb3B0aW9uYWxseSBhbnkKICAgIGNvcnJlc3BvbmRpbmcgYnl0ZWNvZGUpLgoKICAgIFRvIHN1cHBvcnQgbG9hZGluZyBmcm9tIHNvdXJjZSBjb2RlLCB0aGUgYWJzdHJhY3RtZXRob2RzIGluaGVyaXRlZCBmcm9tCiAgICBSZXNvdXJjZUxvYWRlciBhbmQgRXhlY3V0aW9uTG9hZGVyIG5lZWQgdG8gYmUgaW1wbGVtZW50ZWQuIFRvIGFsc28gc3VwcG9ydAogICAgbG9hZGluZyBmcm9tIGJ5dGVjb2RlLCB0aGUgb3B0aW9uYWwgbWV0aG9kcyBzcGVjaWZpZWQgZGlyZWN0bHkgYnkgdGhpcyBBQkMKICAgIGlzIHJlcXVpcmVkLgoKICAgIEluaGVyaXRlZCBhYnN0cmFjdG1ldGhvZHMgbm90IGltcGxlbWVudGVkIGluIHRoaXMgQUJDOgoKICAgICAgICAqIFJlc291cmNlTG9hZGVyLmdldF9kYXRhCiAgICAgICAgKiBFeGVjdXRpb25Mb2FkZXIuZ2V0X2ZpbGVuYW1lCgogICAgIiIiCgogICAgZGVmIHBhdGhfbXRpbWUoc2VsZiwgcGF0aCk6CiAgICAgICAgIiIiUmV0dXJuIHRoZSAoaW50KSBtb2RpZmljYXRpb24gdGltZSBmb3IgdGhlIHBhdGggKHN0cikuIiIiCiAgICAgICAgaWYgc2VsZi5wYXRoX3N0YXRzLl9fZnVuY19fIGlzIFNvdXJjZUxvYWRlci5wYXRoX3N0YXRzOgogICAgICAgICAgICByYWlzZSBOb3RJbXBsZW1lbnRlZEVycm9yCiAgICAgICAgcmV0dXJuIGludChzZWxmLnBhdGhfc3RhdHMocGF0aClbJ210aW1lJ10pCgogICAgZGVmIHBhdGhfc3RhdHMoc2VsZiwgcGF0aCk6CiAgICAgICAgIiIiUmV0dXJuIGEgbWV0YWRhdGEgZGljdCBmb3IgdGhlIHNvdXJjZSBwb2ludGVkIHRvIGJ5IHRoZSBwYXRoIChzdHIpLgogICAgICAgIFBvc3NpYmxlIGtleXM6CiAgICAgICAgLSAnbXRpbWUnIChtYW5kYXRvcnkpIGlzIHRoZSBudW1lcmljIHRpbWVzdGFtcCBvZiBsYXN0IHNvdXJjZQogICAgICAgICAgY29kZSBtb2RpZmljYXRpb247CiAgICAgICAgLSAnc2l6ZScgKG9wdGlvbmFsKSBpcyB0aGUgc2l6ZSBpbiBieXRlcyBvZiB0aGUgc291cmNlIGNvZGUuCiAgICAgICAgIiIiCiAgICAgICAgaWYgc2VsZi5wYXRoX210aW1lLl9fZnVuY19fIGlzIFNvdXJjZUxvYWRlci5wYXRoX210aW1lOgogICAgICAgICAgICByYWlzZSBOb3RJbXBsZW1lbnRlZEVycm9yCiAgICAgICAgcmV0dXJuIHsnbXRpbWUnOiBzZWxmLnBhdGhfbXRpbWUocGF0aCl9CgogICAgZGVmIHNldF9kYXRhKHNlbGYsIHBhdGgsIGRhdGEpOgogICAgICAgICIiIldyaXRlIHRoZSBieXRlcyB0byB0aGUgcGF0aCAoaWYgcG9zc2libGUpLgoKICAgICAgICBBY2NlcHRzIGEgc3RyIHBhdGggYW5kIGRhdGEgYXMgYnl0ZXMuCgogICAgICAgIEFueSBuZWVkZWQgaW50ZXJtZWRpYXJ5IGRpcmVjdG9yaWVzIGFyZSB0byBiZSBjcmVhdGVkLiBJZiBmb3Igc29tZQogICAgICAgIHJlYXNvbiB0aGUgZmlsZSBjYW5ub3QgYmUgd3JpdHRlbiBiZWNhdXNlIG9mIHBlcm1pc3Npb25zLCBmYWlsCiAgICAgICAgc2lsZW50bHkuCgogICAgICAgICIiIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IKCl9yZWdpc3RlcihTb3VyY2VMb2FkZXIsIG1hY2hpbmVyeS5Tb3VyY2VGaWxlTG9hZGVyKQoKY2xhc3MgUHlMb2FkZXIoU291cmNlTG9hZGVyKToKCiAgICAiIiJJbXBsZW1lbnQgdGhlIGRlcHJlY2F0ZWQgUHlMb2FkZXIgQUJDIGluIHRlcm1zIG9mIFNvdXJjZUxvYWRlci4KCiAgICBUaGlzIGNsYXNzIGhhcyBiZWVuIGRlcHJlY2F0ZWQhIEl0IGlzIHNsYXRlZCBmb3IgcmVtb3ZhbCBpbiBQeXRob24gMy40LgogICAgSWYgY29tcGF0aWJpbGl0eSB3aXRoIFB5dGhvbiAzLjEgaXMgbm90IG5lZWRlZCB0aGVuIGltcGxlbWVudCB0aGUKICAgIFNvdXJjZUxvYWRlciBBQkMgaW5zdGVhZCBvZiB0aGlzIGNsYXNzLiBJZiBQeXRob24gMy4xIGNvbXBhdGliaWxpdHkgaXMKICAgIG5lZWRlZCwgdGhlbiB1c2UgdGhlIGZvbGxvd2luZyBpZGlvbSB0byBoYXZlIGEgc2luZ2xlIGNsYXNzIHRoYXQgaXMKICAgIGNvbXBhdGlibGUgd2l0aCBQeXRob24gMy4xIG9ud2FyZHM6OgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGZyb20gaW1wb3J0bGliLmFiYyBpbXBvcnQgU291cmNlTG9hZGVyCiAgICAgICAgZXhjZXB0IEltcG9ydEVycm9yOgogICAgICAgICAgICBmcm9tIGltcG9ydGxpYi5hYmMgaW1wb3J0IFB5TG9hZGVyIGFzIFNvdXJjZUxvYWRlcgoKCiAgICAgICAgY2xhc3MgQ3VzdG9tTG9hZGVyKFNvdXJjZUxvYWRlcik6CiAgICAgICAgICAgIGRlZiBnZXRfZmlsZW5hbWUoc2VsZiwgZnVsbG5hbWUpOgogICAgICAgICAgICAgICAgIyBJbXBsZW1lbnQgLi4uCgogICAgICAgICAgICBkZWYgc291cmNlX3BhdGgoc2VsZiwgZnVsbG5hbWUpOgogICAgICAgICAgICAgICAgJycnSW1wbGVtZW50IHNvdXJjZV9wYXRoIGluIHRlcm1zIG9mIGdldF9maWxlbmFtZS4nJycKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5nZXRfZmlsZW5hbWUoZnVsbG5hbWUpCiAgICAgICAgICAgICAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5vbmUKCiAgICAgICAgICAgIGRlZiBpc19wYWNrYWdlKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICAgICAgICAgIGZpbGVuYW1lID0gb3MucGF0aC5iYXNlbmFtZShzZWxmLmdldF9maWxlbmFtZShmdWxsbmFtZSkpCiAgICAgICAgICAgICAgICByZXR1cm4gb3MucGF0aC5zcGxpdGV4dChmaWxlbmFtZSlbMF0gPT0gJ19faW5pdF9fJwoKICAgICIiIgoKICAgIEBhYmMuYWJzdHJhY3RtZXRob2QKICAgIGRlZiBpc19wYWNrYWdlKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICByYWlzZSBOb3RJbXBsZW1lbnRlZEVycm9yCgogICAgQGFiYy5hYnN0cmFjdG1ldGhvZAogICAgZGVmIHNvdXJjZV9wYXRoKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICAiIiJBYnN0cmFjdCBtZXRob2QuICBBY2NlcHRzIGEgc3RyIG1vZHVsZSBuYW1lIGFuZCByZXR1cm5zIHRoZSBwYXRoIHRvCiAgICAgICAgdGhlIHNvdXJjZSBjb2RlIGZvciB0aGUgbW9kdWxlLiIiIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IKCiAgICBkZWYgZ2V0X2ZpbGVuYW1lKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICAiIiJJbXBsZW1lbnQgZ2V0X2ZpbGVuYW1lIGluIHRlcm1zIG9mIHNvdXJjZV9wYXRoLgoKICAgICAgICBBcyBnZXRfZmlsZW5hbWUgc2hvdWxkIG9ubHkgcmV0dXJuIGEgc291cmNlIGZpbGUgcGF0aCB0aGVyZSBpcyBubwogICAgICAgIGNoYW5jZSBvZiB0aGUgcGF0aCBub3QgZXhpc3RpbmcgYnV0IGxvYWRpbmcgc3RpbGwgYmVpbmcgcG9zc2libGUsIHNvCiAgICAgICAgSW1wb3J0RXJyb3Igc2hvdWxkIHByb3BhZ2F0ZSBpbnN0ZWFkIG9mIGJlaW5nIHR1cm5lZCBpbnRvIHJldHVybmluZwogICAgICAgIE5vbmUuCgogICAgICAgICIiIgogICAgICAgIHdhcm5pbmdzLndhcm4oImltcG9ydGxpYi5hYmMuUHlMb2FkZXIgaXMgZGVwcmVjYXRlZCBhbmQgaXMgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgInNsYXRlZCBmb3IgcmVtb3ZhbCBpbiBQeXRob24gMy40OyAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidXNlIFNvdXJjZUxvYWRlciBpbnN0ZWFkLiAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU2VlIHRoZSBpbXBvcnRsaWIgZG9jdW1lbnRhdGlvbiBvbiBob3cgdG8gYmUgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgImNvbXBhdGlibGUgd2l0aCBQeXRob24gMy4xIG9ud2FyZHMuIiwKICAgICAgICAgICAgICAgICAgICAgICAgRGVwcmVjYXRpb25XYXJuaW5nKQogICAgICAgIHBhdGggPSBzZWxmLnNvdXJjZV9wYXRoKGZ1bGxuYW1lKQogICAgICAgIGlmIHBhdGggaXMgTm9uZToKICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IobmFtZT1mdWxsbmFtZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gcGF0aAoKCmNsYXNzIFB5UHljTG9hZGVyKFB5TG9hZGVyKToKCiAgICAiIiJBYnN0cmFjdCBiYXNlIGNsYXNzIHRvIGFzc2lzdCBpbiBsb2FkaW5nIHNvdXJjZSBhbmQgYnl0ZWNvZGUgYnkKICAgIHJlcXVpcmluZyBvbmx5IGJhY2stZW5kIHN0b3JhZ2UgbWV0aG9kcyB0byBiZSBpbXBsZW1lbnRlZC4KCiAgICBUaGlzIGNsYXNzIGhhcyBiZWVuIGRlcHJlY2F0ZWQhIFJlbW92YWwgaXMgc2xhdGVkIGZvciBQeXRob24gMy40LiBJbXBsZW1lbnQKICAgIHRoZSBTb3VyY2VMb2FkZXIgQUJDIGluc3RlYWQuIElmIFB5dGhvbiAzLjEgY29tcGF0aWJpbGl0eSBpcyBuZWVkZWQsIHNlZQogICAgUHlMb2FkZXIuCgogICAgVGhlIG1ldGhvZHMgZ2V0X2NvZGUsIGdldF9zb3VyY2UsIGFuZCBsb2FkX21vZHVsZSBhcmUgaW1wbGVtZW50ZWQgZm9yIHRoZQogICAgdXNlci4KCiAgICAiIiIKCiAgICBkZWYgZ2V0X2ZpbGVuYW1lKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICAiIiJSZXR1cm4gdGhlIHNvdXJjZSBvciBieXRlY29kZSBmaWxlIHBhdGguIiIiCiAgICAgICAgcGF0aCA9IHNlbGYuc291cmNlX3BhdGgoZnVsbG5hbWUpCiAgICAgICAgaWYgcGF0aCBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmV0dXJuIHBhdGgKICAgICAgICBwYXRoID0gc2VsZi5ieXRlY29kZV9wYXRoKGZ1bGxuYW1lKQogICAgICAgIGlmIHBhdGggaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJldHVybiBwYXRoCiAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IoIm5vIHNvdXJjZSBvciBieXRlY29kZSBwYXRoIGF2YWlsYWJsZSBmb3IgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgInswIXJ9Ii5mb3JtYXQoZnVsbG5hbWUpLCBuYW1lPWZ1bGxuYW1lKQoKICAgIGRlZiBnZXRfY29kZShzZWxmLCBmdWxsbmFtZSk6CiAgICAgICAgIiIiR2V0IGEgY29kZSBvYmplY3QgZnJvbSBzb3VyY2Ugb3IgYnl0ZWNvZGUuIiIiCiAgICAgICAgd2FybmluZ3Mud2FybigiaW1wb3J0bGliLmFiYy5QeVB5Y0xvYWRlciBpcyBkZXByZWNhdGVkIGFuZCBzbGF0ZWQgZm9yICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJyZW1vdmFsIGluIFB5dGhvbiAzLjQ7IHVzZSBTb3VyY2VMb2FkZXIgaW5zdGVhZC4gIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIklmIFB5dGhvbiAzLjEgY29tcGF0aWJpbGl0eSBpcyByZXF1aXJlZCwgc2VlIHRoZSAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibGF0ZXN0IGRvY3VtZW50YXRpb24gZm9yIFB5TG9hZGVyLiIsCiAgICAgICAgICAgICAgICAgICAgICAgIERlcHJlY2F0aW9uV2FybmluZykKICAgICAgICBzb3VyY2VfdGltZXN0YW1wID0gc2VsZi5zb3VyY2VfbXRpbWUoZnVsbG5hbWUpCiAgICAgICAgIyBUcnkgdG8gdXNlIGJ5dGVjb2RlIGlmIGl0IGlzIGF2YWlsYWJsZS4KICAgICAgICBieXRlY29kZV9wYXRoID0gc2VsZi5ieXRlY29kZV9wYXRoKGZ1bGxuYW1lKQogICAgICAgIGlmIGJ5dGVjb2RlX3BhdGg6CiAgICAgICAgICAgIGRhdGEgPSBzZWxmLmdldF9kYXRhKGJ5dGVjb2RlX3BhdGgpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIG1hZ2ljID0gZGF0YVs6NF0KICAgICAgICAgICAgICAgIGlmIGxlbihtYWdpYykgPCA0OgogICAgICAgICAgICAgICAgICAgIHJhaXNlIEltcG9ydEVycm9yKAogICAgICAgICAgICAgICAgICAgICAgICAiYmFkIG1hZ2ljIG51bWJlciBpbiB7fSIuZm9ybWF0KGZ1bGxuYW1lKSwKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT1mdWxsbmFtZSwgcGF0aD1ieXRlY29kZV9wYXRoKQogICAgICAgICAgICAgICAgcmF3X3RpbWVzdGFtcCA9IGRhdGFbNDo4XQogICAgICAgICAgICAgICAgaWYgbGVuKHJhd190aW1lc3RhbXApIDwgNDoKICAgICAgICAgICAgICAgICAgICByYWlzZSBFT0ZFcnJvcigiYmFkIHRpbWVzdGFtcCBpbiB7fSIuZm9ybWF0KGZ1bGxuYW1lKSkKICAgICAgICAgICAgICAgIHB5Y190aW1lc3RhbXAgPSBfYm9vdHN0cmFwLl9yX2xvbmcocmF3X3RpbWVzdGFtcCkKICAgICAgICAgICAgICAgIHJhd19zb3VyY2Vfc2l6ZSA9IGRhdGFbODoxMl0KICAgICAgICAgICAgICAgIGlmIGxlbihyYXdfc291cmNlX3NpemUpICE9IDQ6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgRU9GRXJyb3IoImJhZCBmaWxlIHNpemUgaW4ge30iLmZvcm1hdChmdWxsbmFtZSkpCiAgICAgICAgICAgICAgICAjIFNvdXJjZSBzaXplIGlzIHVudXNlZCBhcyB0aGUgQUJDIGRvZXMgbm90IHByb3ZpZGUgYSB3YXkgdG8KICAgICAgICAgICAgICAgICMgZ2V0IHRoZSBzaXplIG9mIHRoZSBzb3VyY2UgYWhlYWQgb2YgcmVhZGluZyBpdC4KICAgICAgICAgICAgICAgIGJ5dGVjb2RlID0gZGF0YVsxMjpdCiAgICAgICAgICAgICAgICAjIFZlcmlmeSB0aGF0IHRoZSBtYWdpYyBudW1iZXIgaXMgdmFsaWQuCiAgICAgICAgICAgICAgICBpZiBpbXAuZ2V0X21hZ2ljKCkgIT0gbWFnaWM6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IoCiAgICAgICAgICAgICAgICAgICAgICAgICJiYWQgbWFnaWMgbnVtYmVyIGluIHt9Ii5mb3JtYXQoZnVsbG5hbWUpLAogICAgICAgICAgICAgICAgICAgICAgICBuYW1lPWZ1bGxuYW1lLCBwYXRoPWJ5dGVjb2RlX3BhdGgpCiAgICAgICAgICAgICAgICAjIFZlcmlmeSB0aGF0IHRoZSBieXRlY29kZSBpcyBub3Qgc3RhbGUgKG9ubHkgbWF0dGVycyB3aGVuCiAgICAgICAgICAgICAgICAjIHRoZXJlIGlzIHNvdXJjZSB0byBmYWxsIGJhY2sgb24uCiAgICAgICAgICAgICAgICBpZiBzb3VyY2VfdGltZXN0YW1wOgogICAgICAgICAgICAgICAgICAgIGlmIHB5Y190aW1lc3RhbXAgPCBzb3VyY2VfdGltZXN0YW1wOgogICAgICAgICAgICAgICAgICAgICAgICByYWlzZSBJbXBvcnRFcnJvcigiYnl0ZWNvZGUgaXMgc3RhbGUiLCBuYW1lPWZ1bGxuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoPWJ5dGVjb2RlX3BhdGgpCiAgICAgICAgICAgIGV4Y2VwdCAoSW1wb3J0RXJyb3IsIEVPRkVycm9yKToKICAgICAgICAgICAgICAgICMgSWYgc291cmNlIGlzIGF2YWlsYWJsZSBnaXZlIGl0IGEgc2hvdC4KICAgICAgICAgICAgICAgIGlmIHNvdXJjZV90aW1lc3RhbXAgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICByYWlzZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgIyBCeXRlY29kZSBzZWVtcyBmaW5lLCBzbyB0cnkgdG8gdXNlIGl0LgogICAgICAgICAgICAgICAgcmV0dXJuIG1hcnNoYWwubG9hZHMoYnl0ZWNvZGUpCiAgICAgICAgZWxpZiBzb3VyY2VfdGltZXN0YW1wIGlzIE5vbmU6CiAgICAgICAgICAgIHJhaXNlIEltcG9ydEVycm9yKCJubyBzb3VyY2Ugb3IgYnl0ZWNvZGUgYXZhaWxhYmxlIHRvIGNyZWF0ZSBjb2RlICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm9iamVjdCBmb3IgezAhcn0iLmZvcm1hdChmdWxsbmFtZSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9ZnVsbG5hbWUpCiAgICAgICAgIyBVc2UgdGhlIHNvdXJjZS4KICAgICAgICBzb3VyY2VfcGF0aCA9IHNlbGYuc291cmNlX3BhdGgoZnVsbG5hbWUpCiAgICAgICAgaWYgc291cmNlX3BhdGggaXMgTm9uZToKICAgICAgICAgICAgbWVzc2FnZSA9ICJhIHNvdXJjZSBwYXRoIG11c3QgZXhpc3QgdG8gbG9hZCB7MH0iLmZvcm1hdChmdWxsbmFtZSkKICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IobWVzc2FnZSwgbmFtZT1mdWxsbmFtZSkKICAgICAgICBzb3VyY2UgPSBzZWxmLmdldF9kYXRhKHNvdXJjZV9wYXRoKQogICAgICAgIGNvZGVfb2JqZWN0ID0gY29tcGlsZShzb3VyY2UsIHNvdXJjZV9wYXRoLCAnZXhlYycsIGRvbnRfaW5oZXJpdD1UcnVlKQogICAgICAgICMgR2VuZXJhdGUgYnl0ZWNvZGUgYW5kIHdyaXRlIGl0IG91dC4KICAgICAgICBpZiBub3Qgc3lzLmRvbnRfd3JpdGVfYnl0ZWNvZGU6CiAgICAgICAgICAgIGRhdGEgPSBieXRlYXJyYXkoaW1wLmdldF9tYWdpYygpKQogICAgICAgICAgICBkYXRhLmV4dGVuZChfYm9vdHN0cmFwLl93X2xvbmcoc291cmNlX3RpbWVzdGFtcCkpCiAgICAgICAgICAgIGRhdGEuZXh0ZW5kKF9ib290c3RyYXAuX3dfbG9uZyhsZW4oc291cmNlKSAmIDB4RkZGRkZGRkYpKQogICAgICAgICAgICBkYXRhLmV4dGVuZChtYXJzaGFsLmR1bXBzKGNvZGVfb2JqZWN0KSkKICAgICAgICAgICAgc2VsZi53cml0ZV9ieXRlY29kZShmdWxsbmFtZSwgZGF0YSkKICAgICAgICByZXR1cm4gY29kZV9vYmplY3QKCiAgICBAYWJjLmFic3RyYWN0bWV0aG9kCiAgICBkZWYgc291cmNlX210aW1lKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICAiIiJBYnN0cmFjdCBtZXRob2QuIEFjY2VwdHMgYSBzdHIgZmlsZW5hbWUgYW5kIHJldHVybnMgYW4gaW50CiAgICAgICAgbW9kaWZpY2F0aW9uIHRpbWUgZm9yIHRoZSBzb3VyY2Ugb2YgdGhlIG1vZHVsZS4iIiIKICAgICAgICByYWlzZSBOb3RJbXBsZW1lbnRlZEVycm9yCgogICAgQGFiYy5hYnN0cmFjdG1ldGhvZAogICAgZGVmIGJ5dGVjb2RlX3BhdGgoc2VsZiwgZnVsbG5hbWUpOgogICAgICAgICIiIkFic3RyYWN0IG1ldGhvZC4gQWNjZXB0cyBhIHN0ciBmaWxlbmFtZSBhbmQgcmV0dXJucyB0aGUgc3RyIHBhdGhuYW1lCiAgICAgICAgdG8gdGhlIGJ5dGVjb2RlIGZvciB0aGUgbW9kdWxlLiIiIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IKCiAgICBAYWJjLmFic3RyYWN0bWV0aG9kCiAgICBkZWYgd3JpdGVfYnl0ZWNvZGUoc2VsZiwgZnVsbG5hbWUsIGJ5dGVjb2RlKToKICAgICAgICAiIiJBYnN0cmFjdCBtZXRob2QuICBBY2NlcHRzIGEgc3RyIGZpbGVuYW1lIGFuZCBieXRlcyBvYmplY3QKICAgICAgICByZXByZXNlbnRpbmcgdGhlIGJ5dGVjb2RlIGZvciB0aGUgbW9kdWxlLiAgUmV0dXJucyBhIGJvb2xlYW4KICAgICAgICByZXByZXNlbnRpbmcgd2hldGhlciB0aGUgYnl0ZWNvZGUgd2FzIHdyaXR0ZW4gb3Igbm90LiIiIgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IK',
'/Lib/importlib/machinery.py':'IiIiVGhlIG1hY2hpbmVyeSBvZiBpbXBvcnRsaWI6IGZpbmRlcnMsIGxvYWRlcnMsIGhvb2tzLCBldGMuIiIiCgppbXBvcnQgX2ltcAoKZnJvbSAuX2Jvb3RzdHJhcCBpbXBvcnQgKFNPVVJDRV9TVUZGSVhFUywgREVCVUdfQllURUNPREVfU1VGRklYRVMsCiAgICAgICAgICAgICAgICAgICAgICAgICBPUFRJTUlaRURfQllURUNPREVfU1VGRklYRVMsIEJZVEVDT0RFX1NVRkZJWEVTLAogICAgICAgICAgICAgICAgICAgICAgICAgRVhURU5TSU9OX1NVRkZJWEVTKQpmcm9tIC5fYm9vdHN0cmFwIGltcG9ydCBCdWlsdGluSW1wb3J0ZXIKZnJvbSAuX2Jvb3RzdHJhcCBpbXBvcnQgRnJvemVuSW1wb3J0ZXIKZnJvbSAuX2Jvb3RzdHJhcCBpbXBvcnQgV2luZG93c1JlZ2lzdHJ5RmluZGVyCmZyb20gLl9ib290c3RyYXAgaW1wb3J0IFBhdGhGaW5kZXIKZnJvbSAuX2Jvb3RzdHJhcCBpbXBvcnQgRmlsZUZpbmRlcgpmcm9tIC5fYm9vdHN0cmFwIGltcG9ydCBTb3VyY2VGaWxlTG9hZGVyCmZyb20gLl9ib290c3RyYXAgaW1wb3J0IFNvdXJjZWxlc3NGaWxlTG9hZGVyCmZyb20gLl9ib290c3RyYXAgaW1wb3J0IEV4dGVuc2lvbkZpbGVMb2FkZXIKCgpkZWYgYWxsX3N1ZmZpeGVzKCk6CiAgICAiIiJSZXR1cm5zIGEgbGlzdCBvZiBhbGwgcmVjb2duaXplZCBtb2R1bGUgc3VmZml4ZXMgZm9yIHRoaXMgcHJvY2VzcyIiIgogICAgcmV0dXJuIFNPVVJDRV9TVUZGSVhFUyArIEJZVEVDT0RFX1NVRkZJWEVTICsgRVhURU5TSU9OX1NVRkZJWEVTCg==',
'/Lib/importlib/module5.py':'Y2xhc3MgZm9vOgogICAgZGVmIGJhcihzZWxmKToKICAgICAgICBwYXNzCgpwcmludChkaXIoZm9vLmJhcikpCnByaW50KGZvby5iYXIuaW1fY2xhc3Mp',
'/Lib/importlib/util.py':'IiIiVXRpbGl0eSBjb2RlIGZvciBjb25zdHJ1Y3RpbmcgaW1wb3J0ZXJzLCBldGMuIiIiCgpmcm9tIC5fYm9vdHN0cmFwIGltcG9ydCBtb2R1bGVfZm9yX2xvYWRlcgpmcm9tIC5fYm9vdHN0cmFwIGltcG9ydCBzZXRfbG9hZGVyCmZyb20gLl9ib290c3RyYXAgaW1wb3J0IHNldF9wYWNrYWdlCmZyb20gLl9ib290c3RyYXAgaW1wb3J0IF9yZXNvbHZlX25hbWUKCgpkZWYgcmVzb2x2ZV9uYW1lKG5hbWUsIHBhY2thZ2UpOgogICAgIiIiUmVzb2x2ZSBhIHJlbGF0aXZlIG1vZHVsZSBuYW1lIHRvIGFuIGFic29sdXRlIG9uZS4iIiIKICAgIGlmIG5vdCBuYW1lLnN0YXJ0c3dpdGgoJy4nKToKICAgICAgICByZXR1cm4gbmFtZQogICAgZWxpZiBub3QgcGFja2FnZToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCd7IXJ9IGlzIG5vdCBhIHJlbGF0aXZlIG5hbWUgJwogICAgICAgICAgICAgICAgICAgICAgICAgJyhubyBsZWFkaW5nIGRvdCknLmZvcm1hdChuYW1lKSkKICAgIGxldmVsID0gMAogICAgZm9yIGNoYXJhY3RlciBpbiBuYW1lOgogICAgICAgIGlmIGNoYXJhY3RlciAhPSAnLic6CiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgbGV2ZWwgKz0gMQogICAgcmV0dXJuIF9yZXNvbHZlX25hbWUobmFtZVtsZXZlbDpdLCBwYWNrYWdlLCBsZXZlbCkK',
'/Lib/importlib/_bootstrap.py':'IiIiQ29yZSBpbXBsZW1lbnRhdGlvbiBvZiBpbXBvcnQuCgpUaGlzIG1vZHVsZSBpcyBOT1QgbWVhbnQgdG8gYmUgZGlyZWN0bHkgaW1wb3J0ZWQhIEl0IGhhcyBiZWVuIGRlc2lnbmVkIHN1Y2gKdGhhdCBpdCBjYW4gYmUgYm9vdHN0cmFwcGVkIGludG8gUHl0aG9uIGFzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiBpbXBvcnQuIEFzCnN1Y2ggaXQgcmVxdWlyZXMgdGhlIGluamVjdGlvbiBvZiBzcGVjaWZpYyBtb2R1bGVzIGFuZCBhdHRyaWJ1dGVzIGluIG9yZGVyIHRvCndvcmsuIE9uZSBzaG91bGQgdXNlIGltcG9ydGxpYiBhcyB0aGUgcHVibGljLWZhY2luZyB2ZXJzaW9uIG9mIHRoaXMgbW9kdWxlLgoKIiIiCiMKIyBJTVBPUlRBTlQ6IFdoZW5ldmVyIG1ha2luZyBjaGFuZ2VzIHRvIHRoaXMgbW9kdWxlLCBiZSBzdXJlIHRvIHJ1bgojIGEgdG9wLWxldmVsIG1ha2UgaW4gb3JkZXIgdG8gZ2V0IHRoZSBmcm96ZW4gdmVyc2lvbiBvZiB0aGUgbW9kdWxlCiMgdXBkYXRlLiBOb3QgZG9pbmcgc28sIHdpbGwgcmVzdWx0IGluIHRoZSBNYWtlZmlsZSB0byBmYWlsIGZvcgojIGFsbCBvdGhlcnMgd2hvIGRvbid0IGhhdmUgYSAuL3B5dGhvbiBhcm91bmQgdG8gZnJlZXplIHRoZSBtb2R1bGUKIyBpbiB0aGUgZWFybHkgc3RhZ2VzIG9mIGNvbXBpbGF0aW9uLgojCgojIFNlZSBpbXBvcnRsaWIuX3NldHVwKCkgZm9yIHdoYXQgaXMgaW5qZWN0ZWQgaW50byB0aGUgZ2xvYmFsIG5hbWVzcGFjZS4KCiMgV2hlbiBlZGl0aW5nIHRoaXMgY29kZSBiZSBhd2FyZSB0aGF0IGNvZGUgZXhlY3V0ZWQgYXQgaW1wb3J0IHRpbWUgQ0FOTk9UCiMgcmVmZXJlbmNlIGFueSBpbmplY3RlZCBvYmplY3RzISBUaGlzIGluY2x1ZGVzIG5vdCBvbmx5IGdsb2JhbCBjb2RlIGJ1dCBhbHNvCiMgYW55dGhpbmcgc3BlY2lmaWVkIGF0IHRoZSBjbGFzcyBsZXZlbC4KCiMgWFhYIE1ha2Ugc3VyZSBhbGwgcHVibGljIG5hbWVzIGhhdmUgbm8gc2luZ2xlIGxlYWRpbmcgdW5kZXJzY29yZSBhbmQgYWxsCiMgICAgIG90aGVycyBkby4KCgojIEJvb3RzdHJhcC1yZWxhdGVkIGNvZGUgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpfQ0FTRV9JTlNFTlNJVElWRV9QTEFURk9STVMgPSAnd2luJywgJ2N5Z3dpbicsICdkYXJ3aW4nCgoKZGVmIF9tYWtlX3JlbGF4X2Nhc2UoKToKICAgIGlmIHN5cy5wbGF0Zm9ybS5zdGFydHN3aXRoKF9DQVNFX0lOU0VOU0lUSVZFX1BMQVRGT1JNUyk6CiAgICAgICAgZGVmIF9yZWxheF9jYXNlKCk6CiAgICAgICAgICAgICIiIlRydWUgaWYgZmlsZW5hbWVzIG11c3QgYmUgY2hlY2tlZCBjYXNlLWluc2Vuc2l0aXZlbHkuIiIiCiAgICAgICAgICAgIHJldHVybiBiJ1BZVEhPTkNBU0VPSycgaW4gX29zLmVudmlyb24KICAgIGVsc2U6CiAgICAgICAgZGVmIF9yZWxheF9jYXNlKCk6CiAgICAgICAgICAgICIiIlRydWUgaWYgZmlsZW5hbWVzIG11c3QgYmUgY2hlY2tlZCBjYXNlLWluc2Vuc2l0aXZlbHkuIiIiCiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgcmV0dXJuIF9yZWxheF9jYXNlCgoKIyBUT0RPOiBFeHBvc2UgZnJvbSBtYXJzaGFsCmRlZiBfd19sb25nKHgpOgogICAgIiIiQ29udmVydCBhIDMyLWJpdCBpbnRlZ2VyIHRvIGxpdHRsZS1lbmRpYW4uCgogICAgWFhYIFRlbXBvcmFyeSB1bnRpbCBtYXJzaGFsJ3MgbG9uZyBmdW5jdGlvbnMgYXJlIGV4cG9zZWQuCgogICAgIiIiCiAgICB4ID0gaW50KHgpCiAgICBpbnRfYnl0ZXMgPSBbXQogICAgaW50X2J5dGVzLmFwcGVuZCh4ICYgMHhGRikKICAgIGludF9ieXRlcy5hcHBlbmQoKHggPj4gOCkgJiAweEZGKQogICAgaW50X2J5dGVzLmFwcGVuZCgoeCA+PiAxNikgJiAweEZGKQogICAgaW50X2J5dGVzLmFwcGVuZCgoeCA+PiAyNCkgJiAweEZGKQogICAgcmV0dXJuIGJ5dGVhcnJheShpbnRfYnl0ZXMpCgoKIyBUT0RPOiBFeHBvc2UgZnJvbSBtYXJzaGFsCmRlZiBfcl9sb25nKGludF9ieXRlcyk6CiAgICAiIiJDb252ZXJ0IDQgYnl0ZXMgaW4gbGl0dGxlLWVuZGlhbiB0byBhbiBpbnRlZ2VyLgoKICAgIFhYWCBUZW1wb3JhcnkgdW50aWwgbWFyc2hhbCdzIGxvbmcgZnVuY3Rpb24gYXJlIGV4cG9zZWQuCgogICAgIiIiCiAgICB4ID0gaW50X2J5dGVzWzBdCiAgICB4IHw9IGludF9ieXRlc1sxXSA8PCA4CiAgICB4IHw9IGludF9ieXRlc1syXSA8PCAxNgogICAgeCB8PSBpbnRfYnl0ZXNbM10gPDwgMjQKICAgIHJldHVybiB4CgoKZGVmIF9wYXRoX2pvaW4oKnBhdGhfcGFydHMpOgogICAgIiIiUmVwbGFjZW1lbnQgZm9yIG9zLnBhdGguam9pbigpLiIiIgogICAgbmV3X3BhcnRzID0gW10KICAgIGZvciBwYXJ0IGluIHBhdGhfcGFydHM6CiAgICAgICAgaWYgbm90IHBhcnQ6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgbmV3X3BhcnRzLmFwcGVuZChwYXJ0KQogICAgICAgIGlmIHBhcnRbLTFdIG5vdCBpbiBwYXRoX3NlcGFyYXRvcnM6CiAgICAgICAgICAgIG5ld19wYXJ0cy5hcHBlbmQocGF0aF9zZXApCiAgICByZXR1cm4gJycuam9pbihuZXdfcGFydHNbOi0xXSkgICMgRHJvcCBzdXBlcmZsdW91cyBwYXRoIHNlcGFyYXRvci4KCgpkZWYgX3BhdGhfc3BsaXQocGF0aCk6CiAgICAiIiJSZXBsYWNlbWVudCBmb3Igb3MucGF0aC5zcGxpdCgpLiIiIgogICAgZm9yIHggaW4gcmV2ZXJzZWQocGF0aCk6CiAgICAgICAgaWYgeCBpbiBwYXRoX3NlcGFyYXRvcnM6CiAgICAgICAgICAgIHNlcCA9IHgKICAgICAgICAgICAgYnJlYWsKICAgIGVsc2U6CiAgICAgICAgc2VwID0gcGF0aF9zZXAKICAgIGZyb250LCBfLCB0YWlsID0gcGF0aC5ycGFydGl0aW9uKHNlcCkKICAgIHJldHVybiBmcm9udCwgdGFpbAoKCmRlZiBfcGF0aF9pc19tb2RlX3R5cGUocGF0aCwgbW9kZSk6CiAgICAiIiJUZXN0IHdoZXRoZXIgdGhlIHBhdGggaXMgdGhlIHNwZWNpZmllZCBtb2RlIHR5cGUuIiIiCiAgICB0cnk6CiAgICAgICAgc3RhdF9pbmZvID0gX29zLnN0YXQocGF0aCkKICAgIGV4Y2VwdCBPU0Vycm9yOgogICAgICAgIHJldHVybiBGYWxzZQogICAgcmV0dXJuIChzdGF0X2luZm8uc3RfbW9kZSAmIDBvMTcwMDAwKSA9PSBtb2RlCgoKIyBYWFggQ291bGQgYWxzbyBleHBvc2UgTW9kdWxlcy9nZXRwYXRoLmM6aXNmaWxlKCkKZGVmIF9wYXRoX2lzZmlsZShwYXRoKToKICAgICIiIlJlcGxhY2VtZW50IGZvciBvcy5wYXRoLmlzZmlsZS4iIiIKICAgIHJldHVybiBfcGF0aF9pc19tb2RlX3R5cGUocGF0aCwgMG8xMDAwMDApCgoKIyBYWFggQ291bGQgYWxzbyBleHBvc2UgTW9kdWxlcy9nZXRwYXRoLmM6aXNkaXIoKQpkZWYgX3BhdGhfaXNkaXIocGF0aCk6CiAgICAiIiJSZXBsYWNlbWVudCBmb3Igb3MucGF0aC5pc2Rpci4iIiIKICAgIGlmIG5vdCBwYXRoOgogICAgICAgIHBhdGggPSBfb3MuZ2V0Y3dkKCkKICAgIHJldHVybiBfcGF0aF9pc19tb2RlX3R5cGUocGF0aCwgMG8wNDAwMDApCgoKZGVmIF93cml0ZV9hdG9taWMocGF0aCwgZGF0YSwgbW9kZT0wbzY2Nik6CiAgICAiIiJCZXN0LWVmZm9ydCBmdW5jdGlvbiB0byB3cml0ZSBkYXRhIHRvIGEgcGF0aCBhdG9taWNhbGx5LgogICAgQmUgcHJlcGFyZWQgdG8gaGFuZGxlIGEgRmlsZUV4aXN0c0Vycm9yIGlmIGNvbmN1cnJlbnQgd3JpdGluZyBvZiB0aGUKICAgIHRlbXBvcmFyeSBmaWxlIGlzIGF0dGVtcHRlZC4iIiIKICAgICMgaWQoKSBpcyB1c2VkIHRvIGdlbmVyYXRlIGEgcHNldWRvLXJhbmRvbSBmaWxlbmFtZS4KICAgIHBhdGhfdG1wID0gJ3t9Lnt9Jy5mb3JtYXQocGF0aCwgaWQocGF0aCkpCiAgICBmZCA9IF9vcy5vcGVuKHBhdGhfdG1wLAogICAgICAgICAgICAgICAgICBfb3MuT19FWENMIHwgX29zLk9fQ1JFQVQgfCBfb3MuT19XUk9OTFksIG1vZGUgJiAwbzY2NikKICAgIHRyeToKICAgICAgICAjIFdlIGZpcnN0IHdyaXRlIGRhdGEgdG8gYSB0ZW1wb3JhcnkgZmlsZSwgYW5kIHRoZW4gdXNlIG9zLnJlcGxhY2UoKSB0bwogICAgICAgICMgcGVyZm9ybSBhbiBhdG9taWMgcmVuYW1lLgogICAgICAgIHdpdGggX2lvLkZpbGVJTyhmZCwgJ3diJykgYXMgZmlsZToKICAgICAgICAgICAgZmlsZS53cml0ZShkYXRhKQogICAgICAgIF9vcy5yZXBsYWNlKHBhdGhfdG1wLCBwYXRoKQogICAgZXhjZXB0IE9TRXJyb3I6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBfb3MudW5saW5rKHBhdGhfdG1wKQogICAgICAgIGV4Y2VwdCBPU0Vycm9yOgogICAgICAgICAgICBwYXNzCiAgICAgICAgcmFpc2UKCgpkZWYgX3dyYXAobmV3LCBvbGQpOgogICAgIiIiU2ltcGxlIHN1YnN0aXR1dGUgZm9yIGZ1bmN0b29scy51cGRhdGVfd3JhcHBlci4iIiIKICAgIGZvciByZXBsYWNlIGluIFsnX19tb2R1bGVfXycsICdfX25hbWVfXycsICdfX3F1YWxuYW1lX18nLCAnX19kb2NfXyddOgogICAgICAgIGlmIGhhc2F0dHIob2xkLCByZXBsYWNlKToKICAgICAgICAgICAgc2V0YXR0cihuZXcsIHJlcGxhY2UsIGdldGF0dHIob2xkLCByZXBsYWNlKSkKICAgIG5ldy5fX2RpY3RfXy51cGRhdGUob2xkLl9fZGljdF9fKQoKCl9jb2RlX3R5cGUgPSB0eXBlKF93cmFwLl9fY29kZV9fKQoKCmRlZiBuZXdfbW9kdWxlKG5hbWUpOgogICAgIiIiQ3JlYXRlIGEgbmV3IG1vZHVsZS4KCiAgICBUaGUgbW9kdWxlIGlzIG5vdCBlbnRlcmVkIGludG8gc3lzLm1vZHVsZXMuCgogICAgIiIiCiAgICByZXR1cm4gdHlwZShfaW8pKG5hbWUpCgoKIyBNb2R1bGUtbGV2ZWwgbG9ja2luZyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKIyBBIGRpY3QgbWFwcGluZyBtb2R1bGUgbmFtZXMgdG8gd2Vha3JlZnMgb2YgX01vZHVsZUxvY2sgaW5zdGFuY2VzCl9tb2R1bGVfbG9ja3MgPSB7fQojIEEgZGljdCBtYXBwaW5nIHRocmVhZCBpZHMgdG8gX01vZHVsZUxvY2sgaW5zdGFuY2VzCl9ibG9ja2luZ19vbiA9IHt9CgoKY2xhc3MgX0RlYWRsb2NrRXJyb3IoUnVudGltZUVycm9yKToKICAgIHBhc3MKCgpjbGFzcyBfTW9kdWxlTG9jazoKICAgICIiIkEgcmVjdXJzaXZlIGxvY2sgaW1wbGVtZW50YXRpb24gd2hpY2ggaXMgYWJsZSB0byBkZXRlY3QgZGVhZGxvY2tzCiAgICAoZS5nLiB0aHJlYWQgMSB0cnlpbmcgdG8gdGFrZSBsb2NrcyBBIHRoZW4gQiwgYW5kIHRocmVhZCAyIHRyeWluZyB0bwogICAgdGFrZSBsb2NrcyBCIHRoZW4gQSkuCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgbmFtZSk6CiAgICAgICAgc2VsZi5sb2NrID0gX3RocmVhZC5hbGxvY2F0ZV9sb2NrKCkKICAgICAgICBzZWxmLndha2V1cCA9IF90aHJlYWQuYWxsb2NhdGVfbG9jaygpCiAgICAgICAgc2VsZi5uYW1lID0gbmFtZQogICAgICAgIHNlbGYub3duZXIgPSBOb25lCiAgICAgICAgc2VsZi5jb3VudCA9IDAKICAgICAgICBzZWxmLndhaXRlcnMgPSAwCgogICAgZGVmIGhhc19kZWFkbG9jayhzZWxmKToKICAgICAgICAjIERlYWRsb2NrIGF2b2lkYW5jZSBmb3IgY29uY3VycmVudCBjaXJjdWxhciBpbXBvcnRzLgogICAgICAgIG1lID0gX3RocmVhZC5nZXRfaWRlbnQoKQogICAgICAgIHRpZCA9IHNlbGYub3duZXIKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICBsb2NrID0gX2Jsb2NraW5nX29uLmdldCh0aWQpCiAgICAgICAgICAgIGlmIGxvY2sgaXMgTm9uZToKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICAgICB0aWQgPSBsb2NrLm93bmVyCiAgICAgICAgICAgIGlmIHRpZCA9PSBtZToKICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIGFjcXVpcmUoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgQWNxdWlyZSB0aGUgbW9kdWxlIGxvY2suICBJZiBhIHBvdGVudGlhbCBkZWFkbG9jayBpcyBkZXRlY3RlZCwKICAgICAgICBhIF9EZWFkbG9ja0Vycm9yIGlzIHJhaXNlZC4KICAgICAgICBPdGhlcndpc2UsIHRoZSBsb2NrIGlzIGFsd2F5cyBhY3F1aXJlZCBhbmQgVHJ1ZSBpcyByZXR1cm5lZC4KICAgICAgICAiIiIKICAgICAgICB0aWQgPSBfdGhyZWFkLmdldF9pZGVudCgpCiAgICAgICAgX2Jsb2NraW5nX29uW3RpZF0gPSBzZWxmCiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgd2l0aCBzZWxmLmxvY2s6CiAgICAgICAgICAgICAgICAgICAgaWYgc2VsZi5jb3VudCA9PSAwIG9yIHNlbGYub3duZXIgPT0gdGlkOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm93bmVyID0gdGlkCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY291bnQgKz0gMQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgICAgICAgICAgICAgIGlmIHNlbGYuaGFzX2RlYWRsb2NrKCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHJhaXNlIF9EZWFkbG9ja0Vycm9yKCJkZWFkbG9jayBkZXRlY3RlZCBieSAlciIgJSBzZWxmKQogICAgICAgICAgICAgICAgICAgIGlmIHNlbGYud2FrZXVwLmFjcXVpcmUoRmFsc2UpOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLndhaXRlcnMgKz0gMQogICAgICAgICAgICAgICAgIyBXYWl0IGZvciBhIHJlbGVhc2UoKSBjYWxsCiAgICAgICAgICAgICAgICBzZWxmLndha2V1cC5hY3F1aXJlKCkKICAgICAgICAgICAgICAgIHNlbGYud2FrZXVwLnJlbGVhc2UoKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIGRlbCBfYmxvY2tpbmdfb25bdGlkXQoKICAgIGRlZiByZWxlYXNlKHNlbGYpOgogICAgICAgIHRpZCA9IF90aHJlYWQuZ2V0X2lkZW50KCkKICAgICAgICB3aXRoIHNlbGYubG9jazoKICAgICAgICAgICAgaWYgc2VsZi5vd25lciAhPSB0aWQ6CiAgICAgICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoImNhbm5vdCByZWxlYXNlIHVuLWFjcXVpcmVkIGxvY2siKQogICAgICAgICAgICBhc3NlcnQgc2VsZi5jb3VudCA+IDAKICAgICAgICAgICAgc2VsZi5jb3VudCAtPSAxCiAgICAgICAgICAgIGlmIHNlbGYuY291bnQgPT0gMDoKICAgICAgICAgICAgICAgIHNlbGYub3duZXIgPSBOb25lCiAgICAgICAgICAgICAgICBpZiBzZWxmLndhaXRlcnM6CiAgICAgICAgICAgICAgICAgICAgc2VsZi53YWl0ZXJzIC09IDEKICAgICAgICAgICAgICAgICAgICBzZWxmLndha2V1cC5yZWxlYXNlKCkKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICJfTW9kdWxlTG9jayglcikgYXQgJWQiICUgKHNlbGYubmFtZSwgaWQoc2VsZikpCgoKY2xhc3MgX0R1bW15TW9kdWxlTG9jazoKICAgICIiIkEgc2ltcGxlIF9Nb2R1bGVMb2NrIGVxdWl2YWxlbnQgZm9yIFB5dGhvbiBidWlsZHMgd2l0aG91dAogICAgbXVsdGktdGhyZWFkaW5nIHN1cHBvcnQuIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG5hbWUpOgogICAgICAgIHNlbGYubmFtZSA9IG5hbWUKICAgICAgICBzZWxmLmNvdW50ID0gMAoKICAgIGRlZiBhY3F1aXJlKHNlbGYpOgogICAgICAgIHNlbGYuY291bnQgKz0gMQogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIHJlbGVhc2Uoc2VsZik6CiAgICAgICAgaWYgc2VsZi5jb3VudCA9PSAwOgogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoImNhbm5vdCByZWxlYXNlIHVuLWFjcXVpcmVkIGxvY2siKQogICAgICAgIHNlbGYuY291bnQgLT0gMQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gIl9EdW1teU1vZHVsZUxvY2soJXIpIGF0ICVkIiAlIChzZWxmLm5hbWUsIGlkKHNlbGYpKQoKCiMgVGhlIGZvbGxvd2luZyB0d28gZnVuY3Rpb25zIGFyZSBmb3IgY29uc3VtcHRpb24gYnkgUHl0aG9uL2ltcG9ydC5jLgoKZGVmIF9nZXRfbW9kdWxlX2xvY2sobmFtZSk6CiAgICAiIiJHZXQgb3IgY3JlYXRlIHRoZSBtb2R1bGUgbG9jayBmb3IgYSBnaXZlbiBtb2R1bGUgbmFtZS4KCiAgICBTaG91bGQgb25seSBiZSBjYWxsZWQgd2l0aCB0aGUgaW1wb3J0IGxvY2sgdGFrZW4uIiIiCiAgICBsb2NrID0gTm9uZQogICAgaWYgbmFtZSBpbiBfbW9kdWxlX2xvY2tzOgogICAgICAgIGxvY2sgPSBfbW9kdWxlX2xvY2tzW25hbWVdKCkKICAgIGlmIGxvY2sgaXMgTm9uZToKICAgICAgICBpZiBfdGhyZWFkIGlzIE5vbmU6CiAgICAgICAgICAgIGxvY2sgPSBfRHVtbXlNb2R1bGVMb2NrKG5hbWUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbG9jayA9IF9Nb2R1bGVMb2NrKG5hbWUpCiAgICAgICAgZGVmIGNiKF8pOgogICAgICAgICAgICBkZWwgX21vZHVsZV9sb2Nrc1tuYW1lXQogICAgICAgIF9tb2R1bGVfbG9ja3NbbmFtZV0gPSBfd2Vha3JlZi5yZWYobG9jaywgY2IpCiAgICByZXR1cm4gbG9jawoKZGVmIF9sb2NrX3VubG9ja19tb2R1bGUobmFtZSk6CiAgICAiIiJSZWxlYXNlIHRoZSBnbG9iYWwgaW1wb3J0IGxvY2ssIGFuZCBhY3F1aXJlcyB0aGVuIHJlbGVhc2UgdGhlCiAgICBtb2R1bGUgbG9jayBmb3IgYSBnaXZlbiBtb2R1bGUgbmFtZS4KICAgIFRoaXMgaXMgdXNlZCB0byBlbnN1cmUgYSBtb2R1bGUgaXMgY29tcGxldGVseSBpbml0aWFsaXplZCwgaW4gdGhlCiAgICBldmVudCBpdCBpcyBiZWluZyBpbXBvcnRlZCBieSBhbm90aGVyIHRocmVhZC4KCiAgICBTaG91bGQgb25seSBiZSBjYWxsZWQgd2l0aCB0aGUgaW1wb3J0IGxvY2sgdGFrZW4uIiIiCiAgICBsb2NrID0gX2dldF9tb2R1bGVfbG9jayhuYW1lKQogICAgX2ltcC5yZWxlYXNlX2xvY2soKQogICAgdHJ5OgogICAgICAgIGxvY2suYWNxdWlyZSgpCiAgICBleGNlcHQgX0RlYWRsb2NrRXJyb3I6CiAgICAgICAgIyBDb25jdXJyZW50IGNpcmN1bGFyIGltcG9ydCwgd2UnbGwgYWNjZXB0IGEgcGFydGlhbGx5IGluaXRpYWxpemVkCiAgICAgICAgIyBtb2R1bGUgb2JqZWN0LgogICAgICAgIHBhc3MKICAgIGVsc2U6CiAgICAgICAgbG9jay5yZWxlYXNlKCkKCiMgRnJhbWUgc3RyaXBwaW5nIG1hZ2ljICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgX2NhbGxfd2l0aF9mcmFtZXNfcmVtb3ZlZChmLCAqYXJncywgKiprd2RzKToKICAgICIiInJlbW92ZV9pbXBvcnRsaWJfZnJhbWVzIGluIGltcG9ydC5jIHdpbGwgYWx3YXlzIHJlbW92ZSBzZXF1ZW5jZXMKICAgIG9mIGltcG9ydGxpYiBmcmFtZXMgdGhhdCBlbmQgd2l0aCBhIGNhbGwgdG8gdGhpcyBmdW5jdGlvbgoKICAgIFVzZSBpdCBpbnN0ZWFkIG9mIGEgbm9ybWFsIGNhbGwgaW4gcGxhY2VzIHdoZXJlIGluY2x1ZGluZyB0aGUgaW1wb3J0bGliCiAgICBmcmFtZXMgaW50cm9kdWNlcyB1bndhbnRlZCBub2lzZSBpbnRvIHRoZSB0cmFjZWJhY2sgKGUuZy4gd2hlbiBleGVjdXRpbmcKICAgIG1vZHVsZSBjb2RlKQogICAgIiIiCiAgICByZXR1cm4gZigqYXJncywgKiprd2RzKQoKCiMgRmluZGVyL2xvYWRlciB1dGlsaXR5IGNvZGUgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiIiIk1hZ2ljIHdvcmQgdG8gcmVqZWN0IC5weWMgZmlsZXMgZ2VuZXJhdGVkIGJ5IG90aGVyIFB5dGhvbiB2ZXJzaW9ucy4KSXQgc2hvdWxkIGNoYW5nZSBmb3IgZWFjaCBpbmNvbXBhdGlibGUgY2hhbmdlIHRvIHRoZSBieXRlY29kZS4KClRoZSB2YWx1ZSBvZiBDUiBhbmQgTEYgaXMgaW5jb3Jwb3JhdGVkIHNvIGlmIHlvdSBldmVyIHJlYWQgb3Igd3JpdGUKYSAucHljIGZpbGUgaW4gdGV4dCBtb2RlIHRoZSBtYWdpYyBudW1iZXIgd2lsbCBiZSB3cm9uZzsgYWxzbywgdGhlCkFwcGxlIE1QVyBjb21waWxlciBzd2FwcyB0aGVpciB2YWx1ZXMsIGJvdGNoaW5nIHN0cmluZyBjb25zdGFudHMuCgpUaGUgbWFnaWMgbnVtYmVycyBtdXN0IGJlIHNwYWNlZCBhcGFydCBhdCBsZWFzdCAyIHZhbHVlcywgYXMgdGhlCi1VIGludGVycGV0ZXIgZmxhZyB3aWxsIGNhdXNlIE1BR0lDKzEgYmVpbmcgdXNlZC4gVGhleSBoYXZlIGJlZW4Kb2RkIG51bWJlcnMgZm9yIHNvbWUgdGltZSBub3cuCgpUaGVyZSB3ZXJlIGEgdmFyaWV0eSBvZiBvbGQgc2NoZW1lcyBmb3Igc2V0dGluZyB0aGUgbWFnaWMgbnVtYmVyLgpUaGUgY3VycmVudCB3b3JraW5nIHNjaGVtZSBpcyB0byBpbmNyZW1lbnQgdGhlIHByZXZpb3VzIHZhbHVlIGJ5CjEwLgoKU3RhcnRpbmcgd2l0aCB0aGUgYWRvcHRpb24gb2YgUEVQIDMxNDcgaW4gUHl0aG9uIDMuMiwgZXZlcnkgYnVtcCBpbiBtYWdpYwpudW1iZXIgYWxzbyBpbmNsdWRlcyBhIG5ldyAibWFnaWMgdGFnIiwgaS5lLiBhIGh1bWFuIHJlYWRhYmxlIHN0cmluZyB1c2VkCnRvIHJlcHJlc2VudCB0aGUgbWFnaWMgbnVtYmVyIGluIF9fcHljYWNoZV9fIGRpcmVjdG9yaWVzLiAgV2hlbiB5b3UgY2hhbmdlCnRoZSBtYWdpYyBudW1iZXIsIHlvdSBtdXN0IGFsc28gc2V0IGEgbmV3IHVuaXF1ZSBtYWdpYyB0YWcuICBHZW5lcmFsbHkgdGhpcwpjYW4gYmUgbmFtZWQgYWZ0ZXIgdGhlIFB5dGhvbiBtYWpvciB2ZXJzaW9uIG9mIHRoZSBtYWdpYyBudW1iZXIgYnVtcCwgYnV0Cml0IGNhbiByZWFsbHkgYmUgYW55dGhpbmcsIGFzIGxvbmcgYXMgaXQncyBkaWZmZXJlbnQgdGhhbiBhbnl0aGluZyBlbHNlCnRoYXQncyBjb21lIGJlZm9yZS4gIFRoZSB0YWdzIGFyZSBpbmNsdWRlZCBpbiB0aGUgZm9sbG93aW5nIHRhYmxlLCBzdGFydGluZwp3aXRoIFB5dGhvbiAzLjJhMC4KCktub3duIHZhbHVlczoKIFB5dGhvbiAxLjU6ICAgMjAxMjEKIFB5dGhvbiAxLjUuMTogMjAxMjEKICAgIFB5dGhvbiAxLjUuMjogMjAxMjEKICAgIFB5dGhvbiAxLjY6ICAgNTA0MjgKICAgIFB5dGhvbiAyLjA6ICAgNTA4MjMKICAgIFB5dGhvbiAyLjAuMTogNTA4MjMKICAgIFB5dGhvbiAyLjE6ICAgNjAyMDIKICAgIFB5dGhvbiAyLjEuMTogNjAyMDIKICAgIFB5dGhvbiAyLjEuMjogNjAyMDIKICAgIFB5dGhvbiAyLjI6ICAgNjA3MTcKICAgIFB5dGhvbiAyLjNhMDogNjIwMTEKICAgIFB5dGhvbiAyLjNhMDogNjIwMjEKICAgIFB5dGhvbiAyLjNhMDogNjIwMTEgKCEpCiAgICBQeXRob24gMi40YTA6IDYyMDQxCiAgICBQeXRob24gMi40YTM6IDYyMDUxCiAgICBQeXRob24gMi40YjE6IDYyMDYxCiAgICBQeXRob24gMi41YTA6IDYyMDcxCiAgICBQeXRob24gMi41YTA6IDYyMDgxIChhc3QtYnJhbmNoKQogICAgUHl0aG9uIDIuNWEwOiA2MjA5MSAod2l0aCkKICAgIFB5dGhvbiAyLjVhMDogNjIwOTIgKGNoYW5nZWQgV0lUSF9DTEVBTlVQIG9wY29kZSkKICAgIFB5dGhvbiAyLjViMzogNjIxMDEgKGZpeCB3cm9uZyBjb2RlOiBmb3IgeCwgaW4gLi4uKQogICAgUHl0aG9uIDIuNWIzOiA2MjExMSAoZml4IHdyb25nIGNvZGU6IHggKz0geWllbGQpCiAgICBQeXRob24gMi41YzE6IDYyMTIxIChmaXggd3JvbmcgbG5vdGFiIHdpdGggZm9yIGxvb3BzIGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmluZyBjb25zdGFudHMgdGhhdCBzaG91bGQgaGF2ZSBiZWVuIHJlbW92ZWQpCiAgICBQeXRob24gMi41YzI6IDYyMTMxIChmaXggd3JvbmcgY29kZTogZm9yIHgsIGluIC4uLiBpbiBsaXN0Y29tcC9nZW5leHApCiAgICBQeXRob24gMi42YTA6IDYyMTUxIChwZWVwaG9sZSBvcHRpbWl6YXRpb25zIGFuZCBTVE9SRV9NQVAgb3Bjb2RlKQogICAgUHl0aG9uIDIuNmExOiA2MjE2MSAoV0lUSF9DTEVBTlVQIG9wdGltaXphdGlvbikKICAgIFB5dGhvbiAzMDAwOiAgIDMwMDAKICAgICAgICAgICAgICAgICAgIDMwMTAgKHJlbW92ZWQgVU5BUllfQ09OVkVSVCkKICAgICAgICAgICAgICAgICAgIDMwMjAgKGFkZGVkIEJVSUxEX1NFVCkKICAgICAgICAgICAgICAgICAgIDMwMzAgKGFkZGVkIGtleXdvcmQtb25seSBwYXJhbWV0ZXJzKQogICAgICAgICAgICAgICAgICAgMzA0MCAoYWRkZWQgc2lnbmF0dXJlIGFubm90YXRpb25zKQogICAgICAgICAgICAgICAgICAgMzA1MCAocHJpbnQgYmVjb21lcyBhIGZ1bmN0aW9uKQogICAgICAgICAgICAgICAgICAgMzA2MCAoUEVQIDMxMTUgbWV0YWNsYXNzIHN5bnRheCkKICAgICAgICAgICAgICAgICAgIDMwNjEgKHN0cmluZyBsaXRlcmFscyBiZWNvbWUgdW5pY29kZSkKICAgICAgICAgICAgICAgICAgIDMwNzEgKFBFUCAzMTA5IHJhaXNlIGNoYW5nZXMpCiAgICAgICAgICAgICAgICAgICAzMDgxIChQRVAgMzEzNyBtYWtlIF9fZmlsZV9fIGFuZCBfX25hbWVfXyB1bmljb2RlKQogICAgICAgICAgICAgICAgICAgMzA5MSAoa2lsbCBzdHI4IGludGVybmluZykKICAgICAgICAgICAgICAgICAgIDMxMDEgKG1lcmdlIGZyb20gMi42YTAsIHNlZSA2MjE1MSkKICAgICAgICAgICAgICAgICAgIDMxMDMgKF9fZmlsZV9fIHBvaW50cyB0byBzb3VyY2UgZmlsZSkKICAgIFB5dGhvbiAzLjBhNDogMzExMSAoV0lUSF9DTEVBTlVQIG9wdGltaXphdGlvbikuCiAgICBQeXRob24gMy4wYTU6IDMxMzEgKGxleGljYWwgZXhjZXB0aW9uIHN0YWNraW5nLCBpbmNsdWRpbmcgUE9QX0VYQ0VQVCkKICAgIFB5dGhvbiAzLjFhMDogMzE0MSAob3B0aW1pemUgbGlzdCwgc2V0IGFuZCBkaWN0IGNvbXByZWhlbnNpb25zOgogICAgICAgICAgICBjaGFuZ2UgTElTVF9BUFBFTkQgYW5kIFNFVF9BREQsIGFkZCBNQVBfQUREKQogICAgUHl0aG9uIDMuMWEwOiAzMTUxIChvcHRpbWl6ZSBjb25kaXRpb25hbCBicmFuY2hlczoKICAgICAgICAgICAgaW50cm9kdWNlIFBPUF9KVU1QX0lGX0ZBTFNFIGFuZCBQT1BfSlVNUF9JRl9UUlVFKQogICAgUHl0aG9uIDMuMmEwOiAzMTYwIChhZGQgU0VUVVBfV0lUSCkKICAgICAgICAgICAgICAgICAgdGFnOiBjcHl0aG9uLTMyCiAgICBQeXRob24gMy4yYTE6IDMxNzAgKGFkZCBEVVBfVE9QX1RXTywgcmVtb3ZlIERVUF9UT1BYIGFuZCBST1RfRk9VUikKICAgICAgICAgICAgICAgICAgdGFnOiBjcHl0aG9uLTMyCiAgICBQeXRob24gMy4yYTIgIDMxODAgKGFkZCBERUxFVEVfREVSRUYpCiAgICBQeXRob24gMy4zYTAgIDMxOTAgX19jbGFzc19fIHN1cGVyIGNsb3N1cmUgY2hhbmdlZAogICAgUHl0aG9uIDMuM2EwICAzMjAwIChfX3F1YWxuYW1lX18gYWRkZWQpCiAgICAgICAgICAgICAgICAgICAgIDMyMTAgKGFkZGVkIHNpemUgbW9kdWxvIDIqKjMyIHRvIHRoZSBweWMgaGVhZGVyKQogICAgUHl0aG9uIDMuM2ExICAzMjIwIChjaGFuZ2VkIFBFUCAzODAgaW1wbGVtZW50YXRpb24pCiAgICBQeXRob24gMy4zYTQgIDMyMzAgKHJldmVydCBjaGFuZ2VzIHRvIGltcGxpY2l0IF9fY2xhc3NfXyBjbG9zdXJlKQoKTUFHSUMgbXVzdCBjaGFuZ2Ugd2hlbmV2ZXIgdGhlIGJ5dGVjb2RlIGVtaXR0ZWQgYnkgdGhlIGNvbXBpbGVyIG1heSBubwpsb25nZXIgYmUgdW5kZXJzdG9vZCBieSBvbGRlciBpbXBsZW1lbnRhdGlvbnMgb2YgdGhlIGV2YWwgbG9vcCAodXN1YWxseQpkdWUgdG8gdGhlIGFkZGl0aW9uIG9mIG5ldyBvcGNvZGVzKS4KCiIiIgpfUkFXX01BR0lDX05VTUJFUiA9IDMyMzAgfCBvcmQoJ1xyJykgPDwgMTYgfCBvcmQoJ1xuJykgPDwgMjQKX01BR0lDX0JZVEVTID0gYnl0ZXMoX1JBV19NQUdJQ19OVU1CRVIgPj4gbiAmIDB4ZmYgZm9yIG4gaW4gcmFuZ2UoMCwgMjUsIDgpKQoKX1BZQ0FDSEUgPSAnX19weWNhY2hlX18nCgpTT1VSQ0VfU1VGRklYRVMgPSBbJy5weSddICAjIF9zZXR1cCgpIGFkZHMgLnB5dyBhcyBuZWVkZWQuCgpERUJVR19CWVRFQ09ERV9TVUZGSVhFUyA9IFsnLnB5YyddCk9QVElNSVpFRF9CWVRFQ09ERV9TVUZGSVhFUyA9IFsnLnB5byddCmlmIF9fZGVidWdfXzoKICAgIEJZVEVDT0RFX1NVRkZJWEVTID0gREVCVUdfQllURUNPREVfU1VGRklYRVMKZWxzZToKICAgIEJZVEVDT0RFX1NVRkZJWEVTID0gT1BUSU1JWkVEX0JZVEVDT0RFX1NVRkZJWEVTCgpkZWYgY2FjaGVfZnJvbV9zb3VyY2UocGF0aCwgZGVidWdfb3ZlcnJpZGU9Tm9uZSk6CiAgICAiIiJHaXZlbiB0aGUgcGF0aCB0byBhIC5weSBmaWxlLCByZXR1cm4gdGhlIHBhdGggdG8gaXRzIC5weWMvLnB5byBmaWxlLgoKICAgIFRoZSAucHkgZmlsZSBkb2VzIG5vdCBuZWVkIHRvIGV4aXN0OyB0aGlzIHNpbXBseSByZXR1cm5zIHRoZSBwYXRoIHRvIHRoZQogICAgLnB5Yy8ucHlvIGZpbGUgY2FsY3VsYXRlZCBhcyBpZiB0aGUgLnB5IGZpbGUgd2VyZSBpbXBvcnRlZC4gIFRoZSBleHRlbnNpb24KICAgIHdpbGwgYmUgLnB5YyB1bmxlc3MgX19kZWJ1Z19fIGlzIG5vdCBkZWZpbmVkLCB0aGVuIGl0IHdpbGwgYmUgLnB5by4KCiAgICBJZiBkZWJ1Z19vdmVycmlkZSBpcyBub3QgTm9uZSwgdGhlbiBpdCBtdXN0IGJlIGEgYm9vbGVhbiBhbmQgaXMgdGFrZW4gYXMKICAgIHRoZSB2YWx1ZSBvZiBfX2RlYnVnX18gaW5zdGVhZC4KCiAgICBJZiBzeXMuaW1wbGVtZW50YXRpb24uY2FjaGVfdGFnIGlzIE5vbmUgdGhlbiBOb3RJbXBsZW1lbnRlZEVycm9yIGlzIHJhaXNlZC4KCiAgICAiIiIKICAgIGRlYnVnID0gX19kZWJ1Z19fIGlmIGRlYnVnX292ZXJyaWRlIGlzIE5vbmUgZWxzZSBkZWJ1Z19vdmVycmlkZQogICAgaWYgZGVidWc6CiAgICAgICAgc3VmZml4ZXMgPSBERUJVR19CWVRFQ09ERV9TVUZGSVhFUwogICAgZWxzZToKICAgICAgICBzdWZmaXhlcyA9IE9QVElNSVpFRF9CWVRFQ09ERV9TVUZGSVhFUwogICAgaGVhZCwgdGFpbCA9IF9wYXRoX3NwbGl0KHBhdGgpCiAgICBiYXNlX2ZpbGVuYW1lLCBzZXAsIF8gPSB0YWlsLnBhcnRpdGlvbignLicpCiAgICB0YWcgPSBzeXMuaW1wbGVtZW50YXRpb24uY2FjaGVfdGFnCiAgICBpZiB0YWcgaXMgTm9uZToKICAgICAgICByYWlzZSBOb3RJbXBsZW1lbnRlZEVycm9yKCdzeXMuaW1wbGVtZW50YXRpb24uY2FjaGVfdGFnIGlzIE5vbmUnKQogICAgZmlsZW5hbWUgPSAnJy5qb2luKFtiYXNlX2ZpbGVuYW1lLCBzZXAsIHRhZywgc3VmZml4ZXNbMF1dKQogICAgcmV0dXJuIF9wYXRoX2pvaW4oaGVhZCwgX1BZQ0FDSEUsIGZpbGVuYW1lKQoKCmRlZiBzb3VyY2VfZnJvbV9jYWNoZShwYXRoKToKICAgICIiIkdpdmVuIHRoZSBwYXRoIHRvIGEgLnB5Yy4vLnB5byBmaWxlLCByZXR1cm4gdGhlIHBhdGggdG8gaXRzIC5weSBmaWxlLgoKICAgIFRoZSAucHljLy5weW8gZmlsZSBkb2VzIG5vdCBuZWVkIHRvIGV4aXN0OyB0aGlzIHNpbXBseSByZXR1cm5zIHRoZSBwYXRoIHRvCiAgICB0aGUgLnB5IGZpbGUgY2FsY3VsYXRlZCB0byBjb3JyZXNwb25kIHRvIHRoZSAucHljLy5weW8gZmlsZS4gIElmIHBhdGggZG9lcwogICAgbm90IGNvbmZvcm0gdG8gUEVQIDMxNDcgZm9ybWF0LCBWYWx1ZUVycm9yIHdpbGwgYmUgcmFpc2VkLiBJZgogICAgc3lzLmltcGxlbWVudGF0aW9uLmNhY2hlX3RhZyBpcyBOb25lIHRoZW4gTm90SW1wbGVtZW50ZWRFcnJvciBpcyByYWlzZWQuCgogICAgIiIiCiAgICBpZiBzeXMuaW1wbGVtZW50YXRpb24uY2FjaGVfdGFnIGlzIE5vbmU6CiAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcignc3lzLmltcGxlbWVudGF0aW9uLmNhY2hlX3RhZyBpcyBOb25lJykKICAgIGhlYWQsIHB5Y2FjaGVfZmlsZW5hbWUgPSBfcGF0aF9zcGxpdChwYXRoKQogICAgaGVhZCwgcHljYWNoZSA9IF9wYXRoX3NwbGl0KGhlYWQpCiAgICBpZiBweWNhY2hlICE9IF9QWUNBQ0hFOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoJ3t9IG5vdCBib3R0b20tbGV2ZWwgZGlyZWN0b3J5IGluICcKICAgICAgICAgICAgICAgICAgICAgICAgICd7IXJ9Jy5mb3JtYXQoX1BZQ0FDSEUsIHBhdGgpKQogICAgaWYgcHljYWNoZV9maWxlbmFtZS5jb3VudCgnLicpICE9IDI6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignZXhwZWN0ZWQgb25seSAyIGRvdHMgaW4gJwogICAgICAgICAgICAgICAgICAgICAgICAgJ3shcn0nLmZvcm1hdChweWNhY2hlX2ZpbGVuYW1lKSkKICAgIGJhc2VfZmlsZW5hbWUgPSBweWNhY2hlX2ZpbGVuYW1lLnBhcnRpdGlvbignLicpWzBdCiAgICByZXR1cm4gX3BhdGhfam9pbihoZWFkLCBiYXNlX2ZpbGVuYW1lICsgU09VUkNFX1NVRkZJWEVTWzBdKQoKCmRlZiBfZ2V0X3NvdXJjZWZpbGUoYnl0ZWNvZGVfcGF0aCk6CiAgICAiIiJDb252ZXJ0IGEgYnl0ZWNvZGUgZmlsZSBwYXRoIHRvIGEgc291cmNlIHBhdGggKGlmIHBvc3NpYmxlKS4KCiAgICBUaGlzIGZ1bmN0aW9uIGV4aXN0cyBwdXJlbHkgZm9yIGJhY2t3YXJkcy1jb21wYXRpYmlsaXR5IGZvcgogICAgUHlJbXBvcnRfRXhlY0NvZGVNb2R1bGVXaXRoRmlsZW5hbWVzKCkgaW4gdGhlIEMgQVBJLgoKICAgICIiIgogICAgaWYgbGVuKGJ5dGVjb2RlX3BhdGgpID09IDA6CiAgICAgICAgcmV0dXJuIE5vbmUKICAgIHJlc3QsIF8sIGV4dGVuc2lvbiA9IGJ5dGVjb2RlX3BhdGgucnBhcml0aW9uKCcuJykKICAgIGlmIG5vdCByZXN0IG9yIGV4dGVuc2lvbi5sb3dlcigpWy0zOi0xXSAhPSAnLnB5JzoKICAgICAgICByZXR1cm4gYnl0ZWNvZGVfcGF0aAoKICAgIHRyeToKICAgICAgICBzb3VyY2VfcGF0aCA9IHNvdXJjZV9mcm9tX2NhY2hlKGJ5dGVjb2RlX3BhdGgpCiAgICBleGNlcHQgKE5vdEltcGxlbWVudGVkRXJyb3IsIFZhbHVlRXJyb3IpOgogICAgICAgIHNvdXJjZV9wYXRoID0gYnl0Y29kZV9wYXRoWy0xOl0KCiAgICByZXR1cm4gc291cmNlX3BhdGggaWYgX3BhdGhfaXNmaWxlKHNvdXJjZV9zdGF0cykgZWxzZSBieXRlY29kZV9wYXRoCgoKZGVmIF92ZXJib3NlX21lc3NhZ2UobWVzc2FnZSwgKmFyZ3MpOgogICAgIiIiUHJpbnQgdGhlIG1lc3NhZ2UgdG8gc3RkZXJyIGlmIC12L1BZVEhPTlZFUkJPU0UgaXMgdHVybmVkIG9uLiIiIgogICAgaWYgc3lzLmZsYWdzLnZlcmJvc2U6CiAgICAgICAgaWYgbm90IG1lc3NhZ2Uuc3RhcnRzd2l0aCgoJyMnLCAnaW1wb3J0ICcpKToKICAgICAgICAgICAgbWVzc2FnZSA9ICcjICcgKyBtZXNzYWdlCiAgICAgICAgcHJpbnQobWVzc2FnZS5mb3JtYXQoKmFyZ3MpLCBmaWxlPXN5cy5zdGRlcnIpCgoKZGVmIHNldF9wYWNrYWdlKGZ4bik6CiAgICAiIiJTZXQgX19wYWNrYWdlX18gb24gdGhlIHJldHVybmVkIG1vZHVsZS4iIiIKICAgIGRlZiBzZXRfcGFja2FnZV93cmFwcGVyKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgbW9kdWxlID0gZnhuKCphcmdzLCAqKmt3YXJncykKICAgICAgICBpZiBnZXRhdHRyKG1vZHVsZSwgJ19fcGFja2FnZV9fJywgTm9uZSkgaXMgTm9uZToKICAgICAgICAgICAgbW9kdWxlLl9fcGFja2FnZV9fID0gbW9kdWxlLl9fbmFtZV9fCiAgICAgICAgICAgIGlmIG5vdCBoYXNhdHRyKG1vZHVsZSwgJ19fcGF0aF9fJyk6CiAgICAgICAgICAgICAgICBtb2R1bGUuX19wYWNrYWdlX18gPSBtb2R1bGUuX19wYWNrYWdlX18ucnBhcnRpdGlvbignLicpWzBdCiAgICAgICAgcmV0dXJuIG1vZHVsZQogICAgX3dyYXAoc2V0X3BhY2thZ2Vfd3JhcHBlciwgZnhuKQogICAgcmV0dXJuIHNldF9wYWNrYWdlX3dyYXBwZXIKCgpkZWYgc2V0X2xvYWRlcihmeG4pOgogICAgIiIiU2V0IF9fbG9hZGVyX18gb24gdGhlIHJldHVybmVkIG1vZHVsZS4iIiIKICAgIGRlZiBzZXRfbG9hZGVyX3dyYXBwZXIoc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICBtb2R1bGUgPSBmeG4oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKQogICAgICAgIGlmIG5vdCBoYXNhdHRyKG1vZHVsZSwgJ19fbG9hZGVyX18nKToKICAgICAgICAgICAgbW9kdWxlLl9fbG9hZGVyX18gPSBzZWxmCiAgICAgICAgcmV0dXJuIG1vZHVsZQogICAgX3dyYXAoc2V0X2xvYWRlcl93cmFwcGVyLCBmeG4pCiAgICByZXR1cm4gc2V0X2xvYWRlcl93cmFwcGVyCgoKZGVmIG1vZHVsZV9mb3JfbG9hZGVyKGZ4bik6CiAgICAiIiJEZWNvcmF0b3IgdG8gaGFuZGxlIHNlbGVjdGluZyB0aGUgcHJvcGVyIG1vZHVsZSBmb3IgbG9hZGVycy4KCiAgICBUaGUgZGVjb3JhdGVkIGZ1bmN0aW9uIGlzIHBhc3NlZCB0aGUgbW9kdWxlIHRvIHVzZSBpbnN0ZWFkIG9mIHRoZSBtb2R1bGUKICAgIG5hbWUuIFRoZSBtb2R1bGUgcGFzc2VkIGluIHRvIHRoZSBmdW5jdGlvbiBpcyBlaXRoZXIgZnJvbSBzeXMubW9kdWxlcyBpZgogICAgaXQgYWxyZWFkeSBleGlzdHMgb3IgaXMgYSBuZXcgbW9kdWxlLiBJZiB0aGUgbW9kdWxlIGlzIG5ldywgdGhlbiBfX25hbWVfXwogICAgaXMgc2V0IHRoZSBmaXJzdCBhcmd1bWVudCB0byB0aGUgbWV0aG9kLCBfX2xvYWRlcl9fIGlzIHNldCB0byBzZWxmLCBhbmQKICAgIF9fcGFja2FnZV9fIGlzIHNldCBhY2NvcmRpbmdseSAoaWYgc2VsZi5pc19wYWNrYWdlKCkgaXMgZGVmaW5lZCkgd2lsbCBiZSBzZXQKICAgIGJlZm9yZSBpdCBpcyBwYXNzZWQgdG8gdGhlIGRlY29yYXRlZCBmdW5jdGlvbiAoaWYgc2VsZi5pc19wYWNrYWdlKCkgZG9lcwogICAgbm90IHdvcmsgZm9yIHRoZSBtb2R1bGUgaXQgd2lsbCBiZSBzZXQgcG9zdC1sb2FkKS4KCiAgICBJZiBhbiBleGNlcHRpb24gaXMgcmFpc2VkIGFuZCB0aGUgZGVjb3JhdG9yIGNyZWF0ZWQgdGhlIG1vZHVsZSBpdCBpcwogICAgc3Vic2VxdWVudGx5IHJlbW92ZWQgZnJvbSBzeXMubW9kdWxlcy4KCiAgICBUaGUgZGVjb3JhdG9yIGFzc3VtZXMgdGhhdCB0aGUgZGVjb3JhdGVkIGZ1bmN0aW9uIHRha2VzIHRoZSBtb2R1bGUgbmFtZSBhcwogICAgdGhlIHNlY29uZCBhcmd1bWVudC4KCiAgICAiIiIKICAgIGRlZiBtb2R1bGVfZm9yX2xvYWRlcl93cmFwcGVyKHNlbGYsIGZ1bGxuYW1lLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgIG1vZHVsZSA9IHN5cy5tb2R1bGVzLmdldChmdWxsbmFtZSkKICAgICAgICBpc19yZWxvYWQgPSBtb2R1bGUgaXMgbm90IE5vbmUKICAgICAgICBpZiBub3QgaXNfcmVsb2FkOgogICAgICAgICAgICAjIFRoaXMgbXVzdCBiZSBkb25lIGJlZm9yZSBvcGVuKCkgaXMgY2FsbGVkIGFzIHRoZSAnaW8nIG1vZHVsZQogICAgICAgICAgICAjIGltcGxpY2l0bHkgaW1wb3J0cyAnbG9jYWxlJyBhbmQgd291bGQgb3RoZXJ3aXNlIHRyaWdnZXIgYW4KICAgICAgICAgICAgIyBpbmZpbml0ZSBsb29wLgogICAgICAgICAgICBtb2R1bGUgPSBuZXdfbW9kdWxlKGZ1bGxuYW1lKQogICAgICAgICAgICBzeXMubW9kdWxlc1tmdWxsbmFtZV0gPSBtb2R1bGUKICAgICAgICAgICAgbW9kdWxlLl9fbG9hZGVyX18gPSBzZWxmCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlzX3BhY2thZ2UgPSBzZWxmLmlzX3BhY2thZ2UoZnVsbG5hbWUpCiAgICAgICAgICAgIGV4Y2VwdCAoSW1wb3J0RXJyb3IsIEF0dHJpYnV0ZUVycm9yKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIGlzX3BhY2thZ2U6CiAgICAgICAgICAgICAgICAgICAgbW9kdWxlLl9fcGFja2FnZV9fID0gZnVsbG5hbWUKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgbW9kdWxlLl9fcGFja2FnZV9fID0gZnVsbG5hbWUucnBhcnRpdGlvbignLicpWzBdCiAgICAgICAgdHJ5OgogICAgICAgICAgICBtb2R1bGUuX19pbml0aWFsaXppbmdfXyA9IFRydWUKICAgICAgICAgICAgIyBJZiBfX3BhY2thZ2VfXyB3YXMgbm90IHNldCBhYm92ZSwgX19pbXBvcnRfXygpIHdpbGwgZG8gaXQgbGF0ZXIuCiAgICAgICAgICAgIHJldHVybiBmeG4oc2VsZiwgbW9kdWxlLCAqYXJncywgKiprd2FyZ3MpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBpZiBub3QgaXNfcmVsb2FkOgogICAgICAgICAgICAgICAgZGVsIHN5cy5tb2R1bGVzW2Z1bGxuYW1lXQogICAgICAgICAgICByYWlzZQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIG1vZHVsZS5fX2luaXRpYWxpemluZ19fID0gRmFsc2UKICAgIF93cmFwKG1vZHVsZV9mb3JfbG9hZGVyX3dyYXBwZXIsIGZ4bikKICAgIHJldHVybiBtb2R1bGVfZm9yX2xvYWRlcl93cmFwcGVyCgoKZGVmIF9jaGVja19uYW1lKG1ldGhvZCk6CiAgICAiIiJEZWNvcmF0b3IgdG8gdmVyaWZ5IHRoYXQgdGhlIG1vZHVsZSBiZWluZyByZXF1ZXN0ZWQgbWF0Y2hlcyB0aGUgb25lIHRoZQogICAgbG9hZGVyIGNhbiBoYW5kbGUuCgogICAgVGhlIGZpcnN0IGFyZ3VtZW50IChzZWxmKSBtdXN0IGRlZmluZSBfbmFtZSB3aGljaCB0aGUgc2Vjb25kIGFyZ3VtZW50IGlzCiAgICBjb21wYXJlZCBhZ2FpbnN0LiBJZiB0aGUgY29tcGFyaXNvbiBmYWlscyB0aGVuIEltcG9ydEVycm9yIGlzIHJhaXNlZC4KCiAgICAiIiIKICAgIGRlZiBfY2hlY2tfbmFtZV93cmFwcGVyKHNlbGYsIG5hbWU9Tm9uZSwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICBpZiBuYW1lIGlzIE5vbmU6CiAgICAgICAgICAgIG5hbWUgPSBzZWxmLm5hbWUKICAgICAgICBlbGlmIHNlbGYubmFtZSAhPSBuYW1lOgogICAgICAgICAgICByYWlzZSBJbXBvcnRFcnJvcigibG9hZGVyIGNhbm5vdCBoYW5kbGUgJXMiICUgbmFtZSwgbmFtZT1uYW1lKQogICAgICAgIHJldHVybiBtZXRob2Qoc2VsZiwgbmFtZSwgKmFyZ3MsICoqa3dhcmdzKQogICAgX3dyYXAoX2NoZWNrX25hbWVfd3JhcHBlciwgbWV0aG9kKQogICAgcmV0dXJuIF9jaGVja19uYW1lX3dyYXBwZXIKCgpkZWYgX3JlcXVpcmVzX2J1aWx0aW4oZnhuKToKICAgICIiIkRlY29yYXRvciB0byB2ZXJpZnkgdGhlIG5hbWVkIG1vZHVsZSBpcyBidWlsdC1pbi4iIiIKICAgIGRlZiBfcmVxdWlyZXNfYnVpbHRpbl93cmFwcGVyKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICBpZiBmdWxsbmFtZSBub3QgaW4gc3lzLmJ1aWx0aW5fbW9kdWxlX25hbWVzOgogICAgICAgICAgICByYWlzZSBJbXBvcnRFcnJvcigie30gaXMgbm90IGEgYnVpbHQtaW4gbW9kdWxlIi5mb3JtYXQoZnVsbG5hbWUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPWZ1bGxuYW1lKQogICAgICAgIHJldHVybiBmeG4oc2VsZiwgZnVsbG5hbWUpCiAgICBfd3JhcChfcmVxdWlyZXNfYnVpbHRpbl93cmFwcGVyLCBmeG4pCiAgICByZXR1cm4gX3JlcXVpcmVzX2J1aWx0aW5fd3JhcHBlcgoKCmRlZiBfcmVxdWlyZXNfZnJvemVuKGZ4bik6CiAgICAiIiJEZWNvcmF0b3IgdG8gdmVyaWZ5IHRoZSBuYW1lZCBtb2R1bGUgaXMgZnJvemVuLiIiIgogICAgZGVmIF9yZXF1aXJlc19mcm96ZW5fd3JhcHBlcihzZWxmLCBmdWxsbmFtZSk6CiAgICAgICAgaWYgbm90IF9pbXAuaXNfZnJvemVuKGZ1bGxuYW1lKToKICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IoInt9IGlzIG5vdCBhIGZyb3plbiBtb2R1bGUiLmZvcm1hdChmdWxsbmFtZSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9ZnVsbG5hbWUpCiAgICAgICAgcmV0dXJuIGZ4bihzZWxmLCBmdWxsbmFtZSkKICAgIF93cmFwKF9yZXF1aXJlc19mcm96ZW5fd3JhcHBlciwgZnhuKQogICAgcmV0dXJuIF9yZXF1aXJlc19mcm96ZW5fd3JhcHBlcgoKCmRlZiBfZmluZF9tb2R1bGVfc2hpbShzZWxmLCBmdWxsbmFtZSk6CiAgICAiIiJUcnkgdG8gZmluZCBhIGxvYWRlciBmb3IgdGhlIHNwZWNpZmllZCBtb2R1bGUgYnkgZGVsZWdhdGluZyB0bwogICAgc2VsZi5maW5kX2xvYWRlcigpLiIiIgogICAgIyBDYWxsIGZpbmRfbG9hZGVyKCkuIElmIGl0IHJldHVybnMgYSBzdHJpbmcgKGluZGljYXRpbmcgdGhpcwogICAgIyBpcyBhIG5hbWVzcGFjZSBwYWNrYWdlIHBvcnRpb24pLCBnZW5lcmF0ZSBhIHdhcm5pbmcgYW5kCiAgICAjIHJldHVybiBOb25lLgogICAgbG9hZGVyLCBwb3J0aW9ucyA9IHNlbGYuZmluZF9sb2FkZXIoZnVsbG5hbWUpCiAgICBpZiBsb2FkZXIgaXMgTm9uZSBhbmQgbGVuKHBvcnRpb25zKToKICAgICAgICBtc2cgPSAiTm90IGltcG9ydGluZyBkaXJlY3Rvcnkge306IG1pc3NpbmcgX19pbml0X18iCiAgICAgICAgX3dhcm5pbmdzLndhcm4obXNnLmZvcm1hdChwb3J0aW9uc1swXSksIEltcG9ydFdhcm5pbmcpCiAgICByZXR1cm4gbG9hZGVyCgoKCgojIExvYWRlcnMgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpjbGFzcyBCdWlsdGluSW1wb3J0ZXI6CgogICAgIiIiTWV0YSBwYXRoIGltcG9ydCBmb3IgYnVpbHQtaW4gbW9kdWxlcy4KCiAgICBBbGwgbWV0aG9kcyBhcmUgZWl0aGVyIGNsYXNzIG9yIHN0YXRpYyBtZXRob2RzIHRvIGF2b2lkIHRoZSBuZWVkIHRvCiAgICBpbnN0YW50aWF0ZSB0aGUgY2xhc3MuCgogICAgIiIiCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgbW9kdWxlX3JlcHIoY2xzLCBtb2R1bGUpOgogICAgICAgIHJldHVybiAiPG1vZHVsZSAne30nIChidWlsdC1pbik+Ii5mb3JtYXQobW9kdWxlLl9fbmFtZV9fKQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIGZpbmRfbW9kdWxlKGNscywgZnVsbG5hbWUsIHBhdGg9Tm9uZSk6CiAgICAgICAgIiIiRmluZCB0aGUgYnVpbHQtaW4gbW9kdWxlLgoKICAgICAgICBJZiAncGF0aCcgaXMgZXZlciBzcGVjaWZpZWQgdGhlbiB0aGUgc2VhcmNoIGlzIGNvbnNpZGVyZWQgYSBmYWlsdXJlLgoKICAgICAgICAiIiIKICAgICAgICBpZiBwYXRoIGlzIG5vdCBOb25lOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIHJldHVybiBjbHMgaWYgX2ltcC5pc19idWlsdGluKGZ1bGxuYW1lKSBlbHNlIE5vbmUKCiAgICBAY2xhc3NtZXRob2QKICAgIEBzZXRfcGFja2FnZQogICAgQHNldF9sb2FkZXIKICAgIEBfcmVxdWlyZXNfYnVpbHRpbgogICAgZGVmIGxvYWRfbW9kdWxlKGNscywgZnVsbG5hbWUpOgogICAgICAgICIiIkxvYWQgYSBidWlsdC1pbiBtb2R1bGUuIiIiCiAgICAgICAgaXNfcmVsb2FkID0gZnVsbG5hbWUgaW4gc3lzLm1vZHVsZXMKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJldHVybiBfY2FsbF93aXRoX2ZyYW1lc19yZW1vdmVkKF9pbXAuaW5pdF9idWlsdGluLCBmdWxsbmFtZSkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIGlmIG5vdCBpc19yZWxvYWQgYW5kIGZ1bGxuYW1lIGluIHN5cy5tb2R1bGVzOgogICAgICAgICAgICAgICAgZGVsIHN5cy5tb2R1bGVzW2Z1bGxuYW1lXQogICAgICAgICAgICByYWlzZQoKICAgIEBjbGFzc21ldGhvZAogICAgQF9yZXF1aXJlc19idWlsdGluCiAgICBkZWYgZ2V0X2NvZGUoY2xzLCBmdWxsbmFtZSk6CiAgICAgICAgIiIiUmV0dXJuIE5vbmUgYXMgYnVpbHQtaW4gbW9kdWxlcyBkbyBub3QgaGF2ZSBjb2RlIG9iamVjdHMuIiIiCiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBAY2xhc3NtZXRob2QKICAgIEBfcmVxdWlyZXNfYnVpbHRpbgogICAgZGVmIGdldF9zb3VyY2UoY2xzLCBmdWxsbmFtZSk6CiAgICAgICAgIiIiUmV0dXJuIE5vbmUgYXMgYnVpbHQtaW4gbW9kdWxlcyBkbyBub3QgaGF2ZSBzb3VyY2UgY29kZS4iIiIKICAgICAgICByZXR1cm4gTm9uZQoKICAgIEBjbGFzc21ldGhvZAogICAgQF9yZXF1aXJlc19idWlsdGluCiAgICBkZWYgaXNfcGFja2FnZShjbHMsIGZ1bGxuYW1lKToKICAgICAgICAiIiJSZXR1cm4gRmFsc2UgYXMgYnVpbHQtaW4gbW9kdWxlcyBhcmUgbmV2ZXIgcGFja2FnZXMuIiIiCiAgICAgICAgcmV0dXJuIEZhbHNlCgoKY2xhc3MgRnJvemVuSW1wb3J0ZXI6CgogICAgIiIiTWV0YSBwYXRoIGltcG9ydCBmb3IgZnJvemVuIG1vZHVsZXMuCgogICAgQWxsIG1ldGhvZHMgYXJlIGVpdGhlciBjbGFzcyBvciBzdGF0aWMgbWV0aG9kcyB0byBhdm9pZCB0aGUgbmVlZCB0bwogICAgaW5zdGFudGlhdGUgdGhlIGNsYXNzLgoKICAgICIiIgoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIG1vZHVsZV9yZXByKGNscywgbSk6CiAgICAgICAgcmV0dXJuICI8bW9kdWxlICd7fScgKGZyb3plbik+Ii5mb3JtYXQobS5fX25hbWVfXykKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBmaW5kX21vZHVsZShjbHMsIGZ1bGxuYW1lLCBwYXRoPU5vbmUpOgogICAgICAgICIiIkZpbmQgYSBmcm96ZW4gbW9kdWxlLiIiIgogICAgICAgIHJldHVybiBjbHMgaWYgX2ltcC5pc19mcm96ZW4oZnVsbG5hbWUpIGVsc2UgTm9uZQoKICAgIEBjbGFzc21ldGhvZAogICAgQHNldF9wYWNrYWdlCiAgICBAc2V0X2xvYWRlcgogICAgQF9yZXF1aXJlc19mcm96ZW4KICAgIGRlZiBsb2FkX21vZHVsZShjbHMsIGZ1bGxuYW1lKToKICAgICAgICAiIiJMb2FkIGEgZnJvemVuIG1vZHVsZS4iIiIKICAgICAgICBpc19yZWxvYWQgPSBmdWxsbmFtZSBpbiBzeXMubW9kdWxlcwogICAgICAgIHRyeToKICAgICAgICAgICAgbSA9IF9jYWxsX3dpdGhfZnJhbWVzX3JlbW92ZWQoX2ltcC5pbml0X2Zyb3plbiwgZnVsbG5hbWUpCiAgICAgICAgICAgICMgTGV0IG91ciBvd24gbW9kdWxlX3JlcHIoKSBtZXRob2QgcHJvZHVjZSBhIHN1aXRhYmxlIHJlcHIuCiAgICAgICAgICAgIGRlbCBtLl9fZmlsZV9fCiAgICAgICAgICAgIHJldHVybiBtCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBpZiBub3QgaXNfcmVsb2FkIGFuZCBmdWxsbmFtZSBpbiBzeXMubW9kdWxlczoKICAgICAgICAgICAgICAgIGRlbCBzeXMubW9kdWxlc1tmdWxsbmFtZV0KICAgICAgICAgICAgcmFpc2UKCiAgICBAY2xhc3NtZXRob2QKICAgIEBfcmVxdWlyZXNfZnJvemVuCiAgICBkZWYgZ2V0X2NvZGUoY2xzLCBmdWxsbmFtZSk6CiAgICAgICAgIiIiUmV0dXJuIHRoZSBjb2RlIG9iamVjdCBmb3IgdGhlIGZyb3plbiBtb2R1bGUuIiIiCiAgICAgICAgcmV0dXJuIF9pbXAuZ2V0X2Zyb3plbl9vYmplY3QoZnVsbG5hbWUpCgogICAgQGNsYXNzbWV0aG9kCiAgICBAX3JlcXVpcmVzX2Zyb3plbgogICAgZGVmIGdldF9zb3VyY2UoY2xzLCBmdWxsbmFtZSk6CiAgICAgICAgIiIiUmV0dXJuIE5vbmUgYXMgZnJvemVuIG1vZHVsZXMgZG8gbm90IGhhdmUgc291cmNlIGNvZGUuIiIiCiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBAY2xhc3NtZXRob2QKICAgIEBfcmVxdWlyZXNfZnJvemVuCiAgICBkZWYgaXNfcGFja2FnZShjbHMsIGZ1bGxuYW1lKToKICAgICAgICAiIiJSZXR1cm4gVHJ1ZSBpZiB0aGUgZnJvemVuIG1vZHVsZSBpcyBhIHBhY2thZ2UuIiIiCiAgICAgICAgcmV0dXJuIF9pbXAuaXNfZnJvemVuX3BhY2thZ2UoZnVsbG5hbWUpCgoKY2xhc3MgV2luZG93c1JlZ2lzdHJ5RmluZGVyOgoKICAgICIiIk1ldGEgcGF0aCBmaW5kZXIgZm9yIG1vZHVsZXMgZGVjbGFyZWQgaW4gdGhlIFdpbmRvd3MgcmVnaXN0cnkuCiAgICAiIiIKCiAgICBSRUdJU1RSWV9LRVkgPSAoCiAgICAgICAgIlNvZnR3YXJlXFxQeXRob25cXFB5dGhvbkNvcmVcXHtzeXNfdmVyc2lvbn0iCiAgICAgICAgIlxcTW9kdWxlc1xce2Z1bGxuYW1lfSIpCiAgICBSRUdJU1RSWV9LRVlfREVCVUcgPSAoCiAgICAgICAgIlNvZnR3YXJlXFxQeXRob25cXFB5dGhvbkNvcmVcXHtzeXNfdmVyc2lvbn0iCiAgICAgICAgIlxcTW9kdWxlc1xce2Z1bGxuYW1lfVxcRGVidWciKQogICAgREVCVUdfQlVJTEQgPSBGYWxzZSAgIyBDaGFuZ2VkIGluIF9zZXR1cCgpCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgX29wZW5fcmVnaXN0cnkoY2xzLCBrZXkpOgogICAgICAgIHRyeToKICAgICAgICAgICAgcmV0dXJuIF93aW5yZWcuT3BlbktleShfd2lucmVnLkhLRVlfQ1VSUkVOVF9VU0VSLCBrZXkpCiAgICAgICAgZXhjZXB0IFdpbmRvd3NFcnJvcjoKICAgICAgICAgICAgcmV0dXJuIF93aW5yZWcuT3BlbktleShfd2lucmVnLkhLRVlfTE9DQUxfTUFDSElORSwga2V5KQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIF9zZWFyY2hfcmVnaXN0cnkoY2xzLCBmdWxsbmFtZSk6CiAgICAgICAgaWYgY2xzLkRFQlVHX0JVSUxEOgogICAgICAgICAgICByZWdpc3RyeV9rZXkgPSBjbHMuUkVHSVNUUllfS0VZX0RFQlVHCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmVnaXN0cnlfa2V5ID0gY2xzLlJFR0lTVFJZX0tFWQogICAgICAgIGtleSA9IHJlZ2lzdHJ5X2tleS5mb3JtYXQoZnVsbG5hbWU9ZnVsbG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeXNfdmVyc2lvbj1zeXMudmVyc2lvbls6M10pCiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aXRoIGNscy5fb3Blbl9yZWdpc3RyeShrZXkpIGFzIGhrZXk6CiAgICAgICAgICAgICAgICBmaWxlcGF0aCA9IF93aW5yZWcuUXVlcnlWYWx1ZShoa2V5LCAiIikKICAgICAgICBleGNlcHQgV2luZG93c0Vycm9yOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIHJldHVybiBmaWxlcGF0aAoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIGZpbmRfbW9kdWxlKGNscywgZnVsbG5hbWUsIHBhdGg9Tm9uZSk6CiAgICAgICAgIiIiRmluZCBtb2R1bGUgbmFtZWQgaW4gdGhlIHJlZ2lzdHJ5LiIiIgogICAgICAgIGZpbGVwYXRoID0gY2xzLl9zZWFyY2hfcmVnaXN0cnkoZnVsbG5hbWUpCiAgICAgICAgaWYgZmlsZXBhdGggaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICB0cnk6CiAgICAgICAgICAgIF9vcy5zdGF0KGZpbGVwYXRoKQogICAgICAgIGV4Y2VwdCBPU0Vycm9yOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIGZvciBsb2FkZXIsIHN1ZmZpeGVzLCBfIGluIF9nZXRfc3VwcG9ydGVkX2ZpbGVfbG9hZGVycygpOgogICAgICAgICAgICBpZiBmaWxlcGF0aC5lbmRzd2l0aCh0dXBsZShzdWZmaXhlcykpOgogICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRlcihmdWxsbmFtZSwgZmlsZXBhdGgpCgoKY2xhc3MgX0xvYWRlckJhc2ljczoKCiAgICAiIiJCYXNlIGNsYXNzIG9mIGNvbW1vbiBjb2RlIG5lZWRlZCBieSBib3RoIFNvdXJjZUxvYWRlciBhbmQKICAgIFNvdXJjZWxlc3NGaWxlTG9hZGVyLiIiIgoKICAgIGRlZiBpc19wYWNrYWdlKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICAiIiJDb25jcmV0ZSBpbXBsZW1lbnRhdGlvbiBvZiBJbnNwZWN0TG9hZGVyLmlzX3BhY2thZ2UgYnkgY2hlY2tpbmcgaWYKICAgICAgICB0aGUgcGF0aCByZXR1cm5lZCBieSBnZXRfZmlsZW5hbWUgaGFzIGEgZmlsZW5hbWUgb2YgJ19faW5pdF9fLnB5Jy4iIiIKICAgICAgICBmaWxlbmFtZSA9IF9wYXRoX3NwbGl0KHNlbGYuZ2V0X2ZpbGVuYW1lKGZ1bGxuYW1lKSlbMV0KICAgICAgICBmaWxlbmFtZV9iYXNlID0gZmlsZW5hbWUucnNwbGl0KCcuJywgMSlbMF0KICAgICAgICB0YWlsX25hbWUgPSBmdWxsbmFtZS5ycGFydGl0aW9uKCcuJylbMl0KICAgICAgICByZXR1cm4gZmlsZW5hbWVfYmFzZSA9PSAnX19pbml0X18nIGFuZCB0YWlsX25hbWUgIT0gJ19faW5pdF9fJwoKICAgIGRlZiBfYnl0ZXNfZnJvbV9ieXRlY29kZShzZWxmLCBmdWxsbmFtZSwgZGF0YSwgYnl0ZWNvZGVfcGF0aCwgc291cmNlX3N0YXRzKToKICAgICAgICAiIiJSZXR1cm4gdGhlIG1hcnNoYWxsZWQgYnl0ZXMgZnJvbSBieXRlY29kZSwgdmVyaWZ5aW5nIHRoZSBtYWdpYwogICAgICAgIG51bWJlciwgdGltZXN0YW1wIGFuZCBzb3VyY2Ugc2l6ZSBhbG9uZyB0aGUgd2F5LgoKICAgICAgICBJZiBzb3VyY2Vfc3RhdHMgaXMgTm9uZSB0aGVuIHNraXAgdGhlIHRpbWVzdGFtcCBjaGVjay4KCiAgICAgICAgIiIiCiAgICAgICAgbWFnaWMgPSBkYXRhWzo0XQogICAgICAgIHJhd190aW1lc3RhbXAgPSBkYXRhWzQ6OF0KICAgICAgICByYXdfc2l6ZSA9IGRhdGFbODoxMl0KICAgICAgICBpZiBtYWdpYyAhPSBfTUFHSUNfQllURVM6CiAgICAgICAgICAgIG1zZyA9ICdiYWQgbWFnaWMgbnVtYmVyIGluIHshcn06IHshcn0nLmZvcm1hdChmdWxsbmFtZSwgbWFnaWMpCiAgICAgICAgICAgIHJhaXNlIEltcG9ydEVycm9yKG1zZywgbmFtZT1mdWxsbmFtZSwgcGF0aD1ieXRlY29kZV9wYXRoKQogICAgICAgIGVsaWYgbGVuKHJhd190aW1lc3RhbXApICE9IDQ6CiAgICAgICAgICAgIG1lc3NhZ2UgPSAnYmFkIHRpbWVzdGFtcCBpbiB7fScuZm9ybWF0KGZ1bGxuYW1lKQogICAgICAgICAgICBfdmVyYm9zZV9tZXNzYWdlKG1lc3NhZ2UpCiAgICAgICAgICAgIHJhaXNlIEVPRkVycm9yKG1lc3NhZ2UpCiAgICAgICAgZWxpZiBsZW4ocmF3X3NpemUpICE9IDQ6CiAgICAgICAgICAgIG1lc3NhZ2UgPSAnYmFkIHNpemUgaW4ge30nLmZvcm1hdChmdWxsbmFtZSkKICAgICAgICAgICAgX3ZlcmJvc2VfbWVzc2FnZShtZXNzYWdlKQogICAgICAgICAgICByYWlzZSBFT0ZFcnJvcihtZXNzYWdlKQogICAgICAgIGlmIHNvdXJjZV9zdGF0cyBpcyBub3QgTm9uZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc291cmNlX210aW1lID0gaW50KHNvdXJjZV9zdGF0c1snbXRpbWUnXSkKICAgICAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgX3JfbG9uZyhyYXdfdGltZXN0YW1wKSAhPSBzb3VyY2VfbXRpbWU6CiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9ICdieXRlY29kZSBpcyBzdGFsZSBmb3Ige30nLmZvcm1hdChmdWxsbmFtZSkKICAgICAgICAgICAgICAgICAgICBfdmVyYm9zZV9tZXNzYWdlKG1lc3NhZ2UpCiAgICAgICAgICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IobWVzc2FnZSwgbmFtZT1mdWxsbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoPWJ5dGVjb2RlX3BhdGgpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNvdXJjZV9zaXplID0gc291cmNlX3N0YXRzWydzaXplJ10gJiAweEZGRkZGRkZGCiAgICAgICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIF9yX2xvbmcocmF3X3NpemUpICE9IHNvdXJjZV9zaXplOgogICAgICAgICAgICAgICAgICAgIHJhaXNlIEltcG9ydEVycm9yKAogICAgICAgICAgICAgICAgICAgICAgICAiYnl0ZWNvZGUgaXMgc3RhbGUgZm9yIHt9Ii5mb3JtYXQoZnVsbG5hbWUpLAogICAgICAgICAgICAgICAgICAgICAgICBuYW1lPWZ1bGxuYW1lLCBwYXRoPWJ5dGVjb2RlX3BhdGgpCiAgICAgICAgIyBDYW4ndCByZXR1cm4gdGhlIGNvZGUgb2JqZWN0IGFzIGVycm9ycyBmcm9tIG1hcnNoYWwgbG9hZGluZyBuZWVkIHRvCiAgICAgICAgIyBwcm9wYWdhdGUgZXZlbiB3aGVuIHNvdXJjZSBpcyBhdmFpbGFibGUuCiAgICAgICAgcmV0dXJuIGRhdGFbMTI6XQoKICAgIEBtb2R1bGVfZm9yX2xvYWRlcgogICAgZGVmIF9sb2FkX21vZHVsZShzZWxmLCBtb2R1bGUsICosIHNvdXJjZWxlc3M9RmFsc2UpOgogICAgICAgICIiIkhlbHBlciBmb3IgbG9hZF9tb2R1bGUgYWJsZSB0byBoYW5kbGUgZWl0aGVyIHNvdXJjZSBvciBzb3VyY2VsZXNzCiAgICAgICAgbG9hZGluZy4iIiIKICAgICAgICBuYW1lID0gbW9kdWxlLl9fbmFtZV9fCiAgICAgICAgY29kZV9vYmplY3QgPSBzZWxmLmdldF9jb2RlKG5hbWUpCiAgICAgICAgbW9kdWxlLl9fZmlsZV9fID0gc2VsZi5nZXRfZmlsZW5hbWUobmFtZSkKICAgICAgICBpZiBub3Qgc291cmNlbGVzczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgbW9kdWxlLl9fY2FjaGVkX18gPSBjYWNoZV9mcm9tX3NvdXJjZShtb2R1bGUuX19maWxlX18pCiAgICAgICAgICAgIGV4Y2VwdCBOb3RJbXBsZW1lbnRlZEVycm9yOgogICAgICAgICAgICAgICAgbW9kdWxlLl9fY2FjaGVkX18gPSBtb2R1bGUuX19maWxlX18KICAgICAgICBlbHNlOgogICAgICAgICAgICBtb2R1bGUuX19jYWNoZWRfXyA9IG1vZHVsZS5fX2ZpbGVfXwogICAgICAgIG1vZHVsZS5fX3BhY2thZ2VfXyA9IG5hbWUKICAgICAgICBpZiBzZWxmLmlzX3BhY2thZ2UobmFtZSk6CiAgICAgICAgICAgIG1vZHVsZS5fX3BhdGhfXyA9IFtfcGF0aF9zcGxpdChtb2R1bGUuX19maWxlX18pWzBdXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1vZHVsZS5fX3BhY2thZ2VfXyA9IG1vZHVsZS5fX3BhY2thZ2VfXy5ycGFydGl0aW9uKCcuJylbMF0KICAgICAgICBtb2R1bGUuX19sb2FkZXJfXyA9IHNlbGYKICAgICAgICBfY2FsbF93aXRoX2ZyYW1lc19yZW1vdmVkKGV4ZWMsIGNvZGVfb2JqZWN0LCBtb2R1bGUuX19kaWN0X18pCiAgICAgICAgcmV0dXJuIG1vZHVsZQoKCmNsYXNzIFNvdXJjZUxvYWRlcihfTG9hZGVyQmFzaWNzKToKCiAgICBkZWYgcGF0aF9tdGltZShzZWxmLCBwYXRoKToKICAgICAgICAiIiJPcHRpb25hbCBtZXRob2QgdGhhdCByZXR1cm5zIHRoZSBtb2RpZmljYXRpb24gdGltZSAoYW4gaW50KSBmb3IgdGhlCiAgICAgICAgc3BlY2lmaWVkIHBhdGgsIHdoZXJlIHBhdGggaXMgYSBzdHIuCiAgICAgICAgIiIiCiAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcgoKICAgIGRlZiBwYXRoX3N0YXRzKHNlbGYsIHBhdGgpOgogICAgICAgICIiIk9wdGlvbmFsIG1ldGhvZCByZXR1cm5pbmcgYSBtZXRhZGF0YSBkaWN0IGZvciB0aGUgc3BlY2lmaWVkIHBhdGgKICAgICAgICB0byBieSB0aGUgcGF0aCAoc3RyKS4KICAgICAgICBQb3NzaWJsZSBrZXlzOgogICAgICAgIC0gJ210aW1lJyAobWFuZGF0b3J5KSBpcyB0aGUgbnVtZXJpYyB0aW1lc3RhbXAgb2YgbGFzdCBzb3VyY2UKICAgICAgICAgIGNvZGUgbW9kaWZpY2F0aW9uOwogICAgICAgIC0gJ3NpemUnIChvcHRpb25hbCkgaXMgdGhlIHNpemUgaW4gYnl0ZXMgb2YgdGhlIHNvdXJjZSBjb2RlLgoKICAgICAgICBJbXBsZW1lbnRpbmcgdGhpcyBtZXRob2QgYWxsb3dzIHRoZSBsb2FkZXIgdG8gcmVhZCBieXRlY29kZSBmaWxlcy4KICAgICAgICAiIiIKICAgICAgICByZXR1cm4geydtdGltZSc6IHNlbGYucGF0aF9tdGltZShwYXRoKX0KCiAgICBkZWYgX2NhY2hlX2J5dGVjb2RlKHNlbGYsIHNvdXJjZV9wYXRoLCBjYWNoZV9wYXRoLCBkYXRhKToKICAgICAgICAiIiJPcHRpb25hbCBtZXRob2Qgd2hpY2ggd3JpdGVzIGRhdGEgKGJ5dGVzKSB0byBhIGZpbGUgcGF0aCAoYSBzdHIpLgoKICAgICAgICBJbXBsZW1lbnRpbmcgdGhpcyBtZXRob2QgYWxsb3dzIGZvciB0aGUgd3JpdGluZyBvZiBieXRlY29kZSBmaWxlcy4KCiAgICAgICAgVGhlIHNvdXJjZSBwYXRoIGlzIG5lZWRlZCBpbiBvcmRlciB0byBjb3JyZWN0bHkgdHJhbnNmZXIgcGVybWlzc2lvbnMKICAgICAgICAiIiIKICAgICAgICAjIEZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSwgd2UgZGVsZWdhdGUgdG8gc2V0X2RhdGEoKQogICAgICAgIHJldHVybiBzZWxmLnNldF9kYXRhKGNhY2hlX3BhdGgsIGRhdGEpCgogICAgZGVmIHNldF9kYXRhKHNlbGYsIHBhdGgsIGRhdGEpOgogICAgICAgICIiIk9wdGlvbmFsIG1ldGhvZCB3aGljaCB3cml0ZXMgZGF0YSAoYnl0ZXMpIHRvIGEgZmlsZSBwYXRoIChhIHN0cikuCgogICAgICAgIEltcGxlbWVudGluZyB0aGlzIG1ldGhvZCBhbGxvd3MgZm9yIHRoZSB3cml0aW5nIG9mIGJ5dGVjb2RlIGZpbGVzLgoKICAgICAgICAiIiIKICAgICAgICByYWlzZSBOb3RJbXBsZW1lbnRlZEVycm9yCgoKICAgIGRlZiBnZXRfc291cmNlKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICAiIiJDb25jcmV0ZSBpbXBsZW1lbnRhdGlvbiBvZiBJbnNwZWN0TG9hZGVyLmdldF9zb3VyY2UuIiIiCiAgICAgICAgaW1wb3J0IHRva2VuaXplCiAgICAgICAgcGF0aCA9IHNlbGYuZ2V0X2ZpbGVuYW1lKGZ1bGxuYW1lKQogICAgICAgIHRyeToKICAgICAgICAgICAgc291cmNlX2J5dGVzID0gc2VsZi5nZXRfZGF0YShwYXRoKQogICAgICAgIGV4Y2VwdCBJT0Vycm9yIGFzIGV4YzoKICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IoInNvdXJjZSBub3QgYXZhaWxhYmxlIHRocm91Z2ggZ2V0X2RhdGEoKSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9ZnVsbG5hbWUpIGZyb20gZXhjCiAgICAgICAgcmVhZHNvdXJjZSA9IF9pby5CeXRlc0lPKHNvdXJjZV9ieXRlcykucmVhZGxpbmUKICAgICAgICB0cnk6CiAgICAgICAgICAgIGVuY29kaW5nID0gdG9rZW5pemUuZGV0ZWN0X2VuY29kaW5nKHJlYWRzb3VyY2UpCiAgICAgICAgZXhjZXB0IFN5bnRheEVycm9yIGFzIGV4YzoKICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IoIkZhaWxlZCB0byBkZXRlY3QgZW5jb2RpbmciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPWZ1bGxuYW1lKSBmcm9tIGV4YwogICAgICAgIG5ld2xpbmVfZGVjb2RlciA9IF9pby5JbmNyZW1lbnRhbE5ld2xpbmVEZWNvZGVyKE5vbmUsIFRydWUpCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gbmV3bGluZV9kZWNvZGVyLmRlY29kZShzb3VyY2VfYnl0ZXMuZGVjb2RlKGVuY29kaW5nWzBdKSkKICAgICAgICBleGNlcHQgVW5pY29kZURlY29kZUVycm9yIGFzIGV4YzoKICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IoIkZhaWxlZCB0byBkZWNvZGUgc291cmNlIGZpbGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPWZ1bGxuYW1lKSBmcm9tIGV4YwoKICAgIGRlZiBnZXRfY29kZShzZWxmLCBmdWxsbmFtZSk6CiAgICAgICAgIiIiQ29uY3JldGUgaW1wbGVtZW50YXRpb24gb2YgSW5zcGVjdExvYWRlci5nZXRfY29kZS4KCiAgICAgICAgUmVhZGluZyBvZiBieXRlY29kZSByZXF1aXJlcyBwYXRoX3N0YXRzIHRvIGJlIGltcGxlbWVudGVkLiBUbyB3cml0ZQogICAgICAgIGJ5dGVjb2RlLCBzZXRfZGF0YSBtdXN0IGFsc28gYmUgaW1wbGVtZW50ZWQuCgogICAgICAgICIiIgogICAgICAgIHNvdXJjZV9wYXRoID0gc2VsZi5nZXRfZmlsZW5hbWUoZnVsbG5hbWUpCiAgICAgICAgc291cmNlX210aW1lID0gTm9uZQogICAgICAgIHRyeToKICAgICAgICAgICAgYnl0ZWNvZGVfcGF0aCA9IGNhY2hlX2Zyb21fc291cmNlKHNvdXJjZV9wYXRoKQogICAgICAgIGV4Y2VwdCBOb3RJbXBsZW1lbnRlZEVycm9yOgogICAgICAgICAgICBieXRlY29kZV9wYXRoID0gTm9uZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHN0ID0gc2VsZi5wYXRoX3N0YXRzKHNvdXJjZV9wYXRoKQogICAgICAgICAgICBleGNlcHQgTm90SW1wbGVtZW50ZWRFcnJvcjoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNvdXJjZV9tdGltZSA9IGludChzdFsnbXRpbWUnXSkKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBkYXRhID0gc2VsZi5nZXRfZGF0YShieXRlY29kZV9wYXRoKQogICAgICAgICAgICAgICAgZXhjZXB0IElPRXJyb3I6CiAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGJ5dGVzX2RhdGEgPSBzZWxmLl9ieXRlc19mcm9tX2J5dGVjb2RlKGZ1bGxuYW1lLCBkYXRhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBieXRlY29kZV9wYXRoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdCkKICAgICAgICAgICAgICAgICAgICBleGNlcHQgKEltcG9ydEVycm9yLCBFT0ZFcnJvcik6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBfdmVyYm9zZV9tZXNzYWdlKCd7fSBtYXRjaGVzIHt9JywgYnl0ZWNvZGVfcGF0aCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZV9wYXRoKQogICAgICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IG1hcnNoYWwubG9hZHMoYnl0ZXNfZGF0YSkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShmb3VuZCwgX2NvZGVfdHlwZSk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaW1wLl9maXhfY29fZmlsZW5hbWUoZm91bmQsIHNvdXJjZV9wYXRoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZlcmJvc2VfbWVzc2FnZSgnY29kZSBvYmplY3QgZnJvbSB7fScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnl0ZWNvZGVfcGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmb3VuZAogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnID0gIk5vbi1jb2RlIG9iamVjdCBpbiB7fSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhaXNlIEltcG9ydEVycm9yKG1zZy5mb3JtYXQoYnl0ZWNvZGVfcGF0aCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPWZ1bGxuYW1lLCBwYXRoPWJ5dGVjb2RlX3BhdGgpCiAgICAgICAgc291cmNlX2J5dGVzID0gc2VsZi5nZXRfZGF0YShzb3VyY2VfcGF0aCkKICAgICAgICBjb2RlX29iamVjdCA9IF9jYWxsX3dpdGhfZnJhbWVzX3JlbW92ZWQoY29tcGlsZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VfYnl0ZXMsIHNvdXJjZV9wYXRoLCAnZXhlYycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgZG9udF9pbmhlcml0PVRydWUpCiAgICAgICAgX3ZlcmJvc2VfbWVzc2FnZSgnY29kZSBvYmplY3QgZnJvbSB7fScsIHNvdXJjZV9wYXRoKQogICAgICAgIGlmIChub3Qgc3lzLmRvbnRfd3JpdGVfYnl0ZWNvZGUgYW5kIGJ5dGVjb2RlX3BhdGggaXMgbm90IE5vbmUgYW5kCiAgICAgICAgICAgIHNvdXJjZV9tdGltZSBpcyBub3QgTm9uZSk6CiAgICAgICAgICAgIGRhdGEgPSBieXRlYXJyYXkoX01BR0lDX0JZVEVTKQogICAgICAgICAgICBkYXRhLmV4dGVuZChfd19sb25nKHNvdXJjZV9tdGltZSkpCiAgICAgICAgICAgIGRhdGEuZXh0ZW5kKF93X2xvbmcobGVuKHNvdXJjZV9ieXRlcykpKQogICAgICAgICAgICBkYXRhLmV4dGVuZChtYXJzaGFsLmR1bXBzKGNvZGVfb2JqZWN0KSkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VsZi5fY2FjaGVfYnl0ZWNvZGUoc291cmNlX3BhdGgsIGJ5dGVjb2RlX3BhdGgsIGRhdGEpCiAgICAgICAgICAgICAgICBfdmVyYm9zZV9tZXNzYWdlKCd3cm90ZSB7IXJ9JywgYnl0ZWNvZGVfcGF0aCkKICAgICAgICAgICAgZXhjZXB0IE5vdEltcGxlbWVudGVkRXJyb3I6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgcmV0dXJuIGNvZGVfb2JqZWN0CgogICAgZGVmIGxvYWRfbW9kdWxlKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICAiIiJDb25jcmV0ZSBpbXBsZW1lbnRhdGlvbiBvZiBMb2FkZXIubG9hZF9tb2R1bGUuCgogICAgICAgIFJlcXVpcmVzIEV4ZWN1dGlvbkxvYWRlci5nZXRfZmlsZW5hbWUgYW5kIFJlc291cmNlTG9hZGVyLmdldF9kYXRhIHRvIGJlCiAgICAgICAgaW1wbGVtZW50ZWQgdG8gbG9hZCBzb3VyY2UgY29kZS4gVXNlIG9mIGJ5dGVjb2RlIGlzIGRpY3RhdGVkIGJ5IHdoZXRoZXIKICAgICAgICBnZXRfY29kZSB1c2VzL3dyaXRlcyBieXRlY29kZS4KCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX2xvYWRfbW9kdWxlKGZ1bGxuYW1lKQoKCmNsYXNzIEZpbGVMb2FkZXI6CgogICAgIiIiQmFzZSBmaWxlIGxvYWRlciBjbGFzcyB3aGljaCBpbXBsZW1lbnRzIHRoZSBsb2FkZXIgcHJvdG9jb2wgbWV0aG9kcyB0aGF0CiAgICByZXF1aXJlIGZpbGUgc3lzdGVtIHVzYWdlLiIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBmdWxsbmFtZSwgcGF0aCk6CiAgICAgICAgIiIiQ2FjaGUgdGhlIG1vZHVsZSBuYW1lIGFuZCB0aGUgcGF0aCB0byB0aGUgZmlsZSBmb3VuZCBieSB0aGUKICAgICAgICBmaW5kZXIuIiIiCiAgICAgICAgc2VsZi5uYW1lID0gZnVsbG5hbWUKICAgICAgICBzZWxmLnBhdGggPSBwYXRoCgogICAgQF9jaGVja19uYW1lCiAgICBkZWYgbG9hZF9tb2R1bGUoc2VsZiwgZnVsbG5hbWUpOgogICAgICAgICIiIkxvYWQgYSBtb2R1bGUgZnJvbSBhIGZpbGUuIiIiCiAgICAgICAgIyBJc3N1ZSAjMTQ4NTc6IEF2b2lkIHRoZSB6ZXJvLWFyZ3VtZW50IGZvcm0gc28gdGhlIGltcGxlbWVudGF0aW9uCiAgICAgICAgIyBvZiB0aGF0IGZvcm0gY2FuIGJlIHVwZGF0ZWQgd2l0aG91dCBicmVha2luZyB0aGUgZnJvemVuIG1vZHVsZQogICAgICAgIHJldHVybiBzdXBlcihGaWxlTG9hZGVyLCBzZWxmKS5sb2FkX21vZHVsZShmdWxsbmFtZSkKCiAgICBAX2NoZWNrX25hbWUKICAgIGRlZiBnZXRfZmlsZW5hbWUoc2VsZiwgZnVsbG5hbWUpOgogICAgICAgICIiIlJldHVybiB0aGUgcGF0aCB0byB0aGUgc291cmNlIGZpbGUgYXMgZm91bmQgYnkgdGhlIGZpbmRlci4iIiIKICAgICAgICByZXR1cm4gc2VsZi5wYXRoCgogICAgZGVmIGdldF9kYXRhKHNlbGYsIHBhdGgpOgogICAgICAgICIiIlJldHVybiB0aGUgZGF0YSBmcm9tIHBhdGggYXMgcmF3IGJ5dGVzLiIiIgogICAgICAgIHdpdGggX2lvLkZpbGVJTyhwYXRoLCAncicpIGFzIGZpbGU6CiAgICAgICAgICAgIHJldHVybiBmaWxlLnJlYWQoKQoKCmNsYXNzIFNvdXJjZUZpbGVMb2FkZXIoRmlsZUxvYWRlciwgU291cmNlTG9hZGVyKToKCiAgICAiIiJDb25jcmV0ZSBpbXBsZW1lbnRhdGlvbiBvZiBTb3VyY2VMb2FkZXIgdXNpbmcgdGhlIGZpbGUgc3lzdGVtLiIiIgoKICAgIGRlZiBwYXRoX3N0YXRzKHNlbGYsIHBhdGgpOgogICAgICAgICIiIlJldHVybiB0aGUgbWV0YWRhdGEgZm9yIHRoZSBwYXRoLiIiIgogICAgICAgIHN0ID0gX29zLnN0YXQocGF0aCkKICAgICAgICByZXR1cm4geydtdGltZSc6IHN0LnN0X210aW1lLCAnc2l6ZSc6IHN0LnN0X3NpemV9CgogICAgZGVmIF9jYWNoZV9ieXRlY29kZShzZWxmLCBzb3VyY2VfcGF0aCwgYnl0ZWNvZGVfcGF0aCwgZGF0YSk6CiAgICAgICAgIyBBZGFwdCBiZXR3ZWVuIHRoZSB0d28gQVBJcwogICAgICAgIHRyeToKICAgICAgICAgICAgbW9kZSA9IF9vcy5zdGF0KHNvdXJjZV9wYXRoKS5zdF9tb2RlCiAgICAgICAgZXhjZXB0IE9TRXJyb3I6CiAgICAgICAgICAgIG1vZGUgPSAwbzY2NgogICAgICAgIHJldHVybiBzZWxmLnNldF9kYXRhKGJ5dGVjb2RlX3BhdGgsIGRhdGEsIF9tb2RlPW1vZGUpCgogICAgZGVmIHNldF9kYXRhKHNlbGYsIHBhdGgsIGRhdGEsICosIF9tb2RlPTBvNjY2KToKICAgICAgICAiIiJXcml0ZSBieXRlcyBkYXRhIHRvIGEgZmlsZS4iIiIKICAgICAgICBwYXJlbnQsIGZpbGVuYW1lID0gX3BhdGhfc3BsaXQocGF0aCkKICAgICAgICBwYXRoX3BhcnRzID0gW10KICAgICAgICAjIEZpZ3VyZSBvdXQgd2hhdCBkaXJlY3RvcmllcyBhcmUgbWlzc2luZy4KICAgICAgICB3aGlsZSBwYXJlbnQgYW5kIG5vdCBfcGF0aF9pc2RpcihwYXJlbnQpOgogICAgICAgICAgICBwYXJlbnQsIHBhcnQgPSBfcGF0aF9zcGxpdChwYXJlbnQpCiAgICAgICAgICAgIHBhdGhfcGFydHMuYXBwZW5kKHBhcnQpCiAgICAgICAgIyBDcmVhdGUgbmVlZGVkIGRpcmVjdG9yaWVzLgogICAgICAgIGZvciBwYXJ0IGluIHJldmVyc2VkKHBhdGhfcGFydHMpOgogICAgICAgICAgICBwYXJlbnQgPSBfcGF0aF9qb2luKHBhcmVudCwgcGFydCkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgX29zLm1rZGlyKHBhcmVudCkKICAgICAgICAgICAgZXhjZXB0IEZpbGVFeGlzdHNFcnJvcjoKICAgICAgICAgICAgICAgICMgUHJvYmFibHkgYW5vdGhlciBQeXRob24gcHJvY2VzcyBhbHJlYWR5IGNyZWF0ZWQgdGhlIGRpci4KICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGV4Y2VwdCBQZXJtaXNzaW9uRXJyb3I6CiAgICAgICAgICAgICAgICAjIElmIGNhbid0IGdldCBwcm9wZXIgYWNjZXNzLCB0aGVuIGp1c3QgZm9yZ2V0IGFib3V0IHdyaXRpbmcKICAgICAgICAgICAgICAgICMgdGhlIGRhdGEuCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICB0cnk6CiAgICAgICAgICAgIF93cml0ZV9hdG9taWMocGF0aCwgZGF0YSwgX21vZGUpCiAgICAgICAgICAgIF92ZXJib3NlX21lc3NhZ2UoJ2NyZWF0ZWQgeyFyfScsIHBhdGgpCiAgICAgICAgZXhjZXB0IChQZXJtaXNzaW9uRXJyb3IsIEZpbGVFeGlzdHNFcnJvcik6CiAgICAgICAgICAgICMgRG9uJ3Qgd29ycnkgaWYgeW91IGNhbid0IHdyaXRlIGJ5dGVjb2RlIG9yIHNvbWVvbmUgaXMgd3JpdGluZwogICAgICAgICAgICAjIGl0IGF0IHRoZSBzYW1lIHRpbWUuCiAgICAgICAgICAgIHBhc3MKCgpjbGFzcyBTb3VyY2VsZXNzRmlsZUxvYWRlcihGaWxlTG9hZGVyLCBfTG9hZGVyQmFzaWNzKToKCiAgICAiIiJMb2FkZXIgd2hpY2ggaGFuZGxlcyBzb3VyY2VsZXNzIGZpbGUgaW1wb3J0cy4iIiIKCiAgICBkZWYgbG9hZF9tb2R1bGUoc2VsZiwgZnVsbG5hbWUpOgogICAgICAgIHJldHVybiBzZWxmLl9sb2FkX21vZHVsZShmdWxsbmFtZSwgc291cmNlbGVzcz1UcnVlKQoKICAgIGRlZiBnZXRfY29kZShzZWxmLCBmdWxsbmFtZSk6CiAgICAgICAgcGF0aCA9IHNlbGYuZ2V0X2ZpbGVuYW1lKGZ1bGxuYW1lKQogICAgICAgIGRhdGEgPSBzZWxmLmdldF9kYXRhKHBhdGgpCiAgICAgICAgYnl0ZXNfZGF0YSA9IHNlbGYuX2J5dGVzX2Zyb21fYnl0ZWNvZGUoZnVsbG5hbWUsIGRhdGEsIHBhdGgsIE5vbmUpCiAgICAgICAgZm91bmQgPSBtYXJzaGFsLmxvYWRzKGJ5dGVzX2RhdGEpCiAgICAgICAgaWYgaXNpbnN0YW5jZShmb3VuZCwgX2NvZGVfdHlwZSk6CiAgICAgICAgICAgIF92ZXJib3NlX21lc3NhZ2UoJ2NvZGUgb2JqZWN0IGZyb20geyFyfScsIHBhdGgpCiAgICAgICAgICAgIHJldHVybiBmb3VuZAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIEltcG9ydEVycm9yKCJOb24tY29kZSBvYmplY3QgaW4ge30iLmZvcm1hdChwYXRoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT1mdWxsbmFtZSwgcGF0aD1wYXRoKQoKICAgIGRlZiBnZXRfc291cmNlKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICAiIiJSZXR1cm4gTm9uZSBhcyB0aGVyZSBpcyBubyBzb3VyY2UgY29kZS4iIiIKICAgICAgICByZXR1cm4gTm9uZQoKCiMgRmlsbGVkIGluIGJ5IF9zZXR1cCgpLgpFWFRFTlNJT05fU1VGRklYRVMgPSBbXQoKCmNsYXNzIEV4dGVuc2lvbkZpbGVMb2FkZXI6CgogICAgIiIiTG9hZGVyIGZvciBleHRlbnNpb24gbW9kdWxlcy4KCiAgICBUaGUgY29uc3RydWN0b3IgaXMgZGVzaWduZWQgdG8gd29yayB3aXRoIEZpbGVGaW5kZXIuCgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG5hbWUsIHBhdGgpOgogICAgICAgIHNlbGYubmFtZSA9IG5hbWUKICAgICAgICBzZWxmLnBhdGggPSBwYXRoCgogICAgQF9jaGVja19uYW1lCiAgICBAc2V0X3BhY2thZ2UKICAgIEBzZXRfbG9hZGVyCiAgICBkZWYgbG9hZF9tb2R1bGUoc2VsZiwgZnVsbG5hbWUpOgogICAgICAgICIiIkxvYWQgYW4gZXh0ZW5zaW9uIG1vZHVsZS4iIiIKICAgICAgICBpc19yZWxvYWQgPSBmdWxsbmFtZSBpbiBzeXMubW9kdWxlcwogICAgICAgIHRyeToKICAgICAgICAgICAgbW9kdWxlID0gX2NhbGxfd2l0aF9mcmFtZXNfcmVtb3ZlZChfaW1wLmxvYWRfZHluYW1pYywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsbmFtZSwgc2VsZi5wYXRoKQogICAgICAgICAgICBfdmVyYm9zZV9tZXNzYWdlKCdleHRlbnNpb24gbW9kdWxlIGxvYWRlZCBmcm9tIHshcn0nLCBzZWxmLnBhdGgpCiAgICAgICAgICAgIGlmIHNlbGYuaXNfcGFja2FnZShmdWxsbmFtZSkgYW5kIG5vdCBoYXNhdHRyKG1vZHVsZSwgJ19fcGF0aF9fJyk6CiAgICAgICAgICAgICAgICBtb2R1bGUuX19wYXRoX18gPSBbX3BhdGhfc3BsaXQoc2VsZi5wYXRoKVswXV0KICAgICAgICAgICAgcmV0dXJuIG1vZHVsZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgaWYgbm90IGlzX3JlbG9hZCBhbmQgZnVsbG5hbWUgaW4gc3lzLm1vZHVsZXM6CiAgICAgICAgICAgICAgICBkZWwgc3lzLm1vZHVsZXNbZnVsbG5hbWVdCiAgICAgICAgICAgIHJhaXNlCgogICAgZGVmIGlzX3BhY2thZ2Uoc2VsZiwgZnVsbG5hbWUpOgogICAgICAgICIiIlJldHVybiBUcnVlIGlmIHRoZSBleHRlbnNpb24gbW9kdWxlIGlzIGEgcGFja2FnZS4iIiIKICAgICAgICBmaWxlX25hbWUgPSBfcGF0aF9zcGxpdChzZWxmLnBhdGgpWzFdCiAgICAgICAgcmV0dXJuIGFueShmaWxlX25hbWUgPT0gJ19faW5pdF9fJyArIHN1ZmZpeAogICAgICAgICAgICAgICAgICAgZm9yIHN1ZmZpeCBpbiBFWFRFTlNJT05fU1VGRklYRVMpCgogICAgZGVmIGdldF9jb2RlKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICAiIiJSZXR1cm4gTm9uZSBhcyBhbiBleHRlbnNpb24gbW9kdWxlIGNhbm5vdCBjcmVhdGUgYSBjb2RlIG9iamVjdC4iIiIKICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBnZXRfc291cmNlKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICAiIiJSZXR1cm4gTm9uZSBhcyBleHRlbnNpb24gbW9kdWxlcyBoYXZlIG5vIHNvdXJjZSBjb2RlLiIiIgogICAgICAgIHJldHVybiBOb25lCgoKY2xhc3MgX05hbWVzcGFjZVBhdGg6CiAgICAiIiJSZXByZXNlbnRzIGEgbmFtZXNwYWNlIHBhY2thZ2UncyBwYXRoLiAgSXQgdXNlcyB0aGUgbW9kdWxlIG5hbWUKICAgIHRvIGZpbmQgaXRzIHBhcmVudCBtb2R1bGUsIGFuZCBmcm9tIHRoZXJlIGl0IGxvb2tzIHVwIHRoZSBwYXJlbnQncwogICAgX19wYXRoX18uICBXaGVuIHRoaXMgY2hhbmdlcywgdGhlIG1vZHVsZSdzIG93biBwYXRoIGlzIHJlY29tcHV0ZWQsCiAgICB1c2luZyBwYXRoX2ZpbmRlci4gIEZvciB0b3AtbGV2ZSBtb2R1bGVzLCB0aGUgcGFyZW50IG1vZHVsZSdzIHBhdGgKICAgIGlzIHN5cy5wYXRoLiIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBuYW1lLCBwYXRoLCBwYXRoX2ZpbmRlcik6CiAgICAgICAgc2VsZi5fbmFtZSA9IG5hbWUKICAgICAgICBzZWxmLl9wYXRoID0gcGF0aAogICAgICAgIHNlbGYuX2xhc3RfcGFyZW50X3BhdGggPSB0dXBsZShzZWxmLl9nZXRfcGFyZW50X3BhdGgoKSkKICAgICAgICBzZWxmLl9wYXRoX2ZpbmRlciA9IHBhdGhfZmluZGVyCgogICAgZGVmIF9maW5kX3BhcmVudF9wYXRoX25hbWVzKHNlbGYpOgogICAgICAgICIiIlJldHVybnMgYSB0dXBsZSBvZiAocGFyZW50LW1vZHVsZS1uYW1lLCBwYXJlbnQtcGF0aC1hdHRyLW5hbWUpIiIiCiAgICAgICAgcGFyZW50LCBkb3QsIG1lID0gc2VsZi5fbmFtZS5ycGFydGl0aW9uKCcuJykKICAgICAgICBpZiBkb3QgPT0gJyc6CiAgICAgICAgICAgICMgVGhpcyBpcyBhIHRvcC1sZXZlbCBtb2R1bGUuIHN5cy5wYXRoIGNvbnRhaW5zIHRoZSBwYXJlbnQgcGF0aC4KICAgICAgICAgICAgcmV0dXJuICdzeXMnLCAncGF0aCcKICAgICAgICAjIE5vdCBhIHRvcC1sZXZlbCBtb2R1bGUuIHBhcmVudC1tb2R1bGUuX19wYXRoX18gY29udGFpbnMgdGhlCiAgICAgICAgIyAgcGFyZW50IHBhdGguCiAgICAgICAgcmV0dXJuIHBhcmVudCwgJ19fcGF0aF9fJwoKICAgIGRlZiBfZ2V0X3BhcmVudF9wYXRoKHNlbGYpOgogICAgICAgIHBhcmVudF9tb2R1bGVfbmFtZSwgcGF0aF9hdHRyX25hbWUgPSBzZWxmLl9maW5kX3BhcmVudF9wYXRoX25hbWVzKCkKICAgICAgICByZXR1cm4gZ2V0YXR0cihzeXMubW9kdWxlc1twYXJlbnRfbW9kdWxlX25hbWVdLCBwYXRoX2F0dHJfbmFtZSkKCiAgICBkZWYgX3JlY2FsY3VsYXRlKHNlbGYpOgogICAgICAgICMgSWYgdGhlIHBhcmVudCdzIHBhdGggaGFzIGNoYW5nZWQsIHJlY2FsY3VsYXRlIF9wYXRoCiAgICAgICAgcGFyZW50X3BhdGggPSB0dXBsZShzZWxmLl9nZXRfcGFyZW50X3BhdGgoKSkgIyBNYWtlIGEgY29weQogICAgICAgIGlmIHBhcmVudF9wYXRoICE9IHNlbGYuX2xhc3RfcGFyZW50X3BhdGg6CiAgICAgICAgICAgIGxvYWRlciwgbmV3X3BhdGggPSBzZWxmLl9wYXRoX2ZpbmRlcihzZWxmLl9uYW1lLCBwYXJlbnRfcGF0aCkKICAgICAgICAgICAgIyBOb3RlIHRoYXQgbm8gY2hhbmdlcyBhcmUgbWFkZSBpZiBhIGxvYWRlciBpcyByZXR1cm5lZCwgYnV0IHdlCiAgICAgICAgICAgICMgIGRvIHJlbWVtYmVyIHRoZSBuZXcgcGFyZW50IHBhdGgKICAgICAgICAgICAgaWYgbG9hZGVyIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBzZWxmLl9wYXRoID0gbmV3X3BhdGgKICAgICAgICAgICAgc2VsZi5fbGFzdF9wYXJlbnRfcGF0aCA9IHBhcmVudF9wYXRoICAgICAjIFNhdmUgdGhlIGNvcHkKICAgICAgICByZXR1cm4gc2VsZi5fcGF0aAoKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gaXRlcihzZWxmLl9yZWNhbGN1bGF0ZSgpKQoKICAgIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICAgIHJldHVybiBsZW4oc2VsZi5fcmVjYWxjdWxhdGUoKSkKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICJfTmFtZXNwYWNlUGF0aCh7IXJ9KSIuZm9ybWF0KHNlbGYuX3BhdGgpCgogICAgZGVmIF9fY29udGFpbnNfXyhzZWxmLCBpdGVtKToKICAgICAgICByZXR1cm4gaXRlbSBpbiBzZWxmLl9yZWNhbGN1bGF0ZSgpCgogICAgZGVmIGFwcGVuZChzZWxmLCBpdGVtKToKICAgICAgICBzZWxmLl9wYXRoLmFwcGVuZChpdGVtKQoKCmNsYXNzIE5hbWVzcGFjZUxvYWRlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBuYW1lLCBwYXRoLCBwYXRoX2ZpbmRlcik6CiAgICAgICAgc2VsZi5fcGF0aCA9IF9OYW1lc3BhY2VQYXRoKG5hbWUsIHBhdGgsIHBhdGhfZmluZGVyKQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIG1vZHVsZV9yZXByKGNscywgbW9kdWxlKToKICAgICAgICByZXR1cm4gIjxtb2R1bGUgJ3t9JyAobmFtZXNwYWNlKT4iLmZvcm1hdChtb2R1bGUuX19uYW1lX18pCgogICAgQG1vZHVsZV9mb3JfbG9hZGVyCiAgICBkZWYgbG9hZF9tb2R1bGUoc2VsZiwgbW9kdWxlKToKICAgICAgICAiIiJMb2FkIGEgbmFtZXNwYWNlIG1vZHVsZS4iIiIKICAgICAgICBfdmVyYm9zZV9tZXNzYWdlKCduYW1lc3BhY2UgbW9kdWxlIGxvYWRlZCB3aXRoIHBhdGggeyFyfScsIHNlbGYuX3BhdGgpCiAgICAgICAgbW9kdWxlLl9fcGF0aF9fID0gc2VsZi5fcGF0aAogICAgICAgIHJldHVybiBtb2R1bGUKCgojIEZpbmRlcnMgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpjbGFzcyBQYXRoRmluZGVyOgoKICAgICIiIk1ldGEgcGF0aCBmaW5kZXIgZm9yIHN5cy5wYXRoIGFuZCBwYWNrYWdlIF9fcGF0aF9fIGF0dHJpYnV0ZXMuIiIiCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgaW52YWxpZGF0ZV9jYWNoZXMoY2xzKToKICAgICAgICAiIiJDYWxsIHRoZSBpbnZhbGlkYXRlX2NhY2hlcygpIG1ldGhvZCBvbiBhbGwgcGF0aCBlbnRyeSBmaW5kZXJzCiAgICAgICAgc3RvcmVkIGluIHN5cy5wYXRoX2ltcG9ydGVyX2NhY2hlcyAod2hlcmUgaW1wbGVtZW50ZWQpLiIiIgogICAgICAgIGZvciBmaW5kZXIgaW4gc3lzLnBhdGhfaW1wb3J0ZXJfY2FjaGUudmFsdWVzKCk6CiAgICAgICAgICAgIGlmIGhhc2F0dHIoZmluZGVyLCAnaW52YWxpZGF0ZV9jYWNoZXMnKToKICAgICAgICAgICAgICAgIGZpbmRlci5pbnZhbGlkYXRlX2NhY2hlcygpCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgX3BhdGhfaG9va3MoY2xzLCBwYXRoKToKICAgICAgICAiIiJTZWFyY2ggc2VxdWVuY2Ugb2YgaG9va3MgZm9yIGEgZmluZGVyIGZvciAncGF0aCcuCgogICAgICAgIElmICdob29rcycgaXMgZmFsc2UgdGhlbiB1c2Ugc3lzLnBhdGhfaG9va3MuCgogICAgICAgICIiIgogICAgICAgIGlmIG5vdCBzeXMucGF0aF9ob29rczoKICAgICAgICAgICAgX3dhcm5pbmdzLndhcm4oJ3N5cy5wYXRoX2hvb2tzIGlzIGVtcHR5JywgSW1wb3J0V2FybmluZykKICAgICAgICBmb3IgaG9vayBpbiBzeXMucGF0aF9ob29rczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmV0dXJuIGhvb2socGF0aCkKICAgICAgICAgICAgZXhjZXB0IEltcG9ydEVycm9yOgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIF9wYXRoX2ltcG9ydGVyX2NhY2hlKGNscywgcGF0aCk6CiAgICAgICAgIiIiR2V0IHRoZSBmaW5kZXIgZm9yIHRoZSBwYXRoIGVudHJ5IGZyb20gc3lzLnBhdGhfaW1wb3J0ZXJfY2FjaGUuCgogICAgICAgIElmIHRoZSBwYXRoIGVudHJ5IGlzIG5vdCBpbiB0aGUgY2FjaGUsIGZpbmQgdGhlIGFwcHJvcHJpYXRlIGZpbmRlcgogICAgICAgIGFuZCBjYWNoZSBpdC4gSWYgbm8gZmluZGVyIGlzIGF2YWlsYWJsZSwgc3RvcmUgTm9uZS4KCiAgICAgICAgIiIiCiAgICAgICAgaWYgcGF0aCA9PSAnJzoKICAgICAgICAgICAgcGF0aCA9ICcuJwogICAgICAgIHRyeToKICAgICAgICAgICAgZmluZGVyID0gc3lzLnBhdGhfaW1wb3J0ZXJfY2FjaGVbcGF0aF0KICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIGZpbmRlciA9IGNscy5fcGF0aF9ob29rcyhwYXRoKQogICAgICAgICAgICBzeXMucGF0aF9pbXBvcnRlcl9jYWNoZVtwYXRoXSA9IGZpbmRlcgogICAgICAgIHJldHVybiBmaW5kZXIKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBfZ2V0X2xvYWRlcihjbHMsIGZ1bGxuYW1lLCBwYXRoKToKICAgICAgICAiIiJGaW5kIHRoZSBsb2FkZXIgb3IgbmFtZXNwYWNlX3BhdGggZm9yIHRoaXMgbW9kdWxlL3BhY2thZ2UgbmFtZS4iIiIKICAgICAgICAjIElmIHRoaXMgZW5kcyB1cCBiZWluZyBhIG5hbWVzcGFjZSBwYWNrYWdlLCBuYW1lc3BhY2VfcGF0aCBpcwogICAgICAgICMgIHRoZSBsaXN0IG9mIHBhdGhzIHRoYXQgd2lsbCBiZWNvbWUgaXRzIF9fcGF0aF9fCiAgICAgICAgbmFtZXNwYWNlX3BhdGggPSBbXQogICAgICAgIGZvciBlbnRyeSBpbiBwYXRoOgogICAgICAgICAgICBmaW5kZXIgPSBjbHMuX3BhdGhfaW1wb3J0ZXJfY2FjaGUoZW50cnkpCiAgICAgICAgICAgIGlmIGZpbmRlciBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIGlmIGhhc2F0dHIoZmluZGVyLCAnZmluZF9sb2FkZXInKToKICAgICAgICAgICAgICAgICAgICBsb2FkZXIsIHBvcnRpb25zID0gZmluZGVyLmZpbmRfbG9hZGVyKGZ1bGxuYW1lKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBsb2FkZXIgPSBmaW5kZXIuZmluZF9tb2R1bGUoZnVsbG5hbWUpCiAgICAgICAgICAgICAgICAgICAgcG9ydGlvbnMgPSBbXQogICAgICAgICAgICAgICAgaWYgbG9hZGVyIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgICMgV2UgZm91bmQgYSBsb2FkZXI6IHJldHVybiBpdCBpbW1lZGlhdGVseS4KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9hZGVyLCBuYW1lc3BhY2VfcGF0aAogICAgICAgICAgICAgICAgIyBUaGlzIGlzIHBvc3NpYmx5IHBhcnQgb2YgYSBuYW1lc3BhY2UgcGFja2FnZS4KICAgICAgICAgICAgICAgICMgIFJlbWVtYmVyIHRoZXNlIHBhdGggZW50cmllcyAoaWYgYW55KSBmb3Igd2hlbiB3ZQogICAgICAgICAgICAgICAgIyAgY3JlYXRlIGEgbmFtZXNwYWNlIHBhY2thZ2UsIGFuZCBjb250aW51ZSBpdGVyYXRpbmcKICAgICAgICAgICAgICAgICMgIG9uIHBhdGguCiAgICAgICAgICAgICAgICBuYW1lc3BhY2VfcGF0aC5leHRlbmQocG9ydGlvbnMpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIE5vbmUsIG5hbWVzcGFjZV9wYXRoCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZmluZF9tb2R1bGUoY2xzLCBmdWxsbmFtZSwgcGF0aD1Ob25lKToKICAgICAgICAiIiJGaW5kIHRoZSBtb2R1bGUgb24gc3lzLnBhdGggb3IgJ3BhdGgnIGJhc2VkIG9uIHN5cy5wYXRoX2hvb2tzIGFuZAogICAgICAgIHN5cy5wYXRoX2ltcG9ydGVyX2NhY2hlLiIiIgogICAgICAgIGlmIHBhdGggaXMgTm9uZToKICAgICAgICAgICAgcGF0aCA9IHN5cy5wYXRoCiAgICAgICAgbG9hZGVyLCBuYW1lc3BhY2VfcGF0aCA9IGNscy5fZ2V0X2xvYWRlcihmdWxsbmFtZSwgcGF0aCkKICAgICAgICBpZiBsb2FkZXIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJldHVybiBsb2FkZXIKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBuYW1lc3BhY2VfcGF0aDoKICAgICAgICAgICAgICAgICMgV2UgZm91bmQgYXQgbGVhc3Qgb25lIG5hbWVzcGFjZSBwYXRoLiAgUmV0dXJuIGEKICAgICAgICAgICAgICAgICMgIGxvYWRlciB3aGljaCBjYW4gY3JlYXRlIHRoZSBuYW1lc3BhY2UgcGFja2FnZS4KICAgICAgICAgICAgICAgIHJldHVybiBOYW1lc3BhY2VMb2FkZXIoZnVsbG5hbWUsIG5hbWVzcGFjZV9wYXRoLCBjbHMuX2dldF9sb2FkZXIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZXR1cm4gTm9uZQoKCmNsYXNzIEZpbGVGaW5kZXI6CgogICAgIiIiRmlsZS1iYXNlZCBmaW5kZXIuCgogICAgSW50ZXJhY3Rpb25zIHdpdGggdGhlIGZpbGUgc3lzdGVtIGFyZSBjYWNoZWQgZm9yIHBlcmZvcm1hbmNlLCBiZWluZwogICAgcmVmcmVzaGVkIHdoZW4gdGhlIGRpcmVjdG9yeSB0aGUgZmluZGVyIGlzIGhhbmRsaW5nIGhhcyBiZWVuIG1vZGlmaWVkLgoKICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBwYXRoLCAqZGV0YWlscyk6CiAgICAgICAgIiIiSW5pdGlhbGl6ZSB3aXRoIHRoZSBwYXRoIHRvIHNlYXJjaCBvbiBhbmQgYSB2YXJpYWJsZSBudW1iZXIgb2YKICAgICAgICAzLXR1cGxlcyBjb250YWluaW5nIHRoZSBsb2FkZXIsIGZpbGUgc3VmZml4ZXMgdGhlIGxvYWRlciByZWNvZ25pemVzLAogICAgICAgIGFuZCBhIGJvb2xlYW4gb2Ygd2hldGhlciB0aGUgbG9hZGVyIGhhbmRsZXMgcGFja2FnZXMuIiIiCiAgICAgICAgbG9hZGVycyA9IFtdCiAgICAgICAgZm9yIGxvYWRlciwgc3VmZml4ZXMgaW4gZGV0YWlsczoKICAgICAgICAgICAgbG9hZGVycy5leHRlbmQoKHN1ZmZpeCwgbG9hZGVyKSBmb3Igc3VmZml4IGluIHN1ZmZpeGVzKQogICAgICAgIHNlbGYuX2xvYWRlcnMgPSBsb2FkZXJzCiAgICAgICAgIyBCYXNlIChkaXJlY3RvcnkpIHBhdGgKICAgICAgICBzZWxmLnBhdGggPSBwYXRoIG9yICcuJwogICAgICAgIHNlbGYuX3BhdGhfbXRpbWUgPSAtMQogICAgICAgIHNlbGYuX3BhdGhfY2FjaGUgPSBzZXQoKQogICAgICAgIHNlbGYuX3JlbGF4ZWRfcGF0aF9jYWNoZSA9IHNldCgpCgogICAgZGVmIGludmFsaWRhdGVfY2FjaGVzKHNlbGYpOgogICAgICAgICIiIkludmFsaWRhdGUgdGhlIGRpcmVjdG9yeSBtdGltZS4iIiIKICAgICAgICBzZWxmLl9wYXRoX210aW1lID0gLTEKCiAgICBmaW5kX21vZHVsZSA9IF9maW5kX21vZHVsZV9zaGltCgogICAgZGVmIGZpbmRfbG9hZGVyKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICAiIiJUcnkgdG8gZmluZCBhIGxvYWRlciBmb3IgdGhlIHNwZWNpZmllZCBtb2R1bGUsIG9yIHRoZSBuYW1lc3BhY2UKICAgICAgICBwYWNrYWdlIHBvcnRpb25zLiBSZXR1cm5zIChsb2FkZXIsIGxpc3Qtb2YtcG9ydGlvbnMpLiIiIgogICAgICAgIGlzX25hbWVzcGFjZSA9IEZhbHNlCiAgICAgICAgdGFpbF9tb2R1bGUgPSBmdWxsbmFtZS5ycGFydGl0aW9uKCcuJylbMl0KICAgICAgICB0cnk6CiAgICAgICAgICAgIG10aW1lID0gX29zLnN0YXQoc2VsZi5wYXRoKS5zdF9tdGltZQogICAgICAgIGV4Y2VwdCBPU0Vycm9yOgogICAgICAgICAgICBtdGltZSA9IC0xCiAgICAgICAgaWYgbXRpbWUgIT0gc2VsZi5fcGF0aF9tdGltZToKICAgICAgICAgICAgc2VsZi5fZmlsbF9jYWNoZSgpCiAgICAgICAgICAgIHNlbGYuX3BhdGhfbXRpbWUgPSBtdGltZQogICAgICAgICMgdGFpbF9tb2R1bGUga2VlcHMgdGhlIG9yaWdpbmFsIGNhc2luZywgZm9yIF9fZmlsZV9fIGFuZCBmcmllbmRzCiAgICAgICAgaWYgX3JlbGF4X2Nhc2UoKToKICAgICAgICAgICAgY2FjaGUgPSBzZWxmLl9yZWxheGVkX3BhdGhfY2FjaGUKICAgICAgICAgICAgY2FjaGVfbW9kdWxlID0gdGFpbF9tb2R1bGUubG93ZXIoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNhY2hlID0gc2VsZi5fcGF0aF9jYWNoZQogICAgICAgICAgICBjYWNoZV9tb2R1bGUgPSB0YWlsX21vZHVsZQogICAgICAgICMgQ2hlY2sgaWYgdGhlIG1vZHVsZSBpcyB0aGUgbmFtZSBvZiBhIGRpcmVjdG9yeSAoYW5kIHRodXMgYSBwYWNrYWdlKS4KICAgICAgICBpZiBjYWNoZV9tb2R1bGUgaW4gY2FjaGU6CiAgICAgICAgICAgIGJhc2VfcGF0aCA9IF9wYXRoX2pvaW4oc2VsZi5wYXRoLCB0YWlsX21vZHVsZSkKICAgICAgICAgICAgaWYgX3BhdGhfaXNkaXIoYmFzZV9wYXRoKToKICAgICAgICAgICAgICAgIGZvciBzdWZmaXgsIGxvYWRlciBpbiBzZWxmLl9sb2FkZXJzOgogICAgICAgICAgICAgICAgICAgIGluaXRfZmlsZW5hbWUgPSAnX19pbml0X18nICsgc3VmZml4CiAgICAgICAgICAgICAgICAgICAgZnVsbF9wYXRoID0gX3BhdGhfam9pbihiYXNlX3BhdGgsIGluaXRfZmlsZW5hbWUpCiAgICAgICAgICAgICAgICAgICAgaWYgX3BhdGhfaXNmaWxlKGZ1bGxfcGF0aCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9hZGVyKGZ1bGxuYW1lLCBmdWxsX3BhdGgpLCBbYmFzZV9wYXRoXSkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgIyBBIG5hbWVzcGFjZSBwYWNrYWdlLCByZXR1cm4gdGhlIHBhdGggaWYgd2UgZG9uJ3QgYWxzbwogICAgICAgICAgICAgICAgICAgICMgIGZpbmQgYSBtb2R1bGUgaW4gdGhlIG5leHQgc2VjdGlvbi4KICAgICAgICAgICAgICAgICAgICBpc19uYW1lc3BhY2UgPSBUcnVlCiAgICAgICAgIyBDaGVjayBmb3IgYSBmaWxlIHcvIGEgcHJvcGVyIHN1ZmZpeCBleGlzdHMuCiAgICAgICAgZm9yIHN1ZmZpeCwgbG9hZGVyIGluIHNlbGYuX2xvYWRlcnM6CiAgICAgICAgICAgIGlmIGNhY2hlX21vZHVsZSArIHN1ZmZpeCBpbiBjYWNoZToKICAgICAgICAgICAgICAgIGZ1bGxfcGF0aCA9IF9wYXRoX2pvaW4oc2VsZi5wYXRoLCB0YWlsX21vZHVsZSArIHN1ZmZpeCkKICAgICAgICAgICAgICAgIGlmIF9wYXRoX2lzZmlsZShmdWxsX3BhdGgpOgogICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9hZGVyKGZ1bGxuYW1lLCBmdWxsX3BhdGgpLCBbXSkKICAgICAgICBpZiBpc19uYW1lc3BhY2U6CiAgICAgICAgICAgIHJldHVybiAoTm9uZSwgW2Jhc2VfcGF0aF0pCiAgICAgICAgcmV0dXJuIChOb25lLCBbXSkKCiAgICBkZWYgX2ZpbGxfY2FjaGUoc2VsZik6CiAgICAgICAgIiIiRmlsbCB0aGUgY2FjaGUgb2YgcG90ZW50aWFsIG1vZHVsZXMgYW5kIHBhY2thZ2VzIGZvciB0aGlzIGRpcmVjdG9yeS4iIiIKICAgICAgICBwYXRoID0gc2VsZi5wYXRoCiAgICAgICAgdHJ5OgogICAgICAgICAgICBjb250ZW50cyA9IF9vcy5saXN0ZGlyKHBhdGgpCiAgICAgICAgZXhjZXB0IEZpbGVOb3RGb3VuZEVycm9yOgogICAgICAgICAgICAjIERpcmVjdG9yeSBoYXMgYmVlbiByZW1vdmVkIHNpbmNlIGxhc3QgaW1wb3J0CiAgICAgICAgICAgIGNvbnRlbnRzID0gW10KICAgICAgICAjIFdlIHN0b3JlIHR3byBjYWNoZWQgdmVyc2lvbnMsIHRvIGhhbmRsZSBydW50aW1lIGNoYW5nZXMgb2YgdGhlCiAgICAgICAgIyBQWVRIT05DQVNFT0sgZW52aXJvbm1lbnQgdmFyaWFibGUuCiAgICAgICAgaWYgbm90IHN5cy5wbGF0Zm9ybS5zdGFydHN3aXRoKCd3aW4nKToKICAgICAgICAgICAgc2VsZi5fcGF0aF9jYWNoZSA9IHNldChjb250ZW50cykKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIFdpbmRvd3MgdXNlcnMgY2FuIGltcG9ydCBtb2R1bGVzIHdpdGggY2FzZS1pbnNlbnNpdGl2ZSBmaWxlCiAgICAgICAgICAgICMgc3VmZml4ZXMgKGZvciBsZWdhY3kgcmVhc29ucykuIE1ha2UgdGhlIHN1ZmZpeCBsb3dlcmNhc2UgaGVyZQogICAgICAgICAgICAjIHNvIGl0J3MgZG9uZSBvbmNlIGluc3RlYWQgb2YgZm9yIGV2ZXJ5IGltcG9ydC4gVGhpcyBpcyBzYWZlIGFzCiAgICAgICAgICAgICMgdGhlIHNwZWNpZmllZCBzdWZmaXhlcyB0byBjaGVjayBhZ2FpbnN0IGFyZSBhbHdheXMgc3BlY2lmaWVkIGluIGEKICAgICAgICAgICAgIyBjYXNlLXNlbnNpdGl2ZSBtYW5uZXIuCiAgICAgICAgICAgIGxvd2VyX3N1ZmZpeF9jb250ZW50cyA9IHNldCgpCiAgICAgICAgICAgIGZvciBpdGVtIGluIGNvbnRlbnRzOgogICAgICAgICAgICAgICAgbmFtZSwgZG90LCBzdWZmaXggPSBpdGVtLnBhcnRpdGlvbignLicpCiAgICAgICAgICAgICAgICBpZiBkb3Q6CiAgICAgICAgICAgICAgICAgICAgbmV3X25hbWUgPSAne30ue30nLmZvcm1hdChuYW1lLCBzdWZmaXgubG93ZXIoKSkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgbmV3X25hbWUgPSBuYW1lCiAgICAgICAgICAgICAgICBsb3dlcl9zdWZmaXhfY29udGVudHMuYWRkKG5ld19uYW1lKQogICAgICAgICAgICBzZWxmLl9wYXRoX2NhY2hlID0gbG93ZXJfc3VmZml4X2NvbnRlbnRzCiAgICAgICAgaWYgc3lzLnBsYXRmb3JtLnN0YXJ0c3dpdGgoX0NBU0VfSU5TRU5TSVRJVkVfUExBVEZPUk1TKToKICAgICAgICAgICAgc2VsZi5fcmVsYXhlZF9wYXRoX2NhY2hlID0gc2V0KGZuLmxvd2VyKCkgZm9yIGZuIGluIGNvbnRlbnRzKQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIHBhdGhfaG9vayhjbHMsICpsb2FkZXJfZGV0YWlscyk6CiAgICAgICAgIiIiQSBjbGFzcyBtZXRob2Qgd2hpY2ggcmV0dXJucyBhIGNsb3N1cmUgdG8gdXNlIG9uIHN5cy5wYXRoX2hvb2sKICAgICAgICB3aGljaCB3aWxsIHJldHVybiBhbiBpbnN0YW5jZSB1c2luZyB0aGUgc3BlY2lmaWVkIGxvYWRlcnMgYW5kIHRoZSBwYXRoCiAgICAgICAgY2FsbGVkIG9uIHRoZSBjbG9zdXJlLgoKICAgICAgICBJZiB0aGUgcGF0aCBjYWxsZWQgb24gdGhlIGNsb3N1cmUgaXMgbm90IGEgZGlyZWN0b3J5LCBJbXBvcnRFcnJvciBpcwogICAgICAgIHJhaXNlZC4KCiAgICAgICAgIiIiCiAgICAgICAgZGVmIHBhdGhfaG9va19mb3JfRmlsZUZpbmRlcihwYXRoKToKICAgICAgICAgICAgIiIiUGF0aCBob29rIGZvciBpbXBvcnRsaWIubWFjaGluZXJ5LkZpbGVGaW5kZXIuIiIiCiAgICAgICAgICAgIGlmIG5vdCBfcGF0aF9pc2RpcihwYXRoKToKICAgICAgICAgICAgICAgIHJhaXNlIEltcG9ydEVycm9yKCJvbmx5IGRpcmVjdG9yaWVzIGFyZSBzdXBwb3J0ZWQiLCBwYXRoPXBhdGgpCiAgICAgICAgICAgIHJldHVybiBjbHMocGF0aCwgKmxvYWRlcl9kZXRhaWxzKQoKICAgICAgICByZXR1cm4gcGF0aF9ob29rX2Zvcl9GaWxlRmluZGVyCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiAiRmlsZUZpbmRlciglcikiICUgKHNlbGYucGF0aCwpCgoKIyBJbXBvcnQgaXRzZWxmICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKY2xhc3MgX0ltcG9ydExvY2tDb250ZXh0OgoKICAgICIiIkNvbnRleHQgbWFuYWdlciBmb3IgdGhlIGltcG9ydCBsb2NrLiIiIgoKICAgIGRlZiBfX2VudGVyX18oc2VsZik6CiAgICAgICAgIiIiQWNxdWlyZSB0aGUgaW1wb3J0IGxvY2suIiIiCiAgICAgICAgX2ltcC5hY3F1aXJlX2xvY2soKQoKICAgIGRlZiBfX2V4aXRfXyhzZWxmLCBleGNfdHlwZSwgZXhjX3ZhbHVlLCBleGNfdHJhY2ViYWNrKToKICAgICAgICAiIiJSZWxlYXNlIHRoZSBpbXBvcnQgbG9jayByZWdhcmRsZXNzIG9mIGFueSByYWlzZWQgZXhjZXB0aW9ucy4iIiIKICAgICAgICBfaW1wLnJlbGVhc2VfbG9jaygpCgoKZGVmIF9yZXNvbHZlX25hbWUobmFtZSwgcGFja2FnZSwgbGV2ZWwpOgogICAgIiIiUmVzb2x2ZSBhIHJlbGF0aXZlIG1vZHVsZSBuYW1lIHRvIGFuIGFic29sdXRlIG9uZS4iIiIKICAgIGJpdHMgPSBwYWNrYWdlLnJzcGxpdCgnLicsIGxldmVsIC0gMSkKICAgIGlmIGxlbihiaXRzKSA8IGxldmVsOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoJ2F0dGVtcHRlZCByZWxhdGl2ZSBpbXBvcnQgYmV5b25kIHRvcC1sZXZlbCBwYWNrYWdlJykKICAgIGJhc2UgPSBiaXRzWzBdCiAgICByZXR1cm4gJ3t9Lnt9Jy5mb3JtYXQoYmFzZSwgbmFtZSkgaWYgbmFtZSBlbHNlIGJhc2UKCgpkZWYgX2ZpbmRfbW9kdWxlKG5hbWUsIHBhdGgpOgogICAgIiIiRmluZCBhIG1vZHVsZSdzIGxvYWRlci4iIiIKICAgIGlmIG5vdCBzeXMubWV0YV9wYXRoOgogICAgICAgIF93YXJuaW5ncy53YXJuKCdzeXMubWV0YV9wYXRoIGlzIGVtcHR5JywgSW1wb3J0V2FybmluZykKICAgIGZvciBmaW5kZXIgaW4gc3lzLm1ldGFfcGF0aDoKICAgICAgICB3aXRoIF9JbXBvcnRMb2NrQ29udGV4dCgpOgogICAgICAgICAgICBsb2FkZXIgPSBmaW5kZXIuZmluZF9tb2R1bGUobmFtZSwgcGF0aCkKICAgICAgICBpZiBsb2FkZXIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICMgVGhlIHBhcmVudCBpbXBvcnQgbWF5IGhhdmUgYWxyZWFkeSBpbXBvcnRlZCB0aGlzIG1vZHVsZS4KICAgICAgICAgICAgaWYgbmFtZSBub3QgaW4gc3lzLm1vZHVsZXM6CiAgICAgICAgICAgICAgICByZXR1cm4gbG9hZGVyCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZXR1cm4gc3lzLm1vZHVsZXNbbmFtZV0uX19sb2FkZXJfXwogICAgZWxzZToKICAgICAgICByZXR1cm4gTm9uZQoKCmRlZiBfc2FuaXR5X2NoZWNrKG5hbWUsIHBhY2thZ2UsIGxldmVsKToKICAgICIiIlZlcmlmeSBhcmd1bWVudHMgYXJlICJzYW5lIi4iIiIKICAgIGlmIG5vdCBpc2luc3RhbmNlKG5hbWUsIHN0cik6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJtb2R1bGUgbmFtZSBtdXN0IGJlIHN0ciwgbm90IHt9Ii5mb3JtYXQodHlwZShuYW1lKSkpCiAgICBpZiBsZXZlbCA8IDA6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignbGV2ZWwgbXVzdCBiZSA+PSAwJykKICAgIGlmIHBhY2thZ2U6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UocGFja2FnZSwgc3RyKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJfX3BhY2thZ2VfXyBub3Qgc2V0IHRvIGEgc3RyaW5nIikKICAgICAgICBlbGlmIHBhY2thZ2Ugbm90IGluIHN5cy5tb2R1bGVzOgogICAgICAgICAgICBtc2cgPSAoIlBhcmVudCBtb2R1bGUgeyFyfSBub3QgbG9hZGVkLCBjYW5ub3QgcGVyZm9ybSByZWxhdGl2ZSAiCiAgICAgICAgICAgICAgICAgICAiaW1wb3J0IikKICAgICAgICAgICAgcmFpc2UgU3lzdGVtRXJyb3IobXNnLmZvcm1hdChwYWNrYWdlKSkKICAgIGlmIG5vdCBuYW1lIGFuZCBsZXZlbCA9PSAwOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIkVtcHR5IG1vZHVsZSBuYW1lIikKCgpfRVJSX01TRyA9ICdObyBtb2R1bGUgbmFtZWQgeyFyfScKCmRlZiBfZmluZF9hbmRfbG9hZF91bmxvY2tlZChuYW1lLCBpbXBvcnRfKToKICAgIHBhdGggPSBOb25lCiAgICBwYXJlbnQgPSBuYW1lLnJwYXJ0aXRpb24oJy4nKVswXQogICAgaWYgcGFyZW50OgogICAgICAgIGlmIHBhcmVudCBub3QgaW4gc3lzLm1vZHVsZXM6CiAgICAgICAgICAgIF9jYWxsX3dpdGhfZnJhbWVzX3JlbW92ZWQoaW1wb3J0XywgcGFyZW50KQogICAgICAgICMgQ3Jhenkgc2lkZS1lZmZlY3RzIQogICAgICAgIGlmIG5hbWUgaW4gc3lzLm1vZHVsZXM6CiAgICAgICAgICAgIHJldHVybiBzeXMubW9kdWxlc1tuYW1lXQogICAgICAgICMgQmFja3dhcmRzLWNvbXBhdGliaWxpdHk7IGJlIG5pY2VyIHRvIHNraXAgdGhlIGRpY3QgbG9va3VwLgogICAgICAgIHBhcmVudF9tb2R1bGUgPSBzeXMubW9kdWxlc1twYXJlbnRdCiAgICAgICAgdHJ5OgogICAgICAgICAgICBwYXRoID0gcGFyZW50X21vZHVsZS5fX3BhdGhfXwogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgbXNnID0gKF9FUlJfTVNHICsgJzsge30gaXMgbm90IGEgcGFja2FnZScpLmZvcm1hdChuYW1lLCBwYXJlbnQpCiAgICAgICAgICAgIHJhaXNlIEltcG9ydEVycm9yKG1zZywgbmFtZT1uYW1lKQogICAgbG9hZGVyID0gX2ZpbmRfbW9kdWxlKG5hbWUsIHBhdGgpCiAgICBpZiBsb2FkZXIgaXMgTm9uZToKICAgICAgICBleGMgPSBJbXBvcnRFcnJvcihfRVJSX01TRy5mb3JtYXQobmFtZSksIG5hbWU9bmFtZSkKICAgICAgICAjIFRPRE8oYnJldHQpOiBzd2l0Y2ggdG8gYSBwcm9wZXIgTW9kdWxlTm90Rm91bmQgZXhjZXB0aW9uIGluIFB5dGhvbgogICAgICAgICMgMy40LgogICAgICAgIGV4Yy5fbm90X2ZvdW5kID0gVHJ1ZQogICAgICAgIHJhaXNlIGV4YwogICAgZWxpZiBuYW1lIG5vdCBpbiBzeXMubW9kdWxlczoKICAgICAgICAjIFRoZSBwYXJlbnQgaW1wb3J0IG1heSBoYXZlIGFscmVhZHkgaW1wb3J0ZWQgdGhpcyBtb2R1bGUuCiAgICAgICAgbG9hZGVyLmxvYWRfbW9kdWxlKG5hbWUpCiAgICAgICAgX3ZlcmJvc2VfbWVzc2FnZSgnaW1wb3J0IHshcn0gIyB7IXJ9JywgbmFtZSwgbG9hZGVyKQogICAgIyBCYWNrd2FyZHMtY29tcGF0aWJpbGl0eTsgYmUgbmljZXIgdG8gc2tpcCB0aGUgZGljdCBsb29rdXAuCiAgICBtb2R1bGUgPSBzeXMubW9kdWxlc1tuYW1lXQogICAgaWYgcGFyZW50OgogICAgICAgICMgU2V0IHRoZSBtb2R1bGUgYXMgYW4gYXR0cmlidXRlIG9uIGl0cyBwYXJlbnQuCiAgICAgICAgcGFyZW50X21vZHVsZSA9IHN5cy5tb2R1bGVzW3BhcmVudF0KICAgICAgICBzZXRhdHRyKHBhcmVudF9tb2R1bGUsIG5hbWUucnBhcnRpdGlvbignLicpWzJdLCBtb2R1bGUpCiAgICAjIFNldCBfX3BhY2thZ2VfXyBpZiB0aGUgbG9hZGVyIGRpZCBub3QuCiAgICBpZiBnZXRhdHRyKG1vZHVsZSwgJ19fcGFja2FnZV9fJywgTm9uZSkgaXMgTm9uZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIG1vZHVsZS5fX3BhY2thZ2VfXyA9IG1vZHVsZS5fX25hbWVfXwogICAgICAgICAgICBpZiBub3QgaGFzYXR0cihtb2R1bGUsICdfX3BhdGhfXycpOgogICAgICAgICAgICAgICAgbW9kdWxlLl9fcGFja2FnZV9fID0gbW9kdWxlLl9fcGFja2FnZV9fLnJwYXJ0aXRpb24oJy4nKVswXQogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgIyBTZXQgbG9hZGVyIGlmIG5lZWQgYmUuCiAgICBpZiBub3QgaGFzYXR0cihtb2R1bGUsICdfX2xvYWRlcl9fJyk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBtb2R1bGUuX19sb2FkZXJfXyA9IGxvYWRlcgogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgcmV0dXJuIG1vZHVsZQoKCmRlZiBfZmluZF9hbmRfbG9hZChuYW1lLCBpbXBvcnRfKToKICAgICIiIkZpbmQgYW5kIGxvYWQgdGhlIG1vZHVsZSwgYW5kIHJlbGVhc2UgdGhlIGltcG9ydCBsb2NrLiIiIgogICAgdHJ5OgogICAgICAgIGxvY2sgPSBfZ2V0X21vZHVsZV9sb2NrKG5hbWUpCiAgICBmaW5hbGx5OgogICAgICAgIF9pbXAucmVsZWFzZV9sb2NrKCkKICAgIGxvY2suYWNxdWlyZSgpCiAgICB0cnk6CiAgICAgICAgcmV0dXJuIF9maW5kX2FuZF9sb2FkX3VubG9ja2VkKG5hbWUsIGltcG9ydF8pCiAgICBmaW5hbGx5OgogICAgICAgIGxvY2sucmVsZWFzZSgpCgoKZGVmIF9nY2RfaW1wb3J0KG5hbWUsIHBhY2thZ2U9Tm9uZSwgbGV2ZWw9MCk6CiAgICAiIiJJbXBvcnQgYW5kIHJldHVybiB0aGUgbW9kdWxlIGJhc2VkIG9uIGl0cyBuYW1lLCB0aGUgcGFja2FnZSB0aGUgY2FsbCBpcwogICAgYmVpbmcgbWFkZSBmcm9tLCBhbmQgdGhlIGxldmVsIGFkanVzdG1lbnQuCgogICAgVGhpcyBmdW5jdGlvbiByZXByZXNlbnRzIHRoZSBncmVhdGVzdCBjb21tb24gZGVub21pbmF0b3Igb2YgZnVuY3Rpb25hbGl0eQogICAgYmV0d2VlbiBpbXBvcnRfbW9kdWxlIGFuZCBfX2ltcG9ydF9fLiBUaGlzIGluY2x1ZGVzIHNldHRpbmcgX19wYWNrYWdlX18gaWYKICAgIHRoZSBsb2FkZXIgZGlkIG5vdC4KCiAgICAiIiIKICAgIF9zYW5pdHlfY2hlY2sobmFtZSwgcGFja2FnZSwgbGV2ZWwpCiAgICBpZiBsZXZlbCA+IDA6CiAgICAgICAgbmFtZSA9IF9yZXNvbHZlX25hbWUobmFtZSwgcGFja2FnZSwgbGV2ZWwpCiAgICBfaW1wLmFjcXVpcmVfbG9jaygpCiAgICBpZiBuYW1lIG5vdCBpbiBzeXMubW9kdWxlczoKICAgICAgICByZXR1cm4gX2ZpbmRfYW5kX2xvYWQobmFtZSwgX2djZF9pbXBvcnQpCiAgICBtb2R1bGUgPSBzeXMubW9kdWxlc1tuYW1lXQogICAgaWYgbW9kdWxlIGlzIE5vbmU6CiAgICAgICAgX2ltcC5yZWxlYXNlX2xvY2soKQogICAgICAgIG1lc3NhZ2UgPSAoImltcG9ydCBvZiB7fSBoYWx0ZWQ7ICIKICAgICAgICAgICAgICAgICAgICAiTm9uZSBpbiBzeXMubW9kdWxlcyIuZm9ybWF0KG5hbWUpKQogICAgICAgIHJhaXNlIEltcG9ydEVycm9yKG1lc3NhZ2UsIG5hbWU9bmFtZSkKICAgIF9sb2NrX3VubG9ja19tb2R1bGUobmFtZSkKICAgIHJldHVybiBtb2R1bGUKCmRlZiBfaGFuZGxlX2Zyb21saXN0KG1vZHVsZSwgZnJvbWxpc3QsIGltcG9ydF8pOgogICAgIiIiRmlndXJlIG91dCB3aGF0IF9faW1wb3J0X18gc2hvdWxkIHJldHVybi4KCiAgICBUaGUgaW1wb3J0XyBwYXJhbWV0ZXIgaXMgYSBjYWxsYWJsZSB3aGljaCB0YWtlcyB0aGUgbmFtZSBvZiBtb2R1bGUgdG8KICAgIGltcG9ydC4gSXQgaXMgcmVxdWlyZWQgdG8gZGVjb3VwbGUgdGhlIGZ1bmN0aW9uIGZyb20gYXNzdW1pbmcgaW1wb3J0bGliJ3MKICAgIGltcG9ydCBpbXBsZW1lbnRhdGlvbiBpcyBkZXNpcmVkLgoKICAgICIiIgogICAgIyBUaGUgaGVsbCB0aGF0IGlzIGZyb21saXN0IC4uLgogICAgIyBJZiBhIHBhY2thZ2Ugd2FzIGltcG9ydGVkLCB0cnkgdG8gaW1wb3J0IHN0dWZmIGZyb20gZnJvbWxpc3QuCiAgICBpZiBoYXNhdHRyKG1vZHVsZSwgJ19fcGF0aF9fJyk6CiAgICAgICAgaWYgJyonIGluIGZyb21saXN0OgogICAgICAgICAgICBmcm9tbGlzdCA9IGxpc3QoZnJvbWxpc3QpCiAgICAgICAgICAgIGZyb21saXN0LnJlbW92ZSgnKicpCiAgICAgICAgICAgIGlmIGhhc2F0dHIobW9kdWxlLCAnX19hbGxfXycpOgogICAgICAgICAgICAgICAgZnJvbWxpc3QuZXh0ZW5kKG1vZHVsZS5fX2FsbF9fKQogICAgICAgIGZvciB4IGluIGZyb21saXN0OgogICAgICAgICAgICBpZiBub3QgaGFzYXR0cihtb2R1bGUsIHgpOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIF9jYWxsX3dpdGhfZnJhbWVzX3JlbW92ZWQoaW1wb3J0XywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAne30ue30nLmZvcm1hdChtb2R1bGUuX19uYW1lX18sIHgpKQogICAgICAgICAgICAgICAgZXhjZXB0IEltcG9ydEVycm9yIGFzIGV4YzoKICAgICAgICAgICAgICAgICAgICAjIEJhY2t3YXJkcy1jb21wYXRpYmlsaXR5IGRpY3RhdGVzIHdlIGlnbm9yZSBmYWlsZWQKICAgICAgICAgICAgICAgICAgICAjIGltcG9ydHMgdHJpZ2dlcmVkIGJ5IGZyb21saXN0IGZvciBtb2R1bGVzIHRoYXQgZG9uJ3QKICAgICAgICAgICAgICAgICAgICAjIGV4aXN0LgogICAgICAgICAgICAgICAgICAgICMgVE9ETyhicmV0dCk6IEluIFB5dGhvbiAzLjQsIGhhdmUgaW1wb3J0IHJhaXNlCiAgICAgICAgICAgICAgICAgICAgIyAgIE1vZHVsZU5vdEZvdW5kIGFuZCBjYXRjaCB0aGF0LgogICAgICAgICAgICAgICAgICAgIGlmIGhhc2F0dHIoZXhjLCAnX25vdF9mb3VuZCcpIGFuZCBleGMuX25vdF9mb3VuZDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICByZXR1cm4gbW9kdWxlCgoKZGVmIF9jYWxjX19fcGFja2FnZV9fKGdsb2JhbHMpOgogICAgIiIiQ2FsY3VsYXRlIHdoYXQgX19wYWNrYWdlX18gc2hvdWxkIGJlLgoKICAgIF9fcGFja2FnZV9fIGlzIG5vdCBndWFyYW50ZWVkIHRvIGJlIGRlZmluZWQgb3IgY291bGQgYmUgc2V0IHRvIE5vbmUKICAgIHRvIHJlcHJlc2VudCB0aGF0IGl0cyBwcm9wZXIgdmFsdWUgaXMgdW5rbm93bi4KCiAgICAiIiIKICAgIHBhY2thZ2UgPSBnbG9iYWxzLmdldCgnX19wYWNrYWdlX18nKQogICAgaWYgcGFja2FnZSBpcyBOb25lOgogICAgICAgIHBhY2thZ2UgPSBnbG9iYWxzWydfX25hbWVfXyddCiAgICAgICAgaWYgJ19fcGF0aF9fJyBub3QgaW4gZ2xvYmFsczoKICAgICAgICAgICAgcGFja2FnZSA9IHBhY2thZ2UucnBhcnRpdGlvbignLicpWzBdCiAgICByZXR1cm4gcGFja2FnZQoKCmRlZiBfZ2V0X3N1cHBvcnRlZF9maWxlX2xvYWRlcnMoKToKICAgICIiIlJldHVybnMgYSBsaXN0IG9mIGZpbGUtYmFzZWQgbW9kdWxlIGxvYWRlcnMuCgogICAgRWFjaCBpdGVtIGlzIGEgdHVwbGUgKGxvYWRlciwgc3VmZml4ZXMsIGFsbG93X3BhY2thZ2VzKS4KICAgICIiIgogICAgZXh0ZW5zaW9ucyA9IEV4dGVuc2lvbkZpbGVMb2FkZXIsIF9pbXAuZXh0ZW5zaW9uX3N1ZmZpeGVzKCkKICAgIHNvdXJjZSA9IFNvdXJjZUZpbGVMb2FkZXIsIFNPVVJDRV9TVUZGSVhFUwogICAgYnl0ZWNvZGUgPSBTb3VyY2VsZXNzRmlsZUxvYWRlciwgQllURUNPREVfU1VGRklYRVMKICAgIHJldHVybiBbZXh0ZW5zaW9ucywgc291cmNlLCBieXRlY29kZV0KCgpkZWYgX19pbXBvcnRfXyhuYW1lLCBnbG9iYWxzPU5vbmUsIGxvY2Fscz1Ob25lLCBmcm9tbGlzdD0oKSwgbGV2ZWw9MCk6CiAgICAiIiJJbXBvcnQgYSBtb2R1bGUuCgogICAgVGhlICdnbG9iYWxzJyBhcmd1bWVudCBpcyB1c2VkIHRvIGluZmVyIHdoZXJlIHRoZSBpbXBvcnQgaXMgb2NjdXJpbmcgZnJvbQogICAgdG8gaGFuZGxlIHJlbGF0aXZlIGltcG9ydHMuIFRoZSAnbG9jYWxzJyBhcmd1bWVudCBpcyBpZ25vcmVkLiBUaGUKICAgICdmcm9tbGlzdCcgYXJndW1lbnQgc3BlY2lmaWVzIHdoYXQgc2hvdWxkIGV4aXN0IGFzIGF0dHJpYnV0ZXMgb24gdGhlIG1vZHVsZQogICAgYmVpbmcgaW1wb3J0ZWQgKGUuZy4gYGBmcm9tIG1vZHVsZSBpbXBvcnQgPGZyb21saXN0PmBgKS4gIFRoZSAnbGV2ZWwnCiAgICBhcmd1bWVudCByZXByZXNlbnRzIHRoZSBwYWNrYWdlIGxvY2F0aW9uIHRvIGltcG9ydCBmcm9tIGluIGEgcmVsYXRpdmUKICAgIGltcG9ydCAoZS5nLiBgYGZyb20gLi5wa2cgaW1wb3J0IG1vZGBgIHdvdWxkIGhhdmUgYSAnbGV2ZWwnIG9mIDIpLgoKICAgICIiIgogICAgaWYgbGV2ZWwgPT0gMDoKICAgICAgICBtb2R1bGUgPSBfZ2NkX2ltcG9ydChuYW1lKQogICAgZWxzZToKICAgICAgICBnbG9iYWxzXyA9IGdsb2JhbHMgaWYgZ2xvYmFscyBpcyBub3QgTm9uZSBlbHNlIHt9CiAgICAgICAgcGFja2FnZSA9IF9jYWxjX19fcGFja2FnZV9fKGdsb2JhbHNfKQogICAgICAgIG1vZHVsZSA9IF9nY2RfaW1wb3J0KG5hbWUsIHBhY2thZ2UsIGxldmVsKQogICAgaWYgbm90IGZyb21saXN0OgogICAgICAgICMgUmV0dXJuIHVwIHRvIHRoZSBmaXJzdCBkb3QgaW4gJ25hbWUnLiBUaGlzIGlzIGNvbXBsaWNhdGVkIGJ5IHRoZSBmYWN0CiAgICAgICAgIyB0aGF0ICduYW1lJyBtYXkgYmUgcmVsYXRpdmUuCiAgICAgICAgaWYgbGV2ZWwgPT0gMDoKICAgICAgICAgICAgcmV0dXJuIF9nY2RfaW1wb3J0KG5hbWUucGFydGl0aW9uKCcuJylbMF0pCiAgICAgICAgZWxpZiBub3QgbmFtZToKICAgICAgICAgICAgcmV0dXJuIG1vZHVsZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGN1dF9vZmYgPSBsZW4obmFtZSkgLSBsZW4obmFtZS5wYXJ0aXRpb24oJy4nKVswXSkKICAgICAgICAgICAgcmV0dXJuIHN5cy5tb2R1bGVzW21vZHVsZS5fX25hbWVfX1s6bGVuKG1vZHVsZS5fX25hbWVfXyktY3V0X29mZl1dCiAgICBlbHNlOgogICAgICAgIHJldHVybiBfaGFuZGxlX2Zyb21saXN0KG1vZHVsZSwgZnJvbWxpc3QsIF9nY2RfaW1wb3J0KQoKCgpkZWYgX3NldHVwKHN5c19tb2R1bGUsIF9pbXBfbW9kdWxlKToKICAgICIiIlNldHVwIGltcG9ydGxpYiBieSBpbXBvcnRpbmcgbmVlZGVkIGJ1aWx0LWluIG1vZHVsZXMgYW5kIGluamVjdGluZyB0aGVtCiAgICBpbnRvIHRoZSBnbG9iYWwgbmFtZXNwYWNlLgoKICAgIEFzIHN5cyBpcyBuZWVkZWQgZm9yIHN5cy5tb2R1bGVzIGFjY2VzcyBhbmQgX2ltcCBpcyBuZWVkZWQgdG8gbG9hZCBidWlsdC1pbgogICAgbW9kdWxlcywgdGhvc2UgdHdvIG1vZHVsZXMgbXVzdCBiZSBleHBsaWNpdGx5IHBhc3NlZCBpbi4KCiAgICAiIiIKICAgIGdsb2JhbCBfaW1wLCBzeXMKICAgIF9pbXAgPSBfaW1wX21vZHVsZQoKICAgIGZvciBtb2R1bGUgaW4gKF9pbXAsIHN5cyk6CiAgICAgICAgaWYgbm90IGhhc2F0dHIobW9kdWxlLCAnX19sb2FkZXJfXycpOgogICAgICAgICAgICBtb2R1bGUuX19sb2FkZXJfXyA9IEJ1aWx0aW5JbXBvcnRlcgoKICAgIHNlbGZfbW9kdWxlID0gc3lzLm1vZHVsZXNbX19uYW1lX19dCiAgICBmb3IgYnVpbHRpbl9uYW1lIGluICgnX2lvJywgJ193YXJuaW5ncycsICdidWlsdGlucycsICdtYXJzaGFsJyk6CiAgICAgICAgaWYgYnVpbHRpbl9uYW1lIG5vdCBpbiBzeXMubW9kdWxlczoKICAgICAgICAgICAgYnVpbHRpbl9tb2R1bGUgPSBCdWlsdGluSW1wb3J0ZXIubG9hZF9tb2R1bGUoYnVpbHRpbl9uYW1lKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGJ1aWx0aW5fbW9kdWxlID0gc3lzLm1vZHVsZXNbYnVpbHRpbl9uYW1lXQogICAgICAgIHNldGF0dHIoc2VsZl9tb2R1bGUsIGJ1aWx0aW5fbmFtZSwgYnVpbHRpbl9tb2R1bGUpCgogICAgb3NfZGV0YWlscyA9ICgncG9zaXgnLCBbJy8nXSksICgnbnQnLCBbJ1xcJywgJy8nXSksICgnb3MyJywgWydcXCcsICcvJ10pCiAgICBmb3IgYnVpbHRpbl9vcywgcGF0aF9zZXBhcmF0b3JzIGluIG9zX2RldGFpbHM6CiAgICAgICAgIyBBc3N1bXB0aW9uIG1hZGUgaW4gX3BhdGhfam9pbigpCiAgICAgICAgYXNzZXJ0IGFsbChsZW4oc2VwKSA9PSAxIGZvciBzZXAgaW4gcGF0aF9zZXBhcmF0b3JzKQogICAgICAgIHBhdGhfc2VwID0gcGF0aF9zZXBhcmF0b3JzWzBdCiAgICAgICAgaWYgYnVpbHRpbl9vcyBpbiBzeXMubW9kdWxlczoKICAgICAgICAgICAgb3NfbW9kdWxlID0gc3lzLm1vZHVsZXNbYnVpbHRpbl9vc10KICAgICAgICAgICAgYnJlYWsKICAgICAgICBlbHNlOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBvc19tb2R1bGUgPSBCdWlsdGluSW1wb3J0ZXIubG9hZF9tb2R1bGUoYnVpbHRpbl9vcykKICAgICAgICAgICAgICAgICMgVE9ETzogcmlwIG91dCBvczIgY29kZSBhZnRlciAzLjMgaXMgcmVsZWFzZWQgYXMgcGVyIFBFUCAxMQogICAgICAgICAgICAgICAgaWYgYnVpbHRpbl9vcyA9PSAnb3MyJyBhbmQgJ0VNWCBHQ0MnIGluIHN5cy52ZXJzaW9uOgogICAgICAgICAgICAgICAgICAgIHBhdGhfc2VwID0gcGF0aF9zZXBhcmF0b3JzWzFdCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgZWxzZToKICAgICAgICByYWlzZSBJbXBvcnRFcnJvcignaW1wb3J0bGliIHJlcXVpcmVzIHBvc2l4IG9yIG50JykKCiAgICB0cnk6CiAgICAgICAgdGhyZWFkX21vZHVsZSA9IEJ1aWx0aW5JbXBvcnRlci5sb2FkX21vZHVsZSgnX3RocmVhZCcpCiAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgIyBQeXRob24gd2FzIGJ1aWx0IHdpdGhvdXQgdGhyZWFkcwogICAgICAgIHRocmVhZF9tb2R1bGUgPSBOb25lCiAgICB3ZWFrcmVmX21vZHVsZSA9IEJ1aWx0aW5JbXBvcnRlci5sb2FkX21vZHVsZSgnX3dlYWtyZWYnKQoKICAgIGlmIGJ1aWx0aW5fb3MgPT0gJ250JzoKICAgICAgICB3aW5yZWdfbW9kdWxlID0gQnVpbHRpbkltcG9ydGVyLmxvYWRfbW9kdWxlKCd3aW5yZWcnKQogICAgICAgIHNldGF0dHIoc2VsZl9tb2R1bGUsICdfd2lucmVnJywgd2lucmVnX21vZHVsZSkKCiAgICBzZXRhdHRyKHNlbGZfbW9kdWxlLCAnX29zJywgb3NfbW9kdWxlKQogICAgc2V0YXR0cihzZWxmX21vZHVsZSwgJ190aHJlYWQnLCB0aHJlYWRfbW9kdWxlKQogICAgc2V0YXR0cihzZWxmX21vZHVsZSwgJ193ZWFrcmVmJywgd2Vha3JlZl9tb2R1bGUpCiAgICBzZXRhdHRyKHNlbGZfbW9kdWxlLCAncGF0aF9zZXAnLCBwYXRoX3NlcCkKICAgIHNldGF0dHIoc2VsZl9tb2R1bGUsICdwYXRoX3NlcGFyYXRvcnMnLCBzZXQocGF0aF9zZXBhcmF0b3JzKSkKICAgICMgQ29uc3RhbnRzCiAgICBzZXRhdHRyKHNlbGZfbW9kdWxlLCAnX3JlbGF4X2Nhc2UnLCBfbWFrZV9yZWxheF9jYXNlKCkpCiAgICBFWFRFTlNJT05fU1VGRklYRVMuZXh0ZW5kKF9pbXAuZXh0ZW5zaW9uX3N1ZmZpeGVzKCkpCiAgICBpZiBidWlsdGluX29zID09ICdudCc6CiAgICAgICAgU09VUkNFX1NVRkZJWEVTLmFwcGVuZCgnLnB5dycpCiAgICAgICAgaWYgJ19kLnB5ZCcgaW4gRVhURU5TSU9OX1NVRkZJWEVTOgogICAgICAgICAgICBXaW5kb3dzUmVnaXN0cnlGaW5kZXIuREVCVUdfQlVJTEQgPSBUcnVlCgoKZGVmIF9pbnN0YWxsKHN5c19tb2R1bGUsIF9pbXBfbW9kdWxlKToKICAgICIiIkluc3RhbGwgaW1wb3J0bGliIGFzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiBpbXBvcnQuIiIiCiAgICBfc2V0dXAoc3lzX21vZHVsZSwgX2ltcF9tb2R1bGUpCiAgICBzdXBwb3J0ZWRfbG9hZGVycyA9IF9nZXRfc3VwcG9ydGVkX2ZpbGVfbG9hZGVycygpCiAgICBzeXMucGF0aF9ob29rcy5leHRlbmQoW0ZpbGVGaW5kZXIucGF0aF9ob29rKCpzdXBwb3J0ZWRfbG9hZGVycyldKQogICAgc3lzLm1ldGFfcGF0aC5hcHBlbmQoQnVpbHRpbkltcG9ydGVyKQogICAgc3lzLm1ldGFfcGF0aC5hcHBlbmQoRnJvemVuSW1wb3J0ZXIpCiAgICBpZiBfb3MuX19uYW1lX18gPT0gJ250JzoKICAgICAgICBzeXMubWV0YV9wYXRoLmFwcGVuZChXaW5kb3dzUmVnaXN0cnlGaW5kZXIpCiAgICBzeXMubWV0YV9wYXRoLmFwcGVuZChQYXRoRmluZGVyKQo=',
'/Lib/importlib/__init__.py':'IiIiQSBwdXJlIFB5dGhvbiBpbXBsZW1lbnRhdGlvbiBvZiBpbXBvcnQuIiIiCl9fYWxsX18gPSBbJ19faW1wb3J0X18nLCAnaW1wb3J0X21vZHVsZScsICdpbnZhbGlkYXRlX2NhY2hlcyddCgojIEJvb3RzdHJhcCBoZWxwICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgojIFVudGlsIGJvb3RzdHJhcHBpbmcgaXMgY29tcGxldGUsIERPIE5PVCBpbXBvcnQgYW55IG1vZHVsZXMgdGhhdCBhdHRlbXB0CiMgdG8gaW1wb3J0IGltcG9ydGxpYi5fYm9vdHN0cmFwIChkaXJlY3RseSBvciBpbmRpcmVjdGx5KS4gU2luY2UgdGhpcwojIHBhcnRpYWxseSBpbml0aWFsaXNlZCBwYWNrYWdlIHdvdWxkIGJlIHByZXNlbnQgaW4gc3lzLm1vZHVsZXMsIHRob3NlCiMgbW9kdWxlcyB3b3VsZCBnZXQgYW4gdW5pbml0aWFsaXNlZCBjb3B5IG9mIHRoZSBzb3VyY2UgdmVyc2lvbiwgaW5zdGVhZAojIG9mIGEgZnVsbHkgaW5pdGlhbGlzZWQgdmVyc2lvbiAoZWl0aGVyIHRoZSBmcm96ZW4gb25lIG9yIHRoZSBvbmUKIyBpbml0aWFsaXNlZCBiZWxvdyBpZiB0aGUgZnJvemVuIG9uZSBpcyBub3QgYXZhaWxhYmxlKS4KaW1wb3J0IF9pbXAgICMgSnVzdCB0aGUgYnVpbHRpbiBjb21wb25lbnQsIE5PVCB0aGUgZnVsbCBQeXRob24gbW9kdWxlCmltcG9ydCBzeXMKCnRyeToKICAgIGltcG9ydCBfZnJvemVuX2ltcG9ydGxpYiBhcyBfYm9vdHN0cmFwCmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIGZyb20gLiBpbXBvcnQgX2Jvb3RzdHJhcAogICAgX2Jvb3RzdHJhcC5fc2V0dXAoc3lzLCBfaW1wKQplbHNlOgogICAgIyBpbXBvcnRsaWIuX2Jvb3RzdHJhcCBpcyB0aGUgYnVpbHQtaW4gaW1wb3J0LCBlbnN1cmUgd2UgZG9uJ3QgY3JlYXRlCiAgICAjIGEgc2Vjb25kIGNvcHkgb2YgdGhlIG1vZHVsZS4KICAgIF9ib290c3RyYXAuX19uYW1lX18gPSAnaW1wb3J0bGliLl9ib290c3RyYXAnCiAgICBfYm9vdHN0cmFwLl9fcGFja2FnZV9fID0gJ2ltcG9ydGxpYicKICAgIF9ib290c3RyYXAuX19maWxlX18gPSBfX2ZpbGVfXy5yZXBsYWNlKCdfX2luaXRfXy5weScsICdfYm9vdHN0cmFwLnB5JykKICAgIHN5cy5tb2R1bGVzWydpbXBvcnRsaWIuX2Jvb3RzdHJhcCddID0gX2Jvb3RzdHJhcAoKIyBUbyBzaW1wbGlmeSBpbXBvcnRzIGluIHRlc3QgY29kZQpfd19sb25nID0gX2Jvb3RzdHJhcC5fd19sb25nCl9yX2xvbmcgPSBfYm9vdHN0cmFwLl9yX2xvbmcKCiMgRnVsbHkgYm9vdHN0cmFwcGVkIGF0IHRoaXMgcG9pbnQsIGltcG9ydCB3aGF0ZXZlciB5b3UgbGlrZSwgY2lyY3VsYXIKIyBkZXBlbmRlbmNpZXMgYW5kIHN0YXJ0dXAgb3ZlcmhlYWQgbWluaW1pc2F0aW9uIHBlcm1pdHRpbmcgOikKCiMgUHVibGljIEFQSSAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmZyb20gLl9ib290c3RyYXAgaW1wb3J0IF9faW1wb3J0X18KCgpkZWYgaW52YWxpZGF0ZV9jYWNoZXMoKToKICAgICIiIkNhbGwgdGhlIGludmFsaWRhdGVfY2FjaGVzKCkgbWV0aG9kIG9uIGFsbCBtZXRhIHBhdGggZmluZGVycyBzdG9yZWQgaW4KICAgIHN5cy5tZXRhX3BhdGggKHdoZXJlIGltcGxlbWVudGVkKS4iIiIKICAgIGZvciBmaW5kZXIgaW4gc3lzLm1ldGFfcGF0aDoKICAgICAgICBpZiBoYXNhdHRyKGZpbmRlciwgJ2ludmFsaWRhdGVfY2FjaGVzJyk6CiAgICAgICAgICAgIGZpbmRlci5pbnZhbGlkYXRlX2NhY2hlcygpCgoKZGVmIGZpbmRfbG9hZGVyKG5hbWUsIHBhdGg9Tm9uZSk6CiAgICAiIiJGaW5kIHRoZSBsb2FkZXIgZm9yIHRoZSBzcGVjaWZpZWQgbW9kdWxlLgoKICAgIEZpcnN0LCBzeXMubW9kdWxlcyBpcyBjaGVja2VkIHRvIHNlZSBpZiB0aGUgbW9kdWxlIHdhcyBhbHJlYWR5IGltcG9ydGVkLiBJZgogICAgc28sIHRoZW4gc3lzLm1vZHVsZXNbbmFtZV0uX19sb2FkZXJfXyBpcyByZXR1cm5lZC4gSWYgdGhhdCBoYXBwZW5zIHRvIGJlCiAgICBzZXQgdG8gTm9uZSwgdGhlbiBWYWx1ZUVycm9yIGlzIHJhaXNlZC4gSWYgdGhlIG1vZHVsZSBpcyBub3QgaW4KICAgIHN5cy5tb2R1bGVzLCB0aGVuIHN5cy5tZXRhX3BhdGggaXMgc2VhcmNoZWQgZm9yIGEgc3VpdGFibGUgbG9hZGVyIHdpdGggdGhlCiAgICB2YWx1ZSBvZiAncGF0aCcgZ2l2ZW4gdG8gdGhlIGZpbmRlcnMuIE5vbmUgaXMgcmV0dXJuZWQgaWYgbm8gbG9hZGVyIGNvdWxkCiAgICBiZSBmb3VuZC4KCiAgICBEb3R0ZWQgbmFtZXMgZG8gbm90IGhhdmUgdGhlaXIgcGFyZW50IHBhY2thZ2VzIGltcGxpY2l0bHkgaW1wb3J0ZWQuCgogICAgIiIiCiAgICB0cnk6CiAgICAgICAgbG9hZGVyID0gc3lzLm1vZHVsZXNbbmFtZV0uX19sb2FkZXJfXwogICAgICAgIGlmIGxvYWRlciBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCd7fS5fX2xvYWRlcl9fIGlzIE5vbmUnLmZvcm1hdChuYW1lKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gbG9hZGVyCiAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgcGFzcwogICAgcmV0dXJuIF9ib290c3RyYXAuX2ZpbmRfbW9kdWxlKG5hbWUsIHBhdGgpCgoKZGVmIGltcG9ydF9tb2R1bGUobmFtZSwgcGFja2FnZT1Ob25lKToKICAgICIiIkltcG9ydCBhIG1vZHVsZS4KCiAgICBUaGUgJ3BhY2thZ2UnIGFyZ3VtZW50IGlzIHJlcXVpcmVkIHdoZW4gcGVyZm9ybWluZyBhIHJlbGF0aXZlIGltcG9ydC4gSXQKICAgIHNwZWNpZmllcyB0aGUgcGFja2FnZSB0byB1c2UgYXMgdGhlIGFuY2hvciBwb2ludCBmcm9tIHdoaWNoIHRvIHJlc29sdmUgdGhlCiAgICByZWxhdGl2ZSBpbXBvcnQgdG8gYW4gYWJzb2x1dGUgaW1wb3J0LgoKICAgICIiIgogICAgbGV2ZWwgPSAwCiAgICBpZiBuYW1lLnN0YXJ0c3dpdGgoJy4nKToKICAgICAgICBpZiBub3QgcGFja2FnZToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJyZWxhdGl2ZSBpbXBvcnRzIHJlcXVpcmUgdGhlICdwYWNrYWdlJyBhcmd1bWVudCIpCiAgICAgICAgZm9yIGNoYXJhY3RlciBpbiBuYW1lOgogICAgICAgICAgICBpZiBjaGFyYWN0ZXIgIT0gJy4nOgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgbGV2ZWwgKz0gMQogICAgcmV0dXJuIF9ib290c3RyYXAuX2djZF9pbXBvcnQobmFtZVtsZXZlbDpdLCBwYWNrYWdlLCBsZXZlbCkK',
'/Lib/ui/dialog.py':'aW1wb3J0IHdpZGdldApmcm9tIGJyb3dzZXIgaW1wb3J0IGh0bWwsIGRvYwoKY2xhc3MgRGlhbG9nKHdpZGdldC5EcmFnZ2FibGVXaWRnZXQpOgogIGRlZiBfX2luaXRfXyhzZWxmLCBpZD1Ob25lKToKICAgICAgc2VsZi5fZGl2X3NoZWxsPWh0bWwuRElWKAogICAgICAgICBDbGFzcz0idWktZGlhbG9nIHVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCB1aS1jb3JuZXItYWxsIHVpLWZyb250IHVpLWRyYWdnYWJsZSB1aS1yZXNpemFibGUiLAogICAgICAgICBzdHlsZT17J3Bvc2l0aW9uJzogJ2Fic29sdXRlJywgJ2hlaWdodCc6ICdhdXRvJywgJ3dpZHRoJzogJzMwMHB4JywKICAgICAgICAgICAgICAgICd0b3AnOiAnOThweCcsICdsZWZ0JzogJzE0MHB4JywgJ2Rpc3BsYXknOiAnYmxvY2snfSkKCiAgICAgIHdpZGdldC5EcmFnZ2FibGVXaWRnZXQuX19pbml0X18oc2VsZiwgc2VsZi5fZGl2X3NoZWxsLCAnZGlhbG9nJywgaWQpCgogICAgICBfZGl2X3RpdGxlYmFyPWh0bWwuRElWKElkPSJ0aXRsZWJhciIsCiAgICAgICAgICAgQ2xhc3M9InVpLWRpYWxvZy10aXRsZWJhciB1aS13aWRnZXQtaGVhZGVyIHVpLWNvcm5lci1hbGwgdWktaGVscGVyLWNsZWFyZml4IikKICAgICAgc2VsZi5fZGl2X3NoZWxsIDw9IF9kaXZfdGl0bGViYXIKCiAgICAgIHNlbGYuX2Rpdl90aXRsZT1odG1sLlNQQU4oSWQ9InRpdGxlIiwgQ2xhc3M9InVpLWRpYWxvZy10aXRsZSIpCiAgICAgICAgCiAgICAgIF9kaXZfdGl0bGViYXIgPD0gc2VsZi5fZGl2X3RpdGxlCgogICAgICBzZWxmLl90aXRsZV9idXR0b249aHRtbC5CVVRUT04oVGl0bGU9ImNsb3NlIiwKICAgICAgICAgICAgQ2xhc3M9InVpLWJ1dHRvbiB1aS13aWRnZXQgdWktc3RhdGUtZGVmYXVsdCB1aS1jb3JuZXItYWxsIHVpLWJ1dHRvbi1pY29uLW9ubHkgdWktZGlhbG9nLXRpdGxlYmFyLWNsb3NlIikKCiAgICAgIGRlZiBkaWFsb2dfY2xvc2UoZSk6CiAgICAgICAgICAjZGVsIGRvY3VtZW50W3NlbGYuX2Rpdl9zaGVsbC5pZF0KICAgICAgICAgIGRlbCBkb2Nbc2VsZi5fZGl2X3NoZWxsLmlkXQoKICAgICAgc2VsZi5fdGl0bGVfYnV0dG9uLmJpbmQoJ2NsaWNrJywgZGlhbG9nX2Nsb3NlKQogICAgICBfc3Bhbj1odG1sLlNQQU4oQ2xhc3M9InVpLWJ1dHRvbi1pY29uLXByaW1hcnkgdWktaWNvbiB1aS1pY29uLWNsb3NldGhpY2siKQogICAgICBzZWxmLl90aXRsZV9idXR0b24gPD0gX3NwYW4KCiAgICAgIF9zcGFuPWh0bWwuU1BBTignY2xvc2UnLCBDbGFzcz0idWktYnV0dG9uLXRleHQiKQogICAgICBzZWxmLl90aXRsZV9idXR0b24gPD0gX3NwYW4KCiAgICAgIF9kaXZfdGl0bGViYXIgPD0gc2VsZi5fdGl0bGVfYnV0dG9uCgogICAgICBzZWxmLl9kaXZfZGlhbG9nPWh0bWwuRElWKENsYXNzPSJ1aS1kaWFsb2ctY29udGVudCB1aS13aWRnZXQtY29udGVudCIsCiAgICAgICAgICAgc3R5bGU9eyd3aWR0aCc6ICdhdXRvJywgJ21pbi1oZWlnaHQnOiAnMTA1cHgnLCAKICAgICAgICAgICAgICAgICAgJ21heC1oZWlnaHQnOiAnbm9uZScsICdoZWlnaHQnOiAnYXV0byd9KQoKICAgICAgc2VsZi5fZGl2X3NoZWxsIDw9IHNlbGYuX2Rpdl9kaWFsb2cKCiAgICAgIGZvciBfaSBpbiBbJ24nLCAnZScsICdzJywgJ3cnLCAnc2UnLCAnc3cnLCAnbmUnLCAnbncnXToKICAgICAgICAgIGlmIF9pID09ICdzZSc6CiAgICAgICAgICAgICBfY2xhc3M9InVpLXJlc2l6YWJsZS1oYW5kbGUgdWktcmVzaXphYmxlLSVzIHVpLWljb24gdWktaWNvbi1ncmlwc21hbGwtZGlhZ29uYWwtJXMiICUgKF9pLCBfaSkKICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICBfY2xhc3M9InVpLXJlc2l6YWJsZS1oYW5kbGUgdWktcmVzaXphYmxlLSVzIiAlIF9pCgogICAgICAgICAgc2VsZi5fZGl2X3NoZWxsIDw9IGh0bWwuRElWKENsYXNzPV9jbGFzcywgc3R5bGU9eyd6LWluZGV4JzogJzkwJ30pCgogICAgICBkb2MgPD0gc2VsZi5fZGl2X3NoZWxsCgogIGRlZiBzZXRfdGl0bGUoc2VsZiwgdGl0bGUpOgogICAgICBzZWxmLl9kaXZfdGl0bGUuc2V0X3RleHQodGl0bGUpCgogIGRlZiBzZXRfYm9keShzZWxmLCBib2R5KToKICAgICAgc2VsZi5fZGl2X2RpYWxvZy5zZXRfaHRtbChib2R5KQo=',
'/Lib/ui/progressbar.py':'aW1wb3J0IHdpZGdldApmcm9tIGJyb3dzZXIgaW1wb3J0IGh0bWwKCmNsYXNzIFByb2dyZXNzQmFyKHdpZGdldC5XaWRnZXQpOgogIGRlZiBfX2luaXRfXyhzZWxmLCBpZD1Ob25lLCBsYWJlbD1GYWxzZSk6CiAgICAgIHNlbGYuX2Rpdl9zaGVsbD1odG1sLkRJVihDbGFzcz0idWktcHJvZ3Jlc3NiYXIgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGwiKQogICAgICB3aWRnZXQuV2lkZ2V0Ll9faW5pdF9fKHNlbGYsIHNlbGYuX2Rpdl9zaGVsbCwgJ3Byb2dyZXNzYmFyJywgaWQpCgogICAgICBzZWxmLl9zaG93X2xhYmVsPWxhYmVsCiAgICAgIGlmIGxhYmVsOgogICAgICAgICBzZWxmLl9sYWJlbD1odG1sLkRJVihDbGFzcz0ncHJvZ3Jlc3MtbGFiZWwnKQogICAgICAgICBzZWxmLl9kaXZfc2hlbGwgPD0gc2VsZi5fbGFiZWwKCiAgICAgIHNlbGYuX2Jhcj1odG1sLkRJVihDbGFzcz0idWktcHJvZ3Jlc3NiYXItdmFsdWUgdWktd2lkZ2V0LWhlYWRlciB1aS1jb3JuZXItbGVmdCIsCiAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17J3dpZHRoJzogJzBweCd9KQogICAgICBzZWxmLl9kaXZfc2hlbGwgPD0gc2VsZi5fYmFyCgogIGRlZiBzZXRfcHJvZ3Jlc3Moc2VsZiwgcGVyY2VudCk6CiAgICAgIHNlbGYuX2Jhci5zdHlsZS53aWR0aD0nJXMlJScgJSBwZXJjZW50CiAgICAgIGlmIHNlbGYuX3Nob3dfbGFiZWw6CiAgICAgICAgIHNlbGYuX2xhYmVsLnRleHQ9JyVzJSUnICUgcGVyY2VudAo=',
'/Lib/ui/slider.py':'aW1wb3J0IHdpZGdldApmcm9tIGJyb3dzZXIgaW1wb3J0IGRvYyxodG1sCgpjbGFzcyBTbGlkZXIod2lkZ2V0LldpZGdldCk6CgogIGRlZiBfX2luaXRfXyhzZWxmLCBpZD1Ob25lLCBsYWJlbD1GYWxzZSk6CgogICAgICBzZWxmLl9kaXZfc2hlbGw9aHRtbC5ESVYoQ2xhc3M9InVpLXNsaWRlciB1aS1zbGlkZXItaG9yaXpvbnRhbCB1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQgdWktY29ybmVyLWFsbCIpCgogICAgICB3aWRnZXQuV2lkZ2V0Ll9faW5pdF9fKHNlbGYsIHNlbGYuX2Rpdl9zaGVsbCwgJ3NsaWRlcicsIGlkKQoKICAgICAgc2VsZi5faGFuZGxlPWh0bWwuQShDbGFzcz0idWktc2xpZGVyLWhhbmRsZSB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1hbGwiLAogICAgICAgICAgICAgICAgICAgICAgICAgIEhyZWY9JyMnLCBzdHlsZT17J2xlZnQnOiAnMHB4J30pCiAgICAgIHNlbGYuX3ZhbHVlPTAKICAgICAgc2VsZi5faXNNb3VzZURvd249RmFsc2UKCiAgICAgIGRlZiBzdGFydFNsaWRlKGUpOgogICAgICAgICAgc2VsZi5faXNNb3VzZURvd249VHJ1ZQogICAgICAgICAgc2VsZi5fdXBwZXJCb3VuZCA9IHNlbGYuX2Rpdl9zaGVsbC5vZmZzZXRXaWR0aCAtIHNlbGYuX2hhbmRsZS5vZmZzZXRXaWR0aAoKICAgICAgICAgIHBvcyA9IHdpZGdldC5nZXRNb3VzZVBvc2l0aW9uKGUpCiAgICAgICAgICBzZWxmLl9zdGFydE1vdXNlWD1wb3NbJ3gnXQoKICAgICAgICAgIHNlbGYuX2xhc3RFbGVtZW50TGVmdCA9IHBhcnNlSW50KHNlbGYuX2hhbmRsZS5zdHlsZS5sZWZ0KQogICAgICAgICAgdXBkYXRlUG9zaXRpb24oZSkKCiAgICAgIGRlZiB1cGRhdGVQb3NpdGlvbihlKToKICAgICAgICAgIHBvcyA9IHdpZGdldC5nZXRNb3VzZVBvc2l0aW9uKGUpCiAgICAgICAgICAjcHJpbnQoJ21vc2UgcG9zJyxwb3MpCiAgICAgICAgICBfbmV3UG9zID0gc2VsZi5fbGFzdEVsZW1lbnRMZWZ0ICsgcG9zWyd4J10gLSBzZWxmLl9zdGFydE1vdXNlWAogICAgICAgICAgCiAgICAgICAgICBfbmV3UG9zID0gbWF4KDAsIF9uZXdQb3MpCiAgICAgICAgICBfbmV3UG9zID0gbWluKF9uZXdQb3MsIHNlbGYuX3VwcGVyQm91bmQpCgogICAgICAgICAgc2VsZi5faGFuZGxlLnN0eWxlLmxlZnQgPSAnJXNweCcgJSBfbmV3UG9zCiAgICAgICAgICAjcHJpbnQoJ25ldyBwb3NpdGlvbicsc2VsZi5faGFuZGxlLnN0eWxlLmxlZnQpCiAgICAgICAgICBzZWxmLl9sYXN0RWxlbWVudExlZnQgPSBfbmV3UG9zCgogICAgICBkZWYgbW92aW5nKGUpOgogICAgICAgICAgaWYgc2VsZi5faXNNb3VzZURvd246CiAgICAgICAgICAgICB1cGRhdGVQb3NpdGlvbihlKQoKICAgICAgZGVmIGRyb3BDYWxsYmFjayhlKToKICAgICAgICAgIHNlbGYuX2lzTW91c2VEb3duPUZhbHNlCiAgICAgICAgICBzZWxmLl9oYW5kbGUudW5iaW5kKCdtb3VzZW1vdmUnLCBtb3ZpbmcpCgoKICAgICAgc2VsZi5faGFuZGxlLmJpbmQoJ21vdXNlbW92ZScsIG1vdmluZykKICAgICAgc2VsZi5faGFuZGxlLmJpbmQoJ21vdXNldXAnLCBkcm9wQ2FsbGJhY2spCiAgICAgICNzZWxmLl9oYW5kbGUuYmluZCgnbW91c2VvdXQnLCBkcm9wQ2FsbGJhY2spCiAgICAgIHNlbGYuX2hhbmRsZS5iaW5kKCdtb3VzZWRvd24nLCBzdGFydFNsaWRlKQoKICAgICAgZGVmIG1vdXNlb3ZlcihlKToKICAgICAgICAgIF9jbGFzcz1zZWxmLl9oYW5kbGUuZ2V0QXR0cmlidXRlKCdjbGFzcycpCiAgICAgICAgICBzZWxmLl9oYW5kbGUuc2V0QXR0cmlidXRlKCdjbGFzcycsICclcyAlcycgJSAoX2NsYXNzLCAndWktc3RhdGUtaG92ZXInKSkKCiAgICAgIGRlZiBtb3VzZW91dChlKToKICAgICAgICAgIHNlbGYuX2lzTW91c2VEb3duPUZhbHNlCiAgICAgICAgICBfY2xhc3M9c2VsZi5faGFuZGxlLmdldEF0dHJpYnV0ZSgnY2xhc3MnKQogICAgICAgICAgc2VsZi5faGFuZGxlLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCBfY2xhc3MucmVwbGFjZSgndWktc3RhdGUtaG92ZXInLCAnJykpCgogICAgICBzZWxmLl9oYW5kbGUuYmluZCgnbW91c2VvdmVyJywgbW91c2VvdmVyKQogICAgICBzZWxmLl9oYW5kbGUuYmluZCgnbW91c2VvdXQnLCBtb3VzZW91dCkKCiAgICAgIHNlbGYuX2Rpdl9zaGVsbCA8PSBzZWxmLl9oYW5kbGUKCiAgZGVmIGdldF92YWx1ZShzZWxmKToKICAgICAgcmV0dXJuIHNlbGYuX3ZhbHVlCgogICNkZWYgc2V0X3ZhbHVlKHNlbGYsIHZhbHVlKToKICAjICAgIHNlbGYuX3ZhbHVlPXZhbHVlCiAgIyAgIHNlbGYuX2hhbmRsZS5zdHlsZS5sZWZ0PSclc3B4JyAlIHZhbHVlCg==',
'/Lib/ui/widget.py':'aW1wb3J0IHJhbmRvbQpmcm9tIGJyb3dzZXIgaW1wb3J0IGRvYwoKZGVmIGdldE1vdXNlUG9zaXRpb24oZSk6CiAgICBpZiBlIGlzIE5vbmU6CiAgICAgICBlPXdpbi5ldmVudAoKICAgIGlmIGUucGFnZVggb3IgZS5wYWdlWToKICAgICAgIHJldHVybiB7J3gnOiBlLnBhZ2VYLCAneSc6IGUucGFnZVl9CgogICAgaWYgZS5jbGllbnRYIG9yIGUuY2xpZW50WToKICAgICAgIF9wb3N4PWUuY2xpZW50WCArIGRvYy5ib2R5LnNjcm9sbExlZnQgKyBkb2MuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQ7CiAgICAgICBfcG9zeT1lLmNsaWVudFkgKyBkb2MuYm9keS5zY3JvbGxUb3AgKyBkb2MuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDsKICAgICAgIHJldHVybiB7J3gnOiBfcG9zeCwgJ3knOiBfcG9zeX0KICAgICAgCiAgICByZXR1cm4geyd4JzogMCwgJ3knOiAwfQoKY2xhc3MgV2lkZ2V0OgogIGRlZiBfX2luaXRfXyhzZWxmLCBlbGVtZW50LCB0eXBlLCBpZD1Ob25lKToKICAgICAgc2VsZi5fZWxlbWVudD1lbGVtZW50CgogICAgICBpZiBpZCBpcyBOb25lOgogICAgICAgICBzZWxmLl9lbGVtZW50LmlkPSclc18lcycgJSAodHlwZSwgaW50KDEwMDAwMCpyYW5kb20ucmFuZG9tKCkpKQogICAgICBlbHNlOgogICAgICAgICBzZWxmLl9lbGVtZW50LmlkPWlkCgogIGRlZiBnZXRfaWQoc2VsZik6CiAgICAgIHJldHVybiBzZWxmLl9lbGVtZW50LmlkCgogIGRlZiBhdHRhY2goc2VsZiwgZWxlbWVudF9pZCk6CiAgICAgICIiIiBhcHBlbmQgdGhpcyBET00gY29tcG9uZW50IHRvIERPTSBlbGVtZW50IGVsZW1lbnRfaWQiIiIKICAgICAgI2RvY3VtZW50W2VsZW1lbnRfaWRdIDw9IHNlbGYuX2VsZW1lbnQgICAjdGhpcyBkb2Vzbid0IHdvcmsgOigKICAgICAgI2RvYyBpcyBhY3R1YWxseSB0aGUgZ2xvYmFsICdkb2MnIG5vdCB0aGUgb25lIHdlIGltcG9ydGVkIGZyb20gYnJvd3NlciA6KAogICAgICBkb2NbZWxlbWVudF9pZF0gPD0gc2VsZi5fZWxlbWVudAoKICBkZWYgc2hvdyhzZWxmKToKICAgICAgc2VsZi5fZWxlbWVudC5kaXNwbGF5PSdibG9jaycKCiAgZGVmIGhpZGUoc2VsZik6CiAgICAgIHNlbGYuX2VsZW1lbnQuZGlzcGxheT0nbm9uZScKCmNsYXNzIERyYWdnYWJsZVdpZGdldChXaWRnZXQpOgogIGRlZiBfX2luaXRfXyhzZWxmLCBlbGVtZW50LCB0eXBlLCBpZD1Ob25lKToKICAgICAgV2lkZ2V0Ll9faW5pdF9fKHNlbGYsIGVsZW1lbnQsIHR5cGUsIGlkKQoKICAgICAgZGVmIGRyYWcoZSk6CiAgICAgICAgICBzZWxmLl9lbGVtZW50LnN0eWxlLnRvcD0nJXNweCcgJSAoZS5jbGllbnRZIC0gc2VsZi5fZGVsdGFZKQogICAgICAgICAgc2VsZi5fZWxlbWVudC5zdHlsZS5sZWZ0PSclc3B4JyAlIChlLmNsaWVudFggLSBzZWxmLl9kZWx0YVgpCgogICAgICBkZWYgbW91c2VEb3duKGUpOgogICAgICAgICAgc2VsZi5fZWxlbWVudC5zdHlsZS5wb3NpdGlvbj0nYWJzb2x1dGUnCiAgICAgICAgICBzZWxmLl9kZWx0YVg9ZS5jbGllbnRYIC0gc2VsZi5fZWxlbWVudC5vZmZzZXRMZWZ0CiAgICAgICAgICBzZWxmLl9kZWx0YVk9ZS5jbGllbnRZIC0gc2VsZi5fZWxlbWVudC5vZmZzZXRUb3AKICAgICAgICAgIGRvYy5iaW5kKCdtb3VzZW1vdmUnLCBkcmFnKQoKICAgICAgZGVmIG1vdXNlVXAoZSk6CiAgICAgICAgICBkb2MudW5iaW5kKCdtb3VzZW1vdmUnKQoKICAgICAgc2VsZi5fZWxlbWVudC5iaW5kKCdtb3VzZWRvd24nLCBtb3VzZURvd24pCiAgICAgIHNlbGYuX2VsZW1lbnQuYmluZCgnbW91c2V1cCcsIG1vdXNlVXApCg==',
'/Lib/ui/__init__.py':'ZnJvbSBicm93c2VyIGltcG9ydCBodG1sLCBkb2MgYXMgZG9jdW1lbnQKZnJvbSBkaWFsb2cgaW1wb3J0ICoKZnJvbSBwcm9ncmVzc2JhciBpbXBvcnQgKgpmcm9tIHNsaWRlciBpbXBvcnQgKgoKZGVmIGFkZF9zdHlsZXNoZWV0KCk6CiAgICBfbGluaz1odG1sLkxJTksoSHJlZj0nL3NyYy9MaWIvdWkvY3NzL3Ntb290aG5lc3MvanF1ZXJ5LXVpLTEuMTAuMy5jdXN0b20ubWluLmNzcycpCiAgICBfbGluay5yZWw9J3N0eWxlc2hlZXQnCgogICAgZG9jIDw9IF9saW5rICAgICAjIGRvY3VtZW50IGRvZXNuJ3Qgd29yayBoZXJlLi4gOiggbXVzdCB1c2UgZG9jIAo=',
'/Lib/unittest/case.py':'IiIiVGVzdCBjYXNlIGltcGxlbWVudGF0aW9uIiIiCgppbXBvcnQgc3lzCmltcG9ydCBmdW5jdG9vbHMKaW1wb3J0IGRpZmZsaWIKaW1wb3J0IHBwcmludAppbXBvcnQgcmUKaW1wb3J0IHdhcm5pbmdzCmltcG9ydCBjb2xsZWN0aW9ucwoKZnJvbSAuIGltcG9ydCByZXN1bHQKZnJvbSAudXRpbCBpbXBvcnQgKHN0cmNsYXNzLCBzYWZlX3JlcHIsIF9jb3VudF9kaWZmX2FsbF9wdXJwb3NlLAogICAgICAgICAgICAgICAgICAgX2NvdW50X2RpZmZfaGFzaGFibGUpCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKCkRJRkZfT01JVFRFRCA9ICgnXG5EaWZmIGlzICVzIGNoYXJhY3RlcnMgbG9uZy4gJwogICAgICAgICAgICAgICAgICdTZXQgc2VsZi5tYXhEaWZmIHRvIE5vbmUgdG8gc2VlIGl0LicpCgpjbGFzcyBTa2lwVGVzdChFeGNlcHRpb24pOgogICAgIiIiCiAgICBSYWlzZSB0aGlzIGV4Y2VwdGlvbiBpbiBhIHRlc3QgdG8gc2tpcCBpdC4KCiAgICBVc3VhbGx5IHlvdSBjYW4gdXNlIFRlc3RSZXN1bHQuc2tpcCgpIG9yIG9uZSBvZiB0aGUgc2tpcHBpbmcgZGVjb3JhdG9ycwogICAgaW5zdGVhZCBvZiByYWlzaW5nIHRoaXMgZGlyZWN0bHkuCiAgICAiIiIKCmNsYXNzIF9FeHBlY3RlZEZhaWx1cmUoRXhjZXB0aW9uKToKICAgICIiIgogICAgUmFpc2UgdGhpcyB3aGVuIGEgdGVzdCBpcyBleHBlY3RlZCB0byBmYWlsLgoKICAgIFRoaXMgaXMgYW4gaW1wbGVtZW50YXRpb24gZGV0YWlsLgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGV4Y19pbmZvKToKICAgICAgICBzdXBlcihfRXhwZWN0ZWRGYWlsdXJlLCBzZWxmKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5leGNfaW5mbyA9IGV4Y19pbmZvCgpjbGFzcyBfVW5leHBlY3RlZFN1Y2Nlc3MoRXhjZXB0aW9uKToKICAgICIiIgogICAgVGhlIHRlc3Qgd2FzIHN1cHBvc2VkIHRvIGZhaWwsIGJ1dCBpdCBkaWRuJ3QhCiAgICAiIiIKCgpjbGFzcyBfT3V0Y29tZShvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuc3VjY2VzcyA9IFRydWUKICAgICAgICBzZWxmLnNraXBwZWQgPSBOb25lCiAgICAgICAgc2VsZi51bmV4cGVjdGVkU3VjY2VzcyA9IE5vbmUKICAgICAgICBzZWxmLmV4cGVjdGVkRmFpbHVyZSA9IE5vbmUKICAgICAgICBzZWxmLmVycm9ycyA9IFtdCiAgICAgICAgc2VsZi5mYWlsdXJlcyA9IFtdCgoKZGVmIF9pZChvYmopOgogICAgcmV0dXJuIG9iagoKZGVmIHNraXAocmVhc29uKToKICAgICIiIgogICAgVW5jb25kaXRpb25hbGx5IHNraXAgYSB0ZXN0LgogICAgIiIiCiAgICBkZWYgZGVjb3JhdG9yKHRlc3RfaXRlbSk6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UodGVzdF9pdGVtLCB0eXBlKToKICAgICAgICAgICAgQGZ1bmN0b29scy53cmFwcyh0ZXN0X2l0ZW0pCiAgICAgICAgICAgIGRlZiBza2lwX3dyYXBwZXIoKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAgICAgICAgIHJhaXNlIFNraXBUZXN0KHJlYXNvbikKICAgICAgICAgICAgdGVzdF9pdGVtID0gc2tpcF93cmFwcGVyCgogICAgICAgIHRlc3RfaXRlbS5fX3VuaXR0ZXN0X3NraXBfXyA9IFRydWUKICAgICAgICB0ZXN0X2l0ZW0uX191bml0dGVzdF9za2lwX3doeV9fID0gcmVhc29uCiAgICAgICAgcmV0dXJuIHRlc3RfaXRlbQogICAgcmV0dXJuIGRlY29yYXRvcgoKZGVmIHNraXBJZihjb25kaXRpb24sIHJlYXNvbik6CiAgICAiIiIKICAgIFNraXAgYSB0ZXN0IGlmIHRoZSBjb25kaXRpb24gaXMgdHJ1ZS4KICAgICIiIgogICAgaWYgY29uZGl0aW9uOgogICAgICAgIHJldHVybiBza2lwKHJlYXNvbikKICAgIHJldHVybiBfaWQKCmRlZiBza2lwVW5sZXNzKGNvbmRpdGlvbiwgcmVhc29uKToKICAgICIiIgogICAgU2tpcCBhIHRlc3QgdW5sZXNzIHRoZSBjb25kaXRpb24gaXMgdHJ1ZS4KICAgICIiIgogICAgaWYgbm90IGNvbmRpdGlvbjoKICAgICAgICByZXR1cm4gc2tpcChyZWFzb24pCiAgICByZXR1cm4gX2lkCgoKZGVmIGV4cGVjdGVkRmFpbHVyZShmdW5jKToKICAgIEBmdW5jdG9vbHMud3JhcHMoZnVuYykKICAgIGRlZiB3cmFwcGVyKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBmdW5jKCphcmdzLCAqKmt3YXJncykKICAgICAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgICAgICByYWlzZSBfRXhwZWN0ZWRGYWlsdXJlKHN5cy5leGNfaW5mbygpKQogICAgICAgIHJhaXNlIF9VbmV4cGVjdGVkU3VjY2VzcwogICAgcmV0dXJuIHdyYXBwZXIKCgpjbGFzcyBfQXNzZXJ0UmFpc2VzQmFzZUNvbnRleHQob2JqZWN0KToKCiAgICBkZWYgX19pbml0X18oc2VsZiwgZXhwZWN0ZWQsIHRlc3RfY2FzZSwgY2FsbGFibGVfb2JqPU5vbmUsCiAgICAgICAgICAgICAgICAgZXhwZWN0ZWRfcmVnZXg9Tm9uZSk6CiAgICAgICAgc2VsZi5leHBlY3RlZCA9IGV4cGVjdGVkCiAgICAgICAgc2VsZi50ZXN0X2Nhc2UgPSB0ZXN0X2Nhc2UKICAgICAgICBpZiBjYWxsYWJsZV9vYmogaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYub2JqX25hbWUgPSBjYWxsYWJsZV9vYmouX19uYW1lX18KICAgICAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICAgICAgc2VsZi5vYmpfbmFtZSA9IHN0cihjYWxsYWJsZV9vYmopCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5vYmpfbmFtZSA9IE5vbmUKICAgICAgICBpZiBpc2luc3RhbmNlKGV4cGVjdGVkX3JlZ2V4LCAoYnl0ZXMsIHN0cikpOgogICAgICAgICAgICBleHBlY3RlZF9yZWdleCA9IHJlLmNvbXBpbGUoZXhwZWN0ZWRfcmVnZXgpCiAgICAgICAgc2VsZi5leHBlY3RlZF9yZWdleCA9IGV4cGVjdGVkX3JlZ2V4CiAgICAgICAgc2VsZi5tc2cgPSBOb25lCgogICAgZGVmIF9yYWlzZUZhaWx1cmUoc2VsZiwgc3RhbmRhcmRNc2cpOgogICAgICAgIG1zZyA9IHNlbGYudGVzdF9jYXNlLl9mb3JtYXRNZXNzYWdlKHNlbGYubXNnLCBzdGFuZGFyZE1zZykKICAgICAgICByYWlzZSBzZWxmLnRlc3RfY2FzZS5mYWlsdXJlRXhjZXB0aW9uKG1zZykKCiAgICBkZWYgaGFuZGxlKHNlbGYsIG5hbWUsIGNhbGxhYmxlX29iaiwgYXJncywga3dhcmdzKToKICAgICAgICAiIiIKICAgICAgICBJZiBjYWxsYWJsZV9vYmogaXMgTm9uZSwgYXNzZXJ0UmFpc2VzL1dhcm5zIGlzIGJlaW5nIHVzZWQgYXMgYQogICAgICAgIGNvbnRleHQgbWFuYWdlciwgc28gY2hlY2sgZm9yIGEgJ21zZycga3dhcmcgYW5kIHJldHVybiBzZWxmLgogICAgICAgIElmIGNhbGxhYmxlX29iaiBpcyBub3QgTm9uZSwgY2FsbCBpdCBwYXNzaW5nIGFyZ3MgYW5kIGt3YXJncy4KICAgICAgICAiIiIKICAgICAgICBpZiBjYWxsYWJsZV9vYmogaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5tc2cgPSBrd2FyZ3MucG9wKCdtc2cnLCBOb25lKQogICAgICAgICAgICByZXR1cm4gc2VsZgogICAgICAgIHdpdGggc2VsZjoKICAgICAgICAgICAgY2FsbGFibGVfb2JqKCphcmdzLCAqKmt3YXJncykKCgoKY2xhc3MgX0Fzc2VydFJhaXNlc0NvbnRleHQoX0Fzc2VydFJhaXNlc0Jhc2VDb250ZXh0KToKICAgICIiIkEgY29udGV4dCBtYW5hZ2VyIHVzZWQgdG8gaW1wbGVtZW50IFRlc3RDYXNlLmFzc2VydFJhaXNlcyogbWV0aG9kcy4iIiIKCiAgICBkZWYgX19lbnRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fZXhpdF9fKHNlbGYsIGV4Y190eXBlLCBleGNfdmFsdWUsIHRiKToKICAgICAgICBpZiBleGNfdHlwZSBpcyBOb25lOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBleGNfbmFtZSA9IHNlbGYuZXhwZWN0ZWQuX19uYW1lX18KICAgICAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICAgICAgZXhjX25hbWUgPSBzdHIoc2VsZi5leHBlY3RlZCkKICAgICAgICAgICAgaWYgc2VsZi5vYmpfbmFtZToKICAgICAgICAgICAgICAgIHNlbGYuX3JhaXNlRmFpbHVyZSgie30gbm90IHJhaXNlZCBieSB7fSIuZm9ybWF0KGV4Y19uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5vYmpfbmFtZSkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLl9yYWlzZUZhaWx1cmUoInt9IG5vdCByYWlzZWQiLmZvcm1hdChleGNfbmFtZSkpCiAgICAgICAgaWYgbm90IGlzc3ViY2xhc3MoZXhjX3R5cGUsIHNlbGYuZXhwZWN0ZWQpOgogICAgICAgICAgICAjIGxldCB1bmV4cGVjdGVkIGV4Y2VwdGlvbnMgcGFzcyB0aHJvdWdoCiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgICMgc3RvcmUgZXhjZXB0aW9uLCB3aXRob3V0IHRyYWNlYmFjaywgZm9yIGxhdGVyIHJldHJpZXZhbAogICAgICAgIHNlbGYuZXhjZXB0aW9uID0gZXhjX3ZhbHVlLndpdGhfdHJhY2ViYWNrKE5vbmUpCiAgICAgICAgaWYgc2VsZi5leHBlY3RlZF9yZWdleCBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gVHJ1ZQoKICAgICAgICBleHBlY3RlZF9yZWdleCA9IHNlbGYuZXhwZWN0ZWRfcmVnZXgKICAgICAgICBpZiBub3QgZXhwZWN0ZWRfcmVnZXguc2VhcmNoKHN0cihleGNfdmFsdWUpKToKICAgICAgICAgICAgc2VsZi5fcmFpc2VGYWlsdXJlKCcie30iIGRvZXMgbm90IG1hdGNoICJ7fSInLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWRfcmVnZXgucGF0dGVybiwgc3RyKGV4Y192YWx1ZSkpKQogICAgICAgIHJldHVybiBUcnVlCgoKY2xhc3MgX0Fzc2VydFdhcm5zQ29udGV4dChfQXNzZXJ0UmFpc2VzQmFzZUNvbnRleHQpOgogICAgIiIiQSBjb250ZXh0IG1hbmFnZXIgdXNlZCB0byBpbXBsZW1lbnQgVGVzdENhc2UuYXNzZXJ0V2FybnMqIG1ldGhvZHMuIiIiCgogICAgZGVmIF9fZW50ZXJfXyhzZWxmKToKICAgICAgICAjIFRoZSBfX3dhcm5pbmdyZWdpc3RyeV9fJ3MgbmVlZCB0byBiZSBpbiBhIHByaXN0aW5lIHN0YXRlIGZvciB0ZXN0cwogICAgICAgICMgdG8gd29yayBwcm9wZXJseS4KICAgICAgICBmb3IgdiBpbiBzeXMubW9kdWxlcy52YWx1ZXMoKToKICAgICAgICAgICAgaWYgZ2V0YXR0cih2LCAnX193YXJuaW5ncmVnaXN0cnlfXycsIE5vbmUpOgogICAgICAgICAgICAgICAgdi5fX3dhcm5pbmdyZWdpc3RyeV9fID0ge30KICAgICAgICBzZWxmLndhcm5pbmdzX21hbmFnZXIgPSB3YXJuaW5ncy5jYXRjaF93YXJuaW5ncyhyZWNvcmQ9VHJ1ZSkKICAgICAgICBzZWxmLndhcm5pbmdzID0gc2VsZi53YXJuaW5nc19tYW5hZ2VyLl9fZW50ZXJfXygpCiAgICAgICAgd2FybmluZ3Muc2ltcGxlZmlsdGVyKCJhbHdheXMiLCBzZWxmLmV4cGVjdGVkKQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIF9fZXhpdF9fKHNlbGYsIGV4Y190eXBlLCBleGNfdmFsdWUsIHRiKToKICAgICAgICBzZWxmLndhcm5pbmdzX21hbmFnZXIuX19leGl0X18oZXhjX3R5cGUsIGV4Y192YWx1ZSwgdGIpCiAgICAgICAgaWYgZXhjX3R5cGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICMgbGV0IHVuZXhwZWN0ZWQgZXhjZXB0aW9ucyBwYXNzIHRocm91Z2gKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgdHJ5OgogICAgICAgICAgICBleGNfbmFtZSA9IHNlbGYuZXhwZWN0ZWQuX19uYW1lX18KICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIGV4Y19uYW1lID0gc3RyKHNlbGYuZXhwZWN0ZWQpCiAgICAgICAgZmlyc3RfbWF0Y2hpbmcgPSBOb25lCiAgICAgICAgZm9yIG0gaW4gc2VsZi53YXJuaW5nczoKICAgICAgICAgICAgdyA9IG0ubWVzc2FnZQogICAgICAgICAgICBpZiBub3QgaXNpbnN0YW5jZSh3LCBzZWxmLmV4cGVjdGVkKToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGlmIGZpcnN0X21hdGNoaW5nIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBmaXJzdF9tYXRjaGluZyA9IHcKICAgICAgICAgICAgaWYgKHNlbGYuZXhwZWN0ZWRfcmVnZXggaXMgbm90IE5vbmUgYW5kCiAgICAgICAgICAgICAgICBub3Qgc2VsZi5leHBlY3RlZF9yZWdleC5zZWFyY2goc3RyKHcpKSk6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAjIHN0b3JlIHdhcm5pbmcgZm9yIGxhdGVyIHJldHJpZXZhbAogICAgICAgICAgICBzZWxmLndhcm5pbmcgPSB3CiAgICAgICAgICAgIHNlbGYuZmlsZW5hbWUgPSBtLmZpbGVuYW1lCiAgICAgICAgICAgIHNlbGYubGluZW5vID0gbS5saW5lbm8KICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgIyBOb3cgd2Ugc2ltcGx5IHRyeSB0byBjaG9vc2UgYSBoZWxwZnVsIGZhaWx1cmUgbWVzc2FnZQogICAgICAgIGlmIGZpcnN0X21hdGNoaW5nIGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLl9yYWlzZUZhaWx1cmUoJyJ7fSIgZG9lcyBub3QgbWF0Y2ggInt9IicuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgICBzZWxmLmV4cGVjdGVkX3JlZ2V4LnBhdHRlcm4sIHN0cihmaXJzdF9tYXRjaGluZykpKQogICAgICAgIGlmIHNlbGYub2JqX25hbWU6CiAgICAgICAgICAgIHNlbGYuX3JhaXNlRmFpbHVyZSgie30gbm90IHRyaWdnZXJlZCBieSB7fSIuZm9ybWF0KGV4Y19uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm9ial9uYW1lKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl9yYWlzZUZhaWx1cmUoInt9IG5vdCB0cmlnZ2VyZWQiLmZvcm1hdChleGNfbmFtZSkpCgoKY2xhc3MgVGVzdENhc2Uob2JqZWN0KToKICAgICIiIkEgY2xhc3Mgd2hvc2UgaW5zdGFuY2VzIGFyZSBzaW5nbGUgdGVzdCBjYXNlcy4KCiAgICBCeSBkZWZhdWx0LCB0aGUgdGVzdCBjb2RlIGl0c2VsZiBzaG91bGQgYmUgcGxhY2VkIGluIGEgbWV0aG9kIG5hbWVkCiAgICAncnVuVGVzdCcuCgogICAgSWYgdGhlIGZpeHR1cmUgbWF5IGJlIHVzZWQgZm9yIG1hbnkgdGVzdCBjYXNlcywgY3JlYXRlIGFzCiAgICBtYW55IHRlc3QgbWV0aG9kcyBhcyBhcmUgbmVlZGVkLiBXaGVuIGluc3RhbnRpYXRpbmcgc3VjaCBhIFRlc3RDYXNlCiAgICBzdWJjbGFzcywgc3BlY2lmeSBpbiB0aGUgY29uc3RydWN0b3IgYXJndW1lbnRzIHRoZSBuYW1lIG9mIHRoZSB0ZXN0IG1ldGhvZAogICAgdGhhdCB0aGUgaW5zdGFuY2UgaXMgdG8gZXhlY3V0ZS4KCiAgICBUZXN0IGF1dGhvcnMgc2hvdWxkIHN1YmNsYXNzIFRlc3RDYXNlIGZvciB0aGVpciBvd24gdGVzdHMuIENvbnN0cnVjdGlvbgogICAgYW5kIGRlY29uc3RydWN0aW9uIG9mIHRoZSB0ZXN0J3MgZW52aXJvbm1lbnQgKCdmaXh0dXJlJykgY2FuIGJlCiAgICBpbXBsZW1lbnRlZCBieSBvdmVycmlkaW5nIHRoZSAnc2V0VXAnIGFuZCAndGVhckRvd24nIG1ldGhvZHMgcmVzcGVjdGl2ZWx5LgoKICAgIElmIGl0IGlzIG5lY2Vzc2FyeSB0byBvdmVycmlkZSB0aGUgX19pbml0X18gbWV0aG9kLCB0aGUgYmFzZSBjbGFzcwogICAgX19pbml0X18gbWV0aG9kIG11c3QgYWx3YXlzIGJlIGNhbGxlZC4gSXQgaXMgaW1wb3J0YW50IHRoYXQgc3ViY2xhc3NlcwogICAgc2hvdWxkIG5vdCBjaGFuZ2UgdGhlIHNpZ25hdHVyZSBvZiB0aGVpciBfX2luaXRfXyBtZXRob2QsIHNpbmNlIGluc3RhbmNlcwogICAgb2YgdGhlIGNsYXNzZXMgYXJlIGluc3RhbnRpYXRlZCBhdXRvbWF0aWNhbGx5IGJ5IHBhcnRzIG9mIHRoZSBmcmFtZXdvcmsKICAgIGluIG9yZGVyIHRvIGJlIHJ1bi4KICAgICIiIgoKICAgICMgVGhpcyBhdHRyaWJ1dGUgZGV0ZXJtaW5lcyB3aGljaCBleGNlcHRpb24gd2lsbCBiZSByYWlzZWQgd2hlbgogICAgIyB0aGUgaW5zdGFuY2UncyBhc3NlcnRpb24gbWV0aG9kcyBmYWlsOyB0ZXN0IG1ldGhvZHMgcmFpc2luZyB0aGlzCiAgICAjIGV4Y2VwdGlvbiB3aWxsIGJlIGRlZW1lZCB0byBoYXZlICdmYWlsZWQnIHJhdGhlciB0aGFuICdlcnJvcmVkJwoKICAgIGZhaWx1cmVFeGNlcHRpb24gPSBBc3NlcnRpb25FcnJvcgoKICAgICMgVGhpcyBhdHRyaWJ1dGUgZGV0ZXJtaW5lcyB3aGV0aGVyIGxvbmcgbWVzc2FnZXMgKGluY2x1ZGluZyByZXByIG9mCiAgICAjIG9iamVjdHMgdXNlZCBpbiBhc3NlcnQgbWV0aG9kcykgd2lsbCBiZSBwcmludGVkIG9uIGZhaWx1cmUgaW4gKmFkZGl0aW9uKgogICAgIyB0byBhbnkgZXhwbGljaXQgbWVzc2FnZSBwYXNzZWQuCgogICAgbG9uZ01lc3NhZ2UgPSBUcnVlCgogICAgIyBUaGlzIGF0dHJpYnV0ZSBzZXRzIHRoZSBtYXhpbXVtIGxlbmd0aCBvZiBhIGRpZmYgaW4gZmFpbHVyZSBtZXNzYWdlcwogICAgIyBieSBhc3NlcnQgbWV0aG9kcyB1c2luZyBkaWZmbGliLiBJdCBpcyBsb29rZWQgdXAgYXMgYW4gaW5zdGFuY2UgYXR0cmlidXRlCiAgICAjIHNvIGNhbiBiZSBjb25maWd1cmVkIGJ5IGluZGl2aWR1YWwgdGVzdHMgaWYgcmVxdWlyZWQuCgogICAgbWF4RGlmZiA9IDgwKjgKCiAgICAjIElmIGEgc3RyaW5nIGlzIGxvbmdlciB0aGFuIF9kaWZmVGhyZXNob2xkLCB1c2Ugbm9ybWFsIGNvbXBhcmlzb24gaW5zdGVhZAogICAgIyBvZiBkaWZmbGliLiAgU2VlICMxMTc2My4KICAgIF9kaWZmVGhyZXNob2xkID0gMioqMTYKCiAgICAjIEF0dHJpYnV0ZSB1c2VkIGJ5IFRlc3RTdWl0ZSBmb3IgY2xhc3NTZXRVcAoKICAgIF9jbGFzc1NldHVwRmFpbGVkID0gRmFsc2UKCiAgICBkZWYgX19pbml0X18oc2VsZiwgbWV0aG9kTmFtZT0ncnVuVGVzdCcpOgogICAgICAgICIiIkNyZWF0ZSBhbiBpbnN0YW5jZSBvZiB0aGUgY2xhc3MgdGhhdCB3aWxsIHVzZSB0aGUgbmFtZWQgdGVzdAogICAgICAgICAgIG1ldGhvZCB3aGVuIGV4ZWN1dGVkLiBSYWlzZXMgYSBWYWx1ZUVycm9yIGlmIHRoZSBpbnN0YW5jZSBkb2VzCiAgICAgICAgICAgbm90IGhhdmUgYSBtZXRob2Qgd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWUuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fdGVzdE1ldGhvZE5hbWUgPSBtZXRob2ROYW1lCiAgICAgICAgc2VsZi5fb3V0Y29tZUZvckRvQ2xlYW51cHMgPSBOb25lCiAgICAgICAgc2VsZi5fdGVzdE1ldGhvZERvYyA9ICdObyB0ZXN0JwogICAgICAgIHRyeToKICAgICAgICAgICAgdGVzdE1ldGhvZCA9IGdldGF0dHIoc2VsZiwgbWV0aG9kTmFtZSkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIGlmIG1ldGhvZE5hbWUgIT0gJ3J1blRlc3QnOgogICAgICAgICAgICAgICAgIyB3ZSBhbGxvdyBpbnN0YW50aWF0aW9uIHdpdGggbm8gZXhwbGljaXQgbWV0aG9kIG5hbWUKICAgICAgICAgICAgICAgICMgYnV0IG5vdCBhbiAqaW5jb3JyZWN0KiBvciBtaXNzaW5nIG1ldGhvZCBuYW1lCiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJubyBzdWNoIHRlc3QgbWV0aG9kIGluICVzOiAlcyIgJQogICAgICAgICAgICAgICAgICAgICAgKHNlbGYuX19jbGFzc19fLCBtZXRob2ROYW1lKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl90ZXN0TWV0aG9kRG9jID0gdGVzdE1ldGhvZC5fX2RvY19fCiAgICAgICAgc2VsZi5fY2xlYW51cHMgPSBbXQoKICAgICAgICAjIE1hcCB0eXBlcyB0byBjdXN0b20gYXNzZXJ0RXF1YWwgZnVuY3Rpb25zIHRoYXQgd2lsbCBjb21wYXJlCiAgICAgICAgIyBpbnN0YW5jZXMgb2Ygc2FpZCB0eXBlIGluIG1vcmUgZGV0YWlsIHRvIGdlbmVyYXRlIGEgbW9yZSB1c2VmdWwKICAgICAgICAjIGVycm9yIG1lc3NhZ2UuCiAgICAgICAgc2VsZi5fdHlwZV9lcXVhbGl0eV9mdW5jcyA9IHt9CiAgICAgICAgc2VsZi5hZGRUeXBlRXF1YWxpdHlGdW5jKGRpY3QsICdhc3NlcnREaWN0RXF1YWwnKQogICAgICAgIHNlbGYuYWRkVHlwZUVxdWFsaXR5RnVuYyhsaXN0LCAnYXNzZXJ0TGlzdEVxdWFsJykKICAgICAgICBzZWxmLmFkZFR5cGVFcXVhbGl0eUZ1bmModHVwbGUsICdhc3NlcnRUdXBsZUVxdWFsJykKICAgICAgICBzZWxmLmFkZFR5cGVFcXVhbGl0eUZ1bmMoc2V0LCAnYXNzZXJ0U2V0RXF1YWwnKQogICAgICAgIHNlbGYuYWRkVHlwZUVxdWFsaXR5RnVuYyhmcm96ZW5zZXQsICdhc3NlcnRTZXRFcXVhbCcpCiAgICAgICAgc2VsZi5hZGRUeXBlRXF1YWxpdHlGdW5jKHN0ciwgJ2Fzc2VydE11bHRpTGluZUVxdWFsJykKCiAgICBkZWYgYWRkVHlwZUVxdWFsaXR5RnVuYyhzZWxmLCB0eXBlb2JqLCBmdW5jdGlvbik6CiAgICAgICAgIiIiQWRkIGEgdHlwZSBzcGVjaWZpYyBhc3NlcnRFcXVhbCBzdHlsZSBmdW5jdGlvbiB0byBjb21wYXJlIGEgdHlwZS4KCiAgICAgICAgVGhpcyBtZXRob2QgaXMgZm9yIHVzZSBieSBUZXN0Q2FzZSBzdWJjbGFzc2VzIHRoYXQgbmVlZCB0byByZWdpc3RlcgogICAgICAgIHRoZWlyIG93biB0eXBlIGVxdWFsaXR5IGZ1bmN0aW9ucyB0byBwcm92aWRlIG5pY2VyIGVycm9yIG1lc3NhZ2VzLgoKICAgICAgICBBcmdzOgogICAgICAgICAgICB0eXBlb2JqOiBUaGUgZGF0YSB0eXBlIHRvIGNhbGwgdGhpcyBmdW5jdGlvbiBvbiB3aGVuIGJvdGggdmFsdWVzCiAgICAgICAgICAgICAgICAgICAgYXJlIG9mIHRoZSBzYW1lIHR5cGUgaW4gYXNzZXJ0RXF1YWwoKS4KICAgICAgICAgICAgZnVuY3Rpb246IFRoZSBjYWxsYWJsZSB0YWtpbmcgdHdvIGFyZ3VtZW50cyBhbmQgYW4gb3B0aW9uYWwKICAgICAgICAgICAgICAgICAgICBtc2c9IGFyZ3VtZW50IHRoYXQgcmFpc2VzIHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiB3aXRoIGEKICAgICAgICAgICAgICAgICAgICB1c2VmdWwgZXJyb3IgbWVzc2FnZSB3aGVuIHRoZSB0d28gYXJndW1lbnRzIGFyZSBub3QgZXF1YWwuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fdHlwZV9lcXVhbGl0eV9mdW5jc1t0eXBlb2JqXSA9IGZ1bmN0aW9uCgogICAgZGVmIGFkZENsZWFudXAoc2VsZiwgZnVuY3Rpb24sICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgIiIiQWRkIGEgZnVuY3Rpb24sIHdpdGggYXJndW1lbnRzLCB0byBiZSBjYWxsZWQgd2hlbiB0aGUgdGVzdCBpcwogICAgICAgIGNvbXBsZXRlZC4gRnVuY3Rpb25zIGFkZGVkIGFyZSBjYWxsZWQgb24gYSBMSUZPIGJhc2lzIGFuZCBhcmUKICAgICAgICBjYWxsZWQgYWZ0ZXIgdGVhckRvd24gb24gdGVzdCBmYWlsdXJlIG9yIHN1Y2Nlc3MuCgogICAgICAgIENsZWFudXAgaXRlbXMgYXJlIGNhbGxlZCBldmVuIGlmIHNldFVwIGZhaWxzICh1bmxpa2UgdGVhckRvd24pLiIiIgogICAgICAgIHNlbGYuX2NsZWFudXBzLmFwcGVuZCgoZnVuY3Rpb24sIGFyZ3MsIGt3YXJncykpCgogICAgZGVmIHNldFVwKHNlbGYpOgogICAgICAgICJIb29rIG1ldGhvZCBmb3Igc2V0dGluZyB1cCB0aGUgdGVzdCBmaXh0dXJlIGJlZm9yZSBleGVyY2lzaW5nIGl0LiIKICAgICAgICBwYXNzCgogICAgZGVmIHRlYXJEb3duKHNlbGYpOgogICAgICAgICJIb29rIG1ldGhvZCBmb3IgZGVjb25zdHJ1Y3RpbmcgdGhlIHRlc3QgZml4dHVyZSBhZnRlciB0ZXN0aW5nIGl0LiIKICAgICAgICBwYXNzCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgc2V0VXBDbGFzcyhjbHMpOgogICAgICAgICJIb29rIG1ldGhvZCBmb3Igc2V0dGluZyB1cCBjbGFzcyBmaXh0dXJlIGJlZm9yZSBydW5uaW5nIHRlc3RzIGluIHRoZSBjbGFzcy4iCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgdGVhckRvd25DbGFzcyhjbHMpOgogICAgICAgICJIb29rIG1ldGhvZCBmb3IgZGVjb25zdHJ1Y3RpbmcgdGhlIGNsYXNzIGZpeHR1cmUgYWZ0ZXIgcnVubmluZyBhbGwgdGVzdHMgaW4gdGhlIGNsYXNzLiIKCiAgICBkZWYgY291bnRUZXN0Q2FzZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIDEKCiAgICBkZWYgZGVmYXVsdFRlc3RSZXN1bHQoc2VsZik6CiAgICAgICAgcmV0dXJuIHJlc3VsdC5UZXN0UmVzdWx0KCkKCiAgICBkZWYgc2hvcnREZXNjcmlwdGlvbihzZWxmKToKICAgICAgICAiIiJSZXR1cm5zIGEgb25lLWxpbmUgZGVzY3JpcHRpb24gb2YgdGhlIHRlc3QsIG9yIE5vbmUgaWYgbm8KICAgICAgICBkZXNjcmlwdGlvbiBoYXMgYmVlbiBwcm92aWRlZC4KCiAgICAgICAgVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBtZXRob2QgcmV0dXJucyB0aGUgZmlyc3QgbGluZSBvZgogICAgICAgIHRoZSBzcGVjaWZpZWQgdGVzdCBtZXRob2QncyBkb2NzdHJpbmcuCiAgICAgICAgIiIiCiAgICAgICAgZG9jID0gc2VsZi5fdGVzdE1ldGhvZERvYwogICAgICAgIHJldHVybiBkb2MgYW5kIGRvYy5zcGxpdCgiXG4iKVswXS5zdHJpcCgpIG9yIE5vbmUKCgogICAgZGVmIGlkKHNlbGYpOgogICAgICAgIHJldHVybiAiJXMuJXMiICUgKHN0cmNsYXNzKHNlbGYuX19jbGFzc19fKSwgc2VsZi5fdGVzdE1ldGhvZE5hbWUpCgogICAgZGVmIF9fZXFfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgdHlwZShzZWxmKSBpcyBub3QgdHlwZShvdGhlcik6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAoKICAgICAgICByZXR1cm4gc2VsZi5fdGVzdE1ldGhvZE5hbWUgPT0gb3RoZXIuX3Rlc3RNZXRob2ROYW1lCgogICAgZGVmIF9faGFzaF9fKHNlbGYpOgogICAgICAgIHJldHVybiBoYXNoKCh0eXBlKHNlbGYpLCBzZWxmLl90ZXN0TWV0aG9kTmFtZSkpCgogICAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgICAgcmV0dXJuICIlcyAoJXMpIiAlIChzZWxmLl90ZXN0TWV0aG9kTmFtZSwgc3RyY2xhc3Moc2VsZi5fX2NsYXNzX18pKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gIjwlcyB0ZXN0TWV0aG9kPSVzPiIgJSBcCiAgICAgICAgICAgICAgIChzdHJjbGFzcyhzZWxmLl9fY2xhc3NfXyksIHNlbGYuX3Rlc3RNZXRob2ROYW1lKQoKICAgIGRlZiBfYWRkU2tpcChzZWxmLCByZXN1bHQsIHJlYXNvbik6CiAgICAgICAgYWRkU2tpcCA9IGdldGF0dHIocmVzdWx0LCAnYWRkU2tpcCcsIE5vbmUpCiAgICAgICAgaWYgYWRkU2tpcCBpcyBub3QgTm9uZToKICAgICAgICAgICAgYWRkU2tpcChzZWxmLCByZWFzb24pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgd2FybmluZ3Mud2FybigiVGVzdFJlc3VsdCBoYXMgbm8gYWRkU2tpcCBtZXRob2QsIHNraXBzIG5vdCByZXBvcnRlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgUnVudGltZVdhcm5pbmcsIDIpCiAgICAgICAgICAgIHJlc3VsdC5hZGRTdWNjZXNzKHNlbGYpCgogICAgZGVmIF9leGVjdXRlVGVzdFBhcnQoc2VsZiwgZnVuY3Rpb24sIG91dGNvbWUsIGlzVGVzdD1GYWxzZSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBmdW5jdGlvbigpCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdCBTa2lwVGVzdCBhcyBlOgogICAgICAgICAgICBvdXRjb21lLnN1Y2Nlc3MgPSBGYWxzZQogICAgICAgICAgICBvdXRjb21lLnNraXBwZWQgPSBzdHIoZSkKICAgICAgICBleGNlcHQgX1VuZXhwZWN0ZWRTdWNjZXNzOgogICAgICAgICAgICBleGNfaW5mbyA9IHN5cy5leGNfaW5mbygpCiAgICAgICAgICAgIG91dGNvbWUuc3VjY2VzcyA9IEZhbHNlCiAgICAgICAgICAgIGlmIGlzVGVzdDoKICAgICAgICAgICAgICAgIG91dGNvbWUudW5leHBlY3RlZFN1Y2Nlc3MgPSBleGNfaW5mbwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgb3V0Y29tZS5lcnJvcnMuYXBwZW5kKGV4Y19pbmZvKQogICAgICAgIGV4Y2VwdCBfRXhwZWN0ZWRGYWlsdXJlOgogICAgICAgICAgICBvdXRjb21lLnN1Y2Nlc3MgPSBGYWxzZQogICAgICAgICAgICBleGNfaW5mbyA9IHN5cy5leGNfaW5mbygpCiAgICAgICAgICAgIGlmIGlzVGVzdDoKICAgICAgICAgICAgICAgIG91dGNvbWUuZXhwZWN0ZWRGYWlsdXJlID0gZXhjX2luZm8KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG91dGNvbWUuZXJyb3JzLmFwcGVuZChleGNfaW5mbykKICAgICAgICBleGNlcHQgc2VsZi5mYWlsdXJlRXhjZXB0aW9uOgogICAgICAgICAgICBvdXRjb21lLnN1Y2Nlc3MgPSBGYWxzZQogICAgICAgICAgICBvdXRjb21lLmZhaWx1cmVzLmFwcGVuZChzeXMuZXhjX2luZm8oKSkKICAgICAgICAgICAgZXhjX2luZm8gPSBzeXMuZXhjX2luZm8oKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgb3V0Y29tZS5zdWNjZXNzID0gRmFsc2UKICAgICAgICAgICAgb3V0Y29tZS5lcnJvcnMuYXBwZW5kKHN5cy5leGNfaW5mbygpKQoKICAgIGRlZiBydW4oc2VsZiwgcmVzdWx0PU5vbmUpOgogICAgICAgIG9yaWdfcmVzdWx0ID0gcmVzdWx0CiAgICAgICAgaWYgcmVzdWx0IGlzIE5vbmU6CiAgICAgICAgICAgIHJlc3VsdCA9IHNlbGYuZGVmYXVsdFRlc3RSZXN1bHQoKQogICAgICAgICAgICBzdGFydFRlc3RSdW4gPSBnZXRhdHRyKHJlc3VsdCwgJ3N0YXJ0VGVzdFJ1bicsIE5vbmUpCiAgICAgICAgICAgIGlmIHN0YXJ0VGVzdFJ1biBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHN0YXJ0VGVzdFJ1bigpCgogICAgICAgIHJlc3VsdC5zdGFydFRlc3Qoc2VsZikKCiAgICAgICAgdGVzdE1ldGhvZCA9IGdldGF0dHIoc2VsZiwgc2VsZi5fdGVzdE1ldGhvZE5hbWUpCiAgICAgICAgaWYgKGdldGF0dHIoc2VsZi5fX2NsYXNzX18sICJfX3VuaXR0ZXN0X3NraXBfXyIsIEZhbHNlKSBvcgogICAgICAgICAgICBnZXRhdHRyKHRlc3RNZXRob2QsICJfX3VuaXR0ZXN0X3NraXBfXyIsIEZhbHNlKSk6CiAgICAgICAgICAgICMgSWYgdGhlIGNsYXNzIG9yIG1ldGhvZCB3YXMgc2tpcHBlZC4KICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2tpcF93aHkgPSAoZ2V0YXR0cihzZWxmLl9fY2xhc3NfXywgJ19fdW5pdHRlc3Rfc2tpcF93aHlfXycsICcnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3IgZ2V0YXR0cih0ZXN0TWV0aG9kLCAnX191bml0dGVzdF9za2lwX3doeV9fJywgJycpKQogICAgICAgICAgICAgICAgc2VsZi5fYWRkU2tpcChyZXN1bHQsIHNraXBfd2h5KQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgcmVzdWx0LnN0b3BUZXN0KHNlbGYpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIHRyeToKICAgICAgICAgICAgb3V0Y29tZSA9IF9PdXRjb21lKCkKICAgICAgICAgICAgc2VsZi5fb3V0Y29tZUZvckRvQ2xlYW51cHMgPSBvdXRjb21lCgogICAgICAgICAgICBzZWxmLl9leGVjdXRlVGVzdFBhcnQoc2VsZi5zZXRVcCwgb3V0Y29tZSkKICAgICAgICAgICAgaWYgb3V0Y29tZS5zdWNjZXNzOgogICAgICAgICAgICAgICAgc2VsZi5fZXhlY3V0ZVRlc3RQYXJ0KHRlc3RNZXRob2QsIG91dGNvbWUsIGlzVGVzdD1UcnVlKQogICAgICAgICAgICAgICAgc2VsZi5fZXhlY3V0ZVRlc3RQYXJ0KHNlbGYudGVhckRvd24sIG91dGNvbWUpCgogICAgICAgICAgICBzZWxmLmRvQ2xlYW51cHMoKQogICAgICAgICAgICBpZiBvdXRjb21lLnN1Y2Nlc3M6CiAgICAgICAgICAgICAgICByZXN1bHQuYWRkU3VjY2VzcyhzZWxmKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgb3V0Y29tZS5za2lwcGVkIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX2FkZFNraXAocmVzdWx0LCBvdXRjb21lLnNraXBwZWQpCiAgICAgICAgICAgICAgICBmb3IgZXhjX2luZm8gaW4gb3V0Y29tZS5lcnJvcnM6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmFkZEVycm9yKHNlbGYsIGV4Y19pbmZvKQogICAgICAgICAgICAgICAgZm9yIGV4Y19pbmZvIGluIG91dGNvbWUuZmFpbHVyZXM6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmFkZEZhaWx1cmUoc2VsZiwgZXhjX2luZm8pCiAgICAgICAgICAgICAgICBpZiBvdXRjb21lLnVuZXhwZWN0ZWRTdWNjZXNzIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIGFkZFVuZXhwZWN0ZWRTdWNjZXNzID0gZ2V0YXR0cihyZXN1bHQsICdhZGRVbmV4cGVjdGVkU3VjY2VzcycsIE5vbmUpCiAgICAgICAgICAgICAgICAgICAgaWYgYWRkVW5leHBlY3RlZFN1Y2Nlc3MgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIGFkZFVuZXhwZWN0ZWRTdWNjZXNzKHNlbGYpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgd2FybmluZ3Mud2FybigiVGVzdFJlc3VsdCBoYXMgbm8gYWRkVW5leHBlY3RlZFN1Y2Nlc3MgbWV0aG9kLCByZXBvcnRpbmcgYXMgZmFpbHVyZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJ1bnRpbWVXYXJuaW5nKQogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuYWRkRmFpbHVyZShzZWxmLCBvdXRjb21lLnVuZXhwZWN0ZWRTdWNjZXNzKQoKICAgICAgICAgICAgICAgIGlmIG91dGNvbWUuZXhwZWN0ZWRGYWlsdXJlIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIGFkZEV4cGVjdGVkRmFpbHVyZSA9IGdldGF0dHIocmVzdWx0LCAnYWRkRXhwZWN0ZWRGYWlsdXJlJywgTm9uZSkKICAgICAgICAgICAgICAgICAgICBpZiBhZGRFeHBlY3RlZEZhaWx1cmUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIGFkZEV4cGVjdGVkRmFpbHVyZShzZWxmLCBvdXRjb21lLmV4cGVjdGVkRmFpbHVyZSkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICB3YXJuaW5ncy53YXJuKCJUZXN0UmVzdWx0IGhhcyBubyBhZGRFeHBlY3RlZEZhaWx1cmUgbWV0aG9kLCByZXBvcnRpbmcgYXMgcGFzc2VzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSdW50aW1lV2FybmluZykKICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmFkZFN1Y2Nlc3Moc2VsZikKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHJlc3VsdC5zdG9wVGVzdChzZWxmKQogICAgICAgICAgICBpZiBvcmlnX3Jlc3VsdCBpcyBOb25lOgogICAgICAgICAgICAgICAgc3RvcFRlc3RSdW4gPSBnZXRhdHRyKHJlc3VsdCwgJ3N0b3BUZXN0UnVuJywgTm9uZSkKICAgICAgICAgICAgICAgIGlmIHN0b3BUZXN0UnVuIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIHN0b3BUZXN0UnVuKCkKCiAgICBkZWYgZG9DbGVhbnVwcyhzZWxmKToKICAgICAgICAiIiJFeGVjdXRlIGFsbCBjbGVhbnVwIGZ1bmN0aW9ucy4gTm9ybWFsbHkgY2FsbGVkIGZvciB5b3UgYWZ0ZXIKICAgICAgICB0ZWFyRG93bi4iIiIKICAgICAgICBvdXRjb21lID0gc2VsZi5fb3V0Y29tZUZvckRvQ2xlYW51cHMgb3IgX091dGNvbWUoKQogICAgICAgIHdoaWxlIHNlbGYuX2NsZWFudXBzOgogICAgICAgICAgICBmdW5jdGlvbiwgYXJncywga3dhcmdzID0gc2VsZi5fY2xlYW51cHMucG9wKCkKICAgICAgICAgICAgcGFydCA9IGxhbWJkYTogZnVuY3Rpb24oKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBzZWxmLl9leGVjdXRlVGVzdFBhcnQocGFydCwgb3V0Y29tZSkKCiAgICAgICAgIyByZXR1cm4gdGhpcyBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkKICAgICAgICAjIGV2ZW4gdGhvdWdoIHdlIG5vIGxvbmdlciB1cyBpdCBpbnRlcm5hbGx5CiAgICAgICAgcmV0dXJuIG91dGNvbWUuc3VjY2VzcwoKICAgIGRlZiBfX2NhbGxfXyhzZWxmLCAqYXJncywgKiprd2RzKToKICAgICAgICByZXR1cm4gc2VsZi5ydW4oKmFyZ3MsICoqa3dkcykKCiAgICBkZWYgZGVidWcoc2VsZik6CiAgICAgICAgIiIiUnVuIHRoZSB0ZXN0IHdpdGhvdXQgY29sbGVjdGluZyBlcnJvcnMgaW4gYSBUZXN0UmVzdWx0IiIiCiAgICAgICAgc2VsZi5zZXRVcCgpCiAgICAgICAgZ2V0YXR0cihzZWxmLCBzZWxmLl90ZXN0TWV0aG9kTmFtZSkoKQogICAgICAgIHNlbGYudGVhckRvd24oKQogICAgICAgIHdoaWxlIHNlbGYuX2NsZWFudXBzOgogICAgICAgICAgICBmdW5jdGlvbiwgYXJncywga3dhcmdzID0gc2VsZi5fY2xlYW51cHMucG9wKC0xKQogICAgICAgICAgICBmdW5jdGlvbigqYXJncywgKiprd2FyZ3MpCgogICAgZGVmIHNraXBUZXN0KHNlbGYsIHJlYXNvbik6CiAgICAgICAgIiIiU2tpcCB0aGlzIHRlc3QuIiIiCiAgICAgICAgcmFpc2UgU2tpcFRlc3QocmVhc29uKQoKICAgIGRlZiBmYWlsKHNlbGYsIG1zZz1Ob25lKToKICAgICAgICAiIiJGYWlsIGltbWVkaWF0ZWx5LCB3aXRoIHRoZSBnaXZlbiBtZXNzYWdlLiIiIgogICAgICAgIHJhaXNlIHNlbGYuZmFpbHVyZUV4Y2VwdGlvbihtc2cpCgogICAgZGVmIGFzc2VydEZhbHNlKHNlbGYsIGV4cHIsIG1zZz1Ob25lKToKICAgICAgICAiIiJDaGVjayB0aGF0IHRoZSBleHByZXNzaW9uIGlzIGZhbHNlLiIiIgogICAgICAgIGlmIGV4cHI6CiAgICAgICAgICAgIG1zZyA9IHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCAiJXMgaXMgbm90IGZhbHNlIiAlIHNhZmVfcmVwcihleHByKSkKICAgICAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKG1zZykKCiAgICBkZWYgYXNzZXJ0VHJ1ZShzZWxmLCBleHByLCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiQ2hlY2sgdGhhdCB0aGUgZXhwcmVzc2lvbiBpcyB0cnVlLiIiIgogICAgICAgIGlmIG5vdCBleHByOgogICAgICAgICAgICBtc2cgPSBzZWxmLl9mb3JtYXRNZXNzYWdlKG1zZywgIiVzIGlzIG5vdCB0cnVlIiAlIHNhZmVfcmVwcihleHByKSkKICAgICAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKG1zZykKCiAgICBkZWYgX2Zvcm1hdE1lc3NhZ2Uoc2VsZiwgbXNnLCBzdGFuZGFyZE1zZyk6CiAgICAgICAgIiIiSG9ub3VyIHRoZSBsb25nTWVzc2FnZSBhdHRyaWJ1dGUgd2hlbiBnZW5lcmF0aW5nIGZhaWx1cmUgbWVzc2FnZXMuCiAgICAgICAgSWYgbG9uZ01lc3NhZ2UgaXMgRmFsc2UgdGhpcyBtZWFuczoKICAgICAgICAqIFVzZSBvbmx5IGFuIGV4cGxpY2l0IG1lc3NhZ2UgaWYgaXQgaXMgcHJvdmlkZWQKICAgICAgICAqIE90aGVyd2lzZSB1c2UgdGhlIHN0YW5kYXJkIG1lc3NhZ2UgZm9yIHRoZSBhc3NlcnQKCiAgICAgICAgSWYgbG9uZ01lc3NhZ2UgaXMgVHJ1ZToKICAgICAgICAqIFVzZSB0aGUgc3RhbmRhcmQgbWVzc2FnZQogICAgICAgICogSWYgYW4gZXhwbGljaXQgbWVzc2FnZSBpcyBwcm92aWRlZCwgcGx1cyAnIDogJyBhbmQgdGhlIGV4cGxpY2l0IG1lc3NhZ2UKICAgICAgICAiIiIKICAgICAgICBpZiBub3Qgc2VsZi5sb25nTWVzc2FnZToKICAgICAgICAgICAgcmV0dXJuIG1zZyBvciBzdGFuZGFyZE1zZwogICAgICAgIGlmIG1zZyBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gc3RhbmRhcmRNc2cKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgZG9uJ3Qgc3dpdGNoIHRvICd7fScgZm9ybWF0dGluZyBpbiBQeXRob24gMi5YCiAgICAgICAgICAgICMgaXQgY2hhbmdlcyB0aGUgd2F5IHVuaWNvZGUgaW5wdXQgaXMgaGFuZGxlZAogICAgICAgICAgICByZXR1cm4gJyVzIDogJXMnICUgKHN0YW5kYXJkTXNnLCBtc2cpCiAgICAgICAgZXhjZXB0IFVuaWNvZGVEZWNvZGVFcnJvcjoKICAgICAgICAgICAgcmV0dXJuICAnJXMgOiAlcycgJSAoc2FmZV9yZXByKHN0YW5kYXJkTXNnKSwgc2FmZV9yZXByKG1zZykpCgogICAgZGVmIGFzc2VydFJhaXNlcyhzZWxmLCBleGNDbGFzcywgY2FsbGFibGVPYmo9Tm9uZSwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAiIiJGYWlsIHVubGVzcyBhbiBleGNlcHRpb24gb2YgY2xhc3MgZXhjQ2xhc3MgaXMgdGhyb3duCiAgICAgICAgICAgYnkgY2FsbGFibGVPYmogd2hlbiBpbnZva2VkIHdpdGggYXJndW1lbnRzIGFyZ3MgYW5kIGtleXdvcmQKICAgICAgICAgICBhcmd1bWVudHMga3dhcmdzLiBJZiBhIGRpZmZlcmVudCB0eXBlIG9mIGV4Y2VwdGlvbiBpcwogICAgICAgICAgIHRocm93biwgaXQgd2lsbCBub3QgYmUgY2F1Z2h0LCBhbmQgdGhlIHRlc3QgY2FzZSB3aWxsIGJlCiAgICAgICAgICAgZGVlbWVkIHRvIGhhdmUgc3VmZmVyZWQgYW4gZXJyb3IsIGV4YWN0bHkgYXMgZm9yIGFuCiAgICAgICAgICAgdW5leHBlY3RlZCBleGNlcHRpb24uCgogICAgICAgICAgIElmIGNhbGxlZCB3aXRoIGNhbGxhYmxlT2JqIG9taXR0ZWQgb3IgTm9uZSwgd2lsbCByZXR1cm4gYQogICAgICAgICAgIGNvbnRleHQgb2JqZWN0IHVzZWQgbGlrZSB0aGlzOjoKCiAgICAgICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKFNvbWVFeGNlcHRpb24pOgogICAgICAgICAgICAgICAgICAgIGRvX3NvbWV0aGluZygpCgogICAgICAgICAgIEFuIG9wdGlvbmFsIGtleXdvcmQgYXJndW1lbnQgJ21zZycgY2FuIGJlIHByb3ZpZGVkIHdoZW4gYXNzZXJ0UmFpc2VzCiAgICAgICAgICAgaXMgdXNlZCBhcyBhIGNvbnRleHQgb2JqZWN0LgoKICAgICAgICAgICBUaGUgY29udGV4dCBtYW5hZ2VyIGtlZXBzIGEgcmVmZXJlbmNlIHRvIHRoZSBleGNlcHRpb24gYXMKICAgICAgICAgICB0aGUgJ2V4Y2VwdGlvbicgYXR0cmlidXRlLiBUaGlzIGFsbG93cyB5b3UgdG8gaW5zcGVjdCB0aGUKICAgICAgICAgICBleGNlcHRpb24gYWZ0ZXIgdGhlIGFzc2VydGlvbjo6CgogICAgICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKFNvbWVFeGNlcHRpb24pIGFzIGNtOgogICAgICAgICAgICAgICAgICAgZG9fc29tZXRoaW5nKCkKICAgICAgICAgICAgICAgdGhlX2V4Y2VwdGlvbiA9IGNtLmV4Y2VwdGlvbgogICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHRoZV9leGNlcHRpb24uZXJyb3JfY29kZSwgMykKICAgICAgICAiIiIKICAgICAgICBjb250ZXh0ID0gX0Fzc2VydFJhaXNlc0NvbnRleHQoZXhjQ2xhc3MsIHNlbGYsIGNhbGxhYmxlT2JqKQogICAgICAgIHJldHVybiBjb250ZXh0LmhhbmRsZSgnYXNzZXJ0UmFpc2VzJywgY2FsbGFibGVPYmosIGFyZ3MsIGt3YXJncykKCiAgICBkZWYgYXNzZXJ0V2FybnMoc2VsZiwgZXhwZWN0ZWRfd2FybmluZywgY2FsbGFibGVfb2JqPU5vbmUsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgIiIiRmFpbCB1bmxlc3MgYSB3YXJuaW5nIG9mIGNsYXNzIHdhcm5DbGFzcyBpcyB0cmlnZ2VyZWQKICAgICAgICAgICBieSBjYWxsYWJsZV9vYmogd2hlbiBpbnZva2VkIHdpdGggYXJndW1lbnRzIGFyZ3MgYW5kIGtleXdvcmQKICAgICAgICAgICBhcmd1bWVudHMga3dhcmdzLiAgSWYgYSBkaWZmZXJlbnQgdHlwZSBvZiB3YXJuaW5nIGlzCiAgICAgICAgICAgdHJpZ2dlcmVkLCBpdCB3aWxsIG5vdCBiZSBoYW5kbGVkOiBkZXBlbmRpbmcgb24gdGhlIG90aGVyCiAgICAgICAgICAgd2FybmluZyBmaWx0ZXJpbmcgcnVsZXMgaW4gZWZmZWN0LCBpdCBtaWdodCBiZSBzaWxlbmNlZCwgcHJpbnRlZAogICAgICAgICAgIG91dCwgb3IgcmFpc2VkIGFzIGFuIGV4Y2VwdGlvbi4KCiAgICAgICAgICAgSWYgY2FsbGVkIHdpdGggY2FsbGFibGVfb2JqIG9taXR0ZWQgb3IgTm9uZSwgd2lsbCByZXR1cm4gYQogICAgICAgICAgIGNvbnRleHQgb2JqZWN0IHVzZWQgbGlrZSB0aGlzOjoKCiAgICAgICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0V2FybnMoU29tZVdhcm5pbmcpOgogICAgICAgICAgICAgICAgICAgIGRvX3NvbWV0aGluZygpCgogICAgICAgICAgIEFuIG9wdGlvbmFsIGtleXdvcmQgYXJndW1lbnQgJ21zZycgY2FuIGJlIHByb3ZpZGVkIHdoZW4gYXNzZXJ0V2FybnMKICAgICAgICAgICBpcyB1c2VkIGFzIGEgY29udGV4dCBvYmplY3QuCgogICAgICAgICAgIFRoZSBjb250ZXh0IG1hbmFnZXIga2VlcHMgYSByZWZlcmVuY2UgdG8gdGhlIGZpcnN0IG1hdGNoaW5nCiAgICAgICAgICAgd2FybmluZyBhcyB0aGUgJ3dhcm5pbmcnIGF0dHJpYnV0ZTsgc2ltaWxhcmx5LCB0aGUgJ2ZpbGVuYW1lJwogICAgICAgICAgIGFuZCAnbGluZW5vJyBhdHRyaWJ1dGVzIGdpdmUgeW91IGluZm9ybWF0aW9uIGFib3V0IHRoZSBsaW5lCiAgICAgICAgICAgb2YgUHl0aG9uIGNvZGUgZnJvbSB3aGljaCB0aGUgd2FybmluZyB3YXMgdHJpZ2dlcmVkLgogICAgICAgICAgIFRoaXMgYWxsb3dzIHlvdSB0byBpbnNwZWN0IHRoZSB3YXJuaW5nIGFmdGVyIHRoZSBhc3NlcnRpb246OgoKICAgICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFdhcm5zKFNvbWVXYXJuaW5nKSBhcyBjbToKICAgICAgICAgICAgICAgICAgIGRvX3NvbWV0aGluZygpCiAgICAgICAgICAgICAgIHRoZV93YXJuaW5nID0gY20ud2FybmluZwogICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHRoZV93YXJuaW5nLnNvbWVfYXR0cmlidXRlLCAxNDcpCiAgICAgICAgIiIiCiAgICAgICAgY29udGV4dCA9IF9Bc3NlcnRXYXJuc0NvbnRleHQoZXhwZWN0ZWRfd2FybmluZywgc2VsZiwgY2FsbGFibGVfb2JqKQogICAgICAgIHJldHVybiBjb250ZXh0LmhhbmRsZSgnYXNzZXJ0V2FybnMnLCBjYWxsYWJsZV9vYmosIGFyZ3MsIGt3YXJncykKCiAgICBkZWYgX2dldEFzc2VydEVxdWFsaXR5RnVuYyhzZWxmLCBmaXJzdCwgc2Vjb25kKToKICAgICAgICAiIiJHZXQgYSBkZXRhaWxlZCBjb21wYXJpc29uIGZ1bmN0aW9uIGZvciB0aGUgdHlwZXMgb2YgdGhlIHR3byBhcmdzLgoKICAgICAgICBSZXR1cm5zOiBBIGNhbGxhYmxlIGFjY2VwdGluZyAoZmlyc3QsIHNlY29uZCwgbXNnPU5vbmUpIHRoYXQgd2lsbAogICAgICAgIHJhaXNlIGEgZmFpbHVyZSBleGNlcHRpb24gaWYgZmlyc3QgIT0gc2Vjb25kIHdpdGggYSB1c2VmdWwgaHVtYW4KICAgICAgICByZWFkYWJsZSBlcnJvciBtZXNzYWdlIGZvciB0aG9zZSB0eXBlcy4KICAgICAgICAiIiIKICAgICAgICAjCiAgICAgICAgIyBOT1RFKGdyZWdvcnkucC5zbWl0aCk6IEkgY29uc2lkZXJlZCBpc2luc3RhbmNlKGZpcnN0LCB0eXBlKHNlY29uZCkpCiAgICAgICAgIyBhbmQgdmljZSB2ZXJzYS4gIEkgb3B0ZWQgZm9yIHRoZSBjb25zZXJ2YXRpdmUgYXBwcm9hY2ggaW4gY2FzZQogICAgICAgICMgc3ViY2xhc3NlcyBhcmUgbm90IGludGVuZGVkIHRvIGJlIGNvbXBhcmVkIGluIGRldGFpbCB0byB0aGVpciBzdXBlcgogICAgICAgICMgY2xhc3MgaW5zdGFuY2VzIHVzaW5nIGEgdHlwZSBlcXVhbGl0eSBmdW5jLiAgVGhpcyBtZWFucyB0ZXN0aW5nCiAgICAgICAgIyBzdWJ0eXBlcyB3b24ndCBhdXRvbWFnaWNhbGx5IHVzZSB0aGUgZGV0YWlsZWQgY29tcGFyaXNvbi4gIENhbGxlcnMKICAgICAgICAjIHNob3VsZCB1c2UgdGhlaXIgdHlwZSBzcGVjaWZpYyBhc3NlcnRTcGFtRXF1YWwgbWV0aG9kIHRvIGNvbXBhcmUKICAgICAgICAjIHN1YmNsYXNzZXMgaWYgdGhlIGRldGFpbGVkIGNvbXBhcmlzb24gaXMgZGVzaXJlZCBhbmQgYXBwcm9wcmlhdGUuCiAgICAgICAgIyBTZWUgdGhlIGRpc2N1c3Npb24gaW4gaHR0cDovL2J1Z3MucHl0aG9uLm9yZy9pc3N1ZTI1NzguCiAgICAgICAgIwogICAgICAgIGlmIHR5cGUoZmlyc3QpIGlzIHR5cGUoc2Vjb25kKToKICAgICAgICAgICAgYXNzZXJ0ZXIgPSBzZWxmLl90eXBlX2VxdWFsaXR5X2Z1bmNzLmdldCh0eXBlKGZpcnN0KSkKICAgICAgICAgICAgaWYgYXNzZXJ0ZXIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGFzc2VydGVyLCBzdHIpOgogICAgICAgICAgICAgICAgICAgIGFzc2VydGVyID0gZ2V0YXR0cihzZWxmLCBhc3NlcnRlcikKICAgICAgICAgICAgICAgIHJldHVybiBhc3NlcnRlcgoKICAgICAgICByZXR1cm4gc2VsZi5fYmFzZUFzc2VydEVxdWFsCgogICAgZGVmIF9iYXNlQXNzZXJ0RXF1YWwoc2VsZiwgZmlyc3QsIHNlY29uZCwgbXNnPU5vbmUpOgogICAgICAgICIiIlRoZSBkZWZhdWx0IGFzc2VydEVxdWFsIGltcGxlbWVudGF0aW9uLCBub3QgdHlwZSBzcGVjaWZpYy4iIiIKICAgICAgICBpZiBub3QgZmlyc3QgPT0gc2Vjb25kOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyAhPSAlcycgJSAoc2FmZV9yZXByKGZpcnN0KSwgc2FmZV9yZXByKHNlY29uZCkpCiAgICAgICAgICAgIG1zZyA9IHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykKICAgICAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKG1zZykKCiAgICBkZWYgYXNzZXJ0RXF1YWwoc2VsZiwgZmlyc3QsIHNlY29uZCwgbXNnPU5vbmUpOgogICAgICAgICIiIkZhaWwgaWYgdGhlIHR3byBvYmplY3RzIGFyZSB1bmVxdWFsIGFzIGRldGVybWluZWQgYnkgdGhlICc9PScKICAgICAgICAgICBvcGVyYXRvci4KICAgICAgICAiIiIKICAgICAgICBhc3NlcnRpb25fZnVuYyA9IHNlbGYuX2dldEFzc2VydEVxdWFsaXR5RnVuYyhmaXJzdCwgc2Vjb25kKQogICAgICAgIGFzc2VydGlvbl9mdW5jKGZpcnN0LCBzZWNvbmQsIG1zZz1tc2cpCgogICAgZGVmIGFzc2VydE5vdEVxdWFsKHNlbGYsIGZpcnN0LCBzZWNvbmQsIG1zZz1Ob25lKToKICAgICAgICAiIiJGYWlsIGlmIHRoZSB0d28gb2JqZWN0cyBhcmUgZXF1YWwgYXMgZGV0ZXJtaW5lZCBieSB0aGUgJz09JwogICAgICAgICAgIG9wZXJhdG9yLgogICAgICAgICIiIgogICAgICAgIGlmIG5vdCBmaXJzdCAhPSBzZWNvbmQ6CiAgICAgICAgICAgIG1zZyA9IHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCAnJXMgPT0gJXMnICUgKHNhZmVfcmVwcihmaXJzdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWZlX3JlcHIoc2Vjb25kKSkpCiAgICAgICAgICAgIHJhaXNlIHNlbGYuZmFpbHVyZUV4Y2VwdGlvbihtc2cpCgogICAgZGVmIGFzc2VydEFsbW9zdEVxdWFsKHNlbGYsIGZpcnN0LCBzZWNvbmQsIHBsYWNlcz1Ob25lLCBtc2c9Tm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBkZWx0YT1Ob25lKToKICAgICAgICAiIiJGYWlsIGlmIHRoZSB0d28gb2JqZWN0cyBhcmUgdW5lcXVhbCBhcyBkZXRlcm1pbmVkIGJ5IHRoZWlyCiAgICAgICAgICAgZGlmZmVyZW5jZSByb3VuZGVkIHRvIHRoZSBnaXZlbiBudW1iZXIgb2YgZGVjaW1hbCBwbGFjZXMKICAgICAgICAgICAoZGVmYXVsdCA3KSBhbmQgY29tcGFyaW5nIHRvIHplcm8sIG9yIGJ5IGNvbXBhcmluZyB0aGF0IHRoZQogICAgICAgICAgIGJldHdlZW4gdGhlIHR3byBvYmplY3RzIGlzIG1vcmUgdGhhbiB0aGUgZ2l2ZW4gZGVsdGEuCgogICAgICAgICAgIE5vdGUgdGhhdCBkZWNpbWFsIHBsYWNlcyAoZnJvbSB6ZXJvKSBhcmUgdXN1YWxseSBub3QgdGhlIHNhbWUKICAgICAgICAgICBhcyBzaWduaWZpY2FudCBkaWdpdHMgKG1lYXN1cmVkIGZyb20gdGhlIG1vc3Qgc2lnbmZpY2FudCBkaWdpdCkuCgogICAgICAgICAgIElmIHRoZSB0d28gb2JqZWN0cyBjb21wYXJlIGVxdWFsIHRoZW4gdGhleSB3aWxsIGF1dG9tYXRpY2FsbHkKICAgICAgICAgICBjb21wYXJlIGFsbW9zdCBlcXVhbC4KICAgICAgICAiIiIKICAgICAgICBpZiBmaXJzdCA9PSBzZWNvbmQ6CiAgICAgICAgICAgICMgc2hvcnRjdXQKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgZGVsdGEgaXMgbm90IE5vbmUgYW5kIHBsYWNlcyBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJzcGVjaWZ5IGRlbHRhIG9yIHBsYWNlcyBub3QgYm90aCIpCgogICAgICAgIGlmIGRlbHRhIGlzIG5vdCBOb25lOgogICAgICAgICAgICBpZiBhYnMoZmlyc3QgLSBzZWNvbmQpIDw9IGRlbHRhOgogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyAhPSAlcyB3aXRoaW4gJXMgZGVsdGEnICUgKHNhZmVfcmVwcihmaXJzdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKHNlY29uZCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKGRlbHRhKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBwbGFjZXMgaXMgTm9uZToKICAgICAgICAgICAgICAgIHBsYWNlcyA9IDcKCiAgICAgICAgICAgIGlmIHJvdW5kKGFicyhzZWNvbmQtZmlyc3QpLCBwbGFjZXMpID09IDA6CiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzICE9ICVzIHdpdGhpbiAlciBwbGFjZXMnICUgKHNhZmVfcmVwcihmaXJzdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWZlX3JlcHIoc2Vjb25kKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlcykKICAgICAgICBtc2cgPSBzZWxmLl9mb3JtYXRNZXNzYWdlKG1zZywgc3RhbmRhcmRNc2cpCiAgICAgICAgcmFpc2Ugc2VsZi5mYWlsdXJlRXhjZXB0aW9uKG1zZykKCiAgICBkZWYgYXNzZXJ0Tm90QWxtb3N0RXF1YWwoc2VsZiwgZmlyc3QsIHNlY29uZCwgcGxhY2VzPU5vbmUsIG1zZz1Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhPU5vbmUpOgogICAgICAgICIiIkZhaWwgaWYgdGhlIHR3byBvYmplY3RzIGFyZSBlcXVhbCBhcyBkZXRlcm1pbmVkIGJ5IHRoZWlyCiAgICAgICAgICAgZGlmZmVyZW5jZSByb3VuZGVkIHRvIHRoZSBnaXZlbiBudW1iZXIgb2YgZGVjaW1hbCBwbGFjZXMKICAgICAgICAgICAoZGVmYXVsdCA3KSBhbmQgY29tcGFyaW5nIHRvIHplcm8sIG9yIGJ5IGNvbXBhcmluZyB0aGF0IHRoZQogICAgICAgICAgIGJldHdlZW4gdGhlIHR3byBvYmplY3RzIGlzIGxlc3MgdGhhbiB0aGUgZ2l2ZW4gZGVsdGEuCgogICAgICAgICAgIE5vdGUgdGhhdCBkZWNpbWFsIHBsYWNlcyAoZnJvbSB6ZXJvKSBhcmUgdXN1YWxseSBub3QgdGhlIHNhbWUKICAgICAgICAgICBhcyBzaWduaWZpY2FudCBkaWdpdHMgKG1lYXN1cmVkIGZyb20gdGhlIG1vc3Qgc2lnbmZpY2FudCBkaWdpdCkuCgogICAgICAgICAgIE9iamVjdHMgdGhhdCBhcmUgZXF1YWwgYXV0b21hdGljYWxseSBmYWlsLgogICAgICAgICIiIgogICAgICAgIGlmIGRlbHRhIGlzIG5vdCBOb25lIGFuZCBwbGFjZXMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigic3BlY2lmeSBkZWx0YSBvciBwbGFjZXMgbm90IGJvdGgiKQogICAgICAgIGlmIGRlbHRhIGlzIG5vdCBOb25lOgogICAgICAgICAgICBpZiBub3QgKGZpcnN0ID09IHNlY29uZCkgYW5kIGFicyhmaXJzdCAtIHNlY29uZCkgPiBkZWx0YToKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyA9PSAlcyB3aXRoaW4gJXMgZGVsdGEnICUgKHNhZmVfcmVwcihmaXJzdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKHNlY29uZCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKGRlbHRhKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBwbGFjZXMgaXMgTm9uZToKICAgICAgICAgICAgICAgIHBsYWNlcyA9IDcKICAgICAgICAgICAgaWYgbm90IChmaXJzdCA9PSBzZWNvbmQpIGFuZCByb3VuZChhYnMoc2Vjb25kLWZpcnN0KSwgcGxhY2VzKSAhPSAwOgogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzID09ICVzIHdpdGhpbiAlciBwbGFjZXMnICUgKHNhZmVfcmVwcihmaXJzdCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhZmVfcmVwcihzZWNvbmQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZXMpCgogICAgICAgIG1zZyA9IHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykKICAgICAgICByYWlzZSBzZWxmLmZhaWx1cmVFeGNlcHRpb24obXNnKQoKCiAgICBkZWYgYXNzZXJ0U2VxdWVuY2VFcXVhbChzZWxmLCBzZXExLCBzZXEyLCBtc2c9Tm9uZSwgc2VxX3R5cGU9Tm9uZSk6CiAgICAgICAgIiIiQW4gZXF1YWxpdHkgYXNzZXJ0aW9uIGZvciBvcmRlcmVkIHNlcXVlbmNlcyAobGlrZSBsaXN0cyBhbmQgdHVwbGVzKS4KCiAgICAgICAgRm9yIHRoZSBwdXJwb3NlcyBvZiB0aGlzIGZ1bmN0aW9uLCBhIHZhbGlkIG9yZGVyZWQgc2VxdWVuY2UgdHlwZSBpcyBvbmUKICAgICAgICB3aGljaCBjYW4gYmUgaW5kZXhlZCwgaGFzIGEgbGVuZ3RoLCBhbmQgaGFzIGFuIGVxdWFsaXR5IG9wZXJhdG9yLgoKICAgICAgICBBcmdzOgogICAgICAgICAgICBzZXExOiBUaGUgZmlyc3Qgc2VxdWVuY2UgdG8gY29tcGFyZS4KICAgICAgICAgICAgc2VxMjogVGhlIHNlY29uZCBzZXF1ZW5jZSB0byBjb21wYXJlLgogICAgICAgICAgICBzZXFfdHlwZTogVGhlIGV4cGVjdGVkIGRhdGF0eXBlIG9mIHRoZSBzZXF1ZW5jZXMsIG9yIE5vbmUgaWYgbm8KICAgICAgICAgICAgICAgICAgICBkYXRhdHlwZSBzaG91bGQgYmUgZW5mb3JjZWQuCiAgICAgICAgICAgIG1zZzogT3B0aW9uYWwgbWVzc2FnZSB0byB1c2Ugb24gZmFpbHVyZSBpbnN0ZWFkIG9mIGEgbGlzdCBvZgogICAgICAgICAgICAgICAgICAgIGRpZmZlcmVuY2VzLgogICAgICAgICIiIgogICAgICAgIGlmIHNlcV90eXBlICE9IE5vbmU6CiAgICAgICAgICAgIHNlcV90eXBlX25hbWUgPSBzZXFfdHlwZS5fX25hbWVfXwogICAgICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShzZXExLCBzZXFfdHlwZSk6CiAgICAgICAgICAgICAgICByYWlzZSBzZWxmLmZhaWx1cmVFeGNlcHRpb24oJ0ZpcnN0IHNlcXVlbmNlIGlzIG5vdCBhICVzOiAlcycKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICUgKHNlcV90eXBlX25hbWUsIHNhZmVfcmVwcihzZXExKSkpCiAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHNlcTIsIHNlcV90eXBlKToKICAgICAgICAgICAgICAgIHJhaXNlIHNlbGYuZmFpbHVyZUV4Y2VwdGlvbignU2Vjb25kIHNlcXVlbmNlIGlzIG5vdCBhICVzOiAlcycKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICUgKHNlcV90eXBlX25hbWUsIHNhZmVfcmVwcihzZXEyKSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VxX3R5cGVfbmFtZSA9ICJzZXF1ZW5jZSIKCiAgICAgICAgZGlmZmVyaW5nID0gTm9uZQogICAgICAgIHRyeToKICAgICAgICAgICAgbGVuMSA9IGxlbihzZXExKQogICAgICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBOb3RJbXBsZW1lbnRlZEVycm9yKToKICAgICAgICAgICAgZGlmZmVyaW5nID0gJ0ZpcnN0ICVzIGhhcyBubyBsZW5ndGguICAgIE5vbi1zZXF1ZW5jZT8nICUgKAogICAgICAgICAgICAgICAgICAgIHNlcV90eXBlX25hbWUpCgogICAgICAgIGlmIGRpZmZlcmluZyBpcyBOb25lOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBsZW4yID0gbGVuKHNlcTIpCiAgICAgICAgICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBOb3RJbXBsZW1lbnRlZEVycm9yKToKICAgICAgICAgICAgICAgIGRpZmZlcmluZyA9ICdTZWNvbmQgJXMgaGFzIG5vIGxlbmd0aC4gICAgTm9uLXNlcXVlbmNlPycgJSAoCiAgICAgICAgICAgICAgICAgICAgICAgIHNlcV90eXBlX25hbWUpCgogICAgICAgIGlmIGRpZmZlcmluZyBpcyBOb25lOgogICAgICAgICAgICBpZiBzZXExID09IHNlcTI6CiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgIHNlcTFfcmVwciA9IHNhZmVfcmVwcihzZXExKQogICAgICAgICAgICBzZXEyX3JlcHIgPSBzYWZlX3JlcHIoc2VxMikKICAgICAgICAgICAgaWYgbGVuKHNlcTFfcmVwcikgPiAzMDoKICAgICAgICAgICAgICAgIHNlcTFfcmVwciA9IHNlcTFfcmVwcls6MzBdICsgJy4uLicKICAgICAgICAgICAgaWYgbGVuKHNlcTJfcmVwcikgPiAzMDoKICAgICAgICAgICAgICAgIHNlcTJfcmVwciA9IHNlcTJfcmVwcls6MzBdICsgJy4uLicKICAgICAgICAgICAgZWxlbWVudHMgPSAoc2VxX3R5cGVfbmFtZS5jYXBpdGFsaXplKCksIHNlcTFfcmVwciwgc2VxMl9yZXByKQogICAgICAgICAgICBkaWZmZXJpbmcgPSAnJXNzIGRpZmZlcjogJXMgIT0gJXNcbicgJSBlbGVtZW50cwoKICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2UobWluKGxlbjEsIGxlbjIpKToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBpdGVtMSA9IHNlcTFbaV0KICAgICAgICAgICAgICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBJbmRleEVycm9yLCBOb3RJbXBsZW1lbnRlZEVycm9yKToKICAgICAgICAgICAgICAgICAgICBkaWZmZXJpbmcgKz0gKCdcblVuYWJsZSB0byBpbmRleCBlbGVtZW50ICVkIG9mIGZpcnN0ICVzXG4nICUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGksIHNlcV90eXBlX25hbWUpKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGl0ZW0yID0gc2VxMltpXQogICAgICAgICAgICAgICAgZXhjZXB0IChUeXBlRXJyb3IsIEluZGV4RXJyb3IsIE5vdEltcGxlbWVudGVkRXJyb3IpOgogICAgICAgICAgICAgICAgICAgIGRpZmZlcmluZyArPSAoJ1xuVW5hYmxlIHRvIGluZGV4IGVsZW1lbnQgJWQgb2Ygc2Vjb25kICVzXG4nICUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGksIHNlcV90eXBlX25hbWUpKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAgICAgaWYgaXRlbTEgIT0gaXRlbTI6CiAgICAgICAgICAgICAgICAgICAgZGlmZmVyaW5nICs9ICgnXG5GaXJzdCBkaWZmZXJpbmcgZWxlbWVudCAlZDpcbiVzXG4lc1xuJyAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChpLCBpdGVtMSwgaXRlbTIpKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpZiAobGVuMSA9PSBsZW4yIGFuZCBzZXFfdHlwZSBpcyBOb25lIGFuZAogICAgICAgICAgICAgICAgICAgIHR5cGUoc2VxMSkgIT0gdHlwZShzZXEyKSk6CiAgICAgICAgICAgICAgICAgICAgIyBUaGUgc2VxdWVuY2VzIGFyZSB0aGUgc2FtZSwgYnV0IGhhdmUgZGlmZmVyaW5nIHR5cGVzLgogICAgICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgaWYgbGVuMSA+IGxlbjI6CiAgICAgICAgICAgICAgICBkaWZmZXJpbmcgKz0gKCdcbkZpcnN0ICVzIGNvbnRhaW5zICVkIGFkZGl0aW9uYWwgJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICdlbGVtZW50cy5cbicgJSAoc2VxX3R5cGVfbmFtZSwgbGVuMSAtIGxlbjIpKQogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGRpZmZlcmluZyArPSAoJ0ZpcnN0IGV4dHJhIGVsZW1lbnQgJWQ6XG4lc1xuJyAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAobGVuMiwgc2VxMVtsZW4yXSkpCiAgICAgICAgICAgICAgICBleGNlcHQgKFR5cGVFcnJvciwgSW5kZXhFcnJvciwgTm90SW1wbGVtZW50ZWRFcnJvcik6CiAgICAgICAgICAgICAgICAgICAgZGlmZmVyaW5nICs9ICgnVW5hYmxlIHRvIGluZGV4IGVsZW1lbnQgJWQgJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29mIGZpcnN0ICVzXG4nICUgKGxlbjIsIHNlcV90eXBlX25hbWUpKQogICAgICAgICAgICBlbGlmIGxlbjEgPCBsZW4yOgogICAgICAgICAgICAgICAgZGlmZmVyaW5nICs9ICgnXG5TZWNvbmQgJXMgY29udGFpbnMgJWQgYWRkaXRpb25hbCAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2VsZW1lbnRzLlxuJyAlIChzZXFfdHlwZV9uYW1lLCBsZW4yIC0gbGVuMSkpCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgZGlmZmVyaW5nICs9ICgnRmlyc3QgZXh0cmEgZWxlbWVudCAlZDpcbiVzXG4nICUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChsZW4xLCBzZXEyW2xlbjFdKSkKICAgICAgICAgICAgICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBJbmRleEVycm9yLCBOb3RJbXBsZW1lbnRlZEVycm9yKToKICAgICAgICAgICAgICAgICAgICBkaWZmZXJpbmcgKz0gKCdVbmFibGUgdG8gaW5kZXggZWxlbWVudCAlZCAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb2Ygc2Vjb25kICVzXG4nICUgKGxlbjEsIHNlcV90eXBlX25hbWUpKQogICAgICAgIHN0YW5kYXJkTXNnID0gZGlmZmVyaW5nCiAgICAgICAgZGlmZk1zZyA9ICdcbicgKyAnXG4nLmpvaW4oCiAgICAgICAgICAgIGRpZmZsaWIubmRpZmYocHByaW50LnBmb3JtYXQoc2VxMSkuc3BsaXRsaW5lcygpLAogICAgICAgICAgICAgICAgICAgICAgICAgIHBwcmludC5wZm9ybWF0KHNlcTIpLnNwbGl0bGluZXMoKSkpCgogICAgICAgIHN0YW5kYXJkTXNnID0gc2VsZi5fdHJ1bmNhdGVNZXNzYWdlKHN0YW5kYXJkTXNnLCBkaWZmTXNnKQogICAgICAgIG1zZyA9IHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykKICAgICAgICBzZWxmLmZhaWwobXNnKQoKICAgIGRlZiBfdHJ1bmNhdGVNZXNzYWdlKHNlbGYsIG1lc3NhZ2UsIGRpZmYpOgogICAgICAgIG1heF9kaWZmID0gc2VsZi5tYXhEaWZmCiAgICAgICAgaWYgbWF4X2RpZmYgaXMgTm9uZSBvciBsZW4oZGlmZikgPD0gbWF4X2RpZmY6CiAgICAgICAgICAgIHJldHVybiBtZXNzYWdlICsgZGlmZgogICAgICAgIHJldHVybiBtZXNzYWdlICsgKERJRkZfT01JVFRFRCAlIGxlbihkaWZmKSkKCiAgICBkZWYgYXNzZXJ0TGlzdEVxdWFsKHNlbGYsIGxpc3QxLCBsaXN0MiwgbXNnPU5vbmUpOgogICAgICAgICIiIkEgbGlzdC1zcGVjaWZpYyBlcXVhbGl0eSBhc3NlcnRpb24uCgogICAgICAgIEFyZ3M6CiAgICAgICAgICAgIGxpc3QxOiBUaGUgZmlyc3QgbGlzdCB0byBjb21wYXJlLgogICAgICAgICAgICBsaXN0MjogVGhlIHNlY29uZCBsaXN0IHRvIGNvbXBhcmUuCiAgICAgICAgICAgIG1zZzogT3B0aW9uYWwgbWVzc2FnZSB0byB1c2Ugb24gZmFpbHVyZSBpbnN0ZWFkIG9mIGEgbGlzdCBvZgogICAgICAgICAgICAgICAgICAgIGRpZmZlcmVuY2VzLgoKICAgICAgICAiIiIKICAgICAgICBzZWxmLmFzc2VydFNlcXVlbmNlRXF1YWwobGlzdDEsIGxpc3QyLCBtc2csIHNlcV90eXBlPWxpc3QpCgogICAgZGVmIGFzc2VydFR1cGxlRXF1YWwoc2VsZiwgdHVwbGUxLCB0dXBsZTIsIG1zZz1Ob25lKToKICAgICAgICAiIiJBIHR1cGxlLXNwZWNpZmljIGVxdWFsaXR5IGFzc2VydGlvbi4KCiAgICAgICAgQXJnczoKICAgICAgICAgICAgdHVwbGUxOiBUaGUgZmlyc3QgdHVwbGUgdG8gY29tcGFyZS4KICAgICAgICAgICAgdHVwbGUyOiBUaGUgc2Vjb25kIHR1cGxlIHRvIGNvbXBhcmUuCiAgICAgICAgICAgIG1zZzogT3B0aW9uYWwgbWVzc2FnZSB0byB1c2Ugb24gZmFpbHVyZSBpbnN0ZWFkIG9mIGEgbGlzdCBvZgogICAgICAgICAgICAgICAgICAgIGRpZmZlcmVuY2VzLgogICAgICAgICIiIgogICAgICAgIHNlbGYuYXNzZXJ0U2VxdWVuY2VFcXVhbCh0dXBsZTEsIHR1cGxlMiwgbXNnLCBzZXFfdHlwZT10dXBsZSkKCiAgICBkZWYgYXNzZXJ0U2V0RXF1YWwoc2VsZiwgc2V0MSwgc2V0MiwgbXNnPU5vbmUpOgogICAgICAgICIiIkEgc2V0LXNwZWNpZmljIGVxdWFsaXR5IGFzc2VydGlvbi4KCiAgICAgICAgQXJnczoKICAgICAgICAgICAgc2V0MTogVGhlIGZpcnN0IHNldCB0byBjb21wYXJlLgogICAgICAgICAgICBzZXQyOiBUaGUgc2Vjb25kIHNldCB0byBjb21wYXJlLgogICAgICAgICAgICBtc2c6IE9wdGlvbmFsIG1lc3NhZ2UgdG8gdXNlIG9uIGZhaWx1cmUgaW5zdGVhZCBvZiBhIGxpc3Qgb2YKICAgICAgICAgICAgICAgICAgICBkaWZmZXJlbmNlcy4KCiAgICAgICAgYXNzZXJ0U2V0RXF1YWwgdXNlcyBkdWNrdHlwaW5nIHRvIHN1cHBvcnQgZGlmZmVyZW50IHR5cGVzIG9mIHNldHMsIGFuZAogICAgICAgIGlzIG9wdGltaXplZCBmb3Igc2V0cyBzcGVjaWZpY2FsbHkgKHBhcmFtZXRlcnMgbXVzdCBzdXBwb3J0IGEKICAgICAgICBkaWZmZXJlbmNlIG1ldGhvZCkuCiAgICAgICAgIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBkaWZmZXJlbmNlMSA9IHNldDEuZGlmZmVyZW5jZShzZXQyKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5mYWlsKCdpbnZhbGlkIHR5cGUgd2hlbiBhdHRlbXB0aW5nIHNldCBkaWZmZXJlbmNlOiAlcycgJSBlKQogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvciBhcyBlOgogICAgICAgICAgICBzZWxmLmZhaWwoJ2ZpcnN0IGFyZ3VtZW50IGRvZXMgbm90IHN1cHBvcnQgc2V0IGRpZmZlcmVuY2U6ICVzJyAlIGUpCgogICAgICAgIHRyeToKICAgICAgICAgICAgZGlmZmVyZW5jZTIgPSBzZXQyLmRpZmZlcmVuY2Uoc2V0MSkKICAgICAgICBleGNlcHQgVHlwZUVycm9yIGFzIGU6CiAgICAgICAgICAgIHNlbGYuZmFpbCgnaW52YWxpZCB0eXBlIHdoZW4gYXR0ZW1wdGluZyBzZXQgZGlmZmVyZW5jZTogJXMnICUgZSkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5mYWlsKCdzZWNvbmQgYXJndW1lbnQgZG9lcyBub3Qgc3VwcG9ydCBzZXQgZGlmZmVyZW5jZTogJXMnICUgZSkKCiAgICAgICAgaWYgbm90IChkaWZmZXJlbmNlMSBvciBkaWZmZXJlbmNlMik6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBsaW5lcyA9IFtdCiAgICAgICAgaWYgZGlmZmVyZW5jZTE6CiAgICAgICAgICAgIGxpbmVzLmFwcGVuZCgnSXRlbXMgaW4gdGhlIGZpcnN0IHNldCBidXQgbm90IHRoZSBzZWNvbmQ6JykKICAgICAgICAgICAgZm9yIGl0ZW0gaW4gZGlmZmVyZW5jZTE6CiAgICAgICAgICAgICAgICBsaW5lcy5hcHBlbmQocmVwcihpdGVtKSkKICAgICAgICBpZiBkaWZmZXJlbmNlMjoKICAgICAgICAgICAgbGluZXMuYXBwZW5kKCdJdGVtcyBpbiB0aGUgc2Vjb25kIHNldCBidXQgbm90IHRoZSBmaXJzdDonKQogICAgICAgICAgICBmb3IgaXRlbSBpbiBkaWZmZXJlbmNlMjoKICAgICAgICAgICAgICAgIGxpbmVzLmFwcGVuZChyZXByKGl0ZW0pKQoKICAgICAgICBzdGFuZGFyZE1zZyA9ICdcbicuam9pbihsaW5lcykKICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0SW4oc2VsZiwgbWVtYmVyLCBjb250YWluZXIsIG1zZz1Ob25lKToKICAgICAgICAiIiJKdXN0IGxpa2Ugc2VsZi5hc3NlcnRUcnVlKGEgaW4gYiksIGJ1dCB3aXRoIGEgbmljZXIgZGVmYXVsdCBtZXNzYWdlLiIiIgogICAgICAgIGlmIG1lbWJlciBub3QgaW4gY29udGFpbmVyOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyBub3QgZm91bmQgaW4gJXMnICUgKHNhZmVfcmVwcihtZW1iZXIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhZmVfcmVwcihjb250YWluZXIpKQogICAgICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0Tm90SW4oc2VsZiwgbWVtYmVyLCBjb250YWluZXIsIG1zZz1Ob25lKToKICAgICAgICAiIiJKdXN0IGxpa2Ugc2VsZi5hc3NlcnRUcnVlKGEgbm90IGluIGIpLCBidXQgd2l0aCBhIG5pY2VyIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBtZW1iZXIgaW4gY29udGFpbmVyOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyB1bmV4cGVjdGVkbHkgZm91bmQgaW4gJXMnICUgKHNhZmVfcmVwcihtZW1iZXIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhZmVfcmVwcihjb250YWluZXIpKQogICAgICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0SXMoc2VsZiwgZXhwcjEsIGV4cHIyLCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiSnVzdCBsaWtlIHNlbGYuYXNzZXJ0VHJ1ZShhIGlzIGIpLCBidXQgd2l0aCBhIG5pY2VyIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBleHByMSBpcyBub3QgZXhwcjI6CiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzIGlzIG5vdCAlcycgJSAoc2FmZV9yZXByKGV4cHIxKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKGV4cHIyKSkKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydElzTm90KHNlbGYsIGV4cHIxLCBleHByMiwgbXNnPU5vbmUpOgogICAgICAgICIiIkp1c3QgbGlrZSBzZWxmLmFzc2VydFRydWUoYSBpcyBub3QgYiksIGJ1dCB3aXRoIGEgbmljZXIgZGVmYXVsdCBtZXNzYWdlLiIiIgogICAgICAgIGlmIGV4cHIxIGlzIGV4cHIyOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICd1bmV4cGVjdGVkbHkgaWRlbnRpY2FsOiAlcycgJSAoc2FmZV9yZXByKGV4cHIxKSwpCiAgICAgICAgICAgIHNlbGYuZmFpbChzZWxmLl9mb3JtYXRNZXNzYWdlKG1zZywgc3RhbmRhcmRNc2cpKQoKICAgIGRlZiBhc3NlcnREaWN0RXF1YWwoc2VsZiwgZDEsIGQyLCBtc2c9Tm9uZSk6CiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGQxLCBkaWN0LCAnRmlyc3QgYXJndW1lbnQgaXMgbm90IGEgZGljdGlvbmFyeScpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGQyLCBkaWN0LCAnU2Vjb25kIGFyZ3VtZW50IGlzIG5vdCBhIGRpY3Rpb25hcnknKQoKICAgICAgICBpZiBkMSAhPSBkMjoKICAgICAgICAgICAgc3RhbmRhcmRNc2cgPSAnJXMgIT0gJXMnICUgKHNhZmVfcmVwcihkMSwgVHJ1ZSksIHNhZmVfcmVwcihkMiwgVHJ1ZSkpCiAgICAgICAgICAgIGRpZmYgPSAoJ1xuJyArICdcbicuam9pbihkaWZmbGliLm5kaWZmKAogICAgICAgICAgICAgICAgICAgICAgICAgICBwcHJpbnQucGZvcm1hdChkMSkuc3BsaXRsaW5lcygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICBwcHJpbnQucGZvcm1hdChkMikuc3BsaXRsaW5lcygpKSkpCiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gc2VsZi5fdHJ1bmNhdGVNZXNzYWdlKHN0YW5kYXJkTXNnLCBkaWZmKQogICAgICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0KHNlbGYsIHN1YnNldCwgZGljdGlvbmFyeSwgbXNnPU5vbmUpOgogICAgICAgICIiIkNoZWNrcyB3aGV0aGVyIGRpY3Rpb25hcnkgaXMgYSBzdXBlcnNldCBvZiBzdWJzZXQuIiIiCiAgICAgICAgd2FybmluZ3Mud2FybignYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0IGlzIGRlcHJlY2F0ZWQnLAogICAgICAgICAgICAgICAgICAgICAgRGVwcmVjYXRpb25XYXJuaW5nKQogICAgICAgIG1pc3NpbmcgPSBbXQogICAgICAgIG1pc21hdGNoZWQgPSBbXQogICAgICAgIGZvciBrZXksIHZhbHVlIGluIHN1YnNldC5pdGVtcygpOgogICAgICAgICAgICBpZiBrZXkgbm90IGluIGRpY3Rpb25hcnk6CiAgICAgICAgICAgICAgICBtaXNzaW5nLmFwcGVuZChrZXkpCiAgICAgICAgICAgIGVsaWYgdmFsdWUgIT0gZGljdGlvbmFyeVtrZXldOgogICAgICAgICAgICAgICAgbWlzbWF0Y2hlZC5hcHBlbmQoJyVzLCBleHBlY3RlZDogJXMsIGFjdHVhbDogJXMnICUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChzYWZlX3JlcHIoa2V5KSwgc2FmZV9yZXByKHZhbHVlKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWZlX3JlcHIoZGljdGlvbmFyeVtrZXldKSkpCgogICAgICAgIGlmIG5vdCAobWlzc2luZyBvciBtaXNtYXRjaGVkKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHN0YW5kYXJkTXNnID0gJycKICAgICAgICBpZiBtaXNzaW5nOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICdNaXNzaW5nOiAlcycgJSAnLCcuam9pbihzYWZlX3JlcHIobSkgZm9yIG0gaW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pc3NpbmcpCiAgICAgICAgaWYgbWlzbWF0Y2hlZDoKICAgICAgICAgICAgaWYgc3RhbmRhcmRNc2c6CiAgICAgICAgICAgICAgICBzdGFuZGFyZE1zZyArPSAnOyAnCiAgICAgICAgICAgIHN0YW5kYXJkTXNnICs9ICdNaXNtYXRjaGVkIHZhbHVlczogJXMnICUgJywnLmpvaW4obWlzbWF0Y2hlZCkKCiAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgoKICAgIGRlZiBhc3NlcnRDb3VudEVxdWFsKHNlbGYsIGZpcnN0LCBzZWNvbmQsIG1zZz1Ob25lKToKICAgICAgICAiIiJBbiB1bm9yZGVyZWQgc2VxdWVuY2UgY29tcGFyaXNvbiBhc3NlcnRpbmcgdGhhdCB0aGUgc2FtZSBlbGVtZW50cywKICAgICAgICByZWdhcmRsZXNzIG9mIG9yZGVyLiAgSWYgdGhlIHNhbWUgZWxlbWVudCBvY2N1cnMgbW9yZSB0aGFuIG9uY2UsCiAgICAgICAgaXQgdmVyaWZpZXMgdGhhdCB0aGUgZWxlbWVudHMgb2NjdXIgdGhlIHNhbWUgbnVtYmVyIG9mIHRpbWVzLgoKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChDb3VudGVyKGxpc3QoZmlyc3QpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb3VudGVyKGxpc3Qoc2Vjb25kKSkpCgogICAgICAgICBFeGFtcGxlOgogICAgICAgICAgICAtIFswLCAxLCAxXSBhbmQgWzEsIDAsIDFdIGNvbXBhcmUgZXF1YWwuCiAgICAgICAgICAgIC0gWzAsIDAsIDFdIGFuZCBbMCwgMV0gY29tcGFyZSB1bmVxdWFsLgoKICAgICAgICAiIiIKICAgICAgICBmaXJzdF9zZXEsIHNlY29uZF9zZXEgPSBsaXN0KGZpcnN0KSwgbGlzdChzZWNvbmQpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBmaXJzdCA9IGNvbGxlY3Rpb25zLkNvdW50ZXIoZmlyc3Rfc2VxKQogICAgICAgICAgICBzZWNvbmQgPSBjb2xsZWN0aW9ucy5Db3VudGVyKHNlY29uZF9zZXEpCiAgICAgICAgZXhjZXB0IFR5cGVFcnJvcjoKICAgICAgICAgICAgIyBIYW5kbGUgY2FzZSB3aXRoIHVuaGFzaGFibGUgZWxlbWVudHMKICAgICAgICAgICAgZGlmZmVyZW5jZXMgPSBfY291bnRfZGlmZl9hbGxfcHVycG9zZShmaXJzdF9zZXEsIHNlY29uZF9zZXEpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgZmlyc3QgPT0gc2Vjb25kOgogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGRpZmZlcmVuY2VzID0gX2NvdW50X2RpZmZfaGFzaGFibGUoZmlyc3Rfc2VxLCBzZWNvbmRfc2VxKQoKICAgICAgICBpZiBkaWZmZXJlbmNlczoKICAgICAgICAgICAgc3RhbmRhcmRNc2cgPSAnRWxlbWVudCBjb3VudHMgd2VyZSBub3QgZXF1YWw6XG4nCiAgICAgICAgICAgIGxpbmVzID0gWydGaXJzdCBoYXMgJWQsIFNlY29uZCBoYXMgJWQ6ICAlcicgJSBkaWZmIGZvciBkaWZmIGluIGRpZmZlcmVuY2VzXQogICAgICAgICAgICBkaWZmTXNnID0gJ1xuJy5qb2luKGxpbmVzKQogICAgICAgICAgICBzdGFuZGFyZE1zZyA9IHNlbGYuX3RydW5jYXRlTWVzc2FnZShzdGFuZGFyZE1zZywgZGlmZk1zZykKICAgICAgICAgICAgbXNnID0gc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKQogICAgICAgICAgICBzZWxmLmZhaWwobXNnKQoKICAgIGRlZiBhc3NlcnRNdWx0aUxpbmVFcXVhbChzZWxmLCBmaXJzdCwgc2Vjb25kLCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiQXNzZXJ0IHRoYXQgdHdvIG11bHRpLWxpbmUgc3RyaW5ncyBhcmUgZXF1YWwuIiIiCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGZpcnN0LCBzdHIsICdGaXJzdCBhcmd1bWVudCBpcyBub3QgYSBzdHJpbmcnKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShzZWNvbmQsIHN0ciwgJ1NlY29uZCBhcmd1bWVudCBpcyBub3QgYSBzdHJpbmcnKQoKICAgICAgICBpZiBmaXJzdCAhPSBzZWNvbmQ6CiAgICAgICAgICAgICMgZG9uJ3QgdXNlIGRpZmZsaWIgaWYgdGhlIHN0cmluZ3MgYXJlIHRvbyBsb25nCiAgICAgICAgICAgIGlmIChsZW4oZmlyc3QpID4gc2VsZi5fZGlmZlRocmVzaG9sZCBvcgogICAgICAgICAgICAgICAgbGVuKHNlY29uZCkgPiBzZWxmLl9kaWZmVGhyZXNob2xkKToKICAgICAgICAgICAgICAgIHNlbGYuX2Jhc2VBc3NlcnRFcXVhbChmaXJzdCwgc2Vjb25kLCBtc2cpCiAgICAgICAgICAgIGZpcnN0bGluZXMgPSBmaXJzdC5zcGxpdGxpbmVzKGtlZXBlbmRzPVRydWUpCiAgICAgICAgICAgIHNlY29uZGxpbmVzID0gc2Vjb25kLnNwbGl0bGluZXMoa2VlcGVuZHM9VHJ1ZSkKICAgICAgICAgICAgaWYgbGVuKGZpcnN0bGluZXMpID09IDEgYW5kIGZpcnN0LnN0cmlwKCdcclxuJykgPT0gZmlyc3Q6CiAgICAgICAgICAgICAgICBmaXJzdGxpbmVzID0gW2ZpcnN0ICsgJ1xuJ10KICAgICAgICAgICAgICAgIHNlY29uZGxpbmVzID0gW3NlY29uZCArICdcbiddCiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzICE9ICVzJyAlIChzYWZlX3JlcHIoZmlyc3QsIFRydWUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FmZV9yZXByKHNlY29uZCwgVHJ1ZSkpCiAgICAgICAgICAgIGRpZmYgPSAnXG4nICsgJycuam9pbihkaWZmbGliLm5kaWZmKGZpcnN0bGluZXMsIHNlY29uZGxpbmVzKSkKICAgICAgICAgICAgc3RhbmRhcmRNc2cgPSBzZWxmLl90cnVuY2F0ZU1lc3NhZ2Uoc3RhbmRhcmRNc2csIGRpZmYpCiAgICAgICAgICAgIHNlbGYuZmFpbChzZWxmLl9mb3JtYXRNZXNzYWdlKG1zZywgc3RhbmRhcmRNc2cpKQoKICAgIGRlZiBhc3NlcnRMZXNzKHNlbGYsIGEsIGIsIG1zZz1Ob25lKToKICAgICAgICAiIiJKdXN0IGxpa2Ugc2VsZi5hc3NlcnRUcnVlKGEgPCBiKSwgYnV0IHdpdGggYSBuaWNlciBkZWZhdWx0IG1lc3NhZ2UuIiIiCiAgICAgICAgaWYgbm90IGEgPCBiOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyBub3QgbGVzcyB0aGFuICVzJyAlIChzYWZlX3JlcHIoYSksIHNhZmVfcmVwcihiKSkKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydExlc3NFcXVhbChzZWxmLCBhLCBiLCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiSnVzdCBsaWtlIHNlbGYuYXNzZXJ0VHJ1ZShhIDw9IGIpLCBidXQgd2l0aCBhIG5pY2VyIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBub3QgYSA8PSBiOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyBub3QgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJyAlIChzYWZlX3JlcHIoYSksIHNhZmVfcmVwcihiKSkKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydEdyZWF0ZXIoc2VsZiwgYSwgYiwgbXNnPU5vbmUpOgogICAgICAgICIiIkp1c3QgbGlrZSBzZWxmLmFzc2VydFRydWUoYSA+IGIpLCBidXQgd2l0aCBhIG5pY2VyIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBub3QgYSA+IGI6CiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzIG5vdCBncmVhdGVyIHRoYW4gJXMnICUgKHNhZmVfcmVwcihhKSwgc2FmZV9yZXByKGIpKQogICAgICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0R3JlYXRlckVxdWFsKHNlbGYsIGEsIGIsIG1zZz1Ob25lKToKICAgICAgICAiIiJKdXN0IGxpa2Ugc2VsZi5hc3NlcnRUcnVlKGEgPj0gYiksIGJ1dCB3aXRoIGEgbmljZXIgZGVmYXVsdCBtZXNzYWdlLiIiIgogICAgICAgIGlmIG5vdCBhID49IGI6CiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzIG5vdCBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMnICUgKHNhZmVfcmVwcihhKSwgc2FmZV9yZXByKGIpKQogICAgICAgICAgICBzZWxmLmZhaWwoc2VsZi5fZm9ybWF0TWVzc2FnZShtc2csIHN0YW5kYXJkTXNnKSkKCiAgICBkZWYgYXNzZXJ0SXNOb25lKHNlbGYsIG9iaiwgbXNnPU5vbmUpOgogICAgICAgICIiIlNhbWUgYXMgc2VsZi5hc3NlcnRUcnVlKG9iaiBpcyBOb25lKSwgd2l0aCBhIG5pY2VyIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBvYmogaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzIGlzIG5vdCBOb25lJyAlIChzYWZlX3JlcHIob2JqKSwpCiAgICAgICAgICAgIHNlbGYuZmFpbChzZWxmLl9mb3JtYXRNZXNzYWdlKG1zZywgc3RhbmRhcmRNc2cpKQoKICAgIGRlZiBhc3NlcnRJc05vdE5vbmUoc2VsZiwgb2JqLCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiSW5jbHVkZWQgZm9yIHN5bW1ldHJ5IHdpdGggYXNzZXJ0SXNOb25lLiIiIgogICAgICAgIGlmIG9iaiBpcyBOb25lOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICd1bmV4cGVjdGVkbHkgTm9uZScKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydElzSW5zdGFuY2Uoc2VsZiwgb2JqLCBjbHMsIG1zZz1Ob25lKToKICAgICAgICAiIiJTYW1lIGFzIHNlbGYuYXNzZXJ0VHJ1ZShpc2luc3RhbmNlKG9iaiwgY2xzKSksIHdpdGggYSBuaWNlcgogICAgICAgIGRlZmF1bHQgbWVzc2FnZS4iIiIKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvYmosIGNscyk6CiAgICAgICAgICAgIHN0YW5kYXJkTXNnID0gJyVzIGlzIG5vdCBhbiBpbnN0YW5jZSBvZiAlcicgJSAoc2FmZV9yZXByKG9iaiksIGNscykKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydE5vdElzSW5zdGFuY2Uoc2VsZiwgb2JqLCBjbHMsIG1zZz1Ob25lKToKICAgICAgICAiIiJJbmNsdWRlZCBmb3Igc3ltbWV0cnkgd2l0aCBhc3NlcnRJc0luc3RhbmNlLiIiIgogICAgICAgIGlmIGlzaW5zdGFuY2Uob2JqLCBjbHMpOgogICAgICAgICAgICBzdGFuZGFyZE1zZyA9ICclcyBpcyBhbiBpbnN0YW5jZSBvZiAlcicgJSAoc2FmZV9yZXByKG9iaiksIGNscykKICAgICAgICAgICAgc2VsZi5mYWlsKHNlbGYuX2Zvcm1hdE1lc3NhZ2UobXNnLCBzdGFuZGFyZE1zZykpCgogICAgZGVmIGFzc2VydFJhaXNlc1JlZ2V4KHNlbGYsIGV4cGVjdGVkX2V4Y2VwdGlvbiwgZXhwZWN0ZWRfcmVnZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGFibGVfb2JqPU5vbmUsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgIiIiQXNzZXJ0cyB0aGF0IHRoZSBtZXNzYWdlIGluIGEgcmFpc2VkIGV4Y2VwdGlvbiBtYXRjaGVzIGEgcmVnZXguCgogICAgICAgIEFyZ3M6CiAgICAgICAgICAgIGV4cGVjdGVkX2V4Y2VwdGlvbjogRXhjZXB0aW9uIGNsYXNzIGV4cGVjdGVkIHRvIGJlIHJhaXNlZC4KICAgICAgICAgICAgZXhwZWN0ZWRfcmVnZXg6IFJlZ2V4IChyZSBwYXR0ZXJuIG9iamVjdCBvciBzdHJpbmcpIGV4cGVjdGVkCiAgICAgICAgICAgICAgICAgICAgdG8gYmUgZm91bmQgaW4gZXJyb3IgbWVzc2FnZS4KICAgICAgICAgICAgY2FsbGFibGVfb2JqOiBGdW5jdGlvbiB0byBiZSBjYWxsZWQuCiAgICAgICAgICAgIG1zZzogT3B0aW9uYWwgbWVzc2FnZSB1c2VkIGluIGNhc2Ugb2YgZmFpbHVyZS4gQ2FuIG9ubHkgYmUgdXNlZAogICAgICAgICAgICAgICAgICAgIHdoZW4gYXNzZXJ0UmFpc2VzUmVnZXggaXMgdXNlZCBhcyBhIGNvbnRleHQgbWFuYWdlci4KICAgICAgICAgICAgYXJnczogRXh0cmEgYXJncy4KICAgICAgICAgICAga3dhcmdzOiBFeHRyYSBrd2FyZ3MuCiAgICAgICAgIiIiCiAgICAgICAgY29udGV4dCA9IF9Bc3NlcnRSYWlzZXNDb250ZXh0KGV4cGVjdGVkX2V4Y2VwdGlvbiwgc2VsZiwgY2FsbGFibGVfb2JqLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3RlZF9yZWdleCkKCiAgICAgICAgcmV0dXJuIGNvbnRleHQuaGFuZGxlKCdhc3NlcnRSYWlzZXNSZWdleCcsIGNhbGxhYmxlX29iaiwgYXJncywga3dhcmdzKQoKICAgIGRlZiBhc3NlcnRXYXJuc1JlZ2V4KHNlbGYsIGV4cGVjdGVkX3dhcm5pbmcsIGV4cGVjdGVkX3JlZ2V4LAogICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGFibGVfb2JqPU5vbmUsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgIiIiQXNzZXJ0cyB0aGF0IHRoZSBtZXNzYWdlIGluIGEgdHJpZ2dlcmVkIHdhcm5pbmcgbWF0Y2hlcyBhIHJlZ2V4cC4KICAgICAgICBCYXNpYyBmdW5jdGlvbmluZyBpcyBzaW1pbGFyIHRvIGFzc2VydFdhcm5zKCkgd2l0aCB0aGUgYWRkaXRpb24KICAgICAgICB0aGF0IG9ubHkgd2FybmluZ3Mgd2hvc2UgbWVzc2FnZXMgYWxzbyBtYXRjaCB0aGUgcmVndWxhciBleHByZXNzaW9uCiAgICAgICAgYXJlIGNvbnNpZGVyZWQgc3VjY2Vzc2Z1bCBtYXRjaGVzLgoKICAgICAgICBBcmdzOgogICAgICAgICAgICBleHBlY3RlZF93YXJuaW5nOiBXYXJuaW5nIGNsYXNzIGV4cGVjdGVkIHRvIGJlIHRyaWdnZXJlZC4KICAgICAgICAgICAgZXhwZWN0ZWRfcmVnZXg6IFJlZ2V4IChyZSBwYXR0ZXJuIG9iamVjdCBvciBzdHJpbmcpIGV4cGVjdGVkCiAgICAgICAgICAgICAgICAgICAgdG8gYmUgZm91bmQgaW4gZXJyb3IgbWVzc2FnZS4KICAgICAgICAgICAgY2FsbGFibGVfb2JqOiBGdW5jdGlvbiB0byBiZSBjYWxsZWQuCiAgICAgICAgICAgIG1zZzogT3B0aW9uYWwgbWVzc2FnZSB1c2VkIGluIGNhc2Ugb2YgZmFpbHVyZS4gQ2FuIG9ubHkgYmUgdXNlZAogICAgICAgICAgICAgICAgICAgIHdoZW4gYXNzZXJ0V2FybnNSZWdleCBpcyB1c2VkIGFzIGEgY29udGV4dCBtYW5hZ2VyLgogICAgICAgICAgICBhcmdzOiBFeHRyYSBhcmdzLgogICAgICAgICAgICBrd2FyZ3M6IEV4dHJhIGt3YXJncy4KICAgICAgICAiIiIKICAgICAgICBjb250ZXh0ID0gX0Fzc2VydFdhcm5zQ29udGV4dChleHBlY3RlZF93YXJuaW5nLCBzZWxmLCBjYWxsYWJsZV9vYmosCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWRfcmVnZXgpCiAgICAgICAgcmV0dXJuIGNvbnRleHQuaGFuZGxlKCdhc3NlcnRXYXJuc1JlZ2V4JywgY2FsbGFibGVfb2JqLCBhcmdzLCBrd2FyZ3MpCgogICAgZGVmIGFzc2VydFJlZ2V4KHNlbGYsIHRleHQsIGV4cGVjdGVkX3JlZ2V4LCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiRmFpbCB0aGUgdGVzdCB1bmxlc3MgdGhlIHRleHQgbWF0Y2hlcyB0aGUgcmVndWxhciBleHByZXNzaW9uLiIiIgogICAgICAgIGlmIGlzaW5zdGFuY2UoZXhwZWN0ZWRfcmVnZXgsIChzdHIsIGJ5dGVzKSk6CiAgICAgICAgICAgIGFzc2VydCBleHBlY3RlZF9yZWdleCwgImV4cGVjdGVkX3JlZ2V4IG11c3Qgbm90IGJlIGVtcHR5LiIKICAgICAgICAgICAgZXhwZWN0ZWRfcmVnZXggPSByZS5jb21waWxlKGV4cGVjdGVkX3JlZ2V4KQogICAgICAgIGlmIG5vdCBleHBlY3RlZF9yZWdleC5zZWFyY2godGV4dCk6CiAgICAgICAgICAgIG1zZyA9IG1zZyBvciAiUmVnZXggZGlkbid0IG1hdGNoIgogICAgICAgICAgICBtc2cgPSAnJXM6ICVyIG5vdCBmb3VuZCBpbiAlcicgJSAobXNnLCBleHBlY3RlZF9yZWdleC5wYXR0ZXJuLCB0ZXh0KQogICAgICAgICAgICByYWlzZSBzZWxmLmZhaWx1cmVFeGNlcHRpb24obXNnKQoKICAgIGRlZiBhc3NlcnROb3RSZWdleChzZWxmLCB0ZXh0LCB1bmV4cGVjdGVkX3JlZ2V4LCBtc2c9Tm9uZSk6CiAgICAgICAgIiIiRmFpbCB0aGUgdGVzdCBpZiB0aGUgdGV4dCBtYXRjaGVzIHRoZSByZWd1bGFyIGV4cHJlc3Npb24uIiIiCiAgICAgICAgaWYgaXNpbnN0YW5jZSh1bmV4cGVjdGVkX3JlZ2V4LCAoc3RyLCBieXRlcykpOgogICAgICAgICAgICB1bmV4cGVjdGVkX3JlZ2V4ID0gcmUuY29tcGlsZSh1bmV4cGVjdGVkX3JlZ2V4KQogICAgICAgIG1hdGNoID0gdW5leHBlY3RlZF9yZWdleC5zZWFyY2godGV4dCkKICAgICAgICBpZiBtYXRjaDoKICAgICAgICAgICAgbXNnID0gbXNnIG9yICJSZWdleCBtYXRjaGVkIgogICAgICAgICAgICBtc2cgPSAnJXM6ICVyIG1hdGNoZXMgJXIgaW4gJXInICUgKG1zZywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0W21hdGNoLnN0YXJ0KCk6bWF0Y2guZW5kKCldLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuZXhwZWN0ZWRfcmVnZXgucGF0dGVybiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0KQogICAgICAgICAgICByYWlzZSBzZWxmLmZhaWx1cmVFeGNlcHRpb24obXNnKQoKCiAgICBkZWYgX2RlcHJlY2F0ZShvcmlnaW5hbF9mdW5jKToKICAgICAgICBkZWYgZGVwcmVjYXRlZF9mdW5jKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHdhcm5pbmdzLndhcm4oCiAgICAgICAgICAgICAgICAnUGxlYXNlIHVzZSB7MH0gaW5zdGVhZC4nLmZvcm1hdChvcmlnaW5hbF9mdW5jLl9fbmFtZV9fKSwKICAgICAgICAgICAgICAgIERlcHJlY2F0aW9uV2FybmluZywgMikKICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsX2Z1bmMoKmFyZ3MsICoqa3dhcmdzKQogICAgICAgIHJldHVybiBkZXByZWNhdGVkX2Z1bmMKCiAgICAjIHNlZSAjOTQyNAogICAgZmFpbFVubGVzc0VxdWFsID0gYXNzZXJ0RXF1YWxzID0gX2RlcHJlY2F0ZShhc3NlcnRFcXVhbCkKICAgIGZhaWxJZkVxdWFsID0gYXNzZXJ0Tm90RXF1YWxzID0gX2RlcHJlY2F0ZShhc3NlcnROb3RFcXVhbCkKICAgIGZhaWxVbmxlc3NBbG1vc3RFcXVhbCA9IGFzc2VydEFsbW9zdEVxdWFscyA9IF9kZXByZWNhdGUoYXNzZXJ0QWxtb3N0RXF1YWwpCiAgICBmYWlsSWZBbG1vc3RFcXVhbCA9IGFzc2VydE5vdEFsbW9zdEVxdWFscyA9IF9kZXByZWNhdGUoYXNzZXJ0Tm90QWxtb3N0RXF1YWwpCiAgICBmYWlsVW5sZXNzID0gYXNzZXJ0XyA9IF9kZXByZWNhdGUoYXNzZXJ0VHJ1ZSkKICAgIGZhaWxVbmxlc3NSYWlzZXMgPSBfZGVwcmVjYXRlKGFzc2VydFJhaXNlcykKICAgIGZhaWxJZiA9IF9kZXByZWNhdGUoYXNzZXJ0RmFsc2UpCiAgICBhc3NlcnRSYWlzZXNSZWdleHAgPSBfZGVwcmVjYXRlKGFzc2VydFJhaXNlc1JlZ2V4KQogICAgYXNzZXJ0UmVnZXhwTWF0Y2hlcyA9IF9kZXByZWNhdGUoYXNzZXJ0UmVnZXgpCgoKCmNsYXNzIEZ1bmN0aW9uVGVzdENhc2UoVGVzdENhc2UpOgogICAgIiIiQSB0ZXN0IGNhc2UgdGhhdCB3cmFwcyBhIHRlc3QgZnVuY3Rpb24uCgogICAgVGhpcyBpcyB1c2VmdWwgZm9yIHNsaXBwaW5nIHByZS1leGlzdGluZyB0ZXN0IGZ1bmN0aW9ucyBpbnRvIHRoZQogICAgdW5pdHRlc3QgZnJhbWV3b3JrLiBPcHRpb25hbGx5LCBzZXQtdXAgYW5kIHRpZHktdXAgZnVuY3Rpb25zIGNhbiBiZQogICAgc3VwcGxpZWQuIEFzIHdpdGggVGVzdENhc2UsIHRoZSB0aWR5LXVwICgndGVhckRvd24nKSBmdW5jdGlvbiB3aWxsCiAgICBhbHdheXMgYmUgY2FsbGVkIGlmIHRoZSBzZXQtdXAgKCdzZXRVcCcpIGZ1bmN0aW9uIHJhbiBzdWNjZXNzZnVsbHkuCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgdGVzdEZ1bmMsIHNldFVwPU5vbmUsIHRlYXJEb3duPU5vbmUsIGRlc2NyaXB0aW9uPU5vbmUpOgogICAgICAgIHN1cGVyKEZ1bmN0aW9uVGVzdENhc2UsIHNlbGYpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLl9zZXRVcEZ1bmMgPSBzZXRVcAogICAgICAgIHNlbGYuX3RlYXJEb3duRnVuYyA9IHRlYXJEb3duCiAgICAgICAgc2VsZi5fdGVzdEZ1bmMgPSB0ZXN0RnVuYwogICAgICAgIHNlbGYuX2Rlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24KCiAgICBkZWYgc2V0VXAoc2VsZik6CiAgICAgICAgaWYgc2VsZi5fc2V0VXBGdW5jIGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLl9zZXRVcEZ1bmMoKQoKICAgIGRlZiB0ZWFyRG93bihzZWxmKToKICAgICAgICBpZiBzZWxmLl90ZWFyRG93bkZ1bmMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHNlbGYuX3RlYXJEb3duRnVuYygpCgogICAgZGVmIHJ1blRlc3Qoc2VsZik6CiAgICAgICAgc2VsZi5fdGVzdEZ1bmMoKQoKICAgIGRlZiBpZChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fdGVzdEZ1bmMuX19uYW1lX18KCiAgICBkZWYgX19lcV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvdGhlciwgc2VsZi5fX2NsYXNzX18pOgogICAgICAgICAgICByZXR1cm4gTm90SW1wbGVtZW50ZWQKCiAgICAgICAgcmV0dXJuIHNlbGYuX3NldFVwRnVuYyA9PSBvdGhlci5fc2V0VXBGdW5jIGFuZCBcCiAgICAgICAgICAgICAgIHNlbGYuX3RlYXJEb3duRnVuYyA9PSBvdGhlci5fdGVhckRvd25GdW5jIGFuZCBcCiAgICAgICAgICAgICAgIHNlbGYuX3Rlc3RGdW5jID09IG90aGVyLl90ZXN0RnVuYyBhbmQgXAogICAgICAgICAgICAgICBzZWxmLl9kZXNjcmlwdGlvbiA9PSBvdGhlci5fZGVzY3JpcHRpb24KCiAgICBkZWYgX19uZV9fKHNlbGYsIG90aGVyKToKICAgICAgICByZXR1cm4gbm90IHNlbGYgPT0gb3RoZXIKCiAgICBkZWYgX19oYXNoX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGhhc2goKHR5cGUoc2VsZiksIHNlbGYuX3NldFVwRnVuYywgc2VsZi5fdGVhckRvd25GdW5jLAogICAgICAgICAgICAgICAgICAgICBzZWxmLl90ZXN0RnVuYywgc2VsZi5fZGVzY3JpcHRpb24pKQoKICAgIGRlZiBfX3N0cl9fKHNlbGYpOgogICAgICAgIHJldHVybiAiJXMgKCVzKSIgJSAoc3RyY2xhc3Moc2VsZi5fX2NsYXNzX18pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fdGVzdEZ1bmMuX19uYW1lX18pCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiAiPCVzIHRlYz0lcz4iICUgKHN0cmNsYXNzKHNlbGYuX19jbGFzc19fKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3Rlc3RGdW5jKQoKICAgIGRlZiBzaG9ydERlc2NyaXB0aW9uKHNlbGYpOgogICAgICAgIGlmIHNlbGYuX2Rlc2NyaXB0aW9uIGlzIG5vdCBOb25lOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fZGVzY3JpcHRpb24KICAgICAgICBkb2MgPSBzZWxmLl90ZXN0RnVuYy5fX2RvY19fCiAgICAgICAgcmV0dXJuIGRvYyBhbmQgZG9jLnNwbGl0KCJcbiIpWzBdLnN0cmlwKCkgb3IgTm9uZQo=',
'/Lib/unittest/loader.py':'IiIiTG9hZGluZyB1bml0dGVzdHMuIiIiCgppbXBvcnQgb3MKaW1wb3J0IHJlCmltcG9ydCBzeXMKaW1wb3J0IHRyYWNlYmFjawppbXBvcnQgdHlwZXMKaW1wb3J0IGZ1bmN0b29scwoKZnJvbSBmbm1hdGNoIGltcG9ydCBmbm1hdGNoCgpmcm9tIC4gaW1wb3J0IGNhc2UsIHN1aXRlLCB1dGlsCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKIyB3aGF0IGFib3V0IC5weWMgb3IgLnB5byAoZXRjKQojIHdlIHdvdWxkIG5lZWQgdG8gYXZvaWQgbG9hZGluZyB0aGUgc2FtZSB0ZXN0cyBtdWx0aXBsZSB0aW1lcwojIGZyb20gJy5weScsICcucHljJyAqYW5kKiAnLnB5bycKVkFMSURfTU9EVUxFX05BTUUgPSByZS5jb21waWxlKHInW19hLXpdXHcqXC5weSQnLCByZS5JR05PUkVDQVNFKQoKCmRlZiBfbWFrZV9mYWlsZWRfaW1wb3J0X3Rlc3QobmFtZSwgc3VpdGVDbGFzcyk6CiAgICBtZXNzYWdlID0gJ0ZhaWxlZCB0byBpbXBvcnQgdGVzdCBtb2R1bGU6ICVzXG4lcycgJSAobmFtZSwgdHJhY2ViYWNrLmZvcm1hdF9leGMoKSkKICAgIHJldHVybiBfbWFrZV9mYWlsZWRfdGVzdCgnTW9kdWxlSW1wb3J0RmFpbHVyZScsIG5hbWUsIEltcG9ydEVycm9yKG1lc3NhZ2UpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1aXRlQ2xhc3MpCgpkZWYgX21ha2VfZmFpbGVkX2xvYWRfdGVzdHMobmFtZSwgZXhjZXB0aW9uLCBzdWl0ZUNsYXNzKToKICAgIHJldHVybiBfbWFrZV9mYWlsZWRfdGVzdCgnTG9hZFRlc3RzRmFpbHVyZScsIG5hbWUsIGV4Y2VwdGlvbiwgc3VpdGVDbGFzcykKCmRlZiBfbWFrZV9mYWlsZWRfdGVzdChjbGFzc25hbWUsIG1ldGhvZG5hbWUsIGV4Y2VwdGlvbiwgc3VpdGVDbGFzcyk6CiAgICBkZWYgdGVzdEZhaWx1cmUoc2VsZik6CiAgICAgICAgcmFpc2UgZXhjZXB0aW9uCiAgICBhdHRycyA9IHttZXRob2RuYW1lOiB0ZXN0RmFpbHVyZX0KICAgIFRlc3RDbGFzcyA9IHR5cGUoY2xhc3NuYW1lLCAoY2FzZS5UZXN0Q2FzZSwpLCBhdHRycykKICAgIHJldHVybiBzdWl0ZUNsYXNzKChUZXN0Q2xhc3MobWV0aG9kbmFtZSksKSkKCmRlZiBfanl0aG9uX2F3YXJlX3NwbGl0ZXh0KHBhdGgpOgogICAgaWYgcGF0aC5sb3dlcigpLmVuZHN3aXRoKCckcHkuY2xhc3MnKToKICAgICAgICByZXR1cm4gcGF0aFs6LTldCiAgICByZXR1cm4gb3MucGF0aC5zcGxpdGV4dChwYXRoKVswXQoKCmNsYXNzIFRlc3RMb2FkZXIob2JqZWN0KToKICAgICIiIgogICAgVGhpcyBjbGFzcyBpcyByZXNwb25zaWJsZSBmb3IgbG9hZGluZyB0ZXN0cyBhY2NvcmRpbmcgdG8gdmFyaW91cyBjcml0ZXJpYQogICAgYW5kIHJldHVybmluZyB0aGVtIHdyYXBwZWQgaW4gYSBUZXN0U3VpdGUKICAgICIiIgogICAgdGVzdE1ldGhvZFByZWZpeCA9ICd0ZXN0JwogICAgc29ydFRlc3RNZXRob2RzVXNpbmcgPSBzdGF0aWNtZXRob2QodXRpbC50aHJlZV93YXlfY21wKQogICAgc3VpdGVDbGFzcyA9IHN1aXRlLlRlc3RTdWl0ZQogICAgX3RvcF9sZXZlbF9kaXIgPSBOb25lCgogICAgZGVmIGxvYWRUZXN0c0Zyb21UZXN0Q2FzZShzZWxmLCB0ZXN0Q2FzZUNsYXNzKToKICAgICAgICAiIiJSZXR1cm4gYSBzdWl0ZSBvZiBhbGwgdGVzdHMgY2FzZXMgY29udGFpbmVkIGluIHRlc3RDYXNlQ2xhc3MiIiIKICAgICAgICBpZiBpc3N1YmNsYXNzKHRlc3RDYXNlQ2xhc3MsIHN1aXRlLlRlc3RTdWl0ZSk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiVGVzdCBjYXNlcyBzaG91bGQgbm90IGJlIGRlcml2ZWQgZnJvbSBUZXN0U3VpdGUuIiBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBNYXliZSB5b3UgbWVhbnQgdG8gZGVyaXZlIGZyb20gVGVzdENhc2U/IikKICAgICAgICB0ZXN0Q2FzZU5hbWVzID0gc2VsZi5nZXRUZXN0Q2FzZU5hbWVzKHRlc3RDYXNlQ2xhc3MpCiAgICAgICAgaWYgbm90IHRlc3RDYXNlTmFtZXMgYW5kIGhhc2F0dHIodGVzdENhc2VDbGFzcywgJ3J1blRlc3QnKToKICAgICAgICAgICAgdGVzdENhc2VOYW1lcyA9IFsncnVuVGVzdCddCiAgICAgICAgbG9hZGVkX3N1aXRlID0gc2VsZi5zdWl0ZUNsYXNzKG1hcCh0ZXN0Q2FzZUNsYXNzLCB0ZXN0Q2FzZU5hbWVzKSkKICAgICAgICByZXR1cm4gbG9hZGVkX3N1aXRlCgogICAgZGVmIGxvYWRUZXN0c0Zyb21Nb2R1bGUoc2VsZiwgbW9kdWxlLCB1c2VfbG9hZF90ZXN0cz1UcnVlKToKICAgICAgICAiIiJSZXR1cm4gYSBzdWl0ZSBvZiBhbGwgdGVzdHMgY2FzZXMgY29udGFpbmVkIGluIHRoZSBnaXZlbiBtb2R1bGUiIiIKICAgICAgICB0ZXN0cyA9IFtdCiAgICAgICAgZm9yIG5hbWUgaW4gZGlyKG1vZHVsZSk6CiAgICAgICAgICAgIG9iaiA9IGdldGF0dHIobW9kdWxlLCBuYW1lKQogICAgICAgICAgICBpZiBpc2luc3RhbmNlKG9iaiwgdHlwZSkgYW5kIGlzc3ViY2xhc3Mob2JqLCBjYXNlLlRlc3RDYXNlKToKICAgICAgICAgICAgICAgIHRlc3RzLmFwcGVuZChzZWxmLmxvYWRUZXN0c0Zyb21UZXN0Q2FzZShvYmopKQoKICAgICAgICBsb2FkX3Rlc3RzID0gZ2V0YXR0cihtb2R1bGUsICdsb2FkX3Rlc3RzJywgTm9uZSkKICAgICAgICB0ZXN0cyA9IHNlbGYuc3VpdGVDbGFzcyh0ZXN0cykKICAgICAgICBpZiB1c2VfbG9hZF90ZXN0cyBhbmQgbG9hZF90ZXN0cyBpcyBub3QgTm9uZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRfdGVzdHMoc2VsZiwgdGVzdHMsIE5vbmUpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHJldHVybiBfbWFrZV9mYWlsZWRfbG9hZF90ZXN0cyhtb2R1bGUuX19uYW1lX18sIGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zdWl0ZUNsYXNzKQogICAgICAgIHJldHVybiB0ZXN0cwoKICAgIGRlZiBsb2FkVGVzdHNGcm9tTmFtZShzZWxmLCBuYW1lLCBtb2R1bGU9Tm9uZSk6CiAgICAgICAgIiIiUmV0dXJuIGEgc3VpdGUgb2YgYWxsIHRlc3RzIGNhc2VzIGdpdmVuIGEgc3RyaW5nIHNwZWNpZmllci4KCiAgICAgICAgVGhlIG5hbWUgbWF5IHJlc29sdmUgZWl0aGVyIHRvIGEgbW9kdWxlLCBhIHRlc3QgY2FzZSBjbGFzcywgYQogICAgICAgIHRlc3QgbWV0aG9kIHdpdGhpbiBhIHRlc3QgY2FzZSBjbGFzcywgb3IgYSBjYWxsYWJsZSBvYmplY3Qgd2hpY2gKICAgICAgICByZXR1cm5zIGEgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlLgoKICAgICAgICBUaGUgbWV0aG9kIG9wdGlvbmFsbHkgcmVzb2x2ZXMgdGhlIG5hbWVzIHJlbGF0aXZlIHRvIGEgZ2l2ZW4gbW9kdWxlLgogICAgICAgICIiIgogICAgICAgIHBhcnRzID0gbmFtZS5zcGxpdCgnLicpCiAgICAgICAgaWYgbW9kdWxlIGlzIE5vbmU6CiAgICAgICAgICAgIHBhcnRzX2NvcHkgPSBwYXJ0c1s6XQogICAgICAgICAgICB3aGlsZSBwYXJ0c19jb3B5OgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIG1vZHVsZSA9IF9faW1wb3J0X18oJy4nLmpvaW4ocGFydHNfY29weSkpCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgICAgICAgICAgICAgICAgICBkZWwgcGFydHNfY29weVstMV0KICAgICAgICAgICAgICAgICAgICBpZiBub3QgcGFydHNfY29weToKICAgICAgICAgICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgcGFydHMgPSBwYXJ0c1sxOl0KICAgICAgICBvYmogPSBtb2R1bGUKICAgICAgICBmb3IgcGFydCBpbiBwYXJ0czoKICAgICAgICAgICAgcGFyZW50LCBvYmogPSBvYmosIGdldGF0dHIob2JqLCBwYXJ0KQoKICAgICAgICBpZiBpc2luc3RhbmNlKG9iaiwgdHlwZXMuTW9kdWxlVHlwZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmxvYWRUZXN0c0Zyb21Nb2R1bGUob2JqKQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShvYmosIHR5cGUpIGFuZCBpc3N1YmNsYXNzKG9iaiwgY2FzZS5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmxvYWRUZXN0c0Zyb21UZXN0Q2FzZShvYmopCiAgICAgICAgZWxpZiAoaXNpbnN0YW5jZShvYmosIHR5cGVzLkZ1bmN0aW9uVHlwZSkgYW5kCiAgICAgICAgICAgICAgaXNpbnN0YW5jZShwYXJlbnQsIHR5cGUpIGFuZAogICAgICAgICAgICAgIGlzc3ViY2xhc3MocGFyZW50LCBjYXNlLlRlc3RDYXNlKSk6CiAgICAgICAgICAgIG5hbWUgPSBvYmouX19uYW1lX18KICAgICAgICAgICAgaW5zdCA9IHBhcmVudChuYW1lKQogICAgICAgICAgICAjIHN0YXRpYyBtZXRob2RzIGZvbGxvdyBhIGRpZmZlcmVudCBwYXRoCiAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKGdldGF0dHIoaW5zdCwgbmFtZSksIHR5cGVzLkZ1bmN0aW9uVHlwZSk6CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5zdWl0ZUNsYXNzKFtpbnN0XSkKICAgICAgICBlbGlmIGlzaW5zdGFuY2Uob2JqLCBzdWl0ZS5UZXN0U3VpdGUpOgogICAgICAgICAgICByZXR1cm4gb2JqCiAgICAgICAgaWYgY2FsbGFibGUob2JqKToKICAgICAgICAgICAgdGVzdCA9IG9iaigpCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodGVzdCwgc3VpdGUuVGVzdFN1aXRlKToKICAgICAgICAgICAgICAgIHJldHVybiB0ZXN0CiAgICAgICAgICAgIGVsaWYgaXNpbnN0YW5jZSh0ZXN0LCBjYXNlLlRlc3RDYXNlKToKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnN1aXRlQ2xhc3MoW3Rlc3RdKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJjYWxsaW5nICVzIHJldHVybmVkICVzLCBub3QgYSB0ZXN0IiAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG9iaiwgdGVzdCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJkb24ndCBrbm93IGhvdyB0byBtYWtlIHRlc3QgZnJvbTogJXMiICUgb2JqKQoKICAgIGRlZiBsb2FkVGVzdHNGcm9tTmFtZXMoc2VsZiwgbmFtZXMsIG1vZHVsZT1Ob25lKToKICAgICAgICAiIiJSZXR1cm4gYSBzdWl0ZSBvZiBhbGwgdGVzdHMgY2FzZXMgZm91bmQgdXNpbmcgdGhlIGdpdmVuIHNlcXVlbmNlCiAgICAgICAgb2Ygc3RyaW5nIHNwZWNpZmllcnMuIFNlZSAnbG9hZFRlc3RzRnJvbU5hbWUoKScuCiAgICAgICAgIiIiCiAgICAgICAgc3VpdGVzID0gW3NlbGYubG9hZFRlc3RzRnJvbU5hbWUobmFtZSwgbW9kdWxlKSBmb3IgbmFtZSBpbiBuYW1lc10KICAgICAgICByZXR1cm4gc2VsZi5zdWl0ZUNsYXNzKHN1aXRlcykKCiAgICBkZWYgZ2V0VGVzdENhc2VOYW1lcyhzZWxmLCB0ZXN0Q2FzZUNsYXNzKToKICAgICAgICAiIiJSZXR1cm4gYSBzb3J0ZWQgc2VxdWVuY2Ugb2YgbWV0aG9kIG5hbWVzIGZvdW5kIHdpdGhpbiB0ZXN0Q2FzZUNsYXNzCiAgICAgICAgIiIiCiAgICAgICAgZGVmIGlzVGVzdE1ldGhvZChhdHRybmFtZSwgdGVzdENhc2VDbGFzcz10ZXN0Q2FzZUNsYXNzLAogICAgICAgICAgICAgICAgICAgICAgICAgcHJlZml4PXNlbGYudGVzdE1ldGhvZFByZWZpeCk6CiAgICAgICAgICAgIHJldHVybiBhdHRybmFtZS5zdGFydHN3aXRoKHByZWZpeCkgYW5kIFwKICAgICAgICAgICAgICAgIGNhbGxhYmxlKGdldGF0dHIodGVzdENhc2VDbGFzcywgYXR0cm5hbWUpKQogICAgICAgIHRlc3RGbk5hbWVzID0gbGlzdChmaWx0ZXIoaXNUZXN0TWV0aG9kLCBkaXIodGVzdENhc2VDbGFzcykpKQogICAgICAgIGlmIHNlbGYuc29ydFRlc3RNZXRob2RzVXNpbmc6CiAgICAgICAgICAgIHRlc3RGbk5hbWVzLnNvcnQoa2V5PWZ1bmN0b29scy5jbXBfdG9fa2V5KHNlbGYuc29ydFRlc3RNZXRob2RzVXNpbmcpKQogICAgICAgIHJldHVybiB0ZXN0Rm5OYW1lcwoKICAgIGRlZiBkaXNjb3ZlcihzZWxmLCBzdGFydF9kaXIsIHBhdHRlcm49J3Rlc3QqLnB5JywgdG9wX2xldmVsX2Rpcj1Ob25lKToKICAgICAgICAiIiJGaW5kIGFuZCByZXR1cm4gYWxsIHRlc3QgbW9kdWxlcyBmcm9tIHRoZSBzcGVjaWZpZWQgc3RhcnQKICAgICAgICBkaXJlY3RvcnksIHJlY3Vyc2luZyBpbnRvIHN1YmRpcmVjdG9yaWVzIHRvIGZpbmQgdGhlbSBhbmQgcmV0dXJuIGFsbAogICAgICAgIHRlc3RzIGZvdW5kIHdpdGhpbiB0aGVtLiBPbmx5IHRlc3QgZmlsZXMgdGhhdCBtYXRjaCB0aGUgcGF0dGVybiB3aWxsCiAgICAgICAgYmUgbG9hZGVkLiAoVXNpbmcgc2hlbGwgc3R5bGUgcGF0dGVybiBtYXRjaGluZy4pCgogICAgICAgIEFsbCB0ZXN0IG1vZHVsZXMgbXVzdCBiZSBpbXBvcnRhYmxlIGZyb20gdGhlIHRvcCBsZXZlbCBvZiB0aGUgcHJvamVjdC4KICAgICAgICBJZiB0aGUgc3RhcnQgZGlyZWN0b3J5IGlzIG5vdCB0aGUgdG9wIGxldmVsIGRpcmVjdG9yeSB0aGVuIHRoZSB0b3AKICAgICAgICBsZXZlbCBkaXJlY3RvcnkgbXVzdCBiZSBzcGVjaWZpZWQgc2VwYXJhdGVseS4KCiAgICAgICAgSWYgYSB0ZXN0IHBhY2thZ2UgbmFtZSAoZGlyZWN0b3J5IHdpdGggJ19faW5pdF9fLnB5JykgbWF0Y2hlcyB0aGUKICAgICAgICBwYXR0ZXJuIHRoZW4gdGhlIHBhY2thZ2Ugd2lsbCBiZSBjaGVja2VkIGZvciBhICdsb2FkX3Rlc3RzJyBmdW5jdGlvbi4gSWYKICAgICAgICB0aGlzIGV4aXN0cyB0aGVuIGl0IHdpbGwgYmUgY2FsbGVkIHdpdGggbG9hZGVyLCB0ZXN0cywgcGF0dGVybi4KCiAgICAgICAgSWYgbG9hZF90ZXN0cyBleGlzdHMgdGhlbiBkaXNjb3ZlcnkgZG9lcyAgKm5vdCogcmVjdXJzZSBpbnRvIHRoZSBwYWNrYWdlLAogICAgICAgIGxvYWRfdGVzdHMgaXMgcmVzcG9uc2libGUgZm9yIGxvYWRpbmcgYWxsIHRlc3RzIGluIHRoZSBwYWNrYWdlLgoKICAgICAgICBUaGUgcGF0dGVybiBpcyBkZWxpYmVyYXRlbHkgbm90IHN0b3JlZCBhcyBhIGxvYWRlciBhdHRyaWJ1dGUgc28gdGhhdAogICAgICAgIHBhY2thZ2VzIGNhbiBjb250aW51ZSBkaXNjb3ZlcnkgdGhlbXNlbHZlcy4gdG9wX2xldmVsX2RpciBpcyBzdG9yZWQgc28KICAgICAgICBsb2FkX3Rlc3RzIGRvZXMgbm90IG5lZWQgdG8gcGFzcyB0aGlzIGFyZ3VtZW50IGluIHRvIGxvYWRlci5kaXNjb3ZlcigpLgogICAgICAgICIiIgogICAgICAgIHNldF9pbXBsaWNpdF90b3AgPSBGYWxzZQogICAgICAgIGlmIHRvcF9sZXZlbF9kaXIgaXMgTm9uZSBhbmQgc2VsZi5fdG9wX2xldmVsX2RpciBpcyBub3QgTm9uZToKICAgICAgICAgICAgIyBtYWtlIHRvcF9sZXZlbF9kaXIgb3B0aW9uYWwgaWYgY2FsbGVkIGZyb20gbG9hZF90ZXN0cyBpbiBhIHBhY2thZ2UKICAgICAgICAgICAgdG9wX2xldmVsX2RpciA9IHNlbGYuX3RvcF9sZXZlbF9kaXIKICAgICAgICBlbGlmIHRvcF9sZXZlbF9kaXIgaXMgTm9uZToKICAgICAgICAgICAgc2V0X2ltcGxpY2l0X3RvcCA9IFRydWUKICAgICAgICAgICAgdG9wX2xldmVsX2RpciA9IHN0YXJ0X2RpcgoKICAgICAgICB0b3BfbGV2ZWxfZGlyID0gb3MucGF0aC5hYnNwYXRoKHRvcF9sZXZlbF9kaXIpCgogICAgICAgIGlmIG5vdCB0b3BfbGV2ZWxfZGlyIGluIHN5cy5wYXRoOgogICAgICAgICAgICAjIGFsbCB0ZXN0IG1vZHVsZXMgbXVzdCBiZSBpbXBvcnRhYmxlIGZyb20gdGhlIHRvcCBsZXZlbCBkaXJlY3RvcnkKICAgICAgICAgICAgIyBzaG91bGQgd2UgKnVuY29uZGl0aW9uYWxseSogcHV0IHRoZSBzdGFydCBkaXJlY3RvcnkgaW4gZmlyc3QKICAgICAgICAgICAgIyBpbiBzeXMucGF0aCB0byBtaW5pbWlzZSBsaWtlbGlob29kIG9mIGNvbmZsaWN0cyBiZXR3ZWVuIGluc3RhbGxlZAogICAgICAgICAgICAjIG1vZHVsZXMgYW5kIGRldmVsb3BtZW50IHZlcnNpb25zPwogICAgICAgICAgICBzeXMucGF0aC5pbnNlcnQoMCwgdG9wX2xldmVsX2RpcikKICAgICAgICBzZWxmLl90b3BfbGV2ZWxfZGlyID0gdG9wX2xldmVsX2RpcgoKICAgICAgICBpc19ub3RfaW1wb3J0YWJsZSA9IEZhbHNlCiAgICAgICAgaWYgb3MucGF0aC5pc2Rpcihvcy5wYXRoLmFic3BhdGgoc3RhcnRfZGlyKSk6CiAgICAgICAgICAgIHN0YXJ0X2RpciA9IG9zLnBhdGguYWJzcGF0aChzdGFydF9kaXIpCiAgICAgICAgICAgIGlmIHN0YXJ0X2RpciAhPSB0b3BfbGV2ZWxfZGlyOgogICAgICAgICAgICAgICAgaXNfbm90X2ltcG9ydGFibGUgPSBub3Qgb3MucGF0aC5pc2ZpbGUob3MucGF0aC5qb2luKHN0YXJ0X2RpciwgJ19faW5pdF9fLnB5JykpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyBzdXBwb3J0IGZvciBkaXNjb3ZlcnkgZnJvbSBkb3R0ZWQgbW9kdWxlIG5hbWVzCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIF9faW1wb3J0X18oc3RhcnRfZGlyKQogICAgICAgICAgICBleGNlcHQgSW1wb3J0RXJyb3I6CiAgICAgICAgICAgICAgICBpc19ub3RfaW1wb3J0YWJsZSA9IFRydWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRoZV9tb2R1bGUgPSBzeXMubW9kdWxlc1tzdGFydF9kaXJdCiAgICAgICAgICAgICAgICB0b3BfcGFydCA9IHN0YXJ0X2Rpci5zcGxpdCgnLicpWzBdCiAgICAgICAgICAgICAgICBzdGFydF9kaXIgPSBvcy5wYXRoLmFic3BhdGgob3MucGF0aC5kaXJuYW1lKCh0aGVfbW9kdWxlLl9fZmlsZV9fKSkpCiAgICAgICAgICAgICAgICBpZiBzZXRfaW1wbGljaXRfdG9wOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX3RvcF9sZXZlbF9kaXIgPSBzZWxmLl9nZXRfZGlyZWN0b3J5X2NvbnRhaW5pbmdfbW9kdWxlKHRvcF9wYXJ0KQogICAgICAgICAgICAgICAgICAgIHN5cy5wYXRoLnJlbW92ZSh0b3BfbGV2ZWxfZGlyKQoKICAgICAgICBpZiBpc19ub3RfaW1wb3J0YWJsZToKICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IoJ1N0YXJ0IGRpcmVjdG9yeSBpcyBub3QgaW1wb3J0YWJsZTogJXInICUgc3RhcnRfZGlyKQoKICAgICAgICB0ZXN0cyA9IGxpc3Qoc2VsZi5fZmluZF90ZXN0cyhzdGFydF9kaXIsIHBhdHRlcm4pKQogICAgICAgIHJldHVybiBzZWxmLnN1aXRlQ2xhc3ModGVzdHMpCgogICAgZGVmIF9nZXRfZGlyZWN0b3J5X2NvbnRhaW5pbmdfbW9kdWxlKHNlbGYsIG1vZHVsZV9uYW1lKToKICAgICAgICBtb2R1bGUgPSBzeXMubW9kdWxlc1ttb2R1bGVfbmFtZV0KICAgICAgICBmdWxsX3BhdGggPSBvcy5wYXRoLmFic3BhdGgobW9kdWxlLl9fZmlsZV9fKQoKICAgICAgICBpZiBvcy5wYXRoLmJhc2VuYW1lKGZ1bGxfcGF0aCkubG93ZXIoKS5zdGFydHN3aXRoKCdfX2luaXRfXy5weScpOgogICAgICAgICAgICByZXR1cm4gb3MucGF0aC5kaXJuYW1lKG9zLnBhdGguZGlybmFtZShmdWxsX3BhdGgpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgaGVyZSB3ZSBoYXZlIGJlZW4gZ2l2ZW4gYSBtb2R1bGUgcmF0aGVyIHRoYW4gYSBwYWNrYWdlIC0gc28KICAgICAgICAgICAgIyBhbGwgd2UgY2FuIGRvIGlzIHNlYXJjaCB0aGUgKnNhbWUqIGRpcmVjdG9yeSB0aGUgbW9kdWxlIGlzIGluCiAgICAgICAgICAgICMgc2hvdWxkIGFuIGV4Y2VwdGlvbiBiZSByYWlzZWQgaW5zdGVhZAogICAgICAgICAgICByZXR1cm4gb3MucGF0aC5kaXJuYW1lKGZ1bGxfcGF0aCkKCiAgICBkZWYgX2dldF9uYW1lX2Zyb21fcGF0aChzZWxmLCBwYXRoKToKICAgICAgICBwYXRoID0gX2p5dGhvbl9hd2FyZV9zcGxpdGV4dChvcy5wYXRoLm5vcm1wYXRoKHBhdGgpKQoKICAgICAgICBfcmVscGF0aCA9IG9zLnBhdGgucmVscGF0aChwYXRoLCBzZWxmLl90b3BfbGV2ZWxfZGlyKQogICAgICAgIGFzc2VydCBub3Qgb3MucGF0aC5pc2FicyhfcmVscGF0aCksICJQYXRoIG11c3QgYmUgd2l0aGluIHRoZSBwcm9qZWN0IgogICAgICAgIGFzc2VydCBub3QgX3JlbHBhdGguc3RhcnRzd2l0aCgnLi4nKSwgIlBhdGggbXVzdCBiZSB3aXRoaW4gdGhlIHByb2plY3QiCgogICAgICAgIG5hbWUgPSBfcmVscGF0aC5yZXBsYWNlKG9zLnBhdGguc2VwLCAnLicpCiAgICAgICAgcmV0dXJuIG5hbWUKCiAgICBkZWYgX2dldF9tb2R1bGVfZnJvbV9uYW1lKHNlbGYsIG5hbWUpOgogICAgICAgIF9faW1wb3J0X18obmFtZSkKICAgICAgICByZXR1cm4gc3lzLm1vZHVsZXNbbmFtZV0KCiAgICBkZWYgX21hdGNoX3BhdGgoc2VsZiwgcGF0aCwgZnVsbF9wYXRoLCBwYXR0ZXJuKToKICAgICAgICAjIG92ZXJyaWRlIHRoaXMgbWV0aG9kIHRvIHVzZSBhbHRlcm5hdGl2ZSBtYXRjaGluZyBzdHJhdGVneQogICAgICAgIHJldHVybiBmbm1hdGNoKHBhdGgsIHBhdHRlcm4pCgogICAgZGVmIF9maW5kX3Rlc3RzKHNlbGYsIHN0YXJ0X2RpciwgcGF0dGVybik6CiAgICAgICAgIiIiVXNlZCBieSBkaXNjb3ZlcnkuIFlpZWxkcyB0ZXN0IHN1aXRlcyBpdCBsb2Fkcy4iIiIKICAgICAgICBwYXRocyA9IG9zLmxpc3RkaXIoc3RhcnRfZGlyKQoKICAgICAgICBmb3IgcGF0aCBpbiBwYXRoczoKICAgICAgICAgICAgZnVsbF9wYXRoID0gb3MucGF0aC5qb2luKHN0YXJ0X2RpciwgcGF0aCkKICAgICAgICAgICAgaWYgb3MucGF0aC5pc2ZpbGUoZnVsbF9wYXRoKToKICAgICAgICAgICAgICAgIGlmIG5vdCBWQUxJRF9NT0RVTEVfTkFNRS5tYXRjaChwYXRoKToKICAgICAgICAgICAgICAgICAgICAjIHZhbGlkIFB5dGhvbiBpZGVudGlmaWVycyBvbmx5CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIGlmIG5vdCBzZWxmLl9tYXRjaF9wYXRoKHBhdGgsIGZ1bGxfcGF0aCwgcGF0dGVybik6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICMgaWYgdGhlIHRlc3QgZmlsZSBtYXRjaGVzLCBsb2FkIGl0CiAgICAgICAgICAgICAgICBuYW1lID0gc2VsZi5fZ2V0X25hbWVfZnJvbV9wYXRoKGZ1bGxfcGF0aCkKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBtb2R1bGUgPSBzZWxmLl9nZXRfbW9kdWxlX2Zyb21fbmFtZShuYW1lKQogICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgIHlpZWxkIF9tYWtlX2ZhaWxlZF9pbXBvcnRfdGVzdChuYW1lLCBzZWxmLnN1aXRlQ2xhc3MpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIG1vZF9maWxlID0gb3MucGF0aC5hYnNwYXRoKGdldGF0dHIobW9kdWxlLCAnX19maWxlX18nLCBmdWxsX3BhdGgpKQogICAgICAgICAgICAgICAgICAgIHJlYWxwYXRoID0gX2p5dGhvbl9hd2FyZV9zcGxpdGV4dChtb2RfZmlsZSkKICAgICAgICAgICAgICAgICAgICBmdWxscGF0aF9ub2V4dCA9IF9qeXRob25fYXdhcmVfc3BsaXRleHQoZnVsbF9wYXRoKQogICAgICAgICAgICAgICAgICAgIGlmIHJlYWxwYXRoLmxvd2VyKCkgIT0gZnVsbHBhdGhfbm9leHQubG93ZXIoKToKICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlX2RpciA9IG9zLnBhdGguZGlybmFtZShyZWFscGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgbW9kX25hbWUgPSBfanl0aG9uX2F3YXJlX3NwbGl0ZXh0KG9zLnBhdGguYmFzZW5hbWUoZnVsbF9wYXRoKSkKICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWRfZGlyID0gb3MucGF0aC5kaXJuYW1lKGZ1bGxfcGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgbXNnID0gKCIlciBtb2R1bGUgaW5jb3JyZWN0bHkgaW1wb3J0ZWQgZnJvbSAlci4gRXhwZWN0ZWQgJXIuICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJcyB0aGlzIG1vZHVsZSBnbG9iYWxseSBpbnN0YWxsZWQ/IikKICAgICAgICAgICAgICAgICAgICAgICAgcmFpc2UgSW1wb3J0RXJyb3IobXNnICUgKG1vZF9uYW1lLCBtb2R1bGVfZGlyLCBleHBlY3RlZF9kaXIpKQogICAgICAgICAgICAgICAgICAgIHlpZWxkIHNlbGYubG9hZFRlc3RzRnJvbU1vZHVsZShtb2R1bGUpCiAgICAgICAgICAgIGVsaWYgb3MucGF0aC5pc2RpcihmdWxsX3BhdGgpOgogICAgICAgICAgICAgICAgaWYgbm90IG9zLnBhdGguaXNmaWxlKG9zLnBhdGguam9pbihmdWxsX3BhdGgsICdfX2luaXRfXy5weScpKToKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgICAgIGxvYWRfdGVzdHMgPSBOb25lCiAgICAgICAgICAgICAgICB0ZXN0cyA9IE5vbmUKICAgICAgICAgICAgICAgIGlmIGZubWF0Y2gocGF0aCwgcGF0dGVybik6CiAgICAgICAgICAgICAgICAgICAgIyBvbmx5IGNoZWNrIGxvYWRfdGVzdHMgaWYgdGhlIHBhY2thZ2UgZGlyZWN0b3J5IGl0c2VsZiBtYXRjaGVzIHRoZSBmaWx0ZXIKICAgICAgICAgICAgICAgICAgICBuYW1lID0gc2VsZi5fZ2V0X25hbWVfZnJvbV9wYXRoKGZ1bGxfcGF0aCkKICAgICAgICAgICAgICAgICAgICBwYWNrYWdlID0gc2VsZi5fZ2V0X21vZHVsZV9mcm9tX25hbWUobmFtZSkKICAgICAgICAgICAgICAgICAgICBsb2FkX3Rlc3RzID0gZ2V0YXR0cihwYWNrYWdlLCAnbG9hZF90ZXN0cycsIE5vbmUpCiAgICAgICAgICAgICAgICAgICAgdGVzdHMgPSBzZWxmLmxvYWRUZXN0c0Zyb21Nb2R1bGUocGFja2FnZSwgdXNlX2xvYWRfdGVzdHM9RmFsc2UpCgogICAgICAgICAgICAgICAgaWYgbG9hZF90ZXN0cyBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgIGlmIHRlc3RzIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICAjIHRlc3RzIGxvYWRlZCBmcm9tIHBhY2thZ2UgZmlsZQogICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0ZXN0cwogICAgICAgICAgICAgICAgICAgICMgcmVjdXJzZSBpbnRvIHRoZSBwYWNrYWdlCiAgICAgICAgICAgICAgICAgICAgZm9yIHRlc3QgaW4gc2VsZi5fZmluZF90ZXN0cyhmdWxsX3BhdGgsIHBhdHRlcm4pOgogICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0ZXN0CiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgbG9hZF90ZXN0cyhzZWxmLCB0ZXN0cywgcGF0dGVybikKICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIF9tYWtlX2ZhaWxlZF9sb2FkX3Rlc3RzKHBhY2thZ2UuX19uYW1lX18sIGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc3VpdGVDbGFzcykKCmRlZmF1bHRUZXN0TG9hZGVyID0gVGVzdExvYWRlcigpCgoKZGVmIF9tYWtlTG9hZGVyKHByZWZpeCwgc29ydFVzaW5nLCBzdWl0ZUNsYXNzPU5vbmUpOgogICAgbG9hZGVyID0gVGVzdExvYWRlcigpCiAgICBsb2FkZXIuc29ydFRlc3RNZXRob2RzVXNpbmcgPSBzb3J0VXNpbmcKICAgIGxvYWRlci50ZXN0TWV0aG9kUHJlZml4ID0gcHJlZml4CiAgICBpZiBzdWl0ZUNsYXNzOgogICAgICAgIGxvYWRlci5zdWl0ZUNsYXNzID0gc3VpdGVDbGFzcwogICAgcmV0dXJuIGxvYWRlcgoKZGVmIGdldFRlc3RDYXNlTmFtZXModGVzdENhc2VDbGFzcywgcHJlZml4LCBzb3J0VXNpbmc9dXRpbC50aHJlZV93YXlfY21wKToKICAgIHJldHVybiBfbWFrZUxvYWRlcihwcmVmaXgsIHNvcnRVc2luZykuZ2V0VGVzdENhc2VOYW1lcyh0ZXN0Q2FzZUNsYXNzKQoKZGVmIG1ha2VTdWl0ZSh0ZXN0Q2FzZUNsYXNzLCBwcmVmaXg9J3Rlc3QnLCBzb3J0VXNpbmc9dXRpbC50aHJlZV93YXlfY21wLAogICAgICAgICAgICAgIHN1aXRlQ2xhc3M9c3VpdGUuVGVzdFN1aXRlKToKICAgIHJldHVybiBfbWFrZUxvYWRlcihwcmVmaXgsIHNvcnRVc2luZywgc3VpdGVDbGFzcykubG9hZFRlc3RzRnJvbVRlc3RDYXNlKAogICAgICAgIHRlc3RDYXNlQ2xhc3MpCgpkZWYgZmluZFRlc3RDYXNlcyhtb2R1bGUsIHByZWZpeD0ndGVzdCcsIHNvcnRVc2luZz11dGlsLnRocmVlX3dheV9jbXAsCiAgICAgICAgICAgICAgICAgIHN1aXRlQ2xhc3M9c3VpdGUuVGVzdFN1aXRlKToKICAgIHJldHVybiBfbWFrZUxvYWRlcihwcmVmaXgsIHNvcnRVc2luZywgc3VpdGVDbGFzcykubG9hZFRlc3RzRnJvbU1vZHVsZShcCiAgICAgICAgbW9kdWxlKQo=',
'/Lib/unittest/main.py':'IiIiVW5pdHRlc3QgbWFpbiBwcm9ncmFtIiIiCgppbXBvcnQgc3lzCmltcG9ydCBvcHRwYXJzZQppbXBvcnQgb3MKCmZyb20gLiBpbXBvcnQgbG9hZGVyLCBydW5uZXIKZnJvbSAuc2lnbmFscyBpbXBvcnQgaW5zdGFsbEhhbmRsZXIKCl9fdW5pdHRlc3QgPSBUcnVlCgpGQUlMRkFTVCAgICAgPSAiICAtZiwgLS1mYWlsZmFzdCAgIFN0b3Agb24gZmlyc3QgZmFpbHVyZVxuIgpDQVRDSEJSRUFLICAgPSAiICAtYywgLS1jYXRjaCAgICAgIENhdGNoIGNvbnRyb2wtQyBhbmQgZGlzcGxheSByZXN1bHRzXG4iCkJVRkZFUk9VVFBVVCA9ICIgIC1iLCAtLWJ1ZmZlciAgICAgQnVmZmVyIHN0ZG91dCBhbmQgc3RkZXJyIGR1cmluZyB0ZXN0IHJ1bnNcbiIKClVTQUdFX0FTX01BSU4gPSAiIiJcClVzYWdlOiAlKHByb2dOYW1lKXMgW29wdGlvbnNdIFt0ZXN0c10KCk9wdGlvbnM6CiAgLWgsIC0taGVscCAgICAgICBTaG93IHRoaXMgbWVzc2FnZQogIC12LCAtLXZlcmJvc2UgICAgVmVyYm9zZSBvdXRwdXQKICAtcSwgLS1xdWlldCAgICAgIE1pbmltYWwgb3V0cHV0CiUoZmFpbGZhc3QpcyUoY2F0Y2hicmVhaylzJShidWZmZXIpcwpFeGFtcGxlczoKICAlKHByb2dOYW1lKXMgdGVzdF9tb2R1bGUgICAgICAgICAgICAgICAtIHJ1biB0ZXN0cyBmcm9tIHRlc3RfbW9kdWxlCiAgJShwcm9nTmFtZSlzIG1vZHVsZS5UZXN0Q2xhc3MgICAgICAgICAgLSBydW4gdGVzdHMgZnJvbSBtb2R1bGUuVGVzdENsYXNzCiAgJShwcm9nTmFtZSlzIG1vZHVsZS5DbGFzcy50ZXN0X21ldGhvZCAgLSBydW4gc3BlY2lmaWVkIHRlc3QgbWV0aG9kCgpbdGVzdHNdIGNhbiBiZSBhIGxpc3Qgb2YgYW55IG51bWJlciBvZiB0ZXN0IG1vZHVsZXMsIGNsYXNzZXMgYW5kIHRlc3QKbWV0aG9kcy4KCkFsdGVybmF0aXZlIFVzYWdlOiAlKHByb2dOYW1lKXMgZGlzY292ZXIgW29wdGlvbnNdCgpPcHRpb25zOgogIC12LCAtLXZlcmJvc2UgICAgVmVyYm9zZSBvdXRwdXQKJShmYWlsZmFzdClzJShjYXRjaGJyZWFrKXMlKGJ1ZmZlcilzICAtcyBkaXJlY3RvcnkgICAgIERpcmVjdG9yeSB0byBzdGFydCBkaXNjb3ZlcnkgKCcuJyBkZWZhdWx0KQogIC1wIHBhdHRlcm4gICAgICAgUGF0dGVybiB0byBtYXRjaCB0ZXN0IGZpbGVzICgndGVzdCoucHknIGRlZmF1bHQpCiAgLXQgZGlyZWN0b3J5ICAgICBUb3AgbGV2ZWwgZGlyZWN0b3J5IG9mIHByb2plY3QgKGRlZmF1bHQgdG8KICAgICAgICAgICAgICAgICAgIHN0YXJ0IGRpcmVjdG9yeSkKCkZvciB0ZXN0IGRpc2NvdmVyeSBhbGwgdGVzdCBtb2R1bGVzIG11c3QgYmUgaW1wb3J0YWJsZSBmcm9tIHRoZSB0b3AKbGV2ZWwgZGlyZWN0b3J5IG9mIHRoZSBwcm9qZWN0LgoiIiIKClVTQUdFX0ZST01fTU9EVUxFID0gIiIiXApVc2FnZTogJShwcm9nTmFtZSlzIFtvcHRpb25zXSBbdGVzdF0gWy4uLl0KCk9wdGlvbnM6CiAgLWgsIC0taGVscCAgICAgICBTaG93IHRoaXMgbWVzc2FnZQogIC12LCAtLXZlcmJvc2UgICAgVmVyYm9zZSBvdXRwdXQKICAtcSwgLS1xdWlldCAgICAgIE1pbmltYWwgb3V0cHV0CiUoZmFpbGZhc3QpcyUoY2F0Y2hicmVhaylzJShidWZmZXIpcwpFeGFtcGxlczoKICAlKHByb2dOYW1lKXMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBydW4gZGVmYXVsdCBzZXQgb2YgdGVzdHMKICAlKHByb2dOYW1lKXMgTXlUZXN0U3VpdGUgICAgICAgICAgICAgICAgICAgLSBydW4gc3VpdGUgJ015VGVzdFN1aXRlJwogICUocHJvZ05hbWUpcyBNeVRlc3RDYXNlLnRlc3RTb21ldGhpbmcgICAgICAtIHJ1biBNeVRlc3RDYXNlLnRlc3RTb21ldGhpbmcKICAlKHByb2dOYW1lKXMgTXlUZXN0Q2FzZSAgICAgICAgICAgICAgICAgICAgLSBydW4gYWxsICd0ZXN0KicgdGVzdCBtZXRob2RzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW4gTXlUZXN0Q2FzZQoiIiIKCmRlZiBfY29udmVydF9uYW1lKG5hbWUpOgogICAgIyBvbiBMaW51eCAvIE1hYyBPUyBYICdmb28uUFknIGlzIG5vdCBpbXBvcnRhYmxlLCBidXQgb24KICAgICMgV2luZG93cyBpdCBpcy4gU2ltcGxlciB0byBkbyBhIGNhc2UgaW5zZW5zaXRpdmUgbWF0Y2gKICAgICMgYSBiZXR0ZXIgY2hlY2sgd291bGQgYmUgdG8gY2hlY2sgdGhhdCB0aGUgbmFtZSBpcyBhCiAgICAjIHZhbGlkIFB5dGhvbiBtb2R1bGUgbmFtZS4KICAgIGlmIG9zLnBhdGguaXNmaWxlKG5hbWUpIGFuZCBuYW1lLmxvd2VyKCkuZW5kc3dpdGgoJy5weScpOgogICAgICAgIGlmIG9zLnBhdGguaXNhYnMobmFtZSk6CiAgICAgICAgICAgIHJlbF9wYXRoID0gb3MucGF0aC5yZWxwYXRoKG5hbWUsIG9zLmdldGN3ZCgpKQogICAgICAgICAgICBpZiBvcy5wYXRoLmlzYWJzKHJlbF9wYXRoKSBvciByZWxfcGF0aC5zdGFydHN3aXRoKG9zLnBhcmRpcik6CiAgICAgICAgICAgICAgICByZXR1cm4gbmFtZQogICAgICAgICAgICBuYW1lID0gcmVsX3BhdGgKICAgICAgICAjIG9uIFdpbmRvd3MgYm90aCAnXCcgYW5kICcvJyBhcmUgdXNlZCBhcyBwYXRoCiAgICAgICAgIyBzZXBhcmF0b3JzLiBCZXR0ZXIgdG8gcmVwbGFjZSBib3RoIHRoYW4gcmVseSBvbiBvcy5wYXRoLnNlcAogICAgICAgIHJldHVybiBuYW1lWzotM10ucmVwbGFjZSgnXFwnLCAnLicpLnJlcGxhY2UoJy8nLCAnLicpCiAgICByZXR1cm4gbmFtZQoKZGVmIF9jb252ZXJ0X25hbWVzKG5hbWVzKToKICAgIHJldHVybiBbX2NvbnZlcnRfbmFtZShuYW1lKSBmb3IgbmFtZSBpbiBuYW1lc10KCgpjbGFzcyBUZXN0UHJvZ3JhbShvYmplY3QpOgogICAgIiIiQSBjb21tYW5kLWxpbmUgcHJvZ3JhbSB0aGF0IHJ1bnMgYSBzZXQgb2YgdGVzdHM7IHRoaXMgaXMgcHJpbWFyaWx5CiAgICAgICBmb3IgbWFraW5nIHRlc3QgbW9kdWxlcyBjb252ZW5pZW50bHkgZXhlY3V0YWJsZS4KICAgICIiIgogICAgVVNBR0UgPSBVU0FHRV9GUk9NX01PRFVMRQoKICAgICMgZGVmYXVsdHMgZm9yIHRlc3RpbmcKICAgIGZhaWxmYXN0ID0gY2F0Y2hicmVhayA9IGJ1ZmZlciA9IHByb2dOYW1lID0gd2FybmluZ3MgPSBOb25lCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG1vZHVsZT0nX19tYWluX18nLCBkZWZhdWx0VGVzdD1Ob25lLCBhcmd2PU5vbmUsCiAgICAgICAgICAgICAgICAgICAgdGVzdFJ1bm5lcj1Ob25lLCB0ZXN0TG9hZGVyPWxvYWRlci5kZWZhdWx0VGVzdExvYWRlciwKICAgICAgICAgICAgICAgICAgICBleGl0PVRydWUsIHZlcmJvc2l0eT0xLCBmYWlsZmFzdD1Ob25lLCBjYXRjaGJyZWFrPU5vbmUsCiAgICAgICAgICAgICAgICAgICAgYnVmZmVyPU5vbmUsIHdhcm5pbmdzPU5vbmUpOgogICAgICAgIGlmIGlzaW5zdGFuY2UobW9kdWxlLCBzdHIpOgogICAgICAgICAgICBzZWxmLm1vZHVsZSA9IF9faW1wb3J0X18obW9kdWxlKQogICAgICAgICAgICBmb3IgcGFydCBpbiBtb2R1bGUuc3BsaXQoJy4nKVsxOl06CiAgICAgICAgICAgICAgICBzZWxmLm1vZHVsZSA9IGdldGF0dHIoc2VsZi5tb2R1bGUsIHBhcnQpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5tb2R1bGUgPSBtb2R1bGUKICAgICAgICBpZiBhcmd2IGlzIE5vbmU6CiAgICAgICAgICAgIGFyZ3YgPSBzeXMuYXJndgoKICAgICAgICBzZWxmLmV4aXQgPSBleGl0CiAgICAgICAgc2VsZi5mYWlsZmFzdCA9IGZhaWxmYXN0CiAgICAgICAgc2VsZi5jYXRjaGJyZWFrID0gY2F0Y2hicmVhawogICAgICAgIHNlbGYudmVyYm9zaXR5ID0gdmVyYm9zaXR5CiAgICAgICAgc2VsZi5idWZmZXIgPSBidWZmZXIKICAgICAgICBpZiB3YXJuaW5ncyBpcyBOb25lIGFuZCBub3Qgc3lzLndhcm5vcHRpb25zOgogICAgICAgICAgICAjIGV2ZW4gaWYgRHJlcHJlY2F0aW9uV2FybmluZ3MgYXJlIGlnbm9yZWQgYnkgZGVmYXVsdAogICAgICAgICAgICAjIHByaW50IHRoZW0gYW55d2F5IHVubGVzcyBvdGhlciB3YXJuaW5ncyBzZXR0aW5ncyBhcmUKICAgICAgICAgICAgIyBzcGVjaWZpZWQgYnkgdGhlIHdhcm5pbmdzIGFyZyBvciB0aGUgLVcgcHl0aG9uIGZsYWcKICAgICAgICAgICAgc2VsZi53YXJuaW5ncyA9ICdkZWZhdWx0JwogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgaGVyZSBzZWxmLndhcm5pbmdzIGlzIHNldCBlaXRoZXIgdG8gdGhlIHZhbHVlIHBhc3NlZAogICAgICAgICAgICAjIHRvIHRoZSB3YXJuaW5ncyBhcmdzIG9yIHRvIE5vbmUuCiAgICAgICAgICAgICMgSWYgdGhlIHVzZXIgZGlkbid0IHBhc3MgYSB2YWx1ZSBzZWxmLndhcm5pbmdzIHdpbGwKICAgICAgICAgICAgIyBiZSBOb25lLiBUaGlzIG1lYW5zIHRoYXQgdGhlIGJlaGF2aW9yIGlzIHVuY2hhbmdlZAogICAgICAgICAgICAjIGFuZCBkZXBlbmRzIG9uIHRoZSB2YWx1ZXMgcGFzc2VkIHRvIC1XLgogICAgICAgICAgICBzZWxmLndhcm5pbmdzID0gd2FybmluZ3MKICAgICAgICBzZWxmLmRlZmF1bHRUZXN0ID0gZGVmYXVsdFRlc3QKICAgICAgICBzZWxmLnRlc3RSdW5uZXIgPSB0ZXN0UnVubmVyCiAgICAgICAgc2VsZi50ZXN0TG9hZGVyID0gdGVzdExvYWRlcgogICAgICAgIHNlbGYucHJvZ05hbWUgPSBvcy5wYXRoLmJhc2VuYW1lKGFyZ3ZbMF0pCiAgICAgICAgc2VsZi5wYXJzZUFyZ3MoYXJndikKICAgICAgICBzZWxmLnJ1blRlc3RzKCkKCiAgICBkZWYgdXNhZ2VFeGl0KHNlbGYsIG1zZz1Ob25lKToKICAgICAgICBpZiBtc2c6CiAgICAgICAgICAgIHByaW50KG1zZykKICAgICAgICB1c2FnZSA9IHsncHJvZ05hbWUnOiBzZWxmLnByb2dOYW1lLCAnY2F0Y2hicmVhayc6ICcnLCAnZmFpbGZhc3QnOiAnJywKICAgICAgICAgICAgICAgICAnYnVmZmVyJzogJyd9CiAgICAgICAgaWYgc2VsZi5mYWlsZmFzdCAhPSBGYWxzZToKICAgICAgICAgICAgdXNhZ2VbJ2ZhaWxmYXN0J10gPSBGQUlMRkFTVAogICAgICAgIGlmIHNlbGYuY2F0Y2hicmVhayAhPSBGYWxzZToKICAgICAgICAgICAgdXNhZ2VbJ2NhdGNoYnJlYWsnXSA9IENBVENIQlJFQUsKICAgICAgICBpZiBzZWxmLmJ1ZmZlciAhPSBGYWxzZToKICAgICAgICAgICAgdXNhZ2VbJ2J1ZmZlciddID0gQlVGRkVST1VUUFVUCiAgICAgICAgcHJpbnQoc2VsZi5VU0FHRSAlIHVzYWdlKQogICAgICAgIHN5cy5leGl0KDIpCgogICAgZGVmIHBhcnNlQXJncyhzZWxmLCBhcmd2KToKICAgICAgICBpZiAoKGxlbihhcmd2KSA+IDEgYW5kIGFyZ3ZbMV0ubG93ZXIoKSA9PSAnZGlzY292ZXInKSBvcgogICAgICAgICAgICAobGVuKGFyZ3YpID09IDEgYW5kIHNlbGYubW9kdWxlIGlzIE5vbmUpKToKICAgICAgICAgICAgc2VsZi5fZG9fZGlzY292ZXJ5KGFyZ3ZbMjpdKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgcGFyc2VyID0gc2VsZi5fZ2V0T3B0UGFyc2VyKCkKICAgICAgICBvcHRpb25zLCBhcmdzID0gcGFyc2VyLnBhcnNlX2FyZ3MoYXJndlsxOl0pCiAgICAgICAgc2VsZi5fc2V0QXR0cmlidXRlc0Zyb21PcHRpb25zKG9wdGlvbnMpCgogICAgICAgIGlmIGxlbihhcmdzKSA9PSAwIGFuZCBzZWxmLm1vZHVsZSBpcyBOb25lOgogICAgICAgICAgICAjIHRoaXMgYWxsb3dzICJweXRob24gLW0gdW5pdHRlc3QgLXYiIHRvIHN0aWxsIHdvcmsgZm9yCiAgICAgICAgICAgICMgdGVzdCBkaXNjb3ZlcnkuIFRoaXMgbWVhbnMgLWMgLyAtYiAvIC12IC8gLWYgb3B0aW9ucyB3aWxsCiAgICAgICAgICAgICMgYmUgaGFuZGxlZCB0d2ljZSwgd2hpY2ggaXMgaGFybWxlc3MgYnV0IG5vdCBpZGVhbC4KICAgICAgICAgICAgc2VsZi5fZG9fZGlzY292ZXJ5KGFyZ3ZbMTpdKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgbGVuKGFyZ3MpID09IDAgYW5kIHNlbGYuZGVmYXVsdFRlc3QgaXMgTm9uZToKICAgICAgICAgICAgIyBjcmVhdGVUZXN0cyB3aWxsIGxvYWQgdGVzdHMgZnJvbSBzZWxmLm1vZHVsZQogICAgICAgICAgICBzZWxmLnRlc3ROYW1lcyA9IE5vbmUKICAgICAgICBlbGlmIGxlbihhcmdzKSA+IDA6CiAgICAgICAgICAgIHNlbGYudGVzdE5hbWVzID0gX2NvbnZlcnRfbmFtZXMoYXJncykKICAgICAgICAgICAgaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgICAgICAgICAgICAgICMgdG8gc3VwcG9ydCBweXRob24gLW0gdW5pdHRlc3QgLi4uCiAgICAgICAgICAgICAgICBzZWxmLm1vZHVsZSA9IE5vbmUKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnRlc3ROYW1lcyA9IChzZWxmLmRlZmF1bHRUZXN0LCkKICAgICAgICBzZWxmLmNyZWF0ZVRlc3RzKCkKCiAgICBkZWYgY3JlYXRlVGVzdHMoc2VsZik6CiAgICAgICAgaWYgc2VsZi50ZXN0TmFtZXMgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi50ZXN0ID0gc2VsZi50ZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb21Nb2R1bGUoc2VsZi5tb2R1bGUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi50ZXN0ID0gc2VsZi50ZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhzZWxmLnRlc3ROYW1lcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm1vZHVsZSkKCiAgICBkZWYgX2dldE9wdFBhcnNlcihzZWxmKToKICAgICAgICBwYXJzZXIgPSBvcHRwYXJzZS5PcHRpb25QYXJzZXIoKQogICAgICAgIHBhcnNlci5wcm9nID0gc2VsZi5wcm9nTmFtZQogICAgICAgIHBhcnNlci5hZGRfb3B0aW9uKCctdicsICctLXZlcmJvc2UnLCBkZXN0PSd2ZXJib3NlJywgZGVmYXVsdD1GYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSdWZXJib3NlIG91dHB1dCcsIGFjdGlvbj0nc3RvcmVfdHJ1ZScpCiAgICAgICAgcGFyc2VyLmFkZF9vcHRpb24oJy1xJywgJy0tcXVpZXQnLCBkZXN0PSdxdWlldCcsIGRlZmF1bHQ9RmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscD0nUXVpZXQgb3V0cHV0JywgYWN0aW9uPSdzdG9yZV90cnVlJykKCiAgICAgICAgaWYgc2VsZi5mYWlsZmFzdCAhPSBGYWxzZToKICAgICAgICAgICAgcGFyc2VyLmFkZF9vcHRpb24oJy1mJywgJy0tZmFpbGZhc3QnLCBkZXN0PSdmYWlsZmFzdCcsIGRlZmF1bHQ9RmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlbHA9J1N0b3Agb24gZmlyc3QgZmFpbCBvciBlcnJvcicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbj0nc3RvcmVfdHJ1ZScpCiAgICAgICAgaWYgc2VsZi5jYXRjaGJyZWFrICE9IEZhbHNlOgogICAgICAgICAgICBwYXJzZXIuYWRkX29wdGlvbignLWMnLCAnLS1jYXRjaCcsIGRlc3Q9J2NhdGNoYnJlYWsnLCBkZWZhdWx0PUZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSdDYXRjaCBjdHJsLUMgYW5kIGRpc3BsYXkgcmVzdWx0cyBzbyBmYXInLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb249J3N0b3JlX3RydWUnKQogICAgICAgIGlmIHNlbGYuYnVmZmVyICE9IEZhbHNlOgogICAgICAgICAgICBwYXJzZXIuYWRkX29wdGlvbignLWInLCAnLS1idWZmZXInLCBkZXN0PSdidWZmZXInLCBkZWZhdWx0PUZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSdCdWZmZXIgc3Rkb3V0IGFuZCBzdGRlcnIgZHVyaW5nIHRlc3RzJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uPSdzdG9yZV90cnVlJykKICAgICAgICByZXR1cm4gcGFyc2VyCgogICAgZGVmIF9zZXRBdHRyaWJ1dGVzRnJvbU9wdGlvbnMoc2VsZiwgb3B0aW9ucyk6CiAgICAgICAgIyBvbmx5IHNldCBvcHRpb25zIGZyb20gdGhlIHBhcnNpbmcgaGVyZQogICAgICAgICMgaWYgdGhleSB3ZXJlbid0IHNldCBleHBsaWNpdGx5IGluIHRoZSBjb25zdHJ1Y3RvcgogICAgICAgIGlmIHNlbGYuZmFpbGZhc3QgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5mYWlsZmFzdCA9IG9wdGlvbnMuZmFpbGZhc3QKICAgICAgICBpZiBzZWxmLmNhdGNoYnJlYWsgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5jYXRjaGJyZWFrID0gb3B0aW9ucy5jYXRjaGJyZWFrCiAgICAgICAgaWYgc2VsZi5idWZmZXIgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5idWZmZXIgPSBvcHRpb25zLmJ1ZmZlcgoKICAgICAgICBpZiBvcHRpb25zLnZlcmJvc2U6CiAgICAgICAgICAgIHNlbGYudmVyYm9zaXR5ID0gMgogICAgICAgIGVsaWYgb3B0aW9ucy5xdWlldDoKICAgICAgICAgICAgc2VsZi52ZXJib3NpdHkgPSAwCgogICAgZGVmIF9hZGREaXNjb3ZlcnlPcHRpb25zKHNlbGYsIHBhcnNlcik6CiAgICAgICAgcGFyc2VyLmFkZF9vcHRpb24oJy1zJywgJy0tc3RhcnQtZGlyZWN0b3J5JywgZGVzdD0nc3RhcnQnLCBkZWZhdWx0PScuJywKICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSJEaXJlY3RvcnkgdG8gc3RhcnQgZGlzY292ZXJ5ICgnLicgZGVmYXVsdCkiKQogICAgICAgIHBhcnNlci5hZGRfb3B0aW9uKCctcCcsICctLXBhdHRlcm4nLCBkZXN0PSdwYXR0ZXJuJywgZGVmYXVsdD0ndGVzdCoucHknLAogICAgICAgICAgICAgICAgICAgICAgICAgIGhlbHA9IlBhdHRlcm4gdG8gbWF0Y2ggdGVzdHMgKCd0ZXN0Ki5weScgZGVmYXVsdCkiKQogICAgICAgIHBhcnNlci5hZGRfb3B0aW9uKCctdCcsICctLXRvcC1sZXZlbC1kaXJlY3RvcnknLCBkZXN0PSd0b3AnLCBkZWZhdWx0PU5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscD0nVG9wIGxldmVsIGRpcmVjdG9yeSBvZiBwcm9qZWN0IChkZWZhdWx0cyB0byBzdGFydCBkaXJlY3RvcnkpJykKCiAgICBkZWYgX2RvX2Rpc2NvdmVyeShzZWxmLCBhcmd2LCBMb2FkZXI9bG9hZGVyLlRlc3RMb2FkZXIpOgogICAgICAgICMgaGFuZGxlIGNvbW1hbmQgbGluZSBhcmdzIGZvciB0ZXN0IGRpc2NvdmVyeQogICAgICAgIHNlbGYucHJvZ05hbWUgPSAnJXMgZGlzY292ZXInICUgc2VsZi5wcm9nTmFtZQogICAgICAgIHBhcnNlciA9IHNlbGYuX2dldE9wdFBhcnNlcigpCiAgICAgICAgc2VsZi5fYWRkRGlzY292ZXJ5T3B0aW9ucyhwYXJzZXIpCgogICAgICAgIG9wdGlvbnMsIGFyZ3MgPSBwYXJzZXIucGFyc2VfYXJncyhhcmd2KQogICAgICAgIGlmIGxlbihhcmdzKSA+IDM6CiAgICAgICAgICAgIHNlbGYudXNhZ2VFeGl0KCkKCiAgICAgICAgZm9yIG5hbWUsIHZhbHVlIGluIHppcCgoJ3N0YXJ0JywgJ3BhdHRlcm4nLCAndG9wJyksIGFyZ3MpOgogICAgICAgICAgICBzZXRhdHRyKG9wdGlvbnMsIG5hbWUsIHZhbHVlKQoKICAgICAgICBzZWxmLl9zZXRBdHRyaWJ1dGVzRnJvbU9wdGlvbnMob3B0aW9ucykKCiAgICAgICAgc3RhcnRfZGlyID0gb3B0aW9ucy5zdGFydAogICAgICAgIHBhdHRlcm4gPSBvcHRpb25zLnBhdHRlcm4KICAgICAgICB0b3BfbGV2ZWxfZGlyID0gb3B0aW9ucy50b3AKCiAgICAgICAgbG9hZGVyID0gTG9hZGVyKCkKICAgICAgICBzZWxmLnRlc3QgPSBsb2FkZXIuZGlzY292ZXIoc3RhcnRfZGlyLCBwYXR0ZXJuLCB0b3BfbGV2ZWxfZGlyKQoKICAgIGRlZiBydW5UZXN0cyhzZWxmKToKICAgICAgICBpZiBzZWxmLmNhdGNoYnJlYWs6CiAgICAgICAgICAgIGluc3RhbGxIYW5kbGVyKCkKICAgICAgICBpZiBzZWxmLnRlc3RSdW5uZXIgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi50ZXN0UnVubmVyID0gcnVubmVyLlRleHRUZXN0UnVubmVyCiAgICAgICAgaWYgaXNpbnN0YW5jZShzZWxmLnRlc3RSdW5uZXIsIHR5cGUpOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB0ZXN0UnVubmVyID0gc2VsZi50ZXN0UnVubmVyKHZlcmJvc2l0eT1zZWxmLnZlcmJvc2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFpbGZhc3Q9c2VsZi5mYWlsZmFzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVmZmVyPXNlbGYuYnVmZmVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXJuaW5ncz1zZWxmLndhcm5pbmdzKQogICAgICAgICAgICBleGNlcHQgVHlwZUVycm9yOgogICAgICAgICAgICAgICAgIyBkaWRuJ3QgYWNjZXB0IHRoZSB2ZXJib3NpdHksIGJ1ZmZlciBvciBmYWlsZmFzdCBhcmd1bWVudHMKICAgICAgICAgICAgICAgIHRlc3RSdW5uZXIgPSBzZWxmLnRlc3RSdW5uZXIoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgaXQgaXMgYXNzdW1lZCB0byBiZSBhIFRlc3RSdW5uZXIgaW5zdGFuY2UKICAgICAgICAgICAgdGVzdFJ1bm5lciA9IHNlbGYudGVzdFJ1bm5lcgogICAgICAgIHNlbGYucmVzdWx0ID0gdGVzdFJ1bm5lci5ydW4oc2VsZi50ZXN0KQogICAgICAgIGlmIHNlbGYuZXhpdDoKICAgICAgICAgICAgc3lzLmV4aXQobm90IHNlbGYucmVzdWx0Lndhc1N1Y2Nlc3NmdWwoKSkKCm1haW4gPSBUZXN0UHJvZ3JhbQo=',
'/Lib/unittest/mock.py':'IyBtb2NrLnB5CiMgVGVzdCB0b29scyBmb3IgbW9ja2luZyBhbmQgcGF0Y2hpbmcuCiMgTWFpbnRhaW5lZCBieSBNaWNoYWVsIEZvb3JkCiMgQmFja3BvcnQgZm9yIG90aGVyIHZlcnNpb25zIG9mIFB5dGhvbiBhdmFpbGFibGUgZnJvbQojIGh0dHA6Ly9weXBpLnB5dGhvbi5vcmcvcHlwaS9tb2NrCgpfX2FsbF9fID0gKAogICAgJ01vY2snLAogICAgJ01hZ2ljTW9jaycsCiAgICAncGF0Y2gnLAogICAgJ3NlbnRpbmVsJywKICAgICdERUZBVUxUJywKICAgICdBTlknLAogICAgJ2NhbGwnLAogICAgJ2NyZWF0ZV9hdXRvc3BlYycsCiAgICAnRklMVEVSX0RJUicsCiAgICAnTm9uQ2FsbGFibGVNb2NrJywKICAgICdOb25DYWxsYWJsZU1hZ2ljTW9jaycsCiAgICAnbW9ja19vcGVuJywKICAgICdQcm9wZXJ0eU1vY2snLAopCgoKX192ZXJzaW9uX18gPSAnMS4wJwoKCmltcG9ydCBpbnNwZWN0CmltcG9ydCBwcHJpbnQKaW1wb3J0IHN5cwpmcm9tIGZ1bmN0b29scyBpbXBvcnQgd3JhcHMKCgpCYXNlRXhjZXB0aW9ucyA9IChCYXNlRXhjZXB0aW9uLCkKaWYgJ2phdmEnIGluIHN5cy5wbGF0Zm9ybToKICAgICMganl0aG9uCiAgICBpbXBvcnQgamF2YQogICAgQmFzZUV4Y2VwdGlvbnMgPSAoQmFzZUV4Y2VwdGlvbiwgamF2YS5sYW5nLlRocm93YWJsZSkKCgpGSUxURVJfRElSID0gVHJ1ZQoKIyBXb3JrYXJvdW5kIGZvciBpc3N1ZSAjMTIzNzAKIyBXaXRob3V0IHRoaXMsIHRoZSBfX2NsYXNzX18gcHJvcGVydGllcyB3b3VsZG4ndCBiZSBzZXQgY29ycmVjdGx5Cl9zYWZlX3N1cGVyID0gc3VwZXIKCmRlZiBfaXNfaW5zdGFuY2VfbW9jayhvYmopOgogICAgIyBjYW4ndCB1c2UgaXNpbnN0YW5jZSBvbiBNb2NrIG9iamVjdHMgYmVjYXVzZSB0aGV5IG92ZXJyaWRlIF9fY2xhc3NfXwogICAgIyBUaGUgYmFzZSBjbGFzcyBmb3IgYWxsIG1vY2tzIGlzIE5vbkNhbGxhYmxlTW9jawogICAgcmV0dXJuIGlzc3ViY2xhc3ModHlwZShvYmopLCBOb25DYWxsYWJsZU1vY2spCgoKZGVmIF9pc19leGNlcHRpb24ob2JqKToKICAgIHJldHVybiAoCiAgICAgICAgaXNpbnN0YW5jZShvYmosIEJhc2VFeGNlcHRpb25zKSBvcgogICAgICAgIGlzaW5zdGFuY2Uob2JqLCB0eXBlKSBhbmQgaXNzdWJjbGFzcyhvYmosIEJhc2VFeGNlcHRpb25zKQogICAgKQoKCmNsYXNzIF9zbG90dGVkKG9iamVjdCk6CiAgICBfX3Nsb3RzX18gPSBbJ2EnXQoKCkRlc2NyaXB0b3JUeXBlcyA9ICgKICAgIHR5cGUoX3Nsb3R0ZWQuYSksCiAgICBwcm9wZXJ0eSwKKQoKCmRlZiBfZ2V0c2lnbmF0dXJlKGZ1bmMsIHNraXBmaXJzdCwgaW5zdGFuY2U9RmFsc2UpOgogICAgaWYgaXNpbnN0YW5jZShmdW5jLCB0eXBlKSBhbmQgbm90IGluc3RhbmNlOgogICAgICAgIHRyeToKICAgICAgICAgICAgZnVuYyA9IGZ1bmMuX19pbml0X18KICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIHNraXBmaXJzdCA9IFRydWUKICAgIGVsaWYgbm90IGlzaW5zdGFuY2UoZnVuYywgRnVuY3Rpb25UeXBlcyk6CiAgICAgICAgIyBmb3IgY2xhc3NlcyB3aGVyZSBpbnN0YW5jZSBpcyBUcnVlIHdlIGVuZCB1cCBoZXJlIHRvbwogICAgICAgIHRyeToKICAgICAgICAgICAgZnVuYyA9IGZ1bmMuX19jYWxsX18KICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHJldHVybgoKICAgIHRyeToKICAgICAgICBhcmdzcGVjID0gaW5zcGVjdC5nZXRmdWxsYXJnc3BlYyhmdW5jKQogICAgZXhjZXB0IFR5cGVFcnJvcjoKICAgICAgICAjIEMgZnVuY3Rpb24gLyBtZXRob2QsIHBvc3NpYmx5IGluaGVyaXRlZCBvYmplY3QoKS5fX2luaXRfXwogICAgICAgIHJldHVybgoKICAgIHJlZ2FyZ3MsIHZhcmFyZ3MsIHZhcmt3LCBkZWZhdWx0cywga3dvbmx5LCBrd29ubHlkZWYsIGFubiA9IGFyZ3NwZWMKCgogICAgIyBpbnN0YW5jZSBtZXRob2RzIGFuZCBjbGFzc21ldGhvZHMgbmVlZCB0byBsb3NlIHRoZSBzZWxmIGFyZ3VtZW50CiAgICBpZiBnZXRhdHRyKGZ1bmMsICdfX3NlbGZfXycsIE5vbmUpIGlzIG5vdCBOb25lOgogICAgICAgIHJlZ2FyZ3MgPSByZWdhcmdzWzE6XQogICAgaWYgc2tpcGZpcnN0OgogICAgICAgICMgdGhpcyBjb25kaXRpb24gYW5kIHRoZSBhYm92ZSBvbmUgYXJlIG5ldmVyIGJvdGggVHJ1ZSAtIHdoeT8KICAgICAgICByZWdhcmdzID0gcmVnYXJnc1sxOl0KCiAgICBzaWduYXR1cmUgPSBpbnNwZWN0LmZvcm1hdGFyZ3NwZWMoCiAgICAgICAgcmVnYXJncywgdmFyYXJncywgdmFya3csIGRlZmF1bHRzLAogICAgICAgIGt3b25seSwga3dvbmx5ZGVmLCBhbm4sIGZvcm1hdHZhbHVlPWxhbWJkYSB2YWx1ZTogIiIpCiAgICByZXR1cm4gc2lnbmF0dXJlWzE6LTFdLCBmdW5jCgoKZGVmIF9jaGVja19zaWduYXR1cmUoZnVuYywgbW9jaywgc2tpcGZpcnN0LCBpbnN0YW5jZT1GYWxzZSk6CiAgICBpZiBub3QgX2NhbGxhYmxlKGZ1bmMpOgogICAgICAgIHJldHVybgoKICAgIHJlc3VsdCA9IF9nZXRzaWduYXR1cmUoZnVuYywgc2tpcGZpcnN0LCBpbnN0YW5jZSkKICAgIGlmIHJlc3VsdCBpcyBOb25lOgogICAgICAgIHJldHVybgogICAgc2lnbmF0dXJlLCBmdW5jID0gcmVzdWx0CgogICAgIyBjYW4ndCB1c2Ugc2VsZiBiZWNhdXNlICJzZWxmIiBpcyBjb21tb24gYXMgYW4gYXJndW1lbnQgbmFtZQogICAgIyB1bmZvcnR1bmF0ZWx5IGV2ZW4gbm90IGluIHRoZSBmaXJzdCBwbGFjZQogICAgc3JjID0gImxhbWJkYSBfbW9ja19zZWxmLCAlczogTm9uZSIgJSBzaWduYXR1cmUKICAgIGNoZWNrc2lnID0gZXZhbChzcmMsIHt9KQogICAgX2NvcHlfZnVuY19kZXRhaWxzKGZ1bmMsIGNoZWNrc2lnKQogICAgdHlwZShtb2NrKS5fbW9ja19jaGVja19zaWcgPSBjaGVja3NpZwoKCmRlZiBfY29weV9mdW5jX2RldGFpbHMoZnVuYywgZnVuY29weSk6CiAgICBmdW5jb3B5Ll9fbmFtZV9fID0gZnVuYy5fX25hbWVfXwogICAgZnVuY29weS5fX2RvY19fID0gZnVuYy5fX2RvY19fCiAgICAjIHdlIGV4cGxpY2l0bHkgZG9uJ3QgY29weSBmdW5jLl9fZGljdF9fIGludG8gdGhpcyBjb3B5IGFzIGl0IHdvdWxkCiAgICAjIGV4cG9zZSBvcmlnaW5hbCBhdHRyaWJ1dGVzIHRoYXQgc2hvdWxkIGJlIG1vY2tlZAogICAgZnVuY29weS5fX21vZHVsZV9fID0gZnVuYy5fX21vZHVsZV9fCiAgICBmdW5jb3B5Ll9fZGVmYXVsdHNfXyA9IGZ1bmMuX19kZWZhdWx0c19fCiAgICBmdW5jb3B5Ll9fa3dkZWZhdWx0c19fID0gZnVuYy5fX2t3ZGVmYXVsdHNfXwoKCmRlZiBfY2FsbGFibGUob2JqKToKICAgIGlmIGlzaW5zdGFuY2Uob2JqLCB0eXBlKToKICAgICAgICByZXR1cm4gVHJ1ZQogICAgaWYgZ2V0YXR0cihvYmosICdfX2NhbGxfXycsIE5vbmUpIGlzIG5vdCBOb25lOgogICAgICAgIHJldHVybiBUcnVlCiAgICByZXR1cm4gRmFsc2UKCgpkZWYgX2lzX2xpc3Qob2JqKToKICAgICMgY2hlY2tzIGZvciBsaXN0IG9yIHR1cGxlcwogICAgIyBYWFhYIGJhZGx5IG5hbWVkIQogICAgcmV0dXJuIHR5cGUob2JqKSBpbiAobGlzdCwgdHVwbGUpCgoKZGVmIF9pbnN0YW5jZV9jYWxsYWJsZShvYmopOgogICAgIiIiR2l2ZW4gYW4gb2JqZWN0LCByZXR1cm4gVHJ1ZSBpZiB0aGUgb2JqZWN0IGlzIGNhbGxhYmxlLgogICAgRm9yIGNsYXNzZXMsIHJldHVybiBUcnVlIGlmIGluc3RhbmNlcyB3b3VsZCBiZSBjYWxsYWJsZS4iIiIKICAgIGlmIG5vdCBpc2luc3RhbmNlKG9iaiwgdHlwZSk6CiAgICAgICAgIyBhbHJlYWR5IGFuIGluc3RhbmNlCiAgICAgICAgcmV0dXJuIGdldGF0dHIob2JqLCAnX19jYWxsX18nLCBOb25lKSBpcyBub3QgTm9uZQoKICAgICMgKmNvdWxkKiBiZSBicm9rZW4gYnkgYSBjbGFzcyBvdmVycmlkaW5nIF9fbXJvX18gb3IgX19kaWN0X18gdmlhCiAgICAjIGEgbWV0YWNsYXNzCiAgICBmb3IgYmFzZSBpbiAob2JqLCkgKyBvYmouX19tcm9fXzoKICAgICAgICBpZiBiYXNlLl9fZGljdF9fLmdldCgnX19jYWxsX18nKSBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgIHJldHVybiBGYWxzZQoKCmRlZiBfc2V0X3NpZ25hdHVyZShtb2NrLCBvcmlnaW5hbCwgaW5zdGFuY2U9RmFsc2UpOgogICAgIyBjcmVhdGVzIGEgZnVuY3Rpb24gd2l0aCBzaWduYXR1cmUgKCphcmdzLCAqKmt3YXJncykgdGhhdCBkZWxlZ2F0ZXMgdG8gYQogICAgIyBtb2NrLiBJdCBzdGlsbCBkb2VzIHNpZ25hdHVyZSBjaGVja2luZyBieSBjYWxsaW5nIGEgbGFtYmRhIHdpdGggdGhlIHNhbWUKICAgICMgc2lnbmF0dXJlIGFzIHRoZSBvcmlnaW5hbC4KICAgIGlmIG5vdCBfY2FsbGFibGUob3JpZ2luYWwpOgogICAgICAgIHJldHVybgoKICAgIHNraXBmaXJzdCA9IGlzaW5zdGFuY2Uob3JpZ2luYWwsIHR5cGUpCiAgICByZXN1bHQgPSBfZ2V0c2lnbmF0dXJlKG9yaWdpbmFsLCBza2lwZmlyc3QsIGluc3RhbmNlKQogICAgaWYgcmVzdWx0IGlzIE5vbmU6CiAgICAgICAgIyB3YXMgYSBDIGZ1bmN0aW9uIChlLmcuIG9iamVjdCgpLl9faW5pdF9fICkgdGhhdCBjYW4ndCBiZSBtb2NrZWQKICAgICAgICByZXR1cm4KCiAgICBzaWduYXR1cmUsIGZ1bmMgPSByZXN1bHQKCiAgICBzcmMgPSAibGFtYmRhICVzOiBOb25lIiAlIHNpZ25hdHVyZQogICAgY2hlY2tzaWcgPSBldmFsKHNyYywge30pCiAgICBfY29weV9mdW5jX2RldGFpbHMoZnVuYywgY2hlY2tzaWcpCgogICAgbmFtZSA9IG9yaWdpbmFsLl9fbmFtZV9fCiAgICBpZiBub3QgbmFtZS5pc2lkZW50aWZpZXIoKToKICAgICAgICBuYW1lID0gJ2Z1bmNvcHknCiAgICBjb250ZXh0ID0geydfY2hlY2tzaWdfJzogY2hlY2tzaWcsICdtb2NrJzogbW9ja30KICAgIHNyYyA9ICIiImRlZiAlcygqYXJncywgKiprd2FyZ3MpOgogICAgX2NoZWNrc2lnXygqYXJncywgKiprd2FyZ3MpCiAgICByZXR1cm4gbW9jaygqYXJncywgKiprd2FyZ3MpIiIiICUgbmFtZQogICAgZXhlYyAoc3JjLCBjb250ZXh0KQogICAgZnVuY29weSA9IGNvbnRleHRbbmFtZV0KICAgIF9zZXR1cF9mdW5jKGZ1bmNvcHksIG1vY2spCiAgICByZXR1cm4gZnVuY29weQoKCmRlZiBfc2V0dXBfZnVuYyhmdW5jb3B5LCBtb2NrKToKICAgIGZ1bmNvcHkubW9jayA9IG1vY2sKCiAgICAjIGNhbid0IHVzZSBpc2luc3RhbmNlIHdpdGggbW9ja3MKICAgIGlmIG5vdCBfaXNfaW5zdGFuY2VfbW9jayhtb2NrKToKICAgICAgICByZXR1cm4KCiAgICBkZWYgYXNzZXJ0X2NhbGxlZF93aXRoKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgcmV0dXJuIG1vY2suYXNzZXJ0X2NhbGxlZF93aXRoKCphcmdzLCAqKmt3YXJncykKICAgIGRlZiBhc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCgqYXJncywgKiprd2FyZ3MpOgogICAgICAgIHJldHVybiBtb2NrLmFzc2VydF9jYWxsZWRfb25jZV93aXRoKCphcmdzLCAqKmt3YXJncykKICAgIGRlZiBhc3NlcnRfaGFzX2NhbGxzKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgcmV0dXJuIG1vY2suYXNzZXJ0X2hhc19jYWxscygqYXJncywgKiprd2FyZ3MpCiAgICBkZWYgYXNzZXJ0X2FueV9jYWxsKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgcmV0dXJuIG1vY2suYXNzZXJ0X2FueV9jYWxsKCphcmdzLCAqKmt3YXJncykKICAgIGRlZiByZXNldF9tb2NrKCk6CiAgICAgICAgZnVuY29weS5tZXRob2RfY2FsbHMgPSBfQ2FsbExpc3QoKQogICAgICAgIGZ1bmNvcHkubW9ja19jYWxscyA9IF9DYWxsTGlzdCgpCiAgICAgICAgbW9jay5yZXNldF9tb2NrKCkKICAgICAgICByZXQgPSBmdW5jb3B5LnJldHVybl92YWx1ZQogICAgICAgIGlmIF9pc19pbnN0YW5jZV9tb2NrKHJldCkgYW5kIG5vdCByZXQgaXMgbW9jazoKICAgICAgICAgICAgcmV0LnJlc2V0X21vY2soKQoKICAgIGZ1bmNvcHkuY2FsbGVkID0gRmFsc2UKICAgIGZ1bmNvcHkuY2FsbF9jb3VudCA9IDAKICAgIGZ1bmNvcHkuY2FsbF9hcmdzID0gTm9uZQogICAgZnVuY29weS5jYWxsX2FyZ3NfbGlzdCA9IF9DYWxsTGlzdCgpCiAgICBmdW5jb3B5Lm1ldGhvZF9jYWxscyA9IF9DYWxsTGlzdCgpCiAgICBmdW5jb3B5Lm1vY2tfY2FsbHMgPSBfQ2FsbExpc3QoKQoKICAgIGZ1bmNvcHkucmV0dXJuX3ZhbHVlID0gbW9jay5yZXR1cm5fdmFsdWUKICAgIGZ1bmNvcHkuc2lkZV9lZmZlY3QgPSBtb2NrLnNpZGVfZWZmZWN0CiAgICBmdW5jb3B5Ll9tb2NrX2NoaWxkcmVuID0gbW9jay5fbW9ja19jaGlsZHJlbgoKICAgIGZ1bmNvcHkuYXNzZXJ0X2NhbGxlZF93aXRoID0gYXNzZXJ0X2NhbGxlZF93aXRoCiAgICBmdW5jb3B5LmFzc2VydF9jYWxsZWRfb25jZV93aXRoID0gYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgKICAgIGZ1bmNvcHkuYXNzZXJ0X2hhc19jYWxscyA9IGFzc2VydF9oYXNfY2FsbHMKICAgIGZ1bmNvcHkuYXNzZXJ0X2FueV9jYWxsID0gYXNzZXJ0X2FueV9jYWxsCiAgICBmdW5jb3B5LnJlc2V0X21vY2sgPSByZXNldF9tb2NrCgogICAgbW9jay5fbW9ja19kZWxlZ2F0ZSA9IGZ1bmNvcHkKCgpkZWYgX2lzX21hZ2ljKG5hbWUpOgogICAgcmV0dXJuICdfXyVzX18nICUgbmFtZVsyOi0yXSA9PSBuYW1lCgoKY2xhc3MgX1NlbnRpbmVsT2JqZWN0KG9iamVjdCk6CiAgICAiQSB1bmlxdWUsIG5hbWVkLCBzZW50aW5lbCBvYmplY3QuIgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG5hbWUpOgogICAgICAgIHNlbGYubmFtZSA9IG5hbWUKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICdzZW50aW5lbC4lcycgJSBzZWxmLm5hbWUKCgpjbGFzcyBfU2VudGluZWwob2JqZWN0KToKICAgICIiIkFjY2VzcyBhdHRyaWJ1dGVzIHRvIHJldHVybiBhIG5hbWVkIG9iamVjdCwgdXNhYmxlIGFzIGEgc2VudGluZWwuIiIiCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi5fc2VudGluZWxzID0ge30KCiAgICBkZWYgX19nZXRhdHRyX18oc2VsZiwgbmFtZSk6CiAgICAgICAgaWYgbmFtZSA9PSAnX19iYXNlc19fJzoKICAgICAgICAgICAgIyBXaXRob3V0IHRoaXMgaGVscCh1bml0dGVzdC5tb2NrKSByYWlzZXMgYW4gZXhjZXB0aW9uCiAgICAgICAgICAgIHJhaXNlIEF0dHJpYnV0ZUVycm9yCiAgICAgICAgcmV0dXJuIHNlbGYuX3NlbnRpbmVscy5zZXRkZWZhdWx0KG5hbWUsIF9TZW50aW5lbE9iamVjdChuYW1lKSkKCgpzZW50aW5lbCA9IF9TZW50aW5lbCgpCgpERUZBVUxUID0gc2VudGluZWwuREVGQVVMVApfbWlzc2luZyA9IHNlbnRpbmVsLk1JU1NJTkcKX2RlbGV0ZWQgPSBzZW50aW5lbC5ERUxFVEVECgoKZGVmIF9jb3B5KHZhbHVlKToKICAgIGlmIHR5cGUodmFsdWUpIGluIChkaWN0LCBsaXN0LCB0dXBsZSwgc2V0KToKICAgICAgICByZXR1cm4gdHlwZSh2YWx1ZSkodmFsdWUpCiAgICByZXR1cm4gdmFsdWUKCgpfYWxsb3dlZF9uYW1lcyA9IHNldCgKICAgIFsKICAgICAgICAncmV0dXJuX3ZhbHVlJywgJ19tb2NrX3JldHVybl92YWx1ZScsICdzaWRlX2VmZmVjdCcsCiAgICAgICAgJ19tb2NrX3NpZGVfZWZmZWN0JywgJ19tb2NrX3BhcmVudCcsICdfbW9ja19uZXdfcGFyZW50JywKICAgICAgICAnX21vY2tfbmFtZScsICdfbW9ja19uZXdfbmFtZScKICAgIF0KKQoKCmRlZiBfZGVsZWdhdGluZ19wcm9wZXJ0eShuYW1lKToKICAgIF9hbGxvd2VkX25hbWVzLmFkZChuYW1lKQogICAgX3RoZV9uYW1lID0gJ19tb2NrXycgKyBuYW1lCiAgICBkZWYgX2dldChzZWxmLCBuYW1lPW5hbWUsIF90aGVfbmFtZT1fdGhlX25hbWUpOgogICAgICAgIHNpZyA9IHNlbGYuX21vY2tfZGVsZWdhdGUKICAgICAgICBpZiBzaWcgaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIoc2VsZiwgX3RoZV9uYW1lKQogICAgICAgIHJldHVybiBnZXRhdHRyKHNpZywgbmFtZSkKICAgIGRlZiBfc2V0KHNlbGYsIHZhbHVlLCBuYW1lPW5hbWUsIF90aGVfbmFtZT1fdGhlX25hbWUpOgogICAgICAgIHNpZyA9IHNlbGYuX21vY2tfZGVsZWdhdGUKICAgICAgICBpZiBzaWcgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5fX2RpY3RfX1tfdGhlX25hbWVdID0gdmFsdWUKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZXRhdHRyKHNpZywgbmFtZSwgdmFsdWUpCgogICAgcmV0dXJuIHByb3BlcnR5KF9nZXQsIF9zZXQpCgoKCmNsYXNzIF9DYWxsTGlzdChsaXN0KToKCiAgICBkZWYgX19jb250YWluc19fKHNlbGYsIHZhbHVlKToKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZSh2YWx1ZSwgbGlzdCk6CiAgICAgICAgICAgIHJldHVybiBsaXN0Ll9fY29udGFpbnNfXyhzZWxmLCB2YWx1ZSkKICAgICAgICBsZW5fdmFsdWUgPSBsZW4odmFsdWUpCiAgICAgICAgbGVuX3NlbGYgPSBsZW4oc2VsZikKICAgICAgICBpZiBsZW5fdmFsdWUgPiBsZW5fc2VsZjoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgICAgIGZvciBpIGluIHJhbmdlKDAsIGxlbl9zZWxmIC0gbGVuX3ZhbHVlICsgMSk6CiAgICAgICAgICAgIHN1Yl9saXN0ID0gc2VsZltpOmkrbGVuX3ZhbHVlXQogICAgICAgICAgICBpZiBzdWJfbGlzdCA9PSB2YWx1ZToKICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBwcHJpbnQucGZvcm1hdChsaXN0KHNlbGYpKQoKCmRlZiBfY2hlY2tfYW5kX3NldF9wYXJlbnQocGFyZW50LCB2YWx1ZSwgbmFtZSwgbmV3X25hbWUpOgogICAgaWYgbm90IF9pc19pbnN0YW5jZV9tb2NrKHZhbHVlKToKICAgICAgICByZXR1cm4gRmFsc2UKICAgIGlmICgodmFsdWUuX21vY2tfbmFtZSBvciB2YWx1ZS5fbW9ja19uZXdfbmFtZSkgb3IKICAgICAgICAodmFsdWUuX21vY2tfcGFyZW50IGlzIG5vdCBOb25lKSBvcgogICAgICAgICh2YWx1ZS5fbW9ja19uZXdfcGFyZW50IGlzIG5vdCBOb25lKSk6CiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgX3BhcmVudCA9IHBhcmVudAogICAgd2hpbGUgX3BhcmVudCBpcyBub3QgTm9uZToKICAgICAgICAjIHNldHRpbmcgYSBtb2NrICh2YWx1ZSkgYXMgYSBjaGlsZCBvciByZXR1cm4gdmFsdWUgb2YgaXRzZWxmCiAgICAgICAgIyBzaG91bGQgbm90IG1vZGlmeSB0aGUgbW9jawogICAgICAgIGlmIF9wYXJlbnQgaXMgdmFsdWU6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIF9wYXJlbnQgPSBfcGFyZW50Ll9tb2NrX25ld19wYXJlbnQKCiAgICBpZiBuZXdfbmFtZToKICAgICAgICB2YWx1ZS5fbW9ja19uZXdfcGFyZW50ID0gcGFyZW50CiAgICAgICAgdmFsdWUuX21vY2tfbmV3X25hbWUgPSBuZXdfbmFtZQogICAgaWYgbmFtZToKICAgICAgICB2YWx1ZS5fbW9ja19wYXJlbnQgPSBwYXJlbnQKICAgICAgICB2YWx1ZS5fbW9ja19uYW1lID0gbmFtZQogICAgcmV0dXJuIFRydWUKCgoKY2xhc3MgQmFzZShvYmplY3QpOgogICAgX21vY2tfcmV0dXJuX3ZhbHVlID0gREVGQVVMVAogICAgX21vY2tfc2lkZV9lZmZlY3QgPSBOb25lCiAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICBwYXNzCgoKCmNsYXNzIE5vbkNhbGxhYmxlTW9jayhCYXNlKToKICAgICIiIkEgbm9uLWNhbGxhYmxlIHZlcnNpb24gb2YgYE1vY2tgIiIiCgogICAgZGVmIF9fbmV3X18oY2xzLCAqYXJncywgKiprdyk6CiAgICAgICAgIyBldmVyeSBpbnN0YW5jZSBoYXMgaXRzIG93biBjbGFzcwogICAgICAgICMgc28gd2UgY2FuIGNyZWF0ZSBtYWdpYyBtZXRob2RzIG9uIHRoZQogICAgICAgICMgY2xhc3Mgd2l0aG91dCBzdG9tcGluZyBvbiBvdGhlciBtb2NrcwogICAgICAgIG5ldyA9IHR5cGUoY2xzLl9fbmFtZV9fLCAoY2xzLCksIHsnX19kb2NfXyc6IGNscy5fX2RvY19ffSkKICAgICAgICBpbnN0YW5jZSA9IG9iamVjdC5fX25ld19fKG5ldykKICAgICAgICByZXR1cm4gaW5zdGFuY2UKCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgICAgICBzZWxmLCBzcGVjPU5vbmUsIHdyYXBzPU5vbmUsIG5hbWU9Tm9uZSwgc3BlY19zZXQ9Tm9uZSwKICAgICAgICAgICAgcGFyZW50PU5vbmUsIF9zcGVjX3N0YXRlPU5vbmUsIF9uZXdfbmFtZT0nJywgX25ld19wYXJlbnQ9Tm9uZSwKICAgICAgICAgICAgKiprd2FyZ3MKICAgICAgICApOgogICAgICAgIGlmIF9uZXdfcGFyZW50IGlzIE5vbmU6CiAgICAgICAgICAgIF9uZXdfcGFyZW50ID0gcGFyZW50CgogICAgICAgIF9fZGljdF9fID0gc2VsZi5fX2RpY3RfXwogICAgICAgIF9fZGljdF9fWydfbW9ja19wYXJlbnQnXSA9IHBhcmVudAogICAgICAgIF9fZGljdF9fWydfbW9ja19uYW1lJ10gPSBuYW1lCiAgICAgICAgX19kaWN0X19bJ19tb2NrX25ld19uYW1lJ10gPSBfbmV3X25hbWUKICAgICAgICBfX2RpY3RfX1snX21vY2tfbmV3X3BhcmVudCddID0gX25ld19wYXJlbnQKCiAgICAgICAgaWYgc3BlY19zZXQgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHNwZWMgPSBzcGVjX3NldAogICAgICAgICAgICBzcGVjX3NldCA9IFRydWUKCiAgICAgICAgc2VsZi5fbW9ja19hZGRfc3BlYyhzcGVjLCBzcGVjX3NldCkKCiAgICAgICAgX19kaWN0X19bJ19tb2NrX2NoaWxkcmVuJ10gPSB7fQogICAgICAgIF9fZGljdF9fWydfbW9ja193cmFwcyddID0gd3JhcHMKICAgICAgICBfX2RpY3RfX1snX21vY2tfZGVsZWdhdGUnXSA9IE5vbmUKCiAgICAgICAgX19kaWN0X19bJ19tb2NrX2NhbGxlZCddID0gRmFsc2UKICAgICAgICBfX2RpY3RfX1snX21vY2tfY2FsbF9hcmdzJ10gPSBOb25lCiAgICAgICAgX19kaWN0X19bJ19tb2NrX2NhbGxfY291bnQnXSA9IDAKICAgICAgICBfX2RpY3RfX1snX21vY2tfY2FsbF9hcmdzX2xpc3QnXSA9IF9DYWxsTGlzdCgpCiAgICAgICAgX19kaWN0X19bJ19tb2NrX21vY2tfY2FsbHMnXSA9IF9DYWxsTGlzdCgpCgogICAgICAgIF9fZGljdF9fWydtZXRob2RfY2FsbHMnXSA9IF9DYWxsTGlzdCgpCgogICAgICAgIGlmIGt3YXJnczoKICAgICAgICAgICAgc2VsZi5jb25maWd1cmVfbW9jaygqKmt3YXJncykKCiAgICAgICAgX3NhZmVfc3VwZXIoTm9uQ2FsbGFibGVNb2NrLCBzZWxmKS5fX2luaXRfXygKICAgICAgICAgICAgc3BlYywgd3JhcHMsIG5hbWUsIHNwZWNfc2V0LCBwYXJlbnQsCiAgICAgICAgICAgIF9zcGVjX3N0YXRlCiAgICAgICAgKQoKCiAgICBkZWYgYXR0YWNoX21vY2soc2VsZiwgbW9jaywgYXR0cmlidXRlKToKICAgICAgICAiIiIKICAgICAgICBBdHRhY2ggYSBtb2NrIGFzIGFuIGF0dHJpYnV0ZSBvZiB0aGlzIG9uZSwgcmVwbGFjaW5nIGl0cyBuYW1lIGFuZAogICAgICAgIHBhcmVudC4gQ2FsbHMgdG8gdGhlIGF0dGFjaGVkIG1vY2sgd2lsbCBiZSByZWNvcmRlZCBpbiB0aGUKICAgICAgICBgbWV0aG9kX2NhbGxzYCBhbmQgYG1vY2tfY2FsbHNgIGF0dHJpYnV0ZXMgb2YgdGhpcyBvbmUuIiIiCiAgICAgICAgbW9jay5fbW9ja19wYXJlbnQgPSBOb25lCiAgICAgICAgbW9jay5fbW9ja19uZXdfcGFyZW50ID0gTm9uZQogICAgICAgIG1vY2suX21vY2tfbmFtZSA9ICcnCiAgICAgICAgbW9jay5fbW9ja19uZXdfbmFtZSA9IE5vbmUKCiAgICAgICAgc2V0YXR0cihzZWxmLCBhdHRyaWJ1dGUsIG1vY2spCgoKICAgIGRlZiBtb2NrX2FkZF9zcGVjKHNlbGYsIHNwZWMsIHNwZWNfc2V0PUZhbHNlKToKICAgICAgICAiIiJBZGQgYSBzcGVjIHRvIGEgbW9jay4gYHNwZWNgIGNhbiBlaXRoZXIgYmUgYW4gb2JqZWN0IG9yIGEKICAgICAgICBsaXN0IG9mIHN0cmluZ3MuIE9ubHkgYXR0cmlidXRlcyBvbiB0aGUgYHNwZWNgIGNhbiBiZSBmZXRjaGVkIGFzCiAgICAgICAgYXR0cmlidXRlcyBmcm9tIHRoZSBtb2NrLgoKICAgICAgICBJZiBgc3BlY19zZXRgIGlzIFRydWUgdGhlbiBvbmx5IGF0dHJpYnV0ZXMgb24gdGhlIHNwZWMgY2FuIGJlIHNldC4iIiIKICAgICAgICBzZWxmLl9tb2NrX2FkZF9zcGVjKHNwZWMsIHNwZWNfc2V0KQoKCiAgICBkZWYgX21vY2tfYWRkX3NwZWMoc2VsZiwgc3BlYywgc3BlY19zZXQpOgogICAgICAgIF9zcGVjX2NsYXNzID0gTm9uZQoKICAgICAgICBpZiBzcGVjIGlzIG5vdCBOb25lIGFuZCBub3QgX2lzX2xpc3Qoc3BlYyk6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uoc3BlYywgdHlwZSk6CiAgICAgICAgICAgICAgICBfc3BlY19jbGFzcyA9IHNwZWMKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIF9zcGVjX2NsYXNzID0gX2dldF9jbGFzcyhzcGVjKQoKICAgICAgICAgICAgc3BlYyA9IGRpcihzcGVjKQoKICAgICAgICBfX2RpY3RfXyA9IHNlbGYuX19kaWN0X18KICAgICAgICBfX2RpY3RfX1snX3NwZWNfY2xhc3MnXSA9IF9zcGVjX2NsYXNzCiAgICAgICAgX19kaWN0X19bJ19zcGVjX3NldCddID0gc3BlY19zZXQKICAgICAgICBfX2RpY3RfX1snX21vY2tfbWV0aG9kcyddID0gc3BlYwoKCiAgICBkZWYgX19nZXRfcmV0dXJuX3ZhbHVlKHNlbGYpOgogICAgICAgIHJldCA9IHNlbGYuX21vY2tfcmV0dXJuX3ZhbHVlCiAgICAgICAgaWYgc2VsZi5fbW9ja19kZWxlZ2F0ZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmV0ID0gc2VsZi5fbW9ja19kZWxlZ2F0ZS5yZXR1cm5fdmFsdWUKCiAgICAgICAgaWYgcmV0IGlzIERFRkFVTFQ6CiAgICAgICAgICAgIHJldCA9IHNlbGYuX2dldF9jaGlsZF9tb2NrKAogICAgICAgICAgICAgICAgX25ld19wYXJlbnQ9c2VsZiwgX25ld19uYW1lPScoKScKICAgICAgICAgICAgKQogICAgICAgICAgICBzZWxmLnJldHVybl92YWx1ZSA9IHJldAogICAgICAgIHJldHVybiByZXQKCgogICAgZGVmIF9fc2V0X3JldHVybl92YWx1ZShzZWxmLCB2YWx1ZSk6CiAgICAgICAgaWYgc2VsZi5fbW9ja19kZWxlZ2F0ZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5fbW9ja19kZWxlZ2F0ZS5yZXR1cm5fdmFsdWUgPSB2YWx1ZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuX21vY2tfcmV0dXJuX3ZhbHVlID0gdmFsdWUKICAgICAgICAgICAgX2NoZWNrX2FuZF9zZXRfcGFyZW50KHNlbGYsIHZhbHVlLCBOb25lLCAnKCknKQoKICAgIF9fcmV0dXJuX3ZhbHVlX2RvYyA9ICJUaGUgdmFsdWUgdG8gYmUgcmV0dXJuZWQgd2hlbiB0aGUgbW9jayBpcyBjYWxsZWQuIgogICAgcmV0dXJuX3ZhbHVlID0gcHJvcGVydHkoX19nZXRfcmV0dXJuX3ZhbHVlLCBfX3NldF9yZXR1cm5fdmFsdWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX3JldHVybl92YWx1ZV9kb2MpCgoKICAgIEBwcm9wZXJ0eQogICAgZGVmIF9fY2xhc3NfXyhzZWxmKToKICAgICAgICBpZiBzZWxmLl9zcGVjX2NsYXNzIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiB0eXBlKHNlbGYpCiAgICAgICAgcmV0dXJuIHNlbGYuX3NwZWNfY2xhc3MKCiAgICBjYWxsZWQgPSBfZGVsZWdhdGluZ19wcm9wZXJ0eSgnY2FsbGVkJykKICAgIGNhbGxfY291bnQgPSBfZGVsZWdhdGluZ19wcm9wZXJ0eSgnY2FsbF9jb3VudCcpCiAgICBjYWxsX2FyZ3MgPSBfZGVsZWdhdGluZ19wcm9wZXJ0eSgnY2FsbF9hcmdzJykKICAgIGNhbGxfYXJnc19saXN0ID0gX2RlbGVnYXRpbmdfcHJvcGVydHkoJ2NhbGxfYXJnc19saXN0JykKICAgIG1vY2tfY2FsbHMgPSBfZGVsZWdhdGluZ19wcm9wZXJ0eSgnbW9ja19jYWxscycpCgoKICAgIGRlZiBfX2dldF9zaWRlX2VmZmVjdChzZWxmKToKICAgICAgICBkZWxlZ2F0ZWQgPSBzZWxmLl9tb2NrX2RlbGVnYXRlCiAgICAgICAgaWYgZGVsZWdhdGVkIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9tb2NrX3NpZGVfZWZmZWN0CiAgICAgICAgcmV0dXJuIGRlbGVnYXRlZC5zaWRlX2VmZmVjdAoKICAgIGRlZiBfX3NldF9zaWRlX2VmZmVjdChzZWxmLCB2YWx1ZSk6CiAgICAgICAgdmFsdWUgPSBfdHJ5X2l0ZXIodmFsdWUpCiAgICAgICAgZGVsZWdhdGVkID0gc2VsZi5fbW9ja19kZWxlZ2F0ZQogICAgICAgIGlmIGRlbGVnYXRlZCBpcyBOb25lOgogICAgICAgICAgICBzZWxmLl9tb2NrX3NpZGVfZWZmZWN0ID0gdmFsdWUKICAgICAgICBlbHNlOgogICAgICAgICAgICBkZWxlZ2F0ZWQuc2lkZV9lZmZlY3QgPSB2YWx1ZQoKICAgIHNpZGVfZWZmZWN0ID0gcHJvcGVydHkoX19nZXRfc2lkZV9lZmZlY3QsIF9fc2V0X3NpZGVfZWZmZWN0KQoKCiAgICBkZWYgcmVzZXRfbW9jayhzZWxmKToKICAgICAgICAiUmVzdG9yZSB0aGUgbW9jayBvYmplY3QgdG8gaXRzIGluaXRpYWwgc3RhdGUuIgogICAgICAgIHNlbGYuY2FsbGVkID0gRmFsc2UKICAgICAgICBzZWxmLmNhbGxfYXJncyA9IE5vbmUKICAgICAgICBzZWxmLmNhbGxfY291bnQgPSAwCiAgICAgICAgc2VsZi5tb2NrX2NhbGxzID0gX0NhbGxMaXN0KCkKICAgICAgICBzZWxmLmNhbGxfYXJnc19saXN0ID0gX0NhbGxMaXN0KCkKICAgICAgICBzZWxmLm1ldGhvZF9jYWxscyA9IF9DYWxsTGlzdCgpCgogICAgICAgIGZvciBjaGlsZCBpbiBzZWxmLl9tb2NrX2NoaWxkcmVuLnZhbHVlcygpOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGNoaWxkLCBfU3BlY1N0YXRlKToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGNoaWxkLnJlc2V0X21vY2soKQoKICAgICAgICByZXQgPSBzZWxmLl9tb2NrX3JldHVybl92YWx1ZQogICAgICAgIGlmIF9pc19pbnN0YW5jZV9tb2NrKHJldCkgYW5kIHJldCBpcyBub3Qgc2VsZjoKICAgICAgICAgICAgcmV0LnJlc2V0X21vY2soKQoKCiAgICBkZWYgY29uZmlndXJlX21vY2soc2VsZiwgKiprd2FyZ3MpOgogICAgICAgICIiIlNldCBhdHRyaWJ1dGVzIG9uIHRoZSBtb2NrIHRocm91Z2gga2V5d29yZCBhcmd1bWVudHMuCgogICAgICAgIEF0dHJpYnV0ZXMgcGx1cyByZXR1cm4gdmFsdWVzIGFuZCBzaWRlIGVmZmVjdHMgY2FuIGJlIHNldCBvbiBjaGlsZAogICAgICAgIG1vY2tzIHVzaW5nIHN0YW5kYXJkIGRvdCBub3RhdGlvbiBhbmQgdW5wYWNraW5nIGEgZGljdGlvbmFyeSBpbiB0aGUKICAgICAgICBtZXRob2QgY2FsbDoKCiAgICAgICAgPj4+IGF0dHJzID0geydtZXRob2QucmV0dXJuX3ZhbHVlJzogMywgJ290aGVyLnNpZGVfZWZmZWN0JzogS2V5RXJyb3J9CiAgICAgICAgPj4+IG1vY2suY29uZmlndXJlX21vY2soKiphdHRycykiIiIKICAgICAgICBmb3IgYXJnLCB2YWwgaW4gc29ydGVkKGt3YXJncy5pdGVtcygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB3ZSBzb3J0IG9uIHRoZSBudW1iZXIgb2YgZG90cyBzbyB0aGF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGF0dHJpYnV0ZXMgYXJlIHNldCBiZWZvcmUgd2Ugc2V0IGF0dHJpYnV0ZXMgb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgYXR0cmlidXRlcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PWxhbWJkYSBlbnRyeTogZW50cnlbMF0uY291bnQoJy4nKSk6CiAgICAgICAgICAgIGFyZ3MgPSBhcmcuc3BsaXQoJy4nKQogICAgICAgICAgICBmaW5hbCA9IGFyZ3MucG9wKCkKICAgICAgICAgICAgb2JqID0gc2VsZgogICAgICAgICAgICBmb3IgZW50cnkgaW4gYXJnczoKICAgICAgICAgICAgICAgIG9iaiA9IGdldGF0dHIob2JqLCBlbnRyeSkKICAgICAgICAgICAgc2V0YXR0cihvYmosIGZpbmFsLCB2YWwpCgoKICAgIGRlZiBfX2dldGF0dHJfXyhzZWxmLCBuYW1lKToKICAgICAgICBpZiBuYW1lID09ICdfbW9ja19tZXRob2RzJzoKICAgICAgICAgICAgcmFpc2UgQXR0cmlidXRlRXJyb3IobmFtZSkKICAgICAgICBlbGlmIHNlbGYuX21vY2tfbWV0aG9kcyBpcyBub3QgTm9uZToKICAgICAgICAgICAgaWYgbmFtZSBub3QgaW4gc2VsZi5fbW9ja19tZXRob2RzIG9yIG5hbWUgaW4gX2FsbF9tYWdpY3M6CiAgICAgICAgICAgICAgICByYWlzZSBBdHRyaWJ1dGVFcnJvcigiTW9jayBvYmplY3QgaGFzIG5vIGF0dHJpYnV0ZSAlciIgJSBuYW1lKQogICAgICAgIGVsaWYgX2lzX21hZ2ljKG5hbWUpOgogICAgICAgICAgICByYWlzZSBBdHRyaWJ1dGVFcnJvcihuYW1lKQoKICAgICAgICByZXN1bHQgPSBzZWxmLl9tb2NrX2NoaWxkcmVuLmdldChuYW1lKQogICAgICAgIGlmIHJlc3VsdCBpcyBfZGVsZXRlZDoKICAgICAgICAgICAgcmFpc2UgQXR0cmlidXRlRXJyb3IobmFtZSkKICAgICAgICBlbGlmIHJlc3VsdCBpcyBOb25lOgogICAgICAgICAgICB3cmFwcyA9IE5vbmUKICAgICAgICAgICAgaWYgc2VsZi5fbW9ja193cmFwcyBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICMgWFhYWCBzaG91bGQgd2UgZ2V0IHRoZSBhdHRyaWJ1dGUgd2l0aG91dCB0cmlnZ2VyaW5nIGNvZGUKICAgICAgICAgICAgICAgICMgZXhlY3V0aW9uPwogICAgICAgICAgICAgICAgd3JhcHMgPSBnZXRhdHRyKHNlbGYuX21vY2tfd3JhcHMsIG5hbWUpCgogICAgICAgICAgICByZXN1bHQgPSBzZWxmLl9nZXRfY2hpbGRfbW9jaygKICAgICAgICAgICAgICAgIHBhcmVudD1zZWxmLCBuYW1lPW5hbWUsIHdyYXBzPXdyYXBzLCBfbmV3X25hbWU9bmFtZSwKICAgICAgICAgICAgICAgIF9uZXdfcGFyZW50PXNlbGYKICAgICAgICAgICAgKQogICAgICAgICAgICBzZWxmLl9tb2NrX2NoaWxkcmVuW25hbWVdICA9IHJlc3VsdAoKICAgICAgICBlbGlmIGlzaW5zdGFuY2UocmVzdWx0LCBfU3BlY1N0YXRlKToKICAgICAgICAgICAgcmVzdWx0ID0gY3JlYXRlX2F1dG9zcGVjKAogICAgICAgICAgICAgICAgcmVzdWx0LnNwZWMsIHJlc3VsdC5zcGVjX3NldCwgcmVzdWx0Lmluc3RhbmNlLAogICAgICAgICAgICAgICAgcmVzdWx0LnBhcmVudCwgcmVzdWx0Lm5hbWUKICAgICAgICAgICAgKQogICAgICAgICAgICBzZWxmLl9tb2NrX2NoaWxkcmVuW25hbWVdICA9IHJlc3VsdAoKICAgICAgICByZXR1cm4gcmVzdWx0CgoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICBfbmFtZV9saXN0ID0gW3NlbGYuX21vY2tfbmV3X25hbWVdCiAgICAgICAgX3BhcmVudCA9IHNlbGYuX21vY2tfbmV3X3BhcmVudAogICAgICAgIGxhc3QgPSBzZWxmCgogICAgICAgIGRvdCA9ICcuJwogICAgICAgIGlmIF9uYW1lX2xpc3QgPT0gWycoKSddOgogICAgICAgICAgICBkb3QgPSAnJwogICAgICAgIHNlZW4gPSBzZXQoKQogICAgICAgIHdoaWxlIF9wYXJlbnQgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGxhc3QgPSBfcGFyZW50CgogICAgICAgICAgICBfbmFtZV9saXN0LmFwcGVuZChfcGFyZW50Ll9tb2NrX25ld19uYW1lICsgZG90KQogICAgICAgICAgICBkb3QgPSAnLicKICAgICAgICAgICAgaWYgX3BhcmVudC5fbW9ja19uZXdfbmFtZSA9PSAnKCknOgogICAgICAgICAgICAgICAgZG90ID0gJycKCiAgICAgICAgICAgIF9wYXJlbnQgPSBfcGFyZW50Ll9tb2NrX25ld19wYXJlbnQKCiAgICAgICAgICAgICMgdXNlIGlkcyBoZXJlIHNvIGFzIG5vdCB0byBjYWxsIF9faGFzaF9fIG9uIHRoZSBtb2NrcwogICAgICAgICAgICBpZiBpZChfcGFyZW50KSBpbiBzZWVuOgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgc2Vlbi5hZGQoaWQoX3BhcmVudCkpCgogICAgICAgIF9uYW1lX2xpc3QgPSBsaXN0KHJldmVyc2VkKF9uYW1lX2xpc3QpKQogICAgICAgIF9maXJzdCA9IGxhc3QuX21vY2tfbmFtZSBvciAnbW9jaycKICAgICAgICBpZiBsZW4oX25hbWVfbGlzdCkgPiAxOgogICAgICAgICAgICBpZiBfbmFtZV9saXN0WzFdIG5vdCBpbiAoJygpJywgJygpLicpOgogICAgICAgICAgICAgICAgX2ZpcnN0ICs9ICcuJwogICAgICAgIF9uYW1lX2xpc3RbMF0gPSBfZmlyc3QKICAgICAgICBuYW1lID0gJycuam9pbihfbmFtZV9saXN0KQoKICAgICAgICBuYW1lX3N0cmluZyA9ICcnCiAgICAgICAgaWYgbmFtZSBub3QgaW4gKCdtb2NrJywgJ21vY2suJyk6CiAgICAgICAgICAgIG5hbWVfc3RyaW5nID0gJyBuYW1lPSVyJyAlIG5hbWUKCiAgICAgICAgc3BlY19zdHJpbmcgPSAnJwogICAgICAgIGlmIHNlbGYuX3NwZWNfY2xhc3MgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHNwZWNfc3RyaW5nID0gJyBzcGVjPSVyJwogICAgICAgICAgICBpZiBzZWxmLl9zcGVjX3NldDoKICAgICAgICAgICAgICAgIHNwZWNfc3RyaW5nID0gJyBzcGVjX3NldD0lcicKICAgICAgICAgICAgc3BlY19zdHJpbmcgPSBzcGVjX3N0cmluZyAlIHNlbGYuX3NwZWNfY2xhc3MuX19uYW1lX18KICAgICAgICByZXR1cm4gIjwlcyVzJXMgaWQ9JyVzJz4iICUgKAogICAgICAgICAgICB0eXBlKHNlbGYpLl9fbmFtZV9fLAogICAgICAgICAgICBuYW1lX3N0cmluZywKICAgICAgICAgICAgc3BlY19zdHJpbmcsCiAgICAgICAgICAgIGlkKHNlbGYpCiAgICAgICAgKQoKCiAgICBkZWYgX19kaXJfXyhzZWxmKToKICAgICAgICAiIiJGaWx0ZXIgdGhlIG91dHB1dCBvZiBgZGlyKG1vY2spYCB0byBvbmx5IHVzZWZ1bCBtZW1iZXJzLiIiIgogICAgICAgIGlmIG5vdCBGSUxURVJfRElSOgogICAgICAgICAgICByZXR1cm4gb2JqZWN0Ll9fZGlyX18oc2VsZikKCiAgICAgICAgZXh0cmFzID0gc2VsZi5fbW9ja19tZXRob2RzIG9yIFtdCiAgICAgICAgZnJvbV90eXBlID0gZGlyKHR5cGUoc2VsZikpCiAgICAgICAgZnJvbV9kaWN0ID0gbGlzdChzZWxmLl9fZGljdF9fKQoKICAgICAgICBmcm9tX3R5cGUgPSBbZSBmb3IgZSBpbiBmcm9tX3R5cGUgaWYgbm90IGUuc3RhcnRzd2l0aCgnXycpXQogICAgICAgIGZyb21fZGljdCA9IFtlIGZvciBlIGluIGZyb21fZGljdCBpZiBub3QgZS5zdGFydHN3aXRoKCdfJykgb3IKICAgICAgICAgICAgICAgICAgICAgX2lzX21hZ2ljKGUpXQogICAgICAgIHJldHVybiBzb3J0ZWQoc2V0KGV4dHJhcyArIGZyb21fdHlwZSArIGZyb21fZGljdCArCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChzZWxmLl9tb2NrX2NoaWxkcmVuKSkpCgoKICAgIGRlZiBfX3NldGF0dHJfXyhzZWxmLCBuYW1lLCB2YWx1ZSk6CiAgICAgICAgaWYgbmFtZSBpbiBfYWxsb3dlZF9uYW1lczoKICAgICAgICAgICAgIyBwcm9wZXJ0eSBzZXR0ZXJzIGdvIHRocm91Z2ggaGVyZQogICAgICAgICAgICByZXR1cm4gb2JqZWN0Ll9fc2V0YXR0cl9fKHNlbGYsIG5hbWUsIHZhbHVlKQogICAgICAgIGVsaWYgKHNlbGYuX3NwZWNfc2V0IGFuZCBzZWxmLl9tb2NrX21ldGhvZHMgaXMgbm90IE5vbmUgYW5kCiAgICAgICAgICAgIG5hbWUgbm90IGluIHNlbGYuX21vY2tfbWV0aG9kcyBhbmQKICAgICAgICAgICAgbmFtZSBub3QgaW4gc2VsZi5fX2RpY3RfXyk6CiAgICAgICAgICAgIHJhaXNlIEF0dHJpYnV0ZUVycm9yKCJNb2NrIG9iamVjdCBoYXMgbm8gYXR0cmlidXRlICclcyciICUgbmFtZSkKICAgICAgICBlbGlmIG5hbWUgaW4gX3Vuc3VwcG9ydGVkX21hZ2ljczoKICAgICAgICAgICAgbXNnID0gJ0F0dGVtcHRpbmcgdG8gc2V0IHVuc3VwcG9ydGVkIG1hZ2ljIG1ldGhvZCAlci4nICUgbmFtZQogICAgICAgICAgICByYWlzZSBBdHRyaWJ1dGVFcnJvcihtc2cpCiAgICAgICAgZWxpZiBuYW1lIGluIF9hbGxfbWFnaWNzOgogICAgICAgICAgICBpZiBzZWxmLl9tb2NrX21ldGhvZHMgaXMgbm90IE5vbmUgYW5kIG5hbWUgbm90IGluIHNlbGYuX21vY2tfbWV0aG9kczoKICAgICAgICAgICAgICAgIHJhaXNlIEF0dHJpYnV0ZUVycm9yKCJNb2NrIG9iamVjdCBoYXMgbm8gYXR0cmlidXRlICclcyciICUgbmFtZSkKCiAgICAgICAgICAgIGlmIG5vdCBfaXNfaW5zdGFuY2VfbW9jayh2YWx1ZSk6CiAgICAgICAgICAgICAgICBzZXRhdHRyKHR5cGUoc2VsZiksIG5hbWUsIF9nZXRfbWV0aG9kKG5hbWUsIHZhbHVlKSkKICAgICAgICAgICAgICAgIG9yaWdpbmFsID0gdmFsdWUKICAgICAgICAgICAgICAgIHZhbHVlID0gbGFtYmRhICphcmdzLCAqKmt3OiBvcmlnaW5hbChzZWxmLCAqYXJncywgKiprdykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICMgb25seSBzZXQgX25ld19uYW1lIGFuZCBub3QgbmFtZSBzbyB0aGF0IG1vY2tfY2FsbHMgaXMgdHJhY2tlZAogICAgICAgICAgICAgICAgIyBidXQgbm90IG1ldGhvZCBjYWxscwogICAgICAgICAgICAgICAgX2NoZWNrX2FuZF9zZXRfcGFyZW50KHNlbGYsIHZhbHVlLCBOb25lLCBuYW1lKQogICAgICAgICAgICAgICAgc2V0YXR0cih0eXBlKHNlbGYpLCBuYW1lLCB2YWx1ZSkKICAgICAgICAgICAgICAgIHNlbGYuX21vY2tfY2hpbGRyZW5bbmFtZV0gPSB2YWx1ZQogICAgICAgIGVsaWYgbmFtZSA9PSAnX19jbGFzc19fJzoKICAgICAgICAgICAgc2VsZi5fc3BlY19jbGFzcyA9IHZhbHVlCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIF9jaGVja19hbmRfc2V0X3BhcmVudChzZWxmLCB2YWx1ZSwgbmFtZSwgbmFtZSk6CiAgICAgICAgICAgICAgICBzZWxmLl9tb2NrX2NoaWxkcmVuW25hbWVdID0gdmFsdWUKICAgICAgICByZXR1cm4gb2JqZWN0Ll9fc2V0YXR0cl9fKHNlbGYsIG5hbWUsIHZhbHVlKQoKCiAgICBkZWYgX19kZWxhdHRyX18oc2VsZiwgbmFtZSk6CiAgICAgICAgaWYgbmFtZSBpbiBfYWxsX21hZ2ljcyBhbmQgbmFtZSBpbiB0eXBlKHNlbGYpLl9fZGljdF9fOgogICAgICAgICAgICBkZWxhdHRyKHR5cGUoc2VsZiksIG5hbWUpCiAgICAgICAgICAgIGlmIG5hbWUgbm90IGluIHNlbGYuX19kaWN0X186CiAgICAgICAgICAgICAgICAjIGZvciBtYWdpYyBtZXRob2RzIHRoYXQgYXJlIHN0aWxsIE1hZ2ljUHJveHkgb2JqZWN0cyBhbmQKICAgICAgICAgICAgICAgICMgbm90IHNldCBvbiB0aGUgaW5zdGFuY2UgaXRzZWxmCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgbmFtZSBpbiBzZWxmLl9fZGljdF9fOgogICAgICAgICAgICBvYmplY3QuX19kZWxhdHRyX18oc2VsZiwgbmFtZSkKCiAgICAgICAgb2JqID0gc2VsZi5fbW9ja19jaGlsZHJlbi5nZXQobmFtZSwgX21pc3NpbmcpCiAgICAgICAgaWYgb2JqIGlzIF9kZWxldGVkOgogICAgICAgICAgICByYWlzZSBBdHRyaWJ1dGVFcnJvcihuYW1lKQogICAgICAgIGlmIG9iaiBpcyBub3QgX21pc3Npbmc6CiAgICAgICAgICAgIGRlbCBzZWxmLl9tb2NrX2NoaWxkcmVuW25hbWVdCiAgICAgICAgc2VsZi5fbW9ja19jaGlsZHJlbltuYW1lXSA9IF9kZWxldGVkCgoKCiAgICBkZWYgX2Zvcm1hdF9tb2NrX2NhbGxfc2lnbmF0dXJlKHNlbGYsIGFyZ3MsIGt3YXJncyk6CiAgICAgICAgbmFtZSA9IHNlbGYuX21vY2tfbmFtZSBvciAnbW9jaycKICAgICAgICByZXR1cm4gX2Zvcm1hdF9jYWxsX3NpZ25hdHVyZShuYW1lLCBhcmdzLCBrd2FyZ3MpCgoKICAgIGRlZiBfZm9ybWF0X21vY2tfZmFpbHVyZV9tZXNzYWdlKHNlbGYsIGFyZ3MsIGt3YXJncyk6CiAgICAgICAgbWVzc2FnZSA9ICdFeHBlY3RlZCBjYWxsOiAlc1xuQWN0dWFsIGNhbGw6ICVzJwogICAgICAgIGV4cGVjdGVkX3N0cmluZyA9IHNlbGYuX2Zvcm1hdF9tb2NrX2NhbGxfc2lnbmF0dXJlKGFyZ3MsIGt3YXJncykKICAgICAgICBjYWxsX2FyZ3MgPSBzZWxmLmNhbGxfYXJncwogICAgICAgIGlmIGxlbihjYWxsX2FyZ3MpID09IDM6CiAgICAgICAgICAgIGNhbGxfYXJncyA9IGNhbGxfYXJnc1sxOl0KICAgICAgICBhY3R1YWxfc3RyaW5nID0gc2VsZi5fZm9ybWF0X21vY2tfY2FsbF9zaWduYXR1cmUoKmNhbGxfYXJncykKICAgICAgICByZXR1cm4gbWVzc2FnZSAlIChleHBlY3RlZF9zdHJpbmcsIGFjdHVhbF9zdHJpbmcpCgoKICAgIGRlZiBhc3NlcnRfY2FsbGVkX3dpdGgoX21vY2tfc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAiIiJhc3NlcnQgdGhhdCB0aGUgbW9jayB3YXMgY2FsbGVkIHdpdGggdGhlIHNwZWNpZmllZCBhcmd1bWVudHMuCgogICAgICAgIFJhaXNlcyBhbiBBc3NlcnRpb25FcnJvciBpZiB0aGUgYXJncyBhbmQga2V5d29yZCBhcmdzIHBhc3NlZCBpbiBhcmUKICAgICAgICBkaWZmZXJlbnQgdG8gdGhlIGxhc3QgY2FsbCB0byB0aGUgbW9jay4iIiIKICAgICAgICBzZWxmID0gX21vY2tfc2VsZgogICAgICAgIGlmIHNlbGYuY2FsbF9hcmdzIGlzIE5vbmU6CiAgICAgICAgICAgIGV4cGVjdGVkID0gc2VsZi5fZm9ybWF0X21vY2tfY2FsbF9zaWduYXR1cmUoYXJncywga3dhcmdzKQogICAgICAgICAgICByYWlzZSBBc3NlcnRpb25FcnJvcignRXhwZWN0ZWQgY2FsbDogJXNcbk5vdCBjYWxsZWQnICUgKGV4cGVjdGVkLCkpCgogICAgICAgIGlmIHNlbGYuY2FsbF9hcmdzICE9IChhcmdzLCBrd2FyZ3MpOgogICAgICAgICAgICBtc2cgPSBzZWxmLl9mb3JtYXRfbW9ja19mYWlsdXJlX21lc3NhZ2UoYXJncywga3dhcmdzKQogICAgICAgICAgICByYWlzZSBBc3NlcnRpb25FcnJvcihtc2cpCgoKICAgIGRlZiBhc3NlcnRfY2FsbGVkX29uY2Vfd2l0aChfbW9ja19zZWxmLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgICIiImFzc2VydCB0aGF0IHRoZSBtb2NrIHdhcyBjYWxsZWQgZXhhY3RseSBvbmNlIGFuZCB3aXRoIHRoZSBzcGVjaWZpZWQKICAgICAgICBhcmd1bWVudHMuIiIiCiAgICAgICAgc2VsZiA9IF9tb2NrX3NlbGYKICAgICAgICBpZiBub3Qgc2VsZi5jYWxsX2NvdW50ID09IDE6CiAgICAgICAgICAgIG1zZyA9ICgiRXhwZWN0ZWQgdG8gYmUgY2FsbGVkIG9uY2UuIENhbGxlZCAlcyB0aW1lcy4iICUKICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsbF9jb3VudCkKICAgICAgICAgICAgcmFpc2UgQXNzZXJ0aW9uRXJyb3IobXNnKQogICAgICAgIHJldHVybiBzZWxmLmFzc2VydF9jYWxsZWRfd2l0aCgqYXJncywgKiprd2FyZ3MpCgoKICAgIGRlZiBhc3NlcnRfaGFzX2NhbGxzKHNlbGYsIGNhbGxzLCBhbnlfb3JkZXI9RmFsc2UpOgogICAgICAgICIiImFzc2VydCB0aGUgbW9jayBoYXMgYmVlbiBjYWxsZWQgd2l0aCB0aGUgc3BlY2lmaWVkIGNhbGxzLgogICAgICAgIFRoZSBgbW9ja19jYWxsc2AgbGlzdCBpcyBjaGVja2VkIGZvciB0aGUgY2FsbHMuCgogICAgICAgIElmIGBhbnlfb3JkZXJgIGlzIEZhbHNlICh0aGUgZGVmYXVsdCkgdGhlbiB0aGUgY2FsbHMgbXVzdCBiZQogICAgICAgIHNlcXVlbnRpYWwuIFRoZXJlIGNhbiBiZSBleHRyYSBjYWxscyBiZWZvcmUgb3IgYWZ0ZXIgdGhlCiAgICAgICAgc3BlY2lmaWVkIGNhbGxzLgoKICAgICAgICBJZiBgYW55X29yZGVyYCBpcyBUcnVlIHRoZW4gdGhlIGNhbGxzIGNhbiBiZSBpbiBhbnkgb3JkZXIsIGJ1dAogICAgICAgIHRoZXkgbXVzdCBhbGwgYXBwZWFyIGluIGBtb2NrX2NhbGxzYC4iIiIKICAgICAgICBpZiBub3QgYW55X29yZGVyOgogICAgICAgICAgICBpZiBjYWxscyBub3QgaW4gc2VsZi5tb2NrX2NhbGxzOgogICAgICAgICAgICAgICAgcmFpc2UgQXNzZXJ0aW9uRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgJ0NhbGxzIG5vdCBmb3VuZC5cbkV4cGVjdGVkOiAlclxuJwogICAgICAgICAgICAgICAgICAgICdBY3R1YWw6ICVyJyAlIChjYWxscywgc2VsZi5tb2NrX2NhbGxzKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgYWxsX2NhbGxzID0gbGlzdChzZWxmLm1vY2tfY2FsbHMpCgogICAgICAgIG5vdF9mb3VuZCA9IFtdCiAgICAgICAgZm9yIGthbGwgaW4gY2FsbHM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGFsbF9jYWxscy5yZW1vdmUoa2FsbCkKICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgICAgICBub3RfZm91bmQuYXBwZW5kKGthbGwpCiAgICAgICAgaWYgbm90X2ZvdW5kOgogICAgICAgICAgICByYWlzZSBBc3NlcnRpb25FcnJvcigKICAgICAgICAgICAgICAgICclciBub3QgYWxsIGZvdW5kIGluIGNhbGwgbGlzdCcgJSAodHVwbGUobm90X2ZvdW5kKSwpCiAgICAgICAgICAgICkKCgogICAgZGVmIGFzc2VydF9hbnlfY2FsbChzZWxmLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgICIiImFzc2VydCB0aGUgbW9jayBoYXMgYmVlbiBjYWxsZWQgd2l0aCB0aGUgc3BlY2lmaWVkIGFyZ3VtZW50cy4KCiAgICAgICAgVGhlIGFzc2VydCBwYXNzZXMgaWYgdGhlIG1vY2sgaGFzICpldmVyKiBiZWVuIGNhbGxlZCwgdW5saWtlCiAgICAgICAgYGFzc2VydF9jYWxsZWRfd2l0aGAgYW5kIGBhc3NlcnRfY2FsbGVkX29uY2Vfd2l0aGAgdGhhdCBvbmx5IHBhc3MgaWYKICAgICAgICB0aGUgY2FsbCBpcyB0aGUgbW9zdCByZWNlbnQgb25lLiIiIgogICAgICAgIGthbGwgPSBjYWxsKCphcmdzLCAqKmt3YXJncykKICAgICAgICBpZiBrYWxsIG5vdCBpbiBzZWxmLmNhbGxfYXJnc19saXN0OgogICAgICAgICAgICBleHBlY3RlZF9zdHJpbmcgPSBzZWxmLl9mb3JtYXRfbW9ja19jYWxsX3NpZ25hdHVyZShhcmdzLCBrd2FyZ3MpCiAgICAgICAgICAgIHJhaXNlIEFzc2VydGlvbkVycm9yKAogICAgICAgICAgICAgICAgJyVzIGNhbGwgbm90IGZvdW5kJyAlIGV4cGVjdGVkX3N0cmluZwogICAgICAgICAgICApCgoKICAgIGRlZiBfZ2V0X2NoaWxkX21vY2soc2VsZiwgKiprdyk6CiAgICAgICAgIiIiQ3JlYXRlIHRoZSBjaGlsZCBtb2NrcyBmb3IgYXR0cmlidXRlcyBhbmQgcmV0dXJuIHZhbHVlLgogICAgICAgIEJ5IGRlZmF1bHQgY2hpbGQgbW9ja3Mgd2lsbCBiZSB0aGUgc2FtZSB0eXBlIGFzIHRoZSBwYXJlbnQuCiAgICAgICAgU3ViY2xhc3NlcyBvZiBNb2NrIG1heSB3YW50IHRvIG92ZXJyaWRlIHRoaXMgdG8gY3VzdG9taXplIHRoZSB3YXkKICAgICAgICBjaGlsZCBtb2NrcyBhcmUgbWFkZS4KCiAgICAgICAgRm9yIG5vbi1jYWxsYWJsZSBtb2NrcyB0aGUgY2FsbGFibGUgdmFyaWFudCB3aWxsIGJlIHVzZWQgKHJhdGhlciB0aGFuCiAgICAgICAgYW55IGN1c3RvbSBzdWJjbGFzcykuIiIiCiAgICAgICAgX3R5cGUgPSB0eXBlKHNlbGYpCiAgICAgICAgaWYgbm90IGlzc3ViY2xhc3MoX3R5cGUsIENhbGxhYmxlTWl4aW4pOgogICAgICAgICAgICBpZiBpc3N1YmNsYXNzKF90eXBlLCBOb25DYWxsYWJsZU1hZ2ljTW9jayk6CiAgICAgICAgICAgICAgICBrbGFzcyA9IE1hZ2ljTW9jawogICAgICAgICAgICBlbGlmIGlzc3ViY2xhc3MoX3R5cGUsIE5vbkNhbGxhYmxlTW9jaykgOgogICAgICAgICAgICAgICAga2xhc3MgPSBNb2NrCiAgICAgICAgZWxzZToKICAgICAgICAgICAga2xhc3MgPSBfdHlwZS5fX21yb19fWzFdCiAgICAgICAgcmV0dXJuIGtsYXNzKCoqa3cpCgoKCmRlZiBfdHJ5X2l0ZXIob2JqKToKICAgIGlmIG9iaiBpcyBOb25lOgogICAgICAgIHJldHVybiBvYmoKICAgIGlmIF9pc19leGNlcHRpb24ob2JqKToKICAgICAgICByZXR1cm4gb2JqCiAgICBpZiBfY2FsbGFibGUob2JqKToKICAgICAgICByZXR1cm4gb2JqCiAgICB0cnk6CiAgICAgICAgcmV0dXJuIGl0ZXIob2JqKQogICAgZXhjZXB0IFR5cGVFcnJvcjoKICAgICAgICAjIFhYWFggYmFja3dhcmRzIGNvbXBhdGliaWxpdHkKICAgICAgICAjIGJ1dCB0aGlzIHdpbGwgYmxvdyB1cCBvbiBmaXJzdCBjYWxsIC0gc28gbWF5YmUgd2Ugc2hvdWxkIGZhaWwgZWFybHk/CiAgICAgICAgcmV0dXJuIG9iagoKCgpjbGFzcyBDYWxsYWJsZU1peGluKEJhc2UpOgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzcGVjPU5vbmUsIHNpZGVfZWZmZWN0PU5vbmUsIHJldHVybl92YWx1ZT1ERUZBVUxULAogICAgICAgICAgICAgICAgIHdyYXBzPU5vbmUsIG5hbWU9Tm9uZSwgc3BlY19zZXQ9Tm9uZSwgcGFyZW50PU5vbmUsCiAgICAgICAgICAgICAgICAgX3NwZWNfc3RhdGU9Tm9uZSwgX25ld19uYW1lPScnLCBfbmV3X3BhcmVudD1Ob25lLCAqKmt3YXJncyk6CiAgICAgICAgc2VsZi5fX2RpY3RfX1snX21vY2tfcmV0dXJuX3ZhbHVlJ10gPSByZXR1cm5fdmFsdWUKCiAgICAgICAgX3NhZmVfc3VwZXIoQ2FsbGFibGVNaXhpbiwgc2VsZikuX19pbml0X18oCiAgICAgICAgICAgIHNwZWMsIHdyYXBzLCBuYW1lLCBzcGVjX3NldCwgcGFyZW50LAogICAgICAgICAgICBfc3BlY19zdGF0ZSwgX25ld19uYW1lLCBfbmV3X3BhcmVudCwgKiprd2FyZ3MKICAgICAgICApCgogICAgICAgIHNlbGYuc2lkZV9lZmZlY3QgPSBzaWRlX2VmZmVjdAoKCiAgICBkZWYgX21vY2tfY2hlY2tfc2lnKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgIyBzdHViIG1ldGhvZCB0aGF0IGNhbiBiZSByZXBsYWNlZCB3aXRoIG9uZSB3aXRoIGEgc3BlY2lmaWMgc2lnbmF0dXJlCiAgICAgICAgcGFzcwoKCiAgICBkZWYgX19jYWxsX18oX21vY2tfc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAjIGNhbid0IHVzZSBzZWxmIGluLWNhc2UgYSBmdW5jdGlvbiAvIG1ldGhvZCB3ZSBhcmUgbW9ja2luZyB1c2VzIHNlbGYKICAgICAgICAjIGluIHRoZSBzaWduYXR1cmUKICAgICAgICBfbW9ja19zZWxmLl9tb2NrX2NoZWNrX3NpZygqYXJncywgKiprd2FyZ3MpCiAgICAgICAgcmV0dXJuIF9tb2NrX3NlbGYuX21vY2tfY2FsbCgqYXJncywgKiprd2FyZ3MpCgoKICAgIGRlZiBfbW9ja19jYWxsKF9tb2NrX3NlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgc2VsZiA9IF9tb2NrX3NlbGYKICAgICAgICBzZWxmLmNhbGxlZCA9IFRydWUKICAgICAgICBzZWxmLmNhbGxfY291bnQgKz0gMQogICAgICAgIHNlbGYuY2FsbF9hcmdzID0gX0NhbGwoKGFyZ3MsIGt3YXJncyksIHR3bz1UcnVlKQogICAgICAgIHNlbGYuY2FsbF9hcmdzX2xpc3QuYXBwZW5kKF9DYWxsKChhcmdzLCBrd2FyZ3MpLCB0d289VHJ1ZSkpCgogICAgICAgIF9uZXdfbmFtZSA9IHNlbGYuX21vY2tfbmV3X25hbWUKICAgICAgICBfbmV3X3BhcmVudCA9IHNlbGYuX21vY2tfbmV3X3BhcmVudAogICAgICAgIHNlbGYubW9ja19jYWxscy5hcHBlbmQoX0NhbGwoKCcnLCBhcmdzLCBrd2FyZ3MpKSkKCiAgICAgICAgc2VlbiA9IHNldCgpCiAgICAgICAgc2tpcF9uZXh0X2RvdCA9IF9uZXdfbmFtZSA9PSAnKCknCiAgICAgICAgZG9fbWV0aG9kX2NhbGxzID0gc2VsZi5fbW9ja19wYXJlbnQgaXMgbm90IE5vbmUKICAgICAgICBuYW1lID0gc2VsZi5fbW9ja19uYW1lCiAgICAgICAgd2hpbGUgX25ld19wYXJlbnQgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHRoaXNfbW9ja19jYWxsID0gX0NhbGwoKF9uZXdfbmFtZSwgYXJncywga3dhcmdzKSkKICAgICAgICAgICAgaWYgX25ld19wYXJlbnQuX21vY2tfbmV3X25hbWU6CiAgICAgICAgICAgICAgICBkb3QgPSAnLicKICAgICAgICAgICAgICAgIGlmIHNraXBfbmV4dF9kb3Q6CiAgICAgICAgICAgICAgICAgICAgZG90ID0gJycKCiAgICAgICAgICAgICAgICBza2lwX25leHRfZG90ID0gRmFsc2UKICAgICAgICAgICAgICAgIGlmIF9uZXdfcGFyZW50Ll9tb2NrX25ld19uYW1lID09ICcoKSc6CiAgICAgICAgICAgICAgICAgICAgc2tpcF9uZXh0X2RvdCA9IFRydWUKCiAgICAgICAgICAgICAgICBfbmV3X25hbWUgPSBfbmV3X3BhcmVudC5fbW9ja19uZXdfbmFtZSArIGRvdCArIF9uZXdfbmFtZQoKICAgICAgICAgICAgaWYgZG9fbWV0aG9kX2NhbGxzOgogICAgICAgICAgICAgICAgaWYgX25ld19uYW1lID09IG5hbWU6CiAgICAgICAgICAgICAgICAgICAgdGhpc19tZXRob2RfY2FsbCA9IHRoaXNfbW9ja19jYWxsCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHRoaXNfbWV0aG9kX2NhbGwgPSBfQ2FsbCgobmFtZSwgYXJncywga3dhcmdzKSkKICAgICAgICAgICAgICAgIF9uZXdfcGFyZW50Lm1ldGhvZF9jYWxscy5hcHBlbmQodGhpc19tZXRob2RfY2FsbCkKCiAgICAgICAgICAgICAgICBkb19tZXRob2RfY2FsbHMgPSBfbmV3X3BhcmVudC5fbW9ja19wYXJlbnQgaXMgbm90IE5vbmUKICAgICAgICAgICAgICAgIGlmIGRvX21ldGhvZF9jYWxsczoKICAgICAgICAgICAgICAgICAgICBuYW1lID0gX25ld19wYXJlbnQuX21vY2tfbmFtZSArICcuJyArIG5hbWUKCiAgICAgICAgICAgIF9uZXdfcGFyZW50Lm1vY2tfY2FsbHMuYXBwZW5kKHRoaXNfbW9ja19jYWxsKQogICAgICAgICAgICBfbmV3X3BhcmVudCA9IF9uZXdfcGFyZW50Ll9tb2NrX25ld19wYXJlbnQKCiAgICAgICAgICAgICMgdXNlIGlkcyBoZXJlIHNvIGFzIG5vdCB0byBjYWxsIF9faGFzaF9fIG9uIHRoZSBtb2NrcwogICAgICAgICAgICBfbmV3X3BhcmVudF9pZCA9IGlkKF9uZXdfcGFyZW50KQogICAgICAgICAgICBpZiBfbmV3X3BhcmVudF9pZCBpbiBzZWVuOgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgc2Vlbi5hZGQoX25ld19wYXJlbnRfaWQpCgogICAgICAgIHJldF92YWwgPSBERUZBVUxUCiAgICAgICAgZWZmZWN0ID0gc2VsZi5zaWRlX2VmZmVjdAogICAgICAgIGlmIGVmZmVjdCBpcyBub3QgTm9uZToKICAgICAgICAgICAgaWYgX2lzX2V4Y2VwdGlvbihlZmZlY3QpOgogICAgICAgICAgICAgICAgcmFpc2UgZWZmZWN0CgogICAgICAgICAgICBpZiBub3QgX2NhbGxhYmxlKGVmZmVjdCk6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBuZXh0KGVmZmVjdCkKICAgICAgICAgICAgICAgIGlmIF9pc19leGNlcHRpb24ocmVzdWx0KToKICAgICAgICAgICAgICAgICAgICByYWlzZSByZXN1bHQKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQKCiAgICAgICAgICAgIHJldF92YWwgPSBlZmZlY3QoKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBpZiByZXRfdmFsIGlzIERFRkFVTFQ6CiAgICAgICAgICAgICAgICByZXRfdmFsID0gc2VsZi5yZXR1cm5fdmFsdWUKCiAgICAgICAgaWYgKHNlbGYuX21vY2tfd3JhcHMgaXMgbm90IE5vbmUgYW5kCiAgICAgICAgICAgICBzZWxmLl9tb2NrX3JldHVybl92YWx1ZSBpcyBERUZBVUxUKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX21vY2tfd3JhcHMoKmFyZ3MsICoqa3dhcmdzKQogICAgICAgIGlmIHJldF92YWwgaXMgREVGQVVMVDoKICAgICAgICAgICAgcmV0X3ZhbCA9IHNlbGYucmV0dXJuX3ZhbHVlCiAgICAgICAgcmV0dXJuIHJldF92YWwKCgoKY2xhc3MgTW9jayhDYWxsYWJsZU1peGluLCBOb25DYWxsYWJsZU1vY2spOgogICAgIiIiCiAgICBDcmVhdGUgYSBuZXcgYE1vY2tgIG9iamVjdC4gYE1vY2tgIHRha2VzIHNldmVyYWwgb3B0aW9uYWwgYXJndW1lbnRzCiAgICB0aGF0IHNwZWNpZnkgdGhlIGJlaGF2aW91ciBvZiB0aGUgTW9jayBvYmplY3Q6CgogICAgKiBgc3BlY2A6IFRoaXMgY2FuIGJlIGVpdGhlciBhIGxpc3Qgb2Ygc3RyaW5ncyBvciBhbiBleGlzdGluZyBvYmplY3QgKGEKICAgICAgY2xhc3Mgb3IgaW5zdGFuY2UpIHRoYXQgYWN0cyBhcyB0aGUgc3BlY2lmaWNhdGlvbiBmb3IgdGhlIG1vY2sgb2JqZWN0LiBJZgogICAgICB5b3UgcGFzcyBpbiBhbiBvYmplY3QgdGhlbiBhIGxpc3Qgb2Ygc3RyaW5ncyBpcyBmb3JtZWQgYnkgY2FsbGluZyBkaXIgb24KICAgICAgdGhlIG9iamVjdCAoZXhjbHVkaW5nIHVuc3VwcG9ydGVkIG1hZ2ljIGF0dHJpYnV0ZXMgYW5kIG1ldGhvZHMpLiBBY2Nlc3NpbmcKICAgICAgYW55IGF0dHJpYnV0ZSBub3QgaW4gdGhpcyBsaXN0IHdpbGwgcmFpc2UgYW4gYEF0dHJpYnV0ZUVycm9yYC4KCiAgICAgIElmIGBzcGVjYCBpcyBhbiBvYmplY3QgKHJhdGhlciB0aGFuIGEgbGlzdCBvZiBzdHJpbmdzKSB0aGVuCiAgICAgIGBtb2NrLl9fY2xhc3NfX2AgcmV0dXJucyB0aGUgY2xhc3Mgb2YgdGhlIHNwZWMgb2JqZWN0LiBUaGlzIGFsbG93cyBtb2NrcwogICAgICB0byBwYXNzIGBpc2luc3RhbmNlYCB0ZXN0cy4KCiAgICAqIGBzcGVjX3NldGA6IEEgc3RyaWN0ZXIgdmFyaWFudCBvZiBgc3BlY2AuIElmIHVzZWQsIGF0dGVtcHRpbmcgdG8gKnNldCoKICAgICAgb3IgZ2V0IGFuIGF0dHJpYnV0ZSBvbiB0aGUgbW9jayB0aGF0IGlzbid0IG9uIHRoZSBvYmplY3QgcGFzc2VkIGFzCiAgICAgIGBzcGVjX3NldGAgd2lsbCByYWlzZSBhbiBgQXR0cmlidXRlRXJyb3JgLgoKICAgICogYHNpZGVfZWZmZWN0YDogQSBmdW5jdGlvbiB0byBiZSBjYWxsZWQgd2hlbmV2ZXIgdGhlIE1vY2sgaXMgY2FsbGVkLiBTZWUKICAgICAgdGhlIGBzaWRlX2VmZmVjdGAgYXR0cmlidXRlLiBVc2VmdWwgZm9yIHJhaXNpbmcgZXhjZXB0aW9ucyBvcgogICAgICBkeW5hbWljYWxseSBjaGFuZ2luZyByZXR1cm4gdmFsdWVzLiBUaGUgZnVuY3Rpb24gaXMgY2FsbGVkIHdpdGggdGhlIHNhbWUKICAgICAgYXJndW1lbnRzIGFzIHRoZSBtb2NrLCBhbmQgdW5sZXNzIGl0IHJldHVybnMgYERFRkFVTFRgLCB0aGUgcmV0dXJuCiAgICAgIHZhbHVlIG9mIHRoaXMgZnVuY3Rpb24gaXMgdXNlZCBhcyB0aGUgcmV0dXJuIHZhbHVlLgoKICAgICAgSWYgYHNpZGVfZWZmZWN0YCBpcyBhbiBpdGVyYWJsZSB0aGVuIGVhY2ggY2FsbCB0byB0aGUgbW9jayB3aWxsIHJldHVybgogICAgICB0aGUgbmV4dCB2YWx1ZSBmcm9tIHRoZSBpdGVyYWJsZS4gSWYgYW55IG9mIHRoZSBtZW1iZXJzIG9mIHRoZSBpdGVyYWJsZQogICAgICBhcmUgZXhjZXB0aW9ucyB0aGV5IHdpbGwgYmUgcmFpc2VkIGluc3RlYWQgb2YgcmV0dXJuZWQuCgogICAgICBJZiBgc2lkZV9lZmZlY3RgIGlzIGFuIGl0ZXJhYmxlIHRoZW4gZWFjaCBjYWxsIHRvIHRoZSBtb2NrIHdpbGwgcmV0dXJuCiAgICAgIHRoZSBuZXh0IHZhbHVlIGZyb20gdGhlIGl0ZXJhYmxlLgoKICAgICogYHJldHVybl92YWx1ZWA6IFRoZSB2YWx1ZSByZXR1cm5lZCB3aGVuIHRoZSBtb2NrIGlzIGNhbGxlZC4gQnkgZGVmYXVsdAogICAgICB0aGlzIGlzIGEgbmV3IE1vY2sgKGNyZWF0ZWQgb24gZmlyc3QgYWNjZXNzKS4gU2VlIHRoZQogICAgICBgcmV0dXJuX3ZhbHVlYCBhdHRyaWJ1dGUuCgogICAgKiBgd3JhcHNgOiBJdGVtIGZvciB0aGUgbW9jayBvYmplY3QgdG8gd3JhcC4gSWYgYHdyYXBzYCBpcyBub3QgTm9uZSB0aGVuCiAgICAgIGNhbGxpbmcgdGhlIE1vY2sgd2lsbCBwYXNzIHRoZSBjYWxsIHRocm91Z2ggdG8gdGhlIHdyYXBwZWQgb2JqZWN0CiAgICAgIChyZXR1cm5pbmcgdGhlIHJlYWwgcmVzdWx0KS4gQXR0cmlidXRlIGFjY2VzcyBvbiB0aGUgbW9jayB3aWxsIHJldHVybiBhCiAgICAgIE1vY2sgb2JqZWN0IHRoYXQgd3JhcHMgdGhlIGNvcnJlc3BvbmRpbmcgYXR0cmlidXRlIG9mIHRoZSB3cmFwcGVkIG9iamVjdAogICAgICAoc28gYXR0ZW1wdGluZyB0byBhY2Nlc3MgYW4gYXR0cmlidXRlIHRoYXQgZG9lc24ndCBleGlzdCB3aWxsIHJhaXNlIGFuCiAgICAgIGBBdHRyaWJ1dGVFcnJvcmApLgoKICAgICAgSWYgdGhlIG1vY2sgaGFzIGFuIGV4cGxpY2l0IGByZXR1cm5fdmFsdWVgIHNldCB0aGVuIGNhbGxzIGFyZSBub3QgcGFzc2VkCiAgICAgIHRvIHRoZSB3cmFwcGVkIG9iamVjdCBhbmQgdGhlIGByZXR1cm5fdmFsdWVgIGlzIHJldHVybmVkIGluc3RlYWQuCgogICAgKiBgbmFtZWA6IElmIHRoZSBtb2NrIGhhcyBhIG5hbWUgdGhlbiBpdCB3aWxsIGJlIHVzZWQgaW4gdGhlIHJlcHIgb2YgdGhlCiAgICAgIG1vY2suIFRoaXMgY2FuIGJlIHVzZWZ1bCBmb3IgZGVidWdnaW5nLiBUaGUgbmFtZSBpcyBwcm9wYWdhdGVkIHRvIGNoaWxkCiAgICAgIG1vY2tzLgoKICAgIE1vY2tzIGNhbiBhbHNvIGJlIGNhbGxlZCB3aXRoIGFyYml0cmFyeSBrZXl3b3JkIGFyZ3VtZW50cy4gVGhlc2Ugd2lsbCBiZQogICAgdXNlZCB0byBzZXQgYXR0cmlidXRlcyBvbiB0aGUgbW9jayBhZnRlciBpdCBpcyBjcmVhdGVkLgogICAgIiIiCgoKCmRlZiBfZG90X2xvb2t1cCh0aGluZywgY29tcCwgaW1wb3J0X3BhdGgpOgogICAgdHJ5OgogICAgICAgIHJldHVybiBnZXRhdHRyKHRoaW5nLCBjb21wKQogICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgIF9faW1wb3J0X18oaW1wb3J0X3BhdGgpCiAgICAgICAgcmV0dXJuIGdldGF0dHIodGhpbmcsIGNvbXApCgoKZGVmIF9pbXBvcnRlcih0YXJnZXQpOgogICAgY29tcG9uZW50cyA9IHRhcmdldC5zcGxpdCgnLicpCiAgICBpbXBvcnRfcGF0aCA9IGNvbXBvbmVudHMucG9wKDApCiAgICB0aGluZyA9IF9faW1wb3J0X18oaW1wb3J0X3BhdGgpCgogICAgZm9yIGNvbXAgaW4gY29tcG9uZW50czoKICAgICAgICBpbXBvcnRfcGF0aCArPSAiLiVzIiAlIGNvbXAKICAgICAgICB0aGluZyA9IF9kb3RfbG9va3VwKHRoaW5nLCBjb21wLCBpbXBvcnRfcGF0aCkKICAgIHJldHVybiB0aGluZwoKCmRlZiBfaXNfc3RhcnRlZChwYXRjaGVyKToKICAgICMgWFhYWCBob3JyaWJsZQogICAgcmV0dXJuIGhhc2F0dHIocGF0Y2hlciwgJ2lzX2xvY2FsJykKCgpjbGFzcyBfcGF0Y2gob2JqZWN0KToKCiAgICBhdHRyaWJ1dGVfbmFtZSA9IE5vbmUKICAgIF9hY3RpdmVfcGF0Y2hlcyA9IHNldCgpCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgICAgICBzZWxmLCBnZXR0ZXIsIGF0dHJpYnV0ZSwgbmV3LCBzcGVjLCBjcmVhdGUsCiAgICAgICAgICAgIHNwZWNfc2V0LCBhdXRvc3BlYywgbmV3X2NhbGxhYmxlLCBrd2FyZ3MKICAgICAgICApOgogICAgICAgIGlmIG5ld19jYWxsYWJsZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgaWYgbmV3IGlzIG5vdCBERUZBVUxUOgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgICAgICAgICAiQ2Fubm90IHVzZSAnbmV3JyBhbmQgJ25ld19jYWxsYWJsZScgdG9nZXRoZXIiCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGlmIGF1dG9zcGVjIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgICAgICAgICAiQ2Fubm90IHVzZSAnYXV0b3NwZWMnIGFuZCAnbmV3X2NhbGxhYmxlJyB0b2dldGhlciIKICAgICAgICAgICAgICAgICkKCiAgICAgICAgc2VsZi5nZXR0ZXIgPSBnZXR0ZXIKICAgICAgICBzZWxmLmF0dHJpYnV0ZSA9IGF0dHJpYnV0ZQogICAgICAgIHNlbGYubmV3ID0gbmV3CiAgICAgICAgc2VsZi5uZXdfY2FsbGFibGUgPSBuZXdfY2FsbGFibGUKICAgICAgICBzZWxmLnNwZWMgPSBzcGVjCiAgICAgICAgc2VsZi5jcmVhdGUgPSBjcmVhdGUKICAgICAgICBzZWxmLmhhc19sb2NhbCA9IEZhbHNlCiAgICAgICAgc2VsZi5zcGVjX3NldCA9IHNwZWNfc2V0CiAgICAgICAgc2VsZi5hdXRvc3BlYyA9IGF1dG9zcGVjCiAgICAgICAgc2VsZi5rd2FyZ3MgPSBrd2FyZ3MKICAgICAgICBzZWxmLmFkZGl0aW9uYWxfcGF0Y2hlcnMgPSBbXQoKCiAgICBkZWYgY29weShzZWxmKToKICAgICAgICBwYXRjaGVyID0gX3BhdGNoKAogICAgICAgICAgICBzZWxmLmdldHRlciwgc2VsZi5hdHRyaWJ1dGUsIHNlbGYubmV3LCBzZWxmLnNwZWMsCiAgICAgICAgICAgIHNlbGYuY3JlYXRlLCBzZWxmLnNwZWNfc2V0LAogICAgICAgICAgICBzZWxmLmF1dG9zcGVjLCBzZWxmLm5ld19jYWxsYWJsZSwgc2VsZi5rd2FyZ3MKICAgICAgICApCiAgICAgICAgcGF0Y2hlci5hdHRyaWJ1dGVfbmFtZSA9IHNlbGYuYXR0cmlidXRlX25hbWUKICAgICAgICBwYXRjaGVyLmFkZGl0aW9uYWxfcGF0Y2hlcnMgPSBbCiAgICAgICAgICAgIHAuY29weSgpIGZvciBwIGluIHNlbGYuYWRkaXRpb25hbF9wYXRjaGVycwogICAgICAgIF0KICAgICAgICByZXR1cm4gcGF0Y2hlcgoKCiAgICBkZWYgX19jYWxsX18oc2VsZiwgZnVuYyk6CiAgICAgICAgaWYgaXNpbnN0YW5jZShmdW5jLCB0eXBlKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuZGVjb3JhdGVfY2xhc3MoZnVuYykKICAgICAgICByZXR1cm4gc2VsZi5kZWNvcmF0ZV9jYWxsYWJsZShmdW5jKQoKCiAgICBkZWYgZGVjb3JhdGVfY2xhc3Moc2VsZiwga2xhc3MpOgogICAgICAgIGZvciBhdHRyIGluIGRpcihrbGFzcyk6CiAgICAgICAgICAgIGlmIG5vdCBhdHRyLnN0YXJ0c3dpdGgocGF0Y2guVEVTVF9QUkVGSVgpOgogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIGF0dHJfdmFsdWUgPSBnZXRhdHRyKGtsYXNzLCBhdHRyKQogICAgICAgICAgICBpZiBub3QgaGFzYXR0cihhdHRyX3ZhbHVlLCAiX19jYWxsX18iKToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBwYXRjaGVyID0gc2VsZi5jb3B5KCkKICAgICAgICAgICAgc2V0YXR0cihrbGFzcywgYXR0ciwgcGF0Y2hlcihhdHRyX3ZhbHVlKSkKICAgICAgICByZXR1cm4ga2xhc3MKCgogICAgZGVmIGRlY29yYXRlX2NhbGxhYmxlKHNlbGYsIGZ1bmMpOgogICAgICAgIGlmIGhhc2F0dHIoZnVuYywgJ3BhdGNoaW5ncycpOgogICAgICAgICAgICBmdW5jLnBhdGNoaW5ncy5hcHBlbmQoc2VsZikKICAgICAgICAgICAgcmV0dXJuIGZ1bmMKCiAgICAgICAgQHdyYXBzKGZ1bmMpCiAgICAgICAgZGVmIHBhdGNoZWQoKmFyZ3MsICoqa2V5d2FyZ3MpOgogICAgICAgICAgICBleHRyYV9hcmdzID0gW10KICAgICAgICAgICAgZW50ZXJlZF9wYXRjaGVycyA9IFtdCgogICAgICAgICAgICBleGNfaW5mbyA9IHR1cGxlKCkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZm9yIHBhdGNoaW5nIGluIHBhdGNoZWQucGF0Y2hpbmdzOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IHBhdGNoaW5nLl9fZW50ZXJfXygpCiAgICAgICAgICAgICAgICAgICAgZW50ZXJlZF9wYXRjaGVycy5hcHBlbmQocGF0Y2hpbmcpCiAgICAgICAgICAgICAgICAgICAgaWYgcGF0Y2hpbmcuYXR0cmlidXRlX25hbWUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIGtleXdhcmdzLnVwZGF0ZShhcmcpCiAgICAgICAgICAgICAgICAgICAgZWxpZiBwYXRjaGluZy5uZXcgaXMgREVGQVVMVDoKICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFfYXJncy5hcHBlbmQoYXJnKQoKICAgICAgICAgICAgICAgIGFyZ3MgKz0gdHVwbGUoZXh0cmFfYXJncykKICAgICAgICAgICAgICAgIHJldHVybiBmdW5jKCphcmdzLCAqKmtleXdhcmdzKQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBpZiAocGF0Y2hpbmcgbm90IGluIGVudGVyZWRfcGF0Y2hlcnMgYW5kCiAgICAgICAgICAgICAgICAgICAgX2lzX3N0YXJ0ZWQocGF0Y2hpbmcpKToKICAgICAgICAgICAgICAgICAgICAjIHRoZSBwYXRjaGVyIG1heSBoYXZlIGJlZW4gc3RhcnRlZCwgYnV0IGFuIGV4Y2VwdGlvbgogICAgICAgICAgICAgICAgICAgICMgcmFpc2VkIHdoaWxzdCBlbnRlcmluZyBvbmUgb2YgaXRzIGFkZGl0aW9uYWxfcGF0Y2hlcnMKICAgICAgICAgICAgICAgICAgICBlbnRlcmVkX3BhdGNoZXJzLmFwcGVuZChwYXRjaGluZykKICAgICAgICAgICAgICAgICMgUGFzcyB0aGUgZXhjZXB0aW9uIHRvIF9fZXhpdF9fCiAgICAgICAgICAgICAgICBleGNfaW5mbyA9IHN5cy5leGNfaW5mbygpCiAgICAgICAgICAgICAgICAjIHJlLXJhaXNlIHRoZSBleGNlcHRpb24KICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgICAgICBmb3IgcGF0Y2hpbmcgaW4gcmV2ZXJzZWQoZW50ZXJlZF9wYXRjaGVycyk6CiAgICAgICAgICAgICAgICAgICAgcGF0Y2hpbmcuX19leGl0X18oKmV4Y19pbmZvKQoKICAgICAgICBwYXRjaGVkLnBhdGNoaW5ncyA9IFtzZWxmXQogICAgICAgIHJldHVybiBwYXRjaGVkCgoKICAgIGRlZiBnZXRfb3JpZ2luYWwoc2VsZik6CiAgICAgICAgdGFyZ2V0ID0gc2VsZi5nZXR0ZXIoKQogICAgICAgIG5hbWUgPSBzZWxmLmF0dHJpYnV0ZQoKICAgICAgICBvcmlnaW5hbCA9IERFRkFVTFQKICAgICAgICBsb2NhbCA9IEZhbHNlCgogICAgICAgIHRyeToKICAgICAgICAgICAgb3JpZ2luYWwgPSB0YXJnZXQuX19kaWN0X19bbmFtZV0KICAgICAgICBleGNlcHQgKEF0dHJpYnV0ZUVycm9yLCBLZXlFcnJvcik6CiAgICAgICAgICAgIG9yaWdpbmFsID0gZ2V0YXR0cih0YXJnZXQsIG5hbWUsIERFRkFVTFQpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbG9jYWwgPSBUcnVlCgogICAgICAgIGlmIG5vdCBzZWxmLmNyZWF0ZSBhbmQgb3JpZ2luYWwgaXMgREVGQVVMVDoKICAgICAgICAgICAgcmFpc2UgQXR0cmlidXRlRXJyb3IoCiAgICAgICAgICAgICAgICAiJXMgZG9lcyBub3QgaGF2ZSB0aGUgYXR0cmlidXRlICVyIiAlICh0YXJnZXQsIG5hbWUpCiAgICAgICAgICAgICkKICAgICAgICByZXR1cm4gb3JpZ2luYWwsIGxvY2FsCgoKICAgIGRlZiBfX2VudGVyX18oc2VsZik6CiAgICAgICAgIiIiUGVyZm9ybSB0aGUgcGF0Y2guIiIiCiAgICAgICAgbmV3LCBzcGVjLCBzcGVjX3NldCA9IHNlbGYubmV3LCBzZWxmLnNwZWMsIHNlbGYuc3BlY19zZXQKICAgICAgICBhdXRvc3BlYywga3dhcmdzID0gc2VsZi5hdXRvc3BlYywgc2VsZi5rd2FyZ3MKICAgICAgICBuZXdfY2FsbGFibGUgPSBzZWxmLm5ld19jYWxsYWJsZQogICAgICAgIHNlbGYudGFyZ2V0ID0gc2VsZi5nZXR0ZXIoKQoKICAgICAgICAjIG5vcm1hbGlzZSBGYWxzZSB0byBOb25lCiAgICAgICAgaWYgc3BlYyBpcyBGYWxzZToKICAgICAgICAgICAgc3BlYyA9IE5vbmUKICAgICAgICBpZiBzcGVjX3NldCBpcyBGYWxzZToKICAgICAgICAgICAgc3BlY19zZXQgPSBOb25lCiAgICAgICAgaWYgYXV0b3NwZWMgaXMgRmFsc2U6CiAgICAgICAgICAgIGF1dG9zcGVjID0gTm9uZQoKICAgICAgICBpZiBzcGVjIGlzIG5vdCBOb25lIGFuZCBhdXRvc3BlYyBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJDYW4ndCBzcGVjaWZ5IHNwZWMgYW5kIGF1dG9zcGVjIikKICAgICAgICBpZiAoKHNwZWMgaXMgbm90IE5vbmUgb3IgYXV0b3NwZWMgaXMgbm90IE5vbmUpIGFuZAogICAgICAgICAgICBzcGVjX3NldCBub3QgaW4gKFRydWUsIE5vbmUpKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJDYW4ndCBwcm92aWRlIGV4cGxpY2l0IHNwZWNfc2V0ICphbmQqIHNwZWMgb3IgYXV0b3NwZWMiKQoKICAgICAgICBvcmlnaW5hbCwgbG9jYWwgPSBzZWxmLmdldF9vcmlnaW5hbCgpCgogICAgICAgIGlmIG5ldyBpcyBERUZBVUxUIGFuZCBhdXRvc3BlYyBpcyBOb25lOgogICAgICAgICAgICBpbmhlcml0ID0gRmFsc2UKICAgICAgICAgICAgaWYgc3BlYyBpcyBUcnVlOgogICAgICAgICAgICAgICAgIyBzZXQgc3BlYyB0byB0aGUgb2JqZWN0IHdlIGFyZSByZXBsYWNpbmcKICAgICAgICAgICAgICAgIHNwZWMgPSBvcmlnaW5hbAogICAgICAgICAgICAgICAgaWYgc3BlY19zZXQgaXMgVHJ1ZToKICAgICAgICAgICAgICAgICAgICBzcGVjX3NldCA9IG9yaWdpbmFsCiAgICAgICAgICAgICAgICAgICAgc3BlYyA9IE5vbmUKICAgICAgICAgICAgZWxpZiBzcGVjIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgaWYgc3BlY19zZXQgaXMgVHJ1ZToKICAgICAgICAgICAgICAgICAgICBzcGVjX3NldCA9IHNwZWMKICAgICAgICAgICAgICAgICAgICBzcGVjID0gTm9uZQogICAgICAgICAgICBlbGlmIHNwZWNfc2V0IGlzIFRydWU6CiAgICAgICAgICAgICAgICBzcGVjX3NldCA9IG9yaWdpbmFsCgogICAgICAgICAgICBpZiBzcGVjIGlzIG5vdCBOb25lIG9yIHNwZWNfc2V0IGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgaWYgb3JpZ2luYWwgaXMgREVGQVVMVDoKICAgICAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIkNhbid0IHVzZSAnc3BlYycgd2l0aCBjcmVhdGU9VHJ1ZSIpCiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKG9yaWdpbmFsLCB0eXBlKToKICAgICAgICAgICAgICAgICAgICAjIElmIHdlJ3JlIHBhdGNoaW5nIG91dCBhIGNsYXNzIGFuZCB0aGVyZSBpcyBhIHNwZWMKICAgICAgICAgICAgICAgICAgICBpbmhlcml0ID0gVHJ1ZQoKICAgICAgICAgICAgS2xhc3MgPSBNYWdpY01vY2sKICAgICAgICAgICAgX2t3YXJncyA9IHt9CiAgICAgICAgICAgIGlmIG5ld19jYWxsYWJsZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIEtsYXNzID0gbmV3X2NhbGxhYmxlCiAgICAgICAgICAgIGVsaWYgc3BlYyBpcyBub3QgTm9uZSBvciBzcGVjX3NldCBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHRoaXNfc3BlYyA9IHNwZWMKICAgICAgICAgICAgICAgIGlmIHNwZWNfc2V0IGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIHRoaXNfc3BlYyA9IHNwZWNfc2V0CiAgICAgICAgICAgICAgICBpZiBfaXNfbGlzdCh0aGlzX3NwZWMpOgogICAgICAgICAgICAgICAgICAgIG5vdF9jYWxsYWJsZSA9ICdfX2NhbGxfXycgbm90IGluIHRoaXNfc3BlYwogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBub3RfY2FsbGFibGUgPSBub3QgY2FsbGFibGUodGhpc19zcGVjKQogICAgICAgICAgICAgICAgaWYgbm90X2NhbGxhYmxlOgogICAgICAgICAgICAgICAgICAgIEtsYXNzID0gTm9uQ2FsbGFibGVNYWdpY01vY2sKCiAgICAgICAgICAgIGlmIHNwZWMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBfa3dhcmdzWydzcGVjJ10gPSBzcGVjCiAgICAgICAgICAgIGlmIHNwZWNfc2V0IGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgX2t3YXJnc1snc3BlY19zZXQnXSA9IHNwZWNfc2V0CgogICAgICAgICAgICAjIGFkZCBhIG5hbWUgdG8gbW9ja3MKICAgICAgICAgICAgaWYgKGlzaW5zdGFuY2UoS2xhc3MsIHR5cGUpIGFuZAogICAgICAgICAgICAgICAgaXNzdWJjbGFzcyhLbGFzcywgTm9uQ2FsbGFibGVNb2NrKSBhbmQgc2VsZi5hdHRyaWJ1dGUpOgogICAgICAgICAgICAgICAgX2t3YXJnc1snbmFtZSddID0gc2VsZi5hdHRyaWJ1dGUKCiAgICAgICAgICAgIF9rd2FyZ3MudXBkYXRlKGt3YXJncykKICAgICAgICAgICAgbmV3ID0gS2xhc3MoKipfa3dhcmdzKQoKICAgICAgICAgICAgaWYgaW5oZXJpdCBhbmQgX2lzX2luc3RhbmNlX21vY2sobmV3KToKICAgICAgICAgICAgICAgICMgd2UgY2FuIG9ubHkgdGVsbCBpZiB0aGUgaW5zdGFuY2Ugc2hvdWxkIGJlIGNhbGxhYmxlIGlmIHRoZQogICAgICAgICAgICAgICAgIyBzcGVjIGlzIG5vdCBhIGxpc3QKICAgICAgICAgICAgICAgIHRoaXNfc3BlYyA9IHNwZWMKICAgICAgICAgICAgICAgIGlmIHNwZWNfc2V0IGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIHRoaXNfc3BlYyA9IHNwZWNfc2V0CiAgICAgICAgICAgICAgICBpZiAobm90IF9pc19saXN0KHRoaXNfc3BlYykgYW5kIG5vdAogICAgICAgICAgICAgICAgICAgIF9pbnN0YW5jZV9jYWxsYWJsZSh0aGlzX3NwZWMpKToKICAgICAgICAgICAgICAgICAgICBLbGFzcyA9IE5vbkNhbGxhYmxlTWFnaWNNb2NrCgogICAgICAgICAgICAgICAgX2t3YXJncy5wb3AoJ25hbWUnKQogICAgICAgICAgICAgICAgbmV3LnJldHVybl92YWx1ZSA9IEtsYXNzKF9uZXdfcGFyZW50PW5ldywgX25ld19uYW1lPScoKScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKipfa3dhcmdzKQogICAgICAgIGVsaWYgYXV0b3NwZWMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICMgc3BlYyBpcyBpZ25vcmVkLCBuZXcgKm11c3QqIGJlIGRlZmF1bHQsIHNwZWNfc2V0IGlzIHRyZWF0ZWQKICAgICAgICAgICAgIyBhcyBhIGJvb2xlYW4uIFNob3VsZCB3ZSBjaGVjayBzcGVjIGlzIG5vdCBOb25lIGFuZCB0aGF0IHNwZWNfc2V0CiAgICAgICAgICAgICMgaXMgYSBib29sPwogICAgICAgICAgICBpZiBuZXcgaXMgbm90IERFRkFVTFQ6CiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgImF1dG9zcGVjIGNyZWF0ZXMgdGhlIG1vY2sgZm9yIHlvdS4gQ2FuJ3Qgc3BlY2lmeSAiCiAgICAgICAgICAgICAgICAgICAgImF1dG9zcGVjIGFuZCBuZXcuIgogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBpZiBvcmlnaW5hbCBpcyBERUZBVUxUOgogICAgICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJDYW4ndCB1c2UgJ2F1dG9zcGVjJyB3aXRoIGNyZWF0ZT1UcnVlIikKICAgICAgICAgICAgc3BlY19zZXQgPSBib29sKHNwZWNfc2V0KQogICAgICAgICAgICBpZiBhdXRvc3BlYyBpcyBUcnVlOgogICAgICAgICAgICAgICAgYXV0b3NwZWMgPSBvcmlnaW5hbAoKICAgICAgICAgICAgbmV3ID0gY3JlYXRlX2F1dG9zcGVjKGF1dG9zcGVjLCBzcGVjX3NldD1zcGVjX3NldCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9uYW1lPXNlbGYuYXR0cmlidXRlLCAqKmt3YXJncykKICAgICAgICBlbGlmIGt3YXJnczoKICAgICAgICAgICAgIyBjYW4ndCBzZXQga2V5d29yZCBhcmdzIHdoZW4gd2UgYXJlbid0IGNyZWF0aW5nIHRoZSBtb2NrCiAgICAgICAgICAgICMgWFhYWCBJZiBuZXcgaXMgYSBNb2NrIHdlIGNvdWxkIGNhbGwgbmV3LmNvbmZpZ3VyZV9tb2NrKCoqa3dhcmdzKQogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIkNhbid0IHBhc3Mga3dhcmdzIHRvIGEgbW9jayB3ZSBhcmVuJ3QgY3JlYXRpbmciKQoKICAgICAgICBuZXdfYXR0ciA9IG5ldwoKICAgICAgICBzZWxmLnRlbXBfb3JpZ2luYWwgPSBvcmlnaW5hbAogICAgICAgIHNlbGYuaXNfbG9jYWwgPSBsb2NhbAogICAgICAgIHNldGF0dHIoc2VsZi50YXJnZXQsIHNlbGYuYXR0cmlidXRlLCBuZXdfYXR0cikKICAgICAgICBpZiBzZWxmLmF0dHJpYnV0ZV9uYW1lIGlzIG5vdCBOb25lOgogICAgICAgICAgICBleHRyYV9hcmdzID0ge30KICAgICAgICAgICAgaWYgc2VsZi5uZXcgaXMgREVGQVVMVDoKICAgICAgICAgICAgICAgIGV4dHJhX2FyZ3Nbc2VsZi5hdHRyaWJ1dGVfbmFtZV0gPSAgbmV3CiAgICAgICAgICAgIGZvciBwYXRjaGluZyBpbiBzZWxmLmFkZGl0aW9uYWxfcGF0Y2hlcnM6CiAgICAgICAgICAgICAgICBhcmcgPSBwYXRjaGluZy5fX2VudGVyX18oKQogICAgICAgICAgICAgICAgaWYgcGF0Y2hpbmcubmV3IGlzIERFRkFVTFQ6CiAgICAgICAgICAgICAgICAgICAgZXh0cmFfYXJncy51cGRhdGUoYXJnKQogICAgICAgICAgICByZXR1cm4gZXh0cmFfYXJncwoKICAgICAgICByZXR1cm4gbmV3CgoKICAgIGRlZiBfX2V4aXRfXyhzZWxmLCAqZXhjX2luZm8pOgogICAgICAgICIiIlVuZG8gdGhlIHBhdGNoLiIiIgogICAgICAgIGlmIG5vdCBfaXNfc3RhcnRlZChzZWxmKToKICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCdzdG9wIGNhbGxlZCBvbiB1bnN0YXJ0ZWQgcGF0Y2hlcicpCgogICAgICAgIGlmIHNlbGYuaXNfbG9jYWwgYW5kIHNlbGYudGVtcF9vcmlnaW5hbCBpcyBub3QgREVGQVVMVDoKICAgICAgICAgICAgc2V0YXR0cihzZWxmLnRhcmdldCwgc2VsZi5hdHRyaWJ1dGUsIHNlbGYudGVtcF9vcmlnaW5hbCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBkZWxhdHRyKHNlbGYudGFyZ2V0LCBzZWxmLmF0dHJpYnV0ZSkKICAgICAgICAgICAgaWYgbm90IHNlbGYuY3JlYXRlIGFuZCBub3QgaGFzYXR0cihzZWxmLnRhcmdldCwgc2VsZi5hdHRyaWJ1dGUpOgogICAgICAgICAgICAgICAgIyBuZWVkZWQgZm9yIHByb3h5IG9iamVjdHMgbGlrZSBkamFuZ28gc2V0dGluZ3MKICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZi50YXJnZXQsIHNlbGYuYXR0cmlidXRlLCBzZWxmLnRlbXBfb3JpZ2luYWwpCgogICAgICAgIGRlbCBzZWxmLnRlbXBfb3JpZ2luYWwKICAgICAgICBkZWwgc2VsZi5pc19sb2NhbAogICAgICAgIGRlbCBzZWxmLnRhcmdldAogICAgICAgIGZvciBwYXRjaGVyIGluIHJldmVyc2VkKHNlbGYuYWRkaXRpb25hbF9wYXRjaGVycyk6CiAgICAgICAgICAgIGlmIF9pc19zdGFydGVkKHBhdGNoZXIpOgogICAgICAgICAgICAgICAgcGF0Y2hlci5fX2V4aXRfXygqZXhjX2luZm8pCgoKICAgIGRlZiBzdGFydChzZWxmKToKICAgICAgICAiIiJBY3RpdmF0ZSBhIHBhdGNoLCByZXR1cm5pbmcgYW55IGNyZWF0ZWQgbW9jay4iIiIKICAgICAgICByZXN1bHQgPSBzZWxmLl9fZW50ZXJfXygpCiAgICAgICAgc2VsZi5fYWN0aXZlX3BhdGNoZXMuYWRkKHNlbGYpCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKCiAgICBkZWYgc3RvcChzZWxmKToKICAgICAgICAiIiJTdG9wIGFuIGFjdGl2ZSBwYXRjaC4iIiIKICAgICAgICBzZWxmLl9hY3RpdmVfcGF0Y2hlcy5kaXNjYXJkKHNlbGYpCiAgICAgICAgcmV0dXJuIHNlbGYuX19leGl0X18oKQoKCgpkZWYgX2dldF90YXJnZXQodGFyZ2V0KToKICAgIHRyeToKICAgICAgICB0YXJnZXQsIGF0dHJpYnV0ZSA9IHRhcmdldC5yc3BsaXQoJy4nLCAxKQogICAgZXhjZXB0IChUeXBlRXJyb3IsIFZhbHVlRXJyb3IpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcigiTmVlZCBhIHZhbGlkIHRhcmdldCB0byBwYXRjaC4gWW91IHN1cHBsaWVkOiAlciIgJQogICAgICAgICAgICAgICAgICAgICAgICAodGFyZ2V0LCkpCiAgICBnZXR0ZXIgPSBsYW1iZGE6IF9pbXBvcnRlcih0YXJnZXQpCiAgICByZXR1cm4gZ2V0dGVyLCBhdHRyaWJ1dGUKCgpkZWYgX3BhdGNoX29iamVjdCgKICAgICAgICB0YXJnZXQsIGF0dHJpYnV0ZSwgbmV3PURFRkFVTFQsIHNwZWM9Tm9uZSwKICAgICAgICBjcmVhdGU9RmFsc2UsIHNwZWNfc2V0PU5vbmUsIGF1dG9zcGVjPU5vbmUsCiAgICAgICAgbmV3X2NhbGxhYmxlPU5vbmUsICoqa3dhcmdzCiAgICApOgogICAgIiIiCiAgICBwYXRjaCB0aGUgbmFtZWQgbWVtYmVyIChgYXR0cmlidXRlYCkgb24gYW4gb2JqZWN0IChgdGFyZ2V0YCkgd2l0aCBhIG1vY2sKICAgIG9iamVjdC4KCiAgICBgcGF0Y2gub2JqZWN0YCBjYW4gYmUgdXNlZCBhcyBhIGRlY29yYXRvciwgY2xhc3MgZGVjb3JhdG9yIG9yIGEgY29udGV4dAogICAgbWFuYWdlci4gQXJndW1lbnRzIGBuZXdgLCBgc3BlY2AsIGBjcmVhdGVgLCBgc3BlY19zZXRgLAogICAgYGF1dG9zcGVjYCBhbmQgYG5ld19jYWxsYWJsZWAgaGF2ZSB0aGUgc2FtZSBtZWFuaW5nIGFzIGZvciBgcGF0Y2hgLiBMaWtlCiAgICBgcGF0Y2hgLCBgcGF0Y2gub2JqZWN0YCB0YWtlcyBhcmJpdHJhcnkga2V5d29yZCBhcmd1bWVudHMgZm9yIGNvbmZpZ3VyaW5nCiAgICB0aGUgbW9jayBvYmplY3QgaXQgY3JlYXRlcy4KCiAgICBXaGVuIHVzZWQgYXMgYSBjbGFzcyBkZWNvcmF0b3IgYHBhdGNoLm9iamVjdGAgaG9ub3VycyBgcGF0Y2guVEVTVF9QUkVGSVhgCiAgICBmb3IgY2hvb3Npbmcgd2hpY2ggbWV0aG9kcyB0byB3cmFwLgogICAgIiIiCiAgICBnZXR0ZXIgPSBsYW1iZGE6IHRhcmdldAogICAgcmV0dXJuIF9wYXRjaCgKICAgICAgICBnZXR0ZXIsIGF0dHJpYnV0ZSwgbmV3LCBzcGVjLCBjcmVhdGUsCiAgICAgICAgc3BlY19zZXQsIGF1dG9zcGVjLCBuZXdfY2FsbGFibGUsIGt3YXJncwogICAgKQoKCmRlZiBfcGF0Y2hfbXVsdGlwbGUodGFyZ2V0LCBzcGVjPU5vbmUsIGNyZWF0ZT1GYWxzZSwgc3BlY19zZXQ9Tm9uZSwKICAgICAgICAgICAgICAgICAgICBhdXRvc3BlYz1Ob25lLCBuZXdfY2FsbGFibGU9Tm9uZSwgKiprd2FyZ3MpOgogICAgIiIiUGVyZm9ybSBtdWx0aXBsZSBwYXRjaGVzIGluIGEgc2luZ2xlIGNhbGwuIEl0IHRha2VzIHRoZSBvYmplY3QgdG8gYmUKICAgIHBhdGNoZWQgKGVpdGhlciBhcyBhbiBvYmplY3Qgb3IgYSBzdHJpbmcgdG8gZmV0Y2ggdGhlIG9iamVjdCBieSBpbXBvcnRpbmcpCiAgICBhbmQga2V5d29yZCBhcmd1bWVudHMgZm9yIHRoZSBwYXRjaGVzOjoKCiAgICAgICAgd2l0aCBwYXRjaC5tdWx0aXBsZShzZXR0aW5ncywgRklSU1RfUEFUQ0g9J29uZScsIFNFQ09ORF9QQVRDSD0ndHdvJyk6CiAgICAgICAgICAgIC4uLgoKICAgIFVzZSBgREVGQVVMVGAgYXMgdGhlIHZhbHVlIGlmIHlvdSB3YW50IGBwYXRjaC5tdWx0aXBsZWAgdG8gY3JlYXRlCiAgICBtb2NrcyBmb3IgeW91LiBJbiB0aGlzIGNhc2UgdGhlIGNyZWF0ZWQgbW9ja3MgYXJlIHBhc3NlZCBpbnRvIGEgZGVjb3JhdGVkCiAgICBmdW5jdGlvbiBieSBrZXl3b3JkLCBhbmQgYSBkaWN0aW9uYXJ5IGlzIHJldHVybmVkIHdoZW4gYHBhdGNoLm11bHRpcGxlYCBpcwogICAgdXNlZCBhcyBhIGNvbnRleHQgbWFuYWdlci4KCiAgICBgcGF0Y2gubXVsdGlwbGVgIGNhbiBiZSB1c2VkIGFzIGEgZGVjb3JhdG9yLCBjbGFzcyBkZWNvcmF0b3Igb3IgYSBjb250ZXh0CiAgICBtYW5hZ2VyLiBUaGUgYXJndW1lbnRzIGBzcGVjYCwgYHNwZWNfc2V0YCwgYGNyZWF0ZWAsCiAgICBgYXV0b3NwZWNgIGFuZCBgbmV3X2NhbGxhYmxlYCBoYXZlIHRoZSBzYW1lIG1lYW5pbmcgYXMgZm9yIGBwYXRjaGAuIFRoZXNlCiAgICBhcmd1bWVudHMgd2lsbCBiZSBhcHBsaWVkIHRvICphbGwqIHBhdGNoZXMgZG9uZSBieSBgcGF0Y2gubXVsdGlwbGVgLgoKICAgIFdoZW4gdXNlZCBhcyBhIGNsYXNzIGRlY29yYXRvciBgcGF0Y2gubXVsdGlwbGVgIGhvbm91cnMgYHBhdGNoLlRFU1RfUFJFRklYYAogICAgZm9yIGNob29zaW5nIHdoaWNoIG1ldGhvZHMgdG8gd3JhcC4KICAgICIiIgogICAgaWYgdHlwZSh0YXJnZXQpIGlzIHN0cjoKICAgICAgICBnZXR0ZXIgPSBsYW1iZGE6IF9pbXBvcnRlcih0YXJnZXQpCiAgICBlbHNlOgogICAgICAgIGdldHRlciA9IGxhbWJkYTogdGFyZ2V0CgogICAgaWYgbm90IGt3YXJnczoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKAogICAgICAgICAgICAnTXVzdCBzdXBwbHkgYXQgbGVhc3Qgb25lIGtleXdvcmQgYXJndW1lbnQgd2l0aCBwYXRjaC5tdWx0aXBsZScKICAgICAgICApCiAgICAjIG5lZWQgdG8gd3JhcCBpbiBhIGxpc3QgZm9yIHB5dGhvbiAzLCB3aGVyZSBpdGVtcyBpcyBhIHZpZXcKICAgIGl0ZW1zID0gbGlzdChrd2FyZ3MuaXRlbXMoKSkKICAgIGF0dHJpYnV0ZSwgbmV3ID0gaXRlbXNbMF0KICAgIHBhdGNoZXIgPSBfcGF0Y2goCiAgICAgICAgZ2V0dGVyLCBhdHRyaWJ1dGUsIG5ldywgc3BlYywgY3JlYXRlLCBzcGVjX3NldCwKICAgICAgICBhdXRvc3BlYywgbmV3X2NhbGxhYmxlLCB7fQogICAgKQogICAgcGF0Y2hlci5hdHRyaWJ1dGVfbmFtZSA9IGF0dHJpYnV0ZQogICAgZm9yIGF0dHJpYnV0ZSwgbmV3IGluIGl0ZW1zWzE6XToKICAgICAgICB0aGlzX3BhdGNoZXIgPSBfcGF0Y2goCiAgICAgICAgICAgIGdldHRlciwgYXR0cmlidXRlLCBuZXcsIHNwZWMsIGNyZWF0ZSwgc3BlY19zZXQsCiAgICAgICAgICAgIGF1dG9zcGVjLCBuZXdfY2FsbGFibGUsIHt9CiAgICAgICAgKQogICAgICAgIHRoaXNfcGF0Y2hlci5hdHRyaWJ1dGVfbmFtZSA9IGF0dHJpYnV0ZQogICAgICAgIHBhdGNoZXIuYWRkaXRpb25hbF9wYXRjaGVycy5hcHBlbmQodGhpc19wYXRjaGVyKQogICAgcmV0dXJuIHBhdGNoZXIKCgpkZWYgcGF0Y2goCiAgICAgICAgdGFyZ2V0LCBuZXc9REVGQVVMVCwgc3BlYz1Ob25lLCBjcmVhdGU9RmFsc2UsCiAgICAgICAgc3BlY19zZXQ9Tm9uZSwgYXV0b3NwZWM9Tm9uZSwgbmV3X2NhbGxhYmxlPU5vbmUsICoqa3dhcmdzCiAgICApOgogICAgIiIiCiAgICBgcGF0Y2hgIGFjdHMgYXMgYSBmdW5jdGlvbiBkZWNvcmF0b3IsIGNsYXNzIGRlY29yYXRvciBvciBhIGNvbnRleHQKICAgIG1hbmFnZXIuIEluc2lkZSB0aGUgYm9keSBvZiB0aGUgZnVuY3Rpb24gb3Igd2l0aCBzdGF0ZW1lbnQsIHRoZSBgdGFyZ2V0YAogICAgaXMgcGF0Y2hlZCB3aXRoIGEgYG5ld2Agb2JqZWN0LiBXaGVuIHRoZSBmdW5jdGlvbi93aXRoIHN0YXRlbWVudCBleGl0cwogICAgdGhlIHBhdGNoIGlzIHVuZG9uZS4KCiAgICBJZiBgbmV3YCBpcyBvbWl0dGVkLCB0aGVuIHRoZSB0YXJnZXQgaXMgcmVwbGFjZWQgd2l0aCBhCiAgICBgTWFnaWNNb2NrYC4gSWYgYHBhdGNoYCBpcyB1c2VkIGFzIGEgZGVjb3JhdG9yIGFuZCBgbmV3YCBpcwogICAgb21pdHRlZCwgdGhlIGNyZWF0ZWQgbW9jayBpcyBwYXNzZWQgaW4gYXMgYW4gZXh0cmEgYXJndW1lbnQgdG8gdGhlCiAgICBkZWNvcmF0ZWQgZnVuY3Rpb24uIElmIGBwYXRjaGAgaXMgdXNlZCBhcyBhIGNvbnRleHQgbWFuYWdlciB0aGUgY3JlYXRlZAogICAgbW9jayBpcyByZXR1cm5lZCBieSB0aGUgY29udGV4dCBtYW5hZ2VyLgoKICAgIGB0YXJnZXRgIHNob3VsZCBiZSBhIHN0cmluZyBpbiB0aGUgZm9ybSBgJ3BhY2thZ2UubW9kdWxlLkNsYXNzTmFtZSdgLiBUaGUKICAgIGB0YXJnZXRgIGlzIGltcG9ydGVkIGFuZCB0aGUgc3BlY2lmaWVkIG9iamVjdCByZXBsYWNlZCB3aXRoIHRoZSBgbmV3YAogICAgb2JqZWN0LCBzbyB0aGUgYHRhcmdldGAgbXVzdCBiZSBpbXBvcnRhYmxlIGZyb20gdGhlIGVudmlyb25tZW50IHlvdSBhcmUKICAgIGNhbGxpbmcgYHBhdGNoYCBmcm9tLiBUaGUgdGFyZ2V0IGlzIGltcG9ydGVkIHdoZW4gdGhlIGRlY29yYXRlZCBmdW5jdGlvbgogICAgaXMgZXhlY3V0ZWQsIG5vdCBhdCBkZWNvcmF0aW9uIHRpbWUuCgogICAgVGhlIGBzcGVjYCBhbmQgYHNwZWNfc2V0YCBrZXl3b3JkIGFyZ3VtZW50cyBhcmUgcGFzc2VkIHRvIHRoZSBgTWFnaWNNb2NrYAogICAgaWYgcGF0Y2ggaXMgY3JlYXRpbmcgb25lIGZvciB5b3UuCgogICAgSW4gYWRkaXRpb24geW91IGNhbiBwYXNzIGBzcGVjPVRydWVgIG9yIGBzcGVjX3NldD1UcnVlYCwgd2hpY2ggY2F1c2VzCiAgICBwYXRjaCB0byBwYXNzIGluIHRoZSBvYmplY3QgYmVpbmcgbW9ja2VkIGFzIHRoZSBzcGVjL3NwZWNfc2V0IG9iamVjdC4KCiAgICBgbmV3X2NhbGxhYmxlYCBhbGxvd3MgeW91IHRvIHNwZWNpZnkgYSBkaWZmZXJlbnQgY2xhc3MsIG9yIGNhbGxhYmxlIG9iamVjdCwKICAgIHRoYXQgd2lsbCBiZSBjYWxsZWQgdG8gY3JlYXRlIHRoZSBgbmV3YCBvYmplY3QuIEJ5IGRlZmF1bHQgYE1hZ2ljTW9ja2AgaXMKICAgIHVzZWQuCgogICAgQSBtb3JlIHBvd2VyZnVsIGZvcm0gb2YgYHNwZWNgIGlzIGBhdXRvc3BlY2AuIElmIHlvdSBzZXQgYGF1dG9zcGVjPVRydWVgCiAgICB0aGVuIHRoZSBtb2NrIHdpdGggYmUgY3JlYXRlZCB3aXRoIGEgc3BlYyBmcm9tIHRoZSBvYmplY3QgYmVpbmcgcmVwbGFjZWQuCiAgICBBbGwgYXR0cmlidXRlcyBvZiB0aGUgbW9jayB3aWxsIGFsc28gaGF2ZSB0aGUgc3BlYyBvZiB0aGUgY29ycmVzcG9uZGluZwogICAgYXR0cmlidXRlIG9mIHRoZSBvYmplY3QgYmVpbmcgcmVwbGFjZWQuIE1ldGhvZHMgYW5kIGZ1bmN0aW9ucyBiZWluZwogICAgbW9ja2VkIHdpbGwgaGF2ZSB0aGVpciBhcmd1bWVudHMgY2hlY2tlZCBhbmQgd2lsbCByYWlzZSBhIGBUeXBlRXJyb3JgIGlmCiAgICB0aGV5IGFyZSBjYWxsZWQgd2l0aCB0aGUgd3Jvbmcgc2lnbmF0dXJlLiBGb3IgbW9ja3MgcmVwbGFjaW5nIGEgY2xhc3MsCiAgICB0aGVpciByZXR1cm4gdmFsdWUgKHRoZSAnaW5zdGFuY2UnKSB3aWxsIGhhdmUgdGhlIHNhbWUgc3BlYyBhcyB0aGUgY2xhc3MuCgogICAgSW5zdGVhZCBvZiBgYXV0b3NwZWM9VHJ1ZWAgeW91IGNhbiBwYXNzIGBhdXRvc3BlYz1zb21lX29iamVjdGAgdG8gdXNlIGFuCiAgICBhcmJpdHJhcnkgb2JqZWN0IGFzIHRoZSBzcGVjIGluc3RlYWQgb2YgdGhlIG9uZSBiZWluZyByZXBsYWNlZC4KCiAgICBCeSBkZWZhdWx0IGBwYXRjaGAgd2lsbCBmYWlsIHRvIHJlcGxhY2UgYXR0cmlidXRlcyB0aGF0IGRvbid0IGV4aXN0LiBJZgogICAgeW91IHBhc3MgaW4gYGNyZWF0ZT1UcnVlYCwgYW5kIHRoZSBhdHRyaWJ1dGUgZG9lc24ndCBleGlzdCwgcGF0Y2ggd2lsbAogICAgY3JlYXRlIHRoZSBhdHRyaWJ1dGUgZm9yIHlvdSB3aGVuIHRoZSBwYXRjaGVkIGZ1bmN0aW9uIGlzIGNhbGxlZCwgYW5kCiAgICBkZWxldGUgaXQgYWdhaW4gYWZ0ZXJ3YXJkcy4gVGhpcyBpcyB1c2VmdWwgZm9yIHdyaXRpbmcgdGVzdHMgYWdhaW5zdAogICAgYXR0cmlidXRlcyB0aGF0IHlvdXIgcHJvZHVjdGlvbiBjb2RlIGNyZWF0ZXMgYXQgcnVudGltZS4gSXQgaXMgb2ZmIGJ5IGJ5CiAgICBkZWZhdWx0IGJlY2F1c2UgaXQgY2FuIGJlIGRhbmdlcm91cy4gV2l0aCBpdCBzd2l0Y2hlZCBvbiB5b3UgY2FuIHdyaXRlCiAgICBwYXNzaW5nIHRlc3RzIGFnYWluc3QgQVBJcyB0aGF0IGRvbid0IGFjdHVhbGx5IGV4aXN0IQoKICAgIFBhdGNoIGNhbiBiZSB1c2VkIGFzIGEgYFRlc3RDYXNlYCBjbGFzcyBkZWNvcmF0b3IuIEl0IHdvcmtzIGJ5CiAgICBkZWNvcmF0aW5nIGVhY2ggdGVzdCBtZXRob2QgaW4gdGhlIGNsYXNzLiBUaGlzIHJlZHVjZXMgdGhlIGJvaWxlcnBsYXRlCiAgICBjb2RlIHdoZW4geW91ciB0ZXN0IG1ldGhvZHMgc2hhcmUgYSBjb21tb24gcGF0Y2hpbmdzIHNldC4gYHBhdGNoYCBmaW5kcwogICAgdGVzdHMgYnkgbG9va2luZyBmb3IgbWV0aG9kIG5hbWVzIHRoYXQgc3RhcnQgd2l0aCBgcGF0Y2guVEVTVF9QUkVGSVhgLgogICAgQnkgZGVmYXVsdCB0aGlzIGlzIGB0ZXN0YCwgd2hpY2ggbWF0Y2hlcyB0aGUgd2F5IGB1bml0dGVzdGAgZmluZHMgdGVzdHMuCiAgICBZb3UgY2FuIHNwZWNpZnkgYW4gYWx0ZXJuYXRpdmUgcHJlZml4IGJ5IHNldHRpbmcgYHBhdGNoLlRFU1RfUFJFRklYYC4KCiAgICBQYXRjaCBjYW4gYmUgdXNlZCBhcyBhIGNvbnRleHQgbWFuYWdlciwgd2l0aCB0aGUgd2l0aCBzdGF0ZW1lbnQuIEhlcmUgdGhlCiAgICBwYXRjaGluZyBhcHBsaWVzIHRvIHRoZSBpbmRlbnRlZCBibG9jayBhZnRlciB0aGUgd2l0aCBzdGF0ZW1lbnQuIElmIHlvdQogICAgdXNlICJhcyIgdGhlbiB0aGUgcGF0Y2hlZCBvYmplY3Qgd2lsbCBiZSBib3VuZCB0byB0aGUgbmFtZSBhZnRlciB0aGUKICAgICJhcyI7IHZlcnkgdXNlZnVsIGlmIGBwYXRjaGAgaXMgY3JlYXRpbmcgYSBtb2NrIG9iamVjdCBmb3IgeW91LgoKICAgIGBwYXRjaGAgdGFrZXMgYXJiaXRyYXJ5IGtleXdvcmQgYXJndW1lbnRzLiBUaGVzZSB3aWxsIGJlIHBhc3NlZCB0bwogICAgdGhlIGBNb2NrYCAob3IgYG5ld19jYWxsYWJsZWApIG9uIGNvbnN0cnVjdGlvbi4KCiAgICBgcGF0Y2guZGljdCguLi4pYCwgYHBhdGNoLm11bHRpcGxlKC4uLilgIGFuZCBgcGF0Y2gub2JqZWN0KC4uLilgIGFyZQogICAgYXZhaWxhYmxlIGZvciBhbHRlcm5hdGUgdXNlLWNhc2VzLgogICAgIiIiCiAgICBnZXR0ZXIsIGF0dHJpYnV0ZSA9IF9nZXRfdGFyZ2V0KHRhcmdldCkKICAgIHJldHVybiBfcGF0Y2goCiAgICAgICAgZ2V0dGVyLCBhdHRyaWJ1dGUsIG5ldywgc3BlYywgY3JlYXRlLAogICAgICAgIHNwZWNfc2V0LCBhdXRvc3BlYywgbmV3X2NhbGxhYmxlLCBrd2FyZ3MKICAgICkKCgpjbGFzcyBfcGF0Y2hfZGljdChvYmplY3QpOgogICAgIiIiCiAgICBQYXRjaCBhIGRpY3Rpb25hcnksIG9yIGRpY3Rpb25hcnkgbGlrZSBvYmplY3QsIGFuZCByZXN0b3JlIHRoZSBkaWN0aW9uYXJ5CiAgICB0byBpdHMgb3JpZ2luYWwgc3RhdGUgYWZ0ZXIgdGhlIHRlc3QuCgogICAgYGluX2RpY3RgIGNhbiBiZSBhIGRpY3Rpb25hcnkgb3IgYSBtYXBwaW5nIGxpa2UgY29udGFpbmVyLiBJZiBpdCBpcyBhCiAgICBtYXBwaW5nIHRoZW4gaXQgbXVzdCBhdCBsZWFzdCBzdXBwb3J0IGdldHRpbmcsIHNldHRpbmcgYW5kIGRlbGV0aW5nIGl0ZW1zCiAgICBwbHVzIGl0ZXJhdGluZyBvdmVyIGtleXMuCgogICAgYGluX2RpY3RgIGNhbiBhbHNvIGJlIGEgc3RyaW5nIHNwZWNpZnlpbmcgdGhlIG5hbWUgb2YgdGhlIGRpY3Rpb25hcnksIHdoaWNoCiAgICB3aWxsIHRoZW4gYmUgZmV0Y2hlZCBieSBpbXBvcnRpbmcgaXQuCgogICAgYHZhbHVlc2AgY2FuIGJlIGEgZGljdGlvbmFyeSBvZiB2YWx1ZXMgdG8gc2V0IGluIHRoZSBkaWN0aW9uYXJ5LiBgdmFsdWVzYAogICAgY2FuIGFsc28gYmUgYW4gaXRlcmFibGUgb2YgYChrZXksIHZhbHVlKWAgcGFpcnMuCgogICAgSWYgYGNsZWFyYCBpcyBUcnVlIHRoZW4gdGhlIGRpY3Rpb25hcnkgd2lsbCBiZSBjbGVhcmVkIGJlZm9yZSB0aGUgbmV3CiAgICB2YWx1ZXMgYXJlIHNldC4KCiAgICBgcGF0Y2guZGljdGAgY2FuIGFsc28gYmUgY2FsbGVkIHdpdGggYXJiaXRyYXJ5IGtleXdvcmQgYXJndW1lbnRzIHRvIHNldAogICAgdmFsdWVzIGluIHRoZSBkaWN0aW9uYXJ5OjoKCiAgICAgICAgd2l0aCBwYXRjaC5kaWN0KCdzeXMubW9kdWxlcycsIG15bW9kdWxlPU1vY2soKSwgb3RoZXJfbW9kdWxlPU1vY2soKSk6CiAgICAgICAgICAgIC4uLgoKICAgIGBwYXRjaC5kaWN0YCBjYW4gYmUgdXNlZCBhcyBhIGNvbnRleHQgbWFuYWdlciwgZGVjb3JhdG9yIG9yIGNsYXNzCiAgICBkZWNvcmF0b3IuIFdoZW4gdXNlZCBhcyBhIGNsYXNzIGRlY29yYXRvciBgcGF0Y2guZGljdGAgaG9ub3VycwogICAgYHBhdGNoLlRFU1RfUFJFRklYYCBmb3IgY2hvb3Npbmcgd2hpY2ggbWV0aG9kcyB0byB3cmFwLgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGluX2RpY3QsIHZhbHVlcz0oKSwgY2xlYXI9RmFsc2UsICoqa3dhcmdzKToKICAgICAgICBpZiBpc2luc3RhbmNlKGluX2RpY3QsIHN0cik6CiAgICAgICAgICAgIGluX2RpY3QgPSBfaW1wb3J0ZXIoaW5fZGljdCkKICAgICAgICBzZWxmLmluX2RpY3QgPSBpbl9kaWN0CiAgICAgICAgIyBzdXBwb3J0IGFueSBhcmd1bWVudCBzdXBwb3J0ZWQgYnkgZGljdCguLi4pIGNvbnN0cnVjdG9yCiAgICAgICAgc2VsZi52YWx1ZXMgPSBkaWN0KHZhbHVlcykKICAgICAgICBzZWxmLnZhbHVlcy51cGRhdGUoa3dhcmdzKQogICAgICAgIHNlbGYuY2xlYXIgPSBjbGVhcgogICAgICAgIHNlbGYuX29yaWdpbmFsID0gTm9uZQoKCiAgICBkZWYgX19jYWxsX18oc2VsZiwgZik6CiAgICAgICAgaWYgaXNpbnN0YW5jZShmLCB0eXBlKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuZGVjb3JhdGVfY2xhc3MoZikKICAgICAgICBAd3JhcHMoZikKICAgICAgICBkZWYgX2lubmVyKCphcmdzLCAqKmt3KToKICAgICAgICAgICAgc2VsZi5fcGF0Y2hfZGljdCgpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHJldHVybiBmKCphcmdzLCAqKmt3KQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgc2VsZi5fdW5wYXRjaF9kaWN0KCkKCiAgICAgICAgcmV0dXJuIF9pbm5lcgoKCiAgICBkZWYgZGVjb3JhdGVfY2xhc3Moc2VsZiwga2xhc3MpOgogICAgICAgIGZvciBhdHRyIGluIGRpcihrbGFzcyk6CiAgICAgICAgICAgIGF0dHJfdmFsdWUgPSBnZXRhdHRyKGtsYXNzLCBhdHRyKQogICAgICAgICAgICBpZiAoYXR0ci5zdGFydHN3aXRoKHBhdGNoLlRFU1RfUFJFRklYKSBhbmQKICAgICAgICAgICAgICAgICBoYXNhdHRyKGF0dHJfdmFsdWUsICJfX2NhbGxfXyIpKToKICAgICAgICAgICAgICAgIGRlY29yYXRvciA9IF9wYXRjaF9kaWN0KHNlbGYuaW5fZGljdCwgc2VsZi52YWx1ZXMsIHNlbGYuY2xlYXIpCiAgICAgICAgICAgICAgICBkZWNvcmF0ZWQgPSBkZWNvcmF0b3IoYXR0cl92YWx1ZSkKICAgICAgICAgICAgICAgIHNldGF0dHIoa2xhc3MsIGF0dHIsIGRlY29yYXRlZCkKICAgICAgICByZXR1cm4ga2xhc3MKCgogICAgZGVmIF9fZW50ZXJfXyhzZWxmKToKICAgICAgICAiIiJQYXRjaCB0aGUgZGljdC4iIiIKICAgICAgICBzZWxmLl9wYXRjaF9kaWN0KCkKCgogICAgZGVmIF9wYXRjaF9kaWN0KHNlbGYpOgogICAgICAgIHZhbHVlcyA9IHNlbGYudmFsdWVzCiAgICAgICAgaW5fZGljdCA9IHNlbGYuaW5fZGljdAogICAgICAgIGNsZWFyID0gc2VsZi5jbGVhcgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIG9yaWdpbmFsID0gaW5fZGljdC5jb3B5KCkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgICMgZGljdCBsaWtlIG9iamVjdCB3aXRoIG5vIGNvcHkgbWV0aG9kCiAgICAgICAgICAgICMgbXVzdCBzdXBwb3J0IGl0ZXJhdGlvbiBvdmVyIGtleXMKICAgICAgICAgICAgb3JpZ2luYWwgPSB7fQogICAgICAgICAgICBmb3Iga2V5IGluIGluX2RpY3Q6CiAgICAgICAgICAgICAgICBvcmlnaW5hbFtrZXldID0gaW5fZGljdFtrZXldCiAgICAgICAgc2VsZi5fb3JpZ2luYWwgPSBvcmlnaW5hbAoKICAgICAgICBpZiBjbGVhcjoKICAgICAgICAgICAgX2NsZWFyX2RpY3QoaW5fZGljdCkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpbl9kaWN0LnVwZGF0ZSh2YWx1ZXMpCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICAjIGRpY3QgbGlrZSBvYmplY3Qgd2l0aCBubyB1cGRhdGUgbWV0aG9kCiAgICAgICAgICAgIGZvciBrZXkgaW4gdmFsdWVzOgogICAgICAgICAgICAgICAgaW5fZGljdFtrZXldID0gdmFsdWVzW2tleV0KCgogICAgZGVmIF91bnBhdGNoX2RpY3Qoc2VsZik6CiAgICAgICAgaW5fZGljdCA9IHNlbGYuaW5fZGljdAogICAgICAgIG9yaWdpbmFsID0gc2VsZi5fb3JpZ2luYWwKCiAgICAgICAgX2NsZWFyX2RpY3QoaW5fZGljdCkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpbl9kaWN0LnVwZGF0ZShvcmlnaW5hbCkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIGZvciBrZXkgaW4gb3JpZ2luYWw6CiAgICAgICAgICAgICAgICBpbl9kaWN0W2tleV0gPSBvcmlnaW5hbFtrZXldCgoKICAgIGRlZiBfX2V4aXRfXyhzZWxmLCAqYXJncyk6CiAgICAgICAgIiIiVW5wYXRjaCB0aGUgZGljdC4iIiIKICAgICAgICBzZWxmLl91bnBhdGNoX2RpY3QoKQogICAgICAgIHJldHVybiBGYWxzZQoKICAgIHN0YXJ0ID0gX19lbnRlcl9fCiAgICBzdG9wID0gX19leGl0X18KCgpkZWYgX2NsZWFyX2RpY3QoaW5fZGljdCk6CiAgICB0cnk6CiAgICAgICAgaW5fZGljdC5jbGVhcigpCiAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAga2V5cyA9IGxpc3QoaW5fZGljdCkKICAgICAgICBmb3Iga2V5IGluIGtleXM6CiAgICAgICAgICAgIGRlbCBpbl9kaWN0W2tleV0KCgpkZWYgX3BhdGNoX3N0b3BhbGwoKToKICAgICIiIlN0b3AgYWxsIGFjdGl2ZSBwYXRjaGVzLiIiIgogICAgZm9yIHBhdGNoIGluIGxpc3QoX3BhdGNoLl9hY3RpdmVfcGF0Y2hlcyk6CiAgICAgICAgcGF0Y2guc3RvcCgpCgoKcGF0Y2gub2JqZWN0ID0gX3BhdGNoX29iamVjdApwYXRjaC5kaWN0ID0gX3BhdGNoX2RpY3QKcGF0Y2gubXVsdGlwbGUgPSBfcGF0Y2hfbXVsdGlwbGUKcGF0Y2guc3RvcGFsbCA9IF9wYXRjaF9zdG9wYWxsCnBhdGNoLlRFU1RfUFJFRklYID0gJ3Rlc3QnCgptYWdpY19tZXRob2RzID0gKAogICAgImx0IGxlIGd0IGdlIGVxIG5lICIKICAgICJnZXRpdGVtIHNldGl0ZW0gZGVsaXRlbSAiCiAgICAibGVuIGNvbnRhaW5zIGl0ZXIgIgogICAgImhhc2ggc3RyIHNpemVvZiAiCiAgICAiZW50ZXIgZXhpdCAiCiAgICAiZGl2bW9kIG5lZyBwb3MgYWJzIGludmVydCAiCiAgICAiY29tcGxleCBpbnQgZmxvYXQgaW5kZXggIgogICAgInRydW5jIGZsb29yIGNlaWwgIgogICAgImJvb2wgbmV4dCAiCikKCm51bWVyaWNzID0gImFkZCBzdWIgbXVsIGRpdiBmbG9vcmRpdiBtb2QgbHNoaWZ0IHJzaGlmdCBhbmQgeG9yIG9yIHBvdyAiCmlucGxhY2UgPSAnICcuam9pbignaSVzJyAlIG4gZm9yIG4gaW4gbnVtZXJpY3Muc3BsaXQoKSkKcmlnaHQgPSAnICcuam9pbignciVzJyAlIG4gZm9yIG4gaW4gbnVtZXJpY3Muc3BsaXQoKSkKCiMgbm90IGluY2x1ZGluZyBfX3ByZXBhcmVfXywgX19pbnN0YW5jZWNoZWNrX18sIF9fc3ViY2xhc3NjaGVja19fCiMgKGFzIHRoZXkgYXJlIG1ldGFjbGFzcyBtZXRob2RzKQojIF9fZGVsX18gaXMgbm90IHN1cHBvcnRlZCBhdCBhbGwgYXMgaXQgY2F1c2VzIHByb2JsZW1zIGlmIGl0IGV4aXN0cwoKX25vbl9kZWZhdWx0cyA9IHNldCgnX18lc19fJyAlIG1ldGhvZCBmb3IgbWV0aG9kIGluIFsKICAgICdnZXQnLCAnc2V0JywgJ2RlbGV0ZScsICdyZXZlcnNlZCcsICdtaXNzaW5nJywgJ3JlZHVjZScsICdyZWR1Y2VfZXgnLAogICAgJ2dldGluaXRhcmdzJywgJ2dldG5ld2FyZ3MnLCAnZ2V0c3RhdGUnLCAnc2V0c3RhdGUnLCAnZ2V0Zm9ybWF0JywKICAgICdzZXRmb3JtYXQnLCAncmVwcicsICdkaXInLCAnc3ViY2xhc3NlcycsICdmb3JtYXQnLApdKQoKCmRlZiBfZ2V0X21ldGhvZChuYW1lLCBmdW5jKToKICAgICJUdXJucyBhIGNhbGxhYmxlIG9iamVjdCAobGlrZSBhIG1vY2spIGludG8gYSByZWFsIGZ1bmN0aW9uIgogICAgZGVmIG1ldGhvZChzZWxmLCAqYXJncywgKiprdyk6CiAgICAgICAgcmV0dXJuIGZ1bmMoc2VsZiwgKmFyZ3MsICoqa3cpCiAgICBtZXRob2QuX19uYW1lX18gPSBuYW1lCiAgICByZXR1cm4gbWV0aG9kCgoKX21hZ2ljcyA9IHNldCgKICAgICdfXyVzX18nICUgbWV0aG9kIGZvciBtZXRob2QgaW4KICAgICcgJy5qb2luKFttYWdpY19tZXRob2RzLCBudW1lcmljcywgaW5wbGFjZSwgcmlnaHRdKS5zcGxpdCgpCikKCl9hbGxfbWFnaWNzID0gX21hZ2ljcyB8IF9ub25fZGVmYXVsdHMKCl91bnN1cHBvcnRlZF9tYWdpY3MgPSBzZXQoWwogICAgJ19fZ2V0YXR0cl9fJywgJ19fc2V0YXR0cl9fJywKICAgICdfX2luaXRfXycsICdfX25ld19fJywgJ19fcHJlcGFyZV9fJwogICAgJ19faW5zdGFuY2VjaGVja19fJywgJ19fc3ViY2xhc3NjaGVja19fJywKICAgICdfX2RlbF9fJwpdKQoKX2NhbGN1bGF0ZV9yZXR1cm5fdmFsdWUgPSB7CiAgICAnX19oYXNoX18nOiBsYW1iZGEgc2VsZjogb2JqZWN0Ll9faGFzaF9fKHNlbGYpLAogICAgJ19fc3RyX18nOiBsYW1iZGEgc2VsZjogb2JqZWN0Ll9fc3RyX18oc2VsZiksCiAgICAnX19zaXplb2ZfXyc6IGxhbWJkYSBzZWxmOiBvYmplY3QuX19zaXplb2ZfXyhzZWxmKSwKfQoKX3JldHVybl92YWx1ZXMgPSB7CiAgICAnX19sdF9fJzogTm90SW1wbGVtZW50ZWQsCiAgICAnX19ndF9fJzogTm90SW1wbGVtZW50ZWQsCiAgICAnX19sZV9fJzogTm90SW1wbGVtZW50ZWQsCiAgICAnX19nZV9fJzogTm90SW1wbGVtZW50ZWQsCiAgICAnX19pbnRfXyc6IDEsCiAgICAnX19jb250YWluc19fJzogRmFsc2UsCiAgICAnX19sZW5fXyc6IDAsCiAgICAnX19leGl0X18nOiBGYWxzZSwKICAgICdfX2NvbXBsZXhfXyc6IDFqLAogICAgJ19fZmxvYXRfXyc6IDEuMCwKICAgICdfX2Jvb2xfXyc6IFRydWUsCiAgICAnX19pbmRleF9fJzogMSwKfQoKCmRlZiBfZ2V0X2VxKHNlbGYpOgogICAgZGVmIF9fZXFfXyhvdGhlcik6CiAgICAgICAgcmV0X3ZhbCA9IHNlbGYuX19lcV9fLl9tb2NrX3JldHVybl92YWx1ZQogICAgICAgIGlmIHJldF92YWwgaXMgbm90IERFRkFVTFQ6CiAgICAgICAgICAgIHJldHVybiByZXRfdmFsCiAgICAgICAgcmV0dXJuIHNlbGYgaXMgb3RoZXIKICAgIHJldHVybiBfX2VxX18KCmRlZiBfZ2V0X25lKHNlbGYpOgogICAgZGVmIF9fbmVfXyhvdGhlcik6CiAgICAgICAgaWYgc2VsZi5fX25lX18uX21vY2tfcmV0dXJuX3ZhbHVlIGlzIG5vdCBERUZBVUxUOgogICAgICAgICAgICByZXR1cm4gREVGQVVMVAogICAgICAgIHJldHVybiBzZWxmIGlzIG5vdCBvdGhlcgogICAgcmV0dXJuIF9fbmVfXwoKZGVmIF9nZXRfaXRlcihzZWxmKToKICAgIGRlZiBfX2l0ZXJfXygpOgogICAgICAgIHJldF92YWwgPSBzZWxmLl9faXRlcl9fLl9tb2NrX3JldHVybl92YWx1ZQogICAgICAgIGlmIHJldF92YWwgaXMgREVGQVVMVDoKICAgICAgICAgICAgcmV0dXJuIGl0ZXIoW10pCiAgICAgICAgIyBpZiByZXRfdmFsIHdhcyBhbHJlYWR5IGFuIGl0ZXJhdG9yLCB0aGVuIGNhbGxpbmcgaXRlciBvbiBpdCBzaG91bGQKICAgICAgICAjIHJldHVybiB0aGUgaXRlcmF0b3IgdW5jaGFuZ2VkCiAgICAgICAgcmV0dXJuIGl0ZXIocmV0X3ZhbCkKICAgIHJldHVybiBfX2l0ZXJfXwoKX3NpZGVfZWZmZWN0X21ldGhvZHMgPSB7CiAgICAnX19lcV9fJzogX2dldF9lcSwKICAgICdfX25lX18nOiBfZ2V0X25lLAogICAgJ19faXRlcl9fJzogX2dldF9pdGVyLAp9CgoKCmRlZiBfc2V0X3JldHVybl92YWx1ZShtb2NrLCBtZXRob2QsIG5hbWUpOgogICAgZml4ZWQgPSBfcmV0dXJuX3ZhbHVlcy5nZXQobmFtZSwgREVGQVVMVCkKICAgIGlmIGZpeGVkIGlzIG5vdCBERUZBVUxUOgogICAgICAgIG1ldGhvZC5yZXR1cm5fdmFsdWUgPSBmaXhlZAogICAgICAgIHJldHVybgoKICAgIHJldHVybl9jYWx1bGF0b3IgPSBfY2FsY3VsYXRlX3JldHVybl92YWx1ZS5nZXQobmFtZSkKICAgIGlmIHJldHVybl9jYWx1bGF0b3IgaXMgbm90IE5vbmU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm5fdmFsdWUgPSByZXR1cm5fY2FsdWxhdG9yKG1vY2spCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICAjIFhYWFggd2h5IGRvIHdlIHJldHVybiBBdHRyaWJ1dGVFcnJvciBoZXJlPwogICAgICAgICAgICAjICAgICAgc2V0IGl0IGFzIGEgc2lkZV9lZmZlY3QgaW5zdGVhZD8KICAgICAgICAgICAgcmV0dXJuX3ZhbHVlID0gQXR0cmlidXRlRXJyb3IobmFtZSkKICAgICAgICBtZXRob2QucmV0dXJuX3ZhbHVlID0gcmV0dXJuX3ZhbHVlCiAgICAgICAgcmV0dXJuCgogICAgc2lkZV9lZmZlY3RvciA9IF9zaWRlX2VmZmVjdF9tZXRob2RzLmdldChuYW1lKQogICAgaWYgc2lkZV9lZmZlY3RvciBpcyBub3QgTm9uZToKICAgICAgICBtZXRob2Quc2lkZV9lZmZlY3QgPSBzaWRlX2VmZmVjdG9yKG1vY2spCgoKCmNsYXNzIE1hZ2ljTWl4aW4ob2JqZWN0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqYXJncywgKiprdyk6CiAgICAgICAgX3NhZmVfc3VwZXIoTWFnaWNNaXhpbiwgc2VsZikuX19pbml0X18oKmFyZ3MsICoqa3cpCiAgICAgICAgc2VsZi5fbW9ja19zZXRfbWFnaWNzKCkKCgogICAgZGVmIF9tb2NrX3NldF9tYWdpY3Moc2VsZik6CiAgICAgICAgdGhlc2VfbWFnaWNzID0gX21hZ2ljcwoKICAgICAgICBpZiBzZWxmLl9tb2NrX21ldGhvZHMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHRoZXNlX21hZ2ljcyA9IF9tYWdpY3MuaW50ZXJzZWN0aW9uKHNlbGYuX21vY2tfbWV0aG9kcykKCiAgICAgICAgICAgIHJlbW92ZV9tYWdpY3MgPSBzZXQoKQogICAgICAgICAgICByZW1vdmVfbWFnaWNzID0gX21hZ2ljcyAtIHRoZXNlX21hZ2ljcwoKICAgICAgICAgICAgZm9yIGVudHJ5IGluIHJlbW92ZV9tYWdpY3M6CiAgICAgICAgICAgICAgICBpZiBlbnRyeSBpbiB0eXBlKHNlbGYpLl9fZGljdF9fOgogICAgICAgICAgICAgICAgICAgICMgcmVtb3ZlIHVubmVlZGVkIG1hZ2ljIG1ldGhvZHMKICAgICAgICAgICAgICAgICAgICBkZWxhdHRyKHNlbGYsIGVudHJ5KQoKICAgICAgICAjIGRvbid0IG92ZXJ3cml0ZSBleGlzdGluZyBhdHRyaWJ1dGVzIGlmIGNhbGxlZCBhIHNlY29uZCB0aW1lCiAgICAgICAgdGhlc2VfbWFnaWNzID0gdGhlc2VfbWFnaWNzIC0gc2V0KHR5cGUoc2VsZikuX19kaWN0X18pCgogICAgICAgIF90eXBlID0gdHlwZShzZWxmKQogICAgICAgIGZvciBlbnRyeSBpbiB0aGVzZV9tYWdpY3M6CiAgICAgICAgICAgIHNldGF0dHIoX3R5cGUsIGVudHJ5LCBNYWdpY1Byb3h5KGVudHJ5LCBzZWxmKSkKCgoKY2xhc3MgTm9uQ2FsbGFibGVNYWdpY01vY2soTWFnaWNNaXhpbiwgTm9uQ2FsbGFibGVNb2NrKToKICAgICIiIkEgdmVyc2lvbiBvZiBgTWFnaWNNb2NrYCB0aGF0IGlzbid0IGNhbGxhYmxlLiIiIgogICAgZGVmIG1vY2tfYWRkX3NwZWMoc2VsZiwgc3BlYywgc3BlY19zZXQ9RmFsc2UpOgogICAgICAgICIiIkFkZCBhIHNwZWMgdG8gYSBtb2NrLiBgc3BlY2AgY2FuIGVpdGhlciBiZSBhbiBvYmplY3Qgb3IgYQogICAgICAgIGxpc3Qgb2Ygc3RyaW5ncy4gT25seSBhdHRyaWJ1dGVzIG9uIHRoZSBgc3BlY2AgY2FuIGJlIGZldGNoZWQgYXMKICAgICAgICBhdHRyaWJ1dGVzIGZyb20gdGhlIG1vY2suCgogICAgICAgIElmIGBzcGVjX3NldGAgaXMgVHJ1ZSB0aGVuIG9ubHkgYXR0cmlidXRlcyBvbiB0aGUgc3BlYyBjYW4gYmUgc2V0LiIiIgogICAgICAgIHNlbGYuX21vY2tfYWRkX3NwZWMoc3BlYywgc3BlY19zZXQpCiAgICAgICAgc2VsZi5fbW9ja19zZXRfbWFnaWNzKCkKCgoKY2xhc3MgTWFnaWNNb2NrKE1hZ2ljTWl4aW4sIE1vY2spOgogICAgIiIiCiAgICBNYWdpY01vY2sgaXMgYSBzdWJjbGFzcyBvZiBNb2NrIHdpdGggZGVmYXVsdCBpbXBsZW1lbnRhdGlvbnMKICAgIG9mIG1vc3Qgb2YgdGhlIG1hZ2ljIG1ldGhvZHMuIFlvdSBjYW4gdXNlIE1hZ2ljTW9jayB3aXRob3V0IGhhdmluZyB0bwogICAgY29uZmlndXJlIHRoZSBtYWdpYyBtZXRob2RzIHlvdXJzZWxmLgoKICAgIElmIHlvdSB1c2UgdGhlIGBzcGVjYCBvciBgc3BlY19zZXRgIGFyZ3VtZW50cyB0aGVuICpvbmx5KiBtYWdpYwogICAgbWV0aG9kcyB0aGF0IGV4aXN0IGluIHRoZSBzcGVjIHdpbGwgYmUgY3JlYXRlZC4KCiAgICBBdHRyaWJ1dGVzIGFuZCB0aGUgcmV0dXJuIHZhbHVlIG9mIGEgYE1hZ2ljTW9ja2Agd2lsbCBhbHNvIGJlIGBNYWdpY01vY2tzYC4KICAgICIiIgogICAgZGVmIG1vY2tfYWRkX3NwZWMoc2VsZiwgc3BlYywgc3BlY19zZXQ9RmFsc2UpOgogICAgICAgICIiIkFkZCBhIHNwZWMgdG8gYSBtb2NrLiBgc3BlY2AgY2FuIGVpdGhlciBiZSBhbiBvYmplY3Qgb3IgYQogICAgICAgIGxpc3Qgb2Ygc3RyaW5ncy4gT25seSBhdHRyaWJ1dGVzIG9uIHRoZSBgc3BlY2AgY2FuIGJlIGZldGNoZWQgYXMKICAgICAgICBhdHRyaWJ1dGVzIGZyb20gdGhlIG1vY2suCgogICAgICAgIElmIGBzcGVjX3NldGAgaXMgVHJ1ZSB0aGVuIG9ubHkgYXR0cmlidXRlcyBvbiB0aGUgc3BlYyBjYW4gYmUgc2V0LiIiIgogICAgICAgIHNlbGYuX21vY2tfYWRkX3NwZWMoc3BlYywgc3BlY19zZXQpCiAgICAgICAgc2VsZi5fbW9ja19zZXRfbWFnaWNzKCkKCgoKY2xhc3MgTWFnaWNQcm94eShvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG5hbWUsIHBhcmVudCk6CiAgICAgICAgc2VsZi5uYW1lID0gbmFtZQogICAgICAgIHNlbGYucGFyZW50ID0gcGFyZW50CgogICAgZGVmIF9fY2FsbF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgbSA9IHNlbGYuY3JlYXRlX21vY2soKQogICAgICAgIHJldHVybiBtKCphcmdzLCAqKmt3YXJncykKCiAgICBkZWYgY3JlYXRlX21vY2soc2VsZik6CiAgICAgICAgZW50cnkgPSBzZWxmLm5hbWUKICAgICAgICBwYXJlbnQgPSBzZWxmLnBhcmVudAogICAgICAgIG0gPSBwYXJlbnQuX2dldF9jaGlsZF9tb2NrKG5hbWU9ZW50cnksIF9uZXdfbmFtZT1lbnRyeSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbmV3X3BhcmVudD1wYXJlbnQpCiAgICAgICAgc2V0YXR0cihwYXJlbnQsIGVudHJ5LCBtKQogICAgICAgIF9zZXRfcmV0dXJuX3ZhbHVlKHBhcmVudCwgbSwgZW50cnkpCiAgICAgICAgcmV0dXJuIG0KCiAgICBkZWYgX19nZXRfXyhzZWxmLCBvYmosIF90eXBlPU5vbmUpOgogICAgICAgIHJldHVybiBzZWxmLmNyZWF0ZV9tb2NrKCkKCgoKY2xhc3MgX0FOWShvYmplY3QpOgogICAgIkEgaGVscGVyIG9iamVjdCB0aGF0IGNvbXBhcmVzIGVxdWFsIHRvIGV2ZXJ5dGhpbmcuIgoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIF9fbmVfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiAnPEFOWT4nCgpBTlkgPSBfQU5ZKCkKCgoKZGVmIF9mb3JtYXRfY2FsbF9zaWduYXR1cmUobmFtZSwgYXJncywga3dhcmdzKToKICAgIG1lc3NhZ2UgPSAnJXMoJSVzKScgJSBuYW1lCiAgICBmb3JtYXR0ZWRfYXJncyA9ICcnCiAgICBhcmdzX3N0cmluZyA9ICcsICcuam9pbihbcmVwcihhcmcpIGZvciBhcmcgaW4gYXJnc10pCiAgICBrd2FyZ3Nfc3RyaW5nID0gJywgJy5qb2luKFsKICAgICAgICAnJXM9JXInICUgKGtleSwgdmFsdWUpIGZvciBrZXksIHZhbHVlIGluIGt3YXJncy5pdGVtcygpCiAgICBdKQogICAgaWYgYXJnc19zdHJpbmc6CiAgICAgICAgZm9ybWF0dGVkX2FyZ3MgPSBhcmdzX3N0cmluZwogICAgaWYga3dhcmdzX3N0cmluZzoKICAgICAgICBpZiBmb3JtYXR0ZWRfYXJnczoKICAgICAgICAgICAgZm9ybWF0dGVkX2FyZ3MgKz0gJywgJwogICAgICAgIGZvcm1hdHRlZF9hcmdzICs9IGt3YXJnc19zdHJpbmcKCiAgICByZXR1cm4gbWVzc2FnZSAlIGZvcm1hdHRlZF9hcmdzCgoKCmNsYXNzIF9DYWxsKHR1cGxlKToKICAgICIiIgogICAgQSB0dXBsZSBmb3IgaG9sZGluZyB0aGUgcmVzdWx0cyBvZiBhIGNhbGwgdG8gYSBtb2NrLCBlaXRoZXIgaW4gdGhlIGZvcm0KICAgIGAoYXJncywga3dhcmdzKWAgb3IgYChuYW1lLCBhcmdzLCBrd2FyZ3MpYC4KCiAgICBJZiBhcmdzIG9yIGt3YXJncyBhcmUgZW1wdHkgdGhlbiBhIGNhbGwgdHVwbGUgd2lsbCBjb21wYXJlIGVxdWFsIHRvCiAgICBhIHR1cGxlIHdpdGhvdXQgdGhvc2UgdmFsdWVzLiBUaGlzIG1ha2VzIGNvbXBhcmlzb25zIGxlc3MgdmVyYm9zZTo6CgogICAgICAgIF9DYWxsKCgnbmFtZScsICgpLCB7fSkpID09ICgnbmFtZScsKQogICAgICAgIF9DYWxsKCgnbmFtZScsICgxLCksIHt9KSkgPT0gKCduYW1lJywgKDEsKSkKICAgICAgICBfQ2FsbCgoKCksIHsnYSc6ICdiJ30pKSA9PSAoeydhJzogJ2InfSwpCgogICAgVGhlIGBfQ2FsbGAgb2JqZWN0IHByb3ZpZGVzIGEgdXNlZnVsIHNob3J0Y3V0IGZvciBjb21wYXJpbmcgd2l0aCBjYWxsOjoKCiAgICAgICAgX0NhbGwoKCgxLCAyKSwgeydhJzogM30pKSA9PSBjYWxsKDEsIDIsIGE9MykKICAgICAgICBfQ2FsbCgoJ2ZvbycsICgxLCAyKSwgeydhJzogM30pKSA9PSBjYWxsLmZvbygxLCAyLCBhPTMpCgogICAgSWYgdGhlIF9DYWxsIGhhcyBubyBuYW1lIHRoZW4gaXQgd2lsbCBtYXRjaCBhbnkgbmFtZS4KICAgICIiIgogICAgZGVmIF9fbmV3X18oY2xzLCB2YWx1ZT0oKSwgbmFtZT1Ob25lLCBwYXJlbnQ9Tm9uZSwgdHdvPUZhbHNlLAogICAgICAgICAgICAgICAgZnJvbV9rYWxsPVRydWUpOgogICAgICAgIG5hbWUgPSAnJwogICAgICAgIGFyZ3MgPSAoKQogICAgICAgIGt3YXJncyA9IHt9CiAgICAgICAgX2xlbiA9IGxlbih2YWx1ZSkKICAgICAgICBpZiBfbGVuID09IDM6CiAgICAgICAgICAgIG5hbWUsIGFyZ3MsIGt3YXJncyA9IHZhbHVlCiAgICAgICAgZWxpZiBfbGVuID09IDI6CiAgICAgICAgICAgIGZpcnN0LCBzZWNvbmQgPSB2YWx1ZQogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGZpcnN0LCBzdHIpOgogICAgICAgICAgICAgICAgbmFtZSA9IGZpcnN0CiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKHNlY29uZCwgdHVwbGUpOgogICAgICAgICAgICAgICAgICAgIGFyZ3MgPSBzZWNvbmQKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAga3dhcmdzID0gc2Vjb25kCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBhcmdzLCBrd2FyZ3MgPSBmaXJzdCwgc2Vjb25kCiAgICAgICAgZWxpZiBfbGVuID09IDE6CiAgICAgICAgICAgIHZhbHVlLCA9IHZhbHVlCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodmFsdWUsIHN0cik6CiAgICAgICAgICAgICAgICBuYW1lID0gdmFsdWUKICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKHZhbHVlLCB0dXBsZSk6CiAgICAgICAgICAgICAgICBhcmdzID0gdmFsdWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGt3YXJncyA9IHZhbHVlCgogICAgICAgIGlmIHR3bzoKICAgICAgICAgICAgcmV0dXJuIHR1cGxlLl9fbmV3X18oY2xzLCAoYXJncywga3dhcmdzKSkKCiAgICAgICAgcmV0dXJuIHR1cGxlLl9fbmV3X18oY2xzLCAobmFtZSwgYXJncywga3dhcmdzKSkKCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHZhbHVlPSgpLCBuYW1lPU5vbmUsIHBhcmVudD1Ob25lLCB0d289RmFsc2UsCiAgICAgICAgICAgICAgICAgZnJvbV9rYWxsPVRydWUpOgogICAgICAgIHNlbGYubmFtZSA9IG5hbWUKICAgICAgICBzZWxmLnBhcmVudCA9IHBhcmVudAogICAgICAgIHNlbGYuZnJvbV9rYWxsID0gZnJvbV9rYWxsCgoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIG90aGVyIGlzIEFOWToKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxlbl9vdGhlciA9IGxlbihvdGhlcikKICAgICAgICBleGNlcHQgVHlwZUVycm9yOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAgICAgc2VsZl9uYW1lID0gJycKICAgICAgICBpZiBsZW4oc2VsZikgPT0gMjoKICAgICAgICAgICAgc2VsZl9hcmdzLCBzZWxmX2t3YXJncyA9IHNlbGYKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmX25hbWUsIHNlbGZfYXJncywgc2VsZl9rd2FyZ3MgPSBzZWxmCgogICAgICAgIG90aGVyX25hbWUgPSAnJwogICAgICAgIGlmIGxlbl9vdGhlciA9PSAwOgogICAgICAgICAgICBvdGhlcl9hcmdzLCBvdGhlcl9rd2FyZ3MgPSAoKSwge30KICAgICAgICBlbGlmIGxlbl9vdGhlciA9PSAzOgogICAgICAgICAgICBvdGhlcl9uYW1lLCBvdGhlcl9hcmdzLCBvdGhlcl9rd2FyZ3MgPSBvdGhlcgogICAgICAgIGVsaWYgbGVuX290aGVyID09IDE6CiAgICAgICAgICAgIHZhbHVlLCA9IG90aGVyCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodmFsdWUsIHR1cGxlKToKICAgICAgICAgICAgICAgIG90aGVyX2FyZ3MgPSB2YWx1ZQogICAgICAgICAgICAgICAgb3RoZXJfa3dhcmdzID0ge30KICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKHZhbHVlLCBzdHIpOgogICAgICAgICAgICAgICAgb3RoZXJfbmFtZSA9IHZhbHVlCiAgICAgICAgICAgICAgICBvdGhlcl9hcmdzLCBvdGhlcl9rd2FyZ3MgPSAoKSwge30KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG90aGVyX2FyZ3MgPSAoKQogICAgICAgICAgICAgICAgb3RoZXJfa3dhcmdzID0gdmFsdWUKICAgICAgICBlbHNlOgogICAgICAgICAgICAjIGxlbiAyCiAgICAgICAgICAgICMgY291bGQgYmUgKG5hbWUsIGFyZ3MpIG9yIChuYW1lLCBrd2FyZ3MpIG9yIChhcmdzLCBrd2FyZ3MpCiAgICAgICAgICAgIGZpcnN0LCBzZWNvbmQgPSBvdGhlcgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGZpcnN0LCBzdHIpOgogICAgICAgICAgICAgICAgb3RoZXJfbmFtZSA9IGZpcnN0CiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKHNlY29uZCwgdHVwbGUpOgogICAgICAgICAgICAgICAgICAgIG90aGVyX2FyZ3MsIG90aGVyX2t3YXJncyA9IHNlY29uZCwge30KICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgb3RoZXJfYXJncywgb3RoZXJfa3dhcmdzID0gKCksIHNlY29uZAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgb3RoZXJfYXJncywgb3RoZXJfa3dhcmdzID0gZmlyc3QsIHNlY29uZAoKICAgICAgICBpZiBzZWxmX25hbWUgYW5kIG90aGVyX25hbWUgIT0gc2VsZl9uYW1lOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAgICAgIyB0aGlzIG9yZGVyIGlzIGltcG9ydGFudCBmb3IgQU5ZIHRvIHdvcmshCiAgICAgICAgcmV0dXJuIChvdGhlcl9hcmdzLCBvdGhlcl9rd2FyZ3MpID09IChzZWxmX2FyZ3MsIHNlbGZfa3dhcmdzKQoKCiAgICBkZWYgX19uZV9fKHNlbGYsIG90aGVyKToKICAgICAgICByZXR1cm4gbm90IHNlbGYuX19lcV9fKG90aGVyKQoKCiAgICBkZWYgX19jYWxsX18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICBpZiBzZWxmLm5hbWUgaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIF9DYWxsKCgnJywgYXJncywga3dhcmdzKSwgbmFtZT0nKCknKQoKICAgICAgICBuYW1lID0gc2VsZi5uYW1lICsgJygpJwogICAgICAgIHJldHVybiBfQ2FsbCgoc2VsZi5uYW1lLCBhcmdzLCBrd2FyZ3MpLCBuYW1lPW5hbWUsIHBhcmVudD1zZWxmKQoKCiAgICBkZWYgX19nZXRhdHRyX18oc2VsZiwgYXR0cik6CiAgICAgICAgaWYgc2VsZi5uYW1lIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBfQ2FsbChuYW1lPWF0dHIsIGZyb21fa2FsbD1GYWxzZSkKICAgICAgICBuYW1lID0gJyVzLiVzJyAlIChzZWxmLm5hbWUsIGF0dHIpCiAgICAgICAgcmV0dXJuIF9DYWxsKG5hbWU9bmFtZSwgcGFyZW50PXNlbGYsIGZyb21fa2FsbD1GYWxzZSkKCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIGlmIG5vdCBzZWxmLmZyb21fa2FsbDoKICAgICAgICAgICAgbmFtZSA9IHNlbGYubmFtZSBvciAnY2FsbCcKICAgICAgICAgICAgaWYgbmFtZS5zdGFydHN3aXRoKCcoKScpOgogICAgICAgICAgICAgICAgbmFtZSA9ICdjYWxsJXMnICUgbmFtZQogICAgICAgICAgICByZXR1cm4gbmFtZQoKICAgICAgICBpZiBsZW4oc2VsZikgPT0gMjoKICAgICAgICAgICAgbmFtZSA9ICdjYWxsJwogICAgICAgICAgICBhcmdzLCBrd2FyZ3MgPSBzZWxmCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbmFtZSwgYXJncywga3dhcmdzID0gc2VsZgogICAgICAgICAgICBpZiBub3QgbmFtZToKICAgICAgICAgICAgICAgIG5hbWUgPSAnY2FsbCcKICAgICAgICAgICAgZWxpZiBub3QgbmFtZS5zdGFydHN3aXRoKCcoKScpOgogICAgICAgICAgICAgICAgbmFtZSA9ICdjYWxsLiVzJyAlIG5hbWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG5hbWUgPSAnY2FsbCVzJyAlIG5hbWUKICAgICAgICByZXR1cm4gX2Zvcm1hdF9jYWxsX3NpZ25hdHVyZShuYW1lLCBhcmdzLCBrd2FyZ3MpCgoKICAgIGRlZiBjYWxsX2xpc3Qoc2VsZik6CiAgICAgICAgIiIiRm9yIGEgY2FsbCBvYmplY3QgdGhhdCByZXByZXNlbnRzIG11bHRpcGxlIGNhbGxzLCBgY2FsbF9saXN0YAogICAgICAgIHJldHVybnMgYSBsaXN0IG9mIGFsbCB0aGUgaW50ZXJtZWRpYXRlIGNhbGxzIGFzIHdlbGwgYXMgdGhlCiAgICAgICAgZmluYWwgY2FsbC4iIiIKICAgICAgICB2YWxzID0gW10KICAgICAgICB0aGluZyA9IHNlbGYKICAgICAgICB3aGlsZSB0aGluZyBpcyBub3QgTm9uZToKICAgICAgICAgICAgaWYgdGhpbmcuZnJvbV9rYWxsOgogICAgICAgICAgICAgICAgdmFscy5hcHBlbmQodGhpbmcpCiAgICAgICAgICAgIHRoaW5nID0gdGhpbmcucGFyZW50CiAgICAgICAgcmV0dXJuIF9DYWxsTGlzdChyZXZlcnNlZCh2YWxzKSkKCgpjYWxsID0gX0NhbGwoZnJvbV9rYWxsPUZhbHNlKQoKCgpkZWYgY3JlYXRlX2F1dG9zcGVjKHNwZWMsIHNwZWNfc2V0PUZhbHNlLCBpbnN0YW5jZT1GYWxzZSwgX3BhcmVudD1Ob25lLAogICAgICAgICAgICAgICAgICAgIF9uYW1lPU5vbmUsICoqa3dhcmdzKToKICAgICIiIkNyZWF0ZSBhIG1vY2sgb2JqZWN0IHVzaW5nIGFub3RoZXIgb2JqZWN0IGFzIGEgc3BlYy4gQXR0cmlidXRlcyBvbiB0aGUKICAgIG1vY2sgd2lsbCB1c2UgdGhlIGNvcnJlc3BvbmRpbmcgYXR0cmlidXRlIG9uIHRoZSBgc3BlY2Agb2JqZWN0IGFzIHRoZWlyCiAgICBzcGVjLgoKICAgIEZ1bmN0aW9ucyBvciBtZXRob2RzIGJlaW5nIG1vY2tlZCB3aWxsIGhhdmUgdGhlaXIgYXJndW1lbnRzIGNoZWNrZWQKICAgIHRvIGNoZWNrIHRoYXQgdGhleSBhcmUgY2FsbGVkIHdpdGggdGhlIGNvcnJlY3Qgc2lnbmF0dXJlLgoKICAgIElmIGBzcGVjX3NldGAgaXMgVHJ1ZSB0aGVuIGF0dGVtcHRpbmcgdG8gc2V0IGF0dHJpYnV0ZXMgdGhhdCBkb24ndCBleGlzdAogICAgb24gdGhlIHNwZWMgb2JqZWN0IHdpbGwgcmFpc2UgYW4gYEF0dHJpYnV0ZUVycm9yYC4KCiAgICBJZiBhIGNsYXNzIGlzIHVzZWQgYXMgYSBzcGVjIHRoZW4gdGhlIHJldHVybiB2YWx1ZSBvZiB0aGUgbW9jayAodGhlCiAgICBpbnN0YW5jZSBvZiB0aGUgY2xhc3MpIHdpbGwgaGF2ZSB0aGUgc2FtZSBzcGVjLiBZb3UgY2FuIHVzZSBhIGNsYXNzIGFzIHRoZQogICAgc3BlYyBmb3IgYW4gaW5zdGFuY2Ugb2JqZWN0IGJ5IHBhc3NpbmcgYGluc3RhbmNlPVRydWVgLiBUaGUgcmV0dXJuZWQgbW9jawogICAgd2lsbCBvbmx5IGJlIGNhbGxhYmxlIGlmIGluc3RhbmNlcyBvZiB0aGUgbW9jayBhcmUgY2FsbGFibGUuCgogICAgYGNyZWF0ZV9hdXRvc3BlY2AgYWxzbyB0YWtlcyBhcmJpdHJhcnkga2V5d29yZCBhcmd1bWVudHMgdGhhdCBhcmUgcGFzc2VkIHRvCiAgICB0aGUgY29uc3RydWN0b3Igb2YgdGhlIGNyZWF0ZWQgbW9jay4iIiIKICAgIGlmIF9pc19saXN0KHNwZWMpOgogICAgICAgICMgY2FuJ3QgcGFzcyBhIGxpc3QgaW5zdGFuY2UgdG8gdGhlIG1vY2sgY29uc3RydWN0b3IgYXMgaXQgd2lsbCBiZQogICAgICAgICMgaW50ZXJwcmV0ZWQgYXMgYSBsaXN0IG9mIHN0cmluZ3MKICAgICAgICBzcGVjID0gdHlwZShzcGVjKQoKICAgIGlzX3R5cGUgPSBpc2luc3RhbmNlKHNwZWMsIHR5cGUpCgogICAgX2t3YXJncyA9IHsnc3BlYyc6IHNwZWN9CiAgICBpZiBzcGVjX3NldDoKICAgICAgICBfa3dhcmdzID0geydzcGVjX3NldCc6IHNwZWN9CiAgICBlbGlmIHNwZWMgaXMgTm9uZToKICAgICAgICAjIE5vbmUgd2UgbW9jayB3aXRoIGEgbm9ybWFsIG1vY2sgd2l0aG91dCBhIHNwZWMKICAgICAgICBfa3dhcmdzID0ge30KCiAgICBfa3dhcmdzLnVwZGF0ZShrd2FyZ3MpCgogICAgS2xhc3MgPSBNYWdpY01vY2sKICAgIGlmIHR5cGUoc3BlYykgaW4gRGVzY3JpcHRvclR5cGVzOgogICAgICAgICMgZGVzY3JpcHRvcnMgZG9uJ3QgaGF2ZSBhIHNwZWMKICAgICAgICAjIGJlY2F1c2Ugd2UgZG9uJ3Qga25vdyB3aGF0IHR5cGUgdGhleSByZXR1cm4KICAgICAgICBfa3dhcmdzID0ge30KICAgIGVsaWYgbm90IF9jYWxsYWJsZShzcGVjKToKICAgICAgICBLbGFzcyA9IE5vbkNhbGxhYmxlTWFnaWNNb2NrCiAgICBlbGlmIGlzX3R5cGUgYW5kIGluc3RhbmNlIGFuZCBub3QgX2luc3RhbmNlX2NhbGxhYmxlKHNwZWMpOgogICAgICAgIEtsYXNzID0gTm9uQ2FsbGFibGVNYWdpY01vY2sKCiAgICBfbmV3X25hbWUgPSBfbmFtZQogICAgaWYgX3BhcmVudCBpcyBOb25lOgogICAgICAgICMgZm9yIGEgdG9wIGxldmVsIG9iamVjdCBubyBfbmV3X25hbWUgc2hvdWxkIGJlIHNldAogICAgICAgIF9uZXdfbmFtZSA9ICcnCgogICAgbW9jayA9IEtsYXNzKHBhcmVudD1fcGFyZW50LCBfbmV3X3BhcmVudD1fcGFyZW50LCBfbmV3X25hbWU9X25ld19uYW1lLAogICAgICAgICAgICAgICAgIG5hbWU9X25hbWUsICoqX2t3YXJncykKCiAgICBpZiBpc2luc3RhbmNlKHNwZWMsIEZ1bmN0aW9uVHlwZXMpOgogICAgICAgICMgc2hvdWxkIG9ubHkgaGFwcGVuIGF0IHRoZSB0b3AgbGV2ZWwgYmVjYXVzZSB3ZSBkb24ndAogICAgICAgICMgcmVjdXJzZSBmb3IgZnVuY3Rpb25zCiAgICAgICAgbW9jayA9IF9zZXRfc2lnbmF0dXJlKG1vY2ssIHNwZWMpCiAgICBlbHNlOgogICAgICAgIF9jaGVja19zaWduYXR1cmUoc3BlYywgbW9jaywgaXNfdHlwZSwgaW5zdGFuY2UpCgogICAgaWYgX3BhcmVudCBpcyBub3QgTm9uZSBhbmQgbm90IGluc3RhbmNlOgogICAgICAgIF9wYXJlbnQuX21vY2tfY2hpbGRyZW5bX25hbWVdID0gbW9jawoKICAgIGlmIGlzX3R5cGUgYW5kIG5vdCBpbnN0YW5jZSBhbmQgJ3JldHVybl92YWx1ZScgbm90IGluIGt3YXJnczoKICAgICAgICBtb2NrLnJldHVybl92YWx1ZSA9IGNyZWF0ZV9hdXRvc3BlYyhzcGVjLCBzcGVjX3NldCwgaW5zdGFuY2U9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbmFtZT0nKCknLCBfcGFyZW50PW1vY2spCgogICAgZm9yIGVudHJ5IGluIGRpcihzcGVjKToKICAgICAgICBpZiBfaXNfbWFnaWMoZW50cnkpOgogICAgICAgICAgICAjIE1hZ2ljTW9jayBhbHJlYWR5IGRvZXMgdGhlIHVzZWZ1bCBtYWdpYyBtZXRob2RzIGZvciB1cwogICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAjIFhYWFggZG8gd2UgbmVlZCBhIGJldHRlciB3YXkgb2YgZ2V0dGluZyBhdHRyaWJ1dGVzIHdpdGhvdXQKICAgICAgICAjIHRyaWdnZXJpbmcgY29kZSBleGVjdXRpb24gKD8pIFByb2JhYmx5IG5vdCAtIHdlIG5lZWQgdGhlIGFjdHVhbAogICAgICAgICMgb2JqZWN0IHRvIG1vY2sgaXQgc28gd2Ugd291bGQgcmF0aGVyIHRyaWdnZXIgYSBwcm9wZXJ0eSB0aGFuIG1vY2sKICAgICAgICAjIHRoZSBwcm9wZXJ0eSBkZXNjcmlwdG9yLiBMaWtld2lzZSB3ZSB3YW50IHRvIG1vY2sgb3V0IGR5bmFtaWNhbGx5CiAgICAgICAgIyBwcm92aWRlZCBhdHRyaWJ1dGVzLgogICAgICAgICMgWFhYWCB3aGF0IGFib3V0IGF0dHJpYnV0ZXMgdGhhdCByYWlzZSBleGNlcHRpb25zIG90aGVyIHRoYW4KICAgICAgICAjIEF0dHJpYnV0ZUVycm9yIG9uIGJlaW5nIGZldGNoZWQ/CiAgICAgICAgIyB3ZSBjb3VsZCBiZSByZXNpbGllbnQgYWdhaW5zdCBpdCwgb3IgY2F0Y2ggYW5kIHByb3BhZ2F0ZSB0aGUKICAgICAgICAjIGV4Y2VwdGlvbiB3aGVuIHRoZSBhdHRyaWJ1dGUgaXMgZmV0Y2hlZCBmcm9tIHRoZSBtb2NrCiAgICAgICAgdHJ5OgogICAgICAgICAgICBvcmlnaW5hbCA9IGdldGF0dHIoc3BlYywgZW50cnkpCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICBjb250aW51ZQoKICAgICAgICBrd2FyZ3MgPSB7J3NwZWMnOiBvcmlnaW5hbH0KICAgICAgICBpZiBzcGVjX3NldDoKICAgICAgICAgICAga3dhcmdzID0geydzcGVjX3NldCc6IG9yaWdpbmFsfQoKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShvcmlnaW5hbCwgRnVuY3Rpb25UeXBlcyk6CiAgICAgICAgICAgIG5ldyA9IF9TcGVjU3RhdGUob3JpZ2luYWwsIHNwZWNfc2V0LCBtb2NrLCBlbnRyeSwgaW5zdGFuY2UpCiAgICAgICAgICAgIG1vY2suX21vY2tfY2hpbGRyZW5bZW50cnldID0gbmV3CiAgICAgICAgZWxzZToKICAgICAgICAgICAgcGFyZW50ID0gbW9jawogICAgICAgICAgICBpZiBpc2luc3RhbmNlKHNwZWMsIEZ1bmN0aW9uVHlwZXMpOgogICAgICAgICAgICAgICAgcGFyZW50ID0gbW9jay5tb2NrCgogICAgICAgICAgICBuZXcgPSBNYWdpY01vY2socGFyZW50PXBhcmVudCwgbmFtZT1lbnRyeSwgX25ld19uYW1lPWVudHJ5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgX25ld19wYXJlbnQ9cGFyZW50LCAqKmt3YXJncykKICAgICAgICAgICAgbW9jay5fbW9ja19jaGlsZHJlbltlbnRyeV0gPSBuZXcKICAgICAgICAgICAgc2tpcGZpcnN0ID0gX211c3Rfc2tpcChzcGVjLCBlbnRyeSwgaXNfdHlwZSkKICAgICAgICAgICAgX2NoZWNrX3NpZ25hdHVyZShvcmlnaW5hbCwgbmV3LCBza2lwZmlyc3Q9c2tpcGZpcnN0KQoKICAgICAgICAjIHNvIGZ1bmN0aW9ucyBjcmVhdGVkIHdpdGggX3NldF9zaWduYXR1cmUgYmVjb21lIGluc3RhbmNlIGF0dHJpYnV0ZXMsCiAgICAgICAgIyAqcGx1cyogdGhlaXIgdW5kZXJseWluZyBtb2NrIGV4aXN0cyBpbiBfbW9ja19jaGlsZHJlbiBvZiB0aGUgcGFyZW50CiAgICAgICAgIyBtb2NrLiBBZGRpbmcgdG8gX21vY2tfY2hpbGRyZW4gbWF5IGJlIHVubmVjZXNzYXJ5IHdoZXJlIHdlIGFyZSBhbHNvCiAgICAgICAgIyBzZXR0aW5nIGFzIGFuIGluc3RhbmNlIGF0dHJpYnV0ZT8KICAgICAgICBpZiBpc2luc3RhbmNlKG5ldywgRnVuY3Rpb25UeXBlcyk6CiAgICAgICAgICAgIHNldGF0dHIobW9jaywgZW50cnksIG5ldykKCiAgICByZXR1cm4gbW9jawoKCmRlZiBfbXVzdF9za2lwKHNwZWMsIGVudHJ5LCBpc190eXBlKToKICAgIGlmIG5vdCBpc2luc3RhbmNlKHNwZWMsIHR5cGUpOgogICAgICAgIGlmIGVudHJ5IGluIGdldGF0dHIoc3BlYywgJ19fZGljdF9fJywge30pOgogICAgICAgICAgICAjIGluc3RhbmNlIGF0dHJpYnV0ZSAtIHNob3VsZG4ndCBza2lwCiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIHNwZWMgPSBzcGVjLl9fY2xhc3NfXwoKICAgIGZvciBrbGFzcyBpbiBzcGVjLl9fbXJvX186CiAgICAgICAgcmVzdWx0ID0ga2xhc3MuX19kaWN0X18uZ2V0KGVudHJ5LCBERUZBVUxUKQogICAgICAgIGlmIHJlc3VsdCBpcyBERUZBVUxUOgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGlmIGlzaW5zdGFuY2UocmVzdWx0LCAoc3RhdGljbWV0aG9kLCBjbGFzc21ldGhvZCkpOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICByZXR1cm4gaXNfdHlwZQoKICAgICMgc2hvdWxkbid0IGdldCBoZXJlIHVubGVzcyBmdW5jdGlvbiBpcyBhIGR5bmFtaWNhbGx5IHByb3ZpZGVkIGF0dHJpYnV0ZQogICAgIyBYWFhYIHVudGVzdGVkIGJlaGF2aW91cgogICAgcmV0dXJuIGlzX3R5cGUKCgpkZWYgX2dldF9jbGFzcyhvYmopOgogICAgdHJ5OgogICAgICAgIHJldHVybiBvYmouX19jbGFzc19fCiAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgIyBpdCBpcyBwb3NzaWJsZSBmb3Igb2JqZWN0cyB0byBoYXZlIG5vIF9fY2xhc3NfXwogICAgICAgIHJldHVybiB0eXBlKG9iaikKCgpjbGFzcyBfU3BlY1N0YXRlKG9iamVjdCk6CgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHNwZWMsIHNwZWNfc2V0PUZhbHNlLCBwYXJlbnQ9Tm9uZSwKICAgICAgICAgICAgICAgICBuYW1lPU5vbmUsIGlkcz1Ob25lLCBpbnN0YW5jZT1GYWxzZSk6CiAgICAgICAgc2VsZi5zcGVjID0gc3BlYwogICAgICAgIHNlbGYuaWRzID0gaWRzCiAgICAgICAgc2VsZi5zcGVjX3NldCA9IHNwZWNfc2V0CiAgICAgICAgc2VsZi5wYXJlbnQgPSBwYXJlbnQKICAgICAgICBzZWxmLmluc3RhbmNlID0gaW5zdGFuY2UKICAgICAgICBzZWxmLm5hbWUgPSBuYW1lCgoKRnVuY3Rpb25UeXBlcyA9ICgKICAgICMgcHl0aG9uIGZ1bmN0aW9uCiAgICB0eXBlKGNyZWF0ZV9hdXRvc3BlYyksCiAgICAjIGluc3RhbmNlIG1ldGhvZAogICAgdHlwZShBTlkuX19lcV9fKSwKKQoKCmZpbGVfc3BlYyA9IE5vbmUKCgpkZWYgbW9ja19vcGVuKG1vY2s9Tm9uZSwgcmVhZF9kYXRhPScnKToKICAgICIiIgogICAgQSBoZWxwZXIgZnVuY3Rpb24gdG8gY3JlYXRlIGEgbW9jayB0byByZXBsYWNlIHRoZSB1c2Ugb2YgYG9wZW5gLiBJdCB3b3JrcwogICAgZm9yIGBvcGVuYCBjYWxsZWQgZGlyZWN0bHkgb3IgdXNlZCBhcyBhIGNvbnRleHQgbWFuYWdlci4KCiAgICBUaGUgYG1vY2tgIGFyZ3VtZW50IGlzIHRoZSBtb2NrIG9iamVjdCB0byBjb25maWd1cmUuIElmIGBOb25lYCAodGhlCiAgICBkZWZhdWx0KSB0aGVuIGEgYE1hZ2ljTW9ja2Agd2lsbCBiZSBjcmVhdGVkIGZvciB5b3UsIHdpdGggdGhlIEFQSSBsaW1pdGVkCiAgICB0byBtZXRob2RzIG9yIGF0dHJpYnV0ZXMgYXZhaWxhYmxlIG9uIHN0YW5kYXJkIGZpbGUgaGFuZGxlcy4KCiAgICBgcmVhZF9kYXRhYCBpcyBhIHN0cmluZyBmb3IgdGhlIGByZWFkYCBtZXRob2Qgb2YgdGhlIGZpbGUgaGFuZGxlIHRvIHJldHVybi4KICAgIFRoaXMgaXMgYW4gZW1wdHkgc3RyaW5nIGJ5IGRlZmF1bHQuCiAgICAiIiIKICAgIGdsb2JhbCBmaWxlX3NwZWMKICAgIGlmIGZpbGVfc3BlYyBpcyBOb25lOgogICAgICAgIGltcG9ydCBfaW8KICAgICAgICBmaWxlX3NwZWMgPSBsaXN0KHNldChkaXIoX2lvLlRleHRJT1dyYXBwZXIpKS51bmlvbihzZXQoZGlyKF9pby5CeXRlc0lPKSkpKQoKICAgIGlmIG1vY2sgaXMgTm9uZToKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKG5hbWU9J29wZW4nLCBzcGVjPW9wZW4pCgogICAgaGFuZGxlID0gTWFnaWNNb2NrKHNwZWM9ZmlsZV9zcGVjKQogICAgaGFuZGxlLndyaXRlLnJldHVybl92YWx1ZSA9IE5vbmUKICAgIGhhbmRsZS5fX2VudGVyX18ucmV0dXJuX3ZhbHVlID0gaGFuZGxlCiAgICBoYW5kbGUucmVhZC5yZXR1cm5fdmFsdWUgPSByZWFkX2RhdGEKCiAgICBtb2NrLnJldHVybl92YWx1ZSA9IGhhbmRsZQogICAgcmV0dXJuIG1vY2sKCgpjbGFzcyBQcm9wZXJ0eU1vY2soTW9jayk6CiAgICAiIiIKICAgIEEgbW9jayBpbnRlbmRlZCB0byBiZSB1c2VkIGFzIGEgcHJvcGVydHksIG9yIG90aGVyIGRlc2NyaXB0b3IsIG9uIGEgY2xhc3MuCiAgICBgUHJvcGVydHlNb2NrYCBwcm92aWRlcyBgX19nZXRfX2AgYW5kIGBfX3NldF9fYCBtZXRob2RzIHNvIHlvdSBjYW4gc3BlY2lmeQogICAgYSByZXR1cm4gdmFsdWUgd2hlbiBpdCBpcyBmZXRjaGVkLgoKICAgIEZldGNoaW5nIGEgYFByb3BlcnR5TW9ja2AgaW5zdGFuY2UgZnJvbSBhbiBvYmplY3QgY2FsbHMgdGhlIG1vY2ssIHdpdGgKICAgIG5vIGFyZ3MuIFNldHRpbmcgaXQgY2FsbHMgdGhlIG1vY2sgd2l0aCB0aGUgdmFsdWUgYmVpbmcgc2V0LgogICAgIiIiCiAgICBkZWYgX2dldF9jaGlsZF9tb2NrKHNlbGYsICoqa3dhcmdzKToKICAgICAgICByZXR1cm4gTWFnaWNNb2NrKCoqa3dhcmdzKQoKICAgIGRlZiBfX2dldF9fKHNlbGYsIG9iaiwgb2JqX3R5cGUpOgogICAgICAgIHJldHVybiBzZWxmKCkKICAgIGRlZiBfX3NldF9fKHNlbGYsIG9iaiwgdmFsKToKICAgICAgICBzZWxmKHZhbCkK',
'/Lib/unittest/result.py':'IiIiVGVzdCByZXN1bHQgb2JqZWN0IiIiCgppbXBvcnQgaW8KaW1wb3J0IHN5cwppbXBvcnQgdHJhY2ViYWNrCgpmcm9tIC4gaW1wb3J0IHV0aWwKZnJvbSBmdW5jdG9vbHMgaW1wb3J0IHdyYXBzCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKZGVmIGZhaWxmYXN0KG1ldGhvZCk6CiAgICBAd3JhcHMobWV0aG9kKQogICAgZGVmIGlubmVyKHNlbGYsICphcmdzLCAqKmt3KToKICAgICAgICBpZiBnZXRhdHRyKHNlbGYsICdmYWlsZmFzdCcsIEZhbHNlKToKICAgICAgICAgICAgc2VsZi5zdG9wKCkKICAgICAgICByZXR1cm4gbWV0aG9kKHNlbGYsICphcmdzLCAqKmt3KQogICAgcmV0dXJuIGlubmVyCgpTVERPVVRfTElORSA9ICdcblN0ZG91dDpcbiVzJwpTVERFUlJfTElORSA9ICdcblN0ZGVycjpcbiVzJwoKCmNsYXNzIFRlc3RSZXN1bHQob2JqZWN0KToKICAgICIiIkhvbGRlciBmb3IgdGVzdCByZXN1bHQgaW5mb3JtYXRpb24uCgogICAgVGVzdCByZXN1bHRzIGFyZSBhdXRvbWF0aWNhbGx5IG1hbmFnZWQgYnkgdGhlIFRlc3RDYXNlIGFuZCBUZXN0U3VpdGUKICAgIGNsYXNzZXMsIGFuZCBkbyBub3QgbmVlZCB0byBiZSBleHBsaWNpdGx5IG1hbmlwdWxhdGVkIGJ5IHdyaXRlcnMgb2YgdGVzdHMuCgogICAgRWFjaCBpbnN0YW5jZSBob2xkcyB0aGUgdG90YWwgbnVtYmVyIG9mIHRlc3RzIHJ1biwgYW5kIGNvbGxlY3Rpb25zIG9mCiAgICBmYWlsdXJlcyBhbmQgZXJyb3JzIHRoYXQgb2NjdXJyZWQgYW1vbmcgdGhvc2UgdGVzdCBydW5zLiBUaGUgY29sbGVjdGlvbnMKICAgIGNvbnRhaW4gdHVwbGVzIG9mICh0ZXN0Y2FzZSwgZXhjZXB0aW9uaW5mbyksIHdoZXJlIGV4Y2VwdGlvbmluZm8gaXMgdGhlCiAgICBmb3JtYXR0ZWQgdHJhY2ViYWNrIG9mIHRoZSBlcnJvciB0aGF0IG9jY3VycmVkLgogICAgIiIiCiAgICBfcHJldmlvdXNUZXN0Q2xhc3MgPSBOb25lCiAgICBfdGVzdFJ1bkVudGVyZWQgPSBGYWxzZQogICAgX21vZHVsZVNldFVwRmFpbGVkID0gRmFsc2UKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzdHJlYW09Tm9uZSwgZGVzY3JpcHRpb25zPU5vbmUsIHZlcmJvc2l0eT1Ob25lKToKICAgICAgICBzZWxmLmZhaWxmYXN0ID0gRmFsc2UKICAgICAgICBzZWxmLmZhaWx1cmVzID0gW10KICAgICAgICBzZWxmLmVycm9ycyA9IFtdCiAgICAgICAgc2VsZi50ZXN0c1J1biA9IDAKICAgICAgICBzZWxmLnNraXBwZWQgPSBbXQogICAgICAgIHNlbGYuZXhwZWN0ZWRGYWlsdXJlcyA9IFtdCiAgICAgICAgc2VsZi51bmV4cGVjdGVkU3VjY2Vzc2VzID0gW10KICAgICAgICBzZWxmLnNob3VsZFN0b3AgPSBGYWxzZQogICAgICAgIHNlbGYuYnVmZmVyID0gRmFsc2UKICAgICAgICBzZWxmLl9zdGRvdXRfYnVmZmVyID0gTm9uZQogICAgICAgIHNlbGYuX3N0ZGVycl9idWZmZXIgPSBOb25lCiAgICAgICAgc2VsZi5fb3JpZ2luYWxfc3Rkb3V0ID0gc3lzLnN0ZG91dAogICAgICAgIHNlbGYuX29yaWdpbmFsX3N0ZGVyciA9IHN5cy5zdGRlcnIKICAgICAgICBzZWxmLl9taXJyb3JPdXRwdXQgPSBGYWxzZQoKICAgIGRlZiBwcmludEVycm9ycyhzZWxmKToKICAgICAgICAiQ2FsbGVkIGJ5IFRlc3RSdW5uZXIgYWZ0ZXIgdGVzdCBydW4iCgogICAgZGVmIHN0YXJ0VGVzdChzZWxmLCB0ZXN0KToKICAgICAgICAiQ2FsbGVkIHdoZW4gdGhlIGdpdmVuIHRlc3QgaXMgYWJvdXQgdG8gYmUgcnVuIgogICAgICAgIHNlbGYudGVzdHNSdW4gKz0gMQogICAgICAgIHNlbGYuX21pcnJvck91dHB1dCA9IEZhbHNlCiAgICAgICAgc2VsZi5fc2V0dXBTdGRvdXQoKQoKICAgIGRlZiBfc2V0dXBTdGRvdXQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5idWZmZXI6CiAgICAgICAgICAgIGlmIHNlbGYuX3N0ZGVycl9idWZmZXIgaXMgTm9uZToKICAgICAgICAgICAgICAgIHNlbGYuX3N0ZGVycl9idWZmZXIgPSBpby5TdHJpbmdJTygpCiAgICAgICAgICAgICAgICBzZWxmLl9zdGRvdXRfYnVmZmVyID0gaW8uU3RyaW5nSU8oKQogICAgICAgICAgICBzeXMuc3Rkb3V0ID0gc2VsZi5fc3Rkb3V0X2J1ZmZlcgogICAgICAgICAgICBzeXMuc3RkZXJyID0gc2VsZi5fc3RkZXJyX2J1ZmZlcgoKICAgIGRlZiBzdGFydFRlc3RSdW4oc2VsZik6CiAgICAgICAgIiIiQ2FsbGVkIG9uY2UgYmVmb3JlIGFueSB0ZXN0cyBhcmUgZXhlY3V0ZWQuCgogICAgICAgIFNlZSBzdGFydFRlc3QgZm9yIGEgbWV0aG9kIGNhbGxlZCBiZWZvcmUgZWFjaCB0ZXN0LgogICAgICAgICIiIgoKICAgIGRlZiBzdG9wVGVzdChzZWxmLCB0ZXN0KToKICAgICAgICAiIiJDYWxsZWQgd2hlbiB0aGUgZ2l2ZW4gdGVzdCBoYXMgYmVlbiBydW4iIiIKICAgICAgICBzZWxmLl9yZXN0b3JlU3Rkb3V0KCkKICAgICAgICBzZWxmLl9taXJyb3JPdXRwdXQgPSBGYWxzZQoKICAgIGRlZiBfcmVzdG9yZVN0ZG91dChzZWxmKToKICAgICAgICBpZiBzZWxmLmJ1ZmZlcjoKICAgICAgICAgICAgaWYgc2VsZi5fbWlycm9yT3V0cHV0OgogICAgICAgICAgICAgICAgb3V0cHV0ID0gc3lzLnN0ZG91dC5nZXR2YWx1ZSgpCiAgICAgICAgICAgICAgICBlcnJvciA9IHN5cy5zdGRlcnIuZ2V0dmFsdWUoKQogICAgICAgICAgICAgICAgaWYgb3V0cHV0OgogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBvdXRwdXQuZW5kc3dpdGgoJ1xuJyk6CiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCArPSAnXG4nCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fb3JpZ2luYWxfc3Rkb3V0LndyaXRlKFNURE9VVF9MSU5FICUgb3V0cHV0KQogICAgICAgICAgICAgICAgaWYgZXJyb3I6CiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGVycm9yLmVuZHN3aXRoKCdcbicpOgogICAgICAgICAgICAgICAgICAgICAgICBlcnJvciArPSAnXG4nCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fb3JpZ2luYWxfc3RkZXJyLndyaXRlKFNUREVSUl9MSU5FICUgZXJyb3IpCgogICAgICAgICAgICBzeXMuc3Rkb3V0ID0gc2VsZi5fb3JpZ2luYWxfc3Rkb3V0CiAgICAgICAgICAgIHN5cy5zdGRlcnIgPSBzZWxmLl9vcmlnaW5hbF9zdGRlcnIKICAgICAgICAgICAgc2VsZi5fc3Rkb3V0X2J1ZmZlci5zZWVrKDApCiAgICAgICAgICAgIHNlbGYuX3N0ZG91dF9idWZmZXIudHJ1bmNhdGUoKQogICAgICAgICAgICBzZWxmLl9zdGRlcnJfYnVmZmVyLnNlZWsoMCkKICAgICAgICAgICAgc2VsZi5fc3RkZXJyX2J1ZmZlci50cnVuY2F0ZSgpCgogICAgZGVmIHN0b3BUZXN0UnVuKHNlbGYpOgogICAgICAgICIiIkNhbGxlZCBvbmNlIGFmdGVyIGFsbCB0ZXN0cyBhcmUgZXhlY3V0ZWQuCgogICAgICAgIFNlZSBzdG9wVGVzdCBmb3IgYSBtZXRob2QgY2FsbGVkIGFmdGVyIGVhY2ggdGVzdC4KICAgICAgICAiIiIKCiAgICBAZmFpbGZhc3QKICAgIGRlZiBhZGRFcnJvcihzZWxmLCB0ZXN0LCBlcnIpOgogICAgICAgICIiIkNhbGxlZCB3aGVuIGFuIGVycm9yIGhhcyBvY2N1cnJlZC4gJ2VycicgaXMgYSB0dXBsZSBvZiB2YWx1ZXMgYXMKICAgICAgICByZXR1cm5lZCBieSBzeXMuZXhjX2luZm8oKS4KICAgICAgICAiIiIKICAgICAgICBzZWxmLmVycm9ycy5hcHBlbmQoKHRlc3QsIHNlbGYuX2V4Y19pbmZvX3RvX3N0cmluZyhlcnIsIHRlc3QpKSkKICAgICAgICBzZWxmLl9taXJyb3JPdXRwdXQgPSBUcnVlCgogICAgQGZhaWxmYXN0CiAgICBkZWYgYWRkRmFpbHVyZShzZWxmLCB0ZXN0LCBlcnIpOgogICAgICAgICIiIkNhbGxlZCB3aGVuIGFuIGVycm9yIGhhcyBvY2N1cnJlZC4gJ2VycicgaXMgYSB0dXBsZSBvZiB2YWx1ZXMgYXMKICAgICAgICByZXR1cm5lZCBieSBzeXMuZXhjX2luZm8oKS4iIiIKICAgICAgICBzZWxmLmZhaWx1cmVzLmFwcGVuZCgodGVzdCwgc2VsZi5fZXhjX2luZm9fdG9fc3RyaW5nKGVyciwgdGVzdCkpKQogICAgICAgIHNlbGYuX21pcnJvck91dHB1dCA9IFRydWUKCiAgICBkZWYgYWRkU3VjY2VzcyhzZWxmLCB0ZXN0KToKICAgICAgICAiQ2FsbGVkIHdoZW4gYSB0ZXN0IGhhcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5IgogICAgICAgIHBhc3MKCiAgICBkZWYgYWRkU2tpcChzZWxmLCB0ZXN0LCByZWFzb24pOgogICAgICAgICIiIkNhbGxlZCB3aGVuIGEgdGVzdCBpcyBza2lwcGVkLiIiIgogICAgICAgIHNlbGYuc2tpcHBlZC5hcHBlbmQoKHRlc3QsIHJlYXNvbikpCgogICAgZGVmIGFkZEV4cGVjdGVkRmFpbHVyZShzZWxmLCB0ZXN0LCBlcnIpOgogICAgICAgICIiIkNhbGxlZCB3aGVuIGFuIGV4cGVjdGVkIGZhaWx1cmUvZXJyb3Igb2NjdXJlZC4iIiIKICAgICAgICBzZWxmLmV4cGVjdGVkRmFpbHVyZXMuYXBwZW5kKAogICAgICAgICAgICAodGVzdCwgc2VsZi5fZXhjX2luZm9fdG9fc3RyaW5nKGVyciwgdGVzdCkpKQoKICAgIEBmYWlsZmFzdAogICAgZGVmIGFkZFVuZXhwZWN0ZWRTdWNjZXNzKHNlbGYsIHRlc3QpOgogICAgICAgICIiIkNhbGxlZCB3aGVuIGEgdGVzdCB3YXMgZXhwZWN0ZWQgdG8gZmFpbCwgYnV0IHN1Y2NlZWQuIiIiCiAgICAgICAgc2VsZi51bmV4cGVjdGVkU3VjY2Vzc2VzLmFwcGVuZCh0ZXN0KQoKICAgIGRlZiB3YXNTdWNjZXNzZnVsKHNlbGYpOgogICAgICAgICJUZWxscyB3aGV0aGVyIG9yIG5vdCB0aGlzIHJlc3VsdCB3YXMgYSBzdWNjZXNzIgogICAgICAgIHJldHVybiBsZW4oc2VsZi5mYWlsdXJlcykgPT0gbGVuKHNlbGYuZXJyb3JzKSA9PSAwCgogICAgZGVmIHN0b3Aoc2VsZik6CiAgICAgICAgIkluZGljYXRlcyB0aGF0IHRoZSB0ZXN0cyBzaG91bGQgYmUgYWJvcnRlZCIKICAgICAgICBzZWxmLnNob3VsZFN0b3AgPSBUcnVlCgogICAgZGVmIF9leGNfaW5mb190b19zdHJpbmcoc2VsZiwgZXJyLCB0ZXN0KToKICAgICAgICAiIiJDb252ZXJ0cyBhIHN5cy5leGNfaW5mbygpLXN0eWxlIHR1cGxlIG9mIHZhbHVlcyBpbnRvIGEgc3RyaW5nLiIiIgogICAgICAgIGV4Y3R5cGUsIHZhbHVlLCB0YiA9IGVycgogICAgICAgICMgU2tpcCB0ZXN0IHJ1bm5lciB0cmFjZWJhY2sgbGV2ZWxzCiAgICAgICAgd2hpbGUgdGIgYW5kIHNlbGYuX2lzX3JlbGV2YW50X3RiX2xldmVsKHRiKToKICAgICAgICAgICAgdGIgPSB0Yi50Yl9uZXh0CgogICAgICAgIGlmIGV4Y3R5cGUgaXMgdGVzdC5mYWlsdXJlRXhjZXB0aW9uOgogICAgICAgICAgICAjIFNraXAgYXNzZXJ0KigpIHRyYWNlYmFjayBsZXZlbHMKICAgICAgICAgICAgbGVuZ3RoID0gc2VsZi5fY291bnRfcmVsZXZhbnRfdGJfbGV2ZWxzKHRiKQogICAgICAgICAgICBtc2dMaW5lcyA9IHRyYWNlYmFjay5mb3JtYXRfZXhjZXB0aW9uKGV4Y3R5cGUsIHZhbHVlLCB0YiwgbGVuZ3RoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1zZ0xpbmVzID0gdHJhY2ViYWNrLmZvcm1hdF9leGNlcHRpb24oZXhjdHlwZSwgdmFsdWUsIHRiKQoKICAgICAgICBpZiBzZWxmLmJ1ZmZlcjoKICAgICAgICAgICAgb3V0cHV0ID0gc3lzLnN0ZG91dC5nZXR2YWx1ZSgpCiAgICAgICAgICAgIGVycm9yID0gc3lzLnN0ZGVyci5nZXR2YWx1ZSgpCiAgICAgICAgICAgIGlmIG91dHB1dDoKICAgICAgICAgICAgICAgIGlmIG5vdCBvdXRwdXQuZW5kc3dpdGgoJ1xuJyk6CiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ICs9ICdcbicKICAgICAgICAgICAgICAgIG1zZ0xpbmVzLmFwcGVuZChTVERPVVRfTElORSAlIG91dHB1dCkKICAgICAgICAgICAgaWYgZXJyb3I6CiAgICAgICAgICAgICAgICBpZiBub3QgZXJyb3IuZW5kc3dpdGgoJ1xuJyk6CiAgICAgICAgICAgICAgICAgICAgZXJyb3IgKz0gJ1xuJwogICAgICAgICAgICAgICAgbXNnTGluZXMuYXBwZW5kKFNUREVSUl9MSU5FICUgZXJyb3IpCiAgICAgICAgcmV0dXJuICcnLmpvaW4obXNnTGluZXMpCgoKICAgIGRlZiBfaXNfcmVsZXZhbnRfdGJfbGV2ZWwoc2VsZiwgdGIpOgogICAgICAgIHJldHVybiAnX191bml0dGVzdCcgaW4gdGIudGJfZnJhbWUuZl9nbG9iYWxzCgogICAgZGVmIF9jb3VudF9yZWxldmFudF90Yl9sZXZlbHMoc2VsZiwgdGIpOgogICAgICAgIGxlbmd0aCA9IDAKICAgICAgICB3aGlsZSB0YiBhbmQgbm90IHNlbGYuX2lzX3JlbGV2YW50X3RiX2xldmVsKHRiKToKICAgICAgICAgICAgbGVuZ3RoICs9IDEKICAgICAgICAgICAgdGIgPSB0Yi50Yl9uZXh0CiAgICAgICAgcmV0dXJuIGxlbmd0aAoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gKCI8JXMgcnVuPSVpIGVycm9ycz0laSBmYWlsdXJlcz0laT4iICUKICAgICAgICAgICAgICAgKHV0aWwuc3RyY2xhc3Moc2VsZi5fX2NsYXNzX18pLCBzZWxmLnRlc3RzUnVuLCBsZW4oc2VsZi5lcnJvcnMpLAogICAgICAgICAgICAgICAgbGVuKHNlbGYuZmFpbHVyZXMpKSkK',
'/Lib/unittest/runner.py':'IiIiUnVubmluZyB0ZXN0cyIiIgoKaW1wb3J0IHN5cwppbXBvcnQgdGltZQppbXBvcnQgd2FybmluZ3MKCmZyb20gLiBpbXBvcnQgcmVzdWx0CmZyb20gLnNpZ25hbHMgaW1wb3J0IHJlZ2lzdGVyUmVzdWx0CgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKCmNsYXNzIF9Xcml0ZWxuRGVjb3JhdG9yKG9iamVjdCk6CiAgICAiIiJVc2VkIHRvIGRlY29yYXRlIGZpbGUtbGlrZSBvYmplY3RzIHdpdGggYSBoYW5keSAnd3JpdGVsbicgbWV0aG9kIiIiCiAgICBkZWYgX19pbml0X18oc2VsZixzdHJlYW0pOgogICAgICAgIHNlbGYuc3RyZWFtID0gc3RyZWFtCgogICAgZGVmIF9fZ2V0YXR0cl9fKHNlbGYsIGF0dHIpOgogICAgICAgIGlmIGF0dHIgaW4gKCdzdHJlYW0nLCAnX19nZXRzdGF0ZV9fJyk6CiAgICAgICAgICAgIHJhaXNlIEF0dHJpYnV0ZUVycm9yKGF0dHIpCiAgICAgICAgcmV0dXJuIGdldGF0dHIoc2VsZi5zdHJlYW0sYXR0cikKCiAgICBkZWYgd3JpdGVsbihzZWxmLCBhcmc9Tm9uZSk6CiAgICAgICAgaWYgYXJnOgogICAgICAgICAgICBzZWxmLndyaXRlKGFyZykKICAgICAgICBzZWxmLndyaXRlKCdcbicpICMgdGV4dC1tb2RlIHN0cmVhbXMgdHJhbnNsYXRlIHRvIFxyXG4gaWYgbmVlZGVkCgoKY2xhc3MgVGV4dFRlc3RSZXN1bHQocmVzdWx0LlRlc3RSZXN1bHQpOgogICAgIiIiQSB0ZXN0IHJlc3VsdCBjbGFzcyB0aGF0IGNhbiBwcmludCBmb3JtYXR0ZWQgdGV4dCByZXN1bHRzIHRvIGEgc3RyZWFtLgoKICAgIFVzZWQgYnkgVGV4dFRlc3RSdW5uZXIuCiAgICAiIiIKICAgIHNlcGFyYXRvcjEgPSAnPScgKiA3MAogICAgc2VwYXJhdG9yMiA9ICctJyAqIDcwCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHN0cmVhbSwgZGVzY3JpcHRpb25zLCB2ZXJib3NpdHkpOgogICAgICAgIHN1cGVyKFRleHRUZXN0UmVzdWx0LCBzZWxmKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5zdHJlYW0gPSBzdHJlYW0KICAgICAgICBzZWxmLnNob3dBbGwgPSB2ZXJib3NpdHkgPiAxCiAgICAgICAgc2VsZi5kb3RzID0gdmVyYm9zaXR5ID09IDEKICAgICAgICBzZWxmLmRlc2NyaXB0aW9ucyA9IGRlc2NyaXB0aW9ucwoKICAgIGRlZiBnZXREZXNjcmlwdGlvbihzZWxmLCB0ZXN0KToKICAgICAgICBkb2NfZmlyc3RfbGluZSA9IHRlc3Quc2hvcnREZXNjcmlwdGlvbigpCiAgICAgICAgaWYgc2VsZi5kZXNjcmlwdGlvbnMgYW5kIGRvY19maXJzdF9saW5lOgogICAgICAgICAgICByZXR1cm4gJ1xuJy5qb2luKChzdHIodGVzdCksIGRvY19maXJzdF9saW5lKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gc3RyKHRlc3QpCgogICAgZGVmIHN0YXJ0VGVzdChzZWxmLCB0ZXN0KToKICAgICAgICBzdXBlcihUZXh0VGVzdFJlc3VsdCwgc2VsZikuc3RhcnRUZXN0KHRlc3QpCiAgICAgICAgaWYgc2VsZi5zaG93QWxsOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZShzZWxmLmdldERlc2NyaXB0aW9uKHRlc3QpKQogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZSgiIC4uLiAiKQogICAgICAgICAgICBzZWxmLnN0cmVhbS5mbHVzaCgpCgogICAgZGVmIGFkZFN1Y2Nlc3Moc2VsZiwgdGVzdCk6CiAgICAgICAgc3VwZXIoVGV4dFRlc3RSZXN1bHQsIHNlbGYpLmFkZFN1Y2Nlc3ModGVzdCkKICAgICAgICBpZiBzZWxmLnNob3dBbGw6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oIm9rIikKICAgICAgICBlbGlmIHNlbGYuZG90czoKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGUoJy4nKQogICAgICAgICAgICBzZWxmLnN0cmVhbS5mbHVzaCgpCgogICAgZGVmIGFkZEVycm9yKHNlbGYsIHRlc3QsIGVycik6CiAgICAgICAgc3VwZXIoVGV4dFRlc3RSZXN1bHQsIHNlbGYpLmFkZEVycm9yKHRlc3QsIGVycikKICAgICAgICBpZiBzZWxmLnNob3dBbGw6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oIkVSUk9SIikKICAgICAgICBlbGlmIHNlbGYuZG90czoKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGUoJ0UnKQogICAgICAgICAgICBzZWxmLnN0cmVhbS5mbHVzaCgpCgogICAgZGVmIGFkZEZhaWx1cmUoc2VsZiwgdGVzdCwgZXJyKToKICAgICAgICBzdXBlcihUZXh0VGVzdFJlc3VsdCwgc2VsZikuYWRkRmFpbHVyZSh0ZXN0LCBlcnIpCiAgICAgICAgaWYgc2VsZi5zaG93QWxsOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCJGQUlMIikKICAgICAgICBlbGlmIHNlbGYuZG90czoKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGUoJ0YnKQogICAgICAgICAgICBzZWxmLnN0cmVhbS5mbHVzaCgpCgogICAgZGVmIGFkZFNraXAoc2VsZiwgdGVzdCwgcmVhc29uKToKICAgICAgICBzdXBlcihUZXh0VGVzdFJlc3VsdCwgc2VsZikuYWRkU2tpcCh0ZXN0LCByZWFzb24pCiAgICAgICAgaWYgc2VsZi5zaG93QWxsOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCJza2lwcGVkIHswIXJ9Ii5mb3JtYXQocmVhc29uKSkKICAgICAgICBlbGlmIHNlbGYuZG90czoKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGUoInMiKQogICAgICAgICAgICBzZWxmLnN0cmVhbS5mbHVzaCgpCgogICAgZGVmIGFkZEV4cGVjdGVkRmFpbHVyZShzZWxmLCB0ZXN0LCBlcnIpOgogICAgICAgIHN1cGVyKFRleHRUZXN0UmVzdWx0LCBzZWxmKS5hZGRFeHBlY3RlZEZhaWx1cmUodGVzdCwgZXJyKQogICAgICAgIGlmIHNlbGYuc2hvd0FsbDoKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbigiZXhwZWN0ZWQgZmFpbHVyZSIpCiAgICAgICAgZWxpZiBzZWxmLmRvdHM6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlKCJ4IikKICAgICAgICAgICAgc2VsZi5zdHJlYW0uZmx1c2goKQoKICAgIGRlZiBhZGRVbmV4cGVjdGVkU3VjY2VzcyhzZWxmLCB0ZXN0KToKICAgICAgICBzdXBlcihUZXh0VGVzdFJlc3VsdCwgc2VsZikuYWRkVW5leHBlY3RlZFN1Y2Nlc3ModGVzdCkKICAgICAgICBpZiBzZWxmLnNob3dBbGw6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oInVuZXhwZWN0ZWQgc3VjY2VzcyIpCiAgICAgICAgZWxpZiBzZWxmLmRvdHM6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlKCJ1IikKICAgICAgICAgICAgc2VsZi5zdHJlYW0uZmx1c2goKQoKICAgIGRlZiBwcmludEVycm9ycyhzZWxmKToKICAgICAgICBpZiBzZWxmLmRvdHMgb3Igc2VsZi5zaG93QWxsOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCkKICAgICAgICBzZWxmLnByaW50RXJyb3JMaXN0KCdFUlJPUicsIHNlbGYuZXJyb3JzKQogICAgICAgIHNlbGYucHJpbnRFcnJvckxpc3QoJ0ZBSUwnLCBzZWxmLmZhaWx1cmVzKQoKICAgIGRlZiBwcmludEVycm9yTGlzdChzZWxmLCBmbGF2b3VyLCBlcnJvcnMpOgogICAgICAgIGZvciB0ZXN0LCBlcnIgaW4gZXJyb3JzOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKHNlbGYuc2VwYXJhdG9yMSkKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbigiJXM6ICVzIiAlIChmbGF2b3VyLHNlbGYuZ2V0RGVzY3JpcHRpb24odGVzdCkpKQogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKHNlbGYuc2VwYXJhdG9yMikKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbigiJXMiICUgZXJyKQoKCmNsYXNzIFRleHRUZXN0UnVubmVyKG9iamVjdCk6CiAgICAiIiJBIHRlc3QgcnVubmVyIGNsYXNzIHRoYXQgZGlzcGxheXMgcmVzdWx0cyBpbiB0ZXh0dWFsIGZvcm0uCgogICAgSXQgcHJpbnRzIG91dCB0aGUgbmFtZXMgb2YgdGVzdHMgYXMgdGhleSBhcmUgcnVuLCBlcnJvcnMgYXMgdGhleQogICAgb2NjdXIsIGFuZCBhIHN1bW1hcnkgb2YgdGhlIHJlc3VsdHMgYXQgdGhlIGVuZCBvZiB0aGUgdGVzdCBydW4uCiAgICAiIiIKICAgIHJlc3VsdGNsYXNzID0gVGV4dFRlc3RSZXN1bHQKCiAgICBkZWYgX19pbml0X18oc2VsZiwgc3RyZWFtPU5vbmUsIGRlc2NyaXB0aW9ucz1UcnVlLCB2ZXJib3NpdHk9MSwKICAgICAgICAgICAgICAgICBmYWlsZmFzdD1GYWxzZSwgYnVmZmVyPUZhbHNlLCByZXN1bHRjbGFzcz1Ob25lLCB3YXJuaW5ncz1Ob25lKToKICAgICAgICBpZiBzdHJlYW0gaXMgTm9uZToKICAgICAgICAgICAgc3RyZWFtID0gc3lzLnN0ZGVycgogICAgICAgIHNlbGYuc3RyZWFtID0gX1dyaXRlbG5EZWNvcmF0b3Ioc3RyZWFtKQogICAgICAgIHNlbGYuZGVzY3JpcHRpb25zID0gZGVzY3JpcHRpb25zCiAgICAgICAgc2VsZi52ZXJib3NpdHkgPSB2ZXJib3NpdHkKICAgICAgICBzZWxmLmZhaWxmYXN0ID0gZmFpbGZhc3QKICAgICAgICBzZWxmLmJ1ZmZlciA9IGJ1ZmZlcgogICAgICAgIHNlbGYud2FybmluZ3MgPSB3YXJuaW5ncwogICAgICAgIGlmIHJlc3VsdGNsYXNzIGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLnJlc3VsdGNsYXNzID0gcmVzdWx0Y2xhc3MKCiAgICBkZWYgX21ha2VSZXN1bHQoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYucmVzdWx0Y2xhc3Moc2VsZi5zdHJlYW0sIHNlbGYuZGVzY3JpcHRpb25zLCBzZWxmLnZlcmJvc2l0eSkKCiAgICBkZWYgcnVuKHNlbGYsIHRlc3QpOgogICAgICAgICJSdW4gdGhlIGdpdmVuIHRlc3QgY2FzZSBvciB0ZXN0IHN1aXRlLiIKICAgICAgICByZXN1bHQgPSBzZWxmLl9tYWtlUmVzdWx0KCkKICAgICAgICByZWdpc3RlclJlc3VsdChyZXN1bHQpCiAgICAgICAgcmVzdWx0LmZhaWxmYXN0ID0gc2VsZi5mYWlsZmFzdAogICAgICAgIHJlc3VsdC5idWZmZXIgPSBzZWxmLmJ1ZmZlcgogICAgICAgIHdpdGggd2FybmluZ3MuY2F0Y2hfd2FybmluZ3MoKToKICAgICAgICAgICAgaWYgc2VsZi53YXJuaW5nczoKICAgICAgICAgICAgICAgICMgaWYgc2VsZi53YXJuaW5ncyBpcyBzZXQsIHVzZSBpdCB0byBmaWx0ZXIgYWxsIHRoZSB3YXJuaW5ncwogICAgICAgICAgICAgICAgd2FybmluZ3Muc2ltcGxlZmlsdGVyKHNlbGYud2FybmluZ3MpCiAgICAgICAgICAgICAgICAjIGlmIHRoZSBmaWx0ZXIgaXMgJ2RlZmF1bHQnIG9yICdhbHdheXMnLCBzcGVjaWFsLWNhc2UgdGhlCiAgICAgICAgICAgICAgICAjIHdhcm5pbmdzIGZyb20gdGhlIGRlcHJlY2F0ZWQgdW5pdHRlc3QgbWV0aG9kcyB0byBzaG93IHRoZW0KICAgICAgICAgICAgICAgICMgbm8gbW9yZSB0aGFuIG9uY2UgcGVyIG1vZHVsZSwgYmVjYXVzZSB0aGV5IGNhbiBiZSBmYWlybHkKICAgICAgICAgICAgICAgICMgbm9pc3kuICBUaGUgLVdkIGFuZCAtV2EgZmxhZ3MgY2FuIGJlIHVzZWQgdG8gYnlwYXNzIHRoaXMKICAgICAgICAgICAgICAgICMgb25seSB3aGVuIHNlbGYud2FybmluZ3MgaXMgTm9uZS4KICAgICAgICAgICAgICAgIGlmIHNlbGYud2FybmluZ3MgaW4gWydkZWZhdWx0JywgJ2Fsd2F5cyddOgogICAgICAgICAgICAgICAgICAgIHdhcm5pbmdzLmZpbHRlcndhcm5pbmdzKCdtb2R1bGUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk9RGVwcmVjYXRpb25XYXJuaW5nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZT0nUGxlYXNlIHVzZSBhc3NlcnRcdysgaW5zdGVhZC4nKQogICAgICAgICAgICBzdGFydFRpbWUgPSB0aW1lLnRpbWUoKQogICAgICAgICAgICBzdGFydFRlc3RSdW4gPSBnZXRhdHRyKHJlc3VsdCwgJ3N0YXJ0VGVzdFJ1bicsIE5vbmUpCiAgICAgICAgICAgIGlmIHN0YXJ0VGVzdFJ1biBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHN0YXJ0VGVzdFJ1bigpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHRlc3QocmVzdWx0KQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgc3RvcFRlc3RSdW4gPSBnZXRhdHRyKHJlc3VsdCwgJ3N0b3BUZXN0UnVuJywgTm9uZSkKICAgICAgICAgICAgICAgIGlmIHN0b3BUZXN0UnVuIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIHN0b3BUZXN0UnVuKCkKICAgICAgICAgICAgc3RvcFRpbWUgPSB0aW1lLnRpbWUoKQogICAgICAgIHRpbWVUYWtlbiA9IHN0b3BUaW1lIC0gc3RhcnRUaW1lCiAgICAgICAgcmVzdWx0LnByaW50RXJyb3JzKCkKICAgICAgICBpZiBoYXNhdHRyKHJlc3VsdCwgJ3NlcGFyYXRvcjInKToKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbihyZXN1bHQuc2VwYXJhdG9yMikKICAgICAgICBydW4gPSByZXN1bHQudGVzdHNSdW4KICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCJSYW4gJWQgdGVzdCVzIGluICUuM2ZzIiAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAocnVuLCBydW4gIT0gMSBhbmQgInMiIG9yICIiLCB0aW1lVGFrZW4pKQogICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oKQoKICAgICAgICBleHBlY3RlZEZhaWxzID0gdW5leHBlY3RlZFN1Y2Nlc3NlcyA9IHNraXBwZWQgPSAwCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXN1bHRzID0gbWFwKGxlbiwgKHJlc3VsdC5leHBlY3RlZEZhaWx1cmVzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC51bmV4cGVjdGVkU3VjY2Vzc2VzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5za2lwcGVkKSkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBleHBlY3RlZEZhaWxzLCB1bmV4cGVjdGVkU3VjY2Vzc2VzLCBza2lwcGVkID0gcmVzdWx0cwoKICAgICAgICBpbmZvcyA9IFtdCiAgICAgICAgaWYgbm90IHJlc3VsdC53YXNTdWNjZXNzZnVsKCk6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlKCJGQUlMRUQiKQogICAgICAgICAgICBmYWlsZWQsIGVycm9yZWQgPSBsZW4ocmVzdWx0LmZhaWx1cmVzKSwgbGVuKHJlc3VsdC5lcnJvcnMpCiAgICAgICAgICAgIGlmIGZhaWxlZDoKICAgICAgICAgICAgICAgIGluZm9zLmFwcGVuZCgiZmFpbHVyZXM9JWQiICUgZmFpbGVkKQogICAgICAgICAgICBpZiBlcnJvcmVkOgogICAgICAgICAgICAgICAgaW5mb3MuYXBwZW5kKCJlcnJvcnM9JWQiICUgZXJyb3JlZCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZSgiT0siKQogICAgICAgIGlmIHNraXBwZWQ6CiAgICAgICAgICAgIGluZm9zLmFwcGVuZCgic2tpcHBlZD0lZCIgJSBza2lwcGVkKQogICAgICAgIGlmIGV4cGVjdGVkRmFpbHM6CiAgICAgICAgICAgIGluZm9zLmFwcGVuZCgiZXhwZWN0ZWQgZmFpbHVyZXM9JWQiICUgZXhwZWN0ZWRGYWlscykKICAgICAgICBpZiB1bmV4cGVjdGVkU3VjY2Vzc2VzOgogICAgICAgICAgICBpbmZvcy5hcHBlbmQoInVuZXhwZWN0ZWQgc3VjY2Vzc2VzPSVkIiAlIHVuZXhwZWN0ZWRTdWNjZXNzZXMpCiAgICAgICAgaWYgaW5mb3M6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oIiAoJXMpIiAlICgiLCAiLmpvaW4oaW5mb3MpLCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGUoIlxuIikKICAgICAgICByZXR1cm4gcmVzdWx0Cg==',
'/Lib/unittest/signals.py':'aW1wb3J0IHNpZ25hbAppbXBvcnQgd2Vha3JlZgoKZnJvbSBmdW5jdG9vbHMgaW1wb3J0IHdyYXBzCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKCmNsYXNzIF9JbnRlcnJ1cHRIYW5kbGVyKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgZGVmYXVsdF9oYW5kbGVyKToKICAgICAgICBzZWxmLmNhbGxlZCA9IEZhbHNlCiAgICAgICAgc2VsZi5kZWZhdWx0X2hhbmRsZXIgPSBkZWZhdWx0X2hhbmRsZXIKCiAgICBkZWYgX19jYWxsX18oc2VsZiwgc2lnbnVtLCBmcmFtZSk6CiAgICAgICAgaW5zdGFsbGVkX2hhbmRsZXIgPSBzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpCiAgICAgICAgaWYgaW5zdGFsbGVkX2hhbmRsZXIgaXMgbm90IHNlbGY6CiAgICAgICAgICAgICMgaWYgd2UgYXJlbid0IHRoZSBpbnN0YWxsZWQgaGFuZGxlciwgdGhlbiBkZWxlZ2F0ZSBpbW1lZGlhdGVseQogICAgICAgICAgICAjIHRvIHRoZSBkZWZhdWx0IGhhbmRsZXIKICAgICAgICAgICAgc2VsZi5kZWZhdWx0X2hhbmRsZXIoc2lnbnVtLCBmcmFtZSkKCiAgICAgICAgaWYgc2VsZi5jYWxsZWQ6CiAgICAgICAgICAgIHNlbGYuZGVmYXVsdF9oYW5kbGVyKHNpZ251bSwgZnJhbWUpCiAgICAgICAgc2VsZi5jYWxsZWQgPSBUcnVlCiAgICAgICAgZm9yIHJlc3VsdCBpbiBfcmVzdWx0cy5rZXlzKCk6CiAgICAgICAgICAgIHJlc3VsdC5zdG9wKCkKCl9yZXN1bHRzID0gd2Vha3JlZi5XZWFrS2V5RGljdGlvbmFyeSgpCmRlZiByZWdpc3RlclJlc3VsdChyZXN1bHQpOgogICAgX3Jlc3VsdHNbcmVzdWx0XSA9IDEKCmRlZiByZW1vdmVSZXN1bHQocmVzdWx0KToKICAgIHJldHVybiBib29sKF9yZXN1bHRzLnBvcChyZXN1bHQsIE5vbmUpKQoKX2ludGVycnVwdF9oYW5kbGVyID0gTm9uZQpkZWYgaW5zdGFsbEhhbmRsZXIoKToKICAgIGdsb2JhbCBfaW50ZXJydXB0X2hhbmRsZXIKICAgIGlmIF9pbnRlcnJ1cHRfaGFuZGxlciBpcyBOb25lOgogICAgICAgIGRlZmF1bHRfaGFuZGxlciA9IHNpZ25hbC5nZXRzaWduYWwoc2lnbmFsLlNJR0lOVCkKICAgICAgICBfaW50ZXJydXB0X2hhbmRsZXIgPSBfSW50ZXJydXB0SGFuZGxlcihkZWZhdWx0X2hhbmRsZXIpCiAgICAgICAgc2lnbmFsLnNpZ25hbChzaWduYWwuU0lHSU5ULCBfaW50ZXJydXB0X2hhbmRsZXIpCgoKZGVmIHJlbW92ZUhhbmRsZXIobWV0aG9kPU5vbmUpOgogICAgaWYgbWV0aG9kIGlzIG5vdCBOb25lOgogICAgICAgIEB3cmFwcyhtZXRob2QpCiAgICAgICAgZGVmIGlubmVyKCphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIGluaXRpYWwgPSBzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpCiAgICAgICAgICAgIHJlbW92ZUhhbmRsZXIoKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICByZXR1cm4gbWV0aG9kKCphcmdzLCAqKmt3YXJncykKICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgIHNpZ25hbC5zaWduYWwoc2lnbmFsLlNJR0lOVCwgaW5pdGlhbCkKICAgICAgICByZXR1cm4gaW5uZXIKCiAgICBnbG9iYWwgX2ludGVycnVwdF9oYW5kbGVyCiAgICBpZiBfaW50ZXJydXB0X2hhbmRsZXIgaXMgbm90IE5vbmU6CiAgICAgICAgc2lnbmFsLnNpZ25hbChzaWduYWwuU0lHSU5ULCBfaW50ZXJydXB0X2hhbmRsZXIuZGVmYXVsdF9oYW5kbGVyKQo=',
'/Lib/unittest/suite.py':'IiIiVGVzdFN1aXRlIiIiCgppbXBvcnQgc3lzCgpmcm9tIC4gaW1wb3J0IGNhc2UKZnJvbSAuIGltcG9ydCB1dGlsCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKCmRlZiBfY2FsbF9pZl9leGlzdHMocGFyZW50LCBhdHRyKToKICAgIGZ1bmMgPSBnZXRhdHRyKHBhcmVudCwgYXR0ciwgbGFtYmRhOiBOb25lKQogICAgZnVuYygpCgoKY2xhc3MgQmFzZVRlc3RTdWl0ZShvYmplY3QpOgogICAgIiIiQSBzaW1wbGUgdGVzdCBzdWl0ZSB0aGF0IGRvZXNuJ3QgcHJvdmlkZSBjbGFzcyBvciBtb2R1bGUgc2hhcmVkIGZpeHR1cmVzLgogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgdGVzdHM9KCkpOgogICAgICAgIHNlbGYuX3Rlc3RzID0gW10KICAgICAgICBzZWxmLmFkZFRlc3RzKHRlc3RzKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gIjwlcyB0ZXN0cz0lcz4iICUgKHV0aWwuc3RyY2xhc3Moc2VsZi5fX2NsYXNzX18pLCBsaXN0KHNlbGYpKQoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBzZWxmLl9fY2xhc3NfXyk6CiAgICAgICAgICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZAogICAgICAgIHJldHVybiBsaXN0KHNlbGYpID09IGxpc3Qob3RoZXIpCgogICAgZGVmIF9fbmVfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgcmV0dXJuIG5vdCBzZWxmID09IG90aGVyCgogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBpdGVyKHNlbGYuX3Rlc3RzKQoKICAgIGRlZiBjb3VudFRlc3RDYXNlcyhzZWxmKToKICAgICAgICBjYXNlcyA9IDAKICAgICAgICBmb3IgdGVzdCBpbiBzZWxmOgogICAgICAgICAgICBjYXNlcyArPSB0ZXN0LmNvdW50VGVzdENhc2VzKCkKICAgICAgICByZXR1cm4gY2FzZXMKCiAgICBkZWYgYWRkVGVzdChzZWxmLCB0ZXN0KToKICAgICAgICAjIHNhbml0eSBjaGVja3MKICAgICAgICBpZiBub3QgY2FsbGFibGUodGVzdCk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigie30gaXMgbm90IGNhbGxhYmxlIi5mb3JtYXQocmVwcih0ZXN0KSkpCiAgICAgICAgaWYgaXNpbnN0YW5jZSh0ZXN0LCB0eXBlKSBhbmQgaXNzdWJjbGFzcyh0ZXN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNhc2UuVGVzdENhc2UsIFRlc3RTdWl0ZSkpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIlRlc3RDYXNlcyBhbmQgVGVzdFN1aXRlcyBtdXN0IGJlIGluc3RhbnRpYXRlZCAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYmVmb3JlIHBhc3NpbmcgdGhlbSB0byBhZGRUZXN0KCkiKQogICAgICAgIHNlbGYuX3Rlc3RzLmFwcGVuZCh0ZXN0KQoKICAgIGRlZiBhZGRUZXN0cyhzZWxmLCB0ZXN0cyk6CiAgICAgICAgaWYgaXNpbnN0YW5jZSh0ZXN0cywgc3RyKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJ0ZXN0cyBtdXN0IGJlIGFuIGl0ZXJhYmxlIG9mIHRlc3RzLCBub3QgYSBzdHJpbmciKQogICAgICAgIGZvciB0ZXN0IGluIHRlc3RzOgogICAgICAgICAgICBzZWxmLmFkZFRlc3QodGVzdCkKCiAgICBkZWYgcnVuKHNlbGYsIHJlc3VsdCk6CiAgICAgICAgZm9yIHRlc3QgaW4gc2VsZjoKICAgICAgICAgICAgaWYgcmVzdWx0LnNob3VsZFN0b3A6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICB0ZXN0KHJlc3VsdCkKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIF9fY2FsbF9fKHNlbGYsICphcmdzLCAqKmt3ZHMpOgogICAgICAgIHJldHVybiBzZWxmLnJ1bigqYXJncywgKiprd2RzKQoKICAgIGRlZiBkZWJ1ZyhzZWxmKToKICAgICAgICAiIiJSdW4gdGhlIHRlc3RzIHdpdGhvdXQgY29sbGVjdGluZyBlcnJvcnMgaW4gYSBUZXN0UmVzdWx0IiIiCiAgICAgICAgZm9yIHRlc3QgaW4gc2VsZjoKICAgICAgICAgICAgdGVzdC5kZWJ1ZygpCgoKY2xhc3MgVGVzdFN1aXRlKEJhc2VUZXN0U3VpdGUpOgogICAgIiIiQSB0ZXN0IHN1aXRlIGlzIGEgY29tcG9zaXRlIHRlc3QgY29uc2lzdGluZyBvZiBhIG51bWJlciBvZiBUZXN0Q2FzZXMuCgogICAgRm9yIHVzZSwgY3JlYXRlIGFuIGluc3RhbmNlIG9mIFRlc3RTdWl0ZSwgdGhlbiBhZGQgdGVzdCBjYXNlIGluc3RhbmNlcy4KICAgIFdoZW4gYWxsIHRlc3RzIGhhdmUgYmVlbiBhZGRlZCwgdGhlIHN1aXRlIGNhbiBiZSBwYXNzZWQgdG8gYSB0ZXN0CiAgICBydW5uZXIsIHN1Y2ggYXMgVGV4dFRlc3RSdW5uZXIuIEl0IHdpbGwgcnVuIHRoZSBpbmRpdmlkdWFsIHRlc3QgY2FzZXMKICAgIGluIHRoZSBvcmRlciBpbiB3aGljaCB0aGV5IHdlcmUgYWRkZWQsIGFnZ3JlZ2F0aW5nIHRoZSByZXN1bHRzLiBXaGVuCiAgICBzdWJjbGFzc2luZywgZG8gbm90IGZvcmdldCB0byBjYWxsIHRoZSBiYXNlIGNsYXNzIGNvbnN0cnVjdG9yLgogICAgIiIiCgogICAgZGVmIHJ1bihzZWxmLCByZXN1bHQsIGRlYnVnPUZhbHNlKToKICAgICAgICB0b3BMZXZlbCA9IEZhbHNlCiAgICAgICAgaWYgZ2V0YXR0cihyZXN1bHQsICdfdGVzdFJ1bkVudGVyZWQnLCBGYWxzZSkgaXMgRmFsc2U6CiAgICAgICAgICAgIHJlc3VsdC5fdGVzdFJ1bkVudGVyZWQgPSB0b3BMZXZlbCA9IFRydWUKCiAgICAgICAgZm9yIHRlc3QgaW4gc2VsZjoKICAgICAgICAgICAgaWYgcmVzdWx0LnNob3VsZFN0b3A6CiAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICAgICAgaWYgX2lzbm90c3VpdGUodGVzdCk6CiAgICAgICAgICAgICAgICBzZWxmLl90ZWFyRG93blByZXZpb3VzQ2xhc3ModGVzdCwgcmVzdWx0KQogICAgICAgICAgICAgICAgc2VsZi5faGFuZGxlTW9kdWxlRml4dHVyZSh0ZXN0LCByZXN1bHQpCiAgICAgICAgICAgICAgICBzZWxmLl9oYW5kbGVDbGFzc1NldFVwKHRlc3QsIHJlc3VsdCkKICAgICAgICAgICAgICAgIHJlc3VsdC5fcHJldmlvdXNUZXN0Q2xhc3MgPSB0ZXN0Ll9fY2xhc3NfXwoKICAgICAgICAgICAgICAgIGlmIChnZXRhdHRyKHRlc3QuX19jbGFzc19fLCAnX2NsYXNzU2V0dXBGYWlsZWQnLCBGYWxzZSkgb3IKICAgICAgICAgICAgICAgICAgICBnZXRhdHRyKHJlc3VsdCwgJ19tb2R1bGVTZXRVcEZhaWxlZCcsIEZhbHNlKSk6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIGlmIG5vdCBkZWJ1ZzoKICAgICAgICAgICAgICAgIHRlc3QocmVzdWx0KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdGVzdC5kZWJ1ZygpCgogICAgICAgIGlmIHRvcExldmVsOgogICAgICAgICAgICBzZWxmLl90ZWFyRG93blByZXZpb3VzQ2xhc3MoTm9uZSwgcmVzdWx0KQogICAgICAgICAgICBzZWxmLl9oYW5kbGVNb2R1bGVUZWFyRG93bihyZXN1bHQpCiAgICAgICAgICAgIHJlc3VsdC5fdGVzdFJ1bkVudGVyZWQgPSBGYWxzZQogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgZGVidWcoc2VsZik6CiAgICAgICAgIiIiUnVuIHRoZSB0ZXN0cyB3aXRob3V0IGNvbGxlY3RpbmcgZXJyb3JzIGluIGEgVGVzdFJlc3VsdCIiIgogICAgICAgIGRlYnVnID0gX0RlYnVnUmVzdWx0KCkKICAgICAgICBzZWxmLnJ1bihkZWJ1ZywgVHJ1ZSkKCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgIGRlZiBfaGFuZGxlQ2xhc3NTZXRVcChzZWxmLCB0ZXN0LCByZXN1bHQpOgogICAgICAgIHByZXZpb3VzQ2xhc3MgPSBnZXRhdHRyKHJlc3VsdCwgJ19wcmV2aW91c1Rlc3RDbGFzcycsIE5vbmUpCiAgICAgICAgY3VycmVudENsYXNzID0gdGVzdC5fX2NsYXNzX18KICAgICAgICBpZiBjdXJyZW50Q2xhc3MgPT0gcHJldmlvdXNDbGFzczoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgcmVzdWx0Ll9tb2R1bGVTZXRVcEZhaWxlZDoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgZ2V0YXR0cihjdXJyZW50Q2xhc3MsICJfX3VuaXR0ZXN0X3NraXBfXyIsIEZhbHNlKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRyeToKICAgICAgICAgICAgY3VycmVudENsYXNzLl9jbGFzc1NldHVwRmFpbGVkID0gRmFsc2UKICAgICAgICBleGNlcHQgVHlwZUVycm9yOgogICAgICAgICAgICAjIHRlc3QgbWF5IGFjdHVhbGx5IGJlIGEgZnVuY3Rpb24KICAgICAgICAgICAgIyBzbyBpdHMgY2xhc3Mgd2lsbCBiZSBhIGJ1aWx0aW4tdHlwZQogICAgICAgICAgICBwYXNzCgogICAgICAgIHNldFVwQ2xhc3MgPSBnZXRhdHRyKGN1cnJlbnRDbGFzcywgJ3NldFVwQ2xhc3MnLCBOb25lKQogICAgICAgIGlmIHNldFVwQ2xhc3MgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIF9jYWxsX2lmX2V4aXN0cyhyZXN1bHQsICdfc2V0dXBTdGRvdXQnKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZXRVcENsYXNzKCkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShyZXN1bHQsIF9EZWJ1Z1Jlc3VsdCk6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgICAgIGN1cnJlbnRDbGFzcy5fY2xhc3NTZXR1cEZhaWxlZCA9IFRydWUKICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9IHV0aWwuc3RyY2xhc3MoY3VycmVudENsYXNzKQogICAgICAgICAgICAgICAgZXJyb3JOYW1lID0gJ3NldFVwQ2xhc3MgKCVzKScgJSBjbGFzc05hbWUKICAgICAgICAgICAgICAgIHNlbGYuX2FkZENsYXNzT3JNb2R1bGVMZXZlbEV4Y2VwdGlvbihyZXN1bHQsIGUsIGVycm9yTmFtZSkKICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgIF9jYWxsX2lmX2V4aXN0cyhyZXN1bHQsICdfcmVzdG9yZVN0ZG91dCcpCgogICAgZGVmIF9nZXRfcHJldmlvdXNfbW9kdWxlKHNlbGYsIHJlc3VsdCk6CiAgICAgICAgcHJldmlvdXNNb2R1bGUgPSBOb25lCiAgICAgICAgcHJldmlvdXNDbGFzcyA9IGdldGF0dHIocmVzdWx0LCAnX3ByZXZpb3VzVGVzdENsYXNzJywgTm9uZSkKICAgICAgICBpZiBwcmV2aW91c0NsYXNzIGlzIG5vdCBOb25lOgogICAgICAgICAgICBwcmV2aW91c01vZHVsZSA9IHByZXZpb3VzQ2xhc3MuX19tb2R1bGVfXwogICAgICAgIHJldHVybiBwcmV2aW91c01vZHVsZQoKCiAgICBkZWYgX2hhbmRsZU1vZHVsZUZpeHR1cmUoc2VsZiwgdGVzdCwgcmVzdWx0KToKICAgICAgICBwcmV2aW91c01vZHVsZSA9IHNlbGYuX2dldF9wcmV2aW91c19tb2R1bGUocmVzdWx0KQogICAgICAgIGN1cnJlbnRNb2R1bGUgPSB0ZXN0Ll9fY2xhc3NfXy5fX21vZHVsZV9fCiAgICAgICAgaWYgY3VycmVudE1vZHVsZSA9PSBwcmV2aW91c01vZHVsZToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuX2hhbmRsZU1vZHVsZVRlYXJEb3duKHJlc3VsdCkKCgogICAgICAgIHJlc3VsdC5fbW9kdWxlU2V0VXBGYWlsZWQgPSBGYWxzZQogICAgICAgIHRyeToKICAgICAgICAgICAgbW9kdWxlID0gc3lzLm1vZHVsZXNbY3VycmVudE1vZHVsZV0KICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIHNldFVwTW9kdWxlID0gZ2V0YXR0cihtb2R1bGUsICdzZXRVcE1vZHVsZScsIE5vbmUpCiAgICAgICAgaWYgc2V0VXBNb2R1bGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIF9jYWxsX2lmX2V4aXN0cyhyZXN1bHQsICdfc2V0dXBTdGRvdXQnKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZXRVcE1vZHVsZSgpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UocmVzdWx0LCBfRGVidWdSZXN1bHQpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICAgICByZXN1bHQuX21vZHVsZVNldFVwRmFpbGVkID0gVHJ1ZQogICAgICAgICAgICAgICAgZXJyb3JOYW1lID0gJ3NldFVwTW9kdWxlICglcyknICUgY3VycmVudE1vZHVsZQogICAgICAgICAgICAgICAgc2VsZi5fYWRkQ2xhc3NPck1vZHVsZUxldmVsRXhjZXB0aW9uKHJlc3VsdCwgZSwgZXJyb3JOYW1lKQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgX2NhbGxfaWZfZXhpc3RzKHJlc3VsdCwgJ19yZXN0b3JlU3Rkb3V0JykKCiAgICBkZWYgX2FkZENsYXNzT3JNb2R1bGVMZXZlbEV4Y2VwdGlvbihzZWxmLCByZXN1bHQsIGV4Y2VwdGlvbiwgZXJyb3JOYW1lKToKICAgICAgICBlcnJvciA9IF9FcnJvckhvbGRlcihlcnJvck5hbWUpCiAgICAgICAgYWRkU2tpcCA9IGdldGF0dHIocmVzdWx0LCAnYWRkU2tpcCcsIE5vbmUpCiAgICAgICAgaWYgYWRkU2tpcCBpcyBub3QgTm9uZSBhbmQgaXNpbnN0YW5jZShleGNlcHRpb24sIGNhc2UuU2tpcFRlc3QpOgogICAgICAgICAgICBhZGRTa2lwKGVycm9yLCBzdHIoZXhjZXB0aW9uKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXN1bHQuYWRkRXJyb3IoZXJyb3IsIHN5cy5leGNfaW5mbygpKQoKICAgIGRlZiBfaGFuZGxlTW9kdWxlVGVhckRvd24oc2VsZiwgcmVzdWx0KToKICAgICAgICBwcmV2aW91c01vZHVsZSA9IHNlbGYuX2dldF9wcmV2aW91c19tb2R1bGUocmVzdWx0KQogICAgICAgIGlmIHByZXZpb3VzTW9kdWxlIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIGlmIHJlc3VsdC5fbW9kdWxlU2V0VXBGYWlsZWQ6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIG1vZHVsZSA9IHN5cy5tb2R1bGVzW3ByZXZpb3VzTW9kdWxlXQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRlYXJEb3duTW9kdWxlID0gZ2V0YXR0cihtb2R1bGUsICd0ZWFyRG93bk1vZHVsZScsIE5vbmUpCiAgICAgICAgaWYgdGVhckRvd25Nb2R1bGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIF9jYWxsX2lmX2V4aXN0cyhyZXN1bHQsICdfc2V0dXBTdGRvdXQnKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB0ZWFyRG93bk1vZHVsZSgpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UocmVzdWx0LCBfRGVidWdSZXN1bHQpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICAgICBlcnJvck5hbWUgPSAndGVhckRvd25Nb2R1bGUgKCVzKScgJSBwcmV2aW91c01vZHVsZQogICAgICAgICAgICAgICAgc2VsZi5fYWRkQ2xhc3NPck1vZHVsZUxldmVsRXhjZXB0aW9uKHJlc3VsdCwgZSwgZXJyb3JOYW1lKQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgX2NhbGxfaWZfZXhpc3RzKHJlc3VsdCwgJ19yZXN0b3JlU3Rkb3V0JykKCiAgICBkZWYgX3RlYXJEb3duUHJldmlvdXNDbGFzcyhzZWxmLCB0ZXN0LCByZXN1bHQpOgogICAgICAgIHByZXZpb3VzQ2xhc3MgPSBnZXRhdHRyKHJlc3VsdCwgJ19wcmV2aW91c1Rlc3RDbGFzcycsIE5vbmUpCiAgICAgICAgY3VycmVudENsYXNzID0gdGVzdC5fX2NsYXNzX18KICAgICAgICBpZiBjdXJyZW50Q2xhc3MgPT0gcHJldmlvdXNDbGFzczoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgZ2V0YXR0cihwcmV2aW91c0NsYXNzLCAnX2NsYXNzU2V0dXBGYWlsZWQnLCBGYWxzZSk6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIGlmIGdldGF0dHIocmVzdWx0LCAnX21vZHVsZVNldFVwRmFpbGVkJywgRmFsc2UpOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBpZiBnZXRhdHRyKHByZXZpb3VzQ2xhc3MsICJfX3VuaXR0ZXN0X3NraXBfXyIsIEZhbHNlKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRlYXJEb3duQ2xhc3MgPSBnZXRhdHRyKHByZXZpb3VzQ2xhc3MsICd0ZWFyRG93bkNsYXNzJywgTm9uZSkKICAgICAgICBpZiB0ZWFyRG93bkNsYXNzIGlzIG5vdCBOb25lOgogICAgICAgICAgICBfY2FsbF9pZl9leGlzdHMocmVzdWx0LCAnX3NldHVwU3Rkb3V0JykKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgdGVhckRvd25DbGFzcygpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UocmVzdWx0LCBfRGVidWdSZXN1bHQpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICAgICBjbGFzc05hbWUgPSB1dGlsLnN0cmNsYXNzKHByZXZpb3VzQ2xhc3MpCiAgICAgICAgICAgICAgICBlcnJvck5hbWUgPSAndGVhckRvd25DbGFzcyAoJXMpJyAlIGNsYXNzTmFtZQogICAgICAgICAgICAgICAgc2VsZi5fYWRkQ2xhc3NPck1vZHVsZUxldmVsRXhjZXB0aW9uKHJlc3VsdCwgZSwgZXJyb3JOYW1lKQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgX2NhbGxfaWZfZXhpc3RzKHJlc3VsdCwgJ19yZXN0b3JlU3Rkb3V0JykKCgpjbGFzcyBfRXJyb3JIb2xkZXIob2JqZWN0KToKICAgICIiIgogICAgUGxhY2Vob2xkZXIgZm9yIGEgVGVzdENhc2UgaW5zaWRlIGEgcmVzdWx0LiBBcyBmYXIgYXMgYSBUZXN0UmVzdWx0CiAgICBpcyBjb25jZXJuZWQsIHRoaXMgbG9va3MgZXhhY3RseSBsaWtlIGEgdW5pdCB0ZXN0LiBVc2VkIHRvIGluc2VydAogICAgYXJiaXRyYXJ5IGVycm9ycyBpbnRvIGEgdGVzdCBzdWl0ZSBydW4uCiAgICAiIiIKICAgICMgSW5zcGlyZWQgYnkgdGhlIEVycm9ySG9sZGVyIGZyb20gVHdpc3RlZDoKICAgICMgaHR0cDovL3R3aXN0ZWRtYXRyaXguY29tL3RyYWMvYnJvd3Nlci90cnVuay90d2lzdGVkL3RyaWFsL3J1bm5lci5weQoKICAgICMgYXR0cmlidXRlIHVzZWQgYnkgVGVzdFJlc3VsdC5fZXhjX2luZm9fdG9fc3RyaW5nCiAgICBmYWlsdXJlRXhjZXB0aW9uID0gTm9uZQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBkZXNjcmlwdGlvbik6CiAgICAgICAgc2VsZi5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uCgogICAgZGVmIGlkKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmRlc2NyaXB0aW9uCgogICAgZGVmIHNob3J0RGVzY3JpcHRpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICI8RXJyb3JIb2xkZXIgZGVzY3JpcHRpb249JXI+IiAlIChzZWxmLmRlc2NyaXB0aW9uLCkKCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5pZCgpCgogICAgZGVmIHJ1bihzZWxmLCByZXN1bHQpOgogICAgICAgICMgY291bGQgY2FsbCByZXN1bHQuYWRkRXJyb3IoLi4uKSAtIGJ1dCB0aGlzIHRlc3QtbGlrZSBvYmplY3QKICAgICAgICAjIHNob3VsZG4ndCBiZSBydW4gYW55d2F5CiAgICAgICAgcGFzcwoKICAgIGRlZiBfX2NhbGxfXyhzZWxmLCByZXN1bHQpOgogICAgICAgIHJldHVybiBzZWxmLnJ1bihyZXN1bHQpCgogICAgZGVmIGNvdW50VGVzdENhc2VzKHNlbGYpOgogICAgICAgIHJldHVybiAwCgpkZWYgX2lzbm90c3VpdGUodGVzdCk6CiAgICAiQSBjcnVkZSB3YXkgdG8gdGVsbCBhcGFydCB0ZXN0Y2FzZXMgYW5kIHN1aXRlcyB3aXRoIGR1Y2stdHlwaW5nIgogICAgdHJ5OgogICAgICAgIGl0ZXIodGVzdCkKICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgcmV0dXJuIFRydWUKICAgIHJldHVybiBGYWxzZQoKCmNsYXNzIF9EZWJ1Z1Jlc3VsdChvYmplY3QpOgogICAgIlVzZWQgYnkgdGhlIFRlc3RTdWl0ZSB0byBob2xkIHByZXZpb3VzIGNsYXNzIHdoZW4gcnVubmluZyBpbiBkZWJ1Zy4iCiAgICBfcHJldmlvdXNUZXN0Q2xhc3MgPSBOb25lCiAgICBfbW9kdWxlU2V0VXBGYWlsZWQgPSBGYWxzZQogICAgc2hvdWxkU3RvcCA9IEZhbHNlCg==',
'/Lib/unittest/util.py':'IiIiVmFyaW91cyB1dGlsaXR5IGZ1bmN0aW9ucy4iIiIKCmZyb20gY29sbGVjdGlvbnMgaW1wb3J0IG5hbWVkdHVwbGUsIE9yZGVyZWREaWN0CgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKX01BWF9MRU5HVEggPSA4MApkZWYgc2FmZV9yZXByKG9iaiwgc2hvcnQ9RmFsc2UpOgogICAgdHJ5OgogICAgICAgIHJlc3VsdCA9IHJlcHIob2JqKQogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICByZXN1bHQgPSBvYmplY3QuX19yZXByX18ob2JqKQogICAgaWYgbm90IHNob3J0IG9yIGxlbihyZXN1bHQpIDwgX01BWF9MRU5HVEg6CiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgcmV0dXJuIHJlc3VsdFs6X01BWF9MRU5HVEhdICsgJyBbdHJ1bmNhdGVkXS4uLicKCmRlZiBzdHJjbGFzcyhjbHMpOgogICAgcmV0dXJuICIlcy4lcyIgJSAoY2xzLl9fbW9kdWxlX18sIGNscy5fX25hbWVfXykKCmRlZiBzb3J0ZWRfbGlzdF9kaWZmZXJlbmNlKGV4cGVjdGVkLCBhY3R1YWwpOgogICAgIiIiRmluZHMgZWxlbWVudHMgaW4gb25seSBvbmUgb3IgdGhlIG90aGVyIG9mIHR3bywgc29ydGVkIGlucHV0IGxpc3RzLgoKICAgIFJldHVybnMgYSB0d28tZWxlbWVudCB0dXBsZSBvZiBsaXN0cy4gICAgVGhlIGZpcnN0IGxpc3QgY29udGFpbnMgdGhvc2UKICAgIGVsZW1lbnRzIGluIHRoZSAiZXhwZWN0ZWQiIGxpc3QgYnV0IG5vdCBpbiB0aGUgImFjdHVhbCIgbGlzdCwgYW5kIHRoZQogICAgc2Vjb25kIGNvbnRhaW5zIHRob3NlIGVsZW1lbnRzIGluIHRoZSAiYWN0dWFsIiBsaXN0IGJ1dCBub3QgaW4gdGhlCiAgICAiZXhwZWN0ZWQiIGxpc3QuICAgIER1cGxpY2F0ZSBlbGVtZW50cyBpbiBlaXRoZXIgaW5wdXQgbGlzdCBhcmUgaWdub3JlZC4KICAgICIiIgogICAgaSA9IGogPSAwCiAgICBtaXNzaW5nID0gW10KICAgIHVuZXhwZWN0ZWQgPSBbXQogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGUgPSBleHBlY3RlZFtpXQogICAgICAgICAgICBhID0gYWN0dWFsW2pdCiAgICAgICAgICAgIGlmIGUgPCBhOgogICAgICAgICAgICAgICAgbWlzc2luZy5hcHBlbmQoZSkKICAgICAgICAgICAgICAgIGkgKz0gMQogICAgICAgICAgICAgICAgd2hpbGUgZXhwZWN0ZWRbaV0gPT0gZToKICAgICAgICAgICAgICAgICAgICBpICs9IDEKICAgICAgICAgICAgZWxpZiBlID4gYToKICAgICAgICAgICAgICAgIHVuZXhwZWN0ZWQuYXBwZW5kKGEpCiAgICAgICAgICAgICAgICBqICs9IDEKICAgICAgICAgICAgICAgIHdoaWxlIGFjdHVhbFtqXSA9PSBhOgogICAgICAgICAgICAgICAgICAgIGogKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaSArPSAxCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgZXhwZWN0ZWRbaV0gPT0gZToKICAgICAgICAgICAgICAgICAgICAgICAgaSArPSAxCiAgICAgICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgICAgIGogKz0gMQogICAgICAgICAgICAgICAgICAgIHdoaWxlIGFjdHVhbFtqXSA9PSBhOgogICAgICAgICAgICAgICAgICAgICAgICBqICs9IDEKICAgICAgICBleGNlcHQgSW5kZXhFcnJvcjoKICAgICAgICAgICAgbWlzc2luZy5leHRlbmQoZXhwZWN0ZWRbaTpdKQogICAgICAgICAgICB1bmV4cGVjdGVkLmV4dGVuZChhY3R1YWxbajpdKQogICAgICAgICAgICBicmVhawogICAgcmV0dXJuIG1pc3NpbmcsIHVuZXhwZWN0ZWQKCgpkZWYgdW5vcmRlcmFibGVfbGlzdF9kaWZmZXJlbmNlKGV4cGVjdGVkLCBhY3R1YWwpOgogICAgIiIiU2FtZSBiZWhhdmlvciBhcyBzb3J0ZWRfbGlzdF9kaWZmZXJlbmNlIGJ1dAogICAgZm9yIGxpc3RzIG9mIHVub3JkZXJhYmxlIGl0ZW1zIChsaWtlIGRpY3RzKS4KCiAgICBBcyBpdCBkb2VzIGEgbGluZWFyIHNlYXJjaCBwZXIgaXRlbSAocmVtb3ZlKSBpdAogICAgaGFzIE8obipuKSBwZXJmb3JtYW5jZS4iIiIKICAgIG1pc3NpbmcgPSBbXQogICAgd2hpbGUgZXhwZWN0ZWQ6CiAgICAgICAgaXRlbSA9IGV4cGVjdGVkLnBvcCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBhY3R1YWwucmVtb3ZlKGl0ZW0pCiAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgIG1pc3NpbmcuYXBwZW5kKGl0ZW0pCgogICAgIyBhbnl0aGluZyBsZWZ0IGluIGFjdHVhbCBpcyB1bmV4cGVjdGVkCiAgICByZXR1cm4gbWlzc2luZywgYWN0dWFsCgpkZWYgdGhyZWVfd2F5X2NtcCh4LCB5KToKICAgICIiIlJldHVybiAtMSBpZiB4IDwgeSwgMCBpZiB4ID09IHkgYW5kIDEgaWYgeCA+IHkiIiIKICAgIHJldHVybiAoeCA+IHkpIC0gKHggPCB5KQoKX01pc21hdGNoID0gbmFtZWR0dXBsZSgnTWlzbWF0Y2gnLCAnYWN0dWFsIGV4cGVjdGVkIHZhbHVlJykKCmRlZiBfY291bnRfZGlmZl9hbGxfcHVycG9zZShhY3R1YWwsIGV4cGVjdGVkKToKICAgICdSZXR1cm5zIGxpc3Qgb2YgKGNudF9hY3QsIGNudF9leHAsIGVsZW0pIHRyaXBsZXMgd2hlcmUgdGhlIGNvdW50cyBkaWZmZXInCiAgICAjIGVsZW1lbnRzIG5lZWQgbm90IGJlIGhhc2hhYmxlCiAgICBzLCB0ID0gbGlzdChhY3R1YWwpLCBsaXN0KGV4cGVjdGVkKQogICAgbSwgbiA9IGxlbihzKSwgbGVuKHQpCiAgICBOVUxMID0gb2JqZWN0KCkKICAgIHJlc3VsdCA9IFtdCiAgICBmb3IgaSwgZWxlbSBpbiBlbnVtZXJhdGUocyk6CiAgICAgICAgaWYgZWxlbSBpcyBOVUxMOgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGNudF9zID0gY250X3QgPSAwCiAgICAgICAgZm9yIGogaW4gcmFuZ2UoaSwgbSk6CiAgICAgICAgICAgIGlmIHNbal0gPT0gZWxlbToKICAgICAgICAgICAgICAgIGNudF9zICs9IDEKICAgICAgICAgICAgICAgIHNbal0gPSBOVUxMCiAgICAgICAgZm9yIGosIG90aGVyX2VsZW0gaW4gZW51bWVyYXRlKHQpOgogICAgICAgICAgICBpZiBvdGhlcl9lbGVtID09IGVsZW06CiAgICAgICAgICAgICAgICBjbnRfdCArPSAxCiAgICAgICAgICAgICAgICB0W2pdID0gTlVMTAogICAgICAgIGlmIGNudF9zICE9IGNudF90OgogICAgICAgICAgICBkaWZmID0gX01pc21hdGNoKGNudF9zLCBjbnRfdCwgZWxlbSkKICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChkaWZmKQoKICAgIGZvciBpLCBlbGVtIGluIGVudW1lcmF0ZSh0KToKICAgICAgICBpZiBlbGVtIGlzIE5VTEw6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgY250X3QgPSAwCiAgICAgICAgZm9yIGogaW4gcmFuZ2UoaSwgbik6CiAgICAgICAgICAgIGlmIHRbal0gPT0gZWxlbToKICAgICAgICAgICAgICAgIGNudF90ICs9IDEKICAgICAgICAgICAgICAgIHRbal0gPSBOVUxMCiAgICAgICAgZGlmZiA9IF9NaXNtYXRjaCgwLCBjbnRfdCwgZWxlbSkKICAgICAgICByZXN1bHQuYXBwZW5kKGRpZmYpCiAgICByZXR1cm4gcmVzdWx0CgpkZWYgX29yZGVyZWRfY291bnQoaXRlcmFibGUpOgogICAgJ1JldHVybiBkaWN0IG9mIGVsZW1lbnQgY291bnRzLCBpbiB0aGUgb3JkZXIgdGhleSB3ZXJlIGZpcnN0IHNlZW4nCiAgICBjID0gT3JkZXJlZERpY3QoKQogICAgZm9yIGVsZW0gaW4gaXRlcmFibGU6CiAgICAgICAgY1tlbGVtXSA9IGMuZ2V0KGVsZW0sIDApICsgMQogICAgcmV0dXJuIGMKCmRlZiBfY291bnRfZGlmZl9oYXNoYWJsZShhY3R1YWwsIGV4cGVjdGVkKToKICAgICdSZXR1cm5zIGxpc3Qgb2YgKGNudF9hY3QsIGNudF9leHAsIGVsZW0pIHRyaXBsZXMgd2hlcmUgdGhlIGNvdW50cyBkaWZmZXInCiAgICAjIGVsZW1lbnRzIG11c3QgYmUgaGFzaGFibGUKICAgIHMsIHQgPSBfb3JkZXJlZF9jb3VudChhY3R1YWwpLCBfb3JkZXJlZF9jb3VudChleHBlY3RlZCkKICAgIHJlc3VsdCA9IFtdCiAgICBmb3IgZWxlbSwgY250X3MgaW4gcy5pdGVtcygpOgogICAgICAgIGNudF90ID0gdC5nZXQoZWxlbSwgMCkKICAgICAgICBpZiBjbnRfcyAhPSBjbnRfdDoKICAgICAgICAgICAgZGlmZiA9IF9NaXNtYXRjaChjbnRfcywgY250X3QsIGVsZW0pCiAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoZGlmZikKICAgIGZvciBlbGVtLCBjbnRfdCBpbiB0Lml0ZW1zKCk6CiAgICAgICAgaWYgZWxlbSBub3QgaW4gczoKICAgICAgICAgICAgZGlmZiA9IF9NaXNtYXRjaCgwLCBjbnRfdCwgZWxlbSkKICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChkaWZmKQogICAgcmV0dXJuIHJlc3VsdAo=',
'/Lib/unittest/__init__.py':'IiIiClB5dGhvbiB1bml0IHRlc3RpbmcgZnJhbWV3b3JrLCBiYXNlZCBvbiBFcmljaCBHYW1tYSdzIEpVbml0IGFuZCBLZW50IEJlY2sncwpTbWFsbHRhbGsgdGVzdGluZyBmcmFtZXdvcmsuCgpUaGlzIG1vZHVsZSBjb250YWlucyB0aGUgY29yZSBmcmFtZXdvcmsgY2xhc3NlcyB0aGF0IGZvcm0gdGhlIGJhc2lzIG9mCnNwZWNpZmljIHRlc3QgY2FzZXMgYW5kIHN1aXRlcyAoVGVzdENhc2UsIFRlc3RTdWl0ZSBldGMuKSwgYW5kIGFsc28gYQp0ZXh0LWJhc2VkIHV0aWxpdHkgY2xhc3MgZm9yIHJ1bm5pbmcgdGhlIHRlc3RzIGFuZCByZXBvcnRpbmcgdGhlIHJlc3VsdHMKIChUZXh0VGVzdFJ1bm5lcikuCgpTaW1wbGUgdXNhZ2U6CgogICAgaW1wb3J0IHVuaXR0ZXN0CgogICAgY2xhc3MgSW50ZWdlckFyaXRobWVudGljVGVzdENhc2UodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgIGRlZiB0ZXN0QWRkKHNlbGYpOiAgIyMgdGVzdCBtZXRob2QgbmFtZXMgYmVnaW4gJ3Rlc3QqJwogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKCgxICsgMiksIDMpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoMCArIDEsIDEpCiAgICAgICAgZGVmIHRlc3RNdWx0aXBseShzZWxmKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgoMCAqIDEwKSwgMCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgoNSAqIDgpLCA0MCkKCiAgICBpZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgICAgIHVuaXR0ZXN0Lm1haW4oKQoKRnVydGhlciBpbmZvcm1hdGlvbiBpcyBhdmFpbGFibGUgaW4gdGhlIGJ1bmRsZWQgZG9jdW1lbnRhdGlvbiwgYW5kIGZyb20KCiAgaHR0cDovL2RvY3MucHl0aG9uLm9yZy9saWJyYXJ5L3VuaXR0ZXN0Lmh0bWwKCkNvcHlyaWdodCAoYykgMTk5OS0yMDAzIFN0ZXZlIFB1cmNlbGwKQ29weXJpZ2h0IChjKSAyMDAzLTIwMTAgUHl0aG9uIFNvZnR3YXJlIEZvdW5kYXRpb24KVGhpcyBtb2R1bGUgaXMgZnJlZSBzb2Z0d2FyZSwgYW5kIHlvdSBtYXkgcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKaXQgdW5kZXIgdGhlIHNhbWUgdGVybXMgYXMgUHl0aG9uIGl0c2VsZiwgc28gbG9uZyBhcyB0aGlzIGNvcHlyaWdodCBtZXNzYWdlCmFuZCBkaXNjbGFpbWVyIGFyZSByZXRhaW5lZCBpbiB0aGVpciBvcmlnaW5hbCBmb3JtLgoKSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgVE8gQU5ZIFBBUlRZIEZPUiBESVJFQ1QsIElORElSRUNULApTUEVDSUFMLCBJTkNJREVOVEFMLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgQVJJU0lORyBPVVQgT0YgVEhFIFVTRSBPRgpUSElTIENPREUsIEVWRU4gSUYgVEhFIEFVVEhPUiBIQVMgQkVFTiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNICkRBTUFHRS4KClRIRSBBVVRIT1IgU1BFQ0lGSUNBTExZIERJU0NMQUlNUyBBTlkgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UCkxJTUlURUQgVE8sIFRIRSBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBClBBUlRJQ1VMQVIgUFVSUE9TRS4gIFRIRSBDT0RFIFBST1ZJREVEIEhFUkVVTkRFUiBJUyBPTiBBTiAiQVMgSVMiIEJBU0lTLApBTkQgVEhFUkUgSVMgTk8gT0JMSUdBVElPTiBXSEFUU09FVkVSIFRPIFBST1ZJREUgTUFJTlRFTkFOQ0UsClNVUFBPUlQsIFVQREFURVMsIEVOSEFOQ0VNRU5UUywgT1IgTU9ESUZJQ0FUSU9OUy4KIiIiCgpfX2FsbF9fID0gWydUZXN0UmVzdWx0JywgJ1Rlc3RDYXNlJywgJ1Rlc3RTdWl0ZScsCiAgICAgICAgICAgJ1RleHRUZXN0UnVubmVyJywgJ1Rlc3RMb2FkZXInLCAnRnVuY3Rpb25UZXN0Q2FzZScsICdtYWluJywKICAgICAgICAgICAnZGVmYXVsdFRlc3RMb2FkZXInLCAnU2tpcFRlc3QnLCAnc2tpcCcsICdza2lwSWYnLCAnc2tpcFVubGVzcycsCiAgICAgICAgICAgJ2V4cGVjdGVkRmFpbHVyZScsICdUZXh0VGVzdFJlc3VsdCcsICdpbnN0YWxsSGFuZGxlcicsCiAgICAgICAgICAgJ3JlZ2lzdGVyUmVzdWx0JywgJ3JlbW92ZVJlc3VsdCcsICdyZW1vdmVIYW5kbGVyJ10KCiMgRXhwb3NlIG9ic29sZXRlIGZ1bmN0aW9ucyBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkKX19hbGxfXy5leHRlbmQoWydnZXRUZXN0Q2FzZU5hbWVzJywgJ21ha2VTdWl0ZScsICdmaW5kVGVzdENhc2VzJ10pCgpfX3VuaXR0ZXN0ID0gVHJ1ZQoKZnJvbSAucmVzdWx0IGltcG9ydCBUZXN0UmVzdWx0CmZyb20gLmNhc2UgaW1wb3J0IChUZXN0Q2FzZSwgRnVuY3Rpb25UZXN0Q2FzZSwgU2tpcFRlc3QsIHNraXAsIHNraXBJZiwKICAgICAgICAgICAgICAgICAgIHNraXBVbmxlc3MsIGV4cGVjdGVkRmFpbHVyZSkKZnJvbSAuc3VpdGUgaW1wb3J0IEJhc2VUZXN0U3VpdGUsIFRlc3RTdWl0ZQpmcm9tIC5sb2FkZXIgaW1wb3J0IChUZXN0TG9hZGVyLCBkZWZhdWx0VGVzdExvYWRlciwgbWFrZVN1aXRlLCBnZXRUZXN0Q2FzZU5hbWVzLAogICAgICAgICAgICAgICAgICAgICBmaW5kVGVzdENhc2VzKQpmcm9tIC5tYWluIGltcG9ydCBUZXN0UHJvZ3JhbSwgbWFpbgpmcm9tIC5ydW5uZXIgaW1wb3J0IFRleHRUZXN0UnVubmVyLCBUZXh0VGVzdFJlc3VsdApmcm9tIC5zaWduYWxzIGltcG9ydCBpbnN0YWxsSGFuZGxlciwgcmVnaXN0ZXJSZXN1bHQsIHJlbW92ZVJlc3VsdCwgcmVtb3ZlSGFuZGxlcgoKIyBkZXByZWNhdGVkCl9UZXh0VGVzdFJlc3VsdCA9IFRleHRUZXN0UmVzdWx0Cg==',
'/Lib/unittest/__main__.py':'IiIiTWFpbiBlbnRyeSBwb2ludCIiIgoKaW1wb3J0IHN5cwppZiBzeXMuYXJndlswXS5lbmRzd2l0aCgiX19tYWluX18ucHkiKToKICAgIHN5cy5hcmd2WzBdID0gInB5dGhvbiAtbSB1bml0dGVzdCIKCl9fdW5pdHRlc3QgPSBUcnVlCgpmcm9tIC5tYWluIGltcG9ydCBtYWluLCBUZXN0UHJvZ3JhbSwgVVNBR0VfQVNfTUFJTgpUZXN0UHJvZ3JhbS5VU0FHRSA9IFVTQUdFX0FTX01BSU4KCm1haW4obW9kdWxlPU5vbmUpCg==',
'/Lib/unittest/test/dummy.py':'IyBFbXB0eSBtb2R1bGUgZm9yIHRlc3RpbmcgdGhlIGxvYWRpbmcgb2YgbW9kdWxlcwo=',
'/Lib/unittest/test/support.py':'aW1wb3J0IHVuaXR0ZXN0CgoKY2xhc3MgVGVzdEVxdWFsaXR5KG9iamVjdCk6CiAgICAiIiJVc2VkIGFzIGEgbWl4aW4gZm9yIFRlc3RDYXNlIiIiCgogICAgIyBDaGVjayBmb3IgYSB2YWxpZCBfX2VxX18gaW1wbGVtZW50YXRpb24KICAgIGRlZiB0ZXN0X2VxKHNlbGYpOgogICAgICAgIGZvciBvYmpfMSwgb2JqXzIgaW4gc2VsZi5lcV9wYWlyczoKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChvYmpfMSwgb2JqXzIpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwob2JqXzIsIG9ial8xKQoKICAgICMgQ2hlY2sgZm9yIGEgdmFsaWQgX19uZV9fIGltcGxlbWVudGF0aW9uCiAgICBkZWYgdGVzdF9uZShzZWxmKToKICAgICAgICBmb3Igb2JqXzEsIG9ial8yIGluIHNlbGYubmVfcGFpcnM6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwob2JqXzEsIG9ial8yKQogICAgICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKG9ial8yLCBvYmpfMSkKCmNsYXNzIFRlc3RIYXNoaW5nKG9iamVjdCk6CiAgICAiIiJVc2VkIGFzIGEgbWl4aW4gZm9yIFRlc3RDYXNlIiIiCgogICAgIyBDaGVjayBmb3IgYSB2YWxpZCBfX2hhc2hfXyBpbXBsZW1lbnRhdGlvbgogICAgZGVmIHRlc3RfaGFzaChzZWxmKToKICAgICAgICBmb3Igb2JqXzEsIG9ial8yIGluIHNlbGYuZXFfcGFpcnM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIG5vdCBoYXNoKG9ial8xKSA9PSBoYXNoKG9ial8yKToKICAgICAgICAgICAgICAgICAgICBzZWxmLmZhaWwoIiVyIGFuZCAlciBkbyBub3QgaGFzaCBlcXVhbCIgJSAob2JqXzEsIG9ial8yKSkKICAgICAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgc2VsZi5mYWlsKCJQcm9ibGVtIGhhc2hpbmcgJXIgYW5kICVyOiAlcyIgJSAob2JqXzEsIG9ial8yLCBlKSkKCiAgICAgICAgZm9yIG9ial8xLCBvYmpfMiBpbiBzZWxmLm5lX3BhaXJzOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpZiBoYXNoKG9ial8xKSA9PSBoYXNoKG9ial8yKToKICAgICAgICAgICAgICAgICAgICBzZWxmLmZhaWwoIiVzIGFuZCAlcyBoYXNoIGVxdWFsLCBidXQgc2hvdWxkbid0IiAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChvYmpfMSwgb2JqXzIpKQogICAgICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBzZWxmLmZhaWwoIlByb2JsZW0gaGFzaGluZyAlcyBhbmQgJXM6ICVzIiAlIChvYmpfMSwgb2JqXzIsIGUpKQoKCmNsYXNzIExvZ2dpbmdSZXN1bHQodW5pdHRlc3QuVGVzdFJlc3VsdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgbG9nKToKICAgICAgICBzZWxmLl9ldmVudHMgPSBsb2cKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKCiAgICBkZWYgc3RhcnRUZXN0KHNlbGYsIHRlc3QpOgogICAgICAgIHNlbGYuX2V2ZW50cy5hcHBlbmQoJ3N0YXJ0VGVzdCcpCiAgICAgICAgc3VwZXIoKS5zdGFydFRlc3QodGVzdCkKCiAgICBkZWYgc3RhcnRUZXN0UnVuKHNlbGYpOgogICAgICAgIHNlbGYuX2V2ZW50cy5hcHBlbmQoJ3N0YXJ0VGVzdFJ1bicpCiAgICAgICAgc3VwZXIoTG9nZ2luZ1Jlc3VsdCwgc2VsZikuc3RhcnRUZXN0UnVuKCkKCiAgICBkZWYgc3RvcFRlc3Qoc2VsZiwgdGVzdCk6CiAgICAgICAgc2VsZi5fZXZlbnRzLmFwcGVuZCgnc3RvcFRlc3QnKQogICAgICAgIHN1cGVyKCkuc3RvcFRlc3QodGVzdCkKCiAgICBkZWYgc3RvcFRlc3RSdW4oc2VsZik6CiAgICAgICAgc2VsZi5fZXZlbnRzLmFwcGVuZCgnc3RvcFRlc3RSdW4nKQogICAgICAgIHN1cGVyKExvZ2dpbmdSZXN1bHQsIHNlbGYpLnN0b3BUZXN0UnVuKCkKCiAgICBkZWYgYWRkRmFpbHVyZShzZWxmLCAqYXJncyk6CiAgICAgICAgc2VsZi5fZXZlbnRzLmFwcGVuZCgnYWRkRmFpbHVyZScpCiAgICAgICAgc3VwZXIoKS5hZGRGYWlsdXJlKCphcmdzKQoKICAgIGRlZiBhZGRTdWNjZXNzKHNlbGYsICphcmdzKToKICAgICAgICBzZWxmLl9ldmVudHMuYXBwZW5kKCdhZGRTdWNjZXNzJykKICAgICAgICBzdXBlcihMb2dnaW5nUmVzdWx0LCBzZWxmKS5hZGRTdWNjZXNzKCphcmdzKQoKICAgIGRlZiBhZGRFcnJvcihzZWxmLCAqYXJncyk6CiAgICAgICAgc2VsZi5fZXZlbnRzLmFwcGVuZCgnYWRkRXJyb3InKQogICAgICAgIHN1cGVyKCkuYWRkRXJyb3IoKmFyZ3MpCgogICAgZGVmIGFkZFNraXAoc2VsZiwgKmFyZ3MpOgogICAgICAgIHNlbGYuX2V2ZW50cy5hcHBlbmQoJ2FkZFNraXAnKQogICAgICAgIHN1cGVyKExvZ2dpbmdSZXN1bHQsIHNlbGYpLmFkZFNraXAoKmFyZ3MpCgogICAgZGVmIGFkZEV4cGVjdGVkRmFpbHVyZShzZWxmLCAqYXJncyk6CiAgICAgICAgc2VsZi5fZXZlbnRzLmFwcGVuZCgnYWRkRXhwZWN0ZWRGYWlsdXJlJykKICAgICAgICBzdXBlcihMb2dnaW5nUmVzdWx0LCBzZWxmKS5hZGRFeHBlY3RlZEZhaWx1cmUoKmFyZ3MpCgogICAgZGVmIGFkZFVuZXhwZWN0ZWRTdWNjZXNzKHNlbGYsICphcmdzKToKICAgICAgICBzZWxmLl9ldmVudHMuYXBwZW5kKCdhZGRVbmV4cGVjdGVkU3VjY2VzcycpCiAgICAgICAgc3VwZXIoTG9nZ2luZ1Jlc3VsdCwgc2VsZikuYWRkVW5leHBlY3RlZFN1Y2Nlc3MoKmFyZ3MpCgoKY2xhc3MgUmVzdWx0V2l0aE5vU3RhcnRUZXN0UnVuU3RvcFRlc3RSdW4ob2JqZWN0KToKICAgICIiIkFuIG9iamVjdCBob25vdXJpbmcgVGVzdFJlc3VsdCBiZWZvcmUgc3RhcnRUZXN0UnVuL3N0b3BUZXN0UnVuLiIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLmZhaWx1cmVzID0gW10KICAgICAgICBzZWxmLmVycm9ycyA9IFtdCiAgICAgICAgc2VsZi50ZXN0c1J1biA9IDAKICAgICAgICBzZWxmLnNraXBwZWQgPSBbXQogICAgICAgIHNlbGYuZXhwZWN0ZWRGYWlsdXJlcyA9IFtdCiAgICAgICAgc2VsZi51bmV4cGVjdGVkU3VjY2Vzc2VzID0gW10KICAgICAgICBzZWxmLnNob3VsZFN0b3AgPSBGYWxzZQoKICAgIGRlZiBzdGFydFRlc3Qoc2VsZiwgdGVzdCk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzdG9wVGVzdChzZWxmLCB0ZXN0KToKICAgICAgICBwYXNzCgogICAgZGVmIGFkZEVycm9yKHNlbGYsIHRlc3QpOgogICAgICAgIHBhc3MKCiAgICBkZWYgYWRkRmFpbHVyZShzZWxmLCB0ZXN0KToKICAgICAgICBwYXNzCgogICAgZGVmIGFkZFN1Y2Nlc3Moc2VsZiwgdGVzdCk6CiAgICAgICAgcGFzcwoKICAgIGRlZiB3YXNTdWNjZXNzZnVsKHNlbGYpOgogICAgICAgIHJldHVybiBUcnVlCg==',
'/Lib/unittest/test/test_assertions.py':'aW1wb3J0IGRhdGV0aW1lCmltcG9ydCB3YXJuaW5ncwppbXBvcnQgdW5pdHRlc3QKZnJvbSBpdGVydG9vbHMgaW1wb3J0IHByb2R1Y3QKCgpjbGFzcyBUZXN0X0Fzc2VydGlvbnModW5pdHRlc3QuVGVzdENhc2UpOgogICAgZGVmIHRlc3RfQWxtb3N0RXF1YWwoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRBbG1vc3RFcXVhbCgxLjAwMDAwMDAxLCAxLjApCiAgICAgICAgc2VsZi5hc3NlcnROb3RBbG1vc3RFcXVhbCgxLjAwMDAwMDEsIDEuMCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRBbG1vc3RFcXVhbCwgMS4wMDAwMDAxLCAxLjApCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0Tm90QWxtb3N0RXF1YWwsIDEuMDAwMDAwMDEsIDEuMCkKCiAgICAgICAgc2VsZi5hc3NlcnRBbG1vc3RFcXVhbCgxLjEsIDEuMCwgcGxhY2VzPTApCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0QWxtb3N0RXF1YWwsIDEuMSwgMS4wLCBwbGFjZXM9MSkKCiAgICAgICAgc2VsZi5hc3NlcnRBbG1vc3RFcXVhbCgwLCAuMSsuMWosIHBsYWNlcz0wKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90QWxtb3N0RXF1YWwoMCwgLjErLjFqLCBwbGFjZXM9MSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRBbG1vc3RFcXVhbCwgMCwgLjErLjFqLCBwbGFjZXM9MSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hc3NlcnROb3RBbG1vc3RFcXVhbCwgMCwgLjErLjFqLCBwbGFjZXM9MCkKCiAgICAgICAgc2VsZi5hc3NlcnRBbG1vc3RFcXVhbChmbG9hdCgnaW5mJyksIGZsb2F0KCdpbmYnKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0Tm90QWxtb3N0RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgZmxvYXQoJ2luZicpLCBmbG9hdCgnaW5mJykpCgogICAgZGVmIHRlc3RfQW1vc3RFcXVhbFdpdGhEZWx0YShzZWxmKToKICAgICAgICBzZWxmLmFzc2VydEFsbW9zdEVxdWFsKDEuMSwgMS4wLCBkZWx0YT0wLjUpCiAgICAgICAgc2VsZi5hc3NlcnRBbG1vc3RFcXVhbCgxLjAsIDEuMSwgZGVsdGE9MC41KQogICAgICAgIHNlbGYuYXNzZXJ0Tm90QWxtb3N0RXF1YWwoMS4xLCAxLjAsIGRlbHRhPTAuMDUpCiAgICAgICAgc2VsZi5hc3NlcnROb3RBbG1vc3RFcXVhbCgxLjAsIDEuMSwgZGVsdGE9MC4wNSkKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydEFsbW9zdEVxdWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgIDEuMSwgMS4wLCBkZWx0YT0wLjA1KQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnROb3RBbG1vc3RFcXVhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAxLjEsIDEuMCwgZGVsdGE9MC41KQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIHNlbGYuYXNzZXJ0QWxtb3N0RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgMS4xLCAxLjAsIHBsYWNlcz0yLCBkZWx0YT0yKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgc2VsZi5hc3NlcnROb3RBbG1vc3RFcXVhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAxLjEsIDEuMCwgcGxhY2VzPTIsIGRlbHRhPTIpCgogICAgICAgIGZpcnN0ID0gZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkKICAgICAgICBzZWNvbmQgPSBmaXJzdCArIGRhdGV0aW1lLnRpbWVkZWx0YShzZWNvbmRzPTEwKQogICAgICAgIHNlbGYuYXNzZXJ0QWxtb3N0RXF1YWwoZmlyc3QsIHNlY29uZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhPWRhdGV0aW1lLnRpbWVkZWx0YShzZWNvbmRzPTIwKSkKICAgICAgICBzZWxmLmFzc2VydE5vdEFsbW9zdEVxdWFsKGZpcnN0LCBzZWNvbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWx0YT1kYXRldGltZS50aW1lZGVsdGEoc2Vjb25kcz01KSkKCiAgICBkZWYgdGVzdF9hc3NlcnRSYWlzZXMoc2VsZik6CiAgICAgICAgZGVmIF9yYWlzZShlKToKICAgICAgICAgICAgcmFpc2UgZQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEtleUVycm9yLCBfcmFpc2UsIEtleUVycm9yKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEtleUVycm9yLCBfcmFpc2UsIEtleUVycm9yKCJrZXkiKSkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEtleUVycm9yLCBsYW1iZGE6IE5vbmUpCiAgICAgICAgZXhjZXB0IHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLmFzc2VydEluKCJLZXlFcnJvciBub3QgcmFpc2VkIiwgc3RyKGUpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiYXNzZXJ0UmFpc2VzKCkgZGlkbid0IGZhaWwiKQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoS2V5RXJyb3IsIF9yYWlzZSwgVmFsdWVFcnJvcikKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiYXNzZXJ0UmFpc2VzKCkgZGlkbid0IGxldCBleGNlcHRpb24gcGFzcyB0aHJvdWdoIikKICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKEtleUVycm9yKSBhcyBjbToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3IKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgZXhjID0gZQogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBzZWxmLmFzc2VydElzKGNtLmV4Y2VwdGlvbiwgZXhjKQoKICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKEtleUVycm9yKToKICAgICAgICAgICAgcmFpc2UgS2V5RXJyb3IoImtleSIpCiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKEtleUVycm9yKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICBleGNlcHQgc2VsZi5mYWlsdXJlRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SW4oIktleUVycm9yIG5vdCByYWlzZWQiLCBzdHIoZSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCJhc3NlcnRSYWlzZXMoKSBkaWRuJ3QgZmFpbCIpCiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKEtleUVycm9yKToKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiYXNzZXJ0UmFpc2VzKCkgZGlkbid0IGxldCBleGNlcHRpb24gcGFzcyB0aHJvdWdoIikKCiAgICBkZWYgdGVzdEFzc2VydE5vdFJlZ2V4KHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0Tm90UmVnZXgoJ0FsYSBtYSBrb3RhJywgcidyKycpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmFzc2VydE5vdFJlZ2V4KCdBbGEgbWEga290YScsIHInay50JywgJ01lc3NhZ2UnKQogICAgICAgIGV4Y2VwdCBzZWxmLmZhaWx1cmVFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigiJ2tvdCciLCBlLmFyZ3NbMF0pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SW4oJ01lc3NhZ2UnLCBlLmFyZ3NbMF0pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCdhc3NlcnROb3RSZWdleCBzaG91bGQgaGF2ZSBmYWlsZWQuJykKCgpjbGFzcyBUZXN0TG9uZ01lc3NhZ2UodW5pdHRlc3QuVGVzdENhc2UpOgogICAgIiIiVGVzdCB0aGF0IHRoZSBpbmRpdmlkdWFsIGFzc2VydHMgaG9ub3VyIGxvbmdNZXNzYWdlLgogICAgVGhpcyBhY3R1YWxseSB0ZXN0cyBhbGwgdGhlIG1lc3NhZ2UgYmVoYXZpb3VyIGZvcgogICAgYXNzZXJ0cyB0aGF0IHVzZSBsb25nTWVzc2FnZS4iIiIKCiAgICBkZWYgc2V0VXAoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdGFibGVUZXN0RmFsc2UodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBsb25nTWVzc2FnZSA9IEZhbHNlCiAgICAgICAgICAgIGZhaWx1cmVFeGNlcHRpb24gPSBzZWxmLmZhaWx1cmVFeGNlcHRpb24KCiAgICAgICAgICAgIGRlZiB0ZXN0VGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgY2xhc3MgVGVzdGFibGVUZXN0VHJ1ZSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGxvbmdNZXNzYWdlID0gVHJ1ZQogICAgICAgICAgICBmYWlsdXJlRXhjZXB0aW9uID0gc2VsZi5mYWlsdXJlRXhjZXB0aW9uCgogICAgICAgICAgICBkZWYgdGVzdFRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIHNlbGYudGVzdGFibGVUcnVlID0gVGVzdGFibGVUZXN0VHJ1ZSgndGVzdFRlc3QnKQogICAgICAgIHNlbGYudGVzdGFibGVGYWxzZSA9IFRlc3RhYmxlVGVzdEZhbHNlKCd0ZXN0VGVzdCcpCgogICAgZGVmIHRlc3REZWZhdWx0KHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZSh1bml0dGVzdC5UZXN0Q2FzZS5sb25nTWVzc2FnZSkKCiAgICBkZWYgdGVzdF9mb3JtYXRNc2coc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzZWxmLnRlc3RhYmxlRmFsc2UuX2Zvcm1hdE1lc3NhZ2UoTm9uZSwgImZvbyIpLCAiZm9vIikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNlbGYudGVzdGFibGVGYWxzZS5fZm9ybWF0TWVzc2FnZSgiZm9vIiwgImJhciIpLCAiZm9vIikKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzZWxmLnRlc3RhYmxlVHJ1ZS5fZm9ybWF0TWVzc2FnZShOb25lLCAiZm9vIiksICJmb28iKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc2VsZi50ZXN0YWJsZVRydWUuX2Zvcm1hdE1lc3NhZ2UoImZvbyIsICJiYXIiKSwgImJhciA6IGZvbyIpCgogICAgICAgICMgVGhpcyBibG93cyB1cCBpZiBfZm9ybWF0TWVzc2FnZSB1c2VzIHN0cmluZyBjb25jYXRlbmF0aW9uCiAgICAgICAgc2VsZi50ZXN0YWJsZVRydWUuX2Zvcm1hdE1lc3NhZ2Uob2JqZWN0KCksICdmb28nKQoKICAgIGRlZiB0ZXN0X2Zvcm1hdE1lc3NhZ2VfdW5pY29kZV9lcnJvcihzZWxmKToKICAgICAgICBvbmUgPSAnJy5qb2luKGNocihpKSBmb3IgaSBpbiByYW5nZSgyNTUpKQogICAgICAgICMgdGhpcyB1c2VkIHRvIGNhdXNlIGEgVW5pY29kZURlY29kZUVycm9yIGNvbnN0cnVjdGluZyBtc2cKICAgICAgICBzZWxmLnRlc3RhYmxlVHJ1ZS5fZm9ybWF0TWVzc2FnZShvbmUsICdcdUZGRkQnKQoKICAgIGRlZiBhc3NlcnRNZXNzYWdlcyhzZWxmLCBtZXRob2ROYW1lLCBhcmdzLCBlcnJvcnMpOgogICAgICAgICIiIgogICAgICAgIENoZWNrIHRoYXQgbWV0aG9kTmFtZSgqYXJncykgcmFpc2VzIHRoZSBjb3JyZWN0IGVycm9yIG1lc3NhZ2VzLgogICAgICAgIGVycm9ycyBzaG91bGQgYmUgYSBsaXN0IG9mIDQgcmVnZXggdGhhdCBtYXRjaCB0aGUgZXJyb3Igd2hlbjoKICAgICAgICAgIDEpIGxvbmdNZXNzYWdlID0gRmFsc2UgYW5kIG5vIG1zZyBwYXNzZWQ7CiAgICAgICAgICAyKSBsb25nTWVzc2FnZSA9IEZhbHNlIGFuZCBtc2cgcGFzc2VkOwogICAgICAgICAgMykgbG9uZ01lc3NhZ2UgPSBUcnVlIGFuZCBubyBtc2cgcGFzc2VkOwogICAgICAgICAgNCkgbG9uZ01lc3NhZ2UgPSBUcnVlIGFuZCBtc2cgcGFzc2VkOwogICAgICAgICIiIgogICAgICAgIGRlZiBnZXRNZXRob2QoaSk6CiAgICAgICAgICAgIHVzZVRlc3RhYmxlRmFsc2UgID0gaSA8IDIKICAgICAgICAgICAgaWYgdXNlVGVzdGFibGVGYWxzZToKICAgICAgICAgICAgICAgIHRlc3QgPSBzZWxmLnRlc3RhYmxlRmFsc2UKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRlc3QgPSBzZWxmLnRlc3RhYmxlVHJ1ZQogICAgICAgICAgICByZXR1cm4gZ2V0YXR0cih0ZXN0LCBtZXRob2ROYW1lKQoKICAgICAgICBmb3IgaSwgZXhwZWN0ZWRfcmVnZXggaW4gZW51bWVyYXRlKGVycm9ycyk6CiAgICAgICAgICAgIHRlc3RNZXRob2QgPSBnZXRNZXRob2QoaSkKICAgICAgICAgICAga3dhcmdzID0ge30KICAgICAgICAgICAgd2l0aE1zZyA9IGkgJSAyCiAgICAgICAgICAgIGlmIHdpdGhNc2c6CiAgICAgICAgICAgICAgICBrd2FyZ3MgPSB7Im1zZyI6ICJvb3BzIn0KCiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXNSZWdleChzZWxmLmZhaWx1cmVFeGNlcHRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3RlZF9yZWdleD1leHBlY3RlZF9yZWdleCk6CiAgICAgICAgICAgICAgICB0ZXN0TWV0aG9kKCphcmdzLCAqKmt3YXJncykKCiAgICBkZWYgdGVzdEFzc2VydFRydWUoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0VHJ1ZScsIChGYWxzZSwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJeRmFsc2UgaXMgbm90IHRydWUkIiwgIl5vb3BzJCIsICJeRmFsc2UgaXMgbm90IHRydWUkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXkZhbHNlIGlzIG5vdCB0cnVlIDogb29wcyQiXSkKCiAgICBkZWYgdGVzdEFzc2VydEZhbHNlKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0TWVzc2FnZXMoJ2Fzc2VydEZhbHNlJywgKFRydWUsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiXlRydWUgaXMgbm90IGZhbHNlJCIsICJeb29wcyQiLCAiXlRydWUgaXMgbm90IGZhbHNlJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl5UcnVlIGlzIG5vdCBmYWxzZSA6IG9vcHMkIl0pCgogICAgZGVmIHRlc3ROb3RFcXVhbChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzKCdhc3NlcnROb3RFcXVhbCcsICgxLCAxKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiXjEgPT0gMSQiLCAiXm9vcHMkIiwgIl4xID09IDEkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXjEgPT0gMSA6IG9vcHMkIl0pCgogICAgZGVmIHRlc3RBbG1vc3RFcXVhbChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzKCdhc3NlcnRBbG1vc3RFcXVhbCcsICgxLCAyKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiXjEgIT0gMiB3aXRoaW4gNyBwbGFjZXMkIiwgIl5vb3BzJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl4xICE9IDIgd2l0aGluIDcgcGxhY2VzJCIsICJeMSAhPSAyIHdpdGhpbiA3IHBsYWNlcyA6IG9vcHMkIl0pCgogICAgZGVmIHRlc3ROb3RBbG1vc3RFcXVhbChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzKCdhc3NlcnROb3RBbG1vc3RFcXVhbCcsICgxLCAxKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiXjEgPT0gMSB3aXRoaW4gNyBwbGFjZXMkIiwgIl5vb3BzJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl4xID09IDEgd2l0aGluIDcgcGxhY2VzJCIsICJeMSA9PSAxIHdpdGhpbiA3IHBsYWNlcyA6IG9vcHMkIl0pCgogICAgZGVmIHRlc3RfYmFzZUFzc2VydEVxdWFsKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0TWVzc2FnZXMoJ19iYXNlQXNzZXJ0RXF1YWwnLCAoMSwgMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbIl4xICE9IDIkIiwgIl5vb3BzJCIsICJeMSAhPSAyJCIsICJeMSAhPSAyIDogb29wcyQiXSkKCiAgICBkZWYgdGVzdEFzc2VydFNlcXVlbmNlRXF1YWwoc2VsZik6CiAgICAgICAgIyBFcnJvciBtZXNzYWdlcyBhcmUgbXVsdGlsaW5lIHNvIG5vdCB0ZXN0aW5nIG9uIGZ1bGwgbWVzc2FnZQogICAgICAgICMgYXNzZXJ0VHVwbGVFcXVhbCBhbmQgYXNzZXJ0TGlzdEVxdWFsIGRlbGVnYXRlIHRvIHRoaXMgbWV0aG9kCiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0U2VxdWVuY2VFcXVhbCcsIChbXSwgW05vbmVdKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiXCsgXFtOb25lXF0kIiwgIl5vb3BzJCIsIHIiXCsgXFtOb25lXF0kIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICByIlwrIFxbTm9uZVxdIDogb29wcyQiXSkKCiAgICBkZWYgdGVzdEFzc2VydFNldEVxdWFsKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0TWVzc2FnZXMoJ2Fzc2VydFNldEVxdWFsJywgKHNldCgpLCBzZXQoW05vbmVdKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbIk5vbmUkIiwgIl5vb3BzJCIsICJOb25lJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vbmUgOiBvb3BzJCJdKQoKICAgIGRlZiB0ZXN0QXNzZXJ0SW4oc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0SW4nLCAoTm9uZSwgW10pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWydeTm9uZSBub3QgZm91bmQgaW4gXFtcXSQnLCAiXm9vcHMkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXk5vbmUgbm90IGZvdW5kIGluIFxbXF0kJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXk5vbmUgbm90IGZvdW5kIGluIFxbXF0gOiBvb3BzJCddKQoKICAgIGRlZiB0ZXN0QXNzZXJ0Tm90SW4oc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0Tm90SW4nLCAoTm9uZSwgW05vbmVdKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsnXk5vbmUgdW5leHBlY3RlZGx5IGZvdW5kIGluIFxbTm9uZVxdJCcsICJeb29wcyQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICdeTm9uZSB1bmV4cGVjdGVkbHkgZm91bmQgaW4gXFtOb25lXF0kJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXk5vbmUgdW5leHBlY3RlZGx5IGZvdW5kIGluIFxbTm9uZVxdIDogb29wcyQnXSkKCiAgICBkZWYgdGVzdEFzc2VydERpY3RFcXVhbChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzKCdhc3NlcnREaWN0RXF1YWwnLCAoe30sIHsna2V5JzogJ3ZhbHVlJ30pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgW3IiXCsgXHsna2V5JzogJ3ZhbHVlJ1x9JCIsICJeb29wcyQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJcKyBceydrZXknOiAndmFsdWUnXH0kIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXCsgXHsna2V5JzogJ3ZhbHVlJ1x9IDogb29wcyQiXSkKCiAgICBkZWYgdGVzdEFzc2VydERpY3RDb250YWluc1N1YnNldChzZWxmKToKICAgICAgICB3aXRoIHdhcm5pbmdzLmNhdGNoX3dhcm5pbmdzKCk6CiAgICAgICAgICAgIHdhcm5pbmdzLnNpbXBsZWZpbHRlcigiaWdub3JlIiwgRGVwcmVjYXRpb25XYXJuaW5nKQoKICAgICAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0JywgKHsna2V5JzogJ3ZhbHVlJ30sIHt9KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbIl5NaXNzaW5nOiAna2V5JyQiLCAiXm9vcHMkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl5NaXNzaW5nOiAna2V5JyQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXk1pc3Npbmc6ICdrZXknIDogb29wcyQiXSkKCiAgICBkZWYgdGVzdEFzc2VydE11bHRpTGluZUVxdWFsKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0TWVzc2FnZXMoJ2Fzc2VydE11bHRpTGluZUVxdWFsJywgKCIiLCAiZm9vIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbciJcKyBmb28kIiwgIl5vb3BzJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgciJcKyBmb28kIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICByIlwrIGZvbyA6IG9vcHMkIl0pCgogICAgZGVmIHRlc3RBc3NlcnRMZXNzKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0TWVzc2FnZXMoJ2Fzc2VydExlc3MnLCAoMiwgMSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbIl4yIG5vdCBsZXNzIHRoYW4gMSQiLCAiXm9vcHMkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXjIgbm90IGxlc3MgdGhhbiAxJCIsICJeMiBub3QgbGVzcyB0aGFuIDEgOiBvb3BzJCJdKQoKICAgIGRlZiB0ZXN0QXNzZXJ0TGVzc0VxdWFsKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0TWVzc2FnZXMoJ2Fzc2VydExlc3NFcXVhbCcsICgyLCAxKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiXjIgbm90IGxlc3MgdGhhbiBvciBlcXVhbCB0byAxJCIsICJeb29wcyQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJeMiBub3QgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIDEkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXjIgbm90IGxlc3MgdGhhbiBvciBlcXVhbCB0byAxIDogb29wcyQiXSkKCiAgICBkZWYgdGVzdEFzc2VydEdyZWF0ZXIoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0R3JlYXRlcicsICgxLCAyKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiXjEgbm90IGdyZWF0ZXIgdGhhbiAyJCIsICJeb29wcyQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJeMSBub3QgZ3JlYXRlciB0aGFuIDIkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXjEgbm90IGdyZWF0ZXIgdGhhbiAyIDogb29wcyQiXSkKCiAgICBkZWYgdGVzdEFzc2VydEdyZWF0ZXJFcXVhbChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzKCdhc3NlcnRHcmVhdGVyRXF1YWwnLCAoMSwgMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbIl4xIG5vdCBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gMiQiLCAiXm9vcHMkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXjEgbm90IGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAyJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl4xIG5vdCBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gMiA6IG9vcHMkIl0pCgogICAgZGVmIHRlc3RBc3NlcnRJc05vbmUoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0SXNOb25lJywgKCdub3QgTm9uZScsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiXidub3QgTm9uZScgaXMgbm90IE5vbmUkIiwgIl5vb3BzJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl4nbm90IE5vbmUnIGlzIG5vdCBOb25lJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl4nbm90IE5vbmUnIGlzIG5vdCBOb25lIDogb29wcyQiXSkKCiAgICBkZWYgdGVzdEFzc2VydElzTm90Tm9uZShzZWxmKToKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzKCdhc3NlcnRJc05vdE5vbmUnLCAoTm9uZSwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJedW5leHBlY3RlZGx5IE5vbmUkIiwgIl5vb3BzJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl51bmV4cGVjdGVkbHkgTm9uZSQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJedW5leHBlY3RlZGx5IE5vbmUgOiBvb3BzJCJdKQoKICAgIGRlZiB0ZXN0QXNzZXJ0SXMoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0SXMnLCAoTm9uZSwgJ2ZvbycpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJeTm9uZSBpcyBub3QgJ2ZvbyckIiwgIl5vb3BzJCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl5Ob25lIGlzIG5vdCAnZm9vJyQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJeTm9uZSBpcyBub3QgJ2ZvbycgOiBvb3BzJCJdKQoKICAgIGRlZiB0ZXN0QXNzZXJ0SXNOb3Qoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlcygnYXNzZXJ0SXNOb3QnLCAoTm9uZSwgTm9uZSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbIl51bmV4cGVjdGVkbHkgaWRlbnRpY2FsOiBOb25lJCIsICJeb29wcyQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJedW5leHBlY3RlZGx5IGlkZW50aWNhbDogTm9uZSQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJedW5leHBlY3RlZGx5IGlkZW50aWNhbDogTm9uZSA6IG9vcHMkIl0pCgoKICAgIGRlZiBhc3NlcnRNZXNzYWdlc0NNKHNlbGYsIG1ldGhvZE5hbWUsIGFyZ3MsIGZ1bmMsIGVycm9ycyk6CiAgICAgICAgIiIiCiAgICAgICAgQ2hlY2sgdGhhdCB0aGUgY29ycmVjdCBlcnJvciBtZXNzYWdlcyBhcmUgcmFpc2VkIHdoaWxlIGV4ZWN1dGluZzoKICAgICAgICAgIHdpdGggbWV0aG9kKCphcmdzKToKICAgICAgICAgICAgICBmdW5jKCkKICAgICAgICAqZXJyb3JzKiBzaG91bGQgYmUgYSBsaXN0IG9mIDQgcmVnZXggdGhhdCBtYXRjaCB0aGUgZXJyb3Igd2hlbjoKICAgICAgICAgIDEpIGxvbmdNZXNzYWdlID0gRmFsc2UgYW5kIG5vIG1zZyBwYXNzZWQ7CiAgICAgICAgICAyKSBsb25nTWVzc2FnZSA9IEZhbHNlIGFuZCBtc2cgcGFzc2VkOwogICAgICAgICAgMykgbG9uZ01lc3NhZ2UgPSBUcnVlIGFuZCBubyBtc2cgcGFzc2VkOwogICAgICAgICAgNCkgbG9uZ01lc3NhZ2UgPSBUcnVlIGFuZCBtc2cgcGFzc2VkOwogICAgICAgICIiIgogICAgICAgIHAgPSBwcm9kdWN0KChzZWxmLnRlc3RhYmxlRmFsc2UsIHNlbGYudGVzdGFibGVUcnVlKSwKICAgICAgICAgICAgICAgICAgICAoe30sIHsibXNnIjogIm9vcHMifSkpCiAgICAgICAgZm9yIChjbHMsIGt3YXJncyksIGVyciBpbiB6aXAocCwgZXJyb3JzKToKICAgICAgICAgICAgbWV0aG9kID0gZ2V0YXR0cihjbHMsIG1ldGhvZE5hbWUpCiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXNSZWdleChjbHMuZmFpbHVyZUV4Y2VwdGlvbiwgZXJyKToKICAgICAgICAgICAgICAgIHdpdGggbWV0aG9kKCphcmdzLCAqKmt3YXJncykgYXMgY206CiAgICAgICAgICAgICAgICAgICAgZnVuYygpCgogICAgZGVmIHRlc3RBc3NlcnRSYWlzZXMoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlc0NNKCdhc3NlcnRSYWlzZXMnLCAoVHlwZUVycm9yLCksIGxhbWJkYTogTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWydeVHlwZUVycm9yIG5vdCByYWlzZWQkJywgJ15vb3BzJCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXlR5cGVFcnJvciBub3QgcmFpc2VkJCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXlR5cGVFcnJvciBub3QgcmFpc2VkIDogb29wcyQnXSkKCiAgICBkZWYgdGVzdEFzc2VydFJhaXNlc1JlZ2V4KHNlbGYpOgogICAgICAgICMgdGVzdCBlcnJvciBub3QgcmFpc2VkCiAgICAgICAgc2VsZi5hc3NlcnRNZXNzYWdlc0NNKCdhc3NlcnRSYWlzZXNSZWdleCcsIChUeXBlRXJyb3IsICd1bnVzZWQgcmVnZXgnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFtYmRhOiBOb25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbJ15UeXBlRXJyb3Igbm90IHJhaXNlZCQnLCAnXm9vcHMkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdeVHlwZUVycm9yIG5vdCByYWlzZWQkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdeVHlwZUVycm9yIG5vdCByYWlzZWQgOiBvb3BzJCddKQogICAgICAgICMgdGVzdCBlcnJvciByYWlzZWQgYnV0IHdpdGggd3JvbmcgbWVzc2FnZQogICAgICAgIGRlZiByYWlzZV93cm9uZ19tZXNzYWdlKCk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcignZm9vJykKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzQ00oJ2Fzc2VydFJhaXNlc1JlZ2V4JywgKFR5cGVFcnJvciwgJ3JlZ2V4JyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhaXNlX3dyb25nX21lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsnXiJyZWdleCIgZG9lcyBub3QgbWF0Y2ggImZvbyIkJywgJ15vb3BzJCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXiJyZWdleCIgZG9lcyBub3QgbWF0Y2ggImZvbyIkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdeInJlZ2V4IiBkb2VzIG5vdCBtYXRjaCAiZm9vIiA6IG9vcHMkJ10pCgogICAgZGVmIHRlc3RBc3NlcnRXYXJucyhzZWxmKToKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzQ00oJ2Fzc2VydFdhcm5zJywgKFVzZXJXYXJuaW5nLCksIGxhbWJkYTogTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWydeVXNlcldhcm5pbmcgbm90IHRyaWdnZXJlZCQnLCAnXm9vcHMkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdeVXNlcldhcm5pbmcgbm90IHRyaWdnZXJlZCQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ15Vc2VyV2FybmluZyBub3QgdHJpZ2dlcmVkIDogb29wcyQnXSkKCiAgICBkZWYgdGVzdEFzc2VydFdhcm5zUmVnZXgoc2VsZik6CiAgICAgICAgIyB0ZXN0IGVycm9yIG5vdCByYWlzZWQKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzQ00oJ2Fzc2VydFdhcm5zUmVnZXgnLCAoVXNlcldhcm5pbmcsICd1bnVzZWQgcmVnZXgnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFtYmRhOiBOb25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbJ15Vc2VyV2FybmluZyBub3QgdHJpZ2dlcmVkJCcsICdeb29wcyQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ15Vc2VyV2FybmluZyBub3QgdHJpZ2dlcmVkJCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXlVzZXJXYXJuaW5nIG5vdCB0cmlnZ2VyZWQgOiBvb3BzJCddKQogICAgICAgICMgdGVzdCB3YXJuaW5nIHJhaXNlZCBidXQgd2l0aCB3cm9uZyBtZXNzYWdlCiAgICAgICAgZGVmIHJhaXNlX3dyb25nX21lc3NhZ2UoKToKICAgICAgICAgICAgd2FybmluZ3Mud2FybignZm9vJykKICAgICAgICBzZWxmLmFzc2VydE1lc3NhZ2VzQ00oJ2Fzc2VydFdhcm5zUmVnZXgnLCAoVXNlcldhcm5pbmcsICdyZWdleCcpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWlzZV93cm9uZ19tZXNzYWdlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbJ14icmVnZXgiIGRvZXMgbm90IG1hdGNoICJmb28iJCcsICdeb29wcyQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ14icmVnZXgiIGRvZXMgbm90IG1hdGNoICJmb28iJCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXiJyZWdleCIgZG9lcyBub3QgbWF0Y2ggImZvbyIgOiBvb3BzJCddKQo=',
'/Lib/unittest/test/test_break.py':'aW1wb3J0IGdjCmltcG9ydCBpbwppbXBvcnQgb3MKaW1wb3J0IHN5cwppbXBvcnQgc2lnbmFsCmltcG9ydCB3ZWFrcmVmCgppbXBvcnQgdW5pdHRlc3QKCgpAdW5pdHRlc3Quc2tpcFVubGVzcyhoYXNhdHRyKG9zLCAna2lsbCcpLCAiVGVzdCByZXF1aXJlcyBvcy5raWxsIikKQHVuaXR0ZXN0LnNraXBJZihzeXMucGxhdGZvcm0gPT0id2luMzIiLCAiVGVzdCBjYW5ub3QgcnVuIG9uIFdpbmRvd3MiKQpAdW5pdHRlc3Quc2tpcElmKHN5cy5wbGF0Zm9ybSA9PSAnZnJlZWJzZDYnLCAiVGVzdCBraWxscyByZWdydGVzdCBvbiBmcmVlYnNkNiAiCiAgICAiaWYgdGhyZWFkcyBoYXZlIGJlZW4gdXNlZCIpCmNsYXNzIFRlc3RCcmVhayh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIHNldFVwKHNlbGYpOgogICAgICAgIHNlbGYuX2RlZmF1bHRfaGFuZGxlciA9IHNpZ25hbC5nZXRzaWduYWwoc2lnbmFsLlNJR0lOVCkKCiAgICBkZWYgdGVhckRvd24oc2VsZik6CiAgICAgICAgc2lnbmFsLnNpZ25hbChzaWduYWwuU0lHSU5ULCBzZWxmLl9kZWZhdWx0X2hhbmRsZXIpCiAgICAgICAgdW5pdHRlc3Quc2lnbmFscy5fcmVzdWx0cyA9IHdlYWtyZWYuV2Vha0tleURpY3Rpb25hcnkoKQogICAgICAgIHVuaXR0ZXN0LnNpZ25hbHMuX2ludGVycnVwdF9oYW5kbGVyID0gTm9uZQoKCiAgICBkZWYgdGVzdEluc3RhbGxIYW5kbGVyKHNlbGYpOgogICAgICAgIGRlZmF1bHRfaGFuZGxlciA9IHNpZ25hbC5nZXRzaWduYWwoc2lnbmFsLlNJR0lOVCkKICAgICAgICB1bml0dGVzdC5pbnN0YWxsSGFuZGxlcigpCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpLCBkZWZhdWx0X2hhbmRsZXIpCgogICAgICAgIHRyeToKICAgICAgICAgICAgcGlkID0gb3MuZ2V0cGlkKCkKICAgICAgICAgICAgb3Mua2lsbChwaWQsIHNpZ25hbC5TSUdJTlQpCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICBzZWxmLmZhaWwoIktleWJvYXJkSW50ZXJydXB0IG5vdCBoYW5kbGVkIikKCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHVuaXR0ZXN0LnNpZ25hbHMuX2ludGVycnVwdF9oYW5kbGVyLmNhbGxlZCkKCiAgICBkZWYgdGVzdFJlZ2lzdGVyUmVzdWx0KHNlbGYpOgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHVuaXR0ZXN0LnJlZ2lzdGVyUmVzdWx0KHJlc3VsdCkKCiAgICAgICAgZm9yIHJlZiBpbiB1bml0dGVzdC5zaWduYWxzLl9yZXN1bHRzOgogICAgICAgICAgICBpZiByZWYgaXMgcmVzdWx0OgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZWxpZiByZWYgaXMgbm90IHJlc3VsdDoKICAgICAgICAgICAgICAgIHNlbGYuZmFpbCgib2RkIG9iamVjdCBpbiByZXN1bHQgc2V0IikKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoInJlc3VsdCBub3QgZm91bmQiKQoKCiAgICBkZWYgdGVzdEludGVycnVwdENhdWdodChzZWxmKToKICAgICAgICBkZWZhdWx0X2hhbmRsZXIgPSBzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpCgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHVuaXR0ZXN0Lmluc3RhbGxIYW5kbGVyKCkKICAgICAgICB1bml0dGVzdC5yZWdpc3RlclJlc3VsdChyZXN1bHQpCgogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoc2lnbmFsLmdldHNpZ25hbChzaWduYWwuU0lHSU5UKSwgZGVmYXVsdF9oYW5kbGVyKQoKICAgICAgICBkZWYgdGVzdChyZXN1bHQpOgogICAgICAgICAgICBwaWQgPSBvcy5nZXRwaWQoKQogICAgICAgICAgICBvcy5raWxsKHBpZCwgc2lnbmFsLlNJR0lOVCkKICAgICAgICAgICAgcmVzdWx0LmJyZWFrQ2F1Z2h0ID0gVHJ1ZQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0LnNob3VsZFN0b3ApCgogICAgICAgIHRyeToKICAgICAgICAgICAgdGVzdChyZXN1bHQpCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICBzZWxmLmZhaWwoIktleWJvYXJkSW50ZXJydXB0IG5vdCBoYW5kbGVkIikKICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0LmJyZWFrQ2F1Z2h0KQoKCiAgICBkZWYgdGVzdFNlY29uZEludGVycnVwdChzZWxmKToKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICB1bml0dGVzdC5pbnN0YWxsSGFuZGxlcigpCiAgICAgICAgdW5pdHRlc3QucmVnaXN0ZXJSZXN1bHQocmVzdWx0KQoKICAgICAgICBkZWYgdGVzdChyZXN1bHQpOgogICAgICAgICAgICBwaWQgPSBvcy5nZXRwaWQoKQogICAgICAgICAgICBvcy5raWxsKHBpZCwgc2lnbmFsLlNJR0lOVCkKICAgICAgICAgICAgcmVzdWx0LmJyZWFrQ2F1Z2h0ID0gVHJ1ZQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0LnNob3VsZFN0b3ApCiAgICAgICAgICAgIG9zLmtpbGwocGlkLCBzaWduYWwuU0lHSU5UKQogICAgICAgICAgICBzZWxmLmZhaWwoIlNlY29uZCBLZXlib2FyZEludGVycnVwdCBub3QgcmFpc2VkIikKCiAgICAgICAgdHJ5OgogICAgICAgICAgICB0ZXN0KHJlc3VsdCkKICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIlNlY29uZCBLZXlib2FyZEludGVycnVwdCBub3QgcmFpc2VkIikKICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0LmJyZWFrQ2F1Z2h0KQoKCiAgICBkZWYgdGVzdFR3b1Jlc3VsdHMoc2VsZik6CiAgICAgICAgdW5pdHRlc3QuaW5zdGFsbEhhbmRsZXIoKQoKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICB1bml0dGVzdC5yZWdpc3RlclJlc3VsdChyZXN1bHQpCiAgICAgICAgbmV3X2hhbmRsZXIgPSBzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpCgogICAgICAgIHJlc3VsdDIgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICB1bml0dGVzdC5yZWdpc3RlclJlc3VsdChyZXN1bHQyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc2lnbmFsLmdldHNpZ25hbChzaWduYWwuU0lHSU5UKSwgbmV3X2hhbmRsZXIpCgogICAgICAgIHJlc3VsdDMgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKCiAgICAgICAgZGVmIHRlc3QocmVzdWx0KToKICAgICAgICAgICAgcGlkID0gb3MuZ2V0cGlkKCkKICAgICAgICAgICAgb3Mua2lsbChwaWQsIHNpZ25hbC5TSUdJTlQpCgogICAgICAgIHRyeToKICAgICAgICAgICAgdGVzdChyZXN1bHQpCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICBzZWxmLmZhaWwoIktleWJvYXJkSW50ZXJydXB0IG5vdCBoYW5kbGVkIikKCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHJlc3VsdC5zaG91bGRTdG9wKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShyZXN1bHQyLnNob3VsZFN0b3ApCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShyZXN1bHQzLnNob3VsZFN0b3ApCgoKICAgIGRlZiB0ZXN0SGFuZGxlclJlcGxhY2VkQnV0Q2FsbGVkKHNlbGYpOgogICAgICAgICMgSWYgb3VyIGhhbmRsZXIgaGFzIGJlZW4gcmVwbGFjZWQgKGlzIG5vIGxvbmdlciBpbnN0YWxsZWQpIGJ1dCBpcwogICAgICAgICMgY2FsbGVkIGJ5IHRoZSAqbmV3KiBoYW5kbGVyLCB0aGVuIGl0IGlzbid0IHNhZmUgdG8gZGVsYXkgdGhlCiAgICAgICAgIyBTSUdJTlQgYW5kIHdlIHNob3VsZCBpbW1lZGlhdGVseSBkZWxlZ2F0ZSB0byB0aGUgZGVmYXVsdCBoYW5kbGVyCiAgICAgICAgdW5pdHRlc3QuaW5zdGFsbEhhbmRsZXIoKQoKICAgICAgICBoYW5kbGVyID0gc2lnbmFsLmdldHNpZ25hbChzaWduYWwuU0lHSU5UKQogICAgICAgIGRlZiBuZXdfaGFuZGxlcihmcmFtZSwgc2lnbnVtKToKICAgICAgICAgICAgaGFuZGxlcihmcmFtZSwgc2lnbnVtKQogICAgICAgIHNpZ25hbC5zaWduYWwoc2lnbmFsLlNJR0lOVCwgbmV3X2hhbmRsZXIpCgogICAgICAgIHRyeToKICAgICAgICAgICAgcGlkID0gb3MuZ2V0cGlkKCkKICAgICAgICAgICAgb3Mua2lsbChwaWQsIHNpZ25hbC5TSUdJTlQpCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICBwYXNzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCJyZXBsYWNlZCBidXQgZGVsZWdhdGVkIGhhbmRsZXIgZG9lc24ndCByYWlzZSBpbnRlcnJ1cHQiKQoKICAgIGRlZiB0ZXN0UnVubmVyKHNlbGYpOgogICAgICAgICMgQ3JlYXRpbmcgYSBUZXh0VGVzdFJ1bm5lciB3aXRoIHRoZSBhcHByb3ByaWF0ZSBhcmd1bWVudCBzaG91bGQKICAgICAgICAjIHJlZ2lzdGVyIHRoZSBUZXh0VGVzdFJlc3VsdCBpdCBjcmVhdGVzCiAgICAgICAgcnVubmVyID0gdW5pdHRlc3QuVGV4dFRlc3RSdW5uZXIoc3RyZWFtPWlvLlN0cmluZ0lPKCkpCgogICAgICAgIHJlc3VsdCA9IHJ1bm5lci5ydW4odW5pdHRlc3QuVGVzdFN1aXRlKCkpCiAgICAgICAgc2VsZi5hc3NlcnRJbihyZXN1bHQsIHVuaXR0ZXN0LnNpZ25hbHMuX3Jlc3VsdHMpCgogICAgZGVmIHRlc3RXZWFrUmVmZXJlbmNlcyhzZWxmKToKICAgICAgICAjIENhbGxpbmcgcmVnaXN0ZXJSZXN1bHQgb24gYSByZXN1bHQgc2hvdWxkIG5vdCBrZWVwIGl0IGFsaXZlCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgdW5pdHRlc3QucmVnaXN0ZXJSZXN1bHQocmVzdWx0KQoKICAgICAgICByZWYgPSB3ZWFrcmVmLnJlZihyZXN1bHQpCiAgICAgICAgZGVsIHJlc3VsdAoKICAgICAgICAjIEZvciBub24tcmVmZXJlbmNlIGNvdW50aW5nIGltcGxlbWVudGF0aW9ucwogICAgICAgIGdjLmNvbGxlY3QoKTtnYy5jb2xsZWN0KCkKICAgICAgICBzZWxmLmFzc2VydElzTm9uZShyZWYoKSkKCgogICAgZGVmIHRlc3RSZW1vdmVSZXN1bHQoc2VsZik6CiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgdW5pdHRlc3QucmVnaXN0ZXJSZXN1bHQocmVzdWx0KQoKICAgICAgICB1bml0dGVzdC5pbnN0YWxsSGFuZGxlcigpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHVuaXR0ZXN0LnJlbW92ZVJlc3VsdChyZXN1bHQpKQoKICAgICAgICAjIFNob3VsZCB0aGlzIHJhaXNlIGFuIGVycm9yIGluc3RlYWQ/CiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZSh1bml0dGVzdC5yZW1vdmVSZXN1bHQodW5pdHRlc3QuVGVzdFJlc3VsdCgpKSkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBwaWQgPSBvcy5nZXRwaWQoKQogICAgICAgICAgICBvcy5raWxsKHBpZCwgc2lnbmFsLlNJR0lOVCkKICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShyZXN1bHQuc2hvdWxkU3RvcCkKCiAgICBkZWYgdGVzdE1haW5JbnN0YWxsc0hhbmRsZXIoc2VsZik6CiAgICAgICAgZmFpbGZhc3QgPSBvYmplY3QoKQogICAgICAgIHRlc3QgPSBvYmplY3QoKQogICAgICAgIHZlcmJvc2l0eSA9IG9iamVjdCgpCiAgICAgICAgcmVzdWx0ID0gb2JqZWN0KCkKICAgICAgICBkZWZhdWx0X2hhbmRsZXIgPSBzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpCgogICAgICAgIGNsYXNzIEZha2VSdW5uZXIob2JqZWN0KToKICAgICAgICAgICAgaW5pdEFyZ3MgPSBbXQogICAgICAgICAgICBydW5BcmdzID0gW10KICAgICAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgICAgICBzZWxmLmluaXRBcmdzLmFwcGVuZCgoYXJncywga3dhcmdzKSkKICAgICAgICAgICAgZGVmIHJ1bihzZWxmLCB0ZXN0KToKICAgICAgICAgICAgICAgIHNlbGYucnVuQXJncy5hcHBlbmQodGVzdCkKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQKCiAgICAgICAgY2xhc3MgUHJvZ3JhbSh1bml0dGVzdC5UZXN0UHJvZ3JhbSk6CiAgICAgICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjYXRjaGJyZWFrKToKICAgICAgICAgICAgICAgIHNlbGYuZXhpdCA9IEZhbHNlCiAgICAgICAgICAgICAgICBzZWxmLnZlcmJvc2l0eSA9IHZlcmJvc2l0eQogICAgICAgICAgICAgICAgc2VsZi5mYWlsZmFzdCA9IGZhaWxmYXN0CiAgICAgICAgICAgICAgICBzZWxmLmNhdGNoYnJlYWsgPSBjYXRjaGJyZWFrCiAgICAgICAgICAgICAgICBzZWxmLnRlc3RSdW5uZXIgPSBGYWtlUnVubmVyCiAgICAgICAgICAgICAgICBzZWxmLnRlc3QgPSB0ZXN0CiAgICAgICAgICAgICAgICBzZWxmLnJlc3VsdCA9IE5vbmUKCiAgICAgICAgcCA9IFByb2dyYW0oRmFsc2UpCiAgICAgICAgcC5ydW5UZXN0cygpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRmFrZVJ1bm5lci5pbml0QXJncywgWygoKSwgeydidWZmZXInOiBOb25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd2ZXJib3NpdHknOiB2ZXJib3NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2ZhaWxmYXN0JzogZmFpbGZhc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3dhcm5pbmdzJzogTm9uZX0pXSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZha2VSdW5uZXIucnVuQXJncywgW3Rlc3RdKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocC5yZXN1bHQsIHJlc3VsdCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpLCBkZWZhdWx0X2hhbmRsZXIpCgogICAgICAgIEZha2VSdW5uZXIuaW5pdEFyZ3MgPSBbXQogICAgICAgIEZha2VSdW5uZXIucnVuQXJncyA9IFtdCiAgICAgICAgcCA9IFByb2dyYW0oVHJ1ZSkKICAgICAgICBwLnJ1blRlc3RzKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGYWtlUnVubmVyLmluaXRBcmdzLCBbKCgpLCB7J2J1ZmZlcic6IE5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3ZlcmJvc2l0eSc6IHZlcmJvc2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZmFpbGZhc3QnOiBmYWlsZmFzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnd2FybmluZ3MnOiBOb25lfSldKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRmFrZVJ1bm5lci5ydW5BcmdzLCBbdGVzdF0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwLnJlc3VsdCwgcmVzdWx0KQoKICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKHNpZ25hbC5nZXRzaWduYWwoc2lnbmFsLlNJR0lOVCksIGRlZmF1bHRfaGFuZGxlcikKCiAgICBkZWYgdGVzdFJlbW92ZUhhbmRsZXIoc2VsZik6CiAgICAgICAgZGVmYXVsdF9oYW5kbGVyID0gc2lnbmFsLmdldHNpZ25hbChzaWduYWwuU0lHSU5UKQogICAgICAgIHVuaXR0ZXN0Lmluc3RhbGxIYW5kbGVyKCkKICAgICAgICB1bml0dGVzdC5yZW1vdmVIYW5kbGVyKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNpZ25hbC5nZXRzaWduYWwoc2lnbmFsLlNJR0lOVCksIGRlZmF1bHRfaGFuZGxlcikKCiAgICAgICAgIyBjaGVjayB0aGF0IGNhbGxpbmcgcmVtb3ZlSGFuZGxlciBtdWx0aXBsZSB0aW1lcyBoYXMgbm8gaWxsLWVmZmVjdAogICAgICAgIHVuaXR0ZXN0LnJlbW92ZUhhbmRsZXIoKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc2lnbmFsLmdldHNpZ25hbChzaWduYWwuU0lHSU5UKSwgZGVmYXVsdF9oYW5kbGVyKQoKICAgIGRlZiB0ZXN0UmVtb3ZlSGFuZGxlckFzRGVjb3JhdG9yKHNlbGYpOgogICAgICAgIGRlZmF1bHRfaGFuZGxlciA9IHNpZ25hbC5nZXRzaWduYWwoc2lnbmFsLlNJR0lOVCkKICAgICAgICB1bml0dGVzdC5pbnN0YWxsSGFuZGxlcigpCgogICAgICAgIEB1bml0dGVzdC5yZW1vdmVIYW5kbGVyCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpLCBkZWZhdWx0X2hhbmRsZXIpCgogICAgICAgIHRlc3QoKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoc2lnbmFsLmdldHNpZ25hbChzaWduYWwuU0lHSU5UKSwgZGVmYXVsdF9oYW5kbGVyKQo=',
'/Lib/unittest/test/test_case.py':'aW1wb3J0IGRpZmZsaWIKaW1wb3J0IHBwcmludAppbXBvcnQgcGlja2xlCmltcG9ydCByZQppbXBvcnQgc3lzCmltcG9ydCB3YXJuaW5ncwppbXBvcnQgd2Vha3JlZgppbXBvcnQgaW5zcGVjdAoKZnJvbSBjb3B5IGltcG9ydCBkZWVwY29weQpmcm9tIHRlc3QgaW1wb3J0IHN1cHBvcnQKCmltcG9ydCB1bml0dGVzdAoKZnJvbSAuc3VwcG9ydCBpbXBvcnQgKAogICAgVGVzdEVxdWFsaXR5LCBUZXN0SGFzaGluZywgTG9nZ2luZ1Jlc3VsdCwKICAgIFJlc3VsdFdpdGhOb1N0YXJ0VGVzdFJ1blN0b3BUZXN0UnVuCikKCgpjbGFzcyBUZXN0KG9iamVjdCk6CiAgICAiS2VlcCB0aGVzZSBUZXN0Q2FzZSBjbGFzc2VzIG91dCBvZiB0aGUgbWFpbiBuYW1lc3BhY2UiCgogICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICBkZWYgcnVuVGVzdChzZWxmKTogcGFzcwogICAgICAgIGRlZiB0ZXN0MShzZWxmKTogcGFzcwoKICAgIGNsYXNzIEJhcihGb28pOgogICAgICAgIGRlZiB0ZXN0MihzZWxmKTogcGFzcwoKICAgIGNsYXNzIExvZ2dpbmdUZXN0Q2FzZSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgIiIiQSB0ZXN0IGNhc2Ugd2hpY2ggbG9ncyBpdHMgY2FsbHMuIiIiCgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBldmVudHMpOgogICAgICAgICAgICBzdXBlcihUZXN0LkxvZ2dpbmdUZXN0Q2FzZSwgc2VsZikuX19pbml0X18oJ3Rlc3QnKQogICAgICAgICAgICBzZWxmLmV2ZW50cyA9IGV2ZW50cwoKICAgICAgICBkZWYgc2V0VXAoc2VsZik6CiAgICAgICAgICAgIHNlbGYuZXZlbnRzLmFwcGVuZCgnc2V0VXAnKQoKICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgc2VsZi5ldmVudHMuYXBwZW5kKCd0ZXN0JykKCiAgICAgICAgZGVmIHRlYXJEb3duKHNlbGYpOgogICAgICAgICAgICBzZWxmLmV2ZW50cy5hcHBlbmQoJ3RlYXJEb3duJykKCgpjbGFzcyBUZXN0X1Rlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlLCBUZXN0RXF1YWxpdHksIFRlc3RIYXNoaW5nKToKCiAgICAjIyMgU2V0IHVwIGF0dHJpYnV0ZXMgdXNlZCBieSBpbmhlcml0ZWQgdGVzdHMKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAjIFVzZWQgYnkgVGVzdEhhc2hpbmcudGVzdF9oYXNoIGFuZCBUZXN0RXF1YWxpdHkudGVzdF9lcQogICAgZXFfcGFpcnMgPSBbKFRlc3QuRm9vKCd0ZXN0MScpLCBUZXN0LkZvbygndGVzdDEnKSldCgogICAgIyBVc2VkIGJ5IFRlc3RFcXVhbGl0eS50ZXN0X25lCiAgICBuZV9wYWlycyA9IFsoVGVzdC5Gb28oJ3Rlc3QxJyksIFRlc3QuRm9vKCdydW5UZXN0JykpLAogICAgICAgICAgICAgICAgKFRlc3QuRm9vKCd0ZXN0MScpLCBUZXN0LkJhcigndGVzdDEnKSksCiAgICAgICAgICAgICAgICAoVGVzdC5Gb28oJ3Rlc3QxJyksIFRlc3QuQmFyKCd0ZXN0MicpKV0KCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiAgICAjIyMgL1NldCB1cCBhdHRyaWJ1dGVzIHVzZWQgYnkgaW5oZXJpdGVkIHRlc3RzCgoKICAgICMgImNsYXNzIFRlc3RDYXNlKFttZXRob2ROYW1lXSkiCiAgICAjIC4uLgogICAgIyAiRWFjaCBpbnN0YW5jZSBvZiBUZXN0Q2FzZSB3aWxsIHJ1biBhIHNpbmdsZSB0ZXN0IG1ldGhvZDogdGhlCiAgICAjIG1ldGhvZCBuYW1lZCBtZXRob2ROYW1lLiIKICAgICMgLi4uCiAgICAjICJtZXRob2ROYW1lIGRlZmF1bHRzIHRvICJydW5UZXN0Ii4iCiAgICAjCiAgICAjIE1ha2Ugc3VyZSBpdCByZWFsbHkgaXMgb3B0aW9uYWwsIGFuZCB0aGF0IGl0IGRlZmF1bHRzIHRvIHRoZSBwcm9wZXIKICAgICMgdGhpbmcuCiAgICBkZWYgdGVzdF9pbml0X19ub190ZXN0X25hbWUoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBydW5UZXN0KHNlbGYpOiByYWlzZSBNeUV4Y2VwdGlvbigpCiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOiBwYXNzCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoVGVzdCgpLmlkKClbLTEzOl0sICcuVGVzdC5ydW5UZXN0JykKCiAgICAgICAgIyB0ZXN0IHRoYXQgVGVzdENhc2UgY2FuIGJlIGluc3RhbnRpYXRlZCB3aXRoIG5vIGFyZ3MKICAgICAgICAjIHByaW1hcmlseSBmb3IgdXNlIGF0IHRoZSBpbnRlcmFjdGl2ZSBpbnRlcnByZXRlcgogICAgICAgIHRlc3QgPSB1bml0dGVzdC5UZXN0Q2FzZSgpCiAgICAgICAgdGVzdC5hc3NlcnRFcXVhbCgzLCAzKQogICAgICAgIHdpdGggdGVzdC5hc3NlcnRSYWlzZXModGVzdC5mYWlsdXJlRXhjZXB0aW9uKToKICAgICAgICAgICAgdGVzdC5hc3NlcnRFcXVhbCgzLCAyKQoKICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yKToKICAgICAgICAgICAgdGVzdC5ydW4oKQoKICAgICMgImNsYXNzIFRlc3RDYXNlKFttZXRob2ROYW1lXSkiCiAgICAjIC4uLgogICAgIyAiRWFjaCBpbnN0YW5jZSBvZiBUZXN0Q2FzZSB3aWxsIHJ1biBhIHNpbmdsZSB0ZXN0IG1ldGhvZDogdGhlCiAgICAjIG1ldGhvZCBuYW1lZCBtZXRob2ROYW1lLiIKICAgIGRlZiB0ZXN0X2luaXRfX3Rlc3RfbmFtZV9fdmFsaWQoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBydW5UZXN0KHNlbGYpOiByYWlzZSBNeUV4Y2VwdGlvbigpCiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOiBwYXNzCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoVGVzdCgndGVzdCcpLmlkKClbLTEwOl0sICcuVGVzdC50ZXN0JykKCiAgICAjICJjbGFzcyBUZXN0Q2FzZShbbWV0aG9kTmFtZV0pIgogICAgIyAuLi4KICAgICMgIkVhY2ggaW5zdGFuY2Ugb2YgVGVzdENhc2Ugd2lsbCBydW4gYSBzaW5nbGUgdGVzdCBtZXRob2Q6IHRoZQogICAgIyBtZXRob2QgbmFtZWQgbWV0aG9kTmFtZS4iCiAgICBkZWYgdGVzdF9pbml0X190ZXN0X25hbWVfX2ludmFsaWQoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBydW5UZXN0KHNlbGYpOiByYWlzZSBNeUV4Y2VwdGlvbigpCiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOiBwYXNzCgogICAgICAgIHRyeToKICAgICAgICAgICAgVGVzdCgndGVzdGZvbycpCiAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIkZhaWxlZCB0byByYWlzZSBWYWx1ZUVycm9yIikKCiAgICAjICJSZXR1cm4gdGhlIG51bWJlciBvZiB0ZXN0cyByZXByZXNlbnRlZCBieSB0aGUgdGhpcyB0ZXN0IG9iamVjdC4gRm9yCiAgICAjIFRlc3RDYXNlIGluc3RhbmNlcywgdGhpcyB3aWxsIGFsd2F5cyBiZSAxIgogICAgZGVmIHRlc3RfY291bnRUZXN0Q2FzZXMoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6IHBhc3MKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28oJ3Rlc3QnKS5jb3VudFRlc3RDYXNlcygpLCAxKQoKICAgICMgIlJldHVybiB0aGUgZGVmYXVsdCB0eXBlIG9mIHRlc3QgcmVzdWx0IG9iamVjdCB0byBiZSB1c2VkIHRvIHJ1biB0aGlzCiAgICAjIHRlc3QuIEZvciBUZXN0Q2FzZSBpbnN0YW5jZXMsIHRoaXMgd2lsbCBhbHdheXMgYmUKICAgICMgdW5pdHRlc3QuVGVzdFJlc3VsdDsgIHN1YmNsYXNzZXMgb2YgVGVzdENhc2Ugc2hvdWxkCiAgICAjIG92ZXJyaWRlIHRoaXMgYXMgbmVjZXNzYXJ5LiIKICAgIGRlZiB0ZXN0X2RlZmF1bHRUZXN0UmVzdWx0KHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBydW5UZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICByZXN1bHQgPSBGb28oKS5kZWZhdWx0VGVzdFJlc3VsdCgpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCh0eXBlKHJlc3VsdCksIHVuaXR0ZXN0LlRlc3RSZXN1bHQpCgogICAgIyAiV2hlbiBhIHNldFVwKCkgbWV0aG9kIGlzIGRlZmluZWQsIHRoZSB0ZXN0IHJ1bm5lciB3aWxsIHJ1biB0aGF0IG1ldGhvZAogICAgIyBwcmlvciB0byBlYWNoIHRlc3QuIExpa2V3aXNlLCBpZiBhIHRlYXJEb3duKCkgbWV0aG9kIGlzIGRlZmluZWQsIHRoZQogICAgIyB0ZXN0IHJ1bm5lciB3aWxsIGludm9rZSB0aGF0IG1ldGhvZCBhZnRlciBlYWNoIHRlc3QuIEluIHRoZSBleGFtcGxlLAogICAgIyBzZXRVcCgpIHdhcyB1c2VkIHRvIGNyZWF0ZSBhIGZyZXNoIHNlcXVlbmNlIGZvciBlYWNoIHRlc3QuIgogICAgIwogICAgIyBNYWtlIHN1cmUgdGhlIHByb3BlciBjYWxsIG9yZGVyIGlzIG1haW50YWluZWQsIGV2ZW4gaWYgc2V0VXAoKSByYWlzZXMKICAgICMgYW4gZXhjZXB0aW9uLgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2Vycm9yX2luX3NldFVwKHNlbGYpOgogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCgogICAgICAgIGNsYXNzIEZvbyhUZXN0LkxvZ2dpbmdUZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBzZXRVcChzZWxmKToKICAgICAgICAgICAgICAgIHN1cGVyKEZvbywgc2VsZikuc2V0VXAoKQogICAgICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCdyYWlzZWQgYnkgRm9vLnNldFVwJykKCiAgICAgICAgRm9vKGV2ZW50cykucnVuKHJlc3VsdCkKICAgICAgICBleHBlY3RlZCA9IFsnc3RhcnRUZXN0JywgJ3NldFVwJywgJ2FkZEVycm9yJywgJ3N0b3BUZXN0J10KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywgZXhwZWN0ZWQpCgogICAgIyAiV2l0aCBhIHRlbXBvcmFyeSByZXN1bHQgc3RvcFRlc3RSdW4gaXMgY2FsbGVkIHdoZW4gc2V0VXAgZXJyb3JzLgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2Vycm9yX2luX3NldFVwX2RlZmF1bHRfcmVzdWx0KHNlbGYpOgogICAgICAgIGV2ZW50cyA9IFtdCgogICAgICAgIGNsYXNzIEZvbyhUZXN0LkxvZ2dpbmdUZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBkZWZhdWx0VGVzdFJlc3VsdChzZWxmKToKICAgICAgICAgICAgICAgIHJldHVybiBMb2dnaW5nUmVzdWx0KHNlbGYuZXZlbnRzKQoKICAgICAgICAgICAgZGVmIHNldFVwKHNlbGYpOgogICAgICAgICAgICAgICAgc3VwZXIoRm9vLCBzZWxmKS5zZXRVcCgpCiAgICAgICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoJ3JhaXNlZCBieSBGb28uc2V0VXAnKQoKICAgICAgICBGb28oZXZlbnRzKS5ydW4oKQogICAgICAgIGV4cGVjdGVkID0gWydzdGFydFRlc3RSdW4nLCAnc3RhcnRUZXN0JywgJ3NldFVwJywgJ2FkZEVycm9yJywKICAgICAgICAgICAgICAgICAgICAnc3RvcFRlc3QnLCAnc3RvcFRlc3RSdW4nXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZXZlbnRzLCBleHBlY3RlZCkKCiAgICAjICJXaGVuIGEgc2V0VXAoKSBtZXRob2QgaXMgZGVmaW5lZCwgdGhlIHRlc3QgcnVubmVyIHdpbGwgcnVuIHRoYXQgbWV0aG9kCiAgICAjIHByaW9yIHRvIGVhY2ggdGVzdC4gTGlrZXdpc2UsIGlmIGEgdGVhckRvd24oKSBtZXRob2QgaXMgZGVmaW5lZCwgdGhlCiAgICAjIHRlc3QgcnVubmVyIHdpbGwgaW52b2tlIHRoYXQgbWV0aG9kIGFmdGVyIGVhY2ggdGVzdC4gSW4gdGhlIGV4YW1wbGUsCiAgICAjIHNldFVwKCkgd2FzIHVzZWQgdG8gY3JlYXRlIGEgZnJlc2ggc2VxdWVuY2UgZm9yIGVhY2ggdGVzdC4iCiAgICAjCiAgICAjIE1ha2Ugc3VyZSB0aGUgcHJvcGVyIGNhbGwgb3JkZXIgaXMgbWFpbnRhaW5lZCwgZXZlbiBpZiB0aGUgdGVzdCByYWlzZXMKICAgICMgYW4gZXJyb3IgKGFzIG9wcG9zZWQgdG8gYSBmYWlsdXJlKS4KICAgIGRlZiB0ZXN0X3J1bl9jYWxsX29yZGVyX19lcnJvcl9pbl90ZXN0KHNlbGYpOgogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCgogICAgICAgIGNsYXNzIEZvbyhUZXN0LkxvZ2dpbmdUZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgc3VwZXIoRm9vLCBzZWxmKS50ZXN0KCkKICAgICAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigncmFpc2VkIGJ5IEZvby50ZXN0JykKCiAgICAgICAgZXhwZWN0ZWQgPSBbJ3N0YXJ0VGVzdCcsICdzZXRVcCcsICd0ZXN0JywgJ3RlYXJEb3duJywKICAgICAgICAgICAgICAgICAgICAnYWRkRXJyb3InLCAnc3RvcFRlc3QnXQogICAgICAgIEZvbyhldmVudHMpLnJ1bihyZXN1bHQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIGV4cGVjdGVkKQoKICAgICMgIldpdGggYSBkZWZhdWx0IHJlc3VsdCwgYW4gZXJyb3IgaW4gdGhlIHRlc3Qgc3RpbGwgcmVzdWx0cyBpbiBzdG9wVGVzdFJ1bgogICAgIyBiZWluZyBjYWxsZWQuIgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2Vycm9yX2luX3Rlc3RfZGVmYXVsdF9yZXN1bHQoc2VsZik6CiAgICAgICAgZXZlbnRzID0gW10KCiAgICAgICAgY2xhc3MgRm9vKFRlc3QuTG9nZ2luZ1Rlc3RDYXNlKToKICAgICAgICAgICAgZGVmIGRlZmF1bHRUZXN0UmVzdWx0KHNlbGYpOgogICAgICAgICAgICAgICAgcmV0dXJuIExvZ2dpbmdSZXN1bHQoc2VsZi5ldmVudHMpCgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHN1cGVyKEZvbywgc2VsZikudGVzdCgpCiAgICAgICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoJ3JhaXNlZCBieSBGb28udGVzdCcpCgogICAgICAgIGV4cGVjdGVkID0gWydzdGFydFRlc3RSdW4nLCAnc3RhcnRUZXN0JywgJ3NldFVwJywgJ3Rlc3QnLAogICAgICAgICAgICAgICAgICAgICd0ZWFyRG93bicsICdhZGRFcnJvcicsICdzdG9wVGVzdCcsICdzdG9wVGVzdFJ1biddCiAgICAgICAgRm9vKGV2ZW50cykucnVuKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywgZXhwZWN0ZWQpCgogICAgIyAiV2hlbiBhIHNldFVwKCkgbWV0aG9kIGlzIGRlZmluZWQsIHRoZSB0ZXN0IHJ1bm5lciB3aWxsIHJ1biB0aGF0IG1ldGhvZAogICAgIyBwcmlvciB0byBlYWNoIHRlc3QuIExpa2V3aXNlLCBpZiBhIHRlYXJEb3duKCkgbWV0aG9kIGlzIGRlZmluZWQsIHRoZQogICAgIyB0ZXN0IHJ1bm5lciB3aWxsIGludm9rZSB0aGF0IG1ldGhvZCBhZnRlciBlYWNoIHRlc3QuIEluIHRoZSBleGFtcGxlLAogICAgIyBzZXRVcCgpIHdhcyB1c2VkIHRvIGNyZWF0ZSBhIGZyZXNoIHNlcXVlbmNlIGZvciBlYWNoIHRlc3QuIgogICAgIwogICAgIyBNYWtlIHN1cmUgdGhlIHByb3BlciBjYWxsIG9yZGVyIGlzIG1haW50YWluZWQsIGV2ZW4gaWYgdGhlIHRlc3Qgc2lnbmFscwogICAgIyBhIGZhaWx1cmUgKGFzIG9wcG9zZWQgdG8gYW4gZXJyb3IpLgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2ZhaWx1cmVfaW5fdGVzdChzZWxmKToKICAgICAgICBldmVudHMgPSBbXQogICAgICAgIHJlc3VsdCA9IExvZ2dpbmdSZXN1bHQoZXZlbnRzKQoKICAgICAgICBjbGFzcyBGb28oVGVzdC5Mb2dnaW5nVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHN1cGVyKEZvbywgc2VsZikudGVzdCgpCiAgICAgICAgICAgICAgICBzZWxmLmZhaWwoJ3JhaXNlZCBieSBGb28udGVzdCcpCgogICAgICAgIGV4cGVjdGVkID0gWydzdGFydFRlc3QnLCAnc2V0VXAnLCAndGVzdCcsICd0ZWFyRG93bicsCiAgICAgICAgICAgICAgICAgICAgJ2FkZEZhaWx1cmUnLCAnc3RvcFRlc3QnXQogICAgICAgIEZvbyhldmVudHMpLnJ1bihyZXN1bHQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIGV4cGVjdGVkKQoKICAgICMgIldoZW4gYSB0ZXN0IGZhaWxzIHdpdGggYSBkZWZhdWx0IHJlc3VsdCBzdG9wVGVzdFJ1biBpcyBzdGlsbCBjYWxsZWQuIgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2ZhaWx1cmVfaW5fdGVzdF9kZWZhdWx0X3Jlc3VsdChzZWxmKToKCiAgICAgICAgY2xhc3MgRm9vKFRlc3QuTG9nZ2luZ1Rlc3RDYXNlKToKICAgICAgICAgICAgZGVmIGRlZmF1bHRUZXN0UmVzdWx0KHNlbGYpOgogICAgICAgICAgICAgICAgcmV0dXJuIExvZ2dpbmdSZXN1bHQoc2VsZi5ldmVudHMpCiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgc3VwZXIoRm9vLCBzZWxmKS50ZXN0KCkKICAgICAgICAgICAgICAgIHNlbGYuZmFpbCgncmFpc2VkIGJ5IEZvby50ZXN0JykKCiAgICAgICAgZXhwZWN0ZWQgPSBbJ3N0YXJ0VGVzdFJ1bicsICdzdGFydFRlc3QnLCAnc2V0VXAnLCAndGVzdCcsCiAgICAgICAgICAgICAgICAgICAgJ3RlYXJEb3duJywgJ2FkZEZhaWx1cmUnLCAnc3RvcFRlc3QnLCAnc3RvcFRlc3RSdW4nXQogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgRm9vKGV2ZW50cykucnVuKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywgZXhwZWN0ZWQpCgogICAgIyAiV2hlbiBhIHNldFVwKCkgbWV0aG9kIGlzIGRlZmluZWQsIHRoZSB0ZXN0IHJ1bm5lciB3aWxsIHJ1biB0aGF0IG1ldGhvZAogICAgIyBwcmlvciB0byBlYWNoIHRlc3QuIExpa2V3aXNlLCBpZiBhIHRlYXJEb3duKCkgbWV0aG9kIGlzIGRlZmluZWQsIHRoZQogICAgIyB0ZXN0IHJ1bm5lciB3aWxsIGludm9rZSB0aGF0IG1ldGhvZCBhZnRlciBlYWNoIHRlc3QuIEluIHRoZSBleGFtcGxlLAogICAgIyBzZXRVcCgpIHdhcyB1c2VkIHRvIGNyZWF0ZSBhIGZyZXNoIHNlcXVlbmNlIGZvciBlYWNoIHRlc3QuIgogICAgIwogICAgIyBNYWtlIHN1cmUgdGhlIHByb3BlciBjYWxsIG9yZGVyIGlzIG1haW50YWluZWQsIGV2ZW4gaWYgdGVhckRvd24oKSByYWlzZXMKICAgICMgYW4gZXhjZXB0aW9uLgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2Vycm9yX2luX3RlYXJEb3duKHNlbGYpOgogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCgogICAgICAgIGNsYXNzIEZvbyhUZXN0LkxvZ2dpbmdUZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZWFyRG93bihzZWxmKToKICAgICAgICAgICAgICAgIHN1cGVyKEZvbywgc2VsZikudGVhckRvd24oKQogICAgICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCdyYWlzZWQgYnkgRm9vLnRlYXJEb3duJykKCiAgICAgICAgRm9vKGV2ZW50cykucnVuKHJlc3VsdCkKICAgICAgICBleHBlY3RlZCA9IFsnc3RhcnRUZXN0JywgJ3NldFVwJywgJ3Rlc3QnLCAndGVhckRvd24nLCAnYWRkRXJyb3InLAogICAgICAgICAgICAgICAgICAgICdzdG9wVGVzdCddCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIGV4cGVjdGVkKQoKICAgICMgIldoZW4gdGVhckRvd24gZXJyb3JzIHdpdGggYSBkZWZhdWx0IHJlc3VsdCBzdG9wVGVzdFJ1biBpcyBzdGlsbCBjYWxsZWQuIgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2Vycm9yX2luX3RlYXJEb3duX2RlZmF1bHRfcmVzdWx0KHNlbGYpOgoKICAgICAgICBjbGFzcyBGb28oVGVzdC5Mb2dnaW5nVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgZGVmYXVsdFRlc3RSZXN1bHQoc2VsZik6CiAgICAgICAgICAgICAgICByZXR1cm4gTG9nZ2luZ1Jlc3VsdChzZWxmLmV2ZW50cykKICAgICAgICAgICAgZGVmIHRlYXJEb3duKHNlbGYpOgogICAgICAgICAgICAgICAgc3VwZXIoRm9vLCBzZWxmKS50ZWFyRG93bigpCiAgICAgICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoJ3JhaXNlZCBieSBGb28udGVhckRvd24nKQoKICAgICAgICBldmVudHMgPSBbXQogICAgICAgIEZvbyhldmVudHMpLnJ1bigpCiAgICAgICAgZXhwZWN0ZWQgPSBbJ3N0YXJ0VGVzdFJ1bicsICdzdGFydFRlc3QnLCAnc2V0VXAnLCAndGVzdCcsICd0ZWFyRG93bicsCiAgICAgICAgICAgICAgICAgICAgJ2FkZEVycm9yJywgJ3N0b3BUZXN0JywgJ3N0b3BUZXN0UnVuJ10KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywgZXhwZWN0ZWQpCgogICAgIyAiVGVzdENhc2UucnVuKCkgc3RpbGwgd29ya3Mgd2hlbiB0aGUgZGVmYXVsdFRlc3RSZXN1bHQgaXMgYSBUZXN0UmVzdWx0CiAgICAjIHRoYXQgZG9lcyBub3Qgc3VwcG9ydCBzdGFydFRlc3RSdW4gYW5kIHN0b3BUZXN0UnVuLgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfZGVmYXVsdF9yZXN1bHQoc2VsZik6CgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBkZWZhdWx0VGVzdFJlc3VsdChzZWxmKToKICAgICAgICAgICAgICAgIHJldHVybiBSZXN1bHRXaXRoTm9TdGFydFRlc3RSdW5TdG9wVGVzdFJ1bigpCiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBGb28oJ3Rlc3QnKS5ydW4oKQoKICAgICMgIlRoaXMgY2xhc3MgYXR0cmlidXRlIGdpdmVzIHRoZSBleGNlcHRpb24gcmFpc2VkIGJ5IHRoZSB0ZXN0KCkgbWV0aG9kLgogICAgIyBJZiBhIHRlc3QgZnJhbWV3b3JrIG5lZWRzIHRvIHVzZSBhIHNwZWNpYWxpemVkIGV4Y2VwdGlvbiwgcG9zc2libHkgdG8KICAgICMgY2FycnkgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiwgaXQgbXVzdCBzdWJjbGFzcyB0aGlzIGV4Y2VwdGlvbiBpbgogICAgIyBvcmRlciB0byBgYHBsYXkgZmFpcicnIHdpdGggdGhlIGZyYW1ld29yay4gIFRoZSBpbml0aWFsIHZhbHVlIG9mIHRoaXMKICAgICMgYXR0cmlidXRlIGlzIEFzc2VydGlvbkVycm9yIgogICAgZGVmIHRlc3RfZmFpbHVyZUV4Y2VwdGlvbl9fZGVmYXVsdChzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKEZvbygndGVzdCcpLmZhaWx1cmVFeGNlcHRpb24gaXMgQXNzZXJ0aW9uRXJyb3IpCgogICAgIyAiVGhpcyBjbGFzcyBhdHRyaWJ1dGUgZ2l2ZXMgdGhlIGV4Y2VwdGlvbiByYWlzZWQgYnkgdGhlIHRlc3QoKSBtZXRob2QuCiAgICAjIElmIGEgdGVzdCBmcmFtZXdvcmsgbmVlZHMgdG8gdXNlIGEgc3BlY2lhbGl6ZWQgZXhjZXB0aW9uLCBwb3NzaWJseSB0bwogICAgIyBjYXJyeSBhZGRpdGlvbmFsIGluZm9ybWF0aW9uLCBpdCBtdXN0IHN1YmNsYXNzIHRoaXMgZXhjZXB0aW9uIGluCiAgICAjIG9yZGVyIHRvIGBgcGxheSBmYWlyJycgd2l0aCB0aGUgZnJhbWV3b3JrLiIKICAgICMKICAgICMgTWFrZSBzdXJlIFRlc3RDYXNlLnJ1bigpIHJlc3BlY3RzIHRoZSBkZXNpZ25hdGVkIGZhaWx1cmVFeGNlcHRpb24KICAgIGRlZiB0ZXN0X2ZhaWx1cmVFeGNlcHRpb25fX3N1YmNsYXNzaW5nX19leHBsaWNpdF9yYWlzZShzZWxmKToKICAgICAgICBldmVudHMgPSBbXQogICAgICAgIHJlc3VsdCA9IExvZ2dpbmdSZXN1bHQoZXZlbnRzKQoKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigpCgogICAgICAgICAgICBmYWlsdXJlRXhjZXB0aW9uID0gUnVudGltZUVycm9yCgogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShGb28oJ3Rlc3QnKS5mYWlsdXJlRXhjZXB0aW9uIGlzIFJ1bnRpbWVFcnJvcikKCgogICAgICAgIEZvbygndGVzdCcpLnJ1bihyZXN1bHQpCiAgICAgICAgZXhwZWN0ZWQgPSBbJ3N0YXJ0VGVzdCcsICdhZGRGYWlsdXJlJywgJ3N0b3BUZXN0J10KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywgZXhwZWN0ZWQpCgogICAgIyAiVGhpcyBjbGFzcyBhdHRyaWJ1dGUgZ2l2ZXMgdGhlIGV4Y2VwdGlvbiByYWlzZWQgYnkgdGhlIHRlc3QoKSBtZXRob2QuCiAgICAjIElmIGEgdGVzdCBmcmFtZXdvcmsgbmVlZHMgdG8gdXNlIGEgc3BlY2lhbGl6ZWQgZXhjZXB0aW9uLCBwb3NzaWJseSB0bwogICAgIyBjYXJyeSBhZGRpdGlvbmFsIGluZm9ybWF0aW9uLCBpdCBtdXN0IHN1YmNsYXNzIHRoaXMgZXhjZXB0aW9uIGluCiAgICAjIG9yZGVyIHRvIGBgcGxheSBmYWlyJycgd2l0aCB0aGUgZnJhbWV3b3JrLiIKICAgICMKICAgICMgTWFrZSBzdXJlIFRlc3RDYXNlLnJ1bigpIHJlc3BlY3RzIHRoZSBkZXNpZ25hdGVkIGZhaWx1cmVFeGNlcHRpb24KICAgIGRlZiB0ZXN0X2ZhaWx1cmVFeGNlcHRpb25fX3N1YmNsYXNzaW5nX19pbXBsaWNpdF9yYWlzZShzZWxmKToKICAgICAgICBldmVudHMgPSBbXQogICAgICAgIHJlc3VsdCA9IExvZ2dpbmdSZXN1bHQoZXZlbnRzKQoKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHNlbGYuZmFpbCgiZm9vIikKCiAgICAgICAgICAgIGZhaWx1cmVFeGNlcHRpb24gPSBSdW50aW1lRXJyb3IKCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKEZvbygndGVzdCcpLmZhaWx1cmVFeGNlcHRpb24gaXMgUnVudGltZUVycm9yKQoKCiAgICAgICAgRm9vKCd0ZXN0JykucnVuKHJlc3VsdCkKICAgICAgICBleHBlY3RlZCA9IFsnc3RhcnRUZXN0JywgJ2FkZEZhaWx1cmUnLCAnc3RvcFRlc3QnXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZXZlbnRzLCBleHBlY3RlZCkKCiAgICAjICJUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBkb2VzIG5vdGhpbmcuIgogICAgZGVmIHRlc3Rfc2V0VXAoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHJ1blRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgICMgLi4uIGFuZCBub3RoaW5nIHNob3VsZCBoYXBwZW4KICAgICAgICBGb28oKS5zZXRVcCgpCgogICAgIyAiVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gZG9lcyBub3RoaW5nLiIKICAgIGRlZiB0ZXN0X3RlYXJEb3duKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBydW5UZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICAjIC4uLiBhbmQgbm90aGluZyBzaG91bGQgaGFwcGVuCiAgICAgICAgRm9vKCkudGVhckRvd24oKQoKICAgICMgIlJldHVybiBhIHN0cmluZyBpZGVudGlmeWluZyB0aGUgc3BlY2lmaWMgdGVzdCBjYXNlLiIKICAgICMKICAgICMgQmVjYXVzZSBvZiB0aGUgdmFndWUgbmF0dXJlIG9mIHRoZSBkb2NzLCBJJ20gbm90IGdvaW5nIHRvIGxvY2sgdGhpcwogICAgIyB0ZXN0IGRvd24gdG9vIG11Y2guIFJlYWxseSBhbGwgdGhhdCBjYW4gYmUgYXNzZXJ0ZWQgaXMgdGhhdCB0aGUgaWQoKQogICAgIyB3aWxsIGJlIGEgc3RyaW5nIChlaXRoZXIgOC1ieXRlIG9yIHVuaWNvZGUgLS0gYWdhaW4sIGJlY2F1c2UgdGhlIGRvY3MKICAgICMganVzdCBzYXkgInN0cmluZyIpCiAgICBkZWYgdGVzdF9pZChzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgcnVuVGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKEZvbygpLmlkKCksIHN0cikKCgogICAgIyAiSWYgcmVzdWx0IGlzIG9taXR0ZWQgb3IgTm9uZSwgYSB0ZW1wb3JhcnkgcmVzdWx0IG9iamVjdCBpcyBjcmVhdGVkLAogICAgIyB1c2VkLCBhbmQgaXMgbWFkZSBhdmFpbGFibGUgdG8gdGhlIGNhbGxlci4gQXMgVGVzdENhc2Ugb3ducyB0aGUKICAgICMgdGVtcG9yYXJ5IHJlc3VsdCBzdGFydFRlc3RSdW4gYW5kIHN0b3BUZXN0UnVuIGFyZSBjYWxsZWQuCgogICAgZGVmIHRlc3RfcnVuX191c2VzX2RlZmF1bHRUZXN0UmVzdWx0KHNlbGYpOgogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgZGVmYXVsdFJlc3VsdCA9IExvZ2dpbmdSZXN1bHQoZXZlbnRzKQoKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIGV2ZW50cy5hcHBlbmQoJ3Rlc3QnKQoKICAgICAgICAgICAgZGVmIGRlZmF1bHRUZXN0UmVzdWx0KHNlbGYpOgogICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRSZXN1bHQKCiAgICAgICAgIyBNYWtlIHJ1bigpIGZpbmQgYSByZXN1bHQgb2JqZWN0IG9uIGl0cyBvd24KICAgICAgICByZXN1bHQgPSBGb28oJ3Rlc3QnKS5ydW4oKQoKICAgICAgICBzZWxmLmFzc2VydElzKHJlc3VsdCwgZGVmYXVsdFJlc3VsdCkKICAgICAgICBleHBlY3RlZCA9IFsnc3RhcnRUZXN0UnVuJywgJ3N0YXJ0VGVzdCcsICd0ZXN0JywgJ2FkZFN1Y2Nlc3MnLAogICAgICAgICAgICAnc3RvcFRlc3QnLCAnc3RvcFRlc3RSdW4nXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZXZlbnRzLCBleHBlY3RlZCkKCgogICAgIyAiVGhlIHJlc3VsdCBvYmplY3QgaXMgcmV0dXJuZWQgdG8gcnVuJ3MgY2FsbGVyIgogICAgZGVmIHRlc3RfcnVuX19yZXR1cm5zX2dpdmVuX3Jlc3VsdChzZWxmKToKCiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQoKICAgICAgICByZXR2YWwgPSBGb28oJ3Rlc3QnKS5ydW4ocmVzdWx0KQogICAgICAgIHNlbGYuYXNzZXJ0SXMocmV0dmFsLCByZXN1bHQpCgoKICAgICMgIlRoZSBzYW1lIGVmZmVjdCBbYXMgbWV0aG9kIHJ1bl0gbWF5IGJlIGhhZCBieSBzaW1wbHkgY2FsbGluZyB0aGUKICAgICMgVGVzdENhc2UgaW5zdGFuY2UuIgogICAgZGVmIHRlc3RfY2FsbF9faW52b2tpbmdfYW5faW5zdGFuY2VfZGVsZWdhdGVzX3RvX3J1bihzZWxmKToKICAgICAgICByZXN1bHRJbiA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHJlc3VsdE91dCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQoKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgICAgIGRlZiBydW4oc2VsZiwgcmVzdWx0KToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMocmVzdWx0LCByZXN1bHRJbikKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRPdXQKCiAgICAgICAgcmV0dmFsID0gRm9vKCd0ZXN0JykocmVzdWx0SW4pCgogICAgICAgIHNlbGYuYXNzZXJ0SXMocmV0dmFsLCByZXN1bHRPdXQpCgoKICAgIGRlZiB0ZXN0U2hvcnREZXNjcmlwdGlvbldpdGhvdXREb2NzdHJpbmcoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRJc05vbmUoc2VsZi5zaG9ydERlc2NyaXB0aW9uKCkpCgogICAgQHVuaXR0ZXN0LnNraXBJZihzeXMuZmxhZ3Mub3B0aW1pemUgPj0gMiwKICAgICAgICAgICAgICAgICAgICAgIkRvY3N0cmluZ3MgYXJlIG9taXR0ZWQgd2l0aCAtTzIgYW5kIGFib3ZlIikKICAgIGRlZiB0ZXN0U2hvcnREZXNjcmlwdGlvbldpdGhPbmVMaW5lRG9jc3RyaW5nKHNlbGYpOgogICAgICAgICIiIlRlc3RzIHNob3J0RGVzY3JpcHRpb24oKSBmb3IgYSBtZXRob2Qgd2l0aCBhIGRvY3N0cmluZy4iIiIKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKAogICAgICAgICAgICAgICAgc2VsZi5zaG9ydERlc2NyaXB0aW9uKCksCiAgICAgICAgICAgICAgICAnVGVzdHMgc2hvcnREZXNjcmlwdGlvbigpIGZvciBhIG1ldGhvZCB3aXRoIGEgZG9jc3RyaW5nLicpCgogICAgQHVuaXR0ZXN0LnNraXBJZihzeXMuZmxhZ3Mub3B0aW1pemUgPj0gMiwKICAgICAgICAgICAgICAgICAgICAgIkRvY3N0cmluZ3MgYXJlIG9taXR0ZWQgd2l0aCAtTzIgYW5kIGFib3ZlIikKICAgIGRlZiB0ZXN0U2hvcnREZXNjcmlwdGlvbldpdGhNdWx0aUxpbmVEb2NzdHJpbmcoc2VsZik6CiAgICAgICAgIiIiVGVzdHMgc2hvcnREZXNjcmlwdGlvbigpIGZvciBhIG1ldGhvZCB3aXRoIGEgbG9uZ2VyIGRvY3N0cmluZy4KCiAgICAgICAgVGhpcyBtZXRob2QgZW5zdXJlcyB0aGF0IG9ubHkgdGhlIGZpcnN0IGxpbmUgb2YgYSBkb2NzdHJpbmcgaXMKICAgICAgICByZXR1cm5lZCB1c2VkIGluIHRoZSBzaG9ydCBkZXNjcmlwdGlvbiwgbm8gbWF0dGVyIGhvdyBsb25nIHRoZQogICAgICAgIHdob2xlIHRoaW5nIGlzLgogICAgICAgICIiIgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoCiAgICAgICAgICAgICAgICBzZWxmLnNob3J0RGVzY3JpcHRpb24oKSwKICAgICAgICAgICAgICAgICAnVGVzdHMgc2hvcnREZXNjcmlwdGlvbigpIGZvciBhIG1ldGhvZCB3aXRoIGEgbG9uZ2VyICcKICAgICAgICAgICAgICAgICAnZG9jc3RyaW5nLicpCgogICAgZGVmIHRlc3RBZGRUeXBlRXF1YWxpdHlGdW5jKHNlbGYpOgogICAgICAgIGNsYXNzIFNhZFNuYWtlKG9iamVjdCk6CiAgICAgICAgICAgICIiIkR1bW15IGNsYXNzIGZvciB0ZXN0X2FkZFR5cGVFcXVhbGl0eUZ1bmMuIiIiCiAgICAgICAgczEsIHMyID0gU2FkU25ha2UoKSwgU2FkU25ha2UoKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoczEgPT0gczIpCiAgICAgICAgZGVmIEFsbFNuYWtlc0NyZWF0ZWRFcXVhbChhLCBiLCBtc2c9Tm9uZSk6CiAgICAgICAgICAgIHJldHVybiB0eXBlKGEpID09IHR5cGUoYikgPT0gU2FkU25ha2UKICAgICAgICBzZWxmLmFkZFR5cGVFcXVhbGl0eUZ1bmMoU2FkU25ha2UsIEFsbFNuYWtlc0NyZWF0ZWRFcXVhbCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHMxLCBzMikKICAgICAgICAjIE5vIHRoaXMgZG9lc24ndCBjbGVhbiB1cCBhbmQgcmVtb3ZlIHRoZSBTYWRTbmFrZSBlcXVhbGl0eSBmdW5jCiAgICAgICAgIyBmcm9tIHRoaXMgVGVzdENhc2UgaW5zdGFuY2UgYnV0IHNpbmNlIGl0cyBhIGxvY2FsIG5vdGhpbmcgZWxzZQogICAgICAgICMgd2lsbCBldmVyIG5vdGljZSB0aGF0LgoKICAgIGRlZiB0ZXN0QXNzZXJ0SXMoc2VsZik6CiAgICAgICAgdGhpbmcgPSBvYmplY3QoKQogICAgICAgIHNlbGYuYXNzZXJ0SXModGhpbmcsIHRoaW5nKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRJcywgdGhpbmcsIG9iamVjdCgpKQoKICAgIGRlZiB0ZXN0QXNzZXJ0SXNOb3Qoc2VsZik6CiAgICAgICAgdGhpbmcgPSBvYmplY3QoKQogICAgICAgIHNlbGYuYXNzZXJ0SXNOb3QodGhpbmcsIG9iamVjdCgpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRJc05vdCwgdGhpbmcsIHRoaW5nKQoKICAgIGRlZiB0ZXN0QXNzZXJ0SXNJbnN0YW5jZShzZWxmKToKICAgICAgICB0aGluZyA9IFtdCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHRoaW5nLCBsaXN0KQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRJc0luc3RhbmNlLAogICAgICAgICAgICAgICAgICAgICAgICAgIHRoaW5nLCBkaWN0KQoKICAgIGRlZiB0ZXN0QXNzZXJ0Tm90SXNJbnN0YW5jZShzZWxmKToKICAgICAgICB0aGluZyA9IFtdCiAgICAgICAgc2VsZi5hc3NlcnROb3RJc0luc3RhbmNlKHRoaW5nLCBkaWN0KQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnROb3RJc0luc3RhbmNlLAogICAgICAgICAgICAgICAgICAgICAgICAgIHRoaW5nLCBsaXN0KQoKICAgIGRlZiB0ZXN0QXNzZXJ0SW4oc2VsZik6CiAgICAgICAgYW5pbWFscyA9IHsnbW9ua2V5JzogJ2JhbmFuYScsICdjb3cnOiAnZ3Jhc3MnLCAnc2VhbCc6ICdmaXNoJ30KCiAgICAgICAgc2VsZi5hc3NlcnRJbignYScsICdhYmMnKQogICAgICAgIHNlbGYuYXNzZXJ0SW4oMiwgWzEsIDIsIDNdKQogICAgICAgIHNlbGYuYXNzZXJ0SW4oJ21vbmtleScsIGFuaW1hbHMpCgogICAgICAgIHNlbGYuYXNzZXJ0Tm90SW4oJ2QnLCAnYWJjJykKICAgICAgICBzZWxmLmFzc2VydE5vdEluKDAsIFsxLCAyLCAzXSkKICAgICAgICBzZWxmLmFzc2VydE5vdEluKCdvdHRlcicsIGFuaW1hbHMpCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRJbiwgJ3gnLCAnYWJjJykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0SW4sIDQsIFsxLCAyLCAzXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0SW4sICdlbGVwaGFudCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWFscykKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydE5vdEluLCAnYycsICdhYmMnKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnROb3RJbiwgMSwgWzEsIDIsIDNdKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnROb3RJbiwgJ2NvdycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWFscykKCiAgICBkZWYgdGVzdEFzc2VydERpY3RDb250YWluc1N1YnNldChzZWxmKToKICAgICAgICB3aXRoIHdhcm5pbmdzLmNhdGNoX3dhcm5pbmdzKCk6CiAgICAgICAgICAgIHdhcm5pbmdzLnNpbXBsZWZpbHRlcigiaWdub3JlIiwgRGVwcmVjYXRpb25XYXJuaW5nKQoKICAgICAgICAgICAgc2VsZi5hc3NlcnREaWN0Q29udGFpbnNTdWJzZXQoe30sIHt9KQogICAgICAgICAgICBzZWxmLmFzc2VydERpY3RDb250YWluc1N1YnNldCh7fSwgeydhJzogMX0pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0KHsnYSc6IDF9LCB7J2EnOiAxfSkKICAgICAgICAgICAgc2VsZi5hc3NlcnREaWN0Q29udGFpbnNTdWJzZXQoeydhJzogMX0sIHsnYSc6IDEsICdiJzogMn0pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0KHsnYSc6IDEsICdiJzogMn0sIHsnYSc6IDEsICdiJzogMn0pCgogICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbik6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydERpY3RDb250YWluc1N1YnNldCh7MTogIm9uZSJ9LCB7fSkKCiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0KHsnYSc6IDJ9LCB7J2EnOiAxfSkKCiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0KHsnYyc6IDF9LCB7J2EnOiAxfSkKCiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0KHsnYSc6IDEsICdjJzogMX0sIHsnYSc6IDF9KQoKICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24pOgogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnREaWN0Q29udGFpbnNTdWJzZXQoeydhJzogMSwgJ2MnOiAxfSwgeydhJzogMX0pCgogICAgICAgICAgICBvbmUgPSAnJy5qb2luKGNocihpKSBmb3IgaSBpbiByYW5nZSgyNTUpKQogICAgICAgICAgICAjIHRoaXMgdXNlZCB0byBjYXVzZSBhIFVuaWNvZGVEZWNvZGVFcnJvciBjb25zdHJ1Y3RpbmcgdGhlIGZhaWx1cmUgbXNnCiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0KHsnZm9vJzogb25lfSwgeydmb28nOiAnXHVGRkZEJ30pCgogICAgZGVmIHRlc3RBc3NlcnRFcXVhbChzZWxmKToKICAgICAgICBlcXVhbF9wYWlycyA9IFsKICAgICAgICAgICAgICAgICgoKSwgKCkpLAogICAgICAgICAgICAgICAgKHt9LCB7fSksCiAgICAgICAgICAgICAgICAoW10sIFtdKSwKICAgICAgICAgICAgICAgIChzZXQoKSwgc2V0KCkpLAogICAgICAgICAgICAgICAgKGZyb3plbnNldCgpLCBmcm96ZW5zZXQoKSldCiAgICAgICAgZm9yIGEsIGIgaW4gZXF1YWxfcGFpcnM6CiAgICAgICAgICAgICMgVGhpcyBtZXNzIG9mIHRyeSBleGNlcHRzIGlzIHRvIHRlc3QgdGhlIGFzc2VydEVxdWFsIGJlaGF2aW9yCiAgICAgICAgICAgICMgaXRzZWxmLgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGEsIGIpCiAgICAgICAgICAgIGV4Y2VwdCBzZWxmLmZhaWx1cmVFeGNlcHRpb246CiAgICAgICAgICAgICAgICBzZWxmLmZhaWwoJ2Fzc2VydEVxdWFsKCVyLCAlcikgZmFpbGVkJyAlIChhLCBiKSkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhLCBiLCBtc2c9J2ZvbycpCiAgICAgICAgICAgIGV4Y2VwdCBzZWxmLmZhaWx1cmVFeGNlcHRpb246CiAgICAgICAgICAgICAgICBzZWxmLmZhaWwoJ2Fzc2VydEVxdWFsKCVyLCAlcikgd2l0aCBtc2c9IGZhaWxlZCcgJSAoYSwgYikpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYSwgYiwgJ2ZvbycpCiAgICAgICAgICAgIGV4Y2VwdCBzZWxmLmZhaWx1cmVFeGNlcHRpb246CiAgICAgICAgICAgICAgICBzZWxmLmZhaWwoJ2Fzc2VydEVxdWFsKCVyLCAlcikgd2l0aCB0aGlyZCBwYXJhbWV0ZXIgZmFpbGVkJyAlCiAgICAgICAgICAgICAgICAgICAgICAgICAgKGEsIGIpKQoKICAgICAgICB1bmVxdWFsX3BhaXJzID0gWwogICAgICAgICAgICAgICAoKCksIFtdKSwKICAgICAgICAgICAgICAgKHt9LCBzZXQoKSksCiAgICAgICAgICAgICAgIChzZXQoWzQsMV0pLCBmcm96ZW5zZXQoWzQsMl0pKSwKICAgICAgICAgICAgICAgKGZyb3plbnNldChbNCw1XSksIHNldChbMiwzXSkpLAogICAgICAgICAgICAgICAoc2V0KFszLDRdKSwgc2V0KFs1LDRdKSldCiAgICAgICAgZm9yIGEsIGIgaW4gdW5lcXVhbF9wYWlyczoKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydEVxdWFsLCBhLCBiKQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0RXF1YWwsIGEsIGIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmb28nKQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0RXF1YWwsIGEsIGIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZz0nZm9vJykKCiAgICBkZWYgdGVzdEVxdWFsaXR5KHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0TGlzdEVxdWFsKFtdLCBbXSkKICAgICAgICBzZWxmLmFzc2VydFR1cGxlRXF1YWwoKCksICgpKQogICAgICAgIHNlbGYuYXNzZXJ0U2VxdWVuY2VFcXVhbChbXSwgKCkpCgogICAgICAgIGEgPSBbMCwgJ2EnLCBbXV0KICAgICAgICBiID0gW10KICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyh1bml0dGVzdC5UZXN0Q2FzZS5mYWlsdXJlRXhjZXB0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0TGlzdEVxdWFsLCBhLCBiKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHVuaXR0ZXN0LlRlc3RDYXNlLmZhaWx1cmVFeGNlcHRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRMaXN0RXF1YWwsIHR1cGxlKGEpLCB0dXBsZShiKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyh1bml0dGVzdC5UZXN0Q2FzZS5mYWlsdXJlRXhjZXB0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0U2VxdWVuY2VFcXVhbCwgYSwgdHVwbGUoYikpCgogICAgICAgIGIuZXh0ZW5kKGEpCiAgICAgICAgc2VsZi5hc3NlcnRMaXN0RXF1YWwoYSwgYikKICAgICAgICBzZWxmLmFzc2VydFR1cGxlRXF1YWwodHVwbGUoYSksIHR1cGxlKGIpKQogICAgICAgIHNlbGYuYXNzZXJ0U2VxdWVuY2VFcXVhbChhLCB0dXBsZShiKSkKICAgICAgICBzZWxmLmFzc2VydFNlcXVlbmNlRXF1YWwodHVwbGUoYSksIGIpCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRMaXN0RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgYSwgdHVwbGUoYikpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydFR1cGxlRXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgdHVwbGUoYSksIGIpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydExpc3RFcXVhbCwgTm9uZSwgYikKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0VHVwbGVFcXVhbCwgTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICB0dXBsZShiKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0U2VxdWVuY2VFcXVhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICBOb25lLCB0dXBsZShiKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0TGlzdEVxdWFsLCAxLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRUdXBsZUVxdWFsLCAxLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRTZXF1ZW5jZUVxdWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgIDEsIDEpCgogICAgICAgIHNlbGYuYXNzZXJ0RGljdEVxdWFsKHt9LCB7fSkKCiAgICAgICAgYyA9IHsgJ3gnOiAxIH0KICAgICAgICBkID0ge30KICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyh1bml0dGVzdC5UZXN0Q2FzZS5mYWlsdXJlRXhjZXB0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RGljdEVxdWFsLCBjLCBkKQoKICAgICAgICBkLnVwZGF0ZShjKQogICAgICAgIHNlbGYuYXNzZXJ0RGljdEVxdWFsKGMsIGQpCgogICAgICAgIGRbJ3gnXSA9IDAKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyh1bml0dGVzdC5UZXN0Q2FzZS5mYWlsdXJlRXhjZXB0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RGljdEVxdWFsLCBjLCBkLCAnVGhlc2UgYXJlIHVuZXF1YWwnKQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0RGljdEVxdWFsLCBOb25lLCBkKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnREaWN0RXF1YWwsIFtdLCBkKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnREaWN0RXF1YWwsIDEsIDEpCgogICAgZGVmIHRlc3RBc3NlcnRTZXF1ZW5jZUVxdWFsTWF4RGlmZihzZWxmKToKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNlbGYubWF4RGlmZiwgODAqOCkKICAgICAgICBzZXExID0gJ2EnICsgJ3gnICogODAqKjIKICAgICAgICBzZXEyID0gJ2InICsgJ3gnICogODAqKjIKICAgICAgICBkaWZmID0gJ1xuJy5qb2luKGRpZmZsaWIubmRpZmYocHByaW50LnBmb3JtYXQoc2VxMSkuc3BsaXRsaW5lcygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcHJpbnQucGZvcm1hdChzZXEyKS5zcGxpdGxpbmVzKCkpKQogICAgICAgICMgdGhlICsxIGlzIHRoZSBsZWFkaW5nIFxuIGFkZGVkIGJ5IGFzc2VydFNlcXVlbmNlRXF1YWwKICAgICAgICBvbWl0dGVkID0gdW5pdHRlc3QuY2FzZS5ESUZGX09NSVRURUQgJSAobGVuKGRpZmYpICsgMSwpCgogICAgICAgIHNlbGYubWF4RGlmZiA9IGxlbihkaWZmKS8vMgogICAgICAgIHRyeToKCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0U2VxdWVuY2VFcXVhbChzZXExLCBzZXEyKQogICAgICAgIGV4Y2VwdCBzZWxmLmZhaWx1cmVFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbXNnID0gZS5hcmdzWzBdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCdhc3NlcnRTZXF1ZW5jZUVxdWFsIGRpZCBub3QgZmFpbC4nKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShsZW4obXNnKSA8IGxlbihkaWZmKSkKICAgICAgICBzZWxmLmFzc2VydEluKG9taXR0ZWQsIG1zZykKCiAgICAgICAgc2VsZi5tYXhEaWZmID0gbGVuKGRpZmYpICogMgogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRTZXF1ZW5jZUVxdWFsKHNlcTEsIHNlcTIpCiAgICAgICAgZXhjZXB0IHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBtc2cgPSBlLmFyZ3NbMF0KICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoJ2Fzc2VydFNlcXVlbmNlRXF1YWwgZGlkIG5vdCBmYWlsLicpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGxlbihtc2cpID4gbGVuKGRpZmYpKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90SW4ob21pdHRlZCwgbXNnKQoKICAgICAgICBzZWxmLm1heERpZmYgPSBOb25lCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmFzc2VydFNlcXVlbmNlRXF1YWwoc2VxMSwgc2VxMikKICAgICAgICBleGNlcHQgc2VsZi5mYWlsdXJlRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIG1zZyA9IGUuYXJnc1swXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgnYXNzZXJ0U2VxdWVuY2VFcXVhbCBkaWQgbm90IGZhaWwuJykKICAgICAgICBzZWxmLmFzc2VydFRydWUobGVuKG1zZykgPiBsZW4oZGlmZikpCiAgICAgICAgc2VsZi5hc3NlcnROb3RJbihvbWl0dGVkLCBtc2cpCgogICAgZGVmIHRlc3RUcnVuY2F0ZU1lc3NhZ2Uoc2VsZik6CiAgICAgICAgc2VsZi5tYXhEaWZmID0gMQogICAgICAgIG1lc3NhZ2UgPSBzZWxmLl90cnVuY2F0ZU1lc3NhZ2UoJ2ZvbycsICdiYXInKQogICAgICAgIG9taXR0ZWQgPSB1bml0dGVzdC5jYXNlLkRJRkZfT01JVFRFRCAlIGxlbignYmFyJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1lc3NhZ2UsICdmb28nICsgb21pdHRlZCkKCiAgICAgICAgc2VsZi5tYXhEaWZmID0gTm9uZQogICAgICAgIG1lc3NhZ2UgPSBzZWxmLl90cnVuY2F0ZU1lc3NhZ2UoJ2ZvbycsICdiYXInKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobWVzc2FnZSwgJ2Zvb2JhcicpCgogICAgICAgIHNlbGYubWF4RGlmZiA9IDQKICAgICAgICBtZXNzYWdlID0gc2VsZi5fdHJ1bmNhdGVNZXNzYWdlKCdmb28nLCAnYmFyJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1lc3NhZ2UsICdmb29iYXInKQoKICAgIGRlZiB0ZXN0QXNzZXJ0RGljdEVxdWFsVHJ1bmNhdGVzKHNlbGYpOgogICAgICAgIHRlc3QgPSB1bml0dGVzdC5UZXN0Q2FzZSgnYXNzZXJ0RXF1YWwnKQogICAgICAgIGRlZiB0cnVuY2F0ZShtc2csIGRpZmYpOgogICAgICAgICAgICByZXR1cm4gJ2ZvbycKICAgICAgICB0ZXN0Ll90cnVuY2F0ZU1lc3NhZ2UgPSB0cnVuY2F0ZQogICAgICAgIHRyeToKICAgICAgICAgICAgdGVzdC5hc3NlcnREaWN0RXF1YWwoe30sIHsxOiAwfSkKICAgICAgICBleGNlcHQgc2VsZi5mYWlsdXJlRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGUpLCAnZm9vJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoJ2Fzc2VydERpY3RFcXVhbCBkaWQgbm90IGZhaWwnKQoKICAgIGRlZiB0ZXN0QXNzZXJ0TXVsdGlMaW5lRXF1YWxUcnVuY2F0ZXMoc2VsZik6CiAgICAgICAgdGVzdCA9IHVuaXR0ZXN0LlRlc3RDYXNlKCdhc3NlcnRFcXVhbCcpCiAgICAgICAgZGVmIHRydW5jYXRlKG1zZywgZGlmZik6CiAgICAgICAgICAgIHJldHVybiAnZm9vJwogICAgICAgIHRlc3QuX3RydW5jYXRlTWVzc2FnZSA9IHRydW5jYXRlCiAgICAgICAgdHJ5OgogICAgICAgICAgICB0ZXN0LmFzc2VydE11bHRpTGluZUVxdWFsKCdmb28nLCAnYmFyJykKICAgICAgICBleGNlcHQgc2VsZi5mYWlsdXJlRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGUpLCAnZm9vJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoJ2Fzc2VydE11bHRpTGluZUVxdWFsIGRpZCBub3QgZmFpbCcpCgogICAgZGVmIHRlc3RBc3NlcnRFcXVhbF9kaWZmVGhyZXNob2xkKHNlbGYpOgogICAgICAgICMgY2hlY2sgdGhyZXNob2xkIHZhbHVlCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzZWxmLl9kaWZmVGhyZXNob2xkLCAyKioxNikKICAgICAgICAjIGRpc2FibGUgbWFkRGlmZiB0byBnZXQgZGlmZiBtYXJrZXJzCiAgICAgICAgc2VsZi5tYXhEaWZmID0gTm9uZQoKICAgICAgICAjIHNldCBhIGxvd2VyIHRocmVzaG9sZCB2YWx1ZSBhbmQgYWRkIGEgY2xlYW51cCB0byByZXN0b3JlIGl0CiAgICAgICAgb2xkX3RocmVzaG9sZCA9IHNlbGYuX2RpZmZUaHJlc2hvbGQKICAgICAgICBzZWxmLl9kaWZmVGhyZXNob2xkID0gMioqOAogICAgICAgIHNlbGYuYWRkQ2xlYW51cChsYW1iZGE6IHNldGF0dHIoc2VsZiwgJ19kaWZmVGhyZXNob2xkJywgb2xkX3RocmVzaG9sZCkpCgogICAgICAgICMgdW5kZXIgdGhlIHRocmVzaG9sZDogZGlmZiBtYXJrZXIgKF4pIGluIGVycm9yIG1lc3NhZ2UKICAgICAgICBzID0gJ3gnICogKDIqKjcpCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24pIGFzIGNtOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHMgKyAnYScsIHMgKyAnYicpCiAgICAgICAgc2VsZi5hc3NlcnRJbignXicsIHN0cihjbS5leGNlcHRpb24pKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocyArICdhJywgcyArICdhJykKCiAgICAgICAgIyBvdmVyIHRoZSB0aHJlc2hvbGQ6IGRpZmYgbm90IHVzZWQgYW5kIG1hcmtlciAoXikgbm90IGluIGVycm9yIG1lc3NhZ2UKICAgICAgICBzID0gJ3gnICogKDIqKjkpCiAgICAgICAgIyBpZiB0aGUgcGF0aCB0aGF0IHVzZXMgZGlmZmxpYiBpcyB0YWtlbiwgX3RydW5jYXRlTWVzc2FnZSB3aWxsIGJlCiAgICAgICAgIyBjYWxsZWQgLS0gcmVwbGFjZSBpdCB3aXRoIGV4cGxvZGluZ1RydW5jYXRpb24gdG8gdmVyaWZ5IHRoYXQgdGhpcwogICAgICAgICMgZG9lc24ndCBoYXBwZW4KICAgICAgICBkZWYgZXhwbG9kaW5nVHJ1bmNhdGlvbihtZXNzYWdlLCBkaWZmKToKICAgICAgICAgICAgcmFpc2UgU3lzdGVtRXJyb3IoJ3RoaXMgc2hvdWxkIG5vdCBiZSByYWlzZWQnKQogICAgICAgIG9sZF90cnVuY2F0ZSA9IHNlbGYuX3RydW5jYXRlTWVzc2FnZQogICAgICAgIHNlbGYuX3RydW5jYXRlTWVzc2FnZSA9IGV4cGxvZGluZ1RydW5jYXRpb24KICAgICAgICBzZWxmLmFkZENsZWFudXAobGFtYmRhOiBzZXRhdHRyKHNlbGYsICdfdHJ1bmNhdGVNZXNzYWdlJywgb2xkX3RydW5jYXRlKSkKCiAgICAgICAgczEsIHMyID0gcyArICdhJywgcyArICdiJwogICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uKSBhcyBjbToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzMSwgczIpCiAgICAgICAgc2VsZi5hc3NlcnROb3RJbignXicsIHN0cihjbS5leGNlcHRpb24pKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGNtLmV4Y2VwdGlvbiksICclciAhPSAlcicgJSAoczEsIHMyKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHMgKyAnYScsIHMgKyAnYScpCgogICAgZGVmIHRlc3RBc3NlcnRDb3VudEVxdWFsKHNlbGYpOgogICAgICAgIGEgPSBvYmplY3QoKQogICAgICAgIHNlbGYuYXNzZXJ0Q291bnRFcXVhbChbMSwgMiwgM10sIFszLCAyLCAxXSkKICAgICAgICBzZWxmLmFzc2VydENvdW50RXF1YWwoWydmb28nLCAnYmFyJywgJ2JheiddLCBbJ2JhcicsICdiYXonLCAnZm9vJ10pCiAgICAgICAgc2VsZi5hc3NlcnRDb3VudEVxdWFsKFthLCBhLCAyLCAyLCAzXSwgKGEsIDIsIDMsIGEsIDIpKQogICAgICAgIHNlbGYuYXNzZXJ0Q291bnRFcXVhbChbMSwgIjIiLCAiYSIsICJhIl0sIFsiYSIsICIyIiwgVHJ1ZSwgImEiXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0Q291bnRFcXVhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICBbMSwgMl0gKyBbM10gKiAxMDAsIFsxXSAqIDEwMCArIFsyLCAzXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0Q291bnRFcXVhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICBbMSwgIjIiLCAiYSIsICJhIl0sIFsiYSIsICIyIiwgVHJ1ZSwgMV0pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydENvdW50RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgWzEwXSwgWzEwLCAxMV0pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydENvdW50RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgWzEwLCAxMV0sIFsxMF0pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydENvdW50RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgWzEwLCAxMSwgMTBdLCBbMTAsIDExXSkKCiAgICAgICAgIyBUZXN0IHRoYXQgc2VxdWVuY2VzIG9mIHVuaGFzaGFibGUgb2JqZWN0cyBjYW4gYmUgdGVzdGVkIGZvciBzYW1lbmVzczoKICAgICAgICBzZWxmLmFzc2VydENvdW50RXF1YWwoW1sxLCAyXSwgWzMsIDRdLCAwXSwgW0ZhbHNlLCBbMywgNF0sIFsxLCAyXV0pCiAgICAgICAgIyBUZXN0IHRoYXQgaXRlcmF0b3Igb2YgdW5oYXNoYWJsZSBvYmplY3RzIGNhbiBiZSB0ZXN0ZWQgZm9yIHNhbWVuZXNzOgogICAgICAgIHNlbGYuYXNzZXJ0Q291bnRFcXVhbChpdGVyKFsxLCAyLCBbXSwgMywgNF0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVyKFsxLCAyLCBbXSwgMywgNF0pKQoKICAgICAgICAjIGhhc2hhYmxlIHR5cGVzLCBidXQgbm90IG9yZGVyYWJsZQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRDb3VudEVxdWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgIFtdLCBbZGl2bW9kLCAneCcsIDEsIDVqLCAyaiwgZnJvemVuc2V0KCldKQogICAgICAgICMgY29tcGFyaW5nIGRpY3RzCiAgICAgICAgc2VsZi5hc3NlcnRDb3VudEVxdWFsKFt7J2EnOiAxfSwgeydiJzogMn1dLCBbeydiJzogMn0sIHsnYSc6IDF9XSkKICAgICAgICAjIGNvbXBhcmluZyBoZXRlcm9nZW5vdXMgbm9uLWhhc2hhYmxlIHNlcXVlbmNlcwogICAgICAgIHNlbGYuYXNzZXJ0Q291bnRFcXVhbChbMSwgJ3gnLCBkaXZtb2QsIFtdXSwgW2Rpdm1vZCwgW10sICd4JywgMV0pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydENvdW50RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgW10sIFtkaXZtb2QsIFtdLCAneCcsIDEsIDVqLCAyaiwgc2V0KCldKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRDb3VudEVxdWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgIFtbMV1dLCBbWzJdXSkKCiAgICAgICAgIyBTYW1lIGVsZW1lbnRzLCBidXQgbm90IHNhbWUgc2VxdWVuY2UgbGVuZ3RoCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydENvdW50RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgWzEsIDEsIDJdLCBbMiwgMV0pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydENvdW50RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgWzEsIDEsICIyIiwgImEiLCAiYSJdLCBbIjIiLCAiMiIsIFRydWUsICJhIl0pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydENvdW50RXF1YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgWzEsIHsnYic6IDJ9LCBOb25lLCBUcnVlXSwgW3snYic6IDJ9LCBUcnVlLCBOb25lXSkKCiAgICAgICAgIyBTYW1lIGVsZW1lbnRzIHdoaWNoIGRvbid0IHJlbGlhYmx5IGNvbXBhcmUsIGluCiAgICAgICAgIyBkaWZmZXJlbnQgb3JkZXIsIHNlZSBpc3N1ZSAxMDI0MgogICAgICAgIGEgPSBbezIsNH0sIHsxLDJ9XQogICAgICAgIGIgPSBhWzo6LTFdCiAgICAgICAgc2VsZi5hc3NlcnRDb3VudEVxdWFsKGEsIGIpCgogICAgICAgICMgdGVzdCB1dGlsaXR5IGZ1bmN0aW9ucyBzdXBwb3J0aW5nIGFzc2VydENvdW50RXF1YWwoKQoKICAgICAgICBkaWZmcyA9IHNldCh1bml0dGVzdC51dGlsLl9jb3VudF9kaWZmX2FsbF9wdXJwb3NlKCdhYWFiY2NkJywgJ2FiYmJjY2UnKSkKICAgICAgICBleHBlY3RlZCA9IHsoMywxLCdhJyksICgxLDMsJ2InKSwgKDEsMCwnZCcpLCAoMCwxLCdlJyl9CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChkaWZmcywgZXhwZWN0ZWQpCgogICAgICAgIGRpZmZzID0gdW5pdHRlc3QudXRpbC5fY291bnRfZGlmZl9hbGxfcHVycG9zZShbW11dLCBbXSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGRpZmZzLCBbKDEsIDAsIFtdKV0pCgogICAgICAgIGRpZmZzID0gc2V0KHVuaXR0ZXN0LnV0aWwuX2NvdW50X2RpZmZfaGFzaGFibGUoJ2FhYWJjY2QnLCAnYWJiYmNjZScpKQogICAgICAgIGV4cGVjdGVkID0geygzLDEsJ2EnKSwgKDEsMywnYicpLCAoMSwwLCdkJyksICgwLDEsJ2UnKX0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGRpZmZzLCBleHBlY3RlZCkKCiAgICBkZWYgdGVzdEFzc2VydFNldEVxdWFsKHNlbGYpOgogICAgICAgIHNldDEgPSBzZXQoKQogICAgICAgIHNldDIgPSBzZXQoKQogICAgICAgIHNlbGYuYXNzZXJ0U2V0RXF1YWwoc2V0MSwgc2V0MikKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydFNldEVxdWFsLCBOb25lLCBzZXQyKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRTZXRFcXVhbCwgW10sIHNldDIpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydFNldEVxdWFsLCBzZXQxLCBOb25lKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRTZXRFcXVhbCwgc2V0MSwgW10pCgogICAgICAgIHNldDEgPSBzZXQoWydhJ10pCiAgICAgICAgc2V0MiA9IHNldCgpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydFNldEVxdWFsLCBzZXQxLCBzZXQyKQoKICAgICAgICBzZXQxID0gc2V0KFsnYSddKQogICAgICAgIHNldDIgPSBzZXQoWydhJ10pCiAgICAgICAgc2VsZi5hc3NlcnRTZXRFcXVhbChzZXQxLCBzZXQyKQoKICAgICAgICBzZXQxID0gc2V0KFsnYSddKQogICAgICAgIHNldDIgPSBzZXQoWydhJywgJ2InXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0U2V0RXF1YWwsIHNldDEsIHNldDIpCgogICAgICAgIHNldDEgPSBzZXQoWydhJ10pCiAgICAgICAgc2V0MiA9IGZyb3plbnNldChbJ2EnLCAnYiddKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRTZXRFcXVhbCwgc2V0MSwgc2V0MikKCiAgICAgICAgc2V0MSA9IHNldChbJ2EnLCAnYiddKQogICAgICAgIHNldDIgPSBmcm96ZW5zZXQoWydhJywgJ2InXSkKICAgICAgICBzZWxmLmFzc2VydFNldEVxdWFsKHNldDEsIHNldDIpCgogICAgICAgIHNldDEgPSBzZXQoKQogICAgICAgIHNldDIgPSAiZm9vIgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRTZXRFcXVhbCwgc2V0MSwgc2V0MikKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0U2V0RXF1YWwsIHNldDIsIHNldDEpCgogICAgICAgICMgbWFrZSBzdXJlIGFueSBzdHJpbmcgZm9ybWF0dGluZyBpcyB0dXBsZS1zYWZlCiAgICAgICAgc2V0MSA9IHNldChbKDAsIDEpLCAoMiwgMyldKQogICAgICAgIHNldDIgPSBzZXQoWyg0LCA1KV0pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydFNldEVxdWFsLCBzZXQxLCBzZXQyKQoKICAgIGRlZiB0ZXN0SW5lcXVhbGl0eShzZWxmKToKICAgICAgICAjIFRyeSBpbnRzCiAgICAgICAgc2VsZi5hc3NlcnRHcmVhdGVyKDIsIDEpCiAgICAgICAgc2VsZi5hc3NlcnRHcmVhdGVyRXF1YWwoMiwgMSkKICAgICAgICBzZWxmLmFzc2VydEdyZWF0ZXJFcXVhbCgxLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0TGVzcygxLCAyKQogICAgICAgIHNlbGYuYXNzZXJ0TGVzc0VxdWFsKDEsIDIpCiAgICAgICAgc2VsZi5hc3NlcnRMZXNzRXF1YWwoMSwgMSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0R3JlYXRlciwgMSwgMikKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0R3JlYXRlciwgMSwgMSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0R3JlYXRlckVxdWFsLCAxLCAyKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRMZXNzLCAyLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRMZXNzLCAxLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRMZXNzRXF1YWwsIDIsIDEpCgogICAgICAgICMgVHJ5IEZsb2F0cwogICAgICAgIHNlbGYuYXNzZXJ0R3JlYXRlcigxLjEsIDEuMCkKICAgICAgICBzZWxmLmFzc2VydEdyZWF0ZXJFcXVhbCgxLjEsIDEuMCkKICAgICAgICBzZWxmLmFzc2VydEdyZWF0ZXJFcXVhbCgxLjAsIDEuMCkKICAgICAgICBzZWxmLmFzc2VydExlc3MoMS4wLCAxLjEpCiAgICAgICAgc2VsZi5hc3NlcnRMZXNzRXF1YWwoMS4wLCAxLjEpCiAgICAgICAgc2VsZi5hc3NlcnRMZXNzRXF1YWwoMS4wLCAxLjApCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydEdyZWF0ZXIsIDEuMCwgMS4xKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRHcmVhdGVyLCAxLjAsIDEuMCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0R3JlYXRlckVxdWFsLCAxLjAsIDEuMSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0TGVzcywgMS4xLCAxLjApCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydExlc3MsIDEuMCwgMS4wKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRMZXNzRXF1YWwsIDEuMSwgMS4wKQoKICAgICAgICAjIFRyeSBTdHJpbmdzCiAgICAgICAgc2VsZi5hc3NlcnRHcmVhdGVyKCdidWcnLCAnYW50JykKICAgICAgICBzZWxmLmFzc2VydEdyZWF0ZXJFcXVhbCgnYnVnJywgJ2FudCcpCiAgICAgICAgc2VsZi5hc3NlcnRHcmVhdGVyRXF1YWwoJ2FudCcsICdhbnQnKQogICAgICAgIHNlbGYuYXNzZXJ0TGVzcygnYW50JywgJ2J1ZycpCiAgICAgICAgc2VsZi5hc3NlcnRMZXNzRXF1YWwoJ2FudCcsICdidWcnKQogICAgICAgIHNlbGYuYXNzZXJ0TGVzc0VxdWFsKCdhbnQnLCAnYW50JykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0R3JlYXRlciwgJ2FudCcsICdidWcnKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRHcmVhdGVyLCAnYW50JywgJ2FudCcpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydEdyZWF0ZXJFcXVhbCwgJ2FudCcsICdidWcnKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRMZXNzLCAnYnVnJywgJ2FudCcpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydExlc3MsICdhbnQnLCAnYW50JykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0TGVzc0VxdWFsLCAnYnVnJywgJ2FudCcpCgogICAgICAgICMgVHJ5IGJ5dGVzCiAgICAgICAgc2VsZi5hc3NlcnRHcmVhdGVyKGInYnVnJywgYidhbnQnKQogICAgICAgIHNlbGYuYXNzZXJ0R3JlYXRlckVxdWFsKGInYnVnJywgYidhbnQnKQogICAgICAgIHNlbGYuYXNzZXJ0R3JlYXRlckVxdWFsKGInYW50JywgYidhbnQnKQogICAgICAgIHNlbGYuYXNzZXJ0TGVzcyhiJ2FudCcsIGInYnVnJykKICAgICAgICBzZWxmLmFzc2VydExlc3NFcXVhbChiJ2FudCcsIGInYnVnJykKICAgICAgICBzZWxmLmFzc2VydExlc3NFcXVhbChiJ2FudCcsIGInYW50JykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0R3JlYXRlciwgYidhbnQnLCBiJ2J1ZycpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydEdyZWF0ZXIsIGInYW50JywgYidhbnQnKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRHcmVhdGVyRXF1YWwsIGInYW50JywKICAgICAgICAgICAgICAgICAgICAgICAgICBiJ2J1ZycpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoc2VsZi5mYWlsdXJlRXhjZXB0aW9uLCBzZWxmLmFzc2VydExlc3MsIGInYnVnJywgYidhbnQnKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiwgc2VsZi5hc3NlcnRMZXNzLCBiJ2FudCcsIGInYW50JykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0TGVzc0VxdWFsLCBiJ2J1ZycsIGInYW50JykKCiAgICBkZWYgdGVzdEFzc2VydE11bHRpTGluZUVxdWFsKHNlbGYpOgogICAgICAgIHNhbXBsZV90ZXh0ID0gIiIiXApodHRwOi8vd3d3LnB5dGhvbi5vcmcvZG9jLzIuMy9saWIvbW9kdWxlLXVuaXR0ZXN0Lmh0bWwKdGVzdCBjYXNlCiAgICBBIHRlc3QgY2FzZSBpcyB0aGUgc21hbGxlc3QgdW5pdCBvZiB0ZXN0aW5nLiBbLi4uXQoiIiIKICAgICAgICByZXZpc2VkX3NhbXBsZV90ZXh0ID0gIiIiXApodHRwOi8vd3d3LnB5dGhvbi5vcmcvZG9jLzIuNC4xL2xpYi9tb2R1bGUtdW5pdHRlc3QuaHRtbAp0ZXN0IGNhc2UKICAgIEEgdGVzdCBjYXNlIGlzIHRoZSBzbWFsbGVzdCB1bml0IG9mIHRlc3RpbmcuIFsuLi5dIFlvdSBtYXkgcHJvdmlkZSB5b3VyCiAgICBvd24gaW1wbGVtZW50YXRpb24gdGhhdCBkb2VzIG5vdCBzdWJjbGFzcyBmcm9tIFRlc3RDYXNlLCBvZiBjb3Vyc2UuCiIiIgogICAgICAgIHNhbXBsZV90ZXh0X2Vycm9yID0gIiIiXAotIGh0dHA6Ly93d3cucHl0aG9uLm9yZy9kb2MvMi4zL2xpYi9tb2R1bGUtdW5pdHRlc3QuaHRtbAo/ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBeCisgaHR0cDovL3d3dy5weXRob24ub3JnL2RvYy8yLjQuMS9saWIvbW9kdWxlLXVuaXR0ZXN0Lmh0bWwKPyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXl5eCiAgdGVzdCBjYXNlCi0gICAgIEEgdGVzdCBjYXNlIGlzIHRoZSBzbWFsbGVzdCB1bml0IG9mIHRlc3RpbmcuIFsuLi5dCisgICAgIEEgdGVzdCBjYXNlIGlzIHRoZSBzbWFsbGVzdCB1bml0IG9mIHRlc3RpbmcuIFsuLi5dIFlvdSBtYXkgcHJvdmlkZSB5b3VyCj8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKysrKysrKysrKysrKysrKysrKysrCisgICAgIG93biBpbXBsZW1lbnRhdGlvbiB0aGF0IGRvZXMgbm90IHN1YmNsYXNzIGZyb20gVGVzdENhc2UsIG9mIGNvdXJzZS4KIiIiCiAgICAgICAgc2VsZi5tYXhEaWZmID0gTm9uZQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRNdWx0aUxpbmVFcXVhbChzYW1wbGVfdGV4dCwgcmV2aXNlZF9zYW1wbGVfdGV4dCkKICAgICAgICBleGNlcHQgc2VsZi5mYWlsdXJlRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICMgbmVlZCB0byByZW1vdmUgdGhlIGZpcnN0IGxpbmUgb2YgdGhlIGVycm9yIG1lc3NhZ2UKICAgICAgICAgICAgZXJyb3IgPSBzdHIoZSkuc3BsaXQoJ1xuJywgMSlbMV0KCiAgICAgICAgICAgICMgbm8gZmFpciB0ZXN0aW5nIG91cnNlbGYgd2l0aCBvdXJzZWxmLCBhbmQgYXNzZXJ0RXF1YWwgaXMgdXNlZCBmb3Igc3RyaW5ncwogICAgICAgICAgICAjIHNvIGNhbid0IHVzZSBhc3NlcnRFcXVhbCBlaXRoZXIuIEp1c3QgdXNlIGFzc2VydFRydWUuCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShzYW1wbGVfdGV4dF9lcnJvciA9PSBlcnJvcikKCiAgICBkZWYgdGVzdEFzZXJ0RXF1YWxTaW5nbGVMaW5lKHNlbGYpOgogICAgICAgIHNhbXBsZV90ZXh0ID0gImxhZGVuIHN3YWxsb3dzIGZseSBzbG93bHkiCiAgICAgICAgcmV2aXNlZF9zYW1wbGVfdGV4dCA9ICJ1bmxhZGVuIHN3YWxsb3dzIGZseSBxdWlja2x5IgogICAgICAgIHNhbXBsZV90ZXh0X2Vycm9yID0gIiIiXAotIGxhZGVuIHN3YWxsb3dzIGZseSBzbG93bHkKPyAgICAgICAgICAgICAgICAgICAgXl5eXgorIHVubGFkZW4gc3dhbGxvd3MgZmx5IHF1aWNrbHkKPyArKyAgICAgICAgICAgICAgICAgICBeXl5eXgoiIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc2FtcGxlX3RleHQsIHJldmlzZWRfc2FtcGxlX3RleHQpCiAgICAgICAgZXhjZXB0IHNlbGYuZmFpbHVyZUV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBlcnJvciA9IHN0cihlKS5zcGxpdCgnXG4nLCAxKVsxXQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoc2FtcGxlX3RleHRfZXJyb3IgPT0gZXJyb3IpCgogICAgZGVmIHRlc3RBc3NlcnRJc05vbmUoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRJc05vbmUoTm9uZSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0SXNOb25lLCBGYWxzZSkKICAgICAgICBzZWxmLmFzc2VydElzTm90Tm9uZSgnRGpab1Bsb0dlYXJzIG9uIFJhaWxzJykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0SXNOb3ROb25lLCBOb25lKQoKICAgIGRlZiB0ZXN0QXNzZXJ0UmVnZXgoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRSZWdleCgnYXNkZmFiYXNkZicsIHInYWIrJykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24sIHNlbGYuYXNzZXJ0UmVnZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NhYWFzJywgcidhYWFhJykKCiAgICBkZWYgdGVzdEFzc2VydFJhaXNlc1JlZ2V4KHNlbGYpOgogICAgICAgIGNsYXNzIEV4Y2VwdGlvbk1vY2soRXhjZXB0aW9uKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBkZWYgU3R1YigpOgogICAgICAgICAgICByYWlzZSBFeGNlcHRpb25Nb2NrKCdXZSBleHBlY3QnKQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1JlZ2V4KEV4Y2VwdGlvbk1vY2ssIHJlLmNvbXBpbGUoJ2V4cGVjdCQnKSwgU3R1YikKICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1JlZ2V4KEV4Y2VwdGlvbk1vY2ssICdleHBlY3QkJywgU3R1YikKCiAgICBkZWYgdGVzdEFzc2VydE5vdFJhaXNlc1JlZ2V4KHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzUmVnZXgoCiAgICAgICAgICAgICAgICBzZWxmLmZhaWx1cmVFeGNlcHRpb24sICdeRXhjZXB0aW9uIG5vdCByYWlzZWQgYnkgPGxhbWJkYT4kJywKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzUmVnZXgsIEV4Y2VwdGlvbiwgcmUuY29tcGlsZSgneCcpLAogICAgICAgICAgICAgICAgbGFtYmRhOiBOb25lKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzUmVnZXgoCiAgICAgICAgICAgICAgICBzZWxmLmZhaWx1cmVFeGNlcHRpb24sICdeRXhjZXB0aW9uIG5vdCByYWlzZWQgYnkgPGxhbWJkYT4kJywKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzUmVnZXgsIEV4Y2VwdGlvbiwgJ3gnLAogICAgICAgICAgICAgICAgbGFtYmRhOiBOb25lKQoKICAgIGRlZiB0ZXN0QXNzZXJ0UmFpc2VzUmVnZXhNaXNtYXRjaChzZWxmKToKICAgICAgICBkZWYgU3R1YigpOgogICAgICAgICAgICByYWlzZSBFeGNlcHRpb24oJ1VuZXhwZWN0ZWQnKQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1JlZ2V4KAogICAgICAgICAgICAgICAgc2VsZi5mYWlsdXJlRXhjZXB0aW9uLAogICAgICAgICAgICAgICAgciciXF5FeHBlY3RlZFwkIiBkb2VzIG5vdCBtYXRjaCAiVW5leHBlY3RlZCInLAogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXNSZWdleCwgRXhjZXB0aW9uLCAnXkV4cGVjdGVkJCcsCiAgICAgICAgICAgICAgICBTdHViKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzUmVnZXgoCiAgICAgICAgICAgICAgICBzZWxmLmZhaWx1cmVFeGNlcHRpb24sCiAgICAgICAgICAgICAgICByJyJcXkV4cGVjdGVkXCQiIGRvZXMgbm90IG1hdGNoICJVbmV4cGVjdGVkIicsCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1JlZ2V4LCBFeGNlcHRpb24sCiAgICAgICAgICAgICAgICByZS5jb21waWxlKCdeRXhwZWN0ZWQkJyksIFN0dWIpCgogICAgZGVmIHRlc3RBc3NlcnRSYWlzZXNFeGNWYWx1ZShzZWxmKToKICAgICAgICBjbGFzcyBFeGNlcHRpb25Nb2NrKEV4Y2VwdGlvbik6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgZGVmIFN0dWIoZm9vKToKICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uTW9jayhmb28pCiAgICAgICAgdiA9ICJwYXJ0aWN1bGFyIHZhbHVlIgoKICAgICAgICBjdHggPSBzZWxmLmFzc2VydFJhaXNlcyhFeGNlcHRpb25Nb2NrKQogICAgICAgIHdpdGggY3R4OgogICAgICAgICAgICBTdHViKHYpCiAgICAgICAgZSA9IGN0eC5leGNlcHRpb24KICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UoZSwgRXhjZXB0aW9uTW9jaykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGUuYXJnc1swXSwgdikKCiAgICBkZWYgdGVzdEFzc2VydFdhcm5zQ2FsbGFibGUoc2VsZik6CiAgICAgICAgZGVmIF9ydW50aW1lX3dhcm4oKToKICAgICAgICAgICAgd2FybmluZ3Mud2FybigiZm9vIiwgUnVudGltZVdhcm5pbmcpCiAgICAgICAgIyBTdWNjZXNzIHdoZW4gdGhlIHJpZ2h0IHdhcm5pbmcgaXMgdHJpZ2dlcmVkLCBldmVuIHNldmVyYWwgdGltZXMKICAgICAgICBzZWxmLmFzc2VydFdhcm5zKFJ1bnRpbWVXYXJuaW5nLCBfcnVudGltZV93YXJuKQogICAgICAgIHNlbGYuYXNzZXJ0V2FybnMoUnVudGltZVdhcm5pbmcsIF9ydW50aW1lX3dhcm4pCiAgICAgICAgIyBBIHR1cGxlIG9mIHdhcm5pbmcgY2xhc3NlcyBpcyBhY2NlcHRlZAogICAgICAgIHNlbGYuYXNzZXJ0V2FybnMoKERlcHJlY2F0aW9uV2FybmluZywgUnVudGltZVdhcm5pbmcpLCBfcnVudGltZV93YXJuKQogICAgICAgICMgKmFyZ3MgYW5kICoqa3dhcmdzIGFsc28gd29yawogICAgICAgIHNlbGYuYXNzZXJ0V2FybnMoUnVudGltZVdhcm5pbmcsCiAgICAgICAgICAgICAgICAgICAgICAgICB3YXJuaW5ncy53YXJuLCAiZm9vIiwgY2F0ZWdvcnk9UnVudGltZVdhcm5pbmcpCiAgICAgICAgIyBGYWlsdXJlIHdoZW4gbm8gd2FybmluZyBpcyB0cmlnZ2VyZWQKICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbik6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0V2FybnMoUnVudGltZVdhcm5pbmcsIGxhbWJkYTogMCkKICAgICAgICAjIEZhaWx1cmUgd2hlbiBhbm90aGVyIHdhcm5pbmcgaXMgdHJpZ2dlcmVkCiAgICAgICAgd2l0aCB3YXJuaW5ncy5jYXRjaF93YXJuaW5ncygpOgogICAgICAgICAgICAjIEZvcmNlIGRlZmF1bHQgZmlsdGVyIChpbiBjYXNlIHRlc3RzIGFyZSBydW4gd2l0aCAtV2UpCiAgICAgICAgICAgIHdhcm5pbmdzLnNpbXBsZWZpbHRlcigiZGVmYXVsdCIsIFJ1bnRpbWVXYXJuaW5nKQogICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbik6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFdhcm5zKERlcHJlY2F0aW9uV2FybmluZywgX3J1bnRpbWVfd2FybikKICAgICAgICAjIEZpbHRlcnMgZm9yIG90aGVyIHdhcm5pbmdzIGFyZSBub3QgbW9kaWZpZWQKICAgICAgICB3aXRoIHdhcm5pbmdzLmNhdGNoX3dhcm5pbmdzKCk6CiAgICAgICAgICAgIHdhcm5pbmdzLnNpbXBsZWZpbHRlcigiZXJyb3IiLCBSdW50aW1lV2FybmluZykKICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhSdW50aW1lV2FybmluZyk6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFdhcm5zKERlcHJlY2F0aW9uV2FybmluZywgX3J1bnRpbWVfd2FybikKCiAgICBkZWYgdGVzdEFzc2VydFdhcm5zQ29udGV4dChzZWxmKToKICAgICAgICAjIEJlbGlldmUgaXQgb3Igbm90LCBpdCBpcyBwcmVmZXJyYWJsZSB0byBkdXBsaWNhdGUgYWxsIHRlc3RzIGFib3ZlLAogICAgICAgICMgdG8gbWFrZSBzdXJlIHRoZSBfX3dhcm5pbmdyZWdpc3RyeV9fICRAIGlzIGNpcmN1bXZlbnRlZCBjb3JyZWN0bHkuCiAgICAgICAgZGVmIF9ydW50aW1lX3dhcm4oKToKICAgICAgICAgICAgd2FybmluZ3Mud2FybigiZm9vIiwgUnVudGltZVdhcm5pbmcpCiAgICAgICAgX3J1bnRpbWVfd2Fybl9saW5lbm8gPSBpbnNwZWN0LmdldHNvdXJjZWxpbmVzKF9ydW50aW1lX3dhcm4pWzFdCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFdhcm5zKFJ1bnRpbWVXYXJuaW5nKSBhcyBjbToKICAgICAgICAgICAgX3J1bnRpbWVfd2FybigpCiAgICAgICAgIyBBIHR1cGxlIG9mIHdhcm5pbmcgY2xhc3NlcyBpcyBhY2NlcHRlZAogICAgICAgIHdpdGggc2VsZi5hc3NlcnRXYXJucygoRGVwcmVjYXRpb25XYXJuaW5nLCBSdW50aW1lV2FybmluZykpIGFzIGNtOgogICAgICAgICAgICBfcnVudGltZV93YXJuKCkKICAgICAgICAjIFRoZSBjb250ZXh0IG1hbmFnZXIgZXhwb3NlcyB2YXJpb3VzIHVzZWZ1bCBhdHRyaWJ1dGVzCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGNtLndhcm5pbmcsIFJ1bnRpbWVXYXJuaW5nKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoY20ud2FybmluZy5hcmdzWzBdLCAiZm9vIikKICAgICAgICBzZWxmLmFzc2VydEluKCJ0ZXN0X2Nhc2UucHkiLCBjbS5maWxlbmFtZSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNtLmxpbmVubywgX3J1bnRpbWVfd2Fybl9saW5lbm8gKyAxKQogICAgICAgICMgU2FtZSB3aXRoIHNldmVyYWwgd2FybmluZ3MKICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0V2FybnMoUnVudGltZVdhcm5pbmcpOgogICAgICAgICAgICBfcnVudGltZV93YXJuKCkKICAgICAgICAgICAgX3J1bnRpbWVfd2FybigpCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFdhcm5zKFJ1bnRpbWVXYXJuaW5nKToKICAgICAgICAgICAgd2FybmluZ3Mud2FybigiZm9vIiwgY2F0ZWdvcnk9UnVudGltZVdhcm5pbmcpCiAgICAgICAgIyBGYWlsdXJlIHdoZW4gbm8gd2FybmluZyBpcyB0cmlnZ2VyZWQKICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbik6CiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRXYXJucyhSdW50aW1lV2FybmluZyk6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgIyBGYWlsdXJlIHdoZW4gYW5vdGhlciB3YXJuaW5nIGlzIHRyaWdnZXJlZAogICAgICAgIHdpdGggd2FybmluZ3MuY2F0Y2hfd2FybmluZ3MoKToKICAgICAgICAgICAgIyBGb3JjZSBkZWZhdWx0IGZpbHRlciAoaW4gY2FzZSB0ZXN0cyBhcmUgcnVuIHdpdGggLVdlKQogICAgICAgICAgICB3YXJuaW5ncy5zaW1wbGVmaWx0ZXIoImRlZmF1bHQiLCBSdW50aW1lV2FybmluZykKICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24pOgogICAgICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFdhcm5zKERlcHJlY2F0aW9uV2FybmluZyk6CiAgICAgICAgICAgICAgICAgICAgX3J1bnRpbWVfd2FybigpCiAgICAgICAgIyBGaWx0ZXJzIGZvciBvdGhlciB3YXJuaW5ncyBhcmUgbm90IG1vZGlmaWVkCiAgICAgICAgd2l0aCB3YXJuaW5ncy5jYXRjaF93YXJuaW5ncygpOgogICAgICAgICAgICB3YXJuaW5ncy5zaW1wbGVmaWx0ZXIoImVycm9yIiwgUnVudGltZVdhcm5pbmcpCiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoUnVudGltZVdhcm5pbmcpOgogICAgICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFdhcm5zKERlcHJlY2F0aW9uV2FybmluZyk6CiAgICAgICAgICAgICAgICAgICAgX3J1bnRpbWVfd2FybigpCgogICAgZGVmIHRlc3RBc3NlcnRXYXJuc1JlZ2V4Q2FsbGFibGUoc2VsZik6CiAgICAgICAgZGVmIF9ydW50aW1lX3dhcm4obXNnKToKICAgICAgICAgICAgd2FybmluZ3Mud2Fybihtc2csIFJ1bnRpbWVXYXJuaW5nKQogICAgICAgIHNlbGYuYXNzZXJ0V2FybnNSZWdleChSdW50aW1lV2FybmluZywgIm8rIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3J1bnRpbWVfd2FybiwgImZvb3giKQogICAgICAgICMgRmFpbHVyZSB3aGVuIG5vIHdhcm5pbmcgaXMgdHJpZ2dlcmVkCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24pOgogICAgICAgICAgICBzZWxmLmFzc2VydFdhcm5zUmVnZXgoUnVudGltZVdhcm5pbmcsICJvKyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYW1iZGE6IDApCiAgICAgICAgIyBGYWlsdXJlIHdoZW4gYW5vdGhlciB3YXJuaW5nIGlzIHRyaWdnZXJlZAogICAgICAgIHdpdGggd2FybmluZ3MuY2F0Y2hfd2FybmluZ3MoKToKICAgICAgICAgICAgIyBGb3JjZSBkZWZhdWx0IGZpbHRlciAoaW4gY2FzZSB0ZXN0cyBhcmUgcnVuIHdpdGggLVdlKQogICAgICAgICAgICB3YXJuaW5ncy5zaW1wbGVmaWx0ZXIoImRlZmF1bHQiLCBSdW50aW1lV2FybmluZykKICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24pOgogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRXYXJuc1JlZ2V4KERlcHJlY2F0aW9uV2FybmluZywgIm8rIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcnVudGltZV93YXJuLCAiZm9veCIpCiAgICAgICAgIyBGYWlsdXJlIHdoZW4gbWVzc2FnZSBkb2Vzbid0IG1hdGNoCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24pOgogICAgICAgICAgICBzZWxmLmFzc2VydFdhcm5zUmVnZXgoUnVudGltZVdhcm5pbmcsICJvKyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcnVudGltZV93YXJuLCAiYmFyeiIpCiAgICAgICAgIyBBIGxpdHRsZSB0cmlja2llcjogd2UgYXNrIFJ1bnRpbWVXYXJuaW5ncyB0byBiZSByYWlzZWQsIGFuZCB0aGVuCiAgICAgICAgIyBjaGVjayBmb3Igc29tZSBvZiB0aGVtLiAgSXQgaXMgaW1wbGVtZW50YXRpb24tZGVmaW5lZCB3aGV0aGVyCiAgICAgICAgIyBub24tbWF0Y2hpbmcgUnVudGltZVdhcm5pbmdzIGFyZSBzaW1wbHkgcmUtcmFpc2VkLCBvciBwcm9kdWNlIGEKICAgICAgICAjIGZhaWx1cmVFeGNlcHRpb24uCiAgICAgICAgd2l0aCB3YXJuaW5ncy5jYXRjaF93YXJuaW5ncygpOgogICAgICAgICAgICB3YXJuaW5ncy5zaW1wbGVmaWx0ZXIoImVycm9yIiwgUnVudGltZVdhcm5pbmcpCiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoKFJ1bnRpbWVXYXJuaW5nLCBzZWxmLmZhaWx1cmVFeGNlcHRpb24pKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0V2FybnNSZWdleChSdW50aW1lV2FybmluZywgIm8rIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcnVudGltZV93YXJuLCAiYmFyeiIpCgogICAgZGVmIHRlc3RBc3NlcnRXYXJuc1JlZ2V4Q29udGV4dChzZWxmKToKICAgICAgICAjIFNhbWUgYXMgYWJvdmUsIGJ1dCB3aXRoIGFzc2VydFdhcm5zUmVnZXggYXMgYSBjb250ZXh0IG1hbmFnZXIKICAgICAgICBkZWYgX3J1bnRpbWVfd2Fybihtc2cpOgogICAgICAgICAgICB3YXJuaW5ncy53YXJuKG1zZywgUnVudGltZVdhcm5pbmcpCiAgICAgICAgX3J1bnRpbWVfd2Fybl9saW5lbm8gPSBpbnNwZWN0LmdldHNvdXJjZWxpbmVzKF9ydW50aW1lX3dhcm4pWzFdCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFdhcm5zUmVnZXgoUnVudGltZVdhcm5pbmcsICJvKyIpIGFzIGNtOgogICAgICAgICAgICBfcnVudGltZV93YXJuKCJmb294IikKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UoY20ud2FybmluZywgUnVudGltZVdhcm5pbmcpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChjbS53YXJuaW5nLmFyZ3NbMF0sICJmb294IikKICAgICAgICBzZWxmLmFzc2VydEluKCJ0ZXN0X2Nhc2UucHkiLCBjbS5maWxlbmFtZSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNtLmxpbmVubywgX3J1bnRpbWVfd2Fybl9saW5lbm8gKyAxKQogICAgICAgICMgRmFpbHVyZSB3aGVuIG5vIHdhcm5pbmcgaXMgdHJpZ2dlcmVkCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24pOgogICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0V2FybnNSZWdleChSdW50aW1lV2FybmluZywgIm8rIik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgIyBGYWlsdXJlIHdoZW4gYW5vdGhlciB3YXJuaW5nIGlzIHRyaWdnZXJlZAogICAgICAgIHdpdGggd2FybmluZ3MuY2F0Y2hfd2FybmluZ3MoKToKICAgICAgICAgICAgIyBGb3JjZSBkZWZhdWx0IGZpbHRlciAoaW4gY2FzZSB0ZXN0cyBhcmUgcnVuIHdpdGggLVdlKQogICAgICAgICAgICB3YXJuaW5ncy5zaW1wbGVmaWx0ZXIoImRlZmF1bHQiLCBSdW50aW1lV2FybmluZykKICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhzZWxmLmZhaWx1cmVFeGNlcHRpb24pOgogICAgICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFdhcm5zUmVnZXgoRGVwcmVjYXRpb25XYXJuaW5nLCAibysiKToKICAgICAgICAgICAgICAgICAgICBfcnVudGltZV93YXJuKCJmb294IikKICAgICAgICAjIEZhaWx1cmUgd2hlbiBtZXNzYWdlIGRvZXNuJ3QgbWF0Y2gKICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKHNlbGYuZmFpbHVyZUV4Y2VwdGlvbik6CiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRXYXJuc1JlZ2V4KFJ1bnRpbWVXYXJuaW5nLCAibysiKToKICAgICAgICAgICAgICAgIF9ydW50aW1lX3dhcm4oImJhcnoiKQogICAgICAgICMgQSBsaXR0bGUgdHJpY2tpZXI6IHdlIGFzayBSdW50aW1lV2FybmluZ3MgdG8gYmUgcmFpc2VkLCBhbmQgdGhlbgogICAgICAgICMgY2hlY2sgZm9yIHNvbWUgb2YgdGhlbS4gIEl0IGlzIGltcGxlbWVudGF0aW9uLWRlZmluZWQgd2hldGhlcgogICAgICAgICMgbm9uLW1hdGNoaW5nIFJ1bnRpbWVXYXJuaW5ncyBhcmUgc2ltcGx5IHJlLXJhaXNlZCwgb3IgcHJvZHVjZSBhCiAgICAgICAgIyBmYWlsdXJlRXhjZXB0aW9uLgogICAgICAgIHdpdGggd2FybmluZ3MuY2F0Y2hfd2FybmluZ3MoKToKICAgICAgICAgICAgd2FybmluZ3Muc2ltcGxlZmlsdGVyKCJlcnJvciIsIFJ1bnRpbWVXYXJuaW5nKQogICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKChSdW50aW1lV2FybmluZywgc2VsZi5mYWlsdXJlRXhjZXB0aW9uKSk6CiAgICAgICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0V2FybnNSZWdleChSdW50aW1lV2FybmluZywgIm8rIik6CiAgICAgICAgICAgICAgICAgICAgX3J1bnRpbWVfd2FybigiYmFyeiIpCgogICAgZGVmIHRlc3REZXByZWNhdGVkTWV0aG9kTmFtZXMoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgVGVzdCB0aGF0IHRoZSBkZXByZWNhdGVkIG1ldGhvZHMgcmFpc2UgYSBEZXByZWNhdGlvbldhcm5pbmcuIFNlZSAjOTQyNC4KICAgICAgICAiIiIKICAgICAgICBvbGQgPSAoCiAgICAgICAgICAgIChzZWxmLmZhaWxJZkVxdWFsLCAoMywgNSkpLAogICAgICAgICAgICAoc2VsZi5hc3NlcnROb3RFcXVhbHMsICgzLCA1KSksCiAgICAgICAgICAgIChzZWxmLmZhaWxVbmxlc3NFcXVhbCwgKDMsIDMpKSwKICAgICAgICAgICAgKHNlbGYuYXNzZXJ0RXF1YWxzLCAoMywgMykpLAogICAgICAgICAgICAoc2VsZi5mYWlsVW5sZXNzQWxtb3N0RXF1YWwsICgyLjAsIDIuMCkpLAogICAgICAgICAgICAoc2VsZi5hc3NlcnRBbG1vc3RFcXVhbHMsICgyLjAsIDIuMCkpLAogICAgICAgICAgICAoc2VsZi5mYWlsSWZBbG1vc3RFcXVhbCwgKDMuMCwgNS4wKSksCiAgICAgICAgICAgIChzZWxmLmFzc2VydE5vdEFsbW9zdEVxdWFscywgKDMuMCwgNS4wKSksCiAgICAgICAgICAgIChzZWxmLmZhaWxVbmxlc3MsIChUcnVlLCkpLAogICAgICAgICAgICAoc2VsZi5hc3NlcnRfLCAoVHJ1ZSwpKSwKICAgICAgICAgICAgKHNlbGYuZmFpbFVubGVzc1JhaXNlcywgKFR5cGVFcnJvciwgbGFtYmRhIF86IDMuMTQgKyAnc3BhbScpKSwKICAgICAgICAgICAgKHNlbGYuZmFpbElmLCAoRmFsc2UsKSksCiAgICAgICAgICAgIChzZWxmLmFzc2VydERpY3RDb250YWluc1N1YnNldCwgKGRpY3QoYT0xLCBiPTIpLCBkaWN0KGE9MSwgYj0yLCBjPTMpKSksCiAgICAgICAgICAgIChzZWxmLmFzc2VydFJhaXNlc1JlZ2V4cCwgKEtleUVycm9yLCAnZm9vJywgbGFtYmRhOiB7fVsnZm9vJ10pKSwKICAgICAgICAgICAgKHNlbGYuYXNzZXJ0UmVnZXhwTWF0Y2hlcywgKCdiYXInLCAnYmFyJykpLAogICAgICAgICkKICAgICAgICBmb3IgbWV0aCwgYXJncyBpbiBvbGQ6CiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRXYXJucyhEZXByZWNhdGlvbldhcm5pbmcpOgogICAgICAgICAgICAgICAgbWV0aCgqYXJncykKCiAgICAjIGRpc2FibGUgdGhpcyB0ZXN0IGZvciBub3cuIFdoZW4gdGhlIHZlcnNpb24gd2hlcmUgdGhlIGZhaWwqIG1ldGhvZHMgd2lsbAogICAgIyBiZSByZW1vdmVkIGlzIGRlY2lkZWQsIHJlLWVuYWJsZSBpdCBhbmQgdXBkYXRlIHRoZSB2ZXJzaW9uCiAgICBkZWYgX3Rlc3REZXByZWNhdGVkRmFpbE1ldGhvZHMoc2VsZik6CiAgICAgICAgIiIiVGVzdCB0aGF0IHRoZSBkZXByZWNhdGVkIGZhaWwqIG1ldGhvZHMgZ2V0IHJlbW92ZWQgaW4gMy54IiIiCiAgICAgICAgaWYgc3lzLnZlcnNpb25faW5mb1s6Ml0gPCAoMywgMyk6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIGRlcHJlY2F0ZWRfbmFtZXMgPSBbCiAgICAgICAgICAgICdmYWlsSWZFcXVhbCcsICdmYWlsVW5sZXNzRXF1YWwnLCAnZmFpbFVubGVzc0FsbW9zdEVxdWFsJywKICAgICAgICAgICAgJ2ZhaWxJZkFsbW9zdEVxdWFsJywgJ2ZhaWxVbmxlc3MnLCAnZmFpbFVubGVzc1JhaXNlcycsICdmYWlsSWYnLAogICAgICAgICAgICAnYXNzZXJ0RGljdENvbnRhaW5zU3Vic2V0JywKICAgICAgICBdCiAgICAgICAgZm9yIGRlcHJlY2F0ZWRfbmFtZSBpbiBkZXByZWNhdGVkX25hbWVzOgogICAgICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yKToKICAgICAgICAgICAgICAgIGdldGF0dHIoc2VsZiwgZGVwcmVjYXRlZF9uYW1lKSAgIyByZW1vdmUgdGhlc2UgaW4gMy54CgogICAgZGVmIHRlc3REZWVwY29weShzZWxmKToKICAgICAgICAjIElzc3VlOiA1NjYwCiAgICAgICAgY2xhc3MgVGVzdGFibGVUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3ROb3RoaW5nKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICB0ZXN0ID0gVGVzdGFibGVUZXN0KCd0ZXN0Tm90aGluZycpCgogICAgICAgICMgVGhpcyBzaG91bGRuJ3QgYmxvdyB1cAogICAgICAgIGRlZXBjb3B5KHRlc3QpCgogICAgZGVmIHRlc3RQaWNrbGUoc2VsZik6CiAgICAgICAgIyBJc3N1ZSAxMDMyNgoKICAgICAgICAjIENhbid0IHVzZSBUZXN0Q2FzZSBjbGFzc2VzIGRlZmluZWQgaW4gVGVzdCBjbGFzcyBhcwogICAgICAgICMgcGlja2xlIGRvZXMgbm90IHdvcmsgd2l0aCBpbm5lciBjbGFzc2VzCiAgICAgICAgdGVzdCA9IHVuaXR0ZXN0LlRlc3RDYXNlKCdydW4nKQogICAgICAgIGZvciBwcm90b2NvbCBpbiByYW5nZShwaWNrbGUuSElHSEVTVF9QUk9UT0NPTCArIDEpOgoKICAgICAgICAgICAgIyBibGV3IHVwIHByaW9yIHRvIGZpeAogICAgICAgICAgICBwaWNrbGVkX3Rlc3QgPSBwaWNrbGUuZHVtcHModGVzdCwgcHJvdG9jb2w9cHJvdG9jb2wpCiAgICAgICAgICAgIHVucGlja2xlZF90ZXN0ID0gcGlja2xlLmxvYWRzKHBpY2tsZWRfdGVzdCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCh0ZXN0LCB1bnBpY2tsZWRfdGVzdCkKCiAgICAgICAgICAgICMgZXhlcmNpc2UgdGhlIFRlc3RDYXNlIGluc3RhbmNlIGluIGEgd2F5IHRoYXQgd2lsbCBpbnZva2UKICAgICAgICAgICAgIyB0aGUgdHlwZSBlcXVhbGl0eSBsb29rdXAgbWVjaGFuaXNtCiAgICAgICAgICAgIHVucGlja2xlZF90ZXN0LmFzc2VydEVxdWFsKHNldCgpLCBzZXQoKSkKCiAgICBkZWYgdGVzdEtleWJvYXJkSW50ZXJydXB0KHNlbGYpOgogICAgICAgIGRlZiBfcmFpc2Uoc2VsZj1Ob25lKToKICAgICAgICAgICAgcmFpc2UgS2V5Ym9hcmRJbnRlcnJ1cHQKICAgICAgICBkZWYgbm90aGluZyhzZWxmKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBjbGFzcyBUZXN0MSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHRlc3Rfc29tZXRoaW5nID0gX3JhaXNlCgogICAgICAgIGNsYXNzIFRlc3QyKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgc2V0VXAgPSBfcmFpc2UKICAgICAgICAgICAgdGVzdF9zb21ldGhpbmcgPSBub3RoaW5nCgogICAgICAgIGNsYXNzIFRlc3QzKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgdGVzdF9zb21ldGhpbmcgPSBub3RoaW5nCiAgICAgICAgICAgIHRlYXJEb3duID0gX3JhaXNlCgogICAgICAgIGNsYXNzIFRlc3Q0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Rfc29tZXRoaW5nKHNlbGYpOgogICAgICAgICAgICAgICAgc2VsZi5hZGRDbGVhbnVwKF9yYWlzZSkKCiAgICAgICAgZm9yIGtsYXNzIGluIChUZXN0MSwgVGVzdDIsIFRlc3QzLCBUZXN0NCk6CiAgICAgICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoS2V5Ym9hcmRJbnRlcnJ1cHQpOgogICAgICAgICAgICAgICAga2xhc3MoJ3Rlc3Rfc29tZXRoaW5nJykucnVuKCkKCiAgICBkZWYgdGVzdFNraXBwaW5nRXZlcnl3aGVyZShzZWxmKToKICAgICAgICBkZWYgX3NraXAoc2VsZj1Ob25lKToKICAgICAgICAgICAgcmFpc2UgdW5pdHRlc3QuU2tpcFRlc3QoJ3NvbWUgcmVhc29uJykKICAgICAgICBkZWYgbm90aGluZyhzZWxmKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBjbGFzcyBUZXN0MSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHRlc3Rfc29tZXRoaW5nID0gX3NraXAKCiAgICAgICAgY2xhc3MgVGVzdDIodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBzZXRVcCA9IF9za2lwCiAgICAgICAgICAgIHRlc3Rfc29tZXRoaW5nID0gbm90aGluZwoKICAgICAgICBjbGFzcyBUZXN0Myh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHRlc3Rfc29tZXRoaW5nID0gbm90aGluZwogICAgICAgICAgICB0ZWFyRG93biA9IF9za2lwCgogICAgICAgIGNsYXNzIFRlc3Q0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Rfc29tZXRoaW5nKHNlbGYpOgogICAgICAgICAgICAgICAgc2VsZi5hZGRDbGVhbnVwKF9za2lwKQoKICAgICAgICBmb3Iga2xhc3MgaW4gKFRlc3QxLCBUZXN0MiwgVGVzdDMsIFRlc3Q0KToKICAgICAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgICAgIGtsYXNzKCd0ZXN0X3NvbWV0aGluZycpLnJ1bihyZXN1bHQpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5za2lwcGVkKSwgMSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDEpCgogICAgZGVmIHRlc3RTeXN0ZW1FeGl0KHNlbGYpOgogICAgICAgIGRlZiBfcmFpc2Uoc2VsZj1Ob25lKToKICAgICAgICAgICAgcmFpc2UgU3lzdGVtRXhpdAogICAgICAgIGRlZiBub3RoaW5nKHNlbGYpOgogICAgICAgICAgICBwYXNzCgogICAgICAgIGNsYXNzIFRlc3QxKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgdGVzdF9zb21ldGhpbmcgPSBfcmFpc2UKCiAgICAgICAgY2xhc3MgVGVzdDIodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBzZXRVcCA9IF9yYWlzZQogICAgICAgICAgICB0ZXN0X3NvbWV0aGluZyA9IG5vdGhpbmcKCiAgICAgICAgY2xhc3MgVGVzdDModW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICB0ZXN0X3NvbWV0aGluZyA9IG5vdGhpbmcKICAgICAgICAgICAgdGVhckRvd24gPSBfcmFpc2UKCiAgICAgICAgY2xhc3MgVGVzdDQodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF9zb21ldGhpbmcoc2VsZik6CiAgICAgICAgICAgICAgICBzZWxmLmFkZENsZWFudXAoX3JhaXNlKQoKICAgICAgICBmb3Iga2xhc3MgaW4gKFRlc3QxLCBUZXN0MiwgVGVzdDMsIFRlc3Q0KToKICAgICAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgICAgIGtsYXNzKCd0ZXN0X3NvbWV0aGluZycpLnJ1bihyZXN1bHQpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAxKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC50ZXN0c1J1biwgMSkKCiAgICBAc3VwcG9ydC5jcHl0aG9uX29ubHkKICAgIGRlZiB0ZXN0Tm9DeWNsZXMoc2VsZik6CiAgICAgICAgY2FzZSA9IHVuaXR0ZXN0LlRlc3RDYXNlKCkKICAgICAgICB3ciA9IHdlYWtyZWYucmVmKGNhc2UpCiAgICAgICAgd2l0aCBzdXBwb3J0LmRpc2FibGVfZ2MoKToKICAgICAgICAgICAgZGVsIGNhc2UKICAgICAgICAgICAgc2VsZi5hc3NlcnRGYWxzZSh3cigpKQo=',
'/Lib/unittest/test/test_discovery.py':'aW1wb3J0IG9zCmltcG9ydCByZQppbXBvcnQgc3lzCgppbXBvcnQgdW5pdHRlc3QKCgpjbGFzcyBUZXN0YWJsZVRlc3RQcm9ncmFtKHVuaXR0ZXN0LlRlc3RQcm9ncmFtKToKICAgIG1vZHVsZSA9ICdfX21haW5fXycKICAgIGV4aXQgPSBUcnVlCiAgICBkZWZhdWx0VGVzdCA9IGZhaWxmYXN0ID0gY2F0Y2hicmVhayA9IGJ1ZmZlciA9IE5vbmUKICAgIHZlcmJvc2l0eSA9IDEKICAgIHByb2dOYW1lID0gJycKICAgIHRlc3RSdW5uZXIgPSB0ZXN0TG9hZGVyID0gTm9uZQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBwYXNzCgoKY2xhc3MgVGVzdERpc2NvdmVyeSh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgIyBIZWF2aWx5IG1vY2tlZCB0ZXN0cyBzbyBJIGNhbiBhdm9pZCBoaXR0aW5nIHRoZSBmaWxlc3lzdGVtCiAgICBkZWYgdGVzdF9nZXRfbmFtZV9mcm9tX3BhdGgoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLl90b3BfbGV2ZWxfZGlyID0gJy9mb28nCiAgICAgICAgbmFtZSA9IGxvYWRlci5fZ2V0X25hbWVfZnJvbV9wYXRoKCcvZm9vL2Jhci9iYXoucHknKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobmFtZSwgJ2Jhci5iYXonKQoKICAgICAgICBpZiBub3QgX19kZWJ1Z19fOgogICAgICAgICAgICAjIGFzc2VydHMgYXJlIG9mZgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhBc3NlcnRpb25FcnJvcik6CiAgICAgICAgICAgIGxvYWRlci5fZ2V0X25hbWVfZnJvbV9wYXRoKCcvYmFyL2Jhei5weScpCgogICAgZGVmIHRlc3RfZmluZF90ZXN0cyhzZWxmKToKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgb3JpZ2luYWxfbGlzdGRpciA9IG9zLmxpc3RkaXIKICAgICAgICBkZWYgcmVzdG9yZV9saXN0ZGlyKCk6CiAgICAgICAgICAgIG9zLmxpc3RkaXIgPSBvcmlnaW5hbF9saXN0ZGlyCiAgICAgICAgb3JpZ2luYWxfaXNmaWxlID0gb3MucGF0aC5pc2ZpbGUKICAgICAgICBkZWYgcmVzdG9yZV9pc2ZpbGUoKToKICAgICAgICAgICAgb3MucGF0aC5pc2ZpbGUgPSBvcmlnaW5hbF9pc2ZpbGUKICAgICAgICBvcmlnaW5hbF9pc2RpciA9IG9zLnBhdGguaXNkaXIKICAgICAgICBkZWYgcmVzdG9yZV9pc2RpcigpOgogICAgICAgICAgICBvcy5wYXRoLmlzZGlyID0gb3JpZ2luYWxfaXNkaXIKCiAgICAgICAgcGF0aF9saXN0cyA9IFtbJ3Rlc3QxLnB5JywgJ3Rlc3QyLnB5JywgJ25vdF9hX3Rlc3QucHknLCAndGVzdF9kaXInLAogICAgICAgICAgICAgICAgICAgICAgICd0ZXN0LmZvbycsICd0ZXN0LW5vdC1hLW1vZHVsZS5weScsICdhbm90aGVyX2RpciddLAogICAgICAgICAgICAgICAgICAgICAgWyd0ZXN0My5weScsICd0ZXN0NC5weScsIF1dCiAgICAgICAgb3MubGlzdGRpciA9IGxhbWJkYSBwYXRoOiBwYXRoX2xpc3RzLnBvcCgwKQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChyZXN0b3JlX2xpc3RkaXIpCgogICAgICAgIGRlZiBpc2RpcihwYXRoKToKICAgICAgICAgICAgcmV0dXJuIHBhdGguZW5kc3dpdGgoJ2RpcicpCiAgICAgICAgb3MucGF0aC5pc2RpciA9IGlzZGlyCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHJlc3RvcmVfaXNkaXIpCgogICAgICAgIGRlZiBpc2ZpbGUocGF0aCk6CiAgICAgICAgICAgICMgYW5vdGhlcl9kaXIgaXMgbm90IGEgcGFja2FnZSBhbmQgc28gc2hvdWxkbid0IGJlIHJlY3Vyc2VkIGludG8KICAgICAgICAgICAgcmV0dXJuIG5vdCBwYXRoLmVuZHN3aXRoKCdkaXInKSBhbmQgbm90ICdhbm90aGVyX2RpcicgaW4gcGF0aAogICAgICAgIG9zLnBhdGguaXNmaWxlID0gaXNmaWxlCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHJlc3RvcmVfaXNmaWxlKQoKICAgICAgICBsb2FkZXIuX2dldF9tb2R1bGVfZnJvbV9uYW1lID0gbGFtYmRhIHBhdGg6IHBhdGggKyAnIG1vZHVsZScKICAgICAgICBsb2FkZXIubG9hZFRlc3RzRnJvbU1vZHVsZSA9IGxhbWJkYSBtb2R1bGU6IG1vZHVsZSArICcgdGVzdHMnCgogICAgICAgIHRvcF9sZXZlbCA9IG9zLnBhdGguYWJzcGF0aCgnL2ZvbycpCiAgICAgICAgbG9hZGVyLl90b3BfbGV2ZWxfZGlyID0gdG9wX2xldmVsCiAgICAgICAgc3VpdGUgPSBsaXN0KGxvYWRlci5fZmluZF90ZXN0cyh0b3BfbGV2ZWwsICd0ZXN0Ki5weScpKQoKICAgICAgICBleHBlY3RlZCA9IFtuYW1lICsgJyBtb2R1bGUgdGVzdHMnIGZvciBuYW1lIGluCiAgICAgICAgICAgICAgICAgICAgKCd0ZXN0MScsICd0ZXN0MicpXQogICAgICAgIGV4cGVjdGVkLmV4dGVuZChbKCd0ZXN0X2Rpci4lcycgJSBuYW1lKSArICcgbW9kdWxlIHRlc3RzJyBmb3IgbmFtZSBpbgogICAgICAgICAgICAgICAgICAgICgndGVzdDMnLCAndGVzdDQnKV0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdWl0ZSwgZXhwZWN0ZWQpCgogICAgZGVmIHRlc3RfZmluZF90ZXN0c193aXRoX3BhY2thZ2Uoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCgogICAgICAgIG9yaWdpbmFsX2xpc3RkaXIgPSBvcy5saXN0ZGlyCiAgICAgICAgZGVmIHJlc3RvcmVfbGlzdGRpcigpOgogICAgICAgICAgICBvcy5saXN0ZGlyID0gb3JpZ2luYWxfbGlzdGRpcgogICAgICAgIG9yaWdpbmFsX2lzZmlsZSA9IG9zLnBhdGguaXNmaWxlCiAgICAgICAgZGVmIHJlc3RvcmVfaXNmaWxlKCk6CiAgICAgICAgICAgIG9zLnBhdGguaXNmaWxlID0gb3JpZ2luYWxfaXNmaWxlCiAgICAgICAgb3JpZ2luYWxfaXNkaXIgPSBvcy5wYXRoLmlzZGlyCiAgICAgICAgZGVmIHJlc3RvcmVfaXNkaXIoKToKICAgICAgICAgICAgb3MucGF0aC5pc2RpciA9IG9yaWdpbmFsX2lzZGlyCgogICAgICAgIGRpcmVjdG9yaWVzID0gWydhX2RpcmVjdG9yeScsICd0ZXN0X2RpcmVjdG9yeScsICd0ZXN0X2RpcmVjdG9yeTInXQogICAgICAgIHBhdGhfbGlzdHMgPSBbZGlyZWN0b3JpZXMsIFtdLCBbXSwgW11dCiAgICAgICAgb3MubGlzdGRpciA9IGxhbWJkYSBwYXRoOiBwYXRoX2xpc3RzLnBvcCgwKQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChyZXN0b3JlX2xpc3RkaXIpCgogICAgICAgIG9zLnBhdGguaXNkaXIgPSBsYW1iZGEgcGF0aDogVHJ1ZQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChyZXN0b3JlX2lzZGlyKQoKICAgICAgICBvcy5wYXRoLmlzZmlsZSA9IGxhbWJkYSBwYXRoOiBvcy5wYXRoLmJhc2VuYW1lKHBhdGgpIG5vdCBpbiBkaXJlY3RvcmllcwogICAgICAgIHNlbGYuYWRkQ2xlYW51cChyZXN0b3JlX2lzZmlsZSkKCiAgICAgICAgY2xhc3MgTW9kdWxlKG9iamVjdCk6CiAgICAgICAgICAgIHBhdGhzID0gW10KICAgICAgICAgICAgbG9hZF90ZXN0c19hcmdzID0gW10KCiAgICAgICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBwYXRoKToKICAgICAgICAgICAgICAgIHNlbGYucGF0aCA9IHBhdGgKICAgICAgICAgICAgICAgIHNlbGYucGF0aHMuYXBwZW5kKHBhdGgpCiAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmJhc2VuYW1lKHBhdGgpID09ICd0ZXN0X2RpcmVjdG9yeSc6CiAgICAgICAgICAgICAgICAgICAgZGVmIGxvYWRfdGVzdHMobG9hZGVyLCB0ZXN0cywgcGF0dGVybik6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubG9hZF90ZXN0c19hcmdzLmFwcGVuZCgobG9hZGVyLCB0ZXN0cywgcGF0dGVybikpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnbG9hZF90ZXN0cycKICAgICAgICAgICAgICAgICAgICBzZWxmLmxvYWRfdGVzdHMgPSBsb2FkX3Rlc3RzCgogICAgICAgICAgICBkZWYgX19lcV9fKHNlbGYsIG90aGVyKToKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnBhdGggPT0gb3RoZXIucGF0aAoKICAgICAgICBsb2FkZXIuX2dldF9tb2R1bGVfZnJvbV9uYW1lID0gbGFtYmRhIG5hbWU6IE1vZHVsZShuYW1lKQogICAgICAgIGRlZiBsb2FkVGVzdHNGcm9tTW9kdWxlKG1vZHVsZSwgdXNlX2xvYWRfdGVzdHMpOgogICAgICAgICAgICBpZiB1c2VfbG9hZF90ZXN0czoKICAgICAgICAgICAgICAgIHJhaXNlIHNlbGYuZmFpbHVyZUV4Y2VwdGlvbigndXNlX2xvYWRfdGVzdHMgc2hvdWxkIGJlIEZhbHNlIGZvciBwYWNrYWdlcycpCiAgICAgICAgICAgIHJldHVybiBtb2R1bGUucGF0aCArICcgbW9kdWxlIHRlc3RzJwogICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tTW9kdWxlID0gbG9hZFRlc3RzRnJvbU1vZHVsZQoKICAgICAgICBsb2FkZXIuX3RvcF9sZXZlbF9kaXIgPSAnL2ZvbycKICAgICAgICAjIHRoaXMgdGltZSBubyAnLnB5JyBvbiB0aGUgcGF0dGVybiBzbyB0aGF0IGl0IGNhbiBtYXRjaAogICAgICAgICMgYSB0ZXN0IHBhY2thZ2UKICAgICAgICBzdWl0ZSA9IGxpc3QobG9hZGVyLl9maW5kX3Rlc3RzKCcvZm9vJywgJ3Rlc3QqJykpCgogICAgICAgICMgV2Ugc2hvdWxkIGhhdmUgbG9hZGVkIHRlc3RzIGZyb20gdGhlIHRlc3RfZGlyZWN0b3J5IHBhY2thZ2UgYnkgY2FsbGluZyBsb2FkX3Rlc3RzCiAgICAgICAgIyBhbmQgZGlyZWN0bHkgZnJvbSB0aGUgdGVzdF9kaXJlY3RvcnkyIHBhY2thZ2UKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN1aXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgWydsb2FkX3Rlc3RzJywgJ3Rlc3RfZGlyZWN0b3J5MicgKyAnIG1vZHVsZSB0ZXN0cyddKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoTW9kdWxlLnBhdGhzLCBbJ3Rlc3RfZGlyZWN0b3J5JywgJ3Rlc3RfZGlyZWN0b3J5MiddKQoKICAgICAgICAjIGxvYWRfdGVzdHMgc2hvdWxkIGhhdmUgYmVlbiBjYWxsZWQgb25jZSB3aXRoIGxvYWRlciwgdGVzdHMgYW5kIHBhdHRlcm4KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKE1vZHVsZS5sb2FkX3Rlc3RzX2FyZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICBbKGxvYWRlciwgJ3Rlc3RfZGlyZWN0b3J5JyArICcgbW9kdWxlIHRlc3RzJywgJ3Rlc3QqJyldKQoKICAgIGRlZiB0ZXN0X2Rpc2NvdmVyKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICBvcmlnaW5hbF9pc2ZpbGUgPSBvcy5wYXRoLmlzZmlsZQogICAgICAgIG9yaWdpbmFsX2lzZGlyID0gb3MucGF0aC5pc2RpcgogICAgICAgIGRlZiByZXN0b3JlX2lzZmlsZSgpOgogICAgICAgICAgICBvcy5wYXRoLmlzZmlsZSA9IG9yaWdpbmFsX2lzZmlsZQoKICAgICAgICBvcy5wYXRoLmlzZmlsZSA9IGxhbWJkYSBwYXRoOiBGYWxzZQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChyZXN0b3JlX2lzZmlsZSkKCiAgICAgICAgb3JpZ19zeXNfcGF0aCA9IHN5cy5wYXRoWzpdCiAgICAgICAgZGVmIHJlc3RvcmVfcGF0aCgpOgogICAgICAgICAgICBzeXMucGF0aFs6XSA9IG9yaWdfc3lzX3BhdGgKICAgICAgICBzZWxmLmFkZENsZWFudXAocmVzdG9yZV9wYXRoKQoKICAgICAgICBmdWxsX3BhdGggPSBvcy5wYXRoLmFic3BhdGgob3MucGF0aC5ub3JtcGF0aCgnL2ZvbycpKQogICAgICAgIHdpdGggc2VsZi5hc3NlcnRSYWlzZXMoSW1wb3J0RXJyb3IpOgogICAgICAgICAgICBsb2FkZXIuZGlzY292ZXIoJy9mb28vYmFyJywgdG9wX2xldmVsX2Rpcj0nL2ZvbycpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobG9hZGVyLl90b3BfbGV2ZWxfZGlyLCBmdWxsX3BhdGgpCiAgICAgICAgc2VsZi5hc3NlcnRJbihmdWxsX3BhdGgsIHN5cy5wYXRoKQoKICAgICAgICBvcy5wYXRoLmlzZmlsZSA9IGxhbWJkYSBwYXRoOiBUcnVlCiAgICAgICAgb3MucGF0aC5pc2RpciA9IGxhbWJkYSBwYXRoOiBUcnVlCgogICAgICAgIGRlZiByZXN0b3JlX2lzZGlyKCk6CiAgICAgICAgICAgIG9zLnBhdGguaXNkaXIgPSBvcmlnaW5hbF9pc2RpcgogICAgICAgIHNlbGYuYWRkQ2xlYW51cChyZXN0b3JlX2lzZGlyKQoKICAgICAgICBfZmluZF90ZXN0c19hcmdzID0gW10KICAgICAgICBkZWYgX2ZpbmRfdGVzdHMoc3RhcnRfZGlyLCBwYXR0ZXJuKToKICAgICAgICAgICAgX2ZpbmRfdGVzdHNfYXJncy5hcHBlbmQoKHN0YXJ0X2RpciwgcGF0dGVybikpCiAgICAgICAgICAgIHJldHVybiBbJ3Rlc3RzJ10KICAgICAgICBsb2FkZXIuX2ZpbmRfdGVzdHMgPSBfZmluZF90ZXN0cwogICAgICAgIGxvYWRlci5zdWl0ZUNsYXNzID0gc3RyCgogICAgICAgIHN1aXRlID0gbG9hZGVyLmRpc2NvdmVyKCcvZm9vL2Jhci9iYXonLCAncGF0dGVybicsICcvZm9vL2JhcicpCgogICAgICAgIHRvcF9sZXZlbF9kaXIgPSBvcy5wYXRoLmFic3BhdGgoJy9mb28vYmFyJykKICAgICAgICBzdGFydF9kaXIgPSBvcy5wYXRoLmFic3BhdGgoJy9mb28vYmFyL2JheicpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdWl0ZSwgIlsndGVzdHMnXSIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIuX3RvcF9sZXZlbF9kaXIsIHRvcF9sZXZlbF9kaXIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChfZmluZF90ZXN0c19hcmdzLCBbKHN0YXJ0X2RpciwgJ3BhdHRlcm4nKV0pCiAgICAgICAgc2VsZi5hc3NlcnRJbih0b3BfbGV2ZWxfZGlyLCBzeXMucGF0aCkKCiAgICBkZWYgdGVzdF9kaXNjb3Zlcl93aXRoX21vZHVsZXNfdGhhdF9mYWlsX3RvX2ltcG9ydChzZWxmKToKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgbGlzdGRpciA9IG9zLmxpc3RkaXIKICAgICAgICBvcy5saXN0ZGlyID0gbGFtYmRhIF86IFsndGVzdF90aGlzX2RvZXNfbm90X2V4aXN0LnB5J10KICAgICAgICBpc2ZpbGUgPSBvcy5wYXRoLmlzZmlsZQogICAgICAgIG9zLnBhdGguaXNmaWxlID0gbGFtYmRhIF86IFRydWUKICAgICAgICBvcmlnX3N5c19wYXRoID0gc3lzLnBhdGhbOl0KICAgICAgICBkZWYgcmVzdG9yZSgpOgogICAgICAgICAgICBvcy5wYXRoLmlzZmlsZSA9IGlzZmlsZQogICAgICAgICAgICBvcy5saXN0ZGlyID0gbGlzdGRpcgogICAgICAgICAgICBzeXMucGF0aFs6XSA9IG9yaWdfc3lzX3BhdGgKICAgICAgICBzZWxmLmFkZENsZWFudXAocmVzdG9yZSkKCiAgICAgICAgc3VpdGUgPSBsb2FkZXIuZGlzY292ZXIoJy4nKQogICAgICAgIHNlbGYuYXNzZXJ0SW4ob3MuZ2V0Y3dkKCksIHN5cy5wYXRoKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3VpdGUuY291bnRUZXN0Q2FzZXMoKSwgMSkKICAgICAgICB0ZXN0ID0gbGlzdChsaXN0KHN1aXRlKVswXSlbMF0gIyBleHRyYWN0IHRlc3QgZnJvbSBzdWl0ZQoKICAgICAgICB3aXRoIHNlbGYuYXNzZXJ0UmFpc2VzKEltcG9ydEVycm9yKToKICAgICAgICAgICAgdGVzdC50ZXN0X3RoaXNfZG9lc19ub3RfZXhpc3QoKQoKICAgIGRlZiB0ZXN0X2NvbW1hbmRfbGluZV9oYW5kbGluZ19wYXJzZUFyZ3Moc2VsZik6CiAgICAgICAgcHJvZ3JhbSA9IFRlc3RhYmxlVGVzdFByb2dyYW0oKQoKICAgICAgICBhcmdzID0gW10KICAgICAgICBkZWYgZG9fZGlzY292ZXJ5KGFyZ3YpOgogICAgICAgICAgICBhcmdzLmV4dGVuZChhcmd2KQogICAgICAgIHByb2dyYW0uX2RvX2Rpc2NvdmVyeSA9IGRvX2Rpc2NvdmVyeQogICAgICAgIHByb2dyYW0ucGFyc2VBcmdzKFsnc29tZXRoaW5nJywgJ2Rpc2NvdmVyJ10pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCBbXSkKCiAgICAgICAgcHJvZ3JhbS5wYXJzZUFyZ3MoWydzb21ldGhpbmcnLCAnZGlzY292ZXInLCAnZm9vJywgJ2JhciddKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgWydmb28nLCAnYmFyJ10pCgogICAgZGVmIHRlc3RfY29tbWFuZF9saW5lX2hhbmRsaW5nX2Rpc2NvdmVyX2J5X2RlZmF1bHQoc2VsZik6CiAgICAgICAgcHJvZ3JhbSA9IFRlc3RhYmxlVGVzdFByb2dyYW0oKQogICAgICAgIHByb2dyYW0ubW9kdWxlID0gTm9uZQoKICAgICAgICBzZWxmLmNhbGxlZCA9IEZhbHNlCiAgICAgICAgZGVmIGRvX2Rpc2NvdmVyeShhcmd2KToKICAgICAgICAgICAgc2VsZi5jYWxsZWQgPSBUcnVlCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJndiwgW10pCiAgICAgICAgcHJvZ3JhbS5fZG9fZGlzY292ZXJ5ID0gZG9fZGlzY292ZXJ5CiAgICAgICAgcHJvZ3JhbS5wYXJzZUFyZ3MoWydzb21ldGhpbmcnXSkKICAgICAgICBzZWxmLmFzc2VydFRydWUoc2VsZi5jYWxsZWQpCgogICAgZGVmIHRlc3RfY29tbWFuZF9saW5lX2hhbmRsaW5nX2Rpc2NvdmVyX2J5X2RlZmF1bHRfd2l0aF9vcHRpb25zKHNlbGYpOgogICAgICAgIHByb2dyYW0gPSBUZXN0YWJsZVRlc3RQcm9ncmFtKCkKICAgICAgICBwcm9ncmFtLm1vZHVsZSA9IE5vbmUKCiAgICAgICAgYXJncyA9IFsnc29tZXRoaW5nJywgJy12JywgJy1iJywgJy12JywgJy1jJywgJy1mJ10KICAgICAgICBzZWxmLmNhbGxlZCA9IEZhbHNlCiAgICAgICAgZGVmIGRvX2Rpc2NvdmVyeShhcmd2KToKICAgICAgICAgICAgc2VsZi5jYWxsZWQgPSBUcnVlCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJndiwgYXJnc1sxOl0pCiAgICAgICAgcHJvZ3JhbS5fZG9fZGlzY292ZXJ5ID0gZG9fZGlzY292ZXJ5CiAgICAgICAgcHJvZ3JhbS5wYXJzZUFyZ3MoYXJncykKICAgICAgICBzZWxmLmFzc2VydFRydWUoc2VsZi5jYWxsZWQpCgoKICAgIGRlZiB0ZXN0X2NvbW1hbmRfbGluZV9oYW5kbGluZ19kb19kaXNjb3ZlcnlfdG9vX21hbnlfYXJndW1lbnRzKHNlbGYpOgogICAgICAgIGNsYXNzIFN0b3AoRXhjZXB0aW9uKToKICAgICAgICAgICAgcGFzcwogICAgICAgIGRlZiB1c2FnZUV4aXQoKToKICAgICAgICAgICAgcmFpc2UgU3RvcAoKICAgICAgICBwcm9ncmFtID0gVGVzdGFibGVUZXN0UHJvZ3JhbSgpCiAgICAgICAgcHJvZ3JhbS51c2FnZUV4aXQgPSB1c2FnZUV4aXQKCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhTdG9wKToKICAgICAgICAgICAgIyB0b28gbWFueSBhcmdzCiAgICAgICAgICAgIHByb2dyYW0uX2RvX2Rpc2NvdmVyeShbJ29uZScsICd0d28nLCAndGhyZWUnLCAnZm91ciddKQoKCiAgICBkZWYgdGVzdF9jb21tYW5kX2xpbmVfaGFuZGxpbmdfZG9fZGlzY292ZXJ5X2NhbGxzX2xvYWRlcihzZWxmKToKICAgICAgICBwcm9ncmFtID0gVGVzdGFibGVUZXN0UHJvZ3JhbSgpCgogICAgICAgIGNsYXNzIExvYWRlcihvYmplY3QpOgogICAgICAgICAgICBhcmdzID0gW10KICAgICAgICAgICAgZGVmIGRpc2NvdmVyKHNlbGYsIHN0YXJ0X2RpciwgcGF0dGVybiwgdG9wX2xldmVsX2Rpcik6CiAgICAgICAgICAgICAgICBzZWxmLmFyZ3MuYXBwZW5kKChzdGFydF9kaXIsIHBhdHRlcm4sIHRvcF9sZXZlbF9kaXIpKQogICAgICAgICAgICAgICAgcmV0dXJuICd0ZXN0cycKCiAgICAgICAgcHJvZ3JhbS5fZG9fZGlzY292ZXJ5KFsnLXYnXSwgTG9hZGVyPUxvYWRlcikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHByb2dyYW0udmVyYm9zaXR5LCAyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS50ZXN0LCAndGVzdHMnKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoTG9hZGVyLmFyZ3MsIFsoJy4nLCAndGVzdCoucHknLCBOb25lKV0pCgogICAgICAgIExvYWRlci5hcmdzID0gW10KICAgICAgICBwcm9ncmFtID0gVGVzdGFibGVUZXN0UHJvZ3JhbSgpCiAgICAgICAgcHJvZ3JhbS5fZG9fZGlzY292ZXJ5KFsnLS12ZXJib3NlJ10sIExvYWRlcj1Mb2FkZXIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm9ncmFtLnRlc3QsICd0ZXN0cycpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChMb2FkZXIuYXJncywgWygnLicsICd0ZXN0Ki5weScsIE5vbmUpXSkKCiAgICAgICAgTG9hZGVyLmFyZ3MgPSBbXQogICAgICAgIHByb2dyYW0gPSBUZXN0YWJsZVRlc3RQcm9ncmFtKCkKICAgICAgICBwcm9ncmFtLl9kb19kaXNjb3ZlcnkoW10sIExvYWRlcj1Mb2FkZXIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm9ncmFtLnRlc3QsICd0ZXN0cycpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChMb2FkZXIuYXJncywgWygnLicsICd0ZXN0Ki5weScsIE5vbmUpXSkKCiAgICAgICAgTG9hZGVyLmFyZ3MgPSBbXQogICAgICAgIHByb2dyYW0gPSBUZXN0YWJsZVRlc3RQcm9ncmFtKCkKICAgICAgICBwcm9ncmFtLl9kb19kaXNjb3ZlcnkoWydmaXNoJ10sIExvYWRlcj1Mb2FkZXIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm9ncmFtLnRlc3QsICd0ZXN0cycpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChMb2FkZXIuYXJncywgWygnZmlzaCcsICd0ZXN0Ki5weScsIE5vbmUpXSkKCiAgICAgICAgTG9hZGVyLmFyZ3MgPSBbXQogICAgICAgIHByb2dyYW0gPSBUZXN0YWJsZVRlc3RQcm9ncmFtKCkKICAgICAgICBwcm9ncmFtLl9kb19kaXNjb3ZlcnkoWydmaXNoJywgJ2VnZ3MnXSwgTG9hZGVyPUxvYWRlcikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHByb2dyYW0udGVzdCwgJ3Rlc3RzJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKExvYWRlci5hcmdzLCBbKCdmaXNoJywgJ2VnZ3MnLCBOb25lKV0pCgogICAgICAgIExvYWRlci5hcmdzID0gW10KICAgICAgICBwcm9ncmFtID0gVGVzdGFibGVUZXN0UHJvZ3JhbSgpCiAgICAgICAgcHJvZ3JhbS5fZG9fZGlzY292ZXJ5KFsnZmlzaCcsICdlZ2dzJywgJ2hhbSddLCBMb2FkZXI9TG9hZGVyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS50ZXN0LCAndGVzdHMnKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoTG9hZGVyLmFyZ3MsIFsoJ2Zpc2gnLCAnZWdncycsICdoYW0nKV0pCgogICAgICAgIExvYWRlci5hcmdzID0gW10KICAgICAgICBwcm9ncmFtID0gVGVzdGFibGVUZXN0UHJvZ3JhbSgpCiAgICAgICAgcHJvZ3JhbS5fZG9fZGlzY292ZXJ5KFsnLXMnLCAnZmlzaCddLCBMb2FkZXI9TG9hZGVyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS50ZXN0LCAndGVzdHMnKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoTG9hZGVyLmFyZ3MsIFsoJ2Zpc2gnLCAndGVzdCoucHknLCBOb25lKV0pCgogICAgICAgIExvYWRlci5hcmdzID0gW10KICAgICAgICBwcm9ncmFtID0gVGVzdGFibGVUZXN0UHJvZ3JhbSgpCiAgICAgICAgcHJvZ3JhbS5fZG9fZGlzY292ZXJ5KFsnLXQnLCAnZmlzaCddLCBMb2FkZXI9TG9hZGVyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS50ZXN0LCAndGVzdHMnKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoTG9hZGVyLmFyZ3MsIFsoJy4nLCAndGVzdCoucHknLCAnZmlzaCcpXSkKCiAgICAgICAgTG9hZGVyLmFyZ3MgPSBbXQogICAgICAgIHByb2dyYW0gPSBUZXN0YWJsZVRlc3RQcm9ncmFtKCkKICAgICAgICBwcm9ncmFtLl9kb19kaXNjb3ZlcnkoWyctcCcsICdmaXNoJ10sIExvYWRlcj1Mb2FkZXIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm9ncmFtLnRlc3QsICd0ZXN0cycpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChMb2FkZXIuYXJncywgWygnLicsICdmaXNoJywgTm9uZSldKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UocHJvZ3JhbS5mYWlsZmFzdCkKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKHByb2dyYW0uY2F0Y2hicmVhaykKCiAgICAgICAgTG9hZGVyLmFyZ3MgPSBbXQogICAgICAgIHByb2dyYW0gPSBUZXN0YWJsZVRlc3RQcm9ncmFtKCkKICAgICAgICBwcm9ncmFtLl9kb19kaXNjb3ZlcnkoWyctcCcsICdlZ2dzJywgJy1zJywgJ2Zpc2gnLCAnLXYnLCAnLWYnLCAnLWMnXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9hZGVyPUxvYWRlcikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHByb2dyYW0udGVzdCwgJ3Rlc3RzJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKExvYWRlci5hcmdzLCBbKCdmaXNoJywgJ2VnZ3MnLCBOb25lKV0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm9ncmFtLnZlcmJvc2l0eSwgMikKICAgICAgICBzZWxmLmFzc2VydFRydWUocHJvZ3JhbS5mYWlsZmFzdCkKICAgICAgICBzZWxmLmFzc2VydFRydWUocHJvZ3JhbS5jYXRjaGJyZWFrKQoKICAgIGRlZiB0ZXN0X2RldGVjdF9tb2R1bGVfY2xhc2goc2VsZik6CiAgICAgICAgY2xhc3MgTW9kdWxlKG9iamVjdCk6CiAgICAgICAgICAgIF9fZmlsZV9fID0gJ2Jhci9mb28ucHknCiAgICAgICAgc3lzLm1vZHVsZXNbJ2ZvbyddID0gTW9kdWxlCiAgICAgICAgZnVsbF9wYXRoID0gb3MucGF0aC5hYnNwYXRoKCdmb28nKQogICAgICAgIG9yaWdpbmFsX2xpc3RkaXIgPSBvcy5saXN0ZGlyCiAgICAgICAgb3JpZ2luYWxfaXNmaWxlID0gb3MucGF0aC5pc2ZpbGUKICAgICAgICBvcmlnaW5hbF9pc2RpciA9IG9zLnBhdGguaXNkaXIKCiAgICAgICAgZGVmIGNsZWFudXAoKToKICAgICAgICAgICAgb3MubGlzdGRpciA9IG9yaWdpbmFsX2xpc3RkaXIKICAgICAgICAgICAgb3MucGF0aC5pc2ZpbGUgPSBvcmlnaW5hbF9pc2ZpbGUKICAgICAgICAgICAgb3MucGF0aC5pc2RpciA9IG9yaWdpbmFsX2lzZGlyCiAgICAgICAgICAgIGRlbCBzeXMubW9kdWxlc1snZm9vJ10KICAgICAgICAgICAgaWYgZnVsbF9wYXRoIGluIHN5cy5wYXRoOgogICAgICAgICAgICAgICAgc3lzLnBhdGgucmVtb3ZlKGZ1bGxfcGF0aCkKICAgICAgICBzZWxmLmFkZENsZWFudXAoY2xlYW51cCkKCiAgICAgICAgZGVmIGxpc3RkaXIoXyk6CiAgICAgICAgICAgIHJldHVybiBbJ2Zvby5weSddCiAgICAgICAgZGVmIGlzZmlsZShfKToKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBkZWYgaXNkaXIoXyk6CiAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgb3MubGlzdGRpciA9IGxpc3RkaXIKICAgICAgICBvcy5wYXRoLmlzZmlsZSA9IGlzZmlsZQogICAgICAgIG9zLnBhdGguaXNkaXIgPSBpc2RpcgoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgbW9kX2RpciA9IG9zLnBhdGguYWJzcGF0aCgnYmFyJykKICAgICAgICBleHBlY3RlZF9kaXIgPSBvcy5wYXRoLmFic3BhdGgoJ2ZvbycpCiAgICAgICAgbXNnID0gcmUuZXNjYXBlKHIiJ2ZvbycgbW9kdWxlIGluY29ycmVjdGx5IGltcG9ydGVkIGZyb20gJXIuIEV4cGVjdGVkICVyLiAiCiAgICAgICAgICAgICAgICAiSXMgdGhpcyBtb2R1bGUgZ2xvYmFsbHkgaW5zdGFsbGVkPyIgJSAobW9kX2RpciwgZXhwZWN0ZWRfZGlyKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1JlZ2V4KAogICAgICAgICAgICBJbXBvcnRFcnJvciwgJ14lcyQnICUgbXNnLCBsb2FkZXIuZGlzY292ZXIsCiAgICAgICAgICAgIHN0YXJ0X2Rpcj0nZm9vJywgcGF0dGVybj0nZm9vLnB5JwogICAgICAgICkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN5cy5wYXRoWzBdLCBmdWxsX3BhdGgpCgoKICAgIGRlZiB0ZXN0X2Rpc2NvdmVyeV9mcm9tX2RvdHRlZF9wYXRoKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICB0ZXN0cyA9IFtzZWxmXQogICAgICAgIGV4cGVjdGVkUGF0aCA9IG9zLnBhdGguYWJzcGF0aChvcy5wYXRoLmRpcm5hbWUodW5pdHRlc3QudGVzdC5fX2ZpbGVfXykpCgogICAgICAgIHNlbGYud2FzUnVuID0gRmFsc2UKICAgICAgICBkZWYgX2ZpbmRfdGVzdHMoc3RhcnRfZGlyLCBwYXR0ZXJuKToKICAgICAgICAgICAgc2VsZi53YXNSdW4gPSBUcnVlCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RhcnRfZGlyLCBleHBlY3RlZFBhdGgpCiAgICAgICAgICAgIHJldHVybiB0ZXN0cwogICAgICAgIGxvYWRlci5fZmluZF90ZXN0cyA9IF9maW5kX3Rlc3RzCiAgICAgICAgc3VpdGUgPSBsb2FkZXIuZGlzY292ZXIoJ3VuaXR0ZXN0LnRlc3QnKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShzZWxmLndhc1J1bikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN1aXRlLl90ZXN0cywgdGVzdHMpCgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIHVuaXR0ZXN0Lm1haW4oKQo=',
'/Lib/unittest/test/test_functiontestcase.py':'aW1wb3J0IHVuaXR0ZXN0Cgpmcm9tIC5zdXBwb3J0IGltcG9ydCBMb2dnaW5nUmVzdWx0CgoKY2xhc3MgVGVzdF9GdW5jdGlvblRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKCiAgICAjICJSZXR1cm4gdGhlIG51bWJlciBvZiB0ZXN0cyByZXByZXNlbnRlZCBieSB0aGUgdGhpcyB0ZXN0IG9iamVjdC4gRm9yCiAgICAjIFRlc3RDYXNlIGluc3RhbmNlcywgdGhpcyB3aWxsIGFsd2F5cyBiZSAxIgogICAgZGVmIHRlc3RfY291bnRUZXN0Q2FzZXMoc2VsZik6CiAgICAgICAgdGVzdCA9IHVuaXR0ZXN0LkZ1bmN0aW9uVGVzdENhc2UobGFtYmRhOiBOb25lKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHRlc3QuY291bnRUZXN0Q2FzZXMoKSwgMSkKCiAgICAjICJXaGVuIGEgc2V0VXAoKSBtZXRob2QgaXMgZGVmaW5lZCwgdGhlIHRlc3QgcnVubmVyIHdpbGwgcnVuIHRoYXQgbWV0aG9kCiAgICAjIHByaW9yIHRvIGVhY2ggdGVzdC4gTGlrZXdpc2UsIGlmIGEgdGVhckRvd24oKSBtZXRob2QgaXMgZGVmaW5lZCwgdGhlCiAgICAjIHRlc3QgcnVubmVyIHdpbGwgaW52b2tlIHRoYXQgbWV0aG9kIGFmdGVyIGVhY2ggdGVzdC4gSW4gdGhlIGV4YW1wbGUsCiAgICAjIHNldFVwKCkgd2FzIHVzZWQgdG8gY3JlYXRlIGEgZnJlc2ggc2VxdWVuY2UgZm9yIGVhY2ggdGVzdC4iCiAgICAjCiAgICAjIE1ha2Ugc3VyZSB0aGUgcHJvcGVyIGNhbGwgb3JkZXIgaXMgbWFpbnRhaW5lZCwgZXZlbiBpZiBzZXRVcCgpIHJhaXNlcwogICAgIyBhbiBleGNlcHRpb24uCiAgICBkZWYgdGVzdF9ydW5fY2FsbF9vcmRlcl9fZXJyb3JfaW5fc2V0VXAoc2VsZik6CiAgICAgICAgZXZlbnRzID0gW10KICAgICAgICByZXN1bHQgPSBMb2dnaW5nUmVzdWx0KGV2ZW50cykKCiAgICAgICAgZGVmIHNldFVwKCk6CiAgICAgICAgICAgIGV2ZW50cy5hcHBlbmQoJ3NldFVwJykKICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCdyYWlzZWQgYnkgc2V0VXAnKQoKICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICBldmVudHMuYXBwZW5kKCd0ZXN0JykKCiAgICAgICAgZGVmIHRlYXJEb3duKCk6CiAgICAgICAgICAgIGV2ZW50cy5hcHBlbmQoJ3RlYXJEb3duJykKCiAgICAgICAgZXhwZWN0ZWQgPSBbJ3N0YXJ0VGVzdCcsICdzZXRVcCcsICdhZGRFcnJvcicsICdzdG9wVGVzdCddCiAgICAgICAgdW5pdHRlc3QuRnVuY3Rpb25UZXN0Q2FzZSh0ZXN0LCBzZXRVcCwgdGVhckRvd24pLnJ1bihyZXN1bHQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIGV4cGVjdGVkKQoKICAgICMgIldoZW4gYSBzZXRVcCgpIG1ldGhvZCBpcyBkZWZpbmVkLCB0aGUgdGVzdCBydW5uZXIgd2lsbCBydW4gdGhhdCBtZXRob2QKICAgICMgcHJpb3IgdG8gZWFjaCB0ZXN0LiBMaWtld2lzZSwgaWYgYSB0ZWFyRG93bigpIG1ldGhvZCBpcyBkZWZpbmVkLCB0aGUKICAgICMgdGVzdCBydW5uZXIgd2lsbCBpbnZva2UgdGhhdCBtZXRob2QgYWZ0ZXIgZWFjaCB0ZXN0LiBJbiB0aGUgZXhhbXBsZSwKICAgICMgc2V0VXAoKSB3YXMgdXNlZCB0byBjcmVhdGUgYSBmcmVzaCBzZXF1ZW5jZSBmb3IgZWFjaCB0ZXN0LiIKICAgICMKICAgICMgTWFrZSBzdXJlIHRoZSBwcm9wZXIgY2FsbCBvcmRlciBpcyBtYWludGFpbmVkLCBldmVuIGlmIHRoZSB0ZXN0IHJhaXNlcwogICAgIyBhbiBlcnJvciAoYXMgb3Bwb3NlZCB0byBhIGZhaWx1cmUpLgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2Vycm9yX2luX3Rlc3Qoc2VsZik6CiAgICAgICAgZXZlbnRzID0gW10KICAgICAgICByZXN1bHQgPSBMb2dnaW5nUmVzdWx0KGV2ZW50cykKCiAgICAgICAgZGVmIHNldFVwKCk6CiAgICAgICAgICAgIGV2ZW50cy5hcHBlbmQoJ3NldFVwJykKCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgZXZlbnRzLmFwcGVuZCgndGVzdCcpCiAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigncmFpc2VkIGJ5IHRlc3QnKQoKICAgICAgICBkZWYgdGVhckRvd24oKToKICAgICAgICAgICAgZXZlbnRzLmFwcGVuZCgndGVhckRvd24nKQoKICAgICAgICBleHBlY3RlZCA9IFsnc3RhcnRUZXN0JywgJ3NldFVwJywgJ3Rlc3QnLCAndGVhckRvd24nLAogICAgICAgICAgICAgICAgICAgICdhZGRFcnJvcicsICdzdG9wVGVzdCddCiAgICAgICAgdW5pdHRlc3QuRnVuY3Rpb25UZXN0Q2FzZSh0ZXN0LCBzZXRVcCwgdGVhckRvd24pLnJ1bihyZXN1bHQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIGV4cGVjdGVkKQoKICAgICMgIldoZW4gYSBzZXRVcCgpIG1ldGhvZCBpcyBkZWZpbmVkLCB0aGUgdGVzdCBydW5uZXIgd2lsbCBydW4gdGhhdCBtZXRob2QKICAgICMgcHJpb3IgdG8gZWFjaCB0ZXN0LiBMaWtld2lzZSwgaWYgYSB0ZWFyRG93bigpIG1ldGhvZCBpcyBkZWZpbmVkLCB0aGUKICAgICMgdGVzdCBydW5uZXIgd2lsbCBpbnZva2UgdGhhdCBtZXRob2QgYWZ0ZXIgZWFjaCB0ZXN0LiBJbiB0aGUgZXhhbXBsZSwKICAgICMgc2V0VXAoKSB3YXMgdXNlZCB0byBjcmVhdGUgYSBmcmVzaCBzZXF1ZW5jZSBmb3IgZWFjaCB0ZXN0LiIKICAgICMKICAgICMgTWFrZSBzdXJlIHRoZSBwcm9wZXIgY2FsbCBvcmRlciBpcyBtYWludGFpbmVkLCBldmVuIGlmIHRoZSB0ZXN0IHNpZ25hbHMKICAgICMgYSBmYWlsdXJlIChhcyBvcHBvc2VkIHRvIGFuIGVycm9yKS4KICAgIGRlZiB0ZXN0X3J1bl9jYWxsX29yZGVyX19mYWlsdXJlX2luX3Rlc3Qoc2VsZik6CiAgICAgICAgZXZlbnRzID0gW10KICAgICAgICByZXN1bHQgPSBMb2dnaW5nUmVzdWx0KGV2ZW50cykKCiAgICAgICAgZGVmIHNldFVwKCk6CiAgICAgICAgICAgIGV2ZW50cy5hcHBlbmQoJ3NldFVwJykKCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgZXZlbnRzLmFwcGVuZCgndGVzdCcpCiAgICAgICAgICAgIHNlbGYuZmFpbCgncmFpc2VkIGJ5IHRlc3QnKQoKICAgICAgICBkZWYgdGVhckRvd24oKToKICAgICAgICAgICAgZXZlbnRzLmFwcGVuZCgndGVhckRvd24nKQoKICAgICAgICBleHBlY3RlZCA9IFsnc3RhcnRUZXN0JywgJ3NldFVwJywgJ3Rlc3QnLCAndGVhckRvd24nLAogICAgICAgICAgICAgICAgICAgICdhZGRGYWlsdXJlJywgJ3N0b3BUZXN0J10KICAgICAgICB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKHRlc3QsIHNldFVwLCB0ZWFyRG93bikucnVuKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywgZXhwZWN0ZWQpCgogICAgIyAiV2hlbiBhIHNldFVwKCkgbWV0aG9kIGlzIGRlZmluZWQsIHRoZSB0ZXN0IHJ1bm5lciB3aWxsIHJ1biB0aGF0IG1ldGhvZAogICAgIyBwcmlvciB0byBlYWNoIHRlc3QuIExpa2V3aXNlLCBpZiBhIHRlYXJEb3duKCkgbWV0aG9kIGlzIGRlZmluZWQsIHRoZQogICAgIyB0ZXN0IHJ1bm5lciB3aWxsIGludm9rZSB0aGF0IG1ldGhvZCBhZnRlciBlYWNoIHRlc3QuIEluIHRoZSBleGFtcGxlLAogICAgIyBzZXRVcCgpIHdhcyB1c2VkIHRvIGNyZWF0ZSBhIGZyZXNoIHNlcXVlbmNlIGZvciBlYWNoIHRlc3QuIgogICAgIwogICAgIyBNYWtlIHN1cmUgdGhlIHByb3BlciBjYWxsIG9yZGVyIGlzIG1haW50YWluZWQsIGV2ZW4gaWYgdGVhckRvd24oKSByYWlzZXMKICAgICMgYW4gZXhjZXB0aW9uLgogICAgZGVmIHRlc3RfcnVuX2NhbGxfb3JkZXJfX2Vycm9yX2luX3RlYXJEb3duKHNlbGYpOgogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCgogICAgICAgIGRlZiBzZXRVcCgpOgogICAgICAgICAgICBldmVudHMuYXBwZW5kKCdzZXRVcCcpCgogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIGV2ZW50cy5hcHBlbmQoJ3Rlc3QnKQoKICAgICAgICBkZWYgdGVhckRvd24oKToKICAgICAgICAgICAgZXZlbnRzLmFwcGVuZCgndGVhckRvd24nKQogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoJ3JhaXNlZCBieSB0ZWFyRG93bicpCgogICAgICAgIGV4cGVjdGVkID0gWydzdGFydFRlc3QnLCAnc2V0VXAnLCAndGVzdCcsICd0ZWFyRG93bicsICdhZGRFcnJvcicsCiAgICAgICAgICAgICAgICAgICAgJ3N0b3BUZXN0J10KICAgICAgICB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKHRlc3QsIHNldFVwLCB0ZWFyRG93bikucnVuKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywgZXhwZWN0ZWQpCgogICAgIyAiUmV0dXJuIGEgc3RyaW5nIGlkZW50aWZ5aW5nIHRoZSBzcGVjaWZpYyB0ZXN0IGNhc2UuIgogICAgIwogICAgIyBCZWNhdXNlIG9mIHRoZSB2YWd1ZSBuYXR1cmUgb2YgdGhlIGRvY3MsIEknbSBub3QgZ29pbmcgdG8gbG9jayB0aGlzCiAgICAjIHRlc3QgZG93biB0b28gbXVjaC4gUmVhbGx5IGFsbCB0aGF0IGNhbiBiZSBhc3NlcnRlZCBpcyB0aGF0IHRoZSBpZCgpCiAgICAjIHdpbGwgYmUgYSBzdHJpbmcgKGVpdGhlciA4LWJ5dGUgb3IgdW5pY29kZSAtLSBhZ2FpbiwgYmVjYXVzZSB0aGUgZG9jcwogICAgIyBqdXN0IHNheSAic3RyaW5nIikKICAgIGRlZiB0ZXN0X2lkKHNlbGYpOgogICAgICAgIHRlc3QgPSB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHRlc3QuaWQoKSwgc3RyKQoKICAgICMgIlJldHVybnMgYSBvbmUtbGluZSBkZXNjcmlwdGlvbiBvZiB0aGUgdGVzdCwgb3IgTm9uZSBpZiBubyBkZXNjcmlwdGlvbgogICAgIyBoYXMgYmVlbiBwcm92aWRlZC4gVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBtZXRob2QgcmV0dXJucwogICAgIyB0aGUgZmlyc3QgbGluZSBvZiB0aGUgdGVzdCBtZXRob2QncyBkb2NzdHJpbmcsIGlmIGF2YWlsYWJsZSwgb3IgTm9uZS4iCiAgICBkZWYgdGVzdF9zaG9ydERlc2NyaXB0aW9uX19ub19kb2NzdHJpbmcoc2VsZik6CiAgICAgICAgdGVzdCA9IHVuaXR0ZXN0LkZ1bmN0aW9uVGVzdENhc2UobGFtYmRhOiBOb25lKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHRlc3Quc2hvcnREZXNjcmlwdGlvbigpLCBOb25lKQoKICAgICMgIlJldHVybnMgYSBvbmUtbGluZSBkZXNjcmlwdGlvbiBvZiB0aGUgdGVzdCwgb3IgTm9uZSBpZiBubyBkZXNjcmlwdGlvbgogICAgIyBoYXMgYmVlbiBwcm92aWRlZC4gVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBtZXRob2QgcmV0dXJucwogICAgIyB0aGUgZmlyc3QgbGluZSBvZiB0aGUgdGVzdCBtZXRob2QncyBkb2NzdHJpbmcsIGlmIGF2YWlsYWJsZSwgb3IgTm9uZS4iCiAgICBkZWYgdGVzdF9zaG9ydERlc2NyaXB0aW9uX19zaW5nbGVsaW5lX2RvY3N0cmluZyhzZWxmKToKICAgICAgICBkZXNjID0gInRoaXMgdGVzdHMgZm9vIgogICAgICAgIHRlc3QgPSB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSwgZGVzY3JpcHRpb249ZGVzYykKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCh0ZXN0LnNob3J0RGVzY3JpcHRpb24oKSwgInRoaXMgdGVzdHMgZm9vIikK',
'/Lib/unittest/test/test_loader.py':'aW1wb3J0IHN5cwppbXBvcnQgdHlwZXMKCgppbXBvcnQgdW5pdHRlc3QKCgpjbGFzcyBUZXN0X1Rlc3RMb2FkZXIodW5pdHRlc3QuVGVzdENhc2UpOgoKICAgICMjIyBUZXN0cyBmb3IgVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tVGVzdENhc2UKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAjICJSZXR1cm4gYSBzdWl0ZSBvZiBhbGwgdGVzdHMgY2FzZXMgY29udGFpbmVkIGluIHRoZSBUZXN0Q2FzZS1kZXJpdmVkCiAgICAjIGNsYXNzIHRlc3RDYXNlQ2xhc3MiCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tVGVzdENhc2Uoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8yKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiBmb29fYmFyKHNlbGYpOiBwYXNzCgogICAgICAgIHRlc3RzID0gdW5pdHRlc3QuVGVzdFN1aXRlKFtGb28oJ3Rlc3RfMScpLCBGb28oJ3Rlc3RfMicpXSkKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIubG9hZFRlc3RzRnJvbVRlc3RDYXNlKEZvbyksIHRlc3RzKQoKICAgICMgIlJldHVybiBhIHN1aXRlIG9mIGFsbCB0ZXN0cyBjYXNlcyBjb250YWluZWQgaW4gdGhlIFRlc3RDYXNlLWRlcml2ZWQKICAgICMgY2xhc3MgdGVzdENhc2VDbGFzcyIKICAgICMKICAgICMgTWFrZSBzdXJlIGl0IGRvZXMgdGhlIHJpZ2h0IHRoaW5nIGV2ZW4gaWYgbm8gdGVzdHMgd2VyZSBmb3VuZAogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbVRlc3RDYXNlX19ub19tYXRjaGVzKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiBmb29fYmFyKHNlbGYpOiBwYXNzCgogICAgICAgIGVtcHR5X3N1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIubG9hZFRlc3RzRnJvbVRlc3RDYXNlKEZvbyksIGVtcHR5X3N1aXRlKQoKICAgICMgIlJldHVybiBhIHN1aXRlIG9mIGFsbCB0ZXN0cyBjYXNlcyBjb250YWluZWQgaW4gdGhlIFRlc3RDYXNlLWRlcml2ZWQKICAgICMgY2xhc3MgdGVzdENhc2VDbGFzcyIKICAgICMKICAgICMgV2hhdCBoYXBwZW5zIGlmIGxvYWRUZXN0c0Zyb21UZXN0Q2FzZSgpIGlzIGdpdmVuIGFuIG9iamVjdAogICAgIyB0aGF0IGlzbid0IGEgc3ViY2xhc3Mgb2YgVGVzdENhc2U/IFNwZWNpZmljYWxseSwgd2hhdCBoYXBwZW5zCiAgICAjIGlmIHRlc3RDYXNlQ2xhc3MgaXMgYSBzdWJjbGFzcyBvZiBUZXN0U3VpdGU/CiAgICAjCiAgICAjIFRoaXMgaXMgY2hlY2tlZCBmb3Igc3BlY2lmaWNhbGx5IGluIHRoZSBjb2RlLCBzbyB3ZSBiZXR0ZXIgYWRkIGEKICAgICMgdGVzdCBmb3IgaXQuCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tVGVzdENhc2VfX1Rlc3RTdWl0ZV9zdWJjbGFzcyhzZWxmKToKICAgICAgICBjbGFzcyBOb3RBVGVzdENhc2UodW5pdHRlc3QuVGVzdFN1aXRlKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tVGVzdENhc2UoTm90QVRlc3RDYXNlKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoJ1Nob3VsZCByYWlzZSBUeXBlRXJyb3InKQoKICAgICMgIlJldHVybiBhIHN1aXRlIG9mIGFsbCB0ZXN0cyBjYXNlcyBjb250YWluZWQgaW4gdGhlIFRlc3RDYXNlLWRlcml2ZWQKICAgICMgY2xhc3MgdGVzdENhc2VDbGFzcyIKICAgICMKICAgICMgTWFrZSBzdXJlIGxvYWRUZXN0c0Zyb21UZXN0Q2FzZSgpIHBpY2tzIHVwIHRoZSBkZWZhdWx0IHRlc3QgbWV0aG9kCiAgICAjIG5hbWUgKGFzIHNwZWNpZmllZCBieSBUZXN0Q2FzZSksIGV2ZW4gdGhvdWdoIHRoZSBtZXRob2QgbmFtZSBkb2VzCiAgICAjIG5vdCBtYXRjaCB0aGUgZGVmYXVsdCBUZXN0TG9hZGVyLnRlc3RNZXRob2RQcmVmaXggc3RyaW5nCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tVGVzdENhc2VfX2RlZmF1bHRfbWV0aG9kX25hbWUoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHJ1blRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgICMgVGhpcyBoYXMgdG8gYmUgZmFsc2UgZm9yIHRoZSB0ZXN0IHRvIHN1Y2NlZWQKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKCdydW5UZXN0Jy5zdGFydHN3aXRoKGxvYWRlci50ZXN0TWV0aG9kUHJlZml4KSkKCiAgICAgICAgc3VpdGUgPSBsb2FkZXIubG9hZFRlc3RzRnJvbVRlc3RDYXNlKEZvbykKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFtGb28oJ3J1blRlc3QnKV0pCgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgIyMjIC9UZXN0cyBmb3IgVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tVGVzdENhc2UKCiAgICAjIyMgVGVzdHMgZm9yIFRlc3RMb2FkZXIubG9hZFRlc3RzRnJvbU1vZHVsZQogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgICMgIlRoaXMgbWV0aG9kIHNlYXJjaGVzIGBtb2R1bGVgIGZvciBjbGFzc2VzIGRlcml2ZWQgZnJvbSBUZXN0Q2FzZSIKICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21Nb2R1bGVfX1Rlc3RDYXNlX3N1YmNsYXNzKHNlbGYpOgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBNeVRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgbS50ZXN0Y2FzZV8xID0gTXlUZXN0Q2FzZQoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTW9kdWxlKG0pCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHN1aXRlLCBsb2FkZXIuc3VpdGVDbGFzcykKCiAgICAgICAgZXhwZWN0ZWQgPSBbbG9hZGVyLnN1aXRlQ2xhc3MoW015VGVzdENhc2UoJ3Rlc3QnKV0pXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIGV4cGVjdGVkKQoKICAgICMgIlRoaXMgbWV0aG9kIHNlYXJjaGVzIGBtb2R1bGVgIGZvciBjbGFzc2VzIGRlcml2ZWQgZnJvbSBUZXN0Q2FzZSIKICAgICMKICAgICMgV2hhdCBoYXBwZW5zIGlmIG5vIHRlc3RzIGFyZSBmb3VuZCAobm8gVGVzdENhc2UgaW5zdGFuY2VzKT8KICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21Nb2R1bGVfX25vX1Rlc3RDYXNlX2luc3RhbmNlcyhzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21Nb2R1bGUobSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFtdKQoKICAgICMgIlRoaXMgbWV0aG9kIHNlYXJjaGVzIGBtb2R1bGVgIGZvciBjbGFzc2VzIGRlcml2ZWQgZnJvbSBUZXN0Q2FzZSIKICAgICMKICAgICMgV2hhdCBoYXBwZW5zIGlmIG5vIHRlc3RzIGFyZSBmb3VuZCAoVGVzdENhc2VzIGluc3RhbmNlcywgYnV0IG5vIHRlc3RzKT8KICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21Nb2R1bGVfX25vX1Rlc3RDYXNlX3Rlc3RzKHNlbGYpOgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBNeVRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgcGFzcwogICAgICAgIG0udGVzdGNhc2VfMSA9IE15VGVzdENhc2UKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgc3VpdGUgPSBsb2FkZXIubG9hZFRlc3RzRnJvbU1vZHVsZShtKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShzdWl0ZSwgbG9hZGVyLnN1aXRlQ2xhc3MpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFtsb2FkZXIuc3VpdGVDbGFzcygpXSkKCiAgICAjICJUaGlzIG1ldGhvZCBzZWFyY2hlcyBgbW9kdWxlYCBmb3IgY2xhc3NlcyBkZXJpdmVkIGZyb20gVGVzdENhc2UicwogICAgIwogICAgIyBXaGF0IGhhcHBlbnMgaWYgbG9hZFRlc3RzRnJvbU1vZHVsZSgpIGlzIGdpdmVuIHNvbWV0aGluZyBvdGhlcgogICAgIyB0aGFuIGEgbW9kdWxlPwogICAgIwogICAgIyBYWFggQ3VycmVudGx5LCBpdCBzdWNjZWVkcyBhbnl3YXkuIFRoaXMgZmxleGliaWxpdHkKICAgICMgc2hvdWxkIGVpdGhlciBiZSBkb2N1bWVudGVkIG9yIGxvYWRUZXN0c0Zyb21Nb2R1bGUoKSBzaG91bGQKICAgICMgcmFpc2UgYSBUeXBlRXJyb3IKICAgICMKICAgICMgWFhYIENlcnRhaW4gcGVvcGxlIGFyZSB1c2luZyB0aGlzIGJlaGF2aW91ci4gV2UnbGwgYWRkIGEgdGVzdCBmb3IgaXQKICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21Nb2R1bGVfX25vdF9hX21vZHVsZShzZWxmKToKICAgICAgICBjbGFzcyBNeVRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIGNsYXNzIE5vdEFNb2R1bGUob2JqZWN0KToKICAgICAgICAgICAgdGVzdF8yID0gTXlUZXN0Q2FzZQoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTW9kdWxlKE5vdEFNb2R1bGUpCgogICAgICAgIHJlZmVyZW5jZSA9IFt1bml0dGVzdC5UZXN0U3VpdGUoW015VGVzdENhc2UoJ3Rlc3QnKV0pXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIHJlZmVyZW5jZSkKCgogICAgIyBDaGVjayB0aGF0IGxvYWRUZXN0c0Zyb21Nb2R1bGUgaG9ub3JzIChvciBub3QpIGEgbW9kdWxlCiAgICAjIHdpdGggYSBsb2FkX3Rlc3RzIGZ1bmN0aW9uLgogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU1vZHVsZV9fbG9hZF90ZXN0cyhzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgTXlUZXN0Q2FzZSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIG0udGVzdGNhc2VfMSA9IE15VGVzdENhc2UKCiAgICAgICAgbG9hZF90ZXN0c19hcmdzID0gW10KICAgICAgICBkZWYgbG9hZF90ZXN0cyhsb2FkZXIsIHRlc3RzLCBwYXR0ZXJuKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHRlc3RzLCB1bml0dGVzdC5UZXN0U3VpdGUpCiAgICAgICAgICAgIGxvYWRfdGVzdHNfYXJncy5leHRlbmQoKGxvYWRlciwgdGVzdHMsIHBhdHRlcm4pKQogICAgICAgICAgICByZXR1cm4gdGVzdHMKICAgICAgICBtLmxvYWRfdGVzdHMgPSBsb2FkX3Rlc3RzCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21Nb2R1bGUobSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIHVuaXR0ZXN0LlRlc3RTdWl0ZSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxvYWRfdGVzdHNfYXJncywgW2xvYWRlciwgc3VpdGUsIE5vbmVdKQoKICAgICAgICBsb2FkX3Rlc3RzX2FyZ3MgPSBbXQogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21Nb2R1bGUobSwgdXNlX2xvYWRfdGVzdHM9RmFsc2UpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkX3Rlc3RzX2FyZ3MsIFtdKQoKICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21Nb2R1bGVfX2ZhdWx0eV9sb2FkX3Rlc3RzKHNlbGYpOgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKCiAgICAgICAgZGVmIGxvYWRfdGVzdHMobG9hZGVyLCB0ZXN0cywgcGF0dGVybik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcignc29tZSBmYWlsdXJlJykKICAgICAgICBtLmxvYWRfdGVzdHMgPSBsb2FkX3Rlc3RzCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21Nb2R1bGUobSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIHVuaXR0ZXN0LlRlc3RTdWl0ZSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN1aXRlLmNvdW50VGVzdENhc2VzKCksIDEpCiAgICAgICAgdGVzdCA9IGxpc3Qoc3VpdGUpWzBdCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzUmVnZXgoVHlwZUVycm9yLCAic29tZSBmYWlsdXJlIiwgdGVzdC5tKQoKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgICMjIyAvVGVzdHMgZm9yIFRlc3RMb2FkZXIubG9hZFRlc3RzRnJvbU1vZHVsZSgpCgogICAgIyMjIFRlc3RzIGZvciBUZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCkKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSBlaXRoZXIgdG8KICAgICMgYSBtb2R1bGUsIGEgdGVzdCBjYXNlIGNsYXNzLCBhIFRlc3RTdWl0ZSBpbnN0YW5jZSwgYSB0ZXN0IG1ldGhvZAogICAgIyB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MsIG9yIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYQogICAgIyBUZXN0Q2FzZSBvciBUZXN0U3VpdGUgaW5zdGFuY2UuIgogICAgIwogICAgIyBJcyBWYWx1ZUVycm9yIHJhaXNlZCBpbiByZXNwb25zZSB0byBhbiBlbXB0eSBuYW1lPwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX2VtcHR5X25hbWUoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCgogICAgICAgIHRyeToKICAgICAgICAgICAgbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCcnKQogICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yIGFzIGU6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGUpLCAiRW1wdHkgbW9kdWxlIG5hbWUiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSBmYWlsZWQgdG8gcmFpc2UgVmFsdWVFcnJvciIpCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgZWl0aGVyIHRvCiAgICAjIGEgbW9kdWxlLCBhIHRlc3QgY2FzZSBjbGFzcywgYSBUZXN0U3VpdGUgaW5zdGFuY2UsIGEgdGVzdCBtZXRob2QKICAgICMgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzLCBvciBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEKICAgICMgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlLiIKICAgICMKICAgICMgV2hhdCBoYXBwZW5zIHdoZW4gdGhlIG5hbWUgY29udGFpbnMgaW52YWxpZCBjaGFyYWN0ZXJzPwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX21hbGZvcm1lZF9uYW1lKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICAjIFhYWCBTaG91bGQgdGhpcyByYWlzZSBWYWx1ZUVycm9yIG9yIEltcG9ydEVycm9yPwogICAgICAgIHRyeToKICAgICAgICAgICAgbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCdhYmMgKCkgLy8nKQogICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICBwYXNzCiAgICAgICAgZXhjZXB0IEltcG9ydEVycm9yOgogICAgICAgICAgICBwYXNzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCJUZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lIGZhaWxlZCB0byByYWlzZSBWYWx1ZUVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSAuLi4gdG8gYQogICAgIyBtb2R1bGUiCiAgICAjCiAgICAjIFdoYXQgaGFwcGVucyB3aGVuIGEgbW9kdWxlIGJ5IHRoYXQgbmFtZSBjYW4ndCBiZSBmb3VuZD8KICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21OYW1lX191bmtub3duX21vZHVsZV9uYW1lKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSgnc2Rhc2Zhc2Zhc2RmJykKICAgICAgICBleGNlcHQgSW1wb3J0RXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIoZSksICJObyBtb2R1bGUgbmFtZWQgJ3NkYXNmYXNmYXNkZiciKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSBmYWlsZWQgdG8gcmFpc2UgSW1wb3J0RXJyb3IiKQoKICAgICMgIlRoZSBzcGVjaWZpZXIgbmFtZSBpcyBhIGBgZG90dGVkIG5hbWUnJyB0aGF0IG1heSByZXNvbHZlIGVpdGhlciB0bwogICAgIyBhIG1vZHVsZSwgYSB0ZXN0IGNhc2UgY2xhc3MsIGEgVGVzdFN1aXRlIGluc3RhbmNlLCBhIHRlc3QgbWV0aG9kCiAgICAjIHdpdGhpbiBhIHRlc3QgY2FzZSBjbGFzcywgb3IgYSBjYWxsYWJsZSBvYmplY3Qgd2hpY2ggcmV0dXJucyBhCiAgICAjIFRlc3RDYXNlIG9yIFRlc3RTdWl0ZSBpbnN0YW5jZS4iCiAgICAjCiAgICAjIFdoYXQgaGFwcGVucyB3aGVuIHRoZSBtb2R1bGUgaXMgZm91bmQsIGJ1dCB0aGUgYXR0cmlidXRlIGNhbid0PwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX3Vua25vd25fYXR0cl9uYW1lKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSgndW5pdHRlc3Quc2Rhc2Zhc2Zhc2RmJykKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIoZSksICInbW9kdWxlJyBvYmplY3QgaGFzIG5vIGF0dHJpYnV0ZSAnc2Rhc2Zhc2Zhc2RmJyIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCJUZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lIGZhaWxlZCB0byByYWlzZSBBdHRyaWJ1dGVFcnJvciIpCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgZWl0aGVyIHRvCiAgICAjIGEgbW9kdWxlLCBhIHRlc3QgY2FzZSBjbGFzcywgYSBUZXN0U3VpdGUgaW5zdGFuY2UsIGEgdGVzdCBtZXRob2QKICAgICMgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzLCBvciBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEKICAgICMgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlLiIKICAgICMKICAgICMgV2hhdCBoYXBwZW5zIHdoZW4gd2UgcHJvdmlkZSB0aGUgbW9kdWxlLCBidXQgdGhlIGF0dHJpYnV0ZSBjYW4ndCBiZQogICAgIyBmb3VuZD8KICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21OYW1lX19yZWxhdGl2ZV91bmtub3duX25hbWUoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCgogICAgICAgIHRyeToKICAgICAgICAgICAgbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCdzZGFzZmFzZmFzZGYnLCB1bml0dGVzdCkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIoZSksICInbW9kdWxlJyBvYmplY3QgaGFzIG5vIGF0dHJpYnV0ZSAnc2Rhc2Zhc2Zhc2RmJyIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCJUZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lIGZhaWxlZCB0byByYWlzZSBBdHRyaWJ1dGVFcnJvciIpCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgZWl0aGVyIHRvCiAgICAjIGEgbW9kdWxlLCBhIHRlc3QgY2FzZSBjbGFzcywgYSBUZXN0U3VpdGUgaW5zdGFuY2UsIGEgdGVzdCBtZXRob2QKICAgICMgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzLCBvciBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEKICAgICMgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlLiIKICAgICMgLi4uCiAgICAjICJUaGUgbWV0aG9kIG9wdGlvbmFsbHkgcmVzb2x2ZXMgbmFtZSByZWxhdGl2ZSB0byB0aGUgZ2l2ZW4gbW9kdWxlIgogICAgIwogICAgIyBEb2VzIGxvYWRUZXN0c0Zyb21OYW1lIHJhaXNlIFZhbHVlRXJyb3Igd2hlbiBwYXNzZWQgYW4gZW1wdHkKICAgICMgbmFtZSByZWxhdGl2ZSB0byBhIHByb3ZpZGVkIG1vZHVsZT8KICAgICMKICAgICMgWFhYIFNob3VsZCBwcm9iYWJseSByYWlzZSBhIFZhbHVlRXJyb3IgaW5zdGVhZCBvZiBhbiBBdHRyaWJ1dGVFcnJvcgogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX3JlbGF0aXZlX2VtcHR5X25hbWUoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCgogICAgICAgIHRyeToKICAgICAgICAgICAgbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCcnLCB1bml0dGVzdCkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3IgYXMgZToKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiRmFpbGVkIHRvIHJhaXNlIEF0dHJpYnV0ZUVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSBlaXRoZXIgdG8KICAgICMgYSBtb2R1bGUsIGEgdGVzdCBjYXNlIGNsYXNzLCBhIFRlc3RTdWl0ZSBpbnN0YW5jZSwgYSB0ZXN0IG1ldGhvZAogICAgIyB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MsIG9yIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYQogICAgIyBUZXN0Q2FzZSBvciBUZXN0U3VpdGUgaW5zdGFuY2UuIgogICAgIyAuLi4KICAgICMgIlRoZSBtZXRob2Qgb3B0aW9uYWxseSByZXNvbHZlcyBuYW1lIHJlbGF0aXZlIHRvIHRoZSBnaXZlbiBtb2R1bGUiCiAgICAjCiAgICAjIFdoYXQgaGFwcGVucyB3aGVuIGFuIGltcG9zc2libGUgbmFtZSBpcyBnaXZlbiwgcmVsYXRpdmUgdG8gdGhlIHByb3ZpZGVkCiAgICAjIGBtb2R1bGVgPwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX3JlbGF0aXZlX21hbGZvcm1lZF9uYW1lKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICAjIFhYWCBTaG91bGQgdGhpcyByYWlzZSBBdHRyaWJ1dGVFcnJvciBvciBWYWx1ZUVycm9yPwogICAgICAgIHRyeToKICAgICAgICAgICAgbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCdhYmMgKCkgLy8nLCB1bml0dGVzdCkKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSBmYWlsZWQgdG8gcmFpc2UgVmFsdWVFcnJvciIpCgogICAgIyAiVGhlIG1ldGhvZCBvcHRpb25hbGx5IHJlc29sdmVzIG5hbWUgcmVsYXRpdmUgdG8gdGhlIGdpdmVuIG1vZHVsZSIKICAgICMKICAgICMgRG9lcyBsb2FkVGVzdHNGcm9tTmFtZSByYWlzZSBUeXBlRXJyb3Igd2hlbiB0aGUgYG1vZHVsZWAgYXJndW1lbnQKICAgICMgaXNuJ3QgYSBtb2R1bGUgb2JqZWN0PwogICAgIwogICAgIyBYWFggQWNjZXB0cyB0aGUgbm90LWEtbW9kdWxlIG9iamVjdCwgaWdub3JuaW5nIHRoZSBvYmplY3QncyB0eXBlCiAgICAjIFRoaXMgc2hvdWxkIHJhaXNlIGFuIGV4Y2VwdGlvbiBvciB0aGUgbWV0aG9kIG5hbWUgc2hvdWxkIGJlIGNoYW5nZWQKICAgICMKICAgICMgWFhYIFNvbWUgcGVvcGxlIGFyZSByZWx5aW5nIG9uIHRoaXMsIHNvIGtlZXAgaXQgZm9yIG5vdwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX3JlbGF0aXZlX25vdF9hX21vZHVsZShzZWxmKToKICAgICAgICBjbGFzcyBNeVRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIGNsYXNzIE5vdEFNb2R1bGUob2JqZWN0KToKICAgICAgICAgICAgdGVzdF8yID0gTXlUZXN0Q2FzZQoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSgndGVzdF8yJywgTm90QU1vZHVsZSkKCiAgICAgICAgcmVmZXJlbmNlID0gW015VGVzdENhc2UoJ3Rlc3QnKV0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3Qoc3VpdGUpLCByZWZlcmVuY2UpCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgZWl0aGVyIHRvCiAgICAjIGEgbW9kdWxlLCBhIHRlc3QgY2FzZSBjbGFzcywgYSBUZXN0U3VpdGUgaW5zdGFuY2UsIGEgdGVzdCBtZXRob2QKICAgICMgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzLCBvciBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEKICAgICMgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlLiIKICAgICMKICAgICMgRG9lcyBpdCByYWlzZSBhbiBleGNlcHRpb24gaWYgdGhlIG5hbWUgcmVzb2x2ZXMgdG8gYW4gaW52YWxpZAogICAgIyBvYmplY3Q/CiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZV9fcmVsYXRpdmVfYmFkX29iamVjdChzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgbS50ZXN0Y2FzZV8xID0gb2JqZWN0KCkKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUoJ3Rlc3RjYXNlXzEnLCBtKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIlNob3VsZCBoYXZlIHJhaXNlZCBUeXBlRXJyb3IiKQoKICAgICMgIlRoZSBzcGVjaWZpZXIgbmFtZSBpcyBhIGBgZG90dGVkIG5hbWUnJyB0aGF0IG1heQogICAgIyByZXNvbHZlIGVpdGhlciB0byAuLi4gYSB0ZXN0IGNhc2UgY2xhc3MiCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZV9fcmVsYXRpdmVfVGVzdENhc2Vfc3ViY2xhc3Moc2VsZik6CiAgICAgICAgbSA9IHR5cGVzLk1vZHVsZVR5cGUoJ20nKQogICAgICAgIGNsYXNzIE15VGVzdENhc2UodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICBtLnRlc3RjYXNlXzEgPSBNeVRlc3RDYXNlCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCd0ZXN0Y2FzZV8xJywgbSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFtNeVRlc3RDYXNlKCd0ZXN0JyldKQoKICAgICMgIlRoZSBzcGVjaWZpZXIgbmFtZSBpcyBhIGBgZG90dGVkIG5hbWUnJyB0aGF0IG1heSByZXNvbHZlIGVpdGhlciB0bwogICAgIyBhIG1vZHVsZSwgYSB0ZXN0IGNhc2UgY2xhc3MsIGEgVGVzdFN1aXRlIGluc3RhbmNlLCBhIHRlc3QgbWV0aG9kCiAgICAjIHdpdGhpbiBhIHRlc3QgY2FzZSBjbGFzcywgb3IgYSBjYWxsYWJsZSBvYmplY3Qgd2hpY2ggcmV0dXJucyBhCiAgICAjIFRlc3RDYXNlIG9yIFRlc3RTdWl0ZSBpbnN0YW5jZS4iCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZV9fcmVsYXRpdmVfVGVzdFN1aXRlKHNlbGYpOgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBNeVRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgbS50ZXN0c3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoW015VGVzdENhc2UoJ3Rlc3QnKV0pCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCd0ZXN0c3VpdGUnLCBtKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShzdWl0ZSwgbG9hZGVyLnN1aXRlQ2xhc3MpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFtNeVRlc3RDYXNlKCd0ZXN0JyldKQoKICAgICMgIlRoZSBzcGVjaWZpZXIgbmFtZSBpcyBhIGBgZG90dGVkIG5hbWUnJyB0aGF0IG1heSByZXNvbHZlIC4uLiB0bwogICAgIyAuLi4gYSB0ZXN0IG1ldGhvZCB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MiCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZV9fcmVsYXRpdmVfdGVzdG1ldGhvZChzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgTXlUZXN0Q2FzZSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIG0udGVzdGNhc2VfMSA9IE15VGVzdENhc2UKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgc3VpdGUgPSBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUoJ3Rlc3RjYXNlXzEudGVzdCcsIG0pCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHN1aXRlLCBsb2FkZXIuc3VpdGVDbGFzcykKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KHN1aXRlKSwgW015VGVzdENhc2UoJ3Rlc3QnKV0pCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgZWl0aGVyIHRvCiAgICAjIGEgbW9kdWxlLCBhIHRlc3QgY2FzZSBjbGFzcywgYSBUZXN0U3VpdGUgaW5zdGFuY2UsIGEgdGVzdCBtZXRob2QKICAgICMgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzLCBvciBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEKICAgICMgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlLiIKICAgICMKICAgICMgRG9lcyBsb2FkVGVzdHNGcm9tTmFtZSgpIHJhaXNlIHRoZSBwcm9wZXIgZXhjZXB0aW9uIHdoZW4gdHJ5aW5nIHRvCiAgICAjIHJlc29sdmUgImEgdGVzdCBtZXRob2Qgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzIiB0aGF0IGRvZXNuJ3QgZXhpc3QKICAgICMgZm9yIHRoZSBnaXZlbiBuYW1lIChyZWxhdGl2ZSB0byBhIHByb3ZpZGVkIG1vZHVsZSk/CiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZV9fcmVsYXRpdmVfaW52YWxpZF90ZXN0bWV0aG9kKHNlbGYpOgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBNeVRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgbS50ZXN0Y2FzZV8xID0gTXlUZXN0Q2FzZQoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSgndGVzdGNhc2VfMS50ZXN0Zm9vJywgbSkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIoZSksICJ0eXBlIG9iamVjdCAnTXlUZXN0Q2FzZScgaGFzIG5vIGF0dHJpYnV0ZSAndGVzdGZvbyciKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiRmFpbGVkIHRvIHJhaXNlIEF0dHJpYnV0ZUVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSAuLi4gdG8KICAgICMgLi4uIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYSAuLi4gVGVzdFN1aXRlIGluc3RhbmNlIgogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX2NhbGxhYmxlX19UZXN0U3VpdGUoc2VsZik6CiAgICAgICAgbSA9IHR5cGVzLk1vZHVsZVR5cGUoJ20nKQogICAgICAgIHRlc3RjYXNlXzEgPSB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKICAgICAgICB0ZXN0Y2FzZV8yID0gdW5pdHRlc3QuRnVuY3Rpb25UZXN0Q2FzZShsYW1iZGE6IE5vbmUpCiAgICAgICAgZGVmIHJldHVybl9UZXN0U3VpdGUoKToKICAgICAgICAgICAgcmV0dXJuIHVuaXR0ZXN0LlRlc3RTdWl0ZShbdGVzdGNhc2VfMSwgdGVzdGNhc2VfMl0pCiAgICAgICAgbS5yZXR1cm5fVGVzdFN1aXRlID0gcmV0dXJuX1Rlc3RTdWl0ZQoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSgncmV0dXJuX1Rlc3RTdWl0ZScsIG0pCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHN1aXRlLCBsb2FkZXIuc3VpdGVDbGFzcykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3Qoc3VpdGUpLCBbdGVzdGNhc2VfMSwgdGVzdGNhc2VfMl0pCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgLi4uIHRvCiAgICAjIC4uLiBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEgVGVzdENhc2UgLi4uIGluc3RhbmNlIgogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX2NhbGxhYmxlX19UZXN0Q2FzZV9pbnN0YW5jZShzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgdGVzdGNhc2VfMSA9IHVuaXR0ZXN0LkZ1bmN0aW9uVGVzdENhc2UobGFtYmRhOiBOb25lKQogICAgICAgIGRlZiByZXR1cm5fVGVzdENhc2UoKToKICAgICAgICAgICAgcmV0dXJuIHRlc3RjYXNlXzEKICAgICAgICBtLnJldHVybl9UZXN0Q2FzZSA9IHJldHVybl9UZXN0Q2FzZQoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSgncmV0dXJuX1Rlc3RDYXNlJywgbSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFt0ZXN0Y2FzZV8xXSkKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSAuLi4gdG8KICAgICMgLi4uIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYSBUZXN0Q2FzZSAuLi4gaW5zdGFuY2UiCiAgICAjKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICAgICNPdmVycmlkZSB0aGUgc3VpdGVDbGFzcyBhdHRyaWJ1dGUgdG8gZW5zdXJlIHRoYXQgdGhlIHN1aXRlQ2xhc3MKICAgICNhdHRyaWJ1dGUgaXMgdXNlZAogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVfX2NhbGxhYmxlX19UZXN0Q2FzZV9pbnN0YW5jZV9Qcm9wZXJTdWl0ZUNsYXNzKHNlbGYpOgogICAgICAgIGNsYXNzIFN1YlRlc3RTdWl0ZSh1bml0dGVzdC5UZXN0U3VpdGUpOgogICAgICAgICAgICBwYXNzCiAgICAgICAgbSA9IHR5cGVzLk1vZHVsZVR5cGUoJ20nKQogICAgICAgIHRlc3RjYXNlXzEgPSB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKICAgICAgICBkZWYgcmV0dXJuX1Rlc3RDYXNlKCk6CiAgICAgICAgICAgIHJldHVybiB0ZXN0Y2FzZV8xCiAgICAgICAgbS5yZXR1cm5fVGVzdENhc2UgPSByZXR1cm5fVGVzdENhc2UKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnN1aXRlQ2xhc3MgPSBTdWJUZXN0U3VpdGUKICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSgncmV0dXJuX1Rlc3RDYXNlJywgbSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFt0ZXN0Y2FzZV8xXSkKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSAuLi4gdG8KICAgICMgLi4uIGEgdGVzdCBtZXRob2Qgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzIgogICAgIyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAgICAjT3ZlcnJpZGUgdGhlIHN1aXRlQ2xhc3MgYXR0cmlidXRlIHRvIGVuc3VyZSB0aGF0IHRoZSBzdWl0ZUNsYXNzCiAgICAjYXR0cmlidXRlIGlzIHVzZWQKICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21OYW1lX19yZWxhdGl2ZV90ZXN0bWV0aG9kX1Byb3BlclN1aXRlQ2xhc3Moc2VsZik6CiAgICAgICAgY2xhc3MgU3ViVGVzdFN1aXRlKHVuaXR0ZXN0LlRlc3RTdWl0ZSk6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgTXlUZXN0Q2FzZSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIG0udGVzdGNhc2VfMSA9IE15VGVzdENhc2UKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnN1aXRlQ2xhc3M9U3ViVGVzdFN1aXRlCiAgICAgICAgc3VpdGUgPSBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUoJ3Rlc3RjYXNlXzEudGVzdCcsIG0pCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHN1aXRlLCBsb2FkZXIuc3VpdGVDbGFzcykKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KHN1aXRlKSwgW015VGVzdENhc2UoJ3Rlc3QnKV0pCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgLi4uIHRvCiAgICAjIC4uLiBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlIgogICAgIwogICAgIyBXaGF0IGhhcHBlbnMgaWYgdGhlIGNhbGxhYmxlIHJldHVybnMgc29tZXRoaW5nIGVsc2U/CiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZV9fY2FsbGFibGVfX3dyb25nX3R5cGUoc2VsZik6CiAgICAgICAgbSA9IHR5cGVzLk1vZHVsZVR5cGUoJ20nKQogICAgICAgIGRlZiByZXR1cm5fd3JvbmcoKToKICAgICAgICAgICAgcmV0dXJuIDYKICAgICAgICBtLnJldHVybl93cm9uZyA9IHJldHVybl93cm9uZwoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCdyZXR1cm5fd3JvbmcnLCBtKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIlRlc3RMb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUgZmFpbGVkIHRvIHJhaXNlIFR5cGVFcnJvciIpCgogICAgIyAiVGhlIHNwZWNpZmllciBjYW4gcmVmZXIgdG8gbW9kdWxlcyBhbmQgcGFja2FnZXMgd2hpY2ggaGF2ZSBub3QgYmVlbgogICAgIyBpbXBvcnRlZDsgdGhleSB3aWxsIGJlIGltcG9ydGVkIGFzIGEgc2lkZS1lZmZlY3QiCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZV9fbW9kdWxlX25vdF9sb2FkZWQoc2VsZik6CiAgICAgICAgIyBXZSdyZSBnb2luZyB0byB0cnkgdG8gbG9hZCB0aGlzIG1vZHVsZSBhcyBhIHNpZGUtZWZmZWN0LCBzbyBpdAogICAgICAgICMgYmV0dGVyIG5vdCBiZSBsb2FkZWQgYmVmb3JlIHdlIHRyeS4KICAgICAgICAjCiAgICAgICAgbW9kdWxlX25hbWUgPSAndW5pdHRlc3QudGVzdC5kdW1teScKICAgICAgICBzeXMubW9kdWxlcy5wb3AobW9kdWxlX25hbWUsIE5vbmUpCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHRyeToKICAgICAgICAgICAgc3VpdGUgPSBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUobW9kdWxlX25hbWUpCgogICAgICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3Qoc3VpdGUpLCBbXSkKCiAgICAgICAgICAgICMgbW9kdWxlIHNob3VsZCBub3cgYmUgbG9hZGVkLCB0aGFua3MgdG8gbG9hZFRlc3RzRnJvbU5hbWUoKQogICAgICAgICAgICBzZWxmLmFzc2VydEluKG1vZHVsZV9uYW1lLCBzeXMubW9kdWxlcykKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBpZiBtb2R1bGVfbmFtZSBpbiBzeXMubW9kdWxlczoKICAgICAgICAgICAgICAgIGRlbCBzeXMubW9kdWxlc1ttb2R1bGVfbmFtZV0KCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiAgICAjIyMgVGVzdHMgZm9yIFRlc3RMb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUoKQoKICAgICMjIyBUZXN0cyBmb3IgVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoKQogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgICMgIlNpbWlsYXIgdG8gbG9hZFRlc3RzRnJvbU5hbWUoKSwgYnV0IHRha2VzIGEgc2VxdWVuY2Ugb2YgbmFtZXMgcmF0aGVyCiAgICAjIHRoYW4gYSBzaW5nbGUgbmFtZS4iCiAgICAjCiAgICAjIFdoYXQgaGFwcGVucyBpZiB0aGF0IHNlcXVlbmNlIG9mIG5hbWVzIGlzIGVtcHR5PwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX19lbXB0eV9uYW1lX2xpc3Qoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCgogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbXSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFtdKQoKICAgICMgIlNpbWlsYXIgdG8gbG9hZFRlc3RzRnJvbU5hbWUoKSwgYnV0IHRha2VzIGEgc2VxdWVuY2Ugb2YgbmFtZXMgcmF0aGVyCiAgICAjIHRoYW4gYSBzaW5nbGUgbmFtZS4iCiAgICAjIC4uLgogICAgIyAiVGhlIG1ldGhvZCBvcHRpb25hbGx5IHJlc29sdmVzIG5hbWUgcmVsYXRpdmUgdG8gdGhlIGdpdmVuIG1vZHVsZSIKICAgICMKICAgICMgV2hhdCBoYXBwZW5zIGlmIHRoYXQgc2VxdWVuY2Ugb2YgbmFtZXMgaXMgZW1wdHk/CiAgICAjCiAgICAjIFhYWCBTaG91bGQgdGhpcyByYWlzZSBhIFZhbHVlRXJyb3Igb3IganVzdCByZXR1cm4gYW4gZW1wdHkgVGVzdFN1aXRlPwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX19yZWxhdGl2ZV9lbXB0eV9uYW1lX2xpc3Qoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCgogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbXSwgdW5pdHRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHN1aXRlLCBsb2FkZXIuc3VpdGVDbGFzcykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3Qoc3VpdGUpLCBbXSkKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSBlaXRoZXIgdG8KICAgICMgYSBtb2R1bGUsIGEgdGVzdCBjYXNlIGNsYXNzLCBhIFRlc3RTdWl0ZSBpbnN0YW5jZSwgYSB0ZXN0IG1ldGhvZAogICAgIyB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MsIG9yIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYQogICAgIyBUZXN0Q2FzZSBvciBUZXN0U3VpdGUgaW5zdGFuY2UuIgogICAgIwogICAgIyBJcyBWYWx1ZUVycm9yIHJhaXNlZCBpbiByZXNwb25zZSB0byBhbiBlbXB0eSBuYW1lPwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX19lbXB0eV9uYW1lKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoWycnXSkKICAgICAgICBleGNlcHQgVmFsdWVFcnJvciBhcyBlOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN0cihlKSwgIkVtcHR5IG1vZHVsZSBuYW1lIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIlRlc3RMb2FkZXIubG9hZFRlc3RzRnJvbU5hbWVzIGZhaWxlZCB0byByYWlzZSBWYWx1ZUVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSBlaXRoZXIgdG8KICAgICMgYSBtb2R1bGUsIGEgdGVzdCBjYXNlIGNsYXNzLCBhIFRlc3RTdWl0ZSBpbnN0YW5jZSwgYSB0ZXN0IG1ldGhvZAogICAgIyB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MsIG9yIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYQogICAgIyBUZXN0Q2FzZSBvciBUZXN0U3VpdGUgaW5zdGFuY2UuIgogICAgIwogICAgIyBXaGF0IGhhcHBlbnMgd2hlbiBwcmVzZW50ZWQgd2l0aCBhbiBpbXBvc3NpYmxlIG1vZHVsZSBuYW1lPwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX19tYWxmb3JtZWRfbmFtZShzZWxmKToKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgIyBYWFggU2hvdWxkIHRoaXMgcmFpc2UgVmFsdWVFcnJvciBvciBJbXBvcnRFcnJvcj8KICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoWydhYmMgKCkgLy8nXSkKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMgZmFpbGVkIHRvIHJhaXNlIFZhbHVlRXJyb3IiKQoKICAgICMgIlRoZSBzcGVjaWZpZXIgbmFtZSBpcyBhIGBgZG90dGVkIG5hbWUnJyB0aGF0IG1heSByZXNvbHZlIGVpdGhlciB0bwogICAgIyBhIG1vZHVsZSwgYSB0ZXN0IGNhc2UgY2xhc3MsIGEgVGVzdFN1aXRlIGluc3RhbmNlLCBhIHRlc3QgbWV0aG9kCiAgICAjIHdpdGhpbiBhIHRlc3QgY2FzZSBjbGFzcywgb3IgYSBjYWxsYWJsZSBvYmplY3Qgd2hpY2ggcmV0dXJucyBhCiAgICAjIFRlc3RDYXNlIG9yIFRlc3RTdWl0ZSBpbnN0YW5jZS4iCiAgICAjCiAgICAjIFdoYXQgaGFwcGVucyB3aGVuIG5vIG1vZHVsZSBjYW4gYmUgZm91bmQgZm9yIHRoZSBnaXZlbiBuYW1lPwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX191bmtub3duX21vZHVsZV9uYW1lKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoWydzZGFzZmFzZmFzZGYnXSkKICAgICAgICBleGNlcHQgSW1wb3J0RXJyb3IgYXMgZToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIoZSksICJObyBtb2R1bGUgbmFtZWQgJ3NkYXNmYXNmYXNkZiciKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMgZmFpbGVkIHRvIHJhaXNlIEltcG9ydEVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSBlaXRoZXIgdG8KICAgICMgYSBtb2R1bGUsIGEgdGVzdCBjYXNlIGNsYXNzLCBhIFRlc3RTdWl0ZSBpbnN0YW5jZSwgYSB0ZXN0IG1ldGhvZAogICAgIyB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MsIG9yIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYQogICAgIyBUZXN0Q2FzZSBvciBUZXN0U3VpdGUgaW5zdGFuY2UuIgogICAgIwogICAgIyBXaGF0IGhhcHBlbnMgd2hlbiB0aGUgbW9kdWxlIGNhbiBiZSBmb3VuZCwgYnV0IG5vdCB0aGUgYXR0cmlidXRlPwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX191bmtub3duX2F0dHJfbmFtZShzZWxmKToKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWVzKFsndW5pdHRlc3Quc2Rhc2Zhc2Zhc2RmJywgJ3VuaXR0ZXN0J10pCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yIGFzIGU6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGUpLCAiJ21vZHVsZScgb2JqZWN0IGhhcyBubyBhdHRyaWJ1dGUgJ3NkYXNmYXNmYXNkZiciKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMgZmFpbGVkIHRvIHJhaXNlIEF0dHJpYnV0ZUVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSBlaXRoZXIgdG8KICAgICMgYSBtb2R1bGUsIGEgdGVzdCBjYXNlIGNsYXNzLCBhIFRlc3RTdWl0ZSBpbnN0YW5jZSwgYSB0ZXN0IG1ldGhvZAogICAgIyB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MsIG9yIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYQogICAgIyBUZXN0Q2FzZSBvciBUZXN0U3VpdGUgaW5zdGFuY2UuIgogICAgIyAuLi4KICAgICMgIlRoZSBtZXRob2Qgb3B0aW9uYWxseSByZXNvbHZlcyBuYW1lIHJlbGF0aXZlIHRvIHRoZSBnaXZlbiBtb2R1bGUiCiAgICAjCiAgICAjIFdoYXQgaGFwcGVucyB3aGVuIGdpdmVuIGFuIHVua25vd24gYXR0cmlidXRlIG9uIGEgc3BlY2lmaWVkIGBtb2R1bGVgCiAgICAjIGFyZ3VtZW50PwogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX191bmtub3duX25hbWVfcmVsYXRpdmVfMShzZWxmKToKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWVzKFsnc2Rhc2Zhc2Zhc2RmJ10sIHVuaXR0ZXN0KQogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvciBhcyBlOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN0cihlKSwgIidtb2R1bGUnIG9iamVjdCBoYXMgbm8gYXR0cmlidXRlICdzZGFzZmFzZmFzZGYnIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIlRlc3RMb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUgZmFpbGVkIHRvIHJhaXNlIEF0dHJpYnV0ZUVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSBlaXRoZXIgdG8KICAgICMgYSBtb2R1bGUsIGEgdGVzdCBjYXNlIGNsYXNzLCBhIFRlc3RTdWl0ZSBpbnN0YW5jZSwgYSB0ZXN0IG1ldGhvZAogICAgIyB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MsIG9yIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYQogICAgIyBUZXN0Q2FzZSBvciBUZXN0U3VpdGUgaW5zdGFuY2UuIgogICAgIyAuLi4KICAgICMgIlRoZSBtZXRob2Qgb3B0aW9uYWxseSByZXNvbHZlcyBuYW1lIHJlbGF0aXZlIHRvIHRoZSBnaXZlbiBtb2R1bGUiCiAgICAjCiAgICAjIERvIHVua25vd24gYXR0cmlidXRlcyAocmVsYXRpdmUgdG8gYSBwcm92aWRlZCBtb2R1bGUpIHN0aWxsIHJhaXNlIGFuCiAgICAjIGV4Y2VwdGlvbiBldmVuIGluIHRoZSBwcmVzZW5jZSBvZiB2YWxpZCBhdHRyaWJ1dGUgbmFtZXM/CiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZXNfX3Vua25vd25fbmFtZV9yZWxhdGl2ZV8yKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoWydUZXN0Q2FzZScsICdzZGFzZmFzZmFzZGYnXSwgdW5pdHRlc3QpCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yIGFzIGU6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGUpLCAiJ21vZHVsZScgb2JqZWN0IGhhcyBubyBhdHRyaWJ1dGUgJ3NkYXNmYXNmYXNkZiciKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSBmYWlsZWQgdG8gcmFpc2UgQXR0cmlidXRlRXJyb3IiKQoKICAgICMgIlRoZSBzcGVjaWZpZXIgbmFtZSBpcyBhIGBgZG90dGVkIG5hbWUnJyB0aGF0IG1heSByZXNvbHZlIGVpdGhlciB0bwogICAgIyBhIG1vZHVsZSwgYSB0ZXN0IGNhc2UgY2xhc3MsIGEgVGVzdFN1aXRlIGluc3RhbmNlLCBhIHRlc3QgbWV0aG9kCiAgICAjIHdpdGhpbiBhIHRlc3QgY2FzZSBjbGFzcywgb3IgYSBjYWxsYWJsZSBvYmplY3Qgd2hpY2ggcmV0dXJucyBhCiAgICAjIFRlc3RDYXNlIG9yIFRlc3RTdWl0ZSBpbnN0YW5jZS4iCiAgICAjIC4uLgogICAgIyAiVGhlIG1ldGhvZCBvcHRpb25hbGx5IHJlc29sdmVzIG5hbWUgcmVsYXRpdmUgdG8gdGhlIGdpdmVuIG1vZHVsZSIKICAgICMKICAgICMgV2hhdCBoYXBwZW5zIHdoZW4gZmFjZWQgd2l0aCB0aGUgZW1wdHkgc3RyaW5nPwogICAgIwogICAgIyBYWFggVGhpcyBjdXJyZW50bHkgcmFpc2VzIEF0dHJpYnV0ZUVycm9yLCB0aG91Z2ggVmFsdWVFcnJvciBpcyBwcm9iYWJseQogICAgIyBtb3JlIGFwcHJvcHJpYXRlCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZXNfX3JlbGF0aXZlX2VtcHR5X25hbWUoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCgogICAgICAgIHRyeToKICAgICAgICAgICAgbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbJyddLCB1bml0dGVzdCkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIkZhaWxlZCB0byByYWlzZSBWYWx1ZUVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSBlaXRoZXIgdG8KICAgICMgYSBtb2R1bGUsIGEgdGVzdCBjYXNlIGNsYXNzLCBhIFRlc3RTdWl0ZSBpbnN0YW5jZSwgYSB0ZXN0IG1ldGhvZAogICAgIyB3aXRoaW4gYSB0ZXN0IGNhc2UgY2xhc3MsIG9yIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYQogICAgIyBUZXN0Q2FzZSBvciBUZXN0U3VpdGUgaW5zdGFuY2UuIgogICAgIyAuLi4KICAgICMgIlRoZSBtZXRob2Qgb3B0aW9uYWxseSByZXNvbHZlcyBuYW1lIHJlbGF0aXZlIHRvIHRoZSBnaXZlbiBtb2R1bGUiCiAgICAjCiAgICAjIFdoYXQgaGFwcGVucyB3aGVuIHByZXNlbnRlZCB3aXRoIGFuIGltcG9zc2libGUgYXR0cmlidXRlIG5hbWU/CiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZXNfX3JlbGF0aXZlX21hbGZvcm1lZF9uYW1lKHNlbGYpOgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICAjIFhYWCBTaG91bGQgdGhpcyByYWlzZSBBdHRyaWJ1dGVFcnJvciBvciBWYWx1ZUVycm9yPwogICAgICAgIHRyeToKICAgICAgICAgICAgbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbJ2FiYyAoKSAvLyddLCB1bml0dGVzdCkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMgZmFpbGVkIHRvIHJhaXNlIFZhbHVlRXJyb3IiKQoKICAgICMgIlRoZSBtZXRob2Qgb3B0aW9uYWxseSByZXNvbHZlcyBuYW1lIHJlbGF0aXZlIHRvIHRoZSBnaXZlbiBtb2R1bGUiCiAgICAjCiAgICAjIERvZXMgbG9hZFRlc3RzRnJvbU5hbWVzKCkgbWFrZSBzdXJlIHRoZSBwcm92aWRlZCBgbW9kdWxlYCBpcyBpbiBmYWN0CiAgICAjIGEgbW9kdWxlPwogICAgIwogICAgIyBYWFggVGhpcyB2YWxpZGF0aW9uIGlzIGN1cnJlbnRseSBub3QgZG9uZS4gVGhpcyBmbGV4aWJpbGl0eSBzaG91bGQKICAgICMgZWl0aGVyIGJlIGRvY3VtZW50ZWQgb3IgYSBUeXBlRXJyb3Igc2hvdWxkIGJlIHJhaXNlZC4KICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21OYW1lc19fcmVsYXRpdmVfbm90X2FfbW9kdWxlKHNlbGYpOgogICAgICAgIGNsYXNzIE15VGVzdENhc2UodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgY2xhc3MgTm90QU1vZHVsZShvYmplY3QpOgogICAgICAgICAgICB0ZXN0XzIgPSBNeVRlc3RDYXNlCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbJ3Rlc3RfMiddLCBOb3RBTW9kdWxlKQoKICAgICAgICByZWZlcmVuY2UgPSBbdW5pdHRlc3QuVGVzdFN1aXRlKFtNeVRlc3RDYXNlKCd0ZXN0JyldKV0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3Qoc3VpdGUpLCByZWZlcmVuY2UpCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgZWl0aGVyIHRvCiAgICAjIGEgbW9kdWxlLCBhIHRlc3QgY2FzZSBjbGFzcywgYSBUZXN0U3VpdGUgaW5zdGFuY2UsIGEgdGVzdCBtZXRob2QKICAgICMgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzLCBvciBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEKICAgICMgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlLiIKICAgICMKICAgICMgRG9lcyBpdCByYWlzZSBhbiBleGNlcHRpb24gaWYgdGhlIG5hbWUgcmVzb2x2ZXMgdG8gYW4gaW52YWxpZAogICAgIyBvYmplY3Q/CiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZXNfX3JlbGF0aXZlX2JhZF9vYmplY3Qoc2VsZik6CiAgICAgICAgbSA9IHR5cGVzLk1vZHVsZVR5cGUoJ20nKQogICAgICAgIG0udGVzdGNhc2VfMSA9IG9iamVjdCgpCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHRyeToKICAgICAgICAgICAgbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbJ3Rlc3RjYXNlXzEnXSwgbSkKICAgICAgICBleGNlcHQgVHlwZUVycm9yOgogICAgICAgICAgICBwYXNzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCJTaG91bGQgaGF2ZSByYWlzZWQgVHlwZUVycm9yIikKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSAuLi4gdG8KICAgICMgLi4uIGEgdGVzdCBjYXNlIGNsYXNzIgogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX19yZWxhdGl2ZV9UZXN0Q2FzZV9zdWJjbGFzcyhzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgTXlUZXN0Q2FzZSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIG0udGVzdGNhc2VfMSA9IE15VGVzdENhc2UKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgc3VpdGUgPSBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWVzKFsndGVzdGNhc2VfMSddLCBtKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShzdWl0ZSwgbG9hZGVyLnN1aXRlQ2xhc3MpCgogICAgICAgIGV4cGVjdGVkID0gbG9hZGVyLnN1aXRlQ2xhc3MoW015VGVzdENhc2UoJ3Rlc3QnKV0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KHN1aXRlKSwgW2V4cGVjdGVkXSkKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSAuLi4gdG8KICAgICMgLi4uIGEgVGVzdFN1aXRlIGluc3RhbmNlIgogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX19yZWxhdGl2ZV9UZXN0U3VpdGUoc2VsZik6CiAgICAgICAgbSA9IHR5cGVzLk1vZHVsZVR5cGUoJ20nKQogICAgICAgIGNsYXNzIE15VGVzdENhc2UodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICBtLnRlc3RzdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShbTXlUZXN0Q2FzZSgndGVzdCcpXSkKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgc3VpdGUgPSBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWVzKFsndGVzdHN1aXRlJ10sIG0pCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHN1aXRlLCBsb2FkZXIuc3VpdGVDbGFzcykKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KHN1aXRlKSwgW20udGVzdHN1aXRlXSkKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSAuLi4gdG8gLi4uIGEKICAgICMgdGVzdCBtZXRob2Qgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzIgogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX19yZWxhdGl2ZV90ZXN0bWV0aG9kKHNlbGYpOgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBNeVRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgbS50ZXN0Y2FzZV8xID0gTXlUZXN0Q2FzZQoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoWyd0ZXN0Y2FzZV8xLnRlc3QnXSwgbSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQoKICAgICAgICByZWZfc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoW015VGVzdENhc2UoJ3Rlc3QnKV0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KHN1aXRlKSwgW3JlZl9zdWl0ZV0pCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgLi4uIHRvIC4uLiBhCiAgICAjIHRlc3QgbWV0aG9kIHdpdGhpbiBhIHRlc3QgY2FzZSBjbGFzcyIKICAgICMKICAgICMgRG9lcyB0aGUgbWV0aG9kIGdyYWNlZnVsbHkgaGFuZGxlIG5hbWVzIHRoYXQgaW5pdGlhbGx5IGxvb2sgbGlrZSB0aGV5CiAgICAjIHJlc29sdmUgdG8gImEgdGVzdCBtZXRob2Qgd2l0aGluIGEgdGVzdCBjYXNlIGNsYXNzIiBidXQgZG9uJ3Q/CiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZXNfX3JlbGF0aXZlX2ludmFsaWRfdGVzdG1ldGhvZChzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgTXlUZXN0Q2FzZSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0KHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIG0udGVzdGNhc2VfMSA9IE15VGVzdENhc2UKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWVzKFsndGVzdGNhc2VfMS50ZXN0Zm9vJ10sIG0pCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yIGFzIGU6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGUpLCAidHlwZSBvYmplY3QgJ015VGVzdENhc2UnIGhhcyBubyBhdHRyaWJ1dGUgJ3Rlc3Rmb28nIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIkZhaWxlZCB0byByYWlzZSBBdHRyaWJ1dGVFcnJvciIpCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgLi4uIHRvCiAgICAjIC4uLiBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEgLi4uIFRlc3RTdWl0ZSBpbnN0YW5jZSIKICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21OYW1lc19fY2FsbGFibGVfX1Rlc3RTdWl0ZShzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgdGVzdGNhc2VfMSA9IHVuaXR0ZXN0LkZ1bmN0aW9uVGVzdENhc2UobGFtYmRhOiBOb25lKQogICAgICAgIHRlc3RjYXNlXzIgPSB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKICAgICAgICBkZWYgcmV0dXJuX1Rlc3RTdWl0ZSgpOgogICAgICAgICAgICByZXR1cm4gdW5pdHRlc3QuVGVzdFN1aXRlKFt0ZXN0Y2FzZV8xLCB0ZXN0Y2FzZV8yXSkKICAgICAgICBtLnJldHVybl9UZXN0U3VpdGUgPSByZXR1cm5fVGVzdFN1aXRlCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbJ3JldHVybl9UZXN0U3VpdGUnXSwgbSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQoKICAgICAgICBleHBlY3RlZCA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShbdGVzdGNhc2VfMSwgdGVzdGNhc2VfMl0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KHN1aXRlKSwgW2V4cGVjdGVkXSkKCiAgICAjICJUaGUgc3BlY2lmaWVyIG5hbWUgaXMgYSBgYGRvdHRlZCBuYW1lJycgdGhhdCBtYXkgcmVzb2x2ZSAuLi4gdG8KICAgICMgLi4uIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHJldHVybnMgYSBUZXN0Q2FzZSAuLi4gaW5zdGFuY2UiCiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZXNfX2NhbGxhYmxlX19UZXN0Q2FzZV9pbnN0YW5jZShzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgdGVzdGNhc2VfMSA9IHVuaXR0ZXN0LkZ1bmN0aW9uVGVzdENhc2UobGFtYmRhOiBOb25lKQogICAgICAgIGRlZiByZXR1cm5fVGVzdENhc2UoKToKICAgICAgICAgICAgcmV0dXJuIHRlc3RjYXNlXzEKICAgICAgICBtLnJldHVybl9UZXN0Q2FzZSA9IHJldHVybl9UZXN0Q2FzZQoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoWydyZXR1cm5fVGVzdENhc2UnXSwgbSkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3VpdGUsIGxvYWRlci5zdWl0ZUNsYXNzKQoKICAgICAgICByZWZfc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoW3Rlc3RjYXNlXzFdKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFtyZWZfc3VpdGVdKQoKICAgICMgIlRoZSBzcGVjaWZpZXIgbmFtZSBpcyBhIGBgZG90dGVkIG5hbWUnJyB0aGF0IG1heSByZXNvbHZlIC4uLiB0bwogICAgIyAuLi4gYSBjYWxsYWJsZSBvYmplY3Qgd2hpY2ggcmV0dXJucyBhIFRlc3RDYXNlIG9yIFRlc3RTdWl0ZSBpbnN0YW5jZSIKICAgICMKICAgICMgQXJlIHN0YXRpY21ldGhvZHMgaGFuZGxlZCBjb3JyZWN0bHk/CiAgICBkZWYgdGVzdF9sb2FkVGVzdHNGcm9tTmFtZXNfX2NhbGxhYmxlX19jYWxsX3N0YXRpY21ldGhvZChzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgVGVzdDEodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgdGVzdGNhc2VfMSA9IFRlc3QxKCd0ZXN0JykKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgICAgIGRlZiBmb28oKToKICAgICAgICAgICAgICAgIHJldHVybiB0ZXN0Y2FzZV8xCiAgICAgICAgbS5Gb28gPSBGb28KCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgc3VpdGUgPSBsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWVzKFsnRm9vLmZvbyddLCBtKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShzdWl0ZSwgbG9hZGVyLnN1aXRlQ2xhc3MpCgogICAgICAgIHJlZl9zdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShbdGVzdGNhc2VfMV0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KHN1aXRlKSwgW3JlZl9zdWl0ZV0pCgogICAgIyAiVGhlIHNwZWNpZmllciBuYW1lIGlzIGEgYGBkb3R0ZWQgbmFtZScnIHRoYXQgbWF5IHJlc29sdmUgLi4uIHRvCiAgICAjIC4uLiBhIGNhbGxhYmxlIG9iamVjdCB3aGljaCByZXR1cm5zIGEgVGVzdENhc2Ugb3IgVGVzdFN1aXRlIGluc3RhbmNlIgogICAgIwogICAgIyBXaGF0IGhhcHBlbnMgd2hlbiB0aGUgY2FsbGFibGUgcmV0dXJucyBzb21ldGhpbmcgZWxzZT8KICAgIGRlZiB0ZXN0X2xvYWRUZXN0c0Zyb21OYW1lc19fY2FsbGFibGVfX3dyb25nX3R5cGUoc2VsZik6CiAgICAgICAgbSA9IHR5cGVzLk1vZHVsZVR5cGUoJ20nKQogICAgICAgIGRlZiByZXR1cm5fd3JvbmcoKToKICAgICAgICAgICAgcmV0dXJuIDYKICAgICAgICBtLnJldHVybl93cm9uZyA9IHJldHVybl93cm9uZwoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHN1aXRlID0gbG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbJ3JldHVybl93cm9uZyddLCBtKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoIlRlc3RMb2FkZXIubG9hZFRlc3RzRnJvbU5hbWVzIGZhaWxlZCB0byByYWlzZSBUeXBlRXJyb3IiKQoKICAgICMgIlRoZSBzcGVjaWZpZXIgY2FuIHJlZmVyIHRvIG1vZHVsZXMgYW5kIHBhY2thZ2VzIHdoaWNoIGhhdmUgbm90IGJlZW4KICAgICMgaW1wb3J0ZWQ7IHRoZXkgd2lsbCBiZSBpbXBvcnRlZCBhcyBhIHNpZGUtZWZmZWN0IgogICAgZGVmIHRlc3RfbG9hZFRlc3RzRnJvbU5hbWVzX19tb2R1bGVfbm90X2xvYWRlZChzZWxmKToKICAgICAgICAjIFdlJ3JlIGdvaW5nIHRvIHRyeSB0byBsb2FkIHRoaXMgbW9kdWxlIGFzIGEgc2lkZS1lZmZlY3QsIHNvIGl0CiAgICAgICAgIyBiZXR0ZXIgbm90IGJlIGxvYWRlZCBiZWZvcmUgd2UgdHJ5LgogICAgICAgICMKICAgICAgICBtb2R1bGVfbmFtZSA9ICd1bml0dGVzdC50ZXN0LmR1bW15JwogICAgICAgIHN5cy5tb2R1bGVzLnBvcChtb2R1bGVfbmFtZSwgTm9uZSkKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzdWl0ZSA9IGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoW21vZHVsZV9uYW1lXSkKCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShzdWl0ZSwgbG9hZGVyLnN1aXRlQ2xhc3MpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFt1bml0dGVzdC5UZXN0U3VpdGUoKV0pCgogICAgICAgICAgICAjIG1vZHVsZSBzaG91bGQgbm93IGJlIGxvYWRlZCwgdGhhbmtzIHRvIGxvYWRUZXN0c0Zyb21OYW1lKCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbihtb2R1bGVfbmFtZSwgc3lzLm1vZHVsZXMpCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgaWYgbW9kdWxlX25hbWUgaW4gc3lzLm1vZHVsZXM6CiAgICAgICAgICAgICAgICBkZWwgc3lzLm1vZHVsZXNbbW9kdWxlX25hbWVdCgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgIyMjIC9UZXN0cyBmb3IgVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoKQoKICAgICMjIyBUZXN0cyBmb3IgVGVzdExvYWRlci5nZXRUZXN0Q2FzZU5hbWVzKCkKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAjICJSZXR1cm4gYSBzb3J0ZWQgc2VxdWVuY2Ugb2YgbWV0aG9kIG5hbWVzIGZvdW5kIHdpdGhpbiB0ZXN0Q2FzZUNsYXNzIgogICAgIwogICAgIyBUZXN0LmZvb2JhciBpcyBkZWZpbmVkIHRvIG1ha2Ugc3VyZSBnZXRUZXN0Q2FzZU5hbWVzKCkgcmVzcGVjdHMKICAgICMgbG9hZGVyLnRlc3RNZXRob2RQcmVmaXgKICAgIGRlZiB0ZXN0X2dldFRlc3RDYXNlTmFtZXMoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0XzEoc2VsZik6IHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfMihzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgZm9vYmFyKHNlbGYpOiBwYXNzCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxvYWRlci5nZXRUZXN0Q2FzZU5hbWVzKFRlc3QpLCBbJ3Rlc3RfMScsICd0ZXN0XzInXSkKCiAgICAjICJSZXR1cm4gYSBzb3J0ZWQgc2VxdWVuY2Ugb2YgbWV0aG9kIG5hbWVzIGZvdW5kIHdpdGhpbiB0ZXN0Q2FzZUNsYXNzIgogICAgIwogICAgIyBEb2VzIGdldFRlc3RDYXNlTmFtZXMoKSBiZWhhdmUgYXBwcm9wcmlhdGVseSBpZiBubyB0ZXN0cyBhcmUgZm91bmQ/CiAgICBkZWYgdGVzdF9nZXRUZXN0Q2FzZU5hbWVzX19ub190ZXN0cyhzZWxmKToKICAgICAgICBjbGFzcyBUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIGZvb2JhcihzZWxmKTogcGFzcwoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIuZ2V0VGVzdENhc2VOYW1lcyhUZXN0KSwgW10pCgogICAgIyAiUmV0dXJuIGEgc29ydGVkIHNlcXVlbmNlIG9mIG1ldGhvZCBuYW1lcyBmb3VuZCB3aXRoaW4gdGVzdENhc2VDbGFzcyIKICAgICMKICAgICMgQXJlIG5vdC1UZXN0Q2FzZXMgaGFuZGxlZCBncmFjZWZ1bGx5PwogICAgIwogICAgIyBYWFggVGhpcyBzaG91bGQgcmFpc2UgYSBUeXBlRXJyb3IsIG5vdCByZXR1cm4gYSBsaXN0CiAgICAjCiAgICAjIFhYWCBJdCdzIHRvbyBsYXRlIGluIHRoZSAyLjUgcmVsZWFzZSBjeWNsZSB0byBmaXggdGhpcywgYnV0IGl0IHNob3VsZAogICAgIyBwcm9iYWJseSBiZSByZXZpc2l0ZWQgZm9yIDIuNgogICAgZGVmIHRlc3RfZ2V0VGVzdENhc2VOYW1lc19fbm90X2FfVGVzdENhc2Uoc2VsZik6CiAgICAgICAgY2xhc3MgQmFkQ2FzZShpbnQpOgogICAgICAgICAgICBkZWYgdGVzdF9mb28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIG5hbWVzID0gbG9hZGVyLmdldFRlc3RDYXNlTmFtZXMoQmFkQ2FzZSkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChuYW1lcywgWyd0ZXN0X2ZvbyddKQoKICAgICMgIlJldHVybiBhIHNvcnRlZCBzZXF1ZW5jZSBvZiBtZXRob2QgbmFtZXMgZm91bmQgd2l0aGluIHRlc3RDYXNlQ2xhc3MiCiAgICAjCiAgICAjIE1ha2Ugc3VyZSBpbmhlcml0ZWQgbmFtZXMgYXJlIGhhbmRsZWQuCiAgICAjCiAgICAjIFRlc3RQLmZvb2JhciBpcyBkZWZpbmVkIHRvIG1ha2Ugc3VyZSBnZXRUZXN0Q2FzZU5hbWVzKCkgcmVzcGVjdHMKICAgICMgbG9hZGVyLnRlc3RNZXRob2RQcmVmaXgKICAgIGRlZiB0ZXN0X2dldFRlc3RDYXNlTmFtZXNfX2luaGVyaXRhbmNlKHNlbGYpOgogICAgICAgIGNsYXNzIFRlc3RQKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8yKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiBmb29iYXIoc2VsZik6IHBhc3MKCiAgICAgICAgY2xhc3MgVGVzdEMoVGVzdFApOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0XzMoc2VsZik6IHBhc3MKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCgogICAgICAgIG5hbWVzID0gWyd0ZXN0XzEnLCAndGVzdF8yJywgJ3Rlc3RfMyddCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIuZ2V0VGVzdENhc2VOYW1lcyhUZXN0QyksIG5hbWVzKQoKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgICMjIyAvVGVzdHMgZm9yIFRlc3RMb2FkZXIuZ2V0VGVzdENhc2VOYW1lcygpCgogICAgIyMjIFRlc3RzIGZvciBUZXN0TG9hZGVyLnRlc3RNZXRob2RQcmVmaXgKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAjICJTdHJpbmcgZ2l2aW5nIHRoZSBwcmVmaXggb2YgbWV0aG9kIG5hbWVzIHdoaWNoIHdpbGwgYmUgaW50ZXJwcmV0ZWQgYXMKICAgICMgdGVzdCBtZXRob2RzIgogICAgIwogICAgIyBJbXBsaWNpdCBpbiB0aGUgZG9jdW1lbnRhdGlvbiBpcyB0aGF0IHRlc3RNZXRob2RQcmVmaXggaXMgcmVzcGVjdGVkIGJ5CiAgICAjIGFsbCBsb2FkVGVzdHNGcm9tKiBtZXRob2RzLgogICAgZGVmIHRlc3RfdGVzdE1ldGhvZFByZWZpeF9fbG9hZFRlc3RzRnJvbVRlc3RDYXNlKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0XzEoc2VsZik6IHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfMihzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgZm9vX2JhcihzZWxmKTogcGFzcwoKICAgICAgICB0ZXN0c18xID0gdW5pdHRlc3QuVGVzdFN1aXRlKFtGb28oJ2Zvb19iYXInKV0pCiAgICAgICAgdGVzdHNfMiA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShbRm9vKCd0ZXN0XzEnKSwgRm9vKCd0ZXN0XzInKV0pCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIGxvYWRlci50ZXN0TWV0aG9kUHJlZml4ID0gJ2ZvbycKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxvYWRlci5sb2FkVGVzdHNGcm9tVGVzdENhc2UoRm9vKSwgdGVzdHNfMSkKCiAgICAgICAgbG9hZGVyLnRlc3RNZXRob2RQcmVmaXggPSAndGVzdCcKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxvYWRlci5sb2FkVGVzdHNGcm9tVGVzdENhc2UoRm9vKSwgdGVzdHNfMikKCiAgICAjICJTdHJpbmcgZ2l2aW5nIHRoZSBwcmVmaXggb2YgbWV0aG9kIG5hbWVzIHdoaWNoIHdpbGwgYmUgaW50ZXJwcmV0ZWQgYXMKICAgICMgdGVzdCBtZXRob2RzIgogICAgIwogICAgIyBJbXBsaWNpdCBpbiB0aGUgZG9jdW1lbnRhdGlvbiBpcyB0aGF0IHRlc3RNZXRob2RQcmVmaXggaXMgcmVzcGVjdGVkIGJ5CiAgICAjIGFsbCBsb2FkVGVzdHNGcm9tKiBtZXRob2RzLgogICAgZGVmIHRlc3RfdGVzdE1ldGhvZFByZWZpeF9fbG9hZFRlc3RzRnJvbU1vZHVsZShzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8yKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiBmb29fYmFyKHNlbGYpOiBwYXNzCiAgICAgICAgbS5Gb28gPSBGb28KCiAgICAgICAgdGVzdHNfMSA9IFt1bml0dGVzdC5UZXN0U3VpdGUoW0ZvbygnZm9vX2JhcicpXSldCiAgICAgICAgdGVzdHNfMiA9IFt1bml0dGVzdC5UZXN0U3VpdGUoW0ZvbygndGVzdF8xJyksIEZvbygndGVzdF8yJyldKV0KCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnRlc3RNZXRob2RQcmVmaXggPSAnZm9vJwogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChsb2FkZXIubG9hZFRlc3RzRnJvbU1vZHVsZShtKSksIHRlc3RzXzEpCgogICAgICAgIGxvYWRlci50ZXN0TWV0aG9kUHJlZml4ID0gJ3Rlc3QnCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KGxvYWRlci5sb2FkVGVzdHNGcm9tTW9kdWxlKG0pKSwgdGVzdHNfMikKCiAgICAjICJTdHJpbmcgZ2l2aW5nIHRoZSBwcmVmaXggb2YgbWV0aG9kIG5hbWVzIHdoaWNoIHdpbGwgYmUgaW50ZXJwcmV0ZWQgYXMKICAgICMgdGVzdCBtZXRob2RzIgogICAgIwogICAgIyBJbXBsaWNpdCBpbiB0aGUgZG9jdW1lbnRhdGlvbiBpcyB0aGF0IHRlc3RNZXRob2RQcmVmaXggaXMgcmVzcGVjdGVkIGJ5CiAgICAjIGFsbCBsb2FkVGVzdHNGcm9tKiBtZXRob2RzLgogICAgZGVmIHRlc3RfdGVzdE1ldGhvZFByZWZpeF9fbG9hZFRlc3RzRnJvbU5hbWUoc2VsZik6CiAgICAgICAgbSA9IHR5cGVzLk1vZHVsZVR5cGUoJ20nKQogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0XzEoc2VsZik6IHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfMihzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgZm9vX2JhcihzZWxmKTogcGFzcwogICAgICAgIG0uRm9vID0gRm9vCgogICAgICAgIHRlc3RzXzEgPSB1bml0dGVzdC5UZXN0U3VpdGUoW0ZvbygnZm9vX2JhcicpXSkKICAgICAgICB0ZXN0c18yID0gdW5pdHRlc3QuVGVzdFN1aXRlKFtGb28oJ3Rlc3RfMScpLCBGb28oJ3Rlc3RfMicpXSkKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnRlc3RNZXRob2RQcmVmaXggPSAnZm9vJwogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCdGb28nLCBtKSwgdGVzdHNfMSkKCiAgICAgICAgbG9hZGVyLnRlc3RNZXRob2RQcmVmaXggPSAndGVzdCcKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZSgnRm9vJywgbSksIHRlc3RzXzIpCgogICAgIyAiU3RyaW5nIGdpdmluZyB0aGUgcHJlZml4IG9mIG1ldGhvZCBuYW1lcyB3aGljaCB3aWxsIGJlIGludGVycHJldGVkIGFzCiAgICAjIHRlc3QgbWV0aG9kcyIKICAgICMKICAgICMgSW1wbGljaXQgaW4gdGhlIGRvY3VtZW50YXRpb24gaXMgdGhhdCB0ZXN0TWV0aG9kUHJlZml4IGlzIHJlc3BlY3RlZCBieQogICAgIyBhbGwgbG9hZFRlc3RzRnJvbSogbWV0aG9kcy4KICAgIGRlZiB0ZXN0X3Rlc3RNZXRob2RQcmVmaXhfX2xvYWRUZXN0c0Zyb21OYW1lcyhzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8yKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiBmb29fYmFyKHNlbGYpOiBwYXNzCiAgICAgICAgbS5Gb28gPSBGb28KCiAgICAgICAgdGVzdHNfMSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShbdW5pdHRlc3QuVGVzdFN1aXRlKFtGb28oJ2Zvb19iYXInKV0pXSkKICAgICAgICB0ZXN0c18yID0gdW5pdHRlc3QuVGVzdFN1aXRlKFtGb28oJ3Rlc3RfMScpLCBGb28oJ3Rlc3RfMicpXSkKICAgICAgICB0ZXN0c18yID0gdW5pdHRlc3QuVGVzdFN1aXRlKFt0ZXN0c18yXSkKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnRlc3RNZXRob2RQcmVmaXggPSAnZm9vJwogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbJ0ZvbyddLCBtKSwgdGVzdHNfMSkKCiAgICAgICAgbG9hZGVyLnRlc3RNZXRob2RQcmVmaXggPSAndGVzdCcKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoWydGb28nXSwgbSksIHRlc3RzXzIpCgogICAgIyAiVGhlIGRlZmF1bHQgdmFsdWUgaXMgJ3Rlc3QnIgogICAgZGVmIHRlc3RfdGVzdE1ldGhvZFByZWZpeF9fZGVmYXVsdF92YWx1ZShzZWxmKToKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxvYWRlci50ZXN0TWV0aG9kUHJlZml4LCAndGVzdCcpCgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgIyMjIC9UZXN0cyBmb3IgVGVzdExvYWRlci50ZXN0TWV0aG9kUHJlZml4CgogICAgIyMjIFRlc3RzIGZvciBUZXN0TG9hZGVyLnNvcnRUZXN0TWV0aG9kc1VzaW5nCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgogICAgIyAiRnVuY3Rpb24gdG8gYmUgdXNlZCB0byBjb21wYXJlIG1ldGhvZCBuYW1lcyB3aGVuIHNvcnRpbmcgdGhlbSBpbgogICAgIyBnZXRUZXN0Q2FzZU5hbWVzKCkgYW5kIGFsbCB0aGUgbG9hZFRlc3RzRnJvbVgoKSBtZXRob2RzIgogICAgZGVmIHRlc3Rfc29ydFRlc3RNZXRob2RzVXNpbmdfX2xvYWRUZXN0c0Zyb21UZXN0Q2FzZShzZWxmKToKICAgICAgICBkZWYgcmV2ZXJzZWRfY21wKHgsIHkpOgogICAgICAgICAgICByZXR1cm4gLSgoeCA+IHkpIC0gKHggPCB5KSkKCiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8yKHNlbGYpOiBwYXNzCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIGxvYWRlci5zb3J0VGVzdE1ldGhvZHNVc2luZyA9IHJldmVyc2VkX2NtcAoKICAgICAgICB0ZXN0cyA9IGxvYWRlci5zdWl0ZUNsYXNzKFtGb28oJ3Rlc3RfMicpLCBGb28oJ3Rlc3RfMScpXSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxvYWRlci5sb2FkVGVzdHNGcm9tVGVzdENhc2UoRm9vKSwgdGVzdHMpCgogICAgIyAiRnVuY3Rpb24gdG8gYmUgdXNlZCB0byBjb21wYXJlIG1ldGhvZCBuYW1lcyB3aGVuIHNvcnRpbmcgdGhlbSBpbgogICAgIyBnZXRUZXN0Q2FzZU5hbWVzKCkgYW5kIGFsbCB0aGUgbG9hZFRlc3RzRnJvbVgoKSBtZXRob2RzIgogICAgZGVmIHRlc3Rfc29ydFRlc3RNZXRob2RzVXNpbmdfX2xvYWRUZXN0c0Zyb21Nb2R1bGUoc2VsZik6CiAgICAgICAgZGVmIHJldmVyc2VkX2NtcCh4LCB5KToKICAgICAgICAgICAgcmV0dXJuIC0oKHggPiB5KSAtICh4IDwgeSkpCgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0XzIoc2VsZik6IHBhc3MKICAgICAgICBtLkZvbyA9IEZvbwoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBsb2FkZXIuc29ydFRlc3RNZXRob2RzVXNpbmcgPSByZXZlcnNlZF9jbXAKCiAgICAgICAgdGVzdHMgPSBbbG9hZGVyLnN1aXRlQ2xhc3MoW0ZvbygndGVzdF8yJyksIEZvbygndGVzdF8xJyldKV0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3QobG9hZGVyLmxvYWRUZXN0c0Zyb21Nb2R1bGUobSkpLCB0ZXN0cykKCiAgICAjICJGdW5jdGlvbiB0byBiZSB1c2VkIHRvIGNvbXBhcmUgbWV0aG9kIG5hbWVzIHdoZW4gc29ydGluZyB0aGVtIGluCiAgICAjIGdldFRlc3RDYXNlTmFtZXMoKSBhbmQgYWxsIHRoZSBsb2FkVGVzdHNGcm9tWCgpIG1ldGhvZHMiCiAgICBkZWYgdGVzdF9zb3J0VGVzdE1ldGhvZHNVc2luZ19fbG9hZFRlc3RzRnJvbU5hbWUoc2VsZik6CiAgICAgICAgZGVmIHJldmVyc2VkX2NtcCh4LCB5KToKICAgICAgICAgICAgcmV0dXJuIC0oKHggPiB5KSAtICh4IDwgeSkpCgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0XzIoc2VsZik6IHBhc3MKICAgICAgICBtLkZvbyA9IEZvbwoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBsb2FkZXIuc29ydFRlc3RNZXRob2RzVXNpbmcgPSByZXZlcnNlZF9jbXAKCiAgICAgICAgdGVzdHMgPSBsb2FkZXIuc3VpdGVDbGFzcyhbRm9vKCd0ZXN0XzInKSwgRm9vKCd0ZXN0XzEnKV0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUoJ0ZvbycsIG0pLCB0ZXN0cykKCiAgICAjICJGdW5jdGlvbiB0byBiZSB1c2VkIHRvIGNvbXBhcmUgbWV0aG9kIG5hbWVzIHdoZW4gc29ydGluZyB0aGVtIGluCiAgICAjIGdldFRlc3RDYXNlTmFtZXMoKSBhbmQgYWxsIHRoZSBsb2FkVGVzdHNGcm9tWCgpIG1ldGhvZHMiCiAgICBkZWYgdGVzdF9zb3J0VGVzdE1ldGhvZHNVc2luZ19fbG9hZFRlc3RzRnJvbU5hbWVzKHNlbGYpOgogICAgICAgIGRlZiByZXZlcnNlZF9jbXAoeCwgeSk6CiAgICAgICAgICAgIHJldHVybiAtKCh4ID4geSkgLSAoeCA8IHkpKQoKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8yKHNlbGYpOiBwYXNzCiAgICAgICAgbS5Gb28gPSBGb28KCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnNvcnRUZXN0TWV0aG9kc1VzaW5nID0gcmV2ZXJzZWRfY21wCgogICAgICAgIHRlc3RzID0gW2xvYWRlci5zdWl0ZUNsYXNzKFtGb28oJ3Rlc3RfMicpLCBGb28oJ3Rlc3RfMScpXSldCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KGxvYWRlci5sb2FkVGVzdHNGcm9tTmFtZXMoWydGb28nXSwgbSkpLCB0ZXN0cykKCiAgICAjICJGdW5jdGlvbiB0byBiZSB1c2VkIHRvIGNvbXBhcmUgbWV0aG9kIG5hbWVzIHdoZW4gc29ydGluZyB0aGVtIGluCiAgICAjIGdldFRlc3RDYXNlTmFtZXMoKSIKICAgICMKICAgICMgRG9lcyBpdCBhY3R1YWxseSBhZmZlY3QgZ2V0VGVzdENhc2VOYW1lcygpPwogICAgZGVmIHRlc3Rfc29ydFRlc3RNZXRob2RzVXNpbmdfX2dldFRlc3RDYXNlTmFtZXMoc2VsZik6CiAgICAgICAgZGVmIHJldmVyc2VkX2NtcCh4LCB5KToKICAgICAgICAgICAgcmV0dXJuIC0oKHggPiB5KSAtICh4IDwgeSkpCgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0XzEoc2VsZik6IHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfMihzZWxmKTogcGFzcwoKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKICAgICAgICBsb2FkZXIuc29ydFRlc3RNZXRob2RzVXNpbmcgPSByZXZlcnNlZF9jbXAKCiAgICAgICAgdGVzdF9uYW1lcyA9IFsndGVzdF8yJywgJ3Rlc3RfMSddCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIuZ2V0VGVzdENhc2VOYW1lcyhGb28pLCB0ZXN0X25hbWVzKQoKICAgICMgIlRoZSBkZWZhdWx0IHZhbHVlIGlzIHRoZSBidWlsdC1pbiBjbXAoKSBmdW5jdGlvbiIKICAgICMgU2luY2UgY21wIGlzIG5vdyBkZWZ1bmN0LCB3ZSBzaW1wbHkgdmVyaWZ5IHRoYXQgdGhlIHJlc3VsdHMKICAgICMgb2NjdXIgaW4gdGhlIHNhbWUgb3JkZXIgYXMgdGhleSB3b3VsZCB3aXRoIHRoZSBkZWZhdWx0IHNvcnQuCiAgICBkZWYgdGVzdF9zb3J0VGVzdE1ldGhvZHNVc2luZ19fZGVmYXVsdF92YWx1ZShzZWxmKToKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMihzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8zKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0XzEoc2VsZik6IHBhc3MKCiAgICAgICAgdGVzdF9uYW1lcyA9IFsndGVzdF8yJywgJ3Rlc3RfMycsICd0ZXN0XzEnXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobG9hZGVyLmdldFRlc3RDYXNlTmFtZXMoRm9vKSwgc29ydGVkKHRlc3RfbmFtZXMpKQoKCiAgICAjICJpdCBjYW4gYmUgc2V0IHRvIE5vbmUgdG8gZGlzYWJsZSB0aGUgc29ydC4iCiAgICAjCiAgICAjIFhYWCBIb3cgaXMgdGhpcyBkaWZmZXJlbnQgZnJvbSByZWFzc2lnbmluZyBjbXA/IEFyZSB0aGUgdGVzdHMgcmV0dXJuZWQKICAgICMgaW4gYSByYW5kb20gb3JkZXIgb3Igc29tZXRoaW5nPyBUaGlzIGJlaGF2aW91ciBzaG91bGQgZGllCiAgICBkZWYgdGVzdF9zb3J0VGVzdE1ldGhvZHNVc2luZ19fTm9uZShzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0XzIoc2VsZik6IHBhc3MKCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnNvcnRUZXN0TWV0aG9kc1VzaW5nID0gTm9uZQoKICAgICAgICB0ZXN0X25hbWVzID0gWyd0ZXN0XzInLCAndGVzdF8xJ10KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNldChsb2FkZXIuZ2V0VGVzdENhc2VOYW1lcyhGb28pKSwgc2V0KHRlc3RfbmFtZXMpKQoKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgICMjIyAvVGVzdHMgZm9yIFRlc3RMb2FkZXIuc29ydFRlc3RNZXRob2RzVXNpbmcKCiAgICAjIyMgVGVzdHMgZm9yIFRlc3RMb2FkZXIuc3VpdGVDbGFzcwogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgICMgIkNhbGxhYmxlIG9iamVjdCB0aGF0IGNvbnN0cnVjdHMgYSB0ZXN0IHN1aXRlIGZyb20gYSBsaXN0IG9mIHRlc3RzLiIKICAgIGRlZiB0ZXN0X3N1aXRlQ2xhc3NfX2xvYWRUZXN0c0Zyb21UZXN0Q2FzZShzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0XzIoc2VsZik6IHBhc3MKICAgICAgICAgICAgZGVmIGZvb19iYXIoc2VsZik6IHBhc3MKCiAgICAgICAgdGVzdHMgPSBbRm9vKCd0ZXN0XzEnKSwgRm9vKCd0ZXN0XzInKV0KCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnN1aXRlQ2xhc3MgPSBsaXN0CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIubG9hZFRlc3RzRnJvbVRlc3RDYXNlKEZvbyksIHRlc3RzKQoKICAgICMgSXQgaXMgaW1wbGljaXQgaW4gdGhlIGRvY3VtZW50YXRpb24gZm9yIFRlc3RMb2FkZXIuc3VpdGVDbGFzcyB0aGF0CiAgICAjIGFsbCBUZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb20qIG1ldGhvZHMgcmVzcGVjdCBpdC4gTGV0J3MgbWFrZSBzdXJlCiAgICBkZWYgdGVzdF9zdWl0ZUNsYXNzX19sb2FkVGVzdHNGcm9tTW9kdWxlKHNlbGYpOgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0XzIoc2VsZik6IHBhc3MKICAgICAgICAgICAgZGVmIGZvb19iYXIoc2VsZik6IHBhc3MKICAgICAgICBtLkZvbyA9IEZvbwoKICAgICAgICB0ZXN0cyA9IFtbRm9vKCd0ZXN0XzEnKSwgRm9vKCd0ZXN0XzInKV1dCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIGxvYWRlci5zdWl0ZUNsYXNzID0gbGlzdAogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobG9hZGVyLmxvYWRUZXN0c0Zyb21Nb2R1bGUobSksIHRlc3RzKQoKICAgICMgSXQgaXMgaW1wbGljaXQgaW4gdGhlIGRvY3VtZW50YXRpb24gZm9yIFRlc3RMb2FkZXIuc3VpdGVDbGFzcyB0aGF0CiAgICAjIGFsbCBUZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb20qIG1ldGhvZHMgcmVzcGVjdCBpdC4gTGV0J3MgbWFrZSBzdXJlCiAgICBkZWYgdGVzdF9zdWl0ZUNsYXNzX19sb2FkVGVzdHNGcm9tTmFtZShzZWxmKToKICAgICAgICBtID0gdHlwZXMuTW9kdWxlVHlwZSgnbScpCiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8yKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiBmb29fYmFyKHNlbGYpOiBwYXNzCiAgICAgICAgbS5Gb28gPSBGb28KCiAgICAgICAgdGVzdHMgPSBbRm9vKCd0ZXN0XzEnKSwgRm9vKCd0ZXN0XzInKV0KCiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgbG9hZGVyLnN1aXRlQ2xhc3MgPSBsaXN0CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsb2FkZXIubG9hZFRlc3RzRnJvbU5hbWUoJ0ZvbycsIG0pLCB0ZXN0cykKCiAgICAjIEl0IGlzIGltcGxpY2l0IGluIHRoZSBkb2N1bWVudGF0aW9uIGZvciBUZXN0TG9hZGVyLnN1aXRlQ2xhc3MgdGhhdAogICAgIyBhbGwgVGVzdExvYWRlci5sb2FkVGVzdHNGcm9tKiBtZXRob2RzIHJlc3BlY3QgaXQuIExldCdzIG1ha2Ugc3VyZQogICAgZGVmIHRlc3Rfc3VpdGVDbGFzc19fbG9hZFRlc3RzRnJvbU5hbWVzKHNlbGYpOgogICAgICAgIG0gPSB0eXBlcy5Nb2R1bGVUeXBlKCdtJykKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0XzIoc2VsZik6IHBhc3MKICAgICAgICAgICAgZGVmIGZvb19iYXIoc2VsZik6IHBhc3MKICAgICAgICBtLkZvbyA9IEZvbwoKICAgICAgICB0ZXN0cyA9IFtbRm9vKCd0ZXN0XzEnKSwgRm9vKCd0ZXN0XzInKV1dCgogICAgICAgIGxvYWRlciA9IHVuaXR0ZXN0LlRlc3RMb2FkZXIoKQogICAgICAgIGxvYWRlci5zdWl0ZUNsYXNzID0gbGlzdAogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lcyhbJ0ZvbyddLCBtKSwgdGVzdHMpCgogICAgIyAiVGhlIGRlZmF1bHQgdmFsdWUgaXMgdGhlIFRlc3RTdWl0ZSBjbGFzcyIKICAgIGRlZiB0ZXN0X3N1aXRlQ2xhc3NfX2RlZmF1bHRfdmFsdWUoc2VsZik6CiAgICAgICAgbG9hZGVyID0gdW5pdHRlc3QuVGVzdExvYWRlcigpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGxvYWRlci5zdWl0ZUNsYXNzIGlzIHVuaXR0ZXN0LlRlc3RTdWl0ZSkK',
'/Lib/unittest/test/test_program.py':'aW1wb3J0IGlvCgppbXBvcnQgb3MKaW1wb3J0IHN5cwppbXBvcnQgdW5pdHRlc3QKCgpjbGFzcyBUZXN0X1Rlc3RQcm9ncmFtKHVuaXR0ZXN0LlRlc3RDYXNlKToKCiAgICBkZWYgdGVzdF9kaXNjb3ZlcnlfZnJvbV9kb3R0ZWRfcGF0aChzZWxmKToKICAgICAgICBsb2FkZXIgPSB1bml0dGVzdC5UZXN0TG9hZGVyKCkKCiAgICAgICAgdGVzdHMgPSBbc2VsZl0KICAgICAgICBleHBlY3RlZFBhdGggPSBvcy5wYXRoLmFic3BhdGgob3MucGF0aC5kaXJuYW1lKHVuaXR0ZXN0LnRlc3QuX19maWxlX18pKQoKICAgICAgICBzZWxmLndhc1J1biA9IEZhbHNlCiAgICAgICAgZGVmIF9maW5kX3Rlc3RzKHN0YXJ0X2RpciwgcGF0dGVybik6CiAgICAgICAgICAgIHNlbGYud2FzUnVuID0gVHJ1ZQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN0YXJ0X2RpciwgZXhwZWN0ZWRQYXRoKQogICAgICAgICAgICByZXR1cm4gdGVzdHMKICAgICAgICBsb2FkZXIuX2ZpbmRfdGVzdHMgPSBfZmluZF90ZXN0cwogICAgICAgIHN1aXRlID0gbG9hZGVyLmRpc2NvdmVyKCd1bml0dGVzdC50ZXN0JykKICAgICAgICBzZWxmLmFzc2VydFRydWUoc2VsZi53YXNSdW4pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdWl0ZS5fdGVzdHMsIHRlc3RzKQoKICAgICMgSG9ycmlibGUgd2hpdGUgYm94IHRlc3QKICAgIGRlZiB0ZXN0Tm9FeGl0KHNlbGYpOgogICAgICAgIHJlc3VsdCA9IG9iamVjdCgpCiAgICAgICAgdGVzdCA9IG9iamVjdCgpCgogICAgICAgIGNsYXNzIEZha2VSdW5uZXIob2JqZWN0KToKICAgICAgICAgICAgZGVmIHJ1bihzZWxmLCB0ZXN0KToKICAgICAgICAgICAgICAgIHNlbGYudGVzdCA9IHRlc3QKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQKCiAgICAgICAgcnVubmVyID0gRmFrZVJ1bm5lcigpCgogICAgICAgIG9sZFBhcnNlQXJncyA9IHVuaXR0ZXN0LlRlc3RQcm9ncmFtLnBhcnNlQXJncwogICAgICAgIGRlZiByZXN0b3JlUGFyc2VBcmdzKCk6CiAgICAgICAgICAgIHVuaXR0ZXN0LlRlc3RQcm9ncmFtLnBhcnNlQXJncyA9IG9sZFBhcnNlQXJncwogICAgICAgIHVuaXR0ZXN0LlRlc3RQcm9ncmFtLnBhcnNlQXJncyA9IGxhbWJkYSAqYXJnczogTm9uZQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChyZXN0b3JlUGFyc2VBcmdzKQoKICAgICAgICBkZWYgcmVtb3ZlVGVzdCgpOgogICAgICAgICAgICBkZWwgdW5pdHRlc3QuVGVzdFByb2dyYW0udGVzdAogICAgICAgIHVuaXR0ZXN0LlRlc3RQcm9ncmFtLnRlc3QgPSB0ZXN0CiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHJlbW92ZVRlc3QpCgogICAgICAgIHByb2dyYW0gPSB1bml0dGVzdC5UZXN0UHJvZ3JhbSh0ZXN0UnVubmVyPXJ1bm5lciwgZXhpdD1GYWxzZSwgdmVyYm9zaXR5PTIpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS5yZXN1bHQsIHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJ1bm5lci50ZXN0LCB0ZXN0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS52ZXJib3NpdHksIDIpCgogICAgY2xhc3MgRm9vQmFyKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICBkZWYgdGVzdFBhc3Moc2VsZik6CiAgICAgICAgICAgIGFzc2VydCBUcnVlCiAgICAgICAgZGVmIHRlc3RGYWlsKHNlbGYpOgogICAgICAgICAgICBhc3NlcnQgRmFsc2UKCiAgICBjbGFzcyBGb29CYXJMb2FkZXIodW5pdHRlc3QuVGVzdExvYWRlcik6CiAgICAgICAgIiIiVGVzdCBsb2FkZXIgdGhhdCByZXR1cm5zIGEgc3VpdGUgY29udGFpbmluZyBGb29CYXIuIiIiCiAgICAgICAgZGVmIGxvYWRUZXN0c0Zyb21Nb2R1bGUoc2VsZiwgbW9kdWxlKToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuc3VpdGVDbGFzcygKICAgICAgICAgICAgICAgIFtzZWxmLmxvYWRUZXN0c0Zyb21UZXN0Q2FzZShUZXN0X1Rlc3RQcm9ncmFtLkZvb0JhcildKQoKCiAgICBkZWYgdGVzdF9Ob25FeGl0KHNlbGYpOgogICAgICAgIHByb2dyYW0gPSB1bml0dGVzdC5tYWluKGV4aXQ9RmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJndj1bImZvb2JhciJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlc3RSdW5uZXI9dW5pdHRlc3QuVGV4dFRlc3RSdW5uZXIoc3RyZWFtPWlvLlN0cmluZ0lPKCkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlc3RMb2FkZXI9c2VsZi5Gb29CYXJMb2FkZXIoKSkKICAgICAgICBzZWxmLmFzc2VydFRydWUoaGFzYXR0cihwcm9ncmFtLCAncmVzdWx0JykpCgoKICAgIGRlZiB0ZXN0X0V4aXQoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgIFN5c3RlbUV4aXQsCiAgICAgICAgICAgIHVuaXR0ZXN0Lm1haW4sCiAgICAgICAgICAgIGFyZ3Y9WyJmb29iYXIiXSwKICAgICAgICAgICAgdGVzdFJ1bm5lcj11bml0dGVzdC5UZXh0VGVzdFJ1bm5lcihzdHJlYW09aW8uU3RyaW5nSU8oKSksCiAgICAgICAgICAgIGV4aXQ9VHJ1ZSwKICAgICAgICAgICAgdGVzdExvYWRlcj1zZWxmLkZvb0JhckxvYWRlcigpKQoKCiAgICBkZWYgdGVzdF9FeGl0QXNEZWZhdWx0KHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKAogICAgICAgICAgICBTeXN0ZW1FeGl0LAogICAgICAgICAgICB1bml0dGVzdC5tYWluLAogICAgICAgICAgICBhcmd2PVsiZm9vYmFyIl0sCiAgICAgICAgICAgIHRlc3RSdW5uZXI9dW5pdHRlc3QuVGV4dFRlc3RSdW5uZXIoc3RyZWFtPWlvLlN0cmluZ0lPKCkpLAogICAgICAgICAgICB0ZXN0TG9hZGVyPXNlbGYuRm9vQmFyTG9hZGVyKCkpCgoKY2xhc3MgSW5pdGlhbGlzYWJsZVByb2dyYW0odW5pdHRlc3QuVGVzdFByb2dyYW0pOgogICAgZXhpdCA9IEZhbHNlCiAgICByZXN1bHQgPSBOb25lCiAgICB2ZXJib3NpdHkgPSAxCiAgICBkZWZhdWx0VGVzdCA9IE5vbmUKICAgIHRlc3RSdW5uZXIgPSBOb25lCiAgICB0ZXN0TG9hZGVyID0gdW5pdHRlc3QuZGVmYXVsdFRlc3RMb2FkZXIKICAgIG1vZHVsZSA9ICdfX21haW5fXycKICAgIHByb2dOYW1lID0gJ3Rlc3QnCiAgICB0ZXN0ID0gJ3Rlc3QnCiAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MpOgogICAgICAgIHBhc3MKClJFU1VMVCA9IG9iamVjdCgpCgpjbGFzcyBGYWtlUnVubmVyKG9iamVjdCk6CiAgICBpbml0QXJncyA9IE5vbmUKICAgIHRlc3QgPSBOb25lCiAgICByYWlzZUVycm9yID0gRmFsc2UKCiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIEZha2VSdW5uZXIuaW5pdEFyZ3MgPSBrd2FyZ3MKICAgICAgICBpZiBGYWtlUnVubmVyLnJhaXNlRXJyb3I6CiAgICAgICAgICAgIEZha2VSdW5uZXIucmFpc2VFcnJvciA9IEZhbHNlCiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcgoKICAgIGRlZiBydW4oc2VsZiwgdGVzdCk6CiAgICAgICAgRmFrZVJ1bm5lci50ZXN0ID0gdGVzdAogICAgICAgIHJldHVybiBSRVNVTFQKCmNsYXNzIFRlc3RDb21tYW5kTGluZUFyZ3ModW5pdHRlc3QuVGVzdENhc2UpOgoKICAgIGRlZiBzZXRVcChzZWxmKToKICAgICAgICBzZWxmLnByb2dyYW0gPSBJbml0aWFsaXNhYmxlUHJvZ3JhbSgpCiAgICAgICAgc2VsZi5wcm9ncmFtLmNyZWF0ZVRlc3RzID0gbGFtYmRhOiBOb25lCiAgICAgICAgRmFrZVJ1bm5lci5pbml0QXJncyA9IE5vbmUKICAgICAgICBGYWtlUnVubmVyLnRlc3QgPSBOb25lCiAgICAgICAgRmFrZVJ1bm5lci5yYWlzZUVycm9yID0gRmFsc2UKCiAgICBkZWYgdGVzdFZlcmJvc2l0eShzZWxmKToKICAgICAgICBwcm9ncmFtID0gc2VsZi5wcm9ncmFtCgogICAgICAgIGZvciBvcHQgaW4gJy1xJywgJy0tcXVpZXQnOgogICAgICAgICAgICBwcm9ncmFtLnZlcmJvc2l0eSA9IDEKICAgICAgICAgICAgcHJvZ3JhbS5wYXJzZUFyZ3MoW05vbmUsIG9wdF0pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS52ZXJib3NpdHksIDApCgogICAgICAgIGZvciBvcHQgaW4gJy12JywgJy0tdmVyYm9zZSc6CiAgICAgICAgICAgIHByb2dyYW0udmVyYm9zaXR5ID0gMQogICAgICAgICAgICBwcm9ncmFtLnBhcnNlQXJncyhbTm9uZSwgb3B0XSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm9ncmFtLnZlcmJvc2l0eSwgMikKCiAgICBkZWYgdGVzdEJ1ZmZlckNhdGNoRmFpbGZhc3Qoc2VsZik6CiAgICAgICAgcHJvZ3JhbSA9IHNlbGYucHJvZ3JhbQogICAgICAgIGZvciBhcmcsIGF0dHIgaW4gKCgnYnVmZmVyJywgJ2J1ZmZlcicpLCAoJ2ZhaWxmYXN0JywgJ2ZhaWxmYXN0JyksCiAgICAgICAgICAgICAgICAgICAgICAoJ2NhdGNoJywgJ2NhdGNoYnJlYWsnKSk6CiAgICAgICAgICAgIGlmIGF0dHIgPT0gJ2NhdGNoJyBhbmQgbm90IGhhc0luc3RhbGxIYW5kbGVyOgogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIHNob3J0X29wdCA9ICctJXMnICUgYXJnWzBdCiAgICAgICAgICAgIGxvbmdfb3B0ID0gJy0tJXMnICUgYXJnCiAgICAgICAgICAgIGZvciBvcHQgaW4gc2hvcnRfb3B0LCBsb25nX29wdDoKICAgICAgICAgICAgICAgIHNldGF0dHIocHJvZ3JhbSwgYXR0ciwgTm9uZSkKCiAgICAgICAgICAgICAgICBwcm9ncmFtLnBhcnNlQXJncyhbTm9uZSwgb3B0XSkKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShnZXRhdHRyKHByb2dyYW0sIGF0dHIpKQoKICAgICAgICAgICAgZm9yIG9wdCBpbiBzaG9ydF9vcHQsIGxvbmdfb3B0OgogICAgICAgICAgICAgICAgbm90X25vbmUgPSBvYmplY3QoKQogICAgICAgICAgICAgICAgc2V0YXR0cihwcm9ncmFtLCBhdHRyLCBub3Rfbm9uZSkKCiAgICAgICAgICAgICAgICBwcm9ncmFtLnBhcnNlQXJncyhbTm9uZSwgb3B0XSkKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZ2V0YXR0cihwcm9ncmFtLCBhdHRyKSwgbm90X25vbmUpCgogICAgZGVmIHRlc3RXYXJuaW5nKHNlbGYpOgogICAgICAgICIiIlRlc3QgdGhlIHdhcm5pbmdzIGFyZ3VtZW50IiIiCiAgICAgICAgIyBzZWUgIzEwNTM1CiAgICAgICAgY2xhc3MgRmFrZVRQKHVuaXR0ZXN0LlRlc3RQcm9ncmFtKToKICAgICAgICAgICAgZGVmIHBhcnNlQXJncyhzZWxmLCAqYXJncywgKiprdyk6IHBhc3MKICAgICAgICAgICAgZGVmIHJ1blRlc3RzKHNlbGYsICphcmdzLCAqKmt3KTogcGFzcwogICAgICAgIHdhcm5vcHRpb25zID0gc3lzLndhcm5vcHRpb25zWzpdCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzeXMud2Fybm9wdGlvbnNbOl0gPSBbXQogICAgICAgICAgICAjIG5vIHdhcm4gb3B0aW9ucywgbm8gYXJnIC0+IGRlZmF1bHQKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGYWtlVFAoKS53YXJuaW5ncywgJ2RlZmF1bHQnKQogICAgICAgICAgICAjIG5vIHdhcm4gb3B0aW9ucywgdy8gYXJnIC0+IGFyZyB2YWx1ZQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZha2VUUCh3YXJuaW5ncz0naWdub3JlJykud2FybmluZ3MsICdpZ25vcmUnKQogICAgICAgICAgICBzeXMud2Fybm9wdGlvbnNbOl0gPSBbJ3NvbWV2YWx1ZSddCiAgICAgICAgICAgICMgd2FybiBvcHRpb25zLCBubyBhcmcgLT4gTm9uZQogICAgICAgICAgICAjIHdhcm4gb3B0aW9ucywgdy8gYXJnIC0+IGFyZyB2YWx1ZQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZha2VUUCgpLndhcm5pbmdzLCBOb25lKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZha2VUUCh3YXJuaW5ncz0naWdub3JlJykud2FybmluZ3MsICdpZ25vcmUnKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHN5cy53YXJub3B0aW9uc1s6XSA9IHdhcm5vcHRpb25zCgogICAgZGVmIHRlc3RSdW5UZXN0c1J1bm5lckNsYXNzKHNlbGYpOgogICAgICAgIHByb2dyYW0gPSBzZWxmLnByb2dyYW0KCiAgICAgICAgcHJvZ3JhbS50ZXN0UnVubmVyID0gRmFrZVJ1bm5lcgogICAgICAgIHByb2dyYW0udmVyYm9zaXR5ID0gJ3ZlcmJvc2l0eScKICAgICAgICBwcm9ncmFtLmZhaWxmYXN0ID0gJ2ZhaWxmYXN0JwogICAgICAgIHByb2dyYW0uYnVmZmVyID0gJ2J1ZmZlcicKICAgICAgICBwcm9ncmFtLndhcm5pbmdzID0gJ3dhcm5pbmdzJwoKICAgICAgICBwcm9ncmFtLnJ1blRlc3RzKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGYWtlUnVubmVyLmluaXRBcmdzLCB7J3ZlcmJvc2l0eSc6ICd2ZXJib3NpdHknLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZmFpbGZhc3QnOiAnZmFpbGZhc3QnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYnVmZmVyJzogJ2J1ZmZlcicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd3YXJuaW5ncyc6ICd3YXJuaW5ncyd9KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRmFrZVJ1bm5lci50ZXN0LCAndGVzdCcpCiAgICAgICAgc2VsZi5hc3NlcnRJcyhwcm9ncmFtLnJlc3VsdCwgUkVTVUxUKQoKICAgIGRlZiB0ZXN0UnVuVGVzdHNSdW5uZXJJbnN0YW5jZShzZWxmKToKICAgICAgICBwcm9ncmFtID0gc2VsZi5wcm9ncmFtCgogICAgICAgIHByb2dyYW0udGVzdFJ1bm5lciA9IEZha2VSdW5uZXIoKQogICAgICAgIEZha2VSdW5uZXIuaW5pdEFyZ3MgPSBOb25lCgogICAgICAgIHByb2dyYW0ucnVuVGVzdHMoKQoKICAgICAgICAjIEEgbmV3IEZha2VSdW5uZXIgc2hvdWxkIG5vdCBoYXZlIGJlZW4gaW5zdGFudGlhdGVkCiAgICAgICAgc2VsZi5hc3NlcnRJc05vbmUoRmFrZVJ1bm5lci5pbml0QXJncykKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGYWtlUnVubmVyLnRlc3QsICd0ZXN0JykKICAgICAgICBzZWxmLmFzc2VydElzKHByb2dyYW0ucmVzdWx0LCBSRVNVTFQpCgogICAgZGVmIHRlc3RSdW5UZXN0c09sZFJ1bm5lckNsYXNzKHNlbGYpOgogICAgICAgIHByb2dyYW0gPSBzZWxmLnByb2dyYW0KCiAgICAgICAgRmFrZVJ1bm5lci5yYWlzZUVycm9yID0gVHJ1ZQogICAgICAgIHByb2dyYW0udGVzdFJ1bm5lciA9IEZha2VSdW5uZXIKICAgICAgICBwcm9ncmFtLnZlcmJvc2l0eSA9ICd2ZXJib3NpdHknCiAgICAgICAgcHJvZ3JhbS5mYWlsZmFzdCA9ICdmYWlsZmFzdCcKICAgICAgICBwcm9ncmFtLmJ1ZmZlciA9ICdidWZmZXInCiAgICAgICAgcHJvZ3JhbS50ZXN0ID0gJ3Rlc3QnCgogICAgICAgIHByb2dyYW0ucnVuVGVzdHMoKQoKICAgICAgICAjIElmIGluaXRpYWxpc2luZyByYWlzZXMgYSB0eXBlIGVycm9yIGl0IHNob3VsZCBiZSByZXRyaWVkCiAgICAgICAgIyB3aXRob3V0IHRoZSBuZXcga2V5d29yZCBhcmd1bWVudHMKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZha2VSdW5uZXIuaW5pdEFyZ3MsIHt9KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRmFrZVJ1bm5lci50ZXN0LCAndGVzdCcpCiAgICAgICAgc2VsZi5hc3NlcnRJcyhwcm9ncmFtLnJlc3VsdCwgUkVTVUxUKQoKICAgIGRlZiB0ZXN0Q2F0Y2hCcmVha0luc3RhbGxzSGFuZGxlcihzZWxmKToKICAgICAgICBtb2R1bGUgPSBzeXMubW9kdWxlc1sndW5pdHRlc3QubWFpbiddCiAgICAgICAgb3JpZ2luYWwgPSBtb2R1bGUuaW5zdGFsbEhhbmRsZXIKICAgICAgICBkZWYgcmVzdG9yZSgpOgogICAgICAgICAgICBtb2R1bGUuaW5zdGFsbEhhbmRsZXIgPSBvcmlnaW5hbAogICAgICAgIHNlbGYuYWRkQ2xlYW51cChyZXN0b3JlKQoKICAgICAgICBzZWxmLmluc3RhbGxlZCA9IEZhbHNlCiAgICAgICAgZGVmIGZha2VJbnN0YWxsSGFuZGxlcigpOgogICAgICAgICAgICBzZWxmLmluc3RhbGxlZCA9IFRydWUKICAgICAgICBtb2R1bGUuaW5zdGFsbEhhbmRsZXIgPSBmYWtlSW5zdGFsbEhhbmRsZXIKCiAgICAgICAgcHJvZ3JhbSA9IHNlbGYucHJvZ3JhbQogICAgICAgIHByb2dyYW0uY2F0Y2hicmVhayA9IFRydWUKCiAgICAgICAgcHJvZ3JhbS50ZXN0UnVubmVyID0gRmFrZVJ1bm5lcgoKICAgICAgICBwcm9ncmFtLnJ1blRlc3RzKCkKICAgICAgICBzZWxmLmFzc2VydFRydWUoc2VsZi5pbnN0YWxsZWQpCgogICAgZGVmIF9wYXRjaF9pc2ZpbGUoc2VsZiwgbmFtZXMsIGV4aXN0cz1UcnVlKToKICAgICAgICBkZWYgaXNmaWxlKHBhdGgpOgogICAgICAgICAgICByZXR1cm4gcGF0aCBpbiBuYW1lcwogICAgICAgIG9yaWdpbmFsID0gb3MucGF0aC5pc2ZpbGUKICAgICAgICBvcy5wYXRoLmlzZmlsZSA9IGlzZmlsZQogICAgICAgIGRlZiByZXN0b3JlKCk6CiAgICAgICAgICAgIG9zLnBhdGguaXNmaWxlID0gb3JpZ2luYWwKICAgICAgICBzZWxmLmFkZENsZWFudXAocmVzdG9yZSkKCgogICAgZGVmIHRlc3RQYXJzZUFyZ3NGaWxlTmFtZXMoc2VsZik6CiAgICAgICAgIyBydW5uaW5nIHRlc3RzIHdpdGggZmlsZW5hbWVzIGluc3RlYWQgb2YgbW9kdWxlIG5hbWVzCiAgICAgICAgcHJvZ3JhbSA9IHNlbGYucHJvZ3JhbQogICAgICAgIGFyZ3YgPSBbJ3Byb2duYW1lJywgJ2Zvby5weScsICdiYXIuUHknLCAnYmF6LlBZJywgJ3dpbmcudHh0J10KICAgICAgICBzZWxmLl9wYXRjaF9pc2ZpbGUoYXJndikKCiAgICAgICAgcHJvZ3JhbS5jcmVhdGVUZXN0cyA9IGxhbWJkYTogTm9uZQogICAgICAgIHByb2dyYW0ucGFyc2VBcmdzKGFyZ3YpCgogICAgICAgICMgbm90ZSB0aGF0ICd3aW5nLnR4dCcgaXMgbm90IGEgUHl0aG9uIGZpbGUgc28gdGhlIG5hbWUgc2hvdWxkCiAgICAgICAgIyAqbm90KiBiZSBjb252ZXJ0ZWQgdG8gYSBtb2R1bGUgbmFtZQogICAgICAgIGV4cGVjdGVkID0gWydmb28nLCAnYmFyJywgJ2JheicsICd3aW5nLnR4dCddCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm9ncmFtLnRlc3ROYW1lcywgZXhwZWN0ZWQpCgoKICAgIGRlZiB0ZXN0UGFyc2VBcmdzRmlsZVBhdGhzKHNlbGYpOgogICAgICAgIHByb2dyYW0gPSBzZWxmLnByb2dyYW0KICAgICAgICBhcmd2ID0gWydwcm9nbmFtZScsICdmb28vYmFyL2Jhei5weScsICdncmVlblxccmVkLnB5J10KICAgICAgICBzZWxmLl9wYXRjaF9pc2ZpbGUoYXJndikKCiAgICAgICAgcHJvZ3JhbS5jcmVhdGVUZXN0cyA9IGxhbWJkYTogTm9uZQogICAgICAgIHByb2dyYW0ucGFyc2VBcmdzKGFyZ3YpCgogICAgICAgIGV4cGVjdGVkID0gWydmb28uYmFyLmJheicsICdncmVlbi5yZWQnXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS50ZXN0TmFtZXMsIGV4cGVjdGVkKQoKCiAgICBkZWYgdGVzdFBhcnNlQXJnc05vbkV4aXN0ZW50RmlsZXMoc2VsZik6CiAgICAgICAgcHJvZ3JhbSA9IHNlbGYucHJvZ3JhbQogICAgICAgIGFyZ3YgPSBbJ3Byb2duYW1lJywgJ2Zvby9iYXIvYmF6LnB5JywgJ2dyZWVuXFxyZWQucHknXQogICAgICAgIHNlbGYuX3BhdGNoX2lzZmlsZShbXSkKCiAgICAgICAgcHJvZ3JhbS5jcmVhdGVUZXN0cyA9IGxhbWJkYTogTm9uZQogICAgICAgIHByb2dyYW0ucGFyc2VBcmdzKGFyZ3YpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS50ZXN0TmFtZXMsIGFyZ3ZbMTpdKQoKICAgIGRlZiB0ZXN0UGFyc2VBcmdzQWJzb2x1dGVQYXRoc1RoYXRDYW5CZUNvbnZlcnRlZChzZWxmKToKICAgICAgICBjdXJfZGlyID0gb3MuZ2V0Y3dkKCkKICAgICAgICBwcm9ncmFtID0gc2VsZi5wcm9ncmFtCiAgICAgICAgZGVmIF9qb2luKG5hbWUpOgogICAgICAgICAgICByZXR1cm4gb3MucGF0aC5qb2luKGN1cl9kaXIsIG5hbWUpCiAgICAgICAgYXJndiA9IFsncHJvZ25hbWUnLCBfam9pbignZm9vL2Jhci9iYXoucHknKSwgX2pvaW4oJ2dyZWVuXFxyZWQucHknKV0KICAgICAgICBzZWxmLl9wYXRjaF9pc2ZpbGUoYXJndikKCiAgICAgICAgcHJvZ3JhbS5jcmVhdGVUZXN0cyA9IGxhbWJkYTogTm9uZQogICAgICAgIHByb2dyYW0ucGFyc2VBcmdzKGFyZ3YpCgogICAgICAgIGV4cGVjdGVkID0gWydmb28uYmFyLmJheicsICdncmVlbi5yZWQnXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvZ3JhbS50ZXN0TmFtZXMsIGV4cGVjdGVkKQoKICAgIGRlZiB0ZXN0UGFyc2VBcmdzQWJzb2x1dGVQYXRoc1RoYXRDYW5ub3RCZUNvbnZlcnRlZChzZWxmKToKICAgICAgICBwcm9ncmFtID0gc2VsZi5wcm9ncmFtCiAgICAgICAgIyBldmVuIG9uIFdpbmRvd3MgJy8uLi4nIGlzIGNvbnNpZGVyZWQgYWJzb2x1dGUgYnkgb3MucGF0aC5hYnNwYXRoCiAgICAgICAgYXJndiA9IFsncHJvZ25hbWUnLCAnL2Zvby9iYXIvYmF6LnB5JywgJy9ncmVlbi9yZWQucHknXQogICAgICAgIHNlbGYuX3BhdGNoX2lzZmlsZShhcmd2KQoKICAgICAgICBwcm9ncmFtLmNyZWF0ZVRlc3RzID0gbGFtYmRhOiBOb25lCiAgICAgICAgcHJvZ3JhbS5wYXJzZUFyZ3MoYXJndikKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm9ncmFtLnRlc3ROYW1lcywgYXJndlsxOl0pCgogICAgICAgICMgaXQgbWF5IGJlIGJldHRlciB0byB1c2UgcGxhdGZvcm0gc3BlY2lmaWMgZnVuY3Rpb25zIHRvIG5vcm1hbGlzZSBwYXRocwogICAgICAgICMgcmF0aGVyIHRoYW4gYWNjZXB0aW5nICcuUFknIGFuZCAnXCcgYXMgZmlsZSBzZXByYXRvciBvbiBMaW51eCAvIE1hYwogICAgICAgICMgaXQgd291bGQgYWxzbyBiZSBiZXR0ZXIgdG8gY2hlY2sgdGhhdCBhIGZpbGVuYW1lIGlzIGEgdmFsaWQgbW9kdWxlCiAgICAgICAgIyBpZGVudGlmaWVyICh3ZSBoYXZlIGEgcmVnZXggZm9yIHRoaXMgaW4gbG9hZGVyLnB5KQogICAgICAgICMgZm9yIGludmFsaWQgZmlsZW5hbWVzIHNob3VsZCB3ZSByYWlzZSBhIHVzZWZ1bCBlcnJvciByYXRoZXIgdGhhbgogICAgICAgICMgbGVhdmluZyB0aGUgY3VycmVudCBlcnJvciBtZXNzYWdlIChpbXBvcnQgb2YgZmlsZW5hbWUgZmFpbHMpIGluIHBsYWNlPwoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICB1bml0dGVzdC5tYWluKCkK',
'/Lib/unittest/test/test_result.py':'aW1wb3J0IGlvCmltcG9ydCBzeXMKaW1wb3J0IHRleHR3cmFwCgpmcm9tIHRlc3QgaW1wb3J0IHN1cHBvcnQKCmltcG9ydCB0cmFjZWJhY2sKaW1wb3J0IHVuaXR0ZXN0CgoKY2xhc3MgVGVzdF9UZXN0UmVzdWx0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICMgTm90ZTogdGhlcmUgYXJlIG5vdCBzZXBhcmF0ZSB0ZXN0cyBmb3IgVGVzdFJlc3VsdC53YXNTdWNjZXNzZnVsKCksCiAgICAjIFRlc3RSZXN1bHQuZXJyb3JzLCBUZXN0UmVzdWx0LmZhaWx1cmVzLCBUZXN0UmVzdWx0LnRlc3RzUnVuIG9yCiAgICAjIFRlc3RSZXN1bHQuc2hvdWxkU3RvcCBiZWNhdXNlIHRoZXNlIG9ubHkgaGF2ZSBtZWFuaW5nIGluIHRlcm1zIG9mCiAgICAjIG90aGVyIFRlc3RSZXN1bHQgbWV0aG9kcy4KICAgICMKICAgICMgQWNjb3JkaW5nbHksIHRlc3RzIGZvciB0aGUgYWZvcmVuYW1lZCBhdHRyaWJ1dGVzIGFyZSBpbmNvcnBvcmF0ZWQKICAgICMgaW4gd2l0aCB0aGUgdGVzdHMgZm9yIHRoZSBkZWZpbmluZyBtZXRob2RzLgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgIGRlZiB0ZXN0X2luaXQoc2VsZik6CiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCgogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShyZXN1bHQud2FzU3VjY2Vzc2Z1bCgpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAwKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5mYWlsdXJlcyksIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQuc2hvdWxkU3RvcCwgRmFsc2UpCiAgICAgICAgc2VsZi5hc3NlcnRJc05vbmUocmVzdWx0Ll9zdGRvdXRfYnVmZmVyKQogICAgICAgIHNlbGYuYXNzZXJ0SXNOb25lKHJlc3VsdC5fc3RkZXJyX2J1ZmZlcikKCiAgICAjICJUaGlzIG1ldGhvZCBjYW4gYmUgY2FsbGVkIHRvIHNpZ25hbCB0aGF0IHRoZSBzZXQgb2YgdGVzdHMgYmVpbmcKICAgICMgcnVuIHNob3VsZCBiZSBhYm9ydGVkIGJ5IHNldHRpbmcgdGhlIFRlc3RSZXN1bHQncyBzaG91bGRTdG9wCiAgICAjIGF0dHJpYnV0ZSB0byBUcnVlLiIKICAgIGRlZiB0ZXN0X3N0b3Aoc2VsZik6CiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCgogICAgICAgIHJlc3VsdC5zdG9wKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQuc2hvdWxkU3RvcCwgVHJ1ZSkKCiAgICAjICJDYWxsZWQgd2hlbiB0aGUgdGVzdCBjYXNlIHRlc3QgaXMgYWJvdXQgdG8gYmUgcnVuLiBUaGUgZGVmYXVsdAogICAgIyBpbXBsZW1lbnRhdGlvbiBzaW1wbHkgaW5jcmVtZW50cyB0aGUgaW5zdGFuY2UncyB0ZXN0c1J1biBjb3VudGVyLiIKICAgIGRlZiB0ZXN0X3N0YXJ0VGVzdChzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICB0ZXN0ID0gRm9vKCd0ZXN0XzEnKQoKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKCiAgICAgICAgcmVzdWx0LnN0YXJ0VGVzdCh0ZXN0KQoKICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0Lndhc1N1Y2Nlc3NmdWwoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZXJyb3JzKSwgMCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZmFpbHVyZXMpLCAwKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnNob3VsZFN0b3AsIEZhbHNlKQoKICAgICAgICByZXN1bHQuc3RvcFRlc3QodGVzdCkKCiAgICAjICJDYWxsZWQgYWZ0ZXIgdGhlIHRlc3QgY2FzZSB0ZXN0IGhhcyBiZWVuIGV4ZWN1dGVkLCByZWdhcmRsZXNzIG9mCiAgICAjIHRoZSBvdXRjb21lLiBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBkb2VzIG5vdGhpbmcuIgogICAgZGVmIHRlc3Rfc3RvcFRlc3Qoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgdGVzdCA9IEZvbygndGVzdF8xJykKCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCgogICAgICAgIHJlc3VsdC5zdGFydFRlc3QodGVzdCkKCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHJlc3VsdC53YXNTdWNjZXNzZnVsKCkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmZhaWx1cmVzKSwgMCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC50ZXN0c1J1biwgMSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC5zaG91bGRTdG9wLCBGYWxzZSkKCiAgICAgICAgcmVzdWx0LnN0b3BUZXN0KHRlc3QpCgogICAgICAgICMgU2FtZSB0ZXN0cyBhcyBhYm92ZTsgbWFrZSBzdXJlIG5vdGhpbmcgaGFzIGNoYW5nZWQKICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0Lndhc1N1Y2Nlc3NmdWwoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZXJyb3JzKSwgMCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZmFpbHVyZXMpLCAwKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnNob3VsZFN0b3AsIEZhbHNlKQoKICAgICMgIkNhbGxlZCBiZWZvcmUgYW5kIGFmdGVyIHRlc3RzIGFyZSBydW4uIFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIGRvZXMgbm90aGluZy4iCiAgICBkZWYgdGVzdF9zdGFydFRlc3RSdW5fc3RvcFRlc3RSdW4oc2VsZik6CiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgcmVzdWx0LnN0YXJ0VGVzdFJ1bigpCiAgICAgICAgcmVzdWx0LnN0b3BUZXN0UnVuKCkKCiAgICAjICJhZGRTdWNjZXNzKHRlc3QpIgogICAgIyAuLi4KICAgICMgIkNhbGxlZCB3aGVuIHRoZSB0ZXN0IGNhc2UgdGVzdCBzdWNjZWVkcyIKICAgICMgLi4uCiAgICAjICJ3YXNTdWNjZXNzZnVsKCkgLSBSZXR1cm5zIFRydWUgaWYgYWxsIHRlc3RzIHJ1biBzbyBmYXIgaGF2ZSBwYXNzZWQsCiAgICAjIG90aGVyd2lzZSByZXR1cm5zIEZhbHNlIgogICAgIyAuLi4KICAgICMgInRlc3RzUnVuIC0gVGhlIHRvdGFsIG51bWJlciBvZiB0ZXN0cyBydW4gc28gZmFyLiIKICAgICMgLi4uCiAgICAjICJlcnJvcnMgLSBBIGxpc3QgY29udGFpbmluZyAyLXR1cGxlcyBvZiBUZXN0Q2FzZSBpbnN0YW5jZXMgYW5kCiAgICAjIGZvcm1hdHRlZCB0cmFjZWJhY2tzLiBFYWNoIHR1cGxlIHJlcHJlc2VudHMgYSB0ZXN0IHdoaWNoIHJhaXNlZCBhbgogICAgIyB1bmV4cGVjdGVkIGV4Y2VwdGlvbi4gQ29udGFpbnMgZm9ybWF0dGVkCiAgICAjIHRyYWNlYmFja3MgaW5zdGVhZCBvZiBzeXMuZXhjX2luZm8oKSByZXN1bHRzLiIKICAgICMgLi4uCiAgICAjICJmYWlsdXJlcyAtIEEgbGlzdCBjb250YWluaW5nIDItdHVwbGVzIG9mIFRlc3RDYXNlIGluc3RhbmNlcyBhbmQKICAgICMgZm9ybWF0dGVkIHRyYWNlYmFja3MuIEVhY2ggdHVwbGUgcmVwcmVzZW50cyBhIHRlc3Qgd2hlcmUgYSBmYWlsdXJlIHdhcwogICAgIyBleHBsaWNpdGx5IHNpZ25hbGxlZCB1c2luZyB0aGUgVGVzdENhc2UuZmFpbCooKSBvciBUZXN0Q2FzZS5hc3NlcnQqKCkKICAgICMgbWV0aG9kcy4gQ29udGFpbnMgZm9ybWF0dGVkIHRyYWNlYmFja3MgaW5zdGVhZAogICAgIyBvZiBzeXMuZXhjX2luZm8oKSByZXN1bHRzLiIKICAgIGRlZiB0ZXN0X2FkZFN1Y2Nlc3Moc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgdGVzdCA9IEZvbygndGVzdF8xJykKCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCgogICAgICAgIHJlc3VsdC5zdGFydFRlc3QodGVzdCkKICAgICAgICByZXN1bHQuYWRkU3VjY2Vzcyh0ZXN0KQogICAgICAgIHJlc3VsdC5zdG9wVGVzdCh0ZXN0KQoKICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0Lndhc1N1Y2Nlc3NmdWwoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZXJyb3JzKSwgMCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZmFpbHVyZXMpLCAwKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnNob3VsZFN0b3AsIEZhbHNlKQoKICAgICMgImFkZEZhaWx1cmUodGVzdCwgZXJyKSIKICAgICMgLi4uCiAgICAjICJDYWxsZWQgd2hlbiB0aGUgdGVzdCBjYXNlIHRlc3Qgc2lnbmFscyBhIGZhaWx1cmUuIGVyciBpcyBhIHR1cGxlIG9mCiAgICAjIHRoZSBmb3JtIHJldHVybmVkIGJ5IHN5cy5leGNfaW5mbygpOiAodHlwZSwgdmFsdWUsIHRyYWNlYmFjaykiCiAgICAjIC4uLgogICAgIyAid2FzU3VjY2Vzc2Z1bCgpIC0gUmV0dXJucyBUcnVlIGlmIGFsbCB0ZXN0cyBydW4gc28gZmFyIGhhdmUgcGFzc2VkLAogICAgIyBvdGhlcndpc2UgcmV0dXJucyBGYWxzZSIKICAgICMgLi4uCiAgICAjICJ0ZXN0c1J1biAtIFRoZSB0b3RhbCBudW1iZXIgb2YgdGVzdHMgcnVuIHNvIGZhci4iCiAgICAjIC4uLgogICAgIyAiZXJyb3JzIC0gQSBsaXN0IGNvbnRhaW5pbmcgMi10dXBsZXMgb2YgVGVzdENhc2UgaW5zdGFuY2VzIGFuZAogICAgIyBmb3JtYXR0ZWQgdHJhY2ViYWNrcy4gRWFjaCB0dXBsZSByZXByZXNlbnRzIGEgdGVzdCB3aGljaCByYWlzZWQgYW4KICAgICMgdW5leHBlY3RlZCBleGNlcHRpb24uIENvbnRhaW5zIGZvcm1hdHRlZAogICAgIyB0cmFjZWJhY2tzIGluc3RlYWQgb2Ygc3lzLmV4Y19pbmZvKCkgcmVzdWx0cy4iCiAgICAjIC4uLgogICAgIyAiZmFpbHVyZXMgLSBBIGxpc3QgY29udGFpbmluZyAyLXR1cGxlcyBvZiBUZXN0Q2FzZSBpbnN0YW5jZXMgYW5kCiAgICAjIGZvcm1hdHRlZCB0cmFjZWJhY2tzLiBFYWNoIHR1cGxlIHJlcHJlc2VudHMgYSB0ZXN0IHdoZXJlIGEgZmFpbHVyZSB3YXMKICAgICMgZXhwbGljaXRseSBzaWduYWxsZWQgdXNpbmcgdGhlIFRlc3RDYXNlLmZhaWwqKCkgb3IgVGVzdENhc2UuYXNzZXJ0KigpCiAgICAjIG1ldGhvZHMuIENvbnRhaW5zIGZvcm1hdHRlZCB0cmFjZWJhY2tzIGluc3RlYWQKICAgICMgb2Ygc3lzLmV4Y19pbmZvKCkgcmVzdWx0cy4iCiAgICBkZWYgdGVzdF9hZGRGYWlsdXJlKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0XzEoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIHRlc3QgPSBGb28oJ3Rlc3RfMScpCiAgICAgICAgdHJ5OgogICAgICAgICAgICB0ZXN0LmZhaWwoImZvbyIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBleGNfaW5mb190dXBsZSA9IHN5cy5leGNfaW5mbygpCgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQoKICAgICAgICByZXN1bHQuc3RhcnRUZXN0KHRlc3QpCiAgICAgICAgcmVzdWx0LmFkZEZhaWx1cmUodGVzdCwgZXhjX2luZm9fdHVwbGUpCiAgICAgICAgcmVzdWx0LnN0b3BUZXN0KHRlc3QpCgogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UocmVzdWx0Lndhc1N1Y2Nlc3NmdWwoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZXJyb3JzKSwgMCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZmFpbHVyZXMpLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnNob3VsZFN0b3AsIEZhbHNlKQoKICAgICAgICB0ZXN0X2Nhc2UsIGZvcm1hdHRlZF9leGMgPSByZXN1bHQuZmFpbHVyZXNbMF0KICAgICAgICBzZWxmLmFzc2VydFRydWUodGVzdF9jYXNlIGlzIHRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGZvcm1hdHRlZF9leGMsIHN0cikKCiAgICAjICJhZGRFcnJvcih0ZXN0LCBlcnIpIgogICAgIyAuLi4KICAgICMgIkNhbGxlZCB3aGVuIHRoZSB0ZXN0IGNhc2UgdGVzdCByYWlzZXMgYW4gdW5leHBlY3RlZCBleGNlcHRpb24gZXJyCiAgICAjIGlzIGEgdHVwbGUgb2YgdGhlIGZvcm0gcmV0dXJuZWQgYnkgc3lzLmV4Y19pbmZvKCk6CiAgICAjICh0eXBlLCB2YWx1ZSwgdHJhY2ViYWNrKSIKICAgICMgLi4uCiAgICAjICJ3YXNTdWNjZXNzZnVsKCkgLSBSZXR1cm5zIFRydWUgaWYgYWxsIHRlc3RzIHJ1biBzbyBmYXIgaGF2ZSBwYXNzZWQsCiAgICAjIG90aGVyd2lzZSByZXR1cm5zIEZhbHNlIgogICAgIyAuLi4KICAgICMgInRlc3RzUnVuIC0gVGhlIHRvdGFsIG51bWJlciBvZiB0ZXN0cyBydW4gc28gZmFyLiIKICAgICMgLi4uCiAgICAjICJlcnJvcnMgLSBBIGxpc3QgY29udGFpbmluZyAyLXR1cGxlcyBvZiBUZXN0Q2FzZSBpbnN0YW5jZXMgYW5kCiAgICAjIGZvcm1hdHRlZCB0cmFjZWJhY2tzLiBFYWNoIHR1cGxlIHJlcHJlc2VudHMgYSB0ZXN0IHdoaWNoIHJhaXNlZCBhbgogICAgIyB1bmV4cGVjdGVkIGV4Y2VwdGlvbi4gQ29udGFpbnMgZm9ybWF0dGVkCiAgICAjIHRyYWNlYmFja3MgaW5zdGVhZCBvZiBzeXMuZXhjX2luZm8oKSByZXN1bHRzLiIKICAgICMgLi4uCiAgICAjICJmYWlsdXJlcyAtIEEgbGlzdCBjb250YWluaW5nIDItdHVwbGVzIG9mIFRlc3RDYXNlIGluc3RhbmNlcyBhbmQKICAgICMgZm9ybWF0dGVkIHRyYWNlYmFja3MuIEVhY2ggdHVwbGUgcmVwcmVzZW50cyBhIHRlc3Qgd2hlcmUgYSBmYWlsdXJlIHdhcwogICAgIyBleHBsaWNpdGx5IHNpZ25hbGxlZCB1c2luZyB0aGUgVGVzdENhc2UuZmFpbCooKSBvciBUZXN0Q2FzZS5hc3NlcnQqKCkKICAgICMgbWV0aG9kcy4gQ29udGFpbnMgZm9ybWF0dGVkIHRyYWNlYmFja3MgaW5zdGVhZAogICAgIyBvZiBzeXMuZXhjX2luZm8oKSByZXN1bHRzLiIKICAgIGRlZiB0ZXN0X2FkZEVycm9yKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0XzEoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIHRlc3QgPSBGb28oJ3Rlc3RfMScpCiAgICAgICAgdHJ5OgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgZXhjX2luZm9fdHVwbGUgPSBzeXMuZXhjX2luZm8oKQoKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKCiAgICAgICAgcmVzdWx0LnN0YXJ0VGVzdCh0ZXN0KQogICAgICAgIHJlc3VsdC5hZGRFcnJvcih0ZXN0LCBleGNfaW5mb190dXBsZSkKICAgICAgICByZXN1bHQuc3RvcFRlc3QodGVzdCkKCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShyZXN1bHQud2FzU3VjY2Vzc2Z1bCgpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5mYWlsdXJlcyksIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDEpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQuc2hvdWxkU3RvcCwgRmFsc2UpCgogICAgICAgIHRlc3RfY2FzZSwgZm9ybWF0dGVkX2V4YyA9IHJlc3VsdC5lcnJvcnNbMF0KICAgICAgICBzZWxmLmFzc2VydFRydWUodGVzdF9jYXNlIGlzIHRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGZvcm1hdHRlZF9leGMsIHN0cikKCiAgICBkZWYgdGVzdEdldERlc2NyaXB0aW9uV2l0aG91dERvY3N0cmluZyhzZWxmKToKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXh0VGVzdFJlc3VsdChOb25lLCBUcnVlLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoCiAgICAgICAgICAgICAgICByZXN1bHQuZ2V0RGVzY3JpcHRpb24oc2VsZiksCiAgICAgICAgICAgICAgICAndGVzdEdldERlc2NyaXB0aW9uV2l0aG91dERvY3N0cmluZyAoJyArIF9fbmFtZV9fICsKICAgICAgICAgICAgICAgICcuVGVzdF9UZXN0UmVzdWx0KScpCgogICAgQHVuaXR0ZXN0LnNraXBJZihzeXMuZmxhZ3Mub3B0aW1pemUgPj0gMiwKICAgICAgICAgICAgICAgICAgICAgIkRvY3N0cmluZ3MgYXJlIG9taXR0ZWQgd2l0aCAtTzIgYW5kIGFib3ZlIikKICAgIGRlZiB0ZXN0R2V0RGVzY3JpcHRpb25XaXRoT25lTGluZURvY3N0cmluZyhzZWxmKToKICAgICAgICAiIiJUZXN0cyBnZXREZXNjcmlwdGlvbigpIGZvciBhIG1ldGhvZCB3aXRoIGEgZG9jc3RyaW5nLiIiIgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRleHRUZXN0UmVzdWx0KE5vbmUsIFRydWUsIDEpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgKICAgICAgICAgICAgICAgIHJlc3VsdC5nZXREZXNjcmlwdGlvbihzZWxmKSwKICAgICAgICAgICAgICAgKCd0ZXN0R2V0RGVzY3JpcHRpb25XaXRoT25lTGluZURvY3N0cmluZyAnCiAgICAgICAgICAgICAgICAnKCcgKyBfX25hbWVfXyArICcuVGVzdF9UZXN0UmVzdWx0KVxuJwogICAgICAgICAgICAgICAgJ1Rlc3RzIGdldERlc2NyaXB0aW9uKCkgZm9yIGEgbWV0aG9kIHdpdGggYSBkb2NzdHJpbmcuJykpCgogICAgQHVuaXR0ZXN0LnNraXBJZihzeXMuZmxhZ3Mub3B0aW1pemUgPj0gMiwKICAgICAgICAgICAgICAgICAgICAgIkRvY3N0cmluZ3MgYXJlIG9taXR0ZWQgd2l0aCAtTzIgYW5kIGFib3ZlIikKICAgIGRlZiB0ZXN0R2V0RGVzY3JpcHRpb25XaXRoTXVsdGlMaW5lRG9jc3RyaW5nKHNlbGYpOgogICAgICAgICIiIlRlc3RzIGdldERlc2NyaXB0aW9uKCkgZm9yIGEgbWV0aG9kIHdpdGggYSBsb25nZXIgZG9jc3RyaW5nLgogICAgICAgIFRoZSBzZWNvbmQgbGluZSBvZiB0aGUgZG9jc3RyaW5nLgogICAgICAgICIiIgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRleHRUZXN0UmVzdWx0KE5vbmUsIFRydWUsIDEpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgKICAgICAgICAgICAgICAgIHJlc3VsdC5nZXREZXNjcmlwdGlvbihzZWxmKSwKICAgICAgICAgICAgICAgKCd0ZXN0R2V0RGVzY3JpcHRpb25XaXRoTXVsdGlMaW5lRG9jc3RyaW5nICcKICAgICAgICAgICAgICAgICcoJyArIF9fbmFtZV9fICsgJy5UZXN0X1Rlc3RSZXN1bHQpXG4nCiAgICAgICAgICAgICAgICAnVGVzdHMgZ2V0RGVzY3JpcHRpb24oKSBmb3IgYSBtZXRob2Qgd2l0aCBhIGxvbmdlciAnCiAgICAgICAgICAgICAgICAnZG9jc3RyaW5nLicpKQoKICAgIGRlZiB0ZXN0U3RhY2tGcmFtZVRyaW1taW5nKHNlbGYpOgogICAgICAgIGNsYXNzIEZyYW1lKG9iamVjdCk6CiAgICAgICAgICAgIGNsYXNzIHRiX2ZyYW1lKG9iamVjdCk6CiAgICAgICAgICAgICAgICBmX2dsb2JhbHMgPSB7fQogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UocmVzdWx0Ll9pc19yZWxldmFudF90Yl9sZXZlbChGcmFtZSkpCgogICAgICAgIEZyYW1lLnRiX2ZyYW1lLmZfZ2xvYmFsc1snX191bml0dGVzdCddID0gVHJ1ZQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShyZXN1bHQuX2lzX3JlbGV2YW50X3RiX2xldmVsKEZyYW1lKSkKCiAgICBkZWYgdGVzdEZhaWxGYXN0KHNlbGYpOgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHJlc3VsdC5fZXhjX2luZm9fdG9fc3RyaW5nID0gbGFtYmRhICpfOiAnJwogICAgICAgIHJlc3VsdC5mYWlsZmFzdCA9IFRydWUKICAgICAgICByZXN1bHQuYWRkRXJyb3IoTm9uZSwgTm9uZSkKICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0LnNob3VsZFN0b3ApCgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHJlc3VsdC5fZXhjX2luZm9fdG9fc3RyaW5nID0gbGFtYmRhICpfOiAnJwogICAgICAgIHJlc3VsdC5mYWlsZmFzdCA9IFRydWUKICAgICAgICByZXN1bHQuYWRkRmFpbHVyZShOb25lLCBOb25lKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShyZXN1bHQuc2hvdWxkU3RvcCkKCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgcmVzdWx0Ll9leGNfaW5mb190b19zdHJpbmcgPSBsYW1iZGEgKl86ICcnCiAgICAgICAgcmVzdWx0LmZhaWxmYXN0ID0gVHJ1ZQogICAgICAgIHJlc3VsdC5hZGRVbmV4cGVjdGVkU3VjY2VzcyhOb25lKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShyZXN1bHQuc2hvdWxkU3RvcCkKCiAgICBkZWYgdGVzdEZhaWxGYXN0U2V0QnlSdW5uZXIoc2VsZik6CiAgICAgICAgcnVubmVyID0gdW5pdHRlc3QuVGV4dFRlc3RSdW5uZXIoc3RyZWFtPWlvLlN0cmluZ0lPKCksIGZhaWxmYXN0PVRydWUpCiAgICAgICAgZGVmIHRlc3QocmVzdWx0KToKICAgICAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHJlc3VsdC5mYWlsZmFzdCkKICAgICAgICByZXN1bHQgPSBydW5uZXIucnVuKHRlc3QpCgoKY2xhc3NEaWN0ID0gZGljdCh1bml0dGVzdC5UZXN0UmVzdWx0Ll9fZGljdF9fKQpmb3IgbSBpbiAoJ2FkZFNraXAnLCAnYWRkRXhwZWN0ZWRGYWlsdXJlJywgJ2FkZFVuZXhwZWN0ZWRTdWNjZXNzJywKICAgICAgICAgICAnX19pbml0X18nKToKICAgIGRlbCBjbGFzc0RpY3RbbV0KCmRlZiBfX2luaXRfXyhzZWxmLCBzdHJlYW09Tm9uZSwgZGVzY3JpcHRpb25zPU5vbmUsIHZlcmJvc2l0eT1Ob25lKToKICAgIHNlbGYuZmFpbHVyZXMgPSBbXQogICAgc2VsZi5lcnJvcnMgPSBbXQogICAgc2VsZi50ZXN0c1J1biA9IDAKICAgIHNlbGYuc2hvdWxkU3RvcCA9IEZhbHNlCiAgICBzZWxmLmJ1ZmZlciA9IEZhbHNlCgpjbGFzc0RpY3RbJ19faW5pdF9fJ10gPSBfX2luaXRfXwpPbGRSZXN1bHQgPSB0eXBlKCdPbGRSZXN1bHQnLCAob2JqZWN0LCksIGNsYXNzRGljdCkKCmNsYXNzIFRlc3RfT2xkVGVzdFJlc3VsdCh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIGFzc2VydE9sZFJlc3VsdFdhcm5pbmcoc2VsZiwgdGVzdCwgZmFpbHVyZXMpOgogICAgICAgIHdpdGggc3VwcG9ydC5jaGVja193YXJuaW5ncygoIlRlc3RSZXN1bHQgaGFzIG5vIGFkZC4rIG1ldGhvZCwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUnVudGltZVdhcm5pbmcpKToKICAgICAgICAgICAgcmVzdWx0ID0gT2xkUmVzdWx0KCkKICAgICAgICAgICAgdGVzdC5ydW4ocmVzdWx0KQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZmFpbHVyZXMpLCBmYWlsdXJlcykKCiAgICBkZWYgdGVzdE9sZFRlc3RSZXN1bHQoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0U2tpcChzZWxmKToKICAgICAgICAgICAgICAgIHNlbGYuc2tpcFRlc3QoJ2Zvb2JhcicpCiAgICAgICAgICAgIEB1bml0dGVzdC5leHBlY3RlZEZhaWx1cmUKICAgICAgICAgICAgZGVmIHRlc3RFeHBlY3RlZEZhaWwoc2VsZik6CiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IKICAgICAgICAgICAgQHVuaXR0ZXN0LmV4cGVjdGVkRmFpbHVyZQogICAgICAgICAgICBkZWYgdGVzdFVuZXhwZWN0ZWRTdWNjZXNzKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBmb3IgdGVzdF9uYW1lLCBzaG91bGRfcGFzcyBpbiAoKCd0ZXN0U2tpcCcsIFRydWUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoJ3Rlc3RFeHBlY3RlZEZhaWwnLCBUcnVlKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCd0ZXN0VW5leHBlY3RlZFN1Y2Nlc3MnLCBGYWxzZSkpOgogICAgICAgICAgICB0ZXN0ID0gVGVzdCh0ZXN0X25hbWUpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0T2xkUmVzdWx0V2FybmluZyh0ZXN0LCBpbnQobm90IHNob3VsZF9wYXNzKSkKCiAgICBkZWYgdGVzdE9sZFRlc3RUZXN1bHRTZXR1cChzZWxmKToKICAgICAgICBjbGFzcyBUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHNldFVwKHNlbGYpOgogICAgICAgICAgICAgICAgc2VsZi5za2lwVGVzdCgnbm8gcmVhc29uJykKICAgICAgICAgICAgZGVmIHRlc3RGb28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgc2VsZi5hc3NlcnRPbGRSZXN1bHRXYXJuaW5nKFRlc3QoJ3Rlc3RGb28nKSwgMCkKCiAgICBkZWYgdGVzdE9sZFRlc3RSZXN1bHRDbGFzcyhzZWxmKToKICAgICAgICBAdW5pdHRlc3Quc2tpcCgnbm8gcmVhc29uJykKICAgICAgICBjbGFzcyBUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RGb28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgc2VsZi5hc3NlcnRPbGRSZXN1bHRXYXJuaW5nKFRlc3QoJ3Rlc3RGb28nKSwgMCkKCiAgICBkZWYgdGVzdE9sZFJlc3VsdFdpdGhSdW5uZXIoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0Rm9vKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIHJ1bm5lciA9IHVuaXR0ZXN0LlRleHRUZXN0UnVubmVyKHJlc3VsdGNsYXNzPU9sZFJlc3VsdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyZWFtPWlvLlN0cmluZ0lPKCkpCiAgICAgICAgIyBUaGlzIHdpbGwgcmFpc2UgYW4gZXhjZXB0aW9uIGlmIFRleHRUZXN0UnVubmVyIGNhbid0IGhhbmRsZSBvbGQKICAgICAgICAjIHRlc3QgcmVzdWx0IG9iamVjdHMKICAgICAgICBydW5uZXIucnVuKFRlc3QoJ3Rlc3RGb28nKSkKCgpjbGFzcyBNb2NrVHJhY2ViYWNrKG9iamVjdCk6CiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZm9ybWF0X2V4Y2VwdGlvbigqXyk6CiAgICAgICAgcmV0dXJuIFsnQSB0cmFjZWJhY2snXQoKZGVmIHJlc3RvcmVfdHJhY2ViYWNrKCk6CiAgICB1bml0dGVzdC5yZXN1bHQudHJhY2ViYWNrID0gdHJhY2ViYWNrCgoKY2xhc3MgVGVzdE91dHB1dEJ1ZmZlcmluZyh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIHNldFVwKHNlbGYpOgogICAgICAgIHNlbGYuX3JlYWxfb3V0ID0gc3lzLnN0ZG91dAogICAgICAgIHNlbGYuX3JlYWxfZXJyID0gc3lzLnN0ZGVycgoKICAgIGRlZiB0ZWFyRG93bihzZWxmKToKICAgICAgICBzeXMuc3Rkb3V0ID0gc2VsZi5fcmVhbF9vdXQKICAgICAgICBzeXMuc3RkZXJyID0gc2VsZi5fcmVhbF9lcnIKCiAgICBkZWYgdGVzdEJ1ZmZlck91dHB1dE9mZihzZWxmKToKICAgICAgICByZWFsX291dCA9IHNlbGYuX3JlYWxfb3V0CiAgICAgICAgcmVhbF9lcnIgPSBzZWxmLl9yZWFsX2VycgoKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKHJlc3VsdC5idWZmZXIpCgogICAgICAgIHNlbGYuYXNzZXJ0SXMocmVhbF9vdXQsIHN5cy5zdGRvdXQpCiAgICAgICAgc2VsZi5hc3NlcnRJcyhyZWFsX2Vyciwgc3lzLnN0ZGVycikKCiAgICAgICAgcmVzdWx0LnN0YXJ0VGVzdChzZWxmKQoKICAgICAgICBzZWxmLmFzc2VydElzKHJlYWxfb3V0LCBzeXMuc3Rkb3V0KQogICAgICAgIHNlbGYuYXNzZXJ0SXMocmVhbF9lcnIsIHN5cy5zdGRlcnIpCgogICAgZGVmIHRlc3RCdWZmZXJPdXRwdXRTdGFydFRlc3RBZGRTdWNjZXNzKHNlbGYpOgogICAgICAgIHJlYWxfb3V0ID0gc2VsZi5fcmVhbF9vdXQKICAgICAgICByZWFsX2VyciA9IHNlbGYuX3JlYWxfZXJyCgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UocmVzdWx0LmJ1ZmZlcikKCiAgICAgICAgcmVzdWx0LmJ1ZmZlciA9IFRydWUKCiAgICAgICAgc2VsZi5hc3NlcnRJcyhyZWFsX291dCwgc3lzLnN0ZG91dCkKICAgICAgICBzZWxmLmFzc2VydElzKHJlYWxfZXJyLCBzeXMuc3RkZXJyKQoKICAgICAgICByZXN1bHQuc3RhcnRUZXN0KHNlbGYpCgogICAgICAgIHNlbGYuYXNzZXJ0SXNOb3QocmVhbF9vdXQsIHN5cy5zdGRvdXQpCiAgICAgICAgc2VsZi5hc3NlcnRJc05vdChyZWFsX2Vyciwgc3lzLnN0ZGVycikKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc3lzLnN0ZG91dCwgaW8uU3RyaW5nSU8pCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHN5cy5zdGRlcnIsIGlvLlN0cmluZ0lPKQogICAgICAgIHNlbGYuYXNzZXJ0SXNOb3Qoc3lzLnN0ZG91dCwgc3lzLnN0ZGVycikKCiAgICAgICAgb3V0X3N0cmVhbSA9IHN5cy5zdGRvdXQKICAgICAgICBlcnJfc3RyZWFtID0gc3lzLnN0ZGVycgoKICAgICAgICByZXN1bHQuX29yaWdpbmFsX3N0ZG91dCA9IGlvLlN0cmluZ0lPKCkKICAgICAgICByZXN1bHQuX29yaWdpbmFsX3N0ZGVyciA9IGlvLlN0cmluZ0lPKCkKCiAgICAgICAgcHJpbnQoJ2ZvbycpCiAgICAgICAgcHJpbnQoJ2JhcicsIGZpbGU9c3lzLnN0ZGVycikKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChvdXRfc3RyZWFtLmdldHZhbHVlKCksICdmb29cbicpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChlcnJfc3RyZWFtLmdldHZhbHVlKCksICdiYXJcbicpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0Ll9vcmlnaW5hbF9zdGRvdXQuZ2V0dmFsdWUoKSwgJycpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQuX29yaWdpbmFsX3N0ZGVyci5nZXR2YWx1ZSgpLCAnJykKCiAgICAgICAgcmVzdWx0LmFkZFN1Y2Nlc3Moc2VsZikKICAgICAgICByZXN1bHQuc3RvcFRlc3Qoc2VsZikKCiAgICAgICAgc2VsZi5hc3NlcnRJcyhzeXMuc3Rkb3V0LCByZXN1bHQuX29yaWdpbmFsX3N0ZG91dCkKICAgICAgICBzZWxmLmFzc2VydElzKHN5cy5zdGRlcnIsIHJlc3VsdC5fb3JpZ2luYWxfc3RkZXJyKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC5fb3JpZ2luYWxfc3Rkb3V0LmdldHZhbHVlKCksICcnKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0Ll9vcmlnaW5hbF9zdGRlcnIuZ2V0dmFsdWUoKSwgJycpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwob3V0X3N0cmVhbS5nZXR2YWx1ZSgpLCAnJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGVycl9zdHJlYW0uZ2V0dmFsdWUoKSwgJycpCgoKICAgIGRlZiBnZXRTdGFydGVkUmVzdWx0KHNlbGYpOgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHJlc3VsdC5idWZmZXIgPSBUcnVlCiAgICAgICAgcmVzdWx0LnN0YXJ0VGVzdChzZWxmKQogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgdGVzdEJ1ZmZlck91dHB1dEFkZEVycm9yT3JGYWlsdXJlKHNlbGYpOgogICAgICAgIHVuaXR0ZXN0LnJlc3VsdC50cmFjZWJhY2sgPSBNb2NrVHJhY2ViYWNrCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHJlc3RvcmVfdHJhY2ViYWNrKQoKICAgICAgICBmb3IgbWVzc2FnZV9hdHRyLCBhZGRfYXR0ciwgaW5jbHVkZV9lcnJvciBpbiBbCiAgICAgICAgICAgICgnZXJyb3JzJywgJ2FkZEVycm9yJywgVHJ1ZSksCiAgICAgICAgICAgICgnZmFpbHVyZXMnLCAnYWRkRmFpbHVyZScsIEZhbHNlKSwKICAgICAgICAgICAgKCdlcnJvcnMnLCAnYWRkRXJyb3InLCBUcnVlKSwKICAgICAgICAgICAgKCdmYWlsdXJlcycsICdhZGRGYWlsdXJlJywgRmFsc2UpCiAgICAgICAgXToKICAgICAgICAgICAgcmVzdWx0ID0gc2VsZi5nZXRTdGFydGVkUmVzdWx0KCkKICAgICAgICAgICAgYnVmZmVyZWRfb3V0ID0gc3lzLnN0ZG91dAogICAgICAgICAgICBidWZmZXJlZF9lcnIgPSBzeXMuc3RkZXJyCiAgICAgICAgICAgIHJlc3VsdC5fb3JpZ2luYWxfc3Rkb3V0ID0gaW8uU3RyaW5nSU8oKQogICAgICAgICAgICByZXN1bHQuX29yaWdpbmFsX3N0ZGVyciA9IGlvLlN0cmluZ0lPKCkKCiAgICAgICAgICAgIHByaW50KCdmb28nLCBmaWxlPXN5cy5zdGRvdXQpCiAgICAgICAgICAgIGlmIGluY2x1ZGVfZXJyb3I6CiAgICAgICAgICAgICAgICBwcmludCgnYmFyJywgZmlsZT1zeXMuc3RkZXJyKQoKCiAgICAgICAgICAgIGFkZEZ1bmN0aW9uID0gZ2V0YXR0cihyZXN1bHQsIGFkZF9hdHRyKQogICAgICAgICAgICBhZGRGdW5jdGlvbihzZWxmLCAoTm9uZSwgTm9uZSwgTm9uZSkpCiAgICAgICAgICAgIHJlc3VsdC5zdG9wVGVzdChzZWxmKQoKICAgICAgICAgICAgcmVzdWx0X2xpc3QgPSBnZXRhdHRyKHJlc3VsdCwgbWVzc2FnZV9hdHRyKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHRfbGlzdCksIDEpCgogICAgICAgICAgICB0ZXN0LCBtZXNzYWdlID0gcmVzdWx0X2xpc3RbMF0KICAgICAgICAgICAgZXhwZWN0ZWRPdXRNZXNzYWdlID0gdGV4dHdyYXAuZGVkZW50KCIiIgogICAgICAgICAgICAgICAgU3Rkb3V0OgogICAgICAgICAgICAgICAgZm9vCiAgICAgICAgICAgICIiIikKICAgICAgICAgICAgZXhwZWN0ZWRFcnJNZXNzYWdlID0gJycKICAgICAgICAgICAgaWYgaW5jbHVkZV9lcnJvcjoKICAgICAgICAgICAgICAgIGV4cGVjdGVkRXJyTWVzc2FnZSA9IHRleHR3cmFwLmRlZGVudCgiIiIKICAgICAgICAgICAgICAgIFN0ZGVycjoKICAgICAgICAgICAgICAgIGJhcgogICAgICAgICAgICAiIiIpCgogICAgICAgICAgICBleHBlY3RlZEZ1bGxNZXNzYWdlID0gJ0EgdHJhY2ViYWNrJXMlcycgJSAoZXhwZWN0ZWRPdXRNZXNzYWdlLCBleHBlY3RlZEVyck1lc3NhZ2UpCgogICAgICAgICAgICBzZWxmLmFzc2VydElzKHRlc3QsIHNlbGYpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0Ll9vcmlnaW5hbF9zdGRvdXQuZ2V0dmFsdWUoKSwgZXhwZWN0ZWRPdXRNZXNzYWdlKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC5fb3JpZ2luYWxfc3RkZXJyLmdldHZhbHVlKCksIGV4cGVjdGVkRXJyTWVzc2FnZSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRNdWx0aUxpbmVFcXVhbChtZXNzYWdlLCBleHBlY3RlZEZ1bGxNZXNzYWdlKQoKICAgIGRlZiB0ZXN0QnVmZmVyU2V0dXBDbGFzcyhzZWxmKToKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICByZXN1bHQuYnVmZmVyID0gVHJ1ZQoKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHNldFVwQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIDEvMAogICAgICAgICAgICBkZWYgdGVzdF9mb28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoW0ZvbygndGVzdF9mb28nKV0pCiAgICAgICAgc3VpdGUocmVzdWx0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAxKQoKICAgIGRlZiB0ZXN0QnVmZmVyVGVhckRvd25DbGFzcyhzZWxmKToKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICByZXN1bHQuYnVmZmVyID0gVHJ1ZQoKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIDEvMAogICAgICAgICAgICBkZWYgdGVzdF9mb28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoW0ZvbygndGVzdF9mb28nKV0pCiAgICAgICAgc3VpdGUocmVzdWx0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAxKQoKICAgIGRlZiB0ZXN0QnVmZmVyU2V0VXBNb2R1bGUoc2VsZik6CiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgcmVzdWx0LmJ1ZmZlciA9IFRydWUKCiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfZm9vKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIGNsYXNzIE1vZHVsZShvYmplY3QpOgogICAgICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcE1vZHVsZSgpOgogICAgICAgICAgICAgICAgMS8wCgogICAgICAgIEZvby5fX21vZHVsZV9fID0gJ01vZHVsZScKICAgICAgICBzeXMubW9kdWxlc1snTW9kdWxlJ10gPSBNb2R1bGUKICAgICAgICBzZWxmLmFkZENsZWFudXAoc3lzLm1vZHVsZXMucG9wLCAnTW9kdWxlJykKICAgICAgICBzdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShbRm9vKCd0ZXN0X2ZvbycpXSkKICAgICAgICBzdWl0ZShyZXN1bHQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDEpCgogICAgZGVmIHRlc3RCdWZmZXJUZWFyRG93bk1vZHVsZShzZWxmKToKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICByZXN1bHQuYnVmZmVyID0gVHJ1ZQoKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF9mb28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgY2xhc3MgTW9kdWxlKG9iamVjdCk6CiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duTW9kdWxlKCk6CiAgICAgICAgICAgICAgICAxLzAKCiAgICAgICAgRm9vLl9fbW9kdWxlX18gPSAnTW9kdWxlJwogICAgICAgIHN5cy5tb2R1bGVzWydNb2R1bGUnXSA9IE1vZHVsZQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChzeXMubW9kdWxlcy5wb3AsICdNb2R1bGUnKQogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKFtGb28oJ3Rlc3RfZm9vJyldKQogICAgICAgIHN1aXRlKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZXJyb3JzKSwgMSkKCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgdW5pdHRlc3QubWFpbigpCg==',
'/Lib/unittest/test/test_runner.py':'aW1wb3J0IGlvCmltcG9ydCBvcwppbXBvcnQgc3lzCmltcG9ydCBwaWNrbGUKaW1wb3J0IHN1YnByb2Nlc3MKCmltcG9ydCB1bml0dGVzdAoKZnJvbSAuc3VwcG9ydCBpbXBvcnQgTG9nZ2luZ1Jlc3VsdCwgUmVzdWx0V2l0aE5vU3RhcnRUZXN0UnVuU3RvcFRlc3RSdW4KCgpjbGFzcyBUZXN0Q2xlYW5VcCh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIHRlc3RDbGVhblVwKHNlbGYpOgogICAgICAgIGNsYXNzIFRlc3RhYmxlVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0Tm90aGluZyhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgdGVzdCA9IFRlc3RhYmxlVGVzdCgndGVzdE5vdGhpbmcnKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwodGVzdC5fY2xlYW51cHMsIFtdKQoKICAgICAgICBjbGVhbnVwcyA9IFtdCgogICAgICAgIGRlZiBjbGVhbnVwMSgqYXJncywgKiprd2FyZ3MpOgogICAgICAgICAgICBjbGVhbnVwcy5hcHBlbmQoKDEsIGFyZ3MsIGt3YXJncykpCgogICAgICAgIGRlZiBjbGVhbnVwMigqYXJncywgKiprd2FyZ3MpOgogICAgICAgICAgICBjbGVhbnVwcy5hcHBlbmQoKDIsIGFyZ3MsIGt3YXJncykpCgogICAgICAgIHRlc3QuYWRkQ2xlYW51cChjbGVhbnVwMSwgMSwgMiwgMywgZm91cj0naGVsbG8nLCBmaXZlPSdnb29kYnllJykKICAgICAgICB0ZXN0LmFkZENsZWFudXAoY2xlYW51cDIpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwodGVzdC5fY2xlYW51cHMsCiAgICAgICAgICAgICAgICAgICAgICAgICBbKGNsZWFudXAxLCAoMSwgMiwgMyksIGRpY3QoZm91cj0naGVsbG8nLCBmaXZlPSdnb29kYnllJykpLAogICAgICAgICAgICAgICAgICAgICAgICAgIChjbGVhbnVwMiwgKCksIHt9KV0pCgogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZSh0ZXN0LmRvQ2xlYW51cHMoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNsZWFudXBzLCBbKDIsICgpLCB7fSksICgxLCAoMSwgMiwgMyksIGRpY3QoZm91cj0naGVsbG8nLCBmaXZlPSdnb29kYnllJykpXSkKCiAgICBkZWYgdGVzdENsZWFuVXBXaXRoRXJyb3JzKHNlbGYpOgogICAgICAgIGNsYXNzIFRlc3RhYmxlVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0Tm90aGluZyhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgY2xhc3MgTW9ja091dGNvbWUob2JqZWN0KToKICAgICAgICAgICAgc3VjY2VzcyA9IFRydWUKICAgICAgICAgICAgZXJyb3JzID0gW10KCiAgICAgICAgdGVzdCA9IFRlc3RhYmxlVGVzdCgndGVzdE5vdGhpbmcnKQogICAgICAgIHRlc3QuX291dGNvbWVGb3JEb0NsZWFudXBzID0gTW9ja091dGNvbWUKCiAgICAgICAgZXhjMSA9IEV4Y2VwdGlvbignZm9vJykKICAgICAgICBleGMyID0gRXhjZXB0aW9uKCdiYXInKQogICAgICAgIGRlZiBjbGVhbnVwMSgpOgogICAgICAgICAgICByYWlzZSBleGMxCgogICAgICAgIGRlZiBjbGVhbnVwMigpOgogICAgICAgICAgICByYWlzZSBleGMyCgogICAgICAgIHRlc3QuYWRkQ2xlYW51cChjbGVhbnVwMSkKICAgICAgICB0ZXN0LmFkZENsZWFudXAoY2xlYW51cDIpCgogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UodGVzdC5kb0NsZWFudXBzKCkpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShNb2NrT3V0Y29tZS5zdWNjZXNzKQoKICAgICAgICAoVHlwZTEsIGluc3RhbmNlMSwgXyksIChUeXBlMiwgaW5zdGFuY2UyLCBfKSA9IHJldmVyc2VkKE1vY2tPdXRjb21lLmVycm9ycykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKChUeXBlMSwgaW5zdGFuY2UxKSwgKEV4Y2VwdGlvbiwgZXhjMSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgoVHlwZTIsIGluc3RhbmNlMiksIChFeGNlcHRpb24sIGV4YzIpKQoKICAgIGRlZiB0ZXN0Q2xlYW51cEluUnVuKHNlbGYpOgogICAgICAgIGJsb3dVcCA9IEZhbHNlCiAgICAgICAgb3JkZXJpbmcgPSBbXQoKICAgICAgICBjbGFzcyBUZXN0YWJsZVRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgc2V0VXAoc2VsZik6CiAgICAgICAgICAgICAgICBvcmRlcmluZy5hcHBlbmQoJ3NldFVwJykKICAgICAgICAgICAgICAgIGlmIGJsb3dVcDoKICAgICAgICAgICAgICAgICAgICByYWlzZSBFeGNlcHRpb24oJ2ZvbycpCgogICAgICAgICAgICBkZWYgdGVzdE5vdGhpbmcoc2VsZik6CiAgICAgICAgICAgICAgICBvcmRlcmluZy5hcHBlbmQoJ3Rlc3QnKQoKICAgICAgICAgICAgZGVmIHRlYXJEb3duKHNlbGYpOgogICAgICAgICAgICAgICAgb3JkZXJpbmcuYXBwZW5kKCd0ZWFyRG93bicpCgogICAgICAgIHRlc3QgPSBUZXN0YWJsZVRlc3QoJ3Rlc3ROb3RoaW5nJykKCiAgICAgICAgZGVmIGNsZWFudXAxKCk6CiAgICAgICAgICAgIG9yZGVyaW5nLmFwcGVuZCgnY2xlYW51cDEnKQogICAgICAgIGRlZiBjbGVhbnVwMigpOgogICAgICAgICAgICBvcmRlcmluZy5hcHBlbmQoJ2NsZWFudXAyJykKICAgICAgICB0ZXN0LmFkZENsZWFudXAoY2xlYW51cDEpCiAgICAgICAgdGVzdC5hZGRDbGVhbnVwKGNsZWFudXAyKQoKICAgICAgICBkZWYgc3VjY2Vzcyhzb21lX3Rlc3QpOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNvbWVfdGVzdCwgdGVzdCkKICAgICAgICAgICAgb3JkZXJpbmcuYXBwZW5kKCdzdWNjZXNzJykKCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgcmVzdWx0LmFkZFN1Y2Nlc3MgPSBzdWNjZXNzCgogICAgICAgIHRlc3QucnVuKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG9yZGVyaW5nLCBbJ3NldFVwJywgJ3Rlc3QnLCAndGVhckRvd24nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2xlYW51cDInLCAnY2xlYW51cDEnLCAnc3VjY2VzcyddKQoKICAgICAgICBibG93VXAgPSBUcnVlCiAgICAgICAgb3JkZXJpbmcgPSBbXQogICAgICAgIHRlc3QgPSBUZXN0YWJsZVRlc3QoJ3Rlc3ROb3RoaW5nJykKICAgICAgICB0ZXN0LmFkZENsZWFudXAoY2xlYW51cDEpCiAgICAgICAgdGVzdC5ydW4ocmVzdWx0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwob3JkZXJpbmcsIFsnc2V0VXAnLCAnY2xlYW51cDEnXSkKCiAgICBkZWYgdGVzdFRlc3RDYXNlRGVidWdFeGVjdXRlc0NsZWFudXBzKHNlbGYpOgogICAgICAgIG9yZGVyaW5nID0gW10KCiAgICAgICAgY2xhc3MgVGVzdGFibGVUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHNldFVwKHNlbGYpOgogICAgICAgICAgICAgICAgb3JkZXJpbmcuYXBwZW5kKCdzZXRVcCcpCiAgICAgICAgICAgICAgICBzZWxmLmFkZENsZWFudXAoY2xlYW51cDEpCgogICAgICAgICAgICBkZWYgdGVzdE5vdGhpbmcoc2VsZik6CiAgICAgICAgICAgICAgICBvcmRlcmluZy5hcHBlbmQoJ3Rlc3QnKQoKICAgICAgICAgICAgZGVmIHRlYXJEb3duKHNlbGYpOgogICAgICAgICAgICAgICAgb3JkZXJpbmcuYXBwZW5kKCd0ZWFyRG93bicpCgogICAgICAgIHRlc3QgPSBUZXN0YWJsZVRlc3QoJ3Rlc3ROb3RoaW5nJykKCiAgICAgICAgZGVmIGNsZWFudXAxKCk6CiAgICAgICAgICAgIG9yZGVyaW5nLmFwcGVuZCgnY2xlYW51cDEnKQogICAgICAgICAgICB0ZXN0LmFkZENsZWFudXAoY2xlYW51cDIpCiAgICAgICAgZGVmIGNsZWFudXAyKCk6CiAgICAgICAgICAgIG9yZGVyaW5nLmFwcGVuZCgnY2xlYW51cDInKQoKICAgICAgICB0ZXN0LmRlYnVnKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG9yZGVyaW5nLCBbJ3NldFVwJywgJ3Rlc3QnLCAndGVhckRvd24nLCAnY2xlYW51cDEnLCAnY2xlYW51cDInXSkKCgpjbGFzcyBUZXN0X1RleHRUZXN0UnVubmVyKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICIiIlRlc3RzIGZvciBUZXh0VGVzdFJ1bm5lci4iIiIKCiAgICBkZWYgdGVzdF9pbml0KHNlbGYpOgogICAgICAgIHJ1bm5lciA9IHVuaXR0ZXN0LlRleHRUZXN0UnVubmVyKCkKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKHJ1bm5lci5mYWlsZmFzdCkKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKHJ1bm5lci5idWZmZXIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChydW5uZXIudmVyYm9zaXR5LCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocnVubmVyLndhcm5pbmdzLCBOb25lKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShydW5uZXIuZGVzY3JpcHRpb25zKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocnVubmVyLnJlc3VsdGNsYXNzLCB1bml0dGVzdC5UZXh0VGVzdFJlc3VsdCkKCgogICAgZGVmIHRlc3RCdWZmZXJBbmRGYWlsZmFzdChzZWxmKToKICAgICAgICBjbGFzcyBUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RGb28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgcnVubmVyID0gdW5pdHRlc3QuVGV4dFRlc3RSdW5uZXIoc3RyZWFtPWlvLlN0cmluZ0lPKCksIGZhaWxmYXN0PVRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWZmZXI9VHJ1ZSkKICAgICAgICAjIFVzZSBvdXIgcmVzdWx0IG9iamVjdAogICAgICAgIHJ1bm5lci5fbWFrZVJlc3VsdCA9IGxhbWJkYTogcmVzdWx0CiAgICAgICAgcnVubmVyLnJ1bihUZXN0KCd0ZXN0Rm9vJykpCgogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShyZXN1bHQuZmFpbGZhc3QpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHJlc3VsdC5idWZmZXIpCgogICAgZGVmIHRlc3RSdW5uZXJSZWdpc3RlcnNSZXN1bHQoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0Rm9vKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIG9yaWdpbmFsUmVnaXN0ZXJSZXN1bHQgPSB1bml0dGVzdC5ydW5uZXIucmVnaXN0ZXJSZXN1bHQKICAgICAgICBkZWYgY2xlYW51cCgpOgogICAgICAgICAgICB1bml0dGVzdC5ydW5uZXIucmVnaXN0ZXJSZXN1bHQgPSBvcmlnaW5hbFJlZ2lzdGVyUmVzdWx0CiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKGNsZWFudXApCgogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHJ1bm5lciA9IHVuaXR0ZXN0LlRleHRUZXN0UnVubmVyKHN0cmVhbT1pby5TdHJpbmdJTygpKQogICAgICAgICMgVXNlIG91ciByZXN1bHQgb2JqZWN0CiAgICAgICAgcnVubmVyLl9tYWtlUmVzdWx0ID0gbGFtYmRhOiByZXN1bHQKCiAgICAgICAgc2VsZi53YXNSZWdpc3RlcmVkID0gMAogICAgICAgIGRlZiBmYWtlUmVnaXN0ZXJSZXN1bHQodGhpc1Jlc3VsdCk6CiAgICAgICAgICAgIHNlbGYud2FzUmVnaXN0ZXJlZCArPSAxCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwodGhpc1Jlc3VsdCwgcmVzdWx0KQogICAgICAgIHVuaXR0ZXN0LnJ1bm5lci5yZWdpc3RlclJlc3VsdCA9IGZha2VSZWdpc3RlclJlc3VsdAoKICAgICAgICBydW5uZXIucnVuKHVuaXR0ZXN0LlRlc3RTdWl0ZSgpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc2VsZi53YXNSZWdpc3RlcmVkLCAxKQoKICAgIGRlZiB0ZXN0X3dvcmtzX3dpdGhfcmVzdWx0X3dpdGhvdXRfc3RhcnRUZXN0UnVuX3N0b3BUZXN0UnVuKHNlbGYpOgogICAgICAgIGNsYXNzIE9sZFRleHRSZXN1bHQoUmVzdWx0V2l0aE5vU3RhcnRUZXN0UnVuU3RvcFRlc3RSdW4pOgogICAgICAgICAgICBzZXBhcmF0b3IyID0gJycKICAgICAgICAgICAgZGVmIHByaW50RXJyb3JzKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBjbGFzcyBSdW5uZXIodW5pdHRlc3QuVGV4dFRlc3RSdW5uZXIpOgogICAgICAgICAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgICAgICAgICBzdXBlcihSdW5uZXIsIHNlbGYpLl9faW5pdF9fKGlvLlN0cmluZ0lPKCkpCgogICAgICAgICAgICBkZWYgX21ha2VSZXN1bHQoc2VsZik6CiAgICAgICAgICAgICAgICByZXR1cm4gT2xkVGV4dFJlc3VsdCgpCgogICAgICAgIHJ1bm5lciA9IFJ1bm5lcigpCiAgICAgICAgcnVubmVyLnJ1bih1bml0dGVzdC5UZXN0U3VpdGUoKSkKCiAgICBkZWYgdGVzdF9zdGFydFRlc3RSdW5fc3RvcFRlc3RSdW5fY2FsbGVkKHNlbGYpOgogICAgICAgIGNsYXNzIExvZ2dpbmdUZXh0UmVzdWx0KExvZ2dpbmdSZXN1bHQpOgogICAgICAgICAgICBzZXBhcmF0b3IyID0gJycKICAgICAgICAgICAgZGVmIHByaW50RXJyb3JzKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBjbGFzcyBMb2dnaW5nUnVubmVyKHVuaXR0ZXN0LlRleHRUZXN0UnVubmVyKToKICAgICAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIGV2ZW50cyk6CiAgICAgICAgICAgICAgICBzdXBlcihMb2dnaW5nUnVubmVyLCBzZWxmKS5fX2luaXRfXyhpby5TdHJpbmdJTygpKQogICAgICAgICAgICAgICAgc2VsZi5fZXZlbnRzID0gZXZlbnRzCgogICAgICAgICAgICBkZWYgX21ha2VSZXN1bHQoc2VsZik6CiAgICAgICAgICAgICAgICByZXR1cm4gTG9nZ2luZ1RleHRSZXN1bHQoc2VsZi5fZXZlbnRzKQoKICAgICAgICBldmVudHMgPSBbXQogICAgICAgIHJ1bm5lciA9IExvZ2dpbmdSdW5uZXIoZXZlbnRzKQogICAgICAgIHJ1bm5lci5ydW4odW5pdHRlc3QuVGVzdFN1aXRlKCkpCiAgICAgICAgZXhwZWN0ZWQgPSBbJ3N0YXJ0VGVzdFJ1bicsICdzdG9wVGVzdFJ1biddCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIGV4cGVjdGVkKQoKICAgIGRlZiB0ZXN0X3BpY2tsZV91bnBpY2tsZShzZWxmKToKICAgICAgICAjIElzc3VlICM3MTk3OiBhIFRleHRUZXN0UnVubmVyIHNob3VsZCBiZSAodW4pcGlja2xlYWJsZS4gVGhpcyBpcwogICAgICAgICMgcmVxdWlyZWQgYnkgdGVzdF9tdWx0aXByb2Nlc3NpbmcgdW5kZXIgV2luZG93cyAoaW4gdmVyYm9zZSBtb2RlKS4KICAgICAgICBzdHJlYW0gPSBpby5TdHJpbmdJTygiZm9vIikKICAgICAgICBydW5uZXIgPSB1bml0dGVzdC5UZXh0VGVzdFJ1bm5lcihzdHJlYW0pCiAgICAgICAgZm9yIHByb3RvY29sIGluIHJhbmdlKDIsIHBpY2tsZS5ISUdIRVNUX1BST1RPQ09MICsgMSk6CiAgICAgICAgICAgIHMgPSBwaWNrbGUuZHVtcHMocnVubmVyLCBwcm90b2NvbCkKICAgICAgICAgICAgb2JqID0gcGlja2xlLmxvYWRzKHMpCiAgICAgICAgICAgICMgU3RyaW5nSU8gb2JqZWN0cyBuZXZlciBjb21wYXJlIGVxdWFsLCBhIGNoZWFwIHRlc3QgaW5zdGVhZC4KICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChvYmouc3RyZWFtLmdldHZhbHVlKCksIHN0cmVhbS5nZXR2YWx1ZSgpKQoKICAgIGRlZiB0ZXN0X3Jlc3VsdGNsYXNzKHNlbGYpOgogICAgICAgIGRlZiBNb2NrUmVzdWx0Q2xhc3MoKmFyZ3MpOgogICAgICAgICAgICByZXR1cm4gYXJncwogICAgICAgIFNUUkVBTSA9IG9iamVjdCgpCiAgICAgICAgREVTQ1JJUFRJT05TID0gb2JqZWN0KCkKICAgICAgICBWRVJCT1NJVFkgPSBvYmplY3QoKQogICAgICAgIHJ1bm5lciA9IHVuaXR0ZXN0LlRleHRUZXN0UnVubmVyKFNUUkVBTSwgREVTQ1JJUFRJT05TLCBWRVJCT1NJVFksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Y2xhc3M9TW9ja1Jlc3VsdENsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocnVubmVyLnJlc3VsdGNsYXNzLCBNb2NrUmVzdWx0Q2xhc3MpCgogICAgICAgIGV4cGVjdGVkcmVzdWx0ID0gKHJ1bm5lci5zdHJlYW0sIERFU0NSSVBUSU9OUywgVkVSQk9TSVRZKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocnVubmVyLl9tYWtlUmVzdWx0KCksIGV4cGVjdGVkcmVzdWx0KQoKICAgIGRlZiB0ZXN0X3dhcm5pbmdzKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIENoZWNrIHRoYXQgd2FybmluZ3MgYXJndW1lbnQgb2YgVGV4dFRlc3RSdW5uZXIgY29ycmVjdGx5IGFmZmVjdHMgdGhlCiAgICAgICAgYmVoYXZpb3Igb2YgdGhlIHdhcm5pbmdzLgogICAgICAgICIiIgogICAgICAgICMgc2VlICMxMDUzNSBhbmQgdGhlIF90ZXN0X3dhcm5pbmdzIGZpbGUgZm9yIG1vcmUgaW5mb3JtYXRpb24KCiAgICAgICAgZGVmIGdldF9wYXJzZV9vdXRfZXJyKHApOgogICAgICAgICAgICByZXR1cm4gW2Iuc3BsaXRsaW5lcygpIGZvciBiIGluIHAuY29tbXVuaWNhdGUoKV0KICAgICAgICBvcHRzID0gZGljdChzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLCBzdGRlcnI9c3VicHJvY2Vzcy5QSVBFLAogICAgICAgICAgICAgICAgICAgIGN3ZD1vcy5wYXRoLmRpcm5hbWUoX19maWxlX18pKQogICAgICAgIGFlX21zZyA9IGInUGxlYXNlIHVzZSBhc3NlcnRFcXVhbCBpbnN0ZWFkLicKICAgICAgICBhdF9tc2cgPSBiJ1BsZWFzZSB1c2UgYXNzZXJ0VHJ1ZSBpbnN0ZWFkLicKCiAgICAgICAgIyBubyBhcmdzIC0+IGFsbCB0aGUgd2FybmluZ3MgYXJlIHByaW50ZWQsIHVuaXR0ZXN0IHdhcm5pbmdzIG9ubHkgb25jZQogICAgICAgIHAgPSBzdWJwcm9jZXNzLlBvcGVuKFtzeXMuZXhlY3V0YWJsZSwgJ190ZXN0X3dhcm5pbmdzLnB5J10sICoqb3B0cykKICAgICAgICBvdXQsIGVyciA9IGdldF9wYXJzZV9vdXRfZXJyKHApCiAgICAgICAgc2VsZi5hc3NlcnRJbihiJ09LJywgZXJyKQogICAgICAgICMgY2hlY2sgdGhhdCB0aGUgdG90YWwgbnVtYmVyIG9mIHdhcm5pbmdzIGluIHRoZSBvdXRwdXQgaXMgY29ycmVjdAogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKG91dCksIDEyKQogICAgICAgICMgY2hlY2sgdGhhdCB0aGUgbnVtYmVycyBvZiB0aGUgZGlmZmVyZW50IGtpbmQgb2Ygd2FybmluZ3MgaXMgY29ycmVjdAogICAgICAgIGZvciBtc2cgaW4gW2InZHcnLCBiJ2l3JywgYid1dyddOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG91dC5jb3VudChtc2cpLCAzKQogICAgICAgIGZvciBtc2cgaW4gW2FlX21zZywgYXRfbXNnLCBiJ3J3J106CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwob3V0LmNvdW50KG1zZyksIDEpCgogICAgICAgIGFyZ3NfbGlzdCA9ICgKICAgICAgICAgICAgIyBwYXNzaW5nICdpZ25vcmUnIGFzIHdhcm5pbmdzIGFyZyAtPiBubyB3YXJuaW5ncwogICAgICAgICAgICBbc3lzLmV4ZWN1dGFibGUsICdfdGVzdF93YXJuaW5ncy5weScsICdpZ25vcmUnXSwKICAgICAgICAgICAgIyAtVyBkb2Vzbid0IGFmZmVjdCB0aGUgcmVzdWx0IGlmIHRoZSBhcmcgaXMgcGFzc2VkCiAgICAgICAgICAgIFtzeXMuZXhlY3V0YWJsZSwgJy1XYScsICdfdGVzdF93YXJuaW5ncy5weScsICdpZ25vcmUnXSwKICAgICAgICAgICAgIyAtVyBhZmZlY3RzIHRoZSByZXN1bHQgaWYgdGhlIGFyZyBpcyBub3QgcGFzc2VkCiAgICAgICAgICAgIFtzeXMuZXhlY3V0YWJsZSwgJy1XaScsICdfdGVzdF93YXJuaW5ncy5weSddCiAgICAgICAgKQogICAgICAgICMgaW4gYWxsIHRoZXNlIGNhc2VzIG5vIHdhcm5pbmdzIGFyZSBwcmludGVkCiAgICAgICAgZm9yIGFyZ3MgaW4gYXJnc19saXN0OgogICAgICAgICAgICBwID0gc3VicHJvY2Vzcy5Qb3BlbihhcmdzLCAqKm9wdHMpCiAgICAgICAgICAgIG91dCwgZXJyID0gZ2V0X3BhcnNlX291dF9lcnIocCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbihiJ09LJywgZXJyKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihvdXQpLCAwKQoKCiAgICAgICAgIyBwYXNzaW5nICdhbHdheXMnIGFzIHdhcm5pbmdzIGFyZyAtPiBhbGwgdGhlIHdhcm5pbmdzIHByaW50ZWQsCiAgICAgICAgIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bml0dGVzdCB3YXJuaW5ncyBvbmx5IG9uY2UKICAgICAgICBwID0gc3VicHJvY2Vzcy5Qb3Blbihbc3lzLmV4ZWN1dGFibGUsICdfdGVzdF93YXJuaW5ncy5weScsICdhbHdheXMnXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKm9wdHMpCiAgICAgICAgb3V0LCBlcnIgPSBnZXRfcGFyc2Vfb3V0X2VycihwKQogICAgICAgIHNlbGYuYXNzZXJ0SW4oYidPSycsIGVycikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihvdXQpLCAxNCkKICAgICAgICBmb3IgbXNnIGluIFtiJ2R3JywgYidpdycsIGIndXcnLCBiJ3J3J106CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwob3V0LmNvdW50KG1zZyksIDMpCiAgICAgICAgZm9yIG1zZyBpbiBbYWVfbXNnLCBhdF9tc2ddOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG91dC5jb3VudChtc2cpLCAxKQoKICAgIGRlZiB0ZXN0U3RkRXJyTG9va2VkVXBBdEluc3RhbnRpYXRpb25UaW1lKHNlbGYpOgogICAgICAgICMgc2VlIGlzc3VlIDEwNzg2CiAgICAgICAgb2xkX3N0ZGVyciA9IHN5cy5zdGRlcnIKICAgICAgICBmID0gaW8uU3RyaW5nSU8oKQogICAgICAgIHN5cy5zdGRlcnIgPSBmCiAgICAgICAgdHJ5OgogICAgICAgICAgICBydW5uZXIgPSB1bml0dGVzdC5UZXh0VGVzdFJ1bm5lcigpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShydW5uZXIuc3RyZWFtLnN0cmVhbSBpcyBmKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHN5cy5zdGRlcnIgPSBvbGRfc3RkZXJyCgogICAgZGVmIHRlc3RTcGVjaWZpZWRTdHJlYW1Vc2VkKHNlbGYpOgogICAgICAgICMgc2VlIGlzc3VlIDEwNzg2CiAgICAgICAgZiA9IGlvLlN0cmluZ0lPKCkKICAgICAgICBydW5uZXIgPSB1bml0dGVzdC5UZXh0VGVzdFJ1bm5lcihmKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShydW5uZXIuc3RyZWFtLnN0cmVhbSBpcyBmKQo=',
'/Lib/unittest/test/test_setups.py':'aW1wb3J0IGlvCmltcG9ydCBzeXMKCmltcG9ydCB1bml0dGVzdAoKCmRlZiByZXN1bHRGYWN0b3J5KCpfKToKICAgIHJldHVybiB1bml0dGVzdC5UZXN0UmVzdWx0KCkKCgpjbGFzcyBUZXN0U2V0dXBzKHVuaXR0ZXN0LlRlc3RDYXNlKToKCiAgICBkZWYgZ2V0UnVubmVyKHNlbGYpOgogICAgICAgIHJldHVybiB1bml0dGVzdC5UZXh0VGVzdFJ1bm5lcihyZXN1bHRjbGFzcz1yZXN1bHRGYWN0b3J5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJlYW09aW8uU3RyaW5nSU8oKSkKICAgIGRlZiBydW5UZXN0cyhzZWxmLCAqY2FzZXMpOgogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKICAgICAgICBmb3IgY2FzZSBpbiBjYXNlczoKICAgICAgICAgICAgdGVzdHMgPSB1bml0dGVzdC5kZWZhdWx0VGVzdExvYWRlci5sb2FkVGVzdHNGcm9tVGVzdENhc2UoY2FzZSkKICAgICAgICAgICAgc3VpdGUuYWRkVGVzdHModGVzdHMpCgogICAgICAgIHJ1bm5lciA9IHNlbGYuZ2V0UnVubmVyKCkKCiAgICAgICAgIyBjcmVhdGluZyBhIG5lc3RlZCBzdWl0ZSBleHBvc2VzIHNvbWUgcG90ZW50aWFsIGJ1Z3MKICAgICAgICByZWFsU3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoKQogICAgICAgIHJlYWxTdWl0ZS5hZGRUZXN0KHN1aXRlKQogICAgICAgICMgYWRkaW5nIGVtcHR5IHN1aXRlcyB0byB0aGUgZW5kIGV4cG9zZXMgcG90ZW50aWFsIGJ1Z3MKICAgICAgICBzdWl0ZS5hZGRUZXN0KHVuaXR0ZXN0LlRlc3RTdWl0ZSgpKQogICAgICAgIHJlYWxTdWl0ZS5hZGRUZXN0KHVuaXR0ZXN0LlRlc3RTdWl0ZSgpKQogICAgICAgIHJldHVybiBydW5uZXIucnVuKHJlYWxTdWl0ZSkKCiAgICBkZWYgdGVzdF9zZXR1cF9jbGFzcyhzZWxmKToKICAgICAgICBjbGFzcyBUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgc2V0VXBDYWxsZWQgPSAwCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgc2V0VXBDbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgVGVzdC5zZXRVcENhbGxlZCArPSAxCiAgICAgICAgICAgICAgICB1bml0dGVzdC5UZXN0Q2FzZS5zZXRVcENsYXNzKCkKICAgICAgICAgICAgZGVmIHRlc3Rfb25lKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBkZWYgdGVzdF90d28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIHJlc3VsdCA9IHNlbGYucnVuVGVzdHMoVGVzdCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChUZXN0LnNldFVwQ2FsbGVkLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCAyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAwKQoKICAgIGRlZiB0ZXN0X3RlYXJkb3duX2NsYXNzKHNlbGYpOgogICAgICAgIGNsYXNzIFRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICB0ZWFyRG93bkNhbGxlZCA9IDAKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiB0ZWFyRG93bkNsYXNzKGNscyk6CiAgICAgICAgICAgICAgICBUZXN0LnRlYXJEb3duQ2FsbGVkICs9IDEKICAgICAgICAgICAgICAgIHVuaXR0ZXN0LlRlc3RDYXNlLnRlYXJEb3duQ2xhc3MoKQogICAgICAgICAgICBkZWYgdGVzdF9vbmUoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0X3R3byhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgcmVzdWx0ID0gc2VsZi5ydW5UZXN0cyhUZXN0KQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFRlc3QudGVhckRvd25DYWxsZWQsIDEpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDApCgogICAgZGVmIHRlc3RfdGVhcmRvd25fY2xhc3NfdHdvX2NsYXNzZXMoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHRlYXJEb3duQ2FsbGVkID0gMAogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIFRlc3QudGVhckRvd25DYWxsZWQgKz0gMQogICAgICAgICAgICAgICAgdW5pdHRlc3QuVGVzdENhc2UudGVhckRvd25DbGFzcygpCiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBjbGFzcyBUZXN0Mih1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHRlYXJEb3duQ2FsbGVkID0gMAogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIFRlc3QyLnRlYXJEb3duQ2FsbGVkICs9IDEKICAgICAgICAgICAgICAgIHVuaXR0ZXN0LlRlc3RDYXNlLnRlYXJEb3duQ2xhc3MoKQogICAgICAgICAgICBkZWYgdGVzdF9vbmUoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0X3R3byhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgcmVzdWx0ID0gc2VsZi5ydW5UZXN0cyhUZXN0LCBUZXN0MikKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChUZXN0LnRlYXJEb3duQ2FsbGVkLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoVGVzdDIudGVhckRvd25DYWxsZWQsIDEpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDApCgogICAgZGVmIHRlc3RfZXJyb3JfaW5fc2V0dXBjbGFzcyhzZWxmKToKICAgICAgICBjbGFzcyBCcm9rZW5UZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcENsYXNzKGNscyk6CiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ2ZvbycpCiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICByZXN1bHQgPSBzZWxmLnJ1blRlc3RzKEJyb2tlblRlc3QpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCAwKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAxKQogICAgICAgIGVycm9yLCBfID0gcmVzdWx0LmVycm9yc1swXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGVycm9yKSwKICAgICAgICAgICAgICAgICAgICAnc2V0VXBDbGFzcyAoJXMuQnJva2VuVGVzdCknICUgX19uYW1lX18pCgogICAgZGVmIHRlc3RfZXJyb3JfaW5fdGVhcmRvd25fY2xhc3Moc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHRvcm5Eb3duID0gMAogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIFRlc3QudG9ybkRvd24gKz0gMQogICAgICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCdmb28nKQogICAgICAgICAgICBkZWYgdGVzdF9vbmUoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0X3R3byhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgY2xhc3MgVGVzdDIodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICB0b3JuRG93biA9IDAKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiB0ZWFyRG93bkNsYXNzKGNscyk6CiAgICAgICAgICAgICAgICBUZXN0Mi50b3JuRG93biArPSAxCiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ2ZvbycpCiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICByZXN1bHQgPSBzZWxmLnJ1blRlc3RzKFRlc3QsIFRlc3QyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCA0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoVGVzdC50b3JuRG93biwgMSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFRlc3QyLnRvcm5Eb3duLCAxKQoKICAgICAgICBlcnJvciwgXyA9IHJlc3VsdC5lcnJvcnNbMF0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN0cihlcnJvciksCiAgICAgICAgICAgICAgICAgICAgJ3RlYXJEb3duQ2xhc3MgKCVzLlRlc3QpJyAlIF9fbmFtZV9fKQoKICAgIGRlZiB0ZXN0X2NsYXNzX25vdF90b3JuZG93bl93aGVuX3NldHVwX2ZhaWxzKHNlbGYpOgogICAgICAgIGNsYXNzIFRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICB0b3JuRG93biA9IEZhbHNlCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgc2V0VXBDbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25DbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgVGVzdC50b3JuRG93biA9IFRydWUKICAgICAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcignZm9vJykKICAgICAgICAgICAgZGVmIHRlc3Rfb25lKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBzZWxmLnJ1blRlc3RzKFRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShUZXN0LnRvcm5Eb3duKQoKICAgIGRlZiB0ZXN0X2NsYXNzX25vdF9zZXR1cF9vcl90b3JuZG93bl93aGVuX3NraXBwZWQoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGNsYXNzU2V0VXAgPSBGYWxzZQogICAgICAgICAgICB0b3JuRG93biA9IEZhbHNlCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgc2V0VXBDbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgVGVzdC5jbGFzc1NldFVwID0gVHJ1ZQogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIFRlc3QudG9ybkRvd24gPSBUcnVlCiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgVGVzdCA9IHVuaXR0ZXN0LnNraXAoImhvcCIpKFRlc3QpCiAgICAgICAgc2VsZi5ydW5UZXN0cyhUZXN0KQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoVGVzdC5jbGFzc1NldFVwKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoVGVzdC50b3JuRG93bikKCiAgICBkZWYgdGVzdF9zZXR1cF90ZWFyZG93bl9vcmRlcl93aXRoX3BhdGhvbG9naWNhbF9zdWl0ZShzZWxmKToKICAgICAgICByZXN1bHRzID0gW10KCiAgICAgICAgY2xhc3MgTW9kdWxlMShvYmplY3QpOgogICAgICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcE1vZHVsZSgpOgogICAgICAgICAgICAgICAgcmVzdWx0cy5hcHBlbmQoJ01vZHVsZTEuc2V0VXBNb2R1bGUnKQogICAgICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgICAgIGRlZiB0ZWFyRG93bk1vZHVsZSgpOgogICAgICAgICAgICAgICAgcmVzdWx0cy5hcHBlbmQoJ01vZHVsZTEudGVhckRvd25Nb2R1bGUnKQoKICAgICAgICBjbGFzcyBNb2R1bGUyKG9iamVjdCk6CiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHNldFVwTW9kdWxlKCk6CiAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgnTW9kdWxlMi5zZXRVcE1vZHVsZScpCiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duTW9kdWxlKCk6CiAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgnTW9kdWxlMi50ZWFyRG93bk1vZHVsZScpCgogICAgICAgIGNsYXNzIFRlc3QxKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcENsYXNzKGNscyk6CiAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgnc2V0dXAgMScpCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25DbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgcmVzdWx0cy5hcHBlbmQoJ3RlYXJkb3duIDEnKQogICAgICAgICAgICBkZWYgdGVzdE9uZShzZWxmKToKICAgICAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5kKCdUZXN0MS50ZXN0T25lJykKICAgICAgICAgICAgZGVmIHRlc3RUd28oc2VsZik6CiAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgnVGVzdDEudGVzdFR3bycpCgogICAgICAgIGNsYXNzIFRlc3QyKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcENsYXNzKGNscyk6CiAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgnc2V0dXAgMicpCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25DbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgcmVzdWx0cy5hcHBlbmQoJ3RlYXJkb3duIDInKQogICAgICAgICAgICBkZWYgdGVzdE9uZShzZWxmKToKICAgICAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5kKCdUZXN0Mi50ZXN0T25lJykKICAgICAgICAgICAgZGVmIHRlc3RUd28oc2VsZik6CiAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgnVGVzdDIudGVzdFR3bycpCgogICAgICAgIGNsYXNzIFRlc3QzKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcENsYXNzKGNscyk6CiAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgnc2V0dXAgMycpCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25DbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgcmVzdWx0cy5hcHBlbmQoJ3RlYXJkb3duIDMnKQogICAgICAgICAgICBkZWYgdGVzdE9uZShzZWxmKToKICAgICAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5kKCdUZXN0My50ZXN0T25lJykKICAgICAgICAgICAgZGVmIHRlc3RUd28oc2VsZik6CiAgICAgICAgICAgICAgICByZXN1bHRzLmFwcGVuZCgnVGVzdDMudGVzdFR3bycpCgogICAgICAgIFRlc3QxLl9fbW9kdWxlX18gPSBUZXN0Mi5fX21vZHVsZV9fID0gJ01vZHVsZScKICAgICAgICBUZXN0My5fX21vZHVsZV9fID0gJ01vZHVsZTInCiAgICAgICAgc3lzLm1vZHVsZXNbJ01vZHVsZSddID0gTW9kdWxlMQogICAgICAgIHN5cy5tb2R1bGVzWydNb2R1bGUyJ10gPSBNb2R1bGUyCgogICAgICAgIGZpcnN0ID0gdW5pdHRlc3QuVGVzdFN1aXRlKChUZXN0MSgndGVzdE9uZScpLCkpCiAgICAgICAgc2Vjb25kID0gdW5pdHRlc3QuVGVzdFN1aXRlKChUZXN0MSgndGVzdFR3bycpLCkpCiAgICAgICAgdGhpcmQgPSB1bml0dGVzdC5UZXN0U3VpdGUoKFRlc3QyKCd0ZXN0T25lJyksKSkKICAgICAgICBmb3VydGggPSB1bml0dGVzdC5UZXN0U3VpdGUoKFRlc3QyKCd0ZXN0VHdvJyksKSkKICAgICAgICBmaWZ0aCA9IHVuaXR0ZXN0LlRlc3RTdWl0ZSgoVGVzdDMoJ3Rlc3RPbmUnKSwpKQogICAgICAgIHNpeHRoID0gdW5pdHRlc3QuVGVzdFN1aXRlKChUZXN0MygndGVzdFR3bycpLCkpCiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoKGZpcnN0LCBzZWNvbmQsIHRoaXJkLCBmb3VydGgsIGZpZnRoLCBzaXh0aCkpCgogICAgICAgIHJ1bm5lciA9IHNlbGYuZ2V0UnVubmVyKCkKICAgICAgICByZXN1bHQgPSBydW5uZXIucnVuKHN1aXRlKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCA2KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAwKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdHMsCiAgICAgICAgICAgICAgICAgICAgICAgICBbJ01vZHVsZTEuc2V0VXBNb2R1bGUnLCAnc2V0dXAgMScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgJ1Rlc3QxLnRlc3RPbmUnLCAnVGVzdDEudGVzdFR3bycsICd0ZWFyZG93biAxJywKICAgICAgICAgICAgICAgICAgICAgICAgICAnc2V0dXAgMicsICdUZXN0Mi50ZXN0T25lJywgJ1Rlc3QyLnRlc3RUd28nLAogICAgICAgICAgICAgICAgICAgICAgICAgICd0ZWFyZG93biAyJywgJ01vZHVsZTEudGVhckRvd25Nb2R1bGUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICdNb2R1bGUyLnNldFVwTW9kdWxlJywgJ3NldHVwIDMnLAogICAgICAgICAgICAgICAgICAgICAgICAgICdUZXN0My50ZXN0T25lJywgJ1Rlc3QzLnRlc3RUd28nLAogICAgICAgICAgICAgICAgICAgICAgICAgICd0ZWFyZG93biAzJywgJ01vZHVsZTIudGVhckRvd25Nb2R1bGUnXSkKCiAgICBkZWYgdGVzdF9zZXR1cF9tb2R1bGUoc2VsZik6CiAgICAgICAgY2xhc3MgTW9kdWxlKG9iamVjdCk6CiAgICAgICAgICAgIG1vZHVsZVNldHVwID0gMAogICAgICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcE1vZHVsZSgpOgogICAgICAgICAgICAgICAgTW9kdWxlLm1vZHVsZVNldHVwICs9IDEKCiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIFRlc3QuX19tb2R1bGVfXyA9ICdNb2R1bGUnCiAgICAgICAgc3lzLm1vZHVsZXNbJ01vZHVsZSddID0gTW9kdWxlCgogICAgICAgIHJlc3VsdCA9IHNlbGYucnVuVGVzdHMoVGVzdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKE1vZHVsZS5tb2R1bGVTZXR1cCwgMSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC50ZXN0c1J1biwgMikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihyZXN1bHQuZXJyb3JzKSwgMCkKCiAgICBkZWYgdGVzdF9lcnJvcl9pbl9zZXR1cF9tb2R1bGUoc2VsZik6CiAgICAgICAgY2xhc3MgTW9kdWxlKG9iamVjdCk6CiAgICAgICAgICAgIG1vZHVsZVNldHVwID0gMAogICAgICAgICAgICBtb2R1bGVUb3JuRG93biA9IDAKICAgICAgICAgICAgQHN0YXRpY21ldGhvZAogICAgICAgICAgICBkZWYgc2V0VXBNb2R1bGUoKToKICAgICAgICAgICAgICAgIE1vZHVsZS5tb2R1bGVTZXR1cCArPSAxCiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ2ZvbycpCiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duTW9kdWxlKCk6CiAgICAgICAgICAgICAgICBNb2R1bGUubW9kdWxlVG9ybkRvd24gKz0gMQoKICAgICAgICBjbGFzcyBUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgY2xhc3NTZXRVcCA9IEZhbHNlCiAgICAgICAgICAgIGNsYXNzVG9ybkRvd24gPSBGYWxzZQogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHNldFVwQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIFRlc3QuY2xhc3NTZXRVcCA9IFRydWUKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiB0ZWFyRG93bkNsYXNzKGNscyk6CiAgICAgICAgICAgICAgICBUZXN0LmNsYXNzVG9ybkRvd24gPSBUcnVlCiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBjbGFzcyBUZXN0Mih1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIFRlc3QuX19tb2R1bGVfXyA9ICdNb2R1bGUnCiAgICAgICAgVGVzdDIuX19tb2R1bGVfXyA9ICdNb2R1bGUnCiAgICAgICAgc3lzLm1vZHVsZXNbJ01vZHVsZSddID0gTW9kdWxlCgogICAgICAgIHJlc3VsdCA9IHNlbGYucnVuVGVzdHMoVGVzdCwgVGVzdDIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChNb2R1bGUubW9kdWxlU2V0dXAsIDEpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChNb2R1bGUubW9kdWxlVG9ybkRvd24sIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDApCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShUZXN0LmNsYXNzU2V0VXApCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShUZXN0LmNsYXNzVG9ybkRvd24pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDEpCiAgICAgICAgZXJyb3IsIF8gPSByZXN1bHQuZXJyb3JzWzBdCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIoZXJyb3IpLCAnc2V0VXBNb2R1bGUgKE1vZHVsZSknKQoKICAgIGRlZiB0ZXN0X3Rlc3RjYXNlX3dpdGhfbWlzc2luZ19tb2R1bGUoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIFRlc3QuX19tb2R1bGVfXyA9ICdNb2R1bGUnCiAgICAgICAgc3lzLm1vZHVsZXMucG9wKCdNb2R1bGUnLCBOb25lKQoKICAgICAgICByZXN1bHQgPSBzZWxmLnJ1blRlc3RzKFRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDIpCgogICAgZGVmIHRlc3RfdGVhcmRvd25fbW9kdWxlKHNlbGYpOgogICAgICAgIGNsYXNzIE1vZHVsZShvYmplY3QpOgogICAgICAgICAgICBtb2R1bGVUb3JuRG93biA9IDAKICAgICAgICAgICAgQHN0YXRpY21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25Nb2R1bGUoKToKICAgICAgICAgICAgICAgIE1vZHVsZS5tb2R1bGVUb3JuRG93biArPSAxCgogICAgICAgIGNsYXNzIFRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF9vbmUoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0X3R3byhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICBUZXN0Ll9fbW9kdWxlX18gPSAnTW9kdWxlJwogICAgICAgIHN5cy5tb2R1bGVzWydNb2R1bGUnXSA9IE1vZHVsZQoKICAgICAgICByZXN1bHQgPSBzZWxmLnJ1blRlc3RzKFRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChNb2R1bGUubW9kdWxlVG9ybkRvd24sIDEpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDApCgogICAgZGVmIHRlc3RfZXJyb3JfaW5fdGVhcmRvd25fbW9kdWxlKHNlbGYpOgogICAgICAgIGNsYXNzIE1vZHVsZShvYmplY3QpOgogICAgICAgICAgICBtb2R1bGVUb3JuRG93biA9IDAKICAgICAgICAgICAgQHN0YXRpY21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25Nb2R1bGUoKToKICAgICAgICAgICAgICAgIE1vZHVsZS5tb2R1bGVUb3JuRG93biArPSAxCiAgICAgICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ2ZvbycpCgogICAgICAgIGNsYXNzIFRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBjbGFzc1NldFVwID0gRmFsc2UKICAgICAgICAgICAgY2xhc3NUb3JuRG93biA9IEZhbHNlCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgc2V0VXBDbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgVGVzdC5jbGFzc1NldFVwID0gVHJ1ZQogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIFRlc3QuY2xhc3NUb3JuRG93biA9IFRydWUKICAgICAgICAgICAgZGVmIHRlc3Rfb25lKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBkZWYgdGVzdF90d28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIGNsYXNzIFRlc3QyKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Rfb25lKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBkZWYgdGVzdF90d28oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgVGVzdC5fX21vZHVsZV9fID0gJ01vZHVsZScKICAgICAgICBUZXN0Mi5fX21vZHVsZV9fID0gJ01vZHVsZScKICAgICAgICBzeXMubW9kdWxlc1snTW9kdWxlJ10gPSBNb2R1bGUKCiAgICAgICAgcmVzdWx0ID0gc2VsZi5ydW5UZXN0cyhUZXN0LCBUZXN0MikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKE1vZHVsZS5tb2R1bGVUb3JuRG93biwgMSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC50ZXN0c1J1biwgNCkKICAgICAgICBzZWxmLmFzc2VydFRydWUoVGVzdC5jbGFzc1NldFVwKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShUZXN0LmNsYXNzVG9ybkRvd24pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDEpCiAgICAgICAgZXJyb3IsIF8gPSByZXN1bHQuZXJyb3JzWzBdCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIoZXJyb3IpLCAndGVhckRvd25Nb2R1bGUgKE1vZHVsZSknKQoKICAgIGRlZiB0ZXN0X3NraXB0ZXN0X2luX3NldHVwY2xhc3Moc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgc2V0VXBDbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgcmFpc2UgdW5pdHRlc3QuU2tpcFRlc3QoJ2ZvbycpCiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICByZXN1bHQgPSBzZWxmLnJ1blRlc3RzKFRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LnNraXBwZWQpLCAxKQogICAgICAgIHNraXBwZWQgPSByZXN1bHQuc2tpcHBlZFswXVswXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKHNraXBwZWQpLCAnc2V0VXBDbGFzcyAoJXMuVGVzdCknICUgX19uYW1lX18pCgogICAgZGVmIHRlc3Rfc2tpcHRlc3RfaW5fc2V0dXBtb2R1bGUoc2VsZik6CiAgICAgICAgY2xhc3MgVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBjbGFzcyBNb2R1bGUob2JqZWN0KToKICAgICAgICAgICAgQHN0YXRpY21ldGhvZAogICAgICAgICAgICBkZWYgc2V0VXBNb2R1bGUoKToKICAgICAgICAgICAgICAgIHJhaXNlIHVuaXR0ZXN0LlNraXBUZXN0KCdmb28nKQoKICAgICAgICBUZXN0Ll9fbW9kdWxlX18gPSAnTW9kdWxlJwogICAgICAgIHN5cy5tb2R1bGVzWydNb2R1bGUnXSA9IE1vZHVsZQoKICAgICAgICByZXN1bHQgPSBzZWxmLnJ1blRlc3RzKFRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LmVycm9ycyksIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocmVzdWx0LnNraXBwZWQpLCAxKQogICAgICAgIHNraXBwZWQgPSByZXN1bHQuc2tpcHBlZFswXVswXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKHNraXBwZWQpLCAnc2V0VXBNb2R1bGUgKE1vZHVsZSknKQoKICAgIGRlZiB0ZXN0X3N1aXRlX2RlYnVnX2V4ZWN1dGVzX3NldHVwc19hbmRfdGVhcmRvd25zKHNlbGYpOgogICAgICAgIG9yZGVyaW5nID0gW10KCiAgICAgICAgY2xhc3MgTW9kdWxlKG9iamVjdCk6CiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHNldFVwTW9kdWxlKCk6CiAgICAgICAgICAgICAgICBvcmRlcmluZy5hcHBlbmQoJ3NldFVwTW9kdWxlJykKICAgICAgICAgICAgQHN0YXRpY21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25Nb2R1bGUoKToKICAgICAgICAgICAgICAgIG9yZGVyaW5nLmFwcGVuZCgndGVhckRvd25Nb2R1bGUnKQoKICAgICAgICBjbGFzcyBUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcENsYXNzKGNscyk6CiAgICAgICAgICAgICAgICBvcmRlcmluZy5hcHBlbmQoJ3NldFVwQ2xhc3MnKQogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIG9yZGVyaW5nLmFwcGVuZCgndGVhckRvd25DbGFzcycpCiAgICAgICAgICAgIGRlZiB0ZXN0X3NvbWV0aGluZyhzZWxmKToKICAgICAgICAgICAgICAgIG9yZGVyaW5nLmFwcGVuZCgndGVzdF9zb21ldGhpbmcnKQoKICAgICAgICBUZXN0Ll9fbW9kdWxlX18gPSAnTW9kdWxlJwogICAgICAgIHN5cy5tb2R1bGVzWydNb2R1bGUnXSA9IE1vZHVsZQoKICAgICAgICBzdWl0ZSA9IHVuaXR0ZXN0LmRlZmF1bHRUZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb21UZXN0Q2FzZShUZXN0KQogICAgICAgIHN1aXRlLmRlYnVnKCkKICAgICAgICBleHBlY3RlZE9yZGVyID0gWydzZXRVcE1vZHVsZScsICdzZXRVcENsYXNzJywgJ3Rlc3Rfc29tZXRoaW5nJywgJ3RlYXJEb3duQ2xhc3MnLCAndGVhckRvd25Nb2R1bGUnXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwob3JkZXJpbmcsIGV4cGVjdGVkT3JkZXIpCgogICAgZGVmIHRlc3Rfc3VpdGVfZGVidWdfcHJvcGFnYXRlc19leGNlcHRpb25zKHNlbGYpOgogICAgICAgIGNsYXNzIE1vZHVsZShvYmplY3QpOgogICAgICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcE1vZHVsZSgpOgogICAgICAgICAgICAgICAgaWYgcGhhc2UgPT0gMDoKICAgICAgICAgICAgICAgICAgICByYWlzZSBFeGNlcHRpb24oJ3NldFVwTW9kdWxlJykKICAgICAgICAgICAgQHN0YXRpY21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25Nb2R1bGUoKToKICAgICAgICAgICAgICAgIGlmIHBoYXNlID09IDE6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCd0ZWFyRG93bk1vZHVsZScpCgogICAgICAgIGNsYXNzIFRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIHNldFVwQ2xhc3MoY2xzKToKICAgICAgICAgICAgICAgIGlmIHBoYXNlID09IDI6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCdzZXRVcENsYXNzJykKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiB0ZWFyRG93bkNsYXNzKGNscyk6CiAgICAgICAgICAgICAgICBpZiBwaGFzZSA9PSAzOgogICAgICAgICAgICAgICAgICAgIHJhaXNlIEV4Y2VwdGlvbigndGVhckRvd25DbGFzcycpCiAgICAgICAgICAgIGRlZiB0ZXN0X3NvbWV0aGluZyhzZWxmKToKICAgICAgICAgICAgICAgIGlmIHBoYXNlID09IDQ6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCd0ZXN0X3NvbWV0aGluZycpCgogICAgICAgIFRlc3QuX19tb2R1bGVfXyA9ICdNb2R1bGUnCiAgICAgICAgc3lzLm1vZHVsZXNbJ01vZHVsZSddID0gTW9kdWxlCgogICAgICAgIF9zdWl0ZSA9IHVuaXR0ZXN0LmRlZmF1bHRUZXN0TG9hZGVyLmxvYWRUZXN0c0Zyb21UZXN0Q2FzZShUZXN0KQogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKICAgICAgICBzdWl0ZS5hZGRUZXN0KF9zdWl0ZSkKCiAgICAgICAgbWVzc2FnZXMgPSAoJ3NldFVwTW9kdWxlJywgJ3RlYXJEb3duTW9kdWxlJywgJ3NldFVwQ2xhc3MnLCAndGVhckRvd25DbGFzcycsICd0ZXN0X3NvbWV0aGluZycpCiAgICAgICAgZm9yIHBoYXNlLCBtc2cgaW4gZW51bWVyYXRlKG1lc3NhZ2VzKToKICAgICAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlc1JlZ2V4KEV4Y2VwdGlvbiwgbXNnKToKICAgICAgICAgICAgICAgIHN1aXRlLmRlYnVnKCkKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICB1bml0dGVzdC5tYWluKCkK',
'/Lib/unittest/test/test_skipping.py':'aW1wb3J0IHVuaXR0ZXN0Cgpmcm9tIC5zdXBwb3J0IGltcG9ydCBMb2dnaW5nUmVzdWx0CgoKY2xhc3MgVGVzdF9UZXN0U2tpcHBpbmcodW5pdHRlc3QuVGVzdENhc2UpOgoKICAgIGRlZiB0ZXN0X3NraXBwaW5nKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0X3NraXBfbWUoc2VsZik6CiAgICAgICAgICAgICAgICBzZWxmLnNraXBUZXN0KCJza2lwIikKICAgICAgICBldmVudHMgPSBbXQogICAgICAgIHJlc3VsdCA9IExvZ2dpbmdSZXN1bHQoZXZlbnRzKQogICAgICAgIHRlc3QgPSBGb28oInRlc3Rfc2tpcF9tZSIpCiAgICAgICAgdGVzdC5ydW4ocmVzdWx0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZXZlbnRzLCBbJ3N0YXJ0VGVzdCcsICdhZGRTa2lwJywgJ3N0b3BUZXN0J10pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQuc2tpcHBlZCwgWyh0ZXN0LCAic2tpcCIpXSkKCiAgICAgICAgIyBUcnkgbGV0dGluZyBzZXRVcCBza2lwIHRoZSB0ZXN0IG5vdy4KICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgc2V0VXAoc2VsZik6CiAgICAgICAgICAgICAgICBzZWxmLnNraXBUZXN0KCJ0ZXN0aW5nIikKICAgICAgICAgICAgZGVmIHRlc3Rfbm90aGluZyhzZWxmKTogcGFzcwogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCiAgICAgICAgdGVzdCA9IEZvbygidGVzdF9ub3RoaW5nIikKICAgICAgICB0ZXN0LnJ1bihyZXN1bHQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIFsnc3RhcnRUZXN0JywgJ2FkZFNraXAnLCAnc3RvcFRlc3QnXSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC5za2lwcGVkLCBbKHRlc3QsICJ0ZXN0aW5nIildKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnRlc3RzUnVuLCAxKQoKICAgIGRlZiB0ZXN0X3NraXBwaW5nX2RlY29yYXRvcnMoc2VsZik6CiAgICAgICAgb3BfdGFibGUgPSAoKHVuaXR0ZXN0LnNraXBVbmxlc3MsIEZhbHNlLCBUcnVlKSwKICAgICAgICAgICAgICAgICAgICAodW5pdHRlc3Quc2tpcElmLCBUcnVlLCBGYWxzZSkpCiAgICAgICAgZm9yIGRlY28sIGRvX3NraXAsIGRvbnRfc2tpcCBpbiBvcF90YWJsZToKICAgICAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgICAgIEBkZWNvKGRvX3NraXAsICJ0ZXN0aW5nIikKICAgICAgICAgICAgICAgIGRlZiB0ZXN0X3NraXAoc2VsZik6IHBhc3MKCiAgICAgICAgICAgICAgICBAZGVjbyhkb250X3NraXAsICJ0ZXN0aW5nIikKICAgICAgICAgICAgICAgIGRlZiB0ZXN0X2RvbnRfc2tpcChzZWxmKTogcGFzcwogICAgICAgICAgICB0ZXN0X2RvX3NraXAgPSBGb28oInRlc3Rfc2tpcCIpCiAgICAgICAgICAgIHRlc3RfZG9udF9za2lwID0gRm9vKCJ0ZXN0X2RvbnRfc2tpcCIpCiAgICAgICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKFt0ZXN0X2RvX3NraXAsIHRlc3RfZG9udF9za2lwXSkKICAgICAgICAgICAgZXZlbnRzID0gW10KICAgICAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCiAgICAgICAgICAgIHN1aXRlLnJ1bihyZXN1bHQpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5za2lwcGVkKSwgMSkKICAgICAgICAgICAgZXhwZWN0ZWQgPSBbJ3N0YXJ0VGVzdCcsICdhZGRTa2lwJywgJ3N0b3BUZXN0JywKICAgICAgICAgICAgICAgICAgICAgICAgJ3N0YXJ0VGVzdCcsICdhZGRTdWNjZXNzJywgJ3N0b3BUZXN0J10KICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIGV4cGVjdGVkKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC50ZXN0c1J1biwgMikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQuc2tpcHBlZCwgWyh0ZXN0X2RvX3NraXAsICJ0ZXN0aW5nIildKQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUocmVzdWx0Lndhc1N1Y2Nlc3NmdWwoKSkKCiAgICBkZWYgdGVzdF9za2lwX2NsYXNzKHNlbGYpOgogICAgICAgIEB1bml0dGVzdC5za2lwKCJ0ZXN0aW5nIikKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOgogICAgICAgICAgICAgICAgcmVjb3JkLmFwcGVuZCgxKQogICAgICAgIHJlY29yZCA9IFtdCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgdGVzdCA9IEZvbygidGVzdF8xIikKICAgICAgICBzdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShbdGVzdF0pCiAgICAgICAgc3VpdGUucnVuKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC5za2lwcGVkLCBbKHRlc3QsICJ0ZXN0aW5nIildKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVjb3JkLCBbXSkKCiAgICBkZWYgdGVzdF9za2lwX25vbl91bml0dGVzdF9jbGFzcyhzZWxmKToKICAgICAgICBAdW5pdHRlc3Quc2tpcCgidGVzdGluZyIpCiAgICAgICAgY2xhc3MgTWl4aW46CiAgICAgICAgICAgIGRlZiB0ZXN0XzEoc2VsZik6CiAgICAgICAgICAgICAgICByZWNvcmQuYXBwZW5kKDEpCiAgICAgICAgY2xhc3MgRm9vKE1peGluLCB1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIHBhc3MKICAgICAgICByZWNvcmQgPSBbXQogICAgICAgIHJlc3VsdCA9IHVuaXR0ZXN0LlRlc3RSZXN1bHQoKQogICAgICAgIHRlc3QgPSBGb28oInRlc3RfMSIpCiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoW3Rlc3RdKQogICAgICAgIHN1aXRlLnJ1bihyZXN1bHQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQuc2tpcHBlZCwgWyh0ZXN0LCAidGVzdGluZyIpXSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlY29yZCwgW10pCgogICAgZGVmIHRlc3RfZXhwZWN0ZWRfZmFpbHVyZShzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBAdW5pdHRlc3QuZXhwZWN0ZWRGYWlsdXJlCiAgICAgICAgICAgIGRlZiB0ZXN0X2RpZShzZWxmKToKICAgICAgICAgICAgICAgIHNlbGYuZmFpbCgiaGVscCBtZSEiKQogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCiAgICAgICAgdGVzdCA9IEZvbygidGVzdF9kaWUiKQogICAgICAgIHRlc3QucnVuKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywKICAgICAgICAgICAgICAgICAgICAgICAgIFsnc3RhcnRUZXN0JywgJ2FkZEV4cGVjdGVkRmFpbHVyZScsICdzdG9wVGVzdCddKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LmV4cGVjdGVkRmFpbHVyZXNbMF1bMF0sIHRlc3QpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHJlc3VsdC53YXNTdWNjZXNzZnVsKCkpCgogICAgZGVmIHRlc3RfdW5leHBlY3RlZF9zdWNjZXNzKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIEB1bml0dGVzdC5leHBlY3RlZEZhaWx1cmUKICAgICAgICAgICAgZGVmIHRlc3RfZGllKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCiAgICAgICAgdGVzdCA9IEZvbygidGVzdF9kaWUiKQogICAgICAgIHRlc3QucnVuKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV2ZW50cywKICAgICAgICAgICAgICAgICAgICAgICAgIFsnc3RhcnRUZXN0JywgJ2FkZFVuZXhwZWN0ZWRTdWNjZXNzJywgJ3N0b3BUZXN0J10pCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShyZXN1bHQuZmFpbHVyZXMpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudW5leHBlY3RlZFN1Y2Nlc3NlcywgW3Rlc3RdKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShyZXN1bHQud2FzU3VjY2Vzc2Z1bCgpKQoKICAgIGRlZiB0ZXN0X3NraXBfZG9lc250X3J1bl9zZXR1cChzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICB3YXNTZXRVcCA9IEZhbHNlCiAgICAgICAgICAgIHdhc1Rvcm5Eb3duID0gRmFsc2UKICAgICAgICAgICAgZGVmIHNldFVwKHNlbGYpOgogICAgICAgICAgICAgICAgRm9vLndhc1NldFVwID0gVHJ1ZQogICAgICAgICAgICBkZWYgdG9ybkRvd24oc2VsZik6CiAgICAgICAgICAgICAgICBGb28ud2FzVG9ybkRvd24gPSBUcnVlCiAgICAgICAgICAgIEB1bml0dGVzdC5za2lwKCd0ZXN0aW5nJykKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgdGVzdCA9IEZvbygidGVzdF8xIikKICAgICAgICBzdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShbdGVzdF0pCiAgICAgICAgc3VpdGUucnVuKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC5za2lwcGVkLCBbKHRlc3QsICJ0ZXN0aW5nIildKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoRm9vLndhc1NldFVwKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoRm9vLndhc1Rvcm5Eb3duKQoKICAgIGRlZiB0ZXN0X2RlY29yYXRlZF9za2lwKHNlbGYpOgogICAgICAgIGRlZiBkZWNvcmF0b3IoZnVuYyk6CiAgICAgICAgICAgIGRlZiBpbm5lcigqYSk6CiAgICAgICAgICAgICAgICByZXR1cm4gZnVuYygqYSkKICAgICAgICAgICAgcmV0dXJuIGlubmVyCgogICAgICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIEBkZWNvcmF0b3IKICAgICAgICAgICAgQHVuaXR0ZXN0LnNraXAoJ3Rlc3RpbmcnKQogICAgICAgICAgICBkZWYgdGVzdF8xKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICB0ZXN0ID0gRm9vKCJ0ZXN0XzEiKQogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKFt0ZXN0XSkKICAgICAgICBzdWl0ZS5ydW4ocmVzdWx0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LnNraXBwZWQsIFsodGVzdCwgInRlc3RpbmciKV0pCg==',
'/Lib/unittest/test/test_suite.py':'aW1wb3J0IHVuaXR0ZXN0CgppbXBvcnQgc3lzCmZyb20gLnN1cHBvcnQgaW1wb3J0IExvZ2dpbmdSZXN1bHQsIFRlc3RFcXVhbGl0eQoKCiMjIyBTdXBwb3J0IGNvZGUgZm9yIFRlc3RfVGVzdFN1aXRlCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmNsYXNzIFRlc3Qob2JqZWN0KToKICAgIGNsYXNzIEZvbyh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgIGRlZiB0ZXN0XzIoc2VsZik6IHBhc3MKICAgICAgICBkZWYgdGVzdF8zKHNlbGYpOiBwYXNzCiAgICAgICAgZGVmIHJ1blRlc3Qoc2VsZik6IHBhc3MKCmRlZiBfbWtfVGVzdFN1aXRlKCpuYW1lcyk6CiAgICByZXR1cm4gdW5pdHRlc3QuVGVzdFN1aXRlKFRlc3QuRm9vKG4pIGZvciBuIGluIG5hbWVzKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKCmNsYXNzIFRlc3RfVGVzdFN1aXRlKHVuaXR0ZXN0LlRlc3RDYXNlLCBUZXN0RXF1YWxpdHkpOgoKICAgICMjIyBTZXQgdXAgYXR0cmlidXRlcyBuZWVkZWQgYnkgaW5oZXJpdGVkIHRlc3RzCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgogICAgIyBVc2VkIGJ5IFRlc3RFcXVhbGl0eS50ZXN0X2VxCiAgICBlcV9wYWlycyA9IFsodW5pdHRlc3QuVGVzdFN1aXRlKCksIHVuaXR0ZXN0LlRlc3RTdWl0ZSgpKQogICAgICAgICAgICAgICAsKHVuaXR0ZXN0LlRlc3RTdWl0ZSgpLCB1bml0dGVzdC5UZXN0U3VpdGUoW10pKQogICAgICAgICAgICAgICAsKF9ta19UZXN0U3VpdGUoJ3Rlc3RfMScpLCBfbWtfVGVzdFN1aXRlKCd0ZXN0XzEnKSldCgogICAgIyBVc2VkIGJ5IFRlc3RFcXVhbGl0eS50ZXN0X25lCiAgICBuZV9wYWlycyA9IFsodW5pdHRlc3QuVGVzdFN1aXRlKCksIF9ta19UZXN0U3VpdGUoJ3Rlc3RfMScpKQogICAgICAgICAgICAgICAsKHVuaXR0ZXN0LlRlc3RTdWl0ZShbXSksIF9ta19UZXN0U3VpdGUoJ3Rlc3RfMScpKQogICAgICAgICAgICAgICAsKF9ta19UZXN0U3VpdGUoJ3Rlc3RfMScsICd0ZXN0XzInKSwgX21rX1Rlc3RTdWl0ZSgndGVzdF8xJywgJ3Rlc3RfMycpKQogICAgICAgICAgICAgICAsKF9ta19UZXN0U3VpdGUoJ3Rlc3RfMScpLCBfbWtfVGVzdFN1aXRlKCd0ZXN0XzInKSldCgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgIyMjIC9TZXQgdXAgYXR0cmlidXRlcyBuZWVkZWQgYnkgaW5oZXJpdGVkIHRlc3RzCgogICAgIyMjIFRlc3RzIGZvciBUZXN0U3VpdGUuX19pbml0X18KICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAjICJjbGFzcyBUZXN0U3VpdGUoW3Rlc3RzXSkiCiAgICAjCiAgICAjIFRoZSB0ZXN0cyBpdGVyYWJsZSBzaG91bGQgYmUgb3B0aW9uYWwKICAgIGRlZiB0ZXN0X2luaXRfX3Rlc3RzX29wdGlvbmFsKHNlbGYpOgogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdWl0ZS5jb3VudFRlc3RDYXNlcygpLCAwKQoKICAgICMgImNsYXNzIFRlc3RTdWl0ZShbdGVzdHNdKSIKICAgICMgLi4uCiAgICAjICJJZiB0ZXN0cyBpcyBnaXZlbiwgaXQgbXVzdCBiZSBhbiBpdGVyYWJsZSBvZiBpbmRpdmlkdWFsIHRlc3QgY2FzZXMKICAgICMgb3Igb3RoZXIgdGVzdCBzdWl0ZXMgdGhhdCB3aWxsIGJlIHVzZWQgdG8gYnVpbGQgdGhlIHN1aXRlIGluaXRpYWxseSIKICAgICMKICAgICMgVGVzdFN1aXRlIHNob3VsZCBkZWFsIHdpdGggZW1wdHkgdGVzdHMgaXRlcmFibGVzIGJ5IGFsbG93aW5nIHRoZQogICAgIyBjcmVhdGlvbiBvZiBhbiBlbXB0eSBzdWl0ZQogICAgZGVmIHRlc3RfaW5pdF9fZW1wdHlfdGVzdHMoc2VsZik6CiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoW10pCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3VpdGUuY291bnRUZXN0Q2FzZXMoKSwgMCkKCiAgICAjICJjbGFzcyBUZXN0U3VpdGUoW3Rlc3RzXSkiCiAgICAjIC4uLgogICAgIyAiSWYgdGVzdHMgaXMgZ2l2ZW4sIGl0IG11c3QgYmUgYW4gaXRlcmFibGUgb2YgaW5kaXZpZHVhbCB0ZXN0IGNhc2VzCiAgICAjIG9yIG90aGVyIHRlc3Qgc3VpdGVzIHRoYXQgd2lsbCBiZSB1c2VkIHRvIGJ1aWxkIHRoZSBzdWl0ZSBpbml0aWFsbHkiCiAgICAjCiAgICAjIFRlc3RTdWl0ZSBzaG91bGQgYWxsb3cgYW55IGl0ZXJhYmxlIHRvIHByb3ZpZGUgdGVzdHMKICAgIGRlZiB0ZXN0X2luaXRfX3Rlc3RzX2Zyb21fYW55X2l0ZXJhYmxlKHNlbGYpOgogICAgICAgIGRlZiB0ZXN0cygpOgogICAgICAgICAgICB5aWVsZCB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKICAgICAgICAgICAgeWllbGQgdW5pdHRlc3QuRnVuY3Rpb25UZXN0Q2FzZShsYW1iZGE6IE5vbmUpCgogICAgICAgIHN1aXRlXzEgPSB1bml0dGVzdC5UZXN0U3VpdGUodGVzdHMoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN1aXRlXzEuY291bnRUZXN0Q2FzZXMoKSwgMikKCiAgICAgICAgc3VpdGVfMiA9IHVuaXR0ZXN0LlRlc3RTdWl0ZShzdWl0ZV8xKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3VpdGVfMi5jb3VudFRlc3RDYXNlcygpLCAyKQoKICAgICAgICBzdWl0ZV8zID0gdW5pdHRlc3QuVGVzdFN1aXRlKHNldChzdWl0ZV8xKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN1aXRlXzMuY291bnRUZXN0Q2FzZXMoKSwgMikKCiAgICAjICJjbGFzcyBUZXN0U3VpdGUoW3Rlc3RzXSkiCiAgICAjIC4uLgogICAgIyAiSWYgdGVzdHMgaXMgZ2l2ZW4sIGl0IG11c3QgYmUgYW4gaXRlcmFibGUgb2YgaW5kaXZpZHVhbCB0ZXN0IGNhc2VzCiAgICAjIG9yIG90aGVyIHRlc3Qgc3VpdGVzIHRoYXQgd2lsbCBiZSB1c2VkIHRvIGJ1aWxkIHRoZSBzdWl0ZSBpbml0aWFsbHkiCiAgICAjCiAgICAjIERvZXMgVGVzdFN1aXRlKCkgYWxzbyBhbGxvdyBvdGhlciBUZXN0U3VpdGUoKSBpbnN0YW5jZXMgdG8gYmUgcHJlc2VudAogICAgIyBpbiB0aGUgdGVzdHMgaXRlcmFibGU/CiAgICBkZWYgdGVzdF9pbml0X19UZXN0U3VpdGVfaW5zdGFuY2VzX2luX3Rlc3RzKHNlbGYpOgogICAgICAgIGRlZiB0ZXN0cygpOgogICAgICAgICAgICBmdGMgPSB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKICAgICAgICAgICAgeWllbGQgdW5pdHRlc3QuVGVzdFN1aXRlKFtmdGNdKQogICAgICAgICAgICB5aWVsZCB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKCiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUodGVzdHMoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN1aXRlLmNvdW50VGVzdENhc2VzKCksIDIpCgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgIyMjIC9UZXN0cyBmb3IgVGVzdFN1aXRlLl9faW5pdF9fCgogICAgIyBDb250YWluZXIgdHlwZXMgc2hvdWxkIHN1cHBvcnQgdGhlIGl0ZXIgcHJvdG9jb2wKICAgIGRlZiB0ZXN0X2l0ZXIoc2VsZik6CiAgICAgICAgdGVzdDEgPSB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKICAgICAgICB0ZXN0MiA9IHVuaXR0ZXN0LkZ1bmN0aW9uVGVzdENhc2UobGFtYmRhOiBOb25lKQogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCh0ZXN0MSwgdGVzdDIpKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3Qoc3VpdGUpLCBbdGVzdDEsIHRlc3QyXSkKCiAgICAjICJSZXR1cm4gdGhlIG51bWJlciBvZiB0ZXN0cyByZXByZXNlbnRlZCBieSB0aGUgdGhpcyB0ZXN0IG9iamVjdC4KICAgICMgLi4udGhpcyBtZXRob2QgaXMgYWxzbyBpbXBsZW1lbnRlZCBieSB0aGUgVGVzdFN1aXRlIGNsYXNzLCB3aGljaCBjYW4KICAgICMgcmV0dXJuIGxhcmdlciBbZ3JlYXRlciB0aGFuIDFdIHZhbHVlcyIKICAgICMKICAgICMgUHJlc3VtYWJseSBhbiBlbXB0eSBUZXN0U3VpdGUgcmV0dXJucyAwPwogICAgZGVmIHRlc3RfY291bnRUZXN0Q2FzZXNfemVyb19zaW1wbGUoc2VsZik6CiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN1aXRlLmNvdW50VGVzdENhc2VzKCksIDApCgogICAgIyAiUmV0dXJuIHRoZSBudW1iZXIgb2YgdGVzdHMgcmVwcmVzZW50ZWQgYnkgdGhlIHRoaXMgdGVzdCBvYmplY3QuCiAgICAjIC4uLnRoaXMgbWV0aG9kIGlzIGFsc28gaW1wbGVtZW50ZWQgYnkgdGhlIFRlc3RTdWl0ZSBjbGFzcywgd2hpY2ggY2FuCiAgICAjIHJldHVybiBsYXJnZXIgW2dyZWF0ZXIgdGhhbiAxXSB2YWx1ZXMiCiAgICAjCiAgICAjIFByZXN1bWFibHkgYW4gZW1wdHkgVGVzdFN1aXRlIChldmVuIGlmIGl0IGNvbnRhaW5zIG90aGVyIGVtcHR5CiAgICAjIFRlc3RTdWl0ZSBpbnN0YW5jZXMpIHJldHVybnMgMD8KICAgIGRlZiB0ZXN0X2NvdW50VGVzdENhc2VzX3plcm9fbmVzdGVkKHNlbGYpOgogICAgICAgIGNsYXNzIFRlc3QxKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3Qoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKFt1bml0dGVzdC5UZXN0U3VpdGUoKV0pCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3VpdGUuY291bnRUZXN0Q2FzZXMoKSwgMCkKCiAgICAjICJSZXR1cm4gdGhlIG51bWJlciBvZiB0ZXN0cyByZXByZXNlbnRlZCBieSB0aGUgdGhpcyB0ZXN0IG9iamVjdC4KICAgICMgLi4udGhpcyBtZXRob2QgaXMgYWxzbyBpbXBsZW1lbnRlZCBieSB0aGUgVGVzdFN1aXRlIGNsYXNzLCB3aGljaCBjYW4KICAgICMgcmV0dXJuIGxhcmdlciBbZ3JlYXRlciB0aGFuIDFdIHZhbHVlcyIKICAgIGRlZiB0ZXN0X2NvdW50VGVzdENhc2VzX3NpbXBsZShzZWxmKToKICAgICAgICB0ZXN0MSA9IHVuaXR0ZXN0LkZ1bmN0aW9uVGVzdENhc2UobGFtYmRhOiBOb25lKQogICAgICAgIHRlc3QyID0gdW5pdHRlc3QuRnVuY3Rpb25UZXN0Q2FzZShsYW1iZGE6IE5vbmUpCiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoKHRlc3QxLCB0ZXN0MikpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3VpdGUuY291bnRUZXN0Q2FzZXMoKSwgMikKCiAgICAjICJSZXR1cm4gdGhlIG51bWJlciBvZiB0ZXN0cyByZXByZXNlbnRlZCBieSB0aGUgdGhpcyB0ZXN0IG9iamVjdC4KICAgICMgLi4udGhpcyBtZXRob2QgaXMgYWxzbyBpbXBsZW1lbnRlZCBieSB0aGUgVGVzdFN1aXRlIGNsYXNzLCB3aGljaCBjYW4KICAgICMgcmV0dXJuIGxhcmdlciBbZ3JlYXRlciB0aGFuIDFdIHZhbHVlcyIKICAgICMKICAgICMgTWFrZSBzdXJlIHRoaXMgaG9sZHMgZm9yIG5lc3RlZCBUZXN0U3VpdGUgaW5zdGFuY2VzLCB0b28KICAgIGRlZiB0ZXN0X2NvdW50VGVzdENhc2VzX25lc3RlZChzZWxmKToKICAgICAgICBjbGFzcyBUZXN0MSh1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICAgICAgICAgIGRlZiB0ZXN0MShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdDIoc2VsZik6IHBhc3MKCiAgICAgICAgdGVzdDIgPSB1bml0dGVzdC5GdW5jdGlvblRlc3RDYXNlKGxhbWJkYTogTm9uZSkKICAgICAgICB0ZXN0MyA9IHVuaXR0ZXN0LkZ1bmN0aW9uVGVzdENhc2UobGFtYmRhOiBOb25lKQogICAgICAgIGNoaWxkID0gdW5pdHRlc3QuVGVzdFN1aXRlKChUZXN0MSgndGVzdDInKSwgdGVzdDIpKQogICAgICAgIHBhcmVudCA9IHVuaXR0ZXN0LlRlc3RTdWl0ZSgodGVzdDMsIGNoaWxkLCBUZXN0MSgndGVzdDEnKSkpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocGFyZW50LmNvdW50VGVzdENhc2VzKCksIDQpCgogICAgIyAiUnVuIHRoZSB0ZXN0cyBhc3NvY2lhdGVkIHdpdGggdGhpcyBzdWl0ZSwgY29sbGVjdGluZyB0aGUgcmVzdWx0IGludG8KICAgICMgdGhlIHRlc3QgcmVzdWx0IG9iamVjdCBwYXNzZWQgYXMgcmVzdWx0LiIKICAgICMKICAgICMgQW5kIGlmIHRoZXJlIGFyZSBubyB0ZXN0cz8gV2hhdCB0aGVuPwogICAgZGVmIHRlc3RfcnVuX19lbXB0eV9zdWl0ZShzZWxmKToKICAgICAgICBldmVudHMgPSBbXQogICAgICAgIHJlc3VsdCA9IExvZ2dpbmdSZXN1bHQoZXZlbnRzKQoKICAgICAgICBzdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZSgpCgogICAgICAgIHN1aXRlLnJ1bihyZXN1bHQpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZXZlbnRzLCBbXSkKCiAgICAjICJOb3RlIHRoYXQgdW5saWtlIFRlc3RDYXNlLnJ1bigpLCBUZXN0U3VpdGUucnVuKCkgcmVxdWlyZXMgdGhlCiAgICAjICJyZXN1bHQgb2JqZWN0IHRvIGJlIHBhc3NlZCBpbi4iCiAgICBkZWYgdGVzdF9ydW5fX3JlcXVpcmVzX3Jlc3VsdChzZWxmKToKICAgICAgICBzdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZSgpCgogICAgICAgIHRyeToKICAgICAgICAgICAgc3VpdGUucnVuKCkKICAgICAgICBleGNlcHQgVHlwZUVycm9yOgogICAgICAgICAgICBwYXNzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCJGYWlsZWQgdG8gcmFpc2UgVHlwZUVycm9yIikKCiAgICAjICJSdW4gdGhlIHRlc3RzIGFzc29jaWF0ZWQgd2l0aCB0aGlzIHN1aXRlLCBjb2xsZWN0aW5nIHRoZSByZXN1bHQgaW50bwogICAgIyB0aGUgdGVzdCByZXN1bHQgb2JqZWN0IHBhc3NlZCBhcyByZXN1bHQuIgogICAgZGVmIHRlc3RfcnVuKHNlbGYpOgogICAgICAgIGV2ZW50cyA9IFtdCiAgICAgICAgcmVzdWx0ID0gTG9nZ2luZ1Jlc3VsdChldmVudHMpCgogICAgICAgIGNsYXNzIExvZ2dpbmdDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHJ1bihzZWxmLCByZXN1bHQpOgogICAgICAgICAgICAgICAgZXZlbnRzLmFwcGVuZCgncnVuICVzJyAlIHNlbGYuX3Rlc3RNZXRob2ROYW1lKQoKICAgICAgICAgICAgZGVmIHRlc3QxKHNlbGYpOiBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0MihzZWxmKTogcGFzcwoKICAgICAgICB0ZXN0cyA9IFtMb2dnaW5nQ2FzZSgndGVzdDEnKSwgTG9nZ2luZ0Nhc2UoJ3Rlc3QyJyldCgogICAgICAgIHVuaXR0ZXN0LlRlc3RTdWl0ZSh0ZXN0cykucnVuKHJlc3VsdCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChldmVudHMsIFsncnVuIHRlc3QxJywgJ3J1biB0ZXN0MiddKQoKICAgICMgIkFkZCBhIFRlc3RDYXNlIC4uLiB0byB0aGUgc3VpdGUiCiAgICBkZWYgdGVzdF9hZGRUZXN0X19UZXN0Q2FzZShzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKTogcGFzcwoKICAgICAgICB0ZXN0ID0gRm9vKCd0ZXN0JykKICAgICAgICBzdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZSgpCgogICAgICAgIHN1aXRlLmFkZFRlc3QodGVzdCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdWl0ZS5jb3VudFRlc3RDYXNlcygpLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChzdWl0ZSksIFt0ZXN0XSkKCiAgICAjICJBZGQgYSAuLi4gVGVzdFN1aXRlIHRvIHRoZSBzdWl0ZSIKICAgIGRlZiB0ZXN0X2FkZFRlc3RfX1Rlc3RTdWl0ZShzZWxmKToKICAgICAgICBjbGFzcyBGb28odW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICBkZWYgdGVzdChzZWxmKTogcGFzcwoKICAgICAgICBzdWl0ZV8yID0gdW5pdHRlc3QuVGVzdFN1aXRlKFtGb28oJ3Rlc3QnKV0pCgogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKICAgICAgICBzdWl0ZS5hZGRUZXN0KHN1aXRlXzIpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3VpdGUuY291bnRUZXN0Q2FzZXMoKSwgMSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3Qoc3VpdGUpLCBbc3VpdGVfMl0pCgogICAgIyAiQWRkIGFsbCB0aGUgdGVzdHMgZnJvbSBhbiBpdGVyYWJsZSBvZiBUZXN0Q2FzZSBhbmQgVGVzdFN1aXRlCiAgICAjIGluc3RhbmNlcyB0byB0aGlzIHRlc3Qgc3VpdGUuIgogICAgIwogICAgIyAiVGhpcyBpcyBlcXVpdmFsZW50IHRvIGl0ZXJhdGluZyBvdmVyIHRlc3RzLCBjYWxsaW5nIGFkZFRlc3QoKSBmb3IKICAgICMgZWFjaCBlbGVtZW50IgogICAgZGVmIHRlc3RfYWRkVGVzdHMoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICAgICAgICAgZGVmIHRlc3RfMShzZWxmKTogcGFzcwogICAgICAgICAgICBkZWYgdGVzdF8yKHNlbGYpOiBwYXNzCgogICAgICAgIHRlc3RfMSA9IEZvbygndGVzdF8xJykKICAgICAgICB0ZXN0XzIgPSBGb28oJ3Rlc3RfMicpCiAgICAgICAgaW5uZXJfc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoW3Rlc3RfMl0pCgogICAgICAgIGRlZiBnZW4oKToKICAgICAgICAgICAgeWllbGQgdGVzdF8xCiAgICAgICAgICAgIHlpZWxkIHRlc3RfMgogICAgICAgICAgICB5aWVsZCBpbm5lcl9zdWl0ZQoKICAgICAgICBzdWl0ZV8xID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKICAgICAgICBzdWl0ZV8xLmFkZFRlc3RzKGdlbigpKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3Qoc3VpdGVfMSksIGxpc3QoZ2VuKCkpKQoKICAgICAgICAjICJUaGlzIGlzIGVxdWl2YWxlbnQgdG8gaXRlcmF0aW5nIG92ZXIgdGVzdHMsIGNhbGxpbmcgYWRkVGVzdCgpIGZvcgogICAgICAgICMgZWFjaCBlbGVtZW50IgogICAgICAgIHN1aXRlXzIgPSB1bml0dGVzdC5UZXN0U3VpdGUoKQogICAgICAgIGZvciB0IGluIGdlbigpOgogICAgICAgICAgICBzdWl0ZV8yLmFkZFRlc3QodCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdWl0ZV8xLCBzdWl0ZV8yKQoKICAgICMgIkFkZCBhbGwgdGhlIHRlc3RzIGZyb20gYW4gaXRlcmFibGUgb2YgVGVzdENhc2UgYW5kIFRlc3RTdWl0ZQogICAgIyBpbnN0YW5jZXMgdG8gdGhpcyB0ZXN0IHN1aXRlLiIKICAgICMKICAgICMgV2hhdCBoYXBwZW5zIGlmIGl0IGRvZXNuJ3QgZ2V0IGFuIGl0ZXJhYmxlPwogICAgZGVmIHRlc3RfYWRkVGVzdF9fbm9uaXRlcmFibGUoc2VsZik6CiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHN1aXRlLmFkZFRlc3RzKDUpCiAgICAgICAgZXhjZXB0IFR5cGVFcnJvcjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgiRmFpbGVkIHRvIHJhaXNlIFR5cGVFcnJvciIpCgogICAgZGVmIHRlc3RfYWRkVGVzdF9fbm9uY2FsbGFibGUoc2VsZik6CiAgICAgICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgc3VpdGUuYWRkVGVzdCwgNSkKCiAgICBkZWYgdGVzdF9hZGRUZXN0X19jYXNlc3VpdGVjbGFzcyhzZWxmKToKICAgICAgICBzdWl0ZSA9IHVuaXR0ZXN0LlRlc3RTdWl0ZSgpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBzdWl0ZS5hZGRUZXN0LCBUZXN0X1Rlc3RTdWl0ZSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIHN1aXRlLmFkZFRlc3QsIHVuaXR0ZXN0LlRlc3RTdWl0ZSkKCiAgICBkZWYgdGVzdF9hZGRUZXN0c19fc3RyaW5nKHNlbGYpOgogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIHN1aXRlLmFkZFRlc3RzLCAiZm9vIikKCiAgICBkZWYgdGVzdF9mdW5jdGlvbl9pbl9zdWl0ZShzZWxmKToKICAgICAgICBkZWYgZihfKToKICAgICAgICAgICAgcGFzcwogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKICAgICAgICBzdWl0ZS5hZGRUZXN0KGYpCgogICAgICAgICMgd2hlbiB0aGUgYnVnIGlzIGZpeGVkIHRoaXMgbGluZSB3aWxsIG5vdCBjcmFzaAogICAgICAgIHN1aXRlLnJ1bih1bml0dGVzdC5UZXN0UmVzdWx0KCkpCgoKCiAgICBkZWYgdGVzdF9iYXNldGVzdHN1aXRlKHNlbGYpOgogICAgICAgIGNsYXNzIFRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgogICAgICAgICAgICB3YXNTZXRVcCA9IEZhbHNlCiAgICAgICAgICAgIHdhc1Rvcm5Eb3duID0gRmFsc2UKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiBzZXRVcENsYXNzKGNscyk6CiAgICAgICAgICAgICAgICBjbHMud2FzU2V0VXAgPSBUcnVlCiAgICAgICAgICAgIEBjbGFzc21ldGhvZAogICAgICAgICAgICBkZWYgdGVhckRvd25DbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgY2xzLndhc1Rvcm5Eb3duID0gVHJ1ZQogICAgICAgICAgICBkZWYgdGVzdFBhc3Moc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGRlZiB0ZXN0RmFpbChzZWxmKToKICAgICAgICAgICAgICAgIGZhaWwKICAgICAgICBjbGFzcyBNb2R1bGUob2JqZWN0KToKICAgICAgICAgICAgd2FzU2V0VXAgPSBGYWxzZQogICAgICAgICAgICB3YXNUb3JuRG93biA9IEZhbHNlCiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHNldFVwTW9kdWxlKCk6CiAgICAgICAgICAgICAgICBNb2R1bGUud2FzU2V0VXAgPSBUcnVlCiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHRlYXJEb3duTW9kdWxlKCk6CiAgICAgICAgICAgICAgICBNb2R1bGUud2FzVG9ybkRvd24gPSBUcnVlCgogICAgICAgIFRlc3QuX19tb2R1bGVfXyA9ICdNb2R1bGUnCiAgICAgICAgc3lzLm1vZHVsZXNbJ01vZHVsZSddID0gTW9kdWxlCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHN5cy5tb2R1bGVzLnBvcCwgJ01vZHVsZScpCgogICAgICAgIHN1aXRlID0gdW5pdHRlc3QuQmFzZVRlc3RTdWl0ZSgpCiAgICAgICAgc3VpdGUuYWRkVGVzdHMoW1Rlc3QoJ3Rlc3RQYXNzJyksIFRlc3QoJ3Rlc3RGYWlsJyldKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3VpdGUuY291bnRUZXN0Q2FzZXMoKSwgMikKCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGVzdFJlc3VsdCgpCiAgICAgICAgc3VpdGUucnVuKHJlc3VsdCkKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKE1vZHVsZS53YXNTZXRVcCkKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKE1vZHVsZS53YXNUb3JuRG93bikKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKFRlc3Qud2FzU2V0VXApCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShUZXN0Lndhc1Rvcm5Eb3duKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5lcnJvcnMpLCAxKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHJlc3VsdC5mYWlsdXJlcyksIDApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXN1bHQudGVzdHNSdW4sIDIpCgoKICAgIGRlZiB0ZXN0X292ZXJyaWRpbmdfY2FsbChzZWxmKToKICAgICAgICBjbGFzcyBNeVN1aXRlKHVuaXR0ZXN0LlRlc3RTdWl0ZSk6CiAgICAgICAgICAgIGNhbGxlZCA9IEZhbHNlCiAgICAgICAgICAgIGRlZiBfX2NhbGxfXyhzZWxmLCAqYXJncywgKiprdyk6CiAgICAgICAgICAgICAgICBzZWxmLmNhbGxlZCA9IFRydWUKICAgICAgICAgICAgICAgIHVuaXR0ZXN0LlRlc3RTdWl0ZS5fX2NhbGxfXyhzZWxmLCAqYXJncywgKiprdykKCiAgICAgICAgc3VpdGUgPSBNeVN1aXRlKCkKICAgICAgICByZXN1bHQgPSB1bml0dGVzdC5UZXN0UmVzdWx0KCkKICAgICAgICB3cmFwcGVyID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKICAgICAgICB3cmFwcGVyLmFkZFRlc3Qoc3VpdGUpCiAgICAgICAgd3JhcHBlcihyZXN1bHQpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHN1aXRlLmNhbGxlZCkKCiAgICAgICAgIyByZXVzaW5nIHJlc3VsdHMgc2hvdWxkIGJlIHBlcm1pdHRlZCBldmVuIGlmIGFib21pbmFibGUKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKHJlc3VsdC5fdGVzdFJ1bkVudGVyZWQpCgoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICB1bml0dGVzdC5tYWluKCkK',
'/Lib/unittest/test/_test_warnings.py':'IyBoZWxwZXIgbW9kdWxlIGZvciB0ZXN0X3J1bm5lci5UZXN0X1RleHRUZXN0UnVubmVyLnRlc3Rfd2FybmluZ3MKCiIiIgpUaGlzIG1vZHVsZSBoYXMgYSBudW1iZXIgb2YgdGVzdHMgdGhhdCByYWlzZSBkaWZmZXJlbnQga2luZHMgb2Ygd2FybmluZ3MuCldoZW4gdGhlIHRlc3RzIGFyZSBydW4sIHRoZSB3YXJuaW5ncyBhcmUgY2F1Z2h0IGFuZCB0aGVpciBtZXNzYWdlcyBhcmUgcHJpbnRlZAp0byBzdGRvdXQuICBUaGlzIG1vZHVsZSBhbHNvIGFjY2VwdHMgYW4gYXJnIHRoYXQgaXMgdGhlbiBwYXNzZWQgdG8KdW5pdHRlc3QubWFpbiB0byBhZmZlY3QgdGhlIGJlaGF2aW9yIG9mIHdhcm5pbmdzLgpUZXN0X1RleHRUZXN0UnVubmVyLnRlc3Rfd2FybmluZ3MgZXhlY3V0ZXMgdGhpcyBzY3JpcHQgd2l0aCBkaWZmZXJlbnQKY29tYmluYXRpb25zIG9mIHdhcm5pbmdzIGFyZ3MgYW5kIC1XIGZsYWdzIGFuZCBjaGVjayB0aGF0IHRoZSBvdXRwdXQgaXMgY29ycmVjdC4KU2VlICMxMDUzNS4KIiIiCgppbXBvcnQgc3lzCmltcG9ydCB1bml0dGVzdAppbXBvcnQgd2FybmluZ3MKCmRlZiB3YXJuZnVuKCk6CiAgICB3YXJuaW5ncy53YXJuKCdydycsIFJ1bnRpbWVXYXJuaW5nKQoKY2xhc3MgVGVzdFdhcm5pbmdzKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICMgdW5pdHRlc3Qgd2FybmluZ3Mgd2lsbCBiZSBwcmludGVkIGF0IG1vc3Qgb25jZSBwZXIgdHlwZSAobWF4IG9uZSBtZXNzYWdlCiAgICAjIGZvciB0aGUgZmFpbCogbWV0aG9kcywgYW5kIG9uZSBmb3IgdGhlIGFzc2VydCogbWV0aG9kcykKICAgIGRlZiB0ZXN0X2Fzc2VydChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydEVxdWFscygyKzIsIDQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbHMoMioyLCA0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWxzKDIqKjIsIDQpCgogICAgZGVmIHRlc3RfZmFpbChzZWxmKToKICAgICAgICBzZWxmLmZhaWxVbmxlc3MoMSkKICAgICAgICBzZWxmLmZhaWxVbmxlc3MoVHJ1ZSkKCiAgICBkZWYgdGVzdF9vdGhlcl91bml0dGVzdChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydEFsbW9zdEVxdWFsKDIrMiwgNCkKICAgICAgICBzZWxmLmFzc2VydE5vdEFsbW9zdEVxdWFsKDQrNCwgMikKCiAgICAjIHRoZXNlIHdhcm5pbmdzIGFyZSBub3JtYWxseSBzaWxlbmNlZCwgYnV0IHRoZXkgYXJlIHByaW50ZWQgaW4gdW5pdHRlc3QKICAgIGRlZiB0ZXN0X2RlcHJlY2F0aW9uKHNlbGYpOgogICAgICAgIHdhcm5pbmdzLndhcm4oJ2R3JywgRGVwcmVjYXRpb25XYXJuaW5nKQogICAgICAgIHdhcm5pbmdzLndhcm4oJ2R3JywgRGVwcmVjYXRpb25XYXJuaW5nKQogICAgICAgIHdhcm5pbmdzLndhcm4oJ2R3JywgRGVwcmVjYXRpb25XYXJuaW5nKQoKICAgIGRlZiB0ZXN0X2ltcG9ydChzZWxmKToKICAgICAgICB3YXJuaW5ncy53YXJuKCdpdycsIEltcG9ydFdhcm5pbmcpCiAgICAgICAgd2FybmluZ3Mud2FybignaXcnLCBJbXBvcnRXYXJuaW5nKQogICAgICAgIHdhcm5pbmdzLndhcm4oJ2l3JywgSW1wb3J0V2FybmluZykKCiAgICAjIHVzZXIgd2FybmluZ3Mgc2hvdWxkIGFsd2F5cyBiZSBwcmludGVkCiAgICBkZWYgdGVzdF93YXJuaW5nKHNlbGYpOgogICAgICAgIHdhcm5pbmdzLndhcm4oJ3V3JykKICAgICAgICB3YXJuaW5ncy53YXJuKCd1dycpCiAgICAgICAgd2FybmluZ3Mud2FybigndXcnKQoKICAgICMgdGhlc2Ugd2FybmluZ3MgY29tZSBmcm9tIHRoZSBzYW1lIHBsYWNlOyB0aGV5IHdpbGwgYmUgcHJpbnRlZAogICAgIyBvbmx5IG9uY2UgYnkgZGVmYXVsdCBvciB0aHJlZSB0aW1lcyBpZiB0aGUgJ2Fsd2F5cycgZmlsdGVyIGlzIHVzZWQKICAgIGRlZiB0ZXN0X2Z1bmN0aW9uKHNlbGYpOgoKICAgICAgICB3YXJuZnVuKCkKICAgICAgICB3YXJuZnVuKCkKICAgICAgICB3YXJuZnVuKCkKCgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIHdpdGggd2FybmluZ3MuY2F0Y2hfd2FybmluZ3MocmVjb3JkPVRydWUpIGFzIHdzOgogICAgICAgICMgaWYgYW4gYXJnIGlzIHByb3ZpZGVkIHBhc3MgaXQgdG8gdW5pdHRlc3QubWFpbiBhcyAnd2FybmluZ3MnCiAgICAgICAgaWYgbGVuKHN5cy5hcmd2KSA9PSAyOgogICAgICAgICAgICB1bml0dGVzdC5tYWluKGV4aXQ9RmFsc2UsIHdhcm5pbmdzPXN5cy5hcmd2LnBvcCgpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHVuaXR0ZXN0Lm1haW4oZXhpdD1GYWxzZSkKCiAgICAjIHByaW50IGFsbCB0aGUgd2FybmluZyBtZXNzYWdlcyBjb2xsZWN0ZWQKICAgIGZvciB3IGluIHdzOgogICAgICAgIHByaW50KHcubWVzc2FnZSkK',
'/Lib/unittest/test/__init__.py':'aW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IHVuaXR0ZXN0CgoKaGVyZSA9IG9zLnBhdGguZGlybmFtZShfX2ZpbGVfXykKbG9hZGVyID0gdW5pdHRlc3QuZGVmYXVsdFRlc3RMb2FkZXIKCmRlZiBzdWl0ZSgpOgogICAgc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoKQogICAgZm9yIGZuIGluIG9zLmxpc3RkaXIoaGVyZSk6CiAgICAgICAgaWYgZm4uc3RhcnRzd2l0aCgidGVzdCIpIGFuZCBmbi5lbmRzd2l0aCgiLnB5Iik6CiAgICAgICAgICAgIG1vZG5hbWUgPSAidW5pdHRlc3QudGVzdC4iICsgZm5bOi0zXQogICAgICAgICAgICBfX2ltcG9ydF9fKG1vZG5hbWUpCiAgICAgICAgICAgIG1vZHVsZSA9IHN5cy5tb2R1bGVzW21vZG5hbWVdCiAgICAgICAgICAgIHN1aXRlLmFkZFRlc3QobG9hZGVyLmxvYWRUZXN0c0Zyb21Nb2R1bGUobW9kdWxlKSkKICAgIHN1aXRlLmFkZFRlc3QobG9hZGVyLmxvYWRUZXN0c0Zyb21OYW1lKCd1bml0dGVzdC50ZXN0LnRlc3Rtb2NrJykpCiAgICByZXR1cm4gc3VpdGUKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgdW5pdHRlc3QubWFpbihkZWZhdWx0VGVzdD0ic3VpdGUiKQo=',
'/Lib/unittest/test/testmock/support.py':'aW1wb3J0IHN5cwoKZGVmIGlzX2luc3RhbmNlKG9iaiwga2xhc3MpOgogICAgIiIiVmVyc2lvbiBvZiBpc19pbnN0YW5jZSB0aGF0IGRvZXNuJ3QgYWNjZXNzIF9fY2xhc3NfXyIiIgogICAgcmV0dXJuIGlzc3ViY2xhc3ModHlwZShvYmopLCBrbGFzcykKCgpjbGFzcyBTb21lQ2xhc3Mob2JqZWN0KToKICAgIGNsYXNzX2F0dHJpYnV0ZSA9IE5vbmUKCiAgICBkZWYgd2liYmxlKHNlbGYpOgogICAgICAgIHBhc3MKCgpjbGFzcyBYKG9iamVjdCk6CiAgICBwYXNzCgoKZGVmIGV4YW1pbmVfd2FybmluZ3MoZnVuYyk6CiAgICBkZWYgd3JhcHBlcigpOgogICAgICAgIHdpdGggY2F0Y2hfd2FybmluZ3MocmVjb3JkPVRydWUpIGFzIHdzOgogICAgICAgICAgICBmdW5jKHdzKQogICAgcmV0dXJuIHdyYXBwZXIK',
'/Lib/unittest/test/testmock/testcallable.py':'IyBDb3B5cmlnaHQgKEMpIDIwMDctMjAxMiBNaWNoYWVsIEZvb3JkICYgdGhlIG1vY2sgdGVhbQojIEUtbWFpbDogZnV6enltYW4gQVQgdm9pZHNwYWNlIERPVCBvcmcgRE9UIHVrCiMgaHR0cDovL3d3dy52b2lkc3BhY2Uub3JnLnVrL3B5dGhvbi9tb2NrLwoKaW1wb3J0IHVuaXR0ZXN0CmZyb20gdW5pdHRlc3QudGVzdC50ZXN0bW9jay5zdXBwb3J0IGltcG9ydCBpc19pbnN0YW5jZSwgWCwgU29tZUNsYXNzCgpmcm9tIHVuaXR0ZXN0Lm1vY2sgaW1wb3J0ICgKICAgIE1vY2ssIE1hZ2ljTW9jaywgTm9uQ2FsbGFibGVNYWdpY01vY2ssCiAgICBOb25DYWxsYWJsZU1vY2ssIHBhdGNoLCBjcmVhdGVfYXV0b3NwZWMsCiAgICBDYWxsYWJsZU1peGluCikKCgoKY2xhc3MgVGVzdENhbGxhYmxlKHVuaXR0ZXN0LlRlc3RDYXNlKToKCiAgICBkZWYgYXNzZXJ0Tm90Q2FsbGFibGUoc2VsZiwgbW9jayk6CiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzX2luc3RhbmNlKG1vY2ssIE5vbkNhbGxhYmxlTWFnaWNNb2NrKSkKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKGlzX2luc3RhbmNlKG1vY2ssIENhbGxhYmxlTWl4aW4pKQoKCiAgICBkZWYgdGVzdF9ub25fY2FsbGFibGUoc2VsZik6CiAgICAgICAgZm9yIG1vY2sgaW4gTm9uQ2FsbGFibGVNYWdpY01vY2soKSwgTm9uQ2FsbGFibGVNb2NrKCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jaykKICAgICAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShoYXNhdHRyKG1vY2ssICdfX2NhbGxfXycpKQogICAgICAgICAgICBzZWxmLmFzc2VydEluKG1vY2suX19jbGFzc19fLl9fbmFtZV9fLCByZXByKG1vY2spKQoKCiAgICBkZWYgdGVzdF9oZWlyYXJjaHkoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzc3ViY2xhc3MoTWFnaWNNb2NrLCBNb2NrKSkKICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNzdWJjbGFzcyhOb25DYWxsYWJsZU1hZ2ljTW9jaywgTm9uQ2FsbGFibGVNb2NrKSkKCgogICAgZGVmIHRlc3RfYXR0cmlidXRlcyhzZWxmKToKICAgICAgICBvbmUgPSBOb25DYWxsYWJsZU1vY2soKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShpc3N1YmNsYXNzKHR5cGUob25lLm9uZSksIE1vY2spKQoKICAgICAgICB0d28gPSBOb25DYWxsYWJsZU1hZ2ljTW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzc3ViY2xhc3ModHlwZSh0d28udHdvKSwgTWFnaWNNb2NrKSkKCgogICAgZGVmIHRlc3Rfc3ViY2xhc3NlcyhzZWxmKToKICAgICAgICBjbGFzcyBNb2NrU3ViKE1vY2spOgogICAgICAgICAgICBwYXNzCgogICAgICAgIG9uZSA9IE1vY2tTdWIoKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShpc3N1YmNsYXNzKHR5cGUob25lLm9uZSksIE1vY2tTdWIpKQoKICAgICAgICBjbGFzcyBNYWdpY1N1YihNYWdpY01vY2spOgogICAgICAgICAgICBwYXNzCgogICAgICAgIHR3byA9IE1hZ2ljU3ViKCkKICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNzdWJjbGFzcyh0eXBlKHR3by50d28pLCBNYWdpY1N1YikpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX3NwZWMoc2VsZik6CiAgICAgICAgcGF0Y2hlciA9IHBhdGNoKCclcy5YJyAlIF9fbmFtZV9fLCBzcGVjPVRydWUpCiAgICAgICAgbW9jayA9IHBhdGNoZXIuc3RhcnQoKQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChwYXRjaGVyLnN0b3ApCgogICAgICAgIGluc3RhbmNlID0gbW9jaygpCiAgICAgICAgbW9jay5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCgpCgogICAgICAgIHNlbGYuYXNzZXJ0Tm90Q2FsbGFibGUoaW5zdGFuY2UpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBpbnN0YW5jZSkKCgogICAgZGVmIHRlc3RfcGF0Y2hfc3BlY19zZXQoc2VsZik6CiAgICAgICAgcGF0Y2hlciA9IHBhdGNoKCclcy5YJyAlIF9fbmFtZV9fLCBzcGVjX3NldD1UcnVlKQogICAgICAgIG1vY2sgPSBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICBzZWxmLmFkZENsZWFudXAocGF0Y2hlci5zdG9wKQoKICAgICAgICBpbnN0YW5jZSA9IG1vY2soKQogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoKQoKICAgICAgICBzZWxmLmFzc2VydE5vdENhbGxhYmxlKGluc3RhbmNlKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgaW5zdGFuY2UpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX3NwZWNfaW5zdGFuY2Uoc2VsZik6CiAgICAgICAgcGF0Y2hlciA9IHBhdGNoKCclcy5YJyAlIF9fbmFtZV9fLCBzcGVjPVgoKSkKICAgICAgICBtb2NrID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHBhdGNoZXIuc3RvcCkKCiAgICAgICAgc2VsZi5hc3NlcnROb3RDYWxsYWJsZShtb2NrKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jaykKCgogICAgZGVmIHRlc3RfcGF0Y2hfc3BlY19zZXRfaW5zdGFuY2Uoc2VsZik6CiAgICAgICAgcGF0Y2hlciA9IHBhdGNoKCclcy5YJyAlIF9fbmFtZV9fLCBzcGVjX3NldD1YKCkpCiAgICAgICAgbW9jayA9IHBhdGNoZXIuc3RhcnQoKQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChwYXRjaGVyLnN0b3ApCgogICAgICAgIHNlbGYuYXNzZXJ0Tm90Q2FsbGFibGUobW9jaykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIG1vY2spCgoKICAgIGRlZiB0ZXN0X3BhdGNoX3NwZWNfY2FsbGFibGVfY2xhc3Moc2VsZik6CiAgICAgICAgY2xhc3MgQ2FsbGFibGVYKFgpOgogICAgICAgICAgICBkZWYgX19jYWxsX18oc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIGNsYXNzIFN1YihDYWxsYWJsZVgpOgogICAgICAgICAgICBwYXNzCgogICAgICAgIGNsYXNzIE11bHRpKFNvbWVDbGFzcywgU3ViKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBmb3IgYXJnIGluICdzcGVjJywgJ3NwZWNfc2V0JzoKICAgICAgICAgICAgZm9yIEtsYXNzIGluIENhbGxhYmxlWCwgU3ViLCBNdWx0aToKICAgICAgICAgICAgICAgIHdpdGggcGF0Y2goJyVzLlgnICUgX19uYW1lX18sICoqe2FyZzogS2xhc3N9KSBhcyBtb2NrOgogICAgICAgICAgICAgICAgICAgIGluc3RhbmNlID0gbW9jaygpCiAgICAgICAgICAgICAgICAgICAgbW9jay5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCgpCgogICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShpc19pbnN0YW5jZShpbnN0YW5jZSwgTWFnaWNNb2NrKSkKICAgICAgICAgICAgICAgICAgICAjIGluaGVyaXRlZCBzcGVjCiAgICAgICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIGluc3RhbmNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmb29iYXJiYXonKQoKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBpbnN0YW5jZSgpCiAgICAgICAgICAgICAgICAgICAgIyBpbnN0YW5jZSBpcyBjYWxsYWJsZSwgcmVzdWx0IGhhcyBubyBzcGVjCiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UuYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoKQoKICAgICAgICAgICAgICAgICAgICByZXN1bHQoMywgMiwgMSkKICAgICAgICAgICAgICAgICAgICByZXN1bHQuYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoMywgMiwgMSkKICAgICAgICAgICAgICAgICAgICByZXN1bHQuZm9vKDMsIDIsIDEpCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmZvby5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCgzLCAyLCAxKQoKCiAgICBkZWYgdGVzdF9jcmVhdGVfYXV0b3BzZWMoc2VsZik6CiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhYKQogICAgICAgIGluc3RhbmNlID0gbW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBpbnN0YW5jZSkKCiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhYKCkpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrKQoKCiAgICBkZWYgdGVzdF9jcmVhdGVfYXV0b3NwZWNfaW5zdGFuY2Uoc2VsZik6CiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhTb21lQ2xhc3MsIGluc3RhbmNlPVRydWUpCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jaykKICAgICAgICBtb2NrLndpYmJsZSgpCiAgICAgICAgbW9jay53aWJibGUuYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoKQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIG1vY2sud2liYmxlLCAnc29tZScsICAnYXJncycpCg==',
'/Lib/unittest/test/testmock/testhelpers.py':'aW1wb3J0IHVuaXR0ZXN0Cgpmcm9tIHVuaXR0ZXN0Lm1vY2sgaW1wb3J0ICgKICAgIGNhbGwsIF9DYWxsLCBjcmVhdGVfYXV0b3NwZWMsIE1hZ2ljTW9jaywKICAgIE1vY2ssIEFOWSwgX0NhbGxMaXN0LCBwYXRjaCwgUHJvcGVydHlNb2NrCikKCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCgpjbGFzcyBTb21lQ2xhc3Mob2JqZWN0KToKICAgIGRlZiBvbmUoc2VsZiwgYSwgYik6CiAgICAgICAgcGFzcwogICAgZGVmIHR3byhzZWxmKToKICAgICAgICBwYXNzCiAgICBkZWYgdGhyZWUoc2VsZiwgYT1Ob25lKToKICAgICAgICBwYXNzCgoKCmNsYXNzIEFueVRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgoKICAgIGRlZiB0ZXN0X2FueShzZWxmKToKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEFOWSwgb2JqZWN0KCkpCgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrKEFOWSkKICAgICAgICBtb2NrLmFzc2VydF9jYWxsZWRfd2l0aChBTlkpCgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrKGZvbz1BTlkpCiAgICAgICAgbW9jay5hc3NlcnRfY2FsbGVkX3dpdGgoZm9vPUFOWSkKCiAgICBkZWYgdGVzdF9yZXByKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVwcihBTlkpLCAnPEFOWT4nKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKEFOWSksICc8QU5ZPicpCgoKICAgIGRlZiB0ZXN0X2FueV9hbmRfZGF0ZXRpbWUoc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2soZGF0ZXRpbWUubm93KCksIGZvbz1kYXRldGltZS5ub3coKSkKCiAgICAgICAgbW9jay5hc3NlcnRfY2FsbGVkX3dpdGgoQU5ZLCBmb289QU5ZKQoKCiAgICBkZWYgdGVzdF9hbnlfbW9ja19jYWxsc19jb21wYXJpc29uX29yZGVyKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBkID0gZGF0ZXRpbWUubm93KCkKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgZGVmIF9fZXFfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgZGVmIF9fbmVfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQoKICAgICAgICBmb3IgZCBpbiBkYXRldGltZS5ub3coKSwgRm9vKCk6CiAgICAgICAgICAgIG1vY2sucmVzZXRfbW9jaygpCgogICAgICAgICAgICBtb2NrKGQsIGZvbz1kLCBiYXI9ZCkKICAgICAgICAgICAgbW9jay5tZXRob2QoZCwgemluZ2E9ZCwgYWxwaGE9ZCkKICAgICAgICAgICAgbW9jaygpLm1ldGhvZChhMT1kLCB6OTk9ZCkKCiAgICAgICAgICAgIGV4cGVjdGVkID0gWwogICAgICAgICAgICAgICAgY2FsbChBTlksIGZvbz1BTlksIGJhcj1BTlkpLAogICAgICAgICAgICAgICAgY2FsbC5tZXRob2QoQU5ZLCB6aW5nYT1BTlksIGFscGhhPUFOWSksCiAgICAgICAgICAgICAgICBjYWxsKCksIGNhbGwoKS5tZXRob2QoYTE9QU5ZLCB6OTk9QU5ZKQogICAgICAgICAgICBdCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZXhwZWN0ZWQsIG1vY2subW9ja19jYWxscykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1vY2tfY2FsbHMsIGV4cGVjdGVkKQoKCgpjbGFzcyBDYWxsVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIHRlc3RfY2FsbF93aXRoX2NhbGwoc2VsZik6CiAgICAgICAga2FsbCA9IF9DYWxsKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGthbGwsIF9DYWxsKCkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoJycsKSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoKCksKSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoe30sKSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoJycsICgpKSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoJycsIHt9KSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoJycsICgpLCB7fSkpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoa2FsbCwgX0NhbGwoKCdmb28nLCkpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoa2FsbCwgX0NhbGwoKCdiYXInLCAoKSkpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoa2FsbCwgX0NhbGwoKCdiYXonLCB7fSkpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoa2FsbCwgX0NhbGwoKCdzcGFtJywgKCksIHt9KSkpCgogICAgICAgIGthbGwgPSBfQ2FsbCgoKDEsIDIsIDMpLCkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoKDEsIDIsIDMpLCkpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoa2FsbCwgX0NhbGwoKCcnLCAoMSwgMiwgMykpKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGthbGwsIF9DYWxsKCgoMSwgMiwgMyksIHt9KSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoJycsICgxLCAyLCAzKSwge30pKSkKCiAgICAgICAga2FsbCA9IF9DYWxsKCgoMSwgMiwgNCksKSkKICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKGthbGwsIF9DYWxsKCgnJywgKDEsIDIsIDMpKSkpCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChrYWxsLCBfQ2FsbCgoJycsICgxLCAyLCAzKSwge30pKSkKCiAgICAgICAga2FsbCA9IF9DYWxsKCgnZm9vJywgKDEsIDIsIDQpLCkpCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChrYWxsLCBfQ2FsbCgoJycsICgxLCAyLCA0KSkpKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoa2FsbCwgX0NhbGwoKCcnLCAoMSwgMiwgNCksIHt9KSkpCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChrYWxsLCBfQ2FsbCgoJ2JhcicsICgxLCAyLCA0KSkpKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoa2FsbCwgX0NhbGwoKCdiYXInLCAoMSwgMiwgNCksIHt9KSkpCgogICAgICAgIGthbGwgPSBfQ2FsbCgoeydhJzogM30sKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGthbGwsIF9DYWxsKCgnJywgKCksIHsnYSc6IDN9KSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoJycsIHsnYSc6IDN9KSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoKCksIHsnYSc6IDN9KSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLCBfQ2FsbCgoeydhJzogM30sKSkpCgoKICAgIGRlZiB0ZXN0X2VtcHR5X19DYWxsKHNlbGYpOgogICAgICAgIGFyZ3MgPSBfQ2FsbCgpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCAoJ2ZvbycsKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGFyZ3MsICgoKSwpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCdmb28nLCAoKSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCAoJ2ZvbycsKCksIHt9KSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGFyZ3MsICgnZm9vJywge30pKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKHt9LCkpCgoKICAgIGRlZiB0ZXN0X25hbWVkX2VtcHR5X2NhbGwoc2VsZik6CiAgICAgICAgYXJncyA9IF9DYWxsKCgnZm9vJywgKCksIHt9KSkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCAoJ2ZvbycsKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGFyZ3MsICgnZm9vJywgKCkpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCdmb28nLCgpLCB7fSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCAoJ2ZvbycsIHt9KSkKCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChhcmdzLCAoKCksKSkKICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKGFyZ3MsICgpKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoYXJncywgKHt9LCkpCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChhcmdzLCAoJ2JhcicsKSkKICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKGFyZ3MsICgnYmFyJywgKCkpKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoYXJncywgKCdiYXInLCB7fSkpCgoKICAgIGRlZiB0ZXN0X2NhbGxfd2l0aF9hcmdzKHNlbGYpOgogICAgICAgIGFyZ3MgPSBfQ2FsbCgoKDEsIDIsIDMpLCB7fSkpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCgxLCAyLCAzKSwpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCdmb28nLCAoMSwgMiwgMykpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCdmb28nLCAoMSwgMiwgMyksIHt9KSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGFyZ3MsICgoMSwgMiwgMyksIHt9KSkKCgogICAgZGVmIHRlc3RfbmFtZWRfY2FsbF93aXRoX2FyZ3Moc2VsZik6CiAgICAgICAgYXJncyA9IF9DYWxsKCgnZm9vJywgKDEsIDIsIDMpLCB7fSkpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCdmb28nLCAoMSwgMiwgMykpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCdmb28nLCAoMSwgMiwgMyksIHt9KSkKCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChhcmdzLCAoKDEsIDIsIDMpLCkpCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChhcmdzLCAoKDEsIDIsIDMpLCB7fSkpCgoKICAgIGRlZiB0ZXN0X2NhbGxfd2l0aF9rd2FyZ3Moc2VsZik6CiAgICAgICAgYXJncyA9IF9DYWxsKCgoKSwgZGljdChhPTMsIGI9NCkpKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGFyZ3MsIChkaWN0KGE9MywgYj00KSwpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCdmb28nLCBkaWN0KGE9MywgYj00KSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCAoJ2ZvbycsICgpLCBkaWN0KGE9MywgYj00KSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCAoKCksIGRpY3QoYT0zLCBiPTQpKSkKCgogICAgZGVmIHRlc3RfbmFtZWRfY2FsbF93aXRoX2t3YXJncyhzZWxmKToKICAgICAgICBhcmdzID0gX0NhbGwoKCdmb28nLCAoKSwgZGljdChhPTMsIGI9NCkpKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGFyZ3MsICgnZm9vJywgZGljdChhPTMsIGI9NCkpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgKCdmb28nLCAoKSwgZGljdChhPTMsIGI9NCkpKQoKICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKGFyZ3MsIChkaWN0KGE9MywgYj00KSwpKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoYXJncywgKCgpLCBkaWN0KGE9MywgYj00KSkpCgoKICAgIGRlZiB0ZXN0X2NhbGxfd2l0aF9hcmdzX2NhbGxfZW1wdHlfbmFtZShzZWxmKToKICAgICAgICBhcmdzID0gX0NhbGwoKCgxLCAyLCAzKSwge30pKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJncywgY2FsbCgxLCAyLCAzKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNhbGwoMSwgMiwgMyksIGFyZ3MpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGNhbGwoMSwgMiwgMykgaW4gW2FyZ3NdKQoKCiAgICBkZWYgdGVzdF9jYWxsX25lKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoX0NhbGwoKCgxLCAyLCAzKSwpKSwgY2FsbCgxLCAyKSkKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKF9DYWxsKCgoMSwgMiwgMyksKSkgIT0gY2FsbCgxLCAyLCAzKSkKICAgICAgICBzZWxmLmFzc2VydFRydWUoX0NhbGwoKCgxLCAyKSwge30pKSAhPSBjYWxsKDEsIDIsIDMpKQoKCiAgICBkZWYgdGVzdF9jYWxsX25vbl90dXBsZXMoc2VsZik6CiAgICAgICAga2FsbCA9IF9DYWxsKCgoMSwgMiwgMyksKSkKICAgICAgICBmb3IgdmFsdWUgaW4gMSwgTm9uZSwgc2VsZiwgaW50OgogICAgICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKGthbGwsIHZhbHVlKQogICAgICAgICAgICBzZWxmLmFzc2VydEZhbHNlKGthbGwgPT0gdmFsdWUpCgoKICAgIGRlZiB0ZXN0X3JlcHIoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXByKF9DYWxsKCkpLCAnY2FsbCgpJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlcHIoX0NhbGwoKCdmb28nLCkpKSwgJ2NhbGwuZm9vKCknKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlcHIoX0NhbGwoKCgxLCAyLCAzKSwgeydhJzogJ2InfSkpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICJjYWxsKDEsIDIsIDMsIGE9J2InKSIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXByKF9DYWxsKCgnYmFyJywgKDEsIDIsIDMpLCB7J2EnOiAnYid9KSkpLAogICAgICAgICAgICAgICAgICAgICAgICAgImNhbGwuYmFyKDEsIDIsIDMsIGE9J2InKSIpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVwcihjYWxsKSwgJ2NhbGwnKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKGNhbGwpLCAnY2FsbCcpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVwcihjYWxsKCkpLCAnY2FsbCgpJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlcHIoY2FsbCgxKSksICdjYWxsKDEpJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlcHIoY2FsbCh6ej0ndGhpbmcnKSksICJjYWxsKHp6PSd0aGluZycpIikKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXByKGNhbGwoKS5mb28pLCAnY2FsbCgpLmZvbycpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXByKGNhbGwoMSkuZm9vLmJhcihhPTMpLmJpbmcpLAogICAgICAgICAgICAgICAgICAgICAgICAgJ2NhbGwoKS5mb28uYmFyKCkuYmluZycpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgKICAgICAgICAgICAgcmVwcihjYWxsKCkuZm9vKDEsIDIsIGE9MykpLAogICAgICAgICAgICAiY2FsbCgpLmZvbygxLCAyLCBhPTMpIgogICAgICAgICkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlcHIoY2FsbCgpKCkpLCAiY2FsbCgpKCkiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVwcihjYWxsKDEpKDIpKSwgImNhbGwoKSgyKSIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgKICAgICAgICAgICAgcmVwcihjYWxsKCkoKS5iYXIoKS5iYXouYmVlcCgxKSksCiAgICAgICAgICAgICJjYWxsKCkoKS5iYXIoKS5iYXouYmVlcCgxKSIKICAgICAgICApCgoKICAgIGRlZiB0ZXN0X2NhbGwoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChjYWxsKCksICgnJywgKCksIHt9KSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNhbGwoJ2ZvbycsICdiYXInLCBvbmU9MywgdHdvPTQpLAogICAgICAgICAgICAgICAgICAgICAgICAgKCcnLCAoJ2ZvbycsICdiYXInKSwgeydvbmUnOiAzLCAndHdvJzogNH0pKQoKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgbW9jaygxLCAyLCAzKQogICAgICAgIG1vY2soYT0zLCBiPTYpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmNhbGxfYXJnc19saXN0LAogICAgICAgICAgICAgICAgICAgICAgICAgW2NhbGwoMSwgMiwgMyksIGNhbGwoYT0zLCBiPTYpXSkKCiAgICBkZWYgdGVzdF9hdHRyaWJ1dGVfY2FsbChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNhbGwuZm9vKDEpLCAoJ2ZvbycsICgxLCksIHt9KSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNhbGwuYmFyLmJheihmaXNoPSdlZ2dzJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAoJ2Jhci5iYXonLCAoKSwgeydmaXNoJzogJ2VnZ3MnfSkpCgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrLmZvbygxLCAyICwzKQogICAgICAgIG1vY2suYmFyLmJheihhPTMsIGI9NikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subWV0aG9kX2NhbGxzLAogICAgICAgICAgICAgICAgICAgICAgICAgW2NhbGwuZm9vKDEsIDIsIDMpLCBjYWxsLmJhci5iYXooYT0zLCBiPTYpXSkKCgogICAgZGVmIHRlc3RfZXh0ZW5kZWRfY2FsbChzZWxmKToKICAgICAgICByZXN1bHQgPSBjYWxsKDEpLmZvbygyKS5iYXIoMywgYT00KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LCAoJygpLmZvbygpLmJhcicsICgzLCksIGRpY3QoYT00KSkpCgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgIG1vY2soMSwgMiwgYT0zLCBiPTQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmNhbGxfYXJncywgY2FsbCgxLCAyLCBhPTMsIGI9NCkpCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChtb2NrLmNhbGxfYXJncywgY2FsbCgxLCAyLCAzKSkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmNhbGxfYXJnc19saXN0LCBbY2FsbCgxLCAyLCBhPTMsIGI9NCldKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tb2NrX2NhbGxzLCBbY2FsbCgxLCAyLCBhPTMsIGI9NCldKQoKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKICAgICAgICBtb2NrLmZvbygxKS5iYXIoKSgpLmJhei5iZWVwKGE9NikKCiAgICAgICAgbGFzdF9jYWxsID0gY2FsbC5mb28oMSkuYmFyKCkoKS5iYXouYmVlcChhPTYpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1vY2tfY2FsbHNbLTFdLCBsYXN0X2NhbGwpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1vY2tfY2FsbHMsIGxhc3RfY2FsbC5jYWxsX2xpc3QoKSkKCgogICAgZGVmIHRlc3RfY2FsbF9saXN0KHNlbGYpOgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgIG1vY2soMSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNhbGwoMSkuY2FsbF9saXN0KCksIG1vY2subW9ja19jYWxscykKCiAgICAgICAgbW9jayA9IE1hZ2ljTW9jaygpCiAgICAgICAgbW9jaygxKS5tZXRob2QoMikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNhbGwoMSkubWV0aG9kKDIpLmNhbGxfbGlzdCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgbW9jay5tb2NrX2NhbGxzKQoKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKICAgICAgICBtb2NrKDEpLm1ldGhvZCgyKSgzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoY2FsbCgxKS5tZXRob2QoMikoMykuY2FsbF9saXN0KCksCiAgICAgICAgICAgICAgICAgICAgICAgICBtb2NrLm1vY2tfY2FsbHMpCgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgIGludChtb2NrKDEpLm1ldGhvZCgyKSgzKS5mb28uYmFyLmJheig0KSg1KSkKICAgICAgICBrYWxsID0gY2FsbCgxKS5tZXRob2QoMikoMykuZm9vLmJhci5iYXooNCkoNSkuX19pbnRfXygpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChrYWxsLmNhbGxfbGlzdCgpLCBtb2NrLm1vY2tfY2FsbHMpCgoKICAgIGRlZiB0ZXN0X2NhbGxfYW55KHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoY2FsbCwgQU5ZKQoKICAgICAgICBtID0gTWFnaWNNb2NrKCkKICAgICAgICBpbnQobSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0ubW9ja19jYWxscywgW0FOWV0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChbQU5ZXSwgbS5tb2NrX2NhbGxzKQoKCiAgICBkZWYgdGVzdF90d29fYXJnc19jYWxsKHNlbGYpOgogICAgICAgIGFyZ3MgPSBfQ2FsbCgoKDEsIDIpLCB7J2EnOiAzfSksIHR3bz1UcnVlKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKGFyZ3MpLCAyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJnc1swXSwgKDEsIDIpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoYXJnc1sxXSwgeydhJzogM30pCgogICAgICAgIG90aGVyX2FyZ3MgPSBfQ2FsbCgoKDEsIDIpLCB7J2EnOiAzfSkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCBvdGhlcl9hcmdzKQoKCmNsYXNzIFNwZWNTaWduYXR1cmVUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKCiAgICBkZWYgX2NoZWNrX3NvbWVjbGFzc19tb2NrKHNlbGYsIG1vY2spOgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBnZXRhdHRyLCBtb2NrLCAnZm9vJykKICAgICAgICBtb2NrLm9uZSgxLCAyKQogICAgICAgIG1vY2sub25lLmFzc2VydF9jYWxsZWRfd2l0aCgxLCAyKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEFzc2VydGlvbkVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1vY2sub25lLmFzc2VydF9jYWxsZWRfd2l0aCwgMywgNCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIG1vY2sub25lLCAxKQoKICAgICAgICBtb2NrLnR3bygpCiAgICAgICAgbW9jay50d28uYXNzZXJ0X2NhbGxlZF93aXRoKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBc3NlcnRpb25FcnJvciwKICAgICAgICAgICAgICAgICAgICAgICAgICBtb2NrLnR3by5hc3NlcnRfY2FsbGVkX3dpdGgsIDMpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrLnR3bywgMSkKCiAgICAgICAgbW9jay50aHJlZSgpCiAgICAgICAgbW9jay50aHJlZS5hc3NlcnRfY2FsbGVkX3dpdGgoKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEFzc2VydGlvbkVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1vY2sudGhyZWUuYXNzZXJ0X2NhbGxlZF93aXRoLCAzKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jay50aHJlZSwgMywgMikKCiAgICAgICAgbW9jay50aHJlZSgxKQogICAgICAgIG1vY2sudGhyZWUuYXNzZXJ0X2NhbGxlZF93aXRoKDEpCgogICAgICAgIG1vY2sudGhyZWUoYT0xKQogICAgICAgIG1vY2sudGhyZWUuYXNzZXJ0X2NhbGxlZF93aXRoKGE9MSkKCgogICAgZGVmIHRlc3RfYmFzaWMoc2VsZik6CiAgICAgICAgZm9yIHNwZWMgaW4gKFNvbWVDbGFzcywgU29tZUNsYXNzKCkpOgogICAgICAgICAgICBtb2NrID0gY3JlYXRlX2F1dG9zcGVjKHNwZWMpCiAgICAgICAgICAgIHNlbGYuX2NoZWNrX3NvbWVjbGFzc19tb2NrKG1vY2spCgoKICAgIGRlZiB0ZXN0X2NyZWF0ZV9hdXRvc3BlY19yZXR1cm5fdmFsdWUoc2VsZik6CiAgICAgICAgZGVmIGYoKToKICAgICAgICAgICAgcGFzcwogICAgICAgIG1vY2sgPSBjcmVhdGVfYXV0b3NwZWMoZiwgcmV0dXJuX3ZhbHVlPSdmb28nKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jaygpLCAnZm9vJykKCiAgICAgICAgY2xhc3MgRm9vKG9iamVjdCk6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhGb28sIHJldHVybl92YWx1ZT0nZm9vJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2soKSwgJ2ZvbycpCgoKICAgIGRlZiB0ZXN0X2F1dG9zcGVjX3Jlc2V0X21vY2soc2VsZik6CiAgICAgICAgbSA9IGNyZWF0ZV9hdXRvc3BlYyhpbnQpCiAgICAgICAgaW50KG0pCiAgICAgICAgbS5yZXNldF9tb2NrKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0uX19pbnRfXy5jYWxsX2NvdW50LCAwKQoKCiAgICBkZWYgdGVzdF9tb2NraW5nX3VuYm91bmRfbWV0aG9kcyhzZWxmKToKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgZGVmIGZvbyhzZWxmLCBmb28pOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIHAgPSBwYXRjaC5vYmplY3QoRm9vLCAnZm9vJykKICAgICAgICBtb2NrX2ZvbyA9IHAuc3RhcnQoKQogICAgICAgIEZvbygpLmZvbygxKQoKICAgICAgICBtb2NrX2Zvby5hc3NlcnRfY2FsbGVkX3dpdGgoMSkKCgogICAgZGVmIHRlc3RfY3JlYXRlX2F1dG9zcGVjX3VuYm91bmRfbWV0aG9kcyhzZWxmKToKICAgICAgICAjIHNlZSBtb2NrIGlzc3VlIDEyOAogICAgICAgICMgdGhpcyBpcyBleHBlY3RlZCB0byBmYWlsIHVudGlsIHRoZSBpc3N1ZSBpcyBmaXhlZAogICAgICAgIHJldHVybgogICAgICAgIGNsYXNzIEZvbyhvYmplY3QpOgogICAgICAgICAgICBkZWYgZm9vKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBrbGFzcyA9IGNyZWF0ZV9hdXRvc3BlYyhGb28pCiAgICAgICAgaW5zdGFuY2UgPSBrbGFzcygpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBpbnN0YW5jZS5mb28sIDEpCgogICAgICAgICMgTm90ZTogbm8gdHlwZSBjaGVja2luZyBvbiB0aGUgInNlbGYiIHBhcmFtZXRlcgogICAgICAgIGtsYXNzLmZvbygxKQogICAgICAgIGtsYXNzLmZvby5hc3NlcnRfY2FsbGVkX3dpdGgoMSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGtsYXNzLmZvbykKCgogICAgZGVmIHRlc3RfY3JlYXRlX2F1dG9zcGVjX2tleXdvcmRfYXJndW1lbnRzKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyhvYmplY3QpOgogICAgICAgICAgICBhID0gMwogICAgICAgIG0gPSBjcmVhdGVfYXV0b3NwZWMoRm9vLCBhPSczJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0uYSwgJzMnKQoKCiAgICBkZWYgdGVzdF9jcmVhdGVfYXV0b3NwZWNfa2V5d29yZF9vbmx5X2FyZ3VtZW50cyhzZWxmKToKICAgICAgICBkZWYgZm9vKGEsICosIGI9Tm9uZSk6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgbSA9IGNyZWF0ZV9hdXRvc3BlYyhmb28pCiAgICAgICAgbSgxKQogICAgICAgIG0uYXNzZXJ0X2NhbGxlZF93aXRoKDEpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtLCAxLCAyKQoKICAgICAgICBtKDIsIGI9MykKICAgICAgICBtLmFzc2VydF9jYWxsZWRfd2l0aCgyLCBiPTMpCgoKICAgIGRlZiB0ZXN0X2Z1bmN0aW9uX2FzX2luc3RhbmNlX2F0dHJpYnV0ZShzZWxmKToKICAgICAgICBvYmogPSBTb21lQ2xhc3MoKQogICAgICAgIGRlZiBmKGEpOgogICAgICAgICAgICBwYXNzCiAgICAgICAgb2JqLmYgPSBmCgogICAgICAgIG1vY2sgPSBjcmVhdGVfYXV0b3NwZWMob2JqKQogICAgICAgIG1vY2suZignYmluZycpCiAgICAgICAgbW9jay5mLmFzc2VydF9jYWxsZWRfd2l0aCgnYmluZycpCgoKICAgIGRlZiB0ZXN0X3NwZWNfYXNfbGlzdChzZWxmKToKICAgICAgICAjIGJlY2F1c2Ugc3BlYyBhcyBhIGxpc3Qgb2Ygc3RyaW5ncyBpbiB0aGUgbW9jayBjb25zdHJ1Y3RvciBtZWFucwogICAgICAgICMgc29tZXRoaW5nIHZlcnkgZGlmZmVyZW50IHdlIHRyZWF0IGEgbGlzdCBpbnN0YW5jZSBhcyB0aGUgdHlwZS4KICAgICAgICBtb2NrID0gY3JlYXRlX2F1dG9zcGVjKFtdKQogICAgICAgIG1vY2suYXBwZW5kKCdmb28nKQogICAgICAgIG1vY2suYXBwZW5kLmFzc2VydF9jYWxsZWRfd2l0aCgnZm9vJykKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIG1vY2ssICdmb28nKQoKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgZm9vID0gW10KCiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhGb28pCiAgICAgICAgbW9jay5mb28uYXBwZW5kKDMpCiAgICAgICAgbW9jay5mb28uYXBwZW5kLmFzc2VydF9jYWxsZWRfd2l0aCgzKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBnZXRhdHRyLCBtb2NrLmZvbywgJ2ZvbycpCgoKICAgIGRlZiB0ZXN0X2F0dHJpYnV0ZXMoc2VsZik6CiAgICAgICAgY2xhc3MgU3ViKFNvbWVDbGFzcyk6CiAgICAgICAgICAgIGF0dHIgPSBTb21lQ2xhc3MoKQoKICAgICAgICBzdWJfbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhTdWIpCgogICAgICAgIGZvciBtb2NrIGluIChzdWJfbW9jaywgc3ViX21vY2suYXR0cik6CiAgICAgICAgICAgIHNlbGYuX2NoZWNrX3NvbWVjbGFzc19tb2NrKG1vY2spCgoKICAgIGRlZiB0ZXN0X2J1aWx0aW5fZnVuY3Rpb25zX3R5cGVzKHNlbGYpOgogICAgICAgICMgd2UgY291bGQgcmVwbGFjZSBidWlsdGluIGZ1bmN0aW9ucyAvIG1ldGhvZHMgd2l0aCBhIGZ1bmN0aW9uCiAgICAgICAgIyB3aXRoICphcmdzIC8gKiprd2FyZ3Mgc2lnbmF0dXJlLiBVc2luZyB0aGUgYnVpbHRpbiBtZXRob2QgdHlwZQogICAgICAgICMgYXMgYSBzcGVjIHNlZW1zIHRvIHdvcmsgZmFpcmx5IHdlbGwgdGhvdWdoLgogICAgICAgIGNsYXNzIEJ1aWx0aW5TdWJjbGFzcyhsaXN0KToKICAgICAgICAgICAgZGVmIGJhcihzZWxmLCBhcmcpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBzb3J0ZWQgPSBzb3J0ZWQKICAgICAgICAgICAgYXR0ciA9IHt9CgogICAgICAgIG1vY2sgPSBjcmVhdGVfYXV0b3NwZWMoQnVpbHRpblN1YmNsYXNzKQogICAgICAgIG1vY2suYXBwZW5kKDMpCiAgICAgICAgbW9jay5hcHBlbmQuYXNzZXJ0X2NhbGxlZF93aXRoKDMpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIG1vY2suYXBwZW5kLCAnZm9vJykKCiAgICAgICAgbW9jay5iYXIoJ2ZvbycpCiAgICAgICAgbW9jay5iYXIuYXNzZXJ0X2NhbGxlZF93aXRoKCdmb28nKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jay5iYXIsICdmb28nLCAnYmFyJykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgbW9jay5iYXIsICdmb28nKQoKICAgICAgICBtb2NrLnNvcnRlZChbMSwgMl0pCiAgICAgICAgbW9jay5zb3J0ZWQuYXNzZXJ0X2NhbGxlZF93aXRoKFsxLCAyXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgbW9jay5zb3J0ZWQsICdmb28nKQoKICAgICAgICBtb2NrLmF0dHIucG9wKDMpCiAgICAgICAgbW9jay5hdHRyLnBvcC5hc3NlcnRfY2FsbGVkX3dpdGgoMykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgbW9jay5hdHRyLCAnZm9vJykKCgogICAgZGVmIHRlc3RfbWV0aG9kX2NhbGxzKHNlbGYpOgogICAgICAgIGNsYXNzIFN1YihTb21lQ2xhc3MpOgogICAgICAgICAgICBhdHRyID0gU29tZUNsYXNzKCkKCiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhTdWIpCiAgICAgICAgbW9jay5vbmUoMSwgMikKICAgICAgICBtb2NrLnR3bygpCiAgICAgICAgbW9jay50aHJlZSgzKQoKICAgICAgICBleHBlY3RlZCA9IFtjYWxsLm9uZSgxLCAyKSwgY2FsbC50d28oKSwgY2FsbC50aHJlZSgzKV0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subWV0aG9kX2NhbGxzLCBleHBlY3RlZCkKCiAgICAgICAgbW9jay5hdHRyLm9uZSgxLCAyKQogICAgICAgIG1vY2suYXR0ci50d28oKQogICAgICAgIG1vY2suYXR0ci50aHJlZSgzKQoKICAgICAgICBleHBlY3RlZC5leHRlbmQoCiAgICAgICAgICAgIFtjYWxsLmF0dHIub25lKDEsIDIpLCBjYWxsLmF0dHIudHdvKCksIGNhbGwuYXR0ci50aHJlZSgzKV0KICAgICAgICApCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1ldGhvZF9jYWxscywgZXhwZWN0ZWQpCgoKICAgIGRlZiB0ZXN0X21hZ2ljX21ldGhvZHMoc2VsZik6CiAgICAgICAgY2xhc3MgQnVpbHRpblN1YmNsYXNzKGxpc3QpOgogICAgICAgICAgICBhdHRyID0ge30KCiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhCdWlsdGluU3ViY2xhc3MpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KG1vY2spLCBbXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGludCwgbW9jaykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGludCwgbW9jay5hdHRyKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChtb2NrKSwgW10pCgogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrWydmb28nXSwgTWFnaWNNb2NrKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrLmF0dHJbJ2ZvbyddLCBNYWdpY01vY2spCgoKICAgIGRlZiB0ZXN0X3NwZWNfc2V0KHNlbGYpOgogICAgICAgIGNsYXNzIFN1YihTb21lQ2xhc3MpOgogICAgICAgICAgICBhdHRyID0gU29tZUNsYXNzKCkKCiAgICAgICAgZm9yIHNwZWMgaW4gKFN1YiwgU3ViKCkpOgogICAgICAgICAgICBtb2NrID0gY3JlYXRlX2F1dG9zcGVjKHNwZWMsIHNwZWNfc2V0PVRydWUpCiAgICAgICAgICAgIHNlbGYuX2NoZWNrX3NvbWVjbGFzc19tb2NrKG1vY2spCgogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgc2V0YXR0ciwgbW9jaywgJ2ZvbycsICdiYXInKQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgc2V0YXR0ciwgbW9jay5hdHRyLCAnZm9vJywgJ2JhcicpCgoKICAgIGRlZiB0ZXN0X2Rlc2NyaXB0b3JzKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyhvYmplY3QpOgogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIGYoY2xzLCBhLCBiKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgQHN0YXRpY21ldGhvZAogICAgICAgICAgICBkZWYgZyhhLCBiKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgY2xhc3MgQmFyKEZvbyk6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgY2xhc3MgQmF6KFNvbWVDbGFzcywgQmFyKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBmb3Igc3BlYyBpbiAoRm9vLCBGb28oKSwgQmFyLCBCYXIoKSwgQmF6LCBCYXooKSk6CiAgICAgICAgICAgIG1vY2sgPSBjcmVhdGVfYXV0b3NwZWMoc3BlYykKICAgICAgICAgICAgbW9jay5mKDEsIDIpCiAgICAgICAgICAgIG1vY2suZi5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCgxLCAyKQoKICAgICAgICAgICAgbW9jay5nKDMsIDQpCiAgICAgICAgICAgIG1vY2suZy5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCgzLCA0KQoKCiAgICBkZWYgdGVzdF9yZWN1cnNpdmUoc2VsZik6CiAgICAgICAgY2xhc3MgQShvYmplY3QpOgogICAgICAgICAgICBkZWYgYShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZm9vID0gJ2ZvbyBiYXIgYmF6JwogICAgICAgICAgICBiYXIgPSBmb28KCiAgICAgICAgQS5CID0gQQogICAgICAgIG1vY2sgPSBjcmVhdGVfYXV0b3NwZWMoQSkKCiAgICAgICAgbW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShtb2NrLkIuY2FsbGVkKQoKICAgICAgICBtb2NrLmEoKQogICAgICAgIG1vY2suQi5hKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subWV0aG9kX2NhbGxzLCBbY2FsbC5hKCksIGNhbGwuQi5hKCldKQoKICAgICAgICBzZWxmLmFzc2VydElzKEEuZm9vLCBBLmJhcikKICAgICAgICBzZWxmLmFzc2VydElzTm90KG1vY2suZm9vLCBtb2NrLmJhcikKICAgICAgICBtb2NrLmZvby5sb3dlcigpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXNzZXJ0aW9uRXJyb3IsIG1vY2suYmFyLmxvd2VyLmFzc2VydF9jYWxsZWRfd2l0aCkKCgogICAgZGVmIHRlc3Rfc3BlY19pbmhlcml0YW5jZV9mb3JfY2xhc3NlcyhzZWxmKToKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgZGVmIGEoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGNsYXNzIEJhcihvYmplY3QpOgogICAgICAgICAgICAgICAgZGVmIGYoc2VsZik6CiAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBjbGFzc19tb2NrID0gY3JlYXRlX2F1dG9zcGVjKEZvbykKCiAgICAgICAgc2VsZi5hc3NlcnRJc05vdChjbGFzc19tb2NrLCBjbGFzc19tb2NrKCkpCgogICAgICAgIGZvciB0aGlzX21vY2sgaW4gY2xhc3NfbW9jaywgY2xhc3NfbW9jaygpOgogICAgICAgICAgICB0aGlzX21vY2suYSgpCiAgICAgICAgICAgIHRoaXNfbW9jay5hLmFzc2VydF9jYWxsZWRfd2l0aCgpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgdGhpc19tb2NrLmEsICdmb28nKQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgdGhpc19tb2NrLCAnYicpCgogICAgICAgIGluc3RhbmNlX21vY2sgPSBjcmVhdGVfYXV0b3NwZWMoRm9vKCkpCiAgICAgICAgaW5zdGFuY2VfbW9jay5hKCkKICAgICAgICBpbnN0YW5jZV9tb2NrLmEuYXNzZXJ0X2NhbGxlZF93aXRoKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGluc3RhbmNlX21vY2suYSwgJ2ZvbycpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIGluc3RhbmNlX21vY2ssICdiJykKCiAgICAgICAgIyBUaGUgcmV0dXJuIHZhbHVlIGlzbid0IGlzbid0IGNhbGxhYmxlCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBpbnN0YW5jZV9tb2NrKQoKICAgICAgICBpbnN0YW5jZV9tb2NrLkJhci5mKCkKICAgICAgICBpbnN0YW5jZV9tb2NrLkJhci5mLmFzc2VydF9jYWxsZWRfd2l0aCgpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIGluc3RhbmNlX21vY2suQmFyLCAnZycpCgogICAgICAgIGluc3RhbmNlX21vY2suQmFyKCkuZigpCiAgICAgICAgaW5zdGFuY2VfbW9jay5CYXIoKS5mLmFzc2VydF9jYWxsZWRfd2l0aCgpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIGluc3RhbmNlX21vY2suQmFyKCksICdnJykKCgogICAgZGVmIHRlc3RfaW5oZXJpdChzZWxmKToKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgYSA9IDMKCiAgICAgICAgRm9vLkZvbyA9IEZvbwoKICAgICAgICAjIGNsYXNzCiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhGb28pCiAgICAgICAgaW5zdGFuY2UgPSBtb2NrKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgaW5zdGFuY2UsICdiJykKCiAgICAgICAgYXR0cl9pbnN0YW5jZSA9IG1vY2suRm9vKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgYXR0cl9pbnN0YW5jZSwgJ2InKQoKICAgICAgICAjIGluc3RhbmNlCiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhGb28oKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgbW9jaywgJ2InKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jaykKCiAgICAgICAgIyBhdHRyaWJ1dGUgaW5zdGFuY2UKICAgICAgICBjYWxsX3Jlc3VsdCA9IG1vY2suRm9vKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgY2FsbF9yZXN1bHQsICdiJykKCgogICAgZGVmIHRlc3RfYnVpbHRpbnMoc2VsZik6CiAgICAgICAgIyB1c2VkIHRvIGZhaWwgd2l0aCBpbmZpbml0ZSByZWN1cnNpb24KICAgICAgICBjcmVhdGVfYXV0b3NwZWMoMSkKCiAgICAgICAgY3JlYXRlX2F1dG9zcGVjKGludCkKICAgICAgICBjcmVhdGVfYXV0b3NwZWMoJ2ZvbycpCiAgICAgICAgY3JlYXRlX2F1dG9zcGVjKHN0cikKICAgICAgICBjcmVhdGVfYXV0b3NwZWMoe30pCiAgICAgICAgY3JlYXRlX2F1dG9zcGVjKGRpY3QpCiAgICAgICAgY3JlYXRlX2F1dG9zcGVjKFtdKQogICAgICAgIGNyZWF0ZV9hdXRvc3BlYyhsaXN0KQogICAgICAgIGNyZWF0ZV9hdXRvc3BlYyhzZXQoKSkKICAgICAgICBjcmVhdGVfYXV0b3NwZWMoc2V0KQogICAgICAgIGNyZWF0ZV9hdXRvc3BlYygxLjApCiAgICAgICAgY3JlYXRlX2F1dG9zcGVjKGZsb2F0KQogICAgICAgIGNyZWF0ZV9hdXRvc3BlYygxaikKICAgICAgICBjcmVhdGVfYXV0b3NwZWMoY29tcGxleCkKICAgICAgICBjcmVhdGVfYXV0b3NwZWMoRmFsc2UpCiAgICAgICAgY3JlYXRlX2F1dG9zcGVjKFRydWUpCgoKICAgIGRlZiB0ZXN0X2Z1bmN0aW9uKHNlbGYpOgogICAgICAgIGRlZiBmKGEsIGIpOgogICAgICAgICAgICBwYXNzCgogICAgICAgIG1vY2sgPSBjcmVhdGVfYXV0b3NwZWMoZikKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIG1vY2spCiAgICAgICAgbW9jaygxLCAyKQogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF93aXRoKDEsIDIpCgogICAgICAgIGYuZiA9IGYKICAgICAgICBtb2NrID0gY3JlYXRlX2F1dG9zcGVjKGYpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrLmYpCiAgICAgICAgbW9jay5mKDMsIDQpCiAgICAgICAgbW9jay5mLmFzc2VydF9jYWxsZWRfd2l0aCgzLCA0KQoKCiAgICBkZWYgdGVzdF9za2lwX2F0dHJpYnV0ZWVycm9ycyhzZWxmKToKICAgICAgICBjbGFzcyBSYWlzZXIob2JqZWN0KToKICAgICAgICAgICAgZGVmIF9fZ2V0X18oc2VsZiwgb2JqLCB0eXBlPU5vbmUpOgogICAgICAgICAgICAgICAgaWYgb2JqIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgcmFpc2UgQXR0cmlidXRlRXJyb3IoJ0NhbiBvbmx5IGJlIGFjY2Vzc2VkIHZpYSBhbiBpbnN0YW5jZScpCgogICAgICAgIGNsYXNzIFJhaXNlckNsYXNzKG9iamVjdCk6CiAgICAgICAgICAgIHJhaXNlciA9IFJhaXNlcigpCgogICAgICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgICAgIGRlZiBleGlzdGluZyhhLCBiKToKICAgICAgICAgICAgICAgIHJldHVybiBhICsgYgoKICAgICAgICBzID0gY3JlYXRlX2F1dG9zcGVjKFJhaXNlckNsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhIHg6IHMuZXhpc3RpbmcoMSwgMiwgMykpCiAgICAgICAgcy5leGlzdGluZygxLCAyKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBsYW1iZGE6IHMubm9uZXhpc3RpbmcpCgogICAgICAgICMgY2hlY2sgd2UgY2FuIGZldGNoIHRoZSByYWlzZXIgYXR0cmlidXRlIGFuZCBpdCBoYXMgbm8gc3BlYwogICAgICAgIG9iaiA9IHMucmFpc2VyCiAgICAgICAgb2JqLmZvbywgb2JqLmJhcgoKCiAgICBkZWYgdGVzdF9zaWduYXR1cmVfY2xhc3Moc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKG9iamVjdCk6CiAgICAgICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBhLCBiPTMpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBtb2NrID0gY3JlYXRlX2F1dG9zcGVjKEZvbykKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrKQogICAgICAgIG1vY2soMSkKICAgICAgICBtb2NrLmFzc2VydF9jYWxsZWRfb25jZV93aXRoKDEpCgogICAgICAgIG1vY2soNCwgNSkKICAgICAgICBtb2NrLmFzc2VydF9jYWxsZWRfd2l0aCg0LCA1KQoKCiAgICBkZWYgdGVzdF9jbGFzc193aXRoX25vX2luaXQoc2VsZik6CiAgICAgICAgIyB0aGlzIHVzZWQgdG8gcmFpc2UgYW4gZXhjZXB0aW9uCiAgICAgICAgIyBkdWUgdG8gdHJ5aW5nIHRvIGdldCBhIHNpZ25hdHVyZSBmcm9tIG9iamVjdC5fX2luaXRfXwogICAgICAgIGNsYXNzIEZvbyhvYmplY3QpOgogICAgICAgICAgICBwYXNzCiAgICAgICAgY3JlYXRlX2F1dG9zcGVjKEZvbykKCgogICAgZGVmIHRlc3Rfc2lnbmF0dXJlX2NhbGxhYmxlKHNlbGYpOgogICAgICAgIGNsYXNzIENhbGxhYmxlKG9iamVjdCk6CiAgICAgICAgICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIF9fY2FsbF9fKHNlbGYsIGEpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBtb2NrID0gY3JlYXRlX2F1dG9zcGVjKENhbGxhYmxlKQogICAgICAgIG1vY2soKQogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jaywgJ2EnKQoKICAgICAgICBpbnN0YW5jZSA9IG1vY2soKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgaW5zdGFuY2UpCiAgICAgICAgaW5zdGFuY2UoYT0nYScpCiAgICAgICAgaW5zdGFuY2UuYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoYT0nYScpCiAgICAgICAgaW5zdGFuY2UoJ2EnKQogICAgICAgIGluc3RhbmNlLmFzc2VydF9jYWxsZWRfd2l0aCgnYScpCgogICAgICAgIG1vY2sgPSBjcmVhdGVfYXV0b3NwZWMoQ2FsbGFibGUoKSkKICAgICAgICBtb2NrKGE9J2EnKQogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoYT0nYScpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrKQogICAgICAgIG1vY2soJ2EnKQogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF93aXRoKCdhJykKCgogICAgZGVmIHRlc3Rfc2lnbmF0dXJlX25vbmNhbGxhYmxlKHNlbGYpOgogICAgICAgIGNsYXNzIE5vbkNhbGxhYmxlKG9iamVjdCk6CiAgICAgICAgICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgbW9jayA9IGNyZWF0ZV9hdXRvc3BlYyhOb25DYWxsYWJsZSkKICAgICAgICBpbnN0YW5jZSA9IG1vY2soKQogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jaywgJ2EnKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgaW5zdGFuY2UpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBpbnN0YW5jZSwgJ2EnKQoKICAgICAgICBtb2NrID0gY3JlYXRlX2F1dG9zcGVjKE5vbkNhbGxhYmxlKCkpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jaywgJ2EnKQoKCiAgICBkZWYgdGVzdF9jcmVhdGVfYXV0b3NwZWNfbm9uZShzZWxmKToKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgYmFyID0gTm9uZQoKICAgICAgICBtb2NrID0gY3JlYXRlX2F1dG9zcGVjKEZvbykKICAgICAgICBub25lID0gbW9jay5iYXIKICAgICAgICBzZWxmLmFzc2VydE5vdElzSW5zdGFuY2Uobm9uZSwgdHlwZShOb25lKSkKCiAgICAgICAgbm9uZS5mb28oKQogICAgICAgIG5vbmUuZm9vLmFzc2VydF9jYWxsZWRfb25jZV93aXRoKCkKCgogICAgZGVmIHRlc3RfYXV0b3NwZWNfZnVuY3Rpb25zX3dpdGhfc2VsZl9pbl9vZGRfcGxhY2Uoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKG9iamVjdCk6CiAgICAgICAgICAgIGRlZiBmKGEsIHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBhID0gY3JlYXRlX2F1dG9zcGVjKEZvbykKICAgICAgICBhLmYoc2VsZj0xMCkKICAgICAgICBhLmYuYXNzZXJ0X2NhbGxlZF93aXRoKHNlbGY9MTApCgoKICAgIGRlZiB0ZXN0X2F1dG9zcGVjX3Byb3BlcnR5KHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyhvYmplY3QpOgogICAgICAgICAgICBAcHJvcGVydHkKICAgICAgICAgICAgZGVmIGZvbyhzZWxmKToKICAgICAgICAgICAgICAgIHJldHVybiAzCgogICAgICAgIGZvbyA9IGNyZWF0ZV9hdXRvc3BlYyhGb28pCiAgICAgICAgbW9ja19wcm9wZXJ0eSA9IGZvby5mb28KCiAgICAgICAgIyBubyBzcGVjIG9uIHByb3BlcnRpZXMKICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNpbnN0YW5jZShtb2NrX3Byb3BlcnR5LCBNYWdpY01vY2spKQogICAgICAgIG1vY2tfcHJvcGVydHkoMSwgMiwgMykKICAgICAgICBtb2NrX3Byb3BlcnR5LmFiYyg0LCA1LCA2KQogICAgICAgIG1vY2tfcHJvcGVydHkuYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoMSwgMiwgMykKICAgICAgICBtb2NrX3Byb3BlcnR5LmFiYy5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCg0LCA1LCA2KQoKCiAgICBkZWYgdGVzdF9hdXRvc3BlY19zbG90cyhzZWxmKToKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgX19zbG90c19fID0gWydhJ10KCiAgICAgICAgZm9vID0gY3JlYXRlX2F1dG9zcGVjKEZvbykKICAgICAgICBtb2NrX3Nsb3QgPSBmb28uYQoKICAgICAgICAjIG5vIHNwZWMgb24gc2xvdHMKICAgICAgICBtb2NrX3Nsb3QoMSwgMiwgMykKICAgICAgICBtb2NrX3Nsb3QuYWJjKDQsIDUsIDYpCiAgICAgICAgbW9ja19zbG90LmFzc2VydF9jYWxsZWRfb25jZV93aXRoKDEsIDIsIDMpCiAgICAgICAgbW9ja19zbG90LmFiYy5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCg0LCA1LCA2KQoKCmNsYXNzIFRlc3RDYWxsTGlzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIHRlc3RfYXJnc19saXN0X2NvbnRhaW5zX2NhbGxfbGlzdChzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKG1vY2suY2FsbF9hcmdzX2xpc3QsIF9DYWxsTGlzdCkKCiAgICAgICAgbW9jaygxLCAyKQogICAgICAgIG1vY2soYT0zKQogICAgICAgIG1vY2soMywgNCkKICAgICAgICBtb2NrKGI9NikKCiAgICAgICAgZm9yIGthbGwgaW4gY2FsbCgxLCAyKSwgY2FsbChhPTMpLCBjYWxsKDMsIDQpLCBjYWxsKGI9Nik6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShrYWxsIGluIG1vY2suY2FsbF9hcmdzX2xpc3QpCgogICAgICAgIGNhbGxzID0gW2NhbGwoYT0zKSwgY2FsbCgzLCA0KV0KICAgICAgICBzZWxmLmFzc2VydFRydWUoY2FsbHMgaW4gbW9jay5jYWxsX2FyZ3NfbGlzdCkKICAgICAgICBjYWxscyA9IFtjYWxsKDEsIDIpLCBjYWxsKGE9MyldCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGNhbGxzIGluIG1vY2suY2FsbF9hcmdzX2xpc3QpCiAgICAgICAgY2FsbHMgPSBbY2FsbCgzLCA0KSwgY2FsbChiPTYpXQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShjYWxscyBpbiBtb2NrLmNhbGxfYXJnc19saXN0KQogICAgICAgIGNhbGxzID0gW2NhbGwoMywgNCldCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGNhbGxzIGluIG1vY2suY2FsbF9hcmdzX2xpc3QpCgogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoY2FsbCgnZmlzaCcpIGluIG1vY2suY2FsbF9hcmdzX2xpc3QpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShbY2FsbCgnZmlzaCcpXSBpbiBtb2NrLmNhbGxfYXJnc19saXN0KQoKCiAgICBkZWYgdGVzdF9jYWxsX2xpc3Rfc3RyKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrKDEsIDIpCiAgICAgICAgbW9jay5mb28oYT0zKQogICAgICAgIG1vY2suZm9vLmJhcigpLmJheignZmlzaCcsIGNhdD0nZG9nJykKCiAgICAgICAgZXhwZWN0ZWQgPSAoCiAgICAgICAgICAgICJbY2FsbCgxLCAyKSxcbiIKICAgICAgICAgICAgIiBjYWxsLmZvbyhhPTMpLFxuIgogICAgICAgICAgICAiIGNhbGwuZm9vLmJhcigpLFxuIgogICAgICAgICAgICAiIGNhbGwuZm9vLmJhcigpLmJheignZmlzaCcsIGNhdD0nZG9nJyldIgogICAgICAgICkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN0cihtb2NrLm1vY2tfY2FsbHMpLCBleHBlY3RlZCkKCgogICAgZGVmIHRlc3RfcHJvcGVydHltb2NrKHNlbGYpOgogICAgICAgIHAgPSBwYXRjaCgnJXMuU29tZUNsYXNzLm9uZScgJSBfX25hbWVfXywgbmV3X2NhbGxhYmxlPVByb3BlcnR5TW9jaykKICAgICAgICBtb2NrID0gcC5zdGFydCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBTb21lQ2xhc3Mub25lCiAgICAgICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoKQoKICAgICAgICAgICAgcyA9IFNvbWVDbGFzcygpCiAgICAgICAgICAgIHMub25lCiAgICAgICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF93aXRoKCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1vY2tfY2FsbHMsIFtjYWxsKCksIGNhbGwoKV0pCgogICAgICAgICAgICBzLm9uZSA9IDMKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1vY2tfY2FsbHMsIFtjYWxsKCksIGNhbGwoKSwgY2FsbCgzKV0pCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgcC5zdG9wKCkKCgogICAgZGVmIHRlc3RfcHJvcGVydHltb2NrX3JldHVybnZhbHVlKHNlbGYpOgogICAgICAgIG0gPSBNYWdpY01vY2soKQogICAgICAgIHAgPSBQcm9wZXJ0eU1vY2soKQogICAgICAgIHR5cGUobSkuZm9vID0gcAoKICAgICAgICByZXR1cm5lZCA9IG0uZm9vCiAgICAgICAgcC5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCgpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKHJldHVybmVkLCBNYWdpY01vY2spCiAgICAgICAgc2VsZi5hc3NlcnROb3RJc0luc3RhbmNlKHJldHVybmVkLCBQcm9wZXJ0eU1vY2spCgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIHVuaXR0ZXN0Lm1haW4oKQo=',
'/Lib/unittest/test/testmock/testmagicmethods.py':'aW1wb3J0IHVuaXR0ZXN0CmltcG9ydCBpbnNwZWN0CmltcG9ydCBzeXMKZnJvbSB1bml0dGVzdC5tb2NrIGltcG9ydCBNb2NrLCBNYWdpY01vY2ssIF9tYWdpY3MKCgoKY2xhc3MgVGVzdE1vY2tpbmdNYWdpY01ldGhvZHModW5pdHRlc3QuVGVzdENhc2UpOgoKICAgIGRlZiB0ZXN0X2RlbGV0aW5nX21hZ2ljX21ldGhvZHMoc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoaGFzYXR0cihtb2NrLCAnX19nZXRpdGVtX18nKSkKCiAgICAgICAgbW9jay5fX2dldGl0ZW1fXyA9IE1vY2soKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShoYXNhdHRyKG1vY2ssICdfX2dldGl0ZW1fXycpKQoKICAgICAgICBkZWwgbW9jay5fX2dldGl0ZW1fXwogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoaGFzYXR0cihtb2NrLCAnX19nZXRpdGVtX18nKSkKCgogICAgZGVmIHRlc3RfbWFnaWNtb2NrX2RlbChzZWxmKToKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKICAgICAgICAjIGJlZm9yZSB1c2luZyBnZXRpdGVtCiAgICAgICAgZGVsIG1vY2suX19nZXRpdGVtX18KICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGxhbWJkYTogbW9ja1snZm9vJ10pCgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgICMgdGhpcyB0aW1lIHVzZSBpdCBmaXJzdAogICAgICAgIG1vY2tbJ2ZvbyddCiAgICAgICAgZGVsIG1vY2suX19nZXRpdGVtX18KICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGxhbWJkYTogbW9ja1snZm9vJ10pCgoKICAgIGRlZiB0ZXN0X21hZ2ljX21ldGhvZF93cmFwcGluZyhzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgZGVmIGYoc2VsZiwgbmFtZSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLCAnZmlzaCcKCiAgICAgICAgbW9jay5fX2dldGl0ZW1fXyA9IGYKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKG1vY2suX19nZXRpdGVtX18gaXMgZikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2tbJ2ZvbyddLCAobW9jaywgJ2Zpc2gnKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suX19nZXRpdGVtX18oJ2ZvbycpLCAobW9jaywgJ2Zpc2gnKSkKCiAgICAgICAgbW9jay5fX2dldGl0ZW1fXyA9IG1vY2sKICAgICAgICBzZWxmLmFzc2VydFRydWUobW9jay5fX2dldGl0ZW1fXyBpcyBtb2NrKQoKCiAgICBkZWYgdGVzdF9tYWdpY19tZXRob2RzX2lzb2xhdGVkX2JldHdlZW5fbW9ja3Moc2VsZik6CiAgICAgICAgbW9jazEgPSBNb2NrKCkKICAgICAgICBtb2NrMiA9IE1vY2soKQoKICAgICAgICBtb2NrMS5fX2l0ZXJfXyA9IE1vY2socmV0dXJuX3ZhbHVlPWl0ZXIoW10pKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChtb2NrMSksIFtdKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBsaXN0KG1vY2syKSkKCgogICAgZGVmIHRlc3RfcmVwcihzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXByKG1vY2spLCAiPE1vY2sgaWQ9JyVzJz4iICUgaWQobW9jaykpCiAgICAgICAgbW9jay5fX3JlcHJfXyA9IGxhbWJkYSBzOiAnZm9vJwogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVwcihtb2NrKSwgJ2ZvbycpCgoKICAgIGRlZiB0ZXN0X3N0cihzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIobW9jayksIG9iamVjdC5fX3N0cl9fKG1vY2spKQogICAgICAgIG1vY2suX19zdHJfXyA9IGxhbWJkYSBzOiAnZm9vJwogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3RyKG1vY2spLCAnZm9vJykKCgogICAgZGVmIHRlc3RfZGljdF9tZXRob2RzKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBsYW1iZGE6IG1vY2tbJ2ZvbyddKQogICAgICAgIGRlZiBfZGVsKCk6CiAgICAgICAgICAgIGRlbCBtb2NrWydmb28nXQogICAgICAgIGRlZiBfc2V0KCk6CiAgICAgICAgICAgIG1vY2tbJ2ZvbyddID0gMwogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgX2RlbCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIF9zZXQpCgogICAgICAgIF9kaWN0ID0ge30KICAgICAgICBkZWYgZ2V0aXRlbShzLCBuYW1lKToKICAgICAgICAgICAgcmV0dXJuIF9kaWN0W25hbWVdCiAgICAgICAgZGVmIHNldGl0ZW0ocywgbmFtZSwgdmFsdWUpOgogICAgICAgICAgICBfZGljdFtuYW1lXSA9IHZhbHVlCiAgICAgICAgZGVmIGRlbGl0ZW0ocywgbmFtZSk6CiAgICAgICAgICAgIGRlbCBfZGljdFtuYW1lXQoKICAgICAgICBtb2NrLl9fc2V0aXRlbV9fID0gc2V0aXRlbQogICAgICAgIG1vY2suX19nZXRpdGVtX18gPSBnZXRpdGVtCiAgICAgICAgbW9jay5fX2RlbGl0ZW1fXyA9IGRlbGl0ZW0KCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoS2V5RXJyb3IsIGxhbWJkYTogbW9ja1snZm9vJ10pCiAgICAgICAgbW9ja1snZm9vJ10gPSAnYmFyJwogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoX2RpY3QsIHsnZm9vJzogJ2Jhcid9KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9ja1snZm9vJ10sICdiYXInKQogICAgICAgIGRlbCBtb2NrWydmb28nXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoX2RpY3QsIHt9KQoKCiAgICBkZWYgdGVzdF9udW1lcmljKHNlbGYpOgogICAgICAgIG9yaWdpbmFsID0gbW9jayA9IE1vY2soKQogICAgICAgIG1vY2sudmFsdWUgPSAwCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBtb2NrICsgMykKCiAgICAgICAgZGVmIGFkZChzZWxmLCBvdGhlcik6CiAgICAgICAgICAgIG1vY2sudmFsdWUgKz0gb3RoZXIKICAgICAgICAgICAgcmV0dXJuIHNlbGYKICAgICAgICBtb2NrLl9fYWRkX18gPSBhZGQKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sgKyAzLCBtb2NrKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay52YWx1ZSwgMykKCiAgICAgICAgZGVsIG1vY2suX19hZGRfXwogICAgICAgIGRlZiBpYWRkKG1vY2spOgogICAgICAgICAgICBtb2NrICs9IDMKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGlhZGQsIG1vY2spCiAgICAgICAgbW9jay5fX2lhZGRfXyA9IGFkZAogICAgICAgIG1vY2sgKz0gNgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jaywgb3JpZ2luYWwpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLnZhbHVlLCA5KQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGxhbWJkYTogMyArIG1vY2spCiAgICAgICAgbW9jay5fX3JhZGRfXyA9IGFkZAogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoNyArIG1vY2ssIG1vY2spCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLnZhbHVlLCAxNikKCgogICAgZGVmIHRlc3RfaGFzaChzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgIyB0ZXN0IGRlbGVnYXRpb24KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGhhc2gobW9jayksIE1vY2suX19oYXNoX18obW9jaykpCgogICAgICAgIGRlZiBfaGFzaChzKToKICAgICAgICAgICAgcmV0dXJuIDMKICAgICAgICBtb2NrLl9faGFzaF9fID0gX2hhc2gKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGhhc2gobW9jayksIDMpCgoKICAgIGRlZiB0ZXN0X25vbnplcm8oc2VsZik6CiAgICAgICAgbSA9IE1vY2soKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShib29sKG0pKQoKICAgICAgICBtLl9fYm9vbF9fID0gbGFtYmRhIHM6IEZhbHNlCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShib29sKG0pKQoKCiAgICBkZWYgdGVzdF9jb21wYXJpc29uKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBkZWYgY29tcChzLCBvKToKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBtb2NrLl9fbHRfXyA9IG1vY2suX19ndF9fID0gbW9jay5fX2xlX18gPSBtb2NrLl9fZ2VfXyA9IGNvbXAKICAgICAgICBzZWxmLiBhc3NlcnRUcnVlKG1vY2sgPCAzKQogICAgICAgIHNlbGYuIGFzc2VydFRydWUobW9jayA+IDMpCiAgICAgICAgc2VsZi4gYXNzZXJ0VHJ1ZShtb2NrIDw9IDMpCiAgICAgICAgc2VsZi4gYXNzZXJ0VHJ1ZShtb2NrID49IDMpCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBNYWdpY01vY2soKSA8IG9iamVjdCgpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBvYmplY3QoKSA8IE1hZ2ljTW9jaygpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBNYWdpY01vY2soKSA8IE1hZ2ljTW9jaygpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBNYWdpY01vY2soKSA+IG9iamVjdCgpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBvYmplY3QoKSA+IE1hZ2ljTW9jaygpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBNYWdpY01vY2soKSA+IE1hZ2ljTW9jaygpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBNYWdpY01vY2soKSA8PSBvYmplY3QoKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGxhbWJkYTogb2JqZWN0KCkgPD0gTWFnaWNNb2NrKCkpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBsYW1iZGE6IE1hZ2ljTW9jaygpIDw9IE1hZ2ljTW9jaygpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbGFtYmRhOiBNYWdpY01vY2soKSA+PSBvYmplY3QoKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGxhbWJkYTogb2JqZWN0KCkgPj0gTWFnaWNNb2NrKCkpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBsYW1iZGE6IE1hZ2ljTW9jaygpID49IE1hZ2ljTW9jaygpKQoKCiAgICBkZWYgdGVzdF9lcXVhbGl0eShzZWxmKToKICAgICAgICBmb3IgbW9jayBpbiBNb2NrKCksIE1hZ2ljTW9jaygpOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sgPT0gbW9jaywgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKG1vY2sgPT0gbW9jaywgYm9vbCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrICE9IG1vY2ssIEZhbHNlKQogICAgICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jayAhPSBtb2NrLCBib29sKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sgPT0gb2JqZWN0KCksIEZhbHNlKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sgIT0gb2JqZWN0KCksIFRydWUpCgogICAgICAgICAgICBkZWYgZXEoc2VsZiwgb3RoZXIpOgogICAgICAgICAgICAgICAgcmV0dXJuIG90aGVyID09IDMKICAgICAgICAgICAgbW9jay5fX2VxX18gPSBlcQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUobW9jayA9PSAzKQogICAgICAgICAgICBzZWxmLmFzc2VydEZhbHNlKG1vY2sgPT0gNCkKCiAgICAgICAgICAgIGRlZiBuZShzZWxmLCBvdGhlcik6CiAgICAgICAgICAgICAgICByZXR1cm4gb3RoZXIgPT0gMwogICAgICAgICAgICBtb2NrLl9fbmVfXyA9IG5lCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShtb2NrICE9IDMpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UobW9jayAhPSA0KQoKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKICAgICAgICBtb2NrLl9fZXFfXy5yZXR1cm5fdmFsdWUgPSBUcnVlCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKG1vY2sgPT0gMywgYm9vbCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sgPT0gMywgVHJ1ZSkKCiAgICAgICAgbW9jay5fX25lX18ucmV0dXJuX3ZhbHVlID0gRmFsc2UKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jayAhPSAzLCBib29sKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jayAhPSAzLCBGYWxzZSkKCgogICAgZGVmIHRlc3RfbGVuX2NvbnRhaW5zX2l0ZXIoc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soKQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGxlbiwgbW9jaykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGl0ZXIsIG1vY2spCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBsYW1iZGE6ICdmb28nIGluIG1vY2spCgogICAgICAgIG1vY2suX19sZW5fXyA9IGxhbWJkYSBzOiA2CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4obW9jayksIDYpCgogICAgICAgIG1vY2suX19jb250YWluc19fID0gbGFtYmRhIHMsIG86IG8gPT0gMwogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZSgzIGluIG1vY2spCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZSg2IGluIG1vY2spCgogICAgICAgIG1vY2suX19pdGVyX18gPSBsYW1iZGEgczogaXRlcignZm9vYmFyYmF6JykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3QobW9jayksIGxpc3QoJ2Zvb2JhcmJheicpKQoKCiAgICBkZWYgdGVzdF9tYWdpY21vY2soc2VsZik6CiAgICAgICAgbW9jayA9IE1hZ2ljTW9jaygpCgogICAgICAgIG1vY2suX19pdGVyX18ucmV0dXJuX3ZhbHVlID0gaXRlcihbMSwgMiwgM10pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KG1vY2spLCBbMSwgMiwgM10pCgogICAgICAgIGdldGF0dHIobW9jaywgJ19fYm9vbF9fJykucmV0dXJuX3ZhbHVlID0gRmFsc2UKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKGhhc2F0dHIobW9jaywgJ19fbm9uemVyb19fJykpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShib29sKG1vY2spKQoKICAgICAgICBmb3IgZW50cnkgaW4gX21hZ2ljczoKICAgICAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGhhc2F0dHIobW9jaywgZW50cnkpKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoaGFzYXR0cihtb2NrLCAnX19pbWFnaW5lcnlfXycpKQoKCiAgICBkZWYgdGVzdF9tYWdpY19tb2NrX2VxdWFsaXR5KHNlbGYpOgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrID09IG9iamVjdCgpLCBib29sKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrICE9IG9iamVjdCgpLCBib29sKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sgPT0gb2JqZWN0KCksIEZhbHNlKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jayAhPSBvYmplY3QoKSwgVHJ1ZSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sgPT0gbW9jaywgVHJ1ZSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sgIT0gbW9jaywgRmFsc2UpCgoKICAgIGRlZiB0ZXN0X21hZ2ljbW9ja19kZWZhdWx0cyhzZWxmKToKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGludChtb2NrKSwgMSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGNvbXBsZXgobW9jayksIDFqKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZmxvYXQobW9jayksIDEuMCkKICAgICAgICBzZWxmLmFzc2VydE5vdEluKG9iamVjdCgpLCBtb2NrKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKG1vY2spLCAwKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChtb2NrKSwgW10pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChoYXNoKG1vY2spLCBvYmplY3QuX19oYXNoX18obW9jaykpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIobW9jayksIG9iamVjdC5fX3N0cl9fKG1vY2spKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShib29sKG1vY2spKQoKICAgICAgICAjIGluIFB5dGhvbiAzIG9jdCBhbmQgaGV4IHVzZSBfX2luZGV4X18KICAgICAgICAjIHNvIHRoZXNlIHRlc3RzIGFyZSBmb3IgX19pbmRleF9fIGluIHB5M2sKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG9jdChtb2NrKSwgJzBvMScpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChoZXgobW9jayksICcweDEnKQogICAgICAgICMgaG93IHRvIHRlc3QgX19zaXplb2ZfXyA/CgoKICAgIGRlZiB0ZXN0X21hZ2ljX21ldGhvZHNfYW5kX3NwZWMoc2VsZik6CiAgICAgICAgY2xhc3MgSXRlcmFibGUob2JqZWN0KToKICAgICAgICAgICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICBtb2NrID0gTW9jayhzcGVjPUl0ZXJhYmxlKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBsYW1iZGE6IG1vY2suX19pdGVyX18pCgogICAgICAgIG1vY2suX19pdGVyX18gPSBNb2NrKHJldHVybl92YWx1ZT1pdGVyKFtdKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3QobW9jayksIFtdKQoKICAgICAgICBjbGFzcyBOb25JdGVyYWJsZShvYmplY3QpOgogICAgICAgICAgICBwYXNzCiAgICAgICAgbW9jayA9IE1vY2soc3BlYz1Ob25JdGVyYWJsZSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgbGFtYmRhOiBtb2NrLl9faXRlcl9fKQoKICAgICAgICBkZWYgc2V0X2ludCgpOgogICAgICAgICAgICBtb2NrLl9faW50X18gPSBNb2NrKHJldHVybl92YWx1ZT1pdGVyKFtdKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgc2V0X2ludCkKCiAgICAgICAgbW9jayA9IE1hZ2ljTW9jayhzcGVjPUl0ZXJhYmxlKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChtb2NrKSwgW10pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIHNldF9pbnQpCgoKICAgIGRlZiB0ZXN0X21hZ2ljX21ldGhvZHNfYW5kX3NwZWNfc2V0KHNlbGYpOgogICAgICAgIGNsYXNzIEl0ZXJhYmxlKG9iamVjdCk6CiAgICAgICAgICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgbW9jayA9IE1vY2soc3BlY19zZXQ9SXRlcmFibGUpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGxhbWJkYTogbW9jay5fX2l0ZXJfXykKCiAgICAgICAgbW9jay5fX2l0ZXJfXyA9IE1vY2socmV0dXJuX3ZhbHVlPWl0ZXIoW10pKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGlzdChtb2NrKSwgW10pCgogICAgICAgIGNsYXNzIE5vbkl0ZXJhYmxlKG9iamVjdCk6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBtb2NrID0gTW9jayhzcGVjX3NldD1Ob25JdGVyYWJsZSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgbGFtYmRhOiBtb2NrLl9faXRlcl9fKQoKICAgICAgICBkZWYgc2V0X2ludCgpOgogICAgICAgICAgICBtb2NrLl9faW50X18gPSBNb2NrKHJldHVybl92YWx1ZT1pdGVyKFtdKSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgc2V0X2ludCkKCiAgICAgICAgbW9jayA9IE1hZ2ljTW9jayhzcGVjX3NldD1JdGVyYWJsZSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxpc3QobW9jayksIFtdKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBzZXRfaW50KQoKCiAgICBkZWYgdGVzdF9zZXR0aW5nX3Vuc3VwcG9ydGVkX21hZ2ljX21ldGhvZChzZWxmKToKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKICAgICAgICBkZWYgc2V0X3NldGF0dHIoKToKICAgICAgICAgICAgbW9jay5fX3NldGF0dHJfXyA9IGxhbWJkYSBzZWxmLCBuYW1lOiBOb25lCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXNSZWdleChBdHRyaWJ1dGVFcnJvciwKICAgICAgICAgICAgIkF0dGVtcHRpbmcgdG8gc2V0IHVuc3VwcG9ydGVkIG1hZ2ljIG1ldGhvZCAnX19zZXRhdHRyX18nLiIsCiAgICAgICAgICAgIHNldF9zZXRhdHRyCiAgICAgICAgKQoKCiAgICBkZWYgdGVzdF9hdHRyaWJ1dGVzX2FuZF9yZXR1cm5fdmFsdWUoc2VsZik6CiAgICAgICAgbW9jayA9IE1hZ2ljTW9jaygpCiAgICAgICAgYXR0ciA9IG1vY2suZm9vCiAgICAgICAgZGVmIF9nZXRfdHlwZShvYmopOgogICAgICAgICAgICAjIHRoZSB0eXBlIG9mIGV2ZXJ5IG1vY2sgKG9yIG1hZ2ljbW9jaykgaXMgYSBjdXN0b20gc3ViY2xhc3MKICAgICAgICAgICAgIyBzbyB0aGUgcmVhbCB0eXBlIGlzIHRoZSBzZWNvbmQgaW4gdGhlIG1ybwogICAgICAgICAgICByZXR1cm4gdHlwZShvYmopLl9fbXJvX19bMV0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKF9nZXRfdHlwZShhdHRyKSwgTWFnaWNNb2NrKQoKICAgICAgICByZXR1cm5lZCA9IG1vY2soKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoX2dldF90eXBlKHJldHVybmVkKSwgTWFnaWNNb2NrKQoKCiAgICBkZWYgdGVzdF9tYWdpY19tZXRob2RzX2FyZV9tYWdpY19tb2NrcyhzZWxmKToKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jay5fX2dldGl0ZW1fXywgTWFnaWNNb2NrKQoKICAgICAgICBtb2NrWzFdWzJdLl9fZ2V0aXRlbV9fLnJldHVybl92YWx1ZSA9IDMKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2tbMV1bMl1bM10sIDMpCgoKICAgIGRlZiB0ZXN0X21hZ2ljX21ldGhvZF9yZXNldF9tb2NrKHNlbGYpOgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgIHN0cihtb2NrKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShtb2NrLl9fc3RyX18uY2FsbGVkKQogICAgICAgIG1vY2sucmVzZXRfbW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShtb2NrLl9fc3RyX18uY2FsbGVkKQoKCiAgICBkZWYgdGVzdF9kaXIoc2VsZik6CiAgICAgICAgIyBvdmVycmlkaW5nIHRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uCiAgICAgICAgZm9yIG1vY2sgaW4gTW9jaygpLCBNYWdpY01vY2soKToKICAgICAgICAgICAgZGVmIF9kaXIoc2VsZik6CiAgICAgICAgICAgICAgICByZXR1cm4gWydmb28nXQogICAgICAgICAgICBtb2NrLl9fZGlyX18gPSBfZGlyCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZGlyKG1vY2spLCBbJ2ZvbyddKQoKCiAgICBAdW5pdHRlc3Quc2tpcElmKCdQeVB5JyBpbiBzeXMudmVyc2lvbiwgIlRoaXMgZmFpbHMgZGlmZmVyZW50bHkgb24gcHlweSIpCiAgICBkZWYgdGVzdF9ib3VuZF9tZXRob2RzKHNlbGYpOgogICAgICAgIG0gPSBNb2NrKCkKCiAgICAgICAgIyBYWFhYIHNob3VsZCB0aGlzIGJlIGFuIGV4cGVjdGVkIGZhaWx1cmUgaW5zdGVhZD8KCiAgICAgICAgIyB0aGlzIHNlZW1zIGxpa2UgaXQgc2hvdWxkIHdvcmssIGJ1dCBpcyBoYXJkIHRvIGRvIHdpdGhvdXQgaW50cm9kdWNpbmcKICAgICAgICAjIG90aGVyIGFwaSBpbmNvbnNpc3RlbmNpZXMuIEZhaWx1cmUgbWVzc2FnZSBjb3VsZCBiZSBiZXR0ZXIgdGhvdWdoLgogICAgICAgIG0uX19pdGVyX18gPSBbM10uX19pdGVyX18KICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGl0ZXIsIG0pCgoKICAgIGRlZiB0ZXN0X21hZ2ljX21ldGhvZF90eXBlKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyhNYWdpY01vY2spOgogICAgICAgICAgICBwYXNzCgogICAgICAgIGZvbyA9IEZvbygpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGZvby5fX2ludF9fLCBGb28pCgoKICAgIGRlZiB0ZXN0X2Rlc2NyaXB0b3JfZnJvbV9jbGFzcyhzZWxmKToKICAgICAgICBtID0gTWFnaWNNb2NrKCkKICAgICAgICB0eXBlKG0pLl9fc3RyX18ucmV0dXJuX3ZhbHVlID0gJ2ZvbycKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHN0cihtKSwgJ2ZvbycpCgoKICAgIGRlZiB0ZXN0X2l0ZXJhYmxlX2FzX2l0ZXJfcmV0dXJuX3ZhbHVlKHNlbGYpOgogICAgICAgIG0gPSBNYWdpY01vY2soKQogICAgICAgIG0uX19pdGVyX18ucmV0dXJuX3ZhbHVlID0gWzEsIDIsIDNdCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KG0pLCBbMSwgMiwgM10pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KG0pLCBbMSwgMiwgM10pCgogICAgICAgIG0uX19pdGVyX18ucmV0dXJuX3ZhbHVlID0gaXRlcihbNCwgNSwgNl0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KG0pLCBbNCwgNSwgNl0pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsaXN0KG0pLCBbXSkKCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgdW5pdHRlc3QubWFpbigpCg==',
'/Lib/unittest/test/testmock/testmock.py':'aW1wb3J0IGNvcHkKaW1wb3J0IHN5cwoKaW1wb3J0IHVuaXR0ZXN0CmZyb20gdW5pdHRlc3QudGVzdC50ZXN0bW9jay5zdXBwb3J0IGltcG9ydCBpc19pbnN0YW5jZQpmcm9tIHVuaXR0ZXN0IGltcG9ydCBtb2NrCmZyb20gdW5pdHRlc3QubW9jayBpbXBvcnQgKAogICAgY2FsbCwgREVGQVVMVCwgcGF0Y2gsIHNlbnRpbmVsLAogICAgTWFnaWNNb2NrLCBNb2NrLCBOb25DYWxsYWJsZU1vY2ssCiAgICBOb25DYWxsYWJsZU1hZ2ljTW9jaywgX0NhbGxMaXN0LAogICAgY3JlYXRlX2F1dG9zcGVjCikKCgpjbGFzcyBJdGVyKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi50aGluZyA9IGl0ZXIoWyd0aGlzJywgJ2lzJywgJ2FuJywgJ2l0ZXInXSkKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgbmV4dChzZWxmKToKICAgICAgICByZXR1cm4gbmV4dChzZWxmLnRoaW5nKQoKICAgIF9fbmV4dF9fID0gbmV4dAoKCgpjbGFzcyBNb2NrVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIHRlc3RfYWxsKHNlbGYpOgogICAgICAgICMgaWYgX19hbGxfXyBpcyBiYWRseSBkZWZpbmVkIHRoZW4gaW1wb3J0ICogd2lsbCByYWlzZSBhbiBlcnJvcgogICAgICAgICMgV2UgaGF2ZSB0byBleGVjIGl0IGJlY2F1c2UgeW91IGNhbid0IGltcG9ydCAqIGluc2lkZSBhIG1ldGhvZAogICAgICAgICMgaW4gUHl0aG9uIDMKICAgICAgICBleGVjKCJmcm9tIHVuaXR0ZXN0Lm1vY2sgaW1wb3J0ICoiKQoKCiAgICBkZWYgdGVzdF9jb25zdHJ1Y3RvcihzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCgogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UobW9jay5jYWxsZWQsICJjYWxsZWQgbm90IGluaXRpYWxpc2VkIGNvcnJlY3RseSIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmNhbGxfY291bnQsIDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAiY2FsbF9jb3VudCBub3QgaW5pdGlhbGlzZWQgY29ycmVjdGx5IikKICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UobW9jay5yZXR1cm5fdmFsdWUsIE1vY2spLAogICAgICAgICAgICAgICAgICAgICAgICAicmV0dXJuX3ZhbHVlIG5vdCBpbml0aWFsaXNlZCBjb3JyZWN0bHkiKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suY2FsbF9hcmdzLCBOb25lLAogICAgICAgICAgICAgICAgICAgICAgICAgImNhbGxfYXJncyBub3QgaW5pdGlhbGlzZWQgY29ycmVjdGx5IikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suY2FsbF9hcmdzX2xpc3QsIFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgImNhbGxfYXJnc19saXN0IG5vdCBpbml0aWFsaXNlZCBjb3JyZWN0bHkiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tZXRob2RfY2FsbHMsIFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgICJtZXRob2RfY2FsbHMgbm90IGluaXRpYWxpc2VkIGNvcnJlY3RseSIpCgogICAgICAgICMgQ2FuJ3QgdXNlIGhhc2F0dHIgZm9yIHRoaXMgdGVzdCBhcyBpdCBhbHdheXMgcmV0dXJucyBUcnVlIG9uIGEgbW9jawogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoJ19pdGVtcycgaW4gbW9jay5fX2RpY3RfXywKICAgICAgICAgICAgICAgICAgICAgICAgICJkZWZhdWx0IG1vY2sgc2hvdWxkIG5vdCBoYXZlICdfaXRlbXMnIGF0dHJpYnV0ZSIpCgogICAgICAgIHNlbGYuYXNzZXJ0SXNOb25lKG1vY2suX21vY2tfcGFyZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICJwYXJlbnQgbm90IGluaXRpYWxpc2VkIGNvcnJlY3RseSIpCiAgICAgICAgc2VsZi5hc3NlcnRJc05vbmUobW9jay5fbW9ja19tZXRob2RzLAogICAgICAgICAgICAgICAgICAgICAgICAgICJtZXRob2RzIG5vdCBpbml0aWFsaXNlZCBjb3JyZWN0bHkiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5fbW9ja19jaGlsZHJlbiwge30sCiAgICAgICAgICAgICAgICAgICAgICAgICAiY2hpbGRyZW4gbm90IGluaXRpYWxpc2VkIGluY29ycmVjdGx5IikKCgogICAgZGVmIHRlc3RfcmV0dXJuX3ZhbHVlX2luX2NvbnN0cnVjdG9yKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKHJldHVybl92YWx1ZT1Ob25lKQogICAgICAgIHNlbGYuYXNzZXJ0SXNOb25lKG1vY2sucmV0dXJuX3ZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICJyZXR1cm4gdmFsdWUgaW4gY29uc3RydWN0b3Igbm90IGhvbm91cmVkIikKCgogICAgZGVmIHRlc3RfcmVwcihzZWxmKToKICAgICAgICBtb2NrID0gTW9jayhuYW1lPSdmb28nKQogICAgICAgIHNlbGYuYXNzZXJ0SW4oJ2ZvbycsIHJlcHIobW9jaykpCiAgICAgICAgc2VsZi5hc3NlcnRJbigiJyVzJyIgJSBpZChtb2NrKSwgcmVwcihtb2NrKSkKCiAgICAgICAgbW9ja3MgPSBbKE1vY2soKSwgJ21vY2snKSwgKE1vY2sobmFtZT0nYmFyJyksICdiYXInKV0KICAgICAgICBmb3IgbW9jaywgbmFtZSBpbiBtb2NrczoKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbignJXMuYmFyJyAlIG5hbWUsIHJlcHIobW9jay5iYXIpKQogICAgICAgICAgICBzZWxmLmFzc2VydEluKCclcy5mb28oKScgJSBuYW1lLCByZXByKG1vY2suZm9vKCkpKQogICAgICAgICAgICBzZWxmLmFzc2VydEluKCclcy5mb28oKS5iaW5nJyAlIG5hbWUsIHJlcHIobW9jay5mb28oKS5iaW5nKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbignJXMoKScgJSBuYW1lLCByZXByKG1vY2soKSkpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SW4oJyVzKCkoKScgJSBuYW1lLCByZXByKG1vY2soKSgpKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbignJXMoKSgpLmZvby5iYXIuYmF6KCkuYmluZycgJSBuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgIHJlcHIobW9jaygpKCkuZm9vLmJhci5iYXooKS5iaW5nKSkKCgogICAgZGVmIHRlc3RfcmVwcl93aXRoX3NwZWMoc2VsZik6CiAgICAgICAgY2xhc3MgWChvYmplY3QpOgogICAgICAgICAgICBwYXNzCgogICAgICAgIG1vY2sgPSBNb2NrKHNwZWM9WCkKICAgICAgICBzZWxmLmFzc2VydEluKCIgc3BlYz0nWCcgIiwgcmVwcihtb2NrKSkKCiAgICAgICAgbW9jayA9IE1vY2soc3BlYz1YKCkpCiAgICAgICAgc2VsZi5hc3NlcnRJbigiIHNwZWM9J1gnICIsIHJlcHIobW9jaykpCgogICAgICAgIG1vY2sgPSBNb2NrKHNwZWNfc2V0PVgpCiAgICAgICAgc2VsZi5hc3NlcnRJbigiIHNwZWNfc2V0PSdYJyAiLCByZXByKG1vY2spKQoKICAgICAgICBtb2NrID0gTW9jayhzcGVjX3NldD1YKCkpCiAgICAgICAgc2VsZi5hc3NlcnRJbigiIHNwZWNfc2V0PSdYJyAiLCByZXByKG1vY2spKQoKICAgICAgICBtb2NrID0gTW9jayhzcGVjPVgsIG5hbWU9J2ZvbycpCiAgICAgICAgc2VsZi5hc3NlcnRJbigiIHNwZWM9J1gnICIsIHJlcHIobW9jaykpCiAgICAgICAgc2VsZi5hc3NlcnRJbigiIG5hbWU9J2ZvbycgIiwgcmVwcihtb2NrKSkKCiAgICAgICAgbW9jayA9IE1vY2sobmFtZT0nZm9vJykKICAgICAgICBzZWxmLmFzc2VydE5vdEluKCJzcGVjIiwgcmVwcihtb2NrKSkKCiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90SW4oInNwZWMiLCByZXByKG1vY2spKQoKICAgICAgICBtb2NrID0gTW9jayhzcGVjPVsnZm9vJ10pCiAgICAgICAgc2VsZi5hc3NlcnROb3RJbigic3BlYyIsIHJlcHIobW9jaykpCgoKICAgIGRlZiB0ZXN0X3NpZGVfZWZmZWN0KHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKCiAgICAgICAgZGVmIGVmZmVjdCgqYXJncywgKiprd2FyZ3MpOgogICAgICAgICAgICByYWlzZSBTeXN0ZW1FcnJvcigna2FibG9vaWUnKQoKICAgICAgICBtb2NrLnNpZGVfZWZmZWN0ID0gZWZmZWN0CiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoU3lzdGVtRXJyb3IsIG1vY2ssIDEsIDIsIGZpc2g9MykKICAgICAgICBtb2NrLmFzc2VydF9jYWxsZWRfd2l0aCgxLCAyLCBmaXNoPTMpCgogICAgICAgIHJlc3VsdHMgPSBbMSwgMiwgM10KICAgICAgICBkZWYgZWZmZWN0KCk6CiAgICAgICAgICAgIHJldHVybiByZXN1bHRzLnBvcCgpCiAgICAgICAgbW9jay5zaWRlX2VmZmVjdCA9IGVmZmVjdAoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFttb2NrKCksIG1vY2soKSwgbW9jaygpXSwgWzMsIDIsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICJzaWRlIGVmZmVjdCBub3QgdXNlZCBjb3JyZWN0bHkiKQoKICAgICAgICBtb2NrID0gTW9jayhzaWRlX2VmZmVjdD1zZW50aW5lbC5TaWRlRWZmZWN0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5zaWRlX2VmZmVjdCwgc2VudGluZWwuU2lkZUVmZmVjdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAic2lkZSBlZmZlY3QgaW4gY29uc3RydWN0b3Igbm90IHVzZWQiKQoKICAgICAgICBkZWYgc2lkZV9lZmZlY3QoKToKICAgICAgICAgICAgcmV0dXJuIERFRkFVTFQKICAgICAgICBtb2NrID0gTW9jayhzaWRlX2VmZmVjdD1zaWRlX2VmZmVjdCwgcmV0dXJuX3ZhbHVlPXNlbnRpbmVsLlJFVFVSTikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2soKSwgc2VudGluZWwuUkVUVVJOKQoKCiAgICBAdW5pdHRlc3Quc2tpcFVubGVzcygnamF2YScgaW4gc3lzLnBsYXRmb3JtLAogICAgICAgICAgICAgICAgICAgICAgICAgICdUaGlzIHRlc3Qgb25seSBhcHBsaWVzIHRvIEp5dGhvbicpCiAgICBkZWYgdGVzdF9qYXZhX2V4Y2VwdGlvbl9zaWRlX2VmZmVjdChzZWxmKToKICAgICAgICBpbXBvcnQgamF2YQogICAgICAgIG1vY2sgPSBNb2NrKHNpZGVfZWZmZWN0PWphdmEubGFuZy5SdW50aW1lRXhjZXB0aW9uKCJCb29tISIpKQoKICAgICAgICAjIGNhbid0IHVzZSBhc3NlcnRSYWlzZXMgd2l0aCBqYXZhIGV4Y2VwdGlvbnMKICAgICAgICB0cnk6CiAgICAgICAgICAgIG1vY2soMSwgMiwgZmlzaD0zKQogICAgICAgIGV4Y2VwdCBqYXZhLmxhbmcuUnVudGltZUV4Y2VwdGlvbjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgnamF2YSBleGNlcHRpb24gbm90IHJhaXNlZCcpCiAgICAgICAgbW9jay5hc3NlcnRfY2FsbGVkX3dpdGgoMSwyLCBmaXNoPTMpCgoKICAgIGRlZiB0ZXN0X3Jlc2V0X21vY2soc2VsZik6CiAgICAgICAgcGFyZW50ID0gTW9jaygpCiAgICAgICAgc3BlYyA9IFsic29tZXRoaW5nIl0KICAgICAgICBtb2NrID0gTW9jayhuYW1lPSJjaGlsZCIsIHBhcmVudD1wYXJlbnQsIHNwZWM9c3BlYykKICAgICAgICBtb2NrKHNlbnRpbmVsLlNvbWV0aGluZywgc29tZXRoaW5nPXNlbnRpbmVsLlNvbWV0aGluZ0Vsc2UpCiAgICAgICAgc29tZXRoaW5nID0gbW9jay5zb21ldGhpbmcKICAgICAgICBtb2NrLnNvbWV0aGluZygpCiAgICAgICAgbW9jay5zaWRlX2VmZmVjdCA9IHNlbnRpbmVsLlNpZGVFZmZlY3QKICAgICAgICByZXR1cm5fdmFsdWUgPSBtb2NrLnJldHVybl92YWx1ZQogICAgICAgIHJldHVybl92YWx1ZSgpCgogICAgICAgIG1vY2sucmVzZXRfbW9jaygpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5fbW9ja19uYW1lLCAiY2hpbGQiLAogICAgICAgICAgICAgICAgICAgICAgICAgIm5hbWUgaW5jb3JyZWN0bHkgcmVzZXQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5fbW9ja19wYXJlbnQsIHBhcmVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICJwYXJlbnQgaW5jb3JyZWN0bHkgcmVzZXQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5fbW9ja19tZXRob2RzLCBzcGVjLAogICAgICAgICAgICAgICAgICAgICAgICAgIm1ldGhvZHMgaW5jb3JyZWN0bHkgcmVzZXQiKQoKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKG1vY2suY2FsbGVkLCAiY2FsbGVkIG5vdCByZXNldCIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmNhbGxfY291bnQsIDAsICJjYWxsX2NvdW50IG5vdCByZXNldCIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmNhbGxfYXJncywgTm9uZSwgImNhbGxfYXJncyBub3QgcmVzZXQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5jYWxsX2FyZ3NfbGlzdCwgW10sICJjYWxsX2FyZ3NfbGlzdCBub3QgcmVzZXQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tZXRob2RfY2FsbHMsIFtdLAogICAgICAgICAgICAgICAgICAgICAgICAibWV0aG9kX2NhbGxzIG5vdCBpbml0aWFsaXNlZCBjb3JyZWN0bHk6ICVyICE9ICVyIiAlCiAgICAgICAgICAgICAgICAgICAgICAgIChtb2NrLm1ldGhvZF9jYWxscywgW10pKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tb2NrX2NhbGxzLCBbXSkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLnNpZGVfZWZmZWN0LCBzZW50aW5lbC5TaWRlRWZmZWN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICJzaWRlX2VmZmVjdCBpbmNvcnJlY3RseSByZXNldCIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLnJldHVybl92YWx1ZSwgcmV0dXJuX3ZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICJyZXR1cm5fdmFsdWUgaW5jb3JyZWN0bHkgcmVzZXQiKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UocmV0dXJuX3ZhbHVlLmNhbGxlZCwgInJldHVybiB2YWx1ZSBtb2NrIG5vdCByZXNldCIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLl9tb2NrX2NoaWxkcmVuLCB7J3NvbWV0aGluZyc6IHNvbWV0aGluZ30sCiAgICAgICAgICAgICAgICAgICAgICAgICAgImNoaWxkcmVuIHJlc2V0IGluY29ycmVjdGx5IikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suc29tZXRoaW5nLCBzb21ldGhpbmcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgImNoaWxkcmVuIGluY29ycmVjdGx5IGNsZWFyZWQiKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UobW9jay5zb21ldGhpbmcuY2FsbGVkLCAiY2hpbGQgbm90IHJlc2V0IikKCgogICAgZGVmIHRlc3RfcmVzZXRfbW9ja19yZWN1cnNpb24oc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2sucmV0dXJuX3ZhbHVlID0gbW9jawoKICAgICAgICAjIHVzZWQgdG8gY2F1c2UgcmVjdXJzaW9uCiAgICAgICAgbW9jay5yZXNldF9tb2NrKCkKCgogICAgZGVmIHRlc3RfY2FsbChzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzX2luc3RhbmNlKG1vY2sucmV0dXJuX3ZhbHVlLCBNb2NrKSwKICAgICAgICAgICAgICAgICAgICAgICAgIkRlZmF1bHQgcmV0dXJuX3ZhbHVlIHNob3VsZCBiZSBhIE1vY2siKQoKICAgICAgICByZXN1bHQgPSBtb2NrKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2soKSwgcmVzdWx0LAogICAgICAgICAgICAgICAgICAgICAgICAgImRpZmZlcmVudCByZXN1bHQgZnJvbSBjb25zZWN1dGl2ZSBjYWxscyIpCiAgICAgICAgbW9jay5yZXNldF9tb2NrKCkKCiAgICAgICAgcmV0X3ZhbCA9IG1vY2soc2VudGluZWwuQXJnKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShtb2NrLmNhbGxlZCwgImNhbGxlZCBub3Qgc2V0IikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suY2FsbF9jb3VudCwgMSwgImNhbGxfY291bnQgaW5jb3JlZWN0IikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suY2FsbF9hcmdzLCAoKHNlbnRpbmVsLkFyZywpLCB7fSksCiAgICAgICAgICAgICAgICAgICAgICAgICAiY2FsbF9hcmdzIG5vdCBzZXQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5jYWxsX2FyZ3NfbGlzdCwgWygoc2VudGluZWwuQXJnLCksIHt9KV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAiY2FsbF9hcmdzX2xpc3Qgbm90IGluaXRpYWxpc2VkIGNvcnJlY3RseSIpCgogICAgICAgIG1vY2sucmV0dXJuX3ZhbHVlID0gc2VudGluZWwuUmV0dXJuVmFsdWUKICAgICAgICByZXRfdmFsID0gbW9jayhzZW50aW5lbC5BcmcsIGtleT1zZW50aW5lbC5LZXlBcmcpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXRfdmFsLCBzZW50aW5lbC5SZXR1cm5WYWx1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICJpbmNvcnJlY3QgcmV0dXJuIHZhbHVlIikKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmNhbGxfY291bnQsIDIsICJjYWxsX2NvdW50IGluY29ycmVjdCIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmNhbGxfYXJncywKICAgICAgICAgICAgICAgICAgICAgICAgICgoc2VudGluZWwuQXJnLCksIHsna2V5Jzogc2VudGluZWwuS2V5QXJnfSksCiAgICAgICAgICAgICAgICAgICAgICAgICAiY2FsbF9hcmdzIG5vdCBzZXQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5jYWxsX2FyZ3NfbGlzdCwgWwogICAgICAgICAgICAoKHNlbnRpbmVsLkFyZywpLCB7fSksCiAgICAgICAgICAgICgoc2VudGluZWwuQXJnLCksIHsna2V5Jzogc2VudGluZWwuS2V5QXJnfSkKICAgICAgICBdLAogICAgICAgICAgICAiY2FsbF9hcmdzX2xpc3Qgbm90IHNldCIpCgoKICAgIGRlZiB0ZXN0X2NhbGxfYXJnc19jb21wYXJpc29uKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrKCkKICAgICAgICBtb2NrKHNlbnRpbmVsLkFyZykKICAgICAgICBtb2NrKGt3PXNlbnRpbmVsLkt3YXJnKQogICAgICAgIG1vY2soc2VudGluZWwuQXJnLCBrdz1zZW50aW5lbC5Ld2FyZykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suY2FsbF9hcmdzX2xpc3QsIFsKICAgICAgICAgICAgKCksCiAgICAgICAgICAgICgoc2VudGluZWwuQXJnLCksKSwKICAgICAgICAgICAgKHsia3ciOiBzZW50aW5lbC5Ld2FyZ30sKSwKICAgICAgICAgICAgKChzZW50aW5lbC5BcmcsKSwgeyJrdyI6IHNlbnRpbmVsLkt3YXJnfSkKICAgICAgICBdKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5jYWxsX2FyZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAoKHNlbnRpbmVsLkFyZywpLCB7Imt3Ijogc2VudGluZWwuS3dhcmd9KSkKCgogICAgZGVmIHRlc3RfYXNzZXJ0X2NhbGxlZF93aXRoKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrKCkKCiAgICAgICAgIyBXaWxsIHJhaXNlIGFuIGV4Y2VwdGlvbiBpZiBpdCBmYWlscwogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF93aXRoKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBc3NlcnRpb25FcnJvciwgbW9jay5hc3NlcnRfY2FsbGVkX3dpdGgsIDEpCgogICAgICAgIG1vY2sucmVzZXRfbW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXNzZXJ0aW9uRXJyb3IsIG1vY2suYXNzZXJ0X2NhbGxlZF93aXRoKQoKICAgICAgICBtb2NrKDEsIDIsIDMsIGE9J2Zpc2gnLCBiPSdub3RoaW5nJykKICAgICAgICBtb2NrLmFzc2VydF9jYWxsZWRfd2l0aCgxLCAyLCAzLCBhPSdmaXNoJywgYj0nbm90aGluZycpCgoKICAgIGRlZiB0ZXN0X2Fzc2VydF9jYWxsZWRfb25jZV93aXRoKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrKCkKCiAgICAgICAgIyBXaWxsIHJhaXNlIGFuIGV4Y2VwdGlvbiBpZiBpdCBmYWlscwogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoKQoKICAgICAgICBtb2NrKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBc3NlcnRpb25FcnJvciwgbW9jay5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCkKCiAgICAgICAgbW9jay5yZXNldF9tb2NrKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBc3NlcnRpb25FcnJvciwgbW9jay5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCkKCiAgICAgICAgbW9jaygnZm9vJywgJ2JhcicsIGJhej0yKQogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoJ2ZvbycsICdiYXInLCBiYXo9MikKCiAgICAgICAgbW9jay5yZXNldF9tb2NrKCkKICAgICAgICBtb2NrKCdmb28nLCAnYmFyJywgYmF6PTIpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgIEFzc2VydGlvbkVycm9yLAogICAgICAgICAgICBsYW1iZGE6IG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoJ2JvYicsICdiYXInLCBiYXo9MikKICAgICAgICApCgoKICAgIGRlZiB0ZXN0X2F0dHJpYnV0ZV9hY2Nlc3NfcmV0dXJuc19tb2NrcyhzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgc29tZXRoaW5nID0gbW9jay5zb21ldGhpbmcKICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2Uoc29tZXRoaW5nLCBNb2NrKSwgImF0dHJpYnV0ZSBpc24ndCBhIG1vY2siKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5zb21ldGhpbmcsIHNvbWV0aGluZywKICAgICAgICAgICAgICAgICAgICAgICAgICJkaWZmZXJlbnQgYXR0cmlidXRlcyByZXR1cm5lZCBmb3Igc2FtZSBuYW1lIikKCiAgICAgICAgIyBVc2FnZSBleGFtcGxlCiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2suc29tZXRoaW5nLnJldHVybl92YWx1ZSA9IDMKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLnNvbWV0aGluZygpLCAzLCAibWV0aG9kIHJldHVybmVkIHdyb25nIHZhbHVlIikKICAgICAgICBzZWxmLmFzc2VydFRydWUobW9jay5zb21ldGhpbmcuY2FsbGVkLAogICAgICAgICAgICAgICAgICAgICAgICAibWV0aG9kIGRpZG4ndCByZWNvcmQgYmVpbmcgY2FsbGVkIikKCgogICAgZGVmIHRlc3RfYXR0cmlidXRlc19oYXZlX25hbWVfYW5kX3BhcmVudF9zZXQoc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIHNvbWV0aGluZyA9IG1vY2suc29tZXRoaW5nCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLl9tb2NrX25hbWUsICJzb21ldGhpbmciLAogICAgICAgICAgICAgICAgICAgICAgICAgImF0dHJpYnV0ZSBuYW1lIG5vdCBzZXQgY29ycmVjdGx5IikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNvbWV0aGluZy5fbW9ja19wYXJlbnQsIG1vY2ssCiAgICAgICAgICAgICAgICAgICAgICAgICAiYXR0cmlidXRlIHBhcmVudCBub3Qgc2V0IGNvcnJlY3RseSIpCgoKICAgIGRlZiB0ZXN0X21ldGhvZF9jYWxsc19yZWNvcmRlZChzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgbW9jay5zb21ldGhpbmcoMywgZmlzaD1Ob25lKQogICAgICAgIG1vY2suc29tZXRoaW5nX2Vsc2Uuc29tZXRoaW5nKDYsIGNha2U9c2VudGluZWwuQ2FrZSkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLnNvbWV0aGluZ19lbHNlLm1ldGhvZF9jYWxscywKICAgICAgICAgICAgICAgICAgICAgICAgICBbKCJzb21ldGhpbmciLCAoNiwpLCB7J2Nha2UnOiBzZW50aW5lbC5DYWtlfSldLAogICAgICAgICAgICAgICAgICAgICAgICAgICJtZXRob2QgY2FsbHMgbm90IHJlY29yZGVkIGNvcnJlY3RseSIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1ldGhvZF9jYWxscywgWwogICAgICAgICAgICAoInNvbWV0aGluZyIsICgzLCksIHsnZmlzaCc6IE5vbmV9KSwKICAgICAgICAgICAgKCJzb21ldGhpbmdfZWxzZS5zb21ldGhpbmciLCAoNiwpLCB7J2Nha2UnOiBzZW50aW5lbC5DYWtlfSkKICAgICAgICBdLAogICAgICAgICAgICAibWV0aG9kIGNhbGxzIG5vdCByZWNvcmRlZCBjb3JyZWN0bHkiKQoKCiAgICBkZWYgdGVzdF9tZXRob2RfY2FsbHNfY29tcGFyZV9lYXNpbHkoc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2suc29tZXRoaW5nKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subWV0aG9kX2NhbGxzLCBbKCdzb21ldGhpbmcnLCldKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tZXRob2RfY2FsbHMsIFsoJ3NvbWV0aGluZycsICgpLCB7fSldKQoKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgbW9jay5zb21ldGhpbmcoJ2RpZmZlcmVudCcpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1ldGhvZF9jYWxscywgWygnc29tZXRoaW5nJywgKCdkaWZmZXJlbnQnLCkpXSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subWV0aG9kX2NhbGxzLAogICAgICAgICAgICAgICAgICAgICAgICAgWygnc29tZXRoaW5nJywgKCdkaWZmZXJlbnQnLCksIHt9KV0pCgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrLnNvbWV0aGluZyh4PTEpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1ldGhvZF9jYWxscywgWygnc29tZXRoaW5nJywgeyd4JzogMX0pXSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subWV0aG9kX2NhbGxzLCBbKCdzb21ldGhpbmcnLCAoKSwgeyd4JzogMX0pXSkKCiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2suc29tZXRoaW5nKCdkaWZmZXJlbnQnLCBzb21lPSdtb3JlJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subWV0aG9kX2NhbGxzLCBbCiAgICAgICAgICAgICgnc29tZXRoaW5nJywgKCdkaWZmZXJlbnQnLCksIHsnc29tZSc6ICdtb3JlJ30pCiAgICAgICAgXSkKCgogICAgZGVmIHRlc3Rfb25seV9hbGxvd2VkX21ldGhvZHNfZXhpc3Qoc2VsZik6CiAgICAgICAgZm9yIHNwZWMgaW4gWydzb21ldGhpbmcnXSwgKCdzb21ldGhpbmcnLCk6CiAgICAgICAgICAgIGZvciBhcmcgaW4gJ3NwZWMnLCAnc3BlY19zZXQnOgogICAgICAgICAgICAgICAgbW9jayA9IE1vY2soKip7YXJnOiBzcGVjfSkKCiAgICAgICAgICAgICAgICAjIHRoaXMgc2hvdWxkIGJlIGFsbG93ZWQKICAgICAgICAgICAgICAgIG1vY2suc29tZXRoaW5nCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1JlZ2V4KAogICAgICAgICAgICAgICAgICAgIEF0dHJpYnV0ZUVycm9yLAogICAgICAgICAgICAgICAgICAgICJNb2NrIG9iamVjdCBoYXMgbm8gYXR0cmlidXRlICdzb21ldGhpbmdfZWxzZSciLAogICAgICAgICAgICAgICAgICAgIGdldGF0dHIsIG1vY2ssICdzb21ldGhpbmdfZWxzZScKICAgICAgICAgICAgICAgICkKCgogICAgZGVmIHRlc3RfZnJvbV9zcGVjKHNlbGYpOgogICAgICAgIGNsYXNzIFNvbWV0aGluZyhvYmplY3QpOgogICAgICAgICAgICB4ID0gMwogICAgICAgICAgICBfX3NvbWV0aGluZ19fID0gTm9uZQogICAgICAgICAgICBkZWYgeShzZWxmKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgZGVmIHRlc3RfYXR0cmlidXRlcyhtb2NrKToKICAgICAgICAgICAgIyBzaG91bGQgd29yawogICAgICAgICAgICBtb2NrLngKICAgICAgICAgICAgbW9jay55CiAgICAgICAgICAgIG1vY2suX19zb21ldGhpbmdfXwogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1JlZ2V4KAogICAgICAgICAgICAgICAgQXR0cmlidXRlRXJyb3IsCiAgICAgICAgICAgICAgICAiTW9jayBvYmplY3QgaGFzIG5vIGF0dHJpYnV0ZSAneiciLAogICAgICAgICAgICAgICAgZ2V0YXR0ciwgbW9jaywgJ3onCiAgICAgICAgICAgICkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXNSZWdleCgKICAgICAgICAgICAgICAgIEF0dHJpYnV0ZUVycm9yLAogICAgICAgICAgICAgICAgIk1vY2sgb2JqZWN0IGhhcyBubyBhdHRyaWJ1dGUgJ19fZm9vYmFyX18nIiwKICAgICAgICAgICAgICAgIGdldGF0dHIsIG1vY2ssICdfX2Zvb2Jhcl9fJwogICAgICAgICAgICApCgogICAgICAgIHRlc3RfYXR0cmlidXRlcyhNb2NrKHNwZWM9U29tZXRoaW5nKSkKICAgICAgICB0ZXN0X2F0dHJpYnV0ZXMoTW9jayhzcGVjPVNvbWV0aGluZygpKSkKCgogICAgZGVmIHRlc3Rfd3JhcHNfY2FsbHMoc2VsZik6CiAgICAgICAgcmVhbCA9IE1vY2soKQoKICAgICAgICBtb2NrID0gTW9jayh3cmFwcz1yZWFsKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jaygpLCByZWFsKCkpCgogICAgICAgIHJlYWwucmVzZXRfbW9jaygpCgogICAgICAgIG1vY2soMSwgMiwgZmlzaD0zKQogICAgICAgIHJlYWwuYXNzZXJ0X2NhbGxlZF93aXRoKDEsIDIsIGZpc2g9MykKCgogICAgZGVmIHRlc3Rfd3JhcHNfY2FsbF93aXRoX25vbmRlZmF1bHRfcmV0dXJuX3ZhbHVlKHNlbGYpOgogICAgICAgIHJlYWwgPSBNb2NrKCkKCiAgICAgICAgbW9jayA9IE1vY2sod3JhcHM9cmVhbCkKICAgICAgICBtb2NrLnJldHVybl92YWx1ZSA9IDMKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrKCksIDMpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShyZWFsLmNhbGxlZCkKCgogICAgZGVmIHRlc3Rfd3JhcHNfYXR0cmlidXRlcyhzZWxmKToKICAgICAgICBjbGFzcyBSZWFsKG9iamVjdCk6CiAgICAgICAgICAgIGF0dHJpYnV0ZSA9IE1vY2soKQoKICAgICAgICByZWFsID0gUmVhbCgpCgogICAgICAgIG1vY2sgPSBNb2NrKHdyYXBzPXJlYWwpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmF0dHJpYnV0ZSgpLCByZWFsLmF0dHJpYnV0ZSgpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBsYW1iZGE6IG1vY2suZmlzaCkKCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChtb2NrLmF0dHJpYnV0ZSwgcmVhbC5hdHRyaWJ1dGUpCiAgICAgICAgcmVzdWx0ID0gbW9jay5hdHRyaWJ1dGUuZnJvZygxLCAyLCBmaXNoPTMpCiAgICAgICAgUmVhbC5hdHRyaWJ1dGUuZnJvZy5hc3NlcnRfY2FsbGVkX3dpdGgoMSwgMiwgZmlzaD0zKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LCBSZWFsLmF0dHJpYnV0ZS5mcm9nKCkpCgoKICAgIGRlZiB0ZXN0X2V4Y2VwdGlvbmFsX3NpZGVfZWZmZWN0KHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKHNpZGVfZWZmZWN0PUF0dHJpYnV0ZUVycm9yKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBtb2NrKQoKICAgICAgICBtb2NrID0gTW9jayhzaWRlX2VmZmVjdD1BdHRyaWJ1dGVFcnJvcignZm9vJykpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIG1vY2spCgoKICAgIGRlZiB0ZXN0X2Jhc2VleGNlcHRpb25hbF9zaWRlX2VmZmVjdChzZWxmKToKICAgICAgICBtb2NrID0gTW9jayhzaWRlX2VmZmVjdD1LZXlib2FyZEludGVycnVwdCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhLZXlib2FyZEludGVycnVwdCwgbW9jaykKCiAgICAgICAgbW9jayA9IE1vY2soc2lkZV9lZmZlY3Q9S2V5Ym9hcmRJbnRlcnJ1cHQoJ2ZvbycpKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEtleWJvYXJkSW50ZXJydXB0LCBtb2NrKQoKCiAgICBkZWYgdGVzdF9hc3NlcnRfY2FsbGVkX3dpdGhfbWVzc2FnZShzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXNSZWdleChBc3NlcnRpb25FcnJvciwgJ05vdCBjYWxsZWQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF93aXRoKQoKCiAgICBkZWYgdGVzdF9fbmFtZV9fKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgbGFtYmRhOiBtb2NrLl9fbmFtZV9fKQoKICAgICAgICBtb2NrLl9fbmFtZV9fID0gJ2ZvbycKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suX19uYW1lX18sICdmb28nKQoKCiAgICBkZWYgdGVzdF9zcGVjX2xpc3Rfc3ViY2xhc3Moc2VsZik6CiAgICAgICAgY2xhc3MgU3ViKGxpc3QpOgogICAgICAgICAgICBwYXNzCiAgICAgICAgbW9jayA9IE1vY2soc3BlYz1TdWIoWydmb28nXSkpCgogICAgICAgIG1vY2suYXBwZW5kKDMpCiAgICAgICAgbW9jay5hcHBlbmQuYXNzZXJ0X2NhbGxlZF93aXRoKDMpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIG1vY2ssICdmb28nKQoKCiAgICBkZWYgdGVzdF9zcGVjX2NsYXNzKHNlbGYpOgogICAgICAgIGNsYXNzIFgob2JqZWN0KToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBtb2NrID0gTW9jayhzcGVjPVgpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzaW5zdGFuY2UobW9jaywgWCkpCgogICAgICAgIG1vY2sgPSBNb2NrKHNwZWM9WCgpKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShpc2luc3RhbmNlKG1vY2ssIFgpKQoKICAgICAgICBzZWxmLmFzc2VydElzKG1vY2suX19jbGFzc19fLCBYKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoTW9jaygpLl9fY2xhc3NfXy5fX25hbWVfXywgJ01vY2snKQoKICAgICAgICBtb2NrID0gTW9jayhzcGVjX3NldD1YKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShpc2luc3RhbmNlKG1vY2ssIFgpKQoKICAgICAgICBtb2NrID0gTW9jayhzcGVjX3NldD1YKCkpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzaW5zdGFuY2UobW9jaywgWCkpCgoKICAgIGRlZiB0ZXN0X3NldHRpbmdfYXR0cmlidXRlX3dpdGhfc3BlY19zZXQoc2VsZik6CiAgICAgICAgY2xhc3MgWChvYmplY3QpOgogICAgICAgICAgICB5ID0gMwoKICAgICAgICBtb2NrID0gTW9jayhzcGVjPVgpCiAgICAgICAgbW9jay54ID0gJ2ZvbycKCiAgICAgICAgbW9jayA9IE1vY2soc3BlY19zZXQ9WCkKICAgICAgICBkZWYgc2V0X2F0dHIoKToKICAgICAgICAgICAgbW9jay54ID0gJ2ZvbycKCiAgICAgICAgbW9jay55ID0gJ2ZvbycKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgc2V0X2F0dHIpCgoKICAgIGRlZiB0ZXN0X2NvcHkoc2VsZik6CiAgICAgICAgY3VycmVudCA9IHN5cy5nZXRyZWN1cnNpb25saW1pdCgpCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHN5cy5zZXRyZWN1cnNpb25saW1pdCwgY3VycmVudCkKCiAgICAgICAgIyBjYW4ndCB1c2Ugc3lzLm1heGludCBhcyB0aGlzIGRvZXNuJ3QgZXhpc3QgaW4gUHl0aG9uIDMKICAgICAgICBzeXMuc2V0cmVjdXJzaW9ubGltaXQoaW50KDEwZTgpKQogICAgICAgICMgdGhpcyBzZWdmYXVsdHMgd2l0aG91dCB0aGUgZml4IGluIHBsYWNlCiAgICAgICAgY29weS5jb3B5KE1vY2soKSkKCgogICAgZGVmIHRlc3Rfc3ViY2xhc3Nfd2l0aF9wcm9wZXJ0aWVzKHNlbGYpOgogICAgICAgIGNsYXNzIFN1YkNsYXNzKE1vY2spOgogICAgICAgICAgICBkZWYgX2dldChzZWxmKToKICAgICAgICAgICAgICAgIHJldHVybiAzCiAgICAgICAgICAgIGRlZiBfc2V0KHNlbGYsIHZhbHVlKToKICAgICAgICAgICAgICAgIHJhaXNlIE5hbWVFcnJvcignc3RyYW5nZSBlcnJvcicpCiAgICAgICAgICAgIHNvbWVfYXR0cmlidXRlID0gcHJvcGVydHkoX2dldCwgX3NldCkKCiAgICAgICAgcyA9IFN1YkNsYXNzKHNwZWNfc2V0PVN1YkNsYXNzKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocy5zb21lX2F0dHJpYnV0ZSwgMykKCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgcy5zb21lX2F0dHJpYnV0ZSA9IDMKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhOYW1lRXJyb3IsIHRlc3QpCgogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHMuZm9vID0gJ2JhcicKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgdGVzdCkKCgogICAgZGVmIHRlc3Rfc2V0dGluZ19jYWxsKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBkZWYgX19jYWxsX18oc2VsZiwgYSk6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9tb2NrX2NhbGwoYSkKCiAgICAgICAgdHlwZShtb2NrKS5fX2NhbGxfXyA9IF9fY2FsbF9fCiAgICAgICAgbW9jaygnb25lJykKICAgICAgICBtb2NrLmFzc2VydF9jYWxsZWRfd2l0aCgnb25lJykKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrLCAnb25lJywgJ3R3bycpCgoKICAgIGRlZiB0ZXN0X2RpcihzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgYXR0cnMgPSBzZXQoZGlyKG1vY2spKQogICAgICAgIHR5cGVfYXR0cnMgPSBzZXQoW20gZm9yIG0gaW4gZGlyKE1vY2spIGlmIG5vdCBtLnN0YXJ0c3dpdGgoJ18nKV0pCgogICAgICAgICMgYWxsIHB1YmxpYyBhdHRyaWJ1dGVzIGZyb20gdGhlIHR5cGUgYXJlIGluY2x1ZGVkCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzZXQoKSwgdHlwZV9hdHRycyAtIGF0dHJzKQoKICAgICAgICAjIGNyZWF0ZXMgdGhlc2UgYXR0cmlidXRlcwogICAgICAgIG1vY2suYSwgbW9jay5iCiAgICAgICAgc2VsZi5hc3NlcnRJbignYScsIGRpcihtb2NrKSkKICAgICAgICBzZWxmLmFzc2VydEluKCdiJywgZGlyKG1vY2spKQoKICAgICAgICAjIGluc3RhbmNlIGF0dHJpYnV0ZXMKICAgICAgICBtb2NrLmMgPSBtb2NrLmQgPSBOb25lCiAgICAgICAgc2VsZi5hc3NlcnRJbignYycsIGRpcihtb2NrKSkKICAgICAgICBzZWxmLmFzc2VydEluKCdkJywgZGlyKG1vY2spKQoKICAgICAgICAjIG1hZ2ljIG1ldGhvZHMKICAgICAgICBtb2NrLl9faXRlcl9fID0gbGFtYmRhIHM6IGl0ZXIoW10pCiAgICAgICAgc2VsZi5hc3NlcnRJbignX19pdGVyX18nLCBkaXIobW9jaykpCgoKICAgIGRlZiB0ZXN0X2Rpcl9mcm9tX3NwZWMoc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soc3BlYz11bml0dGVzdC5UZXN0Q2FzZSkKICAgICAgICB0ZXN0Y2FzZV9hdHRycyA9IHNldChkaXIodW5pdHRlc3QuVGVzdENhc2UpKQogICAgICAgIGF0dHJzID0gc2V0KGRpcihtb2NrKSkKCiAgICAgICAgIyBhbGwgYXR0cmlidXRlcyBmcm9tIHRoZSBzcGVjIGFyZSBpbmNsdWRlZAogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc2V0KCksIHRlc3RjYXNlX2F0dHJzIC0gYXR0cnMpCgogICAgICAgICMgc2hhZG93IGEgc3lzIGF0dHJpYnV0ZQogICAgICAgIG1vY2sudmVyc2lvbiA9IDMKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGRpcihtb2NrKS5jb3VudCgndmVyc2lvbicpLCAxKQoKCiAgICBkZWYgdGVzdF9maWx0ZXJfZGlyKHNlbGYpOgogICAgICAgIHBhdGNoZXIgPSBwYXRjaC5vYmplY3QobW9jaywgJ0ZJTFRFUl9ESVInLCBGYWxzZSkKICAgICAgICBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIGF0dHJzID0gc2V0KGRpcihNb2NrKCkpKQogICAgICAgICAgICB0eXBlX2F0dHJzID0gc2V0KGRpcihNb2NrKSkKCiAgICAgICAgICAgICMgQUxMIGF0dHJpYnV0ZXMgZnJvbSB0aGUgdHlwZSBhcmUgaW5jbHVkZWQKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzZXQoKSwgdHlwZV9hdHRycyAtIGF0dHJzKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHBhdGNoZXIuc3RvcCgpCgoKICAgIGRlZiB0ZXN0X2NvbmZpZ3VyZV9tb2NrKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKGZvbz0nYmFyJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suZm9vLCAnYmFyJykKCiAgICAgICAgbW9jayA9IE1hZ2ljTW9jayhmb289J2JhcicpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmZvbywgJ2JhcicpCgogICAgICAgIGt3YXJncyA9IHsnc2lkZV9lZmZlY3QnOiBLZXlFcnJvciwgJ2Zvby5iYXIucmV0dXJuX3ZhbHVlJzogMzMsCiAgICAgICAgICAgICAgICAgICdmb28nOiBNYWdpY01vY2soKX0KICAgICAgICBtb2NrID0gTW9jaygqKmt3YXJncykKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhLZXlFcnJvciwgbW9jaykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suZm9vLmJhcigpLCAzMykKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jay5mb28sIE1hZ2ljTW9jaykKCiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2suY29uZmlndXJlX21vY2soKiprd2FyZ3MpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoS2V5RXJyb3IsIG1vY2spCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLmZvby5iYXIoKSwgMzMpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKG1vY2suZm9vLCBNYWdpY01vY2spCgoKICAgIGRlZiBhc3NlcnRSYWlzZXNXaXRoTXNnKHNlbGYsIGV4Y2VwdGlvbiwgbWVzc2FnZSwgZnVuYywgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAjIG5lZWRlZCBiZWNhdXNlIGFzc2VydFJhaXNlc1JlZ2V4IGRvZXNuJ3Qgd29yayBlYXNpbHkgd2l0aCBuZXdsaW5lcwogICAgICAgIHRyeToKICAgICAgICAgICAgZnVuYygqYXJncywgKiprd2FyZ3MpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBpbnN0YW5jZSA9IHN5cy5leGNfaW5mbygpWzFdCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShpbnN0YW5jZSwgZXhjZXB0aW9uKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgnRXhjZXB0aW9uICVyIG5vdCByYWlzZWQnICUgKGV4Y2VwdGlvbiwpKQoKICAgICAgICBtc2cgPSBzdHIoaW5zdGFuY2UpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtc2csIG1lc3NhZ2UpCgoKICAgIGRlZiB0ZXN0X2Fzc2VydF9jYWxsZWRfd2l0aF9mYWlsdXJlX21lc3NhZ2Uoc2VsZik6CiAgICAgICAgbW9jayA9IE5vbkNhbGxhYmxlTW9jaygpCgogICAgICAgIGV4cGVjdGVkID0gIm1vY2soMSwgJzInLCAzLCBiYXI9J2ZvbycpIgogICAgICAgIG1lc3NhZ2UgPSAnRXhwZWN0ZWQgY2FsbDogJXNcbk5vdCBjYWxsZWQnCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXNXaXRoTXNnKAogICAgICAgICAgICBBc3NlcnRpb25FcnJvciwgbWVzc2FnZSAlIChleHBlY3RlZCwpLAogICAgICAgICAgICBtb2NrLmFzc2VydF9jYWxsZWRfd2l0aCwgMSwgJzInLCAzLCBiYXI9J2ZvbycKICAgICAgICApCgogICAgICAgIG1vY2suZm9vKDEsICcyJywgMywgZm9vPSdmb28nKQoKCiAgICAgICAgYXNzZXJ0ZXJzID0gWwogICAgICAgICAgICBtb2NrLmZvby5hc3NlcnRfY2FsbGVkX3dpdGgsIG1vY2suZm9vLmFzc2VydF9jYWxsZWRfb25jZV93aXRoCiAgICAgICAgXQogICAgICAgIGZvciBtZXRoIGluIGFzc2VydGVyczoKICAgICAgICAgICAgYWN0dWFsID0gImZvbygxLCAnMicsIDMsIGZvbz0nZm9vJykiCiAgICAgICAgICAgIGV4cGVjdGVkID0gImZvbygxLCAnMicsIDMsIGJhcj0nZm9vJykiCiAgICAgICAgICAgIG1lc3NhZ2UgPSAnRXhwZWN0ZWQgY2FsbDogJXNcbkFjdHVhbCBjYWxsOiAlcycKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXNXaXRoTXNnKAogICAgICAgICAgICAgICAgQXNzZXJ0aW9uRXJyb3IsIG1lc3NhZ2UgJSAoZXhwZWN0ZWQsIGFjdHVhbCksCiAgICAgICAgICAgICAgICBtZXRoLCAxLCAnMicsIDMsIGJhcj0nZm9vJwogICAgICAgICAgICApCgogICAgICAgICMganVzdCBrd2FyZ3MKICAgICAgICBmb3IgbWV0aCBpbiBhc3NlcnRlcnM6CiAgICAgICAgICAgIGFjdHVhbCA9ICJmb28oMSwgJzInLCAzLCBmb289J2ZvbycpIgogICAgICAgICAgICBleHBlY3RlZCA9ICJmb28oYmFyPSdmb28nKSIKICAgICAgICAgICAgbWVzc2FnZSA9ICdFeHBlY3RlZCBjYWxsOiAlc1xuQWN0dWFsIGNhbGw6ICVzJwogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1dpdGhNc2coCiAgICAgICAgICAgICAgICBBc3NlcnRpb25FcnJvciwgbWVzc2FnZSAlIChleHBlY3RlZCwgYWN0dWFsKSwKICAgICAgICAgICAgICAgIG1ldGgsIGJhcj0nZm9vJwogICAgICAgICAgICApCgogICAgICAgICMganVzdCBhcmdzCiAgICAgICAgZm9yIG1ldGggaW4gYXNzZXJ0ZXJzOgogICAgICAgICAgICBhY3R1YWwgPSAiZm9vKDEsICcyJywgMywgZm9vPSdmb28nKSIKICAgICAgICAgICAgZXhwZWN0ZWQgPSAiZm9vKDEsIDIsIDMpIgogICAgICAgICAgICBtZXNzYWdlID0gJ0V4cGVjdGVkIGNhbGw6ICVzXG5BY3R1YWwgY2FsbDogJXMnCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzV2l0aE1zZygKICAgICAgICAgICAgICAgIEFzc2VydGlvbkVycm9yLCBtZXNzYWdlICUgKGV4cGVjdGVkLCBhY3R1YWwpLAogICAgICAgICAgICAgICAgbWV0aCwgMSwgMiwgMwogICAgICAgICAgICApCgogICAgICAgICMgZW1wdHkKICAgICAgICBmb3IgbWV0aCBpbiBhc3NlcnRlcnM6CiAgICAgICAgICAgIGFjdHVhbCA9ICJmb28oMSwgJzInLCAzLCBmb289J2ZvbycpIgogICAgICAgICAgICBleHBlY3RlZCA9ICJmb28oKSIKICAgICAgICAgICAgbWVzc2FnZSA9ICdFeHBlY3RlZCBjYWxsOiAlc1xuQWN0dWFsIGNhbGw6ICVzJwogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlc1dpdGhNc2coCiAgICAgICAgICAgICAgICBBc3NlcnRpb25FcnJvciwgbWVzc2FnZSAlIChleHBlY3RlZCwgYWN0dWFsKSwgbWV0aAogICAgICAgICAgICApCgoKICAgIGRlZiB0ZXN0X21vY2tfY2FsbHMoc2VsZik6CiAgICAgICAgbW9jayA9IE1hZ2ljTW9jaygpCgogICAgICAgICMgbmVlZCB0byBkbyB0aGlzIGJlY2F1c2UgTWFnaWNNb2NrLm1vY2tfY2FsbHMgdXNlZCB0byBqdXN0IHJldHVybgogICAgICAgICMgYSBNYWdpY01vY2sgd2hpY2ggYWxzbyByZXR1cm5lZCBhIE1hZ2ljTW9jayB3aGVuIF9fZXFfXyB3YXMgY2FsbGVkCiAgICAgICAgc2VsZi5hc3NlcnRJcyhtb2NrLm1vY2tfY2FsbHMgPT0gW10sIFRydWUpCgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgIG1vY2soKQogICAgICAgIGV4cGVjdGVkID0gWygnJywgKCksIHt9KV0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subW9ja19jYWxscywgZXhwZWN0ZWQpCgogICAgICAgIG1vY2suZm9vKCkKICAgICAgICBleHBlY3RlZC5hcHBlbmQoY2FsbC5mb28oKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subW9ja19jYWxscywgZXhwZWN0ZWQpCiAgICAgICAgIyBpbnRlcm1lZGlhdGUgbW9ja19jYWxscyB3b3JrIHRvbwogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5mb28ubW9ja19jYWxscywgWygnJywgKCksIHt9KV0pCgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgIG1vY2soKS5mb28oMSwgMiwgMywgYT00LCBiPTUpCiAgICAgICAgZXhwZWN0ZWQgPSBbCiAgICAgICAgICAgICgnJywgKCksIHt9KSwgKCcoKS5mb28nLCAoMSwgMiwgMyksIGRpY3QoYT00LCBiPTUpKQogICAgICAgIF0KICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subW9ja19jYWxscywgZXhwZWN0ZWQpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLnJldHVybl92YWx1ZS5mb28ubW9ja19jYWxscywKICAgICAgICAgICAgICAgICAgICAgICAgIFsoJycsICgxLCAyLCAzKSwgZGljdChhPTQsIGI9NSkpXSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2sucmV0dXJuX3ZhbHVlLm1vY2tfY2FsbHMsCiAgICAgICAgICAgICAgICAgICAgICAgICBbKCdmb28nLCAoMSwgMiwgMyksIGRpY3QoYT00LCBiPTUpKV0pCgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soKQogICAgICAgIG1vY2soKS5mb28uYmFyKCkuYmF6KCkKICAgICAgICBleHBlY3RlZCA9IFsKICAgICAgICAgICAgKCcnLCAoKSwge30pLCAoJygpLmZvby5iYXInLCAoKSwge30pLAogICAgICAgICAgICAoJygpLmZvby5iYXIoKS5iYXonLCAoKSwge30pCiAgICAgICAgXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tb2NrX2NhbGxzLCBleHBlY3RlZCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2soKS5tb2NrX2NhbGxzLAogICAgICAgICAgICAgICAgICAgICAgICAgY2FsbC5mb28uYmFyKCkuYmF6KCkuY2FsbF9saXN0KCkpCgogICAgICAgIGZvciBrd2FyZ3MgaW4gZGljdCgpLCBkaWN0KG5hbWU9J2JhcicpOgogICAgICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCoqa3dhcmdzKQogICAgICAgICAgICBpbnQobW9jay5mb28pCiAgICAgICAgICAgIGV4cGVjdGVkID0gWygnZm9vLl9faW50X18nLCAoKSwge30pXQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subW9ja19jYWxscywgZXhwZWN0ZWQpCgogICAgICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCoqa3dhcmdzKQogICAgICAgICAgICBtb2NrLmEoKSgpCiAgICAgICAgICAgIGV4cGVjdGVkID0gWygnYScsICgpLCB7fSksICgnYSgpJywgKCksIHt9KV0KICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1vY2tfY2FsbHMsIGV4cGVjdGVkKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suYSgpLm1vY2tfY2FsbHMsIFtjYWxsKCldKQoKICAgICAgICAgICAgbW9jayA9IE1hZ2ljTW9jaygqKmt3YXJncykKICAgICAgICAgICAgbW9jaygxKSgyKSgzKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subW9ja19jYWxscywgY2FsbCgxKSgyKSgzKS5jYWxsX2xpc3QoKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrKCkubW9ja19jYWxscywgY2FsbCgyKSgzKS5jYWxsX2xpc3QoKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrKCkoKS5tb2NrX2NhbGxzLCBjYWxsKDMpLmNhbGxfbGlzdCgpKQoKICAgICAgICAgICAgbW9jayA9IE1hZ2ljTW9jaygqKmt3YXJncykKICAgICAgICAgICAgbW9jaygxKSgyKSgzKS5hLmIuYyg0KQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subW9ja19jYWxscywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsKDEpKDIpKDMpLmEuYi5jKDQpLmNhbGxfbGlzdCgpKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2soKS5tb2NrX2NhbGxzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGwoMikoMykuYS5iLmMoNCkuY2FsbF9saXN0KCkpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jaygpKCkubW9ja19jYWxscywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsKDMpLmEuYi5jKDQpLmNhbGxfbGlzdCgpKQoKICAgICAgICAgICAgbW9jayA9IE1hZ2ljTW9jaygqKmt3YXJncykKICAgICAgICAgICAgaW50KG1vY2soKS5mb28uYmFyKCkuYmF6KCkpCiAgICAgICAgICAgIGxhc3RfY2FsbCA9ICgnKCkuZm9vLmJhcigpLmJheigpLl9faW50X18nLCAoKSwge30pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tb2NrX2NhbGxzWy0xXSwgbGFzdF9jYWxsKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2soKS5tb2NrX2NhbGxzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGwuZm9vLmJhcigpLmJheigpLl9faW50X18oKS5jYWxsX2xpc3QoKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrKCkuZm9vLmJhcigpLm1vY2tfY2FsbHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbC5iYXooKS5fX2ludF9fKCkuY2FsbF9saXN0KCkpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jaygpLmZvby5iYXIoKS5iYXoubW9ja19jYWxscywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsKCkuX19pbnRfXygpLmNhbGxfbGlzdCgpKQoKCiAgICBkZWYgdGVzdF9zdWJjbGFzc2luZyhzZWxmKToKICAgICAgICBjbGFzcyBTdWJjbGFzcyhNb2NrKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBtb2NrID0gU3ViY2xhc3MoKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrLmZvbywgU3ViY2xhc3MpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKG1vY2soKSwgU3ViY2xhc3MpCgogICAgICAgIGNsYXNzIFN1YmNsYXNzKE1vY2spOgogICAgICAgICAgICBkZWYgX2dldF9jaGlsZF9tb2NrKHNlbGYsICoqa3dhcmdzKToKICAgICAgICAgICAgICAgIHJldHVybiBNb2NrKCoqa3dhcmdzKQoKICAgICAgICBtb2NrID0gU3ViY2xhc3MoKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90SXNJbnN0YW5jZShtb2NrLmZvbywgU3ViY2xhc3MpCiAgICAgICAgc2VsZi5hc3NlcnROb3RJc0luc3RhbmNlKG1vY2soKSwgU3ViY2xhc3MpCgoKICAgIGRlZiB0ZXN0X2FyZ19saXN0cyhzZWxmKToKICAgICAgICBtb2NrcyA9IFsKICAgICAgICAgICAgTW9jaygpLAogICAgICAgICAgICBNYWdpY01vY2soKSwKICAgICAgICAgICAgTm9uQ2FsbGFibGVNb2NrKCksCiAgICAgICAgICAgIE5vbkNhbGxhYmxlTWFnaWNNb2NrKCkKICAgICAgICBdCgogICAgICAgIGRlZiBhc3NlcnRfYXR0cnMobW9jayk6CiAgICAgICAgICAgIG5hbWVzID0gJ2NhbGxfYXJnc19saXN0JywgJ21ldGhvZF9jYWxscycsICdtb2NrX2NhbGxzJwogICAgICAgICAgICBmb3IgbmFtZSBpbiBuYW1lczoKICAgICAgICAgICAgICAgIGF0dHIgPSBnZXRhdHRyKG1vY2ssIG5hbWUpCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UoYXR0ciwgX0NhbGxMaXN0KQogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGF0dHIsIGxpc3QpCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGF0dHIsIFtdKQoKICAgICAgICBmb3IgbW9jayBpbiBtb2NrczoKICAgICAgICAgICAgYXNzZXJ0X2F0dHJzKG1vY2spCgogICAgICAgICAgICBpZiBjYWxsYWJsZShtb2NrKToKICAgICAgICAgICAgICAgIG1vY2soKQogICAgICAgICAgICAgICAgbW9jaygxLCAyKQogICAgICAgICAgICAgICAgbW9jayhhPTMpCgogICAgICAgICAgICAgICAgbW9jay5yZXNldF9tb2NrKCkKICAgICAgICAgICAgICAgIGFzc2VydF9hdHRycyhtb2NrKQoKICAgICAgICAgICAgbW9jay5mb28oKQogICAgICAgICAgICBtb2NrLmZvby5iYXIoMSwgYT0zKQogICAgICAgICAgICBtb2NrLmZvbygxKS5iYXIoKS5iYXooMykKCiAgICAgICAgICAgIG1vY2sucmVzZXRfbW9jaygpCiAgICAgICAgICAgIGFzc2VydF9hdHRycyhtb2NrKQoKCiAgICBkZWYgdGVzdF9jYWxsX2FyZ3NfdHdvX3R1cGxlKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKCkKICAgICAgICBtb2NrKDEsIGE9MykKICAgICAgICBtb2NrKDIsIGI9NCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4obW9jay5jYWxsX2FyZ3MpLCAyKQogICAgICAgIGFyZ3MsIGt3YXJncyA9IG1vY2suY2FsbF9hcmdzCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChhcmdzLCAoMiwpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoa3dhcmdzLCBkaWN0KGI9NCkpCgogICAgICAgIGV4cGVjdGVkX2xpc3QgPSBbKCgxLCksIGRpY3QoYT0zKSksICgoMiwpLCBkaWN0KGI9NCkpXQogICAgICAgIGZvciBleHBlY3RlZCwgY2FsbF9hcmdzIGluIHppcChleHBlY3RlZF9saXN0LCBtb2NrLmNhbGxfYXJnc19saXN0KToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4oY2FsbF9hcmdzKSwgMikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChleHBlY3RlZFswXSwgY2FsbF9hcmdzWzBdKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGV4cGVjdGVkWzFdLCBjYWxsX2FyZ3NbMV0pCgoKICAgIGRlZiB0ZXN0X3NpZGVfZWZmZWN0X2l0ZXJhdG9yKHNlbGYpOgogICAgICAgIG1vY2sgPSBNb2NrKHNpZGVfZWZmZWN0PWl0ZXIoWzEsIDIsIDNdKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFttb2NrKCksIG1vY2soKSwgbW9jaygpXSwgWzEsIDIsIDNdKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFN0b3BJdGVyYXRpb24sIG1vY2spCgogICAgICAgIG1vY2sgPSBNYWdpY01vY2soc2lkZV9lZmZlY3Q9WydhJywgJ2InLCAnYyddKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoW21vY2soKSwgbW9jaygpLCBtb2NrKCldLCBbJ2EnLCAnYicsICdjJ10pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoU3RvcEl0ZXJhdGlvbiwgbW9jaykKCiAgICAgICAgbW9jayA9IE1vY2soc2lkZV9lZmZlY3Q9J2doaScpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChbbW9jaygpLCBtb2NrKCksIG1vY2soKV0sIFsnZycsICdoJywgJ2knXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhTdG9wSXRlcmF0aW9uLCBtb2NrKQoKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgcGFzcwogICAgICAgIG1vY2sgPSBNYWdpY01vY2soc2lkZV9lZmZlY3Q9Rm9vKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrKCksIEZvbykKCiAgICAgICAgbW9jayA9IE1vY2soc2lkZV9lZmZlY3Q9SXRlcigpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoW21vY2soKSwgbW9jaygpLCBtb2NrKCksIG1vY2soKV0sCiAgICAgICAgICAgICAgICAgICAgICAgICBbJ3RoaXMnLCAnaXMnLCAnYW4nLCAnaXRlciddKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFN0b3BJdGVyYXRpb24sIG1vY2spCgoKICAgIGRlZiB0ZXN0X3NpZGVfZWZmZWN0X2l0ZXJhdG9yX2V4Y2VwdGlvbnMoc2VsZik6CiAgICAgICAgZm9yIEtsYXNzIGluIE1vY2ssIE1hZ2ljTW9jazoKICAgICAgICAgICAgaXRlcmFibGUgPSAoVmFsdWVFcnJvciwgMywgS2V5RXJyb3IsIDYpCiAgICAgICAgICAgIG0gPSBLbGFzcyhzaWRlX2VmZmVjdD1pdGVyYWJsZSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVmFsdWVFcnJvciwgbSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtKCksIDMpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEtleUVycm9yLCBtKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0oKSwgNikKCgogICAgZGVmIHRlc3Rfc2lkZV9lZmZlY3Rfc2V0dGluZ19pdGVyYXRvcihzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgbW9jay5zaWRlX2VmZmVjdCA9IGl0ZXIoWzEsIDIsIDNdKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoW21vY2soKSwgbW9jaygpLCBtb2NrKCldLCBbMSwgMiwgM10pCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoU3RvcEl0ZXJhdGlvbiwgbW9jaykKICAgICAgICBzaWRlX2VmZmVjdCA9IG1vY2suc2lkZV9lZmZlY3QKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2Uoc2lkZV9lZmZlY3QsIHR5cGUoaXRlcihbXSkpKQoKICAgICAgICBtb2NrLnNpZGVfZWZmZWN0ID0gWydhJywgJ2InLCAnYyddCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChbbW9jaygpLCBtb2NrKCksIG1vY2soKV0sIFsnYScsICdiJywgJ2MnXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhTdG9wSXRlcmF0aW9uLCBtb2NrKQogICAgICAgIHNpZGVfZWZmZWN0ID0gbW9jay5zaWRlX2VmZmVjdAogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShzaWRlX2VmZmVjdCwgdHlwZShpdGVyKFtdKSkpCgogICAgICAgIHRoaXNfaXRlciA9IEl0ZXIoKQogICAgICAgIG1vY2suc2lkZV9lZmZlY3QgPSB0aGlzX2l0ZXIKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFttb2NrKCksIG1vY2soKSwgbW9jaygpLCBtb2NrKCldLAogICAgICAgICAgICAgICAgICAgICAgICAgWyd0aGlzJywgJ2lzJywgJ2FuJywgJ2l0ZXInXSkKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhTdG9wSXRlcmF0aW9uLCBtb2NrKQogICAgICAgIHNlbGYuYXNzZXJ0SXMobW9jay5zaWRlX2VmZmVjdCwgdGhpc19pdGVyKQoKCiAgICBkZWYgdGVzdF9hc3NlcnRfaGFzX2NhbGxzX2FueV9vcmRlcihzZWxmKToKICAgICAgICBtb2NrID0gTW9jaygpCiAgICAgICAgbW9jaygxLCAyKQogICAgICAgIG1vY2soYT0zKQogICAgICAgIG1vY2soMywgNCkKICAgICAgICBtb2NrKGI9NikKICAgICAgICBtb2NrKGI9NikKCiAgICAgICAga2FsbHMgPSBbCiAgICAgICAgICAgIGNhbGwoMSwgMiksICh7J2EnOiAzfSwpLAogICAgICAgICAgICAoKDMsIDQpLCksICgoKSwgeydhJzogM30pLAogICAgICAgICAgICAoJycsICgxLCAyKSksICgnJywgeydhJzogM30pLAogICAgICAgICAgICAoJycsICgxLCAyKSwge30pLCAoJycsICgpLCB7J2EnOiAzfSkKICAgICAgICBdCiAgICAgICAgZm9yIGthbGwgaW4ga2FsbHM6CiAgICAgICAgICAgIG1vY2suYXNzZXJ0X2hhc19jYWxscyhba2FsbF0sIGFueV9vcmRlcj1UcnVlKQoKICAgICAgICBmb3Iga2FsbCBpbiBjYWxsKDEsICcyJyksIGNhbGwoYj0zKSwgY2FsbCgpLCAzLCBOb25lLCAnZm9vJzoKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgICAgICBBc3NlcnRpb25FcnJvciwgbW9jay5hc3NlcnRfaGFzX2NhbGxzLAogICAgICAgICAgICAgICAgW2thbGxdLCBhbnlfb3JkZXI9VHJ1ZQogICAgICAgICAgICApCgogICAgICAgIGthbGxfbGlzdHMgPSBbCiAgICAgICAgICAgIFtjYWxsKDEsIDIpLCBjYWxsKGI9NildLAogICAgICAgICAgICBbY2FsbCgzLCA0KSwgY2FsbCgxLCAyKV0sCiAgICAgICAgICAgIFtjYWxsKGI9NiksIGNhbGwoYj02KV0sCiAgICAgICAgXQoKICAgICAgICBmb3Iga2FsbF9saXN0IGluIGthbGxfbGlzdHM6CiAgICAgICAgICAgIG1vY2suYXNzZXJ0X2hhc19jYWxscyhrYWxsX2xpc3QsIGFueV9vcmRlcj1UcnVlKQoKICAgICAgICBrYWxsX2xpc3RzID0gWwogICAgICAgICAgICBbY2FsbChiPTYpLCBjYWxsKGI9NiksIGNhbGwoYj02KV0sCiAgICAgICAgICAgIFtjYWxsKDEsIDIpLCBjYWxsKDEsIDIpXSwKICAgICAgICAgICAgW2NhbGwoMywgNCksIGNhbGwoMSwgMiksIGNhbGwoNSwgNyldLAogICAgICAgICAgICBbY2FsbChiPTYpLCBjYWxsKDMsIDQpLCBjYWxsKGI9NiksIGNhbGwoMSwgMiksIGNhbGwoYj02KV0sCiAgICAgICAgXQogICAgICAgIGZvciBrYWxsX2xpc3QgaW4ga2FsbF9saXN0czoKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgICAgICBBc3NlcnRpb25FcnJvciwgbW9jay5hc3NlcnRfaGFzX2NhbGxzLAogICAgICAgICAgICAgICAga2FsbF9saXN0LCBhbnlfb3JkZXI9VHJ1ZQogICAgICAgICAgICApCgogICAgZGVmIHRlc3RfYXNzZXJ0X2hhc19jYWxscyhzZWxmKToKICAgICAgICBrYWxsczEgPSBbCiAgICAgICAgICAgICAgICBjYWxsKDEsIDIpLCAoeydhJzogM30sKSwKICAgICAgICAgICAgICAgICgoMywgNCksKSwgY2FsbChiPTYpLAogICAgICAgICAgICAgICAgKCcnLCAoMSwpLCB7J2InOiA2fSksCiAgICAgICAgXQogICAgICAgIGthbGxzMiA9IFtjYWxsLmZvbygpLCBjYWxsLmJhcigxKV0KICAgICAgICBrYWxsczIuZXh0ZW5kKGNhbGwuc3BhbSgpLmJheihhPTMpLmNhbGxfbGlzdCgpKQogICAgICAgIGthbGxzMi5leHRlbmQoY2FsbC5iYW0oc2V0KCksIGZvbz17fSkuZmlzaChbMV0pLmNhbGxfbGlzdCgpKQoKICAgICAgICBtb2NrcyA9IFtdCiAgICAgICAgZm9yIG1vY2sgaW4gTW9jaygpLCBNYWdpY01vY2soKToKICAgICAgICAgICAgbW9jaygxLCAyKQogICAgICAgICAgICBtb2NrKGE9MykKICAgICAgICAgICAgbW9jaygzLCA0KQogICAgICAgICAgICBtb2NrKGI9NikKICAgICAgICAgICAgbW9jaygxLCBiPTYpCiAgICAgICAgICAgIG1vY2tzLmFwcGVuZCgobW9jaywga2FsbHMxKSkKCiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2suZm9vKCkKICAgICAgICBtb2NrLmJhcigxKQogICAgICAgIG1vY2suc3BhbSgpLmJheihhPTMpCiAgICAgICAgbW9jay5iYW0oc2V0KCksIGZvbz17fSkuZmlzaChbMV0pCiAgICAgICAgbW9ja3MuYXBwZW5kKChtb2NrLCBrYWxsczIpKQoKICAgICAgICBmb3IgbW9jaywga2FsbHMgaW4gbW9ja3M6CiAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKGxlbihrYWxscykpOgogICAgICAgICAgICAgICAgZm9yIHN0ZXAgaW4gMSwgMiwgMzoKICAgICAgICAgICAgICAgICAgICB0aGVzZSA9IGthbGxzW2k6aStzdGVwXQogICAgICAgICAgICAgICAgICAgIG1vY2suYXNzZXJ0X2hhc19jYWxscyh0aGVzZSkKCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKHRoZXNlKSA+IDE6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQXNzZXJ0aW9uRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2NrLmFzc2VydF9oYXNfY2FsbHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0KHJldmVyc2VkKHRoZXNlKSkKICAgICAgICAgICAgICAgICAgICAgICAgKQoKCiAgICBkZWYgdGVzdF9hc3NlcnRfYW55X2NhbGwoc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2soMSwgMikKICAgICAgICBtb2NrKGE9MykKICAgICAgICBtb2NrKDEsIGI9NikKCiAgICAgICAgbW9jay5hc3NlcnRfYW55X2NhbGwoMSwgMikKICAgICAgICBtb2NrLmFzc2VydF9hbnlfY2FsbChhPTMpCiAgICAgICAgbW9jay5hc3NlcnRfYW55X2NhbGwoMSwgYj02KQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcygKICAgICAgICAgICAgQXNzZXJ0aW9uRXJyb3IsCiAgICAgICAgICAgIG1vY2suYXNzZXJ0X2FueV9jYWxsCiAgICAgICAgKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKAogICAgICAgICAgICBBc3NlcnRpb25FcnJvciwKICAgICAgICAgICAgbW9jay5hc3NlcnRfYW55X2NhbGwsCiAgICAgICAgICAgIDEsIDMKICAgICAgICApCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgIEFzc2VydGlvbkVycm9yLAogICAgICAgICAgICBtb2NrLmFzc2VydF9hbnlfY2FsbCwKICAgICAgICAgICAgYT00CiAgICAgICAgKQoKCiAgICBkZWYgdGVzdF9tb2NrX2NhbGxzX2NyZWF0ZV9hdXRvc3BlYyhzZWxmKToKICAgICAgICBkZWYgZihhLCBiKToKICAgICAgICAgICAgcGFzcwogICAgICAgIG9iaiA9IEl0ZXIoKQogICAgICAgIG9iai5mID0gZgoKICAgICAgICBmdW5jcyA9IFsKICAgICAgICAgICAgY3JlYXRlX2F1dG9zcGVjKGYpLAogICAgICAgICAgICBjcmVhdGVfYXV0b3NwZWMob2JqKS5mCiAgICAgICAgXQogICAgICAgIGZvciBmdW5jIGluIGZ1bmNzOgogICAgICAgICAgICBmdW5jKDEsIDIpCiAgICAgICAgICAgIGZ1bmMoMywgNCkKCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoCiAgICAgICAgICAgICAgICBmdW5jLm1vY2tfY2FsbHMsIFtjYWxsKDEsIDIpLCBjYWxsKDMsIDQpXQogICAgICAgICAgICApCgoKICAgIGRlZiB0ZXN0X21vY2tfYWRkX3NwZWMoc2VsZik6CiAgICAgICAgY2xhc3MgX09uZShvYmplY3QpOgogICAgICAgICAgICBvbmUgPSAxCiAgICAgICAgY2xhc3MgX1R3byhvYmplY3QpOgogICAgICAgICAgICB0d28gPSAyCiAgICAgICAgY2xhc3MgQW55dGhpbmcob2JqZWN0KToKICAgICAgICAgICAgb25lID0gdHdvID0gdGhyZWUgPSAnZm91cicKCiAgICAgICAga2xhc3NlcyA9IFsKICAgICAgICAgICAgTW9jaywgTWFnaWNNb2NrLCBOb25DYWxsYWJsZU1vY2ssIE5vbkNhbGxhYmxlTWFnaWNNb2NrCiAgICAgICAgXQogICAgICAgIGZvciBLbGFzcyBpbiBsaXN0KGtsYXNzZXMpOgogICAgICAgICAgICBrbGFzc2VzLmFwcGVuZChsYW1iZGEgSz1LbGFzczogSyhzcGVjPUFueXRoaW5nKSkKICAgICAgICAgICAga2xhc3Nlcy5hcHBlbmQobGFtYmRhIEs9S2xhc3M6IEsoc3BlY19zZXQ9QW55dGhpbmcpKQoKICAgICAgICBmb3IgS2xhc3MgaW4ga2xhc3NlczoKICAgICAgICAgICAgZm9yIGt3YXJncyBpbiBkaWN0KCksIGRpY3Qoc3BlY19zZXQ9VHJ1ZSk6CiAgICAgICAgICAgICAgICBtb2NrID0gS2xhc3MoKQogICAgICAgICAgICAgICAgI25vIGVycm9yCiAgICAgICAgICAgICAgICBtb2NrLm9uZSwgbW9jay50d28sIG1vY2sudGhyZWUKCiAgICAgICAgICAgICAgICBmb3IgT25lLCBUd28gaW4gWyhfT25lLCBfVHdvKSwgKFsnb25lJ10sIFsndHdvJ10pXToKICAgICAgICAgICAgICAgICAgICBmb3Iga3dhcmdzIGluIGRpY3QoKSwgZGljdChzcGVjX3NldD1UcnVlKToKICAgICAgICAgICAgICAgICAgICAgICAgbW9jay5tb2NrX2FkZF9zcGVjKE9uZSwgKiprd2FyZ3MpCgogICAgICAgICAgICAgICAgICAgICAgICBtb2NrLm9uZQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEF0dHJpYnV0ZUVycm9yLCBnZXRhdHRyLCBtb2NrLCAndHdvJwogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIG1vY2ssICd0aHJlZScKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICBpZiAnc3BlY19zZXQnIGluIGt3YXJnczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEF0dHJpYnV0ZUVycm9yLCBzZXRhdHRyLCBtb2NrLCAndGhyZWUnLCBOb25lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCgogICAgICAgICAgICAgICAgICAgICAgICBtb2NrLm1vY2tfYWRkX3NwZWMoVHdvLCAqKmt3YXJncykKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgbW9jaywgJ29uZScKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICBtb2NrLnR3bwogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEF0dHJpYnV0ZUVycm9yLCBnZXRhdHRyLCBtb2NrLCAndGhyZWUnCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ3NwZWNfc2V0JyBpbiBrd2FyZ3M6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcygKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBdHRyaWJ1dGVFcnJvciwgc2V0YXR0ciwgbW9jaywgJ3RocmVlJywgTm9uZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAjIG5vdGUgdGhhdCBjcmVhdGluZyBhIG1vY2ssIHNldHRpbmcgYW4gaW5zdGFuY2UgYXR0cmlidXRlLCBhbmQKICAgICAgICAgICAgIyAqdGhlbiogc2V0dGluZyBhIHNwZWMgZG9lc24ndCB3b3JrLiBOb3QgdGhlIGludGVuZGVkIHVzZSBjYXNlCgoKICAgIGRlZiB0ZXN0X21vY2tfYWRkX3NwZWNfbWFnaWNfbWV0aG9kcyhzZWxmKToKICAgICAgICBmb3IgS2xhc3MgaW4gTWFnaWNNb2NrLCBOb25DYWxsYWJsZU1hZ2ljTW9jazoKICAgICAgICAgICAgbW9jayA9IEtsYXNzKCkKICAgICAgICAgICAgaW50KG1vY2spCgogICAgICAgICAgICBtb2NrLm1vY2tfYWRkX3NwZWMob2JqZWN0KQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGludCwgbW9jaykKCiAgICAgICAgICAgIG1vY2sgPSBLbGFzcygpCiAgICAgICAgICAgIG1vY2tbJ2ZvbyddCiAgICAgICAgICAgIG1vY2suX19pbnRfXy5yZXR1cm5fdmFsdWUgPTQKCiAgICAgICAgICAgIG1vY2subW9ja19hZGRfc3BlYyhpbnQpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoaW50KG1vY2spLCA0KQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGxhbWJkYTogbW9ja1snZm9vJ10pCgoKICAgIGRlZiB0ZXN0X2FkZGluZ19jaGlsZF9tb2NrKHNlbGYpOgogICAgICAgIGZvciBLbGFzcyBpbiBOb25DYWxsYWJsZU1vY2ssIE1vY2ssIE1hZ2ljTW9jaywgTm9uQ2FsbGFibGVNYWdpY01vY2s6CiAgICAgICAgICAgIG1vY2sgPSBLbGFzcygpCgogICAgICAgICAgICBtb2NrLmZvbyA9IE1vY2soKQogICAgICAgICAgICBtb2NrLmZvbygpCgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subWV0aG9kX2NhbGxzLCBbY2FsbC5mb28oKV0pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tb2NrX2NhbGxzLCBbY2FsbC5mb28oKV0pCgogICAgICAgICAgICBtb2NrID0gS2xhc3MoKQogICAgICAgICAgICBtb2NrLmJhciA9IE1vY2sobmFtZT0nbmFtZScpCiAgICAgICAgICAgIG1vY2suYmFyKCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLm1ldGhvZF9jYWxscywgW10pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tb2NrX2NhbGxzLCBbXSkKCiAgICAgICAgICAgICMgbW9jayB3aXRoIGFuIGV4aXN0aW5nIF9uZXdfcGFyZW50IGJ1dCBubyBuYW1lCiAgICAgICAgICAgIG1vY2sgPSBLbGFzcygpCiAgICAgICAgICAgIG1vY2suYmF6ID0gTWFnaWNNb2NrKCkoKQogICAgICAgICAgICBtb2NrLmJheigpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tZXRob2RfY2FsbHMsIFtdKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subW9ja19jYWxscywgW10pCgoKICAgIGRlZiB0ZXN0X2FkZGluZ19yZXR1cm5fdmFsdWVfbW9jayhzZWxmKToKICAgICAgICBmb3IgS2xhc3MgaW4gTW9jaywgTWFnaWNNb2NrOgogICAgICAgICAgICBtb2NrID0gS2xhc3MoKQogICAgICAgICAgICBtb2NrLnJldHVybl92YWx1ZSA9IE1hZ2ljTW9jaygpCgogICAgICAgICAgICBtb2NrKCkoKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2subW9ja19jYWxscywgW2NhbGwoKSwgY2FsbCgpKCldKQoKCiAgICBkZWYgdGVzdF9tYW5hZ2VyX21vY2soc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKG9iamVjdCk6CiAgICAgICAgICAgIG9uZSA9ICdvbmUnCiAgICAgICAgICAgIHR3byA9ICd0d28nCiAgICAgICAgbWFuYWdlciA9IE1vY2soKQogICAgICAgIHAxID0gcGF0Y2gub2JqZWN0KEZvbywgJ29uZScpCiAgICAgICAgcDIgPSBwYXRjaC5vYmplY3QoRm9vLCAndHdvJykKCiAgICAgICAgbW9ja19vbmUgPSBwMS5zdGFydCgpCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHAxLnN0b3ApCiAgICAgICAgbW9ja190d28gPSBwMi5zdGFydCgpCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHAyLnN0b3ApCgogICAgICAgIG1hbmFnZXIuYXR0YWNoX21vY2sobW9ja19vbmUsICdvbmUnKQogICAgICAgIG1hbmFnZXIuYXR0YWNoX21vY2sobW9ja190d28sICd0d28nKQoKICAgICAgICBGb28udHdvKCkKICAgICAgICBGb28ub25lKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtYW5hZ2VyLm1vY2tfY2FsbHMsIFtjYWxsLnR3bygpLCBjYWxsLm9uZSgpXSkKCgogICAgZGVmIHRlc3RfbWFnaWNfbWV0aG9kc19tb2NrX2NhbGxzKHNlbGYpOgogICAgICAgIGZvciBLbGFzcyBpbiBNb2NrLCBNYWdpY01vY2s6CiAgICAgICAgICAgIG0gPSBLbGFzcygpCiAgICAgICAgICAgIG0uX19pbnRfXyA9IE1vY2socmV0dXJuX3ZhbHVlPTMpCiAgICAgICAgICAgIG0uX19mbG9hdF9fID0gTWFnaWNNb2NrKHJldHVybl92YWx1ZT0zLjApCiAgICAgICAgICAgIGludChtKQogICAgICAgICAgICBmbG9hdChtKQoKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtLm1vY2tfY2FsbHMsIFtjYWxsLl9faW50X18oKSwgY2FsbC5fX2Zsb2F0X18oKV0pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobS5tZXRob2RfY2FsbHMsIFtdKQoKCiAgICBkZWYgdGVzdF9hdHRyaWJ1dGVfZGVsZXRpb24oc2VsZik6CiAgICAgICAgIyB0aGlzIGJlaGF2aW91ciBpc24ndCAqdXNlZnVsKiwgYnV0IGF0IGxlYXN0IGl0J3Mgbm93IHRlc3RlZC4uLgogICAgICAgIGZvciBLbGFzcyBpbiBNb2NrLCBNYWdpY01vY2ssIE5vbkNhbGxhYmxlTWFnaWNNb2NrLCBOb25DYWxsYWJsZU1vY2s6CiAgICAgICAgICAgIG0gPSBLbGFzcygpCiAgICAgICAgICAgIG9yaWdpbmFsID0gbS5mb28KICAgICAgICAgICAgbS5mb28gPSAzCiAgICAgICAgICAgIGRlbCBtLmZvbwogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0uZm9vLCBvcmlnaW5hbCkKCiAgICAgICAgICAgIG5ldyA9IG0uZm9vID0gTW9jaygpCiAgICAgICAgICAgIGRlbCBtLmZvbwogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0uZm9vLCBuZXcpCgoKICAgIGRlZiB0ZXN0X21vY2tfcGFyZW50cyhzZWxmKToKICAgICAgICBmb3IgS2xhc3MgaW4gTW9jaywgTWFnaWNNb2NrOgogICAgICAgICAgICBtID0gS2xhc3MoKQogICAgICAgICAgICBvcmlnaW5hbF9yZXByID0gcmVwcihtKQogICAgICAgICAgICBtLnJldHVybl92YWx1ZSA9IG0KICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhtKCksIG0pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVwcihtKSwgb3JpZ2luYWxfcmVwcikKCiAgICAgICAgICAgIG0ucmVzZXRfbW9jaygpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMobSgpLCBtKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlcHIobSksIG9yaWdpbmFsX3JlcHIpCgogICAgICAgICAgICBtID0gS2xhc3MoKQogICAgICAgICAgICBtLmIgPSBtLmEKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigibmFtZT0nbW9jay5hJyIsIHJlcHIobS5iKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigibmFtZT0nbW9jay5hJyIsIHJlcHIobS5hKSkKICAgICAgICAgICAgbS5yZXNldF9tb2NrKCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigibmFtZT0nbW9jay5hJyIsIHJlcHIobS5iKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigibmFtZT0nbW9jay5hJyIsIHJlcHIobS5hKSkKCiAgICAgICAgICAgIG0gPSBLbGFzcygpCiAgICAgICAgICAgIG9yaWdpbmFsX3JlcHIgPSByZXByKG0pCiAgICAgICAgICAgIG0uYSA9IG0oKQogICAgICAgICAgICBtLmEucmV0dXJuX3ZhbHVlID0gbQoKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXByKG0pLCBvcmlnaW5hbF9yZXByKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlcHIobS5hKCkpLCBvcmlnaW5hbF9yZXByKQoKCiAgICBkZWYgdGVzdF9hdHRhY2hfbW9jayhzZWxmKToKICAgICAgICBjbGFzc2VzID0gTW9jaywgTWFnaWNNb2NrLCBOb25DYWxsYWJsZU1hZ2ljTW9jaywgTm9uQ2FsbGFibGVNb2NrCiAgICAgICAgZm9yIEtsYXNzIGluIGNsYXNzZXM6CiAgICAgICAgICAgIGZvciBLbGFzczIgaW4gY2xhc3NlczoKICAgICAgICAgICAgICAgIG0gPSBLbGFzcygpCgogICAgICAgICAgICAgICAgbTIgPSBLbGFzczIobmFtZT0nZm9vJykKICAgICAgICAgICAgICAgIG0uYXR0YWNoX21vY2sobTIsICdiYXInKQoKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMobS5iYXIsIG0yKQogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigibmFtZT0nbW9jay5iYXInIiwgcmVwcihtMikpCgogICAgICAgICAgICAgICAgbS5iYXIuYmF6KDEpCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0ubW9ja19jYWxscywgW2NhbGwuYmFyLmJheigxKV0pCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0ubWV0aG9kX2NhbGxzLCBbY2FsbC5iYXIuYmF6KDEpXSkKCgogICAgZGVmIHRlc3RfYXR0YWNoX21vY2tfcmV0dXJuX3ZhbHVlKHNlbGYpOgogICAgICAgIGNsYXNzZXMgPSBNb2NrLCBNYWdpY01vY2ssIE5vbkNhbGxhYmxlTWFnaWNNb2NrLCBOb25DYWxsYWJsZU1vY2sKICAgICAgICBmb3IgS2xhc3MgaW4gTW9jaywgTWFnaWNNb2NrOgogICAgICAgICAgICBmb3IgS2xhc3MyIGluIGNsYXNzZXM6CiAgICAgICAgICAgICAgICBtID0gS2xhc3MoKQoKICAgICAgICAgICAgICAgIG0yID0gS2xhc3MyKG5hbWU9J2ZvbycpCiAgICAgICAgICAgICAgICBtLmF0dGFjaF9tb2NrKG0yLCAncmV0dXJuX3ZhbHVlJykKCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydElzKG0oKSwgbTIpCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEluKCJuYW1lPSdtb2NrKCknIiwgcmVwcihtMikpCgogICAgICAgICAgICAgICAgbTIuZm9vKCkKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobS5tb2NrX2NhbGxzLCBjYWxsKCkuZm9vKCkuY2FsbF9saXN0KCkpCgoKICAgIGRlZiB0ZXN0X2F0dHJpYnV0ZV9kZWxldGlvbihzZWxmKToKICAgICAgICBmb3IgbW9jayBpbiBNb2NrKCksIE1hZ2ljTW9jaygpOgogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaGFzYXR0cihtb2NrLCAnbScpKQoKICAgICAgICAgICAgZGVsIG1vY2subQogICAgICAgICAgICBzZWxmLmFzc2VydEZhbHNlKGhhc2F0dHIobW9jaywgJ20nKSkKCiAgICAgICAgICAgIGRlbCBtb2NrLmYKICAgICAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShoYXNhdHRyKG1vY2ssICdmJykpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBnZXRhdHRyLCBtb2NrLCAnZicpCgoKICAgIGRlZiB0ZXN0X2NsYXNzX2Fzc2lnbmFibGUoc2VsZik6CiAgICAgICAgZm9yIG1vY2sgaW4gTW9jaygpLCBNYWdpY01vY2soKToKICAgICAgICAgICAgc2VsZi5hc3NlcnROb3RJc0luc3RhbmNlKG1vY2ssIGludCkKCiAgICAgICAgICAgIG1vY2suX19jbGFzc19fID0gaW50CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrLCBpbnQpCiAgICAgICAgICAgIG1vY2suZm9vCgoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICB1bml0dGVzdC5tYWluKCkK',
'/Lib/unittest/test/testmock/testpatch.py':'IyBDb3B5cmlnaHQgKEMpIDIwMDctMjAxMiBNaWNoYWVsIEZvb3JkICYgdGhlIG1vY2sgdGVhbQojIEUtbWFpbDogZnV6enltYW4gQVQgdm9pZHNwYWNlIERPVCBvcmcgRE9UIHVrCiMgaHR0cDovL3d3dy52b2lkc3BhY2Uub3JnLnVrL3B5dGhvbi9tb2NrLwoKaW1wb3J0IG9zCmltcG9ydCBzeXMKCmltcG9ydCB1bml0dGVzdApmcm9tIHVuaXR0ZXN0LnRlc3QudGVzdG1vY2sgaW1wb3J0IHN1cHBvcnQKZnJvbSB1bml0dGVzdC50ZXN0LnRlc3Rtb2NrLnN1cHBvcnQgaW1wb3J0IFNvbWVDbGFzcywgaXNfaW5zdGFuY2UKCmZyb20gdW5pdHRlc3QubW9jayBpbXBvcnQgKAogICAgTm9uQ2FsbGFibGVNb2NrLCBDYWxsYWJsZU1peGluLCBwYXRjaCwgc2VudGluZWwsCiAgICBNYWdpY01vY2ssIE1vY2ssIE5vbkNhbGxhYmxlTWFnaWNNb2NrLCBwYXRjaCwgX3BhdGNoLAogICAgREVGQVVMVCwgY2FsbCwgX2dldF90YXJnZXQKKQoKCmJ1aWx0aW5fc3RyaW5nID0gJ2J1aWx0aW5zJwoKUFRNb2R1bGUgPSBzeXMubW9kdWxlc1tfX25hbWVfX10KTU9ETkFNRSA9ICclcy5QVE1vZHVsZScgJSBfX25hbWVfXwoKCmRlZiBfZ2V0X3Byb3h5KG9iaiwgZ2V0X29ubHk9VHJ1ZSk6CiAgICBjbGFzcyBQcm94eShvYmplY3QpOgogICAgICAgIGRlZiBfX2dldGF0dHJfXyhzZWxmLCBuYW1lKToKICAgICAgICAgICAgcmV0dXJuIGdldGF0dHIob2JqLCBuYW1lKQogICAgaWYgbm90IGdldF9vbmx5OgogICAgICAgIGRlZiBfX3NldGF0dHJfXyhzZWxmLCBuYW1lLCB2YWx1ZSk6CiAgICAgICAgICAgIHNldGF0dHIob2JqLCBuYW1lLCB2YWx1ZSkKICAgICAgICBkZWYgX19kZWxhdHRyX18oc2VsZiwgbmFtZSk6CiAgICAgICAgICAgIGRlbGF0dHIob2JqLCBuYW1lKQogICAgICAgIFByb3h5Ll9fc2V0YXR0cl9fID0gX19zZXRhdHRyX18KICAgICAgICBQcm94eS5fX2RlbGF0dHJfXyA9IF9fZGVsYXR0cl9fCiAgICByZXR1cm4gUHJveHkoKQoKCiMgZm9yIHVzZSBpbiB0aGUgdGVzdApzb21ldGhpbmcgID0gc2VudGluZWwuU29tZXRoaW5nCnNvbWV0aGluZ19lbHNlICA9IHNlbnRpbmVsLlNvbWV0aGluZ0Vsc2UKCgpjbGFzcyBGb28ob2JqZWN0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBhKToKICAgICAgICBwYXNzCiAgICBkZWYgZihzZWxmLCBhKToKICAgICAgICBwYXNzCiAgICBkZWYgZyhzZWxmKToKICAgICAgICBwYXNzCiAgICBmb28gPSAnYmFyJwoKICAgIGNsYXNzIEJhcihvYmplY3QpOgogICAgICAgIGRlZiBhKHNlbGYpOgogICAgICAgICAgICBwYXNzCgpmb29fbmFtZSA9ICclcy5Gb28nICUgX19uYW1lX18KCgpkZWYgZnVuY3Rpb24oYSwgYj1Gb28pOgogICAgcGFzcwoKCmNsYXNzIENvbnRhaW5lcihvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYudmFsdWVzID0ge30KCiAgICBkZWYgX19nZXRpdGVtX18oc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIHNlbGYudmFsdWVzW25hbWVdCgogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIG5hbWUsIHZhbHVlKToKICAgICAgICBzZWxmLnZhbHVlc1tuYW1lXSA9IHZhbHVlCgogICAgZGVmIF9fZGVsaXRlbV9fKHNlbGYsIG5hbWUpOgogICAgICAgIGRlbCBzZWxmLnZhbHVlc1tuYW1lXQoKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gaXRlcihzZWxmLnZhbHVlcykKCgoKY2xhc3MgUGF0Y2hUZXN0KHVuaXR0ZXN0LlRlc3RDYXNlKToKCiAgICBkZWYgYXNzZXJ0Tm90Q2FsbGFibGUoc2VsZiwgb2JqLCBtYWdpYz1UcnVlKToKICAgICAgICBNb2NrQ2xhc3MgPSBOb25DYWxsYWJsZU1hZ2ljTW9jawogICAgICAgIGlmIG5vdCBtYWdpYzoKICAgICAgICAgICAgTW9ja0NsYXNzID0gTm9uQ2FsbGFibGVNb2NrCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgb2JqKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShpc19pbnN0YW5jZShvYmosIE1vY2tDbGFzcykpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShpc19pbnN0YW5jZShvYmosIENhbGxhYmxlTWl4aW4pKQoKCiAgICBkZWYgdGVzdF9zaW5nbGVfcGF0Y2hvYmplY3Qoc2VsZik6CiAgICAgICAgY2xhc3MgU29tZXRoaW5nKG9iamVjdCk6CiAgICAgICAgICAgIGF0dHJpYnV0ZSA9IHNlbnRpbmVsLk9yaWdpbmFsCgogICAgICAgIEBwYXRjaC5vYmplY3QoU29tZXRoaW5nLCAnYXR0cmlidXRlJywgc2VudGluZWwuUGF0Y2hlZCkKICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFNvbWV0aGluZy5hdHRyaWJ1dGUsIHNlbnRpbmVsLlBhdGNoZWQsICJ1bnBhdGNoZWQiKQoKICAgICAgICB0ZXN0KCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFNvbWV0aGluZy5hdHRyaWJ1dGUsIHNlbnRpbmVsLk9yaWdpbmFsLAogICAgICAgICAgICAgICAgICAgICAgICAgInBhdGNoIG5vdCByZXN0b3JlZCIpCgoKICAgIGRlZiB0ZXN0X3BhdGNob2JqZWN0X3dpdGhfbm9uZShzZWxmKToKICAgICAgICBjbGFzcyBTb21ldGhpbmcob2JqZWN0KToKICAgICAgICAgICAgYXR0cmlidXRlID0gc2VudGluZWwuT3JpZ2luYWwKCiAgICAgICAgQHBhdGNoLm9iamVjdChTb21ldGhpbmcsICdhdHRyaWJ1dGUnLCBOb25lKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNOb25lKFNvbWV0aGluZy5hdHRyaWJ1dGUsICJ1bnBhdGNoZWQiKQoKICAgICAgICB0ZXN0KCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFNvbWV0aGluZy5hdHRyaWJ1dGUsIHNlbnRpbmVsLk9yaWdpbmFsLAogICAgICAgICAgICAgICAgICAgICAgICAgInBhdGNoIG5vdCByZXN0b3JlZCIpCgoKICAgIGRlZiB0ZXN0X211bHRpcGxlX3BhdGNob2JqZWN0KHNlbGYpOgogICAgICAgIGNsYXNzIFNvbWV0aGluZyhvYmplY3QpOgogICAgICAgICAgICBhdHRyaWJ1dGUgPSBzZW50aW5lbC5PcmlnaW5hbAogICAgICAgICAgICBuZXh0X2F0dHJpYnV0ZSA9IHNlbnRpbmVsLk9yaWdpbmFsMgoKICAgICAgICBAcGF0Y2gub2JqZWN0KFNvbWV0aGluZywgJ2F0dHJpYnV0ZScsIHNlbnRpbmVsLlBhdGNoZWQpCiAgICAgICAgQHBhdGNoLm9iamVjdChTb21ldGhpbmcsICduZXh0X2F0dHJpYnV0ZScsIHNlbnRpbmVsLlBhdGNoZWQyKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZXRoaW5nLmF0dHJpYnV0ZSwgc2VudGluZWwuUGF0Y2hlZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidW5wYXRjaGVkIikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChTb21ldGhpbmcubmV4dF9hdHRyaWJ1dGUsIHNlbnRpbmVsLlBhdGNoZWQyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ1bnBhdGNoZWQiKQoKICAgICAgICB0ZXN0KCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFNvbWV0aGluZy5hdHRyaWJ1dGUsIHNlbnRpbmVsLk9yaWdpbmFsLAogICAgICAgICAgICAgICAgICAgICAgICAgInBhdGNoIG5vdCByZXN0b3JlZCIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChTb21ldGhpbmcubmV4dF9hdHRyaWJ1dGUsIHNlbnRpbmVsLk9yaWdpbmFsMiwKICAgICAgICAgICAgICAgICAgICAgICAgICJwYXRjaCBub3QgcmVzdG9yZWQiKQoKCiAgICBkZWYgdGVzdF9vYmplY3RfbG9va3VwX2lzX3F1aXRlX2xhenkoc2VsZik6CiAgICAgICAgZ2xvYmFsIHNvbWV0aGluZwogICAgICAgIG9yaWdpbmFsID0gc29tZXRoaW5nCiAgICAgICAgQHBhdGNoKCclcy5zb21ldGhpbmcnICUgX19uYW1lX18sIHNlbnRpbmVsLlNvbWV0aGluZzIpCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNvbWV0aGluZyA9IHNlbnRpbmVsLnJlcGxhY2VtZW50X3ZhbHVlCiAgICAgICAgICAgIHRlc3QoKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNvbWV0aGluZywgc2VudGluZWwucmVwbGFjZW1lbnRfdmFsdWUpCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgc29tZXRoaW5nID0gb3JpZ2luYWwKCgogICAgZGVmIHRlc3RfcGF0Y2goc2VsZik6CiAgICAgICAgQHBhdGNoKCclcy5zb21ldGhpbmcnICUgX19uYW1lX18sIHNlbnRpbmVsLlNvbWV0aGluZzIpCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChQVE1vZHVsZS5zb21ldGhpbmcsIHNlbnRpbmVsLlNvbWV0aGluZzIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInVucGF0Y2hlZCIpCgogICAgICAgIHRlc3QoKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoUFRNb2R1bGUuc29tZXRoaW5nLCBzZW50aW5lbC5Tb21ldGhpbmcsCiAgICAgICAgICAgICAgICAgICAgICAgICAicGF0Y2ggbm90IHJlc3RvcmVkIikKCiAgICAgICAgQHBhdGNoKCclcy5zb21ldGhpbmcnICUgX19uYW1lX18sIHNlbnRpbmVsLlNvbWV0aGluZzIpCiAgICAgICAgQHBhdGNoKCclcy5zb21ldGhpbmdfZWxzZScgJSBfX25hbWVfXywgc2VudGluZWwuU29tZXRoaW5nRWxzZSkKICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFBUTW9kdWxlLnNvbWV0aGluZywgc2VudGluZWwuU29tZXRoaW5nMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidW5wYXRjaGVkIikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChQVE1vZHVsZS5zb21ldGhpbmdfZWxzZSwgc2VudGluZWwuU29tZXRoaW5nRWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidW5wYXRjaGVkIikKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChQVE1vZHVsZS5zb21ldGhpbmcsIHNlbnRpbmVsLlNvbWV0aGluZywKICAgICAgICAgICAgICAgICAgICAgICAgICJwYXRjaCBub3QgcmVzdG9yZWQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoUFRNb2R1bGUuc29tZXRoaW5nX2Vsc2UsIHNlbnRpbmVsLlNvbWV0aGluZ0Vsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAicGF0Y2ggbm90IHJlc3RvcmVkIikKCiAgICAgICAgIyBUZXN0IHRoZSBwYXRjaGluZyBhbmQgcmVzdG9yaW5nIHdvcmtzIGEgc2Vjb25kIHRpbWUKICAgICAgICB0ZXN0KCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChQVE1vZHVsZS5zb21ldGhpbmcsIHNlbnRpbmVsLlNvbWV0aGluZywKICAgICAgICAgICAgICAgICAgICAgICAgICJwYXRjaCBub3QgcmVzdG9yZWQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoUFRNb2R1bGUuc29tZXRoaW5nX2Vsc2UsIHNlbnRpbmVsLlNvbWV0aGluZ0Vsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAicGF0Y2ggbm90IHJlc3RvcmVkIikKCiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2sucmV0dXJuX3ZhbHVlID0gc2VudGluZWwuSGFuZGxlCiAgICAgICAgQHBhdGNoKCclcy5vcGVuJyAlIGJ1aWx0aW5fc3RyaW5nLCBtb2NrKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwob3BlbignZmlsZW5hbWUnLCAncicpLCBzZW50aW5lbC5IYW5kbGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm9wZW4gbm90IHBhdGNoZWQiKQogICAgICAgIHRlc3QoKQogICAgICAgIHRlc3QoKQoKICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKG9wZW4sIG1vY2ssICJwYXRjaCBub3QgcmVzdG9yZWQiKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9jbGFzc19hdHRyaWJ1dGUoc2VsZik6CiAgICAgICAgQHBhdGNoKCclcy5Tb21lQ2xhc3MuY2xhc3NfYXR0cmlidXRlJyAlIF9fbmFtZV9fLAogICAgICAgICAgICAgICBzZW50aW5lbC5DbGFzc0F0dHJpYnV0ZSkKICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFBUTW9kdWxlLlNvbWVDbGFzcy5jbGFzc19hdHRyaWJ1dGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VudGluZWwuQ2xhc3NBdHRyaWJ1dGUsICJ1bnBhdGNoZWQiKQogICAgICAgIHRlc3QoKQoKICAgICAgICBzZWxmLmFzc2VydElzTm9uZShQVE1vZHVsZS5Tb21lQ2xhc3MuY2xhc3NfYXR0cmlidXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICJwYXRjaCBub3QgcmVzdG9yZWQiKQoKCiAgICBkZWYgdGVzdF9wYXRjaG9iamVjdF93aXRoX2RlZmF1bHRfbW9jayhzZWxmKToKICAgICAgICBjbGFzcyBUZXN0KG9iamVjdCk6CiAgICAgICAgICAgIHNvbWV0aGluZyA9IHNlbnRpbmVsLk9yaWdpbmFsCiAgICAgICAgICAgIHNvbWV0aGluZzIgPSBzZW50aW5lbC5PcmlnaW5hbDIKCiAgICAgICAgQHBhdGNoLm9iamVjdChUZXN0LCAnc29tZXRoaW5nJykKICAgICAgICBkZWYgdGVzdChtb2NrKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtb2NrLCBUZXN0LnNvbWV0aGluZywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTW9jayBub3QgcGFzc2VkIGludG8gdGVzdCBmdW5jdGlvbiIpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrLCBNYWdpY01vY2ssCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAicGF0Y2ggd2l0aCB0d28gYXJndW1lbnRzIGRpZCBub3QgY3JlYXRlIGEgbW9jayIpCgogICAgICAgIHRlc3QoKQoKICAgICAgICBAcGF0Y2gub2JqZWN0KFRlc3QsICdzb21ldGhpbmcnKQogICAgICAgIEBwYXRjaC5vYmplY3QoVGVzdCwgJ3NvbWV0aGluZzInKQogICAgICAgIGRlZiB0ZXN0KHRoaXMxLCB0aGlzMiwgbW9jazEsIG1vY2syKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCh0aGlzMSwgc2VudGluZWwudGhpczEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlBhdGNoZWQgZnVuY3Rpb24gZGlkbid0IHJlY2VpdmUgaW5pdGlhbCBhcmd1bWVudCIpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwodGhpczIsIHNlbnRpbmVsLnRoaXMyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJQYXRjaGVkIGZ1bmN0aW9uIGRpZG4ndCByZWNlaXZlIHNlY29uZCBhcmd1bWVudCIpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jazEsIFRlc3Quc29tZXRoaW5nMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTW9jayBub3QgcGFzc2VkIGludG8gdGVzdCBmdW5jdGlvbiIpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jazIsIFRlc3Quc29tZXRoaW5nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJTZWNvbmQgTW9jayBub3QgcGFzc2VkIGludG8gdGVzdCBmdW5jdGlvbiIpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrMiwgTWFnaWNNb2NrLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInBhdGNoIHdpdGggdHdvIGFyZ3VtZW50cyBkaWQgbm90IGNyZWF0ZSBhIG1vY2siKQogICAgICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jazIsIE1hZ2ljTW9jaywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJwYXRjaCB3aXRoIHR3byBhcmd1bWVudHMgZGlkIG5vdCBjcmVhdGUgYSBtb2NrIikKCiAgICAgICAgICAgICMgQSBoYWNrIHRvIHRlc3QgdGhhdCBuZXcgbW9ja3MgYXJlIHBhc3NlZCB0aGUgc2Vjb25kIHRpbWUKICAgICAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChvdXRlck1vY2sxLCBtb2NrMSwgInVuZXhwZWN0ZWQgdmFsdWUgZm9yIG1vY2sxIikKICAgICAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChvdXRlck1vY2syLCBtb2NrMiwgInVuZXhwZWN0ZWQgdmFsdWUgZm9yIG1vY2sxIikKICAgICAgICAgICAgcmV0dXJuIG1vY2sxLCBtb2NrMgoKICAgICAgICBvdXRlck1vY2sxID0gb3V0ZXJNb2NrMiA9IE5vbmUKICAgICAgICBvdXRlck1vY2sxLCBvdXRlck1vY2syID0gdGVzdChzZW50aW5lbC50aGlzMSwgc2VudGluZWwudGhpczIpCgogICAgICAgICMgVGVzdCB0aGF0IGV4ZWN1dGluZyBhIHNlY29uZCB0aW1lIGNyZWF0ZXMgbmV3IG1vY2tzCiAgICAgICAgdGVzdChzZW50aW5lbC50aGlzMSwgc2VudGluZWwudGhpczIpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX3dpdGhfc3BlYyhzZWxmKToKICAgICAgICBAcGF0Y2goJyVzLlNvbWVDbGFzcycgJSBfX25hbWVfXywgc3BlYz1Tb21lQ2xhc3MpCiAgICAgICAgZGVmIHRlc3QoTW9ja1NvbWVDbGFzcyk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZUNsYXNzLCBNb2NrU29tZUNsYXNzKQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UoU29tZUNsYXNzLndpYmJsZSwgTWFnaWNNb2NrKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGxhbWJkYTogU29tZUNsYXNzLm5vdF93aWJibGUpCgogICAgICAgIHRlc3QoKQoKCiAgICBkZWYgdGVzdF9wYXRjaG9iamVjdF93aXRoX3NwZWMoc2VsZik6CiAgICAgICAgQHBhdGNoLm9iamVjdChTb21lQ2xhc3MsICdjbGFzc19hdHRyaWJ1dGUnLCBzcGVjPVNvbWVDbGFzcykKICAgICAgICBkZWYgdGVzdChNb2NrQXR0cmlidXRlKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChTb21lQ2xhc3MuY2xhc3NfYXR0cmlidXRlLCBNb2NrQXR0cmlidXRlKQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UoU29tZUNsYXNzLmNsYXNzX2F0dHJpYnV0ZS53aWJibGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hZ2ljTW9jaykpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYW1iZGE6IFNvbWVDbGFzcy5jbGFzc19hdHRyaWJ1dGUubm90X3dpYmJsZSkKCiAgICAgICAgdGVzdCgpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX3dpdGhfc3BlY19hc19saXN0KHNlbGYpOgogICAgICAgIEBwYXRjaCgnJXMuU29tZUNsYXNzJyAlIF9fbmFtZV9fLCBzcGVjPVsnd2liYmxlJ10pCiAgICAgICAgZGVmIHRlc3QoTW9ja1NvbWVDbGFzcyk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZUNsYXNzLCBNb2NrU29tZUNsYXNzKQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UoU29tZUNsYXNzLndpYmJsZSwgTWFnaWNNb2NrKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGxhbWJkYTogU29tZUNsYXNzLm5vdF93aWJibGUpCgogICAgICAgIHRlc3QoKQoKCiAgICBkZWYgdGVzdF9wYXRjaG9iamVjdF93aXRoX3NwZWNfYXNfbGlzdChzZWxmKToKICAgICAgICBAcGF0Y2gub2JqZWN0KFNvbWVDbGFzcywgJ2NsYXNzX2F0dHJpYnV0ZScsIHNwZWM9Wyd3aWJibGUnXSkKICAgICAgICBkZWYgdGVzdChNb2NrQXR0cmlidXRlKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChTb21lQ2xhc3MuY2xhc3NfYXR0cmlidXRlLCBNb2NrQXR0cmlidXRlKQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UoU29tZUNsYXNzLmNsYXNzX2F0dHJpYnV0ZS53aWJibGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hZ2ljTW9jaykpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYW1iZGE6IFNvbWVDbGFzcy5jbGFzc19hdHRyaWJ1dGUubm90X3dpYmJsZSkKCiAgICAgICAgdGVzdCgpCgoKICAgIGRlZiB0ZXN0X25lc3RlZF9wYXRjaF93aXRoX3NwZWNfYXNfbGlzdChzZWxmKToKICAgICAgICAjIHJlZ3Jlc3Npb24gdGVzdCBmb3IgbmVzdGVkIGRlY29yYXRvcnMKICAgICAgICBAcGF0Y2goJyVzLm9wZW4nICUgYnVpbHRpbl9zdHJpbmcpCiAgICAgICAgQHBhdGNoKCclcy5Tb21lQ2xhc3MnICUgX19uYW1lX18sIHNwZWM9Wyd3aWJibGUnXSkKICAgICAgICBkZWYgdGVzdChNb2NrU29tZUNsYXNzLCBNb2NrT3Blbik6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZUNsYXNzLCBNb2NrU29tZUNsYXNzKQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UoU29tZUNsYXNzLndpYmJsZSwgTWFnaWNNb2NrKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGxhbWJkYTogU29tZUNsYXNzLm5vdF93aWJibGUpCiAgICAgICAgdGVzdCgpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX3dpdGhfc3BlY19hc19ib29sZWFuKHNlbGYpOgogICAgICAgIEBwYXRjaCgnJXMuU29tZUNsYXNzJyAlIF9fbmFtZV9fLCBzcGVjPVRydWUpCiAgICAgICAgZGVmIHRlc3QoTW9ja1NvbWVDbGFzcyk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZUNsYXNzLCBNb2NrU29tZUNsYXNzKQogICAgICAgICAgICAjIFNob3VsZCBub3QgcmFpc2UgYXR0cmlidXRlIGVycm9yCiAgICAgICAgICAgIE1vY2tTb21lQ2xhc3Mud2liYmxlCgogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgbGFtYmRhOiBNb2NrU29tZUNsYXNzLm5vdF93aWJibGUpCgogICAgICAgIHRlc3QoKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9vYmplY3Rfd2l0aF9zcGVjX2FzX2Jvb2xlYW4oc2VsZik6CiAgICAgICAgQHBhdGNoLm9iamVjdChQVE1vZHVsZSwgJ1NvbWVDbGFzcycsIHNwZWM9VHJ1ZSkKICAgICAgICBkZWYgdGVzdChNb2NrU29tZUNsYXNzKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChTb21lQ2xhc3MsIE1vY2tTb21lQ2xhc3MpCiAgICAgICAgICAgICMgU2hvdWxkIG5vdCByYWlzZSBhdHRyaWJ1dGUgZXJyb3IKICAgICAgICAgICAgTW9ja1NvbWVDbGFzcy53aWJibGUKCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBsYW1iZGE6IE1vY2tTb21lQ2xhc3Mubm90X3dpYmJsZSkKCiAgICAgICAgdGVzdCgpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX2NsYXNzX2FjdHNfd2l0aF9zcGVjX2lzX2luaGVyaXRlZChzZWxmKToKICAgICAgICBAcGF0Y2goJyVzLlNvbWVDbGFzcycgJSBfX25hbWVfXywgc3BlYz1UcnVlKQogICAgICAgIGRlZiB0ZXN0KE1vY2tTb21lQ2xhc3MpOgogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UoTW9ja1NvbWVDbGFzcywgTWFnaWNNb2NrKSkKICAgICAgICAgICAgaW5zdGFuY2UgPSBNb2NrU29tZUNsYXNzKCkKICAgICAgICAgICAgc2VsZi5hc3NlcnROb3RDYWxsYWJsZShpbnN0YW5jZSkKICAgICAgICAgICAgIyBTaG91bGQgbm90IHJhaXNlIGF0dHJpYnV0ZSBlcnJvcgogICAgICAgICAgICBpbnN0YW5jZS53aWJibGUKCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBsYW1iZGE6IGluc3RhbmNlLm5vdF93aWJibGUpCgogICAgICAgIHRlc3QoKQoKCiAgICBkZWYgdGVzdF9wYXRjaF93aXRoX2NyZWF0ZV9tb2Nrc19ub25fZXhpc3RlbnRfYXR0cmlidXRlcyhzZWxmKToKICAgICAgICBAcGF0Y2goJyVzLmZyb29ibGUnICUgYnVpbHRpbl9zdHJpbmcsIHNlbnRpbmVsLkZyb29ibGUsIGNyZWF0ZT1UcnVlKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZnJvb2JsZSwgc2VudGluZWwuRnJvb2JsZSkKCiAgICAgICAgdGVzdCgpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoTmFtZUVycm9yLCBsYW1iZGE6IGZyb29ibGUpCgoKICAgIGRlZiB0ZXN0X3BhdGNob2JqZWN0X3dpdGhfY3JlYXRlX21vY2tzX25vbl9leGlzdGVudF9hdHRyaWJ1dGVzKHNlbGYpOgogICAgICAgIEBwYXRjaC5vYmplY3QoU29tZUNsYXNzLCAnZnJvb2JsZScsIHNlbnRpbmVsLkZyb29ibGUsIGNyZWF0ZT1UcnVlKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZUNsYXNzLmZyb29ibGUsIHNlbnRpbmVsLkZyb29ibGUpCgogICAgICAgIHRlc3QoKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UoaGFzYXR0cihTb21lQ2xhc3MsICdmcm9vYmxlJykpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX3dvbnRfY3JlYXRlX2J5X2RlZmF1bHQoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBAcGF0Y2goJyVzLmZyb29ibGUnICUgYnVpbHRpbl9zdHJpbmcsIHNlbnRpbmVsLkZyb29ibGUpCiAgICAgICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZyb29ibGUsIHNlbnRpbmVsLkZyb29ibGUpCgogICAgICAgICAgICB0ZXN0KCkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoJ1BhdGNoaW5nIG5vbiBleGlzdGVudCBhdHRyaWJ1dGVzIHNob3VsZCBmYWlsJykKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoTmFtZUVycm9yLCBsYW1iZGE6IGZyb29ibGUpCgoKICAgIGRlZiB0ZXN0X3BhdGNob2JqZWN0X3dvbnRfY3JlYXRlX2J5X2RlZmF1bHQoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBAcGF0Y2gub2JqZWN0KFNvbWVDbGFzcywgJ2Zyb29ibGUnLCBzZW50aW5lbC5Gcm9vYmxlKQogICAgICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICAgICAgc2VsZi5mYWlsKCdQYXRjaGluZyBub24gZXhpc3RlbnQgYXR0cmlidXRlcyBzaG91bGQgZmFpbCcpCgogICAgICAgICAgICB0ZXN0KCkKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmZhaWwoJ1BhdGNoaW5nIG5vbiBleGlzdGVudCBhdHRyaWJ1dGVzIHNob3VsZCBmYWlsJykKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKGhhc2F0dHIoU29tZUNsYXNzLCAnZnJvb2JsZScpKQoKCiAgICBkZWYgdGVzdF9wYXRjaF93aXRoX3N0YXRpY19tZXRob2RzKHNlbGYpOgogICAgICAgIGNsYXNzIEZvbyhvYmplY3QpOgogICAgICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgICAgIGRlZiB3b290KCk6CiAgICAgICAgICAgICAgICByZXR1cm4gc2VudGluZWwuU3RhdGljCgogICAgICAgIEBwYXRjaC5vYmplY3QoRm9vLCAnd29vdCcsIHN0YXRpY21ldGhvZChsYW1iZGE6IHNlbnRpbmVsLlBhdGNoZWQpKQogICAgICAgIGRlZiBhbm9ueW1vdXMoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28ud29vdCgpLCBzZW50aW5lbC5QYXRjaGVkKQogICAgICAgIGFub255bW91cygpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLndvb3QoKSwgc2VudGluZWwuU3RhdGljKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9sb2NhbChzZWxmKToKICAgICAgICBmb28gPSBzZW50aW5lbC5Gb28KICAgICAgICBAcGF0Y2gub2JqZWN0KHNlbnRpbmVsLCAnRm9vJywgJ0ZvbycpCiAgICAgICAgZGVmIGFub255bW91cygpOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNlbnRpbmVsLkZvbywgJ0ZvbycpCiAgICAgICAgYW5vbnltb3VzKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzZW50aW5lbC5Gb28sIGZvbykKCgogICAgZGVmIHRlc3RfcGF0Y2hfc2xvdHMoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKG9iamVjdCk6CiAgICAgICAgICAgIF9fc2xvdHNfXyA9ICgnRm9vJywpCgogICAgICAgIGZvbyA9IEZvbygpCiAgICAgICAgZm9vLkZvbyA9IHNlbnRpbmVsLkZvbwoKICAgICAgICBAcGF0Y2gub2JqZWN0KGZvbywgJ0ZvbycsICdGb28nKQogICAgICAgIGRlZiBhbm9ueW1vdXMoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28uRm9vLCAnRm9vJykKICAgICAgICBhbm9ueW1vdXMoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvby5Gb28sIHNlbnRpbmVsLkZvbykKCgogICAgZGVmIHRlc3RfcGF0Y2hvYmplY3RfY2xhc3NfZGVjb3JhdG9yKHNlbGYpOgogICAgICAgIGNsYXNzIFNvbWV0aGluZyhvYmplY3QpOgogICAgICAgICAgICBhdHRyaWJ1dGUgPSBzZW50aW5lbC5PcmlnaW5hbAoKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgZGVmIHRlc3RfbWV0aG9kKG90aGVyX3NlbGYpOgogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChTb21ldGhpbmcuYXR0cmlidXRlLCBzZW50aW5lbC5QYXRjaGVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidW5wYXRjaGVkIikKICAgICAgICAgICAgZGVmIG5vdF90ZXN0X21ldGhvZChvdGhlcl9zZWxmKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZXRoaW5nLmF0dHJpYnV0ZSwgc2VudGluZWwuT3JpZ2luYWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJub24tdGVzdCBtZXRob2QgcGF0Y2hlZCIpCgogICAgICAgIEZvbyA9IHBhdGNoLm9iamVjdChTb21ldGhpbmcsICdhdHRyaWJ1dGUnLCBzZW50aW5lbC5QYXRjaGVkKShGb28pCgogICAgICAgIGYgPSBGb28oKQogICAgICAgIGYudGVzdF9tZXRob2QoKQogICAgICAgIGYubm90X3Rlc3RfbWV0aG9kKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChTb21ldGhpbmcuYXR0cmlidXRlLCBzZW50aW5lbC5PcmlnaW5hbCwKICAgICAgICAgICAgICAgICAgICAgICAgICJwYXRjaCBub3QgcmVzdG9yZWQiKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9jbGFzc19kZWNvcmF0b3Ioc2VsZik6CiAgICAgICAgY2xhc3MgU29tZXRoaW5nKG9iamVjdCk6CiAgICAgICAgICAgIGF0dHJpYnV0ZSA9IHNlbnRpbmVsLk9yaWdpbmFsCgogICAgICAgIGNsYXNzIEZvbyhvYmplY3QpOgogICAgICAgICAgICBkZWYgdGVzdF9tZXRob2Qob3RoZXJfc2VsZiwgbW9ja19zb21ldGhpbmcpOgogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChQVE1vZHVsZS5zb21ldGhpbmcsIG1vY2tfc29tZXRoaW5nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidW5wYXRjaGVkIikKICAgICAgICAgICAgZGVmIG5vdF90ZXN0X21ldGhvZChvdGhlcl9zZWxmKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoUFRNb2R1bGUuc29tZXRoaW5nLCBzZW50aW5lbC5Tb21ldGhpbmcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJub24tdGVzdCBtZXRob2QgcGF0Y2hlZCIpCiAgICAgICAgRm9vID0gcGF0Y2goJyVzLnNvbWV0aGluZycgJSBfX25hbWVfXykoRm9vKQoKICAgICAgICBmID0gRm9vKCkKICAgICAgICBmLnRlc3RfbWV0aG9kKCkKICAgICAgICBmLm5vdF90ZXN0X21ldGhvZCgpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZXRoaW5nLmF0dHJpYnV0ZSwgc2VudGluZWwuT3JpZ2luYWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAicGF0Y2ggbm90IHJlc3RvcmVkIikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFBUTW9kdWxlLnNvbWV0aGluZywgc2VudGluZWwuU29tZXRoaW5nLAogICAgICAgICAgICAgICAgICAgICAgICAgInBhdGNoIG5vdCByZXN0b3JlZCIpCgoKICAgIGRlZiB0ZXN0X3BhdGNob2JqZWN0X3R3aWNlKHNlbGYpOgogICAgICAgIGNsYXNzIFNvbWV0aGluZyhvYmplY3QpOgogICAgICAgICAgICBhdHRyaWJ1dGUgPSBzZW50aW5lbC5PcmlnaW5hbAogICAgICAgICAgICBuZXh0X2F0dHJpYnV0ZSA9IHNlbnRpbmVsLk9yaWdpbmFsMgoKICAgICAgICBAcGF0Y2gub2JqZWN0KFNvbWV0aGluZywgJ2F0dHJpYnV0ZScsIHNlbnRpbmVsLlBhdGNoZWQpCiAgICAgICAgQHBhdGNoLm9iamVjdChTb21ldGhpbmcsICdhdHRyaWJ1dGUnLCBzZW50aW5lbC5QYXRjaGVkKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZXRoaW5nLmF0dHJpYnV0ZSwgc2VudGluZWwuUGF0Y2hlZCwgInVucGF0Y2hlZCIpCgogICAgICAgIHRlc3QoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKFNvbWV0aGluZy5hdHRyaWJ1dGUsIHNlbnRpbmVsLk9yaWdpbmFsLAogICAgICAgICAgICAgICAgICAgICAgICAgInBhdGNoIG5vdCByZXN0b3JlZCIpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX2RpY3Qoc2VsZik6CiAgICAgICAgZm9vID0geydpbml0aWFsJzogb2JqZWN0KCksICdvdGhlcic6ICdzb21ldGhpbmcnfQogICAgICAgIG9yaWdpbmFsID0gZm9vLmNvcHkoKQoKICAgICAgICBAcGF0Y2guZGljdChmb28pCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgZm9vWydhJ10gPSAzCiAgICAgICAgICAgIGRlbCBmb29bJ2luaXRpYWwnXQogICAgICAgICAgICBmb29bJ290aGVyJ10gPSAnc29tZXRoaW5nIGVsc2UnCgogICAgICAgIHRlc3QoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvbywgb3JpZ2luYWwpCgogICAgICAgIEBwYXRjaC5kaWN0KGZvbywgeydhJzogJ2InfSkKICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihmb28pLCAzKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvb1snYSddLCAnYicpCgogICAgICAgIHRlc3QoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvbywgb3JpZ2luYWwpCgogICAgICAgIEBwYXRjaC5kaWN0KGZvbywgWygnYScsICdiJyldKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKGZvbyksIDMpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZm9vWydhJ10sICdiJykKCiAgICAgICAgdGVzdCgpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZm9vLCBvcmlnaW5hbCkKCgogICAgZGVmIHRlc3RfcGF0Y2hfZGljdF93aXRoX2NvbnRhaW5lcl9vYmplY3Qoc2VsZik6CiAgICAgICAgZm9vID0gQ29udGFpbmVyKCkKICAgICAgICBmb29bJ2luaXRpYWwnXSA9IG9iamVjdCgpCiAgICAgICAgZm9vWydvdGhlciddID0gICdzb21ldGhpbmcnCgogICAgICAgIG9yaWdpbmFsID0gZm9vLnZhbHVlcy5jb3B5KCkKCiAgICAgICAgQHBhdGNoLmRpY3QoZm9vKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIGZvb1snYSddID0gMwogICAgICAgICAgICBkZWwgZm9vWydpbml0aWFsJ10KICAgICAgICAgICAgZm9vWydvdGhlciddID0gJ3NvbWV0aGluZyBlbHNlJwoKICAgICAgICB0ZXN0KCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28udmFsdWVzLCBvcmlnaW5hbCkKCiAgICAgICAgQHBhdGNoLmRpY3QoZm9vLCB7J2EnOiAnYid9KQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKGZvby52YWx1ZXMpLCAzKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvb1snYSddLCAnYicpCgogICAgICAgIHRlc3QoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvby52YWx1ZXMsIG9yaWdpbmFsKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9kaWN0X3dpdGhfY2xlYXIoc2VsZik6CiAgICAgICAgZm9vID0geydpbml0aWFsJzogb2JqZWN0KCksICdvdGhlcic6ICdzb21ldGhpbmcnfQogICAgICAgIG9yaWdpbmFsID0gZm9vLmNvcHkoKQoKICAgICAgICBAcGF0Y2guZGljdChmb28sIGNsZWFyPVRydWUpCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28sIHt9KQogICAgICAgICAgICBmb29bJ2EnXSA9IDMKICAgICAgICAgICAgZm9vWydvdGhlciddID0gJ3NvbWV0aGluZyBlbHNlJwoKICAgICAgICB0ZXN0KCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28sIG9yaWdpbmFsKQoKICAgICAgICBAcGF0Y2guZGljdChmb28sIHsnYSc6ICdiJ30sIGNsZWFyPVRydWUpCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28sIHsnYSc6ICdiJ30pCgogICAgICAgIHRlc3QoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvbywgb3JpZ2luYWwpCgogICAgICAgIEBwYXRjaC5kaWN0KGZvbywgWygnYScsICdiJyldLCBjbGVhcj1UcnVlKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZm9vLCB7J2EnOiAnYid9KQoKICAgICAgICB0ZXN0KCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28sIG9yaWdpbmFsKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9kaWN0X3dpdGhfY29udGFpbmVyX29iamVjdF9hbmRfY2xlYXIoc2VsZik6CiAgICAgICAgZm9vID0gQ29udGFpbmVyKCkKICAgICAgICBmb29bJ2luaXRpYWwnXSA9IG9iamVjdCgpCiAgICAgICAgZm9vWydvdGhlciddID0gICdzb21ldGhpbmcnCgogICAgICAgIG9yaWdpbmFsID0gZm9vLnZhbHVlcy5jb3B5KCkKCiAgICAgICAgQHBhdGNoLmRpY3QoZm9vLCBjbGVhcj1UcnVlKQogICAgICAgIGRlZiB0ZXN0KCk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZm9vLnZhbHVlcywge30pCiAgICAgICAgICAgIGZvb1snYSddID0gMwogICAgICAgICAgICBmb29bJ290aGVyJ10gPSAnc29tZXRoaW5nIGVsc2UnCgogICAgICAgIHRlc3QoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvby52YWx1ZXMsIG9yaWdpbmFsKQoKICAgICAgICBAcGF0Y2guZGljdChmb28sIHsnYSc6ICdiJ30sIGNsZWFyPVRydWUpCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28udmFsdWVzLCB7J2EnOiAnYid9KQoKICAgICAgICB0ZXN0KCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28udmFsdWVzLCBvcmlnaW5hbCkKCgogICAgZGVmIHRlc3RfbmFtZV9wcmVzZXJ2ZWQoc2VsZik6CiAgICAgICAgZm9vID0ge30KCiAgICAgICAgQHBhdGNoKCclcy5Tb21lQ2xhc3MnICUgX19uYW1lX18sIG9iamVjdCgpKQogICAgICAgIEBwYXRjaCgnJXMuU29tZUNsYXNzJyAlIF9fbmFtZV9fLCBvYmplY3QoKSwgYXV0b3NwZWM9VHJ1ZSkKICAgICAgICBAcGF0Y2gub2JqZWN0KFNvbWVDbGFzcywgb2JqZWN0KCkpCiAgICAgICAgQHBhdGNoLmRpY3QoZm9vKQogICAgICAgIGRlZiBzb21lX25hbWUoKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNvbWVfbmFtZS5fX25hbWVfXywgJ3NvbWVfbmFtZScpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX3dpdGhfZXhjZXB0aW9uKHNlbGYpOgogICAgICAgIGZvbyA9IHt9CgogICAgICAgIEBwYXRjaC5kaWN0KGZvbywgeydhJzogJ2InfSkKICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICByYWlzZSBOYW1lRXJyb3IoJ0tvbnJhZCcpCiAgICAgICAgdHJ5OgogICAgICAgICAgICB0ZXN0KCkKICAgICAgICBleGNlcHQgTmFtZUVycm9yOgogICAgICAgICAgICBwYXNzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5mYWlsKCdOYW1lRXJyb3Igbm90IHJhaXNlZCBieSB0ZXN0JykKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28sIHt9KQoKCiAgICBkZWYgdGVzdF9wYXRjaF9kaWN0X3dpdGhfc3RyaW5nKHNlbGYpOgogICAgICAgIEBwYXRjaC5kaWN0KCdvcy5lbnZpcm9uJywgeydrb25yYWRfZGVsb25nJzogJ3NvbWUgdmFsdWUnfSkKICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICBzZWxmLmFzc2VydEluKCdrb25yYWRfZGVsb25nJywgb3MuZW52aXJvbikKCiAgICAgICAgdGVzdCgpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX2Rlc2NyaXB0b3Ioc2VsZik6CiAgICAgICAgIyB3b3VsZCBiZSBzb21lIGVmZm9ydCB0byBmaXggdGhpcyAtIHdlIGNvdWxkIHNwZWNpYWwgY2FzZSB0aGUKICAgICAgICAjIGJ1aWx0aW4gZGVzY3JpcHRvcnM6IGNsYXNzbWV0aG9kLCBwcm9wZXJ0eSwgc3RhdGljbWV0aG9kCiAgICAgICAgcmV0dXJuCiAgICAgICAgY2xhc3MgTm90aGluZyhvYmplY3QpOgogICAgICAgICAgICBmb28gPSBOb25lCgogICAgICAgIGNsYXNzIFNvbWV0aGluZyhvYmplY3QpOgogICAgICAgICAgICBmb28gPSB7fQoKICAgICAgICAgICAgQHBhdGNoLm9iamVjdChOb3RoaW5nLCAnZm9vJywgMikKICAgICAgICAgICAgQGNsYXNzbWV0aG9kCiAgICAgICAgICAgIGRlZiBrbGFzcyhjbHMpOgogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhjbHMsIFNvbWV0aGluZykKCiAgICAgICAgICAgIEBwYXRjaC5vYmplY3QoTm90aGluZywgJ2ZvbycsIDIpCiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHN0YXRpYyhhcmcpOgogICAgICAgICAgICAgICAgcmV0dXJuIGFyZwoKICAgICAgICAgICAgQHBhdGNoLmRpY3QoZm9vKQogICAgICAgICAgICBAY2xhc3NtZXRob2QKICAgICAgICAgICAgZGVmIGtsYXNzX2RpY3QoY2xzKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMoY2xzLCBTb21ldGhpbmcpCgogICAgICAgICAgICBAcGF0Y2guZGljdChmb28pCiAgICAgICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICAgICAgZGVmIHN0YXRpY19kaWN0KGFyZyk6CiAgICAgICAgICAgICAgICByZXR1cm4gYXJnCgogICAgICAgICMgdGhlc2Ugd2lsbCByYWlzZSBleGNlcHRpb25zIGlmIHBhdGNoaW5nIGRlc2NyaXB0b3JzIGlzIGJyb2tlbgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoU29tZXRoaW5nLnN0YXRpYygnZjAwJyksICdmMDAnKQogICAgICAgIFNvbWV0aGluZy5rbGFzcygpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChTb21ldGhpbmcuc3RhdGljX2RpY3QoJ2YwMCcpLCAnZjAwJykKICAgICAgICBTb21ldGhpbmcua2xhc3NfZGljdCgpCgogICAgICAgIHNvbWV0aGluZyA9IFNvbWV0aGluZygpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzb21ldGhpbmcuc3RhdGljKCdmMDAnKSwgJ2YwMCcpCiAgICAgICAgc29tZXRoaW5nLmtsYXNzKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNvbWV0aGluZy5zdGF0aWNfZGljdCgnZjAwJyksICdmMDAnKQogICAgICAgIHNvbWV0aGluZy5rbGFzc19kaWN0KCkKCgogICAgZGVmIHRlc3RfcGF0Y2hfc3BlY19zZXQoc2VsZik6CiAgICAgICAgQHBhdGNoKCclcy5Tb21lQ2xhc3MnICUgX19uYW1lX18sIHNwZWM9U29tZUNsYXNzLCBzcGVjX3NldD1UcnVlKQogICAgICAgIGRlZiB0ZXN0KE1vY2tDbGFzcyk6CiAgICAgICAgICAgIE1vY2tDbGFzcy56ID0gJ2ZvbycKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIHRlc3QpCgogICAgICAgIEBwYXRjaC5vYmplY3Qoc3VwcG9ydCwgJ1NvbWVDbGFzcycsIHNwZWM9U29tZUNsYXNzLCBzcGVjX3NldD1UcnVlKQogICAgICAgIGRlZiB0ZXN0KE1vY2tDbGFzcyk6CiAgICAgICAgICAgIE1vY2tDbGFzcy56ID0gJ2ZvbycKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIHRlc3QpCiAgICAgICAgQHBhdGNoKCclcy5Tb21lQ2xhc3MnICUgX19uYW1lX18sIHNwZWNfc2V0PVRydWUpCiAgICAgICAgZGVmIHRlc3QoTW9ja0NsYXNzKToKICAgICAgICAgICAgTW9ja0NsYXNzLnogPSAnZm9vJwoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgdGVzdCkKCiAgICAgICAgQHBhdGNoLm9iamVjdChzdXBwb3J0LCAnU29tZUNsYXNzJywgc3BlY19zZXQ9VHJ1ZSkKICAgICAgICBkZWYgdGVzdChNb2NrQ2xhc3MpOgogICAgICAgICAgICBNb2NrQ2xhc3MueiA9ICdmb28nCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCB0ZXN0KQoKCiAgICBkZWYgdGVzdF9zcGVjX3NldF9pbmhlcml0KHNlbGYpOgogICAgICAgIEBwYXRjaCgnJXMuU29tZUNsYXNzJyAlIF9fbmFtZV9fLCBzcGVjX3NldD1UcnVlKQogICAgICAgIGRlZiB0ZXN0KE1vY2tDbGFzcyk6CiAgICAgICAgICAgIGluc3RhbmNlID0gTW9ja0NsYXNzKCkKICAgICAgICAgICAgaW5zdGFuY2UueiA9ICdmb28nCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCB0ZXN0KQoKCiAgICBkZWYgdGVzdF9wYXRjaF9zdGFydF9zdG9wKHNlbGYpOgogICAgICAgIG9yaWdpbmFsID0gc29tZXRoaW5nCiAgICAgICAgcGF0Y2hlciA9IHBhdGNoKCclcy5zb21ldGhpbmcnICUgX19uYW1lX18pCiAgICAgICAgc2VsZi5hc3NlcnRJcyhzb21ldGhpbmcsIG9yaWdpbmFsKQogICAgICAgIG1vY2sgPSBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNOb3QobW9jaywgb3JpZ2luYWwpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMoc29tZXRoaW5nLCBtb2NrKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHBhdGNoZXIuc3RvcCgpCiAgICAgICAgc2VsZi5hc3NlcnRJcyhzb21ldGhpbmcsIG9yaWdpbmFsKQoKCiAgICBkZWYgdGVzdF9zdG9wX3dpdGhvdXRfc3RhcnQoc2VsZik6CiAgICAgICAgcGF0Y2hlciA9IHBhdGNoKGZvb19uYW1lLCAnYmFyJywgMykKCiAgICAgICAgIyBjYWxsaW5nIHN0b3Agd2l0aG91dCBzdGFydCB1c2VkIHRvIHByb2R1Y2UgYSB2ZXJ5IG9ic2N1cmUgZXJyb3IKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhSdW50aW1lRXJyb3IsIHBhdGNoZXIuc3RvcCkKCgogICAgZGVmIHRlc3RfcGF0Y2hvYmplY3Rfc3RhcnRfc3RvcChzZWxmKToKICAgICAgICBvcmlnaW5hbCA9IHNvbWV0aGluZwogICAgICAgIHBhdGNoZXIgPSBwYXRjaC5vYmplY3QoUFRNb2R1bGUsICdzb21ldGhpbmcnLCAnZm9vJykKICAgICAgICBzZWxmLmFzc2VydElzKHNvbWV0aGluZywgb3JpZ2luYWwpCiAgICAgICAgcmVwbGFjZWQgPSBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVwbGFjZWQsICdmb28nKQogICAgICAgICAgICBzZWxmLmFzc2VydElzKHNvbWV0aGluZywgcmVwbGFjZWQpCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgcGF0Y2hlci5zdG9wKCkKICAgICAgICBzZWxmLmFzc2VydElzKHNvbWV0aGluZywgb3JpZ2luYWwpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX2RpY3Rfc3RhcnRfc3RvcChzZWxmKToKICAgICAgICBkID0geydmb28nOiAnYmFyJ30KICAgICAgICBvcmlnaW5hbCA9IGQuY29weSgpCiAgICAgICAgcGF0Y2hlciA9IHBhdGNoLmRpY3QoZCwgWygnc3BhbScsICdlZ2dzJyldLCBjbGVhcj1UcnVlKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZCwgb3JpZ2luYWwpCgogICAgICAgIHBhdGNoZXIuc3RhcnQoKQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChkLCB7J3NwYW0nOiAnZWdncyd9KQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHBhdGNoZXIuc3RvcCgpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChkLCBvcmlnaW5hbCkKCgogICAgZGVmIHRlc3RfcGF0Y2hfZGljdF9jbGFzc19kZWNvcmF0b3Ioc2VsZik6CiAgICAgICAgdGhpcyA9IHNlbGYKICAgICAgICBkID0geydzcGFtJzogJ2VnZ3MnfQogICAgICAgIG9yaWdpbmFsID0gZC5jb3B5KCkKCiAgICAgICAgY2xhc3MgVGVzdChvYmplY3QpOgogICAgICAgICAgICBkZWYgdGVzdF9maXJzdChzZWxmKToKICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXF1YWwoZCwgeydmb28nOiAnYmFyJ30pCiAgICAgICAgICAgIGRlZiB0ZXN0X3NlY29uZChzZWxmKToKICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXF1YWwoZCwgeydmb28nOiAnYmFyJ30pCgogICAgICAgIFRlc3QgPSBwYXRjaC5kaWN0KGQsIHsnZm9vJzogJ2Jhcid9LCBjbGVhcj1UcnVlKShUZXN0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZCwgb3JpZ2luYWwpCgogICAgICAgIHRlc3QgPSBUZXN0KCkKCiAgICAgICAgdGVzdC50ZXN0X2ZpcnN0KCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGQsIG9yaWdpbmFsKQoKICAgICAgICB0ZXN0LnRlc3Rfc2Vjb25kKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGQsIG9yaWdpbmFsKQoKICAgICAgICB0ZXN0ID0gVGVzdCgpCgogICAgICAgIHRlc3QudGVzdF9maXJzdCgpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChkLCBvcmlnaW5hbCkKCiAgICAgICAgdGVzdC50ZXN0X3NlY29uZCgpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChkLCBvcmlnaW5hbCkKCgogICAgZGVmIHRlc3RfZ2V0X29ubHlfcHJveHkoc2VsZik6CiAgICAgICAgY2xhc3MgU29tZXRoaW5nKG9iamVjdCk6CiAgICAgICAgICAgIGZvbyA9ICdmb28nCiAgICAgICAgY2xhc3MgU29tZXRoaW5nRWxzZToKICAgICAgICAgICAgZm9vID0gJ2ZvbycKCiAgICAgICAgZm9yIHRoaW5nIGluIFNvbWV0aGluZywgU29tZXRoaW5nRWxzZSwgU29tZXRoaW5nKCksIFNvbWV0aGluZ0Vsc2U6CiAgICAgICAgICAgIHByb3h5ID0gX2dldF9wcm94eSh0aGluZykKCiAgICAgICAgICAgIEBwYXRjaC5vYmplY3QocHJveHksICdmb28nLCAnYmFyJykKICAgICAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJveHkuZm9vLCAnYmFyJykKICAgICAgICAgICAgdGVzdCgpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJveHkuZm9vLCAnZm9vJykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCh0aGluZy5mb28sICdmb28nKQogICAgICAgICAgICBzZWxmLmFzc2VydE5vdEluKCdmb28nLCBwcm94eS5fX2RpY3RfXykKCgogICAgZGVmIHRlc3RfZ2V0X3NldF9kZWxldGVfcHJveHkoc2VsZik6CiAgICAgICAgY2xhc3MgU29tZXRoaW5nKG9iamVjdCk6CiAgICAgICAgICAgIGZvbyA9ICdmb28nCiAgICAgICAgY2xhc3MgU29tZXRoaW5nRWxzZToKICAgICAgICAgICAgZm9vID0gJ2ZvbycKCiAgICAgICAgZm9yIHRoaW5nIGluIFNvbWV0aGluZywgU29tZXRoaW5nRWxzZSwgU29tZXRoaW5nKCksIFNvbWV0aGluZ0Vsc2U6CiAgICAgICAgICAgIHByb3h5ID0gX2dldF9wcm94eShTb21ldGhpbmcsIGdldF9vbmx5PUZhbHNlKQoKICAgICAgICAgICAgQHBhdGNoLm9iamVjdChwcm94eSwgJ2ZvbycsICdiYXInKQogICAgICAgICAgICBkZWYgdGVzdCgpOgogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm94eS5mb28sICdiYXInKQogICAgICAgICAgICB0ZXN0KCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChwcm94eS5mb28sICdmb28nKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHRoaW5nLmZvbywgJ2ZvbycpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0Tm90SW4oJ2ZvbycsIHByb3h5Ll9fZGljdF9fKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9rZXl3b3JkX2FyZ3Moc2VsZik6CiAgICAgICAga3dhcmdzID0geydzaWRlX2VmZmVjdCc6IEtleUVycm9yLCAnZm9vLmJhci5yZXR1cm5fdmFsdWUnOiAzMywKICAgICAgICAgICAgICAgICAgJ2Zvbyc6IE1hZ2ljTW9jaygpfQoKICAgICAgICBwYXRjaGVyID0gcGF0Y2goZm9vX25hbWUsICoqa3dhcmdzKQogICAgICAgIG1vY2sgPSBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICBwYXRjaGVyLnN0b3AoKQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhLZXlFcnJvciwgbW9jaykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suZm9vLmJhcigpLCAzMykKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jay5mb28sIE1hZ2ljTW9jaykKCgogICAgZGVmIHRlc3RfcGF0Y2hfb2JqZWN0X2tleXdvcmRfYXJncyhzZWxmKToKICAgICAgICBrd2FyZ3MgPSB7J3NpZGVfZWZmZWN0JzogS2V5RXJyb3IsICdmb28uYmFyLnJldHVybl92YWx1ZSc6IDMzLAogICAgICAgICAgICAgICAgICAnZm9vJzogTWFnaWNNb2NrKCl9CgogICAgICAgIHBhdGNoZXIgPSBwYXRjaC5vYmplY3QoRm9vLCAnZicsICoqa3dhcmdzKQogICAgICAgIG1vY2sgPSBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICBwYXRjaGVyLnN0b3AoKQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhLZXlFcnJvciwgbW9jaykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG1vY2suZm9vLmJhcigpLCAzMykKICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jay5mb28sIE1hZ2ljTW9jaykKCgogICAgZGVmIHRlc3RfcGF0Y2hfZGljdF9rZXl3b3JkX2FyZ3Moc2VsZik6CiAgICAgICAgb3JpZ2luYWwgPSB7J2Zvbyc6ICdiYXInfQogICAgICAgIGNvcHkgPSBvcmlnaW5hbC5jb3B5KCkKCiAgICAgICAgcGF0Y2hlciA9IHBhdGNoLmRpY3Qob3JpZ2luYWwsIGZvbz0zLCBiYXI9NCwgYmF6PTUpCiAgICAgICAgcGF0Y2hlci5zdGFydCgpCgogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChvcmlnaW5hbCwgZGljdChmb289MywgYmFyPTQsIGJhej01KSkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwYXRjaGVyLnN0b3AoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG9yaWdpbmFsLCBjb3B5KQoKCiAgICBkZWYgdGVzdF9hdXRvc3BlYyhzZWxmKToKICAgICAgICBjbGFzcyBCb28ob2JqZWN0KToKICAgICAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIGEpOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBkZWYgZihzZWxmLCBhKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZGVmIGcoc2VsZik6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGZvbyA9ICdiYXInCgogICAgICAgICAgICBjbGFzcyBCYXIob2JqZWN0KToKICAgICAgICAgICAgICAgIGRlZiBhKHNlbGYpOgogICAgICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgZGVmIF90ZXN0KG1vY2spOgogICAgICAgICAgICBtb2NrKDEpCiAgICAgICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF93aXRoKDEpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jaykKCiAgICAgICAgZGVmIF90ZXN0Mihtb2NrKToKICAgICAgICAgICAgbW9jay5mKDEpCiAgICAgICAgICAgIG1vY2suZi5hc3NlcnRfY2FsbGVkX3dpdGgoMSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrLmYpCgogICAgICAgICAgICBtb2NrLmcoKQogICAgICAgICAgICBtb2NrLmcuYXNzZXJ0X2NhbGxlZF93aXRoKCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrLmcsIDEpCgogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgbW9jaywgJ2gnKQoKICAgICAgICAgICAgbW9jay5mb28ubG93ZXIoKQogICAgICAgICAgICBtb2NrLmZvby5sb3dlci5hc3NlcnRfY2FsbGVkX3dpdGgoKQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgbW9jay5mb28sICdiYXInKQoKICAgICAgICAgICAgbW9jay5CYXIoKQogICAgICAgICAgICBtb2NrLkJhci5hc3NlcnRfY2FsbGVkX3dpdGgoKQoKICAgICAgICAgICAgbW9jay5CYXIuYSgpCiAgICAgICAgICAgIG1vY2suQmFyLmEuYXNzZXJ0X2NhbGxlZF93aXRoKCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBtb2NrLkJhci5hLCAxKQoKICAgICAgICAgICAgbW9jay5CYXIoKS5hKCkKICAgICAgICAgICAgbW9jay5CYXIoKS5hLmFzc2VydF9jYWxsZWRfd2l0aCgpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgbW9jay5CYXIoKS5hLCAxKQoKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIG1vY2suQmFyLCAnYicpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBnZXRhdHRyLCBtb2NrLkJhcigpLCAnYicpCgogICAgICAgIGRlZiBmdW5jdGlvbihtb2NrKToKICAgICAgICAgICAgX3Rlc3QobW9jaykKICAgICAgICAgICAgX3Rlc3QyKG1vY2spCiAgICAgICAgICAgIF90ZXN0Mihtb2NrKDEpKQogICAgICAgICAgICBzZWxmLmFzc2VydElzKG1vY2ssIEZvbykKICAgICAgICAgICAgcmV0dXJuIG1vY2sKCiAgICAgICAgdGVzdCA9IHBhdGNoKGZvb19uYW1lLCBhdXRvc3BlYz1UcnVlKShmdW5jdGlvbikKCiAgICAgICAgbW9jayA9IHRlc3QoKQogICAgICAgIHNlbGYuYXNzZXJ0SXNOb3QoRm9vLCBtb2NrKQogICAgICAgICMgdGVzdCBwYXRjaGluZyBhIHNlY29uZCB0aW1lIHdvcmtzCiAgICAgICAgdGVzdCgpCgogICAgICAgIG1vZHVsZSA9IHN5cy5tb2R1bGVzW19fbmFtZV9fXQogICAgICAgIHRlc3QgPSBwYXRjaC5vYmplY3QobW9kdWxlLCAnRm9vJywgYXV0b3NwZWM9VHJ1ZSkoZnVuY3Rpb24pCgogICAgICAgIG1vY2sgPSB0ZXN0KCkKICAgICAgICBzZWxmLmFzc2VydElzTm90KEZvbywgbW9jaykKICAgICAgICAjIHRlc3QgcGF0Y2hpbmcgYSBzZWNvbmQgdGltZSB3b3JrcwogICAgICAgIHRlc3QoKQoKCiAgICBkZWYgdGVzdF9hdXRvc3BlY19mdW5jdGlvbihzZWxmKToKICAgICAgICBAcGF0Y2goJyVzLmZ1bmN0aW9uJyAlIF9fbmFtZV9fLCBhdXRvc3BlYz1UcnVlKQogICAgICAgIGRlZiB0ZXN0KG1vY2spOgogICAgICAgICAgICBmdW5jdGlvbigxKQogICAgICAgICAgICBmdW5jdGlvbi5hc3NlcnRfY2FsbGVkX3dpdGgoMSkKICAgICAgICAgICAgZnVuY3Rpb24oMiwgMykKICAgICAgICAgICAgZnVuY3Rpb24uYXNzZXJ0X2NhbGxlZF93aXRoKDIsIDMpCgogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIGZ1bmN0aW9uKQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgZnVuY3Rpb24sICdmb28nKQoKICAgICAgICB0ZXN0KCkKCgogICAgZGVmIHRlc3RfYXV0b3NwZWNfa2V5d29yZHMoc2VsZik6CiAgICAgICAgQHBhdGNoKCclcy5mdW5jdGlvbicgJSBfX25hbWVfXywgYXV0b3NwZWM9VHJ1ZSwKICAgICAgICAgICAgICAgcmV0dXJuX3ZhbHVlPTMpCiAgICAgICAgZGVmIHRlc3QobW9ja19mdW5jdGlvbik6CiAgICAgICAgICAgICNzZWxmLmFzc2VydEVxdWFsKGZ1bmN0aW9uLmFiYywgJ2ZvbycpCiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigxLCAyKQoKICAgICAgICByZXN1bHQgPSB0ZXN0KCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdCwgMykKCgogICAgZGVmIHRlc3RfYXV0b3NwZWNfd2l0aF9uZXcoc2VsZik6CiAgICAgICAgcGF0Y2hlciA9IHBhdGNoKCclcy5mdW5jdGlvbicgJSBfX25hbWVfXywgbmV3PTMsIGF1dG9zcGVjPVRydWUpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBwYXRjaGVyLnN0YXJ0KQoKICAgICAgICBtb2R1bGUgPSBzeXMubW9kdWxlc1tfX25hbWVfX10KICAgICAgICBwYXRjaGVyID0gcGF0Y2gub2JqZWN0KG1vZHVsZSwgJ2Z1bmN0aW9uJywgbmV3PTMsIGF1dG9zcGVjPVRydWUpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBwYXRjaGVyLnN0YXJ0KQoKCiAgICBkZWYgdGVzdF9hdXRvc3BlY193aXRoX29iamVjdChzZWxmKToKICAgICAgICBjbGFzcyBCYXIoRm9vKToKICAgICAgICAgICAgZXh0cmEgPSBbXQoKICAgICAgICBwYXRjaGVyID0gcGF0Y2goZm9vX25hbWUsIGF1dG9zcGVjPUJhcikKICAgICAgICBtb2NrID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jaywgQmFyKQogICAgICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jay5leHRyYSwgbGlzdCkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwYXRjaGVyLnN0b3AoKQoKCiAgICBkZWYgdGVzdF9hdXRvc3BlY19pbmhlcml0cyhzZWxmKToKICAgICAgICBGb29DbGFzcyA9IEZvbwogICAgICAgIHBhdGNoZXIgPSBwYXRjaChmb29fbmFtZSwgYXV0b3NwZWM9VHJ1ZSkKICAgICAgICBtb2NrID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmFzc2VydElzSW5zdGFuY2UobW9jaywgRm9vQ2xhc3MpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShtb2NrKDMpLCBGb29DbGFzcykKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwYXRjaGVyLnN0b3AoKQoKCiAgICBkZWYgdGVzdF9hdXRvc3BlY19uYW1lKHNlbGYpOgogICAgICAgIHBhdGNoZXIgPSBwYXRjaChmb29fbmFtZSwgYXV0b3NwZWM9VHJ1ZSkKICAgICAgICBtb2NrID0gcGF0Y2hlci5zdGFydCgpCgogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigiIG5hbWU9J0ZvbyciLCByZXByKG1vY2spKQogICAgICAgICAgICBzZWxmLmFzc2VydEluKCIgbmFtZT0nRm9vLmYnIiwgcmVwcihtb2NrLmYpKQogICAgICAgICAgICBzZWxmLmFzc2VydEluKCIgbmFtZT0nRm9vKCknIiwgcmVwcihtb2NrKE5vbmUpKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigiIG5hbWU9J0ZvbygpLmYnIiwgcmVwcihtb2NrKE5vbmUpLmYpKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHBhdGNoZXIuc3RvcCgpCgoKICAgIGRlZiB0ZXN0X3RyYWNlYmFja3Moc2VsZik6CiAgICAgICAgQHBhdGNoLm9iamVjdChGb28sICdmJywgb2JqZWN0KCkpCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgcmFpc2UgQXNzZXJ0aW9uRXJyb3IKICAgICAgICB0cnk6CiAgICAgICAgICAgIHRlc3QoKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgZXJyID0gc3lzLmV4Y19pbmZvKCkKCiAgICAgICAgcmVzdWx0ID0gdW5pdHRlc3QuVGV4dFRlc3RSZXN1bHQoTm9uZSwgTm9uZSwgMCkKICAgICAgICB0cmFjZWJhY2sgPSByZXN1bHQuX2V4Y19pbmZvX3RvX3N0cmluZyhlcnIsIHNlbGYpCiAgICAgICAgc2VsZi5hc3NlcnRJbigncmFpc2UgQXNzZXJ0aW9uRXJyb3InLCB0cmFjZWJhY2spCgoKICAgIGRlZiB0ZXN0X25ld19jYWxsYWJsZV9wYXRjaChzZWxmKToKICAgICAgICBwYXRjaGVyID0gcGF0Y2goZm9vX25hbWUsIG5ld19jYWxsYWJsZT1Ob25DYWxsYWJsZU1hZ2ljTW9jaykKCiAgICAgICAgbTEgPSBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICBwYXRjaGVyLnN0b3AoKQogICAgICAgIG0yID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgcGF0Y2hlci5zdG9wKCkKCiAgICAgICAgc2VsZi5hc3NlcnRJc05vdChtMSwgbTIpCiAgICAgICAgZm9yIG1vY2sgaW4gbTEsIG0yOgogICAgICAgICAgICBzZWxmLmFzc2VydE5vdENhbGxhYmxlKG0xKQoKCiAgICBkZWYgdGVzdF9uZXdfY2FsbGFibGVfcGF0Y2hfb2JqZWN0KHNlbGYpOgogICAgICAgIHBhdGNoZXIgPSBwYXRjaC5vYmplY3QoRm9vLCAnZicsIG5ld19jYWxsYWJsZT1Ob25DYWxsYWJsZU1hZ2ljTW9jaykKCiAgICAgICAgbTEgPSBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICBwYXRjaGVyLnN0b3AoKQogICAgICAgIG0yID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgcGF0Y2hlci5zdG9wKCkKCiAgICAgICAgc2VsZi5hc3NlcnRJc05vdChtMSwgbTIpCiAgICAgICAgZm9yIG1vY2sgaW4gbTEsIG0yOgogICAgICAgICAgICBzZWxmLmFzc2VydE5vdENhbGxhYmxlKG0xKQoKCiAgICBkZWYgdGVzdF9uZXdfY2FsbGFibGVfa2V5d29yZF9hcmd1bWVudHMoc2VsZik6CiAgICAgICAgY2xhc3MgQmFyKG9iamVjdCk6CiAgICAgICAgICAgIGt3YXJncyA9IE5vbmUKICAgICAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsICoqa3dhcmdzKToKICAgICAgICAgICAgICAgIEJhci5rd2FyZ3MgPSBrd2FyZ3MKCiAgICAgICAgcGF0Y2hlciA9IHBhdGNoKGZvb19uYW1lLCBuZXdfY2FsbGFibGU9QmFyLCBhcmcxPTEsIGFyZzI9MikKICAgICAgICBtID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmFzc2VydElzKHR5cGUobSksIEJhcikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChCYXIua3dhcmdzLCBkaWN0KGFyZzE9MSwgYXJnMj0yKSkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwYXRjaGVyLnN0b3AoKQoKCiAgICBkZWYgdGVzdF9uZXdfY2FsbGFibGVfc3BlYyhzZWxmKToKICAgICAgICBjbGFzcyBCYXIob2JqZWN0KToKICAgICAgICAgICAga3dhcmdzID0gTm9uZQogICAgICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgICAgICAgICAgQmFyLmt3YXJncyA9IGt3YXJncwoKICAgICAgICBwYXRjaGVyID0gcGF0Y2goZm9vX25hbWUsIG5ld19jYWxsYWJsZT1CYXIsIHNwZWM9QmFyKQogICAgICAgIHBhdGNoZXIuc3RhcnQoKQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChCYXIua3dhcmdzLCBkaWN0KHNwZWM9QmFyKSkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwYXRjaGVyLnN0b3AoKQoKICAgICAgICBwYXRjaGVyID0gcGF0Y2goZm9vX25hbWUsIG5ld19jYWxsYWJsZT1CYXIsIHNwZWNfc2V0PUJhcikKICAgICAgICBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoQmFyLmt3YXJncywgZGljdChzcGVjX3NldD1CYXIpKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHBhdGNoZXIuc3RvcCgpCgoKICAgIGRlZiB0ZXN0X25ld19jYWxsYWJsZV9jcmVhdGUoc2VsZik6CiAgICAgICAgbm9uX2V4aXN0ZW50X2F0dHIgPSAnJXMud2VlZWVlJyAlIGZvb19uYW1lCiAgICAgICAgcCA9IHBhdGNoKG5vbl9leGlzdGVudF9hdHRyLCBuZXdfY2FsbGFibGU9Tm9uQ2FsbGFibGVNb2NrKQogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBwLnN0YXJ0KQoKICAgICAgICBwID0gcGF0Y2gobm9uX2V4aXN0ZW50X2F0dHIsIG5ld19jYWxsYWJsZT1Ob25DYWxsYWJsZU1vY2ssCiAgICAgICAgICAgICAgICAgIGNyZWF0ZT1UcnVlKQogICAgICAgIG0gPSBwLnN0YXJ0KCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0Tm90Q2FsbGFibGUobSwgbWFnaWM9RmFsc2UpCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgcC5zdG9wKCkKCgogICAgZGVmIHRlc3RfbmV3X2NhbGxhYmxlX2luY29tcGF0aWJsZV93aXRoX25ldyhzZWxmKToKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcygKICAgICAgICAgICAgVmFsdWVFcnJvciwgcGF0Y2gsIGZvb19uYW1lLCBuZXc9b2JqZWN0KCksIG5ld19jYWxsYWJsZT1NYWdpY01vY2sKICAgICAgICApCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgIFZhbHVlRXJyb3IsIHBhdGNoLm9iamVjdCwgRm9vLCAnZicsIG5ldz1vYmplY3QoKSwKICAgICAgICAgICAgbmV3X2NhbGxhYmxlPU1hZ2ljTW9jawogICAgICAgICkKCgogICAgZGVmIHRlc3RfbmV3X2NhbGxhYmxlX2luY29tcGF0aWJsZV93aXRoX2F1dG9zcGVjKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKAogICAgICAgICAgICBWYWx1ZUVycm9yLCBwYXRjaCwgZm9vX25hbWUsIG5ld19jYWxsYWJsZT1NYWdpY01vY2ssCiAgICAgICAgICAgIGF1dG9zcGVjPVRydWUKICAgICAgICApCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoCiAgICAgICAgICAgIFZhbHVlRXJyb3IsIHBhdGNoLm9iamVjdCwgRm9vLCAnZicsIG5ld19jYWxsYWJsZT1NYWdpY01vY2ssCiAgICAgICAgICAgIGF1dG9zcGVjPVRydWUKICAgICAgICApCgoKICAgIGRlZiB0ZXN0X25ld19jYWxsYWJsZV9pbmhlcml0X2Zvcl9tb2NrcyhzZWxmKToKICAgICAgICBjbGFzcyBNb2NrU3ViKE1vY2spOgogICAgICAgICAgICBwYXNzCgogICAgICAgIE1vY2tDbGFzc2VzID0gKAogICAgICAgICAgICBOb25DYWxsYWJsZU1vY2ssIE5vbkNhbGxhYmxlTWFnaWNNb2NrLCBNYWdpY01vY2ssIE1vY2ssIE1vY2tTdWIKICAgICAgICApCiAgICAgICAgZm9yIEtsYXNzIGluIE1vY2tDbGFzc2VzOgogICAgICAgICAgICBmb3IgYXJnIGluICdzcGVjJywgJ3NwZWNfc2V0JzoKICAgICAgICAgICAgICAgIGt3YXJncyA9IHthcmc6IFRydWV9CiAgICAgICAgICAgICAgICBwID0gcGF0Y2goZm9vX25hbWUsIG5ld19jYWxsYWJsZT1LbGFzcywgKiprd2FyZ3MpCiAgICAgICAgICAgICAgICBtID0gcC5zdGFydCgpCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBtLnJldHVybl92YWx1ZQogICAgICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBnZXRhdHRyLCBpbnN0YW5jZSwgJ3gnKQogICAgICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgICAgICBwLnN0b3AoKQoKCiAgICBkZWYgdGVzdF9uZXdfY2FsbGFibGVfaW5oZXJpdF9ub25fbW9jayhzZWxmKToKICAgICAgICBjbGFzcyBOb3RBTW9jayhvYmplY3QpOgogICAgICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgc3BlYyk6CiAgICAgICAgICAgICAgICBzZWxmLnNwZWMgPSBzcGVjCgogICAgICAgIHAgPSBwYXRjaChmb29fbmFtZSwgbmV3X2NhbGxhYmxlPU5vdEFNb2NrLCBzcGVjPVRydWUpCiAgICAgICAgbSA9IHAuc3RhcnQoKQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzX2luc3RhbmNlKG0sIE5vdEFNb2NrKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGdldGF0dHIsIG0sICdyZXR1cm5fdmFsdWUnKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHAuc3RvcCgpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobS5zcGVjLCBGb28pCgoKICAgIGRlZiB0ZXN0X25ld19jYWxsYWJsZV9jbGFzc19kZWNvcmF0aW5nKHNlbGYpOgogICAgICAgIHRlc3QgPSBzZWxmCiAgICAgICAgb3JpZ2luYWwgPSBGb28KICAgICAgICBjbGFzcyBTb21lVGVzdChvYmplY3QpOgoKICAgICAgICAgICAgZGVmIF90ZXN0KHNlbGYsIG1vY2tfZm9vKToKICAgICAgICAgICAgICAgIHRlc3QuYXNzZXJ0SXNOb3QoRm9vLCBvcmlnaW5hbCkKICAgICAgICAgICAgICAgIHRlc3QuYXNzZXJ0SXMoRm9vLCBtb2NrX2ZvbykKICAgICAgICAgICAgICAgIHRlc3QuYXNzZXJ0SXNJbnN0YW5jZShGb28sIFNvbWVDbGFzcykKCiAgICAgICAgICAgIGRlZiB0ZXN0X3R3byhzZWxmLCBtb2NrX2Zvbyk6CiAgICAgICAgICAgICAgICBzZWxmLl90ZXN0KG1vY2tfZm9vKQogICAgICAgICAgICBkZWYgdGVzdF9vbmUoc2VsZiwgbW9ja19mb28pOgogICAgICAgICAgICAgICAgc2VsZi5fdGVzdChtb2NrX2ZvbykKCiAgICAgICAgU29tZVRlc3QgPSBwYXRjaChmb29fbmFtZSwgbmV3X2NhbGxhYmxlPVNvbWVDbGFzcykoU29tZVRlc3QpCiAgICAgICAgU29tZVRlc3QoKS50ZXN0X29uZSgpCiAgICAgICAgU29tZVRlc3QoKS50ZXN0X3R3bygpCiAgICAgICAgc2VsZi5hc3NlcnRJcyhGb28sIG9yaWdpbmFsKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9tdWx0aXBsZShzZWxmKToKICAgICAgICBvcmlnaW5hbF9mb28gPSBGb28KICAgICAgICBvcmlnaW5hbF9mID0gRm9vLmYKICAgICAgICBvcmlnaW5hbF9nID0gRm9vLmcKCiAgICAgICAgcGF0Y2hlcjEgPSBwYXRjaC5tdWx0aXBsZShmb29fbmFtZSwgZj0xLCBnPTIpCiAgICAgICAgcGF0Y2hlcjIgPSBwYXRjaC5tdWx0aXBsZShGb28sIGY9MSwgZz0yKQoKICAgICAgICBmb3IgcGF0Y2hlciBpbiBwYXRjaGVyMSwgcGF0Y2hlcjI6CiAgICAgICAgICAgIHBhdGNoZXIuc3RhcnQoKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvbywgb3JpZ2luYWxfZm9vKQogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgMSkKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLmcsIDIpCiAgICAgICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgICAgICBwYXRjaGVyLnN0b3AoKQoKICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhGb28sIG9yaWdpbmFsX2ZvbykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgb3JpZ2luYWxfZikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZywgb3JpZ2luYWxfZykKCgogICAgICAgIEBwYXRjaC5tdWx0aXBsZShmb29fbmFtZSwgZj0zLCBnPTQpCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhGb28sIG9yaWdpbmFsX2ZvbykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgMykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZywgNCkKCiAgICAgICAgdGVzdCgpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX211bHRpcGxlX25vX2t3YXJncyhzZWxmKToKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhWYWx1ZUVycm9yLCBwYXRjaC5tdWx0aXBsZSwgZm9vX25hbWUpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVmFsdWVFcnJvciwgcGF0Y2gubXVsdGlwbGUsIEZvbykKCgogICAgZGVmIHRlc3RfcGF0Y2hfbXVsdGlwbGVfY3JlYXRlX21vY2tzKHNlbGYpOgogICAgICAgIG9yaWdpbmFsX2ZvbyA9IEZvbwogICAgICAgIG9yaWdpbmFsX2YgPSBGb28uZgogICAgICAgIG9yaWdpbmFsX2cgPSBGb28uZwoKICAgICAgICBAcGF0Y2gubXVsdGlwbGUoZm9vX25hbWUsIGY9REVGQVVMVCwgZz0zLCBmb289REVGQVVMVCkKICAgICAgICBkZWYgdGVzdChmLCBmb28pOgogICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvbywgb3JpZ2luYWxfZm9vKQogICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvby5mLCBmKQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZvby5nLCAzKQogICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvby5mb28sIGZvbykKICAgICAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzX2luc3RhbmNlKGYsIE1hZ2ljTW9jaykpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShpc19pbnN0YW5jZShmb28sIE1hZ2ljTW9jaykpCgogICAgICAgIHRlc3QoKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLmYsIG9yaWdpbmFsX2YpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZywgb3JpZ2luYWxfZykKCgogICAgZGVmIHRlc3RfcGF0Y2hfbXVsdGlwbGVfY3JlYXRlX21vY2tzX2RpZmZlcmVudF9vcmRlcihzZWxmKToKICAgICAgICAjIGJ1ZyByZXZlYWxlZCBieSBKeXRob24hCiAgICAgICAgb3JpZ2luYWxfZiA9IEZvby5mCiAgICAgICAgb3JpZ2luYWxfZyA9IEZvby5nCgogICAgICAgIHBhdGNoZXIgPSBwYXRjaC5vYmplY3QoRm9vLCAnZicsIDMpCiAgICAgICAgcGF0Y2hlci5hdHRyaWJ1dGVfbmFtZSA9ICdmJwoKICAgICAgICBvdGhlciA9IHBhdGNoLm9iamVjdChGb28sICdnJywgREVGQVVMVCkKICAgICAgICBvdGhlci5hdHRyaWJ1dGVfbmFtZSA9ICdnJwogICAgICAgIHBhdGNoZXIuYWRkaXRpb25hbF9wYXRjaGVycyA9IFtvdGhlcl0KCiAgICAgICAgQHBhdGNoZXIKICAgICAgICBkZWYgdGVzdChnKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhGb28uZywgZykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgMykKCiAgICAgICAgdGVzdCgpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgb3JpZ2luYWxfZikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZvby5nLCBvcmlnaW5hbF9nKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9tdWx0aXBsZV9zdGFja2VkX2RlY29yYXRvcnMoc2VsZik6CiAgICAgICAgb3JpZ2luYWxfZm9vID0gRm9vCiAgICAgICAgb3JpZ2luYWxfZiA9IEZvby5mCiAgICAgICAgb3JpZ2luYWxfZyA9IEZvby5nCgogICAgICAgIEBwYXRjaC5tdWx0aXBsZShmb29fbmFtZSwgZj1ERUZBVUxUKQogICAgICAgIEBwYXRjaC5tdWx0aXBsZShmb29fbmFtZSwgZm9vPURFRkFVTFQpCiAgICAgICAgQHBhdGNoKGZvb19uYW1lICsgJy5nJykKICAgICAgICBkZWYgdGVzdDEoZywgKiprd2FyZ3MpOgogICAgICAgICAgICBfdGVzdChnLCAqKmt3YXJncykKCiAgICAgICAgQHBhdGNoLm11bHRpcGxlKGZvb19uYW1lLCBmPURFRkFVTFQpCiAgICAgICAgQHBhdGNoKGZvb19uYW1lICsgJy5nJykKICAgICAgICBAcGF0Y2gubXVsdGlwbGUoZm9vX25hbWUsIGZvbz1ERUZBVUxUKQogICAgICAgIGRlZiB0ZXN0MihnLCAqKmt3YXJncyk6CiAgICAgICAgICAgIF90ZXN0KGcsICoqa3dhcmdzKQoKICAgICAgICBAcGF0Y2goZm9vX25hbWUgKyAnLmcnKQogICAgICAgIEBwYXRjaC5tdWx0aXBsZShmb29fbmFtZSwgZj1ERUZBVUxUKQogICAgICAgIEBwYXRjaC5tdWx0aXBsZShmb29fbmFtZSwgZm9vPURFRkFVTFQpCiAgICAgICAgZGVmIHRlc3QzKGcsICoqa3dhcmdzKToKICAgICAgICAgICAgX3Rlc3QoZywgKiprd2FyZ3MpCgogICAgICAgIGRlZiBfdGVzdChnLCAqKmt3YXJncyk6CiAgICAgICAgICAgIGYgPSBrd2FyZ3MucG9wKCdmJykKICAgICAgICAgICAgZm9vID0ga3dhcmdzLnBvcCgnZm9vJykKICAgICAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShrd2FyZ3MpCgogICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvbywgb3JpZ2luYWxfZm9vKQogICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvby5mLCBmKQogICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvby5nLCBnKQogICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvby5mb28sIGZvbykKICAgICAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzX2luc3RhbmNlKGYsIE1hZ2ljTW9jaykpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShpc19pbnN0YW5jZShnLCBNYWdpY01vY2spKQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UoZm9vLCBNYWdpY01vY2spKQoKICAgICAgICB0ZXN0MSgpCiAgICAgICAgdGVzdDIoKQogICAgICAgIHRlc3QzKCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZvby5mLCBvcmlnaW5hbF9mKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLmcsIG9yaWdpbmFsX2cpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX211bHRpcGxlX2NyZWF0ZV9tb2Nrc19wYXRjaGVyKHNlbGYpOgogICAgICAgIG9yaWdpbmFsX2ZvbyA9IEZvbwogICAgICAgIG9yaWdpbmFsX2YgPSBGb28uZgogICAgICAgIG9yaWdpbmFsX2cgPSBGb28uZwoKICAgICAgICBwYXRjaGVyID0gcGF0Y2gubXVsdGlwbGUoZm9vX25hbWUsIGY9REVGQVVMVCwgZz0zLCBmb289REVGQVVMVCkKCiAgICAgICAgcmVzdWx0ID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBmID0gcmVzdWx0WydmJ10KICAgICAgICAgICAgZm9vID0gcmVzdWx0Wydmb28nXQogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNldChyZXN1bHQpLCBzZXQoWydmJywgJ2ZvbyddKSkKCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMoRm9vLCBvcmlnaW5hbF9mb28pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMoRm9vLmYsIGYpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMoRm9vLmZvbywgZm9vKQogICAgICAgICAgICBzZWxmLmFzc2VydFRydWUoaXNfaW5zdGFuY2UoZiwgTWFnaWNNb2NrKSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzX2luc3RhbmNlKGZvbywgTWFnaWNNb2NrKSkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwYXRjaGVyLnN0b3AoKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZvby5mLCBvcmlnaW5hbF9mKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLmcsIG9yaWdpbmFsX2cpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX211bHRpcGxlX2RlY29yYXRpbmdfY2xhc3Moc2VsZik6CiAgICAgICAgdGVzdCA9IHNlbGYKICAgICAgICBvcmlnaW5hbF9mb28gPSBGb28KICAgICAgICBvcmlnaW5hbF9mID0gRm9vLmYKICAgICAgICBvcmlnaW5hbF9nID0gRm9vLmcKCiAgICAgICAgY2xhc3MgU29tZVRlc3Qob2JqZWN0KToKCiAgICAgICAgICAgIGRlZiBfdGVzdChzZWxmLCBmLCBmb28pOgogICAgICAgICAgICAgICAgdGVzdC5hc3NlcnRJcyhGb28sIG9yaWdpbmFsX2ZvbykKICAgICAgICAgICAgICAgIHRlc3QuYXNzZXJ0SXMoRm9vLmYsIGYpCiAgICAgICAgICAgICAgICB0ZXN0LmFzc2VydEVxdWFsKEZvby5nLCAzKQogICAgICAgICAgICAgICAgdGVzdC5hc3NlcnRJcyhGb28uZm9vLCBmb28pCiAgICAgICAgICAgICAgICB0ZXN0LmFzc2VydFRydWUoaXNfaW5zdGFuY2UoZiwgTWFnaWNNb2NrKSkKICAgICAgICAgICAgICAgIHRlc3QuYXNzZXJ0VHJ1ZShpc19pbnN0YW5jZShmb28sIE1hZ2ljTW9jaykpCgogICAgICAgICAgICBkZWYgdGVzdF90d28oc2VsZiwgZiwgZm9vKToKICAgICAgICAgICAgICAgIHNlbGYuX3Rlc3QoZiwgZm9vKQogICAgICAgICAgICBkZWYgdGVzdF9vbmUoc2VsZiwgZiwgZm9vKToKICAgICAgICAgICAgICAgIHNlbGYuX3Rlc3QoZiwgZm9vKQoKICAgICAgICBTb21lVGVzdCA9IHBhdGNoLm11bHRpcGxlKAogICAgICAgICAgICBmb29fbmFtZSwgZj1ERUZBVUxULCBnPTMsIGZvbz1ERUZBVUxUCiAgICAgICAgKShTb21lVGVzdCkKCiAgICAgICAgdGhpbmcgPSBTb21lVGVzdCgpCiAgICAgICAgdGhpbmcudGVzdF9vbmUoKQogICAgICAgIHRoaW5nLnRlc3RfdHdvKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgb3JpZ2luYWxfZikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZvby5nLCBvcmlnaW5hbF9nKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9tdWx0aXBsZV9jcmVhdGUoc2VsZik6CiAgICAgICAgcGF0Y2hlciA9IHBhdGNoLm11bHRpcGxlKEZvbywgYmxhbT0nYmxhbScpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIHBhdGNoZXIuc3RhcnQpCgogICAgICAgIHBhdGNoZXIgPSBwYXRjaC5tdWx0aXBsZShGb28sIGJsYW09J2JsYW0nLCBjcmVhdGU9VHJ1ZSkKICAgICAgICBwYXRjaGVyLnN0YXJ0KCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLmJsYW0sICdibGFtJykKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwYXRjaGVyLnN0b3AoKQoKICAgICAgICBzZWxmLmFzc2VydEZhbHNlKGhhc2F0dHIoRm9vLCAnYmxhbScpKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9tdWx0aXBsZV9zcGVjX3NldChzZWxmKToKICAgICAgICAjIGlmIHNwZWNfc2V0IHdvcmtzIHRoZW4gd2UgY2FuIGFzc3VtZSB0aGF0IHNwZWMgYW5kIGF1dG9zcGVjIGFsc28KICAgICAgICAjIHdvcmsgYXMgdGhlIHVuZGVybHlpbmcgbWFjaGluZXJ5IGlzIHRoZSBzYW1lCiAgICAgICAgcGF0Y2hlciA9IHBhdGNoLm11bHRpcGxlKEZvbywgZm9vPURFRkFVTFQsIHNwZWNfc2V0PVsnYScsICdiJ10pCiAgICAgICAgcmVzdWx0ID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKEZvby5mb28sIHJlc3VsdFsnZm9vJ10pCiAgICAgICAgICAgIEZvby5mb28uYSgxKQogICAgICAgICAgICBGb28uZm9vLmIoMikKICAgICAgICAgICAgRm9vLmZvby5hLmFzc2VydF9jYWxsZWRfd2l0aCgxKQogICAgICAgICAgICBGb28uZm9vLmIuYXNzZXJ0X2NhbGxlZF93aXRoKDIpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBzZXRhdHRyLCBGb28uZm9vLCAnYycsIE5vbmUpCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgcGF0Y2hlci5zdG9wKCkKCgogICAgZGVmIHRlc3RfcGF0Y2hfbXVsdGlwbGVfbmV3X2NhbGxhYmxlKHNlbGYpOgogICAgICAgIGNsYXNzIFRoaW5nKG9iamVjdCk6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgcGF0Y2hlciA9IHBhdGNoLm11bHRpcGxlKAogICAgICAgICAgICBGb28sIGY9REVGQVVMVCwgZz1ERUZBVUxULCBuZXdfY2FsbGFibGU9VGhpbmcKICAgICAgICApCiAgICAgICAgcmVzdWx0ID0gcGF0Y2hlci5zdGFydCgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmFzc2VydElzKEZvby5mLCByZXN1bHRbJ2YnXSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhGb28uZywgcmVzdWx0WydnJ10pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShGb28uZiwgVGhpbmcpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShGb28uZywgVGhpbmcpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXNOb3QoRm9vLmYsIEZvby5nKQogICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgIHBhdGNoZXIuc3RvcCgpCgoKICAgIGRlZiB0ZXN0X25lc3RlZF9wYXRjaF9mYWlsdXJlKHNlbGYpOgogICAgICAgIG9yaWdpbmFsX2YgPSBGb28uZgogICAgICAgIG9yaWdpbmFsX2cgPSBGb28uZwoKICAgICAgICBAcGF0Y2gub2JqZWN0KEZvbywgJ2cnLCAxKQogICAgICAgIEBwYXRjaC5vYmplY3QoRm9vLCAnbWlzc2luZycsIDEpCiAgICAgICAgQHBhdGNoLm9iamVjdChGb28sICdmJywgMSkKICAgICAgICBkZWYgdGhpbmcxKCk6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgQHBhdGNoLm9iamVjdChGb28sICdtaXNzaW5nJywgMSkKICAgICAgICBAcGF0Y2gub2JqZWN0KEZvbywgJ2cnLCAxKQogICAgICAgIEBwYXRjaC5vYmplY3QoRm9vLCAnZicsIDEpCiAgICAgICAgZGVmIHRoaW5nMigpOgogICAgICAgICAgICBwYXNzCgogICAgICAgIEBwYXRjaC5vYmplY3QoRm9vLCAnZycsIDEpCiAgICAgICAgQHBhdGNoLm9iamVjdChGb28sICdmJywgMSkKICAgICAgICBAcGF0Y2gub2JqZWN0KEZvbywgJ21pc3NpbmcnLCAxKQogICAgICAgIGRlZiB0aGluZzMoKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBmb3IgZnVuYyBpbiB0aGluZzEsIHRoaW5nMiwgdGhpbmczOgogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZnVuYykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgb3JpZ2luYWxfZikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZywgb3JpZ2luYWxfZykKCgogICAgZGVmIHRlc3RfbmV3X2NhbGxhYmxlX2ZhaWx1cmUoc2VsZik6CiAgICAgICAgb3JpZ2luYWxfZiA9IEZvby5mCiAgICAgICAgb3JpZ2luYWxfZyA9IEZvby5nCiAgICAgICAgb3JpZ2luYWxfZm9vID0gRm9vLmZvbwoKICAgICAgICBkZWYgY3Jhc2hlcigpOgogICAgICAgICAgICByYWlzZSBOYW1lRXJyb3IoJ2NyYXNoZXInKQoKICAgICAgICBAcGF0Y2gub2JqZWN0KEZvbywgJ2cnLCAxKQogICAgICAgIEBwYXRjaC5vYmplY3QoRm9vLCAnZm9vJywgbmV3X2NhbGxhYmxlPWNyYXNoZXIpCiAgICAgICAgQHBhdGNoLm9iamVjdChGb28sICdmJywgMSkKICAgICAgICBkZWYgdGhpbmcxKCk6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgQHBhdGNoLm9iamVjdChGb28sICdmb28nLCBuZXdfY2FsbGFibGU9Y3Jhc2hlcikKICAgICAgICBAcGF0Y2gub2JqZWN0KEZvbywgJ2cnLCAxKQogICAgICAgIEBwYXRjaC5vYmplY3QoRm9vLCAnZicsIDEpCiAgICAgICAgZGVmIHRoaW5nMigpOgogICAgICAgICAgICBwYXNzCgogICAgICAgIEBwYXRjaC5vYmplY3QoRm9vLCAnZycsIDEpCiAgICAgICAgQHBhdGNoLm9iamVjdChGb28sICdmJywgMSkKICAgICAgICBAcGF0Y2gub2JqZWN0KEZvbywgJ2ZvbycsIG5ld19jYWxsYWJsZT1jcmFzaGVyKQogICAgICAgIGRlZiB0aGluZzMoKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBmb3IgZnVuYyBpbiB0aGluZzEsIHRoaW5nMiwgdGhpbmczOgogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhOYW1lRXJyb3IsIGZ1bmMpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLmYsIG9yaWdpbmFsX2YpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLmcsIG9yaWdpbmFsX2cpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoRm9vLmZvbywgb3JpZ2luYWxfZm9vKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9tdWx0aXBsZV9mYWlsdXJlKHNlbGYpOgogICAgICAgIG9yaWdpbmFsX2YgPSBGb28uZgogICAgICAgIG9yaWdpbmFsX2cgPSBGb28uZwoKICAgICAgICBwYXRjaGVyID0gcGF0Y2gub2JqZWN0KEZvbywgJ2YnLCAxKQogICAgICAgIHBhdGNoZXIuYXR0cmlidXRlX25hbWUgPSAnZicKCiAgICAgICAgZ29vZCA9IHBhdGNoLm9iamVjdChGb28sICdnJywgMSkKICAgICAgICBnb29kLmF0dHJpYnV0ZV9uYW1lID0gJ2cnCgogICAgICAgIGJhZCA9IHBhdGNoLm9iamVjdChGb28sICdtaXNzaW5nJywgMSkKICAgICAgICBiYWQuYXR0cmlidXRlX25hbWUgPSAnbWlzc2luZycKCiAgICAgICAgZm9yIGFkZGl0aW9uYWxzIGluIFtnb29kLCBiYWRdLCBbYmFkLCBnb29kXToKICAgICAgICAgICAgcGF0Y2hlci5hZGRpdGlvbmFsX3BhdGNoZXJzID0gYWRkaXRpb25hbHMKCiAgICAgICAgICAgIEBwYXRjaGVyCiAgICAgICAgICAgIGRlZiBmdW5jKCk6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZnVuYykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgb3JpZ2luYWxfZikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZywgb3JpZ2luYWxfZykKCgogICAgZGVmIHRlc3RfcGF0Y2hfbXVsdGlwbGVfbmV3X2NhbGxhYmxlX2ZhaWx1cmUoc2VsZik6CiAgICAgICAgb3JpZ2luYWxfZiA9IEZvby5mCiAgICAgICAgb3JpZ2luYWxfZyA9IEZvby5nCiAgICAgICAgb3JpZ2luYWxfZm9vID0gRm9vLmZvbwoKICAgICAgICBkZWYgY3Jhc2hlcigpOgogICAgICAgICAgICByYWlzZSBOYW1lRXJyb3IoJ2NyYXNoZXInKQoKICAgICAgICBwYXRjaGVyID0gcGF0Y2gub2JqZWN0KEZvbywgJ2YnLCAxKQogICAgICAgIHBhdGNoZXIuYXR0cmlidXRlX25hbWUgPSAnZicKCiAgICAgICAgZ29vZCA9IHBhdGNoLm9iamVjdChGb28sICdnJywgMSkKICAgICAgICBnb29kLmF0dHJpYnV0ZV9uYW1lID0gJ2cnCgogICAgICAgIGJhZCA9IHBhdGNoLm9iamVjdChGb28sICdmb28nLCBuZXdfY2FsbGFibGU9Y3Jhc2hlcikKICAgICAgICBiYWQuYXR0cmlidXRlX25hbWUgPSAnZm9vJwoKICAgICAgICBmb3IgYWRkaXRpb25hbHMgaW4gW2dvb2QsIGJhZF0sIFtiYWQsIGdvb2RdOgogICAgICAgICAgICBwYXRjaGVyLmFkZGl0aW9uYWxfcGF0Y2hlcnMgPSBhZGRpdGlvbmFscwoKICAgICAgICAgICAgQHBhdGNoZXIKICAgICAgICAgICAgZGVmIGZ1bmMoKToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKE5hbWVFcnJvciwgZnVuYykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZiwgb3JpZ2luYWxfZikKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZywgb3JpZ2luYWxfZykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uZm9vLCBvcmlnaW5hbF9mb28pCgoKICAgIGRlZiB0ZXN0X3BhdGNoX211bHRpcGxlX3N0cmluZ19zdWJjbGFzc2VzKHNlbGYpOgogICAgICAgIEZvbyA9IHR5cGUoJ0ZvbycsIChzdHIsKSwgeydmaXNoJzogJ3Rhc3R5J30pCiAgICAgICAgZm9vID0gRm9vKCkKICAgICAgICBAcGF0Y2gubXVsdGlwbGUoZm9vLCBmaXNoPSduZWFybHkgZ29uZScpCiAgICAgICAgZGVmIHRlc3QoKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28uZmlzaCwgJ25lYXJseSBnb25lJykKCiAgICAgICAgdGVzdCgpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28uZmlzaCwgJ3Rhc3R5JykKCgogICAgQHBhdGNoKCd1bml0dGVzdC5tb2NrLnBhdGNoLlRFU1RfUFJFRklYJywgJ2ZvbycpCiAgICBkZWYgdGVzdF9wYXRjaF90ZXN0X3ByZWZpeChzZWxmKToKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgdGhpbmcgPSAnb3JpZ2luYWwnCgogICAgICAgICAgICBkZWYgZm9vX29uZShzZWxmKToKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnRoaW5nCiAgICAgICAgICAgIGRlZiBmb29fdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYudGhpbmcKICAgICAgICAgICAgZGVmIHRlc3Rfb25lKHNlbGYpOgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYudGhpbmcKICAgICAgICAgICAgZGVmIHRlc3RfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYudGhpbmcKCiAgICAgICAgRm9vID0gcGF0Y2gub2JqZWN0KEZvbywgJ3RoaW5nJywgJ2NoYW5nZWQnKShGb28pCgogICAgICAgIGZvbyA9IEZvbygpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28uZm9vX29uZSgpLCAnY2hhbmdlZCcpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28uZm9vX3R3bygpLCAnY2hhbmdlZCcpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28udGVzdF9vbmUoKSwgJ29yaWdpbmFsJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvby50ZXN0X3R3bygpLCAnb3JpZ2luYWwnKQoKCiAgICBAcGF0Y2goJ3VuaXR0ZXN0Lm1vY2sucGF0Y2guVEVTVF9QUkVGSVgnLCAnYmFyJykKICAgIGRlZiB0ZXN0X3BhdGNoX2RpY3RfdGVzdF9wcmVmaXgoc2VsZik6CiAgICAgICAgY2xhc3MgRm9vKG9iamVjdCk6CiAgICAgICAgICAgIGRlZiBiYXJfb25lKHNlbGYpOgogICAgICAgICAgICAgICAgcmV0dXJuIGRpY3QodGhlX2RpY3QpCiAgICAgICAgICAgIGRlZiBiYXJfdHdvKHNlbGYpOgogICAgICAgICAgICAgICAgcmV0dXJuIGRpY3QodGhlX2RpY3QpCiAgICAgICAgICAgIGRlZiB0ZXN0X29uZShzZWxmKToKICAgICAgICAgICAgICAgIHJldHVybiBkaWN0KHRoZV9kaWN0KQogICAgICAgICAgICBkZWYgdGVzdF90d28oc2VsZik6CiAgICAgICAgICAgICAgICByZXR1cm4gZGljdCh0aGVfZGljdCkKCiAgICAgICAgdGhlX2RpY3QgPSB7J2tleSc6ICdvcmlnaW5hbCd9CiAgICAgICAgRm9vID0gcGF0Y2guZGljdCh0aGVfZGljdCwga2V5PSdjaGFuZ2VkJykoRm9vKQoKICAgICAgICBmb28gPUZvbygpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28uYmFyX29uZSgpLCB7J2tleSc6ICdjaGFuZ2VkJ30pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28uYmFyX3R3bygpLCB7J2tleSc6ICdjaGFuZ2VkJ30pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmb28udGVzdF9vbmUoKSwgeydrZXknOiAnb3JpZ2luYWwnfSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvby50ZXN0X3R3bygpLCB7J2tleSc6ICdvcmlnaW5hbCd9KQoKCiAgICBkZWYgdGVzdF9wYXRjaF93aXRoX3NwZWNfbW9ja19yZXByKHNlbGYpOgogICAgICAgIGZvciBhcmcgaW4gKCdzcGVjJywgJ2F1dG9zcGVjJywgJ3NwZWNfc2V0Jyk6CiAgICAgICAgICAgIHAgPSBwYXRjaCgnJXMuU29tZUNsYXNzJyAlIF9fbmFtZV9fLCAqKnthcmc6IFRydWV9KQogICAgICAgICAgICBtID0gcC5zdGFydCgpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0SW4oIiBuYW1lPSdTb21lQ2xhc3MnIiwgcmVwcihtKSkKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0SW4oIiBuYW1lPSdTb21lQ2xhc3MuY2xhc3NfYXR0cmlidXRlJyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcHIobS5jbGFzc19hdHRyaWJ1dGUpKQogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRJbigiIG5hbWU9J1NvbWVDbGFzcygpJyIsIHJlcHIobSgpKSkKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0SW4oIiBuYW1lPSdTb21lQ2xhc3MoKS5jbGFzc19hdHRyaWJ1dGUnIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwcihtKCkuY2xhc3NfYXR0cmlidXRlKSkKICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgIHAuc3RvcCgpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX25lc3RlZF9hdXRvc3BlY19yZXByKHNlbGYpOgogICAgICAgIHdpdGggcGF0Y2goJ3VuaXR0ZXN0LnRlc3QudGVzdG1vY2suc3VwcG9ydCcsIGF1dG9zcGVjPVRydWUpIGFzIG06CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SW4oIiBuYW1lPSdzdXBwb3J0LlNvbWVDbGFzcy53aWJibGUoKSciLAogICAgICAgICAgICAgICAgICAgICAgICAgIHJlcHIobS5Tb21lQ2xhc3Mud2liYmxlKCkpKQogICAgICAgICAgICBzZWxmLmFzc2VydEluKCIgbmFtZT0nc3VwcG9ydC5Tb21lQ2xhc3MoKS53aWJibGUoKSciLAogICAgICAgICAgICAgICAgICAgICAgICAgIHJlcHIobS5Tb21lQ2xhc3MoKS53aWJibGUoKSkpCgoKCiAgICBkZWYgdGVzdF9tb2NrX2NhbGxzX3dpdGhfcGF0Y2goc2VsZik6CiAgICAgICAgZm9yIGFyZyBpbiAoJ3NwZWMnLCAnYXV0b3NwZWMnLCAnc3BlY19zZXQnKToKICAgICAgICAgICAgcCA9IHBhdGNoKCclcy5Tb21lQ2xhc3MnICUgX19uYW1lX18sICoqe2FyZzogVHJ1ZX0pCiAgICAgICAgICAgIG0gPSBwLnN0YXJ0KCkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgbS53aWJibGUoKQoKICAgICAgICAgICAgICAgIGthbGxzID0gW2NhbGwud2liYmxlKCldCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0ubW9ja19jYWxscywga2FsbHMpCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKG0ubWV0aG9kX2NhbGxzLCBrYWxscykKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobS53aWJibGUubW9ja19jYWxscywgW2NhbGwoKV0pCgogICAgICAgICAgICAgICAgcmVzdWx0ID0gbSgpCiAgICAgICAgICAgICAgICBrYWxscy5hcHBlbmQoY2FsbCgpKQogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChtLm1vY2tfY2FsbHMsIGthbGxzKQoKICAgICAgICAgICAgICAgIHJlc3VsdC53aWJibGUoKQogICAgICAgICAgICAgICAga2FsbHMuYXBwZW5kKGNhbGwoKS53aWJibGUoKSkKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobS5tb2NrX2NhbGxzLCBrYWxscykKCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC5tb2NrX2NhbGxzLCBbY2FsbC53aWJibGUoKV0pCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC53aWJibGUubW9ja19jYWxscywgW2NhbGwoKV0pCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJlc3VsdC5tZXRob2RfY2FsbHMsIFtjYWxsLndpYmJsZSgpXSkKICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgIHAuc3RvcCgpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX2ltcG9ydHNfbGF6aWx5KHNlbGYpOgogICAgICAgIHN5cy5tb2R1bGVzLnBvcCgnc3F1aXp6JywgTm9uZSkKCiAgICAgICAgcDEgPSBwYXRjaCgnc3F1aXp6LnNxdW96eicpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoSW1wb3J0RXJyb3IsIHAxLnN0YXJ0KQoKICAgICAgICBzcXVpenogPSBNb2NrKCkKICAgICAgICBzcXVpenouc3F1b3p6ID0gNgogICAgICAgIHN5cy5tb2R1bGVzWydzcXVpenonXSA9IHNxdWl6egogICAgICAgIHAxID0gcGF0Y2goJ3NxdWl6ei5zcXVvenonKQogICAgICAgIHNxdWl6ei5zcXVvenogPSAzCiAgICAgICAgcDEuc3RhcnQoKQogICAgICAgIHAxLnN0b3AoKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc3F1aXp6LnNxdW96eiwgMykKCgogICAgZGVmIHRlc3RfcGF0Y2hfcHJvcG9ncmF0ZXNfZXhjX29uX2V4aXQoc2VsZik6CiAgICAgICAgY2xhc3MgaG9sZGVyOgogICAgICAgICAgICBleGNfaW5mbyA9IE5vbmUsIE5vbmUsIE5vbmUKCiAgICAgICAgY2xhc3MgY3VzdG9tX3BhdGNoKF9wYXRjaCk6CiAgICAgICAgICAgIGRlZiBfX2V4aXRfXyhzZWxmLCBldHlwZT1Ob25lLCB2YWw9Tm9uZSwgdGI9Tm9uZSk6CiAgICAgICAgICAgICAgICBfcGF0Y2guX19leGl0X18oc2VsZiwgZXR5cGUsIHZhbCwgdGIpCiAgICAgICAgICAgICAgICBob2xkZXIuZXhjX2luZm8gPSBldHlwZSwgdmFsLCB0YgogICAgICAgICAgICBzdG9wID0gX19leGl0X18KCiAgICAgICAgZGVmIHdpdGhfY3VzdG9tX3BhdGNoKHRhcmdldCk6CiAgICAgICAgICAgIGdldHRlciwgYXR0cmlidXRlID0gX2dldF90YXJnZXQodGFyZ2V0KQogICAgICAgICAgICByZXR1cm4gY3VzdG9tX3BhdGNoKAogICAgICAgICAgICAgICAgZ2V0dGVyLCBhdHRyaWJ1dGUsIERFRkFVTFQsIE5vbmUsIEZhbHNlLCBOb25lLAogICAgICAgICAgICAgICAgTm9uZSwgTm9uZSwge30KICAgICAgICAgICAgKQoKICAgICAgICBAd2l0aF9jdXN0b21fcGF0Y2goJ3NxdWl6ei5zcXVvenonKQogICAgICAgIGRlZiB0ZXN0KG1vY2spOgogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoUnVudGltZUVycm9yLCB0ZXN0KQogICAgICAgIHNlbGYuYXNzZXJ0SXMoaG9sZGVyLmV4Y19pbmZvWzBdLCBSdW50aW1lRXJyb3IpCiAgICAgICAgc2VsZi5hc3NlcnRJc05vdE5vbmUoaG9sZGVyLmV4Y19pbmZvWzFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2V4Y2VwdGlvbiB2YWx1ZSBub3QgcHJvcGdhdGVkJykKICAgICAgICBzZWxmLmFzc2VydElzTm90Tm9uZShob2xkZXIuZXhjX2luZm9bMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZXhjZXB0aW9uIHRyYWNlYmFjayBub3QgcHJvcGdhdGVkJykKCgogICAgZGVmIHRlc3RfY3JlYXRlX2FuZF9zcGVjcyhzZWxmKToKICAgICAgICBmb3Iga3dhcmcgaW4gKCdzcGVjJywgJ3NwZWNfc2V0JywgJ2F1dG9zcGVjJyk6CiAgICAgICAgICAgIHAgPSBwYXRjaCgnJXMuZG9lc25vdGV4aXN0JyAlIF9fbmFtZV9fLCBjcmVhdGU9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICoqe2t3YXJnOiBUcnVlfSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBwLnN0YXJ0KQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhOYW1lRXJyb3IsIGxhbWJkYTogZG9lc25vdGV4aXN0KQoKICAgICAgICAgICAgIyBjaGVjayB0aGF0IHNwZWMgd2l0aCBjcmVhdGUgaXMgaW5ub2N1b3VzIGlmIHRoZSBvcmlnaW5hbCBleGlzdHMKICAgICAgICAgICAgcCA9IHBhdGNoKE1PRE5BTUUsIGNyZWF0ZT1UcnVlLCAqKntrd2FyZzogVHJ1ZX0pCiAgICAgICAgICAgIHAuc3RhcnQoKQogICAgICAgICAgICBwLnN0b3AoKQoKCiAgICBkZWYgdGVzdF9tdWx0aXBsZV9zcGVjcyhzZWxmKToKICAgICAgICBvcmlnaW5hbCA9IFBUTW9kdWxlCiAgICAgICAgZm9yIGt3YXJnIGluICgnc3BlYycsICdzcGVjX3NldCcpOgogICAgICAgICAgICBwID0gcGF0Y2goTU9ETkFNRSwgYXV0b3NwZWM9MCwgKip7a3dhcmc6IDB9KQogICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IsIHAuc3RhcnQpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMoUFRNb2R1bGUsIG9yaWdpbmFsKQoKICAgICAgICBmb3Iga3dhcmcgaW4gKCdzcGVjJywgJ2F1dG9zcGVjJyk6CiAgICAgICAgICAgIHAgPSBwYXRjaChNT0ROQU1FLCBzcGVjX3NldD0wLCAqKntrd2FyZzogMH0pCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKFR5cGVFcnJvciwgcC5zdGFydCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhQVE1vZHVsZSwgb3JpZ2luYWwpCgogICAgICAgIGZvciBrd2FyZyBpbiAoJ3NwZWNfc2V0JywgJ2F1dG9zcGVjJyk6CiAgICAgICAgICAgIHAgPSBwYXRjaChNT0ROQU1FLCBzcGVjPTAsICoqe2t3YXJnOiAwfSkKICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoVHlwZUVycm9yLCBwLnN0YXJ0KQogICAgICAgICAgICBzZWxmLmFzc2VydElzKFBUTW9kdWxlLCBvcmlnaW5hbCkKCgogICAgZGVmIHRlc3Rfc3BlY3NfZmFsc2VfaW5zdGVhZF9vZl9ub25lKHNlbGYpOgogICAgICAgIHAgPSBwYXRjaChNT0ROQU1FLCBzcGVjPUZhbHNlLCBzcGVjX3NldD1GYWxzZSwgYXV0b3NwZWM9RmFsc2UpCiAgICAgICAgbW9jayA9IHAuc3RhcnQoKQogICAgICAgIHRyeToKICAgICAgICAgICAgIyBubyBzcGVjIHNob3VsZCBoYXZlIGJlZW4gc2V0LCBzbyBhdHRyaWJ1dGUgYWNjZXNzIHNob3VsZCBub3QgZmFpbAogICAgICAgICAgICBtb2NrLmRvZXNfbm90X2V4aXN0CiAgICAgICAgICAgIG1vY2suZG9lc19ub3RfZXhpc3QgPSAzCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgcC5zdG9wKCkKCgogICAgZGVmIHRlc3RfZmFsc2V5X3NwZWMoc2VsZik6CiAgICAgICAgZm9yIGt3YXJnIGluICgnc3BlYycsICdhdXRvc3BlYycsICdzcGVjX3NldCcpOgogICAgICAgICAgICBwID0gcGF0Y2goTU9ETkFNRSwgKip7a3dhcmc6IDB9KQogICAgICAgICAgICBtID0gcC5zdGFydCgpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKEF0dHJpYnV0ZUVycm9yLCBnZXRhdHRyLCBtLCAnZG9lc25vdGV4aXQnKQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgcC5zdG9wKCkKCgogICAgZGVmIHRlc3Rfc3BlY19zZXRfdHJ1ZShzZWxmKToKICAgICAgICBmb3Iga3dhcmcgaW4gKCdzcGVjJywgJ2F1dG9zcGVjJyk6CiAgICAgICAgICAgIHAgPSBwYXRjaChNT0ROQU1FLCBzcGVjX3NldD1UcnVlLCAqKntrd2FyZzogVHJ1ZX0pCiAgICAgICAgICAgIG0gPSBwLnN0YXJ0KCkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIHNldGF0dHIsIG0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZG9lc25vdGV4aXN0JywgJ3NvbWV0aGluZycpCiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhBdHRyaWJ1dGVFcnJvciwgZ2V0YXR0ciwgbSwgJ2RvZXNub3RleGlzdCcpCiAgICAgICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgICAgICBwLnN0b3AoKQoKCiAgICBkZWYgdGVzdF9jYWxsYWJsZV9zcGVjX2FzX2xpc3Qoc2VsZik6CiAgICAgICAgc3BlYyA9ICgnX19jYWxsX18nLCkKICAgICAgICBwID0gcGF0Y2goTU9ETkFNRSwgc3BlYz1zcGVjKQogICAgICAgIG0gPSBwLnN0YXJ0KCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShjYWxsYWJsZShtKSkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwLnN0b3AoKQoKCiAgICBkZWYgdGVzdF9ub3RfY2FsbGFibGVfc3BlY19hc19saXN0KHNlbGYpOgogICAgICAgIHNwZWMgPSAoJ2ZvbycsICdiYXInKQogICAgICAgIHAgPSBwYXRjaChNT0ROQU1FLCBzcGVjPXNwZWMpCiAgICAgICAgbSA9IHAuc3RhcnQoKQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShjYWxsYWJsZShtKSkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBwLnN0b3AoKQoKCiAgICBkZWYgdGVzdF9wYXRjaF9zdG9wYWxsKHNlbGYpOgogICAgICAgIHVubGluayA9IG9zLnVubGluawogICAgICAgIGNoZGlyID0gb3MuY2hkaXIKICAgICAgICBwYXRoID0gb3MucGF0aAogICAgICAgIHBhdGNoKCdvcy51bmxpbmsnLCBzb21ldGhpbmcpLnN0YXJ0KCkKICAgICAgICBwYXRjaCgnb3MuY2hkaXInLCBzb21ldGhpbmdfZWxzZSkuc3RhcnQoKQoKICAgICAgICBAcGF0Y2goJ29zLnBhdGgnKQogICAgICAgIGRlZiBwYXRjaGVkKG1vY2tfcGF0aCk6CiAgICAgICAgICAgIHBhdGNoLnN0b3BhbGwoKQogICAgICAgICAgICBzZWxmLmFzc2VydElzKG9zLnBhdGgsIG1vY2tfcGF0aCkKICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhvcy51bmxpbmssIHVubGluaykKICAgICAgICAgICAgc2VsZi5hc3NlcnRJcyhvcy5jaGRpciwgY2hkaXIpCgogICAgICAgIHBhdGNoZWQoKQogICAgICAgIHNlbGYuYXNzZXJ0SXMob3MucGF0aCwgcGF0aCkKCgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIHVuaXR0ZXN0Lm1haW4oKQo=',
'/Lib/unittest/test/testmock/testsentinel.py':'aW1wb3J0IHVuaXR0ZXN0CmZyb20gdW5pdHRlc3QubW9jayBpbXBvcnQgc2VudGluZWwsIERFRkFVTFQKCgpjbGFzcyBTZW50aW5lbFRlc3QodW5pdHRlc3QuVGVzdENhc2UpOgoKICAgIGRlZiB0ZXN0U2VudGluZWxzKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc2VudGluZWwud2hhdGV2ZXIsIHNlbnRpbmVsLndoYXRldmVyLAogICAgICAgICAgICAgICAgICAgICAgICAgJ3NlbnRpbmVsIG5vdCBzdG9yZWQnKQogICAgICAgIHNlbGYuYXNzZXJ0Tm90RXF1YWwoc2VudGluZWwud2hhdGV2ZXIsIHNlbnRpbmVsLndoYXRldmVyZWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzZW50aW5lbCBzaG91bGQgYmUgdW5pcXVlJykKCgogICAgZGVmIHRlc3RTZW50aW5lbE5hbWUoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzdHIoc2VudGluZWwud2hhdGV2ZXIpLCAnc2VudGluZWwud2hhdGV2ZXInLAogICAgICAgICAgICAgICAgICAgICAgICAgJ3NlbnRpbmVsIG5hbWUgaW5jb3JyZWN0JykKCgogICAgZGVmIHRlc3RERUZBVUxUKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShERUZBVUxUIGlzIHNlbnRpbmVsLkRFRkFVTFQpCgogICAgZGVmIHRlc3RCYXNlcyhzZWxmKToKICAgICAgICAjIElmIHRoaXMgZG9lc24ndCByYWlzZSBhbiBBdHRyaWJ1dGVFcnJvciB0aGVuIGhlbHAobW9jaykgaXMgYnJva2VuCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQXR0cmlidXRlRXJyb3IsIGxhbWJkYTogc2VudGluZWwuX19iYXNlc19fKQoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICB1bml0dGVzdC5tYWluKCkK',
'/Lib/unittest/test/testmock/testwith.py':'aW1wb3J0IHVuaXR0ZXN0CmZyb20gd2FybmluZ3MgaW1wb3J0IGNhdGNoX3dhcm5pbmdzCgpmcm9tIHVuaXR0ZXN0LnRlc3QudGVzdG1vY2suc3VwcG9ydCBpbXBvcnQgaXNfaW5zdGFuY2UKZnJvbSB1bml0dGVzdC5tb2NrIGltcG9ydCBNYWdpY01vY2ssIE1vY2ssIHBhdGNoLCBzZW50aW5lbCwgbW9ja19vcGVuLCBjYWxsCgoKCnNvbWV0aGluZyAgPSBzZW50aW5lbC5Tb21ldGhpbmcKc29tZXRoaW5nX2Vsc2UgID0gc2VudGluZWwuU29tZXRoaW5nRWxzZQoKCgpjbGFzcyBXaXRoVGVzdCh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIHRlc3Rfd2l0aF9zdGF0ZW1lbnQoc2VsZik6CiAgICAgICAgd2l0aCBwYXRjaCgnJXMuc29tZXRoaW5nJyAlIF9fbmFtZV9fLCBzZW50aW5lbC5Tb21ldGhpbmcyKToKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzb21ldGhpbmcsIHNlbnRpbmVsLlNvbWV0aGluZzIsICJ1bnBhdGNoZWQiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLCBzZW50aW5lbC5Tb21ldGhpbmcpCgoKICAgIGRlZiB0ZXN0X3dpdGhfc3RhdGVtZW50X2V4Y2VwdGlvbihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdpdGggcGF0Y2goJyVzLnNvbWV0aGluZycgJSBfX25hbWVfXywgc2VudGluZWwuU29tZXRoaW5nMik6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNvbWV0aGluZywgc2VudGluZWwuU29tZXRoaW5nMiwgInVucGF0Y2hlZCIpCiAgICAgICAgICAgICAgICByYWlzZSBFeGNlcHRpb24oJ3BvdycpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmFpbCgicGF0Y2ggc3dhbGxvd2VkIGV4Y2VwdGlvbiIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzb21ldGhpbmcsIHNlbnRpbmVsLlNvbWV0aGluZykKCgogICAgZGVmIHRlc3Rfd2l0aF9zdGF0ZW1lbnRfYXMoc2VsZik6CiAgICAgICAgd2l0aCBwYXRjaCgnJXMuc29tZXRoaW5nJyAlIF9fbmFtZV9fKSBhcyBtb2NrX3NvbWV0aGluZzoKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzb21ldGhpbmcsIG1vY2tfc29tZXRoaW5nLCAidW5wYXRjaGVkIikKICAgICAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGlzX2luc3RhbmNlKG1vY2tfc29tZXRoaW5nLCBNYWdpY01vY2spLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInBhdGNoaW5nIHdyb25nIHR5cGUiKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLCBzZW50aW5lbC5Tb21ldGhpbmcpCgoKICAgIGRlZiB0ZXN0X3BhdGNoX29iamVjdF93aXRoX3N0YXRlbWVudChzZWxmKToKICAgICAgICBjbGFzcyBGb28ob2JqZWN0KToKICAgICAgICAgICAgc29tZXRoaW5nID0gJ2ZvbycKICAgICAgICBvcmlnaW5hbCA9IEZvby5zb21ldGhpbmcKICAgICAgICB3aXRoIHBhdGNoLm9iamVjdChGb28sICdzb21ldGhpbmcnKToKICAgICAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChGb28uc29tZXRoaW5nLCBvcmlnaW5hbCwgInVucGF0Y2hlZCIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChGb28uc29tZXRoaW5nLCBvcmlnaW5hbCkKCgogICAgZGVmIHRlc3Rfd2l0aF9zdGF0ZW1lbnRfbmVzdGVkKHNlbGYpOgogICAgICAgIHdpdGggY2F0Y2hfd2FybmluZ3MocmVjb3JkPVRydWUpOgogICAgICAgICAgICB3aXRoIHBhdGNoKCclcy5zb21ldGhpbmcnICUgX19uYW1lX18pIGFzIG1vY2tfc29tZXRoaW5nLCBwYXRjaCgnJXMuc29tZXRoaW5nX2Vsc2UnICUgX19uYW1lX18pIGFzIG1vY2tfc29tZXRoaW5nX2Vsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNvbWV0aGluZywgbW9ja19zb21ldGhpbmcsICJ1bnBhdGNoZWQiKQogICAgICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzb21ldGhpbmdfZWxzZSwgbW9ja19zb21ldGhpbmdfZWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInVucGF0Y2hlZCIpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLCBzZW50aW5lbC5Tb21ldGhpbmcpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzb21ldGhpbmdfZWxzZSwgc2VudGluZWwuU29tZXRoaW5nRWxzZSkKCgogICAgZGVmIHRlc3Rfd2l0aF9zdGF0ZW1lbnRfc3BlY2lmaWVkKHNlbGYpOgogICAgICAgIHdpdGggcGF0Y2goJyVzLnNvbWV0aGluZycgJSBfX25hbWVfXywgc2VudGluZWwuUGF0Y2hlZCkgYXMgbW9ja19zb21ldGhpbmc6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLCBtb2NrX3NvbWV0aGluZywgInVucGF0Y2hlZCIpCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9ja19zb21ldGhpbmcsIHNlbnRpbmVsLlBhdGNoZWQsICJ3cm9uZyBwYXRjaCIpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzb21ldGhpbmcsIHNlbnRpbmVsLlNvbWV0aGluZykKCgogICAgZGVmIHRlc3RDb250ZXh0TWFuYWdlck1vY2tpbmcoc2VsZik6CiAgICAgICAgbW9jayA9IE1vY2soKQogICAgICAgIG1vY2suX19lbnRlcl9fID0gTW9jaygpCiAgICAgICAgbW9jay5fX2V4aXRfXyA9IE1vY2soKQogICAgICAgIG1vY2suX19leGl0X18ucmV0dXJuX3ZhbHVlID0gRmFsc2UKCiAgICAgICAgd2l0aCBtb2NrIGFzIG06CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobSwgbW9jay5fX2VudGVyX18ucmV0dXJuX3ZhbHVlKQogICAgICAgIG1vY2suX19lbnRlcl9fLmFzc2VydF9jYWxsZWRfd2l0aCgpCiAgICAgICAgbW9jay5fX2V4aXRfXy5hc3NlcnRfY2FsbGVkX3dpdGgoTm9uZSwgTm9uZSwgTm9uZSkKCgogICAgZGVmIHRlc3RfY29udGV4dF9tYW5hZ2VyX3dpdGhfbWFnaWNfbW9jayhzZWxmKToKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhUeXBlRXJyb3IpOgogICAgICAgICAgICB3aXRoIG1vY2s6CiAgICAgICAgICAgICAgICAnZm9vJyArIDMKICAgICAgICBtb2NrLl9fZW50ZXJfXy5hc3NlcnRfY2FsbGVkX3dpdGgoKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShtb2NrLl9fZXhpdF9fLmNhbGxlZCkKCgogICAgZGVmIHRlc3Rfd2l0aF9zdGF0ZW1lbnRfc2FtZV9hdHRyaWJ1dGUoc2VsZik6CiAgICAgICAgd2l0aCBwYXRjaCgnJXMuc29tZXRoaW5nJyAlIF9fbmFtZV9fLCBzZW50aW5lbC5QYXRjaGVkKSBhcyBtb2NrX3NvbWV0aGluZzoKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChzb21ldGhpbmcsIG1vY2tfc29tZXRoaW5nLCAidW5wYXRjaGVkIikKCiAgICAgICAgICAgIHdpdGggcGF0Y2goJyVzLnNvbWV0aGluZycgJSBfX25hbWVfXykgYXMgbW9ja19hZ2FpbjoKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLCBtb2NrX2FnYWluLCAidW5wYXRjaGVkIikKCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLCBtb2NrX3NvbWV0aGluZywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAicmVzdG9yZWQgd2l0aCB3cm9uZyBpbnN0YW5jZSIpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLCBzZW50aW5lbC5Tb21ldGhpbmcsICJub3QgcmVzdG9yZWQiKQoKCiAgICBkZWYgdGVzdF93aXRoX3N0YXRlbWVudF9pbWJyaWNhdGVkKHNlbGYpOgogICAgICAgIHdpdGggcGF0Y2goJyVzLnNvbWV0aGluZycgJSBfX25hbWVfXykgYXMgbW9ja19zb21ldGhpbmc6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nLCBtb2NrX3NvbWV0aGluZywgInVucGF0Y2hlZCIpCgogICAgICAgICAgICB3aXRoIHBhdGNoKCclcy5zb21ldGhpbmdfZWxzZScgJSBfX25hbWVfXykgYXMgbW9ja19zb21ldGhpbmdfZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nX2Vsc2UsIG1vY2tfc29tZXRoaW5nX2Vsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ1bnBhdGNoZWQiKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHNvbWV0aGluZywgc2VudGluZWwuU29tZXRoaW5nKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoc29tZXRoaW5nX2Vsc2UsIHNlbnRpbmVsLlNvbWV0aGluZ0Vsc2UpCgoKICAgIGRlZiB0ZXN0X2RpY3RfY29udGV4dF9tYW5hZ2VyKHNlbGYpOgogICAgICAgIGZvbyA9IHt9CiAgICAgICAgd2l0aCBwYXRjaC5kaWN0KGZvbywgeydhJzogJ2InfSk6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZm9vLCB7J2EnOiAnYid9KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZm9vLCB7fSkKCiAgICAgICAgd2l0aCBzZWxmLmFzc2VydFJhaXNlcyhOYW1lRXJyb3IpOgogICAgICAgICAgICB3aXRoIHBhdGNoLmRpY3QoZm9vLCB7J2EnOiAnYid9KToKICAgICAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoZm9vLCB7J2EnOiAnYid9KQogICAgICAgICAgICAgICAgcmFpc2UgTmFtZUVycm9yKCdLb25yYWQnKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGZvbywge30pCgoKCmNsYXNzIFRlc3RNb2NrT3Blbih1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIHRlc3RfbW9ja19vcGVuKHNlbGYpOgogICAgICAgIG1vY2sgPSBtb2NrX29wZW4oKQogICAgICAgIHdpdGggcGF0Y2goJyVzLm9wZW4nICUgX19uYW1lX18sIG1vY2ssIGNyZWF0ZT1UcnVlKSBhcyBwYXRjaGVkOgogICAgICAgICAgICBzZWxmLmFzc2VydElzKHBhdGNoZWQsIG1vY2spCiAgICAgICAgICAgIG9wZW4oJ2ZvbycpCgogICAgICAgIG1vY2suYXNzZXJ0X2NhbGxlZF9vbmNlX3dpdGgoJ2ZvbycpCgoKICAgIGRlZiB0ZXN0X21vY2tfb3Blbl9jb250ZXh0X21hbmFnZXIoc2VsZik6CiAgICAgICAgbW9jayA9IG1vY2tfb3BlbigpCiAgICAgICAgaGFuZGxlID0gbW9jay5yZXR1cm5fdmFsdWUKICAgICAgICB3aXRoIHBhdGNoKCclcy5vcGVuJyAlIF9fbmFtZV9fLCBtb2NrLCBjcmVhdGU9VHJ1ZSk6CiAgICAgICAgICAgIHdpdGggb3BlbignZm9vJykgYXMgZjoKICAgICAgICAgICAgICAgIGYucmVhZCgpCgogICAgICAgIGV4cGVjdGVkX2NhbGxzID0gW2NhbGwoJ2ZvbycpLCBjYWxsKCkuX19lbnRlcl9fKCksIGNhbGwoKS5yZWFkKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbCgpLl9fZXhpdF9fKE5vbmUsIE5vbmUsIE5vbmUpXQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobW9jay5tb2NrX2NhbGxzLCBleHBlY3RlZF9jYWxscykKICAgICAgICBzZWxmLmFzc2VydElzKGYsIGhhbmRsZSkKCgogICAgZGVmIHRlc3RfZXhwbGljaXRfbW9jayhzZWxmKToKICAgICAgICBtb2NrID0gTWFnaWNNb2NrKCkKICAgICAgICBtb2NrX29wZW4obW9jaykKCiAgICAgICAgd2l0aCBwYXRjaCgnJXMub3BlbicgJSBfX25hbWVfXywgbW9jaywgY3JlYXRlPVRydWUpIGFzIHBhdGNoZWQ6CiAgICAgICAgICAgIHNlbGYuYXNzZXJ0SXMocGF0Y2hlZCwgbW9jaykKICAgICAgICAgICAgb3BlbignZm9vJykKCiAgICAgICAgbW9jay5hc3NlcnRfY2FsbGVkX29uY2Vfd2l0aCgnZm9vJykKCgogICAgZGVmIHRlc3RfcmVhZF9kYXRhKHNlbGYpOgogICAgICAgIG1vY2sgPSBtb2NrX29wZW4ocmVhZF9kYXRhPSdmb28nKQogICAgICAgIHdpdGggcGF0Y2goJyVzLm9wZW4nICUgX19uYW1lX18sIG1vY2ssIGNyZWF0ZT1UcnVlKToKICAgICAgICAgICAgaCA9IG9wZW4oJ2JhcicpCiAgICAgICAgICAgIHJlc3VsdCA9IGgucmVhZCgpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmVzdWx0LCAnZm9vJykKCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgdW5pdHRlc3QubWFpbigpCg==',
'/Lib/unittest/test/testmock/__init__.py':'aW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IHVuaXR0ZXN0CgoKaGVyZSA9IG9zLnBhdGguZGlybmFtZShfX2ZpbGVfXykKbG9hZGVyID0gdW5pdHRlc3QuZGVmYXVsdFRlc3RMb2FkZXIKCmRlZiBsb2FkX3Rlc3RzKCphcmdzKToKICAgIHN1aXRlID0gdW5pdHRlc3QuVGVzdFN1aXRlKCkKICAgIGZvciBmbiBpbiBvcy5saXN0ZGlyKGhlcmUpOgogICAgICAgIGlmIGZuLnN0YXJ0c3dpdGgoInRlc3QiKSBhbmQgZm4uZW5kc3dpdGgoIi5weSIpOgogICAgICAgICAgICBtb2RuYW1lID0gInVuaXR0ZXN0LnRlc3QudGVzdG1vY2suIiArIGZuWzotM10KICAgICAgICAgICAgX19pbXBvcnRfXyhtb2RuYW1lKQogICAgICAgICAgICBtb2R1bGUgPSBzeXMubW9kdWxlc1ttb2RuYW1lXQogICAgICAgICAgICBzdWl0ZS5hZGRUZXN0KGxvYWRlci5sb2FkVGVzdHNGcm9tTW9kdWxlKG1vZHVsZSkpCiAgICByZXR1cm4gc3VpdGUK',
'/Lib/urllib/request.py':'aW1wb3J0IGFqYXgKCmNsYXNzIEZpbGVJTzoKICBkZWYgX19pbml0X18oc2VsZiwgZGF0YSk6CiAgICAgIHNlbGYuX2RhdGE9ZGF0YQoKICBkZWYgcmVhZChzZWxmKToKICAgICAgcmV0dXJuIHNlbGYuX2RhdGEKCmRlZiB1cmxvcGVuKHVybCwgZGF0YT1Ob25lLCB0aW1lb3V0PU5vbmUpOgogICAgZ2xvYmFsIHJlc3VsdAogICAgcmVzdWx0PU5vbmUKCiAgICBkZWYgb25fY29tcGxldGUocmVxKToKICAgICAgICBnbG9iYWwgcmVzdWx0CiAgICAgICAgcmVzdWx0PXJlcQoKICAgIF9hamF4PWFqYXguYWpheCgpCiAgICBfYWpheC5iaW5kKCdjb21wbGV0ZScsIG9uX2NvbXBsZXRlKQogICAgaWYgdGltZW91dCBpcyBub3QgTm9uZToKICAgICAgIF9hamF4LnNldF90aW1lb3V0KHRpbWVvdXQpCgogICAgX2FqYXgub3BlbignR0VUJywgdXJsLCBGYWxzZSkKICAgIGlmIGRhdGEgaXMgTm9uZToKICAgICAgIF9hamF4LnNlbmQoKQogICAgZWxzZToKICAgICAgIF9hamF4LnNlbmQoZGF0YSkKCiAgICByZXR1cm4gRmlsZUlPKHJlc3VsdC50ZXh0KSwgdXJsLCByZXN1bHQuaGVhZGVycwo=',
'/Lib/urllib/__init__.py':''
}


function readFromVFS(lib){
   //borrowed code from http://stackoverflow.com/questions/1119722/base-62-conversion-in-python
   if (window.atob === undefined) {
      // browser is not chrome, firefox or safari :(
      window.atob=function(s) {
        var e={},i,k,v=[],r='',w=String.fromCharCode;
        var n=[[65,91],[97,123],[48,58],[43,44],[47,48]];

        for(z in n){for(i=n[z][0];i<n[z][1];i++){v.push(w(i));}}
        for(i=0;i<64;i++){e[v[i]]=i;}

        for(i=0;i<s.length;i+=72){
           var b=0,c,x,l=0,o=s.substring(i,i+72);
           for(x=0;x<o.length;x++){
              c=e[o.charAt(x)];b=(b<<6)+c;l+=6;
              while(l>=8){r+=w((b>>>(l-=8))%256);}
           }
        }
        return r;
      }
   }

   if (__BRYTHON__.py_VFS[lib] === undefined) return undefined
   //retrieve module from virutal file system and return contents
   return window.atob(__BRYTHON__.py_VFS[lib])
}

